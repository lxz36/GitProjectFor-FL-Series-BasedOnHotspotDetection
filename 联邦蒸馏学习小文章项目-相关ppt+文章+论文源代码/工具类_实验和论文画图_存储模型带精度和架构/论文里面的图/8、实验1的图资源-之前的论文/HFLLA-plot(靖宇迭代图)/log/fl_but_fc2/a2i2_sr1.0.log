#clients of iccad2012: 2
#clients of asml1: 2
select ratio: 1.0
Total num clients: 4
client model path: ['models/model-a2i2_sr1.0/client_asml1_0', 'models/model-a2i2_sr1.0/client_asml1_1', 'models/model-a2i2_sr1.0/client_iccad2012_0', 'models/model-a2i2_sr1.0/client_iccad2012_1']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32814, 144, 32)
Using transform option: train
#pos = 17102, #neg = 15712
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32737, 144, 32)
Using transform option: train
#pos = 17179, #neg = 15558
loading data into the main memory...
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16703, 144, 32)
Using transform option: train
#pos = 8134, #neg = 8569
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16626, 144, 32)
Using transform option: train
#pos = 8099, #neg = 8527
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.40493 | Reg=0.00357 | acc=0.4375 | L2-Norm=18.898 | L2-Norm(final)=2.058 | 2940.9 samples/s | 46.0 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.34935 | Reg=0.00357 | acc=0.5312 | L2-Norm=18.898 | L2-Norm(final)=2.057 | 6029.3 samples/s | 94.2 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.34094 | Reg=0.00357 | acc=0.6562 | L2-Norm=18.898 | L2-Norm(final)=2.071 | 5980.7 samples/s | 93.4 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.33485 | Reg=0.00357 | acc=0.5469 | L2-Norm=18.898 | L2-Norm(final)=2.091 | 5895.8 samples/s | 92.1 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.33172 | Reg=0.00357 | acc=0.7188 | L2-Norm=18.898 | L2-Norm(final)=2.114 | 5995.6 samples/s | 93.7 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.32883 | Reg=0.00357 | acc=0.7188 | L2-Norm=18.898 | L2-Norm(final)=2.139 | 5839.6 samples/s | 91.2 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.32682 | Reg=0.00357 | acc=0.6406 | L2-Norm=18.898 | L2-Norm(final)=2.166 | 6103.8 samples/s | 95.4 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.32473 | Reg=0.00357 | acc=0.6875 | L2-Norm=18.898 | L2-Norm(final)=2.195 | 5781.5 samples/s | 90.3 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.32342 | Reg=0.00357 | acc=0.6094 | L2-Norm=18.898 | L2-Norm(final)=2.224 | 5869.7 samples/s | 91.7 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.32234 | Reg=0.00357 | acc=0.5625 | L2-Norm=18.898 | L2-Norm(final)=2.254 | 5877.3 samples/s | 91.8 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.32051 | Reg=0.00357 | acc=0.6875 | L2-Norm=18.898 | L2-Norm(final)=2.286 | 7791.0 samples/s | 121.7 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.0] | Loss=0.30245 | Reg=0.00357 | acc=0.6875 | L2-Norm=18.898 | L2-Norm(final)=2.609 | 4196.3 samples/s | 65.6 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.27868 | Reg=0.00345 | acc=0.7969 | L2-Norm=18.577 | L2-Norm(final)=2.613 | 4634.0 samples/s | 72.4 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.25155 | Reg=0.00341 | acc=0.7812 | L2-Norm=18.466 | L2-Norm(final)=2.620 | 4725.5 samples/s | 73.8 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.22840 | Reg=0.00339 | acc=0.8125 | L2-Norm=18.403 | L2-Norm(final)=2.629 | 4640.4 samples/s | 72.5 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.20865 | Reg=0.00337 | acc=0.8906 | L2-Norm=18.363 | L2-Norm(final)=2.639 | 4670.4 samples/s | 73.0 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.19287 | Reg=0.00336 | acc=0.9219 | L2-Norm=18.335 | L2-Norm(final)=2.649 | 4673.9 samples/s | 73.0 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.18168 | Reg=0.00335 | acc=0.9688 | L2-Norm=18.313 | L2-Norm(final)=2.658 | 4688.1 samples/s | 73.3 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.17446 | Reg=0.00335 | acc=0.8906 | L2-Norm=18.296 | L2-Norm(final)=2.665 | 4651.6 samples/s | 72.7 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.16855 | Reg=0.00334 | acc=0.8594 | L2-Norm=18.284 | L2-Norm(final)=2.670 | 4702.4 samples/s | 73.5 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.16149 | Reg=0.00334 | acc=0.9375 | L2-Norm=18.274 | L2-Norm(final)=2.675 | 4679.3 samples/s | 73.1 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.15565 | Reg=0.00334 | acc=0.8906 | L2-Norm=18.267 | L2-Norm(final)=2.681 | 5681.0 samples/s | 88.8 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.14914 | Reg=0.00333 | acc=0.9062 | L2-Norm=18.261 | L2-Norm(final)=2.686 | 1972.3 samples/s | 30.8 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.14309 | Reg=0.00333 | acc=0.9531 | L2-Norm=18.256 | L2-Norm(final)=2.692 | 4659.9 samples/s | 72.8 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.13842 | Reg=0.00333 | acc=0.9375 | L2-Norm=18.254 | L2-Norm(final)=2.697 | 4725.3 samples/s | 73.8 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.13349 | Reg=0.00333 | acc=0.9531 | L2-Norm=18.252 | L2-Norm(final)=2.703 | 4712.9 samples/s | 73.6 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.12922 | Reg=0.00333 | acc=0.9844 | L2-Norm=18.250 | L2-Norm(final)=2.708 | 4698.1 samples/s | 73.4 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.12570 | Reg=0.00333 | acc=0.9375 | L2-Norm=18.249 | L2-Norm(final)=2.714 | 4848.0 samples/s | 75.8 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.12244 | Reg=0.00333 | acc=0.9688 | L2-Norm=18.249 | L2-Norm(final)=2.719 | 4662.6 samples/s | 72.9 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.11899 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.248 | L2-Norm(final)=2.724 | 4795.8 samples/s | 74.9 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.11677 | Reg=0.00333 | acc=0.9844 | L2-Norm=18.248 | L2-Norm(final)=2.728 | 4719.3 samples/s | 73.7 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.11418 | Reg=0.00333 | acc=0.9531 | L2-Norm=18.248 | L2-Norm(final)=2.731 | 4812.6 samples/s | 75.2 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.11121 | Reg=0.00333 | acc=0.9688 | L2-Norm=18.248 | L2-Norm(final)=2.735 | 2004.3 samples/s | 31.3 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.10825 | Reg=0.00333 | acc=0.9531 | L2-Norm=18.249 | L2-Norm(final)=2.738 | 4708.5 samples/s | 73.6 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.10569 | Reg=0.00333 | acc=0.9531 | L2-Norm=18.250 | L2-Norm(final)=2.742 | 4646.1 samples/s | 72.6 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.10338 | Reg=0.00333 | acc=0.9844 | L2-Norm=18.252 | L2-Norm(final)=2.746 | 4696.5 samples/s | 73.4 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.10115 | Reg=0.00333 | acc=0.9688 | L2-Norm=18.255 | L2-Norm(final)=2.749 | 4712.0 samples/s | 73.6 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.09971 | Reg=0.00333 | acc=0.9531 | L2-Norm=18.256 | L2-Norm(final)=2.752 | 4575.6 samples/s | 71.5 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.09793 | Reg=0.00333 | acc=0.9219 | L2-Norm=18.257 | L2-Norm(final)=2.754 | 4603.4 samples/s | 71.9 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.09604 | Reg=0.00333 | acc=0.9531 | L2-Norm=18.259 | L2-Norm(final)=2.757 | 4688.0 samples/s | 73.2 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.09455 | Reg=0.00333 | acc=0.9844 | L2-Norm=18.260 | L2-Norm(final)=2.759 | 4671.8 samples/s | 73.0 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.09341 | Reg=0.00333 | acc=0.9375 | L2-Norm=18.261 | L2-Norm(final)=2.761 | 4695.0 samples/s | 73.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step2000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.41734 | Reg=0.00357 | acc=0.4688 | L2-Norm=18.898 | L2-Norm(final)=2.056 | 4316.3 samples/s | 67.4 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.35290 | Reg=0.00357 | acc=0.7031 | L2-Norm=18.898 | L2-Norm(final)=2.050 | 5550.9 samples/s | 86.7 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.34360 | Reg=0.00357 | acc=0.6875 | L2-Norm=18.898 | L2-Norm(final)=2.061 | 5686.4 samples/s | 88.8 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.33834 | Reg=0.00357 | acc=0.5938 | L2-Norm=18.898 | L2-Norm(final)=2.078 | 5775.0 samples/s | 90.2 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.33543 | Reg=0.00357 | acc=0.5312 | L2-Norm=18.898 | L2-Norm(final)=2.099 | 5811.1 samples/s | 90.8 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.33156 | Reg=0.00357 | acc=0.6094 | L2-Norm=18.898 | L2-Norm(final)=2.124 | 5950.0 samples/s | 93.0 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.32909 | Reg=0.00357 | acc=0.6719 | L2-Norm=18.898 | L2-Norm(final)=2.152 | 6171.1 samples/s | 96.4 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.32713 | Reg=0.00357 | acc=0.5781 | L2-Norm=18.898 | L2-Norm(final)=2.179 | 6153.5 samples/s | 96.1 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.32536 | Reg=0.00357 | acc=0.6719 | L2-Norm=18.898 | L2-Norm(final)=2.207 | 5839.9 samples/s | 91.2 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.32394 | Reg=0.00357 | acc=0.6875 | L2-Norm=18.898 | L2-Norm(final)=2.235 | 5862.9 samples/s | 91.6 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.32185 | Reg=0.00357 | acc=0.6875 | L2-Norm=18.898 | L2-Norm(final)=2.266 | 7714.1 samples/s | 120.5 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.0] | Loss=0.29518 | Reg=0.00357 | acc=0.6562 | L2-Norm=18.898 | L2-Norm(final)=2.587 | 4405.4 samples/s | 68.8 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.28054 | Reg=0.00344 | acc=0.6875 | L2-Norm=18.557 | L2-Norm(final)=2.596 | 4428.5 samples/s | 69.2 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.25006 | Reg=0.00339 | acc=0.8906 | L2-Norm=18.420 | L2-Norm(final)=2.604 | 4759.4 samples/s | 74.4 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.22875 | Reg=0.00336 | acc=0.8125 | L2-Norm=18.343 | L2-Norm(final)=2.612 | 4636.1 samples/s | 72.4 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.20883 | Reg=0.00335 | acc=0.8594 | L2-Norm=18.295 | L2-Norm(final)=2.624 | 4642.6 samples/s | 72.5 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.19570 | Reg=0.00334 | acc=0.9062 | L2-Norm=18.262 | L2-Norm(final)=2.634 | 4705.2 samples/s | 73.5 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.18431 | Reg=0.00333 | acc=0.8594 | L2-Norm=18.239 | L2-Norm(final)=2.644 | 4693.3 samples/s | 73.3 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.17551 | Reg=0.00332 | acc=0.8281 | L2-Norm=18.223 | L2-Norm(final)=2.653 | 4592.1 samples/s | 71.8 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.16745 | Reg=0.00332 | acc=0.9219 | L2-Norm=18.210 | L2-Norm(final)=2.661 | 4610.2 samples/s | 72.0 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.16040 | Reg=0.00331 | acc=0.8906 | L2-Norm=18.199 | L2-Norm(final)=2.668 | 4683.7 samples/s | 73.2 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.15371 | Reg=0.00331 | acc=0.8906 | L2-Norm=18.193 | L2-Norm(final)=2.676 | 5819.2 samples/s | 90.9 steps/s
[Step=1050 Epoch= 2.1] | Loss=0.14676 | Reg=0.00331 | acc=0.9375 | L2-Norm=18.189 | L2-Norm(final)=2.683 | 1965.2 samples/s | 30.7 steps/s
[Step=1100 Epoch= 2.2] | Loss=0.14060 | Reg=0.00331 | acc=0.9531 | L2-Norm=18.188 | L2-Norm(final)=2.690 | 4581.4 samples/s | 71.6 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.13558 | Reg=0.00331 | acc=0.9375 | L2-Norm=18.187 | L2-Norm(final)=2.698 | 4651.1 samples/s | 72.7 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.13135 | Reg=0.00331 | acc=0.9531 | L2-Norm=18.186 | L2-Norm(final)=2.704 | 4714.4 samples/s | 73.7 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.12791 | Reg=0.00331 | acc=0.8906 | L2-Norm=18.186 | L2-Norm(final)=2.710 | 4738.1 samples/s | 74.0 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.12469 | Reg=0.00331 | acc=0.9688 | L2-Norm=18.186 | L2-Norm(final)=2.716 | 4649.2 samples/s | 72.6 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.12131 | Reg=0.00331 | acc=0.9062 | L2-Norm=18.187 | L2-Norm(final)=2.721 | 4712.4 samples/s | 73.6 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.11831 | Reg=0.00331 | acc=0.9531 | L2-Norm=18.188 | L2-Norm(final)=2.726 | 4688.2 samples/s | 73.3 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.11567 | Reg=0.00331 | acc=0.9375 | L2-Norm=18.190 | L2-Norm(final)=2.732 | 4713.9 samples/s | 73.7 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.11317 | Reg=0.00331 | acc=0.9375 | L2-Norm=18.192 | L2-Norm(final)=2.736 | 5106.6 samples/s | 79.8 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.11052 | Reg=0.00331 | acc=0.9375 | L2-Norm=18.194 | L2-Norm(final)=2.741 | 2050.7 samples/s | 32.0 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.10797 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.196 | L2-Norm(final)=2.746 | 4679.2 samples/s | 73.1 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.10550 | Reg=0.00331 | acc=0.9531 | L2-Norm=18.198 | L2-Norm(final)=2.750 | 4715.5 samples/s | 73.7 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.10330 | Reg=0.00331 | acc=0.9531 | L2-Norm=18.201 | L2-Norm(final)=2.754 | 4641.1 samples/s | 72.5 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.10116 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.204 | L2-Norm(final)=2.759 | 4639.2 samples/s | 72.5 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.09908 | Reg=0.00332 | acc=0.9688 | L2-Norm=18.207 | L2-Norm(final)=2.763 | 4666.4 samples/s | 72.9 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.09766 | Reg=0.00332 | acc=0.9219 | L2-Norm=18.210 | L2-Norm(final)=2.767 | 4714.7 samples/s | 73.7 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.09596 | Reg=0.00332 | acc=0.9844 | L2-Norm=18.214 | L2-Norm(final)=2.771 | 4655.4 samples/s | 72.7 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.09419 | Reg=0.00332 | acc=0.9375 | L2-Norm=18.217 | L2-Norm(final)=2.774 | 4739.4 samples/s | 74.1 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.09253 | Reg=0.00332 | acc=0.9375 | L2-Norm=18.220 | L2-Norm(final)=2.778 | 4648.9 samples/s | 72.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step2000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.31896 | Reg=0.00357 | acc=0.5625 | L2-Norm=18.898 | L2-Norm(final)=2.058 | 4182.6 samples/s | 65.4 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.30711 | Reg=0.00357 | acc=0.6719 | L2-Norm=18.898 | L2-Norm(final)=2.073 | 5147.0 samples/s | 80.4 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.29353 | Reg=0.00357 | acc=0.8438 | L2-Norm=18.898 | L2-Norm(final)=2.118 | 5535.1 samples/s | 86.5 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.28121 | Reg=0.00357 | acc=0.8750 | L2-Norm=18.898 | L2-Norm(final)=2.186 | 5263.5 samples/s | 82.2 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.27114 | Reg=0.00357 | acc=0.9062 | L2-Norm=18.898 | L2-Norm(final)=2.263 | 5463.8 samples/s | 85.4 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.26177 | Reg=0.00357 | acc=0.7188 | L2-Norm=18.898 | L2-Norm(final)=2.347 | 7294.1 samples/s | 114.0 steps/s
[Step= 300 Epoch= 1.1] | Loss=0.25360 | Reg=0.00357 | acc=0.8750 | L2-Norm=18.898 | L2-Norm(final)=2.434 | 2064.6 samples/s | 32.3 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.24697 | Reg=0.00357 | acc=0.8281 | L2-Norm=18.898 | L2-Norm(final)=2.524 | 5594.8 samples/s | 87.4 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.24076 | Reg=0.00357 | acc=0.8594 | L2-Norm=18.898 | L2-Norm(final)=2.614 | 5448.8 samples/s | 85.1 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.23508 | Reg=0.00357 | acc=0.9219 | L2-Norm=18.898 | L2-Norm(final)=2.703 | 5461.5 samples/s | 85.3 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.22982 | Reg=0.00357 | acc=0.8281 | L2-Norm=18.898 | L2-Norm(final)=2.791 | 6188.5 samples/s | 96.7 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.9] | Loss=0.18586 | Reg=0.00357 | acc=0.8750 | L2-Norm=18.898 | L2-Norm(final)=3.671 | 4275.0 samples/s | 66.8 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.11378 | Reg=0.00346 | acc=0.9688 | L2-Norm=18.591 | L2-Norm(final)=3.708 | 4116.7 samples/s | 64.3 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.07566 | Reg=0.00342 | acc=0.9844 | L2-Norm=18.495 | L2-Norm(final)=3.731 | 4464.3 samples/s | 69.8 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.05755 | Reg=0.00340 | acc=0.9531 | L2-Norm=18.438 | L2-Norm(final)=3.748 | 4493.5 samples/s | 70.2 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.04669 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.396 | L2-Norm(final)=3.761 | 4395.7 samples/s | 68.7 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.04008 | Reg=0.00337 | acc=0.9844 | L2-Norm=18.361 | L2-Norm(final)=3.772 | 5608.7 samples/s | 87.6 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.03405 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.328 | L2-Norm(final)=3.780 | 1902.2 samples/s | 29.7 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.02943 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.296 | L2-Norm(final)=3.788 | 4439.7 samples/s | 69.4 steps/s
[Step= 900 Epoch= 3.4] | Loss=0.02606 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.262 | L2-Norm(final)=3.794 | 4395.9 samples/s | 68.7 steps/s
[Step= 950 Epoch= 3.6] | Loss=0.02326 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.229 | L2-Norm(final)=3.800 | 4434.2 samples/s | 69.3 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.02100 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.195 | L2-Norm(final)=3.806 | 4909.5 samples/s | 76.7 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.01927 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.162 | L2-Norm(final)=3.811 | 1996.7 samples/s | 31.2 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.01769 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.129 | L2-Norm(final)=3.815 | 4468.4 samples/s | 69.8 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.01635 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.096 | L2-Norm(final)=3.819 | 4501.1 samples/s | 70.3 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.01519 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.061 | L2-Norm(final)=3.823 | 4540.1 samples/s | 70.9 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.01419 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.026 | L2-Norm(final)=3.827 | 4437.0 samples/s | 69.3 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.01334 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.990 | L2-Norm(final)=3.830 | 2122.5 samples/s | 33.2 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.01257 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.955 | L2-Norm(final)=3.833 | 4525.9 samples/s | 70.7 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.01188 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.920 | L2-Norm(final)=3.836 | 4413.8 samples/s | 69.0 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.01126 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.885 | L2-Norm(final)=3.839 | 4463.6 samples/s | 69.7 steps/s
[Step=1500 Epoch= 5.7] | Loss=0.01070 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.848 | L2-Norm(final)=3.842 | 4440.0 samples/s | 69.4 steps/s
[Step=1550 Epoch= 5.9] | Loss=0.01019 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.812 | L2-Norm(final)=3.845 | 2100.0 samples/s | 32.8 steps/s
[Step=1600 Epoch= 6.1] | Loss=0.00973 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.775 | L2-Norm(final)=3.847 | 4460.7 samples/s | 69.7 steps/s
[Step=1650 Epoch= 6.3] | Loss=0.00931 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.738 | L2-Norm(final)=3.849 | 4405.6 samples/s | 68.8 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.00892 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.701 | L2-Norm(final)=3.851 | 4461.1 samples/s | 69.7 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.00856 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.663 | L2-Norm(final)=3.853 | 4379.2 samples/s | 68.4 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.00823 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.626 | L2-Norm(final)=3.855 | 6067.2 samples/s | 94.8 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.00793 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.588 | L2-Norm(final)=3.857 | 1859.4 samples/s | 29.1 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00765 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.550 | L2-Norm(final)=3.858 | 4313.1 samples/s | 67.4 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00738 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.512 | L2-Norm(final)=3.860 | 4492.2 samples/s | 70.2 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00714 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.473 | L2-Norm(final)=3.861 | 4375.9 samples/s | 68.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step2000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.32789 | Reg=0.00357 | acc=0.5469 | L2-Norm=18.898 | L2-Norm(final)=2.058 | 4535.7 samples/s | 70.9 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.31053 | Reg=0.00357 | acc=0.7656 | L2-Norm=18.898 | L2-Norm(final)=2.066 | 4712.3 samples/s | 73.6 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.29521 | Reg=0.00357 | acc=0.7188 | L2-Norm=18.898 | L2-Norm(final)=2.109 | 5470.1 samples/s | 85.5 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.28181 | Reg=0.00357 | acc=0.8438 | L2-Norm=18.898 | L2-Norm(final)=2.174 | 5654.6 samples/s | 88.4 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.26925 | Reg=0.00357 | acc=0.8125 | L2-Norm=18.898 | L2-Norm(final)=2.253 | 5293.9 samples/s | 82.7 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.25974 | Reg=0.00357 | acc=0.8750 | L2-Norm=18.898 | L2-Norm(final)=2.341 | 7420.2 samples/s | 115.9 steps/s
[Step= 300 Epoch= 1.2] | Loss=0.25133 | Reg=0.00357 | acc=0.8594 | L2-Norm=18.898 | L2-Norm(final)=2.432 | 2066.5 samples/s | 32.3 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.24458 | Reg=0.00357 | acc=0.8281 | L2-Norm=18.898 | L2-Norm(final)=2.524 | 5500.1 samples/s | 85.9 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.23803 | Reg=0.00357 | acc=0.8750 | L2-Norm=18.898 | L2-Norm(final)=2.615 | 5459.2 samples/s | 85.3 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.23165 | Reg=0.00357 | acc=0.8438 | L2-Norm=18.898 | L2-Norm(final)=2.706 | 5509.2 samples/s | 86.1 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.22630 | Reg=0.00357 | acc=0.9531 | L2-Norm=18.898 | L2-Norm(final)=2.796 | 6524.3 samples/s | 101.9 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.9] | Loss=0.20295 | Reg=0.00357 | acc=0.8438 | L2-Norm=18.898 | L2-Norm(final)=3.691 | 4409.0 samples/s | 68.9 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.13109 | Reg=0.00345 | acc=0.9531 | L2-Norm=18.580 | L2-Norm(final)=3.698 | 3938.8 samples/s | 61.5 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.08662 | Reg=0.00342 | acc=0.9844 | L2-Norm=18.491 | L2-Norm(final)=3.723 | 4382.2 samples/s | 68.5 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.06570 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.445 | L2-Norm(final)=3.743 | 4384.6 samples/s | 68.5 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.05371 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.414 | L2-Norm(final)=3.756 | 4384.2 samples/s | 68.5 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.04484 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.391 | L2-Norm(final)=3.768 | 5659.4 samples/s | 88.4 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.03799 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.368 | L2-Norm(final)=3.778 | 1863.2 samples/s | 29.1 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.03268 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.344 | L2-Norm(final)=3.787 | 4424.4 samples/s | 69.1 steps/s
[Step= 900 Epoch= 3.5] | Loss=0.02929 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.320 | L2-Norm(final)=3.795 | 4386.4 samples/s | 68.5 steps/s
[Step= 950 Epoch= 3.7] | Loss=0.02634 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.295 | L2-Norm(final)=3.802 | 4434.0 samples/s | 69.3 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.02392 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.270 | L2-Norm(final)=3.808 | 5034.8 samples/s | 78.7 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.02196 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.245 | L2-Norm(final)=3.814 | 1987.0 samples/s | 31.0 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.02019 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.220 | L2-Norm(final)=3.819 | 4387.3 samples/s | 68.6 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.01865 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.193 | L2-Norm(final)=3.824 | 4444.4 samples/s | 69.4 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.01733 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.166 | L2-Norm(final)=3.828 | 4423.6 samples/s | 69.1 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.01618 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.138 | L2-Norm(final)=3.832 | 4510.1 samples/s | 70.5 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.01519 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.109 | L2-Norm(final)=3.835 | 2066.7 samples/s | 32.3 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.01430 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.079 | L2-Norm(final)=3.839 | 4507.3 samples/s | 70.4 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.01351 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.049 | L2-Norm(final)=3.842 | 4467.1 samples/s | 69.8 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.01280 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.018 | L2-Norm(final)=3.845 | 4419.1 samples/s | 69.0 steps/s
[Step=1500 Epoch= 5.8] | Loss=0.01216 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.987 | L2-Norm(final)=3.847 | 4370.1 samples/s | 68.3 steps/s
[Step=1550 Epoch= 6.0] | Loss=0.01158 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.955 | L2-Norm(final)=3.849 | 2057.0 samples/s | 32.1 steps/s
[Step=1600 Epoch= 6.2] | Loss=0.01106 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.923 | L2-Norm(final)=3.852 | 4479.2 samples/s | 70.0 steps/s
[Step=1650 Epoch= 6.4] | Loss=0.01058 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.890 | L2-Norm(final)=3.854 | 4222.9 samples/s | 66.0 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.01014 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.857 | L2-Norm(final)=3.856 | 4463.3 samples/s | 69.7 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.00973 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.824 | L2-Norm(final)=3.857 | 4258.3 samples/s | 66.5 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.00936 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.790 | L2-Norm(final)=3.859 | 6392.2 samples/s | 99.9 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.00901 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.756 | L2-Norm(final)=3.861 | 1786.1 samples/s | 27.9 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00869 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.722 | L2-Norm(final)=3.862 | 4138.8 samples/s | 64.7 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00839 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.688 | L2-Norm(final)=3.863 | 4327.2 samples/s | 67.6 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00811 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.653 | L2-Norm(final)=3.865 | 4111.8 samples/s | 64.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step2000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07720 | acc=0.9434 | tpr=0.9474 | fpr=0.0654 | 4279.9 samples/s | 16.7 steps/s
Avg test loss: 0.07898, Avg test acc: 0.94098, Avg tpr: 0.94597, Avg fpr: 0.06999, total FA: 546

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07770 | acc=0.9458 | tpr=0.9703 | fpr=0.1075 | 4428.3 samples/s | 17.3 steps/s
Avg test loss: 0.07927, Avg test acc: 0.94583, Avg tpr: 0.96923, Avg fpr: 0.10563, total FA: 824

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.74621 | acc=0.3163 | tpr=0.0160 | fpr=0.0315 | 4418.3 samples/s | 17.3 steps/s
Avg test loss: 5.77376, Avg test acc: 0.31381, Avg tpr: 0.01556, Avg fpr: 0.03025, total FA: 236

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.17260 | acc=0.3101 | tpr=0.0313 | fpr=0.0845 | 4402.9 samples/s | 17.2 steps/s
Avg test loss: 6.18517, Avg test acc: 0.31032, Avg tpr: 0.03351, Avg fpr: 0.08089, total FA: 631

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=2.13652 | acc=0.1661 | tpr=0.7611 | fpr=0.8446 | 4476.0 samples/s | 17.5 steps/s
[Step= 100] | Loss=2.11511 | acc=0.1674 | tpr=0.7122 | fpr=0.8427 | 9140.8 samples/s | 35.7 steps/s
[Step= 150] | Loss=2.11800 | acc=0.1672 | tpr=0.7161 | fpr=0.8429 | 8199.6 samples/s | 32.0 steps/s
[Step= 200] | Loss=2.12034 | acc=0.1664 | tpr=0.7169 | fpr=0.8436 | 8512.9 samples/s | 33.3 steps/s
[Step= 250] | Loss=2.12429 | acc=0.1661 | tpr=0.7109 | fpr=0.8438 | 8492.8 samples/s | 33.2 steps/s
[Step= 300] | Loss=2.12143 | acc=0.1664 | tpr=0.7105 | fpr=0.8435 | 8047.8 samples/s | 31.4 steps/s
[Step= 350] | Loss=2.12063 | acc=0.1655 | tpr=0.7107 | fpr=0.8444 | 8506.9 samples/s | 33.2 steps/s
[Step= 400] | Loss=2.12089 | acc=0.1656 | tpr=0.7057 | fpr=0.8442 | 7496.9 samples/s | 29.3 steps/s
[Step= 450] | Loss=2.11985 | acc=0.1659 | tpr=0.7137 | fpr=0.8440 | 8233.7 samples/s | 32.2 steps/s
[Step= 500] | Loss=2.11913 | acc=0.1658 | tpr=0.7115 | fpr=0.8440 | 8229.9 samples/s | 32.1 steps/s
[Step= 550] | Loss=2.12201 | acc=0.1653 | tpr=0.7103 | fpr=0.8446 | 14927.3 samples/s | 58.3 steps/s
Avg test loss: 2.12220, Avg test acc: 0.16527, Avg tpr: 0.71157, Avg fpr: 0.84466, total FA: 117279

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.33262 | acc=0.1318 | tpr=0.8894 | fpr=0.8818 | 4455.7 samples/s | 17.4 steps/s
[Step= 100] | Loss=3.30903 | acc=0.1328 | tpr=0.8934 | fpr=0.8814 | 8482.4 samples/s | 33.1 steps/s
[Step= 150] | Loss=3.30947 | acc=0.1326 | tpr=0.8862 | fpr=0.8813 | 8168.7 samples/s | 31.9 steps/s
[Step= 200] | Loss=3.30449 | acc=0.1325 | tpr=0.8820 | fpr=0.8811 | 8501.4 samples/s | 33.2 steps/s
[Step= 250] | Loss=3.31058 | acc=0.1326 | tpr=0.8803 | fpr=0.8810 | 8333.8 samples/s | 32.6 steps/s
[Step= 300] | Loss=3.30938 | acc=0.1323 | tpr=0.8815 | fpr=0.8814 | 8325.5 samples/s | 32.5 steps/s
[Step= 350] | Loss=3.30712 | acc=0.1319 | tpr=0.8785 | fpr=0.8816 | 8521.1 samples/s | 33.3 steps/s
[Step= 400] | Loss=3.30785 | acc=0.1323 | tpr=0.8780 | fpr=0.8813 | 8137.2 samples/s | 31.8 steps/s
[Step= 450] | Loss=3.30845 | acc=0.1322 | tpr=0.8797 | fpr=0.8814 | 8424.5 samples/s | 32.9 steps/s
[Step= 500] | Loss=3.30972 | acc=0.1318 | tpr=0.8780 | fpr=0.8817 | 8017.0 samples/s | 31.3 steps/s
[Step= 550] | Loss=3.31054 | acc=0.1315 | tpr=0.8770 | fpr=0.8821 | 15974.1 samples/s | 62.4 steps/s
Avg test loss: 3.31088, Avg test acc: 0.13139, Avg tpr: 0.87678, Avg fpr: 0.88216, total FA: 122486

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08076 | acc=0.9825 | tpr=0.9159 | fpr=0.0163 | 4453.8 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.07888 | acc=0.9818 | tpr=0.9254 | fpr=0.0172 | 8346.6 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.08216 | acc=0.9812 | tpr=0.9308 | fpr=0.0179 | 8268.3 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.08331 | acc=0.9810 | tpr=0.9333 | fpr=0.0181 | 8790.2 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.08211 | acc=0.9813 | tpr=0.9354 | fpr=0.0178 | 8001.7 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.08239 | acc=0.9811 | tpr=0.9331 | fpr=0.0180 | 8387.4 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.08277 | acc=0.9808 | tpr=0.9349 | fpr=0.0184 | 8336.5 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.08336 | acc=0.9805 | tpr=0.9316 | fpr=0.0186 | 8303.6 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.08518 | acc=0.9802 | tpr=0.9309 | fpr=0.0189 | 8645.2 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.08428 | acc=0.9804 | tpr=0.9330 | fpr=0.0187 | 8270.5 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.08351 | acc=0.9807 | tpr=0.9324 | fpr=0.0184 | 15454.4 samples/s | 60.4 steps/s
Avg test loss: 0.08334, Avg test acc: 0.98067, Avg tpr: 0.93225, Avg fpr: 0.01845, total FA: 2562

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.06089 | acc=0.9834 | tpr=0.9469 | fpr=0.0159 | 4436.3 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.06052 | acc=0.9833 | tpr=0.9510 | fpr=0.0161 | 8354.6 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.06216 | acc=0.9827 | tpr=0.9568 | fpr=0.0168 | 8021.6 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.06278 | acc=0.9826 | tpr=0.9596 | fpr=0.0170 | 8626.5 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.06209 | acc=0.9824 | tpr=0.9563 | fpr=0.0171 | 8772.1 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.06292 | acc=0.9821 | tpr=0.9549 | fpr=0.0174 | 8075.2 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.06364 | acc=0.9819 | tpr=0.9537 | fpr=0.0176 | 8285.9 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.06405 | acc=0.9817 | tpr=0.9519 | fpr=0.0178 | 8533.1 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.06569 | acc=0.9812 | tpr=0.9503 | fpr=0.0182 | 8849.6 samples/s | 34.6 steps/s
[Step= 500] | Loss=0.06505 | acc=0.9813 | tpr=0.9524 | fpr=0.0181 | 7847.8 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.06442 | acc=0.9815 | tpr=0.9507 | fpr=0.0179 | 15683.0 samples/s | 61.3 steps/s
Avg test loss: 0.06439, Avg test acc: 0.98149, Avg tpr: 0.95048, Avg fpr: 0.01795, total FA: 2492

server round 1/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 3.9] | Loss=0.18863 | Reg=0.00267 | acc=0.8281 | L2-Norm=16.340 | L2-Norm(final)=2.798 | 4384.2 samples/s | 68.5 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.16363 | Reg=0.00267 | acc=0.9062 | L2-Norm=16.335 | L2-Norm(final)=2.875 | 4941.0 samples/s | 77.2 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.15991 | Reg=0.00267 | acc=0.8906 | L2-Norm=16.335 | L2-Norm(final)=2.989 | 5317.2 samples/s | 83.1 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.15616 | Reg=0.00267 | acc=0.9219 | L2-Norm=16.335 | L2-Norm(final)=3.090 | 5478.0 samples/s | 85.6 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.15218 | Reg=0.00267 | acc=0.9062 | L2-Norm=16.335 | L2-Norm(final)=3.180 | 5290.2 samples/s | 82.7 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.14953 | Reg=0.00267 | acc=0.9062 | L2-Norm=16.335 | L2-Norm(final)=3.262 | 5404.7 samples/s | 84.4 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.14824 | Reg=0.00267 | acc=0.9219 | L2-Norm=16.335 | L2-Norm(final)=3.336 | 5529.4 samples/s | 86.4 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.14591 | Reg=0.00267 | acc=0.9219 | L2-Norm=16.335 | L2-Norm(final)=3.403 | 5549.7 samples/s | 86.7 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.14452 | Reg=0.00267 | acc=0.8438 | L2-Norm=16.335 | L2-Norm(final)=3.463 | 5469.7 samples/s | 85.5 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.14371 | Reg=0.00267 | acc=0.8750 | L2-Norm=16.335 | L2-Norm(final)=3.520 | 5625.5 samples/s | 87.9 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.14342 | Reg=0.00267 | acc=0.8438 | L2-Norm=16.335 | L2-Norm(final)=3.570 | 7071.8 samples/s | 110.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 4.9] | Loss=0.12646 | Reg=0.00267 | acc=0.8594 | L2-Norm=16.335 | L2-Norm(final)=4.059 | 3819.3 samples/s | 59.7 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.13783 | Reg=0.00273 | acc=0.8594 | L2-Norm=16.511 | L2-Norm(final)=4.044 | 4634.5 samples/s | 72.4 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.12783 | Reg=0.00276 | acc=0.8906 | L2-Norm=16.623 | L2-Norm(final)=4.043 | 4811.7 samples/s | 75.2 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.11962 | Reg=0.00279 | acc=0.9531 | L2-Norm=16.699 | L2-Norm(final)=4.043 | 4870.5 samples/s | 76.1 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.11376 | Reg=0.00281 | acc=0.8906 | L2-Norm=16.754 | L2-Norm(final)=4.041 | 4963.7 samples/s | 77.6 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.10717 | Reg=0.00282 | acc=0.9688 | L2-Norm=16.798 | L2-Norm(final)=4.038 | 4821.8 samples/s | 75.3 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.10260 | Reg=0.00284 | acc=0.9062 | L2-Norm=16.837 | L2-Norm(final)=4.036 | 4832.9 samples/s | 75.5 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.09918 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.868 | L2-Norm(final)=4.032 | 4807.0 samples/s | 75.1 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.09654 | Reg=0.00285 | acc=0.9688 | L2-Norm=16.895 | L2-Norm(final)=4.028 | 4732.6 samples/s | 73.9 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.09409 | Reg=0.00286 | acc=0.9219 | L2-Norm=16.920 | L2-Norm(final)=4.024 | 4794.3 samples/s | 74.9 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.09069 | Reg=0.00287 | acc=0.9531 | L2-Norm=16.944 | L2-Norm(final)=4.021 | 5847.3 samples/s | 91.4 steps/s
[Step=3050 Epoch= 5.9] | Loss=0.08750 | Reg=0.00288 | acc=0.9531 | L2-Norm=16.967 | L2-Norm(final)=4.019 | 1959.0 samples/s | 30.6 steps/s
[Step=3100 Epoch= 6.0] | Loss=0.08476 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.988 | L2-Norm(final)=4.018 | 4882.9 samples/s | 76.3 steps/s
[Step=3150 Epoch= 6.1] | Loss=0.08232 | Reg=0.00289 | acc=0.9375 | L2-Norm=17.008 | L2-Norm(final)=4.016 | 4879.4 samples/s | 76.2 steps/s
[Step=3200 Epoch= 6.2] | Loss=0.07998 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.027 | L2-Norm(final)=4.015 | 4883.6 samples/s | 76.3 steps/s
[Step=3250 Epoch= 6.3] | Loss=0.07783 | Reg=0.00291 | acc=0.9688 | L2-Norm=17.045 | L2-Norm(final)=4.014 | 4936.1 samples/s | 77.1 steps/s
[Step=3300 Epoch= 6.4] | Loss=0.07660 | Reg=0.00291 | acc=0.9688 | L2-Norm=17.062 | L2-Norm(final)=4.013 | 4890.6 samples/s | 76.4 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.07535 | Reg=0.00292 | acc=0.9844 | L2-Norm=17.079 | L2-Norm(final)=4.011 | 4934.7 samples/s | 77.1 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.07367 | Reg=0.00292 | acc=0.9844 | L2-Norm=17.094 | L2-Norm(final)=4.010 | 4927.0 samples/s | 77.0 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.07257 | Reg=0.00293 | acc=0.9688 | L2-Norm=17.110 | L2-Norm(final)=4.008 | 4854.6 samples/s | 75.9 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.07143 | Reg=0.00293 | acc=0.9375 | L2-Norm=17.125 | L2-Norm(final)=4.006 | 5194.3 samples/s | 81.2 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.06971 | Reg=0.00294 | acc=0.9844 | L2-Norm=17.140 | L2-Norm(final)=4.004 | 2070.1 samples/s | 32.3 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.06817 | Reg=0.00294 | acc=0.9375 | L2-Norm=17.154 | L2-Norm(final)=4.003 | 4721.5 samples/s | 73.8 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.06706 | Reg=0.00295 | acc=0.9531 | L2-Norm=17.167 | L2-Norm(final)=4.002 | 4671.9 samples/s | 73.0 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.06546 | Reg=0.00295 | acc=0.9375 | L2-Norm=17.179 | L2-Norm(final)=4.001 | 4795.6 samples/s | 74.9 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.06425 | Reg=0.00296 | acc=0.9375 | L2-Norm=17.192 | L2-Norm(final)=4.001 | 4816.3 samples/s | 75.3 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.06327 | Reg=0.00296 | acc=0.9531 | L2-Norm=17.204 | L2-Norm(final)=4.000 | 4778.8 samples/s | 74.7 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.06238 | Reg=0.00296 | acc=0.9688 | L2-Norm=17.216 | L2-Norm(final)=3.999 | 4794.8 samples/s | 74.9 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.06160 | Reg=0.00297 | acc=0.9844 | L2-Norm=17.227 | L2-Norm(final)=3.998 | 4812.8 samples/s | 75.2 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.06068 | Reg=0.00297 | acc=0.9688 | L2-Norm=17.237 | L2-Norm(final)=3.998 | 4704.8 samples/s | 73.5 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.05998 | Reg=0.00298 | acc=0.9531 | L2-Norm=17.248 | L2-Norm(final)=3.997 | 4866.0 samples/s | 76.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step4000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 3.9] | Loss=0.13140 | Reg=0.00267 | acc=0.9219 | L2-Norm=16.340 | L2-Norm(final)=2.881 | 4403.4 samples/s | 68.8 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.16342 | Reg=0.00267 | acc=0.8906 | L2-Norm=16.337 | L2-Norm(final)=2.991 | 5218.4 samples/s | 81.5 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.15715 | Reg=0.00267 | acc=0.8750 | L2-Norm=16.337 | L2-Norm(final)=3.119 | 5496.4 samples/s | 85.9 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.15661 | Reg=0.00267 | acc=0.7969 | L2-Norm=16.337 | L2-Norm(final)=3.225 | 5557.4 samples/s | 86.8 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.15337 | Reg=0.00267 | acc=0.9062 | L2-Norm=16.337 | L2-Norm(final)=3.319 | 5376.2 samples/s | 84.0 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.15225 | Reg=0.00267 | acc=0.9062 | L2-Norm=16.337 | L2-Norm(final)=3.402 | 5599.7 samples/s | 87.5 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.15124 | Reg=0.00267 | acc=0.8125 | L2-Norm=16.337 | L2-Norm(final)=3.477 | 5418.0 samples/s | 84.7 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.15026 | Reg=0.00267 | acc=0.9219 | L2-Norm=16.337 | L2-Norm(final)=3.546 | 5605.4 samples/s | 87.6 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.14962 | Reg=0.00267 | acc=0.8594 | L2-Norm=16.337 | L2-Norm(final)=3.610 | 5548.3 samples/s | 86.7 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.14826 | Reg=0.00267 | acc=0.8438 | L2-Norm=16.337 | L2-Norm(final)=3.667 | 5411.6 samples/s | 84.6 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.14738 | Reg=0.00267 | acc=0.8594 | L2-Norm=16.337 | L2-Norm(final)=3.722 | 7008.5 samples/s | 109.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 4.9] | Loss=0.11805 | Reg=0.00267 | acc=0.9219 | L2-Norm=16.337 | L2-Norm(final)=4.249 | 4557.9 samples/s | 71.2 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.12510 | Reg=0.00273 | acc=0.9219 | L2-Norm=16.520 | L2-Norm(final)=4.242 | 4546.6 samples/s | 71.0 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.12066 | Reg=0.00276 | acc=0.8750 | L2-Norm=16.614 | L2-Norm(final)=4.234 | 4819.1 samples/s | 75.3 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.11806 | Reg=0.00278 | acc=0.8906 | L2-Norm=16.670 | L2-Norm(final)=4.227 | 4811.9 samples/s | 75.2 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.11188 | Reg=0.00279 | acc=0.9219 | L2-Norm=16.713 | L2-Norm(final)=4.222 | 4803.7 samples/s | 75.1 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.10684 | Reg=0.00280 | acc=0.8906 | L2-Norm=16.746 | L2-Norm(final)=4.218 | 4818.3 samples/s | 75.3 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.10531 | Reg=0.00281 | acc=0.8594 | L2-Norm=16.772 | L2-Norm(final)=4.214 | 4811.6 samples/s | 75.2 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.10054 | Reg=0.00282 | acc=0.9219 | L2-Norm=16.798 | L2-Norm(final)=4.211 | 4802.0 samples/s | 75.0 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.09745 | Reg=0.00283 | acc=0.9375 | L2-Norm=16.820 | L2-Norm(final)=4.209 | 4718.7 samples/s | 73.7 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.09413 | Reg=0.00284 | acc=0.9688 | L2-Norm=16.840 | L2-Norm(final)=4.208 | 4689.3 samples/s | 73.3 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.09083 | Reg=0.00284 | acc=0.8906 | L2-Norm=16.858 | L2-Norm(final)=4.207 | 5912.8 samples/s | 92.4 steps/s
[Step=3050 Epoch= 6.0] | Loss=0.08825 | Reg=0.00285 | acc=0.9688 | L2-Norm=16.875 | L2-Norm(final)=4.206 | 2029.3 samples/s | 31.7 steps/s
[Step=3100 Epoch= 6.1] | Loss=0.08555 | Reg=0.00285 | acc=0.9531 | L2-Norm=16.892 | L2-Norm(final)=4.206 | 4787.8 samples/s | 74.8 steps/s
[Step=3150 Epoch= 6.2] | Loss=0.08270 | Reg=0.00286 | acc=0.9375 | L2-Norm=16.909 | L2-Norm(final)=4.205 | 4787.3 samples/s | 74.8 steps/s
[Step=3200 Epoch= 6.3] | Loss=0.08082 | Reg=0.00286 | acc=0.8906 | L2-Norm=16.924 | L2-Norm(final)=4.206 | 4734.3 samples/s | 74.0 steps/s
[Step=3250 Epoch= 6.4] | Loss=0.07937 | Reg=0.00287 | acc=0.9688 | L2-Norm=16.938 | L2-Norm(final)=4.205 | 4672.6 samples/s | 73.0 steps/s
[Step=3300 Epoch= 6.5] | Loss=0.07741 | Reg=0.00287 | acc=0.9531 | L2-Norm=16.952 | L2-Norm(final)=4.205 | 4751.1 samples/s | 74.2 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.07592 | Reg=0.00288 | acc=0.9844 | L2-Norm=16.965 | L2-Norm(final)=4.205 | 4838.7 samples/s | 75.6 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.07426 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.978 | L2-Norm(final)=4.205 | 4753.2 samples/s | 74.3 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.07290 | Reg=0.00289 | acc=0.9844 | L2-Norm=16.989 | L2-Norm(final)=4.206 | 4849.8 samples/s | 75.8 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.07176 | Reg=0.00289 | acc=0.9844 | L2-Norm=17.000 | L2-Norm(final)=4.205 | 5103.0 samples/s | 79.7 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.07034 | Reg=0.00289 | acc=0.9688 | L2-Norm=17.011 | L2-Norm(final)=4.205 | 2095.9 samples/s | 32.7 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.06884 | Reg=0.00290 | acc=0.9219 | L2-Norm=17.022 | L2-Norm(final)=4.205 | 4820.7 samples/s | 75.3 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.06736 | Reg=0.00290 | acc=0.9844 | L2-Norm=17.032 | L2-Norm(final)=4.206 | 4747.3 samples/s | 74.2 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.06594 | Reg=0.00290 | acc=0.9531 | L2-Norm=17.042 | L2-Norm(final)=4.206 | 4778.5 samples/s | 74.7 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.06509 | Reg=0.00291 | acc=0.9375 | L2-Norm=17.052 | L2-Norm(final)=4.206 | 4697.5 samples/s | 73.4 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.06424 | Reg=0.00291 | acc=0.9844 | L2-Norm=17.062 | L2-Norm(final)=4.206 | 4771.3 samples/s | 74.6 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.06334 | Reg=0.00291 | acc=0.9531 | L2-Norm=17.072 | L2-Norm(final)=4.206 | 4778.0 samples/s | 74.7 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.06267 | Reg=0.00292 | acc=0.9844 | L2-Norm=17.082 | L2-Norm(final)=4.206 | 4796.6 samples/s | 74.9 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.06185 | Reg=0.00292 | acc=0.9844 | L2-Norm=17.091 | L2-Norm(final)=4.206 | 4738.8 samples/s | 74.0 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.06129 | Reg=0.00292 | acc=0.9531 | L2-Norm=17.101 | L2-Norm(final)=4.206 | 4818.9 samples/s | 75.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step4000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 7.7] | Loss=0.11906 | Reg=0.00267 | acc=0.9219 | L2-Norm=16.340 | L2-Norm(final)=3.904 | 4272.9 samples/s | 66.8 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.06823 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.328 | L2-Norm(final)=3.945 | 4890.2 samples/s | 76.4 steps/s
[Step=2100 Epoch= 8.0] | Loss=0.06055 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.326 | L2-Norm(final)=4.101 | 5214.6 samples/s | 81.5 steps/s
[Step=2150 Epoch= 8.2] | Loss=0.05780 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.326 | L2-Norm(final)=4.237 | 5190.0 samples/s | 81.1 steps/s
[Step=2200 Epoch= 8.4] | Loss=0.05741 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.325 | L2-Norm(final)=4.354 | 4878.2 samples/s | 76.2 steps/s
[Step=2250 Epoch= 8.6] | Loss=0.05491 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.325 | L2-Norm(final)=4.455 | 5983.6 samples/s | 93.5 steps/s
[Step=2300 Epoch= 8.8] | Loss=0.05288 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.325 | L2-Norm(final)=4.551 | 1872.9 samples/s | 29.3 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.05195 | Reg=0.00267 | acc=0.9688 | L2-Norm=16.325 | L2-Norm(final)=4.640 | 4610.9 samples/s | 72.0 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.05124 | Reg=0.00267 | acc=0.9531 | L2-Norm=16.325 | L2-Norm(final)=4.722 | 4360.8 samples/s | 68.1 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.05072 | Reg=0.00267 | acc=0.9531 | L2-Norm=16.325 | L2-Norm(final)=4.797 | 4499.9 samples/s | 70.3 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.05005 | Reg=0.00267 | acc=0.9531 | L2-Norm=16.325 | L2-Norm(final)=4.866 | 5068.8 samples/s | 79.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 9.6] | Loss=0.04418 | Reg=0.00266 | acc=0.9688 | L2-Norm=16.325 | L2-Norm(final)=5.527 | 4355.2 samples/s | 68.1 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.06168 | Reg=0.00277 | acc=0.9688 | L2-Norm=16.629 | L2-Norm(final)=5.494 | 4093.9 samples/s | 64.0 steps/s
[Step=2600 Epoch=10.0] | Loss=0.03779 | Reg=0.00281 | acc=0.9844 | L2-Norm=16.763 | L2-Norm(final)=5.474 | 4609.5 samples/s | 72.0 steps/s
[Step=2650 Epoch=10.2] | Loss=0.02700 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.799 | L2-Norm(final)=5.469 | 4526.8 samples/s | 70.7 steps/s
[Step=2700 Epoch=10.3] | Loss=0.02162 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.804 | L2-Norm(final)=5.469 | 4561.3 samples/s | 71.3 steps/s
[Step=2750 Epoch=10.5] | Loss=0.01826 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.798 | L2-Norm(final)=5.468 | 5627.4 samples/s | 87.9 steps/s
[Step=2800 Epoch=10.7] | Loss=0.01543 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.785 | L2-Norm(final)=5.469 | 1974.5 samples/s | 30.9 steps/s
[Step=2850 Epoch=10.9] | Loss=0.01345 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.768 | L2-Norm(final)=5.470 | 4591.6 samples/s | 71.7 steps/s
[Step=2900 Epoch=11.1] | Loss=0.01186 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.748 | L2-Norm(final)=5.472 | 4478.6 samples/s | 70.0 steps/s
[Step=2950 Epoch=11.3] | Loss=0.01062 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.726 | L2-Norm(final)=5.473 | 4500.1 samples/s | 70.3 steps/s
[Step=3000 Epoch=11.5] | Loss=0.00958 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.702 | L2-Norm(final)=5.474 | 5003.8 samples/s | 78.2 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00872 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.676 | L2-Norm(final)=5.476 | 2031.7 samples/s | 31.7 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00800 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.648 | L2-Norm(final)=5.477 | 4570.3 samples/s | 71.4 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00739 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.619 | L2-Norm(final)=5.478 | 4569.0 samples/s | 71.4 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00689 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.590 | L2-Norm(final)=5.479 | 4526.9 samples/s | 70.7 steps/s
[Step=3250 Epoch=12.5] | Loss=0.00643 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.560 | L2-Norm(final)=5.481 | 4568.5 samples/s | 71.4 steps/s
[Step=3300 Epoch=12.6] | Loss=0.00606 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.529 | L2-Norm(final)=5.482 | 2133.8 samples/s | 33.3 steps/s
[Step=3350 Epoch=12.8] | Loss=0.00571 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.499 | L2-Norm(final)=5.483 | 4583.0 samples/s | 71.6 steps/s
[Step=3400 Epoch=13.0] | Loss=0.00539 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.468 | L2-Norm(final)=5.484 | 4548.0 samples/s | 71.1 steps/s
[Step=3450 Epoch=13.2] | Loss=0.00511 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.437 | L2-Norm(final)=5.485 | 4524.6 samples/s | 70.7 steps/s
[Step=3500 Epoch=13.4] | Loss=0.00486 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.406 | L2-Norm(final)=5.485 | 4460.6 samples/s | 69.7 steps/s
[Step=3550 Epoch=13.6] | Loss=0.00463 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.374 | L2-Norm(final)=5.486 | 2145.0 samples/s | 33.5 steps/s
[Step=3600 Epoch=13.8] | Loss=0.00442 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.342 | L2-Norm(final)=5.487 | 4616.3 samples/s | 72.1 steps/s
[Step=3650 Epoch=14.0] | Loss=0.00422 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.310 | L2-Norm(final)=5.488 | 4429.3 samples/s | 69.2 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00405 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.278 | L2-Norm(final)=5.488 | 4521.8 samples/s | 70.7 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00389 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.245 | L2-Norm(final)=5.489 | 4505.3 samples/s | 70.4 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00374 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.213 | L2-Norm(final)=5.489 | 6175.0 samples/s | 96.5 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00360 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.180 | L2-Norm(final)=5.490 | 1937.7 samples/s | 30.3 steps/s
[Step=3900 Epoch=14.9] | Loss=0.00347 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.148 | L2-Norm(final)=5.490 | 4544.9 samples/s | 71.0 steps/s
[Step=3950 Epoch=15.1] | Loss=0.00335 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.115 | L2-Norm(final)=5.491 | 4515.6 samples/s | 70.6 steps/s
[Step=4000 Epoch=15.3] | Loss=0.00324 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.082 | L2-Norm(final)=5.491 | 4528.8 samples/s | 70.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step4000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 7.7] | Loss=0.16428 | Reg=0.00267 | acc=0.8750 | L2-Norm=16.340 | L2-Norm(final)=3.900 | 4482.4 samples/s | 70.0 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.06767 | Reg=0.00267 | acc=0.9688 | L2-Norm=16.329 | L2-Norm(final)=3.904 | 4738.0 samples/s | 74.0 steps/s
[Step=2100 Epoch= 8.1] | Loss=0.05985 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.327 | L2-Norm(final)=4.049 | 5262.8 samples/s | 82.2 steps/s
[Step=2150 Epoch= 8.3] | Loss=0.05485 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.327 | L2-Norm(final)=4.177 | 5099.7 samples/s | 79.7 steps/s
[Step=2200 Epoch= 8.5] | Loss=0.05277 | Reg=0.00267 | acc=0.9219 | L2-Norm=16.327 | L2-Norm(final)=4.290 | 5194.3 samples/s | 81.2 steps/s
[Step=2250 Epoch= 8.7] | Loss=0.05169 | Reg=0.00267 | acc=0.9375 | L2-Norm=16.326 | L2-Norm(final)=4.394 | 6868.6 samples/s | 107.3 steps/s
[Step=2300 Epoch= 8.9] | Loss=0.04981 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.326 | L2-Norm(final)=4.484 | 2033.9 samples/s | 31.8 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.04943 | Reg=0.00267 | acc=0.9688 | L2-Norm=16.326 | L2-Norm(final)=4.570 | 5223.3 samples/s | 81.6 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.04825 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.326 | L2-Norm(final)=4.648 | 5192.2 samples/s | 81.1 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.04754 | Reg=0.00267 | acc=0.9688 | L2-Norm=16.326 | L2-Norm(final)=4.721 | 5413.6 samples/s | 84.6 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.04707 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.326 | L2-Norm(final)=4.791 | 6031.6 samples/s | 94.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 9.6] | Loss=0.04482 | Reg=0.00267 | acc=0.9531 | L2-Norm=16.326 | L2-Norm(final)=5.484 | 4237.3 samples/s | 66.2 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.05061 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.645 | L2-Norm(final)=5.465 | 4355.3 samples/s | 68.1 steps/s
[Step=2600 Epoch=10.0] | Loss=0.03649 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.759 | L2-Norm(final)=5.456 | 4565.4 samples/s | 71.3 steps/s
[Step=2650 Epoch=10.2] | Loss=0.02720 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.803 | L2-Norm(final)=5.452 | 4469.7 samples/s | 69.8 steps/s
[Step=2700 Epoch=10.4] | Loss=0.02195 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.818 | L2-Norm(final)=5.452 | 4531.8 samples/s | 70.8 steps/s
[Step=2750 Epoch=10.6] | Loss=0.01832 | Reg=0.00283 | acc=0.9844 | L2-Norm=16.821 | L2-Norm(final)=5.453 | 5738.3 samples/s | 89.7 steps/s
[Step=2800 Epoch=10.8] | Loss=0.01632 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.819 | L2-Norm(final)=5.454 | 1935.6 samples/s | 30.2 steps/s
[Step=2850 Epoch=11.0] | Loss=0.01408 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.815 | L2-Norm(final)=5.455 | 4546.7 samples/s | 71.0 steps/s
[Step=2900 Epoch=11.2] | Loss=0.01240 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.804 | L2-Norm(final)=5.456 | 4535.2 samples/s | 70.9 steps/s
[Step=2950 Epoch=11.4] | Loss=0.01135 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.789 | L2-Norm(final)=5.457 | 4560.9 samples/s | 71.3 steps/s
[Step=3000 Epoch=11.5] | Loss=0.01048 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.774 | L2-Norm(final)=5.458 | 5130.2 samples/s | 80.2 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00963 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.760 | L2-Norm(final)=5.459 | 2032.0 samples/s | 31.7 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00911 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.745 | L2-Norm(final)=5.460 | 4525.4 samples/s | 70.7 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00876 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.730 | L2-Norm(final)=5.461 | 4495.4 samples/s | 70.2 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00832 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.715 | L2-Norm(final)=5.461 | 4514.8 samples/s | 70.5 steps/s
[Step=3250 Epoch=12.5] | Loss=0.00786 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.700 | L2-Norm(final)=5.461 | 4543.8 samples/s | 71.0 steps/s
[Step=3300 Epoch=12.7] | Loss=0.00751 | Reg=0.00278 | acc=0.9844 | L2-Norm=16.684 | L2-Norm(final)=5.461 | 2118.1 samples/s | 33.1 steps/s
[Step=3350 Epoch=12.9] | Loss=0.00713 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.667 | L2-Norm(final)=5.461 | 4673.5 samples/s | 73.0 steps/s
[Step=3400 Epoch=13.1] | Loss=0.00674 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.649 | L2-Norm(final)=5.461 | 4626.2 samples/s | 72.3 steps/s
[Step=3450 Epoch=13.3] | Loss=0.00639 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.629 | L2-Norm(final)=5.461 | 4539.8 samples/s | 70.9 steps/s
[Step=3500 Epoch=13.5] | Loss=0.00607 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.608 | L2-Norm(final)=5.461 | 4586.0 samples/s | 71.7 steps/s
[Step=3550 Epoch=13.7] | Loss=0.00578 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.586 | L2-Norm(final)=5.461 | 2134.9 samples/s | 33.4 steps/s
[Step=3600 Epoch=13.9] | Loss=0.00552 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.563 | L2-Norm(final)=5.461 | 4683.4 samples/s | 73.2 steps/s
[Step=3650 Epoch=14.1] | Loss=0.00528 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.539 | L2-Norm(final)=5.462 | 4422.0 samples/s | 69.1 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00506 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.515 | L2-Norm(final)=5.462 | 4545.2 samples/s | 71.0 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00486 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.489 | L2-Norm(final)=5.462 | 4513.1 samples/s | 70.5 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00467 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.463 | L2-Norm(final)=5.462 | 6646.4 samples/s | 103.8 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00450 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.437 | L2-Norm(final)=5.463 | 1858.5 samples/s | 29.0 steps/s
[Step=3900 Epoch=15.0] | Loss=0.00434 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.410 | L2-Norm(final)=5.463 | 4552.2 samples/s | 71.1 steps/s
[Step=3950 Epoch=15.2] | Loss=0.00419 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.382 | L2-Norm(final)=5.463 | 4530.6 samples/s | 70.8 steps/s
[Step=4000 Epoch=15.4] | Loss=0.00405 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.355 | L2-Norm(final)=5.463 | 4521.5 samples/s | 70.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08362 | acc=0.9417 | tpr=0.9352 | fpr=0.0441 | 4429.9 samples/s | 17.3 steps/s
Avg test loss: 0.08281, Avg test acc: 0.94222, Avg tpr: 0.93530, Avg fpr: 0.04256, total FA: 332

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07183 | acc=0.9516 | tpr=0.9582 | fpr=0.0629 | 4509.5 samples/s | 17.6 steps/s
Avg test loss: 0.07277, Avg test acc: 0.95116, Avg tpr: 0.95681, Avg fpr: 0.06127, total FA: 478

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.47300 | acc=0.3067 | tpr=0.0160 | fpr=0.0619 | 4466.4 samples/s | 17.4 steps/s
Avg test loss: 6.49441, Avg test acc: 0.30483, Avg tpr: 0.01638, Avg fpr: 0.06076, total FA: 474

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.85391 | acc=0.3131 | tpr=0.0092 | fpr=0.0270 | 4515.3 samples/s | 17.6 steps/s
Avg test loss: 6.85713, Avg test acc: 0.31216, Avg tpr: 0.01125, Avg fpr: 0.02602, total FA: 203

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=2.79469 | acc=0.1632 | tpr=0.7257 | fpr=0.8469 | 4441.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=2.76877 | acc=0.1643 | tpr=0.7058 | fpr=0.8458 | 8526.9 samples/s | 33.3 steps/s
[Step= 150] | Loss=2.77702 | acc=0.1660 | tpr=0.7075 | fpr=0.8440 | 8619.8 samples/s | 33.7 steps/s
[Step= 200] | Loss=2.77895 | acc=0.1660 | tpr=0.7115 | fpr=0.8439 | 8154.1 samples/s | 31.9 steps/s
[Step= 250] | Loss=2.78475 | acc=0.1661 | tpr=0.7066 | fpr=0.8437 | 8640.7 samples/s | 33.8 steps/s
[Step= 300] | Loss=2.78472 | acc=0.1661 | tpr=0.7091 | fpr=0.8438 | 8731.8 samples/s | 34.1 steps/s
[Step= 350] | Loss=2.78299 | acc=0.1654 | tpr=0.7126 | fpr=0.8446 | 8141.5 samples/s | 31.8 steps/s
[Step= 400] | Loss=2.78320 | acc=0.1659 | tpr=0.7128 | fpr=0.8441 | 8699.7 samples/s | 34.0 steps/s
[Step= 450] | Loss=2.78331 | acc=0.1659 | tpr=0.7157 | fpr=0.8441 | 8007.4 samples/s | 31.3 steps/s
[Step= 500] | Loss=2.78139 | acc=0.1659 | tpr=0.7128 | fpr=0.8440 | 8290.2 samples/s | 32.4 steps/s
[Step= 550] | Loss=2.78200 | acc=0.1652 | tpr=0.7155 | fpr=0.8448 | 15620.3 samples/s | 61.0 steps/s
Avg test loss: 2.78266, Avg test acc: 0.16509, Avg tpr: 0.71593, Avg fpr: 0.84492, total FA: 117316

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.03921 | acc=0.1501 | tpr=0.8363 | fpr=0.8623 | 4421.7 samples/s | 17.3 steps/s
[Step= 100] | Loss=3.00076 | acc=0.1511 | tpr=0.8230 | fpr=0.8614 | 8869.5 samples/s | 34.6 steps/s
[Step= 150] | Loss=3.00610 | acc=0.1496 | tpr=0.8156 | fpr=0.8626 | 8226.1 samples/s | 32.1 steps/s
[Step= 200] | Loss=2.99927 | acc=0.1491 | tpr=0.8109 | fpr=0.8630 | 8310.0 samples/s | 32.5 steps/s
[Step= 250] | Loss=3.00888 | acc=0.1494 | tpr=0.8131 | fpr=0.8627 | 8694.5 samples/s | 34.0 steps/s
[Step= 300] | Loss=3.00479 | acc=0.1498 | tpr=0.8131 | fpr=0.8623 | 9077.1 samples/s | 35.5 steps/s
[Step= 350] | Loss=3.00156 | acc=0.1497 | tpr=0.8078 | fpr=0.8623 | 8073.0 samples/s | 31.5 steps/s
[Step= 400] | Loss=3.00213 | acc=0.1502 | tpr=0.8058 | fpr=0.8617 | 8498.2 samples/s | 33.2 steps/s
[Step= 450] | Loss=3.00343 | acc=0.1498 | tpr=0.8121 | fpr=0.8622 | 8468.3 samples/s | 33.1 steps/s
[Step= 500] | Loss=3.00377 | acc=0.1496 | tpr=0.8132 | fpr=0.8623 | 8167.2 samples/s | 31.9 steps/s
[Step= 550] | Loss=3.00603 | acc=0.1489 | tpr=0.8142 | fpr=0.8632 | 14849.6 samples/s | 58.0 steps/s
Avg test loss: 3.00639, Avg test acc: 0.14885, Avg tpr: 0.81418, Avg fpr: 0.86325, total FA: 119860

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08951 | acc=0.9841 | tpr=0.9248 | fpr=0.0149 | 4447.6 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.09164 | acc=0.9832 | tpr=0.9510 | fpr=0.0162 | 8375.2 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.09439 | acc=0.9824 | tpr=0.9539 | fpr=0.0170 | 8320.3 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.09557 | acc=0.9824 | tpr=0.9585 | fpr=0.0172 | 8340.5 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.09495 | acc=0.9823 | tpr=0.9555 | fpr=0.0172 | 8545.3 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.09592 | acc=0.9821 | tpr=0.9527 | fpr=0.0174 | 8177.2 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.09660 | acc=0.9819 | tpr=0.9549 | fpr=0.0176 | 8696.1 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.09689 | acc=0.9817 | tpr=0.9535 | fpr=0.0178 | 8857.0 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.09910 | acc=0.9812 | tpr=0.9513 | fpr=0.0182 | 7787.7 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.09819 | acc=0.9814 | tpr=0.9533 | fpr=0.0181 | 8571.8 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.09712 | acc=0.9817 | tpr=0.9507 | fpr=0.0178 | 15107.7 samples/s | 59.0 steps/s
Avg test loss: 0.09696, Avg test acc: 0.98167, Avg tpr: 0.95087, Avg fpr: 0.01777, total FA: 2468

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.07406 | acc=0.9830 | tpr=0.9292 | fpr=0.0160 | 4375.4 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.07552 | acc=0.9829 | tpr=0.9531 | fpr=0.0165 | 8497.0 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.07796 | acc=0.9820 | tpr=0.9597 | fpr=0.0176 | 8488.6 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.07920 | acc=0.9819 | tpr=0.9661 | fpr=0.0178 | 8218.5 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.07844 | acc=0.9819 | tpr=0.9616 | fpr=0.0177 | 8412.2 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.07906 | acc=0.9815 | tpr=0.9593 | fpr=0.0181 | 8585.6 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.07932 | acc=0.9812 | tpr=0.9580 | fpr=0.0184 | 8808.4 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.08022 | acc=0.9810 | tpr=0.9573 | fpr=0.0186 | 8123.2 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.08170 | acc=0.9807 | tpr=0.9562 | fpr=0.0189 | 8203.8 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.08142 | acc=0.9808 | tpr=0.9573 | fpr=0.0188 | 8342.1 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.08071 | acc=0.9810 | tpr=0.9570 | fpr=0.0186 | 15311.6 samples/s | 59.8 steps/s
Avg test loss: 0.08061, Avg test acc: 0.98101, Avg tpr: 0.95681, Avg fpr: 0.01855, total FA: 2576

server round 2/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.12393 | Reg=0.00237 | acc=0.8906 | L2-Norm=15.379 | L2-Norm(final)=3.972 | 4174.7 samples/s | 65.2 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.13465 | Reg=0.00236 | acc=0.8750 | L2-Norm=15.378 | L2-Norm(final)=4.004 | 5038.7 samples/s | 78.7 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.12562 | Reg=0.00236 | acc=0.8750 | L2-Norm=15.378 | L2-Norm(final)=4.075 | 5502.1 samples/s | 86.0 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.12309 | Reg=0.00236 | acc=0.8594 | L2-Norm=15.378 | L2-Norm(final)=4.149 | 5510.3 samples/s | 86.1 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.11992 | Reg=0.00236 | acc=0.8906 | L2-Norm=15.378 | L2-Norm(final)=4.218 | 5410.5 samples/s | 84.5 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.11863 | Reg=0.00236 | acc=0.9219 | L2-Norm=15.378 | L2-Norm(final)=4.283 | 5471.1 samples/s | 85.5 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.11739 | Reg=0.00236 | acc=0.8594 | L2-Norm=15.378 | L2-Norm(final)=4.346 | 5661.9 samples/s | 88.5 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.11600 | Reg=0.00236 | acc=0.8594 | L2-Norm=15.378 | L2-Norm(final)=4.406 | 5582.2 samples/s | 87.2 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.11566 | Reg=0.00236 | acc=0.8750 | L2-Norm=15.378 | L2-Norm(final)=4.463 | 5685.5 samples/s | 88.8 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.11491 | Reg=0.00236 | acc=0.9219 | L2-Norm=15.378 | L2-Norm(final)=4.516 | 5779.0 samples/s | 90.3 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.11459 | Reg=0.00236 | acc=0.9375 | L2-Norm=15.378 | L2-Norm(final)=4.566 | 6976.2 samples/s | 109.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch= 8.8] | Loss=0.11045 | Reg=0.00236 | acc=0.8906 | L2-Norm=15.378 | L2-Norm(final)=5.050 | 3878.4 samples/s | 60.6 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.09808 | Reg=0.00241 | acc=0.8594 | L2-Norm=15.518 | L2-Norm(final)=5.062 | 4714.3 samples/s | 73.7 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.09246 | Reg=0.00245 | acc=0.9375 | L2-Norm=15.645 | L2-Norm(final)=5.055 | 4734.7 samples/s | 74.0 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.08950 | Reg=0.00248 | acc=0.9219 | L2-Norm=15.735 | L2-Norm(final)=5.047 | 4808.3 samples/s | 75.1 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.08782 | Reg=0.00250 | acc=0.9375 | L2-Norm=15.805 | L2-Norm(final)=5.040 | 4734.9 samples/s | 74.0 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.08378 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.860 | L2-Norm(final)=5.033 | 4787.0 samples/s | 74.8 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.08031 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.908 | L2-Norm(final)=5.028 | 4843.5 samples/s | 75.7 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.07781 | Reg=0.00254 | acc=0.9531 | L2-Norm=15.950 | L2-Norm(final)=5.023 | 4800.4 samples/s | 75.0 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.07565 | Reg=0.00256 | acc=0.9531 | L2-Norm=15.986 | L2-Norm(final)=5.019 | 4806.8 samples/s | 75.1 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.07402 | Reg=0.00257 | acc=0.9219 | L2-Norm=16.019 | L2-Norm(final)=5.015 | 4728.5 samples/s | 73.9 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.07228 | Reg=0.00258 | acc=0.9688 | L2-Norm=16.051 | L2-Norm(final)=5.011 | 5716.2 samples/s | 89.3 steps/s
[Step=5050 Epoch= 9.8] | Loss=0.07015 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.080 | L2-Norm(final)=5.007 | 1948.3 samples/s | 30.4 steps/s
[Step=5100 Epoch= 9.9] | Loss=0.06752 | Reg=0.00260 | acc=0.9688 | L2-Norm=16.109 | L2-Norm(final)=5.005 | 4798.5 samples/s | 75.0 steps/s
[Step=5150 Epoch=10.0] | Loss=0.06533 | Reg=0.00260 | acc=0.9531 | L2-Norm=16.134 | L2-Norm(final)=5.003 | 4817.1 samples/s | 75.3 steps/s
[Step=5200 Epoch=10.1] | Loss=0.06420 | Reg=0.00261 | acc=0.9688 | L2-Norm=16.159 | L2-Norm(final)=5.001 | 4716.3 samples/s | 73.7 steps/s
[Step=5250 Epoch=10.2] | Loss=0.06344 | Reg=0.00262 | acc=0.9375 | L2-Norm=16.183 | L2-Norm(final)=4.999 | 4866.3 samples/s | 76.0 steps/s
[Step=5300 Epoch=10.3] | Loss=0.06203 | Reg=0.00263 | acc=0.9531 | L2-Norm=16.206 | L2-Norm(final)=4.996 | 4689.8 samples/s | 73.3 steps/s
[Step=5350 Epoch=10.4] | Loss=0.06063 | Reg=0.00263 | acc=0.9531 | L2-Norm=16.228 | L2-Norm(final)=4.994 | 4755.9 samples/s | 74.3 steps/s
[Step=5400 Epoch=10.5] | Loss=0.05969 | Reg=0.00264 | acc=0.9219 | L2-Norm=16.249 | L2-Norm(final)=4.992 | 4805.8 samples/s | 75.1 steps/s
[Step=5450 Epoch=10.6] | Loss=0.05885 | Reg=0.00265 | acc=0.9844 | L2-Norm=16.267 | L2-Norm(final)=4.990 | 4749.5 samples/s | 74.2 steps/s
[Step=5500 Epoch=10.7] | Loss=0.05811 | Reg=0.00265 | acc=0.9531 | L2-Norm=16.285 | L2-Norm(final)=4.988 | 5028.0 samples/s | 78.6 steps/s
[Step=5550 Epoch=10.8] | Loss=0.05703 | Reg=0.00266 | acc=0.9688 | L2-Norm=16.303 | L2-Norm(final)=4.986 | 2039.1 samples/s | 31.9 steps/s
[Step=5600 Epoch=10.9] | Loss=0.05580 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.320 | L2-Norm(final)=4.984 | 4868.2 samples/s | 76.1 steps/s
[Step=5650 Epoch=11.0] | Loss=0.05473 | Reg=0.00267 | acc=0.9531 | L2-Norm=16.337 | L2-Norm(final)=4.982 | 4708.6 samples/s | 73.6 steps/s
[Step=5700 Epoch=11.1] | Loss=0.05429 | Reg=0.00268 | acc=0.9531 | L2-Norm=16.353 | L2-Norm(final)=4.980 | 4752.9 samples/s | 74.3 steps/s
[Step=5750 Epoch=11.2] | Loss=0.05354 | Reg=0.00268 | acc=0.9531 | L2-Norm=16.370 | L2-Norm(final)=4.977 | 4761.8 samples/s | 74.4 steps/s
[Step=5800 Epoch=11.3] | Loss=0.05281 | Reg=0.00269 | acc=0.9688 | L2-Norm=16.386 | L2-Norm(final)=4.975 | 4827.0 samples/s | 75.4 steps/s
[Step=5850 Epoch=11.4] | Loss=0.05227 | Reg=0.00269 | acc=0.9844 | L2-Norm=16.401 | L2-Norm(final)=4.973 | 4744.0 samples/s | 74.1 steps/s
[Step=5900 Epoch=11.5] | Loss=0.05162 | Reg=0.00270 | acc=0.9375 | L2-Norm=16.416 | L2-Norm(final)=4.971 | 4783.4 samples/s | 74.7 steps/s
[Step=5950 Epoch=11.6] | Loss=0.05103 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.430 | L2-Norm(final)=4.969 | 4728.3 samples/s | 73.9 steps/s
[Step=6000 Epoch=11.7] | Loss=0.05064 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.445 | L2-Norm(final)=4.966 | 4730.7 samples/s | 73.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step6000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.20927 | Reg=0.00237 | acc=0.7969 | L2-Norm=15.379 | L2-Norm(final)=4.198 | 4284.8 samples/s | 67.0 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.16741 | Reg=0.00237 | acc=0.9531 | L2-Norm=15.383 | L2-Norm(final)=4.098 | 5297.0 samples/s | 82.8 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.14289 | Reg=0.00237 | acc=0.9219 | L2-Norm=15.384 | L2-Norm(final)=4.109 | 5507.7 samples/s | 86.1 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.13319 | Reg=0.00237 | acc=0.9531 | L2-Norm=15.384 | L2-Norm(final)=4.153 | 5470.2 samples/s | 85.5 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.12889 | Reg=0.00237 | acc=0.9062 | L2-Norm=15.385 | L2-Norm(final)=4.202 | 5399.1 samples/s | 84.4 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.12518 | Reg=0.00237 | acc=0.9062 | L2-Norm=15.385 | L2-Norm(final)=4.250 | 5496.4 samples/s | 85.9 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.12319 | Reg=0.00237 | acc=0.8906 | L2-Norm=15.385 | L2-Norm(final)=4.296 | 5525.9 samples/s | 86.3 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.12232 | Reg=0.00237 | acc=0.9219 | L2-Norm=15.385 | L2-Norm(final)=4.339 | 5541.6 samples/s | 86.6 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.12028 | Reg=0.00237 | acc=0.8750 | L2-Norm=15.385 | L2-Norm(final)=4.381 | 5521.8 samples/s | 86.3 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.11968 | Reg=0.00237 | acc=0.9531 | L2-Norm=15.385 | L2-Norm(final)=4.423 | 5518.4 samples/s | 86.2 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.11905 | Reg=0.00237 | acc=0.8594 | L2-Norm=15.385 | L2-Norm(final)=4.460 | 6982.4 samples/s | 109.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch= 8.8] | Loss=0.12634 | Reg=0.00237 | acc=0.8594 | L2-Norm=15.385 | L2-Norm(final)=4.827 | 4192.6 samples/s | 65.5 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.09637 | Reg=0.00241 | acc=0.9688 | L2-Norm=15.533 | L2-Norm(final)=4.846 | 4723.0 samples/s | 73.8 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.08974 | Reg=0.00245 | acc=0.8906 | L2-Norm=15.656 | L2-Norm(final)=4.831 | 4805.4 samples/s | 75.1 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.08790 | Reg=0.00248 | acc=0.9531 | L2-Norm=15.734 | L2-Norm(final)=4.820 | 4720.5 samples/s | 73.8 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.08318 | Reg=0.00250 | acc=0.9688 | L2-Norm=15.799 | L2-Norm(final)=4.814 | 4744.3 samples/s | 74.1 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.08117 | Reg=0.00251 | acc=0.9531 | L2-Norm=15.855 | L2-Norm(final)=4.811 | 4760.7 samples/s | 74.4 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.07937 | Reg=0.00253 | acc=0.9062 | L2-Norm=15.906 | L2-Norm(final)=4.807 | 4772.7 samples/s | 74.6 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.07783 | Reg=0.00254 | acc=0.9219 | L2-Norm=15.951 | L2-Norm(final)=4.804 | 4838.7 samples/s | 75.6 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.07604 | Reg=0.00256 | acc=0.9375 | L2-Norm=15.995 | L2-Norm(final)=4.800 | 4822.6 samples/s | 75.4 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.07439 | Reg=0.00257 | acc=0.9531 | L2-Norm=16.033 | L2-Norm(final)=4.796 | 4824.9 samples/s | 75.4 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.07295 | Reg=0.00258 | acc=0.9375 | L2-Norm=16.069 | L2-Norm(final)=4.793 | 5886.4 samples/s | 92.0 steps/s
[Step=5050 Epoch= 9.9] | Loss=0.07016 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.102 | L2-Norm(final)=4.790 | 2010.4 samples/s | 31.4 steps/s
[Step=5100 Epoch=10.0] | Loss=0.06734 | Reg=0.00260 | acc=0.9688 | L2-Norm=16.132 | L2-Norm(final)=4.788 | 4733.6 samples/s | 74.0 steps/s
[Step=5150 Epoch=10.1] | Loss=0.06589 | Reg=0.00261 | acc=0.9531 | L2-Norm=16.160 | L2-Norm(final)=4.786 | 4708.5 samples/s | 73.6 steps/s
[Step=5200 Epoch=10.2] | Loss=0.06407 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.186 | L2-Norm(final)=4.783 | 4726.6 samples/s | 73.9 steps/s
[Step=5250 Epoch=10.3] | Loss=0.06229 | Reg=0.00263 | acc=0.9844 | L2-Norm=16.211 | L2-Norm(final)=4.781 | 4744.9 samples/s | 74.1 steps/s
[Step=5300 Epoch=10.4] | Loss=0.06128 | Reg=0.00264 | acc=0.9844 | L2-Norm=16.234 | L2-Norm(final)=4.779 | 4707.8 samples/s | 73.6 steps/s
[Step=5350 Epoch=10.5] | Loss=0.06106 | Reg=0.00264 | acc=0.9844 | L2-Norm=16.257 | L2-Norm(final)=4.776 | 4784.9 samples/s | 74.8 steps/s
[Step=5400 Epoch=10.6] | Loss=0.06014 | Reg=0.00265 | acc=0.9688 | L2-Norm=16.279 | L2-Norm(final)=4.772 | 4724.8 samples/s | 73.8 steps/s
[Step=5450 Epoch=10.7] | Loss=0.05922 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.301 | L2-Norm(final)=4.770 | 4820.8 samples/s | 75.3 steps/s
[Step=5500 Epoch=10.8] | Loss=0.05865 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.322 | L2-Norm(final)=4.767 | 5242.1 samples/s | 81.9 steps/s
[Step=5550 Epoch=10.9] | Loss=0.05761 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.343 | L2-Norm(final)=4.764 | 2119.0 samples/s | 33.1 steps/s
[Step=5600 Epoch=10.9] | Loss=0.05618 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.363 | L2-Norm(final)=4.762 | 4849.9 samples/s | 75.8 steps/s
[Step=5650 Epoch=11.0] | Loss=0.05507 | Reg=0.00269 | acc=0.9688 | L2-Norm=16.383 | L2-Norm(final)=4.760 | 4705.0 samples/s | 73.5 steps/s
[Step=5700 Epoch=11.1] | Loss=0.05429 | Reg=0.00269 | acc=0.9688 | L2-Norm=16.401 | L2-Norm(final)=4.759 | 4687.6 samples/s | 73.2 steps/s
[Step=5750 Epoch=11.2] | Loss=0.05325 | Reg=0.00270 | acc=0.9688 | L2-Norm=16.420 | L2-Norm(final)=4.757 | 4805.1 samples/s | 75.1 steps/s
[Step=5800 Epoch=11.3] | Loss=0.05246 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.438 | L2-Norm(final)=4.756 | 4729.0 samples/s | 73.9 steps/s
[Step=5850 Epoch=11.4] | Loss=0.05200 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.456 | L2-Norm(final)=4.754 | 4821.1 samples/s | 75.3 steps/s
[Step=5900 Epoch=11.5] | Loss=0.05144 | Reg=0.00272 | acc=0.9844 | L2-Norm=16.474 | L2-Norm(final)=4.752 | 4825.8 samples/s | 75.4 steps/s
[Step=5950 Epoch=11.6] | Loss=0.05090 | Reg=0.00272 | acc=0.9531 | L2-Norm=16.492 | L2-Norm(final)=4.750 | 4803.9 samples/s | 75.1 steps/s
[Step=6000 Epoch=11.7] | Loss=0.05019 | Reg=0.00273 | acc=0.9844 | L2-Norm=16.509 | L2-Norm(final)=4.748 | 4739.3 samples/s | 74.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step6000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=15.3] | Loss=0.06445 | Reg=0.00237 | acc=0.9531 | L2-Norm=15.379 | L2-Norm(final)=5.505 | 4381.8 samples/s | 68.5 steps/s
[Step=4050 Epoch=15.5] | Loss=0.04392 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.369 | L2-Norm(final)=5.532 | 4610.6 samples/s | 72.0 steps/s
[Step=4100 Epoch=15.7] | Loss=0.03859 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.368 | L2-Norm(final)=5.609 | 5377.8 samples/s | 84.0 steps/s
[Step=4150 Epoch=15.9] | Loss=0.03737 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.367 | L2-Norm(final)=5.689 | 4997.8 samples/s | 78.1 steps/s
[Step=4200 Epoch=16.1] | Loss=0.03689 | Reg=0.00236 | acc=0.9688 | L2-Norm=15.367 | L2-Norm(final)=5.762 | 5156.8 samples/s | 80.6 steps/s
[Step=4250 Epoch=16.3] | Loss=0.03637 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.367 | L2-Norm(final)=5.829 | 6728.5 samples/s | 105.1 steps/s
[Step=4300 Epoch=16.5] | Loss=0.03510 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.367 | L2-Norm(final)=5.896 | 2050.4 samples/s | 32.0 steps/s
[Step=4350 Epoch=16.7] | Loss=0.03486 | Reg=0.00236 | acc=0.9688 | L2-Norm=15.367 | L2-Norm(final)=5.960 | 5137.6 samples/s | 80.3 steps/s
[Step=4400 Epoch=16.9] | Loss=0.03439 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.367 | L2-Norm(final)=6.019 | 5151.4 samples/s | 80.5 steps/s
[Step=4450 Epoch=17.1] | Loss=0.03341 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.367 | L2-Norm(final)=6.075 | 5180.5 samples/s | 80.9 steps/s
[Step=4500 Epoch=17.2] | Loss=0.03307 | Reg=0.00236 | acc=0.9375 | L2-Norm=15.367 | L2-Norm(final)=6.132 | 5773.9 samples/s | 90.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=17.2] | Loss=0.01221 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.366 | L2-Norm(final)=6.681 | 4366.3 samples/s | 68.2 steps/s
[Step=4550 Epoch=17.4] | Loss=0.02703 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.572 | L2-Norm(final)=6.681 | 4474.6 samples/s | 69.9 steps/s
[Step=4600 Epoch=17.6] | Loss=0.02316 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.746 | L2-Norm(final)=6.666 | 4552.8 samples/s | 71.1 steps/s
[Step=4650 Epoch=17.8] | Loss=0.01832 | Reg=0.00251 | acc=0.9688 | L2-Norm=15.848 | L2-Norm(final)=6.657 | 4637.3 samples/s | 72.5 steps/s
[Step=4700 Epoch=18.0] | Loss=0.01564 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.901 | L2-Norm(final)=6.651 | 4491.9 samples/s | 70.2 steps/s
[Step=4750 Epoch=18.2] | Loss=0.01324 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.924 | L2-Norm(final)=6.646 | 5768.3 samples/s | 90.1 steps/s
[Step=4800 Epoch=18.4] | Loss=0.01129 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.931 | L2-Norm(final)=6.645 | 1960.9 samples/s | 30.6 steps/s
[Step=4850 Epoch=18.6] | Loss=0.00974 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.926 | L2-Norm(final)=6.644 | 4490.0 samples/s | 70.2 steps/s
[Step=4900 Epoch=18.8] | Loss=0.00863 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.912 | L2-Norm(final)=6.645 | 4483.6 samples/s | 70.1 steps/s
[Step=4950 Epoch=19.0] | Loss=0.00769 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.894 | L2-Norm(final)=6.645 | 4568.4 samples/s | 71.4 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00693 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.871 | L2-Norm(final)=6.646 | 5011.2 samples/s | 78.3 steps/s
[Step=5050 Epoch=19.3] | Loss=0.00648 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.848 | L2-Norm(final)=6.647 | 2102.5 samples/s | 32.9 steps/s
[Step=5100 Epoch=19.5] | Loss=0.00621 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.827 | L2-Norm(final)=6.647 | 4555.1 samples/s | 71.2 steps/s
[Step=5150 Epoch=19.7] | Loss=0.00596 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.807 | L2-Norm(final)=6.647 | 4621.2 samples/s | 72.2 steps/s
[Step=5200 Epoch=19.9] | Loss=0.00582 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.790 | L2-Norm(final)=6.646 | 4665.8 samples/s | 72.9 steps/s
[Step=5250 Epoch=20.1] | Loss=0.00560 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.775 | L2-Norm(final)=6.645 | 4597.0 samples/s | 71.8 steps/s
[Step=5300 Epoch=20.3] | Loss=0.00530 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.759 | L2-Norm(final)=6.644 | 2139.8 samples/s | 33.4 steps/s
[Step=5350 Epoch=20.5] | Loss=0.00503 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.742 | L2-Norm(final)=6.643 | 4741.9 samples/s | 74.1 steps/s
[Step=5400 Epoch=20.7] | Loss=0.00477 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.725 | L2-Norm(final)=6.643 | 4538.8 samples/s | 70.9 steps/s
[Step=5450 Epoch=20.9] | Loss=0.00452 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.706 | L2-Norm(final)=6.642 | 4543.8 samples/s | 71.0 steps/s
[Step=5500 Epoch=21.1] | Loss=0.00429 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.685 | L2-Norm(final)=6.642 | 4403.1 samples/s | 68.8 steps/s
[Step=5550 Epoch=21.3] | Loss=0.00409 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.663 | L2-Norm(final)=6.642 | 2140.7 samples/s | 33.4 steps/s
[Step=5600 Epoch=21.5] | Loss=0.00391 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.640 | L2-Norm(final)=6.642 | 4518.7 samples/s | 70.6 steps/s
[Step=5650 Epoch=21.6] | Loss=0.00374 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.616 | L2-Norm(final)=6.642 | 4441.6 samples/s | 69.4 steps/s
[Step=5700 Epoch=21.8] | Loss=0.00358 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.592 | L2-Norm(final)=6.641 | 4528.8 samples/s | 70.8 steps/s
[Step=5750 Epoch=22.0] | Loss=0.00344 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.566 | L2-Norm(final)=6.641 | 4509.2 samples/s | 70.5 steps/s
[Step=5800 Epoch=22.2] | Loss=0.00331 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.540 | L2-Norm(final)=6.641 | 6012.0 samples/s | 93.9 steps/s
[Step=5850 Epoch=22.4] | Loss=0.00318 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.513 | L2-Norm(final)=6.641 | 1898.6 samples/s | 29.7 steps/s
[Step=5900 Epoch=22.6] | Loss=0.00307 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.486 | L2-Norm(final)=6.641 | 4510.7 samples/s | 70.5 steps/s
[Step=5950 Epoch=22.8] | Loss=0.00296 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.458 | L2-Norm(final)=6.641 | 4522.6 samples/s | 70.7 steps/s
[Step=6000 Epoch=23.0] | Loss=0.00287 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.430 | L2-Norm(final)=6.641 | 4561.6 samples/s | 71.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step6000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=15.4] | Loss=0.06222 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.379 | L2-Norm(final)=5.470 | 4145.3 samples/s | 64.8 steps/s
[Step=4050 Epoch=15.6] | Loss=0.04653 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.369 | L2-Norm(final)=5.478 | 4933.1 samples/s | 77.1 steps/s
[Step=4100 Epoch=15.8] | Loss=0.03736 | Reg=0.00236 | acc=0.9688 | L2-Norm=15.368 | L2-Norm(final)=5.548 | 5049.2 samples/s | 78.9 steps/s
[Step=4150 Epoch=16.0] | Loss=0.03427 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.368 | L2-Norm(final)=5.637 | 5192.3 samples/s | 81.1 steps/s
[Step=4200 Epoch=16.2] | Loss=0.03298 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.368 | L2-Norm(final)=5.724 | 5088.2 samples/s | 79.5 steps/s
[Step=4250 Epoch=16.4] | Loss=0.03149 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.367 | L2-Norm(final)=5.804 | 6959.7 samples/s | 108.7 steps/s
[Step=4300 Epoch=16.6] | Loss=0.03048 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.367 | L2-Norm(final)=5.881 | 2056.2 samples/s | 32.1 steps/s
[Step=4350 Epoch=16.7] | Loss=0.02941 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.367 | L2-Norm(final)=5.955 | 5368.8 samples/s | 83.9 steps/s
[Step=4400 Epoch=16.9] | Loss=0.02896 | Reg=0.00236 | acc=0.9688 | L2-Norm=15.367 | L2-Norm(final)=6.024 | 5198.2 samples/s | 81.2 steps/s
[Step=4450 Epoch=17.1] | Loss=0.02833 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.367 | L2-Norm(final)=6.090 | 5379.1 samples/s | 84.0 steps/s
[Step=4500 Epoch=17.3] | Loss=0.02792 | Reg=0.00236 | acc=0.9688 | L2-Norm=15.367 | L2-Norm(final)=6.153 | 6153.0 samples/s | 96.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=17.3] | Loss=0.05166 | Reg=0.00236 | acc=0.9531 | L2-Norm=15.367 | L2-Norm(final)=6.783 | 4269.1 samples/s | 66.7 steps/s
[Step=4550 Epoch=17.5] | Loss=0.02542 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.551 | L2-Norm(final)=6.790 | 4506.1 samples/s | 70.4 steps/s
[Step=4600 Epoch=17.7] | Loss=0.02076 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.734 | L2-Norm(final)=6.778 | 4542.0 samples/s | 71.0 steps/s
[Step=4650 Epoch=17.9] | Loss=0.01681 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.830 | L2-Norm(final)=6.764 | 4596.2 samples/s | 71.8 steps/s
[Step=4700 Epoch=18.1] | Loss=0.01398 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.876 | L2-Norm(final)=6.754 | 4487.0 samples/s | 70.1 steps/s
[Step=4750 Epoch=18.3] | Loss=0.01183 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.897 | L2-Norm(final)=6.749 | 5853.1 samples/s | 91.5 steps/s
[Step=4800 Epoch=18.5] | Loss=0.01017 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.905 | L2-Norm(final)=6.746 | 1942.7 samples/s | 30.4 steps/s
[Step=4850 Epoch=18.7] | Loss=0.00874 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.902 | L2-Norm(final)=6.744 | 4518.3 samples/s | 70.6 steps/s
[Step=4900 Epoch=18.9] | Loss=0.00769 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.890 | L2-Norm(final)=6.743 | 4528.1 samples/s | 70.8 steps/s
[Step=4950 Epoch=19.1] | Loss=0.00701 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.874 | L2-Norm(final)=6.742 | 4410.6 samples/s | 68.9 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00634 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.856 | L2-Norm(final)=6.741 | 5060.1 samples/s | 79.1 steps/s
[Step=5050 Epoch=19.4] | Loss=0.00577 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.835 | L2-Norm(final)=6.741 | 2035.5 samples/s | 31.8 steps/s
[Step=5100 Epoch=19.6] | Loss=0.00529 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.811 | L2-Norm(final)=6.741 | 4527.8 samples/s | 70.7 steps/s
[Step=5150 Epoch=19.8] | Loss=0.00489 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.785 | L2-Norm(final)=6.741 | 4482.5 samples/s | 70.0 steps/s
[Step=5200 Epoch=20.0] | Loss=0.00454 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.757 | L2-Norm(final)=6.741 | 4514.3 samples/s | 70.5 steps/s
[Step=5250 Epoch=20.2] | Loss=0.00424 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.728 | L2-Norm(final)=6.742 | 4558.4 samples/s | 71.2 steps/s
[Step=5300 Epoch=20.4] | Loss=0.00398 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.698 | L2-Norm(final)=6.742 | 2092.3 samples/s | 32.7 steps/s
[Step=5350 Epoch=20.6] | Loss=0.00374 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.668 | L2-Norm(final)=6.742 | 4656.6 samples/s | 72.8 steps/s
[Step=5400 Epoch=20.8] | Loss=0.00354 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.637 | L2-Norm(final)=6.742 | 4469.4 samples/s | 69.8 steps/s
[Step=5450 Epoch=21.0] | Loss=0.00335 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.605 | L2-Norm(final)=6.743 | 4522.9 samples/s | 70.7 steps/s
[Step=5500 Epoch=21.2] | Loss=0.00318 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.573 | L2-Norm(final)=6.743 | 4578.4 samples/s | 71.5 steps/s
[Step=5550 Epoch=21.4] | Loss=0.00303 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.540 | L2-Norm(final)=6.743 | 2093.0 samples/s | 32.7 steps/s
[Step=5600 Epoch=21.6] | Loss=0.00289 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.507 | L2-Norm(final)=6.743 | 4517.2 samples/s | 70.6 steps/s
[Step=5650 Epoch=21.7] | Loss=0.00277 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.474 | L2-Norm(final)=6.744 | 4486.2 samples/s | 70.1 steps/s
[Step=5700 Epoch=21.9] | Loss=0.00265 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.441 | L2-Norm(final)=6.744 | 4461.1 samples/s | 69.7 steps/s
[Step=5750 Epoch=22.1] | Loss=0.00255 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.408 | L2-Norm(final)=6.744 | 4495.1 samples/s | 70.2 steps/s
[Step=5800 Epoch=22.3] | Loss=0.00245 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.374 | L2-Norm(final)=6.744 | 6707.4 samples/s | 104.8 steps/s
[Step=5850 Epoch=22.5] | Loss=0.00236 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.340 | L2-Norm(final)=6.745 | 1849.0 samples/s | 28.9 steps/s
[Step=5900 Epoch=22.7] | Loss=0.00227 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.307 | L2-Norm(final)=6.745 | 4492.5 samples/s | 70.2 steps/s
[Step=5950 Epoch=22.9] | Loss=0.00220 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.273 | L2-Norm(final)=6.745 | 4534.7 samples/s | 70.9 steps/s
[Step=6000 Epoch=23.1] | Loss=0.00212 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.239 | L2-Norm(final)=6.745 | 4514.1 samples/s | 70.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step6000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06974 | acc=0.9562 | tpr=0.9792 | fpr=0.0939 | 4407.7 samples/s | 17.2 steps/s
Avg test loss: 0.07037, Avg test acc: 0.95484, Avg tpr: 0.97843, Avg fpr: 0.09704, total FA: 757

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07524 | acc=0.9553 | tpr=0.9700 | fpr=0.0766 | 4357.5 samples/s | 17.0 steps/s
Avg test loss: 0.07769, Avg test acc: 0.95440, Avg tpr: 0.97039, Avg fpr: 0.08076, total FA: 630

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.80304 | acc=0.3116 | tpr=0.0026 | fpr=0.0173 | 4489.9 samples/s | 17.5 steps/s
Avg test loss: 6.83534, Avg test acc: 0.30840, Avg tpr: 0.00210, Avg fpr: 0.01795, total FA: 140

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=8.78847 | acc=0.3137 | tpr=0.0063 | fpr=0.0188 | 4457.2 samples/s | 17.4 steps/s
Avg test loss: 8.78757, Avg test acc: 0.31120, Avg tpr: 0.00705, Avg fpr: 0.01987, total FA: 155

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.18490 | acc=0.0823 | tpr=0.9248 | fpr=0.9328 | 4438.3 samples/s | 17.3 steps/s
[Step= 100] | Loss=4.15026 | acc=0.0835 | tpr=0.9126 | fpr=0.9320 | 8359.8 samples/s | 32.7 steps/s
[Step= 150] | Loss=4.16194 | acc=0.0833 | tpr=0.9207 | fpr=0.9321 | 8406.2 samples/s | 32.8 steps/s
[Step= 200] | Loss=4.15682 | acc=0.0832 | tpr=0.9169 | fpr=0.9320 | 8220.0 samples/s | 32.1 steps/s
[Step= 250] | Loss=4.16032 | acc=0.0833 | tpr=0.9144 | fpr=0.9318 | 8666.0 samples/s | 33.9 steps/s
[Step= 300] | Loss=4.15611 | acc=0.0829 | tpr=0.9178 | fpr=0.9323 | 8388.0 samples/s | 32.8 steps/s
[Step= 350] | Loss=4.15632 | acc=0.0821 | tpr=0.9192 | fpr=0.9331 | 8470.4 samples/s | 33.1 steps/s
[Step= 400] | Loss=4.15712 | acc=0.0823 | tpr=0.9152 | fpr=0.9329 | 8220.6 samples/s | 32.1 steps/s
[Step= 450] | Loss=4.15768 | acc=0.0821 | tpr=0.9202 | fpr=0.9331 | 8503.1 samples/s | 33.2 steps/s
[Step= 500] | Loss=4.15753 | acc=0.0816 | tpr=0.9163 | fpr=0.9335 | 8472.0 samples/s | 33.1 steps/s
[Step= 550] | Loss=4.15852 | acc=0.0816 | tpr=0.9176 | fpr=0.9336 | 14937.0 samples/s | 58.3 steps/s
Avg test loss: 4.15937, Avg test acc: 0.08158, Avg tpr: 0.91799, Avg fpr: 0.93363, total FA: 129632

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.15002 | acc=0.1032 | tpr=0.8274 | fpr=0.9098 | 4453.1 samples/s | 17.4 steps/s
[Step= 100] | Loss=4.11401 | acc=0.1057 | tpr=0.8124 | fpr=0.9074 | 8226.5 samples/s | 32.1 steps/s
[Step= 150] | Loss=4.11473 | acc=0.1055 | tpr=0.8098 | fpr=0.9074 | 8518.6 samples/s | 33.3 steps/s
[Step= 200] | Loss=4.11204 | acc=0.1041 | tpr=0.8087 | fpr=0.9087 | 8343.7 samples/s | 32.6 steps/s
[Step= 250] | Loss=4.12170 | acc=0.1040 | tpr=0.8114 | fpr=0.9089 | 8291.7 samples/s | 32.4 steps/s
[Step= 300] | Loss=4.12110 | acc=0.1037 | tpr=0.8065 | fpr=0.9091 | 8816.2 samples/s | 34.4 steps/s
[Step= 350] | Loss=4.11645 | acc=0.1031 | tpr=0.8059 | fpr=0.9097 | 8184.9 samples/s | 32.0 steps/s
[Step= 400] | Loss=4.11730 | acc=0.1034 | tpr=0.8053 | fpr=0.9094 | 8253.1 samples/s | 32.2 steps/s
[Step= 450] | Loss=4.11772 | acc=0.1033 | tpr=0.8072 | fpr=0.9095 | 8430.4 samples/s | 32.9 steps/s
[Step= 500] | Loss=4.11737 | acc=0.1031 | tpr=0.8062 | fpr=0.9096 | 8706.2 samples/s | 34.0 steps/s
[Step= 550] | Loss=4.12122 | acc=0.1027 | tpr=0.8062 | fpr=0.9101 | 14626.3 samples/s | 57.1 steps/s
Avg test loss: 4.12115, Avg test acc: 0.10264, Avg tpr: 0.80705, Avg fpr: 0.91016, total FA: 126374

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12685 | acc=0.9821 | tpr=0.9425 | fpr=0.0172 | 4441.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.13009 | acc=0.9812 | tpr=0.9467 | fpr=0.0182 | 8503.3 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.13591 | acc=0.9808 | tpr=0.9467 | fpr=0.0186 | 8277.8 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.13923 | acc=0.9809 | tpr=0.9541 | fpr=0.0186 | 8843.2 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.13640 | acc=0.9810 | tpr=0.9511 | fpr=0.0184 | 8256.0 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.13839 | acc=0.9809 | tpr=0.9527 | fpr=0.0186 | 8450.0 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.13950 | acc=0.9807 | tpr=0.9537 | fpr=0.0188 | 8870.4 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.14122 | acc=0.9803 | tpr=0.9502 | fpr=0.0191 | 8134.8 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.14371 | acc=0.9801 | tpr=0.9494 | fpr=0.0193 | 8158.6 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.14338 | acc=0.9802 | tpr=0.9507 | fpr=0.0193 | 8702.2 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.14189 | acc=0.9804 | tpr=0.9507 | fpr=0.0191 | 15193.5 samples/s | 59.3 steps/s
Avg test loss: 0.14164, Avg test acc: 0.98042, Avg tpr: 0.95087, Avg fpr: 0.01904, total FA: 2644

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09846 | acc=0.9817 | tpr=0.9469 | fpr=0.0177 | 4536.3 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.10274 | acc=0.9802 | tpr=0.9510 | fpr=0.0193 | 7991.6 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.10609 | acc=0.9795 | tpr=0.9582 | fpr=0.0202 | 8420.1 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.10717 | acc=0.9798 | tpr=0.9628 | fpr=0.0199 | 8405.6 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.10627 | acc=0.9799 | tpr=0.9633 | fpr=0.0198 | 8571.0 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.10750 | acc=0.9798 | tpr=0.9622 | fpr=0.0199 | 8879.9 samples/s | 34.7 steps/s
[Step= 350] | Loss=0.10774 | acc=0.9795 | tpr=0.9599 | fpr=0.0201 | 7997.3 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.10830 | acc=0.9794 | tpr=0.9568 | fpr=0.0202 | 9367.0 samples/s | 36.6 steps/s
[Step= 450] | Loss=0.11073 | acc=0.9789 | tpr=0.9542 | fpr=0.0206 | 7770.6 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.11034 | acc=0.9790 | tpr=0.9559 | fpr=0.0206 | 8987.7 samples/s | 35.1 steps/s
[Step= 550] | Loss=0.10937 | acc=0.9792 | tpr=0.9562 | fpr=0.0204 | 14739.3 samples/s | 57.6 steps/s
Avg test loss: 0.10915, Avg test acc: 0.97923, Avg tpr: 0.95642, Avg fpr: 0.02036, total FA: 2827

server round 3/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=11.7] | Loss=0.17515 | Reg=0.00213 | acc=0.8438 | L2-Norm=14.606 | L2-Norm(final)=4.902 | 4046.1 samples/s | 63.2 steps/s
[Step=6050 Epoch=11.8] | Loss=0.16849 | Reg=0.00214 | acc=0.8750 | L2-Norm=14.619 | L2-Norm(final)=4.820 | 5254.0 samples/s | 82.1 steps/s
[Step=6100 Epoch=11.9] | Loss=0.14157 | Reg=0.00214 | acc=0.9062 | L2-Norm=14.622 | L2-Norm(final)=4.862 | 5442.5 samples/s | 85.0 steps/s
[Step=6150 Epoch=12.0] | Loss=0.13100 | Reg=0.00214 | acc=0.8750 | L2-Norm=14.622 | L2-Norm(final)=4.939 | 5478.0 samples/s | 85.6 steps/s
[Step=6200 Epoch=12.1] | Loss=0.12278 | Reg=0.00214 | acc=0.9531 | L2-Norm=14.623 | L2-Norm(final)=5.016 | 5552.4 samples/s | 86.8 steps/s
[Step=6250 Epoch=12.2] | Loss=0.11986 | Reg=0.00214 | acc=0.8750 | L2-Norm=14.623 | L2-Norm(final)=5.093 | 5421.4 samples/s | 84.7 steps/s
[Step=6300 Epoch=12.3] | Loss=0.11690 | Reg=0.00214 | acc=0.9375 | L2-Norm=14.623 | L2-Norm(final)=5.165 | 5473.8 samples/s | 85.5 steps/s
[Step=6350 Epoch=12.4] | Loss=0.11487 | Reg=0.00214 | acc=0.8438 | L2-Norm=14.623 | L2-Norm(final)=5.233 | 5415.1 samples/s | 84.6 steps/s
[Step=6400 Epoch=12.5] | Loss=0.11303 | Reg=0.00214 | acc=0.9375 | L2-Norm=14.623 | L2-Norm(final)=5.298 | 5544.9 samples/s | 86.6 steps/s
[Step=6450 Epoch=12.6] | Loss=0.11151 | Reg=0.00214 | acc=0.9375 | L2-Norm=14.623 | L2-Norm(final)=5.358 | 5561.5 samples/s | 86.9 steps/s
[Step=6500 Epoch=12.7] | Loss=0.11022 | Reg=0.00214 | acc=0.9062 | L2-Norm=14.623 | L2-Norm(final)=5.414 | 6923.0 samples/s | 108.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=12.7] | Loss=0.11193 | Reg=0.00214 | acc=0.8906 | L2-Norm=14.624 | L2-Norm(final)=5.966 | 3958.2 samples/s | 61.8 steps/s
[Step=6550 Epoch=12.8] | Loss=0.08735 | Reg=0.00220 | acc=0.9375 | L2-Norm=14.827 | L2-Norm(final)=5.978 | 4738.3 samples/s | 74.0 steps/s
[Step=6600 Epoch=12.9] | Loss=0.08307 | Reg=0.00225 | acc=0.9062 | L2-Norm=14.994 | L2-Norm(final)=5.967 | 4742.7 samples/s | 74.1 steps/s
[Step=6650 Epoch=13.0] | Loss=0.07673 | Reg=0.00228 | acc=0.9219 | L2-Norm=15.102 | L2-Norm(final)=5.958 | 4741.6 samples/s | 74.1 steps/s
[Step=6700 Epoch=13.1] | Loss=0.07401 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.183 | L2-Norm(final)=5.947 | 4778.0 samples/s | 74.7 steps/s
[Step=6750 Epoch=13.2] | Loss=0.07006 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.252 | L2-Norm(final)=5.938 | 4784.8 samples/s | 74.8 steps/s
[Step=6800 Epoch=13.3] | Loss=0.06875 | Reg=0.00234 | acc=0.9688 | L2-Norm=15.309 | L2-Norm(final)=5.930 | 4759.8 samples/s | 74.4 steps/s
[Step=6850 Epoch=13.4] | Loss=0.06624 | Reg=0.00236 | acc=0.9062 | L2-Norm=15.359 | L2-Norm(final)=5.925 | 4783.1 samples/s | 74.7 steps/s
[Step=6900 Epoch=13.5] | Loss=0.06524 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.405 | L2-Norm(final)=5.918 | 4792.1 samples/s | 74.9 steps/s
[Step=6950 Epoch=13.6] | Loss=0.06373 | Reg=0.00239 | acc=0.9375 | L2-Norm=15.445 | L2-Norm(final)=5.912 | 4754.2 samples/s | 74.3 steps/s
[Step=7000 Epoch=13.7] | Loss=0.06254 | Reg=0.00240 | acc=0.8906 | L2-Norm=15.479 | L2-Norm(final)=5.906 | 5833.5 samples/s | 91.1 steps/s
[Step=7050 Epoch=13.8] | Loss=0.06110 | Reg=0.00241 | acc=0.9531 | L2-Norm=15.510 | L2-Norm(final)=5.901 | 1966.3 samples/s | 30.7 steps/s
[Step=7100 Epoch=13.8] | Loss=0.05891 | Reg=0.00242 | acc=0.9531 | L2-Norm=15.538 | L2-Norm(final)=5.897 | 4799.1 samples/s | 75.0 steps/s
[Step=7150 Epoch=13.9] | Loss=0.05725 | Reg=0.00242 | acc=0.9219 | L2-Norm=15.565 | L2-Norm(final)=5.895 | 4745.4 samples/s | 74.1 steps/s
[Step=7200 Epoch=14.0] | Loss=0.05596 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.591 | L2-Norm(final)=5.892 | 4788.0 samples/s | 74.8 steps/s
[Step=7250 Epoch=14.1] | Loss=0.05459 | Reg=0.00244 | acc=0.9375 | L2-Norm=15.617 | L2-Norm(final)=5.889 | 4768.2 samples/s | 74.5 steps/s
[Step=7300 Epoch=14.2] | Loss=0.05337 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.641 | L2-Norm(final)=5.887 | 4779.4 samples/s | 74.7 steps/s
[Step=7350 Epoch=14.3] | Loss=0.05269 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.665 | L2-Norm(final)=5.884 | 4706.1 samples/s | 73.5 steps/s
[Step=7400 Epoch=14.4] | Loss=0.05176 | Reg=0.00246 | acc=0.9688 | L2-Norm=15.687 | L2-Norm(final)=5.881 | 4722.6 samples/s | 73.8 steps/s
[Step=7450 Epoch=14.5] | Loss=0.05103 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.710 | L2-Norm(final)=5.879 | 4780.3 samples/s | 74.7 steps/s
[Step=7500 Epoch=14.6] | Loss=0.05028 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.732 | L2-Norm(final)=5.877 | 5128.4 samples/s | 80.1 steps/s
[Step=7550 Epoch=14.7] | Loss=0.04941 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.754 | L2-Norm(final)=5.874 | 2112.1 samples/s | 33.0 steps/s
[Step=7600 Epoch=14.8] | Loss=0.04860 | Reg=0.00249 | acc=0.9531 | L2-Norm=15.775 | L2-Norm(final)=5.872 | 4909.1 samples/s | 76.7 steps/s
[Step=7650 Epoch=14.9] | Loss=0.04781 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.796 | L2-Norm(final)=5.870 | 4883.2 samples/s | 76.3 steps/s
[Step=7700 Epoch=15.0] | Loss=0.04707 | Reg=0.00250 | acc=0.9688 | L2-Norm=15.817 | L2-Norm(final)=5.868 | 4751.8 samples/s | 74.2 steps/s
[Step=7750 Epoch=15.1] | Loss=0.04653 | Reg=0.00251 | acc=0.9844 | L2-Norm=15.837 | L2-Norm(final)=5.866 | 4830.4 samples/s | 75.5 steps/s
[Step=7800 Epoch=15.2] | Loss=0.04598 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.857 | L2-Norm(final)=5.864 | 4766.9 samples/s | 74.5 steps/s
[Step=7850 Epoch=15.3] | Loss=0.04547 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.877 | L2-Norm(final)=5.862 | 4784.5 samples/s | 74.8 steps/s
[Step=7900 Epoch=15.4] | Loss=0.04524 | Reg=0.00253 | acc=0.9531 | L2-Norm=15.897 | L2-Norm(final)=5.859 | 4855.1 samples/s | 75.9 steps/s
[Step=7950 Epoch=15.5] | Loss=0.04475 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.917 | L2-Norm(final)=5.857 | 4688.0 samples/s | 73.2 steps/s
[Step=8000 Epoch=15.6] | Loss=0.04418 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.937 | L2-Norm(final)=5.855 | 4734.5 samples/s | 74.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step8000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=11.7] | Loss=0.09503 | Reg=0.00213 | acc=0.9531 | L2-Norm=14.606 | L2-Norm(final)=4.704 | 4295.3 samples/s | 67.1 steps/s
[Step=6050 Epoch=11.8] | Loss=0.11458 | Reg=0.00213 | acc=0.9219 | L2-Norm=14.610 | L2-Norm(final)=4.710 | 5531.9 samples/s | 86.4 steps/s
[Step=6100 Epoch=11.9] | Loss=0.10653 | Reg=0.00213 | acc=0.9219 | L2-Norm=14.611 | L2-Norm(final)=4.776 | 5394.2 samples/s | 84.3 steps/s
[Step=6150 Epoch=12.0] | Loss=0.10590 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.612 | L2-Norm(final)=4.851 | 5511.4 samples/s | 86.1 steps/s
[Step=6200 Epoch=12.1] | Loss=0.10406 | Reg=0.00214 | acc=0.8750 | L2-Norm=14.612 | L2-Norm(final)=4.920 | 5521.5 samples/s | 86.3 steps/s
[Step=6250 Epoch=12.2] | Loss=0.10360 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.612 | L2-Norm(final)=4.983 | 5368.3 samples/s | 83.9 steps/s
[Step=6300 Epoch=12.3] | Loss=0.10312 | Reg=0.00214 | acc=0.9219 | L2-Norm=14.612 | L2-Norm(final)=5.042 | 5583.1 samples/s | 87.2 steps/s
[Step=6350 Epoch=12.4] | Loss=0.10280 | Reg=0.00214 | acc=0.9375 | L2-Norm=14.612 | L2-Norm(final)=5.094 | 5397.5 samples/s | 84.3 steps/s
[Step=6400 Epoch=12.5] | Loss=0.10236 | Reg=0.00214 | acc=0.8906 | L2-Norm=14.612 | L2-Norm(final)=5.144 | 5559.7 samples/s | 86.9 steps/s
[Step=6450 Epoch=12.6] | Loss=0.10165 | Reg=0.00214 | acc=0.9219 | L2-Norm=14.612 | L2-Norm(final)=5.192 | 5410.4 samples/s | 84.5 steps/s
[Step=6500 Epoch=12.7] | Loss=0.10155 | Reg=0.00214 | acc=0.9531 | L2-Norm=14.612 | L2-Norm(final)=5.236 | 6940.1 samples/s | 108.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=12.7] | Loss=0.09950 | Reg=0.00214 | acc=0.9531 | L2-Norm=14.612 | L2-Norm(final)=5.651 | 4657.2 samples/s | 72.8 steps/s
[Step=6550 Epoch=12.8] | Loss=0.08604 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.756 | L2-Norm(final)=5.658 | 4283.2 samples/s | 66.9 steps/s
[Step=6600 Epoch=12.9] | Loss=0.08119 | Reg=0.00222 | acc=0.9219 | L2-Norm=14.898 | L2-Norm(final)=5.647 | 4769.8 samples/s | 74.5 steps/s
[Step=6650 Epoch=13.0] | Loss=0.07656 | Reg=0.00225 | acc=0.9844 | L2-Norm=15.006 | L2-Norm(final)=5.642 | 4728.8 samples/s | 73.9 steps/s
[Step=6700 Epoch=13.1] | Loss=0.07480 | Reg=0.00228 | acc=0.9062 | L2-Norm=15.095 | L2-Norm(final)=5.632 | 4823.9 samples/s | 75.4 steps/s
[Step=6750 Epoch=13.2] | Loss=0.07251 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.174 | L2-Norm(final)=5.622 | 4769.1 samples/s | 74.5 steps/s
[Step=6800 Epoch=13.3] | Loss=0.07183 | Reg=0.00232 | acc=0.9531 | L2-Norm=15.239 | L2-Norm(final)=5.615 | 4828.1 samples/s | 75.4 steps/s
[Step=6850 Epoch=13.4] | Loss=0.06874 | Reg=0.00234 | acc=0.9062 | L2-Norm=15.292 | L2-Norm(final)=5.609 | 4838.9 samples/s | 75.6 steps/s
[Step=6900 Epoch=13.5] | Loss=0.06681 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.336 | L2-Norm(final)=5.604 | 4822.3 samples/s | 75.3 steps/s
[Step=6950 Epoch=13.6] | Loss=0.06575 | Reg=0.00237 | acc=0.9688 | L2-Norm=15.380 | L2-Norm(final)=5.599 | 4814.3 samples/s | 75.2 steps/s
[Step=7000 Epoch=13.7] | Loss=0.06393 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.422 | L2-Norm(final)=5.594 | 5909.6 samples/s | 92.3 steps/s
[Step=7050 Epoch=13.8] | Loss=0.06163 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.461 | L2-Norm(final)=5.590 | 2025.0 samples/s | 31.6 steps/s
[Step=7100 Epoch=13.9] | Loss=0.06000 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.497 | L2-Norm(final)=5.588 | 4841.4 samples/s | 75.6 steps/s
[Step=7150 Epoch=14.0] | Loss=0.05843 | Reg=0.00241 | acc=0.9688 | L2-Norm=15.533 | L2-Norm(final)=5.585 | 4695.2 samples/s | 73.4 steps/s
[Step=7200 Epoch=14.1] | Loss=0.05677 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.566 | L2-Norm(final)=5.584 | 4850.8 samples/s | 75.8 steps/s
[Step=7250 Epoch=14.2] | Loss=0.05543 | Reg=0.00243 | acc=0.9531 | L2-Norm=15.598 | L2-Norm(final)=5.582 | 4824.4 samples/s | 75.4 steps/s
[Step=7300 Epoch=14.3] | Loss=0.05444 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.628 | L2-Norm(final)=5.579 | 4809.1 samples/s | 75.1 steps/s
[Step=7350 Epoch=14.4] | Loss=0.05379 | Reg=0.00245 | acc=0.9531 | L2-Norm=15.658 | L2-Norm(final)=5.577 | 4818.3 samples/s | 75.3 steps/s
[Step=7400 Epoch=14.5] | Loss=0.05256 | Reg=0.00246 | acc=0.9688 | L2-Norm=15.687 | L2-Norm(final)=5.575 | 4793.5 samples/s | 74.9 steps/s
[Step=7450 Epoch=14.6] | Loss=0.05217 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.715 | L2-Norm(final)=5.573 | 4809.0 samples/s | 75.1 steps/s
[Step=7500 Epoch=14.7] | Loss=0.05120 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.741 | L2-Norm(final)=5.570 | 5139.2 samples/s | 80.3 steps/s
[Step=7550 Epoch=14.8] | Loss=0.05036 | Reg=0.00249 | acc=0.9688 | L2-Norm=15.767 | L2-Norm(final)=5.568 | 2164.7 samples/s | 33.8 steps/s
[Step=7600 Epoch=14.9] | Loss=0.04954 | Reg=0.00250 | acc=0.9375 | L2-Norm=15.792 | L2-Norm(final)=5.566 | 4905.2 samples/s | 76.6 steps/s
[Step=7650 Epoch=15.0] | Loss=0.04866 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.817 | L2-Norm(final)=5.565 | 4883.8 samples/s | 76.3 steps/s
[Step=7700 Epoch=15.1] | Loss=0.04794 | Reg=0.00251 | acc=0.9844 | L2-Norm=15.842 | L2-Norm(final)=5.563 | 4894.5 samples/s | 76.5 steps/s
[Step=7750 Epoch=15.2] | Loss=0.04723 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.866 | L2-Norm(final)=5.561 | 4848.0 samples/s | 75.8 steps/s
[Step=7800 Epoch=15.2] | Loss=0.04701 | Reg=0.00253 | acc=0.9688 | L2-Norm=15.891 | L2-Norm(final)=5.559 | 4802.4 samples/s | 75.0 steps/s
[Step=7850 Epoch=15.3] | Loss=0.04660 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.917 | L2-Norm(final)=5.557 | 4821.0 samples/s | 75.3 steps/s
[Step=7900 Epoch=15.4] | Loss=0.04629 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.942 | L2-Norm(final)=5.555 | 4820.0 samples/s | 75.3 steps/s
[Step=7950 Epoch=15.5] | Loss=0.04590 | Reg=0.00255 | acc=0.9688 | L2-Norm=15.967 | L2-Norm(final)=5.553 | 4791.4 samples/s | 74.9 steps/s
[Step=8000 Epoch=15.6] | Loss=0.04536 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.992 | L2-Norm(final)=5.551 | 4768.8 samples/s | 74.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step8000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=23.0] | Loss=0.02746 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.606 | L2-Norm(final)=6.642 | 4177.9 samples/s | 65.3 steps/s
[Step=6050 Epoch=23.2] | Loss=0.03011 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.596 | L2-Norm(final)=6.675 | 5188.5 samples/s | 81.1 steps/s
[Step=6100 Epoch=23.4] | Loss=0.02635 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.594 | L2-Norm(final)=6.763 | 5197.8 samples/s | 81.2 steps/s
[Step=6150 Epoch=23.6] | Loss=0.02370 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.594 | L2-Norm(final)=6.864 | 5118.3 samples/s | 80.0 steps/s
[Step=6200 Epoch=23.8] | Loss=0.02219 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.594 | L2-Norm(final)=6.966 | 5279.8 samples/s | 82.5 steps/s
[Step=6250 Epoch=23.9] | Loss=0.02149 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.594 | L2-Norm(final)=7.062 | 6815.1 samples/s | 106.5 steps/s
[Step=6300 Epoch=24.1] | Loss=0.02042 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.593 | L2-Norm(final)=7.156 | 2020.5 samples/s | 31.6 steps/s
[Step=6350 Epoch=24.3] | Loss=0.01994 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.593 | L2-Norm(final)=7.244 | 5099.3 samples/s | 79.7 steps/s
[Step=6400 Epoch=24.5] | Loss=0.01933 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.593 | L2-Norm(final)=7.330 | 5137.5 samples/s | 80.3 steps/s
[Step=6450 Epoch=24.7] | Loss=0.01891 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.593 | L2-Norm(final)=7.411 | 5163.5 samples/s | 80.7 steps/s
[Step=6500 Epoch=24.9] | Loss=0.01844 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.593 | L2-Norm(final)=7.489 | 5844.5 samples/s | 91.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=24.9] | Loss=0.01978 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.593 | L2-Norm(final)=8.244 | 4489.6 samples/s | 70.1 steps/s
[Step=6550 Epoch=25.1] | Loss=0.02201 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.831 | L2-Norm(final)=8.249 | 4031.9 samples/s | 63.0 steps/s
[Step=6600 Epoch=25.3] | Loss=0.01891 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.144 | L2-Norm(final)=8.215 | 4434.6 samples/s | 69.3 steps/s
[Step=6650 Epoch=25.5] | Loss=0.01554 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.296 | L2-Norm(final)=8.193 | 4588.8 samples/s | 71.7 steps/s
[Step=6700 Epoch=25.7] | Loss=0.01263 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.370 | L2-Norm(final)=8.181 | 4507.6 samples/s | 70.4 steps/s
[Step=6750 Epoch=25.9] | Loss=0.01079 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.406 | L2-Norm(final)=8.173 | 5677.9 samples/s | 88.7 steps/s
[Step=6800 Epoch=26.1] | Loss=0.00905 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.418 | L2-Norm(final)=8.169 | 1927.3 samples/s | 30.1 steps/s
[Step=6850 Epoch=26.2] | Loss=0.00777 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.415 | L2-Norm(final)=8.166 | 4541.8 samples/s | 71.0 steps/s
[Step=6900 Epoch=26.4] | Loss=0.00680 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.402 | L2-Norm(final)=8.165 | 4590.9 samples/s | 71.7 steps/s
[Step=6950 Epoch=26.6] | Loss=0.00605 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.382 | L2-Norm(final)=8.164 | 4576.8 samples/s | 71.5 steps/s
[Step=7000 Epoch=26.8] | Loss=0.00545 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.358 | L2-Norm(final)=8.163 | 5001.9 samples/s | 78.2 steps/s
[Step=7050 Epoch=27.0] | Loss=0.00496 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.331 | L2-Norm(final)=8.163 | 2038.7 samples/s | 31.9 steps/s
[Step=7100 Epoch=27.2] | Loss=0.00455 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.302 | L2-Norm(final)=8.163 | 4691.3 samples/s | 73.3 steps/s
[Step=7150 Epoch=27.4] | Loss=0.00420 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.271 | L2-Norm(final)=8.163 | 4474.9 samples/s | 69.9 steps/s
[Step=7200 Epoch=27.6] | Loss=0.00390 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.240 | L2-Norm(final)=8.163 | 4521.6 samples/s | 70.6 steps/s
[Step=7250 Epoch=27.8] | Loss=0.00364 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.207 | L2-Norm(final)=8.163 | 4489.0 samples/s | 70.1 steps/s
[Step=7300 Epoch=28.0] | Loss=0.00341 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.173 | L2-Norm(final)=8.163 | 2134.4 samples/s | 33.3 steps/s
[Step=7350 Epoch=28.2] | Loss=0.00321 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.140 | L2-Norm(final)=8.163 | 4646.0 samples/s | 72.6 steps/s
[Step=7400 Epoch=28.4] | Loss=0.00303 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.105 | L2-Norm(final)=8.163 | 4509.1 samples/s | 70.5 steps/s
[Step=7450 Epoch=28.5] | Loss=0.00287 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.071 | L2-Norm(final)=8.163 | 4524.8 samples/s | 70.7 steps/s
[Step=7500 Epoch=28.7] | Loss=0.00273 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.037 | L2-Norm(final)=8.164 | 4573.0 samples/s | 71.5 steps/s
[Step=7550 Epoch=28.9] | Loss=0.00260 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.002 | L2-Norm(final)=8.164 | 2132.0 samples/s | 33.3 steps/s
[Step=7600 Epoch=29.1] | Loss=0.00248 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.967 | L2-Norm(final)=8.164 | 4502.8 samples/s | 70.4 steps/s
[Step=7650 Epoch=29.3] | Loss=0.00238 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.932 | L2-Norm(final)=8.164 | 4487.1 samples/s | 70.1 steps/s
[Step=7700 Epoch=29.5] | Loss=0.00228 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.898 | L2-Norm(final)=8.165 | 4511.5 samples/s | 70.5 steps/s
[Step=7750 Epoch=29.7] | Loss=0.00219 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.863 | L2-Norm(final)=8.165 | 4499.8 samples/s | 70.3 steps/s
[Step=7800 Epoch=29.9] | Loss=0.00210 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.828 | L2-Norm(final)=8.165 | 6047.0 samples/s | 94.5 steps/s
[Step=7850 Epoch=30.1] | Loss=0.00202 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.793 | L2-Norm(final)=8.165 | 1896.2 samples/s | 29.6 steps/s
[Step=7900 Epoch=30.3] | Loss=0.00195 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.759 | L2-Norm(final)=8.166 | 4637.3 samples/s | 72.5 steps/s
[Step=7950 Epoch=30.5] | Loss=0.00189 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.724 | L2-Norm(final)=8.166 | 4601.6 samples/s | 71.9 steps/s
[Step=8000 Epoch=30.7] | Loss=0.00182 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.690 | L2-Norm(final)=8.166 | 4483.0 samples/s | 70.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step8000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=23.1] | Loss=0.08067 | Reg=0.00213 | acc=0.9375 | L2-Norm=14.606 | L2-Norm(final)=6.752 | 4249.9 samples/s | 66.4 steps/s
[Step=6050 Epoch=23.3] | Loss=0.02525 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.595 | L2-Norm(final)=6.784 | 4925.5 samples/s | 77.0 steps/s
[Step=6100 Epoch=23.5] | Loss=0.02070 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.594 | L2-Norm(final)=6.858 | 5137.3 samples/s | 80.3 steps/s
[Step=6150 Epoch=23.7] | Loss=0.01866 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.593 | L2-Norm(final)=6.949 | 5347.7 samples/s | 83.6 steps/s
[Step=6200 Epoch=23.9] | Loss=0.01759 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.593 | L2-Norm(final)=7.043 | 5288.5 samples/s | 82.6 steps/s
[Step=6250 Epoch=24.1] | Loss=0.01673 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.593 | L2-Norm(final)=7.134 | 6934.1 samples/s | 108.3 steps/s
[Step=6300 Epoch=24.3] | Loss=0.01605 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.593 | L2-Norm(final)=7.223 | 2015.6 samples/s | 31.5 steps/s
[Step=6350 Epoch=24.4] | Loss=0.01550 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.593 | L2-Norm(final)=7.309 | 5038.5 samples/s | 78.7 steps/s
[Step=6400 Epoch=24.6] | Loss=0.01505 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.593 | L2-Norm(final)=7.394 | 5171.6 samples/s | 80.8 steps/s
[Step=6450 Epoch=24.8] | Loss=0.01469 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.593 | L2-Norm(final)=7.476 | 5157.1 samples/s | 80.6 steps/s
[Step=6500 Epoch=25.0] | Loss=0.01436 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.593 | L2-Norm(final)=7.556 | 5997.2 samples/s | 93.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=25.0] | Loss=0.01398 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.593 | L2-Norm(final)=8.337 | 4246.0 samples/s | 66.3 steps/s
[Step=6550 Epoch=25.2] | Loss=0.01660 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.810 | L2-Norm(final)=8.347 | 4329.5 samples/s | 67.6 steps/s
[Step=6600 Epoch=25.4] | Loss=0.01923 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.101 | L2-Norm(final)=8.315 | 4678.7 samples/s | 73.1 steps/s
[Step=6650 Epoch=25.6] | Loss=0.01671 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.253 | L2-Norm(final)=8.290 | 4531.2 samples/s | 70.8 steps/s
[Step=6700 Epoch=25.8] | Loss=0.01478 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.339 | L2-Norm(final)=8.273 | 4574.2 samples/s | 71.5 steps/s
[Step=6750 Epoch=26.0] | Loss=0.01314 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.403 | L2-Norm(final)=8.257 | 5678.3 samples/s | 88.7 steps/s
[Step=6800 Epoch=26.2] | Loss=0.01134 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.440 | L2-Norm(final)=8.248 | 1923.1 samples/s | 30.0 steps/s
[Step=6850 Epoch=26.4] | Loss=0.01006 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.458 | L2-Norm(final)=8.241 | 4567.8 samples/s | 71.4 steps/s
[Step=6900 Epoch=26.6] | Loss=0.00891 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.464 | L2-Norm(final)=8.235 | 4654.4 samples/s | 72.7 steps/s
[Step=6950 Epoch=26.8] | Loss=0.00801 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.462 | L2-Norm(final)=8.232 | 4738.6 samples/s | 74.0 steps/s
[Step=7000 Epoch=26.9] | Loss=0.00723 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.454 | L2-Norm(final)=8.229 | 5119.5 samples/s | 80.0 steps/s
[Step=7050 Epoch=27.1] | Loss=0.00659 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.440 | L2-Norm(final)=8.227 | 2046.3 samples/s | 32.0 steps/s
[Step=7100 Epoch=27.3] | Loss=0.00604 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.422 | L2-Norm(final)=8.225 | 4590.1 samples/s | 71.7 steps/s
[Step=7150 Epoch=27.5] | Loss=0.00558 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.401 | L2-Norm(final)=8.224 | 4565.0 samples/s | 71.3 steps/s
[Step=7200 Epoch=27.7] | Loss=0.00518 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.378 | L2-Norm(final)=8.223 | 4521.2 samples/s | 70.6 steps/s
[Step=7250 Epoch=27.9] | Loss=0.00485 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.353 | L2-Norm(final)=8.223 | 4624.4 samples/s | 72.3 steps/s
[Step=7300 Epoch=28.1] | Loss=0.00473 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.328 | L2-Norm(final)=8.222 | 2102.1 samples/s | 32.8 steps/s
[Step=7350 Epoch=28.3] | Loss=0.00449 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.305 | L2-Norm(final)=8.221 | 4539.3 samples/s | 70.9 steps/s
[Step=7400 Epoch=28.5] | Loss=0.00426 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.281 | L2-Norm(final)=8.220 | 4522.2 samples/s | 70.7 steps/s
[Step=7450 Epoch=28.7] | Loss=0.00405 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.257 | L2-Norm(final)=8.219 | 4478.6 samples/s | 70.0 steps/s
[Step=7500 Epoch=28.9] | Loss=0.00385 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.232 | L2-Norm(final)=8.219 | 4597.1 samples/s | 71.8 steps/s
[Step=7550 Epoch=29.1] | Loss=0.00382 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.207 | L2-Norm(final)=8.218 | 2068.7 samples/s | 32.3 steps/s
[Step=7600 Epoch=29.3] | Loss=0.00368 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.185 | L2-Norm(final)=8.218 | 4614.9 samples/s | 72.1 steps/s
[Step=7650 Epoch=29.4] | Loss=0.00361 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.165 | L2-Norm(final)=8.217 | 4476.0 samples/s | 69.9 steps/s
[Step=7700 Epoch=29.6] | Loss=0.00364 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.145 | L2-Norm(final)=8.216 | 4515.4 samples/s | 70.6 steps/s
[Step=7750 Epoch=29.8] | Loss=0.00362 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.128 | L2-Norm(final)=8.213 | 4558.1 samples/s | 71.2 steps/s
[Step=7800 Epoch=30.0] | Loss=0.00355 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.112 | L2-Norm(final)=8.211 | 6588.3 samples/s | 102.9 steps/s
[Step=7850 Epoch=30.2] | Loss=0.00342 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.095 | L2-Norm(final)=8.209 | 1829.1 samples/s | 28.6 steps/s
[Step=7900 Epoch=30.4] | Loss=0.00331 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.077 | L2-Norm(final)=8.207 | 4514.5 samples/s | 70.5 steps/s
[Step=7950 Epoch=30.6] | Loss=0.00326 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.060 | L2-Norm(final)=8.205 | 4626.7 samples/s | 72.3 steps/s
[Step=8000 Epoch=30.8] | Loss=0.00319 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.043 | L2-Norm(final)=8.203 | 4535.8 samples/s | 70.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07439 | acc=0.9539 | tpr=0.9582 | fpr=0.0555 | 4490.2 samples/s | 17.5 steps/s
Avg test loss: 0.07347, Avg test acc: 0.95328, Avg tpr: 0.95768, Avg fpr: 0.05640, total FA: 440

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07452 | acc=0.9573 | tpr=0.9742 | fpr=0.0795 | 4465.9 samples/s | 17.4 steps/s
Avg test loss: 0.07479, Avg test acc: 0.95729, Avg tpr: 0.97383, Avg fpr: 0.07909, total FA: 617

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.03764 | acc=0.3144 | tpr=0.0035 | fpr=0.0107 | 4387.3 samples/s | 17.1 steps/s
Avg test loss: 7.06608, Avg test acc: 0.31164, Avg tpr: 0.00361, Avg fpr: 0.01090, total FA: 85

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.09232 | acc=0.3143 | tpr=0.0050 | fpr=0.0141 | 4413.4 samples/s | 17.2 steps/s
Avg test loss: 6.10959, Avg test acc: 0.31096, Avg tpr: 0.00519, Avg fpr: 0.01654, total FA: 129

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.80707 | acc=0.1372 | tpr=0.7168 | fpr=0.8732 | 4464.0 samples/s | 17.4 steps/s
[Step= 100] | Loss=3.78475 | acc=0.1369 | tpr=0.7164 | fpr=0.8739 | 8344.9 samples/s | 32.6 steps/s
[Step= 150] | Loss=3.79165 | acc=0.1365 | tpr=0.7161 | fpr=0.8742 | 8486.7 samples/s | 33.2 steps/s
[Step= 200] | Loss=3.79062 | acc=0.1369 | tpr=0.7158 | fpr=0.8736 | 8285.0 samples/s | 32.4 steps/s
[Step= 250] | Loss=3.79539 | acc=0.1370 | tpr=0.7249 | fpr=0.8737 | 8848.3 samples/s | 34.6 steps/s
[Step= 300] | Loss=3.79433 | acc=0.1368 | tpr=0.7244 | fpr=0.8739 | 8414.7 samples/s | 32.9 steps/s
[Step= 350] | Loss=3.79240 | acc=0.1366 | tpr=0.7289 | fpr=0.8742 | 8914.3 samples/s | 34.8 steps/s
[Step= 400] | Loss=3.79307 | acc=0.1371 | tpr=0.7248 | fpr=0.8736 | 8040.4 samples/s | 31.4 steps/s
[Step= 450] | Loss=3.79561 | acc=0.1373 | tpr=0.7327 | fpr=0.8735 | 8310.3 samples/s | 32.5 steps/s
[Step= 500] | Loss=3.79445 | acc=0.1373 | tpr=0.7348 | fpr=0.8735 | 8173.3 samples/s | 31.9 steps/s
[Step= 550] | Loss=3.79829 | acc=0.1367 | tpr=0.7366 | fpr=0.8742 | 15820.5 samples/s | 61.8 steps/s
Avg test loss: 3.79883, Avg test acc: 0.13663, Avg tpr: 0.73693, Avg fpr: 0.87428, total FA: 121392

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.08961 | acc=0.1171 | tpr=0.8717 | fpr=0.8965 | 4466.6 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.05713 | acc=0.1180 | tpr=0.8401 | fpr=0.8955 | 8201.5 samples/s | 32.0 steps/s
[Step= 150] | Loss=5.06069 | acc=0.1166 | tpr=0.8401 | fpr=0.8967 | 8522.2 samples/s | 33.3 steps/s
[Step= 200] | Loss=5.06017 | acc=0.1174 | tpr=0.8383 | fpr=0.8958 | 8345.4 samples/s | 32.6 steps/s
[Step= 250] | Loss=5.07782 | acc=0.1174 | tpr=0.8341 | fpr=0.8956 | 8268.4 samples/s | 32.3 steps/s
[Step= 300] | Loss=5.07434 | acc=0.1168 | tpr=0.8356 | fpr=0.8963 | 8525.9 samples/s | 33.3 steps/s
[Step= 350] | Loss=5.07069 | acc=0.1164 | tpr=0.8359 | fpr=0.8966 | 8462.3 samples/s | 33.1 steps/s
[Step= 400] | Loss=5.06940 | acc=0.1167 | tpr=0.8370 | fpr=0.8964 | 8133.3 samples/s | 31.8 steps/s
[Step= 450] | Loss=5.06896 | acc=0.1164 | tpr=0.8403 | fpr=0.8967 | 8777.1 samples/s | 34.3 steps/s
[Step= 500] | Loss=5.06952 | acc=0.1163 | tpr=0.8414 | fpr=0.8968 | 8298.7 samples/s | 32.4 steps/s
[Step= 550] | Loss=5.07131 | acc=0.1161 | tpr=0.8428 | fpr=0.8971 | 15363.4 samples/s | 60.0 steps/s
Avg test loss: 5.07179, Avg test acc: 0.11601, Avg tpr: 0.84311, Avg fpr: 0.89720, total FA: 124575

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12217 | acc=0.9822 | tpr=0.9336 | fpr=0.0169 | 4486.7 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.12694 | acc=0.9811 | tpr=0.9467 | fpr=0.0182 | 8388.2 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.13214 | acc=0.9805 | tpr=0.9510 | fpr=0.0190 | 8478.1 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.13487 | acc=0.9804 | tpr=0.9541 | fpr=0.0191 | 8344.3 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.13260 | acc=0.9806 | tpr=0.9520 | fpr=0.0189 | 8520.0 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.13479 | acc=0.9805 | tpr=0.9505 | fpr=0.0190 | 8477.3 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.13504 | acc=0.9801 | tpr=0.9493 | fpr=0.0193 | 8366.3 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.13626 | acc=0.9799 | tpr=0.9442 | fpr=0.0194 | 8531.4 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.13838 | acc=0.9797 | tpr=0.9421 | fpr=0.0196 | 8480.5 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.13691 | acc=0.9798 | tpr=0.9436 | fpr=0.0195 | 8601.3 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.13584 | acc=0.9800 | tpr=0.9419 | fpr=0.0193 | 14417.7 samples/s | 56.3 steps/s
Avg test loss: 0.13549, Avg test acc: 0.98007, Avg tpr: 0.94176, Avg fpr: 0.01923, total FA: 2670

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16272 | acc=0.9791 | tpr=0.9558 | fpr=0.0205 | 4481.7 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.17197 | acc=0.9780 | tpr=0.9574 | fpr=0.0216 | 8517.4 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.18030 | acc=0.9770 | tpr=0.9582 | fpr=0.0227 | 8277.9 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.18378 | acc=0.9772 | tpr=0.9607 | fpr=0.0225 | 8473.7 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.18188 | acc=0.9771 | tpr=0.9598 | fpr=0.0226 | 8488.6 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.18469 | acc=0.9768 | tpr=0.9600 | fpr=0.0229 | 8506.6 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.18619 | acc=0.9767 | tpr=0.9580 | fpr=0.0230 | 7993.7 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.18801 | acc=0.9765 | tpr=0.9551 | fpr=0.0231 | 8852.6 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.19106 | acc=0.9762 | tpr=0.9552 | fpr=0.0234 | 8206.9 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.18998 | acc=0.9764 | tpr=0.9568 | fpr=0.0232 | 8361.5 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.18837 | acc=0.9766 | tpr=0.9562 | fpr=0.0230 | 14450.9 samples/s | 56.4 steps/s
Avg test loss: 0.18800, Avg test acc: 0.97661, Avg tpr: 0.95602, Avg fpr: 0.02301, total FA: 3195

server round 4/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=15.6] | Loss=0.13398 | Reg=0.00200 | acc=0.8906 | L2-Norm=14.125 | L2-Norm(final)=5.794 | 4025.2 samples/s | 62.9 steps/s
[Step=8050 Epoch=15.7] | Loss=0.10716 | Reg=0.00200 | acc=0.9375 | L2-Norm=14.127 | L2-Norm(final)=5.900 | 5327.2 samples/s | 83.2 steps/s
[Step=8100 Epoch=15.8] | Loss=0.10553 | Reg=0.00200 | acc=0.8906 | L2-Norm=14.128 | L2-Norm(final)=6.028 | 5540.9 samples/s | 86.6 steps/s
[Step=8150 Epoch=15.9] | Loss=0.10597 | Reg=0.00200 | acc=0.9219 | L2-Norm=14.128 | L2-Norm(final)=6.137 | 5520.7 samples/s | 86.3 steps/s
[Step=8200 Epoch=16.0] | Loss=0.10472 | Reg=0.00200 | acc=0.9062 | L2-Norm=14.128 | L2-Norm(final)=6.241 | 5481.2 samples/s | 85.6 steps/s
[Step=8250 Epoch=16.1] | Loss=0.10233 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.128 | L2-Norm(final)=6.342 | 5434.9 samples/s | 84.9 steps/s
[Step=8300 Epoch=16.2] | Loss=0.10109 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.128 | L2-Norm(final)=6.435 | 5551.3 samples/s | 86.7 steps/s
[Step=8350 Epoch=16.3] | Loss=0.09968 | Reg=0.00200 | acc=0.9062 | L2-Norm=14.128 | L2-Norm(final)=6.522 | 5471.4 samples/s | 85.5 steps/s
[Step=8400 Epoch=16.4] | Loss=0.09927 | Reg=0.00200 | acc=0.9062 | L2-Norm=14.128 | L2-Norm(final)=6.604 | 5553.7 samples/s | 86.8 steps/s
[Step=8450 Epoch=16.5] | Loss=0.09845 | Reg=0.00200 | acc=0.9375 | L2-Norm=14.128 | L2-Norm(final)=6.681 | 5511.3 samples/s | 86.1 steps/s
[Step=8500 Epoch=16.6] | Loss=0.09760 | Reg=0.00200 | acc=0.9219 | L2-Norm=14.128 | L2-Norm(final)=6.756 | 6862.5 samples/s | 107.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=16.6] | Loss=0.09744 | Reg=0.00200 | acc=0.9531 | L2-Norm=14.128 | L2-Norm(final)=7.495 | 4313.7 samples/s | 67.4 steps/s
[Step=8550 Epoch=16.7] | Loss=0.08030 | Reg=0.00205 | acc=0.9531 | L2-Norm=14.328 | L2-Norm(final)=7.493 | 4561.6 samples/s | 71.3 steps/s
[Step=8600 Epoch=16.8] | Loss=0.07546 | Reg=0.00210 | acc=0.8906 | L2-Norm=14.490 | L2-Norm(final)=7.471 | 4847.4 samples/s | 75.7 steps/s
[Step=8650 Epoch=16.9] | Loss=0.06876 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.600 | L2-Norm(final)=7.454 | 4775.6 samples/s | 74.6 steps/s
[Step=8700 Epoch=17.0] | Loss=0.06674 | Reg=0.00216 | acc=0.9375 | L2-Norm=14.681 | L2-Norm(final)=7.440 | 4783.5 samples/s | 74.7 steps/s
[Step=8750 Epoch=17.1] | Loss=0.06381 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.748 | L2-Norm(final)=7.431 | 4795.0 samples/s | 74.9 steps/s
[Step=8800 Epoch=17.2] | Loss=0.06232 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.807 | L2-Norm(final)=7.421 | 4819.2 samples/s | 75.3 steps/s
[Step=8850 Epoch=17.3] | Loss=0.06036 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.859 | L2-Norm(final)=7.414 | 4823.6 samples/s | 75.4 steps/s
[Step=8900 Epoch=17.4] | Loss=0.05867 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.907 | L2-Norm(final)=7.409 | 4775.1 samples/s | 74.6 steps/s
[Step=8950 Epoch=17.5] | Loss=0.05714 | Reg=0.00224 | acc=0.9531 | L2-Norm=14.951 | L2-Norm(final)=7.404 | 4709.3 samples/s | 73.6 steps/s
[Step=9000 Epoch=17.6] | Loss=0.05586 | Reg=0.00225 | acc=0.9531 | L2-Norm=14.993 | L2-Norm(final)=7.399 | 5814.4 samples/s | 90.9 steps/s
[Step=9050 Epoch=17.7] | Loss=0.05435 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.033 | L2-Norm(final)=7.395 | 1997.6 samples/s | 31.2 steps/s
[Step=9100 Epoch=17.7] | Loss=0.05235 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.071 | L2-Norm(final)=7.391 | 4866.7 samples/s | 76.0 steps/s
[Step=9150 Epoch=17.8] | Loss=0.05152 | Reg=0.00228 | acc=0.9219 | L2-Norm=15.109 | L2-Norm(final)=7.387 | 4822.2 samples/s | 75.3 steps/s
[Step=9200 Epoch=17.9] | Loss=0.05091 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.145 | L2-Norm(final)=7.383 | 4818.0 samples/s | 75.3 steps/s
[Step=9250 Epoch=18.0] | Loss=0.04972 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.179 | L2-Norm(final)=7.379 | 4821.9 samples/s | 75.3 steps/s
[Step=9300 Epoch=18.1] | Loss=0.04843 | Reg=0.00232 | acc=0.9688 | L2-Norm=15.212 | L2-Norm(final)=7.376 | 4741.6 samples/s | 74.1 steps/s
[Step=9350 Epoch=18.2] | Loss=0.04747 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.244 | L2-Norm(final)=7.372 | 4813.7 samples/s | 75.2 steps/s
[Step=9400 Epoch=18.3] | Loss=0.04691 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.275 | L2-Norm(final)=7.370 | 4787.1 samples/s | 74.8 steps/s
[Step=9450 Epoch=18.4] | Loss=0.04651 | Reg=0.00234 | acc=0.9688 | L2-Norm=15.306 | L2-Norm(final)=7.367 | 4811.7 samples/s | 75.2 steps/s
[Step=9500 Epoch=18.5] | Loss=0.04584 | Reg=0.00235 | acc=0.9688 | L2-Norm=15.336 | L2-Norm(final)=7.363 | 5034.5 samples/s | 78.7 steps/s
[Step=9550 Epoch=18.6] | Loss=0.04520 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.366 | L2-Norm(final)=7.360 | 2049.9 samples/s | 32.0 steps/s
[Step=9600 Epoch=18.7] | Loss=0.04427 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.395 | L2-Norm(final)=7.357 | 4764.8 samples/s | 74.4 steps/s
[Step=9650 Epoch=18.8] | Loss=0.04366 | Reg=0.00238 | acc=0.9531 | L2-Norm=15.422 | L2-Norm(final)=7.354 | 4767.0 samples/s | 74.5 steps/s
[Step=9700 Epoch=18.9] | Loss=0.04291 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.448 | L2-Norm(final)=7.351 | 4769.4 samples/s | 74.5 steps/s
[Step=9750 Epoch=19.0] | Loss=0.04241 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.473 | L2-Norm(final)=7.348 | 4795.6 samples/s | 74.9 steps/s
[Step=9800 Epoch=19.1] | Loss=0.04164 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.498 | L2-Norm(final)=7.344 | 4850.1 samples/s | 75.8 steps/s
[Step=9850 Epoch=19.2] | Loss=0.04119 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.522 | L2-Norm(final)=7.341 | 4783.2 samples/s | 74.7 steps/s
[Step=9900 Epoch=19.3] | Loss=0.04080 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.546 | L2-Norm(final)=7.337 | 4802.9 samples/s | 75.0 steps/s
[Step=9950 Epoch=19.4] | Loss=0.04046 | Reg=0.00243 | acc=0.9375 | L2-Norm=15.570 | L2-Norm(final)=7.334 | 4791.1 samples/s | 74.9 steps/s
[Step=10000 Epoch=19.5] | Loss=0.03999 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.594 | L2-Norm(final)=7.331 | 4802.5 samples/s | 75.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step10000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=15.6] | Loss=0.12153 | Reg=0.00200 | acc=0.8906 | L2-Norm=14.125 | L2-Norm(final)=5.495 | 4316.2 samples/s | 67.4 steps/s
[Step=8050 Epoch=15.7] | Loss=0.13884 | Reg=0.00200 | acc=0.8906 | L2-Norm=14.131 | L2-Norm(final)=5.494 | 5326.6 samples/s | 83.2 steps/s
[Step=8100 Epoch=15.8] | Loss=0.12777 | Reg=0.00200 | acc=0.9375 | L2-Norm=14.132 | L2-Norm(final)=5.600 | 5459.7 samples/s | 85.3 steps/s
[Step=8150 Epoch=15.9] | Loss=0.12433 | Reg=0.00200 | acc=0.8594 | L2-Norm=14.132 | L2-Norm(final)=5.718 | 5539.5 samples/s | 86.6 steps/s
[Step=8200 Epoch=16.0] | Loss=0.12136 | Reg=0.00200 | acc=0.8750 | L2-Norm=14.132 | L2-Norm(final)=5.830 | 5504.9 samples/s | 86.0 steps/s
[Step=8250 Epoch=16.1] | Loss=0.11852 | Reg=0.00200 | acc=0.8906 | L2-Norm=14.133 | L2-Norm(final)=5.938 | 5449.8 samples/s | 85.2 steps/s
[Step=8300 Epoch=16.2] | Loss=0.11664 | Reg=0.00200 | acc=0.9375 | L2-Norm=14.133 | L2-Norm(final)=6.041 | 5527.9 samples/s | 86.4 steps/s
[Step=8350 Epoch=16.3] | Loss=0.11531 | Reg=0.00200 | acc=0.9375 | L2-Norm=14.133 | L2-Norm(final)=6.138 | 5480.0 samples/s | 85.6 steps/s
[Step=8400 Epoch=16.4] | Loss=0.11407 | Reg=0.00200 | acc=0.9375 | L2-Norm=14.133 | L2-Norm(final)=6.231 | 5569.7 samples/s | 87.0 steps/s
[Step=8450 Epoch=16.5] | Loss=0.11264 | Reg=0.00200 | acc=0.9219 | L2-Norm=14.133 | L2-Norm(final)=6.320 | 5415.2 samples/s | 84.6 steps/s
[Step=8500 Epoch=16.6] | Loss=0.11197 | Reg=0.00200 | acc=0.9375 | L2-Norm=14.133 | L2-Norm(final)=6.406 | 6916.0 samples/s | 108.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=16.6] | Loss=0.07772 | Reg=0.00200 | acc=0.9219 | L2-Norm=14.133 | L2-Norm(final)=7.253 | 4513.4 samples/s | 70.5 steps/s
[Step=8550 Epoch=16.7] | Loss=0.08745 | Reg=0.00206 | acc=0.9375 | L2-Norm=14.357 | L2-Norm(final)=7.262 | 4445.0 samples/s | 69.5 steps/s
[Step=8600 Epoch=16.8] | Loss=0.07912 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.531 | L2-Norm(final)=7.246 | 4809.7 samples/s | 75.2 steps/s
[Step=8650 Epoch=16.9] | Loss=0.07142 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.646 | L2-Norm(final)=7.233 | 4676.1 samples/s | 73.1 steps/s
[Step=8700 Epoch=17.0] | Loss=0.06773 | Reg=0.00217 | acc=0.9375 | L2-Norm=14.732 | L2-Norm(final)=7.223 | 4726.6 samples/s | 73.9 steps/s
[Step=8750 Epoch=17.1] | Loss=0.06514 | Reg=0.00219 | acc=0.9531 | L2-Norm=14.803 | L2-Norm(final)=7.215 | 4737.6 samples/s | 74.0 steps/s
[Step=8800 Epoch=17.2] | Loss=0.06309 | Reg=0.00221 | acc=0.9375 | L2-Norm=14.865 | L2-Norm(final)=7.208 | 4809.8 samples/s | 75.2 steps/s
[Step=8850 Epoch=17.3] | Loss=0.06066 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.921 | L2-Norm(final)=7.202 | 4804.1 samples/s | 75.1 steps/s
[Step=8900 Epoch=17.4] | Loss=0.05853 | Reg=0.00224 | acc=0.9375 | L2-Norm=14.972 | L2-Norm(final)=7.197 | 4775.4 samples/s | 74.6 steps/s
[Step=8950 Epoch=17.5] | Loss=0.05817 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.018 | L2-Norm(final)=7.191 | 4700.4 samples/s | 73.4 steps/s
[Step=9000 Epoch=17.6] | Loss=0.05644 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.059 | L2-Norm(final)=7.186 | 5900.5 samples/s | 92.2 steps/s
[Step=9050 Epoch=17.7] | Loss=0.05460 | Reg=0.00228 | acc=0.9531 | L2-Norm=15.098 | L2-Norm(final)=7.182 | 2046.4 samples/s | 32.0 steps/s
[Step=9100 Epoch=17.8] | Loss=0.05305 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.135 | L2-Norm(final)=7.179 | 4741.7 samples/s | 74.1 steps/s
[Step=9150 Epoch=17.9] | Loss=0.05184 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.171 | L2-Norm(final)=7.176 | 4735.2 samples/s | 74.0 steps/s
[Step=9200 Epoch=18.0] | Loss=0.05076 | Reg=0.00231 | acc=0.9531 | L2-Norm=15.205 | L2-Norm(final)=7.174 | 4805.5 samples/s | 75.1 steps/s
[Step=9250 Epoch=18.1] | Loss=0.04958 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.238 | L2-Norm(final)=7.171 | 4693.0 samples/s | 73.3 steps/s
[Step=9300 Epoch=18.2] | Loss=0.04846 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.271 | L2-Norm(final)=7.168 | 4798.5 samples/s | 75.0 steps/s
[Step=9350 Epoch=18.3] | Loss=0.04772 | Reg=0.00234 | acc=0.9688 | L2-Norm=15.302 | L2-Norm(final)=7.166 | 4856.4 samples/s | 75.9 steps/s
[Step=9400 Epoch=18.4] | Loss=0.04744 | Reg=0.00235 | acc=0.9688 | L2-Norm=15.334 | L2-Norm(final)=7.163 | 4774.1 samples/s | 74.6 steps/s
[Step=9450 Epoch=18.5] | Loss=0.04704 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.365 | L2-Norm(final)=7.160 | 4788.1 samples/s | 74.8 steps/s
[Step=9500 Epoch=18.6] | Loss=0.04635 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.395 | L2-Norm(final)=7.157 | 5130.0 samples/s | 80.2 steps/s
[Step=9550 Epoch=18.7] | Loss=0.04558 | Reg=0.00238 | acc=0.9375 | L2-Norm=15.424 | L2-Norm(final)=7.155 | 2135.0 samples/s | 33.4 steps/s
[Step=9600 Epoch=18.8] | Loss=0.04469 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.452 | L2-Norm(final)=7.152 | 4806.5 samples/s | 75.1 steps/s
[Step=9650 Epoch=18.9] | Loss=0.04390 | Reg=0.00240 | acc=0.9531 | L2-Norm=15.480 | L2-Norm(final)=7.150 | 4783.5 samples/s | 74.7 steps/s
[Step=9700 Epoch=19.0] | Loss=0.04338 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.507 | L2-Norm(final)=7.148 | 4777.8 samples/s | 74.7 steps/s
[Step=9750 Epoch=19.1] | Loss=0.04255 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.533 | L2-Norm(final)=7.146 | 4785.5 samples/s | 74.8 steps/s
[Step=9800 Epoch=19.2] | Loss=0.04211 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.559 | L2-Norm(final)=7.144 | 4871.7 samples/s | 76.1 steps/s
[Step=9850 Epoch=19.3] | Loss=0.04172 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.584 | L2-Norm(final)=7.142 | 4718.1 samples/s | 73.7 steps/s
[Step=9900 Epoch=19.4] | Loss=0.04112 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.608 | L2-Norm(final)=7.140 | 4809.6 samples/s | 75.1 steps/s
[Step=9950 Epoch=19.5] | Loss=0.04053 | Reg=0.00245 | acc=0.9688 | L2-Norm=15.633 | L2-Norm(final)=7.138 | 4779.9 samples/s | 74.7 steps/s
[Step=10000 Epoch=19.5] | Loss=0.04034 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.657 | L2-Norm(final)=7.136 | 4831.6 samples/s | 75.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step10000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=30.7] | Loss=0.01462 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.125 | L2-Norm(final)=8.175 | 4286.1 samples/s | 67.0 steps/s
[Step=8050 Epoch=30.8] | Loss=0.01663 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.115 | L2-Norm(final)=8.261 | 4853.9 samples/s | 75.8 steps/s
[Step=8100 Epoch=31.0] | Loss=0.01577 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.114 | L2-Norm(final)=8.384 | 5224.1 samples/s | 81.6 steps/s
[Step=8150 Epoch=31.2] | Loss=0.01553 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.114 | L2-Norm(final)=8.510 | 5157.2 samples/s | 80.6 steps/s
[Step=8200 Epoch=31.4] | Loss=0.01462 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.113 | L2-Norm(final)=8.628 | 5245.7 samples/s | 82.0 steps/s
[Step=8250 Epoch=31.6] | Loss=0.01375 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.113 | L2-Norm(final)=8.740 | 6722.9 samples/s | 105.0 steps/s
[Step=8300 Epoch=31.8] | Loss=0.01313 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.113 | L2-Norm(final)=8.848 | 2077.6 samples/s | 32.5 steps/s
[Step=8350 Epoch=32.0] | Loss=0.01289 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.113 | L2-Norm(final)=8.949 | 5188.4 samples/s | 81.1 steps/s
[Step=8400 Epoch=32.2] | Loss=0.01255 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.113 | L2-Norm(final)=9.047 | 5100.1 samples/s | 79.7 steps/s
[Step=8450 Epoch=32.4] | Loss=0.01213 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.113 | L2-Norm(final)=9.142 | 5098.2 samples/s | 79.7 steps/s
[Step=8500 Epoch=32.6] | Loss=0.01185 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.113 | L2-Norm(final)=9.231 | 5811.6 samples/s | 90.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=32.6] | Loss=0.00632 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.113 | L2-Norm(final)=10.109 | 4127.1 samples/s | 64.5 steps/s
[Step=8550 Epoch=32.8] | Loss=0.03358 | Reg=0.00209 | acc=0.9375 | L2-Norm=14.445 | L2-Norm(final)=10.089 | 4322.3 samples/s | 67.5 steps/s
[Step=8600 Epoch=33.0] | Loss=0.02423 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.823 | L2-Norm(final)=10.022 | 4500.2 samples/s | 70.3 steps/s
[Step=8650 Epoch=33.1] | Loss=0.01933 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.979 | L2-Norm(final)=9.993 | 4549.9 samples/s | 71.1 steps/s
[Step=8700 Epoch=33.3] | Loss=0.01549 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.049 | L2-Norm(final)=9.979 | 4495.6 samples/s | 70.2 steps/s
[Step=8750 Epoch=33.5] | Loss=0.01294 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.082 | L2-Norm(final)=9.971 | 5748.7 samples/s | 89.8 steps/s
[Step=8800 Epoch=33.7] | Loss=0.01086 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.092 | L2-Norm(final)=9.968 | 1935.5 samples/s | 30.2 steps/s
[Step=8850 Epoch=33.9] | Loss=0.00932 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.088 | L2-Norm(final)=9.967 | 4504.1 samples/s | 70.4 steps/s
[Step=8900 Epoch=34.1] | Loss=0.00818 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.074 | L2-Norm(final)=9.966 | 4523.2 samples/s | 70.7 steps/s
[Step=8950 Epoch=34.3] | Loss=0.00727 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.055 | L2-Norm(final)=9.966 | 4455.7 samples/s | 69.6 steps/s
[Step=9000 Epoch=34.5] | Loss=0.00655 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.031 | L2-Norm(final)=9.967 | 4989.0 samples/s | 78.0 steps/s
[Step=9050 Epoch=34.7] | Loss=0.00598 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.006 | L2-Norm(final)=9.967 | 2035.8 samples/s | 31.8 steps/s
[Step=9100 Epoch=34.9] | Loss=0.00548 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.978 | L2-Norm(final)=9.968 | 4432.5 samples/s | 69.3 steps/s
[Step=9150 Epoch=35.1] | Loss=0.00507 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.950 | L2-Norm(final)=9.968 | 4515.7 samples/s | 70.6 steps/s
[Step=9200 Epoch=35.3] | Loss=0.00471 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.921 | L2-Norm(final)=9.969 | 4531.7 samples/s | 70.8 steps/s
[Step=9250 Epoch=35.4] | Loss=0.00439 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.891 | L2-Norm(final)=9.970 | 4466.7 samples/s | 69.8 steps/s
[Step=9300 Epoch=35.6] | Loss=0.00412 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.861 | L2-Norm(final)=9.971 | 2091.3 samples/s | 32.7 steps/s
[Step=9350 Epoch=35.8] | Loss=0.00388 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.830 | L2-Norm(final)=9.971 | 4645.1 samples/s | 72.6 steps/s
[Step=9400 Epoch=36.0] | Loss=0.00366 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.799 | L2-Norm(final)=9.972 | 4499.5 samples/s | 70.3 steps/s
[Step=9450 Epoch=36.2] | Loss=0.00347 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.768 | L2-Norm(final)=9.973 | 4542.4 samples/s | 71.0 steps/s
[Step=9500 Epoch=36.4] | Loss=0.00330 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.736 | L2-Norm(final)=9.973 | 4510.8 samples/s | 70.5 steps/s
[Step=9550 Epoch=36.6] | Loss=0.00314 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.705 | L2-Norm(final)=9.974 | 2123.6 samples/s | 33.2 steps/s
[Step=9600 Epoch=36.8] | Loss=0.00300 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.673 | L2-Norm(final)=9.975 | 4493.0 samples/s | 70.2 steps/s
[Step=9650 Epoch=37.0] | Loss=0.00287 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.641 | L2-Norm(final)=9.975 | 4522.5 samples/s | 70.7 steps/s
[Step=9700 Epoch=37.2] | Loss=0.00275 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.610 | L2-Norm(final)=9.976 | 4493.5 samples/s | 70.2 steps/s
[Step=9750 Epoch=37.4] | Loss=0.00264 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.578 | L2-Norm(final)=9.976 | 4521.8 samples/s | 70.7 steps/s
[Step=9800 Epoch=37.6] | Loss=0.00254 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.547 | L2-Norm(final)=9.977 | 6065.7 samples/s | 94.8 steps/s
[Step=9850 Epoch=37.7] | Loss=0.00244 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.515 | L2-Norm(final)=9.977 | 1911.1 samples/s | 29.9 steps/s
[Step=9900 Epoch=37.9] | Loss=0.00236 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.484 | L2-Norm(final)=9.978 | 4517.1 samples/s | 70.6 steps/s
[Step=9950 Epoch=38.1] | Loss=0.00228 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.453 | L2-Norm(final)=9.978 | 4555.8 samples/s | 71.2 steps/s
[Step=10000 Epoch=38.3] | Loss=0.00220 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.422 | L2-Norm(final)=9.979 | 4456.2 samples/s | 69.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step10000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=30.8] | Loss=0.00967 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.125 | L2-Norm(final)=8.146 | 4257.4 samples/s | 66.5 steps/s
[Step=8050 Epoch=31.0] | Loss=0.01603 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.116 | L2-Norm(final)=8.193 | 5086.0 samples/s | 79.5 steps/s
[Step=8100 Epoch=31.2] | Loss=0.01443 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.115 | L2-Norm(final)=8.275 | 5165.4 samples/s | 80.7 steps/s
[Step=8150 Epoch=31.4] | Loss=0.01345 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.115 | L2-Norm(final)=8.370 | 5194.3 samples/s | 81.2 steps/s
[Step=8200 Epoch=31.6] | Loss=0.01272 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.115 | L2-Norm(final)=8.463 | 5191.3 samples/s | 81.1 steps/s
[Step=8250 Epoch=31.8] | Loss=0.01201 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.114 | L2-Norm(final)=8.550 | 6889.6 samples/s | 107.6 steps/s
[Step=8300 Epoch=31.9] | Loss=0.01141 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.114 | L2-Norm(final)=8.635 | 2034.8 samples/s | 31.8 steps/s
[Step=8350 Epoch=32.1] | Loss=0.01100 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.114 | L2-Norm(final)=8.718 | 5221.3 samples/s | 81.6 steps/s
[Step=8400 Epoch=32.3] | Loss=0.01076 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.114 | L2-Norm(final)=8.798 | 5376.5 samples/s | 84.0 steps/s
[Step=8450 Epoch=32.5] | Loss=0.01064 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.114 | L2-Norm(final)=8.873 | 5184.2 samples/s | 81.0 steps/s
[Step=8500 Epoch=32.7] | Loss=0.01048 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.114 | L2-Norm(final)=8.945 | 6023.3 samples/s | 94.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=32.7] | Loss=0.00997 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.114 | L2-Norm(final)=9.660 | 4188.1 samples/s | 65.4 steps/s
[Step=8550 Epoch=32.9] | Loss=0.00549 | Reg=0.00202 | acc=0.9688 | L2-Norm=14.212 | L2-Norm(final)=9.691 | 4469.3 samples/s | 69.8 steps/s
[Step=8600 Epoch=33.1] | Loss=0.01129 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.440 | L2-Norm(final)=9.664 | 4569.2 samples/s | 71.4 steps/s
[Step=8650 Epoch=33.3] | Loss=0.01115 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.626 | L2-Norm(final)=9.639 | 4468.6 samples/s | 69.8 steps/s
[Step=8700 Epoch=33.5] | Loss=0.00947 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.748 | L2-Norm(final)=9.619 | 4508.0 samples/s | 70.4 steps/s
[Step=8750 Epoch=33.7] | Loss=0.00803 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.818 | L2-Norm(final)=9.609 | 5797.6 samples/s | 90.6 steps/s
[Step=8800 Epoch=33.9] | Loss=0.00741 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.858 | L2-Norm(final)=9.600 | 1910.8 samples/s | 29.9 steps/s
[Step=8850 Epoch=34.1] | Loss=0.00648 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.881 | L2-Norm(final)=9.593 | 4500.0 samples/s | 70.3 steps/s
[Step=8900 Epoch=34.3] | Loss=0.00574 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.891 | L2-Norm(final)=9.589 | 4551.0 samples/s | 71.1 steps/s
[Step=8950 Epoch=34.5] | Loss=0.00512 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.891 | L2-Norm(final)=9.586 | 4502.2 samples/s | 70.3 steps/s
[Step=9000 Epoch=34.6] | Loss=0.00468 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.885 | L2-Norm(final)=9.585 | 5090.4 samples/s | 79.5 steps/s
[Step=9050 Epoch=34.8] | Loss=0.00428 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.873 | L2-Norm(final)=9.583 | 2044.1 samples/s | 31.9 steps/s
[Step=9100 Epoch=35.0] | Loss=0.00393 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.858 | L2-Norm(final)=9.582 | 4620.0 samples/s | 72.2 steps/s
[Step=9150 Epoch=35.2] | Loss=0.00363 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.841 | L2-Norm(final)=9.582 | 4553.6 samples/s | 71.1 steps/s
[Step=9200 Epoch=35.4] | Loss=0.00338 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.821 | L2-Norm(final)=9.581 | 4522.9 samples/s | 70.7 steps/s
[Step=9250 Epoch=35.6] | Loss=0.00315 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.799 | L2-Norm(final)=9.581 | 4598.3 samples/s | 71.8 steps/s
[Step=9300 Epoch=35.8] | Loss=0.00295 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.776 | L2-Norm(final)=9.581 | 2098.9 samples/s | 32.8 steps/s
[Step=9350 Epoch=36.0] | Loss=0.00278 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.751 | L2-Norm(final)=9.581 | 4538.1 samples/s | 70.9 steps/s
[Step=9400 Epoch=36.2] | Loss=0.00263 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.726 | L2-Norm(final)=9.581 | 4580.4 samples/s | 71.6 steps/s
[Step=9450 Epoch=36.4] | Loss=0.00249 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.699 | L2-Norm(final)=9.582 | 4602.3 samples/s | 71.9 steps/s
[Step=9500 Epoch=36.6] | Loss=0.00237 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.673 | L2-Norm(final)=9.582 | 4643.6 samples/s | 72.6 steps/s
[Step=9550 Epoch=36.8] | Loss=0.00225 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.646 | L2-Norm(final)=9.582 | 2144.9 samples/s | 33.5 steps/s
[Step=9600 Epoch=37.0] | Loss=0.00215 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.618 | L2-Norm(final)=9.582 | 4424.1 samples/s | 69.1 steps/s
[Step=9650 Epoch=37.1] | Loss=0.00206 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.590 | L2-Norm(final)=9.582 | 4532.9 samples/s | 70.8 steps/s
[Step=9700 Epoch=37.3] | Loss=0.00197 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.562 | L2-Norm(final)=9.583 | 4451.1 samples/s | 69.5 steps/s
[Step=9750 Epoch=37.5] | Loss=0.00189 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.534 | L2-Norm(final)=9.583 | 4599.9 samples/s | 71.9 steps/s
[Step=9800 Epoch=37.7] | Loss=0.00182 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.506 | L2-Norm(final)=9.583 | 6466.0 samples/s | 101.0 steps/s
[Step=9850 Epoch=37.9] | Loss=0.00175 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.477 | L2-Norm(final)=9.583 | 1842.3 samples/s | 28.8 steps/s
[Step=9900 Epoch=38.1] | Loss=0.00169 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.449 | L2-Norm(final)=9.584 | 4464.7 samples/s | 69.8 steps/s
[Step=9950 Epoch=38.3] | Loss=0.00163 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.420 | L2-Norm(final)=9.584 | 4604.4 samples/s | 71.9 steps/s
[Step=10000 Epoch=38.5] | Loss=0.00158 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.392 | L2-Norm(final)=9.584 | 4446.0 samples/s | 69.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step10000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07390 | acc=0.9574 | tpr=0.9685 | fpr=0.0667 | 4486.1 samples/s | 17.5 steps/s
Avg test loss: 0.07206, Avg test acc: 0.95593, Avg tpr: 0.96654, Avg fpr: 0.06743, total FA: 526

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06818 | acc=0.9581 | tpr=0.9675 | fpr=0.0622 | 4431.3 samples/s | 17.3 steps/s
Avg test loss: 0.06835, Avg test acc: 0.95745, Avg tpr: 0.96748, Avg fpr: 0.06461, total FA: 504

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=8.15715 | acc=0.3164 | tpr=0.0037 | fpr=0.0045 | 4455.5 samples/s | 17.4 steps/s
Avg test loss: 8.16751, Avg test acc: 0.31373, Avg tpr: 0.00379, Avg fpr: 0.00461, total FA: 36

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=8.97335 | acc=0.3135 | tpr=0.0039 | fpr=0.0141 | 4401.6 samples/s | 17.2 steps/s
Avg test loss: 8.97937, Avg test acc: 0.31116, Avg tpr: 0.00408, Avg fpr: 0.01346, total FA: 105

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.74163 | acc=0.1167 | tpr=0.8584 | fpr=0.8966 | 4474.1 samples/s | 17.5 steps/s
[Step= 100] | Loss=4.68604 | acc=0.1201 | tpr=0.8209 | fpr=0.8930 | 8627.6 samples/s | 33.7 steps/s
[Step= 150] | Loss=4.69446 | acc=0.1208 | tpr=0.8256 | fpr=0.8921 | 8312.8 samples/s | 32.5 steps/s
[Step= 200] | Loss=4.69157 | acc=0.1216 | tpr=0.8175 | fpr=0.8911 | 8363.9 samples/s | 32.7 steps/s
[Step= 250] | Loss=4.69700 | acc=0.1213 | tpr=0.8218 | fpr=0.8915 | 9088.9 samples/s | 35.5 steps/s
[Step= 300] | Loss=4.69172 | acc=0.1202 | tpr=0.8204 | fpr=0.8926 | 8303.8 samples/s | 32.4 steps/s
[Step= 350] | Loss=4.69135 | acc=0.1197 | tpr=0.8165 | fpr=0.8930 | 8354.1 samples/s | 32.6 steps/s
[Step= 400] | Loss=4.69141 | acc=0.1206 | tpr=0.8135 | fpr=0.8919 | 8332.0 samples/s | 32.5 steps/s
[Step= 450] | Loss=4.69377 | acc=0.1207 | tpr=0.8194 | fpr=0.8919 | 8436.3 samples/s | 33.0 steps/s
[Step= 500] | Loss=4.69225 | acc=0.1204 | tpr=0.8203 | fpr=0.8922 | 8412.2 samples/s | 32.9 steps/s
[Step= 550] | Loss=4.69548 | acc=0.1201 | tpr=0.8209 | fpr=0.8927 | 15304.4 samples/s | 59.8 steps/s
Avg test loss: 4.69643, Avg test acc: 0.12000, Avg tpr: 0.82132, Avg fpr: 0.89275, total FA: 123956

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.70953 | acc=0.1101 | tpr=0.7522 | fpr=0.9015 | 4511.4 samples/s | 17.6 steps/s
[Step= 100] | Loss=4.69537 | acc=0.1121 | tpr=0.7335 | fpr=0.8995 | 8566.0 samples/s | 33.5 steps/s
[Step= 150] | Loss=4.69056 | acc=0.1120 | tpr=0.7478 | fpr=0.8997 | 8490.2 samples/s | 33.2 steps/s
[Step= 200] | Loss=4.68615 | acc=0.1126 | tpr=0.7399 | fpr=0.8988 | 8659.9 samples/s | 33.8 steps/s
[Step= 250] | Loss=4.69545 | acc=0.1126 | tpr=0.7459 | fpr=0.8989 | 8476.7 samples/s | 33.1 steps/s
[Step= 300] | Loss=4.69362 | acc=0.1123 | tpr=0.7440 | fpr=0.8993 | 8267.6 samples/s | 32.3 steps/s
[Step= 350] | Loss=4.68784 | acc=0.1118 | tpr=0.7383 | fpr=0.8996 | 8239.5 samples/s | 32.2 steps/s
[Step= 400] | Loss=4.68833 | acc=0.1123 | tpr=0.7358 | fpr=0.8991 | 8346.2 samples/s | 32.6 steps/s
[Step= 450] | Loss=4.68832 | acc=0.1124 | tpr=0.7429 | fpr=0.8990 | 8934.4 samples/s | 34.9 steps/s
[Step= 500] | Loss=4.68701 | acc=0.1124 | tpr=0.7476 | fpr=0.8990 | 7991.0 samples/s | 31.2 steps/s
[Step= 550] | Loss=4.69018 | acc=0.1122 | tpr=0.7469 | fpr=0.8994 | 15499.7 samples/s | 60.5 steps/s
Avg test loss: 4.69102, Avg test acc: 0.11211, Avg tpr: 0.74762, Avg fpr: 0.89944, total FA: 124886

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11298 | acc=0.9826 | tpr=0.9469 | fpr=0.0168 | 4506.7 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.11515 | acc=0.9821 | tpr=0.9510 | fpr=0.0173 | 8325.9 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.12101 | acc=0.9812 | tpr=0.9510 | fpr=0.0182 | 8360.8 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.12170 | acc=0.9811 | tpr=0.9519 | fpr=0.0184 | 8867.9 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.11926 | acc=0.9814 | tpr=0.9485 | fpr=0.0180 | 8145.8 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.12017 | acc=0.9813 | tpr=0.9498 | fpr=0.0182 | 8621.2 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.12170 | acc=0.9809 | tpr=0.9493 | fpr=0.0185 | 8345.3 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.12336 | acc=0.9807 | tpr=0.9486 | fpr=0.0188 | 8649.8 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.12620 | acc=0.9803 | tpr=0.9450 | fpr=0.0190 | 8476.4 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.12511 | acc=0.9804 | tpr=0.9463 | fpr=0.0189 | 8342.3 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.12422 | acc=0.9806 | tpr=0.9451 | fpr=0.0187 | 14822.6 samples/s | 57.9 steps/s
Avg test loss: 0.12398, Avg test acc: 0.98065, Avg tpr: 0.94493, Avg fpr: 0.01870, total FA: 2597

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12461 | acc=0.9845 | tpr=0.9469 | fpr=0.0148 | 4451.7 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.13245 | acc=0.9831 | tpr=0.9531 | fpr=0.0163 | 8427.6 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.13798 | acc=0.9823 | tpr=0.9568 | fpr=0.0173 | 8365.6 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.14019 | acc=0.9822 | tpr=0.9596 | fpr=0.0174 | 8285.5 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.13810 | acc=0.9822 | tpr=0.9590 | fpr=0.0174 | 8643.7 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.14042 | acc=0.9820 | tpr=0.9600 | fpr=0.0176 | 8165.1 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.14192 | acc=0.9818 | tpr=0.9593 | fpr=0.0178 | 8901.9 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.14351 | acc=0.9816 | tpr=0.9551 | fpr=0.0179 | 8235.9 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.14568 | acc=0.9814 | tpr=0.9523 | fpr=0.0181 | 8545.9 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.14506 | acc=0.9815 | tpr=0.9537 | fpr=0.0180 | 8332.5 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.14370 | acc=0.9817 | tpr=0.9534 | fpr=0.0178 | 16023.1 samples/s | 62.6 steps/s
Avg test loss: 0.14340, Avg test acc: 0.98169, Avg tpr: 0.95325, Avg fpr: 0.01779, total FA: 2470

server round 5/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=19.5] | Loss=0.08179 | Reg=0.00190 | acc=0.9062 | L2-Norm=13.773 | L2-Norm(final)=7.246 | 4189.4 samples/s | 65.5 steps/s
[Step=10050 Epoch=19.6] | Loss=0.11050 | Reg=0.00190 | acc=0.9219 | L2-Norm=13.782 | L2-Norm(final)=7.310 | 5278.6 samples/s | 82.5 steps/s
[Step=10100 Epoch=19.7] | Loss=0.10590 | Reg=0.00190 | acc=0.9062 | L2-Norm=13.784 | L2-Norm(final)=7.417 | 5405.8 samples/s | 84.5 steps/s
[Step=10150 Epoch=19.8] | Loss=0.10466 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.784 | L2-Norm(final)=7.529 | 5507.0 samples/s | 86.0 steps/s
[Step=10200 Epoch=19.9] | Loss=0.10326 | Reg=0.00190 | acc=0.8906 | L2-Norm=13.784 | L2-Norm(final)=7.629 | 5578.2 samples/s | 87.2 steps/s
[Step=10250 Epoch=20.0] | Loss=0.10213 | Reg=0.00190 | acc=0.9219 | L2-Norm=13.785 | L2-Norm(final)=7.724 | 5549.0 samples/s | 86.7 steps/s
[Step=10300 Epoch=20.1] | Loss=0.10095 | Reg=0.00190 | acc=0.9531 | L2-Norm=13.785 | L2-Norm(final)=7.810 | 5377.3 samples/s | 84.0 steps/s
[Step=10350 Epoch=20.2] | Loss=0.10061 | Reg=0.00190 | acc=0.9375 | L2-Norm=13.785 | L2-Norm(final)=7.891 | 5486.5 samples/s | 85.7 steps/s
[Step=10400 Epoch=20.3] | Loss=0.09933 | Reg=0.00190 | acc=0.9219 | L2-Norm=13.785 | L2-Norm(final)=7.970 | 5555.8 samples/s | 86.8 steps/s
[Step=10450 Epoch=20.4] | Loss=0.09825 | Reg=0.00190 | acc=0.9219 | L2-Norm=13.785 | L2-Norm(final)=8.046 | 5521.4 samples/s | 86.3 steps/s
[Step=10500 Epoch=20.5] | Loss=0.09745 | Reg=0.00190 | acc=0.9375 | L2-Norm=13.785 | L2-Norm(final)=8.121 | 6867.1 samples/s | 107.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=20.5] | Loss=0.05824 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.785 | L2-Norm(final)=8.857 | 4083.6 samples/s | 63.8 steps/s
[Step=10550 Epoch=20.6] | Loss=0.06810 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.973 | L2-Norm(final)=8.872 | 4696.2 samples/s | 73.4 steps/s
[Step=10600 Epoch=20.7] | Loss=0.06311 | Reg=0.00199 | acc=0.8594 | L2-Norm=14.123 | L2-Norm(final)=8.863 | 4802.6 samples/s | 75.0 steps/s
[Step=10650 Epoch=20.8] | Loss=0.06135 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.234 | L2-Norm(final)=8.853 | 4775.8 samples/s | 74.6 steps/s
[Step=10700 Epoch=20.9] | Loss=0.06064 | Reg=0.00205 | acc=0.9375 | L2-Norm=14.328 | L2-Norm(final)=8.842 | 4719.3 samples/s | 73.7 steps/s
[Step=10750 Epoch=21.0] | Loss=0.05909 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.410 | L2-Norm(final)=8.832 | 4798.8 samples/s | 75.0 steps/s
[Step=10800 Epoch=21.1] | Loss=0.05614 | Reg=0.00210 | acc=0.9062 | L2-Norm=14.485 | L2-Norm(final)=8.824 | 4751.7 samples/s | 74.2 steps/s
[Step=10850 Epoch=21.2] | Loss=0.05419 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.550 | L2-Norm(final)=8.817 | 4803.2 samples/s | 75.1 steps/s
[Step=10900 Epoch=21.3] | Loss=0.05290 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.609 | L2-Norm(final)=8.810 | 4801.8 samples/s | 75.0 steps/s
[Step=10950 Epoch=21.4] | Loss=0.05264 | Reg=0.00215 | acc=0.9531 | L2-Norm=14.664 | L2-Norm(final)=8.803 | 4739.2 samples/s | 74.1 steps/s
[Step=11000 Epoch=21.5] | Loss=0.05117 | Reg=0.00217 | acc=0.9375 | L2-Norm=14.716 | L2-Norm(final)=8.797 | 5807.5 samples/s | 90.7 steps/s
[Step=11050 Epoch=21.6] | Loss=0.05011 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.766 | L2-Norm(final)=8.790 | 2041.3 samples/s | 31.9 steps/s
[Step=11100 Epoch=21.6] | Loss=0.04891 | Reg=0.00220 | acc=0.9688 | L2-Norm=14.813 | L2-Norm(final)=8.784 | 4798.1 samples/s | 75.0 steps/s
[Step=11150 Epoch=21.7] | Loss=0.04773 | Reg=0.00221 | acc=0.9531 | L2-Norm=14.858 | L2-Norm(final)=8.778 | 4907.5 samples/s | 76.7 steps/s
[Step=11200 Epoch=21.8] | Loss=0.04691 | Reg=0.00222 | acc=0.9375 | L2-Norm=14.900 | L2-Norm(final)=8.772 | 4914.9 samples/s | 76.8 steps/s
[Step=11250 Epoch=21.9] | Loss=0.04577 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.939 | L2-Norm(final)=8.767 | 4937.4 samples/s | 77.1 steps/s
[Step=11300 Epoch=22.0] | Loss=0.04570 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.976 | L2-Norm(final)=8.761 | 4864.2 samples/s | 76.0 steps/s
[Step=11350 Epoch=22.1] | Loss=0.04500 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.013 | L2-Norm(final)=8.755 | 4827.6 samples/s | 75.4 steps/s
[Step=11400 Epoch=22.2] | Loss=0.04441 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.048 | L2-Norm(final)=8.749 | 4711.5 samples/s | 73.6 steps/s
[Step=11450 Epoch=22.3] | Loss=0.04374 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.082 | L2-Norm(final)=8.743 | 4758.6 samples/s | 74.4 steps/s
[Step=11500 Epoch=22.4] | Loss=0.04349 | Reg=0.00229 | acc=0.9375 | L2-Norm=15.114 | L2-Norm(final)=8.738 | 4969.3 samples/s | 77.6 steps/s
[Step=11550 Epoch=22.5] | Loss=0.04252 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.145 | L2-Norm(final)=8.732 | 2141.1 samples/s | 33.5 steps/s
[Step=11600 Epoch=22.6] | Loss=0.04149 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.174 | L2-Norm(final)=8.728 | 4768.2 samples/s | 74.5 steps/s
[Step=11650 Epoch=22.7] | Loss=0.04072 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.202 | L2-Norm(final)=8.724 | 4763.3 samples/s | 74.4 steps/s
[Step=11700 Epoch=22.8] | Loss=0.04028 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.227 | L2-Norm(final)=8.719 | 4824.7 samples/s | 75.4 steps/s
[Step=11750 Epoch=22.9] | Loss=0.03969 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.252 | L2-Norm(final)=8.715 | 4772.6 samples/s | 74.6 steps/s
[Step=11800 Epoch=23.0] | Loss=0.03917 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.277 | L2-Norm(final)=8.712 | 4799.7 samples/s | 75.0 steps/s
[Step=11850 Epoch=23.1] | Loss=0.03882 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.300 | L2-Norm(final)=8.708 | 4798.8 samples/s | 75.0 steps/s
[Step=11900 Epoch=23.2] | Loss=0.03843 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.323 | L2-Norm(final)=8.704 | 4797.4 samples/s | 75.0 steps/s
[Step=11950 Epoch=23.3] | Loss=0.03799 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.345 | L2-Norm(final)=8.700 | 4806.5 samples/s | 75.1 steps/s
[Step=12000 Epoch=23.4] | Loss=0.03768 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.367 | L2-Norm(final)=8.695 | 4761.9 samples/s | 74.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step12000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=19.6] | Loss=0.09916 | Reg=0.00190 | acc=0.9531 | L2-Norm=13.773 | L2-Norm(final)=7.068 | 4201.1 samples/s | 65.6 steps/s
[Step=10050 Epoch=19.6] | Loss=0.10353 | Reg=0.00190 | acc=0.9375 | L2-Norm=13.779 | L2-Norm(final)=7.151 | 5493.1 samples/s | 85.8 steps/s
[Step=10100 Epoch=19.7] | Loss=0.10101 | Reg=0.00190 | acc=0.9219 | L2-Norm=13.781 | L2-Norm(final)=7.228 | 5410.9 samples/s | 84.5 steps/s
[Step=10150 Epoch=19.8] | Loss=0.09774 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.781 | L2-Norm(final)=7.302 | 5494.3 samples/s | 85.8 steps/s
[Step=10200 Epoch=19.9] | Loss=0.09710 | Reg=0.00190 | acc=0.9219 | L2-Norm=13.781 | L2-Norm(final)=7.375 | 5466.9 samples/s | 85.4 steps/s
[Step=10250 Epoch=20.0] | Loss=0.09628 | Reg=0.00190 | acc=0.9219 | L2-Norm=13.781 | L2-Norm(final)=7.446 | 5598.6 samples/s | 87.5 steps/s
[Step=10300 Epoch=20.1] | Loss=0.09659 | Reg=0.00190 | acc=0.8750 | L2-Norm=13.782 | L2-Norm(final)=7.510 | 5334.7 samples/s | 83.4 steps/s
[Step=10350 Epoch=20.2] | Loss=0.09741 | Reg=0.00190 | acc=0.9062 | L2-Norm=13.782 | L2-Norm(final)=7.568 | 5452.9 samples/s | 85.2 steps/s
[Step=10400 Epoch=20.3] | Loss=0.09764 | Reg=0.00190 | acc=0.9062 | L2-Norm=13.782 | L2-Norm(final)=7.621 | 5526.2 samples/s | 86.3 steps/s
[Step=10450 Epoch=20.4] | Loss=0.09682 | Reg=0.00190 | acc=0.9062 | L2-Norm=13.782 | L2-Norm(final)=7.673 | 5443.8 samples/s | 85.1 steps/s
[Step=10500 Epoch=20.5] | Loss=0.09722 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.782 | L2-Norm(final)=7.721 | 7039.9 samples/s | 110.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=20.5] | Loss=0.09305 | Reg=0.00190 | acc=0.9375 | L2-Norm=13.782 | L2-Norm(final)=8.193 | 4179.8 samples/s | 65.3 steps/s
[Step=10550 Epoch=20.6] | Loss=0.05883 | Reg=0.00196 | acc=0.9062 | L2-Norm=13.992 | L2-Norm(final)=8.206 | 4868.3 samples/s | 76.1 steps/s
[Step=10600 Epoch=20.7] | Loss=0.05835 | Reg=0.00201 | acc=0.9531 | L2-Norm=14.179 | L2-Norm(final)=8.191 | 4885.9 samples/s | 76.3 steps/s
[Step=10650 Epoch=20.8] | Loss=0.05876 | Reg=0.00205 | acc=0.9375 | L2-Norm=14.306 | L2-Norm(final)=8.181 | 4958.2 samples/s | 77.5 steps/s
[Step=10700 Epoch=20.9] | Loss=0.05603 | Reg=0.00208 | acc=0.9219 | L2-Norm=14.403 | L2-Norm(final)=8.174 | 4877.5 samples/s | 76.2 steps/s
[Step=10750 Epoch=21.0] | Loss=0.05787 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.490 | L2-Norm(final)=8.166 | 4921.8 samples/s | 76.9 steps/s
[Step=10800 Epoch=21.1] | Loss=0.05592 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.572 | L2-Norm(final)=8.159 | 4915.9 samples/s | 76.8 steps/s
[Step=10850 Epoch=21.2] | Loss=0.05477 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.642 | L2-Norm(final)=8.151 | 4916.7 samples/s | 76.8 steps/s
[Step=10900 Epoch=21.3] | Loss=0.05291 | Reg=0.00216 | acc=0.9531 | L2-Norm=14.704 | L2-Norm(final)=8.146 | 4902.9 samples/s | 76.6 steps/s
[Step=10950 Epoch=21.4] | Loss=0.05162 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.759 | L2-Norm(final)=8.140 | 4792.5 samples/s | 74.9 steps/s
[Step=11000 Epoch=21.5] | Loss=0.05114 | Reg=0.00219 | acc=0.9531 | L2-Norm=14.810 | L2-Norm(final)=8.135 | 5872.5 samples/s | 91.8 steps/s
[Step=11050 Epoch=21.6] | Loss=0.04910 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.857 | L2-Norm(final)=8.130 | 2029.5 samples/s | 31.7 steps/s
[Step=11100 Epoch=21.7] | Loss=0.04752 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.901 | L2-Norm(final)=8.127 | 4774.4 samples/s | 74.6 steps/s
[Step=11150 Epoch=21.8] | Loss=0.04563 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.942 | L2-Norm(final)=8.124 | 4759.7 samples/s | 74.4 steps/s
[Step=11200 Epoch=21.9] | Loss=0.04457 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.981 | L2-Norm(final)=8.121 | 4741.5 samples/s | 74.1 steps/s
[Step=11250 Epoch=22.0] | Loss=0.04376 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.019 | L2-Norm(final)=8.117 | 4769.7 samples/s | 74.5 steps/s
[Step=11300 Epoch=22.1] | Loss=0.04318 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.056 | L2-Norm(final)=8.114 | 4767.3 samples/s | 74.5 steps/s
[Step=11350 Epoch=22.2] | Loss=0.04221 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.090 | L2-Norm(final)=8.110 | 4794.2 samples/s | 74.9 steps/s
[Step=11400 Epoch=22.3] | Loss=0.04195 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.123 | L2-Norm(final)=8.106 | 4754.5 samples/s | 74.3 steps/s
[Step=11450 Epoch=22.4] | Loss=0.04171 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.156 | L2-Norm(final)=8.102 | 4772.6 samples/s | 74.6 steps/s
[Step=11500 Epoch=22.5] | Loss=0.04132 | Reg=0.00231 | acc=0.9688 | L2-Norm=15.187 | L2-Norm(final)=8.098 | 5146.6 samples/s | 80.4 steps/s
[Step=11550 Epoch=22.6] | Loss=0.04088 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.218 | L2-Norm(final)=8.094 | 2140.2 samples/s | 33.4 steps/s
[Step=11600 Epoch=22.7] | Loss=0.04010 | Reg=0.00233 | acc=0.9531 | L2-Norm=15.249 | L2-Norm(final)=8.090 | 4948.6 samples/s | 77.3 steps/s
[Step=11650 Epoch=22.8] | Loss=0.03939 | Reg=0.00234 | acc=0.9688 | L2-Norm=15.278 | L2-Norm(final)=8.087 | 4787.9 samples/s | 74.8 steps/s
[Step=11700 Epoch=22.9] | Loss=0.03865 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.306 | L2-Norm(final)=8.083 | 4789.5 samples/s | 74.8 steps/s
[Step=11750 Epoch=23.0] | Loss=0.03830 | Reg=0.00235 | acc=0.9531 | L2-Norm=15.334 | L2-Norm(final)=8.081 | 4724.1 samples/s | 73.8 steps/s
[Step=11800 Epoch=23.1] | Loss=0.03815 | Reg=0.00236 | acc=0.9375 | L2-Norm=15.361 | L2-Norm(final)=8.077 | 4802.4 samples/s | 75.0 steps/s
[Step=11850 Epoch=23.2] | Loss=0.03764 | Reg=0.00237 | acc=0.9688 | L2-Norm=15.387 | L2-Norm(final)=8.074 | 4804.4 samples/s | 75.1 steps/s
[Step=11900 Epoch=23.3] | Loss=0.03706 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.413 | L2-Norm(final)=8.071 | 4818.8 samples/s | 75.3 steps/s
[Step=11950 Epoch=23.4] | Loss=0.03648 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.438 | L2-Norm(final)=8.069 | 4754.6 samples/s | 74.3 steps/s
[Step=12000 Epoch=23.5] | Loss=0.03626 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.462 | L2-Norm(final)=8.067 | 4817.9 samples/s | 75.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step12000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=38.3] | Loss=0.01109 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.773 | L2-Norm(final)=9.993 | 4173.3 samples/s | 65.2 steps/s
[Step=10050 Epoch=38.5] | Loss=0.01167 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.764 | L2-Norm(final)=10.065 | 4926.2 samples/s | 77.0 steps/s
[Step=10100 Epoch=38.7] | Loss=0.01071 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=10.172 | 5172.1 samples/s | 80.8 steps/s
[Step=10150 Epoch=38.9] | Loss=0.01032 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=10.278 | 5296.0 samples/s | 82.7 steps/s
[Step=10200 Epoch=39.1] | Loss=0.00985 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=10.383 | 5076.5 samples/s | 79.3 steps/s
[Step=10250 Epoch=39.3] | Loss=0.00939 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=10.481 | 6742.7 samples/s | 105.4 steps/s
[Step=10300 Epoch=39.5] | Loss=0.00898 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.762 | L2-Norm(final)=10.575 | 2005.4 samples/s | 31.3 steps/s
[Step=10350 Epoch=39.7] | Loss=0.00872 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=10.665 | 5137.1 samples/s | 80.3 steps/s
[Step=10400 Epoch=39.8] | Loss=0.00848 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=10.755 | 5134.8 samples/s | 80.2 steps/s
[Step=10450 Epoch=40.0] | Loss=0.00822 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=10.840 | 5209.6 samples/s | 81.4 steps/s
[Step=10500 Epoch=40.2] | Loss=0.00815 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=10.923 | 5827.3 samples/s | 91.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=40.2] | Loss=0.00681 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.761 | L2-Norm(final)=11.739 | 4380.1 samples/s | 68.4 steps/s
[Step=10550 Epoch=40.4] | Loss=0.02190 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.145 | L2-Norm(final)=11.723 | 4088.9 samples/s | 63.9 steps/s
[Step=10600 Epoch=40.6] | Loss=0.02032 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.557 | L2-Norm(final)=11.673 | 4526.2 samples/s | 70.7 steps/s
[Step=10650 Epoch=40.8] | Loss=0.01503 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.765 | L2-Norm(final)=11.642 | 4567.0 samples/s | 71.4 steps/s
[Step=10700 Epoch=41.0] | Loss=0.01232 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.861 | L2-Norm(final)=11.624 | 4499.6 samples/s | 70.3 steps/s
[Step=10750 Epoch=41.2] | Loss=0.01019 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.915 | L2-Norm(final)=11.615 | 5665.6 samples/s | 88.5 steps/s
[Step=10800 Epoch=41.4] | Loss=0.00866 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.945 | L2-Norm(final)=11.611 | 1929.9 samples/s | 30.2 steps/s
[Step=10850 Epoch=41.6] | Loss=0.00749 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.957 | L2-Norm(final)=11.609 | 4517.0 samples/s | 70.6 steps/s
[Step=10900 Epoch=41.8] | Loss=0.00701 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.960 | L2-Norm(final)=11.607 | 4595.9 samples/s | 71.8 steps/s
[Step=10950 Epoch=42.0] | Loss=0.00632 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.959 | L2-Norm(final)=11.605 | 4459.3 samples/s | 69.7 steps/s
[Step=11000 Epoch=42.1] | Loss=0.00590 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.953 | L2-Norm(final)=11.603 | 4951.1 samples/s | 77.4 steps/s
[Step=11050 Epoch=42.3] | Loss=0.00546 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.948 | L2-Norm(final)=11.599 | 2016.8 samples/s | 31.5 steps/s
[Step=11100 Epoch=42.5] | Loss=0.00504 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.942 | L2-Norm(final)=11.597 | 4513.6 samples/s | 70.5 steps/s
[Step=11150 Epoch=42.7] | Loss=0.00482 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.933 | L2-Norm(final)=11.595 | 4518.6 samples/s | 70.6 steps/s
[Step=11200 Epoch=42.9] | Loss=0.00450 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.925 | L2-Norm(final)=11.593 | 4496.6 samples/s | 70.3 steps/s
[Step=11250 Epoch=43.1] | Loss=0.00420 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.915 | L2-Norm(final)=11.591 | 4521.1 samples/s | 70.6 steps/s
[Step=11300 Epoch=43.3] | Loss=0.00394 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.902 | L2-Norm(final)=11.589 | 2147.0 samples/s | 33.5 steps/s
[Step=11350 Epoch=43.5] | Loss=0.00371 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.887 | L2-Norm(final)=11.588 | 4559.7 samples/s | 71.2 steps/s
[Step=11400 Epoch=43.7] | Loss=0.00351 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.871 | L2-Norm(final)=11.587 | 4555.8 samples/s | 71.2 steps/s
[Step=11450 Epoch=43.9] | Loss=0.00332 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.853 | L2-Norm(final)=11.586 | 4481.5 samples/s | 70.0 steps/s
[Step=11500 Epoch=44.1] | Loss=0.00316 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.835 | L2-Norm(final)=11.585 | 4585.2 samples/s | 71.6 steps/s
[Step=11550 Epoch=44.3] | Loss=0.00301 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.816 | L2-Norm(final)=11.585 | 2170.2 samples/s | 33.9 steps/s
[Step=11600 Epoch=44.4] | Loss=0.00288 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.796 | L2-Norm(final)=11.585 | 4564.4 samples/s | 71.3 steps/s
[Step=11650 Epoch=44.6] | Loss=0.00275 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.775 | L2-Norm(final)=11.584 | 4439.3 samples/s | 69.4 steps/s
[Step=11700 Epoch=44.8] | Loss=0.00264 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.753 | L2-Norm(final)=11.584 | 4512.1 samples/s | 70.5 steps/s
[Step=11750 Epoch=45.0] | Loss=0.00253 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.732 | L2-Norm(final)=11.584 | 4533.3 samples/s | 70.8 steps/s
[Step=11800 Epoch=45.2] | Loss=0.00243 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.709 | L2-Norm(final)=11.583 | 6177.5 samples/s | 96.5 steps/s
[Step=11850 Epoch=45.4] | Loss=0.00234 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.687 | L2-Norm(final)=11.583 | 1932.6 samples/s | 30.2 steps/s
[Step=11900 Epoch=45.6] | Loss=0.00226 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.664 | L2-Norm(final)=11.583 | 4591.3 samples/s | 71.7 steps/s
[Step=11950 Epoch=45.8] | Loss=0.00218 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.641 | L2-Norm(final)=11.583 | 4522.6 samples/s | 70.7 steps/s
[Step=12000 Epoch=46.0] | Loss=0.00211 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.618 | L2-Norm(final)=11.583 | 4525.1 samples/s | 70.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step12000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=38.5] | Loss=0.01519 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.773 | L2-Norm(final)=9.592 | 4187.1 samples/s | 65.4 steps/s
[Step=10050 Epoch=38.7] | Loss=0.01489 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.764 | L2-Norm(final)=9.659 | 4825.8 samples/s | 75.4 steps/s
[Step=10100 Epoch=38.9] | Loss=0.01367 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.763 | L2-Norm(final)=9.747 | 5320.3 samples/s | 83.1 steps/s
[Step=10150 Epoch=39.1] | Loss=0.01290 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.763 | L2-Norm(final)=9.848 | 4982.4 samples/s | 77.9 steps/s
[Step=10200 Epoch=39.3] | Loss=0.01270 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.762 | L2-Norm(final)=9.946 | 5275.7 samples/s | 82.4 steps/s
[Step=10250 Epoch=39.5] | Loss=0.01217 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.762 | L2-Norm(final)=10.044 | 6776.9 samples/s | 105.9 steps/s
[Step=10300 Epoch=39.6] | Loss=0.01150 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=10.142 | 2024.9 samples/s | 31.6 steps/s
[Step=10350 Epoch=39.8] | Loss=0.01142 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=10.238 | 5393.3 samples/s | 84.3 steps/s
[Step=10400 Epoch=40.0] | Loss=0.01122 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=10.328 | 5019.0 samples/s | 78.4 steps/s
[Step=10450 Epoch=40.2] | Loss=0.01089 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=10.412 | 5161.8 samples/s | 80.7 steps/s
[Step=10500 Epoch=40.4] | Loss=0.01076 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=10.493 | 5874.7 samples/s | 91.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=40.4] | Loss=0.00395 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=11.281 | 4210.0 samples/s | 65.8 steps/s
[Step=10550 Epoch=40.6] | Loss=0.02039 | Reg=0.00194 | acc=0.9531 | L2-Norm=13.928 | L2-Norm(final)=11.292 | 4210.2 samples/s | 65.8 steps/s
[Step=10600 Epoch=40.8] | Loss=0.02151 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.289 | L2-Norm(final)=11.224 | 4515.0 samples/s | 70.5 steps/s
[Step=10650 Epoch=41.0] | Loss=0.01732 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.487 | L2-Norm(final)=11.185 | 4500.0 samples/s | 70.3 steps/s
[Step=10700 Epoch=41.2] | Loss=0.01343 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.590 | L2-Norm(final)=11.165 | 4526.3 samples/s | 70.7 steps/s
[Step=10750 Epoch=41.4] | Loss=0.01122 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.650 | L2-Norm(final)=11.154 | 5754.0 samples/s | 89.9 steps/s
[Step=10800 Epoch=41.6] | Loss=0.00993 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.687 | L2-Norm(final)=11.147 | 1924.7 samples/s | 30.1 steps/s
[Step=10850 Epoch=41.8] | Loss=0.00876 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.711 | L2-Norm(final)=11.140 | 4532.3 samples/s | 70.8 steps/s
[Step=10900 Epoch=42.0] | Loss=0.00774 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.724 | L2-Norm(final)=11.135 | 4452.1 samples/s | 69.6 steps/s
[Step=10950 Epoch=42.2] | Loss=0.00691 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.728 | L2-Norm(final)=11.132 | 4601.6 samples/s | 71.9 steps/s
[Step=11000 Epoch=42.3] | Loss=0.00624 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.726 | L2-Norm(final)=11.130 | 5261.8 samples/s | 82.2 steps/s
[Step=11050 Epoch=42.5] | Loss=0.00590 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.722 | L2-Norm(final)=11.128 | 2050.5 samples/s | 32.0 steps/s
[Step=11100 Epoch=42.7] | Loss=0.00601 | Reg=0.00217 | acc=0.9688 | L2-Norm=14.719 | L2-Norm(final)=11.125 | 4563.4 samples/s | 71.3 steps/s
[Step=11150 Epoch=42.9] | Loss=0.00648 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.727 | L2-Norm(final)=11.119 | 4536.8 samples/s | 70.9 steps/s
[Step=11200 Epoch=43.1] | Loss=0.00631 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.746 | L2-Norm(final)=11.110 | 4535.2 samples/s | 70.9 steps/s
[Step=11250 Epoch=43.3] | Loss=0.00593 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.762 | L2-Norm(final)=11.102 | 4599.4 samples/s | 71.9 steps/s
[Step=11300 Epoch=43.5] | Loss=0.00560 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.774 | L2-Norm(final)=11.096 | 2123.4 samples/s | 33.2 steps/s
[Step=11350 Epoch=43.7] | Loss=0.00533 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.783 | L2-Norm(final)=11.090 | 4554.3 samples/s | 71.2 steps/s
[Step=11400 Epoch=43.9] | Loss=0.00506 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.789 | L2-Norm(final)=11.085 | 4545.4 samples/s | 71.0 steps/s
[Step=11450 Epoch=44.1] | Loss=0.00481 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.792 | L2-Norm(final)=11.081 | 4554.9 samples/s | 71.2 steps/s
[Step=11500 Epoch=44.3] | Loss=0.00457 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.792 | L2-Norm(final)=11.078 | 4478.3 samples/s | 70.0 steps/s
[Step=11550 Epoch=44.5] | Loss=0.00435 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.790 | L2-Norm(final)=11.074 | 2168.5 samples/s | 33.9 steps/s
[Step=11600 Epoch=44.7] | Loss=0.00416 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.785 | L2-Norm(final)=11.072 | 4542.8 samples/s | 71.0 steps/s
[Step=11650 Epoch=44.8] | Loss=0.00398 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.779 | L2-Norm(final)=11.069 | 4652.8 samples/s | 72.7 steps/s
[Step=11700 Epoch=45.0] | Loss=0.00381 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.771 | L2-Norm(final)=11.067 | 4541.3 samples/s | 71.0 steps/s
[Step=11750 Epoch=45.2] | Loss=0.00366 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.762 | L2-Norm(final)=11.065 | 4568.0 samples/s | 71.4 steps/s
[Step=11800 Epoch=45.4] | Loss=0.00352 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.751 | L2-Norm(final)=11.063 | 6707.4 samples/s | 104.8 steps/s
[Step=11850 Epoch=45.6] | Loss=0.00339 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.740 | L2-Norm(final)=11.061 | 1867.4 samples/s | 29.2 steps/s
[Step=11900 Epoch=45.8] | Loss=0.00327 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.728 | L2-Norm(final)=11.060 | 4527.0 samples/s | 70.7 steps/s
[Step=11950 Epoch=46.0] | Loss=0.00316 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.715 | L2-Norm(final)=11.058 | 4487.9 samples/s | 70.1 steps/s
[Step=12000 Epoch=46.2] | Loss=0.00305 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.701 | L2-Norm(final)=11.057 | 4488.5 samples/s | 70.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07388 | acc=0.9529 | tpr=0.9474 | fpr=0.0352 | 4396.6 samples/s | 17.2 steps/s
Avg test loss: 0.07464, Avg test acc: 0.95140, Avg tpr: 0.94539, Avg fpr: 0.03538, total FA: 276

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07454 | acc=0.9566 | tpr=0.9743 | fpr=0.0820 | 4379.1 samples/s | 17.1 steps/s
Avg test loss: 0.07434, Avg test acc: 0.95721, Avg tpr: 0.97412, Avg fpr: 0.07999, total FA: 624

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=8.66027 | acc=0.3148 | tpr=0.0059 | fpr=0.0144 | 4435.7 samples/s | 17.3 steps/s
Avg test loss: 8.68514, Avg test acc: 0.31281, Avg tpr: 0.00618, Avg fpr: 0.01282, total FA: 100

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=9.09642 | acc=0.3152 | tpr=0.0043 | fpr=0.0099 | 4396.6 samples/s | 17.2 steps/s
Avg test loss: 9.11104, Avg test acc: 0.31297, Avg tpr: 0.00490, Avg fpr: 0.00949, total FA: 74

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.30519 | acc=0.1334 | tpr=0.6991 | fpr=0.8768 | 4462.8 samples/s | 17.4 steps/s
[Step= 100] | Loss=4.27435 | acc=0.1345 | tpr=0.6972 | fpr=0.8760 | 8690.1 samples/s | 33.9 steps/s
[Step= 150] | Loss=4.27258 | acc=0.1342 | tpr=0.6873 | fpr=0.8760 | 8211.1 samples/s | 32.1 steps/s
[Step= 200] | Loss=4.27171 | acc=0.1341 | tpr=0.6776 | fpr=0.8758 | 8391.3 samples/s | 32.8 steps/s
[Step= 250] | Loss=4.27912 | acc=0.1341 | tpr=0.6830 | fpr=0.8759 | 8640.9 samples/s | 33.8 steps/s
[Step= 300] | Loss=4.28128 | acc=0.1331 | tpr=0.6836 | fpr=0.8769 | 8216.9 samples/s | 32.1 steps/s
[Step= 350] | Loss=4.27940 | acc=0.1326 | tpr=0.6913 | fpr=0.8776 | 8321.0 samples/s | 32.5 steps/s
[Step= 400] | Loss=4.27823 | acc=0.1329 | tpr=0.6860 | fpr=0.8771 | 8370.6 samples/s | 32.7 steps/s
[Step= 450] | Loss=4.28275 | acc=0.1329 | tpr=0.6889 | fpr=0.8772 | 8311.0 samples/s | 32.5 steps/s
[Step= 500] | Loss=4.28360 | acc=0.1329 | tpr=0.6877 | fpr=0.8771 | 8373.9 samples/s | 32.7 steps/s
[Step= 550] | Loss=4.28917 | acc=0.1328 | tpr=0.6868 | fpr=0.8773 | 15398.1 samples/s | 60.1 steps/s
Avg test loss: 4.28969, Avg test acc: 0.13276, Avg tpr: 0.68740, Avg fpr: 0.87732, total FA: 121814

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.52045 | acc=0.0859 | tpr=0.8142 | fpr=0.9272 | 4398.8 samples/s | 17.2 steps/s
[Step= 100] | Loss=6.47209 | acc=0.0857 | tpr=0.8124 | fpr=0.9278 | 8213.6 samples/s | 32.1 steps/s
[Step= 150] | Loss=6.47770 | acc=0.0854 | tpr=0.8098 | fpr=0.9279 | 8515.5 samples/s | 33.3 steps/s
[Step= 200] | Loss=6.47114 | acc=0.0862 | tpr=0.8077 | fpr=0.9269 | 8395.5 samples/s | 32.8 steps/s
[Step= 250] | Loss=6.47463 | acc=0.0862 | tpr=0.8052 | fpr=0.9268 | 8776.9 samples/s | 34.3 steps/s
[Step= 300] | Loss=6.47267 | acc=0.0852 | tpr=0.7993 | fpr=0.9278 | 8080.3 samples/s | 31.6 steps/s
[Step= 350] | Loss=6.46693 | acc=0.0850 | tpr=0.8009 | fpr=0.9280 | 8532.3 samples/s | 33.3 steps/s
[Step= 400] | Loss=6.46798 | acc=0.0853 | tpr=0.7965 | fpr=0.9276 | 8271.6 samples/s | 32.3 steps/s
[Step= 450] | Loss=6.46931 | acc=0.0853 | tpr=0.8019 | fpr=0.9278 | 8754.1 samples/s | 34.2 steps/s
[Step= 500] | Loss=6.46877 | acc=0.0850 | tpr=0.8048 | fpr=0.9280 | 7861.2 samples/s | 30.7 steps/s
[Step= 550] | Loss=6.47345 | acc=0.0848 | tpr=0.8030 | fpr=0.9282 | 15391.0 samples/s | 60.1 steps/s
Avg test loss: 6.47395, Avg test acc: 0.08481, Avg tpr: 0.80309, Avg fpr: 0.92825, total FA: 128885

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11725 | acc=0.9802 | tpr=0.9248 | fpr=0.0188 | 4452.3 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.12110 | acc=0.9802 | tpr=0.9446 | fpr=0.0191 | 8540.1 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.12401 | acc=0.9796 | tpr=0.9452 | fpr=0.0198 | 9030.1 samples/s | 35.3 steps/s
[Step= 200] | Loss=0.12611 | acc=0.9799 | tpr=0.9530 | fpr=0.0196 | 7895.0 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.12361 | acc=0.9803 | tpr=0.9546 | fpr=0.0192 | 8346.4 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.12539 | acc=0.9800 | tpr=0.9556 | fpr=0.0195 | 8299.7 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.12642 | acc=0.9796 | tpr=0.9549 | fpr=0.0199 | 8461.8 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.12764 | acc=0.9795 | tpr=0.9524 | fpr=0.0200 | 8372.3 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.12999 | acc=0.9792 | tpr=0.9508 | fpr=0.0203 | 8468.3 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.12949 | acc=0.9792 | tpr=0.9515 | fpr=0.0203 | 8335.0 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.12867 | acc=0.9794 | tpr=0.9495 | fpr=0.0201 | 16291.2 samples/s | 63.6 steps/s
Avg test loss: 0.12839, Avg test acc: 0.97940, Avg tpr: 0.94929, Avg fpr: 0.02005, total FA: 2784

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12377 | acc=0.9836 | tpr=0.9292 | fpr=0.0154 | 4576.4 samples/s | 17.9 steps/s
[Step= 100] | Loss=0.13151 | acc=0.9828 | tpr=0.9403 | fpr=0.0164 | 8260.8 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.13627 | acc=0.9821 | tpr=0.9409 | fpr=0.0172 | 7983.2 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.13795 | acc=0.9820 | tpr=0.9475 | fpr=0.0174 | 8658.2 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.13627 | acc=0.9821 | tpr=0.9441 | fpr=0.0172 | 8216.6 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.13812 | acc=0.9821 | tpr=0.9455 | fpr=0.0172 | 8866.8 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.13878 | acc=0.9820 | tpr=0.9461 | fpr=0.0174 | 8350.3 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.14030 | acc=0.9818 | tpr=0.9426 | fpr=0.0175 | 8272.1 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.14257 | acc=0.9816 | tpr=0.9421 | fpr=0.0176 | 8824.9 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.14233 | acc=0.9818 | tpr=0.9436 | fpr=0.0176 | 8285.8 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.14119 | acc=0.9819 | tpr=0.9423 | fpr=0.0174 | 14212.8 samples/s | 55.5 steps/s
Avg test loss: 0.14089, Avg test acc: 0.98191, Avg tpr: 0.94136, Avg fpr: 0.01735, total FA: 2409

server round 6/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=12001 Epoch=23.4] | Loss=0.12325 | Reg=0.00190 | acc=0.8750 | L2-Norm=13.790 | L2-Norm(final)=8.563 | 3993.2 samples/s | 62.4 steps/s
[Step=12050 Epoch=23.5] | Loss=0.10357 | Reg=0.00191 | acc=0.8906 | L2-Norm=13.804 | L2-Norm(final)=8.558 | 5217.9 samples/s | 81.5 steps/s
[Step=12100 Epoch=23.6] | Loss=0.10056 | Reg=0.00191 | acc=0.9062 | L2-Norm=13.806 | L2-Norm(final)=8.623 | 5513.5 samples/s | 86.1 steps/s
[Step=12150 Epoch=23.7] | Loss=0.09780 | Reg=0.00191 | acc=0.9531 | L2-Norm=13.807 | L2-Norm(final)=8.707 | 5448.4 samples/s | 85.1 steps/s
[Step=12200 Epoch=23.8] | Loss=0.09710 | Reg=0.00191 | acc=0.9531 | L2-Norm=13.808 | L2-Norm(final)=8.791 | 5621.0 samples/s | 87.8 steps/s
[Step=12250 Epoch=23.9] | Loss=0.09557 | Reg=0.00191 | acc=0.9062 | L2-Norm=13.808 | L2-Norm(final)=8.872 | 5341.8 samples/s | 83.5 steps/s
[Step=12300 Epoch=24.0] | Loss=0.09341 | Reg=0.00191 | acc=0.9219 | L2-Norm=13.808 | L2-Norm(final)=8.952 | 5600.1 samples/s | 87.5 steps/s
[Step=12350 Epoch=24.1] | Loss=0.09230 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.808 | L2-Norm(final)=9.030 | 5481.2 samples/s | 85.6 steps/s
[Step=12400 Epoch=24.2] | Loss=0.09182 | Reg=0.00191 | acc=0.8750 | L2-Norm=13.808 | L2-Norm(final)=9.105 | 5621.6 samples/s | 87.8 steps/s
[Step=12450 Epoch=24.3] | Loss=0.09233 | Reg=0.00191 | acc=0.9375 | L2-Norm=13.808 | L2-Norm(final)=9.175 | 5403.0 samples/s | 84.4 steps/s
[Step=12500 Epoch=24.4] | Loss=0.09122 | Reg=0.00191 | acc=0.9062 | L2-Norm=13.808 | L2-Norm(final)=9.241 | 6901.2 samples/s | 107.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=24.4] | Loss=0.07851 | Reg=0.00191 | acc=0.9531 | L2-Norm=13.809 | L2-Norm(final)=9.908 | 4137.5 samples/s | 64.6 steps/s
[Step=12550 Epoch=24.5] | Loss=0.06639 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.066 | L2-Norm(final)=9.923 | 4715.2 samples/s | 73.7 steps/s
[Step=12600 Epoch=24.6] | Loss=0.06398 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.260 | L2-Norm(final)=9.904 | 4754.9 samples/s | 74.3 steps/s
[Step=12650 Epoch=24.7] | Loss=0.05877 | Reg=0.00207 | acc=0.9531 | L2-Norm=14.396 | L2-Norm(final)=9.889 | 4744.4 samples/s | 74.1 steps/s
[Step=12700 Epoch=24.8] | Loss=0.05676 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.492 | L2-Norm(final)=9.878 | 4837.5 samples/s | 75.6 steps/s
[Step=12750 Epoch=24.9] | Loss=0.05498 | Reg=0.00212 | acc=0.9375 | L2-Norm=14.571 | L2-Norm(final)=9.869 | 4740.2 samples/s | 74.1 steps/s
[Step=12800 Epoch=25.0] | Loss=0.05333 | Reg=0.00214 | acc=0.9062 | L2-Norm=14.640 | L2-Norm(final)=9.859 | 4761.7 samples/s | 74.4 steps/s
[Step=12850 Epoch=25.1] | Loss=0.05219 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.702 | L2-Norm(final)=9.851 | 4775.4 samples/s | 74.6 steps/s
[Step=12900 Epoch=25.2] | Loss=0.05168 | Reg=0.00218 | acc=0.9531 | L2-Norm=14.760 | L2-Norm(final)=9.844 | 4841.8 samples/s | 75.7 steps/s
[Step=12950 Epoch=25.3] | Loss=0.05093 | Reg=0.00220 | acc=0.9375 | L2-Norm=14.812 | L2-Norm(final)=9.836 | 4785.8 samples/s | 74.8 steps/s
[Step=13000 Epoch=25.4] | Loss=0.05012 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.861 | L2-Norm(final)=9.830 | 5804.3 samples/s | 90.7 steps/s
[Step=13050 Epoch=25.5] | Loss=0.04862 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.906 | L2-Norm(final)=9.824 | 1950.0 samples/s | 30.5 steps/s
[Step=13100 Epoch=25.6] | Loss=0.04716 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.948 | L2-Norm(final)=9.819 | 4859.1 samples/s | 75.9 steps/s
[Step=13150 Epoch=25.6] | Loss=0.04578 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.987 | L2-Norm(final)=9.815 | 4892.8 samples/s | 76.4 steps/s
[Step=13200 Epoch=25.7] | Loss=0.04463 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.025 | L2-Norm(final)=9.812 | 4942.5 samples/s | 77.2 steps/s
[Step=13250 Epoch=25.8] | Loss=0.04366 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.062 | L2-Norm(final)=9.808 | 4851.9 samples/s | 75.8 steps/s
[Step=13300 Epoch=25.9] | Loss=0.04333 | Reg=0.00228 | acc=0.9688 | L2-Norm=15.098 | L2-Norm(final)=9.804 | 4925.8 samples/s | 77.0 steps/s
[Step=13350 Epoch=26.0] | Loss=0.04259 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.132 | L2-Norm(final)=9.799 | 4922.8 samples/s | 76.9 steps/s
[Step=13400 Epoch=26.1] | Loss=0.04204 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.165 | L2-Norm(final)=9.795 | 4848.6 samples/s | 75.8 steps/s
[Step=13450 Epoch=26.2] | Loss=0.04155 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.196 | L2-Norm(final)=9.791 | 4823.2 samples/s | 75.4 steps/s
[Step=13500 Epoch=26.3] | Loss=0.04143 | Reg=0.00232 | acc=0.9688 | L2-Norm=15.226 | L2-Norm(final)=9.787 | 5076.2 samples/s | 79.3 steps/s
[Step=13550 Epoch=26.4] | Loss=0.04077 | Reg=0.00233 | acc=0.9219 | L2-Norm=15.256 | L2-Norm(final)=9.783 | 2103.2 samples/s | 32.9 steps/s
[Step=13600 Epoch=26.5] | Loss=0.04013 | Reg=0.00234 | acc=0.9531 | L2-Norm=15.285 | L2-Norm(final)=9.779 | 4779.5 samples/s | 74.7 steps/s
[Step=13650 Epoch=26.6] | Loss=0.03943 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.312 | L2-Norm(final)=9.774 | 4727.7 samples/s | 73.9 steps/s
[Step=13700 Epoch=26.7] | Loss=0.03888 | Reg=0.00236 | acc=0.9531 | L2-Norm=15.339 | L2-Norm(final)=9.770 | 4807.4 samples/s | 75.1 steps/s
[Step=13750 Epoch=26.8] | Loss=0.03828 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.366 | L2-Norm(final)=9.766 | 4684.6 samples/s | 73.2 steps/s
[Step=13800 Epoch=26.9] | Loss=0.03783 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.392 | L2-Norm(final)=9.762 | 4837.8 samples/s | 75.6 steps/s
[Step=13850 Epoch=27.0] | Loss=0.03733 | Reg=0.00238 | acc=0.9688 | L2-Norm=15.417 | L2-Norm(final)=9.759 | 4797.0 samples/s | 75.0 steps/s
[Step=13900 Epoch=27.1] | Loss=0.03689 | Reg=0.00239 | acc=0.9531 | L2-Norm=15.441 | L2-Norm(final)=9.755 | 4788.0 samples/s | 74.8 steps/s
[Step=13950 Epoch=27.2] | Loss=0.03654 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.464 | L2-Norm(final)=9.752 | 4760.6 samples/s | 74.4 steps/s
[Step=14000 Epoch=27.3] | Loss=0.03612 | Reg=0.00240 | acc=0.9531 | L2-Norm=15.488 | L2-Norm(final)=9.749 | 4807.0 samples/s | 75.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step14000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=12001 Epoch=23.5] | Loss=0.09203 | Reg=0.00190 | acc=0.9219 | L2-Norm=13.790 | L2-Norm(final)=7.998 | 4521.9 samples/s | 70.7 steps/s
[Step=12050 Epoch=23.6] | Loss=0.14049 | Reg=0.00191 | acc=0.8750 | L2-Norm=13.804 | L2-Norm(final)=7.994 | 5112.8 samples/s | 79.9 steps/s
[Step=12100 Epoch=23.7] | Loss=0.12273 | Reg=0.00191 | acc=0.9531 | L2-Norm=13.806 | L2-Norm(final)=8.077 | 5667.3 samples/s | 88.6 steps/s
[Step=12150 Epoch=23.8] | Loss=0.11720 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.807 | L2-Norm(final)=8.177 | 5604.0 samples/s | 87.6 steps/s
[Step=12200 Epoch=23.9] | Loss=0.11246 | Reg=0.00191 | acc=0.9219 | L2-Norm=13.807 | L2-Norm(final)=8.278 | 5631.7 samples/s | 88.0 steps/s
[Step=12250 Epoch=23.9] | Loss=0.10989 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.807 | L2-Norm(final)=8.375 | 5554.9 samples/s | 86.8 steps/s
[Step=12300 Epoch=24.0] | Loss=0.10739 | Reg=0.00191 | acc=0.9531 | L2-Norm=13.807 | L2-Norm(final)=8.470 | 5626.6 samples/s | 87.9 steps/s
[Step=12350 Epoch=24.1] | Loss=0.10592 | Reg=0.00191 | acc=0.9219 | L2-Norm=13.807 | L2-Norm(final)=8.562 | 5385.1 samples/s | 84.1 steps/s
[Step=12400 Epoch=24.2] | Loss=0.10506 | Reg=0.00191 | acc=0.8750 | L2-Norm=13.808 | L2-Norm(final)=8.648 | 5570.4 samples/s | 87.0 steps/s
[Step=12450 Epoch=24.3] | Loss=0.10341 | Reg=0.00191 | acc=0.9219 | L2-Norm=13.808 | L2-Norm(final)=8.733 | 5499.8 samples/s | 85.9 steps/s
[Step=12500 Epoch=24.4] | Loss=0.10206 | Reg=0.00191 | acc=0.8750 | L2-Norm=13.808 | L2-Norm(final)=8.815 | 6959.3 samples/s | 108.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=24.4] | Loss=0.06208 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.808 | L2-Norm(final)=9.632 | 4465.8 samples/s | 69.8 steps/s
[Step=12550 Epoch=24.5] | Loss=0.06544 | Reg=0.00197 | acc=0.9531 | L2-Norm=14.052 | L2-Norm(final)=9.641 | 4476.4 samples/s | 69.9 steps/s
[Step=12600 Epoch=24.6] | Loss=0.06102 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.232 | L2-Norm(final)=9.626 | 4784.9 samples/s | 74.8 steps/s
[Step=12650 Epoch=24.7] | Loss=0.05888 | Reg=0.00206 | acc=0.9375 | L2-Norm=14.364 | L2-Norm(final)=9.613 | 4817.1 samples/s | 75.3 steps/s
[Step=12700 Epoch=24.8] | Loss=0.05752 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.482 | L2-Norm(final)=9.597 | 4777.8 samples/s | 74.7 steps/s
[Step=12750 Epoch=24.9] | Loss=0.05603 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.585 | L2-Norm(final)=9.584 | 4774.1 samples/s | 74.6 steps/s
[Step=12800 Epoch=25.0] | Loss=0.05526 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.674 | L2-Norm(final)=9.570 | 4777.8 samples/s | 74.7 steps/s
[Step=12850 Epoch=25.1] | Loss=0.05411 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.751 | L2-Norm(final)=9.560 | 4767.6 samples/s | 74.5 steps/s
[Step=12900 Epoch=25.2] | Loss=0.05253 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.821 | L2-Norm(final)=9.551 | 4824.6 samples/s | 75.4 steps/s
[Step=12950 Epoch=25.3] | Loss=0.05055 | Reg=0.00222 | acc=0.9531 | L2-Norm=14.883 | L2-Norm(final)=9.544 | 4742.8 samples/s | 74.1 steps/s
[Step=13000 Epoch=25.4] | Loss=0.04964 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.939 | L2-Norm(final)=9.535 | 5871.0 samples/s | 91.7 steps/s
[Step=13050 Epoch=25.5] | Loss=0.04748 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.991 | L2-Norm(final)=9.528 | 2049.9 samples/s | 32.0 steps/s
[Step=13100 Epoch=25.6] | Loss=0.04579 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.037 | L2-Norm(final)=9.522 | 4793.8 samples/s | 74.9 steps/s
[Step=13150 Epoch=25.7] | Loss=0.04429 | Reg=0.00228 | acc=0.9688 | L2-Norm=15.080 | L2-Norm(final)=9.517 | 4759.8 samples/s | 74.4 steps/s
[Step=13200 Epoch=25.8] | Loss=0.04306 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.119 | L2-Norm(final)=9.511 | 4792.2 samples/s | 74.9 steps/s
[Step=13250 Epoch=25.9] | Loss=0.04235 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.157 | L2-Norm(final)=9.506 | 4765.2 samples/s | 74.5 steps/s
[Step=13300 Epoch=26.0] | Loss=0.04194 | Reg=0.00231 | acc=0.9531 | L2-Norm=15.194 | L2-Norm(final)=9.502 | 4836.2 samples/s | 75.6 steps/s
[Step=13350 Epoch=26.1] | Loss=0.04140 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.230 | L2-Norm(final)=9.496 | 4904.6 samples/s | 76.6 steps/s
[Step=13400 Epoch=26.2] | Loss=0.04057 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.264 | L2-Norm(final)=9.492 | 4926.5 samples/s | 77.0 steps/s
[Step=13450 Epoch=26.3] | Loss=0.04001 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.297 | L2-Norm(final)=9.487 | 4896.6 samples/s | 76.5 steps/s
[Step=13500 Epoch=26.4] | Loss=0.03965 | Reg=0.00235 | acc=0.9688 | L2-Norm=15.328 | L2-Norm(final)=9.482 | 5177.9 samples/s | 80.9 steps/s
[Step=13550 Epoch=26.5] | Loss=0.03885 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.359 | L2-Norm(final)=9.478 | 2130.3 samples/s | 33.3 steps/s
[Step=13600 Epoch=26.6] | Loss=0.03803 | Reg=0.00237 | acc=0.9688 | L2-Norm=15.387 | L2-Norm(final)=9.474 | 4748.8 samples/s | 74.2 steps/s
[Step=13650 Epoch=26.7] | Loss=0.03744 | Reg=0.00238 | acc=0.9688 | L2-Norm=15.415 | L2-Norm(final)=9.470 | 4712.3 samples/s | 73.6 steps/s
[Step=13700 Epoch=26.8] | Loss=0.03677 | Reg=0.00239 | acc=0.9688 | L2-Norm=15.442 | L2-Norm(final)=9.466 | 4801.1 samples/s | 75.0 steps/s
[Step=13750 Epoch=26.9] | Loss=0.03635 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.468 | L2-Norm(final)=9.463 | 4756.9 samples/s | 74.3 steps/s
[Step=13800 Epoch=27.0] | Loss=0.03622 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.494 | L2-Norm(final)=9.459 | 4798.7 samples/s | 75.0 steps/s
[Step=13850 Epoch=27.1] | Loss=0.03602 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.522 | L2-Norm(final)=9.454 | 4684.7 samples/s | 73.2 steps/s
[Step=13900 Epoch=27.2] | Loss=0.03572 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.549 | L2-Norm(final)=9.450 | 4772.4 samples/s | 74.6 steps/s
[Step=13950 Epoch=27.3] | Loss=0.03538 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.576 | L2-Norm(final)=9.446 | 4860.0 samples/s | 75.9 steps/s
[Step=14000 Epoch=27.4] | Loss=0.03515 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.603 | L2-Norm(final)=9.442 | 4743.4 samples/s | 74.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step14000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=12001 Epoch=46.0] | Loss=0.00186 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.790 | L2-Norm(final)=11.581 | 4734.2 samples/s | 74.0 steps/s
[Step=12050 Epoch=46.2] | Loss=0.00795 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.783 | L2-Norm(final)=11.613 | 4301.5 samples/s | 67.2 steps/s
[Step=12100 Epoch=46.4] | Loss=0.00808 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.782 | L2-Norm(final)=11.659 | 5164.0 samples/s | 80.7 steps/s
[Step=12150 Epoch=46.6] | Loss=0.00816 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.782 | L2-Norm(final)=11.709 | 5204.3 samples/s | 81.3 steps/s
[Step=12200 Epoch=46.7] | Loss=0.00785 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.782 | L2-Norm(final)=11.766 | 5172.6 samples/s | 80.8 steps/s
[Step=12250 Epoch=46.9] | Loss=0.00750 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.782 | L2-Norm(final)=11.828 | 6983.4 samples/s | 109.1 steps/s
[Step=12300 Epoch=47.1] | Loss=0.00733 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.781 | L2-Norm(final)=11.894 | 2013.0 samples/s | 31.5 steps/s
[Step=12350 Epoch=47.3] | Loss=0.00710 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.781 | L2-Norm(final)=11.957 | 5143.1 samples/s | 80.4 steps/s
[Step=12400 Epoch=47.5] | Loss=0.00710 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.781 | L2-Norm(final)=12.019 | 5175.4 samples/s | 80.9 steps/s
[Step=12450 Epoch=47.7] | Loss=0.00712 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.781 | L2-Norm(final)=12.081 | 5091.8 samples/s | 79.6 steps/s
[Step=12500 Epoch=47.9] | Loss=0.00695 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.781 | L2-Norm(final)=12.141 | 5784.7 samples/s | 90.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=47.9] | Loss=0.00472 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.781 | L2-Norm(final)=12.751 | 4253.7 samples/s | 66.5 steps/s
[Step=12550 Epoch=48.1] | Loss=0.01084 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.918 | L2-Norm(final)=12.773 | 4225.4 samples/s | 66.0 steps/s
[Step=12600 Epoch=48.3] | Loss=0.01337 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.215 | L2-Norm(final)=12.729 | 4510.9 samples/s | 70.5 steps/s
[Step=12650 Epoch=48.5] | Loss=0.01117 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.409 | L2-Norm(final)=12.695 | 4523.5 samples/s | 70.7 steps/s
[Step=12700 Epoch=48.7] | Loss=0.00942 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.532 | L2-Norm(final)=12.671 | 4472.0 samples/s | 69.9 steps/s
[Step=12750 Epoch=48.9] | Loss=0.00810 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.620 | L2-Norm(final)=12.655 | 5728.2 samples/s | 89.5 steps/s
[Step=12800 Epoch=49.0] | Loss=0.00703 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.687 | L2-Norm(final)=12.644 | 1964.2 samples/s | 30.7 steps/s
[Step=12850 Epoch=49.2] | Loss=0.00629 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.733 | L2-Norm(final)=12.635 | 4446.2 samples/s | 69.5 steps/s
[Step=12900 Epoch=49.4] | Loss=0.00794 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.777 | L2-Norm(final)=12.622 | 4604.6 samples/s | 71.9 steps/s
[Step=12950 Epoch=49.6] | Loss=0.00756 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.827 | L2-Norm(final)=12.605 | 4470.6 samples/s | 69.9 steps/s
[Step=13000 Epoch=49.8] | Loss=0.00702 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.868 | L2-Norm(final)=12.591 | 4958.0 samples/s | 77.5 steps/s
[Step=13050 Epoch=50.0] | Loss=0.00649 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.901 | L2-Norm(final)=12.579 | 2051.7 samples/s | 32.1 steps/s
[Step=13100 Epoch=50.2] | Loss=0.00596 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.925 | L2-Norm(final)=12.570 | 4633.4 samples/s | 72.4 steps/s
[Step=13150 Epoch=50.4] | Loss=0.00555 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.942 | L2-Norm(final)=12.563 | 4546.0 samples/s | 71.0 steps/s
[Step=13200 Epoch=50.6] | Loss=0.00517 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.952 | L2-Norm(final)=12.557 | 4656.9 samples/s | 72.8 steps/s
[Step=13250 Epoch=50.8] | Loss=0.00485 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.959 | L2-Norm(final)=12.552 | 4539.8 samples/s | 70.9 steps/s
[Step=13300 Epoch=51.0] | Loss=0.00455 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.962 | L2-Norm(final)=12.548 | 2172.0 samples/s | 33.9 steps/s
[Step=13350 Epoch=51.2] | Loss=0.00428 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.962 | L2-Norm(final)=12.544 | 4701.2 samples/s | 73.5 steps/s
[Step=13400 Epoch=51.3] | Loss=0.00405 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.959 | L2-Norm(final)=12.541 | 4712.2 samples/s | 73.6 steps/s
[Step=13450 Epoch=51.5] | Loss=0.00383 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.953 | L2-Norm(final)=12.538 | 4481.3 samples/s | 70.0 steps/s
[Step=13500 Epoch=51.7] | Loss=0.00364 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.945 | L2-Norm(final)=12.536 | 4493.4 samples/s | 70.2 steps/s
[Step=13550 Epoch=51.9] | Loss=0.00347 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.936 | L2-Norm(final)=12.533 | 2154.5 samples/s | 33.7 steps/s
[Step=13600 Epoch=52.1] | Loss=0.00331 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.925 | L2-Norm(final)=12.532 | 4474.2 samples/s | 69.9 steps/s
[Step=13650 Epoch=52.3] | Loss=0.00317 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.913 | L2-Norm(final)=12.530 | 4527.6 samples/s | 70.7 steps/s
[Step=13700 Epoch=52.5] | Loss=0.00304 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.899 | L2-Norm(final)=12.528 | 4517.8 samples/s | 70.6 steps/s
[Step=13750 Epoch=52.7] | Loss=0.00291 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.885 | L2-Norm(final)=12.527 | 4597.6 samples/s | 71.8 steps/s
[Step=13800 Epoch=52.9] | Loss=0.00280 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.870 | L2-Norm(final)=12.525 | 6003.1 samples/s | 93.8 steps/s
[Step=13850 Epoch=53.1] | Loss=0.00270 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.855 | L2-Norm(final)=12.524 | 1913.1 samples/s | 29.9 steps/s
[Step=13900 Epoch=53.3] | Loss=0.00260 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.838 | L2-Norm(final)=12.523 | 4568.1 samples/s | 71.4 steps/s
[Step=13950 Epoch=53.5] | Loss=0.00251 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.821 | L2-Norm(final)=12.522 | 4479.4 samples/s | 70.0 steps/s
[Step=14000 Epoch=53.6] | Loss=0.00243 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.804 | L2-Norm(final)=12.521 | 4479.3 samples/s | 70.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step14000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=12001 Epoch=46.2] | Loss=0.00591 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.790 | L2-Norm(final)=11.020 | 4385.9 samples/s | 68.5 steps/s
[Step=12050 Epoch=46.4] | Loss=0.00818 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.784 | L2-Norm(final)=11.041 | 4695.9 samples/s | 73.4 steps/s
[Step=12100 Epoch=46.6] | Loss=0.00731 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.783 | L2-Norm(final)=11.077 | 5137.9 samples/s | 80.3 steps/s
[Step=12150 Epoch=46.8] | Loss=0.00723 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.783 | L2-Norm(final)=11.118 | 5286.2 samples/s | 82.6 steps/s
[Step=12200 Epoch=47.0] | Loss=0.00713 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.783 | L2-Norm(final)=11.166 | 5124.2 samples/s | 80.1 steps/s
[Step=12250 Epoch=47.2] | Loss=0.00705 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.783 | L2-Norm(final)=11.214 | 6811.2 samples/s | 106.4 steps/s
[Step=12300 Epoch=47.3] | Loss=0.00711 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.783 | L2-Norm(final)=11.263 | 2042.5 samples/s | 31.9 steps/s
[Step=12350 Epoch=47.5] | Loss=0.00701 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.783 | L2-Norm(final)=11.312 | 5224.1 samples/s | 81.6 steps/s
[Step=12400 Epoch=47.7] | Loss=0.00691 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.782 | L2-Norm(final)=11.361 | 5070.5 samples/s | 79.2 steps/s
[Step=12450 Epoch=47.9] | Loss=0.00681 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.782 | L2-Norm(final)=11.409 | 5157.7 samples/s | 80.6 steps/s
[Step=12500 Epoch=48.1] | Loss=0.00681 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.782 | L2-Norm(final)=11.457 | 5919.4 samples/s | 92.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=48.1] | Loss=0.00341 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.782 | L2-Norm(final)=11.946 | 4330.3 samples/s | 67.7 steps/s
[Step=12550 Epoch=48.3] | Loss=0.00461 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.868 | L2-Norm(final)=11.969 | 4351.7 samples/s | 68.0 steps/s
[Step=12600 Epoch=48.5] | Loss=0.00968 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.020 | L2-Norm(final)=11.941 | 4486.8 samples/s | 70.1 steps/s
[Step=12650 Epoch=48.7] | Loss=0.01054 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.188 | L2-Norm(final)=11.900 | 4502.8 samples/s | 70.4 steps/s
[Step=12700 Epoch=48.9] | Loss=0.00941 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.307 | L2-Norm(final)=11.869 | 4556.1 samples/s | 71.2 steps/s
[Step=12750 Epoch=49.1] | Loss=0.00802 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.380 | L2-Norm(final)=11.849 | 5725.8 samples/s | 89.5 steps/s
[Step=12800 Epoch=49.3] | Loss=0.00691 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.424 | L2-Norm(final)=11.834 | 1931.8 samples/s | 30.2 steps/s
[Step=12850 Epoch=49.5] | Loss=0.00602 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.448 | L2-Norm(final)=11.823 | 4495.0 samples/s | 70.2 steps/s
[Step=12900 Epoch=49.7] | Loss=0.00528 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.459 | L2-Norm(final)=11.816 | 4542.7 samples/s | 71.0 steps/s
[Step=12950 Epoch=49.8] | Loss=0.00473 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.462 | L2-Norm(final)=11.811 | 4511.2 samples/s | 70.5 steps/s
[Step=13000 Epoch=50.0] | Loss=0.00463 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.463 | L2-Norm(final)=11.806 | 5078.5 samples/s | 79.4 steps/s
[Step=13050 Epoch=50.2] | Loss=0.00440 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.464 | L2-Norm(final)=11.800 | 2019.0 samples/s | 31.5 steps/s
[Step=13100 Epoch=50.4] | Loss=0.00439 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.462 | L2-Norm(final)=11.795 | 4567.0 samples/s | 71.4 steps/s
[Step=13150 Epoch=50.6] | Loss=0.00409 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.459 | L2-Norm(final)=11.789 | 4517.6 samples/s | 70.6 steps/s
[Step=13200 Epoch=50.8] | Loss=0.00380 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.454 | L2-Norm(final)=11.785 | 4473.9 samples/s | 69.9 steps/s
[Step=13250 Epoch=51.0] | Loss=0.00356 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.447 | L2-Norm(final)=11.781 | 4573.5 samples/s | 71.5 steps/s
[Step=13300 Epoch=51.2] | Loss=0.00336 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.438 | L2-Norm(final)=11.779 | 2110.0 samples/s | 33.0 steps/s
[Step=13350 Epoch=51.4] | Loss=0.00316 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.429 | L2-Norm(final)=11.777 | 4722.7 samples/s | 73.8 steps/s
[Step=13400 Epoch=51.6] | Loss=0.00299 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.417 | L2-Norm(final)=11.775 | 4593.0 samples/s | 71.8 steps/s
[Step=13450 Epoch=51.8] | Loss=0.00283 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.405 | L2-Norm(final)=11.774 | 4648.9 samples/s | 72.6 steps/s
[Step=13500 Epoch=52.0] | Loss=0.00269 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.391 | L2-Norm(final)=11.773 | 4589.3 samples/s | 71.7 steps/s
[Step=13550 Epoch=52.2] | Loss=0.00256 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.377 | L2-Norm(final)=11.772 | 2175.0 samples/s | 34.0 steps/s
[Step=13600 Epoch=52.4] | Loss=0.00245 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.361 | L2-Norm(final)=11.771 | 4603.2 samples/s | 71.9 steps/s
[Step=13650 Epoch=52.5] | Loss=0.00234 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.345 | L2-Norm(final)=11.770 | 4532.6 samples/s | 70.8 steps/s
[Step=13700 Epoch=52.7] | Loss=0.00224 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.329 | L2-Norm(final)=11.769 | 4510.1 samples/s | 70.5 steps/s
[Step=13750 Epoch=52.9] | Loss=0.00215 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.312 | L2-Norm(final)=11.769 | 4570.0 samples/s | 71.4 steps/s
[Step=13800 Epoch=53.1] | Loss=0.00207 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.294 | L2-Norm(final)=11.768 | 6684.9 samples/s | 104.5 steps/s
[Step=13850 Epoch=53.3] | Loss=0.00199 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.277 | L2-Norm(final)=11.767 | 1845.1 samples/s | 28.8 steps/s
[Step=13900 Epoch=53.5] | Loss=0.00192 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.259 | L2-Norm(final)=11.767 | 4607.9 samples/s | 72.0 steps/s
[Step=13950 Epoch=53.7] | Loss=0.00186 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.241 | L2-Norm(final)=11.767 | 4610.9 samples/s | 72.0 steps/s
[Step=14000 Epoch=53.9] | Loss=0.00180 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.222 | L2-Norm(final)=11.766 | 4530.6 samples/s | 70.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step14000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06867 | acc=0.9608 | tpr=0.9657 | fpr=0.0498 | 4406.6 samples/s | 17.2 steps/s
Avg test loss: 0.06744, Avg test acc: 0.96045, Avg tpr: 0.96515, Avg fpr: 0.04987, total FA: 389

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06226 | acc=0.9610 | tpr=0.9660 | fpr=0.0498 | 4567.5 samples/s | 17.8 steps/s
Avg test loss: 0.06393, Avg test acc: 0.96021, Avg tpr: 0.96398, Avg fpr: 0.04807, total FA: 375

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.00126 | acc=0.3136 | tpr=0.0023 | fpr=0.0104 | 4457.1 samples/s | 17.4 steps/s
Avg test loss: 7.02365, Avg test acc: 0.31116, Avg tpr: 0.00251, Avg fpr: 0.01000, total FA: 78

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=9.62938 | acc=0.3155 | tpr=0.0041 | fpr=0.0082 | 4451.5 samples/s | 17.4 steps/s
Avg test loss: 9.64638, Avg test acc: 0.31325, Avg tpr: 0.00513, Avg fpr: 0.00910, total FA: 71

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.65793 | acc=0.1220 | tpr=0.7920 | fpr=0.8901 | 4476.8 samples/s | 17.5 steps/s
[Step= 100] | Loss=4.63039 | acc=0.1219 | tpr=0.7740 | fpr=0.8903 | 8363.9 samples/s | 32.7 steps/s
[Step= 150] | Loss=4.63043 | acc=0.1218 | tpr=0.7767 | fpr=0.8903 | 9093.0 samples/s | 35.5 steps/s
[Step= 200] | Loss=4.62573 | acc=0.1214 | tpr=0.7683 | fpr=0.8904 | 8222.9 samples/s | 32.1 steps/s
[Step= 250] | Loss=4.63361 | acc=0.1215 | tpr=0.7729 | fpr=0.8904 | 8434.6 samples/s | 32.9 steps/s
[Step= 300] | Loss=4.63371 | acc=0.1208 | tpr=0.7600 | fpr=0.8909 | 8546.4 samples/s | 33.4 steps/s
[Step= 350] | Loss=4.63378 | acc=0.1204 | tpr=0.7608 | fpr=0.8912 | 8304.1 samples/s | 32.4 steps/s
[Step= 400] | Loss=4.63612 | acc=0.1210 | tpr=0.7626 | fpr=0.8907 | 8601.2 samples/s | 33.6 steps/s
[Step= 450] | Loss=4.63829 | acc=0.1210 | tpr=0.7687 | fpr=0.8907 | 5041.2 samples/s | 19.7 steps/s
[Step= 500] | Loss=4.63498 | acc=0.1213 | tpr=0.7700 | fpr=0.8904 | 8319.8 samples/s | 32.5 steps/s
[Step= 550] | Loss=4.63893 | acc=0.1211 | tpr=0.7716 | fpr=0.8907 | 14731.8 samples/s | 57.5 steps/s
Avg test loss: 4.63968, Avg test acc: 0.12106, Avg tpr: 0.77219, Avg fpr: 0.89077, total FA: 123682

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.92644 | acc=0.1295 | tpr=0.8009 | fpr=0.8826 | 4439.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=4.89794 | acc=0.1314 | tpr=0.7974 | fpr=0.8810 | 8325.8 samples/s | 32.5 steps/s
[Step= 150] | Loss=4.89384 | acc=0.1308 | tpr=0.7968 | fpr=0.8814 | 9110.1 samples/s | 35.6 steps/s
[Step= 200] | Loss=4.88671 | acc=0.1313 | tpr=0.7967 | fpr=0.8809 | 8127.8 samples/s | 31.7 steps/s
[Step= 250] | Loss=4.89766 | acc=0.1312 | tpr=0.7939 | fpr=0.8809 | 8256.1 samples/s | 32.3 steps/s
[Step= 300] | Loss=4.89793 | acc=0.1310 | tpr=0.7927 | fpr=0.8811 | 8739.7 samples/s | 34.1 steps/s
[Step= 350] | Loss=4.89822 | acc=0.1305 | tpr=0.7952 | fpr=0.8816 | 8596.0 samples/s | 33.6 steps/s
[Step= 400] | Loss=4.89881 | acc=0.1307 | tpr=0.7932 | fpr=0.8813 | 8237.2 samples/s | 32.2 steps/s
[Step= 450] | Loss=4.90053 | acc=0.1306 | tpr=0.7945 | fpr=0.8814 | 5203.0 samples/s | 20.3 steps/s
[Step= 500] | Loss=4.89900 | acc=0.1306 | tpr=0.7943 | fpr=0.8814 | 8320.9 samples/s | 32.5 steps/s
[Step= 550] | Loss=4.90185 | acc=0.1302 | tpr=0.7907 | fpr=0.8818 | 15720.4 samples/s | 61.4 steps/s
Avg test loss: 4.90270, Avg test acc: 0.13017, Avg tpr: 0.79120, Avg fpr: 0.88184, total FA: 122442

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.14078 | acc=0.9810 | tpr=0.9248 | fpr=0.0180 | 4458.0 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.14562 | acc=0.9807 | tpr=0.9424 | fpr=0.0186 | 8573.0 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.15429 | acc=0.9794 | tpr=0.9409 | fpr=0.0199 | 8684.8 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.15606 | acc=0.9796 | tpr=0.9443 | fpr=0.0198 | 8489.5 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.15282 | acc=0.9799 | tpr=0.9424 | fpr=0.0194 | 8220.4 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.15414 | acc=0.9798 | tpr=0.9447 | fpr=0.0196 | 9091.8 samples/s | 35.5 steps/s
[Step= 350] | Loss=0.15585 | acc=0.9795 | tpr=0.9461 | fpr=0.0199 | 8197.4 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.15755 | acc=0.9793 | tpr=0.9426 | fpr=0.0201 | 8158.9 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.16061 | acc=0.9789 | tpr=0.9430 | fpr=0.0205 | 7521.5 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.15880 | acc=0.9790 | tpr=0.9445 | fpr=0.0203 | 7696.8 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.15787 | acc=0.9792 | tpr=0.9427 | fpr=0.0201 | 15963.3 samples/s | 62.4 steps/s
Avg test loss: 0.15755, Avg test acc: 0.97923, Avg tpr: 0.94255, Avg fpr: 0.02011, total FA: 2792

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15294 | acc=0.9808 | tpr=0.9336 | fpr=0.0184 | 4397.3 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.16474 | acc=0.9805 | tpr=0.9574 | fpr=0.0191 | 7516.2 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.17177 | acc=0.9795 | tpr=0.9582 | fpr=0.0201 | 7370.1 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.17327 | acc=0.9797 | tpr=0.9617 | fpr=0.0199 | 8218.7 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.16982 | acc=0.9800 | tpr=0.9607 | fpr=0.0196 | 7977.4 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.17205 | acc=0.9800 | tpr=0.9615 | fpr=0.0197 | 8130.8 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.17239 | acc=0.9799 | tpr=0.9618 | fpr=0.0198 | 8507.9 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.17487 | acc=0.9795 | tpr=0.9562 | fpr=0.0200 | 5209.2 samples/s | 20.3 steps/s
[Step= 450] | Loss=0.17779 | acc=0.9794 | tpr=0.9552 | fpr=0.0201 | 8142.2 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.17761 | acc=0.9794 | tpr=0.9564 | fpr=0.0201 | 8387.0 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.17636 | acc=0.9795 | tpr=0.9554 | fpr=0.0200 | 15306.4 samples/s | 59.8 steps/s
Avg test loss: 0.17596, Avg test acc: 0.97956, Avg tpr: 0.95563, Avg fpr: 0.02000, total FA: 2777

server round 7/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=14001 Epoch=27.3] | Loss=0.10354 | Reg=0.00193 | acc=0.9219 | L2-Norm=13.890 | L2-Norm(final)=9.644 | 4220.7 samples/s | 65.9 steps/s
[Step=14050 Epoch=27.4] | Loss=0.08664 | Reg=0.00193 | acc=0.9219 | L2-Norm=13.898 | L2-Norm(final)=9.741 | 5346.1 samples/s | 83.5 steps/s
[Step=14100 Epoch=27.5] | Loss=0.08493 | Reg=0.00193 | acc=0.9375 | L2-Norm=13.899 | L2-Norm(final)=9.865 | 5564.6 samples/s | 86.9 steps/s
[Step=14150 Epoch=27.6] | Loss=0.08294 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.900 | L2-Norm(final)=9.984 | 5716.3 samples/s | 89.3 steps/s
[Step=14200 Epoch=27.7] | Loss=0.08310 | Reg=0.00193 | acc=0.9531 | L2-Norm=13.900 | L2-Norm(final)=10.097 | 5497.2 samples/s | 85.9 steps/s
[Step=14250 Epoch=27.8] | Loss=0.08277 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.900 | L2-Norm(final)=10.204 | 5510.5 samples/s | 86.1 steps/s
[Step=14300 Epoch=27.9] | Loss=0.08267 | Reg=0.00193 | acc=0.9219 | L2-Norm=13.900 | L2-Norm(final)=10.305 | 5619.8 samples/s | 87.8 steps/s
[Step=14350 Epoch=28.0] | Loss=0.08267 | Reg=0.00193 | acc=0.8750 | L2-Norm=13.900 | L2-Norm(final)=10.398 | 5514.5 samples/s | 86.2 steps/s
[Step=14400 Epoch=28.1] | Loss=0.08156 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.900 | L2-Norm(final)=10.488 | 5369.8 samples/s | 83.9 steps/s
[Step=14450 Epoch=28.2] | Loss=0.08083 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.900 | L2-Norm(final)=10.577 | 5497.6 samples/s | 85.9 steps/s
[Step=14500 Epoch=28.3] | Loss=0.08029 | Reg=0.00193 | acc=0.9219 | L2-Norm=13.900 | L2-Norm(final)=10.660 | 6929.5 samples/s | 108.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=14501 Epoch=28.3] | Loss=0.09358 | Reg=0.00193 | acc=0.9375 | L2-Norm=13.901 | L2-Norm(final)=11.477 | 4192.5 samples/s | 65.5 steps/s
[Step=14550 Epoch=28.4] | Loss=0.05767 | Reg=0.00201 | acc=0.9531 | L2-Norm=14.166 | L2-Norm(final)=11.491 | 4537.5 samples/s | 70.9 steps/s
[Step=14600 Epoch=28.5] | Loss=0.05721 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.354 | L2-Norm(final)=11.473 | 4780.4 samples/s | 74.7 steps/s
[Step=14650 Epoch=28.6] | Loss=0.05692 | Reg=0.00210 | acc=0.9531 | L2-Norm=14.486 | L2-Norm(final)=11.460 | 4762.9 samples/s | 74.4 steps/s
[Step=14700 Epoch=28.7] | Loss=0.05594 | Reg=0.00213 | acc=0.9375 | L2-Norm=14.587 | L2-Norm(final)=11.445 | 4761.7 samples/s | 74.4 steps/s
[Step=14750 Epoch=28.8] | Loss=0.05553 | Reg=0.00215 | acc=0.9531 | L2-Norm=14.668 | L2-Norm(final)=11.430 | 4811.8 samples/s | 75.2 steps/s
[Step=14800 Epoch=28.9] | Loss=0.05377 | Reg=0.00217 | acc=0.9375 | L2-Norm=14.739 | L2-Norm(final)=11.418 | 4771.0 samples/s | 74.5 steps/s
[Step=14850 Epoch=29.0] | Loss=0.05197 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.801 | L2-Norm(final)=11.405 | 4779.7 samples/s | 74.7 steps/s
[Step=14900 Epoch=29.1] | Loss=0.05044 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.858 | L2-Norm(final)=11.393 | 4842.9 samples/s | 75.7 steps/s
[Step=14950 Epoch=29.2] | Loss=0.04981 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.910 | L2-Norm(final)=11.382 | 4841.5 samples/s | 75.6 steps/s
[Step=15000 Epoch=29.3] | Loss=0.04876 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.958 | L2-Norm(final)=11.373 | 5797.9 samples/s | 90.6 steps/s
[Step=15050 Epoch=29.4] | Loss=0.04680 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.004 | L2-Norm(final)=11.364 | 1979.1 samples/s | 30.9 steps/s
[Step=15100 Epoch=29.5] | Loss=0.04535 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.045 | L2-Norm(final)=11.357 | 4824.8 samples/s | 75.4 steps/s
[Step=15150 Epoch=29.5] | Loss=0.04416 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.083 | L2-Norm(final)=11.349 | 4758.9 samples/s | 74.4 steps/s
[Step=15200 Epoch=29.6] | Loss=0.04334 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.118 | L2-Norm(final)=11.342 | 4759.3 samples/s | 74.4 steps/s
[Step=15250 Epoch=29.7] | Loss=0.04235 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.151 | L2-Norm(final)=11.335 | 4786.8 samples/s | 74.8 steps/s
[Step=15300 Epoch=29.8] | Loss=0.04151 | Reg=0.00231 | acc=0.9531 | L2-Norm=15.182 | L2-Norm(final)=11.329 | 4739.2 samples/s | 74.0 steps/s
[Step=15350 Epoch=29.9] | Loss=0.04052 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.213 | L2-Norm(final)=11.324 | 4756.2 samples/s | 74.3 steps/s
[Step=15400 Epoch=30.0] | Loss=0.04024 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.244 | L2-Norm(final)=11.318 | 4793.1 samples/s | 74.9 steps/s
[Step=15450 Epoch=30.1] | Loss=0.03977 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.274 | L2-Norm(final)=11.313 | 4801.6 samples/s | 75.0 steps/s
[Step=15500 Epoch=30.2] | Loss=0.03933 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.305 | L2-Norm(final)=11.308 | 5067.1 samples/s | 79.2 steps/s
[Step=15550 Epoch=30.3] | Loss=0.03854 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.334 | L2-Norm(final)=11.303 | 2080.5 samples/s | 32.5 steps/s
[Step=15600 Epoch=30.4] | Loss=0.03790 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.362 | L2-Norm(final)=11.298 | 4820.9 samples/s | 75.3 steps/s
[Step=15650 Epoch=30.5] | Loss=0.03709 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.389 | L2-Norm(final)=11.294 | 4805.7 samples/s | 75.1 steps/s
[Step=15700 Epoch=30.6] | Loss=0.03643 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.415 | L2-Norm(final)=11.289 | 4758.5 samples/s | 74.4 steps/s
[Step=15750 Epoch=30.7] | Loss=0.03580 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.440 | L2-Norm(final)=11.285 | 4714.2 samples/s | 73.7 steps/s
[Step=15800 Epoch=30.8] | Loss=0.03533 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.465 | L2-Norm(final)=11.281 | 4769.0 samples/s | 74.5 steps/s
[Step=15850 Epoch=30.9] | Loss=0.03498 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.490 | L2-Norm(final)=11.277 | 4745.7 samples/s | 74.2 steps/s
[Step=15900 Epoch=31.0] | Loss=0.03458 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.514 | L2-Norm(final)=11.274 | 4874.1 samples/s | 76.2 steps/s
[Step=15950 Epoch=31.1] | Loss=0.03432 | Reg=0.00242 | acc=0.9531 | L2-Norm=15.539 | L2-Norm(final)=11.270 | 4773.6 samples/s | 74.6 steps/s
[Step=16000 Epoch=31.2] | Loss=0.03422 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.563 | L2-Norm(final)=11.267 | 4871.1 samples/s | 76.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step16000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=14001 Epoch=27.4] | Loss=0.05780 | Reg=0.00193 | acc=0.9531 | L2-Norm=13.890 | L2-Norm(final)=9.311 | 4400.6 samples/s | 68.8 steps/s
[Step=14050 Epoch=27.5] | Loss=0.08400 | Reg=0.00193 | acc=0.9531 | L2-Norm=13.900 | L2-Norm(final)=9.410 | 5208.3 samples/s | 81.4 steps/s
[Step=14100 Epoch=27.6] | Loss=0.08543 | Reg=0.00193 | acc=0.9375 | L2-Norm=13.902 | L2-Norm(final)=9.529 | 5657.2 samples/s | 88.4 steps/s
[Step=14150 Epoch=27.7] | Loss=0.08300 | Reg=0.00193 | acc=0.9375 | L2-Norm=13.903 | L2-Norm(final)=9.648 | 5703.1 samples/s | 89.1 steps/s
[Step=14200 Epoch=27.8] | Loss=0.08233 | Reg=0.00193 | acc=0.9219 | L2-Norm=13.903 | L2-Norm(final)=9.770 | 5541.4 samples/s | 86.6 steps/s
[Step=14250 Epoch=27.9] | Loss=0.08150 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.903 | L2-Norm(final)=9.888 | 5753.7 samples/s | 89.9 steps/s
[Step=14300 Epoch=28.0] | Loss=0.08116 | Reg=0.00193 | acc=0.9375 | L2-Norm=13.903 | L2-Norm(final)=10.000 | 5542.0 samples/s | 86.6 steps/s
[Step=14350 Epoch=28.1] | Loss=0.08194 | Reg=0.00193 | acc=0.8906 | L2-Norm=13.903 | L2-Norm(final)=10.106 | 5564.3 samples/s | 86.9 steps/s
[Step=14400 Epoch=28.2] | Loss=0.08183 | Reg=0.00193 | acc=0.9219 | L2-Norm=13.903 | L2-Norm(final)=10.204 | 5503.8 samples/s | 86.0 steps/s
[Step=14450 Epoch=28.2] | Loss=0.08108 | Reg=0.00193 | acc=0.9375 | L2-Norm=13.903 | L2-Norm(final)=10.298 | 5579.2 samples/s | 87.2 steps/s
[Step=14500 Epoch=28.3] | Loss=0.08050 | Reg=0.00193 | acc=0.9531 | L2-Norm=13.904 | L2-Norm(final)=10.388 | 6933.8 samples/s | 108.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=14501 Epoch=28.3] | Loss=0.11974 | Reg=0.00193 | acc=0.9062 | L2-Norm=13.904 | L2-Norm(final)=11.280 | 4318.8 samples/s | 67.5 steps/s
[Step=14550 Epoch=28.4] | Loss=0.05889 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.154 | L2-Norm(final)=11.288 | 4708.2 samples/s | 73.6 steps/s
[Step=14600 Epoch=28.5] | Loss=0.05585 | Reg=0.00206 | acc=0.9219 | L2-Norm=14.344 | L2-Norm(final)=11.277 | 4856.4 samples/s | 75.9 steps/s
[Step=14650 Epoch=28.6] | Loss=0.05523 | Reg=0.00210 | acc=0.9375 | L2-Norm=14.493 | L2-Norm(final)=11.258 | 4703.4 samples/s | 73.5 steps/s
[Step=14700 Epoch=28.7] | Loss=0.05300 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.606 | L2-Norm(final)=11.242 | 4784.9 samples/s | 74.8 steps/s
[Step=14750 Epoch=28.8] | Loss=0.05110 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.690 | L2-Norm(final)=11.230 | 4775.8 samples/s | 74.6 steps/s
[Step=14800 Epoch=28.9] | Loss=0.05062 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.758 | L2-Norm(final)=11.219 | 4854.3 samples/s | 75.8 steps/s
[Step=14850 Epoch=29.0] | Loss=0.04931 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.820 | L2-Norm(final)=11.210 | 4722.0 samples/s | 73.8 steps/s
[Step=14900 Epoch=29.1] | Loss=0.04835 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.878 | L2-Norm(final)=11.203 | 4772.4 samples/s | 74.6 steps/s
[Step=14950 Epoch=29.2] | Loss=0.04704 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.934 | L2-Norm(final)=11.195 | 4753.5 samples/s | 74.3 steps/s
[Step=15000 Epoch=29.3] | Loss=0.04590 | Reg=0.00225 | acc=0.9531 | L2-Norm=14.984 | L2-Norm(final)=11.188 | 5833.4 samples/s | 91.1 steps/s
[Step=15050 Epoch=29.4] | Loss=0.04401 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.029 | L2-Norm(final)=11.182 | 2062.6 samples/s | 32.2 steps/s
[Step=15100 Epoch=29.5] | Loss=0.04226 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.072 | L2-Norm(final)=11.177 | 4844.2 samples/s | 75.7 steps/s
[Step=15150 Epoch=29.6] | Loss=0.04131 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.111 | L2-Norm(final)=11.172 | 4899.9 samples/s | 76.6 steps/s
[Step=15200 Epoch=29.7] | Loss=0.04039 | Reg=0.00230 | acc=0.9531 | L2-Norm=15.148 | L2-Norm(final)=11.167 | 4744.8 samples/s | 74.1 steps/s
[Step=15250 Epoch=29.8] | Loss=0.03929 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.182 | L2-Norm(final)=11.163 | 4789.2 samples/s | 74.8 steps/s
[Step=15300 Epoch=29.9] | Loss=0.03858 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.215 | L2-Norm(final)=11.159 | 4792.1 samples/s | 74.9 steps/s
[Step=15350 Epoch=30.0] | Loss=0.03819 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.245 | L2-Norm(final)=11.154 | 4870.0 samples/s | 76.1 steps/s
[Step=15400 Epoch=30.1] | Loss=0.03762 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.274 | L2-Norm(final)=11.150 | 4920.3 samples/s | 76.9 steps/s
[Step=15450 Epoch=30.2] | Loss=0.03717 | Reg=0.00234 | acc=0.9531 | L2-Norm=15.302 | L2-Norm(final)=11.146 | 4913.5 samples/s | 76.8 steps/s
[Step=15500 Epoch=30.3] | Loss=0.03672 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.328 | L2-Norm(final)=11.143 | 5306.1 samples/s | 82.9 steps/s
[Step=15550 Epoch=30.4] | Loss=0.03598 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.354 | L2-Norm(final)=11.139 | 2148.2 samples/s | 33.6 steps/s
[Step=15600 Epoch=30.5] | Loss=0.03518 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.379 | L2-Norm(final)=11.135 | 4937.0 samples/s | 77.1 steps/s
[Step=15650 Epoch=30.6] | Loss=0.03445 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.403 | L2-Norm(final)=11.132 | 4888.6 samples/s | 76.4 steps/s
[Step=15700 Epoch=30.7] | Loss=0.03392 | Reg=0.00238 | acc=0.9375 | L2-Norm=15.426 | L2-Norm(final)=11.129 | 4829.6 samples/s | 75.5 steps/s
[Step=15750 Epoch=30.8] | Loss=0.03333 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.448 | L2-Norm(final)=11.125 | 4880.8 samples/s | 76.3 steps/s
[Step=15800 Epoch=30.9] | Loss=0.03307 | Reg=0.00240 | acc=0.9531 | L2-Norm=15.471 | L2-Norm(final)=11.122 | 4908.8 samples/s | 76.7 steps/s
[Step=15850 Epoch=31.0] | Loss=0.03284 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.493 | L2-Norm(final)=11.119 | 4917.6 samples/s | 76.8 steps/s
[Step=15900 Epoch=31.1] | Loss=0.03253 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.516 | L2-Norm(final)=11.115 | 4881.4 samples/s | 76.3 steps/s
[Step=15950 Epoch=31.2] | Loss=0.03246 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.539 | L2-Norm(final)=11.112 | 4883.3 samples/s | 76.3 steps/s
[Step=16000 Epoch=31.3] | Loss=0.03223 | Reg=0.00242 | acc=0.9531 | L2-Norm=15.562 | L2-Norm(final)=11.108 | 4873.9 samples/s | 76.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step16000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=14001 Epoch=53.6] | Loss=0.00131 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.890 | L2-Norm(final)=12.497 | 4265.9 samples/s | 66.7 steps/s
[Step=14050 Epoch=53.8] | Loss=0.00630 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.883 | L2-Norm(final)=12.530 | 4893.9 samples/s | 76.5 steps/s
[Step=14100 Epoch=54.0] | Loss=0.00610 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.883 | L2-Norm(final)=12.566 | 5242.1 samples/s | 81.9 steps/s
[Step=14150 Epoch=54.2] | Loss=0.00619 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.882 | L2-Norm(final)=12.603 | 5290.2 samples/s | 82.7 steps/s
[Step=14200 Epoch=54.4] | Loss=0.00602 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.882 | L2-Norm(final)=12.640 | 5274.3 samples/s | 82.4 steps/s
[Step=14250 Epoch=54.6] | Loss=0.00604 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.882 | L2-Norm(final)=12.676 | 7038.8 samples/s | 110.0 steps/s
[Step=14300 Epoch=54.8] | Loss=0.00598 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.882 | L2-Norm(final)=12.713 | 2029.6 samples/s | 31.7 steps/s
[Step=14350 Epoch=55.0] | Loss=0.00583 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.882 | L2-Norm(final)=12.750 | 5207.5 samples/s | 81.4 steps/s
[Step=14400 Epoch=55.2] | Loss=0.00580 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.882 | L2-Norm(final)=12.787 | 5187.3 samples/s | 81.1 steps/s
[Step=14450 Epoch=55.4] | Loss=0.00580 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.882 | L2-Norm(final)=12.823 | 4976.0 samples/s | 77.8 steps/s
[Step=14500 Epoch=55.6] | Loss=0.00580 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.882 | L2-Norm(final)=12.857 | 5593.4 samples/s | 87.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=14501 Epoch=55.6] | Loss=0.00289 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.882 | L2-Norm(final)=13.199 | 4255.1 samples/s | 66.5 steps/s
[Step=14550 Epoch=55.8] | Loss=0.00801 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.012 | L2-Norm(final)=13.204 | 4231.1 samples/s | 66.1 steps/s
[Step=14600 Epoch=55.9] | Loss=0.00838 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.184 | L2-Norm(final)=13.173 | 4573.5 samples/s | 71.5 steps/s
[Step=14650 Epoch=56.1] | Loss=0.00732 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.286 | L2-Norm(final)=13.156 | 4674.3 samples/s | 73.0 steps/s
[Step=14700 Epoch=56.3] | Loss=0.00734 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.385 | L2-Norm(final)=13.135 | 4589.3 samples/s | 71.7 steps/s
[Step=14750 Epoch=56.5] | Loss=0.00840 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.479 | L2-Norm(final)=13.111 | 5849.7 samples/s | 91.4 steps/s
[Step=14800 Epoch=56.7] | Loss=0.00727 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.556 | L2-Norm(final)=13.093 | 1985.2 samples/s | 31.0 steps/s
[Step=14850 Epoch=56.9] | Loss=0.00635 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.607 | L2-Norm(final)=13.081 | 4653.7 samples/s | 72.7 steps/s
[Step=14900 Epoch=57.1] | Loss=0.00557 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.639 | L2-Norm(final)=13.073 | 4671.1 samples/s | 73.0 steps/s
[Step=14950 Epoch=57.3] | Loss=0.00496 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.657 | L2-Norm(final)=13.067 | 4702.0 samples/s | 73.5 steps/s
[Step=15000 Epoch=57.5] | Loss=0.00447 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.667 | L2-Norm(final)=13.062 | 5057.9 samples/s | 79.0 steps/s
[Step=15050 Epoch=57.7] | Loss=0.00406 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.670 | L2-Norm(final)=13.059 | 2074.0 samples/s | 32.4 steps/s
[Step=15100 Epoch=57.9] | Loss=0.00373 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.668 | L2-Norm(final)=13.056 | 4611.0 samples/s | 72.0 steps/s
[Step=15150 Epoch=58.0] | Loss=0.00344 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.662 | L2-Norm(final)=13.054 | 4500.8 samples/s | 70.3 steps/s
[Step=15200 Epoch=58.2] | Loss=0.00320 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.654 | L2-Norm(final)=13.052 | 4587.6 samples/s | 71.7 steps/s
[Step=15250 Epoch=58.4] | Loss=0.00298 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.643 | L2-Norm(final)=13.050 | 4514.2 samples/s | 70.5 steps/s
[Step=15300 Epoch=58.6] | Loss=0.00280 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.631 | L2-Norm(final)=13.049 | 2101.8 samples/s | 32.8 steps/s
[Step=15350 Epoch=58.8] | Loss=0.00263 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.618 | L2-Norm(final)=13.048 | 4571.3 samples/s | 71.4 steps/s
[Step=15400 Epoch=59.0] | Loss=0.00249 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.603 | L2-Norm(final)=13.047 | 4630.0 samples/s | 72.3 steps/s
[Step=15450 Epoch=59.2] | Loss=0.00236 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.587 | L2-Norm(final)=13.046 | 4544.3 samples/s | 71.0 steps/s
[Step=15500 Epoch=59.4] | Loss=0.00224 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.571 | L2-Norm(final)=13.045 | 4535.2 samples/s | 70.9 steps/s
[Step=15550 Epoch=59.6] | Loss=0.00213 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.554 | L2-Norm(final)=13.045 | 2118.4 samples/s | 33.1 steps/s
[Step=15600 Epoch=59.8] | Loss=0.00204 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.537 | L2-Norm(final)=13.044 | 4551.9 samples/s | 71.1 steps/s
[Step=15650 Epoch=60.0] | Loss=0.00195 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.519 | L2-Norm(final)=13.044 | 4492.9 samples/s | 70.2 steps/s
[Step=15700 Epoch=60.2] | Loss=0.00187 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.500 | L2-Norm(final)=13.043 | 4504.2 samples/s | 70.4 steps/s
[Step=15750 Epoch=60.3] | Loss=0.00179 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.482 | L2-Norm(final)=13.043 | 4495.5 samples/s | 70.2 steps/s
[Step=15800 Epoch=60.5] | Loss=0.00172 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.463 | L2-Norm(final)=13.042 | 6175.5 samples/s | 96.5 steps/s
[Step=15850 Epoch=60.7] | Loss=0.00166 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.444 | L2-Norm(final)=13.042 | 1862.2 samples/s | 29.1 steps/s
[Step=15900 Epoch=60.9] | Loss=0.00160 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.425 | L2-Norm(final)=13.042 | 4502.6 samples/s | 70.4 steps/s
[Step=15950 Epoch=61.1] | Loss=0.00154 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.405 | L2-Norm(final)=13.042 | 4512.9 samples/s | 70.5 steps/s
[Step=16000 Epoch=61.3] | Loss=0.00149 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.386 | L2-Norm(final)=13.042 | 4474.0 samples/s | 69.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step16000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=14001 Epoch=53.9] | Loss=0.00786 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.890 | L2-Norm(final)=11.756 | 4434.7 samples/s | 69.3 steps/s
[Step=14050 Epoch=54.1] | Loss=0.00565 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.883 | L2-Norm(final)=11.797 | 4832.6 samples/s | 75.5 steps/s
[Step=14100 Epoch=54.3] | Loss=0.00601 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.883 | L2-Norm(final)=11.842 | 5301.2 samples/s | 82.8 steps/s
[Step=14150 Epoch=54.5] | Loss=0.00544 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.882 | L2-Norm(final)=11.891 | 5227.6 samples/s | 81.7 steps/s
[Step=14200 Epoch=54.7] | Loss=0.00543 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.882 | L2-Norm(final)=11.939 | 5297.5 samples/s | 82.8 steps/s
[Step=14250 Epoch=54.9] | Loss=0.00516 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.882 | L2-Norm(final)=11.980 | 7134.3 samples/s | 111.5 steps/s
[Step=14300 Epoch=55.0] | Loss=0.00516 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.882 | L2-Norm(final)=12.022 | 2023.5 samples/s | 31.6 steps/s
[Step=14350 Epoch=55.2] | Loss=0.00503 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.882 | L2-Norm(final)=12.066 | 5180.9 samples/s | 81.0 steps/s
[Step=14400 Epoch=55.4] | Loss=0.00495 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.882 | L2-Norm(final)=12.108 | 5231.0 samples/s | 81.7 steps/s
[Step=14450 Epoch=55.6] | Loss=0.00509 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.882 | L2-Norm(final)=12.150 | 5063.9 samples/s | 79.1 steps/s
[Step=14500 Epoch=55.8] | Loss=0.00496 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.882 | L2-Norm(final)=12.191 | 5956.7 samples/s | 93.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=14501 Epoch=55.8] | Loss=0.00055 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.882 | L2-Norm(final)=12.611 | 4360.1 samples/s | 68.1 steps/s
[Step=14550 Epoch=56.0] | Loss=0.00486 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.000 | L2-Norm(final)=12.635 | 4285.4 samples/s | 67.0 steps/s
[Step=14600 Epoch=56.2] | Loss=0.01471 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.248 | L2-Norm(final)=12.587 | 4695.7 samples/s | 73.4 steps/s
[Step=14650 Epoch=56.4] | Loss=0.01282 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.435 | L2-Norm(final)=12.542 | 4587.2 samples/s | 71.7 steps/s
[Step=14700 Epoch=56.6] | Loss=0.01097 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.546 | L2-Norm(final)=12.517 | 4585.6 samples/s | 71.6 steps/s
[Step=14750 Epoch=56.8] | Loss=0.00952 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.620 | L2-Norm(final)=12.500 | 5775.0 samples/s | 90.2 steps/s
[Step=14800 Epoch=57.0] | Loss=0.00830 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.669 | L2-Norm(final)=12.488 | 1967.1 samples/s | 30.7 steps/s
[Step=14850 Epoch=57.2] | Loss=0.00760 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.705 | L2-Norm(final)=12.479 | 4492.0 samples/s | 70.2 steps/s
[Step=14900 Epoch=57.4] | Loss=0.00677 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.728 | L2-Norm(final)=12.472 | 4516.9 samples/s | 70.6 steps/s
[Step=14950 Epoch=57.5] | Loss=0.00607 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.744 | L2-Norm(final)=12.467 | 4488.5 samples/s | 70.1 steps/s
[Step=15000 Epoch=57.7] | Loss=0.00558 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.753 | L2-Norm(final)=12.463 | 5211.2 samples/s | 81.4 steps/s
[Step=15050 Epoch=57.9] | Loss=0.00527 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.760 | L2-Norm(final)=12.460 | 2040.0 samples/s | 31.9 steps/s
[Step=15100 Epoch=58.1] | Loss=0.00509 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.766 | L2-Norm(final)=12.456 | 4510.1 samples/s | 70.5 steps/s
[Step=15150 Epoch=58.3] | Loss=0.00489 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.773 | L2-Norm(final)=12.451 | 4548.8 samples/s | 71.1 steps/s
[Step=15200 Epoch=58.5] | Loss=0.00478 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.781 | L2-Norm(final)=12.446 | 4576.5 samples/s | 71.5 steps/s
[Step=15250 Epoch=58.7] | Loss=0.00451 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.788 | L2-Norm(final)=12.442 | 4640.9 samples/s | 72.5 steps/s
[Step=15300 Epoch=58.9] | Loss=0.00424 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.792 | L2-Norm(final)=12.438 | 2094.1 samples/s | 32.7 steps/s
[Step=15350 Epoch=59.1] | Loss=0.00399 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.793 | L2-Norm(final)=12.436 | 4736.8 samples/s | 74.0 steps/s
[Step=15400 Epoch=59.3] | Loss=0.00378 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.791 | L2-Norm(final)=12.433 | 4578.9 samples/s | 71.5 steps/s
[Step=15450 Epoch=59.5] | Loss=0.00358 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.787 | L2-Norm(final)=12.432 | 4503.2 samples/s | 70.4 steps/s
[Step=15500 Epoch=59.7] | Loss=0.00340 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.782 | L2-Norm(final)=12.430 | 4532.6 samples/s | 70.8 steps/s
[Step=15550 Epoch=59.9] | Loss=0.00324 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.774 | L2-Norm(final)=12.429 | 2110.3 samples/s | 33.0 steps/s
[Step=15600 Epoch=60.1] | Loss=0.00309 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.766 | L2-Norm(final)=12.427 | 4626.4 samples/s | 72.3 steps/s
[Step=15650 Epoch=60.2] | Loss=0.00296 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.756 | L2-Norm(final)=12.426 | 4525.6 samples/s | 70.7 steps/s
[Step=15700 Epoch=60.4] | Loss=0.00284 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.745 | L2-Norm(final)=12.425 | 4522.4 samples/s | 70.7 steps/s
[Step=15750 Epoch=60.6] | Loss=0.00272 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.733 | L2-Norm(final)=12.424 | 4576.4 samples/s | 71.5 steps/s
[Step=15800 Epoch=60.8] | Loss=0.00262 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.721 | L2-Norm(final)=12.424 | 6654.9 samples/s | 104.0 steps/s
[Step=15850 Epoch=61.0] | Loss=0.00252 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.708 | L2-Norm(final)=12.423 | 1846.0 samples/s | 28.8 steps/s
[Step=15900 Epoch=61.2] | Loss=0.00243 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.694 | L2-Norm(final)=12.422 | 4509.7 samples/s | 70.5 steps/s
[Step=15950 Epoch=61.4] | Loss=0.00235 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.680 | L2-Norm(final)=12.422 | 4565.2 samples/s | 71.3 steps/s
[Step=16000 Epoch=61.6] | Loss=0.00227 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.665 | L2-Norm(final)=12.422 | 4516.4 samples/s | 70.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06714 | acc=0.9609 | tpr=0.9679 | fpr=0.0543 | 3204.2 samples/s | 12.5 steps/s
Avg test loss: 0.06652, Avg test acc: 0.96033, Avg tpr: 0.96695, Avg fpr: 0.05422, total FA: 423

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06935 | acc=0.9591 | tpr=0.9684 | fpr=0.0610 | 4484.5 samples/s | 17.5 steps/s
Avg test loss: 0.06847, Avg test acc: 0.95973, Avg tpr: 0.96864, Avg fpr: 0.05986, total FA: 467

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.92279 | acc=0.3143 | tpr=0.0010 | fpr=0.0055 | 4457.4 samples/s | 17.4 steps/s
Avg test loss: 7.93871, Avg test acc: 0.31160, Avg tpr: 0.00117, Avg fpr: 0.00564, total FA: 44

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.60778 | acc=0.3146 | tpr=0.0026 | fpr=0.0079 | 4461.4 samples/s | 17.4 steps/s
Avg test loss: 7.62339, Avg test acc: 0.31236, Avg tpr: 0.00286, Avg fpr: 0.00692, total FA: 54

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.15501 | acc=0.1041 | tpr=0.8274 | fpr=0.9089 | 4531.0 samples/s | 17.7 steps/s
[Step= 100] | Loss=5.10118 | acc=0.1053 | tpr=0.7910 | fpr=0.9075 | 8440.5 samples/s | 33.0 steps/s
[Step= 150] | Loss=5.10571 | acc=0.1053 | tpr=0.7896 | fpr=0.9073 | 8348.0 samples/s | 32.6 steps/s
[Step= 200] | Loss=5.10504 | acc=0.1053 | tpr=0.7836 | fpr=0.9070 | 8560.6 samples/s | 33.4 steps/s
[Step= 250] | Loss=5.10630 | acc=0.1059 | tpr=0.7886 | fpr=0.9066 | 8862.9 samples/s | 34.6 steps/s
[Step= 300] | Loss=5.10441 | acc=0.1057 | tpr=0.7847 | fpr=0.9066 | 8254.6 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.10346 | acc=0.1050 | tpr=0.7833 | fpr=0.9073 | 8427.4 samples/s | 32.9 steps/s
[Step= 400] | Loss=5.10522 | acc=0.1051 | tpr=0.7784 | fpr=0.9072 | 8505.7 samples/s | 33.2 steps/s
[Step= 450] | Loss=5.10651 | acc=0.1056 | tpr=0.7853 | fpr=0.9068 | 8618.1 samples/s | 33.7 steps/s
[Step= 500] | Loss=5.10870 | acc=0.1055 | tpr=0.7881 | fpr=0.9069 | 8080.5 samples/s | 31.6 steps/s
[Step= 550] | Loss=5.11635 | acc=0.1052 | tpr=0.7867 | fpr=0.9072 | 15572.0 samples/s | 60.8 steps/s
Avg test loss: 5.11671, Avg test acc: 0.10518, Avg tpr: 0.78724, Avg fpr: 0.90722, total FA: 125965

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.32912 | acc=0.1323 | tpr=0.7611 | fpr=0.8790 | 4625.0 samples/s | 18.1 steps/s
[Step= 100] | Loss=5.29199 | acc=0.1333 | tpr=0.7676 | fpr=0.8786 | 8232.0 samples/s | 32.2 steps/s
[Step= 150] | Loss=5.29081 | acc=0.1344 | tpr=0.7723 | fpr=0.8773 | 8302.6 samples/s | 32.4 steps/s
[Step= 200] | Loss=5.28848 | acc=0.1355 | tpr=0.7705 | fpr=0.8761 | 8379.0 samples/s | 32.7 steps/s
[Step= 250] | Loss=5.29838 | acc=0.1352 | tpr=0.7747 | fpr=0.8765 | 8341.9 samples/s | 32.6 steps/s
[Step= 300] | Loss=5.29686 | acc=0.1348 | tpr=0.7738 | fpr=0.8768 | 8450.1 samples/s | 33.0 steps/s
[Step= 350] | Loss=5.29590 | acc=0.1347 | tpr=0.7746 | fpr=0.8769 | 8620.6 samples/s | 33.7 steps/s
[Step= 400] | Loss=5.29881 | acc=0.1353 | tpr=0.7757 | fpr=0.8763 | 8146.8 samples/s | 31.8 steps/s
[Step= 450] | Loss=5.30212 | acc=0.1350 | tpr=0.7785 | fpr=0.8767 | 8565.5 samples/s | 33.5 steps/s
[Step= 500] | Loss=5.30209 | acc=0.1350 | tpr=0.7780 | fpr=0.8766 | 8528.6 samples/s | 33.3 steps/s
[Step= 550] | Loss=5.30437 | acc=0.1347 | tpr=0.7768 | fpr=0.8770 | 14857.6 samples/s | 58.0 steps/s
Avg test loss: 5.30537, Avg test acc: 0.13462, Avg tpr: 0.77694, Avg fpr: 0.87706, total FA: 121778

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11451 | acc=0.9835 | tpr=0.9381 | fpr=0.0157 | 4457.8 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.11798 | acc=0.9834 | tpr=0.9531 | fpr=0.0160 | 8413.3 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.12483 | acc=0.9823 | tpr=0.9539 | fpr=0.0172 | 8553.6 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.12572 | acc=0.9823 | tpr=0.9563 | fpr=0.0172 | 8171.2 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.12314 | acc=0.9824 | tpr=0.9581 | fpr=0.0172 | 8775.5 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.12476 | acc=0.9821 | tpr=0.9549 | fpr=0.0174 | 8124.7 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.12604 | acc=0.9819 | tpr=0.9543 | fpr=0.0176 | 8689.0 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.12737 | acc=0.9816 | tpr=0.9519 | fpr=0.0178 | 8470.4 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.13018 | acc=0.9813 | tpr=0.9499 | fpr=0.0181 | 8456.0 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.12961 | acc=0.9813 | tpr=0.9511 | fpr=0.0181 | 8335.9 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.12832 | acc=0.9815 | tpr=0.9499 | fpr=0.0179 | 15333.1 samples/s | 59.9 steps/s
Avg test loss: 0.12808, Avg test acc: 0.98152, Avg tpr: 0.94929, Avg fpr: 0.01789, total FA: 2484

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13960 | acc=0.9812 | tpr=0.9381 | fpr=0.0181 | 4420.0 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.15113 | acc=0.9806 | tpr=0.9531 | fpr=0.0189 | 8456.8 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.15961 | acc=0.9798 | tpr=0.9568 | fpr=0.0197 | 8429.0 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.16234 | acc=0.9797 | tpr=0.9574 | fpr=0.0198 | 8352.6 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.16030 | acc=0.9799 | tpr=0.9555 | fpr=0.0196 | 8452.4 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.16328 | acc=0.9796 | tpr=0.9571 | fpr=0.0200 | 8463.5 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.16455 | acc=0.9793 | tpr=0.9574 | fpr=0.0204 | 8324.1 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.16748 | acc=0.9789 | tpr=0.9546 | fpr=0.0207 | 8414.0 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.17052 | acc=0.9787 | tpr=0.9528 | fpr=0.0209 | 8939.9 samples/s | 34.9 steps/s
[Step= 500] | Loss=0.17013 | acc=0.9787 | tpr=0.9520 | fpr=0.0208 | 8040.5 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.16859 | acc=0.9789 | tpr=0.9511 | fpr=0.0205 | 15615.4 samples/s | 61.0 steps/s
Avg test loss: 0.16820, Avg test acc: 0.97898, Avg tpr: 0.95127, Avg fpr: 0.02052, total FA: 2849

server round 8/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=16001 Epoch=31.2] | Loss=0.05717 | Reg=0.00195 | acc=0.9531 | L2-Norm=13.968 | L2-Norm(final)=11.160 | 4100.8 samples/s | 64.1 steps/s
[Step=16050 Epoch=31.3] | Loss=0.07597 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.976 | L2-Norm(final)=11.197 | 5132.7 samples/s | 80.2 steps/s
[Step=16100 Epoch=31.4] | Loss=0.07443 | Reg=0.00195 | acc=0.9062 | L2-Norm=13.977 | L2-Norm(final)=11.235 | 5604.0 samples/s | 87.6 steps/s
[Step=16150 Epoch=31.5] | Loss=0.07279 | Reg=0.00195 | acc=0.9531 | L2-Norm=13.978 | L2-Norm(final)=11.275 | 5599.4 samples/s | 87.5 steps/s
[Step=16200 Epoch=31.6] | Loss=0.07239 | Reg=0.00195 | acc=0.9375 | L2-Norm=13.978 | L2-Norm(final)=11.315 | 5697.4 samples/s | 89.0 steps/s
[Step=16250 Epoch=31.7] | Loss=0.07147 | Reg=0.00195 | acc=0.9375 | L2-Norm=13.978 | L2-Norm(final)=11.353 | 5472.1 samples/s | 85.5 steps/s
[Step=16300 Epoch=31.8] | Loss=0.07060 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.978 | L2-Norm(final)=11.396 | 5522.9 samples/s | 86.3 steps/s
[Step=16350 Epoch=31.9] | Loss=0.06984 | Reg=0.00195 | acc=0.9219 | L2-Norm=13.978 | L2-Norm(final)=11.439 | 5537.0 samples/s | 86.5 steps/s
[Step=16400 Epoch=32.0] | Loss=0.06991 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.978 | L2-Norm(final)=11.480 | 5524.8 samples/s | 86.3 steps/s
[Step=16450 Epoch=32.1] | Loss=0.06939 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.978 | L2-Norm(final)=11.521 | 5500.3 samples/s | 85.9 steps/s
[Step=16500 Epoch=32.2] | Loss=0.06882 | Reg=0.00195 | acc=0.9219 | L2-Norm=13.979 | L2-Norm(final)=11.561 | 6901.2 samples/s | 107.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=16501 Epoch=32.2] | Loss=0.05140 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.979 | L2-Norm(final)=11.959 | 3907.5 samples/s | 61.1 steps/s
[Step=16550 Epoch=32.3] | Loss=0.04920 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.261 | L2-Norm(final)=11.964 | 4935.4 samples/s | 77.1 steps/s
[Step=16600 Epoch=32.4] | Loss=0.05185 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.449 | L2-Norm(final)=11.947 | 4925.6 samples/s | 77.0 steps/s
[Step=16650 Epoch=32.5] | Loss=0.04905 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.576 | L2-Norm(final)=11.929 | 4909.9 samples/s | 76.7 steps/s
[Step=16700 Epoch=32.6] | Loss=0.04971 | Reg=0.00215 | acc=0.9219 | L2-Norm=14.671 | L2-Norm(final)=11.914 | 4918.9 samples/s | 76.9 steps/s
[Step=16750 Epoch=32.7] | Loss=0.04789 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.752 | L2-Norm(final)=11.898 | 4902.5 samples/s | 76.6 steps/s
[Step=16800 Epoch=32.8] | Loss=0.04644 | Reg=0.00220 | acc=0.9531 | L2-Norm=14.821 | L2-Norm(final)=11.886 | 4920.0 samples/s | 76.9 steps/s
[Step=16850 Epoch=32.9] | Loss=0.04611 | Reg=0.00222 | acc=0.9531 | L2-Norm=14.880 | L2-Norm(final)=11.877 | 4786.2 samples/s | 74.8 steps/s
[Step=16900 Epoch=33.0] | Loss=0.04506 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.932 | L2-Norm(final)=11.867 | 4801.4 samples/s | 75.0 steps/s
[Step=16950 Epoch=33.1] | Loss=0.04426 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.977 | L2-Norm(final)=11.859 | 4790.3 samples/s | 74.8 steps/s
[Step=17000 Epoch=33.2] | Loss=0.04383 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.018 | L2-Norm(final)=11.851 | 5781.1 samples/s | 90.3 steps/s
[Step=17050 Epoch=33.3] | Loss=0.04224 | Reg=0.00227 | acc=0.9531 | L2-Norm=15.056 | L2-Norm(final)=11.845 | 1960.9 samples/s | 30.6 steps/s
[Step=17100 Epoch=33.4] | Loss=0.04086 | Reg=0.00228 | acc=0.9688 | L2-Norm=15.092 | L2-Norm(final)=11.839 | 4898.0 samples/s | 76.5 steps/s
[Step=17150 Epoch=33.4] | Loss=0.04025 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.127 | L2-Norm(final)=11.833 | 4886.5 samples/s | 76.4 steps/s
[Step=17200 Epoch=33.5] | Loss=0.03976 | Reg=0.00230 | acc=0.9531 | L2-Norm=15.160 | L2-Norm(final)=11.827 | 4967.6 samples/s | 77.6 steps/s
[Step=17250 Epoch=33.6] | Loss=0.03914 | Reg=0.00231 | acc=0.9531 | L2-Norm=15.190 | L2-Norm(final)=11.821 | 4759.7 samples/s | 74.4 steps/s
[Step=17300 Epoch=33.7] | Loss=0.03878 | Reg=0.00232 | acc=0.9688 | L2-Norm=15.219 | L2-Norm(final)=11.815 | 4776.9 samples/s | 74.6 steps/s
[Step=17350 Epoch=33.8] | Loss=0.03787 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.246 | L2-Norm(final)=11.810 | 4786.0 samples/s | 74.8 steps/s
[Step=17400 Epoch=33.9] | Loss=0.03730 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.273 | L2-Norm(final)=11.805 | 4793.3 samples/s | 74.9 steps/s
[Step=17450 Epoch=34.0] | Loss=0.03672 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.298 | L2-Norm(final)=11.801 | 4792.1 samples/s | 74.9 steps/s
[Step=17500 Epoch=34.1] | Loss=0.03610 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.323 | L2-Norm(final)=11.797 | 5051.1 samples/s | 78.9 steps/s
[Step=17550 Epoch=34.2] | Loss=0.03552 | Reg=0.00236 | acc=0.9688 | L2-Norm=15.347 | L2-Norm(final)=11.793 | 2096.4 samples/s | 32.8 steps/s
[Step=17600 Epoch=34.3] | Loss=0.03466 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.370 | L2-Norm(final)=11.789 | 4893.7 samples/s | 76.5 steps/s
[Step=17650 Epoch=34.4] | Loss=0.03382 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.392 | L2-Norm(final)=11.786 | 4902.9 samples/s | 76.6 steps/s
[Step=17700 Epoch=34.5] | Loss=0.03325 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.413 | L2-Norm(final)=11.783 | 4890.0 samples/s | 76.4 steps/s
[Step=17750 Epoch=34.6] | Loss=0.03287 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.434 | L2-Norm(final)=11.780 | 4917.6 samples/s | 76.8 steps/s
[Step=17800 Epoch=34.7] | Loss=0.03239 | Reg=0.00239 | acc=0.9531 | L2-Norm=15.454 | L2-Norm(final)=11.778 | 4894.4 samples/s | 76.5 steps/s
[Step=17850 Epoch=34.8] | Loss=0.03221 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.475 | L2-Norm(final)=11.775 | 4930.5 samples/s | 77.0 steps/s
[Step=17900 Epoch=34.9] | Loss=0.03206 | Reg=0.00240 | acc=0.9531 | L2-Norm=15.497 | L2-Norm(final)=11.772 | 4902.8 samples/s | 76.6 steps/s
[Step=17950 Epoch=35.0] | Loss=0.03186 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.519 | L2-Norm(final)=11.768 | 4912.9 samples/s | 76.8 steps/s
[Step=18000 Epoch=35.1] | Loss=0.03185 | Reg=0.00242 | acc=0.9531 | L2-Norm=15.541 | L2-Norm(final)=11.765 | 4897.9 samples/s | 76.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step18000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=16001 Epoch=31.3] | Loss=0.09830 | Reg=0.00195 | acc=0.8906 | L2-Norm=13.968 | L2-Norm(final)=10.993 | 4480.2 samples/s | 70.0 steps/s
[Step=16050 Epoch=31.4] | Loss=0.13574 | Reg=0.00195 | acc=0.9375 | L2-Norm=13.978 | L2-Norm(final)=11.064 | 5080.8 samples/s | 79.4 steps/s
[Step=16100 Epoch=31.5] | Loss=0.11401 | Reg=0.00195 | acc=0.8906 | L2-Norm=13.980 | L2-Norm(final)=11.146 | 5478.8 samples/s | 85.6 steps/s
[Step=16150 Epoch=31.6] | Loss=0.10584 | Reg=0.00195 | acc=0.9219 | L2-Norm=13.980 | L2-Norm(final)=11.213 | 5519.5 samples/s | 86.2 steps/s
[Step=16200 Epoch=31.7] | Loss=0.10076 | Reg=0.00195 | acc=0.8906 | L2-Norm=13.981 | L2-Norm(final)=11.272 | 5586.2 samples/s | 87.3 steps/s
[Step=16250 Epoch=31.8] | Loss=0.09824 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.981 | L2-Norm(final)=11.327 | 5389.0 samples/s | 84.2 steps/s
[Step=16300 Epoch=31.9] | Loss=0.09692 | Reg=0.00195 | acc=0.9531 | L2-Norm=13.981 | L2-Norm(final)=11.376 | 5553.0 samples/s | 86.8 steps/s
[Step=16350 Epoch=32.0] | Loss=0.09551 | Reg=0.00195 | acc=0.9375 | L2-Norm=13.981 | L2-Norm(final)=11.422 | 5520.5 samples/s | 86.3 steps/s
[Step=16400 Epoch=32.1] | Loss=0.09432 | Reg=0.00195 | acc=0.8750 | L2-Norm=13.981 | L2-Norm(final)=11.467 | 5538.6 samples/s | 86.5 steps/s
[Step=16450 Epoch=32.2] | Loss=0.09339 | Reg=0.00195 | acc=0.9531 | L2-Norm=13.981 | L2-Norm(final)=11.510 | 5519.2 samples/s | 86.2 steps/s
[Step=16500 Epoch=32.3] | Loss=0.09213 | Reg=0.00195 | acc=0.9219 | L2-Norm=13.981 | L2-Norm(final)=11.552 | 7159.7 samples/s | 111.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=16501 Epoch=32.3] | Loss=0.08234 | Reg=0.00195 | acc=0.9375 | L2-Norm=13.982 | L2-Norm(final)=11.964 | 4390.5 samples/s | 68.6 steps/s
[Step=16550 Epoch=32.4] | Loss=0.05990 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.263 | L2-Norm(final)=11.963 | 4632.9 samples/s | 72.4 steps/s
[Step=16600 Epoch=32.5] | Loss=0.05138 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.466 | L2-Norm(final)=11.950 | 4846.5 samples/s | 75.7 steps/s
[Step=16650 Epoch=32.6] | Loss=0.04886 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.598 | L2-Norm(final)=11.936 | 4837.5 samples/s | 75.6 steps/s
[Step=16700 Epoch=32.6] | Loss=0.04777 | Reg=0.00216 | acc=0.9219 | L2-Norm=14.703 | L2-Norm(final)=11.924 | 4801.5 samples/s | 75.0 steps/s
[Step=16750 Epoch=32.7] | Loss=0.04846 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.796 | L2-Norm(final)=11.913 | 4813.0 samples/s | 75.2 steps/s
[Step=16800 Epoch=32.8] | Loss=0.04854 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.881 | L2-Norm(final)=11.897 | 4851.1 samples/s | 75.8 steps/s
[Step=16850 Epoch=32.9] | Loss=0.04786 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.956 | L2-Norm(final)=11.884 | 4861.1 samples/s | 76.0 steps/s
[Step=16900 Epoch=33.0] | Loss=0.04608 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.023 | L2-Norm(final)=11.874 | 4858.0 samples/s | 75.9 steps/s
[Step=16950 Epoch=33.1] | Loss=0.04537 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.081 | L2-Norm(final)=11.865 | 4822.5 samples/s | 75.4 steps/s
[Step=17000 Epoch=33.2] | Loss=0.04415 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.134 | L2-Norm(final)=11.856 | 5900.1 samples/s | 92.2 steps/s
[Step=17050 Epoch=33.3] | Loss=0.04260 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.183 | L2-Norm(final)=11.848 | 2015.3 samples/s | 31.5 steps/s
[Step=17100 Epoch=33.4] | Loss=0.04121 | Reg=0.00232 | acc=0.9688 | L2-Norm=15.227 | L2-Norm(final)=11.842 | 4745.2 samples/s | 74.1 steps/s
[Step=17150 Epoch=33.5] | Loss=0.04019 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.268 | L2-Norm(final)=11.835 | 4747.5 samples/s | 74.2 steps/s
[Step=17200 Epoch=33.6] | Loss=0.03947 | Reg=0.00235 | acc=0.9688 | L2-Norm=15.307 | L2-Norm(final)=11.830 | 4792.0 samples/s | 74.9 steps/s
[Step=17250 Epoch=33.7] | Loss=0.03850 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.345 | L2-Norm(final)=11.824 | 4883.3 samples/s | 76.3 steps/s
[Step=17300 Epoch=33.8] | Loss=0.03784 | Reg=0.00237 | acc=0.9531 | L2-Norm=15.382 | L2-Norm(final)=11.819 | 4780.3 samples/s | 74.7 steps/s
[Step=17350 Epoch=33.9] | Loss=0.03723 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.417 | L2-Norm(final)=11.815 | 4855.3 samples/s | 75.9 steps/s
[Step=17400 Epoch=34.0] | Loss=0.03674 | Reg=0.00239 | acc=0.9688 | L2-Norm=15.450 | L2-Norm(final)=11.810 | 4822.7 samples/s | 75.4 steps/s
[Step=17450 Epoch=34.1] | Loss=0.03633 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.482 | L2-Norm(final)=11.806 | 4838.2 samples/s | 75.6 steps/s
[Step=17500 Epoch=34.2] | Loss=0.03600 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.513 | L2-Norm(final)=11.802 | 5243.8 samples/s | 81.9 steps/s
[Step=17550 Epoch=34.3] | Loss=0.03554 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.543 | L2-Norm(final)=11.797 | 2148.1 samples/s | 33.6 steps/s
[Step=17600 Epoch=34.4] | Loss=0.03487 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.572 | L2-Norm(final)=11.793 | 4701.4 samples/s | 73.5 steps/s
[Step=17650 Epoch=34.5] | Loss=0.03417 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.599 | L2-Norm(final)=11.790 | 4755.7 samples/s | 74.3 steps/s
[Step=17700 Epoch=34.6] | Loss=0.03369 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.626 | L2-Norm(final)=11.786 | 4792.5 samples/s | 74.9 steps/s
[Step=17750 Epoch=34.7] | Loss=0.03326 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.652 | L2-Norm(final)=11.783 | 4807.9 samples/s | 75.1 steps/s
[Step=17800 Epoch=34.8] | Loss=0.03288 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.678 | L2-Norm(final)=11.780 | 4853.8 samples/s | 75.8 steps/s
[Step=17850 Epoch=34.9] | Loss=0.03249 | Reg=0.00247 | acc=0.9688 | L2-Norm=15.702 | L2-Norm(final)=11.777 | 4839.9 samples/s | 75.6 steps/s
[Step=17900 Epoch=35.0] | Loss=0.03229 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.727 | L2-Norm(final)=11.773 | 4732.0 samples/s | 73.9 steps/s
[Step=17950 Epoch=35.1] | Loss=0.03198 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.752 | L2-Norm(final)=11.770 | 4724.4 samples/s | 73.8 steps/s
[Step=18000 Epoch=35.2] | Loss=0.03168 | Reg=0.00249 | acc=0.9531 | L2-Norm=15.775 | L2-Norm(final)=11.766 | 4834.8 samples/s | 75.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step18000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=16001 Epoch=61.3] | Loss=0.00039 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.968 | L2-Norm(final)=13.037 | 4519.7 samples/s | 70.6 steps/s
[Step=16050 Epoch=61.5] | Loss=0.00354 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.962 | L2-Norm(final)=13.072 | 4582.9 samples/s | 71.6 steps/s
[Step=16100 Epoch=61.7] | Loss=0.00427 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=13.119 | 5350.1 samples/s | 83.6 steps/s
[Step=16150 Epoch=61.9] | Loss=0.00397 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=13.169 | 5218.6 samples/s | 81.5 steps/s
[Step=16200 Epoch=62.1] | Loss=0.00379 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=13.220 | 5130.4 samples/s | 80.2 steps/s
[Step=16250 Epoch=62.3] | Loss=0.00363 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=13.272 | 6812.7 samples/s | 106.4 steps/s
[Step=16300 Epoch=62.5] | Loss=0.00350 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.960 | L2-Norm(final)=13.322 | 2036.9 samples/s | 31.8 steps/s
[Step=16350 Epoch=62.6] | Loss=0.00358 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.960 | L2-Norm(final)=13.371 | 5140.9 samples/s | 80.3 steps/s
[Step=16400 Epoch=62.8] | Loss=0.00350 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.960 | L2-Norm(final)=13.418 | 5164.7 samples/s | 80.7 steps/s
[Step=16450 Epoch=63.0] | Loss=0.00347 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.960 | L2-Norm(final)=13.467 | 5234.3 samples/s | 81.8 steps/s
[Step=16500 Epoch=63.2] | Loss=0.00346 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.960 | L2-Norm(final)=13.516 | 5724.3 samples/s | 89.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=16501 Epoch=63.2] | Loss=0.00053 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.960 | L2-Norm(final)=14.013 | 4363.6 samples/s | 68.2 steps/s
[Step=16550 Epoch=63.4] | Loss=0.00438 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.067 | L2-Norm(final)=14.041 | 4227.2 samples/s | 66.0 steps/s
[Step=16600 Epoch=63.6] | Loss=0.01586 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.351 | L2-Norm(final)=14.005 | 4514.5 samples/s | 70.5 steps/s
[Step=16650 Epoch=63.8] | Loss=0.01592 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.630 | L2-Norm(final)=13.921 | 4602.2 samples/s | 71.9 steps/s
[Step=16700 Epoch=64.0] | Loss=0.01402 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.805 | L2-Norm(final)=13.866 | 4477.7 samples/s | 70.0 steps/s
[Step=16750 Epoch=64.2] | Loss=0.01209 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.923 | L2-Norm(final)=13.831 | 5735.4 samples/s | 89.6 steps/s
[Step=16800 Epoch=64.4] | Loss=0.01023 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.003 | L2-Norm(final)=13.810 | 1950.8 samples/s | 30.5 steps/s
[Step=16850 Epoch=64.6] | Loss=0.00878 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.054 | L2-Norm(final)=13.797 | 4579.0 samples/s | 71.5 steps/s
[Step=16900 Epoch=64.8] | Loss=0.00769 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.085 | L2-Norm(final)=13.787 | 4626.7 samples/s | 72.3 steps/s
[Step=16950 Epoch=64.9] | Loss=0.00684 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.103 | L2-Norm(final)=13.780 | 4504.8 samples/s | 70.4 steps/s
[Step=17000 Epoch=65.1] | Loss=0.00616 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.112 | L2-Norm(final)=13.774 | 5054.9 samples/s | 79.0 steps/s
[Step=17050 Epoch=65.3] | Loss=0.00562 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.116 | L2-Norm(final)=13.770 | 2031.3 samples/s | 31.7 steps/s
[Step=17100 Epoch=65.5] | Loss=0.00515 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.115 | L2-Norm(final)=13.767 | 4551.1 samples/s | 71.1 steps/s
[Step=17150 Epoch=65.7] | Loss=0.00475 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.110 | L2-Norm(final)=13.764 | 4529.7 samples/s | 70.8 steps/s
[Step=17200 Epoch=65.9] | Loss=0.00442 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.102 | L2-Norm(final)=13.762 | 4604.6 samples/s | 71.9 steps/s
[Step=17250 Epoch=66.1] | Loss=0.00412 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.093 | L2-Norm(final)=13.760 | 4452.0 samples/s | 69.6 steps/s
[Step=17300 Epoch=66.3] | Loss=0.00386 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.081 | L2-Norm(final)=13.759 | 2097.4 samples/s | 32.8 steps/s
[Step=17350 Epoch=66.5] | Loss=0.00364 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.068 | L2-Norm(final)=13.758 | 4632.8 samples/s | 72.4 steps/s
[Step=17400 Epoch=66.7] | Loss=0.00344 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.054 | L2-Norm(final)=13.756 | 4469.4 samples/s | 69.8 steps/s
[Step=17450 Epoch=66.9] | Loss=0.00325 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.039 | L2-Norm(final)=13.755 | 4538.3 samples/s | 70.9 steps/s
[Step=17500 Epoch=67.1] | Loss=0.00309 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.024 | L2-Norm(final)=13.754 | 4477.5 samples/s | 70.0 steps/s
[Step=17550 Epoch=67.2] | Loss=0.00295 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.008 | L2-Norm(final)=13.754 | 2136.0 samples/s | 33.4 steps/s
[Step=17600 Epoch=67.4] | Loss=0.00281 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.991 | L2-Norm(final)=13.753 | 4530.1 samples/s | 70.8 steps/s
[Step=17650 Epoch=67.6] | Loss=0.00269 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.973 | L2-Norm(final)=13.753 | 4546.8 samples/s | 71.0 steps/s
[Step=17700 Epoch=67.8] | Loss=0.00258 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.956 | L2-Norm(final)=13.752 | 4514.3 samples/s | 70.5 steps/s
[Step=17750 Epoch=68.0] | Loss=0.00247 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.938 | L2-Norm(final)=13.752 | 4571.1 samples/s | 71.4 steps/s
[Step=17800 Epoch=68.2] | Loss=0.00238 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.920 | L2-Norm(final)=13.752 | 6172.6 samples/s | 96.4 steps/s
[Step=17850 Epoch=68.4] | Loss=0.00229 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.901 | L2-Norm(final)=13.752 | 1878.2 samples/s | 29.3 steps/s
[Step=17900 Epoch=68.6] | Loss=0.00221 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.882 | L2-Norm(final)=13.751 | 4602.4 samples/s | 71.9 steps/s
[Step=17950 Epoch=68.8] | Loss=0.00213 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.864 | L2-Norm(final)=13.751 | 4654.2 samples/s | 72.7 steps/s
[Step=18000 Epoch=69.0] | Loss=0.00206 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.845 | L2-Norm(final)=13.751 | 4631.7 samples/s | 72.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step18000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=16001 Epoch=61.6] | Loss=0.01454 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.968 | L2-Norm(final)=12.411 | 4747.9 samples/s | 74.2 steps/s
[Step=16050 Epoch=61.8] | Loss=0.00482 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.962 | L2-Norm(final)=12.449 | 4733.8 samples/s | 74.0 steps/s
[Step=16100 Epoch=62.0] | Loss=0.00452 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.962 | L2-Norm(final)=12.498 | 5150.2 samples/s | 80.5 steps/s
[Step=16150 Epoch=62.2] | Loss=0.00501 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=12.544 | 5327.6 samples/s | 83.2 steps/s
[Step=16200 Epoch=62.4] | Loss=0.00496 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=12.587 | 5224.1 samples/s | 81.6 steps/s
[Step=16250 Epoch=62.6] | Loss=0.00490 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=12.631 | 7190.6 samples/s | 112.4 steps/s
[Step=16300 Epoch=62.7] | Loss=0.00488 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=12.674 | 2073.8 samples/s | 32.4 steps/s
[Step=16350 Epoch=62.9] | Loss=0.00481 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=12.717 | 5212.9 samples/s | 81.5 steps/s
[Step=16400 Epoch=63.1] | Loss=0.00471 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=12.762 | 5101.5 samples/s | 79.7 steps/s
[Step=16450 Epoch=63.3] | Loss=0.00468 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=12.805 | 5222.9 samples/s | 81.6 steps/s
[Step=16500 Epoch=63.5] | Loss=0.00463 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=12.849 | 5840.0 samples/s | 91.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=16501 Epoch=63.5] | Loss=0.00213 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=13.277 | 4348.1 samples/s | 67.9 steps/s
[Step=16550 Epoch=63.7] | Loss=0.00301 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.021 | L2-Norm(final)=13.307 | 4251.0 samples/s | 66.4 steps/s
[Step=16600 Epoch=63.9] | Loss=0.01261 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.255 | L2-Norm(final)=13.268 | 4559.9 samples/s | 71.2 steps/s
[Step=16650 Epoch=64.1] | Loss=0.01133 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.506 | L2-Norm(final)=13.227 | 4550.6 samples/s | 71.1 steps/s
[Step=16700 Epoch=64.3] | Loss=0.01030 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.656 | L2-Norm(final)=13.196 | 4416.2 samples/s | 69.0 steps/s
[Step=16750 Epoch=64.5] | Loss=0.00842 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.744 | L2-Norm(final)=13.178 | 5841.3 samples/s | 91.3 steps/s
[Step=16800 Epoch=64.7] | Loss=0.00794 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.801 | L2-Norm(final)=13.164 | 1971.6 samples/s | 30.8 steps/s
[Step=16850 Epoch=64.9] | Loss=0.00715 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.845 | L2-Norm(final)=13.152 | 4594.6 samples/s | 71.8 steps/s
[Step=16900 Epoch=65.1] | Loss=0.00659 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.878 | L2-Norm(final)=13.142 | 4681.3 samples/s | 73.1 steps/s
[Step=16950 Epoch=65.2] | Loss=0.00628 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.905 | L2-Norm(final)=13.133 | 4711.7 samples/s | 73.6 steps/s
[Step=17000 Epoch=65.4] | Loss=0.00571 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.928 | L2-Norm(final)=13.125 | 5231.1 samples/s | 81.7 steps/s
[Step=17050 Epoch=65.6] | Loss=0.00522 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.942 | L2-Norm(final)=13.120 | 2006.5 samples/s | 31.4 steps/s
[Step=17100 Epoch=65.8] | Loss=0.00479 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.951 | L2-Norm(final)=13.115 | 4541.1 samples/s | 71.0 steps/s
[Step=17150 Epoch=66.0] | Loss=0.00442 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.954 | L2-Norm(final)=13.112 | 4584.5 samples/s | 71.6 steps/s
[Step=17200 Epoch=66.2] | Loss=0.00411 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.953 | L2-Norm(final)=13.109 | 4479.4 samples/s | 70.0 steps/s
[Step=17250 Epoch=66.4] | Loss=0.00384 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.950 | L2-Norm(final)=13.106 | 4634.1 samples/s | 72.4 steps/s
[Step=17300 Epoch=66.6] | Loss=0.00360 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.944 | L2-Norm(final)=13.104 | 2110.5 samples/s | 33.0 steps/s
[Step=17350 Epoch=66.8] | Loss=0.00339 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.936 | L2-Norm(final)=13.103 | 4569.4 samples/s | 71.4 steps/s
[Step=17400 Epoch=67.0] | Loss=0.00320 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.927 | L2-Norm(final)=13.101 | 4617.4 samples/s | 72.1 steps/s
[Step=17450 Epoch=67.2] | Loss=0.00303 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.917 | L2-Norm(final)=13.100 | 4467.5 samples/s | 69.8 steps/s
[Step=17500 Epoch=67.4] | Loss=0.00288 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.905 | L2-Norm(final)=13.099 | 4566.9 samples/s | 71.4 steps/s
[Step=17550 Epoch=67.6] | Loss=0.00275 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.893 | L2-Norm(final)=13.099 | 2113.7 samples/s | 33.0 steps/s
[Step=17600 Epoch=67.7] | Loss=0.00262 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.879 | L2-Norm(final)=13.098 | 4544.6 samples/s | 71.0 steps/s
[Step=17650 Epoch=67.9] | Loss=0.00251 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.866 | L2-Norm(final)=13.098 | 4477.1 samples/s | 70.0 steps/s
[Step=17700 Epoch=68.1] | Loss=0.00240 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.851 | L2-Norm(final)=13.097 | 4527.1 samples/s | 70.7 steps/s
[Step=17750 Epoch=68.3] | Loss=0.00231 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.836 | L2-Norm(final)=13.097 | 4512.3 samples/s | 70.5 steps/s
[Step=17800 Epoch=68.5] | Loss=0.00222 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.821 | L2-Norm(final)=13.097 | 6546.1 samples/s | 102.3 steps/s
[Step=17850 Epoch=68.7] | Loss=0.00214 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.805 | L2-Norm(final)=13.097 | 1855.8 samples/s | 29.0 steps/s
[Step=17900 Epoch=68.9] | Loss=0.00206 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.789 | L2-Norm(final)=13.096 | 4595.9 samples/s | 71.8 steps/s
[Step=17950 Epoch=69.1] | Loss=0.00199 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.773 | L2-Norm(final)=13.096 | 4460.0 samples/s | 69.7 steps/s
[Step=18000 Epoch=69.3] | Loss=0.00192 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.757 | L2-Norm(final)=13.096 | 4460.8 samples/s | 69.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step18000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07001 | acc=0.9578 | tpr=0.9553 | fpr=0.0367 | 4403.0 samples/s | 17.2 steps/s
Avg test loss: 0.06885, Avg test acc: 0.95737, Avg tpr: 0.95518, Avg fpr: 0.03782, total FA: 295

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06549 | acc=0.9611 | tpr=0.9634 | fpr=0.0439 | 4470.2 samples/s | 17.5 steps/s
Avg test loss: 0.06604, Avg test acc: 0.96158, Avg tpr: 0.96316, Avg fpr: 0.04192, total FA: 327

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=8.57101 | acc=0.3127 | tpr=0.0048 | fpr=0.0186 | 4571.3 samples/s | 17.9 steps/s
Avg test loss: 8.58754, Avg test acc: 0.31120, Avg tpr: 0.00519, Avg fpr: 0.01577, total FA: 123

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.49463 | acc=0.3134 | tpr=0.0056 | fpr=0.0183 | 4463.3 samples/s | 17.4 steps/s
Avg test loss: 6.52064, Avg test acc: 0.31040, Avg tpr: 0.00571, Avg fpr: 0.01948, total FA: 152

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.47784 | acc=0.1368 | tpr=0.7124 | fpr=0.8735 | 4424.7 samples/s | 17.3 steps/s
[Step= 100] | Loss=4.44106 | acc=0.1398 | tpr=0.7505 | fpr=0.8716 | 8447.0 samples/s | 33.0 steps/s
[Step= 150] | Loss=4.45033 | acc=0.1396 | tpr=0.7406 | fpr=0.8714 | 8691.2 samples/s | 34.0 steps/s
[Step= 200] | Loss=4.45143 | acc=0.1398 | tpr=0.7432 | fpr=0.8712 | 8974.2 samples/s | 35.1 steps/s
[Step= 250] | Loss=4.45753 | acc=0.1395 | tpr=0.7493 | fpr=0.8716 | 7876.3 samples/s | 30.8 steps/s
[Step= 300] | Loss=4.45216 | acc=0.1389 | tpr=0.7476 | fpr=0.8722 | 9080.9 samples/s | 35.5 steps/s
[Step= 350] | Loss=4.45426 | acc=0.1384 | tpr=0.7464 | fpr=0.8726 | 8082.7 samples/s | 31.6 steps/s
[Step= 400] | Loss=4.45617 | acc=0.1386 | tpr=0.7445 | fpr=0.8724 | 8856.4 samples/s | 34.6 steps/s
[Step= 450] | Loss=4.46074 | acc=0.1385 | tpr=0.7473 | fpr=0.8726 | 8677.7 samples/s | 33.9 steps/s
[Step= 500] | Loss=4.45907 | acc=0.1383 | tpr=0.7489 | fpr=0.8728 | 8345.7 samples/s | 32.6 steps/s
[Step= 550] | Loss=4.46281 | acc=0.1379 | tpr=0.7481 | fpr=0.8732 | 15496.4 samples/s | 60.5 steps/s
Avg test loss: 4.46448, Avg test acc: 0.13785, Avg tpr: 0.74762, Avg fpr: 0.87324, total FA: 121247

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.69523 | acc=0.1320 | tpr=0.7301 | fpr=0.8787 | 4462.5 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.65096 | acc=0.1327 | tpr=0.7271 | fpr=0.8784 | 8361.9 samples/s | 32.7 steps/s
[Step= 150] | Loss=5.64257 | acc=0.1323 | tpr=0.7133 | fpr=0.8784 | 8518.1 samples/s | 33.3 steps/s
[Step= 200] | Loss=5.63306 | acc=0.1320 | tpr=0.7060 | fpr=0.8785 | 8628.0 samples/s | 33.7 steps/s
[Step= 250] | Loss=5.64409 | acc=0.1308 | tpr=0.7100 | fpr=0.8797 | 8277.4 samples/s | 32.3 steps/s
[Step= 300] | Loss=5.64085 | acc=0.1301 | tpr=0.7076 | fpr=0.8804 | 8712.8 samples/s | 34.0 steps/s
[Step= 350] | Loss=5.63478 | acc=0.1296 | tpr=0.7088 | fpr=0.8809 | 8762.5 samples/s | 34.2 steps/s
[Step= 400] | Loss=5.63613 | acc=0.1299 | tpr=0.7084 | fpr=0.8807 | 8149.0 samples/s | 31.8 steps/s
[Step= 450] | Loss=5.63914 | acc=0.1300 | tpr=0.7108 | fpr=0.8805 | 8820.5 samples/s | 34.5 steps/s
[Step= 500] | Loss=5.63793 | acc=0.1299 | tpr=0.7110 | fpr=0.8806 | 8182.2 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.64170 | acc=0.1298 | tpr=0.7119 | fpr=0.8808 | 16292.1 samples/s | 63.6 steps/s
Avg test loss: 5.64290, Avg test acc: 0.12971, Avg tpr: 0.71197, Avg fpr: 0.88088, total FA: 122308

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.15633 | acc=0.9804 | tpr=0.9336 | fpr=0.0188 | 4430.4 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.16399 | acc=0.9800 | tpr=0.9510 | fpr=0.0195 | 8238.7 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.17372 | acc=0.9792 | tpr=0.9452 | fpr=0.0202 | 8749.7 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.17585 | acc=0.9792 | tpr=0.9497 | fpr=0.0203 | 8189.5 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.17301 | acc=0.9793 | tpr=0.9432 | fpr=0.0201 | 8426.4 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.17508 | acc=0.9790 | tpr=0.9455 | fpr=0.0204 | 8510.5 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.17646 | acc=0.9787 | tpr=0.9468 | fpr=0.0207 | 8738.2 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.17811 | acc=0.9786 | tpr=0.9458 | fpr=0.0209 | 8004.5 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.18136 | acc=0.9782 | tpr=0.9430 | fpr=0.0212 | 8231.7 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.18029 | acc=0.9782 | tpr=0.9436 | fpr=0.0212 | 8274.4 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.17839 | acc=0.9784 | tpr=0.9415 | fpr=0.0209 | 15950.4 samples/s | 62.3 steps/s
Avg test loss: 0.17789, Avg test acc: 0.97843, Avg tpr: 0.94176, Avg fpr: 0.02090, total FA: 2902

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15194 | acc=0.9827 | tpr=0.9336 | fpr=0.0164 | 4417.2 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.15776 | acc=0.9825 | tpr=0.9552 | fpr=0.0170 | 8422.4 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.16773 | acc=0.9814 | tpr=0.9597 | fpr=0.0182 | 8589.5 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.16937 | acc=0.9811 | tpr=0.9607 | fpr=0.0186 | 8285.6 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.16657 | acc=0.9812 | tpr=0.9598 | fpr=0.0184 | 8686.0 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.16835 | acc=0.9811 | tpr=0.9607 | fpr=0.0185 | 8321.5 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.17100 | acc=0.9808 | tpr=0.9612 | fpr=0.0189 | 8398.1 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.17287 | acc=0.9805 | tpr=0.9568 | fpr=0.0190 | 8256.4 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.17601 | acc=0.9802 | tpr=0.9552 | fpr=0.0193 | 8505.9 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.17584 | acc=0.9803 | tpr=0.9542 | fpr=0.0192 | 8542.9 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.17455 | acc=0.9805 | tpr=0.9534 | fpr=0.0190 | 15490.7 samples/s | 60.5 steps/s
Avg test loss: 0.17415, Avg test acc: 0.98049, Avg tpr: 0.95365, Avg fpr: 0.01902, total FA: 2641

server round 9/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=18001 Epoch=35.1] | Loss=0.06036 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.128 | L2-Norm(final)=11.667 | 4023.6 samples/s | 62.9 steps/s
[Step=18050 Epoch=35.2] | Loss=0.08723 | Reg=0.00200 | acc=0.9375 | L2-Norm=14.137 | L2-Norm(final)=11.728 | 5324.9 samples/s | 83.2 steps/s
[Step=18100 Epoch=35.3] | Loss=0.08422 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.138 | L2-Norm(final)=11.793 | 5472.1 samples/s | 85.5 steps/s
[Step=18150 Epoch=35.4] | Loss=0.08281 | Reg=0.00200 | acc=0.9219 | L2-Norm=14.139 | L2-Norm(final)=11.841 | 5463.3 samples/s | 85.4 steps/s
[Step=18200 Epoch=35.5] | Loss=0.08133 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.139 | L2-Norm(final)=11.887 | 5475.3 samples/s | 85.6 steps/s
[Step=18250 Epoch=35.6] | Loss=0.07923 | Reg=0.00200 | acc=0.9219 | L2-Norm=14.139 | L2-Norm(final)=11.932 | 5522.3 samples/s | 86.3 steps/s
[Step=18300 Epoch=35.7] | Loss=0.07938 | Reg=0.00200 | acc=0.9219 | L2-Norm=14.139 | L2-Norm(final)=11.973 | 5536.7 samples/s | 86.5 steps/s
[Step=18350 Epoch=35.8] | Loss=0.07877 | Reg=0.00200 | acc=0.9531 | L2-Norm=14.139 | L2-Norm(final)=12.010 | 5369.6 samples/s | 83.9 steps/s
[Step=18400 Epoch=35.9] | Loss=0.07867 | Reg=0.00200 | acc=0.8906 | L2-Norm=14.140 | L2-Norm(final)=12.046 | 5482.9 samples/s | 85.7 steps/s
[Step=18450 Epoch=36.0] | Loss=0.07813 | Reg=0.00200 | acc=0.9375 | L2-Norm=14.140 | L2-Norm(final)=12.081 | 5560.1 samples/s | 86.9 steps/s
[Step=18500 Epoch=36.1] | Loss=0.07772 | Reg=0.00200 | acc=0.8750 | L2-Norm=14.140 | L2-Norm(final)=12.117 | 6832.2 samples/s | 106.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=18501 Epoch=36.1] | Loss=0.06621 | Reg=0.00200 | acc=0.9375 | L2-Norm=14.140 | L2-Norm(final)=12.480 | 4286.0 samples/s | 67.0 steps/s
[Step=18550 Epoch=36.2] | Loss=0.05123 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.384 | L2-Norm(final)=12.478 | 4624.2 samples/s | 72.3 steps/s
[Step=18600 Epoch=36.3] | Loss=0.04608 | Reg=0.00212 | acc=0.9531 | L2-Norm=14.568 | L2-Norm(final)=12.459 | 4890.7 samples/s | 76.4 steps/s
[Step=18650 Epoch=36.4] | Loss=0.04626 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.698 | L2-Norm(final)=12.447 | 4870.0 samples/s | 76.1 steps/s
[Step=18700 Epoch=36.5] | Loss=0.04588 | Reg=0.00219 | acc=0.9375 | L2-Norm=14.795 | L2-Norm(final)=12.435 | 4744.5 samples/s | 74.1 steps/s
[Step=18750 Epoch=36.6] | Loss=0.04534 | Reg=0.00221 | acc=0.9375 | L2-Norm=14.877 | L2-Norm(final)=12.422 | 4771.9 samples/s | 74.6 steps/s
[Step=18800 Epoch=36.7] | Loss=0.04491 | Reg=0.00224 | acc=0.9375 | L2-Norm=14.949 | L2-Norm(final)=12.408 | 4738.4 samples/s | 74.0 steps/s
[Step=18850 Epoch=36.8] | Loss=0.04364 | Reg=0.00225 | acc=0.9688 | L2-Norm=15.011 | L2-Norm(final)=12.396 | 4862.1 samples/s | 76.0 steps/s
[Step=18900 Epoch=36.9] | Loss=0.04341 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.066 | L2-Norm(final)=12.386 | 4860.8 samples/s | 76.0 steps/s
[Step=18950 Epoch=37.0] | Loss=0.04256 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.114 | L2-Norm(final)=12.376 | 4833.2 samples/s | 75.5 steps/s
[Step=19000 Epoch=37.1] | Loss=0.04204 | Reg=0.00230 | acc=0.9219 | L2-Norm=15.157 | L2-Norm(final)=12.367 | 5744.2 samples/s | 89.8 steps/s
[Step=19050 Epoch=37.2] | Loss=0.04061 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.197 | L2-Norm(final)=12.360 | 1953.5 samples/s | 30.5 steps/s
[Step=19100 Epoch=37.3] | Loss=0.03971 | Reg=0.00232 | acc=0.9688 | L2-Norm=15.235 | L2-Norm(final)=12.354 | 4725.8 samples/s | 73.8 steps/s
[Step=19150 Epoch=37.3] | Loss=0.03833 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.270 | L2-Norm(final)=12.347 | 4773.6 samples/s | 74.6 steps/s
[Step=19200 Epoch=37.4] | Loss=0.03717 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.301 | L2-Norm(final)=12.342 | 4748.9 samples/s | 74.2 steps/s
[Step=19250 Epoch=37.5] | Loss=0.03653 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.330 | L2-Norm(final)=12.337 | 4864.3 samples/s | 76.0 steps/s
[Step=19300 Epoch=37.6] | Loss=0.03569 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.360 | L2-Norm(final)=12.332 | 4869.6 samples/s | 76.1 steps/s
[Step=19350 Epoch=37.7] | Loss=0.03517 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.390 | L2-Norm(final)=12.326 | 4945.9 samples/s | 77.3 steps/s
[Step=19400 Epoch=37.8] | Loss=0.03458 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.418 | L2-Norm(final)=12.321 | 4937.8 samples/s | 77.2 steps/s
[Step=19450 Epoch=37.9] | Loss=0.03420 | Reg=0.00239 | acc=0.9688 | L2-Norm=15.446 | L2-Norm(final)=12.316 | 4873.5 samples/s | 76.1 steps/s
[Step=19500 Epoch=38.0] | Loss=0.03384 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.472 | L2-Norm(final)=12.311 | 4982.7 samples/s | 77.9 steps/s
[Step=19550 Epoch=38.1] | Loss=0.03338 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.498 | L2-Norm(final)=12.307 | 2035.3 samples/s | 31.8 steps/s
[Step=19600 Epoch=38.2] | Loss=0.03280 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.524 | L2-Norm(final)=12.302 | 4789.6 samples/s | 74.8 steps/s
[Step=19650 Epoch=38.3] | Loss=0.03234 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.548 | L2-Norm(final)=12.298 | 4845.2 samples/s | 75.7 steps/s
[Step=19700 Epoch=38.4] | Loss=0.03186 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.571 | L2-Norm(final)=12.294 | 4836.2 samples/s | 75.6 steps/s
[Step=19750 Epoch=38.5] | Loss=0.03150 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.594 | L2-Norm(final)=12.289 | 4698.0 samples/s | 73.4 steps/s
[Step=19800 Epoch=38.6] | Loss=0.03111 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.618 | L2-Norm(final)=12.285 | 4760.5 samples/s | 74.4 steps/s
[Step=19850 Epoch=38.7] | Loss=0.03095 | Reg=0.00245 | acc=0.9688 | L2-Norm=15.642 | L2-Norm(final)=12.280 | 4814.6 samples/s | 75.2 steps/s
[Step=19900 Epoch=38.8] | Loss=0.03058 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.665 | L2-Norm(final)=12.276 | 4733.9 samples/s | 74.0 steps/s
[Step=19950 Epoch=38.9] | Loss=0.03063 | Reg=0.00246 | acc=0.9531 | L2-Norm=15.688 | L2-Norm(final)=12.272 | 4799.0 samples/s | 75.0 steps/s
[Step=20000 Epoch=39.0] | Loss=0.03027 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.711 | L2-Norm(final)=12.268 | 4770.4 samples/s | 74.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step20000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=18001 Epoch=35.2] | Loss=0.09021 | Reg=0.00200 | acc=0.8906 | L2-Norm=14.128 | L2-Norm(final)=11.661 | 4468.8 samples/s | 69.8 steps/s
[Step=18050 Epoch=35.3] | Loss=0.07656 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.136 | L2-Norm(final)=11.685 | 5319.5 samples/s | 83.1 steps/s
[Step=18100 Epoch=35.4] | Loss=0.07044 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.137 | L2-Norm(final)=11.751 | 5525.4 samples/s | 86.3 steps/s
[Step=18150 Epoch=35.5] | Loss=0.06874 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.138 | L2-Norm(final)=11.817 | 5554.9 samples/s | 86.8 steps/s
[Step=18200 Epoch=35.6] | Loss=0.06916 | Reg=0.00200 | acc=0.9219 | L2-Norm=14.138 | L2-Norm(final)=11.881 | 5610.4 samples/s | 87.7 steps/s
[Step=18250 Epoch=35.7] | Loss=0.06895 | Reg=0.00200 | acc=0.9375 | L2-Norm=14.138 | L2-Norm(final)=11.939 | 5539.2 samples/s | 86.5 steps/s
[Step=18300 Epoch=35.8] | Loss=0.06908 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.138 | L2-Norm(final)=11.994 | 5345.5 samples/s | 83.5 steps/s
[Step=18350 Epoch=35.9] | Loss=0.06861 | Reg=0.00200 | acc=0.9219 | L2-Norm=14.138 | L2-Norm(final)=12.044 | 5558.5 samples/s | 86.9 steps/s
[Step=18400 Epoch=36.0] | Loss=0.06902 | Reg=0.00200 | acc=0.9531 | L2-Norm=14.138 | L2-Norm(final)=12.093 | 5593.6 samples/s | 87.4 steps/s
[Step=18450 Epoch=36.1] | Loss=0.06894 | Reg=0.00200 | acc=0.9375 | L2-Norm=14.138 | L2-Norm(final)=12.140 | 5677.7 samples/s | 88.7 steps/s
[Step=18500 Epoch=36.2] | Loss=0.06871 | Reg=0.00200 | acc=0.9531 | L2-Norm=14.138 | L2-Norm(final)=12.187 | 7247.1 samples/s | 113.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=18501 Epoch=36.2] | Loss=0.08767 | Reg=0.00200 | acc=0.9375 | L2-Norm=14.139 | L2-Norm(final)=12.646 | 4425.6 samples/s | 69.2 steps/s
[Step=18550 Epoch=36.3] | Loss=0.04390 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.421 | L2-Norm(final)=12.657 | 4695.9 samples/s | 73.4 steps/s
[Step=18600 Epoch=36.4] | Loss=0.04070 | Reg=0.00214 | acc=0.9531 | L2-Norm=14.617 | L2-Norm(final)=12.638 | 4913.9 samples/s | 76.8 steps/s
[Step=18650 Epoch=36.5] | Loss=0.03937 | Reg=0.00217 | acc=0.9531 | L2-Norm=14.731 | L2-Norm(final)=12.625 | 4919.5 samples/s | 76.9 steps/s
[Step=18700 Epoch=36.6] | Loss=0.04146 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.817 | L2-Norm(final)=12.612 | 4900.6 samples/s | 76.6 steps/s
[Step=18750 Epoch=36.7] | Loss=0.04252 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.895 | L2-Norm(final)=12.600 | 4910.6 samples/s | 76.7 steps/s
[Step=18800 Epoch=36.8] | Loss=0.04189 | Reg=0.00224 | acc=0.9688 | L2-Norm=14.960 | L2-Norm(final)=12.587 | 4902.6 samples/s | 76.6 steps/s
[Step=18850 Epoch=36.9] | Loss=0.04079 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.016 | L2-Norm(final)=12.577 | 4909.0 samples/s | 76.7 steps/s
[Step=18900 Epoch=36.9] | Loss=0.04094 | Reg=0.00227 | acc=0.9531 | L2-Norm=15.066 | L2-Norm(final)=12.568 | 4916.7 samples/s | 76.8 steps/s
[Step=18950 Epoch=37.0] | Loss=0.04039 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.113 | L2-Norm(final)=12.559 | 4819.6 samples/s | 75.3 steps/s
[Step=19000 Epoch=37.1] | Loss=0.03991 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.157 | L2-Norm(final)=12.551 | 5918.0 samples/s | 92.5 steps/s
[Step=19050 Epoch=37.2] | Loss=0.03870 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.200 | L2-Norm(final)=12.544 | 2034.2 samples/s | 31.8 steps/s
[Step=19100 Epoch=37.3] | Loss=0.03785 | Reg=0.00232 | acc=0.9219 | L2-Norm=15.239 | L2-Norm(final)=12.537 | 4787.1 samples/s | 74.8 steps/s
[Step=19150 Epoch=37.4] | Loss=0.03657 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.274 | L2-Norm(final)=12.532 | 4750.5 samples/s | 74.2 steps/s
[Step=19200 Epoch=37.5] | Loss=0.03533 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.308 | L2-Norm(final)=12.527 | 4717.7 samples/s | 73.7 steps/s
[Step=19250 Epoch=37.6] | Loss=0.03503 | Reg=0.00235 | acc=0.9688 | L2-Norm=15.340 | L2-Norm(final)=12.522 | 4781.9 samples/s | 74.7 steps/s
[Step=19300 Epoch=37.7] | Loss=0.03447 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.371 | L2-Norm(final)=12.516 | 4776.5 samples/s | 74.6 steps/s
[Step=19350 Epoch=37.8] | Loss=0.03393 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.400 | L2-Norm(final)=12.512 | 4844.8 samples/s | 75.7 steps/s
[Step=19400 Epoch=37.9] | Loss=0.03330 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.427 | L2-Norm(final)=12.507 | 4758.7 samples/s | 74.4 steps/s
[Step=19450 Epoch=38.0] | Loss=0.03313 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.454 | L2-Norm(final)=12.503 | 4809.5 samples/s | 75.1 steps/s
[Step=19500 Epoch=38.1] | Loss=0.03265 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.480 | L2-Norm(final)=12.498 | 5174.1 samples/s | 80.8 steps/s
[Step=19550 Epoch=38.2] | Loss=0.03210 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.506 | L2-Norm(final)=12.494 | 2150.1 samples/s | 33.6 steps/s
[Step=19600 Epoch=38.3] | Loss=0.03183 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.531 | L2-Norm(final)=12.490 | 4832.6 samples/s | 75.5 steps/s
[Step=19650 Epoch=38.4] | Loss=0.03134 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.556 | L2-Norm(final)=12.485 | 4749.6 samples/s | 74.2 steps/s
[Step=19700 Epoch=38.5] | Loss=0.03083 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.580 | L2-Norm(final)=12.481 | 4770.9 samples/s | 74.5 steps/s
[Step=19750 Epoch=38.6] | Loss=0.03037 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.603 | L2-Norm(final)=12.478 | 4744.1 samples/s | 74.1 steps/s
[Step=19800 Epoch=38.7] | Loss=0.03006 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.626 | L2-Norm(final)=12.474 | 4711.9 samples/s | 73.6 steps/s
[Step=19850 Epoch=38.8] | Loss=0.03012 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.649 | L2-Norm(final)=12.470 | 4757.1 samples/s | 74.3 steps/s
[Step=19900 Epoch=38.9] | Loss=0.03001 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.671 | L2-Norm(final)=12.466 | 4737.5 samples/s | 74.0 steps/s
[Step=19950 Epoch=39.0] | Loss=0.02993 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.695 | L2-Norm(final)=12.462 | 4774.7 samples/s | 74.6 steps/s
[Step=20000 Epoch=39.1] | Loss=0.02991 | Reg=0.00247 | acc=0.9531 | L2-Norm=15.719 | L2-Norm(final)=12.457 | 4807.2 samples/s | 75.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step20000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=18001 Epoch=69.0] | Loss=0.00321 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.128 | L2-Norm(final)=13.751 | 4213.2 samples/s | 65.8 steps/s
[Step=18050 Epoch=69.2] | Loss=0.00299 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.122 | L2-Norm(final)=13.800 | 5056.1 samples/s | 79.0 steps/s
[Step=18100 Epoch=69.4] | Loss=0.00274 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=13.864 | 5097.9 samples/s | 79.7 steps/s
[Step=18150 Epoch=69.5] | Loss=0.00304 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=13.934 | 5282.6 samples/s | 82.5 steps/s
[Step=18200 Epoch=69.7] | Loss=0.00337 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=14.003 | 5303.2 samples/s | 82.9 steps/s
[Step=18250 Epoch=69.9] | Loss=0.00334 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=14.065 | 6875.2 samples/s | 107.4 steps/s
[Step=18300 Epoch=70.1] | Loss=0.00338 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=14.125 | 2066.2 samples/s | 32.3 steps/s
[Step=18350 Epoch=70.3] | Loss=0.00334 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=14.181 | 5172.7 samples/s | 80.8 steps/s
[Step=18400 Epoch=70.5] | Loss=0.00326 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=14.235 | 5115.1 samples/s | 79.9 steps/s
[Step=18450 Epoch=70.7] | Loss=0.00317 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=14.290 | 5107.5 samples/s | 79.8 steps/s
[Step=18500 Epoch=70.9] | Loss=0.00304 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=14.344 | 5753.4 samples/s | 89.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=18501 Epoch=70.9] | Loss=0.00219 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=14.879 | 4339.3 samples/s | 67.8 steps/s
[Step=18550 Epoch=71.1] | Loss=0.01571 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.274 | L2-Norm(final)=14.877 | 4429.4 samples/s | 69.2 steps/s
[Step=18600 Epoch=71.3] | Loss=0.01701 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.575 | L2-Norm(final)=14.795 | 4459.6 samples/s | 69.7 steps/s
[Step=18650 Epoch=71.5] | Loss=0.01451 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.765 | L2-Norm(final)=14.736 | 4494.5 samples/s | 70.2 steps/s
[Step=18700 Epoch=71.7] | Loss=0.01163 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.885 | L2-Norm(final)=14.700 | 4488.8 samples/s | 70.1 steps/s
[Step=18750 Epoch=71.8] | Loss=0.00940 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.955 | L2-Norm(final)=14.682 | 5683.3 samples/s | 88.8 steps/s
[Step=18800 Epoch=72.0] | Loss=0.00794 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.994 | L2-Norm(final)=14.670 | 1925.9 samples/s | 30.1 steps/s
[Step=18850 Epoch=72.2] | Loss=0.00687 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.013 | L2-Norm(final)=14.662 | 4535.6 samples/s | 70.9 steps/s
[Step=18900 Epoch=72.4] | Loss=0.00616 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.024 | L2-Norm(final)=14.655 | 4506.2 samples/s | 70.4 steps/s
[Step=18950 Epoch=72.6] | Loss=0.00559 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.034 | L2-Norm(final)=14.650 | 4486.2 samples/s | 70.1 steps/s
[Step=19000 Epoch=72.8] | Loss=0.00615 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.042 | L2-Norm(final)=14.644 | 5043.7 samples/s | 78.8 steps/s
[Step=19050 Epoch=73.0] | Loss=0.00577 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.059 | L2-Norm(final)=14.635 | 2018.3 samples/s | 31.5 steps/s
[Step=19100 Epoch=73.2] | Loss=0.00545 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.073 | L2-Norm(final)=14.627 | 4525.6 samples/s | 70.7 steps/s
[Step=19150 Epoch=73.4] | Loss=0.00511 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.084 | L2-Norm(final)=14.620 | 4460.7 samples/s | 69.7 steps/s
[Step=19200 Epoch=73.6] | Loss=0.00476 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.091 | L2-Norm(final)=14.614 | 4571.2 samples/s | 71.4 steps/s
[Step=19250 Epoch=73.8] | Loss=0.00444 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.094 | L2-Norm(final)=14.609 | 4472.3 samples/s | 69.9 steps/s
[Step=19300 Epoch=74.0] | Loss=0.00417 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.094 | L2-Norm(final)=14.605 | 2093.1 samples/s | 32.7 steps/s
[Step=19350 Epoch=74.1] | Loss=0.00392 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.092 | L2-Norm(final)=14.602 | 4529.7 samples/s | 70.8 steps/s
[Step=19400 Epoch=74.3] | Loss=0.00370 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.087 | L2-Norm(final)=14.599 | 4504.0 samples/s | 70.4 steps/s
[Step=19450 Epoch=74.5] | Loss=0.00351 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.081 | L2-Norm(final)=14.597 | 4534.6 samples/s | 70.9 steps/s
[Step=19500 Epoch=74.7] | Loss=0.00334 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.073 | L2-Norm(final)=14.595 | 4495.0 samples/s | 70.2 steps/s
[Step=19550 Epoch=74.9] | Loss=0.00318 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.064 | L2-Norm(final)=14.593 | 2146.4 samples/s | 33.5 steps/s
[Step=19600 Epoch=75.1] | Loss=0.00303 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.054 | L2-Norm(final)=14.592 | 4600.0 samples/s | 71.9 steps/s
[Step=19650 Epoch=75.3] | Loss=0.00290 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.044 | L2-Norm(final)=14.591 | 4639.2 samples/s | 72.5 steps/s
[Step=19700 Epoch=75.5] | Loss=0.00278 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.032 | L2-Norm(final)=14.590 | 4586.4 samples/s | 71.7 steps/s
[Step=19750 Epoch=75.7] | Loss=0.00267 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.020 | L2-Norm(final)=14.589 | 4482.8 samples/s | 70.0 steps/s
[Step=19800 Epoch=75.9] | Loss=0.00257 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.007 | L2-Norm(final)=14.588 | 6164.8 samples/s | 96.3 steps/s
[Step=19850 Epoch=76.1] | Loss=0.00247 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.994 | L2-Norm(final)=14.588 | 1875.1 samples/s | 29.3 steps/s
[Step=19900 Epoch=76.2] | Loss=0.00238 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.980 | L2-Norm(final)=14.587 | 4491.3 samples/s | 70.2 steps/s
[Step=19950 Epoch=76.4] | Loss=0.00230 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.966 | L2-Norm(final)=14.587 | 4493.6 samples/s | 70.2 steps/s
[Step=20000 Epoch=76.6] | Loss=0.00223 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.951 | L2-Norm(final)=14.587 | 4516.7 samples/s | 70.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step20000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=18001 Epoch=69.3] | Loss=0.00628 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.128 | L2-Norm(final)=13.099 | 4347.9 samples/s | 67.9 steps/s
[Step=18050 Epoch=69.5] | Loss=0.00562 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.123 | L2-Norm(final)=13.144 | 4750.9 samples/s | 74.2 steps/s
[Step=18100 Epoch=69.7] | Loss=0.00596 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.122 | L2-Norm(final)=13.191 | 5407.4 samples/s | 84.5 steps/s
[Step=18150 Epoch=69.9] | Loss=0.00567 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.122 | L2-Norm(final)=13.234 | 5135.5 samples/s | 80.2 steps/s
[Step=18200 Epoch=70.1] | Loss=0.00551 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.122 | L2-Norm(final)=13.280 | 5312.9 samples/s | 83.0 steps/s
[Step=18250 Epoch=70.3] | Loss=0.00533 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.122 | L2-Norm(final)=13.329 | 7219.8 samples/s | 112.8 steps/s
[Step=18300 Epoch=70.4] | Loss=0.00536 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.122 | L2-Norm(final)=13.379 | 2066.5 samples/s | 32.3 steps/s
[Step=18350 Epoch=70.6] | Loss=0.00524 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.122 | L2-Norm(final)=13.429 | 5359.6 samples/s | 83.7 steps/s
[Step=18400 Epoch=70.8] | Loss=0.00520 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.122 | L2-Norm(final)=13.478 | 5320.7 samples/s | 83.1 steps/s
[Step=18450 Epoch=71.0] | Loss=0.00523 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.122 | L2-Norm(final)=13.526 | 5199.2 samples/s | 81.2 steps/s
[Step=18500 Epoch=71.2] | Loss=0.00514 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.122 | L2-Norm(final)=13.572 | 6179.2 samples/s | 96.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=18501 Epoch=71.2] | Loss=0.00235 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=14.033 | 4483.8 samples/s | 70.1 steps/s
[Step=18550 Epoch=71.4] | Loss=0.00370 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.263 | L2-Norm(final)=14.047 | 4405.7 samples/s | 68.8 steps/s
[Step=18600 Epoch=71.6] | Loss=0.00444 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.407 | L2-Norm(final)=14.023 | 4570.1 samples/s | 71.4 steps/s
[Step=18650 Epoch=71.8] | Loss=0.00633 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.549 | L2-Norm(final)=13.998 | 4556.3 samples/s | 71.2 steps/s
[Step=18700 Epoch=72.0] | Loss=0.00648 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.679 | L2-Norm(final)=13.969 | 4582.3 samples/s | 71.6 steps/s
[Step=18750 Epoch=72.2] | Loss=0.00630 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.780 | L2-Norm(final)=13.946 | 5712.5 samples/s | 89.3 steps/s
[Step=18800 Epoch=72.4] | Loss=0.00631 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.858 | L2-Norm(final)=13.922 | 1904.9 samples/s | 29.8 steps/s
[Step=18850 Epoch=72.6] | Loss=0.00551 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.915 | L2-Norm(final)=13.903 | 4508.7 samples/s | 70.4 steps/s
[Step=18900 Epoch=72.8] | Loss=0.00484 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.954 | L2-Norm(final)=13.890 | 4541.7 samples/s | 71.0 steps/s
[Step=18950 Epoch=72.9] | Loss=0.00432 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.979 | L2-Norm(final)=13.880 | 4583.6 samples/s | 71.6 steps/s
[Step=19000 Epoch=73.1] | Loss=0.00400 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.995 | L2-Norm(final)=13.872 | 5094.5 samples/s | 79.6 steps/s
[Step=19050 Epoch=73.3] | Loss=0.00404 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.011 | L2-Norm(final)=13.864 | 2015.1 samples/s | 31.5 steps/s
[Step=19100 Epoch=73.5] | Loss=0.00400 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.028 | L2-Norm(final)=13.856 | 4562.0 samples/s | 71.3 steps/s
[Step=19150 Epoch=73.7] | Loss=0.00392 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.053 | L2-Norm(final)=13.848 | 4503.7 samples/s | 70.4 steps/s
[Step=19200 Epoch=73.9] | Loss=0.00385 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.078 | L2-Norm(final)=13.841 | 4514.4 samples/s | 70.5 steps/s
[Step=19250 Epoch=74.1] | Loss=0.00361 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.101 | L2-Norm(final)=13.835 | 4594.3 samples/s | 71.8 steps/s
[Step=19300 Epoch=74.3] | Loss=0.00340 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.119 | L2-Norm(final)=13.830 | 2115.6 samples/s | 33.1 steps/s
[Step=19350 Epoch=74.5] | Loss=0.00320 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.133 | L2-Norm(final)=13.825 | 4662.7 samples/s | 72.9 steps/s
[Step=19400 Epoch=74.7] | Loss=0.00303 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.143 | L2-Norm(final)=13.821 | 4609.5 samples/s | 72.0 steps/s
[Step=19450 Epoch=74.9] | Loss=0.00289 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.151 | L2-Norm(final)=13.817 | 4535.9 samples/s | 70.9 steps/s
[Step=19500 Epoch=75.1] | Loss=0.00277 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.157 | L2-Norm(final)=13.814 | 4529.4 samples/s | 70.8 steps/s
[Step=19550 Epoch=75.3] | Loss=0.00264 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.161 | L2-Norm(final)=13.811 | 2129.8 samples/s | 33.3 steps/s
[Step=19600 Epoch=75.4] | Loss=0.00252 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.163 | L2-Norm(final)=13.808 | 4561.8 samples/s | 71.3 steps/s
[Step=19650 Epoch=75.6] | Loss=0.00241 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.163 | L2-Norm(final)=13.806 | 4589.1 samples/s | 71.7 steps/s
[Step=19700 Epoch=75.8] | Loss=0.00231 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.162 | L2-Norm(final)=13.804 | 4520.7 samples/s | 70.6 steps/s
[Step=19750 Epoch=76.0] | Loss=0.00222 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.159 | L2-Norm(final)=13.802 | 4524.7 samples/s | 70.7 steps/s
[Step=19800 Epoch=76.2] | Loss=0.00213 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.154 | L2-Norm(final)=13.800 | 6593.0 samples/s | 103.0 steps/s
[Step=19850 Epoch=76.4] | Loss=0.00205 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.149 | L2-Norm(final)=13.799 | 1843.3 samples/s | 28.8 steps/s
[Step=19900 Epoch=76.6] | Loss=0.00198 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.142 | L2-Norm(final)=13.798 | 4557.0 samples/s | 71.2 steps/s
[Step=19950 Epoch=76.8] | Loss=0.00191 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.135 | L2-Norm(final)=13.796 | 4427.9 samples/s | 69.2 steps/s
[Step=20000 Epoch=77.0] | Loss=0.00185 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.127 | L2-Norm(final)=13.795 | 4501.9 samples/s | 70.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07463 | acc=0.9622 | tpr=0.9723 | fpr=0.0597 | 4433.8 samples/s | 17.3 steps/s
Avg test loss: 0.07452, Avg test acc: 0.96150, Avg tpr: 0.97226, Avg fpr: 0.06217, total FA: 485

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07223 | acc=0.9564 | tpr=0.9523 | fpr=0.0347 | 4496.1 samples/s | 17.6 steps/s
Avg test loss: 0.07404, Avg test acc: 0.95553, Avg tpr: 0.95256, Avg fpr: 0.03794, total FA: 296

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.38291 | acc=0.3159 | tpr=0.0060 | fpr=0.0111 | 4482.7 samples/s | 17.5 steps/s
Avg test loss: 7.40850, Avg test acc: 0.31333, Avg tpr: 0.00577, Avg fpr: 0.01026, total FA: 80

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=16.12711 | acc=0.3153 | tpr=0.0024 | fpr=0.0052 | 4502.8 samples/s | 17.6 steps/s
Avg test loss: 16.12785, Avg test acc: 0.31240, Avg tpr: 0.00216, Avg fpr: 0.00526, total FA: 41

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.12756 | acc=0.1085 | tpr=0.8628 | fpr=0.9050 | 4515.5 samples/s | 17.6 steps/s
[Step= 100] | Loss=6.07206 | acc=0.1097 | tpr=0.8657 | fpr=0.9044 | 8338.1 samples/s | 32.6 steps/s
[Step= 150] | Loss=6.06842 | acc=0.1087 | tpr=0.8674 | fpr=0.9053 | 8783.5 samples/s | 34.3 steps/s
[Step= 200] | Loss=6.07005 | acc=0.1093 | tpr=0.8590 | fpr=0.9044 | 8296.9 samples/s | 32.4 steps/s
[Step= 250] | Loss=6.07295 | acc=0.1092 | tpr=0.8568 | fpr=0.9044 | 8353.9 samples/s | 32.6 steps/s
[Step= 300] | Loss=6.06888 | acc=0.1087 | tpr=0.8524 | fpr=0.9048 | 8348.9 samples/s | 32.6 steps/s
[Step= 350] | Loss=6.07079 | acc=0.1081 | tpr=0.8503 | fpr=0.9054 | 8496.3 samples/s | 33.2 steps/s
[Step= 400] | Loss=6.07205 | acc=0.1083 | tpr=0.8485 | fpr=0.9052 | 8573.0 samples/s | 33.5 steps/s
[Step= 450] | Loss=6.07572 | acc=0.1085 | tpr=0.8496 | fpr=0.9049 | 8488.1 samples/s | 33.2 steps/s
[Step= 500] | Loss=6.07407 | acc=0.1085 | tpr=0.8493 | fpr=0.9049 | 8505.2 samples/s | 33.2 steps/s
[Step= 550] | Loss=6.07677 | acc=0.1084 | tpr=0.8496 | fpr=0.9051 | 15500.9 samples/s | 60.6 steps/s
Avg test loss: 6.07740, Avg test acc: 0.10834, Avg tpr: 0.84984, Avg fpr: 0.90514, total FA: 125677

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.23399 | acc=0.1641 | tpr=0.6018 | fpr=0.8437 | 4510.2 samples/s | 17.6 steps/s
[Step= 100] | Loss=4.18717 | acc=0.1632 | tpr=0.6055 | fpr=0.8451 | 8431.7 samples/s | 32.9 steps/s
[Step= 150] | Loss=4.18386 | acc=0.1638 | tpr=0.6081 | fpr=0.8444 | 8454.7 samples/s | 33.0 steps/s
[Step= 200] | Loss=4.18128 | acc=0.1639 | tpr=0.5967 | fpr=0.8439 | 8459.1 samples/s | 33.0 steps/s
[Step= 250] | Loss=4.18760 | acc=0.1640 | tpr=0.6017 | fpr=0.8439 | 8676.3 samples/s | 33.9 steps/s
[Step= 300] | Loss=4.18926 | acc=0.1633 | tpr=0.6065 | fpr=0.8448 | 8249.1 samples/s | 32.2 steps/s
[Step= 350] | Loss=4.18393 | acc=0.1628 | tpr=0.6068 | fpr=0.8452 | 8594.9 samples/s | 33.6 steps/s
[Step= 400] | Loss=4.18363 | acc=0.1634 | tpr=0.6056 | fpr=0.8446 | 8522.2 samples/s | 33.3 steps/s
[Step= 450] | Loss=4.18528 | acc=0.1634 | tpr=0.6154 | fpr=0.8448 | 8509.9 samples/s | 33.2 steps/s
[Step= 500] | Loss=4.18434 | acc=0.1634 | tpr=0.6141 | fpr=0.8447 | 8428.2 samples/s | 32.9 steps/s
[Step= 550] | Loss=4.18574 | acc=0.1634 | tpr=0.6124 | fpr=0.8447 | 15139.0 samples/s | 59.1 steps/s
Avg test loss: 4.18572, Avg test acc: 0.16336, Avg tpr: 0.61292, Avg fpr: 0.84482, total FA: 117301

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.14058 | acc=0.9812 | tpr=0.9336 | fpr=0.0179 | 4443.0 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.14642 | acc=0.9801 | tpr=0.9531 | fpr=0.0194 | 8343.6 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.15465 | acc=0.9795 | tpr=0.9539 | fpr=0.0200 | 8587.6 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.15623 | acc=0.9798 | tpr=0.9563 | fpr=0.0197 | 8220.9 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.15385 | acc=0.9797 | tpr=0.9528 | fpr=0.0198 | 8669.2 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.15617 | acc=0.9794 | tpr=0.9505 | fpr=0.0201 | 8387.5 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.15773 | acc=0.9792 | tpr=0.9512 | fpr=0.0203 | 8363.5 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.15952 | acc=0.9791 | tpr=0.9464 | fpr=0.0203 | 8579.5 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.16238 | acc=0.9787 | tpr=0.9440 | fpr=0.0206 | 8399.8 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.16178 | acc=0.9787 | tpr=0.9454 | fpr=0.0207 | 8529.6 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.16073 | acc=0.9790 | tpr=0.9439 | fpr=0.0204 | 15525.7 samples/s | 60.6 steps/s
Avg test loss: 0.16044, Avg test acc: 0.97897, Avg tpr: 0.94374, Avg fpr: 0.02039, total FA: 2831

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15504 | acc=0.9833 | tpr=0.9204 | fpr=0.0156 | 4422.6 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.16152 | acc=0.9827 | tpr=0.9360 | fpr=0.0164 | 8365.6 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.17141 | acc=0.9816 | tpr=0.9424 | fpr=0.0177 | 8308.2 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.17310 | acc=0.9815 | tpr=0.9497 | fpr=0.0179 | 8419.2 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.17071 | acc=0.9815 | tpr=0.9467 | fpr=0.0179 | 8352.2 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.17295 | acc=0.9812 | tpr=0.9498 | fpr=0.0182 | 8402.4 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.17486 | acc=0.9810 | tpr=0.9505 | fpr=0.0185 | 8295.0 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.17672 | acc=0.9808 | tpr=0.9480 | fpr=0.0186 | 8587.8 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.17983 | acc=0.9805 | tpr=0.9479 | fpr=0.0189 | 8554.3 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.17970 | acc=0.9806 | tpr=0.9493 | fpr=0.0188 | 8315.7 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.17848 | acc=0.9807 | tpr=0.9479 | fpr=0.0187 | 15245.1 samples/s | 59.6 steps/s
Avg test loss: 0.17810, Avg test acc: 0.98070, Avg tpr: 0.94770, Avg fpr: 0.01870, total FA: 2597

server round 10/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=39.0] | Loss=0.11657 | Reg=0.00206 | acc=0.9375 | L2-Norm=14.358 | L2-Norm(final)=12.159 | 4425.6 samples/s | 69.2 steps/s
[Step=20050 Epoch=39.1] | Loss=0.07190 | Reg=0.00206 | acc=0.9531 | L2-Norm=14.361 | L2-Norm(final)=12.191 | 5042.6 samples/s | 78.8 steps/s
[Step=20100 Epoch=39.2] | Loss=0.07054 | Reg=0.00206 | acc=0.9375 | L2-Norm=14.361 | L2-Norm(final)=12.226 | 5446.8 samples/s | 85.1 steps/s
[Step=20150 Epoch=39.3] | Loss=0.06966 | Reg=0.00206 | acc=0.9531 | L2-Norm=14.362 | L2-Norm(final)=12.256 | 5453.3 samples/s | 85.2 steps/s
[Step=20200 Epoch=39.4] | Loss=0.06926 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.362 | L2-Norm(final)=12.285 | 5498.8 samples/s | 85.9 steps/s
[Step=20250 Epoch=39.5] | Loss=0.06880 | Reg=0.00206 | acc=0.9531 | L2-Norm=14.362 | L2-Norm(final)=12.312 | 5520.6 samples/s | 86.3 steps/s
[Step=20300 Epoch=39.6] | Loss=0.06759 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.362 | L2-Norm(final)=12.340 | 5518.9 samples/s | 86.2 steps/s
[Step=20350 Epoch=39.7] | Loss=0.06689 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.362 | L2-Norm(final)=12.367 | 5505.7 samples/s | 86.0 steps/s
[Step=20400 Epoch=39.8] | Loss=0.06692 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.362 | L2-Norm(final)=12.394 | 5590.3 samples/s | 87.3 steps/s
[Step=20450 Epoch=39.9] | Loss=0.06671 | Reg=0.00206 | acc=0.9531 | L2-Norm=14.362 | L2-Norm(final)=12.419 | 5601.3 samples/s | 87.5 steps/s
[Step=20500 Epoch=40.0] | Loss=0.06652 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.362 | L2-Norm(final)=12.444 | 6680.7 samples/s | 104.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=40.0] | Loss=0.09560 | Reg=0.00206 | acc=0.9375 | L2-Norm=14.362 | L2-Norm(final)=12.687 | 4192.5 samples/s | 65.5 steps/s
[Step=20550 Epoch=40.1] | Loss=0.04492 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.425 | L2-Norm(final)=12.700 | 4413.5 samples/s | 69.0 steps/s
[Step=20600 Epoch=40.2] | Loss=0.04001 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.472 | L2-Norm(final)=12.701 | 4741.1 samples/s | 74.1 steps/s
[Step=20650 Epoch=40.3] | Loss=0.03564 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.503 | L2-Norm(final)=12.701 | 4806.6 samples/s | 75.1 steps/s
[Step=20700 Epoch=40.4] | Loss=0.03391 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.526 | L2-Norm(final)=12.700 | 4719.5 samples/s | 73.7 steps/s
[Step=20750 Epoch=40.5] | Loss=0.03346 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.542 | L2-Norm(final)=12.699 | 4782.3 samples/s | 74.7 steps/s
[Step=20800 Epoch=40.6] | Loss=0.03122 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.555 | L2-Norm(final)=12.698 | 4722.6 samples/s | 73.8 steps/s
[Step=20850 Epoch=40.7] | Loss=0.03055 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.566 | L2-Norm(final)=12.697 | 4788.8 samples/s | 74.8 steps/s
[Step=20900 Epoch=40.8] | Loss=0.02971 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.576 | L2-Norm(final)=12.696 | 4765.8 samples/s | 74.5 steps/s
[Step=20950 Epoch=40.9] | Loss=0.02852 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.584 | L2-Norm(final)=12.696 | 4843.1 samples/s | 75.7 steps/s
[Step=21000 Epoch=41.0] | Loss=0.02763 | Reg=0.00213 | acc=0.9531 | L2-Norm=14.592 | L2-Norm(final)=12.696 | 5733.4 samples/s | 89.6 steps/s
[Step=21050 Epoch=41.1] | Loss=0.02652 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.600 | L2-Norm(final)=12.696 | 1996.3 samples/s | 31.2 steps/s
[Step=21100 Epoch=41.2] | Loss=0.02557 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.607 | L2-Norm(final)=12.696 | 4760.2 samples/s | 74.4 steps/s
[Step=21150 Epoch=41.3] | Loss=0.02487 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.614 | L2-Norm(final)=12.696 | 4773.5 samples/s | 74.6 steps/s
[Step=21200 Epoch=41.3] | Loss=0.02412 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.620 | L2-Norm(final)=12.696 | 4798.8 samples/s | 75.0 steps/s
[Step=21250 Epoch=41.4] | Loss=0.02340 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.627 | L2-Norm(final)=12.697 | 4751.3 samples/s | 74.2 steps/s
[Step=21300 Epoch=41.5] | Loss=0.02272 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.633 | L2-Norm(final)=12.697 | 4734.5 samples/s | 74.0 steps/s
[Step=21350 Epoch=41.6] | Loss=0.02226 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.638 | L2-Norm(final)=12.697 | 4842.3 samples/s | 75.7 steps/s
[Step=21400 Epoch=41.7] | Loss=0.02186 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.643 | L2-Norm(final)=12.698 | 4832.8 samples/s | 75.5 steps/s
[Step=21450 Epoch=41.8] | Loss=0.02148 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.648 | L2-Norm(final)=12.698 | 4857.8 samples/s | 75.9 steps/s
[Step=21500 Epoch=41.9] | Loss=0.02120 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.653 | L2-Norm(final)=12.699 | 4989.9 samples/s | 78.0 steps/s
[Step=21550 Epoch=42.0] | Loss=0.02082 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.658 | L2-Norm(final)=12.699 | 2028.5 samples/s | 31.7 steps/s
[Step=21600 Epoch=42.1] | Loss=0.02043 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.662 | L2-Norm(final)=12.700 | 4834.3 samples/s | 75.5 steps/s
[Step=21650 Epoch=42.2] | Loss=0.01999 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.667 | L2-Norm(final)=12.701 | 4640.4 samples/s | 72.5 steps/s
[Step=21700 Epoch=42.3] | Loss=0.01964 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.671 | L2-Norm(final)=12.701 | 4777.4 samples/s | 74.6 steps/s
[Step=21750 Epoch=42.4] | Loss=0.01924 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.675 | L2-Norm(final)=12.702 | 4753.1 samples/s | 74.3 steps/s
[Step=21800 Epoch=42.5] | Loss=0.01916 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.679 | L2-Norm(final)=12.703 | 4739.0 samples/s | 74.0 steps/s
[Step=21850 Epoch=42.6] | Loss=0.01896 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.684 | L2-Norm(final)=12.703 | 4820.2 samples/s | 75.3 steps/s
[Step=21900 Epoch=42.7] | Loss=0.01874 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.688 | L2-Norm(final)=12.704 | 4740.1 samples/s | 74.1 steps/s
[Step=21950 Epoch=42.8] | Loss=0.01855 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.692 | L2-Norm(final)=12.704 | 4808.1 samples/s | 75.1 steps/s
[Step=22000 Epoch=42.9] | Loss=0.01839 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.696 | L2-Norm(final)=12.705 | 4710.0 samples/s | 73.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step22000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=39.1] | Loss=0.06155 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.358 | L2-Norm(final)=12.322 | 4434.9 samples/s | 69.3 steps/s
[Step=20050 Epoch=39.2] | Loss=0.07381 | Reg=0.00206 | acc=0.9531 | L2-Norm=14.362 | L2-Norm(final)=12.346 | 5260.8 samples/s | 82.2 steps/s
[Step=20100 Epoch=39.3] | Loss=0.07224 | Reg=0.00206 | acc=0.9531 | L2-Norm=14.362 | L2-Norm(final)=12.379 | 5555.8 samples/s | 86.8 steps/s
[Step=20150 Epoch=39.4] | Loss=0.07205 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.362 | L2-Norm(final)=12.412 | 5509.7 samples/s | 86.1 steps/s
[Step=20200 Epoch=39.5] | Loss=0.07211 | Reg=0.00206 | acc=0.9062 | L2-Norm=14.363 | L2-Norm(final)=12.445 | 5386.7 samples/s | 84.2 steps/s
[Step=20250 Epoch=39.6] | Loss=0.07140 | Reg=0.00206 | acc=0.9531 | L2-Norm=14.363 | L2-Norm(final)=12.476 | 5542.1 samples/s | 86.6 steps/s
[Step=20300 Epoch=39.7] | Loss=0.07083 | Reg=0.00206 | acc=0.9531 | L2-Norm=14.363 | L2-Norm(final)=12.507 | 5447.0 samples/s | 85.1 steps/s
[Step=20350 Epoch=39.8] | Loss=0.07002 | Reg=0.00206 | acc=0.9531 | L2-Norm=14.363 | L2-Norm(final)=12.538 | 5547.7 samples/s | 86.7 steps/s
[Step=20400 Epoch=39.9] | Loss=0.06959 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.363 | L2-Norm(final)=12.568 | 5547.5 samples/s | 86.7 steps/s
[Step=20450 Epoch=40.0] | Loss=0.06897 | Reg=0.00206 | acc=0.9531 | L2-Norm=14.363 | L2-Norm(final)=12.599 | 5412.0 samples/s | 84.6 steps/s
[Step=20500 Epoch=40.1] | Loss=0.06873 | Reg=0.00206 | acc=0.9062 | L2-Norm=14.363 | L2-Norm(final)=12.629 | 7021.3 samples/s | 109.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=40.1] | Loss=0.08258 | Reg=0.00206 | acc=0.9375 | L2-Norm=14.363 | L2-Norm(final)=12.920 | 4527.9 samples/s | 70.7 steps/s
[Step=20550 Epoch=40.2] | Loss=0.05527 | Reg=0.00208 | acc=0.9531 | L2-Norm=14.422 | L2-Norm(final)=12.928 | 4433.7 samples/s | 69.3 steps/s
[Step=20600 Epoch=40.3] | Loss=0.04444 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.469 | L2-Norm(final)=12.929 | 4692.0 samples/s | 73.3 steps/s
[Step=20650 Epoch=40.4] | Loss=0.03917 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.497 | L2-Norm(final)=12.928 | 4743.2 samples/s | 74.1 steps/s
[Step=20700 Epoch=40.5] | Loss=0.03591 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.518 | L2-Norm(final)=12.928 | 4747.5 samples/s | 74.2 steps/s
[Step=20750 Epoch=40.6] | Loss=0.03374 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.536 | L2-Norm(final)=12.927 | 4744.9 samples/s | 74.1 steps/s
[Step=20800 Epoch=40.7] | Loss=0.03103 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.553 | L2-Norm(final)=12.927 | 4777.5 samples/s | 74.6 steps/s
[Step=20850 Epoch=40.8] | Loss=0.02991 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.568 | L2-Norm(final)=12.926 | 4799.8 samples/s | 75.0 steps/s
[Step=20900 Epoch=40.9] | Loss=0.02875 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.581 | L2-Norm(final)=12.926 | 4823.0 samples/s | 75.4 steps/s
[Step=20950 Epoch=41.0] | Loss=0.02837 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.593 | L2-Norm(final)=12.925 | 4780.4 samples/s | 74.7 steps/s
[Step=21000 Epoch=41.1] | Loss=0.02696 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.604 | L2-Norm(final)=12.925 | 5983.9 samples/s | 93.5 steps/s
[Step=21050 Epoch=41.2] | Loss=0.02601 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.615 | L2-Norm(final)=12.925 | 2026.5 samples/s | 31.7 steps/s
[Step=21100 Epoch=41.2] | Loss=0.02535 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.624 | L2-Norm(final)=12.925 | 4743.9 samples/s | 74.1 steps/s
[Step=21150 Epoch=41.3] | Loss=0.02439 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.633 | L2-Norm(final)=12.925 | 4763.0 samples/s | 74.4 steps/s
[Step=21200 Epoch=41.4] | Loss=0.02370 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.642 | L2-Norm(final)=12.926 | 4803.9 samples/s | 75.1 steps/s
[Step=21250 Epoch=41.5] | Loss=0.02303 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.650 | L2-Norm(final)=12.926 | 4821.7 samples/s | 75.3 steps/s
[Step=21300 Epoch=41.6] | Loss=0.02253 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.657 | L2-Norm(final)=12.926 | 4762.7 samples/s | 74.4 steps/s
[Step=21350 Epoch=41.7] | Loss=0.02236 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.664 | L2-Norm(final)=12.926 | 4777.4 samples/s | 74.6 steps/s
[Step=21400 Epoch=41.8] | Loss=0.02196 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.670 | L2-Norm(final)=12.927 | 4820.3 samples/s | 75.3 steps/s
[Step=21450 Epoch=41.9] | Loss=0.02160 | Reg=0.00215 | acc=0.9531 | L2-Norm=14.677 | L2-Norm(final)=12.927 | 4756.8 samples/s | 74.3 steps/s
[Step=21500 Epoch=42.0] | Loss=0.02124 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.683 | L2-Norm(final)=12.927 | 5115.3 samples/s | 79.9 steps/s
[Step=21550 Epoch=42.1] | Loss=0.02077 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.689 | L2-Norm(final)=12.928 | 2149.2 samples/s | 33.6 steps/s
[Step=21600 Epoch=42.2] | Loss=0.02024 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.695 | L2-Norm(final)=12.928 | 4908.0 samples/s | 76.7 steps/s
[Step=21650 Epoch=42.3] | Loss=0.01984 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.700 | L2-Norm(final)=12.929 | 4912.4 samples/s | 76.8 steps/s
[Step=21700 Epoch=42.4] | Loss=0.01954 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.706 | L2-Norm(final)=12.929 | 4912.8 samples/s | 76.8 steps/s
[Step=21750 Epoch=42.5] | Loss=0.01926 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.711 | L2-Norm(final)=12.929 | 4910.9 samples/s | 76.7 steps/s
[Step=21800 Epoch=42.6] | Loss=0.01902 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.716 | L2-Norm(final)=12.929 | 4944.7 samples/s | 77.3 steps/s
[Step=21850 Epoch=42.7] | Loss=0.01872 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.721 | L2-Norm(final)=12.930 | 4776.4 samples/s | 74.6 steps/s
[Step=21900 Epoch=42.8] | Loss=0.01850 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.725 | L2-Norm(final)=12.930 | 4787.0 samples/s | 74.8 steps/s
[Step=21950 Epoch=42.9] | Loss=0.01833 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.730 | L2-Norm(final)=12.931 | 4794.5 samples/s | 74.9 steps/s
[Step=22000 Epoch=43.0] | Loss=0.01823 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.735 | L2-Norm(final)=12.931 | 4751.4 samples/s | 74.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step22000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=76.6] | Loss=0.00049 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.358 | L2-Norm(final)=14.580 | 4445.9 samples/s | 69.5 steps/s
[Step=20050 Epoch=76.8] | Loss=0.00197 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=14.592 | 4746.6 samples/s | 74.2 steps/s
[Step=20100 Epoch=77.0] | Loss=0.00199 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.355 | L2-Norm(final)=14.605 | 5165.0 samples/s | 80.7 steps/s
[Step=20150 Epoch=77.2] | Loss=0.00173 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=14.617 | 5193.8 samples/s | 81.2 steps/s
[Step=20200 Epoch=77.4] | Loss=0.00179 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=14.629 | 5014.4 samples/s | 78.3 steps/s
[Step=20250 Epoch=77.6] | Loss=0.00180 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=14.642 | 6632.3 samples/s | 103.6 steps/s
[Step=20300 Epoch=77.8] | Loss=0.00167 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=14.656 | 2045.1 samples/s | 32.0 steps/s
[Step=20350 Epoch=78.0] | Loss=0.00165 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=14.670 | 5020.0 samples/s | 78.4 steps/s
[Step=20400 Epoch=78.2] | Loss=0.00169 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=14.683 | 5168.5 samples/s | 80.8 steps/s
[Step=20450 Epoch=78.4] | Loss=0.00171 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=14.697 | 5134.4 samples/s | 80.2 steps/s
[Step=20500 Epoch=78.5] | Loss=0.00175 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=14.710 | 5859.0 samples/s | 91.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=78.6] | Loss=0.00033 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=14.836 | 4268.9 samples/s | 66.7 steps/s
[Step=20550 Epoch=78.7] | Loss=0.00123 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.340 | L2-Norm(final)=14.847 | 4324.4 samples/s | 67.6 steps/s
[Step=20600 Epoch=78.9] | Loss=0.00148 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.341 | L2-Norm(final)=14.852 | 4558.5 samples/s | 71.2 steps/s
[Step=20650 Epoch=79.1] | Loss=0.00104 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.335 | L2-Norm(final)=14.857 | 4503.7 samples/s | 70.4 steps/s
[Step=20700 Epoch=79.3] | Loss=0.00079 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.323 | L2-Norm(final)=14.860 | 4549.5 samples/s | 71.1 steps/s
[Step=20750 Epoch=79.5] | Loss=0.00069 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.308 | L2-Norm(final)=14.862 | 5780.4 samples/s | 90.3 steps/s
[Step=20800 Epoch=79.7] | Loss=0.00058 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.293 | L2-Norm(final)=14.864 | 1969.8 samples/s | 30.8 steps/s
[Step=20850 Epoch=79.9] | Loss=0.00050 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.277 | L2-Norm(final)=14.866 | 4537.8 samples/s | 70.9 steps/s
[Step=20900 Epoch=80.1] | Loss=0.00044 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.261 | L2-Norm(final)=14.868 | 4487.8 samples/s | 70.1 steps/s
[Step=20950 Epoch=80.3] | Loss=0.00039 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.244 | L2-Norm(final)=14.869 | 4452.3 samples/s | 69.6 steps/s
[Step=21000 Epoch=80.5] | Loss=0.00035 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.227 | L2-Norm(final)=14.870 | 5037.1 samples/s | 78.7 steps/s
[Step=21050 Epoch=80.7] | Loss=0.00032 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.211 | L2-Norm(final)=14.871 | 2052.7 samples/s | 32.1 steps/s
[Step=21100 Epoch=80.8] | Loss=0.00030 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.194 | L2-Norm(final)=14.872 | 4707.6 samples/s | 73.6 steps/s
[Step=21150 Epoch=81.0] | Loss=0.00027 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.178 | L2-Norm(final)=14.872 | 4494.8 samples/s | 70.2 steps/s
[Step=21200 Epoch=81.2] | Loss=0.00025 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.161 | L2-Norm(final)=14.873 | 4515.3 samples/s | 70.6 steps/s
[Step=21250 Epoch=81.4] | Loss=0.00024 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.145 | L2-Norm(final)=14.873 | 4527.5 samples/s | 70.7 steps/s
[Step=21300 Epoch=81.6] | Loss=0.00022 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.129 | L2-Norm(final)=14.874 | 2118.2 samples/s | 33.1 steps/s
[Step=21350 Epoch=81.8] | Loss=0.00021 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.112 | L2-Norm(final)=14.875 | 4596.3 samples/s | 71.8 steps/s
[Step=21400 Epoch=82.0] | Loss=0.00020 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.096 | L2-Norm(final)=14.875 | 4501.0 samples/s | 70.3 steps/s
[Step=21450 Epoch=82.2] | Loss=0.00019 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.080 | L2-Norm(final)=14.875 | 4554.0 samples/s | 71.2 steps/s
[Step=21500 Epoch=82.4] | Loss=0.00018 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.064 | L2-Norm(final)=14.876 | 4540.5 samples/s | 70.9 steps/s
[Step=21550 Epoch=82.6] | Loss=0.00017 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.048 | L2-Norm(final)=14.876 | 2132.9 samples/s | 33.3 steps/s
[Step=21600 Epoch=82.8] | Loss=0.00016 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.032 | L2-Norm(final)=14.877 | 4646.8 samples/s | 72.6 steps/s
[Step=21650 Epoch=83.0] | Loss=0.00016 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.016 | L2-Norm(final)=14.877 | 4561.5 samples/s | 71.3 steps/s
[Step=21700 Epoch=83.1] | Loss=0.00015 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.000 | L2-Norm(final)=14.877 | 4494.2 samples/s | 70.2 steps/s
[Step=21750 Epoch=83.3] | Loss=0.00014 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.984 | L2-Norm(final)=14.878 | 4544.2 samples/s | 71.0 steps/s
[Step=21800 Epoch=83.5] | Loss=0.00014 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.968 | L2-Norm(final)=14.878 | 6104.5 samples/s | 95.4 steps/s
[Step=21850 Epoch=83.7] | Loss=0.00013 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.952 | L2-Norm(final)=14.879 | 1918.6 samples/s | 30.0 steps/s
[Step=21900 Epoch=83.9] | Loss=0.00013 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.936 | L2-Norm(final)=14.879 | 4517.8 samples/s | 70.6 steps/s
[Step=21950 Epoch=84.1] | Loss=0.00012 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.920 | L2-Norm(final)=14.879 | 4514.4 samples/s | 70.5 steps/s
[Step=22000 Epoch=84.3] | Loss=0.00012 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.904 | L2-Norm(final)=14.880 | 4489.7 samples/s | 70.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step22000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=77.0] | Loss=0.00247 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.358 | L2-Norm(final)=13.765 | 4295.8 samples/s | 67.1 steps/s
[Step=20050 Epoch=77.2] | Loss=0.00270 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.356 | L2-Norm(final)=13.776 | 5057.9 samples/s | 79.0 steps/s
[Step=20100 Epoch=77.4] | Loss=0.00294 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=13.787 | 5119.1 samples/s | 80.0 steps/s
[Step=20150 Epoch=77.6] | Loss=0.00312 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=13.797 | 5141.7 samples/s | 80.3 steps/s
[Step=20200 Epoch=77.8] | Loss=0.00302 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=13.810 | 5149.7 samples/s | 80.5 steps/s
[Step=20250 Epoch=78.0] | Loss=0.00288 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=13.823 | 6885.1 samples/s | 107.6 steps/s
[Step=20300 Epoch=78.1] | Loss=0.00291 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=13.837 | 2043.7 samples/s | 31.9 steps/s
[Step=20350 Epoch=78.3] | Loss=0.00295 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=13.850 | 5216.8 samples/s | 81.5 steps/s
[Step=20400 Epoch=78.5] | Loss=0.00293 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=13.863 | 5128.4 samples/s | 80.1 steps/s
[Step=20450 Epoch=78.7] | Loss=0.00286 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=13.875 | 5219.2 samples/s | 81.5 steps/s
[Step=20500 Epoch=78.9] | Loss=0.00289 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=13.888 | 5889.0 samples/s | 92.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=78.9] | Loss=0.00129 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.355 | L2-Norm(final)=14.012 | 4235.2 samples/s | 66.2 steps/s
[Step=20550 Epoch=79.1] | Loss=0.00099 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.338 | L2-Norm(final)=14.024 | 4351.0 samples/s | 68.0 steps/s
[Step=20600 Epoch=79.3] | Loss=0.00104 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.326 | L2-Norm(final)=14.031 | 4708.2 samples/s | 73.6 steps/s
[Step=20650 Epoch=79.5] | Loss=0.00074 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.317 | L2-Norm(final)=14.035 | 4588.0 samples/s | 71.7 steps/s
[Step=20700 Epoch=79.7] | Loss=0.00061 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.304 | L2-Norm(final)=14.039 | 4675.0 samples/s | 73.0 steps/s
[Step=20750 Epoch=79.9] | Loss=0.00050 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.290 | L2-Norm(final)=14.042 | 5724.6 samples/s | 89.4 steps/s
[Step=20800 Epoch=80.1] | Loss=0.00043 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.276 | L2-Norm(final)=14.045 | 1952.0 samples/s | 30.5 steps/s
[Step=20850 Epoch=80.3] | Loss=0.00037 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.261 | L2-Norm(final)=14.047 | 4480.7 samples/s | 70.0 steps/s
[Step=20900 Epoch=80.5] | Loss=0.00032 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.246 | L2-Norm(final)=14.049 | 4567.6 samples/s | 71.4 steps/s
[Step=20950 Epoch=80.6] | Loss=0.00029 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.230 | L2-Norm(final)=14.050 | 4473.7 samples/s | 69.9 steps/s
[Step=21000 Epoch=80.8] | Loss=0.00026 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.215 | L2-Norm(final)=14.052 | 5122.2 samples/s | 80.0 steps/s
[Step=21050 Epoch=81.0] | Loss=0.00024 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.200 | L2-Norm(final)=14.053 | 2055.7 samples/s | 32.1 steps/s
[Step=21100 Epoch=81.2] | Loss=0.00022 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.184 | L2-Norm(final)=14.054 | 4484.1 samples/s | 70.1 steps/s
[Step=21150 Epoch=81.4] | Loss=0.00020 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.169 | L2-Norm(final)=14.055 | 4547.3 samples/s | 71.1 steps/s
[Step=21200 Epoch=81.6] | Loss=0.00019 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.154 | L2-Norm(final)=14.056 | 4589.9 samples/s | 71.7 steps/s
[Step=21250 Epoch=81.8] | Loss=0.00018 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.139 | L2-Norm(final)=14.057 | 4565.1 samples/s | 71.3 steps/s
[Step=21300 Epoch=82.0] | Loss=0.00016 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.124 | L2-Norm(final)=14.058 | 2117.4 samples/s | 33.1 steps/s
[Step=21350 Epoch=82.2] | Loss=0.00016 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.109 | L2-Norm(final)=14.058 | 4563.4 samples/s | 71.3 steps/s
[Step=21400 Epoch=82.4] | Loss=0.00015 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.094 | L2-Norm(final)=14.059 | 4475.2 samples/s | 69.9 steps/s
[Step=21450 Epoch=82.6] | Loss=0.00014 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.079 | L2-Norm(final)=14.060 | 4620.3 samples/s | 72.2 steps/s
[Step=21500 Epoch=82.8] | Loss=0.00013 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.064 | L2-Norm(final)=14.060 | 4495.3 samples/s | 70.2 steps/s
[Step=21550 Epoch=83.0] | Loss=0.00013 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.049 | L2-Norm(final)=14.061 | 2146.8 samples/s | 33.5 steps/s
[Step=21600 Epoch=83.1] | Loss=0.00012 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.034 | L2-Norm(final)=14.062 | 4743.5 samples/s | 74.1 steps/s
[Step=21650 Epoch=83.3] | Loss=0.00012 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.020 | L2-Norm(final)=14.062 | 4545.3 samples/s | 71.0 steps/s
[Step=21700 Epoch=83.5] | Loss=0.00011 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.005 | L2-Norm(final)=14.063 | 4585.9 samples/s | 71.7 steps/s
[Step=21750 Epoch=83.7] | Loss=0.00011 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.990 | L2-Norm(final)=14.063 | 4520.2 samples/s | 70.6 steps/s
[Step=21800 Epoch=83.9] | Loss=0.00010 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.975 | L2-Norm(final)=14.064 | 6528.6 samples/s | 102.0 steps/s
[Step=21850 Epoch=84.1] | Loss=0.00010 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=14.064 | 1894.5 samples/s | 29.6 steps/s
[Step=21900 Epoch=84.3] | Loss=0.00010 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.946 | L2-Norm(final)=14.065 | 4589.1 samples/s | 71.7 steps/s
[Step=21950 Epoch=84.5] | Loss=0.00009 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.931 | L2-Norm(final)=14.065 | 4496.3 samples/s | 70.3 steps/s
[Step=22000 Epoch=84.7] | Loss=0.00009 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.916 | L2-Norm(final)=14.066 | 4524.8 samples/s | 70.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step22000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07967 | acc=0.9659 | tpr=0.9821 | fpr=0.0691 | 4528.8 samples/s | 17.7 steps/s
Avg test loss: 0.07590, Avg test acc: 0.96638, Avg tpr: 0.98182, Avg fpr: 0.06756, total FA: 527

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06171 | acc=0.9688 | tpr=0.9758 | fpr=0.0466 | 4455.8 samples/s | 17.4 steps/s
Avg test loss: 0.06199, Avg test acc: 0.96731, Avg tpr: 0.97406, Avg fpr: 0.04756, total FA: 371

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.17275 | acc=0.3129 | tpr=0.0097 | fpr=0.0287 | 4599.0 samples/s | 18.0 steps/s
Avg test loss: 6.19022, Avg test acc: 0.30952, Avg tpr: 0.00968, Avg fpr: 0.03102, total FA: 242

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.17240 | acc=0.3116 | tpr=0.0106 | fpr=0.0347 | 4411.2 samples/s | 17.2 steps/s
Avg test loss: 7.18975, Avg test acc: 0.30892, Avg tpr: 0.01119, Avg fpr: 0.03628, total FA: 283

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.29455 | acc=0.0915 | tpr=0.7743 | fpr=0.9208 | 4411.4 samples/s | 17.2 steps/s
[Step= 100] | Loss=7.24215 | acc=0.0924 | tpr=0.7846 | fpr=0.9205 | 8517.9 samples/s | 33.3 steps/s
[Step= 150] | Loss=7.24335 | acc=0.0923 | tpr=0.7882 | fpr=0.9205 | 8373.8 samples/s | 32.7 steps/s
[Step= 200] | Loss=7.23902 | acc=0.0913 | tpr=0.7880 | fpr=0.9214 | 8480.4 samples/s | 33.1 steps/s
[Step= 250] | Loss=7.24639 | acc=0.0908 | tpr=0.7904 | fpr=0.9219 | 8496.7 samples/s | 33.2 steps/s
[Step= 300] | Loss=7.24403 | acc=0.0903 | tpr=0.7913 | fpr=0.9224 | 8303.8 samples/s | 32.4 steps/s
[Step= 350] | Loss=7.24022 | acc=0.0902 | tpr=0.7896 | fpr=0.9224 | 8418.4 samples/s | 32.9 steps/s
[Step= 400] | Loss=7.24055 | acc=0.0906 | tpr=0.7877 | fpr=0.9221 | 8587.8 samples/s | 33.5 steps/s
[Step= 450] | Loss=7.24445 | acc=0.0907 | tpr=0.7877 | fpr=0.9220 | 8326.8 samples/s | 32.5 steps/s
[Step= 500] | Loss=7.24455 | acc=0.0907 | tpr=0.7859 | fpr=0.9218 | 8229.4 samples/s | 32.1 steps/s
[Step= 550] | Loss=7.25019 | acc=0.0905 | tpr=0.7847 | fpr=0.9221 | 15481.4 samples/s | 60.5 steps/s
Avg test loss: 7.25042, Avg test acc: 0.09048, Avg tpr: 0.78526, Avg fpr: 0.92215, total FA: 128038

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.12374 | acc=0.1349 | tpr=0.7611 | fpr=0.8763 | 4458.6 samples/s | 17.4 steps/s
[Step= 100] | Loss=6.09182 | acc=0.1351 | tpr=0.7655 | fpr=0.8766 | 8744.6 samples/s | 34.2 steps/s
[Step= 150] | Loss=6.08326 | acc=0.1344 | tpr=0.7651 | fpr=0.8772 | 8287.8 samples/s | 32.4 steps/s
[Step= 200] | Loss=6.08325 | acc=0.1343 | tpr=0.7617 | fpr=0.8771 | 8530.4 samples/s | 33.3 steps/s
[Step= 250] | Loss=6.08970 | acc=0.1338 | tpr=0.7633 | fpr=0.8776 | 8312.4 samples/s | 32.5 steps/s
[Step= 300] | Loss=6.08816 | acc=0.1329 | tpr=0.7629 | fpr=0.8786 | 8540.1 samples/s | 33.4 steps/s
[Step= 350] | Loss=6.08514 | acc=0.1318 | tpr=0.7639 | fpr=0.8797 | 8414.6 samples/s | 32.9 steps/s
[Step= 400] | Loss=6.08570 | acc=0.1322 | tpr=0.7620 | fpr=0.8792 | 8443.6 samples/s | 33.0 steps/s
[Step= 450] | Loss=6.09083 | acc=0.1324 | tpr=0.7644 | fpr=0.8791 | 8799.1 samples/s | 34.4 steps/s
[Step= 500] | Loss=6.09078 | acc=0.1322 | tpr=0.7674 | fpr=0.8793 | 7846.5 samples/s | 30.7 steps/s
[Step= 550] | Loss=6.09504 | acc=0.1320 | tpr=0.7648 | fpr=0.8795 | 15293.2 samples/s | 59.7 steps/s
Avg test loss: 6.09570, Avg test acc: 0.13196, Avg tpr: 0.76506, Avg fpr: 0.87955, total FA: 122124

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12126 | acc=0.9826 | tpr=0.9381 | fpr=0.0166 | 4407.9 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.12915 | acc=0.9822 | tpr=0.9467 | fpr=0.0171 | 8328.6 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.13663 | acc=0.9814 | tpr=0.9496 | fpr=0.0180 | 8472.8 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.13768 | acc=0.9814 | tpr=0.9519 | fpr=0.0180 | 8886.1 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.13542 | acc=0.9815 | tpr=0.9502 | fpr=0.0179 | 8263.2 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.13681 | acc=0.9814 | tpr=0.9527 | fpr=0.0181 | 8437.8 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.13838 | acc=0.9811 | tpr=0.9518 | fpr=0.0184 | 8896.9 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.13963 | acc=0.9810 | tpr=0.9513 | fpr=0.0184 | 8548.0 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.14230 | acc=0.9807 | tpr=0.9503 | fpr=0.0188 | 8406.8 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.14201 | acc=0.9807 | tpr=0.9507 | fpr=0.0187 | 8670.2 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.14107 | acc=0.9809 | tpr=0.9503 | fpr=0.0186 | 14862.1 samples/s | 58.1 steps/s
Avg test loss: 0.14070, Avg test acc: 0.98089, Avg tpr: 0.95048, Avg fpr: 0.01855, total FA: 2576

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11388 | acc=0.9838 | tpr=0.9425 | fpr=0.0155 | 4421.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.12318 | acc=0.9829 | tpr=0.9574 | fpr=0.0166 | 8646.1 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.12961 | acc=0.9821 | tpr=0.9625 | fpr=0.0176 | 8557.1 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.13081 | acc=0.9822 | tpr=0.9650 | fpr=0.0175 | 8341.0 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.12865 | acc=0.9822 | tpr=0.9624 | fpr=0.0174 | 8601.3 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.13052 | acc=0.9821 | tpr=0.9636 | fpr=0.0175 | 8431.1 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.13217 | acc=0.9819 | tpr=0.9624 | fpr=0.0178 | 8450.4 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.13337 | acc=0.9817 | tpr=0.9612 | fpr=0.0179 | 9185.5 samples/s | 35.9 steps/s
[Step= 450] | Loss=0.13587 | acc=0.9815 | tpr=0.9611 | fpr=0.0181 | 7605.1 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.13559 | acc=0.9816 | tpr=0.9608 | fpr=0.0181 | 8558.1 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.13478 | acc=0.9816 | tpr=0.9590 | fpr=0.0180 | 15762.4 samples/s | 61.6 steps/s
Avg test loss: 0.13447, Avg test acc: 0.98165, Avg tpr: 0.95919, Avg fpr: 0.01794, total FA: 2491

server round 11/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=22001 Epoch=42.9] | Loss=0.05010 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.906 | L2-Norm(final)=12.725 | 4554.9 samples/s | 71.2 steps/s
[Step=22050 Epoch=43.0] | Loss=0.02746 | Reg=0.00193 | acc=0.9531 | L2-Norm=13.910 | L2-Norm(final)=12.732 | 4797.2 samples/s | 75.0 steps/s
[Step=22100 Epoch=43.1] | Loss=0.02714 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.911 | L2-Norm(final)=12.746 | 5465.5 samples/s | 85.4 steps/s
[Step=22150 Epoch=43.2] | Loss=0.02692 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.911 | L2-Norm(final)=12.762 | 5461.6 samples/s | 85.3 steps/s
[Step=22200 Epoch=43.3] | Loss=0.02629 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.912 | L2-Norm(final)=12.776 | 5543.1 samples/s | 86.6 steps/s
[Step=22250 Epoch=43.4] | Loss=0.02607 | Reg=0.00194 | acc=0.9531 | L2-Norm=13.912 | L2-Norm(final)=12.791 | 5499.6 samples/s | 85.9 steps/s
[Step=22300 Epoch=43.5] | Loss=0.02551 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.912 | L2-Norm(final)=12.806 | 5480.3 samples/s | 85.6 steps/s
[Step=22350 Epoch=43.6] | Loss=0.02532 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.912 | L2-Norm(final)=12.820 | 5578.1 samples/s | 87.2 steps/s
[Step=22400 Epoch=43.7] | Loss=0.02539 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.912 | L2-Norm(final)=12.834 | 5488.6 samples/s | 85.8 steps/s
[Step=22450 Epoch=43.8] | Loss=0.02567 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.912 | L2-Norm(final)=12.846 | 5521.6 samples/s | 86.3 steps/s
[Step=22500 Epoch=43.9] | Loss=0.02557 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.912 | L2-Norm(final)=12.858 | 6873.1 samples/s | 107.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=43.9] | Loss=0.00312 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.912 | L2-Norm(final)=12.978 | 4180.2 samples/s | 65.3 steps/s
[Step=22550 Epoch=44.0] | Loss=0.02466 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.962 | L2-Norm(final)=12.985 | 4596.4 samples/s | 71.8 steps/s
[Step=22600 Epoch=44.1] | Loss=0.02471 | Reg=0.00196 | acc=0.9688 | L2-Norm=14.010 | L2-Norm(final)=12.980 | 4942.0 samples/s | 77.2 steps/s
[Step=22650 Epoch=44.2] | Loss=0.02253 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.045 | L2-Norm(final)=12.976 | 4808.4 samples/s | 75.1 steps/s
[Step=22700 Epoch=44.3] | Loss=0.02341 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.072 | L2-Norm(final)=12.974 | 4836.6 samples/s | 75.6 steps/s
[Step=22750 Epoch=44.4] | Loss=0.02375 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.097 | L2-Norm(final)=12.972 | 4812.8 samples/s | 75.2 steps/s
[Step=22800 Epoch=44.5] | Loss=0.02327 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.120 | L2-Norm(final)=12.970 | 4799.1 samples/s | 75.0 steps/s
[Step=22850 Epoch=44.6] | Loss=0.02316 | Reg=0.00200 | acc=0.9219 | L2-Norm=14.139 | L2-Norm(final)=12.967 | 4798.3 samples/s | 75.0 steps/s
[Step=22900 Epoch=44.7] | Loss=0.02317 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.158 | L2-Norm(final)=12.965 | 4887.0 samples/s | 76.4 steps/s
[Step=22950 Epoch=44.8] | Loss=0.02327 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.175 | L2-Norm(final)=12.962 | 4712.4 samples/s | 73.6 steps/s
[Step=23000 Epoch=44.9] | Loss=0.02291 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.191 | L2-Norm(final)=12.959 | 5852.3 samples/s | 91.4 steps/s
[Step=23050 Epoch=45.0] | Loss=0.02202 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.205 | L2-Norm(final)=12.957 | 1930.5 samples/s | 30.2 steps/s
[Step=23100 Epoch=45.1] | Loss=0.02125 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.218 | L2-Norm(final)=12.956 | 4721.8 samples/s | 73.8 steps/s
[Step=23150 Epoch=45.2] | Loss=0.02074 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.230 | L2-Norm(final)=12.956 | 4885.6 samples/s | 76.3 steps/s
[Step=23200 Epoch=45.2] | Loss=0.02030 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.241 | L2-Norm(final)=12.956 | 4783.2 samples/s | 74.7 steps/s
[Step=23250 Epoch=45.3] | Loss=0.01994 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.252 | L2-Norm(final)=12.955 | 4845.3 samples/s | 75.7 steps/s
[Step=23300 Epoch=45.4] | Loss=0.01946 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.262 | L2-Norm(final)=12.955 | 4762.8 samples/s | 74.4 steps/s
[Step=23350 Epoch=45.5] | Loss=0.01921 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.272 | L2-Norm(final)=12.955 | 4726.7 samples/s | 73.9 steps/s
[Step=23400 Epoch=45.6] | Loss=0.01901 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.282 | L2-Norm(final)=12.955 | 4778.0 samples/s | 74.7 steps/s
[Step=23450 Epoch=45.7] | Loss=0.01889 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.292 | L2-Norm(final)=12.955 | 4806.0 samples/s | 75.1 steps/s
[Step=23500 Epoch=45.8] | Loss=0.01867 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.302 | L2-Norm(final)=12.954 | 5059.8 samples/s | 79.1 steps/s
[Step=23550 Epoch=45.9] | Loss=0.01850 | Reg=0.00205 | acc=0.9688 | L2-Norm=14.312 | L2-Norm(final)=12.954 | 2123.2 samples/s | 33.2 steps/s
[Step=23600 Epoch=46.0] | Loss=0.01810 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.321 | L2-Norm(final)=12.954 | 4831.9 samples/s | 75.5 steps/s
[Step=23650 Epoch=46.1] | Loss=0.01787 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.330 | L2-Norm(final)=12.954 | 4874.3 samples/s | 76.2 steps/s
[Step=23700 Epoch=46.2] | Loss=0.01755 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.339 | L2-Norm(final)=12.954 | 4942.1 samples/s | 77.2 steps/s
[Step=23750 Epoch=46.3] | Loss=0.01740 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.348 | L2-Norm(final)=12.955 | 4906.1 samples/s | 76.7 steps/s
[Step=23800 Epoch=46.4] | Loss=0.01725 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.357 | L2-Norm(final)=12.955 | 4964.7 samples/s | 77.6 steps/s
[Step=23850 Epoch=46.5] | Loss=0.01711 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.365 | L2-Norm(final)=12.955 | 4873.0 samples/s | 76.1 steps/s
[Step=23900 Epoch=46.6] | Loss=0.01689 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.373 | L2-Norm(final)=12.955 | 5033.2 samples/s | 78.6 steps/s
[Step=23950 Epoch=46.7] | Loss=0.01685 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.381 | L2-Norm(final)=12.955 | 4842.8 samples/s | 75.7 steps/s
[Step=24000 Epoch=46.8] | Loss=0.01675 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.389 | L2-Norm(final)=12.955 | 4940.9 samples/s | 77.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step24000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=22001 Epoch=43.0] | Loss=0.01583 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.906 | L2-Norm(final)=12.938 | 4400.6 samples/s | 68.8 steps/s
[Step=22050 Epoch=43.1] | Loss=0.02244 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.906 | L2-Norm(final)=12.944 | 5639.1 samples/s | 88.1 steps/s
[Step=22100 Epoch=43.2] | Loss=0.02501 | Reg=0.00193 | acc=0.9531 | L2-Norm=13.906 | L2-Norm(final)=12.955 | 5317.5 samples/s | 83.1 steps/s
[Step=22150 Epoch=43.3] | Loss=0.02417 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.906 | L2-Norm(final)=12.966 | 5475.3 samples/s | 85.6 steps/s
[Step=22200 Epoch=43.4] | Loss=0.02417 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.906 | L2-Norm(final)=12.977 | 5504.7 samples/s | 86.0 steps/s
[Step=22250 Epoch=43.5] | Loss=0.02427 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.906 | L2-Norm(final)=12.989 | 5640.3 samples/s | 88.1 steps/s
[Step=22300 Epoch=43.6] | Loss=0.02446 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.906 | L2-Norm(final)=13.000 | 5407.6 samples/s | 84.5 steps/s
[Step=22350 Epoch=43.7] | Loss=0.02413 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.906 | L2-Norm(final)=13.011 | 5494.3 samples/s | 85.8 steps/s
[Step=22400 Epoch=43.8] | Loss=0.02377 | Reg=0.00193 | acc=0.9531 | L2-Norm=13.906 | L2-Norm(final)=13.023 | 5486.9 samples/s | 85.7 steps/s
[Step=22450 Epoch=43.9] | Loss=0.02333 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.906 | L2-Norm(final)=13.037 | 5494.4 samples/s | 85.9 steps/s
[Step=22500 Epoch=44.0] | Loss=0.02390 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.906 | L2-Norm(final)=13.050 | 6942.7 samples/s | 108.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=44.0] | Loss=0.02153 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.906 | L2-Norm(final)=13.181 | 4376.3 samples/s | 68.4 steps/s
[Step=22550 Epoch=44.1] | Loss=0.02581 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.942 | L2-Norm(final)=13.186 | 4768.5 samples/s | 74.5 steps/s
[Step=22600 Epoch=44.2] | Loss=0.02506 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.985 | L2-Norm(final)=13.188 | 4793.4 samples/s | 74.9 steps/s
[Step=22650 Epoch=44.3] | Loss=0.02562 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.021 | L2-Norm(final)=13.186 | 4799.0 samples/s | 75.0 steps/s
[Step=22700 Epoch=44.4] | Loss=0.02444 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.055 | L2-Norm(final)=13.181 | 4740.2 samples/s | 74.1 steps/s
[Step=22750 Epoch=44.5] | Loss=0.02395 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.085 | L2-Norm(final)=13.178 | 4786.5 samples/s | 74.8 steps/s
[Step=22800 Epoch=44.6] | Loss=0.02316 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.111 | L2-Norm(final)=13.177 | 4830.5 samples/s | 75.5 steps/s
[Step=22850 Epoch=44.7] | Loss=0.02304 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.136 | L2-Norm(final)=13.175 | 4851.1 samples/s | 75.8 steps/s
[Step=22900 Epoch=44.8] | Loss=0.02276 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.158 | L2-Norm(final)=13.174 | 4805.0 samples/s | 75.1 steps/s
[Step=22950 Epoch=44.9] | Loss=0.02266 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.179 | L2-Norm(final)=13.172 | 4939.5 samples/s | 77.2 steps/s
[Step=23000 Epoch=45.0] | Loss=0.02328 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.197 | L2-Norm(final)=13.169 | 6068.5 samples/s | 94.8 steps/s
[Step=23050 Epoch=45.1] | Loss=0.02251 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.216 | L2-Norm(final)=13.167 | 2046.8 samples/s | 32.0 steps/s
[Step=23100 Epoch=45.2] | Loss=0.02168 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.232 | L2-Norm(final)=13.165 | 4756.5 samples/s | 74.3 steps/s
[Step=23150 Epoch=45.3] | Loss=0.02120 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.248 | L2-Norm(final)=13.164 | 4706.6 samples/s | 73.5 steps/s
[Step=23200 Epoch=45.4] | Loss=0.02116 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.262 | L2-Norm(final)=13.163 | 4757.5 samples/s | 74.3 steps/s
[Step=23250 Epoch=45.5] | Loss=0.02052 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.275 | L2-Norm(final)=13.162 | 4899.7 samples/s | 76.6 steps/s
[Step=23300 Epoch=45.6] | Loss=0.02007 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.287 | L2-Norm(final)=13.161 | 4937.5 samples/s | 77.1 steps/s
[Step=23350 Epoch=45.6] | Loss=0.01962 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.298 | L2-Norm(final)=13.160 | 4858.1 samples/s | 75.9 steps/s
[Step=23400 Epoch=45.7] | Loss=0.01944 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.309 | L2-Norm(final)=13.159 | 4854.1 samples/s | 75.8 steps/s
[Step=23450 Epoch=45.8] | Loss=0.01925 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.319 | L2-Norm(final)=13.158 | 4814.8 samples/s | 75.2 steps/s
[Step=23500 Epoch=45.9] | Loss=0.01899 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.329 | L2-Norm(final)=13.158 | 5149.8 samples/s | 80.5 steps/s
[Step=23550 Epoch=46.0] | Loss=0.01864 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.338 | L2-Norm(final)=13.157 | 2159.4 samples/s | 33.7 steps/s
[Step=23600 Epoch=46.1] | Loss=0.01825 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.347 | L2-Norm(final)=13.157 | 4856.5 samples/s | 75.9 steps/s
[Step=23650 Epoch=46.2] | Loss=0.01788 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.356 | L2-Norm(final)=13.157 | 4871.5 samples/s | 76.1 steps/s
[Step=23700 Epoch=46.3] | Loss=0.01758 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.364 | L2-Norm(final)=13.158 | 4902.9 samples/s | 76.6 steps/s
[Step=23750 Epoch=46.4] | Loss=0.01739 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.372 | L2-Norm(final)=13.157 | 4934.0 samples/s | 77.1 steps/s
[Step=23800 Epoch=46.5] | Loss=0.01722 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.379 | L2-Norm(final)=13.157 | 4905.3 samples/s | 76.6 steps/s
[Step=23850 Epoch=46.6] | Loss=0.01719 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.387 | L2-Norm(final)=13.157 | 4901.8 samples/s | 76.6 steps/s
[Step=23900 Epoch=46.7] | Loss=0.01694 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.395 | L2-Norm(final)=13.157 | 4886.8 samples/s | 76.4 steps/s
[Step=23950 Epoch=46.8] | Loss=0.01681 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.402 | L2-Norm(final)=13.158 | 4784.3 samples/s | 74.8 steps/s
[Step=24000 Epoch=46.9] | Loss=0.01663 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.410 | L2-Norm(final)=13.158 | 4747.0 samples/s | 74.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step24000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=22001 Epoch=84.3] | Loss=0.00772 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.906 | L2-Norm(final)=14.891 | 4261.5 samples/s | 66.6 steps/s
[Step=22050 Epoch=84.5] | Loss=0.00163 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.901 | L2-Norm(final)=14.902 | 4932.4 samples/s | 77.1 steps/s
[Step=22100 Epoch=84.7] | Loss=0.00142 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=14.920 | 5146.5 samples/s | 80.4 steps/s
[Step=22150 Epoch=84.9] | Loss=0.00116 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=14.933 | 5212.2 samples/s | 81.4 steps/s
[Step=22200 Epoch=85.1] | Loss=0.00139 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=14.941 | 5224.3 samples/s | 81.6 steps/s
[Step=22250 Epoch=85.3] | Loss=0.00143 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=14.947 | 6799.3 samples/s | 106.2 steps/s
[Step=22300 Epoch=85.4] | Loss=0.00139 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=14.951 | 2087.2 samples/s | 32.6 steps/s
[Step=22350 Epoch=85.6] | Loss=0.00137 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=14.956 | 5053.2 samples/s | 79.0 steps/s
[Step=22400 Epoch=85.8] | Loss=0.00135 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=14.962 | 5111.2 samples/s | 79.9 steps/s
[Step=22450 Epoch=86.0] | Loss=0.00139 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=14.968 | 5238.2 samples/s | 81.8 steps/s
[Step=22500 Epoch=86.2] | Loss=0.00142 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=14.973 | 5680.3 samples/s | 88.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=86.2] | Loss=0.01176 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.900 | L2-Norm(final)=15.032 | 4288.9 samples/s | 67.0 steps/s
[Step=22550 Epoch=86.4] | Loss=0.00108 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.916 | L2-Norm(final)=15.040 | 4401.0 samples/s | 68.8 steps/s
[Step=22600 Epoch=86.6] | Loss=0.00602 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.987 | L2-Norm(final)=15.034 | 4728.9 samples/s | 73.9 steps/s
[Step=22650 Epoch=86.8] | Loss=0.00449 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.063 | L2-Norm(final)=15.024 | 4672.9 samples/s | 73.0 steps/s
[Step=22700 Epoch=87.0] | Loss=0.00389 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.105 | L2-Norm(final)=15.021 | 4638.9 samples/s | 72.5 steps/s
[Step=22750 Epoch=87.2] | Loss=0.00316 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.127 | L2-Norm(final)=15.018 | 5808.3 samples/s | 90.8 steps/s
[Step=22800 Epoch=87.4] | Loss=0.00264 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.138 | L2-Norm(final)=15.017 | 1957.4 samples/s | 30.6 steps/s
[Step=22850 Epoch=87.6] | Loss=0.00227 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.142 | L2-Norm(final)=15.017 | 4482.7 samples/s | 70.0 steps/s
[Step=22900 Epoch=87.7] | Loss=0.00199 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.143 | L2-Norm(final)=15.017 | 4530.3 samples/s | 70.8 steps/s
[Step=22950 Epoch=87.9] | Loss=0.00177 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.140 | L2-Norm(final)=15.017 | 4521.0 samples/s | 70.6 steps/s
[Step=23000 Epoch=88.1] | Loss=0.00161 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.136 | L2-Norm(final)=15.017 | 4987.0 samples/s | 77.9 steps/s
[Step=23050 Epoch=88.3] | Loss=0.00146 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.130 | L2-Norm(final)=15.017 | 2076.9 samples/s | 32.5 steps/s
[Step=23100 Epoch=88.5] | Loss=0.00134 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.125 | L2-Norm(final)=15.017 | 4431.6 samples/s | 69.2 steps/s
[Step=23150 Epoch=88.7] | Loss=0.00124 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.118 | L2-Norm(final)=15.018 | 4537.8 samples/s | 70.9 steps/s
[Step=23200 Epoch=88.9] | Loss=0.00115 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.110 | L2-Norm(final)=15.018 | 4480.1 samples/s | 70.0 steps/s
[Step=23250 Epoch=89.1] | Loss=0.00108 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.102 | L2-Norm(final)=15.018 | 4524.8 samples/s | 70.7 steps/s
[Step=23300 Epoch=89.3] | Loss=0.00101 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.094 | L2-Norm(final)=15.019 | 2140.9 samples/s | 33.5 steps/s
[Step=23350 Epoch=89.5] | Loss=0.00095 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.085 | L2-Norm(final)=15.019 | 4754.7 samples/s | 74.3 steps/s
[Step=23400 Epoch=89.7] | Loss=0.00090 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.075 | L2-Norm(final)=15.019 | 4602.6 samples/s | 71.9 steps/s
[Step=23450 Epoch=89.9] | Loss=0.00085 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.066 | L2-Norm(final)=15.020 | 4647.9 samples/s | 72.6 steps/s
[Step=23500 Epoch=90.0] | Loss=0.00081 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.057 | L2-Norm(final)=15.020 | 4639.5 samples/s | 72.5 steps/s
[Step=23550 Epoch=90.2] | Loss=0.00077 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.047 | L2-Norm(final)=15.020 | 2133.4 samples/s | 33.3 steps/s
[Step=23600 Epoch=90.4] | Loss=0.00073 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.037 | L2-Norm(final)=15.021 | 4506.4 samples/s | 70.4 steps/s
[Step=23650 Epoch=90.6] | Loss=0.00070 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.027 | L2-Norm(final)=15.021 | 4493.3 samples/s | 70.2 steps/s
[Step=23700 Epoch=90.8] | Loss=0.00067 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.017 | L2-Norm(final)=15.021 | 4499.2 samples/s | 70.3 steps/s
[Step=23750 Epoch=91.0] | Loss=0.00065 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.006 | L2-Norm(final)=15.022 | 4552.7 samples/s | 71.1 steps/s
[Step=23800 Epoch=91.2] | Loss=0.00062 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.996 | L2-Norm(final)=15.022 | 6056.4 samples/s | 94.6 steps/s
[Step=23850 Epoch=91.4] | Loss=0.00060 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.986 | L2-Norm(final)=15.022 | 1885.5 samples/s | 29.5 steps/s
[Step=23900 Epoch=91.6] | Loss=0.00058 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.975 | L2-Norm(final)=15.023 | 4553.9 samples/s | 71.2 steps/s
[Step=23950 Epoch=91.8] | Loss=0.00056 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.965 | L2-Norm(final)=15.023 | 4455.5 samples/s | 69.6 steps/s
[Step=24000 Epoch=92.0] | Loss=0.00054 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.954 | L2-Norm(final)=15.023 | 4572.1 samples/s | 71.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step24000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=22001 Epoch=84.7] | Loss=0.00003 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.906 | L2-Norm(final)=14.082 | 4573.9 samples/s | 71.5 steps/s
[Step=22050 Epoch=84.9] | Loss=0.00165 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.901 | L2-Norm(final)=14.092 | 4522.6 samples/s | 70.7 steps/s
[Step=22100 Epoch=85.1] | Loss=0.00177 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.901 | L2-Norm(final)=14.107 | 5240.4 samples/s | 81.9 steps/s
[Step=22150 Epoch=85.3] | Loss=0.00157 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=14.124 | 5260.9 samples/s | 82.2 steps/s
[Step=22200 Epoch=85.5] | Loss=0.00140 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=14.140 | 5174.0 samples/s | 80.8 steps/s
[Step=22250 Epoch=85.6] | Loss=0.00137 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=14.154 | 6821.3 samples/s | 106.6 steps/s
[Step=22300 Epoch=85.8] | Loss=0.00140 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=14.168 | 2056.0 samples/s | 32.1 steps/s
[Step=22350 Epoch=86.0] | Loss=0.00141 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=14.181 | 5348.7 samples/s | 83.6 steps/s
[Step=22400 Epoch=86.2] | Loss=0.00136 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=14.195 | 5258.3 samples/s | 82.2 steps/s
[Step=22450 Epoch=86.4] | Loss=0.00133 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=14.208 | 5220.3 samples/s | 81.6 steps/s
[Step=22500 Epoch=86.6] | Loss=0.00130 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=14.222 | 6108.2 samples/s | 95.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=86.6] | Loss=0.00024 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=14.353 | 4219.6 samples/s | 65.9 steps/s
[Step=22550 Epoch=86.8] | Loss=0.00356 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.921 | L2-Norm(final)=14.357 | 4463.3 samples/s | 69.7 steps/s
[Step=22600 Epoch=87.0] | Loss=0.00505 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.997 | L2-Norm(final)=14.349 | 4593.5 samples/s | 71.8 steps/s
[Step=22650 Epoch=87.2] | Loss=0.00455 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.044 | L2-Norm(final)=14.340 | 4455.1 samples/s | 69.6 steps/s
[Step=22700 Epoch=87.4] | Loss=0.00396 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.078 | L2-Norm(final)=14.335 | 4514.3 samples/s | 70.5 steps/s
[Step=22750 Epoch=87.6] | Loss=0.00406 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.109 | L2-Norm(final)=14.329 | 5712.5 samples/s | 89.3 steps/s
[Step=22800 Epoch=87.8] | Loss=0.00340 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.135 | L2-Norm(final)=14.326 | 1946.6 samples/s | 30.4 steps/s
[Step=22850 Epoch=88.0] | Loss=0.00294 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.151 | L2-Norm(final)=14.324 | 4600.5 samples/s | 71.9 steps/s
[Step=22900 Epoch=88.2] | Loss=0.00258 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.161 | L2-Norm(final)=14.324 | 4550.3 samples/s | 71.1 steps/s
[Step=22950 Epoch=88.3] | Loss=0.00230 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.166 | L2-Norm(final)=14.323 | 4576.2 samples/s | 71.5 steps/s
[Step=23000 Epoch=88.5] | Loss=0.00207 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.168 | L2-Norm(final)=14.323 | 5038.8 samples/s | 78.7 steps/s
[Step=23050 Epoch=88.7] | Loss=0.00188 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.167 | L2-Norm(final)=14.323 | 2066.8 samples/s | 32.3 steps/s
[Step=23100 Epoch=88.9] | Loss=0.00172 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.165 | L2-Norm(final)=14.323 | 4625.2 samples/s | 72.3 steps/s
[Step=23150 Epoch=89.1] | Loss=0.00159 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.161 | L2-Norm(final)=14.323 | 4512.1 samples/s | 70.5 steps/s
[Step=23200 Epoch=89.3] | Loss=0.00148 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.157 | L2-Norm(final)=14.323 | 4574.6 samples/s | 71.5 steps/s
[Step=23250 Epoch=89.5] | Loss=0.00138 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.151 | L2-Norm(final)=14.323 | 4628.0 samples/s | 72.3 steps/s
[Step=23300 Epoch=89.7] | Loss=0.00129 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.145 | L2-Norm(final)=14.323 | 2144.3 samples/s | 33.5 steps/s
[Step=23350 Epoch=89.9] | Loss=0.00122 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.138 | L2-Norm(final)=14.323 | 4630.7 samples/s | 72.4 steps/s
[Step=23400 Epoch=90.1] | Loss=0.00115 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.131 | L2-Norm(final)=14.323 | 4622.4 samples/s | 72.2 steps/s
[Step=23450 Epoch=90.3] | Loss=0.00109 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.123 | L2-Norm(final)=14.324 | 4647.7 samples/s | 72.6 steps/s
[Step=23500 Epoch=90.5] | Loss=0.00104 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.115 | L2-Norm(final)=14.324 | 4577.1 samples/s | 71.5 steps/s
[Step=23550 Epoch=90.7] | Loss=0.00099 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.107 | L2-Norm(final)=14.324 | 2166.9 samples/s | 33.9 steps/s
[Step=23600 Epoch=90.8] | Loss=0.00094 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.099 | L2-Norm(final)=14.324 | 4674.7 samples/s | 73.0 steps/s
[Step=23650 Epoch=91.0] | Loss=0.00090 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.090 | L2-Norm(final)=14.324 | 4549.7 samples/s | 71.1 steps/s
[Step=23700 Epoch=91.2] | Loss=0.00086 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.081 | L2-Norm(final)=14.324 | 4559.9 samples/s | 71.2 steps/s
[Step=23750 Epoch=91.4] | Loss=0.00083 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.072 | L2-Norm(final)=14.325 | 4578.1 samples/s | 71.5 steps/s
[Step=23800 Epoch=91.6] | Loss=0.00080 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.063 | L2-Norm(final)=14.325 | 6757.1 samples/s | 105.6 steps/s
[Step=23850 Epoch=91.8] | Loss=0.00077 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.054 | L2-Norm(final)=14.325 | 1853.3 samples/s | 29.0 steps/s
[Step=23900 Epoch=92.0] | Loss=0.00074 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.045 | L2-Norm(final)=14.325 | 4464.6 samples/s | 69.8 steps/s
[Step=23950 Epoch=92.2] | Loss=0.00072 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.035 | L2-Norm(final)=14.325 | 4531.5 samples/s | 70.8 steps/s
[Step=24000 Epoch=92.4] | Loss=0.00069 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.026 | L2-Norm(final)=14.326 | 4522.6 samples/s | 70.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06607 | acc=0.9673 | tpr=0.9719 | fpr=0.0429 | 4390.0 samples/s | 17.1 steps/s
Avg test loss: 0.06355, Avg test acc: 0.96743, Avg tpr: 0.97226, Avg fpr: 0.04320, total FA: 337

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07161 | acc=0.9649 | tpr=0.9702 | fpr=0.0466 | 4394.0 samples/s | 17.2 steps/s
Avg test loss: 0.07128, Avg test acc: 0.96594, Avg tpr: 0.97150, Avg fpr: 0.04628, total FA: 361

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.43039 | acc=0.3147 | tpr=0.0046 | fpr=0.0119 | 4416.4 samples/s | 17.3 steps/s
Avg test loss: 7.45520, Avg test acc: 0.31160, Avg tpr: 0.00420, Avg fpr: 0.01231, total FA: 96

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=8.23399 | acc=0.3144 | tpr=0.0104 | fpr=0.0255 | 4559.7 samples/s | 17.8 steps/s
Avg test loss: 8.23576, Avg test acc: 0.31108, Avg tpr: 0.00991, Avg fpr: 0.02654, total FA: 207

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.16414 | acc=0.1065 | tpr=0.7345 | fpr=0.9048 | 4446.1 samples/s | 17.4 steps/s
[Step= 100] | Loss=6.11020 | acc=0.1065 | tpr=0.7313 | fpr=0.9052 | 8828.4 samples/s | 34.5 steps/s
[Step= 150] | Loss=6.11091 | acc=0.1059 | tpr=0.7349 | fpr=0.9057 | 8701.9 samples/s | 34.0 steps/s
[Step= 200] | Loss=6.10917 | acc=0.1060 | tpr=0.7257 | fpr=0.9053 | 8472.1 samples/s | 33.1 steps/s
[Step= 250] | Loss=6.11296 | acc=0.1062 | tpr=0.7293 | fpr=0.9052 | 8188.9 samples/s | 32.0 steps/s
[Step= 300] | Loss=6.11064 | acc=0.1062 | tpr=0.7302 | fpr=0.9052 | 8526.1 samples/s | 33.3 steps/s
[Step= 350] | Loss=6.10985 | acc=0.1061 | tpr=0.7270 | fpr=0.9052 | 8362.5 samples/s | 32.7 steps/s
[Step= 400] | Loss=6.11132 | acc=0.1063 | tpr=0.7265 | fpr=0.9050 | 8375.6 samples/s | 32.7 steps/s
[Step= 450] | Loss=6.11407 | acc=0.1064 | tpr=0.7298 | fpr=0.9049 | 8797.8 samples/s | 34.4 steps/s
[Step= 500] | Loss=6.11202 | acc=0.1066 | tpr=0.7300 | fpr=0.9047 | 8067.8 samples/s | 31.5 steps/s
[Step= 550] | Loss=6.11619 | acc=0.1065 | tpr=0.7282 | fpr=0.9047 | 15877.2 samples/s | 62.0 steps/s
Avg test loss: 6.11667, Avg test acc: 0.10650, Avg tpr: 0.72861, Avg fpr: 0.90481, total FA: 125631

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.34016 | acc=0.1235 | tpr=0.7655 | fpr=0.8880 | 4444.3 samples/s | 17.4 steps/s
[Step= 100] | Loss=6.31011 | acc=0.1252 | tpr=0.7825 | fpr=0.8871 | 8357.9 samples/s | 32.6 steps/s
[Step= 150] | Loss=6.30613 | acc=0.1244 | tpr=0.7767 | fpr=0.8876 | 8811.1 samples/s | 34.4 steps/s
[Step= 200] | Loss=6.29867 | acc=0.1250 | tpr=0.7661 | fpr=0.8867 | 8294.1 samples/s | 32.4 steps/s
[Step= 250] | Loss=6.30921 | acc=0.1247 | tpr=0.7686 | fpr=0.8870 | 8561.9 samples/s | 33.4 steps/s
[Step= 300] | Loss=6.30794 | acc=0.1242 | tpr=0.7702 | fpr=0.8876 | 8140.1 samples/s | 31.8 steps/s
[Step= 350] | Loss=6.30467 | acc=0.1232 | tpr=0.7639 | fpr=0.8884 | 8458.9 samples/s | 33.0 steps/s
[Step= 400] | Loss=6.30641 | acc=0.1234 | tpr=0.7659 | fpr=0.8882 | 8396.4 samples/s | 32.8 steps/s
[Step= 450] | Loss=6.31141 | acc=0.1235 | tpr=0.7687 | fpr=0.8883 | 8862.6 samples/s | 34.6 steps/s
[Step= 500] | Loss=6.30980 | acc=0.1236 | tpr=0.7718 | fpr=0.8881 | 8075.1 samples/s | 31.5 steps/s
[Step= 550] | Loss=6.31518 | acc=0.1235 | tpr=0.7700 | fpr=0.8882 | 15466.9 samples/s | 60.4 steps/s
Avg test loss: 6.31542, Avg test acc: 0.12342, Avg tpr: 0.77021, Avg fpr: 0.88834, total FA: 123344

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13102 | acc=0.9830 | tpr=0.9115 | fpr=0.0157 | 4434.2 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.13611 | acc=0.9825 | tpr=0.9254 | fpr=0.0164 | 9630.0 samples/s | 37.6 steps/s
[Step= 150] | Loss=0.14211 | acc=0.9820 | tpr=0.9337 | fpr=0.0171 | 7921.0 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.14386 | acc=0.9821 | tpr=0.9421 | fpr=0.0171 | 8603.5 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.14181 | acc=0.9824 | tpr=0.9397 | fpr=0.0168 | 8886.5 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.14389 | acc=0.9822 | tpr=0.9418 | fpr=0.0171 | 8091.4 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.14497 | acc=0.9820 | tpr=0.9418 | fpr=0.0173 | 8534.6 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.14681 | acc=0.9817 | tpr=0.9398 | fpr=0.0175 | 8360.6 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.14932 | acc=0.9816 | tpr=0.9406 | fpr=0.0177 | 8554.1 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.14918 | acc=0.9817 | tpr=0.9396 | fpr=0.0176 | 8408.4 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.14821 | acc=0.9818 | tpr=0.9387 | fpr=0.0174 | 15217.1 samples/s | 59.4 steps/s
Avg test loss: 0.14787, Avg test acc: 0.98181, Avg tpr: 0.93859, Avg fpr: 0.01741, total FA: 2417

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16120 | acc=0.9809 | tpr=0.9425 | fpr=0.0185 | 4476.1 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.17579 | acc=0.9803 | tpr=0.9616 | fpr=0.0193 | 8507.1 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.18465 | acc=0.9797 | tpr=0.9654 | fpr=0.0200 | 8237.9 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.18760 | acc=0.9795 | tpr=0.9683 | fpr=0.0203 | 8443.5 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.18555 | acc=0.9795 | tpr=0.9659 | fpr=0.0203 | 8497.5 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.18830 | acc=0.9794 | tpr=0.9680 | fpr=0.0204 | 8293.0 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.19077 | acc=0.9791 | tpr=0.9687 | fpr=0.0207 | 8543.8 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.19317 | acc=0.9789 | tpr=0.9655 | fpr=0.0208 | 8606.9 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.19641 | acc=0.9786 | tpr=0.9625 | fpr=0.0211 | 8177.2 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.19582 | acc=0.9786 | tpr=0.9630 | fpr=0.0211 | 8369.8 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.19424 | acc=0.9787 | tpr=0.9610 | fpr=0.0210 | 15584.3 samples/s | 60.9 steps/s
Avg test loss: 0.19382, Avg test acc: 0.97874, Avg tpr: 0.96078, Avg fpr: 0.02094, total FA: 2907

server round 12/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=24001 Epoch=46.8] | Loss=0.04002 | Reg=0.00190 | acc=0.9531 | L2-Norm=13.789 | L2-Norm(final)=12.949 | 4429.5 samples/s | 69.2 steps/s
[Step=24050 Epoch=46.9] | Loss=0.03176 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.789 | L2-Norm(final)=12.953 | 5157.6 samples/s | 80.6 steps/s
[Step=24100 Epoch=47.0] | Loss=0.03077 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.789 | L2-Norm(final)=12.962 | 5525.2 samples/s | 86.3 steps/s
[Step=24150 Epoch=47.1] | Loss=0.02949 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.789 | L2-Norm(final)=12.974 | 5498.1 samples/s | 85.9 steps/s
[Step=24200 Epoch=47.2] | Loss=0.02954 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.789 | L2-Norm(final)=12.987 | 5529.6 samples/s | 86.4 steps/s
[Step=24250 Epoch=47.3] | Loss=0.02919 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.789 | L2-Norm(final)=13.000 | 5587.9 samples/s | 87.3 steps/s
[Step=24300 Epoch=47.4] | Loss=0.02912 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.789 | L2-Norm(final)=13.013 | 5421.7 samples/s | 84.7 steps/s
[Step=24350 Epoch=47.5] | Loss=0.02940 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.789 | L2-Norm(final)=13.025 | 5495.0 samples/s | 85.9 steps/s
[Step=24400 Epoch=47.6] | Loss=0.02978 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.789 | L2-Norm(final)=13.036 | 5478.3 samples/s | 85.6 steps/s
[Step=24450 Epoch=47.7] | Loss=0.02961 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.789 | L2-Norm(final)=13.048 | 5501.7 samples/s | 86.0 steps/s
[Step=24500 Epoch=47.8] | Loss=0.02961 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.789 | L2-Norm(final)=13.060 | 6883.0 samples/s | 107.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=47.8] | Loss=0.02668 | Reg=0.00190 | acc=0.9531 | L2-Norm=13.789 | L2-Norm(final)=13.187 | 4197.7 samples/s | 65.6 steps/s
[Step=24550 Epoch=47.9] | Loss=0.03054 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.860 | L2-Norm(final)=13.187 | 4605.2 samples/s | 72.0 steps/s
[Step=24600 Epoch=48.0] | Loss=0.02820 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.918 | L2-Norm(final)=13.180 | 4866.5 samples/s | 76.0 steps/s
[Step=24650 Epoch=48.1] | Loss=0.02551 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.957 | L2-Norm(final)=13.175 | 4847.6 samples/s | 75.7 steps/s
[Step=24700 Epoch=48.2] | Loss=0.02475 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.988 | L2-Norm(final)=13.171 | 4894.4 samples/s | 76.5 steps/s
[Step=24750 Epoch=48.3] | Loss=0.02404 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.013 | L2-Norm(final)=13.167 | 4858.7 samples/s | 75.9 steps/s
[Step=24800 Epoch=48.4] | Loss=0.02380 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.036 | L2-Norm(final)=13.163 | 4810.3 samples/s | 75.2 steps/s
[Step=24850 Epoch=48.5] | Loss=0.02345 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.058 | L2-Norm(final)=13.160 | 4874.4 samples/s | 76.2 steps/s
[Step=24900 Epoch=48.6] | Loss=0.02349 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.078 | L2-Norm(final)=13.157 | 4951.7 samples/s | 77.4 steps/s
[Step=24950 Epoch=48.7] | Loss=0.02311 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.097 | L2-Norm(final)=13.155 | 4857.6 samples/s | 75.9 steps/s
[Step=25000 Epoch=48.8] | Loss=0.02302 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.115 | L2-Norm(final)=13.153 | 5750.1 samples/s | 89.8 steps/s
[Step=25050 Epoch=48.9] | Loss=0.02204 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.131 | L2-Norm(final)=13.151 | 1968.8 samples/s | 30.8 steps/s
[Step=25100 Epoch=49.0] | Loss=0.02136 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.146 | L2-Norm(final)=13.150 | 4739.6 samples/s | 74.1 steps/s
[Step=25150 Epoch=49.1] | Loss=0.02092 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.159 | L2-Norm(final)=13.149 | 4705.8 samples/s | 73.5 steps/s
[Step=25200 Epoch=49.1] | Loss=0.02072 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.172 | L2-Norm(final)=13.148 | 4747.0 samples/s | 74.2 steps/s
[Step=25250 Epoch=49.2] | Loss=0.02011 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.183 | L2-Norm(final)=13.148 | 4679.2 samples/s | 73.1 steps/s
[Step=25300 Epoch=49.3] | Loss=0.02006 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.194 | L2-Norm(final)=13.147 | 4696.8 samples/s | 73.4 steps/s
[Step=25350 Epoch=49.4] | Loss=0.01959 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.205 | L2-Norm(final)=13.146 | 4837.8 samples/s | 75.6 steps/s
[Step=25400 Epoch=49.5] | Loss=0.01927 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.215 | L2-Norm(final)=13.146 | 4772.9 samples/s | 74.6 steps/s
[Step=25450 Epoch=49.6] | Loss=0.01910 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.224 | L2-Norm(final)=13.145 | 4778.8 samples/s | 74.7 steps/s
[Step=25500 Epoch=49.7] | Loss=0.01896 | Reg=0.00203 | acc=0.9531 | L2-Norm=14.233 | L2-Norm(final)=13.144 | 5052.2 samples/s | 78.9 steps/s
[Step=25550 Epoch=49.8] | Loss=0.01861 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.241 | L2-Norm(final)=13.144 | 2120.6 samples/s | 33.1 steps/s
[Step=25600 Epoch=49.9] | Loss=0.01811 | Reg=0.00203 | acc=0.9531 | L2-Norm=14.248 | L2-Norm(final)=13.143 | 4779.3 samples/s | 74.7 steps/s
[Step=25650 Epoch=50.0] | Loss=0.01784 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.256 | L2-Norm(final)=13.143 | 4822.4 samples/s | 75.4 steps/s
[Step=25700 Epoch=50.1] | Loss=0.01745 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.263 | L2-Norm(final)=13.143 | 4848.4 samples/s | 75.8 steps/s
[Step=25750 Epoch=50.2] | Loss=0.01719 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.269 | L2-Norm(final)=13.143 | 4663.2 samples/s | 72.9 steps/s
[Step=25800 Epoch=50.3] | Loss=0.01708 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.275 | L2-Norm(final)=13.143 | 4745.4 samples/s | 74.1 steps/s
[Step=25850 Epoch=50.4] | Loss=0.01678 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.282 | L2-Norm(final)=13.143 | 4817.5 samples/s | 75.3 steps/s
[Step=25900 Epoch=50.5] | Loss=0.01672 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.288 | L2-Norm(final)=13.143 | 4775.2 samples/s | 74.6 steps/s
[Step=25950 Epoch=50.6] | Loss=0.01659 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.294 | L2-Norm(final)=13.144 | 4755.8 samples/s | 74.3 steps/s
[Step=26000 Epoch=50.7] | Loss=0.01641 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.300 | L2-Norm(final)=13.144 | 4791.8 samples/s | 74.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step26000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=24001 Epoch=46.9] | Loss=0.02771 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.789 | L2-Norm(final)=13.167 | 4525.8 samples/s | 70.7 steps/s
[Step=24050 Epoch=47.0] | Loss=0.03048 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.792 | L2-Norm(final)=13.186 | 5026.7 samples/s | 78.5 steps/s
[Step=24100 Epoch=47.1] | Loss=0.03077 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.792 | L2-Norm(final)=13.204 | 5492.9 samples/s | 85.8 steps/s
[Step=24150 Epoch=47.2] | Loss=0.03037 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.793 | L2-Norm(final)=13.216 | 5441.0 samples/s | 85.0 steps/s
[Step=24200 Epoch=47.3] | Loss=0.03148 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.793 | L2-Norm(final)=13.228 | 5550.7 samples/s | 86.7 steps/s
[Step=24250 Epoch=47.4] | Loss=0.03200 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.793 | L2-Norm(final)=13.240 | 5551.9 samples/s | 86.7 steps/s
[Step=24300 Epoch=47.5] | Loss=0.03155 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.793 | L2-Norm(final)=13.252 | 5422.3 samples/s | 84.7 steps/s
[Step=24350 Epoch=47.6] | Loss=0.03151 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.793 | L2-Norm(final)=13.265 | 5637.7 samples/s | 88.1 steps/s
[Step=24400 Epoch=47.7] | Loss=0.03118 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.793 | L2-Norm(final)=13.277 | 5493.3 samples/s | 85.8 steps/s
[Step=24450 Epoch=47.8] | Loss=0.03138 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.793 | L2-Norm(final)=13.290 | 5452.0 samples/s | 85.2 steps/s
[Step=24500 Epoch=47.9] | Loss=0.03132 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.793 | L2-Norm(final)=13.302 | 6888.2 samples/s | 107.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=47.9] | Loss=0.02810 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.793 | L2-Norm(final)=13.425 | 4309.8 samples/s | 67.3 steps/s
[Step=24550 Epoch=48.0] | Loss=0.02759 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.864 | L2-Norm(final)=13.424 | 4609.2 samples/s | 72.0 steps/s
[Step=24600 Epoch=48.1] | Loss=0.02404 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.921 | L2-Norm(final)=13.416 | 4818.2 samples/s | 75.3 steps/s
[Step=24650 Epoch=48.2] | Loss=0.02423 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.966 | L2-Norm(final)=13.410 | 4789.8 samples/s | 74.8 steps/s
[Step=24700 Epoch=48.3] | Loss=0.02485 | Reg=0.00196 | acc=0.9375 | L2-Norm=14.001 | L2-Norm(final)=13.404 | 4740.9 samples/s | 74.1 steps/s
[Step=24750 Epoch=48.4] | Loss=0.02467 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.030 | L2-Norm(final)=13.398 | 4775.0 samples/s | 74.6 steps/s
[Step=24800 Epoch=48.5] | Loss=0.02375 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.055 | L2-Norm(final)=13.394 | 4764.7 samples/s | 74.4 steps/s
[Step=24850 Epoch=48.6] | Loss=0.02397 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.078 | L2-Norm(final)=13.391 | 4736.8 samples/s | 74.0 steps/s
[Step=24900 Epoch=48.7] | Loss=0.02335 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.098 | L2-Norm(final)=13.389 | 4782.7 samples/s | 74.7 steps/s
[Step=24950 Epoch=48.8] | Loss=0.02274 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.116 | L2-Norm(final)=13.388 | 4890.8 samples/s | 76.4 steps/s
[Step=25000 Epoch=48.9] | Loss=0.02212 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.134 | L2-Norm(final)=13.387 | 5856.4 samples/s | 91.5 steps/s
[Step=25050 Epoch=49.0] | Loss=0.02111 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.150 | L2-Norm(final)=13.387 | 2013.2 samples/s | 31.5 steps/s
[Step=25100 Epoch=49.1] | Loss=0.02061 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.164 | L2-Norm(final)=13.387 | 4782.8 samples/s | 74.7 steps/s
[Step=25150 Epoch=49.2] | Loss=0.02012 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.176 | L2-Norm(final)=13.386 | 4806.1 samples/s | 75.1 steps/s
[Step=25200 Epoch=49.3] | Loss=0.01946 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.188 | L2-Norm(final)=13.386 | 4756.2 samples/s | 74.3 steps/s
[Step=25250 Epoch=49.4] | Loss=0.01902 | Reg=0.00202 | acc=0.9688 | L2-Norm=14.198 | L2-Norm(final)=13.386 | 4778.2 samples/s | 74.7 steps/s
[Step=25300 Epoch=49.5] | Loss=0.01869 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.208 | L2-Norm(final)=13.386 | 4774.0 samples/s | 74.6 steps/s
[Step=25350 Epoch=49.6] | Loss=0.01830 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.217 | L2-Norm(final)=13.386 | 4770.1 samples/s | 74.5 steps/s
[Step=25400 Epoch=49.7] | Loss=0.01803 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.226 | L2-Norm(final)=13.386 | 4879.7 samples/s | 76.2 steps/s
[Step=25450 Epoch=49.8] | Loss=0.01787 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.235 | L2-Norm(final)=13.386 | 4761.5 samples/s | 74.4 steps/s
[Step=25500 Epoch=49.9] | Loss=0.01801 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.243 | L2-Norm(final)=13.386 | 5167.7 samples/s | 80.7 steps/s
[Step=25550 Epoch=49.9] | Loss=0.01792 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.251 | L2-Norm(final)=13.386 | 2134.0 samples/s | 33.3 steps/s
[Step=25600 Epoch=50.0] | Loss=0.01754 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.260 | L2-Norm(final)=13.386 | 4786.3 samples/s | 74.8 steps/s
[Step=25650 Epoch=50.1] | Loss=0.01721 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.268 | L2-Norm(final)=13.386 | 4851.2 samples/s | 75.8 steps/s
[Step=25700 Epoch=50.2] | Loss=0.01708 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.276 | L2-Norm(final)=13.385 | 4819.7 samples/s | 75.3 steps/s
[Step=25750 Epoch=50.3] | Loss=0.01685 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.284 | L2-Norm(final)=13.385 | 4781.3 samples/s | 74.7 steps/s
[Step=25800 Epoch=50.4] | Loss=0.01658 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.291 | L2-Norm(final)=13.385 | 4763.4 samples/s | 74.4 steps/s
[Step=25850 Epoch=50.5] | Loss=0.01644 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.298 | L2-Norm(final)=13.385 | 4809.0 samples/s | 75.1 steps/s
[Step=25900 Epoch=50.6] | Loss=0.01638 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.306 | L2-Norm(final)=13.385 | 4795.0 samples/s | 74.9 steps/s
[Step=25950 Epoch=50.7] | Loss=0.01625 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.312 | L2-Norm(final)=13.385 | 4752.0 samples/s | 74.2 steps/s
[Step=26000 Epoch=50.8] | Loss=0.01621 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.319 | L2-Norm(final)=13.384 | 4819.3 samples/s | 75.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step26000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=24001 Epoch=92.0] | Loss=0.00000 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.789 | L2-Norm(final)=15.034 | 4589.2 samples/s | 71.7 steps/s
[Step=24050 Epoch=92.2] | Loss=0.00045 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=15.038 | 4974.7 samples/s | 77.7 steps/s
[Step=24100 Epoch=92.3] | Loss=0.00038 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=15.044 | 5268.5 samples/s | 82.3 steps/s
[Step=24150 Epoch=92.5] | Loss=0.00050 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=15.050 | 5035.8 samples/s | 78.7 steps/s
[Step=24200 Epoch=92.7] | Loss=0.00055 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=15.057 | 5161.5 samples/s | 80.6 steps/s
[Step=24250 Epoch=92.9] | Loss=0.00057 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.785 | L2-Norm(final)=15.064 | 6736.0 samples/s | 105.2 steps/s
[Step=24300 Epoch=93.1] | Loss=0.00056 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=15.071 | 2098.3 samples/s | 32.8 steps/s
[Step=24350 Epoch=93.3] | Loss=0.00052 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=15.077 | 5367.3 samples/s | 83.9 steps/s
[Step=24400 Epoch=93.5] | Loss=0.00051 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=15.083 | 5251.3 samples/s | 82.1 steps/s
[Step=24450 Epoch=93.7] | Loss=0.00053 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.784 | L2-Norm(final)=15.090 | 5298.5 samples/s | 82.8 steps/s
[Step=24500 Epoch=93.9] | Loss=0.00051 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.784 | L2-Norm(final)=15.096 | 5856.4 samples/s | 91.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=93.9] | Loss=0.00292 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.784 | L2-Norm(final)=15.161 | 4253.7 samples/s | 66.5 steps/s
[Step=24550 Epoch=94.1] | Loss=0.00077 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=15.167 | 4330.8 samples/s | 67.7 steps/s
[Step=24600 Epoch=94.3] | Loss=0.00122 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.794 | L2-Norm(final)=15.167 | 4521.1 samples/s | 70.6 steps/s
[Step=24650 Epoch=94.5] | Loss=0.00237 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.817 | L2-Norm(final)=15.165 | 4640.5 samples/s | 72.5 steps/s
[Step=24700 Epoch=94.6] | Loss=0.00362 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.855 | L2-Norm(final)=15.151 | 4504.5 samples/s | 70.4 steps/s
[Step=24750 Epoch=94.8] | Loss=0.00353 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.888 | L2-Norm(final)=15.142 | 5704.4 samples/s | 89.1 steps/s
[Step=24800 Epoch=95.0] | Loss=0.00301 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.914 | L2-Norm(final)=15.136 | 1900.5 samples/s | 29.7 steps/s
[Step=24850 Epoch=95.2] | Loss=0.00258 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.930 | L2-Norm(final)=15.132 | 4556.2 samples/s | 71.2 steps/s
[Step=24900 Epoch=95.4] | Loss=0.00226 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.940 | L2-Norm(final)=15.130 | 4542.7 samples/s | 71.0 steps/s
[Step=24950 Epoch=95.6] | Loss=0.00202 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.946 | L2-Norm(final)=15.128 | 4522.7 samples/s | 70.7 steps/s
[Step=25000 Epoch=95.8] | Loss=0.00181 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.948 | L2-Norm(final)=15.126 | 5025.0 samples/s | 78.5 steps/s
[Step=25050 Epoch=96.0] | Loss=0.00165 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.948 | L2-Norm(final)=15.125 | 2048.4 samples/s | 32.0 steps/s
[Step=25100 Epoch=96.2] | Loss=0.00151 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.946 | L2-Norm(final)=15.125 | 4658.9 samples/s | 72.8 steps/s
[Step=25150 Epoch=96.4] | Loss=0.00140 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.943 | L2-Norm(final)=15.124 | 4632.5 samples/s | 72.4 steps/s
[Step=25200 Epoch=96.6] | Loss=0.00130 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.939 | L2-Norm(final)=15.123 | 4594.7 samples/s | 71.8 steps/s
[Step=25250 Epoch=96.7] | Loss=0.00121 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.935 | L2-Norm(final)=15.123 | 4619.8 samples/s | 72.2 steps/s
[Step=25300 Epoch=96.9] | Loss=0.00114 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.930 | L2-Norm(final)=15.123 | 2157.7 samples/s | 33.7 steps/s
[Step=25350 Epoch=97.1] | Loss=0.00107 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.924 | L2-Norm(final)=15.123 | 4591.7 samples/s | 71.7 steps/s
[Step=25400 Epoch=97.3] | Loss=0.00101 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.918 | L2-Norm(final)=15.122 | 4543.2 samples/s | 71.0 steps/s
[Step=25450 Epoch=97.5] | Loss=0.00096 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.911 | L2-Norm(final)=15.122 | 4645.0 samples/s | 72.6 steps/s
[Step=25500 Epoch=97.7] | Loss=0.00091 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.904 | L2-Norm(final)=15.122 | 4553.6 samples/s | 71.1 steps/s
[Step=25550 Epoch=97.9] | Loss=0.00087 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.897 | L2-Norm(final)=15.122 | 2132.3 samples/s | 33.3 steps/s
[Step=25600 Epoch=98.1] | Loss=0.00083 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.890 | L2-Norm(final)=15.122 | 4477.1 samples/s | 70.0 steps/s
[Step=25650 Epoch=98.3] | Loss=0.00079 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.883 | L2-Norm(final)=15.122 | 4556.2 samples/s | 71.2 steps/s
[Step=25700 Epoch=98.5] | Loss=0.00076 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.875 | L2-Norm(final)=15.122 | 4449.5 samples/s | 69.5 steps/s
[Step=25750 Epoch=98.7] | Loss=0.00073 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.867 | L2-Norm(final)=15.123 | 4631.1 samples/s | 72.4 steps/s
[Step=25800 Epoch=98.9] | Loss=0.00070 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.859 | L2-Norm(final)=15.123 | 6198.1 samples/s | 96.8 steps/s
[Step=25850 Epoch=99.0] | Loss=0.00067 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.851 | L2-Norm(final)=15.123 | 1907.6 samples/s | 29.8 steps/s
[Step=25900 Epoch=99.2] | Loss=0.00065 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.843 | L2-Norm(final)=15.123 | 4659.0 samples/s | 72.8 steps/s
[Step=25950 Epoch=99.4] | Loss=0.00063 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.835 | L2-Norm(final)=15.124 | 4631.3 samples/s | 72.4 steps/s
[Step=26000 Epoch=99.6] | Loss=0.00061 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.826 | L2-Norm(final)=15.124 | 4634.7 samples/s | 72.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step26000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=24001 Epoch=92.4] | Loss=0.00002 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.789 | L2-Norm(final)=14.332 | 4604.9 samples/s | 72.0 steps/s
[Step=24050 Epoch=92.6] | Loss=0.00046 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.786 | L2-Norm(final)=14.338 | 4544.7 samples/s | 71.0 steps/s
[Step=24100 Epoch=92.8] | Loss=0.00059 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=14.346 | 5306.4 samples/s | 82.9 steps/s
[Step=24150 Epoch=93.0] | Loss=0.00061 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=14.354 | 5373.0 samples/s | 84.0 steps/s
[Step=24200 Epoch=93.2] | Loss=0.00055 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=14.364 | 5129.9 samples/s | 80.2 steps/s
[Step=24250 Epoch=93.3] | Loss=0.00062 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=14.374 | 6949.7 samples/s | 108.6 steps/s
[Step=24300 Epoch=93.5] | Loss=0.00063 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=14.383 | 2037.6 samples/s | 31.8 steps/s
[Step=24350 Epoch=93.7] | Loss=0.00069 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=14.393 | 5277.1 samples/s | 82.5 steps/s
[Step=24400 Epoch=93.9] | Loss=0.00064 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=14.402 | 5103.5 samples/s | 79.7 steps/s
[Step=24450 Epoch=94.1] | Loss=0.00060 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=14.411 | 5111.3 samples/s | 79.9 steps/s
[Step=24500 Epoch=94.3] | Loss=0.00057 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=14.420 | 6021.9 samples/s | 94.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=94.3] | Loss=0.00003 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=14.508 | 4197.9 samples/s | 65.6 steps/s
[Step=24550 Epoch=94.5] | Loss=0.00172 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.792 | L2-Norm(final)=14.510 | 4399.9 samples/s | 68.7 steps/s
[Step=24600 Epoch=94.7] | Loss=0.00128 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.813 | L2-Norm(final)=14.514 | 4558.6 samples/s | 71.2 steps/s
[Step=24650 Epoch=94.9] | Loss=0.00094 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.826 | L2-Norm(final)=14.518 | 4647.6 samples/s | 72.6 steps/s
[Step=24700 Epoch=95.1] | Loss=0.00073 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.830 | L2-Norm(final)=14.523 | 4454.5 samples/s | 69.6 steps/s
[Step=24750 Epoch=95.3] | Loss=0.00068 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.827 | L2-Norm(final)=14.527 | 5841.9 samples/s | 91.3 steps/s
[Step=24800 Epoch=95.5] | Loss=0.00147 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.837 | L2-Norm(final)=14.526 | 1964.3 samples/s | 30.7 steps/s
[Step=24850 Epoch=95.7] | Loss=0.00149 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.860 | L2-Norm(final)=14.520 | 4607.7 samples/s | 72.0 steps/s
[Step=24900 Epoch=95.8] | Loss=0.00166 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.881 | L2-Norm(final)=14.516 | 4659.8 samples/s | 72.8 steps/s
[Step=24950 Epoch=96.0] | Loss=0.00148 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.899 | L2-Norm(final)=14.513 | 4661.7 samples/s | 72.8 steps/s
[Step=25000 Epoch=96.2] | Loss=0.00134 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.911 | L2-Norm(final)=14.510 | 5239.4 samples/s | 81.9 steps/s
[Step=25050 Epoch=96.4] | Loss=0.00122 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.919 | L2-Norm(final)=14.508 | 2060.0 samples/s | 32.2 steps/s
[Step=25100 Epoch=96.6] | Loss=0.00112 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.925 | L2-Norm(final)=14.506 | 4558.4 samples/s | 71.2 steps/s
[Step=25150 Epoch=96.8] | Loss=0.00103 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.927 | L2-Norm(final)=14.504 | 4659.0 samples/s | 72.8 steps/s
[Step=25200 Epoch=97.0] | Loss=0.00096 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.928 | L2-Norm(final)=14.503 | 4693.6 samples/s | 73.3 steps/s
[Step=25250 Epoch=97.2] | Loss=0.00090 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.928 | L2-Norm(final)=14.502 | 4618.2 samples/s | 72.2 steps/s
[Step=25300 Epoch=97.4] | Loss=0.00084 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.927 | L2-Norm(final)=14.502 | 2100.8 samples/s | 32.8 steps/s
[Step=25350 Epoch=97.6] | Loss=0.00079 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.924 | L2-Norm(final)=14.501 | 4506.1 samples/s | 70.4 steps/s
[Step=25400 Epoch=97.8] | Loss=0.00075 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.921 | L2-Norm(final)=14.500 | 4574.2 samples/s | 71.5 steps/s
[Step=25450 Epoch=98.0] | Loss=0.00071 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.917 | L2-Norm(final)=14.500 | 4441.9 samples/s | 69.4 steps/s
[Step=25500 Epoch=98.2] | Loss=0.00067 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.913 | L2-Norm(final)=14.499 | 4489.2 samples/s | 70.1 steps/s
[Step=25550 Epoch=98.4] | Loss=0.00064 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.908 | L2-Norm(final)=14.499 | 2131.2 samples/s | 33.3 steps/s
[Step=25600 Epoch=98.5] | Loss=0.00061 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.903 | L2-Norm(final)=14.499 | 4572.2 samples/s | 71.4 steps/s
[Step=25650 Epoch=98.7] | Loss=0.00059 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.897 | L2-Norm(final)=14.498 | 4265.5 samples/s | 66.6 steps/s
[Step=25700 Epoch=98.9] | Loss=0.00056 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.891 | L2-Norm(final)=14.498 | 3858.7 samples/s | 60.3 steps/s
[Step=25750 Epoch=99.1] | Loss=0.00054 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.884 | L2-Norm(final)=14.498 | 4156.2 samples/s | 64.9 steps/s
[Step=25800 Epoch=99.3] | Loss=0.00052 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.878 | L2-Norm(final)=14.498 | 5780.5 samples/s | 90.3 steps/s
[Step=25850 Epoch=99.5] | Loss=0.00050 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.871 | L2-Norm(final)=14.498 | 1638.2 samples/s | 25.6 steps/s
[Step=25900 Epoch=99.7] | Loss=0.00048 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.864 | L2-Norm(final)=14.498 | 3881.0 samples/s | 60.6 steps/s
[Step=25950 Epoch=99.9] | Loss=0.00047 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.857 | L2-Norm(final)=14.497 | 3948.6 samples/s | 61.7 steps/s
[Step=26000 Epoch=100.1] | Loss=0.00045 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.849 | L2-Norm(final)=14.497 | 3891.2 samples/s | 60.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step26000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07010 | acc=0.9655 | tpr=0.9742 | fpr=0.0535 | 4454.8 samples/s | 17.4 steps/s
Avg test loss: 0.06708, Avg test acc: 0.96718, Avg tpr: 0.97540, Avg fpr: 0.05089, total FA: 397

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06689 | acc=0.9666 | tpr=0.9773 | fpr=0.0565 | 4480.0 samples/s | 17.5 steps/s
Avg test loss: 0.06535, Avg test acc: 0.96678, Avg tpr: 0.97744, Avg fpr: 0.05666, total FA: 442

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.54142 | acc=0.3124 | tpr=0.0100 | fpr=0.0310 | 4530.4 samples/s | 17.7 steps/s
Avg test loss: 7.56205, Avg test acc: 0.30944, Avg tpr: 0.01008, Avg fpr: 0.03218, total FA: 251

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=8.05565 | acc=0.3095 | tpr=0.0057 | fpr=0.0307 | 4423.4 samples/s | 17.3 steps/s
Avg test loss: 8.07254, Avg test acc: 0.30704, Avg tpr: 0.00565, Avg fpr: 0.03012, total FA: 235

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.53932 | acc=0.1128 | tpr=0.7345 | fpr=0.8984 | 4474.9 samples/s | 17.5 steps/s
[Step= 100] | Loss=6.48614 | acc=0.1127 | tpr=0.7356 | fpr=0.8990 | 8176.7 samples/s | 31.9 steps/s
[Step= 150] | Loss=6.48966 | acc=0.1109 | tpr=0.7406 | fpr=0.9007 | 8620.7 samples/s | 33.7 steps/s
[Step= 200] | Loss=6.48935 | acc=0.1100 | tpr=0.7301 | fpr=0.9012 | 8346.5 samples/s | 32.6 steps/s
[Step= 250] | Loss=6.49336 | acc=0.1104 | tpr=0.7301 | fpr=0.9009 | 8686.7 samples/s | 33.9 steps/s
[Step= 300] | Loss=6.48929 | acc=0.1098 | tpr=0.7295 | fpr=0.9015 | 8746.9 samples/s | 34.2 steps/s
[Step= 350] | Loss=6.48759 | acc=0.1091 | tpr=0.7307 | fpr=0.9022 | 8297.5 samples/s | 32.4 steps/s
[Step= 400] | Loss=6.49197 | acc=0.1093 | tpr=0.7303 | fpr=0.9020 | 8645.0 samples/s | 33.8 steps/s
[Step= 450] | Loss=6.49346 | acc=0.1093 | tpr=0.7313 | fpr=0.9020 | 8320.7 samples/s | 32.5 steps/s
[Step= 500] | Loss=6.49065 | acc=0.1093 | tpr=0.7326 | fpr=0.9020 | 8565.3 samples/s | 33.5 steps/s
[Step= 550] | Loss=6.49490 | acc=0.1092 | tpr=0.7294 | fpr=0.9021 | 14779.6 samples/s | 57.7 steps/s
Avg test loss: 6.49529, Avg test acc: 0.10911, Avg tpr: 0.73019, Avg fpr: 0.90218, total FA: 125266

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.13741 | acc=0.1184 | tpr=0.7257 | fpr=0.8925 | 4571.0 samples/s | 17.9 steps/s
[Step= 100] | Loss=6.10245 | acc=0.1195 | tpr=0.7548 | fpr=0.8924 | 8486.3 samples/s | 33.1 steps/s
[Step= 150] | Loss=6.09154 | acc=0.1184 | tpr=0.7637 | fpr=0.8934 | 8436.3 samples/s | 33.0 steps/s
[Step= 200] | Loss=6.08041 | acc=0.1190 | tpr=0.7596 | fpr=0.8927 | 8418.2 samples/s | 32.9 steps/s
[Step= 250] | Loss=6.08617 | acc=0.1185 | tpr=0.7555 | fpr=0.8931 | 8826.0 samples/s | 34.5 steps/s
[Step= 300] | Loss=6.08413 | acc=0.1181 | tpr=0.7578 | fpr=0.8936 | 8318.4 samples/s | 32.5 steps/s
[Step= 350] | Loss=6.08128 | acc=0.1177 | tpr=0.7570 | fpr=0.8939 | 8226.2 samples/s | 32.1 steps/s
[Step= 400] | Loss=6.08454 | acc=0.1176 | tpr=0.7566 | fpr=0.8940 | 8601.0 samples/s | 33.6 steps/s
[Step= 450] | Loss=6.08689 | acc=0.1179 | tpr=0.7610 | fpr=0.8938 | 8149.7 samples/s | 31.8 steps/s
[Step= 500] | Loss=6.08603 | acc=0.1178 | tpr=0.7621 | fpr=0.8938 | 8879.0 samples/s | 34.7 steps/s
[Step= 550] | Loss=6.08958 | acc=0.1178 | tpr=0.7636 | fpr=0.8939 | 13957.0 samples/s | 54.5 steps/s
Avg test loss: 6.08950, Avg test acc: 0.11775, Avg tpr: 0.76426, Avg fpr: 0.89400, total FA: 124130

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12949 | acc=0.9810 | tpr=0.9159 | fpr=0.0178 | 4446.6 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.13498 | acc=0.9808 | tpr=0.9318 | fpr=0.0183 | 8580.1 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.14177 | acc=0.9799 | tpr=0.9424 | fpr=0.0194 | 8465.4 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.14207 | acc=0.9802 | tpr=0.9475 | fpr=0.0193 | 8742.7 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.13928 | acc=0.9803 | tpr=0.9485 | fpr=0.0191 | 8182.9 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.14127 | acc=0.9801 | tpr=0.9491 | fpr=0.0193 | 8469.4 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.14275 | acc=0.9800 | tpr=0.9480 | fpr=0.0195 | 8534.7 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.14447 | acc=0.9797 | tpr=0.9480 | fpr=0.0197 | 8556.8 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.14673 | acc=0.9795 | tpr=0.9474 | fpr=0.0199 | 8369.0 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.14623 | acc=0.9795 | tpr=0.9471 | fpr=0.0199 | 8549.6 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.14501 | acc=0.9797 | tpr=0.9451 | fpr=0.0197 | 15102.9 samples/s | 59.0 steps/s
Avg test loss: 0.14466, Avg test acc: 0.97968, Avg tpr: 0.94493, Avg fpr: 0.01968, total FA: 2733

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.17934 | acc=0.9830 | tpr=0.9469 | fpr=0.0163 | 4401.5 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.19344 | acc=0.9821 | tpr=0.9595 | fpr=0.0174 | 8312.8 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.20177 | acc=0.9815 | tpr=0.9625 | fpr=0.0182 | 8557.5 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.20311 | acc=0.9812 | tpr=0.9650 | fpr=0.0185 | 8473.1 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.19931 | acc=0.9813 | tpr=0.9633 | fpr=0.0184 | 8186.0 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.20262 | acc=0.9810 | tpr=0.9644 | fpr=0.0187 | 8484.8 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.20464 | acc=0.9809 | tpr=0.9643 | fpr=0.0188 | 8774.0 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.20738 | acc=0.9805 | tpr=0.9606 | fpr=0.0191 | 8617.0 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.21111 | acc=0.9803 | tpr=0.9606 | fpr=0.0194 | 8150.3 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.21036 | acc=0.9804 | tpr=0.9599 | fpr=0.0193 | 8258.4 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.20819 | acc=0.9805 | tpr=0.9578 | fpr=0.0191 | 15472.4 samples/s | 60.4 steps/s
Avg test loss: 0.20779, Avg test acc: 0.98052, Avg tpr: 0.95761, Avg fpr: 0.01906, total FA: 2647

server round 13/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=26001 Epoch=50.7] | Loss=0.01171 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.710 | L2-Norm(final)=13.149 | 4179.0 samples/s | 65.3 steps/s
[Step=26050 Epoch=50.8] | Loss=0.02314 | Reg=0.00188 | acc=0.9531 | L2-Norm=13.711 | L2-Norm(final)=13.153 | 5174.6 samples/s | 80.9 steps/s
[Step=26100 Epoch=50.9] | Loss=0.02324 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.711 | L2-Norm(final)=13.156 | 5502.9 samples/s | 86.0 steps/s
[Step=26150 Epoch=51.0] | Loss=0.02334 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.711 | L2-Norm(final)=13.164 | 5409.3 samples/s | 84.5 steps/s
[Step=26200 Epoch=51.1] | Loss=0.02359 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.711 | L2-Norm(final)=13.171 | 5446.8 samples/s | 85.1 steps/s
[Step=26250 Epoch=51.2] | Loss=0.02380 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.711 | L2-Norm(final)=13.176 | 5499.5 samples/s | 85.9 steps/s
[Step=26300 Epoch=51.3] | Loss=0.02401 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.711 | L2-Norm(final)=13.179 | 5615.0 samples/s | 87.7 steps/s
[Step=26350 Epoch=51.4] | Loss=0.02342 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.711 | L2-Norm(final)=13.183 | 5468.3 samples/s | 85.4 steps/s
[Step=26400 Epoch=51.5] | Loss=0.02341 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.711 | L2-Norm(final)=13.188 | 5505.9 samples/s | 86.0 steps/s
[Step=26450 Epoch=51.6] | Loss=0.02339 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.711 | L2-Norm(final)=13.194 | 5502.7 samples/s | 86.0 steps/s
[Step=26500 Epoch=51.7] | Loss=0.02310 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.711 | L2-Norm(final)=13.200 | 6947.2 samples/s | 108.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=26501 Epoch=51.7] | Loss=0.00365 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.711 | L2-Norm(final)=13.265 | 3989.6 samples/s | 62.3 steps/s
[Step=26550 Epoch=51.8] | Loss=0.02080 | Reg=0.00189 | acc=0.9531 | L2-Norm=13.764 | L2-Norm(final)=13.271 | 4581.4 samples/s | 71.6 steps/s
[Step=26600 Epoch=51.9] | Loss=0.02009 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.818 | L2-Norm(final)=13.269 | 4729.6 samples/s | 73.9 steps/s
[Step=26650 Epoch=52.0] | Loss=0.02206 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.854 | L2-Norm(final)=13.266 | 4798.4 samples/s | 75.0 steps/s
[Step=26700 Epoch=52.1] | Loss=0.02245 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.882 | L2-Norm(final)=13.263 | 4784.1 samples/s | 74.8 steps/s
[Step=26750 Epoch=52.2] | Loss=0.02249 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.907 | L2-Norm(final)=13.259 | 4794.6 samples/s | 74.9 steps/s
[Step=26800 Epoch=52.3] | Loss=0.02342 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.933 | L2-Norm(final)=13.254 | 4838.2 samples/s | 75.6 steps/s
[Step=26850 Epoch=52.4] | Loss=0.02301 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.957 | L2-Norm(final)=13.250 | 4800.7 samples/s | 75.0 steps/s
[Step=26900 Epoch=52.5] | Loss=0.02270 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.979 | L2-Norm(final)=13.246 | 4881.8 samples/s | 76.3 steps/s
[Step=26950 Epoch=52.6] | Loss=0.02256 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.000 | L2-Norm(final)=13.243 | 4695.0 samples/s | 73.4 steps/s
[Step=27000 Epoch=52.7] | Loss=0.02245 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.019 | L2-Norm(final)=13.241 | 5788.6 samples/s | 90.4 steps/s
[Step=27050 Epoch=52.8] | Loss=0.02162 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.037 | L2-Norm(final)=13.239 | 2021.1 samples/s | 31.6 steps/s
[Step=27100 Epoch=52.9] | Loss=0.02076 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.053 | L2-Norm(final)=13.238 | 4732.3 samples/s | 73.9 steps/s
[Step=27150 Epoch=53.0] | Loss=0.02030 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.067 | L2-Norm(final)=13.238 | 4797.3 samples/s | 75.0 steps/s
[Step=27200 Epoch=53.1] | Loss=0.02001 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.081 | L2-Norm(final)=13.237 | 4740.4 samples/s | 74.1 steps/s
[Step=27250 Epoch=53.1] | Loss=0.01946 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=13.236 | 4763.1 samples/s | 74.4 steps/s
[Step=27300 Epoch=53.2] | Loss=0.01905 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.105 | L2-Norm(final)=13.236 | 4735.6 samples/s | 74.0 steps/s
[Step=27350 Epoch=53.3] | Loss=0.01883 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.117 | L2-Norm(final)=13.235 | 4673.6 samples/s | 73.0 steps/s
[Step=27400 Epoch=53.4] | Loss=0.01873 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.128 | L2-Norm(final)=13.234 | 4835.9 samples/s | 75.6 steps/s
[Step=27450 Epoch=53.5] | Loss=0.01839 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.138 | L2-Norm(final)=13.233 | 4775.1 samples/s | 74.6 steps/s
[Step=27500 Epoch=53.6] | Loss=0.01805 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.149 | L2-Norm(final)=13.233 | 5013.4 samples/s | 78.3 steps/s
[Step=27550 Epoch=53.7] | Loss=0.01796 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.159 | L2-Norm(final)=13.232 | 2063.6 samples/s | 32.2 steps/s
[Step=27600 Epoch=53.8] | Loss=0.01754 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.168 | L2-Norm(final)=13.231 | 4800.2 samples/s | 75.0 steps/s
[Step=27650 Epoch=53.9] | Loss=0.01724 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.178 | L2-Norm(final)=13.231 | 4727.8 samples/s | 73.9 steps/s
[Step=27700 Epoch=54.0] | Loss=0.01688 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.186 | L2-Norm(final)=13.231 | 4801.8 samples/s | 75.0 steps/s
[Step=27750 Epoch=54.1] | Loss=0.01671 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.195 | L2-Norm(final)=13.231 | 4860.7 samples/s | 75.9 steps/s
[Step=27800 Epoch=54.2] | Loss=0.01651 | Reg=0.00202 | acc=0.9688 | L2-Norm=14.203 | L2-Norm(final)=13.231 | 4804.8 samples/s | 75.1 steps/s
[Step=27850 Epoch=54.3] | Loss=0.01637 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.211 | L2-Norm(final)=13.230 | 4735.4 samples/s | 74.0 steps/s
[Step=27900 Epoch=54.4] | Loss=0.01628 | Reg=0.00202 | acc=0.9688 | L2-Norm=14.219 | L2-Norm(final)=13.230 | 4807.8 samples/s | 75.1 steps/s
[Step=27950 Epoch=54.5] | Loss=0.01614 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.227 | L2-Norm(final)=13.230 | 4772.2 samples/s | 74.6 steps/s
[Step=28000 Epoch=54.6] | Loss=0.01601 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.235 | L2-Norm(final)=13.230 | 4763.2 samples/s | 74.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step28000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=26001 Epoch=50.8] | Loss=0.01920 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.710 | L2-Norm(final)=13.367 | 4253.3 samples/s | 66.5 steps/s
[Step=26050 Epoch=50.9] | Loss=0.02510 | Reg=0.00188 | acc=0.9531 | L2-Norm=13.713 | L2-Norm(final)=13.371 | 5401.7 samples/s | 84.4 steps/s
[Step=26100 Epoch=51.0] | Loss=0.02577 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.713 | L2-Norm(final)=13.383 | 5512.9 samples/s | 86.1 steps/s
[Step=26150 Epoch=51.1] | Loss=0.02580 | Reg=0.00188 | acc=0.9531 | L2-Norm=13.714 | L2-Norm(final)=13.394 | 5455.9 samples/s | 85.2 steps/s
[Step=26200 Epoch=51.2] | Loss=0.02521 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.714 | L2-Norm(final)=13.407 | 5508.7 samples/s | 86.1 steps/s
[Step=26250 Epoch=51.3] | Loss=0.02505 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.714 | L2-Norm(final)=13.420 | 5545.6 samples/s | 86.6 steps/s
[Step=26300 Epoch=51.4] | Loss=0.02507 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.714 | L2-Norm(final)=13.433 | 5459.4 samples/s | 85.3 steps/s
[Step=26350 Epoch=51.5] | Loss=0.02493 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.714 | L2-Norm(final)=13.446 | 5508.7 samples/s | 86.1 steps/s
[Step=26400 Epoch=51.6] | Loss=0.02593 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.714 | L2-Norm(final)=13.457 | 5532.3 samples/s | 86.4 steps/s
[Step=26450 Epoch=51.7] | Loss=0.02572 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=13.467 | 5607.1 samples/s | 87.6 steps/s
[Step=26500 Epoch=51.8] | Loss=0.02530 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.714 | L2-Norm(final)=13.478 | 6900.4 samples/s | 107.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=26501 Epoch=51.8] | Loss=0.01393 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=13.593 | 4399.4 samples/s | 68.7 steps/s
[Step=26550 Epoch=51.9] | Loss=0.02128 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.770 | L2-Norm(final)=13.599 | 4674.7 samples/s | 73.0 steps/s
[Step=26600 Epoch=52.0] | Loss=0.02182 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.838 | L2-Norm(final)=13.593 | 4848.2 samples/s | 75.8 steps/s
[Step=26650 Epoch=52.1] | Loss=0.02264 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.889 | L2-Norm(final)=13.586 | 4783.9 samples/s | 74.7 steps/s
[Step=26700 Epoch=52.2] | Loss=0.02373 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.930 | L2-Norm(final)=13.578 | 4809.6 samples/s | 75.2 steps/s
[Step=26750 Epoch=52.3] | Loss=0.02313 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.963 | L2-Norm(final)=13.572 | 4809.0 samples/s | 75.1 steps/s
[Step=26800 Epoch=52.4] | Loss=0.02263 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.989 | L2-Norm(final)=13.568 | 4818.1 samples/s | 75.3 steps/s
[Step=26850 Epoch=52.5] | Loss=0.02213 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.013 | L2-Norm(final)=13.566 | 4769.4 samples/s | 74.5 steps/s
[Step=26900 Epoch=52.6] | Loss=0.02194 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.035 | L2-Norm(final)=13.564 | 4750.7 samples/s | 74.2 steps/s
[Step=26950 Epoch=52.7] | Loss=0.02181 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.055 | L2-Norm(final)=13.561 | 4774.8 samples/s | 74.6 steps/s
[Step=27000 Epoch=52.8] | Loss=0.02151 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.073 | L2-Norm(final)=13.559 | 5873.3 samples/s | 91.8 steps/s
[Step=27050 Epoch=52.9] | Loss=0.02084 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=13.557 | 2006.2 samples/s | 31.3 steps/s
[Step=27100 Epoch=53.0] | Loss=0.02014 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.104 | L2-Norm(final)=13.556 | 4830.4 samples/s | 75.5 steps/s
[Step=27150 Epoch=53.1] | Loss=0.01955 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.117 | L2-Norm(final)=13.555 | 4714.4 samples/s | 73.7 steps/s
[Step=27200 Epoch=53.2] | Loss=0.01920 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.129 | L2-Norm(final)=13.554 | 4806.9 samples/s | 75.1 steps/s
[Step=27250 Epoch=53.3] | Loss=0.01881 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.140 | L2-Norm(final)=13.553 | 4853.1 samples/s | 75.8 steps/s
[Step=27300 Epoch=53.4] | Loss=0.01840 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.151 | L2-Norm(final)=13.552 | 4775.2 samples/s | 74.6 steps/s
[Step=27350 Epoch=53.5] | Loss=0.01817 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.161 | L2-Norm(final)=13.551 | 4763.2 samples/s | 74.4 steps/s
[Step=27400 Epoch=53.6] | Loss=0.01816 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.171 | L2-Norm(final)=13.550 | 4706.0 samples/s | 73.5 steps/s
[Step=27450 Epoch=53.7] | Loss=0.01798 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.181 | L2-Norm(final)=13.549 | 4739.9 samples/s | 74.1 steps/s
[Step=27500 Epoch=53.8] | Loss=0.01779 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.189 | L2-Norm(final)=13.549 | 5171.7 samples/s | 80.8 steps/s
[Step=27550 Epoch=53.9] | Loss=0.01745 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.198 | L2-Norm(final)=13.548 | 2137.3 samples/s | 33.4 steps/s
[Step=27600 Epoch=54.0] | Loss=0.01719 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.206 | L2-Norm(final)=13.548 | 4840.5 samples/s | 75.6 steps/s
[Step=27650 Epoch=54.1] | Loss=0.01687 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.214 | L2-Norm(final)=13.548 | 4659.6 samples/s | 72.8 steps/s
[Step=27700 Epoch=54.2] | Loss=0.01671 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.221 | L2-Norm(final)=13.548 | 4744.8 samples/s | 74.1 steps/s
[Step=27750 Epoch=54.3] | Loss=0.01647 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.229 | L2-Norm(final)=13.547 | 4746.3 samples/s | 74.2 steps/s
[Step=27800 Epoch=54.3] | Loss=0.01630 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.236 | L2-Norm(final)=13.547 | 4817.6 samples/s | 75.3 steps/s
[Step=27850 Epoch=54.4] | Loss=0.01619 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.243 | L2-Norm(final)=13.547 | 4783.1 samples/s | 74.7 steps/s
[Step=27900 Epoch=54.5] | Loss=0.01596 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.250 | L2-Norm(final)=13.546 | 4810.1 samples/s | 75.2 steps/s
[Step=27950 Epoch=54.6] | Loss=0.01596 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.257 | L2-Norm(final)=13.546 | 4852.1 samples/s | 75.8 steps/s
[Step=28000 Epoch=54.7] | Loss=0.01591 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.264 | L2-Norm(final)=13.545 | 4726.3 samples/s | 73.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step28000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=26001 Epoch=99.6] | Loss=0.00002 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.710 | L2-Norm(final)=15.136 | 4212.5 samples/s | 65.8 steps/s
[Step=26050 Epoch=99.8] | Loss=0.00067 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.707 | L2-Norm(final)=15.146 | 4844.2 samples/s | 75.7 steps/s
[Step=26100 Epoch=100.0] | Loss=0.00083 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=15.157 | 5139.4 samples/s | 80.3 steps/s
[Step=26150 Epoch=100.2] | Loss=0.00072 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=15.167 | 5337.3 samples/s | 83.4 steps/s
[Step=26200 Epoch=100.4] | Loss=0.00066 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=15.174 | 4995.5 samples/s | 78.1 steps/s
[Step=26250 Epoch=100.6] | Loss=0.00066 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=15.180 | 6750.6 samples/s | 105.5 steps/s
[Step=26300 Epoch=100.8] | Loss=0.00060 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=15.186 | 2046.4 samples/s | 32.0 steps/s
[Step=26350 Epoch=101.0] | Loss=0.00057 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=15.192 | 5184.5 samples/s | 81.0 steps/s
[Step=26400 Epoch=101.2] | Loss=0.00062 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=15.197 | 5214.3 samples/s | 81.5 steps/s
[Step=26450 Epoch=101.3] | Loss=0.00060 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=15.204 | 5221.7 samples/s | 81.6 steps/s
[Step=26500 Epoch=101.5] | Loss=0.00063 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=15.210 | 5764.1 samples/s | 90.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=26501 Epoch=101.5] | Loss=0.00002 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=15.274 | 4298.0 samples/s | 67.2 steps/s
[Step=26550 Epoch=101.7] | Loss=0.00021 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=15.281 | 4354.1 samples/s | 68.0 steps/s
[Step=26600 Epoch=101.9] | Loss=0.00150 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.710 | L2-Norm(final)=15.283 | 4586.7 samples/s | 71.7 steps/s
[Step=26650 Epoch=102.1] | Loss=0.00124 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.751 | L2-Norm(final)=15.278 | 4560.3 samples/s | 71.3 steps/s
[Step=26700 Epoch=102.3] | Loss=0.00145 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.797 | L2-Norm(final)=15.272 | 4555.9 samples/s | 71.2 steps/s
[Step=26750 Epoch=102.5] | Loss=0.00136 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.835 | L2-Norm(final)=15.266 | 5715.7 samples/s | 89.3 steps/s
[Step=26800 Epoch=102.7] | Loss=0.00141 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.866 | L2-Norm(final)=15.263 | 1986.0 samples/s | 31.0 steps/s
[Step=26850 Epoch=102.9] | Loss=0.00177 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.894 | L2-Norm(final)=15.260 | 4581.6 samples/s | 71.6 steps/s
[Step=26900 Epoch=103.1] | Loss=0.00172 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.922 | L2-Norm(final)=15.256 | 4619.3 samples/s | 72.2 steps/s
[Step=26950 Epoch=103.3] | Loss=0.00157 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.947 | L2-Norm(final)=15.252 | 4512.1 samples/s | 70.5 steps/s
[Step=27000 Epoch=103.5] | Loss=0.00142 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.965 | L2-Norm(final)=15.249 | 4953.5 samples/s | 77.4 steps/s
[Step=27050 Epoch=103.6] | Loss=0.00129 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.978 | L2-Norm(final)=15.247 | 2045.4 samples/s | 32.0 steps/s
[Step=27100 Epoch=103.8] | Loss=0.00118 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.988 | L2-Norm(final)=15.246 | 4665.0 samples/s | 72.9 steps/s
[Step=27150 Epoch=104.0] | Loss=0.00109 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.995 | L2-Norm(final)=15.244 | 4594.1 samples/s | 71.8 steps/s
[Step=27200 Epoch=104.2] | Loss=0.00102 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.000 | L2-Norm(final)=15.243 | 4637.4 samples/s | 72.5 steps/s
[Step=27250 Epoch=104.4] | Loss=0.00095 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.003 | L2-Norm(final)=15.242 | 4553.6 samples/s | 71.1 steps/s
[Step=27300 Epoch=104.6] | Loss=0.00089 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.004 | L2-Norm(final)=15.241 | 2143.0 samples/s | 33.5 steps/s
[Step=27350 Epoch=104.8] | Loss=0.00084 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.005 | L2-Norm(final)=15.241 | 4643.7 samples/s | 72.6 steps/s
[Step=27400 Epoch=105.0] | Loss=0.00079 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.004 | L2-Norm(final)=15.240 | 4596.0 samples/s | 71.8 steps/s
[Step=27450 Epoch=105.2] | Loss=0.00075 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.003 | L2-Norm(final)=15.240 | 4494.7 samples/s | 70.2 steps/s
[Step=27500 Epoch=105.4] | Loss=0.00071 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.001 | L2-Norm(final)=15.240 | 4563.2 samples/s | 71.3 steps/s
[Step=27550 Epoch=105.6] | Loss=0.00068 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.998 | L2-Norm(final)=15.240 | 2129.9 samples/s | 33.3 steps/s
[Step=27600 Epoch=105.8] | Loss=0.00065 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.995 | L2-Norm(final)=15.240 | 4610.4 samples/s | 72.0 steps/s
[Step=27650 Epoch=105.9] | Loss=0.00062 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.992 | L2-Norm(final)=15.240 | 4532.6 samples/s | 70.8 steps/s
[Step=27700 Epoch=106.1] | Loss=0.00059 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.988 | L2-Norm(final)=15.240 | 4506.4 samples/s | 70.4 steps/s
[Step=27750 Epoch=106.3] | Loss=0.00057 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.984 | L2-Norm(final)=15.240 | 4506.5 samples/s | 70.4 steps/s
[Step=27800 Epoch=106.5] | Loss=0.00055 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.979 | L2-Norm(final)=15.240 | 6217.9 samples/s | 97.2 steps/s
[Step=27850 Epoch=106.7] | Loss=0.00053 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.974 | L2-Norm(final)=15.240 | 1893.3 samples/s | 29.6 steps/s
[Step=27900 Epoch=106.9] | Loss=0.00051 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.969 | L2-Norm(final)=15.240 | 4652.1 samples/s | 72.7 steps/s
[Step=27950 Epoch=107.1] | Loss=0.00049 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.964 | L2-Norm(final)=15.240 | 4635.8 samples/s | 72.4 steps/s
[Step=28000 Epoch=107.3] | Loss=0.00047 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.959 | L2-Norm(final)=15.240 | 4696.2 samples/s | 73.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step28000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=26001 Epoch=100.1] | Loss=0.00003 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.710 | L2-Norm(final)=14.496 | 4243.0 samples/s | 66.3 steps/s
[Step=26050 Epoch=100.3] | Loss=0.00060 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.707 | L2-Norm(final)=14.506 | 5097.1 samples/s | 79.6 steps/s
[Step=26100 Epoch=100.5] | Loss=0.00045 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.707 | L2-Norm(final)=14.516 | 5184.6 samples/s | 81.0 steps/s
[Step=26150 Epoch=100.7] | Loss=0.00039 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.707 | L2-Norm(final)=14.525 | 5187.7 samples/s | 81.1 steps/s
[Step=26200 Epoch=100.9] | Loss=0.00037 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=14.534 | 5146.0 samples/s | 80.4 steps/s
[Step=26250 Epoch=101.0] | Loss=0.00037 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=14.543 | 6967.6 samples/s | 108.9 steps/s
[Step=26300 Epoch=101.2] | Loss=0.00037 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=14.553 | 2030.4 samples/s | 31.7 steps/s
[Step=26350 Epoch=101.4] | Loss=0.00037 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=14.563 | 5236.5 samples/s | 81.8 steps/s
[Step=26400 Epoch=101.6] | Loss=0.00039 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=14.573 | 5183.9 samples/s | 81.0 steps/s
[Step=26450 Epoch=101.8] | Loss=0.00038 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=14.583 | 5096.6 samples/s | 79.6 steps/s
[Step=26500 Epoch=102.0] | Loss=0.00036 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=14.594 | 6002.8 samples/s | 93.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=26501 Epoch=102.0] | Loss=0.00003 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=14.692 | 4642.9 samples/s | 72.5 steps/s
[Step=26550 Epoch=102.2] | Loss=0.00020 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=14.698 | 4252.6 samples/s | 66.4 steps/s
[Step=26600 Epoch=102.4] | Loss=0.00012 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.690 | L2-Norm(final)=14.704 | 4539.3 samples/s | 70.9 steps/s
[Step=26650 Epoch=102.6] | Loss=0.00009 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.675 | L2-Norm(final)=14.708 | 4525.8 samples/s | 70.7 steps/s
[Step=26700 Epoch=102.8] | Loss=0.00008 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.660 | L2-Norm(final)=14.712 | 4622.0 samples/s | 72.2 steps/s
[Step=26750 Epoch=103.0] | Loss=0.00006 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.645 | L2-Norm(final)=14.716 | 5796.1 samples/s | 90.6 steps/s
[Step=26800 Epoch=103.2] | Loss=0.00005 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.629 | L2-Norm(final)=14.718 | 1980.5 samples/s | 30.9 steps/s
[Step=26850 Epoch=103.4] | Loss=0.00005 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.613 | L2-Norm(final)=14.720 | 4585.5 samples/s | 71.6 steps/s
[Step=26900 Epoch=103.5] | Loss=0.00004 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.596 | L2-Norm(final)=14.722 | 4591.9 samples/s | 71.7 steps/s
[Step=26950 Epoch=103.7] | Loss=0.00004 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.579 | L2-Norm(final)=14.724 | 4630.8 samples/s | 72.4 steps/s
[Step=27000 Epoch=103.9] | Loss=0.00003 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.563 | L2-Norm(final)=14.725 | 5047.4 samples/s | 78.9 steps/s
[Step=27050 Epoch=104.1] | Loss=0.00003 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.546 | L2-Norm(final)=14.726 | 2036.4 samples/s | 31.8 steps/s
[Step=27100 Epoch=104.3] | Loss=0.00003 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.530 | L2-Norm(final)=14.727 | 4536.7 samples/s | 70.9 steps/s
[Step=27150 Epoch=104.5] | Loss=0.00003 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.514 | L2-Norm(final)=14.728 | 4573.0 samples/s | 71.5 steps/s
[Step=27200 Epoch=104.7] | Loss=0.00002 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.498 | L2-Norm(final)=14.729 | 4529.0 samples/s | 70.8 steps/s
[Step=27250 Epoch=104.9] | Loss=0.00002 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.482 | L2-Norm(final)=14.729 | 4627.0 samples/s | 72.3 steps/s
[Step=27300 Epoch=105.1] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.466 | L2-Norm(final)=14.730 | 2116.3 samples/s | 33.1 steps/s
[Step=27350 Epoch=105.3] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.450 | L2-Norm(final)=14.731 | 4715.9 samples/s | 73.7 steps/s
[Step=27400 Epoch=105.5] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.434 | L2-Norm(final)=14.732 | 4645.8 samples/s | 72.6 steps/s
[Step=27450 Epoch=105.7] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.418 | L2-Norm(final)=14.732 | 4687.1 samples/s | 73.2 steps/s
[Step=27500 Epoch=105.9] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.403 | L2-Norm(final)=14.733 | 4643.6 samples/s | 72.6 steps/s
[Step=27550 Epoch=106.1] | Loss=0.00002 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=14.734 | 2159.4 samples/s | 33.7 steps/s
[Step=27600 Epoch=106.2] | Loss=0.00002 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=14.734 | 4737.6 samples/s | 74.0 steps/s
[Step=27650 Epoch=106.4] | Loss=0.00002 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=14.735 | 4611.2 samples/s | 72.0 steps/s
[Step=27700 Epoch=106.6] | Loss=0.00002 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=14.736 | 4629.2 samples/s | 72.3 steps/s
[Step=27750 Epoch=106.8] | Loss=0.00001 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=14.737 | 4499.9 samples/s | 70.3 steps/s
[Step=27800 Epoch=107.0] | Loss=0.00001 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.308 | L2-Norm(final)=14.738 | 6661.9 samples/s | 104.1 steps/s
[Step=27850 Epoch=107.2] | Loss=0.00001 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.292 | L2-Norm(final)=14.739 | 1869.1 samples/s | 29.2 steps/s
[Step=27900 Epoch=107.4] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.277 | L2-Norm(final)=14.740 | 4627.4 samples/s | 72.3 steps/s
[Step=27950 Epoch=107.6] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.261 | L2-Norm(final)=14.741 | 4555.6 samples/s | 71.2 steps/s
[Step=28000 Epoch=107.8] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.245 | L2-Norm(final)=14.742 | 4490.5 samples/s | 70.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06905 | acc=0.9684 | tpr=0.9767 | fpr=0.0496 | 4477.1 samples/s | 17.5 steps/s
Avg test loss: 0.06736, Avg test acc: 0.96767, Avg tpr: 0.97564, Avg fpr: 0.04987, total FA: 389

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06680 | acc=0.9669 | tpr=0.9727 | fpr=0.0458 | 4420.3 samples/s | 17.3 steps/s
Avg test loss: 0.06718, Avg test acc: 0.96678, Avg tpr: 0.97301, Avg fpr: 0.04692, total FA: 366

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=8.66275 | acc=0.3143 | tpr=0.0086 | fpr=0.0218 | 4463.0 samples/s | 17.4 steps/s
Avg test loss: 8.66597, Avg test acc: 0.31128, Avg tpr: 0.00880, Avg fpr: 0.02346, total FA: 183

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.77064 | acc=0.3005 | tpr=0.0149 | fpr=0.0793 | 4432.5 samples/s | 17.3 steps/s
Avg test loss: 6.78942, Avg test acc: 0.29746, Avg tpr: 0.01445, Avg fpr: 0.08012, total FA: 625

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.52906 | acc=0.1189 | tpr=0.7965 | fpr=0.8933 | 4471.2 samples/s | 17.5 steps/s
[Step= 100] | Loss=6.47659 | acc=0.1178 | tpr=0.7761 | fpr=0.8945 | 8678.3 samples/s | 33.9 steps/s
[Step= 150] | Loss=6.48387 | acc=0.1171 | tpr=0.7824 | fpr=0.8952 | 8483.8 samples/s | 33.1 steps/s
[Step= 200] | Loss=6.47817 | acc=0.1164 | tpr=0.7825 | fpr=0.8958 | 8700.0 samples/s | 34.0 steps/s
[Step= 250] | Loss=6.48346 | acc=0.1160 | tpr=0.7817 | fpr=0.8961 | 8607.0 samples/s | 33.6 steps/s
[Step= 300] | Loss=6.47997 | acc=0.1157 | tpr=0.7782 | fpr=0.8964 | 8424.9 samples/s | 32.9 steps/s
[Step= 350] | Loss=6.47367 | acc=0.1154 | tpr=0.7758 | fpr=0.8966 | 8122.3 samples/s | 31.7 steps/s
[Step= 400] | Loss=6.47988 | acc=0.1154 | tpr=0.7768 | fpr=0.8967 | 8740.3 samples/s | 34.1 steps/s
[Step= 450] | Loss=6.48201 | acc=0.1155 | tpr=0.7775 | fpr=0.8965 | 7885.8 samples/s | 30.8 steps/s
[Step= 500] | Loss=6.48153 | acc=0.1152 | tpr=0.7753 | fpr=0.8967 | 8762.1 samples/s | 34.2 steps/s
[Step= 550] | Loss=6.48614 | acc=0.1153 | tpr=0.7760 | fpr=0.8967 | 14867.5 samples/s | 58.1 steps/s
Avg test loss: 6.48636, Avg test acc: 0.11525, Avg tpr: 0.77655, Avg fpr: 0.89677, total FA: 124515

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.92752 | acc=0.1330 | tpr=0.7522 | fpr=0.8781 | 4544.2 samples/s | 17.8 steps/s
[Step= 100] | Loss=5.89979 | acc=0.1342 | tpr=0.7740 | fpr=0.8777 | 8507.6 samples/s | 33.2 steps/s
[Step= 150] | Loss=5.89699 | acc=0.1332 | tpr=0.7781 | fpr=0.8787 | 8381.1 samples/s | 32.7 steps/s
[Step= 200] | Loss=5.88523 | acc=0.1331 | tpr=0.7738 | fpr=0.8786 | 8687.3 samples/s | 33.9 steps/s
[Step= 250] | Loss=5.89107 | acc=0.1322 | tpr=0.7729 | fpr=0.8795 | 8127.6 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.89109 | acc=0.1316 | tpr=0.7673 | fpr=0.8800 | 8790.6 samples/s | 34.3 steps/s
[Step= 350] | Loss=5.88725 | acc=0.1309 | tpr=0.7627 | fpr=0.8805 | 8297.2 samples/s | 32.4 steps/s
[Step= 400] | Loss=5.88785 | acc=0.1306 | tpr=0.7626 | fpr=0.8809 | 8539.6 samples/s | 33.4 steps/s
[Step= 450] | Loss=5.89024 | acc=0.1304 | tpr=0.7648 | fpr=0.8811 | 8220.3 samples/s | 32.1 steps/s
[Step= 500] | Loss=5.89021 | acc=0.1303 | tpr=0.7674 | fpr=0.8812 | 8404.8 samples/s | 32.8 steps/s
[Step= 550] | Loss=5.89228 | acc=0.1304 | tpr=0.7660 | fpr=0.8811 | 15225.1 samples/s | 59.5 steps/s
Avg test loss: 5.89228, Avg test acc: 0.13037, Avg tpr: 0.76624, Avg fpr: 0.88119, total FA: 122351

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.24817 | acc=0.9797 | tpr=0.9336 | fpr=0.0195 | 4468.0 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.26278 | acc=0.9793 | tpr=0.9446 | fpr=0.0201 | 8388.2 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.27925 | acc=0.9781 | tpr=0.9409 | fpr=0.0212 | 8667.5 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.27996 | acc=0.9783 | tpr=0.9464 | fpr=0.0211 | 8293.6 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.27706 | acc=0.9785 | tpr=0.9485 | fpr=0.0210 | 8222.7 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.28177 | acc=0.9781 | tpr=0.9505 | fpr=0.0214 | 8977.5 samples/s | 35.1 steps/s
[Step= 350] | Loss=0.28513 | acc=0.9780 | tpr=0.9505 | fpr=0.0215 | 8644.7 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.28871 | acc=0.9778 | tpr=0.9469 | fpr=0.0217 | 7964.7 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.29479 | acc=0.9775 | tpr=0.9469 | fpr=0.0219 | 8142.2 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.29290 | acc=0.9776 | tpr=0.9476 | fpr=0.0218 | 8339.1 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.29109 | acc=0.9778 | tpr=0.9455 | fpr=0.0217 | 15379.7 samples/s | 60.1 steps/s
Avg test loss: 0.29030, Avg test acc: 0.97779, Avg tpr: 0.94572, Avg fpr: 0.02163, total FA: 3003

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14514 | acc=0.9823 | tpr=0.9336 | fpr=0.0168 | 4662.8 samples/s | 18.2 steps/s
[Step= 100] | Loss=0.15536 | acc=0.9819 | tpr=0.9552 | fpr=0.0176 | 7864.5 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.16259 | acc=0.9812 | tpr=0.9611 | fpr=0.0185 | 8463.2 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.16339 | acc=0.9812 | tpr=0.9650 | fpr=0.0185 | 8644.7 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.16111 | acc=0.9814 | tpr=0.9642 | fpr=0.0183 | 8408.0 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.16327 | acc=0.9813 | tpr=0.9651 | fpr=0.0184 | 8400.9 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.16535 | acc=0.9809 | tpr=0.9631 | fpr=0.0187 | 8582.9 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.16730 | acc=0.9807 | tpr=0.9623 | fpr=0.0190 | 8557.3 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.17049 | acc=0.9805 | tpr=0.9620 | fpr=0.0192 | 8312.3 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.17013 | acc=0.9805 | tpr=0.9626 | fpr=0.0191 | 8234.4 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.16863 | acc=0.9806 | tpr=0.9602 | fpr=0.0190 | 15869.4 samples/s | 62.0 steps/s
Avg test loss: 0.16823, Avg test acc: 0.98065, Avg tpr: 0.95998, Avg fpr: 0.01897, total FA: 2634

server round 14/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=28001 Epoch=54.6] | Loss=0.01824 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.564 | L2-Norm(final)=13.231 | 4087.4 samples/s | 63.9 steps/s
[Step=28050 Epoch=54.7] | Loss=0.01781 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.565 | L2-Norm(final)=13.236 | 5212.5 samples/s | 81.4 steps/s
[Step=28100 Epoch=54.8] | Loss=0.01820 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.566 | L2-Norm(final)=13.240 | 5611.4 samples/s | 87.7 steps/s
[Step=28150 Epoch=54.9] | Loss=0.01846 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.566 | L2-Norm(final)=13.245 | 5546.5 samples/s | 86.7 steps/s
[Step=28200 Epoch=55.0] | Loss=0.01774 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.566 | L2-Norm(final)=13.251 | 5408.8 samples/s | 84.5 steps/s
[Step=28250 Epoch=55.1] | Loss=0.01726 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.566 | L2-Norm(final)=13.258 | 5533.3 samples/s | 86.5 steps/s
[Step=28300 Epoch=55.2] | Loss=0.01690 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.566 | L2-Norm(final)=13.265 | 5668.7 samples/s | 88.6 steps/s
[Step=28350 Epoch=55.3] | Loss=0.01669 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.566 | L2-Norm(final)=13.273 | 5565.6 samples/s | 87.0 steps/s
[Step=28400 Epoch=55.4] | Loss=0.01689 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.566 | L2-Norm(final)=13.280 | 5378.9 samples/s | 84.0 steps/s
[Step=28450 Epoch=55.5] | Loss=0.01699 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.566 | L2-Norm(final)=13.287 | 5505.6 samples/s | 86.0 steps/s
[Step=28500 Epoch=55.6] | Loss=0.01704 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.566 | L2-Norm(final)=13.293 | 6949.7 samples/s | 108.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=28501 Epoch=55.6] | Loss=0.01772 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.566 | L2-Norm(final)=13.355 | 4099.3 samples/s | 64.1 steps/s
[Step=28550 Epoch=55.7] | Loss=0.01540 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.625 | L2-Norm(final)=13.356 | 4556.7 samples/s | 71.2 steps/s
[Step=28600 Epoch=55.8] | Loss=0.01925 | Reg=0.00187 | acc=0.9219 | L2-Norm=13.671 | L2-Norm(final)=13.354 | 4786.9 samples/s | 74.8 steps/s
[Step=28650 Epoch=55.9] | Loss=0.01976 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.710 | L2-Norm(final)=13.348 | 4717.9 samples/s | 73.7 steps/s
[Step=28700 Epoch=56.0] | Loss=0.02119 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.744 | L2-Norm(final)=13.342 | 4742.4 samples/s | 74.1 steps/s
[Step=28750 Epoch=56.1] | Loss=0.02011 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.774 | L2-Norm(final)=13.339 | 4768.8 samples/s | 74.5 steps/s
[Step=28800 Epoch=56.2] | Loss=0.01925 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.799 | L2-Norm(final)=13.337 | 4856.5 samples/s | 75.9 steps/s
[Step=28850 Epoch=56.3] | Loss=0.01966 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.820 | L2-Norm(final)=13.336 | 4811.9 samples/s | 75.2 steps/s
[Step=28900 Epoch=56.4] | Loss=0.01966 | Reg=0.00192 | acc=0.9531 | L2-Norm=13.839 | L2-Norm(final)=13.334 | 4807.7 samples/s | 75.1 steps/s
[Step=28950 Epoch=56.5] | Loss=0.01929 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.856 | L2-Norm(final)=13.332 | 4892.9 samples/s | 76.5 steps/s
[Step=29000 Epoch=56.6] | Loss=0.01903 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.873 | L2-Norm(final)=13.330 | 5791.7 samples/s | 90.5 steps/s
[Step=29050 Epoch=56.7] | Loss=0.01892 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.889 | L2-Norm(final)=13.328 | 2021.9 samples/s | 31.6 steps/s
[Step=29100 Epoch=56.8] | Loss=0.01840 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.904 | L2-Norm(final)=13.326 | 4724.9 samples/s | 73.8 steps/s
[Step=29150 Epoch=56.9] | Loss=0.01787 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.917 | L2-Norm(final)=13.325 | 4742.0 samples/s | 74.1 steps/s
[Step=29200 Epoch=57.0] | Loss=0.01776 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.930 | L2-Norm(final)=13.323 | 4762.8 samples/s | 74.4 steps/s
[Step=29250 Epoch=57.0] | Loss=0.01740 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.941 | L2-Norm(final)=13.322 | 4803.4 samples/s | 75.1 steps/s
[Step=29300 Epoch=57.1] | Loss=0.01716 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.952 | L2-Norm(final)=13.321 | 4804.5 samples/s | 75.1 steps/s
[Step=29350 Epoch=57.2] | Loss=0.01699 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.963 | L2-Norm(final)=13.320 | 4780.9 samples/s | 74.7 steps/s
[Step=29400 Epoch=57.3] | Loss=0.01701 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.973 | L2-Norm(final)=13.318 | 4832.8 samples/s | 75.5 steps/s
[Step=29450 Epoch=57.4] | Loss=0.01675 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.984 | L2-Norm(final)=13.317 | 4742.8 samples/s | 74.1 steps/s
[Step=29500 Epoch=57.5] | Loss=0.01661 | Reg=0.00196 | acc=0.9688 | L2-Norm=13.994 | L2-Norm(final)=13.316 | 5014.1 samples/s | 78.3 steps/s
[Step=29550 Epoch=57.6] | Loss=0.01643 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.004 | L2-Norm(final)=13.315 | 2011.1 samples/s | 31.4 steps/s
[Step=29600 Epoch=57.7] | Loss=0.01616 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.014 | L2-Norm(final)=13.314 | 4916.8 samples/s | 76.8 steps/s
[Step=29650 Epoch=57.8] | Loss=0.01585 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.023 | L2-Norm(final)=13.314 | 4763.6 samples/s | 74.4 steps/s
[Step=29700 Epoch=57.9] | Loss=0.01573 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.032 | L2-Norm(final)=13.313 | 4706.2 samples/s | 73.5 steps/s
[Step=29750 Epoch=58.0] | Loss=0.01551 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.041 | L2-Norm(final)=13.313 | 4731.7 samples/s | 73.9 steps/s
[Step=29800 Epoch=58.1] | Loss=0.01527 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.049 | L2-Norm(final)=13.313 | 4859.1 samples/s | 75.9 steps/s
[Step=29850 Epoch=58.2] | Loss=0.01516 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.058 | L2-Norm(final)=13.313 | 4759.5 samples/s | 74.4 steps/s
[Step=29900 Epoch=58.3] | Loss=0.01497 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.065 | L2-Norm(final)=13.313 | 4745.2 samples/s | 74.1 steps/s
[Step=29950 Epoch=58.4] | Loss=0.01486 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.073 | L2-Norm(final)=13.312 | 4828.5 samples/s | 75.4 steps/s
[Step=30000 Epoch=58.5] | Loss=0.01486 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.081 | L2-Norm(final)=13.312 | 4752.2 samples/s | 74.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step30000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=28001 Epoch=54.7] | Loss=0.02119 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.564 | L2-Norm(final)=13.524 | 4491.3 samples/s | 70.2 steps/s
[Step=28050 Epoch=54.8] | Loss=0.01755 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.565 | L2-Norm(final)=13.532 | 5269.2 samples/s | 82.3 steps/s
[Step=28100 Epoch=54.9] | Loss=0.01897 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.566 | L2-Norm(final)=13.538 | 5426.6 samples/s | 84.8 steps/s
[Step=28150 Epoch=55.0] | Loss=0.01743 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.566 | L2-Norm(final)=13.544 | 5539.7 samples/s | 86.6 steps/s
[Step=28200 Epoch=55.1] | Loss=0.01804 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.566 | L2-Norm(final)=13.551 | 5418.3 samples/s | 84.7 steps/s
[Step=28250 Epoch=55.2] | Loss=0.01758 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.566 | L2-Norm(final)=13.557 | 5528.2 samples/s | 86.4 steps/s
[Step=28300 Epoch=55.3] | Loss=0.01747 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.566 | L2-Norm(final)=13.564 | 5617.2 samples/s | 87.8 steps/s
[Step=28350 Epoch=55.4] | Loss=0.01747 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.566 | L2-Norm(final)=13.571 | 5387.9 samples/s | 84.2 steps/s
[Step=28400 Epoch=55.5] | Loss=0.01765 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.566 | L2-Norm(final)=13.577 | 5593.7 samples/s | 87.4 steps/s
[Step=28450 Epoch=55.6] | Loss=0.01780 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.566 | L2-Norm(final)=13.583 | 5421.0 samples/s | 84.7 steps/s
[Step=28500 Epoch=55.7] | Loss=0.01788 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.566 | L2-Norm(final)=13.588 | 7046.5 samples/s | 110.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=28501 Epoch=55.7] | Loss=0.01523 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.566 | L2-Norm(final)=13.640 | 4475.4 samples/s | 69.9 steps/s
[Step=28550 Epoch=55.8] | Loss=0.01640 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.629 | L2-Norm(final)=13.640 | 4488.5 samples/s | 70.1 steps/s
[Step=28600 Epoch=55.9] | Loss=0.01932 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.681 | L2-Norm(final)=13.638 | 4745.5 samples/s | 74.1 steps/s
[Step=28650 Epoch=56.0] | Loss=0.01990 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.719 | L2-Norm(final)=13.635 | 4738.6 samples/s | 74.0 steps/s
[Step=28700 Epoch=56.1] | Loss=0.02093 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.752 | L2-Norm(final)=13.631 | 4796.7 samples/s | 74.9 steps/s
[Step=28750 Epoch=56.2] | Loss=0.02037 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.781 | L2-Norm(final)=13.628 | 4806.4 samples/s | 75.1 steps/s
[Step=28800 Epoch=56.3] | Loss=0.02045 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.807 | L2-Norm(final)=13.626 | 4766.1 samples/s | 74.5 steps/s
[Step=28850 Epoch=56.4] | Loss=0.02001 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.833 | L2-Norm(final)=13.624 | 4805.1 samples/s | 75.1 steps/s
[Step=28900 Epoch=56.5] | Loss=0.01954 | Reg=0.00192 | acc=0.9531 | L2-Norm=13.855 | L2-Norm(final)=13.621 | 4747.6 samples/s | 74.2 steps/s
[Step=28950 Epoch=56.6] | Loss=0.01928 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.875 | L2-Norm(final)=13.620 | 4756.6 samples/s | 74.3 steps/s
[Step=29000 Epoch=56.7] | Loss=0.01910 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.894 | L2-Norm(final)=13.618 | 5950.3 samples/s | 93.0 steps/s
[Step=29050 Epoch=56.8] | Loss=0.01909 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.911 | L2-Norm(final)=13.617 | 2036.2 samples/s | 31.8 steps/s
[Step=29100 Epoch=56.9] | Loss=0.01835 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.928 | L2-Norm(final)=13.616 | 4706.6 samples/s | 73.5 steps/s
[Step=29150 Epoch=57.0] | Loss=0.01796 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.943 | L2-Norm(final)=13.615 | 4796.7 samples/s | 74.9 steps/s
[Step=29200 Epoch=57.1] | Loss=0.01763 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.956 | L2-Norm(final)=13.615 | 4681.1 samples/s | 73.1 steps/s
[Step=29250 Epoch=57.2] | Loss=0.01716 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.968 | L2-Norm(final)=13.614 | 4764.1 samples/s | 74.4 steps/s
[Step=29300 Epoch=57.3] | Loss=0.01681 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.979 | L2-Norm(final)=13.614 | 4780.5 samples/s | 74.7 steps/s
[Step=29350 Epoch=57.4] | Loss=0.01679 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.990 | L2-Norm(final)=13.614 | 4763.5 samples/s | 74.4 steps/s
[Step=29400 Epoch=57.5] | Loss=0.01665 | Reg=0.00196 | acc=0.9688 | L2-Norm=14.000 | L2-Norm(final)=13.613 | 4775.5 samples/s | 74.6 steps/s
[Step=29450 Epoch=57.6] | Loss=0.01631 | Reg=0.00196 | acc=0.9531 | L2-Norm=14.010 | L2-Norm(final)=13.612 | 4821.1 samples/s | 75.3 steps/s
[Step=29500 Epoch=57.7] | Loss=0.01631 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.019 | L2-Norm(final)=13.612 | 5053.1 samples/s | 79.0 steps/s
[Step=29550 Epoch=57.8] | Loss=0.01604 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.028 | L2-Norm(final)=13.611 | 2120.1 samples/s | 33.1 steps/s
[Step=29600 Epoch=57.9] | Loss=0.01577 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.036 | L2-Norm(final)=13.612 | 4805.9 samples/s | 75.1 steps/s
[Step=29650 Epoch=58.0] | Loss=0.01560 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.045 | L2-Norm(final)=13.612 | 4759.5 samples/s | 74.4 steps/s
[Step=29700 Epoch=58.1] | Loss=0.01541 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.052 | L2-Norm(final)=13.612 | 4790.3 samples/s | 74.8 steps/s
[Step=29750 Epoch=58.2] | Loss=0.01527 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.060 | L2-Norm(final)=13.612 | 4795.7 samples/s | 74.9 steps/s
[Step=29800 Epoch=58.3] | Loss=0.01510 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.068 | L2-Norm(final)=13.613 | 4796.3 samples/s | 74.9 steps/s
[Step=29850 Epoch=58.4] | Loss=0.01504 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.075 | L2-Norm(final)=13.613 | 4771.4 samples/s | 74.6 steps/s
[Step=29900 Epoch=58.5] | Loss=0.01501 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.082 | L2-Norm(final)=13.613 | 4744.3 samples/s | 74.1 steps/s
[Step=29950 Epoch=58.6] | Loss=0.01487 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=13.613 | 4845.1 samples/s | 75.7 steps/s
[Step=30000 Epoch=58.6] | Loss=0.01476 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.096 | L2-Norm(final)=13.613 | 4834.4 samples/s | 75.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step30000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=28001 Epoch=107.3] | Loss=0.00013 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.564 | L2-Norm(final)=15.246 | 4627.5 samples/s | 72.3 steps/s
[Step=28050 Epoch=107.5] | Loss=0.00072 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.561 | L2-Norm(final)=15.253 | 4515.5 samples/s | 70.6 steps/s
[Step=28100 Epoch=107.7] | Loss=0.00047 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.561 | L2-Norm(final)=15.259 | 5425.0 samples/s | 84.8 steps/s
[Step=28150 Epoch=107.9] | Loss=0.00044 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.561 | L2-Norm(final)=15.265 | 5248.6 samples/s | 82.0 steps/s
[Step=28200 Epoch=108.1] | Loss=0.00037 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.561 | L2-Norm(final)=15.272 | 5326.3 samples/s | 83.2 steps/s
[Step=28250 Epoch=108.2] | Loss=0.00034 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.561 | L2-Norm(final)=15.278 | 6862.8 samples/s | 107.2 steps/s
[Step=28300 Epoch=108.4] | Loss=0.00040 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.561 | L2-Norm(final)=15.284 | 2098.5 samples/s | 32.8 steps/s
[Step=28350 Epoch=108.6] | Loss=0.00037 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.561 | L2-Norm(final)=15.289 | 5209.6 samples/s | 81.4 steps/s
[Step=28400 Epoch=108.8] | Loss=0.00035 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.561 | L2-Norm(final)=15.294 | 5272.6 samples/s | 82.4 steps/s
[Step=28450 Epoch=109.0] | Loss=0.00034 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.561 | L2-Norm(final)=15.300 | 5212.8 samples/s | 81.5 steps/s
[Step=28500 Epoch=109.2] | Loss=0.00034 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.561 | L2-Norm(final)=15.305 | 5602.6 samples/s | 87.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=28501 Epoch=109.2] | Loss=0.00045 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.561 | L2-Norm(final)=15.360 | 4324.8 samples/s | 67.6 steps/s
[Step=28550 Epoch=109.4] | Loss=0.00015 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.565 | L2-Norm(final)=15.366 | 4485.5 samples/s | 70.1 steps/s
[Step=28600 Epoch=109.6] | Loss=0.00009 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.566 | L2-Norm(final)=15.370 | 4616.2 samples/s | 72.1 steps/s
[Step=28650 Epoch=109.8] | Loss=0.00007 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.560 | L2-Norm(final)=15.372 | 4641.6 samples/s | 72.5 steps/s
[Step=28700 Epoch=110.0] | Loss=0.00006 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.551 | L2-Norm(final)=15.373 | 4641.5 samples/s | 72.5 steps/s
[Step=28750 Epoch=110.2] | Loss=0.00005 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.540 | L2-Norm(final)=15.375 | 5836.7 samples/s | 91.2 steps/s
[Step=28800 Epoch=110.4] | Loss=0.00004 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.528 | L2-Norm(final)=15.376 | 1963.0 samples/s | 30.7 steps/s
[Step=28850 Epoch=110.5] | Loss=0.00004 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.516 | L2-Norm(final)=15.377 | 4455.6 samples/s | 69.6 steps/s
[Step=28900 Epoch=110.7] | Loss=0.00003 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.503 | L2-Norm(final)=15.378 | 4540.6 samples/s | 70.9 steps/s
[Step=28950 Epoch=110.9] | Loss=0.00003 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.491 | L2-Norm(final)=15.379 | 4468.7 samples/s | 69.8 steps/s
[Step=29000 Epoch=111.1] | Loss=0.00003 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=15.380 | 5046.6 samples/s | 78.9 steps/s
[Step=29050 Epoch=111.3] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.465 | L2-Norm(final)=15.381 | 2054.9 samples/s | 32.1 steps/s
[Step=29100 Epoch=111.5] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.453 | L2-Norm(final)=15.381 | 4614.4 samples/s | 72.1 steps/s
[Step=29150 Epoch=111.7] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.440 | L2-Norm(final)=15.382 | 4612.2 samples/s | 72.1 steps/s
[Step=29200 Epoch=111.9] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.427 | L2-Norm(final)=15.383 | 4493.8 samples/s | 70.2 steps/s
[Step=29250 Epoch=112.1] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.415 | L2-Norm(final)=15.384 | 4599.1 samples/s | 71.9 steps/s
[Step=29300 Epoch=112.3] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=15.384 | 2130.5 samples/s | 33.3 steps/s
[Step=29350 Epoch=112.5] | Loss=0.00002 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.390 | L2-Norm(final)=15.385 | 4737.5 samples/s | 74.0 steps/s
[Step=29400 Epoch=112.7] | Loss=0.00001 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.377 | L2-Norm(final)=15.386 | 4621.3 samples/s | 72.2 steps/s
[Step=29450 Epoch=112.8] | Loss=0.00001 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.365 | L2-Norm(final)=15.386 | 4629.7 samples/s | 72.3 steps/s
[Step=29500 Epoch=113.0] | Loss=0.00001 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=15.387 | 4714.9 samples/s | 73.7 steps/s
[Step=29550 Epoch=113.2] | Loss=0.00001 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=15.387 | 2187.0 samples/s | 34.2 steps/s
[Step=29600 Epoch=113.4] | Loss=0.00001 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.327 | L2-Norm(final)=15.388 | 4509.5 samples/s | 70.5 steps/s
[Step=29650 Epoch=113.6] | Loss=0.00001 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.315 | L2-Norm(final)=15.389 | 4512.9 samples/s | 70.5 steps/s
[Step=29700 Epoch=113.8] | Loss=0.00001 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.302 | L2-Norm(final)=15.389 | 4525.9 samples/s | 70.7 steps/s
[Step=29750 Epoch=114.0] | Loss=0.00001 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=15.390 | 4609.9 samples/s | 72.0 steps/s
[Step=29800 Epoch=114.2] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.277 | L2-Norm(final)=15.390 | 6051.1 samples/s | 94.5 steps/s
[Step=29850 Epoch=114.4] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.264 | L2-Norm(final)=15.391 | 1929.3 samples/s | 30.1 steps/s
[Step=29900 Epoch=114.6] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.252 | L2-Norm(final)=15.391 | 4636.7 samples/s | 72.4 steps/s
[Step=29950 Epoch=114.8] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.239 | L2-Norm(final)=15.392 | 4624.2 samples/s | 72.3 steps/s
[Step=30000 Epoch=114.9] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.226 | L2-Norm(final)=15.393 | 4587.0 samples/s | 71.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step30000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=28001 Epoch=107.8] | Loss=0.00120 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.564 | L2-Norm(final)=14.774 | 4364.3 samples/s | 68.2 steps/s
[Step=28050 Epoch=108.0] | Loss=0.00044 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.558 | L2-Norm(final)=14.794 | 4732.2 samples/s | 73.9 steps/s
[Step=28100 Epoch=108.2] | Loss=0.00050 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.558 | L2-Norm(final)=14.816 | 5102.8 samples/s | 79.7 steps/s
[Step=28150 Epoch=108.4] | Loss=0.00050 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=14.839 | 5166.3 samples/s | 80.7 steps/s
[Step=28200 Epoch=108.6] | Loss=0.00052 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=14.861 | 5216.1 samples/s | 81.5 steps/s
[Step=28250 Epoch=108.7] | Loss=0.00050 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=14.884 | 6745.7 samples/s | 105.4 steps/s
[Step=28300 Epoch=108.9] | Loss=0.00052 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=14.904 | 2019.9 samples/s | 31.6 steps/s
[Step=28350 Epoch=109.1] | Loss=0.00051 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=14.924 | 5151.6 samples/s | 80.5 steps/s
[Step=28400 Epoch=109.3] | Loss=0.00051 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=14.943 | 5204.6 samples/s | 81.3 steps/s
[Step=28450 Epoch=109.5] | Loss=0.00048 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=14.960 | 5225.9 samples/s | 81.7 steps/s
[Step=28500 Epoch=109.7] | Loss=0.00047 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=14.977 | 5847.2 samples/s | 91.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=28501 Epoch=109.7] | Loss=0.00024 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=15.142 | 4642.6 samples/s | 72.5 steps/s
[Step=28550 Epoch=109.9] | Loss=0.00933 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.593 | L2-Norm(final)=15.145 | 4208.8 samples/s | 65.8 steps/s
[Step=28600 Epoch=110.1] | Loss=0.00990 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.742 | L2-Norm(final)=15.115 | 4526.6 samples/s | 70.7 steps/s
[Step=28650 Epoch=110.3] | Loss=0.00755 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.823 | L2-Norm(final)=15.098 | 4551.2 samples/s | 71.1 steps/s
[Step=28700 Epoch=110.5] | Loss=0.00822 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.873 | L2-Norm(final)=15.088 | 4445.6 samples/s | 69.5 steps/s
[Step=28750 Epoch=110.7] | Loss=0.00705 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.911 | L2-Norm(final)=15.079 | 5785.3 samples/s | 90.4 steps/s
[Step=28800 Epoch=110.9] | Loss=0.00593 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.935 | L2-Norm(final)=15.074 | 1940.4 samples/s | 30.3 steps/s
[Step=28850 Epoch=111.1] | Loss=0.00515 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.951 | L2-Norm(final)=15.071 | 4479.5 samples/s | 70.0 steps/s
[Step=28900 Epoch=111.2] | Loss=0.00451 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=15.069 | 4629.2 samples/s | 72.3 steps/s
[Step=28950 Epoch=111.4] | Loss=0.00403 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.967 | L2-Norm(final)=15.068 | 4565.3 samples/s | 71.3 steps/s
[Step=29000 Epoch=111.6] | Loss=0.00363 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.971 | L2-Norm(final)=15.068 | 5188.6 samples/s | 81.1 steps/s
[Step=29050 Epoch=111.8] | Loss=0.00331 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.972 | L2-Norm(final)=15.067 | 2053.3 samples/s | 32.1 steps/s
[Step=29100 Epoch=112.0] | Loss=0.00303 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.972 | L2-Norm(final)=15.067 | 4670.0 samples/s | 73.0 steps/s
[Step=29150 Epoch=112.2] | Loss=0.00280 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.971 | L2-Norm(final)=15.068 | 4542.0 samples/s | 71.0 steps/s
[Step=29200 Epoch=112.4] | Loss=0.00260 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.968 | L2-Norm(final)=15.068 | 4535.7 samples/s | 70.9 steps/s
[Step=29250 Epoch=112.6] | Loss=0.00243 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.965 | L2-Norm(final)=15.069 | 4602.6 samples/s | 71.9 steps/s
[Step=29300 Epoch=112.8] | Loss=0.00227 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=15.069 | 2104.2 samples/s | 32.9 steps/s
[Step=29350 Epoch=113.0] | Loss=0.00214 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.957 | L2-Norm(final)=15.070 | 4585.4 samples/s | 71.6 steps/s
[Step=29400 Epoch=113.2] | Loss=0.00202 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.952 | L2-Norm(final)=15.071 | 4497.8 samples/s | 70.3 steps/s
[Step=29450 Epoch=113.4] | Loss=0.00192 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.947 | L2-Norm(final)=15.072 | 4455.6 samples/s | 69.6 steps/s
[Step=29500 Epoch=113.6] | Loss=0.00182 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.942 | L2-Norm(final)=15.073 | 4519.7 samples/s | 70.6 steps/s
[Step=29550 Epoch=113.7] | Loss=0.00173 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.936 | L2-Norm(final)=15.073 | 2140.2 samples/s | 33.4 steps/s
[Step=29600 Epoch=113.9] | Loss=0.00166 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.930 | L2-Norm(final)=15.074 | 4532.1 samples/s | 70.8 steps/s
[Step=29650 Epoch=114.1] | Loss=0.00158 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.924 | L2-Norm(final)=15.075 | 4515.1 samples/s | 70.5 steps/s
[Step=29700 Epoch=114.3] | Loss=0.00152 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.918 | L2-Norm(final)=15.076 | 4543.9 samples/s | 71.0 steps/s
[Step=29750 Epoch=114.5] | Loss=0.00146 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.912 | L2-Norm(final)=15.077 | 4486.9 samples/s | 70.1 steps/s
[Step=29800 Epoch=114.7] | Loss=0.00140 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.905 | L2-Norm(final)=15.078 | 6609.3 samples/s | 103.3 steps/s
[Step=29850 Epoch=114.9] | Loss=0.00135 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.899 | L2-Norm(final)=15.079 | 1857.2 samples/s | 29.0 steps/s
[Step=29900 Epoch=115.1] | Loss=0.00130 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.892 | L2-Norm(final)=15.080 | 4459.3 samples/s | 69.7 steps/s
[Step=29950 Epoch=115.3] | Loss=0.00126 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.885 | L2-Norm(final)=15.081 | 4435.2 samples/s | 69.3 steps/s
[Step=30000 Epoch=115.5] | Loss=0.00122 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.878 | L2-Norm(final)=15.082 | 4532.6 samples/s | 70.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step30000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07083 | acc=0.9671 | tpr=0.9774 | fpr=0.0553 | 4447.1 samples/s | 17.4 steps/s
Avg test loss: 0.06811, Avg test acc: 0.96702, Avg tpr: 0.97744, Avg fpr: 0.05589, total FA: 436

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07216 | acc=0.9672 | tpr=0.9781 | fpr=0.0565 | 4575.2 samples/s | 17.9 steps/s
Avg test loss: 0.07025, Avg test acc: 0.96722, Avg tpr: 0.97797, Avg fpr: 0.05640, total FA: 440

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.58663 | acc=0.3076 | tpr=0.0164 | fpr=0.0602 | 4389.2 samples/s | 17.1 steps/s
Avg test loss: 6.59951, Avg test acc: 0.30559, Avg tpr: 0.01667, Avg fpr: 0.05897, total FA: 460

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.70219 | acc=0.3145 | tpr=0.0091 | fpr=0.0223 | 4442.2 samples/s | 17.4 steps/s
Avg test loss: 7.72209, Avg test acc: 0.31180, Avg tpr: 0.00921, Avg fpr: 0.02269, total FA: 177

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.70118 | acc=0.1005 | tpr=0.7788 | fpr=0.9116 | 4403.8 samples/s | 17.2 steps/s
[Step= 100] | Loss=5.66420 | acc=0.1015 | tpr=0.7932 | fpr=0.9114 | 8708.1 samples/s | 34.0 steps/s
[Step= 150] | Loss=5.67319 | acc=0.1011 | tpr=0.7983 | fpr=0.9117 | 8634.5 samples/s | 33.7 steps/s
[Step= 200] | Loss=5.66676 | acc=0.1005 | tpr=0.7989 | fpr=0.9122 | 8226.4 samples/s | 32.1 steps/s
[Step= 250] | Loss=5.67558 | acc=0.1002 | tpr=0.7939 | fpr=0.9124 | 8138.7 samples/s | 31.8 steps/s
[Step= 300] | Loss=5.67133 | acc=0.1004 | tpr=0.7913 | fpr=0.9122 | 8548.5 samples/s | 33.4 steps/s
[Step= 350] | Loss=5.67061 | acc=0.0997 | tpr=0.7846 | fpr=0.9127 | 8364.4 samples/s | 32.7 steps/s
[Step= 400] | Loss=5.67618 | acc=0.0995 | tpr=0.7839 | fpr=0.9130 | 8931.0 samples/s | 34.9 steps/s
[Step= 450] | Loss=5.67958 | acc=0.0995 | tpr=0.7892 | fpr=0.9130 | 8387.7 samples/s | 32.8 steps/s
[Step= 500] | Loss=5.67898 | acc=0.0994 | tpr=0.7890 | fpr=0.9130 | 7948.1 samples/s | 31.0 steps/s
[Step= 550] | Loss=5.68004 | acc=0.0992 | tpr=0.7871 | fpr=0.9133 | 15605.4 samples/s | 61.0 steps/s
Avg test loss: 5.67945, Avg test acc: 0.09916, Avg tpr: 0.78803, Avg fpr: 0.91337, total FA: 126819

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.46722 | acc=0.1141 | tpr=0.8230 | fpr=0.8986 | 4444.4 samples/s | 17.4 steps/s
[Step= 100] | Loss=7.43197 | acc=0.1151 | tpr=0.8060 | fpr=0.8978 | 8398.3 samples/s | 32.8 steps/s
[Step= 150] | Loss=7.43751 | acc=0.1135 | tpr=0.8127 | fpr=0.8993 | 8795.2 samples/s | 34.4 steps/s
[Step= 200] | Loss=7.43092 | acc=0.1134 | tpr=0.7989 | fpr=0.8991 | 8240.7 samples/s | 32.2 steps/s
[Step= 250] | Loss=7.44467 | acc=0.1138 | tpr=0.7991 | fpr=0.8987 | 8405.4 samples/s | 32.8 steps/s
[Step= 300] | Loss=7.43958 | acc=0.1134 | tpr=0.7964 | fpr=0.8991 | 8256.0 samples/s | 32.3 steps/s
[Step= 350] | Loss=7.43403 | acc=0.1126 | tpr=0.7946 | fpr=0.8998 | 8509.2 samples/s | 33.2 steps/s
[Step= 400] | Loss=7.43506 | acc=0.1128 | tpr=0.7943 | fpr=0.8996 | 8295.7 samples/s | 32.4 steps/s
[Step= 450] | Loss=7.43812 | acc=0.1130 | tpr=0.7984 | fpr=0.8994 | 9006.2 samples/s | 35.2 steps/s
[Step= 500] | Loss=7.43883 | acc=0.1129 | tpr=0.7960 | fpr=0.8994 | 8027.2 samples/s | 31.4 steps/s
[Step= 550] | Loss=7.44378 | acc=0.1126 | tpr=0.7967 | fpr=0.8999 | 15720.3 samples/s | 61.4 steps/s
Avg test loss: 7.44402, Avg test acc: 0.11250, Avg tpr: 0.79715, Avg fpr: 0.89994, total FA: 124955

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13298 | acc=0.9838 | tpr=0.9204 | fpr=0.0151 | 4492.8 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.14145 | acc=0.9829 | tpr=0.9360 | fpr=0.0162 | 8384.7 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.14829 | acc=0.9821 | tpr=0.9409 | fpr=0.0172 | 8332.8 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.14811 | acc=0.9824 | tpr=0.9486 | fpr=0.0169 | 8538.6 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.14622 | acc=0.9825 | tpr=0.9485 | fpr=0.0169 | 8908.8 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.14792 | acc=0.9824 | tpr=0.9513 | fpr=0.0170 | 8292.0 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.14995 | acc=0.9821 | tpr=0.9505 | fpr=0.0173 | 8592.9 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.15173 | acc=0.9820 | tpr=0.9486 | fpr=0.0174 | 8538.8 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.15465 | acc=0.9816 | tpr=0.9484 | fpr=0.0177 | 8013.4 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.15411 | acc=0.9817 | tpr=0.9489 | fpr=0.0177 | 8292.5 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.15286 | acc=0.9818 | tpr=0.9467 | fpr=0.0176 | 15682.3 samples/s | 61.3 steps/s
Avg test loss: 0.15246, Avg test acc: 0.98178, Avg tpr: 0.94612, Avg fpr: 0.01757, total FA: 2440

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11663 | acc=0.9837 | tpr=0.9292 | fpr=0.0153 | 4402.1 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.12446 | acc=0.9828 | tpr=0.9446 | fpr=0.0165 | 8445.5 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.13173 | acc=0.9821 | tpr=0.9510 | fpr=0.0174 | 8272.7 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.13195 | acc=0.9820 | tpr=0.9530 | fpr=0.0175 | 8570.4 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.12975 | acc=0.9821 | tpr=0.9485 | fpr=0.0172 | 8485.4 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.13201 | acc=0.9820 | tpr=0.9491 | fpr=0.0174 | 8301.3 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.13364 | acc=0.9818 | tpr=0.9499 | fpr=0.0176 | 8446.1 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.13529 | acc=0.9815 | tpr=0.9464 | fpr=0.0178 | 8257.1 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.13801 | acc=0.9813 | tpr=0.9464 | fpr=0.0181 | 8463.7 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.13778 | acc=0.9812 | tpr=0.9454 | fpr=0.0181 | 8964.8 samples/s | 35.0 steps/s
[Step= 550] | Loss=0.13672 | acc=0.9814 | tpr=0.9447 | fpr=0.0179 | 13651.5 samples/s | 53.3 steps/s
Avg test loss: 0.13641, Avg test acc: 0.98144, Avg tpr: 0.94453, Avg fpr: 0.01789, total FA: 2484

server round 15/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=30001 Epoch=58.5] | Loss=0.02064 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.484 | L2-Norm(final)=13.307 | 4414.5 samples/s | 69.0 steps/s
[Step=30050 Epoch=58.6] | Loss=0.01916 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=13.314 | 5025.1 samples/s | 78.5 steps/s
[Step=30100 Epoch=58.7] | Loss=0.01929 | Reg=0.00182 | acc=0.9531 | L2-Norm=13.486 | L2-Norm(final)=13.328 | 5379.7 samples/s | 84.1 steps/s
[Step=30150 Epoch=58.8] | Loss=0.01929 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.487 | L2-Norm(final)=13.338 | 5480.4 samples/s | 85.6 steps/s
[Step=30200 Epoch=58.9] | Loss=0.01849 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.487 | L2-Norm(final)=13.347 | 5420.6 samples/s | 84.7 steps/s
[Step=30250 Epoch=59.0] | Loss=0.01812 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.487 | L2-Norm(final)=13.359 | 5553.4 samples/s | 86.8 steps/s
[Step=30300 Epoch=59.1] | Loss=0.01809 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.487 | L2-Norm(final)=13.371 | 5492.0 samples/s | 85.8 steps/s
[Step=30350 Epoch=59.2] | Loss=0.01876 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.487 | L2-Norm(final)=13.382 | 5516.1 samples/s | 86.2 steps/s
[Step=30400 Epoch=59.3] | Loss=0.01843 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.487 | L2-Norm(final)=13.392 | 5597.8 samples/s | 87.5 steps/s
[Step=30450 Epoch=59.4] | Loss=0.01808 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.487 | L2-Norm(final)=13.404 | 5450.7 samples/s | 85.2 steps/s
[Step=30500 Epoch=59.5] | Loss=0.01812 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.487 | L2-Norm(final)=13.416 | 7019.6 samples/s | 109.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=30501 Epoch=59.5] | Loss=0.02642 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.487 | L2-Norm(final)=13.535 | 4031.8 samples/s | 63.0 steps/s
[Step=30550 Epoch=59.6] | Loss=0.01733 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.532 | L2-Norm(final)=13.535 | 4739.7 samples/s | 74.1 steps/s
[Step=30600 Epoch=59.7] | Loss=0.01749 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.576 | L2-Norm(final)=13.533 | 4811.6 samples/s | 75.2 steps/s
[Step=30650 Epoch=59.8] | Loss=0.01854 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.614 | L2-Norm(final)=13.528 | 4793.2 samples/s | 74.9 steps/s
[Step=30700 Epoch=59.9] | Loss=0.01976 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.644 | L2-Norm(final)=13.525 | 4830.8 samples/s | 75.5 steps/s
[Step=30750 Epoch=60.0] | Loss=0.01942 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.671 | L2-Norm(final)=13.523 | 4751.8 samples/s | 74.2 steps/s
[Step=30800 Epoch=60.1] | Loss=0.01853 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.696 | L2-Norm(final)=13.521 | 4792.2 samples/s | 74.9 steps/s
[Step=30850 Epoch=60.2] | Loss=0.01798 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.718 | L2-Norm(final)=13.520 | 4752.7 samples/s | 74.3 steps/s
[Step=30900 Epoch=60.3] | Loss=0.01825 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.739 | L2-Norm(final)=13.519 | 4724.9 samples/s | 73.8 steps/s
[Step=30950 Epoch=60.4] | Loss=0.01872 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=13.517 | 4793.1 samples/s | 74.9 steps/s
[Step=31000 Epoch=60.5] | Loss=0.01891 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.777 | L2-Norm(final)=13.515 | 5879.0 samples/s | 91.9 steps/s
[Step=31050 Epoch=60.6] | Loss=0.01835 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.794 | L2-Norm(final)=13.513 | 1945.9 samples/s | 30.4 steps/s
[Step=31100 Epoch=60.7] | Loss=0.01766 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.809 | L2-Norm(final)=13.512 | 4690.4 samples/s | 73.3 steps/s
[Step=31150 Epoch=60.8] | Loss=0.01708 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.822 | L2-Norm(final)=13.512 | 4805.8 samples/s | 75.1 steps/s
[Step=31200 Epoch=60.9] | Loss=0.01681 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.834 | L2-Norm(final)=13.511 | 4788.2 samples/s | 74.8 steps/s
[Step=31250 Epoch=60.9] | Loss=0.01685 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.846 | L2-Norm(final)=13.510 | 4759.2 samples/s | 74.4 steps/s
[Step=31300 Epoch=61.0] | Loss=0.01652 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.857 | L2-Norm(final)=13.509 | 4769.6 samples/s | 74.5 steps/s
[Step=31350 Epoch=61.1] | Loss=0.01628 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.868 | L2-Norm(final)=13.509 | 4802.1 samples/s | 75.0 steps/s
[Step=31400 Epoch=61.2] | Loss=0.01633 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.879 | L2-Norm(final)=13.508 | 4835.2 samples/s | 75.6 steps/s
[Step=31450 Epoch=61.3] | Loss=0.01623 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.889 | L2-Norm(final)=13.508 | 4852.7 samples/s | 75.8 steps/s
[Step=31500 Epoch=61.4] | Loss=0.01604 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=13.507 | 5087.9 samples/s | 79.5 steps/s
[Step=31550 Epoch=61.5] | Loss=0.01582 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.910 | L2-Norm(final)=13.507 | 2052.1 samples/s | 32.1 steps/s
[Step=31600 Epoch=61.6] | Loss=0.01554 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.919 | L2-Norm(final)=13.508 | 4771.4 samples/s | 74.6 steps/s
[Step=31650 Epoch=61.7] | Loss=0.01544 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.928 | L2-Norm(final)=13.508 | 4706.1 samples/s | 73.5 steps/s
[Step=31700 Epoch=61.8] | Loss=0.01531 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.937 | L2-Norm(final)=13.508 | 4749.4 samples/s | 74.2 steps/s
[Step=31750 Epoch=61.9] | Loss=0.01515 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.945 | L2-Norm(final)=13.508 | 4748.5 samples/s | 74.2 steps/s
[Step=31800 Epoch=62.0] | Loss=0.01508 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.954 | L2-Norm(final)=13.508 | 4827.6 samples/s | 75.4 steps/s
[Step=31850 Epoch=62.1] | Loss=0.01487 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.961 | L2-Norm(final)=13.509 | 4760.5 samples/s | 74.4 steps/s
[Step=31900 Epoch=62.2] | Loss=0.01477 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.969 | L2-Norm(final)=13.509 | 4790.5 samples/s | 74.9 steps/s
[Step=31950 Epoch=62.3] | Loss=0.01462 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.976 | L2-Norm(final)=13.510 | 4789.5 samples/s | 74.8 steps/s
[Step=32000 Epoch=62.4] | Loss=0.01445 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.984 | L2-Norm(final)=13.510 | 4714.5 samples/s | 73.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step32000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=30001 Epoch=58.7] | Loss=0.00710 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.484 | L2-Norm(final)=13.612 | 4635.3 samples/s | 72.4 steps/s
[Step=30050 Epoch=58.7] | Loss=0.01990 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.487 | L2-Norm(final)=13.633 | 5006.3 samples/s | 78.2 steps/s
[Step=30100 Epoch=58.8] | Loss=0.02098 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.488 | L2-Norm(final)=13.662 | 5665.1 samples/s | 88.5 steps/s
[Step=30150 Epoch=58.9] | Loss=0.02097 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.488 | L2-Norm(final)=13.690 | 5652.4 samples/s | 88.3 steps/s
[Step=30200 Epoch=59.0] | Loss=0.01988 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.488 | L2-Norm(final)=13.713 | 5567.9 samples/s | 87.0 steps/s
[Step=30250 Epoch=59.1] | Loss=0.02013 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.488 | L2-Norm(final)=13.734 | 5449.3 samples/s | 85.1 steps/s
[Step=30300 Epoch=59.2] | Loss=0.01984 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.488 | L2-Norm(final)=13.754 | 5493.9 samples/s | 85.8 steps/s
[Step=30350 Epoch=59.3] | Loss=0.01973 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.488 | L2-Norm(final)=13.774 | 5552.7 samples/s | 86.8 steps/s
[Step=30400 Epoch=59.4] | Loss=0.01954 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.488 | L2-Norm(final)=13.794 | 5458.5 samples/s | 85.3 steps/s
[Step=30450 Epoch=59.5] | Loss=0.01926 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.488 | L2-Norm(final)=13.814 | 5497.9 samples/s | 85.9 steps/s
[Step=30500 Epoch=59.6] | Loss=0.01916 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.488 | L2-Norm(final)=13.833 | 7081.2 samples/s | 110.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=30501 Epoch=59.6] | Loss=0.00902 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.488 | L2-Norm(final)=14.028 | 4476.2 samples/s | 69.9 steps/s
[Step=30550 Epoch=59.7] | Loss=0.02109 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.556 | L2-Norm(final)=14.033 | 4532.3 samples/s | 70.8 steps/s
[Step=30600 Epoch=59.8] | Loss=0.02016 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.610 | L2-Norm(final)=14.031 | 4757.0 samples/s | 74.3 steps/s
[Step=30650 Epoch=59.9] | Loss=0.01867 | Reg=0.00186 | acc=0.9531 | L2-Norm=13.646 | L2-Norm(final)=14.032 | 4804.4 samples/s | 75.1 steps/s
[Step=30700 Epoch=60.0] | Loss=0.01934 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.675 | L2-Norm(final)=14.030 | 4778.4 samples/s | 74.7 steps/s
[Step=30750 Epoch=60.1] | Loss=0.01830 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=14.028 | 4750.7 samples/s | 74.2 steps/s
[Step=30800 Epoch=60.2] | Loss=0.01837 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.718 | L2-Norm(final)=14.027 | 4804.9 samples/s | 75.1 steps/s
[Step=30850 Epoch=60.3] | Loss=0.01865 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.738 | L2-Norm(final)=14.025 | 4816.1 samples/s | 75.3 steps/s
[Step=30900 Epoch=60.4] | Loss=0.01861 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.757 | L2-Norm(final)=14.023 | 4854.5 samples/s | 75.9 steps/s
[Step=30950 Epoch=60.5] | Loss=0.01828 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.774 | L2-Norm(final)=14.021 | 4771.0 samples/s | 74.5 steps/s
[Step=31000 Epoch=60.6] | Loss=0.01849 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.791 | L2-Norm(final)=14.019 | 5901.0 samples/s | 92.2 steps/s
[Step=31050 Epoch=60.7] | Loss=0.01833 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.808 | L2-Norm(final)=14.017 | 2044.3 samples/s | 31.9 steps/s
[Step=31100 Epoch=60.8] | Loss=0.01795 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.824 | L2-Norm(final)=14.015 | 4748.0 samples/s | 74.2 steps/s
[Step=31150 Epoch=60.9] | Loss=0.01750 | Reg=0.00192 | acc=0.9531 | L2-Norm=13.839 | L2-Norm(final)=14.014 | 4781.7 samples/s | 74.7 steps/s
[Step=31200 Epoch=61.0] | Loss=0.01725 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.853 | L2-Norm(final)=14.012 | 4804.7 samples/s | 75.1 steps/s
[Step=31250 Epoch=61.1] | Loss=0.01715 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.867 | L2-Norm(final)=14.011 | 4813.2 samples/s | 75.2 steps/s
[Step=31300 Epoch=61.2] | Loss=0.01697 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.880 | L2-Norm(final)=14.010 | 4787.2 samples/s | 74.8 steps/s
[Step=31350 Epoch=61.3] | Loss=0.01672 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.894 | L2-Norm(final)=14.009 | 4817.5 samples/s | 75.3 steps/s
[Step=31400 Epoch=61.4] | Loss=0.01648 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.907 | L2-Norm(final)=14.008 | 4806.4 samples/s | 75.1 steps/s
[Step=31450 Epoch=61.5] | Loss=0.01639 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.919 | L2-Norm(final)=14.007 | 4795.7 samples/s | 74.9 steps/s
[Step=31500 Epoch=61.6] | Loss=0.01621 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.931 | L2-Norm(final)=14.006 | 5167.0 samples/s | 80.7 steps/s
[Step=31550 Epoch=61.7] | Loss=0.01613 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.943 | L2-Norm(final)=14.005 | 2113.7 samples/s | 33.0 steps/s
[Step=31600 Epoch=61.8] | Loss=0.01592 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.954 | L2-Norm(final)=14.004 | 4766.1 samples/s | 74.5 steps/s
[Step=31650 Epoch=61.9] | Loss=0.01570 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.965 | L2-Norm(final)=14.003 | 4716.4 samples/s | 73.7 steps/s
[Step=31700 Epoch=62.0] | Loss=0.01550 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.976 | L2-Norm(final)=14.003 | 4760.1 samples/s | 74.4 steps/s
[Step=31750 Epoch=62.1] | Loss=0.01534 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.986 | L2-Norm(final)=14.003 | 4724.8 samples/s | 73.8 steps/s
[Step=31800 Epoch=62.2] | Loss=0.01518 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.995 | L2-Norm(final)=14.002 | 4742.5 samples/s | 74.1 steps/s
[Step=31850 Epoch=62.3] | Loss=0.01495 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.004 | L2-Norm(final)=14.002 | 4772.0 samples/s | 74.6 steps/s
[Step=31900 Epoch=62.4] | Loss=0.01479 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.013 | L2-Norm(final)=14.002 | 4748.0 samples/s | 74.2 steps/s
[Step=31950 Epoch=62.5] | Loss=0.01466 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.021 | L2-Norm(final)=14.002 | 4812.9 samples/s | 75.2 steps/s
[Step=32000 Epoch=62.6] | Loss=0.01462 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.029 | L2-Norm(final)=14.002 | 4711.8 samples/s | 73.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step32000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=30001 Epoch=115.0] | Loss=0.00002 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.484 | L2-Norm(final)=15.409 | 4180.2 samples/s | 65.3 steps/s
[Step=30050 Epoch=115.1] | Loss=0.00032 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=15.417 | 4978.8 samples/s | 77.8 steps/s
[Step=30100 Epoch=115.3] | Loss=0.00041 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=15.428 | 5075.5 samples/s | 79.3 steps/s
[Step=30150 Epoch=115.5] | Loss=0.00036 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=15.439 | 5070.4 samples/s | 79.2 steps/s
[Step=30200 Epoch=115.7] | Loss=0.00039 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=15.450 | 5110.6 samples/s | 79.9 steps/s
[Step=30250 Epoch=115.9] | Loss=0.00042 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=15.463 | 6838.7 samples/s | 106.9 steps/s
[Step=30300 Epoch=116.1] | Loss=0.00041 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=15.477 | 2007.3 samples/s | 31.4 steps/s
[Step=30350 Epoch=116.3] | Loss=0.00039 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=15.490 | 5228.9 samples/s | 81.7 steps/s
[Step=30400 Epoch=116.5] | Loss=0.00040 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=15.503 | 5237.5 samples/s | 81.8 steps/s
[Step=30450 Epoch=116.7] | Loss=0.00041 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=15.515 | 4997.4 samples/s | 78.1 steps/s
[Step=30500 Epoch=116.9] | Loss=0.00040 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=15.527 | 5662.4 samples/s | 88.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=30501 Epoch=116.9] | Loss=0.00031 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=15.649 | 4322.9 samples/s | 67.5 steps/s
[Step=30550 Epoch=117.1] | Loss=0.00007 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.466 | L2-Norm(final)=15.658 | 4218.7 samples/s | 65.9 steps/s
[Step=30600 Epoch=117.2] | Loss=0.00009 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.445 | L2-Norm(final)=15.663 | 4491.2 samples/s | 70.2 steps/s
[Step=30650 Epoch=117.4] | Loss=0.00106 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.456 | L2-Norm(final)=15.663 | 4491.9 samples/s | 70.2 steps/s
[Step=30700 Epoch=117.6] | Loss=0.00263 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.513 | L2-Norm(final)=15.652 | 4497.6 samples/s | 70.3 steps/s
[Step=30750 Epoch=117.8] | Loss=0.00250 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.569 | L2-Norm(final)=15.642 | 5645.4 samples/s | 88.2 steps/s
[Step=30800 Epoch=118.0] | Loss=0.00210 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.608 | L2-Norm(final)=15.635 | 1948.9 samples/s | 30.5 steps/s
[Step=30850 Epoch=118.2] | Loss=0.00184 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.634 | L2-Norm(final)=15.630 | 4636.1 samples/s | 72.4 steps/s
[Step=30900 Epoch=118.4] | Loss=0.00170 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.652 | L2-Norm(final)=15.626 | 4525.0 samples/s | 70.7 steps/s
[Step=30950 Epoch=118.6] | Loss=0.00153 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.667 | L2-Norm(final)=15.624 | 4609.9 samples/s | 72.0 steps/s
[Step=31000 Epoch=118.8] | Loss=0.00139 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.678 | L2-Norm(final)=15.622 | 5106.6 samples/s | 79.8 steps/s
[Step=31050 Epoch=119.0] | Loss=0.00126 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.685 | L2-Norm(final)=15.621 | 2038.1 samples/s | 31.8 steps/s
[Step=31100 Epoch=119.2] | Loss=0.00116 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.689 | L2-Norm(final)=15.620 | 4541.0 samples/s | 71.0 steps/s
[Step=31150 Epoch=119.4] | Loss=0.00107 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.692 | L2-Norm(final)=15.620 | 4486.7 samples/s | 70.1 steps/s
[Step=31200 Epoch=119.5] | Loss=0.00099 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.693 | L2-Norm(final)=15.619 | 4510.1 samples/s | 70.5 steps/s
[Step=31250 Epoch=119.7] | Loss=0.00093 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.692 | L2-Norm(final)=15.620 | 4520.9 samples/s | 70.6 steps/s
[Step=31300 Epoch=119.9] | Loss=0.00087 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.691 | L2-Norm(final)=15.620 | 2101.2 samples/s | 32.8 steps/s
[Step=31350 Epoch=120.1] | Loss=0.00082 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.688 | L2-Norm(final)=15.620 | 4687.9 samples/s | 73.2 steps/s
[Step=31400 Epoch=120.3] | Loss=0.00077 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.685 | L2-Norm(final)=15.621 | 4555.8 samples/s | 71.2 steps/s
[Step=31450 Epoch=120.5] | Loss=0.00073 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.682 | L2-Norm(final)=15.621 | 4400.7 samples/s | 68.8 steps/s
[Step=31500 Epoch=120.7] | Loss=0.00070 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.677 | L2-Norm(final)=15.621 | 4520.3 samples/s | 70.6 steps/s
[Step=31550 Epoch=120.9] | Loss=0.00066 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.673 | L2-Norm(final)=15.622 | 2154.8 samples/s | 33.7 steps/s
[Step=31600 Epoch=121.1] | Loss=0.00063 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.668 | L2-Norm(final)=15.622 | 4673.5 samples/s | 73.0 steps/s
[Step=31650 Epoch=121.3] | Loss=0.00061 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.662 | L2-Norm(final)=15.622 | 4572.9 samples/s | 71.5 steps/s
[Step=31700 Epoch=121.5] | Loss=0.00058 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.657 | L2-Norm(final)=15.622 | 4626.9 samples/s | 72.3 steps/s
[Step=31750 Epoch=121.7] | Loss=0.00056 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.651 | L2-Norm(final)=15.623 | 4660.7 samples/s | 72.8 steps/s
[Step=31800 Epoch=121.8] | Loss=0.00054 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.645 | L2-Norm(final)=15.623 | 6280.9 samples/s | 98.1 steps/s
[Step=31850 Epoch=122.0] | Loss=0.00052 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.638 | L2-Norm(final)=15.623 | 1940.1 samples/s | 30.3 steps/s
[Step=31900 Epoch=122.2] | Loss=0.00050 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.632 | L2-Norm(final)=15.624 | 4599.4 samples/s | 71.9 steps/s
[Step=31950 Epoch=122.4] | Loss=0.00048 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.625 | L2-Norm(final)=15.624 | 4655.2 samples/s | 72.7 steps/s
[Step=32000 Epoch=122.6] | Loss=0.00047 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=15.624 | 4650.2 samples/s | 72.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step32000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=30001 Epoch=115.5] | Loss=0.00003 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.484 | L2-Norm(final)=15.111 | 4340.6 samples/s | 67.8 steps/s
[Step=30050 Epoch=115.7] | Loss=0.00034 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.482 | L2-Norm(final)=15.117 | 4659.5 samples/s | 72.8 steps/s
[Step=30100 Epoch=115.9] | Loss=0.00051 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=15.123 | 5158.8 samples/s | 80.6 steps/s
[Step=30150 Epoch=116.1] | Loss=0.00054 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=15.130 | 5118.1 samples/s | 80.0 steps/s
[Step=30200 Epoch=116.3] | Loss=0.00051 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=15.137 | 5138.0 samples/s | 80.3 steps/s
[Step=30250 Epoch=116.4] | Loss=0.00048 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=15.145 | 6846.4 samples/s | 107.0 steps/s
[Step=30300 Epoch=116.6] | Loss=0.00047 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=15.152 | 2010.1 samples/s | 31.4 steps/s
[Step=30350 Epoch=116.8] | Loss=0.00045 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=15.159 | 5166.5 samples/s | 80.7 steps/s
[Step=30400 Epoch=117.0] | Loss=0.00048 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.481 | L2-Norm(final)=15.166 | 5229.1 samples/s | 81.7 steps/s
[Step=30450 Epoch=117.2] | Loss=0.00047 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=15.174 | 5147.0 samples/s | 80.4 steps/s
[Step=30500 Epoch=117.4] | Loss=0.00048 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=15.181 | 5835.3 samples/s | 91.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=30501 Epoch=117.4] | Loss=0.00003 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=15.251 | 4423.7 samples/s | 69.1 steps/s
[Step=30550 Epoch=117.6] | Loss=0.00028 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.484 | L2-Norm(final)=15.255 | 4160.3 samples/s | 65.0 steps/s
[Step=30600 Epoch=117.8] | Loss=0.00018 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.483 | L2-Norm(final)=15.257 | 4512.2 samples/s | 70.5 steps/s
[Step=30650 Epoch=118.0] | Loss=0.00014 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.477 | L2-Norm(final)=15.259 | 4538.2 samples/s | 70.9 steps/s
[Step=30700 Epoch=118.2] | Loss=0.00011 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.470 | L2-Norm(final)=15.261 | 4496.6 samples/s | 70.3 steps/s
[Step=30750 Epoch=118.4] | Loss=0.00009 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.460 | L2-Norm(final)=15.262 | 5787.4 samples/s | 90.4 steps/s
[Step=30800 Epoch=118.6] | Loss=0.00008 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.449 | L2-Norm(final)=15.263 | 1921.2 samples/s | 30.0 steps/s
[Step=30850 Epoch=118.8] | Loss=0.00007 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.438 | L2-Norm(final)=15.264 | 4484.9 samples/s | 70.1 steps/s
[Step=30900 Epoch=118.9] | Loss=0.00006 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.426 | L2-Norm(final)=15.265 | 4488.4 samples/s | 70.1 steps/s
[Step=30950 Epoch=119.1] | Loss=0.00005 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.413 | L2-Norm(final)=15.266 | 4445.0 samples/s | 69.5 steps/s
[Step=31000 Epoch=119.3] | Loss=0.00005 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.401 | L2-Norm(final)=15.266 | 5159.4 samples/s | 80.6 steps/s
[Step=31050 Epoch=119.5] | Loss=0.00004 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.389 | L2-Norm(final)=15.267 | 2063.5 samples/s | 32.2 steps/s
[Step=31100 Epoch=119.7] | Loss=0.00004 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.376 | L2-Norm(final)=15.267 | 4560.6 samples/s | 71.3 steps/s
[Step=31150 Epoch=119.9] | Loss=0.00004 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.364 | L2-Norm(final)=15.268 | 4557.6 samples/s | 71.2 steps/s
[Step=31200 Epoch=120.1] | Loss=0.00003 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=15.268 | 4549.2 samples/s | 71.1 steps/s
[Step=31250 Epoch=120.3] | Loss=0.00003 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.339 | L2-Norm(final)=15.269 | 4595.0 samples/s | 71.8 steps/s
[Step=31300 Epoch=120.5] | Loss=0.00003 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.327 | L2-Norm(final)=15.269 | 2081.2 samples/s | 32.5 steps/s
[Step=31350 Epoch=120.7] | Loss=0.00003 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.315 | L2-Norm(final)=15.270 | 4611.2 samples/s | 72.1 steps/s
[Step=31400 Epoch=120.9] | Loss=0.00003 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.302 | L2-Norm(final)=15.270 | 4591.0 samples/s | 71.7 steps/s
[Step=31450 Epoch=121.1] | Loss=0.00003 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=15.271 | 4487.0 samples/s | 70.1 steps/s
[Step=31500 Epoch=121.3] | Loss=0.00002 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.278 | L2-Norm(final)=15.271 | 4502.5 samples/s | 70.4 steps/s
[Step=31550 Epoch=121.4] | Loss=0.00002 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.266 | L2-Norm(final)=15.272 | 2097.1 samples/s | 32.8 steps/s
[Step=31600 Epoch=121.6] | Loss=0.00002 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.254 | L2-Norm(final)=15.273 | 4482.6 samples/s | 70.0 steps/s
[Step=31650 Epoch=121.8] | Loss=0.00002 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.242 | L2-Norm(final)=15.273 | 4528.3 samples/s | 70.8 steps/s
[Step=31700 Epoch=122.0] | Loss=0.00002 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.230 | L2-Norm(final)=15.274 | 4675.3 samples/s | 73.1 steps/s
[Step=31750 Epoch=122.2] | Loss=0.00002 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.217 | L2-Norm(final)=15.274 | 4615.6 samples/s | 72.1 steps/s
[Step=31800 Epoch=122.4] | Loss=0.00002 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.205 | L2-Norm(final)=15.275 | 6794.8 samples/s | 106.2 steps/s
[Step=31850 Epoch=122.6] | Loss=0.00002 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.193 | L2-Norm(final)=15.275 | 1880.0 samples/s | 29.4 steps/s
[Step=31900 Epoch=122.8] | Loss=0.00002 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.181 | L2-Norm(final)=15.276 | 4447.4 samples/s | 69.5 steps/s
[Step=31950 Epoch=123.0] | Loss=0.00002 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.168 | L2-Norm(final)=15.277 | 4503.8 samples/s | 70.4 steps/s
[Step=32000 Epoch=123.2] | Loss=0.00002 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.156 | L2-Norm(final)=15.277 | 4505.6 samples/s | 70.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06759 | acc=0.9678 | tpr=0.9722 | fpr=0.0416 | 4492.7 samples/s | 17.5 steps/s
Avg test loss: 0.06691, Avg test acc: 0.96775, Avg tpr: 0.97249, Avg fpr: 0.04269, total FA: 333

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06869 | acc=0.9680 | tpr=0.9717 | fpr=0.0399 | 4379.0 samples/s | 17.1 steps/s
Avg test loss: 0.07015, Avg test acc: 0.96775, Avg tpr: 0.97057, Avg fpr: 0.03846, total FA: 300

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.12532 | acc=0.3170 | tpr=0.0062 | fpr=0.0082 | 4500.0 samples/s | 17.6 steps/s
Avg test loss: 7.14870, Avg test acc: 0.31329, Avg tpr: 0.00577, Avg fpr: 0.01038, total FA: 81

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.98356 | acc=0.2983 | tpr=0.0137 | fpr=0.0837 | 4454.0 samples/s | 17.4 steps/s
Avg test loss: 7.00275, Avg test acc: 0.29566, Avg tpr: 0.01370, Avg fpr: 0.08422, total FA: 657

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.75740 | acc=0.1172 | tpr=0.7257 | fpr=0.8937 | 4666.2 samples/s | 18.2 steps/s
[Step= 100] | Loss=5.72666 | acc=0.1168 | tpr=0.7143 | fpr=0.8943 | 7655.3 samples/s | 29.9 steps/s
[Step= 150] | Loss=5.73912 | acc=0.1155 | tpr=0.7205 | fpr=0.8956 | 8585.2 samples/s | 33.5 steps/s
[Step= 200] | Loss=5.73458 | acc=0.1145 | tpr=0.7093 | fpr=0.8964 | 8502.4 samples/s | 33.2 steps/s
[Step= 250] | Loss=5.74885 | acc=0.1142 | tpr=0.7118 | fpr=0.8967 | 8495.7 samples/s | 33.2 steps/s
[Step= 300] | Loss=5.74606 | acc=0.1139 | tpr=0.7055 | fpr=0.8969 | 8421.0 samples/s | 32.9 steps/s
[Step= 350] | Loss=5.73773 | acc=0.1135 | tpr=0.7013 | fpr=0.8971 | 8573.7 samples/s | 33.5 steps/s
[Step= 400] | Loss=5.74452 | acc=0.1136 | tpr=0.7013 | fpr=0.8971 | 8575.3 samples/s | 33.5 steps/s
[Step= 450] | Loss=5.74495 | acc=0.1139 | tpr=0.7020 | fpr=0.8968 | 8607.3 samples/s | 33.6 steps/s
[Step= 500] | Loss=5.74382 | acc=0.1140 | tpr=0.7040 | fpr=0.8967 | 8408.0 samples/s | 32.8 steps/s
[Step= 550] | Loss=5.74596 | acc=0.1137 | tpr=0.7012 | fpr=0.8970 | 14940.3 samples/s | 58.4 steps/s
Avg test loss: 5.74669, Avg test acc: 0.11364, Avg tpr: 0.70166, Avg fpr: 0.89705, total FA: 124553

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.23484 | acc=0.1384 | tpr=0.6991 | fpr=0.8716 | 4442.4 samples/s | 17.4 steps/s
[Step= 100] | Loss=6.19323 | acc=0.1390 | tpr=0.7122 | fpr=0.8717 | 8351.0 samples/s | 32.6 steps/s
[Step= 150] | Loss=6.20598 | acc=0.1375 | tpr=0.7190 | fpr=0.8732 | 8694.9 samples/s | 34.0 steps/s
[Step= 200] | Loss=6.20070 | acc=0.1372 | tpr=0.7115 | fpr=0.8732 | 8352.6 samples/s | 32.6 steps/s
[Step= 250] | Loss=6.21580 | acc=0.1372 | tpr=0.7127 | fpr=0.8733 | 8530.5 samples/s | 33.3 steps/s
[Step= 300] | Loss=6.21240 | acc=0.1369 | tpr=0.7040 | fpr=0.8735 | 8404.7 samples/s | 32.8 steps/s
[Step= 350] | Loss=6.20610 | acc=0.1360 | tpr=0.6957 | fpr=0.8742 | 8494.2 samples/s | 33.2 steps/s
[Step= 400] | Loss=6.21053 | acc=0.1361 | tpr=0.6893 | fpr=0.8739 | 8446.0 samples/s | 33.0 steps/s
[Step= 450] | Loss=6.21338 | acc=0.1361 | tpr=0.6894 | fpr=0.8740 | 8475.3 samples/s | 33.1 steps/s
[Step= 500] | Loss=6.21415 | acc=0.1359 | tpr=0.6890 | fpr=0.8741 | 8341.8 samples/s | 32.6 steps/s
[Step= 550] | Loss=6.21894 | acc=0.1357 | tpr=0.6880 | fpr=0.8744 | 15355.1 samples/s | 60.0 steps/s
Avg test loss: 6.21867, Avg test acc: 0.13559, Avg tpr: 0.68780, Avg fpr: 0.87445, total FA: 121416

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.15939 | acc=0.9835 | tpr=0.9248 | fpr=0.0154 | 4405.8 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.16917 | acc=0.9831 | tpr=0.9424 | fpr=0.0161 | 8505.2 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.17712 | acc=0.9824 | tpr=0.9467 | fpr=0.0169 | 8340.4 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.17966 | acc=0.9825 | tpr=0.9541 | fpr=0.0170 | 8505.6 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.17551 | acc=0.9827 | tpr=0.9528 | fpr=0.0167 | 8472.3 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.17854 | acc=0.9826 | tpr=0.9535 | fpr=0.0169 | 8541.2 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.18104 | acc=0.9822 | tpr=0.9518 | fpr=0.0172 | 8386.2 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.18285 | acc=0.9821 | tpr=0.9513 | fpr=0.0174 | 8891.0 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.18645 | acc=0.9818 | tpr=0.9503 | fpr=0.0177 | 7982.7 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.18630 | acc=0.9818 | tpr=0.9507 | fpr=0.0176 | 8510.7 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.18528 | acc=0.9819 | tpr=0.9495 | fpr=0.0175 | 14751.5 samples/s | 57.6 steps/s
Avg test loss: 0.18482, Avg test acc: 0.98189, Avg tpr: 0.94929, Avg fpr: 0.01752, total FA: 2432

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12461 | acc=0.9849 | tpr=0.9336 | fpr=0.0142 | 4478.3 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.13398 | acc=0.9838 | tpr=0.9510 | fpr=0.0156 | 8242.8 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.14029 | acc=0.9826 | tpr=0.9568 | fpr=0.0169 | 8692.1 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.14063 | acc=0.9828 | tpr=0.9628 | fpr=0.0169 | 8150.2 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.13855 | acc=0.9829 | tpr=0.9598 | fpr=0.0167 | 8733.7 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.14064 | acc=0.9828 | tpr=0.9622 | fpr=0.0169 | 8422.9 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.14225 | acc=0.9826 | tpr=0.9618 | fpr=0.0170 | 8264.5 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.14408 | acc=0.9824 | tpr=0.9606 | fpr=0.0172 | 8647.1 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.14673 | acc=0.9822 | tpr=0.9591 | fpr=0.0174 | 8486.3 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.14638 | acc=0.9821 | tpr=0.9586 | fpr=0.0174 | 8744.1 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.14545 | acc=0.9822 | tpr=0.9558 | fpr=0.0173 | 13626.4 samples/s | 53.2 steps/s
Avg test loss: 0.14508, Avg test acc: 0.98226, Avg tpr: 0.95563, Avg fpr: 0.01726, total FA: 2396

server round 16/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=32001 Epoch=62.4] | Loss=0.01534 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.378 | L2-Norm(final)=13.522 | 4638.7 samples/s | 72.5 steps/s
[Step=32050 Epoch=62.5] | Loss=0.01611 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.378 | L2-Norm(final)=13.527 | 5009.8 samples/s | 78.3 steps/s
[Step=32100 Epoch=62.6] | Loss=0.01543 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.379 | L2-Norm(final)=13.538 | 5398.1 samples/s | 84.3 steps/s
[Step=32150 Epoch=62.7] | Loss=0.01476 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.379 | L2-Norm(final)=13.550 | 5598.5 samples/s | 87.5 steps/s
[Step=32200 Epoch=62.8] | Loss=0.01494 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.379 | L2-Norm(final)=13.562 | 5462.8 samples/s | 85.4 steps/s
[Step=32250 Epoch=62.9] | Loss=0.01572 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.379 | L2-Norm(final)=13.573 | 5400.4 samples/s | 84.4 steps/s
[Step=32300 Epoch=63.0] | Loss=0.01557 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.379 | L2-Norm(final)=13.583 | 5512.7 samples/s | 86.1 steps/s
[Step=32350 Epoch=63.1] | Loss=0.01588 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.379 | L2-Norm(final)=13.594 | 5547.5 samples/s | 86.7 steps/s
[Step=32400 Epoch=63.2] | Loss=0.01569 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.379 | L2-Norm(final)=13.605 | 5579.5 samples/s | 87.2 steps/s
[Step=32450 Epoch=63.3] | Loss=0.01554 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.379 | L2-Norm(final)=13.615 | 5383.1 samples/s | 84.1 steps/s
[Step=32500 Epoch=63.4] | Loss=0.01562 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.379 | L2-Norm(final)=13.626 | 6860.7 samples/s | 107.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=32501 Epoch=63.4] | Loss=0.00162 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.379 | L2-Norm(final)=13.731 | 3928.6 samples/s | 61.4 steps/s
[Step=32550 Epoch=63.5] | Loss=0.01470 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.408 | L2-Norm(final)=13.740 | 4797.9 samples/s | 75.0 steps/s
[Step=32600 Epoch=63.6] | Loss=0.01639 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.445 | L2-Norm(final)=13.740 | 4735.0 samples/s | 74.0 steps/s
[Step=32650 Epoch=63.7] | Loss=0.01708 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.476 | L2-Norm(final)=13.734 | 4744.4 samples/s | 74.1 steps/s
[Step=32700 Epoch=63.8] | Loss=0.01669 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.506 | L2-Norm(final)=13.731 | 4693.5 samples/s | 73.3 steps/s
[Step=32750 Epoch=63.9] | Loss=0.01683 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.532 | L2-Norm(final)=13.728 | 4806.8 samples/s | 75.1 steps/s
[Step=32800 Epoch=64.0] | Loss=0.01679 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.555 | L2-Norm(final)=13.726 | 4771.7 samples/s | 74.6 steps/s
[Step=32850 Epoch=64.1] | Loss=0.01717 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.576 | L2-Norm(final)=13.724 | 4787.6 samples/s | 74.8 steps/s
[Step=32900 Epoch=64.2] | Loss=0.01705 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.597 | L2-Norm(final)=13.722 | 4816.6 samples/s | 75.3 steps/s
[Step=32950 Epoch=64.3] | Loss=0.01744 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.617 | L2-Norm(final)=13.720 | 4838.3 samples/s | 75.6 steps/s
[Step=33000 Epoch=64.4] | Loss=0.01787 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.637 | L2-Norm(final)=13.718 | 5791.5 samples/s | 90.5 steps/s
[Step=33050 Epoch=64.5] | Loss=0.01753 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.655 | L2-Norm(final)=13.715 | 1971.4 samples/s | 30.8 steps/s
[Step=33100 Epoch=64.6] | Loss=0.01701 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.671 | L2-Norm(final)=13.714 | 4803.2 samples/s | 75.1 steps/s
[Step=33150 Epoch=64.7] | Loss=0.01678 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.687 | L2-Norm(final)=13.712 | 4734.0 samples/s | 74.0 steps/s
[Step=33200 Epoch=64.8] | Loss=0.01662 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.702 | L2-Norm(final)=13.710 | 4789.5 samples/s | 74.8 steps/s
[Step=33250 Epoch=64.9] | Loss=0.01633 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.716 | L2-Norm(final)=13.708 | 4833.3 samples/s | 75.5 steps/s
[Step=33300 Epoch=64.9] | Loss=0.01626 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.730 | L2-Norm(final)=13.707 | 4821.4 samples/s | 75.3 steps/s
[Step=33350 Epoch=65.0] | Loss=0.01612 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.743 | L2-Norm(final)=13.706 | 4741.0 samples/s | 74.1 steps/s
[Step=33400 Epoch=65.1] | Loss=0.01618 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.755 | L2-Norm(final)=13.705 | 4788.9 samples/s | 74.8 steps/s
[Step=33450 Epoch=65.2] | Loss=0.01610 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.768 | L2-Norm(final)=13.704 | 4759.1 samples/s | 74.4 steps/s
[Step=33500 Epoch=65.3] | Loss=0.01590 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.780 | L2-Norm(final)=13.703 | 5045.7 samples/s | 78.8 steps/s
[Step=33550 Epoch=65.4] | Loss=0.01578 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.792 | L2-Norm(final)=13.703 | 2051.7 samples/s | 32.1 steps/s
[Step=33600 Epoch=65.5] | Loss=0.01584 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=13.701 | 4772.3 samples/s | 74.6 steps/s
[Step=33650 Epoch=65.6] | Loss=0.01558 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.814 | L2-Norm(final)=13.700 | 4730.3 samples/s | 73.9 steps/s
[Step=33700 Epoch=65.7] | Loss=0.01539 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.824 | L2-Norm(final)=13.700 | 4792.3 samples/s | 74.9 steps/s
[Step=33750 Epoch=65.8] | Loss=0.01519 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.834 | L2-Norm(final)=13.699 | 4786.5 samples/s | 74.8 steps/s
[Step=33800 Epoch=65.9] | Loss=0.01493 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.843 | L2-Norm(final)=13.698 | 4718.3 samples/s | 73.7 steps/s
[Step=33850 Epoch=66.0] | Loss=0.01489 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.852 | L2-Norm(final)=13.698 | 4824.7 samples/s | 75.4 steps/s
[Step=33900 Epoch=66.1] | Loss=0.01483 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.861 | L2-Norm(final)=13.697 | 4769.7 samples/s | 74.5 steps/s
[Step=33950 Epoch=66.2] | Loss=0.01463 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.869 | L2-Norm(final)=13.697 | 4862.8 samples/s | 76.0 steps/s
[Step=34000 Epoch=66.3] | Loss=0.01447 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.877 | L2-Norm(final)=13.696 | 4751.5 samples/s | 74.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step34000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=32001 Epoch=62.6] | Loss=0.01213 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.378 | L2-Norm(final)=13.995 | 4375.5 samples/s | 68.4 steps/s
[Step=32050 Epoch=62.7] | Loss=0.01389 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=14.000 | 5269.3 samples/s | 82.3 steps/s
[Step=32100 Epoch=62.8] | Loss=0.01359 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=14.011 | 5495.9 samples/s | 85.9 steps/s
[Step=32150 Epoch=62.9] | Loss=0.01486 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.380 | L2-Norm(final)=14.021 | 5454.5 samples/s | 85.2 steps/s
[Step=32200 Epoch=63.0] | Loss=0.01584 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.380 | L2-Norm(final)=14.030 | 5464.5 samples/s | 85.4 steps/s
[Step=32250 Epoch=63.0] | Loss=0.01608 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=14.040 | 5623.4 samples/s | 87.9 steps/s
[Step=32300 Epoch=63.1] | Loss=0.01578 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.380 | L2-Norm(final)=14.050 | 5548.1 samples/s | 86.7 steps/s
[Step=32350 Epoch=63.2] | Loss=0.01596 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=14.059 | 5407.7 samples/s | 84.5 steps/s
[Step=32400 Epoch=63.3] | Loss=0.01596 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=14.068 | 5523.9 samples/s | 86.3 steps/s
[Step=32450 Epoch=63.4] | Loss=0.01572 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.380 | L2-Norm(final)=14.078 | 5519.0 samples/s | 86.2 steps/s
[Step=32500 Epoch=63.5] | Loss=0.01562 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=14.089 | 7014.1 samples/s | 109.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=32501 Epoch=63.5] | Loss=0.01573 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.380 | L2-Norm(final)=14.199 | 4775.3 samples/s | 74.6 steps/s
[Step=32550 Epoch=63.6] | Loss=0.01677 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.426 | L2-Norm(final)=14.207 | 4139.9 samples/s | 64.7 steps/s
[Step=32600 Epoch=63.7] | Loss=0.01701 | Reg=0.00182 | acc=0.9531 | L2-Norm=13.474 | L2-Norm(final)=14.200 | 4886.4 samples/s | 76.3 steps/s
[Step=32650 Epoch=63.8] | Loss=0.01735 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.509 | L2-Norm(final)=14.192 | 4805.7 samples/s | 75.1 steps/s
[Step=32700 Epoch=63.9] | Loss=0.01791 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.538 | L2-Norm(final)=14.187 | 4764.1 samples/s | 74.4 steps/s
[Step=32750 Epoch=64.0] | Loss=0.01756 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.563 | L2-Norm(final)=14.184 | 4744.4 samples/s | 74.1 steps/s
[Step=32800 Epoch=64.1] | Loss=0.01746 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.586 | L2-Norm(final)=14.182 | 4851.7 samples/s | 75.8 steps/s
[Step=32850 Epoch=64.2] | Loss=0.01772 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.606 | L2-Norm(final)=14.178 | 4749.1 samples/s | 74.2 steps/s
[Step=32900 Epoch=64.3] | Loss=0.01778 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.625 | L2-Norm(final)=14.173 | 4742.7 samples/s | 74.1 steps/s
[Step=32950 Epoch=64.4] | Loss=0.01774 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.644 | L2-Norm(final)=14.170 | 4759.7 samples/s | 74.4 steps/s
[Step=33000 Epoch=64.5] | Loss=0.01779 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.661 | L2-Norm(final)=14.167 | 5886.5 samples/s | 92.0 steps/s
[Step=33050 Epoch=64.6] | Loss=0.01700 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.679 | L2-Norm(final)=14.165 | 2009.8 samples/s | 31.4 steps/s
[Step=33100 Epoch=64.7] | Loss=0.01678 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.695 | L2-Norm(final)=14.164 | 4802.3 samples/s | 75.0 steps/s
[Step=33150 Epoch=64.8] | Loss=0.01649 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.710 | L2-Norm(final)=14.162 | 4693.8 samples/s | 73.3 steps/s
[Step=33200 Epoch=64.9] | Loss=0.01631 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.725 | L2-Norm(final)=14.161 | 4741.4 samples/s | 74.1 steps/s
[Step=33250 Epoch=65.0] | Loss=0.01606 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.739 | L2-Norm(final)=14.159 | 4805.6 samples/s | 75.1 steps/s
[Step=33300 Epoch=65.1] | Loss=0.01609 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.752 | L2-Norm(final)=14.158 | 4763.8 samples/s | 74.4 steps/s
[Step=33350 Epoch=65.2] | Loss=0.01623 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.765 | L2-Norm(final)=14.157 | 4830.8 samples/s | 75.5 steps/s
[Step=33400 Epoch=65.3] | Loss=0.01606 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.778 | L2-Norm(final)=14.155 | 4796.8 samples/s | 74.9 steps/s
[Step=33450 Epoch=65.4] | Loss=0.01623 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.791 | L2-Norm(final)=14.153 | 4838.0 samples/s | 75.6 steps/s
[Step=33500 Epoch=65.5] | Loss=0.01613 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.803 | L2-Norm(final)=14.152 | 5192.3 samples/s | 81.1 steps/s
[Step=33550 Epoch=65.6] | Loss=0.01589 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.815 | L2-Norm(final)=14.151 | 2106.0 samples/s | 32.9 steps/s
[Step=33600 Epoch=65.7] | Loss=0.01560 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.825 | L2-Norm(final)=14.150 | 4874.2 samples/s | 76.2 steps/s
[Step=33650 Epoch=65.8] | Loss=0.01554 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.836 | L2-Norm(final)=14.149 | 4759.4 samples/s | 74.4 steps/s
[Step=33700 Epoch=65.9] | Loss=0.01542 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.846 | L2-Norm(final)=14.148 | 4812.7 samples/s | 75.2 steps/s
[Step=33750 Epoch=66.0] | Loss=0.01512 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.856 | L2-Norm(final)=14.148 | 4806.6 samples/s | 75.1 steps/s
[Step=33800 Epoch=66.1] | Loss=0.01487 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.865 | L2-Norm(final)=14.148 | 4719.2 samples/s | 73.7 steps/s
[Step=33850 Epoch=66.2] | Loss=0.01477 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.873 | L2-Norm(final)=14.147 | 4788.6 samples/s | 74.8 steps/s
[Step=33900 Epoch=66.3] | Loss=0.01465 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.882 | L2-Norm(final)=14.147 | 4790.1 samples/s | 74.8 steps/s
[Step=33950 Epoch=66.4] | Loss=0.01457 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.890 | L2-Norm(final)=14.147 | 4834.5 samples/s | 75.5 steps/s
[Step=34000 Epoch=66.5] | Loss=0.01439 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.898 | L2-Norm(final)=14.147 | 4747.4 samples/s | 74.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step34000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=32001 Epoch=122.6] | Loss=0.00004 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.378 | L2-Norm(final)=15.633 | 4322.4 samples/s | 67.5 steps/s
[Step=32050 Epoch=122.8] | Loss=0.00020 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=15.638 | 4719.6 samples/s | 73.7 steps/s
[Step=32100 Epoch=123.0] | Loss=0.00019 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=15.644 | 5221.8 samples/s | 81.6 steps/s
[Step=32150 Epoch=123.2] | Loss=0.00017 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=15.649 | 5177.7 samples/s | 80.9 steps/s
[Step=32200 Epoch=123.4] | Loss=0.00016 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=15.654 | 5084.5 samples/s | 79.4 steps/s
[Step=32250 Epoch=123.6] | Loss=0.00021 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=15.660 | 6749.5 samples/s | 105.5 steps/s
[Step=32300 Epoch=123.8] | Loss=0.00020 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=15.666 | 2033.6 samples/s | 31.8 steps/s
[Step=32350 Epoch=124.0] | Loss=0.00019 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=15.672 | 5114.9 samples/s | 79.9 steps/s
[Step=32400 Epoch=124.1] | Loss=0.00019 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=15.677 | 5199.1 samples/s | 81.2 steps/s
[Step=32450 Epoch=124.3] | Loss=0.00020 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=15.683 | 5065.7 samples/s | 79.2 steps/s
[Step=32500 Epoch=124.5] | Loss=0.00021 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=15.689 | 5820.8 samples/s | 91.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=32501 Epoch=124.5] | Loss=0.00008 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=15.749 | 4269.9 samples/s | 66.7 steps/s
[Step=32550 Epoch=124.7] | Loss=0.00016 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=15.754 | 4319.6 samples/s | 67.5 steps/s
[Step=32600 Epoch=124.9] | Loss=0.00011 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=15.756 | 4437.2 samples/s | 69.3 steps/s
[Step=32650 Epoch=125.1] | Loss=0.00008 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=15.757 | 4476.3 samples/s | 69.9 steps/s
[Step=32700 Epoch=125.3] | Loss=0.00006 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=15.758 | 4490.8 samples/s | 70.2 steps/s
[Step=32750 Epoch=125.5] | Loss=0.00005 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=15.759 | 5665.8 samples/s | 88.5 steps/s
[Step=32800 Epoch=125.7] | Loss=0.00004 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.328 | L2-Norm(final)=15.760 | 1961.0 samples/s | 30.6 steps/s
[Step=32850 Epoch=125.9] | Loss=0.00004 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.313 | L2-Norm(final)=15.760 | 4484.7 samples/s | 70.1 steps/s
[Step=32900 Epoch=126.1] | Loss=0.00003 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.299 | L2-Norm(final)=15.761 | 4593.4 samples/s | 71.8 steps/s
[Step=32950 Epoch=126.3] | Loss=0.00003 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=15.762 | 4483.2 samples/s | 70.1 steps/s
[Step=33000 Epoch=126.4] | Loss=0.00003 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.269 | L2-Norm(final)=15.763 | 5006.8 samples/s | 78.2 steps/s
[Step=33050 Epoch=126.6] | Loss=0.00002 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.255 | L2-Norm(final)=15.764 | 2044.1 samples/s | 31.9 steps/s
[Step=33100 Epoch=126.8] | Loss=0.00002 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.240 | L2-Norm(final)=15.765 | 4471.9 samples/s | 69.9 steps/s
[Step=33150 Epoch=127.0] | Loss=0.00002 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.226 | L2-Norm(final)=15.766 | 4538.1 samples/s | 70.9 steps/s
[Step=33200 Epoch=127.2] | Loss=0.00002 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.211 | L2-Norm(final)=15.767 | 4518.6 samples/s | 70.6 steps/s
[Step=33250 Epoch=127.4] | Loss=0.00002 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.197 | L2-Norm(final)=15.767 | 4574.0 samples/s | 71.5 steps/s
[Step=33300 Epoch=127.6] | Loss=0.00002 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.183 | L2-Norm(final)=15.768 | 2157.9 samples/s | 33.7 steps/s
[Step=33350 Epoch=127.8] | Loss=0.00002 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.169 | L2-Norm(final)=15.769 | 4571.6 samples/s | 71.4 steps/s
[Step=33400 Epoch=128.0] | Loss=0.00001 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.154 | L2-Norm(final)=15.770 | 4582.5 samples/s | 71.6 steps/s
[Step=33450 Epoch=128.2] | Loss=0.00001 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.140 | L2-Norm(final)=15.771 | 4559.3 samples/s | 71.2 steps/s
[Step=33500 Epoch=128.4] | Loss=0.00001 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.126 | L2-Norm(final)=15.772 | 4476.3 samples/s | 69.9 steps/s
[Step=33550 Epoch=128.6] | Loss=0.00001 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.111 | L2-Norm(final)=15.773 | 2127.4 samples/s | 33.2 steps/s
[Step=33600 Epoch=128.7] | Loss=0.00001 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.097 | L2-Norm(final)=15.773 | 4451.4 samples/s | 69.6 steps/s
[Step=33650 Epoch=128.9] | Loss=0.00001 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.083 | L2-Norm(final)=15.774 | 4477.4 samples/s | 70.0 steps/s
[Step=33700 Epoch=129.1] | Loss=0.00001 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.068 | L2-Norm(final)=15.775 | 4530.4 samples/s | 70.8 steps/s
[Step=33750 Epoch=129.3] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.054 | L2-Norm(final)=15.776 | 4509.6 samples/s | 70.5 steps/s
[Step=33800 Epoch=129.5] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.039 | L2-Norm(final)=15.777 | 6070.3 samples/s | 94.8 steps/s
[Step=33850 Epoch=129.7] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.025 | L2-Norm(final)=15.777 | 1915.8 samples/s | 29.9 steps/s
[Step=33900 Epoch=129.9] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.010 | L2-Norm(final)=15.778 | 4612.7 samples/s | 72.1 steps/s
[Step=33950 Epoch=130.1] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.995 | L2-Norm(final)=15.779 | 4593.1 samples/s | 71.8 steps/s
[Step=34000 Epoch=130.3] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.980 | L2-Norm(final)=15.780 | 4524.7 samples/s | 70.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step34000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=32001 Epoch=123.2] | Loss=0.00007 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.378 | L2-Norm(final)=15.295 | 4402.0 samples/s | 68.8 steps/s
[Step=32050 Epoch=123.4] | Loss=0.00052 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.374 | L2-Norm(final)=15.315 | 5118.4 samples/s | 80.0 steps/s
[Step=32100 Epoch=123.6] | Loss=0.00048 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=15.332 | 5091.4 samples/s | 79.6 steps/s
[Step=32150 Epoch=123.8] | Loss=0.00048 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=15.347 | 5145.1 samples/s | 80.4 steps/s
[Step=32200 Epoch=124.0] | Loss=0.00054 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=15.362 | 5137.2 samples/s | 80.3 steps/s
[Step=32250 Epoch=124.1] | Loss=0.00052 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=15.377 | 6859.0 samples/s | 107.2 steps/s
[Step=32300 Epoch=124.3] | Loss=0.00053 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=15.392 | 2039.3 samples/s | 31.9 steps/s
[Step=32350 Epoch=124.5] | Loss=0.00054 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=15.408 | 5253.3 samples/s | 82.1 steps/s
[Step=32400 Epoch=124.7] | Loss=0.00053 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=15.422 | 5345.4 samples/s | 83.5 steps/s
[Step=32450 Epoch=124.9] | Loss=0.00051 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=15.435 | 5205.0 samples/s | 81.3 steps/s
[Step=32500 Epoch=125.1] | Loss=0.00050 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=15.448 | 6049.4 samples/s | 94.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=32501 Epoch=125.1] | Loss=0.00133 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=15.572 | 4101.0 samples/s | 64.1 steps/s
[Step=32550 Epoch=125.3] | Loss=0.00192 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.409 | L2-Norm(final)=15.576 | 4371.8 samples/s | 68.3 steps/s
[Step=32600 Epoch=125.5] | Loss=0.00812 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.546 | L2-Norm(final)=15.555 | 4600.2 samples/s | 71.9 steps/s
[Step=32650 Epoch=125.7] | Loss=0.00665 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.644 | L2-Norm(final)=15.542 | 4483.1 samples/s | 70.0 steps/s
[Step=32700 Epoch=125.9] | Loss=0.00629 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.704 | L2-Norm(final)=15.532 | 4527.3 samples/s | 70.7 steps/s
[Step=32750 Epoch=126.1] | Loss=0.00508 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.743 | L2-Norm(final)=15.525 | 5716.5 samples/s | 89.3 steps/s
[Step=32800 Epoch=126.3] | Loss=0.00428 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.767 | L2-Norm(final)=15.521 | 1896.1 samples/s | 29.6 steps/s
[Step=32850 Epoch=126.5] | Loss=0.00368 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.783 | L2-Norm(final)=15.519 | 4675.0 samples/s | 73.0 steps/s
[Step=32900 Epoch=126.6] | Loss=0.00322 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.793 | L2-Norm(final)=15.518 | 4649.1 samples/s | 72.6 steps/s
[Step=32950 Epoch=126.8] | Loss=0.00286 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.798 | L2-Norm(final)=15.517 | 4540.2 samples/s | 70.9 steps/s
[Step=33000 Epoch=127.0] | Loss=0.00277 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.802 | L2-Norm(final)=15.516 | 5288.2 samples/s | 82.6 steps/s
[Step=33050 Epoch=127.2] | Loss=0.00252 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.805 | L2-Norm(final)=15.514 | 2049.1 samples/s | 32.0 steps/s
[Step=33100 Epoch=127.4] | Loss=0.00232 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.807 | L2-Norm(final)=15.512 | 4543.1 samples/s | 71.0 steps/s
[Step=33150 Epoch=127.6] | Loss=0.00214 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.807 | L2-Norm(final)=15.511 | 4489.8 samples/s | 70.2 steps/s
[Step=33200 Epoch=127.8] | Loss=0.00200 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.807 | L2-Norm(final)=15.510 | 4507.5 samples/s | 70.4 steps/s
[Step=33250 Epoch=128.0] | Loss=0.00186 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.805 | L2-Norm(final)=15.509 | 4653.6 samples/s | 72.7 steps/s
[Step=33300 Epoch=128.2] | Loss=0.00175 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=15.508 | 2110.6 samples/s | 33.0 steps/s
[Step=33350 Epoch=128.4] | Loss=0.00165 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.800 | L2-Norm(final)=15.508 | 4580.1 samples/s | 71.6 steps/s
[Step=33400 Epoch=128.6] | Loss=0.00156 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.797 | L2-Norm(final)=15.508 | 4590.5 samples/s | 71.7 steps/s
[Step=33450 Epoch=128.8] | Loss=0.00148 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.793 | L2-Norm(final)=15.507 | 4599.5 samples/s | 71.9 steps/s
[Step=33500 Epoch=129.0] | Loss=0.00140 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.789 | L2-Norm(final)=15.507 | 4386.3 samples/s | 68.5 steps/s
[Step=33550 Epoch=129.1] | Loss=0.00134 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.784 | L2-Norm(final)=15.507 | 2124.8 samples/s | 33.2 steps/s
[Step=33600 Epoch=129.3] | Loss=0.00127 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.780 | L2-Norm(final)=15.506 | 4561.3 samples/s | 71.3 steps/s
[Step=33650 Epoch=129.5] | Loss=0.00122 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.775 | L2-Norm(final)=15.506 | 4454.3 samples/s | 69.6 steps/s
[Step=33700 Epoch=129.7] | Loss=0.00117 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.769 | L2-Norm(final)=15.506 | 4528.1 samples/s | 70.8 steps/s
[Step=33750 Epoch=129.9] | Loss=0.00112 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.764 | L2-Norm(final)=15.506 | 4567.4 samples/s | 71.4 steps/s
[Step=33800 Epoch=130.1] | Loss=0.00108 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=15.506 | 6601.3 samples/s | 103.1 steps/s
[Step=33850 Epoch=130.3] | Loss=0.00104 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.753 | L2-Norm(final)=15.506 | 1871.7 samples/s | 29.2 steps/s
[Step=33900 Epoch=130.5] | Loss=0.00100 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.747 | L2-Norm(final)=15.506 | 4425.7 samples/s | 69.2 steps/s
[Step=33950 Epoch=130.7] | Loss=0.00097 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.741 | L2-Norm(final)=15.506 | 4497.8 samples/s | 70.3 steps/s
[Step=34000 Epoch=130.9] | Loss=0.00094 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.734 | L2-Norm(final)=15.506 | 4563.4 samples/s | 71.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step34000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07349 | acc=0.9681 | tpr=0.9735 | fpr=0.0436 | 4462.9 samples/s | 17.4 steps/s
Avg test loss: 0.07553, Avg test acc: 0.96823, Avg tpr: 0.97435, Avg fpr: 0.04525, total FA: 353

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07225 | acc=0.9677 | tpr=0.9723 | fpr=0.0424 | 4462.4 samples/s | 17.4 steps/s
Avg test loss: 0.07083, Avg test acc: 0.96759, Avg tpr: 0.97162, Avg fpr: 0.04128, total FA: 322

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.73242 | acc=0.3047 | tpr=0.0087 | fpr=0.0525 | 4432.8 samples/s | 17.3 steps/s
Avg test loss: 6.75667, Avg test acc: 0.30303, Avg tpr: 0.00950, Avg fpr: 0.05140, total FA: 401

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.25492 | acc=0.3127 | tpr=0.0039 | fpr=0.0168 | 4486.4 samples/s | 17.5 steps/s
Avg test loss: 7.27506, Avg test acc: 0.31004, Avg tpr: 0.00379, Avg fpr: 0.01641, total FA: 128

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.10843 | acc=0.1122 | tpr=0.6814 | fpr=0.8980 | 4406.9 samples/s | 17.2 steps/s
[Step= 100] | Loss=6.07807 | acc=0.1126 | tpr=0.6887 | fpr=0.8982 | 8827.1 samples/s | 34.5 steps/s
[Step= 150] | Loss=6.10196 | acc=0.1117 | tpr=0.6945 | fpr=0.8991 | 8209.8 samples/s | 32.1 steps/s
[Step= 200] | Loss=6.09990 | acc=0.1109 | tpr=0.6787 | fpr=0.8994 | 8549.5 samples/s | 33.4 steps/s
[Step= 250] | Loss=6.10610 | acc=0.1109 | tpr=0.6803 | fpr=0.8995 | 8152.0 samples/s | 31.8 steps/s
[Step= 300] | Loss=6.10868 | acc=0.1102 | tpr=0.6720 | fpr=0.9000 | 8508.3 samples/s | 33.2 steps/s
[Step= 350] | Loss=6.10567 | acc=0.1097 | tpr=0.6606 | fpr=0.9003 | 8525.0 samples/s | 33.3 steps/s
[Step= 400] | Loss=6.11051 | acc=0.1099 | tpr=0.6575 | fpr=0.9001 | 8289.1 samples/s | 32.4 steps/s
[Step= 450] | Loss=6.11605 | acc=0.1102 | tpr=0.6587 | fpr=0.8997 | 8360.2 samples/s | 32.7 steps/s
[Step= 500] | Loss=6.11500 | acc=0.1098 | tpr=0.6568 | fpr=0.9000 | 7121.5 samples/s | 27.8 steps/s
[Step= 550] | Loss=6.11867 | acc=0.1095 | tpr=0.6550 | fpr=0.9004 | 10951.2 samples/s | 42.8 steps/s
Avg test loss: 6.11841, Avg test acc: 0.10948, Avg tpr: 0.65571, Avg fpr: 0.90045, total FA: 125026

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.29172 | acc=0.1305 | tpr=0.6726 | fpr=0.8793 | 4474.1 samples/s | 17.5 steps/s
[Step= 100] | Loss=7.22705 | acc=0.1301 | tpr=0.6823 | fpr=0.8802 | 8120.7 samples/s | 31.7 steps/s
[Step= 150] | Loss=7.23627 | acc=0.1303 | tpr=0.6873 | fpr=0.8800 | 8431.9 samples/s | 32.9 steps/s
[Step= 200] | Loss=7.22313 | acc=0.1296 | tpr=0.6732 | fpr=0.8803 | 8534.0 samples/s | 33.3 steps/s
[Step= 250] | Loss=7.23589 | acc=0.1297 | tpr=0.6786 | fpr=0.8803 | 8723.6 samples/s | 34.1 steps/s
[Step= 300] | Loss=7.22808 | acc=0.1295 | tpr=0.6785 | fpr=0.8805 | 8112.9 samples/s | 31.7 steps/s
[Step= 350] | Loss=7.22501 | acc=0.1289 | tpr=0.6800 | fpr=0.8812 | 8393.9 samples/s | 32.8 steps/s
[Step= 400] | Loss=7.22915 | acc=0.1288 | tpr=0.6756 | fpr=0.8811 | 8735.8 samples/s | 34.1 steps/s
[Step= 450] | Loss=7.23277 | acc=0.1288 | tpr=0.6772 | fpr=0.8812 | 8308.3 samples/s | 32.5 steps/s
[Step= 500] | Loss=7.23363 | acc=0.1286 | tpr=0.6775 | fpr=0.8813 | 6180.0 samples/s | 24.1 steps/s
[Step= 550] | Loss=7.23831 | acc=0.1283 | tpr=0.6725 | fpr=0.8816 | 15881.3 samples/s | 62.0 steps/s
Avg test loss: 7.23874, Avg test acc: 0.12826, Avg tpr: 0.67314, Avg fpr: 0.88164, total FA: 122414

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13406 | acc=0.9836 | tpr=0.9336 | fpr=0.0155 | 4426.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.14215 | acc=0.9829 | tpr=0.9488 | fpr=0.0165 | 8574.5 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.14907 | acc=0.9822 | tpr=0.9524 | fpr=0.0173 | 8453.2 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.14860 | acc=0.9823 | tpr=0.9552 | fpr=0.0172 | 8669.8 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.14554 | acc=0.9825 | tpr=0.9537 | fpr=0.0170 | 8336.4 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.14751 | acc=0.9824 | tpr=0.9556 | fpr=0.0171 | 8650.3 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.14920 | acc=0.9822 | tpr=0.9555 | fpr=0.0174 | 8103.5 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.15086 | acc=0.9819 | tpr=0.9535 | fpr=0.0176 | 8686.4 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.15360 | acc=0.9816 | tpr=0.9523 | fpr=0.0179 | 8241.0 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.15330 | acc=0.9817 | tpr=0.9529 | fpr=0.0178 | 6851.1 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.15251 | acc=0.9817 | tpr=0.9499 | fpr=0.0178 | 15173.8 samples/s | 59.3 steps/s
Avg test loss: 0.15208, Avg test acc: 0.98169, Avg tpr: 0.95008, Avg fpr: 0.01773, total FA: 2462

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13749 | acc=0.9840 | tpr=0.9336 | fpr=0.0151 | 4432.4 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.14928 | acc=0.9836 | tpr=0.9531 | fpr=0.0158 | 9153.3 samples/s | 35.8 steps/s
[Step= 150] | Loss=0.15740 | acc=0.9830 | tpr=0.9597 | fpr=0.0166 | 7919.1 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.15839 | acc=0.9830 | tpr=0.9650 | fpr=0.0167 | 8366.8 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.15612 | acc=0.9830 | tpr=0.9642 | fpr=0.0166 | 8471.7 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.15892 | acc=0.9830 | tpr=0.9651 | fpr=0.0167 | 8355.9 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.16072 | acc=0.9827 | tpr=0.9637 | fpr=0.0170 | 8464.1 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.16304 | acc=0.9825 | tpr=0.9606 | fpr=0.0171 | 8529.8 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.16647 | acc=0.9821 | tpr=0.9591 | fpr=0.0175 | 7942.2 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.16639 | acc=0.9821 | tpr=0.9581 | fpr=0.0175 | 7447.2 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.16529 | acc=0.9821 | tpr=0.9566 | fpr=0.0174 | 15168.3 samples/s | 59.3 steps/s
Avg test loss: 0.16488, Avg test acc: 0.98215, Avg tpr: 0.95681, Avg fpr: 0.01739, total FA: 2414

server round 17/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=34001 Epoch=66.3] | Loss=0.00281 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=13.685 | 4120.9 samples/s | 64.4 steps/s
[Step=34050 Epoch=66.4] | Loss=0.01456 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.291 | L2-Norm(final)=13.702 | 5390.1 samples/s | 84.2 steps/s
[Step=34100 Epoch=66.5] | Loss=0.01664 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.292 | L2-Norm(final)=13.712 | 5400.8 samples/s | 84.4 steps/s
[Step=34150 Epoch=66.6] | Loss=0.01580 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.292 | L2-Norm(final)=13.723 | 5500.9 samples/s | 86.0 steps/s
[Step=34200 Epoch=66.7] | Loss=0.01650 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.292 | L2-Norm(final)=13.735 | 5625.5 samples/s | 87.9 steps/s
[Step=34250 Epoch=66.8] | Loss=0.01679 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.292 | L2-Norm(final)=13.747 | 5407.3 samples/s | 84.5 steps/s
[Step=34300 Epoch=66.9] | Loss=0.01637 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.292 | L2-Norm(final)=13.759 | 5489.6 samples/s | 85.8 steps/s
[Step=34350 Epoch=67.0] | Loss=0.01664 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.292 | L2-Norm(final)=13.770 | 5565.0 samples/s | 87.0 steps/s
[Step=34400 Epoch=67.1] | Loss=0.01635 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.292 | L2-Norm(final)=13.782 | 5529.7 samples/s | 86.4 steps/s
[Step=34450 Epoch=67.2] | Loss=0.01642 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.292 | L2-Norm(final)=13.794 | 5483.0 samples/s | 85.7 steps/s
[Step=34500 Epoch=67.3] | Loss=0.01608 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.292 | L2-Norm(final)=13.807 | 6901.2 samples/s | 107.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=34501 Epoch=67.3] | Loss=0.00307 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.292 | L2-Norm(final)=13.924 | 4067.7 samples/s | 63.6 steps/s
[Step=34550 Epoch=67.4] | Loss=0.01397 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.345 | L2-Norm(final)=13.927 | 4580.4 samples/s | 71.6 steps/s
[Step=34600 Epoch=67.5] | Loss=0.01608 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.387 | L2-Norm(final)=13.921 | 4721.2 samples/s | 73.8 steps/s
[Step=34650 Epoch=67.6] | Loss=0.01706 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.420 | L2-Norm(final)=13.916 | 4751.7 samples/s | 74.2 steps/s
[Step=34700 Epoch=67.7] | Loss=0.01757 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.448 | L2-Norm(final)=13.911 | 4722.6 samples/s | 73.8 steps/s
[Step=34750 Epoch=67.8] | Loss=0.01792 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.471 | L2-Norm(final)=13.907 | 4746.0 samples/s | 74.2 steps/s
[Step=34800 Epoch=67.9] | Loss=0.01790 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.493 | L2-Norm(final)=13.904 | 4740.7 samples/s | 74.1 steps/s
[Step=34850 Epoch=68.0] | Loss=0.01852 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.515 | L2-Norm(final)=13.901 | 4762.4 samples/s | 74.4 steps/s
[Step=34900 Epoch=68.1] | Loss=0.01808 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.535 | L2-Norm(final)=13.897 | 4750.8 samples/s | 74.2 steps/s
[Step=34950 Epoch=68.2] | Loss=0.01796 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.553 | L2-Norm(final)=13.894 | 4822.9 samples/s | 75.4 steps/s
[Step=35000 Epoch=68.3] | Loss=0.01771 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.570 | L2-Norm(final)=13.892 | 5845.8 samples/s | 91.3 steps/s
[Step=35050 Epoch=68.4] | Loss=0.01717 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.585 | L2-Norm(final)=13.890 | 1986.4 samples/s | 31.0 steps/s
[Step=35100 Epoch=68.5] | Loss=0.01672 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.600 | L2-Norm(final)=13.889 | 4702.0 samples/s | 73.5 steps/s
[Step=35150 Epoch=68.6] | Loss=0.01651 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.614 | L2-Norm(final)=13.889 | 4740.0 samples/s | 74.1 steps/s
[Step=35200 Epoch=68.7] | Loss=0.01626 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.627 | L2-Norm(final)=13.888 | 4712.8 samples/s | 73.6 steps/s
[Step=35250 Epoch=68.8] | Loss=0.01609 | Reg=0.00186 | acc=0.9375 | L2-Norm=13.639 | L2-Norm(final)=13.888 | 4785.6 samples/s | 74.8 steps/s
[Step=35300 Epoch=68.8] | Loss=0.01575 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.651 | L2-Norm(final)=13.887 | 4849.6 samples/s | 75.8 steps/s
[Step=35350 Epoch=68.9] | Loss=0.01562 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.662 | L2-Norm(final)=13.887 | 4804.7 samples/s | 75.1 steps/s
[Step=35400 Epoch=69.0] | Loss=0.01563 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.673 | L2-Norm(final)=13.887 | 4761.1 samples/s | 74.4 steps/s
[Step=35450 Epoch=69.1] | Loss=0.01560 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=13.887 | 4752.0 samples/s | 74.3 steps/s
[Step=35500 Epoch=69.2] | Loss=0.01550 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.695 | L2-Norm(final)=13.886 | 5047.2 samples/s | 78.9 steps/s
[Step=35550 Epoch=69.3] | Loss=0.01528 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.706 | L2-Norm(final)=13.886 | 2058.9 samples/s | 32.2 steps/s
[Step=35600 Epoch=69.4] | Loss=0.01514 | Reg=0.00188 | acc=0.9531 | L2-Norm=13.716 | L2-Norm(final)=13.886 | 4862.0 samples/s | 76.0 steps/s
[Step=35650 Epoch=69.5] | Loss=0.01492 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.726 | L2-Norm(final)=13.885 | 4894.2 samples/s | 76.5 steps/s
[Step=35700 Epoch=69.6] | Loss=0.01465 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.736 | L2-Norm(final)=13.885 | 4889.8 samples/s | 76.4 steps/s
[Step=35750 Epoch=69.7] | Loss=0.01452 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.745 | L2-Norm(final)=13.885 | 4925.2 samples/s | 77.0 steps/s
[Step=35800 Epoch=69.8] | Loss=0.01450 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.754 | L2-Norm(final)=13.885 | 4868.9 samples/s | 76.1 steps/s
[Step=35850 Epoch=69.9] | Loss=0.01437 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.763 | L2-Norm(final)=13.885 | 4917.5 samples/s | 76.8 steps/s
[Step=35900 Epoch=70.0] | Loss=0.01419 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.772 | L2-Norm(final)=13.886 | 4834.5 samples/s | 75.5 steps/s
[Step=35950 Epoch=70.1] | Loss=0.01407 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.781 | L2-Norm(final)=13.886 | 4827.5 samples/s | 75.4 steps/s
[Step=36000 Epoch=70.2] | Loss=0.01413 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.790 | L2-Norm(final)=13.886 | 4737.0 samples/s | 74.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step36000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=34001 Epoch=66.5] | Loss=0.01760 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.290 | L2-Norm(final)=14.143 | 4300.6 samples/s | 67.2 steps/s
[Step=34050 Epoch=66.6] | Loss=0.01711 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.292 | L2-Norm(final)=14.150 | 5412.6 samples/s | 84.6 steps/s
[Step=34100 Epoch=66.7] | Loss=0.01839 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.293 | L2-Norm(final)=14.160 | 5554.2 samples/s | 86.8 steps/s
[Step=34150 Epoch=66.8] | Loss=0.01758 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.293 | L2-Norm(final)=14.171 | 5403.0 samples/s | 84.4 steps/s
[Step=34200 Epoch=66.9] | Loss=0.01685 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.293 | L2-Norm(final)=14.183 | 5521.9 samples/s | 86.3 steps/s
[Step=34250 Epoch=67.0] | Loss=0.01724 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.293 | L2-Norm(final)=14.194 | 5500.6 samples/s | 85.9 steps/s
[Step=34300 Epoch=67.1] | Loss=0.01761 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.293 | L2-Norm(final)=14.206 | 5520.3 samples/s | 86.3 steps/s
[Step=34350 Epoch=67.2] | Loss=0.01828 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.293 | L2-Norm(final)=14.217 | 5459.2 samples/s | 85.3 steps/s
[Step=34400 Epoch=67.3] | Loss=0.01824 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.293 | L2-Norm(final)=14.228 | 5496.7 samples/s | 85.9 steps/s
[Step=34450 Epoch=67.3] | Loss=0.01810 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.293 | L2-Norm(final)=14.240 | 5646.8 samples/s | 88.2 steps/s
[Step=34500 Epoch=67.4] | Loss=0.01777 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.293 | L2-Norm(final)=14.252 | 7046.7 samples/s | 110.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=34501 Epoch=67.4] | Loss=0.01659 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.293 | L2-Norm(final)=14.369 | 4312.7 samples/s | 67.4 steps/s
[Step=34550 Epoch=67.5] | Loss=0.01668 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.354 | L2-Norm(final)=14.372 | 4775.4 samples/s | 74.6 steps/s
[Step=34600 Epoch=67.6] | Loss=0.01755 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.408 | L2-Norm(final)=14.364 | 4792.6 samples/s | 74.9 steps/s
[Step=34650 Epoch=67.7] | Loss=0.01628 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.447 | L2-Norm(final)=14.360 | 4801.3 samples/s | 75.0 steps/s
[Step=34700 Epoch=67.8] | Loss=0.01620 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.478 | L2-Norm(final)=14.358 | 4797.9 samples/s | 75.0 steps/s
[Step=34750 Epoch=67.9] | Loss=0.01674 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.505 | L2-Norm(final)=14.356 | 4776.2 samples/s | 74.6 steps/s
[Step=34800 Epoch=68.0] | Loss=0.01726 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.527 | L2-Norm(final)=14.353 | 4744.2 samples/s | 74.1 steps/s
[Step=34850 Epoch=68.1] | Loss=0.01750 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.547 | L2-Norm(final)=14.349 | 4788.0 samples/s | 74.8 steps/s
[Step=34900 Epoch=68.2] | Loss=0.01727 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.564 | L2-Norm(final)=14.346 | 4785.9 samples/s | 74.8 steps/s
[Step=34950 Epoch=68.3] | Loss=0.01728 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.581 | L2-Norm(final)=14.343 | 4819.2 samples/s | 75.3 steps/s
[Step=35000 Epoch=68.4] | Loss=0.01745 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.596 | L2-Norm(final)=14.340 | 5897.9 samples/s | 92.2 steps/s
[Step=35050 Epoch=68.5] | Loss=0.01710 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.611 | L2-Norm(final)=14.337 | 2061.1 samples/s | 32.2 steps/s
[Step=35100 Epoch=68.6] | Loss=0.01668 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.625 | L2-Norm(final)=14.335 | 4910.7 samples/s | 76.7 steps/s
[Step=35150 Epoch=68.7] | Loss=0.01647 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.638 | L2-Norm(final)=14.333 | 4925.9 samples/s | 77.0 steps/s
[Step=35200 Epoch=68.8] | Loss=0.01593 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.650 | L2-Norm(final)=14.332 | 4865.0 samples/s | 76.0 steps/s
[Step=35250 Epoch=68.9] | Loss=0.01572 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.661 | L2-Norm(final)=14.331 | 4858.4 samples/s | 75.9 steps/s
[Step=35300 Epoch=69.0] | Loss=0.01559 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.672 | L2-Norm(final)=14.330 | 4761.0 samples/s | 74.4 steps/s
[Step=35350 Epoch=69.1] | Loss=0.01547 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.682 | L2-Norm(final)=14.329 | 4814.8 samples/s | 75.2 steps/s
[Step=35400 Epoch=69.2] | Loss=0.01531 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.692 | L2-Norm(final)=14.328 | 4872.3 samples/s | 76.1 steps/s
[Step=35450 Epoch=69.3] | Loss=0.01507 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.701 | L2-Norm(final)=14.327 | 4833.6 samples/s | 75.5 steps/s
[Step=35500 Epoch=69.4] | Loss=0.01509 | Reg=0.00188 | acc=0.9531 | L2-Norm=13.710 | L2-Norm(final)=14.327 | 5212.1 samples/s | 81.4 steps/s
[Step=35550 Epoch=69.5] | Loss=0.01488 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.719 | L2-Norm(final)=14.327 | 2142.3 samples/s | 33.5 steps/s
[Step=35600 Epoch=69.6] | Loss=0.01466 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.728 | L2-Norm(final)=14.327 | 4924.5 samples/s | 76.9 steps/s
[Step=35650 Epoch=69.7] | Loss=0.01460 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.736 | L2-Norm(final)=14.327 | 4732.3 samples/s | 73.9 steps/s
[Step=35700 Epoch=69.8] | Loss=0.01444 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.745 | L2-Norm(final)=14.326 | 4775.1 samples/s | 74.6 steps/s
[Step=35750 Epoch=69.9] | Loss=0.01424 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.752 | L2-Norm(final)=14.326 | 4753.3 samples/s | 74.3 steps/s
[Step=35800 Epoch=70.0] | Loss=0.01406 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.760 | L2-Norm(final)=14.327 | 4830.9 samples/s | 75.5 steps/s
[Step=35850 Epoch=70.1] | Loss=0.01392 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.767 | L2-Norm(final)=14.327 | 4807.7 samples/s | 75.1 steps/s
[Step=35900 Epoch=70.2] | Loss=0.01375 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.775 | L2-Norm(final)=14.327 | 4755.0 samples/s | 74.3 steps/s
[Step=35950 Epoch=70.3] | Loss=0.01380 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.782 | L2-Norm(final)=14.327 | 4752.0 samples/s | 74.3 steps/s
[Step=36000 Epoch=70.4] | Loss=0.01376 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.790 | L2-Norm(final)=14.327 | 4767.8 samples/s | 74.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step36000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=34001 Epoch=130.3] | Loss=0.00003 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=15.803 | 4265.5 samples/s | 66.6 steps/s
[Step=34050 Epoch=130.5] | Loss=0.00037 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.285 | L2-Norm(final)=15.812 | 4858.5 samples/s | 75.9 steps/s
[Step=34100 Epoch=130.7] | Loss=0.00028 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=15.821 | 5045.3 samples/s | 78.8 steps/s
[Step=34150 Epoch=130.9] | Loss=0.00025 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=15.829 | 5155.1 samples/s | 80.5 steps/s
[Step=34200 Epoch=131.0] | Loss=0.00030 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=15.840 | 5207.4 samples/s | 81.4 steps/s
[Step=34250 Epoch=131.2] | Loss=0.00029 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=15.852 | 6714.1 samples/s | 104.9 steps/s
[Step=34300 Epoch=131.4] | Loss=0.00028 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=15.864 | 2048.9 samples/s | 32.0 steps/s
[Step=34350 Epoch=131.6] | Loss=0.00029 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=15.876 | 5137.9 samples/s | 80.3 steps/s
[Step=34400 Epoch=131.8] | Loss=0.00030 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=15.888 | 5201.4 samples/s | 81.3 steps/s
[Step=34450 Epoch=132.0] | Loss=0.00028 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=15.900 | 5159.0 samples/s | 80.6 steps/s
[Step=34500 Epoch=132.2] | Loss=0.00027 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=15.911 | 5771.5 samples/s | 90.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=34501 Epoch=132.2] | Loss=0.00014 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=16.021 | 4273.3 samples/s | 66.8 steps/s
[Step=34550 Epoch=132.4] | Loss=0.00734 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.341 | L2-Norm(final)=16.018 | 4348.0 samples/s | 67.9 steps/s
[Step=34600 Epoch=132.6] | Loss=0.00596 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.473 | L2-Norm(final)=15.994 | 4441.1 samples/s | 69.4 steps/s
[Step=34650 Epoch=132.8] | Loss=0.00497 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=15.981 | 4543.8 samples/s | 71.0 steps/s
[Step=34700 Epoch=133.0] | Loss=0.00382 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.609 | L2-Norm(final)=15.975 | 4520.2 samples/s | 70.6 steps/s
[Step=34750 Epoch=133.1] | Loss=0.00327 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.639 | L2-Norm(final)=15.972 | 5641.5 samples/s | 88.1 steps/s
[Step=34800 Epoch=133.3] | Loss=0.00284 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.659 | L2-Norm(final)=15.969 | 1992.8 samples/s | 31.1 steps/s
[Step=34850 Epoch=133.5] | Loss=0.00244 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.670 | L2-Norm(final)=15.967 | 4546.2 samples/s | 71.0 steps/s
[Step=34900 Epoch=133.7] | Loss=0.00213 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.675 | L2-Norm(final)=15.966 | 4472.3 samples/s | 69.9 steps/s
[Step=34950 Epoch=133.9] | Loss=0.00199 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.677 | L2-Norm(final)=15.965 | 4541.5 samples/s | 71.0 steps/s
[Step=35000 Epoch=134.1] | Loss=0.00180 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.677 | L2-Norm(final)=15.964 | 5017.7 samples/s | 78.4 steps/s
[Step=35050 Epoch=134.3] | Loss=0.00164 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.676 | L2-Norm(final)=15.963 | 2001.1 samples/s | 31.3 steps/s
[Step=35100 Epoch=134.5] | Loss=0.00151 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.674 | L2-Norm(final)=15.963 | 4547.9 samples/s | 71.1 steps/s
[Step=35150 Epoch=134.7] | Loss=0.00139 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.670 | L2-Norm(final)=15.963 | 4533.5 samples/s | 70.8 steps/s
[Step=35200 Epoch=134.9] | Loss=0.00129 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.665 | L2-Norm(final)=15.963 | 4523.8 samples/s | 70.7 steps/s
[Step=35250 Epoch=135.1] | Loss=0.00121 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.660 | L2-Norm(final)=15.962 | 4650.4 samples/s | 72.7 steps/s
[Step=35300 Epoch=135.3] | Loss=0.00113 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.654 | L2-Norm(final)=15.962 | 2129.1 samples/s | 33.3 steps/s
[Step=35350 Epoch=135.4] | Loss=0.00106 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.648 | L2-Norm(final)=15.962 | 4647.9 samples/s | 72.6 steps/s
[Step=35400 Epoch=135.6] | Loss=0.00101 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.641 | L2-Norm(final)=15.963 | 4553.4 samples/s | 71.1 steps/s
[Step=35450 Epoch=135.8] | Loss=0.00095 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.634 | L2-Norm(final)=15.963 | 4615.8 samples/s | 72.1 steps/s
[Step=35500 Epoch=136.0] | Loss=0.00090 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.626 | L2-Norm(final)=15.963 | 4468.8 samples/s | 69.8 steps/s
[Step=35550 Epoch=136.2] | Loss=0.00086 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.619 | L2-Norm(final)=15.963 | 2160.5 samples/s | 33.8 steps/s
[Step=35600 Epoch=136.4] | Loss=0.00082 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.611 | L2-Norm(final)=15.963 | 4653.3 samples/s | 72.7 steps/s
[Step=35650 Epoch=136.6] | Loss=0.00079 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.603 | L2-Norm(final)=15.964 | 4494.6 samples/s | 70.2 steps/s
[Step=35700 Epoch=136.8] | Loss=0.00075 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.594 | L2-Norm(final)=15.964 | 4632.1 samples/s | 72.4 steps/s
[Step=35750 Epoch=137.0] | Loss=0.00072 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.586 | L2-Norm(final)=15.964 | 4464.3 samples/s | 69.8 steps/s
[Step=35800 Epoch=137.2] | Loss=0.00070 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.578 | L2-Norm(final)=15.965 | 6171.5 samples/s | 96.4 steps/s
[Step=35850 Epoch=137.4] | Loss=0.00067 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.569 | L2-Norm(final)=15.965 | 1875.5 samples/s | 29.3 steps/s
[Step=35900 Epoch=137.6] | Loss=0.00065 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.560 | L2-Norm(final)=15.965 | 4564.7 samples/s | 71.3 steps/s
[Step=35950 Epoch=137.7] | Loss=0.00062 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.551 | L2-Norm(final)=15.966 | 4565.0 samples/s | 71.3 steps/s
[Step=36000 Epoch=137.9] | Loss=0.00060 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.542 | L2-Norm(final)=15.966 | 4463.5 samples/s | 69.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step36000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=34001 Epoch=130.9] | Loss=0.00011 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=15.508 | 4317.3 samples/s | 67.5 steps/s
[Step=34050 Epoch=131.1] | Loss=0.00044 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.288 | L2-Norm(final)=15.511 | 4936.3 samples/s | 77.1 steps/s
[Step=34100 Epoch=131.3] | Loss=0.00066 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.288 | L2-Norm(final)=15.517 | 5280.9 samples/s | 82.5 steps/s
[Step=34150 Epoch=131.5] | Loss=0.00051 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.287 | L2-Norm(final)=15.522 | 5034.9 samples/s | 78.7 steps/s
[Step=34200 Epoch=131.6] | Loss=0.00053 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.287 | L2-Norm(final)=15.526 | 5317.5 samples/s | 83.1 steps/s
[Step=34250 Epoch=131.8] | Loss=0.00054 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.287 | L2-Norm(final)=15.531 | 7025.6 samples/s | 109.8 steps/s
[Step=34300 Epoch=132.0] | Loss=0.00056 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.287 | L2-Norm(final)=15.536 | 2063.2 samples/s | 32.2 steps/s
[Step=34350 Epoch=132.2] | Loss=0.00060 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.287 | L2-Norm(final)=15.541 | 5329.9 samples/s | 83.3 steps/s
[Step=34400 Epoch=132.4] | Loss=0.00057 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.287 | L2-Norm(final)=15.546 | 5202.5 samples/s | 81.3 steps/s
[Step=34450 Epoch=132.6] | Loss=0.00056 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.287 | L2-Norm(final)=15.551 | 5019.4 samples/s | 78.4 steps/s
[Step=34500 Epoch=132.8] | Loss=0.00054 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.287 | L2-Norm(final)=15.555 | 6006.4 samples/s | 93.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=34501 Epoch=132.8] | Loss=0.00006 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.287 | L2-Norm(final)=15.608 | 4256.9 samples/s | 66.5 steps/s
[Step=34550 Epoch=133.0] | Loss=0.00016 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.296 | L2-Norm(final)=15.611 | 4577.8 samples/s | 71.5 steps/s
[Step=34600 Epoch=133.2] | Loss=0.00023 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.305 | L2-Norm(final)=15.613 | 4624.7 samples/s | 72.3 steps/s
[Step=34650 Epoch=133.4] | Loss=0.00018 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.312 | L2-Norm(final)=15.616 | 4654.2 samples/s | 72.7 steps/s
[Step=34700 Epoch=133.6] | Loss=0.00014 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=15.617 | 4695.0 samples/s | 73.4 steps/s
[Step=34750 Epoch=133.8] | Loss=0.00011 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.305 | L2-Norm(final)=15.619 | 5882.5 samples/s | 91.9 steps/s
[Step=34800 Epoch=134.0] | Loss=0.00009 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.295 | L2-Norm(final)=15.620 | 1964.4 samples/s | 30.7 steps/s
[Step=34850 Epoch=134.2] | Loss=0.00008 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.285 | L2-Norm(final)=15.620 | 4522.2 samples/s | 70.7 steps/s
[Step=34900 Epoch=134.3] | Loss=0.00007 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.274 | L2-Norm(final)=15.621 | 4498.3 samples/s | 70.3 steps/s
[Step=34950 Epoch=134.5] | Loss=0.00006 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.263 | L2-Norm(final)=15.621 | 4438.1 samples/s | 69.3 steps/s
[Step=35000 Epoch=134.7] | Loss=0.00006 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.252 | L2-Norm(final)=15.622 | 5125.5 samples/s | 80.1 steps/s
[Step=35050 Epoch=134.9] | Loss=0.00005 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.240 | L2-Norm(final)=15.622 | 1992.8 samples/s | 31.1 steps/s
[Step=35100 Epoch=135.1] | Loss=0.00005 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.229 | L2-Norm(final)=15.623 | 4568.4 samples/s | 71.4 steps/s
[Step=35150 Epoch=135.3] | Loss=0.00004 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.218 | L2-Norm(final)=15.623 | 4476.4 samples/s | 69.9 steps/s
[Step=35200 Epoch=135.5] | Loss=0.00004 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.206 | L2-Norm(final)=15.623 | 4552.7 samples/s | 71.1 steps/s
[Step=35250 Epoch=135.7] | Loss=0.00004 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.195 | L2-Norm(final)=15.624 | 4691.9 samples/s | 73.3 steps/s
[Step=35300 Epoch=135.9] | Loss=0.00004 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.184 | L2-Norm(final)=15.624 | 2112.8 samples/s | 33.0 steps/s
[Step=35350 Epoch=136.1] | Loss=0.00003 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.172 | L2-Norm(final)=15.625 | 4604.5 samples/s | 71.9 steps/s
[Step=35400 Epoch=136.3] | Loss=0.00003 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.161 | L2-Norm(final)=15.625 | 4456.0 samples/s | 69.6 steps/s
[Step=35450 Epoch=136.5] | Loss=0.00003 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.149 | L2-Norm(final)=15.626 | 4555.2 samples/s | 71.2 steps/s
[Step=35500 Epoch=136.7] | Loss=0.00003 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.138 | L2-Norm(final)=15.627 | 4535.6 samples/s | 70.9 steps/s
[Step=35550 Epoch=136.8] | Loss=0.00003 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.127 | L2-Norm(final)=15.627 | 2135.2 samples/s | 33.4 steps/s
[Step=35600 Epoch=137.0] | Loss=0.00003 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.115 | L2-Norm(final)=15.628 | 4550.6 samples/s | 71.1 steps/s
[Step=35650 Epoch=137.2] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=15.628 | 4467.0 samples/s | 69.8 steps/s
[Step=35700 Epoch=137.4] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.092 | L2-Norm(final)=15.629 | 4528.0 samples/s | 70.8 steps/s
[Step=35750 Epoch=137.6] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.081 | L2-Norm(final)=15.629 | 4533.0 samples/s | 70.8 steps/s
[Step=35800 Epoch=137.8] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.069 | L2-Norm(final)=15.630 | 6635.6 samples/s | 103.7 steps/s
[Step=35850 Epoch=138.0] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.057 | L2-Norm(final)=15.631 | 1838.1 samples/s | 28.7 steps/s
[Step=35900 Epoch=138.2] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.046 | L2-Norm(final)=15.631 | 4539.2 samples/s | 70.9 steps/s
[Step=35950 Epoch=138.4] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.034 | L2-Norm(final)=15.632 | 4639.7 samples/s | 72.5 steps/s
[Step=36000 Epoch=138.6] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.022 | L2-Norm(final)=15.632 | 4626.2 samples/s | 72.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07080 | acc=0.9654 | tpr=0.9702 | fpr=0.0451 | 3780.5 samples/s | 14.8 steps/s
Avg test loss: 0.06872, Avg test acc: 0.96622, Avg tpr: 0.97062, Avg fpr: 0.04346, total FA: 339

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06607 | acc=0.9698 | tpr=0.9777 | fpr=0.0473 | 3230.2 samples/s | 12.6 steps/s
Avg test loss: 0.06721, Avg test acc: 0.96891, Avg tpr: 0.97663, Avg fpr: 0.04807, total FA: 375

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.98354 | acc=0.3129 | tpr=0.0046 | fpr=0.0176 | 3597.9 samples/s | 14.1 steps/s
Avg test loss: 7.00315, Avg test acc: 0.31040, Avg tpr: 0.00495, Avg fpr: 0.01782, total FA: 139

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.71227 | acc=0.3100 | tpr=0.0120 | fpr=0.0429 | 4411.9 samples/s | 17.2 steps/s
Avg test loss: 6.73308, Avg test acc: 0.30748, Avg tpr: 0.01166, Avg fpr: 0.04192, total FA: 327

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.91700 | acc=0.1141 | tpr=0.7168 | fpr=0.8968 | 4458.3 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.88485 | acc=0.1138 | tpr=0.7122 | fpr=0.8974 | 8650.5 samples/s | 33.8 steps/s
[Step= 150] | Loss=5.89547 | acc=0.1124 | tpr=0.7161 | fpr=0.8987 | 8249.3 samples/s | 32.2 steps/s
[Step= 200] | Loss=5.89082 | acc=0.1117 | tpr=0.7016 | fpr=0.8990 | 4965.9 samples/s | 19.4 steps/s
[Step= 250] | Loss=5.89952 | acc=0.1120 | tpr=0.7057 | fpr=0.8988 | 8414.2 samples/s | 32.9 steps/s
[Step= 300] | Loss=5.89723 | acc=0.1111 | tpr=0.7033 | fpr=0.8997 | 8484.3 samples/s | 33.1 steps/s
[Step= 350] | Loss=5.89731 | acc=0.1107 | tpr=0.7026 | fpr=0.9001 | 8504.4 samples/s | 33.2 steps/s
[Step= 400] | Loss=5.90245 | acc=0.1106 | tpr=0.6969 | fpr=0.9000 | 8554.2 samples/s | 33.4 steps/s
[Step= 450] | Loss=5.90432 | acc=0.1106 | tpr=0.6972 | fpr=0.9000 | 8322.8 samples/s | 32.5 steps/s
[Step= 500] | Loss=5.90312 | acc=0.1107 | tpr=0.6978 | fpr=0.8999 | 8234.3 samples/s | 32.2 steps/s
[Step= 550] | Loss=5.90751 | acc=0.1105 | tpr=0.6948 | fpr=0.9001 | 15225.8 samples/s | 59.5 steps/s
Avg test loss: 5.90825, Avg test acc: 0.11047, Avg tpr: 0.69532, Avg fpr: 0.90016, total FA: 124986

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.29087 | acc=0.1036 | tpr=0.7168 | fpr=0.9074 | 4438.7 samples/s | 17.3 steps/s
[Step= 100] | Loss=7.24081 | acc=0.1039 | tpr=0.7186 | fpr=0.9076 | 8683.0 samples/s | 33.9 steps/s
[Step= 150] | Loss=7.25178 | acc=0.1035 | tpr=0.7233 | fpr=0.9079 | 8380.8 samples/s | 32.7 steps/s
[Step= 200] | Loss=7.23880 | acc=0.1028 | tpr=0.7038 | fpr=0.9082 | 4927.7 samples/s | 19.2 steps/s
[Step= 250] | Loss=7.24824 | acc=0.1023 | tpr=0.6996 | fpr=0.9086 | 8664.8 samples/s | 33.8 steps/s
[Step= 300] | Loss=7.24497 | acc=0.1016 | tpr=0.6938 | fpr=0.9092 | 8540.0 samples/s | 33.4 steps/s
[Step= 350] | Loss=7.23963 | acc=0.1012 | tpr=0.6900 | fpr=0.9095 | 8054.7 samples/s | 31.5 steps/s
[Step= 400] | Loss=7.24349 | acc=0.1013 | tpr=0.6937 | fpr=0.9095 | 8290.8 samples/s | 32.4 steps/s
[Step= 450] | Loss=7.24588 | acc=0.1014 | tpr=0.6986 | fpr=0.9095 | 8427.8 samples/s | 32.9 steps/s
[Step= 500] | Loss=7.24458 | acc=0.1014 | tpr=0.7000 | fpr=0.9094 | 8290.3 samples/s | 32.4 steps/s
[Step= 550] | Loss=7.24867 | acc=0.1012 | tpr=0.6992 | fpr=0.9097 | 14761.3 samples/s | 57.7 steps/s
Avg test loss: 7.24895, Avg test acc: 0.10113, Avg tpr: 0.69929, Avg fpr: 0.90974, total FA: 126316

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13571 | acc=0.9843 | tpr=0.9336 | fpr=0.0148 | 4433.9 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.14531 | acc=0.9834 | tpr=0.9531 | fpr=0.0160 | 8474.2 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.15258 | acc=0.9825 | tpr=0.9510 | fpr=0.0169 | 5643.7 samples/s | 22.0 steps/s
[Step= 200] | Loss=0.15353 | acc=0.9826 | tpr=0.9508 | fpr=0.0168 | 6941.4 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.15028 | acc=0.9826 | tpr=0.9476 | fpr=0.0168 | 8531.1 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.15262 | acc=0.9824 | tpr=0.9491 | fpr=0.0170 | 9072.8 samples/s | 35.4 steps/s
[Step= 350] | Loss=0.15368 | acc=0.9823 | tpr=0.9493 | fpr=0.0171 | 7903.7 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.15577 | acc=0.9820 | tpr=0.9437 | fpr=0.0173 | 8223.8 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.15925 | acc=0.9817 | tpr=0.9411 | fpr=0.0176 | 8661.7 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.15860 | acc=0.9818 | tpr=0.9423 | fpr=0.0175 | 8359.9 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.15726 | acc=0.9819 | tpr=0.9403 | fpr=0.0174 | 15242.1 samples/s | 59.5 steps/s
Avg test loss: 0.15688, Avg test acc: 0.98190, Avg tpr: 0.94057, Avg fpr: 0.01735, total FA: 2409

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14358 | acc=0.9841 | tpr=0.9336 | fpr=0.0150 | 4449.4 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.15556 | acc=0.9832 | tpr=0.9552 | fpr=0.0162 | 8479.4 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.16303 | acc=0.9824 | tpr=0.9611 | fpr=0.0172 | 4997.7 samples/s | 19.5 steps/s
[Step= 200] | Loss=0.16376 | acc=0.9824 | tpr=0.9639 | fpr=0.0173 | 8370.2 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.16139 | acc=0.9824 | tpr=0.9624 | fpr=0.0173 | 8467.2 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.16379 | acc=0.9823 | tpr=0.9629 | fpr=0.0173 | 8337.4 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.16601 | acc=0.9821 | tpr=0.9612 | fpr=0.0175 | 8384.0 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.16831 | acc=0.9819 | tpr=0.9601 | fpr=0.0177 | 8586.0 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.17102 | acc=0.9815 | tpr=0.9586 | fpr=0.0180 | 8322.8 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.17059 | acc=0.9816 | tpr=0.9581 | fpr=0.0180 | 8290.4 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.16956 | acc=0.9816 | tpr=0.9546 | fpr=0.0179 | 15907.2 samples/s | 62.1 steps/s
Avg test loss: 0.16911, Avg test acc: 0.98162, Avg tpr: 0.95444, Avg fpr: 0.01789, total FA: 2484

server round 18/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=36001 Epoch=70.2] | Loss=0.03842 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.217 | L2-Norm(final)=13.888 | 4086.0 samples/s | 63.8 steps/s
[Step=36050 Epoch=70.3] | Loss=0.01787 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.220 | L2-Norm(final)=13.900 | 5351.6 samples/s | 83.6 steps/s
[Step=36100 Epoch=70.4] | Loss=0.01673 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.221 | L2-Norm(final)=13.916 | 5607.8 samples/s | 87.6 steps/s
[Step=36150 Epoch=70.5] | Loss=0.01643 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.221 | L2-Norm(final)=13.934 | 5419.3 samples/s | 84.7 steps/s
[Step=36200 Epoch=70.6] | Loss=0.01679 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.221 | L2-Norm(final)=13.948 | 5516.7 samples/s | 86.2 steps/s
[Step=36250 Epoch=70.7] | Loss=0.01645 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.221 | L2-Norm(final)=13.962 | 5652.9 samples/s | 88.3 steps/s
[Step=36300 Epoch=70.8] | Loss=0.01645 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.221 | L2-Norm(final)=13.978 | 5478.2 samples/s | 85.6 steps/s
[Step=36350 Epoch=70.9] | Loss=0.01660 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.221 | L2-Norm(final)=13.993 | 5478.4 samples/s | 85.6 steps/s
[Step=36400 Epoch=71.0] | Loss=0.01649 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.221 | L2-Norm(final)=14.007 | 5461.1 samples/s | 85.3 steps/s
[Step=36450 Epoch=71.1] | Loss=0.01625 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.221 | L2-Norm(final)=14.022 | 5487.2 samples/s | 85.7 steps/s
[Step=36500 Epoch=71.2] | Loss=0.01641 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.221 | L2-Norm(final)=14.038 | 6948.9 samples/s | 108.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=36501 Epoch=71.2] | Loss=0.01111 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.221 | L2-Norm(final)=14.183 | 3887.8 samples/s | 60.7 steps/s
[Step=36550 Epoch=71.3] | Loss=0.01461 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.274 | L2-Norm(final)=14.184 | 4688.3 samples/s | 73.3 steps/s
[Step=36600 Epoch=71.4] | Loss=0.01513 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.312 | L2-Norm(final)=14.183 | 4791.3 samples/s | 74.9 steps/s
[Step=36650 Epoch=71.5] | Loss=0.01662 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.340 | L2-Norm(final)=14.180 | 4780.2 samples/s | 74.7 steps/s
[Step=36700 Epoch=71.6] | Loss=0.01628 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.364 | L2-Norm(final)=14.177 | 4795.8 samples/s | 74.9 steps/s
[Step=36750 Epoch=71.7] | Loss=0.01536 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.383 | L2-Norm(final)=14.177 | 4716.7 samples/s | 73.7 steps/s
[Step=36800 Epoch=71.8] | Loss=0.01646 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.400 | L2-Norm(final)=14.175 | 4797.5 samples/s | 75.0 steps/s
[Step=36850 Epoch=71.9] | Loss=0.01618 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.415 | L2-Norm(final)=14.174 | 4776.7 samples/s | 74.6 steps/s
[Step=36900 Epoch=72.0] | Loss=0.01626 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.429 | L2-Norm(final)=14.173 | 4859.1 samples/s | 75.9 steps/s
[Step=36950 Epoch=72.1] | Loss=0.01656 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.444 | L2-Norm(final)=14.172 | 4770.7 samples/s | 74.5 steps/s
[Step=37000 Epoch=72.2] | Loss=0.01647 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.458 | L2-Norm(final)=14.171 | 5828.5 samples/s | 91.1 steps/s
[Step=37050 Epoch=72.3] | Loss=0.01598 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.471 | L2-Norm(final)=14.171 | 1913.9 samples/s | 29.9 steps/s
[Step=37100 Epoch=72.4] | Loss=0.01562 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.484 | L2-Norm(final)=14.170 | 4793.4 samples/s | 74.9 steps/s
[Step=37150 Epoch=72.5] | Loss=0.01533 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.496 | L2-Norm(final)=14.170 | 4749.2 samples/s | 74.2 steps/s
[Step=37200 Epoch=72.6] | Loss=0.01538 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.509 | L2-Norm(final)=14.170 | 4906.0 samples/s | 76.7 steps/s
[Step=37250 Epoch=72.7] | Loss=0.01530 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.520 | L2-Norm(final)=14.169 | 4708.6 samples/s | 73.6 steps/s
[Step=37300 Epoch=72.7] | Loss=0.01499 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.531 | L2-Norm(final)=14.168 | 4777.0 samples/s | 74.6 steps/s
[Step=37350 Epoch=72.8] | Loss=0.01506 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.542 | L2-Norm(final)=14.167 | 4777.9 samples/s | 74.7 steps/s
[Step=37400 Epoch=72.9] | Loss=0.01500 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.552 | L2-Norm(final)=14.166 | 4804.1 samples/s | 75.1 steps/s
[Step=37450 Epoch=73.0] | Loss=0.01482 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.562 | L2-Norm(final)=14.166 | 4726.9 samples/s | 73.9 steps/s
[Step=37500 Epoch=73.1] | Loss=0.01468 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.572 | L2-Norm(final)=14.165 | 5086.4 samples/s | 79.5 steps/s
[Step=37550 Epoch=73.2] | Loss=0.01451 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.581 | L2-Norm(final)=14.165 | 2002.0 samples/s | 31.3 steps/s
[Step=37600 Epoch=73.3] | Loss=0.01429 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.590 | L2-Norm(final)=14.165 | 4770.6 samples/s | 74.5 steps/s
[Step=37650 Epoch=73.4] | Loss=0.01422 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.599 | L2-Norm(final)=14.165 | 4898.4 samples/s | 76.5 steps/s
[Step=37700 Epoch=73.5] | Loss=0.01405 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.608 | L2-Norm(final)=14.164 | 4576.7 samples/s | 71.5 steps/s
[Step=37750 Epoch=73.6] | Loss=0.01383 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.617 | L2-Norm(final)=14.164 | 4261.0 samples/s | 66.6 steps/s
[Step=37800 Epoch=73.7] | Loss=0.01370 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.625 | L2-Norm(final)=14.164 | 4540.4 samples/s | 70.9 steps/s
[Step=37850 Epoch=73.8] | Loss=0.01358 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.633 | L2-Norm(final)=14.164 | 4144.4 samples/s | 64.8 steps/s
[Step=37900 Epoch=73.9] | Loss=0.01351 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.642 | L2-Norm(final)=14.164 | 4184.5 samples/s | 65.4 steps/s
[Step=37950 Epoch=74.0] | Loss=0.01336 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.650 | L2-Norm(final)=14.164 | 4242.7 samples/s | 66.3 steps/s
[Step=38000 Epoch=74.1] | Loss=0.01334 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.657 | L2-Norm(final)=14.164 | 4199.6 samples/s | 65.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step38000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=36001 Epoch=70.4] | Loss=0.02528 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.217 | L2-Norm(final)=14.324 | 4245.8 samples/s | 66.3 steps/s
[Step=36050 Epoch=70.5] | Loss=0.02019 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.219 | L2-Norm(final)=14.346 | 4192.2 samples/s | 65.5 steps/s
[Step=36100 Epoch=70.6] | Loss=0.01892 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.219 | L2-Norm(final)=14.362 | 5045.3 samples/s | 78.8 steps/s
[Step=36150 Epoch=70.7] | Loss=0.01864 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.219 | L2-Norm(final)=14.378 | 5462.8 samples/s | 85.4 steps/s
[Step=36200 Epoch=70.8] | Loss=0.01878 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.219 | L2-Norm(final)=14.392 | 5448.6 samples/s | 85.1 steps/s
[Step=36250 Epoch=70.9] | Loss=0.01844 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.219 | L2-Norm(final)=14.407 | 5503.9 samples/s | 86.0 steps/s
[Step=36300 Epoch=71.0] | Loss=0.01823 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.219 | L2-Norm(final)=14.421 | 5529.7 samples/s | 86.4 steps/s
[Step=36350 Epoch=71.1] | Loss=0.01821 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.219 | L2-Norm(final)=14.435 | 5463.7 samples/s | 85.4 steps/s
[Step=36400 Epoch=71.2] | Loss=0.01824 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.219 | L2-Norm(final)=14.448 | 5538.2 samples/s | 86.5 steps/s
[Step=36450 Epoch=71.3] | Loss=0.01810 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.219 | L2-Norm(final)=14.462 | 5562.8 samples/s | 86.9 steps/s
[Step=36500 Epoch=71.4] | Loss=0.01826 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.219 | L2-Norm(final)=14.476 | 6867.2 samples/s | 107.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=36501 Epoch=71.4] | Loss=0.01319 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.219 | L2-Norm(final)=14.615 | 4233.5 samples/s | 66.1 steps/s
[Step=36550 Epoch=71.5] | Loss=0.01582 | Reg=0.00176 | acc=0.9531 | L2-Norm=13.270 | L2-Norm(final)=14.623 | 4774.0 samples/s | 74.6 steps/s
[Step=36600 Epoch=71.6] | Loss=0.01630 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.319 | L2-Norm(final)=14.624 | 4799.4 samples/s | 75.0 steps/s
[Step=36650 Epoch=71.6] | Loss=0.01643 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.356 | L2-Norm(final)=14.620 | 4819.0 samples/s | 75.3 steps/s
[Step=36700 Epoch=71.7] | Loss=0.01713 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.385 | L2-Norm(final)=14.617 | 4773.9 samples/s | 74.6 steps/s
[Step=36750 Epoch=71.8] | Loss=0.01701 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.410 | L2-Norm(final)=14.612 | 4825.0 samples/s | 75.4 steps/s
[Step=36800 Epoch=71.9] | Loss=0.01655 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.433 | L2-Norm(final)=14.610 | 4723.4 samples/s | 73.8 steps/s
[Step=36850 Epoch=72.0] | Loss=0.01673 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.452 | L2-Norm(final)=14.608 | 4796.0 samples/s | 74.9 steps/s
[Step=36900 Epoch=72.1] | Loss=0.01634 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.470 | L2-Norm(final)=14.606 | 4784.4 samples/s | 74.8 steps/s
[Step=36950 Epoch=72.2] | Loss=0.01652 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=14.605 | 4825.8 samples/s | 75.4 steps/s
[Step=37000 Epoch=72.3] | Loss=0.01658 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.503 | L2-Norm(final)=14.604 | 5935.9 samples/s | 92.7 steps/s
[Step=37050 Epoch=72.4] | Loss=0.01616 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.518 | L2-Norm(final)=14.604 | 2050.7 samples/s | 32.0 steps/s
[Step=37100 Epoch=72.5] | Loss=0.01584 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.532 | L2-Norm(final)=14.603 | 4751.6 samples/s | 74.2 steps/s
[Step=37150 Epoch=72.6] | Loss=0.01568 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.544 | L2-Norm(final)=14.603 | 4779.2 samples/s | 74.7 steps/s
[Step=37200 Epoch=72.7] | Loss=0.01536 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.555 | L2-Norm(final)=14.603 | 4750.5 samples/s | 74.2 steps/s
[Step=37250 Epoch=72.8] | Loss=0.01534 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.567 | L2-Norm(final)=14.603 | 4775.2 samples/s | 74.6 steps/s
[Step=37300 Epoch=72.9] | Loss=0.01515 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.578 | L2-Norm(final)=14.603 | 4758.5 samples/s | 74.4 steps/s
[Step=37350 Epoch=73.0] | Loss=0.01498 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.588 | L2-Norm(final)=14.602 | 4888.6 samples/s | 76.4 steps/s
[Step=37400 Epoch=73.1] | Loss=0.01478 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.599 | L2-Norm(final)=14.601 | 4783.9 samples/s | 74.7 steps/s
[Step=37450 Epoch=73.2] | Loss=0.01447 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.609 | L2-Norm(final)=14.601 | 4767.0 samples/s | 74.5 steps/s
[Step=37500 Epoch=73.3] | Loss=0.01450 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.619 | L2-Norm(final)=14.600 | 5126.3 samples/s | 80.1 steps/s
[Step=37550 Epoch=73.4] | Loss=0.01432 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.629 | L2-Norm(final)=14.600 | 2127.7 samples/s | 33.2 steps/s
[Step=37600 Epoch=73.5] | Loss=0.01410 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.638 | L2-Norm(final)=14.600 | 4855.5 samples/s | 75.9 steps/s
[Step=37650 Epoch=73.6] | Loss=0.01384 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.648 | L2-Norm(final)=14.600 | 4774.6 samples/s | 74.6 steps/s
[Step=37700 Epoch=73.7] | Loss=0.01395 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.657 | L2-Norm(final)=14.599 | 4793.0 samples/s | 74.9 steps/s
[Step=37750 Epoch=73.8] | Loss=0.01411 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.666 | L2-Norm(final)=14.599 | 4707.0 samples/s | 73.5 steps/s
[Step=37800 Epoch=73.9] | Loss=0.01406 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.676 | L2-Norm(final)=14.598 | 4786.3 samples/s | 74.8 steps/s
[Step=37850 Epoch=74.0] | Loss=0.01399 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.685 | L2-Norm(final)=14.597 | 4784.1 samples/s | 74.8 steps/s
[Step=37900 Epoch=74.1] | Loss=0.01381 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.694 | L2-Norm(final)=14.596 | 4807.2 samples/s | 75.1 steps/s
[Step=37950 Epoch=74.2] | Loss=0.01381 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.703 | L2-Norm(final)=14.596 | 4822.9 samples/s | 75.4 steps/s
[Step=38000 Epoch=74.3] | Loss=0.01378 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.711 | L2-Norm(final)=14.595 | 4783.3 samples/s | 74.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step38000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=36001 Epoch=137.9] | Loss=0.00022 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.217 | L2-Norm(final)=15.978 | 3927.4 samples/s | 61.4 steps/s
[Step=36050 Epoch=138.1] | Loss=0.00011 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.215 | L2-Norm(final)=15.988 | 2219.3 samples/s | 34.7 steps/s
[Step=36100 Epoch=138.3] | Loss=0.00011 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.214 | L2-Norm(final)=15.998 | 4797.1 samples/s | 75.0 steps/s
[Step=36150 Epoch=138.5] | Loss=0.00011 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.214 | L2-Norm(final)=16.006 | 5256.2 samples/s | 82.1 steps/s
[Step=36200 Epoch=138.7] | Loss=0.00011 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.214 | L2-Norm(final)=16.015 | 5203.6 samples/s | 81.3 steps/s
[Step=36250 Epoch=138.9] | Loss=0.00013 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.214 | L2-Norm(final)=16.024 | 5768.4 samples/s | 90.1 steps/s
[Step=36300 Epoch=139.1] | Loss=0.00012 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.214 | L2-Norm(final)=16.033 | 2031.8 samples/s | 31.7 steps/s
[Step=36350 Epoch=139.3] | Loss=0.00012 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.214 | L2-Norm(final)=16.041 | 5213.1 samples/s | 81.5 steps/s
[Step=36400 Epoch=139.5] | Loss=0.00012 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.214 | L2-Norm(final)=16.049 | 5037.5 samples/s | 78.7 steps/s
[Step=36450 Epoch=139.7] | Loss=0.00012 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.214 | L2-Norm(final)=16.057 | 5190.5 samples/s | 81.1 steps/s
[Step=36500 Epoch=139.9] | Loss=0.00012 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.214 | L2-Norm(final)=16.065 | 5641.6 samples/s | 88.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=36501 Epoch=139.9] | Loss=0.00019 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.214 | L2-Norm(final)=16.146 | 4084.6 samples/s | 63.8 steps/s
[Step=36550 Epoch=140.0] | Loss=0.00009 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.206 | L2-Norm(final)=16.148 | 4447.6 samples/s | 69.5 steps/s
[Step=36600 Epoch=140.2] | Loss=0.00005 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.192 | L2-Norm(final)=16.151 | 4450.3 samples/s | 69.5 steps/s
[Step=36650 Epoch=140.4] | Loss=0.00004 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.174 | L2-Norm(final)=16.153 | 4459.7 samples/s | 69.7 steps/s
[Step=36700 Epoch=140.6] | Loss=0.00003 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.157 | L2-Norm(final)=16.154 | 4392.7 samples/s | 68.6 steps/s
[Step=36750 Epoch=140.8] | Loss=0.00003 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.141 | L2-Norm(final)=16.156 | 5675.2 samples/s | 88.7 steps/s
[Step=36800 Epoch=141.0] | Loss=0.00003 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.129 | L2-Norm(final)=16.158 | 1934.5 samples/s | 30.2 steps/s
[Step=36850 Epoch=141.2] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.114 | L2-Norm(final)=16.160 | 4427.0 samples/s | 69.2 steps/s
[Step=36900 Epoch=141.4] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.099 | L2-Norm(final)=16.161 | 4315.7 samples/s | 67.4 steps/s
[Step=36950 Epoch=141.6] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.084 | L2-Norm(final)=16.163 | 4348.5 samples/s | 67.9 steps/s
[Step=37000 Epoch=141.8] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.069 | L2-Norm(final)=16.164 | 4807.5 samples/s | 75.1 steps/s
[Step=37050 Epoch=142.0] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.053 | L2-Norm(final)=16.165 | 2049.2 samples/s | 32.0 steps/s
[Step=37100 Epoch=142.2] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.038 | L2-Norm(final)=16.166 | 4404.4 samples/s | 68.8 steps/s
[Step=37150 Epoch=142.3] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.023 | L2-Norm(final)=16.167 | 4496.5 samples/s | 70.3 steps/s
[Step=37200 Epoch=142.5] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.007 | L2-Norm(final)=16.167 | 4485.4 samples/s | 70.1 steps/s
[Step=37250 Epoch=142.7] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.992 | L2-Norm(final)=16.168 | 4484.5 samples/s | 70.1 steps/s
[Step=37300 Epoch=142.9] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.976 | L2-Norm(final)=16.169 | 2120.9 samples/s | 33.1 steps/s
[Step=37350 Epoch=143.1] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=16.170 | 4520.4 samples/s | 70.6 steps/s
[Step=37400 Epoch=143.3] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.946 | L2-Norm(final)=16.171 | 4443.6 samples/s | 69.4 steps/s
[Step=37450 Epoch=143.5] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.930 | L2-Norm(final)=16.171 | 4503.4 samples/s | 70.4 steps/s
[Step=37500 Epoch=143.7] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.915 | L2-Norm(final)=16.172 | 4510.1 samples/s | 70.5 steps/s
[Step=37550 Epoch=143.9] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.899 | L2-Norm(final)=16.173 | 2109.8 samples/s | 33.0 steps/s
[Step=37600 Epoch=144.1] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.884 | L2-Norm(final)=16.173 | 4597.8 samples/s | 71.8 steps/s
[Step=37650 Epoch=144.3] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.868 | L2-Norm(final)=16.174 | 4495.2 samples/s | 70.2 steps/s
[Step=37700 Epoch=144.5] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.852 | L2-Norm(final)=16.175 | 4504.4 samples/s | 70.4 steps/s
[Step=37750 Epoch=144.6] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.837 | L2-Norm(final)=16.175 | 4507.1 samples/s | 70.4 steps/s
[Step=37800 Epoch=144.8] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.821 | L2-Norm(final)=16.176 | 6133.2 samples/s | 95.8 steps/s
[Step=37850 Epoch=145.0] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.805 | L2-Norm(final)=16.177 | 1899.0 samples/s | 29.7 steps/s
[Step=37900 Epoch=145.2] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.789 | L2-Norm(final)=16.178 | 4513.1 samples/s | 70.5 steps/s
[Step=37950 Epoch=145.4] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=16.178 | 4507.9 samples/s | 70.4 steps/s
[Step=38000 Epoch=145.6] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.757 | L2-Norm(final)=16.179 | 4539.3 samples/s | 70.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step38000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=36001 Epoch=138.6] | Loss=0.00075 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.217 | L2-Norm(final)=15.651 | 4142.8 samples/s | 64.7 steps/s
[Step=36050 Epoch=138.8] | Loss=0.00031 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.213 | L2-Norm(final)=15.661 | 5207.7 samples/s | 81.4 steps/s
[Step=36100 Epoch=139.0] | Loss=0.00032 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.213 | L2-Norm(final)=15.672 | 5146.5 samples/s | 80.4 steps/s
[Step=36150 Epoch=139.2] | Loss=0.00035 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.213 | L2-Norm(final)=15.682 | 5089.5 samples/s | 79.5 steps/s
[Step=36200 Epoch=139.3] | Loss=0.00037 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.213 | L2-Norm(final)=15.694 | 5146.0 samples/s | 80.4 steps/s
[Step=36250 Epoch=139.5] | Loss=0.00039 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.213 | L2-Norm(final)=15.707 | 6960.7 samples/s | 108.8 steps/s
[Step=36300 Epoch=139.7] | Loss=0.00043 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.213 | L2-Norm(final)=15.720 | 2038.1 samples/s | 31.8 steps/s
[Step=36350 Epoch=139.9] | Loss=0.00046 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.213 | L2-Norm(final)=15.734 | 5178.4 samples/s | 80.9 steps/s
[Step=36400 Epoch=140.1] | Loss=0.00045 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.213 | L2-Norm(final)=15.747 | 5206.1 samples/s | 81.3 steps/s
[Step=36450 Epoch=140.3] | Loss=0.00045 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.213 | L2-Norm(final)=15.759 | 5137.8 samples/s | 80.3 steps/s
[Step=36500 Epoch=140.5] | Loss=0.00044 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.213 | L2-Norm(final)=15.772 | 5994.2 samples/s | 93.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=36501 Epoch=140.5] | Loss=0.00064 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.213 | L2-Norm(final)=15.894 | 4444.0 samples/s | 69.4 steps/s
[Step=36550 Epoch=140.7] | Loss=0.00494 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.270 | L2-Norm(final)=15.901 | 4241.8 samples/s | 66.3 steps/s
[Step=36600 Epoch=140.9] | Loss=0.00769 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.395 | L2-Norm(final)=15.873 | 4547.0 samples/s | 71.0 steps/s
[Step=36650 Epoch=141.1] | Loss=0.00620 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.473 | L2-Norm(final)=15.854 | 4502.6 samples/s | 70.4 steps/s
[Step=36700 Epoch=141.3] | Loss=0.00675 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.521 | L2-Norm(final)=15.843 | 4545.7 samples/s | 71.0 steps/s
[Step=36750 Epoch=141.5] | Loss=0.00665 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.561 | L2-Norm(final)=15.833 | 5814.2 samples/s | 90.8 steps/s
[Step=36800 Epoch=141.7] | Loss=0.00558 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.589 | L2-Norm(final)=15.828 | 1964.6 samples/s | 30.7 steps/s
[Step=36850 Epoch=141.9] | Loss=0.00497 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.608 | L2-Norm(final)=15.824 | 4565.4 samples/s | 71.3 steps/s
[Step=36900 Epoch=142.0] | Loss=0.00439 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.623 | L2-Norm(final)=15.821 | 4646.5 samples/s | 72.6 steps/s
[Step=36950 Epoch=142.2] | Loss=0.00397 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.633 | L2-Norm(final)=15.819 | 4645.8 samples/s | 72.6 steps/s
[Step=37000 Epoch=142.4] | Loss=0.00365 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.640 | L2-Norm(final)=15.817 | 5033.1 samples/s | 78.6 steps/s
[Step=37050 Epoch=142.6] | Loss=0.00332 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.645 | L2-Norm(final)=15.816 | 2066.2 samples/s | 32.3 steps/s
[Step=37100 Epoch=142.8] | Loss=0.00305 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.648 | L2-Norm(final)=15.815 | 4556.8 samples/s | 71.2 steps/s
[Step=37150 Epoch=143.0] | Loss=0.00282 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.650 | L2-Norm(final)=15.815 | 4676.1 samples/s | 73.1 steps/s
[Step=37200 Epoch=143.2] | Loss=0.00262 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.650 | L2-Norm(final)=15.814 | 4684.7 samples/s | 73.2 steps/s
[Step=37250 Epoch=143.4] | Loss=0.00244 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.649 | L2-Norm(final)=15.814 | 4684.6 samples/s | 73.2 steps/s
[Step=37300 Epoch=143.6] | Loss=0.00229 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.648 | L2-Norm(final)=15.814 | 2145.2 samples/s | 33.5 steps/s
[Step=37350 Epoch=143.8] | Loss=0.00216 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.646 | L2-Norm(final)=15.814 | 4586.1 samples/s | 71.7 steps/s
[Step=37400 Epoch=144.0] | Loss=0.00204 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.643 | L2-Norm(final)=15.815 | 4566.1 samples/s | 71.3 steps/s
[Step=37450 Epoch=144.2] | Loss=0.00193 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.640 | L2-Norm(final)=15.815 | 4422.4 samples/s | 69.1 steps/s
[Step=37500 Epoch=144.4] | Loss=0.00183 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.637 | L2-Norm(final)=15.816 | 4581.1 samples/s | 71.6 steps/s
[Step=37550 Epoch=144.5] | Loss=0.00175 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.633 | L2-Norm(final)=15.816 | 2139.6 samples/s | 33.4 steps/s
[Step=37600 Epoch=144.7] | Loss=0.00167 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.629 | L2-Norm(final)=15.817 | 4574.6 samples/s | 71.5 steps/s
[Step=37650 Epoch=144.9] | Loss=0.00159 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.625 | L2-Norm(final)=15.818 | 4566.2 samples/s | 71.3 steps/s
[Step=37700 Epoch=145.1] | Loss=0.00153 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.620 | L2-Norm(final)=15.818 | 4504.0 samples/s | 70.4 steps/s
[Step=37750 Epoch=145.3] | Loss=0.00147 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=15.819 | 4558.2 samples/s | 71.2 steps/s
[Step=37800 Epoch=145.5] | Loss=0.00141 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.610 | L2-Norm(final)=15.820 | 6531.6 samples/s | 102.1 steps/s
[Step=37850 Epoch=145.7] | Loss=0.00136 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.605 | L2-Norm(final)=15.821 | 1856.5 samples/s | 29.0 steps/s
[Step=37900 Epoch=145.9] | Loss=0.00131 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.600 | L2-Norm(final)=15.822 | 4575.5 samples/s | 71.5 steps/s
[Step=37950 Epoch=146.1] | Loss=0.00127 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.594 | L2-Norm(final)=15.823 | 4535.3 samples/s | 70.9 steps/s
[Step=38000 Epoch=146.3] | Loss=0.00122 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.589 | L2-Norm(final)=15.825 | 4571.1 samples/s | 71.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step38000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07461 | acc=0.9666 | tpr=0.9720 | fpr=0.0453 | 4437.8 samples/s | 17.3 steps/s
Avg test loss: 0.07256, Avg test acc: 0.96763, Avg tpr: 0.97301, Avg fpr: 0.04423, total FA: 345

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06167 | acc=0.9691 | tpr=0.9734 | fpr=0.0401 | 4468.5 samples/s | 17.5 steps/s
Avg test loss: 0.06251, Avg test acc: 0.96815, Avg tpr: 0.97243, Avg fpr: 0.04128, total FA: 322

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.17518 | acc=0.3143 | tpr=0.0081 | fpr=0.0208 | 4400.5 samples/s | 17.2 steps/s
Avg test loss: 6.19419, Avg test acc: 0.31184, Avg tpr: 0.00909, Avg fpr: 0.02230, total FA: 174

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.50366 | acc=0.3110 | tpr=0.0079 | fpr=0.0307 | 4451.3 samples/s | 17.4 steps/s
Avg test loss: 6.51364, Avg test acc: 0.30864, Avg tpr: 0.00799, Avg fpr: 0.03012, total FA: 235

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.90892 | acc=0.1153 | tpr=0.7301 | fpr=0.8957 | 4446.5 samples/s | 17.4 steps/s
[Step= 100] | Loss=6.85719 | acc=0.1158 | tpr=0.7186 | fpr=0.8955 | 8423.4 samples/s | 32.9 steps/s
[Step= 150] | Loss=6.87414 | acc=0.1147 | tpr=0.7262 | fpr=0.8965 | 8626.2 samples/s | 33.7 steps/s
[Step= 200] | Loss=6.86680 | acc=0.1136 | tpr=0.7148 | fpr=0.8973 | 8405.2 samples/s | 32.8 steps/s
[Step= 250] | Loss=6.87413 | acc=0.1137 | tpr=0.7144 | fpr=0.8973 | 8152.8 samples/s | 31.8 steps/s
[Step= 300] | Loss=6.86520 | acc=0.1133 | tpr=0.7105 | fpr=0.8975 | 8820.4 samples/s | 34.5 steps/s
[Step= 350] | Loss=6.86218 | acc=0.1128 | tpr=0.7057 | fpr=0.8979 | 8632.6 samples/s | 33.7 steps/s
[Step= 400] | Loss=6.86999 | acc=0.1129 | tpr=0.7030 | fpr=0.8978 | 7697.3 samples/s | 30.1 steps/s
[Step= 450] | Loss=6.87599 | acc=0.1133 | tpr=0.7074 | fpr=0.8975 | 8265.6 samples/s | 32.3 steps/s
[Step= 500] | Loss=6.87464 | acc=0.1130 | tpr=0.7070 | fpr=0.8977 | 8120.7 samples/s | 31.7 steps/s
[Step= 550] | Loss=6.87881 | acc=0.1128 | tpr=0.7047 | fpr=0.8979 | 15207.3 samples/s | 59.4 steps/s
Avg test loss: 6.87907, Avg test acc: 0.11275, Avg tpr: 0.70483, Avg fpr: 0.89802, total FA: 124688

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.22217 | acc=0.1285 | tpr=0.7478 | fpr=0.8826 | 4379.9 samples/s | 17.1 steps/s
[Step= 100] | Loss=6.18270 | acc=0.1289 | tpr=0.7399 | fpr=0.8825 | 8001.2 samples/s | 31.3 steps/s
[Step= 150] | Loss=6.19573 | acc=0.1292 | tpr=0.7450 | fpr=0.8822 | 7539.3 samples/s | 29.5 steps/s
[Step= 200] | Loss=6.19439 | acc=0.1288 | tpr=0.7355 | fpr=0.8822 | 8262.7 samples/s | 32.3 steps/s
[Step= 250] | Loss=6.20835 | acc=0.1286 | tpr=0.7328 | fpr=0.8824 | 7918.1 samples/s | 30.9 steps/s
[Step= 300] | Loss=6.20276 | acc=0.1282 | tpr=0.7295 | fpr=0.8828 | 8220.8 samples/s | 32.1 steps/s
[Step= 350] | Loss=6.20279 | acc=0.1276 | tpr=0.7301 | fpr=0.8834 | 7627.7 samples/s | 29.8 steps/s
[Step= 400] | Loss=6.20991 | acc=0.1278 | tpr=0.7287 | fpr=0.8831 | 7895.7 samples/s | 30.8 steps/s
[Step= 450] | Loss=6.21027 | acc=0.1279 | tpr=0.7264 | fpr=0.8829 | 7670.5 samples/s | 30.0 steps/s
[Step= 500] | Loss=6.21101 | acc=0.1277 | tpr=0.7251 | fpr=0.8831 | 7649.2 samples/s | 29.9 steps/s
[Step= 550] | Loss=6.21563 | acc=0.1275 | tpr=0.7230 | fpr=0.8833 | 14414.5 samples/s | 56.3 steps/s
Avg test loss: 6.21590, Avg test acc: 0.12748, Avg tpr: 0.72345, Avg fpr: 0.88335, total FA: 122652

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12414 | acc=0.9846 | tpr=0.9336 | fpr=0.0145 | 4148.4 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.13547 | acc=0.9833 | tpr=0.9510 | fpr=0.0161 | 8029.1 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.14069 | acc=0.9824 | tpr=0.9568 | fpr=0.0171 | 8134.8 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.14149 | acc=0.9825 | tpr=0.9617 | fpr=0.0171 | 7850.1 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.13953 | acc=0.9824 | tpr=0.9572 | fpr=0.0171 | 8505.6 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.14107 | acc=0.9823 | tpr=0.9578 | fpr=0.0172 | 8356.6 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.14280 | acc=0.9820 | tpr=0.9568 | fpr=0.0175 | 8524.8 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.14467 | acc=0.9818 | tpr=0.9551 | fpr=0.0177 | 8560.7 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.14735 | acc=0.9815 | tpr=0.9547 | fpr=0.0180 | 8165.0 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.14687 | acc=0.9815 | tpr=0.9551 | fpr=0.0180 | 7484.3 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.14580 | acc=0.9815 | tpr=0.9519 | fpr=0.0180 | 14032.3 samples/s | 54.8 steps/s
Avg test loss: 0.14543, Avg test acc: 0.98152, Avg tpr: 0.95166, Avg fpr: 0.01793, total FA: 2490

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12841 | acc=0.9811 | tpr=0.9292 | fpr=0.0180 | 4369.3 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.14081 | acc=0.9800 | tpr=0.9467 | fpr=0.0193 | 8592.3 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.14676 | acc=0.9792 | tpr=0.9553 | fpr=0.0203 | 7762.9 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.14754 | acc=0.9791 | tpr=0.9585 | fpr=0.0205 | 8414.9 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.14542 | acc=0.9794 | tpr=0.9581 | fpr=0.0202 | 8232.7 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.14771 | acc=0.9790 | tpr=0.9593 | fpr=0.0206 | 7910.4 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.14950 | acc=0.9789 | tpr=0.9606 | fpr=0.0208 | 8205.3 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.15145 | acc=0.9787 | tpr=0.9562 | fpr=0.0209 | 8064.9 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.15478 | acc=0.9783 | tpr=0.9552 | fpr=0.0213 | 8005.4 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.15404 | acc=0.9783 | tpr=0.9537 | fpr=0.0212 | 8359.0 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.15262 | acc=0.9784 | tpr=0.9503 | fpr=0.0211 | 13779.4 samples/s | 53.8 steps/s
Avg test loss: 0.15226, Avg test acc: 0.97844, Avg tpr: 0.95008, Avg fpr: 0.02104, total FA: 2922

server round 19/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=38001 Epoch=74.1] | Loss=0.03133 | Reg=0.00172 | acc=0.9688 | L2-Norm=13.100 | L2-Norm(final)=14.167 | 4076.8 samples/s | 63.7 steps/s
[Step=38050 Epoch=74.2] | Loss=0.02165 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.102 | L2-Norm(final)=14.173 | 4814.5 samples/s | 75.2 steps/s
[Step=38100 Epoch=74.3] | Loss=0.02223 | Reg=0.00172 | acc=0.9375 | L2-Norm=13.102 | L2-Norm(final)=14.178 | 5437.3 samples/s | 85.0 steps/s
[Step=38150 Epoch=74.4] | Loss=0.02140 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.102 | L2-Norm(final)=14.186 | 5431.0 samples/s | 84.9 steps/s
[Step=38200 Epoch=74.5] | Loss=0.01999 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.102 | L2-Norm(final)=14.194 | 5500.9 samples/s | 86.0 steps/s
[Step=38250 Epoch=74.6] | Loss=0.01913 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.102 | L2-Norm(final)=14.203 | 5452.9 samples/s | 85.2 steps/s
[Step=38300 Epoch=74.7] | Loss=0.01947 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.102 | L2-Norm(final)=14.212 | 5511.2 samples/s | 86.1 steps/s
[Step=38350 Epoch=74.8] | Loss=0.01961 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.102 | L2-Norm(final)=14.219 | 5484.3 samples/s | 85.7 steps/s
[Step=38400 Epoch=74.9] | Loss=0.01908 | Reg=0.00172 | acc=0.9688 | L2-Norm=13.102 | L2-Norm(final)=14.227 | 5500.9 samples/s | 86.0 steps/s
[Step=38450 Epoch=75.0] | Loss=0.01897 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.102 | L2-Norm(final)=14.234 | 5522.2 samples/s | 86.3 steps/s
[Step=38500 Epoch=75.1] | Loss=0.01880 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.102 | L2-Norm(final)=14.242 | 6712.9 samples/s | 104.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=38501 Epoch=75.1] | Loss=0.00857 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.102 | L2-Norm(final)=14.326 | 4034.9 samples/s | 63.0 steps/s
[Step=38550 Epoch=75.2] | Loss=0.01568 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.156 | L2-Norm(final)=14.331 | 4690.6 samples/s | 73.3 steps/s
[Step=38600 Epoch=75.3] | Loss=0.01591 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.197 | L2-Norm(final)=14.331 | 4777.1 samples/s | 74.6 steps/s
[Step=38650 Epoch=75.4] | Loss=0.01704 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.229 | L2-Norm(final)=14.331 | 4769.5 samples/s | 74.5 steps/s
[Step=38700 Epoch=75.5] | Loss=0.01693 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.254 | L2-Norm(final)=14.331 | 4751.5 samples/s | 74.2 steps/s
[Step=38750 Epoch=75.6] | Loss=0.01681 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.275 | L2-Norm(final)=14.330 | 4679.3 samples/s | 73.1 steps/s
[Step=38800 Epoch=75.7] | Loss=0.01706 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.295 | L2-Norm(final)=14.330 | 4671.9 samples/s | 73.0 steps/s
[Step=38850 Epoch=75.8] | Loss=0.01682 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.314 | L2-Norm(final)=14.329 | 4789.2 samples/s | 74.8 steps/s
[Step=38900 Epoch=75.9] | Loss=0.01669 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.332 | L2-Norm(final)=14.329 | 4708.7 samples/s | 73.6 steps/s
[Step=38950 Epoch=76.0] | Loss=0.01729 | Reg=0.00178 | acc=0.9531 | L2-Norm=13.350 | L2-Norm(final)=14.328 | 4562.4 samples/s | 71.3 steps/s
[Step=39000 Epoch=76.1] | Loss=0.01715 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.367 | L2-Norm(final)=14.327 | 5591.1 samples/s | 87.4 steps/s
[Step=39050 Epoch=76.2] | Loss=0.01659 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.384 | L2-Norm(final)=14.326 | 1898.0 samples/s | 29.7 steps/s
[Step=39100 Epoch=76.3] | Loss=0.01651 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.400 | L2-Norm(final)=14.326 | 4641.4 samples/s | 72.5 steps/s
[Step=39150 Epoch=76.4] | Loss=0.01601 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.414 | L2-Norm(final)=14.326 | 4608.8 samples/s | 72.0 steps/s
[Step=39200 Epoch=76.5] | Loss=0.01585 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.428 | L2-Norm(final)=14.326 | 4570.2 samples/s | 71.4 steps/s
[Step=39250 Epoch=76.6] | Loss=0.01587 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.442 | L2-Norm(final)=14.325 | 4600.8 samples/s | 71.9 steps/s
[Step=39300 Epoch=76.7] | Loss=0.01555 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.454 | L2-Norm(final)=14.324 | 4637.2 samples/s | 72.5 steps/s
[Step=39350 Epoch=76.7] | Loss=0.01561 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.467 | L2-Norm(final)=14.324 | 4716.9 samples/s | 73.7 steps/s
[Step=39400 Epoch=76.8] | Loss=0.01542 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=14.324 | 4590.4 samples/s | 71.7 steps/s
[Step=39450 Epoch=76.9] | Loss=0.01515 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.491 | L2-Norm(final)=14.324 | 4632.0 samples/s | 72.4 steps/s
[Step=39500 Epoch=77.0] | Loss=0.01524 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.502 | L2-Norm(final)=14.324 | 4923.1 samples/s | 76.9 steps/s
[Step=39550 Epoch=77.1] | Loss=0.01498 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.513 | L2-Norm(final)=14.324 | 2025.7 samples/s | 31.7 steps/s
[Step=39600 Epoch=77.2] | Loss=0.01460 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.523 | L2-Norm(final)=14.324 | 4643.5 samples/s | 72.6 steps/s
[Step=39650 Epoch=77.3] | Loss=0.01442 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.533 | L2-Norm(final)=14.324 | 4613.4 samples/s | 72.1 steps/s
[Step=39700 Epoch=77.4] | Loss=0.01427 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.542 | L2-Norm(final)=14.324 | 4596.3 samples/s | 71.8 steps/s
[Step=39750 Epoch=77.5] | Loss=0.01414 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.551 | L2-Norm(final)=14.324 | 4578.4 samples/s | 71.5 steps/s
[Step=39800 Epoch=77.6] | Loss=0.01404 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.559 | L2-Norm(final)=14.324 | 4683.7 samples/s | 73.2 steps/s
[Step=39850 Epoch=77.7] | Loss=0.01389 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.567 | L2-Norm(final)=14.325 | 4680.1 samples/s | 73.1 steps/s
[Step=39900 Epoch=77.8] | Loss=0.01377 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.575 | L2-Norm(final)=14.325 | 4649.8 samples/s | 72.7 steps/s
[Step=39950 Epoch=77.9] | Loss=0.01369 | Reg=0.00185 | acc=0.9531 | L2-Norm=13.583 | L2-Norm(final)=14.325 | 4608.5 samples/s | 72.0 steps/s
[Step=40000 Epoch=78.0] | Loss=0.01359 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.590 | L2-Norm(final)=14.326 | 4612.3 samples/s | 72.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step40000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=38001 Epoch=74.3] | Loss=0.02111 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.100 | L2-Norm(final)=14.568 | 3991.5 samples/s | 62.4 steps/s
[Step=38050 Epoch=74.4] | Loss=0.01862 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=14.585 | 5516.5 samples/s | 86.2 steps/s
[Step=38100 Epoch=74.5] | Loss=0.01783 | Reg=0.00172 | acc=0.9531 | L2-Norm=13.105 | L2-Norm(final)=14.601 | 5529.3 samples/s | 86.4 steps/s
[Step=38150 Epoch=74.6] | Loss=0.01757 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.105 | L2-Norm(final)=14.619 | 5449.6 samples/s | 85.2 steps/s
[Step=38200 Epoch=74.7] | Loss=0.01677 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.105 | L2-Norm(final)=14.636 | 5573.9 samples/s | 87.1 steps/s
[Step=38250 Epoch=74.8] | Loss=0.01669 | Reg=0.00172 | acc=0.9531 | L2-Norm=13.105 | L2-Norm(final)=14.654 | 5519.1 samples/s | 86.2 steps/s
[Step=38300 Epoch=74.9] | Loss=0.01645 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.105 | L2-Norm(final)=14.671 | 5175.6 samples/s | 80.9 steps/s
[Step=38350 Epoch=75.0] | Loss=0.01674 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.105 | L2-Norm(final)=14.687 | 5519.3 samples/s | 86.2 steps/s
[Step=38400 Epoch=75.1] | Loss=0.01681 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.105 | L2-Norm(final)=14.704 | 5573.7 samples/s | 87.1 steps/s
[Step=38450 Epoch=75.2] | Loss=0.01677 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.105 | L2-Norm(final)=14.720 | 5694.1 samples/s | 89.0 steps/s
[Step=38500 Epoch=75.3] | Loss=0.01686 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.106 | L2-Norm(final)=14.735 | 7161.8 samples/s | 111.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=38501 Epoch=75.3] | Loss=0.00619 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.106 | L2-Norm(final)=14.889 | 4384.2 samples/s | 68.5 steps/s
[Step=38550 Epoch=75.4] | Loss=0.01612 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.157 | L2-Norm(final)=14.897 | 4594.2 samples/s | 71.8 steps/s
[Step=38600 Epoch=75.5] | Loss=0.01692 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.203 | L2-Norm(final)=14.891 | 4735.1 samples/s | 74.0 steps/s
[Step=38650 Epoch=75.6] | Loss=0.01669 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.235 | L2-Norm(final)=14.887 | 4665.6 samples/s | 72.9 steps/s
[Step=38700 Epoch=75.7] | Loss=0.01628 | Reg=0.00176 | acc=0.9531 | L2-Norm=13.259 | L2-Norm(final)=14.882 | 4562.9 samples/s | 71.3 steps/s
[Step=38750 Epoch=75.8] | Loss=0.01648 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.281 | L2-Norm(final)=14.879 | 4584.7 samples/s | 71.6 steps/s
[Step=38800 Epoch=75.9] | Loss=0.01629 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.300 | L2-Norm(final)=14.878 | 4676.5 samples/s | 73.1 steps/s
[Step=38850 Epoch=76.0] | Loss=0.01624 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.319 | L2-Norm(final)=14.877 | 4620.3 samples/s | 72.2 steps/s
[Step=38900 Epoch=76.0] | Loss=0.01611 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.336 | L2-Norm(final)=14.876 | 4629.5 samples/s | 72.3 steps/s
[Step=38950 Epoch=76.1] | Loss=0.01633 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=14.875 | 4722.9 samples/s | 73.8 steps/s
[Step=39000 Epoch=76.2] | Loss=0.01683 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.371 | L2-Norm(final)=14.873 | 5745.6 samples/s | 89.8 steps/s
[Step=39050 Epoch=76.3] | Loss=0.01679 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.389 | L2-Norm(final)=14.870 | 1991.5 samples/s | 31.1 steps/s
[Step=39100 Epoch=76.4] | Loss=0.01645 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.406 | L2-Norm(final)=14.868 | 4689.8 samples/s | 73.3 steps/s
[Step=39150 Epoch=76.5] | Loss=0.01607 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.422 | L2-Norm(final)=14.866 | 4601.8 samples/s | 71.9 steps/s
[Step=39200 Epoch=76.6] | Loss=0.01568 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.437 | L2-Norm(final)=14.865 | 4692.5 samples/s | 73.3 steps/s
[Step=39250 Epoch=76.7] | Loss=0.01559 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.451 | L2-Norm(final)=14.864 | 4781.9 samples/s | 74.7 steps/s
[Step=39300 Epoch=76.8] | Loss=0.01537 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.464 | L2-Norm(final)=14.863 | 4737.7 samples/s | 74.0 steps/s
[Step=39350 Epoch=76.9] | Loss=0.01523 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.477 | L2-Norm(final)=14.863 | 4683.8 samples/s | 73.2 steps/s
[Step=39400 Epoch=77.0] | Loss=0.01503 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.489 | L2-Norm(final)=14.862 | 4634.5 samples/s | 72.4 steps/s
[Step=39450 Epoch=77.1] | Loss=0.01497 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.501 | L2-Norm(final)=14.862 | 4648.1 samples/s | 72.6 steps/s
[Step=39500 Epoch=77.2] | Loss=0.01487 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.512 | L2-Norm(final)=14.861 | 4902.5 samples/s | 76.6 steps/s
[Step=39550 Epoch=77.3] | Loss=0.01458 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.523 | L2-Norm(final)=14.860 | 2033.4 samples/s | 31.8 steps/s
[Step=39600 Epoch=77.4] | Loss=0.01442 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.534 | L2-Norm(final)=14.860 | 4701.9 samples/s | 73.5 steps/s
[Step=39650 Epoch=77.5] | Loss=0.01433 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.545 | L2-Norm(final)=14.860 | 4755.1 samples/s | 74.3 steps/s
[Step=39700 Epoch=77.6] | Loss=0.01424 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.556 | L2-Norm(final)=14.859 | 4932.2 samples/s | 77.1 steps/s
[Step=39750 Epoch=77.7] | Loss=0.01409 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.566 | L2-Norm(final)=14.859 | 4636.8 samples/s | 72.4 steps/s
[Step=39800 Epoch=77.8] | Loss=0.01395 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.576 | L2-Norm(final)=14.859 | 4722.5 samples/s | 73.8 steps/s
[Step=39850 Epoch=77.9] | Loss=0.01386 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.586 | L2-Norm(final)=14.859 | 4657.6 samples/s | 72.8 steps/s
[Step=39900 Epoch=78.0] | Loss=0.01372 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.595 | L2-Norm(final)=14.858 | 4787.1 samples/s | 74.8 steps/s
[Step=39950 Epoch=78.1] | Loss=0.01376 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.605 | L2-Norm(final)=14.858 | 4707.4 samples/s | 73.6 steps/s
[Step=40000 Epoch=78.2] | Loss=0.01366 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=14.858 | 4717.5 samples/s | 73.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step40000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=38001 Epoch=145.6] | Loss=0.00009 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.100 | L2-Norm(final)=16.203 | 4101.5 samples/s | 64.1 steps/s
[Step=38050 Epoch=145.8] | Loss=0.00077 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.094 | L2-Norm(final)=16.217 | 4804.5 samples/s | 75.1 steps/s
[Step=38100 Epoch=146.0] | Loss=0.00048 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.094 | L2-Norm(final)=16.227 | 4952.4 samples/s | 77.4 steps/s
[Step=38150 Epoch=146.2] | Loss=0.00043 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.094 | L2-Norm(final)=16.241 | 4960.8 samples/s | 77.5 steps/s
[Step=38200 Epoch=146.4] | Loss=0.00038 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.093 | L2-Norm(final)=16.256 | 5095.3 samples/s | 79.6 steps/s
[Step=38250 Epoch=146.6] | Loss=0.00034 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.093 | L2-Norm(final)=16.270 | 6802.3 samples/s | 106.3 steps/s
[Step=38300 Epoch=146.8] | Loss=0.00031 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.093 | L2-Norm(final)=16.284 | 2052.1 samples/s | 32.1 steps/s
[Step=38350 Epoch=146.9] | Loss=0.00029 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.093 | L2-Norm(final)=16.298 | 5204.2 samples/s | 81.3 steps/s
[Step=38400 Epoch=147.1] | Loss=0.00029 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.093 | L2-Norm(final)=16.312 | 4938.6 samples/s | 77.2 steps/s
[Step=38450 Epoch=147.3] | Loss=0.00029 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.093 | L2-Norm(final)=16.325 | 5124.2 samples/s | 80.1 steps/s
[Step=38500 Epoch=147.5] | Loss=0.00027 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.093 | L2-Norm(final)=16.337 | 5720.4 samples/s | 89.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=38501 Epoch=147.5] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.093 | L2-Norm(final)=16.461 | 4441.8 samples/s | 69.4 steps/s
[Step=38550 Epoch=147.7] | Loss=0.00636 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.174 | L2-Norm(final)=16.454 | 3972.7 samples/s | 62.1 steps/s
[Step=38600 Epoch=147.9] | Loss=0.01212 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=16.422 | 4404.9 samples/s | 68.8 steps/s
[Step=38650 Epoch=148.1] | Loss=0.00921 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.451 | L2-Norm(final)=16.392 | 4309.6 samples/s | 67.3 steps/s
[Step=38700 Epoch=148.3] | Loss=0.00741 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.508 | L2-Norm(final)=16.375 | 4412.5 samples/s | 68.9 steps/s
[Step=38750 Epoch=148.5] | Loss=0.00639 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.542 | L2-Norm(final)=16.364 | 5424.3 samples/s | 84.8 steps/s
[Step=38800 Epoch=148.7] | Loss=0.00536 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.566 | L2-Norm(final)=16.357 | 1893.2 samples/s | 29.6 steps/s
[Step=38850 Epoch=148.9] | Loss=0.00470 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.581 | L2-Norm(final)=16.352 | 4307.5 samples/s | 67.3 steps/s
[Step=38900 Epoch=149.1] | Loss=0.00411 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.591 | L2-Norm(final)=16.349 | 4373.5 samples/s | 68.3 steps/s
[Step=38950 Epoch=149.2] | Loss=0.00366 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.597 | L2-Norm(final)=16.347 | 4427.2 samples/s | 69.2 steps/s
[Step=39000 Epoch=149.4] | Loss=0.00329 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.601 | L2-Norm(final)=16.345 | 4896.9 samples/s | 76.5 steps/s
[Step=39050 Epoch=149.6] | Loss=0.00299 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.602 | L2-Norm(final)=16.344 | 2000.1 samples/s | 31.3 steps/s
[Step=39100 Epoch=149.8] | Loss=0.00274 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.602 | L2-Norm(final)=16.343 | 4486.8 samples/s | 70.1 steps/s
[Step=39150 Epoch=150.0] | Loss=0.00253 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.600 | L2-Norm(final)=16.343 | 4379.2 samples/s | 68.4 steps/s
[Step=39200 Epoch=150.2] | Loss=0.00235 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.598 | L2-Norm(final)=16.342 | 4396.1 samples/s | 68.7 steps/s
[Step=39250 Epoch=150.4] | Loss=0.00220 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.596 | L2-Norm(final)=16.343 | 4418.3 samples/s | 69.0 steps/s
[Step=39300 Epoch=150.6] | Loss=0.00206 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.592 | L2-Norm(final)=16.343 | 2096.9 samples/s | 32.8 steps/s
[Step=39350 Epoch=150.8] | Loss=0.00194 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.588 | L2-Norm(final)=16.344 | 4607.7 samples/s | 72.0 steps/s
[Step=39400 Epoch=151.0] | Loss=0.00183 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.584 | L2-Norm(final)=16.345 | 4463.4 samples/s | 69.7 steps/s
[Step=39450 Epoch=151.2] | Loss=0.00173 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.580 | L2-Norm(final)=16.346 | 4407.6 samples/s | 68.9 steps/s
[Step=39500 Epoch=151.4] | Loss=0.00165 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.575 | L2-Norm(final)=16.347 | 4569.9 samples/s | 71.4 steps/s
[Step=39550 Epoch=151.5] | Loss=0.00157 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.570 | L2-Norm(final)=16.348 | 2169.1 samples/s | 33.9 steps/s
[Step=39600 Epoch=151.7] | Loss=0.00150 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.565 | L2-Norm(final)=16.349 | 4635.1 samples/s | 72.4 steps/s
[Step=39650 Epoch=151.9] | Loss=0.00143 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.560 | L2-Norm(final)=16.350 | 4441.7 samples/s | 69.4 steps/s
[Step=39700 Epoch=152.1] | Loss=0.00137 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.554 | L2-Norm(final)=16.351 | 4325.0 samples/s | 67.6 steps/s
[Step=39750 Epoch=152.3] | Loss=0.00132 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.549 | L2-Norm(final)=16.353 | 4337.4 samples/s | 67.8 steps/s
[Step=39800 Epoch=152.5] | Loss=0.00127 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.543 | L2-Norm(final)=16.354 | 5988.7 samples/s | 93.6 steps/s
[Step=39850 Epoch=152.7] | Loss=0.00122 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.537 | L2-Norm(final)=16.355 | 1821.2 samples/s | 28.5 steps/s
[Step=39900 Epoch=152.9] | Loss=0.00118 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.532 | L2-Norm(final)=16.357 | 4430.1 samples/s | 69.2 steps/s
[Step=39950 Epoch=153.1] | Loss=0.00114 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.526 | L2-Norm(final)=16.358 | 4592.2 samples/s | 71.8 steps/s
[Step=40000 Epoch=153.3] | Loss=0.00110 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.520 | L2-Norm(final)=16.360 | 4504.3 samples/s | 70.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step40000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=38001 Epoch=146.3] | Loss=0.00001 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.100 | L2-Norm(final)=15.860 | 4280.6 samples/s | 66.9 steps/s
[Step=38050 Epoch=146.5] | Loss=0.00012 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.098 | L2-Norm(final)=15.862 | 4940.1 samples/s | 77.2 steps/s
[Step=38100 Epoch=146.7] | Loss=0.00025 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.098 | L2-Norm(final)=15.866 | 5371.6 samples/s | 83.9 steps/s
[Step=38150 Epoch=146.9] | Loss=0.00021 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.098 | L2-Norm(final)=15.871 | 5270.0 samples/s | 82.3 steps/s
[Step=38200 Epoch=147.0] | Loss=0.00022 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.098 | L2-Norm(final)=15.876 | 5388.2 samples/s | 84.2 steps/s
[Step=38250 Epoch=147.2] | Loss=0.00031 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.098 | L2-Norm(final)=15.881 | 6842.4 samples/s | 106.9 steps/s
[Step=38300 Epoch=147.4] | Loss=0.00030 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.097 | L2-Norm(final)=15.887 | 2063.6 samples/s | 32.2 steps/s
[Step=38350 Epoch=147.6] | Loss=0.00030 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.097 | L2-Norm(final)=15.894 | 5364.6 samples/s | 83.8 steps/s
[Step=38400 Epoch=147.8] | Loss=0.00031 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.097 | L2-Norm(final)=15.900 | 4976.6 samples/s | 77.8 steps/s
[Step=38450 Epoch=148.0] | Loss=0.00032 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.097 | L2-Norm(final)=15.906 | 5022.6 samples/s | 78.5 steps/s
[Step=38500 Epoch=148.2] | Loss=0.00031 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.097 | L2-Norm(final)=15.912 | 6122.8 samples/s | 95.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=38501 Epoch=148.2] | Loss=0.00003 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.097 | L2-Norm(final)=15.971 | 4116.2 samples/s | 64.3 steps/s
[Step=38550 Epoch=148.4] | Loss=0.00025 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.101 | L2-Norm(final)=15.974 | 4401.6 samples/s | 68.8 steps/s
[Step=38600 Epoch=148.6] | Loss=0.00013 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.106 | L2-Norm(final)=15.976 | 4579.1 samples/s | 71.5 steps/s
[Step=38650 Epoch=148.8] | Loss=0.00010 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.100 | L2-Norm(final)=15.978 | 4632.5 samples/s | 72.4 steps/s
[Step=38700 Epoch=149.0] | Loss=0.00008 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.093 | L2-Norm(final)=15.981 | 4591.5 samples/s | 71.7 steps/s
[Step=38750 Epoch=149.2] | Loss=0.00007 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.084 | L2-Norm(final)=15.983 | 5778.8 samples/s | 90.3 steps/s
[Step=38800 Epoch=149.4] | Loss=0.00006 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.074 | L2-Norm(final)=15.985 | 1913.7 samples/s | 29.9 steps/s
[Step=38850 Epoch=149.5] | Loss=0.00005 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.063 | L2-Norm(final)=15.987 | 4470.3 samples/s | 69.8 steps/s
[Step=38900 Epoch=149.7] | Loss=0.00004 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.052 | L2-Norm(final)=15.988 | 4578.0 samples/s | 71.5 steps/s
[Step=38950 Epoch=149.9] | Loss=0.00004 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.041 | L2-Norm(final)=15.989 | 4439.4 samples/s | 69.4 steps/s
[Step=39000 Epoch=150.1] | Loss=0.00004 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.030 | L2-Norm(final)=15.991 | 5142.4 samples/s | 80.3 steps/s
[Step=39050 Epoch=150.3] | Loss=0.00003 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.020 | L2-Norm(final)=15.992 | 2014.7 samples/s | 31.5 steps/s
[Step=39100 Epoch=150.5] | Loss=0.00003 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.009 | L2-Norm(final)=15.993 | 4540.0 samples/s | 70.9 steps/s
[Step=39150 Epoch=150.7] | Loss=0.00003 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.998 | L2-Norm(final)=15.994 | 4550.6 samples/s | 71.1 steps/s
[Step=39200 Epoch=150.9] | Loss=0.00003 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.987 | L2-Norm(final)=15.995 | 4479.4 samples/s | 70.0 steps/s
[Step=39250 Epoch=151.1] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.976 | L2-Norm(final)=15.995 | 4438.1 samples/s | 69.3 steps/s
[Step=39300 Epoch=151.3] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.966 | L2-Norm(final)=15.996 | 1393.3 samples/s | 21.8 steps/s
[Step=39350 Epoch=151.5] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.955 | L2-Norm(final)=15.997 | 3933.9 samples/s | 61.5 steps/s
[Step=39400 Epoch=151.7] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.944 | L2-Norm(final)=15.998 | 4334.8 samples/s | 67.7 steps/s
[Step=39450 Epoch=151.9] | Loss=0.00002 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.934 | L2-Norm(final)=15.999 | 4391.4 samples/s | 68.6 steps/s
[Step=39500 Epoch=152.1] | Loss=0.00002 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.923 | L2-Norm(final)=15.999 | 4339.6 samples/s | 67.8 steps/s
[Step=39550 Epoch=152.2] | Loss=0.00002 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.912 | L2-Norm(final)=16.000 | 2137.9 samples/s | 33.4 steps/s
[Step=39600 Epoch=152.4] | Loss=0.00002 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.902 | L2-Norm(final)=16.001 | 4613.6 samples/s | 72.1 steps/s
[Step=39650 Epoch=152.6] | Loss=0.00002 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.891 | L2-Norm(final)=16.002 | 4660.6 samples/s | 72.8 steps/s
[Step=39700 Epoch=152.8] | Loss=0.00002 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.880 | L2-Norm(final)=16.003 | 4654.3 samples/s | 72.7 steps/s
[Step=39750 Epoch=153.0] | Loss=0.00002 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.869 | L2-Norm(final)=16.004 | 4451.6 samples/s | 69.6 steps/s
[Step=39800 Epoch=153.2] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.858 | L2-Norm(final)=16.005 | 6633.0 samples/s | 103.6 steps/s
[Step=39850 Epoch=153.4] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.847 | L2-Norm(final)=16.005 | 1875.8 samples/s | 29.3 steps/s
[Step=39900 Epoch=153.6] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.836 | L2-Norm(final)=16.006 | 4545.3 samples/s | 71.0 steps/s
[Step=39950 Epoch=153.8] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.825 | L2-Norm(final)=16.007 | 4506.9 samples/s | 70.4 steps/s
[Step=40000 Epoch=154.0] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.814 | L2-Norm(final)=16.008 | 4517.9 samples/s | 70.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08002 | acc=0.9680 | tpr=0.9724 | fpr=0.0414 | 4523.1 samples/s | 17.7 steps/s
Avg test loss: 0.07809, Avg test acc: 0.96831, Avg tpr: 0.97319, Avg fpr: 0.04243, total FA: 331

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07394 | acc=0.9683 | tpr=0.9750 | fpr=0.0463 | 4518.0 samples/s | 17.6 steps/s
Avg test loss: 0.07230, Avg test acc: 0.96807, Avg tpr: 0.97418, Avg fpr: 0.04538, total FA: 354

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.70270 | acc=0.3149 | tpr=0.0080 | fpr=0.0186 | 4446.3 samples/s | 17.4 steps/s
Avg test loss: 7.72277, Avg test acc: 0.31257, Avg tpr: 0.00822, Avg fpr: 0.01807, total FA: 141

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.83193 | acc=0.3058 | tpr=0.0128 | fpr=0.0580 | 4391.1 samples/s | 17.2 steps/s
Avg test loss: 5.84526, Avg test acc: 0.30299, Avg tpr: 0.01381, Avg fpr: 0.06102, total FA: 476

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.11627 | acc=0.1147 | tpr=0.7389 | fpr=0.8965 | 4573.7 samples/s | 17.9 steps/s
[Step= 100] | Loss=7.05381 | acc=0.1148 | tpr=0.7122 | fpr=0.8963 | 8123.9 samples/s | 31.7 steps/s
[Step= 150] | Loss=7.07409 | acc=0.1136 | tpr=0.7190 | fpr=0.8975 | 8539.5 samples/s | 33.4 steps/s
[Step= 200] | Loss=7.06822 | acc=0.1136 | tpr=0.6962 | fpr=0.8970 | 8486.6 samples/s | 33.2 steps/s
[Step= 250] | Loss=7.07645 | acc=0.1134 | tpr=0.6987 | fpr=0.8973 | 8307.4 samples/s | 32.5 steps/s
[Step= 300] | Loss=7.07155 | acc=0.1132 | tpr=0.7025 | fpr=0.8976 | 8327.3 samples/s | 32.5 steps/s
[Step= 350] | Loss=7.07320 | acc=0.1123 | tpr=0.7013 | fpr=0.8984 | 8648.9 samples/s | 33.8 steps/s
[Step= 400] | Loss=7.07816 | acc=0.1123 | tpr=0.7008 | fpr=0.8984 | 8425.6 samples/s | 32.9 steps/s
[Step= 450] | Loss=7.08172 | acc=0.1124 | tpr=0.7016 | fpr=0.8983 | 8718.2 samples/s | 34.1 steps/s
[Step= 500] | Loss=7.08121 | acc=0.1123 | tpr=0.7018 | fpr=0.8984 | 8364.9 samples/s | 32.7 steps/s
[Step= 550] | Loss=7.08814 | acc=0.1119 | tpr=0.6972 | fpr=0.8987 | 15321.2 samples/s | 59.8 steps/s
Avg test loss: 7.08829, Avg test acc: 0.11185, Avg tpr: 0.69731, Avg fpr: 0.89879, total FA: 124795

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.51410 | acc=0.1180 | tpr=0.7301 | fpr=0.8930 | 4503.0 samples/s | 17.6 steps/s
[Step= 100] | Loss=7.45075 | acc=0.1171 | tpr=0.7164 | fpr=0.8941 | 8151.2 samples/s | 31.8 steps/s
[Step= 150] | Loss=7.45357 | acc=0.1163 | tpr=0.7248 | fpr=0.8949 | 8486.7 samples/s | 33.2 steps/s
[Step= 200] | Loss=7.44068 | acc=0.1155 | tpr=0.7137 | fpr=0.8954 | 8523.0 samples/s | 33.3 steps/s
[Step= 250] | Loss=7.45412 | acc=0.1152 | tpr=0.7170 | fpr=0.8958 | 8534.4 samples/s | 33.3 steps/s
[Step= 300] | Loss=7.44874 | acc=0.1150 | tpr=0.7135 | fpr=0.8959 | 8469.9 samples/s | 33.1 steps/s
[Step= 350] | Loss=7.44332 | acc=0.1143 | tpr=0.7113 | fpr=0.8966 | 8268.4 samples/s | 32.3 steps/s
[Step= 400] | Loss=7.44640 | acc=0.1145 | tpr=0.7095 | fpr=0.8964 | 8445.5 samples/s | 33.0 steps/s
[Step= 450] | Loss=7.44877 | acc=0.1144 | tpr=0.7084 | fpr=0.8964 | 8703.0 samples/s | 34.0 steps/s
[Step= 500] | Loss=7.45026 | acc=0.1144 | tpr=0.7110 | fpr=0.8964 | 8365.4 samples/s | 32.7 steps/s
[Step= 550] | Loss=7.45707 | acc=0.1142 | tpr=0.7079 | fpr=0.8966 | 14619.8 samples/s | 57.1 steps/s
Avg test loss: 7.45755, Avg test acc: 0.11405, Avg tpr: 0.70800, Avg fpr: 0.89674, total FA: 124511

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11705 | acc=0.9834 | tpr=0.9469 | fpr=0.0159 | 4515.4 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.12381 | acc=0.9827 | tpr=0.9638 | fpr=0.0170 | 8703.4 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.12978 | acc=0.9821 | tpr=0.9640 | fpr=0.0176 | 8003.2 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.12971 | acc=0.9825 | tpr=0.9672 | fpr=0.0172 | 8494.9 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.12871 | acc=0.9823 | tpr=0.9633 | fpr=0.0173 | 8254.7 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.12981 | acc=0.9822 | tpr=0.9622 | fpr=0.0174 | 8421.0 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.13086 | acc=0.9820 | tpr=0.9618 | fpr=0.0176 | 8555.9 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.13252 | acc=0.9819 | tpr=0.9601 | fpr=0.0177 | 8555.3 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.13470 | acc=0.9816 | tpr=0.9572 | fpr=0.0180 | 8194.6 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.13481 | acc=0.9816 | tpr=0.9573 | fpr=0.0179 | 8269.8 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.13339 | acc=0.9817 | tpr=0.9546 | fpr=0.0178 | 15292.2 samples/s | 59.7 steps/s
Avg test loss: 0.13309, Avg test acc: 0.98175, Avg tpr: 0.95444, Avg fpr: 0.01775, total FA: 2465

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12261 | acc=0.9830 | tpr=0.9469 | fpr=0.0164 | 4436.3 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.13380 | acc=0.9821 | tpr=0.9595 | fpr=0.0174 | 8267.3 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.13907 | acc=0.9812 | tpr=0.9640 | fpr=0.0185 | 8619.4 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.13930 | acc=0.9811 | tpr=0.9661 | fpr=0.0187 | 8311.2 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.13771 | acc=0.9811 | tpr=0.9651 | fpr=0.0186 | 8954.1 samples/s | 35.0 steps/s
[Step= 300] | Loss=0.13910 | acc=0.9810 | tpr=0.9658 | fpr=0.0187 | 7925.3 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.14099 | acc=0.9807 | tpr=0.9637 | fpr=0.0190 | 8279.5 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.14294 | acc=0.9804 | tpr=0.9606 | fpr=0.0192 | 8443.3 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.14538 | acc=0.9801 | tpr=0.9606 | fpr=0.0195 | 8472.0 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.14502 | acc=0.9801 | tpr=0.9608 | fpr=0.0195 | 8592.5 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.14384 | acc=0.9802 | tpr=0.9582 | fpr=0.0194 | 14025.3 samples/s | 54.8 steps/s
Avg test loss: 0.14353, Avg test acc: 0.98021, Avg tpr: 0.95840, Avg fpr: 0.01940, total FA: 2693

server round 20/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=40001 Epoch=78.0] | Loss=0.03031 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.084 | L2-Norm(final)=14.340 | 4295.0 samples/s | 67.1 steps/s
[Step=40050 Epoch=78.1] | Loss=0.01409 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.085 | L2-Norm(final)=14.347 | 5335.3 samples/s | 83.4 steps/s
[Step=40100 Epoch=78.2] | Loss=0.01489 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.085 | L2-Norm(final)=14.357 | 5387.2 samples/s | 84.2 steps/s
[Step=40150 Epoch=78.3] | Loss=0.01437 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.085 | L2-Norm(final)=14.367 | 5433.8 samples/s | 84.9 steps/s
[Step=40200 Epoch=78.4] | Loss=0.01514 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.085 | L2-Norm(final)=14.376 | 5436.1 samples/s | 84.9 steps/s
[Step=40250 Epoch=78.5] | Loss=0.01540 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.085 | L2-Norm(final)=14.384 | 5520.5 samples/s | 86.3 steps/s
[Step=40300 Epoch=78.6] | Loss=0.01536 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.085 | L2-Norm(final)=14.392 | 5588.3 samples/s | 87.3 steps/s
[Step=40350 Epoch=78.7] | Loss=0.01524 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.085 | L2-Norm(final)=14.402 | 5508.5 samples/s | 86.1 steps/s
[Step=40400 Epoch=78.8] | Loss=0.01503 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.085 | L2-Norm(final)=14.411 | 5447.4 samples/s | 85.1 steps/s
[Step=40450 Epoch=78.9] | Loss=0.01499 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.085 | L2-Norm(final)=14.421 | 5408.8 samples/s | 84.5 steps/s
[Step=40500 Epoch=79.0] | Loss=0.01477 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.085 | L2-Norm(final)=14.431 | 6931.5 samples/s | 108.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=40501 Epoch=79.0] | Loss=0.02093 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.085 | L2-Norm(final)=14.526 | 4108.1 samples/s | 64.2 steps/s
[Step=40550 Epoch=79.1] | Loss=0.01223 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.105 | L2-Norm(final)=14.531 | 4605.2 samples/s | 72.0 steps/s
[Step=40600 Epoch=79.2] | Loss=0.01195 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.119 | L2-Norm(final)=14.533 | 4801.3 samples/s | 75.0 steps/s
[Step=40650 Epoch=79.3] | Loss=0.01238 | Reg=0.00172 | acc=0.9219 | L2-Norm=13.129 | L2-Norm(final)=14.535 | 4810.1 samples/s | 75.2 steps/s
[Step=40700 Epoch=79.4] | Loss=0.01201 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.136 | L2-Norm(final)=14.535 | 4719.7 samples/s | 73.7 steps/s
[Step=40750 Epoch=79.5] | Loss=0.01196 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.142 | L2-Norm(final)=14.535 | 4747.0 samples/s | 74.2 steps/s
[Step=40800 Epoch=79.6] | Loss=0.01201 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.147 | L2-Norm(final)=14.534 | 4758.2 samples/s | 74.3 steps/s
[Step=40850 Epoch=79.7] | Loss=0.01141 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.151 | L2-Norm(final)=14.534 | 4822.6 samples/s | 75.4 steps/s
[Step=40900 Epoch=79.8] | Loss=0.01141 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.156 | L2-Norm(final)=14.534 | 4797.9 samples/s | 75.0 steps/s
[Step=40950 Epoch=79.9] | Loss=0.01127 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.160 | L2-Norm(final)=14.534 | 4777.8 samples/s | 74.7 steps/s
[Step=41000 Epoch=80.0] | Loss=0.01094 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.163 | L2-Norm(final)=14.535 | 5764.0 samples/s | 90.1 steps/s
[Step=41050 Epoch=80.1] | Loss=0.01046 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.166 | L2-Norm(final)=14.535 | 1957.0 samples/s | 30.6 steps/s
[Step=41100 Epoch=80.2] | Loss=0.01006 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.170 | L2-Norm(final)=14.536 | 4742.2 samples/s | 74.1 steps/s
[Step=41150 Epoch=80.3] | Loss=0.00986 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.173 | L2-Norm(final)=14.537 | 4774.2 samples/s | 74.6 steps/s
[Step=41200 Epoch=80.4] | Loss=0.00977 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.176 | L2-Norm(final)=14.538 | 4705.5 samples/s | 73.5 steps/s
[Step=41250 Epoch=80.5] | Loss=0.00971 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.178 | L2-Norm(final)=14.538 | 4805.0 samples/s | 75.1 steps/s
[Step=41300 Epoch=80.6] | Loss=0.00954 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.181 | L2-Norm(final)=14.539 | 4857.2 samples/s | 75.9 steps/s
[Step=41350 Epoch=80.6] | Loss=0.00946 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.183 | L2-Norm(final)=14.539 | 4768.2 samples/s | 74.5 steps/s
[Step=41400 Epoch=80.7] | Loss=0.00952 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.186 | L2-Norm(final)=14.540 | 4724.4 samples/s | 73.8 steps/s
[Step=41450 Epoch=80.8] | Loss=0.00937 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.188 | L2-Norm(final)=14.540 | 4781.3 samples/s | 74.7 steps/s
[Step=41500 Epoch=80.9] | Loss=0.00943 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.191 | L2-Norm(final)=14.540 | 5067.1 samples/s | 79.2 steps/s
[Step=41550 Epoch=81.0] | Loss=0.00936 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.193 | L2-Norm(final)=14.540 | 2128.0 samples/s | 33.2 steps/s
[Step=41600 Epoch=81.1] | Loss=0.00923 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.195 | L2-Norm(final)=14.541 | 4767.9 samples/s | 74.5 steps/s
[Step=41650 Epoch=81.2] | Loss=0.00907 | Reg=0.00174 | acc=0.9688 | L2-Norm=13.197 | L2-Norm(final)=14.541 | 4845.8 samples/s | 75.7 steps/s
[Step=41700 Epoch=81.3] | Loss=0.00912 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.199 | L2-Norm(final)=14.542 | 4718.7 samples/s | 73.7 steps/s
[Step=41750 Epoch=81.4] | Loss=0.00913 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.201 | L2-Norm(final)=14.542 | 4731.5 samples/s | 73.9 steps/s
[Step=41800 Epoch=81.5] | Loss=0.00915 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.203 | L2-Norm(final)=14.543 | 4764.0 samples/s | 74.4 steps/s
[Step=41850 Epoch=81.6] | Loss=0.00902 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.205 | L2-Norm(final)=14.543 | 4763.4 samples/s | 74.4 steps/s
[Step=41900 Epoch=81.7] | Loss=0.00892 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.207 | L2-Norm(final)=14.544 | 4811.4 samples/s | 75.2 steps/s
[Step=41950 Epoch=81.8] | Loss=0.00895 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.209 | L2-Norm(final)=14.545 | 4796.5 samples/s | 74.9 steps/s
[Step=42000 Epoch=81.9] | Loss=0.00895 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.211 | L2-Norm(final)=14.545 | 4938.6 samples/s | 77.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step42000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=40001 Epoch=78.2] | Loss=0.00642 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.084 | L2-Norm(final)=14.844 | 4609.8 samples/s | 72.0 steps/s
[Step=40050 Epoch=78.3] | Loss=0.01393 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.085 | L2-Norm(final)=14.851 | 5413.3 samples/s | 84.6 steps/s
[Step=40100 Epoch=78.4] | Loss=0.01350 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.085 | L2-Norm(final)=14.860 | 5412.4 samples/s | 84.6 steps/s
[Step=40150 Epoch=78.5] | Loss=0.01451 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.085 | L2-Norm(final)=14.869 | 5605.4 samples/s | 87.6 steps/s
[Step=40200 Epoch=78.6] | Loss=0.01470 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.085 | L2-Norm(final)=14.877 | 5726.7 samples/s | 89.5 steps/s
[Step=40250 Epoch=78.7] | Loss=0.01504 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.085 | L2-Norm(final)=14.885 | 5643.0 samples/s | 88.2 steps/s
[Step=40300 Epoch=78.8] | Loss=0.01509 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.085 | L2-Norm(final)=14.893 | 5636.2 samples/s | 88.1 steps/s
[Step=40350 Epoch=78.9] | Loss=0.01520 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.085 | L2-Norm(final)=14.901 | 5498.0 samples/s | 85.9 steps/s
[Step=40400 Epoch=79.0] | Loss=0.01507 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.085 | L2-Norm(final)=14.909 | 5477.3 samples/s | 85.6 steps/s
[Step=40450 Epoch=79.1] | Loss=0.01479 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.085 | L2-Norm(final)=14.917 | 5445.1 samples/s | 85.1 steps/s
[Step=40500 Epoch=79.2] | Loss=0.01484 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.085 | L2-Norm(final)=14.925 | 7119.1 samples/s | 111.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=40501 Epoch=79.2] | Loss=0.00897 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.085 | L2-Norm(final)=15.000 | 4254.9 samples/s | 66.5 steps/s
[Step=40550 Epoch=79.3] | Loss=0.01200 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.103 | L2-Norm(final)=15.003 | 4736.2 samples/s | 74.0 steps/s
[Step=40600 Epoch=79.4] | Loss=0.01077 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.117 | L2-Norm(final)=15.006 | 4755.9 samples/s | 74.3 steps/s
[Step=40650 Epoch=79.5] | Loss=0.01068 | Reg=0.00172 | acc=0.9688 | L2-Norm=13.125 | L2-Norm(final)=15.008 | 4756.3 samples/s | 74.3 steps/s
[Step=40700 Epoch=79.6] | Loss=0.01089 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.132 | L2-Norm(final)=15.009 | 4847.2 samples/s | 75.7 steps/s
[Step=40750 Epoch=79.7] | Loss=0.01125 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.138 | L2-Norm(final)=15.010 | 4725.5 samples/s | 73.8 steps/s
[Step=40800 Epoch=79.8] | Loss=0.01147 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.143 | L2-Norm(final)=15.011 | 4782.2 samples/s | 74.7 steps/s
[Step=40850 Epoch=79.9] | Loss=0.01125 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.147 | L2-Norm(final)=15.011 | 4775.7 samples/s | 74.6 steps/s
[Step=40900 Epoch=80.0] | Loss=0.01128 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.151 | L2-Norm(final)=15.012 | 4807.4 samples/s | 75.1 steps/s
[Step=40950 Epoch=80.1] | Loss=0.01095 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.155 | L2-Norm(final)=15.013 | 4781.5 samples/s | 74.7 steps/s
[Step=41000 Epoch=80.2] | Loss=0.01086 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.158 | L2-Norm(final)=15.014 | 5810.2 samples/s | 90.8 steps/s
[Step=41050 Epoch=80.3] | Loss=0.01045 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.161 | L2-Norm(final)=15.014 | 2005.7 samples/s | 31.3 steps/s
[Step=41100 Epoch=80.3] | Loss=0.01032 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.163 | L2-Norm(final)=15.015 | 4747.3 samples/s | 74.2 steps/s
[Step=41150 Epoch=80.4] | Loss=0.01010 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.166 | L2-Norm(final)=15.016 | 4768.2 samples/s | 74.5 steps/s
[Step=41200 Epoch=80.5] | Loss=0.01009 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.168 | L2-Norm(final)=15.016 | 4739.5 samples/s | 74.1 steps/s
[Step=41250 Epoch=80.6] | Loss=0.00985 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.170 | L2-Norm(final)=15.017 | 4806.2 samples/s | 75.1 steps/s
[Step=41300 Epoch=80.7] | Loss=0.00965 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.172 | L2-Norm(final)=15.018 | 4824.5 samples/s | 75.4 steps/s
[Step=41350 Epoch=80.8] | Loss=0.00951 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.175 | L2-Norm(final)=15.019 | 4786.0 samples/s | 74.8 steps/s
[Step=41400 Epoch=80.9] | Loss=0.00937 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.177 | L2-Norm(final)=15.020 | 4812.2 samples/s | 75.2 steps/s
[Step=41450 Epoch=81.0] | Loss=0.00931 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.179 | L2-Norm(final)=15.020 | 4771.2 samples/s | 74.6 steps/s
[Step=41500 Epoch=81.1] | Loss=0.00937 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.181 | L2-Norm(final)=15.021 | 5152.5 samples/s | 80.5 steps/s
[Step=41550 Epoch=81.2] | Loss=0.00928 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.183 | L2-Norm(final)=15.022 | 2097.8 samples/s | 32.8 steps/s
[Step=41600 Epoch=81.3] | Loss=0.00912 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.184 | L2-Norm(final)=15.023 | 4776.2 samples/s | 74.6 steps/s
[Step=41650 Epoch=81.4] | Loss=0.00901 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.186 | L2-Norm(final)=15.023 | 4806.0 samples/s | 75.1 steps/s
[Step=41700 Epoch=81.5] | Loss=0.00896 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.188 | L2-Norm(final)=15.024 | 4799.4 samples/s | 75.0 steps/s
[Step=41750 Epoch=81.6] | Loss=0.00891 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.190 | L2-Norm(final)=15.025 | 4778.5 samples/s | 74.7 steps/s
[Step=41800 Epoch=81.7] | Loss=0.00890 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.192 | L2-Norm(final)=15.026 | 4763.7 samples/s | 74.4 steps/s
[Step=41850 Epoch=81.8] | Loss=0.00893 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.193 | L2-Norm(final)=15.027 | 4734.7 samples/s | 74.0 steps/s
[Step=41900 Epoch=81.9] | Loss=0.00888 | Reg=0.00174 | acc=0.9688 | L2-Norm=13.195 | L2-Norm(final)=15.027 | 4866.3 samples/s | 76.0 steps/s
[Step=41950 Epoch=82.0] | Loss=0.00881 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.197 | L2-Norm(final)=15.028 | 4887.2 samples/s | 76.4 steps/s
[Step=42000 Epoch=82.1] | Loss=0.00876 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.199 | L2-Norm(final)=15.028 | 4928.2 samples/s | 77.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step42000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=40001 Epoch=153.3] | Loss=0.00000 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.084 | L2-Norm(final)=16.409 | 4274.5 samples/s | 66.8 steps/s
[Step=40050 Epoch=153.5] | Loss=0.00024 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.083 | L2-Norm(final)=16.415 | 5153.9 samples/s | 80.5 steps/s
[Step=40100 Epoch=153.6] | Loss=0.00025 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.083 | L2-Norm(final)=16.420 | 5171.9 samples/s | 80.8 steps/s
[Step=40150 Epoch=153.8] | Loss=0.00026 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.083 | L2-Norm(final)=16.424 | 5096.3 samples/s | 79.6 steps/s
[Step=40200 Epoch=154.0] | Loss=0.00026 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.083 | L2-Norm(final)=16.428 | 5399.5 samples/s | 84.4 steps/s
[Step=40250 Epoch=154.2] | Loss=0.00027 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.083 | L2-Norm(final)=16.432 | 6930.8 samples/s | 108.3 steps/s
[Step=40300 Epoch=154.4] | Loss=0.00026 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.083 | L2-Norm(final)=16.436 | 2079.6 samples/s | 32.5 steps/s
[Step=40350 Epoch=154.6] | Loss=0.00027 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.083 | L2-Norm(final)=16.440 | 5354.5 samples/s | 83.7 steps/s
[Step=40400 Epoch=154.8] | Loss=0.00027 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.083 | L2-Norm(final)=16.443 | 5447.1 samples/s | 85.1 steps/s
[Step=40450 Epoch=155.0] | Loss=0.00027 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.083 | L2-Norm(final)=16.447 | 5163.0 samples/s | 80.7 steps/s
[Step=40500 Epoch=155.2] | Loss=0.00027 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.083 | L2-Norm(final)=16.451 | 5915.2 samples/s | 92.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=40501 Epoch=155.2] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.083 | L2-Norm(final)=16.492 | 4197.0 samples/s | 65.6 steps/s
[Step=40550 Epoch=155.4] | Loss=0.00016 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.076 | L2-Norm(final)=16.495 | 4440.1 samples/s | 69.4 steps/s
[Step=40600 Epoch=155.6] | Loss=0.00011 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.072 | L2-Norm(final)=16.498 | 4527.0 samples/s | 70.7 steps/s
[Step=40650 Epoch=155.8] | Loss=0.00008 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.067 | L2-Norm(final)=16.501 | 4583.8 samples/s | 71.6 steps/s
[Step=40700 Epoch=155.9] | Loss=0.00009 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.064 | L2-Norm(final)=16.504 | 4486.7 samples/s | 70.1 steps/s
[Step=40750 Epoch=156.1] | Loss=0.00007 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.062 | L2-Norm(final)=16.506 | 5757.4 samples/s | 90.0 steps/s
[Step=40800 Epoch=156.3] | Loss=0.00006 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.058 | L2-Norm(final)=16.507 | 1955.9 samples/s | 30.6 steps/s
[Step=40850 Epoch=156.5] | Loss=0.00005 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.054 | L2-Norm(final)=16.508 | 4518.8 samples/s | 70.6 steps/s
[Step=40900 Epoch=156.7] | Loss=0.00005 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.048 | L2-Norm(final)=16.509 | 4543.9 samples/s | 71.0 steps/s
[Step=40950 Epoch=156.9] | Loss=0.00004 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.043 | L2-Norm(final)=16.510 | 4499.1 samples/s | 70.3 steps/s
[Step=41000 Epoch=157.1] | Loss=0.00004 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.038 | L2-Norm(final)=16.511 | 5053.3 samples/s | 79.0 steps/s
[Step=41050 Epoch=157.3] | Loss=0.00003 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.032 | L2-Norm(final)=16.511 | 2034.9 samples/s | 31.8 steps/s
[Step=41100 Epoch=157.5] | Loss=0.00003 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.027 | L2-Norm(final)=16.512 | 4622.2 samples/s | 72.2 steps/s
[Step=41150 Epoch=157.7] | Loss=0.00003 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.021 | L2-Norm(final)=16.512 | 4541.6 samples/s | 71.0 steps/s
[Step=41200 Epoch=157.9] | Loss=0.00003 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.015 | L2-Norm(final)=16.513 | 4528.9 samples/s | 70.8 steps/s
[Step=41250 Epoch=158.1] | Loss=0.00002 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.010 | L2-Norm(final)=16.513 | 4493.6 samples/s | 70.2 steps/s
[Step=41300 Epoch=158.2] | Loss=0.00002 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.004 | L2-Norm(final)=16.514 | 2147.8 samples/s | 33.6 steps/s
[Step=41350 Epoch=158.4] | Loss=0.00002 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.998 | L2-Norm(final)=16.514 | 4480.6 samples/s | 70.0 steps/s
[Step=41400 Epoch=158.6] | Loss=0.00002 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.992 | L2-Norm(final)=16.514 | 4528.9 samples/s | 70.8 steps/s
[Step=41450 Epoch=158.8] | Loss=0.00002 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.986 | L2-Norm(final)=16.515 | 4488.3 samples/s | 70.1 steps/s
[Step=41500 Epoch=159.0] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.981 | L2-Norm(final)=16.515 | 4532.5 samples/s | 70.8 steps/s
[Step=41550 Epoch=159.2] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.975 | L2-Norm(final)=16.515 | 2110.1 samples/s | 33.0 steps/s
[Step=41600 Epoch=159.4] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.969 | L2-Norm(final)=16.516 | 4595.8 samples/s | 71.8 steps/s
[Step=41650 Epoch=159.6] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.963 | L2-Norm(final)=16.516 | 4605.7 samples/s | 72.0 steps/s
[Step=41700 Epoch=159.8] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.957 | L2-Norm(final)=16.516 | 4496.2 samples/s | 70.3 steps/s
[Step=41750 Epoch=160.0] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.951 | L2-Norm(final)=16.516 | 4537.0 samples/s | 70.9 steps/s
[Step=41800 Epoch=160.2] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.945 | L2-Norm(final)=16.517 | 6163.8 samples/s | 96.3 steps/s
[Step=41850 Epoch=160.4] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.939 | L2-Norm(final)=16.517 | 1893.5 samples/s | 29.6 steps/s
[Step=41900 Epoch=160.5] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.932 | L2-Norm(final)=16.517 | 4663.1 samples/s | 72.9 steps/s
[Step=41950 Epoch=160.7] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.926 | L2-Norm(final)=16.518 | 4553.1 samples/s | 71.1 steps/s
[Step=42000 Epoch=160.9] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.920 | L2-Norm(final)=16.518 | 4557.2 samples/s | 71.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step42000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=40001 Epoch=154.0] | Loss=0.00010 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.084 | L2-Norm(final)=16.038 | 4419.5 samples/s | 69.1 steps/s
[Step=40050 Epoch=154.2] | Loss=0.00077 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.082 | L2-Norm(final)=16.048 | 4703.7 samples/s | 73.5 steps/s
[Step=40100 Epoch=154.4] | Loss=0.00058 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.082 | L2-Norm(final)=16.057 | 5237.6 samples/s | 81.8 steps/s
[Step=40150 Epoch=154.6] | Loss=0.00064 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.082 | L2-Norm(final)=16.067 | 5186.4 samples/s | 81.0 steps/s
[Step=40200 Epoch=154.7] | Loss=0.00062 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.081 | L2-Norm(final)=16.077 | 5254.3 samples/s | 82.1 steps/s
[Step=40250 Epoch=154.9] | Loss=0.00062 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.081 | L2-Norm(final)=16.086 | 6785.5 samples/s | 106.0 steps/s
[Step=40300 Epoch=155.1] | Loss=0.00060 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.081 | L2-Norm(final)=16.095 | 2043.5 samples/s | 31.9 steps/s
[Step=40350 Epoch=155.3] | Loss=0.00063 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.081 | L2-Norm(final)=16.103 | 5261.8 samples/s | 82.2 steps/s
[Step=40400 Epoch=155.5] | Loss=0.00063 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.081 | L2-Norm(final)=16.111 | 5075.0 samples/s | 79.3 steps/s
[Step=40450 Epoch=155.7] | Loss=0.00064 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.081 | L2-Norm(final)=16.119 | 5170.7 samples/s | 80.8 steps/s
[Step=40500 Epoch=155.9] | Loss=0.00061 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.081 | L2-Norm(final)=16.127 | 6017.8 samples/s | 94.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=40501 Epoch=155.9] | Loss=0.00041 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.081 | L2-Norm(final)=16.203 | 4622.9 samples/s | 72.2 steps/s
[Step=40550 Epoch=156.1] | Loss=0.00023 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.083 | L2-Norm(final)=16.208 | 4248.8 samples/s | 66.4 steps/s
[Step=40600 Epoch=156.3] | Loss=0.00079 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.087 | L2-Norm(final)=16.210 | 4556.9 samples/s | 71.2 steps/s
[Step=40650 Epoch=156.5] | Loss=0.00064 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.108 | L2-Norm(final)=16.209 | 4544.9 samples/s | 71.0 steps/s
[Step=40700 Epoch=156.7] | Loss=0.00071 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.121 | L2-Norm(final)=16.209 | 4486.7 samples/s | 70.1 steps/s
[Step=40750 Epoch=156.9] | Loss=0.00059 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.130 | L2-Norm(final)=16.208 | 5770.3 samples/s | 90.2 steps/s
[Step=40800 Epoch=157.1] | Loss=0.00059 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.137 | L2-Norm(final)=16.208 | 1958.8 samples/s | 30.6 steps/s
[Step=40850 Epoch=157.2] | Loss=0.00052 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.142 | L2-Norm(final)=16.208 | 4574.2 samples/s | 71.5 steps/s
[Step=40900 Epoch=157.4] | Loss=0.00045 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.144 | L2-Norm(final)=16.208 | 4500.0 samples/s | 70.3 steps/s
[Step=40950 Epoch=157.6] | Loss=0.00041 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.146 | L2-Norm(final)=16.208 | 4583.1 samples/s | 71.6 steps/s
[Step=41000 Epoch=157.8] | Loss=0.00037 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.146 | L2-Norm(final)=16.209 | 5076.3 samples/s | 79.3 steps/s
[Step=41050 Epoch=158.0] | Loss=0.00033 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.145 | L2-Norm(final)=16.209 | 2011.7 samples/s | 31.4 steps/s
[Step=41100 Epoch=158.2] | Loss=0.00030 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.143 | L2-Norm(final)=16.209 | 4542.4 samples/s | 71.0 steps/s
[Step=41150 Epoch=158.4] | Loss=0.00028 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.141 | L2-Norm(final)=16.210 | 4535.6 samples/s | 70.9 steps/s
[Step=41200 Epoch=158.6] | Loss=0.00026 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.139 | L2-Norm(final)=16.210 | 4461.5 samples/s | 69.7 steps/s
[Step=41250 Epoch=158.8] | Loss=0.00024 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.136 | L2-Norm(final)=16.210 | 4608.6 samples/s | 72.0 steps/s
[Step=41300 Epoch=159.0] | Loss=0.00023 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.133 | L2-Norm(final)=16.210 | 2074.7 samples/s | 32.4 steps/s
[Step=41350 Epoch=159.2] | Loss=0.00022 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.130 | L2-Norm(final)=16.210 | 4582.1 samples/s | 71.6 steps/s
[Step=41400 Epoch=159.4] | Loss=0.00020 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.127 | L2-Norm(final)=16.211 | 4437.9 samples/s | 69.3 steps/s
[Step=41450 Epoch=159.6] | Loss=0.00019 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.123 | L2-Norm(final)=16.211 | 4500.7 samples/s | 70.3 steps/s
[Step=41500 Epoch=159.7] | Loss=0.00018 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.120 | L2-Norm(final)=16.211 | 4510.2 samples/s | 70.5 steps/s
[Step=41550 Epoch=159.9] | Loss=0.00017 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.116 | L2-Norm(final)=16.211 | 2164.8 samples/s | 33.8 steps/s
[Step=41600 Epoch=160.1] | Loss=0.00017 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.112 | L2-Norm(final)=16.211 | 4558.1 samples/s | 71.2 steps/s
[Step=41650 Epoch=160.3] | Loss=0.00016 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.108 | L2-Norm(final)=16.211 | 4463.1 samples/s | 69.7 steps/s
[Step=41700 Epoch=160.5] | Loss=0.00015 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=16.211 | 4551.8 samples/s | 71.1 steps/s
[Step=41750 Epoch=160.7] | Loss=0.00015 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.100 | L2-Norm(final)=16.212 | 4532.4 samples/s | 70.8 steps/s
[Step=41800 Epoch=160.9] | Loss=0.00014 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.096 | L2-Norm(final)=16.212 | 6645.1 samples/s | 103.8 steps/s
[Step=41850 Epoch=161.1] | Loss=0.00014 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.091 | L2-Norm(final)=16.212 | 1849.1 samples/s | 28.9 steps/s
[Step=41900 Epoch=161.3] | Loss=0.00013 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.087 | L2-Norm(final)=16.212 | 4479.1 samples/s | 70.0 steps/s
[Step=41950 Epoch=161.5] | Loss=0.00013 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.082 | L2-Norm(final)=16.212 | 4528.3 samples/s | 70.8 steps/s
[Step=42000 Epoch=161.7] | Loss=0.00012 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.078 | L2-Norm(final)=16.212 | 4464.0 samples/s | 69.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step42000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06874 | acc=0.9708 | tpr=0.9742 | fpr=0.0367 | 4533.7 samples/s | 17.7 steps/s
Avg test loss: 0.06840, Avg test acc: 0.97011, Avg tpr: 0.97354, Avg fpr: 0.03743, total FA: 292

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07710 | acc=0.9714 | tpr=0.9820 | fpr=0.0515 | 4544.9 samples/s | 17.8 steps/s
Avg test loss: 0.07609, Avg test acc: 0.97127, Avg tpr: 0.98246, Avg fpr: 0.05333, total FA: 416

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.29775 | acc=0.3081 | tpr=0.0172 | fpr=0.0602 | 4438.1 samples/s | 17.3 steps/s
Avg test loss: 6.30728, Avg test acc: 0.30555, Avg tpr: 0.01719, Avg fpr: 0.06025, total FA: 470

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=8.54875 | acc=0.3144 | tpr=0.0141 | fpr=0.0337 | 4466.4 samples/s | 17.4 steps/s
Avg test loss: 8.56856, Avg test acc: 0.31156, Avg tpr: 0.01399, Avg fpr: 0.03397, total FA: 265

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.24616 | acc=0.1288 | tpr=0.7301 | fpr=0.8821 | 4375.6 samples/s | 17.1 steps/s
[Step= 100] | Loss=6.20544 | acc=0.1293 | tpr=0.7207 | fpr=0.8817 | 8688.7 samples/s | 33.9 steps/s
[Step= 150] | Loss=6.22555 | acc=0.1271 | tpr=0.7219 | fpr=0.8838 | 8455.0 samples/s | 33.0 steps/s
[Step= 200] | Loss=6.21660 | acc=0.1266 | tpr=0.7093 | fpr=0.8840 | 8510.5 samples/s | 33.2 steps/s
[Step= 250] | Loss=6.22731 | acc=0.1265 | tpr=0.7100 | fpr=0.8842 | 8395.4 samples/s | 32.8 steps/s
[Step= 300] | Loss=6.22481 | acc=0.1263 | tpr=0.7084 | fpr=0.8843 | 8470.1 samples/s | 33.1 steps/s
[Step= 350] | Loss=6.22301 | acc=0.1259 | tpr=0.7082 | fpr=0.8847 | 8538.8 samples/s | 33.4 steps/s
[Step= 400] | Loss=6.23037 | acc=0.1257 | tpr=0.7090 | fpr=0.8849 | 8376.0 samples/s | 32.7 steps/s
[Step= 450] | Loss=6.23345 | acc=0.1259 | tpr=0.7123 | fpr=0.8847 | 8429.4 samples/s | 32.9 steps/s
[Step= 500] | Loss=6.23386 | acc=0.1259 | tpr=0.7150 | fpr=0.8848 | 8200.6 samples/s | 32.0 steps/s
[Step= 550] | Loss=6.23878 | acc=0.1255 | tpr=0.7119 | fpr=0.8852 | 15875.4 samples/s | 62.0 steps/s
Avg test loss: 6.23915, Avg test acc: 0.12535, Avg tpr: 0.71197, Avg fpr: 0.88531, total FA: 122924

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=8.32664 | acc=0.1055 | tpr=0.7832 | fpr=0.9066 | 4522.8 samples/s | 17.7 steps/s
[Step= 100] | Loss=8.29183 | acc=0.1068 | tpr=0.7868 | fpr=0.9059 | 8118.5 samples/s | 31.7 steps/s
[Step= 150] | Loss=8.30451 | acc=0.1063 | tpr=0.7853 | fpr=0.9062 | 8248.1 samples/s | 32.2 steps/s
[Step= 200] | Loss=8.29553 | acc=0.1060 | tpr=0.7738 | fpr=0.9062 | 8529.1 samples/s | 33.3 steps/s
[Step= 250] | Loss=8.30471 | acc=0.1057 | tpr=0.7738 | fpr=0.9065 | 8339.4 samples/s | 32.6 steps/s
[Step= 300] | Loss=8.29687 | acc=0.1055 | tpr=0.7702 | fpr=0.9066 | 8969.8 samples/s | 35.0 steps/s
[Step= 350] | Loss=8.29532 | acc=0.1046 | tpr=0.7671 | fpr=0.9074 | 7684.9 samples/s | 30.0 steps/s
[Step= 400] | Loss=8.29983 | acc=0.1046 | tpr=0.7675 | fpr=0.9074 | 8717.8 samples/s | 34.1 steps/s
[Step= 450] | Loss=8.30254 | acc=0.1047 | tpr=0.7702 | fpr=0.9074 | 8423.5 samples/s | 32.9 steps/s
[Step= 500] | Loss=8.30171 | acc=0.1047 | tpr=0.7696 | fpr=0.9073 | 8175.6 samples/s | 31.9 steps/s
[Step= 550] | Loss=8.30795 | acc=0.1043 | tpr=0.7672 | fpr=0.9078 | 15202.3 samples/s | 59.4 steps/s
Avg test loss: 8.30796, Avg test acc: 0.10419, Avg tpr: 0.76664, Avg fpr: 0.90785, total FA: 126053

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12977 | acc=0.9831 | tpr=0.9425 | fpr=0.0161 | 4452.1 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.13952 | acc=0.9824 | tpr=0.9574 | fpr=0.0172 | 8528.7 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.14468 | acc=0.9817 | tpr=0.9625 | fpr=0.0180 | 8144.9 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.14467 | acc=0.9818 | tpr=0.9661 | fpr=0.0179 | 8517.0 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.14343 | acc=0.9819 | tpr=0.9633 | fpr=0.0178 | 8335.6 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.14446 | acc=0.9818 | tpr=0.9629 | fpr=0.0178 | 9327.8 samples/s | 36.4 steps/s
[Step= 350] | Loss=0.14616 | acc=0.9816 | tpr=0.9631 | fpr=0.0181 | 7810.0 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.14784 | acc=0.9813 | tpr=0.9633 | fpr=0.0183 | 8826.3 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.15033 | acc=0.9811 | tpr=0.9615 | fpr=0.0186 | 8410.3 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.15008 | acc=0.9810 | tpr=0.9612 | fpr=0.0186 | 8399.0 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.14919 | acc=0.9811 | tpr=0.9578 | fpr=0.0185 | 15223.4 samples/s | 59.5 steps/s
Avg test loss: 0.14882, Avg test acc: 0.98113, Avg tpr: 0.95800, Avg fpr: 0.01844, total FA: 2561

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14454 | acc=0.9838 | tpr=0.9513 | fpr=0.0156 | 4496.3 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.15852 | acc=0.9831 | tpr=0.9638 | fpr=0.0166 | 8272.4 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.16291 | acc=0.9824 | tpr=0.9683 | fpr=0.0173 | 8537.2 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.16429 | acc=0.9824 | tpr=0.9705 | fpr=0.0174 | 8820.3 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.16437 | acc=0.9823 | tpr=0.9659 | fpr=0.0174 | 8050.6 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.16574 | acc=0.9821 | tpr=0.9658 | fpr=0.0176 | 8368.3 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.16778 | acc=0.9819 | tpr=0.9656 | fpr=0.0178 | 8586.6 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.17039 | acc=0.9815 | tpr=0.9628 | fpr=0.0182 | 8335.7 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.17332 | acc=0.9812 | tpr=0.9606 | fpr=0.0184 | 8472.4 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.17346 | acc=0.9811 | tpr=0.9599 | fpr=0.0185 | 8275.2 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.17235 | acc=0.9811 | tpr=0.9558 | fpr=0.0184 | 14868.4 samples/s | 58.1 steps/s
Avg test loss: 0.17203, Avg test acc: 0.98114, Avg tpr: 0.95602, Avg fpr: 0.01840, total FA: 2555

server round 21/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=42001 Epoch=81.9] | Loss=0.00371 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.964 | L2-Norm(final)=14.562 | 3945.5 samples/s | 61.6 steps/s
[Step=42050 Epoch=82.0] | Loss=0.00895 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.964 | L2-Norm(final)=14.565 | 5342.6 samples/s | 83.5 steps/s
[Step=42100 Epoch=82.1] | Loss=0.01002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.964 | L2-Norm(final)=14.569 | 5374.5 samples/s | 84.0 steps/s
[Step=42150 Epoch=82.2] | Loss=0.00968 | Reg=0.00168 | acc=0.9531 | L2-Norm=12.964 | L2-Norm(final)=14.573 | 5481.2 samples/s | 85.6 steps/s
[Step=42200 Epoch=82.3] | Loss=0.01006 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.964 | L2-Norm(final)=14.578 | 5566.0 samples/s | 87.0 steps/s
[Step=42250 Epoch=82.4] | Loss=0.00986 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.964 | L2-Norm(final)=14.584 | 5547.3 samples/s | 86.7 steps/s
[Step=42300 Epoch=82.5] | Loss=0.00992 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.964 | L2-Norm(final)=14.589 | 5475.5 samples/s | 85.6 steps/s
[Step=42350 Epoch=82.6] | Loss=0.01021 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.964 | L2-Norm(final)=14.594 | 5509.8 samples/s | 86.1 steps/s
[Step=42400 Epoch=82.7] | Loss=0.01012 | Reg=0.00168 | acc=0.9531 | L2-Norm=12.964 | L2-Norm(final)=14.599 | 5630.4 samples/s | 88.0 steps/s
[Step=42450 Epoch=82.8] | Loss=0.01015 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.964 | L2-Norm(final)=14.604 | 5427.4 samples/s | 84.8 steps/s
[Step=42500 Epoch=82.9] | Loss=0.01007 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.964 | L2-Norm(final)=14.609 | 6973.3 samples/s | 109.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=42501 Epoch=82.9] | Loss=0.00110 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.964 | L2-Norm(final)=14.658 | 3928.0 samples/s | 61.4 steps/s
[Step=42550 Epoch=83.0] | Loss=0.01117 | Reg=0.00168 | acc=0.9531 | L2-Norm=12.974 | L2-Norm(final)=14.661 | 4549.8 samples/s | 71.1 steps/s
[Step=42600 Epoch=83.1] | Loss=0.01170 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.987 | L2-Norm(final)=14.660 | 4487.2 samples/s | 70.1 steps/s
[Step=42650 Epoch=83.2] | Loss=0.01121 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.998 | L2-Norm(final)=14.658 | 4526.0 samples/s | 70.7 steps/s
[Step=42700 Epoch=83.3] | Loss=0.01096 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.006 | L2-Norm(final)=14.657 | 4577.5 samples/s | 71.5 steps/s
[Step=42750 Epoch=83.4] | Loss=0.01068 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.013 | L2-Norm(final)=14.658 | 4838.8 samples/s | 75.6 steps/s
[Step=42800 Epoch=83.5] | Loss=0.01050 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.020 | L2-Norm(final)=14.659 | 4786.8 samples/s | 74.8 steps/s
[Step=42850 Epoch=83.6] | Loss=0.01033 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.027 | L2-Norm(final)=14.659 | 4743.0 samples/s | 74.1 steps/s
[Step=42900 Epoch=83.7] | Loss=0.01058 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.034 | L2-Norm(final)=14.659 | 4722.6 samples/s | 73.8 steps/s
[Step=42950 Epoch=83.8] | Loss=0.01064 | Reg=0.00170 | acc=0.9688 | L2-Norm=13.039 | L2-Norm(final)=14.659 | 4755.1 samples/s | 74.3 steps/s
[Step=43000 Epoch=83.9] | Loss=0.01070 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.045 | L2-Norm(final)=14.659 | 5726.4 samples/s | 89.5 steps/s
[Step=43050 Epoch=84.0] | Loss=0.01031 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.050 | L2-Norm(final)=14.660 | 1999.4 samples/s | 31.2 steps/s
[Step=43100 Epoch=84.1] | Loss=0.01005 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.054 | L2-Norm(final)=14.661 | 4788.4 samples/s | 74.8 steps/s
[Step=43150 Epoch=84.2] | Loss=0.00977 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.059 | L2-Norm(final)=14.662 | 4770.9 samples/s | 74.5 steps/s
[Step=43200 Epoch=84.3] | Loss=0.00969 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.063 | L2-Norm(final)=14.663 | 4787.6 samples/s | 74.8 steps/s
[Step=43250 Epoch=84.4] | Loss=0.00954 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.066 | L2-Norm(final)=14.664 | 4775.5 samples/s | 74.6 steps/s
[Step=43300 Epoch=84.5] | Loss=0.00928 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.070 | L2-Norm(final)=14.665 | 4739.0 samples/s | 74.0 steps/s
[Step=43350 Epoch=84.5] | Loss=0.00921 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.073 | L2-Norm(final)=14.666 | 4758.8 samples/s | 74.4 steps/s
[Step=43400 Epoch=84.6] | Loss=0.00907 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.076 | L2-Norm(final)=14.668 | 4759.4 samples/s | 74.4 steps/s
[Step=43450 Epoch=84.7] | Loss=0.00916 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.080 | L2-Norm(final)=14.669 | 4802.4 samples/s | 75.0 steps/s
[Step=43500 Epoch=84.8] | Loss=0.00917 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.083 | L2-Norm(final)=14.670 | 5059.1 samples/s | 79.0 steps/s
[Step=43550 Epoch=84.9] | Loss=0.00906 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.086 | L2-Norm(final)=14.671 | 2071.4 samples/s | 32.4 steps/s
[Step=43600 Epoch=85.0] | Loss=0.00895 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.089 | L2-Norm(final)=14.672 | 4781.3 samples/s | 74.7 steps/s
[Step=43650 Epoch=85.1] | Loss=0.00891 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.092 | L2-Norm(final)=14.674 | 4755.1 samples/s | 74.3 steps/s
[Step=43700 Epoch=85.2] | Loss=0.00881 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.094 | L2-Norm(final)=14.675 | 4776.4 samples/s | 74.6 steps/s
[Step=43750 Epoch=85.3] | Loss=0.00883 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.097 | L2-Norm(final)=14.676 | 4693.4 samples/s | 73.3 steps/s
[Step=43800 Epoch=85.4] | Loss=0.00879 | Reg=0.00172 | acc=0.9688 | L2-Norm=13.100 | L2-Norm(final)=14.677 | 4734.4 samples/s | 74.0 steps/s
[Step=43850 Epoch=85.5] | Loss=0.00873 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.102 | L2-Norm(final)=14.678 | 4744.4 samples/s | 74.1 steps/s
[Step=43900 Epoch=85.6] | Loss=0.00858 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.105 | L2-Norm(final)=14.679 | 4737.6 samples/s | 74.0 steps/s
[Step=43950 Epoch=85.7] | Loss=0.00850 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.107 | L2-Norm(final)=14.680 | 4789.6 samples/s | 74.8 steps/s
[Step=44000 Epoch=85.8] | Loss=0.00847 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.110 | L2-Norm(final)=14.681 | 4770.7 samples/s | 74.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step44000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=42001 Epoch=82.1] | Loss=0.00475 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.964 | L2-Norm(final)=15.048 | 4295.2 samples/s | 67.1 steps/s
[Step=42050 Epoch=82.2] | Loss=0.00858 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.965 | L2-Norm(final)=15.056 | 5543.4 samples/s | 86.6 steps/s
[Step=42100 Epoch=82.3] | Loss=0.00896 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.965 | L2-Norm(final)=15.064 | 5390.9 samples/s | 84.2 steps/s
[Step=42150 Epoch=82.4] | Loss=0.00980 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.965 | L2-Norm(final)=15.071 | 5464.3 samples/s | 85.4 steps/s
[Step=42200 Epoch=82.5] | Loss=0.00994 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.965 | L2-Norm(final)=15.076 | 5427.8 samples/s | 84.8 steps/s
[Step=42250 Epoch=82.6] | Loss=0.01004 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.965 | L2-Norm(final)=15.080 | 5532.4 samples/s | 86.4 steps/s
[Step=42300 Epoch=82.7] | Loss=0.00975 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.965 | L2-Norm(final)=15.085 | 5421.0 samples/s | 84.7 steps/s
[Step=42350 Epoch=82.8] | Loss=0.00968 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.965 | L2-Norm(final)=15.090 | 5490.9 samples/s | 85.8 steps/s
[Step=42400 Epoch=82.9] | Loss=0.00988 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.965 | L2-Norm(final)=15.095 | 5458.6 samples/s | 85.3 steps/s
[Step=42450 Epoch=83.0] | Loss=0.01009 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.965 | L2-Norm(final)=15.099 | 5532.1 samples/s | 86.4 steps/s
[Step=42500 Epoch=83.1] | Loss=0.01013 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.965 | L2-Norm(final)=15.104 | 6968.9 samples/s | 108.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=42501 Epoch=83.1] | Loss=0.00018 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.965 | L2-Norm(final)=15.149 | 4273.4 samples/s | 66.8 steps/s
[Step=42550 Epoch=83.2] | Loss=0.01145 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.976 | L2-Norm(final)=15.151 | 4634.6 samples/s | 72.4 steps/s
[Step=42600 Epoch=83.3] | Loss=0.00976 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.987 | L2-Norm(final)=15.149 | 4718.8 samples/s | 73.7 steps/s
[Step=42650 Epoch=83.4] | Loss=0.01036 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.996 | L2-Norm(final)=15.149 | 4734.5 samples/s | 74.0 steps/s
[Step=42700 Epoch=83.5] | Loss=0.01119 | Reg=0.00169 | acc=0.9688 | L2-Norm=13.005 | L2-Norm(final)=15.149 | 4740.4 samples/s | 74.1 steps/s
[Step=42750 Epoch=83.6] | Loss=0.01110 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.012 | L2-Norm(final)=15.150 | 4734.1 samples/s | 74.0 steps/s
[Step=42800 Epoch=83.7] | Loss=0.01119 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.020 | L2-Norm(final)=15.150 | 4759.2 samples/s | 74.4 steps/s
[Step=42850 Epoch=83.8] | Loss=0.01144 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.028 | L2-Norm(final)=15.150 | 4727.8 samples/s | 73.9 steps/s
[Step=42900 Epoch=83.9] | Loss=0.01126 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.034 | L2-Norm(final)=15.150 | 4806.1 samples/s | 75.1 steps/s
[Step=42950 Epoch=84.0] | Loss=0.01119 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.040 | L2-Norm(final)=15.149 | 4782.1 samples/s | 74.7 steps/s
[Step=43000 Epoch=84.1] | Loss=0.01122 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.046 | L2-Norm(final)=15.149 | 5809.9 samples/s | 90.8 steps/s
[Step=43050 Epoch=84.2] | Loss=0.01109 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.050 | L2-Norm(final)=15.148 | 2046.8 samples/s | 32.0 steps/s
[Step=43100 Epoch=84.3] | Loss=0.01088 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.055 | L2-Norm(final)=15.149 | 4820.5 samples/s | 75.3 steps/s
[Step=43150 Epoch=84.4] | Loss=0.01063 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.059 | L2-Norm(final)=15.149 | 4769.0 samples/s | 74.5 steps/s
[Step=43200 Epoch=84.5] | Loss=0.01042 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.063 | L2-Norm(final)=15.150 | 4821.8 samples/s | 75.3 steps/s
[Step=43250 Epoch=84.6] | Loss=0.01033 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.067 | L2-Norm(final)=15.150 | 4697.6 samples/s | 73.4 steps/s
[Step=43300 Epoch=84.7] | Loss=0.01013 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.070 | L2-Norm(final)=15.151 | 4810.2 samples/s | 75.2 steps/s
[Step=43350 Epoch=84.7] | Loss=0.01004 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.073 | L2-Norm(final)=15.151 | 4823.3 samples/s | 75.4 steps/s
[Step=43400 Epoch=84.8] | Loss=0.00987 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.077 | L2-Norm(final)=15.152 | 4764.5 samples/s | 74.4 steps/s
[Step=43450 Epoch=84.9] | Loss=0.00978 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.080 | L2-Norm(final)=15.152 | 4793.7 samples/s | 74.9 steps/s
[Step=43500 Epoch=85.0] | Loss=0.00964 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.083 | L2-Norm(final)=15.153 | 5219.7 samples/s | 81.6 steps/s
[Step=43550 Epoch=85.1] | Loss=0.00960 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.086 | L2-Norm(final)=15.153 | 2124.5 samples/s | 33.2 steps/s
[Step=43600 Epoch=85.2] | Loss=0.00945 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.089 | L2-Norm(final)=15.154 | 4902.0 samples/s | 76.6 steps/s
[Step=43650 Epoch=85.3] | Loss=0.00932 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.092 | L2-Norm(final)=15.154 | 4852.0 samples/s | 75.8 steps/s
[Step=43700 Epoch=85.4] | Loss=0.00920 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.095 | L2-Norm(final)=15.155 | 4932.8 samples/s | 77.1 steps/s
[Step=43750 Epoch=85.5] | Loss=0.00915 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.097 | L2-Norm(final)=15.156 | 4863.5 samples/s | 76.0 steps/s
[Step=43800 Epoch=85.6] | Loss=0.00903 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.100 | L2-Norm(final)=15.157 | 4901.2 samples/s | 76.6 steps/s
[Step=43850 Epoch=85.7] | Loss=0.00895 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.102 | L2-Norm(final)=15.157 | 4833.8 samples/s | 75.5 steps/s
[Step=43900 Epoch=85.8] | Loss=0.00885 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=15.158 | 4903.1 samples/s | 76.6 steps/s
[Step=43950 Epoch=85.9] | Loss=0.00877 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.107 | L2-Norm(final)=15.159 | 4942.6 samples/s | 77.2 steps/s
[Step=44000 Epoch=86.0] | Loss=0.00870 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.109 | L2-Norm(final)=15.160 | 4856.4 samples/s | 75.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step44000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=42001 Epoch=160.9] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.964 | L2-Norm(final)=16.526 | 4119.2 samples/s | 64.4 steps/s
[Step=42050 Epoch=161.1] | Loss=0.00009 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.962 | L2-Norm(final)=16.529 | 4951.1 samples/s | 77.4 steps/s
[Step=42100 Epoch=161.3] | Loss=0.00010 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=16.533 | 5203.2 samples/s | 81.3 steps/s
[Step=42150 Epoch=161.5] | Loss=0.00011 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=16.538 | 5066.3 samples/s | 79.2 steps/s
[Step=42200 Epoch=161.7] | Loss=0.00010 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=16.543 | 5123.9 samples/s | 80.1 steps/s
[Step=42250 Epoch=161.9] | Loss=0.00010 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=16.547 | 6634.7 samples/s | 103.7 steps/s
[Step=42300 Epoch=162.1] | Loss=0.00010 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=16.551 | 2025.1 samples/s | 31.6 steps/s
[Step=42350 Epoch=162.3] | Loss=0.00011 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=16.556 | 5002.8 samples/s | 78.2 steps/s
[Step=42400 Epoch=162.5] | Loss=0.00010 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=16.560 | 5107.4 samples/s | 79.8 steps/s
[Step=42450 Epoch=162.7] | Loss=0.00010 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=16.564 | 5109.8 samples/s | 79.8 steps/s
[Step=42500 Epoch=162.8] | Loss=0.00010 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=16.569 | 5821.2 samples/s | 91.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=42501 Epoch=162.8] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=16.610 | 4116.3 samples/s | 64.3 steps/s
[Step=42550 Epoch=163.0] | Loss=0.00004 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.952 | L2-Norm(final)=16.613 | 4468.9 samples/s | 69.8 steps/s
[Step=42600 Epoch=163.2] | Loss=0.00002 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.942 | L2-Norm(final)=16.615 | 4556.0 samples/s | 71.2 steps/s
[Step=42650 Epoch=163.4] | Loss=0.00002 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.931 | L2-Norm(final)=16.617 | 4506.3 samples/s | 70.4 steps/s
[Step=42700 Epoch=163.6] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.919 | L2-Norm(final)=16.618 | 4513.7 samples/s | 70.5 steps/s
[Step=42750 Epoch=163.8] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.908 | L2-Norm(final)=16.620 | 5628.3 samples/s | 87.9 steps/s
[Step=42800 Epoch=164.0] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.897 | L2-Norm(final)=16.621 | 1953.7 samples/s | 30.5 steps/s
[Step=42850 Epoch=164.2] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=16.622 | 4518.8 samples/s | 70.6 steps/s
[Step=42900 Epoch=164.4] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.874 | L2-Norm(final)=16.623 | 4446.9 samples/s | 69.5 steps/s
[Step=42950 Epoch=164.6] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.863 | L2-Norm(final)=16.624 | 4474.1 samples/s | 69.9 steps/s
[Step=43000 Epoch=164.8] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.852 | L2-Norm(final)=16.625 | 5038.6 samples/s | 78.7 steps/s
[Step=43050 Epoch=165.0] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.840 | L2-Norm(final)=16.626 | 2074.1 samples/s | 32.4 steps/s
[Step=43100 Epoch=165.1] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.829 | L2-Norm(final)=16.627 | 4575.3 samples/s | 71.5 steps/s
[Step=43150 Epoch=165.3] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.817 | L2-Norm(final)=16.628 | 4525.2 samples/s | 70.7 steps/s
[Step=43200 Epoch=165.5] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.806 | L2-Norm(final)=16.628 | 4538.3 samples/s | 70.9 steps/s
[Step=43250 Epoch=165.7] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.794 | L2-Norm(final)=16.629 | 4603.7 samples/s | 71.9 steps/s
[Step=43300 Epoch=165.9] | Loss=0.00000 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.783 | L2-Norm(final)=16.630 | 2124.6 samples/s | 33.2 steps/s
[Step=43350 Epoch=166.1] | Loss=0.00000 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.771 | L2-Norm(final)=16.630 | 4587.7 samples/s | 71.7 steps/s
[Step=43400 Epoch=166.3] | Loss=0.00000 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.759 | L2-Norm(final)=16.631 | 4531.7 samples/s | 70.8 steps/s
[Step=43450 Epoch=166.5] | Loss=0.00000 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.748 | L2-Norm(final)=16.632 | 4525.9 samples/s | 70.7 steps/s
[Step=43500 Epoch=166.7] | Loss=0.00000 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.736 | L2-Norm(final)=16.632 | 4482.7 samples/s | 70.0 steps/s
[Step=43550 Epoch=166.9] | Loss=0.00000 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.724 | L2-Norm(final)=16.633 | 2093.0 samples/s | 32.7 steps/s
[Step=43600 Epoch=167.1] | Loss=0.00000 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.713 | L2-Norm(final)=16.634 | 4477.0 samples/s | 70.0 steps/s
[Step=43650 Epoch=167.3] | Loss=0.00000 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.701 | L2-Norm(final)=16.635 | 4504.2 samples/s | 70.4 steps/s
[Step=43700 Epoch=167.4] | Loss=0.00000 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.689 | L2-Norm(final)=16.635 | 4507.1 samples/s | 70.4 steps/s
[Step=43750 Epoch=167.6] | Loss=0.00000 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.677 | L2-Norm(final)=16.636 | 4455.4 samples/s | 69.6 steps/s
[Step=43800 Epoch=167.8] | Loss=0.00000 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.665 | L2-Norm(final)=16.636 | 6240.7 samples/s | 97.5 steps/s
[Step=43850 Epoch=168.0] | Loss=0.00000 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.653 | L2-Norm(final)=16.637 | 1905.6 samples/s | 29.8 steps/s
[Step=43900 Epoch=168.2] | Loss=0.00000 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.640 | L2-Norm(final)=16.638 | 4519.0 samples/s | 70.6 steps/s
[Step=43950 Epoch=168.4] | Loss=0.00000 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=16.638 | 4601.3 samples/s | 71.9 steps/s
[Step=44000 Epoch=168.6] | Loss=0.00000 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.616 | L2-Norm(final)=16.639 | 4652.1 samples/s | 72.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step44000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=42001 Epoch=161.7] | Loss=0.00000 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.964 | L2-Norm(final)=16.216 | 4100.8 samples/s | 64.1 steps/s
[Step=42050 Epoch=161.9] | Loss=0.00009 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.962 | L2-Norm(final)=16.218 | 4974.7 samples/s | 77.7 steps/s
[Step=42100 Epoch=162.1] | Loss=0.00013 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.962 | L2-Norm(final)=16.221 | 5063.1 samples/s | 79.1 steps/s
[Step=42150 Epoch=162.3] | Loss=0.00010 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.962 | L2-Norm(final)=16.224 | 5107.0 samples/s | 79.8 steps/s
[Step=42200 Epoch=162.4] | Loss=0.00008 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.962 | L2-Norm(final)=16.226 | 5364.2 samples/s | 83.8 steps/s
[Step=42250 Epoch=162.6] | Loss=0.00009 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.962 | L2-Norm(final)=16.228 | 6514.7 samples/s | 101.8 steps/s
[Step=42300 Epoch=162.8] | Loss=0.00009 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.962 | L2-Norm(final)=16.231 | 2025.7 samples/s | 31.7 steps/s
[Step=42350 Epoch=163.0] | Loss=0.00009 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.962 | L2-Norm(final)=16.233 | 5162.2 samples/s | 80.7 steps/s
[Step=42400 Epoch=163.2] | Loss=0.00009 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.962 | L2-Norm(final)=16.235 | 5122.6 samples/s | 80.0 steps/s
[Step=42450 Epoch=163.4] | Loss=0.00009 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.962 | L2-Norm(final)=16.238 | 5210.0 samples/s | 81.4 steps/s
[Step=42500 Epoch=163.6] | Loss=0.00009 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.962 | L2-Norm(final)=16.241 | 5829.7 samples/s | 91.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=42501 Epoch=163.6] | Loss=0.00048 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.962 | L2-Norm(final)=16.267 | 4252.5 samples/s | 66.4 steps/s
[Step=42550 Epoch=163.8] | Loss=0.00004 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.955 | L2-Norm(final)=16.269 | 4198.7 samples/s | 65.6 steps/s
[Step=42600 Epoch=164.0] | Loss=0.00004 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.948 | L2-Norm(final)=16.270 | 4496.6 samples/s | 70.3 steps/s
[Step=42650 Epoch=164.2] | Loss=0.00003 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.942 | L2-Norm(final)=16.271 | 4453.2 samples/s | 69.6 steps/s
[Step=42700 Epoch=164.4] | Loss=0.00003 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.935 | L2-Norm(final)=16.272 | 4533.0 samples/s | 70.8 steps/s
[Step=42750 Epoch=164.6] | Loss=0.00003 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.928 | L2-Norm(final)=16.273 | 5731.0 samples/s | 89.5 steps/s
[Step=42800 Epoch=164.8] | Loss=0.00002 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.920 | L2-Norm(final)=16.274 | 1939.6 samples/s | 30.3 steps/s
[Step=42850 Epoch=164.9] | Loss=0.00002 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.913 | L2-Norm(final)=16.275 | 4541.5 samples/s | 71.0 steps/s
[Step=42900 Epoch=165.1] | Loss=0.00002 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=16.276 | 4443.1 samples/s | 69.4 steps/s
[Step=42950 Epoch=165.3] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.897 | L2-Norm(final)=16.276 | 4581.8 samples/s | 71.6 steps/s
[Step=43000 Epoch=165.5] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.889 | L2-Norm(final)=16.277 | 5209.7 samples/s | 81.4 steps/s
[Step=43050 Epoch=165.7] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.881 | L2-Norm(final)=16.277 | 2063.4 samples/s | 32.2 steps/s
[Step=43100 Epoch=165.9] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.872 | L2-Norm(final)=16.278 | 4574.3 samples/s | 71.5 steps/s
[Step=43150 Epoch=166.1] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.864 | L2-Norm(final)=16.278 | 4475.1 samples/s | 69.9 steps/s
[Step=43200 Epoch=166.3] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.856 | L2-Norm(final)=16.278 | 4607.1 samples/s | 72.0 steps/s
[Step=43250 Epoch=166.5] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.847 | L2-Norm(final)=16.279 | 4643.1 samples/s | 72.5 steps/s
[Step=43300 Epoch=166.7] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.839 | L2-Norm(final)=16.279 | 2144.6 samples/s | 33.5 steps/s
[Step=43350 Epoch=166.9] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.830 | L2-Norm(final)=16.279 | 4606.3 samples/s | 72.0 steps/s
[Step=43400 Epoch=167.1] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.822 | L2-Norm(final)=16.280 | 4473.3 samples/s | 69.9 steps/s
[Step=43450 Epoch=167.3] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.813 | L2-Norm(final)=16.280 | 4468.6 samples/s | 69.8 steps/s
[Step=43500 Epoch=167.4] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.804 | L2-Norm(final)=16.280 | 4580.7 samples/s | 71.6 steps/s
[Step=43550 Epoch=167.6] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.795 | L2-Norm(final)=16.281 | 2132.3 samples/s | 33.3 steps/s
[Step=43600 Epoch=167.8] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=16.281 | 4569.8 samples/s | 71.4 steps/s
[Step=43650 Epoch=168.0] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.778 | L2-Norm(final)=16.281 | 4517.8 samples/s | 70.6 steps/s
[Step=43700 Epoch=168.2] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.769 | L2-Norm(final)=16.281 | 4571.3 samples/s | 71.4 steps/s
[Step=43750 Epoch=168.4] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.759 | L2-Norm(final)=16.282 | 4670.1 samples/s | 73.0 steps/s
[Step=43800 Epoch=168.6] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.750 | L2-Norm(final)=16.282 | 6608.8 samples/s | 103.3 steps/s
[Step=43850 Epoch=168.8] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.741 | L2-Norm(final)=16.282 | 1902.0 samples/s | 29.7 steps/s
[Step=43900 Epoch=169.0] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.731 | L2-Norm(final)=16.283 | 4576.4 samples/s | 71.5 steps/s
[Step=43950 Epoch=169.2] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.722 | L2-Norm(final)=16.283 | 4671.6 samples/s | 73.0 steps/s
[Step=44000 Epoch=169.4] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.712 | L2-Norm(final)=16.283 | 4633.6 samples/s | 72.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step44000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07924 | acc=0.9715 | tpr=0.9806 | fpr=0.0483 | 4332.6 samples/s | 16.9 steps/s
Avg test loss: 0.07759, Avg test acc: 0.97163, Avg tpr: 0.98082, Avg fpr: 0.04858, total FA: 379

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07780 | acc=0.9701 | tpr=0.9757 | fpr=0.0421 | 4388.6 samples/s | 17.1 steps/s
Avg test loss: 0.07725, Avg test acc: 0.97095, Avg tpr: 0.97657, Avg fpr: 0.04140, total FA: 323

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.27698 | acc=0.3103 | tpr=0.0192 | fpr=0.0575 | 4345.3 samples/s | 17.0 steps/s
Avg test loss: 6.28869, Avg test acc: 0.30704, Avg tpr: 0.01923, Avg fpr: 0.05999, total FA: 468

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.48138 | acc=0.2964 | tpr=0.0209 | fpr=0.1053 | 4395.2 samples/s | 17.2 steps/s
Avg test loss: 6.49416, Avg test acc: 0.29437, Avg tpr: 0.02162, Avg fpr: 0.10576, total FA: 825

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.25686 | acc=0.0950 | tpr=0.7522 | fpr=0.9168 | 4320.3 samples/s | 16.9 steps/s
[Step= 100] | Loss=8.21804 | acc=0.0941 | tpr=0.7399 | fpr=0.9179 | 8561.2 samples/s | 33.4 steps/s
[Step= 150] | Loss=8.23877 | acc=0.0931 | tpr=0.7406 | fpr=0.9188 | 8119.8 samples/s | 31.7 steps/s
[Step= 200] | Loss=8.23292 | acc=0.0931 | tpr=0.7311 | fpr=0.9185 | 8370.1 samples/s | 32.7 steps/s
[Step= 250] | Loss=8.24566 | acc=0.0924 | tpr=0.7301 | fpr=0.9192 | 8266.2 samples/s | 32.3 steps/s
[Step= 300] | Loss=8.24175 | acc=0.0920 | tpr=0.7265 | fpr=0.9196 | 8326.9 samples/s | 32.5 steps/s
[Step= 350] | Loss=8.23922 | acc=0.0914 | tpr=0.7257 | fpr=0.9201 | 8392.9 samples/s | 32.8 steps/s
[Step= 400] | Loss=8.24376 | acc=0.0914 | tpr=0.7287 | fpr=0.9202 | 8362.3 samples/s | 32.7 steps/s
[Step= 450] | Loss=8.24598 | acc=0.0916 | tpr=0.7303 | fpr=0.9200 | 8800.2 samples/s | 34.4 steps/s
[Step= 500] | Loss=8.24706 | acc=0.0914 | tpr=0.7304 | fpr=0.9201 | 7771.4 samples/s | 30.4 steps/s
[Step= 550] | Loss=8.25567 | acc=0.0911 | tpr=0.7282 | fpr=0.9204 | 15956.5 samples/s | 62.3 steps/s
Avg test loss: 8.25590, Avg test acc: 0.09109, Avg tpr: 0.72821, Avg fpr: 0.92049, total FA: 127808

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.68542 | acc=0.1142 | tpr=0.7522 | fpr=0.8972 | 4454.3 samples/s | 17.4 steps/s
[Step= 100] | Loss=7.65249 | acc=0.1157 | tpr=0.7441 | fpr=0.8960 | 8250.8 samples/s | 32.2 steps/s
[Step= 150] | Loss=7.67274 | acc=0.1146 | tpr=0.7435 | fpr=0.8970 | 8504.8 samples/s | 33.2 steps/s
[Step= 200] | Loss=7.66276 | acc=0.1143 | tpr=0.7366 | fpr=0.8970 | 8198.9 samples/s | 32.0 steps/s
[Step= 250] | Loss=7.67232 | acc=0.1143 | tpr=0.7362 | fpr=0.8971 | 8404.0 samples/s | 32.8 steps/s
[Step= 300] | Loss=7.66722 | acc=0.1145 | tpr=0.7382 | fpr=0.8969 | 8321.2 samples/s | 32.5 steps/s
[Step= 350] | Loss=7.66487 | acc=0.1138 | tpr=0.7358 | fpr=0.8975 | 8431.4 samples/s | 32.9 steps/s
[Step= 400] | Loss=7.67029 | acc=0.1139 | tpr=0.7369 | fpr=0.8974 | 8333.1 samples/s | 32.6 steps/s
[Step= 450] | Loss=7.67273 | acc=0.1141 | tpr=0.7386 | fpr=0.8972 | 8393.7 samples/s | 32.8 steps/s
[Step= 500] | Loss=7.67182 | acc=0.1140 | tpr=0.7405 | fpr=0.8973 | 8061.7 samples/s | 31.5 steps/s
[Step= 550] | Loss=7.67690 | acc=0.1138 | tpr=0.7370 | fpr=0.8975 | 15124.4 samples/s | 59.1 steps/s
Avg test loss: 7.67696, Avg test acc: 0.11371, Avg tpr: 0.73653, Avg fpr: 0.89761, total FA: 124631

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13560 | acc=0.9827 | tpr=0.9425 | fpr=0.0166 | 4378.3 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.14702 | acc=0.9817 | tpr=0.9574 | fpr=0.0179 | 8452.5 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.15177 | acc=0.9809 | tpr=0.9640 | fpr=0.0188 | 8193.9 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.15156 | acc=0.9811 | tpr=0.9683 | fpr=0.0187 | 8460.2 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.15070 | acc=0.9810 | tpr=0.9642 | fpr=0.0187 | 8116.2 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.15179 | acc=0.9810 | tpr=0.9658 | fpr=0.0187 | 8359.1 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.15374 | acc=0.9808 | tpr=0.9662 | fpr=0.0190 | 8401.1 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.15573 | acc=0.9805 | tpr=0.9661 | fpr=0.0192 | 8264.1 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.15841 | acc=0.9803 | tpr=0.9649 | fpr=0.0194 | 8367.2 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.15833 | acc=0.9802 | tpr=0.9643 | fpr=0.0195 | 8471.0 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.15744 | acc=0.9803 | tpr=0.9610 | fpr=0.0194 | 14588.8 samples/s | 57.0 steps/s
Avg test loss: 0.15705, Avg test acc: 0.98030, Avg tpr: 0.96117, Avg fpr: 0.01935, total FA: 2687

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13335 | acc=0.9830 | tpr=0.9469 | fpr=0.0163 | 4403.3 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.14351 | acc=0.9824 | tpr=0.9616 | fpr=0.0172 | 8626.0 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.14877 | acc=0.9817 | tpr=0.9654 | fpr=0.0180 | 8382.2 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.14906 | acc=0.9817 | tpr=0.9683 | fpr=0.0181 | 8449.6 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.14842 | acc=0.9815 | tpr=0.9651 | fpr=0.0182 | 8094.3 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.14956 | acc=0.9816 | tpr=0.9665 | fpr=0.0182 | 8727.0 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.15132 | acc=0.9814 | tpr=0.9668 | fpr=0.0184 | 8138.0 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.15343 | acc=0.9811 | tpr=0.9666 | fpr=0.0186 | 8335.5 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.15611 | acc=0.9809 | tpr=0.9649 | fpr=0.0188 | 8761.5 samples/s | 34.2 steps/s
[Step= 500] | Loss=0.15594 | acc=0.9808 | tpr=0.9643 | fpr=0.0189 | 7973.0 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.15503 | acc=0.9808 | tpr=0.9606 | fpr=0.0188 | 14593.7 samples/s | 57.0 steps/s
Avg test loss: 0.15472, Avg test acc: 0.98087, Avg tpr: 0.96078, Avg fpr: 0.01877, total FA: 2606

server round 22/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=44001 Epoch=85.8] | Loss=0.01153 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.686 | L2-Norm(final)=14.715 | 4375.1 samples/s | 68.4 steps/s
[Step=44050 Epoch=85.9] | Loss=0.00864 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=14.718 | 4927.3 samples/s | 77.0 steps/s
[Step=44100 Epoch=86.0] | Loss=0.00850 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=14.721 | 5438.9 samples/s | 85.0 steps/s
[Step=44150 Epoch=86.1] | Loss=0.00863 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=14.724 | 5523.8 samples/s | 86.3 steps/s
[Step=44200 Epoch=86.2] | Loss=0.00877 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=14.727 | 5385.9 samples/s | 84.2 steps/s
[Step=44250 Epoch=86.3] | Loss=0.00898 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=14.731 | 5520.2 samples/s | 86.3 steps/s
[Step=44300 Epoch=86.4] | Loss=0.00912 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=14.734 | 5490.0 samples/s | 85.8 steps/s
[Step=44350 Epoch=86.5] | Loss=0.00893 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.687 | L2-Norm(final)=14.737 | 5335.1 samples/s | 83.4 steps/s
[Step=44400 Epoch=86.6] | Loss=0.00907 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.687 | L2-Norm(final)=14.741 | 5563.8 samples/s | 86.9 steps/s
[Step=44450 Epoch=86.7] | Loss=0.00895 | Reg=0.00161 | acc=0.9688 | L2-Norm=12.687 | L2-Norm(final)=14.745 | 5439.7 samples/s | 85.0 steps/s
[Step=44500 Epoch=86.8] | Loss=0.00896 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=14.748 | 6802.0 samples/s | 106.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=44501 Epoch=86.8] | Loss=0.00454 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=14.778 | 3840.2 samples/s | 60.0 steps/s
[Step=44550 Epoch=86.9] | Loss=0.00980 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.700 | L2-Norm(final)=14.778 | 4696.6 samples/s | 73.4 steps/s
[Step=44600 Epoch=87.0] | Loss=0.00908 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.715 | L2-Norm(final)=14.781 | 4728.6 samples/s | 73.9 steps/s
[Step=44650 Epoch=87.1] | Loss=0.01017 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.727 | L2-Norm(final)=14.782 | 4737.7 samples/s | 74.0 steps/s
[Step=44700 Epoch=87.2] | Loss=0.01048 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.737 | L2-Norm(final)=14.782 | 4715.4 samples/s | 73.7 steps/s
[Step=44750 Epoch=87.3] | Loss=0.01007 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.747 | L2-Norm(final)=14.782 | 4767.4 samples/s | 74.5 steps/s
[Step=44800 Epoch=87.4] | Loss=0.01040 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.755 | L2-Norm(final)=14.782 | 4731.3 samples/s | 73.9 steps/s
[Step=44850 Epoch=87.5] | Loss=0.01023 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.761 | L2-Norm(final)=14.782 | 4772.8 samples/s | 74.6 steps/s
[Step=44900 Epoch=87.6] | Loss=0.01021 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.768 | L2-Norm(final)=14.783 | 4773.9 samples/s | 74.6 steps/s
[Step=44950 Epoch=87.7] | Loss=0.01047 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=14.783 | 4704.2 samples/s | 73.5 steps/s
[Step=45000 Epoch=87.8] | Loss=0.01045 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.779 | L2-Norm(final)=14.784 | 5851.1 samples/s | 91.4 steps/s
[Step=45050 Epoch=87.9] | Loss=0.01037 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.785 | L2-Norm(final)=14.785 | 1923.7 samples/s | 30.1 steps/s
[Step=45100 Epoch=88.0] | Loss=0.01004 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.790 | L2-Norm(final)=14.786 | 4755.5 samples/s | 74.3 steps/s
[Step=45150 Epoch=88.1] | Loss=0.01008 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.795 | L2-Norm(final)=14.787 | 4762.1 samples/s | 74.4 steps/s
[Step=45200 Epoch=88.2] | Loss=0.01005 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.799 | L2-Norm(final)=14.788 | 4814.9 samples/s | 75.2 steps/s
[Step=45250 Epoch=88.3] | Loss=0.00989 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.803 | L2-Norm(final)=14.789 | 4788.8 samples/s | 74.8 steps/s
[Step=45300 Epoch=88.4] | Loss=0.00966 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.807 | L2-Norm(final)=14.789 | 4789.0 samples/s | 74.8 steps/s
[Step=45350 Epoch=88.5] | Loss=0.00942 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.811 | L2-Norm(final)=14.790 | 4839.6 samples/s | 75.6 steps/s
[Step=45400 Epoch=88.5] | Loss=0.00936 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.814 | L2-Norm(final)=14.791 | 4778.4 samples/s | 74.7 steps/s
[Step=45450 Epoch=88.6] | Loss=0.00933 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.818 | L2-Norm(final)=14.792 | 4758.3 samples/s | 74.3 steps/s
[Step=45500 Epoch=88.7] | Loss=0.00925 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.821 | L2-Norm(final)=14.793 | 5125.1 samples/s | 80.1 steps/s
[Step=45550 Epoch=88.8] | Loss=0.00912 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.824 | L2-Norm(final)=14.794 | 2092.9 samples/s | 32.7 steps/s
[Step=45600 Epoch=88.9] | Loss=0.00894 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.827 | L2-Norm(final)=14.795 | 4721.7 samples/s | 73.8 steps/s
[Step=45650 Epoch=89.0] | Loss=0.00892 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.830 | L2-Norm(final)=14.796 | 4754.7 samples/s | 74.3 steps/s
[Step=45700 Epoch=89.1] | Loss=0.00886 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.833 | L2-Norm(final)=14.797 | 4796.6 samples/s | 74.9 steps/s
[Step=45750 Epoch=89.2] | Loss=0.00879 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.836 | L2-Norm(final)=14.798 | 4789.3 samples/s | 74.8 steps/s
[Step=45800 Epoch=89.3] | Loss=0.00872 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.838 | L2-Norm(final)=14.799 | 4810.1 samples/s | 75.2 steps/s
[Step=45850 Epoch=89.4] | Loss=0.00875 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.841 | L2-Norm(final)=14.800 | 4821.7 samples/s | 75.3 steps/s
[Step=45900 Epoch=89.5] | Loss=0.00869 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.844 | L2-Norm(final)=14.801 | 4715.1 samples/s | 73.7 steps/s
[Step=45950 Epoch=89.6] | Loss=0.00869 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.846 | L2-Norm(final)=14.802 | 4748.6 samples/s | 74.2 steps/s
[Step=46000 Epoch=89.7] | Loss=0.00861 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.849 | L2-Norm(final)=14.803 | 4747.8 samples/s | 74.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step46000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=44001 Epoch=86.0] | Loss=0.00993 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.686 | L2-Norm(final)=15.188 | 4413.4 samples/s | 69.0 steps/s
[Step=44050 Epoch=86.1] | Loss=0.00884 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.686 | L2-Norm(final)=15.192 | 5147.8 samples/s | 80.4 steps/s
[Step=44100 Epoch=86.2] | Loss=0.00965 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=15.190 | 5600.1 samples/s | 87.5 steps/s
[Step=44150 Epoch=86.3] | Loss=0.00896 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=15.189 | 5327.5 samples/s | 83.2 steps/s
[Step=44200 Epoch=86.4] | Loss=0.00909 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=15.190 | 5449.4 samples/s | 85.1 steps/s
[Step=44250 Epoch=86.5] | Loss=0.00960 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.687 | L2-Norm(final)=15.191 | 5494.0 samples/s | 85.8 steps/s
[Step=44300 Epoch=86.6] | Loss=0.00938 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=15.192 | 5533.7 samples/s | 86.5 steps/s
[Step=44350 Epoch=86.7] | Loss=0.00954 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=15.193 | 5453.4 samples/s | 85.2 steps/s
[Step=44400 Epoch=86.8] | Loss=0.00934 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=15.194 | 5467.6 samples/s | 85.4 steps/s
[Step=44450 Epoch=86.9] | Loss=0.00933 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=15.196 | 5520.3 samples/s | 86.3 steps/s
[Step=44500 Epoch=87.0] | Loss=0.00922 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.687 | L2-Norm(final)=15.197 | 7029.7 samples/s | 109.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=44501 Epoch=87.0] | Loss=0.00605 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=15.214 | 4461.5 samples/s | 69.7 steps/s
[Step=44550 Epoch=87.1] | Loss=0.00800 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.703 | L2-Norm(final)=15.218 | 4590.0 samples/s | 71.7 steps/s
[Step=44600 Epoch=87.2] | Loss=0.01000 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.716 | L2-Norm(final)=15.218 | 4771.8 samples/s | 74.6 steps/s
[Step=44650 Epoch=87.3] | Loss=0.01082 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.725 | L2-Norm(final)=15.216 | 4763.2 samples/s | 74.4 steps/s
[Step=44700 Epoch=87.4] | Loss=0.01092 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.733 | L2-Norm(final)=15.215 | 4717.5 samples/s | 73.7 steps/s
[Step=44750 Epoch=87.5] | Loss=0.01152 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.741 | L2-Norm(final)=15.215 | 4715.9 samples/s | 73.7 steps/s
[Step=44800 Epoch=87.6] | Loss=0.01159 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.749 | L2-Norm(final)=15.215 | 4800.2 samples/s | 75.0 steps/s
[Step=44850 Epoch=87.7] | Loss=0.01115 | Reg=0.00163 | acc=0.9688 | L2-Norm=12.758 | L2-Norm(final)=15.216 | 4735.5 samples/s | 74.0 steps/s
[Step=44900 Epoch=87.8] | Loss=0.01108 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.765 | L2-Norm(final)=15.216 | 4760.1 samples/s | 74.4 steps/s
[Step=44950 Epoch=87.9] | Loss=0.01087 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.772 | L2-Norm(final)=15.216 | 4824.8 samples/s | 75.4 steps/s
[Step=45000 Epoch=88.0] | Loss=0.01057 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.779 | L2-Norm(final)=15.217 | 5928.9 samples/s | 92.6 steps/s
[Step=45050 Epoch=88.1] | Loss=0.01036 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.785 | L2-Norm(final)=15.217 | 2022.2 samples/s | 31.6 steps/s
[Step=45100 Epoch=88.2] | Loss=0.01007 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.790 | L2-Norm(final)=15.218 | 4707.9 samples/s | 73.6 steps/s
[Step=45150 Epoch=88.3] | Loss=0.00993 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.795 | L2-Norm(final)=15.218 | 4780.0 samples/s | 74.7 steps/s
[Step=45200 Epoch=88.4] | Loss=0.00975 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.800 | L2-Norm(final)=15.219 | 4803.1 samples/s | 75.0 steps/s
[Step=45250 Epoch=88.5] | Loss=0.00958 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.804 | L2-Norm(final)=15.220 | 4748.3 samples/s | 74.2 steps/s
[Step=45300 Epoch=88.6] | Loss=0.00948 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.808 | L2-Norm(final)=15.220 | 4759.6 samples/s | 74.4 steps/s
[Step=45350 Epoch=88.7] | Loss=0.00931 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.812 | L2-Norm(final)=15.221 | 4783.8 samples/s | 74.7 steps/s
[Step=45400 Epoch=88.8] | Loss=0.00928 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.815 | L2-Norm(final)=15.222 | 4780.8 samples/s | 74.7 steps/s
[Step=45450 Epoch=88.9] | Loss=0.00924 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.819 | L2-Norm(final)=15.223 | 4842.3 samples/s | 75.7 steps/s
[Step=45500 Epoch=89.0] | Loss=0.00918 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.822 | L2-Norm(final)=15.224 | 5145.4 samples/s | 80.4 steps/s
[Step=45550 Epoch=89.0] | Loss=0.00911 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.826 | L2-Norm(final)=15.225 | 2141.3 samples/s | 33.5 steps/s
[Step=45600 Epoch=89.1] | Loss=0.00905 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.830 | L2-Norm(final)=15.226 | 4834.6 samples/s | 75.5 steps/s
[Step=45650 Epoch=89.2] | Loss=0.00903 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.833 | L2-Norm(final)=15.227 | 4729.8 samples/s | 73.9 steps/s
[Step=45700 Epoch=89.3] | Loss=0.00898 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.836 | L2-Norm(final)=15.228 | 4743.9 samples/s | 74.1 steps/s
[Step=45750 Epoch=89.4] | Loss=0.00898 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.839 | L2-Norm(final)=15.229 | 4837.3 samples/s | 75.6 steps/s
[Step=45800 Epoch=89.5] | Loss=0.00892 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.842 | L2-Norm(final)=15.230 | 4763.4 samples/s | 74.4 steps/s
[Step=45850 Epoch=89.6] | Loss=0.00884 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.845 | L2-Norm(final)=15.231 | 4857.0 samples/s | 75.9 steps/s
[Step=45900 Epoch=89.7] | Loss=0.00876 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.849 | L2-Norm(final)=15.232 | 4732.6 samples/s | 73.9 steps/s
[Step=45950 Epoch=89.8] | Loss=0.00872 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.852 | L2-Norm(final)=15.233 | 4770.4 samples/s | 74.5 steps/s
[Step=46000 Epoch=89.9] | Loss=0.00865 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.855 | L2-Norm(final)=15.234 | 4820.0 samples/s | 75.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step46000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=44001 Epoch=168.6] | Loss=0.00023 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.686 | L2-Norm(final)=16.658 | 4305.0 samples/s | 67.3 steps/s
[Step=44050 Epoch=168.8] | Loss=0.00030 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.682 | L2-Norm(final)=16.669 | 4843.1 samples/s | 75.7 steps/s
[Step=44100 Epoch=169.0] | Loss=0.00031 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.681 | L2-Norm(final)=16.679 | 5191.4 samples/s | 81.1 steps/s
[Step=44150 Epoch=169.2] | Loss=0.00027 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.681 | L2-Norm(final)=16.691 | 5142.3 samples/s | 80.3 steps/s
[Step=44200 Epoch=169.4] | Loss=0.00023 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.681 | L2-Norm(final)=16.702 | 5077.3 samples/s | 79.3 steps/s
[Step=44250 Epoch=169.6] | Loss=0.00022 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.681 | L2-Norm(final)=16.711 | 6798.5 samples/s | 106.2 steps/s
[Step=44300 Epoch=169.7] | Loss=0.00021 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.681 | L2-Norm(final)=16.719 | 2073.5 samples/s | 32.4 steps/s
[Step=44350 Epoch=169.9] | Loss=0.00022 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.681 | L2-Norm(final)=16.726 | 5210.3 samples/s | 81.4 steps/s
[Step=44400 Epoch=170.1] | Loss=0.00021 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.681 | L2-Norm(final)=16.733 | 5037.1 samples/s | 78.7 steps/s
[Step=44450 Epoch=170.3] | Loss=0.00020 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.681 | L2-Norm(final)=16.740 | 5186.9 samples/s | 81.0 steps/s
[Step=44500 Epoch=170.5] | Loss=0.00020 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.681 | L2-Norm(final)=16.747 | 5843.9 samples/s | 91.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=44501 Epoch=170.5] | Loss=0.00000 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.681 | L2-Norm(final)=16.813 | 4330.9 samples/s | 67.7 steps/s
[Step=44550 Epoch=170.7] | Loss=0.00010 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.683 | L2-Norm(final)=16.818 | 4285.2 samples/s | 67.0 steps/s
[Step=44600 Epoch=170.9] | Loss=0.00155 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.696 | L2-Norm(final)=16.814 | 4550.5 samples/s | 71.1 steps/s
[Step=44650 Epoch=171.1] | Loss=0.00127 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.726 | L2-Norm(final)=16.805 | 4455.5 samples/s | 69.6 steps/s
[Step=44700 Epoch=171.3] | Loss=0.00177 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.746 | L2-Norm(final)=16.801 | 4516.6 samples/s | 70.6 steps/s
[Step=44750 Epoch=171.5] | Loss=0.00151 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.761 | L2-Norm(final)=16.795 | 5724.8 samples/s | 89.4 steps/s
[Step=44800 Epoch=171.7] | Loss=0.00142 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.772 | L2-Norm(final)=16.790 | 1966.2 samples/s | 30.7 steps/s
[Step=44850 Epoch=171.8] | Loss=0.00131 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.781 | L2-Norm(final)=16.787 | 4563.3 samples/s | 71.3 steps/s
[Step=44900 Epoch=172.0] | Loss=0.00117 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=16.784 | 4449.2 samples/s | 69.5 steps/s
[Step=44950 Epoch=172.2] | Loss=0.00105 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.792 | L2-Norm(final)=16.783 | 4505.7 samples/s | 70.4 steps/s
[Step=45000 Epoch=172.4] | Loss=0.00095 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.796 | L2-Norm(final)=16.782 | 5001.8 samples/s | 78.2 steps/s
[Step=45050 Epoch=172.6] | Loss=0.00086 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.799 | L2-Norm(final)=16.781 | 2050.7 samples/s | 32.0 steps/s
[Step=45100 Epoch=172.8] | Loss=0.00079 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.800 | L2-Norm(final)=16.781 | 4586.5 samples/s | 71.7 steps/s
[Step=45150 Epoch=173.0] | Loss=0.00073 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.801 | L2-Norm(final)=16.781 | 4496.2 samples/s | 70.3 steps/s
[Step=45200 Epoch=173.2] | Loss=0.00068 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.802 | L2-Norm(final)=16.781 | 4540.6 samples/s | 70.9 steps/s
[Step=45250 Epoch=173.4] | Loss=0.00064 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.803 | L2-Norm(final)=16.781 | 4547.3 samples/s | 71.1 steps/s
[Step=45300 Epoch=173.6] | Loss=0.00060 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.803 | L2-Norm(final)=16.781 | 2102.8 samples/s | 32.9 steps/s
[Step=45350 Epoch=173.8] | Loss=0.00056 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.802 | L2-Norm(final)=16.781 | 4674.0 samples/s | 73.0 steps/s
[Step=45400 Epoch=174.0] | Loss=0.00053 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.801 | L2-Norm(final)=16.781 | 4615.6 samples/s | 72.1 steps/s
[Step=45450 Epoch=174.1] | Loss=0.00050 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.800 | L2-Norm(final)=16.781 | 4499.3 samples/s | 70.3 steps/s
[Step=45500 Epoch=174.3] | Loss=0.00048 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.799 | L2-Norm(final)=16.782 | 4473.8 samples/s | 69.9 steps/s
[Step=45550 Epoch=174.5] | Loss=0.00046 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.798 | L2-Norm(final)=16.782 | 2155.7 samples/s | 33.7 steps/s
[Step=45600 Epoch=174.7] | Loss=0.00043 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.796 | L2-Norm(final)=16.782 | 4646.1 samples/s | 72.6 steps/s
[Step=45650 Epoch=174.9] | Loss=0.00042 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.794 | L2-Norm(final)=16.783 | 4610.0 samples/s | 72.0 steps/s
[Step=45700 Epoch=175.1] | Loss=0.00040 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.792 | L2-Norm(final)=16.783 | 4631.4 samples/s | 72.4 steps/s
[Step=45750 Epoch=175.3] | Loss=0.00038 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.790 | L2-Norm(final)=16.784 | 4665.2 samples/s | 72.9 steps/s
[Step=45800 Epoch=175.5] | Loss=0.00037 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.788 | L2-Norm(final)=16.784 | 6207.9 samples/s | 97.0 steps/s
[Step=45850 Epoch=175.7] | Loss=0.00035 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.786 | L2-Norm(final)=16.785 | 1923.9 samples/s | 30.1 steps/s
[Step=45900 Epoch=175.9] | Loss=0.00034 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.784 | L2-Norm(final)=16.785 | 4512.7 samples/s | 70.5 steps/s
[Step=45950 Epoch=176.1] | Loss=0.00033 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.781 | L2-Norm(final)=16.785 | 4664.7 samples/s | 72.9 steps/s
[Step=46000 Epoch=176.3] | Loss=0.00032 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.779 | L2-Norm(final)=16.786 | 4610.7 samples/s | 72.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step46000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=44001 Epoch=169.4] | Loss=0.00182 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.686 | L2-Norm(final)=16.292 | 4370.0 samples/s | 68.3 steps/s
[Step=44050 Epoch=169.6] | Loss=0.00014 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.683 | L2-Norm(final)=16.301 | 4888.9 samples/s | 76.4 steps/s
[Step=44100 Epoch=169.8] | Loss=0.00014 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.682 | L2-Norm(final)=16.310 | 5370.1 samples/s | 83.9 steps/s
[Step=44150 Epoch=170.0] | Loss=0.00012 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.682 | L2-Norm(final)=16.318 | 4991.8 samples/s | 78.0 steps/s
[Step=44200 Epoch=170.1] | Loss=0.00012 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.682 | L2-Norm(final)=16.327 | 5270.3 samples/s | 82.3 steps/s
[Step=44250 Epoch=170.3] | Loss=0.00012 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.682 | L2-Norm(final)=16.334 | 6677.6 samples/s | 104.3 steps/s
[Step=44300 Epoch=170.5] | Loss=0.00012 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.682 | L2-Norm(final)=16.342 | 2034.4 samples/s | 31.8 steps/s
[Step=44350 Epoch=170.7] | Loss=0.00011 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.682 | L2-Norm(final)=16.349 | 5140.6 samples/s | 80.3 steps/s
[Step=44400 Epoch=170.9] | Loss=0.00011 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.682 | L2-Norm(final)=16.356 | 5115.1 samples/s | 79.9 steps/s
[Step=44450 Epoch=171.1] | Loss=0.00011 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.682 | L2-Norm(final)=16.363 | 5233.5 samples/s | 81.8 steps/s
[Step=44500 Epoch=171.3] | Loss=0.00011 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.682 | L2-Norm(final)=16.370 | 5857.6 samples/s | 91.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=44501 Epoch=171.3] | Loss=0.00008 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.682 | L2-Norm(final)=16.434 | 4173.0 samples/s | 65.2 steps/s
[Step=44550 Epoch=171.5] | Loss=0.00002 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=16.437 | 4457.0 samples/s | 69.6 steps/s
[Step=44600 Epoch=171.7] | Loss=0.00002 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.663 | L2-Norm(final)=16.438 | 4633.0 samples/s | 72.4 steps/s
[Step=44650 Epoch=171.9] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.648 | L2-Norm(final)=16.439 | 4655.8 samples/s | 72.7 steps/s
[Step=44700 Epoch=172.1] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.632 | L2-Norm(final)=16.440 | 4603.8 samples/s | 71.9 steps/s
[Step=44750 Epoch=172.3] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.615 | L2-Norm(final)=16.440 | 5900.8 samples/s | 92.2 steps/s
[Step=44800 Epoch=172.5] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.598 | L2-Norm(final)=16.441 | 1930.1 samples/s | 30.2 steps/s
[Step=44850 Epoch=172.6] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.580 | L2-Norm(final)=16.441 | 4558.7 samples/s | 71.2 steps/s
[Step=44900 Epoch=172.8] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.563 | L2-Norm(final)=16.441 | 4511.2 samples/s | 70.5 steps/s
[Step=44950 Epoch=173.0] | Loss=0.00001 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.545 | L2-Norm(final)=16.442 | 4606.6 samples/s | 72.0 steps/s
[Step=45000 Epoch=173.2] | Loss=0.00000 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.527 | L2-Norm(final)=16.442 | 5118.8 samples/s | 80.0 steps/s
[Step=45050 Epoch=173.4] | Loss=0.00000 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.510 | L2-Norm(final)=16.442 | 2032.1 samples/s | 31.8 steps/s
[Step=45100 Epoch=173.6] | Loss=0.00000 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.492 | L2-Norm(final)=16.443 | 4610.3 samples/s | 72.0 steps/s
[Step=45150 Epoch=173.8] | Loss=0.00000 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.474 | L2-Norm(final)=16.443 | 4462.9 samples/s | 69.7 steps/s
[Step=45200 Epoch=174.0] | Loss=0.00000 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.457 | L2-Norm(final)=16.443 | 4441.4 samples/s | 69.4 steps/s
[Step=45250 Epoch=174.2] | Loss=0.00000 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=16.444 | 4647.2 samples/s | 72.6 steps/s
[Step=45300 Epoch=174.4] | Loss=0.00000 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.421 | L2-Norm(final)=16.444 | 2134.0 samples/s | 33.3 steps/s
[Step=45350 Epoch=174.6] | Loss=0.00000 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.403 | L2-Norm(final)=16.444 | 4562.2 samples/s | 71.3 steps/s
[Step=45400 Epoch=174.8] | Loss=0.00000 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.385 | L2-Norm(final)=16.445 | 4499.4 samples/s | 70.3 steps/s
[Step=45450 Epoch=175.0] | Loss=0.00000 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.366 | L2-Norm(final)=16.445 | 4485.4 samples/s | 70.1 steps/s
[Step=45500 Epoch=175.1] | Loss=0.00000 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.348 | L2-Norm(final)=16.445 | 4569.8 samples/s | 71.4 steps/s
[Step=45550 Epoch=175.3] | Loss=0.00000 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.330 | L2-Norm(final)=16.446 | 2111.5 samples/s | 33.0 steps/s
[Step=45600 Epoch=175.5] | Loss=0.00000 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=16.446 | 4641.2 samples/s | 72.5 steps/s
[Step=45650 Epoch=175.7] | Loss=0.00000 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=16.447 | 4468.0 samples/s | 69.8 steps/s
[Step=45700 Epoch=175.9] | Loss=0.00000 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.274 | L2-Norm(final)=16.447 | 4459.1 samples/s | 69.7 steps/s
[Step=45750 Epoch=176.1] | Loss=0.00000 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.255 | L2-Norm(final)=16.447 | 4486.3 samples/s | 70.1 steps/s
[Step=45800 Epoch=176.3] | Loss=0.00000 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=16.448 | 6638.5 samples/s | 103.7 steps/s
[Step=45850 Epoch=176.5] | Loss=0.00000 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.217 | L2-Norm(final)=16.448 | 1864.4 samples/s | 29.1 steps/s
[Step=45900 Epoch=176.7] | Loss=0.00000 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.197 | L2-Norm(final)=16.449 | 4538.8 samples/s | 70.9 steps/s
[Step=45950 Epoch=176.9] | Loss=0.00000 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=16.449 | 4484.9 samples/s | 70.1 steps/s
[Step=46000 Epoch=177.1] | Loss=0.00000 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=16.450 | 4536.7 samples/s | 70.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step46000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07187 | acc=0.9701 | tpr=0.9766 | fpr=0.0441 | 4359.9 samples/s | 17.0 steps/s
Avg test loss: 0.06885, Avg test acc: 0.97139, Avg tpr: 0.97803, Avg fpr: 0.04320, total FA: 337

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07453 | acc=0.9715 | tpr=0.9798 | fpr=0.0466 | 4339.0 samples/s | 16.9 steps/s
Avg test loss: 0.07308, Avg test acc: 0.97151, Avg tpr: 0.98012, Avg fpr: 0.04743, total FA: 370

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=8.33125 | acc=0.3152 | tpr=0.0141 | fpr=0.0312 | 4471.2 samples/s | 17.5 steps/s
Avg test loss: 8.34111, Avg test acc: 0.31341, Avg tpr: 0.01480, Avg fpr: 0.02987, total FA: 233

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.31519 | acc=0.2967 | tpr=0.0204 | fpr=0.1033 | 4362.5 samples/s | 17.0 steps/s
Avg test loss: 6.33374, Avg test acc: 0.29365, Avg tpr: 0.02017, Avg fpr: 0.10486, total FA: 818

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.71087 | acc=0.1130 | tpr=0.7345 | fpr=0.8981 | 4494.7 samples/s | 17.6 steps/s
[Step= 100] | Loss=6.67542 | acc=0.1132 | tpr=0.7122 | fpr=0.8979 | 8137.9 samples/s | 31.8 steps/s
[Step= 150] | Loss=6.69468 | acc=0.1115 | tpr=0.7075 | fpr=0.8995 | 8410.4 samples/s | 32.9 steps/s
[Step= 200] | Loss=6.68966 | acc=0.1113 | tpr=0.6984 | fpr=0.8994 | 8547.5 samples/s | 33.4 steps/s
[Step= 250] | Loss=6.70083 | acc=0.1110 | tpr=0.6934 | fpr=0.8996 | 8301.3 samples/s | 32.4 steps/s
[Step= 300] | Loss=6.69567 | acc=0.1110 | tpr=0.6960 | fpr=0.8997 | 8372.9 samples/s | 32.7 steps/s
[Step= 350] | Loss=6.69687 | acc=0.1103 | tpr=0.6932 | fpr=0.9003 | 8337.9 samples/s | 32.6 steps/s
[Step= 400] | Loss=6.70504 | acc=0.1101 | tpr=0.6926 | fpr=0.9005 | 8179.2 samples/s | 32.0 steps/s
[Step= 450] | Loss=6.70730 | acc=0.1104 | tpr=0.6952 | fpr=0.9002 | 8680.5 samples/s | 33.9 steps/s
[Step= 500] | Loss=6.70725 | acc=0.1104 | tpr=0.6987 | fpr=0.9002 | 8133.6 samples/s | 31.8 steps/s
[Step= 550] | Loss=6.71386 | acc=0.1102 | tpr=0.6956 | fpr=0.9004 | 15215.6 samples/s | 59.4 steps/s
Avg test loss: 6.71398, Avg test acc: 0.11012, Avg tpr: 0.69572, Avg fpr: 0.90052, total FA: 125036

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.37751 | acc=0.1179 | tpr=0.7389 | fpr=0.8933 | 4333.8 samples/s | 16.9 steps/s
[Step= 100] | Loss=7.35164 | acc=0.1181 | tpr=0.7335 | fpr=0.8934 | 8568.8 samples/s | 33.5 steps/s
[Step= 150] | Loss=7.36356 | acc=0.1170 | tpr=0.7277 | fpr=0.8943 | 8415.5 samples/s | 32.9 steps/s
[Step= 200] | Loss=7.35865 | acc=0.1166 | tpr=0.7246 | fpr=0.8944 | 8231.8 samples/s | 32.2 steps/s
[Step= 250] | Loss=7.37047 | acc=0.1164 | tpr=0.7240 | fpr=0.8946 | 8527.5 samples/s | 33.3 steps/s
[Step= 300] | Loss=7.36441 | acc=0.1163 | tpr=0.7251 | fpr=0.8948 | 8392.9 samples/s | 32.8 steps/s
[Step= 350] | Loss=7.36100 | acc=0.1153 | tpr=0.7245 | fpr=0.8958 | 8279.0 samples/s | 32.3 steps/s
[Step= 400] | Loss=7.36864 | acc=0.1154 | tpr=0.7237 | fpr=0.8956 | 8495.6 samples/s | 33.2 steps/s
[Step= 450] | Loss=7.36944 | acc=0.1156 | tpr=0.7278 | fpr=0.8955 | 8800.0 samples/s | 34.4 steps/s
[Step= 500] | Loss=7.36854 | acc=0.1157 | tpr=0.7278 | fpr=0.8953 | 7843.6 samples/s | 30.6 steps/s
[Step= 550] | Loss=7.37349 | acc=0.1154 | tpr=0.7266 | fpr=0.8957 | 15436.4 samples/s | 60.3 steps/s
Avg test loss: 7.37327, Avg test acc: 0.11536, Avg tpr: 0.72623, Avg fpr: 0.89575, total FA: 124373

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.19523 | acc=0.9815 | tpr=0.9204 | fpr=0.0174 | 4427.8 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.21116 | acc=0.9814 | tpr=0.9403 | fpr=0.0179 | 8447.6 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.22064 | acc=0.9806 | tpr=0.9481 | fpr=0.0188 | 8036.8 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.22219 | acc=0.9804 | tpr=0.9508 | fpr=0.0191 | 8363.6 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.21784 | acc=0.9806 | tpr=0.9502 | fpr=0.0189 | 8420.0 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.22089 | acc=0.9804 | tpr=0.9513 | fpr=0.0190 | 8384.4 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.22359 | acc=0.9801 | tpr=0.9505 | fpr=0.0194 | 8458.3 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.22582 | acc=0.9799 | tpr=0.9497 | fpr=0.0196 | 8546.1 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.22976 | acc=0.9796 | tpr=0.9494 | fpr=0.0199 | 8107.0 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.22873 | acc=0.9797 | tpr=0.9493 | fpr=0.0198 | 7955.2 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.22715 | acc=0.9798 | tpr=0.9475 | fpr=0.0196 | 15276.2 samples/s | 59.7 steps/s
Avg test loss: 0.22650, Avg test acc: 0.97981, Avg tpr: 0.94731, Avg fpr: 0.01960, total FA: 2721

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13323 | acc=0.9822 | tpr=0.9513 | fpr=0.0173 | 4481.6 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.14207 | acc=0.9819 | tpr=0.9638 | fpr=0.0177 | 8307.0 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.14687 | acc=0.9811 | tpr=0.9683 | fpr=0.0186 | 8277.5 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.14725 | acc=0.9813 | tpr=0.9705 | fpr=0.0185 | 8277.4 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.14664 | acc=0.9812 | tpr=0.9686 | fpr=0.0186 | 8256.0 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.14763 | acc=0.9811 | tpr=0.9695 | fpr=0.0187 | 8200.6 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.14945 | acc=0.9808 | tpr=0.9693 | fpr=0.0189 | 8520.3 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.15167 | acc=0.9806 | tpr=0.9683 | fpr=0.0192 | 8224.0 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.15442 | acc=0.9804 | tpr=0.9664 | fpr=0.0194 | 8471.6 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.15445 | acc=0.9802 | tpr=0.9656 | fpr=0.0195 | 8354.6 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.15365 | acc=0.9803 | tpr=0.9622 | fpr=0.0194 | 14654.4 samples/s | 57.2 steps/s
Avg test loss: 0.15331, Avg test acc: 0.98033, Avg tpr: 0.96236, Avg fpr: 0.01934, total FA: 2686

server round 23/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=46001 Epoch=89.7] | Loss=0.01985 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.431 | L2-Norm(final)=14.836 | 4243.0 samples/s | 66.3 steps/s
[Step=46050 Epoch=89.8] | Loss=0.00950 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.432 | L2-Norm(final)=14.839 | 5223.5 samples/s | 81.6 steps/s
[Step=46100 Epoch=89.9] | Loss=0.00962 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.433 | L2-Norm(final)=14.845 | 5457.1 samples/s | 85.3 steps/s
[Step=46150 Epoch=90.0] | Loss=0.00954 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.433 | L2-Norm(final)=14.851 | 5463.4 samples/s | 85.4 steps/s
[Step=46200 Epoch=90.1] | Loss=0.00933 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.433 | L2-Norm(final)=14.858 | 5472.3 samples/s | 85.5 steps/s
[Step=46250 Epoch=90.2] | Loss=0.00917 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.433 | L2-Norm(final)=14.865 | 5456.6 samples/s | 85.3 steps/s
[Step=46300 Epoch=90.3] | Loss=0.00933 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.433 | L2-Norm(final)=14.872 | 5470.1 samples/s | 85.5 steps/s
[Step=46350 Epoch=90.4] | Loss=0.00938 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.433 | L2-Norm(final)=14.878 | 5473.3 samples/s | 85.5 steps/s
[Step=46400 Epoch=90.5] | Loss=0.00946 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.433 | L2-Norm(final)=14.885 | 5513.7 samples/s | 86.2 steps/s
[Step=46450 Epoch=90.6] | Loss=0.00956 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.433 | L2-Norm(final)=14.891 | 5431.8 samples/s | 84.9 steps/s
[Step=46500 Epoch=90.7] | Loss=0.00953 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.433 | L2-Norm(final)=14.897 | 6953.0 samples/s | 108.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=46501 Epoch=90.7] | Loss=0.00204 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.433 | L2-Norm(final)=14.958 | 3875.2 samples/s | 60.5 steps/s
[Step=46550 Epoch=90.8] | Loss=0.00962 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.460 | L2-Norm(final)=14.960 | 4844.5 samples/s | 75.7 steps/s
[Step=46600 Epoch=90.9] | Loss=0.01114 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.480 | L2-Norm(final)=14.958 | 4659.1 samples/s | 72.8 steps/s
[Step=46650 Epoch=91.0] | Loss=0.01131 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=14.953 | 4771.3 samples/s | 74.6 steps/s
[Step=46700 Epoch=91.1] | Loss=0.01136 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.508 | L2-Norm(final)=14.951 | 4748.4 samples/s | 74.2 steps/s
[Step=46750 Epoch=91.2] | Loss=0.01192 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.519 | L2-Norm(final)=14.952 | 4806.5 samples/s | 75.1 steps/s
[Step=46800 Epoch=91.3] | Loss=0.01164 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.528 | L2-Norm(final)=14.952 | 4768.1 samples/s | 74.5 steps/s
[Step=46850 Epoch=91.4] | Loss=0.01149 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=14.953 | 4769.5 samples/s | 74.5 steps/s
[Step=46900 Epoch=91.5] | Loss=0.01117 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.543 | L2-Norm(final)=14.955 | 4837.3 samples/s | 75.6 steps/s
[Step=46950 Epoch=91.6] | Loss=0.01116 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=14.956 | 4764.4 samples/s | 74.4 steps/s
[Step=47000 Epoch=91.7] | Loss=0.01100 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.557 | L2-Norm(final)=14.958 | 5845.5 samples/s | 91.3 steps/s
[Step=47050 Epoch=91.8] | Loss=0.01091 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.563 | L2-Norm(final)=14.959 | 1946.5 samples/s | 30.4 steps/s
[Step=47100 Epoch=91.9] | Loss=0.01063 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.569 | L2-Norm(final)=14.961 | 4844.6 samples/s | 75.7 steps/s
[Step=47150 Epoch=92.0] | Loss=0.01039 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.574 | L2-Norm(final)=14.962 | 4820.7 samples/s | 75.3 steps/s
[Step=47200 Epoch=92.1] | Loss=0.01043 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.579 | L2-Norm(final)=14.964 | 4779.5 samples/s | 74.7 steps/s
[Step=47250 Epoch=92.2] | Loss=0.01027 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.584 | L2-Norm(final)=14.965 | 4807.8 samples/s | 75.1 steps/s
[Step=47300 Epoch=92.3] | Loss=0.01016 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.588 | L2-Norm(final)=14.966 | 4814.3 samples/s | 75.2 steps/s
[Step=47350 Epoch=92.4] | Loss=0.00995 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.592 | L2-Norm(final)=14.967 | 4823.3 samples/s | 75.4 steps/s
[Step=47400 Epoch=92.4] | Loss=0.00975 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.596 | L2-Norm(final)=14.968 | 4764.5 samples/s | 74.4 steps/s
[Step=47450 Epoch=92.5] | Loss=0.00967 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.600 | L2-Norm(final)=14.969 | 4751.0 samples/s | 74.2 steps/s
[Step=47500 Epoch=92.6] | Loss=0.00942 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.604 | L2-Norm(final)=14.971 | 5012.7 samples/s | 78.3 steps/s
[Step=47550 Epoch=92.7] | Loss=0.00932 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.607 | L2-Norm(final)=14.972 | 2058.9 samples/s | 32.2 steps/s
[Step=47600 Epoch=92.8] | Loss=0.00916 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.611 | L2-Norm(final)=14.973 | 4868.6 samples/s | 76.1 steps/s
[Step=47650 Epoch=92.9] | Loss=0.00909 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.614 | L2-Norm(final)=14.974 | 4693.4 samples/s | 73.3 steps/s
[Step=47700 Epoch=93.0] | Loss=0.00900 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.617 | L2-Norm(final)=14.976 | 4724.9 samples/s | 73.8 steps/s
[Step=47750 Epoch=93.1] | Loss=0.00893 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.620 | L2-Norm(final)=14.977 | 4736.4 samples/s | 74.0 steps/s
[Step=47800 Epoch=93.2] | Loss=0.00889 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.623 | L2-Norm(final)=14.978 | 4738.7 samples/s | 74.0 steps/s
[Step=47850 Epoch=93.3] | Loss=0.00886 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.625 | L2-Norm(final)=14.979 | 4761.9 samples/s | 74.4 steps/s
[Step=47900 Epoch=93.4] | Loss=0.00879 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=14.980 | 4770.8 samples/s | 74.5 steps/s
[Step=47950 Epoch=93.5] | Loss=0.00866 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.631 | L2-Norm(final)=14.981 | 4735.4 samples/s | 74.0 steps/s
[Step=48000 Epoch=93.6] | Loss=0.00861 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.633 | L2-Norm(final)=14.983 | 4825.2 samples/s | 75.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step48000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=46001 Epoch=89.9] | Loss=0.01375 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.431 | L2-Norm(final)=15.263 | 4164.6 samples/s | 65.1 steps/s
[Step=46050 Epoch=90.0] | Loss=0.01146 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.432 | L2-Norm(final)=15.263 | 5478.7 samples/s | 85.6 steps/s
[Step=46100 Epoch=90.1] | Loss=0.00961 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.432 | L2-Norm(final)=15.266 | 5644.6 samples/s | 88.2 steps/s
[Step=46150 Epoch=90.2] | Loss=0.01004 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.432 | L2-Norm(final)=15.271 | 5569.0 samples/s | 87.0 steps/s
[Step=46200 Epoch=90.3] | Loss=0.01005 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.432 | L2-Norm(final)=15.276 | 5594.1 samples/s | 87.4 steps/s
[Step=46250 Epoch=90.4] | Loss=0.01023 | Reg=0.00155 | acc=0.9531 | L2-Norm=12.432 | L2-Norm(final)=15.284 | 5786.6 samples/s | 90.4 steps/s
[Step=46300 Epoch=90.5] | Loss=0.01019 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.432 | L2-Norm(final)=15.290 | 5681.2 samples/s | 88.8 steps/s
[Step=46350 Epoch=90.6] | Loss=0.00994 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.432 | L2-Norm(final)=15.297 | 5494.0 samples/s | 85.8 steps/s
[Step=46400 Epoch=90.7] | Loss=0.00986 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.432 | L2-Norm(final)=15.303 | 5702.5 samples/s | 89.1 steps/s
[Step=46450 Epoch=90.8] | Loss=0.01007 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.432 | L2-Norm(final)=15.310 | 5595.6 samples/s | 87.4 steps/s
[Step=46500 Epoch=90.9] | Loss=0.00996 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.432 | L2-Norm(final)=15.315 | 7164.0 samples/s | 111.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=46501 Epoch=90.9] | Loss=0.00789 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.432 | L2-Norm(final)=15.367 | 4403.4 samples/s | 68.8 steps/s
[Step=46550 Epoch=91.0] | Loss=0.00904 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.455 | L2-Norm(final)=15.367 | 4665.4 samples/s | 72.9 steps/s
[Step=46600 Epoch=91.1] | Loss=0.00978 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.472 | L2-Norm(final)=15.367 | 4743.8 samples/s | 74.1 steps/s
[Step=46650 Epoch=91.2] | Loss=0.01035 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.487 | L2-Norm(final)=15.367 | 4734.2 samples/s | 74.0 steps/s
[Step=46700 Epoch=91.3] | Loss=0.01142 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.499 | L2-Norm(final)=15.368 | 4668.5 samples/s | 72.9 steps/s
[Step=46750 Epoch=91.4] | Loss=0.01115 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.509 | L2-Norm(final)=15.368 | 4765.3 samples/s | 74.5 steps/s
[Step=46800 Epoch=91.5] | Loss=0.01107 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.518 | L2-Norm(final)=15.368 | 4806.5 samples/s | 75.1 steps/s
[Step=46850 Epoch=91.6] | Loss=0.01073 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.526 | L2-Norm(final)=15.368 | 4888.4 samples/s | 76.4 steps/s
[Step=46900 Epoch=91.7] | Loss=0.01067 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.533 | L2-Norm(final)=15.368 | 4822.5 samples/s | 75.4 steps/s
[Step=46950 Epoch=91.8] | Loss=0.01068 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.539 | L2-Norm(final)=15.368 | 4734.6 samples/s | 74.0 steps/s
[Step=47000 Epoch=91.9] | Loss=0.01056 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.545 | L2-Norm(final)=15.368 | 5897.3 samples/s | 92.1 steps/s
[Step=47050 Epoch=92.0] | Loss=0.01031 | Reg=0.00158 | acc=0.9688 | L2-Norm=12.551 | L2-Norm(final)=15.369 | 1997.9 samples/s | 31.2 steps/s
[Step=47100 Epoch=92.1] | Loss=0.01008 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.556 | L2-Norm(final)=15.369 | 4755.4 samples/s | 74.3 steps/s
[Step=47150 Epoch=92.2] | Loss=0.00995 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.561 | L2-Norm(final)=15.370 | 4811.8 samples/s | 75.2 steps/s
[Step=47200 Epoch=92.3] | Loss=0.00994 | Reg=0.00158 | acc=0.9688 | L2-Norm=12.565 | L2-Norm(final)=15.371 | 4826.1 samples/s | 75.4 steps/s
[Step=47250 Epoch=92.4] | Loss=0.00978 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.570 | L2-Norm(final)=15.371 | 4750.5 samples/s | 74.2 steps/s
[Step=47300 Epoch=92.5] | Loss=0.00991 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.574 | L2-Norm(final)=15.372 | 4753.4 samples/s | 74.3 steps/s
[Step=47350 Epoch=92.6] | Loss=0.00978 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.578 | L2-Norm(final)=15.372 | 4707.1 samples/s | 73.5 steps/s
[Step=47400 Epoch=92.7] | Loss=0.00965 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.582 | L2-Norm(final)=15.372 | 4781.3 samples/s | 74.7 steps/s
[Step=47450 Epoch=92.8] | Loss=0.00946 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.586 | L2-Norm(final)=15.373 | 4728.6 samples/s | 73.9 steps/s
[Step=47500 Epoch=92.9] | Loss=0.00938 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.590 | L2-Norm(final)=15.374 | 5170.7 samples/s | 80.8 steps/s
[Step=47550 Epoch=93.0] | Loss=0.00921 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.593 | L2-Norm(final)=15.374 | 2129.6 samples/s | 33.3 steps/s
[Step=47600 Epoch=93.1] | Loss=0.00908 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.597 | L2-Norm(final)=15.375 | 4902.5 samples/s | 76.6 steps/s
[Step=47650 Epoch=93.2] | Loss=0.00896 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.601 | L2-Norm(final)=15.376 | 4908.1 samples/s | 76.7 steps/s
[Step=47700 Epoch=93.3] | Loss=0.00889 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.604 | L2-Norm(final)=15.377 | 4831.0 samples/s | 75.5 steps/s
[Step=47750 Epoch=93.4] | Loss=0.00889 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.607 | L2-Norm(final)=15.378 | 4871.8 samples/s | 76.1 steps/s
[Step=47800 Epoch=93.4] | Loss=0.00880 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.610 | L2-Norm(final)=15.379 | 4919.1 samples/s | 76.9 steps/s
[Step=47850 Epoch=93.5] | Loss=0.00871 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.614 | L2-Norm(final)=15.380 | 4894.2 samples/s | 76.5 steps/s
[Step=47900 Epoch=93.6] | Loss=0.00859 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.617 | L2-Norm(final)=15.381 | 4898.7 samples/s | 76.5 steps/s
[Step=47950 Epoch=93.7] | Loss=0.00850 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.620 | L2-Norm(final)=15.382 | 4882.9 samples/s | 76.3 steps/s
[Step=48000 Epoch=93.8] | Loss=0.00850 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.622 | L2-Norm(final)=15.383 | 4965.7 samples/s | 77.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step48000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=46001 Epoch=176.3] | Loss=0.00008 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.431 | L2-Norm(final)=16.799 | 4166.0 samples/s | 65.1 steps/s
[Step=46050 Epoch=176.4] | Loss=0.00011 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=16.796 | 5049.8 samples/s | 78.9 steps/s
[Step=46100 Epoch=176.6] | Loss=0.00014 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=16.796 | 5057.0 samples/s | 79.0 steps/s
[Step=46150 Epoch=176.8] | Loss=0.00013 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=16.796 | 5157.7 samples/s | 80.6 steps/s
[Step=46200 Epoch=177.0] | Loss=0.00011 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=16.797 | 5100.3 samples/s | 79.7 steps/s
[Step=46250 Epoch=177.2] | Loss=0.00010 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=16.798 | 6817.0 samples/s | 106.5 steps/s
[Step=46300 Epoch=177.4] | Loss=0.00009 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=16.799 | 2025.6 samples/s | 31.6 steps/s
[Step=46350 Epoch=177.6] | Loss=0.00008 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=16.800 | 5175.8 samples/s | 80.9 steps/s
[Step=46400 Epoch=177.8] | Loss=0.00008 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=16.801 | 5137.2 samples/s | 80.3 steps/s
[Step=46450 Epoch=178.0] | Loss=0.00008 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=16.802 | 5157.6 samples/s | 80.6 steps/s
[Step=46500 Epoch=178.2] | Loss=0.00009 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=16.804 | 5778.1 samples/s | 90.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=46501 Epoch=178.2] | Loss=0.00031 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=16.817 | 4108.9 samples/s | 64.2 steps/s
[Step=46550 Epoch=178.4] | Loss=0.00004 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.429 | L2-Norm(final)=16.818 | 4614.9 samples/s | 72.1 steps/s
[Step=46600 Epoch=178.6] | Loss=0.00003 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.427 | L2-Norm(final)=16.819 | 4644.5 samples/s | 72.6 steps/s
[Step=46650 Epoch=178.7] | Loss=0.00002 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.424 | L2-Norm(final)=16.820 | 4600.9 samples/s | 71.9 steps/s
[Step=46700 Epoch=178.9] | Loss=0.00002 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=16.821 | 4612.1 samples/s | 72.1 steps/s
[Step=46750 Epoch=179.1] | Loss=0.00002 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=16.821 | 5806.7 samples/s | 90.7 steps/s
[Step=46800 Epoch=179.3] | Loss=0.00001 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.412 | L2-Norm(final)=16.822 | 1957.0 samples/s | 30.6 steps/s
[Step=46850 Epoch=179.5] | Loss=0.00001 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.407 | L2-Norm(final)=16.822 | 4518.9 samples/s | 70.6 steps/s
[Step=46900 Epoch=179.7] | Loss=0.00001 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.402 | L2-Norm(final)=16.823 | 4586.4 samples/s | 71.7 steps/s
[Step=46950 Epoch=179.9] | Loss=0.00001 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=16.823 | 4536.2 samples/s | 70.9 steps/s
[Step=47000 Epoch=180.1] | Loss=0.00001 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.393 | L2-Norm(final)=16.823 | 4917.9 samples/s | 76.8 steps/s
[Step=47050 Epoch=180.3] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.388 | L2-Norm(final)=16.824 | 2049.0 samples/s | 32.0 steps/s
[Step=47100 Epoch=180.5] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.383 | L2-Norm(final)=16.824 | 4566.9 samples/s | 71.4 steps/s
[Step=47150 Epoch=180.7] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.378 | L2-Norm(final)=16.824 | 4455.9 samples/s | 69.6 steps/s
[Step=47200 Epoch=180.9] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=16.825 | 4485.6 samples/s | 70.1 steps/s
[Step=47250 Epoch=181.0] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.368 | L2-Norm(final)=16.825 | 4527.7 samples/s | 70.7 steps/s
[Step=47300 Epoch=181.2] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.363 | L2-Norm(final)=16.825 | 2139.6 samples/s | 33.4 steps/s
[Step=47350 Epoch=181.4] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.357 | L2-Norm(final)=16.826 | 4717.3 samples/s | 73.7 steps/s
[Step=47400 Epoch=181.6] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.352 | L2-Norm(final)=16.826 | 4551.4 samples/s | 71.1 steps/s
[Step=47450 Epoch=181.8] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.347 | L2-Norm(final)=16.826 | 4504.0 samples/s | 70.4 steps/s
[Step=47500 Epoch=182.0] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.342 | L2-Norm(final)=16.827 | 4486.2 samples/s | 70.1 steps/s
[Step=47550 Epoch=182.2] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.336 | L2-Norm(final)=16.827 | 2149.4 samples/s | 33.6 steps/s
[Step=47600 Epoch=182.4] | Loss=0.00000 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.331 | L2-Norm(final)=16.827 | 4548.0 samples/s | 71.1 steps/s
[Step=47650 Epoch=182.6] | Loss=0.00000 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.326 | L2-Norm(final)=16.827 | 4445.9 samples/s | 69.5 steps/s
[Step=47700 Epoch=182.8] | Loss=0.00000 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.320 | L2-Norm(final)=16.828 | 4586.2 samples/s | 71.7 steps/s
[Step=47750 Epoch=183.0] | Loss=0.00000 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=16.828 | 4441.9 samples/s | 69.4 steps/s
[Step=47800 Epoch=183.2] | Loss=0.00000 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.309 | L2-Norm(final)=16.828 | 6138.1 samples/s | 95.9 steps/s
[Step=47850 Epoch=183.3] | Loss=0.00000 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=16.829 | 1888.7 samples/s | 29.5 steps/s
[Step=47900 Epoch=183.5] | Loss=0.00000 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.298 | L2-Norm(final)=16.829 | 4531.6 samples/s | 70.8 steps/s
[Step=47950 Epoch=183.7] | Loss=0.00000 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=16.829 | 4571.5 samples/s | 71.4 steps/s
[Step=48000 Epoch=183.9] | Loss=0.00000 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.286 | L2-Norm(final)=16.829 | 4598.1 samples/s | 71.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step48000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=46001 Epoch=177.1] | Loss=0.00009 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.431 | L2-Norm(final)=16.463 | 4358.4 samples/s | 68.1 steps/s
[Step=46050 Epoch=177.3] | Loss=0.00005 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.424 | L2-Norm(final)=16.470 | 4826.8 samples/s | 75.4 steps/s
[Step=46100 Epoch=177.5] | Loss=0.00007 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.424 | L2-Norm(final)=16.480 | 5140.6 samples/s | 80.3 steps/s
[Step=46150 Epoch=177.6] | Loss=0.00009 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.423 | L2-Norm(final)=16.493 | 5084.4 samples/s | 79.4 steps/s
[Step=46200 Epoch=177.8] | Loss=0.00010 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.423 | L2-Norm(final)=16.505 | 5182.2 samples/s | 81.0 steps/s
[Step=46250 Epoch=178.0] | Loss=0.00009 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.423 | L2-Norm(final)=16.518 | 6788.2 samples/s | 106.1 steps/s
[Step=46300 Epoch=178.2] | Loss=0.00009 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.423 | L2-Norm(final)=16.530 | 2035.2 samples/s | 31.8 steps/s
[Step=46350 Epoch=178.4] | Loss=0.00008 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.423 | L2-Norm(final)=16.542 | 5086.2 samples/s | 79.5 steps/s
[Step=46400 Epoch=178.6] | Loss=0.00008 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.423 | L2-Norm(final)=16.552 | 5183.7 samples/s | 81.0 steps/s
[Step=46450 Epoch=178.8] | Loss=0.00009 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.423 | L2-Norm(final)=16.562 | 5167.3 samples/s | 80.7 steps/s
[Step=46500 Epoch=179.0] | Loss=0.00009 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.423 | L2-Norm(final)=16.573 | 5920.3 samples/s | 92.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=46501 Epoch=179.0] | Loss=0.00025 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.423 | L2-Norm(final)=16.675 | 4262.4 samples/s | 66.6 steps/s
[Step=46550 Epoch=179.2] | Loss=0.00003 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.402 | L2-Norm(final)=16.680 | 4388.5 samples/s | 68.6 steps/s
[Step=46600 Epoch=179.4] | Loss=0.00004 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.376 | L2-Norm(final)=16.682 | 4518.1 samples/s | 70.6 steps/s
[Step=46650 Epoch=179.6] | Loss=0.00034 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.369 | L2-Norm(final)=16.680 | 4552.7 samples/s | 71.1 steps/s
[Step=46700 Epoch=179.8] | Loss=0.00167 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.382 | L2-Norm(final)=16.675 | 4449.1 samples/s | 69.5 steps/s
[Step=46750 Epoch=180.0] | Loss=0.00200 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.401 | L2-Norm(final)=16.668 | 5745.6 samples/s | 89.8 steps/s
[Step=46800 Epoch=180.2] | Loss=0.00178 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=16.662 | 1927.4 samples/s | 30.1 steps/s
[Step=46850 Epoch=180.3] | Loss=0.00153 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.432 | L2-Norm(final)=16.658 | 4470.4 samples/s | 69.8 steps/s
[Step=46900 Epoch=180.5] | Loss=0.00134 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.441 | L2-Norm(final)=16.655 | 4579.0 samples/s | 71.5 steps/s
[Step=46950 Epoch=180.7] | Loss=0.00120 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.447 | L2-Norm(final)=16.653 | 4406.9 samples/s | 68.9 steps/s
[Step=47000 Epoch=180.9] | Loss=0.00108 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.451 | L2-Norm(final)=16.651 | 5067.2 samples/s | 79.2 steps/s
[Step=47050 Epoch=181.1] | Loss=0.00098 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=16.650 | 2007.2 samples/s | 31.4 steps/s
[Step=47100 Epoch=181.3] | Loss=0.00090 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.456 | L2-Norm(final)=16.649 | 4536.6 samples/s | 70.9 steps/s
[Step=47150 Epoch=181.5] | Loss=0.00083 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.458 | L2-Norm(final)=16.648 | 4529.9 samples/s | 70.8 steps/s
[Step=47200 Epoch=181.7] | Loss=0.00077 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.458 | L2-Norm(final)=16.648 | 4520.9 samples/s | 70.6 steps/s
[Step=47250 Epoch=181.9] | Loss=0.00072 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.458 | L2-Norm(final)=16.648 | 4624.7 samples/s | 72.3 steps/s
[Step=47300 Epoch=182.1] | Loss=0.00068 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.458 | L2-Norm(final)=16.648 | 2141.0 samples/s | 33.5 steps/s
[Step=47350 Epoch=182.3] | Loss=0.00064 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.458 | L2-Norm(final)=16.647 | 4698.3 samples/s | 73.4 steps/s
[Step=47400 Epoch=182.5] | Loss=0.00060 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.457 | L2-Norm(final)=16.647 | 4629.2 samples/s | 72.3 steps/s
[Step=47450 Epoch=182.7] | Loss=0.00057 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.456 | L2-Norm(final)=16.647 | 4500.5 samples/s | 70.3 steps/s
[Step=47500 Epoch=182.8] | Loss=0.00054 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=16.648 | 4503.4 samples/s | 70.4 steps/s
[Step=47550 Epoch=183.0] | Loss=0.00052 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.453 | L2-Norm(final)=16.648 | 2134.7 samples/s | 33.4 steps/s
[Step=47600 Epoch=183.2] | Loss=0.00049 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.451 | L2-Norm(final)=16.648 | 4500.0 samples/s | 70.3 steps/s
[Step=47650 Epoch=183.4] | Loss=0.00047 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.449 | L2-Norm(final)=16.648 | 4481.5 samples/s | 70.0 steps/s
[Step=47700 Epoch=183.6] | Loss=0.00045 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.447 | L2-Norm(final)=16.649 | 4559.2 samples/s | 71.2 steps/s
[Step=47750 Epoch=183.8] | Loss=0.00044 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.445 | L2-Norm(final)=16.649 | 4438.2 samples/s | 69.3 steps/s
[Step=47800 Epoch=184.0] | Loss=0.00042 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.443 | L2-Norm(final)=16.650 | 6593.5 samples/s | 103.0 steps/s
[Step=47850 Epoch=184.2] | Loss=0.00040 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.441 | L2-Norm(final)=16.650 | 1894.0 samples/s | 29.6 steps/s
[Step=47900 Epoch=184.4] | Loss=0.00039 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=16.651 | 4600.9 samples/s | 71.9 steps/s
[Step=47950 Epoch=184.6] | Loss=0.00038 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.436 | L2-Norm(final)=16.651 | 4696.7 samples/s | 73.4 steps/s
[Step=48000 Epoch=184.8] | Loss=0.00036 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.434 | L2-Norm(final)=16.652 | 4521.0 samples/s | 70.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step48000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07398 | acc=0.9694 | tpr=0.9774 | fpr=0.0481 | 4416.1 samples/s | 17.3 steps/s
Avg test loss: 0.07224, Avg test acc: 0.97027, Avg tpr: 0.97820, Avg fpr: 0.04717, total FA: 368

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06501 | acc=0.9717 | tpr=0.9773 | fpr=0.0404 | 4378.2 samples/s | 17.1 steps/s
Avg test loss: 0.06484, Avg test acc: 0.97235, Avg tpr: 0.97820, Avg fpr: 0.04051, total FA: 316

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.10451 | acc=0.3050 | tpr=0.0189 | fpr=0.0738 | 4398.8 samples/s | 17.2 steps/s
Avg test loss: 6.11218, Avg test acc: 0.30339, Avg tpr: 0.01964, Avg fpr: 0.07255, total FA: 566

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=8.44577 | acc=0.3122 | tpr=0.0144 | fpr=0.0411 | 4449.1 samples/s | 17.4 steps/s
Avg test loss: 8.48056, Avg test acc: 0.30964, Avg tpr: 0.01323, Avg fpr: 0.03846, total FA: 300

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.62638 | acc=0.1164 | tpr=0.7743 | fpr=0.8954 | 4373.7 samples/s | 17.1 steps/s
[Step= 100] | Loss=6.59162 | acc=0.1168 | tpr=0.7612 | fpr=0.8952 | 8277.8 samples/s | 32.3 steps/s
[Step= 150] | Loss=6.61296 | acc=0.1153 | tpr=0.7522 | fpr=0.8964 | 8333.2 samples/s | 32.6 steps/s
[Step= 200] | Loss=6.61050 | acc=0.1151 | tpr=0.7432 | fpr=0.8963 | 8052.9 samples/s | 31.5 steps/s
[Step= 250] | Loss=6.62247 | acc=0.1148 | tpr=0.7424 | fpr=0.8967 | 7630.6 samples/s | 29.8 steps/s
[Step= 300] | Loss=6.61900 | acc=0.1143 | tpr=0.7375 | fpr=0.8971 | 7118.0 samples/s | 27.8 steps/s
[Step= 350] | Loss=6.61954 | acc=0.1137 | tpr=0.7358 | fpr=0.8976 | 6495.7 samples/s | 25.4 steps/s
[Step= 400] | Loss=6.62688 | acc=0.1136 | tpr=0.7380 | fpr=0.8977 | 6960.5 samples/s | 27.2 steps/s
[Step= 450] | Loss=6.62902 | acc=0.1138 | tpr=0.7395 | fpr=0.8976 | 7464.6 samples/s | 29.2 steps/s
[Step= 500] | Loss=6.62809 | acc=0.1137 | tpr=0.7396 | fpr=0.8976 | 8134.4 samples/s | 31.8 steps/s
[Step= 550] | Loss=6.63398 | acc=0.1134 | tpr=0.7378 | fpr=0.8979 | 15524.7 samples/s | 60.6 steps/s
Avg test loss: 6.63450, Avg test acc: 0.11333, Avg tpr: 0.73772, Avg fpr: 0.89803, total FA: 124689

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.66786 | acc=0.1217 | tpr=0.7434 | fpr=0.8895 | 4390.5 samples/s | 17.2 steps/s
[Step= 100] | Loss=6.64053 | acc=0.1224 | tpr=0.7484 | fpr=0.8893 | 8376.4 samples/s | 32.7 steps/s
[Step= 150] | Loss=6.65237 | acc=0.1217 | tpr=0.7550 | fpr=0.8900 | 8588.5 samples/s | 33.5 steps/s
[Step= 200] | Loss=6.64811 | acc=0.1217 | tpr=0.7464 | fpr=0.8897 | 8272.0 samples/s | 32.3 steps/s
[Step= 250] | Loss=6.65775 | acc=0.1216 | tpr=0.7476 | fpr=0.8898 | 8467.3 samples/s | 33.1 steps/s
[Step= 300] | Loss=6.65133 | acc=0.1213 | tpr=0.7440 | fpr=0.8900 | 8460.1 samples/s | 33.0 steps/s
[Step= 350] | Loss=6.64944 | acc=0.1204 | tpr=0.7433 | fpr=0.8909 | 8297.7 samples/s | 32.4 steps/s
[Step= 400] | Loss=6.65571 | acc=0.1204 | tpr=0.7412 | fpr=0.8909 | 8434.6 samples/s | 32.9 steps/s
[Step= 450] | Loss=6.65633 | acc=0.1204 | tpr=0.7420 | fpr=0.8909 | 8483.5 samples/s | 33.1 steps/s
[Step= 500] | Loss=6.65560 | acc=0.1204 | tpr=0.7436 | fpr=0.8909 | 8038.8 samples/s | 31.4 steps/s
[Step= 550] | Loss=6.66026 | acc=0.1201 | tpr=0.7398 | fpr=0.8911 | 15176.0 samples/s | 59.3 steps/s
Avg test loss: 6.66013, Avg test acc: 0.12004, Avg tpr: 0.73930, Avg fpr: 0.89121, total FA: 123743

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13786 | acc=0.9825 | tpr=0.9381 | fpr=0.0167 | 4407.2 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.14878 | acc=0.9819 | tpr=0.9531 | fpr=0.0176 | 8436.8 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.15390 | acc=0.9812 | tpr=0.9597 | fpr=0.0184 | 8330.2 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.15381 | acc=0.9813 | tpr=0.9617 | fpr=0.0183 | 8335.4 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.15205 | acc=0.9814 | tpr=0.9607 | fpr=0.0182 | 8155.1 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.15315 | acc=0.9813 | tpr=0.9615 | fpr=0.0184 | 8396.2 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.15487 | acc=0.9810 | tpr=0.9618 | fpr=0.0186 | 8541.2 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.15662 | acc=0.9808 | tpr=0.9612 | fpr=0.0188 | 8020.3 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.15912 | acc=0.9805 | tpr=0.9606 | fpr=0.0191 | 8441.9 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.15891 | acc=0.9805 | tpr=0.9599 | fpr=0.0191 | 8154.5 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.15809 | acc=0.9806 | tpr=0.9566 | fpr=0.0190 | 14836.1 samples/s | 58.0 steps/s
Avg test loss: 0.15766, Avg test acc: 0.98060, Avg tpr: 0.95681, Avg fpr: 0.01896, total FA: 2633

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16784 | acc=0.9800 | tpr=0.9336 | fpr=0.0192 | 4382.7 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.18042 | acc=0.9799 | tpr=0.9552 | fpr=0.0197 | 8443.0 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.18667 | acc=0.9791 | tpr=0.9597 | fpr=0.0206 | 8317.0 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.18917 | acc=0.9788 | tpr=0.9617 | fpr=0.0209 | 8440.4 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.18630 | acc=0.9790 | tpr=0.9624 | fpr=0.0207 | 8479.0 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.18908 | acc=0.9786 | tpr=0.9622 | fpr=0.0211 | 8239.4 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.19068 | acc=0.9784 | tpr=0.9643 | fpr=0.0213 | 8370.1 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.19322 | acc=0.9781 | tpr=0.9612 | fpr=0.0215 | 8348.0 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.19600 | acc=0.9778 | tpr=0.9606 | fpr=0.0219 | 8407.3 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.19495 | acc=0.9778 | tpr=0.9599 | fpr=0.0219 | 7894.2 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.19361 | acc=0.9778 | tpr=0.9570 | fpr=0.0218 | 15453.0 samples/s | 60.4 steps/s
Avg test loss: 0.19312, Avg test acc: 0.97785, Avg tpr: 0.95721, Avg fpr: 0.02177, total FA: 3023

server round 24/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=48001 Epoch=93.6] | Loss=0.01926 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.372 | L2-Norm(final)=15.026 | 4129.4 samples/s | 64.5 steps/s
[Step=48050 Epoch=93.7] | Loss=0.01063 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=15.031 | 5122.8 samples/s | 80.0 steps/s
[Step=48100 Epoch=93.8] | Loss=0.01085 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=15.037 | 5511.5 samples/s | 86.1 steps/s
[Step=48150 Epoch=93.9] | Loss=0.01063 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=15.043 | 5429.2 samples/s | 84.8 steps/s
[Step=48200 Epoch=94.0] | Loss=0.01028 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=15.051 | 5589.1 samples/s | 87.3 steps/s
[Step=48250 Epoch=94.1] | Loss=0.01032 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.374 | L2-Norm(final)=15.057 | 5389.0 samples/s | 84.2 steps/s
[Step=48300 Epoch=94.2] | Loss=0.01031 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.374 | L2-Norm(final)=15.064 | 5595.1 samples/s | 87.4 steps/s
[Step=48350 Epoch=94.3] | Loss=0.01044 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.374 | L2-Norm(final)=15.070 | 5402.2 samples/s | 84.4 steps/s
[Step=48400 Epoch=94.4] | Loss=0.01047 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.374 | L2-Norm(final)=15.077 | 5513.0 samples/s | 86.1 steps/s
[Step=48450 Epoch=94.5] | Loss=0.01042 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.374 | L2-Norm(final)=15.083 | 5404.7 samples/s | 84.4 steps/s
[Step=48500 Epoch=94.6] | Loss=0.01027 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.374 | L2-Norm(final)=15.090 | 6919.5 samples/s | 108.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=48501 Epoch=94.6] | Loss=0.00181 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.374 | L2-Norm(final)=15.157 | 4160.2 samples/s | 65.0 steps/s
[Step=48550 Epoch=94.7] | Loss=0.00912 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.393 | L2-Norm(final)=15.164 | 4547.0 samples/s | 71.0 steps/s
[Step=48600 Epoch=94.8] | Loss=0.00893 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.410 | L2-Norm(final)=15.167 | 4771.0 samples/s | 74.5 steps/s
[Step=48650 Epoch=94.9] | Loss=0.01005 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.422 | L2-Norm(final)=15.168 | 4707.1 samples/s | 73.5 steps/s
[Step=48700 Epoch=95.0] | Loss=0.01021 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.433 | L2-Norm(final)=15.169 | 4825.4 samples/s | 75.4 steps/s
[Step=48750 Epoch=95.1] | Loss=0.01026 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.443 | L2-Norm(final)=15.170 | 4823.8 samples/s | 75.4 steps/s
[Step=48800 Epoch=95.2] | Loss=0.01082 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.453 | L2-Norm(final)=15.171 | 4787.3 samples/s | 74.8 steps/s
[Step=48850 Epoch=95.3] | Loss=0.01112 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.461 | L2-Norm(final)=15.171 | 4757.0 samples/s | 74.3 steps/s
[Step=48900 Epoch=95.4] | Loss=0.01103 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.469 | L2-Norm(final)=15.172 | 4752.4 samples/s | 74.3 steps/s
[Step=48950 Epoch=95.5] | Loss=0.01083 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.476 | L2-Norm(final)=15.173 | 4727.4 samples/s | 73.9 steps/s
[Step=49000 Epoch=95.6] | Loss=0.01068 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=15.174 | 5783.1 samples/s | 90.4 steps/s
[Step=49050 Epoch=95.7] | Loss=0.01033 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.488 | L2-Norm(final)=15.176 | 1929.8 samples/s | 30.2 steps/s
[Step=49100 Epoch=95.8] | Loss=0.01007 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.493 | L2-Norm(final)=15.177 | 4832.0 samples/s | 75.5 steps/s
[Step=49150 Epoch=95.9] | Loss=0.01005 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.498 | L2-Norm(final)=15.179 | 4885.7 samples/s | 76.3 steps/s
[Step=49200 Epoch=96.0] | Loss=0.00993 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.503 | L2-Norm(final)=15.180 | 4972.7 samples/s | 77.7 steps/s
[Step=49250 Epoch=96.1] | Loss=0.00978 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.507 | L2-Norm(final)=15.181 | 4881.4 samples/s | 76.3 steps/s
[Step=49300 Epoch=96.2] | Loss=0.00962 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.511 | L2-Norm(final)=15.183 | 4887.1 samples/s | 76.4 steps/s
[Step=49350 Epoch=96.3] | Loss=0.00943 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.515 | L2-Norm(final)=15.184 | 4845.2 samples/s | 75.7 steps/s
[Step=49400 Epoch=96.3] | Loss=0.00932 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.519 | L2-Norm(final)=15.185 | 4812.0 samples/s | 75.2 steps/s
[Step=49450 Epoch=96.4] | Loss=0.00921 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.523 | L2-Norm(final)=15.187 | 4815.4 samples/s | 75.2 steps/s
[Step=49500 Epoch=96.5] | Loss=0.00910 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.527 | L2-Norm(final)=15.188 | 5080.5 samples/s | 79.4 steps/s
[Step=49550 Epoch=96.6] | Loss=0.00907 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=15.189 | 2059.3 samples/s | 32.2 steps/s
[Step=49600 Epoch=96.7] | Loss=0.00887 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.534 | L2-Norm(final)=15.191 | 4895.5 samples/s | 76.5 steps/s
[Step=49650 Epoch=96.8] | Loss=0.00875 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.538 | L2-Norm(final)=15.192 | 4904.8 samples/s | 76.6 steps/s
[Step=49700 Epoch=96.9] | Loss=0.00860 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.541 | L2-Norm(final)=15.193 | 4807.6 samples/s | 75.1 steps/s
[Step=49750 Epoch=97.0] | Loss=0.00860 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.545 | L2-Norm(final)=15.195 | 4835.6 samples/s | 75.6 steps/s
[Step=49800 Epoch=97.1] | Loss=0.00860 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.548 | L2-Norm(final)=15.196 | 4835.6 samples/s | 75.6 steps/s
[Step=49850 Epoch=97.2] | Loss=0.00851 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.551 | L2-Norm(final)=15.197 | 4671.1 samples/s | 73.0 steps/s
[Step=49900 Epoch=97.3] | Loss=0.00847 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.555 | L2-Norm(final)=15.198 | 4748.6 samples/s | 74.2 steps/s
[Step=49950 Epoch=97.4] | Loss=0.00848 | Reg=0.00158 | acc=0.9688 | L2-Norm=12.558 | L2-Norm(final)=15.200 | 4825.0 samples/s | 75.4 steps/s
[Step=50000 Epoch=97.5] | Loss=0.00855 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.561 | L2-Norm(final)=15.201 | 4789.8 samples/s | 74.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step50000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=48001 Epoch=93.8] | Loss=0.00613 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.372 | L2-Norm(final)=15.408 | 4020.2 samples/s | 62.8 steps/s
[Step=48050 Epoch=93.9] | Loss=0.00972 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.373 | L2-Norm(final)=15.414 | 5799.1 samples/s | 90.6 steps/s
[Step=48100 Epoch=94.0] | Loss=0.01046 | Reg=0.00153 | acc=0.9688 | L2-Norm=12.373 | L2-Norm(final)=15.424 | 5761.1 samples/s | 90.0 steps/s
[Step=48150 Epoch=94.1] | Loss=0.01101 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.373 | L2-Norm(final)=15.433 | 5450.3 samples/s | 85.2 steps/s
[Step=48200 Epoch=94.2] | Loss=0.01098 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=15.442 | 5667.6 samples/s | 88.6 steps/s
[Step=48250 Epoch=94.3] | Loss=0.01082 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=15.451 | 5626.8 samples/s | 87.9 steps/s
[Step=48300 Epoch=94.4] | Loss=0.01065 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=15.459 | 5779.7 samples/s | 90.3 steps/s
[Step=48350 Epoch=94.5] | Loss=0.01059 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=15.467 | 5429.7 samples/s | 84.8 steps/s
[Step=48400 Epoch=94.6] | Loss=0.01045 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=15.475 | 5435.0 samples/s | 84.9 steps/s
[Step=48450 Epoch=94.7] | Loss=0.01035 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=15.484 | 5460.3 samples/s | 85.3 steps/s
[Step=48500 Epoch=94.8] | Loss=0.01032 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=15.493 | 7141.8 samples/s | 111.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=48501 Epoch=94.8] | Loss=0.00229 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=15.581 | 4439.8 samples/s | 69.4 steps/s
[Step=48550 Epoch=94.9] | Loss=0.01177 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.401 | L2-Norm(final)=15.585 | 4637.5 samples/s | 72.5 steps/s
[Step=48600 Epoch=95.0] | Loss=0.01093 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.420 | L2-Norm(final)=15.582 | 4732.6 samples/s | 73.9 steps/s
[Step=48650 Epoch=95.1] | Loss=0.01034 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.433 | L2-Norm(final)=15.582 | 4802.4 samples/s | 75.0 steps/s
[Step=48700 Epoch=95.2] | Loss=0.01140 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.444 | L2-Norm(final)=15.582 | 4763.1 samples/s | 74.4 steps/s
[Step=48750 Epoch=95.3] | Loss=0.01192 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.454 | L2-Norm(final)=15.582 | 4796.5 samples/s | 74.9 steps/s
[Step=48800 Epoch=95.4] | Loss=0.01181 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.463 | L2-Norm(final)=15.582 | 4697.3 samples/s | 73.4 steps/s
[Step=48850 Epoch=95.5] | Loss=0.01152 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.471 | L2-Norm(final)=15.583 | 4770.8 samples/s | 74.5 steps/s
[Step=48900 Epoch=95.6] | Loss=0.01147 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.478 | L2-Norm(final)=15.584 | 4791.3 samples/s | 74.9 steps/s
[Step=48950 Epoch=95.7] | Loss=0.01128 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.486 | L2-Norm(final)=15.585 | 4753.4 samples/s | 74.3 steps/s
[Step=49000 Epoch=95.8] | Loss=0.01103 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.493 | L2-Norm(final)=15.586 | 5798.7 samples/s | 90.6 steps/s
[Step=49050 Epoch=95.9] | Loss=0.01107 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.499 | L2-Norm(final)=15.587 | 2054.3 samples/s | 32.1 steps/s
[Step=49100 Epoch=96.0] | Loss=0.01077 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.505 | L2-Norm(final)=15.587 | 4853.1 samples/s | 75.8 steps/s
[Step=49150 Epoch=96.1] | Loss=0.01045 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.511 | L2-Norm(final)=15.588 | 4874.1 samples/s | 76.2 steps/s
[Step=49200 Epoch=96.2] | Loss=0.01019 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.516 | L2-Norm(final)=15.589 | 4851.7 samples/s | 75.8 steps/s
[Step=49250 Epoch=96.3] | Loss=0.01015 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.521 | L2-Norm(final)=15.590 | 4921.3 samples/s | 76.9 steps/s
[Step=49300 Epoch=96.4] | Loss=0.01004 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.526 | L2-Norm(final)=15.591 | 4937.2 samples/s | 77.1 steps/s
[Step=49350 Epoch=96.5] | Loss=0.00989 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.531 | L2-Norm(final)=15.592 | 4858.7 samples/s | 75.9 steps/s
[Step=49400 Epoch=96.6] | Loss=0.00969 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.535 | L2-Norm(final)=15.593 | 4911.9 samples/s | 76.7 steps/s
[Step=49450 Epoch=96.7] | Loss=0.00953 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.539 | L2-Norm(final)=15.594 | 4905.4 samples/s | 76.6 steps/s
[Step=49500 Epoch=96.8] | Loss=0.00941 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.543 | L2-Norm(final)=15.595 | 5314.5 samples/s | 83.0 steps/s
[Step=49550 Epoch=96.9] | Loss=0.00947 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.547 | L2-Norm(final)=15.596 | 2121.3 samples/s | 33.1 steps/s
[Step=49600 Epoch=97.0] | Loss=0.00932 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=15.597 | 4802.6 samples/s | 75.0 steps/s
[Step=49650 Epoch=97.1] | Loss=0.00919 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.554 | L2-Norm(final)=15.598 | 4723.1 samples/s | 73.8 steps/s
[Step=49700 Epoch=97.2] | Loss=0.00918 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.558 | L2-Norm(final)=15.599 | 4802.1 samples/s | 75.0 steps/s
[Step=49750 Epoch=97.3] | Loss=0.00901 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.561 | L2-Norm(final)=15.600 | 4667.3 samples/s | 72.9 steps/s
[Step=49800 Epoch=97.4] | Loss=0.00891 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.564 | L2-Norm(final)=15.601 | 4766.7 samples/s | 74.5 steps/s
[Step=49850 Epoch=97.5] | Loss=0.00883 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.567 | L2-Norm(final)=15.603 | 4729.1 samples/s | 73.9 steps/s
[Step=49900 Epoch=97.6] | Loss=0.00875 | Reg=0.00158 | acc=0.9688 | L2-Norm=12.571 | L2-Norm(final)=15.604 | 4784.3 samples/s | 74.8 steps/s
[Step=49950 Epoch=97.7] | Loss=0.00872 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.573 | L2-Norm(final)=15.605 | 4775.5 samples/s | 74.6 steps/s
[Step=50000 Epoch=97.7] | Loss=0.00874 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.576 | L2-Norm(final)=15.606 | 4814.3 samples/s | 75.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step50000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=48001 Epoch=183.9] | Loss=0.00000 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.372 | L2-Norm(final)=16.837 | 4543.4 samples/s | 71.0 steps/s
[Step=48050 Epoch=184.1] | Loss=0.00010 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.370 | L2-Norm(final)=16.844 | 4949.0 samples/s | 77.3 steps/s
[Step=48100 Epoch=184.3] | Loss=0.00010 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.370 | L2-Norm(final)=16.849 | 5196.9 samples/s | 81.2 steps/s
[Step=48150 Epoch=184.5] | Loss=0.00019 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.369 | L2-Norm(final)=16.855 | 5220.2 samples/s | 81.6 steps/s
[Step=48200 Epoch=184.7] | Loss=0.00017 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.369 | L2-Norm(final)=16.862 | 5089.9 samples/s | 79.5 steps/s
[Step=48250 Epoch=184.9] | Loss=0.00016 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.369 | L2-Norm(final)=16.868 | 6729.6 samples/s | 105.2 steps/s
[Step=48300 Epoch=185.1] | Loss=0.00014 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.369 | L2-Norm(final)=16.874 | 2069.5 samples/s | 32.3 steps/s
[Step=48350 Epoch=185.3] | Loss=0.00013 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.369 | L2-Norm(final)=16.879 | 5139.1 samples/s | 80.3 steps/s
[Step=48400 Epoch=185.5] | Loss=0.00016 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.369 | L2-Norm(final)=16.884 | 5150.5 samples/s | 80.5 steps/s
[Step=48450 Epoch=185.6] | Loss=0.00015 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.369 | L2-Norm(final)=16.890 | 5254.0 samples/s | 82.1 steps/s
[Step=48500 Epoch=185.8] | Loss=0.00015 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.369 | L2-Norm(final)=16.895 | 5765.8 samples/s | 90.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=48501 Epoch=185.8] | Loss=0.00003 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.369 | L2-Norm(final)=16.949 | 4394.1 samples/s | 68.7 steps/s
[Step=48550 Epoch=186.0] | Loss=0.00095 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.381 | L2-Norm(final)=16.951 | 4157.8 samples/s | 65.0 steps/s
[Step=48600 Epoch=186.2] | Loss=0.00054 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.405 | L2-Norm(final)=16.952 | 4493.6 samples/s | 70.2 steps/s
[Step=48650 Epoch=186.4] | Loss=0.00043 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.415 | L2-Norm(final)=16.954 | 4549.1 samples/s | 71.1 steps/s
[Step=48700 Epoch=186.6] | Loss=0.00033 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=16.955 | 4453.1 samples/s | 69.6 steps/s
[Step=48750 Epoch=186.8] | Loss=0.00026 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=16.955 | 5651.5 samples/s | 88.3 steps/s
[Step=48800 Epoch=187.0] | Loss=0.00022 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.418 | L2-Norm(final)=16.956 | 1972.5 samples/s | 30.8 steps/s
[Step=48850 Epoch=187.2] | Loss=0.00019 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.415 | L2-Norm(final)=16.957 | 4551.6 samples/s | 71.1 steps/s
[Step=48900 Epoch=187.4] | Loss=0.00017 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.411 | L2-Norm(final)=16.957 | 4532.8 samples/s | 70.8 steps/s
[Step=48950 Epoch=187.6] | Loss=0.00015 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.407 | L2-Norm(final)=16.958 | 4563.9 samples/s | 71.3 steps/s
[Step=49000 Epoch=187.8] | Loss=0.00013 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.403 | L2-Norm(final)=16.958 | 4984.9 samples/s | 77.9 steps/s
[Step=49050 Epoch=187.9] | Loss=0.00012 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=16.959 | 2075.3 samples/s | 32.4 steps/s
[Step=49100 Epoch=188.1] | Loss=0.00011 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.393 | L2-Norm(final)=16.959 | 4559.2 samples/s | 71.2 steps/s
[Step=49150 Epoch=188.3] | Loss=0.00010 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.388 | L2-Norm(final)=16.960 | 4544.3 samples/s | 71.0 steps/s
[Step=49200 Epoch=188.5] | Loss=0.00010 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.383 | L2-Norm(final)=16.960 | 4501.7 samples/s | 70.3 steps/s
[Step=49250 Epoch=188.7] | Loss=0.00009 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.378 | L2-Norm(final)=16.960 | 4552.0 samples/s | 71.1 steps/s
[Step=49300 Epoch=188.9] | Loss=0.00008 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=16.961 | 2135.0 samples/s | 33.4 steps/s
[Step=49350 Epoch=189.1] | Loss=0.00008 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.367 | L2-Norm(final)=16.961 | 4776.0 samples/s | 74.6 steps/s
[Step=49400 Epoch=189.3] | Loss=0.00007 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.362 | L2-Norm(final)=16.962 | 4614.4 samples/s | 72.1 steps/s
[Step=49450 Epoch=189.5] | Loss=0.00007 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.356 | L2-Norm(final)=16.962 | 4676.0 samples/s | 73.1 steps/s
[Step=49500 Epoch=189.7] | Loss=0.00007 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.351 | L2-Norm(final)=16.963 | 4608.5 samples/s | 72.0 steps/s
[Step=49550 Epoch=189.9] | Loss=0.00006 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.345 | L2-Norm(final)=16.963 | 2174.2 samples/s | 34.0 steps/s
[Step=49600 Epoch=190.0] | Loss=0.00006 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.339 | L2-Norm(final)=16.964 | 4592.6 samples/s | 71.8 steps/s
[Step=49650 Epoch=190.2] | Loss=0.00006 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.333 | L2-Norm(final)=16.964 | 4482.9 samples/s | 70.0 steps/s
[Step=49700 Epoch=190.4] | Loss=0.00006 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.327 | L2-Norm(final)=16.965 | 4463.8 samples/s | 69.7 steps/s
[Step=49750 Epoch=190.6] | Loss=0.00005 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.321 | L2-Norm(final)=16.966 | 4553.0 samples/s | 71.1 steps/s
[Step=49800 Epoch=190.8] | Loss=0.00005 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=16.966 | 6199.2 samples/s | 96.9 steps/s
[Step=49850 Epoch=191.0] | Loss=0.00005 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.309 | L2-Norm(final)=16.967 | 1922.9 samples/s | 30.0 steps/s
[Step=49900 Epoch=191.2] | Loss=0.00005 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=16.968 | 4508.5 samples/s | 70.4 steps/s
[Step=49950 Epoch=191.4] | Loss=0.00005 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=16.968 | 4582.0 samples/s | 71.6 steps/s
[Step=50000 Epoch=191.6] | Loss=0.00005 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=16.969 | 4661.3 samples/s | 72.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step50000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=48001 Epoch=184.8] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.372 | L2-Norm(final)=16.671 | 4517.6 samples/s | 70.6 steps/s
[Step=48050 Epoch=185.0] | Loss=0.00007 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=16.674 | 4758.3 samples/s | 74.3 steps/s
[Step=48100 Epoch=185.2] | Loss=0.00007 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=16.679 | 5218.3 samples/s | 81.5 steps/s
[Step=48150 Epoch=185.3] | Loss=0.00006 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=16.684 | 5085.9 samples/s | 79.5 steps/s
[Step=48200 Epoch=185.5] | Loss=0.00006 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=16.688 | 5090.6 samples/s | 79.5 steps/s
[Step=48250 Epoch=185.7] | Loss=0.00006 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=16.693 | 6937.4 samples/s | 108.4 steps/s
[Step=48300 Epoch=185.9] | Loss=0.00006 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=16.696 | 2017.5 samples/s | 31.5 steps/s
[Step=48350 Epoch=186.1] | Loss=0.00007 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=16.700 | 5242.9 samples/s | 81.9 steps/s
[Step=48400 Epoch=186.3] | Loss=0.00007 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=16.704 | 5103.6 samples/s | 79.7 steps/s
[Step=48450 Epoch=186.5] | Loss=0.00006 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=16.708 | 5160.7 samples/s | 80.6 steps/s
[Step=48500 Epoch=186.7] | Loss=0.00006 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=16.712 | 5972.3 samples/s | 93.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=48501 Epoch=186.7] | Loss=0.00002 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=16.749 | 4235.2 samples/s | 66.2 steps/s
[Step=48550 Epoch=186.9] | Loss=0.00003 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.369 | L2-Norm(final)=16.751 | 4428.5 samples/s | 69.2 steps/s
[Step=48600 Epoch=187.1] | Loss=0.00002 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.365 | L2-Norm(final)=16.753 | 4513.6 samples/s | 70.5 steps/s
[Step=48650 Epoch=187.3] | Loss=0.00002 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.360 | L2-Norm(final)=16.756 | 4477.0 samples/s | 70.0 steps/s
[Step=48700 Epoch=187.5] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.355 | L2-Norm(final)=16.758 | 4498.3 samples/s | 70.3 steps/s
[Step=48750 Epoch=187.7] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.349 | L2-Norm(final)=16.761 | 5768.0 samples/s | 90.1 steps/s
[Step=48800 Epoch=187.9] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.343 | L2-Norm(final)=16.763 | 1933.2 samples/s | 30.2 steps/s
[Step=48850 Epoch=188.0] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.338 | L2-Norm(final)=16.765 | 4522.8 samples/s | 70.7 steps/s
[Step=48900 Epoch=188.2] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.332 | L2-Norm(final)=16.767 | 4623.6 samples/s | 72.2 steps/s
[Step=48950 Epoch=188.4] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.326 | L2-Norm(final)=16.769 | 4470.9 samples/s | 69.9 steps/s
[Step=49000 Epoch=188.6] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.321 | L2-Norm(final)=16.770 | 5156.8 samples/s | 80.6 steps/s
[Step=49050 Epoch=188.8] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=16.772 | 2071.5 samples/s | 32.4 steps/s
[Step=49100 Epoch=189.0] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.309 | L2-Norm(final)=16.773 | 4550.4 samples/s | 71.1 steps/s
[Step=49150 Epoch=189.2] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=16.775 | 4685.9 samples/s | 73.2 steps/s
[Step=49200 Epoch=189.4] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.298 | L2-Norm(final)=16.776 | 4605.8 samples/s | 72.0 steps/s
[Step=49250 Epoch=189.6] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=16.777 | 4687.9 samples/s | 73.2 steps/s
[Step=49300 Epoch=189.8] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=16.779 | 2168.1 samples/s | 33.9 steps/s
[Step=49350 Epoch=190.0] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.281 | L2-Norm(final)=16.780 | 4568.3 samples/s | 71.4 steps/s
[Step=49400 Epoch=190.2] | Loss=0.00000 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.276 | L2-Norm(final)=16.781 | 4385.9 samples/s | 68.5 steps/s
[Step=49450 Epoch=190.4] | Loss=0.00000 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.270 | L2-Norm(final)=16.782 | 4499.0 samples/s | 70.3 steps/s
[Step=49500 Epoch=190.5] | Loss=0.00000 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.264 | L2-Norm(final)=16.783 | 4515.6 samples/s | 70.6 steps/s
[Step=49550 Epoch=190.7] | Loss=0.00000 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=16.784 | 2160.5 samples/s | 33.8 steps/s
[Step=49600 Epoch=190.9] | Loss=0.00000 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=16.786 | 4641.9 samples/s | 72.5 steps/s
[Step=49650 Epoch=191.1] | Loss=0.00000 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.247 | L2-Norm(final)=16.787 | 4646.7 samples/s | 72.6 steps/s
[Step=49700 Epoch=191.3] | Loss=0.00000 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=16.788 | 4630.8 samples/s | 72.4 steps/s
[Step=49750 Epoch=191.5] | Loss=0.00000 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=16.789 | 4530.4 samples/s | 70.8 steps/s
[Step=49800 Epoch=191.7] | Loss=0.00000 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.230 | L2-Norm(final)=16.790 | 6603.1 samples/s | 103.2 steps/s
[Step=49850 Epoch=191.9] | Loss=0.00000 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.224 | L2-Norm(final)=16.791 | 1861.0 samples/s | 29.1 steps/s
[Step=49900 Epoch=192.1] | Loss=0.00000 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=16.792 | 4628.5 samples/s | 72.3 steps/s
[Step=49950 Epoch=192.3] | Loss=0.00000 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.213 | L2-Norm(final)=16.793 | 4675.9 samples/s | 73.1 steps/s
[Step=50000 Epoch=192.5] | Loss=0.00000 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.207 | L2-Norm(final)=16.794 | 4556.8 samples/s | 71.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step50000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07226 | acc=0.9682 | tpr=0.9724 | fpr=0.0409 | 4474.0 samples/s | 17.5 steps/s
Avg test loss: 0.06944, Avg test acc: 0.96959, Avg tpr: 0.97389, Avg fpr: 0.03987, total FA: 311

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06718 | acc=0.9699 | tpr=0.9751 | fpr=0.0414 | 4424.7 samples/s | 17.3 steps/s
Avg test loss: 0.06808, Avg test acc: 0.97035, Avg tpr: 0.97581, Avg fpr: 0.04166, total FA: 325

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.47950 | acc=0.3095 | tpr=0.0094 | fpr=0.0387 | 4364.6 samples/s | 17.0 steps/s
Avg test loss: 6.50305, Avg test acc: 0.30752, Avg tpr: 0.00927, Avg fpr: 0.03653, total FA: 285

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.22178 | acc=0.2963 | tpr=0.0221 | fpr=0.1083 | 4418.2 samples/s | 17.3 steps/s
Avg test loss: 6.23227, Avg test acc: 0.29349, Avg tpr: 0.02145, Avg fpr: 0.10819, total FA: 844

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.43372 | acc=0.1173 | tpr=0.6858 | fpr=0.8929 | 4395.3 samples/s | 17.2 steps/s
[Step= 100] | Loss=6.39309 | acc=0.1172 | tpr=0.6738 | fpr=0.8932 | 8389.8 samples/s | 32.8 steps/s
[Step= 150] | Loss=6.40542 | acc=0.1162 | tpr=0.6844 | fpr=0.8942 | 8368.4 samples/s | 32.7 steps/s
[Step= 200] | Loss=6.40272 | acc=0.1158 | tpr=0.6710 | fpr=0.8943 | 8340.4 samples/s | 32.6 steps/s
[Step= 250] | Loss=6.41300 | acc=0.1156 | tpr=0.6707 | fpr=0.8945 | 8094.5 samples/s | 31.6 steps/s
[Step= 300] | Loss=6.40658 | acc=0.1154 | tpr=0.6705 | fpr=0.8947 | 8497.3 samples/s | 33.2 steps/s
[Step= 350] | Loss=6.40609 | acc=0.1146 | tpr=0.6706 | fpr=0.8954 | 8355.7 samples/s | 32.6 steps/s
[Step= 400] | Loss=6.41353 | acc=0.1147 | tpr=0.6685 | fpr=0.8953 | 8234.0 samples/s | 32.2 steps/s
[Step= 450] | Loss=6.41603 | acc=0.1149 | tpr=0.6685 | fpr=0.8952 | 8364.1 samples/s | 32.7 steps/s
[Step= 500] | Loss=6.41467 | acc=0.1149 | tpr=0.6714 | fpr=0.8952 | 8186.3 samples/s | 32.0 steps/s
[Step= 550] | Loss=6.42160 | acc=0.1145 | tpr=0.6689 | fpr=0.8955 | 14961.3 samples/s | 58.4 steps/s
Avg test loss: 6.42213, Avg test acc: 0.11443, Avg tpr: 0.66957, Avg fpr: 0.89566, total FA: 124361

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.36293 | acc=0.1312 | tpr=0.7080 | fpr=0.8792 | 4554.8 samples/s | 17.8 steps/s
[Step= 100] | Loss=6.33361 | acc=0.1310 | tpr=0.7164 | fpr=0.8799 | 7950.1 samples/s | 31.1 steps/s
[Step= 150] | Loss=6.34841 | acc=0.1306 | tpr=0.7176 | fpr=0.8802 | 8280.1 samples/s | 32.3 steps/s
[Step= 200] | Loss=6.34041 | acc=0.1309 | tpr=0.7148 | fpr=0.8797 | 8611.7 samples/s | 33.6 steps/s
[Step= 250] | Loss=6.35165 | acc=0.1305 | tpr=0.7205 | fpr=0.8802 | 8177.6 samples/s | 31.9 steps/s
[Step= 300] | Loss=6.34598 | acc=0.1307 | tpr=0.7222 | fpr=0.8801 | 8687.9 samples/s | 33.9 steps/s
[Step= 350] | Loss=6.34094 | acc=0.1302 | tpr=0.7195 | fpr=0.8805 | 8095.9 samples/s | 31.6 steps/s
[Step= 400] | Loss=6.34701 | acc=0.1301 | tpr=0.7194 | fpr=0.8806 | 8248.9 samples/s | 32.2 steps/s
[Step= 450] | Loss=6.34737 | acc=0.1300 | tpr=0.7196 | fpr=0.8807 | 8784.7 samples/s | 34.3 steps/s
[Step= 500] | Loss=6.34717 | acc=0.1299 | tpr=0.7220 | fpr=0.8808 | 8022.1 samples/s | 31.3 steps/s
[Step= 550] | Loss=6.35111 | acc=0.1297 | tpr=0.7159 | fpr=0.8810 | 15035.0 samples/s | 58.7 steps/s
Avg test loss: 6.35097, Avg test acc: 0.12963, Avg tpr: 0.71553, Avg fpr: 0.88102, total FA: 122328

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.14061 | acc=0.9818 | tpr=0.9425 | fpr=0.0175 | 4369.4 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.15151 | acc=0.9812 | tpr=0.9552 | fpr=0.0183 | 8082.9 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.15637 | acc=0.9808 | tpr=0.9597 | fpr=0.0188 | 6823.1 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.15691 | acc=0.9808 | tpr=0.9617 | fpr=0.0188 | 6675.5 samples/s | 26.1 steps/s
[Step= 250] | Loss=0.15456 | acc=0.9811 | tpr=0.9607 | fpr=0.0185 | 7355.6 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.15612 | acc=0.9810 | tpr=0.9607 | fpr=0.0187 | 8678.9 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.15786 | acc=0.9807 | tpr=0.9618 | fpr=0.0190 | 8070.9 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.15942 | acc=0.9806 | tpr=0.9606 | fpr=0.0191 | 8379.4 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.16193 | acc=0.9803 | tpr=0.9591 | fpr=0.0193 | 8339.1 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.16161 | acc=0.9803 | tpr=0.9590 | fpr=0.0193 | 8251.7 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.16053 | acc=0.9803 | tpr=0.9554 | fpr=0.0192 | 14704.5 samples/s | 57.4 steps/s
Avg test loss: 0.16005, Avg test acc: 0.98035, Avg tpr: 0.95563, Avg fpr: 0.01920, total FA: 2666

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14291 | acc=0.9817 | tpr=0.9513 | fpr=0.0177 | 4298.5 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.15337 | acc=0.9809 | tpr=0.9659 | fpr=0.0189 | 8126.3 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.15862 | acc=0.9802 | tpr=0.9697 | fpr=0.0196 | 8046.0 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.15887 | acc=0.9803 | tpr=0.9716 | fpr=0.0195 | 8144.5 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.15702 | acc=0.9803 | tpr=0.9694 | fpr=0.0195 | 8563.7 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.15827 | acc=0.9801 | tpr=0.9695 | fpr=0.0197 | 8384.1 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.15993 | acc=0.9799 | tpr=0.9693 | fpr=0.0199 | 8984.9 samples/s | 35.1 steps/s
[Step= 400] | Loss=0.16203 | acc=0.9796 | tpr=0.9683 | fpr=0.0202 | 8011.8 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.16484 | acc=0.9793 | tpr=0.9669 | fpr=0.0205 | 8200.0 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.16443 | acc=0.9792 | tpr=0.9661 | fpr=0.0206 | 8486.4 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.16350 | acc=0.9793 | tpr=0.9630 | fpr=0.0204 | 14780.9 samples/s | 57.7 steps/s
Avg test loss: 0.16313, Avg test acc: 0.97930, Avg tpr: 0.96315, Avg fpr: 0.02040, total FA: 2833

server round 25/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=50001 Epoch=97.5] | Loss=0.01161 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.282 | L2-Norm(final)=15.233 | 4202.8 samples/s | 65.7 steps/s
[Step=50050 Epoch=97.6] | Loss=0.00832 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.283 | L2-Norm(final)=15.237 | 5448.9 samples/s | 85.1 steps/s
[Step=50100 Epoch=97.7] | Loss=0.00847 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=15.242 | 5353.3 samples/s | 83.6 steps/s
[Step=50150 Epoch=97.8] | Loss=0.00818 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.283 | L2-Norm(final)=15.248 | 5470.8 samples/s | 85.5 steps/s
[Step=50200 Epoch=97.9] | Loss=0.00815 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=15.254 | 5414.9 samples/s | 84.6 steps/s
[Step=50250 Epoch=98.0] | Loss=0.00796 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=15.260 | 5522.2 samples/s | 86.3 steps/s
[Step=50300 Epoch=98.1] | Loss=0.00807 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=15.267 | 5453.8 samples/s | 85.2 steps/s
[Step=50350 Epoch=98.2] | Loss=0.00809 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=15.274 | 5493.8 samples/s | 85.8 steps/s
[Step=50400 Epoch=98.3] | Loss=0.00818 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.283 | L2-Norm(final)=15.280 | 5484.3 samples/s | 85.7 steps/s
[Step=50450 Epoch=98.4] | Loss=0.00847 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=15.285 | 5556.2 samples/s | 86.8 steps/s
[Step=50500 Epoch=98.5] | Loss=0.00854 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=15.290 | 6644.0 samples/s | 103.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=50501 Epoch=98.5] | Loss=0.00133 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=15.338 | 4066.5 samples/s | 63.5 steps/s
[Step=50550 Epoch=98.6] | Loss=0.00842 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=15.340 | 4398.6 samples/s | 68.7 steps/s
[Step=50600 Epoch=98.7] | Loss=0.00954 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.310 | L2-Norm(final)=15.338 | 4710.6 samples/s | 73.6 steps/s
[Step=50650 Epoch=98.8] | Loss=0.01020 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.319 | L2-Norm(final)=15.336 | 4663.3 samples/s | 72.9 steps/s
[Step=50700 Epoch=98.9] | Loss=0.01030 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.326 | L2-Norm(final)=15.335 | 4539.4 samples/s | 70.9 steps/s
[Step=50750 Epoch=99.0] | Loss=0.01045 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.334 | L2-Norm(final)=15.334 | 4657.6 samples/s | 72.8 steps/s
[Step=50800 Epoch=99.1] | Loss=0.01055 | Reg=0.00152 | acc=0.9531 | L2-Norm=12.342 | L2-Norm(final)=15.333 | 4678.1 samples/s | 73.1 steps/s
[Step=50850 Epoch=99.2] | Loss=0.01019 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.349 | L2-Norm(final)=15.333 | 4580.1 samples/s | 71.6 steps/s
[Step=50900 Epoch=99.3] | Loss=0.00993 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.355 | L2-Norm(final)=15.333 | 4654.6 samples/s | 72.7 steps/s
[Step=50950 Epoch=99.4] | Loss=0.00977 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.361 | L2-Norm(final)=15.334 | 4702.0 samples/s | 73.5 steps/s
[Step=51000 Epoch=99.5] | Loss=0.00975 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.366 | L2-Norm(final)=15.334 | 5538.4 samples/s | 86.5 steps/s
[Step=51050 Epoch=99.6] | Loss=0.00971 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.372 | L2-Norm(final)=15.335 | 1891.0 samples/s | 29.5 steps/s
[Step=51100 Epoch=99.7] | Loss=0.00957 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.377 | L2-Norm(final)=15.336 | 4625.4 samples/s | 72.3 steps/s
[Step=51150 Epoch=99.8] | Loss=0.00929 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.382 | L2-Norm(final)=15.336 | 4599.5 samples/s | 71.9 steps/s
[Step=51200 Epoch=99.9] | Loss=0.00916 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.387 | L2-Norm(final)=15.338 | 4718.9 samples/s | 73.7 steps/s
[Step=51250 Epoch=100.0] | Loss=0.00902 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.391 | L2-Norm(final)=15.339 | 4528.8 samples/s | 70.8 steps/s
[Step=51300 Epoch=100.1] | Loss=0.00893 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.396 | L2-Norm(final)=15.340 | 4593.3 samples/s | 71.8 steps/s
[Step=51350 Epoch=100.2] | Loss=0.00891 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.400 | L2-Norm(final)=15.341 | 4669.0 samples/s | 73.0 steps/s
[Step=51400 Epoch=100.2] | Loss=0.00872 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.405 | L2-Norm(final)=15.342 | 4654.1 samples/s | 72.7 steps/s
[Step=51450 Epoch=100.3] | Loss=0.00865 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.409 | L2-Norm(final)=15.343 | 4560.1 samples/s | 71.3 steps/s
[Step=51500 Epoch=100.4] | Loss=0.00860 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.412 | L2-Norm(final)=15.344 | 4898.1 samples/s | 76.5 steps/s
[Step=51550 Epoch=100.5] | Loss=0.00852 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=15.346 | 2055.1 samples/s | 32.1 steps/s
[Step=51600 Epoch=100.6] | Loss=0.00839 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.419 | L2-Norm(final)=15.347 | 4630.0 samples/s | 72.3 steps/s
[Step=51650 Epoch=100.7] | Loss=0.00830 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.423 | L2-Norm(final)=15.348 | 4544.8 samples/s | 71.0 steps/s
[Step=51700 Epoch=100.8] | Loss=0.00818 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.426 | L2-Norm(final)=15.350 | 4602.6 samples/s | 71.9 steps/s
[Step=51750 Epoch=100.9] | Loss=0.00817 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.429 | L2-Norm(final)=15.351 | 4598.8 samples/s | 71.9 steps/s
[Step=51800 Epoch=101.0] | Loss=0.00811 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.432 | L2-Norm(final)=15.352 | 4623.9 samples/s | 72.2 steps/s
[Step=51850 Epoch=101.1] | Loss=0.00804 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.435 | L2-Norm(final)=15.353 | 4541.2 samples/s | 71.0 steps/s
[Step=51900 Epoch=101.2] | Loss=0.00807 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.438 | L2-Norm(final)=15.355 | 4652.1 samples/s | 72.7 steps/s
[Step=51950 Epoch=101.3] | Loss=0.00810 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.441 | L2-Norm(final)=15.355 | 4531.4 samples/s | 70.8 steps/s
[Step=52000 Epoch=101.4] | Loss=0.00812 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.444 | L2-Norm(final)=15.356 | 4702.8 samples/s | 73.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step52000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=50001 Epoch=97.8] | Loss=0.00277 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.282 | L2-Norm(final)=15.633 | 4022.0 samples/s | 62.8 steps/s
[Step=50050 Epoch=97.8] | Loss=0.00838 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=15.633 | 4216.8 samples/s | 65.9 steps/s
[Step=50100 Epoch=97.9] | Loss=0.00797 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.283 | L2-Norm(final)=15.637 | 4560.6 samples/s | 71.3 steps/s
[Step=50150 Epoch=98.0] | Loss=0.00859 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.283 | L2-Norm(final)=15.640 | 4612.0 samples/s | 72.1 steps/s
[Step=50200 Epoch=98.1] | Loss=0.00877 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=15.643 | 4570.8 samples/s | 71.4 steps/s
[Step=50250 Epoch=98.2] | Loss=0.00839 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.283 | L2-Norm(final)=15.647 | 4790.7 samples/s | 74.9 steps/s
[Step=50300 Epoch=98.3] | Loss=0.00821 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=15.651 | 4611.1 samples/s | 72.0 steps/s
[Step=50350 Epoch=98.4] | Loss=0.00840 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.283 | L2-Norm(final)=15.655 | 4785.3 samples/s | 74.8 steps/s
[Step=50400 Epoch=98.5] | Loss=0.00816 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=15.660 | 5192.3 samples/s | 81.1 steps/s
[Step=50450 Epoch=98.6] | Loss=0.00831 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.283 | L2-Norm(final)=15.665 | 5464.2 samples/s | 85.4 steps/s
[Step=50500 Epoch=98.7] | Loss=0.00841 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=15.669 | 7015.9 samples/s | 109.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=50501 Epoch=98.7] | Loss=0.01676 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.283 | L2-Norm(final)=15.719 | 4449.0 samples/s | 69.5 steps/s
[Step=50550 Epoch=98.8] | Loss=0.00840 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=15.723 | 4694.4 samples/s | 73.4 steps/s
[Step=50600 Epoch=98.9] | Loss=0.00993 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.320 | L2-Norm(final)=15.724 | 4792.9 samples/s | 74.9 steps/s
[Step=50650 Epoch=99.0] | Loss=0.01059 | Reg=0.00152 | acc=0.9688 | L2-Norm=12.334 | L2-Norm(final)=15.722 | 4712.8 samples/s | 73.6 steps/s
[Step=50700 Epoch=99.1] | Loss=0.01034 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.346 | L2-Norm(final)=15.720 | 4726.0 samples/s | 73.8 steps/s
[Step=50750 Epoch=99.2] | Loss=0.01078 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.356 | L2-Norm(final)=15.719 | 4852.3 samples/s | 75.8 steps/s
[Step=50800 Epoch=99.3] | Loss=0.01039 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.365 | L2-Norm(final)=15.719 | 4765.6 samples/s | 74.5 steps/s
[Step=50850 Epoch=99.4] | Loss=0.01000 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=15.720 | 4803.5 samples/s | 75.1 steps/s
[Step=50900 Epoch=99.5] | Loss=0.01003 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.380 | L2-Norm(final)=15.721 | 4835.6 samples/s | 75.6 steps/s
[Step=50950 Epoch=99.6] | Loss=0.00990 | Reg=0.00153 | acc=0.9688 | L2-Norm=12.387 | L2-Norm(final)=15.723 | 4759.1 samples/s | 74.4 steps/s
[Step=51000 Epoch=99.7] | Loss=0.01005 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.393 | L2-Norm(final)=15.724 | 5881.5 samples/s | 91.9 steps/s
[Step=51050 Epoch=99.8] | Loss=0.00975 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.399 | L2-Norm(final)=15.725 | 2018.6 samples/s | 31.5 steps/s
[Step=51100 Epoch=99.9] | Loss=0.00955 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.405 | L2-Norm(final)=15.726 | 4725.2 samples/s | 73.8 steps/s
[Step=51150 Epoch=100.0] | Loss=0.00929 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.410 | L2-Norm(final)=15.728 | 4823.3 samples/s | 75.4 steps/s
[Step=51200 Epoch=100.1] | Loss=0.00918 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.415 | L2-Norm(final)=15.729 | 4871.2 samples/s | 76.1 steps/s
[Step=51250 Epoch=100.2] | Loss=0.00894 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.420 | L2-Norm(final)=15.731 | 4842.1 samples/s | 75.7 steps/s
[Step=51300 Epoch=100.3] | Loss=0.00898 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.425 | L2-Norm(final)=15.732 | 4798.9 samples/s | 75.0 steps/s
[Step=51350 Epoch=100.4] | Loss=0.00894 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.429 | L2-Norm(final)=15.734 | 4825.1 samples/s | 75.4 steps/s
[Step=51400 Epoch=100.5] | Loss=0.00888 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.433 | L2-Norm(final)=15.735 | 4703.8 samples/s | 73.5 steps/s
[Step=51450 Epoch=100.6] | Loss=0.00887 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.437 | L2-Norm(final)=15.736 | 4751.1 samples/s | 74.2 steps/s
[Step=51500 Epoch=100.7] | Loss=0.00877 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.441 | L2-Norm(final)=15.737 | 5155.1 samples/s | 80.5 steps/s
[Step=51550 Epoch=100.8] | Loss=0.00864 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.445 | L2-Norm(final)=15.739 | 2146.1 samples/s | 33.5 steps/s
[Step=51600 Epoch=100.9] | Loss=0.00857 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.449 | L2-Norm(final)=15.740 | 4889.4 samples/s | 76.4 steps/s
[Step=51650 Epoch=101.0] | Loss=0.00841 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.453 | L2-Norm(final)=15.742 | 4663.2 samples/s | 72.9 steps/s
[Step=51700 Epoch=101.1] | Loss=0.00840 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.457 | L2-Norm(final)=15.743 | 4762.8 samples/s | 74.4 steps/s
[Step=51750 Epoch=101.2] | Loss=0.00835 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.460 | L2-Norm(final)=15.744 | 4784.4 samples/s | 74.8 steps/s
[Step=51800 Epoch=101.3] | Loss=0.00830 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=15.745 | 4762.1 samples/s | 74.4 steps/s
[Step=51850 Epoch=101.4] | Loss=0.00827 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.467 | L2-Norm(final)=15.746 | 4815.0 samples/s | 75.2 steps/s
[Step=51900 Epoch=101.5] | Loss=0.00823 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.471 | L2-Norm(final)=15.748 | 4818.6 samples/s | 75.3 steps/s
[Step=51950 Epoch=101.6] | Loss=0.00820 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.474 | L2-Norm(final)=15.749 | 4903.8 samples/s | 76.6 steps/s
[Step=52000 Epoch=101.7] | Loss=0.00818 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=15.750 | 4750.6 samples/s | 74.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step52000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=50001 Epoch=191.6] | Loss=0.00011 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.282 | L2-Norm(final)=16.992 | 4560.8 samples/s | 71.3 steps/s
[Step=50050 Epoch=191.8] | Loss=0.00020 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=17.002 | 4802.8 samples/s | 75.0 steps/s
[Step=50100 Epoch=192.0] | Loss=0.00014 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=17.011 | 5114.3 samples/s | 79.9 steps/s
[Step=50150 Epoch=192.2] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=17.018 | 5373.5 samples/s | 84.0 steps/s
[Step=50200 Epoch=192.3] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=17.026 | 5124.0 samples/s | 80.1 steps/s
[Step=50250 Epoch=192.5] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=17.034 | 6913.9 samples/s | 108.0 steps/s
[Step=50300 Epoch=192.7] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=17.042 | 2043.0 samples/s | 31.9 steps/s
[Step=50350 Epoch=192.9] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=17.049 | 5173.6 samples/s | 80.8 steps/s
[Step=50400 Epoch=193.1] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=17.057 | 5082.6 samples/s | 79.4 steps/s
[Step=50450 Epoch=193.3] | Loss=0.00011 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=17.063 | 5119.0 samples/s | 80.0 steps/s
[Step=50500 Epoch=193.5] | Loss=0.00011 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=17.070 | 5818.7 samples/s | 90.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=50501 Epoch=193.5] | Loss=0.00000 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.279 | L2-Norm(final)=17.131 | 4362.9 samples/s | 68.2 steps/s
[Step=50550 Epoch=193.7] | Loss=0.00003 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.276 | L2-Norm(final)=17.136 | 4290.5 samples/s | 67.0 steps/s
[Step=50600 Epoch=193.9] | Loss=0.00002 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.266 | L2-Norm(final)=17.138 | 4573.4 samples/s | 71.5 steps/s
[Step=50650 Epoch=194.1] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.255 | L2-Norm(final)=17.139 | 4692.5 samples/s | 73.3 steps/s
[Step=50700 Epoch=194.3] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=17.141 | 4578.0 samples/s | 71.5 steps/s
[Step=50750 Epoch=194.5] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.232 | L2-Norm(final)=17.142 | 5869.4 samples/s | 91.7 steps/s
[Step=50800 Epoch=194.6] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.220 | L2-Norm(final)=17.143 | 1945.4 samples/s | 30.4 steps/s
[Step=50850 Epoch=194.8] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.208 | L2-Norm(final)=17.144 | 4513.5 samples/s | 70.5 steps/s
[Step=50900 Epoch=195.0] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.196 | L2-Norm(final)=17.145 | 4510.7 samples/s | 70.5 steps/s
[Step=50950 Epoch=195.2] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.184 | L2-Norm(final)=17.146 | 4533.0 samples/s | 70.8 steps/s
[Step=51000 Epoch=195.4] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=17.147 | 4895.0 samples/s | 76.5 steps/s
[Step=51050 Epoch=195.6] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=17.147 | 2000.0 samples/s | 31.3 steps/s
[Step=51100 Epoch=195.8] | Loss=0.00000 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.148 | L2-Norm(final)=17.148 | 4509.0 samples/s | 70.5 steps/s
[Step=51150 Epoch=196.0] | Loss=0.00000 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=17.149 | 4585.8 samples/s | 71.7 steps/s
[Step=51200 Epoch=196.2] | Loss=0.00000 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.124 | L2-Norm(final)=17.149 | 4426.9 samples/s | 69.2 steps/s
[Step=51250 Epoch=196.4] | Loss=0.00000 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.111 | L2-Norm(final)=17.150 | 4511.2 samples/s | 70.5 steps/s
[Step=51300 Epoch=196.6] | Loss=0.00000 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.099 | L2-Norm(final)=17.151 | 2088.0 samples/s | 32.6 steps/s
[Step=51350 Epoch=196.8] | Loss=0.00000 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.087 | L2-Norm(final)=17.151 | 4656.6 samples/s | 72.8 steps/s
[Step=51400 Epoch=196.9] | Loss=0.00000 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.074 | L2-Norm(final)=17.152 | 4538.9 samples/s | 70.9 steps/s
[Step=51450 Epoch=197.1] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.062 | L2-Norm(final)=17.153 | 4379.4 samples/s | 68.4 steps/s
[Step=51500 Epoch=197.3] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.049 | L2-Norm(final)=17.153 | 4648.2 samples/s | 72.6 steps/s
[Step=51550 Epoch=197.5] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.036 | L2-Norm(final)=17.154 | 2123.8 samples/s | 33.2 steps/s
[Step=51600 Epoch=197.7] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.023 | L2-Norm(final)=17.154 | 4512.3 samples/s | 70.5 steps/s
[Step=51650 Epoch=197.9] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.010 | L2-Norm(final)=17.155 | 4483.4 samples/s | 70.1 steps/s
[Step=51700 Epoch=198.1] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.997 | L2-Norm(final)=17.156 | 4466.8 samples/s | 69.8 steps/s
[Step=51750 Epoch=198.3] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.984 | L2-Norm(final)=17.156 | 4563.1 samples/s | 71.3 steps/s
[Step=51800 Epoch=198.5] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.971 | L2-Norm(final)=17.157 | 6066.5 samples/s | 94.8 steps/s
[Step=51850 Epoch=198.7] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.958 | L2-Norm(final)=17.157 | 1880.5 samples/s | 29.4 steps/s
[Step=51900 Epoch=198.9] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.944 | L2-Norm(final)=17.158 | 4559.9 samples/s | 71.2 steps/s
[Step=51950 Epoch=199.1] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.931 | L2-Norm(final)=17.159 | 4386.8 samples/s | 68.5 steps/s
[Step=52000 Epoch=199.2] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.917 | L2-Norm(final)=17.159 | 4544.2 samples/s | 71.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step52000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=50001 Epoch=192.5] | Loss=0.00000 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.282 | L2-Norm(final)=16.824 | 4468.3 samples/s | 69.8 steps/s
[Step=50050 Epoch=192.7] | Loss=0.00020 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=16.839 | 4661.9 samples/s | 72.8 steps/s
[Step=50100 Epoch=192.9] | Loss=0.00013 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=16.854 | 5287.3 samples/s | 82.6 steps/s
[Step=50150 Epoch=193.0] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=16.864 | 5035.0 samples/s | 78.7 steps/s
[Step=50200 Epoch=193.2] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=16.874 | 5162.1 samples/s | 80.7 steps/s
[Step=50250 Epoch=193.4] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=16.884 | 6917.3 samples/s | 108.1 steps/s
[Step=50300 Epoch=193.6] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=16.894 | 2023.6 samples/s | 31.6 steps/s
[Step=50350 Epoch=193.8] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=16.904 | 5090.5 samples/s | 79.5 steps/s
[Step=50400 Epoch=194.0] | Loss=0.00011 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=16.913 | 5130.4 samples/s | 80.2 steps/s
[Step=50450 Epoch=194.2] | Loss=0.00011 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=16.923 | 5247.4 samples/s | 82.0 steps/s
[Step=50500 Epoch=194.4] | Loss=0.00011 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=16.931 | 5980.7 samples/s | 93.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=50501 Epoch=194.4] | Loss=0.00021 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=17.016 | 4361.8 samples/s | 68.2 steps/s
[Step=50550 Epoch=194.6] | Loss=0.00003 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.279 | L2-Norm(final)=17.019 | 4286.2 samples/s | 67.0 steps/s
[Step=50600 Epoch=194.8] | Loss=0.00028 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.271 | L2-Norm(final)=17.020 | 4496.6 samples/s | 70.3 steps/s
[Step=50650 Epoch=195.0] | Loss=0.00029 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=17.018 | 4543.6 samples/s | 71.0 steps/s
[Step=50700 Epoch=195.2] | Loss=0.00022 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.298 | L2-Norm(final)=17.019 | 4527.1 samples/s | 70.7 steps/s
[Step=50750 Epoch=195.4] | Loss=0.00018 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=17.019 | 5683.3 samples/s | 88.8 steps/s
[Step=50800 Epoch=195.5] | Loss=0.00032 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=17.018 | 1928.5 samples/s | 30.1 steps/s
[Step=50850 Epoch=195.7] | Loss=0.00030 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.320 | L2-Norm(final)=17.016 | 4528.2 samples/s | 70.8 steps/s
[Step=50900 Epoch=195.9] | Loss=0.00026 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.327 | L2-Norm(final)=17.015 | 4479.0 samples/s | 70.0 steps/s
[Step=50950 Epoch=196.1] | Loss=0.00023 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.332 | L2-Norm(final)=17.014 | 4508.8 samples/s | 70.5 steps/s
[Step=51000 Epoch=196.3] | Loss=0.00021 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.334 | L2-Norm(final)=17.013 | 5126.2 samples/s | 80.1 steps/s
[Step=51050 Epoch=196.5] | Loss=0.00019 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.336 | L2-Norm(final)=17.013 | 1999.6 samples/s | 31.2 steps/s
[Step=51100 Epoch=196.7] | Loss=0.00018 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.336 | L2-Norm(final)=17.012 | 4470.3 samples/s | 69.8 steps/s
[Step=51150 Epoch=196.9] | Loss=0.00016 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.336 | L2-Norm(final)=17.012 | 4494.3 samples/s | 70.2 steps/s
[Step=51200 Epoch=197.1] | Loss=0.00015 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.335 | L2-Norm(final)=17.012 | 4479.7 samples/s | 70.0 steps/s
[Step=51250 Epoch=197.3] | Loss=0.00014 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.333 | L2-Norm(final)=17.012 | 4597.7 samples/s | 71.8 steps/s
[Step=51300 Epoch=197.5] | Loss=0.00014 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.332 | L2-Norm(final)=17.012 | 2128.9 samples/s | 33.3 steps/s
[Step=51350 Epoch=197.7] | Loss=0.00013 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.330 | L2-Norm(final)=17.012 | 4500.3 samples/s | 70.3 steps/s
[Step=51400 Epoch=197.9] | Loss=0.00012 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.328 | L2-Norm(final)=17.012 | 4430.8 samples/s | 69.2 steps/s
[Step=51450 Epoch=198.1] | Loss=0.00011 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.326 | L2-Norm(final)=17.012 | 4464.4 samples/s | 69.8 steps/s
[Step=51500 Epoch=198.2] | Loss=0.00011 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.323 | L2-Norm(final)=17.013 | 4487.5 samples/s | 70.1 steps/s
[Step=51550 Epoch=198.4] | Loss=0.00010 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.320 | L2-Norm(final)=17.013 | 2096.2 samples/s | 32.8 steps/s
[Step=51600 Epoch=198.6] | Loss=0.00010 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.317 | L2-Norm(final)=17.013 | 4679.4 samples/s | 73.1 steps/s
[Step=51650 Epoch=198.8] | Loss=0.00009 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.314 | L2-Norm(final)=17.013 | 4675.2 samples/s | 73.0 steps/s
[Step=51700 Epoch=199.0] | Loss=0.00009 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=17.013 | 4522.3 samples/s | 70.7 steps/s
[Step=51750 Epoch=199.2] | Loss=0.00009 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.308 | L2-Norm(final)=17.014 | 4616.4 samples/s | 72.1 steps/s
[Step=51800 Epoch=199.4] | Loss=0.00008 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=17.014 | 6693.1 samples/s | 104.6 steps/s
[Step=51850 Epoch=199.6] | Loss=0.00008 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.300 | L2-Norm(final)=17.014 | 1864.4 samples/s | 29.1 steps/s
[Step=51900 Epoch=199.8] | Loss=0.00008 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=17.014 | 4616.5 samples/s | 72.1 steps/s
[Step=51950 Epoch=200.0] | Loss=0.00008 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.293 | L2-Norm(final)=17.015 | 4673.8 samples/s | 73.0 steps/s
[Step=52000 Epoch=200.2] | Loss=0.00007 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.289 | L2-Norm(final)=17.015 | 4585.8 samples/s | 71.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step52000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06868 | acc=0.9690 | tpr=0.9755 | fpr=0.0451 | 4473.1 samples/s | 17.5 steps/s
Avg test loss: 0.06749, Avg test acc: 0.96987, Avg tpr: 0.97657, Avg fpr: 0.04487, total FA: 350

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07048 | acc=0.9722 | tpr=0.9812 | fpr=0.0473 | 4376.9 samples/s | 17.1 steps/s
Avg test loss: 0.06923, Avg test acc: 0.97187, Avg tpr: 0.98071, Avg fpr: 0.04756, total FA: 371

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.03133 | acc=0.3067 | tpr=0.0123 | fpr=0.0540 | 4462.1 samples/s | 17.4 steps/s
Avg test loss: 6.04614, Avg test acc: 0.30431, Avg tpr: 0.01265, Avg fpr: 0.05422, total FA: 423

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.70839 | acc=0.3097 | tpr=0.0071 | fpr=0.0332 | 4475.3 samples/s | 17.5 steps/s
Avg test loss: 7.72034, Avg test acc: 0.30635, Avg tpr: 0.00729, Avg fpr: 0.03589, total FA: 280

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.29034 | acc=0.1222 | tpr=0.7345 | fpr=0.8888 | 4486.0 samples/s | 17.5 steps/s
[Step= 100] | Loss=6.26252 | acc=0.1214 | tpr=0.7207 | fpr=0.8898 | 8182.2 samples/s | 32.0 steps/s
[Step= 150] | Loss=6.27897 | acc=0.1204 | tpr=0.7248 | fpr=0.8907 | 8514.0 samples/s | 33.3 steps/s
[Step= 200] | Loss=6.27557 | acc=0.1206 | tpr=0.7126 | fpr=0.8902 | 7989.3 samples/s | 31.2 steps/s
[Step= 250] | Loss=6.28614 | acc=0.1198 | tpr=0.7205 | fpr=0.8911 | 8621.7 samples/s | 33.7 steps/s
[Step= 300] | Loss=6.28276 | acc=0.1196 | tpr=0.7215 | fpr=0.8913 | 8265.7 samples/s | 32.3 steps/s
[Step= 350] | Loss=6.28019 | acc=0.1189 | tpr=0.7176 | fpr=0.8920 | 8362.2 samples/s | 32.7 steps/s
[Step= 400] | Loss=6.28740 | acc=0.1187 | tpr=0.7183 | fpr=0.8922 | 8500.8 samples/s | 33.2 steps/s
[Step= 450] | Loss=6.29018 | acc=0.1188 | tpr=0.7210 | fpr=0.8921 | 8289.4 samples/s | 32.4 steps/s
[Step= 500] | Loss=6.29012 | acc=0.1187 | tpr=0.7247 | fpr=0.8922 | 8368.1 samples/s | 32.7 steps/s
[Step= 550] | Loss=6.29534 | acc=0.1182 | tpr=0.7191 | fpr=0.8927 | 14854.5 samples/s | 58.0 steps/s
Avg test loss: 6.29499, Avg test acc: 0.11807, Avg tpr: 0.71870, Avg fpr: 0.89285, total FA: 123970

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.09098 | acc=0.1127 | tpr=0.7389 | fpr=0.8985 | 4451.0 samples/s | 17.4 steps/s
[Step= 100] | Loss=7.06088 | acc=0.1133 | tpr=0.7377 | fpr=0.8984 | 8357.6 samples/s | 32.6 steps/s
[Step= 150] | Loss=7.07331 | acc=0.1128 | tpr=0.7392 | fpr=0.8987 | 8410.9 samples/s | 32.9 steps/s
[Step= 200] | Loss=7.06570 | acc=0.1129 | tpr=0.7355 | fpr=0.8985 | 8139.1 samples/s | 31.8 steps/s
[Step= 250] | Loss=7.07560 | acc=0.1126 | tpr=0.7371 | fpr=0.8987 | 8268.6 samples/s | 32.3 steps/s
[Step= 300] | Loss=7.06560 | acc=0.1122 | tpr=0.7353 | fpr=0.8991 | 8454.3 samples/s | 33.0 steps/s
[Step= 350] | Loss=7.06245 | acc=0.1113 | tpr=0.7339 | fpr=0.9000 | 8619.2 samples/s | 33.7 steps/s
[Step= 400] | Loss=7.06714 | acc=0.1114 | tpr=0.7314 | fpr=0.8999 | 7974.5 samples/s | 31.2 steps/s
[Step= 450] | Loss=7.06918 | acc=0.1111 | tpr=0.7322 | fpr=0.9002 | 8609.0 samples/s | 33.6 steps/s
[Step= 500] | Loss=7.06869 | acc=0.1111 | tpr=0.7335 | fpr=0.9001 | 8272.5 samples/s | 32.3 steps/s
[Step= 550] | Loss=7.07413 | acc=0.1107 | tpr=0.7258 | fpr=0.9005 | 15726.8 samples/s | 61.4 steps/s
Avg test loss: 7.07470, Avg test acc: 0.11056, Avg tpr: 0.72544, Avg fpr: 0.90062, total FA: 125049

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12870 | acc=0.9827 | tpr=0.9425 | fpr=0.0165 | 4468.6 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.13860 | acc=0.9821 | tpr=0.9552 | fpr=0.0174 | 8189.0 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.14349 | acc=0.9813 | tpr=0.9625 | fpr=0.0184 | 8337.4 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.14348 | acc=0.9814 | tpr=0.9639 | fpr=0.0183 | 8380.0 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.14173 | acc=0.9815 | tpr=0.9624 | fpr=0.0181 | 8417.5 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.14300 | acc=0.9814 | tpr=0.9622 | fpr=0.0182 | 8421.9 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.14469 | acc=0.9812 | tpr=0.9631 | fpr=0.0185 | 8354.2 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.14645 | acc=0.9810 | tpr=0.9623 | fpr=0.0187 | 8598.8 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.14888 | acc=0.9807 | tpr=0.9606 | fpr=0.0189 | 8311.6 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.14874 | acc=0.9806 | tpr=0.9608 | fpr=0.0190 | 8333.3 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.14795 | acc=0.9806 | tpr=0.9578 | fpr=0.0189 | 15219.1 samples/s | 59.4 steps/s
Avg test loss: 0.14759, Avg test acc: 0.98067, Avg tpr: 0.95800, Avg fpr: 0.01892, total FA: 2627

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15073 | acc=0.9823 | tpr=0.9425 | fpr=0.0170 | 4377.2 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.16008 | acc=0.9818 | tpr=0.9616 | fpr=0.0179 | 7423.9 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.16457 | acc=0.9809 | tpr=0.9625 | fpr=0.0187 | 8140.9 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.16542 | acc=0.9809 | tpr=0.9650 | fpr=0.0188 | 8127.2 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.16393 | acc=0.9810 | tpr=0.9642 | fpr=0.0187 | 7030.7 samples/s | 27.5 steps/s
[Step= 300] | Loss=0.16515 | acc=0.9810 | tpr=0.9658 | fpr=0.0188 | 6800.2 samples/s | 26.6 steps/s
[Step= 350] | Loss=0.16729 | acc=0.9807 | tpr=0.9656 | fpr=0.0190 | 6803.5 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.16995 | acc=0.9805 | tpr=0.9639 | fpr=0.0192 | 7779.2 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.17252 | acc=0.9802 | tpr=0.9630 | fpr=0.0195 | 8281.1 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.17214 | acc=0.9801 | tpr=0.9621 | fpr=0.0195 | 8745.2 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.17093 | acc=0.9802 | tpr=0.9590 | fpr=0.0194 | 13754.5 samples/s | 53.7 steps/s
Avg test loss: 0.17060, Avg test acc: 0.98020, Avg tpr: 0.95880, Avg fpr: 0.01941, total FA: 2695

server round 26/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=52001 Epoch=101.4] | Loss=0.00171 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.105 | L2-Norm(final)=15.384 | 4123.9 samples/s | 64.4 steps/s
[Step=52050 Epoch=101.5] | Loss=0.00821 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.106 | L2-Norm(final)=15.387 | 5039.2 samples/s | 78.7 steps/s
[Step=52100 Epoch=101.6] | Loss=0.00913 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.106 | L2-Norm(final)=15.394 | 5506.3 samples/s | 86.0 steps/s
[Step=52150 Epoch=101.7] | Loss=0.00923 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.106 | L2-Norm(final)=15.399 | 5529.6 samples/s | 86.4 steps/s
[Step=52200 Epoch=101.8] | Loss=0.00911 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.106 | L2-Norm(final)=15.403 | 5454.1 samples/s | 85.2 steps/s
[Step=52250 Epoch=101.9] | Loss=0.00880 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.106 | L2-Norm(final)=15.409 | 5493.7 samples/s | 85.8 steps/s
[Step=52300 Epoch=102.0] | Loss=0.00861 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.106 | L2-Norm(final)=15.414 | 5480.8 samples/s | 85.6 steps/s
[Step=52350 Epoch=102.1] | Loss=0.00888 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.106 | L2-Norm(final)=15.420 | 5449.0 samples/s | 85.1 steps/s
[Step=52400 Epoch=102.2] | Loss=0.00886 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.106 | L2-Norm(final)=15.425 | 5540.8 samples/s | 86.6 steps/s
[Step=52450 Epoch=102.3] | Loss=0.00888 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.106 | L2-Norm(final)=15.431 | 5510.1 samples/s | 86.1 steps/s
[Step=52500 Epoch=102.4] | Loss=0.00888 | Reg=0.00147 | acc=0.9531 | L2-Norm=12.106 | L2-Norm(final)=15.436 | 6853.3 samples/s | 107.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=52501 Epoch=102.4] | Loss=0.00330 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.106 | L2-Norm(final)=15.494 | 3973.1 samples/s | 62.1 steps/s
[Step=52550 Epoch=102.5] | Loss=0.01088 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.125 | L2-Norm(final)=15.495 | 4719.5 samples/s | 73.7 steps/s
[Step=52600 Epoch=102.6] | Loss=0.01006 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=15.495 | 4743.3 samples/s | 74.1 steps/s
[Step=52650 Epoch=102.7] | Loss=0.00966 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.154 | L2-Norm(final)=15.496 | 4719.7 samples/s | 73.7 steps/s
[Step=52700 Epoch=102.8] | Loss=0.00886 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=15.498 | 4697.3 samples/s | 73.4 steps/s
[Step=52750 Epoch=102.9] | Loss=0.00942 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=15.499 | 4822.1 samples/s | 75.3 steps/s
[Step=52800 Epoch=103.0] | Loss=0.00945 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=15.501 | 4733.7 samples/s | 74.0 steps/s
[Step=52850 Epoch=103.1] | Loss=0.00961 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.191 | L2-Norm(final)=15.502 | 4795.2 samples/s | 74.9 steps/s
[Step=52900 Epoch=103.2] | Loss=0.00988 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.199 | L2-Norm(final)=15.503 | 4773.4 samples/s | 74.6 steps/s
[Step=52950 Epoch=103.3] | Loss=0.00994 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.206 | L2-Norm(final)=15.504 | 4880.0 samples/s | 76.3 steps/s
[Step=53000 Epoch=103.4] | Loss=0.00991 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.213 | L2-Norm(final)=15.505 | 5741.6 samples/s | 89.7 steps/s
[Step=53050 Epoch=103.5] | Loss=0.00976 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.220 | L2-Norm(final)=15.506 | 1980.1 samples/s | 30.9 steps/s
[Step=53100 Epoch=103.6] | Loss=0.00985 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.226 | L2-Norm(final)=15.506 | 4855.0 samples/s | 75.9 steps/s
[Step=53150 Epoch=103.7] | Loss=0.00982 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.232 | L2-Norm(final)=15.507 | 4903.8 samples/s | 76.6 steps/s
[Step=53200 Epoch=103.8] | Loss=0.00987 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.238 | L2-Norm(final)=15.507 | 4922.3 samples/s | 76.9 steps/s
[Step=53250 Epoch=103.9] | Loss=0.00985 | Reg=0.00150 | acc=0.9688 | L2-Norm=12.243 | L2-Norm(final)=15.508 | 4798.7 samples/s | 75.0 steps/s
[Step=53300 Epoch=104.0] | Loss=0.00976 | Reg=0.00150 | acc=0.9688 | L2-Norm=12.248 | L2-Norm(final)=15.509 | 4823.6 samples/s | 75.4 steps/s
[Step=53350 Epoch=104.1] | Loss=0.00951 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=15.510 | 4791.5 samples/s | 74.9 steps/s
[Step=53400 Epoch=104.2] | Loss=0.00925 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=15.511 | 4776.1 samples/s | 74.6 steps/s
[Step=53450 Epoch=104.2] | Loss=0.00918 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=15.512 | 4773.8 samples/s | 74.6 steps/s
[Step=53500 Epoch=104.3] | Loss=0.00909 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.266 | L2-Norm(final)=15.513 | 4972.8 samples/s | 77.7 steps/s
[Step=53550 Epoch=104.4] | Loss=0.00902 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.270 | L2-Norm(final)=15.515 | 2067.2 samples/s | 32.3 steps/s
[Step=53600 Epoch=104.5] | Loss=0.00887 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.274 | L2-Norm(final)=15.516 | 4870.1 samples/s | 76.1 steps/s
[Step=53650 Epoch=104.6] | Loss=0.00875 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.278 | L2-Norm(final)=15.517 | 4779.3 samples/s | 74.7 steps/s
[Step=53700 Epoch=104.7] | Loss=0.00863 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.282 | L2-Norm(final)=15.518 | 4721.8 samples/s | 73.8 steps/s
[Step=53750 Epoch=104.8] | Loss=0.00855 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=15.520 | 4829.4 samples/s | 75.5 steps/s
[Step=53800 Epoch=104.9] | Loss=0.00853 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.289 | L2-Norm(final)=15.521 | 4543.9 samples/s | 71.0 steps/s
[Step=53850 Epoch=105.0] | Loss=0.00850 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.292 | L2-Norm(final)=15.522 | 4567.2 samples/s | 71.4 steps/s
[Step=53900 Epoch=105.1] | Loss=0.00842 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.295 | L2-Norm(final)=15.524 | 4546.2 samples/s | 71.0 steps/s
[Step=53950 Epoch=105.2] | Loss=0.00837 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.298 | L2-Norm(final)=15.525 | 4518.2 samples/s | 70.6 steps/s
[Step=54000 Epoch=105.3] | Loss=0.00832 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=15.526 | 4567.5 samples/s | 71.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step54000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=52001 Epoch=101.7] | Loss=0.01052 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.105 | L2-Norm(final)=15.781 | 4384.7 samples/s | 68.5 steps/s
[Step=52050 Epoch=101.8] | Loss=0.00877 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.106 | L2-Norm(final)=15.785 | 4925.1 samples/s | 77.0 steps/s
[Step=52100 Epoch=101.9] | Loss=0.00861 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.106 | L2-Norm(final)=15.791 | 5278.4 samples/s | 82.5 steps/s
[Step=52150 Epoch=102.0] | Loss=0.00857 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.106 | L2-Norm(final)=15.798 | 5234.9 samples/s | 81.8 steps/s
[Step=52200 Epoch=102.0] | Loss=0.00879 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.106 | L2-Norm(final)=15.806 | 4598.9 samples/s | 71.9 steps/s
[Step=52250 Epoch=102.1] | Loss=0.00854 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.106 | L2-Norm(final)=15.815 | 4682.0 samples/s | 73.2 steps/s
[Step=52300 Epoch=102.2] | Loss=0.00806 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.106 | L2-Norm(final)=15.823 | 4720.6 samples/s | 73.8 steps/s
[Step=52350 Epoch=102.3] | Loss=0.00834 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.106 | L2-Norm(final)=15.831 | 4497.5 samples/s | 70.3 steps/s
[Step=52400 Epoch=102.4] | Loss=0.00843 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.106 | L2-Norm(final)=15.838 | 4605.1 samples/s | 72.0 steps/s
[Step=52450 Epoch=102.5] | Loss=0.00821 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.106 | L2-Norm(final)=15.845 | 4665.5 samples/s | 72.9 steps/s
[Step=52500 Epoch=102.6] | Loss=0.00840 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.106 | L2-Norm(final)=15.851 | 6510.7 samples/s | 101.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=52501 Epoch=102.6] | Loss=0.00922 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.106 | L2-Norm(final)=15.918 | 4369.7 samples/s | 68.3 steps/s
[Step=52550 Epoch=102.7] | Loss=0.00734 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.123 | L2-Norm(final)=15.923 | 4244.6 samples/s | 66.3 steps/s
[Step=52600 Epoch=102.8] | Loss=0.01018 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=15.923 | 4573.7 samples/s | 71.5 steps/s
[Step=52650 Epoch=102.9] | Loss=0.01009 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=15.923 | 4534.3 samples/s | 70.8 steps/s
[Step=52700 Epoch=103.0] | Loss=0.00952 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.156 | L2-Norm(final)=15.924 | 4603.6 samples/s | 71.9 steps/s
[Step=52750 Epoch=103.1] | Loss=0.00947 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=15.926 | 4184.6 samples/s | 65.4 steps/s
[Step=52800 Epoch=103.2] | Loss=0.00981 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.175 | L2-Norm(final)=15.927 | 4109.8 samples/s | 64.2 steps/s
[Step=52850 Epoch=103.3] | Loss=0.00979 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.183 | L2-Norm(final)=15.928 | 4086.4 samples/s | 63.8 steps/s
[Step=52900 Epoch=103.4] | Loss=0.00966 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.191 | L2-Norm(final)=15.929 | 4141.8 samples/s | 64.7 steps/s
[Step=52950 Epoch=103.5] | Loss=0.00974 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.199 | L2-Norm(final)=15.931 | 4111.2 samples/s | 64.2 steps/s
[Step=53000 Epoch=103.6] | Loss=0.00961 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.206 | L2-Norm(final)=15.932 | 5105.4 samples/s | 79.8 steps/s
[Step=53050 Epoch=103.7] | Loss=0.00919 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.213 | L2-Norm(final)=15.934 | 1817.0 samples/s | 28.4 steps/s
[Step=53100 Epoch=103.8] | Loss=0.00899 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=15.936 | 4729.6 samples/s | 73.9 steps/s
[Step=53150 Epoch=103.9] | Loss=0.00879 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.225 | L2-Norm(final)=15.938 | 4717.8 samples/s | 73.7 steps/s
[Step=53200 Epoch=104.0] | Loss=0.00856 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.230 | L2-Norm(final)=15.939 | 4708.5 samples/s | 73.6 steps/s
[Step=53250 Epoch=104.1] | Loss=0.00861 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.235 | L2-Norm(final)=15.940 | 4772.2 samples/s | 74.6 steps/s
[Step=53300 Epoch=104.2] | Loss=0.00875 | Reg=0.00150 | acc=0.9688 | L2-Norm=12.239 | L2-Norm(final)=15.942 | 4772.3 samples/s | 74.6 steps/s
[Step=53350 Epoch=104.3] | Loss=0.00865 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=15.943 | 4775.5 samples/s | 74.6 steps/s
[Step=53400 Epoch=104.4] | Loss=0.00865 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.248 | L2-Norm(final)=15.945 | 4722.4 samples/s | 73.8 steps/s
[Step=53450 Epoch=104.5] | Loss=0.00861 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.252 | L2-Norm(final)=15.946 | 4797.9 samples/s | 75.0 steps/s
[Step=53500 Epoch=104.6] | Loss=0.00863 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=15.947 | 5159.9 samples/s | 80.6 steps/s
[Step=53550 Epoch=104.7] | Loss=0.00855 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.260 | L2-Norm(final)=15.948 | 2105.4 samples/s | 32.9 steps/s
[Step=53600 Epoch=104.8] | Loss=0.00849 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.264 | L2-Norm(final)=15.949 | 4835.9 samples/s | 75.6 steps/s
[Step=53650 Epoch=104.9] | Loss=0.00839 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=15.951 | 4780.8 samples/s | 74.7 steps/s
[Step=53700 Epoch=105.0] | Loss=0.00825 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.271 | L2-Norm(final)=15.952 | 4745.2 samples/s | 74.1 steps/s
[Step=53750 Epoch=105.1] | Loss=0.00818 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.275 | L2-Norm(final)=15.953 | 4716.7 samples/s | 73.7 steps/s
[Step=53800 Epoch=105.2] | Loss=0.00815 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.278 | L2-Norm(final)=15.954 | 4780.4 samples/s | 74.7 steps/s
[Step=53850 Epoch=105.3] | Loss=0.00806 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.281 | L2-Norm(final)=15.955 | 4756.2 samples/s | 74.3 steps/s
[Step=53900 Epoch=105.4] | Loss=0.00797 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.284 | L2-Norm(final)=15.956 | 4736.7 samples/s | 74.0 steps/s
[Step=53950 Epoch=105.5] | Loss=0.00790 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=15.958 | 4732.8 samples/s | 74.0 steps/s
[Step=54000 Epoch=105.6] | Loss=0.00788 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=15.959 | 4790.6 samples/s | 74.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step54000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=52001 Epoch=199.2] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.105 | L2-Norm(final)=17.181 | 4228.4 samples/s | 66.1 steps/s
[Step=52050 Epoch=199.4] | Loss=0.00004 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.101 | L2-Norm(final)=17.187 | 4919.6 samples/s | 76.9 steps/s
[Step=52100 Epoch=199.6] | Loss=0.00004 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.100 | L2-Norm(final)=17.193 | 5237.6 samples/s | 81.8 steps/s
[Step=52150 Epoch=199.8] | Loss=0.00004 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.100 | L2-Norm(final)=17.199 | 5268.5 samples/s | 82.3 steps/s
[Step=52200 Epoch=200.0] | Loss=0.00004 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.100 | L2-Norm(final)=17.205 | 5159.5 samples/s | 80.6 steps/s
[Step=52250 Epoch=200.2] | Loss=0.00005 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.100 | L2-Norm(final)=17.211 | 6622.2 samples/s | 103.5 steps/s
[Step=52300 Epoch=200.4] | Loss=0.00005 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.100 | L2-Norm(final)=17.216 | 2036.3 samples/s | 31.8 steps/s
[Step=52350 Epoch=200.6] | Loss=0.00005 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.100 | L2-Norm(final)=17.222 | 5216.1 samples/s | 81.5 steps/s
[Step=52400 Epoch=200.8] | Loss=0.00005 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.100 | L2-Norm(final)=17.227 | 5101.1 samples/s | 79.7 steps/s
[Step=52450 Epoch=201.0] | Loss=0.00005 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.100 | L2-Norm(final)=17.232 | 5149.3 samples/s | 80.5 steps/s
[Step=52500 Epoch=201.2] | Loss=0.00005 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.099 | L2-Norm(final)=17.237 | 5769.4 samples/s | 90.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=52501 Epoch=201.2] | Loss=0.00000 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.099 | L2-Norm(final)=17.288 | 4173.8 samples/s | 65.2 steps/s
[Step=52550 Epoch=201.4] | Loss=0.00003 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.090 | L2-Norm(final)=17.291 | 4497.6 samples/s | 70.3 steps/s
[Step=52600 Epoch=201.5] | Loss=0.00019 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.075 | L2-Norm(final)=17.290 | 4627.5 samples/s | 72.3 steps/s
[Step=52650 Epoch=201.7] | Loss=0.00018 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.079 | L2-Norm(final)=17.291 | 4594.8 samples/s | 71.8 steps/s
[Step=52700 Epoch=201.9] | Loss=0.00014 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.083 | L2-Norm(final)=17.293 | 4638.3 samples/s | 72.5 steps/s
[Step=52750 Epoch=202.1] | Loss=0.00011 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.080 | L2-Norm(final)=17.295 | 5860.6 samples/s | 91.6 steps/s
[Step=52800 Epoch=202.3] | Loss=0.00009 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=17.297 | 1990.6 samples/s | 31.1 steps/s
[Step=52850 Epoch=202.5] | Loss=0.00008 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.064 | L2-Norm(final)=17.298 | 4535.0 samples/s | 70.9 steps/s
[Step=52900 Epoch=202.7] | Loss=0.00007 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.054 | L2-Norm(final)=17.298 | 4568.7 samples/s | 71.4 steps/s
[Step=52950 Epoch=202.9] | Loss=0.00006 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.043 | L2-Norm(final)=17.299 | 4518.7 samples/s | 70.6 steps/s
[Step=53000 Epoch=203.1] | Loss=0.00006 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.032 | L2-Norm(final)=17.300 | 4943.3 samples/s | 77.2 steps/s
[Step=53050 Epoch=203.3] | Loss=0.00005 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.020 | L2-Norm(final)=17.300 | 2025.0 samples/s | 31.6 steps/s
[Step=53100 Epoch=203.5] | Loss=0.00005 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.008 | L2-Norm(final)=17.301 | 4514.4 samples/s | 70.5 steps/s
[Step=53150 Epoch=203.7] | Loss=0.00004 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.995 | L2-Norm(final)=17.301 | 4495.4 samples/s | 70.2 steps/s
[Step=53200 Epoch=203.8] | Loss=0.00004 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.982 | L2-Norm(final)=17.301 | 4453.5 samples/s | 69.6 steps/s
[Step=53250 Epoch=204.0] | Loss=0.00004 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.969 | L2-Norm(final)=17.302 | 4500.6 samples/s | 70.3 steps/s
[Step=53300 Epoch=204.2] | Loss=0.00004 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.956 | L2-Norm(final)=17.302 | 2108.7 samples/s | 32.9 steps/s
[Step=53350 Epoch=204.4] | Loss=0.00003 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.943 | L2-Norm(final)=17.302 | 4582.7 samples/s | 71.6 steps/s
[Step=53400 Epoch=204.6] | Loss=0.00003 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.930 | L2-Norm(final)=17.302 | 4529.4 samples/s | 70.8 steps/s
[Step=53450 Epoch=204.8] | Loss=0.00003 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.916 | L2-Norm(final)=17.303 | 4572.1 samples/s | 71.4 steps/s
[Step=53500 Epoch=205.0] | Loss=0.00003 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.903 | L2-Norm(final)=17.303 | 4471.5 samples/s | 69.9 steps/s
[Step=53550 Epoch=205.2] | Loss=0.00003 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.889 | L2-Norm(final)=17.303 | 2146.5 samples/s | 33.5 steps/s
[Step=53600 Epoch=205.4] | Loss=0.00003 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.875 | L2-Norm(final)=17.304 | 4431.3 samples/s | 69.2 steps/s
[Step=53650 Epoch=205.6] | Loss=0.00002 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.861 | L2-Norm(final)=17.304 | 4493.0 samples/s | 70.2 steps/s
[Step=53700 Epoch=205.8] | Loss=0.00002 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.847 | L2-Norm(final)=17.304 | 4563.0 samples/s | 71.3 steps/s
[Step=53750 Epoch=206.0] | Loss=0.00002 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.832 | L2-Norm(final)=17.305 | 4530.0 samples/s | 70.8 steps/s
[Step=53800 Epoch=206.1] | Loss=0.00002 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.818 | L2-Norm(final)=17.305 | 5975.8 samples/s | 93.4 steps/s
[Step=53850 Epoch=206.3] | Loss=0.00002 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.804 | L2-Norm(final)=17.305 | 1916.9 samples/s | 30.0 steps/s
[Step=53900 Epoch=206.5] | Loss=0.00002 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.789 | L2-Norm(final)=17.306 | 4469.4 samples/s | 69.8 steps/s
[Step=53950 Epoch=206.7] | Loss=0.00002 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.774 | L2-Norm(final)=17.306 | 4527.0 samples/s | 70.7 steps/s
[Step=54000 Epoch=206.9] | Loss=0.00002 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.759 | L2-Norm(final)=17.306 | 4477.1 samples/s | 70.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step54000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=52001 Epoch=200.2] | Loss=0.00000 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.105 | L2-Norm(final)=17.022 | 4261.9 samples/s | 66.6 steps/s
[Step=52050 Epoch=200.4] | Loss=0.00002 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.104 | L2-Norm(final)=17.023 | 4722.4 samples/s | 73.8 steps/s
[Step=52100 Epoch=200.6] | Loss=0.00002 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.104 | L2-Norm(final)=17.024 | 5111.0 samples/s | 79.9 steps/s
[Step=52150 Epoch=200.7] | Loss=0.00002 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.104 | L2-Norm(final)=17.025 | 5121.5 samples/s | 80.0 steps/s
[Step=52200 Epoch=200.9] | Loss=0.00002 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.104 | L2-Norm(final)=17.027 | 5126.7 samples/s | 80.1 steps/s
[Step=52250 Epoch=201.1] | Loss=0.00002 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.104 | L2-Norm(final)=17.029 | 6876.8 samples/s | 107.5 steps/s
[Step=52300 Epoch=201.3] | Loss=0.00002 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.104 | L2-Norm(final)=17.031 | 2041.1 samples/s | 31.9 steps/s
[Step=52350 Epoch=201.5] | Loss=0.00002 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.104 | L2-Norm(final)=17.033 | 5109.6 samples/s | 79.8 steps/s
[Step=52400 Epoch=201.7] | Loss=0.00002 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.104 | L2-Norm(final)=17.034 | 5278.0 samples/s | 82.5 steps/s
[Step=52450 Epoch=201.9] | Loss=0.00002 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.104 | L2-Norm(final)=17.036 | 5214.1 samples/s | 81.5 steps/s
[Step=52500 Epoch=202.1] | Loss=0.00002 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.104 | L2-Norm(final)=17.038 | 6140.9 samples/s | 96.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=52501 Epoch=202.1] | Loss=0.00006 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.104 | L2-Norm(final)=17.057 | 3980.8 samples/s | 62.2 steps/s
[Step=52550 Epoch=202.3] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.098 | L2-Norm(final)=17.060 | 4563.7 samples/s | 71.3 steps/s
[Step=52600 Epoch=202.5] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.092 | L2-Norm(final)=17.064 | 4390.4 samples/s | 68.6 steps/s
[Step=52650 Epoch=202.7] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.087 | L2-Norm(final)=17.068 | 4512.7 samples/s | 70.5 steps/s
[Step=52700 Epoch=202.9] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.079 | L2-Norm(final)=17.071 | 4547.5 samples/s | 71.1 steps/s
[Step=52750 Epoch=203.1] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.072 | L2-Norm(final)=17.073 | 5602.7 samples/s | 87.5 steps/s
[Step=52800 Epoch=203.2] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.064 | L2-Norm(final)=17.075 | 1933.3 samples/s | 30.2 steps/s
[Step=52850 Epoch=203.4] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.057 | L2-Norm(final)=17.076 | 4527.5 samples/s | 70.7 steps/s
[Step=52900 Epoch=203.6] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.049 | L2-Norm(final)=17.078 | 4483.8 samples/s | 70.1 steps/s
[Step=52950 Epoch=203.8] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.042 | L2-Norm(final)=17.079 | 4574.9 samples/s | 71.5 steps/s
[Step=53000 Epoch=204.0] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.034 | L2-Norm(final)=17.080 | 5175.0 samples/s | 80.9 steps/s
[Step=53050 Epoch=204.2] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.026 | L2-Norm(final)=17.081 | 2052.1 samples/s | 32.1 steps/s
[Step=53100 Epoch=204.4] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.018 | L2-Norm(final)=17.082 | 4650.9 samples/s | 72.7 steps/s
[Step=53150 Epoch=204.6] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.010 | L2-Norm(final)=17.083 | 4539.9 samples/s | 70.9 steps/s
[Step=53200 Epoch=204.8] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.002 | L2-Norm(final)=17.084 | 4488.0 samples/s | 70.1 steps/s
[Step=53250 Epoch=205.0] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.994 | L2-Norm(final)=17.085 | 4628.0 samples/s | 72.3 steps/s
[Step=53300 Epoch=205.2] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.986 | L2-Norm(final)=17.086 | 2180.6 samples/s | 34.1 steps/s
[Step=53350 Epoch=205.4] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.978 | L2-Norm(final)=17.086 | 4733.8 samples/s | 74.0 steps/s
[Step=53400 Epoch=205.6] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.970 | L2-Norm(final)=17.087 | 4561.5 samples/s | 71.3 steps/s
[Step=53450 Epoch=205.8] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.961 | L2-Norm(final)=17.088 | 4513.8 samples/s | 70.5 steps/s
[Step=53500 Epoch=205.9] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.953 | L2-Norm(final)=17.089 | 4514.7 samples/s | 70.5 steps/s
[Step=53550 Epoch=206.1] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.944 | L2-Norm(final)=17.089 | 2101.9 samples/s | 32.8 steps/s
[Step=53600 Epoch=206.3] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.936 | L2-Norm(final)=17.090 | 4723.3 samples/s | 73.8 steps/s
[Step=53650 Epoch=206.5] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.927 | L2-Norm(final)=17.091 | 4434.1 samples/s | 69.3 steps/s
[Step=53700 Epoch=206.7] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.919 | L2-Norm(final)=17.092 | 4517.4 samples/s | 70.6 steps/s
[Step=53750 Epoch=206.9] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.910 | L2-Norm(final)=17.093 | 4509.1 samples/s | 70.5 steps/s
[Step=53800 Epoch=207.1] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.901 | L2-Norm(final)=17.094 | 6532.1 samples/s | 102.1 steps/s
[Step=53850 Epoch=207.3] | Loss=0.00000 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.892 | L2-Norm(final)=17.095 | 1820.8 samples/s | 28.4 steps/s
[Step=53900 Epoch=207.5] | Loss=0.00000 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.883 | L2-Norm(final)=17.095 | 4515.1 samples/s | 70.5 steps/s
[Step=53950 Epoch=207.7] | Loss=0.00000 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.874 | L2-Norm(final)=17.096 | 4458.0 samples/s | 69.7 steps/s
[Step=54000 Epoch=207.9] | Loss=0.00000 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.864 | L2-Norm(final)=17.097 | 4501.5 samples/s | 70.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step54000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07736 | acc=0.9688 | tpr=0.9772 | fpr=0.0493 | 4437.3 samples/s | 17.3 steps/s
Avg test loss: 0.07619, Avg test acc: 0.96947, Avg tpr: 0.97727, Avg fpr: 0.04769, total FA: 372

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06806 | acc=0.9703 | tpr=0.9748 | fpr=0.0394 | 4577.5 samples/s | 17.9 steps/s
Avg test loss: 0.06883, Avg test acc: 0.97071, Avg tpr: 0.97575, Avg fpr: 0.04038, total FA: 315

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.22106 | acc=0.3125 | tpr=0.0079 | fpr=0.0260 | 4409.8 samples/s | 17.2 steps/s
Avg test loss: 6.24521, Avg test acc: 0.30912, Avg tpr: 0.00746, Avg fpr: 0.02743, total FA: 214

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.86982 | acc=0.2956 | tpr=0.0169 | fpr=0.0991 | 4467.5 samples/s | 17.5 steps/s
Avg test loss: 5.88284, Avg test acc: 0.29245, Avg tpr: 0.01708, Avg fpr: 0.10191, total FA: 795

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.90826 | acc=0.0945 | tpr=0.7699 | fpr=0.9176 | 4394.4 samples/s | 17.2 steps/s
[Step= 100] | Loss=6.87460 | acc=0.0932 | tpr=0.7463 | fpr=0.9190 | 8567.1 samples/s | 33.5 steps/s
[Step= 150] | Loss=6.88937 | acc=0.0924 | tpr=0.7435 | fpr=0.9196 | 7913.5 samples/s | 30.9 steps/s
[Step= 200] | Loss=6.88537 | acc=0.0921 | tpr=0.7344 | fpr=0.9196 | 8574.6 samples/s | 33.5 steps/s
[Step= 250] | Loss=6.89600 | acc=0.0916 | tpr=0.7336 | fpr=0.9201 | 8401.9 samples/s | 32.8 steps/s
[Step= 300] | Loss=6.89079 | acc=0.0915 | tpr=0.7324 | fpr=0.9201 | 8219.8 samples/s | 32.1 steps/s
[Step= 350] | Loss=6.88976 | acc=0.0908 | tpr=0.7307 | fpr=0.9208 | 8449.7 samples/s | 33.0 steps/s
[Step= 400] | Loss=6.89695 | acc=0.0908 | tpr=0.7336 | fpr=0.9209 | 8297.3 samples/s | 32.4 steps/s
[Step= 450] | Loss=6.89812 | acc=0.0907 | tpr=0.7337 | fpr=0.9210 | 8580.1 samples/s | 33.5 steps/s
[Step= 500] | Loss=6.89756 | acc=0.0907 | tpr=0.7352 | fpr=0.9209 | 8331.1 samples/s | 32.5 steps/s
[Step= 550] | Loss=6.90108 | acc=0.0903 | tpr=0.7290 | fpr=0.9213 | 14500.7 samples/s | 56.6 steps/s
Avg test loss: 6.90124, Avg test acc: 0.09023, Avg tpr: 0.72861, Avg fpr: 0.92137, total FA: 127931

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.82767 | acc=0.1243 | tpr=0.7257 | fpr=0.8865 | 4415.7 samples/s | 17.2 steps/s
[Step= 100] | Loss=6.79306 | acc=0.1252 | tpr=0.7228 | fpr=0.8860 | 8355.7 samples/s | 32.6 steps/s
[Step= 150] | Loss=6.80766 | acc=0.1243 | tpr=0.7248 | fpr=0.8868 | 8391.3 samples/s | 32.8 steps/s
[Step= 200] | Loss=6.80034 | acc=0.1241 | tpr=0.7082 | fpr=0.8865 | 8254.8 samples/s | 32.2 steps/s
[Step= 250] | Loss=6.81270 | acc=0.1237 | tpr=0.7100 | fpr=0.8870 | 8374.4 samples/s | 32.7 steps/s
[Step= 300] | Loss=6.80593 | acc=0.1234 | tpr=0.7091 | fpr=0.8873 | 8831.2 samples/s | 34.5 steps/s
[Step= 350] | Loss=6.80206 | acc=0.1224 | tpr=0.7076 | fpr=0.8882 | 8140.0 samples/s | 31.8 steps/s
[Step= 400] | Loss=6.80860 | acc=0.1224 | tpr=0.7035 | fpr=0.8882 | 8462.2 samples/s | 33.1 steps/s
[Step= 450] | Loss=6.81064 | acc=0.1222 | tpr=0.7055 | fpr=0.8883 | 8150.2 samples/s | 31.8 steps/s
[Step= 500] | Loss=6.80977 | acc=0.1222 | tpr=0.7057 | fpr=0.8883 | 8162.3 samples/s | 31.9 steps/s
[Step= 550] | Loss=6.81522 | acc=0.1218 | tpr=0.6996 | fpr=0.8887 | 15051.5 samples/s | 58.8 steps/s
Avg test loss: 6.81528, Avg test acc: 0.12172, Avg tpr: 0.69929, Avg fpr: 0.88878, total FA: 123405

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.15292 | acc=0.9830 | tpr=0.9381 | fpr=0.0161 | 4366.3 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.16394 | acc=0.9824 | tpr=0.9510 | fpr=0.0170 | 8335.6 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.16977 | acc=0.9817 | tpr=0.9539 | fpr=0.0178 | 8609.9 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.17171 | acc=0.9817 | tpr=0.9563 | fpr=0.0178 | 8395.6 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.16911 | acc=0.9819 | tpr=0.9537 | fpr=0.0176 | 8603.2 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.17108 | acc=0.9818 | tpr=0.9535 | fpr=0.0177 | 8576.5 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.17314 | acc=0.9816 | tpr=0.9549 | fpr=0.0179 | 8166.0 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.17518 | acc=0.9814 | tpr=0.9540 | fpr=0.0181 | 8428.8 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.17819 | acc=0.9811 | tpr=0.9523 | fpr=0.0184 | 8703.6 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.17743 | acc=0.9811 | tpr=0.9524 | fpr=0.0184 | 7976.4 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.17602 | acc=0.9811 | tpr=0.9495 | fpr=0.0183 | 15212.8 samples/s | 59.4 steps/s
Avg test loss: 0.17552, Avg test acc: 0.98112, Avg tpr: 0.94968, Avg fpr: 0.01831, total FA: 2542

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13410 | acc=0.9822 | tpr=0.9513 | fpr=0.0173 | 4361.5 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.14352 | acc=0.9814 | tpr=0.9659 | fpr=0.0183 | 8866.0 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.14870 | acc=0.9805 | tpr=0.9712 | fpr=0.0193 | 7766.7 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.14907 | acc=0.9806 | tpr=0.9716 | fpr=0.0193 | 9005.1 samples/s | 35.2 steps/s
[Step= 250] | Loss=0.14777 | acc=0.9806 | tpr=0.9703 | fpr=0.0192 | 8100.4 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.14864 | acc=0.9806 | tpr=0.9709 | fpr=0.0192 | 8129.3 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.15031 | acc=0.9804 | tpr=0.9706 | fpr=0.0194 | 9129.4 samples/s | 35.7 steps/s
[Step= 400] | Loss=0.15249 | acc=0.9802 | tpr=0.9694 | fpr=0.0196 | 7858.1 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.15509 | acc=0.9799 | tpr=0.9674 | fpr=0.0199 | 8410.3 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.15492 | acc=0.9798 | tpr=0.9661 | fpr=0.0200 | 8262.6 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.15404 | acc=0.9798 | tpr=0.9634 | fpr=0.0199 | 15199.5 samples/s | 59.4 steps/s
Avg test loss: 0.15371, Avg test acc: 0.97985, Avg tpr: 0.96355, Avg fpr: 0.01986, total FA: 2757

server round 27/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=54001 Epoch=105.3] | Loss=0.00993 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.836 | L2-Norm(final)=15.557 | 3982.4 samples/s | 62.2 steps/s
[Step=54050 Epoch=105.4] | Loss=0.00952 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.837 | L2-Norm(final)=15.561 | 5493.4 samples/s | 85.8 steps/s
[Step=54100 Epoch=105.5] | Loss=0.00905 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.837 | L2-Norm(final)=15.566 | 5550.6 samples/s | 86.7 steps/s
[Step=54150 Epoch=105.6] | Loss=0.00962 | Reg=0.00140 | acc=0.9531 | L2-Norm=11.837 | L2-Norm(final)=15.571 | 5499.9 samples/s | 85.9 steps/s
[Step=54200 Epoch=105.7] | Loss=0.01035 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.837 | L2-Norm(final)=15.576 | 5361.8 samples/s | 83.8 steps/s
[Step=54250 Epoch=105.8] | Loss=0.00980 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.837 | L2-Norm(final)=15.579 | 5402.7 samples/s | 84.4 steps/s
[Step=54300 Epoch=105.9] | Loss=0.00964 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.837 | L2-Norm(final)=15.584 | 5467.9 samples/s | 85.4 steps/s
[Step=54350 Epoch=106.0] | Loss=0.00949 | Reg=0.00140 | acc=0.9531 | L2-Norm=11.837 | L2-Norm(final)=15.588 | 5395.6 samples/s | 84.3 steps/s
[Step=54400 Epoch=106.1] | Loss=0.00946 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.837 | L2-Norm(final)=15.593 | 5451.5 samples/s | 85.2 steps/s
[Step=54450 Epoch=106.2] | Loss=0.00928 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.837 | L2-Norm(final)=15.598 | 5479.1 samples/s | 85.6 steps/s
[Step=54500 Epoch=106.3] | Loss=0.00915 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.837 | L2-Norm(final)=15.603 | 6868.9 samples/s | 107.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=54501 Epoch=106.3] | Loss=0.00490 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.837 | L2-Norm(final)=15.655 | 3981.0 samples/s | 62.2 steps/s
[Step=54550 Epoch=106.4] | Loss=0.00832 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.855 | L2-Norm(final)=15.657 | 4681.7 samples/s | 73.2 steps/s
[Step=54600 Epoch=106.5] | Loss=0.00833 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=15.661 | 4769.7 samples/s | 74.5 steps/s
[Step=54650 Epoch=106.6] | Loss=0.00976 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.886 | L2-Norm(final)=15.662 | 4772.8 samples/s | 74.6 steps/s
[Step=54700 Epoch=106.7] | Loss=0.01013 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.897 | L2-Norm(final)=15.661 | 4808.6 samples/s | 75.1 steps/s
[Step=54750 Epoch=106.8] | Loss=0.01022 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.907 | L2-Norm(final)=15.660 | 4834.5 samples/s | 75.5 steps/s
[Step=54800 Epoch=106.9] | Loss=0.01028 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.916 | L2-Norm(final)=15.660 | 4721.6 samples/s | 73.8 steps/s
[Step=54850 Epoch=107.0] | Loss=0.00988 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.925 | L2-Norm(final)=15.661 | 4775.8 samples/s | 74.6 steps/s
[Step=54900 Epoch=107.1] | Loss=0.01008 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.932 | L2-Norm(final)=15.662 | 4722.3 samples/s | 73.8 steps/s
[Step=54950 Epoch=107.2] | Loss=0.01006 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.939 | L2-Norm(final)=15.663 | 4702.8 samples/s | 73.5 steps/s
[Step=55000 Epoch=107.3] | Loss=0.01005 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.945 | L2-Norm(final)=15.664 | 5565.1 samples/s | 87.0 steps/s
[Step=55050 Epoch=107.4] | Loss=0.00985 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.951 | L2-Norm(final)=15.665 | 1966.5 samples/s | 30.7 steps/s
[Step=55100 Epoch=107.5] | Loss=0.00979 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.957 | L2-Norm(final)=15.667 | 4704.6 samples/s | 73.5 steps/s
[Step=55150 Epoch=107.6] | Loss=0.00956 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.962 | L2-Norm(final)=15.668 | 4750.2 samples/s | 74.2 steps/s
[Step=55200 Epoch=107.7] | Loss=0.00938 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.967 | L2-Norm(final)=15.670 | 4690.9 samples/s | 73.3 steps/s
[Step=55250 Epoch=107.8] | Loss=0.00913 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=15.671 | 4720.6 samples/s | 73.8 steps/s
[Step=55300 Epoch=107.9] | Loss=0.00896 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.976 | L2-Norm(final)=15.673 | 4736.7 samples/s | 74.0 steps/s
[Step=55350 Epoch=108.0] | Loss=0.00907 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.980 | L2-Norm(final)=15.675 | 4754.4 samples/s | 74.3 steps/s
[Step=55400 Epoch=108.1] | Loss=0.00906 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.984 | L2-Norm(final)=15.676 | 4812.3 samples/s | 75.2 steps/s
[Step=55450 Epoch=108.1] | Loss=0.00891 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.989 | L2-Norm(final)=15.678 | 4784.6 samples/s | 74.8 steps/s
[Step=55500 Epoch=108.2] | Loss=0.00891 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.993 | L2-Norm(final)=15.679 | 5047.4 samples/s | 78.9 steps/s
[Step=55550 Epoch=108.3] | Loss=0.00882 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.997 | L2-Norm(final)=15.681 | 2109.1 samples/s | 33.0 steps/s
[Step=55600 Epoch=108.4] | Loss=0.00872 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.000 | L2-Norm(final)=15.682 | 4728.1 samples/s | 73.9 steps/s
[Step=55650 Epoch=108.5] | Loss=0.00867 | Reg=0.00144 | acc=0.9844 | L2-Norm=12.004 | L2-Norm(final)=15.684 | 4744.9 samples/s | 74.1 steps/s
[Step=55700 Epoch=108.6] | Loss=0.00861 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.008 | L2-Norm(final)=15.685 | 4753.3 samples/s | 74.3 steps/s
[Step=55750 Epoch=108.7] | Loss=0.00860 | Reg=0.00144 | acc=0.9844 | L2-Norm=12.011 | L2-Norm(final)=15.686 | 4818.3 samples/s | 75.3 steps/s
[Step=55800 Epoch=108.8] | Loss=0.00855 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.014 | L2-Norm(final)=15.688 | 4652.8 samples/s | 72.7 steps/s
[Step=55850 Epoch=108.9] | Loss=0.00846 | Reg=0.00144 | acc=0.9844 | L2-Norm=12.018 | L2-Norm(final)=15.689 | 4756.6 samples/s | 74.3 steps/s
[Step=55900 Epoch=109.0] | Loss=0.00839 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.021 | L2-Norm(final)=15.690 | 4792.1 samples/s | 74.9 steps/s
[Step=55950 Epoch=109.1] | Loss=0.00833 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.024 | L2-Norm(final)=15.691 | 4756.9 samples/s | 74.3 steps/s
[Step=56000 Epoch=109.2] | Loss=0.00826 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.027 | L2-Norm(final)=15.693 | 4726.5 samples/s | 73.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step56000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=54001 Epoch=105.6] | Loss=0.00957 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.836 | L2-Norm(final)=15.997 | 4477.8 samples/s | 70.0 steps/s
[Step=54050 Epoch=105.7] | Loss=0.01143 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.837 | L2-Norm(final)=16.000 | 5163.0 samples/s | 80.7 steps/s
[Step=54100 Epoch=105.8] | Loss=0.01071 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.837 | L2-Norm(final)=16.003 | 5389.4 samples/s | 84.2 steps/s
[Step=54150 Epoch=105.9] | Loss=0.01005 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.838 | L2-Norm(final)=16.007 | 5430.5 samples/s | 84.9 steps/s
[Step=54200 Epoch=106.0] | Loss=0.01046 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.838 | L2-Norm(final)=16.011 | 5468.3 samples/s | 85.4 steps/s
[Step=54250 Epoch=106.1] | Loss=0.01009 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.838 | L2-Norm(final)=16.014 | 5489.6 samples/s | 85.8 steps/s
[Step=54300 Epoch=106.2] | Loss=0.01006 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.838 | L2-Norm(final)=16.017 | 5534.2 samples/s | 86.5 steps/s
[Step=54350 Epoch=106.3] | Loss=0.01001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.838 | L2-Norm(final)=16.020 | 5415.7 samples/s | 84.6 steps/s
[Step=54400 Epoch=106.4] | Loss=0.01027 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.838 | L2-Norm(final)=16.023 | 5452.0 samples/s | 85.2 steps/s
[Step=54450 Epoch=106.4] | Loss=0.01006 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.838 | L2-Norm(final)=16.025 | 5486.6 samples/s | 85.7 steps/s
[Step=54500 Epoch=106.5] | Loss=0.00992 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.838 | L2-Norm(final)=16.027 | 6991.2 samples/s | 109.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=54501 Epoch=106.5] | Loss=0.00205 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.838 | L2-Norm(final)=16.053 | 4261.7 samples/s | 66.6 steps/s
[Step=54550 Epoch=106.6] | Loss=0.01007 | Reg=0.00141 | acc=0.9531 | L2-Norm=11.858 | L2-Norm(final)=16.057 | 4874.5 samples/s | 76.2 steps/s
[Step=54600 Epoch=106.7] | Loss=0.01055 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.877 | L2-Norm(final)=16.058 | 4834.8 samples/s | 75.5 steps/s
[Step=54650 Epoch=106.8] | Loss=0.01080 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.894 | L2-Norm(final)=16.060 | 4933.1 samples/s | 77.1 steps/s
[Step=54700 Epoch=106.9] | Loss=0.01120 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.907 | L2-Norm(final)=16.060 | 4712.3 samples/s | 73.6 steps/s
[Step=54750 Epoch=107.0] | Loss=0.01082 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.919 | L2-Norm(final)=16.060 | 4689.1 samples/s | 73.3 steps/s
[Step=54800 Epoch=107.1] | Loss=0.01050 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.929 | L2-Norm(final)=16.061 | 4806.8 samples/s | 75.1 steps/s
[Step=54850 Epoch=107.2] | Loss=0.01033 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.937 | L2-Norm(final)=16.061 | 4796.6 samples/s | 74.9 steps/s
[Step=54900 Epoch=107.3] | Loss=0.01011 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.946 | L2-Norm(final)=16.062 | 4710.7 samples/s | 73.6 steps/s
[Step=54950 Epoch=107.4] | Loss=0.00995 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.954 | L2-Norm(final)=16.064 | 4752.8 samples/s | 74.3 steps/s
[Step=55000 Epoch=107.5] | Loss=0.01016 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.962 | L2-Norm(final)=16.065 | 5814.1 samples/s | 90.8 steps/s
[Step=55050 Epoch=107.6] | Loss=0.00992 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.969 | L2-Norm(final)=16.067 | 2026.7 samples/s | 31.7 steps/s
[Step=55100 Epoch=107.7] | Loss=0.00966 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.976 | L2-Norm(final)=16.069 | 4900.1 samples/s | 76.6 steps/s
[Step=55150 Epoch=107.8] | Loss=0.00960 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.982 | L2-Norm(final)=16.070 | 4828.2 samples/s | 75.4 steps/s
[Step=55200 Epoch=107.9] | Loss=0.00951 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.988 | L2-Norm(final)=16.072 | 4797.8 samples/s | 75.0 steps/s
[Step=55250 Epoch=108.0] | Loss=0.00930 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.994 | L2-Norm(final)=16.073 | 4760.5 samples/s | 74.4 steps/s
[Step=55300 Epoch=108.1] | Loss=0.00909 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.999 | L2-Norm(final)=16.075 | 4799.4 samples/s | 75.0 steps/s
[Step=55350 Epoch=108.2] | Loss=0.00902 | Reg=0.00144 | acc=0.9844 | L2-Norm=12.004 | L2-Norm(final)=16.077 | 4790.7 samples/s | 74.9 steps/s
[Step=55400 Epoch=108.3] | Loss=0.00897 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.009 | L2-Norm(final)=16.078 | 4703.5 samples/s | 73.5 steps/s
[Step=55450 Epoch=108.4] | Loss=0.00891 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.013 | L2-Norm(final)=16.080 | 4772.4 samples/s | 74.6 steps/s
[Step=55500 Epoch=108.5] | Loss=0.00886 | Reg=0.00144 | acc=0.9844 | L2-Norm=12.018 | L2-Norm(final)=16.081 | 5115.6 samples/s | 79.9 steps/s
[Step=55550 Epoch=108.6] | Loss=0.00877 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.023 | L2-Norm(final)=16.083 | 2113.3 samples/s | 33.0 steps/s
[Step=55600 Epoch=108.7] | Loss=0.00869 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.027 | L2-Norm(final)=16.085 | 4761.8 samples/s | 74.4 steps/s
[Step=55650 Epoch=108.8] | Loss=0.00866 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.031 | L2-Norm(final)=16.086 | 4703.5 samples/s | 73.5 steps/s
[Step=55700 Epoch=108.9] | Loss=0.00871 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.035 | L2-Norm(final)=16.087 | 4825.1 samples/s | 75.4 steps/s
[Step=55750 Epoch=109.0] | Loss=0.00857 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.039 | L2-Norm(final)=16.088 | 4679.4 samples/s | 73.1 steps/s
[Step=55800 Epoch=109.1] | Loss=0.00842 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.043 | L2-Norm(final)=16.089 | 4787.0 samples/s | 74.8 steps/s
[Step=55850 Epoch=109.2] | Loss=0.00841 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.046 | L2-Norm(final)=16.090 | 4757.9 samples/s | 74.3 steps/s
[Step=55900 Epoch=109.3] | Loss=0.00839 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.050 | L2-Norm(final)=16.091 | 4736.4 samples/s | 74.0 steps/s
[Step=55950 Epoch=109.4] | Loss=0.00836 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.053 | L2-Norm(final)=16.092 | 4778.9 samples/s | 74.7 steps/s
[Step=56000 Epoch=109.5] | Loss=0.00829 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.056 | L2-Norm(final)=16.093 | 4699.7 samples/s | 73.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step56000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=54001 Epoch=206.9] | Loss=0.00000 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.836 | L2-Norm(final)=17.316 | 4175.5 samples/s | 65.2 steps/s
[Step=54050 Epoch=207.1] | Loss=0.00008 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.831 | L2-Norm(final)=17.322 | 5142.0 samples/s | 80.3 steps/s
[Step=54100 Epoch=207.3] | Loss=0.00006 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.830 | L2-Norm(final)=17.328 | 5232.5 samples/s | 81.8 steps/s
[Step=54150 Epoch=207.5] | Loss=0.00006 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.830 | L2-Norm(final)=17.332 | 5255.7 samples/s | 82.1 steps/s
[Step=54200 Epoch=207.7] | Loss=0.00007 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.830 | L2-Norm(final)=17.338 | 5288.6 samples/s | 82.6 steps/s
[Step=54250 Epoch=207.9] | Loss=0.00008 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.830 | L2-Norm(final)=17.342 | 6965.7 samples/s | 108.8 steps/s
[Step=54300 Epoch=208.1] | Loss=0.00007 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.830 | L2-Norm(final)=17.347 | 2080.5 samples/s | 32.5 steps/s
[Step=54350 Epoch=208.3] | Loss=0.00007 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.830 | L2-Norm(final)=17.352 | 5162.2 samples/s | 80.7 steps/s
[Step=54400 Epoch=208.4] | Loss=0.00007 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.830 | L2-Norm(final)=17.356 | 5255.2 samples/s | 82.1 steps/s
[Step=54450 Epoch=208.6] | Loss=0.00007 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.830 | L2-Norm(final)=17.360 | 5137.4 samples/s | 80.3 steps/s
[Step=54500 Epoch=208.8] | Loss=0.00007 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.830 | L2-Norm(final)=17.365 | 5803.3 samples/s | 90.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=54501 Epoch=208.8] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.829 | L2-Norm(final)=17.407 | 4509.0 samples/s | 70.5 steps/s
[Step=54550 Epoch=209.0] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.810 | L2-Norm(final)=17.410 | 4038.9 samples/s | 63.1 steps/s
[Step=54600 Epoch=209.2] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=17.411 | 4517.4 samples/s | 70.6 steps/s
[Step=54650 Epoch=209.4] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.761 | L2-Norm(final)=17.412 | 4505.7 samples/s | 70.4 steps/s
[Step=54700 Epoch=209.6] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.736 | L2-Norm(final)=17.413 | 4593.1 samples/s | 71.8 steps/s
[Step=54750 Epoch=209.8] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.710 | L2-Norm(final)=17.413 | 5611.4 samples/s | 87.7 steps/s
[Step=54800 Epoch=210.0] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=17.414 | 1963.1 samples/s | 30.7 steps/s
[Step=54850 Epoch=210.2] | Loss=0.00000 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.657 | L2-Norm(final)=17.414 | 4407.0 samples/s | 68.9 steps/s
[Step=54900 Epoch=210.4] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.630 | L2-Norm(final)=17.415 | 4626.8 samples/s | 72.3 steps/s
[Step=54950 Epoch=210.5] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.603 | L2-Norm(final)=17.415 | 4379.8 samples/s | 68.4 steps/s
[Step=55000 Epoch=210.7] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.577 | L2-Norm(final)=17.416 | 4980.9 samples/s | 77.8 steps/s
[Step=55050 Epoch=210.9] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.550 | L2-Norm(final)=17.416 | 2011.9 samples/s | 31.4 steps/s
[Step=55100 Epoch=211.1] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.523 | L2-Norm(final)=17.417 | 4469.0 samples/s | 69.8 steps/s
[Step=55150 Epoch=211.3] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.496 | L2-Norm(final)=17.417 | 4554.3 samples/s | 71.2 steps/s
[Step=55200 Epoch=211.5] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.469 | L2-Norm(final)=17.418 | 4533.7 samples/s | 70.8 steps/s
[Step=55250 Epoch=211.7] | Loss=0.00000 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.442 | L2-Norm(final)=17.419 | 4449.3 samples/s | 69.5 steps/s
[Step=55300 Epoch=211.9] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.415 | L2-Norm(final)=17.419 | 2100.5 samples/s | 32.8 steps/s
[Step=55350 Epoch=212.1] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.388 | L2-Norm(final)=17.420 | 4572.2 samples/s | 71.4 steps/s
[Step=55400 Epoch=212.3] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.361 | L2-Norm(final)=17.420 | 4493.2 samples/s | 70.2 steps/s
[Step=55450 Epoch=212.5] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.334 | L2-Norm(final)=17.421 | 4534.4 samples/s | 70.8 steps/s
[Step=55500 Epoch=212.7] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.306 | L2-Norm(final)=17.422 | 4495.7 samples/s | 70.2 steps/s
[Step=55550 Epoch=212.8] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.279 | L2-Norm(final)=17.423 | 2146.5 samples/s | 33.5 steps/s
[Step=55600 Epoch=213.0] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.251 | L2-Norm(final)=17.423 | 4510.1 samples/s | 70.5 steps/s
[Step=55650 Epoch=213.2] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.224 | L2-Norm(final)=17.424 | 4500.5 samples/s | 70.3 steps/s
[Step=55700 Epoch=213.4] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.196 | L2-Norm(final)=17.425 | 4495.6 samples/s | 70.2 steps/s
[Step=55750 Epoch=213.6] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.168 | L2-Norm(final)=17.426 | 4561.8 samples/s | 71.3 steps/s
[Step=55800 Epoch=213.8] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.140 | L2-Norm(final)=17.427 | 6094.0 samples/s | 95.2 steps/s
[Step=55850 Epoch=214.0] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.112 | L2-Norm(final)=17.427 | 1871.0 samples/s | 29.2 steps/s
[Step=55900 Epoch=214.2] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.084 | L2-Norm(final)=17.428 | 4539.9 samples/s | 70.9 steps/s
[Step=55950 Epoch=214.4] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.055 | L2-Norm(final)=17.429 | 4498.2 samples/s | 70.3 steps/s
[Step=56000 Epoch=214.6] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.027 | L2-Norm(final)=17.430 | 4541.8 samples/s | 71.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step56000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=54001 Epoch=207.9] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.836 | L2-Norm(final)=17.127 | 4380.0 samples/s | 68.4 steps/s
[Step=54050 Epoch=208.1] | Loss=0.00009 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.833 | L2-Norm(final)=17.133 | 4597.2 samples/s | 71.8 steps/s
[Step=54100 Epoch=208.3] | Loss=0.00007 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.832 | L2-Norm(final)=17.146 | 5152.7 samples/s | 80.5 steps/s
[Step=54150 Epoch=208.4] | Loss=0.00007 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.832 | L2-Norm(final)=17.156 | 5132.2 samples/s | 80.2 steps/s
[Step=54200 Epoch=208.6] | Loss=0.00008 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.832 | L2-Norm(final)=17.169 | 5193.9 samples/s | 81.2 steps/s
[Step=54250 Epoch=208.8] | Loss=0.00007 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.832 | L2-Norm(final)=17.180 | 6844.7 samples/s | 106.9 steps/s
[Step=54300 Epoch=209.0] | Loss=0.00007 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.832 | L2-Norm(final)=17.190 | 2025.6 samples/s | 31.6 steps/s
[Step=54350 Epoch=209.2] | Loss=0.00007 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.832 | L2-Norm(final)=17.199 | 5254.9 samples/s | 82.1 steps/s
[Step=54400 Epoch=209.4] | Loss=0.00007 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.832 | L2-Norm(final)=17.209 | 5146.8 samples/s | 80.4 steps/s
[Step=54450 Epoch=209.6] | Loss=0.00007 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.832 | L2-Norm(final)=17.218 | 5291.4 samples/s | 82.7 steps/s
[Step=54500 Epoch=209.8] | Loss=0.00007 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.832 | L2-Norm(final)=17.228 | 5838.2 samples/s | 91.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=54501 Epoch=209.8] | Loss=0.00002 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.832 | L2-Norm(final)=17.321 | 4462.0 samples/s | 69.7 steps/s
[Step=54550 Epoch=210.0] | Loss=0.00002 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=17.326 | 4280.4 samples/s | 66.9 steps/s
[Step=54600 Epoch=210.2] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.812 | L2-Norm(final)=17.329 | 4522.4 samples/s | 70.7 steps/s
[Step=54650 Epoch=210.4] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.795 | L2-Norm(final)=17.331 | 4447.4 samples/s | 69.5 steps/s
[Step=54700 Epoch=210.6] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.778 | L2-Norm(final)=17.332 | 4519.8 samples/s | 70.6 steps/s
[Step=54750 Epoch=210.8] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.761 | L2-Norm(final)=17.334 | 5742.3 samples/s | 89.7 steps/s
[Step=54800 Epoch=210.9] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.744 | L2-Norm(final)=17.335 | 1937.0 samples/s | 30.3 steps/s
[Step=54850 Epoch=211.1] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.727 | L2-Norm(final)=17.336 | 4521.7 samples/s | 70.7 steps/s
[Step=54900 Epoch=211.3] | Loss=0.00000 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.709 | L2-Norm(final)=17.337 | 4521.6 samples/s | 70.6 steps/s
[Step=54950 Epoch=211.5] | Loss=0.00000 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.692 | L2-Norm(final)=17.338 | 4489.8 samples/s | 70.2 steps/s
[Step=55000 Epoch=211.7] | Loss=0.00000 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.674 | L2-Norm(final)=17.339 | 5052.6 samples/s | 78.9 steps/s
[Step=55050 Epoch=211.9] | Loss=0.00000 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.657 | L2-Norm(final)=17.340 | 2031.1 samples/s | 31.7 steps/s
[Step=55100 Epoch=212.1] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.639 | L2-Norm(final)=17.341 | 4508.5 samples/s | 70.4 steps/s
[Step=55150 Epoch=212.3] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.621 | L2-Norm(final)=17.342 | 4501.8 samples/s | 70.3 steps/s
[Step=55200 Epoch=212.5] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.604 | L2-Norm(final)=17.343 | 4456.4 samples/s | 69.6 steps/s
[Step=55250 Epoch=212.7] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.586 | L2-Norm(final)=17.343 | 4620.1 samples/s | 72.2 steps/s
[Step=55300 Epoch=212.9] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.568 | L2-Norm(final)=17.344 | 2087.1 samples/s | 32.6 steps/s
[Step=55350 Epoch=213.1] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.550 | L2-Norm(final)=17.345 | 4627.4 samples/s | 72.3 steps/s
[Step=55400 Epoch=213.3] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.531 | L2-Norm(final)=17.346 | 4465.3 samples/s | 69.8 steps/s
[Step=55450 Epoch=213.4] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.513 | L2-Norm(final)=17.347 | 4504.8 samples/s | 70.4 steps/s
[Step=55500 Epoch=213.6] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.494 | L2-Norm(final)=17.348 | 4477.2 samples/s | 70.0 steps/s
[Step=55550 Epoch=213.8] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=17.348 | 2138.9 samples/s | 33.4 steps/s
[Step=55600 Epoch=214.0] | Loss=0.00000 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.457 | L2-Norm(final)=17.349 | 4574.4 samples/s | 71.5 steps/s
[Step=55650 Epoch=214.2] | Loss=0.00000 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.438 | L2-Norm(final)=17.350 | 4578.2 samples/s | 71.5 steps/s
[Step=55700 Epoch=214.4] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.419 | L2-Norm(final)=17.351 | 4546.2 samples/s | 71.0 steps/s
[Step=55750 Epoch=214.6] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.400 | L2-Norm(final)=17.352 | 4428.0 samples/s | 69.2 steps/s
[Step=55800 Epoch=214.8] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=17.353 | 6177.3 samples/s | 96.5 steps/s
[Step=55850 Epoch=215.0] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.362 | L2-Norm(final)=17.354 | 1850.5 samples/s | 28.9 steps/s
[Step=55900 Epoch=215.2] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.342 | L2-Norm(final)=17.355 | 4481.7 samples/s | 70.0 steps/s
[Step=55950 Epoch=215.4] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.322 | L2-Norm(final)=17.356 | 4584.0 samples/s | 71.6 steps/s
[Step=56000 Epoch=215.6] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.303 | L2-Norm(final)=17.357 | 4502.8 samples/s | 70.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step56000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07061 | acc=0.9692 | tpr=0.9759 | fpr=0.0453 | 4375.4 samples/s | 17.1 steps/s
Avg test loss: 0.06974, Avg test acc: 0.97003, Avg tpr: 0.97669, Avg fpr: 0.04461, total FA: 348

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07259 | acc=0.9707 | tpr=0.9770 | fpr=0.0429 | 4323.6 samples/s | 16.9 steps/s
Avg test loss: 0.07302, Avg test acc: 0.97087, Avg tpr: 0.97692, Avg fpr: 0.04243, total FA: 331

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.59803 | acc=0.3123 | tpr=0.0132 | fpr=0.0384 | 4399.5 samples/s | 17.2 steps/s
Avg test loss: 5.61878, Avg test acc: 0.30948, Avg tpr: 0.01352, Avg fpr: 0.03961, total FA: 309

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.04577 | acc=0.3030 | tpr=0.0122 | fpr=0.0657 | 4455.5 samples/s | 17.4 steps/s
Avg test loss: 6.06399, Avg test acc: 0.30006, Avg tpr: 0.01236, Avg fpr: 0.06717, total FA: 524

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.39450 | acc=0.1005 | tpr=0.7611 | fpr=0.9114 | 4444.8 samples/s | 17.4 steps/s
[Step= 100] | Loss=6.36416 | acc=0.1011 | tpr=0.7505 | fpr=0.9111 | 8483.2 samples/s | 33.1 steps/s
[Step= 150] | Loss=6.37909 | acc=0.1002 | tpr=0.7565 | fpr=0.9118 | 8223.0 samples/s | 32.1 steps/s
[Step= 200] | Loss=6.37739 | acc=0.1000 | tpr=0.7454 | fpr=0.9117 | 8337.4 samples/s | 32.6 steps/s
[Step= 250] | Loss=6.38914 | acc=0.0997 | tpr=0.7493 | fpr=0.9122 | 5862.9 samples/s | 22.9 steps/s
[Step= 300] | Loss=6.38400 | acc=0.0995 | tpr=0.7498 | fpr=0.9124 | 8252.4 samples/s | 32.2 steps/s
[Step= 350] | Loss=6.38369 | acc=0.0988 | tpr=0.7489 | fpr=0.9130 | 8180.3 samples/s | 32.0 steps/s
[Step= 400] | Loss=6.39113 | acc=0.0985 | tpr=0.7478 | fpr=0.9133 | 8531.6 samples/s | 33.3 steps/s
[Step= 450] | Loss=6.39376 | acc=0.0987 | tpr=0.7478 | fpr=0.9131 | 6675.7 samples/s | 26.1 steps/s
[Step= 500] | Loss=6.39285 | acc=0.0986 | tpr=0.7507 | fpr=0.9132 | 8377.9 samples/s | 32.7 steps/s
[Step= 550] | Loss=6.39781 | acc=0.0982 | tpr=0.7441 | fpr=0.9135 | 15289.0 samples/s | 59.7 steps/s
Avg test loss: 6.39805, Avg test acc: 0.09810, Avg tpr: 0.74406, Avg fpr: 0.91365, total FA: 126858

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.72485 | acc=0.1223 | tpr=0.7478 | fpr=0.8889 | 4402.6 samples/s | 17.2 steps/s
[Step= 100] | Loss=6.70007 | acc=0.1221 | tpr=0.7207 | fpr=0.8891 | 8373.2 samples/s | 32.7 steps/s
[Step= 150] | Loss=6.70836 | acc=0.1220 | tpr=0.7262 | fpr=0.8892 | 8122.7 samples/s | 31.7 steps/s
[Step= 200] | Loss=6.70368 | acc=0.1216 | tpr=0.7148 | fpr=0.8892 | 8594.6 samples/s | 33.6 steps/s
[Step= 250] | Loss=6.72092 | acc=0.1211 | tpr=0.7144 | fpr=0.8897 | 5771.6 samples/s | 22.5 steps/s
[Step= 300] | Loss=6.71663 | acc=0.1207 | tpr=0.7120 | fpr=0.8901 | 8476.4 samples/s | 33.1 steps/s
[Step= 350] | Loss=6.71486 | acc=0.1201 | tpr=0.7126 | fpr=0.8906 | 8441.7 samples/s | 33.0 steps/s
[Step= 400] | Loss=6.72348 | acc=0.1200 | tpr=0.7090 | fpr=0.8907 | 8532.9 samples/s | 33.3 steps/s
[Step= 450] | Loss=6.72475 | acc=0.1201 | tpr=0.7123 | fpr=0.8906 | 6702.2 samples/s | 26.2 steps/s
[Step= 500] | Loss=6.72457 | acc=0.1200 | tpr=0.7132 | fpr=0.8907 | 8361.1 samples/s | 32.7 steps/s
[Step= 550] | Loss=6.72914 | acc=0.1198 | tpr=0.7067 | fpr=0.8909 | 15656.2 samples/s | 61.2 steps/s
Avg test loss: 6.72919, Avg test acc: 0.11971, Avg tpr: 0.70642, Avg fpr: 0.89095, total FA: 123707

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12438 | acc=0.9816 | tpr=0.9425 | fpr=0.0177 | 4420.3 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.13274 | acc=0.9810 | tpr=0.9574 | fpr=0.0185 | 8386.4 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.13700 | acc=0.9806 | tpr=0.9611 | fpr=0.0191 | 8550.3 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.13779 | acc=0.9806 | tpr=0.9628 | fpr=0.0191 | 8425.7 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.13636 | acc=0.9807 | tpr=0.9616 | fpr=0.0189 | 7878.0 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.13768 | acc=0.9806 | tpr=0.9607 | fpr=0.0191 | 8393.3 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.13925 | acc=0.9804 | tpr=0.9612 | fpr=0.0193 | 8471.4 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.14092 | acc=0.9803 | tpr=0.9595 | fpr=0.0193 | 6876.6 samples/s | 26.9 steps/s
[Step= 450] | Loss=0.14348 | acc=0.9801 | tpr=0.9581 | fpr=0.0195 | 6060.4 samples/s | 23.7 steps/s
[Step= 500] | Loss=0.14341 | acc=0.9800 | tpr=0.9581 | fpr=0.0196 | 8513.6 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.14241 | acc=0.9800 | tpr=0.9550 | fpr=0.0195 | 15023.4 samples/s | 58.7 steps/s
Avg test loss: 0.14201, Avg test acc: 0.98007, Avg tpr: 0.95523, Avg fpr: 0.01947, total FA: 2704

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11931 | acc=0.9838 | tpr=0.9469 | fpr=0.0156 | 4408.1 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.12735 | acc=0.9832 | tpr=0.9638 | fpr=0.0164 | 8491.7 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.13214 | acc=0.9825 | tpr=0.9683 | fpr=0.0172 | 8291.3 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.13266 | acc=0.9825 | tpr=0.9683 | fpr=0.0173 | 8264.1 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.13146 | acc=0.9825 | tpr=0.9651 | fpr=0.0172 | 8465.0 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.13250 | acc=0.9825 | tpr=0.9658 | fpr=0.0172 | 8371.6 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.13403 | acc=0.9822 | tpr=0.9649 | fpr=0.0175 | 8189.0 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.13604 | acc=0.9821 | tpr=0.9633 | fpr=0.0176 | 4963.2 samples/s | 19.4 steps/s
[Step= 450] | Loss=0.13857 | acc=0.9817 | tpr=0.9615 | fpr=0.0179 | 8694.8 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.13829 | acc=0.9816 | tpr=0.9608 | fpr=0.0180 | 8621.3 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.13750 | acc=0.9817 | tpr=0.9578 | fpr=0.0179 | 14160.9 samples/s | 55.3 steps/s
Avg test loss: 0.13719, Avg test acc: 0.98169, Avg tpr: 0.95800, Avg fpr: 0.01788, total FA: 2482

server round 28/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=56001 Epoch=109.2] | Loss=0.00270 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=15.726 | 3948.4 samples/s | 61.7 steps/s
[Step=56050 Epoch=109.3] | Loss=0.01431 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.191 | L2-Norm(final)=15.732 | 5238.2 samples/s | 81.8 steps/s
[Step=56100 Epoch=109.4] | Loss=0.01247 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=15.741 | 5582.2 samples/s | 87.2 steps/s
[Step=56150 Epoch=109.5] | Loss=0.01160 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=15.753 | 5634.3 samples/s | 88.0 steps/s
[Step=56200 Epoch=109.6] | Loss=0.01100 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.192 | L2-Norm(final)=15.763 | 5698.0 samples/s | 89.0 steps/s
[Step=56250 Epoch=109.7] | Loss=0.01126 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.192 | L2-Norm(final)=15.772 | 5584.1 samples/s | 87.3 steps/s
[Step=56300 Epoch=109.8] | Loss=0.01117 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.192 | L2-Norm(final)=15.782 | 5628.1 samples/s | 87.9 steps/s
[Step=56350 Epoch=109.9] | Loss=0.01098 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.192 | L2-Norm(final)=15.790 | 5665.3 samples/s | 88.5 steps/s
[Step=56400 Epoch=110.0] | Loss=0.01072 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.192 | L2-Norm(final)=15.798 | 5634.7 samples/s | 88.0 steps/s
[Step=56450 Epoch=110.1] | Loss=0.01049 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.192 | L2-Norm(final)=15.807 | 5646.5 samples/s | 88.2 steps/s
[Step=56500 Epoch=110.2] | Loss=0.01033 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.192 | L2-Norm(final)=15.815 | 7088.4 samples/s | 110.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=56501 Epoch=110.2] | Loss=0.01557 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.192 | L2-Norm(final)=15.900 | 4154.4 samples/s | 64.9 steps/s
[Step=56550 Epoch=110.3] | Loss=0.01033 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.216 | L2-Norm(final)=15.904 | 4516.3 samples/s | 70.6 steps/s
[Step=56600 Epoch=110.4] | Loss=0.01332 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.239 | L2-Norm(final)=15.907 | 4888.9 samples/s | 76.4 steps/s
[Step=56650 Epoch=110.5] | Loss=0.01282 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.257 | L2-Norm(final)=15.909 | 4713.7 samples/s | 73.7 steps/s
[Step=56700 Epoch=110.6] | Loss=0.01244 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.273 | L2-Norm(final)=15.912 | 4731.6 samples/s | 73.9 steps/s
[Step=56750 Epoch=110.7] | Loss=0.01197 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.287 | L2-Norm(final)=15.915 | 4783.0 samples/s | 74.7 steps/s
[Step=56800 Epoch=110.8] | Loss=0.01182 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.299 | L2-Norm(final)=15.917 | 4705.3 samples/s | 73.5 steps/s
[Step=56850 Epoch=110.9] | Loss=0.01186 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.311 | L2-Norm(final)=15.919 | 4777.1 samples/s | 74.6 steps/s
[Step=56900 Epoch=111.0] | Loss=0.01165 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.321 | L2-Norm(final)=15.921 | 4730.0 samples/s | 73.9 steps/s
[Step=56950 Epoch=111.1] | Loss=0.01159 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.331 | L2-Norm(final)=15.923 | 4709.6 samples/s | 73.6 steps/s
[Step=57000 Epoch=111.2] | Loss=0.01130 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.340 | L2-Norm(final)=15.925 | 5771.2 samples/s | 90.2 steps/s
[Step=57050 Epoch=111.3] | Loss=0.01100 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.349 | L2-Norm(final)=15.928 | 1978.7 samples/s | 30.9 steps/s
[Step=57100 Epoch=111.4] | Loss=0.01076 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.357 | L2-Norm(final)=15.930 | 4871.4 samples/s | 76.1 steps/s
[Step=57150 Epoch=111.5] | Loss=0.01062 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.365 | L2-Norm(final)=15.932 | 4814.0 samples/s | 75.2 steps/s
[Step=57200 Epoch=111.6] | Loss=0.01045 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.372 | L2-Norm(final)=15.934 | 4734.0 samples/s | 74.0 steps/s
[Step=57250 Epoch=111.7] | Loss=0.01043 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.379 | L2-Norm(final)=15.936 | 4780.6 samples/s | 74.7 steps/s
[Step=57300 Epoch=111.8] | Loss=0.01023 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.386 | L2-Norm(final)=15.938 | 4799.8 samples/s | 75.0 steps/s
[Step=57350 Epoch=111.9] | Loss=0.01002 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.392 | L2-Norm(final)=15.941 | 4799.2 samples/s | 75.0 steps/s
[Step=57400 Epoch=112.0] | Loss=0.00993 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.398 | L2-Norm(final)=15.943 | 4811.7 samples/s | 75.2 steps/s
[Step=57450 Epoch=112.0] | Loss=0.00978 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.403 | L2-Norm(final)=15.945 | 4696.2 samples/s | 73.4 steps/s
[Step=57500 Epoch=112.1] | Loss=0.00982 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.409 | L2-Norm(final)=15.947 | 5043.1 samples/s | 78.8 steps/s
[Step=57550 Epoch=112.2] | Loss=0.00969 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.414 | L2-Norm(final)=15.949 | 2037.6 samples/s | 31.8 steps/s
[Step=57600 Epoch=112.3] | Loss=0.00957 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.419 | L2-Norm(final)=15.952 | 4888.9 samples/s | 76.4 steps/s
[Step=57650 Epoch=112.4] | Loss=0.00944 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=15.954 | 4911.4 samples/s | 76.7 steps/s
[Step=57700 Epoch=112.5] | Loss=0.00929 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.428 | L2-Norm(final)=15.956 | 4871.4 samples/s | 76.1 steps/s
[Step=57750 Epoch=112.6] | Loss=0.00919 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.433 | L2-Norm(final)=15.958 | 4879.0 samples/s | 76.2 steps/s
[Step=57800 Epoch=112.7] | Loss=0.00916 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.437 | L2-Norm(final)=15.960 | 4946.1 samples/s | 77.3 steps/s
[Step=57850 Epoch=112.8] | Loss=0.00902 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.441 | L2-Norm(final)=15.962 | 4895.6 samples/s | 76.5 steps/s
[Step=57900 Epoch=112.9] | Loss=0.00889 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.446 | L2-Norm(final)=15.964 | 4807.1 samples/s | 75.1 steps/s
[Step=57950 Epoch=113.0] | Loss=0.00883 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.450 | L2-Norm(final)=15.966 | 4891.8 samples/s | 76.4 steps/s
[Step=58000 Epoch=113.1] | Loss=0.00880 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.454 | L2-Norm(final)=15.968 | 4906.7 samples/s | 76.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step58000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=56001 Epoch=109.5] | Loss=0.00540 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=16.128 | 4392.7 samples/s | 68.6 steps/s
[Step=56050 Epoch=109.6] | Loss=0.00887 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=16.139 | 5122.8 samples/s | 80.0 steps/s
[Step=56100 Epoch=109.7] | Loss=0.00921 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=16.151 | 5381.7 samples/s | 84.1 steps/s
[Step=56150 Epoch=109.8] | Loss=0.00925 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=16.159 | 5483.3 samples/s | 85.7 steps/s
[Step=56200 Epoch=109.9] | Loss=0.00944 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=16.167 | 5450.5 samples/s | 85.2 steps/s
[Step=56250 Epoch=110.0] | Loss=0.00976 | Reg=0.00125 | acc=0.9688 | L2-Norm=11.191 | L2-Norm(final)=16.175 | 5438.7 samples/s | 85.0 steps/s
[Step=56300 Epoch=110.1] | Loss=0.00958 | Reg=0.00125 | acc=0.9688 | L2-Norm=11.191 | L2-Norm(final)=16.181 | 5555.3 samples/s | 86.8 steps/s
[Step=56350 Epoch=110.2] | Loss=0.00961 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=16.188 | 5524.9 samples/s | 86.3 steps/s
[Step=56400 Epoch=110.3] | Loss=0.00947 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=16.195 | 5502.4 samples/s | 86.0 steps/s
[Step=56450 Epoch=110.4] | Loss=0.00943 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=16.202 | 5517.0 samples/s | 86.2 steps/s
[Step=56500 Epoch=110.5] | Loss=0.00941 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=16.208 | 7263.9 samples/s | 113.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=56501 Epoch=110.5] | Loss=0.00883 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.191 | L2-Norm(final)=16.270 | 4193.5 samples/s | 65.5 steps/s
[Step=56550 Epoch=110.6] | Loss=0.01062 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=16.277 | 4650.0 samples/s | 72.7 steps/s
[Step=56600 Epoch=110.7] | Loss=0.01216 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.239 | L2-Norm(final)=16.278 | 4742.5 samples/s | 74.1 steps/s
[Step=56650 Epoch=110.7] | Loss=0.01218 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.257 | L2-Norm(final)=16.278 | 4742.2 samples/s | 74.1 steps/s
[Step=56700 Epoch=110.8] | Loss=0.01212 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.273 | L2-Norm(final)=16.280 | 4783.7 samples/s | 74.7 steps/s
[Step=56750 Epoch=110.9] | Loss=0.01175 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=16.283 | 4738.1 samples/s | 74.0 steps/s
[Step=56800 Epoch=111.0] | Loss=0.01149 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.300 | L2-Norm(final)=16.285 | 4711.7 samples/s | 73.6 steps/s
[Step=56850 Epoch=111.1] | Loss=0.01157 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.311 | L2-Norm(final)=16.288 | 4754.6 samples/s | 74.3 steps/s
[Step=56900 Epoch=111.2] | Loss=0.01144 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.320 | L2-Norm(final)=16.290 | 4763.1 samples/s | 74.4 steps/s
[Step=56950 Epoch=111.3] | Loss=0.01134 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.329 | L2-Norm(final)=16.293 | 4702.7 samples/s | 73.5 steps/s
[Step=57000 Epoch=111.4] | Loss=0.01089 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.338 | L2-Norm(final)=16.296 | 5906.9 samples/s | 92.3 steps/s
[Step=57050 Epoch=111.5] | Loss=0.01067 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.346 | L2-Norm(final)=16.299 | 2008.2 samples/s | 31.4 steps/s
[Step=57100 Epoch=111.6] | Loss=0.01034 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.354 | L2-Norm(final)=16.302 | 4722.1 samples/s | 73.8 steps/s
[Step=57150 Epoch=111.7] | Loss=0.01029 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.361 | L2-Norm(final)=16.305 | 4721.1 samples/s | 73.8 steps/s
[Step=57200 Epoch=111.8] | Loss=0.01002 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.368 | L2-Norm(final)=16.307 | 4722.9 samples/s | 73.8 steps/s
[Step=57250 Epoch=111.9] | Loss=0.00987 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.375 | L2-Norm(final)=16.309 | 4761.8 samples/s | 74.4 steps/s
[Step=57300 Epoch=112.0] | Loss=0.00989 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.381 | L2-Norm(final)=16.312 | 4721.9 samples/s | 73.8 steps/s
[Step=57350 Epoch=112.1] | Loss=0.00976 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.388 | L2-Norm(final)=16.314 | 4778.5 samples/s | 74.7 steps/s
[Step=57400 Epoch=112.2] | Loss=0.00959 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.394 | L2-Norm(final)=16.316 | 4776.0 samples/s | 74.6 steps/s
[Step=57450 Epoch=112.3] | Loss=0.00954 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.399 | L2-Norm(final)=16.318 | 4727.4 samples/s | 73.9 steps/s
[Step=57500 Epoch=112.4] | Loss=0.00940 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.405 | L2-Norm(final)=16.321 | 5118.2 samples/s | 80.0 steps/s
[Step=57550 Epoch=112.5] | Loss=0.00927 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.410 | L2-Norm(final)=16.323 | 2125.2 samples/s | 33.2 steps/s
[Step=57600 Epoch=112.6] | Loss=0.00913 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.415 | L2-Norm(final)=16.325 | 4872.0 samples/s | 76.1 steps/s
[Step=57650 Epoch=112.7] | Loss=0.00898 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.420 | L2-Norm(final)=16.328 | 4722.9 samples/s | 73.8 steps/s
[Step=57700 Epoch=112.8] | Loss=0.00885 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.425 | L2-Norm(final)=16.330 | 4739.7 samples/s | 74.1 steps/s
[Step=57750 Epoch=112.9] | Loss=0.00875 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=16.333 | 4697.5 samples/s | 73.4 steps/s
[Step=57800 Epoch=113.0] | Loss=0.00872 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.435 | L2-Norm(final)=16.335 | 4715.8 samples/s | 73.7 steps/s
[Step=57850 Epoch=113.1] | Loss=0.00881 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.439 | L2-Norm(final)=16.337 | 4731.5 samples/s | 73.9 steps/s
[Step=57900 Epoch=113.2] | Loss=0.00880 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.444 | L2-Norm(final)=16.339 | 4800.3 samples/s | 75.0 steps/s
[Step=57950 Epoch=113.3] | Loss=0.00874 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.448 | L2-Norm(final)=16.340 | 4807.9 samples/s | 75.1 steps/s
[Step=58000 Epoch=113.4] | Loss=0.00873 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.453 | L2-Norm(final)=16.342 | 4766.5 samples/s | 74.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step58000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=56001 Epoch=214.6] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=17.458 | 4270.7 samples/s | 66.7 steps/s
[Step=56050 Epoch=214.8] | Loss=0.00010 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.180 | L2-Norm(final)=17.467 | 4725.2 samples/s | 73.8 steps/s
[Step=56100 Epoch=215.0] | Loss=0.00014 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.179 | L2-Norm(final)=17.477 | 5191.6 samples/s | 81.1 steps/s
[Step=56150 Epoch=215.1] | Loss=0.00017 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.179 | L2-Norm(final)=17.487 | 5135.2 samples/s | 80.2 steps/s
[Step=56200 Epoch=215.3] | Loss=0.00017 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=17.496 | 5204.2 samples/s | 81.3 steps/s
[Step=56250 Epoch=215.5] | Loss=0.00016 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=17.505 | 6643.3 samples/s | 103.8 steps/s
[Step=56300 Epoch=215.7] | Loss=0.00014 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=17.513 | 2020.0 samples/s | 31.6 steps/s
[Step=56350 Epoch=215.9] | Loss=0.00015 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=17.520 | 5151.8 samples/s | 80.5 steps/s
[Step=56400 Epoch=216.1] | Loss=0.00015 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=17.527 | 5214.1 samples/s | 81.5 steps/s
[Step=56450 Epoch=216.3] | Loss=0.00014 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=17.535 | 5104.1 samples/s | 79.8 steps/s
[Step=56500 Epoch=216.5] | Loss=0.00014 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=17.541 | 5783.7 samples/s | 90.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=56501 Epoch=216.5] | Loss=0.00005 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=17.604 | 4259.0 samples/s | 66.5 steps/s
[Step=56550 Epoch=216.7] | Loss=0.00039 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.183 | L2-Norm(final)=17.604 | 4314.8 samples/s | 67.4 steps/s
[Step=56600 Epoch=216.9] | Loss=0.00090 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.226 | L2-Norm(final)=17.597 | 4608.2 samples/s | 72.0 steps/s
[Step=56650 Epoch=217.1] | Loss=0.00063 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.252 | L2-Norm(final)=17.595 | 4567.7 samples/s | 71.4 steps/s
[Step=56700 Epoch=217.3] | Loss=0.00056 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.265 | L2-Norm(final)=17.593 | 4521.7 samples/s | 70.7 steps/s
[Step=56750 Epoch=217.4] | Loss=0.00101 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.278 | L2-Norm(final)=17.592 | 5717.8 samples/s | 89.3 steps/s
[Step=56800 Epoch=217.6] | Loss=0.00120 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.294 | L2-Norm(final)=17.588 | 1954.4 samples/s | 30.5 steps/s
[Step=56850 Epoch=217.8] | Loss=0.00141 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.308 | L2-Norm(final)=17.584 | 4559.5 samples/s | 71.2 steps/s
[Step=56900 Epoch=218.0] | Loss=0.00126 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.319 | L2-Norm(final)=17.581 | 4486.0 samples/s | 70.1 steps/s
[Step=56950 Epoch=218.2] | Loss=0.00120 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.327 | L2-Norm(final)=17.580 | 4583.4 samples/s | 71.6 steps/s
[Step=57000 Epoch=218.4] | Loss=0.00108 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.334 | L2-Norm(final)=17.578 | 4907.9 samples/s | 76.7 steps/s
[Step=57050 Epoch=218.6] | Loss=0.00099 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=17.577 | 1995.5 samples/s | 31.2 steps/s
[Step=57100 Epoch=218.8] | Loss=0.00090 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.344 | L2-Norm(final)=17.576 | 4508.8 samples/s | 70.5 steps/s
[Step=57150 Epoch=219.0] | Loss=0.00083 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.347 | L2-Norm(final)=17.576 | 4514.9 samples/s | 70.5 steps/s
[Step=57200 Epoch=219.2] | Loss=0.00078 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.349 | L2-Norm(final)=17.575 | 4494.5 samples/s | 70.2 steps/s
[Step=57250 Epoch=219.4] | Loss=0.00072 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.351 | L2-Norm(final)=17.575 | 4459.2 samples/s | 69.7 steps/s
[Step=57300 Epoch=219.6] | Loss=0.00068 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=17.574 | 2124.1 samples/s | 33.2 steps/s
[Step=57350 Epoch=219.7] | Loss=0.00064 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=17.574 | 4751.2 samples/s | 74.2 steps/s
[Step=57400 Epoch=219.9] | Loss=0.00060 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.353 | L2-Norm(final)=17.574 | 4698.2 samples/s | 73.4 steps/s
[Step=57450 Epoch=220.1] | Loss=0.00057 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.353 | L2-Norm(final)=17.574 | 4702.6 samples/s | 73.5 steps/s
[Step=57500 Epoch=220.3] | Loss=0.00054 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.353 | L2-Norm(final)=17.574 | 4554.7 samples/s | 71.2 steps/s
[Step=57550 Epoch=220.5] | Loss=0.00052 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=17.573 | 2125.4 samples/s | 33.2 steps/s
[Step=57600 Epoch=220.7] | Loss=0.00049 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=17.573 | 4497.1 samples/s | 70.3 steps/s
[Step=57650 Epoch=220.9] | Loss=0.00047 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.351 | L2-Norm(final)=17.573 | 4500.7 samples/s | 70.3 steps/s
[Step=57700 Epoch=221.1] | Loss=0.00045 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.350 | L2-Norm(final)=17.573 | 4529.3 samples/s | 70.8 steps/s
[Step=57750 Epoch=221.3] | Loss=0.00044 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.349 | L2-Norm(final)=17.573 | 4460.3 samples/s | 69.7 steps/s
[Step=57800 Epoch=221.5] | Loss=0.00042 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.348 | L2-Norm(final)=17.573 | 6095.2 samples/s | 95.2 steps/s
[Step=57850 Epoch=221.7] | Loss=0.00040 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.347 | L2-Norm(final)=17.573 | 1867.1 samples/s | 29.2 steps/s
[Step=57900 Epoch=221.9] | Loss=0.00039 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.346 | L2-Norm(final)=17.573 | 4556.9 samples/s | 71.2 steps/s
[Step=57950 Epoch=222.0] | Loss=0.00038 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.344 | L2-Norm(final)=17.573 | 4488.3 samples/s | 70.1 steps/s
[Step=58000 Epoch=222.2] | Loss=0.00036 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.343 | L2-Norm(final)=17.573 | 4478.0 samples/s | 70.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step58000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=56001 Epoch=215.6] | Loss=0.00005 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=17.387 | 4035.1 samples/s | 63.0 steps/s
[Step=56050 Epoch=215.8] | Loss=0.00017 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.183 | L2-Norm(final)=17.407 | 5046.1 samples/s | 78.8 steps/s
[Step=56100 Epoch=216.0] | Loss=0.00014 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.183 | L2-Norm(final)=17.422 | 5106.5 samples/s | 79.8 steps/s
[Step=56150 Epoch=216.1] | Loss=0.00021 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.182 | L2-Norm(final)=17.437 | 5127.5 samples/s | 80.1 steps/s
[Step=56200 Epoch=216.3] | Loss=0.00022 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.182 | L2-Norm(final)=17.451 | 5084.2 samples/s | 79.4 steps/s
[Step=56250 Epoch=216.5] | Loss=0.00020 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.182 | L2-Norm(final)=17.463 | 6839.3 samples/s | 106.9 steps/s
[Step=56300 Epoch=216.7] | Loss=0.00018 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.182 | L2-Norm(final)=17.474 | 2016.7 samples/s | 31.5 steps/s
[Step=56350 Epoch=216.9] | Loss=0.00018 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.182 | L2-Norm(final)=17.485 | 5043.0 samples/s | 78.8 steps/s
[Step=56400 Epoch=217.1] | Loss=0.00019 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.182 | L2-Norm(final)=17.496 | 5230.5 samples/s | 81.7 steps/s
[Step=56450 Epoch=217.3] | Loss=0.00018 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.182 | L2-Norm(final)=17.507 | 5030.3 samples/s | 78.6 steps/s
[Step=56500 Epoch=217.5] | Loss=0.00017 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.182 | L2-Norm(final)=17.516 | 5913.3 samples/s | 92.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=56501 Epoch=217.5] | Loss=0.00003 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.182 | L2-Norm(final)=17.608 | 4036.5 samples/s | 63.1 steps/s
[Step=56550 Epoch=217.7] | Loss=0.00029 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.193 | L2-Norm(final)=17.612 | 4429.1 samples/s | 69.2 steps/s
[Step=56600 Epoch=217.9] | Loss=0.00311 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.246 | L2-Norm(final)=17.600 | 4468.1 samples/s | 69.8 steps/s
[Step=56650 Epoch=218.1] | Loss=0.00259 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=17.589 | 4605.8 samples/s | 72.0 steps/s
[Step=56700 Epoch=218.3] | Loss=0.00226 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.314 | L2-Norm(final)=17.583 | 4599.3 samples/s | 71.9 steps/s
[Step=56750 Epoch=218.5] | Loss=0.00213 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.332 | L2-Norm(final)=17.578 | 5892.3 samples/s | 92.1 steps/s
[Step=56800 Epoch=218.6] | Loss=0.00181 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.344 | L2-Norm(final)=17.575 | 1953.8 samples/s | 30.5 steps/s
[Step=56850 Epoch=218.8] | Loss=0.00155 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=17.573 | 4511.4 samples/s | 70.5 steps/s
[Step=56900 Epoch=219.0] | Loss=0.00136 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=17.571 | 4503.5 samples/s | 70.4 steps/s
[Step=56950 Epoch=219.2] | Loss=0.00121 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.361 | L2-Norm(final)=17.570 | 4603.7 samples/s | 71.9 steps/s
[Step=57000 Epoch=219.4] | Loss=0.00109 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.363 | L2-Norm(final)=17.569 | 5040.2 samples/s | 78.8 steps/s
[Step=57050 Epoch=219.6] | Loss=0.00099 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=17.569 | 2049.1 samples/s | 32.0 steps/s
[Step=57100 Epoch=219.8] | Loss=0.00091 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.365 | L2-Norm(final)=17.568 | 4654.5 samples/s | 72.7 steps/s
[Step=57150 Epoch=220.0] | Loss=0.00084 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.365 | L2-Norm(final)=17.568 | 4625.4 samples/s | 72.3 steps/s
[Step=57200 Epoch=220.2] | Loss=0.00078 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.365 | L2-Norm(final)=17.567 | 4492.8 samples/s | 70.2 steps/s
[Step=57250 Epoch=220.4] | Loss=0.00073 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=17.567 | 4615.6 samples/s | 72.1 steps/s
[Step=57300 Epoch=220.6] | Loss=0.00068 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.363 | L2-Norm(final)=17.567 | 2089.5 samples/s | 32.6 steps/s
[Step=57350 Epoch=220.8] | Loss=0.00064 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.362 | L2-Norm(final)=17.567 | 4620.8 samples/s | 72.2 steps/s
[Step=57400 Epoch=221.0] | Loss=0.00061 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.361 | L2-Norm(final)=17.567 | 4670.2 samples/s | 73.0 steps/s
[Step=57450 Epoch=221.1] | Loss=0.00058 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.359 | L2-Norm(final)=17.567 | 4616.8 samples/s | 72.1 steps/s
[Step=57500 Epoch=221.3] | Loss=0.00055 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.358 | L2-Norm(final)=17.567 | 4528.9 samples/s | 70.8 steps/s
[Step=57550 Epoch=221.5] | Loss=0.00052 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.356 | L2-Norm(final)=17.567 | 2080.2 samples/s | 32.5 steps/s
[Step=57600 Epoch=221.7] | Loss=0.00050 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.354 | L2-Norm(final)=17.567 | 4563.7 samples/s | 71.3 steps/s
[Step=57650 Epoch=221.9] | Loss=0.00048 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=17.567 | 4472.0 samples/s | 69.9 steps/s
[Step=57700 Epoch=222.1] | Loss=0.00046 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.350 | L2-Norm(final)=17.568 | 4497.3 samples/s | 70.3 steps/s
[Step=57750 Epoch=222.3] | Loss=0.00044 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.348 | L2-Norm(final)=17.568 | 4527.6 samples/s | 70.7 steps/s
[Step=57800 Epoch=222.5] | Loss=0.00042 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.346 | L2-Norm(final)=17.568 | 6631.6 samples/s | 103.6 steps/s
[Step=57850 Epoch=222.7] | Loss=0.00041 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.344 | L2-Norm(final)=17.568 | 1835.8 samples/s | 28.7 steps/s
[Step=57900 Epoch=222.9] | Loss=0.00039 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=17.568 | 4494.4 samples/s | 70.2 steps/s
[Step=57950 Epoch=223.1] | Loss=0.00038 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.339 | L2-Norm(final)=17.569 | 4462.0 samples/s | 69.7 steps/s
[Step=58000 Epoch=223.3] | Loss=0.00037 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.337 | L2-Norm(final)=17.569 | 4537.8 samples/s | 70.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step58000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06979 | acc=0.9706 | tpr=0.9772 | fpr=0.0436 | 3206.7 samples/s | 12.5 steps/s
Avg test loss: 0.07033, Avg test acc: 0.97059, Avg tpr: 0.97727, Avg fpr: 0.04410, total FA: 344

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06434 | acc=0.9717 | tpr=0.9785 | fpr=0.0431 | 4372.7 samples/s | 17.1 steps/s
Avg test loss: 0.06568, Avg test acc: 0.97079, Avg tpr: 0.97838, Avg fpr: 0.04589, total FA: 358

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.52826 | acc=0.3134 | tpr=0.0049 | fpr=0.0166 | 4423.5 samples/s | 17.3 steps/s
Avg test loss: 7.54586, Avg test acc: 0.31032, Avg tpr: 0.00460, Avg fpr: 0.01731, total FA: 135

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.43125 | acc=0.3091 | tpr=0.0114 | fpr=0.0444 | 4426.2 samples/s | 17.3 steps/s
Avg test loss: 6.45990, Avg test acc: 0.30571, Avg tpr: 0.01026, Avg fpr: 0.04448, total FA: 347

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.88840 | acc=0.0994 | tpr=0.7389 | fpr=0.9121 | 4443.8 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.85727 | acc=0.0993 | tpr=0.7186 | fpr=0.9123 | 8552.1 samples/s | 33.4 steps/s
[Step= 150] | Loss=5.87443 | acc=0.0991 | tpr=0.7190 | fpr=0.9123 | 8131.0 samples/s | 31.8 steps/s
[Step= 200] | Loss=5.87352 | acc=0.0992 | tpr=0.7093 | fpr=0.9119 | 8518.2 samples/s | 33.3 steps/s
[Step= 250] | Loss=5.88579 | acc=0.0983 | tpr=0.7109 | fpr=0.9128 | 8453.2 samples/s | 33.0 steps/s
[Step= 300] | Loss=5.88177 | acc=0.0984 | tpr=0.7091 | fpr=0.9127 | 8450.1 samples/s | 33.0 steps/s
[Step= 350] | Loss=5.88267 | acc=0.0977 | tpr=0.7051 | fpr=0.9133 | 8669.2 samples/s | 33.9 steps/s
[Step= 400] | Loss=5.88808 | acc=0.0979 | tpr=0.7024 | fpr=0.9131 | 8261.5 samples/s | 32.3 steps/s
[Step= 450] | Loss=5.89147 | acc=0.0979 | tpr=0.7040 | fpr=0.9131 | 8630.0 samples/s | 33.7 steps/s
[Step= 500] | Loss=5.89250 | acc=0.0976 | tpr=0.7053 | fpr=0.9134 | 8226.3 samples/s | 32.1 steps/s
[Step= 550] | Loss=5.89694 | acc=0.0976 | tpr=0.7000 | fpr=0.9134 | 15262.1 samples/s | 59.6 steps/s
Avg test loss: 5.89715, Avg test acc: 0.09748, Avg tpr: 0.70008, Avg fpr: 0.91347, total FA: 126834

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.15267 | acc=0.1274 | tpr=0.7788 | fpr=0.8843 | 4351.7 samples/s | 17.0 steps/s
[Step= 100] | Loss=6.12102 | acc=0.1283 | tpr=0.7740 | fpr=0.8837 | 8505.5 samples/s | 33.2 steps/s
[Step= 150] | Loss=6.13239 | acc=0.1282 | tpr=0.7723 | fpr=0.8836 | 8613.8 samples/s | 33.6 steps/s
[Step= 200] | Loss=6.12713 | acc=0.1278 | tpr=0.7650 | fpr=0.8838 | 8302.8 samples/s | 32.4 steps/s
[Step= 250] | Loss=6.13705 | acc=0.1276 | tpr=0.7677 | fpr=0.8841 | 8488.9 samples/s | 33.2 steps/s
[Step= 300] | Loss=6.12969 | acc=0.1273 | tpr=0.7651 | fpr=0.8843 | 8424.7 samples/s | 32.9 steps/s
[Step= 350] | Loss=6.12567 | acc=0.1266 | tpr=0.7689 | fpr=0.8851 | 9175.2 samples/s | 35.8 steps/s
[Step= 400] | Loss=6.13198 | acc=0.1265 | tpr=0.7675 | fpr=0.8852 | 7851.6 samples/s | 30.7 steps/s
[Step= 450] | Loss=6.13467 | acc=0.1263 | tpr=0.7712 | fpr=0.8854 | 8549.7 samples/s | 33.4 steps/s
[Step= 500] | Loss=6.13448 | acc=0.1262 | tpr=0.7727 | fpr=0.8855 | 8654.6 samples/s | 33.8 steps/s
[Step= 550] | Loss=6.13946 | acc=0.1260 | tpr=0.7708 | fpr=0.8857 | 13798.2 samples/s | 53.9 steps/s
Avg test loss: 6.13941, Avg test acc: 0.12600, Avg tpr: 0.77021, Avg fpr: 0.88571, total FA: 122979

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13300 | acc=0.9849 | tpr=0.9204 | fpr=0.0139 | 4417.7 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.13756 | acc=0.9843 | tpr=0.9318 | fpr=0.0147 | 8273.8 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.14211 | acc=0.9834 | tpr=0.9352 | fpr=0.0157 | 8437.3 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.14407 | acc=0.9834 | tpr=0.9366 | fpr=0.0157 | 8824.6 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.14131 | acc=0.9836 | tpr=0.9362 | fpr=0.0156 | 8029.0 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.14293 | acc=0.9835 | tpr=0.9367 | fpr=0.0156 | 8378.5 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.14400 | acc=0.9835 | tpr=0.9386 | fpr=0.0157 | 8554.2 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.14617 | acc=0.9833 | tpr=0.9382 | fpr=0.0159 | 8400.0 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.14958 | acc=0.9830 | tpr=0.9387 | fpr=0.0162 | 8220.9 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.14929 | acc=0.9830 | tpr=0.9388 | fpr=0.0162 | 8464.8 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.14809 | acc=0.9830 | tpr=0.9363 | fpr=0.0161 | 15482.7 samples/s | 60.5 steps/s
Avg test loss: 0.14776, Avg test acc: 0.98307, Avg tpr: 0.93621, Avg fpr: 0.01608, total FA: 2233

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14504 | acc=0.9816 | tpr=0.9381 | fpr=0.0177 | 4410.8 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.15292 | acc=0.9812 | tpr=0.9616 | fpr=0.0185 | 8492.4 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.15789 | acc=0.9804 | tpr=0.9654 | fpr=0.0193 | 8301.9 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.15881 | acc=0.9804 | tpr=0.9683 | fpr=0.0194 | 8715.8 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.15721 | acc=0.9807 | tpr=0.9694 | fpr=0.0191 | 8478.7 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.15873 | acc=0.9805 | tpr=0.9680 | fpr=0.0192 | 8681.4 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.16035 | acc=0.9804 | tpr=0.9687 | fpr=0.0194 | 8069.0 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.16217 | acc=0.9802 | tpr=0.9661 | fpr=0.0195 | 8693.8 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.16522 | acc=0.9800 | tpr=0.9659 | fpr=0.0198 | 7789.3 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.16465 | acc=0.9800 | tpr=0.9652 | fpr=0.0197 | 9194.7 samples/s | 35.9 steps/s
[Step= 550] | Loss=0.16323 | acc=0.9802 | tpr=0.9630 | fpr=0.0195 | 13298.7 samples/s | 51.9 steps/s
Avg test loss: 0.16283, Avg test acc: 0.98018, Avg tpr: 0.96315, Avg fpr: 0.01951, total FA: 2709

server round 29/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=58001 Epoch=113.1] | Loss=0.01518 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=16.030 | 4216.1 samples/s | 65.9 steps/s
[Step=58050 Epoch=113.2] | Loss=0.01547 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=16.049 | 5515.7 samples/s | 86.2 steps/s
[Step=58100 Epoch=113.3] | Loss=0.01458 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.288 | L2-Norm(final)=16.071 | 5549.7 samples/s | 86.7 steps/s
[Step=58150 Epoch=113.4] | Loss=0.01513 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=16.091 | 5620.6 samples/s | 87.8 steps/s
[Step=58200 Epoch=113.5] | Loss=0.01471 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=16.110 | 5671.2 samples/s | 88.6 steps/s
[Step=58250 Epoch=113.6] | Loss=0.01429 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.288 | L2-Norm(final)=16.130 | 5432.4 samples/s | 84.9 steps/s
[Step=58300 Epoch=113.7] | Loss=0.01401 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.288 | L2-Norm(final)=16.150 | 5406.1 samples/s | 84.5 steps/s
[Step=58350 Epoch=113.8] | Loss=0.01419 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.288 | L2-Norm(final)=16.170 | 5524.3 samples/s | 86.3 steps/s
[Step=58400 Epoch=113.9] | Loss=0.01435 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.288 | L2-Norm(final)=16.190 | 5515.1 samples/s | 86.2 steps/s
[Step=58450 Epoch=114.0] | Loss=0.01421 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=16.210 | 5566.5 samples/s | 87.0 steps/s
[Step=58500 Epoch=114.1] | Loss=0.01425 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.288 | L2-Norm(final)=16.230 | 6806.5 samples/s | 106.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=58501 Epoch=114.1] | Loss=0.00818 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.289 | L2-Norm(final)=16.425 | 4355.8 samples/s | 68.1 steps/s
[Step=58550 Epoch=114.2] | Loss=0.01210 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.321 | L2-Norm(final)=16.435 | 4506.2 samples/s | 70.4 steps/s
[Step=58600 Epoch=114.3] | Loss=0.01171 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.345 | L2-Norm(final)=16.436 | 4760.9 samples/s | 74.4 steps/s
[Step=58650 Epoch=114.4] | Loss=0.01164 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.363 | L2-Norm(final)=16.438 | 4729.7 samples/s | 73.9 steps/s
[Step=58700 Epoch=114.5] | Loss=0.01192 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.379 | L2-Norm(final)=16.439 | 4743.4 samples/s | 74.1 steps/s
[Step=58750 Epoch=114.6] | Loss=0.01239 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.393 | L2-Norm(final)=16.440 | 4751.5 samples/s | 74.2 steps/s
[Step=58800 Epoch=114.7] | Loss=0.01279 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.405 | L2-Norm(final)=16.440 | 4783.2 samples/s | 74.7 steps/s
[Step=58850 Epoch=114.8] | Loss=0.01229 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.416 | L2-Norm(final)=16.442 | 4705.6 samples/s | 73.5 steps/s
[Step=58900 Epoch=114.9] | Loss=0.01202 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.426 | L2-Norm(final)=16.443 | 4709.4 samples/s | 73.6 steps/s
[Step=58950 Epoch=115.0] | Loss=0.01177 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.435 | L2-Norm(final)=16.445 | 4750.0 samples/s | 74.2 steps/s
[Step=59000 Epoch=115.1] | Loss=0.01175 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.442 | L2-Norm(final)=16.447 | 5774.6 samples/s | 90.2 steps/s
[Step=59050 Epoch=115.2] | Loss=0.01159 | Reg=0.00131 | acc=0.9688 | L2-Norm=11.450 | L2-Norm(final)=16.449 | 1952.2 samples/s | 30.5 steps/s
[Step=59100 Epoch=115.3] | Loss=0.01120 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.456 | L2-Norm(final)=16.451 | 4783.6 samples/s | 74.7 steps/s
[Step=59150 Epoch=115.4] | Loss=0.01074 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.463 | L2-Norm(final)=16.453 | 4871.9 samples/s | 76.1 steps/s
[Step=59200 Epoch=115.5] | Loss=0.01042 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.468 | L2-Norm(final)=16.455 | 4884.5 samples/s | 76.3 steps/s
[Step=59250 Epoch=115.6] | Loss=0.01026 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.474 | L2-Norm(final)=16.457 | 4917.1 samples/s | 76.8 steps/s
[Step=59300 Epoch=115.7] | Loss=0.01018 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.479 | L2-Norm(final)=16.459 | 4894.6 samples/s | 76.5 steps/s
[Step=59350 Epoch=115.8] | Loss=0.01003 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.483 | L2-Norm(final)=16.461 | 4938.3 samples/s | 77.2 steps/s
[Step=59400 Epoch=115.9] | Loss=0.00998 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.488 | L2-Norm(final)=16.462 | 4743.1 samples/s | 74.1 steps/s
[Step=59450 Epoch=116.0] | Loss=0.00980 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.492 | L2-Norm(final)=16.464 | 4804.3 samples/s | 75.1 steps/s
[Step=59500 Epoch=116.0] | Loss=0.00974 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.496 | L2-Norm(final)=16.465 | 5048.8 samples/s | 78.9 steps/s
[Step=59550 Epoch=116.1] | Loss=0.00966 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.500 | L2-Norm(final)=16.467 | 2066.0 samples/s | 32.3 steps/s
[Step=59600 Epoch=116.2] | Loss=0.00949 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.504 | L2-Norm(final)=16.469 | 4683.8 samples/s | 73.2 steps/s
[Step=59650 Epoch=116.3] | Loss=0.00934 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.507 | L2-Norm(final)=16.471 | 4640.4 samples/s | 72.5 steps/s
[Step=59700 Epoch=116.4] | Loss=0.00924 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.511 | L2-Norm(final)=16.473 | 4793.0 samples/s | 74.9 steps/s
[Step=59750 Epoch=116.5] | Loss=0.00906 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.515 | L2-Norm(final)=16.475 | 4871.3 samples/s | 76.1 steps/s
[Step=59800 Epoch=116.6] | Loss=0.00898 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.518 | L2-Norm(final)=16.477 | 4881.0 samples/s | 76.3 steps/s
[Step=59850 Epoch=116.7] | Loss=0.00901 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.522 | L2-Norm(final)=16.479 | 4918.6 samples/s | 76.9 steps/s
[Step=59900 Epoch=116.8] | Loss=0.00900 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.525 | L2-Norm(final)=16.480 | 4869.9 samples/s | 76.1 steps/s
[Step=59950 Epoch=116.9] | Loss=0.00891 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.528 | L2-Norm(final)=16.482 | 4903.2 samples/s | 76.6 steps/s
[Step=60000 Epoch=117.0] | Loss=0.00880 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.532 | L2-Norm(final)=16.483 | 4901.8 samples/s | 76.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step60000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=58001 Epoch=113.4] | Loss=0.00521 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=16.393 | 4328.6 samples/s | 67.6 steps/s
[Step=58050 Epoch=113.5] | Loss=0.01217 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=16.410 | 5391.1 samples/s | 84.2 steps/s
[Step=58100 Epoch=113.6] | Loss=0.01207 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.288 | L2-Norm(final)=16.432 | 5618.5 samples/s | 87.8 steps/s
[Step=58150 Epoch=113.7] | Loss=0.01245 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=16.454 | 5521.2 samples/s | 86.3 steps/s
[Step=58200 Epoch=113.8] | Loss=0.01300 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.288 | L2-Norm(final)=16.475 | 5479.6 samples/s | 85.6 steps/s
[Step=58250 Epoch=113.9] | Loss=0.01346 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.288 | L2-Norm(final)=16.493 | 5439.8 samples/s | 85.0 steps/s
[Step=58300 Epoch=114.0] | Loss=0.01376 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=16.512 | 5594.4 samples/s | 87.4 steps/s
[Step=58350 Epoch=114.1] | Loss=0.01357 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=16.530 | 5509.4 samples/s | 86.1 steps/s
[Step=58400 Epoch=114.2] | Loss=0.01374 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=16.549 | 5463.7 samples/s | 85.4 steps/s
[Step=58450 Epoch=114.3] | Loss=0.01369 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=16.567 | 5399.2 samples/s | 84.4 steps/s
[Step=58500 Epoch=114.4] | Loss=0.01385 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.288 | L2-Norm(final)=16.585 | 7189.9 samples/s | 112.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=58501 Epoch=114.4] | Loss=0.01025 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=16.766 | 4386.4 samples/s | 68.5 steps/s
[Step=58550 Epoch=114.5] | Loss=0.01218 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.315 | L2-Norm(final)=16.776 | 4606.0 samples/s | 72.0 steps/s
[Step=58600 Epoch=114.6] | Loss=0.01135 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.335 | L2-Norm(final)=16.778 | 4758.6 samples/s | 74.4 steps/s
[Step=58650 Epoch=114.7] | Loss=0.01097 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.351 | L2-Norm(final)=16.782 | 4790.0 samples/s | 74.8 steps/s
[Step=58700 Epoch=114.8] | Loss=0.01072 | Reg=0.00129 | acc=0.9531 | L2-Norm=11.364 | L2-Norm(final)=16.784 | 4729.4 samples/s | 73.9 steps/s
[Step=58750 Epoch=114.9] | Loss=0.01134 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.375 | L2-Norm(final)=16.787 | 4757.1 samples/s | 74.3 steps/s
[Step=58800 Epoch=115.0] | Loss=0.01169 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.385 | L2-Norm(final)=16.788 | 4815.7 samples/s | 75.2 steps/s
[Step=58850 Epoch=115.1] | Loss=0.01177 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.394 | L2-Norm(final)=16.788 | 4743.8 samples/s | 74.1 steps/s
[Step=58900 Epoch=115.1] | Loss=0.01195 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.403 | L2-Norm(final)=16.789 | 4762.8 samples/s | 74.4 steps/s
[Step=58950 Epoch=115.2] | Loss=0.01157 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.412 | L2-Norm(final)=16.790 | 4731.1 samples/s | 73.9 steps/s
[Step=59000 Epoch=115.3] | Loss=0.01152 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.420 | L2-Norm(final)=16.791 | 5885.1 samples/s | 92.0 steps/s
[Step=59050 Epoch=115.4] | Loss=0.01111 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.428 | L2-Norm(final)=16.792 | 2007.6 samples/s | 31.4 steps/s
[Step=59100 Epoch=115.5] | Loss=0.01073 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.435 | L2-Norm(final)=16.794 | 4749.5 samples/s | 74.2 steps/s
[Step=59150 Epoch=115.6] | Loss=0.01039 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.442 | L2-Norm(final)=16.796 | 4825.6 samples/s | 75.4 steps/s
[Step=59200 Epoch=115.7] | Loss=0.01013 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.448 | L2-Norm(final)=16.797 | 4750.8 samples/s | 74.2 steps/s
[Step=59250 Epoch=115.8] | Loss=0.01003 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.454 | L2-Norm(final)=16.799 | 4811.5 samples/s | 75.2 steps/s
[Step=59300 Epoch=115.9] | Loss=0.00989 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.460 | L2-Norm(final)=16.801 | 4852.6 samples/s | 75.8 steps/s
[Step=59350 Epoch=116.0] | Loss=0.00985 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.465 | L2-Norm(final)=16.803 | 4723.4 samples/s | 73.8 steps/s
[Step=59400 Epoch=116.1] | Loss=0.00979 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.470 | L2-Norm(final)=16.805 | 4859.1 samples/s | 75.9 steps/s
[Step=59450 Epoch=116.2] | Loss=0.00981 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.475 | L2-Norm(final)=16.807 | 4712.3 samples/s | 73.6 steps/s
[Step=59500 Epoch=116.3] | Loss=0.00986 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.480 | L2-Norm(final)=16.808 | 5140.9 samples/s | 80.3 steps/s
[Step=59550 Epoch=116.4] | Loss=0.00973 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.485 | L2-Norm(final)=16.810 | 2111.3 samples/s | 33.0 steps/s
[Step=59600 Epoch=116.5] | Loss=0.00953 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.489 | L2-Norm(final)=16.812 | 4797.1 samples/s | 75.0 steps/s
[Step=59650 Epoch=116.6] | Loss=0.00935 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.494 | L2-Norm(final)=16.813 | 4729.3 samples/s | 73.9 steps/s
[Step=59700 Epoch=116.7] | Loss=0.00922 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.498 | L2-Norm(final)=16.815 | 4710.2 samples/s | 73.6 steps/s
[Step=59750 Epoch=116.8] | Loss=0.00908 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.502 | L2-Norm(final)=16.817 | 4768.6 samples/s | 74.5 steps/s
[Step=59800 Epoch=116.9] | Loss=0.00896 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.505 | L2-Norm(final)=16.819 | 4821.4 samples/s | 75.3 steps/s
[Step=59850 Epoch=117.0] | Loss=0.00888 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.509 | L2-Norm(final)=16.820 | 4701.1 samples/s | 73.5 steps/s
[Step=59900 Epoch=117.1] | Loss=0.00881 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.513 | L2-Norm(final)=16.822 | 4173.9 samples/s | 65.2 steps/s
[Step=59950 Epoch=117.2] | Loss=0.00882 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.516 | L2-Norm(final)=16.823 | 4377.7 samples/s | 68.4 steps/s
[Step=60000 Epoch=117.3] | Loss=0.00881 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.520 | L2-Norm(final)=16.825 | 4295.2 samples/s | 67.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step60000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=58001 Epoch=222.2] | Loss=0.00009 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=17.573 | 3915.9 samples/s | 61.2 steps/s
[Step=58050 Epoch=222.4] | Loss=0.00003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=17.576 | 3927.9 samples/s | 61.4 steps/s
[Step=58100 Epoch=222.6] | Loss=0.00003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=17.577 | 4906.9 samples/s | 76.7 steps/s
[Step=58150 Epoch=222.8] | Loss=0.00003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=17.578 | 5226.9 samples/s | 81.7 steps/s
[Step=58200 Epoch=223.0] | Loss=0.00003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=17.580 | 5326.7 samples/s | 83.2 steps/s
[Step=58250 Epoch=223.2] | Loss=0.00003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=17.581 | 6986.8 samples/s | 109.2 steps/s
[Step=58300 Epoch=223.4] | Loss=0.00003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=17.582 | 2040.0 samples/s | 31.9 steps/s
[Step=58350 Epoch=223.6] | Loss=0.00003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=17.583 | 5103.8 samples/s | 79.7 steps/s
[Step=58400 Epoch=223.8] | Loss=0.00003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=17.584 | 5211.4 samples/s | 81.4 steps/s
[Step=58450 Epoch=224.0] | Loss=0.00002 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=17.586 | 5250.8 samples/s | 82.0 steps/s
[Step=58500 Epoch=224.2] | Loss=0.00003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=17.587 | 5675.4 samples/s | 88.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=58501 Epoch=224.2] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=17.599 | 4216.6 samples/s | 65.9 steps/s
[Step=58550 Epoch=224.3] | Loss=0.00003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.279 | L2-Norm(final)=17.600 | 4310.7 samples/s | 67.4 steps/s
[Step=58600 Epoch=224.5] | Loss=0.00002 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.276 | L2-Norm(final)=17.600 | 4431.9 samples/s | 69.2 steps/s
[Step=58650 Epoch=224.7] | Loss=0.00002 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.273 | L2-Norm(final)=17.601 | 4546.7 samples/s | 71.0 steps/s
[Step=58700 Epoch=224.9] | Loss=0.00002 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.269 | L2-Norm(final)=17.602 | 4521.2 samples/s | 70.6 steps/s
[Step=58750 Epoch=225.1] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.266 | L2-Norm(final)=17.603 | 5553.1 samples/s | 86.8 steps/s
[Step=58800 Epoch=225.3] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.263 | L2-Norm(final)=17.605 | 1958.0 samples/s | 30.6 steps/s
[Step=58850 Epoch=225.5] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.259 | L2-Norm(final)=17.606 | 4502.3 samples/s | 70.3 steps/s
[Step=58900 Epoch=225.7] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.255 | L2-Norm(final)=17.607 | 4487.1 samples/s | 70.1 steps/s
[Step=58950 Epoch=225.9] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.251 | L2-Norm(final)=17.608 | 4521.2 samples/s | 70.6 steps/s
[Step=59000 Epoch=226.1] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.247 | L2-Norm(final)=17.608 | 5018.6 samples/s | 78.4 steps/s
[Step=59050 Epoch=226.3] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.243 | L2-Norm(final)=17.609 | 2040.4 samples/s | 31.9 steps/s
[Step=59100 Epoch=226.5] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.239 | L2-Norm(final)=17.610 | 4520.4 samples/s | 70.6 steps/s
[Step=59150 Epoch=226.6] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.235 | L2-Norm(final)=17.610 | 4499.1 samples/s | 70.3 steps/s
[Step=59200 Epoch=226.8] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.231 | L2-Norm(final)=17.611 | 4552.5 samples/s | 71.1 steps/s
[Step=59250 Epoch=227.0] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.227 | L2-Norm(final)=17.611 | 4574.7 samples/s | 71.5 steps/s
[Step=59300 Epoch=227.2] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.223 | L2-Norm(final)=17.612 | 2146.4 samples/s | 33.5 steps/s
[Step=59350 Epoch=227.4] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.219 | L2-Norm(final)=17.612 | 4587.7 samples/s | 71.7 steps/s
[Step=59400 Epoch=227.6] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=17.613 | 4488.8 samples/s | 70.1 steps/s
[Step=59450 Epoch=227.8] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.211 | L2-Norm(final)=17.613 | 4439.4 samples/s | 69.4 steps/s
[Step=59500 Epoch=228.0] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.207 | L2-Norm(final)=17.614 | 4448.6 samples/s | 69.5 steps/s
[Step=59550 Epoch=228.2] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.203 | L2-Norm(final)=17.614 | 2153.3 samples/s | 33.6 steps/s
[Step=59600 Epoch=228.4] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.198 | L2-Norm(final)=17.614 | 4673.5 samples/s | 73.0 steps/s
[Step=59650 Epoch=228.6] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.194 | L2-Norm(final)=17.615 | 4623.5 samples/s | 72.2 steps/s
[Step=59700 Epoch=228.7] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=17.615 | 4720.8 samples/s | 73.8 steps/s
[Step=59750 Epoch=228.9] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.185 | L2-Norm(final)=17.616 | 4601.6 samples/s | 71.9 steps/s
[Step=59800 Epoch=229.1] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.181 | L2-Norm(final)=17.616 | 6295.2 samples/s | 98.4 steps/s
[Step=59850 Epoch=229.3] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=17.617 | 1879.9 samples/s | 29.4 steps/s
[Step=59900 Epoch=229.5] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.172 | L2-Norm(final)=17.617 | 4538.5 samples/s | 70.9 steps/s
[Step=59950 Epoch=229.7] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.167 | L2-Norm(final)=17.618 | 4476.9 samples/s | 70.0 steps/s
[Step=60000 Epoch=229.9] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.163 | L2-Norm(final)=17.618 | 4582.0 samples/s | 71.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step60000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=58001 Epoch=223.3] | Loss=0.00031 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=17.576 | 4626.5 samples/s | 72.3 steps/s
[Step=58050 Epoch=223.5] | Loss=0.00010 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=17.578 | 4321.0 samples/s | 67.5 steps/s
[Step=58100 Epoch=223.6] | Loss=0.00009 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=17.580 | 5219.7 samples/s | 81.6 steps/s
[Step=58150 Epoch=223.8] | Loss=0.00010 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=17.583 | 5155.2 samples/s | 80.5 steps/s
[Step=58200 Epoch=224.0] | Loss=0.00009 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=17.585 | 5087.1 samples/s | 79.5 steps/s
[Step=58250 Epoch=224.2] | Loss=0.00009 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=17.587 | 6854.7 samples/s | 107.1 steps/s
[Step=58300 Epoch=224.4] | Loss=0.00008 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=17.589 | 2039.8 samples/s | 31.9 steps/s
[Step=58350 Epoch=224.6] | Loss=0.00008 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=17.591 | 5166.8 samples/s | 80.7 steps/s
[Step=58400 Epoch=224.8] | Loss=0.00008 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=17.593 | 5144.6 samples/s | 80.4 steps/s
[Step=58450 Epoch=225.0] | Loss=0.00008 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=17.595 | 5110.5 samples/s | 79.9 steps/s
[Step=58500 Epoch=225.2] | Loss=0.00008 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=17.598 | 5884.4 samples/s | 91.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=58501 Epoch=225.2] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=17.619 | 4168.3 samples/s | 65.1 steps/s
[Step=58550 Epoch=225.4] | Loss=0.00005 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.284 | L2-Norm(final)=17.621 | 4483.8 samples/s | 70.1 steps/s
[Step=58600 Epoch=225.6] | Loss=0.00004 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.284 | L2-Norm(final)=17.622 | 4452.7 samples/s | 69.6 steps/s
[Step=58650 Epoch=225.8] | Loss=0.00003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=17.624 | 4492.0 samples/s | 70.2 steps/s
[Step=58700 Epoch=226.0] | Loss=0.00002 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.280 | L2-Norm(final)=17.625 | 4489.8 samples/s | 70.2 steps/s
[Step=58750 Epoch=226.2] | Loss=0.00002 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.276 | L2-Norm(final)=17.627 | 5738.0 samples/s | 89.7 steps/s
[Step=58800 Epoch=226.3] | Loss=0.00002 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.271 | L2-Norm(final)=17.628 | 1933.0 samples/s | 30.2 steps/s
[Step=58850 Epoch=226.5] | Loss=0.00002 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.267 | L2-Norm(final)=17.629 | 4557.6 samples/s | 71.2 steps/s
[Step=58900 Epoch=226.7] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.262 | L2-Norm(final)=17.630 | 4596.6 samples/s | 71.8 steps/s
[Step=58950 Epoch=226.9] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.257 | L2-Norm(final)=17.631 | 4457.8 samples/s | 69.7 steps/s
[Step=59000 Epoch=227.1] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.253 | L2-Norm(final)=17.632 | 5089.8 samples/s | 79.5 steps/s
[Step=59050 Epoch=227.3] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.248 | L2-Norm(final)=17.633 | 2066.7 samples/s | 32.3 steps/s
[Step=59100 Epoch=227.5] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.243 | L2-Norm(final)=17.633 | 4610.6 samples/s | 72.0 steps/s
[Step=59150 Epoch=227.7] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.238 | L2-Norm(final)=17.634 | 4555.7 samples/s | 71.2 steps/s
[Step=59200 Epoch=227.9] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.233 | L2-Norm(final)=17.635 | 4512.5 samples/s | 70.5 steps/s
[Step=59250 Epoch=228.1] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.228 | L2-Norm(final)=17.636 | 4619.0 samples/s | 72.2 steps/s
[Step=59300 Epoch=228.3] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.223 | L2-Norm(final)=17.636 | 2152.1 samples/s | 33.6 steps/s
[Step=59350 Epoch=228.5] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.218 | L2-Norm(final)=17.637 | 4576.0 samples/s | 71.5 steps/s
[Step=59400 Epoch=228.7] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.213 | L2-Norm(final)=17.638 | 4651.0 samples/s | 72.7 steps/s
[Step=59450 Epoch=228.8] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.208 | L2-Norm(final)=17.638 | 4577.3 samples/s | 71.5 steps/s
[Step=59500 Epoch=229.0] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.203 | L2-Norm(final)=17.639 | 4490.3 samples/s | 70.2 steps/s
[Step=59550 Epoch=229.2] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.198 | L2-Norm(final)=17.639 | 2168.2 samples/s | 33.9 steps/s
[Step=59600 Epoch=229.4] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.193 | L2-Norm(final)=17.640 | 4721.6 samples/s | 73.8 steps/s
[Step=59650 Epoch=229.6] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.188 | L2-Norm(final)=17.641 | 4625.6 samples/s | 72.3 steps/s
[Step=59700 Epoch=229.8] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.183 | L2-Norm(final)=17.641 | 4659.0 samples/s | 72.8 steps/s
[Step=59750 Epoch=230.0] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.177 | L2-Norm(final)=17.642 | 4621.0 samples/s | 72.2 steps/s
[Step=59800 Epoch=230.2] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.172 | L2-Norm(final)=17.642 | 6754.3 samples/s | 105.5 steps/s
[Step=59850 Epoch=230.4] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.167 | L2-Norm(final)=17.643 | 1856.8 samples/s | 29.0 steps/s
[Step=59900 Epoch=230.6] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.161 | L2-Norm(final)=17.643 | 4443.5 samples/s | 69.4 steps/s
[Step=59950 Epoch=230.8] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.156 | L2-Norm(final)=17.644 | 4504.8 samples/s | 70.4 steps/s
[Step=60000 Epoch=231.0] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.150 | L2-Norm(final)=17.644 | 4487.7 samples/s | 70.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step60000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07310 | acc=0.9705 | tpr=0.9773 | fpr=0.0441 | 4422.3 samples/s | 17.3 steps/s
Avg test loss: 0.07229, Avg test acc: 0.97027, Avg tpr: 0.97715, Avg fpr: 0.04487, total FA: 350

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06636 | acc=0.9709 | tpr=0.9774 | fpr=0.0434 | 4415.6 samples/s | 17.2 steps/s
Avg test loss: 0.06737, Avg test acc: 0.97075, Avg tpr: 0.97797, Avg fpr: 0.04512, total FA: 352

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.20604 | acc=0.3129 | tpr=0.0087 | fpr=0.0265 | 4387.6 samples/s | 17.1 steps/s
Avg test loss: 6.22895, Avg test acc: 0.31052, Avg tpr: 0.00886, Avg fpr: 0.02602, total FA: 203

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.83431 | acc=0.3018 | tpr=0.0134 | fpr=0.0719 | 4367.5 samples/s | 17.1 steps/s
Avg test loss: 5.85433, Avg test acc: 0.29866, Avg tpr: 0.01341, Avg fpr: 0.07396, total FA: 577

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.31271 | acc=0.1175 | tpr=0.7257 | fpr=0.8934 | 4537.6 samples/s | 17.7 steps/s
[Step= 100] | Loss=6.28194 | acc=0.1177 | tpr=0.7207 | fpr=0.8936 | 7963.5 samples/s | 31.1 steps/s
[Step= 150] | Loss=6.30119 | acc=0.1173 | tpr=0.7190 | fpr=0.8937 | 8560.8 samples/s | 33.4 steps/s
[Step= 200] | Loss=6.29947 | acc=0.1166 | tpr=0.7071 | fpr=0.8941 | 8154.7 samples/s | 31.9 steps/s
[Step= 250] | Loss=6.31219 | acc=0.1159 | tpr=0.7162 | fpr=0.8950 | 8505.7 samples/s | 33.2 steps/s
[Step= 300] | Loss=6.30521 | acc=0.1158 | tpr=0.7178 | fpr=0.8952 | 8454.4 samples/s | 33.0 steps/s
[Step= 350] | Loss=6.30619 | acc=0.1151 | tpr=0.7145 | fpr=0.8958 | 8206.1 samples/s | 32.1 steps/s
[Step= 400] | Loss=6.31189 | acc=0.1153 | tpr=0.7144 | fpr=0.8956 | 8752.9 samples/s | 34.2 steps/s
[Step= 450] | Loss=6.31331 | acc=0.1157 | tpr=0.7157 | fpr=0.8952 | 8254.3 samples/s | 32.2 steps/s
[Step= 500] | Loss=6.31422 | acc=0.1155 | tpr=0.7181 | fpr=0.8954 | 8591.1 samples/s | 33.6 steps/s
[Step= 550] | Loss=6.32027 | acc=0.1153 | tpr=0.7143 | fpr=0.8956 | 14707.6 samples/s | 57.5 steps/s
Avg test loss: 6.32029, Avg test acc: 0.11517, Avg tpr: 0.71395, Avg fpr: 0.89571, total FA: 124368

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.67366 | acc=0.1180 | tpr=0.7301 | fpr=0.8930 | 4391.7 samples/s | 17.2 steps/s
[Step= 100] | Loss=6.63848 | acc=0.1189 | tpr=0.7143 | fpr=0.8922 | 8742.3 samples/s | 34.1 steps/s
[Step= 150] | Loss=6.65164 | acc=0.1180 | tpr=0.7147 | fpr=0.8929 | 8754.2 samples/s | 34.2 steps/s
[Step= 200] | Loss=6.64549 | acc=0.1181 | tpr=0.7104 | fpr=0.8927 | 8053.5 samples/s | 31.5 steps/s
[Step= 250] | Loss=6.65513 | acc=0.1178 | tpr=0.7109 | fpr=0.8930 | 8412.8 samples/s | 32.9 steps/s
[Step= 300] | Loss=6.64859 | acc=0.1173 | tpr=0.7098 | fpr=0.8935 | 8772.0 samples/s | 34.3 steps/s
[Step= 350] | Loss=6.64675 | acc=0.1166 | tpr=0.7070 | fpr=0.8941 | 8215.5 samples/s | 32.1 steps/s
[Step= 400] | Loss=6.65357 | acc=0.1167 | tpr=0.7079 | fpr=0.8940 | 8364.2 samples/s | 32.7 steps/s
[Step= 450] | Loss=6.65575 | acc=0.1165 | tpr=0.7093 | fpr=0.8942 | 8074.4 samples/s | 31.5 steps/s
[Step= 500] | Loss=6.65528 | acc=0.1164 | tpr=0.7106 | fpr=0.8943 | 8530.7 samples/s | 33.3 steps/s
[Step= 550] | Loss=6.65968 | acc=0.1162 | tpr=0.7027 | fpr=0.8945 | 14929.0 samples/s | 58.3 steps/s
Avg test loss: 6.65968, Avg test acc: 0.11611, Avg tpr: 0.70246, Avg fpr: 0.89455, total FA: 124206

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11763 | acc=0.9838 | tpr=0.9204 | fpr=0.0150 | 4355.8 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.12487 | acc=0.9834 | tpr=0.9403 | fpr=0.0158 | 8507.7 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.12754 | acc=0.9829 | tpr=0.9452 | fpr=0.0164 | 8768.2 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.12806 | acc=0.9830 | tpr=0.9475 | fpr=0.0164 | 7851.2 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.12666 | acc=0.9833 | tpr=0.9485 | fpr=0.0161 | 8531.3 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.12747 | acc=0.9833 | tpr=0.9498 | fpr=0.0161 | 8413.2 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.12893 | acc=0.9831 | tpr=0.9499 | fpr=0.0163 | 8129.6 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.13082 | acc=0.9829 | tpr=0.9480 | fpr=0.0165 | 8638.0 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.13329 | acc=0.9826 | tpr=0.9489 | fpr=0.0167 | 8376.2 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.13307 | acc=0.9826 | tpr=0.9489 | fpr=0.0168 | 8312.8 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.13225 | acc=0.9827 | tpr=0.9451 | fpr=0.0166 | 15105.2 samples/s | 59.0 steps/s
Avg test loss: 0.13190, Avg test acc: 0.98272, Avg tpr: 0.94532, Avg fpr: 0.01660, total FA: 2305

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13200 | acc=0.9819 | tpr=0.9425 | fpr=0.0174 | 4390.8 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.14025 | acc=0.9817 | tpr=0.9595 | fpr=0.0179 | 8540.5 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.14471 | acc=0.9809 | tpr=0.9640 | fpr=0.0188 | 8330.5 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.14546 | acc=0.9810 | tpr=0.9628 | fpr=0.0187 | 8361.3 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.14390 | acc=0.9813 | tpr=0.9616 | fpr=0.0184 | 8527.2 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.14472 | acc=0.9813 | tpr=0.9629 | fpr=0.0184 | 8315.4 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.14630 | acc=0.9811 | tpr=0.9637 | fpr=0.0186 | 8545.3 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.14848 | acc=0.9809 | tpr=0.9628 | fpr=0.0188 | 8309.3 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.15134 | acc=0.9807 | tpr=0.9620 | fpr=0.0190 | 8435.6 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.15111 | acc=0.9807 | tpr=0.9612 | fpr=0.0190 | 8400.1 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.14998 | acc=0.9808 | tpr=0.9578 | fpr=0.0188 | 14668.2 samples/s | 57.3 steps/s
Avg test loss: 0.14964, Avg test acc: 0.98079, Avg tpr: 0.95800, Avg fpr: 0.01880, total FA: 2610

server round 30/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=60001 Epoch=117.0] | Loss=0.00293 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=16.530 | 4209.9 samples/s | 65.8 steps/s
[Step=60050 Epoch=117.1] | Loss=0.00733 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.245 | L2-Norm(final)=16.534 | 5095.0 samples/s | 79.6 steps/s
[Step=60100 Epoch=117.2] | Loss=0.00750 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=16.539 | 5586.3 samples/s | 87.3 steps/s
[Step=60150 Epoch=117.3] | Loss=0.00768 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=16.545 | 5603.7 samples/s | 87.6 steps/s
[Step=60200 Epoch=117.4] | Loss=0.00793 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=16.550 | 5604.4 samples/s | 87.6 steps/s
[Step=60250 Epoch=117.5] | Loss=0.00814 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.245 | L2-Norm(final)=16.555 | 5647.6 samples/s | 88.2 steps/s
[Step=60300 Epoch=117.6] | Loss=0.00832 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=16.560 | 5505.5 samples/s | 86.0 steps/s
[Step=60350 Epoch=117.7] | Loss=0.00822 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.245 | L2-Norm(final)=16.565 | 5638.1 samples/s | 88.1 steps/s
[Step=60400 Epoch=117.8] | Loss=0.00819 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.245 | L2-Norm(final)=16.570 | 5578.6 samples/s | 87.2 steps/s
[Step=60450 Epoch=117.9] | Loss=0.00834 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.245 | L2-Norm(final)=16.575 | 5610.2 samples/s | 87.7 steps/s
[Step=60500 Epoch=118.0] | Loss=0.00842 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=16.580 | 6985.1 samples/s | 109.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=60501 Epoch=118.0] | Loss=0.00866 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=16.632 | 3889.0 samples/s | 60.8 steps/s
[Step=60550 Epoch=118.1] | Loss=0.00759 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.251 | L2-Norm(final)=16.637 | 4797.9 samples/s | 75.0 steps/s
[Step=60600 Epoch=118.2] | Loss=0.00745 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.257 | L2-Norm(final)=16.641 | 4883.1 samples/s | 76.3 steps/s
[Step=60650 Epoch=118.3] | Loss=0.00742 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.262 | L2-Norm(final)=16.643 | 4866.6 samples/s | 76.0 steps/s
[Step=60700 Epoch=118.4] | Loss=0.00741 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.266 | L2-Norm(final)=16.645 | 4877.9 samples/s | 76.2 steps/s
[Step=60750 Epoch=118.5] | Loss=0.00734 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.270 | L2-Norm(final)=16.647 | 4759.0 samples/s | 74.4 steps/s
[Step=60800 Epoch=118.6] | Loss=0.00760 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.274 | L2-Norm(final)=16.649 | 4773.1 samples/s | 74.6 steps/s
[Step=60850 Epoch=118.7] | Loss=0.00765 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.277 | L2-Norm(final)=16.651 | 4927.7 samples/s | 77.0 steps/s
[Step=60900 Epoch=118.8] | Loss=0.00756 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.280 | L2-Norm(final)=16.653 | 4925.0 samples/s | 77.0 steps/s
[Step=60950 Epoch=118.9] | Loss=0.00754 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=16.655 | 4888.8 samples/s | 76.4 steps/s
[Step=61000 Epoch=119.0] | Loss=0.00743 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=16.656 | 5999.8 samples/s | 93.7 steps/s
[Step=61050 Epoch=119.1] | Loss=0.00723 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.289 | L2-Norm(final)=16.658 | 1940.9 samples/s | 30.3 steps/s
[Step=61100 Epoch=119.2] | Loss=0.00716 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.291 | L2-Norm(final)=16.661 | 4744.0 samples/s | 74.1 steps/s
[Step=61150 Epoch=119.3] | Loss=0.00690 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.293 | L2-Norm(final)=16.662 | 4819.1 samples/s | 75.3 steps/s
[Step=61200 Epoch=119.4] | Loss=0.00687 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.296 | L2-Norm(final)=16.664 | 4737.7 samples/s | 74.0 steps/s
[Step=61250 Epoch=119.5] | Loss=0.00676 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.298 | L2-Norm(final)=16.666 | 4792.5 samples/s | 74.9 steps/s
[Step=61300 Epoch=119.6] | Loss=0.00678 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.300 | L2-Norm(final)=16.668 | 4816.0 samples/s | 75.2 steps/s
[Step=61350 Epoch=119.7] | Loss=0.00671 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.302 | L2-Norm(final)=16.670 | 4746.1 samples/s | 74.2 steps/s
[Step=61400 Epoch=119.8] | Loss=0.00665 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.304 | L2-Norm(final)=16.671 | 4714.1 samples/s | 73.7 steps/s
[Step=61450 Epoch=119.9] | Loss=0.00655 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.306 | L2-Norm(final)=16.673 | 4755.7 samples/s | 74.3 steps/s
[Step=61500 Epoch=119.9] | Loss=0.00652 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.307 | L2-Norm(final)=16.674 | 5024.5 samples/s | 78.5 steps/s
[Step=61550 Epoch=120.0] | Loss=0.00657 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.309 | L2-Norm(final)=16.676 | 2033.7 samples/s | 31.8 steps/s
[Step=61600 Epoch=120.1] | Loss=0.00654 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.311 | L2-Norm(final)=16.677 | 4834.6 samples/s | 75.5 steps/s
[Step=61650 Epoch=120.2] | Loss=0.00653 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.313 | L2-Norm(final)=16.678 | 4689.7 samples/s | 73.3 steps/s
[Step=61700 Epoch=120.3] | Loss=0.00645 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.314 | L2-Norm(final)=16.680 | 4678.7 samples/s | 73.1 steps/s
[Step=61750 Epoch=120.4] | Loss=0.00635 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.316 | L2-Norm(final)=16.681 | 4709.8 samples/s | 73.6 steps/s
[Step=61800 Epoch=120.5] | Loss=0.00628 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.317 | L2-Norm(final)=16.682 | 4792.2 samples/s | 74.9 steps/s
[Step=61850 Epoch=120.6] | Loss=0.00620 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.319 | L2-Norm(final)=16.684 | 4770.8 samples/s | 74.5 steps/s
[Step=61900 Epoch=120.7] | Loss=0.00615 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.320 | L2-Norm(final)=16.685 | 4818.3 samples/s | 75.3 steps/s
[Step=61950 Epoch=120.8] | Loss=0.00614 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.322 | L2-Norm(final)=16.686 | 4799.5 samples/s | 75.0 steps/s
[Step=62000 Epoch=120.9] | Loss=0.00614 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.323 | L2-Norm(final)=16.687 | 4806.4 samples/s | 75.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step62000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=60001 Epoch=117.3] | Loss=0.01159 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=16.868 | 4133.0 samples/s | 64.6 steps/s
[Step=60050 Epoch=117.4] | Loss=0.00950 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=16.872 | 5551.1 samples/s | 86.7 steps/s
[Step=60100 Epoch=117.5] | Loss=0.00956 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=16.877 | 5476.3 samples/s | 85.6 steps/s
[Step=60150 Epoch=117.6] | Loss=0.00900 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=16.882 | 5425.4 samples/s | 84.8 steps/s
[Step=60200 Epoch=117.7] | Loss=0.00837 | Reg=0.00126 | acc=0.9531 | L2-Norm=11.245 | L2-Norm(final)=16.888 | 5494.7 samples/s | 85.9 steps/s
[Step=60250 Epoch=117.8] | Loss=0.00860 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=16.894 | 5557.8 samples/s | 86.8 steps/s
[Step=60300 Epoch=117.9] | Loss=0.00833 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=16.899 | 5383.7 samples/s | 84.1 steps/s
[Step=60350 Epoch=118.0] | Loss=0.00803 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.245 | L2-Norm(final)=16.905 | 5459.8 samples/s | 85.3 steps/s
[Step=60400 Epoch=118.1] | Loss=0.00798 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=16.910 | 5429.2 samples/s | 84.8 steps/s
[Step=60450 Epoch=118.2] | Loss=0.00815 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=16.916 | 5543.4 samples/s | 86.6 steps/s
[Step=60500 Epoch=118.3] | Loss=0.00813 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.245 | L2-Norm(final)=16.921 | 6881.1 samples/s | 107.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=60501 Epoch=118.3] | Loss=0.00454 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=16.979 | 4177.1 samples/s | 65.3 steps/s
[Step=60550 Epoch=118.4] | Loss=0.00849 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.251 | L2-Norm(final)=16.985 | 4857.9 samples/s | 75.9 steps/s
[Step=60600 Epoch=118.5] | Loss=0.00836 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.256 | L2-Norm(final)=16.988 | 4760.5 samples/s | 74.4 steps/s
[Step=60650 Epoch=118.6] | Loss=0.00796 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=16.991 | 4780.3 samples/s | 74.7 steps/s
[Step=60700 Epoch=118.7] | Loss=0.00850 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.264 | L2-Norm(final)=16.993 | 4757.8 samples/s | 74.3 steps/s
[Step=60750 Epoch=118.8] | Loss=0.00804 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.267 | L2-Norm(final)=16.995 | 4773.2 samples/s | 74.6 steps/s
[Step=60800 Epoch=118.9] | Loss=0.00774 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.270 | L2-Norm(final)=16.997 | 4775.9 samples/s | 74.6 steps/s
[Step=60850 Epoch=119.0] | Loss=0.00755 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.273 | L2-Norm(final)=16.999 | 4895.9 samples/s | 76.5 steps/s
[Step=60900 Epoch=119.1] | Loss=0.00737 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.276 | L2-Norm(final)=17.001 | 4936.3 samples/s | 77.1 steps/s
[Step=60950 Epoch=119.2] | Loss=0.00726 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.279 | L2-Norm(final)=17.003 | 4879.6 samples/s | 76.2 steps/s
[Step=61000 Epoch=119.3] | Loss=0.00719 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.282 | L2-Norm(final)=17.005 | 6018.4 samples/s | 94.0 steps/s
[Step=61050 Epoch=119.4] | Loss=0.00705 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.284 | L2-Norm(final)=17.007 | 2029.3 samples/s | 31.7 steps/s
[Step=61100 Epoch=119.4] | Loss=0.00695 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=17.009 | 4794.6 samples/s | 74.9 steps/s
[Step=61150 Epoch=119.5] | Loss=0.00690 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.289 | L2-Norm(final)=17.011 | 4745.0 samples/s | 74.1 steps/s
[Step=61200 Epoch=119.6] | Loss=0.00678 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.291 | L2-Norm(final)=17.012 | 4727.5 samples/s | 73.9 steps/s
[Step=61250 Epoch=119.7] | Loss=0.00665 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.293 | L2-Norm(final)=17.014 | 4758.5 samples/s | 74.4 steps/s
[Step=61300 Epoch=119.8] | Loss=0.00650 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.295 | L2-Norm(final)=17.016 | 4784.9 samples/s | 74.8 steps/s
[Step=61350 Epoch=119.9] | Loss=0.00648 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.297 | L2-Norm(final)=17.017 | 4869.1 samples/s | 76.1 steps/s
[Step=61400 Epoch=120.0] | Loss=0.00639 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.299 | L2-Norm(final)=17.019 | 4734.0 samples/s | 74.0 steps/s
[Step=61450 Epoch=120.1] | Loss=0.00636 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.301 | L2-Norm(final)=17.020 | 4727.5 samples/s | 73.9 steps/s
[Step=61500 Epoch=120.2] | Loss=0.00631 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.303 | L2-Norm(final)=17.022 | 5199.4 samples/s | 81.2 steps/s
[Step=61550 Epoch=120.3] | Loss=0.00625 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.305 | L2-Norm(final)=17.024 | 2132.7 samples/s | 33.3 steps/s
[Step=61600 Epoch=120.4] | Loss=0.00614 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.306 | L2-Norm(final)=17.025 | 4727.4 samples/s | 73.9 steps/s
[Step=61650 Epoch=120.5] | Loss=0.00606 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.308 | L2-Norm(final)=17.027 | 4704.9 samples/s | 73.5 steps/s
[Step=61700 Epoch=120.6] | Loss=0.00600 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.310 | L2-Norm(final)=17.029 | 4755.0 samples/s | 74.3 steps/s
[Step=61750 Epoch=120.7] | Loss=0.00600 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.311 | L2-Norm(final)=17.030 | 4693.7 samples/s | 73.3 steps/s
[Step=61800 Epoch=120.8] | Loss=0.00590 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.313 | L2-Norm(final)=17.032 | 4746.0 samples/s | 74.2 steps/s
[Step=61850 Epoch=120.9] | Loss=0.00585 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.314 | L2-Norm(final)=17.034 | 4808.5 samples/s | 75.1 steps/s
[Step=61900 Epoch=121.0] | Loss=0.00578 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.316 | L2-Norm(final)=17.035 | 4760.0 samples/s | 74.4 steps/s
[Step=61950 Epoch=121.1] | Loss=0.00580 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.317 | L2-Norm(final)=17.037 | 4799.6 samples/s | 75.0 steps/s
[Step=62000 Epoch=121.2] | Loss=0.00579 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.318 | L2-Norm(final)=17.038 | 4863.3 samples/s | 76.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step62000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=60001 Epoch=229.9] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=17.631 | 4534.0 samples/s | 70.8 steps/s
[Step=60050 Epoch=230.1] | Loss=0.00004 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.632 | 4597.9 samples/s | 71.8 steps/s
[Step=60100 Epoch=230.3] | Loss=0.00005 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.635 | 5205.6 samples/s | 81.3 steps/s
[Step=60150 Epoch=230.5] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.637 | 5033.1 samples/s | 78.6 steps/s
[Step=60200 Epoch=230.7] | Loss=0.00007 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.639 | 5221.6 samples/s | 81.6 steps/s
[Step=60250 Epoch=230.9] | Loss=0.00007 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.641 | 6606.6 samples/s | 103.2 steps/s
[Step=60300 Epoch=231.0] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.643 | 2033.8 samples/s | 31.8 steps/s
[Step=60350 Epoch=231.2] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.644 | 5233.6 samples/s | 81.8 steps/s
[Step=60400 Epoch=231.4] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.646 | 5024.4 samples/s | 78.5 steps/s
[Step=60450 Epoch=231.6] | Loss=0.00007 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.647 | 5154.9 samples/s | 80.5 steps/s
[Step=60500 Epoch=231.8] | Loss=0.00007 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.649 | 5903.1 samples/s | 92.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=60501 Epoch=231.8] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.668 | 4390.5 samples/s | 68.6 steps/s
[Step=60550 Epoch=232.0] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.238 | L2-Norm(final)=17.669 | 4239.0 samples/s | 66.2 steps/s
[Step=60600 Epoch=232.2] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.233 | L2-Norm(final)=17.670 | 4635.3 samples/s | 72.4 steps/s
[Step=60650 Epoch=232.4] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.230 | L2-Norm(final)=17.671 | 4522.7 samples/s | 70.7 steps/s
[Step=60700 Epoch=232.6] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.227 | L2-Norm(final)=17.672 | 4495.3 samples/s | 70.2 steps/s
[Step=60750 Epoch=232.8] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.223 | L2-Norm(final)=17.673 | 5701.3 samples/s | 89.1 steps/s
[Step=60800 Epoch=233.0] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.219 | L2-Norm(final)=17.673 | 1947.0 samples/s | 30.4 steps/s
[Step=60850 Epoch=233.2] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=17.674 | 4536.2 samples/s | 70.9 steps/s
[Step=60900 Epoch=233.3] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.210 | L2-Norm(final)=17.674 | 4489.2 samples/s | 70.1 steps/s
[Step=60950 Epoch=233.5] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=17.675 | 4552.4 samples/s | 71.1 steps/s
[Step=61000 Epoch=233.7] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.201 | L2-Norm(final)=17.675 | 4921.7 samples/s | 76.9 steps/s
[Step=61050 Epoch=233.9] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.196 | L2-Norm(final)=17.675 | 2049.0 samples/s | 32.0 steps/s
[Step=61100 Epoch=234.1] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=17.676 | 4550.2 samples/s | 71.1 steps/s
[Step=61150 Epoch=234.3] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.187 | L2-Norm(final)=17.676 | 4453.0 samples/s | 69.6 steps/s
[Step=61200 Epoch=234.5] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.182 | L2-Norm(final)=17.676 | 4519.8 samples/s | 70.6 steps/s
[Step=61250 Epoch=234.7] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.177 | L2-Norm(final)=17.676 | 4446.6 samples/s | 69.5 steps/s
[Step=61300 Epoch=234.9] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.172 | L2-Norm(final)=17.677 | 2096.1 samples/s | 32.8 steps/s
[Step=61350 Epoch=235.1] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.167 | L2-Norm(final)=17.677 | 4728.8 samples/s | 73.9 steps/s
[Step=61400 Epoch=235.3] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.162 | L2-Norm(final)=17.677 | 4633.2 samples/s | 72.4 steps/s
[Step=61450 Epoch=235.5] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.157 | L2-Norm(final)=17.678 | 4612.8 samples/s | 72.1 steps/s
[Step=61500 Epoch=235.6] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.152 | L2-Norm(final)=17.678 | 4620.4 samples/s | 72.2 steps/s
[Step=61550 Epoch=235.8] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.147 | L2-Norm(final)=17.678 | 2144.0 samples/s | 33.5 steps/s
[Step=61600 Epoch=236.0] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.142 | L2-Norm(final)=17.679 | 4540.0 samples/s | 70.9 steps/s
[Step=61650 Epoch=236.2] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.136 | L2-Norm(final)=17.679 | 4537.2 samples/s | 70.9 steps/s
[Step=61700 Epoch=236.4] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.131 | L2-Norm(final)=17.679 | 4561.0 samples/s | 71.3 steps/s
[Step=61750 Epoch=236.6] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.126 | L2-Norm(final)=17.680 | 4596.4 samples/s | 71.8 steps/s
[Step=61800 Epoch=236.8] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.120 | L2-Norm(final)=17.680 | 6118.7 samples/s | 95.6 steps/s
[Step=61850 Epoch=237.0] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.115 | L2-Norm(final)=17.680 | 1908.9 samples/s | 29.8 steps/s
[Step=61900 Epoch=237.2] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.109 | L2-Norm(final)=17.681 | 4545.0 samples/s | 71.0 steps/s
[Step=61950 Epoch=237.4] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.104 | L2-Norm(final)=17.681 | 4456.1 samples/s | 69.6 steps/s
[Step=62000 Epoch=237.6] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.098 | L2-Norm(final)=17.681 | 4515.1 samples/s | 70.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step62000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=60001 Epoch=231.0] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.245 | L2-Norm(final)=17.661 | 4220.4 samples/s | 65.9 steps/s
[Step=60050 Epoch=231.2] | Loss=0.00004 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.662 | 5208.8 samples/s | 81.4 steps/s
[Step=60100 Epoch=231.3] | Loss=0.00007 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.664 | 5208.8 samples/s | 81.4 steps/s
[Step=60150 Epoch=231.5] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.666 | 5308.1 samples/s | 82.9 steps/s
[Step=60200 Epoch=231.7] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.669 | 5070.4 samples/s | 79.2 steps/s
[Step=60250 Epoch=231.9] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.671 | 6904.2 samples/s | 107.9 steps/s
[Step=60300 Epoch=232.1] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.673 | 2044.4 samples/s | 31.9 steps/s
[Step=60350 Epoch=232.3] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.676 | 5054.6 samples/s | 79.0 steps/s
[Step=60400 Epoch=232.5] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.678 | 5114.1 samples/s | 79.9 steps/s
[Step=60450 Epoch=232.7] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.681 | 5137.3 samples/s | 80.3 steps/s
[Step=60500 Epoch=232.9] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.683 | 6018.1 samples/s | 94.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=60501 Epoch=232.9] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=17.707 | 4338.1 samples/s | 67.8 steps/s
[Step=60550 Epoch=233.1] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.239 | L2-Norm(final)=17.709 | 4292.0 samples/s | 67.1 steps/s
[Step=60600 Epoch=233.3] | Loss=0.00003 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.239 | L2-Norm(final)=17.712 | 4471.9 samples/s | 69.9 steps/s
[Step=60650 Epoch=233.5] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.235 | L2-Norm(final)=17.713 | 4529.2 samples/s | 70.8 steps/s
[Step=60700 Epoch=233.7] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.231 | L2-Norm(final)=17.714 | 4490.2 samples/s | 70.2 steps/s
[Step=60750 Epoch=233.9] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.226 | L2-Norm(final)=17.714 | 5798.5 samples/s | 90.6 steps/s
[Step=60800 Epoch=234.0] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.220 | L2-Norm(final)=17.715 | 1960.8 samples/s | 30.6 steps/s
[Step=60850 Epoch=234.2] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=17.716 | 4533.9 samples/s | 70.8 steps/s
[Step=60900 Epoch=234.4] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.210 | L2-Norm(final)=17.716 | 4440.6 samples/s | 69.4 steps/s
[Step=60950 Epoch=234.6] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.204 | L2-Norm(final)=17.717 | 4606.4 samples/s | 72.0 steps/s
[Step=61000 Epoch=234.8] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.199 | L2-Norm(final)=17.717 | 4966.2 samples/s | 77.6 steps/s
[Step=61050 Epoch=235.0] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.193 | L2-Norm(final)=17.717 | 2064.0 samples/s | 32.3 steps/s
[Step=61100 Epoch=235.2] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.188 | L2-Norm(final)=17.718 | 4557.8 samples/s | 71.2 steps/s
[Step=61150 Epoch=235.4] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.182 | L2-Norm(final)=17.718 | 4466.4 samples/s | 69.8 steps/s
[Step=61200 Epoch=235.6] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=17.719 | 4526.9 samples/s | 70.7 steps/s
[Step=61250 Epoch=235.8] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.171 | L2-Norm(final)=17.719 | 4653.9 samples/s | 72.7 steps/s
[Step=61300 Epoch=236.0] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.165 | L2-Norm(final)=17.719 | 2149.2 samples/s | 33.6 steps/s
[Step=61350 Epoch=236.2] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.159 | L2-Norm(final)=17.720 | 4567.7 samples/s | 71.4 steps/s
[Step=61400 Epoch=236.4] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.153 | L2-Norm(final)=17.720 | 4671.3 samples/s | 73.0 steps/s
[Step=61450 Epoch=236.5] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.147 | L2-Norm(final)=17.720 | 4610.6 samples/s | 72.0 steps/s
[Step=61500 Epoch=236.7] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.141 | L2-Norm(final)=17.721 | 4566.8 samples/s | 71.4 steps/s
[Step=61550 Epoch=236.9] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.135 | L2-Norm(final)=17.721 | 2107.2 samples/s | 32.9 steps/s
[Step=61600 Epoch=237.1] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.129 | L2-Norm(final)=17.722 | 4562.6 samples/s | 71.3 steps/s
[Step=61650 Epoch=237.3] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.123 | L2-Norm(final)=17.722 | 4499.7 samples/s | 70.3 steps/s
[Step=61700 Epoch=237.5] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.117 | L2-Norm(final)=17.722 | 4498.9 samples/s | 70.3 steps/s
[Step=61750 Epoch=237.7] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.110 | L2-Norm(final)=17.723 | 4561.2 samples/s | 71.3 steps/s
[Step=61800 Epoch=237.9] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.104 | L2-Norm(final)=17.723 | 6632.1 samples/s | 103.6 steps/s
[Step=61850 Epoch=238.1] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.098 | L2-Norm(final)=17.724 | 1870.8 samples/s | 29.2 steps/s
[Step=61900 Epoch=238.3] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.091 | L2-Norm(final)=17.724 | 4474.8 samples/s | 69.9 steps/s
[Step=61950 Epoch=238.5] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.085 | L2-Norm(final)=17.725 | 4504.4 samples/s | 70.4 steps/s
[Step=62000 Epoch=238.7] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.078 | L2-Norm(final)=17.725 | 4522.9 samples/s | 70.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step62000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07333 | acc=0.9724 | tpr=0.9790 | fpr=0.0419 | 4485.9 samples/s | 17.5 steps/s
Avg test loss: 0.07374, Avg test acc: 0.97147, Avg tpr: 0.97855, Avg fpr: 0.04410, total FA: 344

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07110 | acc=0.9721 | tpr=0.9793 | fpr=0.0436 | 4460.6 samples/s | 17.4 steps/s
Avg test loss: 0.07232, Avg test acc: 0.97255, Avg tpr: 0.98036, Avg fpr: 0.04461, total FA: 348

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.84422 | acc=0.3133 | tpr=0.0143 | fpr=0.0374 | 4397.3 samples/s | 17.2 steps/s
Avg test loss: 5.86086, Avg test acc: 0.31044, Avg tpr: 0.01440, Avg fpr: 0.03846, total FA: 300

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.67486 | acc=0.3061 | tpr=0.0154 | fpr=0.0627 | 4429.3 samples/s | 17.3 steps/s
Avg test loss: 5.69020, Avg test acc: 0.30331, Avg tpr: 0.01527, Avg fpr: 0.06320, total FA: 493

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.87906 | acc=0.1015 | tpr=0.7080 | fpr=0.9094 | 4457.0 samples/s | 17.4 steps/s
[Step= 100] | Loss=6.85429 | acc=0.1004 | tpr=0.7036 | fpr=0.9109 | 8590.8 samples/s | 33.6 steps/s
[Step= 150] | Loss=6.87005 | acc=0.1001 | tpr=0.7075 | fpr=0.9111 | 8232.8 samples/s | 32.2 steps/s
[Step= 200] | Loss=6.86950 | acc=0.0996 | tpr=0.6918 | fpr=0.9111 | 8572.6 samples/s | 33.5 steps/s
[Step= 250] | Loss=6.88291 | acc=0.0991 | tpr=0.6961 | fpr=0.9118 | 8208.9 samples/s | 32.1 steps/s
[Step= 300] | Loss=6.87816 | acc=0.0992 | tpr=0.6938 | fpr=0.9117 | 8271.3 samples/s | 32.3 steps/s
[Step= 350] | Loss=6.87844 | acc=0.0985 | tpr=0.6925 | fpr=0.9123 | 8613.7 samples/s | 33.6 steps/s
[Step= 400] | Loss=6.88583 | acc=0.0983 | tpr=0.6937 | fpr=0.9125 | 8354.6 samples/s | 32.6 steps/s
[Step= 450] | Loss=6.88831 | acc=0.0984 | tpr=0.6962 | fpr=0.9124 | 8558.5 samples/s | 33.4 steps/s
[Step= 500] | Loss=6.88825 | acc=0.0984 | tpr=0.6978 | fpr=0.9124 | 8410.7 samples/s | 32.9 steps/s
[Step= 550] | Loss=6.89435 | acc=0.0982 | tpr=0.6908 | fpr=0.9126 | 15189.0 samples/s | 59.3 steps/s
Avg test loss: 6.89450, Avg test acc: 0.09808, Avg tpr: 0.69057, Avg fpr: 0.91269, total FA: 126725

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.79096 | acc=0.1176 | tpr=0.7389 | fpr=0.8936 | 4397.5 samples/s | 17.2 steps/s
[Step= 100] | Loss=6.76605 | acc=0.1183 | tpr=0.7399 | fpr=0.8933 | 8648.9 samples/s | 33.8 steps/s
[Step= 150] | Loss=6.77818 | acc=0.1173 | tpr=0.7406 | fpr=0.8942 | 8310.5 samples/s | 32.5 steps/s
[Step= 200] | Loss=6.77441 | acc=0.1170 | tpr=0.7311 | fpr=0.8942 | 8567.7 samples/s | 33.5 steps/s
[Step= 250] | Loss=6.78787 | acc=0.1168 | tpr=0.7284 | fpr=0.8943 | 8322.0 samples/s | 32.5 steps/s
[Step= 300] | Loss=6.78291 | acc=0.1167 | tpr=0.7295 | fpr=0.8945 | 8409.5 samples/s | 32.8 steps/s
[Step= 350] | Loss=6.78017 | acc=0.1163 | tpr=0.7289 | fpr=0.8949 | 8905.1 samples/s | 34.8 steps/s
[Step= 400] | Loss=6.78761 | acc=0.1164 | tpr=0.7298 | fpr=0.8948 | 8070.7 samples/s | 31.5 steps/s
[Step= 450] | Loss=6.78975 | acc=0.1164 | tpr=0.7317 | fpr=0.8948 | 8271.7 samples/s | 32.3 steps/s
[Step= 500] | Loss=6.79003 | acc=0.1163 | tpr=0.7339 | fpr=0.8948 | 8435.9 samples/s | 33.0 steps/s
[Step= 550] | Loss=6.79432 | acc=0.1162 | tpr=0.7282 | fpr=0.8949 | 14910.1 samples/s | 58.2 steps/s
Avg test loss: 6.79414, Avg test acc: 0.11611, Avg tpr: 0.72781, Avg fpr: 0.89501, total FA: 124271

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12190 | acc=0.9828 | tpr=0.9292 | fpr=0.0162 | 4421.2 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.12963 | acc=0.9825 | tpr=0.9467 | fpr=0.0168 | 8283.2 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.13288 | acc=0.9816 | tpr=0.9510 | fpr=0.0178 | 8290.2 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.13304 | acc=0.9817 | tpr=0.9541 | fpr=0.0178 | 8488.2 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.13173 | acc=0.9820 | tpr=0.9546 | fpr=0.0175 | 8363.6 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.13245 | acc=0.9821 | tpr=0.9571 | fpr=0.0175 | 8466.5 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.13404 | acc=0.9819 | tpr=0.9574 | fpr=0.0177 | 8428.7 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.13604 | acc=0.9817 | tpr=0.9562 | fpr=0.0178 | 8649.7 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.13861 | acc=0.9815 | tpr=0.9562 | fpr=0.0181 | 8404.7 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.13837 | acc=0.9815 | tpr=0.9555 | fpr=0.0181 | 8243.6 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.13759 | acc=0.9816 | tpr=0.9519 | fpr=0.0179 | 15833.3 samples/s | 61.8 steps/s
Avg test loss: 0.13725, Avg test acc: 0.98158, Avg tpr: 0.95206, Avg fpr: 0.01788, total FA: 2483

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12817 | acc=0.9818 | tpr=0.9425 | fpr=0.0175 | 4449.8 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.13558 | acc=0.9817 | tpr=0.9595 | fpr=0.0179 | 8480.6 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.13988 | acc=0.9810 | tpr=0.9640 | fpr=0.0187 | 8512.4 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.14033 | acc=0.9810 | tpr=0.9639 | fpr=0.0187 | 8198.7 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.13931 | acc=0.9812 | tpr=0.9624 | fpr=0.0185 | 8536.5 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.14011 | acc=0.9812 | tpr=0.9636 | fpr=0.0185 | 8260.4 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.14180 | acc=0.9810 | tpr=0.9643 | fpr=0.0187 | 8671.7 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.14393 | acc=0.9807 | tpr=0.9623 | fpr=0.0189 | 8355.7 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.14669 | acc=0.9805 | tpr=0.9615 | fpr=0.0192 | 8781.8 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.14634 | acc=0.9804 | tpr=0.9604 | fpr=0.0192 | 8151.5 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.14541 | acc=0.9805 | tpr=0.9578 | fpr=0.0190 | 15150.9 samples/s | 59.2 steps/s
Avg test loss: 0.14511, Avg test acc: 0.98058, Avg tpr: 0.95800, Avg fpr: 0.01901, total FA: 2640

server round 31/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=62001 Epoch=120.9] | Loss=0.00302 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=16.725 | 3883.8 samples/s | 60.7 steps/s
[Step=62050 Epoch=121.0] | Loss=0.00814 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=16.727 | 5835.4 samples/s | 91.2 steps/s
[Step=62100 Epoch=121.1] | Loss=0.00770 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=16.731 | 5368.8 samples/s | 83.9 steps/s
[Step=62150 Epoch=121.2] | Loss=0.00739 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=16.734 | 5498.8 samples/s | 85.9 steps/s
[Step=62200 Epoch=121.3] | Loss=0.00729 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=16.737 | 5412.6 samples/s | 84.6 steps/s
[Step=62250 Epoch=121.4] | Loss=0.00748 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.105 | L2-Norm(final)=16.740 | 5496.0 samples/s | 85.9 steps/s
[Step=62300 Epoch=121.5] | Loss=0.00740 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=16.744 | 5519.1 samples/s | 86.2 steps/s
[Step=62350 Epoch=121.6] | Loss=0.00722 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=16.748 | 5468.4 samples/s | 85.4 steps/s
[Step=62400 Epoch=121.7] | Loss=0.00716 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.105 | L2-Norm(final)=16.752 | 5444.6 samples/s | 85.1 steps/s
[Step=62450 Epoch=121.8] | Loss=0.00700 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=16.756 | 5493.8 samples/s | 85.8 steps/s
[Step=62500 Epoch=121.9] | Loss=0.00710 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.105 | L2-Norm(final)=16.760 | 6944.9 samples/s | 108.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=62501 Epoch=121.9] | Loss=0.00050 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=16.800 | 4184.6 samples/s | 65.4 steps/s
[Step=62550 Epoch=122.0] | Loss=0.00775 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.111 | L2-Norm(final)=16.802 | 4572.6 samples/s | 71.4 steps/s
[Step=62600 Epoch=122.1] | Loss=0.00780 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.117 | L2-Norm(final)=16.804 | 4720.1 samples/s | 73.8 steps/s
[Step=62650 Epoch=122.2] | Loss=0.00800 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.123 | L2-Norm(final)=16.805 | 4771.8 samples/s | 74.6 steps/s
[Step=62700 Epoch=122.3] | Loss=0.00798 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.128 | L2-Norm(final)=16.806 | 4815.5 samples/s | 75.2 steps/s
[Step=62750 Epoch=122.4] | Loss=0.00783 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.133 | L2-Norm(final)=16.808 | 4801.9 samples/s | 75.0 steps/s
[Step=62800 Epoch=122.5] | Loss=0.00743 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.137 | L2-Norm(final)=16.810 | 4710.1 samples/s | 73.6 steps/s
[Step=62850 Epoch=122.6] | Loss=0.00741 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.141 | L2-Norm(final)=16.813 | 4740.3 samples/s | 74.1 steps/s
[Step=62900 Epoch=122.7] | Loss=0.00732 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.144 | L2-Norm(final)=16.815 | 4730.0 samples/s | 73.9 steps/s
[Step=62950 Epoch=122.8] | Loss=0.00731 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.148 | L2-Norm(final)=16.817 | 4730.7 samples/s | 73.9 steps/s
[Step=63000 Epoch=122.9] | Loss=0.00714 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.151 | L2-Norm(final)=16.819 | 5777.3 samples/s | 90.3 steps/s
[Step=63050 Epoch=123.0] | Loss=0.00713 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.154 | L2-Norm(final)=16.820 | 1967.1 samples/s | 30.7 steps/s
[Step=63100 Epoch=123.1] | Loss=0.00690 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.156 | L2-Norm(final)=16.822 | 4738.1 samples/s | 74.0 steps/s
[Step=63150 Epoch=123.2] | Loss=0.00670 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.159 | L2-Norm(final)=16.824 | 4715.9 samples/s | 73.7 steps/s
[Step=63200 Epoch=123.3] | Loss=0.00669 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.161 | L2-Norm(final)=16.826 | 4830.1 samples/s | 75.5 steps/s
[Step=63250 Epoch=123.4] | Loss=0.00655 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.164 | L2-Norm(final)=16.828 | 4778.8 samples/s | 74.7 steps/s
[Step=63300 Epoch=123.5] | Loss=0.00653 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.166 | L2-Norm(final)=16.830 | 4660.1 samples/s | 72.8 steps/s
[Step=63350 Epoch=123.6] | Loss=0.00656 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.168 | L2-Norm(final)=16.831 | 4766.0 samples/s | 74.5 steps/s
[Step=63400 Epoch=123.7] | Loss=0.00658 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.170 | L2-Norm(final)=16.833 | 4764.8 samples/s | 74.4 steps/s
[Step=63450 Epoch=123.8] | Loss=0.00658 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.172 | L2-Norm(final)=16.834 | 4763.2 samples/s | 74.4 steps/s
[Step=63500 Epoch=123.8] | Loss=0.00658 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.174 | L2-Norm(final)=16.836 | 5117.0 samples/s | 80.0 steps/s
[Step=63550 Epoch=123.9] | Loss=0.00644 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=16.837 | 1985.4 samples/s | 31.0 steps/s
[Step=63600 Epoch=124.0] | Loss=0.00639 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.177 | L2-Norm(final)=16.839 | 4812.3 samples/s | 75.2 steps/s
[Step=63650 Epoch=124.1] | Loss=0.00632 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.179 | L2-Norm(final)=16.840 | 4691.3 samples/s | 73.3 steps/s
[Step=63700 Epoch=124.2] | Loss=0.00621 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.181 | L2-Norm(final)=16.842 | 4770.3 samples/s | 74.5 steps/s
[Step=63750 Epoch=124.3] | Loss=0.00621 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.183 | L2-Norm(final)=16.844 | 4724.1 samples/s | 73.8 steps/s
[Step=63800 Epoch=124.4] | Loss=0.00617 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.185 | L2-Norm(final)=16.845 | 4727.7 samples/s | 73.9 steps/s
[Step=63850 Epoch=124.5] | Loss=0.00610 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.186 | L2-Norm(final)=16.847 | 4701.7 samples/s | 73.5 steps/s
[Step=63900 Epoch=124.6] | Loss=0.00606 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.188 | L2-Norm(final)=16.849 | 4716.3 samples/s | 73.7 steps/s
[Step=63950 Epoch=124.7] | Loss=0.00601 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=16.850 | 4739.8 samples/s | 74.1 steps/s
[Step=64000 Epoch=124.8] | Loss=0.00593 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.191 | L2-Norm(final)=16.852 | 4802.1 samples/s | 75.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step64000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=62001 Epoch=121.2] | Loss=0.00131 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=17.082 | 4490.3 samples/s | 70.2 steps/s
[Step=62050 Epoch=121.3] | Loss=0.00847 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.105 | L2-Norm(final)=17.089 | 5127.1 samples/s | 80.1 steps/s
[Step=62100 Epoch=121.4] | Loss=0.00822 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.105 | L2-Norm(final)=17.096 | 5593.5 samples/s | 87.4 steps/s
[Step=62150 Epoch=121.5] | Loss=0.00857 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=17.103 | 5499.9 samples/s | 85.9 steps/s
[Step=62200 Epoch=121.6] | Loss=0.00924 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.105 | L2-Norm(final)=17.109 | 5441.2 samples/s | 85.0 steps/s
[Step=62250 Epoch=121.7] | Loss=0.00912 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=17.115 | 5528.0 samples/s | 86.4 steps/s
[Step=62300 Epoch=121.8] | Loss=0.00889 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=17.121 | 5476.7 samples/s | 85.6 steps/s
[Step=62350 Epoch=121.9] | Loss=0.00882 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=17.127 | 5525.2 samples/s | 86.3 steps/s
[Step=62400 Epoch=122.0] | Loss=0.00858 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=17.132 | 5384.1 samples/s | 84.1 steps/s
[Step=62450 Epoch=122.1] | Loss=0.00843 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.105 | L2-Norm(final)=17.137 | 5439.5 samples/s | 85.0 steps/s
[Step=62500 Epoch=122.2] | Loss=0.00831 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.105 | L2-Norm(final)=17.142 | 6922.4 samples/s | 108.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=62501 Epoch=122.2] | Loss=0.00497 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=17.193 | 4424.0 samples/s | 69.1 steps/s
[Step=62550 Epoch=122.3] | Loss=0.00790 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.112 | L2-Norm(final)=17.195 | 4456.9 samples/s | 69.6 steps/s
[Step=62600 Epoch=122.4] | Loss=0.00798 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.119 | L2-Norm(final)=17.196 | 4745.7 samples/s | 74.2 steps/s
[Step=62650 Epoch=122.5] | Loss=0.00795 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.126 | L2-Norm(final)=17.198 | 4761.9 samples/s | 74.4 steps/s
[Step=62700 Epoch=122.6] | Loss=0.00760 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.133 | L2-Norm(final)=17.200 | 4734.5 samples/s | 74.0 steps/s
[Step=62750 Epoch=122.7] | Loss=0.00741 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.138 | L2-Norm(final)=17.203 | 4766.8 samples/s | 74.5 steps/s
[Step=62800 Epoch=122.8] | Loss=0.00739 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.143 | L2-Norm(final)=17.205 | 4725.1 samples/s | 73.8 steps/s
[Step=62850 Epoch=122.9] | Loss=0.00750 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.147 | L2-Norm(final)=17.207 | 4775.8 samples/s | 74.6 steps/s
[Step=62900 Epoch=123.0] | Loss=0.00722 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=17.209 | 4775.7 samples/s | 74.6 steps/s
[Step=62950 Epoch=123.1] | Loss=0.00717 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=17.211 | 4804.0 samples/s | 75.1 steps/s
[Step=63000 Epoch=123.2] | Loss=0.00710 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.158 | L2-Norm(final)=17.213 | 5758.2 samples/s | 90.0 steps/s
[Step=63050 Epoch=123.3] | Loss=0.00697 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.161 | L2-Norm(final)=17.215 | 2019.3 samples/s | 31.6 steps/s
[Step=63100 Epoch=123.4] | Loss=0.00681 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.164 | L2-Norm(final)=17.216 | 4799.1 samples/s | 75.0 steps/s
[Step=63150 Epoch=123.5] | Loss=0.00688 | Reg=0.00125 | acc=0.9531 | L2-Norm=11.167 | L2-Norm(final)=17.218 | 4725.0 samples/s | 73.8 steps/s
[Step=63200 Epoch=123.6] | Loss=0.00673 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.170 | L2-Norm(final)=17.220 | 4791.5 samples/s | 74.9 steps/s
[Step=63250 Epoch=123.7] | Loss=0.00669 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.173 | L2-Norm(final)=17.222 | 4836.3 samples/s | 75.6 steps/s
[Step=63300 Epoch=123.7] | Loss=0.00667 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=17.224 | 4766.2 samples/s | 74.5 steps/s
[Step=63350 Epoch=123.8] | Loss=0.00654 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.178 | L2-Norm(final)=17.225 | 4825.7 samples/s | 75.4 steps/s
[Step=63400 Epoch=123.9] | Loss=0.00634 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.181 | L2-Norm(final)=17.227 | 4709.5 samples/s | 73.6 steps/s
[Step=63450 Epoch=124.0] | Loss=0.00628 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.183 | L2-Norm(final)=17.229 | 4767.1 samples/s | 74.5 steps/s
[Step=63500 Epoch=124.1] | Loss=0.00629 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.185 | L2-Norm(final)=17.231 | 5147.2 samples/s | 80.4 steps/s
[Step=63550 Epoch=124.2] | Loss=0.00618 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.187 | L2-Norm(final)=17.232 | 2108.2 samples/s | 32.9 steps/s
[Step=63600 Epoch=124.3] | Loss=0.00617 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.189 | L2-Norm(final)=17.234 | 4823.7 samples/s | 75.4 steps/s
[Step=63650 Epoch=124.4] | Loss=0.00614 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=17.236 | 4779.6 samples/s | 74.7 steps/s
[Step=63700 Epoch=124.5] | Loss=0.00603 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.193 | L2-Norm(final)=17.237 | 4784.0 samples/s | 74.7 steps/s
[Step=63750 Epoch=124.6] | Loss=0.00595 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.195 | L2-Norm(final)=17.239 | 4763.4 samples/s | 74.4 steps/s
[Step=63800 Epoch=124.7] | Loss=0.00588 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.197 | L2-Norm(final)=17.240 | 4790.1 samples/s | 74.8 steps/s
[Step=63850 Epoch=124.8] | Loss=0.00584 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.199 | L2-Norm(final)=17.242 | 4787.6 samples/s | 74.8 steps/s
[Step=63900 Epoch=124.9] | Loss=0.00581 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.201 | L2-Norm(final)=17.243 | 4747.8 samples/s | 74.2 steps/s
[Step=63950 Epoch=125.0] | Loss=0.00576 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.202 | L2-Norm(final)=17.245 | 4750.4 samples/s | 74.2 steps/s
[Step=64000 Epoch=125.1] | Loss=0.00572 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.204 | L2-Norm(final)=17.246 | 4819.6 samples/s | 75.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step64000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=62001 Epoch=237.6] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=17.692 | 4713.6 samples/s | 73.7 steps/s
[Step=62050 Epoch=237.8] | Loss=0.00006 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.103 | L2-Norm(final)=17.696 | 4540.6 samples/s | 70.9 steps/s
[Step=62100 Epoch=237.9] | Loss=0.00005 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=17.705 | 5029.0 samples/s | 78.6 steps/s
[Step=62150 Epoch=238.1] | Loss=0.00004 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=17.710 | 5140.4 samples/s | 80.3 steps/s
[Step=62200 Epoch=238.3] | Loss=0.00004 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=17.716 | 5182.6 samples/s | 81.0 steps/s
[Step=62250 Epoch=238.5] | Loss=0.00004 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=17.720 | 6626.5 samples/s | 103.5 steps/s
[Step=62300 Epoch=238.7] | Loss=0.00004 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=17.725 | 2067.8 samples/s | 32.3 steps/s
[Step=62350 Epoch=238.9] | Loss=0.00004 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=17.730 | 5209.2 samples/s | 81.4 steps/s
[Step=62400 Epoch=239.1] | Loss=0.00004 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=17.734 | 5009.3 samples/s | 78.3 steps/s
[Step=62450 Epoch=239.3] | Loss=0.00004 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=17.738 | 5300.1 samples/s | 82.8 steps/s
[Step=62500 Epoch=239.5] | Loss=0.00003 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=17.742 | 5664.0 samples/s | 88.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=62501 Epoch=239.5] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=17.783 | 4254.5 samples/s | 66.5 steps/s
[Step=62550 Epoch=239.7] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=17.785 | 4502.1 samples/s | 70.3 steps/s
[Step=62600 Epoch=239.9] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.085 | L2-Norm(final)=17.786 | 4608.2 samples/s | 72.0 steps/s
[Step=62650 Epoch=240.1] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.075 | L2-Norm(final)=17.787 | 4490.1 samples/s | 70.2 steps/s
[Step=62700 Epoch=240.2] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.066 | L2-Norm(final)=17.788 | 4505.9 samples/s | 70.4 steps/s
[Step=62750 Epoch=240.4] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.056 | L2-Norm(final)=17.789 | 5752.7 samples/s | 89.9 steps/s
[Step=62800 Epoch=240.6] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.046 | L2-Norm(final)=17.790 | 1919.2 samples/s | 30.0 steps/s
[Step=62850 Epoch=240.8] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.036 | L2-Norm(final)=17.790 | 4495.3 samples/s | 70.2 steps/s
[Step=62900 Epoch=241.0] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.026 | L2-Norm(final)=17.791 | 4502.6 samples/s | 70.4 steps/s
[Step=62950 Epoch=241.2] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.015 | L2-Norm(final)=17.791 | 4466.3 samples/s | 69.8 steps/s
[Step=63000 Epoch=241.4] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.005 | L2-Norm(final)=17.792 | 4998.6 samples/s | 78.1 steps/s
[Step=63050 Epoch=241.6] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.994 | L2-Norm(final)=17.792 | 2069.7 samples/s | 32.3 steps/s
[Step=63100 Epoch=241.8] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.984 | L2-Norm(final)=17.793 | 4668.8 samples/s | 72.9 steps/s
[Step=63150 Epoch=242.0] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.973 | L2-Norm(final)=17.793 | 4595.1 samples/s | 71.8 steps/s
[Step=63200 Epoch=242.2] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.962 | L2-Norm(final)=17.793 | 4519.0 samples/s | 70.6 steps/s
[Step=63250 Epoch=242.4] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.952 | L2-Norm(final)=17.794 | 4549.1 samples/s | 71.1 steps/s
[Step=63300 Epoch=242.5] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.941 | L2-Norm(final)=17.794 | 2155.2 samples/s | 33.7 steps/s
[Step=63350 Epoch=242.7] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.930 | L2-Norm(final)=17.795 | 4746.4 samples/s | 74.2 steps/s
[Step=63400 Epoch=242.9] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.919 | L2-Norm(final)=17.795 | 4629.0 samples/s | 72.3 steps/s
[Step=63450 Epoch=243.1] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.908 | L2-Norm(final)=17.796 | 4551.3 samples/s | 71.1 steps/s
[Step=63500 Epoch=243.3] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.896 | L2-Norm(final)=17.796 | 4546.7 samples/s | 71.0 steps/s
[Step=63550 Epoch=243.5] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.885 | L2-Norm(final)=17.796 | 2141.1 samples/s | 33.5 steps/s
[Step=63600 Epoch=243.7] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.874 | L2-Norm(final)=17.797 | 4461.5 samples/s | 69.7 steps/s
[Step=63650 Epoch=243.9] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.862 | L2-Norm(final)=17.797 | 4484.2 samples/s | 70.1 steps/s
[Step=63700 Epoch=244.1] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.851 | L2-Norm(final)=17.798 | 4490.6 samples/s | 70.2 steps/s
[Step=63750 Epoch=244.3] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.839 | L2-Norm(final)=17.798 | 4502.9 samples/s | 70.4 steps/s
[Step=63800 Epoch=244.5] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.827 | L2-Norm(final)=17.799 | 6142.9 samples/s | 96.0 steps/s
[Step=63850 Epoch=244.7] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.815 | L2-Norm(final)=17.799 | 1847.2 samples/s | 28.9 steps/s
[Step=63900 Epoch=244.8] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.803 | L2-Norm(final)=17.800 | 4347.8 samples/s | 67.9 steps/s
[Step=63950 Epoch=245.0] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.791 | L2-Norm(final)=17.800 | 4462.9 samples/s | 69.7 steps/s
[Step=64000 Epoch=245.2] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.779 | L2-Norm(final)=17.801 | 4517.8 samples/s | 70.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step64000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=62001 Epoch=238.7] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=17.739 | 4022.9 samples/s | 62.9 steps/s
[Step=62050 Epoch=238.9] | Loss=0.00003 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=17.744 | 4881.3 samples/s | 76.3 steps/s
[Step=62100 Epoch=239.0] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=17.750 | 5246.3 samples/s | 82.0 steps/s
[Step=62150 Epoch=239.2] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=17.755 | 5280.1 samples/s | 82.5 steps/s
[Step=62200 Epoch=239.4] | Loss=0.00003 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=17.760 | 5241.1 samples/s | 81.9 steps/s
[Step=62250 Epoch=239.6] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=17.765 | 6989.5 samples/s | 109.2 steps/s
[Step=62300 Epoch=239.8] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=17.770 | 2027.6 samples/s | 31.7 steps/s
[Step=62350 Epoch=240.0] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=17.775 | 5179.6 samples/s | 80.9 steps/s
[Step=62400 Epoch=240.2] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=17.780 | 5156.7 samples/s | 80.6 steps/s
[Step=62450 Epoch=240.4] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=17.785 | 5088.6 samples/s | 79.5 steps/s
[Step=62500 Epoch=240.6] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=17.790 | 5942.5 samples/s | 92.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=62501 Epoch=240.6] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=17.838 | 4017.4 samples/s | 62.8 steps/s
[Step=62550 Epoch=240.8] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.096 | L2-Norm(final)=17.841 | 4527.5 samples/s | 70.7 steps/s
[Step=62600 Epoch=241.0] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.087 | L2-Norm(final)=17.843 | 4565.8 samples/s | 71.3 steps/s
[Step=62650 Epoch=241.2] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.075 | L2-Norm(final)=17.844 | 4643.4 samples/s | 72.6 steps/s
[Step=62700 Epoch=241.4] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.064 | L2-Norm(final)=17.845 | 4670.2 samples/s | 73.0 steps/s
[Step=62750 Epoch=241.5] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.052 | L2-Norm(final)=17.846 | 5928.6 samples/s | 92.6 steps/s
[Step=62800 Epoch=241.7] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.041 | L2-Norm(final)=17.847 | 1928.5 samples/s | 30.1 steps/s
[Step=62850 Epoch=241.9] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.029 | L2-Norm(final)=17.848 | 4440.3 samples/s | 69.4 steps/s
[Step=62900 Epoch=242.1] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=17.849 | 4430.3 samples/s | 69.2 steps/s
[Step=62950 Epoch=242.3] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.004 | L2-Norm(final)=17.849 | 4514.1 samples/s | 70.5 steps/s
[Step=63000 Epoch=242.5] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.992 | L2-Norm(final)=17.850 | 5114.1 samples/s | 79.9 steps/s
[Step=63050 Epoch=242.7] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.980 | L2-Norm(final)=17.851 | 2074.2 samples/s | 32.4 steps/s
[Step=63100 Epoch=242.9] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.967 | L2-Norm(final)=17.851 | 4648.8 samples/s | 72.6 steps/s
[Step=63150 Epoch=243.1] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=17.852 | 4602.3 samples/s | 71.9 steps/s
[Step=63200 Epoch=243.3] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.942 | L2-Norm(final)=17.852 | 4636.7 samples/s | 72.4 steps/s
[Step=63250 Epoch=243.5] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.930 | L2-Norm(final)=17.853 | 4725.0 samples/s | 73.8 steps/s
[Step=63300 Epoch=243.7] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.917 | L2-Norm(final)=17.854 | 2105.1 samples/s | 32.9 steps/s
[Step=63350 Epoch=243.9] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.904 | L2-Norm(final)=17.854 | 4701.4 samples/s | 73.5 steps/s
[Step=63400 Epoch=244.1] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.891 | L2-Norm(final)=17.855 | 4562.5 samples/s | 71.3 steps/s
[Step=63450 Epoch=244.2] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.878 | L2-Norm(final)=17.856 | 4600.4 samples/s | 71.9 steps/s
[Step=63500 Epoch=244.4] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.865 | L2-Norm(final)=17.856 | 4634.7 samples/s | 72.4 steps/s
[Step=63550 Epoch=244.6] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.851 | L2-Norm(final)=17.857 | 2161.7 samples/s | 33.8 steps/s
[Step=63600 Epoch=244.8] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.838 | L2-Norm(final)=17.858 | 4633.3 samples/s | 72.4 steps/s
[Step=63650 Epoch=245.0] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.824 | L2-Norm(final)=17.859 | 4698.7 samples/s | 73.4 steps/s
[Step=63700 Epoch=245.2] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.811 | L2-Norm(final)=17.859 | 4435.5 samples/s | 69.3 steps/s
[Step=63750 Epoch=245.4] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.797 | L2-Norm(final)=17.860 | 4506.5 samples/s | 70.4 steps/s
[Step=63800 Epoch=245.6] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.783 | L2-Norm(final)=17.861 | 6638.6 samples/s | 103.7 steps/s
[Step=63850 Epoch=245.8] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.769 | L2-Norm(final)=17.862 | 1854.5 samples/s | 29.0 steps/s
[Step=63900 Epoch=246.0] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.755 | L2-Norm(final)=17.862 | 4518.2 samples/s | 70.6 steps/s
[Step=63950 Epoch=246.2] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.741 | L2-Norm(final)=17.863 | 4485.2 samples/s | 70.1 steps/s
[Step=64000 Epoch=246.4] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.727 | L2-Norm(final)=17.864 | 4458.3 samples/s | 69.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step64000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08255 | acc=0.9703 | tpr=0.9813 | fpr=0.0535 | 4481.6 samples/s | 17.5 steps/s
Avg test loss: 0.08172, Avg test acc: 0.97071, Avg tpr: 0.98193, Avg fpr: 0.05397, total FA: 421

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07560 | acc=0.9718 | tpr=0.9773 | fpr=0.0401 | 4438.4 samples/s | 17.3 steps/s
Avg test loss: 0.07531, Avg test acc: 0.97183, Avg tpr: 0.97814, Avg fpr: 0.04205, total FA: 328

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.58070 | acc=0.3147 | tpr=0.0136 | fpr=0.0315 | 4529.3 samples/s | 17.7 steps/s
Avg test loss: 5.59847, Avg test acc: 0.31184, Avg tpr: 0.01352, Avg fpr: 0.03205, total FA: 250

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.60780 | acc=0.3070 | tpr=0.0161 | fpr=0.0614 | 4424.0 samples/s | 17.3 steps/s
Avg test loss: 5.62248, Avg test acc: 0.30327, Avg tpr: 0.01585, Avg fpr: 0.06461, total FA: 504

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.62050 | acc=0.1056 | tpr=0.7655 | fpr=0.9062 | 4383.5 samples/s | 17.1 steps/s
[Step= 100] | Loss=7.59454 | acc=0.1059 | tpr=0.7591 | fpr=0.9063 | 8688.9 samples/s | 33.9 steps/s
[Step= 150] | Loss=7.60871 | acc=0.1053 | tpr=0.7637 | fpr=0.9068 | 8107.0 samples/s | 31.7 steps/s
[Step= 200] | Loss=7.60920 | acc=0.1055 | tpr=0.7552 | fpr=0.9063 | 8577.3 samples/s | 33.5 steps/s
[Step= 250] | Loss=7.62267 | acc=0.1050 | tpr=0.7590 | fpr=0.9069 | 8465.8 samples/s | 33.1 steps/s
[Step= 300] | Loss=7.61722 | acc=0.1045 | tpr=0.7571 | fpr=0.9074 | 8051.1 samples/s | 31.4 steps/s
[Step= 350] | Loss=7.61777 | acc=0.1039 | tpr=0.7570 | fpr=0.9079 | 8276.0 samples/s | 32.3 steps/s
[Step= 400] | Loss=7.62501 | acc=0.1039 | tpr=0.7571 | fpr=0.9080 | 8675.1 samples/s | 33.9 steps/s
[Step= 450] | Loss=7.62882 | acc=0.1040 | tpr=0.7610 | fpr=0.9080 | 8243.1 samples/s | 32.2 steps/s
[Step= 500] | Loss=7.62885 | acc=0.1037 | tpr=0.7604 | fpr=0.9081 | 8232.7 samples/s | 32.2 steps/s
[Step= 550] | Loss=7.63441 | acc=0.1037 | tpr=0.7581 | fpr=0.9082 | 15550.0 samples/s | 60.7 steps/s
Avg test loss: 7.63446, Avg test acc: 0.10363, Avg tpr: 0.75832, Avg fpr: 0.90827, total FA: 126112

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.60119 | acc=0.1305 | tpr=0.7080 | fpr=0.8799 | 4550.4 samples/s | 17.8 steps/s
[Step= 100] | Loss=6.58101 | acc=0.1298 | tpr=0.7143 | fpr=0.8811 | 8433.8 samples/s | 32.9 steps/s
[Step= 150] | Loss=6.59288 | acc=0.1289 | tpr=0.7133 | fpr=0.8818 | 8415.9 samples/s | 32.9 steps/s
[Step= 200] | Loss=6.58805 | acc=0.1289 | tpr=0.7049 | fpr=0.8816 | 8269.9 samples/s | 32.3 steps/s
[Step= 250] | Loss=6.60105 | acc=0.1286 | tpr=0.7092 | fpr=0.8819 | 8660.5 samples/s | 33.8 steps/s
[Step= 300] | Loss=6.59586 | acc=0.1282 | tpr=0.7076 | fpr=0.8823 | 7869.2 samples/s | 30.7 steps/s
[Step= 350] | Loss=6.59334 | acc=0.1278 | tpr=0.7044 | fpr=0.8827 | 8389.2 samples/s | 32.8 steps/s
[Step= 400] | Loss=6.60042 | acc=0.1279 | tpr=0.7035 | fpr=0.8825 | 8799.4 samples/s | 34.4 steps/s
[Step= 450] | Loss=6.60199 | acc=0.1277 | tpr=0.7040 | fpr=0.8828 | 8569.0 samples/s | 33.5 steps/s
[Step= 500] | Loss=6.60155 | acc=0.1275 | tpr=0.7035 | fpr=0.8829 | 8072.9 samples/s | 31.5 steps/s
[Step= 550] | Loss=6.60637 | acc=0.1275 | tpr=0.6984 | fpr=0.8829 | 15112.5 samples/s | 59.0 steps/s
Avg test loss: 6.60630, Avg test acc: 0.12737, Avg tpr: 0.69810, Avg fpr: 0.88301, total FA: 122604

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11722 | acc=0.9824 | tpr=0.9336 | fpr=0.0167 | 4382.9 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.12434 | acc=0.9823 | tpr=0.9531 | fpr=0.0172 | 8627.0 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.12786 | acc=0.9814 | tpr=0.9582 | fpr=0.0182 | 8192.5 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.12794 | acc=0.9816 | tpr=0.9596 | fpr=0.0180 | 8574.1 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.12670 | acc=0.9818 | tpr=0.9581 | fpr=0.0178 | 8034.7 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.12749 | acc=0.9818 | tpr=0.9600 | fpr=0.0178 | 8420.5 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.12890 | acc=0.9816 | tpr=0.9599 | fpr=0.0180 | 8607.0 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.13090 | acc=0.9815 | tpr=0.9590 | fpr=0.0181 | 8519.0 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.13348 | acc=0.9812 | tpr=0.9581 | fpr=0.0184 | 8157.2 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.13323 | acc=0.9812 | tpr=0.9577 | fpr=0.0184 | 8558.2 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.13242 | acc=0.9813 | tpr=0.9538 | fpr=0.0182 | 14540.9 samples/s | 56.8 steps/s
Avg test loss: 0.13208, Avg test acc: 0.98130, Avg tpr: 0.95404, Avg fpr: 0.01821, total FA: 2528

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12919 | acc=0.9815 | tpr=0.9425 | fpr=0.0178 | 4486.1 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.13661 | acc=0.9811 | tpr=0.9595 | fpr=0.0185 | 8357.6 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.14123 | acc=0.9802 | tpr=0.9654 | fpr=0.0195 | 8279.7 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.14166 | acc=0.9802 | tpr=0.9661 | fpr=0.0195 | 8801.7 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.14048 | acc=0.9805 | tpr=0.9651 | fpr=0.0192 | 8354.9 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.14132 | acc=0.9805 | tpr=0.9665 | fpr=0.0193 | 8576.1 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.14293 | acc=0.9802 | tpr=0.9681 | fpr=0.0196 | 8371.0 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.14508 | acc=0.9801 | tpr=0.9677 | fpr=0.0197 | 8762.4 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.14794 | acc=0.9798 | tpr=0.9664 | fpr=0.0200 | 8258.5 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.14761 | acc=0.9798 | tpr=0.9656 | fpr=0.0200 | 8408.6 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.14669 | acc=0.9799 | tpr=0.9630 | fpr=0.0198 | 15077.2 samples/s | 58.9 steps/s
Avg test loss: 0.14639, Avg test acc: 0.97992, Avg tpr: 0.96315, Avg fpr: 0.01978, total FA: 2746

server round 32/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=64001 Epoch=124.8] | Loss=0.00400 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.760 | L2-Norm(final)=16.903 | 4034.5 samples/s | 63.0 steps/s
[Step=64050 Epoch=124.9] | Loss=0.00722 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.761 | L2-Norm(final)=16.907 | 5140.4 samples/s | 80.3 steps/s
[Step=64100 Epoch=125.0] | Loss=0.00787 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.761 | L2-Norm(final)=16.912 | 5506.8 samples/s | 86.0 steps/s
[Step=64150 Epoch=125.1] | Loss=0.00764 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.761 | L2-Norm(final)=16.917 | 5478.1 samples/s | 85.6 steps/s
[Step=64200 Epoch=125.2] | Loss=0.00729 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.761 | L2-Norm(final)=16.923 | 5434.1 samples/s | 84.9 steps/s
[Step=64250 Epoch=125.3] | Loss=0.00750 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.761 | L2-Norm(final)=16.928 | 5599.0 samples/s | 87.5 steps/s
[Step=64300 Epoch=125.4] | Loss=0.00804 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.761 | L2-Norm(final)=16.932 | 5318.9 samples/s | 83.1 steps/s
[Step=64350 Epoch=125.5] | Loss=0.00807 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.761 | L2-Norm(final)=16.936 | 5535.2 samples/s | 86.5 steps/s
[Step=64400 Epoch=125.6] | Loss=0.00786 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.761 | L2-Norm(final)=16.941 | 5412.1 samples/s | 84.6 steps/s
[Step=64450 Epoch=125.7] | Loss=0.00797 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.761 | L2-Norm(final)=16.945 | 5485.8 samples/s | 85.7 steps/s
[Step=64500 Epoch=125.8] | Loss=0.00787 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.761 | L2-Norm(final)=16.949 | 6896.9 samples/s | 107.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=64501 Epoch=125.8] | Loss=0.00282 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.761 | L2-Norm(final)=16.988 | 4081.7 samples/s | 63.8 steps/s
[Step=64550 Epoch=125.9] | Loss=0.00938 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.768 | L2-Norm(final)=16.990 | 4509.6 samples/s | 70.5 steps/s
[Step=64600 Epoch=126.0] | Loss=0.00897 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.779 | L2-Norm(final)=16.992 | 4701.3 samples/s | 73.5 steps/s
[Step=64650 Epoch=126.1] | Loss=0.00880 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.788 | L2-Norm(final)=16.995 | 4769.7 samples/s | 74.5 steps/s
[Step=64700 Epoch=126.2] | Loss=0.00865 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.794 | L2-Norm(final)=16.997 | 4765.5 samples/s | 74.5 steps/s
[Step=64750 Epoch=126.3] | Loss=0.00830 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.799 | L2-Norm(final)=16.999 | 4785.2 samples/s | 74.8 steps/s
[Step=64800 Epoch=126.4] | Loss=0.00803 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.804 | L2-Norm(final)=17.002 | 4785.1 samples/s | 74.8 steps/s
[Step=64850 Epoch=126.5] | Loss=0.00798 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.809 | L2-Norm(final)=17.006 | 4727.1 samples/s | 73.9 steps/s
[Step=64900 Epoch=126.6] | Loss=0.00795 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.814 | L2-Norm(final)=17.008 | 4736.2 samples/s | 74.0 steps/s
[Step=64950 Epoch=126.7] | Loss=0.00786 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.818 | L2-Norm(final)=17.010 | 4797.6 samples/s | 75.0 steps/s
[Step=65000 Epoch=126.8] | Loss=0.00790 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.822 | L2-Norm(final)=17.012 | 5814.6 samples/s | 90.9 steps/s
[Step=65050 Epoch=126.9] | Loss=0.00763 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.826 | L2-Norm(final)=17.015 | 1996.6 samples/s | 31.2 steps/s
[Step=65100 Epoch=127.0] | Loss=0.00746 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.829 | L2-Norm(final)=17.017 | 4807.6 samples/s | 75.1 steps/s
[Step=65150 Epoch=127.1] | Loss=0.00719 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.833 | L2-Norm(final)=17.020 | 4606.8 samples/s | 72.0 steps/s
[Step=65200 Epoch=127.2] | Loss=0.00694 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.836 | L2-Norm(final)=17.022 | 4683.7 samples/s | 73.2 steps/s
[Step=65250 Epoch=127.3] | Loss=0.00695 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.839 | L2-Norm(final)=17.025 | 4710.3 samples/s | 73.6 steps/s
[Step=65300 Epoch=127.4] | Loss=0.00691 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.842 | L2-Norm(final)=17.027 | 4706.1 samples/s | 73.5 steps/s
[Step=65350 Epoch=127.5] | Loss=0.00679 | Reg=0.00118 | acc=0.9688 | L2-Norm=10.845 | L2-Norm(final)=17.029 | 4758.6 samples/s | 74.4 steps/s
[Step=65400 Epoch=127.6] | Loss=0.00684 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.847 | L2-Norm(final)=17.031 | 4736.6 samples/s | 74.0 steps/s
[Step=65450 Epoch=127.7] | Loss=0.00694 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.850 | L2-Norm(final)=17.033 | 4769.2 samples/s | 74.5 steps/s
[Step=65500 Epoch=127.8] | Loss=0.00695 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.852 | L2-Norm(final)=17.035 | 5008.8 samples/s | 78.3 steps/s
[Step=65550 Epoch=127.8] | Loss=0.00691 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.855 | L2-Norm(final)=17.037 | 2072.0 samples/s | 32.4 steps/s
[Step=65600 Epoch=127.9] | Loss=0.00677 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=17.039 | 4781.7 samples/s | 74.7 steps/s
[Step=65650 Epoch=128.0] | Loss=0.00679 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.860 | L2-Norm(final)=17.041 | 4754.3 samples/s | 74.3 steps/s
[Step=65700 Epoch=128.1] | Loss=0.00671 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.862 | L2-Norm(final)=17.043 | 4817.5 samples/s | 75.3 steps/s
[Step=65750 Epoch=128.2] | Loss=0.00665 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.864 | L2-Norm(final)=17.045 | 4714.3 samples/s | 73.7 steps/s
[Step=65800 Epoch=128.3] | Loss=0.00659 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.867 | L2-Norm(final)=17.046 | 4826.6 samples/s | 75.4 steps/s
[Step=65850 Epoch=128.4] | Loss=0.00649 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.869 | L2-Norm(final)=17.048 | 4795.5 samples/s | 74.9 steps/s
[Step=65900 Epoch=128.5] | Loss=0.00653 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.871 | L2-Norm(final)=17.050 | 4743.5 samples/s | 74.1 steps/s
[Step=65950 Epoch=128.6] | Loss=0.00652 | Reg=0.00118 | acc=0.9688 | L2-Norm=10.873 | L2-Norm(final)=17.052 | 4750.6 samples/s | 74.2 steps/s
[Step=66000 Epoch=128.7] | Loss=0.00646 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.875 | L2-Norm(final)=17.053 | 4914.5 samples/s | 76.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step66000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=64001 Epoch=125.1] | Loss=0.02606 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.760 | L2-Norm(final)=17.293 | 4434.5 samples/s | 69.3 steps/s
[Step=64050 Epoch=125.2] | Loss=0.00810 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.761 | L2-Norm(final)=17.300 | 5174.7 samples/s | 80.9 steps/s
[Step=64100 Epoch=125.3] | Loss=0.00860 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.761 | L2-Norm(final)=17.308 | 5581.0 samples/s | 87.2 steps/s
[Step=64150 Epoch=125.4] | Loss=0.00888 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.761 | L2-Norm(final)=17.317 | 5572.0 samples/s | 87.1 steps/s
[Step=64200 Epoch=125.5] | Loss=0.00816 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.761 | L2-Norm(final)=17.324 | 5738.1 samples/s | 89.7 steps/s
[Step=64250 Epoch=125.6] | Loss=0.00821 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.761 | L2-Norm(final)=17.332 | 5573.4 samples/s | 87.1 steps/s
[Step=64300 Epoch=125.7] | Loss=0.00837 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.761 | L2-Norm(final)=17.339 | 5590.7 samples/s | 87.4 steps/s
[Step=64350 Epoch=125.8] | Loss=0.00824 | Reg=0.00116 | acc=0.9688 | L2-Norm=10.761 | L2-Norm(final)=17.345 | 5624.0 samples/s | 87.9 steps/s
[Step=64400 Epoch=125.9] | Loss=0.00807 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.761 | L2-Norm(final)=17.351 | 5697.6 samples/s | 89.0 steps/s
[Step=64450 Epoch=126.0] | Loss=0.00803 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.761 | L2-Norm(final)=17.357 | 5631.5 samples/s | 88.0 steps/s
[Step=64500 Epoch=126.1] | Loss=0.00789 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.761 | L2-Norm(final)=17.363 | 7270.3 samples/s | 113.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=64501 Epoch=126.1] | Loss=0.00462 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.761 | L2-Norm(final)=17.421 | 4094.2 samples/s | 64.0 steps/s
[Step=64550 Epoch=126.2] | Loss=0.00815 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.769 | L2-Norm(final)=17.425 | 5037.9 samples/s | 78.7 steps/s
[Step=64600 Epoch=126.3] | Loss=0.00905 | Reg=0.00116 | acc=0.9688 | L2-Norm=10.779 | L2-Norm(final)=17.428 | 4876.5 samples/s | 76.2 steps/s
[Step=64650 Epoch=126.4] | Loss=0.00858 | Reg=0.00116 | acc=0.9688 | L2-Norm=10.787 | L2-Norm(final)=17.430 | 4876.9 samples/s | 76.2 steps/s
[Step=64700 Epoch=126.5] | Loss=0.00866 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.793 | L2-Norm(final)=17.433 | 4784.6 samples/s | 74.8 steps/s
[Step=64750 Epoch=126.6] | Loss=0.00840 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.799 | L2-Norm(final)=17.436 | 4828.8 samples/s | 75.5 steps/s
[Step=64800 Epoch=126.7] | Loss=0.00843 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.805 | L2-Norm(final)=17.438 | 4732.9 samples/s | 74.0 steps/s
[Step=64850 Epoch=126.8] | Loss=0.00828 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.811 | L2-Norm(final)=17.441 | 4791.2 samples/s | 74.9 steps/s
[Step=64900 Epoch=126.9] | Loss=0.00803 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.816 | L2-Norm(final)=17.443 | 4749.3 samples/s | 74.2 steps/s
[Step=64950 Epoch=127.0] | Loss=0.00784 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.820 | L2-Norm(final)=17.446 | 4712.5 samples/s | 73.6 steps/s
[Step=65000 Epoch=127.1] | Loss=0.00773 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.824 | L2-Norm(final)=17.448 | 5922.8 samples/s | 92.5 steps/s
[Step=65050 Epoch=127.2] | Loss=0.00753 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.828 | L2-Norm(final)=17.450 | 2011.5 samples/s | 31.4 steps/s
[Step=65100 Epoch=127.3] | Loss=0.00747 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.832 | L2-Norm(final)=17.453 | 4839.8 samples/s | 75.6 steps/s
[Step=65150 Epoch=127.4] | Loss=0.00727 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.835 | L2-Norm(final)=17.455 | 4757.9 samples/s | 74.3 steps/s
[Step=65200 Epoch=127.5] | Loss=0.00714 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.839 | L2-Norm(final)=17.457 | 4750.3 samples/s | 74.2 steps/s
[Step=65250 Epoch=127.6] | Loss=0.00699 | Reg=0.00118 | acc=0.9688 | L2-Norm=10.842 | L2-Norm(final)=17.460 | 4777.1 samples/s | 74.6 steps/s
[Step=65300 Epoch=127.7] | Loss=0.00690 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.845 | L2-Norm(final)=17.462 | 4777.0 samples/s | 74.6 steps/s
[Step=65350 Epoch=127.8] | Loss=0.00677 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.848 | L2-Norm(final)=17.464 | 4673.2 samples/s | 73.0 steps/s
[Step=65400 Epoch=127.9] | Loss=0.00669 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.851 | L2-Norm(final)=17.466 | 4799.0 samples/s | 75.0 steps/s
[Step=65450 Epoch=128.0] | Loss=0.00666 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.853 | L2-Norm(final)=17.468 | 4739.1 samples/s | 74.0 steps/s
[Step=65500 Epoch=128.1] | Loss=0.00665 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.856 | L2-Norm(final)=17.470 | 5163.6 samples/s | 80.7 steps/s
[Step=65550 Epoch=128.1] | Loss=0.00662 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.858 | L2-Norm(final)=17.472 | 2119.4 samples/s | 33.1 steps/s
[Step=65600 Epoch=128.2] | Loss=0.00653 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.861 | L2-Norm(final)=17.473 | 4879.0 samples/s | 76.2 steps/s
[Step=65650 Epoch=128.3] | Loss=0.00646 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.863 | L2-Norm(final)=17.475 | 4907.0 samples/s | 76.7 steps/s
[Step=65700 Epoch=128.4] | Loss=0.00636 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.866 | L2-Norm(final)=17.477 | 4897.3 samples/s | 76.5 steps/s
[Step=65750 Epoch=128.5] | Loss=0.00627 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.868 | L2-Norm(final)=17.479 | 4878.5 samples/s | 76.2 steps/s
[Step=65800 Epoch=128.6] | Loss=0.00621 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.870 | L2-Norm(final)=17.481 | 4869.1 samples/s | 76.1 steps/s
[Step=65850 Epoch=128.7] | Loss=0.00615 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.872 | L2-Norm(final)=17.483 | 4934.6 samples/s | 77.1 steps/s
[Step=65900 Epoch=128.8] | Loss=0.00613 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.874 | L2-Norm(final)=17.485 | 4859.7 samples/s | 75.9 steps/s
[Step=65950 Epoch=128.9] | Loss=0.00612 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.876 | L2-Norm(final)=17.487 | 4869.8 samples/s | 76.1 steps/s
[Step=66000 Epoch=129.0] | Loss=0.00601 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.878 | L2-Norm(final)=17.489 | 4763.7 samples/s | 74.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step66000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=64001 Epoch=245.2] | Loss=0.00007 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.760 | L2-Norm(final)=17.816 | 4137.2 samples/s | 64.6 steps/s
[Step=64050 Epoch=245.4] | Loss=0.00003 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.756 | L2-Norm(final)=17.822 | 5138.9 samples/s | 80.3 steps/s
[Step=64100 Epoch=245.6] | Loss=0.00003 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.756 | L2-Norm(final)=17.831 | 5329.5 samples/s | 83.3 steps/s
[Step=64150 Epoch=245.8] | Loss=0.00004 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.755 | L2-Norm(final)=17.839 | 5196.3 samples/s | 81.2 steps/s
[Step=64200 Epoch=246.0] | Loss=0.00003 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.755 | L2-Norm(final)=17.847 | 5083.3 samples/s | 79.4 steps/s
[Step=64250 Epoch=246.2] | Loss=0.00003 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.755 | L2-Norm(final)=17.853 | 6807.3 samples/s | 106.4 steps/s
[Step=64300 Epoch=246.4] | Loss=0.00003 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.755 | L2-Norm(final)=17.860 | 2073.6 samples/s | 32.4 steps/s
[Step=64350 Epoch=246.6] | Loss=0.00003 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.755 | L2-Norm(final)=17.866 | 5203.0 samples/s | 81.3 steps/s
[Step=64400 Epoch=246.8] | Loss=0.00003 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.755 | L2-Norm(final)=17.872 | 5216.4 samples/s | 81.5 steps/s
[Step=64450 Epoch=246.9] | Loss=0.00003 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.755 | L2-Norm(final)=17.877 | 5337.0 samples/s | 83.4 steps/s
[Step=64500 Epoch=247.1] | Loss=0.00003 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.755 | L2-Norm(final)=17.882 | 5796.3 samples/s | 90.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=64501 Epoch=247.1] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.755 | L2-Norm(final)=17.935 | 4218.2 samples/s | 65.9 steps/s
[Step=64550 Epoch=247.3] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.743 | L2-Norm(final)=17.937 | 4470.5 samples/s | 69.9 steps/s
[Step=64600 Epoch=247.5] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.724 | L2-Norm(final)=17.938 | 4531.8 samples/s | 70.8 steps/s
[Step=64650 Epoch=247.7] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.702 | L2-Norm(final)=17.939 | 4597.2 samples/s | 71.8 steps/s
[Step=64700 Epoch=247.9] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.682 | L2-Norm(final)=17.939 | 4555.6 samples/s | 71.2 steps/s
[Step=64750 Epoch=248.1] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.661 | L2-Norm(final)=17.940 | 5696.1 samples/s | 89.0 steps/s
[Step=64800 Epoch=248.3] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.640 | L2-Norm(final)=17.940 | 1958.3 samples/s | 30.6 steps/s
[Step=64850 Epoch=248.5] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.619 | L2-Norm(final)=17.941 | 4655.5 samples/s | 72.7 steps/s
[Step=64900 Epoch=248.7] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.597 | L2-Norm(final)=17.941 | 4537.8 samples/s | 70.9 steps/s
[Step=64950 Epoch=248.9] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.576 | L2-Norm(final)=17.942 | 4738.7 samples/s | 74.0 steps/s
[Step=65000 Epoch=249.1] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.554 | L2-Norm(final)=17.942 | 5105.0 samples/s | 79.8 steps/s
[Step=65050 Epoch=249.2] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.532 | L2-Norm(final)=17.942 | 2086.9 samples/s | 32.6 steps/s
[Step=65100 Epoch=249.4] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.510 | L2-Norm(final)=17.943 | 4642.8 samples/s | 72.5 steps/s
[Step=65150 Epoch=249.6] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.488 | L2-Norm(final)=17.943 | 4457.0 samples/s | 69.6 steps/s
[Step=65200 Epoch=249.8] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.466 | L2-Norm(final)=17.944 | 4531.5 samples/s | 70.8 steps/s
[Step=65250 Epoch=250.0] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.444 | L2-Norm(final)=17.944 | 4521.9 samples/s | 70.7 steps/s
[Step=65300 Epoch=250.2] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.422 | L2-Norm(final)=17.945 | 2125.2 samples/s | 33.2 steps/s
[Step=65350 Epoch=250.4] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.400 | L2-Norm(final)=17.945 | 4664.8 samples/s | 72.9 steps/s
[Step=65400 Epoch=250.6] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.377 | L2-Norm(final)=17.946 | 4480.9 samples/s | 70.0 steps/s
[Step=65450 Epoch=250.8] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.355 | L2-Norm(final)=17.947 | 4467.5 samples/s | 69.8 steps/s
[Step=65500 Epoch=251.0] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.332 | L2-Norm(final)=17.947 | 4496.2 samples/s | 70.3 steps/s
[Step=65550 Epoch=251.2] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.309 | L2-Norm(final)=17.948 | 2164.9 samples/s | 33.8 steps/s
[Step=65600 Epoch=251.4] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.286 | L2-Norm(final)=17.949 | 4716.5 samples/s | 73.7 steps/s
[Step=65650 Epoch=251.5] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.263 | L2-Norm(final)=17.949 | 4527.9 samples/s | 70.7 steps/s
[Step=65700 Epoch=251.7] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.240 | L2-Norm(final)=17.950 | 4534.7 samples/s | 70.9 steps/s
[Step=65750 Epoch=251.9] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.217 | L2-Norm(final)=17.951 | 4497.6 samples/s | 70.3 steps/s
[Step=65800 Epoch=252.1] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.193 | L2-Norm(final)=17.951 | 6075.7 samples/s | 94.9 steps/s
[Step=65850 Epoch=252.3] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.170 | L2-Norm(final)=17.952 | 1918.4 samples/s | 30.0 steps/s
[Step=65900 Epoch=252.5] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.146 | L2-Norm(final)=17.953 | 4603.4 samples/s | 71.9 steps/s
[Step=65950 Epoch=252.7] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.122 | L2-Norm(final)=17.954 | 4561.6 samples/s | 71.3 steps/s
[Step=66000 Epoch=252.9] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.098 | L2-Norm(final)=17.955 | 4521.7 samples/s | 70.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step66000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=64001 Epoch=246.4] | Loss=0.00004 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.760 | L2-Norm(final)=17.889 | 4588.4 samples/s | 71.7 steps/s
[Step=64050 Epoch=246.6] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.755 | L2-Norm(final)=17.892 | 4668.8 samples/s | 72.9 steps/s
[Step=64100 Epoch=246.7] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.755 | L2-Norm(final)=17.897 | 5069.1 samples/s | 79.2 steps/s
[Step=64150 Epoch=246.9] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.755 | L2-Norm(final)=17.907 | 5296.4 samples/s | 82.8 steps/s
[Step=64200 Epoch=247.1] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.754 | L2-Norm(final)=17.916 | 4919.3 samples/s | 76.9 steps/s
[Step=64250 Epoch=247.3] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.754 | L2-Norm(final)=17.924 | 6898.5 samples/s | 107.8 steps/s
[Step=64300 Epoch=247.5] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.754 | L2-Norm(final)=17.931 | 2067.9 samples/s | 32.3 steps/s
[Step=64350 Epoch=247.7] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.754 | L2-Norm(final)=17.939 | 5134.1 samples/s | 80.2 steps/s
[Step=64400 Epoch=247.9] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.754 | L2-Norm(final)=17.946 | 5068.2 samples/s | 79.2 steps/s
[Step=64450 Epoch=248.1] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.754 | L2-Norm(final)=17.952 | 5231.4 samples/s | 81.7 steps/s
[Step=64500 Epoch=248.3] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.754 | L2-Norm(final)=17.958 | 6030.9 samples/s | 94.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=64501 Epoch=248.3] | Loss=0.00005 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.754 | L2-Norm(final)=18.015 | 4330.5 samples/s | 67.7 steps/s
[Step=64550 Epoch=248.5] | Loss=0.00005 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.748 | L2-Norm(final)=18.019 | 4243.1 samples/s | 66.3 steps/s
[Step=64600 Epoch=248.7] | Loss=0.00005 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.749 | L2-Norm(final)=18.022 | 4476.0 samples/s | 69.9 steps/s
[Step=64650 Epoch=248.9] | Loss=0.00005 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.746 | L2-Norm(final)=18.024 | 4431.0 samples/s | 69.2 steps/s
[Step=64700 Epoch=249.1] | Loss=0.00007 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.741 | L2-Norm(final)=18.025 | 4551.2 samples/s | 71.1 steps/s
[Step=64750 Epoch=249.2] | Loss=0.00027 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.741 | L2-Norm(final)=18.025 | 5690.4 samples/s | 88.9 steps/s
[Step=64800 Epoch=249.4] | Loss=0.00029 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.741 | L2-Norm(final)=18.024 | 1961.8 samples/s | 30.7 steps/s
[Step=64850 Epoch=249.6] | Loss=0.00025 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.742 | L2-Norm(final)=18.024 | 4614.0 samples/s | 72.1 steps/s
[Step=64900 Epoch=249.8] | Loss=0.00022 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.742 | L2-Norm(final)=18.024 | 4502.1 samples/s | 70.3 steps/s
[Step=64950 Epoch=250.0] | Loss=0.00019 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.741 | L2-Norm(final)=18.024 | 4534.5 samples/s | 70.9 steps/s
[Step=65000 Epoch=250.2] | Loss=0.00017 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.740 | L2-Norm(final)=18.024 | 5080.0 samples/s | 79.4 steps/s
[Step=65050 Epoch=250.4] | Loss=0.00016 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.738 | L2-Norm(final)=18.024 | 2016.7 samples/s | 31.5 steps/s
[Step=65100 Epoch=250.6] | Loss=0.00014 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.736 | L2-Norm(final)=18.024 | 4580.0 samples/s | 71.6 steps/s
[Step=65150 Epoch=250.8] | Loss=0.00013 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.734 | L2-Norm(final)=18.024 | 4510.7 samples/s | 70.5 steps/s
[Step=65200 Epoch=251.0] | Loss=0.00012 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.732 | L2-Norm(final)=18.024 | 4424.4 samples/s | 69.1 steps/s
[Step=65250 Epoch=251.2] | Loss=0.00012 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.730 | L2-Norm(final)=18.024 | 4569.8 samples/s | 71.4 steps/s
[Step=65300 Epoch=251.4] | Loss=0.00011 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.727 | L2-Norm(final)=18.024 | 2142.6 samples/s | 33.5 steps/s
[Step=65350 Epoch=251.6] | Loss=0.00010 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.724 | L2-Norm(final)=18.024 | 4627.6 samples/s | 72.3 steps/s
[Step=65400 Epoch=251.8] | Loss=0.00010 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.722 | L2-Norm(final)=18.024 | 4691.3 samples/s | 73.3 steps/s
[Step=65450 Epoch=251.9] | Loss=0.00009 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.719 | L2-Norm(final)=18.024 | 4696.7 samples/s | 73.4 steps/s
[Step=65500 Epoch=252.1] | Loss=0.00009 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.716 | L2-Norm(final)=18.024 | 4425.4 samples/s | 69.1 steps/s
[Step=65550 Epoch=252.3] | Loss=0.00008 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.713 | L2-Norm(final)=18.024 | 2128.7 samples/s | 33.3 steps/s
[Step=65600 Epoch=252.5] | Loss=0.00008 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.710 | L2-Norm(final)=18.024 | 4823.0 samples/s | 75.4 steps/s
[Step=65650 Epoch=252.7] | Loss=0.00008 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.707 | L2-Norm(final)=18.025 | 4649.1 samples/s | 72.6 steps/s
[Step=65700 Epoch=252.9] | Loss=0.00007 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.704 | L2-Norm(final)=18.025 | 4573.3 samples/s | 71.5 steps/s
[Step=65750 Epoch=253.1] | Loss=0.00007 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.700 | L2-Norm(final)=18.025 | 4652.1 samples/s | 72.7 steps/s
[Step=65800 Epoch=253.3] | Loss=0.00007 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.697 | L2-Norm(final)=18.025 | 6764.6 samples/s | 105.7 steps/s
[Step=65850 Epoch=253.5] | Loss=0.00006 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.694 | L2-Norm(final)=18.025 | 1888.2 samples/s | 29.5 steps/s
[Step=65900 Epoch=253.7] | Loss=0.00006 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.691 | L2-Norm(final)=18.025 | 4475.0 samples/s | 69.9 steps/s
[Step=65950 Epoch=253.9] | Loss=0.00006 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.687 | L2-Norm(final)=18.025 | 4560.0 samples/s | 71.3 steps/s
[Step=66000 Epoch=254.1] | Loss=0.00006 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.684 | L2-Norm(final)=18.025 | 4631.6 samples/s | 72.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step66000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06945 | acc=0.9705 | tpr=0.9749 | fpr=0.0391 | 4413.6 samples/s | 17.2 steps/s
Avg test loss: 0.07070, Avg test acc: 0.97011, Avg tpr: 0.97488, Avg fpr: 0.04038, total FA: 315

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07149 | acc=0.9711 | tpr=0.9772 | fpr=0.0421 | 4401.6 samples/s | 17.2 steps/s
Avg test loss: 0.07232, Avg test acc: 0.97151, Avg tpr: 0.97808, Avg fpr: 0.04294, total FA: 335

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.54479 | acc=0.3146 | tpr=0.0097 | fpr=0.0233 | 4390.2 samples/s | 17.1 steps/s
Avg test loss: 5.56406, Avg test acc: 0.31160, Avg tpr: 0.01008, Avg fpr: 0.02525, total FA: 197

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.28326 | acc=0.3155 | tpr=0.0144 | fpr=0.0305 | 4424.9 samples/s | 17.3 steps/s
Avg test loss: 7.29812, Avg test acc: 0.31228, Avg tpr: 0.01399, Avg fpr: 0.03166, total FA: 247

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.96326 | acc=0.1271 | tpr=0.6814 | fpr=0.8829 | 4456.8 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.94448 | acc=0.1270 | tpr=0.6823 | fpr=0.8834 | 8477.0 samples/s | 33.1 steps/s
[Step= 150] | Loss=5.95907 | acc=0.1277 | tpr=0.6844 | fpr=0.8826 | 8212.6 samples/s | 32.1 steps/s
[Step= 200] | Loss=5.95936 | acc=0.1269 | tpr=0.6754 | fpr=0.8831 | 8372.2 samples/s | 32.7 steps/s
[Step= 250] | Loss=5.97244 | acc=0.1264 | tpr=0.6803 | fpr=0.8837 | 8185.3 samples/s | 32.0 steps/s
[Step= 300] | Loss=5.96817 | acc=0.1261 | tpr=0.6793 | fpr=0.8839 | 8285.1 samples/s | 32.4 steps/s
[Step= 350] | Loss=5.96785 | acc=0.1257 | tpr=0.6788 | fpr=0.8843 | 8451.5 samples/s | 33.0 steps/s
[Step= 400] | Loss=5.97485 | acc=0.1256 | tpr=0.6800 | fpr=0.8845 | 8369.2 samples/s | 32.7 steps/s
[Step= 450] | Loss=5.97728 | acc=0.1258 | tpr=0.6835 | fpr=0.8843 | 8497.1 samples/s | 33.2 steps/s
[Step= 500] | Loss=5.97643 | acc=0.1259 | tpr=0.6855 | fpr=0.8843 | 8465.6 samples/s | 33.1 steps/s
[Step= 550] | Loss=5.98127 | acc=0.1257 | tpr=0.6809 | fpr=0.8844 | 14034.3 samples/s | 54.8 steps/s
Avg test loss: 5.98134, Avg test acc: 0.12552, Avg tpr: 0.68067, Avg fpr: 0.88457, total FA: 122821

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.42622 | acc=0.1278 | tpr=0.6991 | fpr=0.8825 | 4375.5 samples/s | 17.1 steps/s
[Step= 100] | Loss=6.40681 | acc=0.1280 | tpr=0.7036 | fpr=0.8828 | 8344.1 samples/s | 32.6 steps/s
[Step= 150] | Loss=6.41679 | acc=0.1274 | tpr=0.7032 | fpr=0.8832 | 8270.2 samples/s | 32.3 steps/s
[Step= 200] | Loss=6.41290 | acc=0.1273 | tpr=0.6940 | fpr=0.8830 | 8698.3 samples/s | 34.0 steps/s
[Step= 250] | Loss=6.42552 | acc=0.1270 | tpr=0.6952 | fpr=0.8834 | 8442.1 samples/s | 33.0 steps/s
[Step= 300] | Loss=6.42050 | acc=0.1264 | tpr=0.6945 | fpr=0.8839 | 8239.8 samples/s | 32.2 steps/s
[Step= 350] | Loss=6.41898 | acc=0.1257 | tpr=0.6932 | fpr=0.8845 | 8501.0 samples/s | 33.2 steps/s
[Step= 400] | Loss=6.42481 | acc=0.1258 | tpr=0.6920 | fpr=0.8845 | 8194.2 samples/s | 32.0 steps/s
[Step= 450] | Loss=6.42621 | acc=0.1256 | tpr=0.6938 | fpr=0.8847 | 8369.5 samples/s | 32.7 steps/s
[Step= 500] | Loss=6.42540 | acc=0.1255 | tpr=0.6938 | fpr=0.8848 | 8374.8 samples/s | 32.7 steps/s
[Step= 550] | Loss=6.43003 | acc=0.1254 | tpr=0.6884 | fpr=0.8848 | 14393.9 samples/s | 56.2 steps/s
Avg test loss: 6.42988, Avg test acc: 0.12532, Avg tpr: 0.68819, Avg fpr: 0.88491, total FA: 122868

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11102 | acc=0.9821 | tpr=0.9336 | fpr=0.0170 | 4472.2 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.11763 | acc=0.9817 | tpr=0.9510 | fpr=0.0177 | 8420.7 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.12134 | acc=0.9809 | tpr=0.9553 | fpr=0.0186 | 8583.1 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.12188 | acc=0.9811 | tpr=0.9585 | fpr=0.0185 | 8689.7 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.12067 | acc=0.9812 | tpr=0.9581 | fpr=0.0183 | 8397.0 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.12153 | acc=0.9812 | tpr=0.9593 | fpr=0.0183 | 8284.0 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.12283 | acc=0.9811 | tpr=0.9599 | fpr=0.0185 | 8569.4 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.12462 | acc=0.9810 | tpr=0.9595 | fpr=0.0186 | 8265.0 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.12716 | acc=0.9807 | tpr=0.9581 | fpr=0.0189 | 8486.2 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.12679 | acc=0.9808 | tpr=0.9577 | fpr=0.0188 | 8499.4 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.12594 | acc=0.9808 | tpr=0.9542 | fpr=0.0187 | 15288.4 samples/s | 59.7 steps/s
Avg test loss: 0.12559, Avg test acc: 0.98087, Avg tpr: 0.95444, Avg fpr: 0.01865, total FA: 2589

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12888 | acc=0.9819 | tpr=0.9425 | fpr=0.0174 | 4372.2 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.13698 | acc=0.9814 | tpr=0.9595 | fpr=0.0182 | 8226.5 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.14036 | acc=0.9810 | tpr=0.9669 | fpr=0.0187 | 8423.1 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.14158 | acc=0.9812 | tpr=0.9683 | fpr=0.0186 | 8145.8 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.14050 | acc=0.9813 | tpr=0.9677 | fpr=0.0184 | 8654.8 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.14166 | acc=0.9812 | tpr=0.9695 | fpr=0.0185 | 8296.2 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.14337 | acc=0.9810 | tpr=0.9687 | fpr=0.0188 | 8564.4 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.14529 | acc=0.9808 | tpr=0.9688 | fpr=0.0190 | 8285.7 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.14814 | acc=0.9805 | tpr=0.9664 | fpr=0.0193 | 8422.5 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.14776 | acc=0.9804 | tpr=0.9656 | fpr=0.0193 | 8151.7 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.14701 | acc=0.9804 | tpr=0.9626 | fpr=0.0192 | 15362.0 samples/s | 60.0 steps/s
Avg test loss: 0.14663, Avg test acc: 0.98047, Avg tpr: 0.96276, Avg fpr: 0.01921, total FA: 2667

server round 33/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=66001 Epoch=128.7] | Loss=0.00198 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.399 | L2-Norm(final)=17.106 | 4211.4 samples/s | 65.8 steps/s
[Step=66050 Epoch=128.8] | Loss=0.01000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.400 | L2-Norm(final)=17.111 | 4973.9 samples/s | 77.7 steps/s
[Step=66100 Epoch=128.9] | Loss=0.01050 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.400 | L2-Norm(final)=17.116 | 5509.6 samples/s | 86.1 steps/s
[Step=66150 Epoch=129.0] | Loss=0.00971 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.400 | L2-Norm(final)=17.122 | 5369.5 samples/s | 83.9 steps/s
[Step=66200 Epoch=129.1] | Loss=0.00922 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.400 | L2-Norm(final)=17.129 | 5442.7 samples/s | 85.0 steps/s
[Step=66250 Epoch=129.2] | Loss=0.00904 | Reg=0.00108 | acc=0.9531 | L2-Norm=10.400 | L2-Norm(final)=17.137 | 5441.2 samples/s | 85.0 steps/s
[Step=66300 Epoch=129.3] | Loss=0.00897 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.400 | L2-Norm(final)=17.144 | 5461.2 samples/s | 85.3 steps/s
[Step=66350 Epoch=129.4] | Loss=0.00925 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.400 | L2-Norm(final)=17.150 | 5473.1 samples/s | 85.5 steps/s
[Step=66400 Epoch=129.5] | Loss=0.00918 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.400 | L2-Norm(final)=17.157 | 5483.4 samples/s | 85.7 steps/s
[Step=66450 Epoch=129.6] | Loss=0.00911 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.400 | L2-Norm(final)=17.163 | 5632.5 samples/s | 88.0 steps/s
[Step=66500 Epoch=129.7] | Loss=0.00893 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.400 | L2-Norm(final)=17.170 | 6678.2 samples/s | 104.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=66501 Epoch=129.7] | Loss=0.01312 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.400 | L2-Norm(final)=17.235 | 3956.1 samples/s | 61.8 steps/s
[Step=66550 Epoch=129.8] | Loss=0.00799 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.410 | L2-Norm(final)=17.241 | 4733.6 samples/s | 74.0 steps/s
[Step=66600 Epoch=129.9] | Loss=0.00909 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.419 | L2-Norm(final)=17.245 | 4737.6 samples/s | 74.0 steps/s
[Step=66650 Epoch=130.0] | Loss=0.00958 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.427 | L2-Norm(final)=17.248 | 4694.4 samples/s | 73.3 steps/s
[Step=66700 Epoch=130.1] | Loss=0.00914 | Reg=0.00109 | acc=0.9688 | L2-Norm=10.434 | L2-Norm(final)=17.251 | 4801.6 samples/s | 75.0 steps/s
[Step=66750 Epoch=130.2] | Loss=0.00906 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.441 | L2-Norm(final)=17.255 | 4752.9 samples/s | 74.3 steps/s
[Step=66800 Epoch=130.3] | Loss=0.00912 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.447 | L2-Norm(final)=17.259 | 4708.2 samples/s | 73.6 steps/s
[Step=66850 Epoch=130.4] | Loss=0.00910 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.453 | L2-Norm(final)=17.263 | 4802.7 samples/s | 75.0 steps/s
[Step=66900 Epoch=130.5] | Loss=0.00889 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.459 | L2-Norm(final)=17.266 | 4810.2 samples/s | 75.2 steps/s
[Step=66950 Epoch=130.6] | Loss=0.00877 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.464 | L2-Norm(final)=17.270 | 4787.4 samples/s | 74.8 steps/s
[Step=67000 Epoch=130.7] | Loss=0.00857 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.469 | L2-Norm(final)=17.273 | 5802.8 samples/s | 90.7 steps/s
[Step=67050 Epoch=130.8] | Loss=0.00838 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.473 | L2-Norm(final)=17.276 | 1931.2 samples/s | 30.2 steps/s
[Step=67100 Epoch=130.9] | Loss=0.00834 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.477 | L2-Norm(final)=17.279 | 4746.6 samples/s | 74.2 steps/s
[Step=67150 Epoch=131.0] | Loss=0.00813 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.481 | L2-Norm(final)=17.282 | 4766.3 samples/s | 74.5 steps/s
[Step=67200 Epoch=131.1] | Loss=0.00796 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.485 | L2-Norm(final)=17.285 | 4739.7 samples/s | 74.1 steps/s
[Step=67250 Epoch=131.2] | Loss=0.00783 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.488 | L2-Norm(final)=17.288 | 4765.1 samples/s | 74.5 steps/s
[Step=67300 Epoch=131.3] | Loss=0.00780 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.492 | L2-Norm(final)=17.291 | 4703.3 samples/s | 73.5 steps/s
[Step=67350 Epoch=131.4] | Loss=0.00772 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.495 | L2-Norm(final)=17.293 | 4743.2 samples/s | 74.1 steps/s
[Step=67400 Epoch=131.5] | Loss=0.00763 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.498 | L2-Norm(final)=17.296 | 4776.6 samples/s | 74.6 steps/s
[Step=67450 Epoch=131.6] | Loss=0.00759 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.501 | L2-Norm(final)=17.299 | 4766.1 samples/s | 74.5 steps/s
[Step=67500 Epoch=131.7] | Loss=0.00742 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.504 | L2-Norm(final)=17.301 | 4976.6 samples/s | 77.8 steps/s
[Step=67550 Epoch=131.7] | Loss=0.00738 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.507 | L2-Norm(final)=17.304 | 2077.4 samples/s | 32.5 steps/s
[Step=67600 Epoch=131.8] | Loss=0.00725 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.509 | L2-Norm(final)=17.306 | 4793.7 samples/s | 74.9 steps/s
[Step=67650 Epoch=131.9] | Loss=0.00716 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.512 | L2-Norm(final)=17.309 | 4750.9 samples/s | 74.2 steps/s
[Step=67700 Epoch=132.0] | Loss=0.00711 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.515 | L2-Norm(final)=17.311 | 4753.4 samples/s | 74.3 steps/s
[Step=67750 Epoch=132.1] | Loss=0.00704 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.517 | L2-Norm(final)=17.314 | 4803.4 samples/s | 75.1 steps/s
[Step=67800 Epoch=132.2] | Loss=0.00699 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.520 | L2-Norm(final)=17.316 | 4780.0 samples/s | 74.7 steps/s
[Step=67850 Epoch=132.3] | Loss=0.00693 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.522 | L2-Norm(final)=17.318 | 4790.1 samples/s | 74.8 steps/s
[Step=67900 Epoch=132.4] | Loss=0.00695 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.524 | L2-Norm(final)=17.321 | 4800.1 samples/s | 75.0 steps/s
[Step=67950 Epoch=132.5] | Loss=0.00691 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.527 | L2-Norm(final)=17.323 | 4824.8 samples/s | 75.4 steps/s
[Step=68000 Epoch=132.6] | Loss=0.00683 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.529 | L2-Norm(final)=17.325 | 4720.7 samples/s | 73.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step68000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=66001 Epoch=129.0] | Loss=0.00417 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.399 | L2-Norm(final)=17.545 | 4300.4 samples/s | 67.2 steps/s
[Step=66050 Epoch=129.1] | Loss=0.00826 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.399 | L2-Norm(final)=17.550 | 5324.1 samples/s | 83.2 steps/s
[Step=66100 Epoch=129.2] | Loss=0.00822 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.399 | L2-Norm(final)=17.557 | 5576.7 samples/s | 87.1 steps/s
[Step=66150 Epoch=129.3] | Loss=0.00817 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.399 | L2-Norm(final)=17.562 | 5513.1 samples/s | 86.1 steps/s
[Step=66200 Epoch=129.4] | Loss=0.00846 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.399 | L2-Norm(final)=17.568 | 5555.5 samples/s | 86.8 steps/s
[Step=66250 Epoch=129.5] | Loss=0.00822 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.399 | L2-Norm(final)=17.574 | 5642.7 samples/s | 88.2 steps/s
[Step=66300 Epoch=129.6] | Loss=0.00850 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.399 | L2-Norm(final)=17.580 | 5535.6 samples/s | 86.5 steps/s
[Step=66350 Epoch=129.7] | Loss=0.00862 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.399 | L2-Norm(final)=17.585 | 5782.6 samples/s | 90.4 steps/s
[Step=66400 Epoch=129.8] | Loss=0.00865 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.399 | L2-Norm(final)=17.591 | 5467.5 samples/s | 85.4 steps/s
[Step=66450 Epoch=129.9] | Loss=0.00872 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.399 | L2-Norm(final)=17.597 | 5434.6 samples/s | 84.9 steps/s
[Step=66500 Epoch=130.0] | Loss=0.00883 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.399 | L2-Norm(final)=17.603 | 7055.4 samples/s | 110.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=66501 Epoch=130.0] | Loss=0.01116 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.399 | L2-Norm(final)=17.660 | 4435.7 samples/s | 69.3 steps/s
[Step=66550 Epoch=130.1] | Loss=0.01018 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.409 | L2-Norm(final)=17.663 | 4452.6 samples/s | 69.6 steps/s
[Step=66600 Epoch=130.2] | Loss=0.00955 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.419 | L2-Norm(final)=17.667 | 4753.4 samples/s | 74.3 steps/s
[Step=66650 Epoch=130.3] | Loss=0.00943 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.429 | L2-Norm(final)=17.671 | 4809.1 samples/s | 75.1 steps/s
[Step=66700 Epoch=130.4] | Loss=0.00892 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.437 | L2-Norm(final)=17.676 | 4772.6 samples/s | 74.6 steps/s
[Step=66750 Epoch=130.5] | Loss=0.00897 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.445 | L2-Norm(final)=17.681 | 4834.7 samples/s | 75.5 steps/s
[Step=66800 Epoch=130.6] | Loss=0.00918 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.452 | L2-Norm(final)=17.685 | 4751.2 samples/s | 74.2 steps/s
[Step=66850 Epoch=130.7] | Loss=0.00913 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.459 | L2-Norm(final)=17.689 | 4713.7 samples/s | 73.7 steps/s
[Step=66900 Epoch=130.8] | Loss=0.00921 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.465 | L2-Norm(final)=17.692 | 4827.7 samples/s | 75.4 steps/s
[Step=66950 Epoch=130.9] | Loss=0.00913 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=17.695 | 4672.5 samples/s | 73.0 steps/s
[Step=67000 Epoch=131.0] | Loss=0.00886 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.475 | L2-Norm(final)=17.699 | 5843.5 samples/s | 91.3 steps/s
[Step=67050 Epoch=131.1] | Loss=0.00845 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.480 | L2-Norm(final)=17.702 | 2031.0 samples/s | 31.7 steps/s
[Step=67100 Epoch=131.2] | Loss=0.00818 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.484 | L2-Norm(final)=17.706 | 4700.1 samples/s | 73.4 steps/s
[Step=67150 Epoch=131.3] | Loss=0.00808 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.488 | L2-Norm(final)=17.709 | 4735.6 samples/s | 74.0 steps/s
[Step=67200 Epoch=131.4] | Loss=0.00784 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.492 | L2-Norm(final)=17.712 | 4750.5 samples/s | 74.2 steps/s
[Step=67250 Epoch=131.5] | Loss=0.00764 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.496 | L2-Norm(final)=17.715 | 4770.6 samples/s | 74.5 steps/s
[Step=67300 Epoch=131.6] | Loss=0.00752 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.499 | L2-Norm(final)=17.718 | 4810.0 samples/s | 75.2 steps/s
[Step=67350 Epoch=131.7] | Loss=0.00736 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.502 | L2-Norm(final)=17.721 | 4810.8 samples/s | 75.2 steps/s
[Step=67400 Epoch=131.8] | Loss=0.00736 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.505 | L2-Norm(final)=17.724 | 4732.5 samples/s | 73.9 steps/s
[Step=67450 Epoch=131.9] | Loss=0.00735 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.508 | L2-Norm(final)=17.727 | 4765.6 samples/s | 74.5 steps/s
[Step=67500 Epoch=132.0] | Loss=0.00734 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.511 | L2-Norm(final)=17.730 | 5164.5 samples/s | 80.7 steps/s
[Step=67550 Epoch=132.1] | Loss=0.00723 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.514 | L2-Norm(final)=17.732 | 2117.0 samples/s | 33.1 steps/s
[Step=67600 Epoch=132.2] | Loss=0.00711 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.517 | L2-Norm(final)=17.735 | 4682.4 samples/s | 73.2 steps/s
[Step=67650 Epoch=132.3] | Loss=0.00699 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.519 | L2-Norm(final)=17.738 | 4745.2 samples/s | 74.1 steps/s
[Step=67700 Epoch=132.4] | Loss=0.00683 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.522 | L2-Norm(final)=17.740 | 4744.3 samples/s | 74.1 steps/s
[Step=67750 Epoch=132.4] | Loss=0.00675 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.524 | L2-Norm(final)=17.743 | 4728.7 samples/s | 73.9 steps/s
[Step=67800 Epoch=132.5] | Loss=0.00669 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.527 | L2-Norm(final)=17.746 | 4854.5 samples/s | 75.9 steps/s
[Step=67850 Epoch=132.6] | Loss=0.00663 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.529 | L2-Norm(final)=17.748 | 4745.9 samples/s | 74.2 steps/s
[Step=67900 Epoch=132.7] | Loss=0.00659 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.532 | L2-Norm(final)=17.751 | 4776.3 samples/s | 74.6 steps/s
[Step=67950 Epoch=132.8] | Loss=0.00658 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.534 | L2-Norm(final)=17.753 | 4851.9 samples/s | 75.8 steps/s
[Step=68000 Epoch=132.9] | Loss=0.00654 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.536 | L2-Norm(final)=17.756 | 4766.3 samples/s | 74.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step68000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=66001 Epoch=252.9] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.399 | L2-Norm(final)=17.982 | 4245.5 samples/s | 66.3 steps/s
[Step=66050 Epoch=253.1] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.391 | L2-Norm(final)=17.987 | 4690.3 samples/s | 73.3 steps/s
[Step=66100 Epoch=253.3] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.390 | L2-Norm(final)=17.993 | 4980.7 samples/s | 77.8 steps/s
[Step=66150 Epoch=253.5] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=18.003 | 5324.2 samples/s | 83.2 steps/s
[Step=66200 Epoch=253.7] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=18.013 | 5220.4 samples/s | 81.6 steps/s
[Step=66250 Epoch=253.8] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=18.021 | 6864.5 samples/s | 107.3 steps/s
[Step=66300 Epoch=254.0] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=18.030 | 2023.5 samples/s | 31.6 steps/s
[Step=66350 Epoch=254.2] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=18.038 | 5191.0 samples/s | 81.1 steps/s
[Step=66400 Epoch=254.4] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=18.046 | 5051.5 samples/s | 78.9 steps/s
[Step=66450 Epoch=254.6] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=18.053 | 5232.2 samples/s | 81.8 steps/s
[Step=66500 Epoch=254.8] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=18.059 | 5697.5 samples/s | 89.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=66501 Epoch=254.8] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=18.123 | 4342.4 samples/s | 67.8 steps/s
[Step=66550 Epoch=255.0] | Loss=0.00003 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.362 | L2-Norm(final)=18.127 | 4439.2 samples/s | 69.4 steps/s
[Step=66600 Epoch=255.2] | Loss=0.00002 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.343 | L2-Norm(final)=18.128 | 4385.3 samples/s | 68.5 steps/s
[Step=66650 Epoch=255.4] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.318 | L2-Norm(final)=18.129 | 4490.0 samples/s | 70.2 steps/s
[Step=66700 Epoch=255.6] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.291 | L2-Norm(final)=18.129 | 4518.9 samples/s | 70.6 steps/s
[Step=66750 Epoch=255.8] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.263 | L2-Norm(final)=18.130 | 5679.6 samples/s | 88.7 steps/s
[Step=66800 Epoch=256.0] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.236 | L2-Norm(final)=18.130 | 1917.4 samples/s | 30.0 steps/s
[Step=66850 Epoch=256.1] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.208 | L2-Norm(final)=18.130 | 4501.3 samples/s | 70.3 steps/s
[Step=66900 Epoch=256.3] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.180 | L2-Norm(final)=18.131 | 4438.8 samples/s | 69.4 steps/s
[Step=66950 Epoch=256.5] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.152 | L2-Norm(final)=18.131 | 4506.2 samples/s | 70.4 steps/s
[Step=67000 Epoch=256.7] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.124 | L2-Norm(final)=18.131 | 4948.2 samples/s | 77.3 steps/s
[Step=67050 Epoch=256.9] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.096 | L2-Norm(final)=18.131 | 2055.6 samples/s | 32.1 steps/s
[Step=67100 Epoch=257.1] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=18.132 | 4492.5 samples/s | 70.2 steps/s
[Step=67150 Epoch=257.3] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.039 | L2-Norm(final)=18.132 | 4499.5 samples/s | 70.3 steps/s
[Step=67200 Epoch=257.5] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.010 | L2-Norm(final)=18.132 | 4500.2 samples/s | 70.3 steps/s
[Step=67250 Epoch=257.7] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.981 | L2-Norm(final)=18.133 | 4494.0 samples/s | 70.2 steps/s
[Step=67300 Epoch=257.9] | Loss=0.00000 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.952 | L2-Norm(final)=18.133 | 2145.0 samples/s | 33.5 steps/s
[Step=67350 Epoch=258.1] | Loss=0.00000 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.923 | L2-Norm(final)=18.133 | 4708.7 samples/s | 73.6 steps/s
[Step=67400 Epoch=258.3] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.894 | L2-Norm(final)=18.134 | 4607.1 samples/s | 72.0 steps/s
[Step=67450 Epoch=258.4] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.864 | L2-Norm(final)=18.134 | 4641.0 samples/s | 72.5 steps/s
[Step=67500 Epoch=258.6] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.835 | L2-Norm(final)=18.135 | 4594.2 samples/s | 71.8 steps/s
[Step=67550 Epoch=258.8] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.805 | L2-Norm(final)=18.135 | 2118.2 samples/s | 33.1 steps/s
[Step=67600 Epoch=259.0] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.775 | L2-Norm(final)=18.135 | 4497.8 samples/s | 70.3 steps/s
[Step=67650 Epoch=259.2] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.745 | L2-Norm(final)=18.136 | 4510.9 samples/s | 70.5 steps/s
[Step=67700 Epoch=259.4] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.715 | L2-Norm(final)=18.136 | 4483.1 samples/s | 70.0 steps/s
[Step=67750 Epoch=259.6] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.685 | L2-Norm(final)=18.137 | 4503.8 samples/s | 70.4 steps/s
[Step=67800 Epoch=259.8] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=18.138 | 6127.4 samples/s | 95.7 steps/s
[Step=67850 Epoch=260.0] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.624 | L2-Norm(final)=18.138 | 1889.6 samples/s | 29.5 steps/s
[Step=67900 Epoch=260.2] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=18.139 | 4490.2 samples/s | 70.2 steps/s
[Step=67950 Epoch=260.4] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.562 | L2-Norm(final)=18.140 | 4521.6 samples/s | 70.6 steps/s
[Step=68000 Epoch=260.6] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.531 | L2-Norm(final)=18.140 | 4455.5 samples/s | 69.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step68000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=66001 Epoch=254.1] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.399 | L2-Norm(final)=18.028 | 4179.4 samples/s | 65.3 steps/s
[Step=66050 Epoch=254.3] | Loss=0.00004 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=18.032 | 5082.4 samples/s | 79.4 steps/s
[Step=66100 Epoch=254.4] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=18.035 | 5183.2 samples/s | 81.0 steps/s
[Step=66150 Epoch=254.6] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.397 | L2-Norm(final)=18.038 | 5188.9 samples/s | 81.1 steps/s
[Step=66200 Epoch=254.8] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.397 | L2-Norm(final)=18.040 | 5110.1 samples/s | 79.8 steps/s
[Step=66250 Epoch=255.0] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.397 | L2-Norm(final)=18.043 | 6863.4 samples/s | 107.2 steps/s
[Step=66300 Epoch=255.2] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.397 | L2-Norm(final)=18.045 | 2003.3 samples/s | 31.3 steps/s
[Step=66350 Epoch=255.4] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.397 | L2-Norm(final)=18.047 | 5091.2 samples/s | 79.5 steps/s
[Step=66400 Epoch=255.6] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.397 | L2-Norm(final)=18.049 | 5173.8 samples/s | 80.8 steps/s
[Step=66450 Epoch=255.8] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.397 | L2-Norm(final)=18.051 | 4978.2 samples/s | 77.8 steps/s
[Step=66500 Epoch=256.0] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.397 | L2-Norm(final)=18.053 | 5985.2 samples/s | 93.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=66501 Epoch=256.0] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.397 | L2-Norm(final)=18.076 | 4217.7 samples/s | 65.9 steps/s
[Step=66550 Epoch=256.2] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.394 | L2-Norm(final)=18.079 | 4207.7 samples/s | 65.7 steps/s
[Step=66600 Epoch=256.4] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.390 | L2-Norm(final)=18.081 | 4542.8 samples/s | 71.0 steps/s
[Step=66650 Epoch=256.6] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.384 | L2-Norm(final)=18.083 | 4421.3 samples/s | 69.1 steps/s
[Step=66700 Epoch=256.8] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.379 | L2-Norm(final)=18.084 | 4491.0 samples/s | 70.2 steps/s
[Step=66750 Epoch=256.9] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.373 | L2-Norm(final)=18.085 | 5765.2 samples/s | 90.1 steps/s
[Step=66800 Epoch=257.1] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.368 | L2-Norm(final)=18.087 | 1936.7 samples/s | 30.3 steps/s
[Step=66850 Epoch=257.3] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.362 | L2-Norm(final)=18.088 | 4523.6 samples/s | 70.7 steps/s
[Step=66900 Epoch=257.5] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.356 | L2-Norm(final)=18.089 | 4492.3 samples/s | 70.2 steps/s
[Step=66950 Epoch=257.7] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.350 | L2-Norm(final)=18.090 | 4581.9 samples/s | 71.6 steps/s
[Step=67000 Epoch=257.9] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.343 | L2-Norm(final)=18.091 | 5048.4 samples/s | 78.9 steps/s
[Step=67050 Epoch=258.1] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.337 | L2-Norm(final)=18.093 | 2021.6 samples/s | 31.6 steps/s
[Step=67100 Epoch=258.3] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.331 | L2-Norm(final)=18.094 | 4590.0 samples/s | 71.7 steps/s
[Step=67150 Epoch=258.5] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.325 | L2-Norm(final)=18.095 | 4511.8 samples/s | 70.5 steps/s
[Step=67200 Epoch=258.7] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.319 | L2-Norm(final)=18.096 | 4523.8 samples/s | 70.7 steps/s
[Step=67250 Epoch=258.9] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.312 | L2-Norm(final)=18.097 | 4604.9 samples/s | 72.0 steps/s
[Step=67300 Epoch=259.1] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.306 | L2-Norm(final)=18.097 | 2102.4 samples/s | 32.8 steps/s
[Step=67350 Epoch=259.3] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.299 | L2-Norm(final)=18.098 | 4559.2 samples/s | 71.2 steps/s
[Step=67400 Epoch=259.4] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.293 | L2-Norm(final)=18.099 | 4514.4 samples/s | 70.5 steps/s
[Step=67450 Epoch=259.6] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.286 | L2-Norm(final)=18.100 | 4494.0 samples/s | 70.2 steps/s
[Step=67500 Epoch=259.8] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.279 | L2-Norm(final)=18.101 | 4465.2 samples/s | 69.8 steps/s
[Step=67550 Epoch=260.0] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.272 | L2-Norm(final)=18.102 | 2152.4 samples/s | 33.6 steps/s
[Step=67600 Epoch=260.2] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.266 | L2-Norm(final)=18.103 | 4580.3 samples/s | 71.6 steps/s
[Step=67650 Epoch=260.4] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.259 | L2-Norm(final)=18.104 | 4546.5 samples/s | 71.0 steps/s
[Step=67700 Epoch=260.6] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.252 | L2-Norm(final)=18.105 | 4561.0 samples/s | 71.3 steps/s
[Step=67750 Epoch=260.8] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.245 | L2-Norm(final)=18.106 | 4561.6 samples/s | 71.3 steps/s
[Step=67800 Epoch=261.0] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.238 | L2-Norm(final)=18.107 | 6640.3 samples/s | 103.8 steps/s
[Step=67850 Epoch=261.2] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.230 | L2-Norm(final)=18.108 | 1882.0 samples/s | 29.4 steps/s
[Step=67900 Epoch=261.4] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.223 | L2-Norm(final)=18.109 | 4534.1 samples/s | 70.8 steps/s
[Step=67950 Epoch=261.6] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.216 | L2-Norm(final)=18.110 | 4529.9 samples/s | 70.8 steps/s
[Step=68000 Epoch=261.8] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.208 | L2-Norm(final)=18.110 | 4631.8 samples/s | 72.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step68000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06936 | acc=0.9712 | tpr=0.9774 | fpr=0.0424 | 4492.3 samples/s | 17.5 steps/s
Avg test loss: 0.06955, Avg test acc: 0.97099, Avg tpr: 0.97733, Avg fpr: 0.04294, total FA: 335

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07214 | acc=0.9711 | tpr=0.9776 | fpr=0.0431 | 4602.6 samples/s | 18.0 steps/s
Avg test loss: 0.07307, Avg test acc: 0.97191, Avg tpr: 0.97902, Avg fpr: 0.04371, total FA: 341

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.51966 | acc=0.3146 | tpr=0.0067 | fpr=0.0168 | 4408.9 samples/s | 17.2 steps/s
Avg test loss: 5.54200, Avg test acc: 0.31248, Avg tpr: 0.00764, Avg fpr: 0.01705, total FA: 133

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.91130 | acc=0.3109 | tpr=0.0149 | fpr=0.0463 | 4570.4 samples/s | 17.9 steps/s
Avg test loss: 5.92456, Avg test acc: 0.30752, Avg tpr: 0.01510, Avg fpr: 0.04935, total FA: 385

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.05516 | acc=0.1214 | tpr=0.7566 | fpr=0.8900 | 4388.2 samples/s | 17.1 steps/s
[Step= 100] | Loss=6.03272 | acc=0.1205 | tpr=0.7377 | fpr=0.8910 | 8497.8 samples/s | 33.2 steps/s
[Step= 150] | Loss=6.04685 | acc=0.1203 | tpr=0.7435 | fpr=0.8911 | 8513.4 samples/s | 33.3 steps/s
[Step= 200] | Loss=6.04764 | acc=0.1198 | tpr=0.7301 | fpr=0.8913 | 8188.1 samples/s | 32.0 steps/s
[Step= 250] | Loss=6.05980 | acc=0.1194 | tpr=0.7345 | fpr=0.8918 | 8348.8 samples/s | 32.6 steps/s
[Step= 300] | Loss=6.05524 | acc=0.1193 | tpr=0.7338 | fpr=0.8919 | 8677.6 samples/s | 33.9 steps/s
[Step= 350] | Loss=6.05587 | acc=0.1189 | tpr=0.7326 | fpr=0.8923 | 8138.9 samples/s | 31.8 steps/s
[Step= 400] | Loss=6.06275 | acc=0.1187 | tpr=0.7298 | fpr=0.8924 | 8529.4 samples/s | 33.3 steps/s
[Step= 450] | Loss=6.06627 | acc=0.1187 | tpr=0.7313 | fpr=0.8924 | 8330.4 samples/s | 32.5 steps/s
[Step= 500] | Loss=6.06594 | acc=0.1185 | tpr=0.7330 | fpr=0.8926 | 8048.7 samples/s | 31.4 steps/s
[Step= 550] | Loss=6.07089 | acc=0.1184 | tpr=0.7298 | fpr=0.8927 | 15537.7 samples/s | 60.7 steps/s
Avg test loss: 6.07085, Avg test acc: 0.11824, Avg tpr: 0.72940, Avg fpr: 0.89287, total FA: 123973

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.18294 | acc=0.1337 | tpr=0.6814 | fpr=0.8762 | 4460.7 samples/s | 17.4 steps/s
[Step= 100] | Loss=6.16377 | acc=0.1331 | tpr=0.6994 | fpr=0.8775 | 8465.5 samples/s | 33.1 steps/s
[Step= 150] | Loss=6.17441 | acc=0.1327 | tpr=0.6974 | fpr=0.8777 | 8438.4 samples/s | 33.0 steps/s
[Step= 200] | Loss=6.17331 | acc=0.1324 | tpr=0.6874 | fpr=0.8777 | 8194.4 samples/s | 32.0 steps/s
[Step= 250] | Loss=6.18643 | acc=0.1324 | tpr=0.6917 | fpr=0.8778 | 8150.5 samples/s | 31.8 steps/s
[Step= 300] | Loss=6.18204 | acc=0.1321 | tpr=0.6909 | fpr=0.8781 | 8307.4 samples/s | 32.5 steps/s
[Step= 350] | Loss=6.17923 | acc=0.1316 | tpr=0.6888 | fpr=0.8785 | 8654.5 samples/s | 33.8 steps/s
[Step= 400] | Loss=6.18539 | acc=0.1316 | tpr=0.6865 | fpr=0.8785 | 8473.2 samples/s | 33.1 steps/s
[Step= 450] | Loss=6.18731 | acc=0.1314 | tpr=0.6908 | fpr=0.8788 | 8367.7 samples/s | 32.7 steps/s
[Step= 500] | Loss=6.18687 | acc=0.1311 | tpr=0.6907 | fpr=0.8791 | 8388.5 samples/s | 32.8 steps/s
[Step= 550] | Loss=6.19084 | acc=0.1309 | tpr=0.6852 | fpr=0.8792 | 15266.8 samples/s | 59.6 steps/s
Avg test loss: 6.19051, Avg test acc: 0.13080, Avg tpr: 0.68502, Avg fpr: 0.87928, total FA: 122086

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11196 | acc=0.9816 | tpr=0.9381 | fpr=0.0176 | 4466.5 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.11840 | acc=0.9816 | tpr=0.9574 | fpr=0.0179 | 8437.3 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.12191 | acc=0.9810 | tpr=0.9597 | fpr=0.0186 | 8662.4 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.12271 | acc=0.9813 | tpr=0.9628 | fpr=0.0184 | 8326.4 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.12121 | acc=0.9814 | tpr=0.9607 | fpr=0.0182 | 8364.1 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.12232 | acc=0.9813 | tpr=0.9615 | fpr=0.0183 | 8324.3 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.12354 | acc=0.9811 | tpr=0.9624 | fpr=0.0186 | 8674.9 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.12504 | acc=0.9810 | tpr=0.9617 | fpr=0.0187 | 8293.6 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.12755 | acc=0.9807 | tpr=0.9596 | fpr=0.0189 | 8273.9 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.12706 | acc=0.9807 | tpr=0.9595 | fpr=0.0189 | 8289.8 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.12607 | acc=0.9808 | tpr=0.9562 | fpr=0.0188 | 15676.6 samples/s | 61.2 steps/s
Avg test loss: 0.12571, Avg test acc: 0.98082, Avg tpr: 0.95642, Avg fpr: 0.01874, total FA: 2602

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11967 | acc=0.9813 | tpr=0.9381 | fpr=0.0179 | 4393.5 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.12667 | acc=0.9814 | tpr=0.9574 | fpr=0.0182 | 8562.9 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.13054 | acc=0.9806 | tpr=0.9654 | fpr=0.0191 | 8417.8 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.13110 | acc=0.9807 | tpr=0.9661 | fpr=0.0191 | 8289.3 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.13008 | acc=0.9809 | tpr=0.9659 | fpr=0.0188 | 8220.1 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.13082 | acc=0.9809 | tpr=0.9673 | fpr=0.0189 | 8426.9 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.13216 | acc=0.9807 | tpr=0.9674 | fpr=0.0191 | 8477.9 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.13424 | acc=0.9805 | tpr=0.9677 | fpr=0.0192 | 8200.2 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.13697 | acc=0.9803 | tpr=0.9659 | fpr=0.0195 | 8408.8 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.13668 | acc=0.9803 | tpr=0.9652 | fpr=0.0195 | 8586.4 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.13586 | acc=0.9804 | tpr=0.9630 | fpr=0.0193 | 14968.7 samples/s | 58.5 steps/s
Avg test loss: 0.13556, Avg test acc: 0.98041, Avg tpr: 0.96315, Avg fpr: 0.01927, total FA: 2676

server round 34/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=68001 Epoch=132.6] | Loss=0.00186 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.889 | L2-Norm(final)=17.391 | 3826.3 samples/s | 59.8 steps/s
[Step=68050 Epoch=132.7] | Loss=0.01280 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=17.400 | 5377.8 samples/s | 84.0 steps/s
[Step=68100 Epoch=132.8] | Loss=0.01359 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.890 | L2-Norm(final)=17.411 | 5457.3 samples/s | 85.3 steps/s
[Step=68150 Epoch=132.9] | Loss=0.01340 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=17.421 | 5580.2 samples/s | 87.2 steps/s
[Step=68200 Epoch=133.0] | Loss=0.01408 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=17.431 | 5365.6 samples/s | 83.8 steps/s
[Step=68250 Epoch=133.1] | Loss=0.01432 | Reg=0.00098 | acc=0.9375 | L2-Norm=9.890 | L2-Norm(final)=17.440 | 5504.5 samples/s | 86.0 steps/s
[Step=68300 Epoch=133.2] | Loss=0.01436 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.890 | L2-Norm(final)=17.448 | 5657.2 samples/s | 88.4 steps/s
[Step=68350 Epoch=133.3] | Loss=0.01432 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.890 | L2-Norm(final)=17.456 | 5419.7 samples/s | 84.7 steps/s
[Step=68400 Epoch=133.4] | Loss=0.01428 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.890 | L2-Norm(final)=17.464 | 5540.5 samples/s | 86.6 steps/s
[Step=68450 Epoch=133.5] | Loss=0.01422 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=17.473 | 5535.7 samples/s | 86.5 steps/s
[Step=68500 Epoch=133.6] | Loss=0.01411 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=17.481 | 6957.8 samples/s | 108.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=68501 Epoch=133.6] | Loss=0.01045 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=17.563 | 4108.0 samples/s | 64.2 steps/s
[Step=68550 Epoch=133.7] | Loss=0.01020 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=17.568 | 4713.7 samples/s | 73.7 steps/s
[Step=68600 Epoch=133.8] | Loss=0.00971 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.919 | L2-Norm(final)=17.571 | 4737.8 samples/s | 74.0 steps/s
[Step=68650 Epoch=133.9] | Loss=0.00943 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.930 | L2-Norm(final)=17.574 | 4779.8 samples/s | 74.7 steps/s
[Step=68700 Epoch=134.0] | Loss=0.01031 | Reg=0.00099 | acc=0.9688 | L2-Norm=9.940 | L2-Norm(final)=17.577 | 4791.8 samples/s | 74.9 steps/s
[Step=68750 Epoch=134.1] | Loss=0.01007 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.949 | L2-Norm(final)=17.580 | 4677.9 samples/s | 73.1 steps/s
[Step=68800 Epoch=134.2] | Loss=0.01016 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.957 | L2-Norm(final)=17.584 | 4797.7 samples/s | 75.0 steps/s
[Step=68850 Epoch=134.3] | Loss=0.01015 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.964 | L2-Norm(final)=17.586 | 4764.6 samples/s | 74.4 steps/s
[Step=68900 Epoch=134.4] | Loss=0.01037 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.971 | L2-Norm(final)=17.589 | 4720.9 samples/s | 73.8 steps/s
[Step=68950 Epoch=134.5] | Loss=0.01022 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.977 | L2-Norm(final)=17.591 | 4789.4 samples/s | 74.8 steps/s
[Step=69000 Epoch=134.6] | Loss=0.01002 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.984 | L2-Norm(final)=17.594 | 5819.0 samples/s | 90.9 steps/s
[Step=69050 Epoch=134.7] | Loss=0.00966 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.989 | L2-Norm(final)=17.597 | 1939.8 samples/s | 30.3 steps/s
[Step=69100 Epoch=134.8] | Loss=0.00936 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.995 | L2-Norm(final)=17.600 | 4563.5 samples/s | 71.3 steps/s
[Step=69150 Epoch=134.9] | Loss=0.00913 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.000 | L2-Norm(final)=17.603 | 4783.3 samples/s | 74.7 steps/s
[Step=69200 Epoch=135.0] | Loss=0.00890 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.005 | L2-Norm(final)=17.606 | 4663.5 samples/s | 72.9 steps/s
[Step=69250 Epoch=135.1] | Loss=0.00876 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.009 | L2-Norm(final)=17.608 | 4725.9 samples/s | 73.8 steps/s
[Step=69300 Epoch=135.2] | Loss=0.00864 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.014 | L2-Norm(final)=17.611 | 4738.1 samples/s | 74.0 steps/s
[Step=69350 Epoch=135.3] | Loss=0.00863 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.017 | L2-Norm(final)=17.614 | 4903.7 samples/s | 76.6 steps/s
[Step=69400 Epoch=135.4] | Loss=0.00851 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.021 | L2-Norm(final)=17.616 | 4807.7 samples/s | 75.1 steps/s
[Step=69450 Epoch=135.5] | Loss=0.00842 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=17.619 | 4785.4 samples/s | 74.8 steps/s
[Step=69500 Epoch=135.6] | Loss=0.00830 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.028 | L2-Norm(final)=17.621 | 4986.1 samples/s | 77.9 steps/s
[Step=69550 Epoch=135.6] | Loss=0.00809 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.032 | L2-Norm(final)=17.624 | 2066.6 samples/s | 32.3 steps/s
[Step=69600 Epoch=135.7] | Loss=0.00795 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.035 | L2-Norm(final)=17.627 | 4820.6 samples/s | 75.3 steps/s
[Step=69650 Epoch=135.8] | Loss=0.00787 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.039 | L2-Norm(final)=17.629 | 4856.7 samples/s | 75.9 steps/s
[Step=69700 Epoch=135.9] | Loss=0.00782 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.042 | L2-Norm(final)=17.632 | 4725.1 samples/s | 73.8 steps/s
[Step=69750 Epoch=136.0] | Loss=0.00775 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.045 | L2-Norm(final)=17.634 | 4786.1 samples/s | 74.8 steps/s
[Step=69800 Epoch=136.1] | Loss=0.00770 | Reg=0.00101 | acc=0.9688 | L2-Norm=10.048 | L2-Norm(final)=17.637 | 4666.7 samples/s | 72.9 steps/s
[Step=69850 Epoch=136.2] | Loss=0.00763 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.051 | L2-Norm(final)=17.639 | 4720.4 samples/s | 73.8 steps/s
[Step=69900 Epoch=136.3] | Loss=0.00760 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.054 | L2-Norm(final)=17.641 | 4775.2 samples/s | 74.6 steps/s
[Step=69950 Epoch=136.4] | Loss=0.00754 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.057 | L2-Norm(final)=17.644 | 4732.5 samples/s | 73.9 steps/s
[Step=70000 Epoch=136.5] | Loss=0.00747 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.059 | L2-Norm(final)=17.646 | 4769.3 samples/s | 74.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step70000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=68001 Epoch=132.9] | Loss=0.00864 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.889 | L2-Norm(final)=17.833 | 4360.2 samples/s | 68.1 steps/s
[Step=68050 Epoch=133.0] | Loss=0.01119 | Reg=0.00098 | acc=0.9531 | L2-Norm=9.889 | L2-Norm(final)=17.838 | 5370.9 samples/s | 83.9 steps/s
[Step=68100 Epoch=133.1] | Loss=0.01108 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.889 | L2-Norm(final)=17.837 | 5552.0 samples/s | 86.8 steps/s
[Step=68150 Epoch=133.2] | Loss=0.01056 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.889 | L2-Norm(final)=17.839 | 5634.5 samples/s | 88.0 steps/s
[Step=68200 Epoch=133.3] | Loss=0.01052 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.889 | L2-Norm(final)=17.843 | 5588.8 samples/s | 87.3 steps/s
[Step=68250 Epoch=133.4] | Loss=0.01076 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.889 | L2-Norm(final)=17.847 | 5730.1 samples/s | 89.5 steps/s
[Step=68300 Epoch=133.5] | Loss=0.01051 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.889 | L2-Norm(final)=17.850 | 5564.9 samples/s | 87.0 steps/s
[Step=68350 Epoch=133.6] | Loss=0.01056 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.889 | L2-Norm(final)=17.855 | 5626.0 samples/s | 87.9 steps/s
[Step=68400 Epoch=133.7] | Loss=0.01047 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.889 | L2-Norm(final)=17.859 | 5588.1 samples/s | 87.3 steps/s
[Step=68450 Epoch=133.8] | Loss=0.01045 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.889 | L2-Norm(final)=17.864 | 5643.6 samples/s | 88.2 steps/s
[Step=68500 Epoch=133.9] | Loss=0.01043 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.889 | L2-Norm(final)=17.869 | 7231.6 samples/s | 113.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=68501 Epoch=133.9] | Loss=0.00253 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.889 | L2-Norm(final)=17.920 | 4342.9 samples/s | 67.9 steps/s
[Step=68550 Epoch=134.0] | Loss=0.01316 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=17.926 | 4602.8 samples/s | 71.9 steps/s
[Step=68600 Epoch=134.1] | Loss=0.01211 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.918 | L2-Norm(final)=17.932 | 4785.6 samples/s | 74.8 steps/s
[Step=68650 Epoch=134.2] | Loss=0.01106 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.929 | L2-Norm(final)=17.938 | 4812.1 samples/s | 75.2 steps/s
[Step=68700 Epoch=134.3] | Loss=0.01019 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.939 | L2-Norm(final)=17.943 | 4821.2 samples/s | 75.3 steps/s
[Step=68750 Epoch=134.4] | Loss=0.01020 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.948 | L2-Norm(final)=17.948 | 4666.3 samples/s | 72.9 steps/s
[Step=68800 Epoch=134.5] | Loss=0.01022 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.957 | L2-Norm(final)=17.953 | 4760.4 samples/s | 74.4 steps/s
[Step=68850 Epoch=134.6] | Loss=0.00986 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.964 | L2-Norm(final)=17.957 | 4817.2 samples/s | 75.3 steps/s
[Step=68900 Epoch=134.7] | Loss=0.00970 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.971 | L2-Norm(final)=17.961 | 4756.2 samples/s | 74.3 steps/s
[Step=68950 Epoch=134.8] | Loss=0.00934 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.977 | L2-Norm(final)=17.965 | 4811.6 samples/s | 75.2 steps/s
[Step=69000 Epoch=134.9] | Loss=0.00952 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.982 | L2-Norm(final)=17.969 | 5883.7 samples/s | 91.9 steps/s
[Step=69050 Epoch=135.0] | Loss=0.00937 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.988 | L2-Norm(final)=17.973 | 2035.1 samples/s | 31.8 steps/s
[Step=69100 Epoch=135.1] | Loss=0.00905 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.993 | L2-Norm(final)=17.977 | 4810.2 samples/s | 75.2 steps/s
[Step=69150 Epoch=135.2] | Loss=0.00882 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.998 | L2-Norm(final)=17.980 | 4719.5 samples/s | 73.7 steps/s
[Step=69200 Epoch=135.3] | Loss=0.00870 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.002 | L2-Norm(final)=17.984 | 4643.2 samples/s | 72.6 steps/s
[Step=69250 Epoch=135.4] | Loss=0.00851 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.006 | L2-Norm(final)=17.988 | 4698.2 samples/s | 73.4 steps/s
[Step=69300 Epoch=135.5] | Loss=0.00835 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.011 | L2-Norm(final)=17.992 | 4961.6 samples/s | 77.5 steps/s
[Step=69350 Epoch=135.6] | Loss=0.00833 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.015 | L2-Norm(final)=17.995 | 4889.5 samples/s | 76.4 steps/s
[Step=69400 Epoch=135.7] | Loss=0.00818 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.019 | L2-Norm(final)=17.999 | 4743.1 samples/s | 74.1 steps/s
[Step=69450 Epoch=135.8] | Loss=0.00803 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.022 | L2-Norm(final)=18.002 | 4753.2 samples/s | 74.3 steps/s
[Step=69500 Epoch=135.9] | Loss=0.00786 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.026 | L2-Norm(final)=18.005 | 5160.6 samples/s | 80.6 steps/s
[Step=69550 Epoch=136.0] | Loss=0.00767 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.030 | L2-Norm(final)=18.009 | 2115.1 samples/s | 33.0 steps/s
[Step=69600 Epoch=136.1] | Loss=0.00760 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.033 | L2-Norm(final)=18.012 | 4847.9 samples/s | 75.7 steps/s
[Step=69650 Epoch=136.2] | Loss=0.00754 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.037 | L2-Norm(final)=18.016 | 4853.9 samples/s | 75.8 steps/s
[Step=69700 Epoch=136.3] | Loss=0.00746 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.040 | L2-Norm(final)=18.019 | 4729.6 samples/s | 73.9 steps/s
[Step=69750 Epoch=136.4] | Loss=0.00746 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.043 | L2-Norm(final)=18.022 | 4720.4 samples/s | 73.8 steps/s
[Step=69800 Epoch=136.5] | Loss=0.00733 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.046 | L2-Norm(final)=18.024 | 4759.3 samples/s | 74.4 steps/s
[Step=69850 Epoch=136.6] | Loss=0.00734 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.049 | L2-Norm(final)=18.027 | 4790.4 samples/s | 74.8 steps/s
[Step=69900 Epoch=136.7] | Loss=0.00730 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.052 | L2-Norm(final)=18.030 | 4700.5 samples/s | 73.4 steps/s
[Step=69950 Epoch=136.8] | Loss=0.00720 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.055 | L2-Norm(final)=18.033 | 4773.4 samples/s | 74.6 steps/s
[Step=70000 Epoch=136.8] | Loss=0.00711 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.058 | L2-Norm(final)=18.036 | 4765.0 samples/s | 74.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step70000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=68001 Epoch=260.6] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.889 | L2-Norm(final)=18.164 | 4465.3 samples/s | 69.8 steps/s
[Step=68050 Epoch=260.7] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.879 | L2-Norm(final)=18.174 | 4727.2 samples/s | 73.9 steps/s
[Step=68100 Epoch=260.9] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.878 | L2-Norm(final)=18.185 | 5157.2 samples/s | 80.6 steps/s
[Step=68150 Epoch=261.1] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.877 | L2-Norm(final)=18.198 | 5161.1 samples/s | 80.6 steps/s
[Step=68200 Epoch=261.3] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.877 | L2-Norm(final)=18.209 | 5214.4 samples/s | 81.5 steps/s
[Step=68250 Epoch=261.5] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.877 | L2-Norm(final)=18.220 | 6616.1 samples/s | 103.4 steps/s
[Step=68300 Epoch=261.7] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.877 | L2-Norm(final)=18.229 | 1998.7 samples/s | 31.2 steps/s
[Step=68350 Epoch=261.9] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.877 | L2-Norm(final)=18.237 | 5097.9 samples/s | 79.7 steps/s
[Step=68400 Epoch=262.1] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.877 | L2-Norm(final)=18.245 | 5101.9 samples/s | 79.7 steps/s
[Step=68450 Epoch=262.3] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.877 | L2-Norm(final)=18.252 | 5206.9 samples/s | 81.4 steps/s
[Step=68500 Epoch=262.5] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.877 | L2-Norm(final)=18.260 | 5755.3 samples/s | 89.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=68501 Epoch=262.5] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.876 | L2-Norm(final)=18.330 | 4269.2 samples/s | 66.7 steps/s
[Step=68550 Epoch=262.7] | Loss=0.00068 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.878 | L2-Norm(final)=18.328 | 4198.3 samples/s | 65.6 steps/s
[Step=68600 Epoch=262.9] | Loss=0.00053 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.894 | L2-Norm(final)=18.324 | 4547.5 samples/s | 71.1 steps/s
[Step=68650 Epoch=263.0] | Loss=0.00036 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.902 | L2-Norm(final)=18.323 | 4504.3 samples/s | 70.4 steps/s
[Step=68700 Epoch=263.2] | Loss=0.00027 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=18.323 | 4470.6 samples/s | 69.9 steps/s
[Step=68750 Epoch=263.4] | Loss=0.00022 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=18.323 | 5666.5 samples/s | 88.5 steps/s
[Step=68800 Epoch=263.6] | Loss=0.00018 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=18.323 | 1959.7 samples/s | 30.6 steps/s
[Step=68850 Epoch=263.8] | Loss=0.00016 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=18.323 | 4454.5 samples/s | 69.6 steps/s
[Step=68900 Epoch=264.0] | Loss=0.00014 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=18.323 | 4586.1 samples/s | 71.7 steps/s
[Step=68950 Epoch=264.2] | Loss=0.00012 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.902 | L2-Norm(final)=18.323 | 4650.1 samples/s | 72.7 steps/s
[Step=69000 Epoch=264.4] | Loss=0.00011 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=18.323 | 4935.8 samples/s | 77.1 steps/s
[Step=69050 Epoch=264.6] | Loss=0.00010 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=18.323 | 2037.8 samples/s | 31.8 steps/s
[Step=69100 Epoch=264.8] | Loss=0.00009 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.898 | L2-Norm(final)=18.323 | 4531.3 samples/s | 70.8 steps/s
[Step=69150 Epoch=265.0] | Loss=0.00009 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.896 | L2-Norm(final)=18.323 | 4516.2 samples/s | 70.6 steps/s
[Step=69200 Epoch=265.1] | Loss=0.00008 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.895 | L2-Norm(final)=18.323 | 4546.0 samples/s | 71.0 steps/s
[Step=69250 Epoch=265.3] | Loss=0.00007 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.893 | L2-Norm(final)=18.323 | 4487.9 samples/s | 70.1 steps/s
[Step=69300 Epoch=265.5] | Loss=0.00007 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.891 | L2-Norm(final)=18.324 | 2116.2 samples/s | 33.1 steps/s
[Step=69350 Epoch=265.7] | Loss=0.00007 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.889 | L2-Norm(final)=18.324 | 4628.8 samples/s | 72.3 steps/s
[Step=69400 Epoch=265.9] | Loss=0.00006 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.887 | L2-Norm(final)=18.324 | 4576.9 samples/s | 71.5 steps/s
[Step=69450 Epoch=266.1] | Loss=0.00006 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=18.324 | 4522.2 samples/s | 70.7 steps/s
[Step=69500 Epoch=266.3] | Loss=0.00006 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.883 | L2-Norm(final)=18.324 | 4558.1 samples/s | 71.2 steps/s
[Step=69550 Epoch=266.5] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.881 | L2-Norm(final)=18.324 | 2149.6 samples/s | 33.6 steps/s
[Step=69600 Epoch=266.7] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.879 | L2-Norm(final)=18.325 | 4434.1 samples/s | 69.3 steps/s
[Step=69650 Epoch=266.9] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.877 | L2-Norm(final)=18.325 | 4474.6 samples/s | 69.9 steps/s
[Step=69700 Epoch=267.1] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=18.325 | 4513.7 samples/s | 70.5 steps/s
[Step=69750 Epoch=267.3] | Loss=0.00005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=18.325 | 4549.0 samples/s | 71.1 steps/s
[Step=69800 Epoch=267.4] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.871 | L2-Norm(final)=18.326 | 6162.6 samples/s | 96.3 steps/s
[Step=69850 Epoch=267.6] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.868 | L2-Norm(final)=18.326 | 1890.5 samples/s | 29.5 steps/s
[Step=69900 Epoch=267.8] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.866 | L2-Norm(final)=18.326 | 4610.9 samples/s | 72.0 steps/s
[Step=69950 Epoch=268.0] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.864 | L2-Norm(final)=18.327 | 4608.1 samples/s | 72.0 steps/s
[Step=70000 Epoch=268.2] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.861 | L2-Norm(final)=18.327 | 4502.1 samples/s | 70.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step70000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=68001 Epoch=261.8] | Loss=0.00031 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.889 | L2-Norm(final)=18.139 | 4142.9 samples/s | 64.7 steps/s
[Step=68050 Epoch=262.0] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.886 | L2-Norm(final)=18.140 | 5018.4 samples/s | 78.4 steps/s
[Step=68100 Epoch=262.1] | Loss=0.00006 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.886 | L2-Norm(final)=18.153 | 5219.0 samples/s | 81.5 steps/s
[Step=68150 Epoch=262.3] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.886 | L2-Norm(final)=18.163 | 5017.7 samples/s | 78.4 steps/s
[Step=68200 Epoch=262.5] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.886 | L2-Norm(final)=18.168 | 5137.1 samples/s | 80.3 steps/s
[Step=68250 Epoch=262.7] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.886 | L2-Norm(final)=18.174 | 6867.2 samples/s | 107.3 steps/s
[Step=68300 Epoch=262.9] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.886 | L2-Norm(final)=18.180 | 2051.6 samples/s | 32.1 steps/s
[Step=68350 Epoch=263.1] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.886 | L2-Norm(final)=18.185 | 5314.2 samples/s | 83.0 steps/s
[Step=68400 Epoch=263.3] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.886 | L2-Norm(final)=18.191 | 5155.4 samples/s | 80.6 steps/s
[Step=68450 Epoch=263.5] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.886 | L2-Norm(final)=18.197 | 5155.2 samples/s | 80.6 steps/s
[Step=68500 Epoch=263.7] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.886 | L2-Norm(final)=18.202 | 5913.8 samples/s | 92.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=68501 Epoch=263.7] | Loss=0.00007 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.886 | L2-Norm(final)=18.254 | 4034.3 samples/s | 63.0 steps/s
[Step=68550 Epoch=263.9] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.889 | L2-Norm(final)=18.255 | 4648.0 samples/s | 72.6 steps/s
[Step=68600 Epoch=264.1] | Loss=0.00037 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=18.254 | 4515.9 samples/s | 70.6 steps/s
[Step=68650 Epoch=264.3] | Loss=0.00027 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=18.252 | 4598.2 samples/s | 71.8 steps/s
[Step=68700 Epoch=264.5] | Loss=0.00020 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=18.251 | 4596.2 samples/s | 71.8 steps/s
[Step=68750 Epoch=264.6] | Loss=0.00017 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=18.251 | 5936.7 samples/s | 92.8 steps/s
[Step=68800 Epoch=264.8] | Loss=0.00014 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.907 | L2-Norm(final)=18.251 | 1976.0 samples/s | 30.9 steps/s
[Step=68850 Epoch=265.0] | Loss=0.00012 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=18.251 | 4592.2 samples/s | 71.8 steps/s
[Step=68900 Epoch=265.2] | Loss=0.00011 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=18.251 | 4701.6 samples/s | 73.5 steps/s
[Step=68950 Epoch=265.4] | Loss=0.00010 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=18.252 | 4501.1 samples/s | 70.3 steps/s
[Step=69000 Epoch=265.6] | Loss=0.00009 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.902 | L2-Norm(final)=18.252 | 5284.0 samples/s | 82.6 steps/s
[Step=69050 Epoch=265.8] | Loss=0.00008 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=18.252 | 2021.9 samples/s | 31.6 steps/s
[Step=69100 Epoch=266.0] | Loss=0.00007 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.898 | L2-Norm(final)=18.253 | 4518.9 samples/s | 70.6 steps/s
[Step=69150 Epoch=266.2] | Loss=0.00007 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.895 | L2-Norm(final)=18.253 | 4458.6 samples/s | 69.7 steps/s
[Step=69200 Epoch=266.4] | Loss=0.00006 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.893 | L2-Norm(final)=18.253 | 4497.1 samples/s | 70.3 steps/s
[Step=69250 Epoch=266.6] | Loss=0.00006 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=18.254 | 4570.6 samples/s | 71.4 steps/s
[Step=69300 Epoch=266.8] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.887 | L2-Norm(final)=18.254 | 2107.8 samples/s | 32.9 steps/s
[Step=69350 Epoch=267.0] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=18.254 | 4468.8 samples/s | 69.8 steps/s
[Step=69400 Epoch=267.1] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=18.255 | 4522.9 samples/s | 70.7 steps/s
[Step=69450 Epoch=267.3] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.879 | L2-Norm(final)=18.255 | 4465.9 samples/s | 69.8 steps/s
[Step=69500 Epoch=267.5] | Loss=0.00004 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.876 | L2-Norm(final)=18.255 | 4481.6 samples/s | 70.0 steps/s
[Step=69550 Epoch=267.7] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=18.256 | 2118.4 samples/s | 33.1 steps/s
[Step=69600 Epoch=267.9] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.869 | L2-Norm(final)=18.256 | 4486.3 samples/s | 70.1 steps/s
[Step=69650 Epoch=268.1] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.866 | L2-Norm(final)=18.256 | 4484.6 samples/s | 70.1 steps/s
[Step=69700 Epoch=268.3] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.863 | L2-Norm(final)=18.257 | 4556.1 samples/s | 71.2 steps/s
[Step=69750 Epoch=268.5] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.860 | L2-Norm(final)=18.257 | 4423.2 samples/s | 69.1 steps/s
[Step=69800 Epoch=268.7] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.856 | L2-Norm(final)=18.257 | 6595.4 samples/s | 103.1 steps/s
[Step=69850 Epoch=268.9] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.853 | L2-Norm(final)=18.257 | 1825.7 samples/s | 28.5 steps/s
[Step=69900 Epoch=269.1] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.849 | L2-Norm(final)=18.258 | 4493.5 samples/s | 70.2 steps/s
[Step=69950 Epoch=269.3] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.846 | L2-Norm(final)=18.258 | 4503.3 samples/s | 70.4 steps/s
[Step=70000 Epoch=269.5] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=18.258 | 4469.8 samples/s | 69.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step70000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06542 | acc=0.9710 | tpr=0.9774 | fpr=0.0429 | 4378.5 samples/s | 17.1 steps/s
Avg test loss: 0.06614, Avg test acc: 0.97039, Avg tpr: 0.97721, Avg fpr: 0.04461, total FA: 348

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06627 | acc=0.9708 | tpr=0.9765 | fpr=0.0416 | 4364.8 samples/s | 17.1 steps/s
Avg test loss: 0.06693, Avg test acc: 0.97139, Avg tpr: 0.97762, Avg fpr: 0.04230, total FA: 330

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.25218 | acc=0.3158 | tpr=0.0072 | fpr=0.0141 | 4394.3 samples/s | 17.2 steps/s
Avg test loss: 6.27261, Avg test acc: 0.31341, Avg tpr: 0.00781, Avg fpr: 0.01449, total FA: 113

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.87614 | acc=0.3111 | tpr=0.0080 | fpr=0.0307 | 4451.7 samples/s | 17.4 steps/s
Avg test loss: 5.89432, Avg test acc: 0.30852, Avg tpr: 0.00839, Avg fpr: 0.03141, total FA: 245

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.65301 | acc=0.1219 | tpr=0.7035 | fpr=0.8886 | 4480.2 samples/s | 17.5 steps/s
[Step= 100] | Loss=5.63544 | acc=0.1215 | tpr=0.6994 | fpr=0.8893 | 8166.6 samples/s | 31.9 steps/s
[Step= 150] | Loss=5.64600 | acc=0.1212 | tpr=0.7032 | fpr=0.8895 | 8226.3 samples/s | 32.1 steps/s
[Step= 200] | Loss=5.64804 | acc=0.1207 | tpr=0.6907 | fpr=0.8896 | 8554.0 samples/s | 33.4 steps/s
[Step= 250] | Loss=5.65868 | acc=0.1207 | tpr=0.6934 | fpr=0.8897 | 8637.8 samples/s | 33.7 steps/s
[Step= 300] | Loss=5.65556 | acc=0.1206 | tpr=0.6909 | fpr=0.8898 | 8143.6 samples/s | 31.8 steps/s
[Step= 350] | Loss=5.65621 | acc=0.1201 | tpr=0.6938 | fpr=0.8903 | 8389.1 samples/s | 32.8 steps/s
[Step= 400] | Loss=5.66145 | acc=0.1200 | tpr=0.6931 | fpr=0.8904 | 8611.4 samples/s | 33.6 steps/s
[Step= 450] | Loss=5.66384 | acc=0.1201 | tpr=0.6957 | fpr=0.8904 | 8314.5 samples/s | 32.5 steps/s
[Step= 500] | Loss=5.66347 | acc=0.1201 | tpr=0.7000 | fpr=0.8904 | 8497.2 samples/s | 33.2 steps/s
[Step= 550] | Loss=5.66856 | acc=0.1200 | tpr=0.6936 | fpr=0.8904 | 14799.9 samples/s | 57.8 steps/s
Avg test loss: 5.66856, Avg test acc: 0.11986, Avg tpr: 0.69334, Avg fpr: 0.89056, total FA: 123653

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.85387 | acc=0.1252 | tpr=0.7035 | fpr=0.8852 | 4430.6 samples/s | 17.3 steps/s
[Step= 100] | Loss=5.83126 | acc=0.1254 | tpr=0.7122 | fpr=0.8856 | 8586.1 samples/s | 33.5 steps/s
[Step= 150] | Loss=5.83446 | acc=0.1255 | tpr=0.7219 | fpr=0.8855 | 8791.9 samples/s | 34.3 steps/s
[Step= 200] | Loss=5.83067 | acc=0.1251 | tpr=0.7093 | fpr=0.8855 | 8013.8 samples/s | 31.3 steps/s
[Step= 250] | Loss=5.84251 | acc=0.1250 | tpr=0.7109 | fpr=0.8857 | 8493.8 samples/s | 33.2 steps/s
[Step= 300] | Loss=5.83838 | acc=0.1247 | tpr=0.7105 | fpr=0.8860 | 8352.3 samples/s | 32.6 steps/s
[Step= 350] | Loss=5.83609 | acc=0.1240 | tpr=0.7063 | fpr=0.8865 | 8495.2 samples/s | 33.2 steps/s
[Step= 400] | Loss=5.84213 | acc=0.1241 | tpr=0.7035 | fpr=0.8864 | 8443.8 samples/s | 33.0 steps/s
[Step= 450] | Loss=5.84405 | acc=0.1241 | tpr=0.7064 | fpr=0.8865 | 8300.6 samples/s | 32.4 steps/s
[Step= 500] | Loss=5.84346 | acc=0.1240 | tpr=0.7088 | fpr=0.8866 | 8321.6 samples/s | 32.5 steps/s
[Step= 550] | Loss=5.84793 | acc=0.1240 | tpr=0.7055 | fpr=0.8866 | 15578.4 samples/s | 60.9 steps/s
Avg test loss: 5.84782, Avg test acc: 0.12389, Avg tpr: 0.70523, Avg fpr: 0.88668, total FA: 123114

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12546 | acc=0.9827 | tpr=0.9381 | fpr=0.0165 | 4453.0 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.13326 | acc=0.9822 | tpr=0.9552 | fpr=0.0173 | 8363.6 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.13804 | acc=0.9814 | tpr=0.9582 | fpr=0.0182 | 8778.6 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.13986 | acc=0.9811 | tpr=0.9617 | fpr=0.0186 | 8265.3 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.13789 | acc=0.9812 | tpr=0.9607 | fpr=0.0184 | 8334.9 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.13973 | acc=0.9810 | tpr=0.9615 | fpr=0.0186 | 7232.6 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.14122 | acc=0.9809 | tpr=0.9612 | fpr=0.0188 | 8604.4 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.14247 | acc=0.9807 | tpr=0.9606 | fpr=0.0189 | 8202.6 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.14536 | acc=0.9804 | tpr=0.9591 | fpr=0.0192 | 8696.6 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.14474 | acc=0.9805 | tpr=0.9590 | fpr=0.0191 | 7835.9 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.14358 | acc=0.9805 | tpr=0.9558 | fpr=0.0190 | 15786.1 samples/s | 61.7 steps/s
Avg test loss: 0.14315, Avg test acc: 0.98058, Avg tpr: 0.95602, Avg fpr: 0.01898, total FA: 2635

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13130 | acc=0.9820 | tpr=0.9381 | fpr=0.0172 | 4468.5 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.14019 | acc=0.9818 | tpr=0.9552 | fpr=0.0177 | 8441.2 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.14508 | acc=0.9811 | tpr=0.9597 | fpr=0.0185 | 8224.2 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.14565 | acc=0.9812 | tpr=0.9628 | fpr=0.0185 | 8381.3 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.14403 | acc=0.9814 | tpr=0.9624 | fpr=0.0183 | 8556.7 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.14571 | acc=0.9813 | tpr=0.9644 | fpr=0.0184 | 8431.4 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.14759 | acc=0.9810 | tpr=0.9637 | fpr=0.0187 | 8551.4 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.14946 | acc=0.9808 | tpr=0.9623 | fpr=0.0189 | 8281.0 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.15253 | acc=0.9805 | tpr=0.9611 | fpr=0.0191 | 8512.4 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.15190 | acc=0.9805 | tpr=0.9608 | fpr=0.0191 | 8190.6 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.15071 | acc=0.9806 | tpr=0.9590 | fpr=0.0190 | 15078.8 samples/s | 58.9 steps/s
Avg test loss: 0.15032, Avg test acc: 0.98066, Avg tpr: 0.95840, Avg fpr: 0.01893, total FA: 2629

server round 35/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=70001 Epoch=136.5] | Loss=0.00234 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=17.716 | 4104.9 samples/s | 64.1 steps/s
[Step=70050 Epoch=136.6] | Loss=0.01025 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.906 | L2-Norm(final)=17.720 | 5365.2 samples/s | 83.8 steps/s
[Step=70100 Epoch=136.7] | Loss=0.01090 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.906 | L2-Norm(final)=17.723 | 5508.8 samples/s | 86.1 steps/s
[Step=70150 Epoch=136.8] | Loss=0.01064 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.906 | L2-Norm(final)=17.727 | 5349.3 samples/s | 83.6 steps/s
[Step=70200 Epoch=136.9] | Loss=0.01021 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.906 | L2-Norm(final)=17.731 | 5431.5 samples/s | 84.9 steps/s
[Step=70250 Epoch=137.0] | Loss=0.00992 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=17.737 | 5603.6 samples/s | 87.6 steps/s
[Step=70300 Epoch=137.1] | Loss=0.01012 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=17.742 | 5368.1 samples/s | 83.9 steps/s
[Step=70350 Epoch=137.2] | Loss=0.01024 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=17.748 | 5540.6 samples/s | 86.6 steps/s
[Step=70400 Epoch=137.3] | Loss=0.01018 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=17.753 | 5465.1 samples/s | 85.4 steps/s
[Step=70450 Epoch=137.4] | Loss=0.01042 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=17.759 | 5390.8 samples/s | 84.2 steps/s
[Step=70500 Epoch=137.5] | Loss=0.01049 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=17.764 | 6872.2 samples/s | 107.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=70501 Epoch=137.5] | Loss=0.00221 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=17.821 | 4177.9 samples/s | 65.3 steps/s
[Step=70550 Epoch=137.6] | Loss=0.01124 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.920 | L2-Norm(final)=17.824 | 4386.3 samples/s | 68.5 steps/s
[Step=70600 Epoch=137.7] | Loss=0.01009 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.932 | L2-Norm(final)=17.828 | 4739.3 samples/s | 74.1 steps/s
[Step=70650 Epoch=137.8] | Loss=0.00914 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.941 | L2-Norm(final)=17.833 | 4740.7 samples/s | 74.1 steps/s
[Step=70700 Epoch=137.9] | Loss=0.00946 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.949 | L2-Norm(final)=17.837 | 4801.5 samples/s | 75.0 steps/s
[Step=70750 Epoch=138.0] | Loss=0.00977 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.957 | L2-Norm(final)=17.840 | 4789.3 samples/s | 74.8 steps/s
[Step=70800 Epoch=138.1] | Loss=0.00962 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.964 | L2-Norm(final)=17.843 | 4783.9 samples/s | 74.7 steps/s
[Step=70850 Epoch=138.2] | Loss=0.00999 | Reg=0.00099 | acc=0.9531 | L2-Norm=9.970 | L2-Norm(final)=17.846 | 4777.0 samples/s | 74.6 steps/s
[Step=70900 Epoch=138.3] | Loss=0.00967 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=17.850 | 4840.5 samples/s | 75.6 steps/s
[Step=70950 Epoch=138.4] | Loss=0.00951 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.982 | L2-Norm(final)=17.853 | 4729.1 samples/s | 73.9 steps/s
[Step=71000 Epoch=138.5] | Loss=0.00912 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.987 | L2-Norm(final)=17.857 | 5842.3 samples/s | 91.3 steps/s
[Step=71050 Epoch=138.6] | Loss=0.00879 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.992 | L2-Norm(final)=17.860 | 1997.3 samples/s | 31.2 steps/s
[Step=71100 Epoch=138.7] | Loss=0.00858 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.996 | L2-Norm(final)=17.864 | 4702.0 samples/s | 73.5 steps/s
[Step=71150 Epoch=138.8] | Loss=0.00852 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.001 | L2-Norm(final)=17.867 | 4686.7 samples/s | 73.2 steps/s
[Step=71200 Epoch=138.9] | Loss=0.00843 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.005 | L2-Norm(final)=17.870 | 4753.4 samples/s | 74.3 steps/s
[Step=71250 Epoch=139.0] | Loss=0.00825 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.008 | L2-Norm(final)=17.873 | 4723.5 samples/s | 73.8 steps/s
[Step=71300 Epoch=139.1] | Loss=0.00809 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=17.876 | 4717.0 samples/s | 73.7 steps/s
[Step=71350 Epoch=139.2] | Loss=0.00801 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.015 | L2-Norm(final)=17.879 | 4760.0 samples/s | 74.4 steps/s
[Step=71400 Epoch=139.3] | Loss=0.00791 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.019 | L2-Norm(final)=17.882 | 4710.8 samples/s | 73.6 steps/s
[Step=71450 Epoch=139.4] | Loss=0.00783 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.022 | L2-Norm(final)=17.884 | 4730.6 samples/s | 73.9 steps/s
[Step=71500 Epoch=139.5] | Loss=0.00773 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=17.887 | 5058.1 samples/s | 79.0 steps/s
[Step=71550 Epoch=139.6] | Loss=0.00767 | Reg=0.00101 | acc=0.9688 | L2-Norm=10.028 | L2-Norm(final)=17.890 | 2064.9 samples/s | 32.3 steps/s
[Step=71600 Epoch=139.6] | Loss=0.00759 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.031 | L2-Norm(final)=17.893 | 4831.8 samples/s | 75.5 steps/s
[Step=71650 Epoch=139.7] | Loss=0.00749 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.034 | L2-Norm(final)=17.896 | 4702.1 samples/s | 73.5 steps/s
[Step=71700 Epoch=139.8] | Loss=0.00737 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.037 | L2-Norm(final)=17.899 | 4843.4 samples/s | 75.7 steps/s
[Step=71750 Epoch=139.9] | Loss=0.00727 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.040 | L2-Norm(final)=17.902 | 4788.3 samples/s | 74.8 steps/s
[Step=71800 Epoch=140.0] | Loss=0.00726 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.043 | L2-Norm(final)=17.905 | 4716.2 samples/s | 73.7 steps/s
[Step=71850 Epoch=140.1] | Loss=0.00732 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.045 | L2-Norm(final)=17.907 | 4755.6 samples/s | 74.3 steps/s
[Step=71900 Epoch=140.2] | Loss=0.00724 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.048 | L2-Norm(final)=17.910 | 4710.4 samples/s | 73.6 steps/s
[Step=71950 Epoch=140.3] | Loss=0.00716 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.050 | L2-Norm(final)=17.913 | 4760.7 samples/s | 74.4 steps/s
[Step=72000 Epoch=140.4] | Loss=0.00711 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.053 | L2-Norm(final)=17.916 | 4763.6 samples/s | 74.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step72000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=70001 Epoch=136.9] | Loss=0.00249 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=18.126 | 4285.0 samples/s | 67.0 steps/s
[Step=70050 Epoch=136.9] | Loss=0.01016 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=18.138 | 5418.7 samples/s | 84.7 steps/s
[Step=70100 Epoch=137.0] | Loss=0.00941 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=18.153 | 5497.3 samples/s | 85.9 steps/s
[Step=70150 Epoch=137.1] | Loss=0.00970 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.906 | L2-Norm(final)=18.167 | 5453.8 samples/s | 85.2 steps/s
[Step=70200 Epoch=137.2] | Loss=0.00959 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.906 | L2-Norm(final)=18.180 | 5496.7 samples/s | 85.9 steps/s
[Step=70250 Epoch=137.3] | Loss=0.00963 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=18.193 | 5375.0 samples/s | 84.0 steps/s
[Step=70300 Epoch=137.4] | Loss=0.00961 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=18.205 | 5528.6 samples/s | 86.4 steps/s
[Step=70350 Epoch=137.5] | Loss=0.00982 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.906 | L2-Norm(final)=18.216 | 5450.5 samples/s | 85.2 steps/s
[Step=70400 Epoch=137.6] | Loss=0.00993 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=18.228 | 5612.0 samples/s | 87.7 steps/s
[Step=70450 Epoch=137.7] | Loss=0.00986 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=18.239 | 5385.0 samples/s | 84.1 steps/s
[Step=70500 Epoch=137.8] | Loss=0.00985 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.906 | L2-Norm(final)=18.251 | 7010.1 samples/s | 109.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=70501 Epoch=137.8] | Loss=0.00882 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=18.362 | 4301.9 samples/s | 67.2 steps/s
[Step=70550 Epoch=137.9] | Loss=0.01072 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.921 | L2-Norm(final)=18.369 | 4598.7 samples/s | 71.9 steps/s
[Step=70600 Epoch=138.0] | Loss=0.00949 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.934 | L2-Norm(final)=18.374 | 4733.0 samples/s | 74.0 steps/s
[Step=70650 Epoch=138.1] | Loss=0.00933 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.945 | L2-Norm(final)=18.377 | 4701.3 samples/s | 73.5 steps/s
[Step=70700 Epoch=138.2] | Loss=0.00905 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.953 | L2-Norm(final)=18.381 | 4787.5 samples/s | 74.8 steps/s
[Step=70750 Epoch=138.3] | Loss=0.00904 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.959 | L2-Norm(final)=18.384 | 4766.7 samples/s | 74.5 steps/s
[Step=70800 Epoch=138.4] | Loss=0.00914 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.965 | L2-Norm(final)=18.387 | 4752.2 samples/s | 74.3 steps/s
[Step=70850 Epoch=138.5] | Loss=0.00869 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.970 | L2-Norm(final)=18.390 | 4834.2 samples/s | 75.5 steps/s
[Step=70900 Epoch=138.6] | Loss=0.00888 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.975 | L2-Norm(final)=18.394 | 4691.0 samples/s | 73.3 steps/s
[Step=70950 Epoch=138.7] | Loss=0.00895 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.980 | L2-Norm(final)=18.397 | 4758.7 samples/s | 74.4 steps/s
[Step=71000 Epoch=138.8] | Loss=0.00886 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.985 | L2-Norm(final)=18.401 | 5867.9 samples/s | 91.7 steps/s
[Step=71050 Epoch=138.9] | Loss=0.00842 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.990 | L2-Norm(final)=18.404 | 2033.2 samples/s | 31.8 steps/s
[Step=71100 Epoch=139.0] | Loss=0.00826 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.994 | L2-Norm(final)=18.408 | 4843.4 samples/s | 75.7 steps/s
[Step=71150 Epoch=139.1] | Loss=0.00798 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.998 | L2-Norm(final)=18.411 | 4786.3 samples/s | 74.8 steps/s
[Step=71200 Epoch=139.2] | Loss=0.00789 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.002 | L2-Norm(final)=18.415 | 4756.0 samples/s | 74.3 steps/s
[Step=71250 Epoch=139.3] | Loss=0.00775 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.006 | L2-Norm(final)=18.418 | 4809.5 samples/s | 75.1 steps/s
[Step=71300 Epoch=139.4] | Loss=0.00752 | Reg=0.00100 | acc=0.9688 | L2-Norm=10.010 | L2-Norm(final)=18.421 | 4793.0 samples/s | 74.9 steps/s
[Step=71350 Epoch=139.5] | Loss=0.00749 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.013 | L2-Norm(final)=18.425 | 4797.0 samples/s | 75.0 steps/s
[Step=71400 Epoch=139.6] | Loss=0.00750 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.016 | L2-Norm(final)=18.428 | 4779.9 samples/s | 74.7 steps/s
[Step=71450 Epoch=139.7] | Loss=0.00752 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.020 | L2-Norm(final)=18.431 | 4821.2 samples/s | 75.3 steps/s
[Step=71500 Epoch=139.8] | Loss=0.00741 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.023 | L2-Norm(final)=18.434 | 5162.0 samples/s | 80.7 steps/s
[Step=71550 Epoch=139.9] | Loss=0.00733 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.025 | L2-Norm(final)=18.437 | 2115.0 samples/s | 33.0 steps/s
[Step=71600 Epoch=140.0] | Loss=0.00721 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.028 | L2-Norm(final)=18.440 | 4748.8 samples/s | 74.2 steps/s
[Step=71650 Epoch=140.1] | Loss=0.00714 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.031 | L2-Norm(final)=18.443 | 4721.7 samples/s | 73.8 steps/s
[Step=71700 Epoch=140.2] | Loss=0.00703 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.034 | L2-Norm(final)=18.446 | 4807.5 samples/s | 75.1 steps/s
[Step=71750 Epoch=140.3] | Loss=0.00700 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.037 | L2-Norm(final)=18.449 | 4748.4 samples/s | 74.2 steps/s
[Step=71800 Epoch=140.4] | Loss=0.00687 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.039 | L2-Norm(final)=18.452 | 4786.3 samples/s | 74.8 steps/s
[Step=71850 Epoch=140.5] | Loss=0.00685 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.042 | L2-Norm(final)=18.455 | 4746.5 samples/s | 74.2 steps/s
[Step=71900 Epoch=140.6] | Loss=0.00680 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.044 | L2-Norm(final)=18.458 | 4714.4 samples/s | 73.7 steps/s
[Step=71950 Epoch=140.7] | Loss=0.00674 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.047 | L2-Norm(final)=18.461 | 4921.4 samples/s | 76.9 steps/s
[Step=72000 Epoch=140.8] | Loss=0.00661 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.049 | L2-Norm(final)=18.464 | 4780.4 samples/s | 74.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step72000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=70001 Epoch=268.2] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=18.337 | 4497.6 samples/s | 70.3 steps/s
[Step=70050 Epoch=268.4] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=18.337 | 4609.1 samples/s | 72.0 steps/s
[Step=70100 Epoch=268.6] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=18.339 | 5029.1 samples/s | 78.6 steps/s
[Step=70150 Epoch=268.8] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=18.340 | 5053.7 samples/s | 79.0 steps/s
[Step=70200 Epoch=269.0] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=18.341 | 5189.2 samples/s | 81.1 steps/s
[Step=70250 Epoch=269.2] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=18.342 | 6624.0 samples/s | 103.5 steps/s
[Step=70300 Epoch=269.4] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=18.343 | 2064.4 samples/s | 32.3 steps/s
[Step=70350 Epoch=269.6] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=18.344 | 5329.3 samples/s | 83.3 steps/s
[Step=70400 Epoch=269.7] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=18.345 | 5203.1 samples/s | 81.3 steps/s
[Step=70450 Epoch=269.9] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=18.346 | 4956.5 samples/s | 77.4 steps/s
[Step=70500 Epoch=270.1] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=18.347 | 5819.9 samples/s | 90.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=70501 Epoch=270.1] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=18.357 | 4361.5 samples/s | 68.1 steps/s
[Step=70550 Epoch=270.3] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.902 | L2-Norm(final)=18.359 | 4202.4 samples/s | 65.7 steps/s
[Step=70600 Epoch=270.5] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.898 | L2-Norm(final)=18.359 | 4613.0 samples/s | 72.1 steps/s
[Step=70650 Epoch=270.7] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.895 | L2-Norm(final)=18.360 | 4434.3 samples/s | 69.3 steps/s
[Step=70700 Epoch=270.9] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.891 | L2-Norm(final)=18.361 | 4496.7 samples/s | 70.3 steps/s
[Step=70750 Epoch=271.1] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.887 | L2-Norm(final)=18.361 | 5676.5 samples/s | 88.7 steps/s
[Step=70800 Epoch=271.3] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=18.362 | 1933.2 samples/s | 30.2 steps/s
[Step=70850 Epoch=271.5] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.878 | L2-Norm(final)=18.363 | 4540.2 samples/s | 70.9 steps/s
[Step=70900 Epoch=271.7] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=18.363 | 4451.1 samples/s | 69.5 steps/s
[Step=70950 Epoch=271.9] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.869 | L2-Norm(final)=18.364 | 4497.5 samples/s | 70.3 steps/s
[Step=71000 Epoch=272.0] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.864 | L2-Norm(final)=18.364 | 4936.2 samples/s | 77.1 steps/s
[Step=71050 Epoch=272.2] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.859 | L2-Norm(final)=18.365 | 2051.3 samples/s | 32.1 steps/s
[Step=71100 Epoch=272.4] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.854 | L2-Norm(final)=18.366 | 4684.8 samples/s | 73.2 steps/s
[Step=71150 Epoch=272.6] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.850 | L2-Norm(final)=18.366 | 4600.3 samples/s | 71.9 steps/s
[Step=71200 Epoch=272.8] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=18.367 | 4487.4 samples/s | 70.1 steps/s
[Step=71250 Epoch=273.0] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=18.367 | 4605.9 samples/s | 72.0 steps/s
[Step=71300 Epoch=273.2] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.835 | L2-Norm(final)=18.368 | 2144.8 samples/s | 33.5 steps/s
[Step=71350 Epoch=273.4] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.830 | L2-Norm(final)=18.368 | 4675.3 samples/s | 73.1 steps/s
[Step=71400 Epoch=273.6] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.825 | L2-Norm(final)=18.369 | 4490.0 samples/s | 70.2 steps/s
[Step=71450 Epoch=273.8] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.820 | L2-Norm(final)=18.370 | 4532.9 samples/s | 70.8 steps/s
[Step=71500 Epoch=274.0] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.815 | L2-Norm(final)=18.370 | 4485.6 samples/s | 70.1 steps/s
[Step=71550 Epoch=274.2] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.810 | L2-Norm(final)=18.371 | 2162.9 samples/s | 33.8 steps/s
[Step=71600 Epoch=274.3] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.804 | L2-Norm(final)=18.371 | 4634.4 samples/s | 72.4 steps/s
[Step=71650 Epoch=274.5] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.799 | L2-Norm(final)=18.372 | 4503.7 samples/s | 70.4 steps/s
[Step=71700 Epoch=274.7] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.794 | L2-Norm(final)=18.373 | 4555.1 samples/s | 71.2 steps/s
[Step=71750 Epoch=274.9] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.788 | L2-Norm(final)=18.373 | 4562.6 samples/s | 71.3 steps/s
[Step=71800 Epoch=275.1] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.783 | L2-Norm(final)=18.374 | 6101.4 samples/s | 95.3 steps/s
[Step=71850 Epoch=275.3] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.777 | L2-Norm(final)=18.375 | 1916.6 samples/s | 29.9 steps/s
[Step=71900 Epoch=275.5] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.771 | L2-Norm(final)=18.375 | 4577.3 samples/s | 71.5 steps/s
[Step=71950 Epoch=275.7] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.766 | L2-Norm(final)=18.376 | 4451.8 samples/s | 69.6 steps/s
[Step=72000 Epoch=275.9] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.760 | L2-Norm(final)=18.376 | 4535.2 samples/s | 70.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step72000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=70001 Epoch=269.5] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=18.266 | 4491.9 samples/s | 70.2 steps/s
[Step=70050 Epoch=269.6] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=18.267 | 4488.4 samples/s | 70.1 steps/s
[Step=70100 Epoch=269.8] | Loss=0.00004 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=18.269 | 5071.7 samples/s | 79.2 steps/s
[Step=70150 Epoch=270.0] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=18.271 | 5185.4 samples/s | 81.0 steps/s
[Step=70200 Epoch=270.2] | Loss=0.00004 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=18.273 | 5120.5 samples/s | 80.0 steps/s
[Step=70250 Epoch=270.4] | Loss=0.00004 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=18.276 | 6810.0 samples/s | 106.4 steps/s
[Step=70300 Epoch=270.6] | Loss=0.00004 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=18.278 | 2018.2 samples/s | 31.5 steps/s
[Step=70350 Epoch=270.8] | Loss=0.00004 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=18.281 | 5138.2 samples/s | 80.3 steps/s
[Step=70400 Epoch=271.0] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=18.283 | 5303.5 samples/s | 82.9 steps/s
[Step=70450 Epoch=271.2] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=18.285 | 5103.5 samples/s | 79.7 steps/s
[Step=70500 Epoch=271.4] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=18.287 | 5770.9 samples/s | 90.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=70501 Epoch=271.4] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=18.312 | 4036.5 samples/s | 63.1 steps/s
[Step=70550 Epoch=271.6] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=18.315 | 4446.2 samples/s | 69.5 steps/s
[Step=70600 Epoch=271.8] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.898 | L2-Norm(final)=18.317 | 4506.5 samples/s | 70.4 steps/s
[Step=70650 Epoch=272.0] | Loss=0.00004 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.895 | L2-Norm(final)=18.319 | 4410.2 samples/s | 68.9 steps/s
[Step=70700 Epoch=272.2] | Loss=0.00024 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.896 | L2-Norm(final)=18.319 | 4583.2 samples/s | 71.6 steps/s
[Step=70750 Epoch=272.3] | Loss=0.00020 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.897 | L2-Norm(final)=18.319 | 5641.3 samples/s | 88.1 steps/s
[Step=70800 Epoch=272.5] | Loss=0.00017 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.897 | L2-Norm(final)=18.318 | 1955.7 samples/s | 30.6 steps/s
[Step=70850 Epoch=272.7] | Loss=0.00015 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.896 | L2-Norm(final)=18.318 | 4665.2 samples/s | 72.9 steps/s
[Step=70900 Epoch=272.9] | Loss=0.00013 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.895 | L2-Norm(final)=18.318 | 4567.7 samples/s | 71.4 steps/s
[Step=70950 Epoch=273.1] | Loss=0.00011 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.892 | L2-Norm(final)=18.318 | 4553.4 samples/s | 71.1 steps/s
[Step=71000 Epoch=273.3] | Loss=0.00010 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=18.318 | 5149.6 samples/s | 80.5 steps/s
[Step=71050 Epoch=273.5] | Loss=0.00009 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.887 | L2-Norm(final)=18.319 | 2020.6 samples/s | 31.6 steps/s
[Step=71100 Epoch=273.7] | Loss=0.00009 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.884 | L2-Norm(final)=18.319 | 4752.4 samples/s | 74.3 steps/s
[Step=71150 Epoch=273.9] | Loss=0.00008 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.881 | L2-Norm(final)=18.319 | 4592.9 samples/s | 71.8 steps/s
[Step=71200 Epoch=274.1] | Loss=0.00007 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.878 | L2-Norm(final)=18.319 | 4472.0 samples/s | 69.9 steps/s
[Step=71250 Epoch=274.3] | Loss=0.00007 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=18.319 | 4620.1 samples/s | 72.2 steps/s
[Step=71300 Epoch=274.5] | Loss=0.00007 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.871 | L2-Norm(final)=18.319 | 2107.2 samples/s | 32.9 steps/s
[Step=71350 Epoch=274.7] | Loss=0.00006 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.868 | L2-Norm(final)=18.320 | 4470.6 samples/s | 69.9 steps/s
[Step=71400 Epoch=274.8] | Loss=0.00006 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.864 | L2-Norm(final)=18.320 | 4517.0 samples/s | 70.6 steps/s
[Step=71450 Epoch=275.0] | Loss=0.00006 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.861 | L2-Norm(final)=18.320 | 4482.3 samples/s | 70.0 steps/s
[Step=71500 Epoch=275.2] | Loss=0.00005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.857 | L2-Norm(final)=18.320 | 4483.2 samples/s | 70.1 steps/s
[Step=71550 Epoch=275.4] | Loss=0.00005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.853 | L2-Norm(final)=18.320 | 2120.7 samples/s | 33.1 steps/s
[Step=71600 Epoch=275.6] | Loss=0.00005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.849 | L2-Norm(final)=18.321 | 4515.0 samples/s | 70.5 steps/s
[Step=71650 Epoch=275.8] | Loss=0.00005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=18.321 | 4418.2 samples/s | 69.0 steps/s
[Step=71700 Epoch=276.0] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.841 | L2-Norm(final)=18.321 | 4469.0 samples/s | 69.8 steps/s
[Step=71750 Epoch=276.2] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.837 | L2-Norm(final)=18.321 | 4472.7 samples/s | 69.9 steps/s
[Step=71800 Epoch=276.4] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.833 | L2-Norm(final)=18.321 | 6659.1 samples/s | 104.0 steps/s
[Step=71850 Epoch=276.6] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.829 | L2-Norm(final)=18.322 | 1835.7 samples/s | 28.7 steps/s
[Step=71900 Epoch=276.8] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.825 | L2-Norm(final)=18.322 | 4520.5 samples/s | 70.6 steps/s
[Step=71950 Epoch=277.0] | Loss=0.00004 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.821 | L2-Norm(final)=18.322 | 4556.4 samples/s | 71.2 steps/s
[Step=72000 Epoch=277.2] | Loss=0.00004 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=18.322 | 4442.1 samples/s | 69.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step72000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06579 | acc=0.9716 | tpr=0.9806 | fpr=0.0481 | 4414.9 samples/s | 17.2 steps/s
Avg test loss: 0.06638, Avg test acc: 0.97059, Avg tpr: 0.97995, Avg fpr: 0.04999, total FA: 390

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07273 | acc=0.9706 | tpr=0.9751 | fpr=0.0391 | 4503.1 samples/s | 17.6 steps/s
Avg test loss: 0.07387, Avg test acc: 0.97091, Avg tpr: 0.97639, Avg fpr: 0.04115, total FA: 321

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.55153 | acc=0.3157 | tpr=0.0103 | fpr=0.0211 | 4516.8 samples/s | 17.6 steps/s
Avg test loss: 5.56814, Avg test acc: 0.31325, Avg tpr: 0.01037, Avg fpr: 0.02064, total FA: 161

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.57749 | acc=0.3123 | tpr=0.0146 | fpr=0.0414 | 4472.1 samples/s | 17.5 steps/s
Avg test loss: 5.59143, Avg test acc: 0.30960, Avg tpr: 0.01463, Avg fpr: 0.04166, total FA: 325

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.96331 | acc=0.1137 | tpr=0.7080 | fpr=0.8970 | 4403.0 samples/s | 17.2 steps/s
[Step= 100] | Loss=5.94415 | acc=0.1131 | tpr=0.6994 | fpr=0.8978 | 8516.0 samples/s | 33.3 steps/s
[Step= 150] | Loss=5.95501 | acc=0.1126 | tpr=0.7089 | fpr=0.8984 | 8428.9 samples/s | 32.9 steps/s
[Step= 200] | Loss=5.95650 | acc=0.1127 | tpr=0.6951 | fpr=0.8979 | 8491.9 samples/s | 33.2 steps/s
[Step= 250] | Loss=5.96680 | acc=0.1123 | tpr=0.6978 | fpr=0.8984 | 8700.5 samples/s | 34.0 steps/s
[Step= 300] | Loss=5.96376 | acc=0.1119 | tpr=0.6953 | fpr=0.8987 | 8299.6 samples/s | 32.4 steps/s
[Step= 350] | Loss=5.96446 | acc=0.1114 | tpr=0.6976 | fpr=0.8993 | 8731.4 samples/s | 34.1 steps/s
[Step= 400] | Loss=5.97055 | acc=0.1114 | tpr=0.6958 | fpr=0.8992 | 8218.5 samples/s | 32.1 steps/s
[Step= 450] | Loss=5.97322 | acc=0.1117 | tpr=0.6991 | fpr=0.8990 | 8253.6 samples/s | 32.2 steps/s
[Step= 500] | Loss=5.97203 | acc=0.1115 | tpr=0.7013 | fpr=0.8991 | 8510.3 samples/s | 33.2 steps/s
[Step= 550] | Loss=5.97722 | acc=0.1115 | tpr=0.6976 | fpr=0.8992 | 15933.7 samples/s | 62.2 steps/s
Avg test loss: 5.97718, Avg test acc: 0.11136, Avg tpr: 0.69731, Avg fpr: 0.89929, total FA: 124865

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.95218 | acc=0.1373 | tpr=0.6726 | fpr=0.8723 | 4436.0 samples/s | 17.3 steps/s
[Step= 100] | Loss=5.93128 | acc=0.1377 | tpr=0.6887 | fpr=0.8726 | 8459.1 samples/s | 33.0 steps/s
[Step= 150] | Loss=5.93726 | acc=0.1376 | tpr=0.7003 | fpr=0.8728 | 8364.6 samples/s | 32.7 steps/s
[Step= 200] | Loss=5.93464 | acc=0.1375 | tpr=0.6896 | fpr=0.8726 | 8128.8 samples/s | 31.8 steps/s
[Step= 250] | Loss=5.94774 | acc=0.1373 | tpr=0.6926 | fpr=0.8728 | 8624.6 samples/s | 33.7 steps/s
[Step= 300] | Loss=5.94340 | acc=0.1373 | tpr=0.6880 | fpr=0.8727 | 8078.5 samples/s | 31.6 steps/s
[Step= 350] | Loss=5.94069 | acc=0.1365 | tpr=0.6813 | fpr=0.8734 | 8348.5 samples/s | 32.6 steps/s
[Step= 400] | Loss=5.94635 | acc=0.1365 | tpr=0.6833 | fpr=0.8735 | 8291.0 samples/s | 32.4 steps/s
[Step= 450] | Loss=5.94769 | acc=0.1363 | tpr=0.6865 | fpr=0.8736 | 8337.3 samples/s | 32.6 steps/s
[Step= 500] | Loss=5.94753 | acc=0.1361 | tpr=0.6885 | fpr=0.8738 | 8609.7 samples/s | 33.6 steps/s
[Step= 550] | Loss=5.95229 | acc=0.1361 | tpr=0.6868 | fpr=0.8739 | 14518.9 samples/s | 56.7 steps/s
Avg test loss: 5.95213, Avg test acc: 0.13600, Avg tpr: 0.68661, Avg fpr: 0.87401, total FA: 121355

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11339 | acc=0.9823 | tpr=0.9381 | fpr=0.0169 | 4519.7 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.12073 | acc=0.9821 | tpr=0.9552 | fpr=0.0174 | 8216.1 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.12399 | acc=0.9815 | tpr=0.9611 | fpr=0.0182 | 8885.2 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.12469 | acc=0.9815 | tpr=0.9628 | fpr=0.0182 | 8105.4 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.12346 | acc=0.9816 | tpr=0.9616 | fpr=0.0180 | 8376.8 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.12446 | acc=0.9816 | tpr=0.9629 | fpr=0.0180 | 8350.4 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.12588 | acc=0.9814 | tpr=0.9624 | fpr=0.0182 | 8393.4 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.12753 | acc=0.9813 | tpr=0.9617 | fpr=0.0183 | 8532.9 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.13013 | acc=0.9810 | tpr=0.9606 | fpr=0.0187 | 8320.7 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.12976 | acc=0.9810 | tpr=0.9604 | fpr=0.0187 | 8508.2 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.12881 | acc=0.9811 | tpr=0.9570 | fpr=0.0185 | 15756.9 samples/s | 61.6 steps/s
Avg test loss: 0.12845, Avg test acc: 0.98108, Avg tpr: 0.95721, Avg fpr: 0.01849, total FA: 2567

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11572 | acc=0.9834 | tpr=0.9425 | fpr=0.0159 | 4456.2 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.12170 | acc=0.9831 | tpr=0.9616 | fpr=0.0165 | 8368.4 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.12645 | acc=0.9825 | tpr=0.9640 | fpr=0.0172 | 8302.4 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.12762 | acc=0.9823 | tpr=0.9650 | fpr=0.0174 | 8437.8 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.12662 | acc=0.9825 | tpr=0.9624 | fpr=0.0172 | 8317.1 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.12746 | acc=0.9826 | tpr=0.9644 | fpr=0.0171 | 8437.2 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.12875 | acc=0.9824 | tpr=0.9656 | fpr=0.0173 | 8413.0 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.13032 | acc=0.9822 | tpr=0.9644 | fpr=0.0174 | 8324.2 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.13295 | acc=0.9820 | tpr=0.9625 | fpr=0.0176 | 8341.0 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.13292 | acc=0.9820 | tpr=0.9621 | fpr=0.0177 | 8288.6 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.13191 | acc=0.9821 | tpr=0.9598 | fpr=0.0175 | 15748.7 samples/s | 61.5 steps/s
Avg test loss: 0.13161, Avg test acc: 0.98207, Avg tpr: 0.95959, Avg fpr: 0.01752, total FA: 2433

server round 36/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=72001 Epoch=140.4] | Loss=0.00832 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=18.001 | 4222.4 samples/s | 66.0 steps/s
[Step=72050 Epoch=140.5] | Loss=0.00901 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.843 | L2-Norm(final)=18.005 | 5138.8 samples/s | 80.3 steps/s
[Step=72100 Epoch=140.6] | Loss=0.00932 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.843 | L2-Norm(final)=18.008 | 5318.9 samples/s | 83.1 steps/s
[Step=72150 Epoch=140.7] | Loss=0.00898 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.843 | L2-Norm(final)=18.011 | 5596.1 samples/s | 87.4 steps/s
[Step=72200 Epoch=140.8] | Loss=0.00843 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.843 | L2-Norm(final)=18.014 | 5652.9 samples/s | 88.3 steps/s
[Step=72250 Epoch=140.9] | Loss=0.00817 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.843 | L2-Norm(final)=18.018 | 5588.1 samples/s | 87.3 steps/s
[Step=72300 Epoch=141.0] | Loss=0.00849 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.843 | L2-Norm(final)=18.021 | 5350.0 samples/s | 83.6 steps/s
[Step=72350 Epoch=141.1] | Loss=0.00834 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.843 | L2-Norm(final)=18.024 | 5460.6 samples/s | 85.3 steps/s
[Step=72400 Epoch=141.2] | Loss=0.00821 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.843 | L2-Norm(final)=18.028 | 5670.3 samples/s | 88.6 steps/s
[Step=72450 Epoch=141.3] | Loss=0.00844 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.843 | L2-Norm(final)=18.032 | 5563.1 samples/s | 86.9 steps/s
[Step=72500 Epoch=141.4] | Loss=0.00838 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.843 | L2-Norm(final)=18.036 | 7047.9 samples/s | 110.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=72501 Epoch=141.4] | Loss=0.00016 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.843 | L2-Norm(final)=18.079 | 4061.4 samples/s | 63.5 steps/s
[Step=72550 Epoch=141.5] | Loss=0.00952 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.851 | L2-Norm(final)=18.082 | 4719.9 samples/s | 73.7 steps/s
[Step=72600 Epoch=141.6] | Loss=0.00993 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.859 | L2-Norm(final)=18.085 | 4625.3 samples/s | 72.3 steps/s
[Step=72650 Epoch=141.7] | Loss=0.01000 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.866 | L2-Norm(final)=18.088 | 4669.5 samples/s | 73.0 steps/s
[Step=72700 Epoch=141.8] | Loss=0.01000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=18.092 | 4885.8 samples/s | 76.3 steps/s
[Step=72750 Epoch=141.9] | Loss=0.00947 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.880 | L2-Norm(final)=18.095 | 4925.8 samples/s | 77.0 steps/s
[Step=72800 Epoch=142.0] | Loss=0.00919 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.887 | L2-Norm(final)=18.098 | 4816.6 samples/s | 75.3 steps/s
[Step=72850 Epoch=142.1] | Loss=0.00867 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.893 | L2-Norm(final)=18.102 | 4587.1 samples/s | 71.7 steps/s
[Step=72900 Epoch=142.2] | Loss=0.00879 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.898 | L2-Norm(final)=18.105 | 4158.8 samples/s | 65.0 steps/s
[Step=72950 Epoch=142.3] | Loss=0.00889 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=18.108 | 4173.3 samples/s | 65.2 steps/s
[Step=73000 Epoch=142.4] | Loss=0.00882 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.909 | L2-Norm(final)=18.111 | 5015.1 samples/s | 78.4 steps/s
[Step=73050 Epoch=142.5] | Loss=0.00856 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.914 | L2-Norm(final)=18.114 | 1724.9 samples/s | 27.0 steps/s
[Step=73100 Epoch=142.6] | Loss=0.00833 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.919 | L2-Norm(final)=18.118 | 4189.7 samples/s | 65.5 steps/s
[Step=73150 Epoch=142.7] | Loss=0.00818 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.923 | L2-Norm(final)=18.121 | 4196.3 samples/s | 65.6 steps/s
[Step=73200 Epoch=142.8] | Loss=0.00803 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.927 | L2-Norm(final)=18.124 | 4316.0 samples/s | 67.4 steps/s
[Step=73250 Epoch=142.9] | Loss=0.00796 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.931 | L2-Norm(final)=18.127 | 4300.9 samples/s | 67.2 steps/s
[Step=73300 Epoch=143.0] | Loss=0.00789 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.934 | L2-Norm(final)=18.130 | 4745.8 samples/s | 74.2 steps/s
[Step=73350 Epoch=143.1] | Loss=0.00780 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.938 | L2-Norm(final)=18.133 | 4785.1 samples/s | 74.8 steps/s
[Step=73400 Epoch=143.2] | Loss=0.00773 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.941 | L2-Norm(final)=18.136 | 4860.2 samples/s | 75.9 steps/s
[Step=73450 Epoch=143.3] | Loss=0.00765 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.944 | L2-Norm(final)=18.139 | 4815.3 samples/s | 75.2 steps/s
[Step=73500 Epoch=143.4] | Loss=0.00767 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.948 | L2-Norm(final)=18.142 | 4940.7 samples/s | 77.2 steps/s
[Step=73550 Epoch=143.5] | Loss=0.00759 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.951 | L2-Norm(final)=18.144 | 2104.6 samples/s | 32.9 steps/s
[Step=73600 Epoch=143.5] | Loss=0.00747 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.954 | L2-Norm(final)=18.147 | 4884.7 samples/s | 76.3 steps/s
[Step=73650 Epoch=143.6] | Loss=0.00740 | Reg=0.00099 | acc=0.9688 | L2-Norm=9.956 | L2-Norm(final)=18.150 | 4875.3 samples/s | 76.2 steps/s
[Step=73700 Epoch=143.7] | Loss=0.00729 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.959 | L2-Norm(final)=18.153 | 4841.2 samples/s | 75.6 steps/s
[Step=73750 Epoch=143.8] | Loss=0.00718 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.962 | L2-Norm(final)=18.155 | 4765.5 samples/s | 74.5 steps/s
[Step=73800 Epoch=143.9] | Loss=0.00715 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.964 | L2-Norm(final)=18.158 | 4817.4 samples/s | 75.3 steps/s
[Step=73850 Epoch=144.0] | Loss=0.00704 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.967 | L2-Norm(final)=18.161 | 4987.9 samples/s | 77.9 steps/s
[Step=73900 Epoch=144.1] | Loss=0.00698 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.970 | L2-Norm(final)=18.163 | 4824.8 samples/s | 75.4 steps/s
[Step=73950 Epoch=144.2] | Loss=0.00690 | Reg=0.00099 | acc=0.9688 | L2-Norm=9.972 | L2-Norm(final)=18.166 | 4912.5 samples/s | 76.8 steps/s
[Step=74000 Epoch=144.3] | Loss=0.00688 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.974 | L2-Norm(final)=18.169 | 4971.7 samples/s | 77.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step74000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=72001 Epoch=140.8] | Loss=0.00571 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=18.551 | 4241.6 samples/s | 66.3 steps/s
[Step=72050 Epoch=140.9] | Loss=0.00855 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=18.557 | 5479.5 samples/s | 85.6 steps/s
[Step=72100 Epoch=141.0] | Loss=0.00804 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=18.564 | 5500.3 samples/s | 85.9 steps/s
[Step=72150 Epoch=141.1] | Loss=0.00754 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=18.572 | 5393.0 samples/s | 84.3 steps/s
[Step=72200 Epoch=141.1] | Loss=0.00763 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=18.580 | 5456.6 samples/s | 85.3 steps/s
[Step=72250 Epoch=141.2] | Loss=0.00780 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=18.589 | 5461.7 samples/s | 85.3 steps/s
[Step=72300 Epoch=141.3] | Loss=0.00805 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.842 | L2-Norm(final)=18.597 | 5442.7 samples/s | 85.0 steps/s
[Step=72350 Epoch=141.4] | Loss=0.00793 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=18.604 | 5460.2 samples/s | 85.3 steps/s
[Step=72400 Epoch=141.5] | Loss=0.00785 | Reg=0.00097 | acc=0.9531 | L2-Norm=9.842 | L2-Norm(final)=18.612 | 5467.7 samples/s | 85.4 steps/s
[Step=72450 Epoch=141.6] | Loss=0.00785 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=18.620 | 5476.7 samples/s | 85.6 steps/s
[Step=72500 Epoch=141.7] | Loss=0.00795 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=18.627 | 7011.0 samples/s | 109.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=72501 Epoch=141.7] | Loss=0.00362 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=18.702 | 4658.2 samples/s | 72.8 steps/s
[Step=72550 Epoch=141.8] | Loss=0.00598 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.852 | L2-Norm(final)=18.709 | 4453.0 samples/s | 69.6 steps/s
[Step=72600 Epoch=141.9] | Loss=0.00708 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.863 | L2-Norm(final)=18.715 | 4783.1 samples/s | 74.7 steps/s
[Step=72650 Epoch=142.0] | Loss=0.00748 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=18.720 | 4783.7 samples/s | 74.7 steps/s
[Step=72700 Epoch=142.1] | Loss=0.00753 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.881 | L2-Norm(final)=18.725 | 4737.6 samples/s | 74.0 steps/s
[Step=72750 Epoch=142.2] | Loss=0.00774 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.888 | L2-Norm(final)=18.730 | 4799.0 samples/s | 75.0 steps/s
[Step=72800 Epoch=142.3] | Loss=0.00777 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.894 | L2-Norm(final)=18.734 | 4923.4 samples/s | 76.9 steps/s
[Step=72850 Epoch=142.4] | Loss=0.00814 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=18.738 | 4795.6 samples/s | 74.9 steps/s
[Step=72900 Epoch=142.5] | Loss=0.00814 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.906 | L2-Norm(final)=18.742 | 4779.8 samples/s | 74.7 steps/s
[Step=72950 Epoch=142.6] | Loss=0.00779 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.912 | L2-Norm(final)=18.746 | 4767.5 samples/s | 74.5 steps/s
[Step=73000 Epoch=142.7] | Loss=0.00799 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.917 | L2-Norm(final)=18.750 | 5858.0 samples/s | 91.5 steps/s
[Step=73050 Epoch=142.8] | Loss=0.00776 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.922 | L2-Norm(final)=18.754 | 2028.8 samples/s | 31.7 steps/s
[Step=73100 Epoch=142.9] | Loss=0.00743 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.927 | L2-Norm(final)=18.758 | 4682.8 samples/s | 73.2 steps/s
[Step=73150 Epoch=143.0] | Loss=0.00734 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.931 | L2-Norm(final)=18.762 | 4878.5 samples/s | 76.2 steps/s
[Step=73200 Epoch=143.1] | Loss=0.00732 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.935 | L2-Norm(final)=18.766 | 4811.6 samples/s | 75.2 steps/s
[Step=73250 Epoch=143.2] | Loss=0.00740 | Reg=0.00099 | acc=0.9688 | L2-Norm=9.939 | L2-Norm(final)=18.770 | 4873.2 samples/s | 76.1 steps/s
[Step=73300 Epoch=143.3] | Loss=0.00738 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.943 | L2-Norm(final)=18.773 | 4853.3 samples/s | 75.8 steps/s
[Step=73350 Epoch=143.4] | Loss=0.00725 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.947 | L2-Norm(final)=18.776 | 4729.0 samples/s | 73.9 steps/s
[Step=73400 Epoch=143.5] | Loss=0.00720 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.950 | L2-Norm(final)=18.779 | 4812.2 samples/s | 75.2 steps/s
[Step=73450 Epoch=143.6] | Loss=0.00721 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.953 | L2-Norm(final)=18.782 | 4806.0 samples/s | 75.1 steps/s
[Step=73500 Epoch=143.7] | Loss=0.00713 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.957 | L2-Norm(final)=18.785 | 5202.1 samples/s | 81.3 steps/s
[Step=73550 Epoch=143.8] | Loss=0.00703 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.960 | L2-Norm(final)=18.788 | 2088.4 samples/s | 32.6 steps/s
[Step=73600 Epoch=143.9] | Loss=0.00688 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.963 | L2-Norm(final)=18.792 | 4907.1 samples/s | 76.7 steps/s
[Step=73650 Epoch=144.0] | Loss=0.00681 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.966 | L2-Norm(final)=18.795 | 4797.2 samples/s | 75.0 steps/s
[Step=73700 Epoch=144.1] | Loss=0.00676 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.968 | L2-Norm(final)=18.797 | 4860.8 samples/s | 75.9 steps/s
[Step=73750 Epoch=144.2] | Loss=0.00666 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.971 | L2-Norm(final)=18.800 | 4949.6 samples/s | 77.3 steps/s
[Step=73800 Epoch=144.3] | Loss=0.00654 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.974 | L2-Norm(final)=18.804 | 4866.4 samples/s | 76.0 steps/s
[Step=73850 Epoch=144.4] | Loss=0.00650 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.977 | L2-Norm(final)=18.807 | 4907.6 samples/s | 76.7 steps/s
[Step=73900 Epoch=144.5] | Loss=0.00649 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=18.810 | 4961.3 samples/s | 77.5 steps/s
[Step=73950 Epoch=144.6] | Loss=0.00647 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.982 | L2-Norm(final)=18.813 | 4866.8 samples/s | 76.0 steps/s
[Step=74000 Epoch=144.7] | Loss=0.00650 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.985 | L2-Norm(final)=18.816 | 4958.9 samples/s | 77.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step74000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=72001 Epoch=275.9] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=18.396 | 4433.3 samples/s | 69.3 steps/s
[Step=72050 Epoch=276.1] | Loss=0.00005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=18.398 | 4843.0 samples/s | 75.7 steps/s
[Step=72100 Epoch=276.3] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.839 | L2-Norm(final)=18.401 | 5123.1 samples/s | 80.0 steps/s
[Step=72150 Epoch=276.5] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.839 | L2-Norm(final)=18.404 | 5104.4 samples/s | 79.8 steps/s
[Step=72200 Epoch=276.6] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.839 | L2-Norm(final)=18.406 | 5081.8 samples/s | 79.4 steps/s
[Step=72250 Epoch=276.8] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.839 | L2-Norm(final)=18.409 | 6726.5 samples/s | 105.1 steps/s
[Step=72300 Epoch=277.0] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.839 | L2-Norm(final)=18.411 | 2059.8 samples/s | 32.2 steps/s
[Step=72350 Epoch=277.2] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.839 | L2-Norm(final)=18.414 | 5194.1 samples/s | 81.2 steps/s
[Step=72400 Epoch=277.4] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.839 | L2-Norm(final)=18.417 | 5205.0 samples/s | 81.3 steps/s
[Step=72450 Epoch=277.6] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.839 | L2-Norm(final)=18.419 | 5075.9 samples/s | 79.3 steps/s
[Step=72500 Epoch=277.8] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.839 | L2-Norm(final)=18.422 | 5745.7 samples/s | 89.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=72501 Epoch=277.8] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.839 | L2-Norm(final)=18.449 | 4135.0 samples/s | 64.6 steps/s
[Step=72550 Epoch=278.0] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.838 | L2-Norm(final)=18.451 | 4484.5 samples/s | 70.1 steps/s
[Step=72600 Epoch=278.2] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.831 | L2-Norm(final)=18.453 | 4508.5 samples/s | 70.4 steps/s
[Step=72650 Epoch=278.4] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.823 | L2-Norm(final)=18.453 | 4548.4 samples/s | 71.1 steps/s
[Step=72700 Epoch=278.6] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.814 | L2-Norm(final)=18.454 | 4412.5 samples/s | 68.9 steps/s
[Step=72750 Epoch=278.8] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.804 | L2-Norm(final)=18.455 | 5679.8 samples/s | 88.7 steps/s
[Step=72800 Epoch=278.9] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.795 | L2-Norm(final)=18.455 | 1919.3 samples/s | 30.0 steps/s
[Step=72850 Epoch=279.1] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.784 | L2-Norm(final)=18.456 | 4503.9 samples/s | 70.4 steps/s
[Step=72900 Epoch=279.3] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.774 | L2-Norm(final)=18.457 | 4502.9 samples/s | 70.4 steps/s
[Step=72950 Epoch=279.5] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.764 | L2-Norm(final)=18.457 | 4511.5 samples/s | 70.5 steps/s
[Step=73000 Epoch=279.7] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.753 | L2-Norm(final)=18.458 | 4949.0 samples/s | 77.3 steps/s
[Step=73050 Epoch=279.9] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.743 | L2-Norm(final)=18.458 | 2052.9 samples/s | 32.1 steps/s
[Step=73100 Epoch=280.1] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.732 | L2-Norm(final)=18.459 | 4474.6 samples/s | 69.9 steps/s
[Step=73150 Epoch=280.3] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.722 | L2-Norm(final)=18.459 | 4578.7 samples/s | 71.5 steps/s
[Step=73200 Epoch=280.5] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.711 | L2-Norm(final)=18.460 | 4520.9 samples/s | 70.6 steps/s
[Step=73250 Epoch=280.7] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.700 | L2-Norm(final)=18.461 | 4517.2 samples/s | 70.6 steps/s
[Step=73300 Epoch=280.9] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.689 | L2-Norm(final)=18.461 | 2070.0 samples/s | 32.3 steps/s
[Step=73350 Epoch=281.1] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.678 | L2-Norm(final)=18.462 | 4598.1 samples/s | 71.8 steps/s
[Step=73400 Epoch=281.2] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.667 | L2-Norm(final)=18.462 | 4446.8 samples/s | 69.5 steps/s
[Step=73450 Epoch=281.4] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.655 | L2-Norm(final)=18.463 | 4519.6 samples/s | 70.6 steps/s
[Step=73500 Epoch=281.6] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.644 | L2-Norm(final)=18.464 | 4483.5 samples/s | 70.1 steps/s
[Step=73550 Epoch=281.8] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.633 | L2-Norm(final)=18.464 | 2131.6 samples/s | 33.3 steps/s
[Step=73600 Epoch=282.0] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.621 | L2-Norm(final)=18.465 | 4566.9 samples/s | 71.4 steps/s
[Step=73650 Epoch=282.2] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.609 | L2-Norm(final)=18.465 | 4503.0 samples/s | 70.4 steps/s
[Step=73700 Epoch=282.4] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.597 | L2-Norm(final)=18.466 | 4575.4 samples/s | 71.5 steps/s
[Step=73750 Epoch=282.6] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.585 | L2-Norm(final)=18.467 | 4689.3 samples/s | 73.3 steps/s
[Step=73800 Epoch=282.8] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.573 | L2-Norm(final)=18.467 | 6248.2 samples/s | 97.6 steps/s
[Step=73850 Epoch=283.0] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.561 | L2-Norm(final)=18.468 | 1907.1 samples/s | 29.8 steps/s
[Step=73900 Epoch=283.2] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.549 | L2-Norm(final)=18.469 | 4455.3 samples/s | 69.6 steps/s
[Step=73950 Epoch=283.4] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.537 | L2-Norm(final)=18.469 | 4513.2 samples/s | 70.5 steps/s
[Step=74000 Epoch=283.5] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.524 | L2-Norm(final)=18.470 | 4547.6 samples/s | 71.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step74000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=72001 Epoch=277.2] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=18.329 | 4274.2 samples/s | 66.8 steps/s
[Step=72050 Epoch=277.3] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=18.331 | 5045.2 samples/s | 78.8 steps/s
[Step=72100 Epoch=277.5] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=18.333 | 5078.1 samples/s | 79.3 steps/s
[Step=72150 Epoch=277.7] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=18.336 | 5152.5 samples/s | 80.5 steps/s
[Step=72200 Epoch=277.9] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=18.338 | 5456.6 samples/s | 85.3 steps/s
[Step=72250 Epoch=278.1] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=18.340 | 6904.4 samples/s | 107.9 steps/s
[Step=72300 Epoch=278.3] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=18.342 | 2075.8 samples/s | 32.4 steps/s
[Step=72350 Epoch=278.5] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=18.345 | 5317.8 samples/s | 83.1 steps/s
[Step=72400 Epoch=278.7] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=18.347 | 5296.2 samples/s | 82.8 steps/s
[Step=72450 Epoch=278.9] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=18.350 | 5210.4 samples/s | 81.4 steps/s
[Step=72500 Epoch=279.1] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=18.352 | 6106.5 samples/s | 95.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=72501 Epoch=279.1] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=18.377 | 4233.2 samples/s | 66.1 steps/s
[Step=72550 Epoch=279.3] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.835 | L2-Norm(final)=18.379 | 4389.1 samples/s | 68.6 steps/s
[Step=72600 Epoch=279.5] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.829 | L2-Norm(final)=18.381 | 4619.1 samples/s | 72.2 steps/s
[Step=72650 Epoch=279.7] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.822 | L2-Norm(final)=18.382 | 4471.6 samples/s | 69.9 steps/s
[Step=72700 Epoch=279.9] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.815 | L2-Norm(final)=18.383 | 4552.7 samples/s | 71.1 steps/s
[Step=72750 Epoch=280.0] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.807 | L2-Norm(final)=18.384 | 5813.3 samples/s | 90.8 steps/s
[Step=72800 Epoch=280.2] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.799 | L2-Norm(final)=18.385 | 1914.1 samples/s | 29.9 steps/s
[Step=72850 Epoch=280.4] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.792 | L2-Norm(final)=18.386 | 4520.5 samples/s | 70.6 steps/s
[Step=72900 Epoch=280.6] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.783 | L2-Norm(final)=18.387 | 4498.6 samples/s | 70.3 steps/s
[Step=72950 Epoch=280.8] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.775 | L2-Norm(final)=18.388 | 4420.5 samples/s | 69.1 steps/s
[Step=73000 Epoch=281.0] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=18.389 | 5077.9 samples/s | 79.3 steps/s
[Step=73050 Epoch=281.2] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.759 | L2-Norm(final)=18.390 | 2025.5 samples/s | 31.6 steps/s
[Step=73100 Epoch=281.4] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.751 | L2-Norm(final)=18.391 | 4514.6 samples/s | 70.5 steps/s
[Step=73150 Epoch=281.6] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.742 | L2-Norm(final)=18.392 | 4459.2 samples/s | 69.7 steps/s
[Step=73200 Epoch=281.8] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.734 | L2-Norm(final)=18.393 | 4534.4 samples/s | 70.8 steps/s
[Step=73250 Epoch=282.0] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.725 | L2-Norm(final)=18.394 | 4603.7 samples/s | 71.9 steps/s
[Step=73300 Epoch=282.2] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.717 | L2-Norm(final)=18.395 | 2111.6 samples/s | 33.0 steps/s
[Step=73350 Epoch=282.4] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.708 | L2-Norm(final)=18.396 | 4589.3 samples/s | 71.7 steps/s
[Step=73400 Epoch=282.5] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.699 | L2-Norm(final)=18.397 | 4507.1 samples/s | 70.4 steps/s
[Step=73450 Epoch=282.7] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.690 | L2-Norm(final)=18.398 | 4501.1 samples/s | 70.3 steps/s
[Step=73500 Epoch=282.9] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.681 | L2-Norm(final)=18.399 | 4591.3 samples/s | 71.7 steps/s
[Step=73550 Epoch=283.1] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.672 | L2-Norm(final)=18.400 | 2140.9 samples/s | 33.5 steps/s
[Step=73600 Epoch=283.3] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.663 | L2-Norm(final)=18.401 | 4525.1 samples/s | 70.7 steps/s
[Step=73650 Epoch=283.5] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=18.401 | 4575.6 samples/s | 71.5 steps/s
[Step=73700 Epoch=283.7] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.644 | L2-Norm(final)=18.402 | 4433.4 samples/s | 69.3 steps/s
[Step=73750 Epoch=283.9] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.635 | L2-Norm(final)=18.403 | 4551.1 samples/s | 71.1 steps/s
[Step=73800 Epoch=284.1] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.626 | L2-Norm(final)=18.405 | 6606.1 samples/s | 103.2 steps/s
[Step=73850 Epoch=284.3] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.616 | L2-Norm(final)=18.406 | 1858.3 samples/s | 29.0 steps/s
[Step=73900 Epoch=284.5] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=18.407 | 4543.3 samples/s | 71.0 steps/s
[Step=73950 Epoch=284.7] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.596 | L2-Norm(final)=18.408 | 4565.4 samples/s | 71.3 steps/s
[Step=74000 Epoch=284.9] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.587 | L2-Norm(final)=18.409 | 4553.9 samples/s | 71.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step74000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06839 | acc=0.9711 | tpr=0.9798 | fpr=0.0478 | 4472.6 samples/s | 17.5 steps/s
Avg test loss: 0.06775, Avg test acc: 0.97099, Avg tpr: 0.97972, Avg fpr: 0.04820, total FA: 376

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06517 | acc=0.9708 | tpr=0.9770 | fpr=0.0426 | 4444.6 samples/s | 17.4 steps/s
Avg test loss: 0.06578, Avg test acc: 0.97155, Avg tpr: 0.97814, Avg fpr: 0.04294, total FA: 335

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.43434 | acc=0.3166 | tpr=0.0102 | fpr=0.0178 | 4502.7 samples/s | 17.6 steps/s
Avg test loss: 5.45551, Avg test acc: 0.31457, Avg tpr: 0.01102, Avg fpr: 0.01782, total FA: 139

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.50241 | acc=0.3102 | tpr=0.0132 | fpr=0.0451 | 4455.6 samples/s | 17.4 steps/s
Avg test loss: 5.51720, Avg test acc: 0.30800, Avg tpr: 0.01387, Avg fpr: 0.04512, total FA: 352

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.94487 | acc=0.1172 | tpr=0.7522 | fpr=0.8942 | 4408.6 samples/s | 17.2 steps/s
[Step= 100] | Loss=5.92646 | acc=0.1176 | tpr=0.7527 | fpr=0.8942 | 8376.9 samples/s | 32.7 steps/s
[Step= 150] | Loss=5.93623 | acc=0.1169 | tpr=0.7522 | fpr=0.8948 | 8362.1 samples/s | 32.7 steps/s
[Step= 200] | Loss=5.93878 | acc=0.1163 | tpr=0.7344 | fpr=0.8949 | 8623.7 samples/s | 33.7 steps/s
[Step= 250] | Loss=5.94968 | acc=0.1159 | tpr=0.7389 | fpr=0.8955 | 8498.3 samples/s | 33.2 steps/s
[Step= 300] | Loss=5.94571 | acc=0.1156 | tpr=0.7382 | fpr=0.8958 | 8710.6 samples/s | 34.0 steps/s
[Step= 350] | Loss=5.94680 | acc=0.1151 | tpr=0.7408 | fpr=0.8963 | 8301.7 samples/s | 32.4 steps/s
[Step= 400] | Loss=5.95273 | acc=0.1151 | tpr=0.7402 | fpr=0.8962 | 8906.1 samples/s | 34.8 steps/s
[Step= 450] | Loss=5.95597 | acc=0.1154 | tpr=0.7425 | fpr=0.8960 | 8494.5 samples/s | 33.2 steps/s
[Step= 500] | Loss=5.95594 | acc=0.1152 | tpr=0.7445 | fpr=0.8961 | 8120.9 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.96118 | acc=0.1152 | tpr=0.7413 | fpr=0.8961 | 15531.3 samples/s | 60.7 steps/s
Avg test loss: 5.96126, Avg test acc: 0.11513, Avg tpr: 0.74128, Avg fpr: 0.89625, total FA: 124443

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.73604 | acc=0.1318 | tpr=0.6947 | fpr=0.8783 | 4380.5 samples/s | 17.1 steps/s
[Step= 100] | Loss=5.71766 | acc=0.1312 | tpr=0.6930 | fpr=0.8793 | 8484.1 samples/s | 33.1 steps/s
[Step= 150] | Loss=5.72299 | acc=0.1308 | tpr=0.6988 | fpr=0.8796 | 8320.7 samples/s | 32.5 steps/s
[Step= 200] | Loss=5.72252 | acc=0.1306 | tpr=0.6820 | fpr=0.8794 | 8439.2 samples/s | 33.0 steps/s
[Step= 250] | Loss=5.73562 | acc=0.1307 | tpr=0.6891 | fpr=0.8795 | 8445.5 samples/s | 33.0 steps/s
[Step= 300] | Loss=5.73165 | acc=0.1304 | tpr=0.6873 | fpr=0.8797 | 8909.1 samples/s | 34.8 steps/s
[Step= 350] | Loss=5.72972 | acc=0.1296 | tpr=0.6863 | fpr=0.8805 | 8010.3 samples/s | 31.3 steps/s
[Step= 400] | Loss=5.73602 | acc=0.1297 | tpr=0.6854 | fpr=0.8804 | 8706.5 samples/s | 34.0 steps/s
[Step= 450] | Loss=5.73827 | acc=0.1296 | tpr=0.6884 | fpr=0.8805 | 8103.5 samples/s | 31.7 steps/s
[Step= 500] | Loss=5.73713 | acc=0.1296 | tpr=0.6907 | fpr=0.8806 | 8750.6 samples/s | 34.2 steps/s
[Step= 550] | Loss=5.74127 | acc=0.1296 | tpr=0.6876 | fpr=0.8806 | 13776.1 samples/s | 53.8 steps/s
Avg test loss: 5.74112, Avg test acc: 0.12944, Avg tpr: 0.68740, Avg fpr: 0.88070, total FA: 122284

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10636 | acc=0.9830 | tpr=0.9336 | fpr=0.0161 | 4424.9 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.11290 | acc=0.9828 | tpr=0.9510 | fpr=0.0166 | 8156.9 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.11614 | acc=0.9821 | tpr=0.9539 | fpr=0.0173 | 8752.7 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.11686 | acc=0.9821 | tpr=0.9585 | fpr=0.0174 | 8065.0 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.11575 | acc=0.9822 | tpr=0.9572 | fpr=0.0173 | 8322.7 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.11659 | acc=0.9822 | tpr=0.9593 | fpr=0.0174 | 8481.7 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.11795 | acc=0.9819 | tpr=0.9593 | fpr=0.0177 | 8553.1 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.11943 | acc=0.9818 | tpr=0.9579 | fpr=0.0178 | 8405.2 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.12190 | acc=0.9815 | tpr=0.9567 | fpr=0.0181 | 8313.0 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.12154 | acc=0.9815 | tpr=0.9568 | fpr=0.0180 | 8746.2 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.12070 | acc=0.9816 | tpr=0.9538 | fpr=0.0179 | 14371.3 samples/s | 56.1 steps/s
Avg test loss: 0.12036, Avg test acc: 0.98162, Avg tpr: 0.95404, Avg fpr: 0.01788, total FA: 2482

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11702 | acc=0.9823 | tpr=0.9381 | fpr=0.0169 | 4383.2 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.12352 | acc=0.9821 | tpr=0.9616 | fpr=0.0175 | 8515.2 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.12800 | acc=0.9814 | tpr=0.9669 | fpr=0.0183 | 8651.1 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.12875 | acc=0.9815 | tpr=0.9672 | fpr=0.0183 | 8092.9 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.12787 | acc=0.9815 | tpr=0.9659 | fpr=0.0182 | 8501.8 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.12861 | acc=0.9815 | tpr=0.9673 | fpr=0.0183 | 8458.9 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.12999 | acc=0.9812 | tpr=0.9668 | fpr=0.0185 | 8457.4 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.13183 | acc=0.9811 | tpr=0.9661 | fpr=0.0187 | 8509.3 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.13448 | acc=0.9808 | tpr=0.9645 | fpr=0.0189 | 8532.3 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.13416 | acc=0.9808 | tpr=0.9639 | fpr=0.0189 | 8599.8 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.13322 | acc=0.9809 | tpr=0.9618 | fpr=0.0187 | 15347.4 samples/s | 60.0 steps/s
Avg test loss: 0.13290, Avg test acc: 0.98095, Avg tpr: 0.96197, Avg fpr: 0.01870, total FA: 2597

server round 37/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=74001 Epoch=144.3] | Loss=0.00809 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=18.246 | 4066.8 samples/s | 63.5 steps/s
[Step=74050 Epoch=144.4] | Loss=0.00960 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=18.253 | 5334.7 samples/s | 83.4 steps/s
[Step=74100 Epoch=144.5] | Loss=0.00907 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.594 | L2-Norm(final)=18.260 | 5600.3 samples/s | 87.5 steps/s
[Step=74150 Epoch=144.6] | Loss=0.00910 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.594 | L2-Norm(final)=18.269 | 5603.2 samples/s | 87.6 steps/s
[Step=74200 Epoch=144.7] | Loss=0.00917 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.594 | L2-Norm(final)=18.278 | 5513.0 samples/s | 86.1 steps/s
[Step=74250 Epoch=144.8] | Loss=0.00911 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.594 | L2-Norm(final)=18.286 | 5535.3 samples/s | 86.5 steps/s
[Step=74300 Epoch=144.9] | Loss=0.00900 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.594 | L2-Norm(final)=18.294 | 5503.7 samples/s | 86.0 steps/s
[Step=74350 Epoch=145.0] | Loss=0.00861 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.594 | L2-Norm(final)=18.302 | 5482.1 samples/s | 85.7 steps/s
[Step=74400 Epoch=145.1] | Loss=0.00862 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.594 | L2-Norm(final)=18.310 | 5327.6 samples/s | 83.2 steps/s
[Step=74450 Epoch=145.2] | Loss=0.00857 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.594 | L2-Norm(final)=18.318 | 5399.5 samples/s | 84.4 steps/s
[Step=74500 Epoch=145.3] | Loss=0.00854 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.594 | L2-Norm(final)=18.326 | 7077.9 samples/s | 110.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=74501 Epoch=145.3] | Loss=0.00928 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.594 | L2-Norm(final)=18.402 | 4050.5 samples/s | 63.3 steps/s
[Step=74550 Epoch=145.4] | Loss=0.01008 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.605 | L2-Norm(final)=18.407 | 4556.6 samples/s | 71.2 steps/s
[Step=74600 Epoch=145.5] | Loss=0.00989 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.616 | L2-Norm(final)=18.412 | 4671.0 samples/s | 73.0 steps/s
[Step=74650 Epoch=145.6] | Loss=0.00892 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.626 | L2-Norm(final)=18.418 | 4754.5 samples/s | 74.3 steps/s
[Step=74700 Epoch=145.7] | Loss=0.00963 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.634 | L2-Norm(final)=18.423 | 4720.9 samples/s | 73.8 steps/s
[Step=74750 Epoch=145.8] | Loss=0.00969 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.643 | L2-Norm(final)=18.427 | 4737.8 samples/s | 74.0 steps/s
[Step=74800 Epoch=145.9] | Loss=0.00931 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.650 | L2-Norm(final)=18.431 | 4805.1 samples/s | 75.1 steps/s
[Step=74850 Epoch=146.0] | Loss=0.00908 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.657 | L2-Norm(final)=18.436 | 4748.7 samples/s | 74.2 steps/s
[Step=74900 Epoch=146.1] | Loss=0.00932 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.664 | L2-Norm(final)=18.441 | 4813.6 samples/s | 75.2 steps/s
[Step=74950 Epoch=146.2] | Loss=0.00937 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.670 | L2-Norm(final)=18.445 | 4744.1 samples/s | 74.1 steps/s
[Step=75000 Epoch=146.3] | Loss=0.00914 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.675 | L2-Norm(final)=18.448 | 5792.4 samples/s | 90.5 steps/s
[Step=75050 Epoch=146.4] | Loss=0.00891 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.681 | L2-Norm(final)=18.452 | 1943.7 samples/s | 30.4 steps/s
[Step=75100 Epoch=146.5] | Loss=0.00858 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.686 | L2-Norm(final)=18.456 | 4777.2 samples/s | 74.6 steps/s
[Step=75150 Epoch=146.6] | Loss=0.00837 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.691 | L2-Norm(final)=18.461 | 4730.5 samples/s | 73.9 steps/s
[Step=75200 Epoch=146.7] | Loss=0.00833 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.695 | L2-Norm(final)=18.464 | 4721.2 samples/s | 73.8 steps/s
[Step=75250 Epoch=146.8] | Loss=0.00814 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.700 | L2-Norm(final)=18.468 | 4754.5 samples/s | 74.3 steps/s
[Step=75300 Epoch=146.9] | Loss=0.00805 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.704 | L2-Norm(final)=18.472 | 4751.2 samples/s | 74.2 steps/s
[Step=75350 Epoch=147.0] | Loss=0.00812 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.708 | L2-Norm(final)=18.475 | 4816.9 samples/s | 75.3 steps/s
[Step=75400 Epoch=147.1] | Loss=0.00797 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.712 | L2-Norm(final)=18.478 | 4813.2 samples/s | 75.2 steps/s
[Step=75450 Epoch=147.2] | Loss=0.00783 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.715 | L2-Norm(final)=18.481 | 4825.9 samples/s | 75.4 steps/s
[Step=75500 Epoch=147.3] | Loss=0.00779 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.718 | L2-Norm(final)=18.484 | 5027.6 samples/s | 78.6 steps/s
[Step=75550 Epoch=147.4] | Loss=0.00772 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.722 | L2-Norm(final)=18.487 | 1983.3 samples/s | 31.0 steps/s
[Step=75600 Epoch=147.4] | Loss=0.00757 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.725 | L2-Norm(final)=18.490 | 4847.2 samples/s | 75.7 steps/s
[Step=75650 Epoch=147.5] | Loss=0.00746 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.728 | L2-Norm(final)=18.493 | 4628.1 samples/s | 72.3 steps/s
[Step=75700 Epoch=147.6] | Loss=0.00739 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.731 | L2-Norm(final)=18.496 | 4770.3 samples/s | 74.5 steps/s
[Step=75750 Epoch=147.7] | Loss=0.00732 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.734 | L2-Norm(final)=18.499 | 4728.3 samples/s | 73.9 steps/s
[Step=75800 Epoch=147.8] | Loss=0.00721 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.736 | L2-Norm(final)=18.502 | 4774.4 samples/s | 74.6 steps/s
[Step=75850 Epoch=147.9] | Loss=0.00721 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.739 | L2-Norm(final)=18.505 | 4905.4 samples/s | 76.6 steps/s
[Step=75900 Epoch=148.0] | Loss=0.00714 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.742 | L2-Norm(final)=18.507 | 4755.4 samples/s | 74.3 steps/s
[Step=75950 Epoch=148.1] | Loss=0.00714 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.744 | L2-Norm(final)=18.510 | 4680.3 samples/s | 73.1 steps/s
[Step=76000 Epoch=148.2] | Loss=0.00716 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=18.513 | 4795.4 samples/s | 74.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step76000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=74001 Epoch=144.7] | Loss=0.01287 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.593 | L2-Norm(final)=18.904 | 4192.9 samples/s | 65.5 steps/s
[Step=74050 Epoch=144.8] | Loss=0.00775 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.593 | L2-Norm(final)=18.913 | 5427.1 samples/s | 84.8 steps/s
[Step=74100 Epoch=144.9] | Loss=0.00845 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=18.921 | 5419.3 samples/s | 84.7 steps/s
[Step=74150 Epoch=145.0] | Loss=0.00857 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=18.929 | 5515.1 samples/s | 86.2 steps/s
[Step=74200 Epoch=145.1] | Loss=0.00851 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=18.938 | 5535.5 samples/s | 86.5 steps/s
[Step=74250 Epoch=145.2] | Loss=0.00833 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.593 | L2-Norm(final)=18.948 | 5337.4 samples/s | 83.4 steps/s
[Step=74300 Epoch=145.3] | Loss=0.00813 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=18.958 | 5486.6 samples/s | 85.7 steps/s
[Step=74350 Epoch=145.4] | Loss=0.00817 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=18.969 | 5592.9 samples/s | 87.4 steps/s
[Step=74400 Epoch=145.5] | Loss=0.00823 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=18.979 | 5354.7 samples/s | 83.7 steps/s
[Step=74450 Epoch=145.5] | Loss=0.00812 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=18.989 | 5432.2 samples/s | 84.9 steps/s
[Step=74500 Epoch=145.6] | Loss=0.00797 | Reg=0.00092 | acc=0.9688 | L2-Norm=9.593 | L2-Norm(final)=18.999 | 7221.6 samples/s | 112.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=74501 Epoch=145.6] | Loss=0.00070 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=19.106 | 4313.6 samples/s | 67.4 steps/s
[Step=74550 Epoch=145.7] | Loss=0.00683 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.604 | L2-Norm(final)=19.113 | 4796.2 samples/s | 74.9 steps/s
[Step=74600 Epoch=145.8] | Loss=0.00876 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.615 | L2-Norm(final)=19.118 | 4762.3 samples/s | 74.4 steps/s
[Step=74650 Epoch=145.9] | Loss=0.00866 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.624 | L2-Norm(final)=19.122 | 4733.2 samples/s | 74.0 steps/s
[Step=74700 Epoch=146.0] | Loss=0.00877 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.633 | L2-Norm(final)=19.127 | 4713.4 samples/s | 73.6 steps/s
[Step=74750 Epoch=146.1] | Loss=0.00876 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.641 | L2-Norm(final)=19.133 | 4787.9 samples/s | 74.8 steps/s
[Step=74800 Epoch=146.2] | Loss=0.00851 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.649 | L2-Norm(final)=19.139 | 4785.5 samples/s | 74.8 steps/s
[Step=74850 Epoch=146.3] | Loss=0.00872 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.656 | L2-Norm(final)=19.144 | 4808.4 samples/s | 75.1 steps/s
[Step=74900 Epoch=146.4] | Loss=0.00852 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.662 | L2-Norm(final)=19.149 | 4796.6 samples/s | 74.9 steps/s
[Step=74950 Epoch=146.5] | Loss=0.00839 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.668 | L2-Norm(final)=19.155 | 4768.9 samples/s | 74.5 steps/s
[Step=75000 Epoch=146.6] | Loss=0.00820 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.673 | L2-Norm(final)=19.160 | 5900.6 samples/s | 92.2 steps/s
[Step=75050 Epoch=146.7] | Loss=0.00799 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.679 | L2-Norm(final)=19.166 | 2026.8 samples/s | 31.7 steps/s
[Step=75100 Epoch=146.8] | Loss=0.00781 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.684 | L2-Norm(final)=19.171 | 4868.8 samples/s | 76.1 steps/s
[Step=75150 Epoch=146.9] | Loss=0.00772 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.689 | L2-Norm(final)=19.176 | 4887.0 samples/s | 76.4 steps/s
[Step=75200 Epoch=147.0] | Loss=0.00753 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.693 | L2-Norm(final)=19.181 | 4880.2 samples/s | 76.3 steps/s
[Step=75250 Epoch=147.1] | Loss=0.00746 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.698 | L2-Norm(final)=19.186 | 4920.1 samples/s | 76.9 steps/s
[Step=75300 Epoch=147.2] | Loss=0.00738 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.702 | L2-Norm(final)=19.190 | 4917.9 samples/s | 76.8 steps/s
[Step=75350 Epoch=147.3] | Loss=0.00740 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.706 | L2-Norm(final)=19.195 | 4833.1 samples/s | 75.5 steps/s
[Step=75400 Epoch=147.4] | Loss=0.00726 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.709 | L2-Norm(final)=19.199 | 4920.6 samples/s | 76.9 steps/s
[Step=75450 Epoch=147.5] | Loss=0.00719 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.713 | L2-Norm(final)=19.204 | 4846.2 samples/s | 75.7 steps/s
[Step=75500 Epoch=147.6] | Loss=0.00707 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.717 | L2-Norm(final)=19.208 | 5228.3 samples/s | 81.7 steps/s
[Step=75550 Epoch=147.7] | Loss=0.00704 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.720 | L2-Norm(final)=19.212 | 2126.4 samples/s | 33.2 steps/s
[Step=75600 Epoch=147.8] | Loss=0.00698 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.724 | L2-Norm(final)=19.216 | 4827.2 samples/s | 75.4 steps/s
[Step=75650 Epoch=147.9] | Loss=0.00684 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.727 | L2-Norm(final)=19.220 | 4737.4 samples/s | 74.0 steps/s
[Step=75700 Epoch=148.0] | Loss=0.00676 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.731 | L2-Norm(final)=19.224 | 4788.5 samples/s | 74.8 steps/s
[Step=75750 Epoch=148.1] | Loss=0.00667 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.734 | L2-Norm(final)=19.228 | 4707.3 samples/s | 73.6 steps/s
[Step=75800 Epoch=148.2] | Loss=0.00670 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.737 | L2-Norm(final)=19.232 | 4840.1 samples/s | 75.6 steps/s
[Step=75850 Epoch=148.3] | Loss=0.00663 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.740 | L2-Norm(final)=19.236 | 4795.4 samples/s | 74.9 steps/s
[Step=75900 Epoch=148.4] | Loss=0.00658 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.743 | L2-Norm(final)=19.240 | 4862.7 samples/s | 76.0 steps/s
[Step=75950 Epoch=148.5] | Loss=0.00652 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.746 | L2-Norm(final)=19.243 | 4893.6 samples/s | 76.5 steps/s
[Step=76000 Epoch=148.6] | Loss=0.00647 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.748 | L2-Norm(final)=19.247 | 4881.3 samples/s | 76.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step76000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=74001 Epoch=283.5] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=18.491 | 4133.3 samples/s | 64.6 steps/s
[Step=74050 Epoch=283.7] | Loss=0.00003 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.588 | L2-Norm(final)=18.496 | 4939.1 samples/s | 77.2 steps/s
[Step=74100 Epoch=283.9] | Loss=0.00003 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.588 | L2-Norm(final)=18.506 | 5050.3 samples/s | 78.9 steps/s
[Step=74150 Epoch=284.1] | Loss=0.00003 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.588 | L2-Norm(final)=18.513 | 5173.5 samples/s | 80.8 steps/s
[Step=74200 Epoch=284.3] | Loss=0.00003 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.587 | L2-Norm(final)=18.520 | 5201.2 samples/s | 81.3 steps/s
[Step=74250 Epoch=284.5] | Loss=0.00003 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.587 | L2-Norm(final)=18.526 | 6575.1 samples/s | 102.7 steps/s
[Step=74300 Epoch=284.7] | Loss=0.00003 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.587 | L2-Norm(final)=18.531 | 2029.6 samples/s | 31.7 steps/s
[Step=74350 Epoch=284.9] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.587 | L2-Norm(final)=18.538 | 5084.5 samples/s | 79.4 steps/s
[Step=74400 Epoch=285.1] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.587 | L2-Norm(final)=18.543 | 5081.7 samples/s | 79.4 steps/s
[Step=74450 Epoch=285.3] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.587 | L2-Norm(final)=18.549 | 5181.3 samples/s | 81.0 steps/s
[Step=74500 Epoch=285.5] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.587 | L2-Norm(final)=18.555 | 5683.7 samples/s | 88.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=74501 Epoch=285.5] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.587 | L2-Norm(final)=18.616 | 4109.2 samples/s | 64.2 steps/s
[Step=74550 Epoch=285.6] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=18.621 | 4294.1 samples/s | 67.1 steps/s
[Step=74600 Epoch=285.8] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.562 | L2-Norm(final)=18.624 | 4531.7 samples/s | 70.8 steps/s
[Step=74650 Epoch=286.0] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.542 | L2-Norm(final)=18.625 | 4418.2 samples/s | 69.0 steps/s
[Step=74700 Epoch=286.2] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.521 | L2-Norm(final)=18.627 | 4523.0 samples/s | 70.7 steps/s
[Step=74750 Epoch=286.4] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.500 | L2-Norm(final)=18.628 | 5704.9 samples/s | 89.1 steps/s
[Step=74800 Epoch=286.6] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.479 | L2-Norm(final)=18.629 | 1990.6 samples/s | 31.1 steps/s
[Step=74850 Epoch=286.8] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.457 | L2-Norm(final)=18.630 | 4491.0 samples/s | 70.2 steps/s
[Step=74900 Epoch=287.0] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.436 | L2-Norm(final)=18.631 | 4493.6 samples/s | 70.2 steps/s
[Step=74950 Epoch=287.2] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.414 | L2-Norm(final)=18.632 | 4431.1 samples/s | 69.2 steps/s
[Step=75000 Epoch=287.4] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.392 | L2-Norm(final)=18.633 | 4947.0 samples/s | 77.3 steps/s
[Step=75050 Epoch=287.6] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.370 | L2-Norm(final)=18.634 | 2070.8 samples/s | 32.4 steps/s
[Step=75100 Epoch=287.8] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.348 | L2-Norm(final)=18.634 | 4551.5 samples/s | 71.1 steps/s
[Step=75150 Epoch=287.9] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.326 | L2-Norm(final)=18.635 | 4484.6 samples/s | 70.1 steps/s
[Step=75200 Epoch=288.1] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.304 | L2-Norm(final)=18.636 | 4479.6 samples/s | 70.0 steps/s
[Step=75250 Epoch=288.3] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.281 | L2-Norm(final)=18.637 | 4534.9 samples/s | 70.9 steps/s
[Step=75300 Epoch=288.5] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.259 | L2-Norm(final)=18.638 | 2111.7 samples/s | 33.0 steps/s
[Step=75350 Epoch=288.7] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.236 | L2-Norm(final)=18.639 | 4647.9 samples/s | 72.6 steps/s
[Step=75400 Epoch=288.9] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.213 | L2-Norm(final)=18.640 | 4507.6 samples/s | 70.4 steps/s
[Step=75450 Epoch=289.1] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.190 | L2-Norm(final)=18.641 | 4524.0 samples/s | 70.7 steps/s
[Step=75500 Epoch=289.3] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.167 | L2-Norm(final)=18.642 | 4480.3 samples/s | 70.0 steps/s
[Step=75550 Epoch=289.5] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.144 | L2-Norm(final)=18.644 | 2176.2 samples/s | 34.0 steps/s
[Step=75600 Epoch=289.7] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.121 | L2-Norm(final)=18.645 | 4656.7 samples/s | 72.8 steps/s
[Step=75650 Epoch=289.9] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.097 | L2-Norm(final)=18.646 | 4652.0 samples/s | 72.7 steps/s
[Step=75700 Epoch=290.1] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.074 | L2-Norm(final)=18.647 | 4592.9 samples/s | 71.8 steps/s
[Step=75750 Epoch=290.2] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.050 | L2-Norm(final)=18.649 | 4640.1 samples/s | 72.5 steps/s
[Step=75800 Epoch=290.4] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.026 | L2-Norm(final)=18.650 | 6328.3 samples/s | 98.9 steps/s
[Step=75850 Epoch=290.6] | Loss=0.00000 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.002 | L2-Norm(final)=18.652 | 1945.0 samples/s | 30.4 steps/s
[Step=75900 Epoch=290.8] | Loss=0.00000 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.978 | L2-Norm(final)=18.653 | 4592.2 samples/s | 71.8 steps/s
[Step=75950 Epoch=291.0] | Loss=0.00000 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.954 | L2-Norm(final)=18.655 | 4664.4 samples/s | 72.9 steps/s
[Step=76000 Epoch=291.2] | Loss=0.00000 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.929 | L2-Norm(final)=18.656 | 4581.6 samples/s | 71.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step76000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=74001 Epoch=284.9] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=18.441 | 4027.9 samples/s | 62.9 steps/s
[Step=74050 Epoch=285.0] | Loss=0.00005 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.589 | L2-Norm(final)=18.452 | 5015.4 samples/s | 78.4 steps/s
[Step=74100 Epoch=285.2] | Loss=0.00004 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.589 | L2-Norm(final)=18.459 | 5314.9 samples/s | 83.0 steps/s
[Step=74150 Epoch=285.4] | Loss=0.00004 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.589 | L2-Norm(final)=18.466 | 5035.0 samples/s | 78.7 steps/s
[Step=74200 Epoch=285.6] | Loss=0.00004 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.589 | L2-Norm(final)=18.473 | 5106.9 samples/s | 79.8 steps/s
[Step=74250 Epoch=285.8] | Loss=0.00004 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.588 | L2-Norm(final)=18.480 | 6913.1 samples/s | 108.0 steps/s
[Step=74300 Epoch=286.0] | Loss=0.00004 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.588 | L2-Norm(final)=18.486 | 2084.5 samples/s | 32.6 steps/s
[Step=74350 Epoch=286.2] | Loss=0.00004 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.588 | L2-Norm(final)=18.493 | 5274.4 samples/s | 82.4 steps/s
[Step=74400 Epoch=286.4] | Loss=0.00004 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.588 | L2-Norm(final)=18.499 | 5342.1 samples/s | 83.5 steps/s
[Step=74450 Epoch=286.6] | Loss=0.00004 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.588 | L2-Norm(final)=18.506 | 5261.9 samples/s | 82.2 steps/s
[Step=74500 Epoch=286.8] | Loss=0.00004 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.588 | L2-Norm(final)=18.513 | 5939.8 samples/s | 92.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=74501 Epoch=286.8] | Loss=0.00003 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.588 | L2-Norm(final)=18.587 | 4123.7 samples/s | 64.4 steps/s
[Step=74550 Epoch=287.0] | Loss=0.00022 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.597 | L2-Norm(final)=18.590 | 4439.6 samples/s | 69.4 steps/s
[Step=74600 Epoch=287.2] | Loss=0.00053 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.617 | L2-Norm(final)=18.590 | 4532.0 samples/s | 70.8 steps/s
[Step=74650 Epoch=287.4] | Loss=0.00055 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.632 | L2-Norm(final)=18.586 | 4583.1 samples/s | 71.6 steps/s
[Step=74700 Epoch=287.5] | Loss=0.00042 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.639 | L2-Norm(final)=18.584 | 4523.1 samples/s | 70.7 steps/s
[Step=74750 Epoch=287.7] | Loss=0.00034 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.643 | L2-Norm(final)=18.583 | 5643.9 samples/s | 88.2 steps/s
[Step=74800 Epoch=287.9] | Loss=0.00028 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.644 | L2-Norm(final)=18.582 | 1954.3 samples/s | 30.5 steps/s
[Step=74850 Epoch=288.1] | Loss=0.00024 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.645 | L2-Norm(final)=18.582 | 4473.7 samples/s | 69.9 steps/s
[Step=74900 Epoch=288.3] | Loss=0.00021 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.645 | L2-Norm(final)=18.582 | 4545.7 samples/s | 71.0 steps/s
[Step=74950 Epoch=288.5] | Loss=0.00019 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.644 | L2-Norm(final)=18.582 | 4529.2 samples/s | 70.8 steps/s
[Step=75000 Epoch=288.7] | Loss=0.00017 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.643 | L2-Norm(final)=18.582 | 5070.1 samples/s | 79.2 steps/s
[Step=75050 Epoch=288.9] | Loss=0.00016 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.642 | L2-Norm(final)=18.582 | 2017.8 samples/s | 31.5 steps/s
[Step=75100 Epoch=289.1] | Loss=0.00014 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.641 | L2-Norm(final)=18.582 | 4498.4 samples/s | 70.3 steps/s
[Step=75150 Epoch=289.3] | Loss=0.00013 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.639 | L2-Norm(final)=18.582 | 4451.9 samples/s | 69.6 steps/s
[Step=75200 Epoch=289.5] | Loss=0.00012 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.638 | L2-Norm(final)=18.582 | 4502.7 samples/s | 70.4 steps/s
[Step=75250 Epoch=289.7] | Loss=0.00012 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.636 | L2-Norm(final)=18.582 | 4672.9 samples/s | 73.0 steps/s
[Step=75300 Epoch=289.9] | Loss=0.00011 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.635 | L2-Norm(final)=18.583 | 2131.7 samples/s | 33.3 steps/s
[Step=75350 Epoch=290.1] | Loss=0.00010 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.633 | L2-Norm(final)=18.583 | 4495.7 samples/s | 70.2 steps/s
[Step=75400 Epoch=290.2] | Loss=0.00010 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.631 | L2-Norm(final)=18.583 | 4518.9 samples/s | 70.6 steps/s
[Step=75450 Epoch=290.4] | Loss=0.00009 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.629 | L2-Norm(final)=18.583 | 4476.7 samples/s | 69.9 steps/s
[Step=75500 Epoch=290.6] | Loss=0.00009 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.627 | L2-Norm(final)=18.584 | 4452.0 samples/s | 69.6 steps/s
[Step=75550 Epoch=290.8] | Loss=0.00008 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.625 | L2-Norm(final)=18.584 | 2126.4 samples/s | 33.2 steps/s
[Step=75600 Epoch=291.0] | Loss=0.00008 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.623 | L2-Norm(final)=18.584 | 4543.8 samples/s | 71.0 steps/s
[Step=75650 Epoch=291.2] | Loss=0.00008 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.621 | L2-Norm(final)=18.585 | 4497.3 samples/s | 70.3 steps/s
[Step=75700 Epoch=291.4] | Loss=0.00007 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.619 | L2-Norm(final)=18.585 | 4558.7 samples/s | 71.2 steps/s
[Step=75750 Epoch=291.6] | Loss=0.00007 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.617 | L2-Norm(final)=18.585 | 4479.3 samples/s | 70.0 steps/s
[Step=75800 Epoch=291.8] | Loss=0.00007 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.615 | L2-Norm(final)=18.586 | 6698.0 samples/s | 104.7 steps/s
[Step=75850 Epoch=292.0] | Loss=0.00007 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.612 | L2-Norm(final)=18.586 | 1834.6 samples/s | 28.7 steps/s
[Step=75900 Epoch=292.2] | Loss=0.00006 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.610 | L2-Norm(final)=18.586 | 4515.8 samples/s | 70.6 steps/s
[Step=75950 Epoch=292.4] | Loss=0.00006 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.608 | L2-Norm(final)=18.587 | 4537.6 samples/s | 70.9 steps/s
[Step=76000 Epoch=292.6] | Loss=0.00006 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=18.587 | 4423.4 samples/s | 69.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step76000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06467 | acc=0.9703 | tpr=0.9780 | fpr=0.0463 | 4480.4 samples/s | 17.5 steps/s
Avg test loss: 0.06539, Avg test acc: 0.97075, Avg tpr: 0.97878, Avg fpr: 0.04692, total FA: 366

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06952 | acc=0.9707 | tpr=0.9797 | fpr=0.0488 | 4472.0 samples/s | 17.5 steps/s
Avg test loss: 0.06958, Avg test acc: 0.97151, Avg tpr: 0.98059, Avg fpr: 0.04846, total FA: 378

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.58121 | acc=0.3148 | tpr=0.0073 | fpr=0.0176 | 4475.0 samples/s | 17.5 steps/s
Avg test loss: 5.60373, Avg test acc: 0.31281, Avg tpr: 0.00799, Avg fpr: 0.01679, total FA: 131

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.35832 | acc=0.3121 | tpr=0.0090 | fpr=0.0297 | 4501.2 samples/s | 17.6 steps/s
Avg test loss: 5.37961, Avg test acc: 0.30884, Avg tpr: 0.00857, Avg fpr: 0.03077, total FA: 240

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.73633 | acc=0.1196 | tpr=0.7389 | fpr=0.8915 | 4416.8 samples/s | 17.3 steps/s
[Step= 100] | Loss=5.71664 | acc=0.1189 | tpr=0.7335 | fpr=0.8926 | 8553.8 samples/s | 33.4 steps/s
[Step= 150] | Loss=5.72646 | acc=0.1179 | tpr=0.7291 | fpr=0.8933 | 8234.5 samples/s | 32.2 steps/s
[Step= 200] | Loss=5.72822 | acc=0.1174 | tpr=0.7126 | fpr=0.8935 | 8441.0 samples/s | 33.0 steps/s
[Step= 250] | Loss=5.73809 | acc=0.1172 | tpr=0.7109 | fpr=0.8936 | 8764.8 samples/s | 34.2 steps/s
[Step= 300] | Loss=5.73437 | acc=0.1169 | tpr=0.7098 | fpr=0.8939 | 8213.8 samples/s | 32.1 steps/s
[Step= 350] | Loss=5.73495 | acc=0.1163 | tpr=0.7088 | fpr=0.8945 | 9216.8 samples/s | 36.0 steps/s
[Step= 400] | Loss=5.74068 | acc=0.1162 | tpr=0.7084 | fpr=0.8946 | 7854.1 samples/s | 30.7 steps/s
[Step= 450] | Loss=5.74401 | acc=0.1163 | tpr=0.7108 | fpr=0.8945 | 8503.1 samples/s | 33.2 steps/s
[Step= 500] | Loss=5.74404 | acc=0.1162 | tpr=0.7150 | fpr=0.8946 | 8510.0 samples/s | 33.2 steps/s
[Step= 550] | Loss=5.74875 | acc=0.1163 | tpr=0.7131 | fpr=0.8946 | 15688.4 samples/s | 61.3 steps/s
Avg test loss: 5.74866, Avg test acc: 0.11618, Avg tpr: 0.71315, Avg fpr: 0.89468, total FA: 124224

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.09728 | acc=0.1245 | tpr=0.7035 | fpr=0.8859 | 4428.6 samples/s | 17.3 steps/s
[Step= 100] | Loss=6.07978 | acc=0.1230 | tpr=0.7228 | fpr=0.8882 | 8675.4 samples/s | 33.9 steps/s
[Step= 150] | Loss=6.08591 | acc=0.1226 | tpr=0.7233 | fpr=0.8885 | 8034.4 samples/s | 31.4 steps/s
[Step= 200] | Loss=6.08508 | acc=0.1223 | tpr=0.7082 | fpr=0.8884 | 8366.8 samples/s | 32.7 steps/s
[Step= 250] | Loss=6.09761 | acc=0.1220 | tpr=0.7118 | fpr=0.8887 | 8633.3 samples/s | 33.7 steps/s
[Step= 300] | Loss=6.09471 | acc=0.1219 | tpr=0.7091 | fpr=0.8888 | 8323.5 samples/s | 32.5 steps/s
[Step= 350] | Loss=6.09245 | acc=0.1212 | tpr=0.7063 | fpr=0.8894 | 8316.5 samples/s | 32.5 steps/s
[Step= 400] | Loss=6.09819 | acc=0.1215 | tpr=0.7057 | fpr=0.8891 | 8217.2 samples/s | 32.1 steps/s
[Step= 450] | Loss=6.10084 | acc=0.1213 | tpr=0.7089 | fpr=0.8893 | 8694.5 samples/s | 34.0 steps/s
[Step= 500] | Loss=6.09977 | acc=0.1211 | tpr=0.7115 | fpr=0.8896 | 8540.8 samples/s | 33.4 steps/s
[Step= 550] | Loss=6.10404 | acc=0.1211 | tpr=0.7087 | fpr=0.8896 | 14552.8 samples/s | 56.8 steps/s
Avg test loss: 6.10388, Avg test acc: 0.12101, Avg tpr: 0.70880, Avg fpr: 0.88968, total FA: 123530

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10212 | acc=0.9832 | tpr=0.9425 | fpr=0.0161 | 4472.2 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.10841 | acc=0.9823 | tpr=0.9552 | fpr=0.0172 | 8463.4 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.11162 | acc=0.9817 | tpr=0.9582 | fpr=0.0179 | 8475.1 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.11275 | acc=0.9818 | tpr=0.9607 | fpr=0.0178 | 8689.4 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.11158 | acc=0.9819 | tpr=0.9598 | fpr=0.0177 | 8388.3 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.11259 | acc=0.9819 | tpr=0.9607 | fpr=0.0177 | 8072.0 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.11380 | acc=0.9816 | tpr=0.9606 | fpr=0.0181 | 8453.1 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.11516 | acc=0.9814 | tpr=0.9601 | fpr=0.0182 | 8335.0 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.11755 | acc=0.9812 | tpr=0.9581 | fpr=0.0184 | 8415.8 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.11720 | acc=0.9812 | tpr=0.9581 | fpr=0.0184 | 8290.6 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.11625 | acc=0.9812 | tpr=0.9546 | fpr=0.0183 | 15645.4 samples/s | 61.1 steps/s
Avg test loss: 0.11592, Avg test acc: 0.98127, Avg tpr: 0.95483, Avg fpr: 0.01825, total FA: 2534

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12717 | acc=0.9818 | tpr=0.9425 | fpr=0.0175 | 4508.2 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.13456 | acc=0.9814 | tpr=0.9659 | fpr=0.0183 | 8033.4 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.13974 | acc=0.9807 | tpr=0.9683 | fpr=0.0190 | 8963.9 samples/s | 35.0 steps/s
[Step= 200] | Loss=0.14079 | acc=0.9807 | tpr=0.9683 | fpr=0.0191 | 7950.4 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.13959 | acc=0.9808 | tpr=0.9677 | fpr=0.0189 | 8323.4 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.14092 | acc=0.9807 | tpr=0.9695 | fpr=0.0191 | 8319.4 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.14245 | acc=0.9804 | tpr=0.9693 | fpr=0.0194 | 8315.9 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.14428 | acc=0.9802 | tpr=0.9683 | fpr=0.0196 | 8187.7 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.14704 | acc=0.9799 | tpr=0.9669 | fpr=0.0199 | 8589.2 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.14685 | acc=0.9799 | tpr=0.9665 | fpr=0.0199 | 8814.3 samples/s | 34.4 steps/s
[Step= 550] | Loss=0.14554 | acc=0.9799 | tpr=0.9634 | fpr=0.0198 | 14155.7 samples/s | 55.3 steps/s
Avg test loss: 0.14520, Avg test acc: 0.97993, Avg tpr: 0.96355, Avg fpr: 0.01978, total FA: 2746

server round 38/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=76001 Epoch=148.2] | Loss=0.00452 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.285 | L2-Norm(final)=18.590 | 3798.3 samples/s | 59.3 steps/s
[Step=76050 Epoch=148.3] | Loss=0.01218 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.285 | L2-Norm(final)=18.602 | 5407.9 samples/s | 84.5 steps/s
[Step=76100 Epoch=148.4] | Loss=0.01097 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.285 | L2-Norm(final)=18.616 | 5400.9 samples/s | 84.4 steps/s
[Step=76150 Epoch=148.5] | Loss=0.01062 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.285 | L2-Norm(final)=18.630 | 5465.3 samples/s | 85.4 steps/s
[Step=76200 Epoch=148.6] | Loss=0.01063 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.285 | L2-Norm(final)=18.646 | 5527.6 samples/s | 86.4 steps/s
[Step=76250 Epoch=148.7] | Loss=0.01031 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.285 | L2-Norm(final)=18.661 | 5326.5 samples/s | 83.2 steps/s
[Step=76300 Epoch=148.8] | Loss=0.01017 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.285 | L2-Norm(final)=18.675 | 5458.6 samples/s | 85.3 steps/s
[Step=76350 Epoch=148.9] | Loss=0.01036 | Reg=0.00086 | acc=0.9688 | L2-Norm=9.285 | L2-Norm(final)=18.690 | 5516.5 samples/s | 86.2 steps/s
[Step=76400 Epoch=149.0] | Loss=0.01053 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.285 | L2-Norm(final)=18.704 | 5494.6 samples/s | 85.9 steps/s
[Step=76450 Epoch=149.1] | Loss=0.01039 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.285 | L2-Norm(final)=18.718 | 5403.8 samples/s | 84.4 steps/s
[Step=76500 Epoch=149.2] | Loss=0.01035 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.285 | L2-Norm(final)=18.732 | 6922.4 samples/s | 108.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=76501 Epoch=149.2] | Loss=0.01027 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.285 | L2-Norm(final)=18.875 | 3977.2 samples/s | 62.1 steps/s
[Step=76550 Epoch=149.3] | Loss=0.00941 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.303 | L2-Norm(final)=18.887 | 4718.0 samples/s | 73.7 steps/s
[Step=76600 Epoch=149.4] | Loss=0.01125 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.316 | L2-Norm(final)=18.894 | 4761.1 samples/s | 74.4 steps/s
[Step=76650 Epoch=149.5] | Loss=0.01081 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.329 | L2-Norm(final)=18.900 | 4811.7 samples/s | 75.2 steps/s
[Step=76700 Epoch=149.6] | Loss=0.01030 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.340 | L2-Norm(final)=18.907 | 4694.5 samples/s | 73.4 steps/s
[Step=76750 Epoch=149.7] | Loss=0.01027 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.349 | L2-Norm(final)=18.914 | 4932.9 samples/s | 77.1 steps/s
[Step=76800 Epoch=149.8] | Loss=0.01033 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.358 | L2-Norm(final)=18.919 | 4890.2 samples/s | 76.4 steps/s
[Step=76850 Epoch=149.9] | Loss=0.01015 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.365 | L2-Norm(final)=18.924 | 4888.7 samples/s | 76.4 steps/s
[Step=76900 Epoch=150.0] | Loss=0.00980 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.372 | L2-Norm(final)=18.930 | 4966.3 samples/s | 77.6 steps/s
[Step=76950 Epoch=150.1] | Loss=0.00995 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.378 | L2-Norm(final)=18.935 | 4714.9 samples/s | 73.7 steps/s
[Step=77000 Epoch=150.2] | Loss=0.00977 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.384 | L2-Norm(final)=18.939 | 5981.6 samples/s | 93.5 steps/s
[Step=77050 Epoch=150.3] | Loss=0.00950 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.390 | L2-Norm(final)=18.944 | 1980.7 samples/s | 30.9 steps/s
[Step=77100 Epoch=150.4] | Loss=0.00930 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.396 | L2-Norm(final)=18.949 | 4854.1 samples/s | 75.8 steps/s
[Step=77150 Epoch=150.5] | Loss=0.00907 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.401 | L2-Norm(final)=18.953 | 4891.4 samples/s | 76.4 steps/s
[Step=77200 Epoch=150.6] | Loss=0.00902 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.406 | L2-Norm(final)=18.958 | 4874.3 samples/s | 76.2 steps/s
[Step=77250 Epoch=150.7] | Loss=0.00883 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.411 | L2-Norm(final)=18.962 | 4898.4 samples/s | 76.5 steps/s
[Step=77300 Epoch=150.8] | Loss=0.00868 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.415 | L2-Norm(final)=18.966 | 4856.9 samples/s | 75.9 steps/s
[Step=77350 Epoch=150.9] | Loss=0.00864 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.420 | L2-Norm(final)=18.969 | 4775.6 samples/s | 74.6 steps/s
[Step=77400 Epoch=151.0] | Loss=0.00850 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.424 | L2-Norm(final)=18.973 | 4801.2 samples/s | 75.0 steps/s
[Step=77450 Epoch=151.1] | Loss=0.00853 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.428 | L2-Norm(final)=18.977 | 4729.0 samples/s | 73.9 steps/s
[Step=77500 Epoch=151.2] | Loss=0.00838 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.431 | L2-Norm(final)=18.980 | 5045.2 samples/s | 78.8 steps/s
[Step=77550 Epoch=151.3] | Loss=0.00829 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.435 | L2-Norm(final)=18.984 | 2040.1 samples/s | 31.9 steps/s
[Step=77600 Epoch=151.4] | Loss=0.00812 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.439 | L2-Norm(final)=18.987 | 4787.4 samples/s | 74.8 steps/s
[Step=77650 Epoch=151.4] | Loss=0.00793 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.443 | L2-Norm(final)=18.991 | 4741.7 samples/s | 74.1 steps/s
[Step=77700 Epoch=151.5] | Loss=0.00782 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.446 | L2-Norm(final)=18.994 | 4766.1 samples/s | 74.5 steps/s
[Step=77750 Epoch=151.6] | Loss=0.00788 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.449 | L2-Norm(final)=18.998 | 4687.2 samples/s | 73.2 steps/s
[Step=77800 Epoch=151.7] | Loss=0.00777 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.453 | L2-Norm(final)=19.001 | 4720.3 samples/s | 73.8 steps/s
[Step=77850 Epoch=151.8] | Loss=0.00772 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.456 | L2-Norm(final)=19.004 | 4812.2 samples/s | 75.2 steps/s
[Step=77900 Epoch=151.9] | Loss=0.00764 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.459 | L2-Norm(final)=19.008 | 4830.5 samples/s | 75.5 steps/s
[Step=77950 Epoch=152.0] | Loss=0.00764 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.462 | L2-Norm(final)=19.011 | 4708.7 samples/s | 73.6 steps/s
[Step=78000 Epoch=152.1] | Loss=0.00763 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.465 | L2-Norm(final)=19.015 | 4720.1 samples/s | 73.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step78000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=76001 Epoch=148.6] | Loss=0.02712 | Reg=0.00086 | acc=0.9688 | L2-Norm=9.285 | L2-Norm(final)=19.359 | 4316.1 samples/s | 67.4 steps/s
[Step=76050 Epoch=148.7] | Loss=0.01413 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.286 | L2-Norm(final)=19.373 | 5413.4 samples/s | 84.6 steps/s
[Step=76100 Epoch=148.8] | Loss=0.01327 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.286 | L2-Norm(final)=19.392 | 5579.6 samples/s | 87.2 steps/s
[Step=76150 Epoch=148.9] | Loss=0.01177 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.286 | L2-Norm(final)=19.412 | 5621.8 samples/s | 87.8 steps/s
[Step=76200 Epoch=149.0] | Loss=0.01144 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.286 | L2-Norm(final)=19.430 | 5619.0 samples/s | 87.8 steps/s
[Step=76250 Epoch=149.1] | Loss=0.01114 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.286 | L2-Norm(final)=19.447 | 5710.3 samples/s | 89.2 steps/s
[Step=76300 Epoch=149.2] | Loss=0.01095 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.286 | L2-Norm(final)=19.464 | 5605.4 samples/s | 87.6 steps/s
[Step=76350 Epoch=149.3] | Loss=0.01089 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.286 | L2-Norm(final)=19.481 | 5698.1 samples/s | 89.0 steps/s
[Step=76400 Epoch=149.4] | Loss=0.01087 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.286 | L2-Norm(final)=19.498 | 5542.1 samples/s | 86.6 steps/s
[Step=76450 Epoch=149.5] | Loss=0.01076 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.286 | L2-Norm(final)=19.514 | 5467.7 samples/s | 85.4 steps/s
[Step=76500 Epoch=149.6] | Loss=0.01074 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.286 | L2-Norm(final)=19.530 | 7157.5 samples/s | 111.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=76501 Epoch=149.6] | Loss=0.01286 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.286 | L2-Norm(final)=19.689 | 4550.6 samples/s | 71.1 steps/s
[Step=76550 Epoch=149.7] | Loss=0.00884 | Reg=0.00087 | acc=0.9688 | L2-Norm=9.305 | L2-Norm(final)=19.702 | 4371.9 samples/s | 68.3 steps/s
[Step=76600 Epoch=149.8] | Loss=0.00917 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.320 | L2-Norm(final)=19.709 | 4780.4 samples/s | 74.7 steps/s
[Step=76650 Epoch=149.8] | Loss=0.00898 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.333 | L2-Norm(final)=19.717 | 4699.3 samples/s | 73.4 steps/s
[Step=76700 Epoch=149.9] | Loss=0.00871 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.345 | L2-Norm(final)=19.724 | 4831.2 samples/s | 75.5 steps/s
[Step=76750 Epoch=150.0] | Loss=0.00886 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.355 | L2-Norm(final)=19.730 | 4721.5 samples/s | 73.8 steps/s
[Step=76800 Epoch=150.1] | Loss=0.00908 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.364 | L2-Norm(final)=19.736 | 4861.5 samples/s | 76.0 steps/s
[Step=76850 Epoch=150.2] | Loss=0.00891 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.373 | L2-Norm(final)=19.741 | 4725.1 samples/s | 73.8 steps/s
[Step=76900 Epoch=150.3] | Loss=0.00923 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.380 | L2-Norm(final)=19.747 | 4784.3 samples/s | 74.8 steps/s
[Step=76950 Epoch=150.4] | Loss=0.00938 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.387 | L2-Norm(final)=19.751 | 4762.3 samples/s | 74.4 steps/s
[Step=77000 Epoch=150.5] | Loss=0.00928 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.394 | L2-Norm(final)=19.756 | 5861.2 samples/s | 91.6 steps/s
[Step=77050 Epoch=150.6] | Loss=0.00929 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.401 | L2-Norm(final)=19.762 | 2051.4 samples/s | 32.1 steps/s
[Step=77100 Epoch=150.7] | Loss=0.00897 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.407 | L2-Norm(final)=19.766 | 4677.8 samples/s | 73.1 steps/s
[Step=77150 Epoch=150.8] | Loss=0.00882 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.413 | L2-Norm(final)=19.771 | 4775.4 samples/s | 74.6 steps/s
[Step=77200 Epoch=150.9] | Loss=0.00858 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.418 | L2-Norm(final)=19.775 | 4774.5 samples/s | 74.6 steps/s
[Step=77250 Epoch=151.0] | Loss=0.00852 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.423 | L2-Norm(final)=19.780 | 4675.8 samples/s | 73.1 steps/s
[Step=77300 Epoch=151.1] | Loss=0.00840 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.428 | L2-Norm(final)=19.784 | 4760.2 samples/s | 74.4 steps/s
[Step=77350 Epoch=151.2] | Loss=0.00818 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.433 | L2-Norm(final)=19.789 | 4768.0 samples/s | 74.5 steps/s
[Step=77400 Epoch=151.3] | Loss=0.00817 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.437 | L2-Norm(final)=19.793 | 4815.9 samples/s | 75.2 steps/s
[Step=77450 Epoch=151.4] | Loss=0.00805 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.441 | L2-Norm(final)=19.797 | 4809.7 samples/s | 75.2 steps/s
[Step=77500 Epoch=151.5] | Loss=0.00795 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.445 | L2-Norm(final)=19.801 | 5145.5 samples/s | 80.4 steps/s
[Step=77550 Epoch=151.6] | Loss=0.00781 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.449 | L2-Norm(final)=19.805 | 2099.8 samples/s | 32.8 steps/s
[Step=77600 Epoch=151.7] | Loss=0.00772 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.453 | L2-Norm(final)=19.809 | 4742.1 samples/s | 74.1 steps/s
[Step=77650 Epoch=151.8] | Loss=0.00760 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.456 | L2-Norm(final)=19.813 | 4869.3 samples/s | 76.1 steps/s
[Step=77700 Epoch=151.9] | Loss=0.00749 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.460 | L2-Norm(final)=19.817 | 4715.3 samples/s | 73.7 steps/s
[Step=77750 Epoch=152.0] | Loss=0.00737 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.463 | L2-Norm(final)=19.821 | 4764.8 samples/s | 74.4 steps/s
[Step=77800 Epoch=152.1] | Loss=0.00736 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.466 | L2-Norm(final)=19.825 | 4774.7 samples/s | 74.6 steps/s
[Step=77850 Epoch=152.2] | Loss=0.00727 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.470 | L2-Norm(final)=19.828 | 4727.7 samples/s | 73.9 steps/s
[Step=77900 Epoch=152.3] | Loss=0.00724 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.473 | L2-Norm(final)=19.832 | 4747.3 samples/s | 74.2 steps/s
[Step=77950 Epoch=152.4] | Loss=0.00718 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.476 | L2-Norm(final)=19.835 | 4754.9 samples/s | 74.3 steps/s
[Step=78000 Epoch=152.5] | Loss=0.00711 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.479 | L2-Norm(final)=19.839 | 4768.0 samples/s | 74.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step78000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=76001 Epoch=291.2] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.285 | L2-Norm(final)=18.704 | 4443.1 samples/s | 69.4 steps/s
[Step=76050 Epoch=291.4] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.277 | L2-Norm(final)=18.711 | 4572.8 samples/s | 71.4 steps/s
[Step=76100 Epoch=291.6] | Loss=0.00003 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.275 | L2-Norm(final)=18.718 | 5223.6 samples/s | 81.6 steps/s
[Step=76150 Epoch=291.8] | Loss=0.00003 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.275 | L2-Norm(final)=18.728 | 5087.5 samples/s | 79.5 steps/s
[Step=76200 Epoch=292.0] | Loss=0.00003 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.275 | L2-Norm(final)=18.737 | 5068.9 samples/s | 79.2 steps/s
[Step=76250 Epoch=292.2] | Loss=0.00003 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.275 | L2-Norm(final)=18.746 | 6751.4 samples/s | 105.5 steps/s
[Step=76300 Epoch=292.4] | Loss=0.00003 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.275 | L2-Norm(final)=18.754 | 2056.2 samples/s | 32.1 steps/s
[Step=76350 Epoch=292.5] | Loss=0.00003 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.275 | L2-Norm(final)=18.762 | 5126.7 samples/s | 80.1 steps/s
[Step=76400 Epoch=292.7] | Loss=0.00003 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.275 | L2-Norm(final)=18.769 | 5057.0 samples/s | 79.0 steps/s
[Step=76450 Epoch=292.9] | Loss=0.00003 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.275 | L2-Norm(final)=18.777 | 5166.4 samples/s | 80.7 steps/s
[Step=76500 Epoch=293.1] | Loss=0.00003 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.275 | L2-Norm(final)=18.785 | 5756.2 samples/s | 89.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=76501 Epoch=293.1] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.274 | L2-Norm(final)=18.867 | 4514.5 samples/s | 70.5 steps/s
[Step=76550 Epoch=293.3] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.246 | L2-Norm(final)=18.873 | 4103.4 samples/s | 64.1 steps/s
[Step=76600 Epoch=293.5] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.204 | L2-Norm(final)=18.876 | 4470.3 samples/s | 69.8 steps/s
[Step=76650 Epoch=293.7] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.160 | L2-Norm(final)=18.878 | 4504.7 samples/s | 70.4 steps/s
[Step=76700 Epoch=293.9] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.116 | L2-Norm(final)=18.881 | 4485.7 samples/s | 70.1 steps/s
[Step=76750 Epoch=294.1] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.073 | L2-Norm(final)=18.883 | 5627.4 samples/s | 87.9 steps/s
[Step=76800 Epoch=294.3] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.034 | L2-Norm(final)=18.885 | 1946.0 samples/s | 30.4 steps/s
[Step=76850 Epoch=294.5] | Loss=0.00000 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.996 | L2-Norm(final)=18.887 | 4475.2 samples/s | 69.9 steps/s
[Step=76900 Epoch=294.7] | Loss=0.00000 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.960 | L2-Norm(final)=18.889 | 4528.7 samples/s | 70.8 steps/s
[Step=76950 Epoch=294.8] | Loss=0.00000 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.925 | L2-Norm(final)=18.891 | 4555.1 samples/s | 71.2 steps/s
[Step=77000 Epoch=295.0] | Loss=0.00000 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.889 | L2-Norm(final)=18.893 | 4897.9 samples/s | 76.5 steps/s
[Step=77050 Epoch=295.2] | Loss=0.00000 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.855 | L2-Norm(final)=18.894 | 2061.6 samples/s | 32.2 steps/s
[Step=77100 Epoch=295.4] | Loss=0.00000 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.820 | L2-Norm(final)=18.896 | 4572.4 samples/s | 71.4 steps/s
[Step=77150 Epoch=295.6] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.786 | L2-Norm(final)=18.897 | 4509.1 samples/s | 70.5 steps/s
[Step=77200 Epoch=295.8] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.752 | L2-Norm(final)=18.898 | 4508.3 samples/s | 70.4 steps/s
[Step=77250 Epoch=296.0] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.718 | L2-Norm(final)=18.900 | 4422.2 samples/s | 69.1 steps/s
[Step=77300 Epoch=296.2] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.684 | L2-Norm(final)=18.901 | 2101.7 samples/s | 32.8 steps/s
[Step=77350 Epoch=296.4] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.650 | L2-Norm(final)=18.902 | 4533.9 samples/s | 70.8 steps/s
[Step=77400 Epoch=296.6] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.616 | L2-Norm(final)=18.903 | 4563.3 samples/s | 71.3 steps/s
[Step=77450 Epoch=296.8] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.582 | L2-Norm(final)=18.905 | 4511.0 samples/s | 70.5 steps/s
[Step=77500 Epoch=297.0] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.548 | L2-Norm(final)=18.906 | 4438.5 samples/s | 69.4 steps/s
[Step=77550 Epoch=297.1] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.514 | L2-Norm(final)=18.907 | 2096.0 samples/s | 32.8 steps/s
[Step=77600 Epoch=297.3] | Loss=0.00000 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.480 | L2-Norm(final)=18.909 | 4634.7 samples/s | 72.4 steps/s
[Step=77650 Epoch=297.5] | Loss=0.00000 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.446 | L2-Norm(final)=18.910 | 4557.3 samples/s | 71.2 steps/s
[Step=77700 Epoch=297.7] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.412 | L2-Norm(final)=18.912 | 4684.7 samples/s | 73.2 steps/s
[Step=77750 Epoch=297.9] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.378 | L2-Norm(final)=18.913 | 4683.3 samples/s | 73.2 steps/s
[Step=77800 Epoch=298.1] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.344 | L2-Norm(final)=18.915 | 6087.3 samples/s | 95.1 steps/s
[Step=77850 Epoch=298.3] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.310 | L2-Norm(final)=18.917 | 1885.5 samples/s | 29.5 steps/s
[Step=77900 Epoch=298.5] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.276 | L2-Norm(final)=18.919 | 4533.7 samples/s | 70.8 steps/s
[Step=77950 Epoch=298.7] | Loss=0.00000 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.242 | L2-Norm(final)=18.921 | 4482.6 samples/s | 70.0 steps/s
[Step=78000 Epoch=298.9] | Loss=0.00000 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.207 | L2-Norm(final)=18.923 | 4543.6 samples/s | 71.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step78000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=76001 Epoch=292.6] | Loss=0.00024 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.285 | L2-Norm(final)=18.597 | 4286.0 samples/s | 67.0 steps/s
[Step=76050 Epoch=292.7] | Loss=0.00004 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=18.599 | 4678.4 samples/s | 73.1 steps/s
[Step=76100 Epoch=292.9] | Loss=0.00005 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=18.601 | 5237.7 samples/s | 81.8 steps/s
[Step=76150 Epoch=293.1] | Loss=0.00005 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=18.603 | 4997.3 samples/s | 78.1 steps/s
[Step=76200 Epoch=293.3] | Loss=0.00005 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=18.605 | 5208.0 samples/s | 81.4 steps/s
[Step=76250 Epoch=293.5] | Loss=0.00005 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=18.607 | 6852.7 samples/s | 107.1 steps/s
[Step=76300 Epoch=293.7] | Loss=0.00005 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=18.609 | 2015.1 samples/s | 31.5 steps/s
[Step=76350 Epoch=293.9] | Loss=0.00005 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=18.611 | 5099.0 samples/s | 79.7 steps/s
[Step=76400 Epoch=294.1] | Loss=0.00005 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=18.613 | 5132.6 samples/s | 80.2 steps/s
[Step=76450 Epoch=294.3] | Loss=0.00005 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=18.615 | 5124.0 samples/s | 80.1 steps/s
[Step=76500 Epoch=294.5] | Loss=0.00005 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=18.617 | 5966.2 samples/s | 93.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=76501 Epoch=294.5] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=18.637 | 4191.0 samples/s | 65.5 steps/s
[Step=76550 Epoch=294.7] | Loss=0.00003 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.281 | L2-Norm(final)=18.639 | 4306.4 samples/s | 67.3 steps/s
[Step=76600 Epoch=294.9] | Loss=0.00003 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.280 | L2-Norm(final)=18.642 | 4492.3 samples/s | 70.2 steps/s
[Step=76650 Epoch=295.1] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.278 | L2-Norm(final)=18.644 | 4574.4 samples/s | 71.5 steps/s
[Step=76700 Epoch=295.2] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.275 | L2-Norm(final)=18.645 | 4439.9 samples/s | 69.4 steps/s
[Step=76750 Epoch=295.4] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.272 | L2-Norm(final)=18.647 | 5742.2 samples/s | 89.7 steps/s
[Step=76800 Epoch=295.6] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.268 | L2-Norm(final)=18.648 | 1960.8 samples/s | 30.6 steps/s
[Step=76850 Epoch=295.8] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.265 | L2-Norm(final)=18.649 | 4632.7 samples/s | 72.4 steps/s
[Step=76900 Epoch=296.0] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.261 | L2-Norm(final)=18.650 | 4435.3 samples/s | 69.3 steps/s
[Step=76950 Epoch=296.2] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.257 | L2-Norm(final)=18.651 | 4587.1 samples/s | 71.7 steps/s
[Step=77000 Epoch=296.4] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.253 | L2-Norm(final)=18.652 | 5063.8 samples/s | 79.1 steps/s
[Step=77050 Epoch=296.6] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.249 | L2-Norm(final)=18.653 | 2024.2 samples/s | 31.6 steps/s
[Step=77100 Epoch=296.8] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.245 | L2-Norm(final)=18.654 | 4521.6 samples/s | 70.6 steps/s
[Step=77150 Epoch=297.0] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.241 | L2-Norm(final)=18.655 | 4537.4 samples/s | 70.9 steps/s
[Step=77200 Epoch=297.2] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.236 | L2-Norm(final)=18.655 | 4418.8 samples/s | 69.0 steps/s
[Step=77250 Epoch=297.4] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.232 | L2-Norm(final)=18.656 | 4585.4 samples/s | 71.6 steps/s
[Step=77300 Epoch=297.6] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.228 | L2-Norm(final)=18.657 | 2093.2 samples/s | 32.7 steps/s
[Step=77350 Epoch=297.8] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.224 | L2-Norm(final)=18.658 | 4553.4 samples/s | 71.1 steps/s
[Step=77400 Epoch=297.9] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.219 | L2-Norm(final)=18.659 | 4504.4 samples/s | 70.4 steps/s
[Step=77450 Epoch=298.1] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.215 | L2-Norm(final)=18.659 | 4554.6 samples/s | 71.2 steps/s
[Step=77500 Epoch=298.3] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.210 | L2-Norm(final)=18.660 | 4456.0 samples/s | 69.6 steps/s
[Step=77550 Epoch=298.5] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.206 | L2-Norm(final)=18.661 | 2108.2 samples/s | 32.9 steps/s
[Step=77600 Epoch=298.7] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.201 | L2-Norm(final)=18.662 | 4513.7 samples/s | 70.5 steps/s
[Step=77650 Epoch=298.9] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.197 | L2-Norm(final)=18.662 | 4499.2 samples/s | 70.3 steps/s
[Step=77700 Epoch=299.1] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.192 | L2-Norm(final)=18.663 | 4554.6 samples/s | 71.2 steps/s
[Step=77750 Epoch=299.3] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.188 | L2-Norm(final)=18.664 | 4464.6 samples/s | 69.8 steps/s
[Step=77800 Epoch=299.5] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.183 | L2-Norm(final)=18.665 | 6647.8 samples/s | 103.9 steps/s
[Step=77850 Epoch=299.7] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.178 | L2-Norm(final)=18.665 | 1873.1 samples/s | 29.3 steps/s
[Step=77900 Epoch=299.9] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.173 | L2-Norm(final)=18.666 | 4515.5 samples/s | 70.6 steps/s
[Step=77950 Epoch=300.1] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.168 | L2-Norm(final)=18.667 | 4642.5 samples/s | 72.5 steps/s
[Step=78000 Epoch=300.3] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.163 | L2-Norm(final)=18.667 | 4546.7 samples/s | 71.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step78000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06307 | acc=0.9709 | tpr=0.9776 | fpr=0.0439 | 4379.0 samples/s | 17.1 steps/s
Avg test loss: 0.06285, Avg test acc: 0.97083, Avg tpr: 0.97791, Avg fpr: 0.04474, total FA: 349

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06749 | acc=0.9712 | tpr=0.9795 | fpr=0.0466 | 4026.6 samples/s | 15.7 steps/s
Avg test loss: 0.06775, Avg test acc: 0.97151, Avg tpr: 0.97989, Avg fpr: 0.04692, total FA: 366

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.86389 | acc=0.3125 | tpr=0.0168 | fpr=0.0453 | 4428.9 samples/s | 17.3 steps/s
Avg test loss: 4.88476, Avg test acc: 0.31080, Avg tpr: 0.01766, Avg fpr: 0.04448, total FA: 347

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.45740 | acc=0.3108 | tpr=0.0103 | fpr=0.0367 | 4398.7 samples/s | 17.2 steps/s
Avg test loss: 5.47422, Avg test acc: 0.30836, Avg tpr: 0.01037, Avg fpr: 0.03628, total FA: 283

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.32158 | acc=0.1223 | tpr=0.7301 | fpr=0.8886 | 4336.2 samples/s | 16.9 steps/s
[Step= 100] | Loss=5.30325 | acc=0.1222 | tpr=0.7228 | fpr=0.8890 | 8367.3 samples/s | 32.7 steps/s
[Step= 150] | Loss=5.31193 | acc=0.1216 | tpr=0.7233 | fpr=0.8894 | 8470.2 samples/s | 33.1 steps/s
[Step= 200] | Loss=5.31392 | acc=0.1212 | tpr=0.7060 | fpr=0.8894 | 4856.6 samples/s | 19.0 steps/s
[Step= 250] | Loss=5.32404 | acc=0.1211 | tpr=0.7092 | fpr=0.8897 | 8505.4 samples/s | 33.2 steps/s
[Step= 300] | Loss=5.32124 | acc=0.1212 | tpr=0.7113 | fpr=0.8896 | 8528.7 samples/s | 33.3 steps/s
[Step= 350] | Loss=5.32157 | acc=0.1206 | tpr=0.7132 | fpr=0.8902 | 8568.5 samples/s | 33.5 steps/s
[Step= 400] | Loss=5.32750 | acc=0.1205 | tpr=0.7112 | fpr=0.8903 | 8288.9 samples/s | 32.4 steps/s
[Step= 450] | Loss=5.33057 | acc=0.1205 | tpr=0.7128 | fpr=0.8902 | 8829.7 samples/s | 34.5 steps/s
[Step= 500] | Loss=5.33025 | acc=0.1204 | tpr=0.7172 | fpr=0.8904 | 8071.6 samples/s | 31.5 steps/s
[Step= 550] | Loss=5.33467 | acc=0.1204 | tpr=0.7151 | fpr=0.8904 | 14797.4 samples/s | 57.8 steps/s
Avg test loss: 5.33458, Avg test acc: 0.12024, Avg tpr: 0.71513, Avg fpr: 0.89057, total FA: 123654

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.73454 | acc=0.1280 | tpr=0.6947 | fpr=0.8822 | 4504.6 samples/s | 17.6 steps/s
[Step= 100] | Loss=5.72232 | acc=0.1266 | tpr=0.7058 | fpr=0.8842 | 8123.2 samples/s | 31.7 steps/s
[Step= 150] | Loss=5.72688 | acc=0.1267 | tpr=0.7118 | fpr=0.8841 | 8209.2 samples/s | 32.1 steps/s
[Step= 200] | Loss=5.72579 | acc=0.1263 | tpr=0.6951 | fpr=0.8841 | 4910.9 samples/s | 19.2 steps/s
[Step= 250] | Loss=5.73647 | acc=0.1262 | tpr=0.7004 | fpr=0.8843 | 8494.2 samples/s | 33.2 steps/s
[Step= 300] | Loss=5.73456 | acc=0.1261 | tpr=0.6953 | fpr=0.8843 | 8234.0 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.73164 | acc=0.1253 | tpr=0.6907 | fpr=0.8850 | 8417.9 samples/s | 32.9 steps/s
[Step= 400] | Loss=5.73693 | acc=0.1252 | tpr=0.6909 | fpr=0.8851 | 8512.2 samples/s | 33.3 steps/s
[Step= 450] | Loss=5.73930 | acc=0.1252 | tpr=0.6933 | fpr=0.8851 | 8504.9 samples/s | 33.2 steps/s
[Step= 500] | Loss=5.73827 | acc=0.1250 | tpr=0.6956 | fpr=0.8853 | 8383.3 samples/s | 32.7 steps/s
[Step= 550] | Loss=5.74257 | acc=0.1251 | tpr=0.6920 | fpr=0.8852 | 14680.5 samples/s | 57.3 steps/s
Avg test loss: 5.74255, Avg test acc: 0.12502, Avg tpr: 0.69216, Avg fpr: 0.88529, total FA: 122921

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13145 | acc=0.9761 | tpr=0.9558 | fpr=0.0235 | 4439.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.13710 | acc=0.9761 | tpr=0.9723 | fpr=0.0239 | 9152.9 samples/s | 35.8 steps/s
[Step= 150] | Loss=0.14178 | acc=0.9752 | tpr=0.9726 | fpr=0.0248 | 4875.7 samples/s | 19.0 steps/s
[Step= 200] | Loss=0.14253 | acc=0.9752 | tpr=0.9760 | fpr=0.0248 | 8131.8 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.14102 | acc=0.9754 | tpr=0.9755 | fpr=0.0246 | 8130.6 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.14256 | acc=0.9752 | tpr=0.9738 | fpr=0.0247 | 8055.4 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.14418 | acc=0.9750 | tpr=0.9743 | fpr=0.0250 | 8495.2 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.14545 | acc=0.9750 | tpr=0.9748 | fpr=0.0250 | 8372.2 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.14788 | acc=0.9747 | tpr=0.9732 | fpr=0.0253 | 8155.5 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.14763 | acc=0.9747 | tpr=0.9736 | fpr=0.0253 | 8396.8 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.14633 | acc=0.9748 | tpr=0.9729 | fpr=0.0252 | 14603.7 samples/s | 57.0 steps/s
Avg test loss: 0.14596, Avg test acc: 0.97480, Avg tpr: 0.97306, Avg fpr: 0.02517, total FA: 3495

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11398 | acc=0.9821 | tpr=0.9381 | fpr=0.0171 | 4455.2 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.12039 | acc=0.9819 | tpr=0.9616 | fpr=0.0177 | 8247.5 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.12465 | acc=0.9812 | tpr=0.9654 | fpr=0.0185 | 4863.5 samples/s | 19.0 steps/s
[Step= 200] | Loss=0.12541 | acc=0.9814 | tpr=0.9672 | fpr=0.0183 | 8255.0 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.12460 | acc=0.9816 | tpr=0.9651 | fpr=0.0181 | 8573.9 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.12539 | acc=0.9815 | tpr=0.9665 | fpr=0.0182 | 8883.1 samples/s | 34.7 steps/s
[Step= 350] | Loss=0.12668 | acc=0.9813 | tpr=0.9668 | fpr=0.0185 | 7928.2 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.12848 | acc=0.9810 | tpr=0.9666 | fpr=0.0187 | 9022.7 samples/s | 35.2 steps/s
[Step= 450] | Loss=0.13102 | acc=0.9808 | tpr=0.9649 | fpr=0.0189 | 7656.6 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.13075 | acc=0.9807 | tpr=0.9643 | fpr=0.0190 | 8612.4 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.12978 | acc=0.9808 | tpr=0.9622 | fpr=0.0188 | 14774.5 samples/s | 57.7 steps/s
Avg test loss: 0.12947, Avg test acc: 0.98087, Avg tpr: 0.96236, Avg fpr: 0.01879, total FA: 2609

server round 39/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=78001 Epoch=152.1] | Loss=0.02064 | Reg=0.00077 | acc=0.9844 | L2-Norm=8.759 | L2-Norm(final)=19.114 | 4128.0 samples/s | 64.5 steps/s
[Step=78050 Epoch=152.2] | Loss=0.01312 | Reg=0.00077 | acc=0.9844 | L2-Norm=8.760 | L2-Norm(final)=19.128 | 5431.1 samples/s | 84.9 steps/s
[Step=78100 Epoch=152.3] | Loss=0.01416 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.760 | L2-Norm(final)=19.145 | 5542.0 samples/s | 86.6 steps/s
[Step=78150 Epoch=152.4] | Loss=0.01331 | Reg=0.00077 | acc=0.9844 | L2-Norm=8.760 | L2-Norm(final)=19.163 | 5524.4 samples/s | 86.3 steps/s
[Step=78200 Epoch=152.5] | Loss=0.01258 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.760 | L2-Norm(final)=19.182 | 5508.2 samples/s | 86.1 steps/s
[Step=78250 Epoch=152.6] | Loss=0.01269 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.760 | L2-Norm(final)=19.201 | 5475.4 samples/s | 85.6 steps/s
[Step=78300 Epoch=152.7] | Loss=0.01257 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.760 | L2-Norm(final)=19.220 | 5461.0 samples/s | 85.3 steps/s
[Step=78350 Epoch=152.8] | Loss=0.01243 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.760 | L2-Norm(final)=19.238 | 5449.6 samples/s | 85.1 steps/s
[Step=78400 Epoch=152.9] | Loss=0.01254 | Reg=0.00077 | acc=0.9844 | L2-Norm=8.760 | L2-Norm(final)=19.256 | 5480.0 samples/s | 85.6 steps/s
[Step=78450 Epoch=153.0] | Loss=0.01256 | Reg=0.00077 | acc=0.9688 | L2-Norm=8.760 | L2-Norm(final)=19.274 | 5488.2 samples/s | 85.8 steps/s
[Step=78500 Epoch=153.1] | Loss=0.01275 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.760 | L2-Norm(final)=19.292 | 6806.2 samples/s | 106.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=78501 Epoch=153.1] | Loss=0.03232 | Reg=0.00077 | acc=0.9531 | L2-Norm=8.760 | L2-Norm(final)=19.469 | 4006.0 samples/s | 62.6 steps/s
[Step=78550 Epoch=153.2] | Loss=0.01424 | Reg=0.00077 | acc=0.9688 | L2-Norm=8.784 | L2-Norm(final)=19.485 | 4570.3 samples/s | 71.4 steps/s
[Step=78600 Epoch=153.3] | Loss=0.01303 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.806 | L2-Norm(final)=19.495 | 4723.1 samples/s | 73.8 steps/s
[Step=78650 Epoch=153.4] | Loss=0.01360 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.822 | L2-Norm(final)=19.503 | 4747.3 samples/s | 74.2 steps/s
[Step=78700 Epoch=153.5] | Loss=0.01346 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.836 | L2-Norm(final)=19.510 | 4698.3 samples/s | 73.4 steps/s
[Step=78750 Epoch=153.6] | Loss=0.01299 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.848 | L2-Norm(final)=19.517 | 4799.9 samples/s | 75.0 steps/s
[Step=78800 Epoch=153.7] | Loss=0.01267 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.859 | L2-Norm(final)=19.524 | 4697.3 samples/s | 73.4 steps/s
[Step=78850 Epoch=153.8] | Loss=0.01257 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.869 | L2-Norm(final)=19.531 | 4766.6 samples/s | 74.5 steps/s
[Step=78900 Epoch=153.9] | Loss=0.01209 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.878 | L2-Norm(final)=19.537 | 4760.8 samples/s | 74.4 steps/s
[Step=78950 Epoch=154.0] | Loss=0.01170 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.886 | L2-Norm(final)=19.544 | 4701.3 samples/s | 73.5 steps/s
[Step=79000 Epoch=154.1] | Loss=0.01143 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.894 | L2-Norm(final)=19.550 | 5814.6 samples/s | 90.9 steps/s
[Step=79050 Epoch=154.2] | Loss=0.01113 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.902 | L2-Norm(final)=19.556 | 1932.3 samples/s | 30.2 steps/s
[Step=79100 Epoch=154.3] | Loss=0.01101 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.909 | L2-Norm(final)=19.562 | 4684.3 samples/s | 73.2 steps/s
[Step=79150 Epoch=154.4] | Loss=0.01072 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.916 | L2-Norm(final)=19.567 | 4744.7 samples/s | 74.1 steps/s
[Step=79200 Epoch=154.5] | Loss=0.01048 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.922 | L2-Norm(final)=19.573 | 4694.8 samples/s | 73.4 steps/s
[Step=79250 Epoch=154.6] | Loss=0.01025 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.928 | L2-Norm(final)=19.578 | 4720.6 samples/s | 73.8 steps/s
[Step=79300 Epoch=154.7] | Loss=0.01001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.934 | L2-Norm(final)=19.583 | 4795.6 samples/s | 74.9 steps/s
[Step=79350 Epoch=154.8] | Loss=0.00982 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.940 | L2-Norm(final)=19.588 | 4810.5 samples/s | 75.2 steps/s
[Step=79400 Epoch=154.9] | Loss=0.00976 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.945 | L2-Norm(final)=19.594 | 4777.2 samples/s | 74.6 steps/s
[Step=79450 Epoch=155.0] | Loss=0.00959 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.950 | L2-Norm(final)=19.599 | 4824.8 samples/s | 75.4 steps/s
[Step=79500 Epoch=155.1] | Loss=0.00951 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.955 | L2-Norm(final)=19.603 | 4980.7 samples/s | 77.8 steps/s
[Step=79550 Epoch=155.2] | Loss=0.00940 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.960 | L2-Norm(final)=19.608 | 2049.9 samples/s | 32.0 steps/s
[Step=79600 Epoch=155.3] | Loss=0.00929 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.964 | L2-Norm(final)=19.613 | 4957.3 samples/s | 77.5 steps/s
[Step=79650 Epoch=155.3] | Loss=0.00912 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.969 | L2-Norm(final)=19.617 | 4835.2 samples/s | 75.5 steps/s
[Step=79700 Epoch=155.4] | Loss=0.00898 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.973 | L2-Norm(final)=19.622 | 4834.9 samples/s | 75.5 steps/s
[Step=79750 Epoch=155.5] | Loss=0.00882 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.977 | L2-Norm(final)=19.627 | 4825.0 samples/s | 75.4 steps/s
[Step=79800 Epoch=155.6] | Loss=0.00872 | Reg=0.00081 | acc=0.9844 | L2-Norm=8.981 | L2-Norm(final)=19.631 | 4743.6 samples/s | 74.1 steps/s
[Step=79850 Epoch=155.7] | Loss=0.00857 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.985 | L2-Norm(final)=19.636 | 4760.2 samples/s | 74.4 steps/s
[Step=79900 Epoch=155.8] | Loss=0.00845 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.989 | L2-Norm(final)=19.640 | 4809.9 samples/s | 75.2 steps/s
[Step=79950 Epoch=155.9] | Loss=0.00837 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.993 | L2-Norm(final)=19.645 | 4698.2 samples/s | 73.4 steps/s
[Step=80000 Epoch=156.0] | Loss=0.00841 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.997 | L2-Norm(final)=19.649 | 4765.6 samples/s | 74.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step80000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=78001 Epoch=152.5] | Loss=0.00776 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.759 | L2-Norm(final)=19.942 | 4696.5 samples/s | 73.4 steps/s
[Step=78050 Epoch=152.6] | Loss=0.01336 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.760 | L2-Norm(final)=19.960 | 4998.2 samples/s | 78.1 steps/s
[Step=78100 Epoch=152.7] | Loss=0.01302 | Reg=0.00077 | acc=0.9844 | L2-Norm=8.760 | L2-Norm(final)=19.982 | 5535.8 samples/s | 86.5 steps/s
[Step=78150 Epoch=152.8] | Loss=0.01296 | Reg=0.00077 | acc=0.9844 | L2-Norm=8.760 | L2-Norm(final)=20.003 | 5535.2 samples/s | 86.5 steps/s
[Step=78200 Epoch=152.9] | Loss=0.01288 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.760 | L2-Norm(final)=20.022 | 5554.6 samples/s | 86.8 steps/s
[Step=78250 Epoch=153.0] | Loss=0.01272 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.760 | L2-Norm(final)=20.042 | 5449.2 samples/s | 85.1 steps/s
[Step=78300 Epoch=153.1] | Loss=0.01244 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.760 | L2-Norm(final)=20.061 | 5437.3 samples/s | 85.0 steps/s
[Step=78350 Epoch=153.2] | Loss=0.01249 | Reg=0.00077 | acc=0.9844 | L2-Norm=8.760 | L2-Norm(final)=20.080 | 5489.2 samples/s | 85.8 steps/s
[Step=78400 Epoch=153.3] | Loss=0.01229 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.760 | L2-Norm(final)=20.099 | 5533.8 samples/s | 86.5 steps/s
[Step=78450 Epoch=153.4] | Loss=0.01222 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.760 | L2-Norm(final)=20.118 | 5541.3 samples/s | 86.6 steps/s
[Step=78500 Epoch=153.5] | Loss=0.01224 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.760 | L2-Norm(final)=20.136 | 6835.8 samples/s | 106.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=78501 Epoch=153.5] | Loss=0.01396 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.760 | L2-Norm(final)=20.324 | 4475.9 samples/s | 69.9 steps/s
[Step=78550 Epoch=153.6] | Loss=0.01247 | Reg=0.00077 | acc=0.9688 | L2-Norm=8.779 | L2-Norm(final)=20.338 | 4570.0 samples/s | 71.4 steps/s
[Step=78600 Epoch=153.7] | Loss=0.01248 | Reg=0.00077 | acc=0.9844 | L2-Norm=8.798 | L2-Norm(final)=20.348 | 4855.9 samples/s | 75.9 steps/s
[Step=78650 Epoch=153.8] | Loss=0.01264 | Reg=0.00078 | acc=0.9844 | L2-Norm=8.815 | L2-Norm(final)=20.357 | 4783.3 samples/s | 74.7 steps/s
[Step=78700 Epoch=153.9] | Loss=0.01234 | Reg=0.00078 | acc=0.9844 | L2-Norm=8.829 | L2-Norm(final)=20.366 | 4781.2 samples/s | 74.7 steps/s
[Step=78750 Epoch=154.0] | Loss=0.01159 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.841 | L2-Norm(final)=20.375 | 4692.2 samples/s | 73.3 steps/s
[Step=78800 Epoch=154.1] | Loss=0.01149 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.852 | L2-Norm(final)=20.383 | 4753.4 samples/s | 74.3 steps/s
[Step=78850 Epoch=154.1] | Loss=0.01138 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.862 | L2-Norm(final)=20.391 | 4724.9 samples/s | 73.8 steps/s
[Step=78900 Epoch=154.2] | Loss=0.01106 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.871 | L2-Norm(final)=20.398 | 4720.4 samples/s | 73.8 steps/s
[Step=78950 Epoch=154.3] | Loss=0.01073 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.880 | L2-Norm(final)=20.406 | 4751.5 samples/s | 74.2 steps/s
[Step=79000 Epoch=154.4] | Loss=0.01042 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.889 | L2-Norm(final)=20.413 | 5911.3 samples/s | 92.4 steps/s
[Step=79050 Epoch=154.5] | Loss=0.01016 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.896 | L2-Norm(final)=20.420 | 2003.2 samples/s | 31.3 steps/s
[Step=79100 Epoch=154.6] | Loss=0.00990 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.904 | L2-Norm(final)=20.427 | 4708.6 samples/s | 73.6 steps/s
[Step=79150 Epoch=154.7] | Loss=0.00965 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.911 | L2-Norm(final)=20.433 | 4664.0 samples/s | 72.9 steps/s
[Step=79200 Epoch=154.8] | Loss=0.00945 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.917 | L2-Norm(final)=20.440 | 4733.0 samples/s | 74.0 steps/s
[Step=79250 Epoch=154.9] | Loss=0.00923 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.923 | L2-Norm(final)=20.446 | 4754.6 samples/s | 74.3 steps/s
[Step=79300 Epoch=155.0] | Loss=0.00924 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.929 | L2-Norm(final)=20.452 | 4822.0 samples/s | 75.3 steps/s
[Step=79350 Epoch=155.1] | Loss=0.00921 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.935 | L2-Norm(final)=20.457 | 4773.3 samples/s | 74.6 steps/s
[Step=79400 Epoch=155.2] | Loss=0.00907 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.940 | L2-Norm(final)=20.462 | 4825.2 samples/s | 75.4 steps/s
[Step=79450 Epoch=155.3] | Loss=0.00901 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.945 | L2-Norm(final)=20.467 | 4726.9 samples/s | 73.9 steps/s
[Step=79500 Epoch=155.4] | Loss=0.00884 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.950 | L2-Norm(final)=20.472 | 5156.3 samples/s | 80.6 steps/s
[Step=79550 Epoch=155.5] | Loss=0.00873 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.955 | L2-Norm(final)=20.477 | 2116.2 samples/s | 33.1 steps/s
[Step=79600 Epoch=155.6] | Loss=0.00867 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.960 | L2-Norm(final)=20.482 | 4706.6 samples/s | 73.5 steps/s
[Step=79650 Epoch=155.7] | Loss=0.00855 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.965 | L2-Norm(final)=20.487 | 4734.8 samples/s | 74.0 steps/s
[Step=79700 Epoch=155.8] | Loss=0.00840 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.969 | L2-Norm(final)=20.492 | 4744.0 samples/s | 74.1 steps/s
[Step=79750 Epoch=155.9] | Loss=0.00827 | Reg=0.00081 | acc=0.9844 | L2-Norm=8.974 | L2-Norm(final)=20.496 | 4761.6 samples/s | 74.4 steps/s
[Step=79800 Epoch=156.0] | Loss=0.00814 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.978 | L2-Norm(final)=20.501 | 4709.2 samples/s | 73.6 steps/s
[Step=79850 Epoch=156.1] | Loss=0.00810 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.982 | L2-Norm(final)=20.506 | 4727.5 samples/s | 73.9 steps/s
[Step=79900 Epoch=156.2] | Loss=0.00798 | Reg=0.00081 | acc=0.9844 | L2-Norm=8.986 | L2-Norm(final)=20.510 | 4818.2 samples/s | 75.3 steps/s
[Step=79950 Epoch=156.3] | Loss=0.00790 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.990 | L2-Norm(final)=20.514 | 4736.2 samples/s | 74.0 steps/s
[Step=80000 Epoch=156.4] | Loss=0.00796 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.994 | L2-Norm(final)=20.519 | 4874.0 samples/s | 76.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step80000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=78001 Epoch=298.9] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.759 | L2-Norm(final)=18.989 | 3892.3 samples/s | 60.8 steps/s
[Step=78050 Epoch=299.1] | Loss=0.00003 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.751 | L2-Norm(final)=18.999 | 2292.1 samples/s | 35.8 steps/s
[Step=78100 Epoch=299.3] | Loss=0.00007 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.750 | L2-Norm(final)=18.999 | 4780.8 samples/s | 74.7 steps/s
[Step=78150 Epoch=299.4] | Loss=0.00006 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.750 | L2-Norm(final)=18.999 | 5177.9 samples/s | 80.9 steps/s
[Step=78200 Epoch=299.6] | Loss=0.00005 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.750 | L2-Norm(final)=18.999 | 4824.6 samples/s | 75.4 steps/s
[Step=78250 Epoch=299.8] | Loss=0.00006 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.750 | L2-Norm(final)=19.001 | 6674.1 samples/s | 104.3 steps/s
[Step=78300 Epoch=300.0] | Loss=0.00005 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.750 | L2-Norm(final)=19.002 | 2015.5 samples/s | 31.5 steps/s
[Step=78350 Epoch=300.2] | Loss=0.00005 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.750 | L2-Norm(final)=19.004 | 5122.0 samples/s | 80.0 steps/s
[Step=78400 Epoch=300.4] | Loss=0.00005 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.750 | L2-Norm(final)=19.007 | 5144.7 samples/s | 80.4 steps/s
[Step=78450 Epoch=300.6] | Loss=0.00005 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.750 | L2-Norm(final)=19.009 | 5163.3 samples/s | 80.7 steps/s
[Step=78500 Epoch=300.8] | Loss=0.00005 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.750 | L2-Norm(final)=19.013 | 5799.8 samples/s | 90.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=78501 Epoch=300.8] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.749 | L2-Norm(final)=19.054 | 4478.8 samples/s | 70.0 steps/s
[Step=78550 Epoch=301.0] | Loss=0.00035 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.765 | L2-Norm(final)=19.057 | 4280.1 samples/s | 66.9 steps/s
[Step=78600 Epoch=301.2] | Loss=0.00018 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.784 | L2-Norm(final)=19.053 | 4527.2 samples/s | 70.7 steps/s
[Step=78650 Epoch=301.4] | Loss=0.00013 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.788 | L2-Norm(final)=19.053 | 4572.3 samples/s | 71.4 steps/s
[Step=78700 Epoch=301.6] | Loss=0.00010 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.787 | L2-Norm(final)=19.053 | 4565.3 samples/s | 71.3 steps/s
[Step=78750 Epoch=301.7] | Loss=0.00008 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.785 | L2-Norm(final)=19.053 | 5542.7 samples/s | 86.6 steps/s
[Step=78800 Epoch=301.9] | Loss=0.00007 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.783 | L2-Norm(final)=19.054 | 1936.3 samples/s | 30.3 steps/s
[Step=78850 Epoch=302.1] | Loss=0.00006 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.779 | L2-Norm(final)=19.054 | 4470.2 samples/s | 69.8 steps/s
[Step=78900 Epoch=302.3] | Loss=0.00005 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.776 | L2-Norm(final)=19.054 | 4479.5 samples/s | 70.0 steps/s
[Step=78950 Epoch=302.5] | Loss=0.00005 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.772 | L2-Norm(final)=19.055 | 4562.4 samples/s | 71.3 steps/s
[Step=79000 Epoch=302.7] | Loss=0.00004 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.768 | L2-Norm(final)=19.055 | 4957.5 samples/s | 77.5 steps/s
[Step=79050 Epoch=302.9] | Loss=0.00004 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.764 | L2-Norm(final)=19.055 | 2069.0 samples/s | 32.3 steps/s
[Step=79100 Epoch=303.1] | Loss=0.00004 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.760 | L2-Norm(final)=19.056 | 4490.2 samples/s | 70.2 steps/s
[Step=79150 Epoch=303.3] | Loss=0.00003 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.756 | L2-Norm(final)=19.056 | 4553.1 samples/s | 71.1 steps/s
[Step=79200 Epoch=303.5] | Loss=0.00003 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.752 | L2-Norm(final)=19.056 | 4508.8 samples/s | 70.5 steps/s
[Step=79250 Epoch=303.7] | Loss=0.00003 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.748 | L2-Norm(final)=19.056 | 4555.4 samples/s | 71.2 steps/s
[Step=79300 Epoch=303.8] | Loss=0.00003 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.743 | L2-Norm(final)=19.057 | 2124.0 samples/s | 33.2 steps/s
[Step=79350 Epoch=304.0] | Loss=0.00003 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.739 | L2-Norm(final)=19.057 | 4634.3 samples/s | 72.4 steps/s
[Step=79400 Epoch=304.2] | Loss=0.00002 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.734 | L2-Norm(final)=19.057 | 4584.4 samples/s | 71.6 steps/s
[Step=79450 Epoch=304.4] | Loss=0.00002 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.730 | L2-Norm(final)=19.057 | 4506.4 samples/s | 70.4 steps/s
[Step=79500 Epoch=304.6] | Loss=0.00002 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.725 | L2-Norm(final)=19.058 | 4510.1 samples/s | 70.5 steps/s
[Step=79550 Epoch=304.8] | Loss=0.00002 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.721 | L2-Norm(final)=19.058 | 2137.3 samples/s | 33.4 steps/s
[Step=79600 Epoch=305.0] | Loss=0.00002 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.716 | L2-Norm(final)=19.058 | 4440.1 samples/s | 69.4 steps/s
[Step=79650 Epoch=305.2] | Loss=0.00002 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.711 | L2-Norm(final)=19.058 | 4582.9 samples/s | 71.6 steps/s
[Step=79700 Epoch=305.4] | Loss=0.00002 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.707 | L2-Norm(final)=19.058 | 4512.7 samples/s | 70.5 steps/s
[Step=79750 Epoch=305.6] | Loss=0.00002 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.702 | L2-Norm(final)=19.059 | 4635.6 samples/s | 72.4 steps/s
[Step=79800 Epoch=305.8] | Loss=0.00002 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.697 | L2-Norm(final)=19.059 | 6101.4 samples/s | 95.3 steps/s
[Step=79850 Epoch=306.0] | Loss=0.00002 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.692 | L2-Norm(final)=19.059 | 1923.8 samples/s | 30.1 steps/s
[Step=79900 Epoch=306.1] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.687 | L2-Norm(final)=19.059 | 4637.0 samples/s | 72.5 steps/s
[Step=79950 Epoch=306.3] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.682 | L2-Norm(final)=19.059 | 4617.0 samples/s | 72.1 steps/s
[Step=80000 Epoch=306.5] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.677 | L2-Norm(final)=19.059 | 4610.7 samples/s | 72.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step80000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=78001 Epoch=300.3] | Loss=0.00002 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.759 | L2-Norm(final)=18.689 | 4611.0 samples/s | 72.0 steps/s
[Step=78050 Epoch=300.4] | Loss=0.00013 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.757 | L2-Norm(final)=18.696 | 4676.9 samples/s | 73.1 steps/s
[Step=78100 Epoch=300.6] | Loss=0.00014 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.757 | L2-Norm(final)=18.704 | 5009.8 samples/s | 78.3 steps/s
[Step=78150 Epoch=300.8] | Loss=0.00014 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.757 | L2-Norm(final)=18.712 | 5223.0 samples/s | 81.6 steps/s
[Step=78200 Epoch=301.0] | Loss=0.00013 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.757 | L2-Norm(final)=18.720 | 5098.9 samples/s | 79.7 steps/s
[Step=78250 Epoch=301.2] | Loss=0.00014 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.757 | L2-Norm(final)=18.728 | 6782.0 samples/s | 106.0 steps/s
[Step=78300 Epoch=301.4] | Loss=0.00013 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.757 | L2-Norm(final)=18.735 | 2058.9 samples/s | 32.2 steps/s
[Step=78350 Epoch=301.6] | Loss=0.00013 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.757 | L2-Norm(final)=18.742 | 5284.7 samples/s | 82.6 steps/s
[Step=78400 Epoch=301.8] | Loss=0.00013 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.757 | L2-Norm(final)=18.748 | 5212.1 samples/s | 81.4 steps/s
[Step=78450 Epoch=302.0] | Loss=0.00013 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.757 | L2-Norm(final)=18.756 | 5287.4 samples/s | 82.6 steps/s
[Step=78500 Epoch=302.2] | Loss=0.00013 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.757 | L2-Norm(final)=18.763 | 6213.0 samples/s | 97.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=78501 Epoch=302.2] | Loss=0.00002 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.757 | L2-Norm(final)=18.832 | 4341.2 samples/s | 67.8 steps/s
[Step=78550 Epoch=302.4] | Loss=0.00009 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.765 | L2-Norm(final)=18.837 | 4392.8 samples/s | 68.6 steps/s
[Step=78600 Epoch=302.6] | Loss=0.00005 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.770 | L2-Norm(final)=18.840 | 4540.1 samples/s | 70.9 steps/s
[Step=78650 Epoch=302.8] | Loss=0.00004 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.767 | L2-Norm(final)=18.842 | 4536.9 samples/s | 70.9 steps/s
[Step=78700 Epoch=302.9] | Loss=0.00003 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.762 | L2-Norm(final)=18.843 | 4483.2 samples/s | 70.1 steps/s
[Step=78750 Epoch=303.1] | Loss=0.00003 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.756 | L2-Norm(final)=18.845 | 5718.2 samples/s | 89.3 steps/s
[Step=78800 Epoch=303.3] | Loss=0.00002 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.749 | L2-Norm(final)=18.846 | 1958.5 samples/s | 30.6 steps/s
[Step=78850 Epoch=303.5] | Loss=0.00002 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.742 | L2-Norm(final)=18.846 | 4608.0 samples/s | 72.0 steps/s
[Step=78900 Epoch=303.7] | Loss=0.00002 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.735 | L2-Norm(final)=18.847 | 4673.6 samples/s | 73.0 steps/s
[Step=78950 Epoch=303.9] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.728 | L2-Norm(final)=18.848 | 4579.9 samples/s | 71.6 steps/s
[Step=79000 Epoch=304.1] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.720 | L2-Norm(final)=18.848 | 5273.8 samples/s | 82.4 steps/s
[Step=79050 Epoch=304.3] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.712 | L2-Norm(final)=18.849 | 2043.8 samples/s | 31.9 steps/s
[Step=79100 Epoch=304.5] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.704 | L2-Norm(final)=18.849 | 4708.3 samples/s | 73.6 steps/s
[Step=79150 Epoch=304.7] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.697 | L2-Norm(final)=18.850 | 4647.6 samples/s | 72.6 steps/s
[Step=79200 Epoch=304.9] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.689 | L2-Norm(final)=18.850 | 4574.3 samples/s | 71.5 steps/s
[Step=79250 Epoch=305.1] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.680 | L2-Norm(final)=18.851 | 4588.7 samples/s | 71.7 steps/s
[Step=79300 Epoch=305.3] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.672 | L2-Norm(final)=18.851 | 2115.5 samples/s | 33.1 steps/s
[Step=79350 Epoch=305.4] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.664 | L2-Norm(final)=18.852 | 4586.6 samples/s | 71.7 steps/s
[Step=79400 Epoch=305.6] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.656 | L2-Norm(final)=18.852 | 4544.6 samples/s | 71.0 steps/s
[Step=79450 Epoch=305.8] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.647 | L2-Norm(final)=18.852 | 4488.2 samples/s | 70.1 steps/s
[Step=79500 Epoch=306.0] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.639 | L2-Norm(final)=18.853 | 4542.2 samples/s | 71.0 steps/s
[Step=79550 Epoch=306.2] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.630 | L2-Norm(final)=18.853 | 2129.5 samples/s | 33.3 steps/s
[Step=79600 Epoch=306.4] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.622 | L2-Norm(final)=18.854 | 4694.8 samples/s | 73.4 steps/s
[Step=79650 Epoch=306.6] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.613 | L2-Norm(final)=18.854 | 4505.6 samples/s | 70.4 steps/s
[Step=79700 Epoch=306.8] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.604 | L2-Norm(final)=18.855 | 4502.1 samples/s | 70.3 steps/s
[Step=79750 Epoch=307.0] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.595 | L2-Norm(final)=18.855 | 4539.4 samples/s | 70.9 steps/s
[Step=79800 Epoch=307.2] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.586 | L2-Norm(final)=18.855 | 6659.4 samples/s | 104.1 steps/s
[Step=79850 Epoch=307.4] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.577 | L2-Norm(final)=18.856 | 1858.1 samples/s | 29.0 steps/s
[Step=79900 Epoch=307.6] | Loss=0.00001 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.568 | L2-Norm(final)=18.856 | 4462.7 samples/s | 69.7 steps/s
[Step=79950 Epoch=307.8] | Loss=0.00001 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.559 | L2-Norm(final)=18.857 | 4567.9 samples/s | 71.4 steps/s
[Step=80000 Epoch=308.0] | Loss=0.00001 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.550 | L2-Norm(final)=18.857 | 4419.9 samples/s | 69.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step80000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05990 | acc=0.9702 | tpr=0.9759 | fpr=0.0424 | 4434.9 samples/s | 17.3 steps/s
Avg test loss: 0.06000, Avg test acc: 0.97071, Avg tpr: 0.97709, Avg fpr: 0.04333, total FA: 338

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06033 | acc=0.9698 | tpr=0.9738 | fpr=0.0389 | 4404.8 samples/s | 17.2 steps/s
Avg test loss: 0.06114, Avg test acc: 0.96959, Avg tpr: 0.97505, Avg fpr: 0.04243, total FA: 331

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.37565 | acc=0.3168 | tpr=0.0064 | fpr=0.0092 | 4369.9 samples/s | 17.1 steps/s
Avg test loss: 5.39592, Avg test acc: 0.31417, Avg tpr: 0.00694, Avg fpr: 0.01013, total FA: 79

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.43030 | acc=0.3123 | tpr=0.0086 | fpr=0.0280 | 4475.7 samples/s | 17.5 steps/s
Avg test loss: 5.44866, Avg test acc: 0.31004, Avg tpr: 0.00915, Avg fpr: 0.02820, total FA: 220

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.05131 | acc=0.1289 | tpr=0.7301 | fpr=0.8819 | 4393.2 samples/s | 17.2 steps/s
[Step= 100] | Loss=5.03452 | acc=0.1279 | tpr=0.7313 | fpr=0.8834 | 8473.6 samples/s | 33.1 steps/s
[Step= 150] | Loss=5.04079 | acc=0.1270 | tpr=0.7190 | fpr=0.8839 | 8425.6 samples/s | 32.9 steps/s
[Step= 200] | Loss=5.04210 | acc=0.1263 | tpr=0.6995 | fpr=0.8841 | 8400.1 samples/s | 32.8 steps/s
[Step= 250] | Loss=5.05047 | acc=0.1262 | tpr=0.7031 | fpr=0.8844 | 8465.0 samples/s | 33.1 steps/s
[Step= 300] | Loss=5.04676 | acc=0.1259 | tpr=0.7025 | fpr=0.8846 | 8951.6 samples/s | 35.0 steps/s
[Step= 350] | Loss=5.04687 | acc=0.1254 | tpr=0.7038 | fpr=0.8851 | 7964.1 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.05258 | acc=0.1254 | tpr=0.7024 | fpr=0.8851 | 8472.4 samples/s | 33.1 steps/s
[Step= 450] | Loss=5.05523 | acc=0.1253 | tpr=0.7040 | fpr=0.8852 | 8257.8 samples/s | 32.3 steps/s
[Step= 500] | Loss=5.05475 | acc=0.1252 | tpr=0.7084 | fpr=0.8853 | 8215.5 samples/s | 32.1 steps/s
[Step= 550] | Loss=5.05948 | acc=0.1251 | tpr=0.7059 | fpr=0.8855 | 15460.5 samples/s | 60.4 steps/s
Avg test loss: 5.05937, Avg test acc: 0.12498, Avg tpr: 0.70602, Avg fpr: 0.88558, total FA: 122961

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.62003 | acc=0.1421 | tpr=0.6947 | fpr=0.8678 | 4412.5 samples/s | 17.2 steps/s
[Step= 100] | Loss=4.60606 | acc=0.1421 | tpr=0.7036 | fpr=0.8683 | 8475.7 samples/s | 33.1 steps/s
[Step= 150] | Loss=4.60929 | acc=0.1418 | tpr=0.6960 | fpr=0.8684 | 8330.8 samples/s | 32.5 steps/s
[Step= 200] | Loss=4.60951 | acc=0.1421 | tpr=0.6852 | fpr=0.8678 | 8392.7 samples/s | 32.8 steps/s
[Step= 250] | Loss=4.61825 | acc=0.1422 | tpr=0.6865 | fpr=0.8677 | 8745.8 samples/s | 34.2 steps/s
[Step= 300] | Loss=4.61634 | acc=0.1416 | tpr=0.6800 | fpr=0.8682 | 8193.4 samples/s | 32.0 steps/s
[Step= 350] | Loss=4.61327 | acc=0.1409 | tpr=0.6788 | fpr=0.8688 | 9057.1 samples/s | 35.4 steps/s
[Step= 400] | Loss=4.61847 | acc=0.1410 | tpr=0.6783 | fpr=0.8688 | 8121.4 samples/s | 31.7 steps/s
[Step= 450] | Loss=4.62048 | acc=0.1409 | tpr=0.6821 | fpr=0.8690 | 8274.0 samples/s | 32.3 steps/s
[Step= 500] | Loss=4.61935 | acc=0.1409 | tpr=0.6868 | fpr=0.8689 | 8238.0 samples/s | 32.2 steps/s
[Step= 550] | Loss=4.62347 | acc=0.1409 | tpr=0.6828 | fpr=0.8689 | 16238.7 samples/s | 63.4 steps/s
Avg test loss: 4.62344, Avg test acc: 0.14086, Avg tpr: 0.68344, Avg fpr: 0.86901, total FA: 120660

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11616 | acc=0.9832 | tpr=0.9292 | fpr=0.0158 | 4339.6 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.12138 | acc=0.9831 | tpr=0.9531 | fpr=0.0164 | 8484.0 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.12471 | acc=0.9827 | tpr=0.9539 | fpr=0.0168 | 8340.4 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.12617 | acc=0.9825 | tpr=0.9563 | fpr=0.0170 | 8131.7 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.12427 | acc=0.9828 | tpr=0.9555 | fpr=0.0168 | 8820.1 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.12591 | acc=0.9826 | tpr=0.9556 | fpr=0.0169 | 7831.8 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.12734 | acc=0.9826 | tpr=0.9562 | fpr=0.0170 | 8276.7 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.12859 | acc=0.9824 | tpr=0.9540 | fpr=0.0171 | 8345.2 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.13098 | acc=0.9821 | tpr=0.9533 | fpr=0.0174 | 8462.6 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.13034 | acc=0.9821 | tpr=0.9529 | fpr=0.0174 | 8265.5 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.12925 | acc=0.9822 | tpr=0.9499 | fpr=0.0172 | 15469.0 samples/s | 60.4 steps/s
Avg test loss: 0.12889, Avg test acc: 0.98221, Avg tpr: 0.95008, Avg fpr: 0.01721, total FA: 2389

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11141 | acc=0.9818 | tpr=0.9425 | fpr=0.0175 | 4445.6 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.11786 | acc=0.9816 | tpr=0.9616 | fpr=0.0181 | 8148.9 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.12227 | acc=0.9810 | tpr=0.9654 | fpr=0.0187 | 8530.3 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.12311 | acc=0.9811 | tpr=0.9683 | fpr=0.0187 | 8523.3 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.12222 | acc=0.9811 | tpr=0.9668 | fpr=0.0186 | 8238.5 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.12319 | acc=0.9812 | tpr=0.9680 | fpr=0.0186 | 8495.5 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.12443 | acc=0.9809 | tpr=0.9674 | fpr=0.0189 | 8181.4 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.12610 | acc=0.9808 | tpr=0.9672 | fpr=0.0190 | 8197.9 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.12869 | acc=0.9805 | tpr=0.9654 | fpr=0.0192 | 8565.7 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.12843 | acc=0.9805 | tpr=0.9656 | fpr=0.0192 | 8121.8 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.12742 | acc=0.9806 | tpr=0.9642 | fpr=0.0191 | 15455.8 samples/s | 60.4 steps/s
Avg test loss: 0.12710, Avg test acc: 0.98061, Avg tpr: 0.96434, Avg fpr: 0.01909, total FA: 2651

server round 40/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=80001 Epoch=156.0] | Loss=0.01355 | Reg=0.00075 | acc=0.9844 | L2-Norm=8.688 | L2-Norm(final)=19.776 | 4075.7 samples/s | 63.7 steps/s
[Step=80050 Epoch=156.1] | Loss=0.01086 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.689 | L2-Norm(final)=19.783 | 5480.6 samples/s | 85.6 steps/s
[Step=80100 Epoch=156.2] | Loss=0.01113 | Reg=0.00075 | acc=0.9844 | L2-Norm=8.689 | L2-Norm(final)=19.792 | 5524.3 samples/s | 86.3 steps/s
[Step=80150 Epoch=156.3] | Loss=0.01123 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.689 | L2-Norm(final)=19.801 | 5431.6 samples/s | 84.9 steps/s
[Step=80200 Epoch=156.4] | Loss=0.01228 | Reg=0.00075 | acc=0.9844 | L2-Norm=8.689 | L2-Norm(final)=19.809 | 5536.8 samples/s | 86.5 steps/s
[Step=80250 Epoch=156.5] | Loss=0.01236 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.689 | L2-Norm(final)=19.817 | 5369.4 samples/s | 83.9 steps/s
[Step=80300 Epoch=156.6] | Loss=0.01256 | Reg=0.00075 | acc=0.9844 | L2-Norm=8.689 | L2-Norm(final)=19.825 | 5509.3 samples/s | 86.1 steps/s
[Step=80350 Epoch=156.7] | Loss=0.01253 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.689 | L2-Norm(final)=19.833 | 5473.3 samples/s | 85.5 steps/s
[Step=80400 Epoch=156.8] | Loss=0.01262 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.689 | L2-Norm(final)=19.841 | 5481.9 samples/s | 85.7 steps/s
[Step=80450 Epoch=156.9] | Loss=0.01270 | Reg=0.00075 | acc=0.9844 | L2-Norm=8.689 | L2-Norm(final)=19.849 | 5548.7 samples/s | 86.7 steps/s
[Step=80500 Epoch=157.0] | Loss=0.01269 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.689 | L2-Norm(final)=19.856 | 6793.0 samples/s | 106.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=80501 Epoch=157.0] | Loss=0.02156 | Reg=0.00075 | acc=0.9844 | L2-Norm=8.689 | L2-Norm(final)=19.931 | 3859.0 samples/s | 60.3 steps/s
[Step=80550 Epoch=157.1] | Loss=0.01233 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.697 | L2-Norm(final)=19.939 | 4675.8 samples/s | 73.1 steps/s
[Step=80600 Epoch=157.2] | Loss=0.01136 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.706 | L2-Norm(final)=19.945 | 4695.8 samples/s | 73.4 steps/s
[Step=80650 Epoch=157.3] | Loss=0.01081 | Reg=0.00076 | acc=0.9844 | L2-Norm=8.713 | L2-Norm(final)=19.951 | 4805.7 samples/s | 75.1 steps/s
[Step=80700 Epoch=157.4] | Loss=0.01019 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.719 | L2-Norm(final)=19.955 | 4938.1 samples/s | 77.2 steps/s
[Step=80750 Epoch=157.5] | Loss=0.01004 | Reg=0.00076 | acc=0.9844 | L2-Norm=8.725 | L2-Norm(final)=19.960 | 4823.2 samples/s | 75.4 steps/s
[Step=80800 Epoch=157.6] | Loss=0.01002 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.730 | L2-Norm(final)=19.964 | 4911.4 samples/s | 76.7 steps/s
[Step=80850 Epoch=157.7] | Loss=0.00971 | Reg=0.00076 | acc=0.9844 | L2-Norm=8.735 | L2-Norm(final)=19.969 | 4928.8 samples/s | 77.0 steps/s
[Step=80900 Epoch=157.8] | Loss=0.00933 | Reg=0.00076 | acc=0.9844 | L2-Norm=8.740 | L2-Norm(final)=19.973 | 4914.8 samples/s | 76.8 steps/s
[Step=80950 Epoch=157.9] | Loss=0.00920 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.745 | L2-Norm(final)=19.977 | 4832.6 samples/s | 75.5 steps/s
[Step=81000 Epoch=158.0] | Loss=0.00890 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.749 | L2-Norm(final)=19.982 | 5962.4 samples/s | 93.2 steps/s
[Step=81050 Epoch=158.1] | Loss=0.00853 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.754 | L2-Norm(final)=19.986 | 2011.7 samples/s | 31.4 steps/s
[Step=81100 Epoch=158.2] | Loss=0.00834 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.758 | L2-Norm(final)=19.990 | 4813.1 samples/s | 75.2 steps/s
[Step=81150 Epoch=158.3] | Loss=0.00805 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.762 | L2-Norm(final)=19.995 | 4870.1 samples/s | 76.1 steps/s
[Step=81200 Epoch=158.4] | Loss=0.00789 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.766 | L2-Norm(final)=19.999 | 4777.0 samples/s | 74.6 steps/s
[Step=81250 Epoch=158.5] | Loss=0.00761 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.769 | L2-Norm(final)=20.003 | 4699.5 samples/s | 73.4 steps/s
[Step=81300 Epoch=158.6] | Loss=0.00756 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.773 | L2-Norm(final)=20.007 | 4766.2 samples/s | 74.5 steps/s
[Step=81350 Epoch=158.7] | Loss=0.00755 | Reg=0.00077 | acc=0.9844 | L2-Norm=8.776 | L2-Norm(final)=20.010 | 4745.4 samples/s | 74.1 steps/s
[Step=81400 Epoch=158.8] | Loss=0.00752 | Reg=0.00077 | acc=0.9844 | L2-Norm=8.779 | L2-Norm(final)=20.014 | 4728.1 samples/s | 73.9 steps/s
[Step=81450 Epoch=158.9] | Loss=0.00752 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.782 | L2-Norm(final)=20.017 | 4777.7 samples/s | 74.7 steps/s
[Step=81500 Epoch=159.0] | Loss=0.00751 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.785 | L2-Norm(final)=20.021 | 4998.8 samples/s | 78.1 steps/s
[Step=81550 Epoch=159.1] | Loss=0.00742 | Reg=0.00077 | acc=0.9844 | L2-Norm=8.788 | L2-Norm(final)=20.024 | 2046.0 samples/s | 32.0 steps/s
[Step=81600 Epoch=159.2] | Loss=0.00723 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.791 | L2-Norm(final)=20.028 | 4808.2 samples/s | 75.1 steps/s
[Step=81650 Epoch=159.2] | Loss=0.00719 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.794 | L2-Norm(final)=20.031 | 4783.0 samples/s | 74.7 steps/s
[Step=81700 Epoch=159.3] | Loss=0.00710 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.797 | L2-Norm(final)=20.035 | 4797.0 samples/s | 75.0 steps/s
[Step=81750 Epoch=159.4] | Loss=0.00707 | Reg=0.00077 | acc=0.9844 | L2-Norm=8.800 | L2-Norm(final)=20.038 | 4819.0 samples/s | 75.3 steps/s
[Step=81800 Epoch=159.5] | Loss=0.00702 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.802 | L2-Norm(final)=20.041 | 4754.5 samples/s | 74.3 steps/s
[Step=81850 Epoch=159.6] | Loss=0.00694 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.805 | L2-Norm(final)=20.045 | 4775.8 samples/s | 74.6 steps/s
[Step=81900 Epoch=159.7] | Loss=0.00688 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.807 | L2-Norm(final)=20.048 | 4805.2 samples/s | 75.1 steps/s
[Step=81950 Epoch=159.8] | Loss=0.00691 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.810 | L2-Norm(final)=20.051 | 4781.7 samples/s | 74.7 steps/s
[Step=82000 Epoch=159.9] | Loss=0.00690 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.812 | L2-Norm(final)=20.054 | 4783.2 samples/s | 74.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step82000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=80001 Epoch=156.4] | Loss=0.00452 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.688 | L2-Norm(final)=20.647 | 4260.8 samples/s | 66.6 steps/s
[Step=80050 Epoch=156.5] | Loss=0.01235 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.689 | L2-Norm(final)=20.653 | 5195.9 samples/s | 81.2 steps/s
[Step=80100 Epoch=156.6] | Loss=0.01237 | Reg=0.00075 | acc=0.9844 | L2-Norm=8.689 | L2-Norm(final)=20.659 | 5498.7 samples/s | 85.9 steps/s
[Step=80150 Epoch=156.7] | Loss=0.01239 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.689 | L2-Norm(final)=20.666 | 5377.7 samples/s | 84.0 steps/s
[Step=80200 Epoch=156.8] | Loss=0.01206 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.689 | L2-Norm(final)=20.672 | 5505.7 samples/s | 86.0 steps/s
[Step=80250 Epoch=156.9] | Loss=0.01227 | Reg=0.00075 | acc=0.9844 | L2-Norm=8.689 | L2-Norm(final)=20.678 | 5421.9 samples/s | 84.7 steps/s
[Step=80300 Epoch=157.0] | Loss=0.01237 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.689 | L2-Norm(final)=20.684 | 5518.0 samples/s | 86.2 steps/s
[Step=80350 Epoch=157.1] | Loss=0.01223 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.689 | L2-Norm(final)=20.690 | 5566.7 samples/s | 87.0 steps/s
[Step=80400 Epoch=157.2] | Loss=0.01231 | Reg=0.00075 | acc=0.9844 | L2-Norm=8.689 | L2-Norm(final)=20.695 | 5392.3 samples/s | 84.3 steps/s
[Step=80450 Epoch=157.3] | Loss=0.01250 | Reg=0.00075 | acc=0.9844 | L2-Norm=8.689 | L2-Norm(final)=20.701 | 5560.5 samples/s | 86.9 steps/s
[Step=80500 Epoch=157.4] | Loss=0.01256 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.689 | L2-Norm(final)=20.707 | 6821.2 samples/s | 106.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=80501 Epoch=157.4] | Loss=0.00917 | Reg=0.00075 | acc=0.9844 | L2-Norm=8.689 | L2-Norm(final)=20.763 | 4412.2 samples/s | 68.9 steps/s
[Step=80550 Epoch=157.5] | Loss=0.01043 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.697 | L2-Norm(final)=20.770 | 4459.1 samples/s | 69.7 steps/s
[Step=80600 Epoch=157.6] | Loss=0.01042 | Reg=0.00076 | acc=0.9844 | L2-Norm=8.705 | L2-Norm(final)=20.776 | 4829.9 samples/s | 75.5 steps/s
[Step=80650 Epoch=157.7] | Loss=0.01065 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.711 | L2-Norm(final)=20.781 | 4806.1 samples/s | 75.1 steps/s
[Step=80700 Epoch=157.8] | Loss=0.01059 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.717 | L2-Norm(final)=20.786 | 4724.3 samples/s | 73.8 steps/s
[Step=80750 Epoch=157.9] | Loss=0.01014 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.723 | L2-Norm(final)=20.790 | 4655.3 samples/s | 72.7 steps/s
[Step=80800 Epoch=158.0] | Loss=0.00984 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.728 | L2-Norm(final)=20.795 | 4744.3 samples/s | 74.1 steps/s
[Step=80850 Epoch=158.1] | Loss=0.00931 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.733 | L2-Norm(final)=20.800 | 4728.2 samples/s | 73.9 steps/s
[Step=80900 Epoch=158.2] | Loss=0.00922 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.738 | L2-Norm(final)=20.804 | 4793.8 samples/s | 74.9 steps/s
[Step=80950 Epoch=158.3] | Loss=0.00884 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.742 | L2-Norm(final)=20.809 | 4727.0 samples/s | 73.9 steps/s
[Step=81000 Epoch=158.4] | Loss=0.00854 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.746 | L2-Norm(final)=20.813 | 5915.9 samples/s | 92.4 steps/s
[Step=81050 Epoch=158.5] | Loss=0.00825 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.751 | L2-Norm(final)=20.818 | 2012.3 samples/s | 31.4 steps/s
[Step=81100 Epoch=158.5] | Loss=0.00799 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.754 | L2-Norm(final)=20.822 | 4725.1 samples/s | 73.8 steps/s
[Step=81150 Epoch=158.6] | Loss=0.00767 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.758 | L2-Norm(final)=20.827 | 4758.8 samples/s | 74.4 steps/s
[Step=81200 Epoch=158.7] | Loss=0.00749 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.762 | L2-Norm(final)=20.831 | 4837.8 samples/s | 75.6 steps/s
[Step=81250 Epoch=158.8] | Loss=0.00743 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.765 | L2-Norm(final)=20.835 | 4694.9 samples/s | 73.4 steps/s
[Step=81300 Epoch=158.9] | Loss=0.00728 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.768 | L2-Norm(final)=20.839 | 4886.0 samples/s | 76.3 steps/s
[Step=81350 Epoch=159.0] | Loss=0.00727 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.772 | L2-Norm(final)=20.843 | 4737.7 samples/s | 74.0 steps/s
[Step=81400 Epoch=159.1] | Loss=0.00728 | Reg=0.00077 | acc=0.9844 | L2-Norm=8.775 | L2-Norm(final)=20.847 | 4828.4 samples/s | 75.4 steps/s
[Step=81450 Epoch=159.2] | Loss=0.00722 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.778 | L2-Norm(final)=20.851 | 4719.9 samples/s | 73.7 steps/s
[Step=81500 Epoch=159.3] | Loss=0.00712 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.781 | L2-Norm(final)=20.855 | 5177.6 samples/s | 80.9 steps/s
[Step=81550 Epoch=159.4] | Loss=0.00699 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.784 | L2-Norm(final)=20.858 | 2139.0 samples/s | 33.4 steps/s
[Step=81600 Epoch=159.5] | Loss=0.00686 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.787 | L2-Norm(final)=20.862 | 4850.3 samples/s | 75.8 steps/s
[Step=81650 Epoch=159.6] | Loss=0.00682 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.790 | L2-Norm(final)=20.866 | 4866.9 samples/s | 76.0 steps/s
[Step=81700 Epoch=159.7] | Loss=0.00675 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.793 | L2-Norm(final)=20.870 | 4694.6 samples/s | 73.4 steps/s
[Step=81750 Epoch=159.8] | Loss=0.00666 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.796 | L2-Norm(final)=20.873 | 4856.6 samples/s | 75.9 steps/s
[Step=81800 Epoch=159.9] | Loss=0.00661 | Reg=0.00077 | acc=0.9844 | L2-Norm=8.798 | L2-Norm(final)=20.877 | 4754.8 samples/s | 74.3 steps/s
[Step=81850 Epoch=160.0] | Loss=0.00657 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.801 | L2-Norm(final)=20.881 | 4800.0 samples/s | 75.0 steps/s
[Step=81900 Epoch=160.1] | Loss=0.00648 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.804 | L2-Norm(final)=20.884 | 4769.0 samples/s | 74.5 steps/s
[Step=81950 Epoch=160.2] | Loss=0.00644 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.806 | L2-Norm(final)=20.888 | 4742.0 samples/s | 74.1 steps/s
[Step=82000 Epoch=160.3] | Loss=0.00636 | Reg=0.00078 | acc=0.9844 | L2-Norm=8.809 | L2-Norm(final)=20.891 | 4820.9 samples/s | 75.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step82000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=80001 Epoch=306.5] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.688 | L2-Norm(final)=19.065 | 4216.0 samples/s | 65.9 steps/s
[Step=80050 Epoch=306.7] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.687 | L2-Norm(final)=19.065 | 5030.7 samples/s | 78.6 steps/s
[Step=80100 Epoch=306.9] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.687 | L2-Norm(final)=19.066 | 5238.0 samples/s | 81.8 steps/s
[Step=80150 Epoch=307.1] | Loss=0.00003 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.687 | L2-Norm(final)=19.066 | 5120.9 samples/s | 80.0 steps/s
[Step=80200 Epoch=307.3] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.687 | L2-Norm(final)=19.067 | 5257.7 samples/s | 82.2 steps/s
[Step=80250 Epoch=307.5] | Loss=0.00003 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.687 | L2-Norm(final)=19.068 | 6535.7 samples/s | 102.1 steps/s
[Step=80300 Epoch=307.7] | Loss=0.00003 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.687 | L2-Norm(final)=19.068 | 1998.2 samples/s | 31.2 steps/s
[Step=80350 Epoch=307.9] | Loss=0.00003 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.687 | L2-Norm(final)=19.069 | 5074.3 samples/s | 79.3 steps/s
[Step=80400 Epoch=308.1] | Loss=0.00003 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.687 | L2-Norm(final)=19.070 | 5157.8 samples/s | 80.6 steps/s
[Step=80450 Epoch=308.3] | Loss=0.00003 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.687 | L2-Norm(final)=19.071 | 5097.1 samples/s | 79.6 steps/s
[Step=80500 Epoch=308.4] | Loss=0.00003 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.687 | L2-Norm(final)=19.072 | 5793.7 samples/s | 90.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=80501 Epoch=308.5] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.687 | L2-Norm(final)=19.081 | 4207.1 samples/s | 65.7 steps/s
[Step=80550 Epoch=308.6] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.681 | L2-Norm(final)=19.082 | 4413.9 samples/s | 69.0 steps/s
[Step=80600 Epoch=308.8] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.676 | L2-Norm(final)=19.083 | 4517.4 samples/s | 70.6 steps/s
[Step=80650 Epoch=309.0] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.672 | L2-Norm(final)=19.084 | 4544.3 samples/s | 71.0 steps/s
[Step=80700 Epoch=309.2] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.667 | L2-Norm(final)=19.086 | 4490.4 samples/s | 70.2 steps/s
[Step=80750 Epoch=309.4] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.662 | L2-Norm(final)=19.086 | 5692.5 samples/s | 88.9 steps/s
[Step=80800 Epoch=309.6] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.657 | L2-Norm(final)=19.087 | 1966.1 samples/s | 30.7 steps/s
[Step=80850 Epoch=309.8] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.652 | L2-Norm(final)=19.088 | 4483.8 samples/s | 70.1 steps/s
[Step=80900 Epoch=310.0] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.648 | L2-Norm(final)=19.089 | 4530.5 samples/s | 70.8 steps/s
[Step=80950 Epoch=310.2] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.643 | L2-Norm(final)=19.089 | 4536.6 samples/s | 70.9 steps/s
[Step=81000 Epoch=310.4] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.638 | L2-Norm(final)=19.090 | 4924.5 samples/s | 76.9 steps/s
[Step=81050 Epoch=310.6] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.633 | L2-Norm(final)=19.091 | 2016.9 samples/s | 31.5 steps/s
[Step=81100 Epoch=310.7] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.628 | L2-Norm(final)=19.091 | 4463.9 samples/s | 69.7 steps/s
[Step=81150 Epoch=310.9] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.622 | L2-Norm(final)=19.092 | 4469.1 samples/s | 69.8 steps/s
[Step=81200 Epoch=311.1] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.617 | L2-Norm(final)=19.092 | 4513.8 samples/s | 70.5 steps/s
[Step=81250 Epoch=311.3] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.612 | L2-Norm(final)=19.093 | 4469.3 samples/s | 69.8 steps/s
[Step=81300 Epoch=311.5] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.607 | L2-Norm(final)=19.093 | 2096.4 samples/s | 32.8 steps/s
[Step=81350 Epoch=311.7] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.601 | L2-Norm(final)=19.094 | 4650.2 samples/s | 72.7 steps/s
[Step=81400 Epoch=311.9] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.596 | L2-Norm(final)=19.094 | 4396.6 samples/s | 68.7 steps/s
[Step=81450 Epoch=312.1] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.591 | L2-Norm(final)=19.095 | 4522.6 samples/s | 70.7 steps/s
[Step=81500 Epoch=312.3] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.585 | L2-Norm(final)=19.095 | 4463.6 samples/s | 69.7 steps/s
[Step=81550 Epoch=312.5] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.580 | L2-Norm(final)=19.096 | 2141.8 samples/s | 33.5 steps/s
[Step=81600 Epoch=312.7] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.574 | L2-Norm(final)=19.096 | 4484.6 samples/s | 70.1 steps/s
[Step=81650 Epoch=312.9] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.568 | L2-Norm(final)=19.097 | 4512.8 samples/s | 70.5 steps/s
[Step=81700 Epoch=313.0] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.563 | L2-Norm(final)=19.097 | 4512.7 samples/s | 70.5 steps/s
[Step=81750 Epoch=313.2] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.557 | L2-Norm(final)=19.097 | 4539.7 samples/s | 70.9 steps/s
[Step=81800 Epoch=313.4] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.551 | L2-Norm(final)=19.098 | 6144.8 samples/s | 96.0 steps/s
[Step=81850 Epoch=313.6] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.545 | L2-Norm(final)=19.098 | 1943.9 samples/s | 30.4 steps/s
[Step=81900 Epoch=313.8] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.539 | L2-Norm(final)=19.099 | 4593.6 samples/s | 71.8 steps/s
[Step=81950 Epoch=314.0] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.533 | L2-Norm(final)=19.099 | 4567.6 samples/s | 71.4 steps/s
[Step=82000 Epoch=314.2] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.527 | L2-Norm(final)=19.100 | 4560.5 samples/s | 71.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step82000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=80001 Epoch=308.0] | Loss=0.00010 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.688 | L2-Norm(final)=18.871 | 4651.6 samples/s | 72.7 steps/s
[Step=80050 Epoch=308.1] | Loss=0.00019 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.687 | L2-Norm(final)=18.873 | 4405.4 samples/s | 68.8 steps/s
[Step=80100 Epoch=308.3] | Loss=0.00017 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.686 | L2-Norm(final)=18.874 | 5199.0 samples/s | 81.2 steps/s
[Step=80150 Epoch=308.5] | Loss=0.00018 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.686 | L2-Norm(final)=18.875 | 5303.1 samples/s | 82.9 steps/s
[Step=80200 Epoch=308.7] | Loss=0.00017 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.686 | L2-Norm(final)=18.876 | 5024.9 samples/s | 78.5 steps/s
[Step=80250 Epoch=308.9] | Loss=0.00018 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.686 | L2-Norm(final)=18.876 | 6904.3 samples/s | 107.9 steps/s
[Step=80300 Epoch=309.1] | Loss=0.00019 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.686 | L2-Norm(final)=18.876 | 1985.0 samples/s | 31.0 steps/s
[Step=80350 Epoch=309.3] | Loss=0.00018 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.686 | L2-Norm(final)=18.876 | 5108.4 samples/s | 79.8 steps/s
[Step=80400 Epoch=309.5] | Loss=0.00018 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.686 | L2-Norm(final)=18.876 | 5107.1 samples/s | 79.8 steps/s
[Step=80450 Epoch=309.7] | Loss=0.00018 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.686 | L2-Norm(final)=18.876 | 5035.7 samples/s | 78.7 steps/s
[Step=80500 Epoch=309.9] | Loss=0.00018 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.686 | L2-Norm(final)=18.876 | 5892.5 samples/s | 92.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=80501 Epoch=309.9] | Loss=0.00004 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.686 | L2-Norm(final)=18.880 | 4226.4 samples/s | 66.0 steps/s
[Step=80550 Epoch=310.1] | Loss=0.00019 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.690 | L2-Norm(final)=18.881 | 4474.1 samples/s | 69.9 steps/s
[Step=80600 Epoch=310.3] | Loss=0.00018 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.693 | L2-Norm(final)=18.884 | 4691.1 samples/s | 73.3 steps/s
[Step=80650 Epoch=310.5] | Loss=0.00018 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.696 | L2-Norm(final)=18.885 | 4594.1 samples/s | 71.8 steps/s
[Step=80700 Epoch=310.6] | Loss=0.00014 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.698 | L2-Norm(final)=18.886 | 4539.8 samples/s | 70.9 steps/s
[Step=80750 Epoch=310.8] | Loss=0.00012 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.698 | L2-Norm(final)=18.887 | 5832.6 samples/s | 91.1 steps/s
[Step=80800 Epoch=311.0] | Loss=0.00010 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.698 | L2-Norm(final)=18.887 | 1943.5 samples/s | 30.4 steps/s
[Step=80850 Epoch=311.2] | Loss=0.00008 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.697 | L2-Norm(final)=18.887 | 4393.3 samples/s | 68.6 steps/s
[Step=80900 Epoch=311.4] | Loss=0.00007 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.696 | L2-Norm(final)=18.888 | 4346.1 samples/s | 67.9 steps/s
[Step=80950 Epoch=311.6] | Loss=0.00007 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.695 | L2-Norm(final)=18.888 | 3971.2 samples/s | 62.0 steps/s
[Step=81000 Epoch=311.8] | Loss=0.00006 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.694 | L2-Norm(final)=18.888 | 4777.6 samples/s | 74.6 steps/s
[Step=81050 Epoch=312.0] | Loss=0.00006 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.693 | L2-Norm(final)=18.889 | 1782.6 samples/s | 27.9 steps/s
[Step=81100 Epoch=312.2] | Loss=0.00005 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.692 | L2-Norm(final)=18.889 | 3874.0 samples/s | 60.5 steps/s
[Step=81150 Epoch=312.4] | Loss=0.00005 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.690 | L2-Norm(final)=18.889 | 3884.3 samples/s | 60.7 steps/s
[Step=81200 Epoch=312.6] | Loss=0.00004 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.689 | L2-Norm(final)=18.889 | 3961.9 samples/s | 61.9 steps/s
[Step=81250 Epoch=312.8] | Loss=0.00004 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.688 | L2-Norm(final)=18.889 | 4086.4 samples/s | 63.8 steps/s
[Step=81300 Epoch=313.0] | Loss=0.00004 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.686 | L2-Norm(final)=18.890 | 1904.4 samples/s | 29.8 steps/s
[Step=81350 Epoch=313.1] | Loss=0.00004 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.685 | L2-Norm(final)=18.890 | 4205.8 samples/s | 65.7 steps/s
[Step=81400 Epoch=313.3] | Loss=0.00004 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.683 | L2-Norm(final)=18.890 | 4633.6 samples/s | 72.4 steps/s
[Step=81450 Epoch=313.5] | Loss=0.00003 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.682 | L2-Norm(final)=18.890 | 4569.9 samples/s | 71.4 steps/s
[Step=81500 Epoch=313.7] | Loss=0.00003 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.680 | L2-Norm(final)=18.890 | 4684.8 samples/s | 73.2 steps/s
[Step=81550 Epoch=313.9] | Loss=0.00003 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.678 | L2-Norm(final)=18.891 | 2127.7 samples/s | 33.2 steps/s
[Step=81600 Epoch=314.1] | Loss=0.00003 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.677 | L2-Norm(final)=18.891 | 4499.1 samples/s | 70.3 steps/s
[Step=81650 Epoch=314.3] | Loss=0.00003 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.675 | L2-Norm(final)=18.891 | 4485.1 samples/s | 70.1 steps/s
[Step=81700 Epoch=314.5] | Loss=0.00003 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.674 | L2-Norm(final)=18.891 | 4500.1 samples/s | 70.3 steps/s
[Step=81750 Epoch=314.7] | Loss=0.00003 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.672 | L2-Norm(final)=18.891 | 4580.0 samples/s | 71.6 steps/s
[Step=81800 Epoch=314.9] | Loss=0.00003 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.670 | L2-Norm(final)=18.891 | 6556.9 samples/s | 102.5 steps/s
[Step=81850 Epoch=315.1] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.668 | L2-Norm(final)=18.892 | 1858.8 samples/s | 29.0 steps/s
[Step=81900 Epoch=315.3] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.667 | L2-Norm(final)=18.892 | 4570.4 samples/s | 71.4 steps/s
[Step=81950 Epoch=315.5] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.665 | L2-Norm(final)=18.892 | 4553.3 samples/s | 71.1 steps/s
[Step=82000 Epoch=315.7] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.663 | L2-Norm(final)=18.892 | 4482.5 samples/s | 70.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step82000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05892 | acc=0.9710 | tpr=0.9779 | fpr=0.0439 | 4376.5 samples/s | 17.1 steps/s
Avg test loss: 0.05926, Avg test acc: 0.97091, Avg tpr: 0.97797, Avg fpr: 0.04461, total FA: 348

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06449 | acc=0.9698 | tpr=0.9735 | fpr=0.0382 | 4499.9 samples/s | 17.6 steps/s
Avg test loss: 0.06420, Avg test acc: 0.97071, Avg tpr: 0.97470, Avg fpr: 0.03807, total FA: 297

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.99815 | acc=0.3170 | tpr=0.0086 | fpr=0.0131 | 4451.9 samples/s | 17.4 steps/s
Avg test loss: 5.01522, Avg test acc: 0.31445, Avg tpr: 0.00886, Avg fpr: 0.01346, total FA: 105

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.33729 | acc=0.3130 | tpr=0.0076 | fpr=0.0240 | 4453.4 samples/s | 17.4 steps/s
Avg test loss: 5.35362, Avg test acc: 0.31068, Avg tpr: 0.00804, Avg fpr: 0.02371, total FA: 185

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.07030 | acc=0.1303 | tpr=0.7345 | fpr=0.8805 | 4382.2 samples/s | 17.1 steps/s
[Step= 100] | Loss=5.05523 | acc=0.1295 | tpr=0.7377 | fpr=0.8819 | 8951.9 samples/s | 35.0 steps/s
[Step= 150] | Loss=5.06172 | acc=0.1286 | tpr=0.7291 | fpr=0.8825 | 7928.4 samples/s | 31.0 steps/s
[Step= 200] | Loss=5.06332 | acc=0.1282 | tpr=0.7115 | fpr=0.8824 | 8606.0 samples/s | 33.6 steps/s
[Step= 250] | Loss=5.07266 | acc=0.1283 | tpr=0.7144 | fpr=0.8824 | 8390.4 samples/s | 32.8 steps/s
[Step= 300] | Loss=5.07049 | acc=0.1281 | tpr=0.7142 | fpr=0.8826 | 8575.4 samples/s | 33.5 steps/s
[Step= 350] | Loss=5.07018 | acc=0.1274 | tpr=0.7157 | fpr=0.8833 | 8139.6 samples/s | 31.8 steps/s
[Step= 400] | Loss=5.07546 | acc=0.1274 | tpr=0.7123 | fpr=0.8832 | 8344.6 samples/s | 32.6 steps/s
[Step= 450] | Loss=5.07855 | acc=0.1275 | tpr=0.7147 | fpr=0.8832 | 8470.4 samples/s | 33.1 steps/s
[Step= 500] | Loss=5.07817 | acc=0.1274 | tpr=0.7207 | fpr=0.8833 | 8449.6 samples/s | 33.0 steps/s
[Step= 550] | Loss=5.08229 | acc=0.1274 | tpr=0.7179 | fpr=0.8834 | 15204.5 samples/s | 59.4 steps/s
Avg test loss: 5.08219, Avg test acc: 0.12724, Avg tpr: 0.71791, Avg fpr: 0.88350, total FA: 122672

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.02996 | acc=0.1452 | tpr=0.6770 | fpr=0.8644 | 4440.5 samples/s | 17.3 steps/s
[Step= 100] | Loss=5.01318 | acc=0.1441 | tpr=0.6844 | fpr=0.8660 | 8493.0 samples/s | 33.2 steps/s
[Step= 150] | Loss=5.01765 | acc=0.1434 | tpr=0.6787 | fpr=0.8665 | 8468.5 samples/s | 33.1 steps/s
[Step= 200] | Loss=5.01748 | acc=0.1437 | tpr=0.6656 | fpr=0.8658 | 8783.1 samples/s | 34.3 steps/s
[Step= 250] | Loss=5.02752 | acc=0.1439 | tpr=0.6672 | fpr=0.8656 | 8118.1 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.02645 | acc=0.1439 | tpr=0.6611 | fpr=0.8655 | 8619.5 samples/s | 33.7 steps/s
[Step= 350] | Loss=5.02375 | acc=0.1432 | tpr=0.6550 | fpr=0.8661 | 8730.6 samples/s | 34.1 steps/s
[Step= 400] | Loss=5.02949 | acc=0.1434 | tpr=0.6543 | fpr=0.8659 | 7941.1 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.03224 | acc=0.1433 | tpr=0.6568 | fpr=0.8660 | 8448.0 samples/s | 33.0 steps/s
[Step= 500] | Loss=5.03131 | acc=0.1431 | tpr=0.6604 | fpr=0.8662 | 8940.6 samples/s | 34.9 steps/s
[Step= 550] | Loss=5.03575 | acc=0.1430 | tpr=0.6546 | fpr=0.8663 | 13519.4 samples/s | 52.8 steps/s
Avg test loss: 5.03572, Avg test acc: 0.14290, Avg tpr: 0.65491, Avg fpr: 0.86641, total FA: 120299

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10684 | acc=0.9818 | tpr=0.9381 | fpr=0.0174 | 4386.0 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.11288 | acc=0.9817 | tpr=0.9574 | fpr=0.0178 | 8528.9 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.11628 | acc=0.9813 | tpr=0.9582 | fpr=0.0182 | 8437.5 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.11717 | acc=0.9815 | tpr=0.9617 | fpr=0.0182 | 8587.5 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.11603 | acc=0.9815 | tpr=0.9607 | fpr=0.0181 | 8141.6 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.11714 | acc=0.9815 | tpr=0.9622 | fpr=0.0181 | 8758.9 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.11842 | acc=0.9812 | tpr=0.9624 | fpr=0.0184 | 8903.4 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.11982 | acc=0.9811 | tpr=0.9612 | fpr=0.0185 | 7846.4 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.12220 | acc=0.9809 | tpr=0.9596 | fpr=0.0187 | 8630.9 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.12189 | acc=0.9809 | tpr=0.9599 | fpr=0.0187 | 8493.1 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.12089 | acc=0.9809 | tpr=0.9570 | fpr=0.0186 | 14452.1 samples/s | 56.5 steps/s
Avg test loss: 0.12056, Avg test acc: 0.98097, Avg tpr: 0.95721, Avg fpr: 0.01860, total FA: 2583

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10986 | acc=0.9822 | tpr=0.9425 | fpr=0.0171 | 4390.3 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.11599 | acc=0.9823 | tpr=0.9595 | fpr=0.0172 | 8646.9 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.12029 | acc=0.9818 | tpr=0.9654 | fpr=0.0179 | 8286.5 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.12085 | acc=0.9820 | tpr=0.9683 | fpr=0.0178 | 8241.1 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.11977 | acc=0.9821 | tpr=0.9659 | fpr=0.0176 | 8555.0 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.12081 | acc=0.9820 | tpr=0.9673 | fpr=0.0177 | 8248.1 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.12204 | acc=0.9819 | tpr=0.9674 | fpr=0.0178 | 8600.2 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.12377 | acc=0.9817 | tpr=0.9661 | fpr=0.0180 | 8401.9 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.12638 | acc=0.9814 | tpr=0.9645 | fpr=0.0183 | 8538.8 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.12601 | acc=0.9814 | tpr=0.9639 | fpr=0.0183 | 8231.2 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.12500 | acc=0.9814 | tpr=0.9610 | fpr=0.0182 | 14944.1 samples/s | 58.4 steps/s
Avg test loss: 0.12469, Avg test acc: 0.98145, Avg tpr: 0.96117, Avg fpr: 0.01819, total FA: 2525

server round 41/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=82001 Epoch=159.9] | Loss=0.00123 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.649 | L2-Norm(final)=20.144 | 4009.5 samples/s | 62.6 steps/s
[Step=82050 Epoch=160.0] | Loss=0.01016 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.650 | L2-Norm(final)=20.150 | 5367.5 samples/s | 83.9 steps/s
[Step=82100 Epoch=160.1] | Loss=0.00967 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.650 | L2-Norm(final)=20.158 | 5350.9 samples/s | 83.6 steps/s
[Step=82150 Epoch=160.2] | Loss=0.00991 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.650 | L2-Norm(final)=20.165 | 5498.2 samples/s | 85.9 steps/s
[Step=82200 Epoch=160.3] | Loss=0.00979 | Reg=0.00075 | acc=0.9844 | L2-Norm=8.650 | L2-Norm(final)=20.172 | 5464.9 samples/s | 85.4 steps/s
[Step=82250 Epoch=160.4] | Loss=0.00975 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.650 | L2-Norm(final)=20.179 | 5430.7 samples/s | 84.9 steps/s
[Step=82300 Epoch=160.5] | Loss=0.01006 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.650 | L2-Norm(final)=20.185 | 5373.5 samples/s | 84.0 steps/s
[Step=82350 Epoch=160.6] | Loss=0.00985 | Reg=0.00075 | acc=0.9844 | L2-Norm=8.650 | L2-Norm(final)=20.192 | 5356.5 samples/s | 83.7 steps/s
[Step=82400 Epoch=160.7] | Loss=0.00997 | Reg=0.00075 | acc=0.9844 | L2-Norm=8.650 | L2-Norm(final)=20.198 | 5502.2 samples/s | 86.0 steps/s
[Step=82450 Epoch=160.8] | Loss=0.00978 | Reg=0.00075 | acc=0.9844 | L2-Norm=8.650 | L2-Norm(final)=20.205 | 5543.0 samples/s | 86.6 steps/s
[Step=82500 Epoch=160.9] | Loss=0.00972 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.650 | L2-Norm(final)=20.211 | 6908.9 samples/s | 108.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=82501 Epoch=160.9] | Loss=0.02320 | Reg=0.00075 | acc=0.9688 | L2-Norm=8.650 | L2-Norm(final)=20.275 | 4134.5 samples/s | 64.6 steps/s
[Step=82550 Epoch=161.0] | Loss=0.01079 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.655 | L2-Norm(final)=20.280 | 4665.6 samples/s | 72.9 steps/s
[Step=82600 Epoch=161.1] | Loss=0.00958 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.663 | L2-Norm(final)=20.286 | 4824.3 samples/s | 75.4 steps/s
[Step=82650 Epoch=161.2] | Loss=0.00896 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.670 | L2-Norm(final)=20.291 | 4796.0 samples/s | 74.9 steps/s
[Step=82700 Epoch=161.3] | Loss=0.00865 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.675 | L2-Norm(final)=20.296 | 4764.6 samples/s | 74.4 steps/s
[Step=82750 Epoch=161.4] | Loss=0.00880 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.681 | L2-Norm(final)=20.301 | 4707.7 samples/s | 73.6 steps/s
[Step=82800 Epoch=161.5] | Loss=0.00861 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.686 | L2-Norm(final)=20.305 | 4758.4 samples/s | 74.4 steps/s
[Step=82850 Epoch=161.6] | Loss=0.00876 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.690 | L2-Norm(final)=20.309 | 4838.0 samples/s | 75.6 steps/s
[Step=82900 Epoch=161.7] | Loss=0.00867 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.694 | L2-Norm(final)=20.313 | 4731.4 samples/s | 73.9 steps/s
[Step=82950 Epoch=161.8] | Loss=0.00847 | Reg=0.00076 | acc=0.9531 | L2-Norm=8.698 | L2-Norm(final)=20.318 | 4761.5 samples/s | 74.4 steps/s
[Step=83000 Epoch=161.9] | Loss=0.00842 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.702 | L2-Norm(final)=20.322 | 5750.7 samples/s | 89.9 steps/s
[Step=83050 Epoch=162.0] | Loss=0.00829 | Reg=0.00076 | acc=0.9844 | L2-Norm=8.706 | L2-Norm(final)=20.325 | 1969.0 samples/s | 30.8 steps/s
[Step=83100 Epoch=162.1] | Loss=0.00808 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.710 | L2-Norm(final)=20.329 | 4777.3 samples/s | 74.6 steps/s
[Step=83150 Epoch=162.2] | Loss=0.00791 | Reg=0.00076 | acc=0.9844 | L2-Norm=8.714 | L2-Norm(final)=20.333 | 4872.6 samples/s | 76.1 steps/s
[Step=83200 Epoch=162.3] | Loss=0.00777 | Reg=0.00076 | acc=0.9844 | L2-Norm=8.717 | L2-Norm(final)=20.337 | 4945.0 samples/s | 77.3 steps/s
[Step=83250 Epoch=162.4] | Loss=0.00764 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.720 | L2-Norm(final)=20.341 | 4742.4 samples/s | 74.1 steps/s
[Step=83300 Epoch=162.5] | Loss=0.00758 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.723 | L2-Norm(final)=20.344 | 4825.9 samples/s | 75.4 steps/s
[Step=83350 Epoch=162.6] | Loss=0.00757 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.726 | L2-Norm(final)=20.348 | 4820.2 samples/s | 75.3 steps/s
[Step=83400 Epoch=162.7] | Loss=0.00750 | Reg=0.00076 | acc=0.9844 | L2-Norm=8.729 | L2-Norm(final)=20.351 | 4807.0 samples/s | 75.1 steps/s
[Step=83450 Epoch=162.8] | Loss=0.00742 | Reg=0.00076 | acc=0.9844 | L2-Norm=8.732 | L2-Norm(final)=20.354 | 4751.3 samples/s | 74.2 steps/s
[Step=83500 Epoch=162.9] | Loss=0.00741 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.735 | L2-Norm(final)=20.358 | 5103.7 samples/s | 79.7 steps/s
[Step=83550 Epoch=163.0] | Loss=0.00733 | Reg=0.00076 | acc=0.9844 | L2-Norm=8.737 | L2-Norm(final)=20.361 | 2071.4 samples/s | 32.4 steps/s
[Step=83600 Epoch=163.1] | Loss=0.00719 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.740 | L2-Norm(final)=20.364 | 4905.3 samples/s | 76.6 steps/s
[Step=83650 Epoch=163.1] | Loss=0.00707 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.743 | L2-Norm(final)=20.367 | 4872.0 samples/s | 76.1 steps/s
[Step=83700 Epoch=163.2] | Loss=0.00691 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.745 | L2-Norm(final)=20.371 | 4935.8 samples/s | 77.1 steps/s
[Step=83750 Epoch=163.3] | Loss=0.00694 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.748 | L2-Norm(final)=20.374 | 4870.3 samples/s | 76.1 steps/s
[Step=83800 Epoch=163.4] | Loss=0.00688 | Reg=0.00077 | acc=0.9844 | L2-Norm=8.751 | L2-Norm(final)=20.377 | 4824.5 samples/s | 75.4 steps/s
[Step=83850 Epoch=163.5] | Loss=0.00685 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.753 | L2-Norm(final)=20.380 | 4788.5 samples/s | 74.8 steps/s
[Step=83900 Epoch=163.6] | Loss=0.00680 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.755 | L2-Norm(final)=20.383 | 4814.4 samples/s | 75.2 steps/s
[Step=83950 Epoch=163.7] | Loss=0.00679 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.758 | L2-Norm(final)=20.386 | 4767.8 samples/s | 74.5 steps/s
[Step=84000 Epoch=163.8] | Loss=0.00680 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.760 | L2-Norm(final)=20.389 | 4796.8 samples/s | 75.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step84000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=82001 Epoch=160.3] | Loss=0.01065 | Reg=0.00075 | acc=0.9844 | L2-Norm=8.649 | L2-Norm(final)=20.995 | 4660.1 samples/s | 72.8 steps/s
[Step=82050 Epoch=160.4] | Loss=0.00938 | Reg=0.00075 | acc=0.9844 | L2-Norm=8.649 | L2-Norm(final)=21.000 | 4956.1 samples/s | 77.4 steps/s
[Step=82100 Epoch=160.5] | Loss=0.01036 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.649 | L2-Norm(final)=21.003 | 5420.7 samples/s | 84.7 steps/s
[Step=82150 Epoch=160.6] | Loss=0.01021 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.649 | L2-Norm(final)=21.006 | 5502.9 samples/s | 86.0 steps/s
[Step=82200 Epoch=160.7] | Loss=0.01001 | Reg=0.00075 | acc=0.9844 | L2-Norm=8.649 | L2-Norm(final)=21.009 | 5414.7 samples/s | 84.6 steps/s
[Step=82250 Epoch=160.8] | Loss=0.00989 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.649 | L2-Norm(final)=21.013 | 5484.7 samples/s | 85.7 steps/s
[Step=82300 Epoch=160.9] | Loss=0.00970 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.649 | L2-Norm(final)=21.016 | 5549.6 samples/s | 86.7 steps/s
[Step=82350 Epoch=161.0] | Loss=0.00974 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.649 | L2-Norm(final)=21.019 | 5406.3 samples/s | 84.5 steps/s
[Step=82400 Epoch=161.1] | Loss=0.00976 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.649 | L2-Norm(final)=21.023 | 5495.3 samples/s | 85.9 steps/s
[Step=82450 Epoch=161.2] | Loss=0.00970 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.649 | L2-Norm(final)=21.026 | 5423.6 samples/s | 84.7 steps/s
[Step=82500 Epoch=161.3] | Loss=0.00981 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.649 | L2-Norm(final)=21.029 | 7031.6 samples/s | 109.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=82501 Epoch=161.3] | Loss=0.00952 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.649 | L2-Norm(final)=21.062 | 4316.8 samples/s | 67.5 steps/s
[Step=82550 Epoch=161.4] | Loss=0.00842 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.657 | L2-Norm(final)=21.067 | 4676.3 samples/s | 73.1 steps/s
[Step=82600 Epoch=161.5] | Loss=0.00907 | Reg=0.00075 | acc=0.9844 | L2-Norm=8.663 | L2-Norm(final)=21.072 | 4727.6 samples/s | 73.9 steps/s
[Step=82650 Epoch=161.6] | Loss=0.00877 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.669 | L2-Norm(final)=21.077 | 4736.0 samples/s | 74.0 steps/s
[Step=82700 Epoch=161.7] | Loss=0.00827 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.675 | L2-Norm(final)=21.082 | 4768.5 samples/s | 74.5 steps/s
[Step=82750 Epoch=161.8] | Loss=0.00805 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.680 | L2-Norm(final)=21.087 | 4756.4 samples/s | 74.3 steps/s
[Step=82800 Epoch=161.9] | Loss=0.00808 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.686 | L2-Norm(final)=21.091 | 4774.1 samples/s | 74.6 steps/s
[Step=82850 Epoch=162.0] | Loss=0.00797 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.690 | L2-Norm(final)=21.096 | 4766.5 samples/s | 74.5 steps/s
[Step=82900 Epoch=162.1] | Loss=0.00782 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.695 | L2-Norm(final)=21.100 | 4733.0 samples/s | 74.0 steps/s
[Step=82950 Epoch=162.2] | Loss=0.00798 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.699 | L2-Norm(final)=21.104 | 4813.1 samples/s | 75.2 steps/s
[Step=83000 Epoch=162.3] | Loss=0.00800 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.704 | L2-Norm(final)=21.108 | 5828.6 samples/s | 91.1 steps/s
[Step=83050 Epoch=162.4] | Loss=0.00785 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.708 | L2-Norm(final)=21.112 | 2021.1 samples/s | 31.6 steps/s
[Step=83100 Epoch=162.5] | Loss=0.00760 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.712 | L2-Norm(final)=21.116 | 4743.3 samples/s | 74.1 steps/s
[Step=83150 Epoch=162.6] | Loss=0.00756 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.716 | L2-Norm(final)=21.120 | 4741.3 samples/s | 74.1 steps/s
[Step=83200 Epoch=162.7] | Loss=0.00745 | Reg=0.00076 | acc=0.9844 | L2-Norm=8.719 | L2-Norm(final)=21.124 | 4797.8 samples/s | 75.0 steps/s
[Step=83250 Epoch=162.8] | Loss=0.00732 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.723 | L2-Norm(final)=21.128 | 4845.8 samples/s | 75.7 steps/s
[Step=83300 Epoch=162.8] | Loss=0.00724 | Reg=0.00076 | acc=0.9531 | L2-Norm=8.726 | L2-Norm(final)=21.132 | 4670.8 samples/s | 73.0 steps/s
[Step=83350 Epoch=162.9] | Loss=0.00709 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.730 | L2-Norm(final)=21.135 | 4864.5 samples/s | 76.0 steps/s
[Step=83400 Epoch=163.0] | Loss=0.00697 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.733 | L2-Norm(final)=21.139 | 4802.8 samples/s | 75.0 steps/s
[Step=83450 Epoch=163.1] | Loss=0.00693 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.736 | L2-Norm(final)=21.142 | 4829.1 samples/s | 75.5 steps/s
[Step=83500 Epoch=163.2] | Loss=0.00687 | Reg=0.00076 | acc=0.9844 | L2-Norm=8.739 | L2-Norm(final)=21.146 | 5107.4 samples/s | 79.8 steps/s
[Step=83550 Epoch=163.3] | Loss=0.00681 | Reg=0.00076 | acc=0.9844 | L2-Norm=8.742 | L2-Norm(final)=21.149 | 2139.5 samples/s | 33.4 steps/s
[Step=83600 Epoch=163.4] | Loss=0.00670 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.745 | L2-Norm(final)=21.153 | 4763.7 samples/s | 74.4 steps/s
[Step=83650 Epoch=163.5] | Loss=0.00661 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.747 | L2-Norm(final)=21.156 | 4883.5 samples/s | 76.3 steps/s
[Step=83700 Epoch=163.6] | Loss=0.00658 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.750 | L2-Norm(final)=21.160 | 4806.1 samples/s | 75.1 steps/s
[Step=83750 Epoch=163.7] | Loss=0.00653 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.753 | L2-Norm(final)=21.163 | 4812.1 samples/s | 75.2 steps/s
[Step=83800 Epoch=163.8] | Loss=0.00642 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.755 | L2-Norm(final)=21.166 | 4769.9 samples/s | 74.5 steps/s
[Step=83850 Epoch=163.9] | Loss=0.00631 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.758 | L2-Norm(final)=21.170 | 4791.2 samples/s | 74.9 steps/s
[Step=83900 Epoch=164.0] | Loss=0.00627 | Reg=0.00077 | acc=0.9844 | L2-Norm=8.760 | L2-Norm(final)=21.173 | 4709.5 samples/s | 73.6 steps/s
[Step=83950 Epoch=164.1] | Loss=0.00626 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.763 | L2-Norm(final)=21.176 | 4750.8 samples/s | 74.2 steps/s
[Step=84000 Epoch=164.2] | Loss=0.00623 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.765 | L2-Norm(final)=21.180 | 4794.1 samples/s | 74.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step84000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=82001 Epoch=314.2] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.649 | L2-Norm(final)=19.113 | 4339.4 samples/s | 67.8 steps/s
[Step=82050 Epoch=314.4] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.647 | L2-Norm(final)=19.116 | 4580.5 samples/s | 71.6 steps/s
[Step=82100 Epoch=314.6] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.646 | L2-Norm(final)=19.117 | 5213.0 samples/s | 81.5 steps/s
[Step=82150 Epoch=314.8] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.646 | L2-Norm(final)=19.119 | 5086.0 samples/s | 79.5 steps/s
[Step=82200 Epoch=315.0] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.646 | L2-Norm(final)=19.121 | 5078.8 samples/s | 79.4 steps/s
[Step=82250 Epoch=315.2] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.646 | L2-Norm(final)=19.124 | 6803.6 samples/s | 106.3 steps/s
[Step=82300 Epoch=315.3] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.646 | L2-Norm(final)=19.126 | 2031.5 samples/s | 31.7 steps/s
[Step=82350 Epoch=315.5] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.646 | L2-Norm(final)=19.129 | 4987.9 samples/s | 77.9 steps/s
[Step=82400 Epoch=315.7] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.646 | L2-Norm(final)=19.131 | 5188.4 samples/s | 81.1 steps/s
[Step=82450 Epoch=315.9] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.646 | L2-Norm(final)=19.134 | 5141.4 samples/s | 80.3 steps/s
[Step=82500 Epoch=316.1] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.646 | L2-Norm(final)=19.137 | 5707.6 samples/s | 89.2 steps/s
All layers training...
LR=0.00006, len=1
[Step=82501 Epoch=316.1] | Loss=0.00004 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.646 | L2-Norm(final)=19.162 | 4723.9 samples/s | 73.8 steps/s
[Step=82550 Epoch=316.3] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.636 | L2-Norm(final)=19.164 | 3912.2 samples/s | 61.1 steps/s
[Step=82600 Epoch=316.5] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.624 | L2-Norm(final)=19.166 | 4487.7 samples/s | 70.1 steps/s
[Step=82650 Epoch=316.7] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.613 | L2-Norm(final)=19.167 | 4487.7 samples/s | 70.1 steps/s
[Step=82700 Epoch=316.9] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.601 | L2-Norm(final)=19.168 | 4501.7 samples/s | 70.3 steps/s
[Step=82750 Epoch=317.1] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.589 | L2-Norm(final)=19.169 | 5683.7 samples/s | 88.8 steps/s
[Step=82800 Epoch=317.3] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.578 | L2-Norm(final)=19.170 | 1956.7 samples/s | 30.6 steps/s
[Step=82850 Epoch=317.5] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.566 | L2-Norm(final)=19.171 | 4573.6 samples/s | 71.5 steps/s
[Step=82900 Epoch=317.6] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.554 | L2-Norm(final)=19.172 | 4701.7 samples/s | 73.5 steps/s
[Step=82950 Epoch=317.8] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.543 | L2-Norm(final)=19.172 | 4489.2 samples/s | 70.1 steps/s
[Step=83000 Epoch=318.0] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.531 | L2-Norm(final)=19.173 | 5011.3 samples/s | 78.3 steps/s
[Step=83050 Epoch=318.2] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.519 | L2-Norm(final)=19.174 | 2048.6 samples/s | 32.0 steps/s
[Step=83100 Epoch=318.4] | Loss=0.00000 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.507 | L2-Norm(final)=19.174 | 4475.8 samples/s | 69.9 steps/s
[Step=83150 Epoch=318.6] | Loss=0.00000 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.495 | L2-Norm(final)=19.175 | 4519.9 samples/s | 70.6 steps/s
[Step=83200 Epoch=318.8] | Loss=0.00000 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.483 | L2-Norm(final)=19.176 | 4518.5 samples/s | 70.6 steps/s
[Step=83250 Epoch=319.0] | Loss=0.00000 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.471 | L2-Norm(final)=19.176 | 4514.5 samples/s | 70.5 steps/s
[Step=83300 Epoch=319.2] | Loss=0.00000 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.459 | L2-Norm(final)=19.177 | 2089.5 samples/s | 32.6 steps/s
[Step=83350 Epoch=319.4] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.447 | L2-Norm(final)=19.178 | 4595.0 samples/s | 71.8 steps/s
[Step=83400 Epoch=319.6] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.434 | L2-Norm(final)=19.178 | 4520.7 samples/s | 70.6 steps/s
[Step=83450 Epoch=319.8] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.422 | L2-Norm(final)=19.179 | 4559.2 samples/s | 71.2 steps/s
[Step=83500 Epoch=319.9] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.410 | L2-Norm(final)=19.180 | 4640.4 samples/s | 72.5 steps/s
[Step=83550 Epoch=320.1] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.397 | L2-Norm(final)=19.180 | 2150.8 samples/s | 33.6 steps/s
[Step=83600 Epoch=320.3] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.384 | L2-Norm(final)=19.181 | 4559.8 samples/s | 71.2 steps/s
[Step=83650 Epoch=320.5] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.371 | L2-Norm(final)=19.182 | 4518.0 samples/s | 70.6 steps/s
[Step=83700 Epoch=320.7] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.359 | L2-Norm(final)=19.182 | 4476.5 samples/s | 69.9 steps/s
[Step=83750 Epoch=320.9] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.346 | L2-Norm(final)=19.183 | 4536.8 samples/s | 70.9 steps/s
[Step=83800 Epoch=321.1] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.333 | L2-Norm(final)=19.184 | 6200.4 samples/s | 96.9 steps/s
[Step=83850 Epoch=321.3] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.319 | L2-Norm(final)=19.185 | 1906.2 samples/s | 29.8 steps/s
[Step=83900 Epoch=321.5] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.306 | L2-Norm(final)=19.185 | 4548.5 samples/s | 71.1 steps/s
[Step=83950 Epoch=321.7] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.293 | L2-Norm(final)=19.186 | 4495.8 samples/s | 70.2 steps/s
[Step=84000 Epoch=321.9] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.279 | L2-Norm(final)=19.187 | 4559.1 samples/s | 71.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step84000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=82001 Epoch=315.7] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.649 | L2-Norm(final)=18.897 | 4117.4 samples/s | 64.3 steps/s
[Step=82050 Epoch=315.8] | Loss=0.00004 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.648 | L2-Norm(final)=18.898 | 4908.7 samples/s | 76.7 steps/s
[Step=82100 Epoch=316.0] | Loss=0.00005 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.648 | L2-Norm(final)=18.899 | 5147.6 samples/s | 80.4 steps/s
[Step=82150 Epoch=316.2] | Loss=0.00005 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.648 | L2-Norm(final)=18.900 | 5103.9 samples/s | 79.7 steps/s
[Step=82200 Epoch=316.4] | Loss=0.00005 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.648 | L2-Norm(final)=18.901 | 5301.3 samples/s | 82.8 steps/s
[Step=82250 Epoch=316.6] | Loss=0.00005 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.648 | L2-Norm(final)=18.903 | 6692.3 samples/s | 104.6 steps/s
[Step=82300 Epoch=316.8] | Loss=0.00005 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.648 | L2-Norm(final)=18.904 | 2060.1 samples/s | 32.2 steps/s
[Step=82350 Epoch=317.0] | Loss=0.00005 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.648 | L2-Norm(final)=18.905 | 5242.9 samples/s | 81.9 steps/s
[Step=82400 Epoch=317.2] | Loss=0.00005 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.648 | L2-Norm(final)=18.907 | 5202.4 samples/s | 81.3 steps/s
[Step=82450 Epoch=317.4] | Loss=0.00005 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.648 | L2-Norm(final)=18.908 | 5205.6 samples/s | 81.3 steps/s
[Step=82500 Epoch=317.6] | Loss=0.00005 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.648 | L2-Norm(final)=18.909 | 5941.8 samples/s | 92.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=82501 Epoch=317.6] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.648 | L2-Norm(final)=18.923 | 4511.7 samples/s | 70.5 steps/s
[Step=82550 Epoch=317.8] | Loss=0.00003 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.646 | L2-Norm(final)=18.924 | 4104.8 samples/s | 64.1 steps/s
[Step=82600 Epoch=318.0] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.643 | L2-Norm(final)=18.926 | 4464.1 samples/s | 69.8 steps/s
[Step=82650 Epoch=318.2] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.640 | L2-Norm(final)=18.927 | 4497.6 samples/s | 70.3 steps/s
[Step=82700 Epoch=318.3] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.638 | L2-Norm(final)=18.928 | 4480.3 samples/s | 70.0 steps/s
[Step=82750 Epoch=318.5] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.635 | L2-Norm(final)=18.929 | 5718.5 samples/s | 89.4 steps/s
[Step=82800 Epoch=318.7] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.632 | L2-Norm(final)=18.930 | 1914.1 samples/s | 29.9 steps/s
[Step=82850 Epoch=318.9] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.629 | L2-Norm(final)=18.930 | 4650.7 samples/s | 72.7 steps/s
[Step=82900 Epoch=319.1] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.626 | L2-Norm(final)=18.931 | 4439.6 samples/s | 69.4 steps/s
[Step=82950 Epoch=319.3] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.622 | L2-Norm(final)=18.932 | 4459.4 samples/s | 69.7 steps/s
[Step=83000 Epoch=319.5] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.619 | L2-Norm(final)=18.932 | 5159.3 samples/s | 80.6 steps/s
[Step=83050 Epoch=319.7] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.616 | L2-Norm(final)=18.933 | 1989.2 samples/s | 31.1 steps/s
[Step=83100 Epoch=319.9] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.613 | L2-Norm(final)=18.934 | 4477.9 samples/s | 70.0 steps/s
[Step=83150 Epoch=320.1] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.609 | L2-Norm(final)=18.934 | 4537.5 samples/s | 70.9 steps/s
[Step=83200 Epoch=320.3] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.606 | L2-Norm(final)=18.935 | 4399.1 samples/s | 68.7 steps/s
[Step=83250 Epoch=320.5] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.602 | L2-Norm(final)=18.935 | 4561.5 samples/s | 71.3 steps/s
[Step=83300 Epoch=320.7] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.599 | L2-Norm(final)=18.936 | 2103.4 samples/s | 32.9 steps/s
[Step=83350 Epoch=320.8] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.595 | L2-Norm(final)=18.936 | 4651.8 samples/s | 72.7 steps/s
[Step=83400 Epoch=321.0] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.591 | L2-Norm(final)=18.937 | 4467.4 samples/s | 69.8 steps/s
[Step=83450 Epoch=321.2] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.588 | L2-Norm(final)=18.937 | 4507.3 samples/s | 70.4 steps/s
[Step=83500 Epoch=321.4] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.584 | L2-Norm(final)=18.938 | 4450.7 samples/s | 69.5 steps/s
[Step=83550 Epoch=321.6] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.580 | L2-Norm(final)=18.938 | 2083.9 samples/s | 32.6 steps/s
[Step=83600 Epoch=321.8] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.576 | L2-Norm(final)=18.939 | 4561.2 samples/s | 71.3 steps/s
[Step=83650 Epoch=322.0] | Loss=0.00001 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.572 | L2-Norm(final)=18.939 | 4510.7 samples/s | 70.5 steps/s
[Step=83700 Epoch=322.2] | Loss=0.00001 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.568 | L2-Norm(final)=18.940 | 4576.7 samples/s | 71.5 steps/s
[Step=83750 Epoch=322.4] | Loss=0.00001 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.564 | L2-Norm(final)=18.940 | 4452.6 samples/s | 69.6 steps/s
[Step=83800 Epoch=322.6] | Loss=0.00001 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.560 | L2-Norm(final)=18.941 | 6615.0 samples/s | 103.4 steps/s
[Step=83850 Epoch=322.8] | Loss=0.00001 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.556 | L2-Norm(final)=18.941 | 1836.6 samples/s | 28.7 steps/s
[Step=83900 Epoch=323.0] | Loss=0.00001 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.552 | L2-Norm(final)=18.941 | 4532.2 samples/s | 70.8 steps/s
[Step=83950 Epoch=323.2] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.548 | L2-Norm(final)=18.942 | 4496.8 samples/s | 70.3 steps/s
[Step=84000 Epoch=323.3] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.544 | L2-Norm(final)=18.942 | 4367.9 samples/s | 68.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step84000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06205 | acc=0.9701 | tpr=0.9736 | fpr=0.0377 | 4380.0 samples/s | 17.1 steps/s
Avg test loss: 0.06232, Avg test acc: 0.97003, Avg tpr: 0.97412, Avg fpr: 0.03897, total FA: 304

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06573 | acc=0.9709 | tpr=0.9748 | fpr=0.0377 | 4404.7 samples/s | 17.2 steps/s
Avg test loss: 0.06600, Avg test acc: 0.97099, Avg tpr: 0.97523, Avg fpr: 0.03833, total FA: 299

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.97490 | acc=0.3161 | tpr=0.0096 | fpr=0.0183 | 4502.9 samples/s | 17.6 steps/s
Avg test loss: 4.99197, Avg test acc: 0.31373, Avg tpr: 0.00985, Avg fpr: 0.01795, total FA: 140

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.31330 | acc=0.3109 | tpr=0.0102 | fpr=0.0359 | 4412.1 samples/s | 17.2 steps/s
Avg test loss: 5.32901, Avg test acc: 0.30892, Avg tpr: 0.01061, Avg fpr: 0.03500, total FA: 273

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.93749 | acc=0.1378 | tpr=0.7080 | fpr=0.8724 | 4444.4 samples/s | 17.4 steps/s
[Step= 100] | Loss=4.92479 | acc=0.1364 | tpr=0.7100 | fpr=0.8743 | 8675.2 samples/s | 33.9 steps/s
[Step= 150] | Loss=4.93305 | acc=0.1358 | tpr=0.7003 | fpr=0.8746 | 9045.2 samples/s | 35.3 steps/s
[Step= 200] | Loss=4.93585 | acc=0.1357 | tpr=0.6831 | fpr=0.8743 | 8394.1 samples/s | 32.8 steps/s
[Step= 250] | Loss=4.94516 | acc=0.1357 | tpr=0.6812 | fpr=0.8742 | 7888.1 samples/s | 30.8 steps/s
[Step= 300] | Loss=4.94296 | acc=0.1354 | tpr=0.6800 | fpr=0.8745 | 8716.0 samples/s | 34.0 steps/s
[Step= 350] | Loss=4.94225 | acc=0.1349 | tpr=0.6800 | fpr=0.8750 | 8001.1 samples/s | 31.3 steps/s
[Step= 400] | Loss=4.94772 | acc=0.1347 | tpr=0.6789 | fpr=0.8752 | 8599.1 samples/s | 33.6 steps/s
[Step= 450] | Loss=4.95069 | acc=0.1348 | tpr=0.6816 | fpr=0.8751 | 8231.2 samples/s | 32.2 steps/s
[Step= 500] | Loss=4.95072 | acc=0.1346 | tpr=0.6872 | fpr=0.8753 | 8291.5 samples/s | 32.4 steps/s
[Step= 550] | Loss=4.95504 | acc=0.1346 | tpr=0.6840 | fpr=0.8754 | 15876.6 samples/s | 62.0 steps/s
Avg test loss: 4.95484, Avg test acc: 0.13441, Avg tpr: 0.68423, Avg fpr: 0.87558, total FA: 121573

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.38092 | acc=0.1446 | tpr=0.6947 | fpr=0.8653 | 4441.0 samples/s | 17.3 steps/s
[Step= 100] | Loss=5.36357 | acc=0.1437 | tpr=0.7058 | fpr=0.8668 | 8283.5 samples/s | 32.4 steps/s
[Step= 150] | Loss=5.36853 | acc=0.1426 | tpr=0.6988 | fpr=0.8676 | 8371.3 samples/s | 32.7 steps/s
[Step= 200] | Loss=5.36932 | acc=0.1431 | tpr=0.6842 | fpr=0.8667 | 8796.8 samples/s | 34.4 steps/s
[Step= 250] | Loss=5.38040 | acc=0.1431 | tpr=0.6882 | fpr=0.8668 | 8315.3 samples/s | 32.5 steps/s
[Step= 300] | Loss=5.37884 | acc=0.1430 | tpr=0.6844 | fpr=0.8669 | 8203.0 samples/s | 32.0 steps/s
[Step= 350] | Loss=5.37600 | acc=0.1423 | tpr=0.6800 | fpr=0.8674 | 8454.9 samples/s | 33.0 steps/s
[Step= 400] | Loss=5.38204 | acc=0.1423 | tpr=0.6789 | fpr=0.8674 | 8190.7 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.38502 | acc=0.1423 | tpr=0.6826 | fpr=0.8676 | 8551.6 samples/s | 33.4 steps/s
[Step= 500] | Loss=5.38406 | acc=0.1421 | tpr=0.6872 | fpr=0.8678 | 8004.8 samples/s | 31.3 steps/s
[Step= 550] | Loss=5.38887 | acc=0.1420 | tpr=0.6832 | fpr=0.8678 | 15442.4 samples/s | 60.3 steps/s
Avg test loss: 5.38880, Avg test acc: 0.14190, Avg tpr: 0.68384, Avg fpr: 0.86795, total FA: 120513

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11164 | acc=0.9809 | tpr=0.9469 | fpr=0.0185 | 4395.3 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.11768 | acc=0.9809 | tpr=0.9616 | fpr=0.0188 | 8454.9 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.12131 | acc=0.9803 | tpr=0.9625 | fpr=0.0194 | 8248.4 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.12225 | acc=0.9804 | tpr=0.9650 | fpr=0.0193 | 8598.7 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.12100 | acc=0.9806 | tpr=0.9642 | fpr=0.0191 | 7951.2 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.12225 | acc=0.9806 | tpr=0.9644 | fpr=0.0191 | 8561.8 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.12356 | acc=0.9803 | tpr=0.9643 | fpr=0.0194 | 8425.6 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.12485 | acc=0.9802 | tpr=0.9639 | fpr=0.0195 | 8534.7 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.12723 | acc=0.9799 | tpr=0.9620 | fpr=0.0197 | 8859.6 samples/s | 34.6 steps/s
[Step= 500] | Loss=0.12691 | acc=0.9799 | tpr=0.9617 | fpr=0.0197 | 7990.3 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.12584 | acc=0.9799 | tpr=0.9590 | fpr=0.0197 | 15198.6 samples/s | 59.4 steps/s
Avg test loss: 0.12549, Avg test acc: 0.97996, Avg tpr: 0.95919, Avg fpr: 0.01966, total FA: 2730

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11536 | acc=0.9817 | tpr=0.9425 | fpr=0.0176 | 4549.2 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.12133 | acc=0.9815 | tpr=0.9638 | fpr=0.0182 | 8464.2 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.12589 | acc=0.9810 | tpr=0.9669 | fpr=0.0187 | 7822.2 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.12656 | acc=0.9811 | tpr=0.9694 | fpr=0.0187 | 8482.8 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.12565 | acc=0.9812 | tpr=0.9677 | fpr=0.0185 | 8270.6 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.12671 | acc=0.9812 | tpr=0.9695 | fpr=0.0186 | 8267.4 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.12806 | acc=0.9810 | tpr=0.9693 | fpr=0.0188 | 8149.2 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.12985 | acc=0.9808 | tpr=0.9688 | fpr=0.0190 | 8615.3 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.13241 | acc=0.9806 | tpr=0.9669 | fpr=0.0192 | 8215.5 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.13211 | acc=0.9805 | tpr=0.9665 | fpr=0.0192 | 8512.8 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.13103 | acc=0.9806 | tpr=0.9642 | fpr=0.0191 | 14470.6 samples/s | 56.5 steps/s
Avg test loss: 0.13071, Avg test acc: 0.98063, Avg tpr: 0.96434, Avg fpr: 0.01908, total FA: 2649

server round 42/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=84001 Epoch=163.8] | Loss=0.01284 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.453 | L2-Norm(final)=20.476 | 3929.8 samples/s | 61.4 steps/s
[Step=84050 Epoch=163.9] | Loss=0.01112 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.453 | L2-Norm(final)=20.480 | 5132.5 samples/s | 80.2 steps/s
[Step=84100 Epoch=164.0] | Loss=0.01182 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.454 | L2-Norm(final)=20.482 | 5482.7 samples/s | 85.7 steps/s
[Step=84150 Epoch=164.1] | Loss=0.01227 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.454 | L2-Norm(final)=20.483 | 5557.3 samples/s | 86.8 steps/s
[Step=84200 Epoch=164.2] | Loss=0.01221 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.454 | L2-Norm(final)=20.484 | 5466.6 samples/s | 85.4 steps/s
[Step=84250 Epoch=164.3] | Loss=0.01207 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.454 | L2-Norm(final)=20.485 | 5578.6 samples/s | 87.2 steps/s
[Step=84300 Epoch=164.4] | Loss=0.01188 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.454 | L2-Norm(final)=20.486 | 5409.2 samples/s | 84.5 steps/s
[Step=84350 Epoch=164.5] | Loss=0.01216 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.454 | L2-Norm(final)=20.487 | 5451.3 samples/s | 85.2 steps/s
[Step=84400 Epoch=164.6] | Loss=0.01234 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.454 | L2-Norm(final)=20.488 | 5511.5 samples/s | 86.1 steps/s
[Step=84450 Epoch=164.7] | Loss=0.01211 | Reg=0.00071 | acc=0.9688 | L2-Norm=8.454 | L2-Norm(final)=20.489 | 5489.4 samples/s | 85.8 steps/s
[Step=84500 Epoch=164.8] | Loss=0.01193 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.454 | L2-Norm(final)=20.490 | 6966.3 samples/s | 108.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=84501 Epoch=164.8] | Loss=0.01134 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.454 | L2-Norm(final)=20.502 | 4077.6 samples/s | 63.7 steps/s
[Step=84550 Epoch=164.9] | Loss=0.01298 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.461 | L2-Norm(final)=20.504 | 4437.3 samples/s | 69.3 steps/s
[Step=84600 Epoch=165.0] | Loss=0.01083 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.470 | L2-Norm(final)=20.509 | 4748.6 samples/s | 74.2 steps/s
[Step=84650 Epoch=165.1] | Loss=0.01095 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.477 | L2-Norm(final)=20.512 | 4750.8 samples/s | 74.2 steps/s
[Step=84700 Epoch=165.2] | Loss=0.01051 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.483 | L2-Norm(final)=20.516 | 4766.0 samples/s | 74.5 steps/s
[Step=84750 Epoch=165.3] | Loss=0.01055 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.488 | L2-Norm(final)=20.520 | 4761.4 samples/s | 74.4 steps/s
[Step=84800 Epoch=165.4] | Loss=0.01022 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.494 | L2-Norm(final)=20.524 | 4792.4 samples/s | 74.9 steps/s
[Step=84850 Epoch=165.5] | Loss=0.00993 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.499 | L2-Norm(final)=20.528 | 4695.3 samples/s | 73.4 steps/s
[Step=84900 Epoch=165.6] | Loss=0.00966 | Reg=0.00072 | acc=0.9844 | L2-Norm=8.504 | L2-Norm(final)=20.532 | 4754.4 samples/s | 74.3 steps/s
[Step=84950 Epoch=165.7] | Loss=0.00917 | Reg=0.00072 | acc=0.9844 | L2-Norm=8.509 | L2-Norm(final)=20.535 | 4850.9 samples/s | 75.8 steps/s
[Step=85000 Epoch=165.8] | Loss=0.00905 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.513 | L2-Norm(final)=20.539 | 5778.5 samples/s | 90.3 steps/s
[Step=85050 Epoch=165.9] | Loss=0.00884 | Reg=0.00073 | acc=0.9844 | L2-Norm=8.518 | L2-Norm(final)=20.543 | 1937.1 samples/s | 30.3 steps/s
[Step=85100 Epoch=166.0] | Loss=0.00872 | Reg=0.00073 | acc=0.9844 | L2-Norm=8.522 | L2-Norm(final)=20.546 | 4722.6 samples/s | 73.8 steps/s
[Step=85150 Epoch=166.1] | Loss=0.00861 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.525 | L2-Norm(final)=20.549 | 4773.0 samples/s | 74.6 steps/s
[Step=85200 Epoch=166.2] | Loss=0.00843 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.529 | L2-Norm(final)=20.552 | 4673.6 samples/s | 73.0 steps/s
[Step=85250 Epoch=166.3] | Loss=0.00828 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.532 | L2-Norm(final)=20.555 | 4725.1 samples/s | 73.8 steps/s
[Step=85300 Epoch=166.4] | Loss=0.00819 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.536 | L2-Norm(final)=20.558 | 4749.2 samples/s | 74.2 steps/s
[Step=85350 Epoch=166.5] | Loss=0.00800 | Reg=0.00073 | acc=0.9844 | L2-Norm=8.539 | L2-Norm(final)=20.561 | 4771.0 samples/s | 74.5 steps/s
[Step=85400 Epoch=166.6] | Loss=0.00801 | Reg=0.00073 | acc=0.9844 | L2-Norm=8.542 | L2-Norm(final)=20.564 | 4822.8 samples/s | 75.4 steps/s
[Step=85450 Epoch=166.7] | Loss=0.00791 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.545 | L2-Norm(final)=20.567 | 4786.0 samples/s | 74.8 steps/s
[Step=85500 Epoch=166.8] | Loss=0.00786 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.548 | L2-Norm(final)=20.570 | 4988.2 samples/s | 77.9 steps/s
[Step=85550 Epoch=166.9] | Loss=0.00778 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.551 | L2-Norm(final)=20.573 | 2084.5 samples/s | 32.6 steps/s
[Step=85600 Epoch=167.0] | Loss=0.00771 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.554 | L2-Norm(final)=20.576 | 4820.9 samples/s | 75.3 steps/s
[Step=85650 Epoch=167.1] | Loss=0.00760 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.557 | L2-Norm(final)=20.579 | 4743.1 samples/s | 74.1 steps/s
[Step=85700 Epoch=167.1] | Loss=0.00751 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.560 | L2-Norm(final)=20.581 | 4736.7 samples/s | 74.0 steps/s
[Step=85750 Epoch=167.2] | Loss=0.00746 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.563 | L2-Norm(final)=20.584 | 4774.7 samples/s | 74.6 steps/s
[Step=85800 Epoch=167.3] | Loss=0.00741 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.565 | L2-Norm(final)=20.587 | 4802.1 samples/s | 75.0 steps/s
[Step=85850 Epoch=167.4] | Loss=0.00740 | Reg=0.00073 | acc=0.9844 | L2-Norm=8.568 | L2-Norm(final)=20.590 | 4786.7 samples/s | 74.8 steps/s
[Step=85900 Epoch=167.5] | Loss=0.00736 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.570 | L2-Norm(final)=20.592 | 4769.8 samples/s | 74.5 steps/s
[Step=85950 Epoch=167.6] | Loss=0.00730 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.573 | L2-Norm(final)=20.595 | 4786.5 samples/s | 74.8 steps/s
[Step=86000 Epoch=167.7] | Loss=0.00722 | Reg=0.00074 | acc=0.9844 | L2-Norm=8.575 | L2-Norm(final)=20.597 | 4744.2 samples/s | 74.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step86000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=84001 Epoch=164.2] | Loss=0.00776 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.453 | L2-Norm(final)=21.276 | 4195.4 samples/s | 65.6 steps/s
[Step=84050 Epoch=164.3] | Loss=0.01128 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.453 | L2-Norm(final)=21.282 | 5430.3 samples/s | 84.8 steps/s
[Step=84100 Epoch=164.4] | Loss=0.01193 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.453 | L2-Norm(final)=21.291 | 5686.4 samples/s | 88.9 steps/s
[Step=84150 Epoch=164.5] | Loss=0.01155 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.453 | L2-Norm(final)=21.300 | 5502.9 samples/s | 86.0 steps/s
[Step=84200 Epoch=164.6] | Loss=0.01210 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.453 | L2-Norm(final)=21.309 | 5637.6 samples/s | 88.1 steps/s
[Step=84250 Epoch=164.7] | Loss=0.01228 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.453 | L2-Norm(final)=21.317 | 5400.5 samples/s | 84.4 steps/s
[Step=84300 Epoch=164.8] | Loss=0.01218 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.453 | L2-Norm(final)=21.324 | 5464.0 samples/s | 85.4 steps/s
[Step=84350 Epoch=164.9] | Loss=0.01158 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.453 | L2-Norm(final)=21.331 | 5474.3 samples/s | 85.5 steps/s
[Step=84400 Epoch=165.0] | Loss=0.01142 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.453 | L2-Norm(final)=21.338 | 5510.5 samples/s | 86.1 steps/s
[Step=84450 Epoch=165.1] | Loss=0.01131 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.453 | L2-Norm(final)=21.345 | 5595.9 samples/s | 87.4 steps/s
[Step=84500 Epoch=165.2] | Loss=0.01134 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.453 | L2-Norm(final)=21.352 | 6823.8 samples/s | 106.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=84501 Epoch=165.2] | Loss=0.01026 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.453 | L2-Norm(final)=21.421 | 4311.8 samples/s | 67.4 steps/s
[Step=84550 Epoch=165.3] | Loss=0.01047 | Reg=0.00072 | acc=0.9844 | L2-Norm=8.461 | L2-Norm(final)=21.426 | 4658.9 samples/s | 72.8 steps/s
[Step=84600 Epoch=165.4] | Loss=0.01166 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.469 | L2-Norm(final)=21.430 | 4820.6 samples/s | 75.3 steps/s
[Step=84650 Epoch=165.5] | Loss=0.01077 | Reg=0.00072 | acc=0.9844 | L2-Norm=8.475 | L2-Norm(final)=21.434 | 4734.4 samples/s | 74.0 steps/s
[Step=84700 Epoch=165.6] | Loss=0.01032 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.482 | L2-Norm(final)=21.438 | 4734.3 samples/s | 74.0 steps/s
[Step=84750 Epoch=165.7] | Loss=0.00983 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.488 | L2-Norm(final)=21.443 | 4698.7 samples/s | 73.4 steps/s
[Step=84800 Epoch=165.8] | Loss=0.00929 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.494 | L2-Norm(final)=21.447 | 4817.8 samples/s | 75.3 steps/s
[Step=84850 Epoch=165.9] | Loss=0.00887 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.499 | L2-Norm(final)=21.452 | 4704.3 samples/s | 73.5 steps/s
[Step=84900 Epoch=166.0] | Loss=0.00874 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.504 | L2-Norm(final)=21.456 | 4814.6 samples/s | 75.2 steps/s
[Step=84950 Epoch=166.1] | Loss=0.00853 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.509 | L2-Norm(final)=21.460 | 4718.1 samples/s | 73.7 steps/s
[Step=85000 Epoch=166.2] | Loss=0.00850 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.514 | L2-Norm(final)=21.464 | 5917.6 samples/s | 92.5 steps/s
[Step=85050 Epoch=166.3] | Loss=0.00828 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.518 | L2-Norm(final)=21.468 | 2007.5 samples/s | 31.4 steps/s
[Step=85100 Epoch=166.4] | Loss=0.00807 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.523 | L2-Norm(final)=21.472 | 4704.3 samples/s | 73.5 steps/s
[Step=85150 Epoch=166.5] | Loss=0.00783 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.527 | L2-Norm(final)=21.475 | 4772.7 samples/s | 74.6 steps/s
[Step=85200 Epoch=166.6] | Loss=0.00769 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.531 | L2-Norm(final)=21.479 | 4782.9 samples/s | 74.7 steps/s
[Step=85250 Epoch=166.7] | Loss=0.00759 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.534 | L2-Norm(final)=21.483 | 4691.5 samples/s | 73.3 steps/s
[Step=85300 Epoch=166.8] | Loss=0.00751 | Reg=0.00073 | acc=0.9844 | L2-Norm=8.538 | L2-Norm(final)=21.486 | 4764.1 samples/s | 74.4 steps/s
[Step=85350 Epoch=166.9] | Loss=0.00754 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.541 | L2-Norm(final)=21.490 | 4748.3 samples/s | 74.2 steps/s
[Step=85400 Epoch=167.0] | Loss=0.00745 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.545 | L2-Norm(final)=21.493 | 4767.4 samples/s | 74.5 steps/s
[Step=85450 Epoch=167.1] | Loss=0.00737 | Reg=0.00073 | acc=0.9844 | L2-Norm=8.548 | L2-Norm(final)=21.497 | 4827.4 samples/s | 75.4 steps/s
[Step=85500 Epoch=167.2] | Loss=0.00727 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.551 | L2-Norm(final)=21.500 | 5132.8 samples/s | 80.2 steps/s
[Step=85550 Epoch=167.2] | Loss=0.00712 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.554 | L2-Norm(final)=21.503 | 2110.5 samples/s | 33.0 steps/s
[Step=85600 Epoch=167.3] | Loss=0.00708 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.557 | L2-Norm(final)=21.506 | 4783.7 samples/s | 74.7 steps/s
[Step=85650 Epoch=167.4] | Loss=0.00699 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.560 | L2-Norm(final)=21.510 | 4757.4 samples/s | 74.3 steps/s
[Step=85700 Epoch=167.5] | Loss=0.00686 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.563 | L2-Norm(final)=21.513 | 4805.9 samples/s | 75.1 steps/s
[Step=85750 Epoch=167.6] | Loss=0.00677 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.566 | L2-Norm(final)=21.516 | 4768.2 samples/s | 74.5 steps/s
[Step=85800 Epoch=167.7] | Loss=0.00672 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.569 | L2-Norm(final)=21.520 | 4770.0 samples/s | 74.5 steps/s
[Step=85850 Epoch=167.8] | Loss=0.00668 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.572 | L2-Norm(final)=21.523 | 4794.1 samples/s | 74.9 steps/s
[Step=85900 Epoch=167.9] | Loss=0.00659 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.574 | L2-Norm(final)=21.526 | 4728.6 samples/s | 73.9 steps/s
[Step=85950 Epoch=168.0] | Loss=0.00659 | Reg=0.00074 | acc=0.9688 | L2-Norm=8.577 | L2-Norm(final)=21.529 | 4773.7 samples/s | 74.6 steps/s
[Step=86000 Epoch=168.1] | Loss=0.00652 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.580 | L2-Norm(final)=21.532 | 4878.0 samples/s | 76.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step86000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=84001 Epoch=321.9] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.453 | L2-Norm(final)=19.211 | 4195.2 samples/s | 65.6 steps/s
[Step=84050 Epoch=322.0] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.448 | L2-Norm(final)=19.215 | 4842.7 samples/s | 75.7 steps/s
[Step=84100 Epoch=322.2] | Loss=0.00001 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.448 | L2-Norm(final)=19.222 | 5242.0 samples/s | 81.9 steps/s
[Step=84150 Epoch=322.4] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.448 | L2-Norm(final)=19.227 | 5319.2 samples/s | 83.1 steps/s
[Step=84200 Epoch=322.6] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.447 | L2-Norm(final)=19.232 | 5038.2 samples/s | 78.7 steps/s
[Step=84250 Epoch=322.8] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.447 | L2-Norm(final)=19.237 | 6743.6 samples/s | 105.4 steps/s
[Step=84300 Epoch=323.0] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.447 | L2-Norm(final)=19.243 | 2073.3 samples/s | 32.4 steps/s
[Step=84350 Epoch=323.2] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.447 | L2-Norm(final)=19.249 | 5149.8 samples/s | 80.5 steps/s
[Step=84400 Epoch=323.4] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.447 | L2-Norm(final)=19.255 | 5164.6 samples/s | 80.7 steps/s
[Step=84450 Epoch=323.6] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.447 | L2-Norm(final)=19.260 | 5044.0 samples/s | 78.8 steps/s
[Step=84500 Epoch=323.8] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.447 | L2-Norm(final)=19.264 | 5904.9 samples/s | 92.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=84501 Epoch=323.8] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.447 | L2-Norm(final)=19.309 | 4126.9 samples/s | 64.5 steps/s
[Step=84550 Epoch=324.0] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.432 | L2-Norm(final)=19.312 | 4507.0 samples/s | 70.4 steps/s
[Step=84600 Epoch=324.2] | Loss=0.00001 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.416 | L2-Norm(final)=19.315 | 4525.3 samples/s | 70.7 steps/s
[Step=84650 Epoch=324.3] | Loss=0.00001 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.399 | L2-Norm(final)=19.316 | 4409.8 samples/s | 68.9 steps/s
[Step=84700 Epoch=324.5] | Loss=0.00001 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.382 | L2-Norm(final)=19.317 | 4504.4 samples/s | 70.4 steps/s
[Step=84750 Epoch=324.7] | Loss=0.00001 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.364 | L2-Norm(final)=19.318 | 5650.8 samples/s | 88.3 steps/s
[Step=84800 Epoch=324.9] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.347 | L2-Norm(final)=19.319 | 1931.6 samples/s | 30.2 steps/s
[Step=84850 Epoch=325.1] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.330 | L2-Norm(final)=19.320 | 4441.8 samples/s | 69.4 steps/s
[Step=84900 Epoch=325.3] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.312 | L2-Norm(final)=19.321 | 4515.9 samples/s | 70.6 steps/s
[Step=84950 Epoch=325.5] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.294 | L2-Norm(final)=19.321 | 4456.7 samples/s | 69.6 steps/s
[Step=85000 Epoch=325.7] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.276 | L2-Norm(final)=19.322 | 5004.2 samples/s | 78.2 steps/s
[Step=85050 Epoch=325.9] | Loss=0.00000 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.259 | L2-Norm(final)=19.323 | 2066.6 samples/s | 32.3 steps/s
[Step=85100 Epoch=326.1] | Loss=0.00000 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.241 | L2-Norm(final)=19.323 | 4602.6 samples/s | 71.9 steps/s
[Step=85150 Epoch=326.3] | Loss=0.00000 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.223 | L2-Norm(final)=19.324 | 4602.2 samples/s | 71.9 steps/s
[Step=85200 Epoch=326.5] | Loss=0.00000 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.204 | L2-Norm(final)=19.324 | 4643.3 samples/s | 72.6 steps/s
[Step=85250 Epoch=326.6] | Loss=0.00000 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.186 | L2-Norm(final)=19.325 | 4682.9 samples/s | 73.2 steps/s
[Step=85300 Epoch=326.8] | Loss=0.00000 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.168 | L2-Norm(final)=19.326 | 2117.3 samples/s | 33.1 steps/s
[Step=85350 Epoch=327.0] | Loss=0.00000 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.150 | L2-Norm(final)=19.327 | 4633.3 samples/s | 72.4 steps/s
[Step=85400 Epoch=327.2] | Loss=0.00000 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.131 | L2-Norm(final)=19.327 | 4460.5 samples/s | 69.7 steps/s
[Step=85450 Epoch=327.4] | Loss=0.00000 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.112 | L2-Norm(final)=19.328 | 4494.8 samples/s | 70.2 steps/s
[Step=85500 Epoch=327.6] | Loss=0.00000 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.094 | L2-Norm(final)=19.329 | 4509.8 samples/s | 70.5 steps/s
[Step=85550 Epoch=327.8] | Loss=0.00000 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.075 | L2-Norm(final)=19.330 | 2137.2 samples/s | 33.4 steps/s
[Step=85600 Epoch=328.0] | Loss=0.00000 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.056 | L2-Norm(final)=19.330 | 4579.4 samples/s | 71.6 steps/s
[Step=85650 Epoch=328.2] | Loss=0.00000 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.037 | L2-Norm(final)=19.331 | 4422.3 samples/s | 69.1 steps/s
[Step=85700 Epoch=328.4] | Loss=0.00000 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.018 | L2-Norm(final)=19.332 | 4497.0 samples/s | 70.3 steps/s
[Step=85750 Epoch=328.6] | Loss=0.00000 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.999 | L2-Norm(final)=19.333 | 4557.1 samples/s | 71.2 steps/s
[Step=85800 Epoch=328.8] | Loss=0.00000 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.979 | L2-Norm(final)=19.334 | 6161.5 samples/s | 96.3 steps/s
[Step=85850 Epoch=328.9] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.960 | L2-Norm(final)=19.335 | 1880.7 samples/s | 29.4 steps/s
[Step=85900 Epoch=329.1] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.941 | L2-Norm(final)=19.336 | 4578.0 samples/s | 71.5 steps/s
[Step=85950 Epoch=329.3] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.921 | L2-Norm(final)=19.337 | 4584.9 samples/s | 71.6 steps/s
[Step=86000 Epoch=329.5] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.901 | L2-Norm(final)=19.338 | 4582.1 samples/s | 71.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step86000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=84001 Epoch=323.4] | Loss=0.00005 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.453 | L2-Norm(final)=18.955 | 4554.6 samples/s | 71.2 steps/s
[Step=84050 Epoch=323.5] | Loss=0.00005 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.452 | L2-Norm(final)=18.957 | 4500.1 samples/s | 70.3 steps/s
[Step=84100 Epoch=323.7] | Loss=0.00005 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.451 | L2-Norm(final)=18.963 | 5348.2 samples/s | 83.6 steps/s
[Step=84150 Epoch=323.9] | Loss=0.00004 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.451 | L2-Norm(final)=18.967 | 5109.9 samples/s | 79.8 steps/s
[Step=84200 Epoch=324.1] | Loss=0.00005 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.451 | L2-Norm(final)=18.971 | 5219.6 samples/s | 81.6 steps/s
[Step=84250 Epoch=324.3] | Loss=0.00005 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.451 | L2-Norm(final)=18.974 | 6792.2 samples/s | 106.1 steps/s
[Step=84300 Epoch=324.5] | Loss=0.00005 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.451 | L2-Norm(final)=18.978 | 2054.8 samples/s | 32.1 steps/s
[Step=84350 Epoch=324.7] | Loss=0.00005 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.451 | L2-Norm(final)=18.981 | 5289.8 samples/s | 82.7 steps/s
[Step=84400 Epoch=324.9] | Loss=0.00005 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.451 | L2-Norm(final)=18.985 | 5380.9 samples/s | 84.1 steps/s
[Step=84450 Epoch=325.1] | Loss=0.00005 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.451 | L2-Norm(final)=18.989 | 4930.6 samples/s | 77.0 steps/s
[Step=84500 Epoch=325.3] | Loss=0.00005 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.451 | L2-Norm(final)=18.993 | 5801.2 samples/s | 90.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=84501 Epoch=325.3] | Loss=0.00001 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.451 | L2-Norm(final)=19.028 | 4275.2 samples/s | 66.8 steps/s
[Step=84550 Epoch=325.5] | Loss=0.00004 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.449 | L2-Norm(final)=19.032 | 4308.2 samples/s | 67.3 steps/s
[Step=84600 Epoch=325.7] | Loss=0.00003 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.447 | L2-Norm(final)=19.034 | 4454.9 samples/s | 69.6 steps/s
[Step=84650 Epoch=325.9] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.443 | L2-Norm(final)=19.036 | 4539.9 samples/s | 70.9 steps/s
[Step=84700 Epoch=326.0] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.438 | L2-Norm(final)=19.037 | 4527.5 samples/s | 70.7 steps/s
[Step=84750 Epoch=326.2] | Loss=0.00002 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.432 | L2-Norm(final)=19.038 | 5744.7 samples/s | 89.8 steps/s
[Step=84800 Epoch=326.4] | Loss=0.00001 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.426 | L2-Norm(final)=19.039 | 1910.0 samples/s | 29.8 steps/s
[Step=84850 Epoch=326.6] | Loss=0.00001 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.421 | L2-Norm(final)=19.040 | 4499.4 samples/s | 70.3 steps/s
[Step=84900 Epoch=326.8] | Loss=0.00001 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.415 | L2-Norm(final)=19.041 | 4578.5 samples/s | 71.5 steps/s
[Step=84950 Epoch=327.0] | Loss=0.00001 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.409 | L2-Norm(final)=19.042 | 4397.6 samples/s | 68.7 steps/s
[Step=85000 Epoch=327.2] | Loss=0.00001 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.402 | L2-Norm(final)=19.042 | 5089.8 samples/s | 79.5 steps/s
[Step=85050 Epoch=327.4] | Loss=0.00001 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.396 | L2-Norm(final)=19.043 | 2016.0 samples/s | 31.5 steps/s
[Step=85100 Epoch=327.6] | Loss=0.00001 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.390 | L2-Norm(final)=19.044 | 4483.9 samples/s | 70.1 steps/s
[Step=85150 Epoch=327.8] | Loss=0.00001 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.383 | L2-Norm(final)=19.044 | 4407.9 samples/s | 68.9 steps/s
[Step=85200 Epoch=328.0] | Loss=0.00001 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.377 | L2-Norm(final)=19.045 | 4456.7 samples/s | 69.6 steps/s
[Step=85250 Epoch=328.2] | Loss=0.00001 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.370 | L2-Norm(final)=19.045 | 4575.1 samples/s | 71.5 steps/s
[Step=85300 Epoch=328.4] | Loss=0.00001 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.364 | L2-Norm(final)=19.046 | 2077.6 samples/s | 32.5 steps/s
[Step=85350 Epoch=328.5] | Loss=0.00001 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.357 | L2-Norm(final)=19.046 | 4528.7 samples/s | 70.8 steps/s
[Step=85400 Epoch=328.7] | Loss=0.00001 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.350 | L2-Norm(final)=19.047 | 4495.5 samples/s | 70.2 steps/s
[Step=85450 Epoch=328.9] | Loss=0.00001 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.343 | L2-Norm(final)=19.047 | 4471.1 samples/s | 69.9 steps/s
[Step=85500 Epoch=329.1] | Loss=0.00001 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.336 | L2-Norm(final)=19.048 | 4477.6 samples/s | 70.0 steps/s
[Step=85550 Epoch=329.3] | Loss=0.00001 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.329 | L2-Norm(final)=19.048 | 2122.9 samples/s | 33.2 steps/s
[Step=85600 Epoch=329.5] | Loss=0.00001 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.322 | L2-Norm(final)=19.049 | 4509.0 samples/s | 70.5 steps/s
[Step=85650 Epoch=329.7] | Loss=0.00001 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.315 | L2-Norm(final)=19.049 | 4527.3 samples/s | 70.7 steps/s
[Step=85700 Epoch=329.9] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.307 | L2-Norm(final)=19.050 | 4517.0 samples/s | 70.6 steps/s
[Step=85750 Epoch=330.1] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.300 | L2-Norm(final)=19.051 | 4411.6 samples/s | 68.9 steps/s
[Step=85800 Epoch=330.3] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.292 | L2-Norm(final)=19.051 | 6634.9 samples/s | 103.7 steps/s
[Step=85850 Epoch=330.5] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.285 | L2-Norm(final)=19.052 | 1861.3 samples/s | 29.1 steps/s
[Step=85900 Epoch=330.7] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.277 | L2-Norm(final)=19.052 | 4628.6 samples/s | 72.3 steps/s
[Step=85950 Epoch=330.9] | Loss=0.00000 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.269 | L2-Norm(final)=19.053 | 4539.6 samples/s | 70.9 steps/s
[Step=86000 Epoch=331.0] | Loss=0.00000 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.261 | L2-Norm(final)=19.053 | 4491.5 samples/s | 70.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step86000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06204 | acc=0.9702 | tpr=0.9768 | fpr=0.0444 | 4408.0 samples/s | 17.2 steps/s
Avg test loss: 0.06153, Avg test acc: 0.97035, Avg tpr: 0.97692, Avg fpr: 0.04410, total FA: 344

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06472 | acc=0.9702 | tpr=0.9754 | fpr=0.0409 | 4487.6 samples/s | 17.5 steps/s
Avg test loss: 0.06445, Avg test acc: 0.97123, Avg tpr: 0.97674, Avg fpr: 0.04089, total FA: 319

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.10386 | acc=0.3148 | tpr=0.0088 | fpr=0.0208 | 4462.2 samples/s | 17.4 steps/s
Avg test loss: 5.12317, Avg test acc: 0.31277, Avg tpr: 0.00915, Avg fpr: 0.01948, total FA: 152

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.36184 | acc=0.3111 | tpr=0.0096 | fpr=0.0342 | 4363.6 samples/s | 17.0 steps/s
Avg test loss: 5.37700, Avg test acc: 0.30900, Avg tpr: 0.01014, Avg fpr: 0.03371, total FA: 263

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.09548 | acc=0.1326 | tpr=0.7301 | fpr=0.8782 | 4456.4 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.08102 | acc=0.1321 | tpr=0.7292 | fpr=0.8791 | 8245.2 samples/s | 32.2 steps/s
[Step= 150] | Loss=5.08807 | acc=0.1312 | tpr=0.7219 | fpr=0.8797 | 8494.2 samples/s | 33.2 steps/s
[Step= 200] | Loss=5.09119 | acc=0.1310 | tpr=0.7093 | fpr=0.8795 | 8337.2 samples/s | 32.6 steps/s
[Step= 250] | Loss=5.10048 | acc=0.1312 | tpr=0.7109 | fpr=0.8794 | 8497.3 samples/s | 33.2 steps/s
[Step= 300] | Loss=5.09819 | acc=0.1311 | tpr=0.7105 | fpr=0.8795 | 8658.7 samples/s | 33.8 steps/s
[Step= 350] | Loss=5.09797 | acc=0.1305 | tpr=0.7107 | fpr=0.8800 | 8267.9 samples/s | 32.3 steps/s
[Step= 400] | Loss=5.10376 | acc=0.1304 | tpr=0.7084 | fpr=0.8801 | 8555.2 samples/s | 33.4 steps/s
[Step= 450] | Loss=5.10733 | acc=0.1305 | tpr=0.7113 | fpr=0.8801 | 8330.5 samples/s | 32.5 steps/s
[Step= 500] | Loss=5.10731 | acc=0.1302 | tpr=0.7159 | fpr=0.8804 | 8400.4 samples/s | 32.8 steps/s
[Step= 550] | Loss=5.11176 | acc=0.1302 | tpr=0.7139 | fpr=0.8804 | 14661.5 samples/s | 57.3 steps/s
Avg test loss: 5.11157, Avg test acc: 0.13012, Avg tpr: 0.71434, Avg fpr: 0.88050, total FA: 122255

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.27053 | acc=0.1391 | tpr=0.6858 | fpr=0.8707 | 4517.1 samples/s | 17.6 steps/s
[Step= 100] | Loss=5.25152 | acc=0.1384 | tpr=0.7015 | fpr=0.8721 | 8538.1 samples/s | 33.4 steps/s
[Step= 150] | Loss=5.25548 | acc=0.1373 | tpr=0.6960 | fpr=0.8730 | 8337.7 samples/s | 32.6 steps/s
[Step= 200] | Loss=5.25584 | acc=0.1370 | tpr=0.6787 | fpr=0.8728 | 8304.7 samples/s | 32.4 steps/s
[Step= 250] | Loss=5.26609 | acc=0.1370 | tpr=0.6803 | fpr=0.8729 | 8305.9 samples/s | 32.4 steps/s
[Step= 300] | Loss=5.26480 | acc=0.1367 | tpr=0.6735 | fpr=0.8731 | 8495.6 samples/s | 33.2 steps/s
[Step= 350] | Loss=5.26240 | acc=0.1361 | tpr=0.6719 | fpr=0.8737 | 8342.1 samples/s | 32.6 steps/s
[Step= 400] | Loss=5.26819 | acc=0.1361 | tpr=0.6701 | fpr=0.8736 | 8387.7 samples/s | 32.8 steps/s
[Step= 450] | Loss=5.27133 | acc=0.1361 | tpr=0.6738 | fpr=0.8737 | 8038.7 samples/s | 31.4 steps/s
[Step= 500] | Loss=5.27005 | acc=0.1358 | tpr=0.6789 | fpr=0.8740 | 8185.6 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.27424 | acc=0.1357 | tpr=0.6745 | fpr=0.8741 | 15390.3 samples/s | 60.1 steps/s
Avg test loss: 5.27419, Avg test acc: 0.13563, Avg tpr: 0.67512, Avg fpr: 0.87418, total FA: 121378

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10999 | acc=0.9811 | tpr=0.9425 | fpr=0.0182 | 4535.9 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.11537 | acc=0.9807 | tpr=0.9595 | fpr=0.0189 | 8335.5 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.11916 | acc=0.9800 | tpr=0.9611 | fpr=0.0196 | 8306.6 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.12023 | acc=0.9802 | tpr=0.9639 | fpr=0.0195 | 8520.8 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.11893 | acc=0.9803 | tpr=0.9633 | fpr=0.0193 | 8528.6 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.12029 | acc=0.9804 | tpr=0.9636 | fpr=0.0193 | 8286.0 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.12166 | acc=0.9801 | tpr=0.9637 | fpr=0.0196 | 8646.3 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.12292 | acc=0.9799 | tpr=0.9639 | fpr=0.0198 | 8728.3 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.12523 | acc=0.9796 | tpr=0.9620 | fpr=0.0200 | 8038.6 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.12487 | acc=0.9797 | tpr=0.9626 | fpr=0.0200 | 8239.9 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.12386 | acc=0.9797 | tpr=0.9606 | fpr=0.0199 | 14919.1 samples/s | 58.3 steps/s
Avg test loss: 0.12354, Avg test acc: 0.97977, Avg tpr: 0.96078, Avg fpr: 0.01989, total FA: 2761

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11365 | acc=0.9820 | tpr=0.9425 | fpr=0.0173 | 4428.4 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.11920 | acc=0.9817 | tpr=0.9638 | fpr=0.0179 | 8366.2 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.12374 | acc=0.9812 | tpr=0.9683 | fpr=0.0185 | 8341.2 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.12445 | acc=0.9812 | tpr=0.9694 | fpr=0.0185 | 8428.9 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.12358 | acc=0.9813 | tpr=0.9686 | fpr=0.0185 | 8538.7 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.12476 | acc=0.9812 | tpr=0.9702 | fpr=0.0185 | 8119.9 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.12606 | acc=0.9810 | tpr=0.9693 | fpr=0.0188 | 8512.6 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.12782 | acc=0.9809 | tpr=0.9688 | fpr=0.0189 | 8439.0 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.13030 | acc=0.9806 | tpr=0.9669 | fpr=0.0191 | 8143.3 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.12997 | acc=0.9806 | tpr=0.9665 | fpr=0.0191 | 8310.1 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.12889 | acc=0.9807 | tpr=0.9642 | fpr=0.0190 | 15577.7 samples/s | 60.9 steps/s
Avg test loss: 0.12858, Avg test acc: 0.98071, Avg tpr: 0.96434, Avg fpr: 0.01899, total FA: 2637

server round 43/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=86001 Epoch=167.7] | Loss=0.01701 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.117 | L2-Norm(final)=20.676 | 4187.7 samples/s | 65.4 steps/s
[Step=86050 Epoch=167.8] | Loss=0.01342 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.118 | L2-Norm(final)=20.684 | 5103.3 samples/s | 79.7 steps/s
[Step=86100 Epoch=167.9] | Loss=0.01380 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.118 | L2-Norm(final)=20.693 | 5646.9 samples/s | 88.2 steps/s
[Step=86150 Epoch=168.0] | Loss=0.01401 | Reg=0.00066 | acc=0.9688 | L2-Norm=8.118 | L2-Norm(final)=20.702 | 5636.0 samples/s | 88.1 steps/s
[Step=86200 Epoch=168.1] | Loss=0.01431 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.118 | L2-Norm(final)=20.710 | 5562.0 samples/s | 86.9 steps/s
[Step=86250 Epoch=168.2] | Loss=0.01454 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.118 | L2-Norm(final)=20.718 | 5618.2 samples/s | 87.8 steps/s
[Step=86300 Epoch=168.3] | Loss=0.01473 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.118 | L2-Norm(final)=20.725 | 5549.3 samples/s | 86.7 steps/s
[Step=86350 Epoch=168.4] | Loss=0.01450 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.118 | L2-Norm(final)=20.732 | 5593.1 samples/s | 87.4 steps/s
[Step=86400 Epoch=168.5] | Loss=0.01462 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.118 | L2-Norm(final)=20.739 | 5406.8 samples/s | 84.5 steps/s
[Step=86450 Epoch=168.6] | Loss=0.01449 | Reg=0.00066 | acc=0.9688 | L2-Norm=8.118 | L2-Norm(final)=20.746 | 5393.1 samples/s | 84.3 steps/s
[Step=86500 Epoch=168.7] | Loss=0.01439 | Reg=0.00066 | acc=0.9531 | L2-Norm=8.118 | L2-Norm(final)=20.753 | 6983.4 samples/s | 109.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=86501 Epoch=168.7] | Loss=0.01573 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.118 | L2-Norm(final)=20.821 | 3967.0 samples/s | 62.0 steps/s
[Step=86550 Epoch=168.8] | Loss=0.01447 | Reg=0.00066 | acc=0.9688 | L2-Norm=8.127 | L2-Norm(final)=20.827 | 4618.4 samples/s | 72.2 steps/s
[Step=86600 Epoch=168.9] | Loss=0.01318 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.137 | L2-Norm(final)=20.833 | 4767.6 samples/s | 74.5 steps/s
[Step=86650 Epoch=169.0] | Loss=0.01316 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.146 | L2-Norm(final)=20.838 | 4765.6 samples/s | 74.5 steps/s
[Step=86700 Epoch=169.1] | Loss=0.01287 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.154 | L2-Norm(final)=20.843 | 4809.7 samples/s | 75.2 steps/s
[Step=86750 Epoch=169.2] | Loss=0.01212 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.162 | L2-Norm(final)=20.847 | 4740.3 samples/s | 74.1 steps/s
[Step=86800 Epoch=169.3] | Loss=0.01152 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.168 | L2-Norm(final)=20.851 | 4792.6 samples/s | 74.9 steps/s
[Step=86850 Epoch=169.4] | Loss=0.01142 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.175 | L2-Norm(final)=20.856 | 4783.7 samples/s | 74.7 steps/s
[Step=86900 Epoch=169.5] | Loss=0.01135 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.180 | L2-Norm(final)=20.860 | 4702.8 samples/s | 73.5 steps/s
[Step=86950 Epoch=169.6] | Loss=0.01116 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.186 | L2-Norm(final)=20.864 | 4823.3 samples/s | 75.4 steps/s
[Step=87000 Epoch=169.7] | Loss=0.01096 | Reg=0.00067 | acc=0.9844 | L2-Norm=8.191 | L2-Norm(final)=20.868 | 5852.2 samples/s | 91.4 steps/s
[Step=87050 Epoch=169.8] | Loss=0.01062 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.196 | L2-Norm(final)=20.872 | 1932.2 samples/s | 30.2 steps/s
[Step=87100 Epoch=169.9] | Loss=0.01026 | Reg=0.00067 | acc=0.9844 | L2-Norm=8.201 | L2-Norm(final)=20.876 | 4709.3 samples/s | 73.6 steps/s
[Step=87150 Epoch=170.0] | Loss=0.01006 | Reg=0.00067 | acc=0.9844 | L2-Norm=8.206 | L2-Norm(final)=20.879 | 4732.9 samples/s | 74.0 steps/s
[Step=87200 Epoch=170.1] | Loss=0.00983 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.211 | L2-Norm(final)=20.883 | 4757.4 samples/s | 74.3 steps/s
[Step=87250 Epoch=170.2] | Loss=0.00966 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.215 | L2-Norm(final)=20.887 | 4786.6 samples/s | 74.8 steps/s
[Step=87300 Epoch=170.3] | Loss=0.00956 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.219 | L2-Norm(final)=20.890 | 4748.5 samples/s | 74.2 steps/s
[Step=87350 Epoch=170.4] | Loss=0.00944 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.223 | L2-Norm(final)=20.894 | 4793.5 samples/s | 74.9 steps/s
[Step=87400 Epoch=170.5] | Loss=0.00934 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.227 | L2-Norm(final)=20.897 | 4750.5 samples/s | 74.2 steps/s
[Step=87450 Epoch=170.6] | Loss=0.00931 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.230 | L2-Norm(final)=20.901 | 4762.0 samples/s | 74.4 steps/s
[Step=87500 Epoch=170.7] | Loss=0.00921 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.234 | L2-Norm(final)=20.904 | 5054.6 samples/s | 79.0 steps/s
[Step=87550 Epoch=170.8] | Loss=0.00903 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.237 | L2-Norm(final)=20.907 | 2089.4 samples/s | 32.6 steps/s
[Step=87600 Epoch=170.9] | Loss=0.00891 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.241 | L2-Norm(final)=20.910 | 4913.8 samples/s | 76.8 steps/s
[Step=87650 Epoch=171.0] | Loss=0.00881 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.244 | L2-Norm(final)=20.914 | 4738.3 samples/s | 74.0 steps/s
[Step=87700 Epoch=171.0] | Loss=0.00877 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.248 | L2-Norm(final)=20.917 | 4875.8 samples/s | 76.2 steps/s
[Step=87750 Epoch=171.1] | Loss=0.00862 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.251 | L2-Norm(final)=20.920 | 4835.2 samples/s | 75.6 steps/s
[Step=87800 Epoch=171.2] | Loss=0.00851 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.254 | L2-Norm(final)=20.923 | 4797.5 samples/s | 75.0 steps/s
[Step=87850 Epoch=171.3] | Loss=0.00846 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.257 | L2-Norm(final)=20.926 | 4754.7 samples/s | 74.3 steps/s
[Step=87900 Epoch=171.4] | Loss=0.00833 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.260 | L2-Norm(final)=20.929 | 4791.8 samples/s | 74.9 steps/s
[Step=87950 Epoch=171.5] | Loss=0.00827 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.263 | L2-Norm(final)=20.932 | 4813.0 samples/s | 75.2 steps/s
[Step=88000 Epoch=171.6] | Loss=0.00826 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.266 | L2-Norm(final)=20.935 | 4752.7 samples/s | 74.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step88000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=86001 Epoch=168.1] | Loss=0.01720 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.117 | L2-Norm(final)=21.623 | 4372.9 samples/s | 68.3 steps/s
[Step=86050 Epoch=168.2] | Loss=0.01350 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.117 | L2-Norm(final)=21.632 | 5367.9 samples/s | 83.9 steps/s
[Step=86100 Epoch=168.3] | Loss=0.01407 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.118 | L2-Norm(final)=21.644 | 5342.7 samples/s | 83.5 steps/s
[Step=86150 Epoch=168.4] | Loss=0.01357 | Reg=0.00066 | acc=0.9688 | L2-Norm=8.118 | L2-Norm(final)=21.655 | 5476.5 samples/s | 85.6 steps/s
[Step=86200 Epoch=168.5] | Loss=0.01395 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.118 | L2-Norm(final)=21.665 | 5487.0 samples/s | 85.7 steps/s
[Step=86250 Epoch=168.6] | Loss=0.01421 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.118 | L2-Norm(final)=21.675 | 5462.5 samples/s | 85.4 steps/s
[Step=86300 Epoch=168.7] | Loss=0.01426 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.118 | L2-Norm(final)=21.684 | 5498.0 samples/s | 85.9 steps/s
[Step=86350 Epoch=168.8] | Loss=0.01439 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.118 | L2-Norm(final)=21.693 | 5486.6 samples/s | 85.7 steps/s
[Step=86400 Epoch=168.9] | Loss=0.01425 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.118 | L2-Norm(final)=21.702 | 5499.9 samples/s | 85.9 steps/s
[Step=86450 Epoch=169.0] | Loss=0.01419 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.118 | L2-Norm(final)=21.710 | 5499.7 samples/s | 85.9 steps/s
[Step=86500 Epoch=169.1] | Loss=0.01412 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.118 | L2-Norm(final)=21.719 | 6968.3 samples/s | 108.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=86501 Epoch=169.1] | Loss=0.00840 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.118 | L2-Norm(final)=21.806 | 4637.8 samples/s | 72.5 steps/s
[Step=86550 Epoch=169.2] | Loss=0.01166 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.127 | L2-Norm(final)=21.812 | 4456.7 samples/s | 69.6 steps/s
[Step=86600 Epoch=169.3] | Loss=0.01171 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.137 | L2-Norm(final)=21.816 | 4893.5 samples/s | 76.5 steps/s
[Step=86650 Epoch=169.4] | Loss=0.01122 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.147 | L2-Norm(final)=21.821 | 4881.5 samples/s | 76.3 steps/s
[Step=86700 Epoch=169.5] | Loss=0.01158 | Reg=0.00067 | acc=0.9531 | L2-Norm=8.155 | L2-Norm(final)=21.826 | 4888.1 samples/s | 76.4 steps/s
[Step=86750 Epoch=169.6] | Loss=0.01147 | Reg=0.00067 | acc=0.9688 | L2-Norm=8.162 | L2-Norm(final)=21.830 | 4902.3 samples/s | 76.6 steps/s
[Step=86800 Epoch=169.7] | Loss=0.01126 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.170 | L2-Norm(final)=21.834 | 4949.0 samples/s | 77.3 steps/s
[Step=86850 Epoch=169.8] | Loss=0.01105 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.177 | L2-Norm(final)=21.839 | 4886.5 samples/s | 76.4 steps/s
[Step=86900 Epoch=169.9] | Loss=0.01074 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.183 | L2-Norm(final)=21.843 | 4914.4 samples/s | 76.8 steps/s
[Step=86950 Epoch=170.0] | Loss=0.01042 | Reg=0.00067 | acc=0.9844 | L2-Norm=8.189 | L2-Norm(final)=21.848 | 4934.3 samples/s | 77.1 steps/s
[Step=87000 Epoch=170.1] | Loss=0.01035 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.195 | L2-Norm(final)=21.852 | 5995.7 samples/s | 93.7 steps/s
[Step=87050 Epoch=170.2] | Loss=0.00999 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.201 | L2-Norm(final)=21.857 | 2040.4 samples/s | 31.9 steps/s
[Step=87100 Epoch=170.3] | Loss=0.00971 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.206 | L2-Norm(final)=21.861 | 4692.4 samples/s | 73.3 steps/s
[Step=87150 Epoch=170.4] | Loss=0.00959 | Reg=0.00067 | acc=0.9688 | L2-Norm=8.211 | L2-Norm(final)=21.865 | 4690.9 samples/s | 73.3 steps/s
[Step=87200 Epoch=170.5] | Loss=0.00929 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.215 | L2-Norm(final)=21.869 | 4765.0 samples/s | 74.5 steps/s
[Step=87250 Epoch=170.6] | Loss=0.00910 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.220 | L2-Norm(final)=21.873 | 4826.1 samples/s | 75.4 steps/s
[Step=87300 Epoch=170.7] | Loss=0.00888 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.224 | L2-Norm(final)=21.877 | 4742.7 samples/s | 74.1 steps/s
[Step=87350 Epoch=170.8] | Loss=0.00880 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.228 | L2-Norm(final)=21.881 | 4731.2 samples/s | 73.9 steps/s
[Step=87400 Epoch=170.9] | Loss=0.00869 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.233 | L2-Norm(final)=21.885 | 4795.7 samples/s | 74.9 steps/s
[Step=87450 Epoch=171.0] | Loss=0.00866 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.237 | L2-Norm(final)=21.889 | 4727.2 samples/s | 73.9 steps/s
[Step=87500 Epoch=171.1] | Loss=0.00850 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.240 | L2-Norm(final)=21.892 | 5015.3 samples/s | 78.4 steps/s
[Step=87550 Epoch=171.2] | Loss=0.00837 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.244 | L2-Norm(final)=21.896 | 2109.6 samples/s | 33.0 steps/s
[Step=87600 Epoch=171.3] | Loss=0.00826 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.248 | L2-Norm(final)=21.899 | 4821.4 samples/s | 75.3 steps/s
[Step=87650 Epoch=171.4] | Loss=0.00815 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.251 | L2-Norm(final)=21.903 | 4913.0 samples/s | 76.8 steps/s
[Step=87700 Epoch=171.5] | Loss=0.00804 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.255 | L2-Norm(final)=21.906 | 4788.0 samples/s | 74.8 steps/s
[Step=87750 Epoch=171.5] | Loss=0.00793 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.258 | L2-Norm(final)=21.910 | 4902.6 samples/s | 76.6 steps/s
[Step=87800 Epoch=171.6] | Loss=0.00782 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.261 | L2-Norm(final)=21.913 | 4941.6 samples/s | 77.2 steps/s
[Step=87850 Epoch=171.7] | Loss=0.00774 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.265 | L2-Norm(final)=21.916 | 4866.8 samples/s | 76.0 steps/s
[Step=87900 Epoch=171.8] | Loss=0.00775 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.268 | L2-Norm(final)=21.920 | 4931.9 samples/s | 77.1 steps/s
[Step=87950 Epoch=171.9] | Loss=0.00765 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.271 | L2-Norm(final)=21.923 | 4951.4 samples/s | 77.4 steps/s
[Step=88000 Epoch=172.0] | Loss=0.00757 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.274 | L2-Norm(final)=21.926 | 4772.9 samples/s | 74.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step88000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=86001 Epoch=329.5] | Loss=0.00000 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.117 | L2-Norm(final)=19.371 | 4315.9 samples/s | 67.4 steps/s
[Step=86050 Epoch=329.7] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.110 | L2-Norm(final)=19.375 | 4914.2 samples/s | 76.8 steps/s
[Step=86100 Epoch=329.9] | Loss=0.00002 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.109 | L2-Norm(final)=19.380 | 5324.6 samples/s | 83.2 steps/s
[Step=86150 Epoch=330.1] | Loss=0.00002 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.109 | L2-Norm(final)=19.387 | 5253.3 samples/s | 82.1 steps/s
[Step=86200 Epoch=330.3] | Loss=0.00002 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.109 | L2-Norm(final)=19.395 | 5228.8 samples/s | 81.7 steps/s
[Step=86250 Epoch=330.5] | Loss=0.00002 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.109 | L2-Norm(final)=19.404 | 6683.2 samples/s | 104.4 steps/s
[Step=86300 Epoch=330.7] | Loss=0.00002 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.109 | L2-Norm(final)=19.414 | 2102.8 samples/s | 32.9 steps/s
[Step=86350 Epoch=330.9] | Loss=0.00002 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.109 | L2-Norm(final)=19.422 | 5282.1 samples/s | 82.5 steps/s
[Step=86400 Epoch=331.1] | Loss=0.00002 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.109 | L2-Norm(final)=19.429 | 5321.6 samples/s | 83.1 steps/s
[Step=86450 Epoch=331.2] | Loss=0.00002 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.109 | L2-Norm(final)=19.437 | 5234.2 samples/s | 81.8 steps/s
[Step=86500 Epoch=331.4] | Loss=0.00002 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.109 | L2-Norm(final)=19.443 | 5945.5 samples/s | 92.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=86501 Epoch=331.4] | Loss=0.00000 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.108 | L2-Norm(final)=19.510 | 4579.3 samples/s | 71.6 steps/s
[Step=86550 Epoch=331.6] | Loss=0.00002 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.088 | L2-Norm(final)=19.514 | 4099.8 samples/s | 64.1 steps/s
[Step=86600 Epoch=331.8] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.070 | L2-Norm(final)=19.516 | 4513.8 samples/s | 70.5 steps/s
[Step=86650 Epoch=332.0] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.051 | L2-Norm(final)=19.517 | 4535.9 samples/s | 70.9 steps/s
[Step=86700 Epoch=332.2] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.030 | L2-Norm(final)=19.518 | 4563.6 samples/s | 71.3 steps/s
[Step=86750 Epoch=332.4] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.010 | L2-Norm(final)=19.519 | 5586.3 samples/s | 87.3 steps/s
[Step=86800 Epoch=332.6] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.989 | L2-Norm(final)=19.520 | 1954.7 samples/s | 30.5 steps/s
[Step=86850 Epoch=332.8] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.968 | L2-Norm(final)=19.521 | 4621.5 samples/s | 72.2 steps/s
[Step=86900 Epoch=333.0] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.946 | L2-Norm(final)=19.522 | 4618.1 samples/s | 72.2 steps/s
[Step=86950 Epoch=333.2] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.925 | L2-Norm(final)=19.522 | 4580.4 samples/s | 71.6 steps/s
[Step=87000 Epoch=333.4] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.904 | L2-Norm(final)=19.523 | 5145.9 samples/s | 80.4 steps/s
[Step=87050 Epoch=333.5] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.882 | L2-Norm(final)=19.523 | 2050.2 samples/s | 32.0 steps/s
[Step=87100 Epoch=333.7] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.861 | L2-Norm(final)=19.524 | 4681.0 samples/s | 73.1 steps/s
[Step=87150 Epoch=333.9] | Loss=0.00000 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.839 | L2-Norm(final)=19.525 | 4643.0 samples/s | 72.5 steps/s
[Step=87200 Epoch=334.1] | Loss=0.00000 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.818 | L2-Norm(final)=19.525 | 4539.1 samples/s | 70.9 steps/s
[Step=87250 Epoch=334.3] | Loss=0.00000 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.796 | L2-Norm(final)=19.526 | 4598.7 samples/s | 71.9 steps/s
[Step=87300 Epoch=334.5] | Loss=0.00000 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.774 | L2-Norm(final)=19.527 | 2105.9 samples/s | 32.9 steps/s
[Step=87350 Epoch=334.7] | Loss=0.00000 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.753 | L2-Norm(final)=19.528 | 4688.5 samples/s | 73.3 steps/s
[Step=87400 Epoch=334.9] | Loss=0.00000 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.731 | L2-Norm(final)=19.528 | 4550.9 samples/s | 71.1 steps/s
[Step=87450 Epoch=335.1] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.709 | L2-Norm(final)=19.529 | 4649.1 samples/s | 72.6 steps/s
[Step=87500 Epoch=335.3] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.687 | L2-Norm(final)=19.530 | 4620.0 samples/s | 72.2 steps/s
[Step=87550 Epoch=335.5] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.665 | L2-Norm(final)=19.531 | 2134.5 samples/s | 33.4 steps/s
[Step=87600 Epoch=335.7] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.643 | L2-Norm(final)=19.531 | 4476.5 samples/s | 69.9 steps/s
[Step=87650 Epoch=335.8] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.620 | L2-Norm(final)=19.532 | 4501.3 samples/s | 70.3 steps/s
[Step=87700 Epoch=336.0] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.598 | L2-Norm(final)=19.533 | 4488.7 samples/s | 70.1 steps/s
[Step=87750 Epoch=336.2] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.576 | L2-Norm(final)=19.534 | 4527.8 samples/s | 70.7 steps/s
[Step=87800 Epoch=336.4] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.553 | L2-Norm(final)=19.535 | 6115.7 samples/s | 95.6 steps/s
[Step=87850 Epoch=336.6] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.531 | L2-Norm(final)=19.536 | 1870.8 samples/s | 29.2 steps/s
[Step=87900 Epoch=336.8] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.509 | L2-Norm(final)=19.537 | 4507.3 samples/s | 70.4 steps/s
[Step=87950 Epoch=337.0] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.486 | L2-Norm(final)=19.538 | 4489.8 samples/s | 70.2 steps/s
[Step=88000 Epoch=337.2] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.464 | L2-Norm(final)=19.539 | 4498.3 samples/s | 70.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step88000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=86001 Epoch=331.1] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.117 | L2-Norm(final)=19.070 | 4144.0 samples/s | 64.8 steps/s
[Step=86050 Epoch=331.2] | Loss=0.00007 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.114 | L2-Norm(final)=19.074 | 5103.1 samples/s | 79.7 steps/s
[Step=86100 Epoch=331.4] | Loss=0.00008 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.114 | L2-Norm(final)=19.079 | 5025.5 samples/s | 78.5 steps/s
[Step=86150 Epoch=331.6] | Loss=0.00008 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.114 | L2-Norm(final)=19.085 | 5121.5 samples/s | 80.0 steps/s
[Step=86200 Epoch=331.8] | Loss=0.00007 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.114 | L2-Norm(final)=19.090 | 5149.4 samples/s | 80.5 steps/s
[Step=86250 Epoch=332.0] | Loss=0.00007 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.114 | L2-Norm(final)=19.095 | 6891.0 samples/s | 107.7 steps/s
[Step=86300 Epoch=332.2] | Loss=0.00007 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.114 | L2-Norm(final)=19.100 | 2023.5 samples/s | 31.6 steps/s
[Step=86350 Epoch=332.4] | Loss=0.00007 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.114 | L2-Norm(final)=19.105 | 5268.6 samples/s | 82.3 steps/s
[Step=86400 Epoch=332.6] | Loss=0.00006 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.114 | L2-Norm(final)=19.110 | 5139.1 samples/s | 80.3 steps/s
[Step=86450 Epoch=332.8] | Loss=0.00006 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.114 | L2-Norm(final)=19.115 | 5118.2 samples/s | 80.0 steps/s
[Step=86500 Epoch=333.0] | Loss=0.00006 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.114 | L2-Norm(final)=19.119 | 5971.5 samples/s | 93.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=86501 Epoch=333.0] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.113 | L2-Norm(final)=19.160 | 4329.2 samples/s | 67.6 steps/s
[Step=86550 Epoch=333.2] | Loss=0.00003 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.110 | L2-Norm(final)=19.163 | 4240.0 samples/s | 66.2 steps/s
[Step=86600 Epoch=333.4] | Loss=0.00005 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.108 | L2-Norm(final)=19.166 | 4533.0 samples/s | 70.8 steps/s
[Step=86650 Epoch=333.5] | Loss=0.00004 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.108 | L2-Norm(final)=19.168 | 4408.5 samples/s | 68.9 steps/s
[Step=86700 Epoch=333.7] | Loss=0.00003 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.106 | L2-Norm(final)=19.169 | 4540.5 samples/s | 70.9 steps/s
[Step=86750 Epoch=333.9] | Loss=0.00003 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.104 | L2-Norm(final)=19.171 | 5851.1 samples/s | 91.4 steps/s
[Step=86800 Epoch=334.1] | Loss=0.00002 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.100 | L2-Norm(final)=19.172 | 1955.0 samples/s | 30.5 steps/s
[Step=86850 Epoch=334.3] | Loss=0.00002 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.097 | L2-Norm(final)=19.173 | 4519.0 samples/s | 70.6 steps/s
[Step=86900 Epoch=334.5] | Loss=0.00002 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.093 | L2-Norm(final)=19.173 | 4495.8 samples/s | 70.2 steps/s
[Step=86950 Epoch=334.7] | Loss=0.00002 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.088 | L2-Norm(final)=19.174 | 4570.0 samples/s | 71.4 steps/s
[Step=87000 Epoch=334.9] | Loss=0.00002 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.084 | L2-Norm(final)=19.175 | 5131.9 samples/s | 80.2 steps/s
[Step=87050 Epoch=335.1] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.079 | L2-Norm(final)=19.175 | 2021.0 samples/s | 31.6 steps/s
[Step=87100 Epoch=335.3] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.075 | L2-Norm(final)=19.176 | 4577.1 samples/s | 71.5 steps/s
[Step=87150 Epoch=335.5] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.070 | L2-Norm(final)=19.176 | 4537.5 samples/s | 70.9 steps/s
[Step=87200 Epoch=335.7] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.065 | L2-Norm(final)=19.177 | 4554.4 samples/s | 71.2 steps/s
[Step=87250 Epoch=335.9] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.060 | L2-Norm(final)=19.177 | 4551.9 samples/s | 71.1 steps/s
[Step=87300 Epoch=336.1] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.056 | L2-Norm(final)=19.178 | 2116.7 samples/s | 33.1 steps/s
[Step=87350 Epoch=336.2] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.051 | L2-Norm(final)=19.178 | 4508.8 samples/s | 70.4 steps/s
[Step=87400 Epoch=336.4] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.045 | L2-Norm(final)=19.178 | 4472.9 samples/s | 69.9 steps/s
[Step=87450 Epoch=336.6] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.040 | L2-Norm(final)=19.179 | 4533.4 samples/s | 70.8 steps/s
[Step=87500 Epoch=336.8] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.035 | L2-Norm(final)=19.179 | 4442.7 samples/s | 69.4 steps/s
[Step=87550 Epoch=337.0] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.030 | L2-Norm(final)=19.180 | 2155.2 samples/s | 33.7 steps/s
[Step=87600 Epoch=337.2] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.024 | L2-Norm(final)=19.180 | 4453.0 samples/s | 69.6 steps/s
[Step=87650 Epoch=337.4] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.019 | L2-Norm(final)=19.180 | 4635.2 samples/s | 72.4 steps/s
[Step=87700 Epoch=337.6] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.013 | L2-Norm(final)=19.181 | 4433.9 samples/s | 69.3 steps/s
[Step=87750 Epoch=337.8] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.008 | L2-Norm(final)=19.181 | 4531.8 samples/s | 70.8 steps/s
[Step=87800 Epoch=338.0] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.002 | L2-Norm(final)=19.181 | 6540.6 samples/s | 102.2 steps/s
[Step=87850 Epoch=338.2] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.996 | L2-Norm(final)=19.182 | 1853.6 samples/s | 29.0 steps/s
[Step=87900 Epoch=338.4] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.991 | L2-Norm(final)=19.182 | 4432.9 samples/s | 69.3 steps/s
[Step=87950 Epoch=338.6] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.985 | L2-Norm(final)=19.183 | 4584.8 samples/s | 71.6 steps/s
[Step=88000 Epoch=338.7] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.979 | L2-Norm(final)=19.183 | 4569.8 samples/s | 71.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step88000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06003 | acc=0.9709 | tpr=0.9805 | fpr=0.0500 | 4433.7 samples/s | 17.3 steps/s
Avg test loss: 0.05991, Avg test acc: 0.97087, Avg tpr: 0.98007, Avg fpr: 0.04935, total FA: 385

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06038 | acc=0.9724 | tpr=0.9816 | fpr=0.0476 | 4463.0 samples/s | 17.4 steps/s
Avg test loss: 0.06025, Avg test acc: 0.97183, Avg tpr: 0.98193, Avg fpr: 0.05038, total FA: 393

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.57614 | acc=0.3140 | tpr=0.0038 | fpr=0.0124 | 4441.9 samples/s | 17.4 steps/s
Avg test loss: 5.59822, Avg test acc: 0.31184, Avg tpr: 0.00455, Avg fpr: 0.01231, total FA: 96

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.49877 | acc=0.3133 | tpr=0.0071 | fpr=0.0218 | 4471.6 samples/s | 17.5 steps/s
Avg test loss: 5.51427, Avg test acc: 0.31108, Avg tpr: 0.00752, Avg fpr: 0.02128, total FA: 166

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.08992 | acc=0.1248 | tpr=0.6947 | fpr=0.8855 | 4498.2 samples/s | 17.6 steps/s
[Step= 100] | Loss=5.07587 | acc=0.1240 | tpr=0.7036 | fpr=0.8868 | 8170.7 samples/s | 31.9 steps/s
[Step= 150] | Loss=5.08291 | acc=0.1234 | tpr=0.7046 | fpr=0.8873 | 8610.8 samples/s | 33.6 steps/s
[Step= 200] | Loss=5.08523 | acc=0.1227 | tpr=0.6885 | fpr=0.8876 | 8608.2 samples/s | 33.6 steps/s
[Step= 250] | Loss=5.09458 | acc=0.1223 | tpr=0.6900 | fpr=0.8880 | 8592.1 samples/s | 33.6 steps/s
[Step= 300] | Loss=5.09236 | acc=0.1222 | tpr=0.6895 | fpr=0.8881 | 8098.9 samples/s | 31.6 steps/s
[Step= 350] | Loss=5.09219 | acc=0.1217 | tpr=0.6888 | fpr=0.8886 | 8435.5 samples/s | 33.0 steps/s
[Step= 400] | Loss=5.09745 | acc=0.1215 | tpr=0.6854 | fpr=0.8887 | 8243.0 samples/s | 32.2 steps/s
[Step= 450] | Loss=5.10083 | acc=0.1216 | tpr=0.6874 | fpr=0.8887 | 8636.8 samples/s | 33.7 steps/s
[Step= 500] | Loss=5.10082 | acc=0.1214 | tpr=0.6930 | fpr=0.8890 | 8098.3 samples/s | 31.6 steps/s
[Step= 550] | Loss=5.10507 | acc=0.1213 | tpr=0.6896 | fpr=0.8890 | 15369.0 samples/s | 60.0 steps/s
Avg test loss: 5.10474, Avg test acc: 0.12123, Avg tpr: 0.69017, Avg fpr: 0.88911, total FA: 123451

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.23883 | acc=0.1285 | tpr=0.7035 | fpr=0.8818 | 4402.7 samples/s | 17.2 steps/s
[Step= 100] | Loss=5.22191 | acc=0.1269 | tpr=0.7100 | fpr=0.8840 | 8452.0 samples/s | 33.0 steps/s
[Step= 150] | Loss=5.22458 | acc=0.1257 | tpr=0.7089 | fpr=0.8850 | 8560.8 samples/s | 33.4 steps/s
[Step= 200] | Loss=5.22557 | acc=0.1252 | tpr=0.6907 | fpr=0.8851 | 8101.4 samples/s | 31.6 steps/s
[Step= 250] | Loss=5.23464 | acc=0.1249 | tpr=0.6952 | fpr=0.8855 | 9013.8 samples/s | 35.2 steps/s
[Step= 300] | Loss=5.23354 | acc=0.1247 | tpr=0.6909 | fpr=0.8856 | 8035.1 samples/s | 31.4 steps/s
[Step= 350] | Loss=5.23201 | acc=0.1239 | tpr=0.6875 | fpr=0.8863 | 8634.6 samples/s | 33.7 steps/s
[Step= 400] | Loss=5.23728 | acc=0.1240 | tpr=0.6844 | fpr=0.8862 | 8412.5 samples/s | 32.9 steps/s
[Step= 450] | Loss=5.24009 | acc=0.1239 | tpr=0.6855 | fpr=0.8863 | 8321.9 samples/s | 32.5 steps/s
[Step= 500] | Loss=5.23904 | acc=0.1237 | tpr=0.6899 | fpr=0.8865 | 8278.5 samples/s | 32.3 steps/s
[Step= 550] | Loss=5.24309 | acc=0.1237 | tpr=0.6876 | fpr=0.8866 | 15457.5 samples/s | 60.4 steps/s
Avg test loss: 5.24302, Avg test acc: 0.12355, Avg tpr: 0.68819, Avg fpr: 0.88671, total FA: 123118

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10450 | acc=0.9817 | tpr=0.9425 | fpr=0.0176 | 4429.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.10976 | acc=0.9815 | tpr=0.9510 | fpr=0.0179 | 8469.0 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.11303 | acc=0.9808 | tpr=0.9539 | fpr=0.0187 | 8413.2 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.11462 | acc=0.9808 | tpr=0.9563 | fpr=0.0188 | 8606.6 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.11307 | acc=0.9810 | tpr=0.9555 | fpr=0.0186 | 8084.2 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.11476 | acc=0.9809 | tpr=0.9564 | fpr=0.0186 | 8465.9 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.11596 | acc=0.9808 | tpr=0.9568 | fpr=0.0188 | 8393.2 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.11700 | acc=0.9806 | tpr=0.9546 | fpr=0.0189 | 8528.4 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.11931 | acc=0.9804 | tpr=0.9533 | fpr=0.0191 | 8645.9 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.11879 | acc=0.9805 | tpr=0.9537 | fpr=0.0190 | 8220.2 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.11786 | acc=0.9806 | tpr=0.9530 | fpr=0.0189 | 14980.8 samples/s | 58.5 steps/s
Avg test loss: 0.11755, Avg test acc: 0.98065, Avg tpr: 0.95325, Avg fpr: 0.01886, total FA: 2618

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11487 | acc=0.9816 | tpr=0.9425 | fpr=0.0177 | 4567.3 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.12066 | acc=0.9815 | tpr=0.9595 | fpr=0.0181 | 8122.4 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.12530 | acc=0.9809 | tpr=0.9669 | fpr=0.0189 | 8626.4 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.12572 | acc=0.9810 | tpr=0.9683 | fpr=0.0187 | 8422.8 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.12479 | acc=0.9812 | tpr=0.9668 | fpr=0.0185 | 8466.6 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.12615 | acc=0.9812 | tpr=0.9687 | fpr=0.0186 | 8275.1 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.12740 | acc=0.9809 | tpr=0.9681 | fpr=0.0188 | 8695.7 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.12898 | acc=0.9808 | tpr=0.9666 | fpr=0.0189 | 8384.6 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.13149 | acc=0.9806 | tpr=0.9649 | fpr=0.0191 | 8163.5 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.13106 | acc=0.9806 | tpr=0.9652 | fpr=0.0191 | 8240.7 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.12995 | acc=0.9807 | tpr=0.9630 | fpr=0.0189 | 15614.6 samples/s | 61.0 steps/s
Avg test loss: 0.12962, Avg test acc: 0.98077, Avg tpr: 0.96315, Avg fpr: 0.01891, total FA: 2625

server round 44/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=88001 Epoch=171.6] | Loss=0.00565 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.778 | L2-Norm(final)=21.023 | 3746.4 samples/s | 58.5 steps/s
[Step=88050 Epoch=171.7] | Loss=0.02065 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.779 | L2-Norm(final)=21.027 | 5597.4 samples/s | 87.5 steps/s
[Step=88100 Epoch=171.8] | Loss=0.02139 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.779 | L2-Norm(final)=21.030 | 5424.1 samples/s | 84.8 steps/s
[Step=88150 Epoch=171.9] | Loss=0.02177 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.779 | L2-Norm(final)=21.032 | 5373.7 samples/s | 84.0 steps/s
[Step=88200 Epoch=172.0] | Loss=0.02104 | Reg=0.00061 | acc=0.9688 | L2-Norm=7.779 | L2-Norm(final)=21.033 | 5533.6 samples/s | 86.5 steps/s
[Step=88250 Epoch=172.1] | Loss=0.02072 | Reg=0.00061 | acc=0.9688 | L2-Norm=7.779 | L2-Norm(final)=21.035 | 5493.8 samples/s | 85.8 steps/s
[Step=88300 Epoch=172.2] | Loss=0.02053 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.779 | L2-Norm(final)=21.037 | 5416.3 samples/s | 84.6 steps/s
[Step=88350 Epoch=172.3] | Loss=0.02003 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.779 | L2-Norm(final)=21.039 | 5501.8 samples/s | 86.0 steps/s
[Step=88400 Epoch=172.4] | Loss=0.01996 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.779 | L2-Norm(final)=21.042 | 5441.6 samples/s | 85.0 steps/s
[Step=88450 Epoch=172.5] | Loss=0.01963 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.779 | L2-Norm(final)=21.044 | 5435.5 samples/s | 84.9 steps/s
[Step=88500 Epoch=172.6] | Loss=0.01964 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.779 | L2-Norm(final)=21.047 | 7135.4 samples/s | 111.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=88501 Epoch=172.6] | Loss=0.01690 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.779 | L2-Norm(final)=21.075 | 4347.6 samples/s | 67.9 steps/s
[Step=88550 Epoch=172.7] | Loss=0.01660 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.788 | L2-Norm(final)=21.079 | 4248.3 samples/s | 66.4 steps/s
[Step=88600 Epoch=172.8] | Loss=0.01561 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.799 | L2-Norm(final)=21.084 | 4726.3 samples/s | 73.8 steps/s
[Step=88650 Epoch=172.9] | Loss=0.01516 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.810 | L2-Norm(final)=21.088 | 4799.7 samples/s | 75.0 steps/s
[Step=88700 Epoch=173.0] | Loss=0.01423 | Reg=0.00061 | acc=0.9688 | L2-Norm=7.819 | L2-Norm(final)=21.093 | 4677.0 samples/s | 73.1 steps/s
[Step=88750 Epoch=173.1] | Loss=0.01340 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.828 | L2-Norm(final)=21.097 | 4771.1 samples/s | 74.5 steps/s
[Step=88800 Epoch=173.2] | Loss=0.01293 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.836 | L2-Norm(final)=21.101 | 4774.2 samples/s | 74.6 steps/s
[Step=88850 Epoch=173.3] | Loss=0.01303 | Reg=0.00062 | acc=0.9844 | L2-Norm=7.843 | L2-Norm(final)=21.105 | 4744.4 samples/s | 74.1 steps/s
[Step=88900 Epoch=173.4] | Loss=0.01293 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.850 | L2-Norm(final)=21.109 | 4750.5 samples/s | 74.2 steps/s
[Step=88950 Epoch=173.5] | Loss=0.01285 | Reg=0.00062 | acc=0.9844 | L2-Norm=7.857 | L2-Norm(final)=21.113 | 4773.2 samples/s | 74.6 steps/s
[Step=89000 Epoch=173.6] | Loss=0.01274 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.863 | L2-Norm(final)=21.117 | 5766.5 samples/s | 90.1 steps/s
[Step=89050 Epoch=173.7] | Loss=0.01242 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.869 | L2-Norm(final)=21.121 | 1952.5 samples/s | 30.5 steps/s
[Step=89100 Epoch=173.8] | Loss=0.01211 | Reg=0.00062 | acc=0.9844 | L2-Norm=7.875 | L2-Norm(final)=21.124 | 4724.4 samples/s | 73.8 steps/s
[Step=89150 Epoch=173.9] | Loss=0.01175 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.881 | L2-Norm(final)=21.128 | 4765.9 samples/s | 74.5 steps/s
[Step=89200 Epoch=174.0] | Loss=0.01154 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.886 | L2-Norm(final)=21.132 | 4780.6 samples/s | 74.7 steps/s
[Step=89250 Epoch=174.1] | Loss=0.01119 | Reg=0.00062 | acc=0.9844 | L2-Norm=7.891 | L2-Norm(final)=21.135 | 4674.0 samples/s | 73.0 steps/s
[Step=89300 Epoch=174.2] | Loss=0.01095 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.896 | L2-Norm(final)=21.139 | 4736.9 samples/s | 74.0 steps/s
[Step=89350 Epoch=174.3] | Loss=0.01075 | Reg=0.00062 | acc=0.9688 | L2-Norm=7.901 | L2-Norm(final)=21.142 | 4776.9 samples/s | 74.6 steps/s
[Step=89400 Epoch=174.4] | Loss=0.01060 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.906 | L2-Norm(final)=21.146 | 4752.4 samples/s | 74.3 steps/s
[Step=89450 Epoch=174.5] | Loss=0.01042 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.910 | L2-Norm(final)=21.149 | 4722.6 samples/s | 73.8 steps/s
[Step=89500 Epoch=174.6] | Loss=0.01026 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.915 | L2-Norm(final)=21.152 | 5018.6 samples/s | 78.4 steps/s
[Step=89550 Epoch=174.7] | Loss=0.01022 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.919 | L2-Norm(final)=21.155 | 2100.7 samples/s | 32.8 steps/s
[Step=89600 Epoch=174.8] | Loss=0.01003 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.923 | L2-Norm(final)=21.158 | 4824.7 samples/s | 75.4 steps/s
[Step=89650 Epoch=174.9] | Loss=0.00987 | Reg=0.00063 | acc=0.9688 | L2-Norm=7.927 | L2-Norm(final)=21.162 | 4739.0 samples/s | 74.0 steps/s
[Step=89700 Epoch=174.9] | Loss=0.00984 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.931 | L2-Norm(final)=21.165 | 4721.3 samples/s | 73.8 steps/s
[Step=89750 Epoch=175.0] | Loss=0.00970 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.935 | L2-Norm(final)=21.168 | 4784.9 samples/s | 74.8 steps/s
[Step=89800 Epoch=175.1] | Loss=0.00959 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.939 | L2-Norm(final)=21.171 | 4780.1 samples/s | 74.7 steps/s
[Step=89850 Epoch=175.2] | Loss=0.00945 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.943 | L2-Norm(final)=21.174 | 4881.1 samples/s | 76.3 steps/s
[Step=89900 Epoch=175.3] | Loss=0.00940 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.946 | L2-Norm(final)=21.177 | 4736.2 samples/s | 74.0 steps/s
[Step=89950 Epoch=175.4] | Loss=0.00933 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.950 | L2-Norm(final)=21.179 | 4780.2 samples/s | 74.7 steps/s
[Step=90000 Epoch=175.5] | Loss=0.00922 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.954 | L2-Norm(final)=21.182 | 4735.4 samples/s | 74.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step90000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=88001 Epoch=172.0] | Loss=0.01618 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.778 | L2-Norm(final)=22.023 | 4042.7 samples/s | 63.2 steps/s
[Step=88050 Epoch=172.1] | Loss=0.01776 | Reg=0.00061 | acc=0.9688 | L2-Norm=7.779 | L2-Norm(final)=22.033 | 5717.6 samples/s | 89.3 steps/s
[Step=88100 Epoch=172.2] | Loss=0.01814 | Reg=0.00061 | acc=0.9688 | L2-Norm=7.779 | L2-Norm(final)=22.046 | 5402.0 samples/s | 84.4 steps/s
[Step=88150 Epoch=172.3] | Loss=0.01865 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.779 | L2-Norm(final)=22.060 | 5754.7 samples/s | 89.9 steps/s
[Step=88200 Epoch=172.4] | Loss=0.01852 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.779 | L2-Norm(final)=22.072 | 5249.6 samples/s | 82.0 steps/s
[Step=88250 Epoch=172.5] | Loss=0.01888 | Reg=0.00061 | acc=0.9531 | L2-Norm=7.780 | L2-Norm(final)=22.084 | 5493.8 samples/s | 85.8 steps/s
[Step=88300 Epoch=172.6] | Loss=0.01854 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.780 | L2-Norm(final)=22.095 | 5465.8 samples/s | 85.4 steps/s
[Step=88350 Epoch=172.7] | Loss=0.01820 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.780 | L2-Norm(final)=22.106 | 5453.9 samples/s | 85.2 steps/s
[Step=88400 Epoch=172.8] | Loss=0.01801 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.780 | L2-Norm(final)=22.116 | 5488.4 samples/s | 85.8 steps/s
[Step=88450 Epoch=172.9] | Loss=0.01777 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.780 | L2-Norm(final)=22.127 | 5563.6 samples/s | 86.9 steps/s
[Step=88500 Epoch=173.0] | Loss=0.01772 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.780 | L2-Norm(final)=22.136 | 6881.1 samples/s | 107.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=88501 Epoch=173.0] | Loss=0.01127 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.780 | L2-Norm(final)=22.235 | 4174.6 samples/s | 65.2 steps/s
[Step=88550 Epoch=173.1] | Loss=0.02022 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.791 | L2-Norm(final)=22.242 | 4756.5 samples/s | 74.3 steps/s
[Step=88600 Epoch=173.2] | Loss=0.01710 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.805 | L2-Norm(final)=22.248 | 4766.5 samples/s | 74.5 steps/s
[Step=88650 Epoch=173.3] | Loss=0.01539 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.816 | L2-Norm(final)=22.254 | 4740.3 samples/s | 74.1 steps/s
[Step=88700 Epoch=173.4] | Loss=0.01457 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.825 | L2-Norm(final)=22.259 | 4734.0 samples/s | 74.0 steps/s
[Step=88750 Epoch=173.5] | Loss=0.01382 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.834 | L2-Norm(final)=22.264 | 4730.2 samples/s | 73.9 steps/s
[Step=88800 Epoch=173.6] | Loss=0.01335 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.842 | L2-Norm(final)=22.269 | 4820.3 samples/s | 75.3 steps/s
[Step=88850 Epoch=173.7] | Loss=0.01319 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.849 | L2-Norm(final)=22.274 | 4755.2 samples/s | 74.3 steps/s
[Step=88900 Epoch=173.8] | Loss=0.01279 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.856 | L2-Norm(final)=22.278 | 4744.7 samples/s | 74.1 steps/s
[Step=88950 Epoch=173.9] | Loss=0.01259 | Reg=0.00062 | acc=0.9688 | L2-Norm=7.863 | L2-Norm(final)=22.283 | 4795.8 samples/s | 74.9 steps/s
[Step=89000 Epoch=174.0] | Loss=0.01236 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.869 | L2-Norm(final)=22.287 | 5878.4 samples/s | 91.8 steps/s
[Step=89050 Epoch=174.1] | Loss=0.01193 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.875 | L2-Norm(final)=22.291 | 2022.2 samples/s | 31.6 steps/s
[Step=89100 Epoch=174.2] | Loss=0.01164 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.881 | L2-Norm(final)=22.296 | 4753.0 samples/s | 74.3 steps/s
[Step=89150 Epoch=174.3] | Loss=0.01136 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.887 | L2-Norm(final)=22.300 | 4782.3 samples/s | 74.7 steps/s
[Step=89200 Epoch=174.4] | Loss=0.01110 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.892 | L2-Norm(final)=22.304 | 4733.5 samples/s | 74.0 steps/s
[Step=89250 Epoch=174.5] | Loss=0.01082 | Reg=0.00062 | acc=0.9844 | L2-Norm=7.897 | L2-Norm(final)=22.308 | 4774.9 samples/s | 74.6 steps/s
[Step=89300 Epoch=174.6] | Loss=0.01062 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.902 | L2-Norm(final)=22.312 | 4641.7 samples/s | 72.5 steps/s
[Step=89350 Epoch=174.7] | Loss=0.01039 | Reg=0.00063 | acc=0.9688 | L2-Norm=7.907 | L2-Norm(final)=22.316 | 4709.8 samples/s | 73.6 steps/s
[Step=89400 Epoch=174.8] | Loss=0.01023 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.912 | L2-Norm(final)=22.319 | 4791.0 samples/s | 74.9 steps/s
[Step=89450 Epoch=174.9] | Loss=0.01013 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.916 | L2-Norm(final)=22.323 | 4735.1 samples/s | 74.0 steps/s
[Step=89500 Epoch=175.0] | Loss=0.00998 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.921 | L2-Norm(final)=22.327 | 5187.5 samples/s | 81.1 steps/s
[Step=89550 Epoch=175.1] | Loss=0.00984 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.925 | L2-Norm(final)=22.330 | 2107.1 samples/s | 32.9 steps/s
[Step=89600 Epoch=175.2] | Loss=0.00968 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.929 | L2-Norm(final)=22.334 | 4866.9 samples/s | 76.0 steps/s
[Step=89650 Epoch=175.3] | Loss=0.00949 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.934 | L2-Norm(final)=22.338 | 4744.8 samples/s | 74.1 steps/s
[Step=89700 Epoch=175.4] | Loss=0.00934 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.938 | L2-Norm(final)=22.341 | 4796.7 samples/s | 74.9 steps/s
[Step=89750 Epoch=175.5] | Loss=0.00917 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.942 | L2-Norm(final)=22.345 | 4775.1 samples/s | 74.6 steps/s
[Step=89800 Epoch=175.6] | Loss=0.00904 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.945 | L2-Norm(final)=22.348 | 4828.6 samples/s | 75.4 steps/s
[Step=89850 Epoch=175.7] | Loss=0.00893 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.949 | L2-Norm(final)=22.351 | 4835.5 samples/s | 75.6 steps/s
[Step=89900 Epoch=175.8] | Loss=0.00882 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.953 | L2-Norm(final)=22.355 | 4705.6 samples/s | 73.5 steps/s
[Step=89950 Epoch=175.8] | Loss=0.00880 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.956 | L2-Norm(final)=22.358 | 4574.9 samples/s | 71.5 steps/s
[Step=90000 Epoch=175.9] | Loss=0.00871 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.960 | L2-Norm(final)=22.361 | 4693.4 samples/s | 73.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step90000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=88001 Epoch=337.2] | Loss=0.00000 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.778 | L2-Norm(final)=19.576 | 4610.5 samples/s | 72.0 steps/s
[Step=88050 Epoch=337.4] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.772 | L2-Norm(final)=19.579 | 4634.8 samples/s | 72.4 steps/s
[Step=88100 Epoch=337.6] | Loss=0.00002 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.772 | L2-Norm(final)=19.587 | 5138.7 samples/s | 80.3 steps/s
[Step=88150 Epoch=337.8] | Loss=0.00002 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.771 | L2-Norm(final)=19.597 | 5142.8 samples/s | 80.4 steps/s
[Step=88200 Epoch=338.0] | Loss=0.00002 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.771 | L2-Norm(final)=19.606 | 5150.6 samples/s | 80.5 steps/s
[Step=88250 Epoch=338.1] | Loss=0.00002 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.771 | L2-Norm(final)=19.615 | 6749.7 samples/s | 105.5 steps/s
[Step=88300 Epoch=338.3] | Loss=0.00002 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.771 | L2-Norm(final)=19.622 | 2058.3 samples/s | 32.2 steps/s
[Step=88350 Epoch=338.5] | Loss=0.00002 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.771 | L2-Norm(final)=19.628 | 5232.5 samples/s | 81.8 steps/s
[Step=88400 Epoch=338.7] | Loss=0.00002 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.771 | L2-Norm(final)=19.634 | 5171.4 samples/s | 80.8 steps/s
[Step=88450 Epoch=338.9] | Loss=0.00002 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.771 | L2-Norm(final)=19.640 | 5099.5 samples/s | 79.7 steps/s
[Step=88500 Epoch=339.1] | Loss=0.00002 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.771 | L2-Norm(final)=19.645 | 5745.0 samples/s | 89.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=88501 Epoch=339.1] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.771 | L2-Norm(final)=19.703 | 4412.1 samples/s | 68.9 steps/s
[Step=88550 Epoch=339.3] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.756 | L2-Norm(final)=19.707 | 4341.1 samples/s | 67.8 steps/s
[Step=88600 Epoch=339.5] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.731 | L2-Norm(final)=19.709 | 4629.6 samples/s | 72.3 steps/s
[Step=88650 Epoch=339.7] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.705 | L2-Norm(final)=19.710 | 4702.7 samples/s | 73.5 steps/s
[Step=88700 Epoch=339.9] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.679 | L2-Norm(final)=19.711 | 4549.8 samples/s | 71.1 steps/s
[Step=88750 Epoch=340.1] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.652 | L2-Norm(final)=19.712 | 5628.8 samples/s | 88.0 steps/s
[Step=88800 Epoch=340.3] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.625 | L2-Norm(final)=19.712 | 1952.2 samples/s | 30.5 steps/s
[Step=88850 Epoch=340.4] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.598 | L2-Norm(final)=19.713 | 4519.0 samples/s | 70.6 steps/s
[Step=88900 Epoch=340.6] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.571 | L2-Norm(final)=19.713 | 4600.5 samples/s | 71.9 steps/s
[Step=88950 Epoch=340.8] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.544 | L2-Norm(final)=19.714 | 4452.3 samples/s | 69.6 steps/s
[Step=89000 Epoch=341.0] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.517 | L2-Norm(final)=19.715 | 4992.8 samples/s | 78.0 steps/s
[Step=89050 Epoch=341.2] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.491 | L2-Norm(final)=19.715 | 2034.1 samples/s | 31.8 steps/s
[Step=89100 Epoch=341.4] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.464 | L2-Norm(final)=19.716 | 4519.5 samples/s | 70.6 steps/s
[Step=89150 Epoch=341.6] | Loss=0.00000 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.437 | L2-Norm(final)=19.717 | 4441.1 samples/s | 69.4 steps/s
[Step=89200 Epoch=341.8] | Loss=0.00000 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.411 | L2-Norm(final)=19.717 | 4586.8 samples/s | 71.7 steps/s
[Step=89250 Epoch=342.0] | Loss=0.00000 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.384 | L2-Norm(final)=19.718 | 4535.6 samples/s | 70.9 steps/s
[Step=89300 Epoch=342.2] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.358 | L2-Norm(final)=19.719 | 2111.4 samples/s | 33.0 steps/s
[Step=89350 Epoch=342.4] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.331 | L2-Norm(final)=19.719 | 4544.8 samples/s | 71.0 steps/s
[Step=89400 Epoch=342.5] | Loss=0.00000 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.305 | L2-Norm(final)=19.720 | 4534.4 samples/s | 70.9 steps/s
[Step=89450 Epoch=342.7] | Loss=0.00000 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.278 | L2-Norm(final)=19.721 | 4449.5 samples/s | 69.5 steps/s
[Step=89500 Epoch=342.9] | Loss=0.00000 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.251 | L2-Norm(final)=19.722 | 4575.6 samples/s | 71.5 steps/s
[Step=89550 Epoch=343.1] | Loss=0.00000 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.225 | L2-Norm(final)=19.723 | 2140.2 samples/s | 33.4 steps/s
[Step=89600 Epoch=343.3] | Loss=0.00000 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.198 | L2-Norm(final)=19.724 | 4518.2 samples/s | 70.6 steps/s
[Step=89650 Epoch=343.5] | Loss=0.00000 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.172 | L2-Norm(final)=19.725 | 4527.1 samples/s | 70.7 steps/s
[Step=89700 Epoch=343.7] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.145 | L2-Norm(final)=19.726 | 4495.7 samples/s | 70.2 steps/s
[Step=89750 Epoch=343.9] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.119 | L2-Norm(final)=19.727 | 4520.2 samples/s | 70.6 steps/s
[Step=89800 Epoch=344.1] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.092 | L2-Norm(final)=19.728 | 6129.1 samples/s | 95.8 steps/s
[Step=89850 Epoch=344.3] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.066 | L2-Norm(final)=19.729 | 1937.6 samples/s | 30.3 steps/s
[Step=89900 Epoch=344.5] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.039 | L2-Norm(final)=19.730 | 4617.6 samples/s | 72.2 steps/s
[Step=89950 Epoch=344.7] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.013 | L2-Norm(final)=19.731 | 4482.3 samples/s | 70.0 steps/s
[Step=90000 Epoch=344.8] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.987 | L2-Norm(final)=19.732 | 4570.6 samples/s | 71.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step90000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=88001 Epoch=338.8] | Loss=0.00003 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.778 | L2-Norm(final)=19.194 | 4299.8 samples/s | 67.2 steps/s
[Step=88050 Epoch=338.9] | Loss=0.00014 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.776 | L2-Norm(final)=19.197 | 4941.6 samples/s | 77.2 steps/s
[Step=88100 Epoch=339.1] | Loss=0.00012 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.776 | L2-Norm(final)=19.200 | 5080.2 samples/s | 79.4 steps/s
[Step=88150 Epoch=339.3] | Loss=0.00011 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.776 | L2-Norm(final)=19.204 | 5094.6 samples/s | 79.6 steps/s
[Step=88200 Epoch=339.5] | Loss=0.00012 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.776 | L2-Norm(final)=19.208 | 5236.1 samples/s | 81.8 steps/s
[Step=88250 Epoch=339.7] | Loss=0.00011 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.776 | L2-Norm(final)=19.212 | 6719.2 samples/s | 105.0 steps/s
[Step=88300 Epoch=339.9] | Loss=0.00011 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.776 | L2-Norm(final)=19.215 | 2084.3 samples/s | 32.6 steps/s
[Step=88350 Epoch=340.1] | Loss=0.00011 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.776 | L2-Norm(final)=19.218 | 5194.3 samples/s | 81.2 steps/s
[Step=88400 Epoch=340.3] | Loss=0.00011 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.776 | L2-Norm(final)=19.220 | 5317.0 samples/s | 83.1 steps/s
[Step=88450 Epoch=340.5] | Loss=0.00011 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.776 | L2-Norm(final)=19.224 | 5283.2 samples/s | 82.5 steps/s
[Step=88500 Epoch=340.7] | Loss=0.00011 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.776 | L2-Norm(final)=19.227 | 6148.9 samples/s | 96.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=88501 Epoch=340.7] | Loss=0.00060 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.776 | L2-Norm(final)=19.257 | 4708.2 samples/s | 73.6 steps/s
[Step=88550 Epoch=340.9] | Loss=0.00007 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.780 | L2-Norm(final)=19.259 | 4183.4 samples/s | 65.4 steps/s
[Step=88600 Epoch=341.1] | Loss=0.00006 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.781 | L2-Norm(final)=19.262 | 4574.3 samples/s | 71.5 steps/s
[Step=88650 Epoch=341.2] | Loss=0.00004 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.781 | L2-Norm(final)=19.264 | 4502.2 samples/s | 70.3 steps/s
[Step=88700 Epoch=341.4] | Loss=0.00004 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.779 | L2-Norm(final)=19.265 | 4549.8 samples/s | 71.1 steps/s
[Step=88750 Epoch=341.6] | Loss=0.00003 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.777 | L2-Norm(final)=19.266 | 5823.1 samples/s | 91.0 steps/s
[Step=88800 Epoch=341.8] | Loss=0.00003 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.774 | L2-Norm(final)=19.267 | 1967.0 samples/s | 30.7 steps/s
[Step=88850 Epoch=342.0] | Loss=0.00003 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.771 | L2-Norm(final)=19.268 | 4488.1 samples/s | 70.1 steps/s
[Step=88900 Epoch=342.2] | Loss=0.00002 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.767 | L2-Norm(final)=19.269 | 4463.8 samples/s | 69.7 steps/s
[Step=88950 Epoch=342.4] | Loss=0.00002 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.763 | L2-Norm(final)=19.270 | 4498.9 samples/s | 70.3 steps/s
[Step=89000 Epoch=342.6] | Loss=0.00002 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.759 | L2-Norm(final)=19.270 | 5128.3 samples/s | 80.1 steps/s
[Step=89050 Epoch=342.8] | Loss=0.00002 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.755 | L2-Norm(final)=19.271 | 2041.6 samples/s | 31.9 steps/s
[Step=89100 Epoch=343.0] | Loss=0.00002 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.751 | L2-Norm(final)=19.271 | 4485.9 samples/s | 70.1 steps/s
[Step=89150 Epoch=343.2] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.746 | L2-Norm(final)=19.272 | 4522.2 samples/s | 70.7 steps/s
[Step=89200 Epoch=343.4] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.742 | L2-Norm(final)=19.272 | 4489.3 samples/s | 70.1 steps/s
[Step=89250 Epoch=343.6] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.737 | L2-Norm(final)=19.273 | 4644.0 samples/s | 72.6 steps/s
[Step=89300 Epoch=343.8] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.733 | L2-Norm(final)=19.273 | 2128.5 samples/s | 33.3 steps/s
[Step=89350 Epoch=343.9] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.728 | L2-Norm(final)=19.273 | 4581.3 samples/s | 71.6 steps/s
[Step=89400 Epoch=344.1] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.723 | L2-Norm(final)=19.274 | 4622.9 samples/s | 72.2 steps/s
[Step=89450 Epoch=344.3] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.718 | L2-Norm(final)=19.274 | 4426.8 samples/s | 69.2 steps/s
[Step=89500 Epoch=344.5] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.713 | L2-Norm(final)=19.274 | 4501.3 samples/s | 70.3 steps/s
[Step=89550 Epoch=344.7] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.708 | L2-Norm(final)=19.275 | 2165.0 samples/s | 33.8 steps/s
[Step=89600 Epoch=344.9] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.703 | L2-Norm(final)=19.275 | 4610.5 samples/s | 72.0 steps/s
[Step=89650 Epoch=345.1] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.698 | L2-Norm(final)=19.275 | 4571.6 samples/s | 71.4 steps/s
[Step=89700 Epoch=345.3] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.693 | L2-Norm(final)=19.276 | 4654.0 samples/s | 72.7 steps/s
[Step=89750 Epoch=345.5] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.688 | L2-Norm(final)=19.276 | 4661.6 samples/s | 72.8 steps/s
[Step=89800 Epoch=345.7] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.682 | L2-Norm(final)=19.276 | 6679.7 samples/s | 104.4 steps/s
[Step=89850 Epoch=345.9] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.677 | L2-Norm(final)=19.277 | 1885.1 samples/s | 29.5 steps/s
[Step=89900 Epoch=346.1] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.671 | L2-Norm(final)=19.277 | 4508.8 samples/s | 70.4 steps/s
[Step=89950 Epoch=346.3] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.666 | L2-Norm(final)=19.277 | 4522.3 samples/s | 70.7 steps/s
[Step=90000 Epoch=346.4] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.660 | L2-Norm(final)=19.278 | 4506.4 samples/s | 70.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step90000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05838 | acc=0.9705 | tpr=0.9806 | fpr=0.0515 | 4442.4 samples/s | 17.4 steps/s
Avg test loss: 0.05874, Avg test acc: 0.97059, Avg tpr: 0.98053, Avg fpr: 0.05128, total FA: 400

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05837 | acc=0.9712 | tpr=0.9788 | fpr=0.0451 | 4438.5 samples/s | 17.3 steps/s
Avg test loss: 0.05866, Avg test acc: 0.97175, Avg tpr: 0.97978, Avg fpr: 0.04589, total FA: 358

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.54505 | acc=0.3139 | tpr=0.0038 | fpr=0.0126 | 4469.3 samples/s | 17.5 steps/s
Avg test loss: 5.56953, Avg test acc: 0.31160, Avg tpr: 0.00425, Avg fpr: 0.01243, total FA: 97

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.31841 | acc=0.3131 | tpr=0.0059 | fpr=0.0198 | 4365.4 samples/s | 17.1 steps/s
Avg test loss: 5.33379, Avg test acc: 0.31128, Avg tpr: 0.00647, Avg fpr: 0.01833, total FA: 143

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.17342 | acc=0.1215 | tpr=0.7434 | fpr=0.8897 | 4456.0 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.15659 | acc=0.1212 | tpr=0.7356 | fpr=0.8903 | 8654.0 samples/s | 33.8 steps/s
[Step= 150] | Loss=5.16145 | acc=0.1205 | tpr=0.7291 | fpr=0.8907 | 8440.3 samples/s | 33.0 steps/s
[Step= 200] | Loss=5.16472 | acc=0.1201 | tpr=0.7180 | fpr=0.8908 | 8249.1 samples/s | 32.2 steps/s
[Step= 250] | Loss=5.17364 | acc=0.1201 | tpr=0.7214 | fpr=0.8909 | 8488.1 samples/s | 33.2 steps/s
[Step= 300] | Loss=5.17101 | acc=0.1199 | tpr=0.7178 | fpr=0.8910 | 8333.3 samples/s | 32.6 steps/s
[Step= 350] | Loss=5.17072 | acc=0.1192 | tpr=0.7170 | fpr=0.8917 | 8844.2 samples/s | 34.5 steps/s
[Step= 400] | Loss=5.17618 | acc=0.1190 | tpr=0.7123 | fpr=0.8918 | 7980.3 samples/s | 31.2 steps/s
[Step= 450] | Loss=5.18004 | acc=0.1190 | tpr=0.7157 | fpr=0.8918 | 8258.3 samples/s | 32.3 steps/s
[Step= 500] | Loss=5.17995 | acc=0.1188 | tpr=0.7211 | fpr=0.8920 | 8245.2 samples/s | 32.2 steps/s
[Step= 550] | Loss=5.18401 | acc=0.1188 | tpr=0.7195 | fpr=0.8921 | 15641.8 samples/s | 61.1 steps/s
Avg test loss: 5.18390, Avg test acc: 0.11865, Avg tpr: 0.71989, Avg fpr: 0.89228, total FA: 123891

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.03542 | acc=0.1325 | tpr=0.6858 | fpr=0.8774 | 4539.6 samples/s | 17.7 steps/s
[Step= 100] | Loss=5.01844 | acc=0.1314 | tpr=0.6930 | fpr=0.8791 | 8149.0 samples/s | 31.8 steps/s
[Step= 150] | Loss=5.01981 | acc=0.1303 | tpr=0.6902 | fpr=0.8800 | 8532.7 samples/s | 33.3 steps/s
[Step= 200] | Loss=5.02083 | acc=0.1297 | tpr=0.6721 | fpr=0.8802 | 8480.2 samples/s | 33.1 steps/s
[Step= 250] | Loss=5.02967 | acc=0.1296 | tpr=0.6769 | fpr=0.8803 | 8031.5 samples/s | 31.4 steps/s
[Step= 300] | Loss=5.02820 | acc=0.1292 | tpr=0.6720 | fpr=0.8806 | 8436.5 samples/s | 33.0 steps/s
[Step= 350] | Loss=5.02651 | acc=0.1284 | tpr=0.6675 | fpr=0.8814 | 8340.9 samples/s | 32.6 steps/s
[Step= 400] | Loss=5.03197 | acc=0.1285 | tpr=0.6641 | fpr=0.8812 | 8660.7 samples/s | 33.8 steps/s
[Step= 450] | Loss=5.03454 | acc=0.1283 | tpr=0.6665 | fpr=0.8814 | 8171.4 samples/s | 31.9 steps/s
[Step= 500] | Loss=5.03286 | acc=0.1282 | tpr=0.6731 | fpr=0.8817 | 8393.3 samples/s | 32.8 steps/s
[Step= 550] | Loss=5.03655 | acc=0.1281 | tpr=0.6697 | fpr=0.8817 | 14259.5 samples/s | 55.7 steps/s
Avg test loss: 5.03657, Avg test acc: 0.12801, Avg tpr: 0.67036, Avg fpr: 0.88185, total FA: 122443

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09840 | acc=0.9823 | tpr=0.9425 | fpr=0.0169 | 4392.2 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.10265 | acc=0.9819 | tpr=0.9659 | fpr=0.0178 | 8366.2 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.10575 | acc=0.9814 | tpr=0.9654 | fpr=0.0183 | 8595.5 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.10718 | acc=0.9814 | tpr=0.9672 | fpr=0.0184 | 8190.8 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.10587 | acc=0.9815 | tpr=0.9659 | fpr=0.0182 | 8322.1 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.10730 | acc=0.9812 | tpr=0.9651 | fpr=0.0185 | 8664.0 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.10830 | acc=0.9810 | tpr=0.9637 | fpr=0.0186 | 8325.8 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.10927 | acc=0.9810 | tpr=0.9623 | fpr=0.0187 | 8079.6 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.11135 | acc=0.9807 | tpr=0.9606 | fpr=0.0189 | 8376.2 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.11091 | acc=0.9808 | tpr=0.9612 | fpr=0.0189 | 8480.6 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.11003 | acc=0.9809 | tpr=0.9598 | fpr=0.0188 | 14691.6 samples/s | 57.4 steps/s
Avg test loss: 0.10977, Avg test acc: 0.98088, Avg tpr: 0.95998, Avg fpr: 0.01874, total FA: 2602

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10871 | acc=0.9820 | tpr=0.9381 | fpr=0.0173 | 4407.7 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.11395 | acc=0.9818 | tpr=0.9616 | fpr=0.0178 | 8718.1 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.11824 | acc=0.9813 | tpr=0.9654 | fpr=0.0184 | 8231.1 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.11927 | acc=0.9815 | tpr=0.9672 | fpr=0.0183 | 8183.9 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.11841 | acc=0.9816 | tpr=0.9659 | fpr=0.0181 | 8365.3 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.11967 | acc=0.9815 | tpr=0.9680 | fpr=0.0182 | 8310.9 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.12072 | acc=0.9813 | tpr=0.9668 | fpr=0.0185 | 8397.3 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.12227 | acc=0.9812 | tpr=0.9666 | fpr=0.0185 | 8715.5 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.12472 | acc=0.9810 | tpr=0.9649 | fpr=0.0188 | 8227.5 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.12437 | acc=0.9810 | tpr=0.9648 | fpr=0.0188 | 8728.8 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.12339 | acc=0.9810 | tpr=0.9626 | fpr=0.0187 | 14471.4 samples/s | 56.5 steps/s
Avg test loss: 0.12309, Avg test acc: 0.98101, Avg tpr: 0.96236, Avg fpr: 0.01865, total FA: 2590

server round 45/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=90001 Epoch=175.5] | Loss=0.01665 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.393 | L2-Norm(final)=21.268 | 4101.3 samples/s | 64.1 steps/s
[Step=90050 Epoch=175.6] | Loss=0.02619 | Reg=0.00055 | acc=0.9688 | L2-Norm=7.394 | L2-Norm(final)=21.277 | 5376.4 samples/s | 84.0 steps/s
[Step=90100 Epoch=175.7] | Loss=0.02618 | Reg=0.00055 | acc=0.9844 | L2-Norm=7.394 | L2-Norm(final)=21.287 | 5468.0 samples/s | 85.4 steps/s
[Step=90150 Epoch=175.8] | Loss=0.02677 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.394 | L2-Norm(final)=21.296 | 5313.6 samples/s | 83.0 steps/s
[Step=90200 Epoch=175.9] | Loss=0.02623 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.394 | L2-Norm(final)=21.304 | 5464.6 samples/s | 85.4 steps/s
[Step=90250 Epoch=176.0] | Loss=0.02578 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.394 | L2-Norm(final)=21.312 | 5467.0 samples/s | 85.4 steps/s
[Step=90300 Epoch=176.1] | Loss=0.02513 | Reg=0.00055 | acc=0.9688 | L2-Norm=7.394 | L2-Norm(final)=21.320 | 5575.0 samples/s | 87.1 steps/s
[Step=90350 Epoch=176.2] | Loss=0.02484 | Reg=0.00055 | acc=0.9844 | L2-Norm=7.394 | L2-Norm(final)=21.327 | 5363.5 samples/s | 83.8 steps/s
[Step=90400 Epoch=176.3] | Loss=0.02452 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.394 | L2-Norm(final)=21.335 | 5537.3 samples/s | 86.5 steps/s
[Step=90450 Epoch=176.4] | Loss=0.02448 | Reg=0.00055 | acc=0.9688 | L2-Norm=7.394 | L2-Norm(final)=21.342 | 5417.5 samples/s | 84.6 steps/s
[Step=90500 Epoch=176.5] | Loss=0.02413 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.394 | L2-Norm(final)=21.349 | 6933.4 samples/s | 108.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=90501 Epoch=176.5] | Loss=0.00978 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.394 | L2-Norm(final)=21.420 | 4107.6 samples/s | 64.2 steps/s
[Step=90550 Epoch=176.6] | Loss=0.01859 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.406 | L2-Norm(final)=21.426 | 4807.6 samples/s | 75.1 steps/s
[Step=90600 Epoch=176.7] | Loss=0.01975 | Reg=0.00055 | acc=0.9688 | L2-Norm=7.420 | L2-Norm(final)=21.430 | 4859.9 samples/s | 75.9 steps/s
[Step=90650 Epoch=176.8] | Loss=0.01943 | Reg=0.00055 | acc=0.9844 | L2-Norm=7.432 | L2-Norm(final)=21.435 | 4895.0 samples/s | 76.5 steps/s
[Step=90700 Epoch=176.9] | Loss=0.01847 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.444 | L2-Norm(final)=21.439 | 4856.5 samples/s | 75.9 steps/s
[Step=90750 Epoch=177.0] | Loss=0.01787 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.455 | L2-Norm(final)=21.444 | 4766.4 samples/s | 74.5 steps/s
[Step=90800 Epoch=177.1] | Loss=0.01711 | Reg=0.00056 | acc=0.9844 | L2-Norm=7.465 | L2-Norm(final)=21.448 | 4831.8 samples/s | 75.5 steps/s
[Step=90850 Epoch=177.2] | Loss=0.01675 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.474 | L2-Norm(final)=21.452 | 4754.9 samples/s | 74.3 steps/s
[Step=90900 Epoch=177.3] | Loss=0.01634 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.482 | L2-Norm(final)=21.456 | 4765.6 samples/s | 74.5 steps/s
[Step=90950 Epoch=177.4] | Loss=0.01582 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.491 | L2-Norm(final)=21.460 | 4831.6 samples/s | 75.5 steps/s
[Step=91000 Epoch=177.5] | Loss=0.01541 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.498 | L2-Norm(final)=21.464 | 5710.7 samples/s | 89.2 steps/s
[Step=91050 Epoch=177.6] | Loss=0.01493 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.506 | L2-Norm(final)=21.468 | 1926.1 samples/s | 30.1 steps/s
[Step=91100 Epoch=177.7] | Loss=0.01439 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.513 | L2-Norm(final)=21.472 | 4747.4 samples/s | 74.2 steps/s
[Step=91150 Epoch=177.8] | Loss=0.01395 | Reg=0.00057 | acc=0.9844 | L2-Norm=7.519 | L2-Norm(final)=21.476 | 4793.9 samples/s | 74.9 steps/s
[Step=91200 Epoch=177.9] | Loss=0.01362 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.526 | L2-Norm(final)=21.479 | 4792.6 samples/s | 74.9 steps/s
[Step=91250 Epoch=178.0] | Loss=0.01337 | Reg=0.00057 | acc=0.9844 | L2-Norm=7.532 | L2-Norm(final)=21.483 | 4749.3 samples/s | 74.2 steps/s
[Step=91300 Epoch=178.1] | Loss=0.01305 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.537 | L2-Norm(final)=21.486 | 4747.7 samples/s | 74.2 steps/s
[Step=91350 Epoch=178.2] | Loss=0.01288 | Reg=0.00057 | acc=0.9844 | L2-Norm=7.543 | L2-Norm(final)=21.490 | 4824.9 samples/s | 75.4 steps/s
[Step=91400 Epoch=178.3] | Loss=0.01256 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.548 | L2-Norm(final)=21.493 | 4801.4 samples/s | 75.0 steps/s
[Step=91450 Epoch=178.4] | Loss=0.01239 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.554 | L2-Norm(final)=21.496 | 4778.9 samples/s | 74.7 steps/s
[Step=91500 Epoch=178.5] | Loss=0.01235 | Reg=0.00057 | acc=0.9844 | L2-Norm=7.559 | L2-Norm(final)=21.499 | 5085.9 samples/s | 79.5 steps/s
[Step=91550 Epoch=178.6] | Loss=0.01224 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.564 | L2-Norm(final)=21.503 | 2100.5 samples/s | 32.8 steps/s
[Step=91600 Epoch=178.7] | Loss=0.01202 | Reg=0.00057 | acc=0.9844 | L2-Norm=7.569 | L2-Norm(final)=21.506 | 4767.0 samples/s | 74.5 steps/s
[Step=91650 Epoch=178.8] | Loss=0.01182 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.574 | L2-Norm(final)=21.509 | 4655.9 samples/s | 72.7 steps/s
[Step=91700 Epoch=178.9] | Loss=0.01165 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.578 | L2-Norm(final)=21.512 | 4709.7 samples/s | 73.6 steps/s
[Step=91750 Epoch=178.9] | Loss=0.01145 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.583 | L2-Norm(final)=21.515 | 4755.1 samples/s | 74.3 steps/s
[Step=91800 Epoch=179.0] | Loss=0.01124 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.587 | L2-Norm(final)=21.518 | 4715.5 samples/s | 73.7 steps/s
[Step=91850 Epoch=179.1] | Loss=0.01115 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.592 | L2-Norm(final)=21.521 | 4796.1 samples/s | 74.9 steps/s
[Step=91900 Epoch=179.2] | Loss=0.01109 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.596 | L2-Norm(final)=21.524 | 4731.0 samples/s | 73.9 steps/s
[Step=91950 Epoch=179.3] | Loss=0.01097 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.600 | L2-Norm(final)=21.527 | 4823.0 samples/s | 75.4 steps/s
[Step=92000 Epoch=179.4] | Loss=0.01081 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.604 | L2-Norm(final)=21.529 | 4773.8 samples/s | 74.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step92000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=90001 Epoch=175.9] | Loss=0.02185 | Reg=0.00055 | acc=0.9844 | L2-Norm=7.393 | L2-Norm(final)=22.458 | 4439.2 samples/s | 69.4 steps/s
[Step=90050 Epoch=176.0] | Loss=0.02528 | Reg=0.00055 | acc=0.9844 | L2-Norm=7.394 | L2-Norm(final)=22.458 | 5427.4 samples/s | 84.8 steps/s
[Step=90100 Epoch=176.1] | Loss=0.02390 | Reg=0.00055 | acc=0.9531 | L2-Norm=7.394 | L2-Norm(final)=22.457 | 5288.9 samples/s | 82.6 steps/s
[Step=90150 Epoch=176.2] | Loss=0.02400 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.394 | L2-Norm(final)=22.457 | 5395.3 samples/s | 84.3 steps/s
[Step=90200 Epoch=176.3] | Loss=0.02403 | Reg=0.00055 | acc=0.9688 | L2-Norm=7.394 | L2-Norm(final)=22.458 | 5492.5 samples/s | 85.8 steps/s
[Step=90250 Epoch=176.4] | Loss=0.02390 | Reg=0.00055 | acc=0.9531 | L2-Norm=7.394 | L2-Norm(final)=22.459 | 5437.4 samples/s | 85.0 steps/s
[Step=90300 Epoch=176.5] | Loss=0.02349 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.394 | L2-Norm(final)=22.460 | 5481.0 samples/s | 85.6 steps/s
[Step=90350 Epoch=176.6] | Loss=0.02367 | Reg=0.00055 | acc=0.9688 | L2-Norm=7.394 | L2-Norm(final)=22.461 | 5585.8 samples/s | 87.3 steps/s
[Step=90400 Epoch=176.7] | Loss=0.02366 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.394 | L2-Norm(final)=22.462 | 5391.5 samples/s | 84.2 steps/s
[Step=90450 Epoch=176.8] | Loss=0.02371 | Reg=0.00055 | acc=0.9844 | L2-Norm=7.394 | L2-Norm(final)=22.464 | 5455.6 samples/s | 85.2 steps/s
[Step=90500 Epoch=176.9] | Loss=0.02351 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.394 | L2-Norm(final)=22.465 | 6968.3 samples/s | 108.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=90501 Epoch=176.9] | Loss=0.01889 | Reg=0.00055 | acc=0.9844 | L2-Norm=7.394 | L2-Norm(final)=22.485 | 4119.1 samples/s | 64.4 steps/s
[Step=90550 Epoch=177.0] | Loss=0.01989 | Reg=0.00055 | acc=0.9688 | L2-Norm=7.410 | L2-Norm(final)=22.491 | 4844.3 samples/s | 75.7 steps/s
[Step=90600 Epoch=177.1] | Loss=0.01890 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.424 | L2-Norm(final)=22.496 | 4797.9 samples/s | 75.0 steps/s
[Step=90650 Epoch=177.2] | Loss=0.01855 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.437 | L2-Norm(final)=22.501 | 4715.0 samples/s | 73.7 steps/s
[Step=90700 Epoch=177.3] | Loss=0.01757 | Reg=0.00055 | acc=0.9844 | L2-Norm=7.448 | L2-Norm(final)=22.506 | 4683.5 samples/s | 73.2 steps/s
[Step=90750 Epoch=177.4] | Loss=0.01670 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.459 | L2-Norm(final)=22.510 | 4749.2 samples/s | 74.2 steps/s
[Step=90800 Epoch=177.5] | Loss=0.01659 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.468 | L2-Norm(final)=22.514 | 4761.8 samples/s | 74.4 steps/s
[Step=90850 Epoch=177.6] | Loss=0.01598 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.477 | L2-Norm(final)=22.519 | 4758.7 samples/s | 74.4 steps/s
[Step=90900 Epoch=177.7] | Loss=0.01564 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.485 | L2-Norm(final)=22.523 | 4752.8 samples/s | 74.3 steps/s
[Step=90950 Epoch=177.8] | Loss=0.01536 | Reg=0.00056 | acc=0.9844 | L2-Norm=7.493 | L2-Norm(final)=22.527 | 4767.3 samples/s | 74.5 steps/s
[Step=91000 Epoch=177.9] | Loss=0.01507 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.501 | L2-Norm(final)=22.531 | 5876.3 samples/s | 91.8 steps/s
[Step=91050 Epoch=178.0] | Loss=0.01461 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.508 | L2-Norm(final)=22.535 | 1993.8 samples/s | 31.2 steps/s
[Step=91100 Epoch=178.1] | Loss=0.01421 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.514 | L2-Norm(final)=22.539 | 4796.6 samples/s | 74.9 steps/s
[Step=91150 Epoch=178.2] | Loss=0.01381 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.521 | L2-Norm(final)=22.543 | 4704.3 samples/s | 73.5 steps/s
[Step=91200 Epoch=178.3] | Loss=0.01340 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.527 | L2-Norm(final)=22.546 | 4772.7 samples/s | 74.6 steps/s
[Step=91250 Epoch=178.4] | Loss=0.01311 | Reg=0.00057 | acc=0.9844 | L2-Norm=7.533 | L2-Norm(final)=22.550 | 4808.2 samples/s | 75.1 steps/s
[Step=91300 Epoch=178.5] | Loss=0.01280 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.539 | L2-Norm(final)=22.554 | 4744.1 samples/s | 74.1 steps/s
[Step=91350 Epoch=178.6] | Loss=0.01255 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.544 | L2-Norm(final)=22.558 | 4682.4 samples/s | 73.2 steps/s
[Step=91400 Epoch=178.7] | Loss=0.01230 | Reg=0.00057 | acc=0.9844 | L2-Norm=7.550 | L2-Norm(final)=22.561 | 4708.9 samples/s | 73.6 steps/s
[Step=91450 Epoch=178.8] | Loss=0.01221 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.555 | L2-Norm(final)=22.565 | 4972.8 samples/s | 77.7 steps/s
[Step=91500 Epoch=178.9] | Loss=0.01199 | Reg=0.00057 | acc=0.9844 | L2-Norm=7.560 | L2-Norm(final)=22.568 | 5269.8 samples/s | 82.3 steps/s
[Step=91550 Epoch=179.0] | Loss=0.01180 | Reg=0.00057 | acc=0.9688 | L2-Norm=7.565 | L2-Norm(final)=22.572 | 2137.8 samples/s | 33.4 steps/s
[Step=91600 Epoch=179.1] | Loss=0.01156 | Reg=0.00057 | acc=0.9844 | L2-Norm=7.570 | L2-Norm(final)=22.575 | 4664.9 samples/s | 72.9 steps/s
[Step=91650 Epoch=179.2] | Loss=0.01138 | Reg=0.00057 | acc=0.9688 | L2-Norm=7.575 | L2-Norm(final)=22.578 | 4734.2 samples/s | 74.0 steps/s
[Step=91700 Epoch=179.3] | Loss=0.01118 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.579 | L2-Norm(final)=22.582 | 4778.1 samples/s | 74.7 steps/s
[Step=91750 Epoch=179.4] | Loss=0.01104 | Reg=0.00058 | acc=0.9688 | L2-Norm=7.584 | L2-Norm(final)=22.585 | 4827.6 samples/s | 75.4 steps/s
[Step=91800 Epoch=179.5] | Loss=0.01096 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.588 | L2-Norm(final)=22.588 | 4863.2 samples/s | 76.0 steps/s
[Step=91850 Epoch=179.6] | Loss=0.01078 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.593 | L2-Norm(final)=22.591 | 4754.8 samples/s | 74.3 steps/s
[Step=91900 Epoch=179.7] | Loss=0.01063 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.597 | L2-Norm(final)=22.595 | 4902.9 samples/s | 76.6 steps/s
[Step=91950 Epoch=179.8] | Loss=0.01050 | Reg=0.00058 | acc=0.9844 | L2-Norm=7.601 | L2-Norm(final)=22.598 | 4651.9 samples/s | 72.7 steps/s
[Step=92000 Epoch=179.9] | Loss=0.01044 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.605 | L2-Norm(final)=22.601 | 4748.5 samples/s | 74.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step92000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=90001 Epoch=344.9] | Loss=0.00000 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.393 | L2-Norm(final)=19.771 | 4247.3 samples/s | 66.4 steps/s
[Step=90050 Epoch=345.0] | Loss=0.00001 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.386 | L2-Norm(final)=19.778 | 5070.4 samples/s | 79.2 steps/s
[Step=90100 Epoch=345.2] | Loss=0.00002 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.385 | L2-Norm(final)=19.785 | 4976.8 samples/s | 77.8 steps/s
[Step=90150 Epoch=345.4] | Loss=0.00002 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.384 | L2-Norm(final)=19.793 | 5095.4 samples/s | 79.6 steps/s
[Step=90200 Epoch=345.6] | Loss=0.00002 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.384 | L2-Norm(final)=19.801 | 5205.9 samples/s | 81.3 steps/s
[Step=90250 Epoch=345.8] | Loss=0.00002 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.384 | L2-Norm(final)=19.809 | 6799.5 samples/s | 106.2 steps/s
[Step=90300 Epoch=346.0] | Loss=0.00002 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.384 | L2-Norm(final)=19.815 | 2044.9 samples/s | 32.0 steps/s
[Step=90350 Epoch=346.2] | Loss=0.00002 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.384 | L2-Norm(final)=19.821 | 5238.5 samples/s | 81.9 steps/s
[Step=90400 Epoch=346.4] | Loss=0.00002 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.384 | L2-Norm(final)=19.827 | 5167.2 samples/s | 80.7 steps/s
[Step=90450 Epoch=346.6] | Loss=0.00002 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.384 | L2-Norm(final)=19.834 | 4973.7 samples/s | 77.7 steps/s
[Step=90500 Epoch=346.8] | Loss=0.00002 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.384 | L2-Norm(final)=19.840 | 5796.7 samples/s | 90.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=90501 Epoch=346.8] | Loss=0.00009 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.384 | L2-Norm(final)=19.904 | 4184.3 samples/s | 65.4 steps/s
[Step=90550 Epoch=347.0] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.362 | L2-Norm(final)=19.910 | 4364.9 samples/s | 68.2 steps/s
[Step=90600 Epoch=347.1] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.335 | L2-Norm(final)=19.913 | 4521.8 samples/s | 70.7 steps/s
[Step=90650 Epoch=347.3] | Loss=0.00001 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.309 | L2-Norm(final)=19.915 | 4574.8 samples/s | 71.5 steps/s
[Step=90700 Epoch=347.5] | Loss=0.00001 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.283 | L2-Norm(final)=19.916 | 4524.9 samples/s | 70.7 steps/s
[Step=90750 Epoch=347.7] | Loss=0.00000 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.256 | L2-Norm(final)=19.917 | 5704.9 samples/s | 89.1 steps/s
[Step=90800 Epoch=347.9] | Loss=0.00000 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.230 | L2-Norm(final)=19.918 | 1931.7 samples/s | 30.2 steps/s
[Step=90850 Epoch=348.1] | Loss=0.00000 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.203 | L2-Norm(final)=19.919 | 4649.0 samples/s | 72.6 steps/s
[Step=90900 Epoch=348.3] | Loss=0.00000 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.176 | L2-Norm(final)=19.920 | 4642.0 samples/s | 72.5 steps/s
[Step=90950 Epoch=348.5] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.150 | L2-Norm(final)=19.921 | 4397.0 samples/s | 68.7 steps/s
[Step=91000 Epoch=348.7] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.124 | L2-Norm(final)=19.921 | 4981.1 samples/s | 77.8 steps/s
[Step=91050 Epoch=348.9] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.098 | L2-Norm(final)=19.922 | 2038.4 samples/s | 31.8 steps/s
[Step=91100 Epoch=349.1] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.072 | L2-Norm(final)=19.923 | 4470.0 samples/s | 69.8 steps/s
[Step=91150 Epoch=349.3] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.046 | L2-Norm(final)=19.924 | 4512.8 samples/s | 70.5 steps/s
[Step=91200 Epoch=349.4] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.020 | L2-Norm(final)=19.925 | 4436.7 samples/s | 69.3 steps/s
[Step=91250 Epoch=349.6] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.994 | L2-Norm(final)=19.926 | 4553.7 samples/s | 71.2 steps/s
[Step=91300 Epoch=349.8] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.968 | L2-Norm(final)=19.927 | 2112.5 samples/s | 33.0 steps/s
[Step=91350 Epoch=350.0] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.943 | L2-Norm(final)=19.928 | 4631.5 samples/s | 72.4 steps/s
[Step=91400 Epoch=350.2] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.917 | L2-Norm(final)=19.929 | 4616.6 samples/s | 72.1 steps/s
[Step=91450 Epoch=350.4] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.891 | L2-Norm(final)=19.931 | 4618.1 samples/s | 72.2 steps/s
[Step=91500 Epoch=350.6] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.866 | L2-Norm(final)=19.932 | 4641.1 samples/s | 72.5 steps/s
[Step=91550 Epoch=350.8] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.840 | L2-Norm(final)=19.933 | 2174.8 samples/s | 34.0 steps/s
[Step=91600 Epoch=351.0] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.815 | L2-Norm(final)=19.935 | 4648.1 samples/s | 72.6 steps/s
[Step=91650 Epoch=351.2] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.790 | L2-Norm(final)=19.936 | 4564.0 samples/s | 71.3 steps/s
[Step=91700 Epoch=351.4] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.764 | L2-Norm(final)=19.937 | 4444.9 samples/s | 69.5 steps/s
[Step=91750 Epoch=351.6] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.739 | L2-Norm(final)=19.939 | 4325.5 samples/s | 67.6 steps/s
[Step=91800 Epoch=351.7] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.714 | L2-Norm(final)=19.940 | 5943.5 samples/s | 92.9 steps/s
[Step=91850 Epoch=351.9] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.689 | L2-Norm(final)=19.942 | 1903.5 samples/s | 29.7 steps/s
[Step=91900 Epoch=352.1] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.665 | L2-Norm(final)=19.944 | 4640.5 samples/s | 72.5 steps/s
[Step=91950 Epoch=352.3] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.642 | L2-Norm(final)=19.946 | 4481.2 samples/s | 70.0 steps/s
[Step=92000 Epoch=352.5] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.618 | L2-Norm(final)=19.948 | 4502.3 samples/s | 70.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step92000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=90001 Epoch=346.4] | Loss=0.00003 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.393 | L2-Norm(final)=19.288 | 4090.4 samples/s | 63.9 steps/s
[Step=90050 Epoch=346.6] | Loss=0.00026 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.391 | L2-Norm(final)=19.289 | 4968.1 samples/s | 77.6 steps/s
[Step=90100 Epoch=346.8] | Loss=0.00020 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.391 | L2-Norm(final)=19.292 | 5159.3 samples/s | 80.6 steps/s
[Step=90150 Epoch=347.0] | Loss=0.00018 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.391 | L2-Norm(final)=19.295 | 5299.6 samples/s | 82.8 steps/s
[Step=90200 Epoch=347.2] | Loss=0.00016 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.391 | L2-Norm(final)=19.298 | 5380.1 samples/s | 84.1 steps/s
[Step=90250 Epoch=347.4] | Loss=0.00016 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.391 | L2-Norm(final)=19.301 | 6950.6 samples/s | 108.6 steps/s
[Step=90300 Epoch=347.6] | Loss=0.00015 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.391 | L2-Norm(final)=19.303 | 2010.0 samples/s | 31.4 steps/s
[Step=90350 Epoch=347.8] | Loss=0.00016 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.391 | L2-Norm(final)=19.306 | 5148.9 samples/s | 80.5 steps/s
[Step=90400 Epoch=348.0] | Loss=0.00016 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.391 | L2-Norm(final)=19.308 | 5123.7 samples/s | 80.1 steps/s
[Step=90450 Epoch=348.2] | Loss=0.00015 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.391 | L2-Norm(final)=19.311 | 5147.9 samples/s | 80.4 steps/s
[Step=90500 Epoch=348.4] | Loss=0.00015 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.391 | L2-Norm(final)=19.313 | 5979.4 samples/s | 93.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=90501 Epoch=348.4] | Loss=0.00013 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.391 | L2-Norm(final)=19.334 | 4110.7 samples/s | 64.2 steps/s
[Step=90550 Epoch=348.6] | Loss=0.00063 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.402 | L2-Norm(final)=19.335 | 4414.6 samples/s | 69.0 steps/s
[Step=90600 Epoch=348.8] | Loss=0.00040 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.409 | L2-Norm(final)=19.336 | 4517.8 samples/s | 70.6 steps/s
[Step=90650 Epoch=348.9] | Loss=0.00030 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.412 | L2-Norm(final)=19.338 | 4426.5 samples/s | 69.2 steps/s
[Step=90700 Epoch=349.1] | Loss=0.00023 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.413 | L2-Norm(final)=19.339 | 4489.8 samples/s | 70.2 steps/s
[Step=90750 Epoch=349.3] | Loss=0.00019 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.413 | L2-Norm(final)=19.340 | 5721.3 samples/s | 89.4 steps/s
[Step=90800 Epoch=349.5] | Loss=0.00016 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.413 | L2-Norm(final)=19.341 | 1914.0 samples/s | 29.9 steps/s
[Step=90850 Epoch=349.7] | Loss=0.00014 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.413 | L2-Norm(final)=19.341 | 4535.6 samples/s | 70.9 steps/s
[Step=90900 Epoch=349.9] | Loss=0.00012 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.412 | L2-Norm(final)=19.342 | 4500.7 samples/s | 70.3 steps/s
[Step=90950 Epoch=350.1] | Loss=0.00011 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.412 | L2-Norm(final)=19.342 | 4583.8 samples/s | 71.6 steps/s
[Step=91000 Epoch=350.3] | Loss=0.00010 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.411 | L2-Norm(final)=19.343 | 5116.7 samples/s | 79.9 steps/s
[Step=91050 Epoch=350.5] | Loss=0.00009 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.410 | L2-Norm(final)=19.343 | 2041.3 samples/s | 31.9 steps/s
[Step=91100 Epoch=350.7] | Loss=0.00008 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.409 | L2-Norm(final)=19.344 | 4602.0 samples/s | 71.9 steps/s
[Step=91150 Epoch=350.9] | Loss=0.00008 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.408 | L2-Norm(final)=19.344 | 4715.5 samples/s | 73.7 steps/s
[Step=91200 Epoch=351.1] | Loss=0.00007 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.407 | L2-Norm(final)=19.344 | 4565.3 samples/s | 71.3 steps/s
[Step=91250 Epoch=351.3] | Loss=0.00007 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.406 | L2-Norm(final)=19.345 | 4737.0 samples/s | 74.0 steps/s
[Step=91300 Epoch=351.4] | Loss=0.00006 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.405 | L2-Norm(final)=19.345 | 2132.7 samples/s | 33.3 steps/s
[Step=91350 Epoch=351.6] | Loss=0.00006 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.404 | L2-Norm(final)=19.345 | 4628.2 samples/s | 72.3 steps/s
[Step=91400 Epoch=351.8] | Loss=0.00006 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.403 | L2-Norm(final)=19.346 | 4504.9 samples/s | 70.4 steps/s
[Step=91450 Epoch=352.0] | Loss=0.00006 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.402 | L2-Norm(final)=19.346 | 4544.8 samples/s | 71.0 steps/s
[Step=91500 Epoch=352.2] | Loss=0.00005 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.401 | L2-Norm(final)=19.346 | 4482.6 samples/s | 70.0 steps/s
[Step=91550 Epoch=352.4] | Loss=0.00005 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.400 | L2-Norm(final)=19.347 | 2122.5 samples/s | 33.2 steps/s
[Step=91600 Epoch=352.6] | Loss=0.00005 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.399 | L2-Norm(final)=19.347 | 4644.9 samples/s | 72.6 steps/s
[Step=91650 Epoch=352.8] | Loss=0.00005 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.398 | L2-Norm(final)=19.347 | 4603.8 samples/s | 71.9 steps/s
[Step=91700 Epoch=353.0] | Loss=0.00004 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.397 | L2-Norm(final)=19.348 | 4533.0 samples/s | 70.8 steps/s
[Step=91750 Epoch=353.2] | Loss=0.00004 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.395 | L2-Norm(final)=19.348 | 4544.1 samples/s | 71.0 steps/s
[Step=91800 Epoch=353.4] | Loss=0.00004 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.394 | L2-Norm(final)=19.348 | 6664.4 samples/s | 104.1 steps/s
[Step=91850 Epoch=353.6] | Loss=0.00004 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.393 | L2-Norm(final)=19.348 | 1863.0 samples/s | 29.1 steps/s
[Step=91900 Epoch=353.8] | Loss=0.00004 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.392 | L2-Norm(final)=19.349 | 4535.5 samples/s | 70.9 steps/s
[Step=91950 Epoch=354.0] | Loss=0.00004 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.391 | L2-Norm(final)=19.349 | 4562.5 samples/s | 71.3 steps/s
[Step=92000 Epoch=354.1] | Loss=0.00004 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.389 | L2-Norm(final)=19.349 | 4543.1 samples/s | 71.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step92000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05574 | acc=0.9700 | tpr=0.9747 | fpr=0.0401 | 4336.4 samples/s | 16.9 steps/s
Avg test loss: 0.05601, Avg test acc: 0.96991, Avg tpr: 0.97476, Avg fpr: 0.04076, total FA: 318

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05803 | acc=0.9696 | tpr=0.9722 | fpr=0.0359 | 4401.7 samples/s | 17.2 steps/s
Avg test loss: 0.05820, Avg test acc: 0.96963, Avg tpr: 0.97296, Avg fpr: 0.03769, total FA: 294

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.47620 | acc=0.3145 | tpr=0.0035 | fpr=0.0104 | 4500.4 samples/s | 17.6 steps/s
Avg test loss: 5.50025, Avg test acc: 0.31228, Avg tpr: 0.00402, Avg fpr: 0.00974, total FA: 76

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.15565 | acc=0.3128 | tpr=0.0075 | fpr=0.0243 | 4388.3 samples/s | 17.1 steps/s
Avg test loss: 5.17097, Avg test acc: 0.31104, Avg tpr: 0.00828, Avg fpr: 0.02307, total FA: 180

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.56211 | acc=0.1369 | tpr=0.7035 | fpr=0.8733 | 4364.9 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.54638 | acc=0.1360 | tpr=0.7015 | fpr=0.8746 | 8421.3 samples/s | 32.9 steps/s
[Step= 150] | Loss=4.54919 | acc=0.1355 | tpr=0.6974 | fpr=0.8748 | 8384.2 samples/s | 32.8 steps/s
[Step= 200] | Loss=4.55213 | acc=0.1346 | tpr=0.6842 | fpr=0.8754 | 8295.6 samples/s | 32.4 steps/s
[Step= 250] | Loss=4.56046 | acc=0.1347 | tpr=0.6873 | fpr=0.8753 | 8486.3 samples/s | 33.1 steps/s
[Step= 300] | Loss=4.55808 | acc=0.1348 | tpr=0.6807 | fpr=0.8752 | 8689.4 samples/s | 33.9 steps/s
[Step= 350] | Loss=4.55752 | acc=0.1341 | tpr=0.6788 | fpr=0.8758 | 8036.2 samples/s | 31.4 steps/s
[Step= 400] | Loss=4.56210 | acc=0.1339 | tpr=0.6740 | fpr=0.8759 | 8452.6 samples/s | 33.0 steps/s
[Step= 450] | Loss=4.56596 | acc=0.1338 | tpr=0.6767 | fpr=0.8761 | 8568.0 samples/s | 33.5 steps/s
[Step= 500] | Loss=4.56540 | acc=0.1335 | tpr=0.6824 | fpr=0.8764 | 8399.9 samples/s | 32.8 steps/s
[Step= 550] | Loss=4.56877 | acc=0.1335 | tpr=0.6789 | fpr=0.8764 | 14552.1 samples/s | 56.8 steps/s
Avg test loss: 4.56863, Avg test acc: 0.13334, Avg tpr: 0.67948, Avg fpr: 0.87658, total FA: 121712

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.34861 | acc=0.1483 | tpr=0.6681 | fpr=0.8611 | 4420.7 samples/s | 17.3 steps/s
[Step= 100] | Loss=4.33041 | acc=0.1473 | tpr=0.6567 | fpr=0.8622 | 8492.0 samples/s | 33.2 steps/s
[Step= 150] | Loss=4.33216 | acc=0.1463 | tpr=0.6499 | fpr=0.8629 | 8340.2 samples/s | 32.6 steps/s
[Step= 200] | Loss=4.33341 | acc=0.1456 | tpr=0.6295 | fpr=0.8632 | 8544.5 samples/s | 33.4 steps/s
[Step= 250] | Loss=4.34274 | acc=0.1457 | tpr=0.6323 | fpr=0.8632 | 8193.0 samples/s | 32.0 steps/s
[Step= 300] | Loss=4.34104 | acc=0.1457 | tpr=0.6255 | fpr=0.8630 | 8483.8 samples/s | 33.1 steps/s
[Step= 350] | Loss=4.33898 | acc=0.1448 | tpr=0.6224 | fpr=0.8639 | 8450.0 samples/s | 33.0 steps/s
[Step= 400] | Loss=4.34394 | acc=0.1445 | tpr=0.6176 | fpr=0.8641 | 8522.4 samples/s | 33.3 steps/s
[Step= 450] | Loss=4.34635 | acc=0.1447 | tpr=0.6212 | fpr=0.8640 | 8173.3 samples/s | 31.9 steps/s
[Step= 500] | Loss=4.34472 | acc=0.1446 | tpr=0.6282 | fpr=0.8641 | 8383.4 samples/s | 32.7 steps/s
[Step= 550] | Loss=4.34809 | acc=0.1443 | tpr=0.6224 | fpr=0.8643 | 15378.0 samples/s | 60.1 steps/s
Avg test loss: 4.34812, Avg test acc: 0.14424, Avg tpr: 0.62282, Avg fpr: 0.86446, total FA: 120028

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08969 | acc=0.9830 | tpr=0.9469 | fpr=0.0164 | 4431.4 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.09353 | acc=0.9821 | tpr=0.9680 | fpr=0.0176 | 8512.7 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.09623 | acc=0.9818 | tpr=0.9669 | fpr=0.0180 | 8245.6 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.09760 | acc=0.9817 | tpr=0.9672 | fpr=0.0180 | 8832.7 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.09661 | acc=0.9819 | tpr=0.9651 | fpr=0.0178 | 8232.7 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.09785 | acc=0.9817 | tpr=0.9644 | fpr=0.0180 | 8478.4 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.09877 | acc=0.9815 | tpr=0.9631 | fpr=0.0182 | 8379.0 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.09976 | acc=0.9813 | tpr=0.9612 | fpr=0.0183 | 8325.5 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.10167 | acc=0.9811 | tpr=0.9591 | fpr=0.0185 | 8711.3 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.10119 | acc=0.9811 | tpr=0.9599 | fpr=0.0185 | 8273.6 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.10042 | acc=0.9812 | tpr=0.9586 | fpr=0.0183 | 15637.2 samples/s | 61.1 steps/s
Avg test loss: 0.10020, Avg test acc: 0.98126, Avg tpr: 0.95840, Avg fpr: 0.01832, total FA: 2544

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10936 | acc=0.9820 | tpr=0.9425 | fpr=0.0173 | 4388.1 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.11502 | acc=0.9816 | tpr=0.9659 | fpr=0.0181 | 8695.6 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.11896 | acc=0.9808 | tpr=0.9683 | fpr=0.0190 | 8256.6 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.11991 | acc=0.9810 | tpr=0.9705 | fpr=0.0188 | 8689.1 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.11885 | acc=0.9811 | tpr=0.9694 | fpr=0.0186 | 8251.4 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.12022 | acc=0.9810 | tpr=0.9709 | fpr=0.0188 | 8709.7 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.12127 | acc=0.9808 | tpr=0.9693 | fpr=0.0190 | 8049.0 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.12263 | acc=0.9807 | tpr=0.9694 | fpr=0.0191 | 8933.2 samples/s | 34.9 steps/s
[Step= 450] | Loss=0.12497 | acc=0.9805 | tpr=0.9674 | fpr=0.0193 | 8131.3 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.12476 | acc=0.9804 | tpr=0.9674 | fpr=0.0193 | 8334.2 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.12376 | acc=0.9805 | tpr=0.9658 | fpr=0.0192 | 15077.1 samples/s | 58.9 steps/s
Avg test loss: 0.12344, Avg test acc: 0.98052, Avg tpr: 0.96593, Avg fpr: 0.01922, total FA: 2668

server round 46/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=92001 Epoch=179.4] | Loss=0.04820 | Reg=0.00051 | acc=0.9375 | L2-Norm=7.112 | L2-Norm(final)=21.615 | 3820.2 samples/s | 59.7 steps/s
[Step=92050 Epoch=179.5] | Loss=0.02570 | Reg=0.00051 | acc=0.9531 | L2-Norm=7.113 | L2-Norm(final)=21.621 | 5514.5 samples/s | 86.2 steps/s
[Step=92100 Epoch=179.6] | Loss=0.02629 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.113 | L2-Norm(final)=21.627 | 5508.2 samples/s | 86.1 steps/s
[Step=92150 Epoch=179.7] | Loss=0.02724 | Reg=0.00051 | acc=0.9531 | L2-Norm=7.113 | L2-Norm(final)=21.633 | 5489.5 samples/s | 85.8 steps/s
[Step=92200 Epoch=179.8] | Loss=0.02669 | Reg=0.00051 | acc=0.9688 | L2-Norm=7.113 | L2-Norm(final)=21.638 | 5498.2 samples/s | 85.9 steps/s
[Step=92250 Epoch=179.9] | Loss=0.02608 | Reg=0.00051 | acc=0.9531 | L2-Norm=7.113 | L2-Norm(final)=21.644 | 5461.9 samples/s | 85.3 steps/s
[Step=92300 Epoch=180.0] | Loss=0.02582 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.113 | L2-Norm(final)=21.650 | 5477.3 samples/s | 85.6 steps/s
[Step=92350 Epoch=180.1] | Loss=0.02613 | Reg=0.00051 | acc=0.9688 | L2-Norm=7.113 | L2-Norm(final)=21.656 | 5407.0 samples/s | 84.5 steps/s
[Step=92400 Epoch=180.2] | Loss=0.02595 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.113 | L2-Norm(final)=21.662 | 5444.1 samples/s | 85.1 steps/s
[Step=92450 Epoch=180.3] | Loss=0.02571 | Reg=0.00051 | acc=0.9688 | L2-Norm=7.113 | L2-Norm(final)=21.668 | 5494.0 samples/s | 85.8 steps/s
[Step=92500 Epoch=180.4] | Loss=0.02571 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.113 | L2-Norm(final)=21.674 | 7020.9 samples/s | 109.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=92501 Epoch=180.4] | Loss=0.03755 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.113 | L2-Norm(final)=21.732 | 3867.2 samples/s | 60.4 steps/s
[Step=92550 Epoch=180.5] | Loss=0.02259 | Reg=0.00051 | acc=0.9688 | L2-Norm=7.127 | L2-Norm(final)=21.738 | 4886.5 samples/s | 76.4 steps/s
[Step=92600 Epoch=180.6] | Loss=0.02010 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.142 | L2-Norm(final)=21.743 | 4743.6 samples/s | 74.1 steps/s
[Step=92650 Epoch=180.7] | Loss=0.01874 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.155 | L2-Norm(final)=21.748 | 4731.0 samples/s | 73.9 steps/s
[Step=92700 Epoch=180.8] | Loss=0.01815 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.168 | L2-Norm(final)=21.754 | 4765.0 samples/s | 74.5 steps/s
[Step=92750 Epoch=180.9] | Loss=0.01794 | Reg=0.00052 | acc=0.9688 | L2-Norm=7.179 | L2-Norm(final)=21.759 | 4714.3 samples/s | 73.7 steps/s
[Step=92800 Epoch=181.0] | Loss=0.01743 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.189 | L2-Norm(final)=21.763 | 4800.8 samples/s | 75.0 steps/s
[Step=92850 Epoch=181.1] | Loss=0.01758 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.199 | L2-Norm(final)=21.768 | 4760.7 samples/s | 74.4 steps/s
[Step=92900 Epoch=181.2] | Loss=0.01704 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.207 | L2-Norm(final)=21.772 | 4826.9 samples/s | 75.4 steps/s
[Step=92950 Epoch=181.3] | Loss=0.01675 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.216 | L2-Norm(final)=21.776 | 4827.8 samples/s | 75.4 steps/s
[Step=93000 Epoch=181.4] | Loss=0.01674 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.224 | L2-Norm(final)=21.781 | 5798.5 samples/s | 90.6 steps/s
[Step=93050 Epoch=181.5] | Loss=0.01626 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.232 | L2-Norm(final)=21.785 | 1983.1 samples/s | 31.0 steps/s
[Step=93100 Epoch=181.6] | Loss=0.01579 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.240 | L2-Norm(final)=21.789 | 4665.6 samples/s | 72.9 steps/s
[Step=93150 Epoch=181.7] | Loss=0.01525 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.248 | L2-Norm(final)=21.793 | 4711.8 samples/s | 73.6 steps/s
[Step=93200 Epoch=181.8] | Loss=0.01477 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.255 | L2-Norm(final)=21.797 | 4700.8 samples/s | 73.5 steps/s
[Step=93250 Epoch=181.9] | Loss=0.01442 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.262 | L2-Norm(final)=21.801 | 4773.4 samples/s | 74.6 steps/s
[Step=93300 Epoch=182.0] | Loss=0.01417 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.268 | L2-Norm(final)=21.804 | 4707.1 samples/s | 73.5 steps/s
[Step=93350 Epoch=182.1] | Loss=0.01396 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.274 | L2-Norm(final)=21.808 | 4702.7 samples/s | 73.5 steps/s
[Step=93400 Epoch=182.2] | Loss=0.01369 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.281 | L2-Norm(final)=21.812 | 4821.5 samples/s | 75.3 steps/s
[Step=93450 Epoch=182.3] | Loss=0.01356 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.287 | L2-Norm(final)=21.815 | 4791.9 samples/s | 74.9 steps/s
[Step=93500 Epoch=182.4] | Loss=0.01352 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.293 | L2-Norm(final)=21.819 | 5017.8 samples/s | 78.4 steps/s
[Step=93550 Epoch=182.5] | Loss=0.01327 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.298 | L2-Norm(final)=21.822 | 2082.9 samples/s | 32.5 steps/s
[Step=93600 Epoch=182.6] | Loss=0.01305 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.304 | L2-Norm(final)=21.826 | 4785.0 samples/s | 74.8 steps/s
[Step=93650 Epoch=182.7] | Loss=0.01284 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.309 | L2-Norm(final)=21.829 | 4759.9 samples/s | 74.4 steps/s
[Step=93700 Epoch=182.8] | Loss=0.01270 | Reg=0.00054 | acc=0.9688 | L2-Norm=7.315 | L2-Norm(final)=21.833 | 4750.3 samples/s | 74.2 steps/s
[Step=93750 Epoch=182.8] | Loss=0.01250 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.320 | L2-Norm(final)=21.836 | 4771.3 samples/s | 74.6 steps/s
[Step=93800 Epoch=182.9] | Loss=0.01236 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.325 | L2-Norm(final)=21.839 | 4696.9 samples/s | 73.4 steps/s
[Step=93850 Epoch=183.0] | Loss=0.01217 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.330 | L2-Norm(final)=21.842 | 4729.3 samples/s | 73.9 steps/s
[Step=93900 Epoch=183.1] | Loss=0.01203 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.334 | L2-Norm(final)=21.845 | 4876.9 samples/s | 76.2 steps/s
[Step=93950 Epoch=183.2] | Loss=0.01195 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.339 | L2-Norm(final)=21.849 | 4751.3 samples/s | 74.2 steps/s
[Step=94000 Epoch=183.3] | Loss=0.01182 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.344 | L2-Norm(final)=21.852 | 4765.1 samples/s | 74.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step94000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=92001 Epoch=179.9] | Loss=0.01962 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.112 | L2-Norm(final)=22.693 | 4014.4 samples/s | 62.7 steps/s
[Step=92050 Epoch=180.0] | Loss=0.04212 | Reg=0.00051 | acc=0.9062 | L2-Norm=7.113 | L2-Norm(final)=22.684 | 5096.3 samples/s | 79.6 steps/s
[Step=92100 Epoch=180.1] | Loss=0.03963 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.113 | L2-Norm(final)=22.671 | 5197.0 samples/s | 81.2 steps/s
[Step=92150 Epoch=180.2] | Loss=0.03933 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.113 | L2-Norm(final)=22.659 | 5073.9 samples/s | 79.3 steps/s
[Step=92200 Epoch=180.2] | Loss=0.03889 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.113 | L2-Norm(final)=22.649 | 5231.8 samples/s | 81.7 steps/s
[Step=92250 Epoch=180.3] | Loss=0.03742 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.113 | L2-Norm(final)=22.641 | 5393.2 samples/s | 84.3 steps/s
[Step=92300 Epoch=180.4] | Loss=0.03765 | Reg=0.00051 | acc=0.9688 | L2-Norm=7.113 | L2-Norm(final)=22.633 | 5359.6 samples/s | 83.7 steps/s
[Step=92350 Epoch=180.5] | Loss=0.03673 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.113 | L2-Norm(final)=22.626 | 5509.5 samples/s | 86.1 steps/s
[Step=92400 Epoch=180.6] | Loss=0.03564 | Reg=0.00051 | acc=0.9688 | L2-Norm=7.113 | L2-Norm(final)=22.620 | 5468.6 samples/s | 85.4 steps/s
[Step=92450 Epoch=180.7] | Loss=0.03501 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.113 | L2-Norm(final)=22.615 | 5489.7 samples/s | 85.8 steps/s
[Step=92500 Epoch=180.8] | Loss=0.03439 | Reg=0.00051 | acc=0.9688 | L2-Norm=7.113 | L2-Norm(final)=22.611 | 7159.7 samples/s | 111.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=92501 Epoch=180.8] | Loss=0.03095 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.113 | L2-Norm(final)=22.568 | 4221.2 samples/s | 66.0 steps/s
[Step=92550 Epoch=180.9] | Loss=0.02487 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.128 | L2-Norm(final)=22.569 | 4823.3 samples/s | 75.4 steps/s
[Step=92600 Epoch=181.0] | Loss=0.02174 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.142 | L2-Norm(final)=22.572 | 4804.7 samples/s | 75.1 steps/s
[Step=92650 Epoch=181.1] | Loss=0.01965 | Reg=0.00051 | acc=0.9688 | L2-Norm=7.156 | L2-Norm(final)=22.576 | 4799.9 samples/s | 75.0 steps/s
[Step=92700 Epoch=181.2] | Loss=0.01874 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.168 | L2-Norm(final)=22.579 | 4759.2 samples/s | 74.4 steps/s
[Step=92750 Epoch=181.3] | Loss=0.01821 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.179 | L2-Norm(final)=22.582 | 4726.9 samples/s | 73.9 steps/s
[Step=92800 Epoch=181.4] | Loss=0.01786 | Reg=0.00052 | acc=0.9688 | L2-Norm=7.190 | L2-Norm(final)=22.585 | 4798.0 samples/s | 75.0 steps/s
[Step=92850 Epoch=181.5] | Loss=0.01720 | Reg=0.00052 | acc=0.9688 | L2-Norm=7.199 | L2-Norm(final)=22.588 | 4838.9 samples/s | 75.6 steps/s
[Step=92900 Epoch=181.6] | Loss=0.01709 | Reg=0.00052 | acc=0.9531 | L2-Norm=7.209 | L2-Norm(final)=22.591 | 4805.1 samples/s | 75.1 steps/s
[Step=92950 Epoch=181.7] | Loss=0.01665 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.217 | L2-Norm(final)=22.594 | 4768.8 samples/s | 74.5 steps/s
[Step=93000 Epoch=181.8] | Loss=0.01617 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.225 | L2-Norm(final)=22.596 | 5834.6 samples/s | 91.2 steps/s
[Step=93050 Epoch=181.9] | Loss=0.01568 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.232 | L2-Norm(final)=22.599 | 2021.8 samples/s | 31.6 steps/s
[Step=93100 Epoch=182.0] | Loss=0.01519 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.239 | L2-Norm(final)=22.602 | 4815.7 samples/s | 75.2 steps/s
[Step=93150 Epoch=182.1] | Loss=0.01481 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.246 | L2-Norm(final)=22.604 | 4717.9 samples/s | 73.7 steps/s
[Step=93200 Epoch=182.2] | Loss=0.01440 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.253 | L2-Norm(final)=22.607 | 4764.2 samples/s | 74.4 steps/s
[Step=93250 Epoch=182.3] | Loss=0.01404 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.259 | L2-Norm(final)=22.609 | 4823.8 samples/s | 75.4 steps/s
[Step=93300 Epoch=182.4] | Loss=0.01381 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.265 | L2-Norm(final)=22.612 | 4788.1 samples/s | 74.8 steps/s
[Step=93350 Epoch=182.5] | Loss=0.01361 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.272 | L2-Norm(final)=22.614 | 4827.0 samples/s | 75.4 steps/s
[Step=93400 Epoch=182.6] | Loss=0.01338 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.277 | L2-Norm(final)=22.617 | 4736.8 samples/s | 74.0 steps/s
[Step=93450 Epoch=182.7] | Loss=0.01314 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.283 | L2-Norm(final)=22.619 | 4774.5 samples/s | 74.6 steps/s
[Step=93500 Epoch=182.8] | Loss=0.01294 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.289 | L2-Norm(final)=22.622 | 5183.0 samples/s | 81.0 steps/s
[Step=93550 Epoch=182.9] | Loss=0.01276 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.294 | L2-Norm(final)=22.624 | 2129.7 samples/s | 33.3 steps/s
[Step=93600 Epoch=183.0] | Loss=0.01249 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.300 | L2-Norm(final)=22.626 | 4694.6 samples/s | 73.4 steps/s
[Step=93650 Epoch=183.1] | Loss=0.01230 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.305 | L2-Norm(final)=22.629 | 4721.8 samples/s | 73.8 steps/s
[Step=93700 Epoch=183.2] | Loss=0.01207 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.310 | L2-Norm(final)=22.631 | 4739.1 samples/s | 74.0 steps/s
[Step=93750 Epoch=183.3] | Loss=0.01191 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.315 | L2-Norm(final)=22.633 | 4793.7 samples/s | 74.9 steps/s
[Step=93800 Epoch=183.4] | Loss=0.01178 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.320 | L2-Norm(final)=22.636 | 4756.7 samples/s | 74.3 steps/s
[Step=93850 Epoch=183.5] | Loss=0.01163 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.325 | L2-Norm(final)=22.638 | 4805.9 samples/s | 75.1 steps/s
[Step=93900 Epoch=183.6] | Loss=0.01148 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.329 | L2-Norm(final)=22.640 | 4809.4 samples/s | 75.1 steps/s
[Step=93950 Epoch=183.7] | Loss=0.01137 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.334 | L2-Norm(final)=22.642 | 4780.6 samples/s | 74.7 steps/s
[Step=94000 Epoch=183.8] | Loss=0.01129 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.338 | L2-Norm(final)=22.645 | 4744.2 samples/s | 74.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step94000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=92001 Epoch=352.5] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.112 | L2-Norm(final)=20.006 | 4509.2 samples/s | 70.5 steps/s
[Step=92050 Epoch=352.7] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.106 | L2-Norm(final)=20.011 | 4838.2 samples/s | 75.6 steps/s
[Step=92100 Epoch=352.9] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.105 | L2-Norm(final)=20.020 | 5042.9 samples/s | 78.8 steps/s
[Step=92150 Epoch=353.1] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.104 | L2-Norm(final)=20.028 | 5104.8 samples/s | 79.8 steps/s
[Step=92200 Epoch=353.3] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.104 | L2-Norm(final)=20.036 | 5177.2 samples/s | 80.9 steps/s
[Step=92250 Epoch=353.5] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.104 | L2-Norm(final)=20.044 | 6775.9 samples/s | 105.9 steps/s
[Step=92300 Epoch=353.7] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.104 | L2-Norm(final)=20.052 | 2031.0 samples/s | 31.7 steps/s
[Step=92350 Epoch=353.9] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.104 | L2-Norm(final)=20.061 | 5153.5 samples/s | 80.5 steps/s
[Step=92400 Epoch=354.0] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.104 | L2-Norm(final)=20.069 | 5175.2 samples/s | 80.9 steps/s
[Step=92450 Epoch=354.2] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.104 | L2-Norm(final)=20.077 | 5078.0 samples/s | 79.3 steps/s
[Step=92500 Epoch=354.4] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.104 | L2-Norm(final)=20.085 | 5845.0 samples/s | 91.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=92501 Epoch=354.4] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.104 | L2-Norm(final)=20.165 | 4193.0 samples/s | 65.5 steps/s
[Step=92550 Epoch=354.6] | Loss=0.00017 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.080 | L2-Norm(final)=20.171 | 4290.2 samples/s | 67.0 steps/s
[Step=92600 Epoch=354.8] | Loss=0.00012 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.081 | L2-Norm(final)=20.173 | 4485.2 samples/s | 70.1 steps/s
[Step=92650 Epoch=355.0] | Loss=0.00008 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.080 | L2-Norm(final)=20.174 | 4492.8 samples/s | 70.2 steps/s
[Step=92700 Epoch=355.2] | Loss=0.00006 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.078 | L2-Norm(final)=20.175 | 4469.3 samples/s | 69.8 steps/s
[Step=92750 Epoch=355.4] | Loss=0.00005 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.076 | L2-Norm(final)=20.175 | 5699.9 samples/s | 89.1 steps/s
[Step=92800 Epoch=355.6] | Loss=0.00004 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.074 | L2-Norm(final)=20.176 | 1983.0 samples/s | 31.0 steps/s
[Step=92850 Epoch=355.8] | Loss=0.00004 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.072 | L2-Norm(final)=20.176 | 4631.1 samples/s | 72.4 steps/s
[Step=92900 Epoch=356.0] | Loss=0.00003 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.069 | L2-Norm(final)=20.177 | 4643.0 samples/s | 72.5 steps/s
[Step=92950 Epoch=356.2] | Loss=0.00003 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.067 | L2-Norm(final)=20.177 | 4577.9 samples/s | 71.5 steps/s
[Step=93000 Epoch=356.3] | Loss=0.00003 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.065 | L2-Norm(final)=20.177 | 4973.5 samples/s | 77.7 steps/s
[Step=93050 Epoch=356.5] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.062 | L2-Norm(final)=20.177 | 2033.3 samples/s | 31.8 steps/s
[Step=93100 Epoch=356.7] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.060 | L2-Norm(final)=20.178 | 4561.6 samples/s | 71.3 steps/s
[Step=93150 Epoch=356.9] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.057 | L2-Norm(final)=20.178 | 4521.0 samples/s | 70.6 steps/s
[Step=93200 Epoch=357.1] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.054 | L2-Norm(final)=20.178 | 4530.2 samples/s | 70.8 steps/s
[Step=93250 Epoch=357.3] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.052 | L2-Norm(final)=20.178 | 4453.3 samples/s | 69.6 steps/s
[Step=93300 Epoch=357.5] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.049 | L2-Norm(final)=20.179 | 2061.2 samples/s | 32.2 steps/s
[Step=93350 Epoch=357.7] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.047 | L2-Norm(final)=20.179 | 4685.5 samples/s | 73.2 steps/s
[Step=93400 Epoch=357.9] | Loss=0.00001 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.044 | L2-Norm(final)=20.179 | 4582.5 samples/s | 71.6 steps/s
[Step=93450 Epoch=358.1] | Loss=0.00001 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.041 | L2-Norm(final)=20.179 | 4498.4 samples/s | 70.3 steps/s
[Step=93500 Epoch=358.3] | Loss=0.00001 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.038 | L2-Norm(final)=20.179 | 4554.8 samples/s | 71.2 steps/s
[Step=93550 Epoch=358.5] | Loss=0.00001 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.036 | L2-Norm(final)=20.180 | 2135.3 samples/s | 33.4 steps/s
[Step=93600 Epoch=358.6] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.033 | L2-Norm(final)=20.180 | 4580.4 samples/s | 71.6 steps/s
[Step=93650 Epoch=358.8] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.030 | L2-Norm(final)=20.180 | 4668.3 samples/s | 72.9 steps/s
[Step=93700 Epoch=359.0] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.027 | L2-Norm(final)=20.180 | 4443.3 samples/s | 69.4 steps/s
[Step=93750 Epoch=359.2] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.024 | L2-Norm(final)=20.181 | 4567.8 samples/s | 71.4 steps/s
[Step=93800 Epoch=359.4] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.021 | L2-Norm(final)=20.181 | 5987.8 samples/s | 93.6 steps/s
[Step=93850 Epoch=359.6] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.018 | L2-Norm(final)=20.181 | 1913.1 samples/s | 29.9 steps/s
[Step=93900 Epoch=359.8] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.015 | L2-Norm(final)=20.181 | 4429.1 samples/s | 69.2 steps/s
[Step=93950 Epoch=360.0] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.012 | L2-Norm(final)=20.181 | 4559.4 samples/s | 71.2 steps/s
[Step=94000 Epoch=360.2] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.009 | L2-Norm(final)=20.182 | 4556.3 samples/s | 71.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step94000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=92001 Epoch=354.1] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.112 | L2-Norm(final)=19.357 | 4487.9 samples/s | 70.1 steps/s
[Step=92050 Epoch=354.3] | Loss=0.00017 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.111 | L2-Norm(final)=19.362 | 4631.2 samples/s | 72.4 steps/s
[Step=92100 Epoch=354.5] | Loss=0.00022 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.111 | L2-Norm(final)=19.365 | 5122.3 samples/s | 80.0 steps/s
[Step=92150 Epoch=354.7] | Loss=0.00020 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.111 | L2-Norm(final)=19.368 | 5174.1 samples/s | 80.8 steps/s
[Step=92200 Epoch=354.9] | Loss=0.00019 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.111 | L2-Norm(final)=19.370 | 5135.4 samples/s | 80.2 steps/s
[Step=92250 Epoch=355.1] | Loss=0.00020 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.111 | L2-Norm(final)=19.372 | 6892.6 samples/s | 107.7 steps/s
[Step=92300 Epoch=355.3] | Loss=0.00020 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.111 | L2-Norm(final)=19.374 | 2023.0 samples/s | 31.6 steps/s
[Step=92350 Epoch=355.5] | Loss=0.00019 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.111 | L2-Norm(final)=19.377 | 5211.6 samples/s | 81.4 steps/s
[Step=92400 Epoch=355.7] | Loss=0.00020 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.111 | L2-Norm(final)=19.379 | 5104.2 samples/s | 79.8 steps/s
[Step=92450 Epoch=355.9] | Loss=0.00021 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.111 | L2-Norm(final)=19.382 | 5171.1 samples/s | 80.8 steps/s
[Step=92500 Epoch=356.1] | Loss=0.00021 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.111 | L2-Norm(final)=19.384 | 5857.2 samples/s | 91.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=92501 Epoch=356.1] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.111 | L2-Norm(final)=19.409 | 4295.9 samples/s | 67.1 steps/s
[Step=92550 Epoch=356.3] | Loss=0.00033 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.112 | L2-Norm(final)=19.411 | 4319.0 samples/s | 67.5 steps/s
[Step=92600 Epoch=356.5] | Loss=0.00040 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.121 | L2-Norm(final)=19.413 | 4597.2 samples/s | 71.8 steps/s
[Step=92650 Epoch=356.6] | Loss=0.00030 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.125 | L2-Norm(final)=19.415 | 4518.7 samples/s | 70.6 steps/s
[Step=92700 Epoch=356.8] | Loss=0.00024 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.127 | L2-Norm(final)=19.416 | 4524.3 samples/s | 70.7 steps/s
[Step=92750 Epoch=357.0] | Loss=0.00019 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.128 | L2-Norm(final)=19.417 | 5857.5 samples/s | 91.5 steps/s
[Step=92800 Epoch=357.2] | Loss=0.00016 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.129 | L2-Norm(final)=19.418 | 1968.8 samples/s | 30.8 steps/s
[Step=92850 Epoch=357.4] | Loss=0.00014 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.129 | L2-Norm(final)=19.419 | 4474.5 samples/s | 69.9 steps/s
[Step=92900 Epoch=357.6] | Loss=0.00013 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.129 | L2-Norm(final)=19.419 | 4569.8 samples/s | 71.4 steps/s
[Step=92950 Epoch=357.8] | Loss=0.00011 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.128 | L2-Norm(final)=19.420 | 4474.8 samples/s | 69.9 steps/s
[Step=93000 Epoch=358.0] | Loss=0.00010 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.128 | L2-Norm(final)=19.421 | 5130.7 samples/s | 80.2 steps/s
[Step=93050 Epoch=358.2] | Loss=0.00010 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.128 | L2-Norm(final)=19.421 | 2052.6 samples/s | 32.1 steps/s
[Step=93100 Epoch=358.4] | Loss=0.00009 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.127 | L2-Norm(final)=19.422 | 4541.9 samples/s | 71.0 steps/s
[Step=93150 Epoch=358.6] | Loss=0.00008 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.127 | L2-Norm(final)=19.422 | 4568.7 samples/s | 71.4 steps/s
[Step=93200 Epoch=358.8] | Loss=0.00008 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.126 | L2-Norm(final)=19.422 | 4560.4 samples/s | 71.3 steps/s
[Step=93250 Epoch=359.0] | Loss=0.00007 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.126 | L2-Norm(final)=19.423 | 4588.0 samples/s | 71.7 steps/s
[Step=93300 Epoch=359.1] | Loss=0.00007 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.125 | L2-Norm(final)=19.423 | 2090.6 samples/s | 32.7 steps/s
[Step=93350 Epoch=359.3] | Loss=0.00007 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.124 | L2-Norm(final)=19.424 | 4593.3 samples/s | 71.8 steps/s
[Step=93400 Epoch=359.5] | Loss=0.00006 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.123 | L2-Norm(final)=19.424 | 4580.8 samples/s | 71.6 steps/s
[Step=93450 Epoch=359.7] | Loss=0.00006 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.123 | L2-Norm(final)=19.424 | 4477.4 samples/s | 70.0 steps/s
[Step=93500 Epoch=359.9] | Loss=0.00006 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.122 | L2-Norm(final)=19.425 | 4466.1 samples/s | 69.8 steps/s
[Step=93550 Epoch=360.1] | Loss=0.00005 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.121 | L2-Norm(final)=19.425 | 2106.9 samples/s | 32.9 steps/s
[Step=93600 Epoch=360.3] | Loss=0.00005 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.120 | L2-Norm(final)=19.425 | 4493.9 samples/s | 70.2 steps/s
[Step=93650 Epoch=360.5] | Loss=0.00005 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.120 | L2-Norm(final)=19.426 | 4484.0 samples/s | 70.1 steps/s
[Step=93700 Epoch=360.7] | Loss=0.00005 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.119 | L2-Norm(final)=19.426 | 4465.1 samples/s | 69.8 steps/s
[Step=93750 Epoch=360.9] | Loss=0.00005 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.118 | L2-Norm(final)=19.426 | 4571.7 samples/s | 71.4 steps/s
[Step=93800 Epoch=361.1] | Loss=0.00005 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.117 | L2-Norm(final)=19.427 | 6532.3 samples/s | 102.1 steps/s
[Step=93850 Epoch=361.3] | Loss=0.00004 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.116 | L2-Norm(final)=19.427 | 1882.5 samples/s | 29.4 steps/s
[Step=93900 Epoch=361.5] | Loss=0.00004 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.115 | L2-Norm(final)=19.427 | 4563.5 samples/s | 71.3 steps/s
[Step=93950 Epoch=361.7] | Loss=0.00004 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.114 | L2-Norm(final)=19.428 | 4621.1 samples/s | 72.2 steps/s
[Step=94000 Epoch=361.8] | Loss=0.00004 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.114 | L2-Norm(final)=19.428 | 4459.3 samples/s | 69.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step94000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05395 | acc=0.9714 | tpr=0.9798 | fpr=0.0468 | 4467.0 samples/s | 17.4 steps/s
Avg test loss: 0.05431, Avg test acc: 0.97099, Avg tpr: 0.97931, Avg fpr: 0.04730, total FA: 369

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05795 | acc=0.9693 | tpr=0.9723 | fpr=0.0372 | 4527.0 samples/s | 17.7 steps/s
Avg test loss: 0.05832, Avg test acc: 0.96951, Avg tpr: 0.97296, Avg fpr: 0.03807, total FA: 297

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.39170 | acc=0.3161 | tpr=0.0037 | fpr=0.0055 | 4474.1 samples/s | 17.5 steps/s
Avg test loss: 5.41393, Avg test acc: 0.31345, Avg tpr: 0.00437, Avg fpr: 0.00679, total FA: 53

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.96074 | acc=0.3127 | tpr=0.0082 | fpr=0.0260 | 4433.7 samples/s | 17.3 steps/s
Avg test loss: 4.97566, Avg test acc: 0.31076, Avg tpr: 0.00851, Avg fpr: 0.02448, total FA: 191

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.61316 | acc=0.1256 | tpr=0.7168 | fpr=0.8850 | 4492.0 samples/s | 17.5 steps/s
[Step= 100] | Loss=4.59729 | acc=0.1250 | tpr=0.7122 | fpr=0.8860 | 8107.4 samples/s | 31.7 steps/s
[Step= 150] | Loss=4.59953 | acc=0.1244 | tpr=0.7061 | fpr=0.8863 | 8566.9 samples/s | 33.5 steps/s
[Step= 200] | Loss=4.60264 | acc=0.1242 | tpr=0.6940 | fpr=0.8862 | 8751.1 samples/s | 34.2 steps/s
[Step= 250] | Loss=4.61079 | acc=0.1244 | tpr=0.6917 | fpr=0.8860 | 8173.5 samples/s | 31.9 steps/s
[Step= 300] | Loss=4.60854 | acc=0.1241 | tpr=0.6851 | fpr=0.8861 | 8220.3 samples/s | 32.1 steps/s
[Step= 350] | Loss=4.60795 | acc=0.1236 | tpr=0.6863 | fpr=0.8866 | 8502.4 samples/s | 33.2 steps/s
[Step= 400] | Loss=4.61264 | acc=0.1233 | tpr=0.6805 | fpr=0.8868 | 8451.9 samples/s | 33.0 steps/s
[Step= 450] | Loss=4.61573 | acc=0.1234 | tpr=0.6840 | fpr=0.8867 | 8385.5 samples/s | 32.8 steps/s
[Step= 500] | Loss=4.61545 | acc=0.1233 | tpr=0.6894 | fpr=0.8869 | 8223.9 samples/s | 32.1 steps/s
[Step= 550] | Loss=4.61878 | acc=0.1232 | tpr=0.6884 | fpr=0.8870 | 15650.7 samples/s | 61.1 steps/s
Avg test loss: 4.61882, Avg test acc: 0.12311, Avg tpr: 0.68899, Avg fpr: 0.88718, total FA: 123183

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.53390 | acc=0.1434 | tpr=0.6549 | fpr=0.8658 | 4388.1 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.51411 | acc=0.1422 | tpr=0.6525 | fpr=0.8673 | 8740.0 samples/s | 34.1 steps/s
[Step= 150] | Loss=4.51601 | acc=0.1410 | tpr=0.6556 | fpr=0.8685 | 8437.3 samples/s | 33.0 steps/s
[Step= 200] | Loss=4.51686 | acc=0.1404 | tpr=0.6393 | fpr=0.8686 | 8034.6 samples/s | 31.4 steps/s
[Step= 250] | Loss=4.52671 | acc=0.1404 | tpr=0.6428 | fpr=0.8687 | 8432.2 samples/s | 32.9 steps/s
[Step= 300] | Loss=4.52460 | acc=0.1401 | tpr=0.6393 | fpr=0.8690 | 8690.1 samples/s | 33.9 steps/s
[Step= 350] | Loss=4.52246 | acc=0.1393 | tpr=0.6349 | fpr=0.8697 | 8322.2 samples/s | 32.5 steps/s
[Step= 400] | Loss=4.52734 | acc=0.1392 | tpr=0.6313 | fpr=0.8698 | 8462.6 samples/s | 33.1 steps/s
[Step= 450] | Loss=4.52932 | acc=0.1393 | tpr=0.6349 | fpr=0.8697 | 8108.1 samples/s | 31.7 steps/s
[Step= 500] | Loss=4.52805 | acc=0.1393 | tpr=0.6427 | fpr=0.8698 | 8366.3 samples/s | 32.7 steps/s
[Step= 550] | Loss=4.53112 | acc=0.1391 | tpr=0.6383 | fpr=0.8700 | 15496.7 samples/s | 60.5 steps/s
Avg test loss: 4.53130, Avg test acc: 0.13894, Avg tpr: 0.63867, Avg fpr: 0.87015, total FA: 120818

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10423 | acc=0.9815 | tpr=0.9425 | fpr=0.0178 | 4485.6 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.10921 | acc=0.9812 | tpr=0.9574 | fpr=0.0183 | 8310.3 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.11276 | acc=0.9807 | tpr=0.9582 | fpr=0.0189 | 9150.6 samples/s | 35.7 steps/s
[Step= 200] | Loss=0.11394 | acc=0.9808 | tpr=0.9607 | fpr=0.0188 | 8015.8 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.11271 | acc=0.9808 | tpr=0.9598 | fpr=0.0188 | 8274.6 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.11396 | acc=0.9808 | tpr=0.9607 | fpr=0.0188 | 8333.8 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.11510 | acc=0.9805 | tpr=0.9599 | fpr=0.0191 | 8426.3 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.11616 | acc=0.9804 | tpr=0.9590 | fpr=0.0192 | 8532.9 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.11845 | acc=0.9802 | tpr=0.9576 | fpr=0.0194 | 8000.0 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.11812 | acc=0.9802 | tpr=0.9577 | fpr=0.0194 | 8676.2 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.11717 | acc=0.9802 | tpr=0.9550 | fpr=0.0193 | 14755.9 samples/s | 57.6 steps/s
Avg test loss: 0.11687, Avg test acc: 0.98026, Avg tpr: 0.95523, Avg fpr: 0.01929, total FA: 2678

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10894 | acc=0.9812 | tpr=0.9425 | fpr=0.0181 | 4405.4 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.11389 | acc=0.9812 | tpr=0.9638 | fpr=0.0185 | 8391.3 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.11842 | acc=0.9802 | tpr=0.9683 | fpr=0.0196 | 8352.8 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.11966 | acc=0.9804 | tpr=0.9716 | fpr=0.0195 | 8908.9 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.11888 | acc=0.9805 | tpr=0.9703 | fpr=0.0193 | 8064.2 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.12023 | acc=0.9804 | tpr=0.9709 | fpr=0.0194 | 8358.8 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.12134 | acc=0.9801 | tpr=0.9706 | fpr=0.0197 | 8428.2 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.12271 | acc=0.9800 | tpr=0.9694 | fpr=0.0198 | 8315.1 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.12491 | acc=0.9798 | tpr=0.9679 | fpr=0.0200 | 8306.8 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.12458 | acc=0.9797 | tpr=0.9678 | fpr=0.0201 | 8395.8 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.12355 | acc=0.9798 | tpr=0.9658 | fpr=0.0200 | 14935.9 samples/s | 58.3 steps/s
Avg test loss: 0.12324, Avg test acc: 0.97981, Avg tpr: 0.96593, Avg fpr: 0.01994, total FA: 2769

server round 47/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=94001 Epoch=183.3] | Loss=0.02203 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.193 | L2-Norm(final)=21.944 | 4041.3 samples/s | 63.1 steps/s
[Step=94050 Epoch=183.4] | Loss=0.02330 | Reg=0.00052 | acc=0.9531 | L2-Norm=7.194 | L2-Norm(final)=21.946 | 5421.0 samples/s | 84.7 steps/s
[Step=94100 Epoch=183.5] | Loss=0.02100 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.194 | L2-Norm(final)=21.950 | 5667.1 samples/s | 88.5 steps/s
[Step=94150 Epoch=183.6] | Loss=0.02009 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.194 | L2-Norm(final)=21.954 | 5564.2 samples/s | 86.9 steps/s
[Step=94200 Epoch=183.7] | Loss=0.01932 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.194 | L2-Norm(final)=21.958 | 5495.6 samples/s | 85.9 steps/s
[Step=94250 Epoch=183.8] | Loss=0.01948 | Reg=0.00052 | acc=0.9688 | L2-Norm=7.194 | L2-Norm(final)=21.961 | 5472.4 samples/s | 85.5 steps/s
[Step=94300 Epoch=183.9] | Loss=0.01919 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.194 | L2-Norm(final)=21.965 | 5472.7 samples/s | 85.5 steps/s
[Step=94350 Epoch=184.0] | Loss=0.01929 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.194 | L2-Norm(final)=21.969 | 5454.7 samples/s | 85.2 steps/s
[Step=94400 Epoch=184.1] | Loss=0.01903 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.194 | L2-Norm(final)=21.973 | 5541.2 samples/s | 86.6 steps/s
[Step=94450 Epoch=184.2] | Loss=0.01898 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.194 | L2-Norm(final)=21.977 | 5447.6 samples/s | 85.1 steps/s
[Step=94500 Epoch=184.3] | Loss=0.01880 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.194 | L2-Norm(final)=21.981 | 6977.3 samples/s | 109.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=94501 Epoch=184.3] | Loss=0.01767 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.194 | L2-Norm(final)=22.024 | 3989.2 samples/s | 62.3 steps/s
[Step=94550 Epoch=184.4] | Loss=0.01725 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.206 | L2-Norm(final)=22.030 | 4589.3 samples/s | 71.7 steps/s
[Step=94600 Epoch=184.5] | Loss=0.01677 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.216 | L2-Norm(final)=22.035 | 4706.1 samples/s | 73.5 steps/s
[Step=94650 Epoch=184.6] | Loss=0.01566 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.226 | L2-Norm(final)=22.039 | 4726.3 samples/s | 73.8 steps/s
[Step=94700 Epoch=184.7] | Loss=0.01516 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.236 | L2-Norm(final)=22.043 | 4733.2 samples/s | 74.0 steps/s
[Step=94750 Epoch=184.8] | Loss=0.01465 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.245 | L2-Norm(final)=22.048 | 4751.5 samples/s | 74.2 steps/s
[Step=94800 Epoch=184.9] | Loss=0.01450 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.253 | L2-Norm(final)=22.052 | 4731.0 samples/s | 73.9 steps/s
[Step=94850 Epoch=185.0] | Loss=0.01444 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.261 | L2-Norm(final)=22.056 | 4800.9 samples/s | 75.0 steps/s
[Step=94900 Epoch=185.1] | Loss=0.01422 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.269 | L2-Norm(final)=22.060 | 4759.4 samples/s | 74.4 steps/s
[Step=94950 Epoch=185.2] | Loss=0.01390 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.276 | L2-Norm(final)=22.064 | 4820.3 samples/s | 75.3 steps/s
[Step=95000 Epoch=185.3] | Loss=0.01366 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.283 | L2-Norm(final)=22.067 | 5848.0 samples/s | 91.4 steps/s
[Step=95050 Epoch=185.4] | Loss=0.01310 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.290 | L2-Norm(final)=22.071 | 1920.6 samples/s | 30.0 steps/s
[Step=95100 Epoch=185.5] | Loss=0.01267 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.296 | L2-Norm(final)=22.075 | 4714.2 samples/s | 73.7 steps/s
[Step=95150 Epoch=185.6] | Loss=0.01241 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.302 | L2-Norm(final)=22.078 | 4742.9 samples/s | 74.1 steps/s
[Step=95200 Epoch=185.7] | Loss=0.01232 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.308 | L2-Norm(final)=22.082 | 4745.4 samples/s | 74.1 steps/s
[Step=95250 Epoch=185.8] | Loss=0.01218 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.314 | L2-Norm(final)=22.086 | 4758.6 samples/s | 74.4 steps/s
[Step=95300 Epoch=185.9] | Loss=0.01201 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.320 | L2-Norm(final)=22.089 | 4769.2 samples/s | 74.5 steps/s
[Step=95350 Epoch=186.0] | Loss=0.01181 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.325 | L2-Norm(final)=22.092 | 4765.6 samples/s | 74.5 steps/s
[Step=95400 Epoch=186.1] | Loss=0.01156 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.330 | L2-Norm(final)=22.095 | 4789.0 samples/s | 74.8 steps/s
[Step=95450 Epoch=186.2] | Loss=0.01142 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.335 | L2-Norm(final)=22.099 | 4824.7 samples/s | 75.4 steps/s
[Step=95500 Epoch=186.3] | Loss=0.01124 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.340 | L2-Norm(final)=22.102 | 4961.1 samples/s | 77.5 steps/s
[Step=95550 Epoch=186.4] | Loss=0.01109 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.345 | L2-Norm(final)=22.105 | 2085.8 samples/s | 32.6 steps/s
[Step=95600 Epoch=186.5] | Loss=0.01086 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.350 | L2-Norm(final)=22.108 | 4791.4 samples/s | 74.9 steps/s
[Step=95650 Epoch=186.6] | Loss=0.01072 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.355 | L2-Norm(final)=22.111 | 4758.9 samples/s | 74.4 steps/s
[Step=95700 Epoch=186.7] | Loss=0.01054 | Reg=0.00054 | acc=0.9688 | L2-Norm=7.359 | L2-Norm(final)=22.114 | 4739.2 samples/s | 74.1 steps/s
[Step=95750 Epoch=186.7] | Loss=0.01048 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.364 | L2-Norm(final)=22.117 | 4754.2 samples/s | 74.3 steps/s
[Step=95800 Epoch=186.8] | Loss=0.01039 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.368 | L2-Norm(final)=22.120 | 4747.1 samples/s | 74.2 steps/s
[Step=95850 Epoch=186.9] | Loss=0.01031 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.372 | L2-Norm(final)=22.123 | 4745.2 samples/s | 74.1 steps/s
[Step=95900 Epoch=187.0] | Loss=0.01026 | Reg=0.00054 | acc=0.9688 | L2-Norm=7.377 | L2-Norm(final)=22.126 | 4746.5 samples/s | 74.2 steps/s
[Step=95950 Epoch=187.1] | Loss=0.01020 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.381 | L2-Norm(final)=22.129 | 4778.0 samples/s | 74.7 steps/s
[Step=96000 Epoch=187.2] | Loss=0.01009 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.385 | L2-Norm(final)=22.131 | 4707.3 samples/s | 73.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step96000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=94001 Epoch=183.8] | Loss=0.01169 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.193 | L2-Norm(final)=22.710 | 4441.9 samples/s | 69.4 steps/s
[Step=94050 Epoch=183.9] | Loss=0.01822 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.194 | L2-Norm(final)=22.713 | 5104.6 samples/s | 79.8 steps/s
[Step=94100 Epoch=184.0] | Loss=0.01923 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.194 | L2-Norm(final)=22.715 | 5408.3 samples/s | 84.5 steps/s
[Step=94150 Epoch=184.1] | Loss=0.01883 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.194 | L2-Norm(final)=22.717 | 5448.0 samples/s | 85.1 steps/s
[Step=94200 Epoch=184.2] | Loss=0.01861 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.194 | L2-Norm(final)=22.719 | 5563.5 samples/s | 86.9 steps/s
[Step=94250 Epoch=184.3] | Loss=0.01847 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.194 | L2-Norm(final)=22.722 | 5345.7 samples/s | 83.5 steps/s
[Step=94300 Epoch=184.4] | Loss=0.01856 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.194 | L2-Norm(final)=22.724 | 5414.6 samples/s | 84.6 steps/s
[Step=94350 Epoch=184.5] | Loss=0.01850 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.194 | L2-Norm(final)=22.727 | 5504.6 samples/s | 86.0 steps/s
[Step=94400 Epoch=184.5] | Loss=0.01861 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.194 | L2-Norm(final)=22.729 | 5695.9 samples/s | 89.0 steps/s
[Step=94450 Epoch=184.6] | Loss=0.01862 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.194 | L2-Norm(final)=22.732 | 5542.8 samples/s | 86.6 steps/s
[Step=94500 Epoch=184.7] | Loss=0.01865 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.194 | L2-Norm(final)=22.734 | 7135.5 samples/s | 111.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=94501 Epoch=184.7] | Loss=0.00700 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.194 | L2-Norm(final)=22.761 | 4408.8 samples/s | 68.9 steps/s
[Step=94550 Epoch=184.8] | Loss=0.01572 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.206 | L2-Norm(final)=22.765 | 4516.2 samples/s | 70.6 steps/s
[Step=94600 Epoch=184.9] | Loss=0.01596 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.216 | L2-Norm(final)=22.769 | 4785.3 samples/s | 74.8 steps/s
[Step=94650 Epoch=185.0] | Loss=0.01531 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.227 | L2-Norm(final)=22.773 | 4732.0 samples/s | 73.9 steps/s
[Step=94700 Epoch=185.1] | Loss=0.01472 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.237 | L2-Norm(final)=22.777 | 4730.8 samples/s | 73.9 steps/s
[Step=94750 Epoch=185.2] | Loss=0.01461 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.246 | L2-Norm(final)=22.780 | 4714.2 samples/s | 73.7 steps/s
[Step=94800 Epoch=185.3] | Loss=0.01422 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.255 | L2-Norm(final)=22.784 | 4760.5 samples/s | 74.4 steps/s
[Step=94850 Epoch=185.4] | Loss=0.01408 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.263 | L2-Norm(final)=22.788 | 4669.7 samples/s | 73.0 steps/s
[Step=94900 Epoch=185.5] | Loss=0.01358 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.270 | L2-Norm(final)=22.791 | 4841.0 samples/s | 75.6 steps/s
[Step=94950 Epoch=185.6] | Loss=0.01337 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.277 | L2-Norm(final)=22.794 | 4813.4 samples/s | 75.2 steps/s
[Step=95000 Epoch=185.7] | Loss=0.01312 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.284 | L2-Norm(final)=22.798 | 5918.1 samples/s | 92.5 steps/s
[Step=95050 Epoch=185.8] | Loss=0.01266 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.291 | L2-Norm(final)=22.801 | 2031.6 samples/s | 31.7 steps/s
[Step=95100 Epoch=185.9] | Loss=0.01223 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.297 | L2-Norm(final)=22.805 | 4780.4 samples/s | 74.7 steps/s
[Step=95150 Epoch=186.0] | Loss=0.01200 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.303 | L2-Norm(final)=22.808 | 4694.3 samples/s | 73.3 steps/s
[Step=95200 Epoch=186.1] | Loss=0.01183 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.309 | L2-Norm(final)=22.811 | 4765.9 samples/s | 74.5 steps/s
[Step=95250 Epoch=186.2] | Loss=0.01161 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.315 | L2-Norm(final)=22.814 | 4792.9 samples/s | 74.9 steps/s
[Step=95300 Epoch=186.3] | Loss=0.01149 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.321 | L2-Norm(final)=22.817 | 4811.1 samples/s | 75.2 steps/s
[Step=95350 Epoch=186.4] | Loss=0.01130 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.326 | L2-Norm(final)=22.821 | 4792.5 samples/s | 74.9 steps/s
[Step=95400 Epoch=186.5] | Loss=0.01109 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.332 | L2-Norm(final)=22.824 | 4768.0 samples/s | 74.5 steps/s
[Step=95450 Epoch=186.6] | Loss=0.01092 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.337 | L2-Norm(final)=22.827 | 4774.8 samples/s | 74.6 steps/s
[Step=95500 Epoch=186.7] | Loss=0.01079 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.342 | L2-Norm(final)=22.830 | 5124.6 samples/s | 80.1 steps/s
[Step=95550 Epoch=186.8] | Loss=0.01061 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.347 | L2-Norm(final)=22.833 | 2116.1 samples/s | 33.1 steps/s
[Step=95600 Epoch=186.9] | Loss=0.01043 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.351 | L2-Norm(final)=22.835 | 4829.4 samples/s | 75.5 steps/s
[Step=95650 Epoch=187.0] | Loss=0.01025 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.356 | L2-Norm(final)=22.838 | 4832.6 samples/s | 75.5 steps/s
[Step=95700 Epoch=187.1] | Loss=0.01009 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.360 | L2-Norm(final)=22.841 | 4763.0 samples/s | 74.4 steps/s
[Step=95750 Epoch=187.2] | Loss=0.00993 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.365 | L2-Norm(final)=22.844 | 4738.0 samples/s | 74.0 steps/s
[Step=95800 Epoch=187.3] | Loss=0.00983 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.369 | L2-Norm(final)=22.847 | 4745.7 samples/s | 74.2 steps/s
[Step=95850 Epoch=187.4] | Loss=0.00972 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.373 | L2-Norm(final)=22.849 | 4743.1 samples/s | 74.1 steps/s
[Step=95900 Epoch=187.5] | Loss=0.00961 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.377 | L2-Norm(final)=22.852 | 4768.3 samples/s | 74.5 steps/s
[Step=95950 Epoch=187.6] | Loss=0.00954 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.382 | L2-Norm(final)=22.855 | 4803.0 samples/s | 75.0 steps/s
[Step=96000 Epoch=187.7] | Loss=0.00947 | Reg=0.00055 | acc=0.9844 | L2-Norm=7.386 | L2-Norm(final)=22.857 | 4812.3 samples/s | 75.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step96000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=94001 Epoch=360.2] | Loss=0.00001 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.193 | L2-Norm(final)=20.188 | 4306.2 samples/s | 67.3 steps/s
[Step=94050 Epoch=360.4] | Loss=0.00002 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.192 | L2-Norm(final)=20.189 | 4724.4 samples/s | 73.8 steps/s
[Step=94100 Epoch=360.6] | Loss=0.00002 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.192 | L2-Norm(final)=20.190 | 5189.9 samples/s | 81.1 steps/s
[Step=94150 Epoch=360.7] | Loss=0.00002 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.192 | L2-Norm(final)=20.191 | 5317.5 samples/s | 83.1 steps/s
[Step=94200 Epoch=360.9] | Loss=0.00002 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.192 | L2-Norm(final)=20.192 | 5035.0 samples/s | 78.7 steps/s
[Step=94250 Epoch=361.1] | Loss=0.00002 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.192 | L2-Norm(final)=20.194 | 6756.2 samples/s | 105.6 steps/s
[Step=94300 Epoch=361.3] | Loss=0.00002 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.192 | L2-Norm(final)=20.195 | 2055.0 samples/s | 32.1 steps/s
[Step=94350 Epoch=361.5] | Loss=0.00002 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.192 | L2-Norm(final)=20.196 | 5135.4 samples/s | 80.2 steps/s
[Step=94400 Epoch=361.7] | Loss=0.00002 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.192 | L2-Norm(final)=20.198 | 5145.5 samples/s | 80.4 steps/s
[Step=94450 Epoch=361.9] | Loss=0.00002 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.192 | L2-Norm(final)=20.199 | 5113.7 samples/s | 79.9 steps/s
[Step=94500 Epoch=362.1] | Loss=0.00002 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.192 | L2-Norm(final)=20.201 | 5783.1 samples/s | 90.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=94501 Epoch=362.1] | Loss=0.00002 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.192 | L2-Norm(final)=20.214 | 4064.5 samples/s | 63.5 steps/s
[Step=94550 Epoch=362.3] | Loss=0.00001 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.181 | L2-Norm(final)=20.216 | 4487.2 samples/s | 70.1 steps/s
[Step=94600 Epoch=362.5] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.172 | L2-Norm(final)=20.217 | 4558.7 samples/s | 71.2 steps/s
[Step=94650 Epoch=362.7] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.165 | L2-Norm(final)=20.219 | 4531.5 samples/s | 70.8 steps/s
[Step=94700 Epoch=362.9] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.158 | L2-Norm(final)=20.220 | 4568.2 samples/s | 71.4 steps/s
[Step=94750 Epoch=363.0] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.151 | L2-Norm(final)=20.221 | 5571.0 samples/s | 87.0 steps/s
[Step=94800 Epoch=363.2] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.144 | L2-Norm(final)=20.222 | 1929.9 samples/s | 30.2 steps/s
[Step=94850 Epoch=363.4] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.137 | L2-Norm(final)=20.222 | 4532.4 samples/s | 70.8 steps/s
[Step=94900 Epoch=363.6] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.131 | L2-Norm(final)=20.223 | 4585.7 samples/s | 71.7 steps/s
[Step=94950 Epoch=363.8] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.124 | L2-Norm(final)=20.224 | 4620.5 samples/s | 72.2 steps/s
[Step=95000 Epoch=364.0] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.117 | L2-Norm(final)=20.224 | 4993.5 samples/s | 78.0 steps/s
[Step=95050 Epoch=364.2] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.110 | L2-Norm(final)=20.225 | 2018.9 samples/s | 31.5 steps/s
[Step=95100 Epoch=364.4] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.104 | L2-Norm(final)=20.225 | 4586.3 samples/s | 71.7 steps/s
[Step=95150 Epoch=364.6] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.097 | L2-Norm(final)=20.226 | 4496.0 samples/s | 70.3 steps/s
[Step=95200 Epoch=364.8] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.090 | L2-Norm(final)=20.226 | 4555.0 samples/s | 71.2 steps/s
[Step=95250 Epoch=365.0] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.084 | L2-Norm(final)=20.227 | 4516.2 samples/s | 70.6 steps/s
[Step=95300 Epoch=365.2] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.077 | L2-Norm(final)=20.228 | 2134.2 samples/s | 33.3 steps/s
[Step=95350 Epoch=365.3] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.070 | L2-Norm(final)=20.228 | 4682.9 samples/s | 73.2 steps/s
[Step=95400 Epoch=365.5] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.063 | L2-Norm(final)=20.229 | 4736.3 samples/s | 74.0 steps/s
[Step=95450 Epoch=365.7] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.056 | L2-Norm(final)=20.229 | 4614.2 samples/s | 72.1 steps/s
[Step=95500 Epoch=365.9] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.049 | L2-Norm(final)=20.230 | 4628.5 samples/s | 72.3 steps/s
[Step=95550 Epoch=366.1] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.042 | L2-Norm(final)=20.230 | 2128.1 samples/s | 33.3 steps/s
[Step=95600 Epoch=366.3] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.035 | L2-Norm(final)=20.231 | 4513.4 samples/s | 70.5 steps/s
[Step=95650 Epoch=366.5] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.028 | L2-Norm(final)=20.231 | 4440.4 samples/s | 69.4 steps/s
[Step=95700 Epoch=366.7] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.021 | L2-Norm(final)=20.232 | 4490.9 samples/s | 70.2 steps/s
[Step=95750 Epoch=366.9] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.014 | L2-Norm(final)=20.232 | 4485.9 samples/s | 70.1 steps/s
[Step=95800 Epoch=367.1] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.007 | L2-Norm(final)=20.233 | 6134.4 samples/s | 95.8 steps/s
[Step=95850 Epoch=367.3] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.000 | L2-Norm(final)=20.233 | 1878.2 samples/s | 29.3 steps/s
[Step=95900 Epoch=367.5] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.992 | L2-Norm(final)=20.234 | 4489.2 samples/s | 70.1 steps/s
[Step=95950 Epoch=367.6] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.985 | L2-Norm(final)=20.235 | 4548.1 samples/s | 71.1 steps/s
[Step=96000 Epoch=367.8] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.978 | L2-Norm(final)=20.235 | 4545.8 samples/s | 71.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step96000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=94001 Epoch=361.8] | Loss=0.00004 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.193 | L2-Norm(final)=19.437 | 4298.9 samples/s | 67.2 steps/s
[Step=94050 Epoch=362.0] | Loss=0.00010 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.193 | L2-Norm(final)=19.439 | 4682.6 samples/s | 73.2 steps/s
[Step=94100 Epoch=362.2] | Loss=0.00009 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.193 | L2-Norm(final)=19.440 | 5044.8 samples/s | 78.8 steps/s
[Step=94150 Epoch=362.4] | Loss=0.00011 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.193 | L2-Norm(final)=19.442 | 5226.1 samples/s | 81.7 steps/s
[Step=94200 Epoch=362.6] | Loss=0.00011 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.193 | L2-Norm(final)=19.445 | 5008.0 samples/s | 78.3 steps/s
[Step=94250 Epoch=362.8] | Loss=0.00011 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.193 | L2-Norm(final)=19.447 | 6877.5 samples/s | 107.5 steps/s
[Step=94300 Epoch=363.0] | Loss=0.00010 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.193 | L2-Norm(final)=19.449 | 2048.0 samples/s | 32.0 steps/s
[Step=94350 Epoch=363.2] | Loss=0.00011 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.193 | L2-Norm(final)=19.451 | 5118.4 samples/s | 80.0 steps/s
[Step=94400 Epoch=363.4] | Loss=0.00011 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.193 | L2-Norm(final)=19.453 | 5279.5 samples/s | 82.5 steps/s
[Step=94450 Epoch=363.6] | Loss=0.00011 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.193 | L2-Norm(final)=19.455 | 5100.4 samples/s | 79.7 steps/s
[Step=94500 Epoch=363.8] | Loss=0.00011 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.193 | L2-Norm(final)=19.457 | 5969.9 samples/s | 93.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=94501 Epoch=363.8] | Loss=0.00002 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.193 | L2-Norm(final)=19.479 | 4320.4 samples/s | 67.5 steps/s
[Step=94550 Epoch=364.0] | Loss=0.00019 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.193 | L2-Norm(final)=19.481 | 4325.5 samples/s | 67.6 steps/s
[Step=94600 Epoch=364.2] | Loss=0.00011 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.195 | L2-Norm(final)=19.484 | 4452.8 samples/s | 69.6 steps/s
[Step=94650 Epoch=364.3] | Loss=0.00010 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.195 | L2-Norm(final)=19.486 | 4558.8 samples/s | 71.2 steps/s
[Step=94700 Epoch=364.5] | Loss=0.00008 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.195 | L2-Norm(final)=19.487 | 4509.4 samples/s | 70.5 steps/s
[Step=94750 Epoch=364.7] | Loss=0.00007 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.194 | L2-Norm(final)=19.488 | 5787.3 samples/s | 90.4 steps/s
[Step=94800 Epoch=364.9] | Loss=0.00006 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.193 | L2-Norm(final)=19.490 | 1947.8 samples/s | 30.4 steps/s
[Step=94850 Epoch=365.1] | Loss=0.00005 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.191 | L2-Norm(final)=19.491 | 4488.5 samples/s | 70.1 steps/s
[Step=94900 Epoch=365.3] | Loss=0.00005 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.190 | L2-Norm(final)=19.491 | 4488.5 samples/s | 70.1 steps/s
[Step=94950 Epoch=365.5] | Loss=0.00004 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.189 | L2-Norm(final)=19.492 | 4529.8 samples/s | 70.8 steps/s
[Step=95000 Epoch=365.7] | Loss=0.00004 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.187 | L2-Norm(final)=19.493 | 5059.0 samples/s | 79.0 steps/s
[Step=95050 Epoch=365.9] | Loss=0.00004 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.185 | L2-Norm(final)=19.493 | 2033.3 samples/s | 31.8 steps/s
[Step=95100 Epoch=366.1] | Loss=0.00003 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.184 | L2-Norm(final)=19.494 | 4646.3 samples/s | 72.6 steps/s
[Step=95150 Epoch=366.3] | Loss=0.00003 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.182 | L2-Norm(final)=19.495 | 4499.7 samples/s | 70.3 steps/s
[Step=95200 Epoch=366.5] | Loss=0.00003 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.180 | L2-Norm(final)=19.495 | 4538.5 samples/s | 70.9 steps/s
[Step=95250 Epoch=366.7] | Loss=0.00003 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.179 | L2-Norm(final)=19.496 | 4618.0 samples/s | 72.2 steps/s
[Step=95300 Epoch=366.8] | Loss=0.00003 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.177 | L2-Norm(final)=19.496 | 2071.5 samples/s | 32.4 steps/s
[Step=95350 Epoch=367.0] | Loss=0.00003 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.175 | L2-Norm(final)=19.497 | 4552.8 samples/s | 71.1 steps/s
[Step=95400 Epoch=367.2] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.173 | L2-Norm(final)=19.497 | 4486.9 samples/s | 70.1 steps/s
[Step=95450 Epoch=367.4] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.171 | L2-Norm(final)=19.498 | 4534.9 samples/s | 70.9 steps/s
[Step=95500 Epoch=367.6] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.169 | L2-Norm(final)=19.498 | 4445.4 samples/s | 69.5 steps/s
[Step=95550 Epoch=367.8] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.168 | L2-Norm(final)=19.499 | 2075.6 samples/s | 32.4 steps/s
[Step=95600 Epoch=368.0] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.166 | L2-Norm(final)=19.499 | 4594.0 samples/s | 71.8 steps/s
[Step=95650 Epoch=368.2] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.164 | L2-Norm(final)=19.499 | 4531.2 samples/s | 70.8 steps/s
[Step=95700 Epoch=368.4] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.162 | L2-Norm(final)=19.500 | 4490.1 samples/s | 70.2 steps/s
[Step=95750 Epoch=368.6] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.160 | L2-Norm(final)=19.500 | 4554.4 samples/s | 71.2 steps/s
[Step=95800 Epoch=368.8] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.158 | L2-Norm(final)=19.501 | 6485.7 samples/s | 101.3 steps/s
[Step=95850 Epoch=369.0] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.156 | L2-Norm(final)=19.501 | 1833.3 samples/s | 28.6 steps/s
[Step=95900 Epoch=369.2] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.153 | L2-Norm(final)=19.502 | 4511.9 samples/s | 70.5 steps/s
[Step=95950 Epoch=369.3] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.151 | L2-Norm(final)=19.502 | 4437.2 samples/s | 69.3 steps/s
[Step=96000 Epoch=369.5] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.149 | L2-Norm(final)=19.502 | 4485.9 samples/s | 70.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step96000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05591 | acc=0.9706 | tpr=0.9785 | fpr=0.0466 | 4424.3 samples/s | 17.3 steps/s
Avg test loss: 0.05677, Avg test acc: 0.97039, Avg tpr: 0.97832, Avg fpr: 0.04705, total FA: 367

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05682 | acc=0.9711 | tpr=0.9774 | fpr=0.0426 | 4568.7 samples/s | 17.8 steps/s
Avg test loss: 0.05779, Avg test acc: 0.97087, Avg tpr: 0.97709, Avg fpr: 0.04282, total FA: 334

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.25814 | acc=0.3159 | tpr=0.0058 | fpr=0.0109 | 4407.7 samples/s | 17.2 steps/s
Avg test loss: 5.27732, Avg test acc: 0.31345, Avg tpr: 0.00641, Avg fpr: 0.01128, total FA: 88

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.09531 | acc=0.3116 | tpr=0.0082 | fpr=0.0295 | 4406.6 samples/s | 17.2 steps/s
Avg test loss: 5.10985, Avg test acc: 0.30932, Avg tpr: 0.00857, Avg fpr: 0.02923, total FA: 228

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.78442 | acc=0.1298 | tpr=0.7389 | fpr=0.8812 | 4453.2 samples/s | 17.4 steps/s
[Step= 100] | Loss=4.76718 | acc=0.1288 | tpr=0.7228 | fpr=0.8823 | 8380.8 samples/s | 32.7 steps/s
[Step= 150] | Loss=4.77128 | acc=0.1282 | tpr=0.7161 | fpr=0.8826 | 8826.2 samples/s | 34.5 steps/s
[Step= 200] | Loss=4.77374 | acc=0.1277 | tpr=0.7049 | fpr=0.8828 | 8032.0 samples/s | 31.4 steps/s
[Step= 250] | Loss=4.78256 | acc=0.1278 | tpr=0.7083 | fpr=0.8828 | 8780.0 samples/s | 34.3 steps/s
[Step= 300] | Loss=4.77989 | acc=0.1277 | tpr=0.7076 | fpr=0.8828 | 8176.7 samples/s | 31.9 steps/s
[Step= 350] | Loss=4.77948 | acc=0.1272 | tpr=0.7057 | fpr=0.8833 | 8589.1 samples/s | 33.6 steps/s
[Step= 400] | Loss=4.78457 | acc=0.1267 | tpr=0.6997 | fpr=0.8837 | 8134.7 samples/s | 31.8 steps/s
[Step= 450] | Loss=4.78849 | acc=0.1267 | tpr=0.7040 | fpr=0.8838 | 8352.5 samples/s | 32.6 steps/s
[Step= 500] | Loss=4.78802 | acc=0.1265 | tpr=0.7106 | fpr=0.8841 | 8699.9 samples/s | 34.0 steps/s
[Step= 550] | Loss=4.79142 | acc=0.1266 | tpr=0.7087 | fpr=0.8840 | 14439.6 samples/s | 56.4 steps/s
Avg test loss: 4.79144, Avg test acc: 0.12647, Avg tpr: 0.70919, Avg fpr: 0.88413, total FA: 122759

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.92389 | acc=0.1352 | tpr=0.6903 | fpr=0.8748 | 4415.5 samples/s | 17.2 steps/s
[Step= 100] | Loss=4.90229 | acc=0.1362 | tpr=0.6994 | fpr=0.8743 | 8339.1 samples/s | 32.6 steps/s
[Step= 150] | Loss=4.90361 | acc=0.1347 | tpr=0.6945 | fpr=0.8756 | 8594.8 samples/s | 33.6 steps/s
[Step= 200] | Loss=4.90459 | acc=0.1337 | tpr=0.6754 | fpr=0.8761 | 8460.3 samples/s | 33.0 steps/s
[Step= 250] | Loss=4.91470 | acc=0.1334 | tpr=0.6777 | fpr=0.8765 | 8012.8 samples/s | 31.3 steps/s
[Step= 300] | Loss=4.91233 | acc=0.1331 | tpr=0.6720 | fpr=0.8768 | 8409.0 samples/s | 32.8 steps/s
[Step= 350] | Loss=4.90997 | acc=0.1322 | tpr=0.6694 | fpr=0.8775 | 8308.7 samples/s | 32.5 steps/s
[Step= 400] | Loss=4.91525 | acc=0.1321 | tpr=0.6685 | fpr=0.8776 | 8539.2 samples/s | 33.4 steps/s
[Step= 450] | Loss=4.91771 | acc=0.1321 | tpr=0.6699 | fpr=0.8776 | 8196.7 samples/s | 32.0 steps/s
[Step= 500] | Loss=4.91639 | acc=0.1320 | tpr=0.6762 | fpr=0.8778 | 8600.8 samples/s | 33.6 steps/s
[Step= 550] | Loss=4.91980 | acc=0.1319 | tpr=0.6713 | fpr=0.8779 | 15204.7 samples/s | 59.4 steps/s
Avg test loss: 4.91998, Avg test acc: 0.13182, Avg tpr: 0.67195, Avg fpr: 0.87800, total FA: 121909

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10268 | acc=0.9813 | tpr=0.9425 | fpr=0.0180 | 4393.3 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.10748 | acc=0.9810 | tpr=0.9616 | fpr=0.0186 | 8181.5 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.11077 | acc=0.9804 | tpr=0.9611 | fpr=0.0193 | 8537.6 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.11199 | acc=0.9804 | tpr=0.9628 | fpr=0.0193 | 8213.8 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.11100 | acc=0.9805 | tpr=0.9616 | fpr=0.0191 | 8517.0 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.11217 | acc=0.9804 | tpr=0.9622 | fpr=0.0192 | 8534.0 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.11332 | acc=0.9803 | tpr=0.9618 | fpr=0.0194 | 8226.0 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.11442 | acc=0.9802 | tpr=0.9606 | fpr=0.0195 | 8270.9 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.11658 | acc=0.9799 | tpr=0.9591 | fpr=0.0197 | 8487.4 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.11622 | acc=0.9799 | tpr=0.9595 | fpr=0.0197 | 8401.8 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.11529 | acc=0.9800 | tpr=0.9574 | fpr=0.0196 | 15257.7 samples/s | 59.6 steps/s
Avg test loss: 0.11500, Avg test acc: 0.97998, Avg tpr: 0.95761, Avg fpr: 0.01961, total FA: 2723

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11104 | acc=0.9813 | tpr=0.9425 | fpr=0.0180 | 4498.6 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.11621 | acc=0.9811 | tpr=0.9638 | fpr=0.0186 | 8187.2 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.12068 | acc=0.9803 | tpr=0.9669 | fpr=0.0194 | 8250.1 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.12165 | acc=0.9805 | tpr=0.9683 | fpr=0.0193 | 8357.2 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.12083 | acc=0.9806 | tpr=0.9677 | fpr=0.0191 | 8414.8 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.12207 | acc=0.9806 | tpr=0.9695 | fpr=0.0192 | 8543.5 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.12316 | acc=0.9803 | tpr=0.9681 | fpr=0.0195 | 8119.2 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.12457 | acc=0.9802 | tpr=0.9677 | fpr=0.0196 | 8516.5 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.12692 | acc=0.9800 | tpr=0.9659 | fpr=0.0198 | 8290.2 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.12654 | acc=0.9800 | tpr=0.9656 | fpr=0.0198 | 8306.3 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.12545 | acc=0.9800 | tpr=0.9642 | fpr=0.0197 | 15273.8 samples/s | 59.7 steps/s
Avg test loss: 0.12518, Avg test acc: 0.98005, Avg tpr: 0.96434, Avg fpr: 0.01967, total FA: 2731

server round 48/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=96001 Epoch=187.2] | Loss=0.00984 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.166 | L2-Norm(final)=22.215 | 3998.1 samples/s | 62.5 steps/s
[Step=96050 Epoch=187.3] | Loss=0.01582 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.167 | L2-Norm(final)=22.219 | 5434.9 samples/s | 84.9 steps/s
[Step=96100 Epoch=187.4] | Loss=0.01502 | Reg=0.00051 | acc=0.9688 | L2-Norm=7.167 | L2-Norm(final)=22.224 | 5460.5 samples/s | 85.3 steps/s
[Step=96150 Epoch=187.5] | Loss=0.01542 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.167 | L2-Norm(final)=22.229 | 5435.4 samples/s | 84.9 steps/s
[Step=96200 Epoch=187.6] | Loss=0.01545 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.167 | L2-Norm(final)=22.235 | 5378.5 samples/s | 84.0 steps/s
[Step=96250 Epoch=187.7] | Loss=0.01514 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.167 | L2-Norm(final)=22.240 | 5456.4 samples/s | 85.3 steps/s
[Step=96300 Epoch=187.8] | Loss=0.01534 | Reg=0.00051 | acc=0.9531 | L2-Norm=7.168 | L2-Norm(final)=22.245 | 5422.9 samples/s | 84.7 steps/s
[Step=96350 Epoch=187.9] | Loss=0.01556 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.168 | L2-Norm(final)=22.250 | 5446.3 samples/s | 85.1 steps/s
[Step=96400 Epoch=188.0] | Loss=0.01538 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.168 | L2-Norm(final)=22.255 | 5525.1 samples/s | 86.3 steps/s
[Step=96450 Epoch=188.1] | Loss=0.01547 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.168 | L2-Norm(final)=22.261 | 5439.4 samples/s | 85.0 steps/s
[Step=96500 Epoch=188.2] | Loss=0.01547 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.168 | L2-Norm(final)=22.266 | 7135.2 samples/s | 111.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=96501 Epoch=188.2] | Loss=0.01158 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.168 | L2-Norm(final)=22.318 | 3976.5 samples/s | 62.1 steps/s
[Step=96550 Epoch=188.3] | Loss=0.01447 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.178 | L2-Norm(final)=22.323 | 4691.0 samples/s | 73.3 steps/s
[Step=96600 Epoch=188.4] | Loss=0.01423 | Reg=0.00052 | acc=0.9531 | L2-Norm=7.188 | L2-Norm(final)=22.328 | 4821.7 samples/s | 75.3 steps/s
[Step=96650 Epoch=188.5] | Loss=0.01450 | Reg=0.00052 | acc=0.9688 | L2-Norm=7.199 | L2-Norm(final)=22.332 | 4686.0 samples/s | 73.2 steps/s
[Step=96700 Epoch=188.6] | Loss=0.01359 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.208 | L2-Norm(final)=22.337 | 4722.0 samples/s | 73.8 steps/s
[Step=96750 Epoch=188.7] | Loss=0.01372 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.217 | L2-Norm(final)=22.341 | 4754.8 samples/s | 74.3 steps/s
[Step=96800 Epoch=188.8] | Loss=0.01332 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.225 | L2-Norm(final)=22.345 | 4777.8 samples/s | 74.7 steps/s
[Step=96850 Epoch=188.9] | Loss=0.01316 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.233 | L2-Norm(final)=22.349 | 4692.3 samples/s | 73.3 steps/s
[Step=96900 Epoch=189.0] | Loss=0.01272 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.240 | L2-Norm(final)=22.353 | 4717.0 samples/s | 73.7 steps/s
[Step=96950 Epoch=189.1] | Loss=0.01252 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.247 | L2-Norm(final)=22.356 | 4707.9 samples/s | 73.6 steps/s
[Step=97000 Epoch=189.2] | Loss=0.01250 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.253 | L2-Norm(final)=22.360 | 5824.0 samples/s | 91.0 steps/s
[Step=97050 Epoch=189.3] | Loss=0.01212 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.259 | L2-Norm(final)=22.363 | 1992.3 samples/s | 31.1 steps/s
[Step=97100 Epoch=189.4] | Loss=0.01194 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.265 | L2-Norm(final)=22.367 | 4761.9 samples/s | 74.4 steps/s
[Step=97150 Epoch=189.5] | Loss=0.01170 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.270 | L2-Norm(final)=22.370 | 4729.5 samples/s | 73.9 steps/s
[Step=97200 Epoch=189.6] | Loss=0.01143 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.276 | L2-Norm(final)=22.373 | 4714.2 samples/s | 73.7 steps/s
[Step=97250 Epoch=189.7] | Loss=0.01131 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.281 | L2-Norm(final)=22.377 | 4767.0 samples/s | 74.5 steps/s
[Step=97300 Epoch=189.8] | Loss=0.01115 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.286 | L2-Norm(final)=22.380 | 4695.8 samples/s | 73.4 steps/s
[Step=97350 Epoch=189.9] | Loss=0.01094 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.291 | L2-Norm(final)=22.383 | 4784.1 samples/s | 74.8 steps/s
[Step=97400 Epoch=190.0] | Loss=0.01082 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.296 | L2-Norm(final)=22.386 | 4829.2 samples/s | 75.5 steps/s
[Step=97450 Epoch=190.1] | Loss=0.01072 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.301 | L2-Norm(final)=22.390 | 4715.9 samples/s | 73.7 steps/s
[Step=97500 Epoch=190.2] | Loss=0.01053 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.306 | L2-Norm(final)=22.393 | 5107.4 samples/s | 79.8 steps/s
[Step=97550 Epoch=190.3] | Loss=0.01041 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.311 | L2-Norm(final)=22.396 | 2084.9 samples/s | 32.6 steps/s
[Step=97600 Epoch=190.4] | Loss=0.01030 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.315 | L2-Norm(final)=22.399 | 4788.1 samples/s | 74.8 steps/s
[Step=97650 Epoch=190.5] | Loss=0.01013 | Reg=0.00054 | acc=0.9688 | L2-Norm=7.320 | L2-Norm(final)=22.402 | 4665.1 samples/s | 72.9 steps/s
[Step=97700 Epoch=190.6] | Loss=0.00999 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.324 | L2-Norm(final)=22.405 | 4681.5 samples/s | 73.1 steps/s
[Step=97750 Epoch=190.7] | Loss=0.00984 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.328 | L2-Norm(final)=22.408 | 4784.5 samples/s | 74.8 steps/s
[Step=97800 Epoch=190.7] | Loss=0.00978 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.333 | L2-Norm(final)=22.411 | 4714.6 samples/s | 73.7 steps/s
[Step=97850 Epoch=190.8] | Loss=0.00972 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.337 | L2-Norm(final)=22.413 | 4718.4 samples/s | 73.7 steps/s
[Step=97900 Epoch=190.9] | Loss=0.00976 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.341 | L2-Norm(final)=22.416 | 4827.0 samples/s | 75.4 steps/s
[Step=97950 Epoch=191.0] | Loss=0.00974 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.345 | L2-Norm(final)=22.419 | 4790.4 samples/s | 74.8 steps/s
[Step=98000 Epoch=191.1] | Loss=0.00962 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.349 | L2-Norm(final)=22.421 | 4781.7 samples/s | 74.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step98000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=96001 Epoch=187.7] | Loss=0.00333 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.166 | L2-Norm(final)=22.935 | 4571.1 samples/s | 71.4 steps/s
[Step=96050 Epoch=187.8] | Loss=0.01574 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.167 | L2-Norm(final)=22.938 | 5166.2 samples/s | 80.7 steps/s
[Step=96100 Epoch=187.9] | Loss=0.01577 | Reg=0.00051 | acc=0.9531 | L2-Norm=7.167 | L2-Norm(final)=22.943 | 5705.4 samples/s | 89.1 steps/s
[Step=96150 Epoch=188.0] | Loss=0.01526 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.167 | L2-Norm(final)=22.948 | 5423.4 samples/s | 84.7 steps/s
[Step=96200 Epoch=188.1] | Loss=0.01521 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.167 | L2-Norm(final)=22.953 | 5485.2 samples/s | 85.7 steps/s
[Step=96250 Epoch=188.2] | Loss=0.01520 | Reg=0.00051 | acc=0.9688 | L2-Norm=7.167 | L2-Norm(final)=22.958 | 5710.1 samples/s | 89.2 steps/s
[Step=96300 Epoch=188.3] | Loss=0.01544 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.167 | L2-Norm(final)=22.963 | 5743.0 samples/s | 89.7 steps/s
[Step=96350 Epoch=188.4] | Loss=0.01536 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.167 | L2-Norm(final)=22.968 | 5550.1 samples/s | 86.7 steps/s
[Step=96400 Epoch=188.5] | Loss=0.01532 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.167 | L2-Norm(final)=22.973 | 5577.9 samples/s | 87.2 steps/s
[Step=96450 Epoch=188.6] | Loss=0.01546 | Reg=0.00051 | acc=0.9688 | L2-Norm=7.167 | L2-Norm(final)=22.977 | 5604.0 samples/s | 87.6 steps/s
[Step=96500 Epoch=188.7] | Loss=0.01532 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.167 | L2-Norm(final)=22.982 | 6991.8 samples/s | 109.2 steps/s
All layers training...
LR=0.00006, len=1
[Step=96501 Epoch=188.7] | Loss=0.00980 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.167 | L2-Norm(final)=23.028 | 4191.6 samples/s | 65.5 steps/s
[Step=96550 Epoch=188.8] | Loss=0.01440 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.177 | L2-Norm(final)=23.034 | 4647.9 samples/s | 72.6 steps/s
[Step=96600 Epoch=188.9] | Loss=0.01282 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.189 | L2-Norm(final)=23.038 | 4740.4 samples/s | 74.1 steps/s
[Step=96650 Epoch=188.9] | Loss=0.01325 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.199 | L2-Norm(final)=23.042 | 4820.0 samples/s | 75.3 steps/s
[Step=96700 Epoch=189.0] | Loss=0.01342 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.208 | L2-Norm(final)=23.046 | 4799.3 samples/s | 75.0 steps/s
[Step=96750 Epoch=189.1] | Loss=0.01349 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.216 | L2-Norm(final)=23.050 | 4827.5 samples/s | 75.4 steps/s
[Step=96800 Epoch=189.2] | Loss=0.01344 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.223 | L2-Norm(final)=23.053 | 4762.2 samples/s | 74.4 steps/s
[Step=96850 Epoch=189.3] | Loss=0.01314 | Reg=0.00052 | acc=0.9688 | L2-Norm=7.230 | L2-Norm(final)=23.057 | 4772.1 samples/s | 74.6 steps/s
[Step=96900 Epoch=189.4] | Loss=0.01292 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.237 | L2-Norm(final)=23.060 | 4713.3 samples/s | 73.6 steps/s
[Step=96950 Epoch=189.5] | Loss=0.01279 | Reg=0.00052 | acc=0.9688 | L2-Norm=7.244 | L2-Norm(final)=23.063 | 4755.7 samples/s | 74.3 steps/s
[Step=97000 Epoch=189.6] | Loss=0.01247 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.250 | L2-Norm(final)=23.067 | 5738.7 samples/s | 89.7 steps/s
[Step=97050 Epoch=189.7] | Loss=0.01209 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.256 | L2-Norm(final)=23.070 | 2021.9 samples/s | 31.6 steps/s
[Step=97100 Epoch=189.8] | Loss=0.01174 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.262 | L2-Norm(final)=23.073 | 4864.6 samples/s | 76.0 steps/s
[Step=97150 Epoch=189.9] | Loss=0.01138 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.267 | L2-Norm(final)=23.076 | 4831.2 samples/s | 75.5 steps/s
[Step=97200 Epoch=190.0] | Loss=0.01110 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.273 | L2-Norm(final)=23.079 | 4751.4 samples/s | 74.2 steps/s
[Step=97250 Epoch=190.1] | Loss=0.01092 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.278 | L2-Norm(final)=23.083 | 4790.5 samples/s | 74.9 steps/s
[Step=97300 Epoch=190.2] | Loss=0.01086 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.283 | L2-Norm(final)=23.086 | 4830.1 samples/s | 75.5 steps/s
[Step=97350 Epoch=190.3] | Loss=0.01073 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.288 | L2-Norm(final)=23.089 | 4790.1 samples/s | 74.8 steps/s
[Step=97400 Epoch=190.4] | Loss=0.01061 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.293 | L2-Norm(final)=23.092 | 4827.3 samples/s | 75.4 steps/s
[Step=97450 Epoch=190.5] | Loss=0.01042 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.297 | L2-Norm(final)=23.095 | 4767.0 samples/s | 74.5 steps/s
[Step=97500 Epoch=190.6] | Loss=0.01035 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.302 | L2-Norm(final)=23.098 | 5086.7 samples/s | 79.5 steps/s
[Step=97550 Epoch=190.7] | Loss=0.01019 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.307 | L2-Norm(final)=23.101 | 2093.4 samples/s | 32.7 steps/s
[Step=97600 Epoch=190.8] | Loss=0.00996 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.311 | L2-Norm(final)=23.104 | 4750.0 samples/s | 74.2 steps/s
[Step=97650 Epoch=190.9] | Loss=0.00982 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.315 | L2-Norm(final)=23.107 | 4825.2 samples/s | 75.4 steps/s
[Step=97700 Epoch=191.0] | Loss=0.00972 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.320 | L2-Norm(final)=23.109 | 4738.5 samples/s | 74.0 steps/s
[Step=97750 Epoch=191.1] | Loss=0.00963 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.324 | L2-Norm(final)=23.112 | 4773.1 samples/s | 74.6 steps/s
[Step=97800 Epoch=191.2] | Loss=0.00958 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.328 | L2-Norm(final)=23.115 | 4861.6 samples/s | 76.0 steps/s
[Step=97850 Epoch=191.3] | Loss=0.00948 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.333 | L2-Norm(final)=23.118 | 4689.6 samples/s | 73.3 steps/s
[Step=97900 Epoch=191.4] | Loss=0.00933 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.337 | L2-Norm(final)=23.121 | 4708.4 samples/s | 73.6 steps/s
[Step=97950 Epoch=191.5] | Loss=0.00925 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.341 | L2-Norm(final)=23.124 | 4794.6 samples/s | 74.9 steps/s
[Step=98000 Epoch=191.6] | Loss=0.00915 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.344 | L2-Norm(final)=23.126 | 4719.8 samples/s | 73.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step98000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=96001 Epoch=367.8] | Loss=0.00012 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.166 | L2-Norm(final)=20.252 | 4403.6 samples/s | 68.8 steps/s
[Step=96050 Epoch=368.0] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.163 | L2-Norm(final)=20.254 | 4876.0 samples/s | 76.2 steps/s
[Step=96100 Epoch=368.2] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.163 | L2-Norm(final)=20.257 | 5098.5 samples/s | 79.7 steps/s
[Step=96150 Epoch=368.4] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.163 | L2-Norm(final)=20.260 | 5072.9 samples/s | 79.3 steps/s
[Step=96200 Epoch=368.6] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.163 | L2-Norm(final)=20.263 | 5065.7 samples/s | 79.2 steps/s
[Step=96250 Epoch=368.8] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.163 | L2-Norm(final)=20.267 | 6632.5 samples/s | 103.6 steps/s
[Step=96300 Epoch=369.0] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.163 | L2-Norm(final)=20.272 | 2022.7 samples/s | 31.6 steps/s
[Step=96350 Epoch=369.2] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.163 | L2-Norm(final)=20.276 | 5204.3 samples/s | 81.3 steps/s
[Step=96400 Epoch=369.4] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.163 | L2-Norm(final)=20.280 | 5108.8 samples/s | 79.8 steps/s
[Step=96450 Epoch=369.6] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.163 | L2-Norm(final)=20.285 | 5343.8 samples/s | 83.5 steps/s
[Step=96500 Epoch=369.8] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.163 | L2-Norm(final)=20.289 | 5528.1 samples/s | 86.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=96501 Epoch=369.8] | Loss=0.00005 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.163 | L2-Norm(final)=20.327 | 4239.9 samples/s | 66.2 steps/s
[Step=96550 Epoch=369.9] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.146 | L2-Norm(final)=20.330 | 4378.0 samples/s | 68.4 steps/s
[Step=96600 Epoch=370.1] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.133 | L2-Norm(final)=20.333 | 4550.2 samples/s | 71.1 steps/s
[Step=96650 Epoch=370.3] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.121 | L2-Norm(final)=20.335 | 4495.9 samples/s | 70.2 steps/s
[Step=96700 Epoch=370.5] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.108 | L2-Norm(final)=20.337 | 4556.0 samples/s | 71.2 steps/s
[Step=96750 Epoch=370.7] | Loss=0.00001 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.096 | L2-Norm(final)=20.338 | 5717.1 samples/s | 89.3 steps/s
[Step=96800 Epoch=370.9] | Loss=0.00001 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.083 | L2-Norm(final)=20.339 | 1934.1 samples/s | 30.2 steps/s
[Step=96850 Epoch=371.1] | Loss=0.00001 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.070 | L2-Norm(final)=20.340 | 4532.7 samples/s | 70.8 steps/s
[Step=96900 Epoch=371.3] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.057 | L2-Norm(final)=20.341 | 4498.4 samples/s | 70.3 steps/s
[Step=96950 Epoch=371.5] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.045 | L2-Norm(final)=20.342 | 4586.8 samples/s | 71.7 steps/s
[Step=97000 Epoch=371.7] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.032 | L2-Norm(final)=20.342 | 5032.8 samples/s | 78.6 steps/s
[Step=97050 Epoch=371.9] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.019 | L2-Norm(final)=20.343 | 2005.7 samples/s | 31.3 steps/s
[Step=97100 Epoch=372.1] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.007 | L2-Norm(final)=20.344 | 4531.9 samples/s | 70.8 steps/s
[Step=97150 Epoch=372.2] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.994 | L2-Norm(final)=20.345 | 4517.4 samples/s | 70.6 steps/s
[Step=97200 Epoch=372.4] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.981 | L2-Norm(final)=20.345 | 4522.6 samples/s | 70.7 steps/s
[Step=97250 Epoch=372.6] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.969 | L2-Norm(final)=20.346 | 4538.5 samples/s | 70.9 steps/s
[Step=97300 Epoch=372.8] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.956 | L2-Norm(final)=20.347 | 2117.7 samples/s | 33.1 steps/s
[Step=97350 Epoch=373.0] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.943 | L2-Norm(final)=20.347 | 4616.6 samples/s | 72.1 steps/s
[Step=97400 Epoch=373.2] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.930 | L2-Norm(final)=20.348 | 4552.4 samples/s | 71.1 steps/s
[Step=97450 Epoch=373.4] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.918 | L2-Norm(final)=20.349 | 4427.5 samples/s | 69.2 steps/s
[Step=97500 Epoch=373.6] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.905 | L2-Norm(final)=20.350 | 4588.4 samples/s | 71.7 steps/s
[Step=97550 Epoch=373.8] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.892 | L2-Norm(final)=20.350 | 2099.4 samples/s | 32.8 steps/s
[Step=97600 Epoch=374.0] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.879 | L2-Norm(final)=20.351 | 4516.4 samples/s | 70.6 steps/s
[Step=97650 Epoch=374.2] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.866 | L2-Norm(final)=20.352 | 4497.2 samples/s | 70.3 steps/s
[Step=97700 Epoch=374.4] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.853 | L2-Norm(final)=20.353 | 4442.1 samples/s | 69.4 steps/s
[Step=97750 Epoch=374.5] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.840 | L2-Norm(final)=20.354 | 4484.8 samples/s | 70.1 steps/s
[Step=97800 Epoch=374.7] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.827 | L2-Norm(final)=20.355 | 6117.7 samples/s | 95.6 steps/s
[Step=97850 Epoch=374.9] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.814 | L2-Norm(final)=20.355 | 1868.8 samples/s | 29.2 steps/s
[Step=97900 Epoch=375.1] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.801 | L2-Norm(final)=20.356 | 4480.1 samples/s | 70.0 steps/s
[Step=97950 Epoch=375.3] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.787 | L2-Norm(final)=20.357 | 4496.9 samples/s | 70.3 steps/s
[Step=98000 Epoch=375.5] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.774 | L2-Norm(final)=20.358 | 4499.2 samples/s | 70.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step98000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=96001 Epoch=369.5] | Loss=0.00005 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.166 | L2-Norm(final)=19.514 | 4571.1 samples/s | 71.4 steps/s
[Step=96050 Epoch=369.7] | Loss=0.00007 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.165 | L2-Norm(final)=19.517 | 4647.6 samples/s | 72.6 steps/s
[Step=96100 Epoch=369.9] | Loss=0.00008 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.165 | L2-Norm(final)=19.521 | 5345.7 samples/s | 83.5 steps/s
[Step=96150 Epoch=370.1] | Loss=0.00008 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.165 | L2-Norm(final)=19.525 | 5265.1 samples/s | 82.3 steps/s
[Step=96200 Epoch=370.3] | Loss=0.00008 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.165 | L2-Norm(final)=19.529 | 5425.1 samples/s | 84.8 steps/s
[Step=96250 Epoch=370.5] | Loss=0.00008 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.165 | L2-Norm(final)=19.533 | 6925.3 samples/s | 108.2 steps/s
[Step=96300 Epoch=370.7] | Loss=0.00008 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.165 | L2-Norm(final)=19.536 | 2080.7 samples/s | 32.5 steps/s
[Step=96350 Epoch=370.9] | Loss=0.00008 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.165 | L2-Norm(final)=19.540 | 5119.8 samples/s | 80.0 steps/s
[Step=96400 Epoch=371.1] | Loss=0.00008 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.165 | L2-Norm(final)=19.543 | 5203.0 samples/s | 81.3 steps/s
[Step=96450 Epoch=371.3] | Loss=0.00008 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.165 | L2-Norm(final)=19.546 | 5171.7 samples/s | 80.8 steps/s
[Step=96500 Epoch=371.5] | Loss=0.00008 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.165 | L2-Norm(final)=19.550 | 6013.8 samples/s | 94.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=96501 Epoch=371.5] | Loss=0.00004 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.165 | L2-Norm(final)=19.583 | 4217.5 samples/s | 65.9 steps/s
[Step=96550 Epoch=371.7] | Loss=0.00022 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.165 | L2-Norm(final)=19.586 | 4321.7 samples/s | 67.5 steps/s
[Step=96600 Epoch=371.9] | Loss=0.00016 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.170 | L2-Norm(final)=19.590 | 4594.0 samples/s | 71.8 steps/s
[Step=96650 Epoch=372.0] | Loss=0.00011 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.173 | L2-Norm(final)=19.592 | 4497.9 samples/s | 70.3 steps/s
[Step=96700 Epoch=372.2] | Loss=0.00009 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.173 | L2-Norm(final)=19.593 | 4530.0 samples/s | 70.8 steps/s
[Step=96750 Epoch=372.4] | Loss=0.00007 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.172 | L2-Norm(final)=19.594 | 5761.7 samples/s | 90.0 steps/s
[Step=96800 Epoch=372.6] | Loss=0.00006 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.171 | L2-Norm(final)=19.595 | 1940.7 samples/s | 30.3 steps/s
[Step=96850 Epoch=372.8] | Loss=0.00005 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.170 | L2-Norm(final)=19.596 | 4482.7 samples/s | 70.0 steps/s
[Step=96900 Epoch=373.0] | Loss=0.00005 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.168 | L2-Norm(final)=19.597 | 4507.7 samples/s | 70.4 steps/s
[Step=96950 Epoch=373.2] | Loss=0.00004 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.166 | L2-Norm(final)=19.597 | 4532.4 samples/s | 70.8 steps/s
[Step=97000 Epoch=373.4] | Loss=0.00004 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.164 | L2-Norm(final)=19.598 | 5167.4 samples/s | 80.7 steps/s
[Step=97050 Epoch=373.6] | Loss=0.00004 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.162 | L2-Norm(final)=19.598 | 2021.3 samples/s | 31.6 steps/s
[Step=97100 Epoch=373.8] | Loss=0.00003 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.160 | L2-Norm(final)=19.599 | 4646.8 samples/s | 72.6 steps/s
[Step=97150 Epoch=374.0] | Loss=0.00003 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.158 | L2-Norm(final)=19.599 | 4598.6 samples/s | 71.9 steps/s
[Step=97200 Epoch=374.2] | Loss=0.00003 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.156 | L2-Norm(final)=19.599 | 4567.6 samples/s | 71.4 steps/s
[Step=97250 Epoch=374.4] | Loss=0.00003 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.154 | L2-Norm(final)=19.600 | 4665.3 samples/s | 72.9 steps/s
[Step=97300 Epoch=374.5] | Loss=0.00003 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.151 | L2-Norm(final)=19.600 | 2137.9 samples/s | 33.4 steps/s
[Step=97350 Epoch=374.7] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.149 | L2-Norm(final)=19.601 | 4836.5 samples/s | 75.6 steps/s
[Step=97400 Epoch=374.9] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.147 | L2-Norm(final)=19.601 | 4596.1 samples/s | 71.8 steps/s
[Step=97450 Epoch=375.1] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.144 | L2-Norm(final)=19.601 | 4588.8 samples/s | 71.7 steps/s
[Step=97500 Epoch=375.3] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.142 | L2-Norm(final)=19.602 | 4680.0 samples/s | 73.1 steps/s
[Step=97550 Epoch=375.5] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.140 | L2-Norm(final)=19.602 | 2188.9 samples/s | 34.2 steps/s
[Step=97600 Epoch=375.7] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.137 | L2-Norm(final)=19.602 | 4623.7 samples/s | 72.2 steps/s
[Step=97650 Epoch=375.9] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.135 | L2-Norm(final)=19.603 | 4622.1 samples/s | 72.2 steps/s
[Step=97700 Epoch=376.1] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.132 | L2-Norm(final)=19.603 | 4660.5 samples/s | 72.8 steps/s
[Step=97750 Epoch=376.3] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.129 | L2-Norm(final)=19.604 | 4554.7 samples/s | 71.2 steps/s
[Step=97800 Epoch=376.5] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.127 | L2-Norm(final)=19.604 | 6731.7 samples/s | 105.2 steps/s
[Step=97850 Epoch=376.7] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.124 | L2-Norm(final)=19.604 | 1848.5 samples/s | 28.9 steps/s
[Step=97900 Epoch=376.9] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.121 | L2-Norm(final)=19.605 | 4447.5 samples/s | 69.5 steps/s
[Step=97950 Epoch=377.0] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.119 | L2-Norm(final)=19.605 | 4418.4 samples/s | 69.0 steps/s
[Step=98000 Epoch=377.2] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.116 | L2-Norm(final)=19.605 | 4501.6 samples/s | 70.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step98000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05657 | acc=0.9712 | tpr=0.9781 | fpr=0.0436 | 4393.3 samples/s | 17.2 steps/s
Avg test loss: 0.05722, Avg test acc: 0.97099, Avg tpr: 0.97791, Avg fpr: 0.04423, total FA: 345

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05684 | acc=0.9710 | tpr=0.9768 | fpr=0.0416 | 4499.4 samples/s | 17.6 steps/s
Avg test loss: 0.05811, Avg test acc: 0.97095, Avg tpr: 0.97709, Avg fpr: 0.04256, total FA: 332

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.44832 | acc=0.3158 | tpr=0.0040 | fpr=0.0072 | 4385.9 samples/s | 17.1 steps/s
Avg test loss: 5.47129, Avg test acc: 0.31293, Avg tpr: 0.00437, Avg fpr: 0.00846, total FA: 66

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.48973 | acc=0.3121 | tpr=0.0067 | fpr=0.0248 | 4400.1 samples/s | 17.2 steps/s
Avg test loss: 5.50763, Avg test acc: 0.31024, Avg tpr: 0.00705, Avg fpr: 0.02295, total FA: 179

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.92649 | acc=0.1239 | tpr=0.7124 | fpr=0.8867 | 4378.7 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.90738 | acc=0.1240 | tpr=0.7100 | fpr=0.8869 | 8678.9 samples/s | 33.9 steps/s
[Step= 150] | Loss=4.91050 | acc=0.1231 | tpr=0.7089 | fpr=0.8877 | 8589.0 samples/s | 33.6 steps/s
[Step= 200] | Loss=4.91307 | acc=0.1227 | tpr=0.6962 | fpr=0.8877 | 8443.8 samples/s | 33.0 steps/s
[Step= 250] | Loss=4.92243 | acc=0.1227 | tpr=0.6987 | fpr=0.8877 | 5211.7 samples/s | 20.4 steps/s
[Step= 300] | Loss=4.91925 | acc=0.1225 | tpr=0.6967 | fpr=0.8879 | 8185.8 samples/s | 32.0 steps/s
[Step= 350] | Loss=4.91877 | acc=0.1221 | tpr=0.6938 | fpr=0.8883 | 8722.1 samples/s | 34.1 steps/s
[Step= 400] | Loss=4.92381 | acc=0.1218 | tpr=0.6865 | fpr=0.8885 | 7939.7 samples/s | 31.0 steps/s
[Step= 450] | Loss=4.92725 | acc=0.1218 | tpr=0.6899 | fpr=0.8885 | 7665.4 samples/s | 29.9 steps/s
[Step= 500] | Loss=4.92697 | acc=0.1217 | tpr=0.6965 | fpr=0.8887 | 8512.9 samples/s | 33.3 steps/s
[Step= 550] | Loss=4.93071 | acc=0.1216 | tpr=0.6948 | fpr=0.8888 | 14194.4 samples/s | 55.4 steps/s
Avg test loss: 4.93073, Avg test acc: 0.12149, Avg tpr: 0.69532, Avg fpr: 0.88894, total FA: 123428

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.02842 | acc=0.1346 | tpr=0.6991 | fpr=0.8755 | 4400.1 samples/s | 17.2 steps/s
[Step= 100] | Loss=5.00862 | acc=0.1339 | tpr=0.6994 | fpr=0.8767 | 8489.1 samples/s | 33.2 steps/s
[Step= 150] | Loss=5.01198 | acc=0.1323 | tpr=0.6916 | fpr=0.8780 | 8679.1 samples/s | 33.9 steps/s
[Step= 200] | Loss=5.01330 | acc=0.1318 | tpr=0.6787 | fpr=0.8781 | 8249.0 samples/s | 32.2 steps/s
[Step= 250] | Loss=5.02355 | acc=0.1320 | tpr=0.6830 | fpr=0.8780 | 5288.9 samples/s | 20.7 steps/s
[Step= 300] | Loss=5.02170 | acc=0.1317 | tpr=0.6749 | fpr=0.8782 | 8659.0 samples/s | 33.8 steps/s
[Step= 350] | Loss=5.01955 | acc=0.1309 | tpr=0.6713 | fpr=0.8789 | 8081.9 samples/s | 31.6 steps/s
[Step= 400] | Loss=5.02487 | acc=0.1307 | tpr=0.6668 | fpr=0.8790 | 8671.7 samples/s | 33.9 steps/s
[Step= 450] | Loss=5.02747 | acc=0.1308 | tpr=0.6689 | fpr=0.8789 | 7419.7 samples/s | 29.0 steps/s
[Step= 500] | Loss=5.02599 | acc=0.1308 | tpr=0.6744 | fpr=0.8790 | 8323.1 samples/s | 32.5 steps/s
[Step= 550] | Loss=5.02950 | acc=0.1307 | tpr=0.6705 | fpr=0.8791 | 14993.2 samples/s | 58.6 steps/s
Avg test loss: 5.02969, Avg test acc: 0.13063, Avg tpr: 0.67116, Avg fpr: 0.87920, total FA: 122075

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09509 | acc=0.9823 | tpr=0.9425 | fpr=0.0169 | 4412.8 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.09907 | acc=0.9820 | tpr=0.9552 | fpr=0.0175 | 8444.9 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.10199 | acc=0.9814 | tpr=0.9568 | fpr=0.0181 | 8252.0 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.10317 | acc=0.9814 | tpr=0.9585 | fpr=0.0182 | 8461.8 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.10219 | acc=0.9815 | tpr=0.9572 | fpr=0.0181 | 6026.3 samples/s | 23.5 steps/s
[Step= 300] | Loss=0.10338 | acc=0.9813 | tpr=0.9585 | fpr=0.0183 | 8458.2 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.10437 | acc=0.9811 | tpr=0.9580 | fpr=0.0185 | 8430.0 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.10537 | acc=0.9810 | tpr=0.9568 | fpr=0.0185 | 6321.6 samples/s | 24.7 steps/s
[Step= 450] | Loss=0.10738 | acc=0.9808 | tpr=0.9552 | fpr=0.0187 | 8317.7 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.10694 | acc=0.9808 | tpr=0.9559 | fpr=0.0187 | 8488.4 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.10610 | acc=0.9809 | tpr=0.9538 | fpr=0.0186 | 14789.1 samples/s | 57.8 steps/s
Avg test loss: 0.10584, Avg test acc: 0.98096, Avg tpr: 0.95404, Avg fpr: 0.01855, total FA: 2576

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10832 | acc=0.9819 | tpr=0.9469 | fpr=0.0175 | 4414.3 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.11299 | acc=0.9818 | tpr=0.9680 | fpr=0.0179 | 8422.9 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.11729 | acc=0.9811 | tpr=0.9683 | fpr=0.0187 | 8472.4 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.11832 | acc=0.9813 | tpr=0.9705 | fpr=0.0185 | 6671.6 samples/s | 26.1 steps/s
[Step= 250] | Loss=0.11768 | acc=0.9814 | tpr=0.9694 | fpr=0.0184 | 8564.6 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.11894 | acc=0.9813 | tpr=0.9709 | fpr=0.0185 | 8397.9 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.12010 | acc=0.9811 | tpr=0.9693 | fpr=0.0187 | 8666.1 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.12152 | acc=0.9809 | tpr=0.9683 | fpr=0.0189 | 5719.2 samples/s | 22.3 steps/s
[Step= 450] | Loss=0.12380 | acc=0.9806 | tpr=0.9664 | fpr=0.0191 | 8287.1 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.12340 | acc=0.9806 | tpr=0.9670 | fpr=0.0191 | 8105.7 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.12231 | acc=0.9807 | tpr=0.9650 | fpr=0.0190 | 15713.2 samples/s | 61.4 steps/s
Avg test loss: 0.12203, Avg test acc: 0.98070, Avg tpr: 0.96513, Avg fpr: 0.01901, total FA: 2640

server round 49/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=98001 Epoch=191.1] | Loss=0.01372 | Reg=0.00049 | acc=0.9844 | L2-Norm=7.029 | L2-Norm(final)=22.500 | 4078.4 samples/s | 63.7 steps/s
[Step=98050 Epoch=191.2] | Loss=0.01778 | Reg=0.00049 | acc=0.9844 | L2-Norm=7.030 | L2-Norm(final)=22.505 | 5637.0 samples/s | 88.1 steps/s
[Step=98100 Epoch=191.3] | Loss=0.01797 | Reg=0.00049 | acc=0.9688 | L2-Norm=7.030 | L2-Norm(final)=22.512 | 5544.6 samples/s | 86.6 steps/s
[Step=98150 Epoch=191.4] | Loss=0.01833 | Reg=0.00049 | acc=0.9688 | L2-Norm=7.030 | L2-Norm(final)=22.519 | 5632.9 samples/s | 88.0 steps/s
[Step=98200 Epoch=191.5] | Loss=0.01766 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.030 | L2-Norm(final)=22.526 | 5388.6 samples/s | 84.2 steps/s
[Step=98250 Epoch=191.6] | Loss=0.01797 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.030 | L2-Norm(final)=22.532 | 5526.8 samples/s | 86.4 steps/s
[Step=98300 Epoch=191.7] | Loss=0.01776 | Reg=0.00049 | acc=0.9844 | L2-Norm=7.030 | L2-Norm(final)=22.539 | 5525.3 samples/s | 86.3 steps/s
[Step=98350 Epoch=191.8] | Loss=0.01769 | Reg=0.00049 | acc=0.9844 | L2-Norm=7.030 | L2-Norm(final)=22.545 | 5511.1 samples/s | 86.1 steps/s
[Step=98400 Epoch=191.9] | Loss=0.01762 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.030 | L2-Norm(final)=22.551 | 5513.0 samples/s | 86.1 steps/s
[Step=98450 Epoch=192.0] | Loss=0.01763 | Reg=0.00049 | acc=0.9375 | L2-Norm=7.030 | L2-Norm(final)=22.557 | 5441.9 samples/s | 85.0 steps/s
[Step=98500 Epoch=192.1] | Loss=0.01757 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.030 | L2-Norm(final)=22.563 | 6797.0 samples/s | 106.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step98500.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=98001 Epoch=191.6] | Loss=0.01296 | Reg=0.00049 | acc=0.9844 | L2-Norm=7.029 | L2-Norm(final)=23.207 | 4501.1 samples/s | 70.3 steps/s
[Step=98050 Epoch=191.7] | Loss=0.01767 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.029 | L2-Norm(final)=23.212 | 5004.8 samples/s | 78.2 steps/s
[Step=98100 Epoch=191.8] | Loss=0.01773 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.030 | L2-Norm(final)=23.220 | 5457.5 samples/s | 85.3 steps/s
[Step=98150 Epoch=191.9] | Loss=0.01827 | Reg=0.00049 | acc=0.9844 | L2-Norm=7.030 | L2-Norm(final)=23.228 | 5352.8 samples/s | 83.6 steps/s
[Step=98200 Epoch=192.0] | Loss=0.01821 | Reg=0.00049 | acc=0.9844 | L2-Norm=7.030 | L2-Norm(final)=23.236 | 5540.7 samples/s | 86.6 steps/s
[Step=98250 Epoch=192.1] | Loss=0.01818 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.030 | L2-Norm(final)=23.243 | 5574.0 samples/s | 87.1 steps/s
[Step=98300 Epoch=192.2] | Loss=0.01815 | Reg=0.00049 | acc=0.9844 | L2-Norm=7.030 | L2-Norm(final)=23.250 | 5601.7 samples/s | 87.5 steps/s
[Step=98350 Epoch=192.3] | Loss=0.01788 | Reg=0.00049 | acc=0.9844 | L2-Norm=7.030 | L2-Norm(final)=23.257 | 5514.6 samples/s | 86.2 steps/s
[Step=98400 Epoch=192.4] | Loss=0.01769 | Reg=0.00049 | acc=0.9844 | L2-Norm=7.030 | L2-Norm(final)=23.263 | 5380.2 samples/s | 84.1 steps/s
[Step=98450 Epoch=192.5] | Loss=0.01763 | Reg=0.00049 | acc=0.9844 | L2-Norm=7.030 | L2-Norm(final)=23.270 | 5412.6 samples/s | 84.6 steps/s
[Step=98500 Epoch=192.6] | Loss=0.01758 | Reg=0.00049 | acc=0.9844 | L2-Norm=7.030 | L2-Norm(final)=23.277 | 6987.4 samples/s | 109.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step98500.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=98001 Epoch=375.5] | Loss=0.00010 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.029 | L2-Norm(final)=20.388 | 4393.7 samples/s | 68.7 steps/s
[Step=98050 Epoch=375.7] | Loss=0.00002 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.025 | L2-Norm(final)=20.392 | 4726.0 samples/s | 73.8 steps/s
[Step=98100 Epoch=375.9] | Loss=0.00002 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.024 | L2-Norm(final)=20.399 | 5246.3 samples/s | 82.0 steps/s
[Step=98150 Epoch=376.1] | Loss=0.00002 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.024 | L2-Norm(final)=20.406 | 5154.9 samples/s | 80.5 steps/s
[Step=98200 Epoch=376.3] | Loss=0.00002 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.024 | L2-Norm(final)=20.414 | 5042.1 samples/s | 78.8 steps/s
[Step=98250 Epoch=376.5] | Loss=0.00002 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.024 | L2-Norm(final)=20.421 | 6822.5 samples/s | 106.6 steps/s
[Step=98300 Epoch=376.7] | Loss=0.00002 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.024 | L2-Norm(final)=20.427 | 2060.5 samples/s | 32.2 steps/s
[Step=98350 Epoch=376.8] | Loss=0.00002 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.024 | L2-Norm(final)=20.434 | 5164.5 samples/s | 80.7 steps/s
[Step=98400 Epoch=377.0] | Loss=0.00002 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.024 | L2-Norm(final)=20.440 | 5114.5 samples/s | 79.9 steps/s
[Step=98450 Epoch=377.2] | Loss=0.00002 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.024 | L2-Norm(final)=20.445 | 5127.4 samples/s | 80.1 steps/s
[Step=98500 Epoch=377.4] | Loss=0.00002 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.024 | L2-Norm(final)=20.451 | 5846.5 samples/s | 91.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step98500.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=98001 Epoch=377.2] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.029 | L2-Norm(final)=19.616 | 4287.3 samples/s | 67.0 steps/s
[Step=98050 Epoch=377.4] | Loss=0.00010 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.028 | L2-Norm(final)=19.619 | 5000.8 samples/s | 78.1 steps/s
[Step=98100 Epoch=377.6] | Loss=0.00010 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.028 | L2-Norm(final)=19.624 | 5162.1 samples/s | 80.7 steps/s
[Step=98150 Epoch=377.8] | Loss=0.00009 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.028 | L2-Norm(final)=19.628 | 5161.1 samples/s | 80.6 steps/s
[Step=98200 Epoch=378.0] | Loss=0.00009 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.028 | L2-Norm(final)=19.631 | 5060.4 samples/s | 79.1 steps/s
[Step=98250 Epoch=378.2] | Loss=0.00008 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.028 | L2-Norm(final)=19.634 | 6921.4 samples/s | 108.1 steps/s
[Step=98300 Epoch=378.4] | Loss=0.00008 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.028 | L2-Norm(final)=19.638 | 2037.9 samples/s | 31.8 steps/s
[Step=98350 Epoch=378.6] | Loss=0.00008 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.028 | L2-Norm(final)=19.641 | 5114.3 samples/s | 79.9 steps/s
[Step=98400 Epoch=378.8] | Loss=0.00008 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.028 | L2-Norm(final)=19.644 | 5143.2 samples/s | 80.4 steps/s
[Step=98450 Epoch=379.0] | Loss=0.00008 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.028 | L2-Norm(final)=19.648 | 5163.0 samples/s | 80.7 steps/s
[Step=98500 Epoch=379.2] | Loss=0.00008 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.028 | L2-Norm(final)=19.651 | 6035.8 samples/s | 94.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step98500.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05139 | acc=0.9683 | tpr=0.9757 | fpr=0.0478 | 4458.3 samples/s | 17.4 steps/s
Avg test loss: 0.05218, Avg test acc: 0.96751, Avg tpr: 0.97529, Avg fpr: 0.04961, total FA: 387

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05213 | acc=0.9690 | tpr=0.9760 | fpr=0.0463 | 4420.8 samples/s | 17.3 steps/s
Avg test loss: 0.05294, Avg test acc: 0.96779, Avg tpr: 0.97488, Avg fpr: 0.04781, total FA: 373

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.37781 | acc=0.3171 | tpr=0.0098 | fpr=0.0156 | 3357.4 samples/s | 13.1 steps/s
Avg test loss: 4.39164, Avg test acc: 0.31501, Avg tpr: 0.01026, Avg fpr: 0.01474, total FA: 115

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.22878 | acc=0.3082 | tpr=0.0097 | fpr=0.0436 | 3188.2 samples/s | 12.5 steps/s
Avg test loss: 4.24154, Avg test acc: 0.30643, Avg tpr: 0.00997, Avg fpr: 0.04153, total FA: 324

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.14772 | acc=0.1534 | tpr=0.6549 | fpr=0.8557 | 3402.4 samples/s | 13.3 steps/s
[Step= 100] | Loss=3.13576 | acc=0.1534 | tpr=0.6631 | fpr=0.8561 | 8339.7 samples/s | 32.6 steps/s
[Step= 150] | Loss=3.13928 | acc=0.1525 | tpr=0.6671 | fpr=0.8570 | 8356.0 samples/s | 32.6 steps/s
[Step= 200] | Loss=3.14073 | acc=0.1520 | tpr=0.6623 | fpr=0.8573 | 8518.3 samples/s | 33.3 steps/s
[Step= 250] | Loss=3.14817 | acc=0.1518 | tpr=0.6655 | fpr=0.8576 | 7410.4 samples/s | 28.9 steps/s
[Step= 300] | Loss=3.14594 | acc=0.1514 | tpr=0.6647 | fpr=0.8580 | 8357.8 samples/s | 32.6 steps/s
[Step= 350] | Loss=3.14426 | acc=0.1509 | tpr=0.6619 | fpr=0.8583 | 8448.2 samples/s | 33.0 steps/s
[Step= 400] | Loss=3.14835 | acc=0.1508 | tpr=0.6592 | fpr=0.8584 | 8722.5 samples/s | 34.1 steps/s
[Step= 450] | Loss=3.15062 | acc=0.1508 | tpr=0.6631 | fpr=0.8585 | 8351.4 samples/s | 32.6 steps/s
[Step= 500] | Loss=3.15018 | acc=0.1506 | tpr=0.6687 | fpr=0.8587 | 8271.8 samples/s | 32.3 steps/s
[Step= 550] | Loss=3.15247 | acc=0.1504 | tpr=0.6689 | fpr=0.8590 | 15106.6 samples/s | 59.0 steps/s
Avg test loss: 3.15250, Avg test acc: 0.15029, Avg tpr: 0.66918, Avg fpr: 0.85914, total FA: 119290

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.23991 | acc=0.1566 | tpr=0.6726 | fpr=0.8526 | 3298.3 samples/s | 12.9 steps/s
[Step= 100] | Loss=3.22764 | acc=0.1560 | tpr=0.6802 | fpr=0.8538 | 8329.4 samples/s | 32.5 steps/s
[Step= 150] | Loss=3.23097 | acc=0.1549 | tpr=0.6801 | fpr=0.8547 | 8323.7 samples/s | 32.5 steps/s
[Step= 200] | Loss=3.23225 | acc=0.1544 | tpr=0.6699 | fpr=0.8550 | 8337.1 samples/s | 32.6 steps/s
[Step= 250] | Loss=3.23981 | acc=0.1542 | tpr=0.6716 | fpr=0.8553 | 8519.9 samples/s | 33.3 steps/s
[Step= 300] | Loss=3.23736 | acc=0.1537 | tpr=0.6720 | fpr=0.8558 | 8369.7 samples/s | 32.7 steps/s
[Step= 350] | Loss=3.23555 | acc=0.1532 | tpr=0.6681 | fpr=0.8562 | 8149.6 samples/s | 31.8 steps/s
[Step= 400] | Loss=3.23969 | acc=0.1531 | tpr=0.6658 | fpr=0.8563 | 8420.2 samples/s | 32.9 steps/s
[Step= 450] | Loss=3.24194 | acc=0.1530 | tpr=0.6699 | fpr=0.8563 | 8062.2 samples/s | 31.5 steps/s
[Step= 500] | Loss=3.24156 | acc=0.1529 | tpr=0.6762 | fpr=0.8565 | 8110.9 samples/s | 31.7 steps/s
[Step= 550] | Loss=3.24399 | acc=0.1527 | tpr=0.6757 | fpr=0.8568 | 15352.3 samples/s | 60.0 steps/s
Avg test loss: 3.24403, Avg test acc: 0.15255, Avg tpr: 0.67591, Avg fpr: 0.85697, total FA: 118988

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09474 | acc=0.9805 | tpr=0.9513 | fpr=0.0190 | 4429.5 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.09849 | acc=0.9802 | tpr=0.9659 | fpr=0.0195 | 8403.3 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.10148 | acc=0.9797 | tpr=0.9669 | fpr=0.0200 | 8585.7 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.10209 | acc=0.9800 | tpr=0.9683 | fpr=0.0198 | 4936.0 samples/s | 19.3 steps/s
[Step= 250] | Loss=0.10142 | acc=0.9801 | tpr=0.9677 | fpr=0.0196 | 8227.4 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.10224 | acc=0.9801 | tpr=0.9695 | fpr=0.0197 | 8845.5 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.10326 | acc=0.9797 | tpr=0.9681 | fpr=0.0201 | 8175.7 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.10443 | acc=0.9797 | tpr=0.9683 | fpr=0.0201 | 8877.3 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.10635 | acc=0.9794 | tpr=0.9669 | fpr=0.0204 | 8270.8 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.10609 | acc=0.9794 | tpr=0.9661 | fpr=0.0204 | 8406.4 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.10517 | acc=0.9795 | tpr=0.9642 | fpr=0.0203 | 15166.1 samples/s | 59.2 steps/s
Avg test loss: 0.10493, Avg test acc: 0.97949, Avg tpr: 0.96434, Avg fpr: 0.02023, total FA: 2809

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09658 | acc=0.9797 | tpr=0.9513 | fpr=0.0198 | 4408.5 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.09964 | acc=0.9797 | tpr=0.9701 | fpr=0.0201 | 8505.7 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.10302 | acc=0.9790 | tpr=0.9726 | fpr=0.0209 | 9066.7 samples/s | 35.4 steps/s
[Step= 200] | Loss=0.10338 | acc=0.9792 | tpr=0.9738 | fpr=0.0207 | 4723.1 samples/s | 18.4 steps/s
[Step= 250] | Loss=0.10280 | acc=0.9794 | tpr=0.9721 | fpr=0.0205 | 8673.1 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.10356 | acc=0.9793 | tpr=0.9731 | fpr=0.0206 | 8259.2 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.10452 | acc=0.9791 | tpr=0.9718 | fpr=0.0208 | 8542.7 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.10579 | acc=0.9791 | tpr=0.9716 | fpr=0.0207 | 8734.5 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.10764 | acc=0.9789 | tpr=0.9698 | fpr=0.0209 | 8307.1 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.10731 | acc=0.9789 | tpr=0.9696 | fpr=0.0210 | 8894.8 samples/s | 34.7 steps/s
[Step= 550] | Loss=0.10637 | acc=0.9790 | tpr=0.9686 | fpr=0.0209 | 14342.7 samples/s | 56.0 steps/s
Avg test loss: 0.10616, Avg test acc: 0.97898, Avg tpr: 0.96870, Avg fpr: 0.02083, total FA: 2892
