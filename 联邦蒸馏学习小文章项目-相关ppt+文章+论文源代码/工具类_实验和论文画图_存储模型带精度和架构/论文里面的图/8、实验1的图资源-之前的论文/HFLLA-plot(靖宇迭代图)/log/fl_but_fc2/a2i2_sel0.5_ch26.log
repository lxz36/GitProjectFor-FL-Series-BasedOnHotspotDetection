#clients of iccad2012: 2
#clients of asml1: 2
select ratio: 0.5
Total num clients: 4
client model path: ['models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0', 'models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1', 'models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0', 'models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_1']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (24958, 144, 26)
Resampled dataset to size (32814, 144, 26)
Using transform option: train
#pos = 17102, #neg = 15712
Allocated dataset with size (24958, 144, 26)
Resampled dataset to size (32737, 144, 26)
Using transform option: train
#pos = 17179, #neg = 15558
loading data into the main memory...
Allocated dataset with size (9150, 144, 26)
Resampled dataset to size (16703, 144, 26)
Using transform option: train
#pos = 8134, #neg = 8569
Allocated dataset with size (9150, 144, 26)
Resampled dataset to size (16626, 144, 26)
Using transform option: train
#pos = 8099, #neg = 8527
loading data into the main memory...
Allocated dataset with size (24958, 144, 26)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 26)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35317 | Reg=0.00356 | acc=0.4844 | L2-Norm=18.874 | L2-Norm(final)=1.969 | 2848.8 samples/s | 44.5 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.34475 | Reg=0.00356 | acc=0.6250 | L2-Norm=18.874 | L2-Norm(final)=1.964 | 6443.1 samples/s | 100.7 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.34023 | Reg=0.00356 | acc=0.6719 | L2-Norm=18.874 | L2-Norm(final)=1.971 | 6501.4 samples/s | 101.6 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.33731 | Reg=0.00356 | acc=0.6094 | L2-Norm=18.874 | L2-Norm(final)=1.987 | 6280.5 samples/s | 98.1 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.33519 | Reg=0.00356 | acc=0.6719 | L2-Norm=18.874 | L2-Norm(final)=2.008 | 6469.8 samples/s | 101.1 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.33381 | Reg=0.00356 | acc=0.6562 | L2-Norm=18.874 | L2-Norm(final)=2.032 | 6347.2 samples/s | 99.2 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.33240 | Reg=0.00356 | acc=0.7031 | L2-Norm=18.874 | L2-Norm(final)=2.056 | 6443.9 samples/s | 100.7 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.33062 | Reg=0.00356 | acc=0.6406 | L2-Norm=18.874 | L2-Norm(final)=2.085 | 6452.3 samples/s | 100.8 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.32923 | Reg=0.00356 | acc=0.6562 | L2-Norm=18.874 | L2-Norm(final)=2.116 | 6400.9 samples/s | 100.0 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.32886 | Reg=0.00356 | acc=0.4844 | L2-Norm=18.874 | L2-Norm(final)=2.147 | 6497.7 samples/s | 101.5 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.32772 | Reg=0.00356 | acc=0.5938 | L2-Norm=18.874 | L2-Norm(final)=2.179 | 8464.6 samples/s | 132.3 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.0] | Loss=0.35221 | Reg=0.00356 | acc=0.5000 | L2-Norm=18.874 | L2-Norm(final)=2.500 | 3977.7 samples/s | 62.2 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.28592 | Reg=0.00341 | acc=0.8594 | L2-Norm=18.458 | L2-Norm(final)=2.514 | 4825.1 samples/s | 75.4 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.24665 | Reg=0.00335 | acc=0.7812 | L2-Norm=18.303 | L2-Norm(final)=2.535 | 5009.3 samples/s | 78.3 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.22117 | Reg=0.00332 | acc=0.8906 | L2-Norm=18.216 | L2-Norm(final)=2.548 | 4764.5 samples/s | 74.4 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.20717 | Reg=0.00330 | acc=0.8906 | L2-Norm=18.156 | L2-Norm(final)=2.560 | 4920.7 samples/s | 76.9 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.19370 | Reg=0.00328 | acc=0.7969 | L2-Norm=18.108 | L2-Norm(final)=2.570 | 4866.2 samples/s | 76.0 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.18530 | Reg=0.00327 | acc=0.9219 | L2-Norm=18.070 | L2-Norm(final)=2.579 | 4705.2 samples/s | 73.5 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.17563 | Reg=0.00325 | acc=0.9531 | L2-Norm=18.040 | L2-Norm(final)=2.588 | 4731.0 samples/s | 73.9 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.16822 | Reg=0.00325 | acc=0.8906 | L2-Norm=18.014 | L2-Norm(final)=2.596 | 5077.7 samples/s | 79.3 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.16050 | Reg=0.00324 | acc=0.9531 | L2-Norm=17.992 | L2-Norm(final)=2.603 | 4931.8 samples/s | 77.1 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.15436 | Reg=0.00323 | acc=0.8750 | L2-Norm=17.973 | L2-Norm(final)=2.610 | 5911.5 samples/s | 92.4 steps/s
[Step=1050 Epoch= 2.1] | Loss=0.14861 | Reg=0.00322 | acc=0.9531 | L2-Norm=17.956 | L2-Norm(final)=2.616 | 1913.6 samples/s | 29.9 steps/s
[Step=1100 Epoch= 2.2] | Loss=0.14298 | Reg=0.00322 | acc=0.9688 | L2-Norm=17.943 | L2-Norm(final)=2.622 | 4991.7 samples/s | 78.0 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.13773 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.932 | L2-Norm(final)=2.629 | 5032.6 samples/s | 78.6 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.13284 | Reg=0.00321 | acc=0.9375 | L2-Norm=17.923 | L2-Norm(final)=2.635 | 5044.2 samples/s | 78.8 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.12918 | Reg=0.00321 | acc=0.9375 | L2-Norm=17.916 | L2-Norm(final)=2.641 | 5022.5 samples/s | 78.5 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.12600 | Reg=0.00321 | acc=0.9688 | L2-Norm=17.909 | L2-Norm(final)=2.646 | 5064.9 samples/s | 79.1 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.12325 | Reg=0.00321 | acc=0.9062 | L2-Norm=17.902 | L2-Norm(final)=2.650 | 5027.1 samples/s | 78.5 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.12036 | Reg=0.00320 | acc=0.9531 | L2-Norm=17.896 | L2-Norm(final)=2.654 | 5087.0 samples/s | 79.5 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.11798 | Reg=0.00320 | acc=0.9375 | L2-Norm=17.890 | L2-Norm(final)=2.658 | 5036.2 samples/s | 78.7 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.11546 | Reg=0.00320 | acc=0.9531 | L2-Norm=17.886 | L2-Norm(final)=2.661 | 5464.1 samples/s | 85.4 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.11310 | Reg=0.00320 | acc=0.9531 | L2-Norm=17.882 | L2-Norm(final)=2.665 | 2035.4 samples/s | 31.8 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.11021 | Reg=0.00320 | acc=0.9375 | L2-Norm=17.880 | L2-Norm(final)=2.668 | 5167.7 samples/s | 80.7 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.10763 | Reg=0.00320 | acc=0.9688 | L2-Norm=17.879 | L2-Norm(final)=2.672 | 5068.6 samples/s | 79.2 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.10547 | Reg=0.00320 | acc=0.9375 | L2-Norm=17.878 | L2-Norm(final)=2.675 | 5151.7 samples/s | 80.5 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.10367 | Reg=0.00320 | acc=0.8906 | L2-Norm=17.877 | L2-Norm(final)=2.678 | 5059.5 samples/s | 79.1 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.10221 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.877 | L2-Norm(final)=2.681 | 5062.2 samples/s | 79.1 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.10035 | Reg=0.00320 | acc=0.9375 | L2-Norm=17.879 | L2-Norm(final)=2.684 | 5076.9 samples/s | 79.3 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.09865 | Reg=0.00320 | acc=0.9688 | L2-Norm=17.881 | L2-Norm(final)=2.686 | 5012.8 samples/s | 78.3 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.09732 | Reg=0.00320 | acc=0.9375 | L2-Norm=17.883 | L2-Norm(final)=2.689 | 5044.6 samples/s | 78.8 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.09625 | Reg=0.00320 | acc=0.9375 | L2-Norm=17.885 | L2-Norm(final)=2.691 | 5020.1 samples/s | 78.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step2000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35625 | Reg=0.00356 | acc=0.4688 | L2-Norm=18.874 | L2-Norm(final)=1.970 | 3959.4 samples/s | 61.9 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.31949 | Reg=0.00356 | acc=0.7188 | L2-Norm=18.874 | L2-Norm(final)=1.985 | 5353.2 samples/s | 83.6 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.30456 | Reg=0.00356 | acc=0.6406 | L2-Norm=18.874 | L2-Norm(final)=2.031 | 5972.4 samples/s | 93.3 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.29331 | Reg=0.00356 | acc=0.8281 | L2-Norm=18.874 | L2-Norm(final)=2.099 | 5769.1 samples/s | 90.1 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.28383 | Reg=0.00356 | acc=0.8750 | L2-Norm=18.874 | L2-Norm(final)=2.181 | 5955.6 samples/s | 93.1 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.27529 | Reg=0.00356 | acc=0.8281 | L2-Norm=18.874 | L2-Norm(final)=2.274 | 8170.6 samples/s | 127.7 steps/s
[Step= 300 Epoch= 1.1] | Loss=0.26709 | Reg=0.00356 | acc=0.8281 | L2-Norm=18.874 | L2-Norm(final)=2.373 | 2042.7 samples/s | 31.9 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.26050 | Reg=0.00356 | acc=0.8750 | L2-Norm=18.874 | L2-Norm(final)=2.473 | 6127.6 samples/s | 95.7 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.25472 | Reg=0.00356 | acc=0.8438 | L2-Norm=18.874 | L2-Norm(final)=2.573 | 5765.4 samples/s | 90.1 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.24900 | Reg=0.00356 | acc=0.8906 | L2-Norm=18.874 | L2-Norm(final)=2.672 | 6120.0 samples/s | 95.6 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.24406 | Reg=0.00356 | acc=0.8906 | L2-Norm=18.874 | L2-Norm(final)=2.771 | 6749.6 samples/s | 105.5 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.9] | Loss=0.17572 | Reg=0.00356 | acc=0.9375 | L2-Norm=18.874 | L2-Norm(final)=3.747 | 3789.5 samples/s | 59.2 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.15305 | Reg=0.00344 | acc=0.9531 | L2-Norm=18.539 | L2-Norm(final)=3.758 | 4691.4 samples/s | 73.3 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.09841 | Reg=0.00339 | acc=0.9688 | L2-Norm=18.412 | L2-Norm(final)=3.784 | 4771.6 samples/s | 74.6 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.07520 | Reg=0.00336 | acc=0.9844 | L2-Norm=18.338 | L2-Norm(final)=3.804 | 4741.4 samples/s | 74.1 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.05942 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.287 | L2-Norm(final)=3.820 | 4733.6 samples/s | 74.0 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.04921 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.246 | L2-Norm(final)=3.834 | 6080.2 samples/s | 95.0 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.04284 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.211 | L2-Norm(final)=3.845 | 1898.6 samples/s | 29.7 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.03709 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.177 | L2-Norm(final)=3.855 | 4743.8 samples/s | 74.1 steps/s
[Step= 900 Epoch= 3.4] | Loss=0.03272 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.145 | L2-Norm(final)=3.863 | 4798.4 samples/s | 75.0 steps/s
[Step= 950 Epoch= 3.6] | Loss=0.02924 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.112 | L2-Norm(final)=3.871 | 4748.7 samples/s | 74.2 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.02645 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.080 | L2-Norm(final)=3.877 | 4653.4 samples/s | 72.7 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.02408 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.048 | L2-Norm(final)=3.884 | 1964.6 samples/s | 30.7 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.02208 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.013 | L2-Norm(final)=3.889 | 4849.2 samples/s | 75.8 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.02039 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.978 | L2-Norm(final)=3.894 | 4723.9 samples/s | 73.8 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.01894 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.942 | L2-Norm(final)=3.898 | 4857.6 samples/s | 75.9 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.01768 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.906 | L2-Norm(final)=3.902 | 4709.7 samples/s | 73.6 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.01660 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.869 | L2-Norm(final)=3.906 | 2055.8 samples/s | 32.1 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.01562 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.833 | L2-Norm(final)=3.909 | 4913.1 samples/s | 76.8 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.01476 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.796 | L2-Norm(final)=3.912 | 4763.7 samples/s | 74.4 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.01398 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.758 | L2-Norm(final)=3.915 | 4741.4 samples/s | 74.1 steps/s
[Step=1500 Epoch= 5.7] | Loss=0.01328 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.721 | L2-Norm(final)=3.917 | 4764.5 samples/s | 74.4 steps/s
[Step=1550 Epoch= 5.9] | Loss=0.01265 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.683 | L2-Norm(final)=3.920 | 2062.6 samples/s | 32.2 steps/s
[Step=1600 Epoch= 6.1] | Loss=0.01208 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.645 | L2-Norm(final)=3.922 | 4827.2 samples/s | 75.4 steps/s
[Step=1650 Epoch= 6.3] | Loss=0.01155 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.607 | L2-Norm(final)=3.924 | 4751.9 samples/s | 74.2 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.01107 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.569 | L2-Norm(final)=3.926 | 4776.6 samples/s | 74.6 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.01063 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.530 | L2-Norm(final)=3.928 | 4756.2 samples/s | 74.3 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.01022 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.492 | L2-Norm(final)=3.930 | 6415.8 samples/s | 100.2 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.00984 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.454 | L2-Norm(final)=3.931 | 1829.7 samples/s | 28.6 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00949 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.415 | L2-Norm(final)=3.933 | 4814.6 samples/s | 75.2 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00917 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.377 | L2-Norm(final)=3.934 | 4914.0 samples/s | 76.8 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00886 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.338 | L2-Norm(final)=3.936 | 4712.8 samples/s | 73.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step2000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.34956 | acc=0.4956 | tpr=0.4821 | fpr=0.4750 | 4321.3 samples/s | 16.9 steps/s
Avg test loss: 0.34982, Avg test acc: 0.49295, Avg tpr: 0.47835, Avg fpr: 0.47494, total FA: 3705

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08010 | acc=0.9414 | tpr=0.9501 | fpr=0.0776 | 4199.5 samples/s | 16.4 steps/s
Avg test loss: 0.08279, Avg test acc: 0.93998, Avg tpr: 0.94999, Avg fpr: 0.08204, total FA: 640

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.28605 | acc=0.3203 | tpr=0.0291 | fpr=0.0473 | 4233.0 samples/s | 16.5 steps/s
Avg test loss: 5.32384, Avg test acc: 0.31729, Avg tpr: 0.02786, Avg fpr: 0.04615, total FA: 360

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=0.34956 | acc=0.4956 | tpr=0.4821 | fpr=0.4750 | 4190.4 samples/s | 16.4 steps/s
Avg test loss: 0.34982, Avg test acc: 0.49295, Avg tpr: 0.47835, Avg fpr: 0.47494, total FA: 3705

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=0.34640 | acc=0.5117 | tpr=0.4513 | fpr=0.4872 | 4194.2 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.34701 | acc=0.5066 | tpr=0.4243 | fpr=0.4919 | 8329.4 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.34729 | acc=0.5046 | tpr=0.4323 | fpr=0.4941 | 8301.5 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.34731 | acc=0.5055 | tpr=0.4306 | fpr=0.4931 | 8306.9 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.34733 | acc=0.5048 | tpr=0.4306 | fpr=0.4939 | 8066.9 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.34729 | acc=0.5055 | tpr=0.4276 | fpr=0.4930 | 8409.2 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.34734 | acc=0.5044 | tpr=0.4308 | fpr=0.4942 | 8175.3 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.34750 | acc=0.5029 | tpr=0.4311 | fpr=0.4958 | 8224.0 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.34757 | acc=0.5026 | tpr=0.4299 | fpr=0.4961 | 8259.8 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.34755 | acc=0.5030 | tpr=0.4295 | fpr=0.4956 | 8315.7 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.34756 | acc=0.5028 | tpr=0.4389 | fpr=0.4961 | 14765.9 samples/s | 57.7 steps/s
Avg test loss: 0.34757, Avg test acc: 0.50267, Avg tpr: 0.43740, Avg fpr: 0.49615, total FA: 68889

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=2.70660 | acc=0.0894 | tpr=0.8363 | fpr=0.9240 | 4212.9 samples/s | 16.5 steps/s
[Step= 100] | Loss=2.69360 | acc=0.0906 | tpr=0.8230 | fpr=0.9230 | 8397.7 samples/s | 32.8 steps/s
[Step= 150] | Loss=2.70220 | acc=0.0912 | tpr=0.8343 | fpr=0.9224 | 8246.4 samples/s | 32.2 steps/s
[Step= 200] | Loss=2.69940 | acc=0.0905 | tpr=0.8317 | fpr=0.9230 | 8341.1 samples/s | 32.6 steps/s
[Step= 250] | Loss=2.69978 | acc=0.0903 | tpr=0.8245 | fpr=0.9231 | 7877.4 samples/s | 30.8 steps/s
[Step= 300] | Loss=2.70231 | acc=0.0905 | tpr=0.8182 | fpr=0.9227 | 8162.4 samples/s | 31.9 steps/s
[Step= 350] | Loss=2.69934 | acc=0.0908 | tpr=0.8134 | fpr=0.9223 | 8240.1 samples/s | 32.2 steps/s
[Step= 400] | Loss=2.69848 | acc=0.0911 | tpr=0.8102 | fpr=0.9219 | 8377.4 samples/s | 32.7 steps/s
[Step= 450] | Loss=2.70029 | acc=0.0910 | tpr=0.8106 | fpr=0.9221 | 8193.1 samples/s | 32.0 steps/s
[Step= 500] | Loss=2.70009 | acc=0.0910 | tpr=0.8123 | fpr=0.9220 | 8165.5 samples/s | 31.9 steps/s
[Step= 550] | Loss=2.70051 | acc=0.0909 | tpr=0.8078 | fpr=0.9221 | 15389.2 samples/s | 60.1 steps/s
Avg test loss: 2.70026, Avg test acc: 0.09092, Avg tpr: 0.80864, Avg fpr: 0.92212, total FA: 128035

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.07540 | acc=0.9809 | tpr=0.9204 | fpr=0.0180 | 4230.0 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.08033 | acc=0.9807 | tpr=0.9318 | fpr=0.0184 | 8334.2 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.08541 | acc=0.9791 | tpr=0.9280 | fpr=0.0199 | 7892.4 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.08576 | acc=0.9794 | tpr=0.9279 | fpr=0.0196 | 8570.1 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.08444 | acc=0.9796 | tpr=0.9301 | fpr=0.0195 | 8177.4 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.08545 | acc=0.9794 | tpr=0.9287 | fpr=0.0197 | 8281.4 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.08570 | acc=0.9793 | tpr=0.9274 | fpr=0.0198 | 8444.8 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.08643 | acc=0.9790 | tpr=0.9234 | fpr=0.0199 | 8431.6 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.08810 | acc=0.9787 | tpr=0.9197 | fpr=0.0202 | 8466.8 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.08742 | acc=0.9788 | tpr=0.9207 | fpr=0.0202 | 7924.3 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.08665 | acc=0.9789 | tpr=0.9204 | fpr=0.0200 | 14666.7 samples/s | 57.3 steps/s
Avg test loss: 0.08660, Avg test acc: 0.97894, Avg tpr: 0.92076, Avg fpr: 0.02001, total FA: 2778

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.34640 | acc=0.5117 | tpr=0.4513 | fpr=0.4872 | 4166.4 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.34701 | acc=0.5066 | tpr=0.4243 | fpr=0.4919 | 8471.3 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.34729 | acc=0.5046 | tpr=0.4323 | fpr=0.4941 | 9074.3 samples/s | 35.4 steps/s
[Step= 200] | Loss=0.34731 | acc=0.5055 | tpr=0.4306 | fpr=0.4931 | 8039.7 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.34733 | acc=0.5048 | tpr=0.4306 | fpr=0.4939 | 8494.6 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.34729 | acc=0.5055 | tpr=0.4276 | fpr=0.4930 | 7945.2 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.34734 | acc=0.5044 | tpr=0.4308 | fpr=0.4942 | 8301.5 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.34750 | acc=0.5029 | tpr=0.4311 | fpr=0.4958 | 8149.1 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.34757 | acc=0.5026 | tpr=0.4299 | fpr=0.4961 | 8367.9 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.34755 | acc=0.5030 | tpr=0.4295 | fpr=0.4956 | 8569.6 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.34756 | acc=0.5028 | tpr=0.4389 | fpr=0.4961 | 14906.6 samples/s | 58.2 steps/s
Avg test loss: 0.34757, Avg test acc: 0.50267, Avg tpr: 0.43740, Avg fpr: 0.49615, total FA: 68889

server round 1/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.32466 | Reg=0.00291 | acc=0.6562 | L2-Norm=17.067 | L2-Norm(final)=1.970 | 4159.2 samples/s | 65.0 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.30380 | Reg=0.00291 | acc=0.8125 | L2-Norm=17.067 | L2-Norm(final)=2.021 | 5069.9 samples/s | 79.2 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.28973 | Reg=0.00291 | acc=0.8281 | L2-Norm=17.067 | L2-Norm(final)=2.105 | 6423.4 samples/s | 100.4 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.28156 | Reg=0.00291 | acc=0.6250 | L2-Norm=17.067 | L2-Norm(final)=2.198 | 6452.8 samples/s | 100.8 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.27334 | Reg=0.00291 | acc=0.8125 | L2-Norm=17.067 | L2-Norm(final)=2.296 | 6343.6 samples/s | 99.1 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.26577 | Reg=0.00291 | acc=0.7812 | L2-Norm=17.067 | L2-Norm(final)=2.395 | 6268.0 samples/s | 97.9 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.26074 | Reg=0.00291 | acc=0.8281 | L2-Norm=17.067 | L2-Norm(final)=2.492 | 6472.5 samples/s | 101.1 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.25614 | Reg=0.00291 | acc=0.7969 | L2-Norm=17.067 | L2-Norm(final)=2.586 | 6404.9 samples/s | 100.1 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.25189 | Reg=0.00291 | acc=0.7969 | L2-Norm=17.067 | L2-Norm(final)=2.677 | 6322.6 samples/s | 98.8 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.24871 | Reg=0.00291 | acc=0.8281 | L2-Norm=17.067 | L2-Norm(final)=2.766 | 6379.5 samples/s | 99.7 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.24572 | Reg=0.00291 | acc=0.7344 | L2-Norm=17.067 | L2-Norm(final)=2.851 | 8288.7 samples/s | 129.5 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.0] | Loss=0.21523 | Reg=0.00291 | acc=0.8438 | L2-Norm=17.067 | L2-Norm(final)=3.686 | 3723.3 samples/s | 58.2 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.17869 | Reg=0.00286 | acc=0.9062 | L2-Norm=16.923 | L2-Norm(final)=3.702 | 4728.1 samples/s | 73.9 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.16734 | Reg=0.00286 | acc=0.9062 | L2-Norm=16.900 | L2-Norm(final)=3.702 | 5070.4 samples/s | 79.2 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.14973 | Reg=0.00286 | acc=0.8750 | L2-Norm=16.900 | L2-Norm(final)=3.708 | 5000.0 samples/s | 78.1 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.14236 | Reg=0.00286 | acc=0.9375 | L2-Norm=16.905 | L2-Norm(final)=3.710 | 5142.9 samples/s | 80.4 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.13546 | Reg=0.00286 | acc=0.9219 | L2-Norm=16.912 | L2-Norm(final)=3.714 | 5125.8 samples/s | 80.1 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.12969 | Reg=0.00286 | acc=0.9219 | L2-Norm=16.921 | L2-Norm(final)=3.719 | 5146.3 samples/s | 80.4 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.12505 | Reg=0.00287 | acc=0.9219 | L2-Norm=16.930 | L2-Norm(final)=3.724 | 5104.6 samples/s | 79.8 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.12137 | Reg=0.00287 | acc=0.9375 | L2-Norm=16.940 | L2-Norm(final)=3.729 | 5076.8 samples/s | 79.3 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.11707 | Reg=0.00287 | acc=0.9844 | L2-Norm=16.950 | L2-Norm(final)=3.734 | 5063.0 samples/s | 79.1 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.11393 | Reg=0.00288 | acc=0.9375 | L2-Norm=16.961 | L2-Norm(final)=3.738 | 6176.9 samples/s | 96.5 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.10959 | Reg=0.00288 | acc=0.9688 | L2-Norm=16.971 | L2-Norm(final)=3.742 | 1907.8 samples/s | 29.8 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.10605 | Reg=0.00288 | acc=0.9844 | L2-Norm=16.982 | L2-Norm(final)=3.748 | 5088.0 samples/s | 79.5 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.10302 | Reg=0.00289 | acc=0.9375 | L2-Norm=16.992 | L2-Norm(final)=3.753 | 5045.3 samples/s | 78.8 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.10036 | Reg=0.00289 | acc=0.9375 | L2-Norm=17.004 | L2-Norm(final)=3.757 | 4974.8 samples/s | 77.7 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.09813 | Reg=0.00290 | acc=0.9531 | L2-Norm=17.017 | L2-Norm(final)=3.762 | 5034.4 samples/s | 78.7 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.09568 | Reg=0.00290 | acc=0.9531 | L2-Norm=17.029 | L2-Norm(final)=3.766 | 5061.3 samples/s | 79.1 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.09338 | Reg=0.00290 | acc=0.9844 | L2-Norm=17.042 | L2-Norm(final)=3.770 | 5047.6 samples/s | 78.9 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.09185 | Reg=0.00291 | acc=0.9375 | L2-Norm=17.054 | L2-Norm(final)=3.774 | 5034.3 samples/s | 78.7 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.09078 | Reg=0.00291 | acc=0.9844 | L2-Norm=17.067 | L2-Norm(final)=3.777 | 5060.8 samples/s | 79.1 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.08891 | Reg=0.00292 | acc=0.9688 | L2-Norm=17.079 | L2-Norm(final)=3.779 | 5355.9 samples/s | 83.7 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.08766 | Reg=0.00292 | acc=0.9531 | L2-Norm=17.091 | L2-Norm(final)=3.781 | 1980.5 samples/s | 30.9 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.08552 | Reg=0.00293 | acc=0.9688 | L2-Norm=17.103 | L2-Norm(final)=3.783 | 5085.1 samples/s | 79.5 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.08388 | Reg=0.00293 | acc=0.9688 | L2-Norm=17.115 | L2-Norm(final)=3.785 | 4979.6 samples/s | 77.8 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.08216 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.126 | L2-Norm(final)=3.787 | 5011.6 samples/s | 78.3 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.08082 | Reg=0.00294 | acc=0.9688 | L2-Norm=17.136 | L2-Norm(final)=3.789 | 5003.1 samples/s | 78.2 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.07943 | Reg=0.00294 | acc=0.9531 | L2-Norm=17.146 | L2-Norm(final)=3.791 | 5063.9 samples/s | 79.1 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.07840 | Reg=0.00294 | acc=0.8906 | L2-Norm=17.156 | L2-Norm(final)=3.792 | 5085.4 samples/s | 79.5 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.07748 | Reg=0.00295 | acc=0.9375 | L2-Norm=17.166 | L2-Norm(final)=3.793 | 5011.3 samples/s | 78.3 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.07672 | Reg=0.00295 | acc=0.9062 | L2-Norm=17.177 | L2-Norm(final)=3.794 | 5064.6 samples/s | 79.1 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.07568 | Reg=0.00295 | acc=0.9688 | L2-Norm=17.187 | L2-Norm(final)=3.795 | 5002.8 samples/s | 78.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step2000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 3.9] | Loss=0.25938 | Reg=0.00291 | acc=0.7656 | L2-Norm=17.067 | L2-Norm(final)=2.755 | 3895.4 samples/s | 60.9 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.25557 | Reg=0.00292 | acc=0.8438 | L2-Norm=17.073 | L2-Norm(final)=2.834 | 5354.3 samples/s | 83.7 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.24621 | Reg=0.00292 | acc=0.8281 | L2-Norm=17.075 | L2-Norm(final)=2.930 | 5778.4 samples/s | 90.3 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.24272 | Reg=0.00292 | acc=0.7656 | L2-Norm=17.076 | L2-Norm(final)=3.020 | 5740.5 samples/s | 89.7 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.23879 | Reg=0.00292 | acc=0.8906 | L2-Norm=17.076 | L2-Norm(final)=3.108 | 5868.3 samples/s | 91.7 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.23594 | Reg=0.00292 | acc=0.8750 | L2-Norm=17.076 | L2-Norm(final)=3.192 | 5806.8 samples/s | 90.7 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.23396 | Reg=0.00292 | acc=0.7656 | L2-Norm=17.076 | L2-Norm(final)=3.272 | 5750.6 samples/s | 89.9 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.23165 | Reg=0.00292 | acc=0.8438 | L2-Norm=17.076 | L2-Norm(final)=3.349 | 5863.2 samples/s | 91.6 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.22972 | Reg=0.00292 | acc=0.7812 | L2-Norm=17.077 | L2-Norm(final)=3.422 | 5716.8 samples/s | 89.3 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.22879 | Reg=0.00292 | acc=0.8750 | L2-Norm=17.077 | L2-Norm(final)=3.491 | 5844.3 samples/s | 91.3 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.22764 | Reg=0.00292 | acc=0.8125 | L2-Norm=17.077 | L2-Norm(final)=3.556 | 7232.0 samples/s | 113.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 4.9] | Loss=0.23421 | Reg=0.00292 | acc=0.7969 | L2-Norm=17.077 | L2-Norm(final)=4.179 | 4095.8 samples/s | 64.0 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.20661 | Reg=0.00297 | acc=0.9219 | L2-Norm=17.223 | L2-Norm(final)=4.164 | 4663.5 samples/s | 72.9 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.16818 | Reg=0.00300 | acc=0.8281 | L2-Norm=17.316 | L2-Norm(final)=4.161 | 4996.0 samples/s | 78.1 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.15702 | Reg=0.00302 | acc=0.9375 | L2-Norm=17.364 | L2-Norm(final)=4.158 | 5098.6 samples/s | 79.7 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.14753 | Reg=0.00303 | acc=0.9531 | L2-Norm=17.393 | L2-Norm(final)=4.156 | 4925.4 samples/s | 77.0 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.13667 | Reg=0.00303 | acc=0.9375 | L2-Norm=17.408 | L2-Norm(final)=4.156 | 5094.1 samples/s | 79.6 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.12926 | Reg=0.00303 | acc=0.8750 | L2-Norm=17.419 | L2-Norm(final)=4.157 | 4955.4 samples/s | 77.4 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.12301 | Reg=0.00304 | acc=0.9219 | L2-Norm=17.428 | L2-Norm(final)=4.156 | 5098.3 samples/s | 79.7 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.11816 | Reg=0.00304 | acc=0.9531 | L2-Norm=17.434 | L2-Norm(final)=4.155 | 5002.5 samples/s | 78.2 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.11351 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.439 | L2-Norm(final)=4.155 | 5020.3 samples/s | 78.4 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.10972 | Reg=0.00304 | acc=0.9844 | L2-Norm=17.444 | L2-Norm(final)=4.155 | 6251.5 samples/s | 97.7 steps/s
[Step=3050 Epoch= 6.0] | Loss=0.10531 | Reg=0.00304 | acc=0.9531 | L2-Norm=17.449 | L2-Norm(final)=4.156 | 1918.1 samples/s | 30.0 steps/s
[Step=3100 Epoch= 6.1] | Loss=0.10100 | Reg=0.00305 | acc=0.9688 | L2-Norm=17.455 | L2-Norm(final)=4.157 | 4989.3 samples/s | 78.0 steps/s
[Step=3150 Epoch= 6.2] | Loss=0.09722 | Reg=0.00305 | acc=0.9844 | L2-Norm=17.461 | L2-Norm(final)=4.158 | 5024.4 samples/s | 78.5 steps/s
[Step=3200 Epoch= 6.3] | Loss=0.09498 | Reg=0.00305 | acc=0.9375 | L2-Norm=17.466 | L2-Norm(final)=4.159 | 5014.1 samples/s | 78.3 steps/s
[Step=3250 Epoch= 6.4] | Loss=0.09274 | Reg=0.00305 | acc=0.9219 | L2-Norm=17.470 | L2-Norm(final)=4.160 | 5040.7 samples/s | 78.8 steps/s
[Step=3300 Epoch= 6.5] | Loss=0.09096 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.474 | L2-Norm(final)=4.160 | 5048.6 samples/s | 78.9 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.08921 | Reg=0.00305 | acc=0.9531 | L2-Norm=17.478 | L2-Norm(final)=4.159 | 5055.5 samples/s | 79.0 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.08779 | Reg=0.00306 | acc=0.9531 | L2-Norm=17.481 | L2-Norm(final)=4.159 | 5037.4 samples/s | 78.7 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.08629 | Reg=0.00306 | acc=0.9531 | L2-Norm=17.485 | L2-Norm(final)=4.158 | 5039.3 samples/s | 78.7 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.08473 | Reg=0.00306 | acc=0.9375 | L2-Norm=17.490 | L2-Norm(final)=4.158 | 5435.0 samples/s | 84.9 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.08309 | Reg=0.00306 | acc=0.9219 | L2-Norm=17.494 | L2-Norm(final)=4.158 | 2008.6 samples/s | 31.4 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.08124 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.499 | L2-Norm(final)=4.158 | 4937.5 samples/s | 77.1 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.07927 | Reg=0.00306 | acc=0.9688 | L2-Norm=17.504 | L2-Norm(final)=4.158 | 5050.0 samples/s | 78.9 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.07761 | Reg=0.00307 | acc=0.9688 | L2-Norm=17.509 | L2-Norm(final)=4.158 | 5002.1 samples/s | 78.2 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.07641 | Reg=0.00307 | acc=0.9688 | L2-Norm=17.514 | L2-Norm(final)=4.158 | 5024.2 samples/s | 78.5 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.07546 | Reg=0.00307 | acc=0.9219 | L2-Norm=17.519 | L2-Norm(final)=4.158 | 5141.2 samples/s | 80.3 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.07434 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.525 | L2-Norm(final)=4.157 | 4979.1 samples/s | 77.8 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.07354 | Reg=0.00307 | acc=0.9688 | L2-Norm=17.530 | L2-Norm(final)=4.157 | 5014.6 samples/s | 78.4 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.07254 | Reg=0.00308 | acc=0.9688 | L2-Norm=17.536 | L2-Norm(final)=4.156 | 5041.1 samples/s | 78.8 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.07171 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.541 | L2-Norm(final)=4.155 | 5040.0 samples/s | 78.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07353 | acc=0.9510 | tpr=0.9690 | fpr=0.0880 | 4240.3 samples/s | 16.6 steps/s
Avg test loss: 0.07499, Avg test acc: 0.94976, Avg tpr: 0.96777, Avg fpr: 0.08986, total FA: 701

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07788 | acc=0.9427 | tpr=0.9456 | fpr=0.0637 | 4265.1 samples/s | 16.7 steps/s
Avg test loss: 0.07950, Avg test acc: 0.94242, Avg tpr: 0.94626, Avg fpr: 0.06602, total FA: 515

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.28605 | acc=0.3203 | tpr=0.0291 | fpr=0.0473 | 4158.9 samples/s | 16.2 steps/s
Avg test loss: 5.32384, Avg test acc: 0.31729, Avg tpr: 0.02786, Avg fpr: 0.04615, total FA: 360

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=0.34956 | acc=0.4956 | tpr=0.4821 | fpr=0.4750 | 4157.6 samples/s | 16.2 steps/s
Avg test loss: 0.34982, Avg test acc: 0.49295, Avg tpr: 0.47835, Avg fpr: 0.47494, total FA: 3705

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=2.79180 | acc=0.1289 | tpr=0.8938 | fpr=0.8848 | 4210.2 samples/s | 16.4 steps/s
[Step= 100] | Loss=2.77467 | acc=0.1313 | tpr=0.8955 | fpr=0.8829 | 8044.2 samples/s | 31.4 steps/s
[Step= 150] | Loss=2.78028 | acc=0.1310 | tpr=0.8963 | fpr=0.8831 | 8320.1 samples/s | 32.5 steps/s
[Step= 200] | Loss=2.78257 | acc=0.1308 | tpr=0.8918 | fpr=0.8830 | 8372.2 samples/s | 32.7 steps/s
[Step= 250] | Loss=2.78188 | acc=0.1307 | tpr=0.8908 | fpr=0.8831 | 8502.8 samples/s | 33.2 steps/s
[Step= 300] | Loss=2.78083 | acc=0.1308 | tpr=0.8865 | fpr=0.8830 | 8219.6 samples/s | 32.1 steps/s
[Step= 350] | Loss=2.78038 | acc=0.1309 | tpr=0.8829 | fpr=0.8828 | 8300.9 samples/s | 32.4 steps/s
[Step= 400] | Loss=2.78315 | acc=0.1307 | tpr=0.8857 | fpr=0.8830 | 8361.6 samples/s | 32.7 steps/s
[Step= 450] | Loss=2.78402 | acc=0.1305 | tpr=0.8885 | fpr=0.8833 | 8068.2 samples/s | 31.5 steps/s
[Step= 500] | Loss=2.78614 | acc=0.1303 | tpr=0.8868 | fpr=0.8834 | 8487.0 samples/s | 33.2 steps/s
[Step= 550] | Loss=2.78659 | acc=0.1304 | tpr=0.8850 | fpr=0.8833 | 14542.7 samples/s | 56.8 steps/s
Avg test loss: 2.78645, Avg test acc: 0.13034, Avg tpr: 0.88510, Avg fpr: 0.88338, total FA: 122656

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=2.55687 | acc=0.1277 | tpr=0.7965 | fpr=0.8843 | 4256.1 samples/s | 16.6 steps/s
[Step= 100] | Loss=2.54175 | acc=0.1284 | tpr=0.7868 | fpr=0.8839 | 8155.5 samples/s | 31.9 steps/s
[Step= 150] | Loss=2.54645 | acc=0.1285 | tpr=0.7752 | fpr=0.8834 | 8834.5 samples/s | 34.5 steps/s
[Step= 200] | Loss=2.54755 | acc=0.1286 | tpr=0.7650 | fpr=0.8830 | 7920.8 samples/s | 30.9 steps/s
[Step= 250] | Loss=2.54567 | acc=0.1291 | tpr=0.7651 | fpr=0.8825 | 8230.5 samples/s | 32.2 steps/s
[Step= 300] | Loss=2.54611 | acc=0.1293 | tpr=0.7658 | fpr=0.8823 | 8360.4 samples/s | 32.7 steps/s
[Step= 350] | Loss=2.54427 | acc=0.1297 | tpr=0.7727 | fpr=0.8820 | 8306.6 samples/s | 32.4 steps/s
[Step= 400] | Loss=2.54459 | acc=0.1297 | tpr=0.7713 | fpr=0.8820 | 8223.6 samples/s | 32.1 steps/s
[Step= 450] | Loss=2.54520 | acc=0.1293 | tpr=0.7683 | fpr=0.8822 | 8049.7 samples/s | 31.4 steps/s
[Step= 500] | Loss=2.54506 | acc=0.1290 | tpr=0.7678 | fpr=0.8825 | 8205.7 samples/s | 32.1 steps/s
[Step= 550] | Loss=2.54613 | acc=0.1290 | tpr=0.7648 | fpr=0.8826 | 15759.4 samples/s | 61.6 steps/s
Avg test loss: 2.54567, Avg test acc: 0.12896, Avg tpr: 0.76506, Avg fpr: 0.88261, total FA: 122548

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.07540 | acc=0.9809 | tpr=0.9204 | fpr=0.0180 | 4309.3 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.08033 | acc=0.9807 | tpr=0.9318 | fpr=0.0184 | 8244.2 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.08541 | acc=0.9791 | tpr=0.9280 | fpr=0.0199 | 7846.8 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.08576 | acc=0.9794 | tpr=0.9279 | fpr=0.0196 | 8367.8 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.08444 | acc=0.9796 | tpr=0.9301 | fpr=0.0195 | 8225.2 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.08545 | acc=0.9794 | tpr=0.9287 | fpr=0.0197 | 8212.2 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.08570 | acc=0.9793 | tpr=0.9274 | fpr=0.0198 | 8647.5 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.08643 | acc=0.9790 | tpr=0.9234 | fpr=0.0199 | 8318.5 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.08810 | acc=0.9787 | tpr=0.9197 | fpr=0.0202 | 7932.6 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.08742 | acc=0.9788 | tpr=0.9207 | fpr=0.0202 | 8528.5 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.08665 | acc=0.9789 | tpr=0.9204 | fpr=0.0200 | 14703.1 samples/s | 57.4 steps/s
Avg test loss: 0.08660, Avg test acc: 0.97894, Avg tpr: 0.92076, Avg fpr: 0.02001, total FA: 2778

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.34640 | acc=0.5117 | tpr=0.4513 | fpr=0.4872 | 4215.0 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.34701 | acc=0.5066 | tpr=0.4243 | fpr=0.4919 | 8367.9 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.34729 | acc=0.5046 | tpr=0.4323 | fpr=0.4941 | 8135.7 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.34731 | acc=0.5055 | tpr=0.4306 | fpr=0.4931 | 8470.1 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.34733 | acc=0.5048 | tpr=0.4306 | fpr=0.4939 | 8595.3 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.34729 | acc=0.5055 | tpr=0.4276 | fpr=0.4930 | 8194.0 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.34734 | acc=0.5044 | tpr=0.4308 | fpr=0.4942 | 8259.8 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.34750 | acc=0.5029 | tpr=0.4311 | fpr=0.4958 | 8421.4 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.34757 | acc=0.5026 | tpr=0.4299 | fpr=0.4961 | 8351.6 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.34755 | acc=0.5030 | tpr=0.4295 | fpr=0.4956 | 8079.9 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.34756 | acc=0.5028 | tpr=0.4389 | fpr=0.4961 | 15579.4 samples/s | 60.9 steps/s
Avg test loss: 0.34757, Avg test acc: 0.50267, Avg tpr: 0.43740, Avg fpr: 0.49615, total FA: 68889

server round 2/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 7.7] | Loss=0.17096 | Reg=0.00268 | acc=0.8750 | L2-Norm=16.378 | L2-Norm(final)=3.975 | 3807.0 samples/s | 59.5 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.10979 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.366 | L2-Norm(final)=4.114 | 4994.9 samples/s | 78.0 steps/s
[Step=2100 Epoch= 8.0] | Loss=0.10543 | Reg=0.00268 | acc=0.9531 | L2-Norm=16.365 | L2-Norm(final)=4.332 | 5463.6 samples/s | 85.4 steps/s
[Step=2150 Epoch= 8.2] | Loss=0.10023 | Reg=0.00268 | acc=0.9531 | L2-Norm=16.364 | L2-Norm(final)=4.506 | 5442.4 samples/s | 85.0 steps/s
[Step=2200 Epoch= 8.4] | Loss=0.09641 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.364 | L2-Norm(final)=4.664 | 5444.3 samples/s | 85.1 steps/s
[Step=2250 Epoch= 8.6] | Loss=0.09242 | Reg=0.00268 | acc=0.9688 | L2-Norm=16.364 | L2-Norm(final)=4.807 | 7204.5 samples/s | 112.6 steps/s
[Step=2300 Epoch= 8.8] | Loss=0.08966 | Reg=0.00268 | acc=0.9531 | L2-Norm=16.364 | L2-Norm(final)=4.941 | 1995.3 samples/s | 31.2 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.08716 | Reg=0.00268 | acc=0.9688 | L2-Norm=16.364 | L2-Norm(final)=5.067 | 5564.1 samples/s | 86.9 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.08597 | Reg=0.00268 | acc=0.9375 | L2-Norm=16.363 | L2-Norm(final)=5.186 | 5498.3 samples/s | 85.9 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.08456 | Reg=0.00268 | acc=0.9531 | L2-Norm=16.363 | L2-Norm(final)=5.295 | 5615.1 samples/s | 87.7 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.08341 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.363 | L2-Norm(final)=5.396 | 6193.0 samples/s | 96.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 9.6] | Loss=0.08275 | Reg=0.00268 | acc=0.9219 | L2-Norm=16.363 | L2-Norm(final)=6.365 | 3698.0 samples/s | 57.8 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.06614 | Reg=0.00279 | acc=0.9844 | L2-Norm=16.697 | L2-Norm(final)=6.335 | 4749.6 samples/s | 74.2 steps/s
[Step=2600 Epoch=10.0] | Loss=0.03900 | Reg=0.00283 | acc=0.9844 | L2-Norm=16.828 | L2-Norm(final)=6.320 | 4772.6 samples/s | 74.6 steps/s
[Step=2650 Epoch=10.2] | Loss=0.02999 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.852 | L2-Norm(final)=6.316 | 4771.8 samples/s | 74.6 steps/s
[Step=2700 Epoch=10.3] | Loss=0.02341 | Reg=0.00284 | acc=0.9844 | L2-Norm=16.850 | L2-Norm(final)=6.316 | 4728.1 samples/s | 73.9 steps/s
[Step=2750 Epoch=10.5] | Loss=0.02097 | Reg=0.00284 | acc=0.9844 | L2-Norm=16.840 | L2-Norm(final)=6.315 | 6017.3 samples/s | 94.0 steps/s
[Step=2800 Epoch=10.7] | Loss=0.01821 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.827 | L2-Norm(final)=6.314 | 1891.5 samples/s | 29.6 steps/s
[Step=2850 Epoch=10.9] | Loss=0.01589 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.807 | L2-Norm(final)=6.313 | 4739.8 samples/s | 74.1 steps/s
[Step=2900 Epoch=11.1] | Loss=0.01395 | Reg=0.00282 | acc=0.9844 | L2-Norm=16.784 | L2-Norm(final)=6.314 | 4778.5 samples/s | 74.7 steps/s
[Step=2950 Epoch=11.3] | Loss=0.01243 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.756 | L2-Norm(final)=6.314 | 4750.2 samples/s | 74.2 steps/s
[Step=3000 Epoch=11.5] | Loss=0.01148 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.727 | L2-Norm(final)=6.315 | 5289.2 samples/s | 82.6 steps/s
[Step=3050 Epoch=11.7] | Loss=0.01053 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.699 | L2-Norm(final)=6.316 | 1967.1 samples/s | 30.7 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00968 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.670 | L2-Norm(final)=6.317 | 4785.1 samples/s | 74.8 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00895 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.640 | L2-Norm(final)=6.318 | 4800.4 samples/s | 75.0 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00831 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.609 | L2-Norm(final)=6.319 | 4761.0 samples/s | 74.4 steps/s
[Step=3250 Epoch=12.5] | Loss=0.00776 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.577 | L2-Norm(final)=6.321 | 4720.2 samples/s | 73.8 steps/s
[Step=3300 Epoch=12.6] | Loss=0.00728 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.545 | L2-Norm(final)=6.322 | 2043.8 samples/s | 31.9 steps/s
[Step=3350 Epoch=12.8] | Loss=0.00685 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.512 | L2-Norm(final)=6.323 | 4831.0 samples/s | 75.5 steps/s
[Step=3400 Epoch=13.0] | Loss=0.00647 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.478 | L2-Norm(final)=6.324 | 4761.0 samples/s | 74.4 steps/s
[Step=3450 Epoch=13.2] | Loss=0.00613 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.445 | L2-Norm(final)=6.324 | 4753.9 samples/s | 74.3 steps/s
[Step=3500 Epoch=13.4] | Loss=0.00583 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.411 | L2-Norm(final)=6.325 | 4804.8 samples/s | 75.1 steps/s
[Step=3550 Epoch=13.6] | Loss=0.00555 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.377 | L2-Norm(final)=6.326 | 2038.4 samples/s | 31.9 steps/s
[Step=3600 Epoch=13.8] | Loss=0.00530 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.343 | L2-Norm(final)=6.327 | 4842.4 samples/s | 75.7 steps/s
[Step=3650 Epoch=14.0] | Loss=0.00507 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.309 | L2-Norm(final)=6.327 | 4853.3 samples/s | 75.8 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00486 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.275 | L2-Norm(final)=6.328 | 4725.5 samples/s | 73.8 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00466 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.240 | L2-Norm(final)=6.328 | 4777.4 samples/s | 74.6 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00448 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.206 | L2-Norm(final)=6.329 | 6520.3 samples/s | 101.9 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00432 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.172 | L2-Norm(final)=6.330 | 1837.9 samples/s | 28.7 steps/s
[Step=3900 Epoch=14.9] | Loss=0.00417 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.138 | L2-Norm(final)=6.330 | 4757.7 samples/s | 74.3 steps/s
[Step=3950 Epoch=15.1] | Loss=0.00402 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.104 | L2-Norm(final)=6.331 | 4743.9 samples/s | 74.1 steps/s
[Step=4000 Epoch=15.3] | Loss=0.00389 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.069 | L2-Norm(final)=6.331 | 4767.5 samples/s | 74.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step4000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34417 | Reg=0.00268 | acc=0.4844 | L2-Norm=16.378 | L2-Norm(final)=1.970 | 3956.1 samples/s | 61.8 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.28187 | Reg=0.00268 | acc=0.8125 | L2-Norm=16.378 | L2-Norm(final)=2.045 | 5213.0 samples/s | 81.5 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.24827 | Reg=0.00268 | acc=0.8750 | L2-Norm=16.378 | L2-Norm(final)=2.187 | 6004.0 samples/s | 93.8 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.22439 | Reg=0.00268 | acc=0.9219 | L2-Norm=16.378 | L2-Norm(final)=2.350 | 6036.8 samples/s | 94.3 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.20662 | Reg=0.00268 | acc=0.9219 | L2-Norm=16.378 | L2-Norm(final)=2.515 | 6040.8 samples/s | 94.4 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.19172 | Reg=0.00268 | acc=0.9531 | L2-Norm=16.378 | L2-Norm(final)=2.679 | 8154.1 samples/s | 127.4 steps/s
[Step= 300 Epoch= 1.2] | Loss=0.18174 | Reg=0.00268 | acc=0.9062 | L2-Norm=16.378 | L2-Norm(final)=2.837 | 2021.1 samples/s | 31.6 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.17310 | Reg=0.00268 | acc=0.9219 | L2-Norm=16.378 | L2-Norm(final)=2.988 | 5896.2 samples/s | 92.1 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.16535 | Reg=0.00268 | acc=0.9688 | L2-Norm=16.378 | L2-Norm(final)=3.134 | 6094.4 samples/s | 95.2 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.15867 | Reg=0.00268 | acc=0.9531 | L2-Norm=16.378 | L2-Norm(final)=3.274 | 5900.6 samples/s | 92.2 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.15369 | Reg=0.00268 | acc=0.9531 | L2-Norm=16.378 | L2-Norm(final)=3.408 | 7048.0 samples/s | 110.1 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.9] | Loss=0.09280 | Reg=0.00268 | acc=0.9531 | L2-Norm=16.378 | L2-Norm(final)=4.723 | 3770.1 samples/s | 58.9 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.05890 | Reg=0.00266 | acc=0.9688 | L2-Norm=16.311 | L2-Norm(final)=4.755 | 4651.6 samples/s | 72.7 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.03921 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.306 | L2-Norm(final)=4.767 | 4910.0 samples/s | 76.7 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.02958 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.303 | L2-Norm(final)=4.775 | 4771.5 samples/s | 74.6 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.02654 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.299 | L2-Norm(final)=4.780 | 4818.8 samples/s | 75.3 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.02249 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.297 | L2-Norm(final)=4.785 | 6103.7 samples/s | 95.4 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.01903 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.292 | L2-Norm(final)=4.790 | 1883.1 samples/s | 29.4 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.01661 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.282 | L2-Norm(final)=4.795 | 4718.4 samples/s | 73.7 steps/s
[Step= 900 Epoch= 3.5] | Loss=0.01459 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.269 | L2-Norm(final)=4.799 | 4829.5 samples/s | 75.5 steps/s
[Step= 950 Epoch= 3.7] | Loss=0.01308 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.251 | L2-Norm(final)=4.803 | 4719.0 samples/s | 73.7 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.01188 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.233 | L2-Norm(final)=4.807 | 5427.6 samples/s | 84.8 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.01086 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.214 | L2-Norm(final)=4.811 | 1960.0 samples/s | 30.6 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.01079 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.198 | L2-Norm(final)=4.814 | 4767.9 samples/s | 74.5 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.01015 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.190 | L2-Norm(final)=4.815 | 4827.1 samples/s | 75.4 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.00965 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.181 | L2-Norm(final)=4.817 | 4749.3 samples/s | 74.2 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.00956 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.175 | L2-Norm(final)=4.818 | 4886.8 samples/s | 76.4 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.00965 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.173 | L2-Norm(final)=4.817 | 2049.2 samples/s | 32.0 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.00923 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.173 | L2-Norm(final)=4.816 | 4948.3 samples/s | 77.3 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.00901 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.172 | L2-Norm(final)=4.816 | 4690.0 samples/s | 73.3 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.00862 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.170 | L2-Norm(final)=4.815 | 4807.8 samples/s | 75.1 steps/s
[Step=1500 Epoch= 5.8] | Loss=0.00821 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.166 | L2-Norm(final)=4.815 | 4791.7 samples/s | 74.9 steps/s
[Step=1550 Epoch= 6.0] | Loss=0.00783 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.160 | L2-Norm(final)=4.815 | 2045.4 samples/s | 32.0 steps/s
[Step=1600 Epoch= 6.2] | Loss=0.00747 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.151 | L2-Norm(final)=4.814 | 4895.2 samples/s | 76.5 steps/s
[Step=1650 Epoch= 6.4] | Loss=0.00715 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.141 | L2-Norm(final)=4.814 | 4782.1 samples/s | 74.7 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.00685 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.129 | L2-Norm(final)=4.815 | 4767.5 samples/s | 74.5 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.00658 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.116 | L2-Norm(final)=4.815 | 4793.1 samples/s | 74.9 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.00633 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.101 | L2-Norm(final)=4.815 | 7021.7 samples/s | 109.7 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.00610 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.085 | L2-Norm(final)=4.815 | 1808.4 samples/s | 28.3 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00588 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.068 | L2-Norm(final)=4.815 | 4815.1 samples/s | 75.2 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00568 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.050 | L2-Norm(final)=4.816 | 4819.9 samples/s | 75.3 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00549 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.031 | L2-Norm(final)=4.816 | 4844.1 samples/s | 75.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_1/client_state-step2000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07353 | acc=0.9510 | tpr=0.9690 | fpr=0.0880 | 4144.7 samples/s | 16.2 steps/s
Avg test loss: 0.07499, Avg test acc: 0.94976, Avg tpr: 0.96777, Avg fpr: 0.08986, total FA: 701

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07788 | acc=0.9427 | tpr=0.9456 | fpr=0.0637 | 4194.4 samples/s | 16.4 steps/s
Avg test loss: 0.07950, Avg test acc: 0.94242, Avg tpr: 0.94626, Avg fpr: 0.06602, total FA: 515

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.92233 | acc=0.3254 | tpr=0.0308 | fpr=0.0349 | 4226.6 samples/s | 16.5 steps/s
Avg test loss: 4.93675, Avg test acc: 0.32182, Avg tpr: 0.02955, Avg fpr: 0.03538, total FA: 276

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.07969 | acc=0.3213 | tpr=0.0343 | fpr=0.0555 | 4230.3 samples/s | 16.5 steps/s
Avg test loss: 5.09285, Avg test acc: 0.31813, Avg tpr: 0.03351, Avg fpr: 0.05589, total FA: 436

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=2.79180 | acc=0.1289 | tpr=0.8938 | fpr=0.8848 | 4188.7 samples/s | 16.4 steps/s
[Step= 100] | Loss=2.77467 | acc=0.1313 | tpr=0.8955 | fpr=0.8829 | 8167.8 samples/s | 31.9 steps/s
[Step= 150] | Loss=2.78028 | acc=0.1310 | tpr=0.8963 | fpr=0.8831 | 8349.1 samples/s | 32.6 steps/s
[Step= 200] | Loss=2.78257 | acc=0.1308 | tpr=0.8918 | fpr=0.8830 | 8638.0 samples/s | 33.7 steps/s
[Step= 250] | Loss=2.78188 | acc=0.1307 | tpr=0.8908 | fpr=0.8831 | 7879.5 samples/s | 30.8 steps/s
[Step= 300] | Loss=2.78083 | acc=0.1308 | tpr=0.8865 | fpr=0.8830 | 8480.9 samples/s | 33.1 steps/s
[Step= 350] | Loss=2.78038 | acc=0.1309 | tpr=0.8829 | fpr=0.8828 | 8099.9 samples/s | 31.6 steps/s
[Step= 400] | Loss=2.78315 | acc=0.1307 | tpr=0.8857 | fpr=0.8830 | 8292.4 samples/s | 32.4 steps/s
[Step= 450] | Loss=2.78402 | acc=0.1305 | tpr=0.8885 | fpr=0.8833 | 8254.1 samples/s | 32.2 steps/s
[Step= 500] | Loss=2.78614 | acc=0.1303 | tpr=0.8868 | fpr=0.8834 | 8241.0 samples/s | 32.2 steps/s
[Step= 550] | Loss=2.78659 | acc=0.1304 | tpr=0.8850 | fpr=0.8833 | 14933.1 samples/s | 58.3 steps/s
Avg test loss: 2.78645, Avg test acc: 0.13034, Avg tpr: 0.88510, Avg fpr: 0.88338, total FA: 122656

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=2.55687 | acc=0.1277 | tpr=0.7965 | fpr=0.8843 | 4176.7 samples/s | 16.3 steps/s
[Step= 100] | Loss=2.54175 | acc=0.1284 | tpr=0.7868 | fpr=0.8839 | 8537.5 samples/s | 33.3 steps/s
[Step= 150] | Loss=2.54645 | acc=0.1285 | tpr=0.7752 | fpr=0.8834 | 8423.8 samples/s | 32.9 steps/s
[Step= 200] | Loss=2.54755 | acc=0.1286 | tpr=0.7650 | fpr=0.8830 | 8134.8 samples/s | 31.8 steps/s
[Step= 250] | Loss=2.54567 | acc=0.1291 | tpr=0.7651 | fpr=0.8825 | 9047.4 samples/s | 35.3 steps/s
[Step= 300] | Loss=2.54611 | acc=0.1293 | tpr=0.7658 | fpr=0.8823 | 7597.5 samples/s | 29.7 steps/s
[Step= 350] | Loss=2.54427 | acc=0.1297 | tpr=0.7727 | fpr=0.8820 | 8385.3 samples/s | 32.8 steps/s
[Step= 400] | Loss=2.54459 | acc=0.1297 | tpr=0.7713 | fpr=0.8820 | 8126.0 samples/s | 31.7 steps/s
[Step= 450] | Loss=2.54520 | acc=0.1293 | tpr=0.7683 | fpr=0.8822 | 8364.5 samples/s | 32.7 steps/s
[Step= 500] | Loss=2.54506 | acc=0.1290 | tpr=0.7678 | fpr=0.8825 | 8011.3 samples/s | 31.3 steps/s
[Step= 550] | Loss=2.54613 | acc=0.1290 | tpr=0.7648 | fpr=0.8826 | 15269.2 samples/s | 59.6 steps/s
Avg test loss: 2.54567, Avg test acc: 0.12896, Avg tpr: 0.76506, Avg fpr: 0.88261, total FA: 122548

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09147 | acc=0.9820 | tpr=0.9159 | fpr=0.0169 | 4155.9 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.09409 | acc=0.9812 | tpr=0.9275 | fpr=0.0177 | 8468.6 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.09708 | acc=0.9802 | tpr=0.9294 | fpr=0.0189 | 8226.4 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.09650 | acc=0.9802 | tpr=0.9355 | fpr=0.0190 | 8350.4 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.09514 | acc=0.9803 | tpr=0.9328 | fpr=0.0189 | 8476.3 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.09519 | acc=0.9801 | tpr=0.9324 | fpr=0.0190 | 8040.8 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.09677 | acc=0.9800 | tpr=0.9343 | fpr=0.0191 | 8209.4 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.09747 | acc=0.9799 | tpr=0.9305 | fpr=0.0192 | 8320.5 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.09949 | acc=0.9796 | tpr=0.9289 | fpr=0.0195 | 8358.9 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.09891 | acc=0.9797 | tpr=0.9308 | fpr=0.0194 | 8196.8 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.09866 | acc=0.9798 | tpr=0.9312 | fpr=0.0193 | 15287.0 samples/s | 59.7 steps/s
Avg test loss: 0.09854, Avg test acc: 0.97982, Avg tpr: 0.93146, Avg fpr: 0.01930, total FA: 2680

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.08824 | acc=0.9795 | tpr=0.9292 | fpr=0.0196 | 4247.8 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.09349 | acc=0.9790 | tpr=0.9382 | fpr=0.0202 | 7848.9 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.09708 | acc=0.9783 | tpr=0.9380 | fpr=0.0210 | 8609.1 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.09799 | acc=0.9784 | tpr=0.9464 | fpr=0.0211 | 8792.8 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.09675 | acc=0.9786 | tpr=0.9432 | fpr=0.0207 | 7609.2 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.09872 | acc=0.9782 | tpr=0.9411 | fpr=0.0211 | 8320.8 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.09909 | acc=0.9782 | tpr=0.9424 | fpr=0.0212 | 8454.5 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.09983 | acc=0.9780 | tpr=0.9420 | fpr=0.0213 | 7558.8 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.10149 | acc=0.9777 | tpr=0.9401 | fpr=0.0216 | 8488.5 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.10141 | acc=0.9778 | tpr=0.9410 | fpr=0.0215 | 7985.8 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.10067 | acc=0.9779 | tpr=0.9411 | fpr=0.0214 | 15544.1 samples/s | 60.7 steps/s
Avg test loss: 0.10063, Avg test acc: 0.97792, Avg tpr: 0.94136, Avg fpr: 0.02141, total FA: 2973

server round 3/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 3.9] | Loss=0.13392 | Reg=0.00240 | acc=0.9062 | L2-Norm=15.495 | L2-Norm(final)=3.842 | 3819.3 samples/s | 59.7 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.12229 | Reg=0.00240 | acc=0.9062 | L2-Norm=15.500 | L2-Norm(final)=3.918 | 5106.4 samples/s | 79.8 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.11925 | Reg=0.00240 | acc=0.9062 | L2-Norm=15.501 | L2-Norm(final)=4.016 | 5861.7 samples/s | 91.6 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.11759 | Reg=0.00240 | acc=0.9062 | L2-Norm=15.501 | L2-Norm(final)=4.115 | 5787.6 samples/s | 90.4 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.11612 | Reg=0.00240 | acc=0.9375 | L2-Norm=15.502 | L2-Norm(final)=4.203 | 5731.3 samples/s | 89.6 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.11397 | Reg=0.00240 | acc=0.9219 | L2-Norm=15.502 | L2-Norm(final)=4.287 | 5880.6 samples/s | 91.9 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.11255 | Reg=0.00240 | acc=0.8594 | L2-Norm=15.502 | L2-Norm(final)=4.366 | 5894.0 samples/s | 92.1 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.11152 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.502 | L2-Norm(final)=4.440 | 5744.0 samples/s | 89.8 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.11031 | Reg=0.00240 | acc=0.8906 | L2-Norm=15.502 | L2-Norm(final)=4.509 | 5854.8 samples/s | 91.5 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.10948 | Reg=0.00240 | acc=0.9531 | L2-Norm=15.502 | L2-Norm(final)=4.576 | 5789.5 samples/s | 90.5 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.10982 | Reg=0.00240 | acc=0.8438 | L2-Norm=15.502 | L2-Norm(final)=4.639 | 7390.2 samples/s | 115.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 4.9] | Loss=0.08505 | Reg=0.00240 | acc=0.9219 | L2-Norm=15.502 | L2-Norm(final)=5.255 | 3680.3 samples/s | 57.5 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.10619 | Reg=0.00244 | acc=0.9062 | L2-Norm=15.627 | L2-Norm(final)=5.257 | 4643.8 samples/s | 72.6 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.09808 | Reg=0.00248 | acc=0.9375 | L2-Norm=15.740 | L2-Norm(final)=5.246 | 5095.3 samples/s | 79.6 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.09500 | Reg=0.00250 | acc=0.8906 | L2-Norm=15.819 | L2-Norm(final)=5.239 | 5090.6 samples/s | 79.5 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.09137 | Reg=0.00252 | acc=0.9375 | L2-Norm=15.881 | L2-Norm(final)=5.231 | 5006.3 samples/s | 78.2 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.08700 | Reg=0.00254 | acc=0.9375 | L2-Norm=15.929 | L2-Norm(final)=5.226 | 5018.3 samples/s | 78.4 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.08193 | Reg=0.00255 | acc=0.9688 | L2-Norm=15.971 | L2-Norm(final)=5.222 | 5048.0 samples/s | 78.9 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.07974 | Reg=0.00256 | acc=0.9844 | L2-Norm=16.008 | L2-Norm(final)=5.217 | 5019.8 samples/s | 78.4 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.07866 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.041 | L2-Norm(final)=5.212 | 5079.2 samples/s | 79.4 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.07687 | Reg=0.00258 | acc=0.9531 | L2-Norm=16.072 | L2-Norm(final)=5.207 | 5062.3 samples/s | 79.1 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.07532 | Reg=0.00259 | acc=0.9688 | L2-Norm=16.103 | L2-Norm(final)=5.202 | 6073.9 samples/s | 94.9 steps/s
[Step=3050 Epoch= 5.9] | Loss=0.07325 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.133 | L2-Norm(final)=5.199 | 1919.2 samples/s | 30.0 steps/s
[Step=3100 Epoch= 6.0] | Loss=0.07140 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.162 | L2-Norm(final)=5.195 | 4955.2 samples/s | 77.4 steps/s
[Step=3150 Epoch= 6.1] | Loss=0.06948 | Reg=0.00262 | acc=0.9688 | L2-Norm=16.189 | L2-Norm(final)=5.192 | 5062.3 samples/s | 79.1 steps/s
[Step=3200 Epoch= 6.2] | Loss=0.06813 | Reg=0.00263 | acc=0.9688 | L2-Norm=16.215 | L2-Norm(final)=5.189 | 5011.5 samples/s | 78.3 steps/s
[Step=3250 Epoch= 6.3] | Loss=0.06674 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.239 | L2-Norm(final)=5.186 | 5008.9 samples/s | 78.3 steps/s
[Step=3300 Epoch= 6.4] | Loss=0.06513 | Reg=0.00265 | acc=0.9531 | L2-Norm=16.263 | L2-Norm(final)=5.184 | 5029.5 samples/s | 78.6 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.06438 | Reg=0.00265 | acc=0.9531 | L2-Norm=16.287 | L2-Norm(final)=5.182 | 5085.2 samples/s | 79.5 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.06306 | Reg=0.00266 | acc=0.9688 | L2-Norm=16.310 | L2-Norm(final)=5.180 | 4977.4 samples/s | 77.8 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.06188 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.333 | L2-Norm(final)=5.178 | 5027.9 samples/s | 78.6 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.06143 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.356 | L2-Norm(final)=5.176 | 5322.8 samples/s | 83.2 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.06034 | Reg=0.00268 | acc=0.9375 | L2-Norm=16.378 | L2-Norm(final)=5.174 | 1925.5 samples/s | 30.1 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.05925 | Reg=0.00269 | acc=0.9844 | L2-Norm=16.399 | L2-Norm(final)=5.172 | 5038.8 samples/s | 78.7 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.05800 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.420 | L2-Norm(final)=5.171 | 5105.1 samples/s | 79.8 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.05725 | Reg=0.00270 | acc=0.9844 | L2-Norm=16.442 | L2-Norm(final)=5.170 | 4921.0 samples/s | 76.9 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.05631 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.463 | L2-Norm(final)=5.169 | 4961.5 samples/s | 77.5 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.05532 | Reg=0.00272 | acc=0.9688 | L2-Norm=16.484 | L2-Norm(final)=5.169 | 5050.9 samples/s | 78.9 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.05465 | Reg=0.00273 | acc=0.9219 | L2-Norm=16.504 | L2-Norm(final)=5.168 | 5078.3 samples/s | 79.3 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.05433 | Reg=0.00273 | acc=0.9688 | L2-Norm=16.524 | L2-Norm(final)=5.167 | 4926.6 samples/s | 77.0 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.05359 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.544 | L2-Norm(final)=5.166 | 5057.3 samples/s | 79.0 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.05323 | Reg=0.00275 | acc=0.9531 | L2-Norm=16.564 | L2-Norm(final)=5.164 | 4934.0 samples/s | 77.1 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step4000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.15225 | Reg=0.00240 | acc=0.8906 | L2-Norm=15.495 | L2-Norm(final)=4.126 | 3795.1 samples/s | 59.3 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.14930 | Reg=0.00240 | acc=0.8906 | L2-Norm=15.500 | L2-Norm(final)=4.124 | 5538.4 samples/s | 86.5 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.13199 | Reg=0.00240 | acc=0.9062 | L2-Norm=15.501 | L2-Norm(final)=4.193 | 5850.2 samples/s | 91.4 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.12621 | Reg=0.00240 | acc=0.8594 | L2-Norm=15.501 | L2-Norm(final)=4.273 | 5753.8 samples/s | 89.9 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.12100 | Reg=0.00240 | acc=0.9375 | L2-Norm=15.501 | L2-Norm(final)=4.354 | 5817.3 samples/s | 90.9 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.11788 | Reg=0.00240 | acc=0.9219 | L2-Norm=15.502 | L2-Norm(final)=4.433 | 5738.8 samples/s | 89.7 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.11676 | Reg=0.00240 | acc=0.9062 | L2-Norm=15.502 | L2-Norm(final)=4.505 | 5786.9 samples/s | 90.4 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.11465 | Reg=0.00240 | acc=0.8906 | L2-Norm=15.502 | L2-Norm(final)=4.571 | 5784.5 samples/s | 90.4 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.11303 | Reg=0.00240 | acc=0.9375 | L2-Norm=15.502 | L2-Norm(final)=4.637 | 5781.7 samples/s | 90.3 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.11124 | Reg=0.00240 | acc=0.9062 | L2-Norm=15.502 | L2-Norm(final)=4.701 | 5743.2 samples/s | 89.7 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.11043 | Reg=0.00240 | acc=0.9062 | L2-Norm=15.502 | L2-Norm(final)=4.762 | 7464.0 samples/s | 116.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch= 8.8] | Loss=0.12959 | Reg=0.00240 | acc=0.8750 | L2-Norm=15.502 | L2-Norm(final)=5.363 | 3752.7 samples/s | 58.6 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.09612 | Reg=0.00246 | acc=0.9062 | L2-Norm=15.687 | L2-Norm(final)=5.369 | 5033.6 samples/s | 78.7 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.08815 | Reg=0.00250 | acc=0.9062 | L2-Norm=15.826 | L2-Norm(final)=5.361 | 5047.4 samples/s | 78.9 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.08608 | Reg=0.00253 | acc=0.8906 | L2-Norm=15.915 | L2-Norm(final)=5.353 | 5017.4 samples/s | 78.4 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.08252 | Reg=0.00256 | acc=0.9844 | L2-Norm=15.987 | L2-Norm(final)=5.345 | 5064.1 samples/s | 79.1 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.07971 | Reg=0.00257 | acc=0.9688 | L2-Norm=16.045 | L2-Norm(final)=5.339 | 5032.9 samples/s | 78.6 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.07943 | Reg=0.00259 | acc=0.9375 | L2-Norm=16.093 | L2-Norm(final)=5.334 | 5036.0 samples/s | 78.7 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.07694 | Reg=0.00260 | acc=0.9219 | L2-Norm=16.136 | L2-Norm(final)=5.331 | 4996.3 samples/s | 78.1 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.07519 | Reg=0.00262 | acc=0.9531 | L2-Norm=16.175 | L2-Norm(final)=5.326 | 5136.0 samples/s | 80.3 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.07370 | Reg=0.00263 | acc=0.9844 | L2-Norm=16.211 | L2-Norm(final)=5.322 | 4985.1 samples/s | 77.9 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.07180 | Reg=0.00264 | acc=0.9688 | L2-Norm=16.246 | L2-Norm(final)=5.319 | 6176.6 samples/s | 96.5 steps/s
[Step=5050 Epoch= 9.9] | Loss=0.06998 | Reg=0.00265 | acc=0.9844 | L2-Norm=16.278 | L2-Norm(final)=5.316 | 1947.9 samples/s | 30.4 steps/s
[Step=5100 Epoch=10.0] | Loss=0.06759 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.307 | L2-Norm(final)=5.313 | 4980.4 samples/s | 77.8 steps/s
[Step=5150 Epoch=10.1] | Loss=0.06584 | Reg=0.00267 | acc=0.9531 | L2-Norm=16.336 | L2-Norm(final)=5.312 | 5021.2 samples/s | 78.5 steps/s
[Step=5200 Epoch=10.2] | Loss=0.06373 | Reg=0.00268 | acc=0.9688 | L2-Norm=16.362 | L2-Norm(final)=5.310 | 5116.9 samples/s | 80.0 steps/s
[Step=5250 Epoch=10.3] | Loss=0.06254 | Reg=0.00269 | acc=0.9688 | L2-Norm=16.386 | L2-Norm(final)=5.309 | 5107.2 samples/s | 79.8 steps/s
[Step=5300 Epoch=10.4] | Loss=0.06150 | Reg=0.00269 | acc=0.9688 | L2-Norm=16.408 | L2-Norm(final)=5.308 | 5056.4 samples/s | 79.0 steps/s
[Step=5350 Epoch=10.5] | Loss=0.06037 | Reg=0.00270 | acc=0.9844 | L2-Norm=16.430 | L2-Norm(final)=5.306 | 5049.8 samples/s | 78.9 steps/s
[Step=5400 Epoch=10.6] | Loss=0.06005 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.451 | L2-Norm(final)=5.304 | 5000.9 samples/s | 78.1 steps/s
[Step=5450 Epoch=10.7] | Loss=0.05901 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.472 | L2-Norm(final)=5.302 | 5066.8 samples/s | 79.2 steps/s
[Step=5500 Epoch=10.8] | Loss=0.05862 | Reg=0.00272 | acc=0.9531 | L2-Norm=16.492 | L2-Norm(final)=5.300 | 5390.4 samples/s | 84.2 steps/s
[Step=5550 Epoch=10.9] | Loss=0.05771 | Reg=0.00273 | acc=0.9375 | L2-Norm=16.511 | L2-Norm(final)=5.298 | 2045.0 samples/s | 32.0 steps/s
[Step=5600 Epoch=10.9] | Loss=0.05657 | Reg=0.00273 | acc=0.9375 | L2-Norm=16.529 | L2-Norm(final)=5.296 | 4934.9 samples/s | 77.1 steps/s
[Step=5650 Epoch=11.0] | Loss=0.05555 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.547 | L2-Norm(final)=5.295 | 5014.7 samples/s | 78.4 steps/s
[Step=5700 Epoch=11.1] | Loss=0.05460 | Reg=0.00275 | acc=0.9375 | L2-Norm=16.565 | L2-Norm(final)=5.294 | 5023.0 samples/s | 78.5 steps/s
[Step=5750 Epoch=11.2] | Loss=0.05384 | Reg=0.00275 | acc=0.9688 | L2-Norm=16.583 | L2-Norm(final)=5.292 | 5013.9 samples/s | 78.3 steps/s
[Step=5800 Epoch=11.3] | Loss=0.05307 | Reg=0.00276 | acc=0.9844 | L2-Norm=16.600 | L2-Norm(final)=5.291 | 5041.9 samples/s | 78.8 steps/s
[Step=5850 Epoch=11.4] | Loss=0.05288 | Reg=0.00276 | acc=0.9219 | L2-Norm=16.616 | L2-Norm(final)=5.289 | 4988.8 samples/s | 77.9 steps/s
[Step=5900 Epoch=11.5] | Loss=0.05219 | Reg=0.00277 | acc=0.9688 | L2-Norm=16.633 | L2-Norm(final)=5.288 | 5026.3 samples/s | 78.5 steps/s
[Step=5950 Epoch=11.6] | Loss=0.05184 | Reg=0.00277 | acc=0.9688 | L2-Norm=16.650 | L2-Norm(final)=5.286 | 5058.8 samples/s | 79.0 steps/s
[Step=6000 Epoch=11.7] | Loss=0.05130 | Reg=0.00278 | acc=0.9844 | L2-Norm=16.666 | L2-Norm(final)=5.285 | 4986.8 samples/s | 77.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step6000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08697 | acc=0.9420 | tpr=0.9403 | fpr=0.0543 | 4198.8 samples/s | 16.4 steps/s
Avg test loss: 0.08737, Avg test acc: 0.94130, Avg tpr: 0.93874, Avg fpr: 0.05307, total FA: 414

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07285 | acc=0.9502 | tpr=0.9623 | fpr=0.0761 | 4163.7 samples/s | 16.3 steps/s
Avg test loss: 0.07757, Avg test acc: 0.94787, Avg tpr: 0.96165, Avg fpr: 0.08243, total FA: 643

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.92233 | acc=0.3254 | tpr=0.0308 | fpr=0.0349 | 4183.5 samples/s | 16.3 steps/s
Avg test loss: 4.93675, Avg test acc: 0.32182, Avg tpr: 0.02955, Avg fpr: 0.03538, total FA: 276

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.07969 | acc=0.3213 | tpr=0.0343 | fpr=0.0555 | 4169.4 samples/s | 16.3 steps/s
Avg test loss: 5.09285, Avg test acc: 0.31813, Avg tpr: 0.03351, Avg fpr: 0.05589, total FA: 436

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.07472 | acc=0.1455 | tpr=0.8009 | fpr=0.8662 | 4230.2 samples/s | 16.5 steps/s
[Step= 100] | Loss=3.06203 | acc=0.1475 | tpr=0.7719 | fpr=0.8641 | 8395.8 samples/s | 32.8 steps/s
[Step= 150] | Loss=3.06461 | acc=0.1473 | tpr=0.7709 | fpr=0.8642 | 8009.3 samples/s | 31.3 steps/s
[Step= 200] | Loss=3.06535 | acc=0.1473 | tpr=0.7727 | fpr=0.8641 | 8390.1 samples/s | 32.8 steps/s
[Step= 250] | Loss=3.06888 | acc=0.1473 | tpr=0.7764 | fpr=0.8642 | 8275.8 samples/s | 32.3 steps/s
[Step= 300] | Loss=3.06972 | acc=0.1473 | tpr=0.7629 | fpr=0.8639 | 8459.9 samples/s | 33.0 steps/s
[Step= 350] | Loss=3.06921 | acc=0.1466 | tpr=0.7583 | fpr=0.8645 | 8230.9 samples/s | 32.2 steps/s
[Step= 400] | Loss=3.06913 | acc=0.1466 | tpr=0.7598 | fpr=0.8646 | 8487.7 samples/s | 33.2 steps/s
[Step= 450] | Loss=3.07129 | acc=0.1464 | tpr=0.7610 | fpr=0.8648 | 8311.3 samples/s | 32.5 steps/s
[Step= 500] | Loss=3.07158 | acc=0.1461 | tpr=0.7599 | fpr=0.8649 | 8252.9 samples/s | 32.2 steps/s
[Step= 550] | Loss=3.07171 | acc=0.1461 | tpr=0.7585 | fpr=0.8650 | 14974.0 samples/s | 58.5 steps/s
Avg test loss: 3.07197, Avg test acc: 0.14603, Avg tpr: 0.75911, Avg fpr: 0.86511, total FA: 120119

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.30438 | acc=0.1379 | tpr=0.8451 | fpr=0.8748 | 4169.5 samples/s | 16.3 steps/s
[Step= 100] | Loss=3.28177 | acc=0.1401 | tpr=0.8124 | fpr=0.8724 | 8615.7 samples/s | 33.7 steps/s
[Step= 150] | Loss=3.28363 | acc=0.1378 | tpr=0.8112 | fpr=0.8746 | 8298.3 samples/s | 32.4 steps/s
[Step= 200] | Loss=3.28226 | acc=0.1377 | tpr=0.8087 | fpr=0.8745 | 8134.1 samples/s | 31.8 steps/s
[Step= 250] | Loss=3.28029 | acc=0.1385 | tpr=0.8166 | fpr=0.8738 | 8470.3 samples/s | 33.1 steps/s
[Step= 300] | Loss=3.27806 | acc=0.1386 | tpr=0.8102 | fpr=0.8737 | 8192.3 samples/s | 32.0 steps/s
[Step= 350] | Loss=3.27921 | acc=0.1384 | tpr=0.8103 | fpr=0.8738 | 8233.0 samples/s | 32.2 steps/s
[Step= 400] | Loss=3.27909 | acc=0.1385 | tpr=0.8091 | fpr=0.8737 | 8506.8 samples/s | 33.2 steps/s
[Step= 450] | Loss=3.28175 | acc=0.1384 | tpr=0.8116 | fpr=0.8738 | 8180.9 samples/s | 32.0 steps/s
[Step= 500] | Loss=3.27975 | acc=0.1385 | tpr=0.8119 | fpr=0.8737 | 8294.0 samples/s | 32.4 steps/s
[Step= 550] | Loss=3.27953 | acc=0.1383 | tpr=0.8106 | fpr=0.8740 | 15330.8 samples/s | 59.9 steps/s
Avg test loss: 3.28001, Avg test acc: 0.13815, Avg tpr: 0.81022, Avg fpr: 0.87406, total FA: 121362

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09147 | acc=0.9820 | tpr=0.9159 | fpr=0.0169 | 4209.4 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.09409 | acc=0.9812 | tpr=0.9275 | fpr=0.0177 | 8577.8 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.09708 | acc=0.9802 | tpr=0.9294 | fpr=0.0189 | 8046.3 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.09650 | acc=0.9802 | tpr=0.9355 | fpr=0.0190 | 8209.1 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.09514 | acc=0.9803 | tpr=0.9328 | fpr=0.0189 | 8320.6 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.09519 | acc=0.9801 | tpr=0.9324 | fpr=0.0190 | 8313.5 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.09677 | acc=0.9800 | tpr=0.9343 | fpr=0.0191 | 8266.0 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.09747 | acc=0.9799 | tpr=0.9305 | fpr=0.0192 | 8434.4 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.09949 | acc=0.9796 | tpr=0.9289 | fpr=0.0195 | 8212.7 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.09891 | acc=0.9797 | tpr=0.9308 | fpr=0.0194 | 8022.9 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.09866 | acc=0.9798 | tpr=0.9312 | fpr=0.0193 | 16166.0 samples/s | 63.1 steps/s
Avg test loss: 0.09854, Avg test acc: 0.97982, Avg tpr: 0.93146, Avg fpr: 0.01930, total FA: 2680

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.08824 | acc=0.9795 | tpr=0.9292 | fpr=0.0196 | 4188.0 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.09349 | acc=0.9790 | tpr=0.9382 | fpr=0.0202 | 8574.1 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.09708 | acc=0.9783 | tpr=0.9380 | fpr=0.0210 | 8137.9 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.09799 | acc=0.9784 | tpr=0.9464 | fpr=0.0211 | 8328.0 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.09675 | acc=0.9786 | tpr=0.9432 | fpr=0.0207 | 7895.6 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.09872 | acc=0.9782 | tpr=0.9411 | fpr=0.0211 | 8239.2 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.09909 | acc=0.9782 | tpr=0.9424 | fpr=0.0212 | 8486.5 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.09983 | acc=0.9780 | tpr=0.9420 | fpr=0.0213 | 8172.5 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.10149 | acc=0.9777 | tpr=0.9401 | fpr=0.0216 | 8393.5 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.10141 | acc=0.9778 | tpr=0.9410 | fpr=0.0215 | 8149.9 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.10067 | acc=0.9779 | tpr=0.9411 | fpr=0.0214 | 15111.9 samples/s | 59.0 steps/s
Avg test loss: 0.10063, Avg test acc: 0.97792, Avg tpr: 0.94136, Avg fpr: 0.02141, total FA: 2973

server round 4/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.09990 | Reg=0.00229 | acc=0.9375 | L2-Norm=15.148 | L2-Norm(final)=5.110 | 3696.0 samples/s | 57.8 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.10087 | Reg=0.00230 | acc=0.9219 | L2-Norm=15.154 | L2-Norm(final)=5.162 | 5217.4 samples/s | 81.5 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.09932 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.156 | L2-Norm(final)=5.231 | 5658.0 samples/s | 88.4 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.09553 | Reg=0.00230 | acc=0.9375 | L2-Norm=15.156 | L2-Norm(final)=5.308 | 5872.8 samples/s | 91.8 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.09391 | Reg=0.00230 | acc=0.9375 | L2-Norm=15.156 | L2-Norm(final)=5.385 | 5887.0 samples/s | 92.0 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.09425 | Reg=0.00230 | acc=0.9375 | L2-Norm=15.156 | L2-Norm(final)=5.456 | 5937.3 samples/s | 92.8 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.09349 | Reg=0.00230 | acc=0.9531 | L2-Norm=15.157 | L2-Norm(final)=5.524 | 5784.3 samples/s | 90.4 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.09269 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.157 | L2-Norm(final)=5.589 | 5949.5 samples/s | 93.0 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.09215 | Reg=0.00230 | acc=0.9531 | L2-Norm=15.157 | L2-Norm(final)=5.650 | 6020.1 samples/s | 94.1 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.09200 | Reg=0.00230 | acc=0.9219 | L2-Norm=15.157 | L2-Norm(final)=5.709 | 5823.0 samples/s | 91.0 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.09187 | Reg=0.00230 | acc=0.8906 | L2-Norm=15.157 | L2-Norm(final)=5.765 | 7137.9 samples/s | 111.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch= 8.8] | Loss=0.08069 | Reg=0.00230 | acc=0.9531 | L2-Norm=15.157 | L2-Norm(final)=6.313 | 4147.5 samples/s | 64.8 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.08680 | Reg=0.00234 | acc=0.8750 | L2-Norm=15.308 | L2-Norm(final)=6.319 | 4347.7 samples/s | 67.9 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.08263 | Reg=0.00239 | acc=0.9375 | L2-Norm=15.446 | L2-Norm(final)=6.299 | 4994.5 samples/s | 78.0 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.08204 | Reg=0.00242 | acc=0.8750 | L2-Norm=15.551 | L2-Norm(final)=6.284 | 5086.1 samples/s | 79.5 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.08033 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.633 | L2-Norm(final)=6.271 | 4981.2 samples/s | 77.8 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.07780 | Reg=0.00247 | acc=0.9688 | L2-Norm=15.704 | L2-Norm(final)=6.261 | 5048.1 samples/s | 78.9 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.07479 | Reg=0.00249 | acc=0.9531 | L2-Norm=15.763 | L2-Norm(final)=6.254 | 5050.6 samples/s | 78.9 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.07417 | Reg=0.00250 | acc=0.9062 | L2-Norm=15.816 | L2-Norm(final)=6.247 | 4976.1 samples/s | 77.8 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.07248 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.863 | L2-Norm(final)=6.239 | 5090.9 samples/s | 79.5 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.07104 | Reg=0.00253 | acc=0.9688 | L2-Norm=15.907 | L2-Norm(final)=6.233 | 5012.3 samples/s | 78.3 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.06897 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.949 | L2-Norm(final)=6.227 | 6168.4 samples/s | 96.4 steps/s
[Step=5050 Epoch= 9.8] | Loss=0.06620 | Reg=0.00256 | acc=0.9688 | L2-Norm=15.988 | L2-Norm(final)=6.223 | 1934.3 samples/s | 30.2 steps/s
[Step=5100 Epoch= 9.9] | Loss=0.06456 | Reg=0.00257 | acc=0.9688 | L2-Norm=16.027 | L2-Norm(final)=6.220 | 5048.3 samples/s | 78.9 steps/s
[Step=5150 Epoch=10.0] | Loss=0.06241 | Reg=0.00258 | acc=0.9844 | L2-Norm=16.064 | L2-Norm(final)=6.218 | 5062.5 samples/s | 79.1 steps/s
[Step=5200 Epoch=10.1] | Loss=0.06028 | Reg=0.00259 | acc=0.9375 | L2-Norm=16.097 | L2-Norm(final)=6.217 | 5030.4 samples/s | 78.6 steps/s
[Step=5250 Epoch=10.2] | Loss=0.05947 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.128 | L2-Norm(final)=6.214 | 5032.5 samples/s | 78.6 steps/s
[Step=5300 Epoch=10.3] | Loss=0.05859 | Reg=0.00261 | acc=0.9531 | L2-Norm=16.158 | L2-Norm(final)=6.211 | 5028.7 samples/s | 78.6 steps/s
[Step=5350 Epoch=10.4] | Loss=0.05796 | Reg=0.00262 | acc=0.9688 | L2-Norm=16.188 | L2-Norm(final)=6.207 | 5092.8 samples/s | 79.6 steps/s
[Step=5400 Epoch=10.5] | Loss=0.05739 | Reg=0.00263 | acc=0.9219 | L2-Norm=16.216 | L2-Norm(final)=6.204 | 5018.4 samples/s | 78.4 steps/s
[Step=5450 Epoch=10.6] | Loss=0.05657 | Reg=0.00264 | acc=0.9375 | L2-Norm=16.245 | L2-Norm(final)=6.201 | 5025.8 samples/s | 78.5 steps/s
[Step=5500 Epoch=10.7] | Loss=0.05607 | Reg=0.00265 | acc=0.9375 | L2-Norm=16.273 | L2-Norm(final)=6.198 | 5376.5 samples/s | 84.0 steps/s
[Step=5550 Epoch=10.8] | Loss=0.05495 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.301 | L2-Norm(final)=6.195 | 1950.0 samples/s | 30.5 steps/s
[Step=5600 Epoch=10.9] | Loss=0.05355 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.327 | L2-Norm(final)=6.192 | 5066.2 samples/s | 79.2 steps/s
[Step=5650 Epoch=11.0] | Loss=0.05286 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.353 | L2-Norm(final)=6.190 | 5033.4 samples/s | 78.6 steps/s
[Step=5700 Epoch=11.1] | Loss=0.05229 | Reg=0.00268 | acc=0.9531 | L2-Norm=16.378 | L2-Norm(final)=6.187 | 5035.0 samples/s | 78.7 steps/s
[Step=5750 Epoch=11.2] | Loss=0.05164 | Reg=0.00269 | acc=0.9688 | L2-Norm=16.404 | L2-Norm(final)=6.184 | 5084.8 samples/s | 79.4 steps/s
[Step=5800 Epoch=11.3] | Loss=0.05122 | Reg=0.00270 | acc=0.9688 | L2-Norm=16.430 | L2-Norm(final)=6.181 | 5023.9 samples/s | 78.5 steps/s
[Step=5850 Epoch=11.4] | Loss=0.05050 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.455 | L2-Norm(final)=6.178 | 5019.3 samples/s | 78.4 steps/s
[Step=5900 Epoch=11.5] | Loss=0.04991 | Reg=0.00272 | acc=0.9844 | L2-Norm=16.480 | L2-Norm(final)=6.175 | 5079.9 samples/s | 79.4 steps/s
[Step=5950 Epoch=11.6] | Loss=0.04936 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.504 | L2-Norm(final)=6.172 | 5082.9 samples/s | 79.4 steps/s
[Step=6000 Epoch=11.7] | Loss=0.04893 | Reg=0.00273 | acc=0.9688 | L2-Norm=16.528 | L2-Norm(final)=6.170 | 5023.4 samples/s | 78.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step6000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=2001 Epoch= 7.7] | Loss=0.05201 | Reg=0.00229 | acc=0.9531 | L2-Norm=15.148 | L2-Norm(final)=4.824 | 3947.6 samples/s | 61.7 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.04087 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.140 | L2-Norm(final)=4.910 | 4970.8 samples/s | 77.7 steps/s
[Step=2100 Epoch= 8.1] | Loss=0.03795 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.139 | L2-Norm(final)=5.029 | 5439.5 samples/s | 85.0 steps/s
[Step=2150 Epoch= 8.3] | Loss=0.03657 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.138 | L2-Norm(final)=5.145 | 5448.9 samples/s | 85.1 steps/s
[Step=2200 Epoch= 8.5] | Loss=0.03460 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.138 | L2-Norm(final)=5.256 | 5628.9 samples/s | 88.0 steps/s
[Step=2250 Epoch= 8.7] | Loss=0.03238 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.138 | L2-Norm(final)=5.365 | 7128.8 samples/s | 111.4 steps/s
[Step=2300 Epoch= 8.9] | Loss=0.03179 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.138 | L2-Norm(final)=5.468 | 1974.0 samples/s | 30.8 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.03123 | Reg=0.00229 | acc=0.9375 | L2-Norm=15.138 | L2-Norm(final)=5.566 | 5451.4 samples/s | 85.2 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.03064 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.138 | L2-Norm(final)=5.658 | 5671.0 samples/s | 88.6 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.02996 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.138 | L2-Norm(final)=5.745 | 5463.0 samples/s | 85.4 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.02931 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.138 | L2-Norm(final)=5.828 | 6413.7 samples/s | 100.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 9.6] | Loss=0.01789 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.137 | L2-Norm(final)=6.646 | 4119.9 samples/s | 64.4 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.02805 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.322 | L2-Norm(final)=6.658 | 4209.9 samples/s | 65.8 steps/s
[Step=2600 Epoch=10.0] | Loss=0.02038 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.503 | L2-Norm(final)=6.641 | 4788.0 samples/s | 74.8 steps/s
[Step=2650 Epoch=10.2] | Loss=0.01601 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.588 | L2-Norm(final)=6.633 | 4818.6 samples/s | 75.3 steps/s
[Step=2700 Epoch=10.4] | Loss=0.01292 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.630 | L2-Norm(final)=6.631 | 4809.5 samples/s | 75.1 steps/s
[Step=2750 Epoch=10.6] | Loss=0.01198 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.649 | L2-Norm(final)=6.628 | 6105.2 samples/s | 95.4 steps/s
[Step=2800 Epoch=10.8] | Loss=0.01040 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.662 | L2-Norm(final)=6.627 | 1863.5 samples/s | 29.1 steps/s
[Step=2850 Epoch=11.0] | Loss=0.00920 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.665 | L2-Norm(final)=6.627 | 4821.4 samples/s | 75.3 steps/s
[Step=2900 Epoch=11.2] | Loss=0.00817 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.663 | L2-Norm(final)=6.628 | 4716.0 samples/s | 73.7 steps/s
[Step=2950 Epoch=11.4] | Loss=0.00736 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.655 | L2-Norm(final)=6.629 | 4803.8 samples/s | 75.1 steps/s
[Step=3000 Epoch=11.5] | Loss=0.00697 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.644 | L2-Norm(final)=6.630 | 5412.9 samples/s | 84.6 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00639 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.631 | L2-Norm(final)=6.631 | 1955.3 samples/s | 30.6 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00588 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.616 | L2-Norm(final)=6.632 | 4773.4 samples/s | 74.6 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00543 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.598 | L2-Norm(final)=6.633 | 4847.0 samples/s | 75.7 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00504 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.578 | L2-Norm(final)=6.634 | 4732.3 samples/s | 73.9 steps/s
[Step=3250 Epoch=12.5] | Loss=0.00471 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.556 | L2-Norm(final)=6.635 | 4856.8 samples/s | 75.9 steps/s
[Step=3300 Epoch=12.7] | Loss=0.00442 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.532 | L2-Norm(final)=6.636 | 2041.1 samples/s | 31.9 steps/s
[Step=3350 Epoch=12.9] | Loss=0.00416 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.508 | L2-Norm(final)=6.637 | 4758.5 samples/s | 74.4 steps/s
[Step=3400 Epoch=13.1] | Loss=0.00393 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.482 | L2-Norm(final)=6.638 | 4852.4 samples/s | 75.8 steps/s
[Step=3450 Epoch=13.3] | Loss=0.00372 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.455 | L2-Norm(final)=6.639 | 4749.8 samples/s | 74.2 steps/s
[Step=3500 Epoch=13.5] | Loss=0.00353 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.428 | L2-Norm(final)=6.639 | 4787.4 samples/s | 74.8 steps/s
[Step=3550 Epoch=13.7] | Loss=0.00337 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.401 | L2-Norm(final)=6.640 | 2061.1 samples/s | 32.2 steps/s
[Step=3600 Epoch=13.9] | Loss=0.00321 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.372 | L2-Norm(final)=6.641 | 4770.7 samples/s | 74.5 steps/s
[Step=3650 Epoch=14.1] | Loss=0.00307 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.344 | L2-Norm(final)=6.641 | 4733.4 samples/s | 74.0 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00295 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.315 | L2-Norm(final)=6.642 | 4838.7 samples/s | 75.6 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00283 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.286 | L2-Norm(final)=6.642 | 4718.7 samples/s | 73.7 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00272 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.256 | L2-Norm(final)=6.643 | 7006.0 samples/s | 109.5 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00262 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.227 | L2-Norm(final)=6.643 | 1814.6 samples/s | 28.4 steps/s
[Step=3900 Epoch=15.0] | Loss=0.00253 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.197 | L2-Norm(final)=6.644 | 4730.6 samples/s | 73.9 steps/s
[Step=3950 Epoch=15.2] | Loss=0.00244 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.167 | L2-Norm(final)=6.644 | 4749.1 samples/s | 74.2 steps/s
[Step=4000 Epoch=15.4] | Loss=0.00236 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.137 | L2-Norm(final)=6.645 | 4778.2 samples/s | 74.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_1/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07212 | acc=0.9523 | tpr=0.9537 | fpr=0.0505 | 4194.8 samples/s | 16.4 steps/s
Avg test loss: 0.07365, Avg test acc: 0.95240, Avg tpr: 0.95326, Avg fpr: 0.04948, total FA: 386

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07285 | acc=0.9502 | tpr=0.9623 | fpr=0.0761 | 4246.2 samples/s | 16.6 steps/s
Avg test loss: 0.07757, Avg test acc: 0.94787, Avg tpr: 0.96165, Avg fpr: 0.08243, total FA: 643

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.92233 | acc=0.3254 | tpr=0.0308 | fpr=0.0349 | 4165.7 samples/s | 16.3 steps/s
Avg test loss: 4.93675, Avg test acc: 0.32182, Avg tpr: 0.02955, Avg fpr: 0.03538, total FA: 276

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.75549 | acc=0.3180 | tpr=0.0274 | fpr=0.0510 | 4171.2 samples/s | 16.3 steps/s
Avg test loss: 5.77836, Avg test acc: 0.31549, Avg tpr: 0.02728, Avg fpr: 0.05063, total FA: 395

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.09639 | acc=0.1302 | tpr=0.8053 | fpr=0.8819 | 4164.6 samples/s | 16.3 steps/s
[Step= 100] | Loss=4.06839 | acc=0.1313 | tpr=0.7910 | fpr=0.8810 | 8317.0 samples/s | 32.5 steps/s
[Step= 150] | Loss=4.07569 | acc=0.1313 | tpr=0.7867 | fpr=0.8808 | 8185.5 samples/s | 32.0 steps/s
[Step= 200] | Loss=4.07514 | acc=0.1317 | tpr=0.7858 | fpr=0.8802 | 8283.4 samples/s | 32.4 steps/s
[Step= 250] | Loss=4.07728 | acc=0.1321 | tpr=0.7930 | fpr=0.8800 | 8322.8 samples/s | 32.5 steps/s
[Step= 300] | Loss=4.07898 | acc=0.1320 | tpr=0.7840 | fpr=0.8799 | 8409.1 samples/s | 32.8 steps/s
[Step= 350] | Loss=4.07777 | acc=0.1317 | tpr=0.7833 | fpr=0.8802 | 8247.8 samples/s | 32.2 steps/s
[Step= 400] | Loss=4.08116 | acc=0.1318 | tpr=0.7899 | fpr=0.8801 | 8734.1 samples/s | 34.1 steps/s
[Step= 450] | Loss=4.08255 | acc=0.1317 | tpr=0.7882 | fpr=0.8803 | 7927.6 samples/s | 31.0 steps/s
[Step= 500] | Loss=4.08300 | acc=0.1313 | tpr=0.7837 | fpr=0.8805 | 8323.7 samples/s | 32.5 steps/s
[Step= 550] | Loss=4.08488 | acc=0.1314 | tpr=0.7815 | fpr=0.8804 | 14960.5 samples/s | 58.4 steps/s
Avg test loss: 4.08484, Avg test acc: 0.13124, Avg tpr: 0.78170, Avg fpr: 0.88059, total FA: 122268

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.30438 | acc=0.1379 | tpr=0.8451 | fpr=0.8748 | 4183.6 samples/s | 16.3 steps/s
[Step= 100] | Loss=3.28177 | acc=0.1401 | tpr=0.8124 | fpr=0.8724 | 8429.4 samples/s | 32.9 steps/s
[Step= 150] | Loss=3.28363 | acc=0.1378 | tpr=0.8112 | fpr=0.8746 | 8194.0 samples/s | 32.0 steps/s
[Step= 200] | Loss=3.28226 | acc=0.1377 | tpr=0.8087 | fpr=0.8745 | 8422.8 samples/s | 32.9 steps/s
[Step= 250] | Loss=3.28029 | acc=0.1385 | tpr=0.8166 | fpr=0.8738 | 8243.0 samples/s | 32.2 steps/s
[Step= 300] | Loss=3.27806 | acc=0.1386 | tpr=0.8102 | fpr=0.8737 | 8450.8 samples/s | 33.0 steps/s
[Step= 350] | Loss=3.27921 | acc=0.1384 | tpr=0.8103 | fpr=0.8738 | 8090.8 samples/s | 31.6 steps/s
[Step= 400] | Loss=3.27909 | acc=0.1385 | tpr=0.8091 | fpr=0.8737 | 8383.7 samples/s | 32.7 steps/s
[Step= 450] | Loss=3.28175 | acc=0.1384 | tpr=0.8116 | fpr=0.8738 | 8413.4 samples/s | 32.9 steps/s
[Step= 500] | Loss=3.27975 | acc=0.1385 | tpr=0.8119 | fpr=0.8737 | 7900.0 samples/s | 30.9 steps/s
[Step= 550] | Loss=3.27953 | acc=0.1383 | tpr=0.8106 | fpr=0.8740 | 15760.7 samples/s | 61.6 steps/s
Avg test loss: 3.28001, Avg test acc: 0.13815, Avg tpr: 0.81022, Avg fpr: 0.87406, total FA: 121362

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09147 | acc=0.9820 | tpr=0.9159 | fpr=0.0169 | 4344.5 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.09409 | acc=0.9812 | tpr=0.9275 | fpr=0.0177 | 8055.5 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.09708 | acc=0.9802 | tpr=0.9294 | fpr=0.0189 | 8530.4 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.09650 | acc=0.9802 | tpr=0.9355 | fpr=0.0190 | 8133.7 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.09514 | acc=0.9803 | tpr=0.9328 | fpr=0.0189 | 8368.3 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.09519 | acc=0.9801 | tpr=0.9324 | fpr=0.0190 | 8380.8 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.09677 | acc=0.9800 | tpr=0.9343 | fpr=0.0191 | 8334.4 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.09747 | acc=0.9799 | tpr=0.9305 | fpr=0.0192 | 8355.0 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.09949 | acc=0.9796 | tpr=0.9289 | fpr=0.0195 | 8178.8 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.09891 | acc=0.9797 | tpr=0.9308 | fpr=0.0194 | 8228.7 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.09866 | acc=0.9798 | tpr=0.9312 | fpr=0.0193 | 15396.1 samples/s | 60.1 steps/s
Avg test loss: 0.09854, Avg test acc: 0.97982, Avg tpr: 0.93146, Avg fpr: 0.01930, total FA: 2680

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09745 | acc=0.9809 | tpr=0.9469 | fpr=0.0185 | 4243.3 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.10103 | acc=0.9806 | tpr=0.9446 | fpr=0.0187 | 8086.7 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.10591 | acc=0.9796 | tpr=0.9467 | fpr=0.0198 | 8342.5 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.10692 | acc=0.9795 | tpr=0.9475 | fpr=0.0199 | 8270.8 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.10537 | acc=0.9795 | tpr=0.9424 | fpr=0.0198 | 8834.2 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.10724 | acc=0.9792 | tpr=0.9404 | fpr=0.0201 | 7902.2 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.10825 | acc=0.9792 | tpr=0.9443 | fpr=0.0202 | 8167.5 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.10923 | acc=0.9790 | tpr=0.9447 | fpr=0.0204 | 8429.6 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.11111 | acc=0.9787 | tpr=0.9411 | fpr=0.0206 | 8341.9 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.11112 | acc=0.9787 | tpr=0.9427 | fpr=0.0207 | 8079.6 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.11037 | acc=0.9789 | tpr=0.9423 | fpr=0.0205 | 15363.2 samples/s | 60.0 steps/s
Avg test loss: 0.11024, Avg test acc: 0.97889, Avg tpr: 0.94216, Avg fpr: 0.02044, total FA: 2838

server round 5/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=11.7] | Loss=0.19274 | Reg=0.00220 | acc=0.8281 | L2-Norm=14.845 | L2-Norm(final)=5.240 | 3794.0 samples/s | 59.3 steps/s
[Step=6050 Epoch=11.8] | Loss=0.11421 | Reg=0.00221 | acc=0.9375 | L2-Norm=14.852 | L2-Norm(final)=5.301 | 5391.7 samples/s | 84.2 steps/s
[Step=6100 Epoch=11.9] | Loss=0.10897 | Reg=0.00221 | acc=0.9219 | L2-Norm=14.853 | L2-Norm(final)=5.403 | 5900.3 samples/s | 92.2 steps/s
[Step=6150 Epoch=12.0] | Loss=0.10490 | Reg=0.00221 | acc=0.9531 | L2-Norm=14.854 | L2-Norm(final)=5.504 | 5839.8 samples/s | 91.2 steps/s
[Step=6200 Epoch=12.1] | Loss=0.10338 | Reg=0.00221 | acc=0.9062 | L2-Norm=14.854 | L2-Norm(final)=5.599 | 5866.9 samples/s | 91.7 steps/s
[Step=6250 Epoch=12.2] | Loss=0.10228 | Reg=0.00221 | acc=0.9531 | L2-Norm=14.854 | L2-Norm(final)=5.685 | 5913.6 samples/s | 92.4 steps/s
[Step=6300 Epoch=12.3] | Loss=0.10095 | Reg=0.00221 | acc=0.9375 | L2-Norm=14.854 | L2-Norm(final)=5.766 | 5907.2 samples/s | 92.3 steps/s
[Step=6350 Epoch=12.4] | Loss=0.10028 | Reg=0.00221 | acc=0.8906 | L2-Norm=14.854 | L2-Norm(final)=5.842 | 5937.1 samples/s | 92.8 steps/s
[Step=6400 Epoch=12.5] | Loss=0.10043 | Reg=0.00221 | acc=0.8594 | L2-Norm=14.854 | L2-Norm(final)=5.911 | 5886.0 samples/s | 92.0 steps/s
[Step=6450 Epoch=12.6] | Loss=0.09909 | Reg=0.00221 | acc=0.8906 | L2-Norm=14.854 | L2-Norm(final)=5.978 | 5895.4 samples/s | 92.1 steps/s
[Step=6500 Epoch=12.7] | Loss=0.09832 | Reg=0.00221 | acc=0.9219 | L2-Norm=14.854 | L2-Norm(final)=6.043 | 7347.8 samples/s | 114.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=12.7] | Loss=0.07843 | Reg=0.00221 | acc=0.9531 | L2-Norm=14.855 | L2-Norm(final)=6.694 | 3846.3 samples/s | 60.1 steps/s
[Step=6550 Epoch=12.8] | Loss=0.07897 | Reg=0.00227 | acc=0.9062 | L2-Norm=15.072 | L2-Norm(final)=6.702 | 4874.9 samples/s | 76.2 steps/s
[Step=6600 Epoch=12.9] | Loss=0.07545 | Reg=0.00232 | acc=0.9688 | L2-Norm=15.244 | L2-Norm(final)=6.691 | 5046.4 samples/s | 78.9 steps/s
[Step=6650 Epoch=13.0] | Loss=0.07631 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.362 | L2-Norm(final)=6.678 | 5017.2 samples/s | 78.4 steps/s
[Step=6700 Epoch=13.1] | Loss=0.07276 | Reg=0.00239 | acc=0.9375 | L2-Norm=15.449 | L2-Norm(final)=6.670 | 4963.0 samples/s | 77.5 steps/s
[Step=6750 Epoch=13.2] | Loss=0.06924 | Reg=0.00241 | acc=0.9688 | L2-Norm=15.519 | L2-Norm(final)=6.664 | 5025.0 samples/s | 78.5 steps/s
[Step=6800 Epoch=13.3] | Loss=0.06766 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.581 | L2-Norm(final)=6.657 | 4996.5 samples/s | 78.1 steps/s
[Step=6850 Epoch=13.4] | Loss=0.06638 | Reg=0.00245 | acc=0.9375 | L2-Norm=15.637 | L2-Norm(final)=6.651 | 5041.4 samples/s | 78.8 steps/s
[Step=6900 Epoch=13.5] | Loss=0.06491 | Reg=0.00246 | acc=0.9688 | L2-Norm=15.689 | L2-Norm(final)=6.644 | 5133.1 samples/s | 80.2 steps/s
[Step=6950 Epoch=13.6] | Loss=0.06374 | Reg=0.00248 | acc=0.9531 | L2-Norm=15.737 | L2-Norm(final)=6.638 | 5103.5 samples/s | 79.7 steps/s
[Step=7000 Epoch=13.7] | Loss=0.06197 | Reg=0.00249 | acc=0.9375 | L2-Norm=15.781 | L2-Norm(final)=6.634 | 6350.8 samples/s | 99.2 steps/s
[Step=7050 Epoch=13.8] | Loss=0.05965 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.821 | L2-Norm(final)=6.631 | 1931.3 samples/s | 30.2 steps/s
[Step=7100 Epoch=13.9] | Loss=0.05707 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.859 | L2-Norm(final)=6.629 | 5041.8 samples/s | 78.8 steps/s
[Step=7150 Epoch=14.0] | Loss=0.05603 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.895 | L2-Norm(final)=6.626 | 4957.7 samples/s | 77.5 steps/s
[Step=7200 Epoch=14.1] | Loss=0.05485 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.929 | L2-Norm(final)=6.622 | 5056.4 samples/s | 79.0 steps/s
[Step=7250 Epoch=14.2] | Loss=0.05342 | Reg=0.00255 | acc=0.9531 | L2-Norm=15.961 | L2-Norm(final)=6.619 | 4986.6 samples/s | 77.9 steps/s
[Step=7300 Epoch=14.3] | Loss=0.05228 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.990 | L2-Norm(final)=6.617 | 5028.5 samples/s | 78.6 steps/s
[Step=7350 Epoch=14.4] | Loss=0.05147 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.020 | L2-Norm(final)=6.614 | 5023.2 samples/s | 78.5 steps/s
[Step=7400 Epoch=14.5] | Loss=0.05057 | Reg=0.00258 | acc=0.9844 | L2-Norm=16.049 | L2-Norm(final)=6.612 | 5040.9 samples/s | 78.8 steps/s
[Step=7450 Epoch=14.6] | Loss=0.05036 | Reg=0.00259 | acc=0.9688 | L2-Norm=16.078 | L2-Norm(final)=6.609 | 4943.6 samples/s | 77.2 steps/s
[Step=7500 Epoch=14.7] | Loss=0.04998 | Reg=0.00260 | acc=0.9688 | L2-Norm=16.106 | L2-Norm(final)=6.607 | 5302.0 samples/s | 82.8 steps/s
[Step=7550 Epoch=14.8] | Loss=0.04950 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.134 | L2-Norm(final)=6.604 | 2006.4 samples/s | 31.4 steps/s
[Step=7600 Epoch=14.9] | Loss=0.04854 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.160 | L2-Norm(final)=6.601 | 5036.1 samples/s | 78.7 steps/s
[Step=7650 Epoch=15.0] | Loss=0.04777 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.186 | L2-Norm(final)=6.598 | 5040.2 samples/s | 78.8 steps/s
[Step=7700 Epoch=15.1] | Loss=0.04696 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.211 | L2-Norm(final)=6.596 | 5033.5 samples/s | 78.6 steps/s
[Step=7750 Epoch=15.2] | Loss=0.04629 | Reg=0.00264 | acc=0.9531 | L2-Norm=16.235 | L2-Norm(final)=6.594 | 5048.0 samples/s | 78.9 steps/s
[Step=7800 Epoch=15.2] | Loss=0.04584 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.259 | L2-Norm(final)=6.592 | 5056.8 samples/s | 79.0 steps/s
[Step=7850 Epoch=15.3] | Loss=0.04509 | Reg=0.00265 | acc=0.9844 | L2-Norm=16.282 | L2-Norm(final)=6.591 | 5039.1 samples/s | 78.7 steps/s
[Step=7900 Epoch=15.4] | Loss=0.04468 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.305 | L2-Norm(final)=6.589 | 5009.2 samples/s | 78.3 steps/s
[Step=7950 Epoch=15.5] | Loss=0.04418 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.327 | L2-Norm(final)=6.587 | 5016.9 samples/s | 78.4 steps/s
[Step=8000 Epoch=15.6] | Loss=0.04375 | Reg=0.00268 | acc=0.9531 | L2-Norm=16.349 | L2-Norm(final)=6.586 | 4977.4 samples/s | 77.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step8000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=15.3] | Loss=0.07450 | Reg=0.00220 | acc=0.9375 | L2-Norm=14.845 | L2-Norm(final)=6.344 | 3746.8 samples/s | 58.5 steps/s
[Step=4050 Epoch=15.5] | Loss=0.03674 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.837 | L2-Norm(final)=6.316 | 4992.0 samples/s | 78.0 steps/s
[Step=4100 Epoch=15.7] | Loss=0.02746 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.836 | L2-Norm(final)=6.330 | 5460.6 samples/s | 85.3 steps/s
[Step=4150 Epoch=15.9] | Loss=0.02508 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.835 | L2-Norm(final)=6.362 | 5430.4 samples/s | 84.8 steps/s
[Step=4200 Epoch=16.1] | Loss=0.02352 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.835 | L2-Norm(final)=6.403 | 5502.5 samples/s | 86.0 steps/s
[Step=4250 Epoch=16.3] | Loss=0.02265 | Reg=0.00220 | acc=0.9688 | L2-Norm=14.835 | L2-Norm(final)=6.442 | 7274.3 samples/s | 113.7 steps/s
[Step=4300 Epoch=16.5] | Loss=0.02169 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.835 | L2-Norm(final)=6.484 | 1983.6 samples/s | 31.0 steps/s
[Step=4350 Epoch=16.7] | Loss=0.02117 | Reg=0.00220 | acc=0.9531 | L2-Norm=14.835 | L2-Norm(final)=6.528 | 5503.4 samples/s | 86.0 steps/s
[Step=4400 Epoch=16.9] | Loss=0.02030 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.835 | L2-Norm(final)=6.573 | 5456.4 samples/s | 85.3 steps/s
[Step=4450 Epoch=17.1] | Loss=0.01996 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.835 | L2-Norm(final)=6.616 | 5366.8 samples/s | 83.9 steps/s
[Step=4500 Epoch=17.2] | Loss=0.01968 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.835 | L2-Norm(final)=6.656 | 6198.6 samples/s | 96.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=17.2] | Loss=0.00975 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.834 | L2-Norm(final)=7.049 | 3688.1 samples/s | 57.6 steps/s
[Step=4550 Epoch=17.4] | Loss=0.02020 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.033 | L2-Norm(final)=7.062 | 4716.9 samples/s | 73.7 steps/s
[Step=4600 Epoch=17.6] | Loss=0.02112 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.240 | L2-Norm(final)=7.036 | 4782.0 samples/s | 74.7 steps/s
[Step=4650 Epoch=17.8] | Loss=0.01744 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.376 | L2-Norm(final)=7.019 | 4686.3 samples/s | 73.2 steps/s
[Step=4700 Epoch=18.0] | Loss=0.01428 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.453 | L2-Norm(final)=7.008 | 4782.1 samples/s | 74.7 steps/s
[Step=4750 Epoch=18.2] | Loss=0.01294 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.497 | L2-Norm(final)=7.001 | 6092.8 samples/s | 95.2 steps/s
[Step=4800 Epoch=18.4] | Loss=0.01113 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.522 | L2-Norm(final)=6.997 | 1867.6 samples/s | 29.2 steps/s
[Step=4850 Epoch=18.6] | Loss=0.00964 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.532 | L2-Norm(final)=6.994 | 4784.1 samples/s | 74.8 steps/s
[Step=4900 Epoch=18.8] | Loss=0.00853 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.532 | L2-Norm(final)=6.992 | 4730.4 samples/s | 73.9 steps/s
[Step=4950 Epoch=19.0] | Loss=0.00761 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.526 | L2-Norm(final)=6.992 | 4778.1 samples/s | 74.7 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00688 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.515 | L2-Norm(final)=6.993 | 5323.6 samples/s | 83.2 steps/s
[Step=5050 Epoch=19.3] | Loss=0.00627 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.500 | L2-Norm(final)=6.993 | 1960.4 samples/s | 30.6 steps/s
[Step=5100 Epoch=19.5] | Loss=0.00575 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.481 | L2-Norm(final)=6.994 | 4869.2 samples/s | 76.1 steps/s
[Step=5150 Epoch=19.7] | Loss=0.00531 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.460 | L2-Norm(final)=6.995 | 4797.9 samples/s | 75.0 steps/s
[Step=5200 Epoch=19.9] | Loss=0.00493 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.436 | L2-Norm(final)=6.995 | 4677.4 samples/s | 73.1 steps/s
[Step=5250 Epoch=20.1] | Loss=0.00460 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.411 | L2-Norm(final)=6.996 | 4838.7 samples/s | 75.6 steps/s
[Step=5300 Epoch=20.3] | Loss=0.00432 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.385 | L2-Norm(final)=6.996 | 2042.9 samples/s | 31.9 steps/s
[Step=5350 Epoch=20.5] | Loss=0.00406 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.358 | L2-Norm(final)=6.997 | 4833.1 samples/s | 75.5 steps/s
[Step=5400 Epoch=20.7] | Loss=0.00384 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.330 | L2-Norm(final)=6.997 | 4854.0 samples/s | 75.8 steps/s
[Step=5450 Epoch=20.9] | Loss=0.00364 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.302 | L2-Norm(final)=6.998 | 4948.8 samples/s | 77.3 steps/s
[Step=5500 Epoch=21.1] | Loss=0.00345 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.273 | L2-Norm(final)=6.998 | 4817.8 samples/s | 75.3 steps/s
[Step=5550 Epoch=21.3] | Loss=0.00329 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.244 | L2-Norm(final)=6.999 | 2050.7 samples/s | 32.0 steps/s
[Step=5600 Epoch=21.5] | Loss=0.00314 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.214 | L2-Norm(final)=6.999 | 4779.4 samples/s | 74.7 steps/s
[Step=5650 Epoch=21.6] | Loss=0.00300 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.184 | L2-Norm(final)=7.000 | 4785.8 samples/s | 74.8 steps/s
[Step=5700 Epoch=21.8] | Loss=0.00288 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.154 | L2-Norm(final)=7.000 | 4805.4 samples/s | 75.1 steps/s
[Step=5750 Epoch=22.0] | Loss=0.00276 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.124 | L2-Norm(final)=7.001 | 4759.4 samples/s | 74.4 steps/s
[Step=5800 Epoch=22.2] | Loss=0.00266 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.093 | L2-Norm(final)=7.001 | 6503.8 samples/s | 101.6 steps/s
[Step=5850 Epoch=22.4] | Loss=0.00256 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.063 | L2-Norm(final)=7.001 | 1832.0 samples/s | 28.6 steps/s
[Step=5900 Epoch=22.6] | Loss=0.00247 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.032 | L2-Norm(final)=7.002 | 4746.0 samples/s | 74.2 steps/s
[Step=5950 Epoch=22.8] | Loss=0.00238 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.002 | L2-Norm(final)=7.002 | 4797.1 samples/s | 75.0 steps/s
[Step=6000 Epoch=23.0] | Loss=0.00230 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.971 | L2-Norm(final)=7.003 | 4778.2 samples/s | 74.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step6000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07212 | acc=0.9523 | tpr=0.9537 | fpr=0.0505 | 4319.5 samples/s | 16.9 steps/s
Avg test loss: 0.07365, Avg test acc: 0.95240, Avg tpr: 0.95326, Avg fpr: 0.04948, total FA: 386

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07637 | acc=0.9524 | tpr=0.9726 | fpr=0.0914 | 4201.7 samples/s | 16.4 steps/s
Avg test loss: 0.07694, Avg test acc: 0.95248, Avg tpr: 0.97319, Avg fpr: 0.09306, total FA: 726

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.42903 | acc=0.3158 | tpr=0.0092 | fpr=0.0186 | 4159.1 samples/s | 16.2 steps/s
Avg test loss: 5.42733, Avg test acc: 0.31305, Avg tpr: 0.00968, Avg fpr: 0.01974, total FA: 154

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.75549 | acc=0.3180 | tpr=0.0274 | fpr=0.0510 | 4192.8 samples/s | 16.4 steps/s
Avg test loss: 5.77836, Avg test acc: 0.31549, Avg tpr: 0.02728, Avg fpr: 0.05063, total FA: 395

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.09639 | acc=0.1302 | tpr=0.8053 | fpr=0.8819 | 4096.5 samples/s | 16.0 steps/s
[Step= 100] | Loss=4.06839 | acc=0.1313 | tpr=0.7910 | fpr=0.8810 | 8501.9 samples/s | 33.2 steps/s
[Step= 150] | Loss=4.07569 | acc=0.1313 | tpr=0.7867 | fpr=0.8808 | 8199.7 samples/s | 32.0 steps/s
[Step= 200] | Loss=4.07514 | acc=0.1317 | tpr=0.7858 | fpr=0.8802 | 8489.2 samples/s | 33.2 steps/s
[Step= 250] | Loss=4.07728 | acc=0.1321 | tpr=0.7930 | fpr=0.8800 | 8431.3 samples/s | 32.9 steps/s
[Step= 300] | Loss=4.07898 | acc=0.1320 | tpr=0.7840 | fpr=0.8799 | 8215.4 samples/s | 32.1 steps/s
[Step= 350] | Loss=4.07777 | acc=0.1317 | tpr=0.7833 | fpr=0.8802 | 8089.3 samples/s | 31.6 steps/s
[Step= 400] | Loss=4.08116 | acc=0.1318 | tpr=0.7899 | fpr=0.8801 | 8221.2 samples/s | 32.1 steps/s
[Step= 450] | Loss=4.08255 | acc=0.1317 | tpr=0.7882 | fpr=0.8803 | 8181.0 samples/s | 32.0 steps/s
[Step= 500] | Loss=4.08300 | acc=0.1313 | tpr=0.7837 | fpr=0.8805 | 8744.3 samples/s | 34.2 steps/s
[Step= 550] | Loss=4.08488 | acc=0.1314 | tpr=0.7815 | fpr=0.8804 | 13397.7 samples/s | 52.3 steps/s
Avg test loss: 4.08484, Avg test acc: 0.13124, Avg tpr: 0.78170, Avg fpr: 0.88059, total FA: 122268

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.12210 | acc=0.0911 | tpr=0.9381 | fpr=0.9241 | 4234.6 samples/s | 16.5 steps/s
[Step= 100] | Loss=4.10490 | acc=0.0911 | tpr=0.9360 | fpr=0.9247 | 8322.1 samples/s | 32.5 steps/s
[Step= 150] | Loss=4.11876 | acc=0.0915 | tpr=0.9236 | fpr=0.9238 | 8331.1 samples/s | 32.5 steps/s
[Step= 200] | Loss=4.12162 | acc=0.0912 | tpr=0.9148 | fpr=0.9238 | 8347.7 samples/s | 32.6 steps/s
[Step= 250] | Loss=4.12128 | acc=0.0914 | tpr=0.9170 | fpr=0.9236 | 8583.5 samples/s | 33.5 steps/s
[Step= 300] | Loss=4.11737 | acc=0.0918 | tpr=0.9164 | fpr=0.9232 | 8614.7 samples/s | 33.7 steps/s
[Step= 350] | Loss=4.11354 | acc=0.0913 | tpr=0.9173 | fpr=0.9237 | 7704.1 samples/s | 30.1 steps/s
[Step= 400] | Loss=4.11337 | acc=0.0914 | tpr=0.9158 | fpr=0.9236 | 8647.4 samples/s | 33.8 steps/s
[Step= 450] | Loss=4.11677 | acc=0.0909 | tpr=0.9163 | fpr=0.9241 | 8348.5 samples/s | 32.6 steps/s
[Step= 500] | Loss=4.11706 | acc=0.0912 | tpr=0.9185 | fpr=0.9238 | 8213.0 samples/s | 32.1 steps/s
[Step= 550] | Loss=4.11741 | acc=0.0913 | tpr=0.9224 | fpr=0.9238 | 15307.9 samples/s | 59.8 steps/s
Avg test loss: 4.11764, Avg test acc: 0.09124, Avg tpr: 0.92235, Avg fpr: 0.92387, total FA: 128277

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08447 | acc=0.9830 | tpr=0.9115 | fpr=0.0157 | 4174.9 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.08839 | acc=0.9825 | tpr=0.9211 | fpr=0.0164 | 8210.3 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.09158 | acc=0.9818 | tpr=0.9294 | fpr=0.0172 | 8572.3 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.09210 | acc=0.9820 | tpr=0.9333 | fpr=0.0171 | 8215.3 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.09112 | acc=0.9820 | tpr=0.9310 | fpr=0.0170 | 8439.5 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.09232 | acc=0.9817 | tpr=0.9258 | fpr=0.0172 | 8276.8 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.09241 | acc=0.9817 | tpr=0.9286 | fpr=0.0173 | 8145.9 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.09283 | acc=0.9816 | tpr=0.9272 | fpr=0.0174 | 8282.4 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.09509 | acc=0.9813 | tpr=0.9255 | fpr=0.0177 | 8230.3 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.09494 | acc=0.9813 | tpr=0.9260 | fpr=0.0177 | 8269.3 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.09424 | acc=0.9815 | tpr=0.9240 | fpr=0.0175 | 15536.2 samples/s | 60.7 steps/s
Avg test loss: 0.09413, Avg test acc: 0.98149, Avg tpr: 0.92353, Avg fpr: 0.01746, total FA: 2424

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09745 | acc=0.9809 | tpr=0.9469 | fpr=0.0185 | 4119.0 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.10103 | acc=0.9806 | tpr=0.9446 | fpr=0.0187 | 8288.3 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.10591 | acc=0.9796 | tpr=0.9467 | fpr=0.0198 | 8431.4 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.10692 | acc=0.9795 | tpr=0.9475 | fpr=0.0199 | 8629.1 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.10537 | acc=0.9795 | tpr=0.9424 | fpr=0.0198 | 8219.4 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.10724 | acc=0.9792 | tpr=0.9404 | fpr=0.0201 | 8091.7 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.10825 | acc=0.9792 | tpr=0.9443 | fpr=0.0202 | 8090.6 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.10923 | acc=0.9790 | tpr=0.9447 | fpr=0.0204 | 8394.7 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.11111 | acc=0.9787 | tpr=0.9411 | fpr=0.0206 | 8264.3 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.11112 | acc=0.9787 | tpr=0.9427 | fpr=0.0207 | 8444.7 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.11037 | acc=0.9789 | tpr=0.9423 | fpr=0.0205 | 14541.1 samples/s | 56.8 steps/s
Avg test loss: 0.11024, Avg test acc: 0.97889, Avg tpr: 0.94216, Avg fpr: 0.02044, total FA: 2838

server round 6/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=11.7] | Loss=0.14628 | Reg=0.00213 | acc=0.8750 | L2-Norm=14.609 | L2-Norm(final)=6.073 | 3731.7 samples/s | 58.3 steps/s
[Step=6050 Epoch=11.8] | Loss=0.15454 | Reg=0.00214 | acc=0.8750 | L2-Norm=14.621 | L2-Norm(final)=6.034 | 5490.1 samples/s | 85.8 steps/s
[Step=6100 Epoch=11.9] | Loss=0.12520 | Reg=0.00214 | acc=0.9062 | L2-Norm=14.623 | L2-Norm(final)=6.096 | 5957.4 samples/s | 93.1 steps/s
[Step=6150 Epoch=12.0] | Loss=0.11335 | Reg=0.00214 | acc=0.8750 | L2-Norm=14.623 | L2-Norm(final)=6.190 | 5651.1 samples/s | 88.3 steps/s
[Step=6200 Epoch=12.1] | Loss=0.10635 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.623 | L2-Norm(final)=6.288 | 5809.4 samples/s | 90.8 steps/s
[Step=6250 Epoch=12.2] | Loss=0.10152 | Reg=0.00214 | acc=0.9219 | L2-Norm=14.624 | L2-Norm(final)=6.384 | 5828.6 samples/s | 91.1 steps/s
[Step=6300 Epoch=12.3] | Loss=0.09969 | Reg=0.00214 | acc=0.9062 | L2-Norm=14.624 | L2-Norm(final)=6.474 | 5728.8 samples/s | 89.5 steps/s
[Step=6350 Epoch=12.4] | Loss=0.09698 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.624 | L2-Norm(final)=6.560 | 5883.5 samples/s | 91.9 steps/s
[Step=6400 Epoch=12.5] | Loss=0.09486 | Reg=0.00214 | acc=0.9375 | L2-Norm=14.624 | L2-Norm(final)=6.644 | 5751.4 samples/s | 89.9 steps/s
[Step=6450 Epoch=12.6] | Loss=0.09274 | Reg=0.00214 | acc=0.9531 | L2-Norm=14.624 | L2-Norm(final)=6.724 | 5792.5 samples/s | 90.5 steps/s
[Step=6500 Epoch=12.7] | Loss=0.09145 | Reg=0.00214 | acc=0.9375 | L2-Norm=14.624 | L2-Norm(final)=6.802 | 7328.4 samples/s | 114.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=12.7] | Loss=0.04073 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.624 | L2-Norm(final)=7.562 | 4045.1 samples/s | 63.2 steps/s
[Step=6550 Epoch=12.8] | Loss=0.07340 | Reg=0.00220 | acc=0.9531 | L2-Norm=14.821 | L2-Norm(final)=7.571 | 4584.8 samples/s | 71.6 steps/s
[Step=6600 Epoch=12.9] | Loss=0.07055 | Reg=0.00224 | acc=0.9531 | L2-Norm=14.978 | L2-Norm(final)=7.555 | 5065.8 samples/s | 79.2 steps/s
[Step=6650 Epoch=13.0] | Loss=0.06728 | Reg=0.00227 | acc=0.9531 | L2-Norm=15.077 | L2-Norm(final)=7.544 | 5056.4 samples/s | 79.0 steps/s
[Step=6700 Epoch=13.1] | Loss=0.06537 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.160 | L2-Norm(final)=7.534 | 5009.4 samples/s | 78.3 steps/s
[Step=6750 Epoch=13.2] | Loss=0.06392 | Reg=0.00232 | acc=0.9531 | L2-Norm=15.233 | L2-Norm(final)=7.526 | 5029.1 samples/s | 78.6 steps/s
[Step=6800 Epoch=13.3] | Loss=0.06239 | Reg=0.00234 | acc=0.9688 | L2-Norm=15.296 | L2-Norm(final)=7.518 | 5068.6 samples/s | 79.2 steps/s
[Step=6850 Epoch=13.4] | Loss=0.06114 | Reg=0.00236 | acc=0.9219 | L2-Norm=15.353 | L2-Norm(final)=7.510 | 4982.8 samples/s | 77.9 steps/s
[Step=6900 Epoch=13.5] | Loss=0.05949 | Reg=0.00237 | acc=0.9531 | L2-Norm=15.406 | L2-Norm(final)=7.504 | 4979.7 samples/s | 77.8 steps/s
[Step=6950 Epoch=13.6] | Loss=0.05811 | Reg=0.00239 | acc=0.9688 | L2-Norm=15.456 | L2-Norm(final)=7.499 | 4998.9 samples/s | 78.1 steps/s
[Step=7000 Epoch=13.7] | Loss=0.05691 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.504 | L2-Norm(final)=7.494 | 6124.0 samples/s | 95.7 steps/s
[Step=7050 Epoch=13.8] | Loss=0.05474 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.549 | L2-Norm(final)=7.490 | 1884.9 samples/s | 29.5 steps/s
[Step=7100 Epoch=13.8] | Loss=0.05322 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.591 | L2-Norm(final)=7.487 | 4949.5 samples/s | 77.3 steps/s
[Step=7150 Epoch=13.9] | Loss=0.05233 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.630 | L2-Norm(final)=7.483 | 5006.3 samples/s | 78.2 steps/s
[Step=7200 Epoch=14.0] | Loss=0.05118 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.666 | L2-Norm(final)=7.480 | 5056.4 samples/s | 79.0 steps/s
[Step=7250 Epoch=14.1] | Loss=0.04986 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.700 | L2-Norm(final)=7.478 | 5040.3 samples/s | 78.8 steps/s
[Step=7300 Epoch=14.2] | Loss=0.04864 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.734 | L2-Norm(final)=7.476 | 5037.6 samples/s | 78.7 steps/s
[Step=7350 Epoch=14.3] | Loss=0.04756 | Reg=0.00249 | acc=0.9375 | L2-Norm=15.767 | L2-Norm(final)=7.474 | 5028.0 samples/s | 78.6 steps/s
[Step=7400 Epoch=14.4] | Loss=0.04668 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.800 | L2-Norm(final)=7.472 | 5098.2 samples/s | 79.7 steps/s
[Step=7450 Epoch=14.5] | Loss=0.04614 | Reg=0.00251 | acc=0.9844 | L2-Norm=15.832 | L2-Norm(final)=7.469 | 5001.3 samples/s | 78.1 steps/s
[Step=7500 Epoch=14.6] | Loss=0.04552 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.862 | L2-Norm(final)=7.467 | 5332.4 samples/s | 83.3 steps/s
[Step=7550 Epoch=14.7] | Loss=0.04490 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.893 | L2-Norm(final)=7.464 | 1985.0 samples/s | 31.0 steps/s
[Step=7600 Epoch=14.8] | Loss=0.04427 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.923 | L2-Norm(final)=7.462 | 5058.3 samples/s | 79.0 steps/s
[Step=7650 Epoch=14.9] | Loss=0.04365 | Reg=0.00255 | acc=0.9688 | L2-Norm=15.953 | L2-Norm(final)=7.459 | 5059.3 samples/s | 79.1 steps/s
[Step=7700 Epoch=15.0] | Loss=0.04326 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.984 | L2-Norm(final)=7.456 | 4983.8 samples/s | 77.9 steps/s
[Step=7750 Epoch=15.1] | Loss=0.04278 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.013 | L2-Norm(final)=7.454 | 5089.5 samples/s | 79.5 steps/s
[Step=7800 Epoch=15.2] | Loss=0.04219 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.041 | L2-Norm(final)=7.451 | 5037.4 samples/s | 78.7 steps/s
[Step=7850 Epoch=15.3] | Loss=0.04189 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.070 | L2-Norm(final)=7.449 | 5073.0 samples/s | 79.3 steps/s
[Step=7900 Epoch=15.4] | Loss=0.04149 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.098 | L2-Norm(final)=7.447 | 5075.1 samples/s | 79.3 steps/s
[Step=7950 Epoch=15.5] | Loss=0.04120 | Reg=0.00260 | acc=0.9531 | L2-Norm=16.125 | L2-Norm(final)=7.445 | 4963.6 samples/s | 77.6 steps/s
[Step=8000 Epoch=15.6] | Loss=0.04083 | Reg=0.00261 | acc=0.9531 | L2-Norm=16.152 | L2-Norm(final)=7.442 | 5009.9 samples/s | 78.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step8000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=15.6] | Loss=0.06848 | Reg=0.00213 | acc=0.9531 | L2-Norm=14.609 | L2-Norm(final)=6.535 | 3927.6 samples/s | 61.4 steps/s
[Step=8050 Epoch=15.7] | Loss=0.11718 | Reg=0.00214 | acc=0.9219 | L2-Norm=14.613 | L2-Norm(final)=6.568 | 5422.4 samples/s | 84.7 steps/s
[Step=8100 Epoch=15.8] | Loss=0.10556 | Reg=0.00214 | acc=0.9062 | L2-Norm=14.614 | L2-Norm(final)=6.657 | 5810.9 samples/s | 90.8 steps/s
[Step=8150 Epoch=15.9] | Loss=0.10175 | Reg=0.00214 | acc=0.9375 | L2-Norm=14.614 | L2-Norm(final)=6.751 | 5833.3 samples/s | 91.1 steps/s
[Step=8200 Epoch=16.0] | Loss=0.09837 | Reg=0.00214 | acc=0.9531 | L2-Norm=14.614 | L2-Norm(final)=6.848 | 5726.8 samples/s | 89.5 steps/s
[Step=8250 Epoch=16.1] | Loss=0.09694 | Reg=0.00214 | acc=0.8750 | L2-Norm=14.614 | L2-Norm(final)=6.943 | 5783.8 samples/s | 90.4 steps/s
[Step=8300 Epoch=16.2] | Loss=0.09670 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.614 | L2-Norm(final)=7.029 | 5865.2 samples/s | 91.6 steps/s
[Step=8350 Epoch=16.3] | Loss=0.09486 | Reg=0.00214 | acc=0.9531 | L2-Norm=14.614 | L2-Norm(final)=7.111 | 5777.8 samples/s | 90.3 steps/s
[Step=8400 Epoch=16.4] | Loss=0.09371 | Reg=0.00214 | acc=0.9219 | L2-Norm=14.614 | L2-Norm(final)=7.190 | 5814.6 samples/s | 90.9 steps/s
[Step=8450 Epoch=16.5] | Loss=0.09293 | Reg=0.00214 | acc=0.9219 | L2-Norm=14.614 | L2-Norm(final)=7.266 | 5887.3 samples/s | 92.0 steps/s
[Step=8500 Epoch=16.6] | Loss=0.09178 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.614 | L2-Norm(final)=7.340 | 7469.1 samples/s | 116.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=16.6] | Loss=0.10018 | Reg=0.00214 | acc=0.8906 | L2-Norm=14.614 | L2-Norm(final)=8.071 | 3859.6 samples/s | 60.3 steps/s
[Step=8550 Epoch=16.7] | Loss=0.07219 | Reg=0.00219 | acc=0.8906 | L2-Norm=14.808 | L2-Norm(final)=8.080 | 4852.2 samples/s | 75.8 steps/s
[Step=8600 Epoch=16.8] | Loss=0.06452 | Reg=0.00224 | acc=0.9688 | L2-Norm=14.969 | L2-Norm(final)=8.062 | 5065.6 samples/s | 79.1 steps/s
[Step=8650 Epoch=16.9] | Loss=0.06224 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.095 | L2-Norm(final)=8.048 | 4992.8 samples/s | 78.0 steps/s
[Step=8700 Epoch=17.0] | Loss=0.06110 | Reg=0.00231 | acc=0.9531 | L2-Norm=15.192 | L2-Norm(final)=8.038 | 5051.8 samples/s | 78.9 steps/s
[Step=8750 Epoch=17.1] | Loss=0.06118 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.271 | L2-Norm(final)=8.029 | 5043.5 samples/s | 78.8 steps/s
[Step=8800 Epoch=17.2] | Loss=0.05910 | Reg=0.00235 | acc=0.9375 | L2-Norm=15.342 | L2-Norm(final)=8.021 | 5019.7 samples/s | 78.4 steps/s
[Step=8850 Epoch=17.3] | Loss=0.05846 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.406 | L2-Norm(final)=8.014 | 5027.4 samples/s | 78.6 steps/s
[Step=8900 Epoch=17.4] | Loss=0.05802 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.465 | L2-Norm(final)=8.007 | 5095.9 samples/s | 79.6 steps/s
[Step=8950 Epoch=17.5] | Loss=0.05684 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.519 | L2-Norm(final)=8.000 | 5039.8 samples/s | 78.7 steps/s
[Step=9000 Epoch=17.6] | Loss=0.05596 | Reg=0.00243 | acc=0.8906 | L2-Norm=15.569 | L2-Norm(final)=7.994 | 6230.7 samples/s | 97.4 steps/s
[Step=9050 Epoch=17.7] | Loss=0.05424 | Reg=0.00244 | acc=0.9688 | L2-Norm=15.617 | L2-Norm(final)=7.988 | 1945.9 samples/s | 30.4 steps/s
[Step=9100 Epoch=17.8] | Loss=0.05241 | Reg=0.00245 | acc=0.9531 | L2-Norm=15.661 | L2-Norm(final)=7.983 | 4971.6 samples/s | 77.7 steps/s
[Step=9150 Epoch=17.9] | Loss=0.05150 | Reg=0.00247 | acc=0.9688 | L2-Norm=15.704 | L2-Norm(final)=7.977 | 5069.0 samples/s | 79.2 steps/s
[Step=9200 Epoch=18.0] | Loss=0.05012 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.744 | L2-Norm(final)=7.972 | 5021.8 samples/s | 78.5 steps/s
[Step=9250 Epoch=18.1] | Loss=0.04956 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.782 | L2-Norm(final)=7.968 | 4993.6 samples/s | 78.0 steps/s
[Step=9300 Epoch=18.2] | Loss=0.04901 | Reg=0.00250 | acc=0.9688 | L2-Norm=15.820 | L2-Norm(final)=7.963 | 5028.4 samples/s | 78.6 steps/s
[Step=9350 Epoch=18.3] | Loss=0.04810 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.857 | L2-Norm(final)=7.959 | 5090.8 samples/s | 79.5 steps/s
[Step=9400 Epoch=18.4] | Loss=0.04742 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.893 | L2-Norm(final)=7.955 | 4949.6 samples/s | 77.3 steps/s
[Step=9450 Epoch=18.5] | Loss=0.04636 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.928 | L2-Norm(final)=7.951 | 5075.8 samples/s | 79.3 steps/s
[Step=9500 Epoch=18.6] | Loss=0.04543 | Reg=0.00255 | acc=0.9844 | L2-Norm=15.963 | L2-Norm(final)=7.948 | 5405.7 samples/s | 84.5 steps/s
[Step=9550 Epoch=18.7] | Loss=0.04479 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.997 | L2-Norm(final)=7.945 | 2017.6 samples/s | 31.5 steps/s
[Step=9600 Epoch=18.8] | Loss=0.04403 | Reg=0.00257 | acc=0.9688 | L2-Norm=16.029 | L2-Norm(final)=7.941 | 5021.6 samples/s | 78.5 steps/s
[Step=9650 Epoch=18.9] | Loss=0.04331 | Reg=0.00258 | acc=0.9844 | L2-Norm=16.061 | L2-Norm(final)=7.938 | 4995.5 samples/s | 78.1 steps/s
[Step=9700 Epoch=19.0] | Loss=0.04272 | Reg=0.00259 | acc=0.9688 | L2-Norm=16.091 | L2-Norm(final)=7.935 | 4984.5 samples/s | 77.9 steps/s
[Step=9750 Epoch=19.1] | Loss=0.04239 | Reg=0.00260 | acc=0.9844 | L2-Norm=16.120 | L2-Norm(final)=7.933 | 5063.3 samples/s | 79.1 steps/s
[Step=9800 Epoch=19.2] | Loss=0.04185 | Reg=0.00261 | acc=0.9688 | L2-Norm=16.148 | L2-Norm(final)=7.930 | 5030.3 samples/s | 78.6 steps/s
[Step=9850 Epoch=19.3] | Loss=0.04120 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.175 | L2-Norm(final)=7.927 | 5058.0 samples/s | 79.0 steps/s
[Step=9900 Epoch=19.4] | Loss=0.04090 | Reg=0.00263 | acc=0.9531 | L2-Norm=16.201 | L2-Norm(final)=7.924 | 4967.9 samples/s | 77.6 steps/s
[Step=9950 Epoch=19.5] | Loss=0.04059 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.227 | L2-Norm(final)=7.921 | 5066.8 samples/s | 79.2 steps/s
[Step=10000 Epoch=19.5] | Loss=0.04029 | Reg=0.00264 | acc=0.9688 | L2-Norm=16.252 | L2-Norm(final)=7.918 | 5044.7 samples/s | 78.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step10000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07440 | acc=0.9566 | tpr=0.9660 | fpr=0.0637 | 4196.3 samples/s | 16.4 steps/s
Avg test loss: 0.07481, Avg test acc: 0.95593, Avg tpr: 0.96410, Avg fpr: 0.06204, total FA: 484

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07405 | acc=0.9565 | tpr=0.9760 | fpr=0.0860 | 4156.4 samples/s | 16.2 steps/s
Avg test loss: 0.07656, Avg test acc: 0.95549, Avg tpr: 0.97412, Avg fpr: 0.08550, total FA: 667

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.42903 | acc=0.3158 | tpr=0.0092 | fpr=0.0186 | 4234.6 samples/s | 16.5 steps/s
Avg test loss: 5.42733, Avg test acc: 0.31305, Avg tpr: 0.00968, Avg fpr: 0.01974, total FA: 154

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.75549 | acc=0.3180 | tpr=0.0274 | fpr=0.0510 | 4243.0 samples/s | 16.6 steps/s
Avg test loss: 5.77836, Avg test acc: 0.31549, Avg tpr: 0.02728, Avg fpr: 0.05063, total FA: 395

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.23986 | acc=0.1092 | tpr=0.8938 | fpr=0.9049 | 4164.1 samples/s | 16.3 steps/s
[Step= 100] | Loss=5.21975 | acc=0.1130 | tpr=0.9126 | fpr=0.9019 | 8353.9 samples/s | 32.6 steps/s
[Step= 150] | Loss=5.23658 | acc=0.1131 | tpr=0.9049 | fpr=0.9015 | 8518.0 samples/s | 33.3 steps/s
[Step= 200] | Loss=5.23964 | acc=0.1135 | tpr=0.9016 | fpr=0.9008 | 8260.8 samples/s | 32.3 steps/s
[Step= 250] | Loss=5.24038 | acc=0.1134 | tpr=0.9013 | fpr=0.9009 | 8627.3 samples/s | 33.7 steps/s
[Step= 300] | Loss=5.23959 | acc=0.1135 | tpr=0.8967 | fpr=0.9008 | 8455.4 samples/s | 33.0 steps/s
[Step= 350] | Loss=5.23856 | acc=0.1133 | tpr=0.9023 | fpr=0.9010 | 8297.5 samples/s | 32.4 steps/s
[Step= 400] | Loss=5.24116 | acc=0.1136 | tpr=0.9026 | fpr=0.9007 | 8098.2 samples/s | 31.6 steps/s
[Step= 450] | Loss=5.24518 | acc=0.1137 | tpr=0.9017 | fpr=0.9006 | 8367.5 samples/s | 32.7 steps/s
[Step= 500] | Loss=5.24614 | acc=0.1136 | tpr=0.9013 | fpr=0.9007 | 8196.7 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.24456 | acc=0.1138 | tpr=0.8997 | fpr=0.9005 | 15262.3 samples/s | 59.6 steps/s
Avg test loss: 5.24507, Avg test acc: 0.11371, Avg tpr: 0.90016, Avg fpr: 0.90058, total FA: 125044

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.87115 | acc=0.0871 | tpr=0.9381 | fpr=0.9282 | 4172.0 samples/s | 16.3 steps/s
[Step= 100] | Loss=4.83336 | acc=0.0882 | tpr=0.9211 | fpr=0.9273 | 8263.9 samples/s | 32.3 steps/s
[Step= 150] | Loss=4.84808 | acc=0.0873 | tpr=0.9236 | fpr=0.9281 | 8266.0 samples/s | 32.3 steps/s
[Step= 200] | Loss=4.84683 | acc=0.0870 | tpr=0.9093 | fpr=0.9279 | 8254.4 samples/s | 32.2 steps/s
[Step= 250] | Loss=4.84681 | acc=0.0878 | tpr=0.9074 | fpr=0.9271 | 8254.3 samples/s | 32.2 steps/s
[Step= 300] | Loss=4.85194 | acc=0.0876 | tpr=0.9033 | fpr=0.9273 | 8671.9 samples/s | 33.9 steps/s
[Step= 350] | Loss=4.85210 | acc=0.0872 | tpr=0.9067 | fpr=0.9277 | 8133.4 samples/s | 31.8 steps/s
[Step= 400] | Loss=4.85401 | acc=0.0876 | tpr=0.9054 | fpr=0.9273 | 8317.3 samples/s | 32.5 steps/s
[Step= 450] | Loss=4.85711 | acc=0.0876 | tpr=0.9065 | fpr=0.9273 | 8297.8 samples/s | 32.4 steps/s
[Step= 500] | Loss=4.85853 | acc=0.0876 | tpr=0.9070 | fpr=0.9272 | 8349.5 samples/s | 32.6 steps/s
[Step= 550] | Loss=4.85737 | acc=0.0875 | tpr=0.9049 | fpr=0.9273 | 15377.0 samples/s | 60.1 steps/s
Avg test loss: 4.85801, Avg test acc: 0.08744, Avg tpr: 0.90531, Avg fpr: 0.92743, total FA: 128772

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08447 | acc=0.9830 | tpr=0.9115 | fpr=0.0157 | 4276.7 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.08839 | acc=0.9825 | tpr=0.9211 | fpr=0.0164 | 8168.0 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.09158 | acc=0.9818 | tpr=0.9294 | fpr=0.0172 | 8428.9 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.09210 | acc=0.9820 | tpr=0.9333 | fpr=0.0171 | 8414.3 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.09112 | acc=0.9820 | tpr=0.9310 | fpr=0.0170 | 8575.5 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.09232 | acc=0.9817 | tpr=0.9258 | fpr=0.0172 | 7794.4 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.09241 | acc=0.9817 | tpr=0.9286 | fpr=0.0173 | 8492.0 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.09283 | acc=0.9816 | tpr=0.9272 | fpr=0.0174 | 8439.5 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.09509 | acc=0.9813 | tpr=0.9255 | fpr=0.0177 | 8491.3 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.09494 | acc=0.9813 | tpr=0.9260 | fpr=0.0177 | 7991.4 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.09424 | acc=0.9815 | tpr=0.9240 | fpr=0.0175 | 14819.0 samples/s | 57.9 steps/s
Avg test loss: 0.09413, Avg test acc: 0.98149, Avg tpr: 0.92353, Avg fpr: 0.01746, total FA: 2424

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09745 | acc=0.9809 | tpr=0.9469 | fpr=0.0185 | 4211.4 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.10103 | acc=0.9806 | tpr=0.9446 | fpr=0.0187 | 8406.6 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.10591 | acc=0.9796 | tpr=0.9467 | fpr=0.0198 | 8276.1 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.10692 | acc=0.9795 | tpr=0.9475 | fpr=0.0199 | 8099.3 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.10537 | acc=0.9795 | tpr=0.9424 | fpr=0.0198 | 8396.3 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.10724 | acc=0.9792 | tpr=0.9404 | fpr=0.0201 | 8536.3 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.10825 | acc=0.9792 | tpr=0.9443 | fpr=0.0202 | 8238.4 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.10923 | acc=0.9790 | tpr=0.9447 | fpr=0.0204 | 8573.8 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.11111 | acc=0.9787 | tpr=0.9411 | fpr=0.0206 | 8167.7 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.11112 | acc=0.9787 | tpr=0.9427 | fpr=0.0207 | 8499.0 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.11037 | acc=0.9789 | tpr=0.9423 | fpr=0.0205 | 14451.0 samples/s | 56.4 steps/s
Avg test loss: 0.11024, Avg test acc: 0.97889, Avg tpr: 0.94216, Avg fpr: 0.02044, total FA: 2838

server round 7/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=8001 Epoch=15.6] | Loss=0.10280 | Reg=0.00209 | acc=0.9219 | L2-Norm=14.451 | L2-Norm(final)=7.363 | 3631.6 samples/s | 56.7 steps/s
[Step=8050 Epoch=15.7] | Loss=0.07666 | Reg=0.00209 | acc=0.9375 | L2-Norm=14.456 | L2-Norm(final)=7.414 | 5482.4 samples/s | 85.7 steps/s
[Step=8100 Epoch=15.8] | Loss=0.07522 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.458 | L2-Norm(final)=7.492 | 5763.6 samples/s | 90.1 steps/s
[Step=8150 Epoch=15.9] | Loss=0.07443 | Reg=0.00209 | acc=0.9062 | L2-Norm=14.458 | L2-Norm(final)=7.569 | 5887.1 samples/s | 92.0 steps/s
[Step=8200 Epoch=16.0] | Loss=0.07488 | Reg=0.00209 | acc=0.9219 | L2-Norm=14.458 | L2-Norm(final)=7.643 | 5733.4 samples/s | 89.6 steps/s
[Step=8250 Epoch=16.1] | Loss=0.07567 | Reg=0.00209 | acc=0.9062 | L2-Norm=14.458 | L2-Norm(final)=7.711 | 5911.5 samples/s | 92.4 steps/s
[Step=8300 Epoch=16.2] | Loss=0.07571 | Reg=0.00209 | acc=0.9375 | L2-Norm=14.458 | L2-Norm(final)=7.774 | 5454.3 samples/s | 85.2 steps/s
[Step=8350 Epoch=16.3] | Loss=0.07475 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.458 | L2-Norm(final)=7.833 | 5620.2 samples/s | 87.8 steps/s
[Step=8400 Epoch=16.4] | Loss=0.07316 | Reg=0.00209 | acc=0.9531 | L2-Norm=14.458 | L2-Norm(final)=7.891 | 5703.8 samples/s | 89.1 steps/s
[Step=8450 Epoch=16.5] | Loss=0.07260 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.458 | L2-Norm(final)=7.948 | 5816.4 samples/s | 90.9 steps/s
[Step=8500 Epoch=16.6] | Loss=0.07216 | Reg=0.00209 | acc=0.9375 | L2-Norm=14.458 | L2-Norm(final)=8.005 | 6766.2 samples/s | 105.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=16.6] | Loss=0.02993 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.459 | L2-Norm(final)=8.569 | 3614.9 samples/s | 56.5 steps/s
[Step=8550 Epoch=16.7] | Loss=0.06567 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.668 | L2-Norm(final)=8.575 | 5074.2 samples/s | 79.3 steps/s
[Step=8600 Epoch=16.8] | Loss=0.06349 | Reg=0.00221 | acc=0.9219 | L2-Norm=14.869 | L2-Norm(final)=8.551 | 5032.8 samples/s | 78.6 steps/s
[Step=8650 Epoch=16.9] | Loss=0.06296 | Reg=0.00225 | acc=0.9688 | L2-Norm=14.998 | L2-Norm(final)=8.534 | 5038.2 samples/s | 78.7 steps/s
[Step=8700 Epoch=17.0] | Loss=0.06206 | Reg=0.00228 | acc=0.9375 | L2-Norm=15.098 | L2-Norm(final)=8.516 | 5093.2 samples/s | 79.6 steps/s
[Step=8750 Epoch=17.1] | Loss=0.06250 | Reg=0.00230 | acc=0.9688 | L2-Norm=15.177 | L2-Norm(final)=8.501 | 5024.9 samples/s | 78.5 steps/s
[Step=8800 Epoch=17.2] | Loss=0.06065 | Reg=0.00232 | acc=0.9688 | L2-Norm=15.244 | L2-Norm(final)=8.488 | 5072.8 samples/s | 79.3 steps/s
[Step=8850 Epoch=17.3] | Loss=0.05980 | Reg=0.00234 | acc=0.9688 | L2-Norm=15.301 | L2-Norm(final)=8.477 | 5076.0 samples/s | 79.3 steps/s
[Step=8900 Epoch=17.4] | Loss=0.05837 | Reg=0.00236 | acc=0.9531 | L2-Norm=15.352 | L2-Norm(final)=8.468 | 5024.0 samples/s | 78.5 steps/s
[Step=8950 Epoch=17.5] | Loss=0.05714 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.400 | L2-Norm(final)=8.459 | 5060.0 samples/s | 79.1 steps/s
[Step=9000 Epoch=17.6] | Loss=0.05583 | Reg=0.00239 | acc=0.9688 | L2-Norm=15.446 | L2-Norm(final)=8.452 | 6165.4 samples/s | 96.3 steps/s
[Step=9050 Epoch=17.7] | Loss=0.05412 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.489 | L2-Norm(final)=8.445 | 1958.7 samples/s | 30.6 steps/s
[Step=9100 Epoch=17.7] | Loss=0.05267 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.529 | L2-Norm(final)=8.439 | 5083.5 samples/s | 79.4 steps/s
[Step=9150 Epoch=17.8] | Loss=0.05131 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.566 | L2-Norm(final)=8.434 | 5044.9 samples/s | 78.8 steps/s
[Step=9200 Epoch=17.9] | Loss=0.05033 | Reg=0.00244 | acc=0.9688 | L2-Norm=15.601 | L2-Norm(final)=8.429 | 5141.5 samples/s | 80.3 steps/s
[Step=9250 Epoch=18.0] | Loss=0.04940 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.634 | L2-Norm(final)=8.425 | 4899.5 samples/s | 76.6 steps/s
[Step=9300 Epoch=18.1] | Loss=0.04847 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.666 | L2-Norm(final)=8.421 | 4926.4 samples/s | 77.0 steps/s
[Step=9350 Epoch=18.2] | Loss=0.04789 | Reg=0.00247 | acc=0.9375 | L2-Norm=15.696 | L2-Norm(final)=8.417 | 4819.4 samples/s | 75.3 steps/s
[Step=9400 Epoch=18.3] | Loss=0.04717 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.724 | L2-Norm(final)=8.412 | 5001.5 samples/s | 78.1 steps/s
[Step=9450 Epoch=18.4] | Loss=0.04651 | Reg=0.00248 | acc=0.9688 | L2-Norm=15.752 | L2-Norm(final)=8.408 | 5012.6 samples/s | 78.3 steps/s
[Step=9500 Epoch=18.5] | Loss=0.04601 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.779 | L2-Norm(final)=8.404 | 5372.6 samples/s | 83.9 steps/s
[Step=9550 Epoch=18.6] | Loss=0.04515 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.805 | L2-Norm(final)=8.400 | 2025.0 samples/s | 31.6 steps/s
[Step=9600 Epoch=18.7] | Loss=0.04427 | Reg=0.00251 | acc=0.9844 | L2-Norm=15.831 | L2-Norm(final)=8.396 | 5089.9 samples/s | 79.5 steps/s
[Step=9650 Epoch=18.8] | Loss=0.04348 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.856 | L2-Norm(final)=8.393 | 4997.6 samples/s | 78.1 steps/s
[Step=9700 Epoch=18.9] | Loss=0.04283 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.880 | L2-Norm(final)=8.390 | 4976.8 samples/s | 77.8 steps/s
[Step=9750 Epoch=19.0] | Loss=0.04220 | Reg=0.00253 | acc=0.9531 | L2-Norm=15.903 | L2-Norm(final)=8.387 | 5081.2 samples/s | 79.4 steps/s
[Step=9800 Epoch=19.1] | Loss=0.04160 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.927 | L2-Norm(final)=8.384 | 5026.2 samples/s | 78.5 steps/s
[Step=9850 Epoch=19.2] | Loss=0.04098 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.950 | L2-Norm(final)=8.381 | 5054.8 samples/s | 79.0 steps/s
[Step=9900 Epoch=19.3] | Loss=0.04067 | Reg=0.00255 | acc=0.9844 | L2-Norm=15.972 | L2-Norm(final)=8.378 | 5063.9 samples/s | 79.1 steps/s
[Step=9950 Epoch=19.4] | Loss=0.04036 | Reg=0.00256 | acc=0.9844 | L2-Norm=15.994 | L2-Norm(final)=8.375 | 5066.4 samples/s | 79.2 steps/s
[Step=10000 Epoch=19.5] | Loss=0.03979 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.015 | L2-Norm(final)=8.372 | 5030.6 samples/s | 78.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step10000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=6001 Epoch=23.0] | Loss=0.01498 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.451 | L2-Norm(final)=7.014 | 3837.0 samples/s | 60.0 steps/s
[Step=6050 Epoch=23.2] | Loss=0.01630 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.442 | L2-Norm(final)=7.016 | 5138.6 samples/s | 80.3 steps/s
[Step=6100 Epoch=23.4] | Loss=0.01394 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.441 | L2-Norm(final)=7.041 | 5569.1 samples/s | 87.0 steps/s
[Step=6150 Epoch=23.6] | Loss=0.01266 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.440 | L2-Norm(final)=7.085 | 5467.4 samples/s | 85.4 steps/s
[Step=6200 Epoch=23.8] | Loss=0.01181 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.440 | L2-Norm(final)=7.132 | 5459.1 samples/s | 85.3 steps/s
[Step=6250 Epoch=23.9] | Loss=0.01140 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.440 | L2-Norm(final)=7.181 | 7169.7 samples/s | 112.0 steps/s
[Step=6300 Epoch=24.1] | Loss=0.01101 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.440 | L2-Norm(final)=7.230 | 1948.5 samples/s | 30.4 steps/s
[Step=6350 Epoch=24.3] | Loss=0.01073 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.440 | L2-Norm(final)=7.279 | 5422.2 samples/s | 84.7 steps/s
[Step=6400 Epoch=24.5] | Loss=0.01080 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.440 | L2-Norm(final)=7.326 | 5428.4 samples/s | 84.8 steps/s
[Step=6450 Epoch=24.7] | Loss=0.01042 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.440 | L2-Norm(final)=7.371 | 5471.5 samples/s | 85.5 steps/s
[Step=6500 Epoch=24.9] | Loss=0.01044 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.440 | L2-Norm(final)=7.417 | 6159.5 samples/s | 96.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=24.9] | Loss=0.00925 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.440 | L2-Norm(final)=7.858 | 3912.1 samples/s | 61.1 steps/s
[Step=6550 Epoch=25.1] | Loss=0.01793 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.662 | L2-Norm(final)=7.858 | 4529.0 samples/s | 70.8 steps/s
[Step=6600 Epoch=25.3] | Loss=0.01312 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.901 | L2-Norm(final)=7.826 | 4764.1 samples/s | 74.4 steps/s
[Step=6650 Epoch=25.5] | Loss=0.00976 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.002 | L2-Norm(final)=7.819 | 4754.6 samples/s | 74.3 steps/s
[Step=6700 Epoch=25.7] | Loss=0.00967 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.062 | L2-Norm(final)=7.811 | 4765.7 samples/s | 74.5 steps/s
[Step=6750 Epoch=25.9] | Loss=0.01000 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.117 | L2-Norm(final)=7.801 | 6019.1 samples/s | 94.0 steps/s
[Step=6800 Epoch=26.1] | Loss=0.00857 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.154 | L2-Norm(final)=7.792 | 1875.6 samples/s | 29.3 steps/s
[Step=6850 Epoch=26.2] | Loss=0.00747 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.175 | L2-Norm(final)=7.786 | 4783.9 samples/s | 74.7 steps/s
[Step=6900 Epoch=26.4] | Loss=0.00654 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.182 | L2-Norm(final)=7.783 | 4778.4 samples/s | 74.7 steps/s
[Step=6950 Epoch=26.6] | Loss=0.00584 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.179 | L2-Norm(final)=7.781 | 4863.7 samples/s | 76.0 steps/s
[Step=7000 Epoch=26.8] | Loss=0.00526 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.169 | L2-Norm(final)=7.779 | 5189.4 samples/s | 81.1 steps/s
[Step=7050 Epoch=27.0] | Loss=0.00480 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.154 | L2-Norm(final)=7.778 | 1986.1 samples/s | 31.0 steps/s
[Step=7100 Epoch=27.2] | Loss=0.00440 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.135 | L2-Norm(final)=7.777 | 4792.7 samples/s | 74.9 steps/s
[Step=7150 Epoch=27.4] | Loss=0.00407 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.114 | L2-Norm(final)=7.777 | 4755.5 samples/s | 74.3 steps/s
[Step=7200 Epoch=27.6] | Loss=0.00378 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.091 | L2-Norm(final)=7.777 | 4865.7 samples/s | 76.0 steps/s
[Step=7250 Epoch=27.8] | Loss=0.00352 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.066 | L2-Norm(final)=7.777 | 4745.5 samples/s | 74.1 steps/s
[Step=7300 Epoch=28.0] | Loss=0.00331 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.040 | L2-Norm(final)=7.777 | 2035.8 samples/s | 31.8 steps/s
[Step=7350 Epoch=28.2] | Loss=0.00311 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.013 | L2-Norm(final)=7.777 | 4814.5 samples/s | 75.2 steps/s
[Step=7400 Epoch=28.4] | Loss=0.00294 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.986 | L2-Norm(final)=7.777 | 4765.0 samples/s | 74.5 steps/s
[Step=7450 Epoch=28.5] | Loss=0.00278 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.958 | L2-Norm(final)=7.777 | 4830.8 samples/s | 75.5 steps/s
[Step=7500 Epoch=28.7] | Loss=0.00265 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.929 | L2-Norm(final)=7.777 | 4806.2 samples/s | 75.1 steps/s
[Step=7550 Epoch=28.9] | Loss=0.00252 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.900 | L2-Norm(final)=7.777 | 2043.0 samples/s | 31.9 steps/s
[Step=7600 Epoch=29.1] | Loss=0.00241 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.871 | L2-Norm(final)=7.777 | 4865.4 samples/s | 76.0 steps/s
[Step=7650 Epoch=29.3] | Loss=0.00230 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.842 | L2-Norm(final)=7.777 | 4837.1 samples/s | 75.6 steps/s
[Step=7700 Epoch=29.5] | Loss=0.00221 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.812 | L2-Norm(final)=7.777 | 4850.9 samples/s | 75.8 steps/s
[Step=7750 Epoch=29.7] | Loss=0.00212 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.782 | L2-Norm(final)=7.778 | 4864.9 samples/s | 76.0 steps/s
[Step=7800 Epoch=29.9] | Loss=0.00204 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.753 | L2-Norm(final)=7.778 | 6558.7 samples/s | 102.5 steps/s
[Step=7850 Epoch=30.1] | Loss=0.00196 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.723 | L2-Norm(final)=7.778 | 1852.5 samples/s | 28.9 steps/s
[Step=7900 Epoch=30.3] | Loss=0.00189 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.693 | L2-Norm(final)=7.778 | 4761.3 samples/s | 74.4 steps/s
[Step=7950 Epoch=30.5] | Loss=0.00183 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.663 | L2-Norm(final)=7.779 | 4774.6 samples/s | 74.6 steps/s
[Step=8000 Epoch=30.7] | Loss=0.00177 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.633 | L2-Norm(final)=7.779 | 4797.5 samples/s | 75.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07641 | acc=0.9541 | tpr=0.9560 | fpr=0.0500 | 4076.3 samples/s | 15.9 steps/s
Avg test loss: 0.07678, Avg test acc: 0.95324, Avg tpr: 0.95500, Avg fpr: 0.05063, total FA: 395

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07405 | acc=0.9565 | tpr=0.9760 | fpr=0.0860 | 4209.7 samples/s | 16.4 steps/s
Avg test loss: 0.07656, Avg test acc: 0.95549, Avg tpr: 0.97412, Avg fpr: 0.08550, total FA: 667

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.69723 | acc=0.3234 | tpr=0.0267 | fpr=0.0322 | 4251.4 samples/s | 16.6 steps/s
Avg test loss: 5.70328, Avg test acc: 0.32094, Avg tpr: 0.02669, Avg fpr: 0.03192, total FA: 249

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.75549 | acc=0.3180 | tpr=0.0274 | fpr=0.0510 | 4171.5 samples/s | 16.3 steps/s
Avg test loss: 5.77836, Avg test acc: 0.31549, Avg tpr: 0.02728, Avg fpr: 0.05063, total FA: 395

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.93314 | acc=0.1328 | tpr=0.8584 | fpr=0.8802 | 4237.3 samples/s | 16.6 steps/s
[Step= 100] | Loss=4.88160 | acc=0.1365 | tpr=0.8593 | fpr=0.8770 | 8392.6 samples/s | 32.8 steps/s
[Step= 150] | Loss=4.88818 | acc=0.1355 | tpr=0.8646 | fpr=0.8779 | 8248.3 samples/s | 32.2 steps/s
[Step= 200] | Loss=4.89323 | acc=0.1356 | tpr=0.8710 | fpr=0.8777 | 8321.7 samples/s | 32.5 steps/s
[Step= 250] | Loss=4.88634 | acc=0.1361 | tpr=0.8664 | fpr=0.8772 | 8276.8 samples/s | 32.3 steps/s
[Step= 300] | Loss=4.89002 | acc=0.1358 | tpr=0.8589 | fpr=0.8774 | 8304.7 samples/s | 32.4 steps/s
[Step= 350] | Loss=4.89052 | acc=0.1354 | tpr=0.8591 | fpr=0.8777 | 8237.6 samples/s | 32.2 steps/s
[Step= 400] | Loss=4.88920 | acc=0.1358 | tpr=0.8627 | fpr=0.8774 | 8423.4 samples/s | 32.9 steps/s
[Step= 450] | Loss=4.89248 | acc=0.1357 | tpr=0.8612 | fpr=0.8774 | 8390.5 samples/s | 32.8 steps/s
[Step= 500] | Loss=4.89301 | acc=0.1358 | tpr=0.8617 | fpr=0.8773 | 8389.6 samples/s | 32.8 steps/s
[Step= 550] | Loss=4.89358 | acc=0.1360 | tpr=0.8599 | fpr=0.8771 | 15441.5 samples/s | 60.3 steps/s
Avg test loss: 4.89454, Avg test acc: 0.13598, Avg tpr: 0.86014, Avg fpr: 0.87718, total FA: 121795

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.87115 | acc=0.0871 | tpr=0.9381 | fpr=0.9282 | 4195.7 samples/s | 16.4 steps/s
[Step= 100] | Loss=4.83336 | acc=0.0882 | tpr=0.9211 | fpr=0.9273 | 8526.5 samples/s | 33.3 steps/s
[Step= 150] | Loss=4.84808 | acc=0.0873 | tpr=0.9236 | fpr=0.9281 | 8260.0 samples/s | 32.3 steps/s
[Step= 200] | Loss=4.84683 | acc=0.0870 | tpr=0.9093 | fpr=0.9279 | 8203.0 samples/s | 32.0 steps/s
[Step= 250] | Loss=4.84681 | acc=0.0878 | tpr=0.9074 | fpr=0.9271 | 8295.5 samples/s | 32.4 steps/s
[Step= 300] | Loss=4.85194 | acc=0.0876 | tpr=0.9033 | fpr=0.9273 | 8239.3 samples/s | 32.2 steps/s
[Step= 350] | Loss=4.85210 | acc=0.0872 | tpr=0.9067 | fpr=0.9277 | 8405.4 samples/s | 32.8 steps/s
[Step= 400] | Loss=4.85401 | acc=0.0876 | tpr=0.9054 | fpr=0.9273 | 8399.2 samples/s | 32.8 steps/s
[Step= 450] | Loss=4.85711 | acc=0.0876 | tpr=0.9065 | fpr=0.9273 | 8259.5 samples/s | 32.3 steps/s
[Step= 500] | Loss=4.85853 | acc=0.0876 | tpr=0.9070 | fpr=0.9272 | 8307.2 samples/s | 32.4 steps/s
[Step= 550] | Loss=4.85737 | acc=0.0875 | tpr=0.9049 | fpr=0.9273 | 15601.9 samples/s | 60.9 steps/s
Avg test loss: 4.85801, Avg test acc: 0.08744, Avg tpr: 0.90531, Avg fpr: 0.92743, total FA: 128772

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10851 | acc=0.9823 | tpr=0.9469 | fpr=0.0170 | 4155.2 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.11479 | acc=0.9816 | tpr=0.9574 | fpr=0.0179 | 8283.0 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.11988 | acc=0.9808 | tpr=0.9568 | fpr=0.0188 | 8334.9 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.12258 | acc=0.9804 | tpr=0.9552 | fpr=0.0191 | 8442.0 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.12028 | acc=0.9804 | tpr=0.9493 | fpr=0.0191 | 8518.5 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.12213 | acc=0.9801 | tpr=0.9505 | fpr=0.0194 | 8046.6 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.12324 | acc=0.9798 | tpr=0.9505 | fpr=0.0197 | 8552.8 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.12434 | acc=0.9797 | tpr=0.9469 | fpr=0.0197 | 8142.2 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.12667 | acc=0.9794 | tpr=0.9460 | fpr=0.0200 | 9020.7 samples/s | 35.2 steps/s
[Step= 500] | Loss=0.12564 | acc=0.9795 | tpr=0.9467 | fpr=0.0199 | 7848.1 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.12475 | acc=0.9797 | tpr=0.9431 | fpr=0.0197 | 15134.2 samples/s | 59.1 steps/s
Avg test loss: 0.12449, Avg test acc: 0.97966, Avg tpr: 0.94295, Avg fpr: 0.01967, total FA: 2731

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09745 | acc=0.9809 | tpr=0.9469 | fpr=0.0185 | 4247.0 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.10103 | acc=0.9806 | tpr=0.9446 | fpr=0.0187 | 8138.6 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.10591 | acc=0.9796 | tpr=0.9467 | fpr=0.0198 | 8507.8 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.10692 | acc=0.9795 | tpr=0.9475 | fpr=0.0199 | 8496.8 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.10537 | acc=0.9795 | tpr=0.9424 | fpr=0.0198 | 8484.0 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.10724 | acc=0.9792 | tpr=0.9404 | fpr=0.0201 | 8245.7 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.10825 | acc=0.9792 | tpr=0.9443 | fpr=0.0202 | 8395.2 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.10923 | acc=0.9790 | tpr=0.9447 | fpr=0.0204 | 8203.7 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.11111 | acc=0.9787 | tpr=0.9411 | fpr=0.0206 | 8590.2 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.11112 | acc=0.9787 | tpr=0.9427 | fpr=0.0207 | 7999.0 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.11037 | acc=0.9789 | tpr=0.9423 | fpr=0.0205 | 15607.2 samples/s | 61.0 steps/s
Avg test loss: 0.11024, Avg test acc: 0.97889, Avg tpr: 0.94216, Avg fpr: 0.02044, total FA: 2838

server round 8/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=19.6] | Loss=0.09765 | Reg=0.00204 | acc=0.8906 | L2-Norm=14.268 | L2-Norm(final)=7.823 | 3809.9 samples/s | 59.5 steps/s
[Step=10050 Epoch=19.6] | Loss=0.09711 | Reg=0.00204 | acc=0.9375 | L2-Norm=14.274 | L2-Norm(final)=7.828 | 5474.8 samples/s | 85.5 steps/s
[Step=10100 Epoch=19.7] | Loss=0.09254 | Reg=0.00204 | acc=0.9219 | L2-Norm=14.275 | L2-Norm(final)=7.848 | 5756.9 samples/s | 90.0 steps/s
[Step=10150 Epoch=19.8] | Loss=0.09102 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.276 | L2-Norm(final)=7.876 | 5956.0 samples/s | 93.1 steps/s
[Step=10200 Epoch=19.9] | Loss=0.08765 | Reg=0.00204 | acc=0.9219 | L2-Norm=14.276 | L2-Norm(final)=7.910 | 5733.0 samples/s | 89.6 steps/s
[Step=10250 Epoch=20.0] | Loss=0.08833 | Reg=0.00204 | acc=0.9531 | L2-Norm=14.276 | L2-Norm(final)=7.949 | 5838.4 samples/s | 91.2 steps/s
[Step=10300 Epoch=20.1] | Loss=0.08848 | Reg=0.00204 | acc=0.9375 | L2-Norm=14.276 | L2-Norm(final)=7.986 | 5770.0 samples/s | 90.2 steps/s
[Step=10350 Epoch=20.2] | Loss=0.08733 | Reg=0.00204 | acc=0.9219 | L2-Norm=14.276 | L2-Norm(final)=8.022 | 5760.4 samples/s | 90.0 steps/s
[Step=10400 Epoch=20.3] | Loss=0.08689 | Reg=0.00204 | acc=0.9531 | L2-Norm=14.276 | L2-Norm(final)=8.061 | 5819.1 samples/s | 90.9 steps/s
[Step=10450 Epoch=20.4] | Loss=0.08661 | Reg=0.00204 | acc=0.9219 | L2-Norm=14.276 | L2-Norm(final)=8.100 | 5820.2 samples/s | 90.9 steps/s
[Step=10500 Epoch=20.5] | Loss=0.08734 | Reg=0.00204 | acc=0.9375 | L2-Norm=14.276 | L2-Norm(final)=8.138 | 7510.6 samples/s | 117.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=20.5] | Loss=0.05539 | Reg=0.00204 | acc=0.9375 | L2-Norm=14.276 | L2-Norm(final)=8.491 | 3858.9 samples/s | 60.3 steps/s
[Step=10550 Epoch=20.6] | Loss=0.06907 | Reg=0.00211 | acc=0.9375 | L2-Norm=14.514 | L2-Norm(final)=8.475 | 4882.9 samples/s | 76.3 steps/s
[Step=10600 Epoch=20.7] | Loss=0.05986 | Reg=0.00215 | acc=0.9375 | L2-Norm=14.663 | L2-Norm(final)=8.461 | 5006.7 samples/s | 78.2 steps/s
[Step=10650 Epoch=20.8] | Loss=0.05938 | Reg=0.00218 | acc=0.9219 | L2-Norm=14.765 | L2-Norm(final)=8.450 | 5058.0 samples/s | 79.0 steps/s
[Step=10700 Epoch=20.9] | Loss=0.05617 | Reg=0.00220 | acc=0.9375 | L2-Norm=14.844 | L2-Norm(final)=8.441 | 5045.0 samples/s | 78.8 steps/s
[Step=10750 Epoch=21.0] | Loss=0.05664 | Reg=0.00223 | acc=0.9375 | L2-Norm=14.915 | L2-Norm(final)=8.431 | 5036.8 samples/s | 78.7 steps/s
[Step=10800 Epoch=21.1] | Loss=0.05523 | Reg=0.00224 | acc=0.9531 | L2-Norm=14.978 | L2-Norm(final)=8.424 | 5078.9 samples/s | 79.4 steps/s
[Step=10850 Epoch=21.2] | Loss=0.05406 | Reg=0.00226 | acc=0.9531 | L2-Norm=15.037 | L2-Norm(final)=8.418 | 4980.1 samples/s | 77.8 steps/s
[Step=10900 Epoch=21.3] | Loss=0.05260 | Reg=0.00228 | acc=0.9531 | L2-Norm=15.092 | L2-Norm(final)=8.412 | 5017.4 samples/s | 78.4 steps/s
[Step=10950 Epoch=21.4] | Loss=0.05177 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.140 | L2-Norm(final)=8.407 | 5081.6 samples/s | 79.4 steps/s
[Step=11000 Epoch=21.5] | Loss=0.05082 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.185 | L2-Norm(final)=8.401 | 6210.6 samples/s | 97.0 steps/s
[Step=11050 Epoch=21.6] | Loss=0.04886 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.227 | L2-Norm(final)=8.396 | 1951.3 samples/s | 30.5 steps/s
[Step=11100 Epoch=21.7] | Loss=0.04771 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.265 | L2-Norm(final)=8.392 | 5018.5 samples/s | 78.4 steps/s
[Step=11150 Epoch=21.8] | Loss=0.04665 | Reg=0.00234 | acc=0.9219 | L2-Norm=15.301 | L2-Norm(final)=8.388 | 4707.3 samples/s | 73.6 steps/s
[Step=11200 Epoch=21.9] | Loss=0.04608 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.336 | L2-Norm(final)=8.384 | 4871.0 samples/s | 76.1 steps/s
[Step=11250 Epoch=22.0] | Loss=0.04495 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.369 | L2-Norm(final)=8.379 | 4865.3 samples/s | 76.0 steps/s
[Step=11300 Epoch=22.1] | Loss=0.04432 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.401 | L2-Norm(final)=8.375 | 4795.5 samples/s | 74.9 steps/s
[Step=11350 Epoch=22.2] | Loss=0.04369 | Reg=0.00238 | acc=0.9688 | L2-Norm=15.431 | L2-Norm(final)=8.371 | 4811.3 samples/s | 75.2 steps/s
[Step=11400 Epoch=22.3] | Loss=0.04321 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.461 | L2-Norm(final)=8.367 | 4669.3 samples/s | 73.0 steps/s
[Step=11450 Epoch=22.4] | Loss=0.04281 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.489 | L2-Norm(final)=8.363 | 4851.4 samples/s | 75.8 steps/s
[Step=11500 Epoch=22.5] | Loss=0.04220 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.518 | L2-Norm(final)=8.360 | 5217.8 samples/s | 81.5 steps/s
[Step=11550 Epoch=22.6] | Loss=0.04149 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.546 | L2-Norm(final)=8.356 | 1980.2 samples/s | 30.9 steps/s
[Step=11600 Epoch=22.7] | Loss=0.04077 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.574 | L2-Norm(final)=8.353 | 5059.6 samples/s | 79.1 steps/s
[Step=11650 Epoch=22.8] | Loss=0.04019 | Reg=0.00244 | acc=0.9688 | L2-Norm=15.600 | L2-Norm(final)=8.350 | 5025.5 samples/s | 78.5 steps/s
[Step=11700 Epoch=22.9] | Loss=0.03987 | Reg=0.00244 | acc=0.9688 | L2-Norm=15.627 | L2-Norm(final)=8.346 | 5097.9 samples/s | 79.7 steps/s
[Step=11750 Epoch=23.0] | Loss=0.03961 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.652 | L2-Norm(final)=8.342 | 5008.1 samples/s | 78.3 steps/s
[Step=11800 Epoch=23.1] | Loss=0.03911 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.677 | L2-Norm(final)=8.338 | 5054.8 samples/s | 79.0 steps/s
[Step=11850 Epoch=23.2] | Loss=0.03872 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.701 | L2-Norm(final)=8.335 | 5075.1 samples/s | 79.3 steps/s
[Step=11900 Epoch=23.3] | Loss=0.03817 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.725 | L2-Norm(final)=8.331 | 5051.9 samples/s | 78.9 steps/s
[Step=11950 Epoch=23.4] | Loss=0.03788 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.748 | L2-Norm(final)=8.328 | 5070.5 samples/s | 79.2 steps/s
[Step=12000 Epoch=23.5] | Loss=0.03762 | Reg=0.00249 | acc=0.9844 | L2-Norm=15.772 | L2-Norm(final)=8.324 | 5056.7 samples/s | 79.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step12000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=4001 Epoch=15.4] | Loss=0.03074 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.268 | L2-Norm(final)=6.658 | 3910.0 samples/s | 61.1 steps/s
[Step=4050 Epoch=15.6] | Loss=0.01997 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.260 | L2-Norm(final)=6.700 | 4913.8 samples/s | 76.8 steps/s
[Step=4100 Epoch=15.8] | Loss=0.01747 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.259 | L2-Norm(final)=6.765 | 5512.5 samples/s | 86.1 steps/s
[Step=4150 Epoch=16.0] | Loss=0.01610 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.259 | L2-Norm(final)=6.846 | 5571.2 samples/s | 87.1 steps/s
[Step=4200 Epoch=16.2] | Loss=0.01503 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.259 | L2-Norm(final)=6.930 | 5374.7 samples/s | 84.0 steps/s
[Step=4250 Epoch=16.4] | Loss=0.01434 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.259 | L2-Norm(final)=7.011 | 7325.6 samples/s | 114.5 steps/s
[Step=4300 Epoch=16.6] | Loss=0.01393 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.259 | L2-Norm(final)=7.088 | 1963.4 samples/s | 30.7 steps/s
[Step=4350 Epoch=16.7] | Loss=0.01347 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.259 | L2-Norm(final)=7.162 | 5388.2 samples/s | 84.2 steps/s
[Step=4400 Epoch=16.9] | Loss=0.01311 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.258 | L2-Norm(final)=7.235 | 5543.7 samples/s | 86.6 steps/s
[Step=4450 Epoch=17.1] | Loss=0.01285 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.258 | L2-Norm(final)=7.304 | 5370.6 samples/s | 83.9 steps/s
[Step=4500 Epoch=17.3] | Loss=0.01263 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.258 | L2-Norm(final)=7.369 | 6379.1 samples/s | 99.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=17.3] | Loss=0.02960 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.258 | L2-Norm(final)=8.016 | 4014.4 samples/s | 62.7 steps/s
[Step=4550 Epoch=17.5] | Loss=0.02125 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.482 | L2-Norm(final)=8.022 | 4366.8 samples/s | 68.2 steps/s
[Step=4600 Epoch=17.7] | Loss=0.01674 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.754 | L2-Norm(final)=7.995 | 4767.1 samples/s | 74.5 steps/s
[Step=4650 Epoch=17.9] | Loss=0.01367 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.903 | L2-Norm(final)=7.978 | 4758.6 samples/s | 74.4 steps/s
[Step=4700 Epoch=18.1] | Loss=0.01170 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.979 | L2-Norm(final)=7.966 | 4788.9 samples/s | 74.8 steps/s
[Step=4750 Epoch=18.3] | Loss=0.01086 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.028 | L2-Norm(final)=7.953 | 6004.6 samples/s | 93.8 steps/s
[Step=4800 Epoch=18.5] | Loss=0.00943 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.068 | L2-Norm(final)=7.945 | 1880.4 samples/s | 29.4 steps/s
[Step=4850 Epoch=18.7] | Loss=0.00846 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.093 | L2-Norm(final)=7.941 | 4781.8 samples/s | 74.7 steps/s
[Step=4900 Epoch=18.9] | Loss=0.00755 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.108 | L2-Norm(final)=7.938 | 4782.1 samples/s | 74.7 steps/s
[Step=4950 Epoch=19.1] | Loss=0.00675 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.114 | L2-Norm(final)=7.937 | 4762.8 samples/s | 74.4 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00608 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.114 | L2-Norm(final)=7.936 | 5437.6 samples/s | 85.0 steps/s
[Step=5050 Epoch=19.4] | Loss=0.00554 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.109 | L2-Norm(final)=7.936 | 1930.0 samples/s | 30.2 steps/s
[Step=5100 Epoch=19.6] | Loss=0.00508 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.099 | L2-Norm(final)=7.936 | 4703.5 samples/s | 73.5 steps/s
[Step=5150 Epoch=19.8] | Loss=0.00469 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.086 | L2-Norm(final)=7.936 | 4783.8 samples/s | 74.7 steps/s
[Step=5200 Epoch=20.0] | Loss=0.00435 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.071 | L2-Norm(final)=7.936 | 4720.7 samples/s | 73.8 steps/s
[Step=5250 Epoch=20.2] | Loss=0.00406 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.054 | L2-Norm(final)=7.936 | 4879.0 samples/s | 76.2 steps/s
[Step=5300 Epoch=20.4] | Loss=0.00381 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.035 | L2-Norm(final)=7.936 | 2029.2 samples/s | 31.7 steps/s
[Step=5350 Epoch=20.6] | Loss=0.00359 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.015 | L2-Norm(final)=7.936 | 4857.7 samples/s | 75.9 steps/s
[Step=5400 Epoch=20.8] | Loss=0.00339 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.994 | L2-Norm(final)=7.936 | 4789.2 samples/s | 74.8 steps/s
[Step=5450 Epoch=21.0] | Loss=0.00321 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.972 | L2-Norm(final)=7.937 | 4870.8 samples/s | 76.1 steps/s
[Step=5500 Epoch=21.2] | Loss=0.00305 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.949 | L2-Norm(final)=7.937 | 4906.9 samples/s | 76.7 steps/s
[Step=5550 Epoch=21.4] | Loss=0.00291 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.926 | L2-Norm(final)=7.937 | 2040.1 samples/s | 31.9 steps/s
[Step=5600 Epoch=21.6] | Loss=0.00277 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.903 | L2-Norm(final)=7.938 | 4737.5 samples/s | 74.0 steps/s
[Step=5650 Epoch=21.7] | Loss=0.00265 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.879 | L2-Norm(final)=7.938 | 4818.4 samples/s | 75.3 steps/s
[Step=5700 Epoch=21.9] | Loss=0.00254 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.854 | L2-Norm(final)=7.938 | 4833.8 samples/s | 75.5 steps/s
[Step=5750 Epoch=22.1] | Loss=0.00244 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.830 | L2-Norm(final)=7.939 | 4868.6 samples/s | 76.1 steps/s
[Step=5800 Epoch=22.3] | Loss=0.00235 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.805 | L2-Norm(final)=7.939 | 6875.3 samples/s | 107.4 steps/s
[Step=5850 Epoch=22.5] | Loss=0.00226 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.780 | L2-Norm(final)=7.939 | 1797.8 samples/s | 28.1 steps/s
[Step=5900 Epoch=22.7] | Loss=0.00218 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.754 | L2-Norm(final)=7.940 | 4806.0 samples/s | 75.1 steps/s
[Step=5950 Epoch=22.9] | Loss=0.00211 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.729 | L2-Norm(final)=7.940 | 4764.8 samples/s | 74.4 steps/s
[Step=6000 Epoch=23.1] | Loss=0.00204 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.703 | L2-Norm(final)=7.940 | 4791.1 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_1/client_state-step6000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07641 | acc=0.9541 | tpr=0.9560 | fpr=0.0500 | 4220.0 samples/s | 16.5 steps/s
Avg test loss: 0.07678, Avg test acc: 0.95324, Avg tpr: 0.95500, Avg fpr: 0.05063, total FA: 395

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07088 | acc=0.9524 | tpr=0.9574 | fpr=0.0585 | 4177.1 samples/s | 16.3 steps/s
Avg test loss: 0.07274, Avg test acc: 0.95260, Avg tpr: 0.95786, Avg fpr: 0.05897, total FA: 460

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.69723 | acc=0.3234 | tpr=0.0267 | fpr=0.0322 | 4217.8 samples/s | 16.5 steps/s
Avg test loss: 5.70328, Avg test acc: 0.32094, Avg tpr: 0.02669, Avg fpr: 0.03192, total FA: 249

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.02842 | acc=0.3164 | tpr=0.0149 | fpr=0.0290 | 4213.9 samples/s | 16.5 steps/s
Avg test loss: 5.05223, Avg test acc: 0.31289, Avg tpr: 0.01451, Avg fpr: 0.03089, total FA: 241

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.93314 | acc=0.1328 | tpr=0.8584 | fpr=0.8802 | 4217.3 samples/s | 16.5 steps/s
[Step= 100] | Loss=4.88160 | acc=0.1365 | tpr=0.8593 | fpr=0.8770 | 8422.5 samples/s | 32.9 steps/s
[Step= 150] | Loss=4.88818 | acc=0.1355 | tpr=0.8646 | fpr=0.8779 | 8436.9 samples/s | 33.0 steps/s
[Step= 200] | Loss=4.89323 | acc=0.1356 | tpr=0.8710 | fpr=0.8777 | 8408.5 samples/s | 32.8 steps/s
[Step= 250] | Loss=4.88634 | acc=0.1361 | tpr=0.8664 | fpr=0.8772 | 8282.5 samples/s | 32.4 steps/s
[Step= 300] | Loss=4.89002 | acc=0.1358 | tpr=0.8589 | fpr=0.8774 | 8352.2 samples/s | 32.6 steps/s
[Step= 350] | Loss=4.89052 | acc=0.1354 | tpr=0.8591 | fpr=0.8777 | 8385.3 samples/s | 32.8 steps/s
[Step= 400] | Loss=4.88920 | acc=0.1358 | tpr=0.8627 | fpr=0.8774 | 8372.4 samples/s | 32.7 steps/s
[Step= 450] | Loss=4.89248 | acc=0.1357 | tpr=0.8612 | fpr=0.8774 | 8071.5 samples/s | 31.5 steps/s
[Step= 500] | Loss=4.89301 | acc=0.1358 | tpr=0.8617 | fpr=0.8773 | 8248.7 samples/s | 32.2 steps/s
[Step= 550] | Loss=4.89358 | acc=0.1360 | tpr=0.8599 | fpr=0.8771 | 15517.1 samples/s | 60.6 steps/s
Avg test loss: 4.89454, Avg test acc: 0.13598, Avg tpr: 0.86014, Avg fpr: 0.87718, total FA: 121795

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.56637 | acc=0.1220 | tpr=0.8938 | fpr=0.8919 | 4214.6 samples/s | 16.5 steps/s
[Step= 100] | Loss=3.53562 | acc=0.1267 | tpr=0.8849 | fpr=0.8875 | 8164.7 samples/s | 31.9 steps/s
[Step= 150] | Loss=3.54553 | acc=0.1262 | tpr=0.8689 | fpr=0.8875 | 8335.8 samples/s | 32.6 steps/s
[Step= 200] | Loss=3.54373 | acc=0.1259 | tpr=0.8699 | fpr=0.8876 | 8420.5 samples/s | 32.9 steps/s
[Step= 250] | Loss=3.54256 | acc=0.1261 | tpr=0.8734 | fpr=0.8876 | 8375.7 samples/s | 32.7 steps/s
[Step= 300] | Loss=3.54034 | acc=0.1264 | tpr=0.8764 | fpr=0.8873 | 8176.8 samples/s | 31.9 steps/s
[Step= 350] | Loss=3.54019 | acc=0.1252 | tpr=0.8704 | fpr=0.8883 | 8480.4 samples/s | 33.1 steps/s
[Step= 400] | Loss=3.53966 | acc=0.1253 | tpr=0.8698 | fpr=0.8883 | 8291.4 samples/s | 32.4 steps/s
[Step= 450] | Loss=3.53986 | acc=0.1252 | tpr=0.8705 | fpr=0.8884 | 7984.4 samples/s | 31.2 steps/s
[Step= 500] | Loss=3.54109 | acc=0.1250 | tpr=0.8736 | fpr=0.8885 | 8081.0 samples/s | 31.6 steps/s
[Step= 550] | Loss=3.54079 | acc=0.1251 | tpr=0.8723 | fpr=0.8884 | 15751.6 samples/s | 61.5 steps/s
Avg test loss: 3.54143, Avg test acc: 0.12511, Avg tpr: 0.87282, Avg fpr: 0.88848, total FA: 123364

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10851 | acc=0.9823 | tpr=0.9469 | fpr=0.0170 | 4136.5 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.11479 | acc=0.9816 | tpr=0.9574 | fpr=0.0179 | 8322.0 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.11988 | acc=0.9808 | tpr=0.9568 | fpr=0.0188 | 8811.0 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.12258 | acc=0.9804 | tpr=0.9552 | fpr=0.0191 | 8385.3 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.12028 | acc=0.9804 | tpr=0.9493 | fpr=0.0191 | 8075.8 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.12213 | acc=0.9801 | tpr=0.9505 | fpr=0.0194 | 8263.4 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.12324 | acc=0.9798 | tpr=0.9505 | fpr=0.0197 | 8250.4 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.12434 | acc=0.9797 | tpr=0.9469 | fpr=0.0197 | 8280.1 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.12667 | acc=0.9794 | tpr=0.9460 | fpr=0.0200 | 8440.0 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.12564 | acc=0.9795 | tpr=0.9467 | fpr=0.0199 | 7916.4 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.12475 | acc=0.9797 | tpr=0.9431 | fpr=0.0197 | 15672.9 samples/s | 61.2 steps/s
Avg test loss: 0.12449, Avg test acc: 0.97966, Avg tpr: 0.94295, Avg fpr: 0.01967, total FA: 2731

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11936 | acc=0.9773 | tpr=0.9204 | fpr=0.0217 | 4170.1 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.12068 | acc=0.9771 | tpr=0.9339 | fpr=0.0221 | 8424.9 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.12506 | acc=0.9761 | tpr=0.9380 | fpr=0.0232 | 8551.1 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.12483 | acc=0.9762 | tpr=0.9464 | fpr=0.0232 | 8144.5 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.12318 | acc=0.9761 | tpr=0.9406 | fpr=0.0232 | 8171.2 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.12478 | acc=0.9760 | tpr=0.9425 | fpr=0.0234 | 8717.0 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.12445 | acc=0.9761 | tpr=0.9449 | fpr=0.0233 | 7928.9 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.12545 | acc=0.9760 | tpr=0.9409 | fpr=0.0233 | 8317.7 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.12775 | acc=0.9757 | tpr=0.9362 | fpr=0.0236 | 8366.7 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.12785 | acc=0.9758 | tpr=0.9366 | fpr=0.0235 | 8345.4 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.12665 | acc=0.9761 | tpr=0.9359 | fpr=0.0232 | 15097.7 samples/s | 59.0 steps/s
Avg test loss: 0.12649, Avg test acc: 0.97613, Avg tpr: 0.93582, Avg fpr: 0.02313, total FA: 3212

server round 9/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=10001 Epoch=19.5] | Loss=0.07610 | Reg=0.00201 | acc=0.9531 | L2-Norm=14.165 | L2-Norm(final)=8.288 | 3680.5 samples/s | 57.5 steps/s
[Step=10050 Epoch=19.6] | Loss=0.10093 | Reg=0.00201 | acc=0.9219 | L2-Norm=14.168 | L2-Norm(final)=8.296 | 5526.7 samples/s | 86.4 steps/s
[Step=10100 Epoch=19.7] | Loss=0.09753 | Reg=0.00201 | acc=0.9219 | L2-Norm=14.169 | L2-Norm(final)=8.311 | 5730.0 samples/s | 89.5 steps/s
[Step=10150 Epoch=19.8] | Loss=0.09582 | Reg=0.00201 | acc=0.9062 | L2-Norm=14.169 | L2-Norm(final)=8.325 | 5825.6 samples/s | 91.0 steps/s
[Step=10200 Epoch=19.9] | Loss=0.09470 | Reg=0.00201 | acc=0.9219 | L2-Norm=14.170 | L2-Norm(final)=8.343 | 5860.2 samples/s | 91.6 steps/s
[Step=10250 Epoch=20.0] | Loss=0.09292 | Reg=0.00201 | acc=0.9062 | L2-Norm=14.170 | L2-Norm(final)=8.367 | 5901.6 samples/s | 92.2 steps/s
[Step=10300 Epoch=20.1] | Loss=0.09292 | Reg=0.00201 | acc=0.9375 | L2-Norm=14.170 | L2-Norm(final)=8.395 | 5742.2 samples/s | 89.7 steps/s
[Step=10350 Epoch=20.2] | Loss=0.09139 | Reg=0.00201 | acc=0.9219 | L2-Norm=14.170 | L2-Norm(final)=8.422 | 5708.6 samples/s | 89.2 steps/s
[Step=10400 Epoch=20.3] | Loss=0.09102 | Reg=0.00201 | acc=0.9531 | L2-Norm=14.170 | L2-Norm(final)=8.451 | 5767.4 samples/s | 90.1 steps/s
[Step=10450 Epoch=20.4] | Loss=0.09090 | Reg=0.00201 | acc=0.9062 | L2-Norm=14.170 | L2-Norm(final)=8.478 | 5789.6 samples/s | 90.5 steps/s
[Step=10500 Epoch=20.5] | Loss=0.09045 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.170 | L2-Norm(final)=8.506 | 7436.8 samples/s | 116.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=20.5] | Loss=0.07963 | Reg=0.00201 | acc=0.9531 | L2-Norm=14.170 | L2-Norm(final)=8.777 | 3769.8 samples/s | 58.9 steps/s
[Step=10550 Epoch=20.6] | Loss=0.06852 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.414 | L2-Norm(final)=8.776 | 4651.5 samples/s | 72.7 steps/s
[Step=10600 Epoch=20.7] | Loss=0.06536 | Reg=0.00214 | acc=0.9062 | L2-Norm=14.612 | L2-Norm(final)=8.756 | 5050.8 samples/s | 78.9 steps/s
[Step=10650 Epoch=20.8] | Loss=0.05916 | Reg=0.00217 | acc=0.9531 | L2-Norm=14.732 | L2-Norm(final)=8.744 | 5029.1 samples/s | 78.6 steps/s
[Step=10700 Epoch=20.9] | Loss=0.05800 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.827 | L2-Norm(final)=8.735 | 5043.9 samples/s | 78.8 steps/s
[Step=10750 Epoch=21.0] | Loss=0.05752 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.916 | L2-Norm(final)=8.726 | 5038.6 samples/s | 78.7 steps/s
[Step=10800 Epoch=21.1] | Loss=0.05554 | Reg=0.00225 | acc=0.9688 | L2-Norm=14.991 | L2-Norm(final)=8.716 | 5084.7 samples/s | 79.4 steps/s
[Step=10850 Epoch=21.2] | Loss=0.05444 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.056 | L2-Norm(final)=8.707 | 5060.8 samples/s | 79.1 steps/s
[Step=10900 Epoch=21.3] | Loss=0.05358 | Reg=0.00229 | acc=0.9062 | L2-Norm=15.115 | L2-Norm(final)=8.699 | 5087.8 samples/s | 79.5 steps/s
[Step=10950 Epoch=21.4] | Loss=0.05250 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.170 | L2-Norm(final)=8.690 | 5049.4 samples/s | 78.9 steps/s
[Step=11000 Epoch=21.5] | Loss=0.05141 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.221 | L2-Norm(final)=8.683 | 6114.3 samples/s | 95.5 steps/s
[Step=11050 Epoch=21.6] | Loss=0.04934 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.268 | L2-Norm(final)=8.676 | 1905.8 samples/s | 29.8 steps/s
[Step=11100 Epoch=21.6] | Loss=0.04762 | Reg=0.00235 | acc=0.9531 | L2-Norm=15.312 | L2-Norm(final)=8.671 | 5055.3 samples/s | 79.0 steps/s
[Step=11150 Epoch=21.7] | Loss=0.04672 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.351 | L2-Norm(final)=8.666 | 5007.9 samples/s | 78.2 steps/s
[Step=11200 Epoch=21.8] | Loss=0.04549 | Reg=0.00237 | acc=0.9688 | L2-Norm=15.388 | L2-Norm(final)=8.661 | 5070.7 samples/s | 79.2 steps/s
[Step=11250 Epoch=21.9] | Loss=0.04494 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.423 | L2-Norm(final)=8.656 | 4938.2 samples/s | 77.2 steps/s
[Step=11300 Epoch=22.0] | Loss=0.04459 | Reg=0.00239 | acc=0.9688 | L2-Norm=15.458 | L2-Norm(final)=8.650 | 5094.4 samples/s | 79.6 steps/s
[Step=11350 Epoch=22.1] | Loss=0.04397 | Reg=0.00240 | acc=0.9219 | L2-Norm=15.490 | L2-Norm(final)=8.644 | 5096.9 samples/s | 79.6 steps/s
[Step=11400 Epoch=22.2] | Loss=0.04316 | Reg=0.00241 | acc=0.9688 | L2-Norm=15.523 | L2-Norm(final)=8.639 | 4975.6 samples/s | 77.7 steps/s
[Step=11450 Epoch=22.3] | Loss=0.04232 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.555 | L2-Norm(final)=8.634 | 5011.1 samples/s | 78.3 steps/s
[Step=11500 Epoch=22.4] | Loss=0.04192 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.585 | L2-Norm(final)=8.629 | 5278.7 samples/s | 82.5 steps/s
[Step=11550 Epoch=22.5] | Loss=0.04126 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.615 | L2-Norm(final)=8.624 | 2014.2 samples/s | 31.5 steps/s
[Step=11600 Epoch=22.6] | Loss=0.04038 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.643 | L2-Norm(final)=8.620 | 5056.0 samples/s | 79.0 steps/s
[Step=11650 Epoch=22.7] | Loss=0.03966 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.669 | L2-Norm(final)=8.616 | 5034.7 samples/s | 78.7 steps/s
[Step=11700 Epoch=22.8] | Loss=0.03904 | Reg=0.00247 | acc=0.9375 | L2-Norm=15.695 | L2-Norm(final)=8.612 | 5002.0 samples/s | 78.2 steps/s
[Step=11750 Epoch=22.9] | Loss=0.03867 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.720 | L2-Norm(final)=8.608 | 5000.1 samples/s | 78.1 steps/s
[Step=11800 Epoch=23.0] | Loss=0.03827 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.744 | L2-Norm(final)=8.605 | 5031.4 samples/s | 78.6 steps/s
[Step=11850 Epoch=23.1] | Loss=0.03775 | Reg=0.00249 | acc=0.9844 | L2-Norm=15.769 | L2-Norm(final)=8.602 | 5041.0 samples/s | 78.8 steps/s
[Step=11900 Epoch=23.2] | Loss=0.03731 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.794 | L2-Norm(final)=8.598 | 5065.0 samples/s | 79.1 steps/s
[Step=11950 Epoch=23.3] | Loss=0.03689 | Reg=0.00250 | acc=0.9531 | L2-Norm=15.818 | L2-Norm(final)=8.596 | 5066.0 samples/s | 79.2 steps/s
[Step=12000 Epoch=23.4] | Loss=0.03654 | Reg=0.00251 | acc=0.9531 | L2-Norm=15.843 | L2-Norm(final)=8.592 | 5061.9 samples/s | 79.1 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step12000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00100, len=1
[Step=12001 Epoch=23.5] | Loss=0.13736 | Reg=0.00201 | acc=0.8750 | L2-Norm=14.165 | L2-Norm(final)=8.209 | 3871.1 samples/s | 60.5 steps/s
[Step=12050 Epoch=23.6] | Loss=0.09341 | Reg=0.00201 | acc=0.9062 | L2-Norm=14.175 | L2-Norm(final)=8.243 | 5405.0 samples/s | 84.5 steps/s
[Step=12100 Epoch=23.7] | Loss=0.09315 | Reg=0.00201 | acc=0.8594 | L2-Norm=14.176 | L2-Norm(final)=8.317 | 5891.0 samples/s | 92.0 steps/s
[Step=12150 Epoch=23.8] | Loss=0.09204 | Reg=0.00201 | acc=0.8750 | L2-Norm=14.177 | L2-Norm(final)=8.388 | 5742.6 samples/s | 89.7 steps/s
[Step=12200 Epoch=23.9] | Loss=0.08949 | Reg=0.00201 | acc=0.9375 | L2-Norm=14.177 | L2-Norm(final)=8.462 | 5907.0 samples/s | 92.3 steps/s
[Step=12250 Epoch=23.9] | Loss=0.08836 | Reg=0.00201 | acc=0.9062 | L2-Norm=14.177 | L2-Norm(final)=8.535 | 5964.2 samples/s | 93.2 steps/s
[Step=12300 Epoch=24.0] | Loss=0.08762 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.177 | L2-Norm(final)=8.605 | 5763.5 samples/s | 90.1 steps/s
[Step=12350 Epoch=24.1] | Loss=0.08807 | Reg=0.00201 | acc=0.8906 | L2-Norm=14.177 | L2-Norm(final)=8.669 | 5807.9 samples/s | 90.7 steps/s
[Step=12400 Epoch=24.2] | Loss=0.08733 | Reg=0.00201 | acc=0.9219 | L2-Norm=14.177 | L2-Norm(final)=8.731 | 5815.9 samples/s | 90.9 steps/s
[Step=12450 Epoch=24.3] | Loss=0.08656 | Reg=0.00201 | acc=0.8750 | L2-Norm=14.177 | L2-Norm(final)=8.790 | 5795.3 samples/s | 90.6 steps/s
[Step=12500 Epoch=24.4] | Loss=0.08596 | Reg=0.00201 | acc=0.9375 | L2-Norm=14.177 | L2-Norm(final)=8.851 | 7468.9 samples/s | 116.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=24.4] | Loss=0.08603 | Reg=0.00201 | acc=0.9375 | L2-Norm=14.178 | L2-Norm(final)=9.456 | 3842.0 samples/s | 60.0 steps/s
[Step=12550 Epoch=24.5] | Loss=0.06426 | Reg=0.00208 | acc=0.9219 | L2-Norm=14.414 | L2-Norm(final)=9.460 | 5045.8 samples/s | 78.8 steps/s
[Step=12600 Epoch=24.6] | Loss=0.06426 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.614 | L2-Norm(final)=9.430 | 5055.6 samples/s | 79.0 steps/s
[Step=12650 Epoch=24.7] | Loss=0.05851 | Reg=0.00217 | acc=0.9219 | L2-Norm=14.740 | L2-Norm(final)=9.417 | 5035.3 samples/s | 78.7 steps/s
[Step=12700 Epoch=24.8] | Loss=0.05580 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.835 | L2-Norm(final)=9.409 | 4950.5 samples/s | 77.4 steps/s
[Step=12750 Epoch=24.9] | Loss=0.05281 | Reg=0.00222 | acc=0.9219 | L2-Norm=14.912 | L2-Norm(final)=9.400 | 5067.2 samples/s | 79.2 steps/s
[Step=12800 Epoch=25.0] | Loss=0.05225 | Reg=0.00224 | acc=0.9531 | L2-Norm=14.977 | L2-Norm(final)=9.390 | 5036.4 samples/s | 78.7 steps/s
[Step=12850 Epoch=25.1] | Loss=0.05170 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.036 | L2-Norm(final)=9.383 | 5011.3 samples/s | 78.3 steps/s
[Step=12900 Epoch=25.2] | Loss=0.05036 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.089 | L2-Norm(final)=9.377 | 4979.9 samples/s | 77.8 steps/s
[Step=12950 Epoch=25.3] | Loss=0.04944 | Reg=0.00229 | acc=0.9375 | L2-Norm=15.138 | L2-Norm(final)=9.371 | 5014.9 samples/s | 78.4 steps/s
[Step=13000 Epoch=25.4] | Loss=0.04836 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.185 | L2-Norm(final)=9.365 | 6129.4 samples/s | 95.8 steps/s
[Step=13050 Epoch=25.5] | Loss=0.04708 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.233 | L2-Norm(final)=9.360 | 1946.7 samples/s | 30.4 steps/s
[Step=13100 Epoch=25.6] | Loss=0.04607 | Reg=0.00234 | acc=0.9688 | L2-Norm=15.280 | L2-Norm(final)=9.355 | 5017.3 samples/s | 78.4 steps/s
[Step=13150 Epoch=25.7] | Loss=0.04503 | Reg=0.00235 | acc=0.9219 | L2-Norm=15.323 | L2-Norm(final)=9.351 | 4976.5 samples/s | 77.8 steps/s
[Step=13200 Epoch=25.8] | Loss=0.04405 | Reg=0.00236 | acc=0.9688 | L2-Norm=15.363 | L2-Norm(final)=9.346 | 5025.8 samples/s | 78.5 steps/s
[Step=13250 Epoch=25.9] | Loss=0.04308 | Reg=0.00237 | acc=0.9688 | L2-Norm=15.400 | L2-Norm(final)=9.342 | 4950.3 samples/s | 77.3 steps/s
[Step=13300 Epoch=26.0] | Loss=0.04269 | Reg=0.00238 | acc=0.9375 | L2-Norm=15.436 | L2-Norm(final)=9.338 | 5036.7 samples/s | 78.7 steps/s
[Step=13350 Epoch=26.1] | Loss=0.04196 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.470 | L2-Norm(final)=9.334 | 5013.9 samples/s | 78.3 steps/s
[Step=13400 Epoch=26.2] | Loss=0.04090 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.503 | L2-Norm(final)=9.331 | 5028.2 samples/s | 78.6 steps/s
[Step=13450 Epoch=26.3] | Loss=0.04040 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.534 | L2-Norm(final)=9.328 | 4949.1 samples/s | 77.3 steps/s
[Step=13500 Epoch=26.4] | Loss=0.04015 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.564 | L2-Norm(final)=9.324 | 5471.0 samples/s | 85.5 steps/s
[Step=13550 Epoch=26.5] | Loss=0.03965 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.595 | L2-Norm(final)=9.320 | 2057.5 samples/s | 32.1 steps/s
[Step=13600 Epoch=26.6] | Loss=0.03901 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.625 | L2-Norm(final)=9.316 | 4794.4 samples/s | 74.9 steps/s
[Step=13650 Epoch=26.7] | Loss=0.03816 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.654 | L2-Norm(final)=9.313 | 5048.5 samples/s | 78.9 steps/s
[Step=13700 Epoch=26.8] | Loss=0.03757 | Reg=0.00246 | acc=0.9531 | L2-Norm=15.682 | L2-Norm(final)=9.310 | 5070.7 samples/s | 79.2 steps/s
[Step=13750 Epoch=26.9] | Loss=0.03729 | Reg=0.00247 | acc=0.9688 | L2-Norm=15.709 | L2-Norm(final)=9.308 | 4974.8 samples/s | 77.7 steps/s
[Step=13800 Epoch=27.0] | Loss=0.03701 | Reg=0.00248 | acc=0.9531 | L2-Norm=15.735 | L2-Norm(final)=9.304 | 5078.8 samples/s | 79.4 steps/s
[Step=13850 Epoch=27.1] | Loss=0.03686 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.761 | L2-Norm(final)=9.301 | 5057.6 samples/s | 79.0 steps/s
[Step=13900 Epoch=27.2] | Loss=0.03640 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.787 | L2-Norm(final)=9.298 | 5027.0 samples/s | 78.5 steps/s
[Step=13950 Epoch=27.3] | Loss=0.03611 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.813 | L2-Norm(final)=9.294 | 5019.6 samples/s | 78.4 steps/s
[Step=14000 Epoch=27.4] | Loss=0.03577 | Reg=0.00251 | acc=0.9844 | L2-Norm=15.839 | L2-Norm(final)=9.291 | 4984.3 samples/s | 77.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step14000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06582 | acc=0.9586 | tpr=0.9651 | fpr=0.0555 | 4205.7 samples/s | 16.4 steps/s
Avg test loss: 0.06701, Avg test acc: 0.95821, Avg tpr: 0.96474, Avg fpr: 0.05615, total FA: 438

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07321 | acc=0.9563 | tpr=0.9626 | fpr=0.0575 | 4278.5 samples/s | 16.7 steps/s
Avg test loss: 0.07895, Avg test acc: 0.95585, Avg tpr: 0.96235, Avg fpr: 0.05845, total FA: 456

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.69723 | acc=0.3234 | tpr=0.0267 | fpr=0.0322 | 4227.9 samples/s | 16.5 steps/s
Avg test loss: 5.70328, Avg test acc: 0.32094, Avg tpr: 0.02669, Avg fpr: 0.03192, total FA: 249

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.02842 | acc=0.3164 | tpr=0.0149 | fpr=0.0290 | 4148.8 samples/s | 16.2 steps/s
Avg test loss: 5.05223, Avg test acc: 0.31289, Avg tpr: 0.01451, Avg fpr: 0.03089, total FA: 241

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.25899 | acc=0.1338 | tpr=0.8407 | fpr=0.8790 | 4170.2 samples/s | 16.3 steps/s
[Step= 100] | Loss=4.24573 | acc=0.1357 | tpr=0.8380 | fpr=0.8774 | 8294.6 samples/s | 32.4 steps/s
[Step= 150] | Loss=4.25605 | acc=0.1343 | tpr=0.8516 | fpr=0.8789 | 8355.1 samples/s | 32.6 steps/s
[Step= 200] | Loss=4.25728 | acc=0.1354 | tpr=0.8536 | fpr=0.8776 | 8603.4 samples/s | 33.6 steps/s
[Step= 250] | Loss=4.25726 | acc=0.1357 | tpr=0.8611 | fpr=0.8775 | 8092.6 samples/s | 31.6 steps/s
[Step= 300] | Loss=4.25872 | acc=0.1360 | tpr=0.8596 | fpr=0.8772 | 8549.0 samples/s | 33.4 steps/s
[Step= 350] | Loss=4.25962 | acc=0.1361 | tpr=0.8635 | fpr=0.8771 | 8180.5 samples/s | 32.0 steps/s
[Step= 400] | Loss=4.25951 | acc=0.1366 | tpr=0.8660 | fpr=0.8766 | 8170.6 samples/s | 31.9 steps/s
[Step= 450] | Loss=4.25824 | acc=0.1368 | tpr=0.8681 | fpr=0.8765 | 8493.9 samples/s | 33.2 steps/s
[Step= 500] | Loss=4.25895 | acc=0.1364 | tpr=0.8683 | fpr=0.8768 | 8011.3 samples/s | 31.3 steps/s
[Step= 550] | Loss=4.25904 | acc=0.1364 | tpr=0.8679 | fpr=0.8769 | 15119.8 samples/s | 59.1 steps/s
Avg test loss: 4.25974, Avg test acc: 0.13634, Avg tpr: 0.86807, Avg fpr: 0.87696, total FA: 121764

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.00777 | acc=0.1256 | tpr=0.8938 | fpr=0.8882 | 4163.2 samples/s | 16.3 steps/s
[Step= 100] | Loss=4.97676 | acc=0.1271 | tpr=0.8955 | fpr=0.8872 | 8422.6 samples/s | 32.9 steps/s
[Step= 150] | Loss=4.99305 | acc=0.1269 | tpr=0.8905 | fpr=0.8872 | 8122.0 samples/s | 31.7 steps/s
[Step= 200] | Loss=4.99463 | acc=0.1265 | tpr=0.8798 | fpr=0.8872 | 8186.6 samples/s | 32.0 steps/s
[Step= 250] | Loss=4.99379 | acc=0.1271 | tpr=0.8821 | fpr=0.8866 | 8216.5 samples/s | 32.1 steps/s
[Step= 300] | Loss=4.99481 | acc=0.1271 | tpr=0.8807 | fpr=0.8867 | 8553.0 samples/s | 33.4 steps/s
[Step= 350] | Loss=4.99536 | acc=0.1266 | tpr=0.8791 | fpr=0.8870 | 8177.3 samples/s | 31.9 steps/s
[Step= 400] | Loss=4.99871 | acc=0.1271 | tpr=0.8769 | fpr=0.8865 | 8316.8 samples/s | 32.5 steps/s
[Step= 450] | Loss=5.00097 | acc=0.1268 | tpr=0.8802 | fpr=0.8869 | 8249.6 samples/s | 32.2 steps/s
[Step= 500] | Loss=5.00095 | acc=0.1269 | tpr=0.8811 | fpr=0.8867 | 8182.3 samples/s | 32.0 steps/s
[Step= 550] | Loss=4.99910 | acc=0.1269 | tpr=0.8810 | fpr=0.8868 | 15421.9 samples/s | 60.2 steps/s
Avg test loss: 5.00003, Avg test acc: 0.12680, Avg tpr: 0.88114, Avg fpr: 0.88691, total FA: 123146

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10851 | acc=0.9823 | tpr=0.9469 | fpr=0.0170 | 4197.4 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.11479 | acc=0.9816 | tpr=0.9574 | fpr=0.0179 | 8077.5 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.11988 | acc=0.9808 | tpr=0.9568 | fpr=0.0188 | 8461.0 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.12258 | acc=0.9804 | tpr=0.9552 | fpr=0.0191 | 8333.4 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.12028 | acc=0.9804 | tpr=0.9493 | fpr=0.0191 | 8344.6 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.12213 | acc=0.9801 | tpr=0.9505 | fpr=0.0194 | 8515.6 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.12324 | acc=0.9798 | tpr=0.9505 | fpr=0.0197 | 8342.5 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.12434 | acc=0.9797 | tpr=0.9469 | fpr=0.0197 | 8573.4 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.12667 | acc=0.9794 | tpr=0.9460 | fpr=0.0200 | 7868.7 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.12564 | acc=0.9795 | tpr=0.9467 | fpr=0.0199 | 8246.7 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.12475 | acc=0.9797 | tpr=0.9431 | fpr=0.0197 | 15466.8 samples/s | 60.4 steps/s
Avg test loss: 0.12449, Avg test acc: 0.97966, Avg tpr: 0.94295, Avg fpr: 0.01967, total FA: 2731

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11936 | acc=0.9773 | tpr=0.9204 | fpr=0.0217 | 4163.8 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.12068 | acc=0.9771 | tpr=0.9339 | fpr=0.0221 | 8544.7 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.12506 | acc=0.9761 | tpr=0.9380 | fpr=0.0232 | 8252.0 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.12483 | acc=0.9762 | tpr=0.9464 | fpr=0.0232 | 8080.0 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.12318 | acc=0.9761 | tpr=0.9406 | fpr=0.0232 | 8640.2 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.12478 | acc=0.9760 | tpr=0.9425 | fpr=0.0234 | 7988.3 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.12445 | acc=0.9761 | tpr=0.9449 | fpr=0.0233 | 8589.6 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.12545 | acc=0.9760 | tpr=0.9409 | fpr=0.0233 | 8130.6 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.12775 | acc=0.9757 | tpr=0.9362 | fpr=0.0236 | 8560.1 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.12785 | acc=0.9758 | tpr=0.9366 | fpr=0.0235 | 8451.2 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.12665 | acc=0.9761 | tpr=0.9359 | fpr=0.0232 | 14802.1 samples/s | 57.8 steps/s
Avg test loss: 0.12649, Avg test acc: 0.97613, Avg tpr: 0.93582, Avg fpr: 0.02313, total FA: 3212

server round 10/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=8001 Epoch=30.7] | Loss=0.00711 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.124 | L2-Norm(final)=7.786 | 3839.9 samples/s | 60.0 steps/s
[Step=8050 Epoch=30.8] | Loss=0.01476 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.120 | L2-Norm(final)=7.800 | 5206.8 samples/s | 81.4 steps/s
[Step=8100 Epoch=31.0] | Loss=0.01410 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.119 | L2-Norm(final)=7.821 | 5404.0 samples/s | 84.4 steps/s
[Step=8150 Epoch=31.2] | Loss=0.01377 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.119 | L2-Norm(final)=7.846 | 5415.6 samples/s | 84.6 steps/s
[Step=8200 Epoch=31.4] | Loss=0.01306 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=7.876 | 5436.3 samples/s | 84.9 steps/s
[Step=8250 Epoch=31.6] | Loss=0.01228 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.119 | L2-Norm(final)=7.909 | 7143.4 samples/s | 111.6 steps/s
[Step=8300 Epoch=31.8] | Loss=0.01177 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.119 | L2-Norm(final)=7.945 | 1969.2 samples/s | 30.8 steps/s
[Step=8350 Epoch=32.0] | Loss=0.01137 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=7.982 | 5354.7 samples/s | 83.7 steps/s
[Step=8400 Epoch=32.2] | Loss=0.01119 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=8.020 | 5508.8 samples/s | 86.1 steps/s
[Step=8450 Epoch=32.4] | Loss=0.01093 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=8.057 | 5423.0 samples/s | 84.7 steps/s
[Step=8500 Epoch=32.6] | Loss=0.01072 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=8.094 | 6135.5 samples/s | 95.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=8501 Epoch=32.6] | Loss=0.00457 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=8.467 | 4100.0 samples/s | 64.1 steps/s
[Step=8550 Epoch=32.8] | Loss=0.00644 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.145 | L2-Norm(final)=8.485 | 3965.2 samples/s | 62.0 steps/s
[Step=8600 Epoch=33.0] | Loss=0.00474 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.177 | L2-Norm(final)=8.491 | 4680.7 samples/s | 73.1 steps/s
[Step=8650 Epoch=33.1] | Loss=0.00651 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.206 | L2-Norm(final)=8.488 | 4841.4 samples/s | 75.6 steps/s
[Step=8700 Epoch=33.3] | Loss=0.00564 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.230 | L2-Norm(final)=8.484 | 4732.1 samples/s | 73.9 steps/s
[Step=8750 Epoch=33.5] | Loss=0.00482 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.243 | L2-Norm(final)=8.483 | 6044.1 samples/s | 94.4 steps/s
[Step=8800 Epoch=33.7] | Loss=0.00407 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.249 | L2-Norm(final)=8.482 | 1885.6 samples/s | 29.5 steps/s
[Step=8850 Epoch=33.9] | Loss=0.00351 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.247 | L2-Norm(final)=8.483 | 4759.4 samples/s | 74.4 steps/s
[Step=8900 Epoch=34.1] | Loss=0.00308 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.241 | L2-Norm(final)=8.484 | 4798.4 samples/s | 75.0 steps/s
[Step=8950 Epoch=34.3] | Loss=0.00275 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.232 | L2-Norm(final)=8.485 | 4739.8 samples/s | 74.1 steps/s
[Step=9000 Epoch=34.5] | Loss=0.00248 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.221 | L2-Norm(final)=8.486 | 5258.7 samples/s | 82.2 steps/s
[Step=9050 Epoch=34.7] | Loss=0.00227 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.209 | L2-Norm(final)=8.487 | 1984.9 samples/s | 31.0 steps/s
[Step=9100 Epoch=34.9] | Loss=0.00208 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.196 | L2-Norm(final)=8.489 | 4781.7 samples/s | 74.7 steps/s
[Step=9150 Epoch=35.1] | Loss=0.00192 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.182 | L2-Norm(final)=8.490 | 4781.3 samples/s | 74.7 steps/s
[Step=9200 Epoch=35.3] | Loss=0.00179 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.167 | L2-Norm(final)=8.491 | 4778.5 samples/s | 74.7 steps/s
[Step=9250 Epoch=35.4] | Loss=0.00167 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.152 | L2-Norm(final)=8.492 | 4796.8 samples/s | 74.9 steps/s
[Step=9300 Epoch=35.6] | Loss=0.00156 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.136 | L2-Norm(final)=8.493 | 2032.0 samples/s | 31.7 steps/s
[Step=9350 Epoch=35.8] | Loss=0.00147 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.120 | L2-Norm(final)=8.494 | 4950.1 samples/s | 77.3 steps/s
[Step=9400 Epoch=36.0] | Loss=0.00139 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.104 | L2-Norm(final)=8.495 | 4850.1 samples/s | 75.8 steps/s
[Step=9450 Epoch=36.2] | Loss=0.00132 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.087 | L2-Norm(final)=8.495 | 4753.5 samples/s | 74.3 steps/s
[Step=9500 Epoch=36.4] | Loss=0.00125 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.071 | L2-Norm(final)=8.496 | 4777.5 samples/s | 74.6 steps/s
[Step=9550 Epoch=36.6] | Loss=0.00119 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.054 | L2-Norm(final)=8.497 | 2053.8 samples/s | 32.1 steps/s
[Step=9600 Epoch=36.8] | Loss=0.00114 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.037 | L2-Norm(final)=8.497 | 4771.7 samples/s | 74.6 steps/s
[Step=9650 Epoch=37.0] | Loss=0.00109 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.020 | L2-Norm(final)=8.498 | 4831.2 samples/s | 75.5 steps/s
[Step=9700 Epoch=37.2] | Loss=0.00105 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.003 | L2-Norm(final)=8.499 | 4853.5 samples/s | 75.8 steps/s
[Step=9750 Epoch=37.4] | Loss=0.00100 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.986 | L2-Norm(final)=8.499 | 4751.5 samples/s | 74.2 steps/s
[Step=9800 Epoch=37.6] | Loss=0.00097 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.968 | L2-Norm(final)=8.500 | 6545.1 samples/s | 102.3 steps/s
[Step=9850 Epoch=37.7] | Loss=0.00093 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.951 | L2-Norm(final)=8.500 | 1800.2 samples/s | 28.1 steps/s
[Step=9900 Epoch=37.9] | Loss=0.00090 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.933 | L2-Norm(final)=8.501 | 4781.4 samples/s | 74.7 steps/s
[Step=9950 Epoch=38.1] | Loss=0.00087 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.916 | L2-Norm(final)=8.501 | 4790.8 samples/s | 74.9 steps/s
[Step=10000 Epoch=38.3] | Loss=0.00084 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.898 | L2-Norm(final)=8.502 | 4815.3 samples/s | 75.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step10000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=6001 Epoch=23.1] | Loss=0.00958 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.124 | L2-Norm(final)=7.951 | 3665.2 samples/s | 57.3 steps/s
[Step=6050 Epoch=23.3] | Loss=0.01243 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.120 | L2-Norm(final)=7.968 | 5463.8 samples/s | 85.4 steps/s
[Step=6100 Epoch=23.5] | Loss=0.01278 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=7.996 | 5432.5 samples/s | 84.9 steps/s
[Step=6150 Epoch=23.7] | Loss=0.01194 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.119 | L2-Norm(final)=8.035 | 5549.5 samples/s | 86.7 steps/s
[Step=6200 Epoch=23.9] | Loss=0.01177 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=8.079 | 5522.7 samples/s | 86.3 steps/s
[Step=6250 Epoch=24.1] | Loss=0.01139 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=8.121 | 7198.0 samples/s | 112.5 steps/s
[Step=6300 Epoch=24.3] | Loss=0.01106 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=8.162 | 1967.1 samples/s | 30.7 steps/s
[Step=6350 Epoch=24.4] | Loss=0.01070 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=8.205 | 5559.2 samples/s | 86.9 steps/s
[Step=6400 Epoch=24.6] | Loss=0.01076 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.119 | L2-Norm(final)=8.247 | 5624.9 samples/s | 87.9 steps/s
[Step=6450 Epoch=24.8] | Loss=0.01061 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.119 | L2-Norm(final)=8.288 | 5433.6 samples/s | 84.9 steps/s
[Step=6500 Epoch=25.0] | Loss=0.01063 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.119 | L2-Norm(final)=8.329 | 6202.3 samples/s | 96.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=6501 Epoch=25.0] | Loss=0.01230 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=8.735 | 4010.5 samples/s | 62.7 steps/s
[Step=6550 Epoch=25.2] | Loss=0.01095 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.167 | L2-Norm(final)=8.751 | 4293.5 samples/s | 67.1 steps/s
[Step=6600 Epoch=25.4] | Loss=0.00835 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.244 | L2-Norm(final)=8.741 | 4730.2 samples/s | 73.9 steps/s
[Step=6650 Epoch=25.6] | Loss=0.00585 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.278 | L2-Norm(final)=8.740 | 4814.9 samples/s | 75.2 steps/s
[Step=6700 Epoch=25.8] | Loss=0.00463 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.289 | L2-Norm(final)=8.742 | 4734.9 samples/s | 74.0 steps/s
[Step=6750 Epoch=26.0] | Loss=0.00393 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.290 | L2-Norm(final)=8.745 | 6093.6 samples/s | 95.2 steps/s
[Step=6800 Epoch=26.2] | Loss=0.00330 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.288 | L2-Norm(final)=8.748 | 1889.7 samples/s | 29.5 steps/s
[Step=6850 Epoch=26.4] | Loss=0.00283 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.281 | L2-Norm(final)=8.750 | 4809.4 samples/s | 75.1 steps/s
[Step=6900 Epoch=26.6] | Loss=0.00248 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.272 | L2-Norm(final)=8.752 | 4703.5 samples/s | 73.5 steps/s
[Step=6950 Epoch=26.8] | Loss=0.00221 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.260 | L2-Norm(final)=8.754 | 4823.6 samples/s | 75.4 steps/s
[Step=7000 Epoch=26.9] | Loss=0.00205 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.247 | L2-Norm(final)=8.755 | 5350.4 samples/s | 83.6 steps/s
[Step=7050 Epoch=27.1] | Loss=0.00193 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.235 | L2-Norm(final)=8.757 | 1959.4 samples/s | 30.6 steps/s
[Step=7100 Epoch=27.3] | Loss=0.00184 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.223 | L2-Norm(final)=8.758 | 4748.3 samples/s | 74.2 steps/s
[Step=7150 Epoch=27.5] | Loss=0.00174 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.211 | L2-Norm(final)=8.759 | 4774.6 samples/s | 74.6 steps/s
[Step=7200 Epoch=27.7] | Loss=0.00177 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.200 | L2-Norm(final)=8.759 | 4801.1 samples/s | 75.0 steps/s
[Step=7250 Epoch=27.9] | Loss=0.00165 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.189 | L2-Norm(final)=8.759 | 4822.4 samples/s | 75.4 steps/s
[Step=7300 Epoch=28.1] | Loss=0.00155 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.178 | L2-Norm(final)=8.759 | 2015.4 samples/s | 31.5 steps/s
[Step=7350 Epoch=28.3] | Loss=0.00146 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.166 | L2-Norm(final)=8.759 | 4819.7 samples/s | 75.3 steps/s
[Step=7400 Epoch=28.5] | Loss=0.00138 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.153 | L2-Norm(final)=8.759 | 4791.0 samples/s | 74.9 steps/s
[Step=7450 Epoch=28.7] | Loss=0.00131 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.140 | L2-Norm(final)=8.759 | 4793.3 samples/s | 74.9 steps/s
[Step=7500 Epoch=28.9] | Loss=0.00125 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.127 | L2-Norm(final)=8.759 | 4817.7 samples/s | 75.3 steps/s
[Step=7550 Epoch=29.1] | Loss=0.00119 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.113 | L2-Norm(final)=8.759 | 2071.0 samples/s | 32.4 steps/s
[Step=7600 Epoch=29.3] | Loss=0.00113 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.099 | L2-Norm(final)=8.760 | 4743.0 samples/s | 74.1 steps/s
[Step=7650 Epoch=29.4] | Loss=0.00109 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.085 | L2-Norm(final)=8.760 | 4799.2 samples/s | 75.0 steps/s
[Step=7700 Epoch=29.6] | Loss=0.00104 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.071 | L2-Norm(final)=8.760 | 4734.5 samples/s | 74.0 steps/s
[Step=7750 Epoch=29.8] | Loss=0.00100 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.056 | L2-Norm(final)=8.761 | 4749.7 samples/s | 74.2 steps/s
[Step=7800 Epoch=30.0] | Loss=0.00096 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.041 | L2-Norm(final)=8.761 | 7076.9 samples/s | 110.6 steps/s
[Step=7850 Epoch=30.2] | Loss=0.00093 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.026 | L2-Norm(final)=8.761 | 1793.0 samples/s | 28.0 steps/s
[Step=7900 Epoch=30.4] | Loss=0.00089 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.011 | L2-Norm(final)=8.762 | 4746.6 samples/s | 74.2 steps/s
[Step=7950 Epoch=30.6] | Loss=0.00086 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.996 | L2-Norm(final)=8.762 | 4788.9 samples/s | 74.8 steps/s
[Step=8000 Epoch=30.8] | Loss=0.00083 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.981 | L2-Norm(final)=8.762 | 4838.2 samples/s | 75.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_1/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06582 | acc=0.9586 | tpr=0.9651 | fpr=0.0555 | 4156.4 samples/s | 16.2 steps/s
Avg test loss: 0.06701, Avg test acc: 0.95821, Avg tpr: 0.96474, Avg fpr: 0.05615, total FA: 438

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07321 | acc=0.9563 | tpr=0.9626 | fpr=0.0575 | 4224.5 samples/s | 16.5 steps/s
Avg test loss: 0.07895, Avg test acc: 0.95585, Avg tpr: 0.96235, Avg fpr: 0.05845, total FA: 456

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.71822 | acc=0.3181 | tpr=0.0202 | fpr=0.0349 | 4246.6 samples/s | 16.6 steps/s
Avg test loss: 4.73222, Avg test acc: 0.31465, Avg tpr: 0.01982, Avg fpr: 0.03692, total FA: 288

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.11808 | acc=0.3191 | tpr=0.0188 | fpr=0.0287 | 4302.7 samples/s | 16.8 steps/s
Avg test loss: 5.11283, Avg test acc: 0.31661, Avg tpr: 0.01795, Avg fpr: 0.02654, total FA: 207

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.25899 | acc=0.1338 | tpr=0.8407 | fpr=0.8790 | 4190.6 samples/s | 16.4 steps/s
[Step= 100] | Loss=4.24573 | acc=0.1357 | tpr=0.8380 | fpr=0.8774 | 8460.2 samples/s | 33.0 steps/s
[Step= 150] | Loss=4.25605 | acc=0.1343 | tpr=0.8516 | fpr=0.8789 | 8205.3 samples/s | 32.1 steps/s
[Step= 200] | Loss=4.25728 | acc=0.1354 | tpr=0.8536 | fpr=0.8776 | 8528.8 samples/s | 33.3 steps/s
[Step= 250] | Loss=4.25726 | acc=0.1357 | tpr=0.8611 | fpr=0.8775 | 8262.8 samples/s | 32.3 steps/s
[Step= 300] | Loss=4.25872 | acc=0.1360 | tpr=0.8596 | fpr=0.8772 | 8395.9 samples/s | 32.8 steps/s
[Step= 350] | Loss=4.25962 | acc=0.1361 | tpr=0.8635 | fpr=0.8771 | 8207.9 samples/s | 32.1 steps/s
[Step= 400] | Loss=4.25951 | acc=0.1366 | tpr=0.8660 | fpr=0.8766 | 8376.9 samples/s | 32.7 steps/s
[Step= 450] | Loss=4.25824 | acc=0.1368 | tpr=0.8681 | fpr=0.8765 | 8241.9 samples/s | 32.2 steps/s
[Step= 500] | Loss=4.25895 | acc=0.1364 | tpr=0.8683 | fpr=0.8768 | 8042.1 samples/s | 31.4 steps/s
[Step= 550] | Loss=4.25904 | acc=0.1364 | tpr=0.8679 | fpr=0.8769 | 15434.7 samples/s | 60.3 steps/s
Avg test loss: 4.25974, Avg test acc: 0.13634, Avg tpr: 0.86807, Avg fpr: 0.87696, total FA: 121764

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.00777 | acc=0.1256 | tpr=0.8938 | fpr=0.8882 | 4200.9 samples/s | 16.4 steps/s
[Step= 100] | Loss=4.97676 | acc=0.1271 | tpr=0.8955 | fpr=0.8872 | 8468.6 samples/s | 33.1 steps/s
[Step= 150] | Loss=4.99305 | acc=0.1269 | tpr=0.8905 | fpr=0.8872 | 8131.0 samples/s | 31.8 steps/s
[Step= 200] | Loss=4.99463 | acc=0.1265 | tpr=0.8798 | fpr=0.8872 | 8391.5 samples/s | 32.8 steps/s
[Step= 250] | Loss=4.99379 | acc=0.1271 | tpr=0.8821 | fpr=0.8866 | 8255.0 samples/s | 32.2 steps/s
[Step= 300] | Loss=4.99481 | acc=0.1271 | tpr=0.8807 | fpr=0.8867 | 8196.6 samples/s | 32.0 steps/s
[Step= 350] | Loss=4.99536 | acc=0.1266 | tpr=0.8791 | fpr=0.8870 | 8458.5 samples/s | 33.0 steps/s
[Step= 400] | Loss=4.99871 | acc=0.1271 | tpr=0.8769 | fpr=0.8865 | 8327.2 samples/s | 32.5 steps/s
[Step= 450] | Loss=5.00097 | acc=0.1268 | tpr=0.8802 | fpr=0.8869 | 8519.8 samples/s | 33.3 steps/s
[Step= 500] | Loss=5.00095 | acc=0.1269 | tpr=0.8811 | fpr=0.8867 | 8245.3 samples/s | 32.2 steps/s
[Step= 550] | Loss=4.99910 | acc=0.1269 | tpr=0.8810 | fpr=0.8868 | 14820.7 samples/s | 57.9 steps/s
Avg test loss: 5.00003, Avg test acc: 0.12680, Avg tpr: 0.88114, Avg fpr: 0.88691, total FA: 123146

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08876 | acc=0.9852 | tpr=0.9248 | fpr=0.0138 | 4226.1 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.09694 | acc=0.9841 | tpr=0.9339 | fpr=0.0149 | 7992.7 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.10148 | acc=0.9834 | tpr=0.9352 | fpr=0.0157 | 8327.4 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.10100 | acc=0.9836 | tpr=0.9410 | fpr=0.0156 | 8324.3 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.09949 | acc=0.9836 | tpr=0.9345 | fpr=0.0155 | 8458.0 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.10131 | acc=0.9835 | tpr=0.9331 | fpr=0.0156 | 8236.2 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.10307 | acc=0.9833 | tpr=0.9330 | fpr=0.0158 | 8143.4 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.10338 | acc=0.9830 | tpr=0.9305 | fpr=0.0160 | 8225.0 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.10570 | acc=0.9827 | tpr=0.9265 | fpr=0.0163 | 8312.7 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.10551 | acc=0.9828 | tpr=0.9291 | fpr=0.0162 | 8189.4 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.10458 | acc=0.9830 | tpr=0.9288 | fpr=0.0161 | 16153.8 samples/s | 63.1 steps/s
Avg test loss: 0.10441, Avg test acc: 0.98297, Avg tpr: 0.92868, Avg fpr: 0.01604, total FA: 2227

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11535 | acc=0.9812 | tpr=0.9469 | fpr=0.0181 | 4186.9 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.12071 | acc=0.9805 | tpr=0.9488 | fpr=0.0189 | 8235.5 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.12726 | acc=0.9796 | tpr=0.9510 | fpr=0.0198 | 8356.0 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.12922 | acc=0.9795 | tpr=0.9552 | fpr=0.0201 | 8177.2 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.12775 | acc=0.9793 | tpr=0.9511 | fpr=0.0201 | 8365.2 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.13012 | acc=0.9790 | tpr=0.9498 | fpr=0.0204 | 8210.2 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.13063 | acc=0.9790 | tpr=0.9518 | fpr=0.0205 | 8134.9 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.13132 | acc=0.9789 | tpr=0.9508 | fpr=0.0206 | 8621.9 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.13383 | acc=0.9787 | tpr=0.9499 | fpr=0.0208 | 8110.0 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.13329 | acc=0.9788 | tpr=0.9498 | fpr=0.0207 | 8226.5 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.13188 | acc=0.9789 | tpr=0.9483 | fpr=0.0205 | 15636.2 samples/s | 61.1 steps/s
Avg test loss: 0.13164, Avg test acc: 0.97892, Avg tpr: 0.94810, Avg fpr: 0.02052, total FA: 2849

server round 11/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=27.4] | Loss=0.07492 | Reg=0.00204 | acc=0.9219 | L2-Norm=14.276 | L2-Norm(final)=9.185 | 3779.2 samples/s | 59.0 steps/s
[Step=14050 Epoch=27.5] | Loss=0.04355 | Reg=0.00204 | acc=0.9531 | L2-Norm=14.279 | L2-Norm(final)=9.173 | 5112.4 samples/s | 79.9 steps/s
[Step=14100 Epoch=27.6] | Loss=0.04492 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.280 | L2-Norm(final)=9.163 | 5700.7 samples/s | 89.1 steps/s
[Step=14150 Epoch=27.7] | Loss=0.04509 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.280 | L2-Norm(final)=9.154 | 5838.4 samples/s | 91.2 steps/s
[Step=14200 Epoch=27.8] | Loss=0.04471 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.280 | L2-Norm(final)=9.148 | 5849.7 samples/s | 91.4 steps/s
[Step=14250 Epoch=27.9] | Loss=0.04474 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.280 | L2-Norm(final)=9.143 | 5700.1 samples/s | 89.1 steps/s
[Step=14300 Epoch=28.0] | Loss=0.04433 | Reg=0.00204 | acc=0.9375 | L2-Norm=14.280 | L2-Norm(final)=9.139 | 5877.1 samples/s | 91.8 steps/s
[Step=14350 Epoch=28.1] | Loss=0.04349 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.280 | L2-Norm(final)=9.138 | 5971.4 samples/s | 93.3 steps/s
[Step=14400 Epoch=28.2] | Loss=0.04318 | Reg=0.00204 | acc=0.9375 | L2-Norm=14.280 | L2-Norm(final)=9.137 | 5831.0 samples/s | 91.1 steps/s
[Step=14450 Epoch=28.2] | Loss=0.04352 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.280 | L2-Norm(final)=9.136 | 5801.6 samples/s | 90.7 steps/s
[Step=14500 Epoch=28.3] | Loss=0.04324 | Reg=0.00204 | acc=0.9531 | L2-Norm=14.280 | L2-Norm(final)=9.136 | 7446.2 samples/s | 116.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=28.3] | Loss=0.02660 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.280 | L2-Norm(final)=9.139 | 3708.1 samples/s | 57.9 steps/s
[Step=14550 Epoch=28.4] | Loss=0.03636 | Reg=0.00205 | acc=0.9531 | L2-Norm=14.317 | L2-Norm(final)=9.142 | 4987.4 samples/s | 77.9 steps/s
[Step=14600 Epoch=28.5] | Loss=0.03337 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.356 | L2-Norm(final)=9.145 | 5035.1 samples/s | 78.7 steps/s
[Step=14650 Epoch=28.6] | Loss=0.03039 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.389 | L2-Norm(final)=9.147 | 4962.6 samples/s | 77.5 steps/s
[Step=14700 Epoch=28.7] | Loss=0.03063 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.413 | L2-Norm(final)=9.149 | 5003.0 samples/s | 78.2 steps/s
[Step=14750 Epoch=28.8] | Loss=0.03041 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.434 | L2-Norm(final)=9.147 | 5039.8 samples/s | 78.7 steps/s
[Step=14800 Epoch=28.9] | Loss=0.03040 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.454 | L2-Norm(final)=9.146 | 4991.7 samples/s | 78.0 steps/s
[Step=14850 Epoch=29.0] | Loss=0.02908 | Reg=0.00209 | acc=0.9531 | L2-Norm=14.471 | L2-Norm(final)=9.146 | 5119.9 samples/s | 80.0 steps/s
[Step=14900 Epoch=29.1] | Loss=0.02822 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.486 | L2-Norm(final)=9.146 | 5040.1 samples/s | 78.8 steps/s
[Step=14950 Epoch=29.2] | Loss=0.02772 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.500 | L2-Norm(final)=9.146 | 4941.1 samples/s | 77.2 steps/s
[Step=15000 Epoch=29.3] | Loss=0.02774 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.513 | L2-Norm(final)=9.146 | 6204.7 samples/s | 96.9 steps/s
[Step=15050 Epoch=29.4] | Loss=0.02692 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.525 | L2-Norm(final)=9.146 | 1954.7 samples/s | 30.5 steps/s
[Step=15100 Epoch=29.5] | Loss=0.02597 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.536 | L2-Norm(final)=9.146 | 4922.1 samples/s | 76.9 steps/s
[Step=15150 Epoch=29.6] | Loss=0.02521 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.547 | L2-Norm(final)=9.147 | 4983.3 samples/s | 77.9 steps/s
[Step=15200 Epoch=29.7] | Loss=0.02462 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.556 | L2-Norm(final)=9.148 | 5043.0 samples/s | 78.8 steps/s
[Step=15250 Epoch=29.8] | Loss=0.02407 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.565 | L2-Norm(final)=9.148 | 5042.4 samples/s | 78.8 steps/s
[Step=15300 Epoch=29.9] | Loss=0.02352 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.573 | L2-Norm(final)=9.149 | 5019.9 samples/s | 78.4 steps/s
[Step=15350 Epoch=30.0] | Loss=0.02325 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.580 | L2-Norm(final)=9.150 | 4980.3 samples/s | 77.8 steps/s
[Step=15400 Epoch=30.1] | Loss=0.02282 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.588 | L2-Norm(final)=9.151 | 4966.5 samples/s | 77.6 steps/s
[Step=15450 Epoch=30.2] | Loss=0.02253 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.595 | L2-Norm(final)=9.152 | 4973.1 samples/s | 77.7 steps/s
[Step=15500 Epoch=30.3] | Loss=0.02227 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.603 | L2-Norm(final)=9.153 | 5428.1 samples/s | 84.8 steps/s
[Step=15550 Epoch=30.4] | Loss=0.02174 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.610 | L2-Norm(final)=9.155 | 2048.4 samples/s | 32.0 steps/s
[Step=15600 Epoch=30.5] | Loss=0.02119 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.617 | L2-Norm(final)=9.157 | 4954.5 samples/s | 77.4 steps/s
[Step=15650 Epoch=30.6] | Loss=0.02081 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.624 | L2-Norm(final)=9.158 | 4982.9 samples/s | 77.9 steps/s
[Step=15700 Epoch=30.7] | Loss=0.02050 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.630 | L2-Norm(final)=9.160 | 5051.1 samples/s | 78.9 steps/s
[Step=15750 Epoch=30.8] | Loss=0.02011 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.637 | L2-Norm(final)=9.162 | 5048.2 samples/s | 78.9 steps/s
[Step=15800 Epoch=30.9] | Loss=0.01983 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.643 | L2-Norm(final)=9.163 | 5095.1 samples/s | 79.6 steps/s
[Step=15850 Epoch=31.0] | Loss=0.01962 | Reg=0.00215 | acc=0.9531 | L2-Norm=14.649 | L2-Norm(final)=9.165 | 4965.1 samples/s | 77.6 steps/s
[Step=15900 Epoch=31.1] | Loss=0.01951 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.655 | L2-Norm(final)=9.166 | 4986.2 samples/s | 77.9 steps/s
[Step=15950 Epoch=31.2] | Loss=0.01942 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.660 | L2-Norm(final)=9.167 | 4996.3 samples/s | 78.1 steps/s
[Step=16000 Epoch=31.3] | Loss=0.01923 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.666 | L2-Norm(final)=9.169 | 5030.6 samples/s | 78.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step16000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=10001 Epoch=38.3] | Loss=0.00877 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.276 | L2-Norm(final)=8.518 | 3596.2 samples/s | 56.2 steps/s
[Step=10050 Epoch=38.5] | Loss=0.00811 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.270 | L2-Norm(final)=8.561 | 5516.1 samples/s | 86.2 steps/s
[Step=10100 Epoch=38.7] | Loss=0.01008 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.269 | L2-Norm(final)=8.612 | 5468.6 samples/s | 85.4 steps/s
[Step=10150 Epoch=38.9] | Loss=0.00906 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.269 | L2-Norm(final)=8.659 | 5498.2 samples/s | 85.9 steps/s
[Step=10200 Epoch=39.1] | Loss=0.00878 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.269 | L2-Norm(final)=8.705 | 5456.5 samples/s | 85.3 steps/s
[Step=10250 Epoch=39.3] | Loss=0.00876 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.269 | L2-Norm(final)=8.747 | 7132.8 samples/s | 111.4 steps/s
[Step=10300 Epoch=39.5] | Loss=0.00884 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.269 | L2-Norm(final)=8.787 | 1952.4 samples/s | 30.5 steps/s
[Step=10350 Epoch=39.7] | Loss=0.00873 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.269 | L2-Norm(final)=8.826 | 5469.5 samples/s | 85.5 steps/s
[Step=10400 Epoch=39.8] | Loss=0.00865 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.269 | L2-Norm(final)=8.866 | 5463.5 samples/s | 85.4 steps/s
[Step=10450 Epoch=40.0] | Loss=0.00862 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.269 | L2-Norm(final)=8.905 | 5513.6 samples/s | 86.1 steps/s
[Step=10500 Epoch=40.2] | Loss=0.00867 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.269 | L2-Norm(final)=8.943 | 6096.6 samples/s | 95.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=40.2] | Loss=0.00443 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.269 | L2-Norm(final)=9.314 | 3664.4 samples/s | 57.3 steps/s
[Step=10550 Epoch=40.4] | Loss=0.00766 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.340 | L2-Norm(final)=9.327 | 4774.6 samples/s | 74.6 steps/s
[Step=10600 Epoch=40.6] | Loss=0.00932 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.404 | L2-Norm(final)=9.311 | 4740.1 samples/s | 74.1 steps/s
[Step=10650 Epoch=40.8] | Loss=0.00730 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.438 | L2-Norm(final)=9.299 | 4757.2 samples/s | 74.3 steps/s
[Step=10700 Epoch=41.0] | Loss=0.00629 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.460 | L2-Norm(final)=9.292 | 4755.0 samples/s | 74.3 steps/s
[Step=10750 Epoch=41.2] | Loss=0.00550 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.470 | L2-Norm(final)=9.288 | 6020.0 samples/s | 94.1 steps/s
[Step=10800 Epoch=41.4] | Loss=0.00462 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.473 | L2-Norm(final)=9.285 | 1896.2 samples/s | 29.6 steps/s
[Step=10850 Epoch=41.6] | Loss=0.00397 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.470 | L2-Norm(final)=9.283 | 4743.4 samples/s | 74.1 steps/s
[Step=10900 Epoch=41.8] | Loss=0.00348 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.463 | L2-Norm(final)=9.282 | 4754.0 samples/s | 74.3 steps/s
[Step=10950 Epoch=42.0] | Loss=0.00310 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.453 | L2-Norm(final)=9.282 | 4877.2 samples/s | 76.2 steps/s
[Step=11000 Epoch=42.1] | Loss=0.00280 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.441 | L2-Norm(final)=9.282 | 5375.7 samples/s | 84.0 steps/s
[Step=11050 Epoch=42.3] | Loss=0.00254 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.428 | L2-Norm(final)=9.282 | 1931.6 samples/s | 30.2 steps/s
[Step=11100 Epoch=42.5] | Loss=0.00233 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.414 | L2-Norm(final)=9.282 | 4726.4 samples/s | 73.9 steps/s
[Step=11150 Epoch=42.7] | Loss=0.00215 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.399 | L2-Norm(final)=9.282 | 4727.9 samples/s | 73.9 steps/s
[Step=11200 Epoch=42.9] | Loss=0.00200 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.384 | L2-Norm(final)=9.282 | 4812.9 samples/s | 75.2 steps/s
[Step=11250 Epoch=43.1] | Loss=0.00187 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.368 | L2-Norm(final)=9.282 | 4715.1 samples/s | 73.7 steps/s
[Step=11300 Epoch=43.3] | Loss=0.00175 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.352 | L2-Norm(final)=9.282 | 2041.9 samples/s | 31.9 steps/s
[Step=11350 Epoch=43.5] | Loss=0.00165 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.335 | L2-Norm(final)=9.282 | 4853.1 samples/s | 75.8 steps/s
[Step=11400 Epoch=43.7] | Loss=0.00156 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.319 | L2-Norm(final)=9.283 | 4761.6 samples/s | 74.4 steps/s
[Step=11450 Epoch=43.9] | Loss=0.00148 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.302 | L2-Norm(final)=9.283 | 4775.3 samples/s | 74.6 steps/s
[Step=11500 Epoch=44.1] | Loss=0.00140 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.286 | L2-Norm(final)=9.283 | 4884.2 samples/s | 76.3 steps/s
[Step=11550 Epoch=44.3] | Loss=0.00134 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.269 | L2-Norm(final)=9.283 | 2052.7 samples/s | 32.1 steps/s
[Step=11600 Epoch=44.4] | Loss=0.00128 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.252 | L2-Norm(final)=9.283 | 4787.0 samples/s | 74.8 steps/s
[Step=11650 Epoch=44.6] | Loss=0.00122 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.236 | L2-Norm(final)=9.284 | 4793.9 samples/s | 74.9 steps/s
[Step=11700 Epoch=44.8] | Loss=0.00117 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.219 | L2-Norm(final)=9.284 | 4779.9 samples/s | 74.7 steps/s
[Step=11750 Epoch=45.0] | Loss=0.00112 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.202 | L2-Norm(final)=9.284 | 4751.5 samples/s | 74.2 steps/s
[Step=11800 Epoch=45.2] | Loss=0.00108 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.185 | L2-Norm(final)=9.284 | 6576.4 samples/s | 102.8 steps/s
[Step=11850 Epoch=45.4] | Loss=0.00104 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.168 | L2-Norm(final)=9.285 | 1848.6 samples/s | 28.9 steps/s
[Step=11900 Epoch=45.6] | Loss=0.00100 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.152 | L2-Norm(final)=9.285 | 4780.1 samples/s | 74.7 steps/s
[Step=11950 Epoch=45.8] | Loss=0.00097 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.135 | L2-Norm(final)=9.285 | 4748.8 samples/s | 74.2 steps/s
[Step=12000 Epoch=46.0] | Loss=0.00094 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.118 | L2-Norm(final)=9.285 | 4754.6 samples/s | 74.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06582 | acc=0.9586 | tpr=0.9651 | fpr=0.0555 | 4221.5 samples/s | 16.5 steps/s
Avg test loss: 0.06701, Avg test acc: 0.95821, Avg tpr: 0.96474, Avg fpr: 0.05615, total FA: 438

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06747 | acc=0.9645 | tpr=0.9777 | fpr=0.0644 | 4188.5 samples/s | 16.4 steps/s
Avg test loss: 0.07383, Avg test acc: 0.96366, Avg tpr: 0.97715, Avg fpr: 0.06602, total FA: 515

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.64863 | acc=0.3173 | tpr=0.0139 | fpr=0.0238 | 4128.3 samples/s | 16.1 steps/s
Avg test loss: 5.66638, Avg test acc: 0.31441, Avg tpr: 0.01335, Avg fpr: 0.02346, total FA: 183

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.11808 | acc=0.3191 | tpr=0.0188 | fpr=0.0287 | 4198.0 samples/s | 16.4 steps/s
Avg test loss: 5.11283, Avg test acc: 0.31661, Avg tpr: 0.01795, Avg fpr: 0.02654, total FA: 207

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.25899 | acc=0.1338 | tpr=0.8407 | fpr=0.8790 | 4215.8 samples/s | 16.5 steps/s
[Step= 100] | Loss=4.24573 | acc=0.1357 | tpr=0.8380 | fpr=0.8774 | 8181.0 samples/s | 32.0 steps/s
[Step= 150] | Loss=4.25605 | acc=0.1343 | tpr=0.8516 | fpr=0.8789 | 8290.3 samples/s | 32.4 steps/s
[Step= 200] | Loss=4.25728 | acc=0.1354 | tpr=0.8536 | fpr=0.8776 | 8528.9 samples/s | 33.3 steps/s
[Step= 250] | Loss=4.25726 | acc=0.1357 | tpr=0.8611 | fpr=0.8775 | 8628.3 samples/s | 33.7 steps/s
[Step= 300] | Loss=4.25872 | acc=0.1360 | tpr=0.8596 | fpr=0.8772 | 8042.4 samples/s | 31.4 steps/s
[Step= 350] | Loss=4.25962 | acc=0.1361 | tpr=0.8635 | fpr=0.8771 | 7390.9 samples/s | 28.9 steps/s
[Step= 400] | Loss=4.25951 | acc=0.1366 | tpr=0.8660 | fpr=0.8766 | 8280.4 samples/s | 32.3 steps/s
[Step= 450] | Loss=4.25824 | acc=0.1368 | tpr=0.8681 | fpr=0.8765 | 8366.3 samples/s | 32.7 steps/s
[Step= 500] | Loss=4.25895 | acc=0.1364 | tpr=0.8683 | fpr=0.8768 | 5674.2 samples/s | 22.2 steps/s
[Step= 550] | Loss=4.25904 | acc=0.1364 | tpr=0.8679 | fpr=0.8769 | 13049.8 samples/s | 51.0 steps/s
Avg test loss: 4.25974, Avg test acc: 0.13634, Avg tpr: 0.86807, Avg fpr: 0.87696, total FA: 121764

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.91896 | acc=0.1041 | tpr=0.9381 | fpr=0.9108 | 4329.1 samples/s | 16.9 steps/s
[Step= 100] | Loss=5.88878 | acc=0.1064 | tpr=0.9403 | fpr=0.9092 | 8300.8 samples/s | 32.4 steps/s
[Step= 150] | Loss=5.90513 | acc=0.1063 | tpr=0.9337 | fpr=0.9089 | 7977.3 samples/s | 31.2 steps/s
[Step= 200] | Loss=5.90599 | acc=0.1063 | tpr=0.9301 | fpr=0.9086 | 8315.8 samples/s | 32.5 steps/s
[Step= 250] | Loss=5.90418 | acc=0.1072 | tpr=0.9319 | fpr=0.9078 | 8669.8 samples/s | 33.9 steps/s
[Step= 300] | Loss=5.90564 | acc=0.1072 | tpr=0.9265 | fpr=0.9077 | 6818.9 samples/s | 26.6 steps/s
[Step= 350] | Loss=5.90252 | acc=0.1067 | tpr=0.9242 | fpr=0.9082 | 8134.2 samples/s | 31.8 steps/s
[Step= 400] | Loss=5.90533 | acc=0.1070 | tpr=0.9240 | fpr=0.9079 | 7939.8 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.90666 | acc=0.1069 | tpr=0.9260 | fpr=0.9080 | 8329.0 samples/s | 32.5 steps/s
[Step= 500] | Loss=5.90656 | acc=0.1071 | tpr=0.9269 | fpr=0.9077 | 5936.8 samples/s | 23.2 steps/s
[Step= 550] | Loss=5.90548 | acc=0.1072 | tpr=0.9280 | fpr=0.9077 | 15357.8 samples/s | 60.0 steps/s
Avg test loss: 5.90618, Avg test acc: 0.10715, Avg tpr: 0.92829, Avg fpr: 0.90778, total FA: 126043

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12996 | acc=0.9811 | tpr=0.9469 | fpr=0.0183 | 4135.4 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.13855 | acc=0.9802 | tpr=0.9510 | fpr=0.0193 | 8536.8 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.14459 | acc=0.9794 | tpr=0.9467 | fpr=0.0200 | 8303.8 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.14760 | acc=0.9794 | tpr=0.9486 | fpr=0.0200 | 8118.5 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.14515 | acc=0.9795 | tpr=0.9459 | fpr=0.0199 | 8230.9 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.14862 | acc=0.9792 | tpr=0.9440 | fpr=0.0201 | 6702.7 samples/s | 26.2 steps/s
[Step= 350] | Loss=0.14917 | acc=0.9790 | tpr=0.9461 | fpr=0.0205 | 8878.6 samples/s | 34.7 steps/s
[Step= 400] | Loss=0.15055 | acc=0.9786 | tpr=0.9415 | fpr=0.0207 | 8208.2 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.15319 | acc=0.9783 | tpr=0.9391 | fpr=0.0210 | 8061.2 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.15246 | acc=0.9784 | tpr=0.9392 | fpr=0.0209 | 5967.2 samples/s | 23.3 steps/s
[Step= 550] | Loss=0.15103 | acc=0.9785 | tpr=0.9387 | fpr=0.0208 | 14943.6 samples/s | 58.4 steps/s
Avg test loss: 0.15080, Avg test acc: 0.97854, Avg tpr: 0.93859, Avg fpr: 0.02073, total FA: 2879

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11535 | acc=0.9812 | tpr=0.9469 | fpr=0.0181 | 4249.5 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.12071 | acc=0.9805 | tpr=0.9488 | fpr=0.0189 | 8085.6 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.12726 | acc=0.9796 | tpr=0.9510 | fpr=0.0198 | 8283.9 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.12922 | acc=0.9795 | tpr=0.9552 | fpr=0.0201 | 8326.6 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.12775 | acc=0.9793 | tpr=0.9511 | fpr=0.0201 | 8196.8 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.13012 | acc=0.9790 | tpr=0.9498 | fpr=0.0204 | 6848.7 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.13063 | acc=0.9790 | tpr=0.9518 | fpr=0.0205 | 8182.6 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.13132 | acc=0.9789 | tpr=0.9508 | fpr=0.0206 | 8335.2 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.13383 | acc=0.9787 | tpr=0.9499 | fpr=0.0208 | 6285.3 samples/s | 24.6 steps/s
[Step= 500] | Loss=0.13329 | acc=0.9788 | tpr=0.9498 | fpr=0.0207 | 7611.0 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.13188 | acc=0.9789 | tpr=0.9483 | fpr=0.0205 | 14916.7 samples/s | 58.3 steps/s
Avg test loss: 0.13164, Avg test acc: 0.97892, Avg tpr: 0.94810, Avg fpr: 0.02052, total FA: 2849

server round 12/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=23.4] | Loss=0.02837 | Reg=0.00199 | acc=0.9531 | L2-Norm=14.099 | L2-Norm(final)=8.493 | 3417.2 samples/s | 53.4 steps/s
[Step=12050 Epoch=23.5] | Loss=0.04408 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.104 | L2-Norm(final)=8.496 | 5670.8 samples/s | 88.6 steps/s
[Step=12100 Epoch=23.6] | Loss=0.04240 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.105 | L2-Norm(final)=8.499 | 5908.7 samples/s | 92.3 steps/s
[Step=12150 Epoch=23.7] | Loss=0.04012 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.105 | L2-Norm(final)=8.508 | 5654.0 samples/s | 88.3 steps/s
[Step=12200 Epoch=23.8] | Loss=0.03999 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.105 | L2-Norm(final)=8.518 | 5805.7 samples/s | 90.7 steps/s
[Step=12250 Epoch=23.9] | Loss=0.04016 | Reg=0.00199 | acc=0.9375 | L2-Norm=14.105 | L2-Norm(final)=8.528 | 5761.7 samples/s | 90.0 steps/s
[Step=12300 Epoch=24.0] | Loss=0.03977 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.106 | L2-Norm(final)=8.538 | 5917.5 samples/s | 92.5 steps/s
[Step=12350 Epoch=24.1] | Loss=0.03950 | Reg=0.00199 | acc=0.9219 | L2-Norm=14.106 | L2-Norm(final)=8.548 | 5773.7 samples/s | 90.2 steps/s
[Step=12400 Epoch=24.2] | Loss=0.03948 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.106 | L2-Norm(final)=8.559 | 5801.6 samples/s | 90.6 steps/s
[Step=12450 Epoch=24.3] | Loss=0.03906 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.106 | L2-Norm(final)=8.570 | 5847.9 samples/s | 91.4 steps/s
[Step=12500 Epoch=24.4] | Loss=0.03859 | Reg=0.00199 | acc=0.9531 | L2-Norm=14.106 | L2-Norm(final)=8.580 | 7311.2 samples/s | 114.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=24.4] | Loss=0.02263 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.106 | L2-Norm(final)=8.693 | 3936.8 samples/s | 61.5 steps/s
[Step=12550 Epoch=24.5] | Loss=0.03237 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.166 | L2-Norm(final)=8.702 | 4503.2 samples/s | 70.4 steps/s
[Step=12600 Epoch=24.6] | Loss=0.03126 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.212 | L2-Norm(final)=8.704 | 5062.0 samples/s | 79.1 steps/s
[Step=12650 Epoch=24.7] | Loss=0.02978 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.243 | L2-Norm(final)=8.701 | 5241.9 samples/s | 81.9 steps/s
[Step=12700 Epoch=24.8] | Loss=0.02856 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.268 | L2-Norm(final)=8.700 | 5020.5 samples/s | 78.4 steps/s
[Step=12750 Epoch=24.9] | Loss=0.02773 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.288 | L2-Norm(final)=8.700 | 5063.7 samples/s | 79.1 steps/s
[Step=12800 Epoch=25.0] | Loss=0.02743 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.306 | L2-Norm(final)=8.700 | 5045.2 samples/s | 78.8 steps/s
[Step=12850 Epoch=25.1] | Loss=0.02666 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.322 | L2-Norm(final)=8.700 | 5021.5 samples/s | 78.5 steps/s
[Step=12900 Epoch=25.2] | Loss=0.02668 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.336 | L2-Norm(final)=8.700 | 5066.2 samples/s | 79.2 steps/s
[Step=12950 Epoch=25.3] | Loss=0.02658 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.350 | L2-Norm(final)=8.701 | 5078.2 samples/s | 79.3 steps/s
[Step=13000 Epoch=25.4] | Loss=0.02592 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.363 | L2-Norm(final)=8.702 | 6125.3 samples/s | 95.7 steps/s
[Step=13050 Epoch=25.5] | Loss=0.02512 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.376 | L2-Norm(final)=8.703 | 1878.7 samples/s | 29.4 steps/s
[Step=13100 Epoch=25.6] | Loss=0.02424 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.388 | L2-Norm(final)=8.704 | 4994.8 samples/s | 78.0 steps/s
[Step=13150 Epoch=25.6] | Loss=0.02355 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.399 | L2-Norm(final)=8.705 | 5063.0 samples/s | 79.1 steps/s
[Step=13200 Epoch=25.7] | Loss=0.02317 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.409 | L2-Norm(final)=8.706 | 5055.9 samples/s | 79.0 steps/s
[Step=13250 Epoch=25.8] | Loss=0.02313 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.419 | L2-Norm(final)=8.707 | 5035.6 samples/s | 78.7 steps/s
[Step=13300 Epoch=25.9] | Loss=0.02260 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.428 | L2-Norm(final)=8.708 | 5041.2 samples/s | 78.8 steps/s
[Step=13350 Epoch=26.0] | Loss=0.02220 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.437 | L2-Norm(final)=8.710 | 5032.1 samples/s | 78.6 steps/s
[Step=13400 Epoch=26.1] | Loss=0.02174 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.446 | L2-Norm(final)=8.711 | 5063.5 samples/s | 79.1 steps/s
[Step=13450 Epoch=26.2] | Loss=0.02143 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.454 | L2-Norm(final)=8.712 | 5013.0 samples/s | 78.3 steps/s
[Step=13500 Epoch=26.3] | Loss=0.02111 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.462 | L2-Norm(final)=8.714 | 5332.7 samples/s | 83.3 steps/s
[Step=13550 Epoch=26.4] | Loss=0.02097 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.470 | L2-Norm(final)=8.714 | 1926.5 samples/s | 30.1 steps/s
[Step=13600 Epoch=26.5] | Loss=0.02051 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.478 | L2-Norm(final)=8.715 | 5048.8 samples/s | 78.9 steps/s
[Step=13650 Epoch=26.6] | Loss=0.02009 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.485 | L2-Norm(final)=8.716 | 5097.8 samples/s | 79.7 steps/s
[Step=13700 Epoch=26.7] | Loss=0.01964 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.492 | L2-Norm(final)=8.717 | 4961.7 samples/s | 77.5 steps/s
[Step=13750 Epoch=26.8] | Loss=0.01941 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.499 | L2-Norm(final)=8.719 | 5092.3 samples/s | 79.6 steps/s
[Step=13800 Epoch=26.9] | Loss=0.01918 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.505 | L2-Norm(final)=8.720 | 5066.0 samples/s | 79.2 steps/s
[Step=13850 Epoch=27.0] | Loss=0.01908 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.512 | L2-Norm(final)=8.721 | 5006.4 samples/s | 78.2 steps/s
[Step=13900 Epoch=27.1] | Loss=0.01887 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.518 | L2-Norm(final)=8.722 | 5008.9 samples/s | 78.3 steps/s
[Step=13950 Epoch=27.2] | Loss=0.01869 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.525 | L2-Norm(final)=8.723 | 5162.5 samples/s | 80.7 steps/s
[Step=14000 Epoch=27.3] | Loss=0.01857 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.531 | L2-Norm(final)=8.724 | 4937.0 samples/s | 77.1 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step14000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=8001 Epoch=30.8] | Loss=0.01704 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.099 | L2-Norm(final)=8.774 | 3662.7 samples/s | 57.2 steps/s
[Step=8050 Epoch=31.0] | Loss=0.00630 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.094 | L2-Norm(final)=8.810 | 5320.4 samples/s | 83.1 steps/s
[Step=8100 Epoch=31.2] | Loss=0.00548 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=8.859 | 5497.7 samples/s | 85.9 steps/s
[Step=8150 Epoch=31.4] | Loss=0.00536 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=8.903 | 5385.3 samples/s | 84.1 steps/s
[Step=8200 Epoch=31.6] | Loss=0.00535 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=8.945 | 5517.9 samples/s | 86.2 steps/s
[Step=8250 Epoch=31.8] | Loss=0.00526 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=8.983 | 7353.8 samples/s | 114.9 steps/s
[Step=8300 Epoch=31.9] | Loss=0.00529 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=9.020 | 1978.4 samples/s | 30.9 steps/s
[Step=8350 Epoch=32.1] | Loss=0.00531 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=9.055 | 5435.5 samples/s | 84.9 steps/s
[Step=8400 Epoch=32.3] | Loss=0.00521 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=9.088 | 5397.6 samples/s | 84.3 steps/s
[Step=8450 Epoch=32.5] | Loss=0.00513 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=9.121 | 5545.5 samples/s | 86.6 steps/s
[Step=8500 Epoch=32.7] | Loss=0.00506 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=9.153 | 6280.3 samples/s | 98.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=8501 Epoch=32.7] | Loss=0.00992 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.093 | L2-Norm(final)=9.468 | 3873.9 samples/s | 60.5 steps/s
[Step=8550 Epoch=32.9] | Loss=0.00860 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.146 | L2-Norm(final)=9.480 | 4449.7 samples/s | 69.5 steps/s
[Step=8600 Epoch=33.1] | Loss=0.00656 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.257 | L2-Norm(final)=9.473 | 4797.3 samples/s | 75.0 steps/s
[Step=8650 Epoch=33.3] | Loss=0.00534 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.317 | L2-Norm(final)=9.470 | 4779.6 samples/s | 74.7 steps/s
[Step=8700 Epoch=33.5] | Loss=0.00511 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.356 | L2-Norm(final)=9.468 | 4793.4 samples/s | 74.9 steps/s
[Step=8750 Epoch=33.7] | Loss=0.00437 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.383 | L2-Norm(final)=9.465 | 6129.4 samples/s | 95.8 steps/s
[Step=8800 Epoch=33.9] | Loss=0.00384 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.398 | L2-Norm(final)=9.463 | 1888.0 samples/s | 29.5 steps/s
[Step=8850 Epoch=34.1] | Loss=0.00331 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.404 | L2-Norm(final)=9.463 | 4758.1 samples/s | 74.3 steps/s
[Step=8900 Epoch=34.3] | Loss=0.00291 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.405 | L2-Norm(final)=9.462 | 4784.4 samples/s | 74.8 steps/s
[Step=8950 Epoch=34.5] | Loss=0.00259 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.402 | L2-Norm(final)=9.462 | 4762.7 samples/s | 74.4 steps/s
[Step=9000 Epoch=34.6] | Loss=0.00235 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.397 | L2-Norm(final)=9.463 | 5460.7 samples/s | 85.3 steps/s
[Step=9050 Epoch=34.8] | Loss=0.00213 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.390 | L2-Norm(final)=9.464 | 1940.7 samples/s | 30.3 steps/s
[Step=9100 Epoch=35.0] | Loss=0.00196 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.382 | L2-Norm(final)=9.464 | 4750.3 samples/s | 74.2 steps/s
[Step=9150 Epoch=35.2] | Loss=0.00181 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.373 | L2-Norm(final)=9.465 | 4850.2 samples/s | 75.8 steps/s
[Step=9200 Epoch=35.4] | Loss=0.00168 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.363 | L2-Norm(final)=9.466 | 4681.4 samples/s | 73.1 steps/s
[Step=9250 Epoch=35.6] | Loss=0.00157 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.352 | L2-Norm(final)=9.466 | 4809.6 samples/s | 75.2 steps/s
[Step=9300 Epoch=35.8] | Loss=0.00147 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.341 | L2-Norm(final)=9.467 | 2026.7 samples/s | 31.7 steps/s
[Step=9350 Epoch=36.0] | Loss=0.00139 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.329 | L2-Norm(final)=9.468 | 4859.9 samples/s | 75.9 steps/s
[Step=9400 Epoch=36.2] | Loss=0.00131 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.317 | L2-Norm(final)=9.468 | 4742.1 samples/s | 74.1 steps/s
[Step=9450 Epoch=36.4] | Loss=0.00124 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.305 | L2-Norm(final)=9.469 | 4808.6 samples/s | 75.1 steps/s
[Step=9500 Epoch=36.6] | Loss=0.00118 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.292 | L2-Norm(final)=9.469 | 4750.1 samples/s | 74.2 steps/s
[Step=9550 Epoch=36.8] | Loss=0.00112 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.279 | L2-Norm(final)=9.470 | 2036.5 samples/s | 31.8 steps/s
[Step=9600 Epoch=37.0] | Loss=0.00107 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.266 | L2-Norm(final)=9.470 | 4954.3 samples/s | 77.4 steps/s
[Step=9650 Epoch=37.1] | Loss=0.00103 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.253 | L2-Norm(final)=9.471 | 4766.5 samples/s | 74.5 steps/s
[Step=9700 Epoch=37.3] | Loss=0.00098 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.240 | L2-Norm(final)=9.471 | 4799.8 samples/s | 75.0 steps/s
[Step=9750 Epoch=37.5] | Loss=0.00095 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.227 | L2-Norm(final)=9.472 | 4852.1 samples/s | 75.8 steps/s
[Step=9800 Epoch=37.7] | Loss=0.00091 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.213 | L2-Norm(final)=9.472 | 7063.4 samples/s | 110.4 steps/s
[Step=9850 Epoch=37.9] | Loss=0.00088 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.199 | L2-Norm(final)=9.473 | 1815.6 samples/s | 28.4 steps/s
[Step=9900 Epoch=38.1] | Loss=0.00084 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.186 | L2-Norm(final)=9.473 | 4755.1 samples/s | 74.3 steps/s
[Step=9950 Epoch=38.3] | Loss=0.00082 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.172 | L2-Norm(final)=9.474 | 4824.7 samples/s | 75.4 steps/s
[Step=10000 Epoch=38.5] | Loss=0.00079 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.158 | L2-Norm(final)=9.474 | 4776.9 samples/s | 74.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_1/client_state-step10000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06470 | acc=0.9649 | tpr=0.9706 | fpr=0.0473 | 3974.9 samples/s | 15.5 steps/s
Avg test loss: 0.06603, Avg test acc: 0.96518, Avg tpr: 0.97004, Avg fpr: 0.04551, total FA: 355

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06747 | acc=0.9645 | tpr=0.9777 | fpr=0.0644 | 3531.0 samples/s | 13.8 steps/s
Avg test loss: 0.07383, Avg test acc: 0.96366, Avg tpr: 0.97715, Avg fpr: 0.06602, total FA: 515

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.64863 | acc=0.3173 | tpr=0.0139 | fpr=0.0238 | 3744.1 samples/s | 14.6 steps/s
Avg test loss: 5.66638, Avg test acc: 0.31441, Avg tpr: 0.01335, Avg fpr: 0.02346, total FA: 183

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.37416 | acc=0.3180 | tpr=0.0160 | fpr=0.0260 | 4147.8 samples/s | 16.2 steps/s
Avg test loss: 5.38364, Avg test acc: 0.31605, Avg tpr: 0.01615, Avg fpr: 0.02436, total FA: 190

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.35709 | acc=0.1160 | tpr=0.8894 | fpr=0.8979 | 4198.5 samples/s | 16.4 steps/s
[Step= 100] | Loss=5.34008 | acc=0.1190 | tpr=0.8955 | fpr=0.8955 | 8091.8 samples/s | 31.6 steps/s
[Step= 150] | Loss=5.35371 | acc=0.1188 | tpr=0.8977 | fpr=0.8956 | 9036.1 samples/s | 35.3 steps/s
[Step= 200] | Loss=5.36004 | acc=0.1189 | tpr=0.9005 | fpr=0.8953 | 4846.6 samples/s | 18.9 steps/s
[Step= 250] | Loss=5.35723 | acc=0.1199 | tpr=0.9048 | fpr=0.8944 | 8387.5 samples/s | 32.8 steps/s
[Step= 300] | Loss=5.35887 | acc=0.1198 | tpr=0.8953 | fpr=0.8943 | 8159.9 samples/s | 31.9 steps/s
[Step= 350] | Loss=5.35824 | acc=0.1195 | tpr=0.8936 | fpr=0.8945 | 8238.6 samples/s | 32.2 steps/s
[Step= 400] | Loss=5.36290 | acc=0.1200 | tpr=0.8939 | fpr=0.8940 | 8496.0 samples/s | 33.2 steps/s
[Step= 450] | Loss=5.36369 | acc=0.1199 | tpr=0.8963 | fpr=0.8942 | 8332.6 samples/s | 32.5 steps/s
[Step= 500] | Loss=5.36476 | acc=0.1200 | tpr=0.8982 | fpr=0.8941 | 8030.4 samples/s | 31.4 steps/s
[Step= 550] | Loss=5.36470 | acc=0.1199 | tpr=0.8993 | fpr=0.8942 | 15818.3 samples/s | 61.8 steps/s
Avg test loss: 5.36637, Avg test acc: 0.11985, Avg tpr: 0.89976, Avg fpr: 0.89432, total FA: 124175

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.91896 | acc=0.1041 | tpr=0.9381 | fpr=0.9108 | 4149.2 samples/s | 16.2 steps/s
[Step= 100] | Loss=5.88878 | acc=0.1064 | tpr=0.9403 | fpr=0.9092 | 8386.4 samples/s | 32.8 steps/s
[Step= 150] | Loss=5.90513 | acc=0.1063 | tpr=0.9337 | fpr=0.9089 | 8246.5 samples/s | 32.2 steps/s
[Step= 200] | Loss=5.90599 | acc=0.1063 | tpr=0.9301 | fpr=0.9086 | 5164.9 samples/s | 20.2 steps/s
[Step= 250] | Loss=5.90418 | acc=0.1072 | tpr=0.9319 | fpr=0.9078 | 8251.7 samples/s | 32.2 steps/s
[Step= 300] | Loss=5.90564 | acc=0.1072 | tpr=0.9265 | fpr=0.9077 | 8162.9 samples/s | 31.9 steps/s
[Step= 350] | Loss=5.90252 | acc=0.1067 | tpr=0.9242 | fpr=0.9082 | 8472.8 samples/s | 33.1 steps/s
[Step= 400] | Loss=5.90533 | acc=0.1070 | tpr=0.9240 | fpr=0.9079 | 8329.1 samples/s | 32.5 steps/s
[Step= 450] | Loss=5.90666 | acc=0.1069 | tpr=0.9260 | fpr=0.9080 | 8160.1 samples/s | 31.9 steps/s
[Step= 500] | Loss=5.90656 | acc=0.1071 | tpr=0.9269 | fpr=0.9077 | 8217.5 samples/s | 32.1 steps/s
[Step= 550] | Loss=5.90548 | acc=0.1072 | tpr=0.9280 | fpr=0.9077 | 16046.8 samples/s | 62.7 steps/s
Avg test loss: 5.90618, Avg test acc: 0.10715, Avg tpr: 0.92829, Avg fpr: 0.90778, total FA: 126043

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12996 | acc=0.9811 | tpr=0.9469 | fpr=0.0183 | 4158.1 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.13855 | acc=0.9802 | tpr=0.9510 | fpr=0.0193 | 8344.3 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.14459 | acc=0.9794 | tpr=0.9467 | fpr=0.0200 | 5686.9 samples/s | 22.2 steps/s
[Step= 200] | Loss=0.14760 | acc=0.9794 | tpr=0.9486 | fpr=0.0200 | 7192.0 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.14515 | acc=0.9795 | tpr=0.9459 | fpr=0.0199 | 8497.1 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.14862 | acc=0.9792 | tpr=0.9440 | fpr=0.0201 | 8111.7 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.14917 | acc=0.9790 | tpr=0.9461 | fpr=0.0205 | 8405.9 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.15055 | acc=0.9786 | tpr=0.9415 | fpr=0.0207 | 8478.8 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.15319 | acc=0.9783 | tpr=0.9391 | fpr=0.0210 | 7848.7 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.15246 | acc=0.9784 | tpr=0.9392 | fpr=0.0209 | 8345.5 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.15103 | acc=0.9785 | tpr=0.9387 | fpr=0.0208 | 15627.3 samples/s | 61.0 steps/s
Avg test loss: 0.15080, Avg test acc: 0.97854, Avg tpr: 0.93859, Avg fpr: 0.02073, total FA: 2879

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10448 | acc=0.9831 | tpr=0.9513 | fpr=0.0163 | 4129.5 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.11325 | acc=0.9827 | tpr=0.9531 | fpr=0.0168 | 8246.9 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.11811 | acc=0.9819 | tpr=0.9568 | fpr=0.0176 | 5133.6 samples/s | 20.1 steps/s
[Step= 200] | Loss=0.11883 | acc=0.9818 | tpr=0.9617 | fpr=0.0178 | 8434.5 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.11763 | acc=0.9818 | tpr=0.9581 | fpr=0.0178 | 8231.1 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.12038 | acc=0.9814 | tpr=0.9571 | fpr=0.0182 | 8294.0 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.12146 | acc=0.9813 | tpr=0.9580 | fpr=0.0182 | 8223.0 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.12242 | acc=0.9812 | tpr=0.9551 | fpr=0.0184 | 8374.0 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.12542 | acc=0.9809 | tpr=0.9528 | fpr=0.0186 | 8320.1 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.12519 | acc=0.9809 | tpr=0.9529 | fpr=0.0186 | 8386.7 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.12395 | acc=0.9811 | tpr=0.9503 | fpr=0.0184 | 14808.0 samples/s | 57.8 steps/s
Avg test loss: 0.12378, Avg test acc: 0.98107, Avg tpr: 0.95008, Avg fpr: 0.01837, total FA: 2550

server round 13/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=27.3] | Loss=0.02122 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.853 | L2-Norm(final)=8.757 | 3896.5 samples/s | 60.9 steps/s
[Step=14050 Epoch=27.4] | Loss=0.03557 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.855 | L2-Norm(final)=8.767 | 5116.3 samples/s | 79.9 steps/s
[Step=14100 Epoch=27.5] | Loss=0.03561 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.856 | L2-Norm(final)=8.774 | 5685.9 samples/s | 88.8 steps/s
[Step=14150 Epoch=27.6] | Loss=0.03714 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.856 | L2-Norm(final)=8.779 | 5768.9 samples/s | 90.1 steps/s
[Step=14200 Epoch=27.7] | Loss=0.03758 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.856 | L2-Norm(final)=8.782 | 5811.3 samples/s | 90.8 steps/s
[Step=14250 Epoch=27.8] | Loss=0.03730 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.856 | L2-Norm(final)=8.783 | 5930.9 samples/s | 92.7 steps/s
[Step=14300 Epoch=27.9] | Loss=0.03713 | Reg=0.00192 | acc=0.9219 | L2-Norm=13.856 | L2-Norm(final)=8.787 | 5806.4 samples/s | 90.7 steps/s
[Step=14350 Epoch=28.0] | Loss=0.03733 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.856 | L2-Norm(final)=8.792 | 5830.4 samples/s | 91.1 steps/s
[Step=14400 Epoch=28.1] | Loss=0.03658 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.856 | L2-Norm(final)=8.797 | 5840.7 samples/s | 91.3 steps/s
[Step=14450 Epoch=28.2] | Loss=0.03642 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.856 | L2-Norm(final)=8.805 | 5854.2 samples/s | 91.5 steps/s
[Step=14500 Epoch=28.3] | Loss=0.03652 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.856 | L2-Norm(final)=8.813 | 7292.6 samples/s | 113.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=28.3] | Loss=0.03435 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.856 | L2-Norm(final)=8.893 | 3813.5 samples/s | 59.6 steps/s
[Step=14550 Epoch=28.4] | Loss=0.03603 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.909 | L2-Norm(final)=8.894 | 4588.2 samples/s | 71.7 steps/s
[Step=14600 Epoch=28.5] | Loss=0.03236 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.968 | L2-Norm(final)=8.891 | 4974.6 samples/s | 77.7 steps/s
[Step=14650 Epoch=28.6] | Loss=0.03156 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.015 | L2-Norm(final)=8.888 | 5026.4 samples/s | 78.5 steps/s
[Step=14700 Epoch=28.7] | Loss=0.03119 | Reg=0.00198 | acc=0.9531 | L2-Norm=14.053 | L2-Norm(final)=8.887 | 5070.6 samples/s | 79.2 steps/s
[Step=14750 Epoch=28.8] | Loss=0.03083 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.085 | L2-Norm(final)=8.886 | 4999.9 samples/s | 78.1 steps/s
[Step=14800 Epoch=28.9] | Loss=0.03001 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.113 | L2-Norm(final)=8.884 | 5063.0 samples/s | 79.1 steps/s
[Step=14850 Epoch=29.0] | Loss=0.02915 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.136 | L2-Norm(final)=8.883 | 5055.8 samples/s | 79.0 steps/s
[Step=14900 Epoch=29.1] | Loss=0.02864 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.156 | L2-Norm(final)=8.882 | 5057.2 samples/s | 79.0 steps/s
[Step=14950 Epoch=29.2] | Loss=0.02757 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.175 | L2-Norm(final)=8.881 | 5060.3 samples/s | 79.1 steps/s
[Step=15000 Epoch=29.3] | Loss=0.02703 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.193 | L2-Norm(final)=8.880 | 6194.3 samples/s | 96.8 steps/s
[Step=15050 Epoch=29.4] | Loss=0.02610 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.209 | L2-Norm(final)=8.880 | 1872.3 samples/s | 29.3 steps/s
[Step=15100 Epoch=29.5] | Loss=0.02509 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.224 | L2-Norm(final)=8.881 | 5004.6 samples/s | 78.2 steps/s
[Step=15150 Epoch=29.5] | Loss=0.02448 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.238 | L2-Norm(final)=8.881 | 5036.8 samples/s | 78.7 steps/s
[Step=15200 Epoch=29.6] | Loss=0.02389 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.250 | L2-Norm(final)=8.882 | 5054.0 samples/s | 79.0 steps/s
[Step=15250 Epoch=29.7] | Loss=0.02346 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.262 | L2-Norm(final)=8.883 | 5018.2 samples/s | 78.4 steps/s
[Step=15300 Epoch=29.8] | Loss=0.02310 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.274 | L2-Norm(final)=8.883 | 5036.7 samples/s | 78.7 steps/s
[Step=15350 Epoch=29.9] | Loss=0.02275 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.286 | L2-Norm(final)=8.883 | 5080.8 samples/s | 79.4 steps/s
[Step=15400 Epoch=30.0] | Loss=0.02240 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.296 | L2-Norm(final)=8.883 | 5025.7 samples/s | 78.5 steps/s
[Step=15450 Epoch=30.1] | Loss=0.02196 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.306 | L2-Norm(final)=8.883 | 5075.1 samples/s | 79.3 steps/s
[Step=15500 Epoch=30.2] | Loss=0.02179 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.316 | L2-Norm(final)=8.884 | 5337.6 samples/s | 83.4 steps/s
[Step=15550 Epoch=30.3] | Loss=0.02159 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.325 | L2-Norm(final)=8.884 | 2009.6 samples/s | 31.4 steps/s
[Step=15600 Epoch=30.4] | Loss=0.02133 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.335 | L2-Norm(final)=8.884 | 4967.5 samples/s | 77.6 steps/s
[Step=15650 Epoch=30.5] | Loss=0.02098 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.344 | L2-Norm(final)=8.885 | 5056.7 samples/s | 79.0 steps/s
[Step=15700 Epoch=30.6] | Loss=0.02056 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.352 | L2-Norm(final)=8.885 | 5008.1 samples/s | 78.3 steps/s
[Step=15750 Epoch=30.7] | Loss=0.02024 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.361 | L2-Norm(final)=8.886 | 5058.5 samples/s | 79.0 steps/s
[Step=15800 Epoch=30.8] | Loss=0.02001 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.369 | L2-Norm(final)=8.886 | 5058.6 samples/s | 79.0 steps/s
[Step=15850 Epoch=30.9] | Loss=0.01980 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.377 | L2-Norm(final)=8.887 | 5019.2 samples/s | 78.4 steps/s
[Step=15900 Epoch=31.0] | Loss=0.01956 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.384 | L2-Norm(final)=8.887 | 4988.9 samples/s | 78.0 steps/s
[Step=15950 Epoch=31.1] | Loss=0.01939 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.392 | L2-Norm(final)=8.888 | 5067.4 samples/s | 79.2 steps/s
[Step=16000 Epoch=31.2] | Loss=0.01917 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.400 | L2-Norm(final)=8.889 | 5082.5 samples/s | 79.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step16000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=10001 Epoch=38.5] | Loss=0.00060 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.853 | L2-Norm(final)=9.487 | 3804.9 samples/s | 59.5 steps/s
[Step=10050 Epoch=38.7] | Loss=0.00279 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.848 | L2-Norm(final)=9.508 | 5068.5 samples/s | 79.2 steps/s
[Step=10100 Epoch=38.9] | Loss=0.00262 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.848 | L2-Norm(final)=9.531 | 5482.2 samples/s | 85.7 steps/s
[Step=10150 Epoch=39.1] | Loss=0.00243 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.848 | L2-Norm(final)=9.552 | 5432.5 samples/s | 84.9 steps/s
[Step=10200 Epoch=39.3] | Loss=0.00256 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.848 | L2-Norm(final)=9.574 | 5454.0 samples/s | 85.2 steps/s
[Step=10250 Epoch=39.5] | Loss=0.00253 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.848 | L2-Norm(final)=9.594 | 7288.2 samples/s | 113.9 steps/s
[Step=10300 Epoch=39.6] | Loss=0.00250 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.847 | L2-Norm(final)=9.613 | 1950.8 samples/s | 30.5 steps/s
[Step=10350 Epoch=39.8] | Loss=0.00240 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.847 | L2-Norm(final)=9.631 | 5457.7 samples/s | 85.3 steps/s
[Step=10400 Epoch=40.0] | Loss=0.00240 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.847 | L2-Norm(final)=9.649 | 5454.7 samples/s | 85.2 steps/s
[Step=10450 Epoch=40.2] | Loss=0.00233 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.847 | L2-Norm(final)=9.667 | 5454.6 samples/s | 85.2 steps/s
[Step=10500 Epoch=40.4] | Loss=0.00238 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.847 | L2-Norm(final)=9.684 | 6408.0 samples/s | 100.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=40.4] | Loss=0.00067 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.847 | L2-Norm(final)=9.860 | 4040.7 samples/s | 63.1 steps/s
[Step=10550 Epoch=40.6] | Loss=0.00183 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.860 | L2-Norm(final)=9.872 | 4268.2 samples/s | 66.7 steps/s
[Step=10600 Epoch=40.8] | Loss=0.00229 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.895 | L2-Norm(final)=9.876 | 4784.4 samples/s | 74.8 steps/s
[Step=10650 Epoch=41.0] | Loss=0.00409 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.937 | L2-Norm(final)=9.872 | 4764.6 samples/s | 74.4 steps/s
[Step=10700 Epoch=41.2] | Loss=0.00467 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.988 | L2-Norm(final)=9.863 | 4732.0 samples/s | 73.9 steps/s
[Step=10750 Epoch=41.4] | Loss=0.00401 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.027 | L2-Norm(final)=9.856 | 6178.1 samples/s | 96.5 steps/s
[Step=10800 Epoch=41.6] | Loss=0.00336 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.052 | L2-Norm(final)=9.851 | 1875.1 samples/s | 29.3 steps/s
[Step=10850 Epoch=41.8] | Loss=0.00290 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.067 | L2-Norm(final)=9.849 | 4819.5 samples/s | 75.3 steps/s
[Step=10900 Epoch=42.0] | Loss=0.00257 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.076 | L2-Norm(final)=9.847 | 4777.2 samples/s | 74.6 steps/s
[Step=10950 Epoch=42.2] | Loss=0.00241 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.082 | L2-Norm(final)=9.846 | 4713.2 samples/s | 73.6 steps/s
[Step=11000 Epoch=42.3] | Loss=0.00249 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.091 | L2-Norm(final)=9.844 | 5491.7 samples/s | 85.8 steps/s
[Step=11050 Epoch=42.5] | Loss=0.00253 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.104 | L2-Norm(final)=9.840 | 1347.6 samples/s | 21.1 steps/s
[Step=11100 Epoch=42.7] | Loss=0.00238 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.114 | L2-Norm(final)=9.836 | 4827.0 samples/s | 75.4 steps/s
[Step=11150 Epoch=42.9] | Loss=0.00221 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.122 | L2-Norm(final)=9.833 | 4479.4 samples/s | 70.0 steps/s
[Step=11200 Epoch=43.1] | Loss=0.00206 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.127 | L2-Norm(final)=9.831 | 4760.6 samples/s | 74.4 steps/s
[Step=11250 Epoch=43.3] | Loss=0.00192 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.129 | L2-Norm(final)=9.829 | 4457.4 samples/s | 69.6 steps/s
[Step=11300 Epoch=43.5] | Loss=0.00180 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.130 | L2-Norm(final)=9.828 | 2021.2 samples/s | 31.6 steps/s
[Step=11350 Epoch=43.7] | Loss=0.00170 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.130 | L2-Norm(final)=9.827 | 4814.1 samples/s | 75.2 steps/s
[Step=11400 Epoch=43.9] | Loss=0.00160 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.128 | L2-Norm(final)=9.826 | 4780.7 samples/s | 74.7 steps/s
[Step=11450 Epoch=44.1] | Loss=0.00152 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.125 | L2-Norm(final)=9.825 | 4764.1 samples/s | 74.4 steps/s
[Step=11500 Epoch=44.3] | Loss=0.00144 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=9.824 | 4869.5 samples/s | 76.1 steps/s
[Step=11550 Epoch=44.5] | Loss=0.00138 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.117 | L2-Norm(final)=9.823 | 2051.1 samples/s | 32.0 steps/s
[Step=11600 Epoch=44.7] | Loss=0.00131 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.112 | L2-Norm(final)=9.823 | 4779.9 samples/s | 74.7 steps/s
[Step=11650 Epoch=44.8] | Loss=0.00126 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.106 | L2-Norm(final)=9.822 | 4825.5 samples/s | 75.4 steps/s
[Step=11700 Epoch=45.0] | Loss=0.00120 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.100 | L2-Norm(final)=9.822 | 4743.9 samples/s | 74.1 steps/s
[Step=11750 Epoch=45.2] | Loss=0.00116 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=9.822 | 4773.9 samples/s | 74.6 steps/s
[Step=11800 Epoch=45.4] | Loss=0.00111 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.086 | L2-Norm(final)=9.821 | 7026.4 samples/s | 109.8 steps/s
[Step=11850 Epoch=45.6] | Loss=0.00107 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.078 | L2-Norm(final)=9.821 | 1828.9 samples/s | 28.6 steps/s
[Step=11900 Epoch=45.8] | Loss=0.00103 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.071 | L2-Norm(final)=9.821 | 4665.2 samples/s | 72.9 steps/s
[Step=11950 Epoch=46.0] | Loss=0.00100 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.062 | L2-Norm(final)=9.821 | 4833.8 samples/s | 75.5 steps/s
[Step=12000 Epoch=46.2] | Loss=0.00096 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.054 | L2-Norm(final)=9.821 | 4812.9 samples/s | 75.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_1/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06502 | acc=0.9649 | tpr=0.9699 | fpr=0.0458 | 4204.9 samples/s | 16.4 steps/s
Avg test loss: 0.06912, Avg test acc: 0.96390, Avg tpr: 0.96841, Avg fpr: 0.04602, total FA: 359

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06747 | acc=0.9645 | tpr=0.9777 | fpr=0.0644 | 4122.2 samples/s | 16.1 steps/s
Avg test loss: 0.07383, Avg test acc: 0.96366, Avg tpr: 0.97715, Avg fpr: 0.06602, total FA: 515

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.64863 | acc=0.3173 | tpr=0.0139 | fpr=0.0238 | 4215.5 samples/s | 16.5 steps/s
Avg test loss: 5.66638, Avg test acc: 0.31441, Avg tpr: 0.01335, Avg fpr: 0.02346, total FA: 183

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.58517 | acc=0.3115 | tpr=0.0201 | fpr=0.0557 | 4232.9 samples/s | 16.5 steps/s
Avg test loss: 5.59446, Avg test acc: 0.30956, Avg tpr: 0.01871, Avg fpr: 0.05076, total FA: 396

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.43708 | acc=0.1241 | tpr=0.8584 | fpr=0.8891 | 4174.3 samples/s | 16.3 steps/s
[Step= 100] | Loss=5.42702 | acc=0.1261 | tpr=0.8614 | fpr=0.8877 | 8483.4 samples/s | 33.1 steps/s
[Step= 150] | Loss=5.44647 | acc=0.1251 | tpr=0.8631 | fpr=0.8885 | 8646.5 samples/s | 33.8 steps/s
[Step= 200] | Loss=5.45128 | acc=0.1246 | tpr=0.8568 | fpr=0.8888 | 8285.6 samples/s | 32.4 steps/s
[Step= 250] | Loss=5.44639 | acc=0.1253 | tpr=0.8533 | fpr=0.8879 | 8455.3 samples/s | 33.0 steps/s
[Step= 300] | Loss=5.44947 | acc=0.1254 | tpr=0.8480 | fpr=0.8877 | 8152.2 samples/s | 31.8 steps/s
[Step= 350] | Loss=5.45125 | acc=0.1252 | tpr=0.8491 | fpr=0.8879 | 8219.4 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.45490 | acc=0.1257 | tpr=0.8496 | fpr=0.8875 | 8352.8 samples/s | 32.6 steps/s
[Step= 450] | Loss=5.45499 | acc=0.1255 | tpr=0.8481 | fpr=0.8876 | 8396.0 samples/s | 32.8 steps/s
[Step= 500] | Loss=5.45556 | acc=0.1256 | tpr=0.8507 | fpr=0.8875 | 8032.3 samples/s | 31.4 steps/s
[Step= 550] | Loss=5.45505 | acc=0.1257 | tpr=0.8496 | fpr=0.8875 | 15498.3 samples/s | 60.5 steps/s
Avg test loss: 5.45645, Avg test acc: 0.12562, Avg tpr: 0.85024, Avg fpr: 0.88755, total FA: 123235

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.91896 | acc=0.1041 | tpr=0.9381 | fpr=0.9108 | 4207.5 samples/s | 16.4 steps/s
[Step= 100] | Loss=5.88878 | acc=0.1064 | tpr=0.9403 | fpr=0.9092 | 8249.8 samples/s | 32.2 steps/s
[Step= 150] | Loss=5.90513 | acc=0.1063 | tpr=0.9337 | fpr=0.9089 | 8690.3 samples/s | 33.9 steps/s
[Step= 200] | Loss=5.90599 | acc=0.1063 | tpr=0.9301 | fpr=0.9086 | 8165.8 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.90418 | acc=0.1072 | tpr=0.9319 | fpr=0.9078 | 8171.5 samples/s | 31.9 steps/s
[Step= 300] | Loss=5.90564 | acc=0.1072 | tpr=0.9265 | fpr=0.9077 | 8565.0 samples/s | 33.5 steps/s
[Step= 350] | Loss=5.90252 | acc=0.1067 | tpr=0.9242 | fpr=0.9082 | 8222.4 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.90533 | acc=0.1070 | tpr=0.9240 | fpr=0.9079 | 8413.4 samples/s | 32.9 steps/s
[Step= 450] | Loss=5.90666 | acc=0.1069 | tpr=0.9260 | fpr=0.9080 | 8402.4 samples/s | 32.8 steps/s
[Step= 500] | Loss=5.90656 | acc=0.1071 | tpr=0.9269 | fpr=0.9077 | 8088.8 samples/s | 31.6 steps/s
[Step= 550] | Loss=5.90548 | acc=0.1072 | tpr=0.9280 | fpr=0.9077 | 15054.8 samples/s | 58.8 steps/s
Avg test loss: 5.90618, Avg test acc: 0.10715, Avg tpr: 0.92829, Avg fpr: 0.90778, total FA: 126043

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12996 | acc=0.9811 | tpr=0.9469 | fpr=0.0183 | 4191.2 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.13855 | acc=0.9802 | tpr=0.9510 | fpr=0.0193 | 8447.2 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.14459 | acc=0.9794 | tpr=0.9467 | fpr=0.0200 | 8076.7 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.14760 | acc=0.9794 | tpr=0.9486 | fpr=0.0200 | 8596.8 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.14515 | acc=0.9795 | tpr=0.9459 | fpr=0.0199 | 8151.5 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.14862 | acc=0.9792 | tpr=0.9440 | fpr=0.0201 | 8302.1 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.14917 | acc=0.9790 | tpr=0.9461 | fpr=0.0205 | 8552.7 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.15055 | acc=0.9786 | tpr=0.9415 | fpr=0.0207 | 8010.7 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.15319 | acc=0.9783 | tpr=0.9391 | fpr=0.0210 | 8320.2 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.15246 | acc=0.9784 | tpr=0.9392 | fpr=0.0209 | 8254.6 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.15103 | acc=0.9785 | tpr=0.9387 | fpr=0.0208 | 15092.6 samples/s | 59.0 steps/s
Avg test loss: 0.15080, Avg test acc: 0.97854, Avg tpr: 0.93859, Avg fpr: 0.02073, total FA: 2879

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11529 | acc=0.9815 | tpr=0.9292 | fpr=0.0176 | 4119.0 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.12027 | acc=0.9815 | tpr=0.9403 | fpr=0.0177 | 8117.2 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.12460 | acc=0.9806 | tpr=0.9424 | fpr=0.0187 | 8731.1 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.12627 | acc=0.9807 | tpr=0.9443 | fpr=0.0186 | 8059.0 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.12487 | acc=0.9806 | tpr=0.9424 | fpr=0.0187 | 8603.8 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.12714 | acc=0.9803 | tpr=0.9396 | fpr=0.0190 | 7839.9 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.12753 | acc=0.9803 | tpr=0.9436 | fpr=0.0190 | 8328.6 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.12770 | acc=0.9802 | tpr=0.9398 | fpr=0.0190 | 8445.8 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.12980 | acc=0.9800 | tpr=0.9396 | fpr=0.0192 | 8268.9 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.12962 | acc=0.9801 | tpr=0.9410 | fpr=0.0191 | 8224.8 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.12868 | acc=0.9803 | tpr=0.9403 | fpr=0.0190 | 15285.0 samples/s | 59.7 steps/s
Avg test loss: 0.12859, Avg test acc: 0.98030, Avg tpr: 0.94017, Avg fpr: 0.01897, total FA: 2634

server round 14/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=31.3] | Loss=0.03349 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.816 | L2-Norm(final)=9.207 | 3991.8 samples/s | 62.4 steps/s
[Step=16050 Epoch=31.4] | Loss=0.03755 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.819 | L2-Norm(final)=9.205 | 5186.3 samples/s | 81.0 steps/s
[Step=16100 Epoch=31.5] | Loss=0.03640 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.820 | L2-Norm(final)=9.206 | 5825.1 samples/s | 91.0 steps/s
[Step=16150 Epoch=31.6] | Loss=0.03731 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.820 | L2-Norm(final)=9.210 | 5674.0 samples/s | 88.7 steps/s
[Step=16200 Epoch=31.7] | Loss=0.03775 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.820 | L2-Norm(final)=9.214 | 5877.6 samples/s | 91.8 steps/s
[Step=16250 Epoch=31.8] | Loss=0.03749 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.820 | L2-Norm(final)=9.217 | 5722.8 samples/s | 89.4 steps/s
[Step=16300 Epoch=31.9] | Loss=0.03807 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.820 | L2-Norm(final)=9.222 | 5758.4 samples/s | 90.0 steps/s
[Step=16350 Epoch=32.0] | Loss=0.03822 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.820 | L2-Norm(final)=9.226 | 5791.0 samples/s | 90.5 steps/s
[Step=16400 Epoch=32.1] | Loss=0.03796 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.820 | L2-Norm(final)=9.230 | 5996.5 samples/s | 93.7 steps/s
[Step=16450 Epoch=32.2] | Loss=0.03773 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.820 | L2-Norm(final)=9.235 | 5672.4 samples/s | 88.6 steps/s
[Step=16500 Epoch=32.3] | Loss=0.03766 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.820 | L2-Norm(final)=9.241 | 7528.0 samples/s | 117.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=32.3] | Loss=0.03347 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.821 | L2-Norm(final)=9.291 | 3835.8 samples/s | 59.9 steps/s
[Step=16550 Epoch=32.4] | Loss=0.03148 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.885 | L2-Norm(final)=9.294 | 5010.0 samples/s | 78.3 steps/s
[Step=16600 Epoch=32.5] | Loss=0.03162 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.941 | L2-Norm(final)=9.293 | 4985.1 samples/s | 77.9 steps/s
[Step=16650 Epoch=32.6] | Loss=0.03214 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.982 | L2-Norm(final)=9.287 | 5024.0 samples/s | 78.5 steps/s
[Step=16700 Epoch=32.6] | Loss=0.03112 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.016 | L2-Norm(final)=9.282 | 5034.6 samples/s | 78.7 steps/s
[Step=16750 Epoch=32.7] | Loss=0.03050 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.046 | L2-Norm(final)=9.279 | 5044.4 samples/s | 78.8 steps/s
[Step=16800 Epoch=32.8] | Loss=0.02949 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.073 | L2-Norm(final)=9.276 | 5048.3 samples/s | 78.9 steps/s
[Step=16850 Epoch=32.9] | Loss=0.02932 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.098 | L2-Norm(final)=9.273 | 5086.6 samples/s | 79.5 steps/s
[Step=16900 Epoch=33.0] | Loss=0.02915 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=9.270 | 5004.5 samples/s | 78.2 steps/s
[Step=16950 Epoch=33.1] | Loss=0.02815 | Reg=0.00200 | acc=0.9531 | L2-Norm=14.142 | L2-Norm(final)=9.268 | 5028.1 samples/s | 78.6 steps/s
[Step=17000 Epoch=33.2] | Loss=0.02734 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.162 | L2-Norm(final)=9.267 | 6222.8 samples/s | 97.2 steps/s
[Step=17050 Epoch=33.3] | Loss=0.02646 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.180 | L2-Norm(final)=9.266 | 1942.1 samples/s | 30.3 steps/s
[Step=17100 Epoch=33.4] | Loss=0.02543 | Reg=0.00202 | acc=0.9688 | L2-Norm=14.197 | L2-Norm(final)=9.266 | 5011.6 samples/s | 78.3 steps/s
[Step=17150 Epoch=33.5] | Loss=0.02495 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.213 | L2-Norm(final)=9.267 | 5026.9 samples/s | 78.5 steps/s
[Step=17200 Epoch=33.6] | Loss=0.02424 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.228 | L2-Norm(final)=9.267 | 5118.3 samples/s | 80.0 steps/s
[Step=17250 Epoch=33.7] | Loss=0.02366 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.241 | L2-Norm(final)=9.268 | 4973.9 samples/s | 77.7 steps/s
[Step=17300 Epoch=33.8] | Loss=0.02313 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.254 | L2-Norm(final)=9.270 | 5038.0 samples/s | 78.7 steps/s
[Step=17350 Epoch=33.9] | Loss=0.02300 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.267 | L2-Norm(final)=9.270 | 5039.2 samples/s | 78.7 steps/s
[Step=17400 Epoch=34.0] | Loss=0.02260 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.280 | L2-Norm(final)=9.271 | 5021.3 samples/s | 78.5 steps/s
[Step=17450 Epoch=34.1] | Loss=0.02239 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.292 | L2-Norm(final)=9.271 | 4994.7 samples/s | 78.0 steps/s
[Step=17500 Epoch=34.2] | Loss=0.02194 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.304 | L2-Norm(final)=9.271 | 5479.0 samples/s | 85.6 steps/s
[Step=17550 Epoch=34.3] | Loss=0.02151 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.316 | L2-Norm(final)=9.272 | 2040.1 samples/s | 31.9 steps/s
[Step=17600 Epoch=34.4] | Loss=0.02104 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.327 | L2-Norm(final)=9.273 | 5052.9 samples/s | 79.0 steps/s
[Step=17650 Epoch=34.5] | Loss=0.02073 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.337 | L2-Norm(final)=9.274 | 4954.6 samples/s | 77.4 steps/s
[Step=17700 Epoch=34.6] | Loss=0.02044 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.347 | L2-Norm(final)=9.274 | 5062.1 samples/s | 79.1 steps/s
[Step=17750 Epoch=34.7] | Loss=0.02018 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.356 | L2-Norm(final)=9.275 | 4988.6 samples/s | 77.9 steps/s
[Step=17800 Epoch=34.8] | Loss=0.01979 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.365 | L2-Norm(final)=9.276 | 5032.4 samples/s | 78.6 steps/s
[Step=17850 Epoch=34.9] | Loss=0.01955 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.373 | L2-Norm(final)=9.277 | 5000.9 samples/s | 78.1 steps/s
[Step=17900 Epoch=35.0] | Loss=0.01936 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.382 | L2-Norm(final)=9.279 | 5077.1 samples/s | 79.3 steps/s
[Step=17950 Epoch=35.1] | Loss=0.01899 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.390 | L2-Norm(final)=9.280 | 5071.9 samples/s | 79.2 steps/s
[Step=18000 Epoch=35.2] | Loss=0.01882 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.398 | L2-Norm(final)=9.281 | 4960.0 samples/s | 77.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step18000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=46.2] | Loss=0.00023 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.816 | L2-Norm(final)=9.819 | 3486.0 samples/s | 54.5 steps/s
[Step=12050 Epoch=46.4] | Loss=0.00130 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.812 | L2-Norm(final)=9.830 | 5453.8 samples/s | 85.2 steps/s
[Step=12100 Epoch=46.6] | Loss=0.00154 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.812 | L2-Norm(final)=9.845 | 5514.3 samples/s | 86.2 steps/s
[Step=12150 Epoch=46.8] | Loss=0.00142 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.812 | L2-Norm(final)=9.863 | 5274.5 samples/s | 82.4 steps/s
[Step=12200 Epoch=47.0] | Loss=0.00143 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.812 | L2-Norm(final)=9.879 | 5543.6 samples/s | 86.6 steps/s
[Step=12250 Epoch=47.2] | Loss=0.00140 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.812 | L2-Norm(final)=9.896 | 7434.8 samples/s | 116.2 steps/s
[Step=12300 Epoch=47.3] | Loss=0.00142 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.812 | L2-Norm(final)=9.913 | 1958.2 samples/s | 30.6 steps/s
[Step=12350 Epoch=47.5] | Loss=0.00135 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.811 | L2-Norm(final)=9.931 | 5455.2 samples/s | 85.2 steps/s
[Step=12400 Epoch=47.7] | Loss=0.00132 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.811 | L2-Norm(final)=9.948 | 5444.8 samples/s | 85.1 steps/s
[Step=12450 Epoch=47.9] | Loss=0.00137 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.811 | L2-Norm(final)=9.966 | 5544.2 samples/s | 86.6 steps/s
[Step=12500 Epoch=48.1] | Loss=0.00135 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.811 | L2-Norm(final)=9.983 | 6279.7 samples/s | 98.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=48.1] | Loss=0.00123 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.811 | L2-Norm(final)=10.162 | 3946.8 samples/s | 61.7 steps/s
[Step=12550 Epoch=48.3] | Loss=0.00300 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.837 | L2-Norm(final)=10.173 | 4393.6 samples/s | 68.6 steps/s
[Step=12600 Epoch=48.5] | Loss=0.00549 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.898 | L2-Norm(final)=10.163 | 4803.8 samples/s | 75.1 steps/s
[Step=12650 Epoch=48.7] | Loss=0.00464 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.956 | L2-Norm(final)=10.153 | 4784.9 samples/s | 74.8 steps/s
[Step=12700 Epoch=48.9] | Loss=0.00357 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.991 | L2-Norm(final)=10.152 | 4769.3 samples/s | 74.5 steps/s
[Step=12750 Epoch=49.1] | Loss=0.00291 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.008 | L2-Norm(final)=10.153 | 6118.7 samples/s | 95.6 steps/s
[Step=12800 Epoch=49.3] | Loss=0.00243 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.017 | L2-Norm(final)=10.154 | 1889.5 samples/s | 29.5 steps/s
[Step=12850 Epoch=49.5] | Loss=0.00209 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.019 | L2-Norm(final)=10.156 | 4698.3 samples/s | 73.4 steps/s
[Step=12900 Epoch=49.7] | Loss=0.00184 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.016 | L2-Norm(final)=10.157 | 4808.8 samples/s | 75.1 steps/s
[Step=12950 Epoch=49.8] | Loss=0.00163 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.011 | L2-Norm(final)=10.159 | 4793.6 samples/s | 74.9 steps/s
[Step=13000 Epoch=50.0] | Loss=0.00147 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.005 | L2-Norm(final)=10.160 | 5423.2 samples/s | 84.7 steps/s
[Step=13050 Epoch=50.2] | Loss=0.00134 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.997 | L2-Norm(final)=10.161 | 1962.3 samples/s | 30.7 steps/s
[Step=13100 Epoch=50.4] | Loss=0.00123 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.987 | L2-Norm(final)=10.162 | 4722.5 samples/s | 73.8 steps/s
[Step=13150 Epoch=50.6] | Loss=0.00114 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.978 | L2-Norm(final)=10.164 | 4761.0 samples/s | 74.4 steps/s
[Step=13200 Epoch=50.8] | Loss=0.00106 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.967 | L2-Norm(final)=10.165 | 4826.2 samples/s | 75.4 steps/s
[Step=13250 Epoch=51.0] | Loss=0.00099 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.956 | L2-Norm(final)=10.166 | 4776.5 samples/s | 74.6 steps/s
[Step=13300 Epoch=51.2] | Loss=0.00092 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.945 | L2-Norm(final)=10.167 | 2000.9 samples/s | 31.3 steps/s
[Step=13350 Epoch=51.4] | Loss=0.00087 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.934 | L2-Norm(final)=10.168 | 4926.9 samples/s | 77.0 steps/s
[Step=13400 Epoch=51.6] | Loss=0.00082 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.922 | L2-Norm(final)=10.168 | 4826.3 samples/s | 75.4 steps/s
[Step=13450 Epoch=51.8] | Loss=0.00078 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.910 | L2-Norm(final)=10.169 | 4749.6 samples/s | 74.2 steps/s
[Step=13500 Epoch=52.0] | Loss=0.00074 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.898 | L2-Norm(final)=10.170 | 4757.9 samples/s | 74.3 steps/s
[Step=13550 Epoch=52.2] | Loss=0.00071 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.885 | L2-Norm(final)=10.171 | 2018.5 samples/s | 31.5 steps/s
[Step=13600 Epoch=52.4] | Loss=0.00067 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.873 | L2-Norm(final)=10.172 | 4839.5 samples/s | 75.6 steps/s
[Step=13650 Epoch=52.5] | Loss=0.00064 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.860 | L2-Norm(final)=10.173 | 4753.6 samples/s | 74.3 steps/s
[Step=13700 Epoch=52.7] | Loss=0.00062 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.847 | L2-Norm(final)=10.173 | 4780.4 samples/s | 74.7 steps/s
[Step=13750 Epoch=52.9] | Loss=0.00059 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.835 | L2-Norm(final)=10.174 | 4751.6 samples/s | 74.2 steps/s
[Step=13800 Epoch=53.1] | Loss=0.00057 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.822 | L2-Norm(final)=10.175 | 7070.2 samples/s | 110.5 steps/s
[Step=13850 Epoch=53.3] | Loss=0.00055 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.809 | L2-Norm(final)=10.176 | 1807.9 samples/s | 28.2 steps/s
[Step=13900 Epoch=53.5] | Loss=0.00053 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.796 | L2-Norm(final)=10.176 | 4758.9 samples/s | 74.4 steps/s
[Step=13950 Epoch=53.7] | Loss=0.00051 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.783 | L2-Norm(final)=10.177 | 4742.1 samples/s | 74.1 steps/s
[Step=14000 Epoch=53.9] | Loss=0.00050 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.769 | L2-Norm(final)=10.178 | 4825.7 samples/s | 75.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_1/client_state-step14000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06502 | acc=0.9649 | tpr=0.9699 | fpr=0.0458 | 4109.5 samples/s | 16.1 steps/s
Avg test loss: 0.06912, Avg test acc: 0.96390, Avg tpr: 0.96841, Avg fpr: 0.04602, total FA: 359

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06619 | acc=0.9643 | tpr=0.9694 | fpr=0.0468 | 4216.2 samples/s | 16.5 steps/s
Avg test loss: 0.07179, Avg test acc: 0.96334, Avg tpr: 0.96870, Avg fpr: 0.04846, total FA: 378

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.64863 | acc=0.3173 | tpr=0.0139 | fpr=0.0238 | 4204.7 samples/s | 16.4 steps/s
Avg test loss: 5.66638, Avg test acc: 0.31441, Avg tpr: 0.01335, Avg fpr: 0.02346, total FA: 183

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.24949 | acc=0.3195 | tpr=0.0230 | fpr=0.0367 | 4251.2 samples/s | 16.6 steps/s
Avg test loss: 5.26174, Avg test acc: 0.31745, Avg tpr: 0.02267, Avg fpr: 0.03423, total FA: 267

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.43708 | acc=0.1241 | tpr=0.8584 | fpr=0.8891 | 4183.8 samples/s | 16.3 steps/s
[Step= 100] | Loss=5.42702 | acc=0.1261 | tpr=0.8614 | fpr=0.8877 | 7821.3 samples/s | 30.6 steps/s
[Step= 150] | Loss=5.44647 | acc=0.1251 | tpr=0.8631 | fpr=0.8885 | 8455.4 samples/s | 33.0 steps/s
[Step= 200] | Loss=5.45128 | acc=0.1246 | tpr=0.8568 | fpr=0.8888 | 8225.5 samples/s | 32.1 steps/s
[Step= 250] | Loss=5.44639 | acc=0.1253 | tpr=0.8533 | fpr=0.8879 | 8360.4 samples/s | 32.7 steps/s
[Step= 300] | Loss=5.44947 | acc=0.1254 | tpr=0.8480 | fpr=0.8877 | 8175.5 samples/s | 31.9 steps/s
[Step= 350] | Loss=5.45125 | acc=0.1252 | tpr=0.8491 | fpr=0.8879 | 8335.4 samples/s | 32.6 steps/s
[Step= 400] | Loss=5.45490 | acc=0.1257 | tpr=0.8496 | fpr=0.8875 | 8252.9 samples/s | 32.2 steps/s
[Step= 450] | Loss=5.45499 | acc=0.1255 | tpr=0.8481 | fpr=0.8876 | 8425.5 samples/s | 32.9 steps/s
[Step= 500] | Loss=5.45556 | acc=0.1256 | tpr=0.8507 | fpr=0.8875 | 8278.3 samples/s | 32.3 steps/s
[Step= 550] | Loss=5.45505 | acc=0.1257 | tpr=0.8496 | fpr=0.8875 | 14964.3 samples/s | 58.5 steps/s
Avg test loss: 5.45645, Avg test acc: 0.12562, Avg tpr: 0.85024, Avg fpr: 0.88755, total FA: 123235

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.22935 | acc=0.1194 | tpr=0.8938 | fpr=0.8945 | 4234.0 samples/s | 16.5 steps/s
[Step= 100] | Loss=5.20413 | acc=0.1223 | tpr=0.8934 | fpr=0.8920 | 8028.0 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.22421 | acc=0.1208 | tpr=0.8876 | fpr=0.8933 | 8514.9 samples/s | 33.3 steps/s
[Step= 200] | Loss=5.22513 | acc=0.1209 | tpr=0.8852 | fpr=0.8930 | 8391.2 samples/s | 32.8 steps/s
[Step= 250] | Loss=5.22537 | acc=0.1216 | tpr=0.8900 | fpr=0.8924 | 8134.9 samples/s | 31.8 steps/s
[Step= 300] | Loss=5.22839 | acc=0.1217 | tpr=0.8865 | fpr=0.8922 | 8248.4 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.22392 | acc=0.1210 | tpr=0.8854 | fpr=0.8929 | 8152.1 samples/s | 31.8 steps/s
[Step= 400] | Loss=5.22427 | acc=0.1215 | tpr=0.8868 | fpr=0.8924 | 8281.4 samples/s | 32.3 steps/s
[Step= 450] | Loss=5.22516 | acc=0.1212 | tpr=0.8885 | fpr=0.8927 | 8385.1 samples/s | 32.8 steps/s
[Step= 500] | Loss=5.22526 | acc=0.1214 | tpr=0.8907 | fpr=0.8925 | 8164.6 samples/s | 31.9 steps/s
[Step= 550] | Loss=5.22671 | acc=0.1215 | tpr=0.8894 | fpr=0.8924 | 14594.8 samples/s | 57.0 steps/s
Avg test loss: 5.22723, Avg test acc: 0.12150, Avg tpr: 0.88906, Avg fpr: 0.89246, total FA: 123916

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12996 | acc=0.9811 | tpr=0.9469 | fpr=0.0183 | 4154.8 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.13855 | acc=0.9802 | tpr=0.9510 | fpr=0.0193 | 8444.4 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.14459 | acc=0.9794 | tpr=0.9467 | fpr=0.0200 | 8072.8 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.14760 | acc=0.9794 | tpr=0.9486 | fpr=0.0200 | 8535.1 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.14515 | acc=0.9795 | tpr=0.9459 | fpr=0.0199 | 8190.4 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.14862 | acc=0.9792 | tpr=0.9440 | fpr=0.0201 | 8270.0 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.14917 | acc=0.9790 | tpr=0.9461 | fpr=0.0205 | 8279.8 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.15055 | acc=0.9786 | tpr=0.9415 | fpr=0.0207 | 8321.9 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.15319 | acc=0.9783 | tpr=0.9391 | fpr=0.0210 | 8404.8 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.15246 | acc=0.9784 | tpr=0.9392 | fpr=0.0209 | 8344.1 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.15103 | acc=0.9785 | tpr=0.9387 | fpr=0.0208 | 14984.0 samples/s | 58.5 steps/s
Avg test loss: 0.15080, Avg test acc: 0.97854, Avg tpr: 0.93859, Avg fpr: 0.02073, total FA: 2879

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14058 | acc=0.9795 | tpr=0.9558 | fpr=0.0200 | 4199.4 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.14614 | acc=0.9788 | tpr=0.9446 | fpr=0.0206 | 8369.2 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.15243 | acc=0.9776 | tpr=0.9510 | fpr=0.0219 | 8097.2 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.15512 | acc=0.9775 | tpr=0.9552 | fpr=0.0221 | 7797.7 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.15247 | acc=0.9775 | tpr=0.9546 | fpr=0.0220 | 8816.7 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.15578 | acc=0.9771 | tpr=0.9527 | fpr=0.0224 | 7955.9 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.15605 | acc=0.9771 | tpr=0.9537 | fpr=0.0225 | 8277.1 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.15658 | acc=0.9769 | tpr=0.9502 | fpr=0.0226 | 8316.7 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.15949 | acc=0.9767 | tpr=0.9474 | fpr=0.0228 | 8117.5 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.15895 | acc=0.9769 | tpr=0.9480 | fpr=0.0226 | 8172.1 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.15725 | acc=0.9770 | tpr=0.9439 | fpr=0.0224 | 15444.1 samples/s | 60.3 steps/s
Avg test loss: 0.15705, Avg test acc: 0.97697, Avg tpr: 0.94374, Avg fpr: 0.02243, total FA: 3114

server round 15/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=12001 Epoch=46.0] | Loss=0.00157 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.720 | L2-Norm(final)=9.293 | 3718.4 samples/s | 58.1 steps/s
[Step=12050 Epoch=46.2] | Loss=0.00257 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.715 | L2-Norm(final)=9.311 | 5258.8 samples/s | 82.2 steps/s
[Step=12100 Epoch=46.4] | Loss=0.00345 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.715 | L2-Norm(final)=9.334 | 5373.7 samples/s | 84.0 steps/s
[Step=12150 Epoch=46.6] | Loss=0.00305 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=9.356 | 5547.7 samples/s | 86.7 steps/s
[Step=12200 Epoch=46.7] | Loss=0.00282 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=9.376 | 5487.7 samples/s | 85.7 steps/s
[Step=12250 Epoch=46.9] | Loss=0.00266 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=9.394 | 7071.6 samples/s | 110.5 steps/s
[Step=12300 Epoch=47.1] | Loss=0.00266 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=9.411 | 1960.2 samples/s | 30.6 steps/s
[Step=12350 Epoch=47.3] | Loss=0.00261 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=9.426 | 5517.4 samples/s | 86.2 steps/s
[Step=12400 Epoch=47.5] | Loss=0.00253 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=9.440 | 5459.0 samples/s | 85.3 steps/s
[Step=12450 Epoch=47.7] | Loss=0.00254 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.714 | L2-Norm(final)=9.453 | 5489.1 samples/s | 85.8 steps/s
[Step=12500 Epoch=47.9] | Loss=0.00240 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=9.465 | 6143.6 samples/s | 96.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=47.9] | Loss=0.00130 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=9.591 | 3877.8 samples/s | 60.6 steps/s
[Step=12550 Epoch=48.1] | Loss=0.00628 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.801 | L2-Norm(final)=9.592 | 4370.6 samples/s | 68.3 steps/s
[Step=12600 Epoch=48.3] | Loss=0.00682 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.913 | L2-Norm(final)=9.572 | 4727.6 samples/s | 73.9 steps/s
[Step=12650 Epoch=48.5] | Loss=0.00591 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.981 | L2-Norm(final)=9.558 | 4891.6 samples/s | 76.4 steps/s
[Step=12700 Epoch=48.7] | Loss=0.00514 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.022 | L2-Norm(final)=9.549 | 4706.5 samples/s | 73.5 steps/s
[Step=12750 Epoch=48.9] | Loss=0.00451 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.049 | L2-Norm(final)=9.542 | 6019.7 samples/s | 94.1 steps/s
[Step=12800 Epoch=49.0] | Loss=0.00392 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.067 | L2-Norm(final)=9.537 | 1885.2 samples/s | 29.5 steps/s
[Step=12850 Epoch=49.2] | Loss=0.00337 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.076 | L2-Norm(final)=9.534 | 4755.1 samples/s | 74.3 steps/s
[Step=12900 Epoch=49.4] | Loss=0.00295 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.080 | L2-Norm(final)=9.532 | 4782.2 samples/s | 74.7 steps/s
[Step=12950 Epoch=49.6] | Loss=0.00269 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.081 | L2-Norm(final)=9.530 | 4770.0 samples/s | 74.5 steps/s
[Step=13000 Epoch=49.8] | Loss=0.00246 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.080 | L2-Norm(final)=9.529 | 5222.9 samples/s | 81.6 steps/s
[Step=13050 Epoch=50.0] | Loss=0.00224 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.078 | L2-Norm(final)=9.528 | 1941.0 samples/s | 30.3 steps/s
[Step=13100 Epoch=50.2] | Loss=0.00206 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.074 | L2-Norm(final)=9.528 | 4821.6 samples/s | 75.3 steps/s
[Step=13150 Epoch=50.4] | Loss=0.00190 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.069 | L2-Norm(final)=9.528 | 4671.3 samples/s | 73.0 steps/s
[Step=13200 Epoch=50.6] | Loss=0.00177 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.063 | L2-Norm(final)=9.528 | 4778.3 samples/s | 74.7 steps/s
[Step=13250 Epoch=50.8] | Loss=0.00165 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.056 | L2-Norm(final)=9.527 | 4909.6 samples/s | 76.7 steps/s
[Step=13300 Epoch=51.0] | Loss=0.00155 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.049 | L2-Norm(final)=9.527 | 1964.0 samples/s | 30.7 steps/s
[Step=13350 Epoch=51.2] | Loss=0.00146 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.041 | L2-Norm(final)=9.527 | 4756.3 samples/s | 74.3 steps/s
[Step=13400 Epoch=51.3] | Loss=0.00137 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.033 | L2-Norm(final)=9.527 | 4806.7 samples/s | 75.1 steps/s
[Step=13450 Epoch=51.5] | Loss=0.00130 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.024 | L2-Norm(final)=9.527 | 4723.3 samples/s | 73.8 steps/s
[Step=13500 Epoch=51.7] | Loss=0.00124 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.016 | L2-Norm(final)=9.528 | 4757.4 samples/s | 74.3 steps/s
[Step=13550 Epoch=51.9] | Loss=0.00118 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.007 | L2-Norm(final)=9.528 | 2049.7 samples/s | 32.0 steps/s
[Step=13600 Epoch=52.1] | Loss=0.00113 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.998 | L2-Norm(final)=9.528 | 4839.0 samples/s | 75.6 steps/s
[Step=13650 Epoch=52.3] | Loss=0.00108 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.988 | L2-Norm(final)=9.528 | 4669.1 samples/s | 73.0 steps/s
[Step=13700 Epoch=52.5] | Loss=0.00103 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.979 | L2-Norm(final)=9.528 | 4764.6 samples/s | 74.4 steps/s
[Step=13750 Epoch=52.7] | Loss=0.00099 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.969 | L2-Norm(final)=9.528 | 4737.5 samples/s | 74.0 steps/s
[Step=13800 Epoch=52.9] | Loss=0.00095 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.959 | L2-Norm(final)=9.528 | 6600.5 samples/s | 103.1 steps/s
[Step=13850 Epoch=53.1] | Loss=0.00092 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.949 | L2-Norm(final)=9.528 | 1843.7 samples/s | 28.8 steps/s
[Step=13900 Epoch=53.3] | Loss=0.00089 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.939 | L2-Norm(final)=9.529 | 4787.7 samples/s | 74.8 steps/s
[Step=13950 Epoch=53.5] | Loss=0.00086 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.929 | L2-Norm(final)=9.529 | 4766.0 samples/s | 74.5 steps/s
[Step=14000 Epoch=53.6] | Loss=0.00083 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.919 | L2-Norm(final)=9.529 | 4693.3 samples/s | 73.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step14000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=53.9] | Loss=0.00045 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.720 | L2-Norm(final)=10.199 | 3813.8 samples/s | 59.6 steps/s
[Step=14050 Epoch=54.1] | Loss=0.00149 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.716 | L2-Norm(final)=10.213 | 4721.2 samples/s | 73.8 steps/s
[Step=14100 Epoch=54.3] | Loss=0.00164 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.715 | L2-Norm(final)=10.233 | 5326.8 samples/s | 83.2 steps/s
[Step=14150 Epoch=54.5] | Loss=0.00149 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.715 | L2-Norm(final)=10.257 | 5329.9 samples/s | 83.3 steps/s
[Step=14200 Epoch=54.7] | Loss=0.00138 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.715 | L2-Norm(final)=10.280 | 5337.1 samples/s | 83.4 steps/s
[Step=14250 Epoch=54.9] | Loss=0.00144 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.715 | L2-Norm(final)=10.303 | 7351.9 samples/s | 114.9 steps/s
[Step=14300 Epoch=55.0] | Loss=0.00138 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.715 | L2-Norm(final)=10.326 | 1966.0 samples/s | 30.7 steps/s
[Step=14350 Epoch=55.2] | Loss=0.00137 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.715 | L2-Norm(final)=10.348 | 5581.6 samples/s | 87.2 steps/s
[Step=14400 Epoch=55.4] | Loss=0.00133 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.715 | L2-Norm(final)=10.371 | 5485.1 samples/s | 85.7 steps/s
[Step=14450 Epoch=55.6] | Loss=0.00135 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.715 | L2-Norm(final)=10.393 | 5563.4 samples/s | 86.9 steps/s
[Step=14500 Epoch=55.8] | Loss=0.00138 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.715 | L2-Norm(final)=10.415 | 6360.7 samples/s | 99.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=55.8] | Loss=0.00046 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.715 | L2-Norm(final)=10.629 | 4000.0 samples/s | 62.5 steps/s
[Step=14550 Epoch=56.0] | Loss=0.00496 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.776 | L2-Norm(final)=10.632 | 4366.2 samples/s | 68.2 steps/s
[Step=14600 Epoch=56.2] | Loss=0.00809 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.893 | L2-Norm(final)=10.616 | 4837.5 samples/s | 75.6 steps/s
[Step=14650 Epoch=56.4] | Loss=0.00741 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.999 | L2-Norm(final)=10.593 | 4770.0 samples/s | 74.5 steps/s
[Step=14700 Epoch=56.6] | Loss=0.00680 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.065 | L2-Norm(final)=10.579 | 4783.8 samples/s | 74.7 steps/s
[Step=14750 Epoch=56.8] | Loss=0.00578 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.106 | L2-Norm(final)=10.568 | 6111.5 samples/s | 95.5 steps/s
[Step=14800 Epoch=57.0] | Loss=0.00488 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.132 | L2-Norm(final)=10.561 | 1896.0 samples/s | 29.6 steps/s
[Step=14850 Epoch=57.2] | Loss=0.00420 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.148 | L2-Norm(final)=10.557 | 4783.2 samples/s | 74.7 steps/s
[Step=14900 Epoch=57.4] | Loss=0.00368 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.157 | L2-Norm(final)=10.554 | 4801.5 samples/s | 75.0 steps/s
[Step=14950 Epoch=57.5] | Loss=0.00327 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.161 | L2-Norm(final)=10.551 | 4821.8 samples/s | 75.3 steps/s
[Step=15000 Epoch=57.7] | Loss=0.00295 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.163 | L2-Norm(final)=10.550 | 5411.2 samples/s | 84.5 steps/s
[Step=15050 Epoch=57.9] | Loss=0.00269 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.162 | L2-Norm(final)=10.549 | 1988.2 samples/s | 31.1 steps/s
[Step=15100 Epoch=58.1] | Loss=0.00247 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.159 | L2-Norm(final)=10.548 | 4687.7 samples/s | 73.2 steps/s
[Step=15150 Epoch=58.3] | Loss=0.00228 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.155 | L2-Norm(final)=10.547 | 4793.6 samples/s | 74.9 steps/s
[Step=15200 Epoch=58.5] | Loss=0.00211 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.150 | L2-Norm(final)=10.547 | 4764.5 samples/s | 74.4 steps/s
[Step=15250 Epoch=58.7] | Loss=0.00197 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.144 | L2-Norm(final)=10.547 | 4901.1 samples/s | 76.6 steps/s
[Step=15300 Epoch=58.9] | Loss=0.00185 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.138 | L2-Norm(final)=10.546 | 2036.1 samples/s | 31.8 steps/s
[Step=15350 Epoch=59.1] | Loss=0.00174 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.131 | L2-Norm(final)=10.546 | 4810.8 samples/s | 75.2 steps/s
[Step=15400 Epoch=59.3] | Loss=0.00165 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.123 | L2-Norm(final)=10.546 | 4783.9 samples/s | 74.7 steps/s
[Step=15450 Epoch=59.5] | Loss=0.00156 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.115 | L2-Norm(final)=10.546 | 4815.3 samples/s | 75.2 steps/s
[Step=15500 Epoch=59.7] | Loss=0.00148 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.107 | L2-Norm(final)=10.547 | 4694.7 samples/s | 73.4 steps/s
[Step=15550 Epoch=59.9] | Loss=0.00141 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.099 | L2-Norm(final)=10.547 | 2050.7 samples/s | 32.0 steps/s
[Step=15600 Epoch=60.1] | Loss=0.00135 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.090 | L2-Norm(final)=10.547 | 4661.6 samples/s | 72.8 steps/s
[Step=15650 Epoch=60.2] | Loss=0.00129 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.082 | L2-Norm(final)=10.547 | 4755.5 samples/s | 74.3 steps/s
[Step=15700 Epoch=60.4] | Loss=0.00124 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.073 | L2-Norm(final)=10.547 | 4868.9 samples/s | 76.1 steps/s
[Step=15750 Epoch=60.6] | Loss=0.00119 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.064 | L2-Norm(final)=10.548 | 4713.1 samples/s | 73.6 steps/s
[Step=15800 Epoch=60.8] | Loss=0.00114 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.054 | L2-Norm(final)=10.548 | 6989.9 samples/s | 109.2 steps/s
[Step=15850 Epoch=61.0] | Loss=0.00110 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.045 | L2-Norm(final)=10.548 | 1802.6 samples/s | 28.2 steps/s
[Step=15900 Epoch=61.2] | Loss=0.00106 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.035 | L2-Norm(final)=10.549 | 4751.7 samples/s | 74.2 steps/s
[Step=15950 Epoch=61.4] | Loss=0.00102 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.026 | L2-Norm(final)=10.549 | 4790.5 samples/s | 74.9 steps/s
[Step=16000 Epoch=61.6] | Loss=0.00099 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.016 | L2-Norm(final)=10.549 | 4709.2 samples/s | 73.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_1/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06502 | acc=0.9649 | tpr=0.9699 | fpr=0.0458 | 4175.8 samples/s | 16.3 steps/s
Avg test loss: 0.06912, Avg test acc: 0.96390, Avg tpr: 0.96841, Avg fpr: 0.04602, total FA: 359

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06619 | acc=0.9643 | tpr=0.9694 | fpr=0.0468 | 4168.0 samples/s | 16.3 steps/s
Avg test loss: 0.07179, Avg test acc: 0.96334, Avg tpr: 0.96870, Avg fpr: 0.04846, total FA: 378

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.71417 | acc=0.3175 | tpr=0.0149 | fpr=0.0255 | 4125.4 samples/s | 16.1 steps/s
Avg test loss: 5.71079, Avg test acc: 0.31589, Avg tpr: 0.01533, Avg fpr: 0.02307, total FA: 180

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.30940 | acc=0.3151 | tpr=0.0212 | fpr=0.0468 | 4222.0 samples/s | 16.5 steps/s
Avg test loss: 5.32412, Avg test acc: 0.31313, Avg tpr: 0.02209, Avg fpr: 0.04679, total FA: 365

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.43708 | acc=0.1241 | tpr=0.8584 | fpr=0.8891 | 4153.0 samples/s | 16.2 steps/s
[Step= 100] | Loss=5.42702 | acc=0.1261 | tpr=0.8614 | fpr=0.8877 | 8366.5 samples/s | 32.7 steps/s
[Step= 150] | Loss=5.44647 | acc=0.1251 | tpr=0.8631 | fpr=0.8885 | 8273.7 samples/s | 32.3 steps/s
[Step= 200] | Loss=5.45128 | acc=0.1246 | tpr=0.8568 | fpr=0.8888 | 8410.4 samples/s | 32.9 steps/s
[Step= 250] | Loss=5.44639 | acc=0.1253 | tpr=0.8533 | fpr=0.8879 | 8478.9 samples/s | 33.1 steps/s
[Step= 300] | Loss=5.44947 | acc=0.1254 | tpr=0.8480 | fpr=0.8877 | 8159.7 samples/s | 31.9 steps/s
[Step= 350] | Loss=5.45125 | acc=0.1252 | tpr=0.8491 | fpr=0.8879 | 8331.4 samples/s | 32.5 steps/s
[Step= 400] | Loss=5.45490 | acc=0.1257 | tpr=0.8496 | fpr=0.8875 | 8308.3 samples/s | 32.5 steps/s
[Step= 450] | Loss=5.45499 | acc=0.1255 | tpr=0.8481 | fpr=0.8876 | 8361.5 samples/s | 32.7 steps/s
[Step= 500] | Loss=5.45556 | acc=0.1256 | tpr=0.8507 | fpr=0.8875 | 8000.1 samples/s | 31.3 steps/s
[Step= 550] | Loss=5.45505 | acc=0.1257 | tpr=0.8496 | fpr=0.8875 | 15294.0 samples/s | 59.7 steps/s
Avg test loss: 5.45645, Avg test acc: 0.12562, Avg tpr: 0.85024, Avg fpr: 0.88755, total FA: 123235

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.22935 | acc=0.1194 | tpr=0.8938 | fpr=0.8945 | 4204.2 samples/s | 16.4 steps/s
[Step= 100] | Loss=5.20413 | acc=0.1223 | tpr=0.8934 | fpr=0.8920 | 8451.1 samples/s | 33.0 steps/s
[Step= 150] | Loss=5.22421 | acc=0.1208 | tpr=0.8876 | fpr=0.8933 | 8330.7 samples/s | 32.5 steps/s
[Step= 200] | Loss=5.22513 | acc=0.1209 | tpr=0.8852 | fpr=0.8930 | 8113.7 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.22537 | acc=0.1216 | tpr=0.8900 | fpr=0.8924 | 8172.6 samples/s | 31.9 steps/s
[Step= 300] | Loss=5.22839 | acc=0.1217 | tpr=0.8865 | fpr=0.8922 | 8442.5 samples/s | 33.0 steps/s
[Step= 350] | Loss=5.22392 | acc=0.1210 | tpr=0.8854 | fpr=0.8929 | 8213.5 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.22427 | acc=0.1215 | tpr=0.8868 | fpr=0.8924 | 8478.7 samples/s | 33.1 steps/s
[Step= 450] | Loss=5.22516 | acc=0.1212 | tpr=0.8885 | fpr=0.8927 | 8161.8 samples/s | 31.9 steps/s
[Step= 500] | Loss=5.22526 | acc=0.1214 | tpr=0.8907 | fpr=0.8925 | 8367.6 samples/s | 32.7 steps/s
[Step= 550] | Loss=5.22671 | acc=0.1215 | tpr=0.8894 | fpr=0.8924 | 14853.1 samples/s | 58.0 steps/s
Avg test loss: 5.22723, Avg test acc: 0.12150, Avg tpr: 0.88906, Avg fpr: 0.89246, total FA: 123916

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12436 | acc=0.9819 | tpr=0.9513 | fpr=0.0176 | 4177.1 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.13256 | acc=0.9812 | tpr=0.9467 | fpr=0.0182 | 8204.2 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.13785 | acc=0.9802 | tpr=0.9438 | fpr=0.0191 | 8239.0 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.13884 | acc=0.9805 | tpr=0.9530 | fpr=0.0190 | 8296.1 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.13511 | acc=0.9804 | tpr=0.9467 | fpr=0.0189 | 8445.9 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.13833 | acc=0.9800 | tpr=0.9433 | fpr=0.0193 | 7989.3 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.13920 | acc=0.9800 | tpr=0.9436 | fpr=0.0194 | 8229.1 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.14008 | acc=0.9797 | tpr=0.9398 | fpr=0.0196 | 8506.2 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.14230 | acc=0.9795 | tpr=0.9367 | fpr=0.0198 | 8353.9 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.14189 | acc=0.9794 | tpr=0.9383 | fpr=0.0198 | 8022.2 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.14058 | acc=0.9795 | tpr=0.9363 | fpr=0.0197 | 15666.9 samples/s | 61.2 steps/s
Avg test loss: 0.14033, Avg test acc: 0.97954, Avg tpr: 0.93621, Avg fpr: 0.01968, total FA: 2732

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11759 | acc=0.9814 | tpr=0.9425 | fpr=0.0179 | 4163.6 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.12111 | acc=0.9811 | tpr=0.9531 | fpr=0.0184 | 8440.2 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.12409 | acc=0.9802 | tpr=0.9553 | fpr=0.0194 | 8128.0 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.12513 | acc=0.9799 | tpr=0.9585 | fpr=0.0197 | 8401.4 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.12269 | acc=0.9801 | tpr=0.9563 | fpr=0.0194 | 8547.4 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.12569 | acc=0.9798 | tpr=0.9542 | fpr=0.0197 | 8259.7 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.12674 | acc=0.9798 | tpr=0.9530 | fpr=0.0197 | 8609.2 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.12764 | acc=0.9795 | tpr=0.9497 | fpr=0.0199 | 8294.1 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.13079 | acc=0.9792 | tpr=0.9479 | fpr=0.0203 | 8201.3 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.13054 | acc=0.9793 | tpr=0.9485 | fpr=0.0201 | 8291.8 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.12928 | acc=0.9795 | tpr=0.9463 | fpr=0.0199 | 13859.9 samples/s | 54.1 steps/s
Avg test loss: 0.12903, Avg test acc: 0.97954, Avg tpr: 0.94612, Avg fpr: 0.01985, total FA: 2756

server round 16/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=31.2] | Loss=0.02362 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.768 | L2-Norm(final)=8.918 | 3594.6 samples/s | 56.2 steps/s
[Step=16050 Epoch=31.3] | Loss=0.02982 | Reg=0.00190 | acc=0.9531 | L2-Norm=13.772 | L2-Norm(final)=8.935 | 5173.9 samples/s | 80.8 steps/s
[Step=16100 Epoch=31.4] | Loss=0.02959 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.772 | L2-Norm(final)=8.960 | 5495.2 samples/s | 85.9 steps/s
[Step=16150 Epoch=31.5] | Loss=0.03176 | Reg=0.00190 | acc=0.9531 | L2-Norm=13.772 | L2-Norm(final)=8.981 | 5280.1 samples/s | 82.5 steps/s
[Step=16200 Epoch=31.6] | Loss=0.03234 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.772 | L2-Norm(final)=8.996 | 5765.9 samples/s | 90.1 steps/s
[Step=16250 Epoch=31.7] | Loss=0.03195 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.772 | L2-Norm(final)=9.010 | 5621.1 samples/s | 87.8 steps/s
[Step=16300 Epoch=31.8] | Loss=0.03219 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.773 | L2-Norm(final)=9.024 | 5582.2 samples/s | 87.2 steps/s
[Step=16350 Epoch=31.9] | Loss=0.03208 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.773 | L2-Norm(final)=9.035 | 5394.3 samples/s | 84.3 steps/s
[Step=16400 Epoch=32.0] | Loss=0.03180 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.773 | L2-Norm(final)=9.048 | 5671.9 samples/s | 88.6 steps/s
[Step=16450 Epoch=32.1] | Loss=0.03167 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.773 | L2-Norm(final)=9.061 | 5764.7 samples/s | 90.1 steps/s
[Step=16500 Epoch=32.2] | Loss=0.03138 | Reg=0.00190 | acc=0.9531 | L2-Norm=13.773 | L2-Norm(final)=9.073 | 7308.8 samples/s | 114.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=32.2] | Loss=0.01605 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.773 | L2-Norm(final)=9.199 | 3779.0 samples/s | 59.0 steps/s
[Step=16550 Epoch=32.3] | Loss=0.02524 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.846 | L2-Norm(final)=9.202 | 4642.7 samples/s | 72.5 steps/s
[Step=16600 Epoch=32.4] | Loss=0.03097 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.914 | L2-Norm(final)=9.193 | 4970.1 samples/s | 77.7 steps/s
[Step=16650 Epoch=32.5] | Loss=0.02877 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.967 | L2-Norm(final)=9.186 | 5082.2 samples/s | 79.4 steps/s
[Step=16700 Epoch=32.6] | Loss=0.02863 | Reg=0.00196 | acc=0.9688 | L2-Norm=14.007 | L2-Norm(final)=9.182 | 5043.7 samples/s | 78.8 steps/s
[Step=16750 Epoch=32.7] | Loss=0.02831 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.039 | L2-Norm(final)=9.179 | 5010.0 samples/s | 78.3 steps/s
[Step=16800 Epoch=32.8] | Loss=0.02724 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.067 | L2-Norm(final)=9.178 | 5047.7 samples/s | 78.9 steps/s
[Step=16850 Epoch=32.9] | Loss=0.02671 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.091 | L2-Norm(final)=9.177 | 4956.2 samples/s | 77.4 steps/s
[Step=16900 Epoch=33.0] | Loss=0.02656 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.112 | L2-Norm(final)=9.177 | 4923.7 samples/s | 76.9 steps/s
[Step=16950 Epoch=33.1] | Loss=0.02542 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.132 | L2-Norm(final)=9.177 | 4942.9 samples/s | 77.2 steps/s
[Step=17000 Epoch=33.2] | Loss=0.02544 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.149 | L2-Norm(final)=9.176 | 6168.8 samples/s | 96.4 steps/s
[Step=17050 Epoch=33.3] | Loss=0.02444 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.166 | L2-Norm(final)=9.176 | 1885.2 samples/s | 29.5 steps/s
[Step=17100 Epoch=33.4] | Loss=0.02376 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.181 | L2-Norm(final)=9.177 | 5053.1 samples/s | 79.0 steps/s
[Step=17150 Epoch=33.4] | Loss=0.02289 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.194 | L2-Norm(final)=9.178 | 5043.4 samples/s | 78.8 steps/s
[Step=17200 Epoch=33.5] | Loss=0.02209 | Reg=0.00202 | acc=0.9688 | L2-Norm=14.206 | L2-Norm(final)=9.179 | 5092.0 samples/s | 79.6 steps/s
[Step=17250 Epoch=33.6] | Loss=0.02146 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.217 | L2-Norm(final)=9.180 | 4951.9 samples/s | 77.4 steps/s
[Step=17300 Epoch=33.7] | Loss=0.02104 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.227 | L2-Norm(final)=9.181 | 5044.8 samples/s | 78.8 steps/s
[Step=17350 Epoch=33.8] | Loss=0.02096 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.237 | L2-Norm(final)=9.182 | 5001.2 samples/s | 78.1 steps/s
[Step=17400 Epoch=33.9] | Loss=0.02102 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.247 | L2-Norm(final)=9.183 | 4977.5 samples/s | 77.8 steps/s
[Step=17450 Epoch=34.0] | Loss=0.02083 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.256 | L2-Norm(final)=9.183 | 5009.9 samples/s | 78.3 steps/s
[Step=17500 Epoch=34.1] | Loss=0.02058 | Reg=0.00204 | acc=0.9531 | L2-Norm=14.266 | L2-Norm(final)=9.184 | 5309.2 samples/s | 83.0 steps/s
[Step=17550 Epoch=34.2] | Loss=0.02017 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.275 | L2-Norm(final)=9.184 | 1977.8 samples/s | 30.9 steps/s
[Step=17600 Epoch=34.3] | Loss=0.01986 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.284 | L2-Norm(final)=9.185 | 4992.7 samples/s | 78.0 steps/s
[Step=17650 Epoch=34.4] | Loss=0.01960 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.293 | L2-Norm(final)=9.185 | 5055.1 samples/s | 79.0 steps/s
[Step=17700 Epoch=34.5] | Loss=0.01932 | Reg=0.00205 | acc=0.9688 | L2-Norm=14.302 | L2-Norm(final)=9.185 | 5021.6 samples/s | 78.5 steps/s
[Step=17750 Epoch=34.6] | Loss=0.01905 | Reg=0.00205 | acc=0.9688 | L2-Norm=14.311 | L2-Norm(final)=9.186 | 5018.4 samples/s | 78.4 steps/s
[Step=17800 Epoch=34.7] | Loss=0.01895 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.319 | L2-Norm(final)=9.187 | 5055.8 samples/s | 79.0 steps/s
[Step=17850 Epoch=34.8] | Loss=0.01869 | Reg=0.00205 | acc=0.9688 | L2-Norm=14.328 | L2-Norm(final)=9.187 | 5031.6 samples/s | 78.6 steps/s
[Step=17900 Epoch=34.9] | Loss=0.01852 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.337 | L2-Norm(final)=9.188 | 5071.6 samples/s | 79.2 steps/s
[Step=17950 Epoch=35.0] | Loss=0.01825 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.345 | L2-Norm(final)=9.189 | 5077.2 samples/s | 79.3 steps/s
[Step=18000 Epoch=35.1] | Loss=0.01813 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.353 | L2-Norm(final)=9.189 | 5057.6 samples/s | 79.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step18000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=16001 Epoch=61.6] | Loss=0.00040 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.768 | L2-Norm(final)=10.563 | 3508.0 samples/s | 54.8 steps/s
[Step=16050 Epoch=61.8] | Loss=0.00091 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.764 | L2-Norm(final)=10.577 | 5454.4 samples/s | 85.2 steps/s
[Step=16100 Epoch=62.0] | Loss=0.00100 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.764 | L2-Norm(final)=10.597 | 5371.8 samples/s | 83.9 steps/s
[Step=16150 Epoch=62.2] | Loss=0.00104 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.764 | L2-Norm(final)=10.618 | 5361.9 samples/s | 83.8 steps/s
[Step=16200 Epoch=62.4] | Loss=0.00113 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.764 | L2-Norm(final)=10.636 | 5441.8 samples/s | 85.0 steps/s
[Step=16250 Epoch=62.6] | Loss=0.00109 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.764 | L2-Norm(final)=10.654 | 7401.2 samples/s | 115.6 steps/s
[Step=16300 Epoch=62.7] | Loss=0.00103 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.764 | L2-Norm(final)=10.672 | 1943.8 samples/s | 30.4 steps/s
[Step=16350 Epoch=62.9] | Loss=0.00099 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.764 | L2-Norm(final)=10.689 | 5335.5 samples/s | 83.4 steps/s
[Step=16400 Epoch=63.1] | Loss=0.00101 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.764 | L2-Norm(final)=10.706 | 5489.9 samples/s | 85.8 steps/s
[Step=16450 Epoch=63.3] | Loss=0.00102 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.764 | L2-Norm(final)=10.723 | 5427.6 samples/s | 84.8 steps/s
[Step=16500 Epoch=63.5] | Loss=0.00101 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.764 | L2-Norm(final)=10.739 | 6378.9 samples/s | 99.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=63.5] | Loss=0.00030 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.764 | L2-Norm(final)=10.896 | 3857.3 samples/s | 60.3 steps/s
[Step=16550 Epoch=63.7] | Loss=0.00295 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.756 | L2-Norm(final)=10.906 | 4479.5 samples/s | 70.0 steps/s
[Step=16600 Epoch=63.9] | Loss=0.00179 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.777 | L2-Norm(final)=10.902 | 4803.8 samples/s | 75.1 steps/s
[Step=16650 Epoch=64.1] | Loss=0.00225 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.802 | L2-Norm(final)=10.900 | 4754.3 samples/s | 74.3 steps/s
[Step=16700 Epoch=64.3] | Loss=0.00217 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.837 | L2-Norm(final)=10.896 | 4738.8 samples/s | 74.0 steps/s
[Step=16750 Epoch=64.5] | Loss=0.00297 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.881 | L2-Norm(final)=10.893 | 6121.0 samples/s | 95.6 steps/s
[Step=16800 Epoch=64.7] | Loss=0.00294 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.926 | L2-Norm(final)=10.886 | 1880.9 samples/s | 29.4 steps/s
[Step=16850 Epoch=64.9] | Loss=0.00353 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.964 | L2-Norm(final)=10.879 | 4662.9 samples/s | 72.9 steps/s
[Step=16900 Epoch=65.1] | Loss=0.00317 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.995 | L2-Norm(final)=10.870 | 4776.9 samples/s | 74.6 steps/s
[Step=16950 Epoch=65.2] | Loss=0.00288 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.018 | L2-Norm(final)=10.864 | 4843.8 samples/s | 75.7 steps/s
[Step=17000 Epoch=65.4] | Loss=0.00259 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.035 | L2-Norm(final)=10.859 | 5498.4 samples/s | 85.9 steps/s
[Step=17050 Epoch=65.6] | Loss=0.00236 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.047 | L2-Norm(final)=10.856 | 1953.5 samples/s | 30.5 steps/s
[Step=17100 Epoch=65.8] | Loss=0.00216 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.056 | L2-Norm(final)=10.853 | 4753.8 samples/s | 74.3 steps/s
[Step=17150 Epoch=66.0] | Loss=0.00200 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.062 | L2-Norm(final)=10.850 | 4838.7 samples/s | 75.6 steps/s
[Step=17200 Epoch=66.2] | Loss=0.00189 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.066 | L2-Norm(final)=10.848 | 4683.5 samples/s | 73.2 steps/s
[Step=17250 Epoch=66.4] | Loss=0.00184 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.069 | L2-Norm(final)=10.847 | 4840.2 samples/s | 75.6 steps/s
[Step=17300 Epoch=66.6] | Loss=0.00174 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.072 | L2-Norm(final)=10.845 | 2022.1 samples/s | 31.6 steps/s
[Step=17350 Epoch=66.8] | Loss=0.00165 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.074 | L2-Norm(final)=10.843 | 4818.9 samples/s | 75.3 steps/s
[Step=17400 Epoch=67.0] | Loss=0.00156 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.076 | L2-Norm(final)=10.842 | 4747.5 samples/s | 74.2 steps/s
[Step=17450 Epoch=67.2] | Loss=0.00148 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.076 | L2-Norm(final)=10.841 | 4745.4 samples/s | 74.1 steps/s
[Step=17500 Epoch=67.4] | Loss=0.00141 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.075 | L2-Norm(final)=10.841 | 4779.7 samples/s | 74.7 steps/s
[Step=17550 Epoch=67.6] | Loss=0.00134 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.074 | L2-Norm(final)=10.840 | 2037.1 samples/s | 31.8 steps/s
[Step=17600 Epoch=67.7] | Loss=0.00128 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.072 | L2-Norm(final)=10.840 | 4793.1 samples/s | 74.9 steps/s
[Step=17650 Epoch=67.9] | Loss=0.00122 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.069 | L2-Norm(final)=10.839 | 4768.1 samples/s | 74.5 steps/s
[Step=17700 Epoch=68.1] | Loss=0.00117 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.066 | L2-Norm(final)=10.839 | 4777.6 samples/s | 74.7 steps/s
[Step=17750 Epoch=68.3] | Loss=0.00113 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.062 | L2-Norm(final)=10.838 | 4738.7 samples/s | 74.0 steps/s
[Step=17800 Epoch=68.5] | Loss=0.00108 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.057 | L2-Norm(final)=10.838 | 7062.1 samples/s | 110.3 steps/s
[Step=17850 Epoch=68.7] | Loss=0.00104 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.053 | L2-Norm(final)=10.838 | 1810.3 samples/s | 28.3 steps/s
[Step=17900 Epoch=68.9] | Loss=0.00101 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.048 | L2-Norm(final)=10.838 | 4788.0 samples/s | 74.8 steps/s
[Step=17950 Epoch=69.1] | Loss=0.00097 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.042 | L2-Norm(final)=10.838 | 4812.8 samples/s | 75.2 steps/s
[Step=18000 Epoch=69.3] | Loss=0.00094 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.037 | L2-Norm(final)=10.837 | 4725.5 samples/s | 73.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_1/client_state-step18000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06787 | acc=0.9673 | tpr=0.9756 | fpr=0.0505 | 4147.4 samples/s | 16.2 steps/s
Avg test loss: 0.06941, Avg test acc: 0.96698, Avg tpr: 0.97435, Avg fpr: 0.04922, total FA: 384

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06619 | acc=0.9643 | tpr=0.9694 | fpr=0.0468 | 4273.0 samples/s | 16.7 steps/s
Avg test loss: 0.07179, Avg test acc: 0.96334, Avg tpr: 0.96870, Avg fpr: 0.04846, total FA: 378

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.71417 | acc=0.3175 | tpr=0.0149 | fpr=0.0255 | 4184.4 samples/s | 16.3 steps/s
Avg test loss: 5.71079, Avg test acc: 0.31589, Avg tpr: 0.01533, Avg fpr: 0.02307, total FA: 180

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.06347 | acc=0.3176 | tpr=0.0185 | fpr=0.0330 | 4193.3 samples/s | 16.4 steps/s
Avg test loss: 6.07610, Avg test acc: 0.31593, Avg tpr: 0.01912, Avg fpr: 0.03128, total FA: 244

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.89339 | acc=0.0999 | tpr=0.9204 | fpr=0.9148 | 4256.8 samples/s | 16.6 steps/s
[Step= 100] | Loss=5.87560 | acc=0.1009 | tpr=0.9211 | fpr=0.9144 | 8088.3 samples/s | 31.6 steps/s
[Step= 150] | Loss=5.89115 | acc=0.1001 | tpr=0.9164 | fpr=0.9149 | 8045.4 samples/s | 31.4 steps/s
[Step= 200] | Loss=5.89611 | acc=0.0997 | tpr=0.9148 | fpr=0.9151 | 8540.8 samples/s | 33.4 steps/s
[Step= 250] | Loss=5.89625 | acc=0.1001 | tpr=0.9118 | fpr=0.9147 | 7864.3 samples/s | 30.7 steps/s
[Step= 300] | Loss=5.90184 | acc=0.1001 | tpr=0.9047 | fpr=0.9146 | 8482.3 samples/s | 33.1 steps/s
[Step= 350] | Loss=5.90469 | acc=0.0996 | tpr=0.9054 | fpr=0.9151 | 8034.7 samples/s | 31.4 steps/s
[Step= 400] | Loss=5.90582 | acc=0.0998 | tpr=0.9065 | fpr=0.9148 | 8903.8 samples/s | 34.8 steps/s
[Step= 450] | Loss=5.90764 | acc=0.0998 | tpr=0.9099 | fpr=0.9149 | 7854.0 samples/s | 30.7 steps/s
[Step= 500] | Loss=5.90755 | acc=0.0999 | tpr=0.9132 | fpr=0.9148 | 8222.1 samples/s | 32.1 steps/s
[Step= 550] | Loss=5.90644 | acc=0.1002 | tpr=0.9140 | fpr=0.9145 | 15407.5 samples/s | 60.2 steps/s
Avg test loss: 5.90722, Avg test acc: 0.10021, Avg tpr: 0.91403, Avg fpr: 0.91458, total FA: 126988

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.22935 | acc=0.1194 | tpr=0.8938 | fpr=0.8945 | 4159.7 samples/s | 16.2 steps/s
[Step= 100] | Loss=5.20413 | acc=0.1223 | tpr=0.8934 | fpr=0.8920 | 8188.9 samples/s | 32.0 steps/s
[Step= 150] | Loss=5.22421 | acc=0.1208 | tpr=0.8876 | fpr=0.8933 | 8476.5 samples/s | 33.1 steps/s
[Step= 200] | Loss=5.22513 | acc=0.1209 | tpr=0.8852 | fpr=0.8930 | 8249.3 samples/s | 32.2 steps/s
[Step= 250] | Loss=5.22537 | acc=0.1216 | tpr=0.8900 | fpr=0.8924 | 8154.8 samples/s | 31.9 steps/s
[Step= 300] | Loss=5.22839 | acc=0.1217 | tpr=0.8865 | fpr=0.8922 | 8251.9 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.22392 | acc=0.1210 | tpr=0.8854 | fpr=0.8929 | 8241.8 samples/s | 32.2 steps/s
[Step= 400] | Loss=5.22427 | acc=0.1215 | tpr=0.8868 | fpr=0.8924 | 8351.6 samples/s | 32.6 steps/s
[Step= 450] | Loss=5.22516 | acc=0.1212 | tpr=0.8885 | fpr=0.8927 | 8312.1 samples/s | 32.5 steps/s
[Step= 500] | Loss=5.22526 | acc=0.1214 | tpr=0.8907 | fpr=0.8925 | 8193.9 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.22671 | acc=0.1215 | tpr=0.8894 | fpr=0.8924 | 15114.3 samples/s | 59.0 steps/s
Avg test loss: 5.22723, Avg test acc: 0.12150, Avg tpr: 0.88906, Avg fpr: 0.89246, total FA: 123916

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12436 | acc=0.9819 | tpr=0.9513 | fpr=0.0176 | 4202.3 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.13256 | acc=0.9812 | tpr=0.9467 | fpr=0.0182 | 8000.8 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.13785 | acc=0.9802 | tpr=0.9438 | fpr=0.0191 | 8262.8 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.13884 | acc=0.9805 | tpr=0.9530 | fpr=0.0190 | 8409.3 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.13511 | acc=0.9804 | tpr=0.9467 | fpr=0.0189 | 8899.6 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.13833 | acc=0.9800 | tpr=0.9433 | fpr=0.0193 | 7901.4 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.13920 | acc=0.9800 | tpr=0.9436 | fpr=0.0194 | 8311.5 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.14008 | acc=0.9797 | tpr=0.9398 | fpr=0.0196 | 8202.7 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.14230 | acc=0.9795 | tpr=0.9367 | fpr=0.0198 | 8412.7 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.14189 | acc=0.9794 | tpr=0.9383 | fpr=0.0198 | 8200.8 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.14058 | acc=0.9795 | tpr=0.9363 | fpr=0.0197 | 15401.6 samples/s | 60.2 steps/s
Avg test loss: 0.14033, Avg test acc: 0.97954, Avg tpr: 0.93621, Avg fpr: 0.01968, total FA: 2732

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15842 | acc=0.9785 | tpr=0.9425 | fpr=0.0208 | 4193.6 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.16692 | acc=0.9785 | tpr=0.9552 | fpr=0.0210 | 8196.6 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.17480 | acc=0.9777 | tpr=0.9553 | fpr=0.0219 | 8604.3 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.17779 | acc=0.9777 | tpr=0.9607 | fpr=0.0220 | 7895.9 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.17529 | acc=0.9776 | tpr=0.9581 | fpr=0.0221 | 8525.1 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.18009 | acc=0.9770 | tpr=0.9556 | fpr=0.0226 | 8277.2 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.18080 | acc=0.9770 | tpr=0.9555 | fpr=0.0226 | 8457.5 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.18206 | acc=0.9768 | tpr=0.9535 | fpr=0.0228 | 8215.8 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.18506 | acc=0.9766 | tpr=0.9528 | fpr=0.0230 | 8160.7 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.18416 | acc=0.9767 | tpr=0.9533 | fpr=0.0229 | 8567.7 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.18245 | acc=0.9769 | tpr=0.9515 | fpr=0.0226 | 14672.6 samples/s | 57.3 steps/s
Avg test loss: 0.18219, Avg test acc: 0.97691, Avg tpr: 0.95127, Avg fpr: 0.02262, total FA: 3141

server round 17/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=18001 Epoch=35.1] | Loss=0.02391 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.795 | L2-Norm(final)=9.206 | 3802.6 samples/s | 59.4 steps/s
[Step=18050 Epoch=35.2] | Loss=0.03750 | Reg=0.00190 | acc=0.9531 | L2-Norm=13.797 | L2-Norm(final)=9.210 | 5312.0 samples/s | 83.0 steps/s
[Step=18100 Epoch=35.3] | Loss=0.03672 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.797 | L2-Norm(final)=9.220 | 5760.6 samples/s | 90.0 steps/s
[Step=18150 Epoch=35.4] | Loss=0.03589 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.797 | L2-Norm(final)=9.229 | 5977.1 samples/s | 93.4 steps/s
[Step=18200 Epoch=35.5] | Loss=0.03442 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.797 | L2-Norm(final)=9.240 | 5828.0 samples/s | 91.1 steps/s
[Step=18250 Epoch=35.6] | Loss=0.03409 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.797 | L2-Norm(final)=9.251 | 5906.2 samples/s | 92.3 steps/s
[Step=18300 Epoch=35.7] | Loss=0.03319 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.797 | L2-Norm(final)=9.262 | 5799.6 samples/s | 90.6 steps/s
[Step=18350 Epoch=35.8] | Loss=0.03353 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.797 | L2-Norm(final)=9.273 | 5931.8 samples/s | 92.7 steps/s
[Step=18400 Epoch=35.9] | Loss=0.03269 | Reg=0.00190 | acc=0.9375 | L2-Norm=13.797 | L2-Norm(final)=9.284 | 5765.4 samples/s | 90.1 steps/s
[Step=18450 Epoch=36.0] | Loss=0.03217 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.797 | L2-Norm(final)=9.296 | 5745.2 samples/s | 89.8 steps/s
[Step=18500 Epoch=36.1] | Loss=0.03210 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.797 | L2-Norm(final)=9.309 | 7364.1 samples/s | 115.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=36.1] | Loss=0.07535 | Reg=0.00190 | acc=0.9531 | L2-Norm=13.798 | L2-Norm(final)=9.442 | 3700.2 samples/s | 57.8 steps/s
[Step=18550 Epoch=36.2] | Loss=0.03202 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.864 | L2-Norm(final)=9.439 | 4796.4 samples/s | 74.9 steps/s
[Step=18600 Epoch=36.3] | Loss=0.02883 | Reg=0.00194 | acc=0.9531 | L2-Norm=13.924 | L2-Norm(final)=9.433 | 5051.5 samples/s | 78.9 steps/s
[Step=18650 Epoch=36.4] | Loss=0.02606 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.970 | L2-Norm(final)=9.429 | 4956.2 samples/s | 77.4 steps/s
[Step=18700 Epoch=36.5] | Loss=0.02740 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.007 | L2-Norm(final)=9.425 | 5102.8 samples/s | 79.7 steps/s
[Step=18750 Epoch=36.6] | Loss=0.02751 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.041 | L2-Norm(final)=9.420 | 5116.7 samples/s | 79.9 steps/s
[Step=18800 Epoch=36.7] | Loss=0.02725 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.071 | L2-Norm(final)=9.417 | 4975.9 samples/s | 77.7 steps/s
[Step=18850 Epoch=36.8] | Loss=0.02662 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.099 | L2-Norm(final)=9.414 | 5030.2 samples/s | 78.6 steps/s
[Step=18900 Epoch=36.9] | Loss=0.02602 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.124 | L2-Norm(final)=9.413 | 5021.5 samples/s | 78.5 steps/s
[Step=18950 Epoch=37.0] | Loss=0.02555 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.147 | L2-Norm(final)=9.411 | 5017.8 samples/s | 78.4 steps/s
[Step=19000 Epoch=37.1] | Loss=0.02567 | Reg=0.00201 | acc=0.9531 | L2-Norm=14.168 | L2-Norm(final)=9.410 | 6139.7 samples/s | 95.9 steps/s
[Step=19050 Epoch=37.2] | Loss=0.02497 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.186 | L2-Norm(final)=9.408 | 1912.6 samples/s | 29.9 steps/s
[Step=19100 Epoch=37.3] | Loss=0.02436 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.203 | L2-Norm(final)=9.407 | 4985.7 samples/s | 77.9 steps/s
[Step=19150 Epoch=37.3] | Loss=0.02344 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.219 | L2-Norm(final)=9.406 | 4997.4 samples/s | 78.1 steps/s
[Step=19200 Epoch=37.4] | Loss=0.02262 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.233 | L2-Norm(final)=9.406 | 5033.6 samples/s | 78.7 steps/s
[Step=19250 Epoch=37.5] | Loss=0.02202 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.246 | L2-Norm(final)=9.406 | 5039.9 samples/s | 78.7 steps/s
[Step=19300 Epoch=37.6] | Loss=0.02141 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.257 | L2-Norm(final)=9.406 | 4984.7 samples/s | 77.9 steps/s
[Step=19350 Epoch=37.7] | Loss=0.02132 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.268 | L2-Norm(final)=9.406 | 5089.3 samples/s | 79.5 steps/s
[Step=19400 Epoch=37.8] | Loss=0.02120 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.279 | L2-Norm(final)=9.406 | 5026.5 samples/s | 78.5 steps/s
[Step=19450 Epoch=37.9] | Loss=0.02065 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.289 | L2-Norm(final)=9.406 | 4972.9 samples/s | 77.7 steps/s
[Step=19500 Epoch=38.0] | Loss=0.02040 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.299 | L2-Norm(final)=9.406 | 5335.6 samples/s | 83.4 steps/s
[Step=19550 Epoch=38.1] | Loss=0.02008 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.309 | L2-Norm(final)=9.407 | 1962.6 samples/s | 30.7 steps/s
[Step=19600 Epoch=38.2] | Loss=0.01971 | Reg=0.00205 | acc=0.9531 | L2-Norm=14.318 | L2-Norm(final)=9.407 | 5056.8 samples/s | 79.0 steps/s
[Step=19650 Epoch=38.3] | Loss=0.01957 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.327 | L2-Norm(final)=9.407 | 5021.8 samples/s | 78.5 steps/s
[Step=19700 Epoch=38.4] | Loss=0.01941 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.336 | L2-Norm(final)=9.408 | 5036.0 samples/s | 78.7 steps/s
[Step=19750 Epoch=38.5] | Loss=0.01919 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.344 | L2-Norm(final)=9.408 | 5041.2 samples/s | 78.8 steps/s
[Step=19800 Epoch=38.6] | Loss=0.01903 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.352 | L2-Norm(final)=9.408 | 5047.5 samples/s | 78.9 steps/s
[Step=19850 Epoch=38.7] | Loss=0.01887 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.361 | L2-Norm(final)=9.408 | 5014.6 samples/s | 78.4 steps/s
[Step=19900 Epoch=38.8] | Loss=0.01861 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.369 | L2-Norm(final)=9.409 | 5092.7 samples/s | 79.6 steps/s
[Step=19950 Epoch=38.9] | Loss=0.01840 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.377 | L2-Norm(final)=9.410 | 4970.2 samples/s | 77.7 steps/s
[Step=20000 Epoch=39.0] | Loss=0.01812 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.384 | L2-Norm(final)=9.410 | 4990.8 samples/s | 78.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step20000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=18001 Epoch=35.2] | Loss=0.03995 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.795 | L2-Norm(final)=9.324 | 3754.4 samples/s | 58.7 steps/s
[Step=18050 Epoch=35.3] | Loss=0.03115 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.797 | L2-Norm(final)=9.332 | 5918.1 samples/s | 92.5 steps/s
[Step=18100 Epoch=35.4] | Loss=0.03179 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.798 | L2-Norm(final)=9.338 | 5832.9 samples/s | 91.1 steps/s
[Step=18150 Epoch=35.5] | Loss=0.03250 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.798 | L2-Norm(final)=9.344 | 5982.2 samples/s | 93.5 steps/s
[Step=18200 Epoch=35.6] | Loss=0.03246 | Reg=0.00190 | acc=0.9531 | L2-Norm=13.798 | L2-Norm(final)=9.351 | 5899.2 samples/s | 92.2 steps/s
[Step=18250 Epoch=35.7] | Loss=0.03320 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.798 | L2-Norm(final)=9.357 | 5864.7 samples/s | 91.6 steps/s
[Step=18300 Epoch=35.8] | Loss=0.03316 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.798 | L2-Norm(final)=9.363 | 5850.3 samples/s | 91.4 steps/s
[Step=18350 Epoch=35.9] | Loss=0.03289 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.798 | L2-Norm(final)=9.370 | 5894.8 samples/s | 92.1 steps/s
[Step=18400 Epoch=36.0] | Loss=0.03222 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.798 | L2-Norm(final)=9.378 | 5940.4 samples/s | 92.8 steps/s
[Step=18450 Epoch=36.1] | Loss=0.03229 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.798 | L2-Norm(final)=9.386 | 5778.9 samples/s | 90.3 steps/s
[Step=18500 Epoch=36.2] | Loss=0.03179 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.798 | L2-Norm(final)=9.395 | 7515.0 samples/s | 117.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=36.2] | Loss=0.00729 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.798 | L2-Norm(final)=9.488 | 4149.3 samples/s | 64.8 steps/s
[Step=18550 Epoch=36.3] | Loss=0.02796 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.866 | L2-Norm(final)=9.491 | 4496.2 samples/s | 70.3 steps/s
[Step=18600 Epoch=36.4] | Loss=0.02917 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.926 | L2-Norm(final)=9.483 | 5071.4 samples/s | 79.2 steps/s
[Step=18650 Epoch=36.5] | Loss=0.02759 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.973 | L2-Norm(final)=9.480 | 4990.7 samples/s | 78.0 steps/s
[Step=18700 Epoch=36.6] | Loss=0.02725 | Reg=0.00196 | acc=0.9375 | L2-Norm=14.011 | L2-Norm(final)=9.476 | 4998.9 samples/s | 78.1 steps/s
[Step=18750 Epoch=36.7] | Loss=0.02682 | Reg=0.00197 | acc=0.9531 | L2-Norm=14.042 | L2-Norm(final)=9.474 | 5050.7 samples/s | 78.9 steps/s
[Step=18800 Epoch=36.8] | Loss=0.02601 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.070 | L2-Norm(final)=9.472 | 5075.1 samples/s | 79.3 steps/s
[Step=18850 Epoch=36.9] | Loss=0.02582 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.094 | L2-Norm(final)=9.470 | 5049.2 samples/s | 78.9 steps/s
[Step=18900 Epoch=36.9] | Loss=0.02508 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.116 | L2-Norm(final)=9.470 | 5136.4 samples/s | 80.3 steps/s
[Step=18950 Epoch=37.0] | Loss=0.02436 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.136 | L2-Norm(final)=9.470 | 5069.8 samples/s | 79.2 steps/s
[Step=19000 Epoch=37.1] | Loss=0.02441 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.154 | L2-Norm(final)=9.470 | 6204.7 samples/s | 96.9 steps/s
[Step=19050 Epoch=37.2] | Loss=0.02389 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.172 | L2-Norm(final)=9.470 | 1955.8 samples/s | 30.6 steps/s
[Step=19100 Epoch=37.3] | Loss=0.02351 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.189 | L2-Norm(final)=9.470 | 5114.9 samples/s | 79.9 steps/s
[Step=19150 Epoch=37.4] | Loss=0.02289 | Reg=0.00202 | acc=0.9688 | L2-Norm=14.204 | L2-Norm(final)=9.470 | 5126.9 samples/s | 80.1 steps/s
[Step=19200 Epoch=37.5] | Loss=0.02232 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.218 | L2-Norm(final)=9.471 | 5103.6 samples/s | 79.7 steps/s
[Step=19250 Epoch=37.6] | Loss=0.02184 | Reg=0.00203 | acc=0.9531 | L2-Norm=14.231 | L2-Norm(final)=9.471 | 5037.4 samples/s | 78.7 steps/s
[Step=19300 Epoch=37.7] | Loss=0.02144 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.243 | L2-Norm(final)=9.471 | 5068.8 samples/s | 79.2 steps/s
[Step=19350 Epoch=37.8] | Loss=0.02117 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.254 | L2-Norm(final)=9.472 | 5010.1 samples/s | 78.3 steps/s
[Step=19400 Epoch=37.9] | Loss=0.02085 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.265 | L2-Norm(final)=9.472 | 5017.7 samples/s | 78.4 steps/s
[Step=19450 Epoch=38.0] | Loss=0.02027 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.276 | L2-Norm(final)=9.473 | 4999.9 samples/s | 78.1 steps/s
[Step=19500 Epoch=38.1] | Loss=0.01997 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.286 | L2-Norm(final)=9.474 | 5432.5 samples/s | 84.9 steps/s
[Step=19550 Epoch=38.2] | Loss=0.01967 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.296 | L2-Norm(final)=9.474 | 2012.1 samples/s | 31.4 steps/s
[Step=19600 Epoch=38.3] | Loss=0.01927 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.306 | L2-Norm(final)=9.475 | 5081.5 samples/s | 79.4 steps/s
[Step=19650 Epoch=38.4] | Loss=0.01886 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.316 | L2-Norm(final)=9.476 | 5024.3 samples/s | 78.5 steps/s
[Step=19700 Epoch=38.5] | Loss=0.01856 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.325 | L2-Norm(final)=9.477 | 5053.9 samples/s | 79.0 steps/s
[Step=19750 Epoch=38.6] | Loss=0.01832 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.334 | L2-Norm(final)=9.478 | 5148.5 samples/s | 80.4 steps/s
[Step=19800 Epoch=38.7] | Loss=0.01821 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.343 | L2-Norm(final)=9.479 | 5102.2 samples/s | 79.7 steps/s
[Step=19850 Epoch=38.8] | Loss=0.01803 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.351 | L2-Norm(final)=9.480 | 5085.4 samples/s | 79.5 steps/s
[Step=19900 Epoch=38.9] | Loss=0.01779 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.360 | L2-Norm(final)=9.481 | 4974.1 samples/s | 77.7 steps/s
[Step=19950 Epoch=39.0] | Loss=0.01763 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.368 | L2-Norm(final)=9.482 | 5072.2 samples/s | 79.3 steps/s
[Step=20000 Epoch=39.1] | Loss=0.01756 | Reg=0.00207 | acc=0.9688 | L2-Norm=14.376 | L2-Norm(final)=9.482 | 5073.4 samples/s | 79.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06972 | acc=0.9648 | tpr=0.9698 | fpr=0.0461 | 4180.9 samples/s | 16.3 steps/s
Avg test loss: 0.06974, Avg test acc: 0.96438, Avg tpr: 0.96905, Avg fpr: 0.04589, total FA: 358

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07329 | acc=0.9638 | tpr=0.9770 | fpr=0.0647 | 4300.2 samples/s | 16.8 steps/s
Avg test loss: 0.07841, Avg test acc: 0.96382, Avg tpr: 0.97727, Avg fpr: 0.06576, total FA: 513

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.71417 | acc=0.3175 | tpr=0.0149 | fpr=0.0255 | 4237.8 samples/s | 16.6 steps/s
Avg test loss: 5.71079, Avg test acc: 0.31589, Avg tpr: 0.01533, Avg fpr: 0.02307, total FA: 180

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.06347 | acc=0.3176 | tpr=0.0185 | fpr=0.0330 | 4255.2 samples/s | 16.6 steps/s
Avg test loss: 6.07610, Avg test acc: 0.31593, Avg tpr: 0.01912, Avg fpr: 0.03128, total FA: 244

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.00008 | acc=0.1147 | tpr=0.9204 | fpr=0.8998 | 4211.6 samples/s | 16.5 steps/s
[Step= 100] | Loss=5.97441 | acc=0.1166 | tpr=0.9147 | fpr=0.8983 | 8242.3 samples/s | 32.2 steps/s
[Step= 150] | Loss=5.98502 | acc=0.1161 | tpr=0.9135 | fpr=0.8985 | 8528.5 samples/s | 33.3 steps/s
[Step= 200] | Loss=5.98189 | acc=0.1165 | tpr=0.9148 | fpr=0.8980 | 8332.6 samples/s | 32.5 steps/s
[Step= 250] | Loss=5.97679 | acc=0.1171 | tpr=0.9100 | fpr=0.8974 | 8337.3 samples/s | 32.6 steps/s
[Step= 300] | Loss=5.97768 | acc=0.1168 | tpr=0.9055 | fpr=0.8975 | 8218.5 samples/s | 32.1 steps/s
[Step= 350] | Loss=5.97928 | acc=0.1161 | tpr=0.9048 | fpr=0.8982 | 8307.5 samples/s | 32.5 steps/s
[Step= 400] | Loss=5.98043 | acc=0.1160 | tpr=0.9065 | fpr=0.8983 | 8429.3 samples/s | 32.9 steps/s
[Step= 450] | Loss=5.98084 | acc=0.1161 | tpr=0.9070 | fpr=0.8983 | 8075.2 samples/s | 31.5 steps/s
[Step= 500] | Loss=5.98037 | acc=0.1162 | tpr=0.9084 | fpr=0.8981 | 8423.8 samples/s | 32.9 steps/s
[Step= 550] | Loss=5.97918 | acc=0.1164 | tpr=0.9073 | fpr=0.8980 | 15164.4 samples/s | 59.2 steps/s
Avg test loss: 5.98004, Avg test acc: 0.11636, Avg tpr: 0.90769, Avg fpr: 0.89803, total FA: 124689

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.14564 | acc=0.0955 | tpr=0.9159 | fpr=0.9193 | 4255.2 samples/s | 16.6 steps/s
[Step= 100] | Loss=7.12363 | acc=0.0955 | tpr=0.9104 | fpr=0.9197 | 8276.7 samples/s | 32.3 steps/s
[Step= 150] | Loss=7.15202 | acc=0.0952 | tpr=0.9107 | fpr=0.9198 | 8239.5 samples/s | 32.2 steps/s
[Step= 200] | Loss=7.15240 | acc=0.0950 | tpr=0.9104 | fpr=0.9199 | 8624.4 samples/s | 33.7 steps/s
[Step= 250] | Loss=7.15376 | acc=0.0953 | tpr=0.9092 | fpr=0.9196 | 8480.8 samples/s | 33.1 steps/s
[Step= 300] | Loss=7.15780 | acc=0.0950 | tpr=0.8989 | fpr=0.9197 | 8161.1 samples/s | 31.9 steps/s
[Step= 350] | Loss=7.15651 | acc=0.0943 | tpr=0.8967 | fpr=0.9203 | 8220.0 samples/s | 32.1 steps/s
[Step= 400] | Loss=7.16055 | acc=0.0943 | tpr=0.8955 | fpr=0.9202 | 8505.4 samples/s | 33.2 steps/s
[Step= 450] | Loss=7.16303 | acc=0.0943 | tpr=0.8987 | fpr=0.9203 | 8256.9 samples/s | 32.3 steps/s
[Step= 500] | Loss=7.16061 | acc=0.0943 | tpr=0.9018 | fpr=0.9202 | 7977.8 samples/s | 31.2 steps/s
[Step= 550] | Loss=7.15988 | acc=0.0947 | tpr=0.9037 | fpr=0.9200 | 15183.2 samples/s | 59.3 steps/s
Avg test loss: 7.16034, Avg test acc: 0.09462, Avg tpr: 0.90333, Avg fpr: 0.92009, total FA: 127752

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12436 | acc=0.9819 | tpr=0.9513 | fpr=0.0176 | 4205.9 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.13256 | acc=0.9812 | tpr=0.9467 | fpr=0.0182 | 8210.1 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.13785 | acc=0.9802 | tpr=0.9438 | fpr=0.0191 | 8209.2 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.13884 | acc=0.9805 | tpr=0.9530 | fpr=0.0190 | 8637.2 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.13511 | acc=0.9804 | tpr=0.9467 | fpr=0.0189 | 8164.9 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.13833 | acc=0.9800 | tpr=0.9433 | fpr=0.0193 | 8237.1 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.13920 | acc=0.9800 | tpr=0.9436 | fpr=0.0194 | 8318.8 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.14008 | acc=0.9797 | tpr=0.9398 | fpr=0.0196 | 8276.5 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.14230 | acc=0.9795 | tpr=0.9367 | fpr=0.0198 | 8837.2 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.14189 | acc=0.9794 | tpr=0.9383 | fpr=0.0198 | 8056.5 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.14058 | acc=0.9795 | tpr=0.9363 | fpr=0.0197 | 15469.2 samples/s | 60.4 steps/s
Avg test loss: 0.14033, Avg test acc: 0.97954, Avg tpr: 0.93621, Avg fpr: 0.01968, total FA: 2732

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15842 | acc=0.9785 | tpr=0.9425 | fpr=0.0208 | 4179.5 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.16692 | acc=0.9785 | tpr=0.9552 | fpr=0.0210 | 8314.3 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.17480 | acc=0.9777 | tpr=0.9553 | fpr=0.0219 | 8229.7 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.17779 | acc=0.9777 | tpr=0.9607 | fpr=0.0220 | 8336.4 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.17529 | acc=0.9776 | tpr=0.9581 | fpr=0.0221 | 8252.3 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.18009 | acc=0.9770 | tpr=0.9556 | fpr=0.0226 | 8176.9 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.18080 | acc=0.9770 | tpr=0.9555 | fpr=0.0226 | 8250.2 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.18206 | acc=0.9768 | tpr=0.9535 | fpr=0.0228 | 8231.1 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.18506 | acc=0.9766 | tpr=0.9528 | fpr=0.0230 | 8547.8 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.18416 | acc=0.9767 | tpr=0.9533 | fpr=0.0229 | 7922.3 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.18245 | acc=0.9769 | tpr=0.9515 | fpr=0.0226 | 14997.4 samples/s | 58.6 steps/s
Avg test loss: 0.18219, Avg test acc: 0.97691, Avg tpr: 0.95127, Avg fpr: 0.02262, total FA: 3141

server round 18/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=39.0] | Loss=0.01958 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.806 | L2-Norm(final)=9.435 | 3534.2 samples/s | 55.2 steps/s
[Step=20050 Epoch=39.1] | Loss=0.02698 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.808 | L2-Norm(final)=9.447 | 5675.7 samples/s | 88.7 steps/s
[Step=20100 Epoch=39.2] | Loss=0.02533 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.808 | L2-Norm(final)=9.464 | 5817.7 samples/s | 90.9 steps/s
[Step=20150 Epoch=39.3] | Loss=0.02613 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.808 | L2-Norm(final)=9.479 | 5728.9 samples/s | 89.5 steps/s
[Step=20200 Epoch=39.4] | Loss=0.02613 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.809 | L2-Norm(final)=9.495 | 5831.0 samples/s | 91.1 steps/s
[Step=20250 Epoch=39.5] | Loss=0.02607 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.809 | L2-Norm(final)=9.512 | 5775.9 samples/s | 90.2 steps/s
[Step=20300 Epoch=39.6] | Loss=0.02568 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.809 | L2-Norm(final)=9.530 | 5852.4 samples/s | 91.4 steps/s
[Step=20350 Epoch=39.7] | Loss=0.02611 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.809 | L2-Norm(final)=9.547 | 5826.9 samples/s | 91.0 steps/s
[Step=20400 Epoch=39.8] | Loss=0.02619 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.809 | L2-Norm(final)=9.562 | 5762.9 samples/s | 90.0 steps/s
[Step=20450 Epoch=39.9] | Loss=0.02616 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.809 | L2-Norm(final)=9.577 | 5901.5 samples/s | 92.2 steps/s
[Step=20500 Epoch=40.0] | Loss=0.02633 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.809 | L2-Norm(final)=9.591 | 7482.9 samples/s | 116.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=40.0] | Loss=0.05469 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.809 | L2-Norm(final)=9.730 | 3500.8 samples/s | 54.7 steps/s
[Step=20550 Epoch=40.1] | Loss=0.03048 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.856 | L2-Norm(final)=9.731 | 4867.5 samples/s | 76.1 steps/s
[Step=20600 Epoch=40.2] | Loss=0.02990 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.905 | L2-Norm(final)=9.722 | 5035.7 samples/s | 78.7 steps/s
[Step=20650 Epoch=40.3] | Loss=0.02955 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.939 | L2-Norm(final)=9.712 | 4974.6 samples/s | 77.7 steps/s
[Step=20700 Epoch=40.4] | Loss=0.02792 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.969 | L2-Norm(final)=9.706 | 4997.9 samples/s | 78.1 steps/s
[Step=20750 Epoch=40.5] | Loss=0.02606 | Reg=0.00196 | acc=0.9375 | L2-Norm=13.995 | L2-Norm(final)=9.704 | 5042.1 samples/s | 78.8 steps/s
[Step=20800 Epoch=40.6] | Loss=0.02571 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.018 | L2-Norm(final)=9.702 | 5118.5 samples/s | 80.0 steps/s
[Step=20850 Epoch=40.7] | Loss=0.02487 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.039 | L2-Norm(final)=9.700 | 4978.6 samples/s | 77.8 steps/s
[Step=20900 Epoch=40.8] | Loss=0.02503 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.059 | L2-Norm(final)=9.699 | 5021.3 samples/s | 78.5 steps/s
[Step=20950 Epoch=40.9] | Loss=0.02506 | Reg=0.00198 | acc=0.9375 | L2-Norm=14.078 | L2-Norm(final)=9.697 | 5039.3 samples/s | 78.7 steps/s
[Step=21000 Epoch=41.0] | Loss=0.02450 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.096 | L2-Norm(final)=9.696 | 6190.0 samples/s | 96.7 steps/s
[Step=21050 Epoch=41.1] | Loss=0.02401 | Reg=0.00199 | acc=0.9531 | L2-Norm=14.114 | L2-Norm(final)=9.695 | 1901.1 samples/s | 29.7 steps/s
[Step=21100 Epoch=41.2] | Loss=0.02339 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.129 | L2-Norm(final)=9.693 | 5032.5 samples/s | 78.6 steps/s
[Step=21150 Epoch=41.3] | Loss=0.02287 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.144 | L2-Norm(final)=9.692 | 5085.8 samples/s | 79.5 steps/s
[Step=21200 Epoch=41.3] | Loss=0.02245 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.157 | L2-Norm(final)=9.691 | 4978.2 samples/s | 77.8 steps/s
[Step=21250 Epoch=41.4] | Loss=0.02198 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.170 | L2-Norm(final)=9.690 | 5048.4 samples/s | 78.9 steps/s
[Step=21300 Epoch=41.5] | Loss=0.02175 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.183 | L2-Norm(final)=9.689 | 4998.6 samples/s | 78.1 steps/s
[Step=21350 Epoch=41.6] | Loss=0.02137 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.196 | L2-Norm(final)=9.689 | 5023.4 samples/s | 78.5 steps/s
[Step=21400 Epoch=41.7] | Loss=0.02096 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.208 | L2-Norm(final)=9.688 | 5037.2 samples/s | 78.7 steps/s
[Step=21450 Epoch=41.8] | Loss=0.02062 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.219 | L2-Norm(final)=9.688 | 5084.1 samples/s | 79.4 steps/s
[Step=21500 Epoch=41.9] | Loss=0.02032 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.229 | L2-Norm(final)=9.688 | 5326.8 samples/s | 83.2 steps/s
[Step=21550 Epoch=42.0] | Loss=0.01997 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.240 | L2-Norm(final)=9.688 | 1949.8 samples/s | 30.5 steps/s
[Step=21600 Epoch=42.1] | Loss=0.01959 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.250 | L2-Norm(final)=9.689 | 5090.0 samples/s | 79.5 steps/s
[Step=21650 Epoch=42.2] | Loss=0.01929 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.259 | L2-Norm(final)=9.690 | 4970.7 samples/s | 77.7 steps/s
[Step=21700 Epoch=42.3] | Loss=0.01902 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.268 | L2-Norm(final)=9.690 | 5118.7 samples/s | 80.0 steps/s
[Step=21750 Epoch=42.4] | Loss=0.01870 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.276 | L2-Norm(final)=9.691 | 5060.5 samples/s | 79.1 steps/s
[Step=21800 Epoch=42.5] | Loss=0.01836 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.285 | L2-Norm(final)=9.692 | 5000.3 samples/s | 78.1 steps/s
[Step=21850 Epoch=42.6] | Loss=0.01822 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.293 | L2-Norm(final)=9.692 | 4987.2 samples/s | 77.9 steps/s
[Step=21900 Epoch=42.7] | Loss=0.01799 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.301 | L2-Norm(final)=9.693 | 5046.7 samples/s | 78.9 steps/s
[Step=21950 Epoch=42.8] | Loss=0.01784 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.308 | L2-Norm(final)=9.693 | 4994.5 samples/s | 78.0 steps/s
[Step=22000 Epoch=42.9] | Loss=0.01754 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.316 | L2-Norm(final)=9.694 | 4994.5 samples/s | 78.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step22000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=18001 Epoch=69.3] | Loss=0.00234 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.806 | L2-Norm(final)=10.833 | 3618.4 samples/s | 56.5 steps/s
[Step=18050 Epoch=69.5] | Loss=0.00226 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=10.837 | 5263.0 samples/s | 82.2 steps/s
[Step=18100 Epoch=69.7] | Loss=0.00140 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=10.845 | 5262.7 samples/s | 82.2 steps/s
[Step=18150 Epoch=69.9] | Loss=0.00128 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=10.854 | 5461.8 samples/s | 85.3 steps/s
[Step=18200 Epoch=70.1] | Loss=0.00114 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=10.862 | 5507.2 samples/s | 86.1 steps/s
[Step=18250 Epoch=70.3] | Loss=0.00111 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=10.872 | 7270.6 samples/s | 113.6 steps/s
[Step=18300 Epoch=70.4] | Loss=0.00106 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=10.883 | 1963.3 samples/s | 30.7 steps/s
[Step=18350 Epoch=70.6] | Loss=0.00099 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=10.893 | 5511.7 samples/s | 86.1 steps/s
[Step=18400 Epoch=70.8] | Loss=0.00108 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=10.903 | 5334.8 samples/s | 83.4 steps/s
[Step=18450 Epoch=71.0] | Loss=0.00102 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=10.912 | 5458.0 samples/s | 85.3 steps/s
[Step=18500 Epoch=71.2] | Loss=0.00102 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=10.920 | 6304.1 samples/s | 98.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=71.2] | Loss=0.01175 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.803 | L2-Norm(final)=11.001 | 3885.2 samples/s | 60.7 steps/s
[Step=18550 Epoch=71.4] | Loss=0.00107 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.815 | L2-Norm(final)=11.003 | 4501.7 samples/s | 70.3 steps/s
[Step=18600 Epoch=71.6] | Loss=0.00139 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.831 | L2-Norm(final)=11.005 | 4776.3 samples/s | 74.6 steps/s
[Step=18650 Epoch=71.8] | Loss=0.00111 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.851 | L2-Norm(final)=11.006 | 4768.5 samples/s | 74.5 steps/s
[Step=18700 Epoch=72.0] | Loss=0.00103 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.865 | L2-Norm(final)=11.007 | 4842.7 samples/s | 75.7 steps/s
[Step=18750 Epoch=72.2] | Loss=0.00087 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.875 | L2-Norm(final)=11.009 | 6044.2 samples/s | 94.4 steps/s
[Step=18800 Epoch=72.4] | Loss=0.00074 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.879 | L2-Norm(final)=11.010 | 1875.7 samples/s | 29.3 steps/s
[Step=18850 Epoch=72.6] | Loss=0.00064 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.879 | L2-Norm(final)=11.011 | 4822.3 samples/s | 75.3 steps/s
[Step=18900 Epoch=72.8] | Loss=0.00056 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.875 | L2-Norm(final)=11.013 | 4754.9 samples/s | 74.3 steps/s
[Step=18950 Epoch=72.9] | Loss=0.00050 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.870 | L2-Norm(final)=11.014 | 4712.4 samples/s | 73.6 steps/s
[Step=19000 Epoch=73.1] | Loss=0.00045 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.864 | L2-Norm(final)=11.014 | 5455.8 samples/s | 85.2 steps/s
[Step=19050 Epoch=73.3] | Loss=0.00041 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.856 | L2-Norm(final)=11.015 | 1957.1 samples/s | 30.6 steps/s
[Step=19100 Epoch=73.5] | Loss=0.00038 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.848 | L2-Norm(final)=11.016 | 4799.9 samples/s | 75.0 steps/s
[Step=19150 Epoch=73.7] | Loss=0.00035 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.839 | L2-Norm(final)=11.017 | 4812.7 samples/s | 75.2 steps/s
[Step=19200 Epoch=73.9] | Loss=0.00032 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.830 | L2-Norm(final)=11.018 | 4803.8 samples/s | 75.1 steps/s
[Step=19250 Epoch=74.1] | Loss=0.00030 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.820 | L2-Norm(final)=11.019 | 4816.4 samples/s | 75.3 steps/s
[Step=19300 Epoch=74.3] | Loss=0.00028 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.810 | L2-Norm(final)=11.020 | 2035.3 samples/s | 31.8 steps/s
[Step=19350 Epoch=74.5] | Loss=0.00027 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.800 | L2-Norm(final)=11.021 | 4838.4 samples/s | 75.6 steps/s
[Step=19400 Epoch=74.7] | Loss=0.00025 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.789 | L2-Norm(final)=11.022 | 4770.1 samples/s | 74.5 steps/s
[Step=19450 Epoch=74.9] | Loss=0.00024 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.779 | L2-Norm(final)=11.023 | 4779.9 samples/s | 74.7 steps/s
[Step=19500 Epoch=75.1] | Loss=0.00023 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.768 | L2-Norm(final)=11.024 | 4705.9 samples/s | 73.5 steps/s
[Step=19550 Epoch=75.3] | Loss=0.00022 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.757 | L2-Norm(final)=11.025 | 2070.7 samples/s | 32.4 steps/s
[Step=19600 Epoch=75.4] | Loss=0.00021 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.746 | L2-Norm(final)=11.026 | 4737.9 samples/s | 74.0 steps/s
[Step=19650 Epoch=75.6] | Loss=0.00020 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.735 | L2-Norm(final)=11.027 | 4833.8 samples/s | 75.5 steps/s
[Step=19700 Epoch=75.8] | Loss=0.00019 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.724 | L2-Norm(final)=11.028 | 4730.5 samples/s | 73.9 steps/s
[Step=19750 Epoch=76.0] | Loss=0.00018 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.712 | L2-Norm(final)=11.029 | 4849.7 samples/s | 75.8 steps/s
[Step=19800 Epoch=76.2] | Loss=0.00017 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.701 | L2-Norm(final)=11.030 | 7009.0 samples/s | 109.5 steps/s
[Step=19850 Epoch=76.4] | Loss=0.00017 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.689 | L2-Norm(final)=11.031 | 1805.5 samples/s | 28.2 steps/s
[Step=19900 Epoch=76.6] | Loss=0.00016 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.678 | L2-Norm(final)=11.032 | 4771.1 samples/s | 74.5 steps/s
[Step=19950 Epoch=76.8] | Loss=0.00016 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.666 | L2-Norm(final)=11.033 | 4795.1 samples/s | 74.9 steps/s
[Step=20000 Epoch=77.0] | Loss=0.00015 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.654 | L2-Norm(final)=11.034 | 4657.8 samples/s | 72.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_1/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07288 | acc=0.9677 | tpr=0.9772 | fpr=0.0528 | 4175.4 samples/s | 16.3 steps/s
Avg test loss: 0.07682, Avg test acc: 0.96727, Avg tpr: 0.97692, Avg fpr: 0.05397, total FA: 421

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07329 | acc=0.9638 | tpr=0.9770 | fpr=0.0647 | 4201.6 samples/s | 16.4 steps/s
Avg test loss: 0.07841, Avg test acc: 0.96382, Avg tpr: 0.97727, Avg fpr: 0.06576, total FA: 513

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.71417 | acc=0.3175 | tpr=0.0149 | fpr=0.0255 | 4153.6 samples/s | 16.2 steps/s
Avg test loss: 5.71079, Avg test acc: 0.31589, Avg tpr: 0.01533, Avg fpr: 0.02307, total FA: 180

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.76884 | acc=0.3189 | tpr=0.0291 | fpr=0.0518 | 4182.8 samples/s | 16.3 steps/s
Avg test loss: 5.79352, Avg test acc: 0.31721, Avg tpr: 0.02967, Avg fpr: 0.05038, total FA: 393

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.36338 | acc=0.1183 | tpr=0.9336 | fpr=0.8964 | 4182.0 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.36677 | acc=0.1175 | tpr=0.9360 | fpr=0.8977 | 8272.3 samples/s | 32.3 steps/s
[Step= 150] | Loss=6.39784 | acc=0.1162 | tpr=0.9337 | fpr=0.8988 | 8209.4 samples/s | 32.1 steps/s
[Step= 200] | Loss=6.40383 | acc=0.1166 | tpr=0.9311 | fpr=0.8983 | 8392.3 samples/s | 32.8 steps/s
[Step= 250] | Loss=6.40170 | acc=0.1168 | tpr=0.9249 | fpr=0.8979 | 8190.2 samples/s | 32.0 steps/s
[Step= 300] | Loss=6.40325 | acc=0.1170 | tpr=0.9200 | fpr=0.8977 | 8068.1 samples/s | 31.5 steps/s
[Step= 350] | Loss=6.40984 | acc=0.1163 | tpr=0.9236 | fpr=0.8984 | 8431.0 samples/s | 32.9 steps/s
[Step= 400] | Loss=6.41306 | acc=0.1166 | tpr=0.9234 | fpr=0.8981 | 8085.0 samples/s | 31.6 steps/s
[Step= 450] | Loss=6.41585 | acc=0.1165 | tpr=0.9260 | fpr=0.8982 | 8420.6 samples/s | 32.9 steps/s
[Step= 500] | Loss=6.41890 | acc=0.1166 | tpr=0.9264 | fpr=0.8980 | 8084.4 samples/s | 31.6 steps/s
[Step= 550] | Loss=6.42054 | acc=0.1167 | tpr=0.9268 | fpr=0.8980 | 16046.8 samples/s | 62.7 steps/s
Avg test loss: 6.42188, Avg test acc: 0.11666, Avg tpr: 0.92710, Avg fpr: 0.89808, total FA: 124696

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.14564 | acc=0.0955 | tpr=0.9159 | fpr=0.9193 | 4204.8 samples/s | 16.4 steps/s
[Step= 100] | Loss=7.12363 | acc=0.0955 | tpr=0.9104 | fpr=0.9197 | 8056.3 samples/s | 31.5 steps/s
[Step= 150] | Loss=7.15202 | acc=0.0952 | tpr=0.9107 | fpr=0.9198 | 8404.7 samples/s | 32.8 steps/s
[Step= 200] | Loss=7.15240 | acc=0.0950 | tpr=0.9104 | fpr=0.9199 | 8182.0 samples/s | 32.0 steps/s
[Step= 250] | Loss=7.15376 | acc=0.0953 | tpr=0.9092 | fpr=0.9196 | 8270.0 samples/s | 32.3 steps/s
[Step= 300] | Loss=7.15780 | acc=0.0950 | tpr=0.8989 | fpr=0.9197 | 8449.2 samples/s | 33.0 steps/s
[Step= 350] | Loss=7.15651 | acc=0.0943 | tpr=0.8967 | fpr=0.9203 | 8220.6 samples/s | 32.1 steps/s
[Step= 400] | Loss=7.16055 | acc=0.0943 | tpr=0.8955 | fpr=0.9202 | 8372.7 samples/s | 32.7 steps/s
[Step= 450] | Loss=7.16303 | acc=0.0943 | tpr=0.8987 | fpr=0.9203 | 8394.9 samples/s | 32.8 steps/s
[Step= 500] | Loss=7.16061 | acc=0.0943 | tpr=0.9018 | fpr=0.9202 | 8148.7 samples/s | 31.8 steps/s
[Step= 550] | Loss=7.15988 | acc=0.0947 | tpr=0.9037 | fpr=0.9200 | 15063.1 samples/s | 58.8 steps/s
Avg test loss: 7.16034, Avg test acc: 0.09462, Avg tpr: 0.90333, Avg fpr: 0.92009, total FA: 127752

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12436 | acc=0.9819 | tpr=0.9513 | fpr=0.0176 | 4219.2 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.13256 | acc=0.9812 | tpr=0.9467 | fpr=0.0182 | 8238.7 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.13785 | acc=0.9802 | tpr=0.9438 | fpr=0.0191 | 8280.4 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.13884 | acc=0.9805 | tpr=0.9530 | fpr=0.0190 | 8204.3 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.13511 | acc=0.9804 | tpr=0.9467 | fpr=0.0189 | 8419.4 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.13833 | acc=0.9800 | tpr=0.9433 | fpr=0.0193 | 8319.0 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.13920 | acc=0.9800 | tpr=0.9436 | fpr=0.0194 | 8043.2 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.14008 | acc=0.9797 | tpr=0.9398 | fpr=0.0196 | 8609.0 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.14230 | acc=0.9795 | tpr=0.9367 | fpr=0.0198 | 8174.8 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.14189 | acc=0.9794 | tpr=0.9383 | fpr=0.0198 | 8458.8 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.14058 | acc=0.9795 | tpr=0.9363 | fpr=0.0197 | 14852.1 samples/s | 58.0 steps/s
Avg test loss: 0.14033, Avg test acc: 0.97954, Avg tpr: 0.93621, Avg fpr: 0.01968, total FA: 2732

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12769 | acc=0.9827 | tpr=0.9602 | fpr=0.0169 | 4230.3 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.13409 | acc=0.9812 | tpr=0.9574 | fpr=0.0183 | 7710.6 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.13924 | acc=0.9802 | tpr=0.9597 | fpr=0.0194 | 8323.1 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.14178 | acc=0.9798 | tpr=0.9628 | fpr=0.0199 | 8247.3 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.13993 | acc=0.9797 | tpr=0.9624 | fpr=0.0200 | 8296.9 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.14363 | acc=0.9792 | tpr=0.9585 | fpr=0.0204 | 8132.1 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.14427 | acc=0.9792 | tpr=0.9587 | fpr=0.0205 | 8500.5 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.14569 | acc=0.9790 | tpr=0.9568 | fpr=0.0206 | 7977.4 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.14810 | acc=0.9789 | tpr=0.9567 | fpr=0.0207 | 8261.8 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.14766 | acc=0.9789 | tpr=0.9581 | fpr=0.0207 | 8555.1 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.14631 | acc=0.9791 | tpr=0.9562 | fpr=0.0205 | 13773.8 samples/s | 53.8 steps/s
Avg test loss: 0.14617, Avg test acc: 0.97910, Avg tpr: 0.95602, Avg fpr: 0.02048, total FA: 2844

server round 19/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=20001 Epoch=39.1] | Loss=0.01404 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.718 | L2-Norm(final)=9.502 | 3795.9 samples/s | 59.3 steps/s
[Step=20050 Epoch=39.2] | Loss=0.02459 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.721 | L2-Norm(final)=9.514 | 5550.9 samples/s | 86.7 steps/s
[Step=20100 Epoch=39.3] | Loss=0.02483 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.721 | L2-Norm(final)=9.528 | 5864.9 samples/s | 91.6 steps/s
[Step=20150 Epoch=39.4] | Loss=0.02375 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.722 | L2-Norm(final)=9.544 | 5909.8 samples/s | 92.3 steps/s
[Step=20200 Epoch=39.5] | Loss=0.02401 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.722 | L2-Norm(final)=9.559 | 5795.2 samples/s | 90.5 steps/s
[Step=20250 Epoch=39.6] | Loss=0.02470 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.722 | L2-Norm(final)=9.574 | 5897.4 samples/s | 92.1 steps/s
[Step=20300 Epoch=39.7] | Loss=0.02549 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.722 | L2-Norm(final)=9.586 | 5752.7 samples/s | 89.9 steps/s
[Step=20350 Epoch=39.8] | Loss=0.02543 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.722 | L2-Norm(final)=9.598 | 5748.6 samples/s | 89.8 steps/s
[Step=20400 Epoch=39.9] | Loss=0.02556 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.722 | L2-Norm(final)=9.610 | 5768.7 samples/s | 90.1 steps/s
[Step=20450 Epoch=40.0] | Loss=0.02572 | Reg=0.00188 | acc=0.9375 | L2-Norm=13.722 | L2-Norm(final)=9.621 | 5821.8 samples/s | 91.0 steps/s
[Step=20500 Epoch=40.1] | Loss=0.02536 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.722 | L2-Norm(final)=9.632 | 7418.3 samples/s | 115.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=40.1] | Loss=0.01569 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.722 | L2-Norm(final)=9.741 | 3950.7 samples/s | 61.7 steps/s
[Step=20550 Epoch=40.2] | Loss=0.02130 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.780 | L2-Norm(final)=9.743 | 4700.5 samples/s | 73.4 steps/s
[Step=20600 Epoch=40.3] | Loss=0.02271 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.835 | L2-Norm(final)=9.738 | 5064.1 samples/s | 79.1 steps/s
[Step=20650 Epoch=40.4] | Loss=0.02265 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.879 | L2-Norm(final)=9.735 | 5143.3 samples/s | 80.4 steps/s
[Step=20700 Epoch=40.5] | Loss=0.02366 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.914 | L2-Norm(final)=9.730 | 4930.5 samples/s | 77.0 steps/s
[Step=20750 Epoch=40.6] | Loss=0.02329 | Reg=0.00194 | acc=0.9531 | L2-Norm=13.944 | L2-Norm(final)=9.727 | 5047.1 samples/s | 78.9 steps/s
[Step=20800 Epoch=40.7] | Loss=0.02457 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.970 | L2-Norm(final)=9.724 | 5009.9 samples/s | 78.3 steps/s
[Step=20850 Epoch=40.8] | Loss=0.02421 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.995 | L2-Norm(final)=9.722 | 4995.2 samples/s | 78.0 steps/s
[Step=20900 Epoch=40.9] | Loss=0.02351 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.018 | L2-Norm(final)=9.721 | 5015.8 samples/s | 78.4 steps/s
[Step=20950 Epoch=41.0] | Loss=0.02374 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.039 | L2-Norm(final)=9.719 | 4946.9 samples/s | 77.3 steps/s
[Step=21000 Epoch=41.1] | Loss=0.02317 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.058 | L2-Norm(final)=9.718 | 6250.6 samples/s | 97.7 steps/s
[Step=21050 Epoch=41.2] | Loss=0.02252 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.076 | L2-Norm(final)=9.717 | 1948.1 samples/s | 30.4 steps/s
[Step=21100 Epoch=41.2] | Loss=0.02189 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.092 | L2-Norm(final)=9.717 | 5099.8 samples/s | 79.7 steps/s
[Step=21150 Epoch=41.3] | Loss=0.02116 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.107 | L2-Norm(final)=9.718 | 4964.5 samples/s | 77.6 steps/s
[Step=21200 Epoch=41.4] | Loss=0.02072 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.121 | L2-Norm(final)=9.719 | 4995.1 samples/s | 78.0 steps/s
[Step=21250 Epoch=41.5] | Loss=0.02036 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.134 | L2-Norm(final)=9.719 | 5048.3 samples/s | 78.9 steps/s
[Step=21300 Epoch=41.6] | Loss=0.02010 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.146 | L2-Norm(final)=9.719 | 4992.1 samples/s | 78.0 steps/s
[Step=21350 Epoch=41.7] | Loss=0.01982 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.158 | L2-Norm(final)=9.719 | 5046.3 samples/s | 78.8 steps/s
[Step=21400 Epoch=41.8] | Loss=0.01940 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.170 | L2-Norm(final)=9.719 | 5001.7 samples/s | 78.2 steps/s
[Step=21450 Epoch=41.9] | Loss=0.01911 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.181 | L2-Norm(final)=9.720 | 4955.9 samples/s | 77.4 steps/s
[Step=21500 Epoch=42.0] | Loss=0.01896 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.192 | L2-Norm(final)=9.721 | 5468.6 samples/s | 85.4 steps/s
[Step=21550 Epoch=42.1] | Loss=0.01878 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.202 | L2-Norm(final)=9.721 | 2023.9 samples/s | 31.6 steps/s
[Step=21600 Epoch=42.2] | Loss=0.01843 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.212 | L2-Norm(final)=9.722 | 5056.2 samples/s | 79.0 steps/s
[Step=21650 Epoch=42.3] | Loss=0.01813 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.222 | L2-Norm(final)=9.723 | 5125.8 samples/s | 80.1 steps/s
[Step=21700 Epoch=42.4] | Loss=0.01781 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.231 | L2-Norm(final)=9.723 | 4992.8 samples/s | 78.0 steps/s
[Step=21750 Epoch=42.5] | Loss=0.01756 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.239 | L2-Norm(final)=9.724 | 5009.1 samples/s | 78.3 steps/s
[Step=21800 Epoch=42.6] | Loss=0.01727 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.248 | L2-Norm(final)=9.725 | 5039.8 samples/s | 78.7 steps/s
[Step=21850 Epoch=42.7] | Loss=0.01694 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.256 | L2-Norm(final)=9.726 | 4995.3 samples/s | 78.1 steps/s
[Step=21900 Epoch=42.8] | Loss=0.01679 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.264 | L2-Norm(final)=9.727 | 5018.5 samples/s | 78.4 steps/s
[Step=21950 Epoch=42.9] | Loss=0.01663 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.272 | L2-Norm(final)=9.728 | 5111.0 samples/s | 79.9 steps/s
[Step=22000 Epoch=43.0] | Loss=0.01647 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.279 | L2-Norm(final)=9.729 | 4955.7 samples/s | 77.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step22000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00050, len=1
[Step=14001 Epoch=53.6] | Loss=0.00099 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.718 | L2-Norm(final)=9.535 | 3976.1 samples/s | 62.1 steps/s
[Step=14050 Epoch=53.8] | Loss=0.00162 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=9.551 | 4684.8 samples/s | 73.2 steps/s
[Step=14100 Epoch=54.0] | Loss=0.00193 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=9.574 | 5389.2 samples/s | 84.2 steps/s
[Step=14150 Epoch=54.2] | Loss=0.00192 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.714 | L2-Norm(final)=9.594 | 5456.0 samples/s | 85.2 steps/s
[Step=14200 Epoch=54.4] | Loss=0.00163 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=9.611 | 5498.0 samples/s | 85.9 steps/s
[Step=14250 Epoch=54.6] | Loss=0.00148 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=9.626 | 6907.5 samples/s | 107.9 steps/s
[Step=14300 Epoch=54.8] | Loss=0.00144 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=9.640 | 1969.3 samples/s | 30.8 steps/s
[Step=14350 Epoch=55.0] | Loss=0.00139 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=9.653 | 5500.3 samples/s | 85.9 steps/s
[Step=14400 Epoch=55.2] | Loss=0.00144 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=9.666 | 5340.4 samples/s | 83.4 steps/s
[Step=14450 Epoch=55.4] | Loss=0.00141 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=9.679 | 5485.9 samples/s | 85.7 steps/s
[Step=14500 Epoch=55.6] | Loss=0.00133 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=9.691 | 6122.3 samples/s | 95.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=55.6] | Loss=0.00003 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=9.814 | 4011.7 samples/s | 62.7 steps/s
[Step=14550 Epoch=55.8] | Loss=0.00289 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.749 | L2-Norm(final)=9.821 | 4394.7 samples/s | 68.7 steps/s
[Step=14600 Epoch=55.9] | Loss=0.00629 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.825 | L2-Norm(final)=9.800 | 4775.9 samples/s | 74.6 steps/s
[Step=14650 Epoch=56.1] | Loss=0.00619 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.894 | L2-Norm(final)=9.781 | 4698.1 samples/s | 73.4 steps/s
[Step=14700 Epoch=56.3] | Loss=0.00484 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.933 | L2-Norm(final)=9.769 | 4852.0 samples/s | 75.8 steps/s
[Step=14750 Epoch=56.5] | Loss=0.00405 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.956 | L2-Norm(final)=9.763 | 5927.9 samples/s | 92.6 steps/s
[Step=14800 Epoch=56.7] | Loss=0.00346 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.969 | L2-Norm(final)=9.760 | 1868.6 samples/s | 29.2 steps/s
[Step=14850 Epoch=56.9] | Loss=0.00297 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.976 | L2-Norm(final)=9.758 | 4852.7 samples/s | 75.8 steps/s
[Step=14900 Epoch=57.1] | Loss=0.00261 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.979 | L2-Norm(final)=9.757 | 4806.3 samples/s | 75.1 steps/s
[Step=14950 Epoch=57.3] | Loss=0.00238 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.979 | L2-Norm(final)=9.757 | 4678.3 samples/s | 73.1 steps/s
[Step=15000 Epoch=57.5] | Loss=0.00214 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.977 | L2-Norm(final)=9.757 | 5276.4 samples/s | 82.4 steps/s
[Step=15050 Epoch=57.7] | Loss=0.00197 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.974 | L2-Norm(final)=9.757 | 1970.7 samples/s | 30.8 steps/s
[Step=15100 Epoch=57.9] | Loss=0.00181 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.970 | L2-Norm(final)=9.757 | 4728.7 samples/s | 73.9 steps/s
[Step=15150 Epoch=58.0] | Loss=0.00167 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.965 | L2-Norm(final)=9.757 | 4784.4 samples/s | 74.8 steps/s
[Step=15200 Epoch=58.2] | Loss=0.00155 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.960 | L2-Norm(final)=9.758 | 4692.7 samples/s | 73.3 steps/s
[Step=15250 Epoch=58.4] | Loss=0.00145 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.953 | L2-Norm(final)=9.758 | 4711.1 samples/s | 73.6 steps/s
[Step=15300 Epoch=58.6] | Loss=0.00136 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.946 | L2-Norm(final)=9.758 | 2020.6 samples/s | 31.6 steps/s
[Step=15350 Epoch=58.8] | Loss=0.00128 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.938 | L2-Norm(final)=9.759 | 4865.2 samples/s | 76.0 steps/s
[Step=15400 Epoch=59.0] | Loss=0.00121 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.930 | L2-Norm(final)=9.759 | 4777.6 samples/s | 74.7 steps/s
[Step=15450 Epoch=59.2] | Loss=0.00115 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.922 | L2-Norm(final)=9.760 | 4769.7 samples/s | 74.5 steps/s
[Step=15500 Epoch=59.4] | Loss=0.00109 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.914 | L2-Norm(final)=9.760 | 4742.7 samples/s | 74.1 steps/s
[Step=15550 Epoch=59.6] | Loss=0.00104 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.905 | L2-Norm(final)=9.761 | 2085.5 samples/s | 32.6 steps/s
[Step=15600 Epoch=59.8] | Loss=0.00099 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.896 | L2-Norm(final)=9.761 | 4616.0 samples/s | 72.1 steps/s
[Step=15650 Epoch=60.0] | Loss=0.00095 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.887 | L2-Norm(final)=9.762 | 4806.3 samples/s | 75.1 steps/s
[Step=15700 Epoch=60.2] | Loss=0.00091 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.878 | L2-Norm(final)=9.762 | 4828.6 samples/s | 75.4 steps/s
[Step=15750 Epoch=60.3] | Loss=0.00087 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.869 | L2-Norm(final)=9.763 | 4789.6 samples/s | 74.8 steps/s
[Step=15800 Epoch=60.5] | Loss=0.00084 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.859 | L2-Norm(final)=9.763 | 6534.1 samples/s | 102.1 steps/s
[Step=15850 Epoch=60.7] | Loss=0.00081 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.849 | L2-Norm(final)=9.763 | 1816.4 samples/s | 28.4 steps/s
[Step=15900 Epoch=60.9] | Loss=0.00078 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.840 | L2-Norm(final)=9.764 | 4721.9 samples/s | 73.8 steps/s
[Step=15950 Epoch=61.1] | Loss=0.00075 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.830 | L2-Norm(final)=9.764 | 4758.9 samples/s | 74.4 steps/s
[Step=16000 Epoch=61.3] | Loss=0.00073 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.820 | L2-Norm(final)=9.765 | 4828.9 samples/s | 75.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07288 | acc=0.9677 | tpr=0.9772 | fpr=0.0528 | 4132.2 samples/s | 16.1 steps/s
Avg test loss: 0.07682, Avg test acc: 0.96727, Avg tpr: 0.97692, Avg fpr: 0.05397, total FA: 421

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07112 | acc=0.9652 | tpr=0.9770 | fpr=0.0605 | 4169.6 samples/s | 16.3 steps/s
Avg test loss: 0.07852, Avg test acc: 0.96430, Avg tpr: 0.97622, Avg fpr: 0.06192, total FA: 483

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.23019 | acc=0.3184 | tpr=0.0111 | fpr=0.0141 | 4195.4 samples/s | 16.4 steps/s
Avg test loss: 5.24474, Avg test acc: 0.31569, Avg tpr: 0.01102, Avg fpr: 0.01423, total FA: 111

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.76884 | acc=0.3189 | tpr=0.0291 | fpr=0.0518 | 4204.0 samples/s | 16.4 steps/s
Avg test loss: 5.79352, Avg test acc: 0.31721, Avg tpr: 0.02967, Avg fpr: 0.05038, total FA: 393

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.36338 | acc=0.1183 | tpr=0.9336 | fpr=0.8964 | 4258.7 samples/s | 16.6 steps/s
[Step= 100] | Loss=6.36677 | acc=0.1175 | tpr=0.9360 | fpr=0.8977 | 7991.0 samples/s | 31.2 steps/s
[Step= 150] | Loss=6.39784 | acc=0.1162 | tpr=0.9337 | fpr=0.8988 | 8545.2 samples/s | 33.4 steps/s
[Step= 200] | Loss=6.40383 | acc=0.1166 | tpr=0.9311 | fpr=0.8983 | 8048.7 samples/s | 31.4 steps/s
[Step= 250] | Loss=6.40170 | acc=0.1168 | tpr=0.9249 | fpr=0.8979 | 8423.6 samples/s | 32.9 steps/s
[Step= 300] | Loss=6.40325 | acc=0.1170 | tpr=0.9200 | fpr=0.8977 | 8282.1 samples/s | 32.4 steps/s
[Step= 350] | Loss=6.40984 | acc=0.1163 | tpr=0.9236 | fpr=0.8984 | 8186.1 samples/s | 32.0 steps/s
[Step= 400] | Loss=6.41306 | acc=0.1166 | tpr=0.9234 | fpr=0.8981 | 8408.3 samples/s | 32.8 steps/s
[Step= 450] | Loss=6.41585 | acc=0.1165 | tpr=0.9260 | fpr=0.8982 | 8237.8 samples/s | 32.2 steps/s
[Step= 500] | Loss=6.41890 | acc=0.1166 | tpr=0.9264 | fpr=0.8980 | 8327.4 samples/s | 32.5 steps/s
[Step= 550] | Loss=6.42054 | acc=0.1167 | tpr=0.9268 | fpr=0.8980 | 15291.6 samples/s | 59.7 steps/s
Avg test loss: 6.42188, Avg test acc: 0.11666, Avg tpr: 0.92710, Avg fpr: 0.89808, total FA: 124696

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.18934 | acc=0.0998 | tpr=0.9336 | fpr=0.9152 | 4171.2 samples/s | 16.3 steps/s
[Step= 100] | Loss=7.14741 | acc=0.1020 | tpr=0.9296 | fpr=0.9135 | 8454.7 samples/s | 33.0 steps/s
[Step= 150] | Loss=7.17779 | acc=0.1008 | tpr=0.9280 | fpr=0.9144 | 8377.5 samples/s | 32.7 steps/s
[Step= 200] | Loss=7.17864 | acc=0.1009 | tpr=0.9257 | fpr=0.9141 | 8058.8 samples/s | 31.5 steps/s
[Step= 250] | Loss=7.17828 | acc=0.1016 | tpr=0.9231 | fpr=0.9134 | 8318.0 samples/s | 32.5 steps/s
[Step= 300] | Loss=7.18338 | acc=0.1014 | tpr=0.9185 | fpr=0.9135 | 8496.3 samples/s | 33.2 steps/s
[Step= 350] | Loss=7.18433 | acc=0.1009 | tpr=0.9180 | fpr=0.9140 | 8626.0 samples/s | 33.7 steps/s
[Step= 400] | Loss=7.18526 | acc=0.1010 | tpr=0.9179 | fpr=0.9139 | 7934.0 samples/s | 31.0 steps/s
[Step= 450] | Loss=7.18599 | acc=0.1011 | tpr=0.9192 | fpr=0.9138 | 8257.9 samples/s | 32.3 steps/s
[Step= 500] | Loss=7.18490 | acc=0.1011 | tpr=0.9203 | fpr=0.9137 | 7953.5 samples/s | 31.1 steps/s
[Step= 550] | Loss=7.18461 | acc=0.1013 | tpr=0.9192 | fpr=0.9135 | 15243.3 samples/s | 59.5 steps/s
Avg test loss: 7.18552, Avg test acc: 0.10130, Avg tpr: 0.91918, Avg fpr: 0.91357, total FA: 126847

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11660 | acc=0.9820 | tpr=0.9204 | fpr=0.0169 | 4190.4 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.12182 | acc=0.9816 | tpr=0.9382 | fpr=0.0175 | 8178.8 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.12853 | acc=0.9802 | tpr=0.9380 | fpr=0.0190 | 8423.8 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.12966 | acc=0.9803 | tpr=0.9464 | fpr=0.0191 | 8537.8 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.12712 | acc=0.9805 | tpr=0.9450 | fpr=0.0189 | 7976.1 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.13019 | acc=0.9801 | tpr=0.9396 | fpr=0.0191 | 8422.3 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.13128 | acc=0.9801 | tpr=0.9430 | fpr=0.0192 | 8324.4 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.13212 | acc=0.9799 | tpr=0.9387 | fpr=0.0194 | 8442.0 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.13503 | acc=0.9797 | tpr=0.9367 | fpr=0.0196 | 8175.8 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.13437 | acc=0.9799 | tpr=0.9379 | fpr=0.0194 | 8342.4 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.13293 | acc=0.9800 | tpr=0.9355 | fpr=0.0192 | 14886.9 samples/s | 58.2 steps/s
Avg test loss: 0.13271, Avg test acc: 0.97999, Avg tpr: 0.93542, Avg fpr: 0.01920, total FA: 2666

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12769 | acc=0.9827 | tpr=0.9602 | fpr=0.0169 | 4152.8 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.13409 | acc=0.9812 | tpr=0.9574 | fpr=0.0183 | 8562.7 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.13924 | acc=0.9802 | tpr=0.9597 | fpr=0.0194 | 8190.3 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.14178 | acc=0.9798 | tpr=0.9628 | fpr=0.0199 | 8005.4 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.13993 | acc=0.9797 | tpr=0.9624 | fpr=0.0200 | 8527.2 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.14363 | acc=0.9792 | tpr=0.9585 | fpr=0.0204 | 8079.9 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.14427 | acc=0.9792 | tpr=0.9587 | fpr=0.0205 | 8513.1 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.14569 | acc=0.9790 | tpr=0.9568 | fpr=0.0206 | 8120.6 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.14810 | acc=0.9789 | tpr=0.9567 | fpr=0.0207 | 8340.4 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.14766 | acc=0.9789 | tpr=0.9581 | fpr=0.0207 | 8437.1 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.14631 | acc=0.9791 | tpr=0.9562 | fpr=0.0205 | 14374.5 samples/s | 56.2 steps/s
Avg test loss: 0.14617, Avg test acc: 0.97910, Avg tpr: 0.95602, Avg fpr: 0.02048, total FA: 2844

server round 20/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=42.9] | Loss=0.03062 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.683 | L2-Norm(final)=9.722 | 3596.8 samples/s | 56.2 steps/s
[Step=22050 Epoch=43.0] | Loss=0.02391 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=9.720 | 5244.8 samples/s | 82.0 steps/s
[Step=22100 Epoch=43.1] | Loss=0.02362 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.684 | L2-Norm(final)=9.723 | 5557.4 samples/s | 86.8 steps/s
[Step=22150 Epoch=43.2] | Loss=0.02357 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.684 | L2-Norm(final)=9.728 | 5594.0 samples/s | 87.4 steps/s
[Step=22200 Epoch=43.3] | Loss=0.02265 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=9.732 | 5637.3 samples/s | 88.1 steps/s
[Step=22250 Epoch=43.4] | Loss=0.02237 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.684 | L2-Norm(final)=9.737 | 5793.2 samples/s | 90.5 steps/s
[Step=22300 Epoch=43.5] | Loss=0.02290 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.684 | L2-Norm(final)=9.742 | 5811.3 samples/s | 90.8 steps/s
[Step=22350 Epoch=43.6] | Loss=0.02265 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=9.747 | 5822.4 samples/s | 91.0 steps/s
[Step=22400 Epoch=43.7] | Loss=0.02227 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=9.752 | 5782.3 samples/s | 90.3 steps/s
[Step=22450 Epoch=43.8] | Loss=0.02205 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=9.757 | 5750.8 samples/s | 89.9 steps/s
[Step=22500 Epoch=43.9] | Loss=0.02169 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=9.763 | 7370.8 samples/s | 115.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=43.9] | Loss=0.00928 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=9.825 | 3663.7 samples/s | 57.2 steps/s
[Step=22550 Epoch=44.0] | Loss=0.01932 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=9.830 | 4694.1 samples/s | 73.3 steps/s
[Step=22600 Epoch=44.1] | Loss=0.01696 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.712 | L2-Norm(final)=9.834 | 5051.7 samples/s | 78.9 steps/s
[Step=22650 Epoch=44.2] | Loss=0.01655 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.721 | L2-Norm(final)=9.836 | 5045.8 samples/s | 78.8 steps/s
[Step=22700 Epoch=44.3] | Loss=0.01611 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.728 | L2-Norm(final)=9.837 | 5008.1 samples/s | 78.3 steps/s
[Step=22750 Epoch=44.4] | Loss=0.01595 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.735 | L2-Norm(final)=9.837 | 5084.3 samples/s | 79.4 steps/s
[Step=22800 Epoch=44.5] | Loss=0.01583 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.740 | L2-Norm(final)=9.837 | 5035.4 samples/s | 78.7 steps/s
[Step=22850 Epoch=44.6] | Loss=0.01592 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.746 | L2-Norm(final)=9.837 | 5005.5 samples/s | 78.2 steps/s
[Step=22900 Epoch=44.7] | Loss=0.01565 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.752 | L2-Norm(final)=9.837 | 5011.3 samples/s | 78.3 steps/s
[Step=22950 Epoch=44.8] | Loss=0.01503 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.757 | L2-Norm(final)=9.838 | 5063.1 samples/s | 79.1 steps/s
[Step=23000 Epoch=44.9] | Loss=0.01499 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.762 | L2-Norm(final)=9.839 | 6144.7 samples/s | 96.0 steps/s
[Step=23050 Epoch=45.0] | Loss=0.01471 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.767 | L2-Norm(final)=9.840 | 1881.0 samples/s | 29.4 steps/s
[Step=23100 Epoch=45.1] | Loss=0.01422 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.772 | L2-Norm(final)=9.841 | 5022.9 samples/s | 78.5 steps/s
[Step=23150 Epoch=45.2] | Loss=0.01386 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.776 | L2-Norm(final)=9.842 | 4985.5 samples/s | 77.9 steps/s
[Step=23200 Epoch=45.2] | Loss=0.01342 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.779 | L2-Norm(final)=9.843 | 5030.6 samples/s | 78.6 steps/s
[Step=23250 Epoch=45.3] | Loss=0.01315 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.783 | L2-Norm(final)=9.844 | 5021.3 samples/s | 78.5 steps/s
[Step=23300 Epoch=45.4] | Loss=0.01306 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.786 | L2-Norm(final)=9.845 | 5094.2 samples/s | 79.6 steps/s
[Step=23350 Epoch=45.5] | Loss=0.01301 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.789 | L2-Norm(final)=9.846 | 4997.3 samples/s | 78.1 steps/s
[Step=23400 Epoch=45.6] | Loss=0.01277 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.792 | L2-Norm(final)=9.847 | 5044.5 samples/s | 78.8 steps/s
[Step=23450 Epoch=45.7] | Loss=0.01255 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.795 | L2-Norm(final)=9.848 | 4995.6 samples/s | 78.1 steps/s
[Step=23500 Epoch=45.8] | Loss=0.01244 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.797 | L2-Norm(final)=9.849 | 5271.6 samples/s | 82.4 steps/s
[Step=23550 Epoch=45.9] | Loss=0.01217 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.800 | L2-Norm(final)=9.850 | 1986.4 samples/s | 31.0 steps/s
[Step=23600 Epoch=46.0] | Loss=0.01205 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.802 | L2-Norm(final)=9.851 | 5010.7 samples/s | 78.3 steps/s
[Step=23650 Epoch=46.1] | Loss=0.01179 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.805 | L2-Norm(final)=9.853 | 5065.4 samples/s | 79.1 steps/s
[Step=23700 Epoch=46.2] | Loss=0.01157 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.807 | L2-Norm(final)=9.854 | 5000.3 samples/s | 78.1 steps/s
[Step=23750 Epoch=46.3] | Loss=0.01149 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.809 | L2-Norm(final)=9.855 | 5020.5 samples/s | 78.4 steps/s
[Step=23800 Epoch=46.4] | Loss=0.01132 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.812 | L2-Norm(final)=9.856 | 5104.4 samples/s | 79.8 steps/s
[Step=23850 Epoch=46.5] | Loss=0.01126 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.814 | L2-Norm(final)=9.857 | 5012.1 samples/s | 78.3 steps/s
[Step=23900 Epoch=46.6] | Loss=0.01121 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.816 | L2-Norm(final)=9.858 | 5053.3 samples/s | 79.0 steps/s
[Step=23950 Epoch=46.7] | Loss=0.01114 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.818 | L2-Norm(final)=9.860 | 5000.3 samples/s | 78.1 steps/s
[Step=24000 Epoch=46.8] | Loss=0.01112 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.820 | L2-Norm(final)=9.861 | 5018.6 samples/s | 78.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step24000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=43.0] | Loss=0.01911 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.683 | L2-Norm(final)=9.754 | 4154.0 samples/s | 64.9 steps/s
[Step=22050 Epoch=43.1] | Loss=0.02376 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.684 | L2-Norm(final)=9.758 | 4980.3 samples/s | 77.8 steps/s
[Step=22100 Epoch=43.2] | Loss=0.02242 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.684 | L2-Norm(final)=9.763 | 5842.3 samples/s | 91.3 steps/s
[Step=22150 Epoch=43.3] | Loss=0.02217 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.684 | L2-Norm(final)=9.767 | 5889.2 samples/s | 92.0 steps/s
[Step=22200 Epoch=43.4] | Loss=0.02221 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=9.773 | 5768.2 samples/s | 90.1 steps/s
[Step=22250 Epoch=43.5] | Loss=0.02191 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.684 | L2-Norm(final)=9.779 | 5887.3 samples/s | 92.0 steps/s
[Step=22300 Epoch=43.6] | Loss=0.02223 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.684 | L2-Norm(final)=9.785 | 5876.9 samples/s | 91.8 steps/s
[Step=22350 Epoch=43.7] | Loss=0.02219 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.684 | L2-Norm(final)=9.790 | 5647.0 samples/s | 88.2 steps/s
[Step=22400 Epoch=43.8] | Loss=0.02176 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.684 | L2-Norm(final)=9.796 | 5797.5 samples/s | 90.6 steps/s
[Step=22450 Epoch=43.9] | Loss=0.02220 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=9.802 | 5725.6 samples/s | 89.5 steps/s
[Step=22500 Epoch=44.0] | Loss=0.02233 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.684 | L2-Norm(final)=9.807 | 7436.8 samples/s | 116.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=44.0] | Loss=0.01109 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=9.863 | 3793.9 samples/s | 59.3 steps/s
[Step=22550 Epoch=44.1] | Loss=0.01917 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.699 | L2-Norm(final)=9.865 | 4977.5 samples/s | 77.8 steps/s
[Step=22600 Epoch=44.2] | Loss=0.01808 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.713 | L2-Norm(final)=9.868 | 5073.6 samples/s | 79.3 steps/s
[Step=22650 Epoch=44.3] | Loss=0.01748 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.723 | L2-Norm(final)=9.868 | 4987.6 samples/s | 77.9 steps/s
[Step=22700 Epoch=44.4] | Loss=0.01658 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.730 | L2-Norm(final)=9.870 | 5026.1 samples/s | 78.5 steps/s
[Step=22750 Epoch=44.5] | Loss=0.01667 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.738 | L2-Norm(final)=9.871 | 5064.1 samples/s | 79.1 steps/s
[Step=22800 Epoch=44.6] | Loss=0.01608 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.744 | L2-Norm(final)=9.872 | 5024.2 samples/s | 78.5 steps/s
[Step=22850 Epoch=44.7] | Loss=0.01545 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.750 | L2-Norm(final)=9.874 | 5073.0 samples/s | 79.3 steps/s
[Step=22900 Epoch=44.8] | Loss=0.01548 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.755 | L2-Norm(final)=9.874 | 5076.6 samples/s | 79.3 steps/s
[Step=22950 Epoch=44.9] | Loss=0.01530 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.760 | L2-Norm(final)=9.875 | 5060.0 samples/s | 79.1 steps/s
[Step=23000 Epoch=45.0] | Loss=0.01481 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.765 | L2-Norm(final)=9.876 | 6170.3 samples/s | 96.4 steps/s
[Step=23050 Epoch=45.1] | Loss=0.01449 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.770 | L2-Norm(final)=9.877 | 1932.5 samples/s | 30.2 steps/s
[Step=23100 Epoch=45.2] | Loss=0.01400 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.774 | L2-Norm(final)=9.878 | 5026.8 samples/s | 78.5 steps/s
[Step=23150 Epoch=45.3] | Loss=0.01359 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.777 | L2-Norm(final)=9.880 | 5071.8 samples/s | 79.2 steps/s
[Step=23200 Epoch=45.4] | Loss=0.01323 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.781 | L2-Norm(final)=9.881 | 5057.3 samples/s | 79.0 steps/s
[Step=23250 Epoch=45.5] | Loss=0.01299 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=9.882 | 4994.2 samples/s | 78.0 steps/s
[Step=23300 Epoch=45.6] | Loss=0.01277 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.788 | L2-Norm(final)=9.884 | 4996.3 samples/s | 78.1 steps/s
[Step=23350 Epoch=45.6] | Loss=0.01266 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.791 | L2-Norm(final)=9.885 | 5076.5 samples/s | 79.3 steps/s
[Step=23400 Epoch=45.7] | Loss=0.01257 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.795 | L2-Norm(final)=9.886 | 5022.1 samples/s | 78.5 steps/s
[Step=23450 Epoch=45.8] | Loss=0.01242 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.798 | L2-Norm(final)=9.887 | 5046.9 samples/s | 78.9 steps/s
[Step=23500 Epoch=45.9] | Loss=0.01232 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.802 | L2-Norm(final)=9.888 | 5501.9 samples/s | 86.0 steps/s
[Step=23550 Epoch=46.0] | Loss=0.01216 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.805 | L2-Norm(final)=9.889 | 2010.7 samples/s | 31.4 steps/s
[Step=23600 Epoch=46.1] | Loss=0.01189 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.808 | L2-Norm(final)=9.891 | 5065.5 samples/s | 79.1 steps/s
[Step=23650 Epoch=46.2] | Loss=0.01179 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.811 | L2-Norm(final)=9.892 | 5014.3 samples/s | 78.3 steps/s
[Step=23700 Epoch=46.3] | Loss=0.01162 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.814 | L2-Norm(final)=9.893 | 5023.9 samples/s | 78.5 steps/s
[Step=23750 Epoch=46.4] | Loss=0.01140 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.816 | L2-Norm(final)=9.895 | 5017.0 samples/s | 78.4 steps/s
[Step=23800 Epoch=46.5] | Loss=0.01124 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.819 | L2-Norm(final)=9.896 | 5018.2 samples/s | 78.4 steps/s
[Step=23850 Epoch=46.6] | Loss=0.01111 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.821 | L2-Norm(final)=9.897 | 5084.8 samples/s | 79.5 steps/s
[Step=23900 Epoch=46.7] | Loss=0.01108 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.824 | L2-Norm(final)=9.899 | 4949.1 samples/s | 77.3 steps/s
[Step=23950 Epoch=46.8] | Loss=0.01098 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.826 | L2-Norm(final)=9.900 | 5021.0 samples/s | 78.5 steps/s
[Step=24000 Epoch=46.9] | Loss=0.01101 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.828 | L2-Norm(final)=9.901 | 5032.6 samples/s | 78.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06296 | acc=0.9689 | tpr=0.9751 | fpr=0.0446 | 4136.9 samples/s | 16.2 steps/s
Avg test loss: 0.06522, Avg test acc: 0.96855, Avg tpr: 0.97488, Avg fpr: 0.04538, total FA: 354

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06398 | acc=0.9668 | tpr=0.9711 | fpr=0.0426 | 4210.5 samples/s | 16.4 steps/s
Avg test loss: 0.07035, Avg test acc: 0.96554, Avg tpr: 0.97062, Avg fpr: 0.04564, total FA: 356

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.23019 | acc=0.3184 | tpr=0.0111 | fpr=0.0141 | 4184.1 samples/s | 16.3 steps/s
Avg test loss: 5.24474, Avg test acc: 0.31569, Avg tpr: 0.01102, Avg fpr: 0.01423, total FA: 111

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.76884 | acc=0.3189 | tpr=0.0291 | fpr=0.0518 | 4203.8 samples/s | 16.4 steps/s
Avg test loss: 5.79352, Avg test acc: 0.31721, Avg tpr: 0.02967, Avg fpr: 0.05038, total FA: 393

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.43277 | acc=0.1040 | tpr=0.9336 | fpr=0.9109 | 4127.9 samples/s | 16.1 steps/s
[Step= 100] | Loss=6.42932 | acc=0.1046 | tpr=0.9254 | fpr=0.9107 | 8473.3 samples/s | 33.1 steps/s
[Step= 150] | Loss=6.45361 | acc=0.1046 | tpr=0.9265 | fpr=0.9105 | 8058.6 samples/s | 31.5 steps/s
[Step= 200] | Loss=6.45549 | acc=0.1051 | tpr=0.9279 | fpr=0.9099 | 8555.8 samples/s | 33.4 steps/s
[Step= 250] | Loss=6.45457 | acc=0.1057 | tpr=0.9275 | fpr=0.9093 | 8367.6 samples/s | 32.7 steps/s
[Step= 300] | Loss=6.45714 | acc=0.1059 | tpr=0.9236 | fpr=0.9090 | 8182.0 samples/s | 32.0 steps/s
[Step= 350] | Loss=6.46104 | acc=0.1053 | tpr=0.9249 | fpr=0.9096 | 8378.7 samples/s | 32.7 steps/s
[Step= 400] | Loss=6.46264 | acc=0.1057 | tpr=0.9256 | fpr=0.9092 | 8376.9 samples/s | 32.7 steps/s
[Step= 450] | Loss=6.46568 | acc=0.1057 | tpr=0.9270 | fpr=0.9092 | 8241.5 samples/s | 32.2 steps/s
[Step= 500] | Loss=6.46599 | acc=0.1057 | tpr=0.9278 | fpr=0.9091 | 8283.3 samples/s | 32.4 steps/s
[Step= 550] | Loss=6.46356 | acc=0.1059 | tpr=0.9296 | fpr=0.9090 | 15127.8 samples/s | 59.1 steps/s
Avg test loss: 6.46455, Avg test acc: 0.10589, Avg tpr: 0.92948, Avg fpr: 0.90908, total FA: 126224

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.15512 | acc=0.1104 | tpr=0.9204 | fpr=0.9042 | 4179.4 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.14412 | acc=0.1114 | tpr=0.8955 | fpr=0.9033 | 8312.5 samples/s | 32.5 steps/s
[Step= 150] | Loss=6.16680 | acc=0.1111 | tpr=0.8919 | fpr=0.9033 | 8277.8 samples/s | 32.3 steps/s
[Step= 200] | Loss=6.16660 | acc=0.1110 | tpr=0.8885 | fpr=0.9032 | 8257.0 samples/s | 32.3 steps/s
[Step= 250] | Loss=6.16583 | acc=0.1119 | tpr=0.8900 | fpr=0.9022 | 8661.6 samples/s | 33.8 steps/s
[Step= 300] | Loss=6.16903 | acc=0.1121 | tpr=0.8902 | fpr=0.9021 | 8002.6 samples/s | 31.3 steps/s
[Step= 350] | Loss=6.16990 | acc=0.1115 | tpr=0.8917 | fpr=0.9026 | 8642.2 samples/s | 33.8 steps/s
[Step= 400] | Loss=6.17098 | acc=0.1115 | tpr=0.8906 | fpr=0.9027 | 8124.4 samples/s | 31.7 steps/s
[Step= 450] | Loss=6.17647 | acc=0.1114 | tpr=0.8919 | fpr=0.9027 | 8202.2 samples/s | 32.0 steps/s
[Step= 500] | Loss=6.17592 | acc=0.1115 | tpr=0.8934 | fpr=0.9026 | 8436.3 samples/s | 33.0 steps/s
[Step= 550] | Loss=6.17522 | acc=0.1116 | tpr=0.8930 | fpr=0.9026 | 14474.3 samples/s | 56.5 steps/s
Avg test loss: 6.17658, Avg test acc: 0.11161, Avg tpr: 0.89303, Avg fpr: 0.90260, total FA: 125324

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11660 | acc=0.9820 | tpr=0.9204 | fpr=0.0169 | 4183.4 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.12182 | acc=0.9816 | tpr=0.9382 | fpr=0.0175 | 8368.0 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.12853 | acc=0.9802 | tpr=0.9380 | fpr=0.0190 | 8598.6 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.12966 | acc=0.9803 | tpr=0.9464 | fpr=0.0191 | 7804.7 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.12712 | acc=0.9805 | tpr=0.9450 | fpr=0.0189 | 8260.0 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.13019 | acc=0.9801 | tpr=0.9396 | fpr=0.0191 | 8481.6 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.13128 | acc=0.9801 | tpr=0.9430 | fpr=0.0192 | 8188.8 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.13212 | acc=0.9799 | tpr=0.9387 | fpr=0.0194 | 8625.6 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.13503 | acc=0.9797 | tpr=0.9367 | fpr=0.0196 | 8252.6 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.13437 | acc=0.9799 | tpr=0.9379 | fpr=0.0194 | 8340.7 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.13293 | acc=0.9800 | tpr=0.9355 | fpr=0.0192 | 14533.2 samples/s | 56.8 steps/s
Avg test loss: 0.13271, Avg test acc: 0.97999, Avg tpr: 0.93542, Avg fpr: 0.01920, total FA: 2666

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12769 | acc=0.9827 | tpr=0.9602 | fpr=0.0169 | 4235.0 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.13409 | acc=0.9812 | tpr=0.9574 | fpr=0.0183 | 8016.5 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.13924 | acc=0.9802 | tpr=0.9597 | fpr=0.0194 | 8308.1 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.14178 | acc=0.9798 | tpr=0.9628 | fpr=0.0199 | 8253.9 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.13993 | acc=0.9797 | tpr=0.9624 | fpr=0.0200 | 8351.3 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.14363 | acc=0.9792 | tpr=0.9585 | fpr=0.0204 | 8513.7 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.14427 | acc=0.9792 | tpr=0.9587 | fpr=0.0205 | 8448.4 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.14569 | acc=0.9790 | tpr=0.9568 | fpr=0.0206 | 8098.0 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.14810 | acc=0.9789 | tpr=0.9567 | fpr=0.0207 | 8506.0 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.14766 | acc=0.9789 | tpr=0.9581 | fpr=0.0207 | 7987.1 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.14631 | acc=0.9791 | tpr=0.9562 | fpr=0.0205 | 15590.6 samples/s | 60.9 steps/s
Avg test loss: 0.14617, Avg test acc: 0.97910, Avg tpr: 0.95602, Avg fpr: 0.02048, total FA: 2844

server round 21/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=16001 Epoch=61.3] | Loss=0.00078 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.494 | L2-Norm(final)=9.778 | 3917.4 samples/s | 61.2 steps/s
[Step=16050 Epoch=61.5] | Loss=0.00151 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=9.782 | 4606.3 samples/s | 72.0 steps/s
[Step=16100 Epoch=61.7] | Loss=0.00101 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=9.789 | 5524.6 samples/s | 86.3 steps/s
[Step=16150 Epoch=61.9] | Loss=0.00093 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=9.795 | 5512.9 samples/s | 86.1 steps/s
[Step=16200 Epoch=62.1] | Loss=0.00090 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=9.800 | 5385.2 samples/s | 84.1 steps/s
[Step=16250 Epoch=62.3] | Loss=0.00084 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=9.806 | 7221.2 samples/s | 112.8 steps/s
[Step=16300 Epoch=62.5] | Loss=0.00080 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=9.812 | 1946.0 samples/s | 30.4 steps/s
[Step=16350 Epoch=62.6] | Loss=0.00072 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=9.817 | 5559.7 samples/s | 86.9 steps/s
[Step=16400 Epoch=62.8] | Loss=0.00071 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.492 | L2-Norm(final)=9.822 | 5387.5 samples/s | 84.2 steps/s
[Step=16450 Epoch=63.0] | Loss=0.00070 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=9.827 | 5541.2 samples/s | 86.6 steps/s
[Step=16500 Epoch=63.2] | Loss=0.00068 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=9.832 | 6104.9 samples/s | 95.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=16501 Epoch=63.2] | Loss=0.00049 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=9.885 | 3597.4 samples/s | 56.2 steps/s
[Step=16550 Epoch=63.4] | Loss=0.00010 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.488 | L2-Norm(final)=9.889 | 4859.9 samples/s | 75.9 steps/s
[Step=16600 Epoch=63.6] | Loss=0.00008 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=9.891 | 4916.3 samples/s | 76.8 steps/s
[Step=16650 Epoch=63.8] | Loss=0.00009 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.474 | L2-Norm(final)=9.892 | 4778.4 samples/s | 74.7 steps/s
[Step=16700 Epoch=64.0] | Loss=0.00008 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.469 | L2-Norm(final)=9.894 | 4753.8 samples/s | 74.3 steps/s
[Step=16750 Epoch=64.2] | Loss=0.00007 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.462 | L2-Norm(final)=9.896 | 6027.3 samples/s | 94.2 steps/s
[Step=16800 Epoch=64.4] | Loss=0.00006 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.455 | L2-Norm(final)=9.897 | 1891.0 samples/s | 29.5 steps/s
[Step=16850 Epoch=64.6] | Loss=0.00005 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.447 | L2-Norm(final)=9.898 | 4732.6 samples/s | 73.9 steps/s
[Step=16900 Epoch=64.8] | Loss=0.00005 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.438 | L2-Norm(final)=9.898 | 4814.8 samples/s | 75.2 steps/s
[Step=16950 Epoch=64.9] | Loss=0.00004 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.430 | L2-Norm(final)=9.899 | 4712.6 samples/s | 73.6 steps/s
[Step=17000 Epoch=65.1] | Loss=0.00004 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.421 | L2-Norm(final)=9.900 | 5273.4 samples/s | 82.4 steps/s
[Step=17050 Epoch=65.3] | Loss=0.00003 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.412 | L2-Norm(final)=9.900 | 1971.0 samples/s | 30.8 steps/s
[Step=17100 Epoch=65.5] | Loss=0.00003 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.403 | L2-Norm(final)=9.901 | 4740.6 samples/s | 74.1 steps/s
[Step=17150 Epoch=65.7] | Loss=0.00003 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.394 | L2-Norm(final)=9.901 | 4802.8 samples/s | 75.0 steps/s
[Step=17200 Epoch=65.9] | Loss=0.00003 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.385 | L2-Norm(final)=9.902 | 4746.1 samples/s | 74.2 steps/s
[Step=17250 Epoch=66.1] | Loss=0.00003 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.376 | L2-Norm(final)=9.902 | 4792.9 samples/s | 74.9 steps/s
[Step=17300 Epoch=66.3] | Loss=0.00003 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.367 | L2-Norm(final)=9.903 | 2020.3 samples/s | 31.6 steps/s
[Step=17350 Epoch=66.5] | Loss=0.00002 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.358 | L2-Norm(final)=9.903 | 5004.9 samples/s | 78.2 steps/s
[Step=17400 Epoch=66.7] | Loss=0.00002 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=9.903 | 4756.1 samples/s | 74.3 steps/s
[Step=17450 Epoch=66.9] | Loss=0.00002 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.339 | L2-Norm(final)=9.904 | 4678.7 samples/s | 73.1 steps/s
[Step=17500 Epoch=67.1] | Loss=0.00002 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.330 | L2-Norm(final)=9.904 | 4804.0 samples/s | 75.1 steps/s
[Step=17550 Epoch=67.2] | Loss=0.00002 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.320 | L2-Norm(final)=9.905 | 2066.4 samples/s | 32.3 steps/s
[Step=17600 Epoch=67.4] | Loss=0.00002 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=9.905 | 4805.8 samples/s | 75.1 steps/s
[Step=17650 Epoch=67.6] | Loss=0.00002 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.301 | L2-Norm(final)=9.905 | 4708.5 samples/s | 73.6 steps/s
[Step=17700 Epoch=67.8] | Loss=0.00002 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.291 | L2-Norm(final)=9.906 | 4796.1 samples/s | 74.9 steps/s
[Step=17750 Epoch=68.0] | Loss=0.00002 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.282 | L2-Norm(final)=9.906 | 4727.1 samples/s | 73.9 steps/s
[Step=17800 Epoch=68.2] | Loss=0.00002 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.272 | L2-Norm(final)=9.906 | 6534.3 samples/s | 102.1 steps/s
[Step=17850 Epoch=68.4] | Loss=0.00002 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.262 | L2-Norm(final)=9.907 | 1840.6 samples/s | 28.8 steps/s
[Step=17900 Epoch=68.6] | Loss=0.00002 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.252 | L2-Norm(final)=9.907 | 4790.4 samples/s | 74.8 steps/s
[Step=17950 Epoch=68.8] | Loss=0.00002 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.242 | L2-Norm(final)=9.908 | 4672.7 samples/s | 73.0 steps/s
[Step=18000 Epoch=69.0] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.232 | L2-Norm(final)=9.908 | 4811.8 samples/s | 75.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step18000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=20001 Epoch=77.0] | Loss=0.00003 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.494 | L2-Norm(final)=11.066 | 4157.9 samples/s | 65.0 steps/s
[Step=20050 Epoch=77.2] | Loss=0.00065 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=11.073 | 5044.7 samples/s | 78.8 steps/s
[Step=20100 Epoch=77.4] | Loss=0.00065 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=11.081 | 5239.9 samples/s | 81.9 steps/s
[Step=20150 Epoch=77.6] | Loss=0.00056 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=11.091 | 5508.7 samples/s | 86.1 steps/s
[Step=20200 Epoch=77.8] | Loss=0.00047 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=11.100 | 5480.6 samples/s | 85.6 steps/s
[Step=20250 Epoch=78.0] | Loss=0.00053 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=11.108 | 7316.5 samples/s | 114.3 steps/s
[Step=20300 Epoch=78.1] | Loss=0.00056 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=11.115 | 1948.9 samples/s | 30.5 steps/s
[Step=20350 Epoch=78.3] | Loss=0.00053 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=11.122 | 5450.6 samples/s | 85.2 steps/s
[Step=20400 Epoch=78.5] | Loss=0.00059 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=11.128 | 5456.5 samples/s | 85.3 steps/s
[Step=20450 Epoch=78.7] | Loss=0.00058 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=11.135 | 5535.0 samples/s | 86.5 steps/s
[Step=20500 Epoch=78.9] | Loss=0.00055 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=11.142 | 6311.4 samples/s | 98.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=78.9] | Loss=0.00004 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=11.204 | 3949.2 samples/s | 61.7 steps/s
[Step=20550 Epoch=79.1] | Loss=0.00112 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.495 | L2-Norm(final)=11.208 | 4349.6 samples/s | 68.0 steps/s
[Step=20600 Epoch=79.3] | Loss=0.00126 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.507 | L2-Norm(final)=11.210 | 4787.2 samples/s | 74.8 steps/s
[Step=20650 Epoch=79.5] | Loss=0.00107 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.517 | L2-Norm(final)=11.211 | 4769.7 samples/s | 74.5 steps/s
[Step=20700 Epoch=79.7] | Loss=0.00082 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.521 | L2-Norm(final)=11.210 | 4820.1 samples/s | 75.3 steps/s
[Step=20750 Epoch=79.9] | Loss=0.00098 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.522 | L2-Norm(final)=11.210 | 5981.7 samples/s | 93.5 steps/s
[Step=20800 Epoch=80.1] | Loss=0.00089 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=11.209 | 1864.9 samples/s | 29.1 steps/s
[Step=20850 Epoch=80.3] | Loss=0.00076 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.527 | L2-Norm(final)=11.209 | 4797.2 samples/s | 75.0 steps/s
[Step=20900 Epoch=80.5] | Loss=0.00067 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.527 | L2-Norm(final)=11.209 | 4810.0 samples/s | 75.2 steps/s
[Step=20950 Epoch=80.6] | Loss=0.00060 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=11.209 | 4745.4 samples/s | 74.1 steps/s
[Step=21000 Epoch=80.8] | Loss=0.00054 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.523 | L2-Norm(final)=11.209 | 5437.3 samples/s | 85.0 steps/s
[Step=21050 Epoch=81.0] | Loss=0.00049 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.520 | L2-Norm(final)=11.210 | 1965.1 samples/s | 30.7 steps/s
[Step=21100 Epoch=81.2] | Loss=0.00045 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.517 | L2-Norm(final)=11.210 | 4819.1 samples/s | 75.3 steps/s
[Step=21150 Epoch=81.4] | Loss=0.00042 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.513 | L2-Norm(final)=11.210 | 4762.4 samples/s | 74.4 steps/s
[Step=21200 Epoch=81.6] | Loss=0.00039 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.508 | L2-Norm(final)=11.210 | 4804.7 samples/s | 75.1 steps/s
[Step=21250 Epoch=81.8] | Loss=0.00036 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.504 | L2-Norm(final)=11.211 | 4878.2 samples/s | 76.2 steps/s
[Step=21300 Epoch=82.0] | Loss=0.00034 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.499 | L2-Norm(final)=11.211 | 2027.4 samples/s | 31.7 steps/s
[Step=21350 Epoch=82.2] | Loss=0.00032 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.494 | L2-Norm(final)=11.211 | 4877.0 samples/s | 76.2 steps/s
[Step=21400 Epoch=82.4] | Loss=0.00030 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.489 | L2-Norm(final)=11.211 | 4811.5 samples/s | 75.2 steps/s
[Step=21450 Epoch=82.6] | Loss=0.00029 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.484 | L2-Norm(final)=11.211 | 4782.2 samples/s | 74.7 steps/s
[Step=21500 Epoch=82.8] | Loss=0.00027 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=11.212 | 4810.4 samples/s | 75.2 steps/s
[Step=21550 Epoch=83.0] | Loss=0.00026 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.472 | L2-Norm(final)=11.212 | 2058.9 samples/s | 32.2 steps/s
[Step=21600 Epoch=83.1] | Loss=0.00025 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.467 | L2-Norm(final)=11.212 | 4824.1 samples/s | 75.4 steps/s
[Step=21650 Epoch=83.3] | Loss=0.00024 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.461 | L2-Norm(final)=11.212 | 4705.3 samples/s | 73.5 steps/s
[Step=21700 Epoch=83.5] | Loss=0.00023 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.455 | L2-Norm(final)=11.213 | 4764.4 samples/s | 74.4 steps/s
[Step=21750 Epoch=83.7] | Loss=0.00022 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.449 | L2-Norm(final)=11.213 | 4627.1 samples/s | 72.3 steps/s
[Step=21800 Epoch=83.9] | Loss=0.00021 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.442 | L2-Norm(final)=11.213 | 7099.4 samples/s | 110.9 steps/s
[Step=21850 Epoch=84.1] | Loss=0.00020 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.436 | L2-Norm(final)=11.213 | 1801.6 samples/s | 28.2 steps/s
[Step=21900 Epoch=84.3] | Loss=0.00019 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.430 | L2-Norm(final)=11.214 | 4770.1 samples/s | 74.5 steps/s
[Step=21950 Epoch=84.5] | Loss=0.00019 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.423 | L2-Norm(final)=11.214 | 4719.5 samples/s | 73.7 steps/s
[Step=22000 Epoch=84.7] | Loss=0.00018 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=11.214 | 4778.9 samples/s | 74.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_1/client_state-step22000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06296 | acc=0.9689 | tpr=0.9751 | fpr=0.0446 | 4213.0 samples/s | 16.5 steps/s
Avg test loss: 0.06522, Avg test acc: 0.96855, Avg tpr: 0.97488, Avg fpr: 0.04538, total FA: 354

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06398 | acc=0.9668 | tpr=0.9711 | fpr=0.0426 | 4151.5 samples/s | 16.2 steps/s
Avg test loss: 0.07035, Avg test acc: 0.96554, Avg tpr: 0.97062, Avg fpr: 0.04564, total FA: 356

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.33779 | acc=0.3227 | tpr=0.0251 | fpr=0.0312 | 4136.4 samples/s | 16.2 steps/s
Avg test loss: 5.34625, Avg test acc: 0.32014, Avg tpr: 0.02471, Avg fpr: 0.03012, total FA: 235

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.69684 | acc=0.3230 | tpr=0.0277 | fpr=0.0357 | 4198.4 samples/s | 16.4 steps/s
Avg test loss: 5.70341, Avg test acc: 0.32098, Avg tpr: 0.02751, Avg fpr: 0.03359, total FA: 262

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.43277 | acc=0.1040 | tpr=0.9336 | fpr=0.9109 | 4166.1 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.42932 | acc=0.1046 | tpr=0.9254 | fpr=0.9107 | 8398.6 samples/s | 32.8 steps/s
[Step= 150] | Loss=6.45361 | acc=0.1046 | tpr=0.9265 | fpr=0.9105 | 8134.7 samples/s | 31.8 steps/s
[Step= 200] | Loss=6.45549 | acc=0.1051 | tpr=0.9279 | fpr=0.9099 | 8334.2 samples/s | 32.6 steps/s
[Step= 250] | Loss=6.45457 | acc=0.1057 | tpr=0.9275 | fpr=0.9093 | 8255.4 samples/s | 32.2 steps/s
[Step= 300] | Loss=6.45714 | acc=0.1059 | tpr=0.9236 | fpr=0.9090 | 8290.4 samples/s | 32.4 steps/s
[Step= 350] | Loss=6.46104 | acc=0.1053 | tpr=0.9249 | fpr=0.9096 | 8498.3 samples/s | 33.2 steps/s
[Step= 400] | Loss=6.46264 | acc=0.1057 | tpr=0.9256 | fpr=0.9092 | 8230.9 samples/s | 32.2 steps/s
[Step= 450] | Loss=6.46568 | acc=0.1057 | tpr=0.9270 | fpr=0.9092 | 8300.1 samples/s | 32.4 steps/s
[Step= 500] | Loss=6.46599 | acc=0.1057 | tpr=0.9278 | fpr=0.9091 | 7899.2 samples/s | 30.9 steps/s
[Step= 550] | Loss=6.46356 | acc=0.1059 | tpr=0.9296 | fpr=0.9090 | 15156.3 samples/s | 59.2 steps/s
Avg test loss: 6.46455, Avg test acc: 0.10589, Avg tpr: 0.92948, Avg fpr: 0.90908, total FA: 126224

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.15512 | acc=0.1104 | tpr=0.9204 | fpr=0.9042 | 4203.6 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.14412 | acc=0.1114 | tpr=0.8955 | fpr=0.9033 | 8190.1 samples/s | 32.0 steps/s
[Step= 150] | Loss=6.16680 | acc=0.1111 | tpr=0.8919 | fpr=0.9033 | 9138.9 samples/s | 35.7 steps/s
[Step= 200] | Loss=6.16660 | acc=0.1110 | tpr=0.8885 | fpr=0.9032 | 7673.2 samples/s | 30.0 steps/s
[Step= 250] | Loss=6.16583 | acc=0.1119 | tpr=0.8900 | fpr=0.9022 | 8141.7 samples/s | 31.8 steps/s
[Step= 300] | Loss=6.16903 | acc=0.1121 | tpr=0.8902 | fpr=0.9021 | 8147.7 samples/s | 31.8 steps/s
[Step= 350] | Loss=6.16990 | acc=0.1115 | tpr=0.8917 | fpr=0.9026 | 8387.5 samples/s | 32.8 steps/s
[Step= 400] | Loss=6.17098 | acc=0.1115 | tpr=0.8906 | fpr=0.9027 | 8005.0 samples/s | 31.3 steps/s
[Step= 450] | Loss=6.17647 | acc=0.1114 | tpr=0.8919 | fpr=0.9027 | 8364.0 samples/s | 32.7 steps/s
[Step= 500] | Loss=6.17592 | acc=0.1115 | tpr=0.8934 | fpr=0.9026 | 8334.4 samples/s | 32.6 steps/s
[Step= 550] | Loss=6.17522 | acc=0.1116 | tpr=0.8930 | fpr=0.9026 | 14507.7 samples/s | 56.7 steps/s
Avg test loss: 6.17658, Avg test acc: 0.11161, Avg tpr: 0.89303, Avg fpr: 0.90260, total FA: 125324

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10208 | acc=0.9826 | tpr=0.9469 | fpr=0.0168 | 4214.3 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.10725 | acc=0.9821 | tpr=0.9510 | fpr=0.0173 | 8104.9 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.11172 | acc=0.9810 | tpr=0.9510 | fpr=0.0184 | 8289.2 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.11270 | acc=0.9811 | tpr=0.9563 | fpr=0.0185 | 8485.1 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.11086 | acc=0.9812 | tpr=0.9555 | fpr=0.0183 | 8347.2 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.11382 | acc=0.9808 | tpr=0.9527 | fpr=0.0186 | 7936.6 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.11435 | acc=0.9808 | tpr=0.9524 | fpr=0.0187 | 8332.4 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.11526 | acc=0.9806 | tpr=0.9524 | fpr=0.0189 | 8234.1 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.11729 | acc=0.9804 | tpr=0.9518 | fpr=0.0191 | 8433.7 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.11679 | acc=0.9805 | tpr=0.9533 | fpr=0.0190 | 8073.9 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.11542 | acc=0.9806 | tpr=0.9515 | fpr=0.0189 | 15522.5 samples/s | 60.6 steps/s
Avg test loss: 0.11531, Avg test acc: 0.98060, Avg tpr: 0.95127, Avg fpr: 0.01887, total FA: 2620

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12663 | acc=0.9818 | tpr=0.9425 | fpr=0.0175 | 4194.2 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.13396 | acc=0.9802 | tpr=0.9510 | fpr=0.0193 | 8200.9 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.14065 | acc=0.9793 | tpr=0.9582 | fpr=0.0203 | 8314.7 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.14256 | acc=0.9794 | tpr=0.9639 | fpr=0.0203 | 8250.8 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.14007 | acc=0.9796 | tpr=0.9598 | fpr=0.0201 | 8349.4 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.14395 | acc=0.9792 | tpr=0.9585 | fpr=0.0204 | 8316.5 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.14441 | acc=0.9792 | tpr=0.9599 | fpr=0.0204 | 8254.8 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.14582 | acc=0.9789 | tpr=0.9568 | fpr=0.0207 | 8339.1 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.14855 | acc=0.9787 | tpr=0.9547 | fpr=0.0209 | 8474.3 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.14810 | acc=0.9787 | tpr=0.9559 | fpr=0.0209 | 8250.6 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.14610 | acc=0.9789 | tpr=0.9530 | fpr=0.0206 | 14578.7 samples/s | 56.9 steps/s
Avg test loss: 0.14591, Avg test acc: 0.97888, Avg tpr: 0.95285, Avg fpr: 0.02065, total FA: 2867

server round 22/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=46.8] | Loss=0.01106 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.386 | L2-Norm(final)=9.889 | 3480.5 samples/s | 54.4 steps/s
[Step=24050 Epoch=46.9] | Loss=0.01502 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.386 | L2-Norm(final)=9.891 | 5591.1 samples/s | 87.4 steps/s
[Step=24100 Epoch=47.0] | Loss=0.01479 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.386 | L2-Norm(final)=9.896 | 5788.5 samples/s | 90.4 steps/s
[Step=24150 Epoch=47.1] | Loss=0.01501 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.386 | L2-Norm(final)=9.902 | 5831.0 samples/s | 91.1 steps/s
[Step=24200 Epoch=47.2] | Loss=0.01451 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.386 | L2-Norm(final)=9.907 | 5851.7 samples/s | 91.4 steps/s
[Step=24250 Epoch=47.3] | Loss=0.01406 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.386 | L2-Norm(final)=9.914 | 5748.6 samples/s | 89.8 steps/s
[Step=24300 Epoch=47.4] | Loss=0.01408 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.386 | L2-Norm(final)=9.921 | 5889.9 samples/s | 92.0 steps/s
[Step=24350 Epoch=47.5] | Loss=0.01353 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.386 | L2-Norm(final)=9.927 | 5739.6 samples/s | 89.7 steps/s
[Step=24400 Epoch=47.6] | Loss=0.01353 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.386 | L2-Norm(final)=9.934 | 5774.3 samples/s | 90.2 steps/s
[Step=24450 Epoch=47.7] | Loss=0.01355 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.386 | L2-Norm(final)=9.941 | 5856.1 samples/s | 91.5 steps/s
[Step=24500 Epoch=47.8] | Loss=0.01360 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.386 | L2-Norm(final)=9.948 | 7274.9 samples/s | 113.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=47.8] | Loss=0.01706 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.386 | L2-Norm(final)=10.017 | 3308.5 samples/s | 51.7 steps/s
[Step=24550 Epoch=47.9] | Loss=0.01309 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.401 | L2-Norm(final)=10.020 | 4983.7 samples/s | 77.9 steps/s
[Step=24600 Epoch=48.0] | Loss=0.01320 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.418 | L2-Norm(final)=10.020 | 5035.0 samples/s | 78.7 steps/s
[Step=24650 Epoch=48.1] | Loss=0.01417 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.432 | L2-Norm(final)=10.020 | 5108.5 samples/s | 79.8 steps/s
[Step=24700 Epoch=48.2] | Loss=0.01439 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.444 | L2-Norm(final)=10.020 | 5002.4 samples/s | 78.2 steps/s
[Step=24750 Epoch=48.3] | Loss=0.01426 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.455 | L2-Norm(final)=10.021 | 4993.2 samples/s | 78.0 steps/s
[Step=24800 Epoch=48.4] | Loss=0.01447 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.465 | L2-Norm(final)=10.022 | 5038.6 samples/s | 78.7 steps/s
[Step=24850 Epoch=48.5] | Loss=0.01431 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.473 | L2-Norm(final)=10.022 | 5056.0 samples/s | 79.0 steps/s
[Step=24900 Epoch=48.6] | Loss=0.01388 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=10.023 | 5086.8 samples/s | 79.5 steps/s
[Step=24950 Epoch=48.7] | Loss=0.01370 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.488 | L2-Norm(final)=10.024 | 5037.3 samples/s | 78.7 steps/s
[Step=25000 Epoch=48.8] | Loss=0.01355 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.494 | L2-Norm(final)=10.025 | 6118.3 samples/s | 95.6 steps/s
[Step=25050 Epoch=48.9] | Loss=0.01312 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.500 | L2-Norm(final)=10.026 | 1903.3 samples/s | 29.7 steps/s
[Step=25100 Epoch=49.0] | Loss=0.01294 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.506 | L2-Norm(final)=10.027 | 5043.5 samples/s | 78.8 steps/s
[Step=25150 Epoch=49.1] | Loss=0.01281 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.511 | L2-Norm(final)=10.028 | 5010.1 samples/s | 78.3 steps/s
[Step=25200 Epoch=49.1] | Loss=0.01269 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.516 | L2-Norm(final)=10.029 | 5073.1 samples/s | 79.3 steps/s
[Step=25250 Epoch=49.2] | Loss=0.01251 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.521 | L2-Norm(final)=10.030 | 5018.7 samples/s | 78.4 steps/s
[Step=25300 Epoch=49.3] | Loss=0.01218 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.526 | L2-Norm(final)=10.032 | 4985.5 samples/s | 77.9 steps/s
[Step=25350 Epoch=49.4] | Loss=0.01187 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.530 | L2-Norm(final)=10.033 | 5062.3 samples/s | 79.1 steps/s
[Step=25400 Epoch=49.5] | Loss=0.01154 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.534 | L2-Norm(final)=10.034 | 5034.4 samples/s | 78.7 steps/s
[Step=25450 Epoch=49.6] | Loss=0.01149 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.538 | L2-Norm(final)=10.036 | 5001.8 samples/s | 78.2 steps/s
[Step=25500 Epoch=49.7] | Loss=0.01133 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.541 | L2-Norm(final)=10.037 | 5358.5 samples/s | 83.7 steps/s
[Step=25550 Epoch=49.8] | Loss=0.01119 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.545 | L2-Norm(final)=10.038 | 1939.7 samples/s | 30.3 steps/s
[Step=25600 Epoch=49.9] | Loss=0.01104 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.549 | L2-Norm(final)=10.039 | 5055.9 samples/s | 79.0 steps/s
[Step=25650 Epoch=50.0] | Loss=0.01100 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.552 | L2-Norm(final)=10.041 | 5019.5 samples/s | 78.4 steps/s
[Step=25700 Epoch=50.1] | Loss=0.01097 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.556 | L2-Norm(final)=10.042 | 5081.4 samples/s | 79.4 steps/s
[Step=25750 Epoch=50.2] | Loss=0.01085 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.559 | L2-Norm(final)=10.043 | 5084.1 samples/s | 79.4 steps/s
[Step=25800 Epoch=50.3] | Loss=0.01074 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.562 | L2-Norm(final)=10.044 | 4995.1 samples/s | 78.0 steps/s
[Step=25850 Epoch=50.4] | Loss=0.01060 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.565 | L2-Norm(final)=10.045 | 5026.0 samples/s | 78.5 steps/s
[Step=25900 Epoch=50.5] | Loss=0.01049 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.568 | L2-Norm(final)=10.047 | 5015.5 samples/s | 78.4 steps/s
[Step=25950 Epoch=50.6] | Loss=0.01040 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.571 | L2-Norm(final)=10.048 | 5096.6 samples/s | 79.6 steps/s
[Step=26000 Epoch=50.7] | Loss=0.01030 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.574 | L2-Norm(final)=10.049 | 5003.1 samples/s | 78.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step26000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=46.9] | Loss=0.00202 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.386 | L2-Norm(final)=9.935 | 4013.3 samples/s | 62.7 steps/s
[Step=24050 Epoch=47.0] | Loss=0.01420 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=9.938 | 5086.7 samples/s | 79.5 steps/s
[Step=24100 Epoch=47.1] | Loss=0.01503 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.387 | L2-Norm(final)=9.945 | 5781.0 samples/s | 90.3 steps/s
[Step=24150 Epoch=47.2] | Loss=0.01432 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.387 | L2-Norm(final)=9.952 | 5885.2 samples/s | 92.0 steps/s
[Step=24200 Epoch=47.3] | Loss=0.01456 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=9.959 | 5801.9 samples/s | 90.7 steps/s
[Step=24250 Epoch=47.4] | Loss=0.01485 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.387 | L2-Norm(final)=9.966 | 5814.8 samples/s | 90.9 steps/s
[Step=24300 Epoch=47.5] | Loss=0.01490 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=9.973 | 5823.2 samples/s | 91.0 steps/s
[Step=24350 Epoch=47.6] | Loss=0.01469 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=9.981 | 5834.0 samples/s | 91.2 steps/s
[Step=24400 Epoch=47.7] | Loss=0.01456 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=9.988 | 5750.7 samples/s | 89.9 steps/s
[Step=24450 Epoch=47.8] | Loss=0.01457 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=9.996 | 5763.3 samples/s | 90.1 steps/s
[Step=24500 Epoch=47.9] | Loss=0.01464 | Reg=0.00179 | acc=0.9531 | L2-Norm=13.387 | L2-Norm(final)=10.004 | 7458.5 samples/s | 116.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=47.9] | Loss=0.01129 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=10.080 | 3774.1 samples/s | 59.0 steps/s
[Step=24550 Epoch=48.0] | Loss=0.01260 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.410 | L2-Norm(final)=10.084 | 5102.8 samples/s | 79.7 steps/s
[Step=24600 Epoch=48.1] | Loss=0.01390 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.428 | L2-Norm(final)=10.085 | 4994.8 samples/s | 78.0 steps/s
[Step=24650 Epoch=48.2] | Loss=0.01385 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.442 | L2-Norm(final)=10.084 | 5016.8 samples/s | 78.4 steps/s
[Step=24700 Epoch=48.3] | Loss=0.01314 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.453 | L2-Norm(final)=10.084 | 4986.4 samples/s | 77.9 steps/s
[Step=24750 Epoch=48.4] | Loss=0.01362 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.462 | L2-Norm(final)=10.085 | 5075.8 samples/s | 79.3 steps/s
[Step=24800 Epoch=48.5] | Loss=0.01333 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.471 | L2-Norm(final)=10.087 | 5064.7 samples/s | 79.1 steps/s
[Step=24850 Epoch=48.6] | Loss=0.01335 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=10.088 | 4981.5 samples/s | 77.8 steps/s
[Step=24900 Epoch=48.7] | Loss=0.01358 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.486 | L2-Norm(final)=10.090 | 5044.9 samples/s | 78.8 steps/s
[Step=24950 Epoch=48.8] | Loss=0.01343 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.493 | L2-Norm(final)=10.091 | 5003.8 samples/s | 78.2 steps/s
[Step=25000 Epoch=48.9] | Loss=0.01358 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.500 | L2-Norm(final)=10.092 | 6252.6 samples/s | 97.7 steps/s
[Step=25050 Epoch=49.0] | Loss=0.01328 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.507 | L2-Norm(final)=10.093 | 1934.0 samples/s | 30.2 steps/s
[Step=25100 Epoch=49.1] | Loss=0.01290 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.513 | L2-Norm(final)=10.095 | 5047.6 samples/s | 78.9 steps/s
[Step=25150 Epoch=49.2] | Loss=0.01271 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.519 | L2-Norm(final)=10.096 | 4973.5 samples/s | 77.7 steps/s
[Step=25200 Epoch=49.3] | Loss=0.01227 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=10.098 | 4989.1 samples/s | 78.0 steps/s
[Step=25250 Epoch=49.4] | Loss=0.01206 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.530 | L2-Norm(final)=10.100 | 5124.4 samples/s | 80.1 steps/s
[Step=25300 Epoch=49.5] | Loss=0.01213 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.535 | L2-Norm(final)=10.101 | 5044.4 samples/s | 78.8 steps/s
[Step=25350 Epoch=49.6] | Loss=0.01194 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.539 | L2-Norm(final)=10.102 | 5041.3 samples/s | 78.8 steps/s
[Step=25400 Epoch=49.7] | Loss=0.01180 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.544 | L2-Norm(final)=10.104 | 5064.2 samples/s | 79.1 steps/s
[Step=25450 Epoch=49.8] | Loss=0.01160 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.548 | L2-Norm(final)=10.105 | 5056.8 samples/s | 79.0 steps/s
[Step=25500 Epoch=49.9] | Loss=0.01153 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.552 | L2-Norm(final)=10.106 | 5413.5 samples/s | 84.6 steps/s
[Step=25550 Epoch=49.9] | Loss=0.01135 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.556 | L2-Norm(final)=10.107 | 2024.4 samples/s | 31.6 steps/s
[Step=25600 Epoch=50.0] | Loss=0.01123 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.560 | L2-Norm(final)=10.109 | 5014.0 samples/s | 78.3 steps/s
[Step=25650 Epoch=50.1] | Loss=0.01115 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.563 | L2-Norm(final)=10.110 | 5111.3 samples/s | 79.9 steps/s
[Step=25700 Epoch=50.2] | Loss=0.01101 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.567 | L2-Norm(final)=10.111 | 4966.4 samples/s | 77.6 steps/s
[Step=25750 Epoch=50.3] | Loss=0.01094 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.570 | L2-Norm(final)=10.113 | 5028.6 samples/s | 78.6 steps/s
[Step=25800 Epoch=50.4] | Loss=0.01078 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.574 | L2-Norm(final)=10.114 | 5062.9 samples/s | 79.1 steps/s
[Step=25850 Epoch=50.5] | Loss=0.01066 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.577 | L2-Norm(final)=10.116 | 5006.2 samples/s | 78.2 steps/s
[Step=25900 Epoch=50.6] | Loss=0.01060 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.580 | L2-Norm(final)=10.117 | 4989.8 samples/s | 78.0 steps/s
[Step=25950 Epoch=50.7] | Loss=0.01050 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.583 | L2-Norm(final)=10.118 | 5027.5 samples/s | 78.6 steps/s
[Step=26000 Epoch=50.8] | Loss=0.01040 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.586 | L2-Norm(final)=10.119 | 4955.2 samples/s | 77.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step26000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06834 | acc=0.9680 | tpr=0.9780 | fpr=0.0538 | 4220.8 samples/s | 16.5 steps/s
Avg test loss: 0.07226, Avg test acc: 0.96735, Avg tpr: 0.97704, Avg fpr: 0.05397, total FA: 421

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06853 | acc=0.9661 | tpr=0.9684 | fpr=0.0389 | 4227.1 samples/s | 16.5 steps/s
Avg test loss: 0.07445, Avg test acc: 0.96486, Avg tpr: 0.96759, Avg fpr: 0.04115, total FA: 321

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.33779 | acc=0.3227 | tpr=0.0251 | fpr=0.0312 | 4193.2 samples/s | 16.4 steps/s
Avg test loss: 5.34625, Avg test acc: 0.32014, Avg tpr: 0.02471, Avg fpr: 0.03012, total FA: 235

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.69684 | acc=0.3230 | tpr=0.0277 | fpr=0.0357 | 4210.8 samples/s | 16.4 steps/s
Avg test loss: 5.70341, Avg test acc: 0.32098, Avg tpr: 0.02751, Avg fpr: 0.03359, total FA: 262

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.81354 | acc=0.0978 | tpr=0.9469 | fpr=0.9174 | 4245.5 samples/s | 16.6 steps/s
[Step= 100] | Loss=6.80422 | acc=0.0983 | tpr=0.9424 | fpr=0.9175 | 8388.4 samples/s | 32.8 steps/s
[Step= 150] | Loss=6.82955 | acc=0.0983 | tpr=0.9380 | fpr=0.9172 | 8095.6 samples/s | 31.6 steps/s
[Step= 200] | Loss=6.82897 | acc=0.0985 | tpr=0.9399 | fpr=0.9168 | 8433.2 samples/s | 32.9 steps/s
[Step= 250] | Loss=6.82906 | acc=0.0988 | tpr=0.9415 | fpr=0.9165 | 8270.5 samples/s | 32.3 steps/s
[Step= 300] | Loss=6.83352 | acc=0.0989 | tpr=0.9389 | fpr=0.9164 | 8196.5 samples/s | 32.0 steps/s
[Step= 350] | Loss=6.83757 | acc=0.0983 | tpr=0.9411 | fpr=0.9170 | 8866.7 samples/s | 34.6 steps/s
[Step= 400] | Loss=6.84023 | acc=0.0984 | tpr=0.9409 | fpr=0.9169 | 7791.8 samples/s | 30.4 steps/s
[Step= 450] | Loss=6.84290 | acc=0.0984 | tpr=0.9411 | fpr=0.9169 | 8156.2 samples/s | 31.9 steps/s
[Step= 500] | Loss=6.84336 | acc=0.0985 | tpr=0.9423 | fpr=0.9167 | 8425.7 samples/s | 32.9 steps/s
[Step= 550] | Loss=6.84086 | acc=0.0989 | tpr=0.9427 | fpr=0.9165 | 14448.4 samples/s | 56.4 steps/s
Avg test loss: 6.84186, Avg test acc: 0.09885, Avg tpr: 0.94295, Avg fpr: 0.91650, total FA: 127254

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.50767 | acc=0.1124 | tpr=0.9381 | fpr=0.9024 | 4249.1 samples/s | 16.6 steps/s
[Step= 100] | Loss=6.49009 | acc=0.1118 | tpr=0.9211 | fpr=0.9033 | 8108.7 samples/s | 31.7 steps/s
[Step= 150] | Loss=6.51296 | acc=0.1114 | tpr=0.9150 | fpr=0.9034 | 8277.8 samples/s | 32.3 steps/s
[Step= 200] | Loss=6.51038 | acc=0.1117 | tpr=0.9126 | fpr=0.9028 | 8149.2 samples/s | 31.8 steps/s
[Step= 250] | Loss=6.50927 | acc=0.1126 | tpr=0.9100 | fpr=0.9019 | 8283.5 samples/s | 32.4 steps/s
[Step= 300] | Loss=6.51262 | acc=0.1128 | tpr=0.9069 | fpr=0.9017 | 8457.0 samples/s | 33.0 steps/s
[Step= 350] | Loss=6.51469 | acc=0.1123 | tpr=0.9080 | fpr=0.9022 | 8345.0 samples/s | 32.6 steps/s
[Step= 400] | Loss=6.51517 | acc=0.1123 | tpr=0.9097 | fpr=0.9022 | 8129.7 samples/s | 31.8 steps/s
[Step= 450] | Loss=6.51916 | acc=0.1123 | tpr=0.9109 | fpr=0.9022 | 8428.6 samples/s | 32.9 steps/s
[Step= 500] | Loss=6.51792 | acc=0.1123 | tpr=0.9128 | fpr=0.9021 | 8211.8 samples/s | 32.1 steps/s
[Step= 550] | Loss=6.51678 | acc=0.1125 | tpr=0.9129 | fpr=0.9020 | 14953.3 samples/s | 58.4 steps/s
Avg test loss: 6.51790, Avg test acc: 0.11248, Avg tpr: 0.91284, Avg fpr: 0.90207, total FA: 125251

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10208 | acc=0.9826 | tpr=0.9469 | fpr=0.0168 | 4156.2 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.10725 | acc=0.9821 | tpr=0.9510 | fpr=0.0173 | 8217.6 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.11172 | acc=0.9810 | tpr=0.9510 | fpr=0.0184 | 8346.0 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.11270 | acc=0.9811 | tpr=0.9563 | fpr=0.0185 | 8649.0 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.11086 | acc=0.9812 | tpr=0.9555 | fpr=0.0183 | 7995.8 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.11382 | acc=0.9808 | tpr=0.9527 | fpr=0.0186 | 8341.6 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.11435 | acc=0.9808 | tpr=0.9524 | fpr=0.0187 | 8219.8 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.11526 | acc=0.9806 | tpr=0.9524 | fpr=0.0189 | 8538.5 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.11729 | acc=0.9804 | tpr=0.9518 | fpr=0.0191 | 8219.1 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.11679 | acc=0.9805 | tpr=0.9533 | fpr=0.0190 | 8178.8 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.11542 | acc=0.9806 | tpr=0.9515 | fpr=0.0189 | 15921.3 samples/s | 62.2 steps/s
Avg test loss: 0.11531, Avg test acc: 0.98060, Avg tpr: 0.95127, Avg fpr: 0.01887, total FA: 2620

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12663 | acc=0.9818 | tpr=0.9425 | fpr=0.0175 | 4171.0 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.13396 | acc=0.9802 | tpr=0.9510 | fpr=0.0193 | 7935.6 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.14065 | acc=0.9793 | tpr=0.9582 | fpr=0.0203 | 8705.4 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.14256 | acc=0.9794 | tpr=0.9639 | fpr=0.0203 | 8027.1 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.14007 | acc=0.9796 | tpr=0.9598 | fpr=0.0201 | 8377.9 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.14395 | acc=0.9792 | tpr=0.9585 | fpr=0.0204 | 8398.6 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.14441 | acc=0.9792 | tpr=0.9599 | fpr=0.0204 | 8274.0 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.14582 | acc=0.9789 | tpr=0.9568 | fpr=0.0207 | 8329.5 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.14855 | acc=0.9787 | tpr=0.9547 | fpr=0.0209 | 8061.6 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.14810 | acc=0.9787 | tpr=0.9559 | fpr=0.0209 | 8183.3 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.14610 | acc=0.9789 | tpr=0.9530 | fpr=0.0206 | 15217.6 samples/s | 59.4 steps/s
Avg test loss: 0.14591, Avg test acc: 0.97888, Avg tpr: 0.95285, Avg fpr: 0.02065, total FA: 2867

server round 23/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=18001 Epoch=69.0] | Loss=0.00039 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.278 | L2-Norm(final)=9.918 | 3625.3 samples/s | 56.6 steps/s
[Step=18050 Epoch=69.2] | Loss=0.00116 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.275 | L2-Norm(final)=9.933 | 5405.4 samples/s | 84.5 steps/s
[Step=18100 Epoch=69.4] | Loss=0.00092 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.274 | L2-Norm(final)=9.950 | 5418.4 samples/s | 84.7 steps/s
[Step=18150 Epoch=69.5] | Loss=0.00108 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.274 | L2-Norm(final)=9.965 | 5549.4 samples/s | 86.7 steps/s
[Step=18200 Epoch=69.7] | Loss=0.00092 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.274 | L2-Norm(final)=9.976 | 5485.9 samples/s | 85.7 steps/s
[Step=18250 Epoch=69.9] | Loss=0.00080 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.274 | L2-Norm(final)=9.986 | 7371.7 samples/s | 115.2 steps/s
[Step=18300 Epoch=70.1] | Loss=0.00079 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.274 | L2-Norm(final)=9.996 | 1973.7 samples/s | 30.8 steps/s
[Step=18350 Epoch=70.3] | Loss=0.00081 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.274 | L2-Norm(final)=10.006 | 5463.3 samples/s | 85.4 steps/s
[Step=18400 Epoch=70.5] | Loss=0.00076 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.274 | L2-Norm(final)=10.015 | 5593.8 samples/s | 87.4 steps/s
[Step=18450 Epoch=70.7] | Loss=0.00072 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.274 | L2-Norm(final)=10.025 | 5447.5 samples/s | 85.1 steps/s
[Step=18500 Epoch=70.9] | Loss=0.00068 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.274 | L2-Norm(final)=10.033 | 6012.7 samples/s | 93.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=70.9] | Loss=0.00006 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.274 | L2-Norm(final)=10.117 | 3830.9 samples/s | 59.9 steps/s
[Step=18550 Epoch=71.1] | Loss=0.00143 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.279 | L2-Norm(final)=10.117 | 4575.4 samples/s | 71.5 steps/s
[Step=18600 Epoch=71.3] | Loss=0.00150 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.301 | L2-Norm(final)=10.115 | 4777.7 samples/s | 74.7 steps/s
[Step=18650 Epoch=71.5] | Loss=0.00123 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.322 | L2-Norm(final)=10.114 | 4758.4 samples/s | 74.4 steps/s
[Step=18700 Epoch=71.7] | Loss=0.00095 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.333 | L2-Norm(final)=10.114 | 4763.5 samples/s | 74.4 steps/s
[Step=18750 Epoch=71.8] | Loss=0.00077 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.337 | L2-Norm(final)=10.115 | 5936.8 samples/s | 92.8 steps/s
[Step=18800 Epoch=72.0] | Loss=0.00065 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.337 | L2-Norm(final)=10.116 | 1897.5 samples/s | 29.6 steps/s
[Step=18850 Epoch=72.2] | Loss=0.00056 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.335 | L2-Norm(final)=10.117 | 4834.9 samples/s | 75.5 steps/s
[Step=18900 Epoch=72.4] | Loss=0.00049 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.331 | L2-Norm(final)=10.117 | 4820.5 samples/s | 75.3 steps/s
[Step=18950 Epoch=72.6] | Loss=0.00043 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.327 | L2-Norm(final)=10.118 | 4748.7 samples/s | 74.2 steps/s
[Step=19000 Epoch=72.8] | Loss=0.00039 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.322 | L2-Norm(final)=10.118 | 5283.0 samples/s | 82.5 steps/s
[Step=19050 Epoch=73.0] | Loss=0.00036 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.316 | L2-Norm(final)=10.119 | 1961.5 samples/s | 30.6 steps/s
[Step=19100 Epoch=73.2] | Loss=0.00033 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.310 | L2-Norm(final)=10.119 | 4930.2 samples/s | 77.0 steps/s
[Step=19150 Epoch=73.4] | Loss=0.00030 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.304 | L2-Norm(final)=10.120 | 4841.8 samples/s | 75.7 steps/s
[Step=19200 Epoch=73.6] | Loss=0.00028 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.298 | L2-Norm(final)=10.120 | 4735.4 samples/s | 74.0 steps/s
[Step=19250 Epoch=73.8] | Loss=0.00026 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.291 | L2-Norm(final)=10.121 | 4758.8 samples/s | 74.4 steps/s
[Step=19300 Epoch=74.0] | Loss=0.00025 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=10.121 | 2050.3 samples/s | 32.0 steps/s
[Step=19350 Epoch=74.1] | Loss=0.00023 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.278 | L2-Norm(final)=10.121 | 4830.7 samples/s | 75.5 steps/s
[Step=19400 Epoch=74.3] | Loss=0.00022 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.270 | L2-Norm(final)=10.122 | 4748.6 samples/s | 74.2 steps/s
[Step=19450 Epoch=74.5] | Loss=0.00021 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.263 | L2-Norm(final)=10.122 | 4839.8 samples/s | 75.6 steps/s
[Step=19500 Epoch=74.7] | Loss=0.00020 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.256 | L2-Norm(final)=10.123 | 4779.2 samples/s | 74.7 steps/s
[Step=19550 Epoch=74.9] | Loss=0.00019 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.249 | L2-Norm(final)=10.123 | 2031.7 samples/s | 31.7 steps/s
[Step=19600 Epoch=75.1] | Loss=0.00018 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=10.123 | 4776.9 samples/s | 74.6 steps/s
[Step=19650 Epoch=75.3] | Loss=0.00017 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.234 | L2-Norm(final)=10.124 | 4767.7 samples/s | 74.5 steps/s
[Step=19700 Epoch=75.5] | Loss=0.00017 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.226 | L2-Norm(final)=10.124 | 4844.8 samples/s | 75.7 steps/s
[Step=19750 Epoch=75.7] | Loss=0.00016 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.218 | L2-Norm(final)=10.124 | 4728.3 samples/s | 73.9 steps/s
[Step=19800 Epoch=75.9] | Loss=0.00015 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.211 | L2-Norm(final)=10.125 | 6642.2 samples/s | 103.8 steps/s
[Step=19850 Epoch=76.1] | Loss=0.00015 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.203 | L2-Norm(final)=10.125 | 1837.6 samples/s | 28.7 steps/s
[Step=19900 Epoch=76.2] | Loss=0.00014 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.195 | L2-Norm(final)=10.125 | 4771.4 samples/s | 74.6 steps/s
[Step=19950 Epoch=76.4] | Loss=0.00014 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.187 | L2-Norm(final)=10.126 | 4751.5 samples/s | 74.2 steps/s
[Step=20000 Epoch=76.6] | Loss=0.00013 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.179 | L2-Norm(final)=10.126 | 4764.6 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step20000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=84.7] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.278 | L2-Norm(final)=11.222 | 3910.3 samples/s | 61.1 steps/s
[Step=22050 Epoch=84.9] | Loss=0.00104 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.276 | L2-Norm(final)=11.232 | 4987.4 samples/s | 77.9 steps/s
[Step=22100 Epoch=85.1] | Loss=0.00085 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.276 | L2-Norm(final)=11.246 | 5616.7 samples/s | 87.8 steps/s
[Step=22150 Epoch=85.3] | Loss=0.00070 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.275 | L2-Norm(final)=11.255 | 5403.9 samples/s | 84.4 steps/s
[Step=22200 Epoch=85.5] | Loss=0.00058 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.275 | L2-Norm(final)=11.263 | 5366.2 samples/s | 83.8 steps/s
[Step=22250 Epoch=85.6] | Loss=0.00054 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.275 | L2-Norm(final)=11.271 | 7287.5 samples/s | 113.9 steps/s
[Step=22300 Epoch=85.8] | Loss=0.00049 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.275 | L2-Norm(final)=11.279 | 1965.3 samples/s | 30.7 steps/s
[Step=22350 Epoch=86.0] | Loss=0.00046 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.275 | L2-Norm(final)=11.286 | 5426.4 samples/s | 84.8 steps/s
[Step=22400 Epoch=86.2] | Loss=0.00049 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.275 | L2-Norm(final)=11.293 | 5349.1 samples/s | 83.6 steps/s
[Step=22450 Epoch=86.4] | Loss=0.00046 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.275 | L2-Norm(final)=11.300 | 5540.5 samples/s | 86.6 steps/s
[Step=22500 Epoch=86.6] | Loss=0.00048 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.275 | L2-Norm(final)=11.307 | 6255.9 samples/s | 97.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=86.6] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.275 | L2-Norm(final)=11.376 | 3910.9 samples/s | 61.1 steps/s
[Step=22550 Epoch=86.8] | Loss=0.00008 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.270 | L2-Norm(final)=11.378 | 4464.7 samples/s | 69.8 steps/s
[Step=22600 Epoch=87.0] | Loss=0.00008 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.263 | L2-Norm(final)=11.379 | 4760.7 samples/s | 74.4 steps/s
[Step=22650 Epoch=87.2] | Loss=0.00006 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.256 | L2-Norm(final)=11.380 | 4772.2 samples/s | 74.6 steps/s
[Step=22700 Epoch=87.4] | Loss=0.00070 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.250 | L2-Norm(final)=11.381 | 4838.9 samples/s | 75.6 steps/s
[Step=22750 Epoch=87.6] | Loss=0.00069 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.261 | L2-Norm(final)=11.380 | 6229.1 samples/s | 97.3 steps/s
[Step=22800 Epoch=87.8] | Loss=0.00060 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.270 | L2-Norm(final)=11.379 | 1884.6 samples/s | 29.4 steps/s
[Step=22850 Epoch=88.0] | Loss=0.00052 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.276 | L2-Norm(final)=11.379 | 4784.4 samples/s | 74.8 steps/s
[Step=22900 Epoch=88.2] | Loss=0.00048 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.278 | L2-Norm(final)=11.379 | 4785.3 samples/s | 74.8 steps/s
[Step=22950 Epoch=88.3] | Loss=0.00044 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.279 | L2-Norm(final)=11.379 | 4738.5 samples/s | 74.0 steps/s
[Step=23000 Epoch=88.5] | Loss=0.00050 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.280 | L2-Norm(final)=11.379 | 5419.1 samples/s | 84.7 steps/s
[Step=23050 Epoch=88.7] | Loss=0.00046 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.282 | L2-Norm(final)=11.379 | 1961.8 samples/s | 30.7 steps/s
[Step=23100 Epoch=88.9] | Loss=0.00043 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.283 | L2-Norm(final)=11.379 | 4826.3 samples/s | 75.4 steps/s
[Step=23150 Epoch=89.1] | Loss=0.00039 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.283 | L2-Norm(final)=11.379 | 4849.0 samples/s | 75.8 steps/s
[Step=23200 Epoch=89.3] | Loss=0.00037 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.282 | L2-Norm(final)=11.379 | 4708.1 samples/s | 73.6 steps/s
[Step=23250 Epoch=89.5] | Loss=0.00034 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.280 | L2-Norm(final)=11.379 | 4849.4 samples/s | 75.8 steps/s
[Step=23300 Epoch=89.7] | Loss=0.00032 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.279 | L2-Norm(final)=11.379 | 2034.5 samples/s | 31.8 steps/s
[Step=23350 Epoch=89.9] | Loss=0.00030 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.276 | L2-Norm(final)=11.379 | 4874.0 samples/s | 76.2 steps/s
[Step=23400 Epoch=90.1] | Loss=0.00029 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.274 | L2-Norm(final)=11.380 | 4840.9 samples/s | 75.6 steps/s
[Step=23450 Epoch=90.3] | Loss=0.00027 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.271 | L2-Norm(final)=11.380 | 4689.3 samples/s | 73.3 steps/s
[Step=23500 Epoch=90.5] | Loss=0.00026 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.267 | L2-Norm(final)=11.380 | 4775.0 samples/s | 74.6 steps/s
[Step=23550 Epoch=90.7] | Loss=0.00024 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.264 | L2-Norm(final)=11.380 | 2046.1 samples/s | 32.0 steps/s
[Step=23600 Epoch=90.8] | Loss=0.00023 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.260 | L2-Norm(final)=11.380 | 4775.9 samples/s | 74.6 steps/s
[Step=23650 Epoch=91.0] | Loss=0.00022 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.256 | L2-Norm(final)=11.380 | 4787.9 samples/s | 74.8 steps/s
[Step=23700 Epoch=91.2] | Loss=0.00021 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.252 | L2-Norm(final)=11.381 | 4712.1 samples/s | 73.6 steps/s
[Step=23750 Epoch=91.4] | Loss=0.00021 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.248 | L2-Norm(final)=11.381 | 4747.0 samples/s | 74.2 steps/s
[Step=23800 Epoch=91.6] | Loss=0.00020 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.243 | L2-Norm(final)=11.381 | 6957.9 samples/s | 108.7 steps/s
[Step=23850 Epoch=91.8] | Loss=0.00019 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.239 | L2-Norm(final)=11.381 | 1791.0 samples/s | 28.0 steps/s
[Step=23900 Epoch=92.0] | Loss=0.00018 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.234 | L2-Norm(final)=11.381 | 4845.6 samples/s | 75.7 steps/s
[Step=23950 Epoch=92.2] | Loss=0.00018 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.229 | L2-Norm(final)=11.382 | 4725.5 samples/s | 73.8 steps/s
[Step=24000 Epoch=92.4] | Loss=0.00017 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.224 | L2-Norm(final)=11.382 | 4729.2 samples/s | 73.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_1/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06834 | acc=0.9680 | tpr=0.9780 | fpr=0.0538 | 4239.7 samples/s | 16.6 steps/s
Avg test loss: 0.07226, Avg test acc: 0.96735, Avg tpr: 0.97704, Avg fpr: 0.05397, total FA: 421

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06853 | acc=0.9661 | tpr=0.9684 | fpr=0.0389 | 4193.3 samples/s | 16.4 steps/s
Avg test loss: 0.07445, Avg test acc: 0.96486, Avg tpr: 0.96759, Avg fpr: 0.04115, total FA: 321

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.58397 | acc=0.3210 | tpr=0.0308 | fpr=0.0488 | 4195.8 samples/s | 16.4 steps/s
Avg test loss: 5.58559, Avg test acc: 0.31894, Avg tpr: 0.03066, Avg fpr: 0.04705, total FA: 367

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.21029 | acc=0.3253 | tpr=0.0244 | fpr=0.0213 | 4231.7 samples/s | 16.5 steps/s
Avg test loss: 6.22200, Avg test acc: 0.32242, Avg tpr: 0.02326, Avg fpr: 0.01961, total FA: 153

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.81354 | acc=0.0978 | tpr=0.9469 | fpr=0.9174 | 4282.4 samples/s | 16.7 steps/s
[Step= 100] | Loss=6.80422 | acc=0.0983 | tpr=0.9424 | fpr=0.9175 | 8207.0 samples/s | 32.1 steps/s
[Step= 150] | Loss=6.82955 | acc=0.0983 | tpr=0.9380 | fpr=0.9172 | 8465.5 samples/s | 33.1 steps/s
[Step= 200] | Loss=6.82897 | acc=0.0985 | tpr=0.9399 | fpr=0.9168 | 8210.9 samples/s | 32.1 steps/s
[Step= 250] | Loss=6.82906 | acc=0.0988 | tpr=0.9415 | fpr=0.9165 | 8326.8 samples/s | 32.5 steps/s
[Step= 300] | Loss=6.83352 | acc=0.0989 | tpr=0.9389 | fpr=0.9164 | 8666.7 samples/s | 33.9 steps/s
[Step= 350] | Loss=6.83757 | acc=0.0983 | tpr=0.9411 | fpr=0.9170 | 7976.8 samples/s | 31.2 steps/s
[Step= 400] | Loss=6.84023 | acc=0.0984 | tpr=0.9409 | fpr=0.9169 | 8364.4 samples/s | 32.7 steps/s
[Step= 450] | Loss=6.84290 | acc=0.0984 | tpr=0.9411 | fpr=0.9169 | 8173.5 samples/s | 31.9 steps/s
[Step= 500] | Loss=6.84336 | acc=0.0985 | tpr=0.9423 | fpr=0.9167 | 8413.5 samples/s | 32.9 steps/s
[Step= 550] | Loss=6.84086 | acc=0.0989 | tpr=0.9427 | fpr=0.9165 | 15098.6 samples/s | 59.0 steps/s
Avg test loss: 6.84186, Avg test acc: 0.09885, Avg tpr: 0.94295, Avg fpr: 0.91650, total FA: 127254

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.50767 | acc=0.1124 | tpr=0.9381 | fpr=0.9024 | 4203.7 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.49009 | acc=0.1118 | tpr=0.9211 | fpr=0.9033 | 8321.7 samples/s | 32.5 steps/s
[Step= 150] | Loss=6.51296 | acc=0.1114 | tpr=0.9150 | fpr=0.9034 | 8182.8 samples/s | 32.0 steps/s
[Step= 200] | Loss=6.51038 | acc=0.1117 | tpr=0.9126 | fpr=0.9028 | 8316.8 samples/s | 32.5 steps/s
[Step= 250] | Loss=6.50927 | acc=0.1126 | tpr=0.9100 | fpr=0.9019 | 8255.1 samples/s | 32.2 steps/s
[Step= 300] | Loss=6.51262 | acc=0.1128 | tpr=0.9069 | fpr=0.9017 | 8401.3 samples/s | 32.8 steps/s
[Step= 350] | Loss=6.51469 | acc=0.1123 | tpr=0.9080 | fpr=0.9022 | 8188.0 samples/s | 32.0 steps/s
[Step= 400] | Loss=6.51517 | acc=0.1123 | tpr=0.9097 | fpr=0.9022 | 8392.8 samples/s | 32.8 steps/s
[Step= 450] | Loss=6.51916 | acc=0.1123 | tpr=0.9109 | fpr=0.9022 | 8246.7 samples/s | 32.2 steps/s
[Step= 500] | Loss=6.51792 | acc=0.1123 | tpr=0.9128 | fpr=0.9021 | 8444.0 samples/s | 33.0 steps/s
[Step= 550] | Loss=6.51678 | acc=0.1125 | tpr=0.9129 | fpr=0.9020 | 14840.0 samples/s | 58.0 steps/s
Avg test loss: 6.51790, Avg test acc: 0.11248, Avg tpr: 0.91284, Avg fpr: 0.90207, total FA: 125251

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12181 | acc=0.9824 | tpr=0.9425 | fpr=0.0169 | 4184.0 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.12822 | acc=0.9813 | tpr=0.9424 | fpr=0.0179 | 8777.7 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.13372 | acc=0.9805 | tpr=0.9496 | fpr=0.0189 | 7735.3 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.13561 | acc=0.9805 | tpr=0.9541 | fpr=0.0190 | 9214.1 samples/s | 36.0 steps/s
[Step= 250] | Loss=0.13307 | acc=0.9807 | tpr=0.9520 | fpr=0.0188 | 7699.1 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.13673 | acc=0.9802 | tpr=0.9513 | fpr=0.0193 | 8276.4 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.13667 | acc=0.9801 | tpr=0.9505 | fpr=0.0193 | 8399.6 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.13807 | acc=0.9800 | tpr=0.9486 | fpr=0.0195 | 8468.7 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.14067 | acc=0.9797 | tpr=0.9469 | fpr=0.0197 | 8104.8 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.13979 | acc=0.9798 | tpr=0.9485 | fpr=0.0196 | 8129.9 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.13813 | acc=0.9800 | tpr=0.9463 | fpr=0.0194 | 15056.1 samples/s | 58.8 steps/s
Avg test loss: 0.13790, Avg test acc: 0.98002, Avg tpr: 0.94612, Avg fpr: 0.01937, total FA: 2689

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16262 | acc=0.9808 | tpr=0.9558 | fpr=0.0188 | 4157.0 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.16990 | acc=0.9795 | tpr=0.9531 | fpr=0.0201 | 8157.9 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.17828 | acc=0.9787 | tpr=0.9568 | fpr=0.0209 | 8473.9 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.18110 | acc=0.9784 | tpr=0.9617 | fpr=0.0213 | 8404.6 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.17755 | acc=0.9783 | tpr=0.9581 | fpr=0.0213 | 8150.9 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.18233 | acc=0.9779 | tpr=0.9571 | fpr=0.0218 | 8392.3 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.18343 | acc=0.9779 | tpr=0.9580 | fpr=0.0218 | 8588.3 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.18445 | acc=0.9777 | tpr=0.9546 | fpr=0.0219 | 8148.7 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.18786 | acc=0.9774 | tpr=0.9533 | fpr=0.0222 | 8218.3 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.18733 | acc=0.9775 | tpr=0.9537 | fpr=0.0221 | 8441.0 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.18555 | acc=0.9776 | tpr=0.9522 | fpr=0.0219 | 15272.8 samples/s | 59.7 steps/s
Avg test loss: 0.18525, Avg test acc: 0.97765, Avg tpr: 0.95206, Avg fpr: 0.02188, total FA: 3038

server round 24/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=26001 Epoch=50.8] | Loss=0.00636 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.225 | L2-Norm(final)=10.155 | 3916.5 samples/s | 61.2 steps/s
[Step=26050 Epoch=50.9] | Loss=0.01331 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.225 | L2-Norm(final)=10.164 | 5414.1 samples/s | 84.6 steps/s
[Step=26100 Epoch=51.0] | Loss=0.01495 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.225 | L2-Norm(final)=10.173 | 5735.6 samples/s | 89.6 steps/s
[Step=26150 Epoch=51.1] | Loss=0.01515 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.225 | L2-Norm(final)=10.180 | 5853.1 samples/s | 91.5 steps/s
[Step=26200 Epoch=51.2] | Loss=0.01539 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.225 | L2-Norm(final)=10.186 | 5793.8 samples/s | 90.5 steps/s
[Step=26250 Epoch=51.3] | Loss=0.01517 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.225 | L2-Norm(final)=10.193 | 5470.2 samples/s | 85.5 steps/s
[Step=26300 Epoch=51.4] | Loss=0.01497 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.225 | L2-Norm(final)=10.200 | 5548.9 samples/s | 86.7 steps/s
[Step=26350 Epoch=51.5] | Loss=0.01490 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.225 | L2-Norm(final)=10.206 | 5702.9 samples/s | 89.1 steps/s
[Step=26400 Epoch=51.6] | Loss=0.01514 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.225 | L2-Norm(final)=10.213 | 5713.5 samples/s | 89.3 steps/s
[Step=26450 Epoch=51.7] | Loss=0.01503 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.225 | L2-Norm(final)=10.219 | 5326.1 samples/s | 83.2 steps/s
[Step=26500 Epoch=51.8] | Loss=0.01493 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.225 | L2-Norm(final)=10.226 | 7121.4 samples/s | 111.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=51.8] | Loss=0.00436 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.225 | L2-Norm(final)=10.293 | 3627.7 samples/s | 56.7 steps/s
[Step=26550 Epoch=51.9] | Loss=0.01378 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.248 | L2-Norm(final)=10.294 | 4051.5 samples/s | 63.3 steps/s
[Step=26600 Epoch=52.0] | Loss=0.01477 | Reg=0.00176 | acc=0.9688 | L2-Norm=13.265 | L2-Norm(final)=10.293 | 4762.7 samples/s | 74.4 steps/s
[Step=26650 Epoch=52.1] | Loss=0.01440 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.278 | L2-Norm(final)=10.293 | 4886.0 samples/s | 76.3 steps/s
[Step=26700 Epoch=52.2] | Loss=0.01418 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=10.293 | 5094.0 samples/s | 79.6 steps/s
[Step=26750 Epoch=52.3] | Loss=0.01367 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.301 | L2-Norm(final)=10.294 | 5110.5 samples/s | 79.9 steps/s
[Step=26800 Epoch=52.4] | Loss=0.01372 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.310 | L2-Norm(final)=10.295 | 4994.8 samples/s | 78.0 steps/s
[Step=26850 Epoch=52.5] | Loss=0.01373 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.319 | L2-Norm(final)=10.296 | 5030.2 samples/s | 78.6 steps/s
[Step=26900 Epoch=52.6] | Loss=0.01367 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.327 | L2-Norm(final)=10.297 | 5068.2 samples/s | 79.2 steps/s
[Step=26950 Epoch=52.7] | Loss=0.01304 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.335 | L2-Norm(final)=10.298 | 4991.8 samples/s | 78.0 steps/s
[Step=27000 Epoch=52.8] | Loss=0.01335 | Reg=0.00178 | acc=0.9531 | L2-Norm=13.342 | L2-Norm(final)=10.299 | 6259.5 samples/s | 97.8 steps/s
[Step=27050 Epoch=52.9] | Loss=0.01304 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.348 | L2-Norm(final)=10.300 | 1953.3 samples/s | 30.5 steps/s
[Step=27100 Epoch=53.0] | Loss=0.01269 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=10.302 | 4984.0 samples/s | 77.9 steps/s
[Step=27150 Epoch=53.1] | Loss=0.01240 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=10.303 | 5002.6 samples/s | 78.2 steps/s
[Step=27200 Epoch=53.2] | Loss=0.01243 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.365 | L2-Norm(final)=10.304 | 4985.0 samples/s | 77.9 steps/s
[Step=27250 Epoch=53.3] | Loss=0.01215 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=10.305 | 4999.4 samples/s | 78.1 steps/s
[Step=27300 Epoch=53.4] | Loss=0.01184 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.375 | L2-Norm(final)=10.307 | 5082.1 samples/s | 79.4 steps/s
[Step=27350 Epoch=53.5] | Loss=0.01150 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.380 | L2-Norm(final)=10.308 | 4975.8 samples/s | 77.7 steps/s
[Step=27400 Epoch=53.6] | Loss=0.01130 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.384 | L2-Norm(final)=10.309 | 5020.0 samples/s | 78.4 steps/s
[Step=27450 Epoch=53.7] | Loss=0.01113 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.389 | L2-Norm(final)=10.311 | 5043.1 samples/s | 78.8 steps/s
[Step=27500 Epoch=53.8] | Loss=0.01112 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.393 | L2-Norm(final)=10.312 | 5445.7 samples/s | 85.1 steps/s
[Step=27550 Epoch=53.9] | Loss=0.01100 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.397 | L2-Norm(final)=10.314 | 2027.2 samples/s | 31.7 steps/s
[Step=27600 Epoch=54.0] | Loss=0.01076 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.401 | L2-Norm(final)=10.315 | 5137.8 samples/s | 80.3 steps/s
[Step=27650 Epoch=54.1] | Loss=0.01059 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.404 | L2-Norm(final)=10.317 | 4965.5 samples/s | 77.6 steps/s
[Step=27700 Epoch=54.2] | Loss=0.01051 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.408 | L2-Norm(final)=10.319 | 5046.7 samples/s | 78.9 steps/s
[Step=27750 Epoch=54.3] | Loss=0.01056 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.412 | L2-Norm(final)=10.320 | 4993.0 samples/s | 78.0 steps/s
[Step=27800 Epoch=54.3] | Loss=0.01043 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.416 | L2-Norm(final)=10.321 | 5034.1 samples/s | 78.7 steps/s
[Step=27850 Epoch=54.4] | Loss=0.01039 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.419 | L2-Norm(final)=10.322 | 5003.2 samples/s | 78.2 steps/s
[Step=27900 Epoch=54.5] | Loss=0.01046 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.422 | L2-Norm(final)=10.323 | 5072.0 samples/s | 79.2 steps/s
[Step=27950 Epoch=54.6] | Loss=0.01036 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.425 | L2-Norm(final)=10.324 | 5041.7 samples/s | 78.8 steps/s
[Step=28000 Epoch=54.7] | Loss=0.01031 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.429 | L2-Norm(final)=10.326 | 5071.5 samples/s | 79.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step28000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=20001 Epoch=76.6] | Loss=0.00369 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.225 | L2-Norm(final)=10.136 | 3731.8 samples/s | 58.3 steps/s
[Step=20050 Epoch=76.8] | Loss=0.00052 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.222 | L2-Norm(final)=10.150 | 5194.5 samples/s | 81.2 steps/s
[Step=20100 Epoch=77.0] | Loss=0.00070 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.222 | L2-Norm(final)=10.161 | 5569.0 samples/s | 87.0 steps/s
[Step=20150 Epoch=77.2] | Loss=0.00057 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.221 | L2-Norm(final)=10.171 | 5351.9 samples/s | 83.6 steps/s
[Step=20200 Epoch=77.4] | Loss=0.00047 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.221 | L2-Norm(final)=10.179 | 5488.6 samples/s | 85.8 steps/s
[Step=20250 Epoch=77.6] | Loss=0.00046 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.221 | L2-Norm(final)=10.186 | 7109.3 samples/s | 111.1 steps/s
[Step=20300 Epoch=77.8] | Loss=0.00039 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.221 | L2-Norm(final)=10.193 | 1986.5 samples/s | 31.0 steps/s
[Step=20350 Epoch=78.0] | Loss=0.00037 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.221 | L2-Norm(final)=10.199 | 5392.5 samples/s | 84.3 steps/s
[Step=20400 Epoch=78.2] | Loss=0.00035 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.221 | L2-Norm(final)=10.205 | 5443.5 samples/s | 85.1 steps/s
[Step=20450 Epoch=78.4] | Loss=0.00034 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.221 | L2-Norm(final)=10.212 | 5560.6 samples/s | 86.9 steps/s
[Step=20500 Epoch=78.5] | Loss=0.00035 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.221 | L2-Norm(final)=10.218 | 6102.3 samples/s | 95.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=78.6] | Loss=0.00002 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.221 | L2-Norm(final)=10.288 | 3701.4 samples/s | 57.8 steps/s
[Step=20550 Epoch=78.7] | Loss=0.00011 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.212 | L2-Norm(final)=10.291 | 4769.0 samples/s | 74.5 steps/s
[Step=20600 Epoch=78.9] | Loss=0.00007 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.202 | L2-Norm(final)=10.294 | 4623.8 samples/s | 72.2 steps/s
[Step=20650 Epoch=79.1] | Loss=0.00011 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.188 | L2-Norm(final)=10.295 | 4686.3 samples/s | 73.2 steps/s
[Step=20700 Epoch=79.3] | Loss=0.00011 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.182 | L2-Norm(final)=10.297 | 4805.4 samples/s | 75.1 steps/s
[Step=20750 Epoch=79.5] | Loss=0.00025 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.176 | L2-Norm(final)=10.298 | 5981.7 samples/s | 93.5 steps/s
[Step=20800 Epoch=79.7] | Loss=0.00041 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.177 | L2-Norm(final)=10.297 | 1886.2 samples/s | 29.5 steps/s
[Step=20850 Epoch=79.9] | Loss=0.00037 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.180 | L2-Norm(final)=10.296 | 4706.1 samples/s | 73.5 steps/s
[Step=20900 Epoch=80.1] | Loss=0.00037 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.182 | L2-Norm(final)=10.296 | 4789.3 samples/s | 74.8 steps/s
[Step=20950 Epoch=80.3] | Loss=0.00042 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.183 | L2-Norm(final)=10.295 | 4708.0 samples/s | 73.6 steps/s
[Step=21000 Epoch=80.5] | Loss=0.00045 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.184 | L2-Norm(final)=10.294 | 5312.3 samples/s | 83.0 steps/s
[Step=21050 Epoch=80.7] | Loss=0.00042 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.185 | L2-Norm(final)=10.294 | 1986.7 samples/s | 31.0 steps/s
[Step=21100 Epoch=80.8] | Loss=0.00038 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.185 | L2-Norm(final)=10.294 | 4758.3 samples/s | 74.3 steps/s
[Step=21150 Epoch=81.0] | Loss=0.00036 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.184 | L2-Norm(final)=10.294 | 4753.3 samples/s | 74.3 steps/s
[Step=21200 Epoch=81.2] | Loss=0.00034 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.182 | L2-Norm(final)=10.294 | 4685.3 samples/s | 73.2 steps/s
[Step=21250 Epoch=81.4] | Loss=0.00031 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.180 | L2-Norm(final)=10.294 | 4782.6 samples/s | 74.7 steps/s
[Step=21300 Epoch=81.6] | Loss=0.00030 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.178 | L2-Norm(final)=10.294 | 2050.4 samples/s | 32.0 steps/s
[Step=21350 Epoch=81.8] | Loss=0.00028 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.175 | L2-Norm(final)=10.295 | 4791.2 samples/s | 74.9 steps/s
[Step=21400 Epoch=82.0] | Loss=0.00026 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.171 | L2-Norm(final)=10.295 | 4775.7 samples/s | 74.6 steps/s
[Step=21450 Epoch=82.2] | Loss=0.00025 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.168 | L2-Norm(final)=10.295 | 4770.4 samples/s | 74.5 steps/s
[Step=21500 Epoch=82.4] | Loss=0.00024 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.164 | L2-Norm(final)=10.296 | 4771.6 samples/s | 74.6 steps/s
[Step=21550 Epoch=82.6] | Loss=0.00023 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.160 | L2-Norm(final)=10.296 | 2054.9 samples/s | 32.1 steps/s
[Step=21600 Epoch=82.8] | Loss=0.00022 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.155 | L2-Norm(final)=10.296 | 4808.5 samples/s | 75.1 steps/s
[Step=21650 Epoch=83.0] | Loss=0.00021 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.150 | L2-Norm(final)=10.296 | 4675.8 samples/s | 73.1 steps/s
[Step=21700 Epoch=83.1] | Loss=0.00020 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.146 | L2-Norm(final)=10.297 | 4772.6 samples/s | 74.6 steps/s
[Step=21750 Epoch=83.3] | Loss=0.00019 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.141 | L2-Norm(final)=10.297 | 4793.1 samples/s | 74.9 steps/s
[Step=21800 Epoch=83.5] | Loss=0.00018 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.135 | L2-Norm(final)=10.297 | 6543.9 samples/s | 102.2 steps/s
[Step=21850 Epoch=83.7] | Loss=0.00018 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.130 | L2-Norm(final)=10.297 | 1841.7 samples/s | 28.8 steps/s
[Step=21900 Epoch=83.9] | Loss=0.00017 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.125 | L2-Norm(final)=10.297 | 4764.4 samples/s | 74.4 steps/s
[Step=21950 Epoch=84.1] | Loss=0.00016 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.119 | L2-Norm(final)=10.297 | 4776.5 samples/s | 74.6 steps/s
[Step=22000 Epoch=84.3] | Loss=0.00016 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.113 | L2-Norm(final)=10.297 | 4737.0 samples/s | 74.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step22000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06834 | acc=0.9680 | tpr=0.9780 | fpr=0.0538 | 4176.7 samples/s | 16.3 steps/s
Avg test loss: 0.07226, Avg test acc: 0.96735, Avg tpr: 0.97704, Avg fpr: 0.05397, total FA: 421

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06961 | acc=0.9672 | tpr=0.9728 | fpr=0.0451 | 4175.6 samples/s | 16.3 steps/s
Avg test loss: 0.07567, Avg test acc: 0.96558, Avg tpr: 0.97179, Avg fpr: 0.04807, total FA: 375

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.72218 | acc=0.3247 | tpr=0.0307 | fpr=0.0369 | 4129.7 samples/s | 16.1 steps/s
Avg test loss: 6.73256, Avg test acc: 0.32322, Avg tpr: 0.03194, Avg fpr: 0.03615, total FA: 282

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.21029 | acc=0.3253 | tpr=0.0244 | fpr=0.0213 | 4194.8 samples/s | 16.4 steps/s
Avg test loss: 6.22200, Avg test acc: 0.32242, Avg tpr: 0.02326, Avg fpr: 0.01961, total FA: 153

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.81354 | acc=0.0978 | tpr=0.9469 | fpr=0.9174 | 4174.1 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.80422 | acc=0.0983 | tpr=0.9424 | fpr=0.9175 | 8063.6 samples/s | 31.5 steps/s
[Step= 150] | Loss=6.82955 | acc=0.0983 | tpr=0.9380 | fpr=0.9172 | 8529.6 samples/s | 33.3 steps/s
[Step= 200] | Loss=6.82897 | acc=0.0985 | tpr=0.9399 | fpr=0.9168 | 8234.1 samples/s | 32.2 steps/s
[Step= 250] | Loss=6.82906 | acc=0.0988 | tpr=0.9415 | fpr=0.9165 | 8206.4 samples/s | 32.1 steps/s
[Step= 300] | Loss=6.83352 | acc=0.0989 | tpr=0.9389 | fpr=0.9164 | 8432.9 samples/s | 32.9 steps/s
[Step= 350] | Loss=6.83757 | acc=0.0983 | tpr=0.9411 | fpr=0.9170 | 8180.0 samples/s | 32.0 steps/s
[Step= 400] | Loss=6.84023 | acc=0.0984 | tpr=0.9409 | fpr=0.9169 | 8449.7 samples/s | 33.0 steps/s
[Step= 450] | Loss=6.84290 | acc=0.0984 | tpr=0.9411 | fpr=0.9169 | 8239.8 samples/s | 32.2 steps/s
[Step= 500] | Loss=6.84336 | acc=0.0985 | tpr=0.9423 | fpr=0.9167 | 8177.4 samples/s | 31.9 steps/s
[Step= 550] | Loss=6.84086 | acc=0.0989 | tpr=0.9427 | fpr=0.9165 | 15522.4 samples/s | 60.6 steps/s
Avg test loss: 6.84186, Avg test acc: 0.09885, Avg tpr: 0.94295, Avg fpr: 0.91650, total FA: 127254

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.70647 | acc=0.1091 | tpr=0.9248 | fpr=0.9055 | 4207.4 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.69663 | acc=0.1094 | tpr=0.9126 | fpr=0.9056 | 8336.2 samples/s | 32.6 steps/s
[Step= 150] | Loss=6.72493 | acc=0.1096 | tpr=0.9121 | fpr=0.9051 | 8227.9 samples/s | 32.1 steps/s
[Step= 200] | Loss=6.72540 | acc=0.1100 | tpr=0.9093 | fpr=0.9046 | 8280.4 samples/s | 32.3 steps/s
[Step= 250] | Loss=6.72437 | acc=0.1104 | tpr=0.9118 | fpr=0.9042 | 8267.2 samples/s | 32.3 steps/s
[Step= 300] | Loss=6.72678 | acc=0.1104 | tpr=0.9091 | fpr=0.9041 | 8510.0 samples/s | 33.2 steps/s
[Step= 350] | Loss=6.72878 | acc=0.1097 | tpr=0.9067 | fpr=0.9047 | 8145.5 samples/s | 31.8 steps/s
[Step= 400] | Loss=6.73114 | acc=0.1098 | tpr=0.9065 | fpr=0.9047 | 8360.7 samples/s | 32.7 steps/s
[Step= 450] | Loss=6.73432 | acc=0.1098 | tpr=0.9070 | fpr=0.9047 | 8553.0 samples/s | 33.4 steps/s
[Step= 500] | Loss=6.73303 | acc=0.1099 | tpr=0.9101 | fpr=0.9045 | 8003.8 samples/s | 31.3 steps/s
[Step= 550] | Loss=6.73416 | acc=0.1100 | tpr=0.9109 | fpr=0.9046 | 15365.5 samples/s | 60.0 steps/s
Avg test loss: 6.73494, Avg test acc: 0.10995, Avg tpr: 0.91086, Avg fpr: 0.90461, total FA: 125603

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12132 | acc=0.9842 | tpr=0.9292 | fpr=0.0148 | 4161.9 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.12789 | acc=0.9834 | tpr=0.9360 | fpr=0.0157 | 8831.0 samples/s | 34.5 steps/s
[Step= 150] | Loss=0.13376 | acc=0.9823 | tpr=0.9424 | fpr=0.0169 | 7985.3 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.13531 | acc=0.9824 | tpr=0.9475 | fpr=0.0170 | 8203.8 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.13279 | acc=0.9824 | tpr=0.9476 | fpr=0.0170 | 8489.3 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.13648 | acc=0.9820 | tpr=0.9462 | fpr=0.0174 | 8587.4 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.13664 | acc=0.9818 | tpr=0.9449 | fpr=0.0175 | 8164.7 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.13784 | acc=0.9816 | tpr=0.9442 | fpr=0.0177 | 8334.0 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.14059 | acc=0.9813 | tpr=0.9421 | fpr=0.0180 | 8385.7 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.13978 | acc=0.9816 | tpr=0.9436 | fpr=0.0178 | 8113.7 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.13822 | acc=0.9816 | tpr=0.9407 | fpr=0.0176 | 15188.7 samples/s | 59.3 steps/s
Avg test loss: 0.13807, Avg test acc: 0.98164, Avg tpr: 0.94057, Avg fpr: 0.01762, total FA: 2446

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16262 | acc=0.9808 | tpr=0.9558 | fpr=0.0188 | 4203.3 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.16990 | acc=0.9795 | tpr=0.9531 | fpr=0.0201 | 8455.5 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.17828 | acc=0.9787 | tpr=0.9568 | fpr=0.0209 | 7923.3 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.18110 | acc=0.9784 | tpr=0.9617 | fpr=0.0213 | 8339.9 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.17755 | acc=0.9783 | tpr=0.9581 | fpr=0.0213 | 8176.2 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.18233 | acc=0.9779 | tpr=0.9571 | fpr=0.0218 | 8502.3 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.18343 | acc=0.9779 | tpr=0.9580 | fpr=0.0218 | 8383.8 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.18445 | acc=0.9777 | tpr=0.9546 | fpr=0.0219 | 8275.6 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.18786 | acc=0.9774 | tpr=0.9533 | fpr=0.0222 | 8682.5 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.18733 | acc=0.9775 | tpr=0.9537 | fpr=0.0221 | 8024.0 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.18555 | acc=0.9776 | tpr=0.9522 | fpr=0.0219 | 14867.2 samples/s | 58.1 steps/s
Avg test loss: 0.18525, Avg test acc: 0.97765, Avg tpr: 0.95206, Avg fpr: 0.02188, total FA: 3038

server round 25/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=26001 Epoch=50.7] | Loss=0.01063 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.187 | L2-Norm(final)=10.085 | 3464.7 samples/s | 54.1 steps/s
[Step=26050 Epoch=50.8] | Loss=0.01373 | Reg=0.00174 | acc=0.9688 | L2-Norm=13.188 | L2-Norm(final)=10.088 | 5563.4 samples/s | 86.9 steps/s
[Step=26100 Epoch=50.9] | Loss=0.01485 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.188 | L2-Norm(final)=10.090 | 5766.5 samples/s | 90.1 steps/s
[Step=26150 Epoch=51.0] | Loss=0.01422 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.188 | L2-Norm(final)=10.094 | 5800.2 samples/s | 90.6 steps/s
[Step=26200 Epoch=51.1] | Loss=0.01383 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.188 | L2-Norm(final)=10.100 | 5794.7 samples/s | 90.5 steps/s
[Step=26250 Epoch=51.2] | Loss=0.01360 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.189 | L2-Norm(final)=10.105 | 5778.7 samples/s | 90.3 steps/s
[Step=26300 Epoch=51.3] | Loss=0.01369 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.189 | L2-Norm(final)=10.111 | 5999.4 samples/s | 93.7 steps/s
[Step=26350 Epoch=51.4] | Loss=0.01417 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.189 | L2-Norm(final)=10.116 | 5606.5 samples/s | 87.6 steps/s
[Step=26400 Epoch=51.5] | Loss=0.01431 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.189 | L2-Norm(final)=10.121 | 5842.5 samples/s | 91.3 steps/s
[Step=26450 Epoch=51.6] | Loss=0.01447 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.189 | L2-Norm(final)=10.125 | 5900.8 samples/s | 92.2 steps/s
[Step=26500 Epoch=51.7] | Loss=0.01474 | Reg=0.00174 | acc=0.9688 | L2-Norm=13.189 | L2-Norm(final)=10.129 | 7290.9 samples/s | 113.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=51.7] | Loss=0.00161 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.189 | L2-Norm(final)=10.161 | 3579.8 samples/s | 55.9 steps/s
[Step=26550 Epoch=51.8] | Loss=0.01669 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.211 | L2-Norm(final)=10.158 | 5009.6 samples/s | 78.3 steps/s
[Step=26600 Epoch=51.9] | Loss=0.01603 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.234 | L2-Norm(final)=10.155 | 5021.3 samples/s | 78.5 steps/s
[Step=26650 Epoch=52.0] | Loss=0.01530 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.250 | L2-Norm(final)=10.155 | 5064.0 samples/s | 79.1 steps/s
[Step=26700 Epoch=52.1] | Loss=0.01458 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.262 | L2-Norm(final)=10.155 | 4928.6 samples/s | 77.0 steps/s
[Step=26750 Epoch=52.2] | Loss=0.01418 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.272 | L2-Norm(final)=10.156 | 5071.6 samples/s | 79.2 steps/s
[Step=26800 Epoch=52.3] | Loss=0.01480 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.281 | L2-Norm(final)=10.156 | 5050.2 samples/s | 78.9 steps/s
[Step=26850 Epoch=52.4] | Loss=0.01442 | Reg=0.00177 | acc=0.9531 | L2-Norm=13.289 | L2-Norm(final)=10.156 | 5086.2 samples/s | 79.5 steps/s
[Step=26900 Epoch=52.5] | Loss=0.01434 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.296 | L2-Norm(final)=10.156 | 5071.7 samples/s | 79.2 steps/s
[Step=26950 Epoch=52.6] | Loss=0.01395 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.303 | L2-Norm(final)=10.157 | 4964.4 samples/s | 77.6 steps/s
[Step=27000 Epoch=52.7] | Loss=0.01358 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.310 | L2-Norm(final)=10.158 | 6144.9 samples/s | 96.0 steps/s
[Step=27050 Epoch=52.8] | Loss=0.01339 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.316 | L2-Norm(final)=10.159 | 1874.8 samples/s | 29.3 steps/s
[Step=27100 Epoch=52.9] | Loss=0.01295 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.321 | L2-Norm(final)=10.159 | 5077.4 samples/s | 79.3 steps/s
[Step=27150 Epoch=53.0] | Loss=0.01267 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.326 | L2-Norm(final)=10.160 | 4935.3 samples/s | 77.1 steps/s
[Step=27200 Epoch=53.1] | Loss=0.01239 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.331 | L2-Norm(final)=10.161 | 4963.3 samples/s | 77.6 steps/s
[Step=27250 Epoch=53.1] | Loss=0.01218 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.336 | L2-Norm(final)=10.162 | 5050.4 samples/s | 78.9 steps/s
[Step=27300 Epoch=53.2] | Loss=0.01185 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.340 | L2-Norm(final)=10.163 | 5054.4 samples/s | 79.0 steps/s
[Step=27350 Epoch=53.3] | Loss=0.01176 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.344 | L2-Norm(final)=10.165 | 5040.7 samples/s | 78.8 steps/s
[Step=27400 Epoch=53.4] | Loss=0.01177 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=10.165 | 5052.5 samples/s | 78.9 steps/s
[Step=27450 Epoch=53.5] | Loss=0.01179 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=10.166 | 5086.8 samples/s | 79.5 steps/s
[Step=27500 Epoch=53.6] | Loss=0.01172 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=10.167 | 5264.0 samples/s | 82.2 steps/s
[Step=27550 Epoch=53.7] | Loss=0.01156 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=10.168 | 2026.7 samples/s | 31.7 steps/s
[Step=27600 Epoch=53.8] | Loss=0.01145 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.364 | L2-Norm(final)=10.169 | 5095.6 samples/s | 79.6 steps/s
[Step=27650 Epoch=53.9] | Loss=0.01125 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=10.170 | 5057.2 samples/s | 79.0 steps/s
[Step=27700 Epoch=54.0] | Loss=0.01104 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.372 | L2-Norm(final)=10.171 | 4993.3 samples/s | 78.0 steps/s
[Step=27750 Epoch=54.1] | Loss=0.01098 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.375 | L2-Norm(final)=10.172 | 5079.0 samples/s | 79.4 steps/s
[Step=27800 Epoch=54.2] | Loss=0.01091 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.379 | L2-Norm(final)=10.173 | 5001.1 samples/s | 78.1 steps/s
[Step=27850 Epoch=54.3] | Loss=0.01078 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.382 | L2-Norm(final)=10.174 | 4987.1 samples/s | 77.9 steps/s
[Step=27900 Epoch=54.4] | Loss=0.01067 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.385 | L2-Norm(final)=10.175 | 5015.4 samples/s | 78.4 steps/s
[Step=27950 Epoch=54.5] | Loss=0.01054 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.388 | L2-Norm(final)=10.176 | 5012.0 samples/s | 78.3 steps/s
[Step=28000 Epoch=54.6] | Loss=0.01043 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.391 | L2-Norm(final)=10.177 | 5022.0 samples/s | 78.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step28000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=22001 Epoch=84.3] | Loss=0.00001 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.187 | L2-Norm(final)=10.302 | 3827.2 samples/s | 59.8 steps/s
[Step=22050 Epoch=84.5] | Loss=0.00023 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.185 | L2-Norm(final)=10.303 | 5019.9 samples/s | 78.4 steps/s
[Step=22100 Epoch=84.7] | Loss=0.00016 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.185 | L2-Norm(final)=10.309 | 5549.4 samples/s | 86.7 steps/s
[Step=22150 Epoch=84.9] | Loss=0.00019 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.185 | L2-Norm(final)=10.313 | 5447.8 samples/s | 85.1 steps/s
[Step=22200 Epoch=85.1] | Loss=0.00016 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.185 | L2-Norm(final)=10.319 | 5564.2 samples/s | 86.9 steps/s
[Step=22250 Epoch=85.3] | Loss=0.00015 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.185 | L2-Norm(final)=10.323 | 7268.6 samples/s | 113.6 steps/s
[Step=22300 Epoch=85.4] | Loss=0.00016 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.185 | L2-Norm(final)=10.327 | 1989.3 samples/s | 31.1 steps/s
[Step=22350 Epoch=85.6] | Loss=0.00015 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.185 | L2-Norm(final)=10.331 | 5427.3 samples/s | 84.8 steps/s
[Step=22400 Epoch=85.8] | Loss=0.00015 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.185 | L2-Norm(final)=10.335 | 5366.0 samples/s | 83.8 steps/s
[Step=22450 Epoch=86.0] | Loss=0.00018 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.185 | L2-Norm(final)=10.339 | 5528.6 samples/s | 86.4 steps/s
[Step=22500 Epoch=86.2] | Loss=0.00016 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.185 | L2-Norm(final)=10.344 | 6123.0 samples/s | 95.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=86.2] | Loss=0.00002 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.184 | L2-Norm(final)=10.388 | 3913.5 samples/s | 61.1 steps/s
[Step=22550 Epoch=86.4] | Loss=0.00018 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.184 | L2-Norm(final)=10.389 | 4442.4 samples/s | 69.4 steps/s
[Step=22600 Epoch=86.6] | Loss=0.00016 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.179 | L2-Norm(final)=10.391 | 4777.1 samples/s | 74.6 steps/s
[Step=22650 Epoch=86.8] | Loss=0.00012 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.172 | L2-Norm(final)=10.392 | 4764.2 samples/s | 74.4 steps/s
[Step=22700 Epoch=87.0] | Loss=0.00009 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.163 | L2-Norm(final)=10.394 | 4742.5 samples/s | 74.1 steps/s
[Step=22750 Epoch=87.2] | Loss=0.00008 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.153 | L2-Norm(final)=10.395 | 6047.5 samples/s | 94.5 steps/s
[Step=22800 Epoch=87.4] | Loss=0.00007 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.143 | L2-Norm(final)=10.396 | 1876.0 samples/s | 29.3 steps/s
[Step=22850 Epoch=87.6] | Loss=0.00006 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.133 | L2-Norm(final)=10.397 | 4780.9 samples/s | 74.7 steps/s
[Step=22900 Epoch=87.7] | Loss=0.00005 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.122 | L2-Norm(final)=10.398 | 4819.4 samples/s | 75.3 steps/s
[Step=22950 Epoch=87.9] | Loss=0.00004 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.112 | L2-Norm(final)=10.399 | 4798.9 samples/s | 75.0 steps/s
[Step=23000 Epoch=88.1] | Loss=0.00004 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.101 | L2-Norm(final)=10.399 | 5280.7 samples/s | 82.5 steps/s
[Step=23050 Epoch=88.3] | Loss=0.00004 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.090 | L2-Norm(final)=10.400 | 1973.6 samples/s | 30.8 steps/s
[Step=23100 Epoch=88.5] | Loss=0.00003 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.079 | L2-Norm(final)=10.400 | 4804.7 samples/s | 75.1 steps/s
[Step=23150 Epoch=88.7] | Loss=0.00003 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.068 | L2-Norm(final)=10.401 | 4748.4 samples/s | 74.2 steps/s
[Step=23200 Epoch=88.9] | Loss=0.00003 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.056 | L2-Norm(final)=10.401 | 4746.9 samples/s | 74.2 steps/s
[Step=23250 Epoch=89.1] | Loss=0.00003 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.045 | L2-Norm(final)=10.402 | 4766.1 samples/s | 74.5 steps/s
[Step=23300 Epoch=89.3] | Loss=0.00003 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.034 | L2-Norm(final)=10.402 | 2050.0 samples/s | 32.0 steps/s
[Step=23350 Epoch=89.5] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.022 | L2-Norm(final)=10.403 | 4790.3 samples/s | 74.8 steps/s
[Step=23400 Epoch=89.7] | Loss=0.00002 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.011 | L2-Norm(final)=10.403 | 4869.9 samples/s | 76.1 steps/s
[Step=23450 Epoch=89.9] | Loss=0.00002 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.000 | L2-Norm(final)=10.404 | 4754.2 samples/s | 74.3 steps/s
[Step=23500 Epoch=90.0] | Loss=0.00002 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.988 | L2-Norm(final)=10.404 | 4801.1 samples/s | 75.0 steps/s
[Step=23550 Epoch=90.2] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.976 | L2-Norm(final)=10.404 | 2050.2 samples/s | 32.0 steps/s
[Step=23600 Epoch=90.4] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.965 | L2-Norm(final)=10.405 | 4679.2 samples/s | 73.1 steps/s
[Step=23650 Epoch=90.6] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.953 | L2-Norm(final)=10.405 | 4740.3 samples/s | 74.1 steps/s
[Step=23700 Epoch=90.8] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.941 | L2-Norm(final)=10.406 | 4797.1 samples/s | 75.0 steps/s
[Step=23750 Epoch=91.0] | Loss=0.00002 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.929 | L2-Norm(final)=10.406 | 4758.5 samples/s | 74.4 steps/s
[Step=23800 Epoch=91.2] | Loss=0.00002 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.917 | L2-Norm(final)=10.407 | 6575.0 samples/s | 102.7 steps/s
[Step=23850 Epoch=91.4] | Loss=0.00002 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=10.407 | 1846.5 samples/s | 28.9 steps/s
[Step=23900 Epoch=91.6] | Loss=0.00002 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.893 | L2-Norm(final)=10.407 | 4728.5 samples/s | 73.9 steps/s
[Step=23950 Epoch=91.8] | Loss=0.00002 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.881 | L2-Norm(final)=10.408 | 4765.7 samples/s | 74.5 steps/s
[Step=24000 Epoch=92.0] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.869 | L2-Norm(final)=10.408 | 4761.2 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07139 | acc=0.9681 | tpr=0.9766 | fpr=0.0503 | 4175.3 samples/s | 16.3 steps/s
Avg test loss: 0.07465, Avg test acc: 0.96751, Avg tpr: 0.97593, Avg fpr: 0.05102, total FA: 398

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06961 | acc=0.9672 | tpr=0.9728 | fpr=0.0451 | 4141.9 samples/s | 16.2 steps/s
Avg test loss: 0.07567, Avg test acc: 0.96558, Avg tpr: 0.97179, Avg fpr: 0.04807, total FA: 375

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.91153 | acc=0.3280 | tpr=0.0330 | fpr=0.0312 | 4193.4 samples/s | 16.4 steps/s
Avg test loss: 5.91830, Avg test acc: 0.32623, Avg tpr: 0.03293, Avg fpr: 0.02871, total FA: 224

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.21029 | acc=0.3253 | tpr=0.0244 | fpr=0.0213 | 4190.2 samples/s | 16.4 steps/s
Avg test loss: 6.22200, Avg test acc: 0.32242, Avg tpr: 0.02326, Avg fpr: 0.01961, total FA: 153

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.03421 | acc=0.0944 | tpr=0.9381 | fpr=0.9208 | 4207.3 samples/s | 16.4 steps/s
[Step= 100] | Loss=7.03338 | acc=0.0952 | tpr=0.9318 | fpr=0.9205 | 8076.0 samples/s | 31.5 steps/s
[Step= 150] | Loss=7.05214 | acc=0.0957 | tpr=0.9323 | fpr=0.9197 | 8356.9 samples/s | 32.6 steps/s
[Step= 200] | Loss=7.04425 | acc=0.0958 | tpr=0.9311 | fpr=0.9194 | 8634.8 samples/s | 33.7 steps/s
[Step= 250] | Loss=7.03847 | acc=0.0961 | tpr=0.9310 | fpr=0.9191 | 8175.3 samples/s | 31.9 steps/s
[Step= 300] | Loss=7.04074 | acc=0.0959 | tpr=0.9302 | fpr=0.9193 | 8073.7 samples/s | 31.5 steps/s
[Step= 350] | Loss=7.04457 | acc=0.0954 | tpr=0.9299 | fpr=0.9198 | 8370.1 samples/s | 32.7 steps/s
[Step= 400] | Loss=7.04632 | acc=0.0957 | tpr=0.9305 | fpr=0.9195 | 8543.7 samples/s | 33.4 steps/s
[Step= 450] | Loss=7.04913 | acc=0.0956 | tpr=0.9309 | fpr=0.9195 | 8058.6 samples/s | 31.5 steps/s
[Step= 500] | Loss=7.04856 | acc=0.0956 | tpr=0.9317 | fpr=0.9195 | 8337.8 samples/s | 32.6 steps/s
[Step= 550] | Loss=7.04682 | acc=0.0957 | tpr=0.9324 | fpr=0.9195 | 15299.3 samples/s | 59.8 steps/s
Avg test loss: 7.04751, Avg test acc: 0.09566, Avg tpr: 0.93265, Avg fpr: 0.91955, total FA: 127678

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.70647 | acc=0.1091 | tpr=0.9248 | fpr=0.9055 | 4205.6 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.69663 | acc=0.1094 | tpr=0.9126 | fpr=0.9056 | 8679.0 samples/s | 33.9 steps/s
[Step= 150] | Loss=6.72493 | acc=0.1096 | tpr=0.9121 | fpr=0.9051 | 8025.2 samples/s | 31.3 steps/s
[Step= 200] | Loss=6.72540 | acc=0.1100 | tpr=0.9093 | fpr=0.9046 | 8348.5 samples/s | 32.6 steps/s
[Step= 250] | Loss=6.72437 | acc=0.1104 | tpr=0.9118 | fpr=0.9042 | 8226.1 samples/s | 32.1 steps/s
[Step= 300] | Loss=6.72678 | acc=0.1104 | tpr=0.9091 | fpr=0.9041 | 8560.6 samples/s | 33.4 steps/s
[Step= 350] | Loss=6.72878 | acc=0.1097 | tpr=0.9067 | fpr=0.9047 | 8100.3 samples/s | 31.6 steps/s
[Step= 400] | Loss=6.73114 | acc=0.1098 | tpr=0.9065 | fpr=0.9047 | 8250.3 samples/s | 32.2 steps/s
[Step= 450] | Loss=6.73432 | acc=0.1098 | tpr=0.9070 | fpr=0.9047 | 8314.1 samples/s | 32.5 steps/s
[Step= 500] | Loss=6.73303 | acc=0.1099 | tpr=0.9101 | fpr=0.9045 | 8203.1 samples/s | 32.0 steps/s
[Step= 550] | Loss=6.73416 | acc=0.1100 | tpr=0.9109 | fpr=0.9046 | 15671.1 samples/s | 61.2 steps/s
Avg test loss: 6.73494, Avg test acc: 0.10995, Avg tpr: 0.91086, Avg fpr: 0.90461, total FA: 125603

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10884 | acc=0.9826 | tpr=0.9425 | fpr=0.0167 | 4210.6 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.11371 | acc=0.9820 | tpr=0.9488 | fpr=0.0173 | 8093.4 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.11800 | acc=0.9813 | tpr=0.9553 | fpr=0.0182 | 8237.0 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.11941 | acc=0.9810 | tpr=0.9585 | fpr=0.0186 | 8377.5 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.11749 | acc=0.9809 | tpr=0.9572 | fpr=0.0186 | 8330.3 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.12086 | acc=0.9806 | tpr=0.9564 | fpr=0.0190 | 8293.2 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.12140 | acc=0.9805 | tpr=0.9555 | fpr=0.0191 | 8407.4 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.12238 | acc=0.9803 | tpr=0.9540 | fpr=0.0193 | 8103.6 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.12465 | acc=0.9800 | tpr=0.9523 | fpr=0.0195 | 8208.4 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.12393 | acc=0.9801 | tpr=0.9533 | fpr=0.0194 | 8308.6 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.12250 | acc=0.9803 | tpr=0.9507 | fpr=0.0192 | 15494.7 samples/s | 60.5 steps/s
Avg test loss: 0.12238, Avg test acc: 0.98026, Avg tpr: 0.95048, Avg fpr: 0.01919, total FA: 2665

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16262 | acc=0.9808 | tpr=0.9558 | fpr=0.0188 | 4176.0 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.16990 | acc=0.9795 | tpr=0.9531 | fpr=0.0201 | 8360.7 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.17828 | acc=0.9787 | tpr=0.9568 | fpr=0.0209 | 8452.3 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.18110 | acc=0.9784 | tpr=0.9617 | fpr=0.0213 | 8215.9 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.17755 | acc=0.9783 | tpr=0.9581 | fpr=0.0213 | 8131.9 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.18233 | acc=0.9779 | tpr=0.9571 | fpr=0.0218 | 8701.6 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.18343 | acc=0.9779 | tpr=0.9580 | fpr=0.0218 | 8021.9 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.18445 | acc=0.9777 | tpr=0.9546 | fpr=0.0219 | 8415.9 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.18786 | acc=0.9774 | tpr=0.9533 | fpr=0.0222 | 8192.5 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.18733 | acc=0.9775 | tpr=0.9537 | fpr=0.0221 | 8130.8 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.18555 | acc=0.9776 | tpr=0.9522 | fpr=0.0219 | 15531.3 samples/s | 60.7 steps/s
Avg test loss: 0.18525, Avg test acc: 0.97765, Avg tpr: 0.95206, Avg fpr: 0.02188, total FA: 3038

server round 26/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=28001 Epoch=54.6] | Loss=0.00568 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.051 | L2-Norm(final)=10.205 | 4013.7 samples/s | 62.7 steps/s
[Step=28050 Epoch=54.7] | Loss=0.01189 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.051 | L2-Norm(final)=10.210 | 5245.8 samples/s | 82.0 steps/s
[Step=28100 Epoch=54.8] | Loss=0.01215 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.051 | L2-Norm(final)=10.214 | 5686.3 samples/s | 88.8 steps/s
[Step=28150 Epoch=54.9] | Loss=0.01194 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.051 | L2-Norm(final)=10.217 | 5764.0 samples/s | 90.1 steps/s
[Step=28200 Epoch=55.0] | Loss=0.01189 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.051 | L2-Norm(final)=10.221 | 5828.8 samples/s | 91.1 steps/s
[Step=28250 Epoch=55.1] | Loss=0.01204 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.051 | L2-Norm(final)=10.225 | 5924.5 samples/s | 92.6 steps/s
[Step=28300 Epoch=55.2] | Loss=0.01237 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.051 | L2-Norm(final)=10.228 | 5713.8 samples/s | 89.3 steps/s
[Step=28350 Epoch=55.3] | Loss=0.01203 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.051 | L2-Norm(final)=10.231 | 5795.0 samples/s | 90.5 steps/s
[Step=28400 Epoch=55.4] | Loss=0.01186 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.051 | L2-Norm(final)=10.235 | 5682.1 samples/s | 88.8 steps/s
[Step=28450 Epoch=55.5] | Loss=0.01183 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.051 | L2-Norm(final)=10.239 | 5827.4 samples/s | 91.1 steps/s
[Step=28500 Epoch=55.6] | Loss=0.01192 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.051 | L2-Norm(final)=10.243 | 7366.1 samples/s | 115.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=55.6] | Loss=0.00371 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.051 | L2-Norm(final)=10.280 | 3829.8 samples/s | 59.8 steps/s
[Step=28550 Epoch=55.7] | Loss=0.00986 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.064 | L2-Norm(final)=10.283 | 4890.3 samples/s | 76.4 steps/s
[Step=28600 Epoch=55.8] | Loss=0.01127 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.077 | L2-Norm(final)=10.284 | 4976.0 samples/s | 77.8 steps/s
[Step=28650 Epoch=55.9] | Loss=0.01247 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.090 | L2-Norm(final)=10.285 | 5004.1 samples/s | 78.2 steps/s
[Step=28700 Epoch=56.0] | Loss=0.01257 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.102 | L2-Norm(final)=10.286 | 5052.0 samples/s | 78.9 steps/s
[Step=28750 Epoch=56.1] | Loss=0.01242 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.112 | L2-Norm(final)=10.286 | 5002.6 samples/s | 78.2 steps/s
[Step=28800 Epoch=56.2] | Loss=0.01285 | Reg=0.00172 | acc=0.9688 | L2-Norm=13.121 | L2-Norm(final)=10.286 | 5040.2 samples/s | 78.8 steps/s
[Step=28850 Epoch=56.3] | Loss=0.01284 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.130 | L2-Norm(final)=10.286 | 5027.6 samples/s | 78.6 steps/s
[Step=28900 Epoch=56.4] | Loss=0.01270 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.138 | L2-Norm(final)=10.287 | 5047.3 samples/s | 78.9 steps/s
[Step=28950 Epoch=56.5] | Loss=0.01260 | Reg=0.00173 | acc=0.9688 | L2-Norm=13.145 | L2-Norm(final)=10.288 | 5021.0 samples/s | 78.5 steps/s
[Step=29000 Epoch=56.6] | Loss=0.01263 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.151 | L2-Norm(final)=10.289 | 6200.4 samples/s | 96.9 steps/s
[Step=29050 Epoch=56.7] | Loss=0.01238 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.157 | L2-Norm(final)=10.290 | 1917.5 samples/s | 30.0 steps/s
[Step=29100 Epoch=56.8] | Loss=0.01204 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.163 | L2-Norm(final)=10.291 | 4961.4 samples/s | 77.5 steps/s
[Step=29150 Epoch=56.9] | Loss=0.01170 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.168 | L2-Norm(final)=10.292 | 5079.9 samples/s | 79.4 steps/s
[Step=29200 Epoch=57.0] | Loss=0.01153 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.173 | L2-Norm(final)=10.294 | 5008.4 samples/s | 78.3 steps/s
[Step=29250 Epoch=57.0] | Loss=0.01130 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.178 | L2-Norm(final)=10.295 | 5090.4 samples/s | 79.5 steps/s
[Step=29300 Epoch=57.1] | Loss=0.01113 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.182 | L2-Norm(final)=10.297 | 4970.7 samples/s | 77.7 steps/s
[Step=29350 Epoch=57.2] | Loss=0.01094 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.186 | L2-Norm(final)=10.298 | 5057.3 samples/s | 79.0 steps/s
[Step=29400 Epoch=57.3] | Loss=0.01081 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.189 | L2-Norm(final)=10.299 | 4999.3 samples/s | 78.1 steps/s
[Step=29450 Epoch=57.4] | Loss=0.01070 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.193 | L2-Norm(final)=10.301 | 5026.5 samples/s | 78.5 steps/s
[Step=29500 Epoch=57.5] | Loss=0.01082 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.197 | L2-Norm(final)=10.302 | 5342.2 samples/s | 83.5 steps/s
[Step=29550 Epoch=57.6] | Loss=0.01081 | Reg=0.00174 | acc=0.9531 | L2-Norm=13.201 | L2-Norm(final)=10.303 | 1985.2 samples/s | 31.0 steps/s
[Step=29600 Epoch=57.7] | Loss=0.01060 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.205 | L2-Norm(final)=10.304 | 5077.0 samples/s | 79.3 steps/s
[Step=29650 Epoch=57.8] | Loss=0.01044 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.208 | L2-Norm(final)=10.305 | 5030.0 samples/s | 78.6 steps/s
[Step=29700 Epoch=57.9] | Loss=0.01032 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.212 | L2-Norm(final)=10.306 | 5100.3 samples/s | 79.7 steps/s
[Step=29750 Epoch=58.0] | Loss=0.01013 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.215 | L2-Norm(final)=10.308 | 4969.3 samples/s | 77.6 steps/s
[Step=29800 Epoch=58.1] | Loss=0.01002 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.219 | L2-Norm(final)=10.309 | 5041.6 samples/s | 78.8 steps/s
[Step=29850 Epoch=58.2] | Loss=0.01004 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.222 | L2-Norm(final)=10.310 | 5038.4 samples/s | 78.7 steps/s
[Step=29900 Epoch=58.3] | Loss=0.00991 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.225 | L2-Norm(final)=10.312 | 5049.8 samples/s | 78.9 steps/s
[Step=29950 Epoch=58.4] | Loss=0.00980 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.229 | L2-Norm(final)=10.313 | 4994.9 samples/s | 78.0 steps/s
[Step=30000 Epoch=58.5] | Loss=0.00978 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.232 | L2-Norm(final)=10.314 | 5038.2 samples/s | 78.7 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step30000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=92.0] | Loss=0.00021 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.051 | L2-Norm(final)=10.421 | 3914.6 samples/s | 61.2 steps/s
[Step=24050 Epoch=92.2] | Loss=0.00010 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.046 | L2-Norm(final)=10.426 | 5022.7 samples/s | 78.5 steps/s
[Step=24100 Epoch=92.3] | Loss=0.00028 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.046 | L2-Norm(final)=10.434 | 5389.6 samples/s | 84.2 steps/s
[Step=24150 Epoch=92.5] | Loss=0.00031 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.045 | L2-Norm(final)=10.445 | 5670.8 samples/s | 88.6 steps/s
[Step=24200 Epoch=92.7] | Loss=0.00026 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.045 | L2-Norm(final)=10.456 | 5539.9 samples/s | 86.6 steps/s
[Step=24250 Epoch=92.9] | Loss=0.00023 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.045 | L2-Norm(final)=10.464 | 7157.6 samples/s | 111.8 steps/s
[Step=24300 Epoch=93.1] | Loss=0.00021 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.045 | L2-Norm(final)=10.471 | 1962.3 samples/s | 30.7 steps/s
[Step=24350 Epoch=93.3] | Loss=0.00022 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.045 | L2-Norm(final)=10.479 | 5442.0 samples/s | 85.0 steps/s
[Step=24400 Epoch=93.5] | Loss=0.00023 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.045 | L2-Norm(final)=10.485 | 5410.0 samples/s | 84.5 steps/s
[Step=24450 Epoch=93.7] | Loss=0.00022 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.045 | L2-Norm(final)=10.492 | 5639.1 samples/s | 88.1 steps/s
[Step=24500 Epoch=93.9] | Loss=0.00022 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.045 | L2-Norm(final)=10.499 | 6075.5 samples/s | 94.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=93.9] | Loss=0.00005 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.045 | L2-Norm(final)=10.564 | 4038.6 samples/s | 63.1 steps/s
[Step=24550 Epoch=94.1] | Loss=0.00011 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.036 | L2-Norm(final)=10.567 | 4246.6 samples/s | 66.4 steps/s
[Step=24600 Epoch=94.3] | Loss=0.00007 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.024 | L2-Norm(final)=10.568 | 4706.5 samples/s | 73.5 steps/s
[Step=24650 Epoch=94.5] | Loss=0.00006 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.006 | L2-Norm(final)=10.569 | 4740.2 samples/s | 74.1 steps/s
[Step=24700 Epoch=94.6] | Loss=0.00010 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.994 | L2-Norm(final)=10.570 | 4750.4 samples/s | 74.2 steps/s
[Step=24750 Epoch=94.8] | Loss=0.00041 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.988 | L2-Norm(final)=10.571 | 6084.4 samples/s | 95.1 steps/s
[Step=24800 Epoch=95.0] | Loss=0.00058 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.992 | L2-Norm(final)=10.570 | 1877.9 samples/s | 29.3 steps/s
[Step=24850 Epoch=95.2] | Loss=0.00051 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.996 | L2-Norm(final)=10.569 | 4749.6 samples/s | 74.2 steps/s
[Step=24900 Epoch=95.4] | Loss=0.00045 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.998 | L2-Norm(final)=10.568 | 4923.3 samples/s | 76.9 steps/s
[Step=24950 Epoch=95.6] | Loss=0.00040 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.998 | L2-Norm(final)=10.568 | 4772.9 samples/s | 74.6 steps/s
[Step=25000 Epoch=95.8] | Loss=0.00038 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.996 | L2-Norm(final)=10.568 | 5391.9 samples/s | 84.2 steps/s
[Step=25050 Epoch=96.0] | Loss=0.00036 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.994 | L2-Norm(final)=10.568 | 1981.2 samples/s | 31.0 steps/s
[Step=25100 Epoch=96.2] | Loss=0.00033 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.992 | L2-Norm(final)=10.569 | 4759.3 samples/s | 74.4 steps/s
[Step=25150 Epoch=96.4] | Loss=0.00031 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.988 | L2-Norm(final)=10.569 | 4810.4 samples/s | 75.2 steps/s
[Step=25200 Epoch=96.6] | Loss=0.00029 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.984 | L2-Norm(final)=10.569 | 4821.0 samples/s | 75.3 steps/s
[Step=25250 Epoch=96.7] | Loss=0.00027 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.980 | L2-Norm(final)=10.569 | 4725.0 samples/s | 73.8 steps/s
[Step=25300 Epoch=96.9] | Loss=0.00025 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.975 | L2-Norm(final)=10.570 | 2051.7 samples/s | 32.1 steps/s
[Step=25350 Epoch=97.1] | Loss=0.00024 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.969 | L2-Norm(final)=10.570 | 4940.0 samples/s | 77.2 steps/s
[Step=25400 Epoch=97.3] | Loss=0.00022 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.964 | L2-Norm(final)=10.570 | 4908.0 samples/s | 76.7 steps/s
[Step=25450 Epoch=97.5] | Loss=0.00021 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.958 | L2-Norm(final)=10.570 | 4814.1 samples/s | 75.2 steps/s
[Step=25500 Epoch=97.7] | Loss=0.00020 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.952 | L2-Norm(final)=10.570 | 4893.2 samples/s | 76.5 steps/s
[Step=25550 Epoch=97.9] | Loss=0.00019 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.945 | L2-Norm(final)=10.571 | 2055.7 samples/s | 32.1 steps/s
[Step=25600 Epoch=98.1] | Loss=0.00018 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.939 | L2-Norm(final)=10.571 | 4780.9 samples/s | 74.7 steps/s
[Step=25650 Epoch=98.3] | Loss=0.00017 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.932 | L2-Norm(final)=10.571 | 4817.2 samples/s | 75.3 steps/s
[Step=25700 Epoch=98.5] | Loss=0.00017 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.925 | L2-Norm(final)=10.571 | 4762.5 samples/s | 74.4 steps/s
[Step=25750 Epoch=98.7] | Loss=0.00016 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.918 | L2-Norm(final)=10.571 | 4798.7 samples/s | 75.0 steps/s
[Step=25800 Epoch=98.9] | Loss=0.00015 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.911 | L2-Norm(final)=10.571 | 6471.5 samples/s | 101.1 steps/s
[Step=25850 Epoch=99.0] | Loss=0.00015 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.904 | L2-Norm(final)=10.572 | 1850.1 samples/s | 28.9 steps/s
[Step=25900 Epoch=99.2] | Loss=0.00014 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.896 | L2-Norm(final)=10.572 | 4822.3 samples/s | 75.3 steps/s
[Step=25950 Epoch=99.4] | Loss=0.00014 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.889 | L2-Norm(final)=10.572 | 4698.7 samples/s | 73.4 steps/s
[Step=26000 Epoch=99.6] | Loss=0.00013 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.881 | L2-Norm(final)=10.572 | 4795.7 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step26000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07123 | acc=0.9689 | tpr=0.9777 | fpr=0.0503 | 4217.5 samples/s | 16.5 steps/s
Avg test loss: 0.07466, Avg test acc: 0.96763, Avg tpr: 0.97575, Avg fpr: 0.05025, total FA: 392

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06961 | acc=0.9672 | tpr=0.9728 | fpr=0.0451 | 4211.9 samples/s | 16.5 steps/s
Avg test loss: 0.07567, Avg test acc: 0.96558, Avg tpr: 0.97179, Avg fpr: 0.04807, total FA: 375

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.83006 | acc=0.3176 | tpr=0.0202 | fpr=0.0367 | 4165.8 samples/s | 16.3 steps/s
Avg test loss: 6.83681, Avg test acc: 0.31589, Avg tpr: 0.02046, Avg fpr: 0.03435, total FA: 268

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.21029 | acc=0.3253 | tpr=0.0244 | fpr=0.0213 | 4182.0 samples/s | 16.3 steps/s
Avg test loss: 6.22200, Avg test acc: 0.32242, Avg tpr: 0.02326, Avg fpr: 0.01961, total FA: 153

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.10962 | acc=0.0966 | tpr=0.9558 | fpr=0.9188 | 4260.1 samples/s | 16.6 steps/s
[Step= 100] | Loss=7.09892 | acc=0.0968 | tpr=0.9403 | fpr=0.9189 | 8156.4 samples/s | 31.9 steps/s
[Step= 150] | Loss=7.12263 | acc=0.0973 | tpr=0.9409 | fpr=0.9182 | 8387.8 samples/s | 32.8 steps/s
[Step= 200] | Loss=7.12033 | acc=0.0975 | tpr=0.9399 | fpr=0.9179 | 8127.5 samples/s | 31.7 steps/s
[Step= 250] | Loss=7.11661 | acc=0.0982 | tpr=0.9389 | fpr=0.9171 | 8607.3 samples/s | 33.6 steps/s
[Step= 300] | Loss=7.11578 | acc=0.0984 | tpr=0.9396 | fpr=0.9170 | 8232.9 samples/s | 32.2 steps/s
[Step= 350] | Loss=7.11777 | acc=0.0978 | tpr=0.9424 | fpr=0.9175 | 8349.6 samples/s | 32.6 steps/s
[Step= 400] | Loss=7.12146 | acc=0.0978 | tpr=0.9420 | fpr=0.9175 | 8242.6 samples/s | 32.2 steps/s
[Step= 450] | Loss=7.12424 | acc=0.0979 | tpr=0.9430 | fpr=0.9174 | 8468.9 samples/s | 33.1 steps/s
[Step= 500] | Loss=7.12311 | acc=0.0979 | tpr=0.9445 | fpr=0.9174 | 8020.6 samples/s | 31.3 steps/s
[Step= 550] | Loss=7.12097 | acc=0.0981 | tpr=0.9447 | fpr=0.9173 | 15386.4 samples/s | 60.1 steps/s
Avg test loss: 7.12175, Avg test acc: 0.09809, Avg tpr: 0.94493, Avg fpr: 0.91731, total FA: 127366

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.70647 | acc=0.1091 | tpr=0.9248 | fpr=0.9055 | 4204.4 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.69663 | acc=0.1094 | tpr=0.9126 | fpr=0.9056 | 8570.2 samples/s | 33.5 steps/s
[Step= 150] | Loss=6.72493 | acc=0.1096 | tpr=0.9121 | fpr=0.9051 | 8103.9 samples/s | 31.7 steps/s
[Step= 200] | Loss=6.72540 | acc=0.1100 | tpr=0.9093 | fpr=0.9046 | 8363.8 samples/s | 32.7 steps/s
[Step= 250] | Loss=6.72437 | acc=0.1104 | tpr=0.9118 | fpr=0.9042 | 8604.9 samples/s | 33.6 steps/s
[Step= 300] | Loss=6.72678 | acc=0.1104 | tpr=0.9091 | fpr=0.9041 | 8071.0 samples/s | 31.5 steps/s
[Step= 350] | Loss=6.72878 | acc=0.1097 | tpr=0.9067 | fpr=0.9047 | 8201.4 samples/s | 32.0 steps/s
[Step= 400] | Loss=6.73114 | acc=0.1098 | tpr=0.9065 | fpr=0.9047 | 8529.7 samples/s | 33.3 steps/s
[Step= 450] | Loss=6.73432 | acc=0.1098 | tpr=0.9070 | fpr=0.9047 | 8253.7 samples/s | 32.2 steps/s
[Step= 500] | Loss=6.73303 | acc=0.1099 | tpr=0.9101 | fpr=0.9045 | 8468.0 samples/s | 33.1 steps/s
[Step= 550] | Loss=6.73416 | acc=0.1100 | tpr=0.9109 | fpr=0.9046 | 14474.1 samples/s | 56.5 steps/s
Avg test loss: 6.73494, Avg test acc: 0.10995, Avg tpr: 0.91086, Avg fpr: 0.90461, total FA: 125603

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11824 | acc=0.9827 | tpr=0.9381 | fpr=0.0165 | 4195.7 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.12520 | acc=0.9820 | tpr=0.9467 | fpr=0.0173 | 8175.5 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.13078 | acc=0.9808 | tpr=0.9539 | fpr=0.0187 | 8340.8 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.13181 | acc=0.9806 | tpr=0.9596 | fpr=0.0190 | 8374.4 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.12979 | acc=0.9806 | tpr=0.9563 | fpr=0.0190 | 8178.5 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.13282 | acc=0.9803 | tpr=0.9542 | fpr=0.0192 | 8682.8 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.13320 | acc=0.9803 | tpr=0.9537 | fpr=0.0192 | 7884.0 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.13425 | acc=0.9802 | tpr=0.9524 | fpr=0.0193 | 8306.7 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.13693 | acc=0.9799 | tpr=0.9528 | fpr=0.0196 | 7887.0 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.13652 | acc=0.9800 | tpr=0.9542 | fpr=0.0195 | 8145.2 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.13545 | acc=0.9801 | tpr=0.9530 | fpr=0.0194 | 15101.6 samples/s | 59.0 steps/s
Avg test loss: 0.13531, Avg test acc: 0.98014, Avg tpr: 0.95285, Avg fpr: 0.01936, total FA: 2688

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16262 | acc=0.9808 | tpr=0.9558 | fpr=0.0188 | 4167.3 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.16990 | acc=0.9795 | tpr=0.9531 | fpr=0.0201 | 8152.1 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.17828 | acc=0.9787 | tpr=0.9568 | fpr=0.0209 | 8369.9 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.18110 | acc=0.9784 | tpr=0.9617 | fpr=0.0213 | 8317.4 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.17755 | acc=0.9783 | tpr=0.9581 | fpr=0.0213 | 8423.5 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.18233 | acc=0.9779 | tpr=0.9571 | fpr=0.0218 | 7919.7 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.18343 | acc=0.9779 | tpr=0.9580 | fpr=0.0218 | 8194.9 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.18445 | acc=0.9777 | tpr=0.9546 | fpr=0.0219 | 8311.1 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.18786 | acc=0.9774 | tpr=0.9533 | fpr=0.0222 | 8339.7 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.18733 | acc=0.9775 | tpr=0.9537 | fpr=0.0221 | 8298.2 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.18555 | acc=0.9776 | tpr=0.9522 | fpr=0.0219 | 14662.4 samples/s | 57.3 steps/s
Avg test loss: 0.18525, Avg test acc: 0.97765, Avg tpr: 0.95206, Avg fpr: 0.02188, total FA: 3038

server round 27/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=30001 Epoch=58.5] | Loss=0.00610 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.036 | L2-Norm(final)=10.350 | 3728.4 samples/s | 58.3 steps/s
[Step=30050 Epoch=58.6] | Loss=0.01432 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.036 | L2-Norm(final)=10.356 | 5279.4 samples/s | 82.5 steps/s
[Step=30100 Epoch=58.7] | Loss=0.01304 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.036 | L2-Norm(final)=10.363 | 5728.0 samples/s | 89.5 steps/s
[Step=30150 Epoch=58.8] | Loss=0.01375 | Reg=0.00170 | acc=0.9688 | L2-Norm=13.036 | L2-Norm(final)=10.369 | 5851.3 samples/s | 91.4 steps/s
[Step=30200 Epoch=58.9] | Loss=0.01447 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.036 | L2-Norm(final)=10.374 | 5800.5 samples/s | 90.6 steps/s
[Step=30250 Epoch=59.0] | Loss=0.01441 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.036 | L2-Norm(final)=10.378 | 5930.9 samples/s | 92.7 steps/s
[Step=30300 Epoch=59.1] | Loss=0.01392 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.036 | L2-Norm(final)=10.383 | 5834.2 samples/s | 91.2 steps/s
[Step=30350 Epoch=59.2] | Loss=0.01424 | Reg=0.00170 | acc=0.9531 | L2-Norm=13.036 | L2-Norm(final)=10.388 | 5841.0 samples/s | 91.3 steps/s
[Step=30400 Epoch=59.3] | Loss=0.01421 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.036 | L2-Norm(final)=10.393 | 5720.1 samples/s | 89.4 steps/s
[Step=30450 Epoch=59.4] | Loss=0.01395 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.036 | L2-Norm(final)=10.397 | 5799.9 samples/s | 90.6 steps/s
[Step=30500 Epoch=59.5] | Loss=0.01376 | Reg=0.00170 | acc=0.9688 | L2-Norm=13.036 | L2-Norm(final)=10.402 | 7239.1 samples/s | 113.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=30501 Epoch=59.5] | Loss=0.01867 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.036 | L2-Norm(final)=10.450 | 3779.4 samples/s | 59.1 steps/s
[Step=30550 Epoch=59.6] | Loss=0.01627 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.058 | L2-Norm(final)=10.451 | 4605.8 samples/s | 72.0 steps/s
[Step=30600 Epoch=59.7] | Loss=0.01517 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.077 | L2-Norm(final)=10.450 | 4970.0 samples/s | 77.7 steps/s
[Step=30650 Epoch=59.8] | Loss=0.01544 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.093 | L2-Norm(final)=10.449 | 5060.1 samples/s | 79.1 steps/s
[Step=30700 Epoch=59.9] | Loss=0.01487 | Reg=0.00172 | acc=0.9688 | L2-Norm=13.107 | L2-Norm(final)=10.448 | 5013.8 samples/s | 78.3 steps/s
[Step=30750 Epoch=60.0] | Loss=0.01470 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.118 | L2-Norm(final)=10.447 | 5072.0 samples/s | 79.3 steps/s
[Step=30800 Epoch=60.1] | Loss=0.01433 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.129 | L2-Norm(final)=10.446 | 5015.2 samples/s | 78.4 steps/s
[Step=30850 Epoch=60.2] | Loss=0.01379 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.138 | L2-Norm(final)=10.446 | 5045.2 samples/s | 78.8 steps/s
[Step=30900 Epoch=60.3] | Loss=0.01385 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.146 | L2-Norm(final)=10.446 | 5038.7 samples/s | 78.7 steps/s
[Step=30950 Epoch=60.4] | Loss=0.01356 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.154 | L2-Norm(final)=10.447 | 4999.8 samples/s | 78.1 steps/s
[Step=31000 Epoch=60.5] | Loss=0.01356 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.161 | L2-Norm(final)=10.447 | 6086.2 samples/s | 95.1 steps/s
[Step=31050 Epoch=60.6] | Loss=0.01314 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.167 | L2-Norm(final)=10.448 | 1881.5 samples/s | 29.4 steps/s
[Step=31100 Epoch=60.7] | Loss=0.01272 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.173 | L2-Norm(final)=10.450 | 5032.0 samples/s | 78.6 steps/s
[Step=31150 Epoch=60.8] | Loss=0.01238 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.179 | L2-Norm(final)=10.451 | 4994.6 samples/s | 78.0 steps/s
[Step=31200 Epoch=60.9] | Loss=0.01221 | Reg=0.00174 | acc=0.9688 | L2-Norm=13.184 | L2-Norm(final)=10.452 | 5053.1 samples/s | 79.0 steps/s
[Step=31250 Epoch=60.9] | Loss=0.01207 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.188 | L2-Norm(final)=10.453 | 4952.0 samples/s | 77.4 steps/s
[Step=31300 Epoch=61.0] | Loss=0.01190 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.193 | L2-Norm(final)=10.454 | 5028.3 samples/s | 78.6 steps/s
[Step=31350 Epoch=61.1] | Loss=0.01159 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.197 | L2-Norm(final)=10.456 | 5070.2 samples/s | 79.2 steps/s
[Step=31400 Epoch=61.2] | Loss=0.01152 | Reg=0.00174 | acc=0.9688 | L2-Norm=13.201 | L2-Norm(final)=10.457 | 4957.5 samples/s | 77.5 steps/s
[Step=31450 Epoch=61.3] | Loss=0.01131 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.205 | L2-Norm(final)=10.458 | 5045.3 samples/s | 78.8 steps/s
[Step=31500 Epoch=61.4] | Loss=0.01114 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.208 | L2-Norm(final)=10.460 | 5321.1 samples/s | 83.1 steps/s
[Step=31550 Epoch=61.5] | Loss=0.01104 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.212 | L2-Norm(final)=10.461 | 1966.8 samples/s | 30.7 steps/s
[Step=31600 Epoch=61.6] | Loss=0.01086 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.215 | L2-Norm(final)=10.462 | 5088.2 samples/s | 79.5 steps/s
[Step=31650 Epoch=61.7] | Loss=0.01065 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.218 | L2-Norm(final)=10.463 | 5015.1 samples/s | 78.4 steps/s
[Step=31700 Epoch=61.8] | Loss=0.01052 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.221 | L2-Norm(final)=10.465 | 5028.7 samples/s | 78.6 steps/s
[Step=31750 Epoch=61.9] | Loss=0.01042 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.224 | L2-Norm(final)=10.466 | 5044.1 samples/s | 78.8 steps/s
[Step=31800 Epoch=62.0] | Loss=0.01037 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.227 | L2-Norm(final)=10.468 | 5023.2 samples/s | 78.5 steps/s
[Step=31850 Epoch=62.1] | Loss=0.01027 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.230 | L2-Norm(final)=10.469 | 5037.2 samples/s | 78.7 steps/s
[Step=31900 Epoch=62.2] | Loss=0.01028 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.233 | L2-Norm(final)=10.470 | 5056.1 samples/s | 79.0 steps/s
[Step=31950 Epoch=62.3] | Loss=0.01020 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.236 | L2-Norm(final)=10.471 | 4970.1 samples/s | 77.7 steps/s
[Step=32000 Epoch=62.4] | Loss=0.01010 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.239 | L2-Norm(final)=10.473 | 4990.0 samples/s | 78.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step32000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=24001 Epoch=92.4] | Loss=0.00014 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.036 | L2-Norm(final)=11.388 | 3872.3 samples/s | 60.5 steps/s
[Step=24050 Epoch=92.6] | Loss=0.00028 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.034 | L2-Norm(final)=11.393 | 5057.9 samples/s | 79.0 steps/s
[Step=24100 Epoch=92.8] | Loss=0.00023 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.034 | L2-Norm(final)=11.402 | 5567.1 samples/s | 87.0 steps/s
[Step=24150 Epoch=93.0] | Loss=0.00023 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.034 | L2-Norm(final)=11.409 | 5484.7 samples/s | 85.7 steps/s
[Step=24200 Epoch=93.2] | Loss=0.00019 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.034 | L2-Norm(final)=11.415 | 5574.6 samples/s | 87.1 steps/s
[Step=24250 Epoch=93.3] | Loss=0.00018 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.034 | L2-Norm(final)=11.421 | 7479.2 samples/s | 116.9 steps/s
[Step=24300 Epoch=93.5] | Loss=0.00017 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.034 | L2-Norm(final)=11.427 | 1935.6 samples/s | 30.2 steps/s
[Step=24350 Epoch=93.7] | Loss=0.00016 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.034 | L2-Norm(final)=11.432 | 5450.1 samples/s | 85.2 steps/s
[Step=24400 Epoch=93.9] | Loss=0.00016 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.034 | L2-Norm(final)=11.437 | 5436.9 samples/s | 85.0 steps/s
[Step=24450 Epoch=94.1] | Loss=0.00017 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.034 | L2-Norm(final)=11.443 | 5442.6 samples/s | 85.0 steps/s
[Step=24500 Epoch=94.3] | Loss=0.00017 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.034 | L2-Norm(final)=11.448 | 6346.1 samples/s | 99.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=94.3] | Loss=0.00000 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.034 | L2-Norm(final)=11.504 | 3902.6 samples/s | 61.0 steps/s
[Step=24550 Epoch=94.5] | Loss=0.00012 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.034 | L2-Norm(final)=11.506 | 4462.2 samples/s | 69.7 steps/s
[Step=24600 Epoch=94.7] | Loss=0.00007 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.028 | L2-Norm(final)=11.507 | 4826.2 samples/s | 75.4 steps/s
[Step=24650 Epoch=94.9] | Loss=0.00005 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.020 | L2-Norm(final)=11.508 | 4704.2 samples/s | 73.5 steps/s
[Step=24700 Epoch=95.1] | Loss=0.00004 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.011 | L2-Norm(final)=11.509 | 4805.1 samples/s | 75.1 steps/s
[Step=24750 Epoch=95.3] | Loss=0.00003 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.003 | L2-Norm(final)=11.510 | 5976.4 samples/s | 93.4 steps/s
[Step=24800 Epoch=95.5] | Loss=0.00003 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.994 | L2-Norm(final)=11.511 | 1883.8 samples/s | 29.4 steps/s
[Step=24850 Epoch=95.7] | Loss=0.00003 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.985 | L2-Norm(final)=11.512 | 4790.1 samples/s | 74.8 steps/s
[Step=24900 Epoch=95.8] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.976 | L2-Norm(final)=11.512 | 4843.0 samples/s | 75.7 steps/s
[Step=24950 Epoch=96.0] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.967 | L2-Norm(final)=11.513 | 4698.3 samples/s | 73.4 steps/s
[Step=25000 Epoch=96.2] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.958 | L2-Norm(final)=11.514 | 5401.0 samples/s | 84.4 steps/s
[Step=25050 Epoch=96.4] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.948 | L2-Norm(final)=11.514 | 1944.0 samples/s | 30.4 steps/s
[Step=25100 Epoch=96.6] | Loss=0.00002 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.939 | L2-Norm(final)=11.515 | 4736.1 samples/s | 74.0 steps/s
[Step=25150 Epoch=96.8] | Loss=0.00002 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.929 | L2-Norm(final)=11.515 | 4849.8 samples/s | 75.8 steps/s
[Step=25200 Epoch=97.0] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.920 | L2-Norm(final)=11.516 | 4834.2 samples/s | 75.5 steps/s
[Step=25250 Epoch=97.2] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.910 | L2-Norm(final)=11.516 | 4897.9 samples/s | 76.5 steps/s
[Step=25300 Epoch=97.4] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=11.517 | 2027.1 samples/s | 31.7 steps/s
[Step=25350 Epoch=97.6] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.891 | L2-Norm(final)=11.517 | 4818.2 samples/s | 75.3 steps/s
[Step=25400 Epoch=97.8] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.881 | L2-Norm(final)=11.518 | 4861.8 samples/s | 76.0 steps/s
[Step=25450 Epoch=98.0] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.871 | L2-Norm(final)=11.518 | 4668.2 samples/s | 72.9 steps/s
[Step=25500 Epoch=98.2] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.861 | L2-Norm(final)=11.518 | 4783.4 samples/s | 74.7 steps/s
[Step=25550 Epoch=98.4] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.851 | L2-Norm(final)=11.519 | 2008.6 samples/s | 31.4 steps/s
[Step=25600 Epoch=98.5] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.840 | L2-Norm(final)=11.519 | 4788.8 samples/s | 74.8 steps/s
[Step=25650 Epoch=98.7] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.830 | L2-Norm(final)=11.520 | 4713.6 samples/s | 73.7 steps/s
[Step=25700 Epoch=98.9] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.820 | L2-Norm(final)=11.520 | 4740.2 samples/s | 74.1 steps/s
[Step=25750 Epoch=99.1] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.809 | L2-Norm(final)=11.520 | 4808.9 samples/s | 75.1 steps/s
[Step=25800 Epoch=99.3] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.799 | L2-Norm(final)=11.521 | 6946.7 samples/s | 108.5 steps/s
[Step=25850 Epoch=99.5] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.788 | L2-Norm(final)=11.521 | 1788.3 samples/s | 27.9 steps/s
[Step=25900 Epoch=99.7] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.777 | L2-Norm(final)=11.522 | 4782.0 samples/s | 74.7 steps/s
[Step=25950 Epoch=99.9] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.766 | L2-Norm(final)=11.522 | 4794.3 samples/s | 74.9 steps/s
[Step=26000 Epoch=100.1] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=11.523 | 4749.7 samples/s | 74.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_1/client_state-step26000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07104 | acc=0.9698 | tpr=0.9762 | fpr=0.0439 | 4165.0 samples/s | 16.3 steps/s
Avg test loss: 0.07387, Avg test acc: 0.96811, Avg tpr: 0.97488, Avg fpr: 0.04679, total FA: 365

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06961 | acc=0.9672 | tpr=0.9728 | fpr=0.0451 | 4201.8 samples/s | 16.4 steps/s
Avg test loss: 0.07567, Avg test acc: 0.96558, Avg tpr: 0.97179, Avg fpr: 0.04807, total FA: 375

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.83006 | acc=0.3176 | tpr=0.0202 | fpr=0.0367 | 4182.8 samples/s | 16.3 steps/s
Avg test loss: 6.83681, Avg test acc: 0.31589, Avg tpr: 0.02046, Avg fpr: 0.03435, total FA: 268

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.61002 | acc=0.3324 | tpr=0.0416 | fpr=0.0362 | 4154.0 samples/s | 16.2 steps/s
Avg test loss: 5.61461, Avg test acc: 0.33088, Avg tpr: 0.04150, Avg fpr: 0.03269, total FA: 255

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.92289 | acc=0.0835 | tpr=0.9469 | fpr=0.9320 | 4178.3 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.92329 | acc=0.0841 | tpr=0.9403 | fpr=0.9319 | 8396.7 samples/s | 32.8 steps/s
[Step= 150] | Loss=6.94177 | acc=0.0848 | tpr=0.9366 | fpr=0.9309 | 8383.9 samples/s | 32.7 steps/s
[Step= 200] | Loss=6.94043 | acc=0.0848 | tpr=0.9355 | fpr=0.9307 | 8344.6 samples/s | 32.6 steps/s
[Step= 250] | Loss=6.93873 | acc=0.0850 | tpr=0.9362 | fpr=0.9305 | 8117.2 samples/s | 31.7 steps/s
[Step= 300] | Loss=6.93875 | acc=0.0853 | tpr=0.9345 | fpr=0.9302 | 8056.5 samples/s | 31.5 steps/s
[Step= 350] | Loss=6.94011 | acc=0.0844 | tpr=0.9355 | fpr=0.9310 | 9092.7 samples/s | 35.5 steps/s
[Step= 400] | Loss=6.94209 | acc=0.0844 | tpr=0.9344 | fpr=0.9310 | 7713.9 samples/s | 30.1 steps/s
[Step= 450] | Loss=6.94437 | acc=0.0846 | tpr=0.9352 | fpr=0.9308 | 8180.6 samples/s | 32.0 steps/s
[Step= 500] | Loss=6.94396 | acc=0.0844 | tpr=0.9344 | fpr=0.9309 | 8366.2 samples/s | 32.7 steps/s
[Step= 550] | Loss=6.94229 | acc=0.0845 | tpr=0.9359 | fpr=0.9310 | 14781.0 samples/s | 57.7 steps/s
Avg test loss: 6.94304, Avg test acc: 0.08448, Avg tpr: 0.93621, Avg fpr: 0.93100, total FA: 129268

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.70647 | acc=0.1091 | tpr=0.9248 | fpr=0.9055 | 4170.7 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.69663 | acc=0.1094 | tpr=0.9126 | fpr=0.9056 | 8320.6 samples/s | 32.5 steps/s
[Step= 150] | Loss=6.72493 | acc=0.1096 | tpr=0.9121 | fpr=0.9051 | 8391.9 samples/s | 32.8 steps/s
[Step= 200] | Loss=6.72540 | acc=0.1100 | tpr=0.9093 | fpr=0.9046 | 8206.9 samples/s | 32.1 steps/s
[Step= 250] | Loss=6.72437 | acc=0.1104 | tpr=0.9118 | fpr=0.9042 | 8279.6 samples/s | 32.3 steps/s
[Step= 300] | Loss=6.72678 | acc=0.1104 | tpr=0.9091 | fpr=0.9041 | 8273.1 samples/s | 32.3 steps/s
[Step= 350] | Loss=6.72878 | acc=0.1097 | tpr=0.9067 | fpr=0.9047 | 8177.7 samples/s | 31.9 steps/s
[Step= 400] | Loss=6.73114 | acc=0.1098 | tpr=0.9065 | fpr=0.9047 | 8357.6 samples/s | 32.6 steps/s
[Step= 450] | Loss=6.73432 | acc=0.1098 | tpr=0.9070 | fpr=0.9047 | 8298.3 samples/s | 32.4 steps/s
[Step= 500] | Loss=6.73303 | acc=0.1099 | tpr=0.9101 | fpr=0.9045 | 8141.7 samples/s | 31.8 steps/s
[Step= 550] | Loss=6.73416 | acc=0.1100 | tpr=0.9109 | fpr=0.9046 | 15631.4 samples/s | 61.1 steps/s
Avg test loss: 6.73494, Avg test acc: 0.10995, Avg tpr: 0.91086, Avg fpr: 0.90461, total FA: 125603

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11824 | acc=0.9827 | tpr=0.9381 | fpr=0.0165 | 4169.1 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.12520 | acc=0.9820 | tpr=0.9467 | fpr=0.0173 | 8395.2 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.13078 | acc=0.9808 | tpr=0.9539 | fpr=0.0187 | 8137.4 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.13181 | acc=0.9806 | tpr=0.9596 | fpr=0.0190 | 8405.7 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.12979 | acc=0.9806 | tpr=0.9563 | fpr=0.0190 | 8143.1 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.13282 | acc=0.9803 | tpr=0.9542 | fpr=0.0192 | 8384.4 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.13320 | acc=0.9803 | tpr=0.9537 | fpr=0.0192 | 8336.3 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.13425 | acc=0.9802 | tpr=0.9524 | fpr=0.0193 | 8668.6 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.13693 | acc=0.9799 | tpr=0.9528 | fpr=0.0196 | 8074.6 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.13652 | acc=0.9800 | tpr=0.9542 | fpr=0.0195 | 8261.9 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.13545 | acc=0.9801 | tpr=0.9530 | fpr=0.0194 | 15236.2 samples/s | 59.5 steps/s
Avg test loss: 0.13531, Avg test acc: 0.98014, Avg tpr: 0.95285, Avg fpr: 0.01936, total FA: 2688

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13865 | acc=0.9796 | tpr=0.9558 | fpr=0.0200 | 4302.2 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.14420 | acc=0.9789 | tpr=0.9574 | fpr=0.0207 | 7813.2 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.15057 | acc=0.9780 | tpr=0.9625 | fpr=0.0217 | 8386.1 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.15234 | acc=0.9778 | tpr=0.9661 | fpr=0.0220 | 8685.7 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.15026 | acc=0.9776 | tpr=0.9624 | fpr=0.0221 | 7888.3 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.15429 | acc=0.9773 | tpr=0.9615 | fpr=0.0224 | 8579.1 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.15506 | acc=0.9773 | tpr=0.9618 | fpr=0.0225 | 8439.6 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.15596 | acc=0.9771 | tpr=0.9595 | fpr=0.0226 | 8183.9 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.15871 | acc=0.9769 | tpr=0.9591 | fpr=0.0228 | 8411.7 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.15808 | acc=0.9769 | tpr=0.9604 | fpr=0.0228 | 8037.0 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.15641 | acc=0.9771 | tpr=0.9590 | fpr=0.0226 | 15233.6 samples/s | 59.5 steps/s
Avg test loss: 0.15619, Avg test acc: 0.97711, Avg tpr: 0.95880, Avg fpr: 0.02256, total FA: 3132

server round 28/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=32001 Epoch=62.4] | Loss=0.00439 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.889 | L2-Norm(final)=10.511 | 3483.9 samples/s | 54.4 steps/s
[Step=32050 Epoch=62.5] | Loss=0.01368 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.890 | L2-Norm(final)=10.512 | 5884.3 samples/s | 91.9 steps/s
[Step=32100 Epoch=62.6] | Loss=0.01360 | Reg=0.00166 | acc=0.9688 | L2-Norm=12.890 | L2-Norm(final)=10.515 | 5662.1 samples/s | 88.5 steps/s
[Step=32150 Epoch=62.7] | Loss=0.01300 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.891 | L2-Norm(final)=10.520 | 5776.7 samples/s | 90.3 steps/s
[Step=32200 Epoch=62.8] | Loss=0.01225 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.891 | L2-Norm(final)=10.526 | 5890.8 samples/s | 92.0 steps/s
[Step=32250 Epoch=62.9] | Loss=0.01259 | Reg=0.00166 | acc=0.9688 | L2-Norm=12.891 | L2-Norm(final)=10.531 | 5853.3 samples/s | 91.5 steps/s
[Step=32300 Epoch=63.0] | Loss=0.01220 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.891 | L2-Norm(final)=10.535 | 5726.2 samples/s | 89.5 steps/s
[Step=32350 Epoch=63.1] | Loss=0.01207 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.891 | L2-Norm(final)=10.540 | 5795.7 samples/s | 90.6 steps/s
[Step=32400 Epoch=63.2] | Loss=0.01200 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.891 | L2-Norm(final)=10.545 | 5808.9 samples/s | 90.8 steps/s
[Step=32450 Epoch=63.3] | Loss=0.01219 | Reg=0.00166 | acc=0.9688 | L2-Norm=12.891 | L2-Norm(final)=10.549 | 5745.0 samples/s | 89.8 steps/s
[Step=32500 Epoch=63.4] | Loss=0.01202 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.891 | L2-Norm(final)=10.554 | 7326.0 samples/s | 114.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=32501 Epoch=63.4] | Loss=0.02142 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.891 | L2-Norm(final)=10.601 | 3753.1 samples/s | 58.6 steps/s
[Step=32550 Epoch=63.5] | Loss=0.01410 | Reg=0.00167 | acc=0.9688 | L2-Norm=12.909 | L2-Norm(final)=10.600 | 4944.7 samples/s | 77.3 steps/s
[Step=32600 Epoch=63.6] | Loss=0.01348 | Reg=0.00167 | acc=0.9531 | L2-Norm=12.928 | L2-Norm(final)=10.599 | 5022.6 samples/s | 78.5 steps/s
[Step=32650 Epoch=63.7] | Loss=0.01353 | Reg=0.00167 | acc=0.9688 | L2-Norm=12.940 | L2-Norm(final)=10.597 | 5033.4 samples/s | 78.6 steps/s
[Step=32700 Epoch=63.8] | Loss=0.01306 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.949 | L2-Norm(final)=10.597 | 5085.3 samples/s | 79.5 steps/s
[Step=32750 Epoch=63.9] | Loss=0.01295 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.958 | L2-Norm(final)=10.597 | 4969.0 samples/s | 77.6 steps/s
[Step=32800 Epoch=64.0] | Loss=0.01223 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.966 | L2-Norm(final)=10.598 | 4984.4 samples/s | 77.9 steps/s
[Step=32850 Epoch=64.1] | Loss=0.01221 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.974 | L2-Norm(final)=10.599 | 5080.8 samples/s | 79.4 steps/s
[Step=32900 Epoch=64.2] | Loss=0.01240 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.981 | L2-Norm(final)=10.600 | 4969.8 samples/s | 77.7 steps/s
[Step=32950 Epoch=64.3] | Loss=0.01263 | Reg=0.00169 | acc=0.9531 | L2-Norm=12.988 | L2-Norm(final)=10.601 | 4993.2 samples/s | 78.0 steps/s
[Step=33000 Epoch=64.4] | Loss=0.01251 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.995 | L2-Norm(final)=10.601 | 6185.7 samples/s | 96.7 steps/s
[Step=33050 Epoch=64.5] | Loss=0.01206 | Reg=0.00169 | acc=0.9844 | L2-Norm=13.001 | L2-Norm(final)=10.601 | 1869.9 samples/s | 29.2 steps/s
[Step=33100 Epoch=64.6] | Loss=0.01177 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.007 | L2-Norm(final)=10.602 | 4775.4 samples/s | 74.6 steps/s
[Step=33150 Epoch=64.7] | Loss=0.01153 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.012 | L2-Norm(final)=10.603 | 4918.9 samples/s | 76.9 steps/s
[Step=33200 Epoch=64.8] | Loss=0.01128 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.018 | L2-Norm(final)=10.605 | 4995.3 samples/s | 78.1 steps/s
[Step=33250 Epoch=64.9] | Loss=0.01116 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.023 | L2-Norm(final)=10.606 | 5055.2 samples/s | 79.0 steps/s
[Step=33300 Epoch=64.9] | Loss=0.01094 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.028 | L2-Norm(final)=10.607 | 5024.4 samples/s | 78.5 steps/s
[Step=33350 Epoch=65.0] | Loss=0.01075 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.033 | L2-Norm(final)=10.609 | 5164.5 samples/s | 80.7 steps/s
[Step=33400 Epoch=65.1] | Loss=0.01066 | Reg=0.00170 | acc=0.9531 | L2-Norm=13.037 | L2-Norm(final)=10.610 | 5042.2 samples/s | 78.8 steps/s
[Step=33450 Epoch=65.2] | Loss=0.01069 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.042 | L2-Norm(final)=10.612 | 5011.5 samples/s | 78.3 steps/s
[Step=33500 Epoch=65.3] | Loss=0.01066 | Reg=0.00170 | acc=0.9688 | L2-Norm=13.046 | L2-Norm(final)=10.613 | 5371.3 samples/s | 83.9 steps/s
[Step=33550 Epoch=65.4] | Loss=0.01043 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.050 | L2-Norm(final)=10.615 | 2000.7 samples/s | 31.3 steps/s
[Step=33600 Epoch=65.5] | Loss=0.01034 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.054 | L2-Norm(final)=10.616 | 4987.0 samples/s | 77.9 steps/s
[Step=33650 Epoch=65.6] | Loss=0.01014 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.059 | L2-Norm(final)=10.618 | 5013.2 samples/s | 78.3 steps/s
[Step=33700 Epoch=65.7] | Loss=0.00999 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.062 | L2-Norm(final)=10.620 | 5037.3 samples/s | 78.7 steps/s
[Step=33750 Epoch=65.8] | Loss=0.00993 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.066 | L2-Norm(final)=10.621 | 4980.9 samples/s | 77.8 steps/s
[Step=33800 Epoch=65.9] | Loss=0.00989 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.070 | L2-Norm(final)=10.623 | 5137.5 samples/s | 80.3 steps/s
[Step=33850 Epoch=66.0] | Loss=0.00985 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.073 | L2-Norm(final)=10.624 | 5074.2 samples/s | 79.3 steps/s
[Step=33900 Epoch=66.1] | Loss=0.00978 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.077 | L2-Norm(final)=10.626 | 4971.0 samples/s | 77.7 steps/s
[Step=33950 Epoch=66.2] | Loss=0.00970 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.080 | L2-Norm(final)=10.627 | 5056.2 samples/s | 79.0 steps/s
[Step=34000 Epoch=66.3] | Loss=0.00966 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.083 | L2-Norm(final)=10.628 | 5106.1 samples/s | 79.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step34000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=26001 Epoch=99.6] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.889 | L2-Norm(final)=10.578 | 4178.9 samples/s | 65.3 steps/s
[Step=26050 Epoch=99.8] | Loss=0.00020 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.887 | L2-Norm(final)=10.584 | 4854.5 samples/s | 75.9 steps/s
[Step=26100 Epoch=100.0] | Loss=0.00021 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=10.589 | 5464.1 samples/s | 85.4 steps/s
[Step=26150 Epoch=100.2] | Loss=0.00017 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=10.593 | 5623.8 samples/s | 87.9 steps/s
[Step=26200 Epoch=100.4] | Loss=0.00016 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=10.597 | 5561.9 samples/s | 86.9 steps/s
[Step=26250 Epoch=100.6] | Loss=0.00019 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.886 | L2-Norm(final)=10.600 | 7166.6 samples/s | 112.0 steps/s
[Step=26300 Epoch=100.8] | Loss=0.00018 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=10.605 | 1998.6 samples/s | 31.2 steps/s
[Step=26350 Epoch=101.0] | Loss=0.00017 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=10.610 | 5374.0 samples/s | 84.0 steps/s
[Step=26400 Epoch=101.2] | Loss=0.00017 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=10.614 | 5465.4 samples/s | 85.4 steps/s
[Step=26450 Epoch=101.3] | Loss=0.00016 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=10.618 | 5536.0 samples/s | 86.5 steps/s
[Step=26500 Epoch=101.5] | Loss=0.00017 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=10.623 | 6006.0 samples/s | 93.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=101.5] | Loss=0.00018 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=10.669 | 4058.3 samples/s | 63.4 steps/s
[Step=26550 Epoch=101.7] | Loss=0.00011 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.884 | L2-Norm(final)=10.671 | 4292.1 samples/s | 67.1 steps/s
[Step=26600 Epoch=101.9] | Loss=0.00006 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.875 | L2-Norm(final)=10.671 | 4711.7 samples/s | 73.6 steps/s
[Step=26650 Epoch=102.1] | Loss=0.00006 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.862 | L2-Norm(final)=10.672 | 4773.6 samples/s | 74.6 steps/s
[Step=26700 Epoch=102.3] | Loss=0.00005 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.852 | L2-Norm(final)=10.673 | 4782.4 samples/s | 74.7 steps/s
[Step=26750 Epoch=102.5] | Loss=0.00004 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.840 | L2-Norm(final)=10.674 | 5906.1 samples/s | 92.3 steps/s
[Step=26800 Epoch=102.7] | Loss=0.00003 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.828 | L2-Norm(final)=10.675 | 1897.0 samples/s | 29.6 steps/s
[Step=26850 Epoch=102.9] | Loss=0.00003 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.815 | L2-Norm(final)=10.676 | 4761.2 samples/s | 74.4 steps/s
[Step=26900 Epoch=103.1] | Loss=0.00003 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.802 | L2-Norm(final)=10.677 | 4750.3 samples/s | 74.2 steps/s
[Step=26950 Epoch=103.3] | Loss=0.00002 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.788 | L2-Norm(final)=10.677 | 4816.6 samples/s | 75.3 steps/s
[Step=27000 Epoch=103.5] | Loss=0.00002 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.775 | L2-Norm(final)=10.678 | 5276.1 samples/s | 82.4 steps/s
[Step=27050 Epoch=103.6] | Loss=0.00002 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.761 | L2-Norm(final)=10.678 | 1987.0 samples/s | 31.0 steps/s
[Step=27100 Epoch=103.8] | Loss=0.00002 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.747 | L2-Norm(final)=10.679 | 4747.7 samples/s | 74.2 steps/s
[Step=27150 Epoch=104.0] | Loss=0.00002 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.734 | L2-Norm(final)=10.679 | 4727.0 samples/s | 73.9 steps/s
[Step=27200 Epoch=104.2] | Loss=0.00002 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.720 | L2-Norm(final)=10.680 | 4759.0 samples/s | 74.4 steps/s
[Step=27250 Epoch=104.4] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.706 | L2-Norm(final)=10.680 | 4793.8 samples/s | 74.9 steps/s
[Step=27300 Epoch=104.6] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.692 | L2-Norm(final)=10.681 | 2044.1 samples/s | 31.9 steps/s
[Step=27350 Epoch=104.8] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.678 | L2-Norm(final)=10.681 | 4835.7 samples/s | 75.6 steps/s
[Step=27400 Epoch=105.0] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.664 | L2-Norm(final)=10.681 | 4735.2 samples/s | 74.0 steps/s
[Step=27450 Epoch=105.2] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.650 | L2-Norm(final)=10.682 | 4805.8 samples/s | 75.1 steps/s
[Step=27500 Epoch=105.4] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.635 | L2-Norm(final)=10.682 | 4824.3 samples/s | 75.4 steps/s
[Step=27550 Epoch=105.6] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.621 | L2-Norm(final)=10.682 | 2010.0 samples/s | 31.4 steps/s
[Step=27600 Epoch=105.8] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.607 | L2-Norm(final)=10.683 | 4815.0 samples/s | 75.2 steps/s
[Step=27650 Epoch=105.9] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.592 | L2-Norm(final)=10.683 | 4833.2 samples/s | 75.5 steps/s
[Step=27700 Epoch=106.1] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.578 | L2-Norm(final)=10.684 | 4740.1 samples/s | 74.1 steps/s
[Step=27750 Epoch=106.3] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.563 | L2-Norm(final)=10.684 | 4791.8 samples/s | 74.9 steps/s
[Step=27800 Epoch=106.5] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.548 | L2-Norm(final)=10.685 | 6431.0 samples/s | 100.5 steps/s
[Step=27850 Epoch=106.7] | Loss=0.00001 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.534 | L2-Norm(final)=10.685 | 1847.2 samples/s | 28.9 steps/s
[Step=27900 Epoch=106.9] | Loss=0.00001 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.519 | L2-Norm(final)=10.686 | 4833.9 samples/s | 75.5 steps/s
[Step=27950 Epoch=107.1] | Loss=0.00001 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.504 | L2-Norm(final)=10.686 | 4699.3 samples/s | 73.4 steps/s
[Step=28000 Epoch=107.3] | Loss=0.00001 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.489 | L2-Norm(final)=10.686 | 4829.1 samples/s | 75.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07542 | acc=0.9682 | tpr=0.9776 | fpr=0.0523 | 4121.6 samples/s | 16.1 steps/s
Avg test loss: 0.07776, Avg test acc: 0.96747, Avg tpr: 0.97704, Avg fpr: 0.05358, total FA: 418

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06961 | acc=0.9672 | tpr=0.9728 | fpr=0.0451 | 4133.3 samples/s | 16.1 steps/s
Avg test loss: 0.07567, Avg test acc: 0.96558, Avg tpr: 0.97179, Avg fpr: 0.04807, total FA: 375

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.30969 | acc=0.3267 | tpr=0.0261 | fpr=0.0206 | 4241.6 samples/s | 16.6 steps/s
Avg test loss: 6.31110, Avg test acc: 0.32467, Avg tpr: 0.02634, Avg fpr: 0.01923, total FA: 150

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.61002 | acc=0.3324 | tpr=0.0416 | fpr=0.0362 | 4173.1 samples/s | 16.3 steps/s
Avg test loss: 5.61461, Avg test acc: 0.33088, Avg tpr: 0.04150, Avg fpr: 0.03269, total FA: 255

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.51701 | acc=0.0935 | tpr=0.9558 | fpr=0.9220 | 4226.8 samples/s | 16.5 steps/s
[Step= 100] | Loss=7.52143 | acc=0.0943 | tpr=0.9424 | fpr=0.9215 | 8013.0 samples/s | 31.3 steps/s
[Step= 150] | Loss=7.54490 | acc=0.0945 | tpr=0.9409 | fpr=0.9211 | 8286.0 samples/s | 32.4 steps/s
[Step= 200] | Loss=7.53930 | acc=0.0943 | tpr=0.9443 | fpr=0.9212 | 8423.1 samples/s | 32.9 steps/s
[Step= 250] | Loss=7.53502 | acc=0.0947 | tpr=0.9485 | fpr=0.9208 | 7976.3 samples/s | 31.2 steps/s
[Step= 300] | Loss=7.53951 | acc=0.0948 | tpr=0.9498 | fpr=0.9208 | 7911.2 samples/s | 30.9 steps/s
[Step= 350] | Loss=7.54243 | acc=0.0940 | tpr=0.9505 | fpr=0.9215 | 8418.2 samples/s | 32.9 steps/s
[Step= 400] | Loss=7.54554 | acc=0.0939 | tpr=0.9486 | fpr=0.9216 | 8751.8 samples/s | 34.2 steps/s
[Step= 450] | Loss=7.54917 | acc=0.0940 | tpr=0.9489 | fpr=0.9215 | 5130.8 samples/s | 20.0 steps/s
[Step= 500] | Loss=7.54916 | acc=0.0939 | tpr=0.9502 | fpr=0.9215 | 8403.7 samples/s | 32.8 steps/s
[Step= 550] | Loss=7.54704 | acc=0.0942 | tpr=0.9511 | fpr=0.9214 | 14636.2 samples/s | 57.2 steps/s
Avg test loss: 7.54776, Avg test acc: 0.09418, Avg tpr: 0.95127, Avg fpr: 0.92140, total FA: 127935

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.70647 | acc=0.1091 | tpr=0.9248 | fpr=0.9055 | 4186.6 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.69663 | acc=0.1094 | tpr=0.9126 | fpr=0.9056 | 8616.1 samples/s | 33.7 steps/s
[Step= 150] | Loss=6.72493 | acc=0.1096 | tpr=0.9121 | fpr=0.9051 | 8213.0 samples/s | 32.1 steps/s
[Step= 200] | Loss=6.72540 | acc=0.1100 | tpr=0.9093 | fpr=0.9046 | 8244.8 samples/s | 32.2 steps/s
[Step= 250] | Loss=6.72437 | acc=0.1104 | tpr=0.9118 | fpr=0.9042 | 8085.2 samples/s | 31.6 steps/s
[Step= 300] | Loss=6.72678 | acc=0.1104 | tpr=0.9091 | fpr=0.9041 | 8286.8 samples/s | 32.4 steps/s
[Step= 350] | Loss=6.72878 | acc=0.1097 | tpr=0.9067 | fpr=0.9047 | 8610.7 samples/s | 33.6 steps/s
[Step= 400] | Loss=6.73114 | acc=0.1098 | tpr=0.9065 | fpr=0.9047 | 8170.9 samples/s | 31.9 steps/s
[Step= 450] | Loss=6.73432 | acc=0.1098 | tpr=0.9070 | fpr=0.9047 | 5012.4 samples/s | 19.6 steps/s
[Step= 500] | Loss=6.73303 | acc=0.1099 | tpr=0.9101 | fpr=0.9045 | 8462.9 samples/s | 33.1 steps/s
[Step= 550] | Loss=6.73416 | acc=0.1100 | tpr=0.9109 | fpr=0.9046 | 14952.9 samples/s | 58.4 steps/s
Avg test loss: 6.73494, Avg test acc: 0.10995, Avg tpr: 0.91086, Avg fpr: 0.90461, total FA: 125603

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11503 | acc=0.9827 | tpr=0.9425 | fpr=0.0166 | 4174.5 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.12154 | acc=0.9820 | tpr=0.9446 | fpr=0.0173 | 8033.3 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.12631 | acc=0.9812 | tpr=0.9510 | fpr=0.0182 | 8342.8 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.12729 | acc=0.9810 | tpr=0.9541 | fpr=0.0185 | 8375.8 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.12539 | acc=0.9810 | tpr=0.9520 | fpr=0.0184 | 8370.1 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.12903 | acc=0.9806 | tpr=0.9498 | fpr=0.0189 | 8191.2 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.12936 | acc=0.9806 | tpr=0.9493 | fpr=0.0188 | 8456.5 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.13053 | acc=0.9804 | tpr=0.9469 | fpr=0.0190 | 7130.0 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.13301 | acc=0.9802 | tpr=0.9460 | fpr=0.0192 | 5552.8 samples/s | 21.7 steps/s
[Step= 500] | Loss=0.13236 | acc=0.9802 | tpr=0.9463 | fpr=0.0192 | 8240.7 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.13117 | acc=0.9803 | tpr=0.9451 | fpr=0.0190 | 15180.5 samples/s | 59.3 steps/s
Avg test loss: 0.13098, Avg test acc: 0.98034, Avg tpr: 0.94493, Avg fpr: 0.01902, total FA: 2641

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13865 | acc=0.9796 | tpr=0.9558 | fpr=0.0200 | 4185.0 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.14420 | acc=0.9789 | tpr=0.9574 | fpr=0.0207 | 8214.2 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.15057 | acc=0.9780 | tpr=0.9625 | fpr=0.0217 | 8440.6 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.15234 | acc=0.9778 | tpr=0.9661 | fpr=0.0220 | 8204.6 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.15026 | acc=0.9776 | tpr=0.9624 | fpr=0.0221 | 8070.0 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.15429 | acc=0.9773 | tpr=0.9615 | fpr=0.0224 | 8403.6 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.15506 | acc=0.9773 | tpr=0.9618 | fpr=0.0225 | 8402.9 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.15596 | acc=0.9771 | tpr=0.9595 | fpr=0.0226 | 5129.3 samples/s | 20.0 steps/s
[Step= 450] | Loss=0.15871 | acc=0.9769 | tpr=0.9591 | fpr=0.0228 | 8813.3 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.15808 | acc=0.9769 | tpr=0.9604 | fpr=0.0228 | 7715.1 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.15641 | acc=0.9771 | tpr=0.9590 | fpr=0.0226 | 14844.7 samples/s | 58.0 steps/s
Avg test loss: 0.15619, Avg test acc: 0.97711, Avg tpr: 0.95880, Avg fpr: 0.02256, total FA: 3132

server round 29/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=34001 Epoch=66.3] | Loss=0.00431 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.704 | L2-Norm(final)=10.664 | 3748.4 samples/s | 58.6 steps/s
[Step=34050 Epoch=66.4] | Loss=0.00991 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.705 | L2-Norm(final)=10.666 | 5128.3 samples/s | 80.1 steps/s
[Step=34100 Epoch=66.5] | Loss=0.00949 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.705 | L2-Norm(final)=10.669 | 5840.1 samples/s | 91.3 steps/s
[Step=34150 Epoch=66.6] | Loss=0.01026 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.705 | L2-Norm(final)=10.671 | 5571.5 samples/s | 87.1 steps/s
[Step=34200 Epoch=66.7] | Loss=0.01029 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.705 | L2-Norm(final)=10.672 | 5817.5 samples/s | 90.9 steps/s
[Step=34250 Epoch=66.8] | Loss=0.01009 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.705 | L2-Norm(final)=10.673 | 5847.1 samples/s | 91.4 steps/s
[Step=34300 Epoch=66.9] | Loss=0.00992 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.705 | L2-Norm(final)=10.674 | 5754.6 samples/s | 89.9 steps/s
[Step=34350 Epoch=67.0] | Loss=0.01001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.705 | L2-Norm(final)=10.676 | 5757.7 samples/s | 90.0 steps/s
[Step=34400 Epoch=67.1] | Loss=0.01015 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.705 | L2-Norm(final)=10.677 | 5810.7 samples/s | 90.8 steps/s
[Step=34450 Epoch=67.2] | Loss=0.01005 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.705 | L2-Norm(final)=10.679 | 5779.0 samples/s | 90.3 steps/s
[Step=34500 Epoch=67.3] | Loss=0.01008 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.705 | L2-Norm(final)=10.681 | 7350.9 samples/s | 114.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=34501 Epoch=67.3] | Loss=0.03508 | Reg=0.00161 | acc=0.9688 | L2-Norm=12.705 | L2-Norm(final)=10.697 | 3720.3 samples/s | 58.1 steps/s
[Step=34550 Epoch=67.4] | Loss=0.01226 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.720 | L2-Norm(final)=10.698 | 4693.2 samples/s | 73.3 steps/s
[Step=34600 Epoch=67.5] | Loss=0.01148 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.738 | L2-Norm(final)=10.698 | 5027.3 samples/s | 78.6 steps/s
[Step=34650 Epoch=67.6] | Loss=0.01164 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.751 | L2-Norm(final)=10.697 | 5039.6 samples/s | 78.7 steps/s
[Step=34700 Epoch=67.7] | Loss=0.01260 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.765 | L2-Norm(final)=10.697 | 5031.9 samples/s | 78.6 steps/s
[Step=34750 Epoch=67.8] | Loss=0.01265 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.777 | L2-Norm(final)=10.697 | 4996.1 samples/s | 78.1 steps/s
[Step=34800 Epoch=67.9] | Loss=0.01319 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=10.697 | 4959.2 samples/s | 77.5 steps/s
[Step=34850 Epoch=68.0] | Loss=0.01280 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.796 | L2-Norm(final)=10.697 | 5041.8 samples/s | 78.8 steps/s
[Step=34900 Epoch=68.1] | Loss=0.01236 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.805 | L2-Norm(final)=10.698 | 5054.9 samples/s | 79.0 steps/s
[Step=34950 Epoch=68.2] | Loss=0.01234 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.813 | L2-Norm(final)=10.700 | 5091.3 samples/s | 79.6 steps/s
[Step=35000 Epoch=68.3] | Loss=0.01230 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.820 | L2-Norm(final)=10.701 | 6093.7 samples/s | 95.2 steps/s
[Step=35050 Epoch=68.4] | Loss=0.01193 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.827 | L2-Norm(final)=10.703 | 1910.5 samples/s | 29.9 steps/s
[Step=35100 Epoch=68.5] | Loss=0.01184 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.834 | L2-Norm(final)=10.705 | 5033.7 samples/s | 78.7 steps/s
[Step=35150 Epoch=68.6] | Loss=0.01151 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.840 | L2-Norm(final)=10.706 | 4959.0 samples/s | 77.5 steps/s
[Step=35200 Epoch=68.7] | Loss=0.01137 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.846 | L2-Norm(final)=10.708 | 5023.0 samples/s | 78.5 steps/s
[Step=35250 Epoch=68.8] | Loss=0.01127 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.852 | L2-Norm(final)=10.709 | 5049.8 samples/s | 78.9 steps/s
[Step=35300 Epoch=68.8] | Loss=0.01137 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.857 | L2-Norm(final)=10.710 | 5017.0 samples/s | 78.4 steps/s
[Step=35350 Epoch=68.9] | Loss=0.01122 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.863 | L2-Norm(final)=10.711 | 5163.0 samples/s | 80.7 steps/s
[Step=35400 Epoch=69.0] | Loss=0.01098 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.868 | L2-Norm(final)=10.713 | 5157.7 samples/s | 80.6 steps/s
[Step=35450 Epoch=69.1] | Loss=0.01073 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.873 | L2-Norm(final)=10.714 | 5030.9 samples/s | 78.6 steps/s
[Step=35500 Epoch=69.2] | Loss=0.01066 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.878 | L2-Norm(final)=10.716 | 5362.5 samples/s | 83.8 steps/s
[Step=35550 Epoch=69.3] | Loss=0.01058 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.882 | L2-Norm(final)=10.718 | 2025.4 samples/s | 31.6 steps/s
[Step=35600 Epoch=69.4] | Loss=0.01048 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=10.719 | 5108.9 samples/s | 79.8 steps/s
[Step=35650 Epoch=69.5] | Loss=0.01028 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.890 | L2-Norm(final)=10.721 | 5004.4 samples/s | 78.2 steps/s
[Step=35700 Epoch=69.6] | Loss=0.01005 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.894 | L2-Norm(final)=10.722 | 5045.5 samples/s | 78.8 steps/s
[Step=35750 Epoch=69.7] | Loss=0.01005 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.898 | L2-Norm(final)=10.724 | 4966.2 samples/s | 77.6 steps/s
[Step=35800 Epoch=69.8] | Loss=0.00996 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.902 | L2-Norm(final)=10.725 | 5023.8 samples/s | 78.5 steps/s
[Step=35850 Epoch=69.9] | Loss=0.00989 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.906 | L2-Norm(final)=10.727 | 5101.3 samples/s | 79.7 steps/s
[Step=35900 Epoch=70.0] | Loss=0.00984 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.910 | L2-Norm(final)=10.728 | 5168.1 samples/s | 80.8 steps/s
[Step=35950 Epoch=70.1] | Loss=0.00990 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.913 | L2-Norm(final)=10.729 | 5100.7 samples/s | 79.7 steps/s
[Step=36000 Epoch=70.2] | Loss=0.00981 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.917 | L2-Norm(final)=10.730 | 5107.1 samples/s | 79.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step36000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00025, len=1
[Step=28001 Epoch=107.3] | Loss=0.00868 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.704 | L2-Norm(final)=10.701 | 3916.6 samples/s | 61.2 steps/s
[Step=28050 Epoch=107.5] | Loss=0.00044 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.699 | L2-Norm(final)=10.711 | 4938.6 samples/s | 77.2 steps/s
[Step=28100 Epoch=107.7] | Loss=0.00027 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.698 | L2-Norm(final)=10.718 | 5437.5 samples/s | 85.0 steps/s
[Step=28150 Epoch=107.9] | Loss=0.00025 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.698 | L2-Norm(final)=10.724 | 5557.1 samples/s | 86.8 steps/s
[Step=28200 Epoch=108.1] | Loss=0.00023 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.698 | L2-Norm(final)=10.731 | 5499.7 samples/s | 85.9 steps/s
[Step=28250 Epoch=108.2] | Loss=0.00023 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.698 | L2-Norm(final)=10.736 | 6924.1 samples/s | 108.2 steps/s
[Step=28300 Epoch=108.4] | Loss=0.00021 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.698 | L2-Norm(final)=10.743 | 1923.1 samples/s | 30.0 steps/s
[Step=28350 Epoch=108.6] | Loss=0.00021 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.698 | L2-Norm(final)=10.749 | 5328.9 samples/s | 83.3 steps/s
[Step=28400 Epoch=108.8] | Loss=0.00023 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.698 | L2-Norm(final)=10.756 | 5495.6 samples/s | 85.9 steps/s
[Step=28450 Epoch=109.0] | Loss=0.00023 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.698 | L2-Norm(final)=10.763 | 5515.7 samples/s | 86.2 steps/s
[Step=28500 Epoch=109.2] | Loss=0.00022 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.698 | L2-Norm(final)=10.770 | 6163.8 samples/s | 96.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=109.2] | Loss=0.00000 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.698 | L2-Norm(final)=10.837 | 4051.0 samples/s | 63.3 steps/s
[Step=28550 Epoch=109.4] | Loss=0.00184 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.707 | L2-Norm(final)=10.840 | 4212.2 samples/s | 65.8 steps/s
[Step=28600 Epoch=109.6] | Loss=0.00311 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.754 | L2-Norm(final)=10.827 | 4801.4 samples/s | 75.0 steps/s
[Step=28650 Epoch=109.8] | Loss=0.00256 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.783 | L2-Norm(final)=10.818 | 4788.4 samples/s | 74.8 steps/s
[Step=28700 Epoch=110.0] | Loss=0.00209 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.801 | L2-Norm(final)=10.813 | 4732.1 samples/s | 73.9 steps/s
[Step=28750 Epoch=110.2] | Loss=0.00172 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.812 | L2-Norm(final)=10.811 | 6015.2 samples/s | 94.0 steps/s
[Step=28800 Epoch=110.4] | Loss=0.00144 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.818 | L2-Norm(final)=10.810 | 1883.1 samples/s | 29.4 steps/s
[Step=28850 Epoch=110.5] | Loss=0.00123 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.821 | L2-Norm(final)=10.809 | 4719.9 samples/s | 73.7 steps/s
[Step=28900 Epoch=110.7] | Loss=0.00110 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.823 | L2-Norm(final)=10.809 | 4811.5 samples/s | 75.2 steps/s
[Step=28950 Epoch=110.9] | Loss=0.00098 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.823 | L2-Norm(final)=10.809 | 4865.5 samples/s | 76.0 steps/s
[Step=29000 Epoch=111.1] | Loss=0.00088 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.823 | L2-Norm(final)=10.809 | 5303.7 samples/s | 82.9 steps/s
[Step=29050 Epoch=111.3] | Loss=0.00081 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.822 | L2-Norm(final)=10.809 | 1978.0 samples/s | 30.9 steps/s
[Step=29100 Epoch=111.5] | Loss=0.00074 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.820 | L2-Norm(final)=10.809 | 4820.1 samples/s | 75.3 steps/s
[Step=29150 Epoch=111.7] | Loss=0.00068 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.817 | L2-Norm(final)=10.809 | 4820.3 samples/s | 75.3 steps/s
[Step=29200 Epoch=111.9] | Loss=0.00063 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.815 | L2-Norm(final)=10.809 | 4807.9 samples/s | 75.1 steps/s
[Step=29250 Epoch=112.1] | Loss=0.00059 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.812 | L2-Norm(final)=10.809 | 4863.0 samples/s | 76.0 steps/s
[Step=29300 Epoch=112.3] | Loss=0.00056 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.808 | L2-Norm(final)=10.809 | 1992.8 samples/s | 31.1 steps/s
[Step=29350 Epoch=112.5] | Loss=0.00052 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.805 | L2-Norm(final)=10.809 | 4846.8 samples/s | 75.7 steps/s
[Step=29400 Epoch=112.7] | Loss=0.00049 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.801 | L2-Norm(final)=10.810 | 4875.8 samples/s | 76.2 steps/s
[Step=29450 Epoch=112.8] | Loss=0.00047 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.797 | L2-Norm(final)=10.810 | 4708.3 samples/s | 73.6 steps/s
[Step=29500 Epoch=113.0] | Loss=0.00045 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.793 | L2-Norm(final)=10.810 | 4769.5 samples/s | 74.5 steps/s
[Step=29550 Epoch=113.2] | Loss=0.00042 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.789 | L2-Norm(final)=10.810 | 2033.6 samples/s | 31.8 steps/s
[Step=29600 Epoch=113.4] | Loss=0.00041 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.785 | L2-Norm(final)=10.811 | 4858.2 samples/s | 75.9 steps/s
[Step=29650 Epoch=113.6] | Loss=0.00039 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=10.811 | 4784.2 samples/s | 74.8 steps/s
[Step=29700 Epoch=113.8] | Loss=0.00037 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.776 | L2-Norm(final)=10.811 | 4739.6 samples/s | 74.1 steps/s
[Step=29750 Epoch=114.0] | Loss=0.00036 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.771 | L2-Norm(final)=10.812 | 4811.7 samples/s | 75.2 steps/s
[Step=29800 Epoch=114.2] | Loss=0.00034 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.767 | L2-Norm(final)=10.812 | 6423.1 samples/s | 100.4 steps/s
[Step=29850 Epoch=114.4] | Loss=0.00033 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.762 | L2-Norm(final)=10.812 | 1831.7 samples/s | 28.6 steps/s
[Step=29900 Epoch=114.6] | Loss=0.00032 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.757 | L2-Norm(final)=10.813 | 4739.4 samples/s | 74.1 steps/s
[Step=29950 Epoch=114.8] | Loss=0.00031 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.752 | L2-Norm(final)=10.813 | 4719.4 samples/s | 73.7 steps/s
[Step=30000 Epoch=114.9] | Loss=0.00030 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.747 | L2-Norm(final)=10.813 | 4830.1 samples/s | 75.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step30000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07343 | acc=0.9680 | tpr=0.9754 | fpr=0.0481 | 4163.3 samples/s | 16.3 steps/s
Avg test loss: 0.07592, Avg test acc: 0.96731, Avg tpr: 0.97470, Avg fpr: 0.04897, total FA: 382

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06961 | acc=0.9672 | tpr=0.9728 | fpr=0.0451 | 4182.6 samples/s | 16.3 steps/s
Avg test loss: 0.07567, Avg test acc: 0.96558, Avg tpr: 0.97179, Avg fpr: 0.04807, total FA: 375

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.88517 | acc=0.3215 | tpr=0.0159 | fpr=0.0149 | 4195.6 samples/s | 16.4 steps/s
Avg test loss: 6.89747, Avg test acc: 0.32002, Avg tpr: 0.01649, Avg fpr: 0.01243, total FA: 97

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.61002 | acc=0.3324 | tpr=0.0416 | fpr=0.0362 | 4168.5 samples/s | 16.3 steps/s
Avg test loss: 5.61461, Avg test acc: 0.33088, Avg tpr: 0.04150, Avg fpr: 0.03269, total FA: 255

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.12245 | acc=0.0980 | tpr=0.9381 | fpr=0.9171 | 4299.4 samples/s | 16.8 steps/s
[Step= 100] | Loss=7.11670 | acc=0.0991 | tpr=0.9382 | fpr=0.9166 | 8072.2 samples/s | 31.5 steps/s
[Step= 150] | Loss=7.13550 | acc=0.0993 | tpr=0.9352 | fpr=0.9161 | 5050.1 samples/s | 19.7 steps/s
[Step= 200] | Loss=7.12952 | acc=0.0993 | tpr=0.9333 | fpr=0.9159 | 8406.1 samples/s | 32.8 steps/s
[Step= 250] | Loss=7.12908 | acc=0.0999 | tpr=0.9328 | fpr=0.9153 | 8207.1 samples/s | 32.1 steps/s
[Step= 300] | Loss=7.13173 | acc=0.0999 | tpr=0.9331 | fpr=0.9153 | 8117.1 samples/s | 31.7 steps/s
[Step= 350] | Loss=7.13309 | acc=0.0995 | tpr=0.9343 | fpr=0.9157 | 9101.5 samples/s | 35.6 steps/s
[Step= 400] | Loss=7.13553 | acc=0.0994 | tpr=0.9338 | fpr=0.9158 | 7668.5 samples/s | 30.0 steps/s
[Step= 450] | Loss=7.13763 | acc=0.0994 | tpr=0.9328 | fpr=0.9157 | 8280.4 samples/s | 32.3 steps/s
[Step= 500] | Loss=7.13806 | acc=0.0992 | tpr=0.9344 | fpr=0.9159 | 8407.4 samples/s | 32.8 steps/s
[Step= 550] | Loss=7.13551 | acc=0.0993 | tpr=0.9359 | fpr=0.9159 | 15370.9 samples/s | 60.0 steps/s
Avg test loss: 7.13642, Avg test acc: 0.09931, Avg tpr: 0.93542, Avg fpr: 0.91589, total FA: 127170

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.70647 | acc=0.1091 | tpr=0.9248 | fpr=0.9055 | 4235.9 samples/s | 16.5 steps/s
[Step= 100] | Loss=6.69663 | acc=0.1094 | tpr=0.9126 | fpr=0.9056 | 5845.7 samples/s | 22.8 steps/s
[Step= 150] | Loss=6.72493 | acc=0.1096 | tpr=0.9121 | fpr=0.9051 | 6843.9 samples/s | 26.7 steps/s
[Step= 200] | Loss=6.72540 | acc=0.1100 | tpr=0.9093 | fpr=0.9046 | 8284.3 samples/s | 32.4 steps/s
[Step= 250] | Loss=6.72437 | acc=0.1104 | tpr=0.9118 | fpr=0.9042 | 8270.9 samples/s | 32.3 steps/s
[Step= 300] | Loss=6.72678 | acc=0.1104 | tpr=0.9091 | fpr=0.9041 | 8435.5 samples/s | 33.0 steps/s
[Step= 350] | Loss=6.72878 | acc=0.1097 | tpr=0.9067 | fpr=0.9047 | 8162.5 samples/s | 31.9 steps/s
[Step= 400] | Loss=6.73114 | acc=0.1098 | tpr=0.9065 | fpr=0.9047 | 8336.2 samples/s | 32.6 steps/s
[Step= 450] | Loss=6.73432 | acc=0.1098 | tpr=0.9070 | fpr=0.9047 | 8157.8 samples/s | 31.9 steps/s
[Step= 500] | Loss=6.73303 | acc=0.1099 | tpr=0.9101 | fpr=0.9045 | 8085.2 samples/s | 31.6 steps/s
[Step= 550] | Loss=6.73416 | acc=0.1100 | tpr=0.9109 | fpr=0.9046 | 15547.6 samples/s | 60.7 steps/s
Avg test loss: 6.73494, Avg test acc: 0.10995, Avg tpr: 0.91086, Avg fpr: 0.90461, total FA: 125603

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12688 | acc=0.9821 | tpr=0.9425 | fpr=0.0172 | 4246.2 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.13463 | acc=0.9815 | tpr=0.9488 | fpr=0.0179 | 5056.4 samples/s | 19.8 steps/s
[Step= 150] | Loss=0.14178 | acc=0.9800 | tpr=0.9524 | fpr=0.0195 | 8246.1 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.14312 | acc=0.9800 | tpr=0.9574 | fpr=0.0196 | 8296.1 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.13969 | acc=0.9800 | tpr=0.9537 | fpr=0.0195 | 8201.8 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.14319 | acc=0.9797 | tpr=0.9498 | fpr=0.0197 | 8434.2 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.14413 | acc=0.9797 | tpr=0.9512 | fpr=0.0197 | 8283.3 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.14512 | acc=0.9795 | tpr=0.9475 | fpr=0.0199 | 8006.1 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.14844 | acc=0.9792 | tpr=0.9464 | fpr=0.0202 | 8258.3 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.14739 | acc=0.9793 | tpr=0.9463 | fpr=0.0201 | 8232.2 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.14655 | acc=0.9793 | tpr=0.9431 | fpr=0.0200 | 15696.8 samples/s | 61.3 steps/s
Avg test loss: 0.14631, Avg test acc: 0.97935, Avg tpr: 0.94295, Avg fpr: 0.01999, total FA: 2776

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13865 | acc=0.9796 | tpr=0.9558 | fpr=0.0200 | 4163.4 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.14420 | acc=0.9789 | tpr=0.9574 | fpr=0.0207 | 5239.8 samples/s | 20.5 steps/s
[Step= 150] | Loss=0.15057 | acc=0.9780 | tpr=0.9625 | fpr=0.0217 | 8197.0 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.15234 | acc=0.9778 | tpr=0.9661 | fpr=0.0220 | 8280.2 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.15026 | acc=0.9776 | tpr=0.9624 | fpr=0.0221 | 8410.6 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.15429 | acc=0.9773 | tpr=0.9615 | fpr=0.0224 | 8427.8 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.15506 | acc=0.9773 | tpr=0.9618 | fpr=0.0225 | 8473.6 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.15596 | acc=0.9771 | tpr=0.9595 | fpr=0.0226 | 8071.3 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.15871 | acc=0.9769 | tpr=0.9591 | fpr=0.0228 | 8222.9 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.15808 | acc=0.9769 | tpr=0.9604 | fpr=0.0228 | 8251.8 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.15641 | acc=0.9771 | tpr=0.9590 | fpr=0.0226 | 15878.2 samples/s | 62.0 steps/s
Avg test loss: 0.15619, Avg test acc: 0.97711, Avg tpr: 0.95880, Avg fpr: 0.02256, total FA: 3132

server round 30/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=36001 Epoch=70.2] | Loss=0.00077 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.788 | L2-Norm(final)=10.761 | 4089.0 samples/s | 63.9 steps/s
[Step=36050 Epoch=70.3] | Loss=0.00959 | Reg=0.00164 | acc=0.9688 | L2-Norm=12.789 | L2-Norm(final)=10.766 | 4988.9 samples/s | 78.0 steps/s
[Step=36100 Epoch=70.4] | Loss=0.01031 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.789 | L2-Norm(final)=10.770 | 5755.7 samples/s | 89.9 steps/s
[Step=36150 Epoch=70.5] | Loss=0.01093 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.789 | L2-Norm(final)=10.773 | 5757.4 samples/s | 90.0 steps/s
[Step=36200 Epoch=70.6] | Loss=0.01103 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.789 | L2-Norm(final)=10.775 | 5937.6 samples/s | 92.8 steps/s
[Step=36250 Epoch=70.7] | Loss=0.01109 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.789 | L2-Norm(final)=10.777 | 5756.7 samples/s | 89.9 steps/s
[Step=36300 Epoch=70.8] | Loss=0.01121 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.789 | L2-Norm(final)=10.779 | 5747.6 samples/s | 89.8 steps/s
[Step=36350 Epoch=70.9] | Loss=0.01142 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.789 | L2-Norm(final)=10.781 | 5847.4 samples/s | 91.4 steps/s
[Step=36400 Epoch=71.0] | Loss=0.01135 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.789 | L2-Norm(final)=10.784 | 5819.3 samples/s | 90.9 steps/s
[Step=36450 Epoch=71.1] | Loss=0.01107 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.789 | L2-Norm(final)=10.786 | 5809.1 samples/s | 90.8 steps/s
[Step=36500 Epoch=71.2] | Loss=0.01121 | Reg=0.00164 | acc=0.9688 | L2-Norm=12.789 | L2-Norm(final)=10.789 | 7353.5 samples/s | 114.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=71.2] | Loss=0.03701 | Reg=0.00164 | acc=0.9688 | L2-Norm=12.789 | L2-Norm(final)=10.817 | 3719.7 samples/s | 58.1 steps/s
[Step=36550 Epoch=71.3] | Loss=0.01347 | Reg=0.00164 | acc=0.9688 | L2-Norm=12.795 | L2-Norm(final)=10.818 | 4731.0 samples/s | 73.9 steps/s
[Step=36600 Epoch=71.4] | Loss=0.01211 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.800 | L2-Norm(final)=10.818 | 5033.4 samples/s | 78.6 steps/s
[Step=36650 Epoch=71.5] | Loss=0.01113 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.804 | L2-Norm(final)=10.818 | 5102.6 samples/s | 79.7 steps/s
[Step=36700 Epoch=71.6] | Loss=0.01078 | Reg=0.00164 | acc=0.9688 | L2-Norm=12.807 | L2-Norm(final)=10.820 | 5019.9 samples/s | 78.4 steps/s
[Step=36750 Epoch=71.7] | Loss=0.01044 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.810 | L2-Norm(final)=10.821 | 5014.9 samples/s | 78.4 steps/s
[Step=36800 Epoch=71.8] | Loss=0.00979 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.813 | L2-Norm(final)=10.823 | 5067.2 samples/s | 79.2 steps/s
[Step=36850 Epoch=71.9] | Loss=0.00952 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.816 | L2-Norm(final)=10.824 | 5056.0 samples/s | 79.0 steps/s
[Step=36900 Epoch=72.0] | Loss=0.00925 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.818 | L2-Norm(final)=10.826 | 5011.9 samples/s | 78.3 steps/s
[Step=36950 Epoch=72.1] | Loss=0.00918 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.821 | L2-Norm(final)=10.827 | 4986.9 samples/s | 77.9 steps/s
[Step=37000 Epoch=72.2] | Loss=0.00902 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.823 | L2-Norm(final)=10.829 | 6162.1 samples/s | 96.3 steps/s
[Step=37050 Epoch=72.3] | Loss=0.00884 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.826 | L2-Norm(final)=10.831 | 1905.5 samples/s | 29.8 steps/s
[Step=37100 Epoch=72.4] | Loss=0.00874 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.828 | L2-Norm(final)=10.832 | 4993.1 samples/s | 78.0 steps/s
[Step=37150 Epoch=72.5] | Loss=0.00855 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.830 | L2-Norm(final)=10.834 | 4976.2 samples/s | 77.8 steps/s
[Step=37200 Epoch=72.6] | Loss=0.00827 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.832 | L2-Norm(final)=10.835 | 5119.2 samples/s | 80.0 steps/s
[Step=37250 Epoch=72.7] | Loss=0.00810 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.834 | L2-Norm(final)=10.836 | 5031.4 samples/s | 78.6 steps/s
[Step=37300 Epoch=72.7] | Loss=0.00792 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.835 | L2-Norm(final)=10.838 | 4981.6 samples/s | 77.8 steps/s
[Step=37350 Epoch=72.8] | Loss=0.00790 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.837 | L2-Norm(final)=10.839 | 5068.4 samples/s | 79.2 steps/s
[Step=37400 Epoch=72.9] | Loss=0.00800 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.838 | L2-Norm(final)=10.840 | 5063.7 samples/s | 79.1 steps/s
[Step=37450 Epoch=73.0] | Loss=0.00793 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.840 | L2-Norm(final)=10.841 | 5060.4 samples/s | 79.1 steps/s
[Step=37500 Epoch=73.1] | Loss=0.00785 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.841 | L2-Norm(final)=10.842 | 5318.9 samples/s | 83.1 steps/s
[Step=37550 Epoch=73.2] | Loss=0.00780 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.843 | L2-Norm(final)=10.843 | 2010.3 samples/s | 31.4 steps/s
[Step=37600 Epoch=73.3] | Loss=0.00757 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.844 | L2-Norm(final)=10.844 | 4980.9 samples/s | 77.8 steps/s
[Step=37650 Epoch=73.4] | Loss=0.00754 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.846 | L2-Norm(final)=10.845 | 5018.3 samples/s | 78.4 steps/s
[Step=37700 Epoch=73.5] | Loss=0.00743 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.847 | L2-Norm(final)=10.846 | 4993.9 samples/s | 78.0 steps/s
[Step=37750 Epoch=73.6] | Loss=0.00739 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.848 | L2-Norm(final)=10.847 | 5057.5 samples/s | 79.0 steps/s
[Step=37800 Epoch=73.7] | Loss=0.00734 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.850 | L2-Norm(final)=10.849 | 5023.3 samples/s | 78.5 steps/s
[Step=37850 Epoch=73.8] | Loss=0.00727 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.851 | L2-Norm(final)=10.850 | 4993.8 samples/s | 78.0 steps/s
[Step=37900 Epoch=73.9] | Loss=0.00724 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.852 | L2-Norm(final)=10.851 | 5034.6 samples/s | 78.7 steps/s
[Step=37950 Epoch=74.0] | Loss=0.00720 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.853 | L2-Norm(final)=10.852 | 5029.8 samples/s | 78.6 steps/s
[Step=38000 Epoch=74.1] | Loss=0.00718 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.855 | L2-Norm(final)=10.853 | 5000.0 samples/s | 78.1 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step38000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=30001 Epoch=115.0] | Loss=0.00000 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.788 | L2-Norm(final)=10.825 | 3600.4 samples/s | 56.3 steps/s
[Step=30050 Epoch=115.1] | Loss=0.00015 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=10.827 | 2416.7 samples/s | 37.8 steps/s
[Step=30100 Epoch=115.3] | Loss=0.00010 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=10.829 | 5040.0 samples/s | 78.8 steps/s
[Step=30150 Epoch=115.5] | Loss=0.00010 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=10.831 | 5406.8 samples/s | 84.5 steps/s
[Step=30200 Epoch=115.7] | Loss=0.00010 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=10.833 | 5456.7 samples/s | 85.3 steps/s
[Step=30250 Epoch=115.9] | Loss=0.00009 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=10.834 | 6394.3 samples/s | 99.9 steps/s
[Step=30300 Epoch=116.1] | Loss=0.00008 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=10.836 | 1960.1 samples/s | 30.6 steps/s
[Step=30350 Epoch=116.3] | Loss=0.00008 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=10.837 | 5508.8 samples/s | 86.1 steps/s
[Step=30400 Epoch=116.5] | Loss=0.00009 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=10.839 | 5428.1 samples/s | 84.8 steps/s
[Step=30450 Epoch=116.7] | Loss=0.00008 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=10.841 | 5516.4 samples/s | 86.2 steps/s
[Step=30500 Epoch=116.9] | Loss=0.00009 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=10.842 | 6116.6 samples/s | 95.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=116.9] | Loss=0.00000 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=10.860 | 4123.3 samples/s | 64.4 steps/s
[Step=30550 Epoch=117.1] | Loss=0.00022 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.785 | L2-Norm(final)=10.860 | 4145.4 samples/s | 64.8 steps/s
[Step=30600 Epoch=117.2] | Loss=0.00013 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.783 | L2-Norm(final)=10.861 | 4826.6 samples/s | 75.4 steps/s
[Step=30650 Epoch=117.4] | Loss=0.00009 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.779 | L2-Norm(final)=10.862 | 4667.8 samples/s | 72.9 steps/s
[Step=30700 Epoch=117.6] | Loss=0.00007 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.775 | L2-Norm(final)=10.863 | 4761.8 samples/s | 74.4 steps/s
[Step=30750 Epoch=117.8] | Loss=0.00006 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.770 | L2-Norm(final)=10.865 | 6082.2 samples/s | 95.0 steps/s
[Step=30800 Epoch=118.0] | Loss=0.00006 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.766 | L2-Norm(final)=10.866 | 1857.7 samples/s | 29.0 steps/s
[Step=30850 Epoch=118.2] | Loss=0.00005 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.762 | L2-Norm(final)=10.867 | 4725.5 samples/s | 73.8 steps/s
[Step=30900 Epoch=118.4] | Loss=0.00004 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=10.868 | 4696.3 samples/s | 73.4 steps/s
[Step=30950 Epoch=118.6] | Loss=0.00004 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.753 | L2-Norm(final)=10.869 | 4749.5 samples/s | 74.2 steps/s
[Step=31000 Epoch=118.8] | Loss=0.00004 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.748 | L2-Norm(final)=10.870 | 5338.9 samples/s | 83.4 steps/s
[Step=31050 Epoch=119.0] | Loss=0.00003 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.744 | L2-Norm(final)=10.871 | 1955.1 samples/s | 30.5 steps/s
[Step=31100 Epoch=119.2] | Loss=0.00003 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.739 | L2-Norm(final)=10.872 | 4802.3 samples/s | 75.0 steps/s
[Step=31150 Epoch=119.4] | Loss=0.00003 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.735 | L2-Norm(final)=10.873 | 4770.2 samples/s | 74.5 steps/s
[Step=31200 Epoch=119.5] | Loss=0.00003 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.730 | L2-Norm(final)=10.873 | 4885.8 samples/s | 76.3 steps/s
[Step=31250 Epoch=119.7] | Loss=0.00002 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.725 | L2-Norm(final)=10.874 | 4807.6 samples/s | 75.1 steps/s
[Step=31300 Epoch=119.9] | Loss=0.00002 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.721 | L2-Norm(final)=10.875 | 2042.0 samples/s | 31.9 steps/s
[Step=31350 Epoch=120.1] | Loss=0.00002 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.716 | L2-Norm(final)=10.875 | 4881.1 samples/s | 76.3 steps/s
[Step=31400 Epoch=120.3] | Loss=0.00002 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.711 | L2-Norm(final)=10.876 | 4805.8 samples/s | 75.1 steps/s
[Step=31450 Epoch=120.5] | Loss=0.00002 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.706 | L2-Norm(final)=10.876 | 4771.7 samples/s | 74.6 steps/s
[Step=31500 Epoch=120.7] | Loss=0.00002 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.701 | L2-Norm(final)=10.876 | 4781.7 samples/s | 74.7 steps/s
[Step=31550 Epoch=120.9] | Loss=0.00002 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.696 | L2-Norm(final)=10.877 | 2051.5 samples/s | 32.1 steps/s
[Step=31600 Epoch=121.1] | Loss=0.00002 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.691 | L2-Norm(final)=10.877 | 4738.7 samples/s | 74.0 steps/s
[Step=31650 Epoch=121.3] | Loss=0.00002 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.685 | L2-Norm(final)=10.878 | 4779.5 samples/s | 74.7 steps/s
[Step=31700 Epoch=121.5] | Loss=0.00002 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.680 | L2-Norm(final)=10.878 | 4831.7 samples/s | 75.5 steps/s
[Step=31750 Epoch=121.7] | Loss=0.00002 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=10.878 | 4762.5 samples/s | 74.4 steps/s
[Step=31800 Epoch=121.8] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.670 | L2-Norm(final)=10.879 | 6436.9 samples/s | 100.6 steps/s
[Step=31850 Epoch=122.0] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.664 | L2-Norm(final)=10.879 | 1832.4 samples/s | 28.6 steps/s
[Step=31900 Epoch=122.2] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.659 | L2-Norm(final)=10.879 | 4771.5 samples/s | 74.6 steps/s
[Step=31950 Epoch=122.4] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.653 | L2-Norm(final)=10.879 | 4733.8 samples/s | 74.0 steps/s
[Step=32000 Epoch=122.6] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.647 | L2-Norm(final)=10.880 | 4809.5 samples/s | 75.1 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07308 | acc=0.9692 | tpr=0.9781 | fpr=0.0500 | 4158.6 samples/s | 16.2 steps/s
Avg test loss: 0.07710, Avg test acc: 0.96831, Avg tpr: 0.97715, Avg fpr: 0.05115, total FA: 399

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06961 | acc=0.9672 | tpr=0.9728 | fpr=0.0451 | 4221.8 samples/s | 16.5 steps/s
Avg test loss: 0.07567, Avg test acc: 0.96558, Avg tpr: 0.97179, Avg fpr: 0.04807, total FA: 375

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.19831 | acc=0.3306 | tpr=0.0331 | fpr=0.0233 | 4203.5 samples/s | 16.4 steps/s
Avg test loss: 6.20321, Avg test acc: 0.32859, Avg tpr: 0.03252, Avg fpr: 0.02025, total FA: 158

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.61002 | acc=0.3324 | tpr=0.0416 | fpr=0.0362 | 4199.4 samples/s | 16.4 steps/s
Avg test loss: 5.61461, Avg test acc: 0.33088, Avg tpr: 0.04150, Avg fpr: 0.03269, total FA: 255

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.45783 | acc=0.0939 | tpr=0.9558 | fpr=0.9216 | 4243.9 samples/s | 16.6 steps/s
[Step= 100] | Loss=7.45630 | acc=0.0951 | tpr=0.9531 | fpr=0.9209 | 8093.7 samples/s | 31.6 steps/s
[Step= 150] | Loss=7.48232 | acc=0.0959 | tpr=0.9539 | fpr=0.9199 | 8480.0 samples/s | 33.1 steps/s
[Step= 200] | Loss=7.47686 | acc=0.0959 | tpr=0.9508 | fpr=0.9196 | 8563.3 samples/s | 33.5 steps/s
[Step= 250] | Loss=7.47400 | acc=0.0963 | tpr=0.9537 | fpr=0.9193 | 8480.3 samples/s | 33.1 steps/s
[Step= 300] | Loss=7.47692 | acc=0.0964 | tpr=0.9520 | fpr=0.9192 | 8415.8 samples/s | 32.9 steps/s
[Step= 350] | Loss=7.47784 | acc=0.0958 | tpr=0.9524 | fpr=0.9197 | 8120.4 samples/s | 31.7 steps/s
[Step= 400] | Loss=7.48024 | acc=0.0958 | tpr=0.9524 | fpr=0.9198 | 8380.3 samples/s | 32.7 steps/s
[Step= 450] | Loss=7.48353 | acc=0.0959 | tpr=0.9523 | fpr=0.9196 | 8486.5 samples/s | 33.2 steps/s
[Step= 500] | Loss=7.48371 | acc=0.0958 | tpr=0.9529 | fpr=0.9197 | 8213.5 samples/s | 32.1 steps/s
[Step= 550] | Loss=7.48187 | acc=0.0958 | tpr=0.9542 | fpr=0.9198 | 14837.4 samples/s | 58.0 steps/s
Avg test loss: 7.48257, Avg test acc: 0.09580, Avg tpr: 0.95444, Avg fpr: 0.91980, total FA: 127713

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.70647 | acc=0.1091 | tpr=0.9248 | fpr=0.9055 | 4245.2 samples/s | 16.6 steps/s
[Step= 100] | Loss=6.69663 | acc=0.1094 | tpr=0.9126 | fpr=0.9056 | 8211.2 samples/s | 32.1 steps/s
[Step= 150] | Loss=6.72493 | acc=0.1096 | tpr=0.9121 | fpr=0.9051 | 8275.6 samples/s | 32.3 steps/s
[Step= 200] | Loss=6.72540 | acc=0.1100 | tpr=0.9093 | fpr=0.9046 | 8325.8 samples/s | 32.5 steps/s
[Step= 250] | Loss=6.72437 | acc=0.1104 | tpr=0.9118 | fpr=0.9042 | 8387.5 samples/s | 32.8 steps/s
[Step= 300] | Loss=6.72678 | acc=0.1104 | tpr=0.9091 | fpr=0.9041 | 8415.2 samples/s | 32.9 steps/s
[Step= 350] | Loss=6.72878 | acc=0.1097 | tpr=0.9067 | fpr=0.9047 | 7933.9 samples/s | 31.0 steps/s
[Step= 400] | Loss=6.73114 | acc=0.1098 | tpr=0.9065 | fpr=0.9047 | 8658.0 samples/s | 33.8 steps/s
[Step= 450] | Loss=6.73432 | acc=0.1098 | tpr=0.9070 | fpr=0.9047 | 8127.5 samples/s | 31.7 steps/s
[Step= 500] | Loss=6.73303 | acc=0.1099 | tpr=0.9101 | fpr=0.9045 | 8148.7 samples/s | 31.8 steps/s
[Step= 550] | Loss=6.73416 | acc=0.1100 | tpr=0.9109 | fpr=0.9046 | 14737.7 samples/s | 57.6 steps/s
Avg test loss: 6.73494, Avg test acc: 0.10995, Avg tpr: 0.91086, Avg fpr: 0.90461, total FA: 125603

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12905 | acc=0.9812 | tpr=0.9469 | fpr=0.0182 | 4168.6 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.13502 | acc=0.9804 | tpr=0.9488 | fpr=0.0190 | 7803.0 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.14080 | acc=0.9793 | tpr=0.9553 | fpr=0.0202 | 8414.2 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.14197 | acc=0.9792 | tpr=0.9585 | fpr=0.0204 | 8536.0 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.14011 | acc=0.9791 | tpr=0.9555 | fpr=0.0204 | 8040.1 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.14417 | acc=0.9787 | tpr=0.9527 | fpr=0.0208 | 8301.5 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.14478 | acc=0.9787 | tpr=0.9518 | fpr=0.0208 | 8347.8 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.14596 | acc=0.9785 | tpr=0.9502 | fpr=0.0210 | 8443.1 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.14878 | acc=0.9782 | tpr=0.9489 | fpr=0.0212 | 8151.1 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.14798 | acc=0.9783 | tpr=0.9489 | fpr=0.0211 | 8123.2 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.14669 | acc=0.9785 | tpr=0.9475 | fpr=0.0210 | 14985.5 samples/s | 58.5 steps/s
Avg test loss: 0.14651, Avg test acc: 0.97848, Avg tpr: 0.94731, Avg fpr: 0.02096, total FA: 2910

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13865 | acc=0.9796 | tpr=0.9558 | fpr=0.0200 | 4149.3 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.14420 | acc=0.9789 | tpr=0.9574 | fpr=0.0207 | 8746.7 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.15057 | acc=0.9780 | tpr=0.9625 | fpr=0.0217 | 7966.1 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.15234 | acc=0.9778 | tpr=0.9661 | fpr=0.0220 | 8478.6 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.15026 | acc=0.9776 | tpr=0.9624 | fpr=0.0221 | 8230.9 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.15429 | acc=0.9773 | tpr=0.9615 | fpr=0.0224 | 8175.9 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.15506 | acc=0.9773 | tpr=0.9618 | fpr=0.0225 | 8351.3 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.15596 | acc=0.9771 | tpr=0.9595 | fpr=0.0226 | 8444.3 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.15871 | acc=0.9769 | tpr=0.9591 | fpr=0.0228 | 8155.0 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.15808 | acc=0.9769 | tpr=0.9604 | fpr=0.0228 | 8142.3 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.15641 | acc=0.9771 | tpr=0.9590 | fpr=0.0226 | 15436.1 samples/s | 60.3 steps/s
Avg test loss: 0.15619, Avg test acc: 0.97711, Avg tpr: 0.95880, Avg fpr: 0.02256, total FA: 3132

server round 31/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=28001 Epoch=54.7] | Loss=0.00906 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.773 | L2-Norm(final)=10.356 | 4093.2 samples/s | 64.0 steps/s
[Step=28050 Epoch=54.8] | Loss=0.00867 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.774 | L2-Norm(final)=10.357 | 5081.6 samples/s | 79.4 steps/s
[Step=28100 Epoch=54.9] | Loss=0.00937 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.774 | L2-Norm(final)=10.359 | 5761.6 samples/s | 90.0 steps/s
[Step=28150 Epoch=55.0] | Loss=0.00915 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.774 | L2-Norm(final)=10.361 | 5864.5 samples/s | 91.6 steps/s
[Step=28200 Epoch=55.1] | Loss=0.00903 | Reg=0.00163 | acc=0.9688 | L2-Norm=12.774 | L2-Norm(final)=10.363 | 5954.9 samples/s | 93.0 steps/s
[Step=28250 Epoch=55.2] | Loss=0.00887 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.774 | L2-Norm(final)=10.365 | 5656.5 samples/s | 88.4 steps/s
[Step=28300 Epoch=55.3] | Loss=0.00914 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.774 | L2-Norm(final)=10.367 | 5756.4 samples/s | 89.9 steps/s
[Step=28350 Epoch=55.4] | Loss=0.00912 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.774 | L2-Norm(final)=10.369 | 5769.6 samples/s | 90.1 steps/s
[Step=28400 Epoch=55.5] | Loss=0.00899 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.774 | L2-Norm(final)=10.372 | 5758.6 samples/s | 90.0 steps/s
[Step=28450 Epoch=55.6] | Loss=0.00887 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.774 | L2-Norm(final)=10.375 | 5826.3 samples/s | 91.0 steps/s
[Step=28500 Epoch=55.7] | Loss=0.00881 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.774 | L2-Norm(final)=10.378 | 7488.7 samples/s | 117.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=28501 Epoch=55.7] | Loss=0.02632 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.774 | L2-Norm(final)=10.405 | 3766.7 samples/s | 58.9 steps/s
[Step=28550 Epoch=55.8] | Loss=0.00849 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.781 | L2-Norm(final)=10.407 | 4975.0 samples/s | 77.7 steps/s
[Step=28600 Epoch=55.9] | Loss=0.00859 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.785 | L2-Norm(final)=10.408 | 4938.7 samples/s | 77.2 steps/s
[Step=28650 Epoch=56.0] | Loss=0.00850 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.789 | L2-Norm(final)=10.410 | 5036.8 samples/s | 78.7 steps/s
[Step=28700 Epoch=56.1] | Loss=0.00815 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.793 | L2-Norm(final)=10.412 | 5078.9 samples/s | 79.4 steps/s
[Step=28750 Epoch=56.2] | Loss=0.00792 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.796 | L2-Norm(final)=10.414 | 4980.2 samples/s | 77.8 steps/s
[Step=28800 Epoch=56.3] | Loss=0.00799 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.799 | L2-Norm(final)=10.416 | 5039.0 samples/s | 78.7 steps/s
[Step=28850 Epoch=56.4] | Loss=0.00793 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.802 | L2-Norm(final)=10.417 | 4962.0 samples/s | 77.5 steps/s
[Step=28900 Epoch=56.5] | Loss=0.00811 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.806 | L2-Norm(final)=10.419 | 5059.5 samples/s | 79.1 steps/s
[Step=28950 Epoch=56.6] | Loss=0.00808 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.808 | L2-Norm(final)=10.420 | 5033.5 samples/s | 78.6 steps/s
[Step=29000 Epoch=56.7] | Loss=0.00832 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.811 | L2-Norm(final)=10.421 | 6156.5 samples/s | 96.2 steps/s
[Step=29050 Epoch=56.8] | Loss=0.00817 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.813 | L2-Norm(final)=10.422 | 1942.2 samples/s | 30.3 steps/s
[Step=29100 Epoch=56.9] | Loss=0.00796 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.816 | L2-Norm(final)=10.423 | 4999.9 samples/s | 78.1 steps/s
[Step=29150 Epoch=57.0] | Loss=0.00775 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.818 | L2-Norm(final)=10.425 | 4991.3 samples/s | 78.0 steps/s
[Step=29200 Epoch=57.1] | Loss=0.00769 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.820 | L2-Norm(final)=10.426 | 4947.9 samples/s | 77.3 steps/s
[Step=29250 Epoch=57.2] | Loss=0.00751 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.822 | L2-Norm(final)=10.427 | 5022.1 samples/s | 78.5 steps/s
[Step=29300 Epoch=57.3] | Loss=0.00747 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.823 | L2-Norm(final)=10.429 | 5048.9 samples/s | 78.9 steps/s
[Step=29350 Epoch=57.4] | Loss=0.00730 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.825 | L2-Norm(final)=10.430 | 4998.7 samples/s | 78.1 steps/s
[Step=29400 Epoch=57.5] | Loss=0.00722 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.827 | L2-Norm(final)=10.432 | 5012.0 samples/s | 78.3 steps/s
[Step=29450 Epoch=57.6] | Loss=0.00724 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.829 | L2-Norm(final)=10.433 | 5022.8 samples/s | 78.5 steps/s
[Step=29500 Epoch=57.7] | Loss=0.00729 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.831 | L2-Norm(final)=10.435 | 5461.8 samples/s | 85.3 steps/s
[Step=29550 Epoch=57.8] | Loss=0.00724 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.832 | L2-Norm(final)=10.436 | 2049.1 samples/s | 32.0 steps/s
[Step=29600 Epoch=57.9] | Loss=0.00722 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.834 | L2-Norm(final)=10.437 | 5048.8 samples/s | 78.9 steps/s
[Step=29650 Epoch=58.0] | Loss=0.00708 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.836 | L2-Norm(final)=10.439 | 4952.5 samples/s | 77.4 steps/s
[Step=29700 Epoch=58.1] | Loss=0.00701 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.837 | L2-Norm(final)=10.440 | 5119.0 samples/s | 80.0 steps/s
[Step=29750 Epoch=58.2] | Loss=0.00694 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.839 | L2-Norm(final)=10.442 | 5099.3 samples/s | 79.7 steps/s
[Step=29800 Epoch=58.3] | Loss=0.00688 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.840 | L2-Norm(final)=10.443 | 5072.4 samples/s | 79.3 steps/s
[Step=29850 Epoch=58.4] | Loss=0.00682 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.842 | L2-Norm(final)=10.444 | 4961.6 samples/s | 77.5 steps/s
[Step=29900 Epoch=58.5] | Loss=0.00681 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.843 | L2-Norm(final)=10.446 | 5052.8 samples/s | 78.9 steps/s
[Step=29950 Epoch=58.6] | Loss=0.00680 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.845 | L2-Norm(final)=10.447 | 5000.3 samples/s | 78.1 steps/s
[Step=30000 Epoch=58.6] | Loss=0.00674 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.846 | L2-Norm(final)=10.448 | 4967.4 samples/s | 77.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step30000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=32001 Epoch=122.6] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=10.888 | 3761.6 samples/s | 58.8 steps/s
[Step=32050 Epoch=122.8] | Loss=0.00012 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.771 | L2-Norm(final)=10.894 | 4895.1 samples/s | 76.5 steps/s
[Step=32100 Epoch=123.0] | Loss=0.00011 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.771 | L2-Norm(final)=10.900 | 5209.5 samples/s | 81.4 steps/s
[Step=32150 Epoch=123.2] | Loss=0.00011 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.771 | L2-Norm(final)=10.906 | 5541.3 samples/s | 86.6 steps/s
[Step=32200 Epoch=123.4] | Loss=0.00012 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.771 | L2-Norm(final)=10.911 | 5452.9 samples/s | 85.2 steps/s
[Step=32250 Epoch=123.6] | Loss=0.00014 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.771 | L2-Norm(final)=10.917 | 7094.2 samples/s | 110.8 steps/s
[Step=32300 Epoch=123.8] | Loss=0.00015 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.771 | L2-Norm(final)=10.923 | 1979.8 samples/s | 30.9 steps/s
[Step=32350 Epoch=124.0] | Loss=0.00014 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.771 | L2-Norm(final)=10.929 | 5548.4 samples/s | 86.7 steps/s
[Step=32400 Epoch=124.1] | Loss=0.00015 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.771 | L2-Norm(final)=10.934 | 5351.2 samples/s | 83.6 steps/s
[Step=32450 Epoch=124.3] | Loss=0.00014 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.771 | L2-Norm(final)=10.939 | 5362.8 samples/s | 83.8 steps/s
[Step=32500 Epoch=124.5] | Loss=0.00014 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.771 | L2-Norm(final)=10.944 | 6188.2 samples/s | 96.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=124.5] | Loss=0.00002 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.771 | L2-Norm(final)=10.993 | 3825.0 samples/s | 59.8 steps/s
[Step=32550 Epoch=124.7] | Loss=0.00004 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.764 | L2-Norm(final)=10.995 | 4838.8 samples/s | 75.6 steps/s
[Step=32600 Epoch=124.9] | Loss=0.00003 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.756 | L2-Norm(final)=10.997 | 4809.1 samples/s | 75.1 steps/s
[Step=32650 Epoch=125.1] | Loss=0.00002 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.747 | L2-Norm(final)=10.998 | 4800.8 samples/s | 75.0 steps/s
[Step=32700 Epoch=125.3] | Loss=0.00002 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.737 | L2-Norm(final)=10.999 | 4731.9 samples/s | 73.9 steps/s
[Step=32750 Epoch=125.5] | Loss=0.00002 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.726 | L2-Norm(final)=11.000 | 5978.0 samples/s | 93.4 steps/s
[Step=32800 Epoch=125.7] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.716 | L2-Norm(final)=11.001 | 1866.8 samples/s | 29.2 steps/s
[Step=32850 Epoch=125.9] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.705 | L2-Norm(final)=11.001 | 4823.5 samples/s | 75.4 steps/s
[Step=32900 Epoch=126.1] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.694 | L2-Norm(final)=11.002 | 4705.9 samples/s | 73.5 steps/s
[Step=32950 Epoch=126.3] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.684 | L2-Norm(final)=11.002 | 4769.3 samples/s | 74.5 steps/s
[Step=33000 Epoch=126.4] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=11.002 | 5267.9 samples/s | 82.3 steps/s
[Step=33050 Epoch=126.6] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.662 | L2-Norm(final)=11.003 | 1978.5 samples/s | 30.9 steps/s
[Step=33100 Epoch=126.8] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.651 | L2-Norm(final)=11.003 | 4800.9 samples/s | 75.0 steps/s
[Step=33150 Epoch=127.0] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.640 | L2-Norm(final)=11.003 | 4758.4 samples/s | 74.4 steps/s
[Step=33200 Epoch=127.2] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.629 | L2-Norm(final)=11.004 | 4845.8 samples/s | 75.7 steps/s
[Step=33250 Epoch=127.4] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.618 | L2-Norm(final)=11.004 | 4819.7 samples/s | 75.3 steps/s
[Step=33300 Epoch=127.6] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.607 | L2-Norm(final)=11.004 | 2048.8 samples/s | 32.0 steps/s
[Step=33350 Epoch=127.8] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.595 | L2-Norm(final)=11.005 | 4758.5 samples/s | 74.4 steps/s
[Step=33400 Epoch=128.0] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.584 | L2-Norm(final)=11.005 | 4776.7 samples/s | 74.6 steps/s
[Step=33450 Epoch=128.2] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.573 | L2-Norm(final)=11.005 | 4843.1 samples/s | 75.7 steps/s
[Step=33500 Epoch=128.4] | Loss=0.00000 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.561 | L2-Norm(final)=11.006 | 4749.7 samples/s | 74.2 steps/s
[Step=33550 Epoch=128.6] | Loss=0.00000 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=11.006 | 2083.9 samples/s | 32.6 steps/s
[Step=33600 Epoch=128.7] | Loss=0.00000 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.538 | L2-Norm(final)=11.006 | 4642.4 samples/s | 72.5 steps/s
[Step=33650 Epoch=128.9] | Loss=0.00000 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.526 | L2-Norm(final)=11.007 | 4828.1 samples/s | 75.4 steps/s
[Step=33700 Epoch=129.1] | Loss=0.00000 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.515 | L2-Norm(final)=11.007 | 4654.7 samples/s | 72.7 steps/s
[Step=33750 Epoch=129.3] | Loss=0.00000 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.503 | L2-Norm(final)=11.008 | 4768.8 samples/s | 74.5 steps/s
[Step=33800 Epoch=129.5] | Loss=0.00000 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.491 | L2-Norm(final)=11.008 | 6569.7 samples/s | 102.7 steps/s
[Step=33850 Epoch=129.7] | Loss=0.00000 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=11.008 | 1839.9 samples/s | 28.7 steps/s
[Step=33900 Epoch=129.9] | Loss=0.00000 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.467 | L2-Norm(final)=11.009 | 4702.4 samples/s | 73.5 steps/s
[Step=33950 Epoch=130.1] | Loss=0.00000 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=11.009 | 4799.0 samples/s | 75.0 steps/s
[Step=34000 Epoch=130.3] | Loss=0.00000 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.442 | L2-Norm(final)=11.009 | 4761.1 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step34000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07308 | acc=0.9692 | tpr=0.9781 | fpr=0.0500 | 4206.9 samples/s | 16.4 steps/s
Avg test loss: 0.07710, Avg test acc: 0.96831, Avg tpr: 0.97715, Avg fpr: 0.05115, total FA: 399

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07669 | acc=0.9695 | tpr=0.9782 | fpr=0.0493 | 4186.7 samples/s | 16.4 steps/s
Avg test loss: 0.08202, Avg test acc: 0.96855, Avg tpr: 0.97744, Avg fpr: 0.05102, total FA: 398

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.20848 | acc=0.3303 | tpr=0.0342 | fpr=0.0268 | 4192.3 samples/s | 16.4 steps/s
Avg test loss: 6.21382, Avg test acc: 0.32831, Avg tpr: 0.03392, Avg fpr: 0.02423, total FA: 189

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.61002 | acc=0.3324 | tpr=0.0416 | fpr=0.0362 | 4233.1 samples/s | 16.5 steps/s
Avg test loss: 5.61461, Avg test acc: 0.33088, Avg tpr: 0.04150, Avg fpr: 0.03269, total FA: 255

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.45783 | acc=0.0939 | tpr=0.9558 | fpr=0.9216 | 4209.8 samples/s | 16.4 steps/s
[Step= 100] | Loss=7.45630 | acc=0.0951 | tpr=0.9531 | fpr=0.9209 | 8368.3 samples/s | 32.7 steps/s
[Step= 150] | Loss=7.48232 | acc=0.0959 | tpr=0.9539 | fpr=0.9199 | 8035.4 samples/s | 31.4 steps/s
[Step= 200] | Loss=7.47686 | acc=0.0959 | tpr=0.9508 | fpr=0.9196 | 8463.6 samples/s | 33.1 steps/s
[Step= 250] | Loss=7.47400 | acc=0.0963 | tpr=0.9537 | fpr=0.9193 | 8577.8 samples/s | 33.5 steps/s
[Step= 300] | Loss=7.47692 | acc=0.0964 | tpr=0.9520 | fpr=0.9192 | 8691.0 samples/s | 33.9 steps/s
[Step= 350] | Loss=7.47784 | acc=0.0958 | tpr=0.9524 | fpr=0.9197 | 7857.1 samples/s | 30.7 steps/s
[Step= 400] | Loss=7.48024 | acc=0.0958 | tpr=0.9524 | fpr=0.9198 | 8210.8 samples/s | 32.1 steps/s
[Step= 450] | Loss=7.48353 | acc=0.0959 | tpr=0.9523 | fpr=0.9196 | 8411.1 samples/s | 32.9 steps/s
[Step= 500] | Loss=7.48371 | acc=0.0958 | tpr=0.9529 | fpr=0.9197 | 8085.1 samples/s | 31.6 steps/s
[Step= 550] | Loss=7.48187 | acc=0.0958 | tpr=0.9542 | fpr=0.9198 | 15793.5 samples/s | 61.7 steps/s
Avg test loss: 7.48257, Avg test acc: 0.09580, Avg tpr: 0.95444, Avg fpr: 0.91980, total FA: 127713

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.48422 | acc=0.0969 | tpr=0.9513 | fpr=0.9185 | 4137.6 samples/s | 16.2 steps/s
[Step= 100] | Loss=7.47392 | acc=0.0981 | tpr=0.9382 | fpr=0.9176 | 8275.3 samples/s | 32.3 steps/s
[Step= 150] | Loss=7.50282 | acc=0.0982 | tpr=0.9352 | fpr=0.9173 | 8252.2 samples/s | 32.2 steps/s
[Step= 200] | Loss=7.49501 | acc=0.0980 | tpr=0.9355 | fpr=0.9172 | 8465.3 samples/s | 33.1 steps/s
[Step= 250] | Loss=7.49375 | acc=0.0985 | tpr=0.9354 | fpr=0.9167 | 8248.0 samples/s | 32.2 steps/s
[Step= 300] | Loss=7.49828 | acc=0.0983 | tpr=0.9331 | fpr=0.9169 | 8407.1 samples/s | 32.8 steps/s
[Step= 350] | Loss=7.50138 | acc=0.0978 | tpr=0.9336 | fpr=0.9173 | 8274.7 samples/s | 32.3 steps/s
[Step= 400] | Loss=7.50390 | acc=0.0977 | tpr=0.9327 | fpr=0.9175 | 8016.4 samples/s | 31.3 steps/s
[Step= 450] | Loss=7.50828 | acc=0.0977 | tpr=0.9323 | fpr=0.9175 | 9029.4 samples/s | 35.3 steps/s
[Step= 500] | Loss=7.50762 | acc=0.0978 | tpr=0.9339 | fpr=0.9173 | 7890.2 samples/s | 30.8 steps/s
[Step= 550] | Loss=7.50634 | acc=0.0979 | tpr=0.9359 | fpr=0.9173 | 14609.0 samples/s | 57.1 steps/s
Avg test loss: 7.50681, Avg test acc: 0.09790, Avg tpr: 0.93621, Avg fpr: 0.91734, total FA: 127371

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11660 | acc=0.9820 | tpr=0.9469 | fpr=0.0173 | 4261.5 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.12207 | acc=0.9811 | tpr=0.9424 | fpr=0.0181 | 8050.6 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.12712 | acc=0.9801 | tpr=0.9496 | fpr=0.0194 | 8265.4 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.12819 | acc=0.9800 | tpr=0.9530 | fpr=0.0195 | 8012.9 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.12663 | acc=0.9799 | tpr=0.9520 | fpr=0.0196 | 8460.2 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.13043 | acc=0.9795 | tpr=0.9505 | fpr=0.0199 | 8280.5 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.13084 | acc=0.9796 | tpr=0.9499 | fpr=0.0199 | 8334.8 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.13190 | acc=0.9793 | tpr=0.9480 | fpr=0.0201 | 8156.9 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.13440 | acc=0.9790 | tpr=0.9474 | fpr=0.0204 | 8364.0 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.13364 | acc=0.9791 | tpr=0.9476 | fpr=0.0203 | 8340.4 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.13238 | acc=0.9793 | tpr=0.9471 | fpr=0.0202 | 14918.3 samples/s | 58.3 steps/s
Avg test loss: 0.13221, Avg test acc: 0.97927, Avg tpr: 0.94691, Avg fpr: 0.02014, total FA: 2797

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13865 | acc=0.9796 | tpr=0.9558 | fpr=0.0200 | 4161.3 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.14420 | acc=0.9789 | tpr=0.9574 | fpr=0.0207 | 8138.8 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.15057 | acc=0.9780 | tpr=0.9625 | fpr=0.0217 | 8620.5 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.15234 | acc=0.9778 | tpr=0.9661 | fpr=0.0220 | 7763.2 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.15026 | acc=0.9776 | tpr=0.9624 | fpr=0.0221 | 8111.0 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.15429 | acc=0.9773 | tpr=0.9615 | fpr=0.0224 | 7736.7 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.15506 | acc=0.9773 | tpr=0.9618 | fpr=0.0225 | 7535.7 samples/s | 29.4 steps/s
[Step= 400] | Loss=0.15596 | acc=0.9771 | tpr=0.9595 | fpr=0.0226 | 7458.7 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.15871 | acc=0.9769 | tpr=0.9591 | fpr=0.0228 | 7951.8 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.15808 | acc=0.9769 | tpr=0.9604 | fpr=0.0228 | 8135.1 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.15641 | acc=0.9771 | tpr=0.9590 | fpr=0.0226 | 15530.0 samples/s | 60.7 steps/s
Avg test loss: 0.15619, Avg test acc: 0.97711, Avg tpr: 0.95880, Avg fpr: 0.02256, total FA: 3132

server round 32/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=38001 Epoch=74.1] | Loss=0.01062 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.530 | L2-Norm(final)=10.887 | 3614.3 samples/s | 56.5 steps/s
[Step=38050 Epoch=74.2] | Loss=0.00917 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=10.887 | 5443.2 samples/s | 85.1 steps/s
[Step=38100 Epoch=74.3] | Loss=0.00959 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.530 | L2-Norm(final)=10.886 | 5892.6 samples/s | 92.1 steps/s
[Step=38150 Epoch=74.4] | Loss=0.00969 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=10.886 | 5782.3 samples/s | 90.3 steps/s
[Step=38200 Epoch=74.5] | Loss=0.01005 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=10.885 | 5948.7 samples/s | 92.9 steps/s
[Step=38250 Epoch=74.6] | Loss=0.00961 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=10.884 | 5722.7 samples/s | 89.4 steps/s
[Step=38300 Epoch=74.7] | Loss=0.00959 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=10.884 | 5805.6 samples/s | 90.7 steps/s
[Step=38350 Epoch=74.8] | Loss=0.00957 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.530 | L2-Norm(final)=10.885 | 5816.0 samples/s | 90.9 steps/s
[Step=38400 Epoch=74.9] | Loss=0.00954 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=10.885 | 5802.3 samples/s | 90.7 steps/s
[Step=38450 Epoch=75.0] | Loss=0.00929 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.530 | L2-Norm(final)=10.885 | 5776.2 samples/s | 90.3 steps/s
[Step=38500 Epoch=75.1] | Loss=0.00932 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=10.886 | 7356.0 samples/s | 114.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=75.1] | Loss=0.00138 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=10.892 | 3765.6 samples/s | 58.8 steps/s
[Step=38550 Epoch=75.2] | Loss=0.00707 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=10.893 | 4832.5 samples/s | 75.5 steps/s
[Step=38600 Epoch=75.3] | Loss=0.00845 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.544 | L2-Norm(final)=10.894 | 4984.6 samples/s | 77.9 steps/s
[Step=38650 Epoch=75.4] | Loss=0.00822 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=10.895 | 4986.7 samples/s | 77.9 steps/s
[Step=38700 Epoch=75.5] | Loss=0.00860 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.554 | L2-Norm(final)=10.896 | 5009.7 samples/s | 78.3 steps/s
[Step=38750 Epoch=75.6] | Loss=0.00904 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.557 | L2-Norm(final)=10.897 | 5027.2 samples/s | 78.6 steps/s
[Step=38800 Epoch=75.7] | Loss=0.00899 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.561 | L2-Norm(final)=10.898 | 5078.3 samples/s | 79.3 steps/s
[Step=38850 Epoch=75.8] | Loss=0.00921 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.564 | L2-Norm(final)=10.899 | 4948.5 samples/s | 77.3 steps/s
[Step=38900 Epoch=75.9] | Loss=0.00909 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.567 | L2-Norm(final)=10.900 | 5018.8 samples/s | 78.4 steps/s
[Step=38950 Epoch=76.0] | Loss=0.00906 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.569 | L2-Norm(final)=10.901 | 5023.5 samples/s | 78.5 steps/s
[Step=39000 Epoch=76.1] | Loss=0.00893 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.572 | L2-Norm(final)=10.902 | 6153.1 samples/s | 96.1 steps/s
[Step=39050 Epoch=76.2] | Loss=0.00865 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.575 | L2-Norm(final)=10.903 | 1877.1 samples/s | 29.3 steps/s
[Step=39100 Epoch=76.3] | Loss=0.00842 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.577 | L2-Norm(final)=10.904 | 5018.8 samples/s | 78.4 steps/s
[Step=39150 Epoch=76.4] | Loss=0.00819 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.579 | L2-Norm(final)=10.906 | 5019.8 samples/s | 78.4 steps/s
[Step=39200 Epoch=76.5] | Loss=0.00802 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.582 | L2-Norm(final)=10.907 | 4974.0 samples/s | 77.7 steps/s
[Step=39250 Epoch=76.6] | Loss=0.00783 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.584 | L2-Norm(final)=10.908 | 5079.4 samples/s | 79.4 steps/s
[Step=39300 Epoch=76.7] | Loss=0.00771 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.585 | L2-Norm(final)=10.910 | 4931.9 samples/s | 77.1 steps/s
[Step=39350 Epoch=76.7] | Loss=0.00772 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.587 | L2-Norm(final)=10.911 | 5072.3 samples/s | 79.3 steps/s
[Step=39400 Epoch=76.8] | Loss=0.00769 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.589 | L2-Norm(final)=10.912 | 4971.0 samples/s | 77.7 steps/s
[Step=39450 Epoch=76.9] | Loss=0.00765 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.591 | L2-Norm(final)=10.914 | 4989.9 samples/s | 78.0 steps/s
[Step=39500 Epoch=77.0] | Loss=0.00770 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.593 | L2-Norm(final)=10.915 | 5350.8 samples/s | 83.6 steps/s
[Step=39550 Epoch=77.1] | Loss=0.00761 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.595 | L2-Norm(final)=10.916 | 1969.5 samples/s | 30.8 steps/s
[Step=39600 Epoch=77.2] | Loss=0.00754 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.596 | L2-Norm(final)=10.917 | 5101.1 samples/s | 79.7 steps/s
[Step=39650 Epoch=77.3] | Loss=0.00742 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.598 | L2-Norm(final)=10.918 | 4943.0 samples/s | 77.2 steps/s
[Step=39700 Epoch=77.4] | Loss=0.00733 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.600 | L2-Norm(final)=10.919 | 5064.8 samples/s | 79.1 steps/s
[Step=39750 Epoch=77.5] | Loss=0.00726 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.602 | L2-Norm(final)=10.920 | 5001.5 samples/s | 78.1 steps/s
[Step=39800 Epoch=77.6] | Loss=0.00722 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.603 | L2-Norm(final)=10.922 | 5010.2 samples/s | 78.3 steps/s
[Step=39850 Epoch=77.7] | Loss=0.00719 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.605 | L2-Norm(final)=10.923 | 5035.7 samples/s | 78.7 steps/s
[Step=39900 Epoch=77.8] | Loss=0.00713 | Reg=0.00159 | acc=0.9688 | L2-Norm=12.607 | L2-Norm(final)=10.924 | 4981.1 samples/s | 77.8 steps/s
[Step=39950 Epoch=77.9] | Loss=0.00712 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.608 | L2-Norm(final)=10.925 | 5039.6 samples/s | 78.7 steps/s
[Step=40000 Epoch=78.0] | Loss=0.00710 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.610 | L2-Norm(final)=10.926 | 5113.7 samples/s | 79.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step40000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=30001 Epoch=58.7] | Loss=0.01022 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.530 | L2-Norm(final)=10.486 | 3975.6 samples/s | 62.1 steps/s
[Step=30050 Epoch=58.7] | Loss=0.00748 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.530 | L2-Norm(final)=10.489 | 5511.8 samples/s | 86.1 steps/s
[Step=30100 Epoch=58.8] | Loss=0.00797 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=10.492 | 5758.6 samples/s | 90.0 steps/s
[Step=30150 Epoch=58.9] | Loss=0.00780 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=10.495 | 5799.1 samples/s | 90.6 steps/s
[Step=30200 Epoch=59.0] | Loss=0.00826 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=10.499 | 5722.4 samples/s | 89.4 steps/s
[Step=30250 Epoch=59.1] | Loss=0.00818 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=10.502 | 5954.8 samples/s | 93.0 steps/s
[Step=30300 Epoch=59.2] | Loss=0.00824 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.530 | L2-Norm(final)=10.505 | 5665.9 samples/s | 88.5 steps/s
[Step=30350 Epoch=59.3] | Loss=0.00828 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.530 | L2-Norm(final)=10.508 | 5723.1 samples/s | 89.4 steps/s
[Step=30400 Epoch=59.4] | Loss=0.00834 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=10.511 | 5769.9 samples/s | 90.2 steps/s
[Step=30450 Epoch=59.5] | Loss=0.00821 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=10.514 | 5952.7 samples/s | 93.0 steps/s
[Step=30500 Epoch=59.6] | Loss=0.00824 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=10.517 | 7321.3 samples/s | 114.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=59.6] | Loss=0.00910 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.530 | L2-Norm(final)=10.550 | 3864.1 samples/s | 60.4 steps/s
[Step=30550 Epoch=59.7] | Loss=0.00851 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=10.553 | 4993.5 samples/s | 78.0 steps/s
[Step=30600 Epoch=59.8] | Loss=0.00961 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.543 | L2-Norm(final)=10.555 | 5018.5 samples/s | 78.4 steps/s
[Step=30650 Epoch=59.9] | Loss=0.00969 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=10.556 | 5013.6 samples/s | 78.3 steps/s
[Step=30700 Epoch=60.0] | Loss=0.00918 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.554 | L2-Norm(final)=10.558 | 4940.0 samples/s | 77.2 steps/s
[Step=30750 Epoch=60.1] | Loss=0.00953 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.558 | L2-Norm(final)=10.560 | 5009.0 samples/s | 78.3 steps/s
[Step=30800 Epoch=60.2] | Loss=0.00963 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.563 | L2-Norm(final)=10.561 | 5117.6 samples/s | 80.0 steps/s
[Step=30850 Epoch=60.3] | Loss=0.00922 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.567 | L2-Norm(final)=10.563 | 4978.6 samples/s | 77.8 steps/s
[Step=30900 Epoch=60.4] | Loss=0.00918 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.570 | L2-Norm(final)=10.565 | 5029.3 samples/s | 78.6 steps/s
[Step=30950 Epoch=60.5] | Loss=0.00887 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.573 | L2-Norm(final)=10.567 | 5080.8 samples/s | 79.4 steps/s
[Step=31000 Epoch=60.6] | Loss=0.00865 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.577 | L2-Norm(final)=10.569 | 6141.0 samples/s | 96.0 steps/s
[Step=31050 Epoch=60.7] | Loss=0.00844 | Reg=0.00158 | acc=0.9688 | L2-Norm=12.579 | L2-Norm(final)=10.571 | 1941.1 samples/s | 30.3 steps/s
[Step=31100 Epoch=60.8] | Loss=0.00825 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.582 | L2-Norm(final)=10.573 | 4933.2 samples/s | 77.1 steps/s
[Step=31150 Epoch=60.9] | Loss=0.00816 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.585 | L2-Norm(final)=10.575 | 5006.0 samples/s | 78.2 steps/s
[Step=31200 Epoch=61.0] | Loss=0.00814 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.587 | L2-Norm(final)=10.576 | 5045.7 samples/s | 78.8 steps/s
[Step=31250 Epoch=61.1] | Loss=0.00799 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.590 | L2-Norm(final)=10.578 | 5007.2 samples/s | 78.2 steps/s
[Step=31300 Epoch=61.2] | Loss=0.00788 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.592 | L2-Norm(final)=10.580 | 5008.9 samples/s | 78.3 steps/s
[Step=31350 Epoch=61.3] | Loss=0.00769 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.594 | L2-Norm(final)=10.582 | 5002.5 samples/s | 78.2 steps/s
[Step=31400 Epoch=61.4] | Loss=0.00752 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.596 | L2-Norm(final)=10.584 | 5057.6 samples/s | 79.0 steps/s
[Step=31450 Epoch=61.5] | Loss=0.00735 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.598 | L2-Norm(final)=10.586 | 5008.6 samples/s | 78.3 steps/s
[Step=31500 Epoch=61.6] | Loss=0.00738 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.600 | L2-Norm(final)=10.588 | 5445.7 samples/s | 85.1 steps/s
[Step=31550 Epoch=61.7] | Loss=0.00734 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.603 | L2-Norm(final)=10.589 | 2016.8 samples/s | 31.5 steps/s
[Step=31600 Epoch=61.8] | Loss=0.00724 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.605 | L2-Norm(final)=10.591 | 5050.4 samples/s | 78.9 steps/s
[Step=31650 Epoch=61.9] | Loss=0.00719 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.607 | L2-Norm(final)=10.593 | 4974.2 samples/s | 77.7 steps/s
[Step=31700 Epoch=62.0] | Loss=0.00715 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.609 | L2-Norm(final)=10.595 | 4956.6 samples/s | 77.4 steps/s
[Step=31750 Epoch=62.1] | Loss=0.00702 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.611 | L2-Norm(final)=10.596 | 5032.5 samples/s | 78.6 steps/s
[Step=31800 Epoch=62.2] | Loss=0.00704 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.613 | L2-Norm(final)=10.598 | 5040.6 samples/s | 78.8 steps/s
[Step=31850 Epoch=62.3] | Loss=0.00694 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.614 | L2-Norm(final)=10.600 | 5072.0 samples/s | 79.2 steps/s
[Step=31900 Epoch=62.4] | Loss=0.00690 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.616 | L2-Norm(final)=10.601 | 4992.1 samples/s | 78.0 steps/s
[Step=31950 Epoch=62.5] | Loss=0.00683 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.618 | L2-Norm(final)=10.603 | 4925.7 samples/s | 77.0 steps/s
[Step=32000 Epoch=62.6] | Loss=0.00682 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.620 | L2-Norm(final)=10.605 | 5081.6 samples/s | 79.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07155 | acc=0.9701 | tpr=0.9789 | fpr=0.0491 | 4194.5 samples/s | 16.4 steps/s
Avg test loss: 0.07611, Avg test acc: 0.96895, Avg tpr: 0.97768, Avg fpr: 0.05025, total FA: 392

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07342 | acc=0.9688 | tpr=0.9744 | fpr=0.0436 | 4229.4 samples/s | 16.5 steps/s
Avg test loss: 0.07943, Avg test acc: 0.96775, Avg tpr: 0.97348, Avg fpr: 0.04487, total FA: 350

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.20848 | acc=0.3303 | tpr=0.0342 | fpr=0.0268 | 4194.0 samples/s | 16.4 steps/s
Avg test loss: 6.21382, Avg test acc: 0.32831, Avg tpr: 0.03392, Avg fpr: 0.02423, total FA: 189

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.61002 | acc=0.3324 | tpr=0.0416 | fpr=0.0362 | 4257.5 samples/s | 16.6 steps/s
Avg test loss: 5.61461, Avg test acc: 0.33088, Avg tpr: 0.04150, Avg fpr: 0.03269, total FA: 255

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.28820 | acc=0.0970 | tpr=0.9558 | fpr=0.9185 | 4245.8 samples/s | 16.6 steps/s
[Step= 100] | Loss=7.27641 | acc=0.0971 | tpr=0.9446 | fpr=0.9187 | 8096.8 samples/s | 31.6 steps/s
[Step= 150] | Loss=7.29752 | acc=0.0970 | tpr=0.9467 | fpr=0.9186 | 8407.7 samples/s | 32.8 steps/s
[Step= 200] | Loss=7.29280 | acc=0.0972 | tpr=0.9454 | fpr=0.9182 | 8482.0 samples/s | 33.1 steps/s
[Step= 250] | Loss=7.29040 | acc=0.0975 | tpr=0.9485 | fpr=0.9180 | 8294.8 samples/s | 32.4 steps/s
[Step= 300] | Loss=7.29306 | acc=0.0974 | tpr=0.9476 | fpr=0.9181 | 8354.3 samples/s | 32.6 steps/s
[Step= 350] | Loss=7.29507 | acc=0.0970 | tpr=0.9499 | fpr=0.9185 | 8322.0 samples/s | 32.5 steps/s
[Step= 400] | Loss=7.29658 | acc=0.0970 | tpr=0.9502 | fpr=0.9185 | 8681.6 samples/s | 33.9 steps/s
[Step= 450] | Loss=7.29929 | acc=0.0971 | tpr=0.9503 | fpr=0.9184 | 8287.2 samples/s | 32.4 steps/s
[Step= 500] | Loss=7.29913 | acc=0.0970 | tpr=0.9515 | fpr=0.9184 | 8147.6 samples/s | 31.8 steps/s
[Step= 550] | Loss=7.29834 | acc=0.0972 | tpr=0.9526 | fpr=0.9184 | 15396.8 samples/s | 60.1 steps/s
Avg test loss: 7.29890, Avg test acc: 0.09715, Avg tpr: 0.95285, Avg fpr: 0.91841, total FA: 127519

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.96103 | acc=0.1059 | tpr=0.9336 | fpr=0.9090 | 4202.8 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.95317 | acc=0.1071 | tpr=0.9190 | fpr=0.9080 | 8532.0 samples/s | 33.3 steps/s
[Step= 150] | Loss=6.98087 | acc=0.1072 | tpr=0.9193 | fpr=0.9078 | 7960.8 samples/s | 31.1 steps/s
[Step= 200] | Loss=6.97478 | acc=0.1071 | tpr=0.9191 | fpr=0.9077 | 8616.3 samples/s | 33.7 steps/s
[Step= 250] | Loss=6.97251 | acc=0.1075 | tpr=0.9205 | fpr=0.9073 | 8086.8 samples/s | 31.6 steps/s
[Step= 300] | Loss=6.97569 | acc=0.1074 | tpr=0.9200 | fpr=0.9074 | 8360.8 samples/s | 32.7 steps/s
[Step= 350] | Loss=6.97813 | acc=0.1068 | tpr=0.9198 | fpr=0.9079 | 8524.7 samples/s | 33.3 steps/s
[Step= 400] | Loss=6.97955 | acc=0.1067 | tpr=0.9201 | fpr=0.9081 | 8102.6 samples/s | 31.7 steps/s
[Step= 450] | Loss=6.98413 | acc=0.1068 | tpr=0.9202 | fpr=0.9080 | 8441.8 samples/s | 33.0 steps/s
[Step= 500] | Loss=6.98335 | acc=0.1069 | tpr=0.9220 | fpr=0.9078 | 8136.5 samples/s | 31.8 steps/s
[Step= 550] | Loss=6.98213 | acc=0.1070 | tpr=0.9228 | fpr=0.9078 | 15153.5 samples/s | 59.2 steps/s
Avg test loss: 6.98296, Avg test acc: 0.10695, Avg tpr: 0.92314, Avg fpr: 0.90788, total FA: 126058

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11660 | acc=0.9820 | tpr=0.9469 | fpr=0.0173 | 4212.5 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.12207 | acc=0.9811 | tpr=0.9424 | fpr=0.0181 | 8446.0 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.12712 | acc=0.9801 | tpr=0.9496 | fpr=0.0194 | 8086.2 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.12819 | acc=0.9800 | tpr=0.9530 | fpr=0.0195 | 8260.6 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.12663 | acc=0.9799 | tpr=0.9520 | fpr=0.0196 | 8401.3 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.13043 | acc=0.9795 | tpr=0.9505 | fpr=0.0199 | 8087.2 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.13084 | acc=0.9796 | tpr=0.9499 | fpr=0.0199 | 8460.6 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.13190 | acc=0.9793 | tpr=0.9480 | fpr=0.0201 | 8603.6 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.13440 | acc=0.9790 | tpr=0.9474 | fpr=0.0204 | 8191.7 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.13364 | acc=0.9791 | tpr=0.9476 | fpr=0.0203 | 8081.0 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.13238 | acc=0.9793 | tpr=0.9471 | fpr=0.0202 | 15354.5 samples/s | 60.0 steps/s
Avg test loss: 0.13221, Avg test acc: 0.97927, Avg tpr: 0.94691, Avg fpr: 0.02014, total FA: 2797

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13865 | acc=0.9796 | tpr=0.9558 | fpr=0.0200 | 4136.9 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.14420 | acc=0.9789 | tpr=0.9574 | fpr=0.0207 | 8180.0 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.15057 | acc=0.9780 | tpr=0.9625 | fpr=0.0217 | 8501.0 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.15234 | acc=0.9778 | tpr=0.9661 | fpr=0.0220 | 8025.1 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.15026 | acc=0.9776 | tpr=0.9624 | fpr=0.0221 | 8556.7 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.15429 | acc=0.9773 | tpr=0.9615 | fpr=0.0224 | 8019.4 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.15506 | acc=0.9773 | tpr=0.9618 | fpr=0.0225 | 8439.3 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.15596 | acc=0.9771 | tpr=0.9595 | fpr=0.0226 | 8453.7 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.15871 | acc=0.9769 | tpr=0.9591 | fpr=0.0228 | 8395.6 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.15808 | acc=0.9769 | tpr=0.9604 | fpr=0.0228 | 8008.4 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.15641 | acc=0.9771 | tpr=0.9590 | fpr=0.0226 | 15560.1 samples/s | 60.8 steps/s
Avg test loss: 0.15619, Avg test acc: 0.97711, Avg tpr: 0.95880, Avg fpr: 0.02256, total FA: 3132

server round 33/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=34001 Epoch=130.3] | Loss=0.00017 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.421 | L2-Norm(final)=11.021 | 3717.8 samples/s | 58.1 steps/s
[Step=34050 Epoch=130.5] | Loss=0.00009 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.417 | L2-Norm(final)=11.026 | 5379.0 samples/s | 84.0 steps/s
[Step=34100 Epoch=130.7] | Loss=0.00010 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=11.034 | 5390.1 samples/s | 84.2 steps/s
[Step=34150 Epoch=130.9] | Loss=0.00013 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=11.044 | 5471.9 samples/s | 85.5 steps/s
[Step=34200 Epoch=131.0] | Loss=0.00012 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=11.051 | 5520.6 samples/s | 86.3 steps/s
[Step=34250 Epoch=131.2] | Loss=0.00013 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=11.058 | 7248.1 samples/s | 113.3 steps/s
[Step=34300 Epoch=131.4] | Loss=0.00012 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=11.064 | 2008.4 samples/s | 31.4 steps/s
[Step=34350 Epoch=131.6] | Loss=0.00011 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=11.069 | 5258.1 samples/s | 82.2 steps/s
[Step=34400 Epoch=131.8] | Loss=0.00010 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=11.074 | 5517.2 samples/s | 86.2 steps/s
[Step=34450 Epoch=132.0] | Loss=0.00011 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=11.078 | 5542.8 samples/s | 86.6 steps/s
[Step=34500 Epoch=132.2] | Loss=0.00012 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=11.083 | 6186.7 samples/s | 96.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=132.2] | Loss=0.00040 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=11.139 | 3858.4 samples/s | 60.3 steps/s
[Step=34550 Epoch=132.4] | Loss=0.00030 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.421 | L2-Norm(final)=11.144 | 4459.9 samples/s | 69.7 steps/s
[Step=34600 Epoch=132.6] | Loss=0.00065 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.424 | L2-Norm(final)=11.144 | 4831.2 samples/s | 75.5 steps/s
[Step=34650 Epoch=132.8] | Loss=0.00049 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.425 | L2-Norm(final)=11.145 | 4707.0 samples/s | 73.5 steps/s
[Step=34700 Epoch=133.0] | Loss=0.00037 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.423 | L2-Norm(final)=11.146 | 4813.5 samples/s | 75.2 steps/s
[Step=34750 Epoch=133.1] | Loss=0.00030 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.420 | L2-Norm(final)=11.146 | 5933.5 samples/s | 92.7 steps/s
[Step=34800 Epoch=133.3] | Loss=0.00025 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=11.147 | 1836.5 samples/s | 28.7 steps/s
[Step=34850 Epoch=133.5] | Loss=0.00021 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.411 | L2-Norm(final)=11.147 | 4643.5 samples/s | 72.6 steps/s
[Step=34900 Epoch=133.7] | Loss=0.00019 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.406 | L2-Norm(final)=11.148 | 4711.2 samples/s | 73.6 steps/s
[Step=34950 Epoch=133.9] | Loss=0.00017 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.401 | L2-Norm(final)=11.148 | 4824.6 samples/s | 75.4 steps/s
[Step=35000 Epoch=134.1] | Loss=0.00015 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.395 | L2-Norm(final)=11.149 | 5207.8 samples/s | 81.4 steps/s
[Step=35050 Epoch=134.3] | Loss=0.00014 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.390 | L2-Norm(final)=11.149 | 1992.0 samples/s | 31.1 steps/s
[Step=35100 Epoch=134.5] | Loss=0.00013 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.384 | L2-Norm(final)=11.149 | 4641.8 samples/s | 72.5 steps/s
[Step=35150 Epoch=134.7] | Loss=0.00012 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.379 | L2-Norm(final)=11.150 | 4771.6 samples/s | 74.6 steps/s
[Step=35200 Epoch=134.9] | Loss=0.00011 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=11.150 | 4793.5 samples/s | 74.9 steps/s
[Step=35250 Epoch=135.1] | Loss=0.00010 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.367 | L2-Norm(final)=11.150 | 4788.6 samples/s | 74.8 steps/s
[Step=35300 Epoch=135.3] | Loss=0.00010 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.361 | L2-Norm(final)=11.151 | 2046.8 samples/s | 32.0 steps/s
[Step=35350 Epoch=135.4] | Loss=0.00009 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.355 | L2-Norm(final)=11.151 | 4819.8 samples/s | 75.3 steps/s
[Step=35400 Epoch=135.6] | Loss=0.00009 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.349 | L2-Norm(final)=11.151 | 4789.3 samples/s | 74.8 steps/s
[Step=35450 Epoch=135.8] | Loss=0.00008 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.343 | L2-Norm(final)=11.152 | 4853.5 samples/s | 75.8 steps/s
[Step=35500 Epoch=136.0] | Loss=0.00008 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.336 | L2-Norm(final)=11.152 | 4679.5 samples/s | 73.1 steps/s
[Step=35550 Epoch=136.2] | Loss=0.00007 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.330 | L2-Norm(final)=11.152 | 2068.5 samples/s | 32.3 steps/s
[Step=35600 Epoch=136.4] | Loss=0.00007 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.324 | L2-Norm(final)=11.152 | 4703.9 samples/s | 73.5 steps/s
[Step=35650 Epoch=136.6] | Loss=0.00007 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.317 | L2-Norm(final)=11.153 | 4671.6 samples/s | 73.0 steps/s
[Step=35700 Epoch=136.8] | Loss=0.00006 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=11.153 | 4752.1 samples/s | 74.3 steps/s
[Step=35750 Epoch=137.0] | Loss=0.00006 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=11.153 | 4876.8 samples/s | 76.2 steps/s
[Step=35800 Epoch=137.2] | Loss=0.00006 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.298 | L2-Norm(final)=11.154 | 6339.4 samples/s | 99.1 steps/s
[Step=35850 Epoch=137.4] | Loss=0.00006 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=11.154 | 1830.3 samples/s | 28.6 steps/s
[Step=35900 Epoch=137.6] | Loss=0.00006 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.284 | L2-Norm(final)=11.154 | 4806.0 samples/s | 75.1 steps/s
[Step=35950 Epoch=137.7] | Loss=0.00005 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.278 | L2-Norm(final)=11.155 | 4781.2 samples/s | 74.7 steps/s
[Step=36000 Epoch=137.9] | Loss=0.00005 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.271 | L2-Norm(final)=11.155 | 4774.6 samples/s | 74.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step36000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=26001 Epoch=100.1] | Loss=0.00044 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.421 | L2-Norm(final)=11.537 | 3803.4 samples/s | 59.4 steps/s
[Step=26050 Epoch=100.3] | Loss=0.00048 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=11.548 | 4913.5 samples/s | 76.8 steps/s
[Step=26100 Epoch=100.5] | Loss=0.00039 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=11.558 | 5352.7 samples/s | 83.6 steps/s
[Step=26150 Epoch=100.7] | Loss=0.00032 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=11.565 | 5271.0 samples/s | 82.4 steps/s
[Step=26200 Epoch=100.9] | Loss=0.00032 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=11.573 | 5475.2 samples/s | 85.6 steps/s
[Step=26250 Epoch=101.0] | Loss=0.00030 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=11.582 | 7213.5 samples/s | 112.7 steps/s
[Step=26300 Epoch=101.2] | Loss=0.00031 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=11.590 | 1974.3 samples/s | 30.8 steps/s
[Step=26350 Epoch=101.4] | Loss=0.00029 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=11.598 | 5423.8 samples/s | 84.7 steps/s
[Step=26400 Epoch=101.6] | Loss=0.00027 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=11.604 | 5493.2 samples/s | 85.8 steps/s
[Step=26450 Epoch=101.8] | Loss=0.00026 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=11.611 | 5561.5 samples/s | 86.9 steps/s
[Step=26500 Epoch=102.0] | Loss=0.00027 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=11.617 | 6369.7 samples/s | 99.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=26501 Epoch=102.0] | Loss=0.00003 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=11.681 | 4023.3 samples/s | 62.9 steps/s
[Step=26550 Epoch=102.2] | Loss=0.00005 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.417 | L2-Norm(final)=11.685 | 4280.6 samples/s | 66.9 steps/s
[Step=26600 Epoch=102.4] | Loss=0.00003 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.411 | L2-Norm(final)=11.685 | 4716.8 samples/s | 73.7 steps/s
[Step=26650 Epoch=102.6] | Loss=0.00003 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.404 | L2-Norm(final)=11.686 | 4787.4 samples/s | 74.8 steps/s
[Step=26700 Epoch=102.8] | Loss=0.00002 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.397 | L2-Norm(final)=11.687 | 4801.9 samples/s | 75.0 steps/s
[Step=26750 Epoch=103.0] | Loss=0.00002 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.389 | L2-Norm(final)=11.687 | 6144.7 samples/s | 96.0 steps/s
[Step=26800 Epoch=103.2] | Loss=0.00002 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.381 | L2-Norm(final)=11.687 | 1862.1 samples/s | 29.1 steps/s
[Step=26850 Epoch=103.4] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=11.688 | 4789.0 samples/s | 74.8 steps/s
[Step=26900 Epoch=103.5] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.364 | L2-Norm(final)=11.688 | 4770.0 samples/s | 74.5 steps/s
[Step=26950 Epoch=103.7] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.356 | L2-Norm(final)=11.688 | 4759.1 samples/s | 74.4 steps/s
[Step=27000 Epoch=103.9] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.347 | L2-Norm(final)=11.689 | 5463.8 samples/s | 85.4 steps/s
[Step=27050 Epoch=104.1] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.338 | L2-Norm(final)=11.689 | 1931.3 samples/s | 30.2 steps/s
[Step=27100 Epoch=104.3] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.329 | L2-Norm(final)=11.689 | 4845.7 samples/s | 75.7 steps/s
[Step=27150 Epoch=104.5] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.320 | L2-Norm(final)=11.689 | 4874.2 samples/s | 76.2 steps/s
[Step=27200 Epoch=104.7] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.310 | L2-Norm(final)=11.689 | 4685.4 samples/s | 73.2 steps/s
[Step=27250 Epoch=104.9] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=11.690 | 4877.9 samples/s | 76.2 steps/s
[Step=27300 Epoch=105.1] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=11.690 | 2031.8 samples/s | 31.7 steps/s
[Step=27350 Epoch=105.3] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.282 | L2-Norm(final)=11.690 | 4876.5 samples/s | 76.2 steps/s
[Step=27400 Epoch=105.5] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.272 | L2-Norm(final)=11.690 | 4759.2 samples/s | 74.4 steps/s
[Step=27450 Epoch=105.7] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=11.690 | 4782.0 samples/s | 74.7 steps/s
[Step=27500 Epoch=105.9] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.252 | L2-Norm(final)=11.691 | 4798.8 samples/s | 75.0 steps/s
[Step=27550 Epoch=106.1] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=11.691 | 2050.8 samples/s | 32.0 steps/s
[Step=27600 Epoch=106.2] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.232 | L2-Norm(final)=11.691 | 4772.1 samples/s | 74.6 steps/s
[Step=27650 Epoch=106.4] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.222 | L2-Norm(final)=11.691 | 4844.5 samples/s | 75.7 steps/s
[Step=27700 Epoch=106.6] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=11.691 | 4789.1 samples/s | 74.8 steps/s
[Step=27750 Epoch=106.8] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.201 | L2-Norm(final)=11.692 | 4744.7 samples/s | 74.1 steps/s
[Step=27800 Epoch=107.0] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.190 | L2-Norm(final)=11.692 | 7049.1 samples/s | 110.1 steps/s
[Step=27850 Epoch=107.2] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.179 | L2-Norm(final)=11.692 | 1820.0 samples/s | 28.4 steps/s
[Step=27900 Epoch=107.4] | Loss=0.00000 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=11.692 | 4697.5 samples/s | 73.4 steps/s
[Step=27950 Epoch=107.6] | Loss=0.00000 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=11.692 | 4755.4 samples/s | 74.3 steps/s
[Step=28000 Epoch=107.8] | Loss=0.00000 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=11.693 | 4798.3 samples/s | 75.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_1/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07155 | acc=0.9701 | tpr=0.9789 | fpr=0.0491 | 4144.6 samples/s | 16.2 steps/s
Avg test loss: 0.07611, Avg test acc: 0.96895, Avg tpr: 0.97768, Avg fpr: 0.05025, total FA: 392

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07342 | acc=0.9688 | tpr=0.9744 | fpr=0.0436 | 4188.1 samples/s | 16.4 steps/s
Avg test loss: 0.07943, Avg test acc: 0.96775, Avg tpr: 0.97348, Avg fpr: 0.04487, total FA: 350

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.41079 | acc=0.3276 | tpr=0.0277 | fpr=0.0213 | 4192.4 samples/s | 16.4 steps/s
Avg test loss: 6.42127, Avg test acc: 0.32539, Avg tpr: 0.02780, Avg fpr: 0.02013, total FA: 157

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.70976 | acc=0.3378 | tpr=0.0459 | fpr=0.0282 | 4171.8 samples/s | 16.3 steps/s
Avg test loss: 5.71595, Avg test acc: 0.33540, Avg tpr: 0.04535, Avg fpr: 0.02666, total FA: 208

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.28820 | acc=0.0970 | tpr=0.9558 | fpr=0.9185 | 4202.3 samples/s | 16.4 steps/s
[Step= 100] | Loss=7.27641 | acc=0.0971 | tpr=0.9446 | fpr=0.9187 | 8311.6 samples/s | 32.5 steps/s
[Step= 150] | Loss=7.29752 | acc=0.0970 | tpr=0.9467 | fpr=0.9186 | 8145.2 samples/s | 31.8 steps/s
[Step= 200] | Loss=7.29280 | acc=0.0972 | tpr=0.9454 | fpr=0.9182 | 8292.4 samples/s | 32.4 steps/s
[Step= 250] | Loss=7.29040 | acc=0.0975 | tpr=0.9485 | fpr=0.9180 | 8512.1 samples/s | 33.3 steps/s
[Step= 300] | Loss=7.29306 | acc=0.0974 | tpr=0.9476 | fpr=0.9181 | 8057.0 samples/s | 31.5 steps/s
[Step= 350] | Loss=7.29507 | acc=0.0970 | tpr=0.9499 | fpr=0.9185 | 9250.0 samples/s | 36.1 steps/s
[Step= 400] | Loss=7.29658 | acc=0.0970 | tpr=0.9502 | fpr=0.9185 | 7447.4 samples/s | 29.1 steps/s
[Step= 450] | Loss=7.29929 | acc=0.0971 | tpr=0.9503 | fpr=0.9184 | 8385.1 samples/s | 32.8 steps/s
[Step= 500] | Loss=7.29913 | acc=0.0970 | tpr=0.9515 | fpr=0.9184 | 8111.1 samples/s | 31.7 steps/s
[Step= 550] | Loss=7.29834 | acc=0.0972 | tpr=0.9526 | fpr=0.9184 | 15446.6 samples/s | 60.3 steps/s
Avg test loss: 7.29890, Avg test acc: 0.09715, Avg tpr: 0.95285, Avg fpr: 0.91841, total FA: 127519

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.96103 | acc=0.1059 | tpr=0.9336 | fpr=0.9090 | 4245.2 samples/s | 16.6 steps/s
[Step= 100] | Loss=6.95317 | acc=0.1071 | tpr=0.9190 | fpr=0.9080 | 8165.1 samples/s | 31.9 steps/s
[Step= 150] | Loss=6.98087 | acc=0.1072 | tpr=0.9193 | fpr=0.9078 | 8370.4 samples/s | 32.7 steps/s
[Step= 200] | Loss=6.97478 | acc=0.1071 | tpr=0.9191 | fpr=0.9077 | 8407.6 samples/s | 32.8 steps/s
[Step= 250] | Loss=6.97251 | acc=0.1075 | tpr=0.9205 | fpr=0.9073 | 8207.6 samples/s | 32.1 steps/s
[Step= 300] | Loss=6.97569 | acc=0.1074 | tpr=0.9200 | fpr=0.9074 | 8015.1 samples/s | 31.3 steps/s
[Step= 350] | Loss=6.97813 | acc=0.1068 | tpr=0.9198 | fpr=0.9079 | 8352.2 samples/s | 32.6 steps/s
[Step= 400] | Loss=6.97955 | acc=0.1067 | tpr=0.9201 | fpr=0.9081 | 8362.1 samples/s | 32.7 steps/s
[Step= 450] | Loss=6.98413 | acc=0.1068 | tpr=0.9202 | fpr=0.9080 | 8243.2 samples/s | 32.2 steps/s
[Step= 500] | Loss=6.98335 | acc=0.1069 | tpr=0.9220 | fpr=0.9078 | 8275.5 samples/s | 32.3 steps/s
[Step= 550] | Loss=6.98213 | acc=0.1070 | tpr=0.9228 | fpr=0.9078 | 15666.2 samples/s | 61.2 steps/s
Avg test loss: 6.98296, Avg test acc: 0.10695, Avg tpr: 0.92314, Avg fpr: 0.90788, total FA: 126058

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13020 | acc=0.9816 | tpr=0.9513 | fpr=0.0179 | 4160.8 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.13598 | acc=0.9809 | tpr=0.9446 | fpr=0.0184 | 8582.0 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.14220 | acc=0.9798 | tpr=0.9524 | fpr=0.0197 | 8264.5 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.14332 | acc=0.9796 | tpr=0.9563 | fpr=0.0199 | 8164.0 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.14200 | acc=0.9797 | tpr=0.9546 | fpr=0.0198 | 8431.5 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.14604 | acc=0.9793 | tpr=0.9513 | fpr=0.0202 | 8325.6 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.14727 | acc=0.9792 | tpr=0.9505 | fpr=0.0202 | 8125.6 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.14842 | acc=0.9790 | tpr=0.9486 | fpr=0.0204 | 8180.5 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.15157 | acc=0.9788 | tpr=0.9474 | fpr=0.0207 | 8181.7 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.15066 | acc=0.9789 | tpr=0.9489 | fpr=0.0206 | 8378.2 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.14947 | acc=0.9790 | tpr=0.9479 | fpr=0.0204 | 14841.8 samples/s | 58.0 steps/s
Avg test loss: 0.14922, Avg test acc: 0.97903, Avg tpr: 0.94770, Avg fpr: 0.02040, total FA: 2833

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14251 | acc=0.9792 | tpr=0.9602 | fpr=0.0204 | 4171.3 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.14825 | acc=0.9780 | tpr=0.9595 | fpr=0.0216 | 8627.6 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.15477 | acc=0.9770 | tpr=0.9640 | fpr=0.0228 | 8417.1 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.15623 | acc=0.9768 | tpr=0.9672 | fpr=0.0230 | 8473.8 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.15453 | acc=0.9768 | tpr=0.9642 | fpr=0.0230 | 8179.9 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.15878 | acc=0.9764 | tpr=0.9615 | fpr=0.0233 | 8373.3 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.15937 | acc=0.9764 | tpr=0.9624 | fpr=0.0233 | 8416.7 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.16044 | acc=0.9762 | tpr=0.9606 | fpr=0.0235 | 8229.2 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.16326 | acc=0.9761 | tpr=0.9596 | fpr=0.0237 | 8426.5 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.16267 | acc=0.9760 | tpr=0.9595 | fpr=0.0237 | 8089.4 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.16106 | acc=0.9762 | tpr=0.9578 | fpr=0.0234 | 15463.0 samples/s | 60.4 steps/s
Avg test loss: 0.16085, Avg test acc: 0.97624, Avg tpr: 0.95761, Avg fpr: 0.02342, total FA: 3252

server round 34/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=40001 Epoch=78.0] | Loss=0.00127 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=10.958 | 3579.4 samples/s | 55.9 steps/s
[Step=40050 Epoch=78.1] | Loss=0.00871 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=10.959 | 5488.6 samples/s | 85.8 steps/s
[Step=40100 Epoch=78.2] | Loss=0.00922 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=10.959 | 5757.5 samples/s | 90.0 steps/s
[Step=40150 Epoch=78.3] | Loss=0.00968 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=10.959 | 5835.5 samples/s | 91.2 steps/s
[Step=40200 Epoch=78.4] | Loss=0.00964 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.261 | L2-Norm(final)=10.960 | 5700.6 samples/s | 89.1 steps/s
[Step=40250 Epoch=78.5] | Loss=0.00933 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=10.961 | 5757.9 samples/s | 90.0 steps/s
[Step=40300 Epoch=78.6] | Loss=0.00951 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=10.963 | 5939.7 samples/s | 92.8 steps/s
[Step=40350 Epoch=78.7] | Loss=0.00948 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.261 | L2-Norm(final)=10.964 | 5829.3 samples/s | 91.1 steps/s
[Step=40400 Epoch=78.8] | Loss=0.00963 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=10.966 | 5769.0 samples/s | 90.1 steps/s
[Step=40450 Epoch=78.9] | Loss=0.00963 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.261 | L2-Norm(final)=10.967 | 5705.1 samples/s | 89.1 steps/s
[Step=40500 Epoch=79.0] | Loss=0.00954 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=10.969 | 7320.6 samples/s | 114.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=40501 Epoch=79.0] | Loss=0.01117 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.261 | L2-Norm(final)=10.984 | 3944.9 samples/s | 61.6 steps/s
[Step=40550 Epoch=79.1] | Loss=0.00940 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=10.986 | 4911.6 samples/s | 76.7 steps/s
[Step=40600 Epoch=79.2] | Loss=0.00916 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.275 | L2-Norm(final)=10.986 | 5056.8 samples/s | 79.0 steps/s
[Step=40650 Epoch=79.3] | Loss=0.00886 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.281 | L2-Norm(final)=10.987 | 5036.4 samples/s | 78.7 steps/s
[Step=40700 Epoch=79.4] | Loss=0.00911 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.285 | L2-Norm(final)=10.988 | 4995.6 samples/s | 78.1 steps/s
[Step=40750 Epoch=79.5] | Loss=0.00934 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.289 | L2-Norm(final)=10.989 | 4966.1 samples/s | 77.6 steps/s
[Step=40800 Epoch=79.6] | Loss=0.00912 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.293 | L2-Norm(final)=10.990 | 5117.5 samples/s | 80.0 steps/s
[Step=40850 Epoch=79.7] | Loss=0.00868 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=10.991 | 5042.9 samples/s | 78.8 steps/s
[Step=40900 Epoch=79.8] | Loss=0.00879 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.300 | L2-Norm(final)=10.992 | 5003.1 samples/s | 78.2 steps/s
[Step=40950 Epoch=79.9] | Loss=0.00887 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=10.993 | 5025.2 samples/s | 78.5 steps/s
[Step=41000 Epoch=80.0] | Loss=0.00897 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.306 | L2-Norm(final)=10.994 | 6156.5 samples/s | 96.2 steps/s
[Step=41050 Epoch=80.1] | Loss=0.00863 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.309 | L2-Norm(final)=10.995 | 1864.6 samples/s | 29.1 steps/s
[Step=41100 Epoch=80.2] | Loss=0.00845 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.312 | L2-Norm(final)=10.996 | 5041.7 samples/s | 78.8 steps/s
[Step=41150 Epoch=80.3] | Loss=0.00824 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=10.998 | 4932.8 samples/s | 77.1 steps/s
[Step=41200 Epoch=80.4] | Loss=0.00810 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.317 | L2-Norm(final)=10.999 | 5015.8 samples/s | 78.4 steps/s
[Step=41250 Epoch=80.5] | Loss=0.00799 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.320 | L2-Norm(final)=11.000 | 5058.6 samples/s | 79.0 steps/s
[Step=41300 Epoch=80.6] | Loss=0.00786 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.322 | L2-Norm(final)=11.001 | 4993.8 samples/s | 78.0 steps/s
[Step=41350 Epoch=80.6] | Loss=0.00788 | Reg=0.00152 | acc=0.9688 | L2-Norm=12.325 | L2-Norm(final)=11.003 | 5006.5 samples/s | 78.2 steps/s
[Step=41400 Epoch=80.7] | Loss=0.00780 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.327 | L2-Norm(final)=11.004 | 5084.2 samples/s | 79.4 steps/s
[Step=41450 Epoch=80.8] | Loss=0.00770 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.329 | L2-Norm(final)=11.005 | 4990.1 samples/s | 78.0 steps/s
[Step=41500 Epoch=80.9] | Loss=0.00780 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.331 | L2-Norm(final)=11.006 | 5288.3 samples/s | 82.6 steps/s
[Step=41550 Epoch=81.0] | Loss=0.00774 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.333 | L2-Norm(final)=11.007 | 1980.5 samples/s | 30.9 steps/s
[Step=41600 Epoch=81.1] | Loss=0.00761 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.335 | L2-Norm(final)=11.007 | 5073.6 samples/s | 79.3 steps/s
[Step=41650 Epoch=81.2] | Loss=0.00743 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.337 | L2-Norm(final)=11.008 | 5045.5 samples/s | 78.8 steps/s
[Step=41700 Epoch=81.3] | Loss=0.00740 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.338 | L2-Norm(final)=11.009 | 5013.4 samples/s | 78.3 steps/s
[Step=41750 Epoch=81.4] | Loss=0.00730 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.340 | L2-Norm(final)=11.010 | 5047.8 samples/s | 78.9 steps/s
[Step=41800 Epoch=81.5] | Loss=0.00728 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.342 | L2-Norm(final)=11.012 | 4913.1 samples/s | 76.8 steps/s
[Step=41850 Epoch=81.6] | Loss=0.00723 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.344 | L2-Norm(final)=11.013 | 5009.4 samples/s | 78.3 steps/s
[Step=41900 Epoch=81.7] | Loss=0.00716 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.345 | L2-Norm(final)=11.014 | 5056.5 samples/s | 79.0 steps/s
[Step=41950 Epoch=81.8] | Loss=0.00713 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.347 | L2-Norm(final)=11.015 | 5070.4 samples/s | 79.2 steps/s
[Step=42000 Epoch=81.9] | Loss=0.00717 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.348 | L2-Norm(final)=11.016 | 4995.4 samples/s | 78.1 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step42000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=28001 Epoch=107.8] | Loss=0.00000 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=11.698 | 3871.9 samples/s | 60.5 steps/s
[Step=28050 Epoch=108.0] | Loss=0.00011 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=11.701 | 4866.8 samples/s | 76.0 steps/s
[Step=28100 Epoch=108.2] | Loss=0.00014 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=11.711 | 5341.2 samples/s | 83.5 steps/s
[Step=28150 Epoch=108.4] | Loss=0.00013 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=11.719 | 5639.6 samples/s | 88.1 steps/s
[Step=28200 Epoch=108.6] | Loss=0.00013 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=11.727 | 5345.0 samples/s | 83.5 steps/s
[Step=28250 Epoch=108.7] | Loss=0.00012 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=11.734 | 7304.3 samples/s | 114.1 steps/s
[Step=28300 Epoch=108.9] | Loss=0.00014 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=11.742 | 1945.1 samples/s | 30.4 steps/s
[Step=28350 Epoch=109.1] | Loss=0.00013 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=11.749 | 5515.7 samples/s | 86.2 steps/s
[Step=28400 Epoch=109.3] | Loss=0.00013 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=11.756 | 5413.9 samples/s | 84.6 steps/s
[Step=28450 Epoch=109.5] | Loss=0.00012 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=11.763 | 5603.6 samples/s | 87.6 steps/s
[Step=28500 Epoch=109.7] | Loss=0.00012 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=11.769 | 6201.1 samples/s | 96.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=28501 Epoch=109.7] | Loss=0.00004 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=11.826 | 3832.5 samples/s | 59.9 steps/s
[Step=28550 Epoch=109.9] | Loss=0.00007 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.252 | L2-Norm(final)=11.829 | 4491.2 samples/s | 70.2 steps/s
[Step=28600 Epoch=110.1] | Loss=0.00004 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=11.829 | 4779.5 samples/s | 74.7 steps/s
[Step=28650 Epoch=110.3] | Loss=0.00003 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=11.830 | 4767.3 samples/s | 74.5 steps/s
[Step=28700 Epoch=110.5] | Loss=0.00003 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.214 | L2-Norm(final)=11.831 | 4812.0 samples/s | 75.2 steps/s
[Step=28750 Epoch=110.7] | Loss=0.00003 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.203 | L2-Norm(final)=11.832 | 6052.5 samples/s | 94.6 steps/s
[Step=28800 Epoch=110.9] | Loss=0.00003 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.191 | L2-Norm(final)=11.833 | 1892.0 samples/s | 29.6 steps/s
[Step=28850 Epoch=111.1] | Loss=0.00002 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.179 | L2-Norm(final)=11.833 | 4742.1 samples/s | 74.1 steps/s
[Step=28900 Epoch=111.2] | Loss=0.00002 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=11.834 | 4749.5 samples/s | 74.2 steps/s
[Step=28950 Epoch=111.4] | Loss=0.00002 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=11.834 | 4824.3 samples/s | 75.4 steps/s
[Step=29000 Epoch=111.6] | Loss=0.00002 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=11.834 | 5396.5 samples/s | 84.3 steps/s
[Step=29050 Epoch=111.8] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.126 | L2-Norm(final)=11.835 | 1945.6 samples/s | 30.4 steps/s
[Step=29100 Epoch=112.0] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.112 | L2-Norm(final)=11.835 | 4837.4 samples/s | 75.6 steps/s
[Step=29150 Epoch=112.2] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.098 | L2-Norm(final)=11.835 | 4779.1 samples/s | 74.7 steps/s
[Step=29200 Epoch=112.4] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.084 | L2-Norm(final)=11.836 | 4739.7 samples/s | 74.1 steps/s
[Step=29250 Epoch=112.6] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=11.836 | 4906.1 samples/s | 76.7 steps/s
[Step=29300 Epoch=112.8] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.056 | L2-Norm(final)=11.836 | 2032.9 samples/s | 31.8 steps/s
[Step=29350 Epoch=113.0] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.041 | L2-Norm(final)=11.836 | 4800.7 samples/s | 75.0 steps/s
[Step=29400 Epoch=113.2] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.026 | L2-Norm(final)=11.836 | 4790.3 samples/s | 74.8 steps/s
[Step=29450 Epoch=113.4] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.012 | L2-Norm(final)=11.837 | 4758.5 samples/s | 74.4 steps/s
[Step=29500 Epoch=113.6] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.997 | L2-Norm(final)=11.837 | 4877.4 samples/s | 76.2 steps/s
[Step=29550 Epoch=113.7] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.981 | L2-Norm(final)=11.837 | 1998.1 samples/s | 31.2 steps/s
[Step=29600 Epoch=113.9] | Loss=0.00001 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.966 | L2-Norm(final)=11.837 | 4790.2 samples/s | 74.8 steps/s
[Step=29650 Epoch=114.1] | Loss=0.00001 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.951 | L2-Norm(final)=11.837 | 4747.0 samples/s | 74.2 steps/s
[Step=29700 Epoch=114.3] | Loss=0.00001 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.935 | L2-Norm(final)=11.838 | 4754.7 samples/s | 74.3 steps/s
[Step=29750 Epoch=114.5] | Loss=0.00001 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.919 | L2-Norm(final)=11.838 | 4733.4 samples/s | 74.0 steps/s
[Step=29800 Epoch=114.7] | Loss=0.00001 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.904 | L2-Norm(final)=11.838 | 7057.7 samples/s | 110.3 steps/s
[Step=29850 Epoch=114.9] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.888 | L2-Norm(final)=11.838 | 1810.0 samples/s | 28.3 steps/s
[Step=29900 Epoch=115.1] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.871 | L2-Norm(final)=11.838 | 4786.4 samples/s | 74.8 steps/s
[Step=29950 Epoch=115.3] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.855 | L2-Norm(final)=11.839 | 4898.6 samples/s | 76.5 steps/s
[Step=30000 Epoch=115.5] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.839 | L2-Norm(final)=11.839 | 4737.7 samples/s | 74.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_1/client_state-step30000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06880 | acc=0.9690 | tpr=0.9747 | fpr=0.0434 | 4230.0 samples/s | 16.5 steps/s
Avg test loss: 0.07253, Avg test acc: 0.96815, Avg tpr: 0.97389, Avg fpr: 0.04448, total FA: 347

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07342 | acc=0.9688 | tpr=0.9744 | fpr=0.0436 | 4156.1 samples/s | 16.2 steps/s
Avg test loss: 0.07943, Avg test acc: 0.96775, Avg tpr: 0.97348, Avg fpr: 0.04487, total FA: 350

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.41079 | acc=0.3276 | tpr=0.0277 | fpr=0.0213 | 4182.8 samples/s | 16.3 steps/s
Avg test loss: 6.42127, Avg test acc: 0.32539, Avg tpr: 0.02780, Avg fpr: 0.02013, total FA: 157

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.64877 | acc=0.3341 | tpr=0.0426 | fpr=0.0327 | 4182.4 samples/s | 16.3 steps/s
Avg test loss: 5.65790, Avg test acc: 0.33192, Avg tpr: 0.04243, Avg fpr: 0.03141, total FA: 245

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.33818 | acc=0.0980 | tpr=0.9558 | fpr=0.9174 | 4175.6 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.32577 | acc=0.0986 | tpr=0.9403 | fpr=0.9171 | 8217.0 samples/s | 32.1 steps/s
[Step= 150] | Loss=6.34397 | acc=0.0993 | tpr=0.9380 | fpr=0.9161 | 8344.6 samples/s | 32.6 steps/s
[Step= 200] | Loss=6.33969 | acc=0.0995 | tpr=0.9399 | fpr=0.9158 | 8508.8 samples/s | 33.2 steps/s
[Step= 250] | Loss=6.33818 | acc=0.0998 | tpr=0.9424 | fpr=0.9155 | 8034.3 samples/s | 31.4 steps/s
[Step= 300] | Loss=6.34086 | acc=0.0997 | tpr=0.9411 | fpr=0.9156 | 8380.4 samples/s | 32.7 steps/s
[Step= 350] | Loss=6.34326 | acc=0.0991 | tpr=0.9411 | fpr=0.9162 | 8227.8 samples/s | 32.1 steps/s
[Step= 400] | Loss=6.34398 | acc=0.0992 | tpr=0.9415 | fpr=0.9161 | 8651.9 samples/s | 33.8 steps/s
[Step= 450] | Loss=6.34709 | acc=0.0993 | tpr=0.9411 | fpr=0.9159 | 7830.7 samples/s | 30.6 steps/s
[Step= 500] | Loss=6.34637 | acc=0.0993 | tpr=0.9419 | fpr=0.9159 | 8230.4 samples/s | 32.2 steps/s
[Step= 550] | Loss=6.34487 | acc=0.0995 | tpr=0.9435 | fpr=0.9158 | 14789.6 samples/s | 57.8 steps/s
Avg test loss: 6.34541, Avg test acc: 0.09948, Avg tpr: 0.94374, Avg fpr: 0.91587, total FA: 127167

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.96103 | acc=0.1059 | tpr=0.9336 | fpr=0.9090 | 4124.4 samples/s | 16.1 steps/s
[Step= 100] | Loss=6.95317 | acc=0.1071 | tpr=0.9190 | fpr=0.9080 | 8487.0 samples/s | 33.2 steps/s
[Step= 150] | Loss=6.98087 | acc=0.1072 | tpr=0.9193 | fpr=0.9078 | 8368.4 samples/s | 32.7 steps/s
[Step= 200] | Loss=6.97478 | acc=0.1071 | tpr=0.9191 | fpr=0.9077 | 8114.1 samples/s | 31.7 steps/s
[Step= 250] | Loss=6.97251 | acc=0.1075 | tpr=0.9205 | fpr=0.9073 | 8298.7 samples/s | 32.4 steps/s
[Step= 300] | Loss=6.97569 | acc=0.1074 | tpr=0.9200 | fpr=0.9074 | 8366.1 samples/s | 32.7 steps/s
[Step= 350] | Loss=6.97813 | acc=0.1068 | tpr=0.9198 | fpr=0.9079 | 8187.7 samples/s | 32.0 steps/s
[Step= 400] | Loss=6.97955 | acc=0.1067 | tpr=0.9201 | fpr=0.9081 | 8392.7 samples/s | 32.8 steps/s
[Step= 450] | Loss=6.98413 | acc=0.1068 | tpr=0.9202 | fpr=0.9080 | 8141.7 samples/s | 31.8 steps/s
[Step= 500] | Loss=6.98335 | acc=0.1069 | tpr=0.9220 | fpr=0.9078 | 8258.6 samples/s | 32.3 steps/s
[Step= 550] | Loss=6.98213 | acc=0.1070 | tpr=0.9228 | fpr=0.9078 | 14597.8 samples/s | 57.0 steps/s
Avg test loss: 6.98296, Avg test acc: 0.10695, Avg tpr: 0.92314, Avg fpr: 0.90788, total FA: 126058

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13020 | acc=0.9816 | tpr=0.9513 | fpr=0.0179 | 4132.3 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.13598 | acc=0.9809 | tpr=0.9446 | fpr=0.0184 | 7999.2 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.14220 | acc=0.9798 | tpr=0.9524 | fpr=0.0197 | 8240.2 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.14332 | acc=0.9796 | tpr=0.9563 | fpr=0.0199 | 8152.9 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.14200 | acc=0.9797 | tpr=0.9546 | fpr=0.0198 | 8231.7 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.14604 | acc=0.9793 | tpr=0.9513 | fpr=0.0202 | 8155.6 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.14727 | acc=0.9792 | tpr=0.9505 | fpr=0.0202 | 8316.3 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.14842 | acc=0.9790 | tpr=0.9486 | fpr=0.0204 | 8186.9 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.15157 | acc=0.9788 | tpr=0.9474 | fpr=0.0207 | 8495.5 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.15066 | acc=0.9789 | tpr=0.9489 | fpr=0.0206 | 8295.5 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.14947 | acc=0.9790 | tpr=0.9479 | fpr=0.0204 | 14627.0 samples/s | 57.1 steps/s
Avg test loss: 0.14922, Avg test acc: 0.97903, Avg tpr: 0.94770, Avg fpr: 0.02040, total FA: 2833

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14997 | acc=0.9779 | tpr=0.9558 | fpr=0.0217 | 4186.0 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.15652 | acc=0.9771 | tpr=0.9552 | fpr=0.0224 | 8212.9 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.16413 | acc=0.9761 | tpr=0.9611 | fpr=0.0236 | 8201.5 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.16581 | acc=0.9762 | tpr=0.9639 | fpr=0.0236 | 8434.1 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.16380 | acc=0.9760 | tpr=0.9607 | fpr=0.0237 | 8157.5 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.16825 | acc=0.9757 | tpr=0.9585 | fpr=0.0240 | 8256.5 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.16877 | acc=0.9757 | tpr=0.9599 | fpr=0.0240 | 8395.9 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.16997 | acc=0.9756 | tpr=0.9584 | fpr=0.0240 | 8314.6 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.17299 | acc=0.9755 | tpr=0.9581 | fpr=0.0242 | 8169.4 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.17223 | acc=0.9756 | tpr=0.9581 | fpr=0.0241 | 8496.3 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.17075 | acc=0.9757 | tpr=0.9570 | fpr=0.0239 | 14185.8 samples/s | 55.4 steps/s
Avg test loss: 0.17050, Avg test acc: 0.97574, Avg tpr: 0.95681, Avg fpr: 0.02391, total FA: 3320

server round 35/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=42001 Epoch=81.9] | Loss=0.01688 | Reg=0.00146 | acc=0.9688 | L2-Norm=12.073 | L2-Norm(final)=11.044 | 3636.9 samples/s | 56.8 steps/s
[Step=42050 Epoch=82.0] | Loss=0.00810 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=11.047 | 5761.6 samples/s | 90.0 steps/s
[Step=42100 Epoch=82.1] | Loss=0.00954 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=11.050 | 5746.3 samples/s | 89.8 steps/s
[Step=42150 Epoch=82.2] | Loss=0.01015 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=11.052 | 5727.7 samples/s | 89.5 steps/s
[Step=42200 Epoch=82.3] | Loss=0.01015 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=11.055 | 5817.5 samples/s | 90.9 steps/s
[Step=42250 Epoch=82.4] | Loss=0.00977 | Reg=0.00146 | acc=0.9688 | L2-Norm=12.073 | L2-Norm(final)=11.057 | 5724.0 samples/s | 89.4 steps/s
[Step=42300 Epoch=82.5] | Loss=0.00977 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=11.060 | 5880.5 samples/s | 91.9 steps/s
[Step=42350 Epoch=82.6] | Loss=0.00968 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.073 | L2-Norm(final)=11.063 | 5853.4 samples/s | 91.5 steps/s
[Step=42400 Epoch=82.7] | Loss=0.00989 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=11.066 | 5740.7 samples/s | 89.7 steps/s
[Step=42450 Epoch=82.8] | Loss=0.00977 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=11.069 | 5765.7 samples/s | 90.1 steps/s
[Step=42500 Epoch=82.9] | Loss=0.00958 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=11.072 | 7230.3 samples/s | 113.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=42501 Epoch=82.9] | Loss=0.00534 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=11.099 | 3826.9 samples/s | 59.8 steps/s
[Step=42550 Epoch=83.0] | Loss=0.00957 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.081 | L2-Norm(final)=11.103 | 4796.5 samples/s | 74.9 steps/s
[Step=42600 Epoch=83.1] | Loss=0.00915 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.089 | L2-Norm(final)=11.104 | 4969.8 samples/s | 77.7 steps/s
[Step=42650 Epoch=83.2] | Loss=0.00926 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.094 | L2-Norm(final)=11.105 | 5034.5 samples/s | 78.7 steps/s
[Step=42700 Epoch=83.3] | Loss=0.00931 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.099 | L2-Norm(final)=11.106 | 5005.8 samples/s | 78.2 steps/s
[Step=42750 Epoch=83.4] | Loss=0.00918 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.104 | L2-Norm(final)=11.107 | 5041.2 samples/s | 78.8 steps/s
[Step=42800 Epoch=83.5] | Loss=0.00922 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.108 | L2-Norm(final)=11.108 | 5008.2 samples/s | 78.3 steps/s
[Step=42850 Epoch=83.6] | Loss=0.00907 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.112 | L2-Norm(final)=11.109 | 5011.8 samples/s | 78.3 steps/s
[Step=42900 Epoch=83.7] | Loss=0.00922 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.116 | L2-Norm(final)=11.110 | 5107.2 samples/s | 79.8 steps/s
[Step=42950 Epoch=83.8] | Loss=0.00924 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.119 | L2-Norm(final)=11.111 | 5013.9 samples/s | 78.3 steps/s
[Step=43000 Epoch=83.9] | Loss=0.00934 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.123 | L2-Norm(final)=11.112 | 6238.1 samples/s | 97.5 steps/s
[Step=43050 Epoch=84.0] | Loss=0.00915 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.126 | L2-Norm(final)=11.113 | 1841.0 samples/s | 28.8 steps/s
[Step=43100 Epoch=84.1] | Loss=0.00889 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.129 | L2-Norm(final)=11.115 | 4935.7 samples/s | 77.1 steps/s
[Step=43150 Epoch=84.2] | Loss=0.00859 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.132 | L2-Norm(final)=11.116 | 5026.9 samples/s | 78.5 steps/s
[Step=43200 Epoch=84.3] | Loss=0.00858 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.135 | L2-Norm(final)=11.117 | 5033.3 samples/s | 78.6 steps/s
[Step=43250 Epoch=84.4] | Loss=0.00840 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=11.119 | 4992.0 samples/s | 78.0 steps/s
[Step=43300 Epoch=84.5] | Loss=0.00834 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=11.120 | 5068.3 samples/s | 79.2 steps/s
[Step=43350 Epoch=84.5] | Loss=0.00831 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.142 | L2-Norm(final)=11.122 | 5063.6 samples/s | 79.1 steps/s
[Step=43400 Epoch=84.6] | Loss=0.00827 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=11.123 | 4946.0 samples/s | 77.3 steps/s
[Step=43450 Epoch=84.7] | Loss=0.00816 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=11.124 | 4985.6 samples/s | 77.9 steps/s
[Step=43500 Epoch=84.8] | Loss=0.00799 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=11.126 | 5359.9 samples/s | 83.7 steps/s
[Step=43550 Epoch=84.9] | Loss=0.00788 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=11.127 | 1951.9 samples/s | 30.5 steps/s
[Step=43600 Epoch=85.0] | Loss=0.00774 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=11.129 | 5119.2 samples/s | 80.0 steps/s
[Step=43650 Epoch=85.1] | Loss=0.00758 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.155 | L2-Norm(final)=11.130 | 5081.0 samples/s | 79.4 steps/s
[Step=43700 Epoch=85.2] | Loss=0.00751 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.157 | L2-Norm(final)=11.132 | 5081.3 samples/s | 79.4 steps/s
[Step=43750 Epoch=85.3] | Loss=0.00746 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=11.133 | 5065.5 samples/s | 79.1 steps/s
[Step=43800 Epoch=85.4] | Loss=0.00744 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.161 | L2-Norm(final)=11.135 | 5027.2 samples/s | 78.6 steps/s
[Step=43850 Epoch=85.5] | Loss=0.00738 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=11.136 | 5056.3 samples/s | 79.0 steps/s
[Step=43900 Epoch=85.6] | Loss=0.00731 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=11.137 | 4961.2 samples/s | 77.5 steps/s
[Step=43950 Epoch=85.7] | Loss=0.00728 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.166 | L2-Norm(final)=11.139 | 5052.3 samples/s | 78.9 steps/s
[Step=44000 Epoch=85.8] | Loss=0.00722 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=11.140 | 5027.4 samples/s | 78.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step44000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=36001 Epoch=137.9] | Loss=0.00000 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=11.165 | 3865.2 samples/s | 60.4 steps/s
[Step=36050 Epoch=138.1] | Loss=0.00003 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.071 | L2-Norm(final)=11.166 | 4988.0 samples/s | 77.9 steps/s
[Step=36100 Epoch=138.3] | Loss=0.00003 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=11.169 | 5407.3 samples/s | 84.5 steps/s
[Step=36150 Epoch=138.5] | Loss=0.00004 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=11.172 | 5546.2 samples/s | 86.7 steps/s
[Step=36200 Epoch=138.7] | Loss=0.00005 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=11.176 | 5526.7 samples/s | 86.4 steps/s
[Step=36250 Epoch=138.9] | Loss=0.00005 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=11.181 | 6990.4 samples/s | 109.2 steps/s
[Step=36300 Epoch=139.1] | Loss=0.00005 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=11.186 | 1953.7 samples/s | 30.5 steps/s
[Step=36350 Epoch=139.3] | Loss=0.00005 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=11.190 | 5482.2 samples/s | 85.7 steps/s
[Step=36400 Epoch=139.5] | Loss=0.00005 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=11.195 | 5455.2 samples/s | 85.2 steps/s
[Step=36450 Epoch=139.7] | Loss=0.00005 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=11.199 | 5446.1 samples/s | 85.1 steps/s
[Step=36500 Epoch=139.9] | Loss=0.00005 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=11.203 | 6139.1 samples/s | 95.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=139.9] | Loss=0.00007 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=11.241 | 3770.6 samples/s | 58.9 steps/s
[Step=36550 Epoch=140.0] | Loss=0.00002 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.062 | L2-Norm(final)=11.243 | 4672.3 samples/s | 73.0 steps/s
[Step=36600 Epoch=140.2] | Loss=0.00005 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.054 | L2-Norm(final)=11.244 | 4713.0 samples/s | 73.6 steps/s
[Step=36650 Epoch=140.4] | Loss=0.00004 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.049 | L2-Norm(final)=11.245 | 4688.8 samples/s | 73.3 steps/s
[Step=36700 Epoch=140.6] | Loss=0.00003 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.042 | L2-Norm(final)=11.246 | 4692.1 samples/s | 73.3 steps/s
[Step=36750 Epoch=140.8] | Loss=0.00003 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.034 | L2-Norm(final)=11.247 | 5858.6 samples/s | 91.5 steps/s
[Step=36800 Epoch=141.0] | Loss=0.00002 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.025 | L2-Norm(final)=11.248 | 1864.4 samples/s | 29.1 steps/s
[Step=36850 Epoch=141.2] | Loss=0.00002 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.017 | L2-Norm(final)=11.248 | 4723.4 samples/s | 73.8 steps/s
[Step=36900 Epoch=141.4] | Loss=0.00002 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.008 | L2-Norm(final)=11.249 | 4869.9 samples/s | 76.1 steps/s
[Step=36950 Epoch=141.6] | Loss=0.00002 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.998 | L2-Norm(final)=11.249 | 4841.6 samples/s | 75.7 steps/s
[Step=37000 Epoch=141.8] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.989 | L2-Norm(final)=11.249 | 5391.1 samples/s | 84.2 steps/s
[Step=37050 Epoch=142.0] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.979 | L2-Norm(final)=11.250 | 1964.4 samples/s | 30.7 steps/s
[Step=37100 Epoch=142.2] | Loss=0.00001 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.970 | L2-Norm(final)=11.250 | 4876.2 samples/s | 76.2 steps/s
[Step=37150 Epoch=142.3] | Loss=0.00001 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.960 | L2-Norm(final)=11.251 | 4902.2 samples/s | 76.6 steps/s
[Step=37200 Epoch=142.5] | Loss=0.00001 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.950 | L2-Norm(final)=11.251 | 4770.8 samples/s | 74.5 steps/s
[Step=37250 Epoch=142.7] | Loss=0.00001 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.940 | L2-Norm(final)=11.251 | 4806.6 samples/s | 75.1 steps/s
[Step=37300 Epoch=142.9] | Loss=0.00001 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.930 | L2-Norm(final)=11.251 | 2028.1 samples/s | 31.7 steps/s
[Step=37350 Epoch=143.1] | Loss=0.00001 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.920 | L2-Norm(final)=11.252 | 4900.1 samples/s | 76.6 steps/s
[Step=37400 Epoch=143.3] | Loss=0.00001 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.910 | L2-Norm(final)=11.252 | 4757.1 samples/s | 74.3 steps/s
[Step=37450 Epoch=143.5] | Loss=0.00001 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=11.252 | 4808.4 samples/s | 75.1 steps/s
[Step=37500 Epoch=143.7] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.889 | L2-Norm(final)=11.253 | 4756.6 samples/s | 74.3 steps/s
[Step=37550 Epoch=143.9] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.879 | L2-Norm(final)=11.253 | 2035.7 samples/s | 31.8 steps/s
[Step=37600 Epoch=144.1] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.868 | L2-Norm(final)=11.253 | 4901.5 samples/s | 76.6 steps/s
[Step=37650 Epoch=144.3] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.858 | L2-Norm(final)=11.254 | 4652.8 samples/s | 72.7 steps/s
[Step=37700 Epoch=144.5] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.847 | L2-Norm(final)=11.254 | 4798.8 samples/s | 75.0 steps/s
[Step=37750 Epoch=144.6] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.836 | L2-Norm(final)=11.254 | 4736.0 samples/s | 74.0 steps/s
[Step=37800 Epoch=144.8] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.825 | L2-Norm(final)=11.255 | 6546.9 samples/s | 102.3 steps/s
[Step=37850 Epoch=145.0] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.814 | L2-Norm(final)=11.255 | 1857.3 samples/s | 29.0 steps/s
[Step=37900 Epoch=145.2] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.803 | L2-Norm(final)=11.256 | 4675.8 samples/s | 73.1 steps/s
[Step=37950 Epoch=145.4] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.792 | L2-Norm(final)=11.256 | 4756.0 samples/s | 74.3 steps/s
[Step=38000 Epoch=145.6] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.780 | L2-Norm(final)=11.256 | 4765.1 samples/s | 74.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step38000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07290 | acc=0.9700 | tpr=0.9807 | fpr=0.0533 | 4197.6 samples/s | 16.4 steps/s
Avg test loss: 0.07581, Avg test acc: 0.96879, Avg tpr: 0.97913, Avg fpr: 0.05397, total FA: 421

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07342 | acc=0.9688 | tpr=0.9744 | fpr=0.0436 | 4216.7 samples/s | 16.5 steps/s
Avg test loss: 0.07943, Avg test acc: 0.96775, Avg tpr: 0.97348, Avg fpr: 0.04487, total FA: 350

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.11714 | acc=0.3295 | tpr=0.0329 | fpr=0.0263 | 4227.2 samples/s | 16.5 steps/s
Avg test loss: 6.12374, Avg test acc: 0.32783, Avg tpr: 0.03281, Avg fpr: 0.02333, total FA: 182

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.64877 | acc=0.3341 | tpr=0.0426 | fpr=0.0327 | 4178.8 samples/s | 16.3 steps/s
Avg test loss: 5.65790, Avg test acc: 0.33192, Avg tpr: 0.04243, Avg fpr: 0.03141, total FA: 245

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.04628 | acc=0.0966 | tpr=0.9513 | fpr=0.9188 | 4165.1 samples/s | 16.3 steps/s
[Step= 100] | Loss=7.03194 | acc=0.0973 | tpr=0.9382 | fpr=0.9184 | 8415.0 samples/s | 32.9 steps/s
[Step= 150] | Loss=7.05348 | acc=0.0974 | tpr=0.9424 | fpr=0.9181 | 8307.6 samples/s | 32.5 steps/s
[Step= 200] | Loss=7.04846 | acc=0.0973 | tpr=0.9432 | fpr=0.9181 | 8275.9 samples/s | 32.3 steps/s
[Step= 250] | Loss=7.04601 | acc=0.0975 | tpr=0.9432 | fpr=0.9179 | 8306.3 samples/s | 32.4 steps/s
[Step= 300] | Loss=7.04929 | acc=0.0977 | tpr=0.9425 | fpr=0.9177 | 8259.3 samples/s | 32.3 steps/s
[Step= 350] | Loss=7.05060 | acc=0.0971 | tpr=0.9443 | fpr=0.9183 | 8751.5 samples/s | 34.2 steps/s
[Step= 400] | Loss=7.05166 | acc=0.0969 | tpr=0.9453 | fpr=0.9185 | 7851.4 samples/s | 30.7 steps/s
[Step= 450] | Loss=7.05477 | acc=0.0970 | tpr=0.9455 | fpr=0.9184 | 8252.5 samples/s | 32.2 steps/s
[Step= 500] | Loss=7.05409 | acc=0.0968 | tpr=0.9458 | fpr=0.9185 | 8192.8 samples/s | 32.0 steps/s
[Step= 550] | Loss=7.05316 | acc=0.0970 | tpr=0.9475 | fpr=0.9185 | 15477.1 samples/s | 60.5 steps/s
Avg test loss: 7.05365, Avg test acc: 0.09692, Avg tpr: 0.94770, Avg fpr: 0.91854, total FA: 127538

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.96103 | acc=0.1059 | tpr=0.9336 | fpr=0.9090 | 4166.2 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.95317 | acc=0.1071 | tpr=0.9190 | fpr=0.9080 | 8445.6 samples/s | 33.0 steps/s
[Step= 150] | Loss=6.98087 | acc=0.1072 | tpr=0.9193 | fpr=0.9078 | 8525.9 samples/s | 33.3 steps/s
[Step= 200] | Loss=6.97478 | acc=0.1071 | tpr=0.9191 | fpr=0.9077 | 7913.6 samples/s | 30.9 steps/s
[Step= 250] | Loss=6.97251 | acc=0.1075 | tpr=0.9205 | fpr=0.9073 | 8517.7 samples/s | 33.3 steps/s
[Step= 300] | Loss=6.97569 | acc=0.1074 | tpr=0.9200 | fpr=0.9074 | 8286.6 samples/s | 32.4 steps/s
[Step= 350] | Loss=6.97813 | acc=0.1068 | tpr=0.9198 | fpr=0.9079 | 8143.9 samples/s | 31.8 steps/s
[Step= 400] | Loss=6.97955 | acc=0.1067 | tpr=0.9201 | fpr=0.9081 | 8185.8 samples/s | 32.0 steps/s
[Step= 450] | Loss=6.98413 | acc=0.1068 | tpr=0.9202 | fpr=0.9080 | 8489.0 samples/s | 33.2 steps/s
[Step= 500] | Loss=6.98335 | acc=0.1069 | tpr=0.9220 | fpr=0.9078 | 8035.1 samples/s | 31.4 steps/s
[Step= 550] | Loss=6.98213 | acc=0.1070 | tpr=0.9228 | fpr=0.9078 | 15866.7 samples/s | 62.0 steps/s
Avg test loss: 6.98296, Avg test acc: 0.10695, Avg tpr: 0.92314, Avg fpr: 0.90788, total FA: 126058

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11186 | acc=0.9827 | tpr=0.9469 | fpr=0.0167 | 4218.2 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.11766 | acc=0.9816 | tpr=0.9446 | fpr=0.0177 | 8270.7 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.12269 | acc=0.9807 | tpr=0.9524 | fpr=0.0188 | 8210.2 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.12337 | acc=0.9806 | tpr=0.9552 | fpr=0.0189 | 8192.3 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.12178 | acc=0.9805 | tpr=0.9537 | fpr=0.0190 | 8202.3 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.12539 | acc=0.9801 | tpr=0.9520 | fpr=0.0194 | 8802.4 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.12589 | acc=0.9800 | tpr=0.9518 | fpr=0.0194 | 7805.2 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.12717 | acc=0.9798 | tpr=0.9486 | fpr=0.0196 | 8244.6 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.12970 | acc=0.9795 | tpr=0.9474 | fpr=0.0199 | 8307.0 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.12904 | acc=0.9796 | tpr=0.9480 | fpr=0.0198 | 8210.2 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.12813 | acc=0.9798 | tpr=0.9463 | fpr=0.0196 | 15096.6 samples/s | 59.0 steps/s
Avg test loss: 0.12793, Avg test acc: 0.97977, Avg tpr: 0.94612, Avg fpr: 0.01962, total FA: 2724

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14997 | acc=0.9779 | tpr=0.9558 | fpr=0.0217 | 4187.8 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.15652 | acc=0.9771 | tpr=0.9552 | fpr=0.0224 | 8381.3 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.16413 | acc=0.9761 | tpr=0.9611 | fpr=0.0236 | 8417.7 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.16581 | acc=0.9762 | tpr=0.9639 | fpr=0.0236 | 8424.8 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.16380 | acc=0.9760 | tpr=0.9607 | fpr=0.0237 | 8126.5 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.16825 | acc=0.9757 | tpr=0.9585 | fpr=0.0240 | 8258.7 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.16877 | acc=0.9757 | tpr=0.9599 | fpr=0.0240 | 8298.2 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.16997 | acc=0.9756 | tpr=0.9584 | fpr=0.0240 | 8404.3 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.17299 | acc=0.9755 | tpr=0.9581 | fpr=0.0242 | 8109.2 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.17223 | acc=0.9756 | tpr=0.9581 | fpr=0.0241 | 8476.7 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.17075 | acc=0.9757 | tpr=0.9570 | fpr=0.0239 | 14712.0 samples/s | 57.5 steps/s
Avg test loss: 0.17050, Avg test acc: 0.97574, Avg tpr: 0.95681, Avg fpr: 0.02391, total FA: 3320

server round 36/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=32001 Epoch=62.6] | Loss=0.01197 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.871 | L2-Norm(final)=10.653 | 3861.2 samples/s | 60.3 steps/s
[Step=32050 Epoch=62.7] | Loss=0.01069 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=10.654 | 5250.0 samples/s | 82.0 steps/s
[Step=32100 Epoch=62.8] | Loss=0.00924 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=10.657 | 5900.8 samples/s | 92.2 steps/s
[Step=32150 Epoch=62.9] | Loss=0.00921 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.872 | L2-Norm(final)=10.660 | 6003.7 samples/s | 93.8 steps/s
[Step=32200 Epoch=63.0] | Loss=0.00927 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=10.663 | 5765.1 samples/s | 90.1 steps/s
[Step=32250 Epoch=63.0] | Loss=0.00908 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=10.667 | 5862.9 samples/s | 91.6 steps/s
[Step=32300 Epoch=63.1] | Loss=0.00910 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.872 | L2-Norm(final)=10.670 | 5925.2 samples/s | 92.6 steps/s
[Step=32350 Epoch=63.2] | Loss=0.00917 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=10.674 | 5930.0 samples/s | 92.7 steps/s
[Step=32400 Epoch=63.3] | Loss=0.00924 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.872 | L2-Norm(final)=10.677 | 5933.4 samples/s | 92.7 steps/s
[Step=32450 Epoch=63.4] | Loss=0.00929 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=10.681 | 5750.0 samples/s | 89.8 steps/s
[Step=32500 Epoch=63.5] | Loss=0.00926 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=10.684 | 7642.8 samples/s | 119.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=63.5] | Loss=0.00202 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=10.720 | 3845.7 samples/s | 60.1 steps/s
[Step=32550 Epoch=63.6] | Loss=0.00995 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.881 | L2-Norm(final)=10.723 | 4831.3 samples/s | 75.5 steps/s
[Step=32600 Epoch=63.7] | Loss=0.01018 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.891 | L2-Norm(final)=10.725 | 5068.2 samples/s | 79.2 steps/s
[Step=32650 Epoch=63.8] | Loss=0.00964 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.898 | L2-Norm(final)=10.726 | 4942.7 samples/s | 77.2 steps/s
[Step=32700 Epoch=63.9] | Loss=0.01030 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.904 | L2-Norm(final)=10.727 | 5014.6 samples/s | 78.4 steps/s
[Step=32750 Epoch=64.0] | Loss=0.01051 | Reg=0.00142 | acc=0.9531 | L2-Norm=11.910 | L2-Norm(final)=10.728 | 5028.8 samples/s | 78.6 steps/s
[Step=32800 Epoch=64.1] | Loss=0.01036 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.915 | L2-Norm(final)=10.730 | 5015.8 samples/s | 78.4 steps/s
[Step=32850 Epoch=64.2] | Loss=0.01009 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.921 | L2-Norm(final)=10.732 | 5035.8 samples/s | 78.7 steps/s
[Step=32900 Epoch=64.3] | Loss=0.00969 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.925 | L2-Norm(final)=10.734 | 4975.7 samples/s | 77.7 steps/s
[Step=32950 Epoch=64.4] | Loss=0.00952 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.930 | L2-Norm(final)=10.736 | 5073.2 samples/s | 79.3 steps/s
[Step=33000 Epoch=64.5] | Loss=0.00904 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.934 | L2-Norm(final)=10.738 | 6267.1 samples/s | 97.9 steps/s
[Step=33050 Epoch=64.6] | Loss=0.00884 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.937 | L2-Norm(final)=10.740 | 1931.0 samples/s | 30.2 steps/s
[Step=33100 Epoch=64.7] | Loss=0.00868 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.941 | L2-Norm(final)=10.742 | 4974.1 samples/s | 77.7 steps/s
[Step=33150 Epoch=64.8] | Loss=0.00854 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.945 | L2-Norm(final)=10.744 | 5052.7 samples/s | 78.9 steps/s
[Step=33200 Epoch=64.9] | Loss=0.00845 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.948 | L2-Norm(final)=10.746 | 5068.3 samples/s | 79.2 steps/s
[Step=33250 Epoch=65.0] | Loss=0.00839 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.951 | L2-Norm(final)=10.747 | 4961.7 samples/s | 77.5 steps/s
[Step=33300 Epoch=65.1] | Loss=0.00821 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.954 | L2-Norm(final)=10.749 | 5045.6 samples/s | 78.8 steps/s
[Step=33350 Epoch=65.2] | Loss=0.00805 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.957 | L2-Norm(final)=10.751 | 5028.0 samples/s | 78.6 steps/s
[Step=33400 Epoch=65.3] | Loss=0.00796 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.959 | L2-Norm(final)=10.753 | 4974.2 samples/s | 77.7 steps/s
[Step=33450 Epoch=65.4] | Loss=0.00784 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.962 | L2-Norm(final)=10.755 | 5063.3 samples/s | 79.1 steps/s
[Step=33500 Epoch=65.5] | Loss=0.00776 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.964 | L2-Norm(final)=10.756 | 5430.4 samples/s | 84.8 steps/s
[Step=33550 Epoch=65.6] | Loss=0.00764 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.967 | L2-Norm(final)=10.758 | 2025.3 samples/s | 31.6 steps/s
[Step=33600 Epoch=65.7] | Loss=0.00759 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.969 | L2-Norm(final)=10.760 | 5165.9 samples/s | 80.7 steps/s
[Step=33650 Epoch=65.8] | Loss=0.00753 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=10.762 | 4960.1 samples/s | 77.5 steps/s
[Step=33700 Epoch=65.9] | Loss=0.00744 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.974 | L2-Norm(final)=10.764 | 5061.7 samples/s | 79.1 steps/s
[Step=33750 Epoch=66.0] | Loss=0.00736 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.976 | L2-Norm(final)=10.765 | 5025.6 samples/s | 78.5 steps/s
[Step=33800 Epoch=66.1] | Loss=0.00727 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.978 | L2-Norm(final)=10.767 | 5043.0 samples/s | 78.8 steps/s
[Step=33850 Epoch=66.2] | Loss=0.00723 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.981 | L2-Norm(final)=10.769 | 5086.9 samples/s | 79.5 steps/s
[Step=33900 Epoch=66.3] | Loss=0.00715 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.983 | L2-Norm(final)=10.771 | 5060.4 samples/s | 79.1 steps/s
[Step=33950 Epoch=66.4] | Loss=0.00714 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.985 | L2-Norm(final)=10.773 | 5066.7 samples/s | 79.2 steps/s
[Step=34000 Epoch=66.5] | Loss=0.00704 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.987 | L2-Norm(final)=10.774 | 4961.3 samples/s | 77.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step34000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=38001 Epoch=145.6] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.871 | L2-Norm(final)=11.268 | 3815.9 samples/s | 59.6 steps/s
[Step=38050 Epoch=145.8] | Loss=0.00004 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.867 | L2-Norm(final)=11.272 | 5190.0 samples/s | 81.1 steps/s
[Step=38100 Epoch=146.0] | Loss=0.00003 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.867 | L2-Norm(final)=11.276 | 5451.7 samples/s | 85.2 steps/s
[Step=38150 Epoch=146.2] | Loss=0.00003 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.867 | L2-Norm(final)=11.280 | 5506.1 samples/s | 86.0 steps/s
[Step=38200 Epoch=146.4] | Loss=0.00004 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.866 | L2-Norm(final)=11.285 | 5496.9 samples/s | 85.9 steps/s
[Step=38250 Epoch=146.6] | Loss=0.00004 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.866 | L2-Norm(final)=11.291 | 7067.7 samples/s | 110.4 steps/s
[Step=38300 Epoch=146.8] | Loss=0.00004 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.866 | L2-Norm(final)=11.298 | 1975.6 samples/s | 30.9 steps/s
[Step=38350 Epoch=146.9] | Loss=0.00004 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.866 | L2-Norm(final)=11.304 | 5464.8 samples/s | 85.4 steps/s
[Step=38400 Epoch=147.1] | Loss=0.00004 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.866 | L2-Norm(final)=11.310 | 5425.7 samples/s | 84.8 steps/s
[Step=38450 Epoch=147.3] | Loss=0.00004 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.866 | L2-Norm(final)=11.316 | 5386.6 samples/s | 84.2 steps/s
[Step=38500 Epoch=147.5] | Loss=0.00004 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.866 | L2-Norm(final)=11.321 | 6206.6 samples/s | 97.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=147.5] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.866 | L2-Norm(final)=11.373 | 3890.3 samples/s | 60.8 steps/s
[Step=38550 Epoch=147.7] | Loss=0.00003 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.854 | L2-Norm(final)=11.376 | 4486.9 samples/s | 70.1 steps/s
[Step=38600 Epoch=147.9] | Loss=0.00002 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.838 | L2-Norm(final)=11.378 | 4772.0 samples/s | 74.6 steps/s
[Step=38650 Epoch=148.1] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.821 | L2-Norm(final)=11.379 | 4788.7 samples/s | 74.8 steps/s
[Step=38700 Epoch=148.3] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.802 | L2-Norm(final)=11.380 | 4704.1 samples/s | 73.5 steps/s
[Step=38750 Epoch=148.5] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.784 | L2-Norm(final)=11.381 | 6009.5 samples/s | 93.9 steps/s
[Step=38800 Epoch=148.7] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.766 | L2-Norm(final)=11.382 | 1888.3 samples/s | 29.5 steps/s
[Step=38850 Epoch=148.9] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.748 | L2-Norm(final)=11.383 | 4802.0 samples/s | 75.0 steps/s
[Step=38900 Epoch=149.1] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.730 | L2-Norm(final)=11.384 | 4704.8 samples/s | 73.5 steps/s
[Step=38950 Epoch=149.2] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.711 | L2-Norm(final)=11.385 | 4775.5 samples/s | 74.6 steps/s
[Step=39000 Epoch=149.4] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.692 | L2-Norm(final)=11.385 | 5262.3 samples/s | 82.2 steps/s
[Step=39050 Epoch=149.6] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.673 | L2-Norm(final)=11.386 | 1987.9 samples/s | 31.1 steps/s
[Step=39100 Epoch=149.8] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=11.386 | 4857.3 samples/s | 75.9 steps/s
[Step=39150 Epoch=150.0] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.636 | L2-Norm(final)=11.387 | 4877.9 samples/s | 76.2 steps/s
[Step=39200 Epoch=150.2] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.617 | L2-Norm(final)=11.387 | 4821.9 samples/s | 75.3 steps/s
[Step=39250 Epoch=150.4] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.597 | L2-Norm(final)=11.388 | 4682.8 samples/s | 73.2 steps/s
[Step=39300 Epoch=150.6] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.578 | L2-Norm(final)=11.388 | 2032.4 samples/s | 31.8 steps/s
[Step=39350 Epoch=150.8] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.559 | L2-Norm(final)=11.389 | 4892.2 samples/s | 76.4 steps/s
[Step=39400 Epoch=151.0] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.539 | L2-Norm(final)=11.389 | 4775.2 samples/s | 74.6 steps/s
[Step=39450 Epoch=151.2] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.520 | L2-Norm(final)=11.389 | 4750.3 samples/s | 74.2 steps/s
[Step=39500 Epoch=151.4] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.500 | L2-Norm(final)=11.390 | 4685.1 samples/s | 73.2 steps/s
[Step=39550 Epoch=151.5] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.480 | L2-Norm(final)=11.390 | 2055.6 samples/s | 32.1 steps/s
[Step=39600 Epoch=151.7] | Loss=0.00000 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.461 | L2-Norm(final)=11.391 | 4836.4 samples/s | 75.6 steps/s
[Step=39650 Epoch=151.9] | Loss=0.00000 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.441 | L2-Norm(final)=11.391 | 4782.9 samples/s | 74.7 steps/s
[Step=39700 Epoch=152.1] | Loss=0.00000 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.421 | L2-Norm(final)=11.392 | 4855.1 samples/s | 75.9 steps/s
[Step=39750 Epoch=152.3] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.400 | L2-Norm(final)=11.392 | 4756.7 samples/s | 74.3 steps/s
[Step=39800 Epoch=152.5] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=11.393 | 6526.6 samples/s | 102.0 steps/s
[Step=39850 Epoch=152.7] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.360 | L2-Norm(final)=11.393 | 1819.9 samples/s | 28.4 steps/s
[Step=39900 Epoch=152.9] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.339 | L2-Norm(final)=11.394 | 4762.1 samples/s | 74.4 steps/s
[Step=39950 Epoch=153.1] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.319 | L2-Norm(final)=11.395 | 4739.9 samples/s | 74.1 steps/s
[Step=40000 Epoch=153.3] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.298 | L2-Norm(final)=11.395 | 4790.7 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07290 | acc=0.9700 | tpr=0.9807 | fpr=0.0533 | 4214.5 samples/s | 16.5 steps/s
Avg test loss: 0.07581, Avg test acc: 0.96879, Avg tpr: 0.97913, Avg fpr: 0.05397, total FA: 421

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07404 | acc=0.9686 | tpr=0.9732 | fpr=0.0414 | 4161.0 samples/s | 16.3 steps/s
Avg test loss: 0.07977, Avg test acc: 0.96686, Avg tpr: 0.97185, Avg fpr: 0.04410, total FA: 344

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.82195 | acc=0.3270 | tpr=0.0292 | fpr=0.0265 | 4183.8 samples/s | 16.3 steps/s
Avg test loss: 5.82976, Avg test acc: 0.32455, Avg tpr: 0.02885, Avg fpr: 0.02512, total FA: 196

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.64877 | acc=0.3341 | tpr=0.0426 | fpr=0.0327 | 4226.6 samples/s | 16.5 steps/s
Avg test loss: 5.65790, Avg test acc: 0.33192, Avg tpr: 0.04243, Avg fpr: 0.03141, total FA: 245

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.04628 | acc=0.0966 | tpr=0.9513 | fpr=0.9188 | 4136.0 samples/s | 16.2 steps/s
[Step= 100] | Loss=7.03194 | acc=0.0973 | tpr=0.9382 | fpr=0.9184 | 8602.8 samples/s | 33.6 steps/s
[Step= 150] | Loss=7.05348 | acc=0.0974 | tpr=0.9424 | fpr=0.9181 | 7975.8 samples/s | 31.2 steps/s
[Step= 200] | Loss=7.04846 | acc=0.0973 | tpr=0.9432 | fpr=0.9181 | 8763.9 samples/s | 34.2 steps/s
[Step= 250] | Loss=7.04601 | acc=0.0975 | tpr=0.9432 | fpr=0.9179 | 7835.7 samples/s | 30.6 steps/s
[Step= 300] | Loss=7.04929 | acc=0.0977 | tpr=0.9425 | fpr=0.9177 | 8395.5 samples/s | 32.8 steps/s
[Step= 350] | Loss=7.05060 | acc=0.0971 | tpr=0.9443 | fpr=0.9183 | 8399.5 samples/s | 32.8 steps/s
[Step= 400] | Loss=7.05166 | acc=0.0969 | tpr=0.9453 | fpr=0.9185 | 8123.1 samples/s | 31.7 steps/s
[Step= 450] | Loss=7.05477 | acc=0.0970 | tpr=0.9455 | fpr=0.9184 | 8217.6 samples/s | 32.1 steps/s
[Step= 500] | Loss=7.05409 | acc=0.0968 | tpr=0.9458 | fpr=0.9185 | 8165.7 samples/s | 31.9 steps/s
[Step= 550] | Loss=7.05316 | acc=0.0970 | tpr=0.9475 | fpr=0.9185 | 14677.8 samples/s | 57.3 steps/s
Avg test loss: 7.05365, Avg test acc: 0.09692, Avg tpr: 0.94770, Avg fpr: 0.91854, total FA: 127538

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.47365 | acc=0.1075 | tpr=0.9469 | fpr=0.9076 | 4270.6 samples/s | 16.7 steps/s
[Step= 100] | Loss=6.46464 | acc=0.1096 | tpr=0.9339 | fpr=0.9058 | 8163.4 samples/s | 31.9 steps/s
[Step= 150] | Loss=6.48747 | acc=0.1094 | tpr=0.9308 | fpr=0.9057 | 8558.8 samples/s | 33.4 steps/s
[Step= 200] | Loss=6.47954 | acc=0.1094 | tpr=0.9279 | fpr=0.9055 | 8058.5 samples/s | 31.5 steps/s
[Step= 250] | Loss=6.47737 | acc=0.1101 | tpr=0.9284 | fpr=0.9048 | 8461.3 samples/s | 33.1 steps/s
[Step= 300] | Loss=6.48178 | acc=0.1099 | tpr=0.9265 | fpr=0.9050 | 8457.2 samples/s | 33.0 steps/s
[Step= 350] | Loss=6.48349 | acc=0.1095 | tpr=0.9267 | fpr=0.9053 | 8154.5 samples/s | 31.9 steps/s
[Step= 400] | Loss=6.48389 | acc=0.1095 | tpr=0.9261 | fpr=0.9053 | 8687.1 samples/s | 33.9 steps/s
[Step= 450] | Loss=6.48766 | acc=0.1096 | tpr=0.9260 | fpr=0.9052 | 8170.4 samples/s | 31.9 steps/s
[Step= 500] | Loss=6.48776 | acc=0.1097 | tpr=0.9269 | fpr=0.9051 | 8065.5 samples/s | 31.5 steps/s
[Step= 550] | Loss=6.48698 | acc=0.1098 | tpr=0.9284 | fpr=0.9051 | 15303.7 samples/s | 59.8 steps/s
Avg test loss: 6.48792, Avg test acc: 0.10972, Avg tpr: 0.92829, Avg fpr: 0.90516, total FA: 125680

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11272 | acc=0.9816 | tpr=0.9558 | fpr=0.0179 | 4147.3 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.11894 | acc=0.9808 | tpr=0.9574 | fpr=0.0187 | 8543.8 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.12442 | acc=0.9792 | tpr=0.9597 | fpr=0.0204 | 8099.1 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.12542 | acc=0.9792 | tpr=0.9617 | fpr=0.0205 | 8254.2 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.12373 | acc=0.9791 | tpr=0.9581 | fpr=0.0205 | 8483.5 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.12732 | acc=0.9786 | tpr=0.9556 | fpr=0.0210 | 8345.6 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.12752 | acc=0.9786 | tpr=0.9555 | fpr=0.0210 | 8175.0 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.12856 | acc=0.9784 | tpr=0.9530 | fpr=0.0211 | 8356.4 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.13106 | acc=0.9781 | tpr=0.9518 | fpr=0.0214 | 8309.4 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.13041 | acc=0.9782 | tpr=0.9529 | fpr=0.0213 | 8129.6 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.12942 | acc=0.9784 | tpr=0.9511 | fpr=0.0211 | 15658.4 samples/s | 61.2 steps/s
Avg test loss: 0.12921, Avg test acc: 0.97845, Avg tpr: 0.95087, Avg fpr: 0.02105, total FA: 2923

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14997 | acc=0.9779 | tpr=0.9558 | fpr=0.0217 | 4141.2 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.15652 | acc=0.9771 | tpr=0.9552 | fpr=0.0224 | 8402.0 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.16413 | acc=0.9761 | tpr=0.9611 | fpr=0.0236 | 8481.5 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.16581 | acc=0.9762 | tpr=0.9639 | fpr=0.0236 | 8059.7 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.16380 | acc=0.9760 | tpr=0.9607 | fpr=0.0237 | 8366.9 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.16825 | acc=0.9757 | tpr=0.9585 | fpr=0.0240 | 8313.0 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.16877 | acc=0.9757 | tpr=0.9599 | fpr=0.0240 | 8301.7 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.16997 | acc=0.9756 | tpr=0.9584 | fpr=0.0240 | 8639.5 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.17299 | acc=0.9755 | tpr=0.9581 | fpr=0.0242 | 7937.5 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.17223 | acc=0.9756 | tpr=0.9581 | fpr=0.0241 | 8194.4 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.17075 | acc=0.9757 | tpr=0.9570 | fpr=0.0239 | 15210.4 samples/s | 59.4 steps/s
Avg test loss: 0.17050, Avg test acc: 0.97574, Avg tpr: 0.95681, Avg fpr: 0.02391, total FA: 3320

server round 37/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=34001 Epoch=66.5] | Loss=0.01562 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.520 | L2-Norm(final)=10.828 | 3805.6 samples/s | 59.5 steps/s
[Step=34050 Epoch=66.6] | Loss=0.01109 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.520 | L2-Norm(final)=10.833 | 5689.7 samples/s | 88.9 steps/s
[Step=34100 Epoch=66.7] | Loss=0.00986 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.520 | L2-Norm(final)=10.838 | 5779.8 samples/s | 90.3 steps/s
[Step=34150 Epoch=66.8] | Loss=0.01009 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.520 | L2-Norm(final)=10.844 | 5738.8 samples/s | 89.7 steps/s
[Step=34200 Epoch=66.9] | Loss=0.00943 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.520 | L2-Norm(final)=10.849 | 5880.2 samples/s | 91.9 steps/s
[Step=34250 Epoch=67.0] | Loss=0.00932 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.520 | L2-Norm(final)=10.854 | 5710.2 samples/s | 89.2 steps/s
[Step=34300 Epoch=67.1] | Loss=0.00899 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.520 | L2-Norm(final)=10.858 | 5808.6 samples/s | 90.8 steps/s
[Step=34350 Epoch=67.2] | Loss=0.00859 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.520 | L2-Norm(final)=10.863 | 5754.4 samples/s | 89.9 steps/s
[Step=34400 Epoch=67.3] | Loss=0.00891 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.520 | L2-Norm(final)=10.868 | 5767.1 samples/s | 90.1 steps/s
[Step=34450 Epoch=67.3] | Loss=0.00911 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.520 | L2-Norm(final)=10.873 | 5934.3 samples/s | 92.7 steps/s
[Step=34500 Epoch=67.4] | Loss=0.00907 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.520 | L2-Norm(final)=10.878 | 7394.1 samples/s | 115.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=67.4] | Loss=0.00353 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.520 | L2-Norm(final)=10.928 | 3854.2 samples/s | 60.2 steps/s
[Step=34550 Epoch=67.5] | Loss=0.00979 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.530 | L2-Norm(final)=10.931 | 4842.5 samples/s | 75.7 steps/s
[Step=34600 Epoch=67.6] | Loss=0.00920 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.539 | L2-Norm(final)=10.933 | 4981.0 samples/s | 77.8 steps/s
[Step=34650 Epoch=67.7] | Loss=0.00970 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.546 | L2-Norm(final)=10.936 | 4998.5 samples/s | 78.1 steps/s
[Step=34700 Epoch=67.8] | Loss=0.01039 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.553 | L2-Norm(final)=10.938 | 5034.4 samples/s | 78.7 steps/s
[Step=34750 Epoch=67.9] | Loss=0.01023 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.559 | L2-Norm(final)=10.941 | 5036.8 samples/s | 78.7 steps/s
[Step=34800 Epoch=68.0] | Loss=0.01009 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.565 | L2-Norm(final)=10.943 | 5028.3 samples/s | 78.6 steps/s
[Step=34850 Epoch=68.1] | Loss=0.01014 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.570 | L2-Norm(final)=10.946 | 5041.2 samples/s | 78.8 steps/s
[Step=34900 Epoch=68.2] | Loss=0.00980 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.575 | L2-Norm(final)=10.948 | 5164.5 samples/s | 80.7 steps/s
[Step=34950 Epoch=68.3] | Loss=0.00969 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.580 | L2-Norm(final)=10.950 | 5069.7 samples/s | 79.2 steps/s
[Step=35000 Epoch=68.4] | Loss=0.00951 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.584 | L2-Norm(final)=10.953 | 6309.9 samples/s | 98.6 steps/s
[Step=35050 Epoch=68.5] | Loss=0.00926 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.589 | L2-Norm(final)=10.955 | 1956.4 samples/s | 30.6 steps/s
[Step=35100 Epoch=68.6] | Loss=0.00918 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.593 | L2-Norm(final)=10.958 | 4949.5 samples/s | 77.3 steps/s
[Step=35150 Epoch=68.7] | Loss=0.00887 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.597 | L2-Norm(final)=10.960 | 5031.4 samples/s | 78.6 steps/s
[Step=35200 Epoch=68.8] | Loss=0.00856 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.600 | L2-Norm(final)=10.962 | 5012.6 samples/s | 78.3 steps/s
[Step=35250 Epoch=68.9] | Loss=0.00841 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.604 | L2-Norm(final)=10.965 | 5019.0 samples/s | 78.4 steps/s
[Step=35300 Epoch=69.0] | Loss=0.00838 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.607 | L2-Norm(final)=10.967 | 5040.0 samples/s | 78.8 steps/s
[Step=35350 Epoch=69.1] | Loss=0.00825 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.610 | L2-Norm(final)=10.969 | 5047.1 samples/s | 78.9 steps/s
[Step=35400 Epoch=69.2] | Loss=0.00824 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.614 | L2-Norm(final)=10.971 | 4964.3 samples/s | 77.6 steps/s
[Step=35450 Epoch=69.3] | Loss=0.00815 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.617 | L2-Norm(final)=10.974 | 4991.9 samples/s | 78.0 steps/s
[Step=35500 Epoch=69.4] | Loss=0.00802 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.619 | L2-Norm(final)=10.976 | 5408.3 samples/s | 84.5 steps/s
[Step=35550 Epoch=69.5] | Loss=0.00795 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.622 | L2-Norm(final)=10.978 | 2032.8 samples/s | 31.8 steps/s
[Step=35600 Epoch=69.6] | Loss=0.00788 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.625 | L2-Norm(final)=10.980 | 5016.3 samples/s | 78.4 steps/s
[Step=35650 Epoch=69.7] | Loss=0.00778 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.628 | L2-Norm(final)=10.982 | 5088.3 samples/s | 79.5 steps/s
[Step=35700 Epoch=69.8] | Loss=0.00763 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.630 | L2-Norm(final)=10.984 | 5018.9 samples/s | 78.4 steps/s
[Step=35750 Epoch=69.9] | Loss=0.00757 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.633 | L2-Norm(final)=10.986 | 4964.5 samples/s | 77.6 steps/s
[Step=35800 Epoch=70.0] | Loss=0.00753 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.635 | L2-Norm(final)=10.988 | 5016.2 samples/s | 78.4 steps/s
[Step=35850 Epoch=70.1] | Loss=0.00744 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.638 | L2-Norm(final)=10.990 | 5043.3 samples/s | 78.8 steps/s
[Step=35900 Epoch=70.2] | Loss=0.00741 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.640 | L2-Norm(final)=10.992 | 5068.9 samples/s | 79.2 steps/s
[Step=35950 Epoch=70.3] | Loss=0.00740 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.643 | L2-Norm(final)=10.994 | 4976.3 samples/s | 77.8 steps/s
[Step=36000 Epoch=70.4] | Loss=0.00734 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.645 | L2-Norm(final)=10.996 | 5081.1 samples/s | 79.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step36000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=40001 Epoch=153.3] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.520 | L2-Norm(final)=11.414 | 3943.6 samples/s | 61.6 steps/s
[Step=40050 Epoch=153.5] | Loss=0.00005 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.513 | L2-Norm(final)=11.427 | 4981.8 samples/s | 77.8 steps/s
[Step=40100 Epoch=153.6] | Loss=0.00004 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.512 | L2-Norm(final)=11.437 | 5385.7 samples/s | 84.2 steps/s
[Step=40150 Epoch=153.8] | Loss=0.00004 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.512 | L2-Norm(final)=11.444 | 5491.7 samples/s | 85.8 steps/s
[Step=40200 Epoch=154.0] | Loss=0.00003 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.512 | L2-Norm(final)=11.451 | 5415.2 samples/s | 84.6 steps/s
[Step=40250 Epoch=154.2] | Loss=0.00005 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.511 | L2-Norm(final)=11.459 | 7352.4 samples/s | 114.9 steps/s
[Step=40300 Epoch=154.4] | Loss=0.00005 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.511 | L2-Norm(final)=11.469 | 1989.6 samples/s | 31.1 steps/s
[Step=40350 Epoch=154.6] | Loss=0.00005 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.511 | L2-Norm(final)=11.478 | 5560.2 samples/s | 86.9 steps/s
[Step=40400 Epoch=154.8] | Loss=0.00005 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.511 | L2-Norm(final)=11.487 | 5472.2 samples/s | 85.5 steps/s
[Step=40450 Epoch=155.0] | Loss=0.00005 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.511 | L2-Norm(final)=11.495 | 5383.8 samples/s | 84.1 steps/s
[Step=40500 Epoch=155.2] | Loss=0.00005 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.511 | L2-Norm(final)=11.502 | 6234.1 samples/s | 97.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=40501 Epoch=155.2] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.511 | L2-Norm(final)=11.574 | 4086.3 samples/s | 63.8 steps/s
[Step=40550 Epoch=155.4] | Loss=0.00016 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.505 | L2-Norm(final)=11.578 | 4205.6 samples/s | 65.7 steps/s
[Step=40600 Epoch=155.6] | Loss=0.00010 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.507 | L2-Norm(final)=11.580 | 4747.1 samples/s | 74.2 steps/s
[Step=40650 Epoch=155.8] | Loss=0.00039 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.505 | L2-Norm(final)=11.582 | 4834.2 samples/s | 75.5 steps/s
[Step=40700 Epoch=155.9] | Loss=0.00032 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.507 | L2-Norm(final)=11.582 | 4678.1 samples/s | 73.1 steps/s
[Step=40750 Epoch=156.1] | Loss=0.00026 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.507 | L2-Norm(final)=11.583 | 6082.7 samples/s | 95.0 steps/s
[Step=40800 Epoch=156.3] | Loss=0.00022 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.507 | L2-Norm(final)=11.583 | 1887.2 samples/s | 29.5 steps/s
[Step=40850 Epoch=156.5] | Loss=0.00019 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.505 | L2-Norm(final)=11.584 | 4802.2 samples/s | 75.0 steps/s
[Step=40900 Epoch=156.7] | Loss=0.00017 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=11.584 | 4795.9 samples/s | 74.9 steps/s
[Step=40950 Epoch=156.9] | Loss=0.00015 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.501 | L2-Norm(final)=11.584 | 4723.1 samples/s | 73.8 steps/s
[Step=41000 Epoch=157.1] | Loss=0.00013 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.498 | L2-Norm(final)=11.585 | 5244.6 samples/s | 81.9 steps/s
[Step=41050 Epoch=157.3] | Loss=0.00012 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.496 | L2-Norm(final)=11.585 | 1969.3 samples/s | 30.8 steps/s
[Step=41100 Epoch=157.5] | Loss=0.00011 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.493 | L2-Norm(final)=11.585 | 4848.4 samples/s | 75.8 steps/s
[Step=41150 Epoch=157.7] | Loss=0.00010 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.490 | L2-Norm(final)=11.586 | 4751.8 samples/s | 74.2 steps/s
[Step=41200 Epoch=157.9] | Loss=0.00010 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.487 | L2-Norm(final)=11.586 | 4774.8 samples/s | 74.6 steps/s
[Step=41250 Epoch=158.1] | Loss=0.00009 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.484 | L2-Norm(final)=11.586 | 4755.1 samples/s | 74.3 steps/s
[Step=41300 Epoch=158.2] | Loss=0.00008 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.480 | L2-Norm(final)=11.587 | 2034.6 samples/s | 31.8 steps/s
[Step=41350 Epoch=158.4] | Loss=0.00008 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.477 | L2-Norm(final)=11.587 | 4878.5 samples/s | 76.2 steps/s
[Step=41400 Epoch=158.6] | Loss=0.00008 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.473 | L2-Norm(final)=11.587 | 4751.5 samples/s | 74.2 steps/s
[Step=41450 Epoch=158.8] | Loss=0.00007 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.470 | L2-Norm(final)=11.588 | 4772.4 samples/s | 74.6 steps/s
[Step=41500 Epoch=159.0] | Loss=0.00007 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.466 | L2-Norm(final)=11.588 | 4843.4 samples/s | 75.7 steps/s
[Step=41550 Epoch=159.2] | Loss=0.00006 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.463 | L2-Norm(final)=11.588 | 2069.8 samples/s | 32.3 steps/s
[Step=41600 Epoch=159.4] | Loss=0.00006 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.459 | L2-Norm(final)=11.588 | 4862.1 samples/s | 76.0 steps/s
[Step=41650 Epoch=159.6] | Loss=0.00006 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.455 | L2-Norm(final)=11.589 | 4752.5 samples/s | 74.3 steps/s
[Step=41700 Epoch=159.8] | Loss=0.00006 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.451 | L2-Norm(final)=11.589 | 4744.5 samples/s | 74.1 steps/s
[Step=41750 Epoch=160.0] | Loss=0.00005 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.447 | L2-Norm(final)=11.589 | 4789.4 samples/s | 74.8 steps/s
[Step=41800 Epoch=160.2] | Loss=0.00005 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.443 | L2-Norm(final)=11.590 | 6555.5 samples/s | 102.4 steps/s
[Step=41850 Epoch=160.4] | Loss=0.00005 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.439 | L2-Norm(final)=11.590 | 1851.5 samples/s | 28.9 steps/s
[Step=41900 Epoch=160.5] | Loss=0.00005 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.435 | L2-Norm(final)=11.590 | 4692.3 samples/s | 73.3 steps/s
[Step=41950 Epoch=160.7] | Loss=0.00005 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.431 | L2-Norm(final)=11.591 | 4776.0 samples/s | 74.6 steps/s
[Step=42000 Epoch=160.9] | Loss=0.00005 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.427 | L2-Norm(final)=11.591 | 4777.4 samples/s | 74.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step42000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07290 | acc=0.9700 | tpr=0.9807 | fpr=0.0533 | 4156.7 samples/s | 16.2 steps/s
Avg test loss: 0.07581, Avg test acc: 0.96879, Avg tpr: 0.97913, Avg fpr: 0.05397, total FA: 421

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06927 | acc=0.9691 | tpr=0.9770 | fpr=0.0478 | 4261.3 samples/s | 16.6 steps/s
Avg test loss: 0.07486, Avg test acc: 0.96803, Avg tpr: 0.97645, Avg fpr: 0.05051, total FA: 394

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.43638 | acc=0.3280 | tpr=0.0308 | fpr=0.0268 | 4231.7 samples/s | 16.5 steps/s
Avg test loss: 6.43940, Avg test acc: 0.32587, Avg tpr: 0.03130, Avg fpr: 0.02628, total FA: 205

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.64877 | acc=0.3341 | tpr=0.0426 | fpr=0.0327 | 4210.2 samples/s | 16.4 steps/s
Avg test loss: 5.65790, Avg test acc: 0.33192, Avg tpr: 0.04243, Avg fpr: 0.03141, total FA: 245

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.04628 | acc=0.0966 | tpr=0.9513 | fpr=0.9188 | 4177.4 samples/s | 16.3 steps/s
[Step= 100] | Loss=7.03194 | acc=0.0973 | tpr=0.9382 | fpr=0.9184 | 8223.0 samples/s | 32.1 steps/s
[Step= 150] | Loss=7.05348 | acc=0.0974 | tpr=0.9424 | fpr=0.9181 | 8335.9 samples/s | 32.6 steps/s
[Step= 200] | Loss=7.04846 | acc=0.0973 | tpr=0.9432 | fpr=0.9181 | 8234.9 samples/s | 32.2 steps/s
[Step= 250] | Loss=7.04601 | acc=0.0975 | tpr=0.9432 | fpr=0.9179 | 8521.8 samples/s | 33.3 steps/s
[Step= 300] | Loss=7.04929 | acc=0.0977 | tpr=0.9425 | fpr=0.9177 | 8408.7 samples/s | 32.8 steps/s
[Step= 350] | Loss=7.05060 | acc=0.0971 | tpr=0.9443 | fpr=0.9183 | 8228.6 samples/s | 32.1 steps/s
[Step= 400] | Loss=7.05166 | acc=0.0969 | tpr=0.9453 | fpr=0.9185 | 9311.8 samples/s | 36.4 steps/s
[Step= 450] | Loss=7.05477 | acc=0.0970 | tpr=0.9455 | fpr=0.9184 | 7675.5 samples/s | 30.0 steps/s
[Step= 500] | Loss=7.05409 | acc=0.0968 | tpr=0.9458 | fpr=0.9185 | 7929.7 samples/s | 31.0 steps/s
[Step= 550] | Loss=7.05316 | acc=0.0970 | tpr=0.9475 | fpr=0.9185 | 15441.2 samples/s | 60.3 steps/s
Avg test loss: 7.05365, Avg test acc: 0.09692, Avg tpr: 0.94770, Avg fpr: 0.91854, total FA: 127538

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.36973 | acc=0.0986 | tpr=0.9602 | fpr=0.9169 | 4174.3 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.36145 | acc=0.0998 | tpr=0.9446 | fpr=0.9160 | 8257.7 samples/s | 32.3 steps/s
[Step= 150] | Loss=6.38548 | acc=0.0996 | tpr=0.9409 | fpr=0.9159 | 8289.1 samples/s | 32.4 steps/s
[Step= 200] | Loss=6.37527 | acc=0.0998 | tpr=0.9388 | fpr=0.9154 | 8300.0 samples/s | 32.4 steps/s
[Step= 250] | Loss=6.37448 | acc=0.1002 | tpr=0.9389 | fpr=0.9151 | 8046.9 samples/s | 31.4 steps/s
[Step= 300] | Loss=6.37703 | acc=0.1002 | tpr=0.9389 | fpr=0.9151 | 8490.3 samples/s | 33.2 steps/s
[Step= 350] | Loss=6.37888 | acc=0.0998 | tpr=0.9380 | fpr=0.9154 | 8367.3 samples/s | 32.7 steps/s
[Step= 400] | Loss=6.37981 | acc=0.0998 | tpr=0.9371 | fpr=0.9154 | 8071.9 samples/s | 31.5 steps/s
[Step= 450] | Loss=6.38321 | acc=0.1000 | tpr=0.9362 | fpr=0.9152 | 8562.9 samples/s | 33.4 steps/s
[Step= 500] | Loss=6.38342 | acc=0.1000 | tpr=0.9374 | fpr=0.9152 | 7963.8 samples/s | 31.1 steps/s
[Step= 550] | Loss=6.38255 | acc=0.1001 | tpr=0.9399 | fpr=0.9152 | 15856.9 samples/s | 61.9 steps/s
Avg test loss: 6.38319, Avg test acc: 0.10005, Avg tpr: 0.94017, Avg fpr: 0.91522, total FA: 127077

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12263 | acc=0.9821 | tpr=0.9513 | fpr=0.0173 | 4199.8 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.12887 | acc=0.9814 | tpr=0.9488 | fpr=0.0179 | 8217.1 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.13426 | acc=0.9806 | tpr=0.9539 | fpr=0.0189 | 8332.7 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.13587 | acc=0.9804 | tpr=0.9552 | fpr=0.0192 | 8323.9 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.13376 | acc=0.9803 | tpr=0.9537 | fpr=0.0192 | 8479.3 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.13706 | acc=0.9800 | tpr=0.9505 | fpr=0.0194 | 8272.5 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.13732 | acc=0.9800 | tpr=0.9505 | fpr=0.0195 | 8487.0 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.13884 | acc=0.9798 | tpr=0.9491 | fpr=0.0196 | 8148.9 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.14198 | acc=0.9795 | tpr=0.9469 | fpr=0.0199 | 8154.0 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.14141 | acc=0.9796 | tpr=0.9480 | fpr=0.0198 | 8417.3 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.14025 | acc=0.9798 | tpr=0.9463 | fpr=0.0196 | 14610.0 samples/s | 57.1 steps/s
Avg test loss: 0.13995, Avg test acc: 0.97981, Avg tpr: 0.94612, Avg fpr: 0.01958, total FA: 2718

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14997 | acc=0.9779 | tpr=0.9558 | fpr=0.0217 | 4234.1 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.15652 | acc=0.9771 | tpr=0.9552 | fpr=0.0224 | 8449.9 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.16413 | acc=0.9761 | tpr=0.9611 | fpr=0.0236 | 8098.6 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.16581 | acc=0.9762 | tpr=0.9639 | fpr=0.0236 | 8248.5 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.16380 | acc=0.9760 | tpr=0.9607 | fpr=0.0237 | 8199.0 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.16825 | acc=0.9757 | tpr=0.9585 | fpr=0.0240 | 8381.9 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.16877 | acc=0.9757 | tpr=0.9599 | fpr=0.0240 | 8354.9 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.16997 | acc=0.9756 | tpr=0.9584 | fpr=0.0240 | 8506.9 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.17299 | acc=0.9755 | tpr=0.9581 | fpr=0.0242 | 8228.6 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.17223 | acc=0.9756 | tpr=0.9581 | fpr=0.0241 | 8072.9 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.17075 | acc=0.9757 | tpr=0.9570 | fpr=0.0239 | 15135.5 samples/s | 59.1 steps/s
Avg test loss: 0.17050, Avg test acc: 0.97574, Avg tpr: 0.95681, Avg fpr: 0.02391, total FA: 3320

server round 38/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=44001 Epoch=85.8] | Loss=0.00061 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=11.178 | 3660.8 samples/s | 57.2 steps/s
[Step=44050 Epoch=85.9] | Loss=0.01255 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=11.180 | 5563.8 samples/s | 86.9 steps/s
[Step=44100 Epoch=86.0] | Loss=0.01096 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=11.182 | 5909.0 samples/s | 92.3 steps/s
[Step=44150 Epoch=86.1] | Loss=0.01038 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.601 | L2-Norm(final)=11.185 | 5736.6 samples/s | 89.6 steps/s
[Step=44200 Epoch=86.2] | Loss=0.01031 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=11.188 | 5785.7 samples/s | 90.4 steps/s
[Step=44250 Epoch=86.3] | Loss=0.01030 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=11.191 | 5818.4 samples/s | 90.9 steps/s
[Step=44300 Epoch=86.4] | Loss=0.01048 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=11.194 | 5912.3 samples/s | 92.4 steps/s
[Step=44350 Epoch=86.5] | Loss=0.01078 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=11.197 | 5691.3 samples/s | 88.9 steps/s
[Step=44400 Epoch=86.6] | Loss=0.01090 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=11.200 | 5709.7 samples/s | 89.2 steps/s
[Step=44450 Epoch=86.7] | Loss=0.01070 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=11.203 | 5761.8 samples/s | 90.0 steps/s
[Step=44500 Epoch=86.8] | Loss=0.01090 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.601 | L2-Norm(final)=11.206 | 7285.5 samples/s | 113.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=44501 Epoch=86.8] | Loss=0.00139 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=11.235 | 3725.1 samples/s | 58.2 steps/s
[Step=44550 Epoch=86.9] | Loss=0.00970 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.610 | L2-Norm(final)=11.236 | 4703.8 samples/s | 73.5 steps/s
[Step=44600 Epoch=87.0] | Loss=0.01013 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.618 | L2-Norm(final)=11.237 | 5129.9 samples/s | 80.2 steps/s
[Step=44650 Epoch=87.1] | Loss=0.00930 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.625 | L2-Norm(final)=11.238 | 4983.4 samples/s | 77.9 steps/s
[Step=44700 Epoch=87.2] | Loss=0.00964 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.631 | L2-Norm(final)=11.240 | 5015.2 samples/s | 78.4 steps/s
[Step=44750 Epoch=87.3] | Loss=0.00955 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.636 | L2-Norm(final)=11.242 | 5072.5 samples/s | 79.3 steps/s
[Step=44800 Epoch=87.4] | Loss=0.00948 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.642 | L2-Norm(final)=11.244 | 5077.6 samples/s | 79.3 steps/s
[Step=44850 Epoch=87.5] | Loss=0.00957 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.647 | L2-Norm(final)=11.246 | 5054.8 samples/s | 79.0 steps/s
[Step=44900 Epoch=87.6] | Loss=0.00967 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.652 | L2-Norm(final)=11.248 | 5038.7 samples/s | 78.7 steps/s
[Step=44950 Epoch=87.7] | Loss=0.00945 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.656 | L2-Norm(final)=11.249 | 4988.1 samples/s | 77.9 steps/s
[Step=45000 Epoch=87.8] | Loss=0.00933 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.660 | L2-Norm(final)=11.251 | 6120.1 samples/s | 95.6 steps/s
[Step=45050 Epoch=87.9] | Loss=0.00928 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.664 | L2-Norm(final)=11.252 | 1922.4 samples/s | 30.0 steps/s
[Step=45100 Epoch=88.0] | Loss=0.00912 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.668 | L2-Norm(final)=11.254 | 4992.1 samples/s | 78.0 steps/s
[Step=45150 Epoch=88.1] | Loss=0.00884 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=11.256 | 4976.0 samples/s | 77.8 steps/s
[Step=45200 Epoch=88.2] | Loss=0.00865 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.674 | L2-Norm(final)=11.257 | 5089.0 samples/s | 79.5 steps/s
[Step=45250 Epoch=88.3] | Loss=0.00860 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.678 | L2-Norm(final)=11.259 | 4973.4 samples/s | 77.7 steps/s
[Step=45300 Epoch=88.4] | Loss=0.00865 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.681 | L2-Norm(final)=11.261 | 5050.1 samples/s | 78.9 steps/s
[Step=45350 Epoch=88.5] | Loss=0.00853 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=11.262 | 5002.9 samples/s | 78.2 steps/s
[Step=45400 Epoch=88.5] | Loss=0.00844 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.686 | L2-Norm(final)=11.264 | 4984.1 samples/s | 77.9 steps/s
[Step=45450 Epoch=88.6] | Loss=0.00837 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.689 | L2-Norm(final)=11.265 | 5078.1 samples/s | 79.3 steps/s
[Step=45500 Epoch=88.7] | Loss=0.00835 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.691 | L2-Norm(final)=11.266 | 5318.4 samples/s | 83.1 steps/s
[Step=45550 Epoch=88.8] | Loss=0.00819 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.694 | L2-Norm(final)=11.268 | 1964.1 samples/s | 30.7 steps/s
[Step=45600 Epoch=88.9] | Loss=0.00802 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=11.269 | 5060.6 samples/s | 79.1 steps/s
[Step=45650 Epoch=89.0] | Loss=0.00790 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.699 | L2-Norm(final)=11.271 | 5044.7 samples/s | 78.8 steps/s
[Step=45700 Epoch=89.1] | Loss=0.00780 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.701 | L2-Norm(final)=11.273 | 5015.8 samples/s | 78.4 steps/s
[Step=45750 Epoch=89.2] | Loss=0.00779 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=11.274 | 5015.5 samples/s | 78.4 steps/s
[Step=45800 Epoch=89.3] | Loss=0.00772 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.706 | L2-Norm(final)=11.276 | 5036.6 samples/s | 78.7 steps/s
[Step=45850 Epoch=89.4] | Loss=0.00763 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.708 | L2-Norm(final)=11.277 | 5070.0 samples/s | 79.2 steps/s
[Step=45900 Epoch=89.5] | Loss=0.00757 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.711 | L2-Norm(final)=11.279 | 5030.7 samples/s | 78.6 steps/s
[Step=45950 Epoch=89.6] | Loss=0.00744 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.713 | L2-Norm(final)=11.281 | 5071.6 samples/s | 79.2 steps/s
[Step=46000 Epoch=89.7] | Loss=0.00746 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.715 | L2-Norm(final)=11.282 | 5007.1 samples/s | 78.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step46000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=36001 Epoch=70.4] | Loss=0.02596 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.601 | L2-Norm(final)=11.051 | 3917.8 samples/s | 61.2 steps/s
[Step=36050 Epoch=70.5] | Loss=0.00934 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=11.052 | 5377.6 samples/s | 84.0 steps/s
[Step=36100 Epoch=70.6] | Loss=0.01033 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.601 | L2-Norm(final)=11.054 | 5822.1 samples/s | 91.0 steps/s
[Step=36150 Epoch=70.7] | Loss=0.00935 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.601 | L2-Norm(final)=11.057 | 5718.3 samples/s | 89.3 steps/s
[Step=36200 Epoch=70.8] | Loss=0.00913 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=11.060 | 5871.7 samples/s | 91.7 steps/s
[Step=36250 Epoch=70.9] | Loss=0.00932 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=11.064 | 5788.0 samples/s | 90.4 steps/s
[Step=36300 Epoch=71.0] | Loss=0.00953 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.601 | L2-Norm(final)=11.068 | 5942.7 samples/s | 92.9 steps/s
[Step=36350 Epoch=71.1] | Loss=0.00970 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=11.071 | 5713.9 samples/s | 89.3 steps/s
[Step=36400 Epoch=71.2] | Loss=0.00982 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=11.075 | 5770.4 samples/s | 90.2 steps/s
[Step=36450 Epoch=71.3] | Loss=0.00985 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=11.078 | 5813.7 samples/s | 90.8 steps/s
[Step=36500 Epoch=71.4] | Loss=0.00974 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=11.082 | 7523.4 samples/s | 117.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=71.4] | Loss=0.00528 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=11.119 | 4007.4 samples/s | 62.6 steps/s
[Step=36550 Epoch=71.5] | Loss=0.01185 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.609 | L2-Norm(final)=11.121 | 4631.8 samples/s | 72.4 steps/s
[Step=36600 Epoch=71.6] | Loss=0.01125 | Reg=0.00135 | acc=0.9531 | L2-Norm=11.618 | L2-Norm(final)=11.121 | 5035.6 samples/s | 78.7 steps/s
[Step=36650 Epoch=71.6] | Loss=0.00992 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.625 | L2-Norm(final)=11.122 | 5025.9 samples/s | 78.5 steps/s
[Step=36700 Epoch=71.7] | Loss=0.00958 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.631 | L2-Norm(final)=11.125 | 4855.0 samples/s | 75.9 steps/s
[Step=36750 Epoch=71.8] | Loss=0.00948 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.637 | L2-Norm(final)=11.127 | 4973.1 samples/s | 77.7 steps/s
[Step=36800 Epoch=71.9] | Loss=0.00929 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.642 | L2-Norm(final)=11.130 | 5084.5 samples/s | 79.4 steps/s
[Step=36850 Epoch=72.0] | Loss=0.00941 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.647 | L2-Norm(final)=11.132 | 5061.3 samples/s | 79.1 steps/s
[Step=36900 Epoch=72.1] | Loss=0.00938 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.652 | L2-Norm(final)=11.133 | 4962.8 samples/s | 77.5 steps/s
[Step=36950 Epoch=72.2] | Loss=0.00924 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.656 | L2-Norm(final)=11.135 | 5047.9 samples/s | 78.9 steps/s
[Step=37000 Epoch=72.3] | Loss=0.00933 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.660 | L2-Norm(final)=11.136 | 6281.4 samples/s | 98.1 steps/s
[Step=37050 Epoch=72.4] | Loss=0.00912 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.664 | L2-Norm(final)=11.138 | 1927.7 samples/s | 30.1 steps/s
[Step=37100 Epoch=72.5] | Loss=0.00889 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.668 | L2-Norm(final)=11.140 | 5030.8 samples/s | 78.6 steps/s
[Step=37150 Epoch=72.6] | Loss=0.00871 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=11.142 | 5057.6 samples/s | 79.0 steps/s
[Step=37200 Epoch=72.7] | Loss=0.00838 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.674 | L2-Norm(final)=11.143 | 5005.1 samples/s | 78.2 steps/s
[Step=37250 Epoch=72.8] | Loss=0.00840 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.677 | L2-Norm(final)=11.145 | 5004.3 samples/s | 78.2 steps/s
[Step=37300 Epoch=72.9] | Loss=0.00833 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.680 | L2-Norm(final)=11.147 | 5052.8 samples/s | 78.9 steps/s
[Step=37350 Epoch=73.0] | Loss=0.00817 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.682 | L2-Norm(final)=11.148 | 5003.3 samples/s | 78.2 steps/s
[Step=37400 Epoch=73.1] | Loss=0.00816 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.685 | L2-Norm(final)=11.150 | 4991.0 samples/s | 78.0 steps/s
[Step=37450 Epoch=73.2] | Loss=0.00803 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.688 | L2-Norm(final)=11.152 | 4994.8 samples/s | 78.0 steps/s
[Step=37500 Epoch=73.3] | Loss=0.00798 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.690 | L2-Norm(final)=11.153 | 5481.4 samples/s | 85.6 steps/s
[Step=37550 Epoch=73.4] | Loss=0.00782 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.693 | L2-Norm(final)=11.155 | 1993.7 samples/s | 31.2 steps/s
[Step=37600 Epoch=73.5] | Loss=0.00767 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.695 | L2-Norm(final)=11.156 | 4861.3 samples/s | 76.0 steps/s
[Step=37650 Epoch=73.6] | Loss=0.00761 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.698 | L2-Norm(final)=11.158 | 4940.4 samples/s | 77.2 steps/s
[Step=37700 Epoch=73.7] | Loss=0.00757 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.700 | L2-Norm(final)=11.159 | 5008.6 samples/s | 78.3 steps/s
[Step=37750 Epoch=73.8] | Loss=0.00748 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.702 | L2-Norm(final)=11.161 | 5031.1 samples/s | 78.6 steps/s
[Step=37800 Epoch=73.9] | Loss=0.00740 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=11.162 | 5051.4 samples/s | 78.9 steps/s
[Step=37850 Epoch=74.0] | Loss=0.00733 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.707 | L2-Norm(final)=11.164 | 4968.0 samples/s | 77.6 steps/s
[Step=37900 Epoch=74.1] | Loss=0.00724 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.709 | L2-Norm(final)=11.166 | 5049.1 samples/s | 78.9 steps/s
[Step=37950 Epoch=74.2] | Loss=0.00716 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.711 | L2-Norm(final)=11.167 | 5085.3 samples/s | 79.5 steps/s
[Step=38000 Epoch=74.3] | Loss=0.00713 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.713 | L2-Norm(final)=11.169 | 4935.2 samples/s | 77.1 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step38000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07346 | acc=0.9686 | tpr=0.9797 | fpr=0.0555 | 4216.0 samples/s | 16.5 steps/s
Avg test loss: 0.07678, Avg test acc: 0.96779, Avg tpr: 0.97884, Avg fpr: 0.05653, total FA: 441

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07538 | acc=0.9686 | tpr=0.9785 | fpr=0.0530 | 4192.6 samples/s | 16.4 steps/s
Avg test loss: 0.07966, Avg test acc: 0.96799, Avg tpr: 0.97826, Avg fpr: 0.05461, total FA: 426

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.43638 | acc=0.3280 | tpr=0.0308 | fpr=0.0268 | 4222.9 samples/s | 16.5 steps/s
Avg test loss: 6.43940, Avg test acc: 0.32587, Avg tpr: 0.03130, Avg fpr: 0.02628, total FA: 205

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.64877 | acc=0.3341 | tpr=0.0426 | fpr=0.0327 | 4183.1 samples/s | 16.3 steps/s
Avg test loss: 5.65790, Avg test acc: 0.33192, Avg tpr: 0.04243, Avg fpr: 0.03141, total FA: 245

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.01927 | acc=0.0930 | tpr=0.9602 | fpr=0.9225 | 4220.6 samples/s | 16.5 steps/s
[Step= 100] | Loss=7.00617 | acc=0.0942 | tpr=0.9510 | fpr=0.9218 | 8289.8 samples/s | 32.4 steps/s
[Step= 150] | Loss=7.02660 | acc=0.0946 | tpr=0.9510 | fpr=0.9212 | 8292.5 samples/s | 32.4 steps/s
[Step= 200] | Loss=7.01972 | acc=0.0948 | tpr=0.9519 | fpr=0.9208 | 8506.9 samples/s | 33.2 steps/s
[Step= 250] | Loss=7.01815 | acc=0.0951 | tpr=0.9528 | fpr=0.9205 | 8013.0 samples/s | 31.3 steps/s
[Step= 300] | Loss=7.01997 | acc=0.0951 | tpr=0.9527 | fpr=0.9206 | 8279.8 samples/s | 32.3 steps/s
[Step= 350] | Loss=7.02079 | acc=0.0945 | tpr=0.9537 | fpr=0.9211 | 8536.1 samples/s | 33.3 steps/s
[Step= 400] | Loss=7.02239 | acc=0.0944 | tpr=0.9546 | fpr=0.9213 | 8327.6 samples/s | 32.5 steps/s
[Step= 450] | Loss=7.02470 | acc=0.0945 | tpr=0.9547 | fpr=0.9211 | 8298.4 samples/s | 32.4 steps/s
[Step= 500] | Loss=7.02488 | acc=0.0944 | tpr=0.9555 | fpr=0.9212 | 8147.0 samples/s | 31.8 steps/s
[Step= 550] | Loss=7.02364 | acc=0.0945 | tpr=0.9570 | fpr=0.9212 | 15272.7 samples/s | 59.7 steps/s
Avg test loss: 7.02422, Avg test acc: 0.09445, Avg tpr: 0.95721, Avg fpr: 0.92124, total FA: 127912

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.77771 | acc=0.0952 | tpr=0.9513 | fpr=0.9202 | 4166.5 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.76994 | acc=0.0966 | tpr=0.9382 | fpr=0.9191 | 8398.8 samples/s | 32.8 steps/s
[Step= 150] | Loss=6.78981 | acc=0.0966 | tpr=0.9395 | fpr=0.9189 | 7999.0 samples/s | 31.2 steps/s
[Step= 200] | Loss=6.77998 | acc=0.0968 | tpr=0.9388 | fpr=0.9185 | 8285.1 samples/s | 32.4 steps/s
[Step= 250] | Loss=6.78036 | acc=0.0972 | tpr=0.9406 | fpr=0.9182 | 8694.6 samples/s | 34.0 steps/s
[Step= 300] | Loss=6.78405 | acc=0.0972 | tpr=0.9360 | fpr=0.9181 | 7942.3 samples/s | 31.0 steps/s
[Step= 350] | Loss=6.78558 | acc=0.0968 | tpr=0.9343 | fpr=0.9184 | 8591.3 samples/s | 33.6 steps/s
[Step= 400] | Loss=6.78636 | acc=0.0968 | tpr=0.9344 | fpr=0.9185 | 8467.3 samples/s | 33.1 steps/s
[Step= 450] | Loss=6.78977 | acc=0.0969 | tpr=0.9338 | fpr=0.9183 | 8606.4 samples/s | 33.6 steps/s
[Step= 500] | Loss=6.78961 | acc=0.0969 | tpr=0.9348 | fpr=0.9183 | 7805.0 samples/s | 30.5 steps/s
[Step= 550] | Loss=6.78882 | acc=0.0969 | tpr=0.9367 | fpr=0.9183 | 15266.8 samples/s | 59.6 steps/s
Avg test loss: 6.78955, Avg test acc: 0.09690, Avg tpr: 0.93661, Avg fpr: 0.91836, total FA: 127513

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12263 | acc=0.9821 | tpr=0.9513 | fpr=0.0173 | 4156.9 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.12887 | acc=0.9814 | tpr=0.9488 | fpr=0.0179 | 8170.4 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.13426 | acc=0.9806 | tpr=0.9539 | fpr=0.0189 | 8284.2 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.13587 | acc=0.9804 | tpr=0.9552 | fpr=0.0192 | 8203.1 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.13376 | acc=0.9803 | tpr=0.9537 | fpr=0.0192 | 8350.9 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.13706 | acc=0.9800 | tpr=0.9505 | fpr=0.0194 | 8311.4 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.13732 | acc=0.9800 | tpr=0.9505 | fpr=0.0195 | 8231.8 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.13884 | acc=0.9798 | tpr=0.9491 | fpr=0.0196 | 8147.5 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.14198 | acc=0.9795 | tpr=0.9469 | fpr=0.0199 | 8275.5 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.14141 | acc=0.9796 | tpr=0.9480 | fpr=0.0198 | 8145.5 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.14025 | acc=0.9798 | tpr=0.9463 | fpr=0.0196 | 15025.3 samples/s | 58.7 steps/s
Avg test loss: 0.13995, Avg test acc: 0.97981, Avg tpr: 0.94612, Avg fpr: 0.01958, total FA: 2718

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14997 | acc=0.9779 | tpr=0.9558 | fpr=0.0217 | 4139.8 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.15652 | acc=0.9771 | tpr=0.9552 | fpr=0.0224 | 8246.8 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.16413 | acc=0.9761 | tpr=0.9611 | fpr=0.0236 | 8599.4 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.16581 | acc=0.9762 | tpr=0.9639 | fpr=0.0236 | 8194.0 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.16380 | acc=0.9760 | tpr=0.9607 | fpr=0.0237 | 8603.1 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.16825 | acc=0.9757 | tpr=0.9585 | fpr=0.0240 | 8260.6 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.16877 | acc=0.9757 | tpr=0.9599 | fpr=0.0240 | 8266.3 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.16997 | acc=0.9756 | tpr=0.9584 | fpr=0.0240 | 8157.7 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.17299 | acc=0.9755 | tpr=0.9581 | fpr=0.0242 | 8419.2 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.17223 | acc=0.9756 | tpr=0.9581 | fpr=0.0241 | 8836.2 samples/s | 34.5 steps/s
[Step= 550] | Loss=0.17075 | acc=0.9757 | tpr=0.9570 | fpr=0.0239 | 14049.6 samples/s | 54.9 steps/s
Avg test loss: 0.17050, Avg test acc: 0.97574, Avg tpr: 0.95681, Avg fpr: 0.02391, total FA: 3320

server round 39/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=46001 Epoch=89.7] | Loss=0.00605 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.510 | L2-Norm(final)=11.331 | 3687.3 samples/s | 57.6 steps/s
[Step=46050 Epoch=89.8] | Loss=0.01072 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.509 | L2-Norm(final)=11.331 | 5132.4 samples/s | 80.2 steps/s
[Step=46100 Epoch=89.9] | Loss=0.01014 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.510 | L2-Norm(final)=11.335 | 5594.5 samples/s | 87.4 steps/s
[Step=46150 Epoch=90.0] | Loss=0.01110 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.510 | L2-Norm(final)=11.338 | 5667.3 samples/s | 88.6 steps/s
[Step=46200 Epoch=90.1] | Loss=0.01041 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.510 | L2-Norm(final)=11.341 | 5655.9 samples/s | 88.4 steps/s
[Step=46250 Epoch=90.2] | Loss=0.01005 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.510 | L2-Norm(final)=11.345 | 5778.3 samples/s | 90.3 steps/s
[Step=46300 Epoch=90.3] | Loss=0.01059 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.510 | L2-Norm(final)=11.348 | 5874.0 samples/s | 91.8 steps/s
[Step=46350 Epoch=90.4] | Loss=0.01082 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.510 | L2-Norm(final)=11.351 | 5769.0 samples/s | 90.1 steps/s
[Step=46400 Epoch=90.5] | Loss=0.01065 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.510 | L2-Norm(final)=11.354 | 5713.3 samples/s | 89.3 steps/s
[Step=46450 Epoch=90.6] | Loss=0.01074 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.510 | L2-Norm(final)=11.358 | 5812.4 samples/s | 90.8 steps/s
[Step=46500 Epoch=90.7] | Loss=0.01099 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.510 | L2-Norm(final)=11.361 | 7360.6 samples/s | 115.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=46501 Epoch=90.7] | Loss=0.00371 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.510 | L2-Norm(final)=11.390 | 3830.0 samples/s | 59.8 steps/s
[Step=46550 Epoch=90.8] | Loss=0.01134 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.519 | L2-Norm(final)=11.392 | 4707.6 samples/s | 73.6 steps/s
[Step=46600 Epoch=90.9] | Loss=0.01165 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.529 | L2-Norm(final)=11.393 | 4970.9 samples/s | 77.7 steps/s
[Step=46650 Epoch=91.0] | Loss=0.01142 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.537 | L2-Norm(final)=11.394 | 5003.0 samples/s | 78.2 steps/s
[Step=46700 Epoch=91.1] | Loss=0.01073 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.543 | L2-Norm(final)=11.396 | 5051.6 samples/s | 78.9 steps/s
[Step=46750 Epoch=91.2] | Loss=0.01022 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.549 | L2-Norm(final)=11.397 | 5047.9 samples/s | 78.9 steps/s
[Step=46800 Epoch=91.3] | Loss=0.00945 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.554 | L2-Norm(final)=11.400 | 4978.1 samples/s | 77.8 steps/s
[Step=46850 Epoch=91.4] | Loss=0.00962 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.558 | L2-Norm(final)=11.402 | 5072.1 samples/s | 79.3 steps/s
[Step=46900 Epoch=91.5] | Loss=0.00956 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.563 | L2-Norm(final)=11.404 | 4993.7 samples/s | 78.0 steps/s
[Step=46950 Epoch=91.6] | Loss=0.00953 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.567 | L2-Norm(final)=11.406 | 5013.7 samples/s | 78.3 steps/s
[Step=47000 Epoch=91.7] | Loss=0.00964 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.571 | L2-Norm(final)=11.408 | 6064.1 samples/s | 94.8 steps/s
[Step=47050 Epoch=91.8] | Loss=0.00947 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.575 | L2-Norm(final)=11.410 | 1915.8 samples/s | 29.9 steps/s
[Step=47100 Epoch=91.9] | Loss=0.00912 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.579 | L2-Norm(final)=11.412 | 4903.7 samples/s | 76.6 steps/s
[Step=47150 Epoch=92.0] | Loss=0.00891 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.582 | L2-Norm(final)=11.414 | 4974.7 samples/s | 77.7 steps/s
[Step=47200 Epoch=92.1] | Loss=0.00871 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.585 | L2-Norm(final)=11.415 | 5007.4 samples/s | 78.2 steps/s
[Step=47250 Epoch=92.2] | Loss=0.00855 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.589 | L2-Norm(final)=11.417 | 5043.8 samples/s | 78.8 steps/s
[Step=47300 Epoch=92.3] | Loss=0.00857 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.591 | L2-Norm(final)=11.419 | 5068.0 samples/s | 79.2 steps/s
[Step=47350 Epoch=92.4] | Loss=0.00843 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.594 | L2-Norm(final)=11.420 | 4947.1 samples/s | 77.3 steps/s
[Step=47400 Epoch=92.4] | Loss=0.00839 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.597 | L2-Norm(final)=11.422 | 5010.6 samples/s | 78.3 steps/s
[Step=47450 Epoch=92.5] | Loss=0.00832 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.600 | L2-Norm(final)=11.423 | 4985.7 samples/s | 77.9 steps/s
[Step=47500 Epoch=92.6] | Loss=0.00833 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.602 | L2-Norm(final)=11.424 | 5288.4 samples/s | 82.6 steps/s
[Step=47550 Epoch=92.7] | Loss=0.00825 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.605 | L2-Norm(final)=11.426 | 1979.5 samples/s | 30.9 steps/s
[Step=47600 Epoch=92.8] | Loss=0.00809 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.607 | L2-Norm(final)=11.427 | 5100.6 samples/s | 79.7 steps/s
[Step=47650 Epoch=92.9] | Loss=0.00800 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.609 | L2-Norm(final)=11.429 | 5001.1 samples/s | 78.1 steps/s
[Step=47700 Epoch=93.0] | Loss=0.00786 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.612 | L2-Norm(final)=11.430 | 4952.2 samples/s | 77.4 steps/s
[Step=47750 Epoch=93.1] | Loss=0.00778 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.614 | L2-Norm(final)=11.432 | 5040.3 samples/s | 78.8 steps/s
[Step=47800 Epoch=93.2] | Loss=0.00766 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.616 | L2-Norm(final)=11.433 | 5099.3 samples/s | 79.7 steps/s
[Step=47850 Epoch=93.3] | Loss=0.00764 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.618 | L2-Norm(final)=11.435 | 5080.7 samples/s | 79.4 steps/s
[Step=47900 Epoch=93.4] | Loss=0.00756 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.620 | L2-Norm(final)=11.436 | 5145.3 samples/s | 80.4 steps/s
[Step=47950 Epoch=93.5] | Loss=0.00753 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.622 | L2-Norm(final)=11.438 | 5094.8 samples/s | 79.6 steps/s
[Step=48000 Epoch=93.6] | Loss=0.00754 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.625 | L2-Norm(final)=11.439 | 5203.4 samples/s | 81.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step48000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00013, len=1
[Step=30001 Epoch=115.5] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.510 | L2-Norm(final)=11.846 | 3615.3 samples/s | 56.5 steps/s
[Step=30050 Epoch=115.7] | Loss=0.00007 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.504 | L2-Norm(final)=11.854 | 5240.3 samples/s | 81.9 steps/s
[Step=30100 Epoch=115.9] | Loss=0.00007 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=11.862 | 5509.4 samples/s | 86.1 steps/s
[Step=30150 Epoch=116.1] | Loss=0.00007 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=11.871 | 5413.2 samples/s | 84.6 steps/s
[Step=30200 Epoch=116.3] | Loss=0.00007 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=11.878 | 5472.6 samples/s | 85.5 steps/s
[Step=30250 Epoch=116.4] | Loss=0.00007 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=11.886 | 7309.0 samples/s | 114.2 steps/s
[Step=30300 Epoch=116.6] | Loss=0.00007 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=11.893 | 1941.5 samples/s | 30.3 steps/s
[Step=30350 Epoch=116.8] | Loss=0.00006 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=11.900 | 5477.1 samples/s | 85.6 steps/s
[Step=30400 Epoch=117.0] | Loss=0.00006 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=11.906 | 5567.8 samples/s | 87.0 steps/s
[Step=30450 Epoch=117.2] | Loss=0.00006 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=11.913 | 5406.6 samples/s | 84.5 steps/s
[Step=30500 Epoch=117.4] | Loss=0.00007 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=11.919 | 6285.3 samples/s | 98.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=117.4] | Loss=0.00002 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=11.983 | 3947.1 samples/s | 61.7 steps/s
[Step=30550 Epoch=117.6] | Loss=0.00005 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.495 | L2-Norm(final)=11.986 | 4401.2 samples/s | 68.8 steps/s
[Step=30600 Epoch=117.8] | Loss=0.00012 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.488 | L2-Norm(final)=11.988 | 4666.6 samples/s | 72.9 steps/s
[Step=30650 Epoch=118.0] | Loss=0.00039 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.490 | L2-Norm(final)=11.988 | 4788.6 samples/s | 74.8 steps/s
[Step=30700 Epoch=118.2] | Loss=0.00032 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.493 | L2-Norm(final)=11.988 | 4735.5 samples/s | 74.0 steps/s
[Step=30750 Epoch=118.4] | Loss=0.00026 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.495 | L2-Norm(final)=11.988 | 6173.2 samples/s | 96.5 steps/s
[Step=30800 Epoch=118.6] | Loss=0.00023 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.495 | L2-Norm(final)=11.989 | 1859.4 samples/s | 29.1 steps/s
[Step=30850 Epoch=118.8] | Loss=0.00020 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.495 | L2-Norm(final)=11.989 | 4769.8 samples/s | 74.5 steps/s
[Step=30900 Epoch=118.9] | Loss=0.00018 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.494 | L2-Norm(final)=11.990 | 4769.4 samples/s | 74.5 steps/s
[Step=30950 Epoch=119.1] | Loss=0.00016 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.492 | L2-Norm(final)=11.990 | 4804.4 samples/s | 75.1 steps/s
[Step=31000 Epoch=119.3] | Loss=0.00014 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.490 | L2-Norm(final)=11.991 | 5378.1 samples/s | 84.0 steps/s
[Step=31050 Epoch=119.5] | Loss=0.00013 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.488 | L2-Norm(final)=11.991 | 1949.9 samples/s | 30.5 steps/s
[Step=31100 Epoch=119.7] | Loss=0.00012 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.486 | L2-Norm(final)=11.992 | 4798.8 samples/s | 75.0 steps/s
[Step=31150 Epoch=119.9] | Loss=0.00011 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.483 | L2-Norm(final)=11.992 | 4835.5 samples/s | 75.6 steps/s
[Step=31200 Epoch=120.1] | Loss=0.00010 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.480 | L2-Norm(final)=11.992 | 4771.1 samples/s | 74.5 steps/s
[Step=31250 Epoch=120.3] | Loss=0.00010 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.478 | L2-Norm(final)=11.992 | 4853.6 samples/s | 75.8 steps/s
[Step=31300 Epoch=120.5] | Loss=0.00009 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.475 | L2-Norm(final)=11.993 | 2024.0 samples/s | 31.6 steps/s
[Step=31350 Epoch=120.7] | Loss=0.00009 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.472 | L2-Norm(final)=11.993 | 4900.5 samples/s | 76.6 steps/s
[Step=31400 Epoch=120.9] | Loss=0.00008 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.468 | L2-Norm(final)=11.993 | 4842.4 samples/s | 75.7 steps/s
[Step=31450 Epoch=121.1] | Loss=0.00008 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.465 | L2-Norm(final)=11.994 | 4862.0 samples/s | 76.0 steps/s
[Step=31500 Epoch=121.3] | Loss=0.00007 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.462 | L2-Norm(final)=11.994 | 4787.6 samples/s | 74.8 steps/s
[Step=31550 Epoch=121.4] | Loss=0.00007 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.458 | L2-Norm(final)=11.994 | 2008.1 samples/s | 31.4 steps/s
[Step=31600 Epoch=121.6] | Loss=0.00007 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.455 | L2-Norm(final)=11.994 | 4963.5 samples/s | 77.6 steps/s
[Step=31650 Epoch=121.8] | Loss=0.00006 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=11.995 | 4886.7 samples/s | 76.4 steps/s
[Step=31700 Epoch=122.0] | Loss=0.00006 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.448 | L2-Norm(final)=11.995 | 4784.8 samples/s | 74.8 steps/s
[Step=31750 Epoch=122.2] | Loss=0.00006 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.444 | L2-Norm(final)=11.995 | 4725.9 samples/s | 73.8 steps/s
[Step=31800 Epoch=122.4] | Loss=0.00006 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.441 | L2-Norm(final)=11.995 | 6865.8 samples/s | 107.3 steps/s
[Step=31850 Epoch=122.6] | Loss=0.00005 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.437 | L2-Norm(final)=11.996 | 1814.5 samples/s | 28.4 steps/s
[Step=31900 Epoch=122.8] | Loss=0.00005 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.433 | L2-Norm(final)=11.996 | 4782.5 samples/s | 74.7 steps/s
[Step=31950 Epoch=123.0] | Loss=0.00005 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.429 | L2-Norm(final)=11.996 | 4743.1 samples/s | 74.1 steps/s
[Step=32000 Epoch=123.2] | Loss=0.00005 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.425 | L2-Norm(final)=11.996 | 4795.3 samples/s | 74.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_1/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06862 | acc=0.9696 | tpr=0.9751 | fpr=0.0424 | 4145.0 samples/s | 16.2 steps/s
Avg test loss: 0.07188, Avg test acc: 0.96783, Avg tpr: 0.97296, Avg fpr: 0.04346, total FA: 339

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07538 | acc=0.9686 | tpr=0.9785 | fpr=0.0530 | 4164.1 samples/s | 16.3 steps/s
Avg test loss: 0.07966, Avg test acc: 0.96799, Avg tpr: 0.97826, Avg fpr: 0.05461, total FA: 426

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.43638 | acc=0.3280 | tpr=0.0308 | fpr=0.0268 | 4199.6 samples/s | 16.4 steps/s
Avg test loss: 6.43940, Avg test acc: 0.32587, Avg tpr: 0.03130, Avg fpr: 0.02628, total FA: 205

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.15556 | acc=0.3313 | tpr=0.0362 | fpr=0.0278 | 4253.1 samples/s | 16.6 steps/s
Avg test loss: 6.16755, Avg test acc: 0.32971, Avg tpr: 0.03713, Avg fpr: 0.02679, total FA: 209

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.07916 | acc=0.0977 | tpr=0.9381 | fpr=0.9174 | 4218.2 samples/s | 16.5 steps/s
[Step= 100] | Loss=6.06628 | acc=0.0997 | tpr=0.9318 | fpr=0.9158 | 8289.3 samples/s | 32.4 steps/s
[Step= 150] | Loss=6.08376 | acc=0.1003 | tpr=0.9265 | fpr=0.9149 | 8356.8 samples/s | 32.6 steps/s
[Step= 200] | Loss=6.07758 | acc=0.1006 | tpr=0.9290 | fpr=0.9144 | 8314.8 samples/s | 32.5 steps/s
[Step= 250] | Loss=6.07674 | acc=0.1011 | tpr=0.9293 | fpr=0.9140 | 8318.3 samples/s | 32.5 steps/s
[Step= 300] | Loss=6.07955 | acc=0.1010 | tpr=0.9280 | fpr=0.9141 | 8360.2 samples/s | 32.7 steps/s
[Step= 350] | Loss=6.08017 | acc=0.1005 | tpr=0.9292 | fpr=0.9145 | 8188.8 samples/s | 32.0 steps/s
[Step= 400] | Loss=6.08105 | acc=0.1004 | tpr=0.9289 | fpr=0.9146 | 8316.1 samples/s | 32.5 steps/s
[Step= 450] | Loss=6.08296 | acc=0.1006 | tpr=0.9289 | fpr=0.9145 | 8244.2 samples/s | 32.2 steps/s
[Step= 500] | Loss=6.08255 | acc=0.1005 | tpr=0.9300 | fpr=0.9145 | 8214.3 samples/s | 32.1 steps/s
[Step= 550] | Loss=6.08137 | acc=0.1006 | tpr=0.9308 | fpr=0.9145 | 15506.8 samples/s | 60.6 steps/s
Avg test loss: 6.08194, Avg test acc: 0.10059, Avg tpr: 0.93067, Avg fpr: 0.91450, total FA: 126976

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.77771 | acc=0.0952 | tpr=0.9513 | fpr=0.9202 | 4229.3 samples/s | 16.5 steps/s
[Step= 100] | Loss=6.76994 | acc=0.0966 | tpr=0.9382 | fpr=0.9191 | 8029.5 samples/s | 31.4 steps/s
[Step= 150] | Loss=6.78981 | acc=0.0966 | tpr=0.9395 | fpr=0.9189 | 8241.1 samples/s | 32.2 steps/s
[Step= 200] | Loss=6.77998 | acc=0.0968 | tpr=0.9388 | fpr=0.9185 | 8459.1 samples/s | 33.0 steps/s
[Step= 250] | Loss=6.78036 | acc=0.0972 | tpr=0.9406 | fpr=0.9182 | 8610.9 samples/s | 33.6 steps/s
[Step= 300] | Loss=6.78405 | acc=0.0972 | tpr=0.9360 | fpr=0.9181 | 8071.3 samples/s | 31.5 steps/s
[Step= 350] | Loss=6.78558 | acc=0.0968 | tpr=0.9343 | fpr=0.9184 | 8169.0 samples/s | 31.9 steps/s
[Step= 400] | Loss=6.78636 | acc=0.0968 | tpr=0.9344 | fpr=0.9185 | 8672.6 samples/s | 33.9 steps/s
[Step= 450] | Loss=6.78977 | acc=0.0969 | tpr=0.9338 | fpr=0.9183 | 7920.3 samples/s | 30.9 steps/s
[Step= 500] | Loss=6.78961 | acc=0.0969 | tpr=0.9348 | fpr=0.9183 | 8270.9 samples/s | 32.3 steps/s
[Step= 550] | Loss=6.78882 | acc=0.0969 | tpr=0.9367 | fpr=0.9183 | 15158.2 samples/s | 59.2 steps/s
Avg test loss: 6.78955, Avg test acc: 0.09690, Avg tpr: 0.93661, Avg fpr: 0.91836, total FA: 127513

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12263 | acc=0.9821 | tpr=0.9513 | fpr=0.0173 | 4164.7 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.12887 | acc=0.9814 | tpr=0.9488 | fpr=0.0179 | 8395.9 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.13426 | acc=0.9806 | tpr=0.9539 | fpr=0.0189 | 8254.4 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.13587 | acc=0.9804 | tpr=0.9552 | fpr=0.0192 | 8578.3 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.13376 | acc=0.9803 | tpr=0.9537 | fpr=0.0192 | 8193.3 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.13706 | acc=0.9800 | tpr=0.9505 | fpr=0.0194 | 8242.2 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.13732 | acc=0.9800 | tpr=0.9505 | fpr=0.0195 | 8384.1 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.13884 | acc=0.9798 | tpr=0.9491 | fpr=0.0196 | 8306.0 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.14198 | acc=0.9795 | tpr=0.9469 | fpr=0.0199 | 8185.6 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.14141 | acc=0.9796 | tpr=0.9480 | fpr=0.0198 | 8291.1 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.14025 | acc=0.9798 | tpr=0.9463 | fpr=0.0196 | 14924.3 samples/s | 58.3 steps/s
Avg test loss: 0.13995, Avg test acc: 0.97981, Avg tpr: 0.94612, Avg fpr: 0.01958, total FA: 2718

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16646 | acc=0.9766 | tpr=0.9513 | fpr=0.0230 | 4270.7 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.17430 | acc=0.9754 | tpr=0.9488 | fpr=0.0241 | 7641.1 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.18227 | acc=0.9747 | tpr=0.9553 | fpr=0.0249 | 7850.7 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.18559 | acc=0.9746 | tpr=0.9596 | fpr=0.0251 | 7653.6 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.18231 | acc=0.9749 | tpr=0.9572 | fpr=0.0248 | 7725.4 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.18701 | acc=0.9745 | tpr=0.9571 | fpr=0.0252 | 8083.2 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.18725 | acc=0.9745 | tpr=0.9574 | fpr=0.0252 | 8389.1 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.18838 | acc=0.9743 | tpr=0.9557 | fpr=0.0253 | 8266.3 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.19181 | acc=0.9741 | tpr=0.9537 | fpr=0.0256 | 8175.7 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.19072 | acc=0.9742 | tpr=0.9537 | fpr=0.0254 | 8293.3 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.18922 | acc=0.9744 | tpr=0.9526 | fpr=0.0252 | 15136.4 samples/s | 59.1 steps/s
Avg test loss: 0.18895, Avg test acc: 0.97437, Avg tpr: 0.95246, Avg fpr: 0.02523, total FA: 3503

server round 40/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=48001 Epoch=93.6] | Loss=0.00856 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.476 | L2-Norm(final)=11.482 | 3421.0 samples/s | 53.5 steps/s
[Step=48050 Epoch=93.7] | Loss=0.01104 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=11.483 | 5657.6 samples/s | 88.4 steps/s
[Step=48100 Epoch=93.8] | Loss=0.00958 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=11.485 | 5869.1 samples/s | 91.7 steps/s
[Step=48150 Epoch=93.9] | Loss=0.00906 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=11.487 | 5697.2 samples/s | 89.0 steps/s
[Step=48200 Epoch=94.0] | Loss=0.01021 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.476 | L2-Norm(final)=11.489 | 5926.9 samples/s | 92.6 steps/s
[Step=48250 Epoch=94.1] | Loss=0.01027 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.476 | L2-Norm(final)=11.490 | 5708.5 samples/s | 89.2 steps/s
[Step=48300 Epoch=94.2] | Loss=0.01047 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=11.491 | 5780.0 samples/s | 90.3 steps/s
[Step=48350 Epoch=94.3] | Loss=0.01057 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=11.493 | 5863.8 samples/s | 91.6 steps/s
[Step=48400 Epoch=94.4] | Loss=0.01043 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=11.495 | 5820.0 samples/s | 90.9 steps/s
[Step=48450 Epoch=94.5] | Loss=0.01046 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=11.496 | 5738.1 samples/s | 89.7 steps/s
[Step=48500 Epoch=94.6] | Loss=0.01041 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=11.498 | 7454.1 samples/s | 116.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=48501 Epoch=94.6] | Loss=0.00442 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=11.513 | 3874.8 samples/s | 60.5 steps/s
[Step=48550 Epoch=94.7] | Loss=0.00959 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.479 | L2-Norm(final)=11.514 | 4530.1 samples/s | 70.8 steps/s
[Step=48600 Epoch=94.8] | Loss=0.00905 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.482 | L2-Norm(final)=11.516 | 5051.6 samples/s | 78.9 steps/s
[Step=48650 Epoch=94.9] | Loss=0.00845 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.486 | L2-Norm(final)=11.518 | 5102.7 samples/s | 79.7 steps/s
[Step=48700 Epoch=95.0] | Loss=0.00831 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.488 | L2-Norm(final)=11.519 | 4945.6 samples/s | 77.3 steps/s
[Step=48750 Epoch=95.1] | Loss=0.00849 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=11.521 | 5020.0 samples/s | 78.4 steps/s
[Step=48800 Epoch=95.2] | Loss=0.00851 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.493 | L2-Norm(final)=11.522 | 5066.2 samples/s | 79.2 steps/s
[Step=48850 Epoch=95.3] | Loss=0.00852 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.495 | L2-Norm(final)=11.524 | 5006.4 samples/s | 78.2 steps/s
[Step=48900 Epoch=95.4] | Loss=0.00831 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.497 | L2-Norm(final)=11.525 | 5055.4 samples/s | 79.0 steps/s
[Step=48950 Epoch=95.5] | Loss=0.00798 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.499 | L2-Norm(final)=11.526 | 5082.7 samples/s | 79.4 steps/s
[Step=49000 Epoch=95.6] | Loss=0.00798 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.501 | L2-Norm(final)=11.528 | 6086.0 samples/s | 95.1 steps/s
[Step=49050 Epoch=95.7] | Loss=0.00780 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=11.529 | 1883.7 samples/s | 29.4 steps/s
[Step=49100 Epoch=95.8] | Loss=0.00757 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.505 | L2-Norm(final)=11.531 | 5031.2 samples/s | 78.6 steps/s
[Step=49150 Epoch=95.9] | Loss=0.00739 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.507 | L2-Norm(final)=11.533 | 5017.1 samples/s | 78.4 steps/s
[Step=49200 Epoch=96.0] | Loss=0.00738 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.508 | L2-Norm(final)=11.534 | 4980.4 samples/s | 77.8 steps/s
[Step=49250 Epoch=96.1] | Loss=0.00719 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.510 | L2-Norm(final)=11.536 | 4971.5 samples/s | 77.7 steps/s
[Step=49300 Epoch=96.2] | Loss=0.00711 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.512 | L2-Norm(final)=11.537 | 4977.2 samples/s | 77.8 steps/s
[Step=49350 Epoch=96.3] | Loss=0.00707 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.513 | L2-Norm(final)=11.538 | 5003.8 samples/s | 78.2 steps/s
[Step=49400 Epoch=96.3] | Loss=0.00702 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.515 | L2-Norm(final)=11.540 | 5017.1 samples/s | 78.4 steps/s
[Step=49450 Epoch=96.4] | Loss=0.00693 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.516 | L2-Norm(final)=11.541 | 5094.9 samples/s | 79.6 steps/s
[Step=49500 Epoch=96.5] | Loss=0.00693 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.517 | L2-Norm(final)=11.542 | 5278.2 samples/s | 82.5 steps/s
[Step=49550 Epoch=96.6] | Loss=0.00684 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.519 | L2-Norm(final)=11.544 | 1933.4 samples/s | 30.2 steps/s
[Step=49600 Epoch=96.7] | Loss=0.00676 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.520 | L2-Norm(final)=11.545 | 5063.5 samples/s | 79.1 steps/s
[Step=49650 Epoch=96.8] | Loss=0.00670 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.521 | L2-Norm(final)=11.546 | 5067.1 samples/s | 79.2 steps/s
[Step=49700 Epoch=96.9] | Loss=0.00665 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.523 | L2-Norm(final)=11.548 | 5072.7 samples/s | 79.3 steps/s
[Step=49750 Epoch=97.0] | Loss=0.00659 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.524 | L2-Norm(final)=11.549 | 5015.5 samples/s | 78.4 steps/s
[Step=49800 Epoch=97.1] | Loss=0.00648 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.525 | L2-Norm(final)=11.550 | 5099.2 samples/s | 79.7 steps/s
[Step=49850 Epoch=97.2] | Loss=0.00638 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.526 | L2-Norm(final)=11.552 | 4940.2 samples/s | 77.2 steps/s
[Step=49900 Epoch=97.3] | Loss=0.00632 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.528 | L2-Norm(final)=11.553 | 4990.4 samples/s | 78.0 steps/s
[Step=49950 Epoch=97.4] | Loss=0.00630 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.529 | L2-Norm(final)=11.554 | 4960.0 samples/s | 77.5 steps/s
[Step=50000 Epoch=97.5] | Loss=0.00628 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.530 | L2-Norm(final)=11.556 | 5006.5 samples/s | 78.2 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step50000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=38001 Epoch=74.3] | Loss=0.00471 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=11.213 | 3800.4 samples/s | 59.4 steps/s
[Step=38050 Epoch=74.4] | Loss=0.00973 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.476 | L2-Norm(final)=11.216 | 5512.1 samples/s | 86.1 steps/s
[Step=38100 Epoch=74.5] | Loss=0.00982 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=11.219 | 5821.9 samples/s | 91.0 steps/s
[Step=38150 Epoch=74.6] | Loss=0.00974 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=11.221 | 5928.1 samples/s | 92.6 steps/s
[Step=38200 Epoch=74.7] | Loss=0.01010 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=11.223 | 5708.8 samples/s | 89.2 steps/s
[Step=38250 Epoch=74.8] | Loss=0.01052 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.476 | L2-Norm(final)=11.225 | 5790.6 samples/s | 90.5 steps/s
[Step=38300 Epoch=74.9] | Loss=0.01027 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.476 | L2-Norm(final)=11.227 | 5884.9 samples/s | 92.0 steps/s
[Step=38350 Epoch=75.0] | Loss=0.01003 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=11.230 | 5726.6 samples/s | 89.5 steps/s
[Step=38400 Epoch=75.1] | Loss=0.01031 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=11.232 | 5715.3 samples/s | 89.3 steps/s
[Step=38450 Epoch=75.2] | Loss=0.01003 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.476 | L2-Norm(final)=11.234 | 5883.5 samples/s | 91.9 steps/s
[Step=38500 Epoch=75.3] | Loss=0.00987 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=11.236 | 7491.2 samples/s | 117.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=38501 Epoch=75.3] | Loss=0.00558 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=11.260 | 3696.9 samples/s | 57.8 steps/s
[Step=38550 Epoch=75.4] | Loss=0.01094 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.479 | L2-Norm(final)=11.261 | 5072.7 samples/s | 79.3 steps/s
[Step=38600 Epoch=75.5] | Loss=0.01047 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.482 | L2-Norm(final)=11.263 | 5001.1 samples/s | 78.1 steps/s
[Step=38650 Epoch=75.6] | Loss=0.00968 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.485 | L2-Norm(final)=11.265 | 5031.4 samples/s | 78.6 steps/s
[Step=38700 Epoch=75.7] | Loss=0.00902 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.488 | L2-Norm(final)=11.267 | 4986.9 samples/s | 77.9 steps/s
[Step=38750 Epoch=75.8] | Loss=0.00881 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.491 | L2-Norm(final)=11.269 | 5001.8 samples/s | 78.2 steps/s
[Step=38800 Epoch=75.9] | Loss=0.00867 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.494 | L2-Norm(final)=11.271 | 5046.6 samples/s | 78.9 steps/s
[Step=38850 Epoch=76.0] | Loss=0.00851 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.496 | L2-Norm(final)=11.272 | 5064.4 samples/s | 79.1 steps/s
[Step=38900 Epoch=76.0] | Loss=0.00813 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.498 | L2-Norm(final)=11.274 | 4964.7 samples/s | 77.6 steps/s
[Step=38950 Epoch=76.1] | Loss=0.00787 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.500 | L2-Norm(final)=11.276 | 5010.7 samples/s | 78.3 steps/s
[Step=39000 Epoch=76.2] | Loss=0.00772 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.502 | L2-Norm(final)=11.278 | 6231.7 samples/s | 97.4 steps/s
[Step=39050 Epoch=76.3] | Loss=0.00742 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.504 | L2-Norm(final)=11.279 | 1937.1 samples/s | 30.3 steps/s
[Step=39100 Epoch=76.4] | Loss=0.00730 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.506 | L2-Norm(final)=11.281 | 4984.9 samples/s | 77.9 steps/s
[Step=39150 Epoch=76.5] | Loss=0.00709 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.507 | L2-Norm(final)=11.283 | 5033.8 samples/s | 78.7 steps/s
[Step=39200 Epoch=76.6] | Loss=0.00696 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.509 | L2-Norm(final)=11.285 | 4965.5 samples/s | 77.6 steps/s
[Step=39250 Epoch=76.7] | Loss=0.00683 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.510 | L2-Norm(final)=11.286 | 5044.0 samples/s | 78.8 steps/s
[Step=39300 Epoch=76.8] | Loss=0.00669 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.512 | L2-Norm(final)=11.288 | 4980.2 samples/s | 77.8 steps/s
[Step=39350 Epoch=76.9] | Loss=0.00662 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.514 | L2-Norm(final)=11.290 | 4997.7 samples/s | 78.1 steps/s
[Step=39400 Epoch=77.0] | Loss=0.00660 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.515 | L2-Norm(final)=11.291 | 5006.0 samples/s | 78.2 steps/s
[Step=39450 Epoch=77.1] | Loss=0.00655 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.516 | L2-Norm(final)=11.293 | 4989.0 samples/s | 78.0 steps/s
[Step=39500 Epoch=77.2] | Loss=0.00645 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.518 | L2-Norm(final)=11.294 | 5429.3 samples/s | 84.8 steps/s
[Step=39550 Epoch=77.3] | Loss=0.00648 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.519 | L2-Norm(final)=11.296 | 2033.1 samples/s | 31.8 steps/s
[Step=39600 Epoch=77.4] | Loss=0.00637 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.520 | L2-Norm(final)=11.297 | 5076.1 samples/s | 79.3 steps/s
[Step=39650 Epoch=77.5] | Loss=0.00626 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.522 | L2-Norm(final)=11.299 | 5012.0 samples/s | 78.3 steps/s
[Step=39700 Epoch=77.6] | Loss=0.00621 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.523 | L2-Norm(final)=11.301 | 5008.8 samples/s | 78.3 steps/s
[Step=39750 Epoch=77.7] | Loss=0.00622 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.524 | L2-Norm(final)=11.302 | 5049.5 samples/s | 78.9 steps/s
[Step=39800 Epoch=77.8] | Loss=0.00610 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.526 | L2-Norm(final)=11.304 | 4934.0 samples/s | 77.1 steps/s
[Step=39850 Epoch=77.9] | Loss=0.00601 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.527 | L2-Norm(final)=11.305 | 5047.7 samples/s | 78.9 steps/s
[Step=39900 Epoch=78.0] | Loss=0.00593 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.528 | L2-Norm(final)=11.307 | 4992.2 samples/s | 78.0 steps/s
[Step=39950 Epoch=78.1] | Loss=0.00596 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.529 | L2-Norm(final)=11.308 | 5043.8 samples/s | 78.8 steps/s
[Step=40000 Epoch=78.2] | Loss=0.00595 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.530 | L2-Norm(final)=11.310 | 5008.4 samples/s | 78.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07183 | acc=0.9699 | tpr=0.9770 | fpr=0.0453 | 4180.7 samples/s | 16.3 steps/s
Avg test loss: 0.07505, Avg test acc: 0.96847, Avg tpr: 0.97564, Avg fpr: 0.04730, total FA: 369

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07275 | acc=0.9695 | tpr=0.9795 | fpr=0.0520 | 4142.7 samples/s | 16.2 steps/s
Avg test loss: 0.07666, Avg test acc: 0.96907, Avg tpr: 0.97896, Avg fpr: 0.05269, total FA: 411

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.43638 | acc=0.3280 | tpr=0.0308 | fpr=0.0268 | 4151.8 samples/s | 16.2 steps/s
Avg test loss: 6.43940, Avg test acc: 0.32587, Avg tpr: 0.03130, Avg fpr: 0.02628, total FA: 205

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.15556 | acc=0.3313 | tpr=0.0362 | fpr=0.0278 | 4169.5 samples/s | 16.3 steps/s
Avg test loss: 6.16755, Avg test acc: 0.32971, Avg tpr: 0.03713, Avg fpr: 0.02679, total FA: 209

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.63427 | acc=0.0955 | tpr=0.9602 | fpr=0.9200 | 4179.6 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.61643 | acc=0.0977 | tpr=0.9467 | fpr=0.9182 | 8150.5 samples/s | 31.8 steps/s
[Step= 150] | Loss=6.63547 | acc=0.0980 | tpr=0.9438 | fpr=0.9176 | 8250.8 samples/s | 32.2 steps/s
[Step= 200] | Loss=6.62968 | acc=0.0983 | tpr=0.9443 | fpr=0.9171 | 8361.4 samples/s | 32.7 steps/s
[Step= 250] | Loss=6.62844 | acc=0.0984 | tpr=0.9459 | fpr=0.9170 | 8506.9 samples/s | 33.2 steps/s
[Step= 300] | Loss=6.63133 | acc=0.0985 | tpr=0.9447 | fpr=0.9170 | 8075.6 samples/s | 31.5 steps/s
[Step= 350] | Loss=6.63156 | acc=0.0979 | tpr=0.9455 | fpr=0.9175 | 8251.2 samples/s | 32.2 steps/s
[Step= 400] | Loss=6.63193 | acc=0.0978 | tpr=0.9447 | fpr=0.9176 | 8506.5 samples/s | 33.2 steps/s
[Step= 450] | Loss=6.63472 | acc=0.0980 | tpr=0.9445 | fpr=0.9174 | 8075.4 samples/s | 31.5 steps/s
[Step= 500] | Loss=6.63492 | acc=0.0978 | tpr=0.9449 | fpr=0.9175 | 8217.0 samples/s | 32.1 steps/s
[Step= 550] | Loss=6.63330 | acc=0.0979 | tpr=0.9463 | fpr=0.9175 | 14840.0 samples/s | 58.0 steps/s
Avg test loss: 6.63382, Avg test acc: 0.09792, Avg tpr: 0.94651, Avg fpr: 0.91751, total FA: 127394

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.57936 | acc=0.0978 | tpr=0.9558 | fpr=0.9176 | 4075.5 samples/s | 15.9 steps/s
[Step= 100] | Loss=6.56659 | acc=0.1002 | tpr=0.9424 | fpr=0.9155 | 8923.1 samples/s | 34.9 steps/s
[Step= 150] | Loss=6.58751 | acc=0.1001 | tpr=0.9438 | fpr=0.9155 | 7867.8 samples/s | 30.7 steps/s
[Step= 200] | Loss=6.57974 | acc=0.1003 | tpr=0.9443 | fpr=0.9150 | 8169.6 samples/s | 31.9 steps/s
[Step= 250] | Loss=6.57793 | acc=0.1008 | tpr=0.9459 | fpr=0.9146 | 8591.1 samples/s | 33.6 steps/s
[Step= 300] | Loss=6.58098 | acc=0.1006 | tpr=0.9440 | fpr=0.9148 | 8077.2 samples/s | 31.6 steps/s
[Step= 350] | Loss=6.58198 | acc=0.1002 | tpr=0.9443 | fpr=0.9151 | 8259.3 samples/s | 32.3 steps/s
[Step= 400] | Loss=6.58283 | acc=0.1002 | tpr=0.9442 | fpr=0.9152 | 8435.0 samples/s | 32.9 steps/s
[Step= 450] | Loss=6.58657 | acc=0.1002 | tpr=0.9426 | fpr=0.9151 | 8317.4 samples/s | 32.5 steps/s
[Step= 500] | Loss=6.58679 | acc=0.1002 | tpr=0.9432 | fpr=0.9151 | 8021.0 samples/s | 31.3 steps/s
[Step= 550] | Loss=6.58531 | acc=0.1003 | tpr=0.9447 | fpr=0.9150 | 15609.7 samples/s | 61.0 steps/s
Avg test loss: 6.58610, Avg test acc: 0.10030, Avg tpr: 0.94493, Avg fpr: 0.91505, total FA: 127053

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12263 | acc=0.9821 | tpr=0.9513 | fpr=0.0173 | 4155.9 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.12887 | acc=0.9814 | tpr=0.9488 | fpr=0.0179 | 8309.3 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.13426 | acc=0.9806 | tpr=0.9539 | fpr=0.0189 | 8413.0 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.13587 | acc=0.9804 | tpr=0.9552 | fpr=0.0192 | 8080.0 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.13376 | acc=0.9803 | tpr=0.9537 | fpr=0.0192 | 8557.2 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.13706 | acc=0.9800 | tpr=0.9505 | fpr=0.0194 | 8119.1 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.13732 | acc=0.9800 | tpr=0.9505 | fpr=0.0195 | 7910.2 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.13884 | acc=0.9798 | tpr=0.9491 | fpr=0.0196 | 8315.5 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.14198 | acc=0.9795 | tpr=0.9469 | fpr=0.0199 | 8256.9 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.14141 | acc=0.9796 | tpr=0.9480 | fpr=0.0198 | 8180.6 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.14025 | acc=0.9798 | tpr=0.9463 | fpr=0.0196 | 14950.4 samples/s | 58.4 steps/s
Avg test loss: 0.13995, Avg test acc: 0.97981, Avg tpr: 0.94612, Avg fpr: 0.01958, total FA: 2718

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16646 | acc=0.9766 | tpr=0.9513 | fpr=0.0230 | 4163.7 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.17430 | acc=0.9754 | tpr=0.9488 | fpr=0.0241 | 8200.1 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.18227 | acc=0.9747 | tpr=0.9553 | fpr=0.0249 | 8372.4 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.18559 | acc=0.9746 | tpr=0.9596 | fpr=0.0251 | 8115.4 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.18231 | acc=0.9749 | tpr=0.9572 | fpr=0.0248 | 8538.3 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.18701 | acc=0.9745 | tpr=0.9571 | fpr=0.0252 | 8253.4 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.18725 | acc=0.9745 | tpr=0.9574 | fpr=0.0252 | 8203.8 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.18838 | acc=0.9743 | tpr=0.9557 | fpr=0.0253 | 7970.0 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.19181 | acc=0.9741 | tpr=0.9537 | fpr=0.0256 | 8473.3 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.19072 | acc=0.9742 | tpr=0.9537 | fpr=0.0254 | 8097.5 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.18922 | acc=0.9744 | tpr=0.9526 | fpr=0.0252 | 15036.5 samples/s | 58.7 steps/s
Avg test loss: 0.18895, Avg test acc: 0.97437, Avg tpr: 0.95246, Avg fpr: 0.02523, total FA: 3503

server round 41/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=50001 Epoch=97.5] | Loss=0.00427 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.408 | L2-Norm(final)=11.594 | 3437.1 samples/s | 53.7 steps/s
[Step=50050 Epoch=97.6] | Loss=0.01037 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.408 | L2-Norm(final)=11.596 | 5580.1 samples/s | 87.2 steps/s
[Step=50100 Epoch=97.7] | Loss=0.01112 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.408 | L2-Norm(final)=11.598 | 5656.9 samples/s | 88.4 steps/s
[Step=50150 Epoch=97.8] | Loss=0.01085 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.408 | L2-Norm(final)=11.601 | 5740.6 samples/s | 89.7 steps/s
[Step=50200 Epoch=97.9] | Loss=0.01071 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.408 | L2-Norm(final)=11.603 | 5853.1 samples/s | 91.5 steps/s
[Step=50250 Epoch=98.0] | Loss=0.01035 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.408 | L2-Norm(final)=11.606 | 5716.6 samples/s | 89.3 steps/s
[Step=50300 Epoch=98.1] | Loss=0.01025 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.408 | L2-Norm(final)=11.608 | 5858.1 samples/s | 91.5 steps/s
[Step=50350 Epoch=98.2] | Loss=0.01065 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.408 | L2-Norm(final)=11.611 | 5776.4 samples/s | 90.3 steps/s
[Step=50400 Epoch=98.3] | Loss=0.01066 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.408 | L2-Norm(final)=11.613 | 5796.0 samples/s | 90.6 steps/s
[Step=50450 Epoch=98.4] | Loss=0.01066 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.408 | L2-Norm(final)=11.615 | 5858.1 samples/s | 91.5 steps/s
[Step=50500 Epoch=98.5] | Loss=0.01056 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.408 | L2-Norm(final)=11.616 | 7143.6 samples/s | 111.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=50501 Epoch=98.5] | Loss=0.00865 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.408 | L2-Norm(final)=11.636 | 3770.2 samples/s | 58.9 steps/s
[Step=50550 Epoch=98.6] | Loss=0.01048 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.411 | L2-Norm(final)=11.637 | 4456.5 samples/s | 69.6 steps/s
[Step=50600 Epoch=98.7] | Loss=0.01108 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.414 | L2-Norm(final)=11.638 | 5043.6 samples/s | 78.8 steps/s
[Step=50650 Epoch=98.8] | Loss=0.01004 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.418 | L2-Norm(final)=11.639 | 4971.5 samples/s | 77.7 steps/s
[Step=50700 Epoch=98.9] | Loss=0.00970 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.421 | L2-Norm(final)=11.640 | 5012.9 samples/s | 78.3 steps/s
[Step=50750 Epoch=99.0] | Loss=0.00932 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=11.642 | 4974.1 samples/s | 77.7 steps/s
[Step=50800 Epoch=99.1] | Loss=0.00927 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.426 | L2-Norm(final)=11.643 | 5038.5 samples/s | 78.7 steps/s
[Step=50850 Epoch=99.2] | Loss=0.00895 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.429 | L2-Norm(final)=11.644 | 4996.1 samples/s | 78.1 steps/s
[Step=50900 Epoch=99.3] | Loss=0.00855 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.431 | L2-Norm(final)=11.646 | 5095.5 samples/s | 79.6 steps/s
[Step=50950 Epoch=99.4] | Loss=0.00856 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.433 | L2-Norm(final)=11.647 | 4918.9 samples/s | 76.9 steps/s
[Step=51000 Epoch=99.5] | Loss=0.00853 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.435 | L2-Norm(final)=11.649 | 6110.0 samples/s | 95.5 steps/s
[Step=51050 Epoch=99.6] | Loss=0.00830 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.437 | L2-Norm(final)=11.650 | 1872.3 samples/s | 29.3 steps/s
[Step=51100 Epoch=99.7] | Loss=0.00805 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.439 | L2-Norm(final)=11.651 | 4984.8 samples/s | 77.9 steps/s
[Step=51150 Epoch=99.8] | Loss=0.00784 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.441 | L2-Norm(final)=11.653 | 4994.6 samples/s | 78.0 steps/s
[Step=51200 Epoch=99.9] | Loss=0.00765 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.443 | L2-Norm(final)=11.654 | 4991.1 samples/s | 78.0 steps/s
[Step=51250 Epoch=100.0] | Loss=0.00761 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.445 | L2-Norm(final)=11.656 | 5065.7 samples/s | 79.2 steps/s
[Step=51300 Epoch=100.1] | Loss=0.00757 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.446 | L2-Norm(final)=11.657 | 5095.9 samples/s | 79.6 steps/s
[Step=51350 Epoch=100.2] | Loss=0.00750 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.448 | L2-Norm(final)=11.658 | 4971.4 samples/s | 77.7 steps/s
[Step=51400 Epoch=100.2] | Loss=0.00741 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.449 | L2-Norm(final)=11.659 | 5069.6 samples/s | 79.2 steps/s
[Step=51450 Epoch=100.3] | Loss=0.00733 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.451 | L2-Norm(final)=11.660 | 5055.8 samples/s | 79.0 steps/s
[Step=51500 Epoch=100.4] | Loss=0.00727 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=11.662 | 5271.4 samples/s | 82.4 steps/s
[Step=51550 Epoch=100.5] | Loss=0.00715 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.453 | L2-Norm(final)=11.663 | 1993.5 samples/s | 31.1 steps/s
[Step=51600 Epoch=100.6] | Loss=0.00704 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.455 | L2-Norm(final)=11.664 | 4980.2 samples/s | 77.8 steps/s
[Step=51650 Epoch=100.7] | Loss=0.00697 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.456 | L2-Norm(final)=11.665 | 5091.2 samples/s | 79.5 steps/s
[Step=51700 Epoch=100.8] | Loss=0.00693 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.457 | L2-Norm(final)=11.666 | 4946.9 samples/s | 77.3 steps/s
[Step=51750 Epoch=100.9] | Loss=0.00690 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.459 | L2-Norm(final)=11.668 | 4986.1 samples/s | 77.9 steps/s
[Step=51800 Epoch=101.0] | Loss=0.00679 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.460 | L2-Norm(final)=11.669 | 5091.5 samples/s | 79.6 steps/s
[Step=51850 Epoch=101.1] | Loss=0.00674 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.461 | L2-Norm(final)=11.670 | 5041.6 samples/s | 78.8 steps/s
[Step=51900 Epoch=101.2] | Loss=0.00670 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.462 | L2-Norm(final)=11.671 | 4967.1 samples/s | 77.6 steps/s
[Step=51950 Epoch=101.3] | Loss=0.00662 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.464 | L2-Norm(final)=11.672 | 5067.3 samples/s | 79.2 steps/s
[Step=52000 Epoch=101.4] | Loss=0.00658 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.465 | L2-Norm(final)=11.673 | 5053.8 samples/s | 79.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step52000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=42001 Epoch=160.9] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.408 | L2-Norm(final)=11.601 | 3818.0 samples/s | 59.7 steps/s
[Step=42050 Epoch=161.1] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.407 | L2-Norm(final)=11.602 | 5033.6 samples/s | 78.7 steps/s
[Step=42100 Epoch=161.3] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.407 | L2-Norm(final)=11.602 | 5435.0 samples/s | 84.9 steps/s
[Step=42150 Epoch=161.5] | Loss=0.00002 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.407 | L2-Norm(final)=11.603 | 5418.0 samples/s | 84.7 steps/s
[Step=42200 Epoch=161.7] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.407 | L2-Norm(final)=11.604 | 5579.7 samples/s | 87.2 steps/s
[Step=42250 Epoch=161.9] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.407 | L2-Norm(final)=11.605 | 7015.2 samples/s | 109.6 steps/s
[Step=42300 Epoch=162.1] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.407 | L2-Norm(final)=11.606 | 1951.9 samples/s | 30.5 steps/s
[Step=42350 Epoch=162.3] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.407 | L2-Norm(final)=11.607 | 5299.8 samples/s | 82.8 steps/s
[Step=42400 Epoch=162.5] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.407 | L2-Norm(final)=11.608 | 5543.2 samples/s | 86.6 steps/s
[Step=42450 Epoch=162.7] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.407 | L2-Norm(final)=11.609 | 5397.5 samples/s | 84.3 steps/s
[Step=42500 Epoch=162.8] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.407 | L2-Norm(final)=11.610 | 6198.8 samples/s | 96.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=162.8] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.407 | L2-Norm(final)=11.617 | 3812.8 samples/s | 59.6 steps/s
[Step=42550 Epoch=163.0] | Loss=0.00002 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.405 | L2-Norm(final)=11.618 | 4506.8 samples/s | 70.4 steps/s
[Step=42600 Epoch=163.2] | Loss=0.00002 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.402 | L2-Norm(final)=11.619 | 4820.9 samples/s | 75.3 steps/s
[Step=42650 Epoch=163.4] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.398 | L2-Norm(final)=11.619 | 4754.2 samples/s | 74.3 steps/s
[Step=42700 Epoch=163.6] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.395 | L2-Norm(final)=11.620 | 4736.7 samples/s | 74.0 steps/s
[Step=42750 Epoch=163.8] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.391 | L2-Norm(final)=11.620 | 5890.2 samples/s | 92.0 steps/s
[Step=42800 Epoch=164.0] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.387 | L2-Norm(final)=11.621 | 1893.1 samples/s | 29.6 steps/s
[Step=42850 Epoch=164.2] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.384 | L2-Norm(final)=11.621 | 4800.3 samples/s | 75.0 steps/s
[Step=42900 Epoch=164.4] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=11.622 | 4864.9 samples/s | 76.0 steps/s
[Step=42950 Epoch=164.6] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.376 | L2-Norm(final)=11.622 | 4867.1 samples/s | 76.0 steps/s
[Step=43000 Epoch=164.8] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.372 | L2-Norm(final)=11.623 | 5270.3 samples/s | 82.3 steps/s
[Step=43050 Epoch=165.0] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.368 | L2-Norm(final)=11.623 | 1972.6 samples/s | 30.8 steps/s
[Step=43100 Epoch=165.1] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=11.623 | 4760.3 samples/s | 74.4 steps/s
[Step=43150 Epoch=165.3] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.360 | L2-Norm(final)=11.624 | 4766.9 samples/s | 74.5 steps/s
[Step=43200 Epoch=165.5] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.356 | L2-Norm(final)=11.624 | 4817.8 samples/s | 75.3 steps/s
[Step=43250 Epoch=165.7] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=11.625 | 4728.0 samples/s | 73.9 steps/s
[Step=43300 Epoch=165.9] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.348 | L2-Norm(final)=11.625 | 2045.6 samples/s | 32.0 steps/s
[Step=43350 Epoch=166.1] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.344 | L2-Norm(final)=11.626 | 5006.0 samples/s | 78.2 steps/s
[Step=43400 Epoch=166.3] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=11.626 | 4746.2 samples/s | 74.2 steps/s
[Step=43450 Epoch=166.5] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.335 | L2-Norm(final)=11.627 | 4705.0 samples/s | 73.5 steps/s
[Step=43500 Epoch=166.7] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.331 | L2-Norm(final)=11.627 | 4782.8 samples/s | 74.7 steps/s
[Step=43550 Epoch=166.9] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.326 | L2-Norm(final)=11.628 | 2054.6 samples/s | 32.1 steps/s
[Step=43600 Epoch=167.1] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.322 | L2-Norm(final)=11.628 | 4830.0 samples/s | 75.5 steps/s
[Step=43650 Epoch=167.3] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.317 | L2-Norm(final)=11.629 | 4651.5 samples/s | 72.7 steps/s
[Step=43700 Epoch=167.4] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.313 | L2-Norm(final)=11.629 | 4752.0 samples/s | 74.3 steps/s
[Step=43750 Epoch=167.6] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.308 | L2-Norm(final)=11.630 | 4767.0 samples/s | 74.5 steps/s
[Step=43800 Epoch=167.8] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.303 | L2-Norm(final)=11.630 | 6503.2 samples/s | 101.6 steps/s
[Step=43850 Epoch=168.0] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.299 | L2-Norm(final)=11.631 | 1841.5 samples/s | 28.8 steps/s
[Step=43900 Epoch=168.2] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.294 | L2-Norm(final)=11.631 | 4741.3 samples/s | 74.1 steps/s
[Step=43950 Epoch=168.4] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.289 | L2-Norm(final)=11.632 | 4801.9 samples/s | 75.0 steps/s
[Step=44000 Epoch=168.6] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.284 | L2-Norm(final)=11.632 | 4788.6 samples/s | 74.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step44000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07398 | acc=0.9695 | tpr=0.9770 | fpr=0.0468 | 4161.8 samples/s | 16.3 steps/s
Avg test loss: 0.07592, Avg test acc: 0.96811, Avg tpr: 0.97540, Avg fpr: 0.04794, total FA: 374

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07275 | acc=0.9695 | tpr=0.9795 | fpr=0.0520 | 4222.3 samples/s | 16.5 steps/s
Avg test loss: 0.07666, Avg test acc: 0.96907, Avg tpr: 0.97896, Avg fpr: 0.05269, total FA: 411

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.96012 | acc=0.3292 | tpr=0.0329 | fpr=0.0273 | 4191.0 samples/s | 16.4 steps/s
Avg test loss: 5.96832, Avg test acc: 0.32747, Avg tpr: 0.03322, Avg fpr: 0.02538, total FA: 198

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.15556 | acc=0.3313 | tpr=0.0362 | fpr=0.0278 | 4259.0 samples/s | 16.6 steps/s
Avg test loss: 6.16755, Avg test acc: 0.32971, Avg tpr: 0.03713, Avg fpr: 0.02679, total FA: 209

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.58611 | acc=0.0988 | tpr=0.9558 | fpr=0.9166 | 4164.8 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.56923 | acc=0.1005 | tpr=0.9424 | fpr=0.9152 | 8353.7 samples/s | 32.6 steps/s
[Step= 150] | Loss=6.58861 | acc=0.1011 | tpr=0.9409 | fpr=0.9143 | 8212.8 samples/s | 32.1 steps/s
[Step= 200] | Loss=6.58190 | acc=0.1013 | tpr=0.9432 | fpr=0.9140 | 8903.9 samples/s | 34.8 steps/s
[Step= 250] | Loss=6.58011 | acc=0.1016 | tpr=0.9450 | fpr=0.9138 | 7827.8 samples/s | 30.6 steps/s
[Step= 300] | Loss=6.58249 | acc=0.1016 | tpr=0.9433 | fpr=0.9137 | 8471.9 samples/s | 33.1 steps/s
[Step= 350] | Loss=6.58263 | acc=0.1011 | tpr=0.9443 | fpr=0.9142 | 8354.2 samples/s | 32.6 steps/s
[Step= 400] | Loss=6.58354 | acc=0.1009 | tpr=0.9447 | fpr=0.9144 | 8389.1 samples/s | 32.8 steps/s
[Step= 450] | Loss=6.58679 | acc=0.1010 | tpr=0.9445 | fpr=0.9143 | 8259.9 samples/s | 32.3 steps/s
[Step= 500] | Loss=6.58724 | acc=0.1009 | tpr=0.9454 | fpr=0.9143 | 8248.9 samples/s | 32.2 steps/s
[Step= 550] | Loss=6.58545 | acc=0.1011 | tpr=0.9471 | fpr=0.9143 | 15617.3 samples/s | 61.0 steps/s
Avg test loss: 6.58600, Avg test acc: 0.10105, Avg tpr: 0.94731, Avg fpr: 0.91434, total FA: 126954

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.57936 | acc=0.0978 | tpr=0.9558 | fpr=0.9176 | 4245.6 samples/s | 16.6 steps/s
[Step= 100] | Loss=6.56659 | acc=0.1002 | tpr=0.9424 | fpr=0.9155 | 8069.3 samples/s | 31.5 steps/s
[Step= 150] | Loss=6.58751 | acc=0.1001 | tpr=0.9438 | fpr=0.9155 | 8568.8 samples/s | 33.5 steps/s
[Step= 200] | Loss=6.57974 | acc=0.1003 | tpr=0.9443 | fpr=0.9150 | 8243.5 samples/s | 32.2 steps/s
[Step= 250] | Loss=6.57793 | acc=0.1008 | tpr=0.9459 | fpr=0.9146 | 8097.3 samples/s | 31.6 steps/s
[Step= 300] | Loss=6.58098 | acc=0.1006 | tpr=0.9440 | fpr=0.9148 | 8387.4 samples/s | 32.8 steps/s
[Step= 350] | Loss=6.58198 | acc=0.1002 | tpr=0.9443 | fpr=0.9151 | 8313.7 samples/s | 32.5 steps/s
[Step= 400] | Loss=6.58283 | acc=0.1002 | tpr=0.9442 | fpr=0.9152 | 8547.0 samples/s | 33.4 steps/s
[Step= 450] | Loss=6.58657 | acc=0.1002 | tpr=0.9426 | fpr=0.9151 | 8092.0 samples/s | 31.6 steps/s
[Step= 500] | Loss=6.58679 | acc=0.1002 | tpr=0.9432 | fpr=0.9151 | 8192.4 samples/s | 32.0 steps/s
[Step= 550] | Loss=6.58531 | acc=0.1003 | tpr=0.9447 | fpr=0.9150 | 15333.4 samples/s | 59.9 steps/s
Avg test loss: 6.58610, Avg test acc: 0.10030, Avg tpr: 0.94493, Avg fpr: 0.91505, total FA: 127053

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11431 | acc=0.9818 | tpr=0.9513 | fpr=0.0177 | 4202.6 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.11969 | acc=0.9809 | tpr=0.9510 | fpr=0.0185 | 8050.5 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.12430 | acc=0.9801 | tpr=0.9553 | fpr=0.0194 | 8395.1 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.12568 | acc=0.9799 | tpr=0.9574 | fpr=0.0197 | 8273.9 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.12364 | acc=0.9797 | tpr=0.9555 | fpr=0.0199 | 8401.6 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.12693 | acc=0.9793 | tpr=0.9542 | fpr=0.0202 | 8184.5 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.12715 | acc=0.9793 | tpr=0.9549 | fpr=0.0202 | 8146.0 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.12834 | acc=0.9790 | tpr=0.9519 | fpr=0.0205 | 8391.3 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.13107 | acc=0.9787 | tpr=0.9503 | fpr=0.0208 | 8096.7 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.13034 | acc=0.9788 | tpr=0.9507 | fpr=0.0207 | 8224.6 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.12925 | acc=0.9790 | tpr=0.9491 | fpr=0.0205 | 15190.2 samples/s | 59.3 steps/s
Avg test loss: 0.12903, Avg test acc: 0.97901, Avg tpr: 0.94889, Avg fpr: 0.02045, total FA: 2839

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16646 | acc=0.9766 | tpr=0.9513 | fpr=0.0230 | 4195.3 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.17430 | acc=0.9754 | tpr=0.9488 | fpr=0.0241 | 8068.5 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.18227 | acc=0.9747 | tpr=0.9553 | fpr=0.0249 | 8376.8 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.18559 | acc=0.9746 | tpr=0.9596 | fpr=0.0251 | 8337.7 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.18231 | acc=0.9749 | tpr=0.9572 | fpr=0.0248 | 8533.5 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.18701 | acc=0.9745 | tpr=0.9571 | fpr=0.0252 | 8019.9 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.18725 | acc=0.9745 | tpr=0.9574 | fpr=0.0252 | 8369.3 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.18838 | acc=0.9743 | tpr=0.9557 | fpr=0.0253 | 8341.7 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.19181 | acc=0.9741 | tpr=0.9537 | fpr=0.0256 | 8020.3 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.19072 | acc=0.9742 | tpr=0.9537 | fpr=0.0254 | 8432.6 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.18922 | acc=0.9744 | tpr=0.9526 | fpr=0.0252 | 14639.2 samples/s | 57.2 steps/s
Avg test loss: 0.18895, Avg test acc: 0.97437, Avg tpr: 0.95246, Avg fpr: 0.02523, total FA: 3503

server round 42/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=52001 Epoch=101.4] | Loss=0.01945 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.357 | L2-Norm(final)=11.708 | 3985.1 samples/s | 62.3 steps/s
[Step=52050 Epoch=101.5] | Loss=0.00893 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=11.711 | 4875.0 samples/s | 76.2 steps/s
[Step=52100 Epoch=101.6] | Loss=0.00930 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.357 | L2-Norm(final)=11.713 | 5747.4 samples/s | 89.8 steps/s
[Step=52150 Epoch=101.7] | Loss=0.00917 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=11.715 | 5906.4 samples/s | 92.3 steps/s
[Step=52200 Epoch=101.8] | Loss=0.00932 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=11.717 | 5685.6 samples/s | 88.8 steps/s
[Step=52250 Epoch=101.9] | Loss=0.00917 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=11.719 | 5858.9 samples/s | 91.5 steps/s
[Step=52300 Epoch=102.0] | Loss=0.00953 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=11.721 | 5815.8 samples/s | 90.9 steps/s
[Step=52350 Epoch=102.1] | Loss=0.00955 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=11.723 | 5837.6 samples/s | 91.2 steps/s
[Step=52400 Epoch=102.2] | Loss=0.00941 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.357 | L2-Norm(final)=11.725 | 5789.9 samples/s | 90.5 steps/s
[Step=52450 Epoch=102.3] | Loss=0.00948 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=11.727 | 5756.3 samples/s | 89.9 steps/s
[Step=52500 Epoch=102.4] | Loss=0.00939 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=11.729 | 7387.7 samples/s | 115.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=52501 Epoch=102.4] | Loss=0.01841 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.357 | L2-Norm(final)=11.749 | 3757.8 samples/s | 58.7 steps/s
[Step=52550 Epoch=102.5] | Loss=0.00970 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.359 | L2-Norm(final)=11.750 | 4644.8 samples/s | 72.6 steps/s
[Step=52600 Epoch=102.6] | Loss=0.00967 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.362 | L2-Norm(final)=11.752 | 5049.0 samples/s | 78.9 steps/s
[Step=52650 Epoch=102.7] | Loss=0.00896 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.365 | L2-Norm(final)=11.753 | 5046.0 samples/s | 78.8 steps/s
[Step=52700 Epoch=102.8] | Loss=0.00869 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.367 | L2-Norm(final)=11.754 | 4957.2 samples/s | 77.5 steps/s
[Step=52750 Epoch=102.9] | Loss=0.00867 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.370 | L2-Norm(final)=11.756 | 4987.6 samples/s | 77.9 steps/s
[Step=52800 Epoch=103.0] | Loss=0.00883 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.373 | L2-Norm(final)=11.757 | 4993.6 samples/s | 78.0 steps/s
[Step=52850 Epoch=103.1] | Loss=0.00862 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.375 | L2-Norm(final)=11.758 | 5062.7 samples/s | 79.1 steps/s
[Step=52900 Epoch=103.2] | Loss=0.00832 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.377 | L2-Norm(final)=11.760 | 5035.9 samples/s | 78.7 steps/s
[Step=52950 Epoch=103.3] | Loss=0.00826 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.379 | L2-Norm(final)=11.761 | 5012.1 samples/s | 78.3 steps/s
[Step=53000 Epoch=103.4] | Loss=0.00799 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=11.762 | 6093.4 samples/s | 95.2 steps/s
[Step=53050 Epoch=103.5] | Loss=0.00781 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.383 | L2-Norm(final)=11.764 | 1871.3 samples/s | 29.2 steps/s
[Step=53100 Epoch=103.6] | Loss=0.00771 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.385 | L2-Norm(final)=11.765 | 5077.0 samples/s | 79.3 steps/s
[Step=53150 Epoch=103.7] | Loss=0.00749 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.386 | L2-Norm(final)=11.767 | 5029.0 samples/s | 78.6 steps/s
[Step=53200 Epoch=103.8] | Loss=0.00739 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.388 | L2-Norm(final)=11.768 | 4969.0 samples/s | 77.6 steps/s
[Step=53250 Epoch=103.9] | Loss=0.00740 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.390 | L2-Norm(final)=11.770 | 5038.7 samples/s | 78.7 steps/s
[Step=53300 Epoch=104.0] | Loss=0.00728 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.391 | L2-Norm(final)=11.771 | 5034.1 samples/s | 78.7 steps/s
[Step=53350 Epoch=104.1] | Loss=0.00723 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.393 | L2-Norm(final)=11.772 | 5004.2 samples/s | 78.2 steps/s
[Step=53400 Epoch=104.2] | Loss=0.00711 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.394 | L2-Norm(final)=11.774 | 5054.6 samples/s | 79.0 steps/s
[Step=53450 Epoch=104.2] | Loss=0.00696 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.395 | L2-Norm(final)=11.775 | 5080.1 samples/s | 79.4 steps/s
[Step=53500 Epoch=104.3] | Loss=0.00695 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.397 | L2-Norm(final)=11.776 | 5304.0 samples/s | 82.9 steps/s
[Step=53550 Epoch=104.4] | Loss=0.00680 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.398 | L2-Norm(final)=11.777 | 1976.0 samples/s | 30.9 steps/s
[Step=53600 Epoch=104.5] | Loss=0.00672 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.399 | L2-Norm(final)=11.779 | 5146.8 samples/s | 80.4 steps/s
[Step=53650 Epoch=104.6] | Loss=0.00667 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.401 | L2-Norm(final)=11.780 | 4997.6 samples/s | 78.1 steps/s
[Step=53700 Epoch=104.7] | Loss=0.00663 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.402 | L2-Norm(final)=11.781 | 5031.2 samples/s | 78.6 steps/s
[Step=53750 Epoch=104.8] | Loss=0.00656 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.403 | L2-Norm(final)=11.782 | 5030.3 samples/s | 78.6 steps/s
[Step=53800 Epoch=104.9] | Loss=0.00652 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.404 | L2-Norm(final)=11.784 | 4958.2 samples/s | 77.5 steps/s
[Step=53850 Epoch=105.0] | Loss=0.00649 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.405 | L2-Norm(final)=11.785 | 5038.7 samples/s | 78.7 steps/s
[Step=53900 Epoch=105.1] | Loss=0.00644 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.407 | L2-Norm(final)=11.786 | 4989.3 samples/s | 78.0 steps/s
[Step=53950 Epoch=105.2] | Loss=0.00640 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.408 | L2-Norm(final)=11.787 | 5047.2 samples/s | 78.9 steps/s
[Step=54000 Epoch=105.3] | Loss=0.00636 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.409 | L2-Norm(final)=11.789 | 5016.3 samples/s | 78.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step54000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=44001 Epoch=168.6] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=11.647 | 3861.3 samples/s | 60.3 steps/s
[Step=44050 Epoch=168.8] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=11.649 | 5072.2 samples/s | 79.3 steps/s
[Step=44100 Epoch=169.0] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=11.651 | 5606.4 samples/s | 87.6 steps/s
[Step=44150 Epoch=169.2] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=11.653 | 5404.5 samples/s | 84.4 steps/s
[Step=44200 Epoch=169.4] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=11.656 | 5391.1 samples/s | 84.2 steps/s
[Step=44250 Epoch=169.6] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=11.658 | 7183.9 samples/s | 112.2 steps/s
[Step=44300 Epoch=169.7] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=11.660 | 1973.5 samples/s | 30.8 steps/s
[Step=44350 Epoch=169.9] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=11.662 | 5455.6 samples/s | 85.2 steps/s
[Step=44400 Epoch=170.1] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=11.663 | 5424.3 samples/s | 84.8 steps/s
[Step=44450 Epoch=170.3] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=11.665 | 5426.1 samples/s | 84.8 steps/s
[Step=44500 Epoch=170.5] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=11.667 | 6134.7 samples/s | 95.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=170.5] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=11.687 | 3839.0 samples/s | 60.0 steps/s
[Step=44550 Epoch=170.7] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.349 | L2-Norm(final)=11.689 | 4505.1 samples/s | 70.4 steps/s
[Step=44600 Epoch=170.9] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=11.690 | 4825.5 samples/s | 75.4 steps/s
[Step=44650 Epoch=171.1] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.332 | L2-Norm(final)=11.691 | 4760.6 samples/s | 74.4 steps/s
[Step=44700 Epoch=171.3] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.323 | L2-Norm(final)=11.692 | 4709.6 samples/s | 73.6 steps/s
[Step=44750 Epoch=171.5] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.315 | L2-Norm(final)=11.693 | 6034.2 samples/s | 94.3 steps/s
[Step=44800 Epoch=171.7] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.306 | L2-Norm(final)=11.694 | 1888.5 samples/s | 29.5 steps/s
[Step=44850 Epoch=171.8] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.297 | L2-Norm(final)=11.695 | 4726.3 samples/s | 73.8 steps/s
[Step=44900 Epoch=172.0] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=11.696 | 4827.2 samples/s | 75.4 steps/s
[Step=44950 Epoch=172.2] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.279 | L2-Norm(final)=11.697 | 4792.6 samples/s | 74.9 steps/s
[Step=45000 Epoch=172.4] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.270 | L2-Norm(final)=11.698 | 5231.9 samples/s | 81.7 steps/s
[Step=45050 Epoch=172.6] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.261 | L2-Norm(final)=11.698 | 1982.3 samples/s | 31.0 steps/s
[Step=45100 Epoch=172.8] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.251 | L2-Norm(final)=11.699 | 4787.6 samples/s | 74.8 steps/s
[Step=45150 Epoch=173.0] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.242 | L2-Norm(final)=11.700 | 4749.8 samples/s | 74.2 steps/s
[Step=45200 Epoch=173.2] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.232 | L2-Norm(final)=11.701 | 4860.0 samples/s | 75.9 steps/s
[Step=45250 Epoch=173.4] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.222 | L2-Norm(final)=11.702 | 4675.7 samples/s | 73.1 steps/s
[Step=45300 Epoch=173.6] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.213 | L2-Norm(final)=11.703 | 2040.3 samples/s | 31.9 steps/s
[Step=45350 Epoch=173.8] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.203 | L2-Norm(final)=11.703 | 4951.9 samples/s | 77.4 steps/s
[Step=45400 Epoch=174.0] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.193 | L2-Norm(final)=11.704 | 4880.2 samples/s | 76.3 steps/s
[Step=45450 Epoch=174.1] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.183 | L2-Norm(final)=11.705 | 4680.7 samples/s | 73.1 steps/s
[Step=45500 Epoch=174.3] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.173 | L2-Norm(final)=11.706 | 4777.3 samples/s | 74.6 steps/s
[Step=45550 Epoch=174.5] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.162 | L2-Norm(final)=11.707 | 2066.4 samples/s | 32.3 steps/s
[Step=45600 Epoch=174.7] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.152 | L2-Norm(final)=11.707 | 4795.9 samples/s | 74.9 steps/s
[Step=45650 Epoch=174.9] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.141 | L2-Norm(final)=11.708 | 4701.7 samples/s | 73.5 steps/s
[Step=45700 Epoch=175.1] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.131 | L2-Norm(final)=11.709 | 4615.0 samples/s | 72.1 steps/s
[Step=45750 Epoch=175.3] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.120 | L2-Norm(final)=11.710 | 4704.0 samples/s | 73.5 steps/s
[Step=45800 Epoch=175.5] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.109 | L2-Norm(final)=11.711 | 6437.8 samples/s | 100.6 steps/s
[Step=45850 Epoch=175.7] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.099 | L2-Norm(final)=11.712 | 1860.8 samples/s | 29.1 steps/s
[Step=45900 Epoch=175.9] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=11.713 | 4691.5 samples/s | 73.3 steps/s
[Step=45950 Epoch=176.1] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.077 | L2-Norm(final)=11.713 | 4799.8 samples/s | 75.0 steps/s
[Step=46000 Epoch=176.3] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.065 | L2-Norm(final)=11.714 | 4728.8 samples/s | 73.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step46000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07304 | acc=0.9698 | tpr=0.9773 | fpr=0.0466 | 4157.3 samples/s | 16.2 steps/s
Avg test loss: 0.07617, Avg test acc: 0.96871, Avg tpr: 0.97628, Avg fpr: 0.04794, total FA: 374

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07275 | acc=0.9695 | tpr=0.9795 | fpr=0.0520 | 4159.4 samples/s | 16.2 steps/s
Avg test loss: 0.07666, Avg test acc: 0.96907, Avg tpr: 0.97896, Avg fpr: 0.05269, total FA: 411

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.92023 | acc=0.3282 | tpr=0.0309 | fpr=0.0263 | 4175.0 samples/s | 16.3 steps/s
Avg test loss: 5.93008, Avg test acc: 0.32651, Avg tpr: 0.03142, Avg fpr: 0.02448, total FA: 191

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.15556 | acc=0.3313 | tpr=0.0362 | fpr=0.0278 | 4258.1 samples/s | 16.6 steps/s
Avg test loss: 6.16755, Avg test acc: 0.32971, Avg tpr: 0.03713, Avg fpr: 0.02679, total FA: 209

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.58739 | acc=0.0951 | tpr=0.9513 | fpr=0.9203 | 4202.8 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.57010 | acc=0.0970 | tpr=0.9382 | fpr=0.9187 | 8311.7 samples/s | 32.5 steps/s
[Step= 150] | Loss=6.58915 | acc=0.0972 | tpr=0.9337 | fpr=0.9182 | 8043.0 samples/s | 31.4 steps/s
[Step= 200] | Loss=6.58262 | acc=0.0972 | tpr=0.9366 | fpr=0.9180 | 8422.5 samples/s | 32.9 steps/s
[Step= 250] | Loss=6.58151 | acc=0.0976 | tpr=0.9389 | fpr=0.9177 | 8262.2 samples/s | 32.3 steps/s
[Step= 300] | Loss=6.58418 | acc=0.0976 | tpr=0.9375 | fpr=0.9177 | 8397.2 samples/s | 32.8 steps/s
[Step= 350] | Loss=6.58434 | acc=0.0971 | tpr=0.9399 | fpr=0.9182 | 8513.5 samples/s | 33.3 steps/s
[Step= 400] | Loss=6.58442 | acc=0.0970 | tpr=0.9398 | fpr=0.9183 | 8758.0 samples/s | 34.2 steps/s
[Step= 450] | Loss=6.58751 | acc=0.0970 | tpr=0.9391 | fpr=0.9183 | 7926.9 samples/s | 31.0 steps/s
[Step= 500] | Loss=6.58774 | acc=0.0968 | tpr=0.9392 | fpr=0.9184 | 8417.7 samples/s | 32.9 steps/s
[Step= 550] | Loss=6.58595 | acc=0.0970 | tpr=0.9403 | fpr=0.9184 | 14435.7 samples/s | 56.4 steps/s
Avg test loss: 6.58647, Avg test acc: 0.09694, Avg tpr: 0.94057, Avg fpr: 0.91839, total FA: 127517

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.57936 | acc=0.0978 | tpr=0.9558 | fpr=0.9176 | 4191.5 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.56659 | acc=0.1002 | tpr=0.9424 | fpr=0.9155 | 8080.2 samples/s | 31.6 steps/s
[Step= 150] | Loss=6.58751 | acc=0.1001 | tpr=0.9438 | fpr=0.9155 | 8616.9 samples/s | 33.7 steps/s
[Step= 200] | Loss=6.57974 | acc=0.1003 | tpr=0.9443 | fpr=0.9150 | 8128.7 samples/s | 31.8 steps/s
[Step= 250] | Loss=6.57793 | acc=0.1008 | tpr=0.9459 | fpr=0.9146 | 8645.2 samples/s | 33.8 steps/s
[Step= 300] | Loss=6.58098 | acc=0.1006 | tpr=0.9440 | fpr=0.9148 | 8270.2 samples/s | 32.3 steps/s
[Step= 350] | Loss=6.58198 | acc=0.1002 | tpr=0.9443 | fpr=0.9151 | 8064.6 samples/s | 31.5 steps/s
[Step= 400] | Loss=6.58283 | acc=0.1002 | tpr=0.9442 | fpr=0.9152 | 8495.4 samples/s | 33.2 steps/s
[Step= 450] | Loss=6.58657 | acc=0.1002 | tpr=0.9426 | fpr=0.9151 | 8131.1 samples/s | 31.8 steps/s
[Step= 500] | Loss=6.58679 | acc=0.1002 | tpr=0.9432 | fpr=0.9151 | 8148.3 samples/s | 31.8 steps/s
[Step= 550] | Loss=6.58531 | acc=0.1003 | tpr=0.9447 | fpr=0.9150 | 15211.7 samples/s | 59.4 steps/s
Avg test loss: 6.58610, Avg test acc: 0.10030, Avg tpr: 0.94493, Avg fpr: 0.91505, total FA: 127053

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11364 | acc=0.9820 | tpr=0.9558 | fpr=0.0175 | 4238.3 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.11889 | acc=0.9811 | tpr=0.9552 | fpr=0.0184 | 7558.2 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.12376 | acc=0.9800 | tpr=0.9582 | fpr=0.0196 | 8407.7 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.12527 | acc=0.9798 | tpr=0.9596 | fpr=0.0198 | 8130.8 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.12328 | acc=0.9797 | tpr=0.9572 | fpr=0.0199 | 8227.4 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.12662 | acc=0.9793 | tpr=0.9556 | fpr=0.0203 | 8313.6 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.12679 | acc=0.9793 | tpr=0.9562 | fpr=0.0203 | 8348.1 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.12785 | acc=0.9790 | tpr=0.9546 | fpr=0.0205 | 8257.9 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.13047 | acc=0.9787 | tpr=0.9528 | fpr=0.0208 | 8307.9 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.12978 | acc=0.9788 | tpr=0.9529 | fpr=0.0207 | 8361.0 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.12876 | acc=0.9790 | tpr=0.9515 | fpr=0.0205 | 15016.9 samples/s | 58.7 steps/s
Avg test loss: 0.12856, Avg test acc: 0.97899, Avg tpr: 0.95127, Avg fpr: 0.02050, total FA: 2847

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.16646 | acc=0.9766 | tpr=0.9513 | fpr=0.0230 | 4162.3 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.17430 | acc=0.9754 | tpr=0.9488 | fpr=0.0241 | 8418.0 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.18227 | acc=0.9747 | tpr=0.9553 | fpr=0.0249 | 8354.8 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.18559 | acc=0.9746 | tpr=0.9596 | fpr=0.0251 | 8349.7 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.18231 | acc=0.9749 | tpr=0.9572 | fpr=0.0248 | 8200.1 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.18701 | acc=0.9745 | tpr=0.9571 | fpr=0.0252 | 8124.2 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.18725 | acc=0.9745 | tpr=0.9574 | fpr=0.0252 | 8362.1 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.18838 | acc=0.9743 | tpr=0.9557 | fpr=0.0253 | 8138.7 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.19181 | acc=0.9741 | tpr=0.9537 | fpr=0.0256 | 8597.1 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.19072 | acc=0.9742 | tpr=0.9537 | fpr=0.0254 | 8132.7 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.18922 | acc=0.9744 | tpr=0.9526 | fpr=0.0252 | 14631.5 samples/s | 57.2 steps/s
Avg test loss: 0.18895, Avg test acc: 0.97437, Avg tpr: 0.95246, Avg fpr: 0.02523, total FA: 3503

server round 43/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=46001 Epoch=176.3] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.236 | L2-Norm(final)=11.741 | 3857.7 samples/s | 60.3 steps/s
[Step=46050 Epoch=176.4] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.232 | L2-Norm(final)=11.746 | 5054.8 samples/s | 79.0 steps/s
[Step=46100 Epoch=176.6] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.232 | L2-Norm(final)=11.750 | 5664.0 samples/s | 88.5 steps/s
[Step=46150 Epoch=176.8] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.231 | L2-Norm(final)=11.754 | 5287.2 samples/s | 82.6 steps/s
[Step=46200 Epoch=177.0] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.231 | L2-Norm(final)=11.757 | 5489.2 samples/s | 85.8 steps/s
[Step=46250 Epoch=177.2] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.231 | L2-Norm(final)=11.761 | 7226.5 samples/s | 112.9 steps/s
[Step=46300 Epoch=177.4] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.231 | L2-Norm(final)=11.764 | 1950.8 samples/s | 30.5 steps/s
[Step=46350 Epoch=177.6] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.231 | L2-Norm(final)=11.767 | 5464.2 samples/s | 85.4 steps/s
[Step=46400 Epoch=177.8] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.231 | L2-Norm(final)=11.770 | 5453.0 samples/s | 85.2 steps/s
[Step=46450 Epoch=178.0] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.231 | L2-Norm(final)=11.773 | 5444.3 samples/s | 85.1 steps/s
[Step=46500 Epoch=178.2] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.231 | L2-Norm(final)=11.777 | 6162.9 samples/s | 96.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=178.2] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.231 | L2-Norm(final)=11.810 | 3674.2 samples/s | 57.4 steps/s
[Step=46550 Epoch=178.4] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.220 | L2-Norm(final)=11.812 | 4703.3 samples/s | 73.5 steps/s
[Step=46600 Epoch=178.6] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.203 | L2-Norm(final)=11.814 | 4731.2 samples/s | 73.9 steps/s
[Step=46650 Epoch=178.7] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.185 | L2-Norm(final)=11.816 | 4753.7 samples/s | 74.3 steps/s
[Step=46700 Epoch=178.9] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.167 | L2-Norm(final)=11.817 | 4756.8 samples/s | 74.3 steps/s
[Step=46750 Epoch=179.1] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.149 | L2-Norm(final)=11.818 | 6016.1 samples/s | 94.0 steps/s
[Step=46800 Epoch=179.3] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.131 | L2-Norm(final)=11.819 | 1901.4 samples/s | 29.7 steps/s
[Step=46850 Epoch=179.5] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.112 | L2-Norm(final)=11.820 | 4806.9 samples/s | 75.1 steps/s
[Step=46900 Epoch=179.7] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.093 | L2-Norm(final)=11.821 | 4892.1 samples/s | 76.4 steps/s
[Step=46950 Epoch=179.9] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.075 | L2-Norm(final)=11.821 | 4810.0 samples/s | 75.2 steps/s
[Step=47000 Epoch=180.1] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.056 | L2-Norm(final)=11.822 | 5366.3 samples/s | 83.8 steps/s
[Step=47050 Epoch=180.3] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.037 | L2-Norm(final)=11.823 | 1988.7 samples/s | 31.1 steps/s
[Step=47100 Epoch=180.5] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.018 | L2-Norm(final)=11.824 | 4676.1 samples/s | 73.1 steps/s
[Step=47150 Epoch=180.7] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.999 | L2-Norm(final)=11.825 | 4759.0 samples/s | 74.4 steps/s
[Step=47200 Epoch=180.9] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.979 | L2-Norm(final)=11.825 | 4810.5 samples/s | 75.2 steps/s
[Step=47250 Epoch=181.0] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.960 | L2-Norm(final)=11.826 | 4756.5 samples/s | 74.3 steps/s
[Step=47300 Epoch=181.2] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.941 | L2-Norm(final)=11.827 | 2024.2 samples/s | 31.6 steps/s
[Step=47350 Epoch=181.4] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.921 | L2-Norm(final)=11.828 | 4902.5 samples/s | 76.6 steps/s
[Step=47400 Epoch=181.6] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.901 | L2-Norm(final)=11.829 | 4721.4 samples/s | 73.8 steps/s
[Step=47450 Epoch=181.8] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.882 | L2-Norm(final)=11.829 | 4739.2 samples/s | 74.0 steps/s
[Step=47500 Epoch=182.0] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.862 | L2-Norm(final)=11.830 | 4797.3 samples/s | 75.0 steps/s
[Step=47550 Epoch=182.2] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.842 | L2-Norm(final)=11.831 | 2051.7 samples/s | 32.1 steps/s
[Step=47600 Epoch=182.4] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.822 | L2-Norm(final)=11.832 | 4760.8 samples/s | 74.4 steps/s
[Step=47650 Epoch=182.6] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.802 | L2-Norm(final)=11.833 | 4775.5 samples/s | 74.6 steps/s
[Step=47700 Epoch=182.8] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.781 | L2-Norm(final)=11.834 | 4746.5 samples/s | 74.2 steps/s
[Step=47750 Epoch=183.0] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.761 | L2-Norm(final)=11.835 | 4762.9 samples/s | 74.4 steps/s
[Step=47800 Epoch=183.2] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.741 | L2-Norm(final)=11.836 | 6471.5 samples/s | 101.1 steps/s
[Step=47850 Epoch=183.3] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.720 | L2-Norm(final)=11.837 | 1841.2 samples/s | 28.8 steps/s
[Step=47900 Epoch=183.5] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.699 | L2-Norm(final)=11.839 | 4800.2 samples/s | 75.0 steps/s
[Step=47950 Epoch=183.7] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.678 | L2-Norm(final)=11.840 | 4738.9 samples/s | 74.0 steps/s
[Step=48000 Epoch=183.9] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.658 | L2-Norm(final)=11.841 | 4800.1 samples/s | 75.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step48000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=32001 Epoch=123.2] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.236 | L2-Norm(final)=12.004 | 3926.4 samples/s | 61.3 steps/s
[Step=32050 Epoch=123.4] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.235 | L2-Norm(final)=12.006 | 4851.8 samples/s | 75.8 steps/s
[Step=32100 Epoch=123.6] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.235 | L2-Norm(final)=12.007 | 5369.6 samples/s | 83.9 steps/s
[Step=32150 Epoch=123.8] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.235 | L2-Norm(final)=12.010 | 5626.7 samples/s | 87.9 steps/s
[Step=32200 Epoch=124.0] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.235 | L2-Norm(final)=12.011 | 5444.7 samples/s | 85.1 steps/s
[Step=32250 Epoch=124.1] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.235 | L2-Norm(final)=12.013 | 7292.5 samples/s | 113.9 steps/s
[Step=32300 Epoch=124.3] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.235 | L2-Norm(final)=12.014 | 1937.9 samples/s | 30.3 steps/s
[Step=32350 Epoch=124.5] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.235 | L2-Norm(final)=12.015 | 5606.8 samples/s | 87.6 steps/s
[Step=32400 Epoch=124.7] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.235 | L2-Norm(final)=12.017 | 5304.3 samples/s | 82.9 steps/s
[Step=32450 Epoch=124.9] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.235 | L2-Norm(final)=12.018 | 5450.0 samples/s | 85.2 steps/s
[Step=32500 Epoch=125.1] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.235 | L2-Norm(final)=12.020 | 6325.7 samples/s | 98.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=32501 Epoch=125.1] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.235 | L2-Norm(final)=12.036 | 3963.5 samples/s | 61.9 steps/s
[Step=32550 Epoch=125.3] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.233 | L2-Norm(final)=12.037 | 4382.7 samples/s | 68.5 steps/s
[Step=32600 Epoch=125.5] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.231 | L2-Norm(final)=12.038 | 4794.5 samples/s | 74.9 steps/s
[Step=32650 Epoch=125.7] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.228 | L2-Norm(final)=12.039 | 4828.8 samples/s | 75.5 steps/s
[Step=32700 Epoch=125.9] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.225 | L2-Norm(final)=12.040 | 4739.2 samples/s | 74.1 steps/s
[Step=32750 Epoch=126.1] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.221 | L2-Norm(final)=12.040 | 6155.8 samples/s | 96.2 steps/s
[Step=32800 Epoch=126.3] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.218 | L2-Norm(final)=12.041 | 1875.2 samples/s | 29.3 steps/s
[Step=32850 Epoch=126.5] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.215 | L2-Norm(final)=12.042 | 4730.8 samples/s | 73.9 steps/s
[Step=32900 Epoch=126.6] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.212 | L2-Norm(final)=12.043 | 4787.9 samples/s | 74.8 steps/s
[Step=32950 Epoch=126.8] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.208 | L2-Norm(final)=12.044 | 4753.6 samples/s | 74.3 steps/s
[Step=33000 Epoch=127.0] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.205 | L2-Norm(final)=12.045 | 5414.4 samples/s | 84.6 steps/s
[Step=33050 Epoch=127.2] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.201 | L2-Norm(final)=12.045 | 1960.1 samples/s | 30.6 steps/s
[Step=33100 Epoch=127.4] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.198 | L2-Norm(final)=12.046 | 4896.9 samples/s | 76.5 steps/s
[Step=33150 Epoch=127.6] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.194 | L2-Norm(final)=12.047 | 4708.1 samples/s | 73.6 steps/s
[Step=33200 Epoch=127.8] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=12.047 | 4738.7 samples/s | 74.0 steps/s
[Step=33250 Epoch=128.0] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.187 | L2-Norm(final)=12.048 | 4857.1 samples/s | 75.9 steps/s
[Step=33300 Epoch=128.2] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.183 | L2-Norm(final)=12.049 | 2025.6 samples/s | 31.7 steps/s
[Step=33350 Epoch=128.4] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.179 | L2-Norm(final)=12.050 | 4898.0 samples/s | 76.5 steps/s
[Step=33400 Epoch=128.6] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.175 | L2-Norm(final)=12.050 | 4752.1 samples/s | 74.3 steps/s
[Step=33450 Epoch=128.8] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.171 | L2-Norm(final)=12.051 | 4737.1 samples/s | 74.0 steps/s
[Step=33500 Epoch=129.0] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.167 | L2-Norm(final)=12.052 | 4824.2 samples/s | 75.4 steps/s
[Step=33550 Epoch=129.1] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.163 | L2-Norm(final)=12.052 | 2039.7 samples/s | 31.9 steps/s
[Step=33600 Epoch=129.3] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.159 | L2-Norm(final)=12.053 | 4864.6 samples/s | 76.0 steps/s
[Step=33650 Epoch=129.5] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=12.053 | 4751.3 samples/s | 74.2 steps/s
[Step=33700 Epoch=129.7] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=12.054 | 4889.6 samples/s | 76.4 steps/s
[Step=33750 Epoch=129.9] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.146 | L2-Norm(final)=12.055 | 4711.3 samples/s | 73.6 steps/s
[Step=33800 Epoch=130.1] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.142 | L2-Norm(final)=12.055 | 6932.2 samples/s | 108.3 steps/s
[Step=33850 Epoch=130.3] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.138 | L2-Norm(final)=12.056 | 1807.1 samples/s | 28.2 steps/s
[Step=33900 Epoch=130.5] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.133 | L2-Norm(final)=12.057 | 4697.1 samples/s | 73.4 steps/s
[Step=33950 Epoch=130.7] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.129 | L2-Norm(final)=12.057 | 4829.1 samples/s | 75.5 steps/s
[Step=34000 Epoch=130.9] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.124 | L2-Norm(final)=12.058 | 4700.2 samples/s | 73.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_1/client_state-step34000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07304 | acc=0.9698 | tpr=0.9773 | fpr=0.0466 | 4053.2 samples/s | 15.8 steps/s
Avg test loss: 0.07617, Avg test acc: 0.96871, Avg tpr: 0.97628, Avg fpr: 0.04794, total FA: 374

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07275 | acc=0.9695 | tpr=0.9795 | fpr=0.0520 | 4061.3 samples/s | 15.9 steps/s
Avg test loss: 0.07666, Avg test acc: 0.96907, Avg tpr: 0.97896, Avg fpr: 0.05269, total FA: 411

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.67670 | acc=0.3261 | tpr=0.0284 | fpr=0.0275 | 4401.7 samples/s | 17.2 steps/s
Avg test loss: 5.68399, Avg test acc: 0.32459, Avg tpr: 0.02914, Avg fpr: 0.02564, total FA: 200

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.65659 | acc=0.3359 | tpr=0.0439 | fpr=0.0300 | 4208.6 samples/s | 16.4 steps/s
Avg test loss: 5.66380, Avg test acc: 0.33476, Avg tpr: 0.04494, Avg fpr: 0.02782, total FA: 217

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.58739 | acc=0.0951 | tpr=0.9513 | fpr=0.9203 | 4232.4 samples/s | 16.5 steps/s
[Step= 100] | Loss=6.57010 | acc=0.0970 | tpr=0.9382 | fpr=0.9187 | 8306.1 samples/s | 32.4 steps/s
[Step= 150] | Loss=6.58915 | acc=0.0972 | tpr=0.9337 | fpr=0.9182 | 8101.2 samples/s | 31.6 steps/s
[Step= 200] | Loss=6.58262 | acc=0.0972 | tpr=0.9366 | fpr=0.9180 | 8453.4 samples/s | 33.0 steps/s
[Step= 250] | Loss=6.58151 | acc=0.0976 | tpr=0.9389 | fpr=0.9177 | 8254.4 samples/s | 32.2 steps/s
[Step= 300] | Loss=6.58418 | acc=0.0976 | tpr=0.9375 | fpr=0.9177 | 8444.2 samples/s | 33.0 steps/s
[Step= 350] | Loss=6.58434 | acc=0.0971 | tpr=0.9399 | fpr=0.9182 | 8227.0 samples/s | 32.1 steps/s
[Step= 400] | Loss=6.58442 | acc=0.0970 | tpr=0.9398 | fpr=0.9183 | 8198.6 samples/s | 32.0 steps/s
[Step= 450] | Loss=6.58751 | acc=0.0970 | tpr=0.9391 | fpr=0.9183 | 8512.7 samples/s | 33.3 steps/s
[Step= 500] | Loss=6.58774 | acc=0.0968 | tpr=0.9392 | fpr=0.9184 | 8008.0 samples/s | 31.3 steps/s
[Step= 550] | Loss=6.58595 | acc=0.0970 | tpr=0.9403 | fpr=0.9184 | 15405.4 samples/s | 60.2 steps/s
Avg test loss: 6.58647, Avg test acc: 0.09694, Avg tpr: 0.94057, Avg fpr: 0.91839, total FA: 127517

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.57936 | acc=0.0978 | tpr=0.9558 | fpr=0.9176 | 4252.6 samples/s | 16.6 steps/s
[Step= 100] | Loss=6.56659 | acc=0.1002 | tpr=0.9424 | fpr=0.9155 | 8103.7 samples/s | 31.7 steps/s
[Step= 150] | Loss=6.58751 | acc=0.1001 | tpr=0.9438 | fpr=0.9155 | 8388.2 samples/s | 32.8 steps/s
[Step= 200] | Loss=6.57974 | acc=0.1003 | tpr=0.9443 | fpr=0.9150 | 8527.6 samples/s | 33.3 steps/s
[Step= 250] | Loss=6.57793 | acc=0.1008 | tpr=0.9459 | fpr=0.9146 | 8060.0 samples/s | 31.5 steps/s
[Step= 300] | Loss=6.58098 | acc=0.1006 | tpr=0.9440 | fpr=0.9148 | 8043.4 samples/s | 31.4 steps/s
[Step= 350] | Loss=6.58198 | acc=0.1002 | tpr=0.9443 | fpr=0.9151 | 8381.4 samples/s | 32.7 steps/s
[Step= 400] | Loss=6.58283 | acc=0.1002 | tpr=0.9442 | fpr=0.9152 | 8221.7 samples/s | 32.1 steps/s
[Step= 450] | Loss=6.58657 | acc=0.1002 | tpr=0.9426 | fpr=0.9151 | 8404.7 samples/s | 32.8 steps/s
[Step= 500] | Loss=6.58679 | acc=0.1002 | tpr=0.9432 | fpr=0.9151 | 8237.2 samples/s | 32.2 steps/s
[Step= 550] | Loss=6.58531 | acc=0.1003 | tpr=0.9447 | fpr=0.9150 | 15242.2 samples/s | 59.5 steps/s
Avg test loss: 6.58610, Avg test acc: 0.10030, Avg tpr: 0.94493, Avg fpr: 0.91505, total FA: 127053

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10911 | acc=0.9811 | tpr=0.9558 | fpr=0.0185 | 4126.5 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.11388 | acc=0.9807 | tpr=0.9552 | fpr=0.0188 | 8312.5 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.11902 | acc=0.9796 | tpr=0.9582 | fpr=0.0200 | 8420.5 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.12074 | acc=0.9796 | tpr=0.9607 | fpr=0.0201 | 8547.1 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.11887 | acc=0.9794 | tpr=0.9581 | fpr=0.0203 | 8094.1 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.12201 | acc=0.9789 | tpr=0.9564 | fpr=0.0206 | 8386.6 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.12211 | acc=0.9790 | tpr=0.9568 | fpr=0.0206 | 8621.2 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.12302 | acc=0.9788 | tpr=0.9557 | fpr=0.0208 | 7978.9 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.12549 | acc=0.9785 | tpr=0.9542 | fpr=0.0211 | 8369.3 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.12481 | acc=0.9786 | tpr=0.9546 | fpr=0.0210 | 8195.6 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.12395 | acc=0.9787 | tpr=0.9526 | fpr=0.0208 | 15325.5 samples/s | 59.9 steps/s
Avg test loss: 0.12374, Avg test acc: 0.97872, Avg tpr: 0.95246, Avg fpr: 0.02081, total FA: 2889

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14342 | acc=0.9780 | tpr=0.9558 | fpr=0.0216 | 4242.9 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.14948 | acc=0.9768 | tpr=0.9574 | fpr=0.0229 | 8163.5 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.15535 | acc=0.9759 | tpr=0.9625 | fpr=0.0239 | 8218.8 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.15748 | acc=0.9758 | tpr=0.9661 | fpr=0.0240 | 8387.3 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.15537 | acc=0.9758 | tpr=0.9642 | fpr=0.0240 | 8412.2 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.15945 | acc=0.9755 | tpr=0.9622 | fpr=0.0243 | 8026.6 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.15980 | acc=0.9755 | tpr=0.9624 | fpr=0.0242 | 8234.1 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.16095 | acc=0.9754 | tpr=0.9606 | fpr=0.0244 | 8582.0 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.16406 | acc=0.9751 | tpr=0.9581 | fpr=0.0246 | 8546.7 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.16336 | acc=0.9751 | tpr=0.9577 | fpr=0.0245 | 7662.5 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.16196 | acc=0.9753 | tpr=0.9562 | fpr=0.0244 | 16033.6 samples/s | 62.6 steps/s
Avg test loss: 0.16171, Avg test acc: 0.97527, Avg tpr: 0.95602, Avg fpr: 0.02438, total FA: 3385

server round 44/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=40001 Epoch=78.2] | Loss=0.00275 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.971 | L2-Norm(final)=11.353 | 3914.4 samples/s | 61.2 steps/s
[Step=40050 Epoch=78.3] | Loss=0.00817 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.971 | L2-Norm(final)=11.356 | 5175.9 samples/s | 80.9 steps/s
[Step=40100 Epoch=78.4] | Loss=0.00930 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.971 | L2-Norm(final)=11.360 | 5673.6 samples/s | 88.6 steps/s
[Step=40150 Epoch=78.5] | Loss=0.00903 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.971 | L2-Norm(final)=11.364 | 5825.7 samples/s | 91.0 steps/s
[Step=40200 Epoch=78.6] | Loss=0.00890 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.971 | L2-Norm(final)=11.368 | 5716.8 samples/s | 89.3 steps/s
[Step=40250 Epoch=78.7] | Loss=0.00890 | Reg=0.00120 | acc=0.9688 | L2-Norm=10.971 | L2-Norm(final)=11.372 | 5759.7 samples/s | 90.0 steps/s
[Step=40300 Epoch=78.8] | Loss=0.00883 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.971 | L2-Norm(final)=11.376 | 5817.7 samples/s | 90.9 steps/s
[Step=40350 Epoch=78.9] | Loss=0.00873 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.971 | L2-Norm(final)=11.380 | 5750.0 samples/s | 89.8 steps/s
[Step=40400 Epoch=79.0] | Loss=0.00866 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.971 | L2-Norm(final)=11.384 | 5928.4 samples/s | 92.6 steps/s
[Step=40450 Epoch=79.1] | Loss=0.00872 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.971 | L2-Norm(final)=11.388 | 5888.3 samples/s | 92.0 steps/s
[Step=40500 Epoch=79.2] | Loss=0.00886 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.971 | L2-Norm(final)=11.391 | 7597.3 samples/s | 118.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=40501 Epoch=79.2] | Loss=0.00503 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.971 | L2-Norm(final)=11.429 | 4029.3 samples/s | 63.0 steps/s
[Step=40550 Epoch=79.3] | Loss=0.01008 | Reg=0.00120 | acc=0.9531 | L2-Norm=10.976 | L2-Norm(final)=11.431 | 4748.8 samples/s | 74.2 steps/s
[Step=40600 Epoch=79.4] | Loss=0.01015 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.981 | L2-Norm(final)=11.432 | 5038.3 samples/s | 78.7 steps/s
[Step=40650 Epoch=79.5] | Loss=0.00993 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.986 | L2-Norm(final)=11.434 | 5005.8 samples/s | 78.2 steps/s
[Step=40700 Epoch=79.6] | Loss=0.00984 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.989 | L2-Norm(final)=11.436 | 5001.1 samples/s | 78.1 steps/s
[Step=40750 Epoch=79.7] | Loss=0.00941 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.992 | L2-Norm(final)=11.437 | 5033.0 samples/s | 78.6 steps/s
[Step=40800 Epoch=79.8] | Loss=0.00924 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.995 | L2-Norm(final)=11.439 | 5008.1 samples/s | 78.3 steps/s
[Step=40850 Epoch=79.9] | Loss=0.00900 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.998 | L2-Norm(final)=11.441 | 5048.1 samples/s | 78.9 steps/s
[Step=40900 Epoch=80.0] | Loss=0.00903 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.001 | L2-Norm(final)=11.442 | 5002.4 samples/s | 78.2 steps/s
[Step=40950 Epoch=80.1] | Loss=0.00883 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.003 | L2-Norm(final)=11.444 | 5082.6 samples/s | 79.4 steps/s
[Step=41000 Epoch=80.2] | Loss=0.00855 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.006 | L2-Norm(final)=11.446 | 6147.0 samples/s | 96.0 steps/s
[Step=41050 Epoch=80.3] | Loss=0.00837 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.008 | L2-Norm(final)=11.448 | 1941.6 samples/s | 30.3 steps/s
[Step=41100 Epoch=80.3] | Loss=0.00821 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.011 | L2-Norm(final)=11.450 | 5079.9 samples/s | 79.4 steps/s
[Step=41150 Epoch=80.4] | Loss=0.00796 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.013 | L2-Norm(final)=11.452 | 4967.6 samples/s | 77.6 steps/s
[Step=41200 Epoch=80.5] | Loss=0.00778 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.015 | L2-Norm(final)=11.454 | 5008.9 samples/s | 78.3 steps/s
[Step=41250 Epoch=80.6] | Loss=0.00776 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=11.456 | 5048.1 samples/s | 78.9 steps/s
[Step=41300 Epoch=80.7] | Loss=0.00759 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.019 | L2-Norm(final)=11.458 | 5085.9 samples/s | 79.5 steps/s
[Step=41350 Epoch=80.8] | Loss=0.00738 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.021 | L2-Norm(final)=11.460 | 4990.8 samples/s | 78.0 steps/s
[Step=41400 Epoch=80.9] | Loss=0.00731 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.023 | L2-Norm(final)=11.462 | 5054.7 samples/s | 79.0 steps/s
[Step=41450 Epoch=81.0] | Loss=0.00725 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.025 | L2-Norm(final)=11.464 | 5076.8 samples/s | 79.3 steps/s
[Step=41500 Epoch=81.1] | Loss=0.00713 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.026 | L2-Norm(final)=11.466 | 5496.3 samples/s | 85.9 steps/s
[Step=41550 Epoch=81.2] | Loss=0.00701 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.028 | L2-Norm(final)=11.467 | 2033.7 samples/s | 31.8 steps/s
[Step=41600 Epoch=81.3] | Loss=0.00693 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.030 | L2-Norm(final)=11.469 | 5039.0 samples/s | 78.7 steps/s
[Step=41650 Epoch=81.4] | Loss=0.00686 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.031 | L2-Norm(final)=11.471 | 5017.1 samples/s | 78.4 steps/s
[Step=41700 Epoch=81.5] | Loss=0.00682 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.033 | L2-Norm(final)=11.473 | 5069.8 samples/s | 79.2 steps/s
[Step=41750 Epoch=81.6] | Loss=0.00671 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.035 | L2-Norm(final)=11.475 | 4996.1 samples/s | 78.1 steps/s
[Step=41800 Epoch=81.7] | Loss=0.00666 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.036 | L2-Norm(final)=11.476 | 5037.7 samples/s | 78.7 steps/s
[Step=41850 Epoch=81.8] | Loss=0.00663 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.038 | L2-Norm(final)=11.478 | 5051.6 samples/s | 78.9 steps/s
[Step=41900 Epoch=81.9] | Loss=0.00661 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.039 | L2-Norm(final)=11.480 | 5043.3 samples/s | 78.8 steps/s
[Step=41950 Epoch=82.0] | Loss=0.00655 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.041 | L2-Norm(final)=11.481 | 5031.7 samples/s | 78.6 steps/s
[Step=42000 Epoch=82.1] | Loss=0.00651 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.042 | L2-Norm(final)=11.483 | 5047.4 samples/s | 78.9 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step42000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=34001 Epoch=130.9] | Loss=0.00002 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.971 | L2-Norm(final)=12.077 | 4046.9 samples/s | 63.2 steps/s
[Step=34050 Epoch=131.1] | Loss=0.00002 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.969 | L2-Norm(final)=12.082 | 4595.9 samples/s | 71.8 steps/s
[Step=34100 Epoch=131.3] | Loss=0.00003 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.969 | L2-Norm(final)=12.086 | 5460.9 samples/s | 85.3 steps/s
[Step=34150 Epoch=131.5] | Loss=0.00002 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.969 | L2-Norm(final)=12.090 | 5457.8 samples/s | 85.3 steps/s
[Step=34200 Epoch=131.6] | Loss=0.00003 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.969 | L2-Norm(final)=12.095 | 5505.5 samples/s | 86.0 steps/s
[Step=34250 Epoch=131.8] | Loss=0.00003 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.969 | L2-Norm(final)=12.101 | 7321.1 samples/s | 114.4 steps/s
[Step=34300 Epoch=132.0] | Loss=0.00003 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.969 | L2-Norm(final)=12.108 | 1942.2 samples/s | 30.3 steps/s
[Step=34350 Epoch=132.2] | Loss=0.00003 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.969 | L2-Norm(final)=12.113 | 5491.7 samples/s | 85.8 steps/s
[Step=34400 Epoch=132.4] | Loss=0.00003 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.969 | L2-Norm(final)=12.119 | 5443.8 samples/s | 85.1 steps/s
[Step=34450 Epoch=132.6] | Loss=0.00003 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.969 | L2-Norm(final)=12.124 | 5542.0 samples/s | 86.6 steps/s
[Step=34500 Epoch=132.8] | Loss=0.00003 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.969 | L2-Norm(final)=12.128 | 6319.4 samples/s | 98.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=34501 Epoch=132.8] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.969 | L2-Norm(final)=12.176 | 3795.4 samples/s | 59.3 steps/s
[Step=34550 Epoch=133.0] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.964 | L2-Norm(final)=12.178 | 4570.2 samples/s | 71.4 steps/s
[Step=34600 Epoch=133.2] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.958 | L2-Norm(final)=12.180 | 4769.0 samples/s | 74.5 steps/s
[Step=34650 Epoch=133.4] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.952 | L2-Norm(final)=12.181 | 4798.5 samples/s | 75.0 steps/s
[Step=34700 Epoch=133.6] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=12.182 | 4719.0 samples/s | 73.7 steps/s
[Step=34750 Epoch=133.8] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.938 | L2-Norm(final)=12.184 | 6154.9 samples/s | 96.2 steps/s
[Step=34800 Epoch=134.0] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.930 | L2-Norm(final)=12.185 | 1883.0 samples/s | 29.4 steps/s
[Step=34850 Epoch=134.2] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=12.186 | 4778.3 samples/s | 74.7 steps/s
[Step=34900 Epoch=134.3] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.915 | L2-Norm(final)=12.187 | 4731.6 samples/s | 73.9 steps/s
[Step=34950 Epoch=134.5] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.908 | L2-Norm(final)=12.188 | 4733.1 samples/s | 74.0 steps/s
[Step=35000 Epoch=134.7] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.900 | L2-Norm(final)=12.188 | 5471.4 samples/s | 85.5 steps/s
[Step=35050 Epoch=134.9] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.892 | L2-Norm(final)=12.189 | 1969.3 samples/s | 30.8 steps/s
[Step=35100 Epoch=135.1] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.884 | L2-Norm(final)=12.190 | 4744.7 samples/s | 74.1 steps/s
[Step=35150 Epoch=135.3] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.876 | L2-Norm(final)=12.191 | 4818.9 samples/s | 75.3 steps/s
[Step=35200 Epoch=135.5] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.868 | L2-Norm(final)=12.191 | 4824.4 samples/s | 75.4 steps/s
[Step=35250 Epoch=135.7] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.860 | L2-Norm(final)=12.192 | 4807.9 samples/s | 75.1 steps/s
[Step=35300 Epoch=135.9] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.851 | L2-Norm(final)=12.193 | 2025.0 samples/s | 31.6 steps/s
[Step=35350 Epoch=136.1] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.843 | L2-Norm(final)=12.193 | 4719.9 samples/s | 73.7 steps/s
[Step=35400 Epoch=136.3] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.834 | L2-Norm(final)=12.194 | 4809.6 samples/s | 75.1 steps/s
[Step=35450 Epoch=136.5] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.826 | L2-Norm(final)=12.195 | 4823.4 samples/s | 75.4 steps/s
[Step=35500 Epoch=136.7] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.817 | L2-Norm(final)=12.196 | 4830.0 samples/s | 75.5 steps/s
[Step=35550 Epoch=136.8] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.808 | L2-Norm(final)=12.196 | 2043.2 samples/s | 31.9 steps/s
[Step=35600 Epoch=137.0] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.799 | L2-Norm(final)=12.197 | 4754.4 samples/s | 74.3 steps/s
[Step=35650 Epoch=137.2] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.791 | L2-Norm(final)=12.198 | 4790.7 samples/s | 74.9 steps/s
[Step=35700 Epoch=137.4] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.782 | L2-Norm(final)=12.198 | 4818.6 samples/s | 75.3 steps/s
[Step=35750 Epoch=137.6] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.773 | L2-Norm(final)=12.199 | 4739.6 samples/s | 74.1 steps/s
[Step=35800 Epoch=137.8] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.763 | L2-Norm(final)=12.200 | 7074.1 samples/s | 110.5 steps/s
[Step=35850 Epoch=138.0] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.754 | L2-Norm(final)=12.201 | 1803.4 samples/s | 28.2 steps/s
[Step=35900 Epoch=138.2] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.745 | L2-Norm(final)=12.201 | 4902.4 samples/s | 76.6 steps/s
[Step=35950 Epoch=138.4] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.735 | L2-Norm(final)=12.202 | 4805.1 samples/s | 75.1 steps/s
[Step=36000 Epoch=138.6] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.726 | L2-Norm(final)=12.203 | 4881.7 samples/s | 76.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_1/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07304 | acc=0.9698 | tpr=0.9773 | fpr=0.0466 | 4166.8 samples/s | 16.3 steps/s
Avg test loss: 0.07617, Avg test acc: 0.96871, Avg tpr: 0.97628, Avg fpr: 0.04794, total FA: 374

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07132 | acc=0.9684 | tpr=0.9734 | fpr=0.0426 | 4194.3 samples/s | 16.4 steps/s
Avg test loss: 0.07519, Avg test acc: 0.96779, Avg tpr: 0.97313, Avg fpr: 0.04397, total FA: 343

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.67670 | acc=0.3261 | tpr=0.0284 | fpr=0.0275 | 4238.9 samples/s | 16.6 steps/s
Avg test loss: 5.68399, Avg test acc: 0.32459, Avg tpr: 0.02914, Avg fpr: 0.02564, total FA: 200

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.59530 | acc=0.3362 | tpr=0.0432 | fpr=0.0278 | 4304.5 samples/s | 16.8 steps/s
Avg test loss: 5.59999, Avg test acc: 0.33456, Avg tpr: 0.04377, Avg fpr: 0.02589, total FA: 202

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.58739 | acc=0.0951 | tpr=0.9513 | fpr=0.9203 | 4250.9 samples/s | 16.6 steps/s
[Step= 100] | Loss=6.57010 | acc=0.0970 | tpr=0.9382 | fpr=0.9187 | 8121.5 samples/s | 31.7 steps/s
[Step= 150] | Loss=6.58915 | acc=0.0972 | tpr=0.9337 | fpr=0.9182 | 8372.7 samples/s | 32.7 steps/s
[Step= 200] | Loss=6.58262 | acc=0.0972 | tpr=0.9366 | fpr=0.9180 | 8519.0 samples/s | 33.3 steps/s
[Step= 250] | Loss=6.58151 | acc=0.0976 | tpr=0.9389 | fpr=0.9177 | 8482.3 samples/s | 33.1 steps/s
[Step= 300] | Loss=6.58418 | acc=0.0976 | tpr=0.9375 | fpr=0.9177 | 8084.7 samples/s | 31.6 steps/s
[Step= 350] | Loss=6.58434 | acc=0.0971 | tpr=0.9399 | fpr=0.9182 | 8250.0 samples/s | 32.2 steps/s
[Step= 400] | Loss=6.58442 | acc=0.0970 | tpr=0.9398 | fpr=0.9183 | 8490.1 samples/s | 33.2 steps/s
[Step= 450] | Loss=6.58751 | acc=0.0970 | tpr=0.9391 | fpr=0.9183 | 8241.2 samples/s | 32.2 steps/s
[Step= 500] | Loss=6.58774 | acc=0.0968 | tpr=0.9392 | fpr=0.9184 | 7916.4 samples/s | 30.9 steps/s
[Step= 550] | Loss=6.58595 | acc=0.0970 | tpr=0.9403 | fpr=0.9184 | 15141.1 samples/s | 59.1 steps/s
Avg test loss: 6.58647, Avg test acc: 0.09694, Avg tpr: 0.94057, Avg fpr: 0.91839, total FA: 127517

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.01807 | acc=0.1042 | tpr=0.9425 | fpr=0.9108 | 4188.2 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.00180 | acc=0.1068 | tpr=0.9296 | fpr=0.9085 | 8815.7 samples/s | 34.4 steps/s
[Step= 150] | Loss=6.02274 | acc=0.1067 | tpr=0.9294 | fpr=0.9084 | 7813.2 samples/s | 30.5 steps/s
[Step= 200] | Loss=6.01461 | acc=0.1068 | tpr=0.9290 | fpr=0.9082 | 8307.1 samples/s | 32.4 steps/s
[Step= 250] | Loss=6.01369 | acc=0.1072 | tpr=0.9310 | fpr=0.9078 | 8206.1 samples/s | 32.1 steps/s
[Step= 300] | Loss=6.01685 | acc=0.1067 | tpr=0.9295 | fpr=0.9083 | 8370.7 samples/s | 32.7 steps/s
[Step= 350] | Loss=6.01813 | acc=0.1064 | tpr=0.9311 | fpr=0.9086 | 8299.5 samples/s | 32.4 steps/s
[Step= 400] | Loss=6.01870 | acc=0.1062 | tpr=0.9311 | fpr=0.9087 | 8628.7 samples/s | 33.7 steps/s
[Step= 450] | Loss=6.02242 | acc=0.1063 | tpr=0.9299 | fpr=0.9087 | 8282.0 samples/s | 32.4 steps/s
[Step= 500] | Loss=6.02270 | acc=0.1063 | tpr=0.9313 | fpr=0.9086 | 8178.2 samples/s | 31.9 steps/s
[Step= 550] | Loss=6.02146 | acc=0.1064 | tpr=0.9335 | fpr=0.9086 | 15160.2 samples/s | 59.2 steps/s
Avg test loss: 6.02221, Avg test acc: 0.10637, Avg tpr: 0.93384, Avg fpr: 0.90867, total FA: 126167

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10911 | acc=0.9811 | tpr=0.9558 | fpr=0.0185 | 4259.8 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.11388 | acc=0.9807 | tpr=0.9552 | fpr=0.0188 | 7976.5 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.11902 | acc=0.9796 | tpr=0.9582 | fpr=0.0200 | 8710.2 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.12074 | acc=0.9796 | tpr=0.9607 | fpr=0.0201 | 8041.3 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.11887 | acc=0.9794 | tpr=0.9581 | fpr=0.0203 | 8318.0 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.12201 | acc=0.9789 | tpr=0.9564 | fpr=0.0206 | 8295.9 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.12211 | acc=0.9790 | tpr=0.9568 | fpr=0.0206 | 8276.3 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.12302 | acc=0.9788 | tpr=0.9557 | fpr=0.0208 | 8219.0 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.12549 | acc=0.9785 | tpr=0.9542 | fpr=0.0211 | 8247.7 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.12481 | acc=0.9786 | tpr=0.9546 | fpr=0.0210 | 8254.5 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.12395 | acc=0.9787 | tpr=0.9526 | fpr=0.0208 | 15821.2 samples/s | 61.8 steps/s
Avg test loss: 0.12374, Avg test acc: 0.97872, Avg tpr: 0.95246, Avg fpr: 0.02081, total FA: 2889

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13578 | acc=0.9780 | tpr=0.9602 | fpr=0.0217 | 4227.1 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.14114 | acc=0.9771 | tpr=0.9574 | fpr=0.0226 | 8097.9 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.14664 | acc=0.9764 | tpr=0.9625 | fpr=0.0234 | 8320.9 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.14859 | acc=0.9762 | tpr=0.9661 | fpr=0.0236 | 7990.6 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.14676 | acc=0.9763 | tpr=0.9642 | fpr=0.0235 | 8447.3 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.15064 | acc=0.9759 | tpr=0.9622 | fpr=0.0238 | 8248.0 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.15090 | acc=0.9760 | tpr=0.9631 | fpr=0.0238 | 8387.5 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.15197 | acc=0.9759 | tpr=0.9617 | fpr=0.0239 | 8232.7 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.15489 | acc=0.9756 | tpr=0.9601 | fpr=0.0241 | 8228.0 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.15426 | acc=0.9757 | tpr=0.9595 | fpr=0.0241 | 8228.2 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.15299 | acc=0.9758 | tpr=0.9578 | fpr=0.0239 | 15806.9 samples/s | 61.7 steps/s
Avg test loss: 0.15275, Avg test acc: 0.97578, Avg tpr: 0.95761, Avg fpr: 0.02389, total FA: 3317

server round 45/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=42001 Epoch=82.1] | Loss=0.00341 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.715 | L2-Norm(final)=11.533 | 3975.2 samples/s | 62.1 steps/s
[Step=42050 Epoch=82.2] | Loss=0.00882 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.715 | L2-Norm(final)=11.537 | 5091.0 samples/s | 79.5 steps/s
[Step=42100 Epoch=82.3] | Loss=0.00982 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.715 | L2-Norm(final)=11.540 | 5734.1 samples/s | 89.6 steps/s
[Step=42150 Epoch=82.4] | Loss=0.00974 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.715 | L2-Norm(final)=11.544 | 5632.4 samples/s | 88.0 steps/s
[Step=42200 Epoch=82.5] | Loss=0.00973 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.715 | L2-Norm(final)=11.549 | 5599.8 samples/s | 87.5 steps/s
[Step=42250 Epoch=82.6] | Loss=0.00969 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.715 | L2-Norm(final)=11.553 | 5712.7 samples/s | 89.3 steps/s
[Step=42300 Epoch=82.7] | Loss=0.00931 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.715 | L2-Norm(final)=11.557 | 5950.5 samples/s | 93.0 steps/s
[Step=42350 Epoch=82.8] | Loss=0.00920 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.715 | L2-Norm(final)=11.561 | 5810.4 samples/s | 90.8 steps/s
[Step=42400 Epoch=82.9] | Loss=0.00921 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.715 | L2-Norm(final)=11.566 | 5709.1 samples/s | 89.2 steps/s
[Step=42450 Epoch=83.0] | Loss=0.00926 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.715 | L2-Norm(final)=11.570 | 5741.2 samples/s | 89.7 steps/s
[Step=42500 Epoch=83.1] | Loss=0.00928 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.715 | L2-Norm(final)=11.574 | 7572.9 samples/s | 118.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=83.1] | Loss=0.00128 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.715 | L2-Norm(final)=11.615 | 4042.6 samples/s | 63.2 steps/s
[Step=42550 Epoch=83.2] | Loss=0.00947 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.719 | L2-Norm(final)=11.618 | 4885.1 samples/s | 76.3 steps/s
[Step=42600 Epoch=83.3] | Loss=0.00949 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.724 | L2-Norm(final)=11.620 | 5010.8 samples/s | 78.3 steps/s
[Step=42650 Epoch=83.4] | Loss=0.01023 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.728 | L2-Norm(final)=11.623 | 4995.0 samples/s | 78.0 steps/s
[Step=42700 Epoch=83.5] | Loss=0.01004 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.732 | L2-Norm(final)=11.625 | 5177.2 samples/s | 80.9 steps/s
[Step=42750 Epoch=83.6] | Loss=0.00973 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.736 | L2-Norm(final)=11.627 | 5125.4 samples/s | 80.1 steps/s
[Step=42800 Epoch=83.7] | Loss=0.00935 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.740 | L2-Norm(final)=11.629 | 5046.6 samples/s | 78.9 steps/s
[Step=42850 Epoch=83.8] | Loss=0.00928 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.743 | L2-Norm(final)=11.631 | 5020.2 samples/s | 78.4 steps/s
[Step=42900 Epoch=83.9] | Loss=0.00917 | Reg=0.00115 | acc=0.9375 | L2-Norm=10.746 | L2-Norm(final)=11.634 | 5078.1 samples/s | 79.3 steps/s
[Step=42950 Epoch=84.0] | Loss=0.00903 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.750 | L2-Norm(final)=11.636 | 4983.3 samples/s | 77.9 steps/s
[Step=43000 Epoch=84.1] | Loss=0.00882 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.753 | L2-Norm(final)=11.638 | 6244.2 samples/s | 97.6 steps/s
[Step=43050 Epoch=84.2] | Loss=0.00860 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.755 | L2-Norm(final)=11.641 | 1947.9 samples/s | 30.4 steps/s
[Step=43100 Epoch=84.3] | Loss=0.00844 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.758 | L2-Norm(final)=11.643 | 5021.7 samples/s | 78.5 steps/s
[Step=43150 Epoch=84.4] | Loss=0.00818 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.760 | L2-Norm(final)=11.645 | 5042.3 samples/s | 78.8 steps/s
[Step=43200 Epoch=84.5] | Loss=0.00808 | Reg=0.00116 | acc=0.9688 | L2-Norm=10.763 | L2-Norm(final)=11.647 | 4951.0 samples/s | 77.4 steps/s
[Step=43250 Epoch=84.6] | Loss=0.00801 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.765 | L2-Norm(final)=11.649 | 5036.2 samples/s | 78.7 steps/s
[Step=43300 Epoch=84.7] | Loss=0.00799 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.767 | L2-Norm(final)=11.651 | 5093.9 samples/s | 79.6 steps/s
[Step=43350 Epoch=84.7] | Loss=0.00779 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.769 | L2-Norm(final)=11.653 | 5004.2 samples/s | 78.2 steps/s
[Step=43400 Epoch=84.8] | Loss=0.00776 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.771 | L2-Norm(final)=11.655 | 4997.8 samples/s | 78.1 steps/s
[Step=43450 Epoch=84.9] | Loss=0.00771 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.773 | L2-Norm(final)=11.658 | 5056.2 samples/s | 79.0 steps/s
[Step=43500 Epoch=85.0] | Loss=0.00755 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.776 | L2-Norm(final)=11.660 | 5428.2 samples/s | 84.8 steps/s
[Step=43550 Epoch=85.1] | Loss=0.00746 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.777 | L2-Norm(final)=11.662 | 2030.0 samples/s | 31.7 steps/s
[Step=43600 Epoch=85.2] | Loss=0.00731 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.779 | L2-Norm(final)=11.664 | 5072.1 samples/s | 79.3 steps/s
[Step=43650 Epoch=85.3] | Loss=0.00716 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.781 | L2-Norm(final)=11.666 | 4971.7 samples/s | 77.7 steps/s
[Step=43700 Epoch=85.4] | Loss=0.00706 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.783 | L2-Norm(final)=11.668 | 5005.1 samples/s | 78.2 steps/s
[Step=43750 Epoch=85.5] | Loss=0.00702 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.785 | L2-Norm(final)=11.670 | 5003.1 samples/s | 78.2 steps/s
[Step=43800 Epoch=85.6] | Loss=0.00697 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.787 | L2-Norm(final)=11.672 | 5033.1 samples/s | 78.6 steps/s
[Step=43850 Epoch=85.7] | Loss=0.00692 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.788 | L2-Norm(final)=11.674 | 5066.5 samples/s | 79.2 steps/s
[Step=43900 Epoch=85.8] | Loss=0.00684 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.790 | L2-Norm(final)=11.676 | 4989.8 samples/s | 78.0 steps/s
[Step=43950 Epoch=85.9] | Loss=0.00676 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.792 | L2-Norm(final)=11.678 | 5035.5 samples/s | 78.7 steps/s
[Step=44000 Epoch=86.0] | Loss=0.00679 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.794 | L2-Norm(final)=11.679 | 4979.6 samples/s | 77.8 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step44000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=48001 Epoch=183.9] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.715 | L2-Norm(final)=11.878 | 4026.6 samples/s | 62.9 steps/s
[Step=48050 Epoch=184.1] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.708 | L2-Norm(final)=11.884 | 4571.2 samples/s | 71.4 steps/s
[Step=48100 Epoch=184.3] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.707 | L2-Norm(final)=11.892 | 5745.7 samples/s | 89.8 steps/s
[Step=48150 Epoch=184.5] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.706 | L2-Norm(final)=11.900 | 5203.4 samples/s | 81.3 steps/s
[Step=48200 Epoch=184.7] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.706 | L2-Norm(final)=11.907 | 5506.3 samples/s | 86.0 steps/s
[Step=48250 Epoch=184.9] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.706 | L2-Norm(final)=11.915 | 7182.2 samples/s | 112.2 steps/s
[Step=48300 Epoch=185.1] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.706 | L2-Norm(final)=11.922 | 1939.8 samples/s | 30.3 steps/s
[Step=48350 Epoch=185.3] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.706 | L2-Norm(final)=11.930 | 5426.2 samples/s | 84.8 steps/s
[Step=48400 Epoch=185.5] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.706 | L2-Norm(final)=11.937 | 5538.4 samples/s | 86.5 steps/s
[Step=48450 Epoch=185.6] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.706 | L2-Norm(final)=11.943 | 5523.8 samples/s | 86.3 steps/s
[Step=48500 Epoch=185.8] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.706 | L2-Norm(final)=11.950 | 6318.5 samples/s | 98.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=48501 Epoch=185.8] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.706 | L2-Norm(final)=12.017 | 3919.5 samples/s | 61.2 steps/s
[Step=48550 Epoch=186.0] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.680 | L2-Norm(final)=12.020 | 4387.6 samples/s | 68.6 steps/s
[Step=48600 Epoch=186.2] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.649 | L2-Norm(final)=12.022 | 4863.0 samples/s | 76.0 steps/s
[Step=48650 Epoch=186.4] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.621 | L2-Norm(final)=12.024 | 4681.8 samples/s | 73.2 steps/s
[Step=48700 Epoch=186.6] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.593 | L2-Norm(final)=12.025 | 4774.2 samples/s | 74.6 steps/s
[Step=48750 Epoch=186.8] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.566 | L2-Norm(final)=12.027 | 6029.5 samples/s | 94.2 steps/s
[Step=48800 Epoch=187.0] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.538 | L2-Norm(final)=12.028 | 1891.5 samples/s | 29.6 steps/s
[Step=48850 Epoch=187.2] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.510 | L2-Norm(final)=12.029 | 4706.0 samples/s | 73.5 steps/s
[Step=48900 Epoch=187.4] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.483 | L2-Norm(final)=12.030 | 4756.5 samples/s | 74.3 steps/s
[Step=48950 Epoch=187.6] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.455 | L2-Norm(final)=12.031 | 4805.1 samples/s | 75.1 steps/s
[Step=49000 Epoch=187.8] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.427 | L2-Norm(final)=12.032 | 5277.9 samples/s | 82.5 steps/s
[Step=49050 Epoch=187.9] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=12.033 | 1964.7 samples/s | 30.7 steps/s
[Step=49100 Epoch=188.1] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.370 | L2-Norm(final)=12.034 | 4739.2 samples/s | 74.0 steps/s
[Step=49150 Epoch=188.3] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.342 | L2-Norm(final)=12.034 | 4762.5 samples/s | 74.4 steps/s
[Step=49200 Epoch=188.5] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.314 | L2-Norm(final)=12.035 | 4829.5 samples/s | 75.5 steps/s
[Step=49250 Epoch=188.7] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.286 | L2-Norm(final)=12.036 | 4842.2 samples/s | 75.7 steps/s
[Step=49300 Epoch=188.9] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.257 | L2-Norm(final)=12.037 | 2025.9 samples/s | 31.7 steps/s
[Step=49350 Epoch=189.1] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.229 | L2-Norm(final)=12.038 | 4838.0 samples/s | 75.6 steps/s
[Step=49400 Epoch=189.3] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.200 | L2-Norm(final)=12.039 | 4821.3 samples/s | 75.3 steps/s
[Step=49450 Epoch=189.5] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.171 | L2-Norm(final)=12.040 | 4701.2 samples/s | 73.5 steps/s
[Step=49500 Epoch=189.7] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.142 | L2-Norm(final)=12.041 | 4754.6 samples/s | 74.3 steps/s
[Step=49550 Epoch=189.9] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.114 | L2-Norm(final)=12.042 | 2067.4 samples/s | 32.3 steps/s
[Step=49600 Epoch=190.0] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.085 | L2-Norm(final)=12.044 | 4781.2 samples/s | 74.7 steps/s
[Step=49650 Epoch=190.2] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.056 | L2-Norm(final)=12.045 | 4825.3 samples/s | 75.4 steps/s
[Step=49700 Epoch=190.4] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.027 | L2-Norm(final)=12.046 | 4774.5 samples/s | 74.6 steps/s
[Step=49750 Epoch=190.6] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.998 | L2-Norm(final)=12.047 | 4764.6 samples/s | 74.4 steps/s
[Step=49800 Epoch=190.8] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.969 | L2-Norm(final)=12.049 | 6500.2 samples/s | 101.6 steps/s
[Step=49850 Epoch=191.0] | Loss=0.00000 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.940 | L2-Norm(final)=12.050 | 1852.7 samples/s | 28.9 steps/s
[Step=49900 Epoch=191.2] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.911 | L2-Norm(final)=12.052 | 4748.2 samples/s | 74.2 steps/s
[Step=49950 Epoch=191.4] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=12.053 | 4741.3 samples/s | 74.1 steps/s
[Step=50000 Epoch=191.6] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.852 | L2-Norm(final)=12.055 | 4759.6 samples/s | 74.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step50000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07304 | acc=0.9698 | tpr=0.9773 | fpr=0.0466 | 4153.0 samples/s | 16.2 steps/s
Avg test loss: 0.07617, Avg test acc: 0.96871, Avg tpr: 0.97628, Avg fpr: 0.04794, total FA: 374

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07058 | acc=0.9675 | tpr=0.9740 | fpr=0.0466 | 4173.6 samples/s | 16.3 steps/s
Avg test loss: 0.07419, Avg test acc: 0.96722, Avg tpr: 0.97435, Avg fpr: 0.04846, total FA: 378

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.23768 | acc=0.3251 | tpr=0.0294 | fpr=0.0330 | 4260.1 samples/s | 16.6 steps/s
Avg test loss: 5.24036, Avg test acc: 0.32382, Avg tpr: 0.03107, Avg fpr: 0.03230, total FA: 252

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.59530 | acc=0.3362 | tpr=0.0432 | fpr=0.0278 | 4177.7 samples/s | 16.3 steps/s
Avg test loss: 5.59999, Avg test acc: 0.33456, Avg tpr: 0.04377, Avg fpr: 0.02589, total FA: 202

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.58739 | acc=0.0951 | tpr=0.9513 | fpr=0.9203 | 4186.4 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.57010 | acc=0.0970 | tpr=0.9382 | fpr=0.9187 | 8246.7 samples/s | 32.2 steps/s
[Step= 150] | Loss=6.58915 | acc=0.0972 | tpr=0.9337 | fpr=0.9182 | 8375.0 samples/s | 32.7 steps/s
[Step= 200] | Loss=6.58262 | acc=0.0972 | tpr=0.9366 | fpr=0.9180 | 8488.8 samples/s | 33.2 steps/s
[Step= 250] | Loss=6.58151 | acc=0.0976 | tpr=0.9389 | fpr=0.9177 | 8131.3 samples/s | 31.8 steps/s
[Step= 300] | Loss=6.58418 | acc=0.0976 | tpr=0.9375 | fpr=0.9177 | 8204.1 samples/s | 32.0 steps/s
[Step= 350] | Loss=6.58434 | acc=0.0971 | tpr=0.9399 | fpr=0.9182 | 8519.2 samples/s | 33.3 steps/s
[Step= 400] | Loss=6.58442 | acc=0.0970 | tpr=0.9398 | fpr=0.9183 | 8204.6 samples/s | 32.0 steps/s
[Step= 450] | Loss=6.58751 | acc=0.0970 | tpr=0.9391 | fpr=0.9183 | 8195.9 samples/s | 32.0 steps/s
[Step= 500] | Loss=6.58774 | acc=0.0968 | tpr=0.9392 | fpr=0.9184 | 8096.6 samples/s | 31.6 steps/s
[Step= 550] | Loss=6.58595 | acc=0.0970 | tpr=0.9403 | fpr=0.9184 | 16024.0 samples/s | 62.6 steps/s
Avg test loss: 6.58647, Avg test acc: 0.09694, Avg tpr: 0.94057, Avg fpr: 0.91839, total FA: 127517

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.09743 | acc=0.1020 | tpr=0.9469 | fpr=0.9132 | 4202.5 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.08047 | acc=0.1036 | tpr=0.9339 | fpr=0.9119 | 8319.7 samples/s | 32.5 steps/s
[Step= 150] | Loss=6.10191 | acc=0.1030 | tpr=0.9352 | fpr=0.9123 | 8211.6 samples/s | 32.1 steps/s
[Step= 200] | Loss=6.09290 | acc=0.1034 | tpr=0.9366 | fpr=0.9118 | 8340.0 samples/s | 32.6 steps/s
[Step= 250] | Loss=6.09235 | acc=0.1036 | tpr=0.9380 | fpr=0.9116 | 8334.8 samples/s | 32.6 steps/s
[Step= 300] | Loss=6.09537 | acc=0.1035 | tpr=0.9367 | fpr=0.9117 | 8213.2 samples/s | 32.1 steps/s
[Step= 350] | Loss=6.09639 | acc=0.1031 | tpr=0.9374 | fpr=0.9120 | 8391.8 samples/s | 32.8 steps/s
[Step= 400] | Loss=6.09725 | acc=0.1029 | tpr=0.9371 | fpr=0.9122 | 9121.3 samples/s | 35.6 steps/s
[Step= 450] | Loss=6.10071 | acc=0.1029 | tpr=0.9357 | fpr=0.9122 | 7072.9 samples/s | 27.6 steps/s
[Step= 500] | Loss=6.10079 | acc=0.1029 | tpr=0.9366 | fpr=0.9122 | 8013.1 samples/s | 31.3 steps/s
[Step= 550] | Loss=6.09938 | acc=0.1030 | tpr=0.9379 | fpr=0.9122 | 15922.7 samples/s | 62.2 steps/s
Avg test loss: 6.10011, Avg test acc: 0.10298, Avg tpr: 0.93819, Avg fpr: 0.91221, total FA: 126658

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11149 | acc=0.9791 | tpr=0.9646 | fpr=0.0207 | 4184.4 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.11578 | acc=0.9784 | tpr=0.9659 | fpr=0.0214 | 8214.9 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.12167 | acc=0.9772 | tpr=0.9654 | fpr=0.0225 | 8139.1 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.12353 | acc=0.9771 | tpr=0.9661 | fpr=0.0227 | 8734.8 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.12199 | acc=0.9769 | tpr=0.9642 | fpr=0.0228 | 8098.6 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.12506 | acc=0.9765 | tpr=0.9622 | fpr=0.0233 | 8296.6 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.12501 | acc=0.9766 | tpr=0.9624 | fpr=0.0232 | 8290.2 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.12584 | acc=0.9764 | tpr=0.9617 | fpr=0.0233 | 8387.7 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.12820 | acc=0.9762 | tpr=0.9606 | fpr=0.0235 | 8231.7 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.12746 | acc=0.9764 | tpr=0.9604 | fpr=0.0233 | 8265.7 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.12661 | acc=0.9765 | tpr=0.9590 | fpr=0.0232 | 14739.4 samples/s | 57.6 steps/s
Avg test loss: 0.12638, Avg test acc: 0.97654, Avg tpr: 0.95880, Avg fpr: 0.02313, total FA: 3212

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13578 | acc=0.9780 | tpr=0.9602 | fpr=0.0217 | 4155.2 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.14114 | acc=0.9771 | tpr=0.9574 | fpr=0.0226 | 8450.3 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.14664 | acc=0.9764 | tpr=0.9625 | fpr=0.0234 | 8728.1 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.14859 | acc=0.9762 | tpr=0.9661 | fpr=0.0236 | 7810.8 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.14676 | acc=0.9763 | tpr=0.9642 | fpr=0.0235 | 8207.8 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.15064 | acc=0.9759 | tpr=0.9622 | fpr=0.0238 | 8417.1 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.15090 | acc=0.9760 | tpr=0.9631 | fpr=0.0238 | 8253.1 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.15197 | acc=0.9759 | tpr=0.9617 | fpr=0.0239 | 8287.0 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.15489 | acc=0.9756 | tpr=0.9601 | fpr=0.0241 | 8408.3 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.15426 | acc=0.9757 | tpr=0.9595 | fpr=0.0241 | 8173.7 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.15299 | acc=0.9758 | tpr=0.9578 | fpr=0.0239 | 15684.2 samples/s | 61.3 steps/s
Avg test loss: 0.15275, Avg test acc: 0.97578, Avg tpr: 0.95761, Avg fpr: 0.02389, total FA: 3317

server round 46/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=44001 Epoch=86.0] | Loss=0.01463 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.375 | L2-Norm(final)=11.734 | 3756.6 samples/s | 58.7 steps/s
[Step=44050 Epoch=86.1] | Loss=0.00989 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.375 | L2-Norm(final)=11.738 | 5753.4 samples/s | 89.9 steps/s
[Step=44100 Epoch=86.2] | Loss=0.01092 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.375 | L2-Norm(final)=11.743 | 5758.3 samples/s | 90.0 steps/s
[Step=44150 Epoch=86.3] | Loss=0.01095 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.375 | L2-Norm(final)=11.747 | 5826.9 samples/s | 91.0 steps/s
[Step=44200 Epoch=86.4] | Loss=0.01105 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.375 | L2-Norm(final)=11.752 | 5790.2 samples/s | 90.5 steps/s
[Step=44250 Epoch=86.5] | Loss=0.01133 | Reg=0.00108 | acc=0.9688 | L2-Norm=10.375 | L2-Norm(final)=11.757 | 5748.7 samples/s | 89.8 steps/s
[Step=44300 Epoch=86.6] | Loss=0.01118 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.375 | L2-Norm(final)=11.761 | 5707.4 samples/s | 89.2 steps/s
[Step=44350 Epoch=86.7] | Loss=0.01124 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.375 | L2-Norm(final)=11.765 | 5831.7 samples/s | 91.1 steps/s
[Step=44400 Epoch=86.8] | Loss=0.01126 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.375 | L2-Norm(final)=11.770 | 5779.1 samples/s | 90.3 steps/s
[Step=44450 Epoch=86.9] | Loss=0.01128 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.375 | L2-Norm(final)=11.774 | 5797.0 samples/s | 90.6 steps/s
[Step=44500 Epoch=87.0] | Loss=0.01126 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.375 | L2-Norm(final)=11.778 | 7503.8 samples/s | 117.2 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=87.0] | Loss=0.00187 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.375 | L2-Norm(final)=11.821 | 4240.9 samples/s | 66.3 steps/s
[Step=44550 Epoch=87.1] | Loss=0.01167 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.380 | L2-Norm(final)=11.824 | 4400.5 samples/s | 68.8 steps/s
[Step=44600 Epoch=87.2] | Loss=0.01122 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.385 | L2-Norm(final)=11.827 | 5048.6 samples/s | 78.9 steps/s
[Step=44650 Epoch=87.3] | Loss=0.01068 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.390 | L2-Norm(final)=11.830 | 5055.2 samples/s | 79.0 steps/s
[Step=44700 Epoch=87.4] | Loss=0.01050 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.394 | L2-Norm(final)=11.833 | 5006.3 samples/s | 78.2 steps/s
[Step=44750 Epoch=87.5] | Loss=0.01070 | Reg=0.00108 | acc=0.9688 | L2-Norm=10.398 | L2-Norm(final)=11.836 | 5031.8 samples/s | 78.6 steps/s
[Step=44800 Epoch=87.6] | Loss=0.01055 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.402 | L2-Norm(final)=11.838 | 5067.0 samples/s | 79.2 steps/s
[Step=44850 Epoch=87.7] | Loss=0.01043 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.406 | L2-Norm(final)=11.841 | 5022.4 samples/s | 78.5 steps/s
[Step=44900 Epoch=87.8] | Loss=0.01039 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.409 | L2-Norm(final)=11.844 | 4994.8 samples/s | 78.0 steps/s
[Step=44950 Epoch=87.9] | Loss=0.01021 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.413 | L2-Norm(final)=11.846 | 5078.2 samples/s | 79.3 steps/s
[Step=45000 Epoch=88.0] | Loss=0.00999 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.416 | L2-Norm(final)=11.849 | 6235.4 samples/s | 97.4 steps/s
[Step=45050 Epoch=88.1] | Loss=0.00971 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.419 | L2-Norm(final)=11.851 | 1947.1 samples/s | 30.4 steps/s
[Step=45100 Epoch=88.2] | Loss=0.00933 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.422 | L2-Norm(final)=11.854 | 5055.4 samples/s | 79.0 steps/s
[Step=45150 Epoch=88.3] | Loss=0.00908 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.425 | L2-Norm(final)=11.856 | 4955.2 samples/s | 77.4 steps/s
[Step=45200 Epoch=88.4] | Loss=0.00880 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.428 | L2-Norm(final)=11.859 | 5067.7 samples/s | 79.2 steps/s
[Step=45250 Epoch=88.5] | Loss=0.00875 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.430 | L2-Norm(final)=11.861 | 5123.5 samples/s | 80.1 steps/s
[Step=45300 Epoch=88.6] | Loss=0.00863 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.433 | L2-Norm(final)=11.864 | 5068.8 samples/s | 79.2 steps/s
[Step=45350 Epoch=88.7] | Loss=0.00852 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.435 | L2-Norm(final)=11.866 | 5112.2 samples/s | 79.9 steps/s
[Step=45400 Epoch=88.8] | Loss=0.00846 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.438 | L2-Norm(final)=11.868 | 5104.1 samples/s | 79.8 steps/s
[Step=45450 Epoch=88.9] | Loss=0.00842 | Reg=0.00109 | acc=0.9688 | L2-Norm=10.440 | L2-Norm(final)=11.870 | 5022.0 samples/s | 78.5 steps/s
[Step=45500 Epoch=89.0] | Loss=0.00826 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.442 | L2-Norm(final)=11.873 | 5473.9 samples/s | 85.5 steps/s
[Step=45550 Epoch=89.0] | Loss=0.00822 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.444 | L2-Norm(final)=11.875 | 2027.2 samples/s | 31.7 steps/s
[Step=45600 Epoch=89.1] | Loss=0.00807 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.447 | L2-Norm(final)=11.877 | 5087.4 samples/s | 79.5 steps/s
[Step=45650 Epoch=89.2] | Loss=0.00796 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.449 | L2-Norm(final)=11.879 | 5033.4 samples/s | 78.6 steps/s
[Step=45700 Epoch=89.3] | Loss=0.00781 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.451 | L2-Norm(final)=11.881 | 4999.4 samples/s | 78.1 steps/s
[Step=45750 Epoch=89.4] | Loss=0.00767 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.453 | L2-Norm(final)=11.884 | 5033.3 samples/s | 78.6 steps/s
[Step=45800 Epoch=89.5] | Loss=0.00762 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.455 | L2-Norm(final)=11.886 | 5014.0 samples/s | 78.3 steps/s
[Step=45850 Epoch=89.6] | Loss=0.00758 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.457 | L2-Norm(final)=11.888 | 4997.6 samples/s | 78.1 steps/s
[Step=45900 Epoch=89.7] | Loss=0.00758 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.459 | L2-Norm(final)=11.890 | 5028.7 samples/s | 78.6 steps/s
[Step=45950 Epoch=89.8] | Loss=0.00750 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.461 | L2-Norm(final)=11.892 | 5052.2 samples/s | 78.9 steps/s
[Step=46000 Epoch=89.9] | Loss=0.00739 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.463 | L2-Norm(final)=11.894 | 5055.2 samples/s | 79.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step46000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=50001 Epoch=191.6] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.375 | L2-Norm(final)=12.101 | 4105.2 samples/s | 64.1 steps/s
[Step=50050 Epoch=191.8] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.365 | L2-Norm(final)=12.107 | 4798.5 samples/s | 75.0 steps/s
[Step=50100 Epoch=192.0] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.364 | L2-Norm(final)=12.117 | 5550.3 samples/s | 86.7 steps/s
[Step=50150 Epoch=192.2] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.364 | L2-Norm(final)=12.127 | 5496.3 samples/s | 85.9 steps/s
[Step=50200 Epoch=192.3] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.363 | L2-Norm(final)=12.134 | 5460.3 samples/s | 85.3 steps/s
[Step=50250 Epoch=192.5] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.363 | L2-Norm(final)=12.141 | 7023.5 samples/s | 109.7 steps/s
[Step=50300 Epoch=192.7] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.363 | L2-Norm(final)=12.147 | 1961.6 samples/s | 30.6 steps/s
[Step=50350 Epoch=192.9] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.363 | L2-Norm(final)=12.153 | 5455.9 samples/s | 85.2 steps/s
[Step=50400 Epoch=193.1] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.363 | L2-Norm(final)=12.159 | 5486.2 samples/s | 85.7 steps/s
[Step=50450 Epoch=193.3] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.363 | L2-Norm(final)=12.164 | 5583.3 samples/s | 87.2 steps/s
[Step=50500 Epoch=193.5] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.363 | L2-Norm(final)=12.171 | 5955.2 samples/s | 93.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=50501 Epoch=193.5] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.363 | L2-Norm(final)=12.231 | 3697.5 samples/s | 57.8 steps/s
[Step=50550 Epoch=193.7] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.329 | L2-Norm(final)=12.236 | 4862.0 samples/s | 76.0 steps/s
[Step=50600 Epoch=193.9] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.289 | L2-Norm(final)=12.239 | 4771.9 samples/s | 74.6 steps/s
[Step=50650 Epoch=194.1] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=12.241 | 4796.5 samples/s | 74.9 steps/s
[Step=50700 Epoch=194.3] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.205 | L2-Norm(final)=12.243 | 4700.1 samples/s | 73.4 steps/s
[Step=50750 Epoch=194.5] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.163 | L2-Norm(final)=12.245 | 6021.0 samples/s | 94.1 steps/s
[Step=50800 Epoch=194.6] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.122 | L2-Norm(final)=12.246 | 1904.2 samples/s | 29.8 steps/s
[Step=50850 Epoch=194.8] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.080 | L2-Norm(final)=12.248 | 4720.2 samples/s | 73.8 steps/s
[Step=50900 Epoch=195.0] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.039 | L2-Norm(final)=12.249 | 4825.6 samples/s | 75.4 steps/s
[Step=50950 Epoch=195.2] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.998 | L2-Norm(final)=12.250 | 4759.6 samples/s | 74.4 steps/s
[Step=51000 Epoch=195.4] | Loss=0.00000 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.957 | L2-Norm(final)=12.252 | 5324.4 samples/s | 83.2 steps/s
[Step=51050 Epoch=195.6] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.916 | L2-Norm(final)=12.253 | 1944.6 samples/s | 30.4 steps/s
[Step=51100 Epoch=195.8] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.876 | L2-Norm(final)=12.254 | 4795.2 samples/s | 74.9 steps/s
[Step=51150 Epoch=196.0] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.835 | L2-Norm(final)=12.256 | 4760.1 samples/s | 74.4 steps/s
[Step=51200 Epoch=196.2] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.795 | L2-Norm(final)=12.257 | 4701.9 samples/s | 73.5 steps/s
[Step=51250 Epoch=196.4] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.755 | L2-Norm(final)=12.259 | 4753.9 samples/s | 74.3 steps/s
[Step=51300 Epoch=196.6] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.715 | L2-Norm(final)=12.260 | 2004.6 samples/s | 31.3 steps/s
[Step=51350 Epoch=196.8] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.676 | L2-Norm(final)=12.262 | 4952.9 samples/s | 77.4 steps/s
[Step=51400 Epoch=196.9] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.637 | L2-Norm(final)=12.264 | 4848.2 samples/s | 75.8 steps/s
[Step=51450 Epoch=197.1] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.599 | L2-Norm(final)=12.266 | 4851.6 samples/s | 75.8 steps/s
[Step=51500 Epoch=197.3] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.562 | L2-Norm(final)=12.268 | 4884.3 samples/s | 76.3 steps/s
[Step=51550 Epoch=197.5] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.525 | L2-Norm(final)=12.270 | 2058.3 samples/s | 32.2 steps/s
[Step=51600 Epoch=197.7] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.489 | L2-Norm(final)=12.272 | 4786.6 samples/s | 74.8 steps/s
[Step=51650 Epoch=197.9] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.453 | L2-Norm(final)=12.274 | 4810.7 samples/s | 75.2 steps/s
[Step=51700 Epoch=198.1] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.418 | L2-Norm(final)=12.276 | 4757.8 samples/s | 74.3 steps/s
[Step=51750 Epoch=198.3] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.383 | L2-Norm(final)=12.278 | 4811.0 samples/s | 75.2 steps/s
[Step=51800 Epoch=198.5] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.348 | L2-Norm(final)=12.280 | 6489.7 samples/s | 101.4 steps/s
[Step=51850 Epoch=198.7] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.313 | L2-Norm(final)=12.282 | 1855.1 samples/s | 29.0 steps/s
[Step=51900 Epoch=198.9] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.279 | L2-Norm(final)=12.284 | 4730.3 samples/s | 73.9 steps/s
[Step=51950 Epoch=199.1] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.244 | L2-Norm(final)=12.286 | 4849.5 samples/s | 75.8 steps/s
[Step=52000 Epoch=199.2] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.210 | L2-Norm(final)=12.288 | 4699.1 samples/s | 73.4 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step52000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07304 | acc=0.9698 | tpr=0.9773 | fpr=0.0466 | 4087.0 samples/s | 16.0 steps/s
Avg test loss: 0.07617, Avg test acc: 0.96871, Avg tpr: 0.97628, Avg fpr: 0.04794, total FA: 374

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07039 | acc=0.9673 | tpr=0.9716 | fpr=0.0419 | 4198.2 samples/s | 16.4 steps/s
Avg test loss: 0.07419, Avg test acc: 0.96634, Avg tpr: 0.97086, Avg fpr: 0.04358, total FA: 340

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.27613 | acc=0.3234 | tpr=0.0217 | fpr=0.0216 | 4167.4 samples/s | 16.3 steps/s
Avg test loss: 5.27951, Avg test acc: 0.32022, Avg tpr: 0.02116, Avg fpr: 0.02205, total FA: 172

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.59530 | acc=0.3362 | tpr=0.0432 | fpr=0.0278 | 4309.8 samples/s | 16.8 steps/s
Avg test loss: 5.59999, Avg test acc: 0.33456, Avg tpr: 0.04377, Avg fpr: 0.02589, total FA: 202

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.58739 | acc=0.0951 | tpr=0.9513 | fpr=0.9203 | 4234.7 samples/s | 16.5 steps/s
[Step= 100] | Loss=6.57010 | acc=0.0970 | tpr=0.9382 | fpr=0.9187 | 8201.8 samples/s | 32.0 steps/s
[Step= 150] | Loss=6.58915 | acc=0.0972 | tpr=0.9337 | fpr=0.9182 | 6327.1 samples/s | 24.7 steps/s
[Step= 200] | Loss=6.58262 | acc=0.0972 | tpr=0.9366 | fpr=0.9180 | 8704.0 samples/s | 34.0 steps/s
[Step= 250] | Loss=6.58151 | acc=0.0976 | tpr=0.9389 | fpr=0.9177 | 7975.6 samples/s | 31.2 steps/s
[Step= 300] | Loss=6.58418 | acc=0.0976 | tpr=0.9375 | fpr=0.9177 | 7540.8 samples/s | 29.5 steps/s
[Step= 350] | Loss=6.58434 | acc=0.0971 | tpr=0.9399 | fpr=0.9182 | 6594.9 samples/s | 25.8 steps/s
[Step= 400] | Loss=6.58442 | acc=0.0970 | tpr=0.9398 | fpr=0.9183 | 8434.8 samples/s | 32.9 steps/s
[Step= 450] | Loss=6.58751 | acc=0.0970 | tpr=0.9391 | fpr=0.9183 | 8062.7 samples/s | 31.5 steps/s
[Step= 500] | Loss=6.58774 | acc=0.0968 | tpr=0.9392 | fpr=0.9184 | 8263.6 samples/s | 32.3 steps/s
[Step= 550] | Loss=6.58595 | acc=0.0970 | tpr=0.9403 | fpr=0.9184 | 15296.4 samples/s | 59.8 steps/s
Avg test loss: 6.58647, Avg test acc: 0.09694, Avg tpr: 0.94057, Avg fpr: 0.91839, total FA: 127517

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.59001 | acc=0.1084 | tpr=0.9469 | fpr=0.9067 | 4263.5 samples/s | 16.7 steps/s
[Step= 100] | Loss=5.57330 | acc=0.1106 | tpr=0.9275 | fpr=0.9046 | 7098.8 samples/s | 27.7 steps/s
[Step= 150] | Loss=5.59514 | acc=0.1101 | tpr=0.9280 | fpr=0.9050 | 6164.9 samples/s | 24.1 steps/s
[Step= 200] | Loss=5.58707 | acc=0.1103 | tpr=0.9268 | fpr=0.9046 | 8312.3 samples/s | 32.5 steps/s
[Step= 250] | Loss=5.58648 | acc=0.1109 | tpr=0.9284 | fpr=0.9040 | 8477.5 samples/s | 33.1 steps/s
[Step= 300] | Loss=5.58960 | acc=0.1107 | tpr=0.9265 | fpr=0.9042 | 7158.6 samples/s | 28.0 steps/s
[Step= 350] | Loss=5.59085 | acc=0.1102 | tpr=0.9280 | fpr=0.9047 | 8227.9 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.59088 | acc=0.1101 | tpr=0.9278 | fpr=0.9048 | 8087.8 samples/s | 31.6 steps/s
[Step= 450] | Loss=5.59442 | acc=0.1100 | tpr=0.9270 | fpr=0.9048 | 7852.8 samples/s | 30.7 steps/s
[Step= 500] | Loss=5.59478 | acc=0.1101 | tpr=0.9282 | fpr=0.9046 | 8319.8 samples/s | 32.5 steps/s
[Step= 550] | Loss=5.59338 | acc=0.1102 | tpr=0.9300 | fpr=0.9047 | 15065.6 samples/s | 58.8 steps/s
Avg test loss: 5.59409, Avg test acc: 0.11010, Avg tpr: 0.93027, Avg fpr: 0.90481, total FA: 125631

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08955 | acc=0.9822 | tpr=0.9646 | fpr=0.0175 | 4166.8 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.09322 | acc=0.9816 | tpr=0.9616 | fpr=0.0180 | 5575.5 samples/s | 21.8 steps/s
[Step= 150] | Loss=0.09796 | acc=0.9804 | tpr=0.9611 | fpr=0.0192 | 8014.9 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.09951 | acc=0.9804 | tpr=0.9628 | fpr=0.0193 | 8189.3 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.09816 | acc=0.9801 | tpr=0.9616 | fpr=0.0195 | 8345.4 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.10065 | acc=0.9797 | tpr=0.9578 | fpr=0.0199 | 7493.2 samples/s | 29.3 steps/s
[Step= 350] | Loss=0.10060 | acc=0.9796 | tpr=0.9580 | fpr=0.0200 | 8242.7 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.10152 | acc=0.9795 | tpr=0.9557 | fpr=0.0201 | 8439.2 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.10359 | acc=0.9792 | tpr=0.9537 | fpr=0.0203 | 8185.8 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.10303 | acc=0.9794 | tpr=0.9546 | fpr=0.0202 | 7995.7 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.10236 | acc=0.9795 | tpr=0.9530 | fpr=0.0200 | 15533.1 samples/s | 60.7 steps/s
Avg test loss: 0.10215, Avg test acc: 0.97952, Avg tpr: 0.95285, Avg fpr: 0.02000, total FA: 2777

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13578 | acc=0.9780 | tpr=0.9602 | fpr=0.0217 | 4162.0 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.14114 | acc=0.9771 | tpr=0.9574 | fpr=0.0226 | 5619.2 samples/s | 21.9 steps/s
[Step= 150] | Loss=0.14664 | acc=0.9764 | tpr=0.9625 | fpr=0.0234 | 8256.5 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.14859 | acc=0.9762 | tpr=0.9661 | fpr=0.0236 | 8327.5 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.14676 | acc=0.9763 | tpr=0.9642 | fpr=0.0235 | 7946.7 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.15064 | acc=0.9759 | tpr=0.9622 | fpr=0.0238 | 7426.2 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.15090 | acc=0.9760 | tpr=0.9631 | fpr=0.0238 | 8342.0 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.15197 | acc=0.9759 | tpr=0.9617 | fpr=0.0239 | 8176.3 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.15489 | acc=0.9756 | tpr=0.9601 | fpr=0.0241 | 8211.7 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.15426 | acc=0.9757 | tpr=0.9595 | fpr=0.0241 | 8125.2 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.15299 | acc=0.9758 | tpr=0.9578 | fpr=0.0239 | 15315.5 samples/s | 59.8 steps/s
Avg test loss: 0.15275, Avg test acc: 0.97578, Avg tpr: 0.95761, Avg fpr: 0.02389, total FA: 3317

server round 47/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=54001 Epoch=105.3] | Loss=0.02124 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.084 | L2-Norm(final)=11.825 | 3645.0 samples/s | 57.0 steps/s
[Step=54050 Epoch=105.4] | Loss=0.01951 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.084 | L2-Norm(final)=11.828 | 5624.1 samples/s | 87.9 steps/s
[Step=54100 Epoch=105.5] | Loss=0.01759 | Reg=0.00102 | acc=0.9688 | L2-Norm=10.084 | L2-Norm(final)=11.831 | 5685.6 samples/s | 88.8 steps/s
[Step=54150 Epoch=105.6] | Loss=0.01629 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.084 | L2-Norm(final)=11.835 | 5761.4 samples/s | 90.0 steps/s
[Step=54200 Epoch=105.7] | Loss=0.01561 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.084 | L2-Norm(final)=11.839 | 5788.2 samples/s | 90.4 steps/s
[Step=54250 Epoch=105.8] | Loss=0.01553 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.084 | L2-Norm(final)=11.843 | 5845.4 samples/s | 91.3 steps/s
[Step=54300 Epoch=105.9] | Loss=0.01545 | Reg=0.00102 | acc=0.9688 | L2-Norm=10.084 | L2-Norm(final)=11.847 | 5764.4 samples/s | 90.1 steps/s
[Step=54350 Epoch=106.0] | Loss=0.01545 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.084 | L2-Norm(final)=11.851 | 5821.0 samples/s | 91.0 steps/s
[Step=54400 Epoch=106.1] | Loss=0.01572 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.084 | L2-Norm(final)=11.855 | 5768.2 samples/s | 90.1 steps/s
[Step=54450 Epoch=106.2] | Loss=0.01572 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.084 | L2-Norm(final)=11.858 | 5797.5 samples/s | 90.6 steps/s
[Step=54500 Epoch=106.3] | Loss=0.01576 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.084 | L2-Norm(final)=11.862 | 7261.8 samples/s | 113.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=54501 Epoch=106.3] | Loss=0.02097 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.084 | L2-Norm(final)=11.896 | 3675.7 samples/s | 57.4 steps/s
[Step=54550 Epoch=106.4] | Loss=0.01391 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.091 | L2-Norm(final)=11.898 | 4618.1 samples/s | 72.2 steps/s
[Step=54600 Epoch=106.5] | Loss=0.01407 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.098 | L2-Norm(final)=11.901 | 4959.2 samples/s | 77.5 steps/s
[Step=54650 Epoch=106.6] | Loss=0.01431 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.105 | L2-Norm(final)=11.903 | 4998.4 samples/s | 78.1 steps/s
[Step=54700 Epoch=106.7] | Loss=0.01381 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.111 | L2-Norm(final)=11.906 | 5073.3 samples/s | 79.3 steps/s
[Step=54750 Epoch=106.8] | Loss=0.01337 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.116 | L2-Norm(final)=11.908 | 5001.7 samples/s | 78.2 steps/s
[Step=54800 Epoch=106.9] | Loss=0.01352 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.120 | L2-Norm(final)=11.911 | 5015.9 samples/s | 78.4 steps/s
[Step=54850 Epoch=107.0] | Loss=0.01299 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.125 | L2-Norm(final)=11.913 | 4994.7 samples/s | 78.0 steps/s
[Step=54900 Epoch=107.1] | Loss=0.01281 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.129 | L2-Norm(final)=11.916 | 4974.0 samples/s | 77.7 steps/s
[Step=54950 Epoch=107.2] | Loss=0.01261 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.133 | L2-Norm(final)=11.919 | 4991.4 samples/s | 78.0 steps/s
[Step=55000 Epoch=107.3] | Loss=0.01214 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.137 | L2-Norm(final)=11.921 | 6138.4 samples/s | 95.9 steps/s
[Step=55050 Epoch=107.4] | Loss=0.01176 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.140 | L2-Norm(final)=11.924 | 1875.2 samples/s | 29.3 steps/s
[Step=55100 Epoch=107.5] | Loss=0.01138 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.144 | L2-Norm(final)=11.926 | 5061.7 samples/s | 79.1 steps/s
[Step=55150 Epoch=107.6] | Loss=0.01112 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.147 | L2-Norm(final)=11.929 | 5031.2 samples/s | 78.6 steps/s
[Step=55200 Epoch=107.7] | Loss=0.01092 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.150 | L2-Norm(final)=11.932 | 5030.4 samples/s | 78.6 steps/s
[Step=55250 Epoch=107.8] | Loss=0.01064 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.153 | L2-Norm(final)=11.934 | 4914.8 samples/s | 76.8 steps/s
[Step=55300 Epoch=107.9] | Loss=0.01050 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.156 | L2-Norm(final)=11.937 | 5128.9 samples/s | 80.1 steps/s
[Step=55350 Epoch=108.0] | Loss=0.01040 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.159 | L2-Norm(final)=11.939 | 4938.7 samples/s | 77.2 steps/s
[Step=55400 Epoch=108.1] | Loss=0.01022 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=11.941 | 5010.4 samples/s | 78.3 steps/s
[Step=55450 Epoch=108.1] | Loss=0.01014 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.165 | L2-Norm(final)=11.944 | 5018.7 samples/s | 78.4 steps/s
[Step=55500 Epoch=108.2] | Loss=0.01006 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.167 | L2-Norm(final)=11.946 | 5383.0 samples/s | 84.1 steps/s
[Step=55550 Epoch=108.3] | Loss=0.00980 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.170 | L2-Norm(final)=11.948 | 1980.4 samples/s | 30.9 steps/s
[Step=55600 Epoch=108.4] | Loss=0.00965 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.172 | L2-Norm(final)=11.951 | 5125.6 samples/s | 80.1 steps/s
[Step=55650 Epoch=108.5] | Loss=0.00953 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.175 | L2-Norm(final)=11.953 | 5059.1 samples/s | 79.0 steps/s
[Step=55700 Epoch=108.6] | Loss=0.00938 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.177 | L2-Norm(final)=11.955 | 5105.6 samples/s | 79.8 steps/s
[Step=55750 Epoch=108.7] | Loss=0.00927 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.179 | L2-Norm(final)=11.957 | 5147.6 samples/s | 80.4 steps/s
[Step=55800 Epoch=108.8] | Loss=0.00919 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.182 | L2-Norm(final)=11.959 | 5078.0 samples/s | 79.3 steps/s
[Step=55850 Epoch=108.9] | Loss=0.00910 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.184 | L2-Norm(final)=11.962 | 4985.6 samples/s | 77.9 steps/s
[Step=55900 Epoch=109.0] | Loss=0.00902 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.186 | L2-Norm(final)=11.964 | 4984.6 samples/s | 77.9 steps/s
[Step=55950 Epoch=109.1] | Loss=0.00895 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.188 | L2-Norm(final)=11.966 | 5064.4 samples/s | 79.1 steps/s
[Step=56000 Epoch=109.2] | Loss=0.00887 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.190 | L2-Norm(final)=11.968 | 5055.1 samples/s | 79.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step56000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=36001 Epoch=138.6] | Loss=0.00005 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.084 | L2-Norm(final)=12.227 | 3715.2 samples/s | 58.0 steps/s
[Step=36050 Epoch=138.8] | Loss=0.00008 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.081 | L2-Norm(final)=12.239 | 5177.6 samples/s | 80.9 steps/s
[Step=36100 Epoch=139.0] | Loss=0.00009 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.080 | L2-Norm(final)=12.254 | 5580.5 samples/s | 87.2 steps/s
[Step=36150 Epoch=139.2] | Loss=0.00008 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.080 | L2-Norm(final)=12.264 | 5382.8 samples/s | 84.1 steps/s
[Step=36200 Epoch=139.3] | Loss=0.00007 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.080 | L2-Norm(final)=12.273 | 5566.4 samples/s | 87.0 steps/s
[Step=36250 Epoch=139.5] | Loss=0.00007 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.080 | L2-Norm(final)=12.280 | 7046.0 samples/s | 110.1 steps/s
[Step=36300 Epoch=139.7] | Loss=0.00007 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.080 | L2-Norm(final)=12.286 | 1964.2 samples/s | 30.7 steps/s
[Step=36350 Epoch=139.9] | Loss=0.00007 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.080 | L2-Norm(final)=12.293 | 5417.5 samples/s | 84.6 steps/s
[Step=36400 Epoch=140.1] | Loss=0.00007 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.080 | L2-Norm(final)=12.300 | 5489.2 samples/s | 85.8 steps/s
[Step=36450 Epoch=140.3] | Loss=0.00007 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.080 | L2-Norm(final)=12.307 | 5409.3 samples/s | 84.5 steps/s
[Step=36500 Epoch=140.5] | Loss=0.00007 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.080 | L2-Norm(final)=12.313 | 6322.4 samples/s | 98.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=36501 Epoch=140.5] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.080 | L2-Norm(final)=12.370 | 3865.9 samples/s | 60.4 steps/s
[Step=36550 Epoch=140.7] | Loss=0.00010 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.079 | L2-Norm(final)=12.374 | 4496.9 samples/s | 70.3 steps/s
[Step=36600 Epoch=140.9] | Loss=0.00006 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.080 | L2-Norm(final)=12.377 | 4800.7 samples/s | 75.0 steps/s
[Step=36650 Epoch=141.1] | Loss=0.00004 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.077 | L2-Norm(final)=12.379 | 4746.2 samples/s | 74.2 steps/s
[Step=36700 Epoch=141.3] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.072 | L2-Norm(final)=12.380 | 4792.9 samples/s | 74.9 steps/s
[Step=36750 Epoch=141.5] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=12.381 | 6111.7 samples/s | 95.5 steps/s
[Step=36800 Epoch=141.7] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.062 | L2-Norm(final)=12.382 | 1884.2 samples/s | 29.4 steps/s
[Step=36850 Epoch=141.9] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.056 | L2-Norm(final)=12.383 | 4779.8 samples/s | 74.7 steps/s
[Step=36900 Epoch=142.0] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.050 | L2-Norm(final)=12.384 | 4748.7 samples/s | 74.2 steps/s
[Step=36950 Epoch=142.2] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.044 | L2-Norm(final)=12.384 | 4808.2 samples/s | 75.1 steps/s
[Step=37000 Epoch=142.4] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.038 | L2-Norm(final)=12.385 | 5523.0 samples/s | 86.3 steps/s
[Step=37050 Epoch=142.6] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.032 | L2-Norm(final)=12.385 | 1946.0 samples/s | 30.4 steps/s
[Step=37100 Epoch=142.8] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=12.386 | 4803.8 samples/s | 75.1 steps/s
[Step=37150 Epoch=143.0] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.019 | L2-Norm(final)=12.386 | 4822.0 samples/s | 75.3 steps/s
[Step=37200 Epoch=143.2] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=12.387 | 4725.8 samples/s | 73.8 steps/s
[Step=37250 Epoch=143.4] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.006 | L2-Norm(final)=12.387 | 4904.5 samples/s | 76.6 steps/s
[Step=37300 Epoch=143.6] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.999 | L2-Norm(final)=12.388 | 2023.6 samples/s | 31.6 steps/s
[Step=37350 Epoch=143.8] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.992 | L2-Norm(final)=12.388 | 4780.8 samples/s | 74.7 steps/s
[Step=37400 Epoch=144.0] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.985 | L2-Norm(final)=12.389 | 4816.5 samples/s | 75.3 steps/s
[Step=37450 Epoch=144.2] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.978 | L2-Norm(final)=12.389 | 4785.7 samples/s | 74.8 steps/s
[Step=37500 Epoch=144.4] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.970 | L2-Norm(final)=12.390 | 4865.6 samples/s | 76.0 steps/s
[Step=37550 Epoch=144.5] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.963 | L2-Norm(final)=12.390 | 2014.8 samples/s | 31.5 steps/s
[Step=37600 Epoch=144.7] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.956 | L2-Norm(final)=12.391 | 4906.2 samples/s | 76.7 steps/s
[Step=37650 Epoch=144.9] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.948 | L2-Norm(final)=12.391 | 4816.7 samples/s | 75.3 steps/s
[Step=37700 Epoch=145.1] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.941 | L2-Norm(final)=12.391 | 4728.9 samples/s | 73.9 steps/s
[Step=37750 Epoch=145.3] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.933 | L2-Norm(final)=12.392 | 4787.8 samples/s | 74.8 steps/s
[Step=37800 Epoch=145.5] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.925 | L2-Norm(final)=12.392 | 6986.4 samples/s | 109.2 steps/s
[Step=37850 Epoch=145.7] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.917 | L2-Norm(final)=12.393 | 1818.1 samples/s | 28.4 steps/s
[Step=37900 Epoch=145.9] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.909 | L2-Norm(final)=12.393 | 4805.5 samples/s | 75.1 steps/s
[Step=37950 Epoch=146.1] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=12.394 | 4843.0 samples/s | 75.7 steps/s
[Step=38000 Epoch=146.3] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.893 | L2-Norm(final)=12.394 | 4674.3 samples/s | 73.0 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_1/client_state-step38000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06311 | acc=0.9698 | tpr=0.9774 | fpr=0.0468 | 3498.8 samples/s | 13.7 steps/s
Avg test loss: 0.06585, Avg test acc: 0.96843, Avg tpr: 0.97604, Avg fpr: 0.04833, total FA: 377

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07039 | acc=0.9673 | tpr=0.9716 | fpr=0.0419 | 3191.6 samples/s | 12.5 steps/s
Avg test loss: 0.07419, Avg test acc: 0.96634, Avg tpr: 0.97086, Avg fpr: 0.04358, total FA: 340

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.27613 | acc=0.3234 | tpr=0.0217 | fpr=0.0216 | 3150.0 samples/s | 12.3 steps/s
Avg test loss: 5.27951, Avg test acc: 0.32022, Avg tpr: 0.02116, Avg fpr: 0.02205, total FA: 172

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.37021 | acc=0.3328 | tpr=0.0387 | fpr=0.0285 | 3183.6 samples/s | 12.4 steps/s
Avg test loss: 5.37560, Avg test acc: 0.33104, Avg tpr: 0.03911, Avg fpr: 0.02692, total FA: 210

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.40927 | acc=0.0980 | tpr=0.9513 | fpr=0.9173 | 3157.7 samples/s | 12.3 steps/s
[Step= 100] | Loss=5.39065 | acc=0.1008 | tpr=0.9339 | fpr=0.9148 | 8543.5 samples/s | 33.4 steps/s
[Step= 150] | Loss=5.40563 | acc=0.1011 | tpr=0.9352 | fpr=0.9143 | 8253.0 samples/s | 32.2 steps/s
[Step= 200] | Loss=5.39930 | acc=0.1012 | tpr=0.9366 | fpr=0.9140 | 8197.7 samples/s | 32.0 steps/s
[Step= 250] | Loss=5.39695 | acc=0.1015 | tpr=0.9362 | fpr=0.9137 | 8388.5 samples/s | 32.8 steps/s
[Step= 300] | Loss=5.39900 | acc=0.1012 | tpr=0.9345 | fpr=0.9140 | 8383.1 samples/s | 32.7 steps/s
[Step= 350] | Loss=5.40016 | acc=0.1007 | tpr=0.9374 | fpr=0.9145 | 8084.1 samples/s | 31.6 steps/s
[Step= 400] | Loss=5.40032 | acc=0.1006 | tpr=0.9376 | fpr=0.9146 | 8707.1 samples/s | 34.0 steps/s
[Step= 450] | Loss=5.40284 | acc=0.1005 | tpr=0.9372 | fpr=0.9147 | 8181.4 samples/s | 32.0 steps/s
[Step= 500] | Loss=5.40294 | acc=0.1003 | tpr=0.9379 | fpr=0.9148 | 7894.6 samples/s | 30.8 steps/s
[Step= 550] | Loss=5.40148 | acc=0.1005 | tpr=0.9395 | fpr=0.9147 | 14851.8 samples/s | 58.0 steps/s
Avg test loss: 5.40215, Avg test acc: 0.10044, Avg tpr: 0.93938, Avg fpr: 0.91481, total FA: 127019

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.59001 | acc=0.1084 | tpr=0.9469 | fpr=0.9067 | 4227.6 samples/s | 16.5 steps/s
[Step= 100] | Loss=5.57330 | acc=0.1106 | tpr=0.9275 | fpr=0.9046 | 8237.7 samples/s | 32.2 steps/s
[Step= 150] | Loss=5.59514 | acc=0.1101 | tpr=0.9280 | fpr=0.9050 | 8422.5 samples/s | 32.9 steps/s
[Step= 200] | Loss=5.58707 | acc=0.1103 | tpr=0.9268 | fpr=0.9046 | 8224.5 samples/s | 32.1 steps/s
[Step= 250] | Loss=5.58648 | acc=0.1109 | tpr=0.9284 | fpr=0.9040 | 8344.5 samples/s | 32.6 steps/s
[Step= 300] | Loss=5.58960 | acc=0.1107 | tpr=0.9265 | fpr=0.9042 | 8084.7 samples/s | 31.6 steps/s
[Step= 350] | Loss=5.59085 | acc=0.1102 | tpr=0.9280 | fpr=0.9047 | 8384.6 samples/s | 32.8 steps/s
[Step= 400] | Loss=5.59088 | acc=0.1101 | tpr=0.9278 | fpr=0.9048 | 8323.5 samples/s | 32.5 steps/s
[Step= 450] | Loss=5.59442 | acc=0.1100 | tpr=0.9270 | fpr=0.9048 | 8354.5 samples/s | 32.6 steps/s
[Step= 500] | Loss=5.59478 | acc=0.1101 | tpr=0.9282 | fpr=0.9046 | 8242.4 samples/s | 32.2 steps/s
[Step= 550] | Loss=5.59338 | acc=0.1102 | tpr=0.9300 | fpr=0.9047 | 15205.4 samples/s | 59.4 steps/s
Avg test loss: 5.59409, Avg test acc: 0.11010, Avg tpr: 0.93027, Avg fpr: 0.90481, total FA: 125631

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08955 | acc=0.9822 | tpr=0.9646 | fpr=0.0175 | 4210.3 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.09322 | acc=0.9816 | tpr=0.9616 | fpr=0.0180 | 8108.5 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.09796 | acc=0.9804 | tpr=0.9611 | fpr=0.0192 | 7775.9 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.09951 | acc=0.9804 | tpr=0.9628 | fpr=0.0193 | 7801.2 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.09816 | acc=0.9801 | tpr=0.9616 | fpr=0.0195 | 7677.1 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.10065 | acc=0.9797 | tpr=0.9578 | fpr=0.0199 | 7899.5 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.10060 | acc=0.9796 | tpr=0.9580 | fpr=0.0200 | 8713.6 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.10152 | acc=0.9795 | tpr=0.9557 | fpr=0.0201 | 7854.7 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.10359 | acc=0.9792 | tpr=0.9537 | fpr=0.0203 | 8468.4 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.10303 | acc=0.9794 | tpr=0.9546 | fpr=0.0202 | 7835.0 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.10236 | acc=0.9795 | tpr=0.9530 | fpr=0.0200 | 15708.9 samples/s | 61.4 steps/s
Avg test loss: 0.10215, Avg test acc: 0.97952, Avg tpr: 0.95285, Avg fpr: 0.02000, total FA: 2777

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12703 | acc=0.9788 | tpr=0.9646 | fpr=0.0209 | 4154.2 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.13256 | acc=0.9778 | tpr=0.9638 | fpr=0.0220 | 8297.6 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.13852 | acc=0.9766 | tpr=0.9669 | fpr=0.0232 | 8287.6 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.14031 | acc=0.9764 | tpr=0.9694 | fpr=0.0235 | 8328.4 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.13857 | acc=0.9765 | tpr=0.9677 | fpr=0.0234 | 8242.3 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.14218 | acc=0.9760 | tpr=0.9651 | fpr=0.0238 | 8323.3 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.14240 | acc=0.9761 | tpr=0.9662 | fpr=0.0237 | 8400.0 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.14343 | acc=0.9758 | tpr=0.9639 | fpr=0.0239 | 8304.2 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.14621 | acc=0.9757 | tpr=0.9620 | fpr=0.0241 | 7980.3 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.14565 | acc=0.9757 | tpr=0.9617 | fpr=0.0240 | 8187.8 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.14462 | acc=0.9759 | tpr=0.9598 | fpr=0.0238 | 15539.5 samples/s | 60.7 steps/s
Avg test loss: 0.14440, Avg test acc: 0.97589, Avg tpr: 0.95959, Avg fpr: 0.02381, total FA: 3306

server round 48/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=46001 Epoch=89.9] | Loss=0.00583 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=11.955 | 4024.0 samples/s | 62.9 steps/s
[Step=46050 Epoch=90.0] | Loss=0.01588 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=11.959 | 4919.2 samples/s | 76.9 steps/s
[Step=46100 Epoch=90.1] | Loss=0.01478 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=11.965 | 5716.2 samples/s | 89.3 steps/s
[Step=46150 Epoch=90.2] | Loss=0.01545 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.604 | L2-Norm(final)=11.971 | 5663.9 samples/s | 88.5 steps/s
[Step=46200 Epoch=90.3] | Loss=0.01550 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=11.977 | 5835.0 samples/s | 91.2 steps/s
[Step=46250 Epoch=90.4] | Loss=0.01571 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=11.983 | 5810.6 samples/s | 90.8 steps/s
[Step=46300 Epoch=90.5] | Loss=0.01600 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=11.988 | 5667.9 samples/s | 88.6 steps/s
[Step=46350 Epoch=90.6] | Loss=0.01572 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.604 | L2-Norm(final)=11.993 | 5812.4 samples/s | 90.8 steps/s
[Step=46400 Epoch=90.7] | Loss=0.01564 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=11.999 | 5757.2 samples/s | 90.0 steps/s
[Step=46450 Epoch=90.8] | Loss=0.01553 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.604 | L2-Norm(final)=12.004 | 5820.7 samples/s | 90.9 steps/s
[Step=46500 Epoch=90.9] | Loss=0.01551 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=12.010 | 7410.4 samples/s | 115.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=90.9] | Loss=0.00758 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=12.065 | 3873.6 samples/s | 60.5 steps/s
[Step=46550 Epoch=91.0] | Loss=0.01411 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.610 | L2-Norm(final)=12.069 | 4885.6 samples/s | 76.3 steps/s
[Step=46600 Epoch=91.1] | Loss=0.01563 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.618 | L2-Norm(final)=12.073 | 5112.2 samples/s | 79.9 steps/s
[Step=46650 Epoch=91.2] | Loss=0.01511 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.625 | L2-Norm(final)=12.076 | 4983.8 samples/s | 77.9 steps/s
[Step=46700 Epoch=91.3] | Loss=0.01483 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.631 | L2-Norm(final)=12.079 | 5001.1 samples/s | 78.1 steps/s
[Step=46750 Epoch=91.4] | Loss=0.01436 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.637 | L2-Norm(final)=12.083 | 5048.0 samples/s | 78.9 steps/s
[Step=46800 Epoch=91.5] | Loss=0.01390 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.642 | L2-Norm(final)=12.086 | 5075.9 samples/s | 79.3 steps/s
[Step=46850 Epoch=91.6] | Loss=0.01330 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.647 | L2-Norm(final)=12.089 | 4993.8 samples/s | 78.0 steps/s
[Step=46900 Epoch=91.7] | Loss=0.01293 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.652 | L2-Norm(final)=12.092 | 5037.4 samples/s | 78.7 steps/s
[Step=46950 Epoch=91.8] | Loss=0.01275 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.656 | L2-Norm(final)=12.095 | 5063.1 samples/s | 79.1 steps/s
[Step=47000 Epoch=91.9] | Loss=0.01255 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.661 | L2-Norm(final)=12.098 | 6298.9 samples/s | 98.4 steps/s
[Step=47050 Epoch=92.0] | Loss=0.01226 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.665 | L2-Norm(final)=12.101 | 1944.4 samples/s | 30.4 steps/s
[Step=47100 Epoch=92.1] | Loss=0.01186 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.669 | L2-Norm(final)=12.105 | 4998.8 samples/s | 78.1 steps/s
[Step=47150 Epoch=92.2] | Loss=0.01154 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.673 | L2-Norm(final)=12.108 | 5043.3 samples/s | 78.8 steps/s
[Step=47200 Epoch=92.3] | Loss=0.01129 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.676 | L2-Norm(final)=12.111 | 5048.6 samples/s | 78.9 steps/s
[Step=47250 Epoch=92.4] | Loss=0.01114 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.680 | L2-Norm(final)=12.114 | 4985.5 samples/s | 77.9 steps/s
[Step=47300 Epoch=92.5] | Loss=0.01092 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.683 | L2-Norm(final)=12.117 | 5091.7 samples/s | 79.6 steps/s
[Step=47350 Epoch=92.6] | Loss=0.01072 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.686 | L2-Norm(final)=12.119 | 4952.2 samples/s | 77.4 steps/s
[Step=47400 Epoch=92.7] | Loss=0.01060 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.689 | L2-Norm(final)=12.122 | 5037.3 samples/s | 78.7 steps/s
[Step=47450 Epoch=92.8] | Loss=0.01043 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.692 | L2-Norm(final)=12.125 | 5042.9 samples/s | 78.8 steps/s
[Step=47500 Epoch=92.9] | Loss=0.01035 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.695 | L2-Norm(final)=12.128 | 5408.7 samples/s | 84.5 steps/s
[Step=47550 Epoch=93.0] | Loss=0.01017 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.698 | L2-Norm(final)=12.130 | 2018.3 samples/s | 31.5 steps/s
[Step=47600 Epoch=93.1] | Loss=0.00999 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.701 | L2-Norm(final)=12.133 | 5088.9 samples/s | 79.5 steps/s
[Step=47650 Epoch=93.2] | Loss=0.00977 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.704 | L2-Norm(final)=12.136 | 4978.1 samples/s | 77.8 steps/s
[Step=47700 Epoch=93.3] | Loss=0.00960 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.706 | L2-Norm(final)=12.138 | 4980.8 samples/s | 77.8 steps/s
[Step=47750 Epoch=93.4] | Loss=0.00951 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.709 | L2-Norm(final)=12.141 | 5010.5 samples/s | 78.3 steps/s
[Step=47800 Epoch=93.4] | Loss=0.00944 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.712 | L2-Norm(final)=12.144 | 5092.7 samples/s | 79.6 steps/s
[Step=47850 Epoch=93.5] | Loss=0.00935 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.714 | L2-Norm(final)=12.146 | 4967.3 samples/s | 77.6 steps/s
[Step=47900 Epoch=93.6] | Loss=0.00926 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.717 | L2-Norm(final)=12.149 | 5048.8 samples/s | 78.9 steps/s
[Step=47950 Epoch=93.7] | Loss=0.00918 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.719 | L2-Norm(final)=12.151 | 5093.4 samples/s | 79.6 steps/s
[Step=48000 Epoch=93.8] | Loss=0.00915 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.722 | L2-Norm(final)=12.154 | 5074.8 samples/s | 79.3 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_1/client_state-step48000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=52001 Epoch=199.2] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=12.353 | 3963.8 samples/s | 61.9 steps/s
[Step=52050 Epoch=199.4] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=12.360 | 4814.0 samples/s | 75.2 steps/s
[Step=52100 Epoch=199.6] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.592 | L2-Norm(final)=12.365 | 5529.2 samples/s | 86.4 steps/s
[Step=52150 Epoch=199.8] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.591 | L2-Norm(final)=12.368 | 5351.3 samples/s | 83.6 steps/s
[Step=52200 Epoch=200.0] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.591 | L2-Norm(final)=12.371 | 5532.1 samples/s | 86.4 steps/s
[Step=52250 Epoch=200.2] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.591 | L2-Norm(final)=12.375 | 7044.4 samples/s | 110.1 steps/s
[Step=52300 Epoch=200.4] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.591 | L2-Norm(final)=12.380 | 1954.2 samples/s | 30.5 steps/s
[Step=52350 Epoch=200.6] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.591 | L2-Norm(final)=12.386 | 5408.0 samples/s | 84.5 steps/s
[Step=52400 Epoch=200.8] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.591 | L2-Norm(final)=12.392 | 5414.2 samples/s | 84.6 steps/s
[Step=52450 Epoch=201.0] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.591 | L2-Norm(final)=12.397 | 5456.2 samples/s | 85.3 steps/s
[Step=52500 Epoch=201.2] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.591 | L2-Norm(final)=12.404 | 6169.4 samples/s | 96.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=52501 Epoch=201.2] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.591 | L2-Norm(final)=12.462 | 4062.8 samples/s | 63.5 steps/s
[Step=52550 Epoch=201.4] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.560 | L2-Norm(final)=12.467 | 4140.9 samples/s | 64.7 steps/s
[Step=52600 Epoch=201.5] | Loss=0.00012 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.542 | L2-Norm(final)=12.472 | 4870.3 samples/s | 76.1 steps/s
[Step=52650 Epoch=201.7] | Loss=0.00009 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=12.475 | 4837.6 samples/s | 75.6 steps/s
[Step=52700 Epoch=201.9] | Loss=0.00007 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.532 | L2-Norm(final)=12.477 | 4860.7 samples/s | 75.9 steps/s
[Step=52750 Epoch=202.1] | Loss=0.00006 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.528 | L2-Norm(final)=12.478 | 6038.2 samples/s | 94.3 steps/s
[Step=52800 Epoch=202.3] | Loss=0.00005 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.525 | L2-Norm(final)=12.479 | 1865.5 samples/s | 29.1 steps/s
[Step=52850 Epoch=202.5] | Loss=0.00004 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.521 | L2-Norm(final)=12.480 | 4825.7 samples/s | 75.4 steps/s
[Step=52900 Epoch=202.7] | Loss=0.00004 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.518 | L2-Norm(final)=12.480 | 4760.3 samples/s | 74.4 steps/s
[Step=52950 Epoch=202.9] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.514 | L2-Norm(final)=12.481 | 4708.9 samples/s | 73.6 steps/s
[Step=53000 Epoch=203.1] | Loss=0.00003 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.511 | L2-Norm(final)=12.481 | 5322.2 samples/s | 83.2 steps/s
[Step=53050 Epoch=203.3] | Loss=0.00003 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.507 | L2-Norm(final)=12.482 | 1964.0 samples/s | 30.7 steps/s
[Step=53100 Epoch=203.5] | Loss=0.00003 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.504 | L2-Norm(final)=12.482 | 4800.9 samples/s | 75.0 steps/s
[Step=53150 Epoch=203.7] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.500 | L2-Norm(final)=12.483 | 4782.0 samples/s | 74.7 steps/s
[Step=53200 Epoch=203.8] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.496 | L2-Norm(final)=12.483 | 4736.9 samples/s | 74.0 steps/s
[Step=53250 Epoch=204.0] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.493 | L2-Norm(final)=12.483 | 4816.4 samples/s | 75.3 steps/s
[Step=53300 Epoch=204.2] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.489 | L2-Norm(final)=12.484 | 2019.7 samples/s | 31.6 steps/s
[Step=53350 Epoch=204.4] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.485 | L2-Norm(final)=12.484 | 4864.0 samples/s | 76.0 steps/s
[Step=53400 Epoch=204.6] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.482 | L2-Norm(final)=12.484 | 4853.0 samples/s | 75.8 steps/s
[Step=53450 Epoch=204.8] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.478 | L2-Norm(final)=12.485 | 4733.2 samples/s | 74.0 steps/s
[Step=53500 Epoch=205.0] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.474 | L2-Norm(final)=12.485 | 4730.6 samples/s | 73.9 steps/s
[Step=53550 Epoch=205.2] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.470 | L2-Norm(final)=12.485 | 2046.9 samples/s | 32.0 steps/s
[Step=53600 Epoch=205.4] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.466 | L2-Norm(final)=12.485 | 4737.1 samples/s | 74.0 steps/s
[Step=53650 Epoch=205.6] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.462 | L2-Norm(final)=12.486 | 4809.0 samples/s | 75.1 steps/s
[Step=53700 Epoch=205.8] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.458 | L2-Norm(final)=12.486 | 4726.0 samples/s | 73.8 steps/s
[Step=53750 Epoch=206.0] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.454 | L2-Norm(final)=12.486 | 4760.9 samples/s | 74.4 steps/s
[Step=53800 Epoch=206.1] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.450 | L2-Norm(final)=12.486 | 6549.5 samples/s | 102.3 steps/s
[Step=53850 Epoch=206.3] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.446 | L2-Norm(final)=12.487 | 1840.6 samples/s | 28.8 steps/s
[Step=53900 Epoch=206.5] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.441 | L2-Norm(final)=12.487 | 4770.2 samples/s | 74.5 steps/s
[Step=53950 Epoch=206.7] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.437 | L2-Norm(final)=12.487 | 4771.2 samples/s | 74.5 steps/s
[Step=54000 Epoch=206.9] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.433 | L2-Norm(final)=12.488 | 4775.4 samples/s | 74.6 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step54000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06311 | acc=0.9698 | tpr=0.9774 | fpr=0.0468 | 4101.0 samples/s | 16.0 steps/s
Avg test loss: 0.06585, Avg test acc: 0.96843, Avg tpr: 0.97604, Avg fpr: 0.04833, total FA: 377

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06601 | acc=0.9668 | tpr=0.9695 | fpr=0.0391 | 4249.7 samples/s | 16.6 steps/s
Avg test loss: 0.06930, Avg test acc: 0.96650, Avg tpr: 0.96952, Avg fpr: 0.04012, total FA: 313

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.56387 | acc=0.3265 | tpr=0.0273 | fpr=0.0238 | 4274.1 samples/s | 16.7 steps/s
Avg test loss: 5.57453, Avg test acc: 0.32426, Avg tpr: 0.02780, Avg fpr: 0.02371, total FA: 185

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.37021 | acc=0.3328 | tpr=0.0387 | fpr=0.0285 | 4180.3 samples/s | 16.3 steps/s
Avg test loss: 5.37560, Avg test acc: 0.33104, Avg tpr: 0.03911, Avg fpr: 0.02692, total FA: 210

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.40927 | acc=0.0980 | tpr=0.9513 | fpr=0.9173 | 4223.1 samples/s | 16.5 steps/s
[Step= 100] | Loss=5.39065 | acc=0.1008 | tpr=0.9339 | fpr=0.9148 | 8324.4 samples/s | 32.5 steps/s
[Step= 150] | Loss=5.40563 | acc=0.1011 | tpr=0.9352 | fpr=0.9143 | 8128.0 samples/s | 31.8 steps/s
[Step= 200] | Loss=5.39930 | acc=0.1012 | tpr=0.9366 | fpr=0.9140 | 8371.4 samples/s | 32.7 steps/s
[Step= 250] | Loss=5.39695 | acc=0.1015 | tpr=0.9362 | fpr=0.9137 | 8142.0 samples/s | 31.8 steps/s
[Step= 300] | Loss=5.39900 | acc=0.1012 | tpr=0.9345 | fpr=0.9140 | 8225.2 samples/s | 32.1 steps/s
[Step= 350] | Loss=5.40016 | acc=0.1007 | tpr=0.9374 | fpr=0.9145 | 8448.5 samples/s | 33.0 steps/s
[Step= 400] | Loss=5.40032 | acc=0.1006 | tpr=0.9376 | fpr=0.9146 | 8344.5 samples/s | 32.6 steps/s
[Step= 450] | Loss=5.40284 | acc=0.1005 | tpr=0.9372 | fpr=0.9147 | 8097.8 samples/s | 31.6 steps/s
[Step= 500] | Loss=5.40294 | acc=0.1003 | tpr=0.9379 | fpr=0.9148 | 8265.8 samples/s | 32.3 steps/s
[Step= 550] | Loss=5.40148 | acc=0.1005 | tpr=0.9395 | fpr=0.9147 | 14958.0 samples/s | 58.4 steps/s
Avg test loss: 5.40215, Avg test acc: 0.10044, Avg tpr: 0.93938, Avg fpr: 0.91481, total FA: 127019

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.69847 | acc=0.1173 | tpr=0.9469 | fpr=0.8976 | 4157.3 samples/s | 16.2 steps/s
[Step= 100] | Loss=4.68256 | acc=0.1193 | tpr=0.9275 | fpr=0.8958 | 8381.1 samples/s | 32.7 steps/s
[Step= 150] | Loss=4.70131 | acc=0.1188 | tpr=0.9280 | fpr=0.8961 | 8174.4 samples/s | 31.9 steps/s
[Step= 200] | Loss=4.69496 | acc=0.1189 | tpr=0.9268 | fpr=0.8958 | 8346.1 samples/s | 32.6 steps/s
[Step= 250] | Loss=4.69302 | acc=0.1200 | tpr=0.9258 | fpr=0.8947 | 8163.5 samples/s | 31.9 steps/s
[Step= 300] | Loss=4.69533 | acc=0.1195 | tpr=0.9215 | fpr=0.8951 | 8727.9 samples/s | 34.1 steps/s
[Step= 350] | Loss=4.69640 | acc=0.1188 | tpr=0.9236 | fpr=0.8958 | 8180.7 samples/s | 32.0 steps/s
[Step= 400] | Loss=4.69648 | acc=0.1187 | tpr=0.9223 | fpr=0.8960 | 8440.5 samples/s | 33.0 steps/s
[Step= 450] | Loss=4.69910 | acc=0.1185 | tpr=0.9216 | fpr=0.8961 | 8333.5 samples/s | 32.6 steps/s
[Step= 500] | Loss=4.69911 | acc=0.1187 | tpr=0.9220 | fpr=0.8958 | 7993.1 samples/s | 31.2 steps/s
[Step= 550] | Loss=4.69756 | acc=0.1187 | tpr=0.9240 | fpr=0.8959 | 15234.9 samples/s | 59.5 steps/s
Avg test loss: 4.69823, Avg test acc: 0.11865, Avg tpr: 0.92393, Avg fpr: 0.89599, total FA: 124406

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10756 | acc=0.9806 | tpr=0.9558 | fpr=0.0189 | 4205.7 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.11181 | acc=0.9797 | tpr=0.9510 | fpr=0.0197 | 8387.1 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.11729 | acc=0.9785 | tpr=0.9553 | fpr=0.0211 | 8238.1 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.11891 | acc=0.9786 | tpr=0.9552 | fpr=0.0210 | 8530.6 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.11738 | acc=0.9784 | tpr=0.9528 | fpr=0.0211 | 8137.4 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.12040 | acc=0.9780 | tpr=0.9505 | fpr=0.0215 | 8407.0 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.12049 | acc=0.9781 | tpr=0.9493 | fpr=0.0214 | 8311.3 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.12131 | acc=0.9781 | tpr=0.9486 | fpr=0.0214 | 8160.4 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.12376 | acc=0.9778 | tpr=0.9484 | fpr=0.0216 | 8169.5 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.12312 | acc=0.9779 | tpr=0.9489 | fpr=0.0215 | 8229.3 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.12228 | acc=0.9781 | tpr=0.9475 | fpr=0.0214 | 15454.0 samples/s | 60.4 steps/s
Avg test loss: 0.12203, Avg test acc: 0.97807, Avg tpr: 0.94731, Avg fpr: 0.02137, total FA: 2967

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12703 | acc=0.9788 | tpr=0.9646 | fpr=0.0209 | 4120.0 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.13256 | acc=0.9778 | tpr=0.9638 | fpr=0.0220 | 8190.8 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.13852 | acc=0.9766 | tpr=0.9669 | fpr=0.0232 | 8310.9 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.14031 | acc=0.9764 | tpr=0.9694 | fpr=0.0235 | 8109.5 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.13857 | acc=0.9765 | tpr=0.9677 | fpr=0.0234 | 8357.2 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.14218 | acc=0.9760 | tpr=0.9651 | fpr=0.0238 | 8259.9 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.14240 | acc=0.9761 | tpr=0.9662 | fpr=0.0237 | 8309.4 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.14343 | acc=0.9758 | tpr=0.9639 | fpr=0.0239 | 8385.1 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.14621 | acc=0.9757 | tpr=0.9620 | fpr=0.0241 | 8028.8 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.14565 | acc=0.9757 | tpr=0.9617 | fpr=0.0240 | 8209.4 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.14462 | acc=0.9759 | tpr=0.9598 | fpr=0.0238 | 15259.7 samples/s | 59.6 steps/s
Avg test loss: 0.14440, Avg test acc: 0.97589, Avg tpr: 0.95959, Avg fpr: 0.02381, total FA: 3306

server round 49/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=56001 Epoch=109.2] | Loss=0.00859 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.722 | L2-Norm(final)=12.031 | 3589.7 samples/s | 56.1 steps/s
[Step=56050 Epoch=109.3] | Loss=0.01639 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.722 | L2-Norm(final)=12.034 | 5292.2 samples/s | 82.7 steps/s
[Step=56100 Epoch=109.4] | Loss=0.01556 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.722 | L2-Norm(final)=12.039 | 5637.8 samples/s | 88.1 steps/s
[Step=56150 Epoch=109.5] | Loss=0.01493 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.722 | L2-Norm(final)=12.043 | 5675.1 samples/s | 88.7 steps/s
[Step=56200 Epoch=109.6] | Loss=0.01474 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.722 | L2-Norm(final)=12.048 | 5749.2 samples/s | 89.8 steps/s
[Step=56250 Epoch=109.7] | Loss=0.01430 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.722 | L2-Norm(final)=12.052 | 5745.9 samples/s | 89.8 steps/s
[Step=56300 Epoch=109.8] | Loss=0.01431 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.722 | L2-Norm(final)=12.057 | 5856.2 samples/s | 91.5 steps/s
[Step=56350 Epoch=109.9] | Loss=0.01426 | Reg=0.00095 | acc=0.9531 | L2-Norm=9.722 | L2-Norm(final)=12.061 | 5812.8 samples/s | 90.8 steps/s
[Step=56400 Epoch=110.0] | Loss=0.01437 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.722 | L2-Norm(final)=12.066 | 5899.7 samples/s | 92.2 steps/s
[Step=56450 Epoch=110.1] | Loss=0.01410 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.722 | L2-Norm(final)=12.070 | 5733.2 samples/s | 89.6 steps/s
[Step=56500 Epoch=110.2] | Loss=0.01419 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.722 | L2-Norm(final)=12.075 | 7330.6 samples/s | 114.5 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_asml1_0/client_state-step56500.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
Not training fc1
LR=0.00006, len=1
[Step=54001 Epoch=206.9] | Loss=0.00005 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.722 | L2-Norm(final)=12.496 | 3645.1 samples/s | 57.0 steps/s
[Step=54050 Epoch=207.1] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.720 | L2-Norm(final)=12.499 | 5257.8 samples/s | 82.2 steps/s
[Step=54100 Epoch=207.3] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.720 | L2-Norm(final)=12.501 | 5496.9 samples/s | 85.9 steps/s
[Step=54150 Epoch=207.5] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.720 | L2-Norm(final)=12.503 | 5506.6 samples/s | 86.0 steps/s
[Step=54200 Epoch=207.7] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.720 | L2-Norm(final)=12.506 | 5518.7 samples/s | 86.2 steps/s
[Step=54250 Epoch=207.9] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.720 | L2-Norm(final)=12.509 | 7098.0 samples/s | 110.9 steps/s
[Step=54300 Epoch=208.1] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.720 | L2-Norm(final)=12.512 | 1970.9 samples/s | 30.8 steps/s
[Step=54350 Epoch=208.3] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.720 | L2-Norm(final)=12.515 | 5384.3 samples/s | 84.1 steps/s
[Step=54400 Epoch=208.4] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.720 | L2-Norm(final)=12.518 | 5498.4 samples/s | 85.9 steps/s
[Step=54450 Epoch=208.6] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.720 | L2-Norm(final)=12.521 | 5399.0 samples/s | 84.4 steps/s
[Step=54500 Epoch=208.8] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.720 | L2-Norm(final)=12.523 | 6212.1 samples/s | 97.1 steps/s
Client model saved at models/model-local_fc2-a2i2-sel0.5-ch26/client_iccad2012_0/client_state-step54500.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05650 | acc=0.9675 | tpr=0.9735 | fpr=0.0456 | 4222.2 samples/s | 16.5 steps/s
Avg test loss: 0.05860, Avg test acc: 0.96642, Avg tpr: 0.97255, Avg fpr: 0.04705, total FA: 367

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06601 | acc=0.9668 | tpr=0.9695 | fpr=0.0391 | 4247.2 samples/s | 16.6 steps/s
Avg test loss: 0.06930, Avg test acc: 0.96650, Avg tpr: 0.96952, Avg fpr: 0.04012, total FA: 313

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.99192 | acc=0.3306 | tpr=0.0330 | fpr=0.0230 | 4235.6 samples/s | 16.5 steps/s
Avg test loss: 4.99669, Avg test acc: 0.32907, Avg tpr: 0.03386, Avg fpr: 0.02166, total FA: 169

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.37021 | acc=0.3328 | tpr=0.0387 | fpr=0.0285 | 4193.1 samples/s | 16.4 steps/s
Avg test loss: 5.37560, Avg test acc: 0.33104, Avg tpr: 0.03911, Avg fpr: 0.02692, total FA: 210

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.09226 | acc=0.1007 | tpr=0.9513 | fpr=0.9146 | 4297.1 samples/s | 16.8 steps/s
[Step= 100] | Loss=4.07975 | acc=0.1023 | tpr=0.9424 | fpr=0.9133 | 8226.1 samples/s | 32.1 steps/s
[Step= 150] | Loss=4.09538 | acc=0.1022 | tpr=0.9467 | fpr=0.9133 | 7976.2 samples/s | 31.2 steps/s
[Step= 200] | Loss=4.08958 | acc=0.1028 | tpr=0.9486 | fpr=0.9126 | 8445.1 samples/s | 33.0 steps/s
[Step= 250] | Loss=4.08785 | acc=0.1031 | tpr=0.9502 | fpr=0.9123 | 8171.9 samples/s | 31.9 steps/s
[Step= 300] | Loss=4.09043 | acc=0.1028 | tpr=0.9491 | fpr=0.9126 | 8132.8 samples/s | 31.8 steps/s
[Step= 350] | Loss=4.09125 | acc=0.1021 | tpr=0.9499 | fpr=0.9133 | 8435.0 samples/s | 32.9 steps/s
[Step= 400] | Loss=4.09088 | acc=0.1021 | tpr=0.9486 | fpr=0.9133 | 8328.7 samples/s | 32.5 steps/s
[Step= 450] | Loss=4.09353 | acc=0.1020 | tpr=0.9479 | fpr=0.9134 | 8289.0 samples/s | 32.4 steps/s
[Step= 500] | Loss=4.09418 | acc=0.1019 | tpr=0.9476 | fpr=0.9133 | 8489.8 samples/s | 33.2 steps/s
[Step= 550] | Loss=4.09259 | acc=0.1021 | tpr=0.9499 | fpr=0.9133 | 14515.7 samples/s | 56.7 steps/s
Avg test loss: 4.09306, Avg test acc: 0.10208, Avg tpr: 0.95008, Avg fpr: 0.91334, total FA: 126815

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.69847 | acc=0.1173 | tpr=0.9469 | fpr=0.8976 | 4147.2 samples/s | 16.2 steps/s
[Step= 100] | Loss=4.68256 | acc=0.1193 | tpr=0.9275 | fpr=0.8958 | 8157.4 samples/s | 31.9 steps/s
[Step= 150] | Loss=4.70131 | acc=0.1188 | tpr=0.9280 | fpr=0.8961 | 8387.3 samples/s | 32.8 steps/s
[Step= 200] | Loss=4.69496 | acc=0.1189 | tpr=0.9268 | fpr=0.8958 | 8651.6 samples/s | 33.8 steps/s
[Step= 250] | Loss=4.69302 | acc=0.1200 | tpr=0.9258 | fpr=0.8947 | 8338.1 samples/s | 32.6 steps/s
[Step= 300] | Loss=4.69533 | acc=0.1195 | tpr=0.9215 | fpr=0.8951 | 7987.7 samples/s | 31.2 steps/s
[Step= 350] | Loss=4.69640 | acc=0.1188 | tpr=0.9236 | fpr=0.8958 | 8409.5 samples/s | 32.8 steps/s
[Step= 400] | Loss=4.69648 | acc=0.1187 | tpr=0.9223 | fpr=0.8960 | 8307.9 samples/s | 32.5 steps/s
[Step= 450] | Loss=4.69910 | acc=0.1185 | tpr=0.9216 | fpr=0.8961 | 8315.3 samples/s | 32.5 steps/s
[Step= 500] | Loss=4.69911 | acc=0.1187 | tpr=0.9220 | fpr=0.8958 | 8214.2 samples/s | 32.1 steps/s
[Step= 550] | Loss=4.69756 | acc=0.1187 | tpr=0.9240 | fpr=0.8959 | 15485.5 samples/s | 60.5 steps/s
Avg test loss: 4.69823, Avg test acc: 0.11865, Avg tpr: 0.92393, Avg fpr: 0.89599, total FA: 124406

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09525 | acc=0.9807 | tpr=0.9558 | fpr=0.0188 | 4230.8 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.09924 | acc=0.9799 | tpr=0.9574 | fpr=0.0197 | 8361.9 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.10328 | acc=0.9786 | tpr=0.9611 | fpr=0.0210 | 8398.9 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.10445 | acc=0.9786 | tpr=0.9617 | fpr=0.0211 | 8158.6 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.10315 | acc=0.9784 | tpr=0.9598 | fpr=0.0212 | 8316.2 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.10584 | acc=0.9781 | tpr=0.9578 | fpr=0.0215 | 8478.7 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.10577 | acc=0.9782 | tpr=0.9587 | fpr=0.0215 | 8357.1 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.10659 | acc=0.9779 | tpr=0.9568 | fpr=0.0217 | 8275.5 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.10869 | acc=0.9776 | tpr=0.9552 | fpr=0.0220 | 8373.4 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.10825 | acc=0.9777 | tpr=0.9555 | fpr=0.0219 | 8189.2 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.10740 | acc=0.9779 | tpr=0.9542 | fpr=0.0217 | 15015.0 samples/s | 58.7 steps/s
Avg test loss: 0.10721, Avg test acc: 0.97790, Avg tpr: 0.95404, Avg fpr: 0.02167, total FA: 3009

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12703 | acc=0.9788 | tpr=0.9646 | fpr=0.0209 | 4213.0 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.13256 | acc=0.9778 | tpr=0.9638 | fpr=0.0220 | 8271.7 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.13852 | acc=0.9766 | tpr=0.9669 | fpr=0.0232 | 8312.4 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.14031 | acc=0.9764 | tpr=0.9694 | fpr=0.0235 | 8461.5 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.13857 | acc=0.9765 | tpr=0.9677 | fpr=0.0234 | 8586.8 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.14218 | acc=0.9760 | tpr=0.9651 | fpr=0.0238 | 8313.6 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.14240 | acc=0.9761 | tpr=0.9662 | fpr=0.0237 | 8467.4 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.14343 | acc=0.9758 | tpr=0.9639 | fpr=0.0239 | 8175.1 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.14621 | acc=0.9757 | tpr=0.9620 | fpr=0.0241 | 8459.5 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.14565 | acc=0.9757 | tpr=0.9617 | fpr=0.0240 | 8133.2 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.14462 | acc=0.9759 | tpr=0.9598 | fpr=0.0238 | 15206.0 samples/s | 59.4 steps/s
Avg test loss: 0.14440, Avg test acc: 0.97589, Avg tpr: 0.95959, Avg fpr: 0.02381, total FA: 3306
