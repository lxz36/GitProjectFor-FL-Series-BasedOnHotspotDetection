#clients of iccad2012: 1
#clients of asml1: 1
select ratio: 1.0
Total num clients: 2
client model path: ['models/model-no_server-a1i1/client_asml1_0', 'models/model-no_server-a1i1/client_iccad2012_0']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (49916, 144, 32)
Resampled dataset to size (65551, 144, 32)
Using transform option: train
#pos = 34281, #neg = 31270
loading data into the main memory...
Allocated dataset with size (18300, 144, 32)
Resampled dataset to size (33952, 144, 32)
Using transform option: train
#pos = 16856, #neg = 17096
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.37571 | Reg=0.00357 | acc=0.4531 | L2-Norm=18.893 | L2-Norm(final)=1.936 | 2067.1 samples/s | 32.3 steps/s
[Step=  50 Epoch= 0.0] | Loss=0.30328 | Reg=0.00345 | acc=0.7656 | L2-Norm=18.562 | L2-Norm(final)=1.931 | 4238.0 samples/s | 66.2 steps/s
[Step= 100 Epoch= 0.1] | Loss=0.25394 | Reg=0.00340 | acc=0.9219 | L2-Norm=18.451 | L2-Norm(final)=1.943 | 4306.8 samples/s | 67.3 steps/s
[Step= 150 Epoch= 0.1] | Loss=0.22876 | Reg=0.00338 | acc=0.8281 | L2-Norm=18.384 | L2-Norm(final)=1.952 | 4477.4 samples/s | 70.0 steps/s
[Step= 200 Epoch= 0.2] | Loss=0.20762 | Reg=0.00336 | acc=0.9531 | L2-Norm=18.336 | L2-Norm(final)=1.961 | 4469.8 samples/s | 69.8 steps/s
[Step= 250 Epoch= 0.2] | Loss=0.19475 | Reg=0.00335 | acc=0.9219 | L2-Norm=18.301 | L2-Norm(final)=1.968 | 4384.3 samples/s | 68.5 steps/s
[Step= 300 Epoch= 0.3] | Loss=0.18203 | Reg=0.00334 | acc=0.9219 | L2-Norm=18.274 | L2-Norm(final)=1.976 | 4420.2 samples/s | 69.1 steps/s
[Step= 350 Epoch= 0.3] | Loss=0.17185 | Reg=0.00333 | acc=0.9062 | L2-Norm=18.250 | L2-Norm(final)=1.982 | 4378.5 samples/s | 68.4 steps/s
[Step= 400 Epoch= 0.4] | Loss=0.16433 | Reg=0.00332 | acc=0.8906 | L2-Norm=18.228 | L2-Norm(final)=1.987 | 4441.2 samples/s | 69.4 steps/s
[Step= 450 Epoch= 0.4] | Loss=0.15756 | Reg=0.00332 | acc=0.9219 | L2-Norm=18.209 | L2-Norm(final)=1.993 | 4413.8 samples/s | 69.0 steps/s
[Step= 500 Epoch= 0.5] | Loss=0.15235 | Reg=0.00331 | acc=0.9531 | L2-Norm=18.192 | L2-Norm(final)=1.997 | 4399.7 samples/s | 68.7 steps/s
[Step= 550 Epoch= 0.5] | Loss=0.14699 | Reg=0.00330 | acc=0.9219 | L2-Norm=18.177 | L2-Norm(final)=2.001 | 4382.0 samples/s | 68.5 steps/s
[Step= 600 Epoch= 0.6] | Loss=0.14245 | Reg=0.00330 | acc=0.9062 | L2-Norm=18.165 | L2-Norm(final)=2.005 | 4400.6 samples/s | 68.8 steps/s
[Step= 650 Epoch= 0.6] | Loss=0.13920 | Reg=0.00330 | acc=0.9219 | L2-Norm=18.155 | L2-Norm(final)=2.009 | 4440.4 samples/s | 69.4 steps/s
[Step= 700 Epoch= 0.7] | Loss=0.13516 | Reg=0.00329 | acc=0.9375 | L2-Norm=18.147 | L2-Norm(final)=2.012 | 4476.7 samples/s | 69.9 steps/s
[Step= 750 Epoch= 0.7] | Loss=0.13192 | Reg=0.00329 | acc=0.9219 | L2-Norm=18.139 | L2-Norm(final)=2.015 | 4457.4 samples/s | 69.6 steps/s
[Step= 800 Epoch= 0.8] | Loss=0.12903 | Reg=0.00329 | acc=0.9375 | L2-Norm=18.134 | L2-Norm(final)=2.018 | 4483.6 samples/s | 70.1 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step800.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.41207 | Reg=0.00357 | acc=0.5312 | L2-Norm=18.893 | L2-Norm(final)=1.936 | 4263.9 samples/s | 66.6 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.17651 | Reg=0.00344 | acc=0.9375 | L2-Norm=18.539 | L2-Norm(final)=1.945 | 3765.6 samples/s | 58.8 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.11493 | Reg=0.00338 | acc=0.9844 | L2-Norm=18.383 | L2-Norm(final)=1.954 | 4036.8 samples/s | 63.1 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.08621 | Reg=0.00334 | acc=0.9688 | L2-Norm=18.273 | L2-Norm(final)=1.961 | 4210.5 samples/s | 65.8 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.07066 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.188 | L2-Norm(final)=1.966 | 4173.6 samples/s | 65.2 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.05968 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.117 | L2-Norm(final)=1.970 | 4171.0 samples/s | 65.2 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.05126 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.053 | L2-Norm(final)=1.973 | 4183.2 samples/s | 65.4 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.04518 | Reg=0.00324 | acc=0.9844 | L2-Norm=17.996 | L2-Norm(final)=1.977 | 4082.9 samples/s | 63.8 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.04023 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.944 | L2-Norm(final)=1.980 | 4193.6 samples/s | 65.5 steps/s
[Step= 450 Epoch= 0.8] | Loss=0.03738 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.896 | L2-Norm(final)=1.983 | 4113.6 samples/s | 64.3 steps/s
[Step= 500 Epoch= 0.9] | Loss=0.03435 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.853 | L2-Norm(final)=1.986 | 4193.3 samples/s | 65.5 steps/s
[Step= 550 Epoch= 1.0] | Loss=0.03206 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.813 | L2-Norm(final)=1.989 | 2026.9 samples/s | 31.7 steps/s
[Step= 600 Epoch= 1.1] | Loss=0.02973 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.776 | L2-Norm(final)=1.992 | 4113.6 samples/s | 64.3 steps/s
[Step= 650 Epoch= 1.2] | Loss=0.02759 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.741 | L2-Norm(final)=1.995 | 4243.5 samples/s | 66.3 steps/s
[Step= 700 Epoch= 1.3] | Loss=0.02588 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.705 | L2-Norm(final)=1.998 | 4211.9 samples/s | 65.8 steps/s
[Step= 750 Epoch= 1.4] | Loss=0.02440 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.671 | L2-Norm(final)=2.000 | 4071.6 samples/s | 63.6 steps/s
[Step= 800 Epoch= 1.5] | Loss=0.02305 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.637 | L2-Norm(final)=2.002 | 4186.7 samples/s | 65.4 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step800.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08216 | acc=0.9372 | tpr=0.9418 | fpr=0.0728 | 3899.4 samples/s | 15.2 steps/s
Avg test loss: 0.08286, Avg test acc: 0.93597, Avg tpr: 0.93921, Avg fpr: 0.07114, total FA: 555

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.14974 | acc=0.3171 | tpr=0.0040 | fpr=0.0030 | 4280.2 samples/s | 16.7 steps/s
Avg test loss: 4.16111, Avg test acc: 0.31433, Avg tpr: 0.00373, Avg fpr: 0.00256, total FA: 20

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=1.51968 | acc=0.1502 | tpr=0.8850 | fpr=0.8631 | 3986.8 samples/s | 15.6 steps/s
[Step= 100] | Loss=1.50841 | acc=0.1512 | tpr=0.8827 | fpr=0.8624 | 7294.8 samples/s | 28.5 steps/s
[Step= 150] | Loss=1.50868 | acc=0.1501 | tpr=0.8746 | fpr=0.8633 | 7644.7 samples/s | 29.9 steps/s
[Step= 200] | Loss=1.50787 | acc=0.1509 | tpr=0.8809 | fpr=0.8624 | 7557.9 samples/s | 29.5 steps/s
[Step= 250] | Loss=1.50720 | acc=0.1518 | tpr=0.8725 | fpr=0.8613 | 7811.7 samples/s | 30.5 steps/s
[Step= 300] | Loss=1.50718 | acc=0.1523 | tpr=0.8785 | fpr=0.8610 | 8136.0 samples/s | 31.8 steps/s
[Step= 350] | Loss=1.50703 | acc=0.1519 | tpr=0.8760 | fpr=0.8613 | 7174.8 samples/s | 28.0 steps/s
[Step= 400] | Loss=1.50631 | acc=0.1519 | tpr=0.8714 | fpr=0.8612 | 8231.6 samples/s | 32.2 steps/s
[Step= 450] | Loss=1.50727 | acc=0.1520 | tpr=0.8754 | fpr=0.8611 | 7087.6 samples/s | 27.7 steps/s
[Step= 500] | Loss=1.50865 | acc=0.1515 | tpr=0.8758 | fpr=0.8616 | 7796.4 samples/s | 30.5 steps/s
[Step= 550] | Loss=1.50872 | acc=0.1511 | tpr=0.8735 | fpr=0.8620 | 14399.4 samples/s | 56.2 steps/s
Avg test loss: 1.50938, Avg test acc: 0.15103, Avg tpr: 0.87361, Avg fpr: 0.86210, total FA: 119701

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.07631 | acc=0.9805 | tpr=0.9646 | fpr=0.0192 | 4084.4 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.08047 | acc=0.9796 | tpr=0.9616 | fpr=0.0201 | 7869.6 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.08451 | acc=0.9786 | tpr=0.9669 | fpr=0.0212 | 7704.0 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.08573 | acc=0.9785 | tpr=0.9683 | fpr=0.0213 | 7438.7 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.08386 | acc=0.9787 | tpr=0.9668 | fpr=0.0211 | 7249.4 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.08514 | acc=0.9785 | tpr=0.9651 | fpr=0.0213 | 7367.9 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.08581 | acc=0.9782 | tpr=0.9662 | fpr=0.0216 | 7967.3 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.08643 | acc=0.9780 | tpr=0.9639 | fpr=0.0217 | 7208.9 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.08787 | acc=0.9779 | tpr=0.9645 | fpr=0.0219 | 7570.6 samples/s | 29.6 steps/s
[Step= 500] | Loss=0.08752 | acc=0.9780 | tpr=0.9648 | fpr=0.0218 | 7598.5 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.08701 | acc=0.9781 | tpr=0.9646 | fpr=0.0216 | 14251.6 samples/s | 55.7 steps/s
Avg test loss: 0.08682, Avg test acc: 0.97816, Avg tpr: 0.96474, Avg fpr: 0.02160, total FA: 2999

server round 1/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step= 801 Epoch= 0.8] | Loss=0.09020 | Reg=0.00326 | acc=0.8906 | L2-Norm=18.055 | L2-Norm(final)=2.065 | 4016.3 samples/s | 62.8 steps/s
[Step= 850 Epoch= 0.8] | Loss=0.07049 | Reg=0.00326 | acc=0.9531 | L2-Norm=18.062 | L2-Norm(final)=2.072 | 4064.5 samples/s | 63.5 steps/s
[Step= 900 Epoch= 0.9] | Loss=0.06944 | Reg=0.00326 | acc=0.9688 | L2-Norm=18.064 | L2-Norm(final)=2.077 | 4308.0 samples/s | 67.3 steps/s
[Step= 950 Epoch= 0.9] | Loss=0.07018 | Reg=0.00326 | acc=0.9375 | L2-Norm=18.066 | L2-Norm(final)=2.081 | 4266.3 samples/s | 66.7 steps/s
[Step=1000 Epoch= 1.0] | Loss=0.07017 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.069 | L2-Norm(final)=2.083 | 4307.2 samples/s | 67.3 steps/s
[Step=1050 Epoch= 1.0] | Loss=0.07054 | Reg=0.00327 | acc=0.9062 | L2-Norm=18.073 | L2-Norm(final)=2.085 | 4344.0 samples/s | 67.9 steps/s
[Step=1100 Epoch= 1.1] | Loss=0.06960 | Reg=0.00327 | acc=0.9531 | L2-Norm=18.076 | L2-Norm(final)=2.086 | 4408.6 samples/s | 68.9 steps/s
[Step=1150 Epoch= 1.1] | Loss=0.06803 | Reg=0.00327 | acc=0.9688 | L2-Norm=18.083 | L2-Norm(final)=2.089 | 4399.8 samples/s | 68.7 steps/s
[Step=1200 Epoch= 1.2] | Loss=0.06648 | Reg=0.00327 | acc=0.9844 | L2-Norm=18.089 | L2-Norm(final)=2.092 | 4256.4 samples/s | 66.5 steps/s
[Step=1250 Epoch= 1.2] | Loss=0.06585 | Reg=0.00327 | acc=0.9375 | L2-Norm=18.095 | L2-Norm(final)=2.094 | 4326.4 samples/s | 67.6 steps/s
[Step=1300 Epoch= 1.3] | Loss=0.06505 | Reg=0.00328 | acc=0.9062 | L2-Norm=18.100 | L2-Norm(final)=2.096 | 4461.4 samples/s | 69.7 steps/s
[Step=1350 Epoch= 1.3] | Loss=0.06490 | Reg=0.00328 | acc=0.9375 | L2-Norm=18.105 | L2-Norm(final)=2.097 | 4188.2 samples/s | 65.4 steps/s
[Step=1400 Epoch= 1.4] | Loss=0.06518 | Reg=0.00328 | acc=0.9062 | L2-Norm=18.109 | L2-Norm(final)=2.097 | 4381.5 samples/s | 68.5 steps/s
[Step=1450 Epoch= 1.4] | Loss=0.06485 | Reg=0.00328 | acc=0.9688 | L2-Norm=18.112 | L2-Norm(final)=2.097 | 4448.9 samples/s | 69.5 steps/s
[Step=1500 Epoch= 1.5] | Loss=0.06410 | Reg=0.00328 | acc=0.9219 | L2-Norm=18.116 | L2-Norm(final)=2.099 | 4371.2 samples/s | 68.3 steps/s
[Step=1550 Epoch= 1.5] | Loss=0.06359 | Reg=0.00328 | acc=0.9688 | L2-Norm=18.119 | L2-Norm(final)=2.099 | 4279.5 samples/s | 66.9 steps/s
[Step=1600 Epoch= 1.6] | Loss=0.06324 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.122 | L2-Norm(final)=2.099 | 4327.5 samples/s | 67.6 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step1600.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step= 801 Epoch= 1.5] | Loss=0.00008 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.115 | L2-Norm(final)=2.037 | 3835.7 samples/s | 59.9 steps/s
[Step= 850 Epoch= 1.6] | Loss=0.00157 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.095 | L2-Norm(final)=2.042 | 3932.4 samples/s | 61.4 steps/s
[Step= 900 Epoch= 1.7] | Loss=0.00111 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.067 | L2-Norm(final)=2.045 | 4057.6 samples/s | 63.4 steps/s
[Step= 950 Epoch= 1.8] | Loss=0.00102 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.035 | L2-Norm(final)=2.048 | 4105.5 samples/s | 64.1 steps/s
[Step=1000 Epoch= 1.9] | Loss=0.00119 | Reg=0.00289 | acc=1.0000 | L2-Norm=17.004 | L2-Norm(final)=2.051 | 4151.1 samples/s | 64.9 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.00155 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.975 | L2-Norm(final)=2.053 | 4350.1 samples/s | 68.0 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.00140 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.945 | L2-Norm(final)=2.055 | 4356.4 samples/s | 68.1 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.00138 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.914 | L2-Norm(final)=2.057 | 4207.1 samples/s | 65.7 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.00126 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.882 | L2-Norm(final)=2.059 | 4210.4 samples/s | 65.8 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.00174 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.853 | L2-Norm(final)=2.060 | 4160.7 samples/s | 65.0 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.00191 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.828 | L2-Norm(final)=2.061 | 4426.5 samples/s | 69.2 steps/s
[Step=1350 Epoch= 2.5] | Loss=0.00183 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.806 | L2-Norm(final)=2.061 | 2066.9 samples/s | 32.3 steps/s
[Step=1400 Epoch= 2.6] | Loss=0.00171 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.782 | L2-Norm(final)=2.062 | 4408.5 samples/s | 68.9 steps/s
[Step=1450 Epoch= 2.7] | Loss=0.00159 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.757 | L2-Norm(final)=2.063 | 4238.6 samples/s | 66.2 steps/s
[Step=1500 Epoch= 2.8] | Loss=0.00149 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.730 | L2-Norm(final)=2.065 | 4357.4 samples/s | 68.1 steps/s
[Step=1550 Epoch= 2.9] | Loss=0.00150 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.703 | L2-Norm(final)=2.066 | 4327.1 samples/s | 67.6 steps/s
[Step=1600 Epoch= 3.0] | Loss=0.00145 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.677 | L2-Norm(final)=2.068 | 4360.5 samples/s | 68.1 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step1600.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06260 | acc=0.9530 | tpr=0.9602 | fpr=0.0624 | 4258.6 samples/s | 16.6 steps/s
Avg test loss: 0.06370, Avg test acc: 0.95352, Avg tpr: 0.96013, Avg fpr: 0.06102, total FA: 476

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.48312 | acc=0.3159 | tpr=0.0011 | fpr=0.0007 | 4161.9 samples/s | 16.3 steps/s
Avg test loss: 6.49790, Avg test acc: 0.31301, Avg tpr: 0.00099, Avg fpr: 0.00077, total FA: 6

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=2.44656 | acc=0.1436 | tpr=0.8319 | fpr=0.8688 | 4066.6 samples/s | 15.9 steps/s
[Step= 100] | Loss=2.43201 | acc=0.1426 | tpr=0.7996 | fpr=0.8696 | 7668.0 samples/s | 30.0 steps/s
[Step= 150] | Loss=2.43845 | acc=0.1403 | tpr=0.8040 | fpr=0.8719 | 7596.4 samples/s | 29.7 steps/s
[Step= 200] | Loss=2.43852 | acc=0.1416 | tpr=0.8066 | fpr=0.8705 | 7797.8 samples/s | 30.5 steps/s
[Step= 250] | Loss=2.43714 | acc=0.1424 | tpr=0.7983 | fpr=0.8696 | 7781.3 samples/s | 30.4 steps/s
[Step= 300] | Loss=2.43545 | acc=0.1428 | tpr=0.8029 | fpr=0.8692 | 8440.6 samples/s | 33.0 steps/s
[Step= 350] | Loss=2.43596 | acc=0.1421 | tpr=0.8028 | fpr=0.8699 | 7330.7 samples/s | 28.6 steps/s
[Step= 400] | Loss=2.43539 | acc=0.1422 | tpr=0.8009 | fpr=0.8697 | 7554.0 samples/s | 29.5 steps/s
[Step= 450] | Loss=2.43697 | acc=0.1423 | tpr=0.8028 | fpr=0.8697 | 7413.6 samples/s | 29.0 steps/s
[Step= 500] | Loss=2.43868 | acc=0.1422 | tpr=0.8057 | fpr=0.8698 | 7322.8 samples/s | 28.6 steps/s
[Step= 550] | Loss=2.43992 | acc=0.1420 | tpr=0.8042 | fpr=0.8701 | 13582.4 samples/s | 53.1 steps/s
Avg test loss: 2.44080, Avg test acc: 0.14190, Avg tpr: 0.80468, Avg fpr: 0.87015, total FA: 120818

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08570 | acc=0.9823 | tpr=0.9292 | fpr=0.0168 | 4094.2 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.09120 | acc=0.9817 | tpr=0.9168 | fpr=0.0171 | 7856.7 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.09472 | acc=0.9813 | tpr=0.9265 | fpr=0.0177 | 7835.1 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.09556 | acc=0.9814 | tpr=0.9290 | fpr=0.0177 | 7605.9 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.09378 | acc=0.9817 | tpr=0.9310 | fpr=0.0174 | 7510.6 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.09494 | acc=0.9814 | tpr=0.9280 | fpr=0.0176 | 7575.4 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.09510 | acc=0.9812 | tpr=0.9305 | fpr=0.0178 | 7373.6 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.09609 | acc=0.9812 | tpr=0.9278 | fpr=0.0179 | 7295.8 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.09787 | acc=0.9810 | tpr=0.9299 | fpr=0.0181 | 7362.2 samples/s | 28.8 steps/s
[Step= 500] | Loss=0.09762 | acc=0.9810 | tpr=0.9308 | fpr=0.0181 | 6979.2 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.09689 | acc=0.9812 | tpr=0.9308 | fpr=0.0179 | 12842.4 samples/s | 50.2 steps/s
Avg test loss: 0.09672, Avg test acc: 0.98123, Avg tpr: 0.93067, Avg fpr: 0.01785, total FA: 2479

server round 2/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=1601 Epoch= 1.6] | Loss=0.04865 | Reg=0.00330 | acc=0.9531 | L2-Norm=18.168 | L2-Norm(final)=2.098 | 4271.2 samples/s | 66.7 steps/s
[Step=1650 Epoch= 1.6] | Loss=0.04365 | Reg=0.00330 | acc=0.9688 | L2-Norm=18.179 | L2-Norm(final)=2.109 | 4081.5 samples/s | 63.8 steps/s
[Step=1700 Epoch= 1.7] | Loss=0.04766 | Reg=0.00331 | acc=0.9688 | L2-Norm=18.182 | L2-Norm(final)=2.108 | 4389.1 samples/s | 68.6 steps/s
[Step=1750 Epoch= 1.7] | Loss=0.04924 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.187 | L2-Norm(final)=2.107 | 4436.3 samples/s | 69.3 steps/s
[Step=1800 Epoch= 1.8] | Loss=0.04878 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.198 | L2-Norm(final)=2.110 | 4469.2 samples/s | 69.8 steps/s
[Step=1850 Epoch= 1.8] | Loss=0.04857 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.205 | L2-Norm(final)=2.112 | 4512.0 samples/s | 70.5 steps/s
[Step=1900 Epoch= 1.9] | Loss=0.04872 | Reg=0.00332 | acc=0.9688 | L2-Norm=18.208 | L2-Norm(final)=2.113 | 4589.1 samples/s | 71.7 steps/s
[Step=1950 Epoch= 1.9] | Loss=0.04901 | Reg=0.00332 | acc=0.9375 | L2-Norm=18.209 | L2-Norm(final)=2.113 | 4558.3 samples/s | 71.2 steps/s
[Step=2000 Epoch= 2.0] | Loss=0.04962 | Reg=0.00332 | acc=0.9844 | L2-Norm=18.209 | L2-Norm(final)=2.111 | 4441.8 samples/s | 69.4 steps/s
[Step=2050 Epoch= 2.0] | Loss=0.04921 | Reg=0.00332 | acc=0.9531 | L2-Norm=18.211 | L2-Norm(final)=2.111 | 4505.1 samples/s | 70.4 steps/s
[Step=2100 Epoch= 2.1] | Loss=0.04922 | Reg=0.00332 | acc=0.9375 | L2-Norm=18.214 | L2-Norm(final)=2.111 | 4434.9 samples/s | 69.3 steps/s
[Step=2150 Epoch= 2.1] | Loss=0.04920 | Reg=0.00332 | acc=0.9531 | L2-Norm=18.218 | L2-Norm(final)=2.111 | 4570.7 samples/s | 71.4 steps/s
[Step=2200 Epoch= 2.1] | Loss=0.05000 | Reg=0.00332 | acc=0.9688 | L2-Norm=18.223 | L2-Norm(final)=2.110 | 4626.5 samples/s | 72.3 steps/s
[Step=2250 Epoch= 2.2] | Loss=0.04975 | Reg=0.00332 | acc=0.9844 | L2-Norm=18.227 | L2-Norm(final)=2.108 | 4495.8 samples/s | 70.2 steps/s
[Step=2300 Epoch= 2.2] | Loss=0.05004 | Reg=0.00332 | acc=0.9688 | L2-Norm=18.231 | L2-Norm(final)=2.107 | 4465.9 samples/s | 69.8 steps/s
[Step=2350 Epoch= 2.3] | Loss=0.04982 | Reg=0.00333 | acc=0.9688 | L2-Norm=18.236 | L2-Norm(final)=2.105 | 4457.9 samples/s | 69.7 steps/s
[Step=2400 Epoch= 2.3] | Loss=0.04952 | Reg=0.00333 | acc=0.9688 | L2-Norm=18.240 | L2-Norm(final)=2.104 | 4475.0 samples/s | 69.9 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step2400.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=1601 Epoch= 3.0] | Loss=0.00109 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.253 | L2-Norm(final)=2.093 | 4971.7 samples/s | 77.7 steps/s
[Step=1650 Epoch= 3.1] | Loss=0.00618 | Reg=0.00264 | acc=0.9531 | L2-Norm=16.246 | L2-Norm(final)=2.094 | 3705.6 samples/s | 57.9 steps/s
[Step=1700 Epoch= 3.2] | Loss=0.00826 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.282 | L2-Norm(final)=2.070 | 4319.9 samples/s | 67.5 steps/s
[Step=1750 Epoch= 3.3] | Loss=0.00776 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.308 | L2-Norm(final)=2.057 | 4165.5 samples/s | 65.1 steps/s
[Step=1800 Epoch= 3.4] | Loss=0.00670 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.312 | L2-Norm(final)=2.049 | 4239.8 samples/s | 66.2 steps/s
[Step=1850 Epoch= 3.5] | Loss=0.00545 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.307 | L2-Norm(final)=2.045 | 4282.8 samples/s | 66.9 steps/s
[Step=1900 Epoch= 3.6] | Loss=0.00481 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.297 | L2-Norm(final)=2.044 | 4367.4 samples/s | 68.2 steps/s
[Step=1950 Epoch= 3.7] | Loss=0.00446 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.286 | L2-Norm(final)=2.043 | 4332.6 samples/s | 67.7 steps/s
[Step=2000 Epoch= 3.8] | Loss=0.00413 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.272 | L2-Norm(final)=2.043 | 4312.3 samples/s | 67.4 steps/s
[Step=2050 Epoch= 3.9] | Loss=0.00376 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.257 | L2-Norm(final)=2.043 | 4292.5 samples/s | 67.1 steps/s
[Step=2100 Epoch= 4.0] | Loss=0.00351 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.240 | L2-Norm(final)=2.043 | 4253.5 samples/s | 66.5 steps/s
[Step=2150 Epoch= 4.1] | Loss=0.00342 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.223 | L2-Norm(final)=2.044 | 2153.2 samples/s | 33.6 steps/s
[Step=2200 Epoch= 4.1] | Loss=0.00324 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.206 | L2-Norm(final)=2.044 | 4328.0 samples/s | 67.6 steps/s
[Step=2250 Epoch= 4.2] | Loss=0.00314 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.189 | L2-Norm(final)=2.044 | 4276.6 samples/s | 66.8 steps/s
[Step=2300 Epoch= 4.3] | Loss=0.00296 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.171 | L2-Norm(final)=2.045 | 4254.5 samples/s | 66.5 steps/s
[Step=2350 Epoch= 4.4] | Loss=0.00303 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.155 | L2-Norm(final)=2.045 | 4195.5 samples/s | 65.6 steps/s
[Step=2400 Epoch= 4.5] | Loss=0.00294 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.140 | L2-Norm(final)=2.045 | 4215.5 samples/s | 65.9 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step2400.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06951 | acc=0.9507 | tpr=0.9448 | fpr=0.0364 | 4075.8 samples/s | 15.9 steps/s
Avg test loss: 0.07038, Avg test acc: 0.95112, Avg tpr: 0.94521, Avg fpr: 0.03589, total FA: 280

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.32401 | acc=0.3141 | tpr=0.0096 | fpr=0.0245 | 4151.1 samples/s | 16.2 steps/s
Avg test loss: 5.33493, Avg test acc: 0.31124, Avg tpr: 0.00903, Avg fpr: 0.02410, total FA: 188

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.09265 | acc=0.1393 | tpr=0.8805 | fpr=0.8740 | 4179.2 samples/s | 16.3 steps/s
[Step= 100] | Loss=3.06568 | acc=0.1418 | tpr=0.8443 | fpr=0.8713 | 7477.2 samples/s | 29.2 steps/s
[Step= 150] | Loss=3.07456 | acc=0.1402 | tpr=0.8401 | fpr=0.8727 | 7268.3 samples/s | 28.4 steps/s
[Step= 200] | Loss=3.06960 | acc=0.1412 | tpr=0.8372 | fpr=0.8715 | 7477.1 samples/s | 29.2 steps/s
[Step= 250] | Loss=3.07069 | acc=0.1418 | tpr=0.8297 | fpr=0.8707 | 7107.3 samples/s | 27.8 steps/s
[Step= 300] | Loss=3.07111 | acc=0.1422 | tpr=0.8327 | fpr=0.8704 | 7499.5 samples/s | 29.3 steps/s
[Step= 350] | Loss=3.06918 | acc=0.1417 | tpr=0.8309 | fpr=0.8708 | 7559.0 samples/s | 29.5 steps/s
[Step= 400] | Loss=3.06974 | acc=0.1423 | tpr=0.8277 | fpr=0.8702 | 7897.2 samples/s | 30.8 steps/s
[Step= 450] | Loss=3.07178 | acc=0.1424 | tpr=0.8325 | fpr=0.8702 | 7440.3 samples/s | 29.1 steps/s
[Step= 500] | Loss=3.07433 | acc=0.1422 | tpr=0.8304 | fpr=0.8702 | 7388.7 samples/s | 28.9 steps/s
[Step= 550] | Loss=3.07541 | acc=0.1419 | tpr=0.8265 | fpr=0.8706 | 13760.5 samples/s | 53.8 steps/s
Avg test loss: 3.07611, Avg test acc: 0.14182, Avg tpr: 0.82686, Avg fpr: 0.87064, total FA: 120886

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10958 | acc=0.9793 | tpr=0.9690 | fpr=0.0205 | 3973.4 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.11392 | acc=0.9789 | tpr=0.9787 | fpr=0.0211 | 7107.7 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.11812 | acc=0.9780 | tpr=0.9784 | fpr=0.0220 | 7391.8 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.12054 | acc=0.9778 | tpr=0.9781 | fpr=0.0223 | 7292.5 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.11825 | acc=0.9779 | tpr=0.9755 | fpr=0.0221 | 7473.2 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.12054 | acc=0.9775 | tpr=0.9745 | fpr=0.0225 | 7520.3 samples/s | 29.4 steps/s
[Step= 350] | Loss=0.12221 | acc=0.9771 | tpr=0.9743 | fpr=0.0228 | 7562.0 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.12367 | acc=0.9768 | tpr=0.9726 | fpr=0.0231 | 7680.5 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.12628 | acc=0.9764 | tpr=0.9688 | fpr=0.0235 | 7738.4 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.12634 | acc=0.9763 | tpr=0.9696 | fpr=0.0235 | 7511.6 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.12564 | acc=0.9765 | tpr=0.9682 | fpr=0.0233 | 14278.6 samples/s | 55.8 steps/s
Avg test loss: 0.12552, Avg test acc: 0.97654, Avg tpr: 0.96830, Avg fpr: 0.02331, total FA: 3237

server round 3/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=2401 Epoch= 2.3] | Loss=0.04029 | Reg=0.00336 | acc=0.9688 | L2-Norm=18.317 | L2-Norm(final)=2.092 | 4147.7 samples/s | 64.8 steps/s
[Step=2450 Epoch= 2.4] | Loss=0.04325 | Reg=0.00336 | acc=0.9844 | L2-Norm=18.317 | L2-Norm(final)=2.084 | 3939.2 samples/s | 61.6 steps/s
[Step=2500 Epoch= 2.4] | Loss=0.04096 | Reg=0.00336 | acc=0.9688 | L2-Norm=18.327 | L2-Norm(final)=2.084 | 4301.3 samples/s | 67.2 steps/s
[Step=2550 Epoch= 2.5] | Loss=0.04138 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.335 | L2-Norm(final)=2.083 | 4425.6 samples/s | 69.1 steps/s
[Step=2600 Epoch= 2.5] | Loss=0.04191 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.349 | L2-Norm(final)=2.087 | 4469.4 samples/s | 69.8 steps/s
[Step=2650 Epoch= 2.6] | Loss=0.04053 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.363 | L2-Norm(final)=2.090 | 4559.9 samples/s | 71.2 steps/s
[Step=2700 Epoch= 2.6] | Loss=0.04002 | Reg=0.00338 | acc=0.9844 | L2-Norm=18.374 | L2-Norm(final)=2.092 | 4579.4 samples/s | 71.6 steps/s
[Step=2750 Epoch= 2.7] | Loss=0.04122 | Reg=0.00338 | acc=0.9219 | L2-Norm=18.383 | L2-Norm(final)=2.093 | 4511.9 samples/s | 70.5 steps/s
[Step=2800 Epoch= 2.7] | Loss=0.04112 | Reg=0.00338 | acc=0.9688 | L2-Norm=18.391 | L2-Norm(final)=2.092 | 4526.6 samples/s | 70.7 steps/s
[Step=2850 Epoch= 2.8] | Loss=0.04090 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.400 | L2-Norm(final)=2.093 | 4364.9 samples/s | 68.2 steps/s
[Step=2900 Epoch= 2.8] | Loss=0.04155 | Reg=0.00339 | acc=0.9531 | L2-Norm=18.408 | L2-Norm(final)=2.092 | 4604.8 samples/s | 71.9 steps/s
[Step=2950 Epoch= 2.9] | Loss=0.04188 | Reg=0.00339 | acc=0.9531 | L2-Norm=18.414 | L2-Norm(final)=2.091 | 4561.9 samples/s | 71.3 steps/s
[Step=3000 Epoch= 2.9] | Loss=0.04228 | Reg=0.00339 | acc=0.9375 | L2-Norm=18.420 | L2-Norm(final)=2.090 | 4588.5 samples/s | 71.7 steps/s
[Step=3050 Epoch= 3.0] | Loss=0.04269 | Reg=0.00340 | acc=0.9531 | L2-Norm=18.426 | L2-Norm(final)=2.089 | 4500.9 samples/s | 70.3 steps/s
[Step=3100 Epoch= 3.0] | Loss=0.04251 | Reg=0.00340 | acc=0.9688 | L2-Norm=18.433 | L2-Norm(final)=2.088 | 4565.5 samples/s | 71.3 steps/s
[Step=3150 Epoch= 3.1] | Loss=0.04231 | Reg=0.00340 | acc=0.9219 | L2-Norm=18.440 | L2-Norm(final)=2.087 | 4524.2 samples/s | 70.7 steps/s
[Step=3200 Epoch= 3.1] | Loss=0.04267 | Reg=0.00340 | acc=0.9531 | L2-Norm=18.447 | L2-Norm(final)=2.086 | 4576.8 samples/s | 71.5 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step3200.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=2401 Epoch= 4.5] | Loss=0.00057 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.902 | L2-Norm(final)=2.046 | 4475.3 samples/s | 69.9 steps/s
[Step=2450 Epoch= 4.6] | Loss=0.00081 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.883 | L2-Norm(final)=2.047 | 3872.2 samples/s | 60.5 steps/s
[Step=2500 Epoch= 4.7] | Loss=0.00258 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.862 | L2-Norm(final)=2.047 | 4239.6 samples/s | 66.2 steps/s
[Step=2550 Epoch= 4.8] | Loss=0.00363 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.867 | L2-Norm(final)=2.040 | 4177.3 samples/s | 65.3 steps/s
[Step=2600 Epoch= 4.9] | Loss=0.00315 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.875 | L2-Norm(final)=2.035 | 4291.0 samples/s | 67.0 steps/s
[Step=2650 Epoch= 5.0] | Loss=0.00273 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.874 | L2-Norm(final)=2.034 | 4370.1 samples/s | 68.3 steps/s
[Step=2700 Epoch= 5.1] | Loss=0.00316 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.865 | L2-Norm(final)=2.032 | 4323.8 samples/s | 67.6 steps/s
[Step=2750 Epoch= 5.2] | Loss=0.00351 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.862 | L2-Norm(final)=2.030 | 4271.2 samples/s | 66.7 steps/s
[Step=2800 Epoch= 5.3] | Loss=0.00316 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.860 | L2-Norm(final)=2.028 | 4313.7 samples/s | 67.4 steps/s
[Step=2850 Epoch= 5.4] | Loss=0.00288 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.853 | L2-Norm(final)=2.026 | 4241.4 samples/s | 66.3 steps/s
[Step=2900 Epoch= 5.5] | Loss=0.00277 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.843 | L2-Norm(final)=2.025 | 4387.2 samples/s | 68.6 steps/s
[Step=2950 Epoch= 5.6] | Loss=0.00258 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.829 | L2-Norm(final)=2.025 | 2029.7 samples/s | 31.7 steps/s
[Step=3000 Epoch= 5.7] | Loss=0.00237 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.812 | L2-Norm(final)=2.024 | 4244.2 samples/s | 66.3 steps/s
[Step=3050 Epoch= 5.7] | Loss=0.00219 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.793 | L2-Norm(final)=2.024 | 4284.0 samples/s | 66.9 steps/s
[Step=3100 Epoch= 5.8] | Loss=0.00203 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.772 | L2-Norm(final)=2.024 | 4265.2 samples/s | 66.6 steps/s
[Step=3150 Epoch= 5.9] | Loss=0.00190 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.750 | L2-Norm(final)=2.024 | 4267.7 samples/s | 66.7 steps/s
[Step=3200 Epoch= 6.0] | Loss=0.00179 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.726 | L2-Norm(final)=2.025 | 4249.1 samples/s | 66.4 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step3200.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05698 | acc=0.9605 | tpr=0.9663 | fpr=0.0523 | 4043.4 samples/s | 15.8 steps/s
Avg test loss: 0.05889, Avg test acc: 0.96009, Avg tpr: 0.96614, Avg fpr: 0.05320, total FA: 415

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.05062 | acc=0.3145 | tpr=0.0029 | fpr=0.0087 | 3873.8 samples/s | 15.1 steps/s
Avg test loss: 6.06905, Avg test acc: 0.31172, Avg tpr: 0.00297, Avg fpr: 0.00923, total FA: 72

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.04846 | acc=0.1401 | tpr=0.8673 | fpr=0.8730 | 4116.5 samples/s | 16.1 steps/s
[Step= 100] | Loss=3.01428 | acc=0.1434 | tpr=0.8742 | fpr=0.8703 | 7744.8 samples/s | 30.3 steps/s
[Step= 150] | Loss=3.02314 | acc=0.1425 | tpr=0.8660 | fpr=0.8708 | 7396.5 samples/s | 28.9 steps/s
[Step= 200] | Loss=3.02020 | acc=0.1432 | tpr=0.8601 | fpr=0.8698 | 7205.6 samples/s | 28.1 steps/s
[Step= 250] | Loss=3.02101 | acc=0.1441 | tpr=0.8585 | fpr=0.8690 | 7300.8 samples/s | 28.5 steps/s
[Step= 300] | Loss=3.01947 | acc=0.1441 | tpr=0.8575 | fpr=0.8689 | 7619.9 samples/s | 29.8 steps/s
[Step= 350] | Loss=3.01723 | acc=0.1437 | tpr=0.8585 | fpr=0.8693 | 7295.7 samples/s | 28.5 steps/s
[Step= 400] | Loss=3.01474 | acc=0.1443 | tpr=0.8611 | fpr=0.8687 | 7156.8 samples/s | 28.0 steps/s
[Step= 450] | Loss=3.01780 | acc=0.1444 | tpr=0.8627 | fpr=0.8687 | 7405.8 samples/s | 28.9 steps/s
[Step= 500] | Loss=3.02020 | acc=0.1441 | tpr=0.8634 | fpr=0.8689 | 7590.4 samples/s | 29.7 steps/s
[Step= 550] | Loss=3.02297 | acc=0.1438 | tpr=0.8595 | fpr=0.8692 | 14586.6 samples/s | 57.0 steps/s
Avg test loss: 3.02389, Avg test acc: 0.14378, Avg tpr: 0.86014, Avg fpr: 0.86924, total FA: 120692

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10580 | acc=0.9827 | tpr=0.9690 | fpr=0.0171 | 4234.3 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.11210 | acc=0.9813 | tpr=0.9680 | fpr=0.0185 | 7646.6 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.11649 | acc=0.9803 | tpr=0.9726 | fpr=0.0195 | 7422.1 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.11875 | acc=0.9801 | tpr=0.9694 | fpr=0.0197 | 7924.4 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.11728 | acc=0.9802 | tpr=0.9659 | fpr=0.0195 | 7492.8 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.11940 | acc=0.9797 | tpr=0.9622 | fpr=0.0200 | 7370.6 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.12037 | acc=0.9794 | tpr=0.9624 | fpr=0.0203 | 8203.0 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.12175 | acc=0.9791 | tpr=0.9601 | fpr=0.0205 | 7319.8 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.12456 | acc=0.9787 | tpr=0.9586 | fpr=0.0209 | 7604.8 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.12416 | acc=0.9788 | tpr=0.9590 | fpr=0.0209 | 7467.7 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.12343 | acc=0.9789 | tpr=0.9586 | fpr=0.0207 | 14056.8 samples/s | 54.9 steps/s
Avg test loss: 0.12318, Avg test acc: 0.97894, Avg tpr: 0.95880, Avg fpr: 0.02069, total FA: 2873

server round 4/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=3201 Epoch= 3.1] | Loss=0.04812 | Reg=0.00345 | acc=0.9531 | L2-Norm=18.564 | L2-Norm(final)=2.065 | 4422.6 samples/s | 69.1 steps/s
[Step=3250 Epoch= 3.2] | Loss=0.03841 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.570 | L2-Norm(final)=2.060 | 4261.0 samples/s | 66.6 steps/s
[Step=3300 Epoch= 3.2] | Loss=0.03360 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.577 | L2-Norm(final)=2.068 | 4258.7 samples/s | 66.5 steps/s
[Step=3350 Epoch= 3.3] | Loss=0.03490 | Reg=0.00345 | acc=0.9688 | L2-Norm=18.578 | L2-Norm(final)=2.067 | 4373.7 samples/s | 68.3 steps/s
[Step=3400 Epoch= 3.3] | Loss=0.03490 | Reg=0.00345 | acc=0.9688 | L2-Norm=18.581 | L2-Norm(final)=2.071 | 4410.6 samples/s | 68.9 steps/s
[Step=3450 Epoch= 3.4] | Loss=0.03449 | Reg=0.00345 | acc=0.9844 | L2-Norm=18.585 | L2-Norm(final)=2.073 | 4390.6 samples/s | 68.6 steps/s
[Step=3500 Epoch= 3.4] | Loss=0.03438 | Reg=0.00346 | acc=0.9531 | L2-Norm=18.590 | L2-Norm(final)=2.075 | 4540.0 samples/s | 70.9 steps/s
[Step=3550 Epoch= 3.5] | Loss=0.03504 | Reg=0.00346 | acc=0.9531 | L2-Norm=18.594 | L2-Norm(final)=2.077 | 4456.6 samples/s | 69.6 steps/s
[Step=3600 Epoch= 3.5] | Loss=0.03526 | Reg=0.00346 | acc=0.9375 | L2-Norm=18.600 | L2-Norm(final)=2.077 | 4322.2 samples/s | 67.5 steps/s
[Step=3650 Epoch= 3.6] | Loss=0.03550 | Reg=0.00346 | acc=0.9688 | L2-Norm=18.606 | L2-Norm(final)=2.075 | 4527.4 samples/s | 70.7 steps/s
[Step=3700 Epoch= 3.6] | Loss=0.03685 | Reg=0.00346 | acc=0.9844 | L2-Norm=18.613 | L2-Norm(final)=2.073 | 4457.5 samples/s | 69.6 steps/s
[Step=3750 Epoch= 3.7] | Loss=0.03661 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.620 | L2-Norm(final)=2.072 | 4449.4 samples/s | 69.5 steps/s
[Step=3800 Epoch= 3.7] | Loss=0.03639 | Reg=0.00347 | acc=0.9844 | L2-Norm=18.627 | L2-Norm(final)=2.071 | 4445.4 samples/s | 69.5 steps/s
[Step=3850 Epoch= 3.8] | Loss=0.03623 | Reg=0.00347 | acc=0.9531 | L2-Norm=18.635 | L2-Norm(final)=2.071 | 4371.2 samples/s | 68.3 steps/s
[Step=3900 Epoch= 3.8] | Loss=0.03618 | Reg=0.00348 | acc=0.9844 | L2-Norm=18.642 | L2-Norm(final)=2.070 | 4357.4 samples/s | 68.1 steps/s
[Step=3950 Epoch= 3.9] | Loss=0.03646 | Reg=0.00348 | acc=0.9531 | L2-Norm=18.649 | L2-Norm(final)=2.068 | 4120.5 samples/s | 64.4 steps/s
[Step=4000 Epoch= 3.9] | Loss=0.03667 | Reg=0.00348 | acc=0.9531 | L2-Norm=18.656 | L2-Norm(final)=2.067 | 4185.4 samples/s | 65.4 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step4000.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=3201 Epoch= 6.0] | Loss=0.00006 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.338 | L2-Norm(final)=2.031 | 4413.0 samples/s | 69.0 steps/s
[Step=3250 Epoch= 6.1] | Loss=0.00002 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.306 | L2-Norm(final)=2.032 | 3509.0 samples/s | 54.8 steps/s
[Step=3300 Epoch= 6.2] | Loss=0.00002 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.273 | L2-Norm(final)=2.033 | 4034.2 samples/s | 63.0 steps/s
[Step=3350 Epoch= 6.3] | Loss=0.00003 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.239 | L2-Norm(final)=2.034 | 4204.2 samples/s | 65.7 steps/s
[Step=3400 Epoch= 6.4] | Loss=0.00002 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.206 | L2-Norm(final)=2.035 | 4193.1 samples/s | 65.5 steps/s
[Step=3450 Epoch= 6.5] | Loss=0.00002 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.173 | L2-Norm(final)=2.036 | 4169.7 samples/s | 65.2 steps/s
[Step=3500 Epoch= 6.6] | Loss=0.00002 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.140 | L2-Norm(final)=2.036 | 4327.9 samples/s | 67.6 steps/s
[Step=3550 Epoch= 6.7] | Loss=0.00002 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.106 | L2-Norm(final)=2.037 | 4322.8 samples/s | 67.5 steps/s
[Step=3600 Epoch= 6.8] | Loss=0.00002 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.073 | L2-Norm(final)=2.038 | 4140.4 samples/s | 64.7 steps/s
[Step=3650 Epoch= 6.9] | Loss=0.00002 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.039 | L2-Norm(final)=2.038 | 4194.6 samples/s | 65.5 steps/s
[Step=3700 Epoch= 7.0] | Loss=0.00002 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.005 | L2-Norm(final)=2.039 | 4172.7 samples/s | 65.2 steps/s
[Step=3750 Epoch= 7.1] | Loss=0.00002 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.971 | L2-Norm(final)=2.039 | 2057.8 samples/s | 32.2 steps/s
[Step=3800 Epoch= 7.2] | Loss=0.00002 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.937 | L2-Norm(final)=2.040 | 4318.2 samples/s | 67.5 steps/s
[Step=3850 Epoch= 7.3] | Loss=0.00001 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.903 | L2-Norm(final)=2.040 | 4059.3 samples/s | 63.4 steps/s
[Step=3900 Epoch= 7.4] | Loss=0.00001 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.869 | L2-Norm(final)=2.041 | 4106.6 samples/s | 64.2 steps/s
[Step=3950 Epoch= 7.4] | Loss=0.00001 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.835 | L2-Norm(final)=2.041 | 4018.8 samples/s | 62.8 steps/s
[Step=4000 Epoch= 7.5] | Loss=0.00001 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.800 | L2-Norm(final)=2.042 | 4143.7 samples/s | 64.7 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step4000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05643 | acc=0.9630 | tpr=0.9667 | fpr=0.0451 | 4037.3 samples/s | 15.8 steps/s
Avg test loss: 0.05581, Avg test acc: 0.96230, Avg tpr: 0.96515, Avg fpr: 0.04397, total FA: 343

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.12507 | acc=0.3148 | tpr=0.0041 | fpr=0.0107 | 4054.6 samples/s | 15.8 steps/s
Avg test loss: 6.14315, Avg test acc: 0.31196, Avg tpr: 0.00425, Avg fpr: 0.01128, total FA: 88

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.25103 | acc=0.1342 | tpr=0.8628 | fpr=0.8789 | 4142.8 samples/s | 16.2 steps/s
[Step= 100] | Loss=3.21842 | acc=0.1361 | tpr=0.8635 | fpr=0.8775 | 7640.0 samples/s | 29.8 steps/s
[Step= 150] | Loss=3.22575 | acc=0.1336 | tpr=0.8573 | fpr=0.8797 | 7923.0 samples/s | 30.9 steps/s
[Step= 200] | Loss=3.22074 | acc=0.1344 | tpr=0.8612 | fpr=0.8788 | 7454.4 samples/s | 29.1 steps/s
[Step= 250] | Loss=3.22318 | acc=0.1350 | tpr=0.8550 | fpr=0.8781 | 7770.8 samples/s | 30.4 steps/s
[Step= 300] | Loss=3.22250 | acc=0.1351 | tpr=0.8575 | fpr=0.8781 | 7612.8 samples/s | 29.7 steps/s
[Step= 350] | Loss=3.22062 | acc=0.1348 | tpr=0.8597 | fpr=0.8783 | 7599.1 samples/s | 29.7 steps/s
[Step= 400] | Loss=3.21862 | acc=0.1355 | tpr=0.8600 | fpr=0.8776 | 8097.0 samples/s | 31.6 steps/s
[Step= 450] | Loss=3.22016 | acc=0.1357 | tpr=0.8622 | fpr=0.8774 | 7222.1 samples/s | 28.2 steps/s
[Step= 500] | Loss=3.22282 | acc=0.1357 | tpr=0.8630 | fpr=0.8774 | 7823.0 samples/s | 30.6 steps/s
[Step= 550] | Loss=3.22418 | acc=0.1355 | tpr=0.8623 | fpr=0.8777 | 15066.0 samples/s | 58.9 steps/s
Avg test loss: 3.22498, Avg test acc: 0.13553, Avg tpr: 0.86252, Avg fpr: 0.87769, total FA: 121865

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11573 | acc=0.9823 | tpr=0.9735 | fpr=0.0176 | 4230.8 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.12262 | acc=0.9808 | tpr=0.9787 | fpr=0.0192 | 7593.5 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.12732 | acc=0.9797 | tpr=0.9798 | fpr=0.0203 | 8029.5 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.12970 | acc=0.9795 | tpr=0.9760 | fpr=0.0204 | 8031.7 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.12822 | acc=0.9796 | tpr=0.9729 | fpr=0.0203 | 7443.3 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.13041 | acc=0.9792 | tpr=0.9702 | fpr=0.0207 | 7433.9 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.13150 | acc=0.9788 | tpr=0.9699 | fpr=0.0211 | 7853.8 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.13298 | acc=0.9785 | tpr=0.9683 | fpr=0.0213 | 7466.8 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.13607 | acc=0.9781 | tpr=0.9669 | fpr=0.0217 | 7657.4 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.13568 | acc=0.9782 | tpr=0.9674 | fpr=0.0216 | 7157.0 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.13484 | acc=0.9784 | tpr=0.9662 | fpr=0.0214 | 14458.5 samples/s | 56.5 steps/s
Avg test loss: 0.13460, Avg test acc: 0.97842, Avg tpr: 0.96632, Avg fpr: 0.02136, total FA: 2966

server round 5/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=4001 Epoch= 3.9] | Loss=0.01009 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.763 | L2-Norm(final)=2.039 | 4134.2 samples/s | 64.6 steps/s
[Step=4050 Epoch= 4.0] | Loss=0.02826 | Reg=0.00352 | acc=0.9844 | L2-Norm=18.771 | L2-Norm(final)=2.051 | 4176.6 samples/s | 65.3 steps/s
[Step=4100 Epoch= 4.0] | Loss=0.03002 | Reg=0.00353 | acc=0.9688 | L2-Norm=18.780 | L2-Norm(final)=2.055 | 4469.2 samples/s | 69.8 steps/s
[Step=4150 Epoch= 4.1] | Loss=0.03084 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.792 | L2-Norm(final)=2.059 | 4504.7 samples/s | 70.4 steps/s
[Step=4200 Epoch= 4.1] | Loss=0.03126 | Reg=0.00353 | acc=0.9844 | L2-Norm=18.801 | L2-Norm(final)=2.059 | 4512.2 samples/s | 70.5 steps/s
[Step=4250 Epoch= 4.1] | Loss=0.03147 | Reg=0.00354 | acc=0.9688 | L2-Norm=18.809 | L2-Norm(final)=2.059 | 4374.4 samples/s | 68.3 steps/s
[Step=4300 Epoch= 4.2] | Loss=0.03129 | Reg=0.00354 | acc=0.9688 | L2-Norm=18.818 | L2-Norm(final)=2.061 | 4415.0 samples/s | 69.0 steps/s
[Step=4350 Epoch= 4.2] | Loss=0.03179 | Reg=0.00354 | acc=0.9844 | L2-Norm=18.826 | L2-Norm(final)=2.060 | 4478.4 samples/s | 70.0 steps/s
[Step=4400 Epoch= 4.3] | Loss=0.03234 | Reg=0.00355 | acc=0.9844 | L2-Norm=18.834 | L2-Norm(final)=2.058 | 4423.3 samples/s | 69.1 steps/s
[Step=4450 Epoch= 4.3] | Loss=0.03211 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.842 | L2-Norm(final)=2.056 | 4492.1 samples/s | 70.2 steps/s
[Step=4500 Epoch= 4.4] | Loss=0.03257 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.850 | L2-Norm(final)=2.054 | 4407.8 samples/s | 68.9 steps/s
[Step=4550 Epoch= 4.4] | Loss=0.03283 | Reg=0.00356 | acc=0.9688 | L2-Norm=18.860 | L2-Norm(final)=2.052 | 4445.0 samples/s | 69.5 steps/s
[Step=4600 Epoch= 4.5] | Loss=0.03252 | Reg=0.00356 | acc=0.9844 | L2-Norm=18.871 | L2-Norm(final)=2.052 | 4350.1 samples/s | 68.0 steps/s
[Step=4650 Epoch= 4.5] | Loss=0.03281 | Reg=0.00357 | acc=0.9688 | L2-Norm=18.882 | L2-Norm(final)=2.051 | 4312.7 samples/s | 67.4 steps/s
[Step=4700 Epoch= 4.6] | Loss=0.03327 | Reg=0.00357 | acc=0.9844 | L2-Norm=18.893 | L2-Norm(final)=2.049 | 4359.7 samples/s | 68.1 steps/s
[Step=4750 Epoch= 4.6] | Loss=0.03324 | Reg=0.00357 | acc=1.0000 | L2-Norm=18.903 | L2-Norm(final)=2.048 | 4368.5 samples/s | 68.3 steps/s
[Step=4800 Epoch= 4.7] | Loss=0.03348 | Reg=0.00358 | acc=0.9531 | L2-Norm=18.914 | L2-Norm(final)=2.047 | 4373.0 samples/s | 68.3 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step4800.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=4001 Epoch= 7.5] | Loss=0.00000 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.250 | L2-Norm(final)=2.049 | 4334.5 samples/s | 67.7 steps/s
[Step=4050 Epoch= 7.6] | Loss=0.00000 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.215 | L2-Norm(final)=2.050 | 3793.1 samples/s | 59.3 steps/s
[Step=4100 Epoch= 7.7] | Loss=0.00001 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.180 | L2-Norm(final)=2.050 | 4181.6 samples/s | 65.3 steps/s
[Step=4150 Epoch= 7.8] | Loss=0.00000 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.145 | L2-Norm(final)=2.050 | 4145.8 samples/s | 64.8 steps/s
[Step=4200 Epoch= 7.9] | Loss=0.00001 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.110 | L2-Norm(final)=2.051 | 4246.7 samples/s | 66.4 steps/s
[Step=4250 Epoch= 8.0] | Loss=0.00001 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.075 | L2-Norm(final)=2.051 | 4101.9 samples/s | 64.1 steps/s
[Step=4300 Epoch= 8.1] | Loss=0.00001 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.040 | L2-Norm(final)=2.051 | 4195.3 samples/s | 65.6 steps/s
[Step=4350 Epoch= 8.2] | Loss=0.00001 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.005 | L2-Norm(final)=2.052 | 4165.2 samples/s | 65.1 steps/s
[Step=4400 Epoch= 8.3] | Loss=0.00001 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.970 | L2-Norm(final)=2.053 | 4211.6 samples/s | 65.8 steps/s
[Step=4450 Epoch= 8.4] | Loss=0.00001 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.934 | L2-Norm(final)=2.054 | 4206.1 samples/s | 65.7 steps/s
[Step=4500 Epoch= 8.5] | Loss=0.00001 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.899 | L2-Norm(final)=2.055 | 4177.8 samples/s | 65.3 steps/s
[Step=4550 Epoch= 8.6] | Loss=0.00001 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.864 | L2-Norm(final)=2.057 | 2148.0 samples/s | 33.6 steps/s
[Step=4600 Epoch= 8.7] | Loss=0.00001 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.829 | L2-Norm(final)=2.058 | 4374.8 samples/s | 68.4 steps/s
[Step=4650 Epoch= 8.8] | Loss=0.00001 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.794 | L2-Norm(final)=2.060 | 4268.4 samples/s | 66.7 steps/s
[Step=4700 Epoch= 8.9] | Loss=0.00001 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=2.061 | 4323.9 samples/s | 67.6 steps/s
[Step=4750 Epoch= 9.0] | Loss=0.00001 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.723 | L2-Norm(final)=2.063 | 4173.7 samples/s | 65.2 steps/s
[Step=4800 Epoch= 9.0] | Loss=0.00001 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.687 | L2-Norm(final)=2.065 | 4282.2 samples/s | 66.9 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step4800.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05321 | acc=0.9635 | tpr=0.9709 | fpr=0.0525 | 4101.0 samples/s | 16.0 steps/s
Avg test loss: 0.05380, Avg test acc: 0.96302, Avg tpr: 0.97097, Avg fpr: 0.05448, total FA: 425

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.75529 | acc=0.3152 | tpr=0.0058 | fpr=0.0131 | 4113.6 samples/s | 16.1 steps/s
Avg test loss: 5.77198, Avg test acc: 0.31253, Avg tpr: 0.00595, Avg fpr: 0.01320, total FA: 103

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.13045 | acc=0.1280 | tpr=0.9071 | fpr=0.8860 | 4217.1 samples/s | 16.5 steps/s
[Step= 100] | Loss=3.10067 | acc=0.1301 | tpr=0.9062 | fpr=0.8844 | 7470.4 samples/s | 29.2 steps/s
[Step= 150] | Loss=3.10919 | acc=0.1290 | tpr=0.8934 | fpr=0.8851 | 7832.4 samples/s | 30.6 steps/s
[Step= 200] | Loss=3.10881 | acc=0.1292 | tpr=0.8929 | fpr=0.8847 | 7508.2 samples/s | 29.3 steps/s
[Step= 250] | Loss=3.11352 | acc=0.1301 | tpr=0.8891 | fpr=0.8837 | 7915.5 samples/s | 30.9 steps/s
[Step= 300] | Loss=3.11175 | acc=0.1300 | tpr=0.8895 | fpr=0.8838 | 7799.2 samples/s | 30.5 steps/s
[Step= 350] | Loss=3.11125 | acc=0.1291 | tpr=0.8948 | fpr=0.8848 | 7588.8 samples/s | 29.6 steps/s
[Step= 400] | Loss=3.11203 | acc=0.1291 | tpr=0.8939 | fpr=0.8848 | 8130.8 samples/s | 31.8 steps/s
[Step= 450] | Loss=3.11355 | acc=0.1294 | tpr=0.8958 | fpr=0.8845 | 7267.7 samples/s | 28.4 steps/s
[Step= 500] | Loss=3.11633 | acc=0.1292 | tpr=0.8987 | fpr=0.8847 | 7782.5 samples/s | 30.4 steps/s
[Step= 550] | Loss=3.11692 | acc=0.1289 | tpr=0.8953 | fpr=0.8851 | 13770.0 samples/s | 53.8 steps/s
Avg test loss: 3.11755, Avg test acc: 0.12879, Avg tpr: 0.89580, Avg fpr: 0.88515, total FA: 122902

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12399 | acc=0.9814 | tpr=0.9735 | fpr=0.0185 | 4207.1 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.13157 | acc=0.9800 | tpr=0.9808 | fpr=0.0201 | 7172.7 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.13678 | acc=0.9789 | tpr=0.9813 | fpr=0.0212 | 7601.2 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.13918 | acc=0.9786 | tpr=0.9770 | fpr=0.0214 | 7726.3 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.13758 | acc=0.9787 | tpr=0.9738 | fpr=0.0212 | 7386.5 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.13992 | acc=0.9783 | tpr=0.9709 | fpr=0.0216 | 7915.1 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.14111 | acc=0.9779 | tpr=0.9706 | fpr=0.0220 | 7198.8 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.14265 | acc=0.9777 | tpr=0.9694 | fpr=0.0221 | 7298.4 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.14592 | acc=0.9773 | tpr=0.9679 | fpr=0.0226 | 7900.7 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.14552 | acc=0.9773 | tpr=0.9683 | fpr=0.0225 | 6983.5 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.14458 | acc=0.9775 | tpr=0.9674 | fpr=0.0223 | 13239.1 samples/s | 51.7 steps/s
Avg test loss: 0.14433, Avg test acc: 0.97755, Avg tpr: 0.96751, Avg fpr: 0.02227, total FA: 3092

server round 6/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=4801 Epoch= 4.7] | Loss=0.01670 | Reg=0.00364 | acc=1.0000 | L2-Norm=19.081 | L2-Norm(final)=2.030 | 4478.9 samples/s | 70.0 steps/s
[Step=4850 Epoch= 4.7] | Loss=0.02824 | Reg=0.00365 | acc=1.0000 | L2-Norm=19.102 | L2-Norm(final)=2.033 | 3839.4 samples/s | 60.0 steps/s
[Step=4900 Epoch= 4.8] | Loss=0.02938 | Reg=0.00365 | acc=0.9688 | L2-Norm=19.110 | L2-Norm(final)=2.031 | 4312.3 samples/s | 67.4 steps/s
[Step=4950 Epoch= 4.8] | Loss=0.02982 | Reg=0.00365 | acc=0.9844 | L2-Norm=19.115 | L2-Norm(final)=2.032 | 4327.8 samples/s | 67.6 steps/s
[Step=5000 Epoch= 4.9] | Loss=0.03020 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.122 | L2-Norm(final)=2.033 | 4317.5 samples/s | 67.5 steps/s
[Step=5050 Epoch= 4.9] | Loss=0.03054 | Reg=0.00366 | acc=0.9844 | L2-Norm=19.129 | L2-Norm(final)=2.034 | 4330.9 samples/s | 67.7 steps/s
[Step=5100 Epoch= 5.0] | Loss=0.02993 | Reg=0.00366 | acc=0.9531 | L2-Norm=19.137 | L2-Norm(final)=2.034 | 4355.2 samples/s | 68.1 steps/s
[Step=5150 Epoch= 5.0] | Loss=0.02958 | Reg=0.00367 | acc=0.9531 | L2-Norm=19.145 | L2-Norm(final)=2.035 | 4504.5 samples/s | 70.4 steps/s
[Step=5200 Epoch= 5.1] | Loss=0.02967 | Reg=0.00367 | acc=1.0000 | L2-Norm=19.153 | L2-Norm(final)=2.036 | 4460.8 samples/s | 69.7 steps/s
[Step=5250 Epoch= 5.1] | Loss=0.02999 | Reg=0.00367 | acc=0.9375 | L2-Norm=19.159 | L2-Norm(final)=2.035 | 4585.1 samples/s | 71.6 steps/s
[Step=5300 Epoch= 5.2] | Loss=0.02966 | Reg=0.00367 | acc=0.9688 | L2-Norm=19.165 | L2-Norm(final)=2.036 | 4585.6 samples/s | 71.7 steps/s
[Step=5350 Epoch= 5.2] | Loss=0.02955 | Reg=0.00367 | acc=0.9688 | L2-Norm=19.170 | L2-Norm(final)=2.037 | 4509.3 samples/s | 70.5 steps/s
[Step=5400 Epoch= 5.3] | Loss=0.02986 | Reg=0.00368 | acc=0.9531 | L2-Norm=19.175 | L2-Norm(final)=2.036 | 4474.0 samples/s | 69.9 steps/s
[Step=5450 Epoch= 5.3] | Loss=0.03025 | Reg=0.00368 | acc=0.9688 | L2-Norm=19.181 | L2-Norm(final)=2.035 | 4419.9 samples/s | 69.1 steps/s
[Step=5500 Epoch= 5.4] | Loss=0.03023 | Reg=0.00368 | acc=1.0000 | L2-Norm=19.187 | L2-Norm(final)=2.034 | 4426.0 samples/s | 69.2 steps/s
[Step=5550 Epoch= 5.4] | Loss=0.03047 | Reg=0.00368 | acc=0.9688 | L2-Norm=19.192 | L2-Norm(final)=2.033 | 4589.4 samples/s | 71.7 steps/s
[Step=5600 Epoch= 5.5] | Loss=0.03051 | Reg=0.00369 | acc=1.0000 | L2-Norm=19.199 | L2-Norm(final)=2.032 | 4611.5 samples/s | 72.1 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step5600.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=4801 Epoch= 9.0] | Loss=0.00000 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.119 | L2-Norm(final)=2.099 | 3961.3 samples/s | 61.9 steps/s
[Step=4850 Epoch= 9.1] | Loss=0.00000 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.084 | L2-Norm(final)=2.102 | 4201.6 samples/s | 65.6 steps/s
[Step=4900 Epoch= 9.2] | Loss=0.00000 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.048 | L2-Norm(final)=2.105 | 4265.8 samples/s | 66.7 steps/s
[Step=4950 Epoch= 9.3] | Loss=0.00000 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.012 | L2-Norm(final)=2.107 | 4372.7 samples/s | 68.3 steps/s
[Step=5000 Epoch= 9.4] | Loss=0.00000 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.976 | L2-Norm(final)=2.109 | 4345.7 samples/s | 67.9 steps/s
[Step=5050 Epoch= 9.5] | Loss=0.00000 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.940 | L2-Norm(final)=2.112 | 4334.8 samples/s | 67.7 steps/s
[Step=5100 Epoch= 9.6] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=2.114 | 4295.7 samples/s | 67.1 steps/s
[Step=5150 Epoch= 9.7] | Loss=0.00000 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.869 | L2-Norm(final)=2.116 | 4232.2 samples/s | 66.1 steps/s
[Step=5200 Epoch= 9.8] | Loss=0.00000 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.834 | L2-Norm(final)=2.118 | 4293.9 samples/s | 67.1 steps/s
[Step=5250 Epoch= 9.9] | Loss=0.00000 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.798 | L2-Norm(final)=2.121 | 4259.9 samples/s | 66.6 steps/s
[Step=5300 Epoch=10.0] | Loss=0.00000 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.762 | L2-Norm(final)=2.123 | 4276.1 samples/s | 66.8 steps/s
[Step=5350 Epoch=10.1] | Loss=0.00000 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.726 | L2-Norm(final)=2.126 | 2135.6 samples/s | 33.4 steps/s
[Step=5400 Epoch=10.2] | Loss=0.00000 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.690 | L2-Norm(final)=2.129 | 4384.5 samples/s | 68.5 steps/s
[Step=5450 Epoch=10.3] | Loss=0.00000 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.655 | L2-Norm(final)=2.131 | 4273.8 samples/s | 66.8 steps/s
[Step=5500 Epoch=10.4] | Loss=0.00000 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.619 | L2-Norm(final)=2.134 | 4218.3 samples/s | 65.9 steps/s
[Step=5550 Epoch=10.5] | Loss=0.00000 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.583 | L2-Norm(final)=2.137 | 4195.7 samples/s | 65.6 steps/s
[Step=5600 Epoch=10.6] | Loss=0.00000 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.547 | L2-Norm(final)=2.140 | 4233.7 samples/s | 66.2 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step5600.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05579 | acc=0.9622 | tpr=0.9580 | fpr=0.0287 | 4177.1 samples/s | 16.3 steps/s
Avg test loss: 0.05938, Avg test acc: 0.95981, Avg tpr: 0.95570, Avg fpr: 0.03115, total FA: 243

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.63883 | acc=0.3148 | tpr=0.0041 | fpr=0.0107 | 4195.2 samples/s | 16.4 steps/s
Avg test loss: 5.65580, Avg test acc: 0.31244, Avg tpr: 0.00460, Avg fpr: 0.01051, total FA: 82

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.00192 | acc=0.1582 | tpr=0.8230 | fpr=0.8537 | 4122.6 samples/s | 16.1 steps/s
[Step= 100] | Loss=2.96383 | acc=0.1609 | tpr=0.8316 | fpr=0.8516 | 7548.6 samples/s | 29.5 steps/s
[Step= 150] | Loss=2.97067 | acc=0.1594 | tpr=0.8141 | fpr=0.8527 | 7547.5 samples/s | 29.5 steps/s
[Step= 200] | Loss=2.96781 | acc=0.1602 | tpr=0.8120 | fpr=0.8517 | 7389.8 samples/s | 28.9 steps/s
[Step= 250] | Loss=2.96769 | acc=0.1607 | tpr=0.8026 | fpr=0.8510 | 7386.1 samples/s | 28.9 steps/s
[Step= 300] | Loss=2.96765 | acc=0.1608 | tpr=0.8036 | fpr=0.8509 | 7878.3 samples/s | 30.8 steps/s
[Step= 350] | Loss=2.96428 | acc=0.1607 | tpr=0.8115 | fpr=0.8511 | 7423.2 samples/s | 29.0 steps/s
[Step= 400] | Loss=2.96354 | acc=0.1607 | tpr=0.8129 | fpr=0.8512 | 7275.6 samples/s | 28.4 steps/s
[Step= 450] | Loss=2.96478 | acc=0.1607 | tpr=0.8189 | fpr=0.8512 | 8327.7 samples/s | 32.5 steps/s
[Step= 500] | Loss=2.96858 | acc=0.1608 | tpr=0.8225 | fpr=0.8511 | 6621.8 samples/s | 25.9 steps/s
[Step= 550] | Loss=2.97152 | acc=0.1603 | tpr=0.8201 | fpr=0.8516 | 14100.8 samples/s | 55.1 steps/s
Avg test loss: 2.97249, Avg test acc: 0.16027, Avg tpr: 0.81973, Avg fpr: 0.85172, total FA: 118259

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12111 | acc=0.9819 | tpr=0.9735 | fpr=0.0180 | 4077.2 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.12839 | acc=0.9805 | tpr=0.9787 | fpr=0.0194 | 6913.7 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.13342 | acc=0.9794 | tpr=0.9798 | fpr=0.0206 | 7270.2 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.13571 | acc=0.9792 | tpr=0.9760 | fpr=0.0207 | 7425.5 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.13405 | acc=0.9794 | tpr=0.9729 | fpr=0.0205 | 7301.2 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.13632 | acc=0.9789 | tpr=0.9702 | fpr=0.0209 | 7436.7 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.13743 | acc=0.9786 | tpr=0.9706 | fpr=0.0213 | 7705.3 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.13890 | acc=0.9783 | tpr=0.9694 | fpr=0.0215 | 7471.3 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.14215 | acc=0.9779 | tpr=0.9679 | fpr=0.0219 | 7806.6 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.14178 | acc=0.9780 | tpr=0.9683 | fpr=0.0218 | 7601.5 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.14087 | acc=0.9782 | tpr=0.9674 | fpr=0.0216 | 14434.2 samples/s | 56.4 steps/s
Avg test loss: 0.14062, Avg test acc: 0.97821, Avg tpr: 0.96751, Avg fpr: 0.02160, total FA: 2999

server round 7/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=5601 Epoch= 5.5] | Loss=0.02792 | Reg=0.00373 | acc=0.9688 | L2-Norm=19.306 | L2-Norm(final)=2.005 | 4489.0 samples/s | 70.1 steps/s
[Step=5650 Epoch= 5.5] | Loss=0.02353 | Reg=0.00373 | acc=0.9844 | L2-Norm=19.318 | L2-Norm(final)=2.013 | 4109.8 samples/s | 64.2 steps/s
[Step=5700 Epoch= 5.6] | Loss=0.02632 | Reg=0.00373 | acc=0.9688 | L2-Norm=19.325 | L2-Norm(final)=2.010 | 4403.9 samples/s | 68.8 steps/s
[Step=5750 Epoch= 5.6] | Loss=0.02746 | Reg=0.00374 | acc=1.0000 | L2-Norm=19.332 | L2-Norm(final)=2.008 | 4401.5 samples/s | 68.8 steps/s
[Step=5800 Epoch= 5.7] | Loss=0.02659 | Reg=0.00374 | acc=1.0000 | L2-Norm=19.340 | L2-Norm(final)=2.007 | 4423.9 samples/s | 69.1 steps/s
[Step=5850 Epoch= 5.7] | Loss=0.02754 | Reg=0.00374 | acc=0.9531 | L2-Norm=19.348 | L2-Norm(final)=2.007 | 4416.3 samples/s | 69.0 steps/s
[Step=5900 Epoch= 5.8] | Loss=0.02744 | Reg=0.00375 | acc=0.9688 | L2-Norm=19.360 | L2-Norm(final)=2.009 | 4600.1 samples/s | 71.9 steps/s
[Step=5950 Epoch= 5.8] | Loss=0.02820 | Reg=0.00375 | acc=0.9844 | L2-Norm=19.372 | L2-Norm(final)=2.009 | 4569.5 samples/s | 71.4 steps/s
[Step=6000 Epoch= 5.9] | Loss=0.02810 | Reg=0.00376 | acc=0.9844 | L2-Norm=19.382 | L2-Norm(final)=2.008 | 4551.1 samples/s | 71.1 steps/s
[Step=6050 Epoch= 5.9] | Loss=0.02853 | Reg=0.00376 | acc=0.9688 | L2-Norm=19.390 | L2-Norm(final)=2.007 | 4492.7 samples/s | 70.2 steps/s
[Step=6100 Epoch= 6.0] | Loss=0.02864 | Reg=0.00376 | acc=1.0000 | L2-Norm=19.398 | L2-Norm(final)=2.007 | 4463.2 samples/s | 69.7 steps/s
[Step=6150 Epoch= 6.0] | Loss=0.02843 | Reg=0.00377 | acc=0.9688 | L2-Norm=19.406 | L2-Norm(final)=2.007 | 4431.1 samples/s | 69.2 steps/s
[Step=6200 Epoch= 6.1] | Loss=0.02862 | Reg=0.00377 | acc=0.9688 | L2-Norm=19.413 | L2-Norm(final)=2.007 | 4371.5 samples/s | 68.3 steps/s
[Step=6250 Epoch= 6.1] | Loss=0.02923 | Reg=0.00377 | acc=1.0000 | L2-Norm=19.421 | L2-Norm(final)=2.007 | 4570.9 samples/s | 71.4 steps/s
[Step=6300 Epoch= 6.2] | Loss=0.02901 | Reg=0.00377 | acc=0.9844 | L2-Norm=19.429 | L2-Norm(final)=2.006 | 4526.2 samples/s | 70.7 steps/s
[Step=6350 Epoch= 6.2] | Loss=0.02895 | Reg=0.00378 | acc=0.9844 | L2-Norm=19.437 | L2-Norm(final)=2.005 | 4400.6 samples/s | 68.8 steps/s
[Step=6400 Epoch= 6.2] | Loss=0.02907 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.445 | L2-Norm(final)=2.005 | 4527.7 samples/s | 70.7 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step6400.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=5601 Epoch=10.6] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=2.186 | 3956.5 samples/s | 61.8 steps/s
[Step=5650 Epoch=10.7] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.938 | L2-Norm(final)=2.190 | 4155.4 samples/s | 64.9 steps/s
[Step=5700 Epoch=10.7] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=2.195 | 4301.8 samples/s | 67.2 steps/s
[Step=5750 Epoch=10.8] | Loss=0.00000 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.867 | L2-Norm(final)=2.200 | 4074.7 samples/s | 63.7 steps/s
[Step=5800 Epoch=10.9] | Loss=0.00000 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.831 | L2-Norm(final)=2.205 | 4219.7 samples/s | 65.9 steps/s
[Step=5850 Epoch=11.0] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.795 | L2-Norm(final)=2.210 | 4246.4 samples/s | 66.3 steps/s
[Step=5900 Epoch=11.1] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.760 | L2-Norm(final)=2.215 | 4285.3 samples/s | 67.0 steps/s
[Step=5950 Epoch=11.2] | Loss=0.00000 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.724 | L2-Norm(final)=2.220 | 4241.4 samples/s | 66.3 steps/s
[Step=6000 Epoch=11.3] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.689 | L2-Norm(final)=2.223 | 4235.3 samples/s | 66.2 steps/s
[Step=6050 Epoch=11.4] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=2.227 | 4163.4 samples/s | 65.1 steps/s
[Step=6100 Epoch=11.5] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.619 | L2-Norm(final)=2.230 | 4150.3 samples/s | 64.8 steps/s
[Step=6150 Epoch=11.6] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.584 | L2-Norm(final)=2.233 | 2055.9 samples/s | 32.1 steps/s
[Step=6200 Epoch=11.7] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.549 | L2-Norm(final)=2.237 | 4167.2 samples/s | 65.1 steps/s
[Step=6250 Epoch=11.8] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.514 | L2-Norm(final)=2.240 | 4216.1 samples/s | 65.9 steps/s
[Step=6300 Epoch=11.9] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.478 | L2-Norm(final)=2.243 | 4211.6 samples/s | 65.8 steps/s
[Step=6350 Epoch=12.0] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.443 | L2-Norm(final)=2.247 | 4185.2 samples/s | 65.4 steps/s
[Step=6400 Epoch=12.1] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.409 | L2-Norm(final)=2.250 | 4145.2 samples/s | 64.8 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step6400.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05271 | acc=0.9669 | tpr=0.9692 | fpr=0.0382 | 4130.3 samples/s | 16.1 steps/s
Avg test loss: 0.05589, Avg test acc: 0.96498, Avg tpr: 0.96608, Avg fpr: 0.03743, total FA: 292

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.40255 | acc=0.3148 | tpr=0.0042 | fpr=0.0107 | 3930.1 samples/s | 15.4 steps/s
Avg test loss: 5.41896, Avg test acc: 0.31257, Avg tpr: 0.00466, Avg fpr: 0.01026, total FA: 80

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.28631 | acc=0.1309 | tpr=0.8938 | fpr=0.8829 | 4013.9 samples/s | 15.7 steps/s
[Step= 100] | Loss=4.25613 | acc=0.1321 | tpr=0.8849 | fpr=0.8819 | 7436.5 samples/s | 29.0 steps/s
[Step= 150] | Loss=4.26693 | acc=0.1302 | tpr=0.8617 | fpr=0.8833 | 7385.1 samples/s | 28.8 steps/s
[Step= 200] | Loss=4.26131 | acc=0.1312 | tpr=0.8590 | fpr=0.8820 | 7048.2 samples/s | 27.5 steps/s
[Step= 250] | Loss=4.26007 | acc=0.1314 | tpr=0.8594 | fpr=0.8819 | 7210.0 samples/s | 28.2 steps/s
[Step= 300] | Loss=4.25744 | acc=0.1317 | tpr=0.8589 | fpr=0.8816 | 7875.2 samples/s | 30.8 steps/s
[Step= 350] | Loss=4.25194 | acc=0.1317 | tpr=0.8654 | fpr=0.8816 | 7973.2 samples/s | 31.1 steps/s
[Step= 400] | Loss=4.25211 | acc=0.1318 | tpr=0.8643 | fpr=0.8815 | 7328.0 samples/s | 28.6 steps/s
[Step= 450] | Loss=4.25416 | acc=0.1315 | tpr=0.8651 | fpr=0.8818 | 7993.9 samples/s | 31.2 steps/s
[Step= 500] | Loss=4.25854 | acc=0.1312 | tpr=0.8687 | fpr=0.8821 | 7515.4 samples/s | 29.4 steps/s
[Step= 550] | Loss=4.25993 | acc=0.1312 | tpr=0.8699 | fpr=0.8823 | 13991.9 samples/s | 54.7 steps/s
Avg test loss: 4.26064, Avg test acc: 0.13114, Avg tpr: 0.87044, Avg fpr: 0.88230, total FA: 122506

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12803 | acc=0.9816 | tpr=0.9735 | fpr=0.0183 | 4172.2 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.13590 | acc=0.9801 | tpr=0.9787 | fpr=0.0199 | 7522.6 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.14130 | acc=0.9790 | tpr=0.9798 | fpr=0.0210 | 8172.7 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.14359 | acc=0.9788 | tpr=0.9770 | fpr=0.0212 | 7515.6 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.14174 | acc=0.9790 | tpr=0.9738 | fpr=0.0209 | 7849.2 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.14412 | acc=0.9786 | tpr=0.9724 | fpr=0.0213 | 7705.9 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.14532 | acc=0.9782 | tpr=0.9724 | fpr=0.0217 | 7573.2 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.14679 | acc=0.9781 | tpr=0.9710 | fpr=0.0218 | 8066.5 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.15018 | acc=0.9777 | tpr=0.9693 | fpr=0.0222 | 7473.5 samples/s | 29.2 steps/s
[Step= 500] | Loss=0.14976 | acc=0.9777 | tpr=0.9696 | fpr=0.0222 | 7708.9 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.14879 | acc=0.9779 | tpr=0.9686 | fpr=0.0220 | 14145.4 samples/s | 55.3 steps/s
Avg test loss: 0.14853, Avg test acc: 0.97790, Avg tpr: 0.96870, Avg fpr: 0.02194, total FA: 3046

server round 8/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=6401 Epoch= 6.2] | Loss=0.03052 | Reg=0.00383 | acc=0.9531 | L2-Norm=19.577 | L2-Norm(final)=1.996 | 4394.3 samples/s | 68.7 steps/s
[Step=6450 Epoch= 6.3] | Loss=0.02701 | Reg=0.00384 | acc=0.9844 | L2-Norm=19.592 | L2-Norm(final)=2.004 | 4466.7 samples/s | 69.8 steps/s
[Step=6500 Epoch= 6.3] | Loss=0.02475 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.602 | L2-Norm(final)=2.004 | 4321.9 samples/s | 67.5 steps/s
[Step=6550 Epoch= 6.4] | Loss=0.02638 | Reg=0.00385 | acc=0.9531 | L2-Norm=19.612 | L2-Norm(final)=2.004 | 4270.0 samples/s | 66.7 steps/s
[Step=6600 Epoch= 6.4] | Loss=0.02672 | Reg=0.00385 | acc=0.9688 | L2-Norm=19.621 | L2-Norm(final)=2.003 | 4457.9 samples/s | 69.7 steps/s
[Step=6650 Epoch= 6.5] | Loss=0.02730 | Reg=0.00385 | acc=0.9531 | L2-Norm=19.630 | L2-Norm(final)=2.003 | 4407.3 samples/s | 68.9 steps/s
[Step=6700 Epoch= 6.5] | Loss=0.02647 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.641 | L2-Norm(final)=2.003 | 4463.7 samples/s | 69.7 steps/s
[Step=6750 Epoch= 6.6] | Loss=0.02635 | Reg=0.00386 | acc=0.9688 | L2-Norm=19.651 | L2-Norm(final)=2.003 | 4500.5 samples/s | 70.3 steps/s
[Step=6800 Epoch= 6.6] | Loss=0.02699 | Reg=0.00386 | acc=0.9688 | L2-Norm=19.659 | L2-Norm(final)=2.002 | 4405.4 samples/s | 68.8 steps/s
[Step=6850 Epoch= 6.7] | Loss=0.02713 | Reg=0.00387 | acc=0.9531 | L2-Norm=19.666 | L2-Norm(final)=2.000 | 4426.5 samples/s | 69.2 steps/s
[Step=6900 Epoch= 6.7] | Loss=0.02656 | Reg=0.00387 | acc=0.9844 | L2-Norm=19.673 | L2-Norm(final)=1.999 | 4328.1 samples/s | 67.6 steps/s
[Step=6950 Epoch= 6.8] | Loss=0.02672 | Reg=0.00387 | acc=0.9688 | L2-Norm=19.680 | L2-Norm(final)=1.999 | 4325.4 samples/s | 67.6 steps/s
[Step=7000 Epoch= 6.8] | Loss=0.02701 | Reg=0.00388 | acc=0.9844 | L2-Norm=19.689 | L2-Norm(final)=1.997 | 4294.9 samples/s | 67.1 steps/s
[Step=7050 Epoch= 6.9] | Loss=0.02678 | Reg=0.00388 | acc=0.9688 | L2-Norm=19.699 | L2-Norm(final)=1.996 | 4327.0 samples/s | 67.6 steps/s
[Step=7100 Epoch= 6.9] | Loss=0.02656 | Reg=0.00388 | acc=0.9844 | L2-Norm=19.708 | L2-Norm(final)=1.995 | 4369.4 samples/s | 68.3 steps/s
[Step=7150 Epoch= 7.0] | Loss=0.02676 | Reg=0.00389 | acc=1.0000 | L2-Norm=19.718 | L2-Norm(final)=1.994 | 4421.5 samples/s | 69.1 steps/s
[Step=7200 Epoch= 7.0] | Loss=0.02705 | Reg=0.00389 | acc=0.9688 | L2-Norm=19.727 | L2-Norm(final)=1.992 | 4413.6 samples/s | 69.0 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step7200.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=6401 Epoch=12.1] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.851 | L2-Norm(final)=2.310 | 4394.1 samples/s | 68.7 steps/s
[Step=6450 Epoch=12.2] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.816 | L2-Norm(final)=2.314 | 4045.5 samples/s | 63.2 steps/s
[Step=6500 Epoch=12.3] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.781 | L2-Norm(final)=2.318 | 4289.4 samples/s | 67.0 steps/s
[Step=6550 Epoch=12.3] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.745 | L2-Norm(final)=2.322 | 4240.0 samples/s | 66.2 steps/s
[Step=6600 Epoch=12.4] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.710 | L2-Norm(final)=2.326 | 4193.8 samples/s | 65.5 steps/s
[Step=6650 Epoch=12.5] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.676 | L2-Norm(final)=2.331 | 4138.3 samples/s | 64.7 steps/s
[Step=6700 Epoch=12.6] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.642 | L2-Norm(final)=2.337 | 4321.8 samples/s | 67.5 steps/s
[Step=6750 Epoch=12.7] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.607 | L2-Norm(final)=2.343 | 4145.7 samples/s | 64.8 steps/s
[Step=6800 Epoch=12.8] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.573 | L2-Norm(final)=2.349 | 4217.1 samples/s | 65.9 steps/s
[Step=6850 Epoch=12.9] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.539 | L2-Norm(final)=2.355 | 4196.1 samples/s | 65.6 steps/s
[Step=6900 Epoch=13.0] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.505 | L2-Norm(final)=2.360 | 4242.3 samples/s | 66.3 steps/s
[Step=6950 Epoch=13.1] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=2.366 | 2036.1 samples/s | 31.8 steps/s
[Step=7000 Epoch=13.2] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.436 | L2-Norm(final)=2.372 | 4056.5 samples/s | 63.4 steps/s
[Step=7050 Epoch=13.3] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.402 | L2-Norm(final)=2.378 | 4021.5 samples/s | 62.8 steps/s
[Step=7100 Epoch=13.4] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.368 | L2-Norm(final)=2.384 | 4064.4 samples/s | 63.5 steps/s
[Step=7150 Epoch=13.5] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.334 | L2-Norm(final)=2.389 | 4086.5 samples/s | 63.9 steps/s
[Step=7200 Epoch=13.6] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.300 | L2-Norm(final)=2.395 | 4149.6 samples/s | 64.8 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step7200.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05040 | acc=0.9659 | tpr=0.9687 | fpr=0.0404 | 4058.9 samples/s | 15.9 steps/s
Avg test loss: 0.05313, Avg test acc: 0.96550, Avg tpr: 0.96882, Avg fpr: 0.04179, total FA: 326

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.05762 | acc=0.3152 | tpr=0.0057 | fpr=0.0126 | 4079.8 samples/s | 15.9 steps/s
Avg test loss: 5.07305, Avg test acc: 0.31269, Avg tpr: 0.00612, Avg fpr: 0.01308, total FA: 102

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.86522 | acc=0.1424 | tpr=0.8717 | fpr=0.8707 | 4302.5 samples/s | 16.8 steps/s
[Step= 100] | Loss=3.84136 | acc=0.1458 | tpr=0.8827 | fpr=0.8679 | 7443.8 samples/s | 29.1 steps/s
[Step= 150] | Loss=3.85312 | acc=0.1439 | tpr=0.8761 | fpr=0.8696 | 7700.2 samples/s | 30.1 steps/s
[Step= 200] | Loss=3.85081 | acc=0.1442 | tpr=0.8721 | fpr=0.8690 | 7412.3 samples/s | 29.0 steps/s
[Step= 250] | Loss=3.84715 | acc=0.1447 | tpr=0.8672 | fpr=0.8685 | 8263.9 samples/s | 32.3 steps/s
[Step= 300] | Loss=3.84176 | acc=0.1448 | tpr=0.8727 | fpr=0.8685 | 7339.6 samples/s | 28.7 steps/s
[Step= 350] | Loss=3.83398 | acc=0.1444 | tpr=0.8729 | fpr=0.8688 | 8092.0 samples/s | 31.6 steps/s
[Step= 400] | Loss=3.83493 | acc=0.1443 | tpr=0.8736 | fpr=0.8690 | 7839.0 samples/s | 30.6 steps/s
[Step= 450] | Loss=3.84047 | acc=0.1444 | tpr=0.8739 | fpr=0.8688 | 7154.9 samples/s | 27.9 steps/s
[Step= 500] | Loss=3.84274 | acc=0.1441 | tpr=0.8749 | fpr=0.8691 | 7709.6 samples/s | 30.1 steps/s
[Step= 550] | Loss=3.84377 | acc=0.1438 | tpr=0.8754 | fpr=0.8695 | 14661.3 samples/s | 57.3 steps/s
Avg test loss: 3.84464, Avg test acc: 0.14378, Avg tpr: 0.87599, Avg fpr: 0.86953, total FA: 120732

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13664 | acc=0.9802 | tpr=0.9779 | fpr=0.0198 | 4206.6 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.14512 | acc=0.9788 | tpr=0.9829 | fpr=0.0212 | 7605.0 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.15113 | acc=0.9776 | tpr=0.9827 | fpr=0.0225 | 7758.9 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.15326 | acc=0.9775 | tpr=0.9825 | fpr=0.0226 | 7647.3 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.15131 | acc=0.9776 | tpr=0.9790 | fpr=0.0224 | 7499.0 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.15375 | acc=0.9772 | tpr=0.9782 | fpr=0.0228 | 7250.6 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.15508 | acc=0.9769 | tpr=0.9781 | fpr=0.0232 | 7557.4 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.15658 | acc=0.9766 | tpr=0.9765 | fpr=0.0234 | 7795.7 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.16017 | acc=0.9762 | tpr=0.9742 | fpr=0.0238 | 7400.5 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.15979 | acc=0.9762 | tpr=0.9740 | fpr=0.0237 | 7642.2 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.15864 | acc=0.9765 | tpr=0.9729 | fpr=0.0234 | 13356.4 samples/s | 52.2 steps/s
Avg test loss: 0.15836, Avg test acc: 0.97652, Avg tpr: 0.97306, Avg fpr: 0.02341, total FA: 3251

server round 9/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=7201 Epoch= 7.0] | Loss=0.01204 | Reg=0.00395 | acc=1.0000 | L2-Norm=19.880 | L2-Norm(final)=1.965 | 4146.0 samples/s | 64.8 steps/s
[Step=7250 Epoch= 7.1] | Loss=0.02385 | Reg=0.00396 | acc=1.0000 | L2-Norm=19.889 | L2-Norm(final)=1.967 | 4139.8 samples/s | 64.7 steps/s
[Step=7300 Epoch= 7.1] | Loss=0.02206 | Reg=0.00396 | acc=0.9688 | L2-Norm=19.898 | L2-Norm(final)=1.973 | 4401.3 samples/s | 68.8 steps/s
[Step=7350 Epoch= 7.2] | Loss=0.02135 | Reg=0.00396 | acc=1.0000 | L2-Norm=19.904 | L2-Norm(final)=1.976 | 4442.0 samples/s | 69.4 steps/s
[Step=7400 Epoch= 7.2] | Loss=0.02184 | Reg=0.00396 | acc=1.0000 | L2-Norm=19.909 | L2-Norm(final)=1.979 | 4343.8 samples/s | 67.9 steps/s
[Step=7450 Epoch= 7.3] | Loss=0.02239 | Reg=0.00397 | acc=0.9375 | L2-Norm=19.914 | L2-Norm(final)=1.980 | 4291.3 samples/s | 67.1 steps/s
[Step=7500 Epoch= 7.3] | Loss=0.02273 | Reg=0.00397 | acc=0.9688 | L2-Norm=19.918 | L2-Norm(final)=1.979 | 4369.5 samples/s | 68.3 steps/s
[Step=7550 Epoch= 7.4] | Loss=0.02338 | Reg=0.00397 | acc=0.9688 | L2-Norm=19.923 | L2-Norm(final)=1.978 | 4378.6 samples/s | 68.4 steps/s
[Step=7600 Epoch= 7.4] | Loss=0.02385 | Reg=0.00397 | acc=0.9844 | L2-Norm=19.929 | L2-Norm(final)=1.976 | 4324.6 samples/s | 67.6 steps/s
[Step=7650 Epoch= 7.5] | Loss=0.02386 | Reg=0.00397 | acc=0.9688 | L2-Norm=19.934 | L2-Norm(final)=1.975 | 4368.7 samples/s | 68.3 steps/s
[Step=7700 Epoch= 7.5] | Loss=0.02389 | Reg=0.00398 | acc=0.9688 | L2-Norm=19.940 | L2-Norm(final)=1.975 | 4278.5 samples/s | 66.9 steps/s
[Step=7750 Epoch= 7.6] | Loss=0.02449 | Reg=0.00398 | acc=0.9531 | L2-Norm=19.946 | L2-Norm(final)=1.974 | 4395.3 samples/s | 68.7 steps/s
[Step=7800 Epoch= 7.6] | Loss=0.02487 | Reg=0.00398 | acc=0.9531 | L2-Norm=19.954 | L2-Norm(final)=1.972 | 4422.2 samples/s | 69.1 steps/s
[Step=7850 Epoch= 7.7] | Loss=0.02500 | Reg=0.00399 | acc=1.0000 | L2-Norm=19.963 | L2-Norm(final)=1.970 | 4334.0 samples/s | 67.7 steps/s
[Step=7900 Epoch= 7.7] | Loss=0.02536 | Reg=0.00399 | acc=1.0000 | L2-Norm=19.971 | L2-Norm(final)=1.969 | 4306.2 samples/s | 67.3 steps/s
[Step=7950 Epoch= 7.8] | Loss=0.02536 | Reg=0.00399 | acc=0.9844 | L2-Norm=19.981 | L2-Norm(final)=1.969 | 4290.6 samples/s | 67.0 steps/s
[Step=8000 Epoch= 7.8] | Loss=0.02561 | Reg=0.00400 | acc=0.9688 | L2-Norm=19.992 | L2-Norm(final)=1.968 | 4405.5 samples/s | 68.8 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step8000.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=7201 Epoch=13.6] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.758 | L2-Norm(final)=2.498 | 4163.1 samples/s | 65.0 steps/s
[Step=7250 Epoch=13.7] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.726 | L2-Norm(final)=2.506 | 3865.3 samples/s | 60.4 steps/s
[Step=7300 Epoch=13.8] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.691 | L2-Norm(final)=2.513 | 4143.8 samples/s | 64.7 steps/s
[Step=7350 Epoch=13.9] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.657 | L2-Norm(final)=2.521 | 4049.7 samples/s | 63.3 steps/s
[Step=7400 Epoch=13.9] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.628 | L2-Norm(final)=2.529 | 4199.4 samples/s | 65.6 steps/s
[Step=7450 Epoch=14.0] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.596 | L2-Norm(final)=2.537 | 4055.7 samples/s | 63.4 steps/s
[Step=7500 Epoch=14.1] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.564 | L2-Norm(final)=2.544 | 4065.6 samples/s | 63.5 steps/s
[Step=7550 Epoch=14.2] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.532 | L2-Norm(final)=2.552 | 4172.8 samples/s | 65.2 steps/s
[Step=7600 Epoch=14.3] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.500 | L2-Norm(final)=2.560 | 4184.7 samples/s | 65.4 steps/s
[Step=7650 Epoch=14.4] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.467 | L2-Norm(final)=2.568 | 4380.4 samples/s | 68.4 steps/s
[Step=7700 Epoch=14.5] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.435 | L2-Norm(final)=2.577 | 4370.5 samples/s | 68.3 steps/s
[Step=7750 Epoch=14.6] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.403 | L2-Norm(final)=2.586 | 2034.8 samples/s | 31.8 steps/s
[Step=7800 Epoch=14.7] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.370 | L2-Norm(final)=2.595 | 4336.7 samples/s | 67.8 steps/s
[Step=7850 Epoch=14.8] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.338 | L2-Norm(final)=2.604 | 4297.7 samples/s | 67.2 steps/s
[Step=7900 Epoch=14.9] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.305 | L2-Norm(final)=2.613 | 4266.6 samples/s | 66.7 steps/s
[Step=7950 Epoch=15.0] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.272 | L2-Norm(final)=2.622 | 4356.9 samples/s | 68.1 steps/s
[Step=8000 Epoch=15.1] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.240 | L2-Norm(final)=2.631 | 4291.4 samples/s | 67.1 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step8000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05821 | acc=0.9682 | tpr=0.9765 | fpr=0.0498 | 4289.1 samples/s | 16.8 steps/s
Avg test loss: 0.06185, Avg test acc: 0.96586, Avg tpr: 0.97453, Avg fpr: 0.05320, total FA: 415

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.45467 | acc=0.3150 | tpr=0.0015 | fpr=0.0042 | 4223.6 samples/s | 16.5 steps/s
Avg test loss: 5.47381, Avg test acc: 0.31204, Avg tpr: 0.00128, Avg fpr: 0.00449, total FA: 35

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.04676 | acc=0.1189 | tpr=0.9513 | fpr=0.8961 | 4204.3 samples/s | 16.4 steps/s
[Step= 100] | Loss=5.01947 | acc=0.1202 | tpr=0.9382 | fpr=0.8951 | 7822.8 samples/s | 30.6 steps/s
[Step= 150] | Loss=5.02853 | acc=0.1175 | tpr=0.9265 | fpr=0.8974 | 7734.0 samples/s | 30.2 steps/s
[Step= 200] | Loss=5.02264 | acc=0.1176 | tpr=0.9290 | fpr=0.8971 | 7625.8 samples/s | 29.8 steps/s
[Step= 250] | Loss=5.01823 | acc=0.1185 | tpr=0.9223 | fpr=0.8961 | 7772.7 samples/s | 30.4 steps/s
[Step= 300] | Loss=5.01745 | acc=0.1188 | tpr=0.9222 | fpr=0.8959 | 7594.0 samples/s | 29.7 steps/s
[Step= 350] | Loss=5.01255 | acc=0.1188 | tpr=0.9261 | fpr=0.8959 | 7617.4 samples/s | 29.8 steps/s
[Step= 400] | Loss=5.01182 | acc=0.1186 | tpr=0.9267 | fpr=0.8961 | 7405.2 samples/s | 28.9 steps/s
[Step= 450] | Loss=5.01514 | acc=0.1186 | tpr=0.9289 | fpr=0.8961 | 7222.0 samples/s | 28.2 steps/s
[Step= 500] | Loss=5.01872 | acc=0.1183 | tpr=0.9300 | fpr=0.8964 | 7389.1 samples/s | 28.9 steps/s
[Step= 550] | Loss=5.01921 | acc=0.1183 | tpr=0.9292 | fpr=0.8964 | 13590.5 samples/s | 53.1 steps/s
Avg test loss: 5.01967, Avg test acc: 0.11826, Avg tpr: 0.92908, Avg fpr: 0.89648, total FA: 124475

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13543 | acc=0.9823 | tpr=0.9779 | fpr=0.0177 | 4162.1 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.14415 | acc=0.9805 | tpr=0.9787 | fpr=0.0194 | 7355.7 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.14973 | acc=0.9796 | tpr=0.9798 | fpr=0.0204 | 7828.8 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.15204 | acc=0.9794 | tpr=0.9749 | fpr=0.0206 | 7217.9 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.14973 | acc=0.9796 | tpr=0.9721 | fpr=0.0203 | 7110.3 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.15221 | acc=0.9793 | tpr=0.9716 | fpr=0.0206 | 7188.7 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.15329 | acc=0.9790 | tpr=0.9718 | fpr=0.0208 | 7299.4 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.15455 | acc=0.9789 | tpr=0.9710 | fpr=0.0209 | 7208.0 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.15814 | acc=0.9785 | tpr=0.9693 | fpr=0.0213 | 7148.9 samples/s | 27.9 steps/s
[Step= 500] | Loss=0.15767 | acc=0.9786 | tpr=0.9692 | fpr=0.0212 | 7100.0 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.15653 | acc=0.9788 | tpr=0.9678 | fpr=0.0210 | 13898.7 samples/s | 54.3 steps/s
Avg test loss: 0.15625, Avg test acc: 0.97881, Avg tpr: 0.96791, Avg fpr: 0.02099, total FA: 2914

server round 10/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00050, len=1
[Step=8001 Epoch= 7.8] | Loss=0.02907 | Reg=0.00406 | acc=0.9688 | L2-Norm=20.162 | L2-Norm(final)=1.958 | 4555.8 samples/s | 71.2 steps/s
[Step=8050 Epoch= 7.9] | Loss=0.02139 | Reg=0.00406 | acc=0.9844 | L2-Norm=20.160 | L2-Norm(final)=1.956 | 3876.8 samples/s | 60.6 steps/s
[Step=8100 Epoch= 7.9] | Loss=0.02004 | Reg=0.00406 | acc=0.9844 | L2-Norm=20.159 | L2-Norm(final)=1.956 | 4431.3 samples/s | 69.2 steps/s
[Step=8150 Epoch= 8.0] | Loss=0.01992 | Reg=0.00406 | acc=1.0000 | L2-Norm=20.155 | L2-Norm(final)=1.955 | 4304.7 samples/s | 67.3 steps/s
[Step=8200 Epoch= 8.0] | Loss=0.01926 | Reg=0.00406 | acc=0.9844 | L2-Norm=20.151 | L2-Norm(final)=1.956 | 4560.1 samples/s | 71.3 steps/s
[Step=8250 Epoch= 8.1] | Loss=0.01891 | Reg=0.00406 | acc=0.9688 | L2-Norm=20.146 | L2-Norm(final)=1.956 | 4545.0 samples/s | 71.0 steps/s
[Step=8300 Epoch= 8.1] | Loss=0.01862 | Reg=0.00406 | acc=0.9531 | L2-Norm=20.142 | L2-Norm(final)=1.958 | 4523.9 samples/s | 70.7 steps/s
[Step=8350 Epoch= 8.2] | Loss=0.01836 | Reg=0.00406 | acc=1.0000 | L2-Norm=20.138 | L2-Norm(final)=1.960 | 4428.7 samples/s | 69.2 steps/s
[Step=8400 Epoch= 8.2] | Loss=0.01872 | Reg=0.00405 | acc=0.9688 | L2-Norm=20.134 | L2-Norm(final)=1.961 | 4455.4 samples/s | 69.6 steps/s
[Step=8450 Epoch= 8.3] | Loss=0.01843 | Reg=0.00405 | acc=1.0000 | L2-Norm=20.129 | L2-Norm(final)=1.962 | 4329.3 samples/s | 67.6 steps/s
[Step=8500 Epoch= 8.3] | Loss=0.01829 | Reg=0.00405 | acc=1.0000 | L2-Norm=20.125 | L2-Norm(final)=1.963 | 4570.4 samples/s | 71.4 steps/s
[Step=8550 Epoch= 8.3] | Loss=0.01821 | Reg=0.00405 | acc=0.9688 | L2-Norm=20.120 | L2-Norm(final)=1.965 | 4537.0 samples/s | 70.9 steps/s
[Step=8600 Epoch= 8.4] | Loss=0.01805 | Reg=0.00405 | acc=1.0000 | L2-Norm=20.115 | L2-Norm(final)=1.966 | 4497.8 samples/s | 70.3 steps/s
[Step=8650 Epoch= 8.4] | Loss=0.01766 | Reg=0.00404 | acc=1.0000 | L2-Norm=20.110 | L2-Norm(final)=1.967 | 4449.3 samples/s | 69.5 steps/s
[Step=8700 Epoch= 8.5] | Loss=0.01744 | Reg=0.00404 | acc=0.9688 | L2-Norm=20.105 | L2-Norm(final)=1.969 | 4492.9 samples/s | 70.2 steps/s
[Step=8750 Epoch= 8.5] | Loss=0.01744 | Reg=0.00404 | acc=0.9844 | L2-Norm=20.100 | L2-Norm(final)=1.970 | 4441.2 samples/s | 69.4 steps/s
[Step=8800 Epoch= 8.6] | Loss=0.01742 | Reg=0.00404 | acc=1.0000 | L2-Norm=20.095 | L2-Norm(final)=1.971 | 4506.5 samples/s | 70.4 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step8800.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00050, len=1
[Step=8001 Epoch=15.1] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.736 | L2-Norm(final)=2.787 | 4385.1 samples/s | 68.5 steps/s
[Step=8050 Epoch=15.2] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.718 | L2-Norm(final)=2.792 | 3912.4 samples/s | 61.1 steps/s
[Step=8100 Epoch=15.3] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.699 | L2-Norm(final)=2.795 | 4211.1 samples/s | 65.8 steps/s
[Step=8150 Epoch=15.4] | Loss=0.00345 | Reg=0.00076 | acc=0.9844 | L2-Norm=8.714 | L2-Norm(final)=2.793 | 4177.6 samples/s | 65.3 steps/s
[Step=8200 Epoch=15.5] | Loss=0.00414 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.859 | L2-Norm(final)=2.775 | 4255.1 samples/s | 66.5 steps/s
[Step=8250 Epoch=15.6] | Loss=0.00373 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.971 | L2-Norm(final)=2.766 | 4383.4 samples/s | 68.5 steps/s
[Step=8300 Epoch=15.6] | Loss=0.00342 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.050 | L2-Norm(final)=2.761 | 4346.5 samples/s | 67.9 steps/s
[Step=8350 Epoch=15.7] | Loss=0.00298 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.108 | L2-Norm(final)=2.759 | 4231.0 samples/s | 66.1 steps/s
[Step=8400 Epoch=15.8] | Loss=0.00262 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.151 | L2-Norm(final)=2.758 | 4275.1 samples/s | 66.8 steps/s
[Step=8450 Epoch=15.9] | Loss=0.00235 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.184 | L2-Norm(final)=2.758 | 4290.3 samples/s | 67.0 steps/s
[Step=8500 Epoch=16.0] | Loss=0.00212 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.209 | L2-Norm(final)=2.759 | 4307.3 samples/s | 67.3 steps/s
[Step=8550 Epoch=16.1] | Loss=0.00193 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.228 | L2-Norm(final)=2.760 | 2063.6 samples/s | 32.2 steps/s
[Step=8600 Epoch=16.2] | Loss=0.00177 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.242 | L2-Norm(final)=2.761 | 4266.7 samples/s | 66.7 steps/s
[Step=8650 Epoch=16.3] | Loss=0.00163 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.253 | L2-Norm(final)=2.762 | 4265.4 samples/s | 66.6 steps/s
[Step=8700 Epoch=16.4] | Loss=0.00152 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.261 | L2-Norm(final)=2.763 | 4297.3 samples/s | 67.1 steps/s
[Step=8750 Epoch=16.5] | Loss=0.00142 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.267 | L2-Norm(final)=2.764 | 4325.2 samples/s | 67.6 steps/s
[Step=8800 Epoch=16.6] | Loss=0.00133 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.271 | L2-Norm(final)=2.765 | 4370.7 samples/s | 68.3 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step8800.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05758 | acc=0.9693 | tpr=0.9746 | fpr=0.0421 | 4073.1 samples/s | 15.9 steps/s
Avg test loss: 0.05906, Avg test acc: 0.96951, Avg tpr: 0.97476, Avg fpr: 0.04205, total FA: 328

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.02881 | acc=0.3165 | tpr=0.0033 | fpr=0.0035 | 4158.9 samples/s | 16.2 steps/s
Avg test loss: 5.04978, Avg test acc: 0.31357, Avg tpr: 0.00303, Avg fpr: 0.00346, total FA: 27

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.50461 | acc=0.1256 | tpr=0.9027 | fpr=0.8883 | 4135.3 samples/s | 16.2 steps/s
[Step= 100] | Loss=5.46674 | acc=0.1284 | tpr=0.8913 | fpr=0.8858 | 7386.6 samples/s | 28.9 steps/s
[Step= 150] | Loss=5.47841 | acc=0.1265 | tpr=0.8876 | fpr=0.8876 | 7896.2 samples/s | 30.8 steps/s
[Step= 200] | Loss=5.47356 | acc=0.1267 | tpr=0.8918 | fpr=0.8872 | 7280.6 samples/s | 28.4 steps/s
[Step= 250] | Loss=5.46902 | acc=0.1270 | tpr=0.8865 | fpr=0.8868 | 7804.1 samples/s | 30.5 steps/s
[Step= 300] | Loss=5.46632 | acc=0.1272 | tpr=0.8873 | fpr=0.8867 | 7730.6 samples/s | 30.2 steps/s
[Step= 350] | Loss=5.46002 | acc=0.1271 | tpr=0.8898 | fpr=0.8867 | 7516.7 samples/s | 29.4 steps/s
[Step= 400] | Loss=5.46153 | acc=0.1273 | tpr=0.8895 | fpr=0.8866 | 8026.5 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.46496 | acc=0.1273 | tpr=0.8919 | fpr=0.8866 | 7392.7 samples/s | 28.9 steps/s
[Step= 500] | Loss=5.46884 | acc=0.1268 | tpr=0.8947 | fpr=0.8871 | 7455.8 samples/s | 29.1 steps/s
[Step= 550] | Loss=5.46886 | acc=0.1269 | tpr=0.8949 | fpr=0.8870 | 13396.5 samples/s | 52.3 steps/s
Avg test loss: 5.46952, Avg test acc: 0.12681, Avg tpr: 0.89461, Avg fpr: 0.88714, total FA: 123178

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09678 | acc=0.9814 | tpr=0.9735 | fpr=0.0185 | 3943.6 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.10259 | acc=0.9800 | tpr=0.9723 | fpr=0.0199 | 7496.0 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.10766 | acc=0.9791 | tpr=0.9755 | fpr=0.0209 | 7604.2 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.10869 | acc=0.9789 | tpr=0.9727 | fpr=0.0209 | 7546.2 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.10753 | acc=0.9791 | tpr=0.9721 | fpr=0.0208 | 7296.9 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.10930 | acc=0.9788 | tpr=0.9716 | fpr=0.0211 | 7161.0 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.11085 | acc=0.9784 | tpr=0.9712 | fpr=0.0215 | 7982.6 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.11246 | acc=0.9781 | tpr=0.9705 | fpr=0.0218 | 7824.1 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.11491 | acc=0.9777 | tpr=0.9703 | fpr=0.0221 | 7613.8 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.11462 | acc=0.9778 | tpr=0.9714 | fpr=0.0221 | 7589.7 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.11380 | acc=0.9779 | tpr=0.9694 | fpr=0.0219 | 13649.9 samples/s | 53.3 steps/s
Avg test loss: 0.11364, Avg test acc: 0.97794, Avg tpr: 0.96910, Avg fpr: 0.02190, total FA: 3041

server round 11/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00050, len=1
[Step=8801 Epoch= 8.6] | Loss=0.04308 | Reg=0.00401 | acc=0.9844 | L2-Norm=20.019 | L2-Norm(final)=1.985 | 4376.5 samples/s | 68.4 steps/s
[Step=8850 Epoch= 8.6] | Loss=0.01603 | Reg=0.00400 | acc=0.9844 | L2-Norm=20.012 | L2-Norm(final)=1.981 | 4270.1 samples/s | 66.7 steps/s
[Step=8900 Epoch= 8.7] | Loss=0.01386 | Reg=0.00400 | acc=0.9844 | L2-Norm=20.007 | L2-Norm(final)=1.985 | 4503.8 samples/s | 70.4 steps/s
[Step=8950 Epoch= 8.7] | Loss=0.01311 | Reg=0.00400 | acc=0.9844 | L2-Norm=20.002 | L2-Norm(final)=1.990 | 4462.5 samples/s | 69.7 steps/s
[Step=9000 Epoch= 8.8] | Loss=0.01321 | Reg=0.00400 | acc=1.0000 | L2-Norm=19.997 | L2-Norm(final)=1.993 | 4372.9 samples/s | 68.3 steps/s
[Step=9050 Epoch= 8.8] | Loss=0.01350 | Reg=0.00400 | acc=1.0000 | L2-Norm=19.992 | L2-Norm(final)=1.996 | 4436.9 samples/s | 69.3 steps/s
[Step=9100 Epoch= 8.9] | Loss=0.01396 | Reg=0.00399 | acc=1.0000 | L2-Norm=19.987 | L2-Norm(final)=1.997 | 4541.7 samples/s | 71.0 steps/s
[Step=9150 Epoch= 8.9] | Loss=0.01404 | Reg=0.00399 | acc=0.9531 | L2-Norm=19.983 | L2-Norm(final)=1.999 | 4538.5 samples/s | 70.9 steps/s
[Step=9200 Epoch= 9.0] | Loss=0.01398 | Reg=0.00399 | acc=1.0000 | L2-Norm=19.979 | L2-Norm(final)=2.000 | 4538.6 samples/s | 70.9 steps/s
[Step=9250 Epoch= 9.0] | Loss=0.01396 | Reg=0.00399 | acc=1.0000 | L2-Norm=19.975 | L2-Norm(final)=2.002 | 4460.7 samples/s | 69.7 steps/s
[Step=9300 Epoch= 9.1] | Loss=0.01384 | Reg=0.00399 | acc=1.0000 | L2-Norm=19.972 | L2-Norm(final)=2.004 | 4579.0 samples/s | 71.5 steps/s
[Step=9350 Epoch= 9.1] | Loss=0.01385 | Reg=0.00399 | acc=1.0000 | L2-Norm=19.968 | L2-Norm(final)=2.005 | 4502.9 samples/s | 70.4 steps/s
[Step=9400 Epoch= 9.2] | Loss=0.01397 | Reg=0.00399 | acc=0.9688 | L2-Norm=19.965 | L2-Norm(final)=2.007 | 4508.8 samples/s | 70.4 steps/s
[Step=9450 Epoch= 9.2] | Loss=0.01405 | Reg=0.00398 | acc=0.9844 | L2-Norm=19.961 | L2-Norm(final)=2.008 | 4573.8 samples/s | 71.5 steps/s
[Step=9500 Epoch= 9.3] | Loss=0.01389 | Reg=0.00398 | acc=0.9844 | L2-Norm=19.957 | L2-Norm(final)=2.009 | 4547.1 samples/s | 71.0 steps/s
[Step=9550 Epoch= 9.3] | Loss=0.01400 | Reg=0.00398 | acc=0.9844 | L2-Norm=19.953 | L2-Norm(final)=2.011 | 4458.4 samples/s | 69.7 steps/s
[Step=9600 Epoch= 9.4] | Loss=0.01397 | Reg=0.00398 | acc=0.9844 | L2-Norm=19.949 | L2-Norm(final)=2.012 | 4422.4 samples/s | 69.1 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step9600.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00050, len=1
[Step=8801 Epoch=16.6] | Loss=0.00004 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.330 | L2-Norm(final)=2.783 | 4381.0 samples/s | 68.5 steps/s
[Step=8850 Epoch=16.7] | Loss=0.00003 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.322 | L2-Norm(final)=2.784 | 4139.2 samples/s | 64.7 steps/s
[Step=8900 Epoch=16.8] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.315 | L2-Norm(final)=2.785 | 4350.2 samples/s | 68.0 steps/s
[Step=8950 Epoch=16.9] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.307 | L2-Norm(final)=2.786 | 4278.4 samples/s | 66.8 steps/s
[Step=9000 Epoch=17.0] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=2.787 | 4227.1 samples/s | 66.0 steps/s
[Step=9050 Epoch=17.1] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.291 | L2-Norm(final)=2.788 | 4286.5 samples/s | 67.0 steps/s
[Step=9100 Epoch=17.2] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.283 | L2-Norm(final)=2.789 | 4195.7 samples/s | 65.6 steps/s
[Step=9150 Epoch=17.2] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.275 | L2-Norm(final)=2.790 | 4407.2 samples/s | 68.9 steps/s
[Step=9200 Epoch=17.3] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.268 | L2-Norm(final)=2.791 | 4296.3 samples/s | 67.1 steps/s
[Step=9250 Epoch=17.4] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.260 | L2-Norm(final)=2.792 | 4263.6 samples/s | 66.6 steps/s
[Step=9300 Epoch=17.5] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.252 | L2-Norm(final)=2.793 | 4250.7 samples/s | 66.4 steps/s
[Step=9350 Epoch=17.6] | Loss=0.00002 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.244 | L2-Norm(final)=2.793 | 2083.9 samples/s | 32.6 steps/s
[Step=9400 Epoch=17.7] | Loss=0.00002 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.236 | L2-Norm(final)=2.794 | 4342.6 samples/s | 67.9 steps/s
[Step=9450 Epoch=17.8] | Loss=0.00002 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.228 | L2-Norm(final)=2.795 | 4110.7 samples/s | 64.2 steps/s
[Step=9500 Epoch=17.9] | Loss=0.00002 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.220 | L2-Norm(final)=2.796 | 4280.4 samples/s | 66.9 steps/s
[Step=9550 Epoch=18.0] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.212 | L2-Norm(final)=2.797 | 4140.4 samples/s | 64.7 steps/s
[Step=9600 Epoch=18.1] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.204 | L2-Norm(final)=2.797 | 4176.1 samples/s | 65.3 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step9600.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05737 | acc=0.9711 | tpr=0.9749 | fpr=0.0372 | 3884.6 samples/s | 15.2 steps/s
Avg test loss: 0.05976, Avg test acc: 0.97063, Avg tpr: 0.97435, Avg fpr: 0.03756, total FA: 293

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.38183 | acc=0.3166 | tpr=0.0031 | fpr=0.0027 | 4084.1 samples/s | 16.0 steps/s
Avg test loss: 5.40395, Avg test acc: 0.31357, Avg tpr: 0.00286, Avg fpr: 0.00308, total FA: 24

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.90440 | acc=0.1368 | tpr=0.8850 | fpr=0.8767 | 4155.3 samples/s | 16.2 steps/s
[Step= 100] | Loss=5.86632 | acc=0.1388 | tpr=0.8806 | fpr=0.8751 | 7284.4 samples/s | 28.5 steps/s
[Step= 150] | Loss=5.88207 | acc=0.1367 | tpr=0.8790 | fpr=0.8770 | 7273.1 samples/s | 28.4 steps/s
[Step= 200] | Loss=5.87497 | acc=0.1371 | tpr=0.8809 | fpr=0.8764 | 7352.9 samples/s | 28.7 steps/s
[Step= 250] | Loss=5.87075 | acc=0.1372 | tpr=0.8760 | fpr=0.8762 | 7208.0 samples/s | 28.2 steps/s
[Step= 300] | Loss=5.86734 | acc=0.1371 | tpr=0.8764 | fpr=0.8764 | 7131.6 samples/s | 27.9 steps/s
[Step= 350] | Loss=5.86180 | acc=0.1366 | tpr=0.8785 | fpr=0.8769 | 7530.1 samples/s | 29.4 steps/s
[Step= 400] | Loss=5.86369 | acc=0.1367 | tpr=0.8791 | fpr=0.8768 | 7086.2 samples/s | 27.7 steps/s
[Step= 450] | Loss=5.86854 | acc=0.1368 | tpr=0.8802 | fpr=0.8767 | 7369.3 samples/s | 28.8 steps/s
[Step= 500] | Loss=5.87189 | acc=0.1363 | tpr=0.8828 | fpr=0.8772 | 7804.3 samples/s | 30.5 steps/s
[Step= 550] | Loss=5.87346 | acc=0.1363 | tpr=0.8858 | fpr=0.8774 | 14396.7 samples/s | 56.2 steps/s
Avg test loss: 5.87419, Avg test acc: 0.13617, Avg tpr: 0.88550, Avg fpr: 0.87746, total FA: 121833

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11016 | acc=0.9810 | tpr=0.9735 | fpr=0.0188 | 4200.5 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.11668 | acc=0.9799 | tpr=0.9723 | fpr=0.0200 | 8194.9 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.12257 | acc=0.9787 | tpr=0.9755 | fpr=0.0212 | 7247.4 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.12376 | acc=0.9786 | tpr=0.9727 | fpr=0.0213 | 7580.8 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.12236 | acc=0.9788 | tpr=0.9721 | fpr=0.0211 | 7958.9 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.12438 | acc=0.9784 | tpr=0.9695 | fpr=0.0214 | 8211.0 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.12613 | acc=0.9780 | tpr=0.9687 | fpr=0.0218 | 7452.1 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.12783 | acc=0.9778 | tpr=0.9683 | fpr=0.0220 | 7370.6 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.13061 | acc=0.9774 | tpr=0.9674 | fpr=0.0224 | 7960.2 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.13026 | acc=0.9774 | tpr=0.9683 | fpr=0.0224 | 7447.5 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.12932 | acc=0.9776 | tpr=0.9670 | fpr=0.0222 | 13428.8 samples/s | 52.5 steps/s
Avg test loss: 0.12914, Avg test acc: 0.97762, Avg tpr: 0.96712, Avg fpr: 0.02219, total FA: 3081

server round 12/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00050, len=1
[Step=9601 Epoch= 9.4] | Loss=0.00465 | Reg=0.00395 | acc=1.0000 | L2-Norm=19.884 | L2-Norm(final)=2.032 | 4324.7 samples/s | 67.6 steps/s
[Step=9650 Epoch= 9.4] | Loss=0.01085 | Reg=0.00395 | acc=0.9844 | L2-Norm=19.875 | L2-Norm(final)=2.031 | 4317.0 samples/s | 67.5 steps/s
[Step=9700 Epoch= 9.5] | Loss=0.01140 | Reg=0.00395 | acc=0.9688 | L2-Norm=19.870 | L2-Norm(final)=2.035 | 4427.5 samples/s | 69.2 steps/s
[Step=9750 Epoch= 9.5] | Loss=0.01141 | Reg=0.00395 | acc=0.9844 | L2-Norm=19.865 | L2-Norm(final)=2.037 | 4457.8 samples/s | 69.7 steps/s
[Step=9800 Epoch= 9.6] | Loss=0.01197 | Reg=0.00394 | acc=0.9844 | L2-Norm=19.859 | L2-Norm(final)=2.037 | 4464.4 samples/s | 69.8 steps/s
[Step=9850 Epoch= 9.6] | Loss=0.01285 | Reg=0.00394 | acc=1.0000 | L2-Norm=19.855 | L2-Norm(final)=2.037 | 4517.9 samples/s | 70.6 steps/s
[Step=9900 Epoch= 9.7] | Loss=0.01300 | Reg=0.00394 | acc=1.0000 | L2-Norm=19.850 | L2-Norm(final)=2.037 | 4617.5 samples/s | 72.1 steps/s
[Step=9950 Epoch= 9.7] | Loss=0.01268 | Reg=0.00394 | acc=0.9844 | L2-Norm=19.845 | L2-Norm(final)=2.037 | 4563.3 samples/s | 71.3 steps/s
[Step=10000 Epoch= 9.8] | Loss=0.01277 | Reg=0.00394 | acc=0.9844 | L2-Norm=19.840 | L2-Norm(final)=2.037 | 4533.0 samples/s | 70.8 steps/s
[Step=10050 Epoch= 9.8] | Loss=0.01277 | Reg=0.00393 | acc=0.9688 | L2-Norm=19.835 | L2-Norm(final)=2.038 | 4555.8 samples/s | 71.2 steps/s
[Step=10100 Epoch= 9.9] | Loss=0.01309 | Reg=0.00393 | acc=0.9844 | L2-Norm=19.830 | L2-Norm(final)=2.039 | 4456.1 samples/s | 69.6 steps/s
[Step=10150 Epoch= 9.9] | Loss=0.01293 | Reg=0.00393 | acc=1.0000 | L2-Norm=19.826 | L2-Norm(final)=2.040 | 4483.2 samples/s | 70.1 steps/s
[Step=10200 Epoch=10.0] | Loss=0.01327 | Reg=0.00393 | acc=1.0000 | L2-Norm=19.822 | L2-Norm(final)=2.041 | 4601.1 samples/s | 71.9 steps/s
[Step=10250 Epoch=10.0] | Loss=0.01318 | Reg=0.00393 | acc=0.9688 | L2-Norm=19.818 | L2-Norm(final)=2.042 | 4285.3 samples/s | 67.0 steps/s
[Step=10300 Epoch=10.1] | Loss=0.01362 | Reg=0.00393 | acc=0.9844 | L2-Norm=19.814 | L2-Norm(final)=2.043 | 4377.6 samples/s | 68.4 steps/s
[Step=10350 Epoch=10.1] | Loss=0.01373 | Reg=0.00392 | acc=0.9688 | L2-Norm=19.811 | L2-Norm(final)=2.043 | 4524.9 samples/s | 70.7 steps/s
[Step=10400 Epoch=10.2] | Loss=0.01395 | Reg=0.00392 | acc=0.9844 | L2-Norm=19.808 | L2-Norm(final)=2.043 | 4512.5 samples/s | 70.5 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step10400.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00050, len=1
[Step=9601 Epoch=18.1] | Loss=0.00002 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.070 | L2-Norm(final)=2.808 | 4034.0 samples/s | 63.0 steps/s
[Step=9650 Epoch=18.2] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.062 | L2-Norm(final)=2.809 | 4138.5 samples/s | 64.7 steps/s
[Step=9700 Epoch=18.3] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.053 | L2-Norm(final)=2.809 | 4228.0 samples/s | 66.1 steps/s
[Step=9750 Epoch=18.4] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.044 | L2-Norm(final)=2.810 | 4132.5 samples/s | 64.6 steps/s
[Step=9800 Epoch=18.5] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.035 | L2-Norm(final)=2.811 | 4110.2 samples/s | 64.2 steps/s
[Step=9850 Epoch=18.6] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.027 | L2-Norm(final)=2.811 | 4103.5 samples/s | 64.1 steps/s
[Step=9900 Epoch=18.7] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.018 | L2-Norm(final)=2.813 | 4134.4 samples/s | 64.6 steps/s
[Step=9950 Epoch=18.8] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.009 | L2-Norm(final)=2.814 | 4139.0 samples/s | 64.7 steps/s
[Step=10000 Epoch=18.9] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.000 | L2-Norm(final)=2.815 | 4284.2 samples/s | 66.9 steps/s
[Step=10050 Epoch=18.9] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.990 | L2-Norm(final)=2.816 | 4260.4 samples/s | 66.6 steps/s
[Step=10100 Epoch=19.0] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.981 | L2-Norm(final)=2.817 | 4368.4 samples/s | 68.3 steps/s
[Step=10150 Epoch=19.1] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.972 | L2-Norm(final)=2.818 | 2055.3 samples/s | 32.1 steps/s
[Step=10200 Epoch=19.2] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.963 | L2-Norm(final)=2.819 | 4271.2 samples/s | 66.7 steps/s
[Step=10250 Epoch=19.3] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.953 | L2-Norm(final)=2.820 | 4250.6 samples/s | 66.4 steps/s
[Step=10300 Epoch=19.4] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.944 | L2-Norm(final)=2.820 | 4256.3 samples/s | 66.5 steps/s
[Step=10350 Epoch=19.5] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.935 | L2-Norm(final)=2.821 | 4114.3 samples/s | 64.3 steps/s
[Step=10400 Epoch=19.6] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.925 | L2-Norm(final)=2.822 | 4172.1 samples/s | 65.2 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step10400.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05579 | acc=0.9712 | tpr=0.9749 | fpr=0.0369 | 4067.8 samples/s | 15.9 steps/s
Avg test loss: 0.05895, Avg test acc: 0.97039, Avg tpr: 0.97430, Avg fpr: 0.03820, total FA: 298

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.32820 | acc=0.3165 | tpr=0.0032 | fpr=0.0032 | 3975.0 samples/s | 15.5 steps/s
Avg test loss: 5.34981, Avg test acc: 0.31349, Avg tpr: 0.00286, Avg fpr: 0.00333, total FA: 26

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.18517 | acc=0.1478 | tpr=0.8584 | fpr=0.8650 | 4079.9 samples/s | 15.9 steps/s
[Step= 100] | Loss=5.15265 | acc=0.1507 | tpr=0.8593 | fpr=0.8625 | 7144.9 samples/s | 27.9 steps/s
[Step= 150] | Loss=5.17058 | acc=0.1496 | tpr=0.8602 | fpr=0.8634 | 7203.9 samples/s | 28.1 steps/s
[Step= 200] | Loss=5.16534 | acc=0.1504 | tpr=0.8579 | fpr=0.8624 | 8199.8 samples/s | 32.0 steps/s
[Step= 250] | Loss=5.16219 | acc=0.1513 | tpr=0.8550 | fpr=0.8616 | 7481.3 samples/s | 29.2 steps/s
[Step= 300] | Loss=5.15876 | acc=0.1513 | tpr=0.8567 | fpr=0.8615 | 7420.9 samples/s | 29.0 steps/s
[Step= 350] | Loss=5.15187 | acc=0.1508 | tpr=0.8604 | fpr=0.8620 | 8081.0 samples/s | 31.6 steps/s
[Step= 400] | Loss=5.15278 | acc=0.1508 | tpr=0.8616 | fpr=0.8621 | 7751.6 samples/s | 30.3 steps/s
[Step= 450] | Loss=5.15767 | acc=0.1510 | tpr=0.8666 | fpr=0.8620 | 7543.7 samples/s | 29.5 steps/s
[Step= 500] | Loss=5.16183 | acc=0.1504 | tpr=0.8687 | fpr=0.8626 | 7720.7 samples/s | 30.2 steps/s
[Step= 550] | Loss=5.16036 | acc=0.1504 | tpr=0.8707 | fpr=0.8627 | 13916.4 samples/s | 54.4 steps/s
Avg test loss: 5.16139, Avg test acc: 0.15031, Avg tpr: 0.87044, Avg fpr: 0.86279, total FA: 119796

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11208 | acc=0.9813 | tpr=0.9779 | fpr=0.0186 | 4257.8 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.11860 | acc=0.9798 | tpr=0.9744 | fpr=0.0201 | 7164.3 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.12466 | acc=0.9786 | tpr=0.9769 | fpr=0.0213 | 7798.3 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.12582 | acc=0.9784 | tpr=0.9749 | fpr=0.0215 | 7790.1 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.12439 | acc=0.9786 | tpr=0.9738 | fpr=0.0213 | 7618.7 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.12640 | acc=0.9783 | tpr=0.9724 | fpr=0.0216 | 7810.2 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.12813 | acc=0.9779 | tpr=0.9712 | fpr=0.0220 | 8035.0 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.12980 | acc=0.9777 | tpr=0.9705 | fpr=0.0222 | 7718.7 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.13264 | acc=0.9773 | tpr=0.9693 | fpr=0.0225 | 7515.1 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.13228 | acc=0.9774 | tpr=0.9700 | fpr=0.0225 | 7505.8 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.13132 | acc=0.9775 | tpr=0.9690 | fpr=0.0223 | 13244.3 samples/s | 51.7 steps/s
Avg test loss: 0.13114, Avg test acc: 0.97755, Avg tpr: 0.96910, Avg fpr: 0.02230, total FA: 3096

server round 13/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00050, len=1
[Step=10401 Epoch=10.2] | Loss=0.00092 | Reg=0.00391 | acc=1.0000 | L2-Norm=19.768 | L2-Norm(final)=2.052 | 4028.1 samples/s | 62.9 steps/s
[Step=10450 Epoch=10.2] | Loss=0.01196 | Reg=0.00391 | acc=0.9844 | L2-Norm=19.766 | L2-Norm(final)=2.057 | 4128.4 samples/s | 64.5 steps/s
[Step=10500 Epoch=10.3] | Loss=0.01175 | Reg=0.00391 | acc=1.0000 | L2-Norm=19.764 | L2-Norm(final)=2.058 | 4364.0 samples/s | 68.2 steps/s
[Step=10550 Epoch=10.3] | Loss=0.01333 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.761 | L2-Norm(final)=2.059 | 4365.9 samples/s | 68.2 steps/s
[Step=10600 Epoch=10.3] | Loss=0.01270 | Reg=0.00390 | acc=0.9688 | L2-Norm=19.758 | L2-Norm(final)=2.061 | 4426.8 samples/s | 69.2 steps/s
[Step=10650 Epoch=10.4] | Loss=0.01299 | Reg=0.00390 | acc=0.9688 | L2-Norm=19.757 | L2-Norm(final)=2.062 | 4421.2 samples/s | 69.1 steps/s
[Step=10700 Epoch=10.4] | Loss=0.01338 | Reg=0.00390 | acc=0.9844 | L2-Norm=19.755 | L2-Norm(final)=2.064 | 4452.9 samples/s | 69.6 steps/s
[Step=10750 Epoch=10.5] | Loss=0.01356 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.754 | L2-Norm(final)=2.065 | 4490.5 samples/s | 70.2 steps/s
[Step=10800 Epoch=10.5] | Loss=0.01379 | Reg=0.00390 | acc=0.9688 | L2-Norm=19.754 | L2-Norm(final)=2.066 | 4523.0 samples/s | 70.7 steps/s
[Step=10850 Epoch=10.6] | Loss=0.01418 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.753 | L2-Norm(final)=2.066 | 4507.1 samples/s | 70.4 steps/s
[Step=10900 Epoch=10.6] | Loss=0.01445 | Reg=0.00390 | acc=0.9844 | L2-Norm=19.752 | L2-Norm(final)=2.065 | 4492.4 samples/s | 70.2 steps/s
[Step=10950 Epoch=10.7] | Loss=0.01446 | Reg=0.00390 | acc=0.9844 | L2-Norm=19.751 | L2-Norm(final)=2.065 | 4579.8 samples/s | 71.6 steps/s
[Step=11000 Epoch=10.7] | Loss=0.01430 | Reg=0.00390 | acc=0.9844 | L2-Norm=19.750 | L2-Norm(final)=2.065 | 4357.6 samples/s | 68.1 steps/s
[Step=11050 Epoch=10.8] | Loss=0.01414 | Reg=0.00390 | acc=0.9688 | L2-Norm=19.749 | L2-Norm(final)=2.065 | 4469.8 samples/s | 69.8 steps/s
[Step=11100 Epoch=10.8] | Loss=0.01430 | Reg=0.00390 | acc=0.9844 | L2-Norm=19.747 | L2-Norm(final)=2.065 | 4388.0 samples/s | 68.6 steps/s
[Step=11150 Epoch=10.9] | Loss=0.01451 | Reg=0.00390 | acc=0.9844 | L2-Norm=19.745 | L2-Norm(final)=2.064 | 4328.4 samples/s | 67.6 steps/s
[Step=11200 Epoch=10.9] | Loss=0.01445 | Reg=0.00390 | acc=0.9688 | L2-Norm=19.743 | L2-Norm(final)=2.064 | 4323.3 samples/s | 67.6 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step11200.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00050, len=1
[Step=10401 Epoch=19.6] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.773 | L2-Norm(final)=2.834 | 4224.7 samples/s | 66.0 steps/s
[Step=10450 Epoch=19.7] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.763 | L2-Norm(final)=2.835 | 3851.8 samples/s | 60.2 steps/s
[Step=10500 Epoch=19.8] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.753 | L2-Norm(final)=2.836 | 4190.8 samples/s | 65.5 steps/s
[Step=10550 Epoch=19.9] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.743 | L2-Norm(final)=2.837 | 4135.6 samples/s | 64.6 steps/s
[Step=10600 Epoch=20.0] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.733 | L2-Norm(final)=2.837 | 4120.5 samples/s | 64.4 steps/s
[Step=10650 Epoch=20.1] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.722 | L2-Norm(final)=2.838 | 4138.2 samples/s | 64.7 steps/s
[Step=10700 Epoch=20.2] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.712 | L2-Norm(final)=2.838 | 4154.2 samples/s | 64.9 steps/s
[Step=10750 Epoch=20.3] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.702 | L2-Norm(final)=2.839 | 4131.4 samples/s | 64.6 steps/s
[Step=10800 Epoch=20.4] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.691 | L2-Norm(final)=2.840 | 4171.6 samples/s | 65.2 steps/s
[Step=10850 Epoch=20.5] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.681 | L2-Norm(final)=2.841 | 4159.5 samples/s | 65.0 steps/s
[Step=10900 Epoch=20.5] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.670 | L2-Norm(final)=2.841 | 4189.8 samples/s | 65.5 steps/s
[Step=10950 Epoch=20.6] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.660 | L2-Norm(final)=2.842 | 2105.6 samples/s | 32.9 steps/s
[Step=11000 Epoch=20.7] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.650 | L2-Norm(final)=2.843 | 4140.6 samples/s | 64.7 steps/s
[Step=11050 Epoch=20.8] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.639 | L2-Norm(final)=2.844 | 4096.9 samples/s | 64.0 steps/s
[Step=11100 Epoch=20.9] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.628 | L2-Norm(final)=2.845 | 4068.4 samples/s | 63.6 steps/s
[Step=11150 Epoch=21.0] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.618 | L2-Norm(final)=2.846 | 4176.8 samples/s | 65.3 steps/s
[Step=11200 Epoch=21.1] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.607 | L2-Norm(final)=2.847 | 4259.9 samples/s | 66.6 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step11200.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06438 | acc=0.9699 | tpr=0.9707 | fpr=0.0317 | 4207.0 samples/s | 16.4 steps/s
Avg test loss: 0.06939, Avg test acc: 0.96755, Avg tpr: 0.96853, Avg fpr: 0.03461, total FA: 270

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.25456 | acc=0.3164 | tpr=0.0031 | fpr=0.0032 | 4271.2 samples/s | 16.7 steps/s
Avg test loss: 5.27548, Avg test acc: 0.31341, Avg tpr: 0.00286, Avg fpr: 0.00359, total FA: 28

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.45671 | acc=0.1618 | tpr=0.8319 | fpr=0.8502 | 4277.0 samples/s | 16.7 steps/s
[Step= 100] | Loss=5.41590 | acc=0.1629 | tpr=0.8337 | fpr=0.8496 | 7728.0 samples/s | 30.2 steps/s
[Step= 150] | Loss=5.42798 | acc=0.1616 | tpr=0.8271 | fpr=0.8506 | 7447.4 samples/s | 29.1 steps/s
[Step= 200] | Loss=5.41952 | acc=0.1624 | tpr=0.8284 | fpr=0.8497 | 7736.7 samples/s | 30.2 steps/s
[Step= 250] | Loss=5.41874 | acc=0.1627 | tpr=0.8271 | fpr=0.8494 | 7709.1 samples/s | 30.1 steps/s
[Step= 300] | Loss=5.41576 | acc=0.1630 | tpr=0.8313 | fpr=0.8492 | 7821.3 samples/s | 30.6 steps/s
[Step= 350] | Loss=5.40822 | acc=0.1626 | tpr=0.8341 | fpr=0.8496 | 7516.0 samples/s | 29.4 steps/s
[Step= 400] | Loss=5.40980 | acc=0.1624 | tpr=0.8342 | fpr=0.8498 | 7939.5 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.41556 | acc=0.1623 | tpr=0.8354 | fpr=0.8499 | 7668.1 samples/s | 30.0 steps/s
[Step= 500] | Loss=5.41956 | acc=0.1618 | tpr=0.8383 | fpr=0.8504 | 7700.5 samples/s | 30.1 steps/s
[Step= 550] | Loss=5.41978 | acc=0.1619 | tpr=0.8412 | fpr=0.8504 | 14711.6 samples/s | 57.5 steps/s
Avg test loss: 5.42066, Avg test acc: 0.16180, Avg tpr: 0.84113, Avg fpr: 0.85055, total FA: 118097

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11347 | acc=0.9811 | tpr=0.9779 | fpr=0.0188 | 4089.7 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.12004 | acc=0.9796 | tpr=0.9744 | fpr=0.0203 | 7959.6 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.12618 | acc=0.9785 | tpr=0.9769 | fpr=0.0215 | 7221.7 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.12731 | acc=0.9783 | tpr=0.9749 | fpr=0.0216 | 7805.1 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.12587 | acc=0.9785 | tpr=0.9738 | fpr=0.0214 | 7140.7 samples/s | 27.9 steps/s
[Step= 300] | Loss=0.12786 | acc=0.9782 | tpr=0.9724 | fpr=0.0217 | 7416.7 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.12952 | acc=0.9779 | tpr=0.9718 | fpr=0.0220 | 7779.7 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.13112 | acc=0.9777 | tpr=0.9710 | fpr=0.0221 | 7870.6 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.13401 | acc=0.9774 | tpr=0.9703 | fpr=0.0225 | 7720.4 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.13365 | acc=0.9774 | tpr=0.9709 | fpr=0.0225 | 7013.1 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.13265 | acc=0.9776 | tpr=0.9698 | fpr=0.0223 | 13252.8 samples/s | 51.8 steps/s
Avg test loss: 0.13248, Avg test acc: 0.97760, Avg tpr: 0.96989, Avg fpr: 0.02226, total FA: 3091

server round 14/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00050, len=1
[Step=11201 Epoch=10.9] | Loss=0.01200 | Reg=0.00388 | acc=0.9844 | L2-Norm=19.709 | L2-Norm(final)=2.064 | 5258.7 samples/s | 82.2 steps/s
[Step=11250 Epoch=11.0] | Loss=0.01090 | Reg=0.00388 | acc=1.0000 | L2-Norm=19.708 | L2-Norm(final)=2.064 | 3571.3 samples/s | 55.8 steps/s
[Step=11300 Epoch=11.0] | Loss=0.01206 | Reg=0.00388 | acc=0.9688 | L2-Norm=19.704 | L2-Norm(final)=2.067 | 4289.2 samples/s | 67.0 steps/s
[Step=11350 Epoch=11.1] | Loss=0.01154 | Reg=0.00388 | acc=1.0000 | L2-Norm=19.702 | L2-Norm(final)=2.068 | 4270.6 samples/s | 66.7 steps/s
[Step=11400 Epoch=11.1] | Loss=0.01252 | Reg=0.00388 | acc=0.9844 | L2-Norm=19.701 | L2-Norm(final)=2.069 | 4290.8 samples/s | 67.0 steps/s
[Step=11450 Epoch=11.2] | Loss=0.01318 | Reg=0.00388 | acc=0.9688 | L2-Norm=19.700 | L2-Norm(final)=2.069 | 4280.1 samples/s | 66.9 steps/s
[Step=11500 Epoch=11.2] | Loss=0.01378 | Reg=0.00388 | acc=0.9844 | L2-Norm=19.701 | L2-Norm(final)=2.068 | 4301.5 samples/s | 67.2 steps/s
[Step=11550 Epoch=11.3] | Loss=0.01373 | Reg=0.00388 | acc=0.9688 | L2-Norm=19.700 | L2-Norm(final)=2.067 | 4392.0 samples/s | 68.6 steps/s
[Step=11600 Epoch=11.3] | Loss=0.01359 | Reg=0.00388 | acc=0.9844 | L2-Norm=19.700 | L2-Norm(final)=2.067 | 4250.7 samples/s | 66.4 steps/s
[Step=11650 Epoch=11.4] | Loss=0.01363 | Reg=0.00388 | acc=0.9844 | L2-Norm=19.699 | L2-Norm(final)=2.067 | 4279.4 samples/s | 66.9 steps/s
[Step=11700 Epoch=11.4] | Loss=0.01390 | Reg=0.00388 | acc=0.9844 | L2-Norm=19.698 | L2-Norm(final)=2.067 | 4275.0 samples/s | 66.8 steps/s
[Step=11750 Epoch=11.5] | Loss=0.01375 | Reg=0.00388 | acc=1.0000 | L2-Norm=19.697 | L2-Norm(final)=2.068 | 4359.7 samples/s | 68.1 steps/s
[Step=11800 Epoch=11.5] | Loss=0.01352 | Reg=0.00388 | acc=0.9844 | L2-Norm=19.696 | L2-Norm(final)=2.069 | 4360.0 samples/s | 68.1 steps/s
[Step=11850 Epoch=11.6] | Loss=0.01319 | Reg=0.00388 | acc=0.9844 | L2-Norm=19.694 | L2-Norm(final)=2.071 | 4387.8 samples/s | 68.6 steps/s
[Step=11900 Epoch=11.6] | Loss=0.01351 | Reg=0.00388 | acc=0.9844 | L2-Norm=19.693 | L2-Norm(final)=2.072 | 4389.1 samples/s | 68.6 steps/s
[Step=11950 Epoch=11.7] | Loss=0.01363 | Reg=0.00388 | acc=0.9844 | L2-Norm=19.692 | L2-Norm(final)=2.073 | 4350.8 samples/s | 68.0 steps/s
[Step=12000 Epoch=11.7] | Loss=0.01366 | Reg=0.00388 | acc=0.9844 | L2-Norm=19.692 | L2-Norm(final)=2.074 | 4358.6 samples/s | 68.1 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step12000.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00050, len=1
[Step=11201 Epoch=21.1] | Loss=0.00001 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.434 | L2-Norm(final)=2.861 | 4257.0 samples/s | 66.5 steps/s
[Step=11250 Epoch=21.2] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.422 | L2-Norm(final)=2.862 | 4103.5 samples/s | 64.1 steps/s
[Step=11300 Epoch=21.3] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.411 | L2-Norm(final)=2.863 | 4370.9 samples/s | 68.3 steps/s
[Step=11350 Epoch=21.4] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.399 | L2-Norm(final)=2.864 | 4290.4 samples/s | 67.0 steps/s
[Step=11400 Epoch=21.5] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.387 | L2-Norm(final)=2.865 | 4174.9 samples/s | 65.2 steps/s
[Step=11450 Epoch=21.6] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.376 | L2-Norm(final)=2.866 | 4372.8 samples/s | 68.3 steps/s
[Step=11500 Epoch=21.7] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.364 | L2-Norm(final)=2.867 | 4330.7 samples/s | 67.7 steps/s
[Step=11550 Epoch=21.8] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.352 | L2-Norm(final)=2.868 | 4348.8 samples/s | 67.9 steps/s
[Step=11600 Epoch=21.9] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.340 | L2-Norm(final)=2.869 | 4302.5 samples/s | 67.2 steps/s
[Step=11650 Epoch=22.0] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.328 | L2-Norm(final)=2.871 | 4210.8 samples/s | 65.8 steps/s
[Step=11700 Epoch=22.1] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.316 | L2-Norm(final)=2.872 | 4351.4 samples/s | 68.0 steps/s
[Step=11750 Epoch=22.1] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.304 | L2-Norm(final)=2.873 | 2125.8 samples/s | 33.2 steps/s
[Step=11800 Epoch=22.2] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.292 | L2-Norm(final)=2.874 | 4401.9 samples/s | 68.8 steps/s
[Step=11850 Epoch=22.3] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.280 | L2-Norm(final)=2.875 | 4299.6 samples/s | 67.2 steps/s
[Step=11900 Epoch=22.4] | Loss=0.00000 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.267 | L2-Norm(final)=2.877 | 4203.4 samples/s | 65.7 steps/s
[Step=11950 Epoch=22.5] | Loss=0.00000 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.255 | L2-Norm(final)=2.878 | 4301.9 samples/s | 67.2 steps/s
[Step=12000 Epoch=22.6] | Loss=0.00000 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.242 | L2-Norm(final)=2.879 | 4226.0 samples/s | 66.0 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step12000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05453 | acc=0.9719 | tpr=0.9765 | fpr=0.0382 | 4168.6 samples/s | 16.3 steps/s
Avg test loss: 0.05738, Avg test acc: 0.97099, Avg tpr: 0.97546, Avg fpr: 0.03884, total FA: 303

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.11354 | acc=0.3161 | tpr=0.0030 | fpr=0.0040 | 4277.8 samples/s | 16.7 steps/s
Avg test loss: 5.13362, Avg test acc: 0.31337, Avg tpr: 0.00291, Avg fpr: 0.00385, total FA: 30

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.70206 | acc=0.1372 | tpr=0.9027 | fpr=0.8766 | 4241.2 samples/s | 16.6 steps/s
[Step= 100] | Loss=5.65773 | acc=0.1397 | tpr=0.8891 | fpr=0.8743 | 7583.4 samples/s | 29.6 steps/s
[Step= 150] | Loss=5.67185 | acc=0.1384 | tpr=0.8847 | fpr=0.8754 | 7975.8 samples/s | 31.2 steps/s
[Step= 200] | Loss=5.66754 | acc=0.1389 | tpr=0.8852 | fpr=0.8747 | 7672.1 samples/s | 30.0 steps/s
[Step= 250] | Loss=5.66310 | acc=0.1390 | tpr=0.8830 | fpr=0.8746 | 7441.2 samples/s | 29.1 steps/s
[Step= 300] | Loss=5.65971 | acc=0.1393 | tpr=0.8858 | fpr=0.8743 | 7822.3 samples/s | 30.6 steps/s
[Step= 350] | Loss=5.65429 | acc=0.1393 | tpr=0.8904 | fpr=0.8743 | 7183.7 samples/s | 28.1 steps/s
[Step= 400] | Loss=5.65547 | acc=0.1394 | tpr=0.8900 | fpr=0.8742 | 7893.7 samples/s | 30.8 steps/s
[Step= 450] | Loss=5.66200 | acc=0.1396 | tpr=0.8924 | fpr=0.8741 | 7326.9 samples/s | 28.6 steps/s
[Step= 500] | Loss=5.66476 | acc=0.1394 | tpr=0.8947 | fpr=0.8743 | 7584.8 samples/s | 29.6 steps/s
[Step= 550] | Loss=5.66652 | acc=0.1393 | tpr=0.8965 | fpr=0.8745 | 13680.3 samples/s | 53.4 steps/s
Avg test loss: 5.66714, Avg test acc: 0.13920, Avg tpr: 0.89620, Avg fpr: 0.87456, total FA: 121431

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11339 | acc=0.9805 | tpr=0.9779 | fpr=0.0195 | 4199.3 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.11967 | acc=0.9793 | tpr=0.9744 | fpr=0.0206 | 7145.0 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.12572 | acc=0.9782 | tpr=0.9769 | fpr=0.0218 | 7436.8 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.12684 | acc=0.9781 | tpr=0.9749 | fpr=0.0218 | 7251.2 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.12542 | acc=0.9783 | tpr=0.9738 | fpr=0.0217 | 7510.5 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.12737 | acc=0.9780 | tpr=0.9738 | fpr=0.0219 | 7604.2 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.12890 | acc=0.9777 | tpr=0.9737 | fpr=0.0223 | 6993.0 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.13037 | acc=0.9775 | tpr=0.9726 | fpr=0.0224 | 7419.0 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.13325 | acc=0.9771 | tpr=0.9718 | fpr=0.0228 | 7550.6 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.13289 | acc=0.9772 | tpr=0.9722 | fpr=0.0227 | 7235.0 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.13185 | acc=0.9774 | tpr=0.9713 | fpr=0.0225 | 13595.2 samples/s | 53.1 steps/s
Avg test loss: 0.13168, Avg test acc: 0.97736, Avg tpr: 0.97108, Avg fpr: 0.02252, total FA: 3127

server round 15/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00050, len=1
[Step=12001 Epoch=11.7] | Loss=0.05104 | Reg=0.00388 | acc=0.9688 | L2-Norm=19.690 | L2-Norm(final)=2.091 | 4217.3 samples/s | 65.9 steps/s
[Step=12050 Epoch=11.8] | Loss=0.01210 | Reg=0.00388 | acc=0.9844 | L2-Norm=19.689 | L2-Norm(final)=2.097 | 4250.9 samples/s | 66.4 steps/s
[Step=12100 Epoch=11.8] | Loss=0.01265 | Reg=0.00388 | acc=1.0000 | L2-Norm=19.689 | L2-Norm(final)=2.097 | 4528.2 samples/s | 70.8 steps/s
[Step=12150 Epoch=11.9] | Loss=0.01256 | Reg=0.00388 | acc=1.0000 | L2-Norm=19.687 | L2-Norm(final)=2.095 | 4553.8 samples/s | 71.2 steps/s
[Step=12200 Epoch=11.9] | Loss=0.01204 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.685 | L2-Norm(final)=2.095 | 4391.7 samples/s | 68.6 steps/s
[Step=12250 Epoch=12.0] | Loss=0.01242 | Reg=0.00387 | acc=0.9844 | L2-Norm=19.682 | L2-Norm(final)=2.095 | 4510.0 samples/s | 70.5 steps/s
[Step=12300 Epoch=12.0] | Loss=0.01274 | Reg=0.00387 | acc=0.9688 | L2-Norm=19.680 | L2-Norm(final)=2.095 | 4503.5 samples/s | 70.4 steps/s
[Step=12350 Epoch=12.1] | Loss=0.01263 | Reg=0.00387 | acc=0.9844 | L2-Norm=19.679 | L2-Norm(final)=2.096 | 4531.1 samples/s | 70.8 steps/s
[Step=12400 Epoch=12.1] | Loss=0.01329 | Reg=0.00387 | acc=0.9844 | L2-Norm=19.678 | L2-Norm(final)=2.097 | 4534.3 samples/s | 70.8 steps/s
[Step=12450 Epoch=12.2] | Loss=0.01362 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.677 | L2-Norm(final)=2.097 | 4437.5 samples/s | 69.3 steps/s
[Step=12500 Epoch=12.2] | Loss=0.01351 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.676 | L2-Norm(final)=2.097 | 4383.5 samples/s | 68.5 steps/s
[Step=12550 Epoch=12.3] | Loss=0.01347 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.675 | L2-Norm(final)=2.098 | 4523.3 samples/s | 70.7 steps/s
[Step=12600 Epoch=12.3] | Loss=0.01378 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.675 | L2-Norm(final)=2.097 | 4539.6 samples/s | 70.9 steps/s
[Step=12650 Epoch=12.4] | Loss=0.01386 | Reg=0.00387 | acc=0.9844 | L2-Norm=19.674 | L2-Norm(final)=2.097 | 4576.3 samples/s | 71.5 steps/s
[Step=12700 Epoch=12.4] | Loss=0.01354 | Reg=0.00387 | acc=0.9844 | L2-Norm=19.674 | L2-Norm(final)=2.098 | 4533.0 samples/s | 70.8 steps/s
[Step=12750 Epoch=12.4] | Loss=0.01345 | Reg=0.00387 | acc=0.9531 | L2-Norm=19.673 | L2-Norm(final)=2.099 | 4486.0 samples/s | 70.1 steps/s
[Step=12800 Epoch=12.5] | Loss=0.01346 | Reg=0.00387 | acc=0.9844 | L2-Norm=19.672 | L2-Norm(final)=2.100 | 4448.1 samples/s | 69.5 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step12800.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00050, len=1
[Step=12001 Epoch=22.6] | Loss=0.00000 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.039 | L2-Norm(final)=2.899 | 4004.3 samples/s | 62.6 steps/s
[Step=12050 Epoch=22.7] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.026 | L2-Norm(final)=2.900 | 4082.8 samples/s | 63.8 steps/s
[Step=12100 Epoch=22.8] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.013 | L2-Norm(final)=2.902 | 4244.0 samples/s | 66.3 steps/s
[Step=12150 Epoch=22.9] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.000 | L2-Norm(final)=2.903 | 4227.3 samples/s | 66.1 steps/s
[Step=12200 Epoch=23.0] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.987 | L2-Norm(final)=2.905 | 4299.1 samples/s | 67.2 steps/s
[Step=12250 Epoch=23.1] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.974 | L2-Norm(final)=2.907 | 4144.2 samples/s | 64.8 steps/s
[Step=12300 Epoch=23.2] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.960 | L2-Norm(final)=2.908 | 4395.0 samples/s | 68.7 steps/s
[Step=12350 Epoch=23.3] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.946 | L2-Norm(final)=2.910 | 4291.2 samples/s | 67.1 steps/s
[Step=12400 Epoch=23.4] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.933 | L2-Norm(final)=2.912 | 4308.5 samples/s | 67.3 steps/s
[Step=12450 Epoch=23.5] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.919 | L2-Norm(final)=2.914 | 4285.7 samples/s | 67.0 steps/s
[Step=12500 Epoch=23.6] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.906 | L2-Norm(final)=2.916 | 4280.7 samples/s | 66.9 steps/s
[Step=12550 Epoch=23.7] | Loss=0.00001 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.893 | L2-Norm(final)=2.918 | 2157.5 samples/s | 33.7 steps/s
[Step=12600 Epoch=23.8] | Loss=0.00001 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.879 | L2-Norm(final)=2.920 | 4358.6 samples/s | 68.1 steps/s
[Step=12650 Epoch=23.8] | Loss=0.00001 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.865 | L2-Norm(final)=2.922 | 4219.3 samples/s | 65.9 steps/s
[Step=12700 Epoch=23.9] | Loss=0.00001 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.851 | L2-Norm(final)=2.923 | 4310.9 samples/s | 67.4 steps/s
[Step=12750 Epoch=24.0] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.837 | L2-Norm(final)=2.925 | 4320.2 samples/s | 67.5 steps/s
[Step=12800 Epoch=24.1] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.823 | L2-Norm(final)=2.927 | 4313.2 samples/s | 67.4 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step12800.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05919 | acc=0.9675 | tpr=0.9659 | fpr=0.0290 | 4210.6 samples/s | 16.4 steps/s
Avg test loss: 0.06174, Avg test acc: 0.96771, Avg tpr: 0.96678, Avg fpr: 0.03025, total FA: 236

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.98163 | acc=0.3159 | tpr=0.0031 | fpr=0.0047 | 4102.3 samples/s | 16.0 steps/s
Avg test loss: 5.00102, Avg test acc: 0.31341, Avg tpr: 0.00321, Avg fpr: 0.00436, total FA: 34

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.21850 | acc=0.1637 | tpr=0.8319 | fpr=0.8483 | 4103.2 samples/s | 16.0 steps/s
[Step= 100] | Loss=5.17198 | acc=0.1653 | tpr=0.8316 | fpr=0.8472 | 7729.2 samples/s | 30.2 steps/s
[Step= 150] | Loss=5.18493 | acc=0.1646 | tpr=0.8343 | fpr=0.8477 | 7785.9 samples/s | 30.4 steps/s
[Step= 200] | Loss=5.17643 | acc=0.1654 | tpr=0.8350 | fpr=0.8468 | 7362.4 samples/s | 28.8 steps/s
[Step= 250] | Loss=5.17065 | acc=0.1657 | tpr=0.8306 | fpr=0.8464 | 7845.8 samples/s | 30.6 steps/s
[Step= 300] | Loss=5.16888 | acc=0.1658 | tpr=0.8327 | fpr=0.8463 | 7260.3 samples/s | 28.4 steps/s
[Step= 350] | Loss=5.16247 | acc=0.1654 | tpr=0.8378 | fpr=0.8468 | 7587.9 samples/s | 29.6 steps/s
[Step= 400] | Loss=5.16216 | acc=0.1653 | tpr=0.8337 | fpr=0.8469 | 7595.3 samples/s | 29.7 steps/s
[Step= 450] | Loss=5.16835 | acc=0.1655 | tpr=0.8340 | fpr=0.8466 | 7115.2 samples/s | 27.8 steps/s
[Step= 500] | Loss=5.17144 | acc=0.1652 | tpr=0.8370 | fpr=0.8469 | 7346.8 samples/s | 28.7 steps/s
[Step= 550] | Loss=5.17223 | acc=0.1649 | tpr=0.8349 | fpr=0.8472 | 13758.3 samples/s | 53.7 steps/s
Avg test loss: 5.17303, Avg test acc: 0.16485, Avg tpr: 0.83479, Avg fpr: 0.84733, total FA: 117650

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11787 | acc=0.9799 | tpr=0.9779 | fpr=0.0200 | 3909.3 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.12398 | acc=0.9791 | tpr=0.9765 | fpr=0.0209 | 7417.8 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.13034 | acc=0.9780 | tpr=0.9769 | fpr=0.0220 | 7865.6 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.13141 | acc=0.9779 | tpr=0.9749 | fpr=0.0220 | 7528.8 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.12987 | acc=0.9781 | tpr=0.9738 | fpr=0.0218 | 8094.8 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.13180 | acc=0.9778 | tpr=0.9738 | fpr=0.0221 | 6919.6 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.13331 | acc=0.9774 | tpr=0.9737 | fpr=0.0225 | 7383.3 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.13466 | acc=0.9773 | tpr=0.9726 | fpr=0.0226 | 7881.8 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.13762 | acc=0.9770 | tpr=0.9718 | fpr=0.0230 | 8333.6 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.13719 | acc=0.9770 | tpr=0.9722 | fpr=0.0229 | 7275.2 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.13611 | acc=0.9772 | tpr=0.9710 | fpr=0.0227 | 13548.1 samples/s | 52.9 steps/s
Avg test loss: 0.13592, Avg test acc: 0.97721, Avg tpr: 0.97068, Avg fpr: 0.02267, total FA: 3148

server round 16/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00050, len=1
[Step=12801 Epoch=12.5] | Loss=0.00363 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.658 | L2-Norm(final)=2.111 | 4716.8 samples/s | 73.7 steps/s
[Step=12850 Epoch=12.5] | Loss=0.00975 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.661 | L2-Norm(final)=2.114 | 4187.3 samples/s | 65.4 steps/s
[Step=12900 Epoch=12.6] | Loss=0.00958 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.664 | L2-Norm(final)=2.119 | 4483.4 samples/s | 70.1 steps/s
[Step=12950 Epoch=12.6] | Loss=0.00995 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.666 | L2-Norm(final)=2.121 | 4412.6 samples/s | 68.9 steps/s
[Step=13000 Epoch=12.7] | Loss=0.01104 | Reg=0.00387 | acc=0.9688 | L2-Norm=19.666 | L2-Norm(final)=2.122 | 4437.9 samples/s | 69.3 steps/s
[Step=13050 Epoch=12.7] | Loss=0.01098 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.666 | L2-Norm(final)=2.122 | 4413.7 samples/s | 69.0 steps/s
[Step=13100 Epoch=12.8] | Loss=0.01171 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.666 | L2-Norm(final)=2.121 | 4566.2 samples/s | 71.3 steps/s
[Step=13150 Epoch=12.8] | Loss=0.01159 | Reg=0.00387 | acc=0.9844 | L2-Norm=19.665 | L2-Norm(final)=2.121 | 4548.5 samples/s | 71.1 steps/s
[Step=13200 Epoch=12.9] | Loss=0.01134 | Reg=0.00387 | acc=0.9688 | L2-Norm=19.664 | L2-Norm(final)=2.121 | 4561.8 samples/s | 71.3 steps/s
[Step=13250 Epoch=12.9] | Loss=0.01161 | Reg=0.00387 | acc=0.9688 | L2-Norm=19.663 | L2-Norm(final)=2.121 | 4475.2 samples/s | 69.9 steps/s
[Step=13300 Epoch=13.0] | Loss=0.01193 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.661 | L2-Norm(final)=2.120 | 4513.9 samples/s | 70.5 steps/s
[Step=13350 Epoch=13.0] | Loss=0.01227 | Reg=0.00387 | acc=0.9688 | L2-Norm=19.661 | L2-Norm(final)=2.119 | 4395.1 samples/s | 68.7 steps/s
[Step=13400 Epoch=13.1] | Loss=0.01244 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.660 | L2-Norm(final)=2.119 | 4590.5 samples/s | 71.7 steps/s
[Step=13450 Epoch=13.1] | Loss=0.01288 | Reg=0.00386 | acc=0.9688 | L2-Norm=19.659 | L2-Norm(final)=2.118 | 4551.7 samples/s | 71.1 steps/s
[Step=13500 Epoch=13.2] | Loss=0.01293 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.658 | L2-Norm(final)=2.117 | 4539.1 samples/s | 70.9 steps/s
[Step=13550 Epoch=13.2] | Loss=0.01294 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.657 | L2-Norm(final)=2.117 | 4520.6 samples/s | 70.6 steps/s
[Step=13600 Epoch=13.3] | Loss=0.01293 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.656 | L2-Norm(final)=2.117 | 4447.8 samples/s | 69.5 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step13600.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00050, len=1
[Step=12801 Epoch=24.1] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.595 | L2-Norm(final)=2.960 | 4267.3 samples/s | 66.7 steps/s
[Step=12850 Epoch=24.2] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.579 | L2-Norm(final)=2.962 | 3621.9 samples/s | 56.6 steps/s
[Step=12900 Epoch=24.3] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.563 | L2-Norm(final)=2.964 | 4128.9 samples/s | 64.5 steps/s
[Step=12950 Epoch=24.4] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.547 | L2-Norm(final)=2.966 | 4326.0 samples/s | 67.6 steps/s
[Step=13000 Epoch=24.5] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.532 | L2-Norm(final)=2.968 | 4281.0 samples/s | 66.9 steps/s
[Step=13050 Epoch=24.6] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.516 | L2-Norm(final)=2.970 | 4025.8 samples/s | 62.9 steps/s
[Step=13100 Epoch=24.7] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.500 | L2-Norm(final)=2.973 | 4234.1 samples/s | 66.2 steps/s
[Step=13150 Epoch=24.8] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.484 | L2-Norm(final)=2.975 | 4259.3 samples/s | 66.6 steps/s
[Step=13200 Epoch=24.9] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.469 | L2-Norm(final)=2.978 | 4162.9 samples/s | 65.0 steps/s
[Step=13250 Epoch=25.0] | Loss=0.00001 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.454 | L2-Norm(final)=2.981 | 4266.2 samples/s | 66.7 steps/s
[Step=13300 Epoch=25.1] | Loss=0.00122 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.466 | L2-Norm(final)=2.981 | 4224.2 samples/s | 66.0 steps/s
[Step=13350 Epoch=25.2] | Loss=0.00166 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.526 | L2-Norm(final)=2.978 | 2098.9 samples/s | 32.8 steps/s
[Step=13400 Epoch=25.3] | Loss=0.00171 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.582 | L2-Norm(final)=2.977 | 4220.5 samples/s | 65.9 steps/s
[Step=13450 Epoch=25.4] | Loss=0.00173 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.632 | L2-Norm(final)=2.977 | 4131.1 samples/s | 64.5 steps/s
[Step=13500 Epoch=25.4] | Loss=0.00162 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.675 | L2-Norm(final)=2.978 | 4162.1 samples/s | 65.0 steps/s
[Step=13550 Epoch=25.5] | Loss=0.00153 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.712 | L2-Norm(final)=2.979 | 4120.8 samples/s | 64.4 steps/s
[Step=13600 Epoch=25.6] | Loss=0.00145 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.744 | L2-Norm(final)=2.980 | 4168.2 samples/s | 65.1 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step13600.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06248 | acc=0.9708 | tpr=0.9772 | fpr=0.0431 | 4185.9 samples/s | 16.4 steps/s
Avg test loss: 0.06634, Avg test acc: 0.96971, Avg tpr: 0.97634, Avg fpr: 0.04487, total FA: 350

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.36186 | acc=0.3151 | tpr=0.0033 | fpr=0.0079 | 4234.4 samples/s | 16.5 steps/s
Avg test loss: 4.38252, Avg test acc: 0.31216, Avg tpr: 0.00309, Avg fpr: 0.00808, total FA: 63

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.30819 | acc=0.1242 | tpr=0.9248 | fpr=0.8902 | 4049.9 samples/s | 15.8 steps/s
[Step= 100] | Loss=6.26906 | acc=0.1268 | tpr=0.9190 | fpr=0.8880 | 7630.7 samples/s | 29.8 steps/s
[Step= 150] | Loss=6.29029 | acc=0.1248 | tpr=0.9049 | fpr=0.8896 | 7724.4 samples/s | 30.2 steps/s
[Step= 200] | Loss=6.28122 | acc=0.1245 | tpr=0.8973 | fpr=0.8895 | 7194.9 samples/s | 28.1 steps/s
[Step= 250] | Loss=6.27220 | acc=0.1251 | tpr=0.8908 | fpr=0.8888 | 7187.3 samples/s | 28.1 steps/s
[Step= 300] | Loss=6.27327 | acc=0.1251 | tpr=0.8902 | fpr=0.8889 | 7526.3 samples/s | 29.4 steps/s
[Step= 350] | Loss=6.26959 | acc=0.1249 | tpr=0.8929 | fpr=0.8890 | 7600.8 samples/s | 29.7 steps/s
[Step= 400] | Loss=6.27356 | acc=0.1247 | tpr=0.8922 | fpr=0.8892 | 7832.1 samples/s | 30.6 steps/s
[Step= 450] | Loss=6.27846 | acc=0.1246 | tpr=0.8934 | fpr=0.8893 | 7496.1 samples/s | 29.3 steps/s
[Step= 500] | Loss=6.28362 | acc=0.1243 | tpr=0.8960 | fpr=0.8896 | 7322.5 samples/s | 28.6 steps/s
[Step= 550] | Loss=6.28382 | acc=0.1244 | tpr=0.8969 | fpr=0.8897 | 14594.2 samples/s | 57.0 steps/s
Avg test loss: 6.28426, Avg test acc: 0.12424, Avg tpr: 0.89699, Avg fpr: 0.88981, total FA: 123548

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.07421 | acc=0.9812 | tpr=0.9735 | fpr=0.0187 | 4214.8 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.07632 | acc=0.9809 | tpr=0.9765 | fpr=0.0191 | 7655.5 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.08024 | acc=0.9803 | tpr=0.9798 | fpr=0.0197 | 7559.0 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.08129 | acc=0.9801 | tpr=0.9792 | fpr=0.0198 | 7915.9 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.08088 | acc=0.9802 | tpr=0.9782 | fpr=0.0197 | 7807.6 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.08210 | acc=0.9799 | tpr=0.9753 | fpr=0.0200 | 7247.1 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.08251 | acc=0.9798 | tpr=0.9756 | fpr=0.0202 | 8160.4 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.08353 | acc=0.9796 | tpr=0.9748 | fpr=0.0203 | 7567.2 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.08550 | acc=0.9791 | tpr=0.9732 | fpr=0.0208 | 7673.5 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.08532 | acc=0.9791 | tpr=0.9740 | fpr=0.0208 | 7611.9 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.08461 | acc=0.9793 | tpr=0.9721 | fpr=0.0206 | 13919.2 samples/s | 54.4 steps/s
Avg test loss: 0.08448, Avg test acc: 0.97928, Avg tpr: 0.97227, Avg fpr: 0.02059, total FA: 2859

server round 17/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00050, len=1
[Step=13601 Epoch=13.3] | Loss=0.05074 | Reg=0.00386 | acc=0.9375 | L2-Norm=19.641 | L2-Norm(final)=2.114 | 4094.1 samples/s | 64.0 steps/s
[Step=13650 Epoch=13.3] | Loss=0.01076 | Reg=0.00386 | acc=0.9844 | L2-Norm=19.640 | L2-Norm(final)=2.117 | 4405.5 samples/s | 68.8 steps/s
[Step=13700 Epoch=13.4] | Loss=0.01102 | Reg=0.00386 | acc=0.9844 | L2-Norm=19.639 | L2-Norm(final)=2.122 | 4502.0 samples/s | 70.3 steps/s
[Step=13750 Epoch=13.4] | Loss=0.01116 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.639 | L2-Norm(final)=2.125 | 4189.2 samples/s | 65.5 steps/s
[Step=13800 Epoch=13.5] | Loss=0.01153 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.638 | L2-Norm(final)=2.128 | 4384.2 samples/s | 68.5 steps/s
[Step=13850 Epoch=13.5] | Loss=0.01149 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.638 | L2-Norm(final)=2.130 | 4396.8 samples/s | 68.7 steps/s
[Step=13900 Epoch=13.6] | Loss=0.01198 | Reg=0.00386 | acc=0.9844 | L2-Norm=19.636 | L2-Norm(final)=2.130 | 4388.1 samples/s | 68.6 steps/s
[Step=13950 Epoch=13.6] | Loss=0.01206 | Reg=0.00386 | acc=0.9688 | L2-Norm=19.635 | L2-Norm(final)=2.131 | 4464.5 samples/s | 69.8 steps/s
[Step=14000 Epoch=13.7] | Loss=0.01233 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.633 | L2-Norm(final)=2.131 | 4406.4 samples/s | 68.8 steps/s
[Step=14050 Epoch=13.7] | Loss=0.01226 | Reg=0.00385 | acc=0.9844 | L2-Norm=19.631 | L2-Norm(final)=2.131 | 4340.3 samples/s | 67.8 steps/s
[Step=14100 Epoch=13.8] | Loss=0.01203 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.629 | L2-Norm(final)=2.131 | 4383.9 samples/s | 68.5 steps/s
[Step=14150 Epoch=13.8] | Loss=0.01205 | Reg=0.00385 | acc=0.9844 | L2-Norm=19.627 | L2-Norm(final)=2.131 | 4393.0 samples/s | 68.6 steps/s
[Step=14200 Epoch=13.9] | Loss=0.01206 | Reg=0.00385 | acc=0.9688 | L2-Norm=19.626 | L2-Norm(final)=2.131 | 4319.6 samples/s | 67.5 steps/s
[Step=14250 Epoch=13.9] | Loss=0.01188 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.625 | L2-Norm(final)=2.132 | 4267.3 samples/s | 66.7 steps/s
[Step=14300 Epoch=14.0] | Loss=0.01198 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.624 | L2-Norm(final)=2.133 | 4301.8 samples/s | 67.2 steps/s
[Step=14350 Epoch=14.0] | Loss=0.01204 | Reg=0.00385 | acc=0.9844 | L2-Norm=19.623 | L2-Norm(final)=2.134 | 4433.8 samples/s | 69.3 steps/s
[Step=14400 Epoch=14.1] | Loss=0.01201 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.622 | L2-Norm(final)=2.135 | 4396.7 samples/s | 68.7 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step14400.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00050, len=1
[Step=13601 Epoch=25.6] | Loss=0.00001 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.228 | L2-Norm(final)=3.002 | 4205.1 samples/s | 65.7 steps/s
[Step=13650 Epoch=25.7] | Loss=0.00004 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.219 | L2-Norm(final)=3.003 | 3872.5 samples/s | 60.5 steps/s
[Step=13700 Epoch=25.8] | Loss=0.00067 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.214 | L2-Norm(final)=3.004 | 4239.6 samples/s | 66.2 steps/s
[Step=13750 Epoch=25.9] | Loss=0.00051 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.225 | L2-Norm(final)=3.005 | 4147.7 samples/s | 64.8 steps/s
[Step=13800 Epoch=26.0] | Loss=0.00070 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.233 | L2-Norm(final)=3.006 | 4197.5 samples/s | 65.6 steps/s
[Step=13850 Epoch=26.1] | Loss=0.00063 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.241 | L2-Norm(final)=3.008 | 4271.9 samples/s | 66.7 steps/s
[Step=13900 Epoch=26.2] | Loss=0.00058 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.249 | L2-Norm(final)=3.011 | 4148.9 samples/s | 64.8 steps/s
[Step=13950 Epoch=26.3] | Loss=0.00050 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.254 | L2-Norm(final)=3.013 | 4152.1 samples/s | 64.9 steps/s
[Step=14000 Epoch=26.4] | Loss=0.00044 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.256 | L2-Norm(final)=3.016 | 4245.4 samples/s | 66.3 steps/s
[Step=14050 Epoch=26.5] | Loss=0.00041 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.257 | L2-Norm(final)=3.018 | 4157.2 samples/s | 65.0 steps/s
[Step=14100 Epoch=26.6] | Loss=0.00037 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.256 | L2-Norm(final)=3.021 | 4227.6 samples/s | 66.1 steps/s
[Step=14150 Epoch=26.7] | Loss=0.00034 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.255 | L2-Norm(final)=3.023 | 2064.7 samples/s | 32.3 steps/s
[Step=14200 Epoch=26.8] | Loss=0.00031 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.254 | L2-Norm(final)=3.025 | 4212.7 samples/s | 65.8 steps/s
[Step=14250 Epoch=26.9] | Loss=0.00029 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.251 | L2-Norm(final)=3.028 | 4103.7 samples/s | 64.1 steps/s
[Step=14300 Epoch=27.0] | Loss=0.00027 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.248 | L2-Norm(final)=3.030 | 4113.5 samples/s | 64.3 steps/s
[Step=14350 Epoch=27.0] | Loss=0.00025 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.244 | L2-Norm(final)=3.032 | 4075.5 samples/s | 63.7 steps/s
[Step=14400 Epoch=27.1] | Loss=0.00024 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.240 | L2-Norm(final)=3.033 | 4140.0 samples/s | 64.7 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step14400.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06593 | acc=0.9705 | tpr=0.9770 | fpr=0.0434 | 4044.4 samples/s | 15.8 steps/s
Avg test loss: 0.06932, Avg test acc: 0.96939, Avg tpr: 0.97616, Avg fpr: 0.04551, total FA: 355

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.19049 | acc=0.3150 | tpr=0.0052 | fpr=0.0124 | 4251.8 samples/s | 16.6 steps/s
Avg test loss: 5.21568, Avg test acc: 0.31172, Avg tpr: 0.00455, Avg fpr: 0.01269, total FA: 99

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.68309 | acc=0.1386 | tpr=0.9115 | fpr=0.8753 | 4190.0 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.63792 | acc=0.1403 | tpr=0.8998 | fpr=0.8739 | 7721.3 samples/s | 30.2 steps/s
[Step= 150] | Loss=6.66123 | acc=0.1388 | tpr=0.8876 | fpr=0.8750 | 7526.8 samples/s | 29.4 steps/s
[Step= 200] | Loss=6.65223 | acc=0.1390 | tpr=0.8852 | fpr=0.8746 | 8090.1 samples/s | 31.6 steps/s
[Step= 250] | Loss=6.64510 | acc=0.1393 | tpr=0.8777 | fpr=0.8742 | 7906.4 samples/s | 30.9 steps/s
[Step= 300] | Loss=6.64683 | acc=0.1390 | tpr=0.8785 | fpr=0.8745 | 7861.0 samples/s | 30.7 steps/s
[Step= 350] | Loss=6.64269 | acc=0.1387 | tpr=0.8804 | fpr=0.8747 | 7661.9 samples/s | 29.9 steps/s
[Step= 400] | Loss=6.64568 | acc=0.1387 | tpr=0.8791 | fpr=0.8748 | 8083.1 samples/s | 31.6 steps/s
[Step= 450] | Loss=6.65168 | acc=0.1387 | tpr=0.8802 | fpr=0.8747 | 7746.6 samples/s | 30.3 steps/s
[Step= 500] | Loss=6.65682 | acc=0.1383 | tpr=0.8841 | fpr=0.8752 | 7538.3 samples/s | 29.4 steps/s
[Step= 550] | Loss=6.65809 | acc=0.1383 | tpr=0.8846 | fpr=0.8753 | 12758.5 samples/s | 49.8 steps/s
Avg test loss: 6.65897, Avg test acc: 0.13820, Avg tpr: 0.88431, Avg fpr: 0.87537, total FA: 121543

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10925 | acc=0.9812 | tpr=0.9735 | fpr=0.0186 | 4122.1 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.11323 | acc=0.9807 | tpr=0.9744 | fpr=0.0192 | 7632.5 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.11914 | acc=0.9797 | tpr=0.9741 | fpr=0.0202 | 7480.9 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.12083 | acc=0.9796 | tpr=0.9738 | fpr=0.0203 | 7573.6 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.11951 | acc=0.9798 | tpr=0.9738 | fpr=0.0201 | 7537.5 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.12156 | acc=0.9796 | tpr=0.9709 | fpr=0.0203 | 7427.1 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.12244 | acc=0.9792 | tpr=0.9712 | fpr=0.0206 | 7721.7 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.12379 | acc=0.9791 | tpr=0.9705 | fpr=0.0208 | 7545.6 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.12669 | acc=0.9786 | tpr=0.9698 | fpr=0.0212 | 7503.1 samples/s | 29.3 steps/s
[Step= 500] | Loss=0.12634 | acc=0.9786 | tpr=0.9700 | fpr=0.0213 | 7461.1 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.12537 | acc=0.9788 | tpr=0.9694 | fpr=0.0211 | 14025.7 samples/s | 54.8 steps/s
Avg test loss: 0.12521, Avg test acc: 0.97878, Avg tpr: 0.96949, Avg fpr: 0.02105, total FA: 2923

server round 18/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00050, len=1
[Step=14401 Epoch=14.1] | Loss=0.01292 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.610 | L2-Norm(final)=2.154 | 4132.3 samples/s | 64.6 steps/s
[Step=14450 Epoch=14.1] | Loss=0.01177 | Reg=0.00385 | acc=0.9688 | L2-Norm=19.609 | L2-Norm(final)=2.156 | 4245.3 samples/s | 66.3 steps/s
[Step=14500 Epoch=14.2] | Loss=0.01255 | Reg=0.00384 | acc=0.9844 | L2-Norm=19.608 | L2-Norm(final)=2.156 | 4361.1 samples/s | 68.1 steps/s
[Step=14550 Epoch=14.2] | Loss=0.01178 | Reg=0.00384 | acc=0.9531 | L2-Norm=19.606 | L2-Norm(final)=2.157 | 4265.5 samples/s | 66.6 steps/s
[Step=14600 Epoch=14.3] | Loss=0.01190 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.604 | L2-Norm(final)=2.158 | 4282.9 samples/s | 66.9 steps/s
[Step=14650 Epoch=14.3] | Loss=0.01161 | Reg=0.00384 | acc=0.9844 | L2-Norm=19.603 | L2-Norm(final)=2.159 | 4428.8 samples/s | 69.2 steps/s
[Step=14700 Epoch=14.4] | Loss=0.01118 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.602 | L2-Norm(final)=2.160 | 4435.7 samples/s | 69.3 steps/s
[Step=14750 Epoch=14.4] | Loss=0.01126 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.601 | L2-Norm(final)=2.162 | 4435.3 samples/s | 69.3 steps/s
[Step=14800 Epoch=14.4] | Loss=0.01158 | Reg=0.00384 | acc=0.9844 | L2-Norm=19.600 | L2-Norm(final)=2.162 | 4425.5 samples/s | 69.1 steps/s
[Step=14850 Epoch=14.5] | Loss=0.01170 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.600 | L2-Norm(final)=2.162 | 4400.2 samples/s | 68.8 steps/s
[Step=14900 Epoch=14.5] | Loss=0.01195 | Reg=0.00384 | acc=0.9844 | L2-Norm=19.600 | L2-Norm(final)=2.162 | 4383.7 samples/s | 68.5 steps/s
[Step=14950 Epoch=14.6] | Loss=0.01224 | Reg=0.00384 | acc=0.9688 | L2-Norm=19.601 | L2-Norm(final)=2.163 | 4368.6 samples/s | 68.3 steps/s
[Step=15000 Epoch=14.6] | Loss=0.01241 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.603 | L2-Norm(final)=2.163 | 4416.9 samples/s | 69.0 steps/s
[Step=15050 Epoch=14.7] | Loss=0.01258 | Reg=0.00384 | acc=0.9531 | L2-Norm=19.605 | L2-Norm(final)=2.163 | 4379.3 samples/s | 68.4 steps/s
[Step=15100 Epoch=14.7] | Loss=0.01260 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.607 | L2-Norm(final)=2.163 | 4316.5 samples/s | 67.4 steps/s
[Step=15150 Epoch=14.8] | Loss=0.01287 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.609 | L2-Norm(final)=2.163 | 4337.5 samples/s | 67.8 steps/s
[Step=15200 Epoch=14.8] | Loss=0.01283 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.611 | L2-Norm(final)=2.163 | 4326.9 samples/s | 67.6 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step15200.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00050, len=1
[Step=14401 Epoch=27.1] | Loss=0.00000 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.168 | L2-Norm(final)=3.062 | 4159.8 samples/s | 65.0 steps/s
[Step=14450 Epoch=27.2] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.161 | L2-Norm(final)=3.063 | 3932.0 samples/s | 61.4 steps/s
[Step=14500 Epoch=27.3] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.154 | L2-Norm(final)=3.065 | 4061.7 samples/s | 63.5 steps/s
[Step=14550 Epoch=27.4] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.147 | L2-Norm(final)=3.067 | 4109.5 samples/s | 64.2 steps/s
[Step=14600 Epoch=27.5] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.141 | L2-Norm(final)=3.068 | 4202.0 samples/s | 65.7 steps/s
[Step=14650 Epoch=27.6] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.134 | L2-Norm(final)=3.070 | 4283.5 samples/s | 66.9 steps/s
[Step=14700 Epoch=27.7] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.127 | L2-Norm(final)=3.071 | 4319.2 samples/s | 67.5 steps/s
[Step=14750 Epoch=27.8] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.121 | L2-Norm(final)=3.073 | 4251.7 samples/s | 66.4 steps/s
[Step=14800 Epoch=27.9] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.115 | L2-Norm(final)=3.074 | 4294.0 samples/s | 67.1 steps/s
[Step=14850 Epoch=28.0] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.108 | L2-Norm(final)=3.076 | 4278.6 samples/s | 66.9 steps/s
[Step=14900 Epoch=28.1] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.101 | L2-Norm(final)=3.078 | 4392.3 samples/s | 68.6 steps/s
[Step=14950 Epoch=28.2] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.095 | L2-Norm(final)=3.080 | 2096.0 samples/s | 32.8 steps/s
[Step=15000 Epoch=28.3] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.088 | L2-Norm(final)=3.082 | 4266.5 samples/s | 66.7 steps/s
[Step=15050 Epoch=28.4] | Loss=0.00000 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.081 | L2-Norm(final)=3.084 | 4274.7 samples/s | 66.8 steps/s
[Step=15100 Epoch=28.5] | Loss=0.00000 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.074 | L2-Norm(final)=3.086 | 4326.6 samples/s | 67.6 steps/s
[Step=15150 Epoch=28.6] | Loss=0.00000 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.067 | L2-Norm(final)=3.089 | 4293.7 samples/s | 67.1 steps/s
[Step=15200 Epoch=28.7] | Loss=0.00000 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.060 | L2-Norm(final)=3.091 | 4316.2 samples/s | 67.4 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step15200.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06305 | acc=0.9704 | tpr=0.9726 | fpr=0.0344 | 4187.3 samples/s | 16.4 steps/s
Avg test loss: 0.06585, Avg test acc: 0.96899, Avg tpr: 0.97097, Avg fpr: 0.03538, total FA: 276

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.34311 | acc=0.3148 | tpr=0.0046 | fpr=0.0116 | 4198.5 samples/s | 16.4 steps/s
Avg test loss: 5.36921, Avg test acc: 0.31164, Avg tpr: 0.00391, Avg fpr: 0.01154, total FA: 90

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.15412 | acc=0.1588 | tpr=0.8717 | fpr=0.8541 | 4206.1 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.12578 | acc=0.1605 | tpr=0.8550 | fpr=0.8525 | 7922.7 samples/s | 30.9 steps/s
[Step= 150] | Loss=6.14357 | acc=0.1598 | tpr=0.8530 | fpr=0.8529 | 7543.6 samples/s | 29.5 steps/s
[Step= 200] | Loss=6.13173 | acc=0.1601 | tpr=0.8525 | fpr=0.8525 | 7744.5 samples/s | 30.3 steps/s
[Step= 250] | Loss=6.12467 | acc=0.1605 | tpr=0.8472 | fpr=0.8520 | 7961.1 samples/s | 31.1 steps/s
[Step= 300] | Loss=6.12289 | acc=0.1606 | tpr=0.8502 | fpr=0.8520 | 7577.1 samples/s | 29.6 steps/s
[Step= 350] | Loss=6.11722 | acc=0.1601 | tpr=0.8560 | fpr=0.8526 | 7477.9 samples/s | 29.2 steps/s
[Step= 400] | Loss=6.11849 | acc=0.1602 | tpr=0.8539 | fpr=0.8524 | 7411.2 samples/s | 29.0 steps/s
[Step= 450] | Loss=6.12699 | acc=0.1603 | tpr=0.8559 | fpr=0.8523 | 7664.0 samples/s | 29.9 steps/s
[Step= 500] | Loss=6.13153 | acc=0.1600 | tpr=0.8581 | fpr=0.8526 | 7049.1 samples/s | 27.5 steps/s
[Step= 550] | Loss=6.13387 | acc=0.1597 | tpr=0.8579 | fpr=0.8530 | 13932.3 samples/s | 54.4 steps/s
Avg test loss: 6.13478, Avg test acc: 0.15961, Avg tpr: 0.85737, Avg fpr: 0.85307, total FA: 118447

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10915 | acc=0.9816 | tpr=0.9735 | fpr=0.0183 | 4135.6 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.11308 | acc=0.9809 | tpr=0.9744 | fpr=0.0190 | 7585.1 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.11908 | acc=0.9800 | tpr=0.9741 | fpr=0.0199 | 7610.6 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.12076 | acc=0.9799 | tpr=0.9738 | fpr=0.0200 | 7217.3 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.11940 | acc=0.9801 | tpr=0.9738 | fpr=0.0198 | 7883.5 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.12144 | acc=0.9798 | tpr=0.9709 | fpr=0.0200 | 7476.1 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.12229 | acc=0.9795 | tpr=0.9712 | fpr=0.0203 | 7062.6 samples/s | 27.6 steps/s
[Step= 400] | Loss=0.12367 | acc=0.9794 | tpr=0.9705 | fpr=0.0205 | 7188.1 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.12659 | acc=0.9789 | tpr=0.9698 | fpr=0.0209 | 7086.8 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.12624 | acc=0.9789 | tpr=0.9700 | fpr=0.0209 | 8213.6 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.12527 | acc=0.9791 | tpr=0.9694 | fpr=0.0207 | 11554.2 samples/s | 45.1 steps/s
Avg test loss: 0.12511, Avg test acc: 0.97910, Avg tpr: 0.96949, Avg fpr: 0.02073, total FA: 2878

server round 19/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00050, len=1
[Step=15201 Epoch=14.8] | Loss=0.00590 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.640 | L2-Norm(final)=2.166 | 4324.9 samples/s | 67.6 steps/s
[Step=15250 Epoch=14.9] | Loss=0.01030 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.639 | L2-Norm(final)=2.171 | 4013.7 samples/s | 62.7 steps/s
[Step=15300 Epoch=14.9] | Loss=0.01206 | Reg=0.00386 | acc=0.9844 | L2-Norm=19.641 | L2-Norm(final)=2.175 | 4301.0 samples/s | 67.2 steps/s
[Step=15350 Epoch=15.0] | Loss=0.01205 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.644 | L2-Norm(final)=2.177 | 4328.3 samples/s | 67.6 steps/s
[Step=15400 Epoch=15.0] | Loss=0.01264 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.648 | L2-Norm(final)=2.178 | 4335.0 samples/s | 67.7 steps/s
[Step=15450 Epoch=15.1] | Loss=0.01304 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.651 | L2-Norm(final)=2.178 | 4427.8 samples/s | 69.2 steps/s
[Step=15500 Epoch=15.1] | Loss=0.01286 | Reg=0.00386 | acc=0.9688 | L2-Norm=19.654 | L2-Norm(final)=2.177 | 4404.9 samples/s | 68.8 steps/s
[Step=15550 Epoch=15.2] | Loss=0.01314 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.656 | L2-Norm(final)=2.178 | 4436.2 samples/s | 69.3 steps/s
[Step=15600 Epoch=15.2] | Loss=0.01334 | Reg=0.00386 | acc=0.9844 | L2-Norm=19.657 | L2-Norm(final)=2.178 | 4495.7 samples/s | 70.2 steps/s
[Step=15650 Epoch=15.3] | Loss=0.01347 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.659 | L2-Norm(final)=2.178 | 4598.3 samples/s | 71.8 steps/s
[Step=15700 Epoch=15.3] | Loss=0.01345 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.660 | L2-Norm(final)=2.178 | 4511.8 samples/s | 70.5 steps/s
[Step=15750 Epoch=15.4] | Loss=0.01371 | Reg=0.00387 | acc=0.9844 | L2-Norm=19.661 | L2-Norm(final)=2.178 | 4452.0 samples/s | 69.6 steps/s
[Step=15800 Epoch=15.4] | Loss=0.01366 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.662 | L2-Norm(final)=2.176 | 4361.6 samples/s | 68.1 steps/s
[Step=15850 Epoch=15.5] | Loss=0.01357 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.663 | L2-Norm(final)=2.176 | 4208.2 samples/s | 65.8 steps/s
[Step=15900 Epoch=15.5] | Loss=0.01348 | Reg=0.00387 | acc=0.9844 | L2-Norm=19.663 | L2-Norm(final)=2.175 | 4600.0 samples/s | 71.9 steps/s
[Step=15950 Epoch=15.6] | Loss=0.01354 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.664 | L2-Norm(final)=2.175 | 4492.5 samples/s | 70.2 steps/s
[Step=16000 Epoch=15.6] | Loss=0.01369 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.665 | L2-Norm(final)=2.174 | 4496.4 samples/s | 70.3 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step16000.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00050, len=1
[Step=15201 Epoch=28.7] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.951 | L2-Norm(final)=3.132 | 4525.2 samples/s | 70.7 steps/s
[Step=15250 Epoch=28.7] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.944 | L2-Norm(final)=3.135 | 3915.9 samples/s | 61.2 steps/s
[Step=15300 Epoch=28.8] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.937 | L2-Norm(final)=3.138 | 4293.3 samples/s | 67.1 steps/s
[Step=15350 Epoch=28.9] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.930 | L2-Norm(final)=3.140 | 4317.2 samples/s | 67.5 steps/s
[Step=15400 Epoch=29.0] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.924 | L2-Norm(final)=3.142 | 4305.8 samples/s | 67.3 steps/s
[Step=15450 Epoch=29.1] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.917 | L2-Norm(final)=3.145 | 4231.3 samples/s | 66.1 steps/s
[Step=15500 Epoch=29.2] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.910 | L2-Norm(final)=3.147 | 4312.8 samples/s | 67.4 steps/s
[Step=15550 Epoch=29.3] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.903 | L2-Norm(final)=3.150 | 4256.3 samples/s | 66.5 steps/s
[Step=15600 Epoch=29.4] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.896 | L2-Norm(final)=3.153 | 4355.4 samples/s | 68.1 steps/s
[Step=15650 Epoch=29.5] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.889 | L2-Norm(final)=3.155 | 4356.2 samples/s | 68.1 steps/s
[Step=15700 Epoch=29.6] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.882 | L2-Norm(final)=3.157 | 4406.6 samples/s | 68.9 steps/s
[Step=15750 Epoch=29.7] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.875 | L2-Norm(final)=3.159 | 2089.2 samples/s | 32.6 steps/s
[Step=15800 Epoch=29.8] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.868 | L2-Norm(final)=3.161 | 4203.5 samples/s | 65.7 steps/s
[Step=15850 Epoch=29.9] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.861 | L2-Norm(final)=3.164 | 4314.8 samples/s | 67.4 steps/s
[Step=15900 Epoch=30.0] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.854 | L2-Norm(final)=3.166 | 4325.9 samples/s | 67.6 steps/s
[Step=15950 Epoch=30.1] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.846 | L2-Norm(final)=3.168 | 4310.1 samples/s | 67.3 steps/s
[Step=16000 Epoch=30.2] | Loss=0.00000 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.839 | L2-Norm(final)=3.171 | 4224.2 samples/s | 66.0 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step16000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06117 | acc=0.9702 | tpr=0.9741 | fpr=0.0382 | 4246.0 samples/s | 16.6 steps/s
Avg test loss: 0.06294, Avg test acc: 0.96979, Avg tpr: 0.97406, Avg fpr: 0.03961, total FA: 309

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.28570 | acc=0.3149 | tpr=0.0049 | fpr=0.0119 | 4166.8 samples/s | 16.3 steps/s
Avg test loss: 5.31109, Avg test acc: 0.31152, Avg tpr: 0.00437, Avg fpr: 0.01295, total FA: 101

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.68571 | acc=0.1411 | tpr=0.8628 | fpr=0.8719 | 4265.5 samples/s | 16.7 steps/s
[Step= 100] | Loss=5.64709 | acc=0.1454 | tpr=0.8571 | fpr=0.8679 | 7379.3 samples/s | 28.8 steps/s
[Step= 150] | Loss=5.66992 | acc=0.1447 | tpr=0.8573 | fpr=0.8684 | 7362.9 samples/s | 28.8 steps/s
[Step= 200] | Loss=5.66055 | acc=0.1454 | tpr=0.8623 | fpr=0.8677 | 7709.8 samples/s | 30.1 steps/s
[Step= 250] | Loss=5.65828 | acc=0.1460 | tpr=0.8611 | fpr=0.8670 | 7760.8 samples/s | 30.3 steps/s
[Step= 300] | Loss=5.66049 | acc=0.1458 | tpr=0.8611 | fpr=0.8672 | 7656.7 samples/s | 29.9 steps/s
[Step= 350] | Loss=5.65549 | acc=0.1457 | tpr=0.8654 | fpr=0.8673 | 7295.5 samples/s | 28.5 steps/s
[Step= 400] | Loss=5.65530 | acc=0.1459 | tpr=0.8676 | fpr=0.8672 | 7412.7 samples/s | 29.0 steps/s
[Step= 450] | Loss=5.66073 | acc=0.1461 | tpr=0.8700 | fpr=0.8670 | 7220.5 samples/s | 28.2 steps/s
[Step= 500] | Loss=5.66273 | acc=0.1456 | tpr=0.8700 | fpr=0.8674 | 7263.3 samples/s | 28.4 steps/s
[Step= 550] | Loss=5.66444 | acc=0.1454 | tpr=0.8679 | fpr=0.8677 | 13409.0 samples/s | 52.4 steps/s
Avg test loss: 5.66579, Avg test acc: 0.14529, Avg tpr: 0.86767, Avg fpr: 0.86784, total FA: 120498

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11326 | acc=0.9813 | tpr=0.9735 | fpr=0.0185 | 4093.8 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.11733 | acc=0.9807 | tpr=0.9744 | fpr=0.0191 | 7147.0 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.12364 | acc=0.9798 | tpr=0.9741 | fpr=0.0201 | 7425.1 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.12532 | acc=0.9798 | tpr=0.9749 | fpr=0.0201 | 7558.3 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.12383 | acc=0.9800 | tpr=0.9755 | fpr=0.0200 | 8320.3 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.12588 | acc=0.9796 | tpr=0.9724 | fpr=0.0202 | 7392.7 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.12677 | acc=0.9794 | tpr=0.9724 | fpr=0.0205 | 7477.1 samples/s | 29.2 steps/s
[Step= 400] | Loss=0.12817 | acc=0.9792 | tpr=0.9716 | fpr=0.0207 | 7867.8 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.13120 | acc=0.9788 | tpr=0.9708 | fpr=0.0211 | 7449.6 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.13085 | acc=0.9787 | tpr=0.9709 | fpr=0.0211 | 7839.7 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.12985 | acc=0.9789 | tpr=0.9702 | fpr=0.0209 | 14119.7 samples/s | 55.2 steps/s
Avg test loss: 0.12967, Avg test acc: 0.97895, Avg tpr: 0.97029, Avg fpr: 0.02089, total FA: 2901

server round 20/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00025, len=1
[Step=16001 Epoch=15.6] | Loss=0.00612 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.675 | L2-Norm(final)=2.161 | 4427.9 samples/s | 69.2 steps/s
[Step=16050 Epoch=15.7] | Loss=0.01206 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.673 | L2-Norm(final)=2.162 | 3969.3 samples/s | 62.0 steps/s
[Step=16100 Epoch=15.7] | Loss=0.01044 | Reg=0.00387 | acc=0.9844 | L2-Norm=19.671 | L2-Norm(final)=2.165 | 4494.6 samples/s | 70.2 steps/s
[Step=16150 Epoch=15.8] | Loss=0.01101 | Reg=0.00387 | acc=0.9844 | L2-Norm=19.669 | L2-Norm(final)=2.167 | 4539.4 samples/s | 70.9 steps/s
[Step=16200 Epoch=15.8] | Loss=0.01021 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.667 | L2-Norm(final)=2.169 | 4547.2 samples/s | 71.0 steps/s
[Step=16250 Epoch=15.9] | Loss=0.00974 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.664 | L2-Norm(final)=2.171 | 4492.4 samples/s | 70.2 steps/s
[Step=16300 Epoch=15.9] | Loss=0.00965 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.662 | L2-Norm(final)=2.173 | 4649.8 samples/s | 72.7 steps/s
[Step=16350 Epoch=16.0] | Loss=0.00968 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.660 | L2-Norm(final)=2.174 | 4446.1 samples/s | 69.5 steps/s
[Step=16400 Epoch=16.0] | Loss=0.00960 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.659 | L2-Norm(final)=2.175 | 4560.8 samples/s | 71.3 steps/s
[Step=16450 Epoch=16.1] | Loss=0.00972 | Reg=0.00386 | acc=0.9844 | L2-Norm=19.657 | L2-Norm(final)=2.176 | 4634.9 samples/s | 72.4 steps/s
[Step=16500 Epoch=16.1] | Loss=0.00984 | Reg=0.00386 | acc=0.9844 | L2-Norm=19.654 | L2-Norm(final)=2.177 | 4588.8 samples/s | 71.7 steps/s
[Step=16550 Epoch=16.2] | Loss=0.00967 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.652 | L2-Norm(final)=2.178 | 4501.7 samples/s | 70.3 steps/s
[Step=16600 Epoch=16.2] | Loss=0.00963 | Reg=0.00386 | acc=0.9844 | L2-Norm=19.650 | L2-Norm(final)=2.178 | 4464.9 samples/s | 69.8 steps/s
[Step=16650 Epoch=16.3] | Loss=0.00953 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.648 | L2-Norm(final)=2.179 | 4513.1 samples/s | 70.5 steps/s
[Step=16700 Epoch=16.3] | Loss=0.00943 | Reg=0.00386 | acc=0.9844 | L2-Norm=19.646 | L2-Norm(final)=2.180 | 4531.3 samples/s | 70.8 steps/s
[Step=16750 Epoch=16.4] | Loss=0.00939 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.644 | L2-Norm(final)=2.182 | 4533.5 samples/s | 70.8 steps/s
[Step=16800 Epoch=16.4] | Loss=0.00931 | Reg=0.00386 | acc=0.9844 | L2-Norm=19.642 | L2-Norm(final)=2.183 | 4492.4 samples/s | 70.2 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step16800.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00025, len=1
[Step=16001 Epoch=30.2] | Loss=0.00000 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.721 | L2-Norm(final)=3.212 | 4290.5 samples/s | 67.0 steps/s
[Step=16050 Epoch=30.3] | Loss=0.00000 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.717 | L2-Norm(final)=3.213 | 3682.9 samples/s | 57.5 steps/s
[Step=16100 Epoch=30.3] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.713 | L2-Norm(final)=3.215 | 4281.4 samples/s | 66.9 steps/s
[Step=16150 Epoch=30.4] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.709 | L2-Norm(final)=3.216 | 4333.4 samples/s | 67.7 steps/s
[Step=16200 Epoch=30.5] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.705 | L2-Norm(final)=3.217 | 4126.7 samples/s | 64.5 steps/s
[Step=16250 Epoch=30.6] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.701 | L2-Norm(final)=3.218 | 4144.1 samples/s | 64.8 steps/s
[Step=16300 Epoch=30.7] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.697 | L2-Norm(final)=3.219 | 4220.0 samples/s | 65.9 steps/s
[Step=16350 Epoch=30.8] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.693 | L2-Norm(final)=3.221 | 4147.0 samples/s | 64.8 steps/s
[Step=16400 Epoch=30.9] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.689 | L2-Norm(final)=3.222 | 4243.7 samples/s | 66.3 steps/s
[Step=16450 Epoch=31.0] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.684 | L2-Norm(final)=3.224 | 4240.7 samples/s | 66.3 steps/s
[Step=16500 Epoch=31.1] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.680 | L2-Norm(final)=3.226 | 4246.4 samples/s | 66.3 steps/s
[Step=16550 Epoch=31.2] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.676 | L2-Norm(final)=3.228 | 2071.3 samples/s | 32.4 steps/s
[Step=16600 Epoch=31.3] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.672 | L2-Norm(final)=3.229 | 4167.0 samples/s | 65.1 steps/s
[Step=16650 Epoch=31.4] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.667 | L2-Norm(final)=3.231 | 4182.1 samples/s | 65.3 steps/s
[Step=16700 Epoch=31.5] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.663 | L2-Norm(final)=3.233 | 4150.4 samples/s | 64.9 steps/s
[Step=16750 Epoch=31.6] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.659 | L2-Norm(final)=3.235 | 4216.5 samples/s | 65.9 steps/s
[Step=16800 Epoch=31.7] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.654 | L2-Norm(final)=3.237 | 4291.0 samples/s | 67.0 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step16800.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06997 | acc=0.9735 | tpr=0.9789 | fpr=0.0382 | 4115.2 samples/s | 16.1 steps/s
Avg test loss: 0.07272, Avg test acc: 0.97287, Avg tpr: 0.97873, Avg fpr: 0.03999, total FA: 312

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.26675 | acc=0.3148 | tpr=0.0046 | fpr=0.0116 | 4040.2 samples/s | 15.8 steps/s
Avg test loss: 5.29186, Avg test acc: 0.31160, Avg tpr: 0.00408, Avg fpr: 0.01205, total FA: 94

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.13038 | acc=0.1443 | tpr=0.9248 | fpr=0.8697 | 4078.1 samples/s | 15.9 steps/s
[Step= 100] | Loss=7.08818 | acc=0.1463 | tpr=0.8955 | fpr=0.8677 | 7237.1 samples/s | 28.3 steps/s
[Step= 150] | Loss=7.11730 | acc=0.1448 | tpr=0.8818 | fpr=0.8687 | 7379.2 samples/s | 28.8 steps/s
[Step= 200] | Loss=7.10874 | acc=0.1449 | tpr=0.8787 | fpr=0.8684 | 7187.5 samples/s | 28.1 steps/s
[Step= 250] | Loss=7.10467 | acc=0.1452 | tpr=0.8742 | fpr=0.8680 | 7570.4 samples/s | 29.6 steps/s
[Step= 300] | Loss=7.10704 | acc=0.1451 | tpr=0.8742 | fpr=0.8682 | 7272.1 samples/s | 28.4 steps/s
[Step= 350] | Loss=7.10124 | acc=0.1449 | tpr=0.8760 | fpr=0.8684 | 7785.0 samples/s | 30.4 steps/s
[Step= 400] | Loss=7.10161 | acc=0.1450 | tpr=0.8742 | fpr=0.8682 | 7603.4 samples/s | 29.7 steps/s
[Step= 450] | Loss=7.10813 | acc=0.1454 | tpr=0.8768 | fpr=0.8679 | 7960.6 samples/s | 31.1 steps/s
[Step= 500] | Loss=7.11064 | acc=0.1449 | tpr=0.8793 | fpr=0.8684 | 7525.0 samples/s | 29.4 steps/s
[Step= 550] | Loss=7.11168 | acc=0.1447 | tpr=0.8786 | fpr=0.8686 | 13824.3 samples/s | 54.0 steps/s
Avg test loss: 7.11343, Avg test acc: 0.14460, Avg tpr: 0.87837, Avg fpr: 0.86874, total FA: 120623

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11108 | acc=0.9814 | tpr=0.9690 | fpr=0.0184 | 4159.1 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.11501 | acc=0.9808 | tpr=0.9723 | fpr=0.0191 | 7537.8 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.12131 | acc=0.9800 | tpr=0.9726 | fpr=0.0199 | 7906.8 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.12294 | acc=0.9800 | tpr=0.9727 | fpr=0.0199 | 7553.2 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.12144 | acc=0.9801 | tpr=0.9721 | fpr=0.0197 | 7770.7 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.12345 | acc=0.9799 | tpr=0.9695 | fpr=0.0199 | 7720.1 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.12430 | acc=0.9796 | tpr=0.9699 | fpr=0.0203 | 7486.6 samples/s | 29.2 steps/s
[Step= 400] | Loss=0.12567 | acc=0.9794 | tpr=0.9694 | fpr=0.0204 | 7857.9 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.12867 | acc=0.9790 | tpr=0.9688 | fpr=0.0208 | 7315.2 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.12831 | acc=0.9789 | tpr=0.9692 | fpr=0.0209 | 7989.6 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.12733 | acc=0.9791 | tpr=0.9686 | fpr=0.0207 | 14064.8 samples/s | 54.9 steps/s
Avg test loss: 0.12715, Avg test acc: 0.97915, Avg tpr: 0.96870, Avg fpr: 0.02066, total FA: 2869

server round 21/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00025, len=1
[Step=16801 Epoch=16.4] | Loss=0.00878 | Reg=0.00385 | acc=0.9844 | L2-Norm=19.609 | L2-Norm(final)=2.202 | 4073.2 samples/s | 63.6 steps/s
[Step=16850 Epoch=16.5] | Loss=0.00729 | Reg=0.00384 | acc=0.9844 | L2-Norm=19.608 | L2-Norm(final)=2.205 | 4097.1 samples/s | 64.0 steps/s
[Step=16900 Epoch=16.5] | Loss=0.00751 | Reg=0.00384 | acc=0.9688 | L2-Norm=19.606 | L2-Norm(final)=2.206 | 4513.5 samples/s | 70.5 steps/s
[Step=16950 Epoch=16.5] | Loss=0.00808 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.604 | L2-Norm(final)=2.207 | 4437.6 samples/s | 69.3 steps/s
[Step=17000 Epoch=16.6] | Loss=0.00822 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.601 | L2-Norm(final)=2.208 | 4385.1 samples/s | 68.5 steps/s
[Step=17050 Epoch=16.6] | Loss=0.00800 | Reg=0.00384 | acc=0.9844 | L2-Norm=19.598 | L2-Norm(final)=2.209 | 4403.4 samples/s | 68.8 steps/s
[Step=17100 Epoch=16.7] | Loss=0.00788 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.596 | L2-Norm(final)=2.210 | 4348.8 samples/s | 67.9 steps/s
[Step=17150 Epoch=16.7] | Loss=0.00777 | Reg=0.00384 | acc=0.9844 | L2-Norm=19.593 | L2-Norm(final)=2.210 | 4373.3 samples/s | 68.3 steps/s
[Step=17200 Epoch=16.8] | Loss=0.00768 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.590 | L2-Norm(final)=2.211 | 4351.8 samples/s | 68.0 steps/s
[Step=17250 Epoch=16.8] | Loss=0.00774 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.587 | L2-Norm(final)=2.213 | 4401.4 samples/s | 68.8 steps/s
[Step=17300 Epoch=16.9] | Loss=0.00751 | Reg=0.00384 | acc=0.9844 | L2-Norm=19.584 | L2-Norm(final)=2.214 | 4442.2 samples/s | 69.4 steps/s
[Step=17350 Epoch=16.9] | Loss=0.00752 | Reg=0.00383 | acc=1.0000 | L2-Norm=19.581 | L2-Norm(final)=2.215 | 4428.8 samples/s | 69.2 steps/s
[Step=17400 Epoch=17.0] | Loss=0.00773 | Reg=0.00383 | acc=1.0000 | L2-Norm=19.578 | L2-Norm(final)=2.216 | 4372.2 samples/s | 68.3 steps/s
[Step=17450 Epoch=17.0] | Loss=0.00772 | Reg=0.00383 | acc=1.0000 | L2-Norm=19.576 | L2-Norm(final)=2.217 | 4421.7 samples/s | 69.1 steps/s
[Step=17500 Epoch=17.1] | Loss=0.00785 | Reg=0.00383 | acc=1.0000 | L2-Norm=19.573 | L2-Norm(final)=2.217 | 4413.3 samples/s | 69.0 steps/s
[Step=17550 Epoch=17.1] | Loss=0.00794 | Reg=0.00383 | acc=0.9844 | L2-Norm=19.570 | L2-Norm(final)=2.218 | 4424.1 samples/s | 69.1 steps/s
[Step=17600 Epoch=17.2] | Loss=0.00798 | Reg=0.00383 | acc=1.0000 | L2-Norm=19.567 | L2-Norm(final)=2.218 | 4463.8 samples/s | 69.7 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step17600.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00025, len=1
[Step=16801 Epoch=31.7] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.581 | L2-Norm(final)=3.267 | 4520.0 samples/s | 70.6 steps/s
[Step=16850 Epoch=31.8] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.576 | L2-Norm(final)=3.269 | 3699.2 samples/s | 57.8 steps/s
[Step=16900 Epoch=31.9] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.571 | L2-Norm(final)=3.271 | 4255.3 samples/s | 66.5 steps/s
[Step=16950 Epoch=32.0] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.566 | L2-Norm(final)=3.273 | 4229.2 samples/s | 66.1 steps/s
[Step=17000 Epoch=32.0] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.561 | L2-Norm(final)=3.275 | 4270.4 samples/s | 66.7 steps/s
[Step=17050 Epoch=32.1] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.556 | L2-Norm(final)=3.277 | 4207.1 samples/s | 65.7 steps/s
[Step=17100 Epoch=32.2] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.551 | L2-Norm(final)=3.279 | 4244.7 samples/s | 66.3 steps/s
[Step=17150 Epoch=32.3] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.545 | L2-Norm(final)=3.282 | 4348.8 samples/s | 68.0 steps/s
[Step=17200 Epoch=32.4] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.540 | L2-Norm(final)=3.284 | 4108.8 samples/s | 64.2 steps/s
[Step=17250 Epoch=32.5] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.534 | L2-Norm(final)=3.286 | 4217.0 samples/s | 65.9 steps/s
[Step=17300 Epoch=32.6] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.529 | L2-Norm(final)=3.289 | 3940.9 samples/s | 61.6 steps/s
[Step=17350 Epoch=32.7] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.523 | L2-Norm(final)=3.291 | 2041.3 samples/s | 31.9 steps/s
[Step=17400 Epoch=32.8] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.518 | L2-Norm(final)=3.293 | 4190.3 samples/s | 65.5 steps/s
[Step=17450 Epoch=32.9] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.512 | L2-Norm(final)=3.296 | 3991.4 samples/s | 62.4 steps/s
[Step=17500 Epoch=33.0] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.506 | L2-Norm(final)=3.298 | 4210.3 samples/s | 65.8 steps/s
[Step=17550 Epoch=33.1] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.500 | L2-Norm(final)=3.301 | 4214.1 samples/s | 65.8 steps/s
[Step=17600 Epoch=33.2] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.495 | L2-Norm(final)=3.303 | 4152.1 samples/s | 64.9 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step17600.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07734 | acc=0.9715 | tpr=0.9784 | fpr=0.0436 | 3958.5 samples/s | 15.5 steps/s
Avg test loss: 0.07966, Avg test acc: 0.97119, Avg tpr: 0.97913, Avg fpr: 0.04628, total FA: 361

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.19722 | acc=0.3149 | tpr=0.0037 | fpr=0.0092 | 4118.5 samples/s | 16.1 steps/s
Avg test loss: 5.22199, Avg test acc: 0.31180, Avg tpr: 0.00309, Avg fpr: 0.00923, total FA: 72

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.95312 | acc=0.1288 | tpr=0.9204 | fpr=0.8854 | 4188.3 samples/s | 16.4 steps/s
[Step= 100] | Loss=7.90858 | acc=0.1307 | tpr=0.8998 | fpr=0.8836 | 7787.4 samples/s | 30.4 steps/s
[Step= 150] | Loss=7.93500 | acc=0.1295 | tpr=0.8905 | fpr=0.8845 | 8088.1 samples/s | 31.6 steps/s
[Step= 200] | Loss=7.92444 | acc=0.1301 | tpr=0.8907 | fpr=0.8837 | 7211.2 samples/s | 28.2 steps/s
[Step= 250] | Loss=7.92023 | acc=0.1308 | tpr=0.8865 | fpr=0.8830 | 8065.8 samples/s | 31.5 steps/s
[Step= 300] | Loss=7.92260 | acc=0.1307 | tpr=0.8851 | fpr=0.8831 | 7850.3 samples/s | 30.7 steps/s
[Step= 350] | Loss=7.91637 | acc=0.1306 | tpr=0.8898 | fpr=0.8832 | 7742.2 samples/s | 30.2 steps/s
[Step= 400] | Loss=7.91743 | acc=0.1306 | tpr=0.8895 | fpr=0.8832 | 7827.8 samples/s | 30.6 steps/s
[Step= 450] | Loss=7.92353 | acc=0.1308 | tpr=0.8895 | fpr=0.8829 | 7648.4 samples/s | 29.9 steps/s
[Step= 500] | Loss=7.92796 | acc=0.1304 | tpr=0.8921 | fpr=0.8833 | 7915.9 samples/s | 30.9 steps/s
[Step= 550] | Loss=7.92964 | acc=0.1304 | tpr=0.8930 | fpr=0.8835 | 14394.1 samples/s | 56.2 steps/s
Avg test loss: 7.93090, Avg test acc: 0.13029, Avg tpr: 0.89303, Avg fpr: 0.88358, total FA: 122683

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10499 | acc=0.9822 | tpr=0.9690 | fpr=0.0176 | 4169.1 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.10860 | acc=0.9816 | tpr=0.9723 | fpr=0.0183 | 7794.5 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.11464 | acc=0.9808 | tpr=0.9726 | fpr=0.0190 | 7479.8 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.11619 | acc=0.9808 | tpr=0.9727 | fpr=0.0190 | 7838.1 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.11472 | acc=0.9809 | tpr=0.9712 | fpr=0.0189 | 7452.5 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.11663 | acc=0.9807 | tpr=0.9680 | fpr=0.0191 | 7732.6 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.11737 | acc=0.9804 | tpr=0.9687 | fpr=0.0194 | 7638.6 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.11870 | acc=0.9802 | tpr=0.9677 | fpr=0.0195 | 7433.0 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.12156 | acc=0.9798 | tpr=0.9669 | fpr=0.0200 | 7695.6 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.12118 | acc=0.9798 | tpr=0.9674 | fpr=0.0200 | 7709.8 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.12027 | acc=0.9799 | tpr=0.9666 | fpr=0.0198 | 14247.3 samples/s | 55.7 steps/s
Avg test loss: 0.12010, Avg test acc: 0.97994, Avg tpr: 0.96632, Avg fpr: 0.01981, total FA: 2751

server round 22/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00025, len=1
[Step=17601 Epoch=17.2] | Loss=0.00177 | Reg=0.00381 | acc=1.0000 | L2-Norm=19.525 | L2-Norm(final)=2.228 | 4384.3 samples/s | 68.5 steps/s
[Step=17650 Epoch=17.2] | Loss=0.00812 | Reg=0.00381 | acc=0.9844 | L2-Norm=19.522 | L2-Norm(final)=2.230 | 3945.8 samples/s | 61.7 steps/s
[Step=17700 Epoch=17.3] | Loss=0.00745 | Reg=0.00381 | acc=1.0000 | L2-Norm=19.520 | L2-Norm(final)=2.230 | 4446.2 samples/s | 69.5 steps/s
[Step=17750 Epoch=17.3] | Loss=0.00748 | Reg=0.00381 | acc=1.0000 | L2-Norm=19.519 | L2-Norm(final)=2.232 | 4453.5 samples/s | 69.6 steps/s
[Step=17800 Epoch=17.4] | Loss=0.00717 | Reg=0.00381 | acc=1.0000 | L2-Norm=19.516 | L2-Norm(final)=2.234 | 4392.6 samples/s | 68.6 steps/s
[Step=17850 Epoch=17.4] | Loss=0.00746 | Reg=0.00381 | acc=0.9844 | L2-Norm=19.514 | L2-Norm(final)=2.235 | 4370.7 samples/s | 68.3 steps/s
[Step=17900 Epoch=17.5] | Loss=0.00753 | Reg=0.00381 | acc=1.0000 | L2-Norm=19.511 | L2-Norm(final)=2.235 | 4385.3 samples/s | 68.5 steps/s
[Step=17950 Epoch=17.5] | Loss=0.00738 | Reg=0.00381 | acc=1.0000 | L2-Norm=19.508 | L2-Norm(final)=2.235 | 4322.1 samples/s | 67.5 steps/s
[Step=18000 Epoch=17.6] | Loss=0.00746 | Reg=0.00380 | acc=1.0000 | L2-Norm=19.505 | L2-Norm(final)=2.236 | 4350.1 samples/s | 68.0 steps/s
[Step=18050 Epoch=17.6] | Loss=0.00747 | Reg=0.00380 | acc=0.9688 | L2-Norm=19.502 | L2-Norm(final)=2.236 | 4329.2 samples/s | 67.6 steps/s
[Step=18100 Epoch=17.7] | Loss=0.00761 | Reg=0.00380 | acc=0.9844 | L2-Norm=19.499 | L2-Norm(final)=2.237 | 4337.5 samples/s | 67.8 steps/s
[Step=18150 Epoch=17.7] | Loss=0.00784 | Reg=0.00380 | acc=0.9844 | L2-Norm=19.497 | L2-Norm(final)=2.237 | 4382.5 samples/s | 68.5 steps/s
[Step=18200 Epoch=17.8] | Loss=0.00796 | Reg=0.00380 | acc=0.9844 | L2-Norm=19.494 | L2-Norm(final)=2.238 | 4345.9 samples/s | 67.9 steps/s
[Step=18250 Epoch=17.8] | Loss=0.00795 | Reg=0.00380 | acc=1.0000 | L2-Norm=19.491 | L2-Norm(final)=2.238 | 4303.5 samples/s | 67.2 steps/s
[Step=18300 Epoch=17.9] | Loss=0.00803 | Reg=0.00380 | acc=1.0000 | L2-Norm=19.489 | L2-Norm(final)=2.238 | 4348.8 samples/s | 68.0 steps/s
[Step=18350 Epoch=17.9] | Loss=0.00811 | Reg=0.00380 | acc=1.0000 | L2-Norm=19.486 | L2-Norm(final)=2.239 | 4371.1 samples/s | 68.3 steps/s
[Step=18400 Epoch=18.0] | Loss=0.00814 | Reg=0.00380 | acc=0.9844 | L2-Norm=19.483 | L2-Norm(final)=2.240 | 4331.4 samples/s | 67.7 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step18400.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00025, len=1
[Step=17601 Epoch=33.2] | Loss=0.00000 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.400 | L2-Norm(final)=3.343 | 4065.1 samples/s | 63.5 steps/s
[Step=17650 Epoch=33.3] | Loss=0.00000 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.393 | L2-Norm(final)=3.346 | 3909.6 samples/s | 61.1 steps/s
[Step=17700 Epoch=33.4] | Loss=0.00000 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.387 | L2-Norm(final)=3.349 | 4177.8 samples/s | 65.3 steps/s
[Step=17750 Epoch=33.5] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.381 | L2-Norm(final)=3.351 | 4151.6 samples/s | 64.9 steps/s
[Step=17800 Epoch=33.6] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.374 | L2-Norm(final)=3.354 | 4154.3 samples/s | 64.9 steps/s
[Step=17850 Epoch=33.6] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.368 | L2-Norm(final)=3.358 | 4261.1 samples/s | 66.6 steps/s
[Step=17900 Epoch=33.7] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.361 | L2-Norm(final)=3.361 | 4210.3 samples/s | 65.8 steps/s
[Step=17950 Epoch=33.8] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.354 | L2-Norm(final)=3.364 | 4186.0 samples/s | 65.4 steps/s
[Step=18000 Epoch=33.9] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.348 | L2-Norm(final)=3.368 | 4286.1 samples/s | 67.0 steps/s
[Step=18050 Epoch=34.0] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.341 | L2-Norm(final)=3.371 | 4335.8 samples/s | 67.7 steps/s
[Step=18100 Epoch=34.1] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.334 | L2-Norm(final)=3.375 | 4337.1 samples/s | 67.8 steps/s
[Step=18150 Epoch=34.2] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.327 | L2-Norm(final)=3.378 | 2101.3 samples/s | 32.8 steps/s
[Step=18200 Epoch=34.3] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.320 | L2-Norm(final)=3.381 | 4287.0 samples/s | 67.0 steps/s
[Step=18250 Epoch=34.4] | Loss=0.00000 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.313 | L2-Norm(final)=3.385 | 4260.0 samples/s | 66.6 steps/s
[Step=18300 Epoch=34.5] | Loss=0.00000 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.306 | L2-Norm(final)=3.388 | 4367.6 samples/s | 68.2 steps/s
[Step=18350 Epoch=34.6] | Loss=0.00000 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.298 | L2-Norm(final)=3.392 | 4292.7 samples/s | 67.1 steps/s
[Step=18400 Epoch=34.7] | Loss=0.00000 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.291 | L2-Norm(final)=3.395 | 4236.5 samples/s | 66.2 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step18400.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07651 | acc=0.9728 | tpr=0.9797 | fpr=0.0421 | 4232.0 samples/s | 16.5 steps/s
Avg test loss: 0.07854, Avg test acc: 0.97255, Avg tpr: 0.98065, Avg fpr: 0.04525, total FA: 353

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.02483 | acc=0.3143 | tpr=0.0043 | fpr=0.0126 | 4199.2 samples/s | 16.4 steps/s
Avg test loss: 5.04805, Avg test acc: 0.31148, Avg tpr: 0.00391, Avg fpr: 0.01205, total FA: 94

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.91043 | acc=0.1324 | tpr=0.9381 | fpr=0.8821 | 4184.8 samples/s | 16.3 steps/s
[Step= 100] | Loss=7.86051 | acc=0.1342 | tpr=0.9168 | fpr=0.8804 | 7803.5 samples/s | 30.5 steps/s
[Step= 150] | Loss=7.88305 | acc=0.1334 | tpr=0.9035 | fpr=0.8807 | 7741.6 samples/s | 30.2 steps/s
[Step= 200] | Loss=7.87459 | acc=0.1333 | tpr=0.9016 | fpr=0.8806 | 8277.6 samples/s | 32.3 steps/s
[Step= 250] | Loss=7.86844 | acc=0.1338 | tpr=0.8961 | fpr=0.8801 | 7443.8 samples/s | 29.1 steps/s
[Step= 300] | Loss=7.87017 | acc=0.1336 | tpr=0.8960 | fpr=0.8803 | 7431.2 samples/s | 29.0 steps/s
[Step= 350] | Loss=7.86437 | acc=0.1334 | tpr=0.9011 | fpr=0.8806 | 7548.5 samples/s | 29.5 steps/s
[Step= 400] | Loss=7.86634 | acc=0.1335 | tpr=0.8999 | fpr=0.8805 | 8575.3 samples/s | 33.5 steps/s
[Step= 450] | Loss=7.87350 | acc=0.1337 | tpr=0.9012 | fpr=0.8802 | 7117.5 samples/s | 27.8 steps/s
[Step= 500] | Loss=7.87757 | acc=0.1331 | tpr=0.9022 | fpr=0.8808 | 7239.3 samples/s | 28.3 steps/s
[Step= 550] | Loss=7.87905 | acc=0.1330 | tpr=0.9013 | fpr=0.8810 | 14234.5 samples/s | 55.6 steps/s
Avg test loss: 7.88046, Avg test acc: 0.13285, Avg tpr: 0.90135, Avg fpr: 0.88112, total FA: 122342

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11312 | acc=0.9816 | tpr=0.9690 | fpr=0.0181 | 4227.1 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.11691 | acc=0.9809 | tpr=0.9723 | fpr=0.0190 | 7742.5 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.12345 | acc=0.9799 | tpr=0.9726 | fpr=0.0200 | 7634.1 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.12501 | acc=0.9800 | tpr=0.9738 | fpr=0.0199 | 7156.1 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.12339 | acc=0.9802 | tpr=0.9729 | fpr=0.0197 | 7749.8 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.12534 | acc=0.9799 | tpr=0.9709 | fpr=0.0199 | 7275.0 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.12616 | acc=0.9796 | tpr=0.9712 | fpr=0.0203 | 7215.6 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.12756 | acc=0.9794 | tpr=0.9705 | fpr=0.0204 | 7274.2 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.13061 | acc=0.9790 | tpr=0.9703 | fpr=0.0208 | 7318.6 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.13023 | acc=0.9790 | tpr=0.9705 | fpr=0.0209 | 7415.6 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.12923 | acc=0.9791 | tpr=0.9698 | fpr=0.0207 | 13562.0 samples/s | 53.0 steps/s
Avg test loss: 0.12904, Avg test acc: 0.97913, Avg tpr: 0.96989, Avg fpr: 0.02070, total FA: 2874

server round 23/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00025, len=1
[Step=18401 Epoch=18.0] | Loss=0.00012 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.443 | L2-Norm(final)=2.252 | 4520.1 samples/s | 70.6 steps/s
[Step=18450 Epoch=18.0] | Loss=0.00614 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.442 | L2-Norm(final)=2.255 | 4019.7 samples/s | 62.8 steps/s
[Step=18500 Epoch=18.1] | Loss=0.00657 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.440 | L2-Norm(final)=2.257 | 4609.3 samples/s | 72.0 steps/s
[Step=18550 Epoch=18.1] | Loss=0.00656 | Reg=0.00378 | acc=0.9844 | L2-Norm=19.439 | L2-Norm(final)=2.259 | 4499.8 samples/s | 70.3 steps/s
[Step=18600 Epoch=18.2] | Loss=0.00631 | Reg=0.00378 | acc=0.9844 | L2-Norm=19.439 | L2-Norm(final)=2.261 | 4419.5 samples/s | 69.1 steps/s
[Step=18650 Epoch=18.2] | Loss=0.00646 | Reg=0.00378 | acc=0.9844 | L2-Norm=19.437 | L2-Norm(final)=2.262 | 4532.3 samples/s | 70.8 steps/s
[Step=18700 Epoch=18.3] | Loss=0.00632 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.435 | L2-Norm(final)=2.264 | 4499.1 samples/s | 70.3 steps/s
[Step=18750 Epoch=18.3] | Loss=0.00677 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.433 | L2-Norm(final)=2.265 | 4617.0 samples/s | 72.1 steps/s
[Step=18800 Epoch=18.4] | Loss=0.00708 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.431 | L2-Norm(final)=2.266 | 4533.3 samples/s | 70.8 steps/s
[Step=18850 Epoch=18.4] | Loss=0.00708 | Reg=0.00377 | acc=1.0000 | L2-Norm=19.428 | L2-Norm(final)=2.267 | 4554.0 samples/s | 71.2 steps/s
[Step=18900 Epoch=18.5] | Loss=0.00722 | Reg=0.00377 | acc=1.0000 | L2-Norm=19.426 | L2-Norm(final)=2.268 | 4512.2 samples/s | 70.5 steps/s
[Step=18950 Epoch=18.5] | Loss=0.00736 | Reg=0.00377 | acc=1.0000 | L2-Norm=19.424 | L2-Norm(final)=2.268 | 4504.0 samples/s | 70.4 steps/s
[Step=19000 Epoch=18.6] | Loss=0.00735 | Reg=0.00377 | acc=1.0000 | L2-Norm=19.423 | L2-Norm(final)=2.269 | 4441.8 samples/s | 69.4 steps/s
[Step=19050 Epoch=18.6] | Loss=0.00753 | Reg=0.00377 | acc=1.0000 | L2-Norm=19.421 | L2-Norm(final)=2.270 | 4557.6 samples/s | 71.2 steps/s
[Step=19100 Epoch=18.6] | Loss=0.00752 | Reg=0.00377 | acc=1.0000 | L2-Norm=19.419 | L2-Norm(final)=2.270 | 4627.2 samples/s | 72.3 steps/s
[Step=19150 Epoch=18.7] | Loss=0.00773 | Reg=0.00377 | acc=0.9844 | L2-Norm=19.417 | L2-Norm(final)=2.271 | 4495.0 samples/s | 70.2 steps/s
[Step=19200 Epoch=18.7] | Loss=0.00772 | Reg=0.00377 | acc=1.0000 | L2-Norm=19.415 | L2-Norm(final)=2.271 | 4480.3 samples/s | 70.0 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step19200.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00025, len=1
[Step=18401 Epoch=34.7] | Loss=0.00005 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.173 | L2-Norm(final)=3.454 | 4250.7 samples/s | 66.4 steps/s
[Step=18450 Epoch=34.8] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.166 | L2-Norm(final)=3.457 | 3694.0 samples/s | 57.7 steps/s
[Step=18500 Epoch=34.9] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.157 | L2-Norm(final)=3.461 | 4277.3 samples/s | 66.8 steps/s
[Step=18550 Epoch=35.0] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.148 | L2-Norm(final)=3.465 | 4332.8 samples/s | 67.7 steps/s
[Step=18600 Epoch=35.1] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.140 | L2-Norm(final)=3.469 | 4239.6 samples/s | 66.2 steps/s
[Step=18650 Epoch=35.2] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.131 | L2-Norm(final)=3.472 | 4328.5 samples/s | 67.6 steps/s
[Step=18700 Epoch=35.2] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.123 | L2-Norm(final)=3.477 | 4209.7 samples/s | 65.8 steps/s
[Step=18750 Epoch=35.3] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.114 | L2-Norm(final)=3.481 | 4310.6 samples/s | 67.4 steps/s
[Step=18800 Epoch=35.4] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.106 | L2-Norm(final)=3.486 | 4337.7 samples/s | 67.8 steps/s
[Step=18850 Epoch=35.5] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.097 | L2-Norm(final)=3.490 | 4369.6 samples/s | 68.3 steps/s
[Step=18900 Epoch=35.6] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.088 | L2-Norm(final)=3.494 | 4284.5 samples/s | 66.9 steps/s
[Step=18950 Epoch=35.7] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.080 | L2-Norm(final)=3.499 | 2067.9 samples/s | 32.3 steps/s
[Step=19000 Epoch=35.8] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.071 | L2-Norm(final)=3.504 | 4362.3 samples/s | 68.2 steps/s
[Step=19050 Epoch=35.9] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.062 | L2-Norm(final)=3.508 | 4299.2 samples/s | 67.2 steps/s
[Step=19100 Epoch=36.0] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.053 | L2-Norm(final)=3.513 | 4360.7 samples/s | 68.1 steps/s
[Step=19150 Epoch=36.1] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.044 | L2-Norm(final)=3.518 | 4179.4 samples/s | 65.3 steps/s
[Step=19200 Epoch=36.2] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.035 | L2-Norm(final)=3.523 | 3943.0 samples/s | 61.6 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step19200.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07734 | acc=0.9720 | tpr=0.9788 | fpr=0.0426 | 4192.4 samples/s | 16.4 steps/s
Avg test loss: 0.08043, Avg test acc: 0.97147, Avg tpr: 0.97867, Avg fpr: 0.04435, total FA: 346

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.94636 | acc=0.3143 | tpr=0.0042 | fpr=0.0124 | 4183.6 samples/s | 16.3 steps/s
Avg test loss: 4.96871, Avg test acc: 0.31152, Avg tpr: 0.00385, Avg fpr: 0.01179, total FA: 92

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.77158 | acc=0.1364 | tpr=0.9336 | fpr=0.8779 | 4119.4 samples/s | 16.1 steps/s
[Step= 100] | Loss=7.71983 | acc=0.1393 | tpr=0.9083 | fpr=0.8750 | 7829.1 samples/s | 30.6 steps/s
[Step= 150] | Loss=7.73995 | acc=0.1384 | tpr=0.8977 | fpr=0.8756 | 7802.8 samples/s | 30.5 steps/s
[Step= 200] | Loss=7.72708 | acc=0.1388 | tpr=0.9027 | fpr=0.8751 | 7532.7 samples/s | 29.4 steps/s
[Step= 250] | Loss=7.72358 | acc=0.1393 | tpr=0.8969 | fpr=0.8745 | 7875.4 samples/s | 30.8 steps/s
[Step= 300] | Loss=7.72520 | acc=0.1394 | tpr=0.8953 | fpr=0.8744 | 7430.3 samples/s | 29.0 steps/s
[Step= 350] | Loss=7.71815 | acc=0.1390 | tpr=0.8992 | fpr=0.8748 | 7342.6 samples/s | 28.7 steps/s
[Step= 400] | Loss=7.71954 | acc=0.1393 | tpr=0.8966 | fpr=0.8745 | 7781.8 samples/s | 30.4 steps/s
[Step= 450] | Loss=7.72521 | acc=0.1396 | tpr=0.8982 | fpr=0.8742 | 7128.2 samples/s | 27.8 steps/s
[Step= 500] | Loss=7.72858 | acc=0.1390 | tpr=0.9000 | fpr=0.8747 | 7322.1 samples/s | 28.6 steps/s
[Step= 550] | Loss=7.72910 | acc=0.1390 | tpr=0.8997 | fpr=0.8748 | 13403.2 samples/s | 52.4 steps/s
Avg test loss: 7.73076, Avg test acc: 0.13889, Avg tpr: 0.89937, Avg fpr: 0.87494, total FA: 121483

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11537 | acc=0.9815 | tpr=0.9690 | fpr=0.0183 | 4098.6 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.11918 | acc=0.9809 | tpr=0.9723 | fpr=0.0190 | 7358.4 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.12595 | acc=0.9799 | tpr=0.9726 | fpr=0.0199 | 7264.1 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.12753 | acc=0.9799 | tpr=0.9738 | fpr=0.0199 | 8107.0 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.12581 | acc=0.9801 | tpr=0.9738 | fpr=0.0197 | 7549.2 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.12774 | acc=0.9800 | tpr=0.9716 | fpr=0.0199 | 7406.4 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.12854 | acc=0.9796 | tpr=0.9724 | fpr=0.0202 | 7881.8 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.12996 | acc=0.9795 | tpr=0.9710 | fpr=0.0204 | 7715.9 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.13307 | acc=0.9791 | tpr=0.9708 | fpr=0.0208 | 7739.6 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.13264 | acc=0.9790 | tpr=0.9709 | fpr=0.0208 | 7629.7 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.13162 | acc=0.9792 | tpr=0.9706 | fpr=0.0206 | 13814.9 samples/s | 54.0 steps/s
Avg test loss: 0.13141, Avg test acc: 0.97923, Avg tpr: 0.97029, Avg fpr: 0.02061, total FA: 2861

server round 24/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00025, len=1
[Step=19201 Epoch=18.7] | Loss=0.01521 | Reg=0.00376 | acc=0.9844 | L2-Norm=19.384 | L2-Norm(final)=2.281 | 4546.0 samples/s | 71.0 steps/s
[Step=19250 Epoch=18.8] | Loss=0.00807 | Reg=0.00376 | acc=0.9688 | L2-Norm=19.382 | L2-Norm(final)=2.284 | 4132.6 samples/s | 64.6 steps/s
[Step=19300 Epoch=18.8] | Loss=0.00848 | Reg=0.00376 | acc=1.0000 | L2-Norm=19.380 | L2-Norm(final)=2.284 | 4519.8 samples/s | 70.6 steps/s
[Step=19350 Epoch=18.9] | Loss=0.00783 | Reg=0.00376 | acc=1.0000 | L2-Norm=19.379 | L2-Norm(final)=2.285 | 4228.3 samples/s | 66.1 steps/s
[Step=19400 Epoch=18.9] | Loss=0.00722 | Reg=0.00375 | acc=0.9844 | L2-Norm=19.377 | L2-Norm(final)=2.287 | 4296.9 samples/s | 67.1 steps/s
[Step=19450 Epoch=19.0] | Loss=0.00708 | Reg=0.00375 | acc=1.0000 | L2-Norm=19.376 | L2-Norm(final)=2.289 | 4441.0 samples/s | 69.4 steps/s
[Step=19500 Epoch=19.0] | Loss=0.00699 | Reg=0.00375 | acc=1.0000 | L2-Norm=19.374 | L2-Norm(final)=2.290 | 4581.0 samples/s | 71.6 steps/s
[Step=19550 Epoch=19.1] | Loss=0.00706 | Reg=0.00375 | acc=0.9844 | L2-Norm=19.372 | L2-Norm(final)=2.291 | 4649.3 samples/s | 72.6 steps/s
[Step=19600 Epoch=19.1] | Loss=0.00724 | Reg=0.00375 | acc=1.0000 | L2-Norm=19.369 | L2-Norm(final)=2.292 | 4520.4 samples/s | 70.6 steps/s
[Step=19650 Epoch=19.2] | Loss=0.00725 | Reg=0.00375 | acc=1.0000 | L2-Norm=19.367 | L2-Norm(final)=2.293 | 4337.3 samples/s | 67.8 steps/s
[Step=19700 Epoch=19.2] | Loss=0.00724 | Reg=0.00375 | acc=0.9844 | L2-Norm=19.365 | L2-Norm(final)=2.293 | 4484.9 samples/s | 70.1 steps/s
[Step=19750 Epoch=19.3] | Loss=0.00720 | Reg=0.00375 | acc=1.0000 | L2-Norm=19.363 | L2-Norm(final)=2.294 | 4483.4 samples/s | 70.1 steps/s
[Step=19800 Epoch=19.3] | Loss=0.00734 | Reg=0.00375 | acc=0.9688 | L2-Norm=19.361 | L2-Norm(final)=2.295 | 4600.2 samples/s | 71.9 steps/s
[Step=19850 Epoch=19.4] | Loss=0.00735 | Reg=0.00375 | acc=1.0000 | L2-Norm=19.359 | L2-Norm(final)=2.295 | 4553.4 samples/s | 71.1 steps/s
[Step=19900 Epoch=19.4] | Loss=0.00728 | Reg=0.00375 | acc=1.0000 | L2-Norm=19.357 | L2-Norm(final)=2.296 | 4568.3 samples/s | 71.4 steps/s
[Step=19950 Epoch=19.5] | Loss=0.00733 | Reg=0.00375 | acc=1.0000 | L2-Norm=19.355 | L2-Norm(final)=2.296 | 4536.9 samples/s | 70.9 steps/s
[Step=20000 Epoch=19.5] | Loss=0.00762 | Reg=0.00375 | acc=0.9844 | L2-Norm=19.352 | L2-Norm(final)=2.297 | 4610.8 samples/s | 72.0 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step20000.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00025, len=1
[Step=19201 Epoch=36.2] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.891 | L2-Norm(final)=3.603 | 4272.1 samples/s | 66.8 steps/s
[Step=19250 Epoch=36.3] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.880 | L2-Norm(final)=3.607 | 4104.0 samples/s | 64.1 steps/s
[Step=19300 Epoch=36.4] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.869 | L2-Norm(final)=3.611 | 4335.3 samples/s | 67.7 steps/s
[Step=19350 Epoch=36.5] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.858 | L2-Norm(final)=3.616 | 4237.3 samples/s | 66.2 steps/s
[Step=19400 Epoch=36.6] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.848 | L2-Norm(final)=3.622 | 4235.9 samples/s | 66.2 steps/s
[Step=19450 Epoch=36.7] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.837 | L2-Norm(final)=3.627 | 4196.3 samples/s | 65.6 steps/s
[Step=19500 Epoch=36.8] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.827 | L2-Norm(final)=3.632 | 4260.5 samples/s | 66.6 steps/s
[Step=19550 Epoch=36.9] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.816 | L2-Norm(final)=3.637 | 4378.1 samples/s | 68.4 steps/s
[Step=19600 Epoch=36.9] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.805 | L2-Norm(final)=3.642 | 4114.9 samples/s | 64.3 steps/s
[Step=19650 Epoch=37.0] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.795 | L2-Norm(final)=3.648 | 4174.3 samples/s | 65.2 steps/s
[Step=19700 Epoch=37.1] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.786 | L2-Norm(final)=3.654 | 4326.5 samples/s | 67.6 steps/s
[Step=19750 Epoch=37.2] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.777 | L2-Norm(final)=3.660 | 2066.1 samples/s | 32.3 steps/s
[Step=19800 Epoch=37.3] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.767 | L2-Norm(final)=3.666 | 4297.4 samples/s | 67.1 steps/s
[Step=19850 Epoch=37.4] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.757 | L2-Norm(final)=3.672 | 4213.5 samples/s | 65.8 steps/s
[Step=19900 Epoch=37.5] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.746 | L2-Norm(final)=3.677 | 4141.7 samples/s | 64.7 steps/s
[Step=19950 Epoch=37.6] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.735 | L2-Norm(final)=3.682 | 4212.7 samples/s | 65.8 steps/s
[Step=20000 Epoch=37.7] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.724 | L2-Norm(final)=3.687 | 4083.7 samples/s | 63.8 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step20000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07486 | acc=0.9728 | tpr=0.9789 | fpr=0.0404 | 4148.5 samples/s | 16.2 steps/s
Avg test loss: 0.07652, Avg test acc: 0.97203, Avg tpr: 0.97861, Avg fpr: 0.04243, total FA: 331

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.94164 | acc=0.3146 | tpr=0.0032 | fpr=0.0092 | 4047.2 samples/s | 15.8 steps/s
Avg test loss: 4.96410, Avg test acc: 0.31180, Avg tpr: 0.00309, Avg fpr: 0.00923, total FA: 72

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.26186 | acc=0.1368 | tpr=0.8982 | fpr=0.8769 | 4016.7 samples/s | 15.7 steps/s
[Step= 100] | Loss=7.20738 | acc=0.1384 | tpr=0.8913 | fpr=0.8757 | 7399.7 samples/s | 28.9 steps/s
[Step= 150] | Loss=7.22836 | acc=0.1378 | tpr=0.8862 | fpr=0.8760 | 7327.0 samples/s | 28.6 steps/s
[Step= 200] | Loss=7.21555 | acc=0.1387 | tpr=0.8896 | fpr=0.8750 | 7170.2 samples/s | 28.0 steps/s
[Step= 250] | Loss=7.21058 | acc=0.1392 | tpr=0.8856 | fpr=0.8744 | 7395.0 samples/s | 28.9 steps/s
[Step= 300] | Loss=7.21269 | acc=0.1391 | tpr=0.8873 | fpr=0.8745 | 7468.7 samples/s | 29.2 steps/s
[Step= 350] | Loss=7.20555 | acc=0.1389 | tpr=0.8892 | fpr=0.8747 | 7634.5 samples/s | 29.8 steps/s
[Step= 400] | Loss=7.20729 | acc=0.1395 | tpr=0.8868 | fpr=0.8741 | 7152.4 samples/s | 27.9 steps/s
[Step= 450] | Loss=7.21184 | acc=0.1398 | tpr=0.8866 | fpr=0.8738 | 7986.9 samples/s | 31.2 steps/s
[Step= 500] | Loss=7.21337 | acc=0.1393 | tpr=0.8885 | fpr=0.8742 | 7259.1 samples/s | 28.4 steps/s
[Step= 550] | Loss=7.21395 | acc=0.1393 | tpr=0.8898 | fpr=0.8744 | 14812.1 samples/s | 57.9 steps/s
Avg test loss: 7.21525, Avg test acc: 0.13917, Avg tpr: 0.88986, Avg fpr: 0.87447, total FA: 121419

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10764 | acc=0.9824 | tpr=0.9690 | fpr=0.0173 | 4213.5 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.11099 | acc=0.9818 | tpr=0.9723 | fpr=0.0181 | 7774.5 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.11743 | acc=0.9811 | tpr=0.9741 | fpr=0.0188 | 7544.0 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.11893 | acc=0.9812 | tpr=0.9749 | fpr=0.0187 | 7774.9 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.11711 | acc=0.9813 | tpr=0.9729 | fpr=0.0185 | 7904.0 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.11901 | acc=0.9810 | tpr=0.9716 | fpr=0.0188 | 7849.5 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.11963 | acc=0.9807 | tpr=0.9718 | fpr=0.0191 | 7950.9 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.12098 | acc=0.9805 | tpr=0.9699 | fpr=0.0193 | 7655.1 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.12389 | acc=0.9802 | tpr=0.9693 | fpr=0.0196 | 7420.4 samples/s | 29.0 steps/s
[Step= 500] | Loss=0.12343 | acc=0.9801 | tpr=0.9696 | fpr=0.0197 | 7887.7 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.12249 | acc=0.9803 | tpr=0.9690 | fpr=0.0195 | 13757.4 samples/s | 53.7 steps/s
Avg test loss: 0.12229, Avg test acc: 0.98031, Avg tpr: 0.96870, Avg fpr: 0.01948, total FA: 2705

server round 25/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00025, len=1
[Step=20001 Epoch=19.5] | Loss=0.00224 | Reg=0.00373 | acc=1.0000 | L2-Norm=19.315 | L2-Norm(final)=2.305 | 4141.5 samples/s | 64.7 steps/s
[Step=20050 Epoch=19.6] | Loss=0.00599 | Reg=0.00373 | acc=1.0000 | L2-Norm=19.314 | L2-Norm(final)=2.307 | 4026.9 samples/s | 62.9 steps/s
[Step=20100 Epoch=19.6] | Loss=0.00677 | Reg=0.00373 | acc=1.0000 | L2-Norm=19.313 | L2-Norm(final)=2.311 | 4436.9 samples/s | 69.3 steps/s
[Step=20150 Epoch=19.7] | Loss=0.00640 | Reg=0.00373 | acc=0.9844 | L2-Norm=19.311 | L2-Norm(final)=2.313 | 4259.4 samples/s | 66.6 steps/s
[Step=20200 Epoch=19.7] | Loss=0.00626 | Reg=0.00373 | acc=1.0000 | L2-Norm=19.309 | L2-Norm(final)=2.315 | 4401.4 samples/s | 68.8 steps/s
[Step=20250 Epoch=19.8] | Loss=0.00615 | Reg=0.00373 | acc=0.9844 | L2-Norm=19.307 | L2-Norm(final)=2.316 | 4432.4 samples/s | 69.3 steps/s
[Step=20300 Epoch=19.8] | Loss=0.00661 | Reg=0.00373 | acc=0.9688 | L2-Norm=19.306 | L2-Norm(final)=2.318 | 4379.0 samples/s | 68.4 steps/s
[Step=20350 Epoch=19.9] | Loss=0.00649 | Reg=0.00373 | acc=1.0000 | L2-Norm=19.304 | L2-Norm(final)=2.319 | 4360.7 samples/s | 68.1 steps/s
[Step=20400 Epoch=19.9] | Loss=0.00653 | Reg=0.00373 | acc=1.0000 | L2-Norm=19.302 | L2-Norm(final)=2.320 | 4419.7 samples/s | 69.1 steps/s
[Step=20450 Epoch=20.0] | Loss=0.00680 | Reg=0.00372 | acc=0.9844 | L2-Norm=19.300 | L2-Norm(final)=2.321 | 4394.5 samples/s | 68.7 steps/s
[Step=20500 Epoch=20.0] | Loss=0.00696 | Reg=0.00372 | acc=0.9844 | L2-Norm=19.298 | L2-Norm(final)=2.321 | 4401.7 samples/s | 68.8 steps/s
[Step=20550 Epoch=20.1] | Loss=0.00712 | Reg=0.00372 | acc=1.0000 | L2-Norm=19.296 | L2-Norm(final)=2.322 | 4317.1 samples/s | 67.5 steps/s
[Step=20600 Epoch=20.1] | Loss=0.00710 | Reg=0.00372 | acc=1.0000 | L2-Norm=19.294 | L2-Norm(final)=2.322 | 4279.2 samples/s | 66.9 steps/s
[Step=20650 Epoch=20.2] | Loss=0.00734 | Reg=0.00372 | acc=1.0000 | L2-Norm=19.292 | L2-Norm(final)=2.323 | 4384.7 samples/s | 68.5 steps/s
[Step=20700 Epoch=20.2] | Loss=0.00734 | Reg=0.00372 | acc=0.9844 | L2-Norm=19.290 | L2-Norm(final)=2.323 | 4403.4 samples/s | 68.8 steps/s
[Step=20750 Epoch=20.3] | Loss=0.00732 | Reg=0.00372 | acc=0.9844 | L2-Norm=19.288 | L2-Norm(final)=2.323 | 4393.4 samples/s | 68.6 steps/s
[Step=20800 Epoch=20.3] | Loss=0.00734 | Reg=0.00372 | acc=1.0000 | L2-Norm=19.286 | L2-Norm(final)=2.323 | 4479.6 samples/s | 70.0 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step20800.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00025, len=1
[Step=20001 Epoch=37.7] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.544 | L2-Norm(final)=3.768 | 4230.6 samples/s | 66.1 steps/s
[Step=20050 Epoch=37.8] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.534 | L2-Norm(final)=3.775 | 3645.8 samples/s | 57.0 steps/s
[Step=20100 Epoch=37.9] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.520 | L2-Norm(final)=3.780 | 4332.8 samples/s | 67.7 steps/s
[Step=20150 Epoch=38.0] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.508 | L2-Norm(final)=3.785 | 4245.8 samples/s | 66.3 steps/s
[Step=20200 Epoch=38.1] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.495 | L2-Norm(final)=3.790 | 4092.4 samples/s | 63.9 steps/s
[Step=20250 Epoch=38.2] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.482 | L2-Norm(final)=3.795 | 4255.2 samples/s | 66.5 steps/s
[Step=20300 Epoch=38.3] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.469 | L2-Norm(final)=3.801 | 4108.3 samples/s | 64.2 steps/s
[Step=20350 Epoch=38.4] | Loss=0.00024 | Reg=0.00042 | acc=0.9844 | L2-Norm=6.471 | L2-Norm(final)=3.808 | 4125.1 samples/s | 64.5 steps/s
[Step=20400 Epoch=38.5] | Loss=0.00079 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.495 | L2-Norm(final)=3.810 | 4151.5 samples/s | 64.9 steps/s
[Step=20450 Epoch=38.5] | Loss=0.00088 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.525 | L2-Norm(final)=3.810 | 4200.1 samples/s | 65.6 steps/s
[Step=20500 Epoch=38.6] | Loss=0.00082 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.551 | L2-Norm(final)=3.811 | 4243.9 samples/s | 66.3 steps/s
[Step=20550 Epoch=38.7] | Loss=0.00075 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.572 | L2-Norm(final)=3.812 | 2071.3 samples/s | 32.4 steps/s
[Step=20600 Epoch=38.8] | Loss=0.00069 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.590 | L2-Norm(final)=3.813 | 4168.3 samples/s | 65.1 steps/s
[Step=20650 Epoch=38.9] | Loss=0.00064 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.605 | L2-Norm(final)=3.815 | 4090.8 samples/s | 63.9 steps/s
[Step=20700 Epoch=39.0] | Loss=0.00060 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.618 | L2-Norm(final)=3.816 | 4019.7 samples/s | 62.8 steps/s
[Step=20750 Epoch=39.1] | Loss=0.00056 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.628 | L2-Norm(final)=3.818 | 4104.8 samples/s | 64.1 steps/s
[Step=20800 Epoch=39.2] | Loss=0.00053 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.638 | L2-Norm(final)=3.820 | 4110.9 samples/s | 64.2 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step20800.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07813 | acc=0.9731 | tpr=0.9771 | fpr=0.0354 | 4026.2 samples/s | 15.7 steps/s
Avg test loss: 0.08304, Avg test acc: 0.97187, Avg tpr: 0.97587, Avg fpr: 0.03692, total FA: 288

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.55317 | acc=0.3127 | tpr=0.0014 | fpr=0.0111 | 4101.6 samples/s | 16.0 steps/s
Avg test loss: 4.57441, Avg test acc: 0.30980, Avg tpr: 0.00146, Avg fpr: 0.01205, total FA: 94

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.89343 | acc=0.1366 | tpr=0.8850 | fpr=0.8768 | 4241.2 samples/s | 16.6 steps/s
[Step= 100] | Loss=7.84317 | acc=0.1392 | tpr=0.8763 | fpr=0.8745 | 7555.0 samples/s | 29.5 steps/s
[Step= 150] | Loss=7.86542 | acc=0.1382 | tpr=0.8703 | fpr=0.8753 | 7977.0 samples/s | 31.2 steps/s
[Step= 200] | Loss=7.85196 | acc=0.1382 | tpr=0.8689 | fpr=0.8751 | 7580.1 samples/s | 29.6 steps/s
[Step= 250] | Loss=7.84716 | acc=0.1389 | tpr=0.8681 | fpr=0.8744 | 7985.9 samples/s | 31.2 steps/s
[Step= 300] | Loss=7.85221 | acc=0.1384 | tpr=0.8684 | fpr=0.8749 | 7470.3 samples/s | 29.2 steps/s
[Step= 350] | Loss=7.84299 | acc=0.1381 | tpr=0.8723 | fpr=0.8752 | 7823.1 samples/s | 30.6 steps/s
[Step= 400] | Loss=7.84383 | acc=0.1383 | tpr=0.8698 | fpr=0.8750 | 8130.1 samples/s | 31.8 steps/s
[Step= 450] | Loss=7.84824 | acc=0.1385 | tpr=0.8700 | fpr=0.8748 | 7628.1 samples/s | 29.8 steps/s
[Step= 500] | Loss=7.85174 | acc=0.1380 | tpr=0.8727 | fpr=0.8752 | 7409.5 samples/s | 28.9 steps/s
[Step= 550] | Loss=7.85272 | acc=0.1378 | tpr=0.8719 | fpr=0.8755 | 14717.1 samples/s | 57.5 steps/s
Avg test loss: 7.85467, Avg test acc: 0.13768, Avg tpr: 0.87163, Avg fpr: 0.87566, total FA: 121584

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09623 | acc=0.9822 | tpr=0.9646 | fpr=0.0175 | 4160.3 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.10050 | acc=0.9814 | tpr=0.9701 | fpr=0.0184 | 8033.7 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.10580 | acc=0.9803 | tpr=0.9712 | fpr=0.0195 | 8175.3 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.10721 | acc=0.9804 | tpr=0.9716 | fpr=0.0194 | 7178.0 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.10563 | acc=0.9807 | tpr=0.9712 | fpr=0.0192 | 7583.6 samples/s | 29.6 steps/s
[Step= 300] | Loss=0.10745 | acc=0.9803 | tpr=0.9695 | fpr=0.0195 | 7743.6 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.10796 | acc=0.9802 | tpr=0.9706 | fpr=0.0196 | 7280.4 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.10950 | acc=0.9799 | tpr=0.9688 | fpr=0.0199 | 7768.1 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.11190 | acc=0.9796 | tpr=0.9679 | fpr=0.0202 | 7596.2 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.11191 | acc=0.9795 | tpr=0.9678 | fpr=0.0203 | 7408.4 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.11102 | acc=0.9797 | tpr=0.9666 | fpr=0.0201 | 13712.0 samples/s | 53.6 steps/s
Avg test loss: 0.11077, Avg test acc: 0.97966, Avg tpr: 0.96632, Avg fpr: 0.02009, total FA: 2790

server round 26/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00025, len=1
[Step=20801 Epoch=20.3] | Loss=0.00120 | Reg=0.00371 | acc=1.0000 | L2-Norm=19.255 | L2-Norm(final)=2.329 | 3865.3 samples/s | 60.4 steps/s
[Step=20850 Epoch=20.4] | Loss=0.00656 | Reg=0.00371 | acc=0.9688 | L2-Norm=19.254 | L2-Norm(final)=2.330 | 4191.3 samples/s | 65.5 steps/s
[Step=20900 Epoch=20.4] | Loss=0.00683 | Reg=0.00371 | acc=0.9844 | L2-Norm=19.253 | L2-Norm(final)=2.329 | 4126.9 samples/s | 64.5 steps/s
[Step=20950 Epoch=20.5] | Loss=0.00762 | Reg=0.00371 | acc=1.0000 | L2-Norm=19.251 | L2-Norm(final)=2.329 | 4324.9 samples/s | 67.6 steps/s
[Step=21000 Epoch=20.5] | Loss=0.00707 | Reg=0.00371 | acc=0.9844 | L2-Norm=19.249 | L2-Norm(final)=2.330 | 4358.5 samples/s | 68.1 steps/s
[Step=21050 Epoch=20.6] | Loss=0.00711 | Reg=0.00370 | acc=0.9844 | L2-Norm=19.247 | L2-Norm(final)=2.331 | 4431.0 samples/s | 69.2 steps/s
[Step=21100 Epoch=20.6] | Loss=0.00699 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.245 | L2-Norm(final)=2.332 | 4435.6 samples/s | 69.3 steps/s
[Step=21150 Epoch=20.6] | Loss=0.00667 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.244 | L2-Norm(final)=2.333 | 4336.4 samples/s | 67.8 steps/s
[Step=21200 Epoch=20.7] | Loss=0.00699 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.242 | L2-Norm(final)=2.334 | 4370.3 samples/s | 68.3 steps/s
[Step=21250 Epoch=20.7] | Loss=0.00696 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.241 | L2-Norm(final)=2.335 | 4411.0 samples/s | 68.9 steps/s
[Step=21300 Epoch=20.8] | Loss=0.00702 | Reg=0.00370 | acc=0.9844 | L2-Norm=19.239 | L2-Norm(final)=2.336 | 4399.6 samples/s | 68.7 steps/s
[Step=21350 Epoch=20.8] | Loss=0.00712 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.238 | L2-Norm(final)=2.336 | 4390.2 samples/s | 68.6 steps/s
[Step=21400 Epoch=20.9] | Loss=0.00733 | Reg=0.00370 | acc=0.9688 | L2-Norm=19.236 | L2-Norm(final)=2.337 | 4436.2 samples/s | 69.3 steps/s
[Step=21450 Epoch=20.9] | Loss=0.00732 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.234 | L2-Norm(final)=2.337 | 4367.6 samples/s | 68.2 steps/s
[Step=21500 Epoch=21.0] | Loss=0.00742 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.232 | L2-Norm(final)=2.338 | 4267.9 samples/s | 66.7 steps/s
[Step=21550 Epoch=21.0] | Loss=0.00744 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.230 | L2-Norm(final)=2.339 | 4423.8 samples/s | 69.1 steps/s
[Step=21600 Epoch=21.1] | Loss=0.00753 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.229 | L2-Norm(final)=2.339 | 4316.1 samples/s | 67.4 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step21600.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00025, len=1
[Step=20801 Epoch=39.2] | Loss=0.00003 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.779 | L2-Norm(final)=3.845 | 4222.6 samples/s | 66.0 steps/s
[Step=20850 Epoch=39.3] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.777 | L2-Norm(final)=3.846 | 3691.6 samples/s | 57.7 steps/s
[Step=20900 Epoch=39.4] | Loss=0.00002 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.775 | L2-Norm(final)=3.847 | 4054.2 samples/s | 63.3 steps/s
[Step=20950 Epoch=39.5] | Loss=0.00003 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.776 | L2-Norm(final)=3.848 | 4046.1 samples/s | 63.2 steps/s
[Step=21000 Epoch=39.6] | Loss=0.00003 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.775 | L2-Norm(final)=3.849 | 4043.8 samples/s | 63.2 steps/s
[Step=21050 Epoch=39.7] | Loss=0.00002 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.773 | L2-Norm(final)=3.850 | 4094.5 samples/s | 64.0 steps/s
[Step=21100 Epoch=39.8] | Loss=0.00002 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.772 | L2-Norm(final)=3.851 | 4171.6 samples/s | 65.2 steps/s
[Step=21150 Epoch=39.9] | Loss=0.00002 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.770 | L2-Norm(final)=3.852 | 4106.0 samples/s | 64.2 steps/s
[Step=21200 Epoch=40.0] | Loss=0.00002 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.769 | L2-Norm(final)=3.853 | 4282.3 samples/s | 66.9 steps/s
[Step=21250 Epoch=40.1] | Loss=0.00002 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.767 | L2-Norm(final)=3.854 | 4365.6 samples/s | 68.2 steps/s
[Step=21300 Epoch=40.2] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.765 | L2-Norm(final)=3.854 | 4377.7 samples/s | 68.4 steps/s
[Step=21350 Epoch=40.2] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.763 | L2-Norm(final)=3.855 | 2069.6 samples/s | 32.3 steps/s
[Step=21400 Epoch=40.3] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.761 | L2-Norm(final)=3.856 | 4296.0 samples/s | 67.1 steps/s
[Step=21450 Epoch=40.4] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.759 | L2-Norm(final)=3.857 | 4284.1 samples/s | 66.9 steps/s
[Step=21500 Epoch=40.5] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.756 | L2-Norm(final)=3.857 | 4310.3 samples/s | 67.3 steps/s
[Step=21550 Epoch=40.6] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.754 | L2-Norm(final)=3.858 | 4279.1 samples/s | 66.9 steps/s
[Step=21600 Epoch=40.7] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.752 | L2-Norm(final)=3.859 | 4223.8 samples/s | 66.0 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step21600.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07773 | acc=0.9723 | tpr=0.9771 | fpr=0.0379 | 4394.8 samples/s | 17.2 steps/s
Avg test loss: 0.08016, Avg test acc: 0.97147, Avg tpr: 0.97634, Avg fpr: 0.03923, total FA: 306

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.95120 | acc=0.3128 | tpr=0.0019 | fpr=0.0121 | 4138.0 samples/s | 16.2 steps/s
Avg test loss: 4.97439, Avg test acc: 0.30992, Avg tpr: 0.00204, Avg fpr: 0.01295, total FA: 101

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.50035 | acc=0.1362 | tpr=0.8761 | fpr=0.8771 | 4355.6 samples/s | 17.0 steps/s
[Step= 100] | Loss=7.45052 | acc=0.1389 | tpr=0.8742 | fpr=0.8748 | 7354.9 samples/s | 28.7 steps/s
[Step= 150] | Loss=7.47501 | acc=0.1385 | tpr=0.8703 | fpr=0.8749 | 7491.4 samples/s | 29.3 steps/s
[Step= 200] | Loss=7.46321 | acc=0.1386 | tpr=0.8743 | fpr=0.8748 | 7858.9 samples/s | 30.7 steps/s
[Step= 250] | Loss=7.45736 | acc=0.1393 | tpr=0.8690 | fpr=0.8739 | 7687.3 samples/s | 30.0 steps/s
[Step= 300] | Loss=7.46139 | acc=0.1391 | tpr=0.8691 | fpr=0.8742 | 7875.9 samples/s | 30.8 steps/s
[Step= 350] | Loss=7.45114 | acc=0.1388 | tpr=0.8741 | fpr=0.8745 | 7322.8 samples/s | 28.6 steps/s
[Step= 400] | Loss=7.45193 | acc=0.1392 | tpr=0.8720 | fpr=0.8742 | 7544.5 samples/s | 29.5 steps/s
[Step= 450] | Loss=7.45842 | acc=0.1391 | tpr=0.8734 | fpr=0.8742 | 7591.7 samples/s | 29.7 steps/s
[Step= 500] | Loss=7.46054 | acc=0.1388 | tpr=0.8762 | fpr=0.8746 | 7373.1 samples/s | 28.8 steps/s
[Step= 550] | Loss=7.46133 | acc=0.1389 | tpr=0.8754 | fpr=0.8745 | 13899.6 samples/s | 54.3 steps/s
Avg test loss: 7.46287, Avg test acc: 0.13878, Avg tpr: 0.87559, Avg fpr: 0.87462, total FA: 121439

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11205 | acc=0.9819 | tpr=0.9646 | fpr=0.0178 | 4144.8 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.11720 | acc=0.9811 | tpr=0.9701 | fpr=0.0187 | 7909.9 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.12353 | acc=0.9799 | tpr=0.9741 | fpr=0.0200 | 7468.4 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.12505 | acc=0.9800 | tpr=0.9738 | fpr=0.0199 | 7769.7 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.12325 | acc=0.9802 | tpr=0.9729 | fpr=0.0196 | 7988.7 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.12538 | acc=0.9799 | tpr=0.9716 | fpr=0.0200 | 6991.1 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.12602 | acc=0.9797 | tpr=0.9724 | fpr=0.0201 | 7485.8 samples/s | 29.2 steps/s
[Step= 400] | Loss=0.12782 | acc=0.9795 | tpr=0.9705 | fpr=0.0204 | 7551.7 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.13060 | acc=0.9791 | tpr=0.9698 | fpr=0.0207 | 7508.1 samples/s | 29.3 steps/s
[Step= 500] | Loss=0.13062 | acc=0.9790 | tpr=0.9700 | fpr=0.0208 | 7427.6 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.12958 | acc=0.9792 | tpr=0.9690 | fpr=0.0206 | 14297.2 samples/s | 55.8 steps/s
Avg test loss: 0.12930, Avg test acc: 0.97920, Avg tpr: 0.96870, Avg fpr: 0.02061, total FA: 2862

server round 27/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00025, len=1
[Step=21601 Epoch=21.1] | Loss=0.00041 | Reg=0.00369 | acc=1.0000 | L2-Norm=19.204 | L2-Norm(final)=2.352 | 4149.8 samples/s | 64.8 steps/s
[Step=21650 Epoch=21.1] | Loss=0.00629 | Reg=0.00369 | acc=1.0000 | L2-Norm=19.203 | L2-Norm(final)=2.354 | 4119.9 samples/s | 64.4 steps/s
[Step=21700 Epoch=21.2] | Loss=0.00653 | Reg=0.00369 | acc=0.9844 | L2-Norm=19.201 | L2-Norm(final)=2.356 | 4302.7 samples/s | 67.2 steps/s
[Step=21750 Epoch=21.2] | Loss=0.00726 | Reg=0.00369 | acc=0.9844 | L2-Norm=19.199 | L2-Norm(final)=2.358 | 4310.1 samples/s | 67.3 steps/s
[Step=21800 Epoch=21.3] | Loss=0.00697 | Reg=0.00369 | acc=1.0000 | L2-Norm=19.198 | L2-Norm(final)=2.359 | 4432.0 samples/s | 69.2 steps/s
[Step=21850 Epoch=21.3] | Loss=0.00687 | Reg=0.00368 | acc=1.0000 | L2-Norm=19.196 | L2-Norm(final)=2.361 | 4378.3 samples/s | 68.4 steps/s
[Step=21900 Epoch=21.4] | Loss=0.00698 | Reg=0.00368 | acc=0.9844 | L2-Norm=19.194 | L2-Norm(final)=2.362 | 4457.4 samples/s | 69.6 steps/s
[Step=21950 Epoch=21.4] | Loss=0.00695 | Reg=0.00368 | acc=0.9688 | L2-Norm=19.193 | L2-Norm(final)=2.363 | 4631.6 samples/s | 72.4 steps/s
[Step=22000 Epoch=21.5] | Loss=0.00683 | Reg=0.00368 | acc=1.0000 | L2-Norm=19.191 | L2-Norm(final)=2.363 | 4501.7 samples/s | 70.3 steps/s
[Step=22050 Epoch=21.5] | Loss=0.00685 | Reg=0.00368 | acc=0.9844 | L2-Norm=19.190 | L2-Norm(final)=2.364 | 4429.2 samples/s | 69.2 steps/s
[Step=22100 Epoch=21.6] | Loss=0.00697 | Reg=0.00368 | acc=1.0000 | L2-Norm=19.189 | L2-Norm(final)=2.365 | 4514.7 samples/s | 70.5 steps/s
[Step=22150 Epoch=21.6] | Loss=0.00712 | Reg=0.00368 | acc=0.9844 | L2-Norm=19.188 | L2-Norm(final)=2.365 | 4298.0 samples/s | 67.2 steps/s
[Step=22200 Epoch=21.7] | Loss=0.00704 | Reg=0.00368 | acc=1.0000 | L2-Norm=19.186 | L2-Norm(final)=2.366 | 4521.0 samples/s | 70.6 steps/s
[Step=22250 Epoch=21.7] | Loss=0.00697 | Reg=0.00368 | acc=1.0000 | L2-Norm=19.185 | L2-Norm(final)=2.366 | 4602.7 samples/s | 71.9 steps/s
[Step=22300 Epoch=21.8] | Loss=0.00694 | Reg=0.00368 | acc=1.0000 | L2-Norm=19.183 | L2-Norm(final)=2.367 | 4565.8 samples/s | 71.3 steps/s
[Step=22350 Epoch=21.8] | Loss=0.00706 | Reg=0.00368 | acc=1.0000 | L2-Norm=19.182 | L2-Norm(final)=2.368 | 4451.7 samples/s | 69.6 steps/s
[Step=22400 Epoch=21.9] | Loss=0.00710 | Reg=0.00368 | acc=1.0000 | L2-Norm=19.180 | L2-Norm(final)=2.368 | 4469.5 samples/s | 69.8 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step22400.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00025, len=1
[Step=21601 Epoch=40.7] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.718 | L2-Norm(final)=3.870 | 4088.1 samples/s | 63.9 steps/s
[Step=21650 Epoch=40.8] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.715 | L2-Norm(final)=3.870 | 4189.6 samples/s | 65.5 steps/s
[Step=21700 Epoch=40.9] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.713 | L2-Norm(final)=3.871 | 4329.8 samples/s | 67.7 steps/s
[Step=21750 Epoch=41.0] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.710 | L2-Norm(final)=3.871 | 4305.8 samples/s | 67.3 steps/s
[Step=21800 Epoch=41.1] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.708 | L2-Norm(final)=3.872 | 4185.9 samples/s | 65.4 steps/s
[Step=21850 Epoch=41.2] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.706 | L2-Norm(final)=3.872 | 4250.0 samples/s | 66.4 steps/s
[Step=21900 Epoch=41.3] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.703 | L2-Norm(final)=3.873 | 4265.5 samples/s | 66.6 steps/s
[Step=21950 Epoch=41.4] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.701 | L2-Norm(final)=3.874 | 4328.0 samples/s | 67.6 steps/s
[Step=22000 Epoch=41.5] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.699 | L2-Norm(final)=3.874 | 4341.0 samples/s | 67.8 steps/s
[Step=22050 Epoch=41.6] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.697 | L2-Norm(final)=3.875 | 4347.3 samples/s | 67.9 steps/s
[Step=22100 Epoch=41.7] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.694 | L2-Norm(final)=3.875 | 4281.2 samples/s | 66.9 steps/s
[Step=22150 Epoch=41.8] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.692 | L2-Norm(final)=3.876 | 2102.3 samples/s | 32.8 steps/s
[Step=22200 Epoch=41.8] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.690 | L2-Norm(final)=3.877 | 4383.2 samples/s | 68.5 steps/s
[Step=22250 Epoch=41.9] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.688 | L2-Norm(final)=3.877 | 4292.4 samples/s | 67.1 steps/s
[Step=22300 Epoch=42.0] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.685 | L2-Norm(final)=3.878 | 4198.0 samples/s | 65.6 steps/s
[Step=22350 Epoch=42.1] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.683 | L2-Norm(final)=3.878 | 4305.7 samples/s | 67.3 steps/s
[Step=22400 Epoch=42.2] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.680 | L2-Norm(final)=3.879 | 4177.8 samples/s | 65.3 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step22400.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08347 | acc=0.9718 | tpr=0.9770 | fpr=0.0394 | 4269.6 samples/s | 16.7 steps/s
Avg test loss: 0.08677, Avg test acc: 0.97139, Avg tpr: 0.97750, Avg fpr: 0.04205, total FA: 328

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.96569 | acc=0.3127 | tpr=0.0025 | fpr=0.0136 | 4255.0 samples/s | 16.6 steps/s
Avg test loss: 4.98893, Avg test acc: 0.30972, Avg tpr: 0.00251, Avg fpr: 0.01461, total FA: 114

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.94527 | acc=0.1339 | tpr=0.8894 | fpr=0.8797 | 4126.4 samples/s | 16.1 steps/s
[Step= 100] | Loss=7.89517 | acc=0.1361 | tpr=0.8870 | fpr=0.8780 | 8387.1 samples/s | 32.8 steps/s
[Step= 150] | Loss=7.91631 | acc=0.1358 | tpr=0.8818 | fpr=0.8779 | 7145.9 samples/s | 27.9 steps/s
[Step= 200] | Loss=7.90186 | acc=0.1362 | tpr=0.8798 | fpr=0.8774 | 7958.9 samples/s | 31.1 steps/s
[Step= 250] | Loss=7.89743 | acc=0.1365 | tpr=0.8725 | fpr=0.8769 | 7835.1 samples/s | 30.6 steps/s
[Step= 300] | Loss=7.89952 | acc=0.1360 | tpr=0.8705 | fpr=0.8774 | 7656.0 samples/s | 29.9 steps/s
[Step= 350] | Loss=7.88932 | acc=0.1358 | tpr=0.8748 | fpr=0.8776 | 7822.3 samples/s | 30.6 steps/s
[Step= 400] | Loss=7.89228 | acc=0.1360 | tpr=0.8704 | fpr=0.8773 | 7892.9 samples/s | 30.8 steps/s
[Step= 450] | Loss=7.89795 | acc=0.1361 | tpr=0.8700 | fpr=0.8772 | 7360.5 samples/s | 28.8 steps/s
[Step= 500] | Loss=7.90122 | acc=0.1357 | tpr=0.8727 | fpr=0.8776 | 7208.7 samples/s | 28.2 steps/s
[Step= 550] | Loss=7.90060 | acc=0.1356 | tpr=0.8731 | fpr=0.8778 | 13450.3 samples/s | 52.5 steps/s
Avg test loss: 7.90194, Avg test acc: 0.13553, Avg tpr: 0.87322, Avg fpr: 0.87788, total FA: 121892

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11624 | acc=0.9813 | tpr=0.9646 | fpr=0.0184 | 3999.2 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.12154 | acc=0.9805 | tpr=0.9701 | fpr=0.0193 | 7273.5 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.12819 | acc=0.9792 | tpr=0.9741 | fpr=0.0207 | 7245.9 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.12968 | acc=0.9793 | tpr=0.9738 | fpr=0.0206 | 7269.5 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.12785 | acc=0.9795 | tpr=0.9729 | fpr=0.0204 | 7425.0 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.13002 | acc=0.9792 | tpr=0.9716 | fpr=0.0207 | 7975.0 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.13071 | acc=0.9791 | tpr=0.9731 | fpr=0.0208 | 7962.8 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.13256 | acc=0.9789 | tpr=0.9710 | fpr=0.0210 | 7353.6 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.13542 | acc=0.9785 | tpr=0.9708 | fpr=0.0213 | 7832.6 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.13545 | acc=0.9785 | tpr=0.9714 | fpr=0.0214 | 7682.7 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.13438 | acc=0.9786 | tpr=0.9702 | fpr=0.0212 | 13863.2 samples/s | 54.2 steps/s
Avg test loss: 0.13408, Avg test acc: 0.97863, Avg tpr: 0.96989, Avg fpr: 0.02121, total FA: 2945

server round 28/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00025, len=1
[Step=22401 Epoch=21.9] | Loss=0.01780 | Reg=0.00367 | acc=0.9688 | L2-Norm=19.150 | L2-Norm(final)=2.375 | 4563.9 samples/s | 71.3 steps/s
[Step=22450 Epoch=21.9] | Loss=0.00577 | Reg=0.00367 | acc=1.0000 | L2-Norm=19.148 | L2-Norm(final)=2.377 | 4281.1 samples/s | 66.9 steps/s
[Step=22500 Epoch=22.0] | Loss=0.00588 | Reg=0.00367 | acc=1.0000 | L2-Norm=19.147 | L2-Norm(final)=2.379 | 4435.0 samples/s | 69.3 steps/s
[Step=22550 Epoch=22.0] | Loss=0.00637 | Reg=0.00367 | acc=1.0000 | L2-Norm=19.144 | L2-Norm(final)=2.379 | 4409.9 samples/s | 68.9 steps/s
[Step=22600 Epoch=22.1] | Loss=0.00656 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.141 | L2-Norm(final)=2.378 | 4440.1 samples/s | 69.4 steps/s
[Step=22650 Epoch=22.1] | Loss=0.00693 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.139 | L2-Norm(final)=2.378 | 4600.4 samples/s | 71.9 steps/s
[Step=22700 Epoch=22.2] | Loss=0.00680 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.137 | L2-Norm(final)=2.379 | 4549.1 samples/s | 71.1 steps/s
[Step=22750 Epoch=22.2] | Loss=0.00663 | Reg=0.00366 | acc=0.9844 | L2-Norm=19.136 | L2-Norm(final)=2.380 | 4477.0 samples/s | 70.0 steps/s
[Step=22800 Epoch=22.3] | Loss=0.00679 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.134 | L2-Norm(final)=2.381 | 4564.7 samples/s | 71.3 steps/s
[Step=22850 Epoch=22.3] | Loss=0.00687 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.133 | L2-Norm(final)=2.381 | 4589.7 samples/s | 71.7 steps/s
[Step=22900 Epoch=22.4] | Loss=0.00678 | Reg=0.00366 | acc=0.9844 | L2-Norm=19.131 | L2-Norm(final)=2.382 | 4473.6 samples/s | 69.9 steps/s
[Step=22950 Epoch=22.4] | Loss=0.00702 | Reg=0.00366 | acc=0.9844 | L2-Norm=19.130 | L2-Norm(final)=2.383 | 4537.2 samples/s | 70.9 steps/s
[Step=23000 Epoch=22.5] | Loss=0.00706 | Reg=0.00366 | acc=0.9844 | L2-Norm=19.128 | L2-Norm(final)=2.383 | 4570.1 samples/s | 71.4 steps/s
[Step=23050 Epoch=22.5] | Loss=0.00707 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.127 | L2-Norm(final)=2.384 | 4480.6 samples/s | 70.0 steps/s
[Step=23100 Epoch=22.6] | Loss=0.00704 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.125 | L2-Norm(final)=2.384 | 4455.2 samples/s | 69.6 steps/s
[Step=23150 Epoch=22.6] | Loss=0.00693 | Reg=0.00366 | acc=0.9844 | L2-Norm=19.123 | L2-Norm(final)=2.385 | 4466.3 samples/s | 69.8 steps/s
[Step=23200 Epoch=22.7] | Loss=0.00688 | Reg=0.00366 | acc=0.9688 | L2-Norm=19.121 | L2-Norm(final)=2.385 | 4527.2 samples/s | 70.7 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step23200.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00025, len=1
[Step=22401 Epoch=42.2] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.641 | L2-Norm(final)=3.888 | 3981.8 samples/s | 62.2 steps/s
[Step=22450 Epoch=42.3] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.638 | L2-Norm(final)=3.889 | 4219.7 samples/s | 65.9 steps/s
[Step=22500 Epoch=42.4] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.636 | L2-Norm(final)=3.890 | 4241.1 samples/s | 66.3 steps/s
[Step=22550 Epoch=42.5] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.633 | L2-Norm(final)=3.891 | 4268.7 samples/s | 66.7 steps/s
[Step=22600 Epoch=42.6] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.630 | L2-Norm(final)=3.891 | 4322.3 samples/s | 67.5 steps/s
[Step=22650 Epoch=42.7] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.627 | L2-Norm(final)=3.892 | 4252.4 samples/s | 66.4 steps/s
[Step=22700 Epoch=42.8] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.625 | L2-Norm(final)=3.893 | 4300.8 samples/s | 67.2 steps/s
[Step=22750 Epoch=42.9] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.622 | L2-Norm(final)=3.894 | 4302.3 samples/s | 67.2 steps/s
[Step=22800 Epoch=43.0] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.619 | L2-Norm(final)=3.895 | 4256.5 samples/s | 66.5 steps/s
[Step=22850 Epoch=43.1] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.616 | L2-Norm(final)=3.895 | 4228.3 samples/s | 66.1 steps/s
[Step=22900 Epoch=43.2] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.614 | L2-Norm(final)=3.896 | 4275.2 samples/s | 66.8 steps/s
[Step=22950 Epoch=43.3] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.611 | L2-Norm(final)=3.898 | 2051.5 samples/s | 32.1 steps/s
[Step=23000 Epoch=43.4] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.608 | L2-Norm(final)=3.899 | 4183.3 samples/s | 65.4 steps/s
[Step=23050 Epoch=43.4] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.605 | L2-Norm(final)=3.900 | 4247.3 samples/s | 66.4 steps/s
[Step=23100 Epoch=43.5] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.602 | L2-Norm(final)=3.901 | 4216.9 samples/s | 65.9 steps/s
[Step=23150 Epoch=43.6] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.600 | L2-Norm(final)=3.902 | 4083.1 samples/s | 63.8 steps/s
[Step=23200 Epoch=43.7] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.597 | L2-Norm(final)=3.903 | 4178.1 samples/s | 65.3 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step23200.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09123 | acc=0.9727 | tpr=0.9790 | fpr=0.0411 | 4205.3 samples/s | 16.4 steps/s
Avg test loss: 0.09513, Avg test acc: 0.97155, Avg tpr: 0.97832, Avg fpr: 0.04333, total FA: 338

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.03286 | acc=0.3130 | tpr=0.0025 | fpr=0.0129 | 4117.1 samples/s | 16.1 steps/s
Avg test loss: 5.05627, Avg test acc: 0.30988, Avg tpr: 0.00245, Avg fpr: 0.01397, total FA: 109

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.95644 | acc=0.1323 | tpr=0.9071 | fpr=0.8816 | 4065.1 samples/s | 15.9 steps/s
[Step= 100] | Loss=8.89300 | acc=0.1348 | tpr=0.8955 | fpr=0.8794 | 7386.2 samples/s | 28.9 steps/s
[Step= 150] | Loss=8.91703 | acc=0.1343 | tpr=0.8919 | fpr=0.8797 | 7541.8 samples/s | 29.5 steps/s
[Step= 200] | Loss=8.90063 | acc=0.1339 | tpr=0.8874 | fpr=0.8798 | 7384.0 samples/s | 28.8 steps/s
[Step= 250] | Loss=8.89666 | acc=0.1345 | tpr=0.8795 | fpr=0.8791 | 7519.0 samples/s | 29.4 steps/s
[Step= 300] | Loss=8.89713 | acc=0.1340 | tpr=0.8800 | fpr=0.8796 | 7092.2 samples/s | 27.7 steps/s
[Step= 350] | Loss=8.88871 | acc=0.1339 | tpr=0.8860 | fpr=0.8797 | 7439.4 samples/s | 29.1 steps/s
[Step= 400] | Loss=8.88876 | acc=0.1345 | tpr=0.8857 | fpr=0.8792 | 7353.4 samples/s | 28.7 steps/s
[Step= 450] | Loss=8.89511 | acc=0.1346 | tpr=0.8856 | fpr=0.8790 | 7233.4 samples/s | 28.3 steps/s
[Step= 500] | Loss=8.89973 | acc=0.1342 | tpr=0.8868 | fpr=0.8794 | 7318.7 samples/s | 28.6 steps/s
[Step= 550] | Loss=8.90001 | acc=0.1343 | tpr=0.8866 | fpr=0.8794 | 12982.4 samples/s | 50.7 steps/s
Avg test loss: 8.90171, Avg test acc: 0.13416, Avg tpr: 0.88669, Avg fpr: 0.87952, total FA: 122120

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11558 | acc=0.9812 | tpr=0.9646 | fpr=0.0185 | 4256.1 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.12085 | acc=0.9805 | tpr=0.9701 | fpr=0.0193 | 7424.8 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.12743 | acc=0.9793 | tpr=0.9741 | fpr=0.0206 | 8106.1 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.12891 | acc=0.9793 | tpr=0.9738 | fpr=0.0206 | 7494.2 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.12709 | acc=0.9796 | tpr=0.9729 | fpr=0.0203 | 7648.9 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.12924 | acc=0.9793 | tpr=0.9709 | fpr=0.0206 | 7909.5 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.12992 | acc=0.9791 | tpr=0.9718 | fpr=0.0207 | 7382.8 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.13176 | acc=0.9789 | tpr=0.9699 | fpr=0.0209 | 7900.1 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.13461 | acc=0.9786 | tpr=0.9693 | fpr=0.0213 | 7560.6 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.13462 | acc=0.9785 | tpr=0.9696 | fpr=0.0213 | 7405.2 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.13357 | acc=0.9787 | tpr=0.9686 | fpr=0.0211 | 14344.3 samples/s | 56.0 steps/s
Avg test loss: 0.13327, Avg test acc: 0.97872, Avg tpr: 0.96830, Avg fpr: 0.02109, total FA: 2928

server round 29/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00025, len=1
[Step=23201 Epoch=22.7] | Loss=0.00046 | Reg=0.00365 | acc=1.0000 | L2-Norm=19.095 | L2-Norm(final)=2.402 | 4284.1 samples/s | 66.9 steps/s
[Step=23250 Epoch=22.7] | Loss=0.00568 | Reg=0.00365 | acc=1.0000 | L2-Norm=19.094 | L2-Norm(final)=2.404 | 4133.7 samples/s | 64.6 steps/s
[Step=23300 Epoch=22.7] | Loss=0.00602 | Reg=0.00365 | acc=0.9844 | L2-Norm=19.093 | L2-Norm(final)=2.405 | 4407.3 samples/s | 68.9 steps/s
[Step=23350 Epoch=22.8] | Loss=0.00674 | Reg=0.00364 | acc=0.9844 | L2-Norm=19.092 | L2-Norm(final)=2.404 | 4513.8 samples/s | 70.5 steps/s
[Step=23400 Epoch=22.8] | Loss=0.00666 | Reg=0.00364 | acc=0.9844 | L2-Norm=19.090 | L2-Norm(final)=2.405 | 4522.5 samples/s | 70.7 steps/s
[Step=23450 Epoch=22.9] | Loss=0.00674 | Reg=0.00364 | acc=1.0000 | L2-Norm=19.089 | L2-Norm(final)=2.405 | 4217.8 samples/s | 65.9 steps/s
[Step=23500 Epoch=22.9] | Loss=0.00677 | Reg=0.00364 | acc=0.9844 | L2-Norm=19.087 | L2-Norm(final)=2.406 | 4471.7 samples/s | 69.9 steps/s
[Step=23550 Epoch=23.0] | Loss=0.00649 | Reg=0.00364 | acc=1.0000 | L2-Norm=19.085 | L2-Norm(final)=2.407 | 4514.3 samples/s | 70.5 steps/s
[Step=23600 Epoch=23.0] | Loss=0.00678 | Reg=0.00364 | acc=1.0000 | L2-Norm=19.084 | L2-Norm(final)=2.408 | 4445.5 samples/s | 69.5 steps/s
[Step=23650 Epoch=23.1] | Loss=0.00684 | Reg=0.00364 | acc=1.0000 | L2-Norm=19.082 | L2-Norm(final)=2.408 | 4417.0 samples/s | 69.0 steps/s
[Step=23700 Epoch=23.1] | Loss=0.00664 | Reg=0.00364 | acc=1.0000 | L2-Norm=19.081 | L2-Norm(final)=2.409 | 4395.1 samples/s | 68.7 steps/s
[Step=23750 Epoch=23.2] | Loss=0.00654 | Reg=0.00364 | acc=1.0000 | L2-Norm=19.079 | L2-Norm(final)=2.410 | 4385.7 samples/s | 68.5 steps/s
[Step=23800 Epoch=23.2] | Loss=0.00663 | Reg=0.00364 | acc=0.9844 | L2-Norm=19.078 | L2-Norm(final)=2.411 | 4315.6 samples/s | 67.4 steps/s
[Step=23850 Epoch=23.3] | Loss=0.00664 | Reg=0.00364 | acc=1.0000 | L2-Norm=19.077 | L2-Norm(final)=2.412 | 4337.7 samples/s | 67.8 steps/s
[Step=23900 Epoch=23.3] | Loss=0.00678 | Reg=0.00364 | acc=1.0000 | L2-Norm=19.076 | L2-Norm(final)=2.413 | 4362.1 samples/s | 68.2 steps/s
[Step=23950 Epoch=23.4] | Loss=0.00683 | Reg=0.00364 | acc=1.0000 | L2-Norm=19.075 | L2-Norm(final)=2.414 | 4376.0 samples/s | 68.4 steps/s
[Step=24000 Epoch=23.4] | Loss=0.00679 | Reg=0.00364 | acc=1.0000 | L2-Norm=19.074 | L2-Norm(final)=2.415 | 4340.1 samples/s | 67.8 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step24000.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00025, len=1
[Step=23201 Epoch=43.7] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.547 | L2-Norm(final)=3.919 | 3975.3 samples/s | 62.1 steps/s
[Step=23250 Epoch=43.8] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.544 | L2-Norm(final)=3.921 | 3984.3 samples/s | 62.3 steps/s
[Step=23300 Epoch=43.9] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.541 | L2-Norm(final)=3.922 | 4293.1 samples/s | 67.1 steps/s
[Step=23350 Epoch=44.0] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.538 | L2-Norm(final)=3.924 | 4048.0 samples/s | 63.3 steps/s
[Step=23400 Epoch=44.1] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.534 | L2-Norm(final)=3.925 | 4235.0 samples/s | 66.2 steps/s
[Step=23450 Epoch=44.2] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.531 | L2-Norm(final)=3.926 | 4240.2 samples/s | 66.3 steps/s
[Step=23500 Epoch=44.3] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.528 | L2-Norm(final)=3.928 | 4186.0 samples/s | 65.4 steps/s
[Step=23550 Epoch=44.4] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.524 | L2-Norm(final)=3.929 | 4213.8 samples/s | 65.8 steps/s
[Step=23600 Epoch=44.5] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.521 | L2-Norm(final)=3.930 | 4133.3 samples/s | 64.6 steps/s
[Step=23650 Epoch=44.6] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.517 | L2-Norm(final)=3.932 | 4207.0 samples/s | 65.7 steps/s
[Step=23700 Epoch=44.7] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.513 | L2-Norm(final)=3.933 | 4286.3 samples/s | 67.0 steps/s
[Step=23750 Epoch=44.8] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.510 | L2-Norm(final)=3.935 | 2089.0 samples/s | 32.6 steps/s
[Step=23800 Epoch=44.9] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.506 | L2-Norm(final)=3.936 | 4104.4 samples/s | 64.1 steps/s
[Step=23850 Epoch=45.0] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.502 | L2-Norm(final)=3.938 | 4197.9 samples/s | 65.6 steps/s
[Step=23900 Epoch=45.1] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.498 | L2-Norm(final)=3.939 | 4176.2 samples/s | 65.3 steps/s
[Step=23950 Epoch=45.1] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.494 | L2-Norm(final)=3.941 | 4056.7 samples/s | 63.4 steps/s
[Step=24000 Epoch=45.2] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.491 | L2-Norm(final)=3.943 | 4120.7 samples/s | 64.4 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step24000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08967 | acc=0.9720 | tpr=0.9800 | fpr=0.0453 | 3911.6 samples/s | 15.3 steps/s
Avg test loss: 0.09348, Avg test acc: 0.97119, Avg tpr: 0.97908, Avg fpr: 0.04615, total FA: 360

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.20250 | acc=0.3136 | tpr=0.0018 | fpr=0.0094 | 4054.3 samples/s | 15.8 steps/s
Avg test loss: 5.22635, Avg test acc: 0.31076, Avg tpr: 0.00175, Avg fpr: 0.00961, total FA: 75

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.73158 | acc=0.1294 | tpr=0.9292 | fpr=0.8850 | 3937.8 samples/s | 15.4 steps/s
[Step= 100] | Loss=8.67987 | acc=0.1309 | tpr=0.9126 | fpr=0.8836 | 8133.9 samples/s | 31.8 steps/s
[Step= 150] | Loss=8.69878 | acc=0.1301 | tpr=0.9035 | fpr=0.8842 | 7698.5 samples/s | 30.1 steps/s
[Step= 200] | Loss=8.68143 | acc=0.1305 | tpr=0.9049 | fpr=0.8836 | 7753.0 samples/s | 30.3 steps/s
[Step= 250] | Loss=8.67623 | acc=0.1310 | tpr=0.8996 | fpr=0.8830 | 7672.5 samples/s | 30.0 steps/s
[Step= 300] | Loss=8.67917 | acc=0.1305 | tpr=0.8982 | fpr=0.8835 | 7466.3 samples/s | 29.2 steps/s
[Step= 350] | Loss=8.66859 | acc=0.1303 | tpr=0.9042 | fpr=0.8837 | 8014.9 samples/s | 31.3 steps/s
[Step= 400] | Loss=8.66877 | acc=0.1306 | tpr=0.9026 | fpr=0.8834 | 7571.6 samples/s | 29.6 steps/s
[Step= 450] | Loss=8.67504 | acc=0.1308 | tpr=0.9012 | fpr=0.8832 | 7499.0 samples/s | 29.3 steps/s
[Step= 500] | Loss=8.67946 | acc=0.1303 | tpr=0.9013 | fpr=0.8836 | 7882.0 samples/s | 30.8 steps/s
[Step= 550] | Loss=8.67917 | acc=0.1303 | tpr=0.9013 | fpr=0.8837 | 14155.3 samples/s | 55.3 steps/s
Avg test loss: 8.68120, Avg test acc: 0.13019, Avg tpr: 0.90135, Avg fpr: 0.88383, total FA: 122718

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10778 | acc=0.9828 | tpr=0.9646 | fpr=0.0169 | 4223.2 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.11280 | acc=0.9821 | tpr=0.9701 | fpr=0.0177 | 7916.2 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.11875 | acc=0.9809 | tpr=0.9726 | fpr=0.0190 | 7725.0 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.12027 | acc=0.9809 | tpr=0.9716 | fpr=0.0190 | 7552.0 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.11851 | acc=0.9810 | tpr=0.9712 | fpr=0.0188 | 7609.8 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.12058 | acc=0.9807 | tpr=0.9695 | fpr=0.0191 | 7589.6 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.12116 | acc=0.9806 | tpr=0.9706 | fpr=0.0192 | 8168.3 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.12289 | acc=0.9803 | tpr=0.9688 | fpr=0.0195 | 7213.7 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.12561 | acc=0.9800 | tpr=0.9679 | fpr=0.0198 | 7580.9 samples/s | 29.6 steps/s
[Step= 500] | Loss=0.12554 | acc=0.9799 | tpr=0.9678 | fpr=0.0198 | 7368.6 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.12459 | acc=0.9801 | tpr=0.9666 | fpr=0.0197 | 14090.3 samples/s | 55.0 steps/s
Avg test loss: 0.12430, Avg test acc: 0.98010, Avg tpr: 0.96632, Avg fpr: 0.01965, total FA: 2728

server round 30/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00013, len=1
[Step=24001 Epoch=23.4] | Loss=0.00747 | Reg=0.00363 | acc=1.0000 | L2-Norm=19.059 | L2-Norm(final)=2.434 | 4156.8 samples/s | 64.9 steps/s
[Step=24050 Epoch=23.5] | Loss=0.00809 | Reg=0.00363 | acc=1.0000 | L2-Norm=19.058 | L2-Norm(final)=2.435 | 4405.8 samples/s | 68.8 steps/s
[Step=24100 Epoch=23.5] | Loss=0.00712 | Reg=0.00363 | acc=0.9844 | L2-Norm=19.057 | L2-Norm(final)=2.436 | 4451.7 samples/s | 69.6 steps/s
[Step=24150 Epoch=23.6] | Loss=0.00627 | Reg=0.00363 | acc=0.9688 | L2-Norm=19.056 | L2-Norm(final)=2.436 | 4412.4 samples/s | 68.9 steps/s
[Step=24200 Epoch=23.6] | Loss=0.00585 | Reg=0.00363 | acc=1.0000 | L2-Norm=19.055 | L2-Norm(final)=2.437 | 4366.0 samples/s | 68.2 steps/s
[Step=24250 Epoch=23.7] | Loss=0.00572 | Reg=0.00363 | acc=1.0000 | L2-Norm=19.054 | L2-Norm(final)=2.438 | 4410.5 samples/s | 68.9 steps/s
[Step=24300 Epoch=23.7] | Loss=0.00573 | Reg=0.00363 | acc=1.0000 | L2-Norm=19.052 | L2-Norm(final)=2.439 | 4441.0 samples/s | 69.4 steps/s
[Step=24350 Epoch=23.8] | Loss=0.00571 | Reg=0.00363 | acc=1.0000 | L2-Norm=19.051 | L2-Norm(final)=2.440 | 4398.0 samples/s | 68.7 steps/s
[Step=24400 Epoch=23.8] | Loss=0.00566 | Reg=0.00363 | acc=1.0000 | L2-Norm=19.049 | L2-Norm(final)=2.440 | 4511.1 samples/s | 70.5 steps/s
[Step=24450 Epoch=23.9] | Loss=0.00574 | Reg=0.00363 | acc=0.9844 | L2-Norm=19.048 | L2-Norm(final)=2.441 | 4375.2 samples/s | 68.4 steps/s
[Step=24500 Epoch=23.9] | Loss=0.00582 | Reg=0.00363 | acc=1.0000 | L2-Norm=19.046 | L2-Norm(final)=2.442 | 4328.1 samples/s | 67.6 steps/s
[Step=24550 Epoch=24.0] | Loss=0.00599 | Reg=0.00363 | acc=0.9844 | L2-Norm=19.045 | L2-Norm(final)=2.442 | 4409.1 samples/s | 68.9 steps/s
[Step=24600 Epoch=24.0] | Loss=0.00602 | Reg=0.00363 | acc=1.0000 | L2-Norm=19.043 | L2-Norm(final)=2.443 | 4389.7 samples/s | 68.6 steps/s
[Step=24650 Epoch=24.1] | Loss=0.00586 | Reg=0.00363 | acc=1.0000 | L2-Norm=19.042 | L2-Norm(final)=2.443 | 4320.5 samples/s | 67.5 steps/s
[Step=24700 Epoch=24.1] | Loss=0.00576 | Reg=0.00363 | acc=0.9844 | L2-Norm=19.040 | L2-Norm(final)=2.444 | 4376.6 samples/s | 68.4 steps/s
[Step=24750 Epoch=24.2] | Loss=0.00573 | Reg=0.00362 | acc=1.0000 | L2-Norm=19.039 | L2-Norm(final)=2.444 | 4375.9 samples/s | 68.4 steps/s
[Step=24800 Epoch=24.2] | Loss=0.00573 | Reg=0.00362 | acc=1.0000 | L2-Norm=19.037 | L2-Norm(final)=2.445 | 4347.5 samples/s | 67.9 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step24800.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00013, len=1
[Step=24001 Epoch=45.2] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.429 | L2-Norm(final)=3.967 | 4061.2 samples/s | 63.5 steps/s
[Step=24050 Epoch=45.3] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.427 | L2-Norm(final)=3.967 | 3807.8 samples/s | 59.5 steps/s
[Step=24100 Epoch=45.4] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.425 | L2-Norm(final)=3.968 | 4106.2 samples/s | 64.2 steps/s
[Step=24150 Epoch=45.5] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.422 | L2-Norm(final)=3.970 | 4135.2 samples/s | 64.6 steps/s
[Step=24200 Epoch=45.6] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.420 | L2-Norm(final)=3.971 | 4124.4 samples/s | 64.4 steps/s
[Step=24250 Epoch=45.7] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.417 | L2-Norm(final)=3.972 | 4090.2 samples/s | 63.9 steps/s
[Step=24300 Epoch=45.8] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.415 | L2-Norm(final)=3.973 | 4093.2 samples/s | 64.0 steps/s
[Step=24350 Epoch=45.9] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.413 | L2-Norm(final)=3.974 | 4068.9 samples/s | 63.6 steps/s
[Step=24400 Epoch=46.0] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.410 | L2-Norm(final)=3.975 | 4187.8 samples/s | 65.4 steps/s
[Step=24450 Epoch=46.1] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.408 | L2-Norm(final)=3.976 | 4278.7 samples/s | 66.9 steps/s
[Step=24500 Epoch=46.2] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.405 | L2-Norm(final)=3.978 | 4249.2 samples/s | 66.4 steps/s
[Step=24550 Epoch=46.3] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.403 | L2-Norm(final)=3.979 | 2088.1 samples/s | 32.6 steps/s
[Step=24600 Epoch=46.4] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.400 | L2-Norm(final)=3.980 | 4329.9 samples/s | 67.7 steps/s
[Step=24650 Epoch=46.5] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.398 | L2-Norm(final)=3.981 | 4331.9 samples/s | 67.7 steps/s
[Step=24700 Epoch=46.6] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.395 | L2-Norm(final)=3.983 | 4193.2 samples/s | 65.5 steps/s
[Step=24750 Epoch=46.7] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.393 | L2-Norm(final)=3.984 | 4277.8 samples/s | 66.8 steps/s
[Step=24800 Epoch=46.7] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.390 | L2-Norm(final)=3.985 | 4296.3 samples/s | 67.1 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step24800.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09658 | acc=0.9717 | tpr=0.9780 | fpr=0.0419 | 3982.0 samples/s | 15.6 steps/s
Avg test loss: 0.10121, Avg test acc: 0.97187, Avg tpr: 0.97873, Avg fpr: 0.04320, total FA: 337

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.99241 | acc=0.3130 | tpr=0.0026 | fpr=0.0131 | 4148.8 samples/s | 16.2 steps/s
Avg test loss: 5.01541, Avg test acc: 0.30984, Avg tpr: 0.00251, Avg fpr: 0.01423, total FA: 111

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=9.20317 | acc=0.1375 | tpr=0.9071 | fpr=0.8763 | 4093.7 samples/s | 16.0 steps/s
[Step= 100] | Loss=9.14350 | acc=0.1394 | tpr=0.8977 | fpr=0.8747 | 7919.0 samples/s | 30.9 steps/s
[Step= 150] | Loss=9.16998 | acc=0.1389 | tpr=0.8905 | fpr=0.8750 | 7990.5 samples/s | 31.2 steps/s
[Step= 200] | Loss=9.15098 | acc=0.1389 | tpr=0.8907 | fpr=0.8748 | 7328.3 samples/s | 28.6 steps/s
[Step= 250] | Loss=9.14579 | acc=0.1392 | tpr=0.8838 | fpr=0.8743 | 8079.8 samples/s | 31.6 steps/s
[Step= 300] | Loss=9.14802 | acc=0.1390 | tpr=0.8858 | fpr=0.8746 | 7578.4 samples/s | 29.6 steps/s
[Step= 350] | Loss=9.13750 | acc=0.1387 | tpr=0.8917 | fpr=0.8750 | 7889.9 samples/s | 30.8 steps/s
[Step= 400] | Loss=9.13838 | acc=0.1389 | tpr=0.8906 | fpr=0.8748 | 7305.8 samples/s | 28.5 steps/s
[Step= 450] | Loss=9.14516 | acc=0.1391 | tpr=0.8885 | fpr=0.8745 | 7495.9 samples/s | 29.3 steps/s
[Step= 500] | Loss=9.15042 | acc=0.1385 | tpr=0.8894 | fpr=0.8750 | 7337.5 samples/s | 28.7 steps/s
[Step= 550] | Loss=9.14969 | acc=0.1385 | tpr=0.8902 | fpr=0.8752 | 13856.1 samples/s | 54.1 steps/s
Avg test loss: 9.15174, Avg test acc: 0.13839, Avg tpr: 0.88986, Avg fpr: 0.87527, total FA: 121530

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11531 | acc=0.9812 | tpr=0.9690 | fpr=0.0185 | 4043.1 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.12064 | acc=0.9804 | tpr=0.9723 | fpr=0.0194 | 7756.9 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.12716 | acc=0.9791 | tpr=0.9755 | fpr=0.0208 | 7751.4 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.12855 | acc=0.9792 | tpr=0.9749 | fpr=0.0207 | 7415.6 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.12681 | acc=0.9794 | tpr=0.9738 | fpr=0.0205 | 7377.6 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.12892 | acc=0.9791 | tpr=0.9738 | fpr=0.0208 | 7277.0 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.12958 | acc=0.9790 | tpr=0.9750 | fpr=0.0209 | 7361.6 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.13138 | acc=0.9788 | tpr=0.9732 | fpr=0.0211 | 7367.1 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.13421 | acc=0.9785 | tpr=0.9727 | fpr=0.0214 | 7063.7 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.13420 | acc=0.9783 | tpr=0.9727 | fpr=0.0216 | 7171.0 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.13316 | acc=0.9785 | tpr=0.9717 | fpr=0.0214 | 13420.5 samples/s | 52.4 steps/s
Avg test loss: 0.13286, Avg test acc: 0.97852, Avg tpr: 0.97187, Avg fpr: 0.02135, total FA: 2965

server round 31/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00013, len=1
[Step=24801 Epoch=24.2] | Loss=0.00010 | Reg=0.00361 | acc=1.0000 | L2-Norm=19.013 | L2-Norm(final)=2.454 | 4303.0 samples/s | 67.2 steps/s
[Step=24850 Epoch=24.3] | Loss=0.00373 | Reg=0.00361 | acc=0.9844 | L2-Norm=19.012 | L2-Norm(final)=2.456 | 4182.6 samples/s | 65.4 steps/s
[Step=24900 Epoch=24.3] | Loss=0.00361 | Reg=0.00361 | acc=1.0000 | L2-Norm=19.011 | L2-Norm(final)=2.457 | 4336.7 samples/s | 67.8 steps/s
[Step=24950 Epoch=24.4] | Loss=0.00418 | Reg=0.00361 | acc=1.0000 | L2-Norm=19.009 | L2-Norm(final)=2.457 | 4291.9 samples/s | 67.1 steps/s
[Step=25000 Epoch=24.4] | Loss=0.00454 | Reg=0.00361 | acc=1.0000 | L2-Norm=19.007 | L2-Norm(final)=2.457 | 4240.7 samples/s | 66.3 steps/s
[Step=25050 Epoch=24.5] | Loss=0.00478 | Reg=0.00361 | acc=1.0000 | L2-Norm=19.006 | L2-Norm(final)=2.458 | 4372.4 samples/s | 68.3 steps/s
[Step=25100 Epoch=24.5] | Loss=0.00467 | Reg=0.00361 | acc=1.0000 | L2-Norm=19.004 | L2-Norm(final)=2.458 | 4506.5 samples/s | 70.4 steps/s
[Step=25150 Epoch=24.6] | Loss=0.00466 | Reg=0.00361 | acc=1.0000 | L2-Norm=19.003 | L2-Norm(final)=2.459 | 4536.2 samples/s | 70.9 steps/s
[Step=25200 Epoch=24.6] | Loss=0.00462 | Reg=0.00361 | acc=0.9844 | L2-Norm=19.001 | L2-Norm(final)=2.459 | 4430.4 samples/s | 69.2 steps/s
[Step=25250 Epoch=24.7] | Loss=0.00478 | Reg=0.00361 | acc=1.0000 | L2-Norm=19.000 | L2-Norm(final)=2.459 | 4570.5 samples/s | 71.4 steps/s
[Step=25300 Epoch=24.7] | Loss=0.00474 | Reg=0.00361 | acc=1.0000 | L2-Norm=18.998 | L2-Norm(final)=2.460 | 4593.1 samples/s | 71.8 steps/s
[Step=25350 Epoch=24.8] | Loss=0.00484 | Reg=0.00361 | acc=0.9844 | L2-Norm=18.997 | L2-Norm(final)=2.460 | 4627.9 samples/s | 72.3 steps/s
[Step=25400 Epoch=24.8] | Loss=0.00501 | Reg=0.00361 | acc=1.0000 | L2-Norm=18.995 | L2-Norm(final)=2.461 | 4500.0 samples/s | 70.3 steps/s
[Step=25450 Epoch=24.8] | Loss=0.00502 | Reg=0.00361 | acc=1.0000 | L2-Norm=18.994 | L2-Norm(final)=2.461 | 4484.0 samples/s | 70.1 steps/s
[Step=25500 Epoch=24.9] | Loss=0.00509 | Reg=0.00361 | acc=0.9844 | L2-Norm=18.992 | L2-Norm(final)=2.461 | 4469.5 samples/s | 69.8 steps/s
[Step=25550 Epoch=24.9] | Loss=0.00522 | Reg=0.00361 | acc=1.0000 | L2-Norm=18.991 | L2-Norm(final)=2.461 | 4542.6 samples/s | 71.0 steps/s
[Step=25600 Epoch=25.0] | Loss=0.00537 | Reg=0.00361 | acc=1.0000 | L2-Norm=18.989 | L2-Norm(final)=2.462 | 4592.0 samples/s | 71.7 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step25600.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00013, len=1
[Step=24801 Epoch=46.8] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.347 | L2-Norm(final)=4.006 | 3966.4 samples/s | 62.0 steps/s
[Step=24850 Epoch=46.8] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.344 | L2-Norm(final)=4.007 | 4267.9 samples/s | 66.7 steps/s
[Step=24900 Epoch=46.9] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.342 | L2-Norm(final)=4.009 | 4250.1 samples/s | 66.4 steps/s
[Step=24950 Epoch=47.0] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.339 | L2-Norm(final)=4.010 | 4308.8 samples/s | 67.3 steps/s
[Step=25000 Epoch=47.1] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.335 | L2-Norm(final)=4.012 | 4370.7 samples/s | 68.3 steps/s
[Step=25050 Epoch=47.2] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.332 | L2-Norm(final)=4.013 | 4306.2 samples/s | 67.3 steps/s
[Step=25100 Epoch=47.3] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.329 | L2-Norm(final)=4.015 | 4357.9 samples/s | 68.1 steps/s
[Step=25150 Epoch=47.4] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.326 | L2-Norm(final)=4.017 | 4208.9 samples/s | 65.8 steps/s
[Step=25200 Epoch=47.5] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.323 | L2-Norm(final)=4.018 | 4044.3 samples/s | 63.2 steps/s
[Step=25250 Epoch=47.6] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.320 | L2-Norm(final)=4.020 | 4295.0 samples/s | 67.1 steps/s
[Step=25300 Epoch=47.7] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.316 | L2-Norm(final)=4.022 | 4398.1 samples/s | 68.7 steps/s
[Step=25350 Epoch=47.8] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.313 | L2-Norm(final)=4.023 | 2079.8 samples/s | 32.5 steps/s
[Step=25400 Epoch=47.9] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.310 | L2-Norm(final)=4.025 | 4301.2 samples/s | 67.2 steps/s
[Step=25450 Epoch=48.0] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.306 | L2-Norm(final)=4.027 | 4082.2 samples/s | 63.8 steps/s
[Step=25500 Epoch=48.1] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.303 | L2-Norm(final)=4.029 | 4250.8 samples/s | 66.4 steps/s
[Step=25550 Epoch=48.2] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.299 | L2-Norm(final)=4.030 | 4359.4 samples/s | 68.1 steps/s
[Step=25600 Epoch=48.3] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.295 | L2-Norm(final)=4.032 | 4263.1 samples/s | 66.6 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step25600.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09713 | acc=0.9730 | tpr=0.9781 | fpr=0.0379 | 4151.0 samples/s | 16.2 steps/s
Avg test loss: 0.10141, Avg test acc: 0.97183, Avg tpr: 0.97744, Avg fpr: 0.04051, total FA: 316

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.96676 | acc=0.3130 | tpr=0.0026 | fpr=0.0131 | 4125.1 samples/s | 16.1 steps/s
Avg test loss: 4.98954, Avg test acc: 0.30984, Avg tpr: 0.00245, Avg fpr: 0.01410, total FA: 110

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.88725 | acc=0.1386 | tpr=0.8938 | fpr=0.8750 | 4153.5 samples/s | 16.2 steps/s
[Step= 100] | Loss=8.82964 | acc=0.1410 | tpr=0.8849 | fpr=0.8729 | 7726.1 samples/s | 30.2 steps/s
[Step= 150] | Loss=8.85864 | acc=0.1401 | tpr=0.8818 | fpr=0.8736 | 7352.2 samples/s | 28.7 steps/s
[Step= 200] | Loss=8.84319 | acc=0.1402 | tpr=0.8820 | fpr=0.8733 | 7473.3 samples/s | 29.2 steps/s
[Step= 250] | Loss=8.84078 | acc=0.1406 | tpr=0.8769 | fpr=0.8728 | 7644.1 samples/s | 29.9 steps/s
[Step= 300] | Loss=8.84435 | acc=0.1400 | tpr=0.8756 | fpr=0.8734 | 8276.9 samples/s | 32.3 steps/s
[Step= 350] | Loss=8.83273 | acc=0.1399 | tpr=0.8810 | fpr=0.8736 | 7092.4 samples/s | 27.7 steps/s
[Step= 400] | Loss=8.83477 | acc=0.1400 | tpr=0.8791 | fpr=0.8734 | 7643.0 samples/s | 29.9 steps/s
[Step= 450] | Loss=8.84093 | acc=0.1404 | tpr=0.8788 | fpr=0.8730 | 7493.5 samples/s | 29.3 steps/s
[Step= 500] | Loss=8.84655 | acc=0.1398 | tpr=0.8802 | fpr=0.8736 | 7361.2 samples/s | 28.8 steps/s
[Step= 550] | Loss=8.84653 | acc=0.1398 | tpr=0.8794 | fpr=0.8736 | 13195.0 samples/s | 51.5 steps/s
Avg test loss: 8.84843, Avg test acc: 0.13969, Avg tpr: 0.87956, Avg fpr: 0.87376, total FA: 121320

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11405 | acc=0.9812 | tpr=0.9690 | fpr=0.0186 | 3978.6 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.11930 | acc=0.9804 | tpr=0.9723 | fpr=0.0195 | 7380.7 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.12568 | acc=0.9791 | tpr=0.9755 | fpr=0.0208 | 7603.4 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.12706 | acc=0.9791 | tpr=0.9749 | fpr=0.0208 | 7560.3 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.12534 | acc=0.9793 | tpr=0.9738 | fpr=0.0206 | 7488.5 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.12741 | acc=0.9790 | tpr=0.9738 | fpr=0.0209 | 8013.9 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.12805 | acc=0.9790 | tpr=0.9750 | fpr=0.0210 | 7563.3 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.12980 | acc=0.9788 | tpr=0.9732 | fpr=0.0211 | 7851.6 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.13259 | acc=0.9784 | tpr=0.9727 | fpr=0.0215 | 7678.7 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.13257 | acc=0.9783 | tpr=0.9727 | fpr=0.0216 | 7564.5 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.13155 | acc=0.9785 | tpr=0.9717 | fpr=0.0214 | 13910.2 samples/s | 54.3 steps/s
Avg test loss: 0.13125, Avg test acc: 0.97851, Avg tpr: 0.97187, Avg fpr: 0.02137, total FA: 2967

server round 32/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00013, len=1
[Step=25601 Epoch=25.0] | Loss=0.00064 | Reg=0.00360 | acc=1.0000 | L2-Norm=18.965 | L2-Norm(final)=2.461 | 4516.4 samples/s | 70.6 steps/s
[Step=25650 Epoch=25.0] | Loss=0.00495 | Reg=0.00360 | acc=1.0000 | L2-Norm=18.963 | L2-Norm(final)=2.462 | 4468.5 samples/s | 69.8 steps/s
[Step=25700 Epoch=25.1] | Loss=0.00463 | Reg=0.00360 | acc=1.0000 | L2-Norm=18.962 | L2-Norm(final)=2.463 | 4380.8 samples/s | 68.4 steps/s
[Step=25750 Epoch=25.1] | Loss=0.00462 | Reg=0.00360 | acc=0.9844 | L2-Norm=18.961 | L2-Norm(final)=2.464 | 4470.0 samples/s | 69.8 steps/s
[Step=25800 Epoch=25.2] | Loss=0.00429 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.959 | L2-Norm(final)=2.465 | 4447.8 samples/s | 69.5 steps/s
[Step=25850 Epoch=25.2] | Loss=0.00431 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.958 | L2-Norm(final)=2.466 | 4556.7 samples/s | 71.2 steps/s
[Step=25900 Epoch=25.3] | Loss=0.00455 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.957 | L2-Norm(final)=2.466 | 4583.5 samples/s | 71.6 steps/s
[Step=25950 Epoch=25.3] | Loss=0.00460 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.955 | L2-Norm(final)=2.467 | 4606.0 samples/s | 72.0 steps/s
[Step=26000 Epoch=25.4] | Loss=0.00453 | Reg=0.00359 | acc=0.9844 | L2-Norm=18.954 | L2-Norm(final)=2.468 | 4512.0 samples/s | 70.5 steps/s
[Step=26050 Epoch=25.4] | Loss=0.00484 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.952 | L2-Norm(final)=2.468 | 4576.0 samples/s | 71.5 steps/s
[Step=26100 Epoch=25.5] | Loss=0.00482 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.950 | L2-Norm(final)=2.469 | 4523.0 samples/s | 70.7 steps/s
[Step=26150 Epoch=25.5] | Loss=0.00484 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.949 | L2-Norm(final)=2.469 | 4526.6 samples/s | 70.7 steps/s
[Step=26200 Epoch=25.6] | Loss=0.00499 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.947 | L2-Norm(final)=2.470 | 4622.8 samples/s | 72.2 steps/s
[Step=26250 Epoch=25.6] | Loss=0.00498 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.945 | L2-Norm(final)=2.471 | 4532.9 samples/s | 70.8 steps/s
[Step=26300 Epoch=25.7] | Loss=0.00505 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.944 | L2-Norm(final)=2.471 | 4428.5 samples/s | 69.2 steps/s
[Step=26350 Epoch=25.7] | Loss=0.00513 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.942 | L2-Norm(final)=2.472 | 4598.3 samples/s | 71.8 steps/s
[Step=26400 Epoch=25.8] | Loss=0.00519 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.941 | L2-Norm(final)=2.472 | 4501.5 samples/s | 70.3 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step26400.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00013, len=1
[Step=25601 Epoch=48.3] | Loss=0.00001 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.235 | L2-Norm(final)=4.061 | 4039.5 samples/s | 63.1 steps/s
[Step=25650 Epoch=48.4] | Loss=0.00000 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.232 | L2-Norm(final)=4.064 | 4116.3 samples/s | 64.3 steps/s
[Step=25700 Epoch=48.4] | Loss=0.00000 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.228 | L2-Norm(final)=4.066 | 4274.3 samples/s | 66.8 steps/s
[Step=25750 Epoch=48.5] | Loss=0.00000 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.225 | L2-Norm(final)=4.069 | 4338.9 samples/s | 67.8 steps/s
[Step=25800 Epoch=48.6] | Loss=0.00000 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.221 | L2-Norm(final)=4.071 | 4353.9 samples/s | 68.0 steps/s
[Step=25850 Epoch=48.7] | Loss=0.00000 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.217 | L2-Norm(final)=4.074 | 4258.0 samples/s | 66.5 steps/s
[Step=25900 Epoch=48.8] | Loss=0.00000 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.213 | L2-Norm(final)=4.076 | 4281.6 samples/s | 66.9 steps/s
[Step=25950 Epoch=48.9] | Loss=0.00000 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.208 | L2-Norm(final)=4.079 | 4219.5 samples/s | 65.9 steps/s
[Step=26000 Epoch=49.0] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.204 | L2-Norm(final)=4.081 | 4236.5 samples/s | 66.2 steps/s
[Step=26050 Epoch=49.1] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.200 | L2-Norm(final)=4.084 | 4327.7 samples/s | 67.6 steps/s
[Step=26100 Epoch=49.2] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.195 | L2-Norm(final)=4.086 | 4158.1 samples/s | 65.0 steps/s
[Step=26150 Epoch=49.3] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.191 | L2-Norm(final)=4.089 | 2076.2 samples/s | 32.4 steps/s
[Step=26200 Epoch=49.4] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.187 | L2-Norm(final)=4.092 | 4305.6 samples/s | 67.3 steps/s
[Step=26250 Epoch=49.5] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.182 | L2-Norm(final)=4.094 | 4141.2 samples/s | 64.7 steps/s
[Step=26300 Epoch=49.6] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.178 | L2-Norm(final)=4.097 | 4155.6 samples/s | 64.9 steps/s
[Step=26350 Epoch=49.7] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.173 | L2-Norm(final)=4.100 | 4154.7 samples/s | 64.9 steps/s
[Step=26400 Epoch=49.8] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.169 | L2-Norm(final)=4.102 | 4139.2 samples/s | 64.7 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step26400.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09318 | acc=0.9723 | tpr=0.9760 | fpr=0.0359 | 3867.2 samples/s | 15.1 steps/s
Avg test loss: 0.09822, Avg test acc: 0.97127, Avg tpr: 0.97558, Avg fpr: 0.03820, total FA: 298

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.94257 | acc=0.3130 | tpr=0.0029 | fpr=0.0136 | 4115.8 samples/s | 16.1 steps/s
Avg test loss: 4.96523, Avg test acc: 0.30960, Avg tpr: 0.00256, Avg fpr: 0.01513, total FA: 118

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.70211 | acc=0.1464 | tpr=0.8805 | fpr=0.8668 | 3988.8 samples/s | 15.6 steps/s
[Step= 100] | Loss=8.64051 | acc=0.1477 | tpr=0.8721 | fpr=0.8658 | 7456.6 samples/s | 29.1 steps/s
[Step= 150] | Loss=8.66895 | acc=0.1480 | tpr=0.8703 | fpr=0.8653 | 7345.1 samples/s | 28.7 steps/s
[Step= 200] | Loss=8.65449 | acc=0.1483 | tpr=0.8710 | fpr=0.8649 | 7356.6 samples/s | 28.7 steps/s
[Step= 250] | Loss=8.64906 | acc=0.1487 | tpr=0.8646 | fpr=0.8643 | 7327.9 samples/s | 28.6 steps/s
[Step= 300] | Loss=8.65171 | acc=0.1482 | tpr=0.8655 | fpr=0.8649 | 7625.6 samples/s | 29.8 steps/s
[Step= 350] | Loss=8.64022 | acc=0.1480 | tpr=0.8685 | fpr=0.8651 | 7151.5 samples/s | 27.9 steps/s
[Step= 400] | Loss=8.64227 | acc=0.1481 | tpr=0.8654 | fpr=0.8649 | 7327.8 samples/s | 28.6 steps/s
[Step= 450] | Loss=8.64820 | acc=0.1482 | tpr=0.8661 | fpr=0.8648 | 7572.3 samples/s | 29.6 steps/s
[Step= 500] | Loss=8.65228 | acc=0.1477 | tpr=0.8683 | fpr=0.8653 | 7359.4 samples/s | 28.7 steps/s
[Step= 550] | Loss=8.65221 | acc=0.1478 | tpr=0.8703 | fpr=0.8654 | 9317.4 samples/s | 36.4 steps/s
Avg test loss: 8.65416, Avg test acc: 0.14769, Avg tpr: 0.87044, Avg fpr: 0.86545, total FA: 120166

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11758 | acc=0.9808 | tpr=0.9690 | fpr=0.0190 | 4230.4 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.12297 | acc=0.9797 | tpr=0.9723 | fpr=0.0201 | 7631.2 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.12942 | acc=0.9785 | tpr=0.9755 | fpr=0.0214 | 7626.1 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.13080 | acc=0.9785 | tpr=0.9749 | fpr=0.0215 | 7690.3 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.12908 | acc=0.9786 | tpr=0.9747 | fpr=0.0213 | 7633.8 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.13118 | acc=0.9783 | tpr=0.9745 | fpr=0.0216 | 8241.9 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.13182 | acc=0.9782 | tpr=0.9756 | fpr=0.0217 | 7530.3 samples/s | 29.4 steps/s
[Step= 400] | Loss=0.13357 | acc=0.9781 | tpr=0.9737 | fpr=0.0219 | 7578.5 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.13638 | acc=0.9778 | tpr=0.9732 | fpr=0.0221 | 7668.4 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.13636 | acc=0.9777 | tpr=0.9736 | fpr=0.0223 | 5280.2 samples/s | 20.6 steps/s
[Step= 550] | Loss=0.13530 | acc=0.9778 | tpr=0.9725 | fpr=0.0221 | 14073.4 samples/s | 55.0 steps/s
Avg test loss: 0.13500, Avg test acc: 0.97784, Avg tpr: 0.97266, Avg fpr: 0.02207, total FA: 3064

server round 33/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00013, len=1
[Step=26401 Epoch=25.8] | Loss=0.00129 | Reg=0.00358 | acc=1.0000 | L2-Norm=18.916 | L2-Norm(final)=2.479 | 4357.3 samples/s | 68.1 steps/s
[Step=26450 Epoch=25.8] | Loss=0.00371 | Reg=0.00358 | acc=0.9844 | L2-Norm=18.915 | L2-Norm(final)=2.480 | 4086.3 samples/s | 63.8 steps/s
[Step=26500 Epoch=25.9] | Loss=0.00400 | Reg=0.00358 | acc=1.0000 | L2-Norm=18.914 | L2-Norm(final)=2.481 | 4452.0 samples/s | 69.6 steps/s
[Step=26550 Epoch=25.9] | Loss=0.00450 | Reg=0.00358 | acc=1.0000 | L2-Norm=18.913 | L2-Norm(final)=2.483 | 4534.2 samples/s | 70.8 steps/s
[Step=26600 Epoch=26.0] | Loss=0.00448 | Reg=0.00358 | acc=0.9844 | L2-Norm=18.912 | L2-Norm(final)=2.484 | 4585.4 samples/s | 71.6 steps/s
[Step=26650 Epoch=26.0] | Loss=0.00476 | Reg=0.00358 | acc=1.0000 | L2-Norm=18.910 | L2-Norm(final)=2.485 | 4262.1 samples/s | 66.6 steps/s
[Step=26700 Epoch=26.1] | Loss=0.00490 | Reg=0.00358 | acc=1.0000 | L2-Norm=18.909 | L2-Norm(final)=2.485 | 4385.8 samples/s | 68.5 steps/s
[Step=26750 Epoch=26.1] | Loss=0.00491 | Reg=0.00357 | acc=1.0000 | L2-Norm=18.908 | L2-Norm(final)=2.486 | 4455.0 samples/s | 69.6 steps/s
[Step=26800 Epoch=26.2] | Loss=0.00497 | Reg=0.00357 | acc=0.9844 | L2-Norm=18.906 | L2-Norm(final)=2.486 | 4537.1 samples/s | 70.9 steps/s
[Step=26850 Epoch=26.2] | Loss=0.00491 | Reg=0.00357 | acc=1.0000 | L2-Norm=18.904 | L2-Norm(final)=2.487 | 4467.6 samples/s | 69.8 steps/s
[Step=26900 Epoch=26.3] | Loss=0.00491 | Reg=0.00357 | acc=1.0000 | L2-Norm=18.903 | L2-Norm(final)=2.487 | 4456.6 samples/s | 69.6 steps/s
[Step=26950 Epoch=26.3] | Loss=0.00493 | Reg=0.00357 | acc=0.9844 | L2-Norm=18.901 | L2-Norm(final)=2.488 | 4354.2 samples/s | 68.0 steps/s
[Step=27000 Epoch=26.4] | Loss=0.00493 | Reg=0.00357 | acc=0.9844 | L2-Norm=18.899 | L2-Norm(final)=2.488 | 4325.2 samples/s | 67.6 steps/s
[Step=27050 Epoch=26.4] | Loss=0.00495 | Reg=0.00357 | acc=0.9688 | L2-Norm=18.898 | L2-Norm(final)=2.489 | 4325.2 samples/s | 67.6 steps/s
[Step=27100 Epoch=26.5] | Loss=0.00490 | Reg=0.00357 | acc=1.0000 | L2-Norm=18.896 | L2-Norm(final)=2.489 | 4345.9 samples/s | 67.9 steps/s
[Step=27150 Epoch=26.5] | Loss=0.00502 | Reg=0.00357 | acc=1.0000 | L2-Norm=18.894 | L2-Norm(final)=2.489 | 4327.3 samples/s | 67.6 steps/s
[Step=27200 Epoch=26.6] | Loss=0.00499 | Reg=0.00357 | acc=0.9844 | L2-Norm=18.893 | L2-Norm(final)=2.490 | 4404.1 samples/s | 68.8 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step27200.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00013, len=1
[Step=26401 Epoch=49.8] | Loss=0.00001 | Reg=0.00037 | acc=1.0000 | L2-Norm=6.094 | L2-Norm(final)=4.146 | 4489.4 samples/s | 70.1 steps/s
[Step=26450 Epoch=49.9] | Loss=0.00000 | Reg=0.00037 | acc=1.0000 | L2-Norm=6.089 | L2-Norm(final)=4.149 | 3649.0 samples/s | 57.0 steps/s
[Step=26500 Epoch=50.0] | Loss=0.00000 | Reg=0.00037 | acc=1.0000 | L2-Norm=6.083 | L2-Norm(final)=4.152 | 4157.7 samples/s | 65.0 steps/s
[Step=26550 Epoch=50.0] | Loss=0.00000 | Reg=0.00037 | acc=1.0000 | L2-Norm=6.078 | L2-Norm(final)=4.155 | 4198.6 samples/s | 65.6 steps/s
[Step=26600 Epoch=50.1] | Loss=0.00000 | Reg=0.00037 | acc=1.0000 | L2-Norm=6.073 | L2-Norm(final)=4.158 | 4272.9 samples/s | 66.8 steps/s
[Step=26650 Epoch=50.2] | Loss=0.00000 | Reg=0.00037 | acc=1.0000 | L2-Norm=6.068 | L2-Norm(final)=4.161 | 4286.6 samples/s | 67.0 steps/s
[Step=26700 Epoch=50.3] | Loss=0.00000 | Reg=0.00037 | acc=1.0000 | L2-Norm=6.062 | L2-Norm(final)=4.165 | 4137.2 samples/s | 64.6 steps/s
[Step=26750 Epoch=50.4] | Loss=0.00000 | Reg=0.00037 | acc=1.0000 | L2-Norm=6.057 | L2-Norm(final)=4.168 | 4106.1 samples/s | 64.2 steps/s
[Step=26800 Epoch=50.5] | Loss=0.00000 | Reg=0.00037 | acc=1.0000 | L2-Norm=6.051 | L2-Norm(final)=4.171 | 4155.6 samples/s | 64.9 steps/s
[Step=26850 Epoch=50.6] | Loss=0.00000 | Reg=0.00037 | acc=1.0000 | L2-Norm=6.045 | L2-Norm(final)=4.175 | 4200.3 samples/s | 65.6 steps/s
[Step=26900 Epoch=50.7] | Loss=0.00000 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.039 | L2-Norm(final)=4.178 | 4192.6 samples/s | 65.5 steps/s
[Step=26950 Epoch=50.8] | Loss=0.00000 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.033 | L2-Norm(final)=4.181 | 2047.1 samples/s | 32.0 steps/s
[Step=27000 Epoch=50.9] | Loss=0.00000 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.027 | L2-Norm(final)=4.185 | 4091.2 samples/s | 63.9 steps/s
[Step=27050 Epoch=51.0] | Loss=0.00000 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.021 | L2-Norm(final)=4.188 | 4150.6 samples/s | 64.9 steps/s
[Step=27100 Epoch=51.1] | Loss=0.00000 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.015 | L2-Norm(final)=4.192 | 4164.8 samples/s | 65.1 steps/s
[Step=27150 Epoch=51.2] | Loss=0.00000 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.009 | L2-Norm(final)=4.195 | 4187.6 samples/s | 65.4 steps/s
[Step=27200 Epoch=51.3] | Loss=0.00000 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.003 | L2-Norm(final)=4.199 | 4162.5 samples/s | 65.0 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step27200.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10040 | acc=0.9726 | tpr=0.9772 | fpr=0.0374 | 3969.6 samples/s | 15.5 steps/s
Avg test loss: 0.10444, Avg test acc: 0.97203, Avg tpr: 0.97715, Avg fpr: 0.03923, total FA: 306

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.18461 | acc=0.3137 | tpr=0.0021 | fpr=0.0094 | 4017.3 samples/s | 15.7 steps/s
Avg test loss: 5.20808, Avg test acc: 0.31108, Avg tpr: 0.00198, Avg fpr: 0.00910, total FA: 71

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.94082 | acc=0.1466 | tpr=0.8761 | fpr=0.8665 | 4192.6 samples/s | 16.4 steps/s
[Step= 100] | Loss=8.87545 | acc=0.1477 | tpr=0.8699 | fpr=0.8657 | 7653.3 samples/s | 29.9 steps/s
[Step= 150] | Loss=8.90572 | acc=0.1471 | tpr=0.8660 | fpr=0.8661 | 7851.5 samples/s | 30.7 steps/s
[Step= 200] | Loss=8.88951 | acc=0.1473 | tpr=0.8678 | fpr=0.8658 | 7390.3 samples/s | 28.9 steps/s
[Step= 250] | Loss=8.88445 | acc=0.1480 | tpr=0.8585 | fpr=0.8650 | 8258.5 samples/s | 32.3 steps/s
[Step= 300] | Loss=8.88639 | acc=0.1477 | tpr=0.8611 | fpr=0.8653 | 7771.3 samples/s | 30.4 steps/s
[Step= 350] | Loss=8.87445 | acc=0.1473 | tpr=0.8654 | fpr=0.8657 | 7725.1 samples/s | 30.2 steps/s
[Step= 400] | Loss=8.87695 | acc=0.1474 | tpr=0.8643 | fpr=0.8656 | 7870.8 samples/s | 30.7 steps/s
[Step= 450] | Loss=8.88323 | acc=0.1477 | tpr=0.8647 | fpr=0.8653 | 7434.7 samples/s | 29.0 steps/s
[Step= 500] | Loss=8.88872 | acc=0.1472 | tpr=0.8665 | fpr=0.8658 | 7951.9 samples/s | 31.1 steps/s
[Step= 550] | Loss=8.88859 | acc=0.1472 | tpr=0.8683 | fpr=0.8659 | 14927.7 samples/s | 58.3 steps/s
Avg test loss: 8.89051, Avg test acc: 0.14706, Avg tpr: 0.86807, Avg fpr: 0.86605, total FA: 120249

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11014 | acc=0.9820 | tpr=0.9690 | fpr=0.0178 | 4213.4 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.11514 | acc=0.9812 | tpr=0.9723 | fpr=0.0187 | 7733.5 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.12086 | acc=0.9800 | tpr=0.9741 | fpr=0.0199 | 7541.8 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.12232 | acc=0.9801 | tpr=0.9727 | fpr=0.0198 | 8064.2 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.12060 | acc=0.9802 | tpr=0.9721 | fpr=0.0196 | 7739.1 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.12269 | acc=0.9800 | tpr=0.9716 | fpr=0.0199 | 7247.7 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.12327 | acc=0.9798 | tpr=0.9724 | fpr=0.0200 | 7541.9 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.12490 | acc=0.9796 | tpr=0.9710 | fpr=0.0203 | 5464.0 samples/s | 21.3 steps/s
[Step= 450] | Loss=0.12758 | acc=0.9793 | tpr=0.9708 | fpr=0.0206 | 7517.7 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.12743 | acc=0.9792 | tpr=0.9705 | fpr=0.0207 | 7301.9 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.12647 | acc=0.9793 | tpr=0.9698 | fpr=0.0205 | 13994.2 samples/s | 54.7 steps/s
Avg test loss: 0.12619, Avg test acc: 0.97935, Avg tpr: 0.96949, Avg fpr: 0.02047, total FA: 2842

server round 34/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00013, len=1
[Step=27201 Epoch=26.6] | Loss=0.01874 | Reg=0.00356 | acc=0.9844 | L2-Norm=18.866 | L2-Norm(final)=2.497 | 4786.8 samples/s | 74.8 steps/s
[Step=27250 Epoch=26.6] | Loss=0.00477 | Reg=0.00356 | acc=1.0000 | L2-Norm=18.865 | L2-Norm(final)=2.498 | 3996.7 samples/s | 62.4 steps/s
[Step=27300 Epoch=26.7] | Loss=0.00454 | Reg=0.00356 | acc=1.0000 | L2-Norm=18.864 | L2-Norm(final)=2.500 | 4489.1 samples/s | 70.1 steps/s
[Step=27350 Epoch=26.7] | Loss=0.00446 | Reg=0.00356 | acc=0.9844 | L2-Norm=18.862 | L2-Norm(final)=2.501 | 4406.3 samples/s | 68.8 steps/s
[Step=27400 Epoch=26.8] | Loss=0.00438 | Reg=0.00356 | acc=1.0000 | L2-Norm=18.861 | L2-Norm(final)=2.502 | 4373.4 samples/s | 68.3 steps/s
[Step=27450 Epoch=26.8] | Loss=0.00470 | Reg=0.00356 | acc=0.9688 | L2-Norm=18.859 | L2-Norm(final)=2.502 | 4304.5 samples/s | 67.3 steps/s
[Step=27500 Epoch=26.8] | Loss=0.00454 | Reg=0.00356 | acc=1.0000 | L2-Norm=18.858 | L2-Norm(final)=2.503 | 4392.8 samples/s | 68.6 steps/s
[Step=27550 Epoch=26.9] | Loss=0.00462 | Reg=0.00356 | acc=1.0000 | L2-Norm=18.856 | L2-Norm(final)=2.503 | 4412.5 samples/s | 68.9 steps/s
[Step=27600 Epoch=26.9] | Loss=0.00476 | Reg=0.00356 | acc=1.0000 | L2-Norm=18.855 | L2-Norm(final)=2.504 | 4389.0 samples/s | 68.6 steps/s
[Step=27650 Epoch=27.0] | Loss=0.00486 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.853 | L2-Norm(final)=2.505 | 4388.5 samples/s | 68.6 steps/s
[Step=27700 Epoch=27.0] | Loss=0.00484 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.852 | L2-Norm(final)=2.505 | 4357.3 samples/s | 68.1 steps/s
[Step=27750 Epoch=27.1] | Loss=0.00488 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.850 | L2-Norm(final)=2.505 | 4371.3 samples/s | 68.3 steps/s
[Step=27800 Epoch=27.1] | Loss=0.00508 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.848 | L2-Norm(final)=2.506 | 4430.8 samples/s | 69.2 steps/s
[Step=27850 Epoch=27.2] | Loss=0.00499 | Reg=0.00355 | acc=0.9844 | L2-Norm=18.847 | L2-Norm(final)=2.506 | 4376.3 samples/s | 68.4 steps/s
[Step=27900 Epoch=27.2] | Loss=0.00498 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.845 | L2-Norm(final)=2.506 | 4443.9 samples/s | 69.4 steps/s
[Step=27950 Epoch=27.3] | Loss=0.00489 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.843 | L2-Norm(final)=2.507 | 4398.8 samples/s | 68.7 steps/s
[Step=28000 Epoch=27.3] | Loss=0.00505 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.842 | L2-Norm(final)=2.507 | 4304.7 samples/s | 67.3 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step28000.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00013, len=1
[Step=27201 Epoch=51.3] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.905 | L2-Norm(final)=4.259 | 4102.7 samples/s | 64.1 steps/s
[Step=27250 Epoch=51.4] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.898 | L2-Norm(final)=4.263 | 3777.1 samples/s | 59.0 steps/s
[Step=27300 Epoch=51.5] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.891 | L2-Norm(final)=4.267 | 4279.5 samples/s | 66.9 steps/s
[Step=27350 Epoch=51.6] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.884 | L2-Norm(final)=4.271 | 4153.0 samples/s | 64.9 steps/s
[Step=27400 Epoch=51.6] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.877 | L2-Norm(final)=4.275 | 4105.5 samples/s | 64.1 steps/s
[Step=27450 Epoch=51.7] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.870 | L2-Norm(final)=4.280 | 4177.4 samples/s | 65.3 steps/s
[Step=27500 Epoch=51.8] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.863 | L2-Norm(final)=4.284 | 4264.8 samples/s | 66.6 steps/s
[Step=27550 Epoch=51.9] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.856 | L2-Norm(final)=4.289 | 4398.4 samples/s | 68.7 steps/s
[Step=27600 Epoch=52.0] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.849 | L2-Norm(final)=4.294 | 4327.3 samples/s | 67.6 steps/s
[Step=27650 Epoch=52.1] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.842 | L2-Norm(final)=4.299 | 4343.1 samples/s | 67.9 steps/s
[Step=27700 Epoch=52.2] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.835 | L2-Norm(final)=4.304 | 4325.2 samples/s | 67.6 steps/s
[Step=27750 Epoch=52.3] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.828 | L2-Norm(final)=4.308 | 2096.8 samples/s | 32.8 steps/s
[Step=27800 Epoch=52.4] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.820 | L2-Norm(final)=4.313 | 4412.6 samples/s | 68.9 steps/s
[Step=27850 Epoch=52.5] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.813 | L2-Norm(final)=4.318 | 4319.3 samples/s | 67.5 steps/s
[Step=27900 Epoch=52.6] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.806 | L2-Norm(final)=4.323 | 4205.4 samples/s | 65.7 steps/s
[Step=27950 Epoch=52.7] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.799 | L2-Norm(final)=4.328 | 4282.2 samples/s | 66.9 steps/s
[Step=28000 Epoch=52.8] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.791 | L2-Norm(final)=4.333 | 4317.0 samples/s | 67.5 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step28000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10606 | acc=0.9715 | tpr=0.9809 | fpr=0.0491 | 4106.0 samples/s | 16.0 steps/s
Avg test loss: 0.11011, Avg test acc: 0.97095, Avg tpr: 0.98053, Avg fpr: 0.05012, total FA: 391

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.11349 | acc=0.3139 | tpr=0.0027 | fpr=0.0104 | 4191.6 samples/s | 16.4 steps/s
Avg test loss: 5.13654, Avg test acc: 0.31084, Avg tpr: 0.00245, Avg fpr: 0.01090, total FA: 85

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=9.58937 | acc=0.1278 | tpr=0.9425 | fpr=0.8868 | 4244.0 samples/s | 16.6 steps/s
[Step= 100] | Loss=9.52865 | acc=0.1291 | tpr=0.9211 | fpr=0.8857 | 7235.0 samples/s | 28.3 steps/s
[Step= 150] | Loss=9.56126 | acc=0.1277 | tpr=0.9121 | fpr=0.8868 | 8049.5 samples/s | 31.4 steps/s
[Step= 200] | Loss=9.54473 | acc=0.1273 | tpr=0.9071 | fpr=0.8868 | 7541.3 samples/s | 29.5 steps/s
[Step= 250] | Loss=9.54011 | acc=0.1282 | tpr=0.9004 | fpr=0.8858 | 8014.5 samples/s | 31.3 steps/s
[Step= 300] | Loss=9.54367 | acc=0.1278 | tpr=0.9025 | fpr=0.8864 | 5205.4 samples/s | 20.3 steps/s
[Step= 350] | Loss=9.53386 | acc=0.1277 | tpr=0.9080 | fpr=0.8865 | 7567.6 samples/s | 29.6 steps/s
[Step= 400] | Loss=9.53636 | acc=0.1277 | tpr=0.9054 | fpr=0.8864 | 7778.5 samples/s | 30.4 steps/s
[Step= 450] | Loss=9.54254 | acc=0.1278 | tpr=0.9051 | fpr=0.8863 | 7430.6 samples/s | 29.0 steps/s
[Step= 500] | Loss=9.54830 | acc=0.1273 | tpr=0.9062 | fpr=0.8868 | 6437.1 samples/s | 25.1 steps/s
[Step= 550] | Loss=9.54873 | acc=0.1274 | tpr=0.9065 | fpr=0.8868 | 13736.5 samples/s | 53.7 steps/s
Avg test loss: 9.55016, Avg test acc: 0.12721, Avg tpr: 0.90650, Avg fpr: 0.88696, total FA: 123152

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11856 | acc=0.9810 | tpr=0.9690 | fpr=0.0188 | 4137.1 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.12365 | acc=0.9803 | tpr=0.9723 | fpr=0.0196 | 8275.2 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.12969 | acc=0.9792 | tpr=0.9769 | fpr=0.0208 | 7239.4 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.13124 | acc=0.9791 | tpr=0.9749 | fpr=0.0208 | 7272.4 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.12941 | acc=0.9793 | tpr=0.9747 | fpr=0.0206 | 7229.0 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.13164 | acc=0.9790 | tpr=0.9745 | fpr=0.0209 | 5548.8 samples/s | 21.7 steps/s
[Step= 350] | Loss=0.13231 | acc=0.9789 | tpr=0.9750 | fpr=0.0211 | 6905.6 samples/s | 27.0 steps/s
[Step= 400] | Loss=0.13394 | acc=0.9786 | tpr=0.9737 | fpr=0.0213 | 7815.9 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.13679 | acc=0.9782 | tpr=0.9732 | fpr=0.0217 | 5893.2 samples/s | 23.0 steps/s
[Step= 500] | Loss=0.13655 | acc=0.9781 | tpr=0.9727 | fpr=0.0218 | 7126.6 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.13554 | acc=0.9783 | tpr=0.9717 | fpr=0.0216 | 12856.5 samples/s | 50.2 steps/s
Avg test loss: 0.13524, Avg test acc: 0.97828, Avg tpr: 0.97147, Avg fpr: 0.02159, total FA: 2998

server round 35/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00013, len=1
[Step=28001 Epoch=27.3] | Loss=0.00129 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.820 | L2-Norm(final)=2.511 | 4476.9 samples/s | 70.0 steps/s
[Step=28050 Epoch=27.4] | Loss=0.00372 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.819 | L2-Norm(final)=2.513 | 3968.8 samples/s | 62.0 steps/s
[Step=28100 Epoch=27.4] | Loss=0.00474 | Reg=0.00354 | acc=0.9844 | L2-Norm=18.817 | L2-Norm(final)=2.514 | 4328.7 samples/s | 67.6 steps/s
[Step=28150 Epoch=27.5] | Loss=0.00462 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.815 | L2-Norm(final)=2.515 | 4384.6 samples/s | 68.5 steps/s
[Step=28200 Epoch=27.5] | Loss=0.00470 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.814 | L2-Norm(final)=2.516 | 4257.6 samples/s | 66.5 steps/s
[Step=28250 Epoch=27.6] | Loss=0.00505 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.812 | L2-Norm(final)=2.516 | 4513.6 samples/s | 70.5 steps/s
[Step=28300 Epoch=27.6] | Loss=0.00499 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.810 | L2-Norm(final)=2.516 | 4407.1 samples/s | 68.9 steps/s
[Step=28350 Epoch=27.7] | Loss=0.00527 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.809 | L2-Norm(final)=2.517 | 4398.2 samples/s | 68.7 steps/s
[Step=28400 Epoch=27.7] | Loss=0.00519 | Reg=0.00354 | acc=0.9844 | L2-Norm=18.807 | L2-Norm(final)=2.517 | 4561.2 samples/s | 71.3 steps/s
[Step=28450 Epoch=27.8] | Loss=0.00504 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.805 | L2-Norm(final)=2.517 | 4484.0 samples/s | 70.1 steps/s
[Step=28500 Epoch=27.8] | Loss=0.00506 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.804 | L2-Norm(final)=2.518 | 4516.2 samples/s | 70.6 steps/s
[Step=28550 Epoch=27.9] | Loss=0.00507 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.802 | L2-Norm(final)=2.518 | 4595.1 samples/s | 71.8 steps/s
[Step=28600 Epoch=27.9] | Loss=0.00503 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.801 | L2-Norm(final)=2.519 | 4571.1 samples/s | 71.4 steps/s
[Step=28650 Epoch=28.0] | Loss=0.00507 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.799 | L2-Norm(final)=2.520 | 4403.8 samples/s | 68.8 steps/s
[Step=28700 Epoch=28.0] | Loss=0.00496 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.798 | L2-Norm(final)=2.520 | 4488.2 samples/s | 70.1 steps/s
[Step=28750 Epoch=28.1] | Loss=0.00490 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.797 | L2-Norm(final)=2.521 | 4419.7 samples/s | 69.1 steps/s
[Step=28800 Epoch=28.1] | Loss=0.00501 | Reg=0.00353 | acc=0.9531 | L2-Norm=18.795 | L2-Norm(final)=2.521 | 4530.0 samples/s | 70.8 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step28800.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00013, len=1
[Step=28001 Epoch=52.8] | Loss=0.00001 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.668 | L2-Norm(final)=4.412 | 3954.5 samples/s | 61.8 steps/s
[Step=28050 Epoch=52.9] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.661 | L2-Norm(final)=4.419 | 4286.1 samples/s | 67.0 steps/s
[Step=28100 Epoch=53.0] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.653 | L2-Norm(final)=4.424 | 4226.2 samples/s | 66.0 steps/s
[Step=28150 Epoch=53.1] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.644 | L2-Norm(final)=4.429 | 4245.2 samples/s | 66.3 steps/s
[Step=28200 Epoch=53.2] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.635 | L2-Norm(final)=4.434 | 4265.1 samples/s | 66.6 steps/s
[Step=28250 Epoch=53.3] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.628 | L2-Norm(final)=4.440 | 4342.8 samples/s | 67.9 steps/s
[Step=28300 Epoch=53.3] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.619 | L2-Norm(final)=4.445 | 4358.5 samples/s | 68.1 steps/s
[Step=28350 Epoch=53.4] | Loss=0.00000 | Reg=0.00031 | acc=1.0000 | L2-Norm=5.610 | L2-Norm(final)=4.450 | 4224.4 samples/s | 66.0 steps/s
[Step=28400 Epoch=53.5] | Loss=0.00000 | Reg=0.00031 | acc=1.0000 | L2-Norm=5.600 | L2-Norm(final)=4.455 | 4284.0 samples/s | 66.9 steps/s
[Step=28450 Epoch=53.6] | Loss=0.00000 | Reg=0.00031 | acc=1.0000 | L2-Norm=5.591 | L2-Norm(final)=4.460 | 4257.8 samples/s | 66.5 steps/s
[Step=28500 Epoch=53.7] | Loss=0.00000 | Reg=0.00031 | acc=1.0000 | L2-Norm=5.582 | L2-Norm(final)=4.466 | 4201.8 samples/s | 65.7 steps/s
[Step=28550 Epoch=53.8] | Loss=0.00000 | Reg=0.00031 | acc=1.0000 | L2-Norm=5.574 | L2-Norm(final)=4.472 | 2158.6 samples/s | 33.7 steps/s
[Step=28600 Epoch=53.9] | Loss=0.00000 | Reg=0.00031 | acc=1.0000 | L2-Norm=5.565 | L2-Norm(final)=4.478 | 4195.1 samples/s | 65.5 steps/s
[Step=28650 Epoch=54.0] | Loss=0.00000 | Reg=0.00031 | acc=1.0000 | L2-Norm=5.555 | L2-Norm(final)=4.484 | 4249.7 samples/s | 66.4 steps/s
[Step=28700 Epoch=54.1] | Loss=0.00000 | Reg=0.00031 | acc=1.0000 | L2-Norm=5.546 | L2-Norm(final)=4.489 | 4259.6 samples/s | 66.6 steps/s
[Step=28750 Epoch=54.2] | Loss=0.00000 | Reg=0.00031 | acc=1.0000 | L2-Norm=5.536 | L2-Norm(final)=4.495 | 4365.8 samples/s | 68.2 steps/s
[Step=28800 Epoch=54.3] | Loss=0.00004 | Reg=0.00031 | acc=1.0000 | L2-Norm=5.528 | L2-Norm(final)=4.501 | 4344.4 samples/s | 67.9 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step28800.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10218 | acc=0.9715 | tpr=0.9776 | fpr=0.0419 | 4122.7 samples/s | 16.1 steps/s
Avg test loss: 0.10777, Avg test acc: 0.97115, Avg tpr: 0.97779, Avg fpr: 0.04346, total FA: 339

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.27692 | acc=0.3125 | tpr=0.0058 | fpr=0.0216 | 4076.2 samples/s | 15.9 steps/s
Avg test loss: 4.29220, Avg test acc: 0.30992, Avg tpr: 0.00577, Avg fpr: 0.02115, total FA: 165

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=9.50284 | acc=0.1359 | tpr=0.9248 | fpr=0.8782 | 4361.7 samples/s | 17.0 steps/s
[Step= 100] | Loss=9.43542 | acc=0.1384 | tpr=0.9062 | fpr=0.8759 | 6996.6 samples/s | 27.3 steps/s
[Step= 150] | Loss=9.46981 | acc=0.1376 | tpr=0.8991 | fpr=0.8764 | 7705.1 samples/s | 30.1 steps/s
[Step= 200] | Loss=9.45402 | acc=0.1372 | tpr=0.8940 | fpr=0.8765 | 4793.8 samples/s | 18.7 steps/s
[Step= 250] | Loss=9.44906 | acc=0.1378 | tpr=0.8865 | fpr=0.8759 | 7610.8 samples/s | 29.7 steps/s
[Step= 300] | Loss=9.45223 | acc=0.1375 | tpr=0.8887 | fpr=0.8762 | 7502.0 samples/s | 29.3 steps/s
[Step= 350] | Loss=9.44162 | acc=0.1375 | tpr=0.8929 | fpr=0.8762 | 7242.1 samples/s | 28.3 steps/s
[Step= 400] | Loss=9.44518 | acc=0.1377 | tpr=0.8911 | fpr=0.8760 | 7196.4 samples/s | 28.1 steps/s
[Step= 450] | Loss=9.45170 | acc=0.1379 | tpr=0.8900 | fpr=0.8758 | 7190.5 samples/s | 28.1 steps/s
[Step= 500] | Loss=9.45679 | acc=0.1373 | tpr=0.8903 | fpr=0.8763 | 7287.7 samples/s | 28.5 steps/s
[Step= 550] | Loss=9.45686 | acc=0.1373 | tpr=0.8906 | fpr=0.8764 | 13525.4 samples/s | 52.8 steps/s
Avg test loss: 9.45884, Avg test acc: 0.13722, Avg tpr: 0.89065, Avg fpr: 0.87648, total FA: 121697

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.16046 | acc=0.9744 | tpr=0.9779 | fpr=0.0257 | 4020.8 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.16693 | acc=0.9740 | tpr=0.9829 | fpr=0.0261 | 7539.1 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.17495 | acc=0.9732 | tpr=0.9841 | fpr=0.0271 | 5390.6 samples/s | 21.1 steps/s
[Step= 200] | Loss=0.17658 | acc=0.9729 | tpr=0.9836 | fpr=0.0272 | 6562.9 samples/s | 25.6 steps/s
[Step= 250] | Loss=0.17473 | acc=0.9730 | tpr=0.9843 | fpr=0.0272 | 7870.3 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.17749 | acc=0.9728 | tpr=0.9818 | fpr=0.0274 | 7812.9 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.17886 | acc=0.9724 | tpr=0.9818 | fpr=0.0277 | 7046.3 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.18067 | acc=0.9722 | tpr=0.9798 | fpr=0.0280 | 7984.3 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.18403 | acc=0.9718 | tpr=0.9791 | fpr=0.0283 | 7106.6 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.18352 | acc=0.9720 | tpr=0.9793 | fpr=0.0282 | 7871.4 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.18198 | acc=0.9722 | tpr=0.9793 | fpr=0.0279 | 14976.7 samples/s | 58.5 steps/s
Avg test loss: 0.18166, Avg test acc: 0.97222, Avg tpr: 0.97940, Avg fpr: 0.02791, total FA: 3875

server round 36/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00013, len=1
[Step=28801 Epoch=28.1] | Loss=0.00358 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.774 | L2-Norm(final)=2.530 | 4282.1 samples/s | 66.9 steps/s
[Step=28850 Epoch=28.2] | Loss=0.00437 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.772 | L2-Norm(final)=2.531 | 4189.6 samples/s | 65.5 steps/s
[Step=28900 Epoch=28.2] | Loss=0.00477 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.771 | L2-Norm(final)=2.531 | 4388.7 samples/s | 68.6 steps/s
[Step=28950 Epoch=28.3] | Loss=0.00474 | Reg=0.00352 | acc=0.9844 | L2-Norm=18.770 | L2-Norm(final)=2.532 | 4578.0 samples/s | 71.5 steps/s
[Step=29000 Epoch=28.3] | Loss=0.00446 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.768 | L2-Norm(final)=2.533 | 4537.3 samples/s | 70.9 steps/s
[Step=29050 Epoch=28.4] | Loss=0.00457 | Reg=0.00352 | acc=0.9688 | L2-Norm=18.767 | L2-Norm(final)=2.533 | 4492.2 samples/s | 70.2 steps/s
[Step=29100 Epoch=28.4] | Loss=0.00475 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.765 | L2-Norm(final)=2.534 | 4516.0 samples/s | 70.6 steps/s
[Step=29150 Epoch=28.5] | Loss=0.00465 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.764 | L2-Norm(final)=2.535 | 4444.3 samples/s | 69.4 steps/s
[Step=29200 Epoch=28.5] | Loss=0.00476 | Reg=0.00352 | acc=0.9844 | L2-Norm=18.762 | L2-Norm(final)=2.535 | 4538.0 samples/s | 70.9 steps/s
[Step=29250 Epoch=28.6] | Loss=0.00485 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.761 | L2-Norm(final)=2.536 | 4559.1 samples/s | 71.2 steps/s
[Step=29300 Epoch=28.6] | Loss=0.00483 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.760 | L2-Norm(final)=2.537 | 4579.8 samples/s | 71.6 steps/s
[Step=29350 Epoch=28.7] | Loss=0.00493 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.758 | L2-Norm(final)=2.537 | 4515.2 samples/s | 70.6 steps/s
[Step=29400 Epoch=28.7] | Loss=0.00484 | Reg=0.00352 | acc=0.9844 | L2-Norm=18.757 | L2-Norm(final)=2.537 | 4546.5 samples/s | 71.0 steps/s
[Step=29450 Epoch=28.8] | Loss=0.00483 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.755 | L2-Norm(final)=2.538 | 4452.6 samples/s | 69.6 steps/s
[Step=29500 Epoch=28.8] | Loss=0.00487 | Reg=0.00352 | acc=0.9844 | L2-Norm=18.754 | L2-Norm(final)=2.538 | 4549.4 samples/s | 71.1 steps/s
[Step=29550 Epoch=28.9] | Loss=0.00490 | Reg=0.00352 | acc=0.9844 | L2-Norm=18.753 | L2-Norm(final)=2.538 | 4489.5 samples/s | 70.1 steps/s
[Step=29600 Epoch=28.9] | Loss=0.00487 | Reg=0.00352 | acc=0.9844 | L2-Norm=18.751 | L2-Norm(final)=2.539 | 4558.7 samples/s | 71.2 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step29600.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00013, len=1
[Step=28801 Epoch=54.3] | Loss=0.00003 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.452 | L2-Norm(final)=4.586 | 4294.4 samples/s | 67.1 steps/s
[Step=28850 Epoch=54.4] | Loss=0.00082 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.465 | L2-Norm(final)=4.581 | 3931.3 samples/s | 61.4 steps/s
[Step=28900 Epoch=54.5] | Loss=0.00111 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.472 | L2-Norm(final)=4.579 | 4033.2 samples/s | 63.0 steps/s
[Step=28950 Epoch=54.6] | Loss=0.00077 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.477 | L2-Norm(final)=4.577 | 4247.2 samples/s | 66.4 steps/s
[Step=29000 Epoch=54.7] | Loss=0.00058 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.480 | L2-Norm(final)=4.577 | 4160.1 samples/s | 65.0 steps/s
[Step=29050 Epoch=54.8] | Loss=0.00048 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.481 | L2-Norm(final)=4.577 | 4193.3 samples/s | 65.5 steps/s
[Step=29100 Epoch=54.9] | Loss=0.00040 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.483 | L2-Norm(final)=4.578 | 4186.1 samples/s | 65.4 steps/s
[Step=29150 Epoch=54.9] | Loss=0.00035 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.484 | L2-Norm(final)=4.578 | 4225.3 samples/s | 66.0 steps/s
[Step=29200 Epoch=55.0] | Loss=0.00031 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.484 | L2-Norm(final)=4.579 | 4256.9 samples/s | 66.5 steps/s
[Step=29250 Epoch=55.1] | Loss=0.00027 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.485 | L2-Norm(final)=4.579 | 4204.2 samples/s | 65.7 steps/s
[Step=29300 Epoch=55.2] | Loss=0.00025 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.485 | L2-Norm(final)=4.579 | 4278.3 samples/s | 66.8 steps/s
[Step=29350 Epoch=55.3] | Loss=0.00022 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.485 | L2-Norm(final)=4.580 | 2031.9 samples/s | 31.7 steps/s
[Step=29400 Epoch=55.4] | Loss=0.00021 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.485 | L2-Norm(final)=4.580 | 4158.5 samples/s | 65.0 steps/s
[Step=29450 Epoch=55.5] | Loss=0.00019 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.485 | L2-Norm(final)=4.581 | 4226.6 samples/s | 66.0 steps/s
[Step=29500 Epoch=55.6] | Loss=0.00018 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.484 | L2-Norm(final)=4.581 | 4315.7 samples/s | 67.4 steps/s
[Step=29550 Epoch=55.7] | Loss=0.00017 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.484 | L2-Norm(final)=4.582 | 4233.5 samples/s | 66.1 steps/s
[Step=29600 Epoch=55.8] | Loss=0.00016 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.484 | L2-Norm(final)=4.582 | 4246.0 samples/s | 66.3 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step29600.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10101 | acc=0.9722 | tpr=0.9770 | fpr=0.0382 | 4092.2 samples/s | 16.0 steps/s
Avg test loss: 0.10781, Avg test acc: 0.97139, Avg tpr: 0.97669, Avg fpr: 0.04025, total FA: 314

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.79323 | acc=0.3140 | tpr=0.0023 | fpr=0.0092 | 4056.2 samples/s | 15.8 steps/s
Avg test loss: 4.81286, Avg test acc: 0.31116, Avg tpr: 0.00227, Avg fpr: 0.00949, total FA: 74

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=9.48773 | acc=0.1468 | tpr=0.9115 | fpr=0.8669 | 3425.7 samples/s | 13.4 steps/s
[Step= 100] | Loss=9.42344 | acc=0.1476 | tpr=0.8955 | fpr=0.8663 | 5454.8 samples/s | 21.3 steps/s
[Step= 150] | Loss=9.45423 | acc=0.1471 | tpr=0.8876 | fpr=0.8666 | 7496.3 samples/s | 29.3 steps/s
[Step= 200] | Loss=9.43770 | acc=0.1474 | tpr=0.8820 | fpr=0.8659 | 7394.3 samples/s | 28.9 steps/s
[Step= 250] | Loss=9.43220 | acc=0.1477 | tpr=0.8707 | fpr=0.8654 | 7726.5 samples/s | 30.2 steps/s
[Step= 300] | Loss=9.43476 | acc=0.1475 | tpr=0.8705 | fpr=0.8657 | 7382.4 samples/s | 28.8 steps/s
[Step= 350] | Loss=9.42346 | acc=0.1474 | tpr=0.8760 | fpr=0.8659 | 7961.8 samples/s | 31.1 steps/s
[Step= 400] | Loss=9.42587 | acc=0.1475 | tpr=0.8736 | fpr=0.8657 | 7458.3 samples/s | 29.1 steps/s
[Step= 450] | Loss=9.43224 | acc=0.1476 | tpr=0.8739 | fpr=0.8656 | 7725.0 samples/s | 30.2 steps/s
[Step= 500] | Loss=9.43737 | acc=0.1472 | tpr=0.8753 | fpr=0.8659 | 7596.7 samples/s | 29.7 steps/s
[Step= 550] | Loss=9.43828 | acc=0.1472 | tpr=0.8747 | fpr=0.8660 | 13485.7 samples/s | 52.7 steps/s
Avg test loss: 9.44042, Avg test acc: 0.14715, Avg tpr: 0.87441, Avg fpr: 0.86607, total FA: 120252

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10882 | acc=0.9810 | tpr=0.9735 | fpr=0.0188 | 3193.2 samples/s | 12.5 steps/s
[Step= 100] | Loss=0.11324 | acc=0.9804 | tpr=0.9765 | fpr=0.0195 | 7896.6 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.11795 | acc=0.9795 | tpr=0.9784 | fpr=0.0205 | 7769.4 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.11939 | acc=0.9795 | tpr=0.9781 | fpr=0.0205 | 7571.7 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.11769 | acc=0.9795 | tpr=0.9773 | fpr=0.0204 | 7109.8 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.11984 | acc=0.9792 | tpr=0.9760 | fpr=0.0207 | 7450.2 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.12030 | acc=0.9792 | tpr=0.9762 | fpr=0.0208 | 8103.5 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.12167 | acc=0.9789 | tpr=0.9737 | fpr=0.0210 | 7712.0 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.12428 | acc=0.9785 | tpr=0.9727 | fpr=0.0214 | 7212.8 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.12384 | acc=0.9785 | tpr=0.9731 | fpr=0.0214 | 7324.7 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.12293 | acc=0.9787 | tpr=0.9729 | fpr=0.0212 | 14208.1 samples/s | 55.5 steps/s
Avg test loss: 0.12268, Avg test acc: 0.97869, Avg tpr: 0.97306, Avg fpr: 0.02121, total FA: 2945

server round 37/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00013, len=1
[Step=29601 Epoch=28.9] | Loss=0.00084 | Reg=0.00351 | acc=1.0000 | L2-Norm=18.728 | L2-Norm(final)=2.544 | 4670.5 samples/s | 73.0 steps/s
[Step=29650 Epoch=28.9] | Loss=0.00435 | Reg=0.00351 | acc=1.0000 | L2-Norm=18.727 | L2-Norm(final)=2.546 | 3918.9 samples/s | 61.2 steps/s
[Step=29700 Epoch=29.0] | Loss=0.00459 | Reg=0.00351 | acc=0.9844 | L2-Norm=18.726 | L2-Norm(final)=2.546 | 4350.8 samples/s | 68.0 steps/s
[Step=29750 Epoch=29.0] | Loss=0.00438 | Reg=0.00351 | acc=1.0000 | L2-Norm=18.724 | L2-Norm(final)=2.547 | 4297.8 samples/s | 67.2 steps/s
[Step=29800 Epoch=29.1] | Loss=0.00439 | Reg=0.00351 | acc=1.0000 | L2-Norm=18.722 | L2-Norm(final)=2.547 | 4347.4 samples/s | 67.9 steps/s
[Step=29850 Epoch=29.1] | Loss=0.00489 | Reg=0.00350 | acc=0.9844 | L2-Norm=18.720 | L2-Norm(final)=2.547 | 4376.4 samples/s | 68.4 steps/s
[Step=29900 Epoch=29.2] | Loss=0.00483 | Reg=0.00350 | acc=0.9844 | L2-Norm=18.719 | L2-Norm(final)=2.547 | 4497.2 samples/s | 70.3 steps/s
[Step=29950 Epoch=29.2] | Loss=0.00471 | Reg=0.00350 | acc=0.9844 | L2-Norm=18.717 | L2-Norm(final)=2.548 | 4422.9 samples/s | 69.1 steps/s
[Step=30000 Epoch=29.3] | Loss=0.00453 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.715 | L2-Norm(final)=2.548 | 4400.1 samples/s | 68.8 steps/s
[Step=30050 Epoch=29.3] | Loss=0.00449 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.714 | L2-Norm(final)=2.548 | 4430.5 samples/s | 69.2 steps/s
[Step=30100 Epoch=29.4] | Loss=0.00453 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.712 | L2-Norm(final)=2.549 | 4397.3 samples/s | 68.7 steps/s
[Step=30150 Epoch=29.4] | Loss=0.00457 | Reg=0.00350 | acc=0.9688 | L2-Norm=18.711 | L2-Norm(final)=2.549 | 4513.9 samples/s | 70.5 steps/s
[Step=30200 Epoch=29.5] | Loss=0.00462 | Reg=0.00350 | acc=0.9688 | L2-Norm=18.709 | L2-Norm(final)=2.549 | 4408.8 samples/s | 68.9 steps/s
[Step=30250 Epoch=29.5] | Loss=0.00465 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.707 | L2-Norm(final)=2.550 | 4354.8 samples/s | 68.0 steps/s
[Step=30300 Epoch=29.6] | Loss=0.00467 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.706 | L2-Norm(final)=2.550 | 4400.7 samples/s | 68.8 steps/s
[Step=30350 Epoch=29.6] | Loss=0.00465 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.704 | L2-Norm(final)=2.551 | 4469.8 samples/s | 69.8 steps/s
[Step=30400 Epoch=29.7] | Loss=0.00469 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.702 | L2-Norm(final)=2.551 | 4422.9 samples/s | 69.1 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step30400.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00013, len=1
[Step=29601 Epoch=55.8] | Loss=0.00001 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.479 | L2-Norm(final)=4.589 | 4183.5 samples/s | 65.4 steps/s
[Step=29650 Epoch=55.9] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.478 | L2-Norm(final)=4.589 | 3963.3 samples/s | 61.9 steps/s
[Step=29700 Epoch=56.0] | Loss=0.00001 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.478 | L2-Norm(final)=4.590 | 4108.0 samples/s | 64.2 steps/s
[Step=29750 Epoch=56.1] | Loss=0.00001 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.478 | L2-Norm(final)=4.590 | 4134.1 samples/s | 64.6 steps/s
[Step=29800 Epoch=56.2] | Loss=0.00001 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.478 | L2-Norm(final)=4.591 | 4215.9 samples/s | 65.9 steps/s
[Step=29850 Epoch=56.3] | Loss=0.00001 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.477 | L2-Norm(final)=4.591 | 4204.0 samples/s | 65.7 steps/s
[Step=29900 Epoch=56.4] | Loss=0.00001 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.477 | L2-Norm(final)=4.591 | 4207.1 samples/s | 65.7 steps/s
[Step=29950 Epoch=56.5] | Loss=0.00001 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.476 | L2-Norm(final)=4.592 | 4196.2 samples/s | 65.6 steps/s
[Step=30000 Epoch=56.6] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.476 | L2-Norm(final)=4.592 | 4134.2 samples/s | 64.6 steps/s
[Step=30050 Epoch=56.6] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.475 | L2-Norm(final)=4.592 | 4090.5 samples/s | 63.9 steps/s
[Step=30100 Epoch=56.7] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.474 | L2-Norm(final)=4.593 | 4166.4 samples/s | 65.1 steps/s
[Step=30150 Epoch=56.8] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.474 | L2-Norm(final)=4.593 | 2035.0 samples/s | 31.8 steps/s
[Step=30200 Epoch=56.9] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.473 | L2-Norm(final)=4.593 | 4172.7 samples/s | 65.2 steps/s
[Step=30250 Epoch=57.0] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.472 | L2-Norm(final)=4.594 | 4057.1 samples/s | 63.4 steps/s
[Step=30300 Epoch=57.1] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.471 | L2-Norm(final)=4.594 | 4165.7 samples/s | 65.1 steps/s
[Step=30350 Epoch=57.2] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.471 | L2-Norm(final)=4.594 | 4087.0 samples/s | 63.9 steps/s
[Step=30400 Epoch=57.3] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.470 | L2-Norm(final)=4.595 | 4141.7 samples/s | 64.7 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step30400.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09953 | acc=0.9723 | tpr=0.9792 | fpr=0.0426 | 4206.9 samples/s | 16.4 steps/s
Avg test loss: 0.10439, Avg test acc: 0.97183, Avg tpr: 0.97908, Avg fpr: 0.04410, total FA: 344

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.02132 | acc=0.3141 | tpr=0.0024 | fpr=0.0092 | 4177.1 samples/s | 16.3 steps/s
Avg test loss: 5.04203, Avg test acc: 0.31124, Avg tpr: 0.00233, Avg fpr: 0.00936, total FA: 73

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.97258 | acc=0.1419 | tpr=0.9159 | fpr=0.8720 | 4200.2 samples/s | 16.4 steps/s
[Step= 100] | Loss=8.90777 | acc=0.1433 | tpr=0.8998 | fpr=0.8708 | 7759.6 samples/s | 30.3 steps/s
[Step= 150] | Loss=8.93919 | acc=0.1424 | tpr=0.8905 | fpr=0.8714 | 4710.1 samples/s | 18.4 steps/s
[Step= 200] | Loss=8.92348 | acc=0.1427 | tpr=0.8885 | fpr=0.8709 | 7789.6 samples/s | 30.4 steps/s
[Step= 250] | Loss=8.91949 | acc=0.1432 | tpr=0.8838 | fpr=0.8703 | 7808.4 samples/s | 30.5 steps/s
[Step= 300] | Loss=8.92181 | acc=0.1430 | tpr=0.8844 | fpr=0.8705 | 7421.3 samples/s | 29.0 steps/s
[Step= 350] | Loss=8.91161 | acc=0.1429 | tpr=0.8879 | fpr=0.8706 | 8050.5 samples/s | 31.4 steps/s
[Step= 400] | Loss=8.91409 | acc=0.1430 | tpr=0.8868 | fpr=0.8705 | 7789.7 samples/s | 30.4 steps/s
[Step= 450] | Loss=8.92063 | acc=0.1431 | tpr=0.8856 | fpr=0.8703 | 7610.9 samples/s | 29.7 steps/s
[Step= 500] | Loss=8.92498 | acc=0.1426 | tpr=0.8872 | fpr=0.8709 | 7803.2 samples/s | 30.5 steps/s
[Step= 550] | Loss=8.92468 | acc=0.1425 | tpr=0.8870 | fpr=0.8711 | 13440.6 samples/s | 52.5 steps/s
Avg test loss: 8.92683, Avg test acc: 0.14240, Avg tpr: 0.88708, Avg fpr: 0.87113, total FA: 120955

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11141 | acc=0.9815 | tpr=0.9735 | fpr=0.0184 | 4102.1 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.11608 | acc=0.9807 | tpr=0.9744 | fpr=0.0192 | 7328.5 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.12095 | acc=0.9798 | tpr=0.9769 | fpr=0.0201 | 4567.5 samples/s | 17.8 steps/s
[Step= 200] | Loss=0.12249 | acc=0.9798 | tpr=0.9760 | fpr=0.0202 | 7376.9 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.12069 | acc=0.9798 | tpr=0.9755 | fpr=0.0201 | 7973.7 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.12295 | acc=0.9795 | tpr=0.9745 | fpr=0.0204 | 7192.8 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.12343 | acc=0.9795 | tpr=0.9750 | fpr=0.0204 | 7511.6 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.12483 | acc=0.9793 | tpr=0.9721 | fpr=0.0206 | 7189.0 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.12754 | acc=0.9788 | tpr=0.9713 | fpr=0.0210 | 7208.4 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.12707 | acc=0.9788 | tpr=0.9714 | fpr=0.0210 | 7937.6 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.12614 | acc=0.9790 | tpr=0.9713 | fpr=0.0208 | 11919.1 samples/s | 46.6 steps/s
Avg test loss: 0.12589, Avg test acc: 0.97903, Avg tpr: 0.97108, Avg fpr: 0.02082, total FA: 2891

server round 38/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00013, len=1
[Step=30401 Epoch=29.7] | Loss=0.00498 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.677 | L2-Norm(final)=2.557 | 4520.1 samples/s | 70.6 steps/s
[Step=30450 Epoch=29.7] | Loss=0.00343 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.676 | L2-Norm(final)=2.558 | 3881.6 samples/s | 60.6 steps/s
[Step=30500 Epoch=29.8] | Loss=0.00366 | Reg=0.00349 | acc=0.9688 | L2-Norm=18.675 | L2-Norm(final)=2.560 | 4144.3 samples/s | 64.8 steps/s
[Step=30550 Epoch=29.8] | Loss=0.00413 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.674 | L2-Norm(final)=2.561 | 4239.7 samples/s | 66.2 steps/s
[Step=30600 Epoch=29.9] | Loss=0.00434 | Reg=0.00349 | acc=0.9844 | L2-Norm=18.672 | L2-Norm(final)=2.562 | 4371.3 samples/s | 68.3 steps/s
[Step=30650 Epoch=29.9] | Loss=0.00460 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.671 | L2-Norm(final)=2.562 | 4426.2 samples/s | 69.2 steps/s
[Step=30700 Epoch=30.0] | Loss=0.00453 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.669 | L2-Norm(final)=2.563 | 4372.1 samples/s | 68.3 steps/s
[Step=30750 Epoch=30.0] | Loss=0.00449 | Reg=0.00348 | acc=1.0000 | L2-Norm=18.667 | L2-Norm(final)=2.563 | 4392.6 samples/s | 68.6 steps/s
[Step=30800 Epoch=30.1] | Loss=0.00436 | Reg=0.00348 | acc=0.9844 | L2-Norm=18.666 | L2-Norm(final)=2.564 | 4399.4 samples/s | 68.7 steps/s
[Step=30850 Epoch=30.1] | Loss=0.00450 | Reg=0.00348 | acc=1.0000 | L2-Norm=18.664 | L2-Norm(final)=2.565 | 4512.1 samples/s | 70.5 steps/s
[Step=30900 Epoch=30.2] | Loss=0.00453 | Reg=0.00348 | acc=1.0000 | L2-Norm=18.662 | L2-Norm(final)=2.565 | 4471.0 samples/s | 69.9 steps/s
[Step=30950 Epoch=30.2] | Loss=0.00456 | Reg=0.00348 | acc=1.0000 | L2-Norm=18.661 | L2-Norm(final)=2.566 | 4466.5 samples/s | 69.8 steps/s
[Step=31000 Epoch=30.3] | Loss=0.00456 | Reg=0.00348 | acc=1.0000 | L2-Norm=18.659 | L2-Norm(final)=2.566 | 4436.8 samples/s | 69.3 steps/s
[Step=31050 Epoch=30.3] | Loss=0.00466 | Reg=0.00348 | acc=1.0000 | L2-Norm=18.658 | L2-Norm(final)=2.567 | 4394.7 samples/s | 68.7 steps/s
[Step=31100 Epoch=30.4] | Loss=0.00474 | Reg=0.00348 | acc=0.9844 | L2-Norm=18.656 | L2-Norm(final)=2.567 | 4534.4 samples/s | 70.8 steps/s
[Step=31150 Epoch=30.4] | Loss=0.00470 | Reg=0.00348 | acc=1.0000 | L2-Norm=18.654 | L2-Norm(final)=2.568 | 4575.5 samples/s | 71.5 steps/s
[Step=31200 Epoch=30.5] | Loss=0.00475 | Reg=0.00348 | acc=0.9844 | L2-Norm=18.653 | L2-Norm(final)=2.569 | 4483.3 samples/s | 70.1 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step31200.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00013, len=1
[Step=30401 Epoch=57.3] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.456 | L2-Norm(final)=4.600 | 4204.1 samples/s | 65.7 steps/s
[Step=30450 Epoch=57.4] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.456 | L2-Norm(final)=4.600 | 4020.1 samples/s | 62.8 steps/s
[Step=30500 Epoch=57.5] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.455 | L2-Norm(final)=4.601 | 4276.0 samples/s | 66.8 steps/s
[Step=30550 Epoch=57.6] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.454 | L2-Norm(final)=4.601 | 4370.3 samples/s | 68.3 steps/s
[Step=30600 Epoch=57.7] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.453 | L2-Norm(final)=4.602 | 4346.3 samples/s | 67.9 steps/s
[Step=30650 Epoch=57.8] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.453 | L2-Norm(final)=4.602 | 4219.9 samples/s | 65.9 steps/s
[Step=30700 Epoch=57.9] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.452 | L2-Norm(final)=4.603 | 4244.7 samples/s | 66.3 steps/s
[Step=30750 Epoch=58.0] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.451 | L2-Norm(final)=4.603 | 4248.6 samples/s | 66.4 steps/s
[Step=30800 Epoch=58.1] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.450 | L2-Norm(final)=4.603 | 4271.1 samples/s | 66.7 steps/s
[Step=30850 Epoch=58.2] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.449 | L2-Norm(final)=4.604 | 4364.8 samples/s | 68.2 steps/s
[Step=30900 Epoch=58.2] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.448 | L2-Norm(final)=4.604 | 4265.6 samples/s | 66.7 steps/s
[Step=30950 Epoch=58.3] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.447 | L2-Norm(final)=4.605 | 2104.0 samples/s | 32.9 steps/s
[Step=31000 Epoch=58.4] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.446 | L2-Norm(final)=4.605 | 4304.7 samples/s | 67.3 steps/s
[Step=31050 Epoch=58.5] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.445 | L2-Norm(final)=4.606 | 4324.4 samples/s | 67.6 steps/s
[Step=31100 Epoch=58.6] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.444 | L2-Norm(final)=4.606 | 4315.2 samples/s | 67.4 steps/s
[Step=31150 Epoch=58.7] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.443 | L2-Norm(final)=4.607 | 4238.0 samples/s | 66.2 steps/s
[Step=31200 Epoch=58.8] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.442 | L2-Norm(final)=4.607 | 4399.4 samples/s | 68.7 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step31200.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10238 | acc=0.9723 | tpr=0.9759 | fpr=0.0354 | 3218.1 samples/s | 12.6 steps/s
Avg test loss: 0.10707, Avg test acc: 0.97143, Avg tpr: 0.97552, Avg fpr: 0.03756, total FA: 293

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.06998 | acc=0.3141 | tpr=0.0024 | fpr=0.0092 | 3093.8 samples/s | 12.1 steps/s
Avg test loss: 5.09082, Avg test acc: 0.31108, Avg tpr: 0.00239, Avg fpr: 0.01000, total FA: 78

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.69879 | acc=0.1542 | tpr=0.8850 | fpr=0.8589 | 3051.2 samples/s | 11.9 steps/s
[Step= 100] | Loss=8.63297 | acc=0.1566 | tpr=0.8699 | fpr=0.8567 | 7790.2 samples/s | 30.4 steps/s
[Step= 150] | Loss=8.66290 | acc=0.1560 | tpr=0.8617 | fpr=0.8570 | 7540.9 samples/s | 29.5 steps/s
[Step= 200] | Loss=8.64638 | acc=0.1571 | tpr=0.8645 | fpr=0.8558 | 7598.8 samples/s | 29.7 steps/s
[Step= 250] | Loss=8.64220 | acc=0.1578 | tpr=0.8550 | fpr=0.8549 | 7791.2 samples/s | 30.4 steps/s
[Step= 300] | Loss=8.64406 | acc=0.1574 | tpr=0.8560 | fpr=0.8554 | 7804.3 samples/s | 30.5 steps/s
[Step= 350] | Loss=8.63377 | acc=0.1571 | tpr=0.8566 | fpr=0.8556 | 7698.0 samples/s | 30.1 steps/s
[Step= 400] | Loss=8.63660 | acc=0.1572 | tpr=0.8539 | fpr=0.8555 | 7443.2 samples/s | 29.1 steps/s
[Step= 450] | Loss=8.64299 | acc=0.1573 | tpr=0.8544 | fpr=0.8553 | 7320.0 samples/s | 28.6 steps/s
[Step= 500] | Loss=8.64775 | acc=0.1569 | tpr=0.8573 | fpr=0.8557 | 7429.6 samples/s | 29.0 steps/s
[Step= 550] | Loss=8.64726 | acc=0.1568 | tpr=0.8571 | fpr=0.8559 | 13750.7 samples/s | 53.7 steps/s
Avg test loss: 8.64948, Avg test acc: 0.15672, Avg tpr: 0.85697, Avg fpr: 0.85601, total FA: 118855

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11283 | acc=0.9813 | tpr=0.9735 | fpr=0.0185 | 2910.4 samples/s | 11.4 steps/s
[Step= 100] | Loss=0.11757 | acc=0.9806 | tpr=0.9765 | fpr=0.0193 | 7385.0 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.12251 | acc=0.9798 | tpr=0.9784 | fpr=0.0202 | 7258.1 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.12404 | acc=0.9796 | tpr=0.9770 | fpr=0.0203 | 7336.1 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.12227 | acc=0.9798 | tpr=0.9764 | fpr=0.0202 | 7989.8 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.12455 | acc=0.9795 | tpr=0.9753 | fpr=0.0205 | 7423.2 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.12503 | acc=0.9794 | tpr=0.9756 | fpr=0.0205 | 8299.6 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.12644 | acc=0.9792 | tpr=0.9726 | fpr=0.0207 | 7399.9 samples/s | 28.9 steps/s
[Step= 450] | Loss=0.12920 | acc=0.9788 | tpr=0.9718 | fpr=0.0211 | 7585.1 samples/s | 29.6 steps/s
[Step= 500] | Loss=0.12873 | acc=0.9788 | tpr=0.9718 | fpr=0.0211 | 7566.0 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.12778 | acc=0.9790 | tpr=0.9717 | fpr=0.0209 | 13611.5 samples/s | 53.2 steps/s
Avg test loss: 0.12753, Avg test acc: 0.97900, Avg tpr: 0.97187, Avg fpr: 0.02087, total FA: 2898

server round 39/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00013, len=1
[Step=31201 Epoch=30.5] | Loss=0.00175 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.629 | L2-Norm(final)=2.578 | 3779.3 samples/s | 59.1 steps/s
[Step=31250 Epoch=30.5] | Loss=0.00394 | Reg=0.00347 | acc=0.9844 | L2-Norm=18.628 | L2-Norm(final)=2.580 | 2181.9 samples/s | 34.1 steps/s
[Step=31300 Epoch=30.6] | Loss=0.00406 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.627 | L2-Norm(final)=2.582 | 4128.4 samples/s | 64.5 steps/s
[Step=31350 Epoch=30.6] | Loss=0.00423 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.626 | L2-Norm(final)=2.583 | 4452.7 samples/s | 69.6 steps/s
[Step=31400 Epoch=30.7] | Loss=0.00421 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.624 | L2-Norm(final)=2.583 | 4422.3 samples/s | 69.1 steps/s
[Step=31450 Epoch=30.7] | Loss=0.00443 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.623 | L2-Norm(final)=2.584 | 4062.6 samples/s | 63.5 steps/s
[Step=31500 Epoch=30.8] | Loss=0.00437 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.621 | L2-Norm(final)=2.584 | 4625.3 samples/s | 72.3 steps/s
[Step=31550 Epoch=30.8] | Loss=0.00437 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.619 | L2-Norm(final)=2.584 | 4293.4 samples/s | 67.1 steps/s
[Step=31600 Epoch=30.9] | Loss=0.00421 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.618 | L2-Norm(final)=2.585 | 4417.1 samples/s | 69.0 steps/s
[Step=31650 Epoch=30.9] | Loss=0.00432 | Reg=0.00347 | acc=0.9844 | L2-Norm=18.616 | L2-Norm(final)=2.585 | 4493.2 samples/s | 70.2 steps/s
[Step=31700 Epoch=30.9] | Loss=0.00431 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.615 | L2-Norm(final)=2.586 | 4054.4 samples/s | 63.3 steps/s
[Step=31750 Epoch=31.0] | Loss=0.00429 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.614 | L2-Norm(final)=2.587 | 4557.2 samples/s | 71.2 steps/s
[Step=31800 Epoch=31.0] | Loss=0.00436 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.612 | L2-Norm(final)=2.588 | 4610.5 samples/s | 72.0 steps/s
[Step=31850 Epoch=31.1] | Loss=0.00437 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.611 | L2-Norm(final)=2.589 | 4326.5 samples/s | 67.6 steps/s
[Step=31900 Epoch=31.1] | Loss=0.00438 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.610 | L2-Norm(final)=2.590 | 4444.3 samples/s | 69.4 steps/s
[Step=31950 Epoch=31.2] | Loss=0.00439 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.609 | L2-Norm(final)=2.590 | 4588.7 samples/s | 71.7 steps/s
[Step=32000 Epoch=31.2] | Loss=0.00455 | Reg=0.00346 | acc=0.9844 | L2-Norm=18.608 | L2-Norm(final)=2.591 | 4487.2 samples/s | 70.1 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step32000.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00013, len=1
[Step=31201 Epoch=58.8] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.424 | L2-Norm(final)=4.615 | 3922.9 samples/s | 61.3 steps/s
[Step=31250 Epoch=58.9] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.423 | L2-Norm(final)=4.616 | 4308.4 samples/s | 67.3 steps/s
[Step=31300 Epoch=59.0] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.422 | L2-Norm(final)=4.616 | 4287.4 samples/s | 67.0 steps/s
[Step=31350 Epoch=59.1] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.420 | L2-Norm(final)=4.617 | 4293.8 samples/s | 67.1 steps/s
[Step=31400 Epoch=59.2] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.419 | L2-Norm(final)=4.617 | 4266.1 samples/s | 66.7 steps/s
[Step=31450 Epoch=59.3] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.418 | L2-Norm(final)=4.618 | 4281.1 samples/s | 66.9 steps/s
[Step=31500 Epoch=59.4] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.416 | L2-Norm(final)=4.618 | 4438.6 samples/s | 69.4 steps/s
[Step=31550 Epoch=59.5] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.415 | L2-Norm(final)=4.619 | 4042.2 samples/s | 63.2 steps/s
[Step=31600 Epoch=59.6] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.414 | L2-Norm(final)=4.619 | 4187.1 samples/s | 65.4 steps/s
[Step=31650 Epoch=59.7] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.412 | L2-Norm(final)=4.620 | 4276.7 samples/s | 66.8 steps/s
[Step=31700 Epoch=59.8] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.411 | L2-Norm(final)=4.621 | 4303.1 samples/s | 67.2 steps/s
[Step=31750 Epoch=59.8] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.410 | L2-Norm(final)=4.621 | 2101.2 samples/s | 32.8 steps/s
[Step=31800 Epoch=59.9] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.408 | L2-Norm(final)=4.622 | 4161.7 samples/s | 65.0 steps/s
[Step=31850 Epoch=60.0] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.407 | L2-Norm(final)=4.622 | 4154.3 samples/s | 64.9 steps/s
[Step=31900 Epoch=60.1] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.405 | L2-Norm(final)=4.623 | 4108.0 samples/s | 64.2 steps/s
[Step=31950 Epoch=60.2] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.404 | L2-Norm(final)=4.624 | 4177.0 samples/s | 65.3 steps/s
[Step=32000 Epoch=60.3] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.402 | L2-Norm(final)=4.624 | 4164.9 samples/s | 65.1 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step32000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09862 | acc=0.9726 | tpr=0.9774 | fpr=0.0379 | 4065.1 samples/s | 15.9 steps/s
Avg test loss: 0.10324, Avg test acc: 0.97151, Avg tpr: 0.97651, Avg fpr: 0.03948, total FA: 308

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.00631 | acc=0.3141 | tpr=0.0029 | fpr=0.0099 | 4145.1 samples/s | 16.2 steps/s
Avg test loss: 5.02676, Avg test acc: 0.31100, Avg tpr: 0.00262, Avg fpr: 0.01077, total FA: 84

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.59042 | acc=0.1494 | tpr=0.8938 | fpr=0.8640 | 4201.0 samples/s | 16.4 steps/s
[Step= 100] | Loss=8.52488 | acc=0.1518 | tpr=0.8827 | fpr=0.8619 | 7209.3 samples/s | 28.2 steps/s
[Step= 150] | Loss=8.55273 | acc=0.1510 | tpr=0.8732 | fpr=0.8623 | 7217.8 samples/s | 28.2 steps/s
[Step= 200] | Loss=8.53888 | acc=0.1514 | tpr=0.8743 | fpr=0.8618 | 7338.4 samples/s | 28.7 steps/s
[Step= 250] | Loss=8.53217 | acc=0.1521 | tpr=0.8646 | fpr=0.8609 | 7460.5 samples/s | 29.1 steps/s
[Step= 300] | Loss=8.53588 | acc=0.1519 | tpr=0.8669 | fpr=0.8611 | 7290.2 samples/s | 28.5 steps/s
[Step= 350] | Loss=8.52556 | acc=0.1516 | tpr=0.8698 | fpr=0.8614 | 7228.8 samples/s | 28.2 steps/s
[Step= 400] | Loss=8.52805 | acc=0.1515 | tpr=0.8682 | fpr=0.8615 | 7969.3 samples/s | 31.1 steps/s
[Step= 450] | Loss=8.53436 | acc=0.1516 | tpr=0.8685 | fpr=0.8614 | 7446.5 samples/s | 29.1 steps/s
[Step= 500] | Loss=8.53862 | acc=0.1510 | tpr=0.8705 | fpr=0.8620 | 7762.9 samples/s | 30.3 steps/s
[Step= 550] | Loss=8.53821 | acc=0.1509 | tpr=0.8703 | fpr=0.8622 | 13977.2 samples/s | 54.6 steps/s
Avg test loss: 8.54045, Avg test acc: 0.15085, Avg tpr: 0.87044, Avg fpr: 0.86223, total FA: 119719

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11569 | acc=0.9807 | tpr=0.9735 | fpr=0.0192 | 4165.5 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.12049 | acc=0.9802 | tpr=0.9765 | fpr=0.0198 | 7676.9 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.12558 | acc=0.9792 | tpr=0.9784 | fpr=0.0208 | 8660.9 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.12710 | acc=0.9792 | tpr=0.9781 | fpr=0.0208 | 7228.9 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.12537 | acc=0.9793 | tpr=0.9773 | fpr=0.0207 | 7917.7 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.12769 | acc=0.9789 | tpr=0.9760 | fpr=0.0211 | 7634.2 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.12818 | acc=0.9789 | tpr=0.9768 | fpr=0.0211 | 8006.6 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.12962 | acc=0.9786 | tpr=0.9748 | fpr=0.0213 | 7439.2 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.13244 | acc=0.9782 | tpr=0.9737 | fpr=0.0217 | 8006.5 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.13198 | acc=0.9782 | tpr=0.9740 | fpr=0.0218 | 7782.7 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.13099 | acc=0.9784 | tpr=0.9737 | fpr=0.0215 | 13976.7 samples/s | 54.6 steps/s
Avg test loss: 0.13074, Avg test acc: 0.97838, Avg tpr: 0.97385, Avg fpr: 0.02153, total FA: 2990

server round 40/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00006, len=1
[Step=32001 Epoch=31.2] | Loss=0.01613 | Reg=0.00346 | acc=0.9844 | L2-Norm=18.588 | L2-Norm(final)=2.598 | 4385.0 samples/s | 68.5 steps/s
[Step=32050 Epoch=31.3] | Loss=0.00471 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.587 | L2-Norm(final)=2.598 | 4362.7 samples/s | 68.2 steps/s
[Step=32100 Epoch=31.3] | Loss=0.00419 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.586 | L2-Norm(final)=2.598 | 4542.4 samples/s | 71.0 steps/s
[Step=32150 Epoch=31.4] | Loss=0.00383 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.586 | L2-Norm(final)=2.599 | 4390.1 samples/s | 68.6 steps/s
[Step=32200 Epoch=31.4] | Loss=0.00399 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.585 | L2-Norm(final)=2.600 | 4308.0 samples/s | 67.3 steps/s
[Step=32250 Epoch=31.5] | Loss=0.00390 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.585 | L2-Norm(final)=2.600 | 4261.5 samples/s | 66.6 steps/s
[Step=32300 Epoch=31.5] | Loss=0.00404 | Reg=0.00345 | acc=0.9688 | L2-Norm=18.584 | L2-Norm(final)=2.601 | 4239.6 samples/s | 66.2 steps/s
[Step=32350 Epoch=31.6] | Loss=0.00420 | Reg=0.00345 | acc=0.9844 | L2-Norm=18.583 | L2-Norm(final)=2.601 | 4355.1 samples/s | 68.0 steps/s
[Step=32400 Epoch=31.6] | Loss=0.00419 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.583 | L2-Norm(final)=2.602 | 4424.5 samples/s | 69.1 steps/s
[Step=32450 Epoch=31.7] | Loss=0.00428 | Reg=0.00345 | acc=0.9844 | L2-Norm=18.582 | L2-Norm(final)=2.603 | 4388.5 samples/s | 68.6 steps/s
[Step=32500 Epoch=31.7] | Loss=0.00420 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.581 | L2-Norm(final)=2.603 | 4366.1 samples/s | 68.2 steps/s
[Step=32550 Epoch=31.8] | Loss=0.00415 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.580 | L2-Norm(final)=2.604 | 4448.7 samples/s | 69.5 steps/s
[Step=32600 Epoch=31.8] | Loss=0.00417 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.580 | L2-Norm(final)=2.604 | 4390.9 samples/s | 68.6 steps/s
[Step=32650 Epoch=31.9] | Loss=0.00418 | Reg=0.00345 | acc=0.9844 | L2-Norm=18.579 | L2-Norm(final)=2.605 | 4359.0 samples/s | 68.1 steps/s
[Step=32700 Epoch=31.9] | Loss=0.00410 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.578 | L2-Norm(final)=2.605 | 4358.2 samples/s | 68.1 steps/s
[Step=32750 Epoch=32.0] | Loss=0.00416 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.577 | L2-Norm(final)=2.606 | 4317.5 samples/s | 67.5 steps/s
[Step=32800 Epoch=32.0] | Loss=0.00419 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.576 | L2-Norm(final)=2.606 | 4323.1 samples/s | 67.5 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step32800.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00006, len=1
[Step=32001 Epoch=60.3] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.377 | L2-Norm(final)=4.635 | 3946.4 samples/s | 61.7 steps/s
[Step=32050 Epoch=60.4] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.376 | L2-Norm(final)=4.635 | 3732.5 samples/s | 58.3 steps/s
[Step=32100 Epoch=60.5] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.376 | L2-Norm(final)=4.636 | 3852.5 samples/s | 60.2 steps/s
[Step=32150 Epoch=60.6] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.375 | L2-Norm(final)=4.636 | 4073.8 samples/s | 63.7 steps/s
[Step=32200 Epoch=60.7] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.374 | L2-Norm(final)=4.637 | 4248.2 samples/s | 66.4 steps/s
[Step=32250 Epoch=60.8] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.373 | L2-Norm(final)=4.637 | 4309.6 samples/s | 67.3 steps/s
[Step=32300 Epoch=60.9] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.372 | L2-Norm(final)=4.637 | 4222.4 samples/s | 66.0 steps/s
[Step=32350 Epoch=61.0] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.371 | L2-Norm(final)=4.638 | 4225.5 samples/s | 66.0 steps/s
[Step=32400 Epoch=61.1] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.370 | L2-Norm(final)=4.638 | 4167.4 samples/s | 65.1 steps/s
[Step=32450 Epoch=61.2] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.369 | L2-Norm(final)=4.639 | 4318.4 samples/s | 67.5 steps/s
[Step=32500 Epoch=61.3] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.368 | L2-Norm(final)=4.639 | 4070.7 samples/s | 63.6 steps/s
[Step=32550 Epoch=61.4] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.367 | L2-Norm(final)=4.640 | 2034.9 samples/s | 31.8 steps/s
[Step=32600 Epoch=61.5] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.366 | L2-Norm(final)=4.640 | 4272.2 samples/s | 66.8 steps/s
[Step=32650 Epoch=61.5] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.365 | L2-Norm(final)=4.641 | 4135.6 samples/s | 64.6 steps/s
[Step=32700 Epoch=61.6] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.364 | L2-Norm(final)=4.641 | 4129.6 samples/s | 64.5 steps/s
[Step=32750 Epoch=61.7] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.363 | L2-Norm(final)=4.642 | 4142.5 samples/s | 64.7 steps/s
[Step=32800 Epoch=61.8] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.362 | L2-Norm(final)=4.642 | 4030.0 samples/s | 63.0 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step32800.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11089 | acc=0.9720 | tpr=0.9771 | fpr=0.0391 | 3991.7 samples/s | 15.6 steps/s
Avg test loss: 0.11529, Avg test acc: 0.97135, Avg tpr: 0.97721, Avg fpr: 0.04153, total FA: 324

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.05238 | acc=0.3140 | tpr=0.0024 | fpr=0.0094 | 4016.3 samples/s | 15.7 steps/s
Avg test loss: 5.07311, Avg test acc: 0.31096, Avg tpr: 0.00239, Avg fpr: 0.01038, total FA: 81

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=9.76871 | acc=0.1441 | tpr=0.9071 | fpr=0.8697 | 4217.5 samples/s | 16.5 steps/s
[Step= 100] | Loss=9.69994 | acc=0.1468 | tpr=0.8913 | fpr=0.8671 | 7512.2 samples/s | 29.3 steps/s
[Step= 150] | Loss=9.72962 | acc=0.1461 | tpr=0.8818 | fpr=0.8675 | 7545.9 samples/s | 29.5 steps/s
[Step= 200] | Loss=9.71376 | acc=0.1464 | tpr=0.8798 | fpr=0.8670 | 7539.5 samples/s | 29.5 steps/s
[Step= 250] | Loss=9.70910 | acc=0.1470 | tpr=0.8707 | fpr=0.8662 | 7174.6 samples/s | 28.0 steps/s
[Step= 300] | Loss=9.71065 | acc=0.1468 | tpr=0.8713 | fpr=0.8665 | 7527.8 samples/s | 29.4 steps/s
[Step= 350] | Loss=9.69953 | acc=0.1468 | tpr=0.8741 | fpr=0.8664 | 7397.0 samples/s | 28.9 steps/s
[Step= 400] | Loss=9.70246 | acc=0.1469 | tpr=0.8720 | fpr=0.8663 | 7727.4 samples/s | 30.2 steps/s
[Step= 450] | Loss=9.70956 | acc=0.1470 | tpr=0.8715 | fpr=0.8661 | 8007.5 samples/s | 31.3 steps/s
[Step= 500] | Loss=9.71533 | acc=0.1466 | tpr=0.8727 | fpr=0.8665 | 7322.5 samples/s | 28.6 steps/s
[Step= 550] | Loss=9.71577 | acc=0.1464 | tpr=0.8707 | fpr=0.8667 | 14162.7 samples/s | 55.3 steps/s
Avg test loss: 9.71819, Avg test acc: 0.14634, Avg tpr: 0.87044, Avg fpr: 0.86683, total FA: 120357

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11348 | acc=0.9811 | tpr=0.9735 | fpr=0.0188 | 4177.5 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.11826 | acc=0.9805 | tpr=0.9765 | fpr=0.0194 | 7726.4 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.12319 | acc=0.9797 | tpr=0.9784 | fpr=0.0203 | 7788.0 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.12472 | acc=0.9796 | tpr=0.9770 | fpr=0.0204 | 7642.2 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.12300 | acc=0.9796 | tpr=0.9764 | fpr=0.0203 | 7665.8 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.12531 | acc=0.9793 | tpr=0.9753 | fpr=0.0207 | 7325.2 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.12579 | acc=0.9792 | tpr=0.9762 | fpr=0.0207 | 7937.0 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.12720 | acc=0.9790 | tpr=0.9743 | fpr=0.0209 | 7109.0 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.12996 | acc=0.9786 | tpr=0.9732 | fpr=0.0213 | 7445.8 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.12950 | acc=0.9786 | tpr=0.9731 | fpr=0.0213 | 7466.3 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.12854 | acc=0.9788 | tpr=0.9729 | fpr=0.0211 | 13790.9 samples/s | 53.9 steps/s
Avg test loss: 0.12829, Avg test acc: 0.97879, Avg tpr: 0.97306, Avg fpr: 0.02110, total FA: 2930

server round 41/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00006, len=1
[Step=32801 Epoch=32.0] | Loss=0.00000 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.563 | L2-Norm(final)=2.613 | 4178.2 samples/s | 65.3 steps/s
[Step=32850 Epoch=32.1] | Loss=0.00439 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.562 | L2-Norm(final)=2.614 | 4111.4 samples/s | 64.2 steps/s
[Step=32900 Epoch=32.1] | Loss=0.00412 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.561 | L2-Norm(final)=2.614 | 4427.3 samples/s | 69.2 steps/s
[Step=32950 Epoch=32.2] | Loss=0.00405 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.560 | L2-Norm(final)=2.614 | 4370.1 samples/s | 68.3 steps/s
[Step=33000 Epoch=32.2] | Loss=0.00404 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.559 | L2-Norm(final)=2.614 | 4266.0 samples/s | 66.7 steps/s
[Step=33050 Epoch=32.3] | Loss=0.00378 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.559 | L2-Norm(final)=2.615 | 4323.1 samples/s | 67.5 steps/s
[Step=33100 Epoch=32.3] | Loss=0.00379 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.558 | L2-Norm(final)=2.616 | 4310.7 samples/s | 67.4 steps/s
[Step=33150 Epoch=32.4] | Loss=0.00381 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.557 | L2-Norm(final)=2.616 | 4333.4 samples/s | 67.7 steps/s
[Step=33200 Epoch=32.4] | Loss=0.00385 | Reg=0.00344 | acc=0.9844 | L2-Norm=18.556 | L2-Norm(final)=2.617 | 4443.0 samples/s | 69.4 steps/s
[Step=33250 Epoch=32.5] | Loss=0.00392 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.556 | L2-Norm(final)=2.618 | 4431.2 samples/s | 69.2 steps/s
[Step=33300 Epoch=32.5] | Loss=0.00397 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.555 | L2-Norm(final)=2.618 | 4340.3 samples/s | 67.8 steps/s
[Step=33350 Epoch=32.6] | Loss=0.00392 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.554 | L2-Norm(final)=2.619 | 4353.0 samples/s | 68.0 steps/s
[Step=33400 Epoch=32.6] | Loss=0.00394 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.553 | L2-Norm(final)=2.619 | 4305.7 samples/s | 67.3 steps/s
[Step=33450 Epoch=32.7] | Loss=0.00397 | Reg=0.00344 | acc=0.9844 | L2-Norm=18.552 | L2-Norm(final)=2.620 | 4234.1 samples/s | 66.2 steps/s
[Step=33500 Epoch=32.7] | Loss=0.00390 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.551 | L2-Norm(final)=2.621 | 4312.8 samples/s | 67.4 steps/s
[Step=33550 Epoch=32.8] | Loss=0.00392 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.550 | L2-Norm(final)=2.621 | 4262.0 samples/s | 66.6 steps/s
[Step=33600 Epoch=32.8] | Loss=0.00394 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.549 | L2-Norm(final)=2.622 | 4336.6 samples/s | 67.8 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step33600.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00006, len=1
[Step=32801 Epoch=61.8] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.344 | L2-Norm(final)=4.651 | 3946.8 samples/s | 61.7 steps/s
[Step=32850 Epoch=61.9] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.343 | L2-Norm(final)=4.652 | 3835.1 samples/s | 59.9 steps/s
[Step=32900 Epoch=62.0] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.342 | L2-Norm(final)=4.652 | 4182.1 samples/s | 65.3 steps/s
[Step=32950 Epoch=62.1] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.340 | L2-Norm(final)=4.653 | 4090.8 samples/s | 63.9 steps/s
[Step=33000 Epoch=62.2] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.339 | L2-Norm(final)=4.654 | 4153.2 samples/s | 64.9 steps/s
[Step=33050 Epoch=62.3] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.338 | L2-Norm(final)=4.654 | 4159.5 samples/s | 65.0 steps/s
[Step=33100 Epoch=62.4] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.336 | L2-Norm(final)=4.655 | 4167.9 samples/s | 65.1 steps/s
[Step=33150 Epoch=62.5] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.335 | L2-Norm(final)=4.655 | 4156.5 samples/s | 64.9 steps/s
[Step=33200 Epoch=62.6] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.334 | L2-Norm(final)=4.656 | 4339.3 samples/s | 67.8 steps/s
[Step=33250 Epoch=62.7] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.332 | L2-Norm(final)=4.657 | 4348.9 samples/s | 68.0 steps/s
[Step=33300 Epoch=62.8] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.331 | L2-Norm(final)=4.657 | 4355.1 samples/s | 68.0 steps/s
[Step=33350 Epoch=62.9] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.329 | L2-Norm(final)=4.658 | 2120.6 samples/s | 33.1 steps/s
[Step=33400 Epoch=63.0] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.328 | L2-Norm(final)=4.659 | 4343.8 samples/s | 67.9 steps/s
[Step=33450 Epoch=63.1] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.326 | L2-Norm(final)=4.660 | 4367.9 samples/s | 68.2 steps/s
[Step=33500 Epoch=63.1] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.325 | L2-Norm(final)=4.660 | 4261.1 samples/s | 66.6 steps/s
[Step=33550 Epoch=63.2] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.323 | L2-Norm(final)=4.661 | 4235.4 samples/s | 66.2 steps/s
[Step=33600 Epoch=63.3] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.322 | L2-Norm(final)=4.662 | 4198.1 samples/s | 65.6 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step33600.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11218 | acc=0.9723 | tpr=0.9772 | fpr=0.0384 | 4287.3 samples/s | 16.7 steps/s
Avg test loss: 0.11786, Avg test acc: 0.97127, Avg tpr: 0.97686, Avg fpr: 0.04102, total FA: 320

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.98814 | acc=0.3143 | tpr=0.0027 | fpr=0.0092 | 4280.5 samples/s | 16.7 steps/s
Avg test loss: 5.00852, Avg test acc: 0.31108, Avg tpr: 0.00256, Avg fpr: 0.01038, total FA: 81

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=9.76102 | acc=0.1484 | tpr=0.9071 | fpr=0.8653 | 4286.0 samples/s | 16.7 steps/s
[Step= 100] | Loss=9.69032 | acc=0.1504 | tpr=0.8849 | fpr=0.8634 | 7441.4 samples/s | 29.1 steps/s
[Step= 150] | Loss=9.72228 | acc=0.1497 | tpr=0.8761 | fpr=0.8637 | 7720.1 samples/s | 30.2 steps/s
[Step= 200] | Loss=9.70774 | acc=0.1499 | tpr=0.8743 | fpr=0.8633 | 7921.0 samples/s | 30.9 steps/s
[Step= 250] | Loss=9.70256 | acc=0.1502 | tpr=0.8629 | fpr=0.8628 | 7789.5 samples/s | 30.4 steps/s
[Step= 300] | Loss=9.70575 | acc=0.1499 | tpr=0.8625 | fpr=0.8631 | 7931.2 samples/s | 31.0 steps/s
[Step= 350] | Loss=9.69425 | acc=0.1498 | tpr=0.8654 | fpr=0.8632 | 7511.1 samples/s | 29.3 steps/s
[Step= 400] | Loss=9.69711 | acc=0.1498 | tpr=0.8627 | fpr=0.8632 | 7523.7 samples/s | 29.4 steps/s
[Step= 450] | Loss=9.70432 | acc=0.1500 | tpr=0.8632 | fpr=0.8630 | 7384.1 samples/s | 28.8 steps/s
[Step= 500] | Loss=9.70986 | acc=0.1495 | tpr=0.8656 | fpr=0.8635 | 7516.9 samples/s | 29.4 steps/s
[Step= 550] | Loss=9.70991 | acc=0.1494 | tpr=0.8655 | fpr=0.8636 | 13852.9 samples/s | 54.1 steps/s
Avg test loss: 9.71243, Avg test acc: 0.14935, Avg tpr: 0.86529, Avg fpr: 0.86366, total FA: 119918

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11417 | acc=0.9807 | tpr=0.9735 | fpr=0.0192 | 4130.6 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.11892 | acc=0.9802 | tpr=0.9765 | fpr=0.0197 | 7537.4 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.12388 | acc=0.9793 | tpr=0.9784 | fpr=0.0207 | 7866.5 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.12543 | acc=0.9793 | tpr=0.9770 | fpr=0.0207 | 7438.1 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.12373 | acc=0.9794 | tpr=0.9764 | fpr=0.0206 | 7594.9 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.12605 | acc=0.9790 | tpr=0.9753 | fpr=0.0209 | 7480.6 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.12654 | acc=0.9790 | tpr=0.9762 | fpr=0.0210 | 7053.2 samples/s | 27.6 steps/s
[Step= 400] | Loss=0.12795 | acc=0.9788 | tpr=0.9743 | fpr=0.0211 | 7453.7 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.13073 | acc=0.9784 | tpr=0.9732 | fpr=0.0215 | 7142.8 samples/s | 27.9 steps/s
[Step= 500] | Loss=0.13026 | acc=0.9783 | tpr=0.9731 | fpr=0.0216 | 7312.3 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.12929 | acc=0.9785 | tpr=0.9729 | fpr=0.0214 | 13605.7 samples/s | 53.1 steps/s
Avg test loss: 0.12904, Avg test acc: 0.97855, Avg tpr: 0.97306, Avg fpr: 0.02135, total FA: 2964

server round 42/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00006, len=1
[Step=33601 Epoch=32.8] | Loss=0.00001 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.533 | L2-Norm(final)=2.629 | 4587.7 samples/s | 71.7 steps/s
[Step=33650 Epoch=32.9] | Loss=0.00337 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.532 | L2-Norm(final)=2.629 | 3895.4 samples/s | 60.9 steps/s
[Step=33700 Epoch=32.9] | Loss=0.00297 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.532 | L2-Norm(final)=2.629 | 4285.0 samples/s | 67.0 steps/s
[Step=33750 Epoch=33.0] | Loss=0.00292 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.531 | L2-Norm(final)=2.630 | 4360.1 samples/s | 68.1 steps/s
[Step=33800 Epoch=33.0] | Loss=0.00325 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.530 | L2-Norm(final)=2.630 | 4407.7 samples/s | 68.9 steps/s
[Step=33850 Epoch=33.0] | Loss=0.00336 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.529 | L2-Norm(final)=2.631 | 4326.9 samples/s | 67.6 steps/s
[Step=33900 Epoch=33.1] | Loss=0.00339 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.528 | L2-Norm(final)=2.631 | 4520.8 samples/s | 70.6 steps/s
[Step=33950 Epoch=33.1] | Loss=0.00339 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.527 | L2-Norm(final)=2.632 | 4433.7 samples/s | 69.3 steps/s
[Step=34000 Epoch=33.2] | Loss=0.00356 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.526 | L2-Norm(final)=2.632 | 4541.5 samples/s | 71.0 steps/s
[Step=34050 Epoch=33.2] | Loss=0.00365 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.525 | L2-Norm(final)=2.632 | 4544.6 samples/s | 71.0 steps/s
[Step=34100 Epoch=33.3] | Loss=0.00365 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.524 | L2-Norm(final)=2.633 | 4558.8 samples/s | 71.2 steps/s
[Step=34150 Epoch=33.3] | Loss=0.00365 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.524 | L2-Norm(final)=2.633 | 4521.8 samples/s | 70.7 steps/s
[Step=34200 Epoch=33.4] | Loss=0.00378 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.523 | L2-Norm(final)=2.634 | 4543.1 samples/s | 71.0 steps/s
[Step=34250 Epoch=33.4] | Loss=0.00371 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.522 | L2-Norm(final)=2.634 | 4577.5 samples/s | 71.5 steps/s
[Step=34300 Epoch=33.5] | Loss=0.00371 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.521 | L2-Norm(final)=2.635 | 4560.3 samples/s | 71.3 steps/s
[Step=34350 Epoch=33.5] | Loss=0.00372 | Reg=0.00343 | acc=0.9844 | L2-Norm=18.520 | L2-Norm(final)=2.635 | 4617.9 samples/s | 72.2 steps/s
[Step=34400 Epoch=33.6] | Loss=0.00374 | Reg=0.00343 | acc=0.9844 | L2-Norm=18.519 | L2-Norm(final)=2.636 | 4619.8 samples/s | 72.2 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step34400.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00006, len=1
[Step=33601 Epoch=63.3] | Loss=0.00001 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.297 | L2-Norm(final)=4.674 | 4187.4 samples/s | 65.4 steps/s
[Step=33650 Epoch=63.4] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.295 | L2-Norm(final)=4.675 | 4063.8 samples/s | 63.5 steps/s
[Step=33700 Epoch=63.5] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.293 | L2-Norm(final)=4.676 | 4142.2 samples/s | 64.7 steps/s
[Step=33750 Epoch=63.6] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.292 | L2-Norm(final)=4.677 | 4252.6 samples/s | 66.4 steps/s
[Step=33800 Epoch=63.7] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.290 | L2-Norm(final)=4.678 | 4195.5 samples/s | 65.6 steps/s
[Step=33850 Epoch=63.8] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.288 | L2-Norm(final)=4.679 | 4149.6 samples/s | 64.8 steps/s
[Step=33900 Epoch=63.9] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.286 | L2-Norm(final)=4.680 | 4287.4 samples/s | 67.0 steps/s
[Step=33950 Epoch=64.0] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.284 | L2-Norm(final)=4.681 | 4293.5 samples/s | 67.1 steps/s
[Step=34000 Epoch=64.1] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.282 | L2-Norm(final)=4.682 | 4281.2 samples/s | 66.9 steps/s
[Step=34050 Epoch=64.2] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.280 | L2-Norm(final)=4.683 | 4296.6 samples/s | 67.1 steps/s
[Step=34100 Epoch=64.3] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.279 | L2-Norm(final)=4.684 | 4393.4 samples/s | 68.6 steps/s
[Step=34150 Epoch=64.4] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.277 | L2-Norm(final)=4.685 | 2114.8 samples/s | 33.0 steps/s
[Step=34200 Epoch=64.5] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.275 | L2-Norm(final)=4.686 | 4196.8 samples/s | 65.6 steps/s
[Step=34250 Epoch=64.6] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.272 | L2-Norm(final)=4.688 | 4290.1 samples/s | 67.0 steps/s
[Step=34300 Epoch=64.7] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.270 | L2-Norm(final)=4.689 | 4366.7 samples/s | 68.2 steps/s
[Step=34350 Epoch=64.8] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.268 | L2-Norm(final)=4.690 | 4317.8 samples/s | 67.5 steps/s
[Step=34400 Epoch=64.8] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.266 | L2-Norm(final)=4.691 | 4195.7 samples/s | 65.6 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step34400.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11406 | acc=0.9722 | tpr=0.9784 | fpr=0.0414 | 4184.7 samples/s | 16.3 steps/s
Avg test loss: 0.11949, Avg test acc: 0.97143, Avg tpr: 0.97808, Avg fpr: 0.04320, total FA: 337

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.02487 | acc=0.3141 | tpr=0.0024 | fpr=0.0089 | 4095.8 samples/s | 16.0 steps/s
Avg test loss: 5.04538, Avg test acc: 0.31116, Avg tpr: 0.00239, Avg fpr: 0.00974, total FA: 76

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=9.95808 | acc=0.1446 | tpr=0.9115 | fpr=0.8692 | 4096.8 samples/s | 16.0 steps/s
[Step= 100] | Loss=9.88745 | acc=0.1475 | tpr=0.8934 | fpr=0.8665 | 7916.4 samples/s | 30.9 steps/s
[Step= 150] | Loss=9.91847 | acc=0.1467 | tpr=0.8818 | fpr=0.8668 | 7375.6 samples/s | 28.8 steps/s
[Step= 200] | Loss=9.90279 | acc=0.1467 | tpr=0.8787 | fpr=0.8666 | 7545.1 samples/s | 29.5 steps/s
[Step= 250] | Loss=9.89893 | acc=0.1473 | tpr=0.8681 | fpr=0.8658 | 7642.2 samples/s | 29.9 steps/s
[Step= 300] | Loss=9.90086 | acc=0.1468 | tpr=0.8691 | fpr=0.8663 | 7709.1 samples/s | 30.1 steps/s
[Step= 350] | Loss=9.88992 | acc=0.1468 | tpr=0.8729 | fpr=0.8664 | 7447.1 samples/s | 29.1 steps/s
[Step= 400] | Loss=9.89291 | acc=0.1468 | tpr=0.8714 | fpr=0.8664 | 7605.6 samples/s | 29.7 steps/s
[Step= 450] | Loss=9.90034 | acc=0.1469 | tpr=0.8715 | fpr=0.8662 | 7346.5 samples/s | 28.7 steps/s
[Step= 500] | Loss=9.90628 | acc=0.1465 | tpr=0.8731 | fpr=0.8666 | 7166.7 samples/s | 28.0 steps/s
[Step= 550] | Loss=9.90657 | acc=0.1464 | tpr=0.8719 | fpr=0.8668 | 13330.5 samples/s | 52.1 steps/s
Avg test loss: 9.90888, Avg test acc: 0.14632, Avg tpr: 0.87163, Avg fpr: 0.86686, total FA: 120362

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11281 | acc=0.9812 | tpr=0.9779 | fpr=0.0187 | 4036.5 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.11755 | acc=0.9807 | tpr=0.9808 | fpr=0.0193 | 7194.4 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.12241 | acc=0.9797 | tpr=0.9813 | fpr=0.0203 | 7215.0 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.12397 | acc=0.9797 | tpr=0.9792 | fpr=0.0203 | 7358.1 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.12230 | acc=0.9798 | tpr=0.9782 | fpr=0.0202 | 7961.0 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.12462 | acc=0.9794 | tpr=0.9760 | fpr=0.0205 | 7212.6 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.12510 | acc=0.9793 | tpr=0.9768 | fpr=0.0206 | 7885.3 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.12648 | acc=0.9792 | tpr=0.9748 | fpr=0.0208 | 7606.9 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.12923 | acc=0.9787 | tpr=0.9732 | fpr=0.0212 | 7649.9 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.12876 | acc=0.9786 | tpr=0.9731 | fpr=0.0213 | 7669.5 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.12780 | acc=0.9788 | tpr=0.9729 | fpr=0.0211 | 13762.3 samples/s | 53.8 steps/s
Avg test loss: 0.12755, Avg test acc: 0.97882, Avg tpr: 0.97266, Avg fpr: 0.02107, total FA: 2925

server round 43/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00006, len=1
[Step=34401 Epoch=33.6] | Loss=0.00492 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.504 | L2-Norm(final)=2.642 | 4088.9 samples/s | 63.9 steps/s
[Step=34450 Epoch=33.6] | Loss=0.00386 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.503 | L2-Norm(final)=2.643 | 4023.0 samples/s | 62.9 steps/s
[Step=34500 Epoch=33.7] | Loss=0.00346 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.503 | L2-Norm(final)=2.643 | 4495.9 samples/s | 70.2 steps/s
[Step=34550 Epoch=33.7] | Loss=0.00382 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.501 | L2-Norm(final)=2.644 | 4497.0 samples/s | 70.3 steps/s
[Step=34600 Epoch=33.8] | Loss=0.00382 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.500 | L2-Norm(final)=2.644 | 4422.0 samples/s | 69.1 steps/s
[Step=34650 Epoch=33.8] | Loss=0.00399 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.499 | L2-Norm(final)=2.644 | 4463.7 samples/s | 69.7 steps/s
[Step=34700 Epoch=33.9] | Loss=0.00393 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.498 | L2-Norm(final)=2.645 | 4480.0 samples/s | 70.0 steps/s
[Step=34750 Epoch=33.9] | Loss=0.00383 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.497 | L2-Norm(final)=2.645 | 4497.4 samples/s | 70.3 steps/s
[Step=34800 Epoch=34.0] | Loss=0.00392 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.496 | L2-Norm(final)=2.645 | 4644.7 samples/s | 72.6 steps/s
[Step=34850 Epoch=34.0] | Loss=0.00392 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.495 | L2-Norm(final)=2.645 | 4504.7 samples/s | 70.4 steps/s
[Step=34900 Epoch=34.1] | Loss=0.00386 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.494 | L2-Norm(final)=2.646 | 4540.0 samples/s | 70.9 steps/s
[Step=34950 Epoch=34.1] | Loss=0.00383 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.493 | L2-Norm(final)=2.646 | 4528.1 samples/s | 70.8 steps/s
[Step=35000 Epoch=34.2] | Loss=0.00390 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.492 | L2-Norm(final)=2.646 | 4518.2 samples/s | 70.6 steps/s
[Step=35050 Epoch=34.2] | Loss=0.00391 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.491 | L2-Norm(final)=2.647 | 4514.7 samples/s | 70.5 steps/s
[Step=35100 Epoch=34.3] | Loss=0.00394 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.490 | L2-Norm(final)=2.647 | 4565.2 samples/s | 71.3 steps/s
[Step=35150 Epoch=34.3] | Loss=0.00388 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.489 | L2-Norm(final)=2.647 | 4584.6 samples/s | 71.6 steps/s
[Step=35200 Epoch=34.4] | Loss=0.00383 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.488 | L2-Norm(final)=2.648 | 4509.2 samples/s | 70.5 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step35200.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00006, len=1
[Step=34401 Epoch=64.8] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.232 | L2-Norm(final)=4.711 | 4207.4 samples/s | 65.7 steps/s
[Step=34450 Epoch=64.9] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.230 | L2-Norm(final)=4.712 | 3876.3 samples/s | 60.6 steps/s
[Step=34500 Epoch=65.0] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.227 | L2-Norm(final)=4.714 | 4328.7 samples/s | 67.6 steps/s
[Step=34550 Epoch=65.1] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.225 | L2-Norm(final)=4.715 | 4384.0 samples/s | 68.5 steps/s
[Step=34600 Epoch=65.2] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.223 | L2-Norm(final)=4.717 | 4234.6 samples/s | 66.2 steps/s
[Step=34650 Epoch=65.3] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.220 | L2-Norm(final)=4.718 | 4233.4 samples/s | 66.1 steps/s
[Step=34700 Epoch=65.4] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.218 | L2-Norm(final)=4.720 | 4164.8 samples/s | 65.1 steps/s
[Step=34750 Epoch=65.5] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.215 | L2-Norm(final)=4.721 | 4268.7 samples/s | 66.7 steps/s
[Step=34800 Epoch=65.6] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.213 | L2-Norm(final)=4.723 | 4326.8 samples/s | 67.6 steps/s
[Step=34850 Epoch=65.7] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.210 | L2-Norm(final)=4.725 | 4231.1 samples/s | 66.1 steps/s
[Step=34900 Epoch=65.8] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.208 | L2-Norm(final)=4.726 | 4228.4 samples/s | 66.1 steps/s
[Step=34950 Epoch=65.9] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.205 | L2-Norm(final)=4.728 | 2086.9 samples/s | 32.6 steps/s
[Step=35000 Epoch=66.0] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.202 | L2-Norm(final)=4.730 | 4248.8 samples/s | 66.4 steps/s
[Step=35050 Epoch=66.1] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.200 | L2-Norm(final)=4.731 | 4275.4 samples/s | 66.8 steps/s
[Step=35100 Epoch=66.2] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.197 | L2-Norm(final)=4.733 | 4229.6 samples/s | 66.1 steps/s
[Step=35150 Epoch=66.3] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.194 | L2-Norm(final)=4.735 | 4211.5 samples/s | 65.8 steps/s
[Step=35200 Epoch=66.4] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.191 | L2-Norm(final)=4.736 | 4101.8 samples/s | 64.1 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step35200.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11821 | acc=0.9719 | tpr=0.9765 | fpr=0.0382 | 4066.4 samples/s | 15.9 steps/s
Avg test loss: 0.12384, Avg test acc: 0.97087, Avg tpr: 0.97616, Avg fpr: 0.04076, total FA: 318

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.01843 | acc=0.3143 | tpr=0.0026 | fpr=0.0089 | 4150.3 samples/s | 16.2 steps/s
Avg test loss: 5.03883, Avg test acc: 0.31116, Avg tpr: 0.00251, Avg fpr: 0.01000, total FA: 78

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=10.01885 | acc=0.1478 | tpr=0.9204 | fpr=0.8661 | 4032.2 samples/s | 15.8 steps/s
[Step= 100] | Loss=9.94773 | acc=0.1496 | tpr=0.8955 | fpr=0.8643 | 7141.6 samples/s | 27.9 steps/s
[Step= 150] | Loss=9.98016 | acc=0.1488 | tpr=0.8847 | fpr=0.8648 | 7430.9 samples/s | 29.0 steps/s
[Step= 200] | Loss=9.96444 | acc=0.1492 | tpr=0.8809 | fpr=0.8641 | 7319.0 samples/s | 28.6 steps/s
[Step= 250] | Loss=9.96041 | acc=0.1496 | tpr=0.8699 | fpr=0.8635 | 7504.9 samples/s | 29.3 steps/s
[Step= 300] | Loss=9.96298 | acc=0.1492 | tpr=0.8705 | fpr=0.8639 | 7010.8 samples/s | 27.4 steps/s
[Step= 350] | Loss=9.95143 | acc=0.1492 | tpr=0.8723 | fpr=0.8639 | 7120.0 samples/s | 27.8 steps/s
[Step= 400] | Loss=9.95376 | acc=0.1492 | tpr=0.8714 | fpr=0.8639 | 7216.2 samples/s | 28.2 steps/s
[Step= 450] | Loss=9.96147 | acc=0.1494 | tpr=0.8715 | fpr=0.8637 | 7422.1 samples/s | 29.0 steps/s
[Step= 500] | Loss=9.96781 | acc=0.1490 | tpr=0.8740 | fpr=0.8641 | 7835.1 samples/s | 30.6 steps/s
[Step= 550] | Loss=9.96829 | acc=0.1489 | tpr=0.8731 | fpr=0.8643 | 14105.7 samples/s | 55.1 steps/s
Avg test loss: 9.97065, Avg test acc: 0.14882, Avg tpr: 0.87282, Avg fpr: 0.86434, total FA: 120012

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11521 | acc=0.9807 | tpr=0.9779 | fpr=0.0192 | 4201.9 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.11995 | acc=0.9803 | tpr=0.9808 | fpr=0.0197 | 7577.5 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.12489 | acc=0.9793 | tpr=0.9813 | fpr=0.0207 | 7663.7 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.12651 | acc=0.9793 | tpr=0.9792 | fpr=0.0207 | 7989.1 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.12486 | acc=0.9794 | tpr=0.9773 | fpr=0.0206 | 7456.0 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.12723 | acc=0.9790 | tpr=0.9753 | fpr=0.0210 | 7701.1 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.12773 | acc=0.9789 | tpr=0.9762 | fpr=0.0211 | 7614.2 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.12911 | acc=0.9787 | tpr=0.9743 | fpr=0.0212 | 7602.8 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.13191 | acc=0.9782 | tpr=0.9732 | fpr=0.0217 | 7397.2 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.13145 | acc=0.9782 | tpr=0.9736 | fpr=0.0217 | 7313.6 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.13048 | acc=0.9784 | tpr=0.9733 | fpr=0.0215 | 13866.6 samples/s | 54.2 steps/s
Avg test loss: 0.13023, Avg test acc: 0.97840, Avg tpr: 0.97306, Avg fpr: 0.02150, total FA: 2985

server round 44/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00006, len=1
[Step=35201 Epoch=34.4] | Loss=0.00014 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.473 | L2-Norm(final)=2.654 | 4852.7 samples/s | 75.8 steps/s
[Step=35250 Epoch=34.4] | Loss=0.00303 | Reg=0.00341 | acc=0.9844 | L2-Norm=18.472 | L2-Norm(final)=2.654 | 3954.3 samples/s | 61.8 steps/s
[Step=35300 Epoch=34.5] | Loss=0.00340 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.471 | L2-Norm(final)=2.655 | 4385.8 samples/s | 68.5 steps/s
[Step=35350 Epoch=34.5] | Loss=0.00308 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.470 | L2-Norm(final)=2.655 | 4475.5 samples/s | 69.9 steps/s
[Step=35400 Epoch=34.6] | Loss=0.00323 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.469 | L2-Norm(final)=2.656 | 4161.4 samples/s | 65.0 steps/s
[Step=35450 Epoch=34.6] | Loss=0.00331 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.468 | L2-Norm(final)=2.656 | 4393.5 samples/s | 68.6 steps/s
[Step=35500 Epoch=34.7] | Loss=0.00325 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.467 | L2-Norm(final)=2.657 | 4483.2 samples/s | 70.0 steps/s
[Step=35550 Epoch=34.7] | Loss=0.00320 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.466 | L2-Norm(final)=2.657 | 4522.8 samples/s | 70.7 steps/s
[Step=35600 Epoch=34.8] | Loss=0.00343 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.465 | L2-Norm(final)=2.658 | 4428.1 samples/s | 69.2 steps/s
[Step=35650 Epoch=34.8] | Loss=0.00347 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.464 | L2-Norm(final)=2.658 | 4423.3 samples/s | 69.1 steps/s
[Step=35700 Epoch=34.9] | Loss=0.00350 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.463 | L2-Norm(final)=2.658 | 4414.6 samples/s | 69.0 steps/s
[Step=35750 Epoch=34.9] | Loss=0.00352 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.462 | L2-Norm(final)=2.658 | 4349.4 samples/s | 68.0 steps/s
[Step=35800 Epoch=35.0] | Loss=0.00350 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.461 | L2-Norm(final)=2.659 | 4342.5 samples/s | 67.9 steps/s
[Step=35850 Epoch=35.0] | Loss=0.00349 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.460 | L2-Norm(final)=2.659 | 4434.9 samples/s | 69.3 steps/s
[Step=35900 Epoch=35.1] | Loss=0.00352 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.459 | L2-Norm(final)=2.659 | 4428.8 samples/s | 69.2 steps/s
[Step=35950 Epoch=35.1] | Loss=0.00353 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.458 | L2-Norm(final)=2.659 | 4401.4 samples/s | 68.8 steps/s
[Step=36000 Epoch=35.1] | Loss=0.00348 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.457 | L2-Norm(final)=2.660 | 4435.5 samples/s | 69.3 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step36000.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00006, len=1
[Step=35201 Epoch=66.4] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.147 | L2-Norm(final)=4.765 | 4354.5 samples/s | 68.0 steps/s
[Step=35250 Epoch=66.4] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.144 | L2-Norm(final)=4.768 | 3864.4 samples/s | 60.4 steps/s
[Step=35300 Epoch=66.5] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.141 | L2-Norm(final)=4.770 | 4170.0 samples/s | 65.2 steps/s
[Step=35350 Epoch=66.6] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.138 | L2-Norm(final)=4.772 | 4295.3 samples/s | 67.1 steps/s
[Step=35400 Epoch=66.7] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.135 | L2-Norm(final)=4.774 | 4292.4 samples/s | 67.1 steps/s
[Step=35450 Epoch=66.8] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.132 | L2-Norm(final)=4.777 | 4287.3 samples/s | 67.0 steps/s
[Step=35500 Epoch=66.9] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.128 | L2-Norm(final)=4.779 | 4159.0 samples/s | 65.0 steps/s
[Step=35550 Epoch=67.0] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.124 | L2-Norm(final)=4.781 | 4186.7 samples/s | 65.4 steps/s
[Step=35600 Epoch=67.1] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.121 | L2-Norm(final)=4.783 | 4128.0 samples/s | 64.5 steps/s
[Step=35650 Epoch=67.2] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.117 | L2-Norm(final)=4.785 | 4151.3 samples/s | 64.9 steps/s
[Step=35700 Epoch=67.3] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.114 | L2-Norm(final)=4.787 | 4219.8 samples/s | 65.9 steps/s
[Step=35750 Epoch=67.4] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.110 | L2-Norm(final)=4.790 | 2007.9 samples/s | 31.4 steps/s
[Step=35800 Epoch=67.5] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.107 | L2-Norm(final)=4.792 | 4134.9 samples/s | 64.6 steps/s
[Step=35850 Epoch=67.6] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.103 | L2-Norm(final)=4.794 | 4150.2 samples/s | 64.8 steps/s
[Step=35900 Epoch=67.7] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.100 | L2-Norm(final)=4.797 | 4000.8 samples/s | 62.5 steps/s
[Step=35950 Epoch=67.8] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.096 | L2-Norm(final)=4.799 | 4057.3 samples/s | 63.4 steps/s
[Step=36000 Epoch=67.9] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.092 | L2-Norm(final)=4.802 | 4077.2 samples/s | 63.7 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step36000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11618 | acc=0.9721 | tpr=0.9770 | fpr=0.0384 | 4028.8 samples/s | 15.7 steps/s
Avg test loss: 0.12209, Avg test acc: 0.97103, Avg tpr: 0.97639, Avg fpr: 0.04076, total FA: 318

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.95498 | acc=0.3144 | tpr=0.0031 | fpr=0.0097 | 3991.0 samples/s | 15.6 steps/s
Avg test loss: 4.97552, Avg test acc: 0.31116, Avg tpr: 0.00297, Avg fpr: 0.01102, total FA: 86

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=9.98396 | acc=0.1487 | tpr=0.9115 | fpr=0.8650 | 4312.7 samples/s | 16.8 steps/s
[Step= 100] | Loss=9.91183 | acc=0.1505 | tpr=0.8913 | fpr=0.8634 | 7231.9 samples/s | 28.2 steps/s
[Step= 150] | Loss=9.94520 | acc=0.1499 | tpr=0.8804 | fpr=0.8636 | 7899.9 samples/s | 30.9 steps/s
[Step= 200] | Loss=9.92958 | acc=0.1501 | tpr=0.8787 | fpr=0.8631 | 7638.9 samples/s | 29.8 steps/s
[Step= 250] | Loss=9.92615 | acc=0.1504 | tpr=0.8672 | fpr=0.8626 | 7874.0 samples/s | 30.8 steps/s
[Step= 300] | Loss=9.92855 | acc=0.1502 | tpr=0.8691 | fpr=0.8629 | 7712.2 samples/s | 30.1 steps/s
[Step= 350] | Loss=9.91703 | acc=0.1500 | tpr=0.8716 | fpr=0.8631 | 7817.5 samples/s | 30.5 steps/s
[Step= 400] | Loss=9.91948 | acc=0.1499 | tpr=0.8687 | fpr=0.8631 | 7676.6 samples/s | 30.0 steps/s
[Step= 450] | Loss=9.92705 | acc=0.1501 | tpr=0.8690 | fpr=0.8630 | 7467.5 samples/s | 29.2 steps/s
[Step= 500] | Loss=9.93338 | acc=0.1496 | tpr=0.8705 | fpr=0.8634 | 7300.9 samples/s | 28.5 steps/s
[Step= 550] | Loss=9.93390 | acc=0.1496 | tpr=0.8699 | fpr=0.8635 | 14551.2 samples/s | 56.8 steps/s
Avg test loss: 9.93620, Avg test acc: 0.14952, Avg tpr: 0.86965, Avg fpr: 0.86357, total FA: 119905

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11706 | acc=0.9804 | tpr=0.9779 | fpr=0.0196 | 4089.1 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.12174 | acc=0.9798 | tpr=0.9829 | fpr=0.0203 | 7976.1 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.12674 | acc=0.9789 | tpr=0.9841 | fpr=0.0212 | 7849.1 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.12829 | acc=0.9789 | tpr=0.9825 | fpr=0.0212 | 7398.9 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.12666 | acc=0.9790 | tpr=0.9799 | fpr=0.0210 | 7751.9 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.12903 | acc=0.9786 | tpr=0.9775 | fpr=0.0214 | 7569.8 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.12957 | acc=0.9785 | tpr=0.9781 | fpr=0.0215 | 7285.4 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.13098 | acc=0.9783 | tpr=0.9765 | fpr=0.0217 | 7402.2 samples/s | 28.9 steps/s
[Step= 450] | Loss=0.13380 | acc=0.9778 | tpr=0.9752 | fpr=0.0221 | 7634.9 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.13334 | acc=0.9778 | tpr=0.9753 | fpr=0.0222 | 7336.9 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.13236 | acc=0.9780 | tpr=0.9749 | fpr=0.0220 | 14544.8 samples/s | 56.8 steps/s
Avg test loss: 0.13212, Avg test acc: 0.97797, Avg tpr: 0.97504, Avg fpr: 0.02197, total FA: 3051

server round 45/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00006, len=1
[Step=36001 Epoch=35.1] | Loss=0.00687 | Reg=0.00340 | acc=0.9844 | L2-Norm=18.441 | L2-Norm(final)=2.664 | 4821.5 samples/s | 75.3 steps/s
[Step=36050 Epoch=35.2] | Loss=0.00451 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.440 | L2-Norm(final)=2.665 | 4037.9 samples/s | 63.1 steps/s
[Step=36100 Epoch=35.2] | Loss=0.00407 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.439 | L2-Norm(final)=2.666 | 4327.6 samples/s | 67.6 steps/s
[Step=36150 Epoch=35.3] | Loss=0.00365 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.438 | L2-Norm(final)=2.667 | 4365.9 samples/s | 68.2 steps/s
[Step=36200 Epoch=35.3] | Loss=0.00341 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.437 | L2-Norm(final)=2.668 | 4337.6 samples/s | 67.8 steps/s
[Step=36250 Epoch=35.4] | Loss=0.00332 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.436 | L2-Norm(final)=2.668 | 4403.0 samples/s | 68.8 steps/s
[Step=36300 Epoch=35.4] | Loss=0.00339 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.436 | L2-Norm(final)=2.669 | 4405.7 samples/s | 68.8 steps/s
[Step=36350 Epoch=35.5] | Loss=0.00333 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.435 | L2-Norm(final)=2.669 | 4387.6 samples/s | 68.6 steps/s
[Step=36400 Epoch=35.5] | Loss=0.00349 | Reg=0.00340 | acc=0.9844 | L2-Norm=18.434 | L2-Norm(final)=2.670 | 4343.7 samples/s | 67.9 steps/s
[Step=36450 Epoch=35.6] | Loss=0.00344 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.433 | L2-Norm(final)=2.670 | 4382.4 samples/s | 68.5 steps/s
[Step=36500 Epoch=35.6] | Loss=0.00343 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.432 | L2-Norm(final)=2.671 | 4399.6 samples/s | 68.7 steps/s
[Step=36550 Epoch=35.7] | Loss=0.00358 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.431 | L2-Norm(final)=2.671 | 4316.1 samples/s | 67.4 steps/s
[Step=36600 Epoch=35.7] | Loss=0.00356 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.429 | L2-Norm(final)=2.671 | 4343.5 samples/s | 67.9 steps/s
[Step=36650 Epoch=35.8] | Loss=0.00359 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.428 | L2-Norm(final)=2.672 | 4304.1 samples/s | 67.3 steps/s
[Step=36700 Epoch=35.8] | Loss=0.00366 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.427 | L2-Norm(final)=2.672 | 4273.1 samples/s | 66.8 steps/s
[Step=36750 Epoch=35.9] | Loss=0.00374 | Reg=0.00340 | acc=0.9844 | L2-Norm=18.426 | L2-Norm(final)=2.672 | 4253.9 samples/s | 66.5 steps/s
[Step=36800 Epoch=35.9] | Loss=0.00376 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.425 | L2-Norm(final)=2.672 | 4329.3 samples/s | 67.6 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step36800.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00006, len=1
[Step=36001 Epoch=67.9] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.032 | L2-Norm(final)=4.840 | 4060.5 samples/s | 63.4 steps/s
[Step=36050 Epoch=68.0] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.027 | L2-Norm(final)=4.842 | 3932.4 samples/s | 61.4 steps/s
[Step=36100 Epoch=68.0] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.022 | L2-Norm(final)=4.845 | 4220.8 samples/s | 65.9 steps/s
[Step=36150 Epoch=68.1] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.020 | L2-Norm(final)=4.848 | 4077.2 samples/s | 63.7 steps/s
[Step=36200 Epoch=68.2] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.016 | L2-Norm(final)=4.852 | 4115.8 samples/s | 64.3 steps/s
[Step=36250 Epoch=68.3] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.013 | L2-Norm(final)=4.855 | 4170.3 samples/s | 65.2 steps/s
[Step=36300 Epoch=68.4] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.009 | L2-Norm(final)=4.858 | 4380.8 samples/s | 68.5 steps/s
[Step=36350 Epoch=68.5] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.006 | L2-Norm(final)=4.862 | 4385.4 samples/s | 68.5 steps/s
[Step=36400 Epoch=68.6] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.002 | L2-Norm(final)=4.865 | 4234.3 samples/s | 66.2 steps/s
[Step=36450 Epoch=68.7] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.998 | L2-Norm(final)=4.868 | 4282.0 samples/s | 66.9 steps/s
[Step=36500 Epoch=68.8] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.994 | L2-Norm(final)=4.871 | 4316.7 samples/s | 67.4 steps/s
[Step=36550 Epoch=68.9] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.990 | L2-Norm(final)=4.874 | 2119.9 samples/s | 33.1 steps/s
[Step=36600 Epoch=69.0] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.986 | L2-Norm(final)=4.878 | 4367.5 samples/s | 68.2 steps/s
[Step=36650 Epoch=69.1] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.982 | L2-Norm(final)=4.881 | 4329.6 samples/s | 67.6 steps/s
[Step=36700 Epoch=69.2] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.978 | L2-Norm(final)=4.884 | 4183.5 samples/s | 65.4 steps/s
[Step=36750 Epoch=69.3] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.973 | L2-Norm(final)=4.887 | 4276.4 samples/s | 66.8 steps/s
[Step=36800 Epoch=69.4] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.969 | L2-Norm(final)=4.891 | 4337.1 samples/s | 67.8 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step36800.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11317 | acc=0.9723 | tpr=0.9777 | fpr=0.0394 | 4182.4 samples/s | 16.3 steps/s
Avg test loss: 0.11792, Avg test acc: 0.97167, Avg tpr: 0.97779, Avg fpr: 0.04179, total FA: 326

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.02730 | acc=0.3140 | tpr=0.0024 | fpr=0.0094 | 4143.6 samples/s | 16.2 steps/s
Avg test loss: 5.04838, Avg test acc: 0.31104, Avg tpr: 0.00233, Avg fpr: 0.01000, total FA: 78

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=9.79967 | acc=0.1466 | tpr=0.9071 | fpr=0.8671 | 4189.1 samples/s | 16.4 steps/s
[Step= 100] | Loss=9.73010 | acc=0.1484 | tpr=0.8913 | fpr=0.8654 | 7785.4 samples/s | 30.4 steps/s
[Step= 150] | Loss=9.76339 | acc=0.1474 | tpr=0.8833 | fpr=0.8661 | 8123.9 samples/s | 31.7 steps/s
[Step= 200] | Loss=9.74887 | acc=0.1475 | tpr=0.8809 | fpr=0.8659 | 7683.1 samples/s | 30.0 steps/s
[Step= 250] | Loss=9.74563 | acc=0.1479 | tpr=0.8699 | fpr=0.8653 | 7519.9 samples/s | 29.4 steps/s
[Step= 300] | Loss=9.74884 | acc=0.1475 | tpr=0.8720 | fpr=0.8657 | 7733.8 samples/s | 30.2 steps/s
[Step= 350] | Loss=9.73799 | acc=0.1475 | tpr=0.8754 | fpr=0.8657 | 7961.0 samples/s | 31.1 steps/s
[Step= 400] | Loss=9.74081 | acc=0.1474 | tpr=0.8742 | fpr=0.8658 | 7494.2 samples/s | 29.3 steps/s
[Step= 450] | Loss=9.74858 | acc=0.1475 | tpr=0.8739 | fpr=0.8657 | 7422.7 samples/s | 29.0 steps/s
[Step= 500] | Loss=9.75503 | acc=0.1470 | tpr=0.8762 | fpr=0.8662 | 7809.2 samples/s | 30.5 steps/s
[Step= 550] | Loss=9.75515 | acc=0.1470 | tpr=0.8747 | fpr=0.8663 | 13135.5 samples/s | 51.3 steps/s
Avg test loss: 9.75740, Avg test acc: 0.14687, Avg tpr: 0.87441, Avg fpr: 0.86636, total FA: 120292

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11786 | acc=0.9804 | tpr=0.9779 | fpr=0.0196 | 4076.4 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.12250 | acc=0.9796 | tpr=0.9808 | fpr=0.0204 | 7604.8 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.12748 | acc=0.9788 | tpr=0.9827 | fpr=0.0212 | 7358.8 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.12915 | acc=0.9788 | tpr=0.9803 | fpr=0.0212 | 7434.8 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.12753 | acc=0.9790 | tpr=0.9790 | fpr=0.0210 | 7523.3 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.12990 | acc=0.9786 | tpr=0.9767 | fpr=0.0214 | 7928.8 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.13045 | acc=0.9785 | tpr=0.9775 | fpr=0.0215 | 6859.8 samples/s | 26.8 steps/s
[Step= 400] | Loss=0.13185 | acc=0.9783 | tpr=0.9759 | fpr=0.0216 | 7316.0 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.13464 | acc=0.9778 | tpr=0.9747 | fpr=0.0221 | 7188.8 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.13414 | acc=0.9779 | tpr=0.9749 | fpr=0.0221 | 7249.8 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.13315 | acc=0.9781 | tpr=0.9745 | fpr=0.0219 | 13410.1 samples/s | 52.4 steps/s
Avg test loss: 0.13290, Avg test acc: 0.97806, Avg tpr: 0.97425, Avg fpr: 0.02187, total FA: 3036

server round 46/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00006, len=1
[Step=36801 Epoch=35.9] | Loss=0.00015 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.408 | L2-Norm(final)=2.677 | 4070.0 samples/s | 63.6 steps/s
[Step=36850 Epoch=36.0] | Loss=0.00426 | Reg=0.00339 | acc=0.9844 | L2-Norm=18.407 | L2-Norm(final)=2.678 | 4408.0 samples/s | 68.9 steps/s
[Step=36900 Epoch=36.0] | Loss=0.00359 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.406 | L2-Norm(final)=2.679 | 4297.4 samples/s | 67.1 steps/s
[Step=36950 Epoch=36.1] | Loss=0.00384 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.406 | L2-Norm(final)=2.680 | 4269.3 samples/s | 66.7 steps/s
[Step=37000 Epoch=36.1] | Loss=0.00375 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.405 | L2-Norm(final)=2.680 | 4424.4 samples/s | 69.1 steps/s
[Step=37050 Epoch=36.2] | Loss=0.00344 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.404 | L2-Norm(final)=2.681 | 4510.0 samples/s | 70.5 steps/s
[Step=37100 Epoch=36.2] | Loss=0.00356 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.403 | L2-Norm(final)=2.682 | 4343.0 samples/s | 67.9 steps/s
[Step=37150 Epoch=36.3] | Loss=0.00340 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.402 | L2-Norm(final)=2.682 | 4490.2 samples/s | 70.2 steps/s
[Step=37200 Epoch=36.3] | Loss=0.00339 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.402 | L2-Norm(final)=2.683 | 4602.8 samples/s | 71.9 steps/s
[Step=37250 Epoch=36.4] | Loss=0.00338 | Reg=0.00339 | acc=0.9844 | L2-Norm=18.401 | L2-Norm(final)=2.684 | 4533.0 samples/s | 70.8 steps/s
[Step=37300 Epoch=36.4] | Loss=0.00344 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.400 | L2-Norm(final)=2.684 | 4466.3 samples/s | 69.8 steps/s
[Step=37350 Epoch=36.5] | Loss=0.00354 | Reg=0.00339 | acc=0.9844 | L2-Norm=18.399 | L2-Norm(final)=2.685 | 4462.6 samples/s | 69.7 steps/s
[Step=37400 Epoch=36.5] | Loss=0.00360 | Reg=0.00338 | acc=0.9688 | L2-Norm=18.398 | L2-Norm(final)=2.685 | 4404.7 samples/s | 68.8 steps/s
[Step=37450 Epoch=36.6] | Loss=0.00366 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.397 | L2-Norm(final)=2.686 | 4531.7 samples/s | 70.8 steps/s
[Step=37500 Epoch=36.6] | Loss=0.00365 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.396 | L2-Norm(final)=2.686 | 4625.4 samples/s | 72.3 steps/s
[Step=37550 Epoch=36.7] | Loss=0.00361 | Reg=0.00338 | acc=0.9844 | L2-Norm=18.395 | L2-Norm(final)=2.687 | 4555.1 samples/s | 71.2 steps/s
[Step=37600 Epoch=36.7] | Loss=0.00369 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.394 | L2-Norm(final)=2.687 | 4496.0 samples/s | 70.3 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step37600.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00006, len=1
[Step=36801 Epoch=69.4] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.897 | L2-Norm(final)=4.943 | 4450.8 samples/s | 69.5 steps/s
[Step=36850 Epoch=69.5] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.891 | L2-Norm(final)=4.946 | 3600.0 samples/s | 56.2 steps/s
[Step=36900 Epoch=69.6] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.886 | L2-Norm(final)=4.950 | 4311.5 samples/s | 67.4 steps/s
[Step=36950 Epoch=69.7] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.883 | L2-Norm(final)=4.955 | 4187.4 samples/s | 65.4 steps/s
[Step=37000 Epoch=69.7] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.878 | L2-Norm(final)=4.959 | 4293.6 samples/s | 67.1 steps/s
[Step=37050 Epoch=69.8] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.873 | L2-Norm(final)=4.963 | 4170.8 samples/s | 65.2 steps/s
[Step=37100 Epoch=69.9] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.869 | L2-Norm(final)=4.967 | 4285.0 samples/s | 67.0 steps/s
[Step=37150 Epoch=70.0] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.864 | L2-Norm(final)=4.971 | 4257.3 samples/s | 66.5 steps/s
[Step=37200 Epoch=70.1] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.859 | L2-Norm(final)=4.975 | 4364.0 samples/s | 68.2 steps/s
[Step=37250 Epoch=70.2] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.854 | L2-Norm(final)=4.979 | 4321.0 samples/s | 67.5 steps/s
[Step=37300 Epoch=70.3] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.850 | L2-Norm(final)=4.983 | 4258.0 samples/s | 66.5 steps/s
[Step=37350 Epoch=70.4] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.845 | L2-Norm(final)=4.988 | 2083.2 samples/s | 32.6 steps/s
[Step=37400 Epoch=70.5] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.840 | L2-Norm(final)=4.992 | 4354.4 samples/s | 68.0 steps/s
[Step=37450 Epoch=70.6] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.836 | L2-Norm(final)=4.997 | 4341.8 samples/s | 67.8 steps/s
[Step=37500 Epoch=70.7] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.831 | L2-Norm(final)=5.001 | 4369.5 samples/s | 68.3 steps/s
[Step=37550 Epoch=70.8] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.825 | L2-Norm(final)=5.005 | 4007.8 samples/s | 62.6 steps/s
[Step=37600 Epoch=70.9] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.820 | L2-Norm(final)=5.009 | 3985.5 samples/s | 62.3 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step37600.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11799 | acc=0.9719 | tpr=0.9774 | fpr=0.0401 | 4083.9 samples/s | 16.0 steps/s
Avg test loss: 0.12386, Avg test acc: 0.97131, Avg tpr: 0.97750, Avg fpr: 0.04230, total FA: 330

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.14558 | acc=0.3141 | tpr=0.0017 | fpr=0.0074 | 4082.1 samples/s | 15.9 steps/s
Avg test loss: 5.16724, Avg test acc: 0.31156, Avg tpr: 0.00198, Avg fpr: 0.00756, total FA: 59

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=10.24565 | acc=0.1436 | tpr=0.9159 | fpr=0.8703 | 4133.5 samples/s | 16.1 steps/s
[Step= 100] | Loss=10.17280 | acc=0.1458 | tpr=0.8955 | fpr=0.8682 | 7471.8 samples/s | 29.2 steps/s
[Step= 150] | Loss=10.20620 | acc=0.1450 | tpr=0.8862 | fpr=0.8686 | 7259.3 samples/s | 28.4 steps/s
[Step= 200] | Loss=10.19163 | acc=0.1450 | tpr=0.8842 | fpr=0.8685 | 7585.1 samples/s | 29.6 steps/s
[Step= 250] | Loss=10.18933 | acc=0.1455 | tpr=0.8725 | fpr=0.8677 | 7540.8 samples/s | 29.5 steps/s
[Step= 300] | Loss=10.19227 | acc=0.1451 | tpr=0.8742 | fpr=0.8682 | 7385.4 samples/s | 28.8 steps/s
[Step= 350] | Loss=10.18055 | acc=0.1451 | tpr=0.8766 | fpr=0.8682 | 7361.1 samples/s | 28.8 steps/s
[Step= 400] | Loss=10.18384 | acc=0.1451 | tpr=0.8758 | fpr=0.8682 | 7464.8 samples/s | 29.2 steps/s
[Step= 450] | Loss=10.19175 | acc=0.1451 | tpr=0.8759 | fpr=0.8681 | 7284.6 samples/s | 28.5 steps/s
[Step= 500] | Loss=10.19865 | acc=0.1447 | tpr=0.8771 | fpr=0.8685 | 7001.9 samples/s | 27.4 steps/s
[Step= 550] | Loss=10.19877 | acc=0.1447 | tpr=0.8762 | fpr=0.8686 | 13180.5 samples/s | 51.5 steps/s
Avg test loss: 10.20104, Avg test acc: 0.14464, Avg tpr: 0.87599, Avg fpr: 0.86865, total FA: 120611

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11043 | acc=0.9810 | tpr=0.9779 | fpr=0.0189 | 4006.9 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.11476 | acc=0.9807 | tpr=0.9808 | fpr=0.0193 | 7326.4 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.11934 | acc=0.9800 | tpr=0.9827 | fpr=0.0200 | 7441.9 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.12101 | acc=0.9798 | tpr=0.9803 | fpr=0.0202 | 7500.0 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.11943 | acc=0.9800 | tpr=0.9782 | fpr=0.0200 | 7852.5 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.12163 | acc=0.9795 | tpr=0.9767 | fpr=0.0204 | 7549.0 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.12210 | acc=0.9794 | tpr=0.9768 | fpr=0.0206 | 7924.9 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.12341 | acc=0.9792 | tpr=0.9754 | fpr=0.0208 | 7714.1 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.12597 | acc=0.9787 | tpr=0.9742 | fpr=0.0212 | 7535.6 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.12548 | acc=0.9788 | tpr=0.9740 | fpr=0.0211 | 7641.7 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.12457 | acc=0.9789 | tpr=0.9737 | fpr=0.0210 | 14059.3 samples/s | 54.9 steps/s
Avg test loss: 0.12433, Avg test acc: 0.97895, Avg tpr: 0.97345, Avg fpr: 0.02095, total FA: 2909

server round 47/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00006, len=1
[Step=37601 Epoch=36.7] | Loss=0.00462 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.378 | L2-Norm(final)=2.693 | 4016.3 samples/s | 62.8 steps/s
[Step=37650 Epoch=36.8] | Loss=0.00356 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.377 | L2-Norm(final)=2.693 | 4471.8 samples/s | 69.9 steps/s
[Step=37700 Epoch=36.8] | Loss=0.00293 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.376 | L2-Norm(final)=2.694 | 4452.7 samples/s | 69.6 steps/s
[Step=37750 Epoch=36.9] | Loss=0.00296 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.374 | L2-Norm(final)=2.694 | 4484.9 samples/s | 70.1 steps/s
[Step=37800 Epoch=36.9] | Loss=0.00287 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.373 | L2-Norm(final)=2.695 | 4482.4 samples/s | 70.0 steps/s
[Step=37850 Epoch=37.0] | Loss=0.00314 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.372 | L2-Norm(final)=2.696 | 4450.3 samples/s | 69.5 steps/s
[Step=37900 Epoch=37.0] | Loss=0.00333 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.371 | L2-Norm(final)=2.696 | 4600.4 samples/s | 71.9 steps/s
[Step=37950 Epoch=37.1] | Loss=0.00341 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.370 | L2-Norm(final)=2.697 | 4546.1 samples/s | 71.0 steps/s
[Step=38000 Epoch=37.1] | Loss=0.00348 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.369 | L2-Norm(final)=2.697 | 4588.9 samples/s | 71.7 steps/s
[Step=38050 Epoch=37.1] | Loss=0.00344 | Reg=0.00337 | acc=0.9844 | L2-Norm=18.368 | L2-Norm(final)=2.697 | 4526.9 samples/s | 70.7 steps/s
[Step=38100 Epoch=37.2] | Loss=0.00363 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.367 | L2-Norm(final)=2.698 | 4369.9 samples/s | 68.3 steps/s
[Step=38150 Epoch=37.2] | Loss=0.00366 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.366 | L2-Norm(final)=2.698 | 4461.1 samples/s | 69.7 steps/s
[Step=38200 Epoch=37.3] | Loss=0.00378 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.365 | L2-Norm(final)=2.698 | 4548.9 samples/s | 71.1 steps/s
[Step=38250 Epoch=37.3] | Loss=0.00372 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.364 | L2-Norm(final)=2.699 | 4502.9 samples/s | 70.4 steps/s
[Step=38300 Epoch=37.4] | Loss=0.00369 | Reg=0.00337 | acc=0.9844 | L2-Norm=18.363 | L2-Norm(final)=2.699 | 4593.2 samples/s | 71.8 steps/s
[Step=38350 Epoch=37.4] | Loss=0.00371 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.362 | L2-Norm(final)=2.699 | 4486.7 samples/s | 70.1 steps/s
[Step=38400 Epoch=37.5] | Loss=0.00371 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.361 | L2-Norm(final)=2.700 | 4412.3 samples/s | 68.9 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step38400.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00006, len=1
[Step=37601 Epoch=70.9] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.731 | L2-Norm(final)=5.071 | 4236.3 samples/s | 66.2 steps/s
[Step=37650 Epoch=71.0] | Loss=0.00001 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.728 | L2-Norm(final)=5.078 | 3979.1 samples/s | 62.2 steps/s
[Step=37700 Epoch=71.1] | Loss=0.00001 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.725 | L2-Norm(final)=5.084 | 4364.5 samples/s | 68.2 steps/s
[Step=37750 Epoch=71.2] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.721 | L2-Norm(final)=5.089 | 3975.6 samples/s | 62.1 steps/s
[Step=37800 Epoch=71.3] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.716 | L2-Norm(final)=5.094 | 4225.3 samples/s | 66.0 steps/s
[Step=37850 Epoch=71.3] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.711 | L2-Norm(final)=5.100 | 4291.5 samples/s | 67.1 steps/s
[Step=37900 Epoch=71.4] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.706 | L2-Norm(final)=5.105 | 4278.2 samples/s | 66.8 steps/s
[Step=37950 Epoch=71.5] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.702 | L2-Norm(final)=5.110 | 4118.0 samples/s | 64.3 steps/s
[Step=38000 Epoch=71.6] | Loss=0.00001 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.697 | L2-Norm(final)=5.116 | 4262.8 samples/s | 66.6 steps/s
[Step=38050 Epoch=71.7] | Loss=0.00001 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.694 | L2-Norm(final)=5.122 | 4173.1 samples/s | 65.2 steps/s
[Step=38100 Epoch=71.8] | Loss=0.00002 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.694 | L2-Norm(final)=5.129 | 4250.0 samples/s | 66.4 steps/s
[Step=38150 Epoch=71.9] | Loss=0.00002 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.695 | L2-Norm(final)=5.134 | 1991.6 samples/s | 31.1 steps/s
[Step=38200 Epoch=72.0] | Loss=0.00001 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.695 | L2-Norm(final)=5.140 | 4118.5 samples/s | 64.4 steps/s
[Step=38250 Epoch=72.1] | Loss=0.00001 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.696 | L2-Norm(final)=5.144 | 4099.3 samples/s | 64.1 steps/s
[Step=38300 Epoch=72.2] | Loss=0.00001 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.696 | L2-Norm(final)=5.148 | 4203.1 samples/s | 65.7 steps/s
[Step=38350 Epoch=72.3] | Loss=0.00001 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.696 | L2-Norm(final)=5.152 | 4224.0 samples/s | 66.0 steps/s
[Step=38400 Epoch=72.4] | Loss=0.00001 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.696 | L2-Norm(final)=5.155 | 4145.1 samples/s | 64.8 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step38400.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11825 | acc=0.9723 | tpr=0.9767 | fpr=0.0372 | 3988.3 samples/s | 15.6 steps/s
Avg test loss: 0.12442, Avg test acc: 0.97135, Avg tpr: 0.97639, Avg fpr: 0.03974, total FA: 310

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.27539 | acc=0.3145 | tpr=0.0024 | fpr=0.0077 | 4055.7 samples/s | 15.8 steps/s
Avg test loss: 5.29877, Avg test acc: 0.31168, Avg tpr: 0.00245, Avg fpr: 0.00820, total FA: 64

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=10.01853 | acc=0.1515 | tpr=0.9027 | fpr=0.8620 | 4084.0 samples/s | 16.0 steps/s
[Step= 100] | Loss=9.94989 | acc=0.1534 | tpr=0.8849 | fpr=0.8603 | 7261.8 samples/s | 28.4 steps/s
[Step= 150] | Loss=9.98582 | acc=0.1531 | tpr=0.8761 | fpr=0.8602 | 7335.6 samples/s | 28.7 steps/s
[Step= 200] | Loss=9.97019 | acc=0.1535 | tpr=0.8754 | fpr=0.8596 | 7284.9 samples/s | 28.5 steps/s
[Step= 250] | Loss=9.96687 | acc=0.1538 | tpr=0.8646 | fpr=0.8591 | 7498.9 samples/s | 29.3 steps/s
[Step= 300] | Loss=9.96910 | acc=0.1538 | tpr=0.8669 | fpr=0.8592 | 7833.0 samples/s | 30.6 steps/s
[Step= 350] | Loss=9.95682 | acc=0.1537 | tpr=0.8698 | fpr=0.8593 | 7440.6 samples/s | 29.1 steps/s
[Step= 400] | Loss=9.95919 | acc=0.1537 | tpr=0.8682 | fpr=0.8593 | 8092.2 samples/s | 31.6 steps/s
[Step= 450] | Loss=9.96719 | acc=0.1538 | tpr=0.8681 | fpr=0.8592 | 7269.3 samples/s | 28.4 steps/s
[Step= 500] | Loss=9.97378 | acc=0.1534 | tpr=0.8696 | fpr=0.8596 | 7740.5 samples/s | 30.2 steps/s
[Step= 550] | Loss=9.97436 | acc=0.1533 | tpr=0.8687 | fpr=0.8597 | 14765.5 samples/s | 57.7 steps/s
Avg test loss: 9.97682, Avg test acc: 0.15318, Avg tpr: 0.86846, Avg fpr: 0.85982, total FA: 119384

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12090 | acc=0.9802 | tpr=0.9779 | fpr=0.0197 | 4111.7 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.12588 | acc=0.9798 | tpr=0.9808 | fpr=0.0203 | 7774.9 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.13099 | acc=0.9790 | tpr=0.9827 | fpr=0.0211 | 7418.1 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.13239 | acc=0.9788 | tpr=0.9803 | fpr=0.0212 | 7927.8 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.13065 | acc=0.9788 | tpr=0.9782 | fpr=0.0212 | 7542.9 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.13302 | acc=0.9784 | tpr=0.9760 | fpr=0.0216 | 7780.0 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.13360 | acc=0.9782 | tpr=0.9756 | fpr=0.0218 | 7815.4 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.13505 | acc=0.9779 | tpr=0.9737 | fpr=0.0220 | 7475.1 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.13788 | acc=0.9775 | tpr=0.9727 | fpr=0.0224 | 7921.5 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.13743 | acc=0.9775 | tpr=0.9731 | fpr=0.0224 | 7666.6 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.13649 | acc=0.9778 | tpr=0.9729 | fpr=0.0221 | 13732.3 samples/s | 53.6 steps/s
Avg test loss: 0.13621, Avg test acc: 0.97777, Avg tpr: 0.97266, Avg fpr: 0.02214, total FA: 3074

server round 48/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00006, len=1
[Step=38401 Epoch=37.5] | Loss=0.00003 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.346 | L2-Norm(final)=2.706 | 4212.0 samples/s | 65.8 steps/s
[Step=38450 Epoch=37.5] | Loss=0.00222 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.344 | L2-Norm(final)=2.707 | 3738.1 samples/s | 58.4 steps/s
[Step=38500 Epoch=37.6] | Loss=0.00313 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.344 | L2-Norm(final)=2.707 | 4035.0 samples/s | 63.0 steps/s
[Step=38550 Epoch=37.6] | Loss=0.00287 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.343 | L2-Norm(final)=2.708 | 4085.9 samples/s | 63.8 steps/s
[Step=38600 Epoch=37.7] | Loss=0.00338 | Reg=0.00336 | acc=0.9844 | L2-Norm=18.342 | L2-Norm(final)=2.709 | 4341.1 samples/s | 67.8 steps/s
[Step=38650 Epoch=37.7] | Loss=0.00325 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.341 | L2-Norm(final)=2.709 | 4383.8 samples/s | 68.5 steps/s
[Step=38700 Epoch=37.8] | Loss=0.00347 | Reg=0.00336 | acc=0.9844 | L2-Norm=18.340 | L2-Norm(final)=2.710 | 4543.5 samples/s | 71.0 steps/s
[Step=38750 Epoch=37.8] | Loss=0.00350 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.339 | L2-Norm(final)=2.710 | 4381.1 samples/s | 68.5 steps/s
[Step=38800 Epoch=37.9] | Loss=0.00344 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.338 | L2-Norm(final)=2.710 | 4459.5 samples/s | 69.7 steps/s
[Step=38850 Epoch=37.9] | Loss=0.00342 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.337 | L2-Norm(final)=2.710 | 4368.0 samples/s | 68.2 steps/s
[Step=38900 Epoch=38.0] | Loss=0.00345 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.336 | L2-Norm(final)=2.711 | 4409.1 samples/s | 68.9 steps/s
[Step=38950 Epoch=38.0] | Loss=0.00345 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.335 | L2-Norm(final)=2.711 | 4454.5 samples/s | 69.6 steps/s
[Step=39000 Epoch=38.1] | Loss=0.00355 | Reg=0.00336 | acc=0.9844 | L2-Norm=18.334 | L2-Norm(final)=2.712 | 4473.3 samples/s | 69.9 steps/s
[Step=39050 Epoch=38.1] | Loss=0.00367 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.333 | L2-Norm(final)=2.712 | 4483.7 samples/s | 70.1 steps/s
[Step=39100 Epoch=38.2] | Loss=0.00363 | Reg=0.00336 | acc=0.9844 | L2-Norm=18.332 | L2-Norm(final)=2.713 | 4430.9 samples/s | 69.2 steps/s
[Step=39150 Epoch=38.2] | Loss=0.00374 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.331 | L2-Norm(final)=2.713 | 4233.4 samples/s | 66.1 steps/s
[Step=39200 Epoch=38.3] | Loss=0.00374 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.330 | L2-Norm(final)=2.713 | 4405.9 samples/s | 68.8 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step39200.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00006, len=1
[Step=38401 Epoch=72.4] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.693 | L2-Norm(final)=5.202 | 4912.2 samples/s | 76.8 steps/s
[Step=38450 Epoch=72.5] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.691 | L2-Norm(final)=5.202 | 3516.6 samples/s | 54.9 steps/s
[Step=38500 Epoch=72.6] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.690 | L2-Norm(final)=5.203 | 3943.4 samples/s | 61.6 steps/s
[Step=38550 Epoch=72.7] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.688 | L2-Norm(final)=5.203 | 4161.4 samples/s | 65.0 steps/s
[Step=38600 Epoch=72.8] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.687 | L2-Norm(final)=5.204 | 4226.1 samples/s | 66.0 steps/s
[Step=38650 Epoch=72.9] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.686 | L2-Norm(final)=5.205 | 4088.5 samples/s | 63.9 steps/s
[Step=38700 Epoch=73.0] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.684 | L2-Norm(final)=5.205 | 4225.1 samples/s | 66.0 steps/s
[Step=38750 Epoch=73.0] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.683 | L2-Norm(final)=5.206 | 4184.9 samples/s | 65.4 steps/s
[Step=38800 Epoch=73.1] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.682 | L2-Norm(final)=5.207 | 4149.9 samples/s | 64.8 steps/s
[Step=38850 Epoch=73.2] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.680 | L2-Norm(final)=5.207 | 4119.6 samples/s | 64.4 steps/s
[Step=38900 Epoch=73.3] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.679 | L2-Norm(final)=5.208 | 4128.5 samples/s | 64.5 steps/s
[Step=38950 Epoch=73.4] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.677 | L2-Norm(final)=5.208 | 1983.5 samples/s | 31.0 steps/s
[Step=39000 Epoch=73.5] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.675 | L2-Norm(final)=5.209 | 4125.1 samples/s | 64.5 steps/s
[Step=39050 Epoch=73.6] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.674 | L2-Norm(final)=5.209 | 4201.8 samples/s | 65.7 steps/s
[Step=39100 Epoch=73.7] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.672 | L2-Norm(final)=5.210 | 4087.2 samples/s | 63.9 steps/s
[Step=39150 Epoch=73.8] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.670 | L2-Norm(final)=5.211 | 4125.2 samples/s | 64.5 steps/s
[Step=39200 Epoch=73.9] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.669 | L2-Norm(final)=5.211 | 4104.7 samples/s | 64.1 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step39200.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11525 | acc=0.9724 | tpr=0.9763 | fpr=0.0359 | 3950.3 samples/s | 15.4 steps/s
Avg test loss: 0.12094, Avg test acc: 0.97107, Avg tpr: 0.97558, Avg fpr: 0.03884, total FA: 303

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.30419 | acc=0.3147 | tpr=0.0022 | fpr=0.0067 | 4063.1 samples/s | 15.9 steps/s
Avg test loss: 5.32737, Avg test acc: 0.31180, Avg tpr: 0.00216, Avg fpr: 0.00718, total FA: 56

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=9.51498 | acc=0.1550 | tpr=0.9027 | fpr=0.8584 | 4089.4 samples/s | 16.0 steps/s
[Step= 100] | Loss=9.44569 | acc=0.1566 | tpr=0.8849 | fpr=0.8570 | 8162.0 samples/s | 31.9 steps/s
[Step= 150] | Loss=9.47763 | acc=0.1566 | tpr=0.8732 | fpr=0.8566 | 7454.9 samples/s | 29.1 steps/s
[Step= 200] | Loss=9.46389 | acc=0.1571 | tpr=0.8710 | fpr=0.8559 | 7795.0 samples/s | 30.4 steps/s
[Step= 250] | Loss=9.46153 | acc=0.1576 | tpr=0.8594 | fpr=0.8552 | 7820.0 samples/s | 30.5 steps/s
[Step= 300] | Loss=9.46409 | acc=0.1575 | tpr=0.8625 | fpr=0.8554 | 7538.5 samples/s | 29.4 steps/s
[Step= 350] | Loss=9.45213 | acc=0.1574 | tpr=0.8641 | fpr=0.8554 | 8017.7 samples/s | 31.3 steps/s
[Step= 400] | Loss=9.45470 | acc=0.1573 | tpr=0.8611 | fpr=0.8555 | 7721.1 samples/s | 30.2 steps/s
[Step= 450] | Loss=9.46256 | acc=0.1573 | tpr=0.8612 | fpr=0.8554 | 7389.8 samples/s | 28.9 steps/s
[Step= 500] | Loss=9.46855 | acc=0.1569 | tpr=0.8630 | fpr=0.8559 | 7626.1 samples/s | 29.8 steps/s
[Step= 550] | Loss=9.46845 | acc=0.1567 | tpr=0.8623 | fpr=0.8561 | 13280.8 samples/s | 51.9 steps/s
Avg test loss: 9.47088, Avg test acc: 0.15666, Avg tpr: 0.86212, Avg fpr: 0.85616, total FA: 118876

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11319 | acc=0.9812 | tpr=0.9779 | fpr=0.0188 | 4243.4 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.11781 | acc=0.9807 | tpr=0.9808 | fpr=0.0193 | 7413.9 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.12256 | acc=0.9800 | tpr=0.9827 | fpr=0.0201 | 8361.3 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.12392 | acc=0.9798 | tpr=0.9803 | fpr=0.0202 | 7345.2 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.12228 | acc=0.9798 | tpr=0.9782 | fpr=0.0201 | 7319.6 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.12452 | acc=0.9794 | tpr=0.9760 | fpr=0.0205 | 7667.6 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.12505 | acc=0.9792 | tpr=0.9756 | fpr=0.0207 | 7151.2 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.12644 | acc=0.9790 | tpr=0.9737 | fpr=0.0210 | 7626.9 samples/s | 29.8 steps/s
[Step= 450] | Loss=0.12915 | acc=0.9785 | tpr=0.9727 | fpr=0.0214 | 7634.8 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.12871 | acc=0.9786 | tpr=0.9731 | fpr=0.0213 | 7034.3 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.12784 | acc=0.9788 | tpr=0.9729 | fpr=0.0211 | 13171.0 samples/s | 51.4 steps/s
Avg test loss: 0.12758, Avg test acc: 0.97877, Avg tpr: 0.97266, Avg fpr: 0.02112, total FA: 2932

server round 49/50

clients selected: [0 1]

Train client 0: client_asml1_0
Local layers training...
LR=0.00006, len=1
[Step=39201 Epoch=38.3] | Loss=0.00031 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.314 | L2-Norm(final)=2.719 | 4200.8 samples/s | 65.6 steps/s
[Step=39250 Epoch=38.3] | Loss=0.00302 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.313 | L2-Norm(final)=2.720 | 4312.2 samples/s | 67.4 steps/s
[Step=39300 Epoch=38.4] | Loss=0.00271 | Reg=0.00335 | acc=0.9844 | L2-Norm=18.312 | L2-Norm(final)=2.721 | 4423.8 samples/s | 69.1 steps/s
[Step=39350 Epoch=38.4] | Loss=0.00291 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.311 | L2-Norm(final)=2.721 | 4436.0 samples/s | 69.3 steps/s
[Step=39400 Epoch=38.5] | Loss=0.00309 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.310 | L2-Norm(final)=2.722 | 4424.2 samples/s | 69.1 steps/s
[Step=39450 Epoch=38.5] | Loss=0.00314 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.309 | L2-Norm(final)=2.723 | 4410.7 samples/s | 68.9 steps/s
[Step=39500 Epoch=38.6] | Loss=0.00339 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.308 | L2-Norm(final)=2.723 | 4388.8 samples/s | 68.6 steps/s
[Step=39550 Epoch=38.6] | Loss=0.00342 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.308 | L2-Norm(final)=2.724 | 4391.1 samples/s | 68.6 steps/s
[Step=39600 Epoch=38.7] | Loss=0.00355 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.307 | L2-Norm(final)=2.724 | 4355.1 samples/s | 68.0 steps/s
[Step=39650 Epoch=38.7] | Loss=0.00359 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.306 | L2-Norm(final)=2.725 | 4261.6 samples/s | 66.6 steps/s
[Step=39700 Epoch=38.8] | Loss=0.00356 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.305 | L2-Norm(final)=2.726 | 4302.7 samples/s | 67.2 steps/s
[Step=39750 Epoch=38.8] | Loss=0.00368 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.304 | L2-Norm(final)=2.726 | 4326.3 samples/s | 67.6 steps/s
[Step=39800 Epoch=38.9] | Loss=0.00360 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.303 | L2-Norm(final)=2.727 | 4262.3 samples/s | 66.6 steps/s
[Step=39850 Epoch=38.9] | Loss=0.00368 | Reg=0.00335 | acc=0.9844 | L2-Norm=18.302 | L2-Norm(final)=2.727 | 4369.0 samples/s | 68.3 steps/s
[Step=39900 Epoch=39.0] | Loss=0.00371 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.301 | L2-Norm(final)=2.728 | 4415.7 samples/s | 69.0 steps/s
[Step=39950 Epoch=39.0] | Loss=0.00365 | Reg=0.00335 | acc=0.9844 | L2-Norm=18.300 | L2-Norm(final)=2.728 | 4342.2 samples/s | 67.8 steps/s
[Step=40000 Epoch=39.1] | Loss=0.00358 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.299 | L2-Norm(final)=2.729 | 4348.5 samples/s | 67.9 steps/s
Client model saved at models/model-no_server-a1i1/client_asml1_0/client_state-step40000.h5

Train client 1: client_iccad2012_0
Local layers training...
LR=0.00006, len=1
[Step=39201 Epoch=73.9] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.641 | L2-Norm(final)=5.220 | 4050.8 samples/s | 63.3 steps/s
[Step=39250 Epoch=74.0] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.639 | L2-Norm(final)=5.221 | 3613.1 samples/s | 56.5 steps/s
[Step=39300 Epoch=74.1] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.637 | L2-Norm(final)=5.222 | 4052.1 samples/s | 63.3 steps/s
[Step=39350 Epoch=74.2] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.635 | L2-Norm(final)=5.223 | 4069.9 samples/s | 63.6 steps/s
[Step=39400 Epoch=74.3] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.633 | L2-Norm(final)=5.223 | 4159.3 samples/s | 65.0 steps/s
[Step=39450 Epoch=74.4] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.632 | L2-Norm(final)=5.224 | 4030.7 samples/s | 63.0 steps/s
[Step=39500 Epoch=74.5] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.630 | L2-Norm(final)=5.225 | 4114.7 samples/s | 64.3 steps/s
[Step=39550 Epoch=74.6] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.628 | L2-Norm(final)=5.226 | 4063.1 samples/s | 63.5 steps/s
[Step=39600 Epoch=74.6] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.626 | L2-Norm(final)=5.227 | 4210.2 samples/s | 65.8 steps/s
[Step=39650 Epoch=74.7] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.624 | L2-Norm(final)=5.228 | 4376.2 samples/s | 68.4 steps/s
[Step=39700 Epoch=74.8] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.622 | L2-Norm(final)=5.229 | 4398.4 samples/s | 68.7 steps/s
[Step=39750 Epoch=74.9] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.620 | L2-Norm(final)=5.230 | 2116.3 samples/s | 33.1 steps/s
[Step=39800 Epoch=75.0] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.618 | L2-Norm(final)=5.231 | 4267.2 samples/s | 66.7 steps/s
[Step=39850 Epoch=75.1] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.616 | L2-Norm(final)=5.232 | 4304.1 samples/s | 67.3 steps/s
[Step=39900 Epoch=75.2] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.614 | L2-Norm(final)=5.233 | 4429.0 samples/s | 69.2 steps/s
[Step=39950 Epoch=75.3] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.612 | L2-Norm(final)=5.234 | 4280.7 samples/s | 66.9 steps/s
[Step=40000 Epoch=75.4] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.609 | L2-Norm(final)=5.235 | 4263.4 samples/s | 66.6 steps/s
Client model saved at models/model-no_server-a1i1/client_iccad2012_0/client_state-step40000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11786 | acc=0.9723 | tpr=0.9763 | fpr=0.0364 | 4192.0 samples/s | 16.4 steps/s
Avg test loss: 0.12417, Avg test acc: 0.97091, Avg tpr: 0.97564, Avg fpr: 0.03948, total FA: 308

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.22070 | acc=0.3147 | tpr=0.0024 | fpr=0.0072 | 4213.7 samples/s | 16.5 steps/s
Avg test loss: 5.24357, Avg test acc: 0.31176, Avg tpr: 0.00227, Avg fpr: 0.00756, total FA: 59

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=9.91845 | acc=0.1523 | tpr=0.9071 | fpr=0.8612 | 4150.4 samples/s | 16.2 steps/s
[Step= 100] | Loss=9.84674 | acc=0.1544 | tpr=0.8891 | fpr=0.8593 | 7676.1 samples/s | 30.0 steps/s
[Step= 150] | Loss=9.88060 | acc=0.1539 | tpr=0.8804 | fpr=0.8595 | 7546.2 samples/s | 29.5 steps/s
[Step= 200] | Loss=9.86538 | acc=0.1543 | tpr=0.8787 | fpr=0.8589 | 8428.9 samples/s | 32.9 steps/s
[Step= 250] | Loss=9.86262 | acc=0.1547 | tpr=0.8672 | fpr=0.8582 | 7635.0 samples/s | 29.8 steps/s
[Step= 300] | Loss=9.86453 | acc=0.1546 | tpr=0.8698 | fpr=0.8585 | 7439.5 samples/s | 29.1 steps/s
[Step= 350] | Loss=9.85255 | acc=0.1547 | tpr=0.8716 | fpr=0.8584 | 7592.1 samples/s | 29.7 steps/s
[Step= 400] | Loss=9.85500 | acc=0.1546 | tpr=0.8693 | fpr=0.8584 | 7794.2 samples/s | 30.4 steps/s
[Step= 450] | Loss=9.86312 | acc=0.1546 | tpr=0.8700 | fpr=0.8584 | 7480.0 samples/s | 29.2 steps/s
[Step= 500] | Loss=9.86912 | acc=0.1542 | tpr=0.8709 | fpr=0.8588 | 7398.2 samples/s | 28.9 steps/s
[Step= 550] | Loss=9.86930 | acc=0.1540 | tpr=0.8699 | fpr=0.8590 | 13109.1 samples/s | 51.2 steps/s
Avg test loss: 9.87184, Avg test acc: 0.15395, Avg tpr: 0.86965, Avg fpr: 0.85906, total FA: 119279

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11198 | acc=0.9806 | tpr=0.9779 | fpr=0.0193 | 4082.3 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.11647 | acc=0.9803 | tpr=0.9808 | fpr=0.0197 | 7268.4 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.12113 | acc=0.9796 | tpr=0.9827 | fpr=0.0205 | 7305.8 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.12246 | acc=0.9795 | tpr=0.9803 | fpr=0.0206 | 7443.2 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.12093 | acc=0.9794 | tpr=0.9782 | fpr=0.0205 | 7201.5 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.12315 | acc=0.9791 | tpr=0.9760 | fpr=0.0208 | 7478.3 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.12364 | acc=0.9789 | tpr=0.9756 | fpr=0.0210 | 7333.1 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.12503 | acc=0.9787 | tpr=0.9743 | fpr=0.0212 | 7256.4 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.12769 | acc=0.9782 | tpr=0.9732 | fpr=0.0217 | 7314.6 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.12724 | acc=0.9783 | tpr=0.9736 | fpr=0.0216 | 7271.8 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.12637 | acc=0.9785 | tpr=0.9733 | fpr=0.0214 | 13672.1 samples/s | 53.4 steps/s
Avg test loss: 0.12612, Avg test acc: 0.97847, Avg tpr: 0.97306, Avg fpr: 0.02143, total FA: 2976
