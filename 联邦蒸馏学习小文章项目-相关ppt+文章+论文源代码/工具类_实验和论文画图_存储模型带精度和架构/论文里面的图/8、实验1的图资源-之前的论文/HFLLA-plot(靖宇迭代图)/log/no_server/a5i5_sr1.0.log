#clients of iccad2012: 5
#clients of asml1: 5
select ratio: 1.0
Total num clients: 10
client model path: ['models/model-a5i5_sr1.0/client_asml1_0', 'models/model-a5i5_sr1.0/client_asml1_1', 'models/model-a5i5_sr1.0/client_asml1_2', 'models/model-a5i5_sr1.0/client_asml1_3', 'models/model-a5i5_sr1.0/client_asml1_4', 'models/model-a5i5_sr1.0/client_iccad2012_0', 'models/model-a5i5_sr1.0/client_iccad2012_1', 'models/model-a5i5_sr1.0/client_iccad2012_2', 'models/model-a5i5_sr1.0/client_iccad2012_3', 'models/model-a5i5_sr1.0/client_iccad2012_4']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13125, 144, 32)
Using transform option: train
#pos = 6841, #neg = 6284
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13116, 144, 32)
Using transform option: train
#pos = 6850, #neg = 6266
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13135, 144, 32)
Using transform option: train
#pos = 6831, #neg = 6304
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13124, 144, 32)
Using transform option: train
#pos = 6842, #neg = 6282
Allocated dataset with size (9984, 144, 32)
Resampled dataset to size (13051, 144, 32)
Using transform option: train
#pos = 6917, #neg = 6134
loading data into the main memory...
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6754, 144, 32)
Using transform option: train
#pos = 3332, #neg = 3422
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6728, 144, 32)
Using transform option: train
#pos = 3304, #neg = 3424
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6702, 144, 32)
Using transform option: train
#pos = 3276, #neg = 3426
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6792, 144, 32)
Using transform option: train
#pos = 3393, #neg = 3399
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6715, 144, 32)
Using transform option: train
#pos = 3290, #neg = 3425
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/10

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.40004 | Reg=0.00358 | acc=0.4375 | L2-Norm=18.929 | L2-Norm(final)=2.038 | 3037.6 samples/s | 47.5 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.29964 | Reg=0.00347 | acc=0.7500 | L2-Norm=18.626 | L2-Norm(final)=2.028 | 4750.3 samples/s | 74.2 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.25434 | Reg=0.00342 | acc=0.9062 | L2-Norm=18.504 | L2-Norm(final)=2.039 | 4743.1 samples/s | 74.1 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.22366 | Reg=0.00339 | acc=0.8594 | L2-Norm=18.425 | L2-Norm(final)=2.049 | 4800.1 samples/s | 75.0 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.20101 | Reg=0.00337 | acc=0.9375 | L2-Norm=18.363 | L2-Norm(final)=2.057 | 6333.6 samples/s | 99.0 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.18449 | Reg=0.00336 | acc=0.9062 | L2-Norm=18.317 | L2-Norm(final)=2.064 | 2039.8 samples/s | 31.9 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.17020 | Reg=0.00334 | acc=0.8594 | L2-Norm=18.284 | L2-Norm(final)=2.073 | 4662.7 samples/s | 72.9 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.15973 | Reg=0.00333 | acc=0.9844 | L2-Norm=18.259 | L2-Norm(final)=2.081 | 4560.4 samples/s | 71.3 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.15037 | Reg=0.00333 | acc=0.8438 | L2-Norm=18.237 | L2-Norm(final)=2.090 | 5839.8 samples/s | 91.2 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14152 | Reg=0.00332 | acc=0.9062 | L2-Norm=18.218 | L2-Norm(final)=2.098 | 2050.7 samples/s | 32.0 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13242 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.203 | L2-Norm(final)=2.107 | 4662.5 samples/s | 72.9 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_0/client_state-step500.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.40532 | Reg=0.00358 | acc=0.4531 | L2-Norm=18.929 | L2-Norm(final)=2.038 | 4532.5 samples/s | 70.8 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.29291 | Reg=0.00346 | acc=0.6719 | L2-Norm=18.603 | L2-Norm(final)=2.034 | 4431.1 samples/s | 69.2 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.24992 | Reg=0.00341 | acc=0.8281 | L2-Norm=18.457 | L2-Norm(final)=2.045 | 4629.1 samples/s | 72.3 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.22070 | Reg=0.00338 | acc=0.8281 | L2-Norm=18.371 | L2-Norm(final)=2.054 | 4383.6 samples/s | 68.5 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.20198 | Reg=0.00335 | acc=0.9219 | L2-Norm=18.311 | L2-Norm(final)=2.062 | 6210.3 samples/s | 97.0 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.18327 | Reg=0.00334 | acc=0.9062 | L2-Norm=18.267 | L2-Norm(final)=2.071 | 2045.2 samples/s | 32.0 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.16764 | Reg=0.00333 | acc=0.9688 | L2-Norm=18.236 | L2-Norm(final)=2.081 | 4620.4 samples/s | 72.2 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.15602 | Reg=0.00332 | acc=0.9531 | L2-Norm=18.212 | L2-Norm(final)=2.091 | 4609.9 samples/s | 72.0 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.14763 | Reg=0.00331 | acc=0.9062 | L2-Norm=18.193 | L2-Norm(final)=2.100 | 5740.8 samples/s | 89.7 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.13825 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.180 | L2-Norm(final)=2.109 | 2019.0 samples/s | 31.5 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13065 | Reg=0.00330 | acc=0.9531 | L2-Norm=18.171 | L2-Norm(final)=2.117 | 4584.7 samples/s | 71.6 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_1/client_state-step500.h5

Train client 2: client_asml1_2
Local layers training...
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34282 | Reg=0.00358 | acc=0.5938 | L2-Norm=18.929 | L2-Norm(final)=2.039 | 4729.0 samples/s | 73.9 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.29291 | Reg=0.00346 | acc=0.8594 | L2-Norm=18.612 | L2-Norm(final)=2.031 | 4315.1 samples/s | 67.4 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.25447 | Reg=0.00342 | acc=0.8438 | L2-Norm=18.505 | L2-Norm(final)=2.041 | 4480.8 samples/s | 70.0 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.22878 | Reg=0.00340 | acc=0.9219 | L2-Norm=18.439 | L2-Norm(final)=2.050 | 4392.7 samples/s | 68.6 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.20753 | Reg=0.00338 | acc=0.8906 | L2-Norm=18.391 | L2-Norm(final)=2.059 | 6074.0 samples/s | 94.9 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.19051 | Reg=0.00337 | acc=0.9219 | L2-Norm=18.355 | L2-Norm(final)=2.067 | 1979.9 samples/s | 30.9 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.17711 | Reg=0.00336 | acc=0.9688 | L2-Norm=18.332 | L2-Norm(final)=2.076 | 4370.6 samples/s | 68.3 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.16582 | Reg=0.00335 | acc=0.8281 | L2-Norm=18.314 | L2-Norm(final)=2.086 | 4681.9 samples/s | 73.2 steps/s
[Step= 400 Epoch= 1.9] | Loss=0.15684 | Reg=0.00335 | acc=0.9531 | L2-Norm=18.299 | L2-Norm(final)=2.094 | 5540.3 samples/s | 86.6 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14677 | Reg=0.00334 | acc=0.9844 | L2-Norm=18.289 | L2-Norm(final)=2.101 | 2021.8 samples/s | 31.6 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13767 | Reg=0.00334 | acc=0.9531 | L2-Norm=18.281 | L2-Norm(final)=2.110 | 4612.3 samples/s | 72.1 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_2/client_state-step500.h5

Train client 3: client_asml1_3
Local layers training...
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.39345 | Reg=0.00358 | acc=0.3906 | L2-Norm=18.929 | L2-Norm(final)=2.038 | 4732.4 samples/s | 73.9 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.30994 | Reg=0.00347 | acc=0.7812 | L2-Norm=18.640 | L2-Norm(final)=2.027 | 4464.6 samples/s | 69.8 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.26984 | Reg=0.00343 | acc=0.8594 | L2-Norm=18.530 | L2-Norm(final)=2.037 | 4610.0 samples/s | 72.0 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.23746 | Reg=0.00341 | acc=0.8750 | L2-Norm=18.464 | L2-Norm(final)=2.050 | 4708.7 samples/s | 73.6 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.21296 | Reg=0.00339 | acc=0.8906 | L2-Norm=18.415 | L2-Norm(final)=2.062 | 6321.1 samples/s | 98.8 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.19420 | Reg=0.00338 | acc=0.9062 | L2-Norm=18.383 | L2-Norm(final)=2.074 | 2014.9 samples/s | 31.5 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.17860 | Reg=0.00337 | acc=0.8906 | L2-Norm=18.358 | L2-Norm(final)=2.084 | 4677.6 samples/s | 73.1 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.16678 | Reg=0.00336 | acc=0.9219 | L2-Norm=18.335 | L2-Norm(final)=2.093 | 4703.0 samples/s | 73.5 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.15634 | Reg=0.00335 | acc=0.9531 | L2-Norm=18.312 | L2-Norm(final)=2.101 | 5659.2 samples/s | 88.4 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14592 | Reg=0.00335 | acc=0.9688 | L2-Norm=18.291 | L2-Norm(final)=2.110 | 2045.4 samples/s | 32.0 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13638 | Reg=0.00334 | acc=0.9688 | L2-Norm=18.273 | L2-Norm(final)=2.119 | 4662.7 samples/s | 72.9 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_3/client_state-step500.h5

Train client 4: client_asml1_4
Local layers training...
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.37347 | Reg=0.00358 | acc=0.5156 | L2-Norm=18.929 | L2-Norm(final)=2.038 | 4319.0 samples/s | 67.5 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.28465 | Reg=0.00348 | acc=0.6875 | L2-Norm=18.645 | L2-Norm(final)=2.040 | 4659.8 samples/s | 72.8 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.24617 | Reg=0.00343 | acc=0.8438 | L2-Norm=18.524 | L2-Norm(final)=2.050 | 4775.1 samples/s | 74.6 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.21911 | Reg=0.00340 | acc=0.8281 | L2-Norm=18.446 | L2-Norm(final)=2.058 | 4785.3 samples/s | 74.8 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.20241 | Reg=0.00338 | acc=0.9531 | L2-Norm=18.387 | L2-Norm(final)=2.066 | 5957.8 samples/s | 93.1 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.18226 | Reg=0.00336 | acc=0.9062 | L2-Norm=18.342 | L2-Norm(final)=2.073 | 1959.6 samples/s | 30.6 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.16676 | Reg=0.00335 | acc=0.9219 | L2-Norm=18.307 | L2-Norm(final)=2.083 | 4606.4 samples/s | 72.0 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.15617 | Reg=0.00334 | acc=0.9062 | L2-Norm=18.277 | L2-Norm(final)=2.091 | 4679.9 samples/s | 73.1 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.14847 | Reg=0.00333 | acc=0.9688 | L2-Norm=18.253 | L2-Norm(final)=2.097 | 6025.9 samples/s | 94.2 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.13812 | Reg=0.00332 | acc=0.9688 | L2-Norm=18.232 | L2-Norm(final)=2.104 | 2029.2 samples/s | 31.7 steps/s
[Step= 500 Epoch= 2.5] | Loss=0.13051 | Reg=0.00332 | acc=0.8906 | L2-Norm=18.216 | L2-Norm(final)=2.111 | 4561.1 samples/s | 71.3 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_4/client_state-step500.h5

Train client 5: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.30390 | Reg=0.00358 | acc=0.6094 | L2-Norm=18.929 | L2-Norm(final)=2.039 | 4162.2 samples/s | 65.0 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.15273 | Reg=0.00350 | acc=0.9844 | L2-Norm=18.718 | L2-Norm(final)=2.048 | 4331.8 samples/s | 67.7 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.09498 | Reg=0.00347 | acc=0.9844 | L2-Norm=18.631 | L2-Norm(final)=2.062 | 6246.7 samples/s | 97.6 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.06615 | Reg=0.00344 | acc=0.9844 | L2-Norm=18.555 | L2-Norm(final)=2.074 | 1929.6 samples/s | 30.2 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.05034 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.483 | L2-Norm(final)=2.082 | 5545.1 samples/s | 86.6 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.04040 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.413 | L2-Norm(final)=2.089 | 1950.3 samples/s | 30.5 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.03380 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.345 | L2-Norm(final)=2.095 | 5115.7 samples/s | 79.9 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02900 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.279 | L2-Norm(final)=2.101 | 1991.2 samples/s | 31.1 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02539 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.213 | L2-Norm(final)=2.105 | 4853.7 samples/s | 75.8 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.02257 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.148 | L2-Norm(final)=2.109 | 2118.4 samples/s | 33.1 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.02032 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.083 | L2-Norm(final)=2.113 | 4637.8 samples/s | 72.5 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_0/client_state-step500.h5

Train client 6: client_iccad2012_1
Local layers training...
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.32409 | Reg=0.00358 | acc=0.5156 | L2-Norm=18.929 | L2-Norm(final)=2.039 | 4178.5 samples/s | 65.3 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.11171 | Reg=0.00348 | acc=0.9844 | L2-Norm=18.655 | L2-Norm(final)=2.061 | 4631.3 samples/s | 72.4 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.06569 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.516 | L2-Norm(final)=2.075 | 6309.4 samples/s | 98.6 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.04540 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.416 | L2-Norm(final)=2.088 | 1857.5 samples/s | 29.0 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.03444 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.329 | L2-Norm(final)=2.098 | 5501.6 samples/s | 86.0 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.03027 | Reg=0.00333 | acc=0.9844 | L2-Norm=18.252 | L2-Norm(final)=2.105 | 2001.7 samples/s | 31.3 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.02572 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.196 | L2-Norm(final)=2.110 | 5108.9 samples/s | 79.8 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02212 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.141 | L2-Norm(final)=2.115 | 2021.5 samples/s | 31.6 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.01937 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.085 | L2-Norm(final)=2.119 | 4870.0 samples/s | 76.1 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.01722 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.027 | L2-Norm(final)=2.123 | 2062.6 samples/s | 32.2 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.01551 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.969 | L2-Norm(final)=2.126 | 4642.3 samples/s | 72.5 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_1/client_state-step500.h5

Train client 7: client_iccad2012_2
Local layers training...
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35972 | Reg=0.00358 | acc=0.5000 | L2-Norm=18.929 | L2-Norm(final)=2.037 | 4430.0 samples/s | 69.2 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.11639 | Reg=0.00350 | acc=0.9688 | L2-Norm=18.706 | L2-Norm(final)=2.052 | 4018.6 samples/s | 62.8 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.07151 | Reg=0.00345 | acc=0.9844 | L2-Norm=18.568 | L2-Norm(final)=2.063 | 5937.3 samples/s | 92.8 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.04957 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.454 | L2-Norm(final)=2.070 | 1878.3 samples/s | 29.3 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.03766 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.353 | L2-Norm(final)=2.077 | 5535.8 samples/s | 86.5 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.03026 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.261 | L2-Norm(final)=2.083 | 2007.7 samples/s | 31.4 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.02527 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.173 | L2-Norm(final)=2.088 | 5228.6 samples/s | 81.7 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02169 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.089 | L2-Norm(final)=2.093 | 1982.7 samples/s | 31.0 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.01899 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.008 | L2-Norm(final)=2.096 | 5094.5 samples/s | 79.6 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.01689 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.930 | L2-Norm(final)=2.099 | 2067.0 samples/s | 32.3 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.01520 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.853 | L2-Norm(final)=2.102 | 4475.2 samples/s | 69.9 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_2/client_state-step500.h5

Train client 8: client_iccad2012_3
Local layers training...
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.30139 | Reg=0.00358 | acc=0.5781 | L2-Norm=18.929 | L2-Norm(final)=2.040 | 4208.6 samples/s | 65.8 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.12041 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.689 | L2-Norm(final)=2.060 | 4366.5 samples/s | 68.2 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.06959 | Reg=0.00345 | acc=0.9844 | L2-Norm=18.583 | L2-Norm(final)=2.082 | 5904.7 samples/s | 92.3 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.05780 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.503 | L2-Norm(final)=2.092 | 1931.6 samples/s | 30.2 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.04423 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.439 | L2-Norm(final)=2.098 | 5482.4 samples/s | 85.7 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.03553 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.376 | L2-Norm(final)=2.105 | 2006.6 samples/s | 31.4 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.02967 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.312 | L2-Norm(final)=2.110 | 4840.0 samples/s | 75.6 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02545 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.248 | L2-Norm(final)=2.115 | 2019.3 samples/s | 31.6 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02229 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.185 | L2-Norm(final)=2.119 | 4531.3 samples/s | 70.8 steps/s
[Step= 450 Epoch= 4.2] | Loss=0.01982 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.123 | L2-Norm(final)=2.123 | 2037.1 samples/s | 31.8 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.01785 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.061 | L2-Norm(final)=2.126 | 4145.2 samples/s | 64.8 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_3/client_state-step500.h5

Train client 9: client_iccad2012_4
Local layers training...
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34468 | Reg=0.00358 | acc=0.4688 | L2-Norm=18.929 | L2-Norm(final)=2.038 | 4612.5 samples/s | 72.1 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.13487 | Reg=0.00349 | acc=0.9844 | L2-Norm=18.677 | L2-Norm(final)=2.052 | 4174.0 samples/s | 65.2 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.08089 | Reg=0.00344 | acc=0.9531 | L2-Norm=18.555 | L2-Norm(final)=2.067 | 6080.0 samples/s | 95.0 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.05851 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.463 | L2-Norm(final)=2.075 | 1905.0 samples/s | 29.8 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.04471 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.382 | L2-Norm(final)=2.081 | 5832.6 samples/s | 91.1 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.03615 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.306 | L2-Norm(final)=2.087 | 1978.3 samples/s | 30.9 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.03020 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.233 | L2-Norm(final)=2.091 | 5170.6 samples/s | 80.8 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02593 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.163 | L2-Norm(final)=2.095 | 1935.0 samples/s | 30.2 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02270 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.093 | L2-Norm(final)=2.099 | 4923.5 samples/s | 76.9 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.02019 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.024 | L2-Norm(final)=2.102 | 2000.1 samples/s | 31.3 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.01818 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.956 | L2-Norm(final)=2.104 | 4792.9 samples/s | 74.9 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_4/client_state-step500.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11354 | acc=0.9213 | tpr=0.9620 | fpr=0.1672 | 4343.5 samples/s | 17.0 steps/s
Avg test loss: 0.11603, Avg test acc: 0.91806, Avg tpr: 0.95897, Avg fpr: 0.17190, total FA: 1341

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10973 | acc=0.9176 | tpr=0.9306 | fpr=0.1108 | 4409.6 samples/s | 17.2 steps/s
Avg test loss: 0.11384, Avg test acc: 0.91542, Avg tpr: 0.92808, Avg fpr: 0.11242, total FA: 877

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.12039 | acc=0.9178 | tpr=0.9319 | fpr=0.1127 | 4245.7 samples/s | 16.6 steps/s
Avg test loss: 0.12263, Avg test acc: 0.91650, Avg tpr: 0.93076, Avg fpr: 0.11486, total FA: 896

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.12760 | acc=0.9143 | tpr=0.9633 | fpr=0.1920 | 4294.2 samples/s | 16.8 steps/s
Avg test loss: 0.12880, Avg test acc: 0.91370, Avg tpr: 0.96287, Avg fpr: 0.19446, total FA: 1517

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.11916 | acc=0.9085 | tpr=0.9042 | fpr=0.0820 | 4191.0 samples/s | 16.4 steps/s
Avg test loss: 0.12299, Avg test acc: 0.90604, Avg tpr: 0.90138, Avg fpr: 0.08371, total FA: 653

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.93604 | acc=0.3155 | tpr=0.0073 | fpr=0.0151 | 4321.0 samples/s | 16.9 steps/s
Avg test loss: 4.95864, Avg test acc: 0.31337, Avg tpr: 0.00764, Avg fpr: 0.01423, total FA: 111

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=3.92618 | acc=0.3123 | tpr=0.0169 | fpr=0.0463 | 4440.3 samples/s | 17.3 steps/s
Avg test loss: 3.94119, Avg test acc: 0.30992, Avg tpr: 0.01597, Avg fpr: 0.04358, total FA: 340

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.32562 | acc=0.3151 | tpr=0.0250 | fpr=0.0550 | 4227.7 samples/s | 16.5 steps/s
Avg test loss: 4.34709, Avg test acc: 0.31248, Avg tpr: 0.02524, Avg fpr: 0.05576, total FA: 435

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.36408 | acc=0.3140 | tpr=0.0193 | fpr=0.0461 | 4401.3 samples/s | 17.2 steps/s
Avg test loss: 4.37933, Avg test acc: 0.31293, Avg tpr: 0.02116, Avg fpr: 0.04538, total FA: 354

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.69673 | acc=0.3139 | tpr=0.0089 | fpr=0.0238 | 4268.0 samples/s | 16.7 steps/s
Avg test loss: 4.70701, Avg test acc: 0.31196, Avg tpr: 0.00927, Avg fpr: 0.02230, total FA: 174

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=2.08212 | acc=0.1194 | tpr=0.9027 | fpr=0.8947 | 4290.9 samples/s | 16.8 steps/s
[Step= 100] | Loss=2.07873 | acc=0.1238 | tpr=0.9147 | fpr=0.8910 | 8218.1 samples/s | 32.1 steps/s
[Step= 150] | Loss=2.08530 | acc=0.1229 | tpr=0.9121 | fpr=0.8917 | 8166.1 samples/s | 31.9 steps/s
[Step= 200] | Loss=2.07994 | acc=0.1235 | tpr=0.9082 | fpr=0.8908 | 7920.0 samples/s | 30.9 steps/s
[Step= 250] | Loss=2.08176 | acc=0.1238 | tpr=0.9083 | fpr=0.8905 | 8032.1 samples/s | 31.4 steps/s
[Step= 300] | Loss=2.08333 | acc=0.1236 | tpr=0.9069 | fpr=0.8906 | 7887.1 samples/s | 30.8 steps/s
[Step= 350] | Loss=2.08389 | acc=0.1233 | tpr=0.9117 | fpr=0.8910 | 8264.6 samples/s | 32.3 steps/s
[Step= 400] | Loss=2.08353 | acc=0.1234 | tpr=0.9114 | fpr=0.8909 | 8190.3 samples/s | 32.0 steps/s
[Step= 450] | Loss=2.08325 | acc=0.1239 | tpr=0.9124 | fpr=0.8905 | 8156.7 samples/s | 31.9 steps/s
[Step= 500] | Loss=2.08471 | acc=0.1236 | tpr=0.9137 | fpr=0.8906 | 7856.1 samples/s | 30.7 steps/s
[Step= 550] | Loss=2.08427 | acc=0.1237 | tpr=0.9140 | fpr=0.8907 | 14625.4 samples/s | 57.1 steps/s
Avg test loss: 2.08480, Avg test acc: 0.12358, Avg tpr: 0.91403, Avg fpr: 0.89079, total FA: 123684

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=1.98799 | acc=0.1181 | tpr=0.8451 | fpr=0.8949 | 4415.1 samples/s | 17.2 steps/s
[Step= 100] | Loss=1.97372 | acc=0.1180 | tpr=0.8443 | fpr=0.8956 | 8255.0 samples/s | 32.2 steps/s
[Step= 150] | Loss=1.98398 | acc=0.1166 | tpr=0.8343 | fpr=0.8966 | 8397.4 samples/s | 32.8 steps/s
[Step= 200] | Loss=1.98242 | acc=0.1167 | tpr=0.8328 | fpr=0.8963 | 8178.7 samples/s | 31.9 steps/s
[Step= 250] | Loss=1.98569 | acc=0.1164 | tpr=0.8297 | fpr=0.8966 | 8105.9 samples/s | 31.7 steps/s
[Step= 300] | Loss=1.98474 | acc=0.1155 | tpr=0.8262 | fpr=0.8974 | 8085.0 samples/s | 31.6 steps/s
[Step= 350] | Loss=1.98307 | acc=0.1155 | tpr=0.8272 | fpr=0.8974 | 8348.6 samples/s | 32.6 steps/s
[Step= 400] | Loss=1.98286 | acc=0.1159 | tpr=0.8293 | fpr=0.8971 | 8375.2 samples/s | 32.7 steps/s
[Step= 450] | Loss=1.98266 | acc=0.1157 | tpr=0.8272 | fpr=0.8972 | 8108.2 samples/s | 31.7 steps/s
[Step= 500] | Loss=1.98392 | acc=0.1153 | tpr=0.8278 | fpr=0.8976 | 8184.0 samples/s | 32.0 steps/s
[Step= 550] | Loss=1.98273 | acc=0.1155 | tpr=0.8277 | fpr=0.8974 | 14030.4 samples/s | 54.8 steps/s
Avg test loss: 1.98294, Avg test acc: 0.11538, Avg tpr: 0.82765, Avg fpr: 0.89756, total FA: 124625

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=2.22727 | acc=0.1352 | tpr=0.8496 | fpr=0.8777 | 4387.5 samples/s | 17.1 steps/s
[Step= 100] | Loss=2.21428 | acc=0.1382 | tpr=0.8188 | fpr=0.8745 | 8395.6 samples/s | 32.8 steps/s
[Step= 150] | Loss=2.21521 | acc=0.1375 | tpr=0.8285 | fpr=0.8752 | 8298.0 samples/s | 32.4 steps/s
[Step= 200] | Loss=2.20801 | acc=0.1383 | tpr=0.8240 | fpr=0.8742 | 8115.1 samples/s | 31.7 steps/s
[Step= 250] | Loss=2.21046 | acc=0.1383 | tpr=0.8288 | fpr=0.8743 | 8259.0 samples/s | 32.3 steps/s
[Step= 300] | Loss=2.21283 | acc=0.1376 | tpr=0.8262 | fpr=0.8749 | 8256.7 samples/s | 32.3 steps/s
[Step= 350] | Loss=2.21412 | acc=0.1370 | tpr=0.8259 | fpr=0.8755 | 8148.0 samples/s | 31.8 steps/s
[Step= 400] | Loss=2.21583 | acc=0.1373 | tpr=0.8266 | fpr=0.8752 | 7957.7 samples/s | 31.1 steps/s
[Step= 450] | Loss=2.21767 | acc=0.1366 | tpr=0.8272 | fpr=0.8759 | 8082.8 samples/s | 31.6 steps/s
[Step= 500] | Loss=2.21924 | acc=0.1362 | tpr=0.8304 | fpr=0.8763 | 8421.6 samples/s | 32.9 steps/s
[Step= 550] | Loss=2.21857 | acc=0.1364 | tpr=0.8313 | fpr=0.8763 | 15088.3 samples/s | 58.9 steps/s
Avg test loss: 2.21896, Avg test acc: 0.13625, Avg tpr: 0.83082, Avg fpr: 0.87638, total FA: 121683

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=2.30574 | acc=0.1115 | tpr=0.8717 | fpr=0.9022 | 4396.4 samples/s | 17.2 steps/s
[Step= 100] | Loss=2.30402 | acc=0.1135 | tpr=0.8678 | fpr=0.9006 | 7933.6 samples/s | 31.0 steps/s
[Step= 150] | Loss=2.30504 | acc=0.1127 | tpr=0.8588 | fpr=0.9011 | 8053.0 samples/s | 31.5 steps/s
[Step= 200] | Loss=2.29853 | acc=0.1134 | tpr=0.8492 | fpr=0.9000 | 8326.5 samples/s | 32.5 steps/s
[Step= 250] | Loss=2.30234 | acc=0.1136 | tpr=0.8541 | fpr=0.8999 | 8490.1 samples/s | 33.2 steps/s
[Step= 300] | Loss=2.30070 | acc=0.1133 | tpr=0.8567 | fpr=0.9003 | 8017.6 samples/s | 31.3 steps/s
[Step= 350] | Loss=2.30114 | acc=0.1126 | tpr=0.8604 | fpr=0.9010 | 7672.7 samples/s | 30.0 steps/s
[Step= 400] | Loss=2.30040 | acc=0.1127 | tpr=0.8654 | fpr=0.9010 | 7465.2 samples/s | 29.2 steps/s
[Step= 450] | Loss=2.30057 | acc=0.1122 | tpr=0.8666 | fpr=0.9015 | 8102.2 samples/s | 31.6 steps/s
[Step= 500] | Loss=2.30255 | acc=0.1121 | tpr=0.8709 | fpr=0.9016 | 8116.2 samples/s | 31.7 steps/s
[Step= 550] | Loss=2.30387 | acc=0.1122 | tpr=0.8715 | fpr=0.9016 | 14668.3 samples/s | 57.3 steps/s
Avg test loss: 2.30424, Avg test acc: 0.11208, Avg tpr: 0.87203, Avg fpr: 0.90173, total FA: 125204

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=1.71367 | acc=0.1588 | tpr=0.7345 | fpr=0.8516 | 4521.3 samples/s | 17.7 steps/s
[Step= 100] | Loss=1.70263 | acc=0.1611 | tpr=0.7313 | fpr=0.8495 | 7432.9 samples/s | 29.0 steps/s
[Step= 150] | Loss=1.70600 | acc=0.1604 | tpr=0.7089 | fpr=0.8497 | 8199.5 samples/s | 32.0 steps/s
[Step= 200] | Loss=1.70543 | acc=0.1614 | tpr=0.7137 | fpr=0.8486 | 8102.6 samples/s | 31.7 steps/s
[Step= 250] | Loss=1.70702 | acc=0.1610 | tpr=0.7118 | fpr=0.8490 | 8578.3 samples/s | 33.5 steps/s
[Step= 300] | Loss=1.70852 | acc=0.1601 | tpr=0.7098 | fpr=0.8499 | 7941.0 samples/s | 31.0 steps/s
[Step= 350] | Loss=1.70842 | acc=0.1598 | tpr=0.7170 | fpr=0.8503 | 8087.0 samples/s | 31.6 steps/s
[Step= 400] | Loss=1.70641 | acc=0.1601 | tpr=0.7237 | fpr=0.8501 | 8132.6 samples/s | 31.8 steps/s
[Step= 450] | Loss=1.70732 | acc=0.1601 | tpr=0.7201 | fpr=0.8501 | 7799.3 samples/s | 30.5 steps/s
[Step= 500] | Loss=1.70787 | acc=0.1598 | tpr=0.7225 | fpr=0.8503 | 8171.2 samples/s | 31.9 steps/s
[Step= 550] | Loss=1.70810 | acc=0.1595 | tpr=0.7274 | fpr=0.8508 | 14991.4 samples/s | 58.6 steps/s
Avg test loss: 1.70855, Avg test acc: 0.15930, Avg tpr: 0.72662, Avg fpr: 0.85102, total FA: 118162

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.04775 | acc=0.9809 | tpr=0.8451 | fpr=0.0166 | 4362.1 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.04703 | acc=0.9807 | tpr=0.8721 | fpr=0.0173 | 7938.9 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.04830 | acc=0.9802 | tpr=0.8818 | fpr=0.0180 | 8175.7 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.04935 | acc=0.9800 | tpr=0.8907 | fpr=0.0183 | 8023.9 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.04921 | acc=0.9802 | tpr=0.8934 | fpr=0.0183 | 7784.9 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.04972 | acc=0.9801 | tpr=0.8916 | fpr=0.0182 | 8102.8 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.04971 | acc=0.9801 | tpr=0.8917 | fpr=0.0183 | 8240.6 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.05016 | acc=0.9800 | tpr=0.8922 | fpr=0.0184 | 8294.0 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.05133 | acc=0.9797 | tpr=0.8880 | fpr=0.0187 | 7966.5 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.05089 | acc=0.9798 | tpr=0.8877 | fpr=0.0185 | 7937.7 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.05039 | acc=0.9800 | tpr=0.8878 | fpr=0.0183 | 14329.2 samples/s | 56.0 steps/s
Avg test loss: 0.05028, Avg test acc: 0.97999, Avg tpr: 0.88748, Avg fpr: 0.01833, total FA: 2545

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.03155 | acc=0.9868 | tpr=0.8319 | fpr=0.0104 | 4349.1 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.03110 | acc=0.9861 | tpr=0.8401 | fpr=0.0111 | 8292.7 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.03189 | acc=0.9857 | tpr=0.8487 | fpr=0.0117 | 8295.1 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.03276 | acc=0.9853 | tpr=0.8481 | fpr=0.0123 | 8172.1 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.03266 | acc=0.9855 | tpr=0.8498 | fpr=0.0121 | 8188.0 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.03257 | acc=0.9854 | tpr=0.8415 | fpr=0.0120 | 8143.8 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.03242 | acc=0.9854 | tpr=0.8441 | fpr=0.0120 | 8076.3 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.03291 | acc=0.9853 | tpr=0.8435 | fpr=0.0121 | 8508.0 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.03319 | acc=0.9852 | tpr=0.8398 | fpr=0.0121 | 8749.6 samples/s | 34.2 steps/s
[Step= 500] | Loss=0.03289 | acc=0.9853 | tpr=0.8423 | fpr=0.0122 | 7704.6 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.03267 | acc=0.9854 | tpr=0.8380 | fpr=0.0119 | 14880.2 samples/s | 58.1 steps/s
Avg test loss: 0.03262, Avg test acc: 0.98541, Avg tpr: 0.83835, Avg fpr: 0.01192, total FA: 1655

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.04236 | acc=0.9814 | tpr=0.9159 | fpr=0.0174 | 4294.0 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.04082 | acc=0.9813 | tpr=0.9168 | fpr=0.0175 | 8062.4 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.04193 | acc=0.9807 | tpr=0.9121 | fpr=0.0180 | 7920.4 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.04282 | acc=0.9805 | tpr=0.9158 | fpr=0.0183 | 8205.7 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.04232 | acc=0.9806 | tpr=0.9135 | fpr=0.0182 | 8201.9 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.04230 | acc=0.9804 | tpr=0.9113 | fpr=0.0183 | 7850.4 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.04253 | acc=0.9803 | tpr=0.9117 | fpr=0.0185 | 7530.7 samples/s | 29.4 steps/s
[Step= 400] | Loss=0.04282 | acc=0.9803 | tpr=0.9125 | fpr=0.0185 | 7524.7 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.04327 | acc=0.9800 | tpr=0.9104 | fpr=0.0187 | 7800.0 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.04302 | acc=0.9801 | tpr=0.9119 | fpr=0.0186 | 7495.8 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.04263 | acc=0.9803 | tpr=0.9097 | fpr=0.0184 | 14953.3 samples/s | 58.4 steps/s
Avg test loss: 0.04255, Avg test acc: 0.98031, Avg tpr: 0.91006, Avg fpr: 0.01842, total FA: 2557

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.04939 | acc=0.9809 | tpr=0.8673 | fpr=0.0170 | 4298.1 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.04888 | acc=0.9814 | tpr=0.8849 | fpr=0.0168 | 8197.5 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.05122 | acc=0.9806 | tpr=0.8876 | fpr=0.0177 | 8481.6 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.05233 | acc=0.9802 | tpr=0.8929 | fpr=0.0182 | 7956.5 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.05132 | acc=0.9806 | tpr=0.8900 | fpr=0.0178 | 8090.0 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.05204 | acc=0.9804 | tpr=0.8851 | fpr=0.0179 | 7816.5 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.05174 | acc=0.9805 | tpr=0.8898 | fpr=0.0178 | 8360.9 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.05172 | acc=0.9804 | tpr=0.8895 | fpr=0.0179 | 8179.1 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.05277 | acc=0.9800 | tpr=0.8832 | fpr=0.0183 | 8630.7 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.05247 | acc=0.9801 | tpr=0.8850 | fpr=0.0181 | 7955.1 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.05170 | acc=0.9803 | tpr=0.8850 | fpr=0.0179 | 14780.3 samples/s | 57.7 steps/s
Avg test loss: 0.05163, Avg test acc: 0.98037, Avg tpr: 0.88510, Avg fpr: 0.01790, total FA: 2485

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.04496 | acc=0.9813 | tpr=0.8584 | fpr=0.0165 | 4349.5 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.04567 | acc=0.9812 | tpr=0.8721 | fpr=0.0168 | 8236.5 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.04678 | acc=0.9809 | tpr=0.8775 | fpr=0.0172 | 7918.6 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.04710 | acc=0.9808 | tpr=0.8842 | fpr=0.0175 | 8141.4 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.04706 | acc=0.9811 | tpr=0.8847 | fpr=0.0171 | 8451.5 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.04778 | acc=0.9806 | tpr=0.8785 | fpr=0.0175 | 7979.2 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.04781 | acc=0.9806 | tpr=0.8817 | fpr=0.0176 | 7911.0 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.04810 | acc=0.9805 | tpr=0.8807 | fpr=0.0177 | 8373.1 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.04934 | acc=0.9800 | tpr=0.8778 | fpr=0.0181 | 7952.4 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.04869 | acc=0.9802 | tpr=0.8771 | fpr=0.0179 | 8032.7 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.04825 | acc=0.9804 | tpr=0.8754 | fpr=0.0177 | 15489.4 samples/s | 60.5 steps/s
Avg test loss: 0.04821, Avg test acc: 0.98037, Avg tpr: 0.87559, Avg fpr: 0.01772, total FA: 2461

server round 1/10

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.4] | Loss=0.11487 | Reg=0.00327 | acc=0.9375 | L2-Norm=18.071 | L2-Norm(final)=2.197 | 4323.9 samples/s | 67.6 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.05221 | Reg=0.00326 | acc=0.9531 | L2-Norm=18.067 | L2-Norm(final)=2.206 | 4555.7 samples/s | 71.2 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.04967 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.058 | L2-Norm(final)=2.212 | 4731.8 samples/s | 73.9 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.04796 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.050 | L2-Norm(final)=2.217 | 4616.5 samples/s | 72.1 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.04759 | Reg=0.00326 | acc=0.9375 | L2-Norm=18.046 | L2-Norm(final)=2.222 | 6110.0 samples/s | 95.5 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.04456 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.043 | L2-Norm(final)=2.228 | 1920.4 samples/s | 30.0 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.04292 | Reg=0.00326 | acc=0.9531 | L2-Norm=18.042 | L2-Norm(final)=2.234 | 4524.6 samples/s | 70.7 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.04148 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.043 | L2-Norm(final)=2.241 | 4612.3 samples/s | 72.1 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.04162 | Reg=0.00326 | acc=0.9688 | L2-Norm=18.042 | L2-Norm(final)=2.245 | 5774.5 samples/s | 90.2 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.04051 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.041 | L2-Norm(final)=2.249 | 2028.3 samples/s | 31.7 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.03938 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.039 | L2-Norm(final)=2.253 | 4632.3 samples/s | 72.4 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_0/client_state-step1000.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.4] | Loss=0.02631 | Reg=0.00327 | acc=0.9844 | L2-Norm=18.082 | L2-Norm(final)=2.200 | 4440.5 samples/s | 69.4 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.04427 | Reg=0.00327 | acc=0.9688 | L2-Norm=18.090 | L2-Norm(final)=2.211 | 4483.5 samples/s | 70.1 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.04533 | Reg=0.00327 | acc=0.9531 | L2-Norm=18.091 | L2-Norm(final)=2.219 | 4782.3 samples/s | 74.7 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.04529 | Reg=0.00327 | acc=0.9375 | L2-Norm=18.096 | L2-Norm(final)=2.225 | 4753.9 samples/s | 74.3 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.04611 | Reg=0.00327 | acc=0.9531 | L2-Norm=18.095 | L2-Norm(final)=2.229 | 6116.0 samples/s | 95.6 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.04359 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.095 | L2-Norm(final)=2.234 | 1978.1 samples/s | 30.9 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.04207 | Reg=0.00327 | acc=0.9531 | L2-Norm=18.095 | L2-Norm(final)=2.239 | 4832.4 samples/s | 75.5 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.04214 | Reg=0.00327 | acc=0.9688 | L2-Norm=18.094 | L2-Norm(final)=2.244 | 4672.5 samples/s | 73.0 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.04162 | Reg=0.00327 | acc=0.9375 | L2-Norm=18.097 | L2-Norm(final)=2.248 | 5930.3 samples/s | 92.7 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.04156 | Reg=0.00328 | acc=0.9375 | L2-Norm=18.102 | L2-Norm(final)=2.251 | 1993.6 samples/s | 31.2 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.04025 | Reg=0.00328 | acc=0.9688 | L2-Norm=18.108 | L2-Norm(final)=2.254 | 4371.0 samples/s | 68.3 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_1/client_state-step1000.h5

Train client 2: client_asml1_2
Local layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.4] | Loss=0.03346 | Reg=0.00332 | acc=0.9844 | L2-Norm=18.217 | L2-Norm(final)=2.206 | 4583.7 samples/s | 71.6 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.04925 | Reg=0.00332 | acc=0.9375 | L2-Norm=18.222 | L2-Norm(final)=2.213 | 4294.1 samples/s | 67.1 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.04987 | Reg=0.00332 | acc=0.9531 | L2-Norm=18.230 | L2-Norm(final)=2.221 | 4691.2 samples/s | 73.3 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.05324 | Reg=0.00333 | acc=0.8906 | L2-Norm=18.238 | L2-Norm(final)=2.226 | 4525.1 samples/s | 70.7 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.05426 | Reg=0.00333 | acc=0.9531 | L2-Norm=18.243 | L2-Norm(final)=2.228 | 6156.8 samples/s | 96.2 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.05052 | Reg=0.00333 | acc=0.9531 | L2-Norm=18.252 | L2-Norm(final)=2.230 | 1981.2 samples/s | 31.0 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.04890 | Reg=0.00333 | acc=0.9531 | L2-Norm=18.259 | L2-Norm(final)=2.234 | 4583.5 samples/s | 71.6 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.04738 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.266 | L2-Norm(final)=2.238 | 4551.4 samples/s | 71.1 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.04718 | Reg=0.00334 | acc=0.9844 | L2-Norm=18.271 | L2-Norm(final)=2.241 | 5738.3 samples/s | 89.7 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.04523 | Reg=0.00334 | acc=0.9844 | L2-Norm=18.276 | L2-Norm(final)=2.244 | 2042.3 samples/s | 31.9 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.04304 | Reg=0.00334 | acc=0.9844 | L2-Norm=18.278 | L2-Norm(final)=2.248 | 4643.8 samples/s | 72.6 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_2/client_state-step1000.h5

Train client 3: client_asml1_3
Local layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.4] | Loss=0.03562 | Reg=0.00328 | acc=0.9688 | L2-Norm=18.114 | L2-Norm(final)=2.213 | 4402.1 samples/s | 68.8 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.04957 | Reg=0.00328 | acc=0.9688 | L2-Norm=18.114 | L2-Norm(final)=2.224 | 4523.3 samples/s | 70.7 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.05045 | Reg=0.00328 | acc=0.9531 | L2-Norm=18.113 | L2-Norm(final)=2.233 | 4686.1 samples/s | 73.2 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.05194 | Reg=0.00328 | acc=0.9688 | L2-Norm=18.115 | L2-Norm(final)=2.240 | 4564.0 samples/s | 71.3 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.05326 | Reg=0.00328 | acc=0.8906 | L2-Norm=18.116 | L2-Norm(final)=2.244 | 6125.8 samples/s | 95.7 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.04965 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.116 | L2-Norm(final)=2.248 | 2032.4 samples/s | 31.8 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.04702 | Reg=0.00328 | acc=0.9688 | L2-Norm=18.115 | L2-Norm(final)=2.255 | 4589.2 samples/s | 71.7 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.04507 | Reg=0.00328 | acc=0.9531 | L2-Norm=18.112 | L2-Norm(final)=2.261 | 4377.1 samples/s | 68.4 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.04367 | Reg=0.00328 | acc=0.9688 | L2-Norm=18.107 | L2-Norm(final)=2.267 | 5835.8 samples/s | 91.2 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.04217 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.103 | L2-Norm(final)=2.274 | 2054.1 samples/s | 32.1 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.04030 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.098 | L2-Norm(final)=2.280 | 4561.1 samples/s | 71.3 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_3/client_state-step1000.h5

Train client 4: client_asml1_4
Local layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.5] | Loss=0.05774 | Reg=0.00326 | acc=0.9531 | L2-Norm=18.063 | L2-Norm(final)=2.184 | 4437.2 samples/s | 69.3 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.04420 | Reg=0.00327 | acc=0.9844 | L2-Norm=18.074 | L2-Norm(final)=2.196 | 4363.1 samples/s | 68.2 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.04701 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.081 | L2-Norm(final)=2.207 | 4596.6 samples/s | 71.8 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.05177 | Reg=0.00327 | acc=0.9375 | L2-Norm=18.087 | L2-Norm(final)=2.214 | 4600.2 samples/s | 71.9 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.05322 | Reg=0.00327 | acc=0.9531 | L2-Norm=18.092 | L2-Norm(final)=2.217 | 6743.4 samples/s | 105.4 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.05008 | Reg=0.00327 | acc=0.9531 | L2-Norm=18.096 | L2-Norm(final)=2.223 | 2026.0 samples/s | 31.7 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.04745 | Reg=0.00328 | acc=0.9531 | L2-Norm=18.099 | L2-Norm(final)=2.228 | 4653.0 samples/s | 72.7 steps/s
[Step= 850 Epoch= 4.2] | Loss=0.04609 | Reg=0.00328 | acc=0.9844 | L2-Norm=18.101 | L2-Norm(final)=2.234 | 4580.4 samples/s | 71.6 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.04521 | Reg=0.00328 | acc=0.9688 | L2-Norm=18.101 | L2-Norm(final)=2.238 | 5946.6 samples/s | 92.9 steps/s
[Step= 950 Epoch= 4.7] | Loss=0.04308 | Reg=0.00328 | acc=0.9375 | L2-Norm=18.100 | L2-Norm(final)=2.243 | 2018.4 samples/s | 31.5 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.04148 | Reg=0.00328 | acc=0.9844 | L2-Norm=18.097 | L2-Norm(final)=2.248 | 4591.1 samples/s | 71.7 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_4/client_state-step1000.h5

Train client 5: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.7] | Loss=0.00002 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.436 | L2-Norm(final)=2.153 | 4076.0 samples/s | 63.7 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.00003 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.374 | L2-Norm(final)=2.157 | 4415.3 samples/s | 69.0 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.00003 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.312 | L2-Norm(final)=2.161 | 6121.7 samples/s | 95.7 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.00003 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.251 | L2-Norm(final)=2.165 | 1938.0 samples/s | 30.3 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.00002 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.190 | L2-Norm(final)=2.170 | 5512.1 samples/s | 86.1 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.00002 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.129 | L2-Norm(final)=2.174 | 1940.5 samples/s | 30.3 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.00002 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.069 | L2-Norm(final)=2.178 | 5200.5 samples/s | 81.3 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.00002 | Reg=0.00289 | acc=1.0000 | L2-Norm=17.010 | L2-Norm(final)=2.183 | 1979.0 samples/s | 30.9 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.00002 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.950 | L2-Norm(final)=2.188 | 4786.1 samples/s | 74.8 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.00002 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.892 | L2-Norm(final)=2.192 | 2047.0 samples/s | 32.0 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.00002 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.833 | L2-Norm(final)=2.197 | 4447.0 samples/s | 69.5 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_0/client_state-step1000.h5

Train client 6: client_iccad2012_1
Local layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.8] | Loss=0.00005 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.385 | L2-Norm(final)=2.153 | 4328.1 samples/s | 67.6 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.00005 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.328 | L2-Norm(final)=2.154 | 4240.5 samples/s | 66.3 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.00004 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.270 | L2-Norm(final)=2.155 | 5943.7 samples/s | 92.9 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.00004 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.213 | L2-Norm(final)=2.156 | 1947.1 samples/s | 30.4 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.00004 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.157 | L2-Norm(final)=2.158 | 5490.5 samples/s | 85.8 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.00003 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.101 | L2-Norm(final)=2.159 | 1996.3 samples/s | 31.2 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.00003 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.046 | L2-Norm(final)=2.161 | 5361.6 samples/s | 83.8 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.00003 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.992 | L2-Norm(final)=2.162 | 2029.8 samples/s | 31.7 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.00003 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.937 | L2-Norm(final)=2.164 | 4860.0 samples/s | 75.9 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.00003 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.884 | L2-Norm(final)=2.166 | 2169.0 samples/s | 33.9 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.00002 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.830 | L2-Norm(final)=2.168 | 4655.0 samples/s | 72.7 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_1/client_state-step1000.h5

Train client 7: client_iccad2012_2
Local layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.8] | Loss=0.00007 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.098 | L2-Norm(final)=2.125 | 4365.4 samples/s | 68.2 steps/s
[Step= 550 Epoch= 5.3] | Loss=0.00005 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.035 | L2-Norm(final)=2.126 | 4223.8 samples/s | 66.0 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.00004 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.973 | L2-Norm(final)=2.128 | 6045.8 samples/s | 94.5 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.00004 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.912 | L2-Norm(final)=2.130 | 1937.5 samples/s | 30.3 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.00004 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.852 | L2-Norm(final)=2.133 | 5742.6 samples/s | 89.7 steps/s
[Step= 750 Epoch= 7.2] | Loss=0.00003 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.792 | L2-Norm(final)=2.136 | 1911.7 samples/s | 29.9 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.00003 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.734 | L2-Norm(final)=2.139 | 5249.5 samples/s | 82.0 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.00003 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.676 | L2-Norm(final)=2.142 | 2021.7 samples/s | 31.6 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.00003 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.618 | L2-Norm(final)=2.145 | 4987.2 samples/s | 77.9 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.00003 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.562 | L2-Norm(final)=2.148 | 2069.9 samples/s | 32.3 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.00002 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.506 | L2-Norm(final)=2.151 | 4742.3 samples/s | 74.1 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_2/client_state-step1000.h5

Train client 8: client_iccad2012_3
Local layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.7] | Loss=0.00003 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.448 | L2-Norm(final)=2.158 | 4455.9 samples/s | 69.6 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.00004 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.393 | L2-Norm(final)=2.161 | 4058.2 samples/s | 63.4 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.00005 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.338 | L2-Norm(final)=2.166 | 5912.6 samples/s | 92.4 steps/s
[Step= 650 Epoch= 6.1] | Loss=0.00004 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.285 | L2-Norm(final)=2.173 | 1910.6 samples/s | 29.9 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.00004 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.233 | L2-Norm(final)=2.180 | 5368.1 samples/s | 83.9 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.00003 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.180 | L2-Norm(final)=2.187 | 2011.2 samples/s | 31.4 steps/s
[Step= 800 Epoch= 7.5] | Loss=0.00003 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.127 | L2-Norm(final)=2.194 | 5021.4 samples/s | 78.5 steps/s
[Step= 850 Epoch= 8.0] | Loss=0.00003 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.075 | L2-Norm(final)=2.200 | 2046.8 samples/s | 32.0 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.00003 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.023 | L2-Norm(final)=2.207 | 4715.0 samples/s | 73.7 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.00003 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.972 | L2-Norm(final)=2.214 | 2116.3 samples/s | 33.1 steps/s
[Step=1000 Epoch= 9.4] | Loss=0.00002 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.921 | L2-Norm(final)=2.220 | 4429.5 samples/s | 69.2 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_3/client_state-step1000.h5

Train client 9: client_iccad2012_4
Local layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.8] | Loss=0.00008 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.283 | L2-Norm(final)=2.129 | 4325.7 samples/s | 67.6 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.00006 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.224 | L2-Norm(final)=2.130 | 4362.0 samples/s | 68.2 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.00006 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.163 | L2-Norm(final)=2.131 | 6096.5 samples/s | 95.3 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.00005 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.105 | L2-Norm(final)=2.133 | 1928.4 samples/s | 30.1 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.00005 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.047 | L2-Norm(final)=2.134 | 5752.7 samples/s | 89.9 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.00005 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.990 | L2-Norm(final)=2.135 | 1978.3 samples/s | 30.9 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.00004 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.934 | L2-Norm(final)=2.137 | 5203.8 samples/s | 81.3 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.00004 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.879 | L2-Norm(final)=2.138 | 1976.8 samples/s | 30.9 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.00004 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.825 | L2-Norm(final)=2.140 | 4967.3 samples/s | 77.6 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.00004 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.771 | L2-Norm(final)=2.142 | 2028.4 samples/s | 31.7 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.00003 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.718 | L2-Norm(final)=2.144 | 4735.7 samples/s | 74.0 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_4/client_state-step1000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.14144 | acc=0.9163 | tpr=0.9158 | fpr=0.0825 | 4565.0 samples/s | 17.8 steps/s
Avg test loss: 0.14536, Avg test acc: 0.91490, Avg tpr: 0.91385, Avg fpr: 0.08281, total FA: 646

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.13044 | acc=0.9239 | tpr=0.9500 | fpr=0.1328 | 4468.1 samples/s | 17.5 steps/s
Avg test loss: 0.13506, Avg test acc: 0.92275, Avg tpr: 0.94912, Avg fpr: 0.13524, total FA: 1055

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.13783 | acc=0.9234 | tpr=0.9330 | fpr=0.0974 | 4327.4 samples/s | 16.9 steps/s
Avg test loss: 0.13911, Avg test acc: 0.92183, Avg tpr: 0.93017, Avg fpr: 0.09653, total FA: 753

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.15417 | acc=0.9223 | tpr=0.9645 | fpr=0.1695 | 4379.4 samples/s | 17.1 steps/s
Avg test loss: 0.15667, Avg test acc: 0.92015, Avg tpr: 0.96421, Avg fpr: 0.17677, total FA: 1379

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.14014 | acc=0.9138 | tpr=0.9096 | fpr=0.0771 | 4459.1 samples/s | 17.4 steps/s
Avg test loss: 0.14678, Avg test acc: 0.91321, Avg tpr: 0.90977, Avg fpr: 0.07922, total FA: 618

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.54274 | acc=0.3160 | tpr=0.0082 | fpr=0.0156 | 4235.7 samples/s | 16.5 steps/s
Avg test loss: 5.56819, Avg test acc: 0.31341, Avg tpr: 0.00816, Avg fpr: 0.01525, total FA: 119

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.46981 | acc=0.3112 | tpr=0.0178 | fpr=0.0518 | 4345.2 samples/s | 17.0 steps/s
Avg test loss: 4.48729, Avg test acc: 0.30904, Avg tpr: 0.01690, Avg fpr: 0.04846, total FA: 378

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.01984 | acc=0.3137 | tpr=0.0284 | fpr=0.0667 | 4395.8 samples/s | 17.2 steps/s
Avg test loss: 5.04355, Avg test acc: 0.31124, Avg tpr: 0.02821, Avg fpr: 0.06627, total FA: 517

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.97365 | acc=0.3137 | tpr=0.0193 | fpr=0.0471 | 4396.1 samples/s | 17.2 steps/s
Avg test loss: 4.99269, Avg test acc: 0.31257, Avg tpr: 0.02098, Avg fpr: 0.04615, total FA: 360

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.58044 | acc=0.3145 | tpr=0.0064 | fpr=0.0166 | 4492.7 samples/s | 17.5 steps/s
Avg test loss: 5.59465, Avg test acc: 0.31224, Avg tpr: 0.00659, Avg fpr: 0.01551, total FA: 121

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=2.68010 | acc=0.1722 | tpr=0.8230 | fpr=0.8395 | 4307.8 samples/s | 16.8 steps/s
[Step= 100] | Loss=2.67522 | acc=0.1738 | tpr=0.7996 | fpr=0.8378 | 7983.9 samples/s | 31.2 steps/s
[Step= 150] | Loss=2.67662 | acc=0.1740 | tpr=0.7882 | fpr=0.8373 | 8140.3 samples/s | 31.8 steps/s
[Step= 200] | Loss=2.67238 | acc=0.1749 | tpr=0.7989 | fpr=0.8365 | 8188.3 samples/s | 32.0 steps/s
[Step= 250] | Loss=2.67723 | acc=0.1752 | tpr=0.8017 | fpr=0.8363 | 7949.0 samples/s | 31.1 steps/s
[Step= 300] | Loss=2.67864 | acc=0.1747 | tpr=0.8036 | fpr=0.8368 | 8387.1 samples/s | 32.8 steps/s
[Step= 350] | Loss=2.67978 | acc=0.1747 | tpr=0.8103 | fpr=0.8368 | 7997.8 samples/s | 31.2 steps/s
[Step= 400] | Loss=2.67936 | acc=0.1750 | tpr=0.8124 | fpr=0.8366 | 8141.1 samples/s | 31.8 steps/s
[Step= 450] | Loss=2.67915 | acc=0.1753 | tpr=0.8106 | fpr=0.8362 | 8368.9 samples/s | 32.7 steps/s
[Step= 500] | Loss=2.68058 | acc=0.1753 | tpr=0.8088 | fpr=0.8362 | 8087.2 samples/s | 31.6 steps/s
[Step= 550] | Loss=2.67949 | acc=0.1751 | tpr=0.8114 | fpr=0.8364 | 14741.9 samples/s | 57.6 steps/s
Avg test loss: 2.68038, Avg test acc: 0.17503, Avg tpr: 0.81181, Avg fpr: 0.83655, total FA: 116153

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=2.86291 | acc=0.1252 | tpr=0.8761 | fpr=0.8883 | 4437.9 samples/s | 17.3 steps/s
[Step= 100] | Loss=2.83422 | acc=0.1268 | tpr=0.8721 | fpr=0.8871 | 7650.8 samples/s | 29.9 steps/s
[Step= 150] | Loss=2.85141 | acc=0.1256 | tpr=0.8689 | fpr=0.8881 | 7876.1 samples/s | 30.8 steps/s
[Step= 200] | Loss=2.84575 | acc=0.1257 | tpr=0.8710 | fpr=0.8879 | 7509.1 samples/s | 29.3 steps/s
[Step= 250] | Loss=2.84827 | acc=0.1253 | tpr=0.8611 | fpr=0.8881 | 7319.8 samples/s | 28.6 steps/s
[Step= 300] | Loss=2.84739 | acc=0.1243 | tpr=0.8582 | fpr=0.8891 | 7605.7 samples/s | 29.7 steps/s
[Step= 350] | Loss=2.84624 | acc=0.1240 | tpr=0.8572 | fpr=0.8893 | 7119.0 samples/s | 27.8 steps/s
[Step= 400] | Loss=2.84495 | acc=0.1244 | tpr=0.8621 | fpr=0.8890 | 7975.4 samples/s | 31.2 steps/s
[Step= 450] | Loss=2.84486 | acc=0.1241 | tpr=0.8583 | fpr=0.8893 | 7462.9 samples/s | 29.2 steps/s
[Step= 500] | Loss=2.84515 | acc=0.1236 | tpr=0.8595 | fpr=0.8897 | 7596.6 samples/s | 29.7 steps/s
[Step= 550] | Loss=2.84343 | acc=0.1239 | tpr=0.8595 | fpr=0.8895 | 14474.2 samples/s | 56.5 steps/s
Avg test loss: 2.84383, Avg test acc: 0.12382, Avg tpr: 0.85975, Avg fpr: 0.88956, total FA: 123513

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=2.88235 | acc=0.1517 | tpr=0.8186 | fpr=0.8603 | 4246.7 samples/s | 16.6 steps/s
[Step= 100] | Loss=2.86417 | acc=0.1532 | tpr=0.8081 | fpr=0.8590 | 7903.3 samples/s | 30.9 steps/s
[Step= 150] | Loss=2.86411 | acc=0.1526 | tpr=0.8012 | fpr=0.8594 | 7712.8 samples/s | 30.1 steps/s
[Step= 200] | Loss=2.85788 | acc=0.1523 | tpr=0.7847 | fpr=0.8592 | 7896.0 samples/s | 30.8 steps/s
[Step= 250] | Loss=2.86048 | acc=0.1525 | tpr=0.7852 | fpr=0.8590 | 7906.3 samples/s | 30.9 steps/s
[Step= 300] | Loss=2.86059 | acc=0.1525 | tpr=0.7811 | fpr=0.8590 | 7735.4 samples/s | 30.2 steps/s
[Step= 350] | Loss=2.85698 | acc=0.1520 | tpr=0.7852 | fpr=0.8595 | 7307.1 samples/s | 28.5 steps/s
[Step= 400] | Loss=2.85839 | acc=0.1520 | tpr=0.7894 | fpr=0.8596 | 7315.6 samples/s | 28.6 steps/s
[Step= 450] | Loss=2.85958 | acc=0.1518 | tpr=0.7902 | fpr=0.8598 | 7719.1 samples/s | 30.2 steps/s
[Step= 500] | Loss=2.86172 | acc=0.1514 | tpr=0.7930 | fpr=0.8602 | 7864.7 samples/s | 30.7 steps/s
[Step= 550] | Loss=2.86224 | acc=0.1519 | tpr=0.7955 | fpr=0.8598 | 13890.6 samples/s | 54.3 steps/s
Avg test loss: 2.86322, Avg test acc: 0.15175, Avg tpr: 0.79556, Avg fpr: 0.85995, total FA: 119403

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=3.39147 | acc=0.1197 | tpr=0.8717 | fpr=0.8938 | 4157.9 samples/s | 16.2 steps/s
[Step= 100] | Loss=3.37704 | acc=0.1221 | tpr=0.8465 | fpr=0.8914 | 7579.3 samples/s | 29.6 steps/s
[Step= 150] | Loss=3.37730 | acc=0.1220 | tpr=0.8386 | fpr=0.8912 | 8101.5 samples/s | 31.6 steps/s
[Step= 200] | Loss=3.37080 | acc=0.1214 | tpr=0.8361 | fpr=0.8916 | 8024.4 samples/s | 31.3 steps/s
[Step= 250] | Loss=3.37586 | acc=0.1214 | tpr=0.8419 | fpr=0.8917 | 7590.4 samples/s | 29.6 steps/s
[Step= 300] | Loss=3.37410 | acc=0.1207 | tpr=0.8364 | fpr=0.8924 | 8166.0 samples/s | 31.9 steps/s
[Step= 350] | Loss=3.37366 | acc=0.1202 | tpr=0.8353 | fpr=0.8928 | 7879.9 samples/s | 30.8 steps/s
[Step= 400] | Loss=3.37521 | acc=0.1206 | tpr=0.8397 | fpr=0.8925 | 7864.0 samples/s | 30.7 steps/s
[Step= 450] | Loss=3.37520 | acc=0.1205 | tpr=0.8418 | fpr=0.8926 | 7480.8 samples/s | 29.2 steps/s
[Step= 500] | Loss=3.37655 | acc=0.1207 | tpr=0.8449 | fpr=0.8923 | 7670.8 samples/s | 30.0 steps/s
[Step= 550] | Loss=3.37851 | acc=0.1208 | tpr=0.8464 | fpr=0.8924 | 14705.4 samples/s | 57.4 steps/s
Avg test loss: 3.37890, Avg test acc: 0.12074, Avg tpr: 0.84707, Avg fpr: 0.89247, total FA: 123917

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=2.81872 | acc=0.1601 | tpr=0.6593 | fpr=0.8489 | 4124.8 samples/s | 16.1 steps/s
[Step= 100] | Loss=2.79949 | acc=0.1625 | tpr=0.6780 | fpr=0.8472 | 7644.1 samples/s | 29.9 steps/s
[Step= 150] | Loss=2.80623 | acc=0.1609 | tpr=0.6772 | fpr=0.8486 | 7652.0 samples/s | 29.9 steps/s
[Step= 200] | Loss=2.80592 | acc=0.1609 | tpr=0.6787 | fpr=0.8485 | 8021.2 samples/s | 31.3 steps/s
[Step= 250] | Loss=2.80919 | acc=0.1608 | tpr=0.6856 | fpr=0.8488 | 7737.5 samples/s | 30.2 steps/s
[Step= 300] | Loss=2.81134 | acc=0.1605 | tpr=0.6865 | fpr=0.8491 | 8167.9 samples/s | 31.9 steps/s
[Step= 350] | Loss=2.81240 | acc=0.1600 | tpr=0.6925 | fpr=0.8496 | 7365.8 samples/s | 28.8 steps/s
[Step= 400] | Loss=2.81021 | acc=0.1600 | tpr=0.6975 | fpr=0.8498 | 7894.6 samples/s | 30.8 steps/s
[Step= 450] | Loss=2.81183 | acc=0.1594 | tpr=0.6947 | fpr=0.8503 | 7500.2 samples/s | 29.3 steps/s
[Step= 500] | Loss=2.81289 | acc=0.1594 | tpr=0.6974 | fpr=0.8504 | 7995.4 samples/s | 31.2 steps/s
[Step= 550] | Loss=2.81367 | acc=0.1591 | tpr=0.7004 | fpr=0.8507 | 14948.3 samples/s | 58.4 steps/s
Avg test loss: 2.81425, Avg test acc: 0.15902, Avg tpr: 0.70127, Avg fpr: 0.85084, total FA: 118137

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.05652 | acc=0.9805 | tpr=0.8451 | fpr=0.0171 | 4181.3 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.05590 | acc=0.9804 | tpr=0.8742 | fpr=0.0177 | 7557.3 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.05758 | acc=0.9798 | tpr=0.8818 | fpr=0.0184 | 8224.9 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.05885 | acc=0.9797 | tpr=0.8907 | fpr=0.0187 | 7521.3 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.05870 | acc=0.9797 | tpr=0.8934 | fpr=0.0187 | 7938.7 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.05934 | acc=0.9796 | tpr=0.8916 | fpr=0.0188 | 7663.7 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.05927 | acc=0.9796 | tpr=0.8910 | fpr=0.0188 | 7476.0 samples/s | 29.2 steps/s
[Step= 400] | Loss=0.05981 | acc=0.9794 | tpr=0.8928 | fpr=0.0190 | 7335.5 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.06121 | acc=0.9791 | tpr=0.8885 | fpr=0.0192 | 7555.7 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.06069 | acc=0.9793 | tpr=0.8890 | fpr=0.0191 | 7781.1 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.06011 | acc=0.9795 | tpr=0.8890 | fpr=0.0188 | 15198.4 samples/s | 59.4 steps/s
Avg test loss: 0.05998, Avg test acc: 0.97954, Avg tpr: 0.88867, Avg fpr: 0.01881, total FA: 2612

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.03708 | acc=0.9862 | tpr=0.8407 | fpr=0.0111 | 4426.0 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.03652 | acc=0.9856 | tpr=0.8507 | fpr=0.0119 | 8130.4 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.03752 | acc=0.9852 | tpr=0.8573 | fpr=0.0124 | 8168.5 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.03855 | acc=0.9848 | tpr=0.8568 | fpr=0.0129 | 8083.7 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.03841 | acc=0.9850 | tpr=0.8594 | fpr=0.0127 | 7732.5 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.03834 | acc=0.9848 | tpr=0.8509 | fpr=0.0127 | 8092.3 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.03823 | acc=0.9849 | tpr=0.8541 | fpr=0.0127 | 8189.3 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.03878 | acc=0.9848 | tpr=0.8539 | fpr=0.0128 | 8208.7 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.03906 | acc=0.9847 | tpr=0.8505 | fpr=0.0129 | 8011.3 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.03875 | acc=0.9848 | tpr=0.8524 | fpr=0.0129 | 8118.7 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.03846 | acc=0.9849 | tpr=0.8500 | fpr=0.0126 | 14775.9 samples/s | 57.7 steps/s
Avg test loss: 0.03840, Avg test acc: 0.98491, Avg tpr: 0.85063, Avg fpr: 0.01265, total FA: 1756

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.05197 | acc=0.9812 | tpr=0.9204 | fpr=0.0177 | 4192.1 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.05041 | acc=0.9807 | tpr=0.9232 | fpr=0.0182 | 7796.9 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.05202 | acc=0.9800 | tpr=0.9179 | fpr=0.0188 | 8003.5 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.05324 | acc=0.9796 | tpr=0.9213 | fpr=0.0193 | 8808.6 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.05270 | acc=0.9798 | tpr=0.9205 | fpr=0.0192 | 7773.3 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.05272 | acc=0.9795 | tpr=0.9185 | fpr=0.0194 | 7982.9 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.05298 | acc=0.9794 | tpr=0.9198 | fpr=0.0195 | 8338.0 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.05331 | acc=0.9794 | tpr=0.9207 | fpr=0.0196 | 7453.9 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.05389 | acc=0.9791 | tpr=0.9182 | fpr=0.0198 | 7463.6 samples/s | 29.2 steps/s
[Step= 500] | Loss=0.05360 | acc=0.9792 | tpr=0.9194 | fpr=0.0197 | 7967.6 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.05312 | acc=0.9794 | tpr=0.9180 | fpr=0.0195 | 13115.0 samples/s | 51.2 steps/s
Avg test loss: 0.05303, Avg test acc: 0.97941, Avg tpr: 0.91838, Avg fpr: 0.01948, total FA: 2705

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.06051 | acc=0.9807 | tpr=0.8673 | fpr=0.0173 | 4267.8 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.06013 | acc=0.9811 | tpr=0.8827 | fpr=0.0171 | 7538.3 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.06296 | acc=0.9804 | tpr=0.8862 | fpr=0.0178 | 7696.3 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.06452 | acc=0.9802 | tpr=0.8929 | fpr=0.0182 | 7848.5 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.06321 | acc=0.9805 | tpr=0.8900 | fpr=0.0179 | 7333.6 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.06414 | acc=0.9803 | tpr=0.8865 | fpr=0.0180 | 8493.0 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.06381 | acc=0.9805 | tpr=0.8910 | fpr=0.0179 | 7358.6 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.06384 | acc=0.9804 | tpr=0.8895 | fpr=0.0180 | 7899.8 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.06510 | acc=0.9800 | tpr=0.8832 | fpr=0.0183 | 7904.8 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.06473 | acc=0.9801 | tpr=0.8850 | fpr=0.0182 | 7762.9 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.06380 | acc=0.9803 | tpr=0.8850 | fpr=0.0180 | 14810.6 samples/s | 57.9 steps/s
Avg test loss: 0.06371, Avg test acc: 0.98031, Avg tpr: 0.88510, Avg fpr: 0.01795, total FA: 2493

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.04885 | acc=0.9825 | tpr=0.8407 | fpr=0.0150 | 4171.0 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.04956 | acc=0.9824 | tpr=0.8614 | fpr=0.0154 | 7977.5 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.05083 | acc=0.9822 | tpr=0.8660 | fpr=0.0157 | 7177.3 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.05103 | acc=0.9822 | tpr=0.8699 | fpr=0.0158 | 8134.0 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.05105 | acc=0.9824 | tpr=0.8707 | fpr=0.0155 | 8256.8 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.05190 | acc=0.9819 | tpr=0.8633 | fpr=0.0160 | 7284.0 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.05191 | acc=0.9819 | tpr=0.8673 | fpr=0.0161 | 7356.7 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.05224 | acc=0.9818 | tpr=0.8654 | fpr=0.0161 | 8498.1 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.05357 | acc=0.9813 | tpr=0.8637 | fpr=0.0165 | 7587.3 samples/s | 29.6 steps/s
[Step= 500] | Loss=0.05285 | acc=0.9815 | tpr=0.8639 | fpr=0.0163 | 7930.1 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.05241 | acc=0.9816 | tpr=0.8611 | fpr=0.0162 | 14040.9 samples/s | 54.8 steps/s
Avg test loss: 0.05237, Avg test acc: 0.98162, Avg tpr: 0.86133, Avg fpr: 0.01619, total FA: 2248

server round 2/10

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=1001 Epoch= 4.9] | Loss=0.04635 | Reg=0.00325 | acc=0.9688 | L2-Norm=18.015 | L2-Norm(final)=2.288 | 4278.0 samples/s | 66.8 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.02747 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.018 | L2-Norm(final)=2.292 | 4358.8 samples/s | 68.1 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.02955 | Reg=0.00325 | acc=0.9531 | L2-Norm=18.022 | L2-Norm(final)=2.295 | 4484.0 samples/s | 70.1 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.03001 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.020 | L2-Norm(final)=2.295 | 4609.1 samples/s | 72.0 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.02969 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.017 | L2-Norm(final)=2.298 | 6247.2 samples/s | 97.6 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.02964 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.018 | L2-Norm(final)=2.299 | 1953.0 samples/s | 30.5 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.02968 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.019 | L2-Norm(final)=2.299 | 4596.5 samples/s | 71.8 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.03044 | Reg=0.00325 | acc=0.9688 | L2-Norm=18.016 | L2-Norm(final)=2.298 | 4407.6 samples/s | 68.9 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.02941 | Reg=0.00324 | acc=0.9531 | L2-Norm=18.013 | L2-Norm(final)=2.298 | 5520.6 samples/s | 86.3 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.02833 | Reg=0.00324 | acc=0.9688 | L2-Norm=18.009 | L2-Norm(final)=2.299 | 2032.2 samples/s | 31.8 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.02788 | Reg=0.00324 | acc=0.9844 | L2-Norm=18.007 | L2-Norm(final)=2.300 | 4485.7 samples/s | 70.1 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_0/client_state-step1500.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00100, len=1
[Step=1001 Epoch= 4.9] | Loss=0.04511 | Reg=0.00330 | acc=0.9844 | L2-Norm=18.154 | L2-Norm(final)=2.285 | 4593.5 samples/s | 71.8 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.02486 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.149 | L2-Norm(final)=2.289 | 4259.2 samples/s | 66.6 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.02786 | Reg=0.00329 | acc=0.9688 | L2-Norm=18.142 | L2-Norm(final)=2.287 | 4409.0 samples/s | 68.9 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.02987 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.135 | L2-Norm(final)=2.286 | 4490.8 samples/s | 70.2 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.03003 | Reg=0.00329 | acc=0.9688 | L2-Norm=18.131 | L2-Norm(final)=2.285 | 5751.4 samples/s | 89.9 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.02827 | Reg=0.00329 | acc=0.9531 | L2-Norm=18.130 | L2-Norm(final)=2.286 | 1918.4 samples/s | 30.0 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.02731 | Reg=0.00329 | acc=0.9688 | L2-Norm=18.130 | L2-Norm(final)=2.288 | 4602.9 samples/s | 71.9 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.02779 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.129 | L2-Norm(final)=2.290 | 4452.1 samples/s | 69.6 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.02707 | Reg=0.00329 | acc=0.9688 | L2-Norm=18.132 | L2-Norm(final)=2.292 | 5716.6 samples/s | 89.3 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.02650 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.134 | L2-Norm(final)=2.294 | 1966.0 samples/s | 30.7 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.02574 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.136 | L2-Norm(final)=2.295 | 4576.1 samples/s | 71.5 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_1/client_state-step1500.h5

Train client 2: client_asml1_2
Local layers training...
LR=0.00100, len=1
[Step=1001 Epoch= 4.9] | Loss=0.02068 | Reg=0.00335 | acc=0.9844 | L2-Norm=18.289 | L2-Norm(final)=2.282 | 4584.9 samples/s | 71.6 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.02592 | Reg=0.00335 | acc=0.9844 | L2-Norm=18.291 | L2-Norm(final)=2.289 | 4321.8 samples/s | 67.5 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.02912 | Reg=0.00335 | acc=0.9688 | L2-Norm=18.301 | L2-Norm(final)=2.290 | 4497.8 samples/s | 70.3 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.03038 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.317 | L2-Norm(final)=2.291 | 4530.7 samples/s | 70.8 steps/s
[Step=1200 Epoch= 5.8] | Loss=0.03154 | Reg=0.00336 | acc=0.9844 | L2-Norm=18.329 | L2-Norm(final)=2.292 | 5958.4 samples/s | 93.1 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.02982 | Reg=0.00336 | acc=0.9531 | L2-Norm=18.337 | L2-Norm(final)=2.294 | 1883.2 samples/s | 29.4 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.02850 | Reg=0.00336 | acc=0.9844 | L2-Norm=18.343 | L2-Norm(final)=2.296 | 4448.5 samples/s | 69.5 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.02799 | Reg=0.00337 | acc=0.9844 | L2-Norm=18.348 | L2-Norm(final)=2.299 | 4420.7 samples/s | 69.1 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.02853 | Reg=0.00337 | acc=0.9531 | L2-Norm=18.349 | L2-Norm(final)=2.301 | 5634.5 samples/s | 88.0 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.02767 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.350 | L2-Norm(final)=2.303 | 1997.2 samples/s | 31.2 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.02774 | Reg=0.00337 | acc=0.9844 | L2-Norm=18.352 | L2-Norm(final)=2.305 | 4358.7 samples/s | 68.1 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_2/client_state-step1500.h5

Train client 3: client_asml1_3
Local layers training...
LR=0.00100, len=1
[Step=1001 Epoch= 4.9] | Loss=0.01737 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.051 | L2-Norm(final)=2.343 | 4384.4 samples/s | 68.5 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.02329 | Reg=0.00325 | acc=0.9531 | L2-Norm=18.030 | L2-Norm(final)=2.344 | 4348.5 samples/s | 67.9 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.02316 | Reg=0.00325 | acc=0.9688 | L2-Norm=18.015 | L2-Norm(final)=2.346 | 4418.6 samples/s | 69.0 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.02442 | Reg=0.00324 | acc=0.9219 | L2-Norm=18.008 | L2-Norm(final)=2.350 | 4264.9 samples/s | 66.6 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.02959 | Reg=0.00324 | acc=0.9531 | L2-Norm=18.003 | L2-Norm(final)=2.351 | 5841.0 samples/s | 91.3 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.02976 | Reg=0.00324 | acc=0.9844 | L2-Norm=18.007 | L2-Norm(final)=2.349 | 1961.2 samples/s | 30.6 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.02851 | Reg=0.00324 | acc=0.9844 | L2-Norm=18.011 | L2-Norm(final)=2.351 | 4367.6 samples/s | 68.2 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.02811 | Reg=0.00325 | acc=0.9531 | L2-Norm=18.015 | L2-Norm(final)=2.355 | 4265.7 samples/s | 66.7 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.02787 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.015 | L2-Norm(final)=2.356 | 5589.8 samples/s | 87.3 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.02736 | Reg=0.00324 | acc=0.9844 | L2-Norm=18.014 | L2-Norm(final)=2.357 | 1988.0 samples/s | 31.1 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.02657 | Reg=0.00324 | acc=0.9688 | L2-Norm=18.011 | L2-Norm(final)=2.358 | 4423.4 samples/s | 69.1 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_3/client_state-step1500.h5

Train client 4: client_asml1_4
Local layers training...
LR=0.00100, len=1
[Step=1001 Epoch= 4.9] | Loss=0.00623 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.059 | L2-Norm(final)=2.291 | 4502.0 samples/s | 70.3 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.02266 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.068 | L2-Norm(final)=2.297 | 4380.8 samples/s | 68.4 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.02394 | Reg=0.00326 | acc=0.9688 | L2-Norm=18.068 | L2-Norm(final)=2.304 | 4400.0 samples/s | 68.7 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.02765 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.065 | L2-Norm(final)=2.306 | 4358.6 samples/s | 68.1 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.02868 | Reg=0.00326 | acc=0.9531 | L2-Norm=18.065 | L2-Norm(final)=2.307 | 6168.5 samples/s | 96.4 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.02845 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.064 | L2-Norm(final)=2.306 | 1875.3 samples/s | 29.3 steps/s
[Step=1300 Epoch= 6.4] | Loss=0.02731 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.061 | L2-Norm(final)=2.306 | 4305.2 samples/s | 67.3 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.02719 | Reg=0.00326 | acc=0.9531 | L2-Norm=18.059 | L2-Norm(final)=2.307 | 4591.6 samples/s | 71.7 steps/s
[Step=1400 Epoch= 6.9] | Loss=0.02678 | Reg=0.00326 | acc=0.9531 | L2-Norm=18.054 | L2-Norm(final)=2.308 | 6014.3 samples/s | 94.0 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.02633 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.050 | L2-Norm(final)=2.308 | 2014.5 samples/s | 31.5 steps/s
[Step=1500 Epoch= 7.4] | Loss=0.02532 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.045 | L2-Norm(final)=2.309 | 4659.6 samples/s | 72.8 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_4/client_state-step1500.h5

Train client 5: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=1001 Epoch= 9.5] | Loss=0.00001 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.249 | L2-Norm(final)=2.247 | 4432.4 samples/s | 69.3 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.00001 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.193 | L2-Norm(final)=2.253 | 3999.3 samples/s | 62.5 steps/s
[Step=1100 Epoch=10.4] | Loss=0.00001 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.138 | L2-Norm(final)=2.259 | 5861.4 samples/s | 91.6 steps/s
[Step=1150 Epoch=10.9] | Loss=0.00001 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.082 | L2-Norm(final)=2.265 | 1886.6 samples/s | 29.5 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00001 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.027 | L2-Norm(final)=2.272 | 5147.3 samples/s | 80.4 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00001 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.973 | L2-Norm(final)=2.279 | 1902.9 samples/s | 29.7 steps/s
[Step=1300 Epoch=12.3] | Loss=0.00001 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.918 | L2-Norm(final)=2.286 | 5224.2 samples/s | 81.6 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00001 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.864 | L2-Norm(final)=2.294 | 1993.6 samples/s | 31.2 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00001 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.810 | L2-Norm(final)=2.301 | 4756.2 samples/s | 74.3 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00001 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.756 | L2-Norm(final)=2.308 | 2070.2 samples/s | 32.3 steps/s
[Step=1500 Epoch=14.2] | Loss=0.00001 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.703 | L2-Norm(final)=2.316 | 4403.1 samples/s | 68.8 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_0/client_state-step1500.h5

Train client 6: client_iccad2012_1
Local layers training...
LR=0.00100, len=1
[Step=1001 Epoch= 9.5] | Loss=0.00001 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.297 | L2-Norm(final)=2.191 | 4294.8 samples/s | 67.1 steps/s
[Step=1050 Epoch=10.0] | Loss=0.00001 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.246 | L2-Norm(final)=2.194 | 4289.4 samples/s | 67.0 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00001 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.196 | L2-Norm(final)=2.197 | 5849.7 samples/s | 91.4 steps/s
[Step=1150 Epoch=10.9] | Loss=0.00001 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.145 | L2-Norm(final)=2.200 | 1902.8 samples/s | 29.7 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00001 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.095 | L2-Norm(final)=2.203 | 5366.6 samples/s | 83.9 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00001 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.044 | L2-Norm(final)=2.207 | 1942.8 samples/s | 30.4 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00001 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.994 | L2-Norm(final)=2.211 | 5070.9 samples/s | 79.2 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00001 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.945 | L2-Norm(final)=2.215 | 1979.8 samples/s | 30.9 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00001 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.896 | L2-Norm(final)=2.219 | 5011.1 samples/s | 78.3 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00001 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.846 | L2-Norm(final)=2.223 | 2045.2 samples/s | 32.0 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00001 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.798 | L2-Norm(final)=2.227 | 4461.3 samples/s | 69.7 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_1/client_state-step1500.h5

Train client 7: client_iccad2012_2
Local layers training...
LR=0.00100, len=1
[Step=1001 Epoch= 9.6] | Loss=0.00001 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.947 | L2-Norm(final)=2.185 | 4804.3 samples/s | 75.1 steps/s
[Step=1050 Epoch=10.0] | Loss=0.00001 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.894 | L2-Norm(final)=2.187 | 3847.2 samples/s | 60.1 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00001 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.842 | L2-Norm(final)=2.191 | 5627.0 samples/s | 87.9 steps/s
[Step=1150 Epoch=11.0] | Loss=0.00001 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.790 | L2-Norm(final)=2.195 | 1833.4 samples/s | 28.6 steps/s
[Step=1200 Epoch=11.5] | Loss=0.00001 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.739 | L2-Norm(final)=2.198 | 5510.9 samples/s | 86.1 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00001 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.688 | L2-Norm(final)=2.202 | 1937.3 samples/s | 30.3 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00001 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.637 | L2-Norm(final)=2.206 | 5357.5 samples/s | 83.7 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00001 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.587 | L2-Norm(final)=2.210 | 1962.5 samples/s | 30.7 steps/s
[Step=1400 Epoch=13.4] | Loss=0.00001 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.537 | L2-Norm(final)=2.214 | 4946.8 samples/s | 77.3 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00001 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.487 | L2-Norm(final)=2.217 | 2006.3 samples/s | 31.3 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00001 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.438 | L2-Norm(final)=2.221 | 4633.5 samples/s | 72.4 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_2/client_state-step1500.h5

Train client 8: client_iccad2012_3
Local layers training...
LR=0.00100, len=1
[Step=1001 Epoch= 9.4] | Loss=0.00000 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.412 | L2-Norm(final)=2.286 | 4210.8 samples/s | 65.8 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.00001 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.365 | L2-Norm(final)=2.291 | 4167.7 samples/s | 65.1 steps/s
[Step=1100 Epoch=10.4] | Loss=0.00001 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.316 | L2-Norm(final)=2.297 | 5900.8 samples/s | 92.2 steps/s
[Step=1150 Epoch=10.8] | Loss=0.00001 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.269 | L2-Norm(final)=2.303 | 1861.4 samples/s | 29.1 steps/s
[Step=1200 Epoch=11.3] | Loss=0.00001 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.222 | L2-Norm(final)=2.309 | 5253.5 samples/s | 82.1 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00001 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.175 | L2-Norm(final)=2.315 | 1954.0 samples/s | 30.5 steps/s
[Step=1300 Epoch=12.2] | Loss=0.00001 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.128 | L2-Norm(final)=2.321 | 4918.6 samples/s | 76.9 steps/s
[Step=1350 Epoch=12.7] | Loss=0.00001 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.082 | L2-Norm(final)=2.327 | 2002.7 samples/s | 31.3 steps/s
[Step=1400 Epoch=13.2] | Loss=0.00001 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.036 | L2-Norm(final)=2.333 | 4627.0 samples/s | 72.3 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00001 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.990 | L2-Norm(final)=2.339 | 2036.3 samples/s | 31.8 steps/s
[Step=1500 Epoch=14.1] | Loss=0.00001 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.944 | L2-Norm(final)=2.346 | 4280.2 samples/s | 66.9 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_3/client_state-step1500.h5

Train client 9: client_iccad2012_4
Local layers training...
LR=0.00100, len=1
[Step=1001 Epoch= 9.5] | Loss=0.00002 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.192 | L2-Norm(final)=2.166 | 4142.2 samples/s | 64.7 steps/s
[Step=1050 Epoch=10.0] | Loss=0.00002 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.144 | L2-Norm(final)=2.170 | 4348.3 samples/s | 67.9 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00002 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.095 | L2-Norm(final)=2.173 | 5948.0 samples/s | 92.9 steps/s
[Step=1150 Epoch=11.0] | Loss=0.00002 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.047 | L2-Norm(final)=2.177 | 1895.0 samples/s | 29.6 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00001 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.999 | L2-Norm(final)=2.182 | 5606.2 samples/s | 87.6 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00001 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.951 | L2-Norm(final)=2.187 | 1954.4 samples/s | 30.5 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00001 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.904 | L2-Norm(final)=2.192 | 5369.2 samples/s | 83.9 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00001 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.857 | L2-Norm(final)=2.197 | 1957.4 samples/s | 30.6 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00001 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.811 | L2-Norm(final)=2.202 | 4980.5 samples/s | 77.8 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00001 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.765 | L2-Norm(final)=2.208 | 2038.1 samples/s | 31.8 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00001 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.719 | L2-Norm(final)=2.214 | 4673.7 samples/s | 73.0 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_4/client_state-step1500.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.13379 | acc=0.9313 | tpr=0.9534 | fpr=0.1169 | 4264.7 samples/s | 16.7 steps/s
Avg test loss: 0.13984, Avg test acc: 0.92680, Avg tpr: 0.95011, Avg fpr: 0.12447, total FA: 971

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.16261 | acc=0.9223 | tpr=0.9372 | fpr=0.1100 | 4293.8 samples/s | 16.8 steps/s
Avg test loss: 0.16888, Avg test acc: 0.92127, Avg tpr: 0.93670, Avg fpr: 0.11268, total FA: 879

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.13868 | acc=0.9237 | tpr=0.9427 | fpr=0.1174 | 4432.3 samples/s | 17.3 steps/s
Avg test loss: 0.14128, Avg test acc: 0.92215, Avg tpr: 0.94107, Avg fpr: 0.11947, total FA: 932

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.14790 | acc=0.9238 | tpr=0.9518 | fpr=0.1370 | 4368.2 samples/s | 17.1 steps/s
Avg test loss: 0.15618, Avg test acc: 0.92187, Avg tpr: 0.95116, Avg fpr: 0.14255, total FA: 1112

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.14868 | acc=0.9260 | tpr=0.9449 | fpr=0.1150 | 4153.2 samples/s | 16.2 steps/s
Avg test loss: 0.15344, Avg test acc: 0.92471, Avg tpr: 0.94288, Avg fpr: 0.11524, total FA: 899

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.73162 | acc=0.3159 | tpr=0.0102 | fpr=0.0203 | 4313.2 samples/s | 16.8 steps/s
Avg test loss: 5.75726, Avg test acc: 0.31341, Avg tpr: 0.01055, Avg fpr: 0.02051, total FA: 160

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.70081 | acc=0.3104 | tpr=0.0180 | fpr=0.0548 | 4373.0 samples/s | 17.1 steps/s
Avg test loss: 4.71980, Avg test acc: 0.30876, Avg tpr: 0.01760, Avg fpr: 0.05089, total FA: 397

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.24466 | acc=0.3151 | tpr=0.0237 | fpr=0.0523 | 4282.6 samples/s | 16.7 steps/s
Avg test loss: 5.27051, Avg test acc: 0.31236, Avg tpr: 0.02366, Avg fpr: 0.05269, total FA: 411

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.11800 | acc=0.3140 | tpr=0.0186 | fpr=0.0446 | 4203.8 samples/s | 16.4 steps/s
Avg test loss: 5.13835, Avg test acc: 0.31309, Avg tpr: 0.02052, Avg fpr: 0.04346, total FA: 339

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.68336 | acc=0.3149 | tpr=0.0103 | fpr=0.0235 | 3992.5 samples/s | 15.6 steps/s
Avg test loss: 5.69785, Avg test acc: 0.31248, Avg tpr: 0.01020, Avg fpr: 0.02269, total FA: 177

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.48519 | acc=0.1312 | tpr=0.8894 | fpr=0.8825 | 4062.5 samples/s | 15.9 steps/s
[Step= 100] | Loss=3.47444 | acc=0.1329 | tpr=0.8955 | fpr=0.8813 | 7360.5 samples/s | 28.8 steps/s
[Step= 150] | Loss=3.48140 | acc=0.1317 | tpr=0.8790 | fpr=0.8820 | 7504.8 samples/s | 29.3 steps/s
[Step= 200] | Loss=3.47810 | acc=0.1324 | tpr=0.8863 | fpr=0.8813 | 7829.3 samples/s | 30.6 steps/s
[Step= 250] | Loss=3.48375 | acc=0.1324 | tpr=0.8891 | fpr=0.8814 | 7672.8 samples/s | 30.0 steps/s
[Step= 300] | Loss=3.48305 | acc=0.1318 | tpr=0.8836 | fpr=0.8819 | 7087.0 samples/s | 27.7 steps/s
[Step= 350] | Loss=3.48324 | acc=0.1316 | tpr=0.8842 | fpr=0.8821 | 7732.1 samples/s | 30.2 steps/s
[Step= 400] | Loss=3.48349 | acc=0.1319 | tpr=0.8846 | fpr=0.8818 | 7536.9 samples/s | 29.4 steps/s
[Step= 450] | Loss=3.48270 | acc=0.1320 | tpr=0.8832 | fpr=0.8816 | 7666.8 samples/s | 29.9 steps/s
[Step= 500] | Loss=3.48597 | acc=0.1318 | tpr=0.8846 | fpr=0.8817 | 7206.7 samples/s | 28.2 steps/s
[Step= 550] | Loss=3.48388 | acc=0.1321 | tpr=0.8862 | fpr=0.8816 | 14305.4 samples/s | 55.9 steps/s
Avg test loss: 3.48459, Avg test acc: 0.13196, Avg tpr: 0.88629, Avg fpr: 0.88176, total FA: 122430

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.42975 | acc=0.1427 | tpr=0.8628 | fpr=0.8703 | 4245.0 samples/s | 16.6 steps/s
[Step= 100] | Loss=3.39959 | acc=0.1443 | tpr=0.8486 | fpr=0.8689 | 7602.3 samples/s | 29.7 steps/s
[Step= 150] | Loss=3.41905 | acc=0.1425 | tpr=0.8386 | fpr=0.8703 | 7827.7 samples/s | 30.6 steps/s
[Step= 200] | Loss=3.41377 | acc=0.1429 | tpr=0.8328 | fpr=0.8697 | 7068.1 samples/s | 27.6 steps/s
[Step= 250] | Loss=3.41403 | acc=0.1432 | tpr=0.8314 | fpr=0.8693 | 7252.4 samples/s | 28.3 steps/s
[Step= 300] | Loss=3.41238 | acc=0.1427 | tpr=0.8233 | fpr=0.8697 | 7596.5 samples/s | 29.7 steps/s
[Step= 350] | Loss=3.41064 | acc=0.1424 | tpr=0.8234 | fpr=0.8700 | 7329.7 samples/s | 28.6 steps/s
[Step= 400] | Loss=3.40848 | acc=0.1426 | tpr=0.8321 | fpr=0.8700 | 7362.4 samples/s | 28.8 steps/s
[Step= 450] | Loss=3.40922 | acc=0.1425 | tpr=0.8330 | fpr=0.8700 | 7568.7 samples/s | 29.6 steps/s
[Step= 500] | Loss=3.41175 | acc=0.1421 | tpr=0.8361 | fpr=0.8704 | 7137.1 samples/s | 27.9 steps/s
[Step= 550] | Loss=3.41062 | acc=0.1423 | tpr=0.8368 | fpr=0.8703 | 12790.1 samples/s | 50.0 steps/s
Avg test loss: 3.41125, Avg test acc: 0.14213, Avg tpr: 0.83716, Avg fpr: 0.87051, total FA: 120868

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=2.62524 | acc=0.1629 | tpr=0.7965 | fpr=0.8485 | 4050.8 samples/s | 15.8 steps/s
[Step= 100] | Loss=2.60620 | acc=0.1679 | tpr=0.7996 | fpr=0.8439 | 7911.1 samples/s | 30.9 steps/s
[Step= 150] | Loss=2.61404 | acc=0.1663 | tpr=0.8012 | fpr=0.8454 | 8160.2 samples/s | 31.9 steps/s
[Step= 200] | Loss=2.60827 | acc=0.1670 | tpr=0.7891 | fpr=0.8443 | 7506.5 samples/s | 29.3 steps/s
[Step= 250] | Loss=2.61114 | acc=0.1677 | tpr=0.7930 | fpr=0.8437 | 7718.6 samples/s | 30.2 steps/s
[Step= 300] | Loss=2.60868 | acc=0.1676 | tpr=0.7905 | fpr=0.8438 | 8025.9 samples/s | 31.4 steps/s
[Step= 350] | Loss=2.60524 | acc=0.1673 | tpr=0.7909 | fpr=0.8440 | 7678.2 samples/s | 30.0 steps/s
[Step= 400] | Loss=2.60735 | acc=0.1675 | tpr=0.7921 | fpr=0.8439 | 7543.6 samples/s | 29.5 steps/s
[Step= 450] | Loss=2.60760 | acc=0.1669 | tpr=0.7911 | fpr=0.8444 | 8061.4 samples/s | 31.5 steps/s
[Step= 500] | Loss=2.61065 | acc=0.1664 | tpr=0.7925 | fpr=0.8449 | 7668.7 samples/s | 30.0 steps/s
[Step= 550] | Loss=2.61108 | acc=0.1666 | tpr=0.7915 | fpr=0.8447 | 13997.4 samples/s | 54.7 steps/s
Avg test loss: 2.61190, Avg test acc: 0.16651, Avg tpr: 0.79160, Avg fpr: 0.84485, total FA: 117306

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=3.53524 | acc=0.1374 | tpr=0.7434 | fpr=0.8735 | 4095.0 samples/s | 16.0 steps/s
[Step= 100] | Loss=3.52612 | acc=0.1373 | tpr=0.7377 | fpr=0.8739 | 8692.4 samples/s | 34.0 steps/s
[Step= 150] | Loss=3.52560 | acc=0.1374 | tpr=0.7277 | fpr=0.8735 | 7792.6 samples/s | 30.4 steps/s
[Step= 200] | Loss=3.51586 | acc=0.1385 | tpr=0.7257 | fpr=0.8722 | 7775.9 samples/s | 30.4 steps/s
[Step= 250] | Loss=3.52132 | acc=0.1392 | tpr=0.7354 | fpr=0.8717 | 7462.0 samples/s | 29.1 steps/s
[Step= 300] | Loss=3.51678 | acc=0.1387 | tpr=0.7324 | fpr=0.8721 | 7620.7 samples/s | 29.8 steps/s
[Step= 350] | Loss=3.51654 | acc=0.1388 | tpr=0.7370 | fpr=0.8721 | 7757.3 samples/s | 30.3 steps/s
[Step= 400] | Loss=3.51721 | acc=0.1390 | tpr=0.7418 | fpr=0.8719 | 8011.3 samples/s | 31.3 steps/s
[Step= 450] | Loss=3.51762 | acc=0.1386 | tpr=0.7405 | fpr=0.8723 | 8306.1 samples/s | 32.4 steps/s
[Step= 500] | Loss=3.51829 | acc=0.1388 | tpr=0.7449 | fpr=0.8722 | 7182.9 samples/s | 28.1 steps/s
[Step= 550] | Loss=3.51967 | acc=0.1388 | tpr=0.7473 | fpr=0.8723 | 14036.5 samples/s | 54.8 steps/s
Avg test loss: 3.51967, Avg test acc: 0.13864, Avg tpr: 0.74842, Avg fpr: 0.87244, total FA: 121137

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.05871 | acc=0.1234 | tpr=0.7965 | fpr=0.8887 | 4063.2 samples/s | 15.9 steps/s
[Step= 100] | Loss=4.03666 | acc=0.1265 | tpr=0.7910 | fpr=0.8859 | 8040.7 samples/s | 31.4 steps/s
[Step= 150] | Loss=4.04118 | acc=0.1254 | tpr=0.7594 | fpr=0.8862 | 7953.9 samples/s | 31.1 steps/s
[Step= 200] | Loss=4.03859 | acc=0.1255 | tpr=0.7563 | fpr=0.8860 | 7973.0 samples/s | 31.1 steps/s
[Step= 250] | Loss=4.04598 | acc=0.1252 | tpr=0.7581 | fpr=0.8864 | 7873.0 samples/s | 30.8 steps/s
[Step= 300] | Loss=4.04985 | acc=0.1240 | tpr=0.7564 | fpr=0.8875 | 7276.9 samples/s | 28.4 steps/s
[Step= 350] | Loss=4.05096 | acc=0.1240 | tpr=0.7621 | fpr=0.8876 | 7478.2 samples/s | 29.2 steps/s
[Step= 400] | Loss=4.04802 | acc=0.1241 | tpr=0.7697 | fpr=0.8877 | 7567.0 samples/s | 29.6 steps/s
[Step= 450] | Loss=4.05051 | acc=0.1238 | tpr=0.7736 | fpr=0.8880 | 8088.4 samples/s | 31.6 steps/s
[Step= 500] | Loss=4.05199 | acc=0.1236 | tpr=0.7753 | fpr=0.8882 | 7340.3 samples/s | 28.7 steps/s
[Step= 550] | Loss=4.05245 | acc=0.1235 | tpr=0.7811 | fpr=0.8884 | 14347.2 samples/s | 56.0 steps/s
Avg test loss: 4.05311, Avg test acc: 0.12343, Avg tpr: 0.78170, Avg fpr: 0.88853, total FA: 123371

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.06569 | acc=0.9781 | tpr=0.8540 | fpr=0.0196 | 4085.5 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.06534 | acc=0.9779 | tpr=0.8806 | fpr=0.0203 | 7886.0 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.06753 | acc=0.9776 | tpr=0.8919 | fpr=0.0208 | 7740.4 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.06905 | acc=0.9775 | tpr=0.9005 | fpr=0.0211 | 7356.4 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.06889 | acc=0.9775 | tpr=0.9031 | fpr=0.0211 | 7445.6 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.06954 | acc=0.9776 | tpr=0.9018 | fpr=0.0210 | 7411.4 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.06944 | acc=0.9776 | tpr=0.9023 | fpr=0.0210 | 7242.8 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.07005 | acc=0.9774 | tpr=0.9032 | fpr=0.0213 | 7777.5 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.07158 | acc=0.9772 | tpr=0.8992 | fpr=0.0214 | 7873.6 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.07096 | acc=0.9773 | tpr=0.8991 | fpr=0.0213 | 7426.9 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.07027 | acc=0.9775 | tpr=0.8985 | fpr=0.0210 | 13024.9 samples/s | 50.9 steps/s
Avg test loss: 0.07011, Avg test acc: 0.97754, Avg tpr: 0.89857, Avg fpr: 0.02102, total FA: 2919

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.04093 | acc=0.9854 | tpr=0.8407 | fpr=0.0120 | 4146.2 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.04042 | acc=0.9848 | tpr=0.8550 | fpr=0.0128 | 7569.0 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.04153 | acc=0.9844 | tpr=0.8588 | fpr=0.0133 | 7548.9 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.04272 | acc=0.9840 | tpr=0.8601 | fpr=0.0137 | 7327.0 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.04252 | acc=0.9843 | tpr=0.8629 | fpr=0.0134 | 7948.4 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.04247 | acc=0.9842 | tpr=0.8553 | fpr=0.0134 | 7417.0 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.04237 | acc=0.9843 | tpr=0.8585 | fpr=0.0134 | 7861.7 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.04295 | acc=0.9842 | tpr=0.8578 | fpr=0.0135 | 8148.8 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.04325 | acc=0.9842 | tpr=0.8559 | fpr=0.0135 | 7535.5 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.04292 | acc=0.9842 | tpr=0.8573 | fpr=0.0135 | 7634.6 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.04259 | acc=0.9844 | tpr=0.8559 | fpr=0.0133 | 15341.0 samples/s | 59.9 steps/s
Avg test loss: 0.04253, Avg test acc: 0.98437, Avg tpr: 0.85658, Avg fpr: 0.01331, total FA: 1848

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.04803 | acc=0.9824 | tpr=0.9159 | fpr=0.0164 | 4047.0 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.04661 | acc=0.9827 | tpr=0.9147 | fpr=0.0161 | 7778.5 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.04808 | acc=0.9821 | tpr=0.9078 | fpr=0.0165 | 8030.8 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.04915 | acc=0.9819 | tpr=0.9115 | fpr=0.0169 | 7738.1 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.04869 | acc=0.9819 | tpr=0.9100 | fpr=0.0168 | 7792.9 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.04868 | acc=0.9818 | tpr=0.9076 | fpr=0.0168 | 7651.7 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.04886 | acc=0.9817 | tpr=0.9086 | fpr=0.0169 | 7448.6 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.04918 | acc=0.9817 | tpr=0.9086 | fpr=0.0170 | 8626.1 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.04969 | acc=0.9814 | tpr=0.9065 | fpr=0.0173 | 7203.9 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.04940 | acc=0.9815 | tpr=0.9075 | fpr=0.0172 | 7369.7 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.04900 | acc=0.9816 | tpr=0.9065 | fpr=0.0170 | 13798.3 samples/s | 53.9 steps/s
Avg test loss: 0.04890, Avg test acc: 0.98166, Avg tpr: 0.90689, Avg fpr: 0.01698, total FA: 2358

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.06168 | acc=0.9815 | tpr=0.8584 | fpr=0.0163 | 3950.7 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.06130 | acc=0.9818 | tpr=0.8763 | fpr=0.0162 | 7291.0 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.06418 | acc=0.9812 | tpr=0.8775 | fpr=0.0168 | 7547.5 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.06581 | acc=0.9810 | tpr=0.8842 | fpr=0.0172 | 7260.9 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.06447 | acc=0.9813 | tpr=0.8821 | fpr=0.0169 | 7660.9 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.06547 | acc=0.9811 | tpr=0.8793 | fpr=0.0171 | 7665.3 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.06509 | acc=0.9812 | tpr=0.8842 | fpr=0.0171 | 8127.7 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.06514 | acc=0.9810 | tpr=0.8835 | fpr=0.0172 | 7358.4 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.06643 | acc=0.9807 | tpr=0.8773 | fpr=0.0175 | 7816.0 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.06605 | acc=0.9808 | tpr=0.8793 | fpr=0.0174 | 7246.8 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.06511 | acc=0.9810 | tpr=0.8786 | fpr=0.0172 | 14640.9 samples/s | 57.2 steps/s
Avg test loss: 0.06503, Avg test acc: 0.98098, Avg tpr: 0.87876, Avg fpr: 0.01716, total FA: 2383

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.06119 | acc=0.9803 | tpr=0.8673 | fpr=0.0177 | 4165.7 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.06224 | acc=0.9801 | tpr=0.8870 | fpr=0.0182 | 8120.5 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.06399 | acc=0.9800 | tpr=0.8905 | fpr=0.0184 | 8318.9 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.06444 | acc=0.9797 | tpr=0.8962 | fpr=0.0187 | 7386.2 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.06438 | acc=0.9799 | tpr=0.8961 | fpr=0.0185 | 7258.7 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.06544 | acc=0.9795 | tpr=0.8895 | fpr=0.0189 | 7756.2 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.06558 | acc=0.9794 | tpr=0.8929 | fpr=0.0191 | 8226.3 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.06600 | acc=0.9792 | tpr=0.8911 | fpr=0.0192 | 7951.1 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.06762 | acc=0.9788 | tpr=0.8880 | fpr=0.0195 | 7444.9 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.06673 | acc=0.9790 | tpr=0.8868 | fpr=0.0193 | 7260.3 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.06615 | acc=0.9792 | tpr=0.8854 | fpr=0.0191 | 14471.8 samples/s | 56.5 steps/s
Avg test loss: 0.06610, Avg test acc: 0.97919, Avg tpr: 0.88550, Avg fpr: 0.01911, total FA: 2653

server round 3/10

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=1501 Epoch= 7.3] | Loss=0.00205 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.977 | L2-Norm(final)=2.313 | 4351.1 samples/s | 68.0 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.01625 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.970 | L2-Norm(final)=2.317 | 4703.8 samples/s | 73.5 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.01913 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.965 | L2-Norm(final)=2.318 | 4583.8 samples/s | 71.6 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.01905 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.959 | L2-Norm(final)=2.319 | 4561.4 samples/s | 71.3 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.01952 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.953 | L2-Norm(final)=2.320 | 6184.0 samples/s | 96.6 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.01879 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.946 | L2-Norm(final)=2.322 | 1960.1 samples/s | 30.6 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.01825 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.940 | L2-Norm(final)=2.324 | 4644.6 samples/s | 72.6 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.01819 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.934 | L2-Norm(final)=2.326 | 4498.1 samples/s | 70.3 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.01748 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.927 | L2-Norm(final)=2.328 | 5421.9 samples/s | 84.7 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.01636 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.920 | L2-Norm(final)=2.331 | 1990.8 samples/s | 31.1 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.01608 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.912 | L2-Norm(final)=2.333 | 4599.1 samples/s | 71.9 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_0/client_state-step2000.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00100, len=1
[Step=1501 Epoch= 7.3] | Loss=0.00534 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.145 | L2-Norm(final)=2.310 | 4549.7 samples/s | 71.1 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.02012 | Reg=0.00329 | acc=0.9531 | L2-Norm=18.135 | L2-Norm(final)=2.306 | 4442.0 samples/s | 69.4 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.02401 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.131 | L2-Norm(final)=2.304 | 4732.5 samples/s | 73.9 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.02134 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.130 | L2-Norm(final)=2.305 | 4364.9 samples/s | 68.2 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.02119 | Reg=0.00329 | acc=0.9688 | L2-Norm=18.129 | L2-Norm(final)=2.305 | 6004.3 samples/s | 93.8 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.02001 | Reg=0.00329 | acc=0.9688 | L2-Norm=18.128 | L2-Norm(final)=2.306 | 1898.9 samples/s | 29.7 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.01999 | Reg=0.00329 | acc=0.9531 | L2-Norm=18.125 | L2-Norm(final)=2.307 | 4279.5 samples/s | 66.9 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.02094 | Reg=0.00328 | acc=0.9375 | L2-Norm=18.122 | L2-Norm(final)=2.307 | 4525.7 samples/s | 70.7 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.02103 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.120 | L2-Norm(final)=2.306 | 5534.6 samples/s | 86.5 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.02045 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.120 | L2-Norm(final)=2.307 | 1978.1 samples/s | 30.9 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.01980 | Reg=0.00328 | acc=0.9844 | L2-Norm=18.117 | L2-Norm(final)=2.307 | 4599.0 samples/s | 71.9 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_1/client_state-step2000.h5

Train client 2: client_asml1_2
Local layers training...
LR=0.00100, len=1
[Step=1501 Epoch= 7.3] | Loss=0.01937 | Reg=0.00337 | acc=0.9688 | L2-Norm=18.363 | L2-Norm(final)=2.316 | 4525.5 samples/s | 70.7 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.01590 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.368 | L2-Norm(final)=2.325 | 4339.4 samples/s | 67.8 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.01522 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.368 | L2-Norm(final)=2.331 | 4585.4 samples/s | 71.6 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.01734 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.366 | L2-Norm(final)=2.335 | 4588.5 samples/s | 71.7 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.01849 | Reg=0.00337 | acc=0.9844 | L2-Norm=18.363 | L2-Norm(final)=2.338 | 5762.5 samples/s | 90.0 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.01941 | Reg=0.00337 | acc=0.9844 | L2-Norm=18.363 | L2-Norm(final)=2.339 | 1923.9 samples/s | 30.1 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.01954 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.363 | L2-Norm(final)=2.339 | 4401.2 samples/s | 68.8 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.01940 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.360 | L2-Norm(final)=2.339 | 4334.5 samples/s | 67.7 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.02035 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.357 | L2-Norm(final)=2.338 | 5439.2 samples/s | 85.0 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.02040 | Reg=0.00337 | acc=0.9844 | L2-Norm=18.356 | L2-Norm(final)=2.337 | 1932.3 samples/s | 30.2 steps/s
[Step=2000 Epoch= 9.7] | Loss=0.02031 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.356 | L2-Norm(final)=2.335 | 4296.8 samples/s | 67.1 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_2/client_state-step2000.h5

Train client 3: client_asml1_3
Local layers training...
LR=0.00100, len=1
[Step=1501 Epoch= 7.3] | Loss=0.00274 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.975 | L2-Norm(final)=2.362 | 4514.5 samples/s | 70.5 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.01773 | Reg=0.00323 | acc=0.9375 | L2-Norm=17.974 | L2-Norm(final)=2.365 | 4479.1 samples/s | 70.0 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.01837 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.968 | L2-Norm(final)=2.367 | 4797.5 samples/s | 75.0 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.01970 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.961 | L2-Norm(final)=2.368 | 4513.9 samples/s | 70.5 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.02070 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.958 | L2-Norm(final)=2.369 | 6098.8 samples/s | 95.3 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.02105 | Reg=0.00322 | acc=0.9688 | L2-Norm=17.958 | L2-Norm(final)=2.369 | 1912.8 samples/s | 29.9 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.02038 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.954 | L2-Norm(final)=2.369 | 4268.0 samples/s | 66.7 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.02018 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.951 | L2-Norm(final)=2.370 | 4644.6 samples/s | 72.6 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.02099 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.948 | L2-Norm(final)=2.370 | 5536.8 samples/s | 86.5 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.02086 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.946 | L2-Norm(final)=2.371 | 1974.9 samples/s | 30.9 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.02043 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.946 | L2-Norm(final)=2.372 | 4646.8 samples/s | 72.6 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_3/client_state-step2000.h5

Train client 4: client_asml1_4
Local layers training...
LR=0.00100, len=1
[Step=1501 Epoch= 7.4] | Loss=0.00388 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.002 | L2-Norm(final)=2.324 | 4357.4 samples/s | 68.1 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.02193 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.010 | L2-Norm(final)=2.330 | 4510.1 samples/s | 70.5 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.02156 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.017 | L2-Norm(final)=2.332 | 4181.9 samples/s | 65.3 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.02134 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.022 | L2-Norm(final)=2.333 | 4249.6 samples/s | 66.4 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.02225 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.025 | L2-Norm(final)=2.333 | 6021.6 samples/s | 94.1 steps/s
[Step=1750 Epoch= 8.6] | Loss=0.02199 | Reg=0.00325 | acc=0.9688 | L2-Norm=18.030 | L2-Norm(final)=2.335 | 1875.9 samples/s | 29.3 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.02140 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.036 | L2-Norm(final)=2.336 | 4265.1 samples/s | 66.6 steps/s
[Step=1850 Epoch= 9.1] | Loss=0.02087 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.041 | L2-Norm(final)=2.339 | 4595.5 samples/s | 71.8 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.02108 | Reg=0.00326 | acc=0.9688 | L2-Norm=18.044 | L2-Norm(final)=2.340 | 5847.9 samples/s | 91.4 steps/s
[Step=1950 Epoch= 9.6] | Loss=0.02077 | Reg=0.00326 | acc=0.9688 | L2-Norm=18.047 | L2-Norm(final)=2.341 | 1986.3 samples/s | 31.0 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.02091 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.048 | L2-Norm(final)=2.341 | 4495.5 samples/s | 70.2 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_4/client_state-step2000.h5

Train client 5: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=1501 Epoch=14.2] | Loss=0.00000 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.171 | L2-Norm(final)=2.393 | 4013.5 samples/s | 62.7 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00001 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.120 | L2-Norm(final)=2.401 | 3892.2 samples/s | 60.8 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00001 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.069 | L2-Norm(final)=2.410 | 5679.3 samples/s | 88.7 steps/s
[Step=1650 Epoch=15.6] | Loss=0.00001 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.018 | L2-Norm(final)=2.417 | 1813.0 samples/s | 28.3 steps/s
[Step=1700 Epoch=16.1] | Loss=0.00001 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.967 | L2-Norm(final)=2.425 | 5491.4 samples/s | 85.8 steps/s
[Step=1750 Epoch=16.6] | Loss=0.00001 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.916 | L2-Norm(final)=2.433 | 1915.4 samples/s | 29.9 steps/s
[Step=1800 Epoch=17.1] | Loss=0.00001 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.866 | L2-Norm(final)=2.442 | 5090.3 samples/s | 79.5 steps/s
[Step=1850 Epoch=17.5] | Loss=0.00000 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.816 | L2-Norm(final)=2.450 | 1945.7 samples/s | 30.4 steps/s
[Step=1900 Epoch=18.0] | Loss=0.00001 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.765 | L2-Norm(final)=2.459 | 4888.3 samples/s | 76.4 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00001 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.716 | L2-Norm(final)=2.467 | 2026.6 samples/s | 31.7 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00000 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.667 | L2-Norm(final)=2.476 | 4533.2 samples/s | 70.8 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_0/client_state-step2000.h5

Train client 6: client_iccad2012_1
Local layers training...
LR=0.00100, len=1
[Step=1501 Epoch=14.3] | Loss=0.00000 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.310 | L2-Norm(final)=2.274 | 4018.0 samples/s | 62.8 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00001 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.263 | L2-Norm(final)=2.280 | 3823.1 samples/s | 59.7 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00001 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.216 | L2-Norm(final)=2.285 | 5574.3 samples/s | 87.1 steps/s
[Step=1650 Epoch=15.7] | Loss=0.00001 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.169 | L2-Norm(final)=2.291 | 1829.1 samples/s | 28.6 steps/s
[Step=1700 Epoch=16.2] | Loss=0.00001 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.122 | L2-Norm(final)=2.296 | 5300.4 samples/s | 82.8 steps/s
[Step=1750 Epoch=16.6] | Loss=0.00001 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.076 | L2-Norm(final)=2.303 | 1903.6 samples/s | 29.7 steps/s
[Step=1800 Epoch=17.1] | Loss=0.00001 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.029 | L2-Norm(final)=2.309 | 5167.8 samples/s | 80.7 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00001 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.983 | L2-Norm(final)=2.316 | 1944.4 samples/s | 30.4 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00001 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.936 | L2-Norm(final)=2.323 | 4634.1 samples/s | 72.4 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00001 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.890 | L2-Norm(final)=2.331 | 1942.7 samples/s | 30.4 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00001 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.845 | L2-Norm(final)=2.338 | 4176.0 samples/s | 65.2 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_1/client_state-step2000.h5

Train client 7: client_iccad2012_2
Local layers training...
LR=0.00100, len=1
[Step=1501 Epoch=14.3] | Loss=0.00001 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.946 | L2-Norm(final)=2.262 | 4379.8 samples/s | 68.4 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00001 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.900 | L2-Norm(final)=2.267 | 4029.2 samples/s | 63.0 steps/s
[Step=1600 Epoch=15.3] | Loss=0.00001 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.852 | L2-Norm(final)=2.273 | 6009.1 samples/s | 93.9 steps/s
[Step=1650 Epoch=15.8] | Loss=0.00001 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.805 | L2-Norm(final)=2.279 | 1960.8 samples/s | 30.6 steps/s
[Step=1700 Epoch=16.2] | Loss=0.00001 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.759 | L2-Norm(final)=2.285 | 5626.6 samples/s | 87.9 steps/s
[Step=1750 Epoch=16.7] | Loss=0.00001 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.712 | L2-Norm(final)=2.292 | 1831.6 samples/s | 28.6 steps/s
[Step=1800 Epoch=17.2] | Loss=0.00001 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.666 | L2-Norm(final)=2.298 | 5147.9 samples/s | 80.4 steps/s
[Step=1850 Epoch=17.7] | Loss=0.00001 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.620 | L2-Norm(final)=2.306 | 1955.4 samples/s | 30.6 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00001 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.574 | L2-Norm(final)=2.314 | 4766.3 samples/s | 74.5 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00001 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.528 | L2-Norm(final)=2.322 | 1963.5 samples/s | 30.7 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00001 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.482 | L2-Norm(final)=2.331 | 4617.8 samples/s | 72.2 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_2/client_state-step2000.h5

Train client 8: client_iccad2012_3
Local layers training...
LR=0.00100, len=1
[Step=1501 Epoch=14.1] | Loss=0.00000 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.490 | L2-Norm(final)=2.409 | 4127.4 samples/s | 64.5 steps/s
[Step=1550 Epoch=14.6] | Loss=0.00001 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.446 | L2-Norm(final)=2.416 | 4005.4 samples/s | 62.6 steps/s
[Step=1600 Epoch=15.1] | Loss=0.00001 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.402 | L2-Norm(final)=2.422 | 5910.4 samples/s | 92.4 steps/s
[Step=1650 Epoch=15.5] | Loss=0.00001 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.359 | L2-Norm(final)=2.429 | 1875.1 samples/s | 29.3 steps/s
[Step=1700 Epoch=16.0] | Loss=0.00001 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.315 | L2-Norm(final)=2.435 | 4948.0 samples/s | 77.3 steps/s
[Step=1750 Epoch=16.5] | Loss=0.00001 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.271 | L2-Norm(final)=2.442 | 1975.2 samples/s | 30.9 steps/s
[Step=1800 Epoch=17.0] | Loss=0.00001 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.228 | L2-Norm(final)=2.449 | 4712.6 samples/s | 73.6 steps/s
[Step=1850 Epoch=17.4] | Loss=0.00001 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.185 | L2-Norm(final)=2.456 | 2017.0 samples/s | 31.5 steps/s
[Step=1900 Epoch=17.9] | Loss=0.00001 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.142 | L2-Norm(final)=2.463 | 4457.1 samples/s | 69.6 steps/s
[Step=1950 Epoch=18.4] | Loss=0.00001 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.099 | L2-Norm(final)=2.470 | 2057.4 samples/s | 32.1 steps/s
[Step=2000 Epoch=18.8] | Loss=0.00001 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.056 | L2-Norm(final)=2.478 | 4056.4 samples/s | 63.4 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_3/client_state-step2000.h5

Train client 9: client_iccad2012_4
Local layers training...
LR=0.00100, len=1
[Step=1501 Epoch=14.3] | Loss=0.00000 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.262 | L2-Norm(final)=2.277 | 3836.6 samples/s | 59.9 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00001 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.219 | L2-Norm(final)=2.283 | 3965.1 samples/s | 62.0 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00001 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.175 | L2-Norm(final)=2.290 | 5461.1 samples/s | 85.3 steps/s
[Step=1650 Epoch=15.7] | Loss=0.00001 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.132 | L2-Norm(final)=2.299 | 1790.2 samples/s | 28.0 steps/s
[Step=1700 Epoch=16.2] | Loss=0.00001 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.089 | L2-Norm(final)=2.307 | 5308.9 samples/s | 83.0 steps/s
[Step=1750 Epoch=16.7] | Loss=0.00001 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.046 | L2-Norm(final)=2.315 | 1893.9 samples/s | 29.6 steps/s
[Step=1800 Epoch=17.2] | Loss=0.00001 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.004 | L2-Norm(final)=2.324 | 5110.3 samples/s | 79.8 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00001 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.961 | L2-Norm(final)=2.333 | 1949.2 samples/s | 30.5 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00001 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.919 | L2-Norm(final)=2.342 | 4662.7 samples/s | 72.9 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00001 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.877 | L2-Norm(final)=2.350 | 1898.4 samples/s | 29.7 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00001 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.835 | L2-Norm(final)=2.359 | 4215.7 samples/s | 65.9 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_4/client_state-step2000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.16524 | acc=0.9314 | tpr=0.9491 | fpr=0.1070 | 3985.2 samples/s | 15.6 steps/s
Avg test loss: 0.17063, Avg test acc: 0.92952, Avg tpr: 0.94626, Avg fpr: 0.10729, total FA: 837

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.19718 | acc=0.9211 | tpr=0.9692 | fpr=0.1833 | 4045.0 samples/s | 15.8 steps/s
Avg test loss: 0.19803, Avg test acc: 0.92255, Avg tpr: 0.96882, Avg fpr: 0.17921, total FA: 1398

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.17327 | acc=0.9188 | tpr=0.9232 | fpr=0.0907 | 4011.6 samples/s | 15.7 steps/s
Avg test loss: 0.17393, Avg test acc: 0.91834, Avg tpr: 0.92236, Avg fpr: 0.09050, total FA: 706

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.18292 | acc=0.9248 | tpr=0.9580 | fpr=0.1472 | 4106.9 samples/s | 16.0 steps/s
Avg test loss: 0.18647, Avg test acc: 0.92391, Avg tpr: 0.95809, Avg fpr: 0.15126, total FA: 1180

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.15385 | acc=0.9216 | tpr=0.9267 | fpr=0.0897 | 3973.3 samples/s | 15.5 steps/s
Avg test loss: 0.15771, Avg test acc: 0.92027, Avg tpr: 0.92539, Avg fpr: 0.09101, total FA: 710

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.10029 | acc=0.3162 | tpr=0.0082 | fpr=0.0151 | 4183.4 samples/s | 16.3 steps/s
Avg test loss: 6.12800, Avg test acc: 0.31341, Avg tpr: 0.00804, Avg fpr: 0.01500, total FA: 117

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.94380 | acc=0.3122 | tpr=0.0157 | fpr=0.0441 | 4046.0 samples/s | 15.8 steps/s
Avg test loss: 4.96526, Avg test acc: 0.30968, Avg tpr: 0.01457, Avg fpr: 0.04128, total FA: 322

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.42166 | acc=0.3158 | tpr=0.0193 | fpr=0.0404 | 4426.1 samples/s | 17.3 steps/s
Avg test loss: 5.44955, Avg test acc: 0.31329, Avg tpr: 0.01918, Avg fpr: 0.03987, total FA: 311

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.14365 | acc=0.3136 | tpr=0.0163 | fpr=0.0409 | 3381.0 samples/s | 13.2 steps/s
Avg test loss: 5.16453, Avg test acc: 0.31297, Avg tpr: 0.01813, Avg fpr: 0.03858, total FA: 301

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.77585 | acc=0.3151 | tpr=0.0091 | fpr=0.0206 | 3135.9 samples/s | 12.2 steps/s
Avg test loss: 5.79194, Avg test acc: 0.31273, Avg tpr: 0.00921, Avg fpr: 0.01974, total FA: 154

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.18179 | acc=0.1430 | tpr=0.8673 | fpr=0.8700 | 2987.8 samples/s | 11.7 steps/s
[Step= 100] | Loss=4.17829 | acc=0.1447 | tpr=0.8465 | fpr=0.8684 | 7952.8 samples/s | 31.1 steps/s
[Step= 150] | Loss=4.18220 | acc=0.1441 | tpr=0.8444 | fpr=0.8688 | 7355.1 samples/s | 28.7 steps/s
[Step= 200] | Loss=4.17773 | acc=0.1452 | tpr=0.8481 | fpr=0.8676 | 7363.7 samples/s | 28.8 steps/s
[Step= 250] | Loss=4.18502 | acc=0.1463 | tpr=0.8559 | fpr=0.8666 | 8262.6 samples/s | 32.3 steps/s
[Step= 300] | Loss=4.18967 | acc=0.1459 | tpr=0.8531 | fpr=0.8670 | 7239.1 samples/s | 28.3 steps/s
[Step= 350] | Loss=4.19076 | acc=0.1457 | tpr=0.8560 | fpr=0.8671 | 7267.5 samples/s | 28.4 steps/s
[Step= 400] | Loss=4.19095 | acc=0.1463 | tpr=0.8572 | fpr=0.8666 | 8226.6 samples/s | 32.1 steps/s
[Step= 450] | Loss=4.18838 | acc=0.1465 | tpr=0.8539 | fpr=0.8663 | 7701.5 samples/s | 30.1 steps/s
[Step= 500] | Loss=4.19007 | acc=0.1465 | tpr=0.8533 | fpr=0.8662 | 8184.7 samples/s | 32.0 steps/s
[Step= 550] | Loss=4.18715 | acc=0.1466 | tpr=0.8532 | fpr=0.8662 | 13410.1 samples/s | 52.4 steps/s
Avg test loss: 4.18826, Avg test acc: 0.14649, Avg tpr: 0.85380, Avg fpr: 0.86636, total FA: 120293

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.34078 | acc=0.0891 | tpr=0.9513 | fpr=0.9264 | 3001.3 samples/s | 11.7 steps/s
[Step= 100] | Loss=4.30257 | acc=0.0891 | tpr=0.9616 | fpr=0.9271 | 7774.6 samples/s | 30.4 steps/s
[Step= 150] | Loss=4.32098 | acc=0.0888 | tpr=0.9539 | fpr=0.9271 | 7820.1 samples/s | 30.5 steps/s
[Step= 200] | Loss=4.31254 | acc=0.0891 | tpr=0.9519 | fpr=0.9266 | 7337.3 samples/s | 28.7 steps/s
[Step= 250] | Loss=4.31669 | acc=0.0891 | tpr=0.9459 | fpr=0.9265 | 7778.2 samples/s | 30.4 steps/s
[Step= 300] | Loss=4.31556 | acc=0.0889 | tpr=0.9425 | fpr=0.9266 | 7388.6 samples/s | 28.9 steps/s
[Step= 350] | Loss=4.31829 | acc=0.0887 | tpr=0.9418 | fpr=0.9268 | 7973.1 samples/s | 31.1 steps/s
[Step= 400] | Loss=4.31663 | acc=0.0886 | tpr=0.9437 | fpr=0.9269 | 7739.7 samples/s | 30.2 steps/s
[Step= 450] | Loss=4.31767 | acc=0.0886 | tpr=0.9455 | fpr=0.9270 | 7324.1 samples/s | 28.6 steps/s
[Step= 500] | Loss=4.31978 | acc=0.0881 | tpr=0.9427 | fpr=0.9273 | 7184.6 samples/s | 28.1 steps/s
[Step= 550] | Loss=4.31705 | acc=0.0881 | tpr=0.9439 | fpr=0.9275 | 14257.6 samples/s | 55.7 steps/s
Avg test loss: 4.31748, Avg test acc: 0.08803, Avg tpr: 0.94414, Avg fpr: 0.92753, total FA: 128786

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=3.16612 | acc=0.1692 | tpr=0.7212 | fpr=0.8407 | 2971.5 samples/s | 11.6 steps/s
[Step= 100] | Loss=3.14633 | acc=0.1740 | tpr=0.7271 | fpr=0.8363 | 7590.3 samples/s | 29.6 steps/s
[Step= 150] | Loss=3.15066 | acc=0.1753 | tpr=0.7522 | fpr=0.8353 | 7633.7 samples/s | 29.8 steps/s
[Step= 200] | Loss=3.14142 | acc=0.1760 | tpr=0.7388 | fpr=0.8343 | 7724.0 samples/s | 30.2 steps/s
[Step= 250] | Loss=3.14220 | acc=0.1759 | tpr=0.7362 | fpr=0.8343 | 7259.0 samples/s | 28.4 steps/s
[Step= 300] | Loss=3.14141 | acc=0.1757 | tpr=0.7324 | fpr=0.8344 | 7642.9 samples/s | 29.9 steps/s
[Step= 350] | Loss=3.13625 | acc=0.1756 | tpr=0.7301 | fpr=0.8345 | 6726.4 samples/s | 26.3 steps/s
[Step= 400] | Loss=3.13739 | acc=0.1756 | tpr=0.7380 | fpr=0.8346 | 7617.8 samples/s | 29.8 steps/s
[Step= 450] | Loss=3.13867 | acc=0.1750 | tpr=0.7361 | fpr=0.8352 | 7569.2 samples/s | 29.6 steps/s
[Step= 500] | Loss=3.14159 | acc=0.1748 | tpr=0.7388 | fpr=0.8354 | 8136.8 samples/s | 31.8 steps/s
[Step= 550] | Loss=3.14245 | acc=0.1749 | tpr=0.7378 | fpr=0.8353 | 14175.1 samples/s | 55.4 steps/s
Avg test loss: 3.14393, Avg test acc: 0.17478, Avg tpr: 0.73693, Avg fpr: 0.83544, total FA: 115999

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=3.98215 | acc=0.1461 | tpr=0.7699 | fpr=0.8651 | 4024.9 samples/s | 15.7 steps/s
[Step= 100] | Loss=3.97275 | acc=0.1477 | tpr=0.7740 | fpr=0.8640 | 7591.8 samples/s | 29.7 steps/s
[Step= 150] | Loss=3.97486 | acc=0.1474 | tpr=0.7680 | fpr=0.8641 | 7271.7 samples/s | 28.4 steps/s
[Step= 200] | Loss=3.97144 | acc=0.1480 | tpr=0.7683 | fpr=0.8633 | 7678.0 samples/s | 30.0 steps/s
[Step= 250] | Loss=3.97838 | acc=0.1478 | tpr=0.7790 | fpr=0.8637 | 8007.1 samples/s | 31.3 steps/s
[Step= 300] | Loss=3.97679 | acc=0.1475 | tpr=0.7745 | fpr=0.8639 | 7541.9 samples/s | 29.5 steps/s
[Step= 350] | Loss=3.97382 | acc=0.1473 | tpr=0.7783 | fpr=0.8642 | 7413.4 samples/s | 29.0 steps/s
[Step= 400] | Loss=3.97305 | acc=0.1475 | tpr=0.7834 | fpr=0.8641 | 7713.7 samples/s | 30.1 steps/s
[Step= 450] | Loss=3.97406 | acc=0.1470 | tpr=0.7843 | fpr=0.8645 | 8336.3 samples/s | 32.6 steps/s
[Step= 500] | Loss=3.97750 | acc=0.1470 | tpr=0.7833 | fpr=0.8645 | 7860.9 samples/s | 30.7 steps/s
[Step= 550] | Loss=3.97879 | acc=0.1473 | tpr=0.7887 | fpr=0.8643 | 13173.6 samples/s | 51.5 steps/s
Avg test loss: 3.97942, Avg test acc: 0.14726, Avg tpr: 0.78962, Avg fpr: 0.86441, total FA: 120022

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=3.40262 | acc=0.1559 | tpr=0.6372 | fpr=0.8527 | 4041.3 samples/s | 15.8 steps/s
[Step= 100] | Loss=3.39123 | acc=0.1582 | tpr=0.6418 | fpr=0.8509 | 8005.3 samples/s | 31.3 steps/s
[Step= 150] | Loss=3.39907 | acc=0.1571 | tpr=0.6225 | fpr=0.8514 | 7618.7 samples/s | 29.8 steps/s
[Step= 200] | Loss=3.39772 | acc=0.1576 | tpr=0.6273 | fpr=0.8509 | 7793.6 samples/s | 30.4 steps/s
[Step= 250] | Loss=3.40633 | acc=0.1577 | tpr=0.6358 | fpr=0.8510 | 7767.0 samples/s | 30.3 steps/s
[Step= 300] | Loss=3.41140 | acc=0.1567 | tpr=0.6451 | fpr=0.8522 | 6932.0 samples/s | 27.1 steps/s
[Step= 350] | Loss=3.41189 | acc=0.1563 | tpr=0.6518 | fpr=0.8527 | 8141.9 samples/s | 31.8 steps/s
[Step= 400] | Loss=3.41083 | acc=0.1566 | tpr=0.6603 | fpr=0.8526 | 7930.0 samples/s | 31.0 steps/s
[Step= 450] | Loss=3.41459 | acc=0.1564 | tpr=0.6607 | fpr=0.8528 | 7257.1 samples/s | 28.3 steps/s
[Step= 500] | Loss=3.41442 | acc=0.1564 | tpr=0.6608 | fpr=0.8527 | 7509.7 samples/s | 29.3 steps/s
[Step= 550] | Loss=3.41417 | acc=0.1562 | tpr=0.6637 | fpr=0.8530 | 14498.4 samples/s | 56.6 steps/s
Avg test loss: 3.41529, Avg test acc: 0.15610, Avg tpr: 0.66403, Avg fpr: 0.85313, total FA: 118456

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.06176 | acc=0.9803 | tpr=0.8496 | fpr=0.0173 | 4119.8 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.06136 | acc=0.9800 | tpr=0.8742 | fpr=0.0181 | 7216.7 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.06336 | acc=0.9794 | tpr=0.8818 | fpr=0.0188 | 7718.6 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.06472 | acc=0.9794 | tpr=0.8907 | fpr=0.0190 | 7541.2 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.06459 | acc=0.9794 | tpr=0.8917 | fpr=0.0190 | 7186.8 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.06528 | acc=0.9795 | tpr=0.8916 | fpr=0.0189 | 7269.5 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.06518 | acc=0.9794 | tpr=0.8910 | fpr=0.0190 | 7404.4 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.06572 | acc=0.9792 | tpr=0.8922 | fpr=0.0192 | 8352.1 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.06726 | acc=0.9790 | tpr=0.8885 | fpr=0.0194 | 7977.4 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.06669 | acc=0.9792 | tpr=0.8890 | fpr=0.0192 | 7575.6 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.06605 | acc=0.9794 | tpr=0.8894 | fpr=0.0190 | 14328.7 samples/s | 56.0 steps/s
Avg test loss: 0.06591, Avg test acc: 0.97937, Avg tpr: 0.88906, Avg fpr: 0.01898, total FA: 2636

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.03937 | acc=0.9867 | tpr=0.8319 | fpr=0.0105 | 3939.5 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.03864 | acc=0.9860 | tpr=0.8401 | fpr=0.0113 | 8276.7 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.03964 | acc=0.9857 | tpr=0.8487 | fpr=0.0118 | 8384.9 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.04076 | acc=0.9854 | tpr=0.8481 | fpr=0.0121 | 7711.3 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.04060 | acc=0.9856 | tpr=0.8524 | fpr=0.0120 | 7765.1 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.04062 | acc=0.9854 | tpr=0.8451 | fpr=0.0120 | 7595.2 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.04048 | acc=0.9854 | tpr=0.8485 | fpr=0.0121 | 7438.8 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.04107 | acc=0.9854 | tpr=0.8479 | fpr=0.0121 | 7544.8 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.04136 | acc=0.9853 | tpr=0.8437 | fpr=0.0122 | 7837.5 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.04102 | acc=0.9853 | tpr=0.8463 | fpr=0.0122 | 7571.1 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.04076 | acc=0.9854 | tpr=0.8428 | fpr=0.0120 | 13719.2 samples/s | 53.6 steps/s
Avg test loss: 0.04071, Avg test acc: 0.98543, Avg tpr: 0.84350, Avg fpr: 0.01199, total FA: 1665

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.04453 | acc=0.9838 | tpr=0.8805 | fpr=0.0143 | 4014.9 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.04336 | acc=0.9843 | tpr=0.8870 | fpr=0.0139 | 7648.2 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.04479 | acc=0.9839 | tpr=0.8862 | fpr=0.0143 | 7972.2 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.04570 | acc=0.9835 | tpr=0.8896 | fpr=0.0148 | 8027.5 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.04530 | acc=0.9837 | tpr=0.8908 | fpr=0.0146 | 8258.7 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.04533 | acc=0.9836 | tpr=0.8873 | fpr=0.0146 | 7418.0 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.04542 | acc=0.9835 | tpr=0.8867 | fpr=0.0148 | 7517.3 samples/s | 29.4 steps/s
[Step= 400] | Loss=0.04569 | acc=0.9834 | tpr=0.8879 | fpr=0.0148 | 7429.8 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.04613 | acc=0.9832 | tpr=0.8861 | fpr=0.0151 | 7760.2 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.04584 | acc=0.9833 | tpr=0.8890 | fpr=0.0150 | 7861.0 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.04553 | acc=0.9834 | tpr=0.8850 | fpr=0.0148 | 13777.2 samples/s | 53.8 steps/s
Avg test loss: 0.04543, Avg test acc: 0.98338, Avg tpr: 0.88510, Avg fpr: 0.01483, total FA: 2059

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.06043 | acc=0.9820 | tpr=0.8584 | fpr=0.0158 | 4128.2 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.06010 | acc=0.9821 | tpr=0.8721 | fpr=0.0158 | 7716.5 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.06293 | acc=0.9816 | tpr=0.8746 | fpr=0.0164 | 7774.5 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.06455 | acc=0.9815 | tpr=0.8820 | fpr=0.0167 | 7580.1 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.06328 | acc=0.9817 | tpr=0.8803 | fpr=0.0165 | 7466.0 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.06424 | acc=0.9815 | tpr=0.8771 | fpr=0.0166 | 7325.7 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.06385 | acc=0.9815 | tpr=0.8823 | fpr=0.0167 | 7515.6 samples/s | 29.4 steps/s
[Step= 400] | Loss=0.06392 | acc=0.9814 | tpr=0.8813 | fpr=0.0168 | 8068.2 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.06517 | acc=0.9811 | tpr=0.8759 | fpr=0.0170 | 8493.3 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.06480 | acc=0.9812 | tpr=0.8775 | fpr=0.0169 | 6969.8 samples/s | 27.2 steps/s
[Step= 550] | Loss=0.06387 | acc=0.9814 | tpr=0.8778 | fpr=0.0167 | 13278.6 samples/s | 51.9 steps/s
Avg test loss: 0.06380, Avg test acc: 0.98141, Avg tpr: 0.87797, Avg fpr: 0.01671, total FA: 2320

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.06499 | acc=0.9806 | tpr=0.8584 | fpr=0.0172 | 3996.9 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.06606 | acc=0.9802 | tpr=0.8827 | fpr=0.0179 | 7230.4 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.06798 | acc=0.9802 | tpr=0.8876 | fpr=0.0181 | 7706.4 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.06847 | acc=0.9801 | tpr=0.8940 | fpr=0.0183 | 7187.0 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.06835 | acc=0.9802 | tpr=0.8934 | fpr=0.0182 | 7209.4 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.06952 | acc=0.9798 | tpr=0.8865 | fpr=0.0185 | 7598.3 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.06965 | acc=0.9796 | tpr=0.8904 | fpr=0.0188 | 6974.5 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.07011 | acc=0.9794 | tpr=0.8884 | fpr=0.0189 | 7349.7 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.07181 | acc=0.9791 | tpr=0.8851 | fpr=0.0192 | 7257.1 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.07086 | acc=0.9792 | tpr=0.8841 | fpr=0.0190 | 8015.6 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.07027 | acc=0.9794 | tpr=0.8826 | fpr=0.0189 | 13294.2 samples/s | 51.9 steps/s
Avg test loss: 0.07022, Avg test acc: 0.97937, Avg tpr: 0.88273, Avg fpr: 0.01887, total FA: 2620

server round 4/10

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=2001 Epoch= 9.8] | Loss=0.00171 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.826 | L2-Norm(final)=2.354 | 4271.2 samples/s | 66.7 steps/s
[Step=2050 Epoch=10.0] | Loss=0.01401 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.816 | L2-Norm(final)=2.355 | 4518.6 samples/s | 70.6 steps/s
[Step=2100 Epoch=10.2] | Loss=0.01393 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.811 | L2-Norm(final)=2.354 | 4393.4 samples/s | 68.6 steps/s
[Step=2150 Epoch=10.5] | Loss=0.01585 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.802 | L2-Norm(final)=2.351 | 4219.2 samples/s | 65.9 steps/s
[Step=2200 Epoch=10.7] | Loss=0.01527 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.791 | L2-Norm(final)=2.349 | 5803.3 samples/s | 90.7 steps/s
[Step=2250 Epoch=11.0] | Loss=0.01458 | Reg=0.00316 | acc=0.9844 | L2-Norm=17.782 | L2-Norm(final)=2.349 | 1914.6 samples/s | 29.9 steps/s
[Step=2300 Epoch=11.2] | Loss=0.01429 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.776 | L2-Norm(final)=2.349 | 4204.7 samples/s | 65.7 steps/s
[Step=2350 Epoch=11.5] | Loss=0.01417 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.768 | L2-Norm(final)=2.349 | 4245.5 samples/s | 66.3 steps/s
[Step=2400 Epoch=11.7] | Loss=0.01544 | Reg=0.00316 | acc=0.9844 | L2-Norm=17.764 | L2-Norm(final)=2.350 | 5391.0 samples/s | 84.2 steps/s
[Step=2450 Epoch=11.9] | Loss=0.01626 | Reg=0.00316 | acc=0.9688 | L2-Norm=17.765 | L2-Norm(final)=2.350 | 1880.0 samples/s | 29.4 steps/s
[Step=2500 Epoch=12.2] | Loss=0.01677 | Reg=0.00316 | acc=0.9688 | L2-Norm=17.768 | L2-Norm(final)=2.349 | 4271.6 samples/s | 66.7 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_0/client_state-step2500.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00100, len=1
[Step=2001 Epoch= 9.8] | Loss=0.00417 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.087 | L2-Norm(final)=2.309 | 4491.0 samples/s | 70.2 steps/s
[Step=2050 Epoch=10.0] | Loss=0.00931 | Reg=0.00327 | acc=0.9844 | L2-Norm=18.081 | L2-Norm(final)=2.309 | 3990.2 samples/s | 62.3 steps/s
[Step=2100 Epoch=10.2] | Loss=0.01307 | Reg=0.00327 | acc=0.9844 | L2-Norm=18.079 | L2-Norm(final)=2.313 | 4616.2 samples/s | 72.1 steps/s
[Step=2150 Epoch=10.5] | Loss=0.01534 | Reg=0.00327 | acc=0.9688 | L2-Norm=18.072 | L2-Norm(final)=2.311 | 4235.6 samples/s | 66.2 steps/s
[Step=2200 Epoch=10.7] | Loss=0.01690 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.063 | L2-Norm(final)=2.306 | 5923.5 samples/s | 92.6 steps/s
[Step=2250 Epoch=11.0] | Loss=0.01560 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.057 | L2-Norm(final)=2.304 | 1923.4 samples/s | 30.1 steps/s
[Step=2300 Epoch=11.2] | Loss=0.01478 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.053 | L2-Norm(final)=2.305 | 4607.7 samples/s | 72.0 steps/s
[Step=2350 Epoch=11.5] | Loss=0.01564 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.047 | L2-Norm(final)=2.305 | 4356.9 samples/s | 68.1 steps/s
[Step=2400 Epoch=11.7] | Loss=0.01577 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.041 | L2-Norm(final)=2.303 | 5493.2 samples/s | 85.8 steps/s
[Step=2450 Epoch=12.0] | Loss=0.01554 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.037 | L2-Norm(final)=2.302 | 1988.3 samples/s | 31.1 steps/s
[Step=2500 Epoch=12.2] | Loss=0.01507 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.031 | L2-Norm(final)=2.302 | 4470.1 samples/s | 69.8 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_1/client_state-step2500.h5

Train client 2: client_asml1_2
Local layers training...
LR=0.00100, len=1
[Step=2001 Epoch= 9.7] | Loss=0.00427 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.360 | L2-Norm(final)=2.333 | 4406.1 samples/s | 68.8 steps/s
[Step=2050 Epoch=10.0] | Loss=0.01424 | Reg=0.00337 | acc=0.9844 | L2-Norm=18.353 | L2-Norm(final)=2.334 | 4489.2 samples/s | 70.1 steps/s
[Step=2100 Epoch=10.2] | Loss=0.01488 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.343 | L2-Norm(final)=2.335 | 4671.4 samples/s | 73.0 steps/s
[Step=2150 Epoch=10.5] | Loss=0.01564 | Reg=0.00336 | acc=0.9844 | L2-Norm=18.336 | L2-Norm(final)=2.337 | 4451.7 samples/s | 69.6 steps/s
[Step=2200 Epoch=10.7] | Loss=0.01721 | Reg=0.00336 | acc=0.9688 | L2-Norm=18.332 | L2-Norm(final)=2.336 | 5931.8 samples/s | 92.7 steps/s
[Step=2250 Epoch=11.0] | Loss=0.01665 | Reg=0.00336 | acc=0.9844 | L2-Norm=18.330 | L2-Norm(final)=2.337 | 1914.4 samples/s | 29.9 steps/s
[Step=2300 Epoch=11.2] | Loss=0.01592 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.330 | L2-Norm(final)=2.338 | 4500.0 samples/s | 70.3 steps/s
[Step=2350 Epoch=11.5] | Loss=0.01566 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.330 | L2-Norm(final)=2.339 | 4421.7 samples/s | 69.1 steps/s
[Step=2400 Epoch=11.7] | Loss=0.01567 | Reg=0.00336 | acc=0.9531 | L2-Norm=18.328 | L2-Norm(final)=2.339 | 5617.9 samples/s | 87.8 steps/s
[Step=2450 Epoch=11.9] | Loss=0.01696 | Reg=0.00336 | acc=0.9844 | L2-Norm=18.327 | L2-Norm(final)=2.338 | 2030.9 samples/s | 31.7 steps/s
[Step=2500 Epoch=12.2] | Loss=0.01736 | Reg=0.00336 | acc=0.9688 | L2-Norm=18.332 | L2-Norm(final)=2.337 | 4653.5 samples/s | 72.7 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_2/client_state-step2500.h5

Train client 3: client_asml1_3
Local layers training...
LR=0.00100, len=1
[Step=2001 Epoch= 9.8] | Loss=0.02717 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.946 | L2-Norm(final)=2.389 | 4649.1 samples/s | 72.6 steps/s
[Step=2050 Epoch=10.0] | Loss=0.02251 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.947 | L2-Norm(final)=2.386 | 4173.1 samples/s | 65.2 steps/s
[Step=2100 Epoch=10.2] | Loss=0.02589 | Reg=0.00323 | acc=0.9531 | L2-Norm=17.959 | L2-Norm(final)=2.382 | 4670.0 samples/s | 73.0 steps/s
[Step=2150 Epoch=10.5] | Loss=0.02665 | Reg=0.00323 | acc=0.9219 | L2-Norm=17.970 | L2-Norm(final)=2.376 | 4262.9 samples/s | 66.6 steps/s
[Step=2200 Epoch=10.7] | Loss=0.02646 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.982 | L2-Norm(final)=2.372 | 6157.3 samples/s | 96.2 steps/s
[Step=2250 Epoch=11.0] | Loss=0.02439 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.994 | L2-Norm(final)=2.369 | 1923.6 samples/s | 30.1 steps/s
[Step=2300 Epoch=11.2] | Loss=0.02291 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.001 | L2-Norm(final)=2.368 | 4446.3 samples/s | 69.5 steps/s
[Step=2350 Epoch=11.5] | Loss=0.02159 | Reg=0.00324 | acc=0.9844 | L2-Norm=18.004 | L2-Norm(final)=2.369 | 4849.2 samples/s | 75.8 steps/s
[Step=2400 Epoch=11.7] | Loss=0.02054 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.002 | L2-Norm(final)=2.369 | 5771.5 samples/s | 90.2 steps/s
[Step=2450 Epoch=11.9] | Loss=0.01991 | Reg=0.00324 | acc=0.9688 | L2-Norm=18.000 | L2-Norm(final)=2.369 | 1974.2 samples/s | 30.8 steps/s
[Step=2500 Epoch=12.2] | Loss=0.01926 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.996 | L2-Norm(final)=2.370 | 4605.5 samples/s | 72.0 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_3/client_state-step2500.h5

Train client 4: client_asml1_4
Local layers training...
LR=0.00100, len=1
[Step=2001 Epoch= 9.8] | Loss=0.00172 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.056 | L2-Norm(final)=2.345 | 4286.3 samples/s | 67.0 steps/s
[Step=2050 Epoch=10.1] | Loss=0.01342 | Reg=0.00326 | acc=0.9688 | L2-Norm=18.064 | L2-Norm(final)=2.355 | 4665.1 samples/s | 72.9 steps/s
[Step=2100 Epoch=10.3] | Loss=0.01647 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.058 | L2-Norm(final)=2.352 | 4502.0 samples/s | 70.3 steps/s
[Step=2150 Epoch=10.5] | Loss=0.01780 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.053 | L2-Norm(final)=2.349 | 4591.6 samples/s | 71.7 steps/s
[Step=2200 Epoch=10.8] | Loss=0.01763 | Reg=0.00326 | acc=0.9531 | L2-Norm=18.051 | L2-Norm(final)=2.351 | 5988.3 samples/s | 93.6 steps/s
[Step=2250 Epoch=11.0] | Loss=0.01668 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.051 | L2-Norm(final)=2.353 | 1904.7 samples/s | 29.8 steps/s
[Step=2300 Epoch=11.3] | Loss=0.01744 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.051 | L2-Norm(final)=2.355 | 4632.8 samples/s | 72.4 steps/s
[Step=2350 Epoch=11.5] | Loss=0.01718 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.052 | L2-Norm(final)=2.355 | 4464.5 samples/s | 69.8 steps/s
[Step=2400 Epoch=11.8] | Loss=0.01719 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.053 | L2-Norm(final)=2.356 | 5844.9 samples/s | 91.3 steps/s
[Step=2450 Epoch=12.0] | Loss=0.01729 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.056 | L2-Norm(final)=2.356 | 1952.9 samples/s | 30.5 steps/s
[Step=2500 Epoch=12.3] | Loss=0.01727 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.058 | L2-Norm(final)=2.356 | 4384.2 samples/s | 68.5 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_4/client_state-step2500.h5

Train client 5: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=2001 Epoch=19.0] | Loss=0.00001 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.169 | L2-Norm(final)=2.557 | 4292.7 samples/s | 67.1 steps/s
[Step=2050 Epoch=19.4] | Loss=0.00000 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.122 | L2-Norm(final)=2.566 | 4298.7 samples/s | 67.2 steps/s
[Step=2100 Epoch=19.9] | Loss=0.00000 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.073 | L2-Norm(final)=2.575 | 5863.1 samples/s | 91.6 steps/s
[Step=2150 Epoch=20.4] | Loss=0.00000 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.024 | L2-Norm(final)=2.584 | 1860.4 samples/s | 29.1 steps/s
[Step=2200 Epoch=20.8] | Loss=0.00000 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.976 | L2-Norm(final)=2.594 | 5355.8 samples/s | 83.7 steps/s
[Step=2250 Epoch=21.3] | Loss=0.00000 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.928 | L2-Norm(final)=2.604 | 1954.6 samples/s | 30.5 steps/s
[Step=2300 Epoch=21.8] | Loss=0.00000 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.880 | L2-Norm(final)=2.614 | 4998.8 samples/s | 78.1 steps/s
[Step=2350 Epoch=22.3] | Loss=0.00000 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.833 | L2-Norm(final)=2.623 | 1994.3 samples/s | 31.2 steps/s
[Step=2400 Epoch=22.7] | Loss=0.00000 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=2.633 | 4856.4 samples/s | 75.9 steps/s
[Step=2450 Epoch=23.2] | Loss=0.00000 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.738 | L2-Norm(final)=2.644 | 1987.6 samples/s | 31.1 steps/s
[Step=2500 Epoch=23.7] | Loss=0.00000 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.691 | L2-Norm(final)=2.654 | 4493.3 samples/s | 70.2 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_0/client_state-step2500.h5

Train client 6: client_iccad2012_1
Local layers training...
LR=0.00100, len=1
[Step=2001 Epoch=19.0] | Loss=0.00000 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.385 | L2-Norm(final)=2.416 | 4241.7 samples/s | 66.3 steps/s
[Step=2050 Epoch=19.5] | Loss=0.00000 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.342 | L2-Norm(final)=2.424 | 4085.1 samples/s | 63.8 steps/s
[Step=2100 Epoch=20.0] | Loss=0.00000 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.297 | L2-Norm(final)=2.434 | 5741.2 samples/s | 89.7 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00000 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.253 | L2-Norm(final)=2.444 | 1779.7 samples/s | 27.8 steps/s
[Step=2200 Epoch=20.9] | Loss=0.00000 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.208 | L2-Norm(final)=2.454 | 4890.1 samples/s | 76.4 steps/s
[Step=2250 Epoch=21.4] | Loss=0.00000 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.163 | L2-Norm(final)=2.465 | 1855.1 samples/s | 29.0 steps/s
[Step=2300 Epoch=21.9] | Loss=0.00000 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=2.475 | 5096.7 samples/s | 79.6 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00000 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.075 | L2-Norm(final)=2.486 | 1989.9 samples/s | 31.1 steps/s
[Step=2400 Epoch=22.8] | Loss=0.00000 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.031 | L2-Norm(final)=2.497 | 4303.9 samples/s | 67.2 steps/s
[Step=2450 Epoch=23.3] | Loss=0.00000 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.987 | L2-Norm(final)=2.507 | 2051.4 samples/s | 32.1 steps/s
[Step=2500 Epoch=23.8] | Loss=0.00000 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.943 | L2-Norm(final)=2.518 | 4409.1 samples/s | 68.9 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_1/client_state-step2500.h5

Train client 7: client_iccad2012_2
Local layers training...
LR=0.00100, len=1
[Step=2001 Epoch=19.1] | Loss=0.00001 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.027 | L2-Norm(final)=2.422 | 4432.5 samples/s | 69.3 steps/s
[Step=2050 Epoch=19.6] | Loss=0.00000 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.983 | L2-Norm(final)=2.434 | 4318.4 samples/s | 67.5 steps/s
[Step=2100 Epoch=20.1] | Loss=0.00000 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.938 | L2-Norm(final)=2.446 | 5833.2 samples/s | 91.1 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00000 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.894 | L2-Norm(final)=2.460 | 1886.7 samples/s | 29.5 steps/s
[Step=2200 Epoch=21.0] | Loss=0.00000 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=2.474 | 5474.8 samples/s | 85.5 steps/s
[Step=2250 Epoch=21.5] | Loss=0.00000 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.805 | L2-Norm(final)=2.488 | 1890.5 samples/s | 29.5 steps/s
[Step=2300 Epoch=22.0] | Loss=0.00000 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.761 | L2-Norm(final)=2.502 | 5043.6 samples/s | 78.8 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00000 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.718 | L2-Norm(final)=2.517 | 1937.5 samples/s | 30.3 steps/s
[Step=2400 Epoch=22.9] | Loss=0.00000 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.674 | L2-Norm(final)=2.532 | 4742.4 samples/s | 74.1 steps/s
[Step=2450 Epoch=23.4] | Loss=0.02347 | Reg=0.00186 | acc=0.6875 | L2-Norm=13.632 | L2-Norm(final)=2.546 | 1917.4 samples/s | 30.0 steps/s
[Step=2500 Epoch=23.9] | Loss=0.02673 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.749 | L2-Norm(final)=2.546 | 4568.6 samples/s | 71.4 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_2/client_state-step2500.h5

Train client 8: client_iccad2012_3
Local layers training...
LR=0.00100, len=1
[Step=2001 Epoch=18.9] | Loss=0.00000 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.628 | L2-Norm(final)=2.549 | 4731.3 samples/s | 73.9 steps/s
[Step=2050 Epoch=19.3] | Loss=0.00001 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.586 | L2-Norm(final)=2.556 | 3730.2 samples/s | 58.3 steps/s
[Step=2100 Epoch=19.8] | Loss=0.00001 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.545 | L2-Norm(final)=2.564 | 5900.4 samples/s | 92.2 steps/s
[Step=2150 Epoch=20.3] | Loss=0.00001 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.503 | L2-Norm(final)=2.572 | 1852.0 samples/s | 28.9 steps/s
[Step=2200 Epoch=20.7] | Loss=0.00001 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.461 | L2-Norm(final)=2.581 | 5230.5 samples/s | 81.7 steps/s
[Step=2250 Epoch=21.2] | Loss=0.00001 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.420 | L2-Norm(final)=2.589 | 1927.4 samples/s | 30.1 steps/s
[Step=2300 Epoch=21.7] | Loss=0.00001 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.378 | L2-Norm(final)=2.597 | 4764.1 samples/s | 74.4 steps/s
[Step=2350 Epoch=22.1] | Loss=0.00001 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.337 | L2-Norm(final)=2.606 | 2046.1 samples/s | 32.0 steps/s
[Step=2400 Epoch=22.6] | Loss=0.00001 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.295 | L2-Norm(final)=2.614 | 4478.9 samples/s | 70.0 steps/s
[Step=2450 Epoch=23.1] | Loss=0.00001 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.254 | L2-Norm(final)=2.623 | 2066.2 samples/s | 32.3 steps/s
[Step=2500 Epoch=23.6] | Loss=0.00000 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.213 | L2-Norm(final)=2.632 | 4387.8 samples/s | 68.6 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_3/client_state-step2500.h5

Train client 9: client_iccad2012_4
Local layers training...
LR=0.00100, len=1
[Step=2001 Epoch=19.1] | Loss=0.00000 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.417 | L2-Norm(final)=2.450 | 4108.8 samples/s | 64.2 steps/s
[Step=2050 Epoch=19.5] | Loss=0.00000 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.376 | L2-Norm(final)=2.459 | 4245.2 samples/s | 66.3 steps/s
[Step=2100 Epoch=20.0] | Loss=0.00001 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.335 | L2-Norm(final)=2.470 | 5647.6 samples/s | 88.2 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00001 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.294 | L2-Norm(final)=2.481 | 1809.7 samples/s | 28.3 steps/s
[Step=2200 Epoch=21.0] | Loss=0.00000 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.253 | L2-Norm(final)=2.492 | 5578.0 samples/s | 87.2 steps/s
[Step=2250 Epoch=21.4] | Loss=0.00001 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.213 | L2-Norm(final)=2.503 | 1871.2 samples/s | 29.2 steps/s
[Step=2300 Epoch=21.9] | Loss=0.00001 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.173 | L2-Norm(final)=2.514 | 4890.1 samples/s | 76.4 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00000 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.132 | L2-Norm(final)=2.525 | 1957.5 samples/s | 30.6 steps/s
[Step=2400 Epoch=22.9] | Loss=0.00000 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.092 | L2-Norm(final)=2.537 | 4753.9 samples/s | 74.3 steps/s
[Step=2450 Epoch=23.4] | Loss=0.00000 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.052 | L2-Norm(final)=2.548 | 2028.4 samples/s | 31.7 steps/s
[Step=2500 Epoch=23.8] | Loss=0.00000 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.012 | L2-Norm(final)=2.560 | 4524.6 samples/s | 70.7 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_4/client_state-step2500.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.15238 | acc=0.9237 | tpr=0.9355 | fpr=0.1018 | 4202.2 samples/s | 16.4 steps/s
Avg test loss: 0.15597, Avg test acc: 0.92271, Avg tpr: 0.93437, Avg fpr: 0.10294, total FA: 803

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.17122 | acc=0.9270 | tpr=0.9421 | fpr=0.1058 | 4074.2 samples/s | 15.9 steps/s
Avg test loss: 0.17430, Avg test acc: 0.92624, Avg tpr: 0.94195, Avg fpr: 0.10832, total FA: 845

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.17330 | acc=0.9211 | tpr=0.9338 | fpr=0.1065 | 4120.8 samples/s | 16.1 steps/s
Avg test loss: 0.17172, Avg test acc: 0.92131, Avg tpr: 0.93338, Avg fpr: 0.10524, total FA: 821

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.16754 | acc=0.9293 | tpr=0.9473 | fpr=0.1098 | 4180.3 samples/s | 16.3 steps/s
Avg test loss: 0.17568, Avg test acc: 0.92704, Avg tpr: 0.94632, Avg fpr: 0.11537, total FA: 900

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.16950 | acc=0.9252 | tpr=0.9460 | fpr=0.1202 | 4197.5 samples/s | 16.4 steps/s
Avg test loss: 0.17497, Avg test acc: 0.92391, Avg tpr: 0.94504, Avg fpr: 0.12255, total FA: 956

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.31789 | acc=0.3165 | tpr=0.0067 | fpr=0.0109 | 4239.5 samples/s | 16.6 steps/s
Avg test loss: 6.34719, Avg test acc: 0.31369, Avg tpr: 0.00670, Avg fpr: 0.01115, total FA: 87

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.01073 | acc=0.3103 | tpr=0.0163 | fpr=0.0513 | 4169.3 samples/s | 16.3 steps/s
Avg test loss: 5.03283, Avg test acc: 0.30872, Avg tpr: 0.01597, Avg fpr: 0.04743, total FA: 370

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.02784 | acc=0.3108 | tpr=0.0181 | fpr=0.0538 | 4067.4 samples/s | 15.9 steps/s
Avg test loss: 4.04331, Avg test acc: 0.30924, Avg tpr: 0.01865, Avg fpr: 0.05166, total FA: 403

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.05585 | acc=0.3134 | tpr=0.0210 | fpr=0.0518 | 4093.8 samples/s | 16.0 steps/s
Avg test loss: 5.07661, Avg test acc: 0.31261, Avg tpr: 0.02326, Avg fpr: 0.05102, total FA: 398

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.80705 | acc=0.3152 | tpr=0.0056 | fpr=0.0124 | 4328.0 samples/s | 16.9 steps/s
Avg test loss: 5.82515, Avg test acc: 0.31265, Avg tpr: 0.00595, Avg fpr: 0.01282, total FA: 100

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.34843 | acc=0.1615 | tpr=0.8186 | fpr=0.8503 | 4117.0 samples/s | 16.1 steps/s
[Step= 100] | Loss=3.34463 | acc=0.1621 | tpr=0.8017 | fpr=0.8499 | 8236.5 samples/s | 32.2 steps/s
[Step= 150] | Loss=3.35039 | acc=0.1610 | tpr=0.7939 | fpr=0.8507 | 8393.0 samples/s | 32.8 steps/s
[Step= 200] | Loss=3.34633 | acc=0.1616 | tpr=0.7989 | fpr=0.8500 | 8131.2 samples/s | 31.8 steps/s
[Step= 250] | Loss=3.35200 | acc=0.1617 | tpr=0.8026 | fpr=0.8500 | 7211.5 samples/s | 28.2 steps/s
[Step= 300] | Loss=3.35466 | acc=0.1609 | tpr=0.8044 | fpr=0.8509 | 7365.0 samples/s | 28.8 steps/s
[Step= 350] | Loss=3.35516 | acc=0.1610 | tpr=0.8078 | fpr=0.8507 | 7741.1 samples/s | 30.2 steps/s
[Step= 400] | Loss=3.35618 | acc=0.1609 | tpr=0.8113 | fpr=0.8509 | 7926.3 samples/s | 31.0 steps/s
[Step= 450] | Loss=3.35594 | acc=0.1612 | tpr=0.8126 | fpr=0.8506 | 7491.6 samples/s | 29.3 steps/s
[Step= 500] | Loss=3.35794 | acc=0.1611 | tpr=0.8119 | fpr=0.8506 | 7446.8 samples/s | 29.1 steps/s
[Step= 550] | Loss=3.35522 | acc=0.1613 | tpr=0.8126 | fpr=0.8505 | 13671.1 samples/s | 53.4 steps/s
Avg test loss: 3.35606, Avg test acc: 0.16116, Avg tpr: 0.81260, Avg fpr: 0.85068, total FA: 118115

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.83223 | acc=0.1281 | tpr=0.8496 | fpr=0.8848 | 4230.8 samples/s | 16.5 steps/s
[Step= 100] | Loss=3.80023 | acc=0.1312 | tpr=0.8401 | fpr=0.8821 | 8550.6 samples/s | 33.4 steps/s
[Step= 150] | Loss=3.81584 | acc=0.1298 | tpr=0.8228 | fpr=0.8830 | 8364.8 samples/s | 32.7 steps/s
[Step= 200] | Loss=3.80934 | acc=0.1306 | tpr=0.8251 | fpr=0.8820 | 7403.8 samples/s | 28.9 steps/s
[Step= 250] | Loss=3.80894 | acc=0.1311 | tpr=0.8218 | fpr=0.8815 | 7777.7 samples/s | 30.4 steps/s
[Step= 300] | Loss=3.80835 | acc=0.1304 | tpr=0.8182 | fpr=0.8822 | 7588.8 samples/s | 29.6 steps/s
[Step= 350] | Loss=3.80788 | acc=0.1300 | tpr=0.8190 | fpr=0.8825 | 7448.7 samples/s | 29.1 steps/s
[Step= 400] | Loss=3.80575 | acc=0.1299 | tpr=0.8266 | fpr=0.8828 | 7441.1 samples/s | 29.1 steps/s
[Step= 450] | Loss=3.80539 | acc=0.1295 | tpr=0.8252 | fpr=0.8832 | 7790.2 samples/s | 30.4 steps/s
[Step= 500] | Loss=3.80780 | acc=0.1294 | tpr=0.8273 | fpr=0.8832 | 7834.8 samples/s | 30.6 steps/s
[Step= 550] | Loss=3.80498 | acc=0.1293 | tpr=0.8277 | fpr=0.8834 | 13194.3 samples/s | 51.5 steps/s
Avg test loss: 3.80581, Avg test acc: 0.12926, Avg tpr: 0.82805, Avg fpr: 0.88344, total FA: 122664

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=3.61728 | acc=0.1570 | tpr=0.8407 | fpr=0.8553 | 4076.6 samples/s | 15.9 steps/s
[Step= 100] | Loss=3.59574 | acc=0.1592 | tpr=0.8038 | fpr=0.8529 | 8049.4 samples/s | 31.4 steps/s
[Step= 150] | Loss=3.60552 | acc=0.1601 | tpr=0.8098 | fpr=0.8519 | 7368.7 samples/s | 28.8 steps/s
[Step= 200] | Loss=3.59605 | acc=0.1599 | tpr=0.7902 | fpr=0.8515 | 7144.9 samples/s | 27.9 steps/s
[Step= 250] | Loss=3.59924 | acc=0.1595 | tpr=0.7852 | fpr=0.8518 | 7248.4 samples/s | 28.3 steps/s
[Step= 300] | Loss=3.60110 | acc=0.1590 | tpr=0.7855 | fpr=0.8524 | 7681.0 samples/s | 30.0 steps/s
[Step= 350] | Loss=3.59678 | acc=0.1584 | tpr=0.7827 | fpr=0.8529 | 7612.2 samples/s | 29.7 steps/s
[Step= 400] | Loss=3.60014 | acc=0.1585 | tpr=0.7861 | fpr=0.8529 | 7900.7 samples/s | 30.9 steps/s
[Step= 450] | Loss=3.60330 | acc=0.1576 | tpr=0.7868 | fpr=0.8538 | 7581.7 samples/s | 29.6 steps/s
[Step= 500] | Loss=3.60578 | acc=0.1574 | tpr=0.7899 | fpr=0.8540 | 7398.3 samples/s | 28.9 steps/s
[Step= 550] | Loss=3.60776 | acc=0.1572 | tpr=0.7915 | fpr=0.8543 | 14611.8 samples/s | 57.1 steps/s
Avg test loss: 3.60935, Avg test acc: 0.15711, Avg tpr: 0.79200, Avg fpr: 0.85443, total FA: 118636

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.08384 | acc=0.1529 | tpr=0.7566 | fpr=0.8580 | 4128.5 samples/s | 16.1 steps/s
[Step= 100] | Loss=4.06412 | acc=0.1561 | tpr=0.7655 | fpr=0.8553 | 7488.6 samples/s | 29.3 steps/s
[Step= 150] | Loss=4.06330 | acc=0.1553 | tpr=0.7522 | fpr=0.8557 | 7655.6 samples/s | 29.9 steps/s
[Step= 200] | Loss=4.05685 | acc=0.1561 | tpr=0.7421 | fpr=0.8546 | 7638.1 samples/s | 29.8 steps/s
[Step= 250] | Loss=4.06588 | acc=0.1566 | tpr=0.7520 | fpr=0.8542 | 7625.8 samples/s | 29.8 steps/s
[Step= 300] | Loss=4.06311 | acc=0.1557 | tpr=0.7498 | fpr=0.8551 | 7737.1 samples/s | 30.2 steps/s
[Step= 350] | Loss=4.06258 | acc=0.1553 | tpr=0.7495 | fpr=0.8555 | 7708.7 samples/s | 30.1 steps/s
[Step= 400] | Loss=4.06032 | acc=0.1558 | tpr=0.7560 | fpr=0.8551 | 7877.4 samples/s | 30.8 steps/s
[Step= 450] | Loss=4.05762 | acc=0.1559 | tpr=0.7571 | fpr=0.8550 | 7627.7 samples/s | 29.8 steps/s
[Step= 500] | Loss=4.06068 | acc=0.1562 | tpr=0.7621 | fpr=0.8548 | 7445.7 samples/s | 29.1 steps/s
[Step= 550] | Loss=4.06215 | acc=0.1563 | tpr=0.7656 | fpr=0.8547 | 13719.6 samples/s | 53.6 steps/s
Avg test loss: 4.06257, Avg test acc: 0.15627, Avg tpr: 0.76664, Avg fpr: 0.85483, total FA: 118691

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.47105 | acc=0.1335 | tpr=0.7876 | fpr=0.8782 | 4370.0 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.44413 | acc=0.1360 | tpr=0.7910 | fpr=0.8762 | 7330.5 samples/s | 28.6 steps/s
[Step= 150] | Loss=4.45097 | acc=0.1347 | tpr=0.7723 | fpr=0.8771 | 8134.1 samples/s | 31.8 steps/s
[Step= 200] | Loss=4.45092 | acc=0.1339 | tpr=0.7694 | fpr=0.8777 | 7612.3 samples/s | 29.7 steps/s
[Step= 250] | Loss=4.46170 | acc=0.1330 | tpr=0.7747 | fpr=0.8786 | 7314.0 samples/s | 28.6 steps/s
[Step= 300] | Loss=4.46672 | acc=0.1327 | tpr=0.7775 | fpr=0.8791 | 7344.5 samples/s | 28.7 steps/s
[Step= 350] | Loss=4.46951 | acc=0.1326 | tpr=0.7815 | fpr=0.8792 | 8120.1 samples/s | 31.7 steps/s
[Step= 400] | Loss=4.46740 | acc=0.1326 | tpr=0.7894 | fpr=0.8793 | 7390.2 samples/s | 28.9 steps/s
[Step= 450] | Loss=4.47223 | acc=0.1325 | tpr=0.7945 | fpr=0.8795 | 7515.7 samples/s | 29.4 steps/s
[Step= 500] | Loss=4.47301 | acc=0.1323 | tpr=0.7956 | fpr=0.8797 | 7536.5 samples/s | 29.4 steps/s
[Step= 550] | Loss=4.47258 | acc=0.1325 | tpr=0.7967 | fpr=0.8795 | 14004.4 samples/s | 54.7 steps/s
Avg test loss: 4.47349, Avg test acc: 0.13242, Avg tpr: 0.79635, Avg fpr: 0.87965, total FA: 122138

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.05852 | acc=0.9814 | tpr=0.8363 | fpr=0.0160 | 4151.5 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.05798 | acc=0.9813 | tpr=0.8614 | fpr=0.0164 | 7798.1 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.05981 | acc=0.9808 | tpr=0.8718 | fpr=0.0172 | 7749.4 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.06105 | acc=0.9808 | tpr=0.8787 | fpr=0.0174 | 7448.4 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.06093 | acc=0.9808 | tpr=0.8821 | fpr=0.0175 | 7422.2 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.06166 | acc=0.9807 | tpr=0.8807 | fpr=0.0175 | 7462.9 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.06154 | acc=0.9807 | tpr=0.8810 | fpr=0.0175 | 7873.0 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.06203 | acc=0.9805 | tpr=0.8824 | fpr=0.0177 | 7727.7 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.06354 | acc=0.9803 | tpr=0.8788 | fpr=0.0179 | 7158.5 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.06301 | acc=0.9804 | tpr=0.8793 | fpr=0.0177 | 7010.9 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.06245 | acc=0.9807 | tpr=0.8790 | fpr=0.0175 | 14699.0 samples/s | 57.4 steps/s
Avg test loss: 0.06231, Avg test acc: 0.98068, Avg tpr: 0.87876, Avg fpr: 0.01747, total FA: 2426

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.04201 | acc=0.9859 | tpr=0.8407 | fpr=0.0115 | 4017.5 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.04145 | acc=0.9852 | tpr=0.8507 | fpr=0.0123 | 7889.3 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.04257 | acc=0.9850 | tpr=0.8559 | fpr=0.0126 | 7615.5 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.04383 | acc=0.9847 | tpr=0.8579 | fpr=0.0130 | 7738.7 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.04362 | acc=0.9850 | tpr=0.8611 | fpr=0.0127 | 7599.0 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.04363 | acc=0.9848 | tpr=0.8538 | fpr=0.0128 | 7381.3 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.04357 | acc=0.9848 | tpr=0.8572 | fpr=0.0129 | 8077.5 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.04418 | acc=0.9848 | tpr=0.8567 | fpr=0.0129 | 7637.8 samples/s | 29.8 steps/s
[Step= 450] | Loss=0.04447 | acc=0.9847 | tpr=0.8539 | fpr=0.0129 | 8159.1 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.04413 | acc=0.9848 | tpr=0.8564 | fpr=0.0129 | 7770.2 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.04382 | acc=0.9849 | tpr=0.8552 | fpr=0.0127 | 12925.1 samples/s | 50.5 steps/s
Avg test loss: 0.04378, Avg test acc: 0.98493, Avg tpr: 0.85578, Avg fpr: 0.01272, total FA: 1766

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.04109 | acc=0.9754 | tpr=0.9513 | fpr=0.0242 | 4169.5 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.04039 | acc=0.9749 | tpr=0.9510 | fpr=0.0247 | 8301.6 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.04029 | acc=0.9751 | tpr=0.9539 | fpr=0.0246 | 7647.5 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.04092 | acc=0.9746 | tpr=0.9530 | fpr=0.0251 | 8164.2 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.04065 | acc=0.9744 | tpr=0.9502 | fpr=0.0252 | 7792.5 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.04047 | acc=0.9744 | tpr=0.9476 | fpr=0.0252 | 7400.2 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.04056 | acc=0.9742 | tpr=0.9474 | fpr=0.0253 | 7103.7 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.04099 | acc=0.9740 | tpr=0.9480 | fpr=0.0256 | 7485.9 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.04122 | acc=0.9738 | tpr=0.9440 | fpr=0.0257 | 7863.9 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.04125 | acc=0.9738 | tpr=0.9449 | fpr=0.0257 | 7844.4 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.04088 | acc=0.9739 | tpr=0.9415 | fpr=0.0255 | 13047.9 samples/s | 51.0 steps/s
Avg test loss: 0.04085, Avg test acc: 0.97394, Avg tpr: 0.94136, Avg fpr: 0.02547, total FA: 3536

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.06967 | acc=0.9799 | tpr=0.8761 | fpr=0.0182 | 3990.2 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.06951 | acc=0.9802 | tpr=0.8913 | fpr=0.0181 | 8116.0 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.07278 | acc=0.9797 | tpr=0.8919 | fpr=0.0187 | 8104.0 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.07484 | acc=0.9795 | tpr=0.8984 | fpr=0.0190 | 7368.4 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.07328 | acc=0.9798 | tpr=0.8978 | fpr=0.0187 | 7597.5 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.07433 | acc=0.9796 | tpr=0.8938 | fpr=0.0189 | 7340.5 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.07399 | acc=0.9797 | tpr=0.8979 | fpr=0.0188 | 7429.1 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.07412 | acc=0.9796 | tpr=0.8966 | fpr=0.0189 | 7639.2 samples/s | 29.8 steps/s
[Step= 450] | Loss=0.07550 | acc=0.9792 | tpr=0.8900 | fpr=0.0192 | 7444.3 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.07510 | acc=0.9794 | tpr=0.8925 | fpr=0.0190 | 7795.1 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.07406 | acc=0.9795 | tpr=0.8922 | fpr=0.0189 | 15061.7 samples/s | 58.8 steps/s
Avg test loss: 0.07397, Avg test acc: 0.97956, Avg tpr: 0.89223, Avg fpr: 0.01886, total FA: 2618

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.05628 | acc=0.9835 | tpr=0.8540 | fpr=0.0142 | 3939.9 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.05719 | acc=0.9827 | tpr=0.8699 | fpr=0.0152 | 7418.3 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.05893 | acc=0.9824 | tpr=0.8761 | fpr=0.0156 | 8505.4 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.05912 | acc=0.9823 | tpr=0.8776 | fpr=0.0158 | 7778.4 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.05917 | acc=0.9826 | tpr=0.8777 | fpr=0.0155 | 7839.8 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.06023 | acc=0.9820 | tpr=0.8684 | fpr=0.0159 | 7565.5 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.06027 | acc=0.9820 | tpr=0.8723 | fpr=0.0160 | 7398.4 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.06071 | acc=0.9819 | tpr=0.8709 | fpr=0.0161 | 7872.4 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.06214 | acc=0.9815 | tpr=0.8685 | fpr=0.0165 | 7604.9 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.06133 | acc=0.9817 | tpr=0.8683 | fpr=0.0163 | 7145.9 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.06085 | acc=0.9817 | tpr=0.8651 | fpr=0.0161 | 14563.3 samples/s | 56.9 steps/s
Avg test loss: 0.06082, Avg test acc: 0.98175, Avg tpr: 0.86529, Avg fpr: 0.01613, total FA: 2240

server round 5/10

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.2] | Loss=0.01760 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.805 | L2-Norm(final)=2.335 | 4662.2 samples/s | 72.8 steps/s
[Step=2550 Epoch=12.4] | Loss=0.01809 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.806 | L2-Norm(final)=2.333 | 4301.3 samples/s | 67.2 steps/s
[Step=2600 Epoch=12.7] | Loss=0.01633 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.799 | L2-Norm(final)=2.334 | 4647.4 samples/s | 72.6 steps/s
[Step=2650 Epoch=12.9] | Loss=0.01564 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.798 | L2-Norm(final)=2.337 | 4494.5 samples/s | 70.2 steps/s
[Step=2700 Epoch=13.2] | Loss=0.01575 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.798 | L2-Norm(final)=2.340 | 6029.1 samples/s | 94.2 steps/s
[Step=2750 Epoch=13.4] | Loss=0.01580 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.800 | L2-Norm(final)=2.341 | 1872.3 samples/s | 29.3 steps/s
[Step=2800 Epoch=13.7] | Loss=0.01474 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.803 | L2-Norm(final)=2.343 | 4555.7 samples/s | 71.2 steps/s
[Step=2850 Epoch=13.9] | Loss=0.01576 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.806 | L2-Norm(final)=2.344 | 4436.0 samples/s | 69.3 steps/s
[Step=2900 Epoch=14.1] | Loss=0.01658 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.812 | L2-Norm(final)=2.344 | 5325.1 samples/s | 83.2 steps/s
[Step=2950 Epoch=14.4] | Loss=0.01659 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.821 | L2-Norm(final)=2.344 | 1976.8 samples/s | 30.9 steps/s
[Step=3000 Epoch=14.6] | Loss=0.01666 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.829 | L2-Norm(final)=2.344 | 4594.3 samples/s | 71.8 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_0/client_state-step3000.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.2] | Loss=0.00335 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.987 | L2-Norm(final)=2.307 | 4637.3 samples/s | 72.5 steps/s
[Step=2550 Epoch=12.4] | Loss=0.00832 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.982 | L2-Norm(final)=2.314 | 4132.3 samples/s | 64.6 steps/s
[Step=2600 Epoch=12.7] | Loss=0.00871 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.975 | L2-Norm(final)=2.316 | 4656.9 samples/s | 72.8 steps/s
[Step=2650 Epoch=12.9] | Loss=0.01164 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.966 | L2-Norm(final)=2.314 | 4277.1 samples/s | 66.8 steps/s
[Step=2700 Epoch=13.2] | Loss=0.01129 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.958 | L2-Norm(final)=2.312 | 5913.8 samples/s | 92.4 steps/s
[Step=2750 Epoch=13.4] | Loss=0.01088 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.954 | L2-Norm(final)=2.314 | 1871.5 samples/s | 29.2 steps/s
[Step=2800 Epoch=13.7] | Loss=0.01262 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.949 | L2-Norm(final)=2.312 | 4359.5 samples/s | 68.1 steps/s
[Step=2850 Epoch=13.9] | Loss=0.01254 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.946 | L2-Norm(final)=2.310 | 4473.5 samples/s | 69.9 steps/s
[Step=2900 Epoch=14.2] | Loss=0.01313 | Reg=0.00322 | acc=0.9688 | L2-Norm=17.945 | L2-Norm(final)=2.309 | 5573.9 samples/s | 87.1 steps/s
[Step=2950 Epoch=14.4] | Loss=0.01336 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.945 | L2-Norm(final)=2.308 | 1975.1 samples/s | 30.9 steps/s
[Step=3000 Epoch=14.6] | Loss=0.01319 | Reg=0.00322 | acc=0.9688 | L2-Norm=17.946 | L2-Norm(final)=2.307 | 4641.5 samples/s | 72.5 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_1/client_state-step3000.h5

Train client 2: client_asml1_2
Local layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.2] | Loss=0.01049 | Reg=0.00338 | acc=0.9844 | L2-Norm=18.381 | L2-Norm(final)=2.317 | 4225.9 samples/s | 66.0 steps/s
[Step=2550 Epoch=12.4] | Loss=0.01625 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.383 | L2-Norm(final)=2.316 | 4286.1 samples/s | 67.0 steps/s
[Step=2600 Epoch=12.7] | Loss=0.01593 | Reg=0.00338 | acc=0.9844 | L2-Norm=18.394 | L2-Norm(final)=2.319 | 4382.7 samples/s | 68.5 steps/s
[Step=2650 Epoch=12.9] | Loss=0.01886 | Reg=0.00339 | acc=0.9844 | L2-Norm=18.403 | L2-Norm(final)=2.320 | 4328.1 samples/s | 67.6 steps/s
[Step=2700 Epoch=13.2] | Loss=0.02043 | Reg=0.00339 | acc=0.9844 | L2-Norm=18.412 | L2-Norm(final)=2.318 | 5831.0 samples/s | 91.1 steps/s
[Step=2750 Epoch=13.4] | Loss=0.01867 | Reg=0.00339 | acc=0.9844 | L2-Norm=18.421 | L2-Norm(final)=2.317 | 1978.2 samples/s | 30.9 steps/s
[Step=2800 Epoch=13.6] | Loss=0.01820 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.425 | L2-Norm(final)=2.316 | 4555.1 samples/s | 71.2 steps/s
[Step=2850 Epoch=13.9] | Loss=0.01736 | Reg=0.00340 | acc=0.9844 | L2-Norm=18.430 | L2-Norm(final)=2.317 | 4630.2 samples/s | 72.3 steps/s
[Step=2900 Epoch=14.1] | Loss=0.01785 | Reg=0.00340 | acc=0.9844 | L2-Norm=18.436 | L2-Norm(final)=2.316 | 5460.3 samples/s | 85.3 steps/s
[Step=2950 Epoch=14.4] | Loss=0.01740 | Reg=0.00340 | acc=0.9844 | L2-Norm=18.443 | L2-Norm(final)=2.316 | 1980.8 samples/s | 31.0 steps/s
[Step=3000 Epoch=14.6] | Loss=0.01710 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.449 | L2-Norm(final)=2.316 | 4693.3 samples/s | 73.3 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_2/client_state-step3000.h5

Train client 3: client_asml1_3
Local layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.2] | Loss=0.00204 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.949 | L2-Norm(final)=2.371 | 4127.3 samples/s | 64.5 steps/s
[Step=2550 Epoch=12.4] | Loss=0.01481 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.933 | L2-Norm(final)=2.373 | 4420.1 samples/s | 69.1 steps/s
[Step=2600 Epoch=12.7] | Loss=0.01359 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.915 | L2-Norm(final)=2.369 | 4717.9 samples/s | 73.7 steps/s
[Step=2650 Epoch=12.9] | Loss=0.01213 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.902 | L2-Norm(final)=2.370 | 4552.6 samples/s | 71.1 steps/s
[Step=2700 Epoch=13.2] | Loss=0.01169 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.894 | L2-Norm(final)=2.373 | 5816.4 samples/s | 90.9 steps/s
[Step=2750 Epoch=13.4] | Loss=0.01292 | Reg=0.00320 | acc=0.9688 | L2-Norm=17.886 | L2-Norm(final)=2.375 | 1918.1 samples/s | 30.0 steps/s
[Step=2800 Epoch=13.7] | Loss=0.01247 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.879 | L2-Norm(final)=2.374 | 4327.5 samples/s | 67.6 steps/s
[Step=2850 Epoch=13.9] | Loss=0.01290 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.873 | L2-Norm(final)=2.374 | 4260.8 samples/s | 66.6 steps/s
[Step=2900 Epoch=14.1] | Loss=0.01321 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.871 | L2-Norm(final)=2.374 | 5391.0 samples/s | 84.2 steps/s
[Step=2950 Epoch=14.4] | Loss=0.01302 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.872 | L2-Norm(final)=2.374 | 1997.3 samples/s | 31.2 steps/s
[Step=3000 Epoch=14.6] | Loss=0.01448 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.873 | L2-Norm(final)=2.373 | 4595.6 samples/s | 71.8 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_3/client_state-step3000.h5

Train client 4: client_asml1_4
Local layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.3] | Loss=0.00228 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.065 | L2-Norm(final)=2.353 | 4848.1 samples/s | 75.8 steps/s
[Step=2550 Epoch=12.5] | Loss=0.01545 | Reg=0.00326 | acc=0.9688 | L2-Norm=18.061 | L2-Norm(final)=2.353 | 3881.1 samples/s | 60.6 steps/s
[Step=2600 Epoch=12.7] | Loss=0.01568 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.060 | L2-Norm(final)=2.355 | 4527.5 samples/s | 70.7 steps/s
[Step=2650 Epoch=13.0] | Loss=0.01672 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.068 | L2-Norm(final)=2.355 | 4398.9 samples/s | 68.7 steps/s
[Step=2700 Epoch=13.2] | Loss=0.01835 | Reg=0.00327 | acc=0.9688 | L2-Norm=18.076 | L2-Norm(final)=2.351 | 5797.5 samples/s | 90.6 steps/s
[Step=2750 Epoch=13.5] | Loss=0.01708 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.085 | L2-Norm(final)=2.350 | 1907.1 samples/s | 29.8 steps/s
[Step=2800 Epoch=13.7] | Loss=0.01727 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.092 | L2-Norm(final)=2.350 | 4420.6 samples/s | 69.1 steps/s
[Step=2850 Epoch=14.0] | Loss=0.01719 | Reg=0.00327 | acc=0.9531 | L2-Norm=18.096 | L2-Norm(final)=2.349 | 4340.5 samples/s | 67.8 steps/s
[Step=2900 Epoch=14.2] | Loss=0.01666 | Reg=0.00328 | acc=0.9688 | L2-Norm=18.099 | L2-Norm(final)=2.349 | 5952.8 samples/s | 93.0 steps/s
[Step=2950 Epoch=14.5] | Loss=0.01645 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.102 | L2-Norm(final)=2.350 | 1999.2 samples/s | 31.2 steps/s
[Step=3000 Epoch=14.7] | Loss=0.01612 | Reg=0.00328 | acc=0.9844 | L2-Norm=18.106 | L2-Norm(final)=2.351 | 4510.5 samples/s | 70.5 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_4/client_state-step3000.h5

Train client 5: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.7] | Loss=0.00000 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.218 | L2-Norm(final)=2.759 | 4479.4 samples/s | 70.0 steps/s
[Step=2550 Epoch=24.2] | Loss=0.00000 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.172 | L2-Norm(final)=2.768 | 3728.3 samples/s | 58.3 steps/s
[Step=2600 Epoch=24.6] | Loss=0.00000 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.126 | L2-Norm(final)=2.780 | 5631.8 samples/s | 88.0 steps/s
[Step=2650 Epoch=25.1] | Loss=0.00000 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.080 | L2-Norm(final)=2.791 | 1842.5 samples/s | 28.8 steps/s
[Step=2700 Epoch=25.6] | Loss=0.00000 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.035 | L2-Norm(final)=2.804 | 5256.4 samples/s | 82.1 steps/s
[Step=2750 Epoch=26.1] | Loss=0.00000 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.990 | L2-Norm(final)=2.816 | 1892.3 samples/s | 29.6 steps/s
[Step=2800 Epoch=26.5] | Loss=0.00000 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.945 | L2-Norm(final)=2.827 | 4957.1 samples/s | 77.5 steps/s
[Step=2850 Epoch=27.0] | Loss=0.00000 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.899 | L2-Norm(final)=2.838 | 2000.1 samples/s | 31.3 steps/s
[Step=2900 Epoch=27.5] | Loss=0.00000 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.854 | L2-Norm(final)=2.849 | 4452.3 samples/s | 69.6 steps/s
[Step=2950 Epoch=28.0] | Loss=0.00000 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.808 | L2-Norm(final)=2.861 | 2016.8 samples/s | 31.5 steps/s
[Step=3000 Epoch=28.4] | Loss=0.00000 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.763 | L2-Norm(final)=2.872 | 4299.7 samples/s | 67.2 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_0/client_state-step3000.h5

Train client 6: client_iccad2012_1
Local layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.8] | Loss=0.00001 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.504 | L2-Norm(final)=2.629 | 4639.3 samples/s | 72.5 steps/s
[Step=2550 Epoch=24.3] | Loss=0.00000 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.462 | L2-Norm(final)=2.642 | 3644.8 samples/s | 57.0 steps/s
[Step=2600 Epoch=24.7] | Loss=0.00000 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.418 | L2-Norm(final)=2.654 | 5439.5 samples/s | 85.0 steps/s
[Step=2650 Epoch=25.2] | Loss=0.00000 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=2.667 | 1837.8 samples/s | 28.7 steps/s
[Step=2700 Epoch=25.7] | Loss=0.00000 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.332 | L2-Norm(final)=2.679 | 5301.5 samples/s | 82.8 steps/s
[Step=2750 Epoch=26.2] | Loss=0.00000 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.289 | L2-Norm(final)=2.692 | 1961.3 samples/s | 30.6 steps/s
[Step=2800 Epoch=26.6] | Loss=0.00000 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.246 | L2-Norm(final)=2.705 | 5133.9 samples/s | 80.2 steps/s
[Step=2850 Epoch=27.1] | Loss=0.00000 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.204 | L2-Norm(final)=2.718 | 2021.9 samples/s | 31.6 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00000 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.161 | L2-Norm(final)=2.732 | 4674.7 samples/s | 73.0 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00000 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.118 | L2-Norm(final)=2.746 | 1999.1 samples/s | 31.2 steps/s
[Step=3000 Epoch=28.5] | Loss=0.00000 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.075 | L2-Norm(final)=2.760 | 4280.7 samples/s | 66.9 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_1/client_state-step3000.h5

Train client 7: client_iccad2012_2
Local layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.9] | Loss=0.00685 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.265 | L2-Norm(final)=2.557 | 4202.1 samples/s | 65.7 steps/s
[Step=2550 Epoch=24.4] | Loss=0.00781 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.292 | L2-Norm(final)=2.563 | 4199.4 samples/s | 65.6 steps/s
[Step=2600 Epoch=24.8] | Loss=0.00540 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.311 | L2-Norm(final)=2.571 | 5831.0 samples/s | 91.1 steps/s
[Step=2650 Epoch=25.3] | Loss=0.00373 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.311 | L2-Norm(final)=2.578 | 1901.1 samples/s | 29.7 steps/s
[Step=2700 Epoch=25.8] | Loss=0.00285 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.302 | L2-Norm(final)=2.582 | 5587.2 samples/s | 87.3 steps/s
[Step=2750 Epoch=26.3] | Loss=0.00232 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.287 | L2-Norm(final)=2.586 | 1848.2 samples/s | 28.9 steps/s
[Step=2800 Epoch=26.7] | Loss=0.00195 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.270 | L2-Norm(final)=2.588 | 4848.8 samples/s | 75.8 steps/s
[Step=2850 Epoch=27.2] | Loss=0.00167 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.251 | L2-Norm(final)=2.590 | 1880.0 samples/s | 29.4 steps/s
[Step=2900 Epoch=27.7] | Loss=0.00147 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.232 | L2-Norm(final)=2.592 | 4909.2 samples/s | 76.7 steps/s
[Step=2950 Epoch=28.2] | Loss=0.00131 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.212 | L2-Norm(final)=2.594 | 1891.2 samples/s | 29.5 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00119 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.192 | L2-Norm(final)=2.595 | 4485.6 samples/s | 70.1 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_2/client_state-step3000.h5

Train client 8: client_iccad2012_3
Local layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.6] | Loss=0.00005 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.799 | L2-Norm(final)=2.719 | 4396.3 samples/s | 68.7 steps/s
[Step=2550 Epoch=24.0] | Loss=0.00001 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.761 | L2-Norm(final)=2.729 | 3797.1 samples/s | 59.3 steps/s
[Step=2600 Epoch=24.5] | Loss=0.00000 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.720 | L2-Norm(final)=2.739 | 5535.3 samples/s | 86.5 steps/s
[Step=2650 Epoch=25.0] | Loss=0.00000 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.679 | L2-Norm(final)=2.747 | 1805.4 samples/s | 28.2 steps/s
[Step=2700 Epoch=25.4] | Loss=0.00000 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.638 | L2-Norm(final)=2.756 | 5120.6 samples/s | 80.0 steps/s
[Step=2750 Epoch=25.9] | Loss=0.00000 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.597 | L2-Norm(final)=2.766 | 1910.7 samples/s | 29.9 steps/s
[Step=2800 Epoch=26.4] | Loss=0.00000 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.556 | L2-Norm(final)=2.776 | 4849.3 samples/s | 75.8 steps/s
[Step=2850 Epoch=26.9] | Loss=0.00000 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.516 | L2-Norm(final)=2.786 | 2006.7 samples/s | 31.4 steps/s
[Step=2900 Epoch=27.3] | Loss=0.00000 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.475 | L2-Norm(final)=2.796 | 4338.0 samples/s | 67.8 steps/s
[Step=2950 Epoch=27.8] | Loss=0.00000 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.434 | L2-Norm(final)=2.806 | 2032.1 samples/s | 31.8 steps/s
[Step=3000 Epoch=28.3] | Loss=0.00000 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.394 | L2-Norm(final)=2.817 | 4349.9 samples/s | 68.0 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_3/client_state-step3000.h5

Train client 9: client_iccad2012_4
Local layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.8] | Loss=0.00000 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.612 | L2-Norm(final)=2.675 | 4051.0 samples/s | 63.3 steps/s
[Step=2550 Epoch=24.3] | Loss=0.00001 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.573 | L2-Norm(final)=2.689 | 4292.0 samples/s | 67.1 steps/s
[Step=2600 Epoch=24.8] | Loss=0.00001 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.539 | L2-Norm(final)=2.700 | 5856.1 samples/s | 91.5 steps/s
[Step=2650 Epoch=25.3] | Loss=0.00001 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.501 | L2-Norm(final)=2.711 | 1797.2 samples/s | 28.1 steps/s
[Step=2700 Epoch=25.7] | Loss=0.00001 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.462 | L2-Norm(final)=2.720 | 5585.5 samples/s | 87.3 steps/s
[Step=2750 Epoch=26.2] | Loss=0.00001 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.422 | L2-Norm(final)=2.730 | 1895.6 samples/s | 29.6 steps/s
[Step=2800 Epoch=26.7] | Loss=0.00000 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.382 | L2-Norm(final)=2.740 | 4898.0 samples/s | 76.5 steps/s
[Step=2850 Epoch=27.2] | Loss=0.00000 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.342 | L2-Norm(final)=2.750 | 1963.2 samples/s | 30.7 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00000 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.303 | L2-Norm(final)=2.761 | 4928.7 samples/s | 77.0 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00000 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.263 | L2-Norm(final)=2.773 | 2047.6 samples/s | 32.0 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00000 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.224 | L2-Norm(final)=2.784 | 4440.6 samples/s | 69.4 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_4/client_state-step3000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.18852 | acc=0.9288 | tpr=0.9552 | fpr=0.1283 | 3898.3 samples/s | 15.2 steps/s
Avg test loss: 0.19121, Avg test acc: 0.92728, Avg tpr: 0.95413, Avg fpr: 0.13178, total FA: 1028

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.20722 | acc=0.9259 | tpr=0.9676 | fpr=0.1648 | 4162.5 samples/s | 16.3 steps/s
Avg test loss: 0.21050, Avg test acc: 0.92547, Avg tpr: 0.96643, Avg fpr: 0.16459, total FA: 1284

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.16065 | acc=0.9249 | tpr=0.9464 | fpr=0.1217 | 4247.5 samples/s | 16.6 steps/s
Avg test loss: 0.16009, Avg test acc: 0.92407, Avg tpr: 0.94498, Avg fpr: 0.12191, total FA: 951

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.16379 | acc=0.9077 | tpr=0.9068 | fpr=0.0902 | 4077.7 samples/s | 15.9 steps/s
Avg test loss: 0.16847, Avg test acc: 0.90524, Avg tpr: 0.90488, Avg fpr: 0.09396, total FA: 733

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.19557 | acc=0.9253 | tpr=0.9375 | fpr=0.1011 | 4036.5 samples/s | 15.8 steps/s
Avg test loss: 0.19851, Avg test acc: 0.92479, Avg tpr: 0.93664, Avg fpr: 0.10127, total FA: 790

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.32738 | acc=0.3162 | tpr=0.0067 | fpr=0.0116 | 4103.4 samples/s | 16.0 steps/s
Avg test loss: 6.35659, Avg test acc: 0.31345, Avg tpr: 0.00682, Avg fpr: 0.01218, total FA: 95

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.93223 | acc=0.3084 | tpr=0.0220 | fpr=0.0696 | 4008.4 samples/s | 15.7 steps/s
Avg test loss: 4.95313, Avg test acc: 0.30708, Avg tpr: 0.02232, Avg fpr: 0.06666, total FA: 520

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=6.62569 | acc=0.3140 | tpr=0.0120 | fpr=0.0302 | 4076.3 samples/s | 15.9 steps/s
Avg test loss: 6.64677, Avg test acc: 0.31128, Avg tpr: 0.01201, Avg fpr: 0.03051, total FA: 238

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.05760 | acc=0.3133 | tpr=0.0196 | fpr=0.0491 | 4009.2 samples/s | 15.7 steps/s
Avg test loss: 5.07915, Avg test acc: 0.31224, Avg tpr: 0.02145, Avg fpr: 0.04820, total FA: 376

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.66958 | acc=0.3158 | tpr=0.0095 | fpr=0.0191 | 4054.7 samples/s | 15.8 steps/s
Avg test loss: 5.68776, Avg test acc: 0.31293, Avg tpr: 0.00915, Avg fpr: 0.01897, total FA: 148

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.13364 | acc=0.1211 | tpr=0.9381 | fpr=0.8936 | 3966.1 samples/s | 15.5 steps/s
[Step= 100] | Loss=5.13494 | acc=0.1233 | tpr=0.9339 | fpr=0.8918 | 7207.6 samples/s | 28.2 steps/s
[Step= 150] | Loss=5.14927 | acc=0.1218 | tpr=0.9193 | fpr=0.8929 | 8087.9 samples/s | 31.6 steps/s
[Step= 200] | Loss=5.14139 | acc=0.1221 | tpr=0.9202 | fpr=0.8924 | 7436.8 samples/s | 29.1 steps/s
[Step= 250] | Loss=5.15022 | acc=0.1227 | tpr=0.9249 | fpr=0.8919 | 7348.8 samples/s | 28.7 steps/s
[Step= 300] | Loss=5.15796 | acc=0.1221 | tpr=0.9207 | fpr=0.8924 | 7244.7 samples/s | 28.3 steps/s
[Step= 350] | Loss=5.15828 | acc=0.1222 | tpr=0.9236 | fpr=0.8923 | 7523.9 samples/s | 29.4 steps/s
[Step= 400] | Loss=5.15846 | acc=0.1224 | tpr=0.9245 | fpr=0.8922 | 7609.0 samples/s | 29.7 steps/s
[Step= 450] | Loss=5.15705 | acc=0.1226 | tpr=0.9221 | fpr=0.8920 | 7577.8 samples/s | 29.6 steps/s
[Step= 500] | Loss=5.16176 | acc=0.1222 | tpr=0.9251 | fpr=0.8922 | 7692.1 samples/s | 30.0 steps/s
[Step= 550] | Loss=5.15970 | acc=0.1223 | tpr=0.9232 | fpr=0.8923 | 14167.7 samples/s | 55.3 steps/s
Avg test loss: 5.16078, Avg test acc: 0.12220, Avg tpr: 0.92353, Avg fpr: 0.89236, total FA: 123903

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.77720 | acc=0.0847 | tpr=0.9602 | fpr=0.9310 | 4030.2 samples/s | 15.7 steps/s
[Step= 100] | Loss=4.73854 | acc=0.0861 | tpr=0.9574 | fpr=0.9302 | 7076.8 samples/s | 27.6 steps/s
[Step= 150] | Loss=4.76181 | acc=0.0852 | tpr=0.9452 | fpr=0.9306 | 7710.8 samples/s | 30.1 steps/s
[Step= 200] | Loss=4.75350 | acc=0.0855 | tpr=0.9454 | fpr=0.9301 | 8193.2 samples/s | 32.0 steps/s
[Step= 250] | Loss=4.75861 | acc=0.0854 | tpr=0.9371 | fpr=0.9301 | 7786.5 samples/s | 30.4 steps/s
[Step= 300] | Loss=4.75975 | acc=0.0851 | tpr=0.9331 | fpr=0.9304 | 7957.6 samples/s | 31.1 steps/s
[Step= 350] | Loss=4.75825 | acc=0.0845 | tpr=0.9324 | fpr=0.9309 | 7209.8 samples/s | 28.2 steps/s
[Step= 400] | Loss=4.75648 | acc=0.0844 | tpr=0.9360 | fpr=0.9310 | 7611.8 samples/s | 29.7 steps/s
[Step= 450] | Loss=4.75740 | acc=0.0844 | tpr=0.9367 | fpr=0.9311 | 7108.5 samples/s | 27.8 steps/s
[Step= 500] | Loss=4.75953 | acc=0.0841 | tpr=0.9370 | fpr=0.9313 | 7268.0 samples/s | 28.4 steps/s
[Step= 550] | Loss=4.75729 | acc=0.0844 | tpr=0.9383 | fpr=0.9311 | 14893.0 samples/s | 58.2 steps/s
Avg test loss: 4.75797, Avg test acc: 0.08430, Avg tpr: 0.93780, Avg fpr: 0.93122, total FA: 129298

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.19243 | acc=0.1288 | tpr=0.8496 | fpr=0.8841 | 4366.7 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.16620 | acc=0.1312 | tpr=0.8230 | fpr=0.8817 | 6701.5 samples/s | 26.2 steps/s
[Step= 150] | Loss=4.16832 | acc=0.1318 | tpr=0.8256 | fpr=0.8809 | 7177.8 samples/s | 28.0 steps/s
[Step= 200] | Loss=4.15822 | acc=0.1319 | tpr=0.8240 | fpr=0.8807 | 7676.7 samples/s | 30.0 steps/s
[Step= 250] | Loss=4.16088 | acc=0.1328 | tpr=0.8306 | fpr=0.8799 | 7899.7 samples/s | 30.9 steps/s
[Step= 300] | Loss=4.16167 | acc=0.1324 | tpr=0.8327 | fpr=0.8804 | 7323.2 samples/s | 28.6 steps/s
[Step= 350] | Loss=4.15734 | acc=0.1321 | tpr=0.8316 | fpr=0.8806 | 7745.2 samples/s | 30.3 steps/s
[Step= 400] | Loss=4.15811 | acc=0.1321 | tpr=0.8348 | fpr=0.8807 | 7515.6 samples/s | 29.4 steps/s
[Step= 450] | Loss=4.16205 | acc=0.1315 | tpr=0.8359 | fpr=0.8813 | 7423.0 samples/s | 29.0 steps/s
[Step= 500] | Loss=4.16368 | acc=0.1314 | tpr=0.8392 | fpr=0.8813 | 7900.0 samples/s | 30.9 steps/s
[Step= 550] | Loss=4.16450 | acc=0.1315 | tpr=0.8400 | fpr=0.8813 | 14334.6 samples/s | 56.0 steps/s
Avg test loss: 4.16616, Avg test acc: 0.13139, Avg tpr: 0.84033, Avg fpr: 0.88150, total FA: 122394

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=2.59783 | acc=0.2316 | tpr=0.5752 | fpr=0.7745 | 4051.4 samples/s | 15.8 steps/s
[Step= 100] | Loss=2.59014 | acc=0.2350 | tpr=0.5991 | fpr=0.7718 | 7557.6 samples/s | 29.5 steps/s
[Step= 150] | Loss=2.57520 | acc=0.2356 | tpr=0.5908 | fpr=0.7709 | 7030.8 samples/s | 27.5 steps/s
[Step= 200] | Loss=2.57131 | acc=0.2367 | tpr=0.5891 | fpr=0.7698 | 7509.3 samples/s | 29.3 steps/s
[Step= 250] | Loss=2.57833 | acc=0.2367 | tpr=0.6017 | fpr=0.7699 | 7564.2 samples/s | 29.5 steps/s
[Step= 300] | Loss=2.57460 | acc=0.2363 | tpr=0.6022 | fpr=0.7703 | 7896.6 samples/s | 30.8 steps/s
[Step= 350] | Loss=2.57314 | acc=0.2359 | tpr=0.6018 | fpr=0.7708 | 7274.8 samples/s | 28.4 steps/s
[Step= 400] | Loss=2.57209 | acc=0.2366 | tpr=0.6045 | fpr=0.7701 | 8307.8 samples/s | 32.5 steps/s
[Step= 450] | Loss=2.57235 | acc=0.2363 | tpr=0.5993 | fpr=0.7703 | 7385.2 samples/s | 28.8 steps/s
[Step= 500] | Loss=2.57330 | acc=0.2364 | tpr=0.5996 | fpr=0.7701 | 7338.3 samples/s | 28.7 steps/s
[Step= 550] | Loss=2.57419 | acc=0.2360 | tpr=0.6049 | fpr=0.7707 | 13570.5 samples/s | 53.0 steps/s
Avg test loss: 2.57512, Avg test acc: 0.23594, Avg tpr: 0.60578, Avg fpr: 0.77078, total FA: 107021

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.00822 | acc=0.1280 | tpr=0.7345 | fpr=0.8829 | 3998.1 samples/s | 15.6 steps/s
[Step= 100] | Loss=4.99453 | acc=0.1309 | tpr=0.7484 | fpr=0.8806 | 7926.2 samples/s | 31.0 steps/s
[Step= 150] | Loss=4.99744 | acc=0.1310 | tpr=0.7421 | fpr=0.8803 | 7772.1 samples/s | 30.4 steps/s
[Step= 200] | Loss=4.99471 | acc=0.1318 | tpr=0.7464 | fpr=0.8794 | 7888.0 samples/s | 30.8 steps/s
[Step= 250] | Loss=5.00447 | acc=0.1317 | tpr=0.7441 | fpr=0.8795 | 7658.5 samples/s | 29.9 steps/s
[Step= 300] | Loss=5.01199 | acc=0.1317 | tpr=0.7455 | fpr=0.8795 | 7633.6 samples/s | 29.8 steps/s
[Step= 350] | Loss=5.01329 | acc=0.1317 | tpr=0.7489 | fpr=0.8795 | 8647.3 samples/s | 33.8 steps/s
[Step= 400] | Loss=5.01056 | acc=0.1318 | tpr=0.7593 | fpr=0.8796 | 8018.4 samples/s | 31.3 steps/s
[Step= 450] | Loss=5.01372 | acc=0.1316 | tpr=0.7644 | fpr=0.8799 | 7428.2 samples/s | 29.0 steps/s
[Step= 500] | Loss=5.01420 | acc=0.1314 | tpr=0.7652 | fpr=0.8800 | 7548.4 samples/s | 29.5 steps/s
[Step= 550] | Loss=5.01304 | acc=0.1313 | tpr=0.7700 | fpr=0.8803 | 14344.9 samples/s | 56.0 steps/s
Avg test loss: 5.01377, Avg test acc: 0.13114, Avg tpr: 0.77021, Avg fpr: 0.88047, total FA: 122252

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.05997 | acc=0.9808 | tpr=0.8407 | fpr=0.0167 | 3953.4 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.05973 | acc=0.9808 | tpr=0.8635 | fpr=0.0170 | 7887.0 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.06169 | acc=0.9803 | tpr=0.8746 | fpr=0.0177 | 6898.5 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.06293 | acc=0.9804 | tpr=0.8820 | fpr=0.0179 | 7431.2 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.06285 | acc=0.9803 | tpr=0.8847 | fpr=0.0179 | 7521.4 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.06354 | acc=0.9803 | tpr=0.8836 | fpr=0.0179 | 7445.5 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.06343 | acc=0.9803 | tpr=0.8842 | fpr=0.0180 | 7752.4 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.06394 | acc=0.9801 | tpr=0.8862 | fpr=0.0182 | 7473.1 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.06546 | acc=0.9799 | tpr=0.8827 | fpr=0.0183 | 7514.4 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.06493 | acc=0.9801 | tpr=0.8833 | fpr=0.0182 | 7106.8 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.06433 | acc=0.9803 | tpr=0.8838 | fpr=0.0179 | 14776.7 samples/s | 57.7 steps/s
Avg test loss: 0.06419, Avg test acc: 0.98030, Avg tpr: 0.88352, Avg fpr: 0.01794, total FA: 2491

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.05038 | acc=0.9836 | tpr=0.8540 | fpr=0.0141 | 4023.8 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.05024 | acc=0.9830 | tpr=0.8721 | fpr=0.0149 | 7970.9 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.05163 | acc=0.9827 | tpr=0.8761 | fpr=0.0153 | 7298.9 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.05329 | acc=0.9826 | tpr=0.8842 | fpr=0.0156 | 7712.2 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.05293 | acc=0.9830 | tpr=0.8865 | fpr=0.0153 | 7707.9 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.05296 | acc=0.9828 | tpr=0.8815 | fpr=0.0154 | 7534.4 samples/s | 29.4 steps/s
[Step= 350] | Loss=0.05296 | acc=0.9828 | tpr=0.8848 | fpr=0.0154 | 7250.6 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.05356 | acc=0.9827 | tpr=0.8824 | fpr=0.0154 | 8035.1 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.05389 | acc=0.9827 | tpr=0.8812 | fpr=0.0155 | 7172.5 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.05355 | acc=0.9828 | tpr=0.8819 | fpr=0.0154 | 7761.3 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.05313 | acc=0.9829 | tpr=0.8810 | fpr=0.0153 | 12892.6 samples/s | 50.4 steps/s
Avg test loss: 0.05308, Avg test acc: 0.98287, Avg tpr: 0.88154, Avg fpr: 0.01529, total FA: 2123

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.04644 | acc=0.9839 | tpr=0.9159 | fpr=0.0149 | 4100.1 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.04555 | acc=0.9833 | tpr=0.9275 | fpr=0.0157 | 7491.6 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.04577 | acc=0.9832 | tpr=0.9323 | fpr=0.0159 | 7747.6 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.04598 | acc=0.9829 | tpr=0.9333 | fpr=0.0161 | 7678.8 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.04601 | acc=0.9829 | tpr=0.9328 | fpr=0.0162 | 7801.4 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.04622 | acc=0.9828 | tpr=0.9295 | fpr=0.0162 | 7751.4 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.04607 | acc=0.9829 | tpr=0.9299 | fpr=0.0162 | 8306.6 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.04673 | acc=0.9826 | tpr=0.9300 | fpr=0.0164 | 7674.8 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.04710 | acc=0.9824 | tpr=0.9270 | fpr=0.0166 | 7394.2 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.04708 | acc=0.9826 | tpr=0.9295 | fpr=0.0164 | 7490.9 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.04664 | acc=0.9827 | tpr=0.9272 | fpr=0.0163 | 13967.7 samples/s | 54.6 steps/s
Avg test loss: 0.04658, Avg test acc: 0.98272, Avg tpr: 0.92750, Avg fpr: 0.01628, total FA: 2260

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.06720 | acc=0.9806 | tpr=0.8673 | fpr=0.0173 | 3950.3 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.06717 | acc=0.9807 | tpr=0.8763 | fpr=0.0174 | 7384.1 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.07034 | acc=0.9803 | tpr=0.8775 | fpr=0.0178 | 7878.8 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.07242 | acc=0.9802 | tpr=0.8863 | fpr=0.0181 | 7465.8 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.07092 | acc=0.9805 | tpr=0.8865 | fpr=0.0178 | 7988.0 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.07194 | acc=0.9804 | tpr=0.8844 | fpr=0.0179 | 7615.2 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.07160 | acc=0.9804 | tpr=0.8892 | fpr=0.0179 | 7996.9 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.07174 | acc=0.9803 | tpr=0.8889 | fpr=0.0180 | 7541.3 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.07308 | acc=0.9800 | tpr=0.8827 | fpr=0.0183 | 7664.8 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.07270 | acc=0.9801 | tpr=0.8850 | fpr=0.0182 | 7965.4 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.07170 | acc=0.9803 | tpr=0.8850 | fpr=0.0180 | 13319.5 samples/s | 52.0 steps/s
Avg test loss: 0.07161, Avg test acc: 0.98029, Avg tpr: 0.88510, Avg fpr: 0.01798, total FA: 2496

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.06725 | acc=0.9810 | tpr=0.8673 | fpr=0.0169 | 4109.1 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.06851 | acc=0.9806 | tpr=0.8870 | fpr=0.0176 | 7517.1 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.07067 | acc=0.9804 | tpr=0.8919 | fpr=0.0179 | 8091.6 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.07117 | acc=0.9803 | tpr=0.8951 | fpr=0.0182 | 7696.2 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.07108 | acc=0.9803 | tpr=0.8952 | fpr=0.0182 | 7507.8 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.07232 | acc=0.9799 | tpr=0.8887 | fpr=0.0185 | 7941.1 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.07248 | acc=0.9797 | tpr=0.8923 | fpr=0.0187 | 7907.6 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.07298 | acc=0.9796 | tpr=0.8906 | fpr=0.0188 | 7872.9 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.07466 | acc=0.9792 | tpr=0.8870 | fpr=0.0191 | 7667.4 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.07369 | acc=0.9794 | tpr=0.8863 | fpr=0.0189 | 6995.8 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.07309 | acc=0.9796 | tpr=0.8846 | fpr=0.0187 | 15913.0 samples/s | 62.2 steps/s
Avg test loss: 0.07304, Avg test acc: 0.97959, Avg tpr: 0.88471, Avg fpr: 0.01868, total FA: 2594

server round 6/10

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=3001 Epoch=14.6] | Loss=0.05338 | Reg=0.00321 | acc=0.9688 | L2-Norm=17.909 | L2-Norm(final)=2.339 | 4472.8 samples/s | 69.9 steps/s
[Step=3050 Epoch=14.9] | Loss=0.01672 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.915 | L2-Norm(final)=2.337 | 4356.8 samples/s | 68.1 steps/s
[Step=3100 Epoch=15.1] | Loss=0.01608 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.924 | L2-Norm(final)=2.339 | 4355.3 samples/s | 68.1 steps/s
[Step=3150 Epoch=15.4] | Loss=0.01660 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.925 | L2-Norm(final)=2.336 | 4327.5 samples/s | 67.6 steps/s
[Step=3200 Epoch=15.6] | Loss=0.01687 | Reg=0.00321 | acc=0.9688 | L2-Norm=17.928 | L2-Norm(final)=2.332 | 5949.1 samples/s | 93.0 steps/s
[Step=3250 Epoch=15.8] | Loss=0.01631 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.930 | L2-Norm(final)=2.331 | 1917.9 samples/s | 30.0 steps/s
[Step=3300 Epoch=16.1] | Loss=0.01548 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.932 | L2-Norm(final)=2.330 | 4572.7 samples/s | 71.4 steps/s
[Step=3350 Epoch=16.3] | Loss=0.01593 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.932 | L2-Norm(final)=2.329 | 4455.1 samples/s | 69.6 steps/s
[Step=3400 Epoch=16.6] | Loss=0.01665 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.934 | L2-Norm(final)=2.326 | 5798.6 samples/s | 90.6 steps/s
[Step=3450 Epoch=16.8] | Loss=0.01608 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.937 | L2-Norm(final)=2.324 | 2006.3 samples/s | 31.3 steps/s
[Step=3500 Epoch=17.1] | Loss=0.01566 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.940 | L2-Norm(final)=2.323 | 4402.0 samples/s | 68.8 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_0/client_state-step3500.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00100, len=1
[Step=3001 Epoch=14.6] | Loss=0.02590 | Reg=0.00322 | acc=0.9688 | L2-Norm=17.956 | L2-Norm(final)=2.303 | 4471.6 samples/s | 69.9 steps/s
[Step=3050 Epoch=14.9] | Loss=0.01220 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.951 | L2-Norm(final)=2.304 | 4230.1 samples/s | 66.1 steps/s
[Step=3100 Epoch=15.1] | Loss=0.01298 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.950 | L2-Norm(final)=2.305 | 4569.5 samples/s | 71.4 steps/s
[Step=3150 Epoch=15.4] | Loss=0.01381 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.956 | L2-Norm(final)=2.302 | 4474.3 samples/s | 69.9 steps/s
[Step=3200 Epoch=15.6] | Loss=0.01307 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.962 | L2-Norm(final)=2.303 | 6189.4 samples/s | 96.7 steps/s
[Step=3250 Epoch=15.9] | Loss=0.01326 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.968 | L2-Norm(final)=2.303 | 2008.5 samples/s | 31.4 steps/s
[Step=3300 Epoch=16.1] | Loss=0.01337 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.977 | L2-Norm(final)=2.304 | 4580.4 samples/s | 71.6 steps/s
[Step=3350 Epoch=16.3] | Loss=0.01441 | Reg=0.00324 | acc=0.9844 | L2-Norm=17.988 | L2-Norm(final)=2.305 | 4355.5 samples/s | 68.1 steps/s
[Step=3400 Epoch=16.6] | Loss=0.01563 | Reg=0.00324 | acc=0.9844 | L2-Norm=18.002 | L2-Norm(final)=2.305 | 5550.2 samples/s | 86.7 steps/s
[Step=3450 Epoch=16.8] | Loss=0.01596 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.020 | L2-Norm(final)=2.303 | 1981.9 samples/s | 31.0 steps/s
[Step=3500 Epoch=17.1] | Loss=0.01569 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.037 | L2-Norm(final)=2.303 | 4631.7 samples/s | 72.4 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_1/client_state-step3500.h5

Train client 2: client_asml1_2
Local layers training...
LR=0.00100, len=1
[Step=3001 Epoch=14.6] | Loss=0.01223 | Reg=0.00342 | acc=0.9844 | L2-Norm=18.505 | L2-Norm(final)=2.319 | 4305.0 samples/s | 67.3 steps/s
[Step=3050 Epoch=14.9] | Loss=0.01305 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.507 | L2-Norm(final)=2.323 | 4490.2 samples/s | 70.2 steps/s
[Step=3100 Epoch=15.1] | Loss=0.01291 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.497 | L2-Norm(final)=2.321 | 4441.6 samples/s | 69.4 steps/s
[Step=3150 Epoch=15.3] | Loss=0.01298 | Reg=0.00342 | acc=0.9844 | L2-Norm=18.487 | L2-Norm(final)=2.320 | 4321.1 samples/s | 67.5 steps/s
[Step=3200 Epoch=15.6] | Loss=0.01379 | Reg=0.00342 | acc=0.9531 | L2-Norm=18.482 | L2-Norm(final)=2.320 | 6007.3 samples/s | 93.9 steps/s
[Step=3250 Epoch=15.8] | Loss=0.01405 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.481 | L2-Norm(final)=2.320 | 1943.2 samples/s | 30.4 steps/s
[Step=3300 Epoch=16.1] | Loss=0.01323 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.479 | L2-Norm(final)=2.320 | 4647.0 samples/s | 72.6 steps/s
[Step=3350 Epoch=16.3] | Loss=0.01406 | Reg=0.00342 | acc=0.9531 | L2-Norm=18.480 | L2-Norm(final)=2.320 | 4613.5 samples/s | 72.1 steps/s
[Step=3400 Epoch=16.6] | Loss=0.01454 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.483 | L2-Norm(final)=2.318 | 5419.1 samples/s | 84.7 steps/s
[Step=3450 Epoch=16.8] | Loss=0.01431 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.485 | L2-Norm(final)=2.318 | 1935.7 samples/s | 30.2 steps/s
[Step=3500 Epoch=17.1] | Loss=0.01460 | Reg=0.00342 | acc=0.9844 | L2-Norm=18.488 | L2-Norm(final)=2.317 | 4313.2 samples/s | 67.4 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_2/client_state-step3500.h5

Train client 3: client_asml1_3
Local layers training...
LR=0.00100, len=1
[Step=3001 Epoch=14.6] | Loss=0.00890 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.892 | L2-Norm(final)=2.344 | 4142.7 samples/s | 64.7 steps/s
[Step=3050 Epoch=14.9] | Loss=0.01759 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.909 | L2-Norm(final)=2.349 | 4344.5 samples/s | 67.9 steps/s
[Step=3100 Epoch=15.1] | Loss=0.01671 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.914 | L2-Norm(final)=2.348 | 4292.5 samples/s | 67.1 steps/s
[Step=3150 Epoch=15.4] | Loss=0.01679 | Reg=0.00321 | acc=0.9688 | L2-Norm=17.916 | L2-Norm(final)=2.349 | 4323.1 samples/s | 67.5 steps/s
[Step=3200 Epoch=15.6] | Loss=0.01615 | Reg=0.00321 | acc=0.9688 | L2-Norm=17.918 | L2-Norm(final)=2.350 | 5969.5 samples/s | 93.3 steps/s
[Step=3250 Epoch=15.8] | Loss=0.01649 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.922 | L2-Norm(final)=2.350 | 1924.3 samples/s | 30.1 steps/s
[Step=3300 Epoch=16.1] | Loss=0.01594 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.926 | L2-Norm(final)=2.348 | 4288.8 samples/s | 67.0 steps/s
[Step=3350 Epoch=16.3] | Loss=0.01515 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.930 | L2-Norm(final)=2.349 | 4532.7 samples/s | 70.8 steps/s
[Step=3400 Epoch=16.6] | Loss=0.01563 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.933 | L2-Norm(final)=2.349 | 5686.3 samples/s | 88.8 steps/s
[Step=3450 Epoch=16.8] | Loss=0.01562 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.937 | L2-Norm(final)=2.348 | 1988.6 samples/s | 31.1 steps/s
[Step=3500 Epoch=17.1] | Loss=0.01494 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.941 | L2-Norm(final)=2.348 | 4288.3 samples/s | 67.0 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_3/client_state-step3500.h5

Train client 4: client_asml1_4
Local layers training...
LR=0.00100, len=1
[Step=3001 Epoch=14.7] | Loss=0.00101 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.140 | L2-Norm(final)=2.360 | 4133.8 samples/s | 64.6 steps/s
[Step=3050 Epoch=15.0] | Loss=0.01010 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.137 | L2-Norm(final)=2.355 | 4097.2 samples/s | 64.0 steps/s
[Step=3100 Epoch=15.2] | Loss=0.00988 | Reg=0.00329 | acc=0.9688 | L2-Norm=18.131 | L2-Norm(final)=2.359 | 4221.4 samples/s | 66.0 steps/s
[Step=3150 Epoch=15.4] | Loss=0.01117 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.126 | L2-Norm(final)=2.361 | 4321.3 samples/s | 67.5 steps/s
[Step=3200 Epoch=15.7] | Loss=0.01240 | Reg=0.00329 | acc=0.9688 | L2-Norm=18.128 | L2-Norm(final)=2.360 | 6034.1 samples/s | 94.3 steps/s
[Step=3250 Epoch=15.9] | Loss=0.01301 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.136 | L2-Norm(final)=2.359 | 1969.0 samples/s | 30.8 steps/s
[Step=3300 Epoch=16.2] | Loss=0.01391 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.147 | L2-Norm(final)=2.359 | 4627.0 samples/s | 72.3 steps/s
[Step=3350 Epoch=16.4] | Loss=0.01494 | Reg=0.00330 | acc=0.9844 | L2-Norm=18.164 | L2-Norm(final)=2.358 | 4609.6 samples/s | 72.0 steps/s
[Step=3400 Epoch=16.7] | Loss=0.01546 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.182 | L2-Norm(final)=2.356 | 5936.7 samples/s | 92.8 steps/s
[Step=3450 Epoch=16.9] | Loss=0.01553 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.199 | L2-Norm(final)=2.353 | 1935.4 samples/s | 30.2 steps/s
[Step=3500 Epoch=17.2] | Loss=0.01575 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.214 | L2-Norm(final)=2.351 | 4221.2 samples/s | 66.0 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_4/client_state-step3500.h5

Train client 5: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=3001 Epoch=28.4] | Loss=0.00000 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.308 | L2-Norm(final)=2.989 | 4252.3 samples/s | 66.4 steps/s
[Step=3050 Epoch=28.9] | Loss=0.00000 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.264 | L2-Norm(final)=3.001 | 3828.0 samples/s | 59.8 steps/s
[Step=3100 Epoch=29.4] | Loss=0.00000 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=3.014 | 5871.3 samples/s | 91.7 steps/s
[Step=3150 Epoch=29.8] | Loss=0.00000 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.175 | L2-Norm(final)=3.028 | 1791.7 samples/s | 28.0 steps/s
[Step=3200 Epoch=30.3] | Loss=0.00000 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.131 | L2-Norm(final)=3.041 | 5052.5 samples/s | 78.9 steps/s
[Step=3250 Epoch=30.8] | Loss=0.00000 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.087 | L2-Norm(final)=3.055 | 1871.3 samples/s | 29.2 steps/s
[Step=3300 Epoch=31.3] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.043 | L2-Norm(final)=3.069 | 4729.9 samples/s | 73.9 steps/s
[Step=3350 Epoch=31.7] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.999 | L2-Norm(final)=3.083 | 1951.6 samples/s | 30.5 steps/s
[Step=3400 Epoch=32.2] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.955 | L2-Norm(final)=3.097 | 4479.0 samples/s | 70.0 steps/s
[Step=3450 Epoch=32.7] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.912 | L2-Norm(final)=3.111 | 1922.6 samples/s | 30.0 steps/s
[Step=3500 Epoch=33.2] | Loss=0.00000 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.868 | L2-Norm(final)=3.125 | 4070.6 samples/s | 63.6 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_0/client_state-step3500.h5

Train client 6: client_iccad2012_1
Local layers training...
LR=0.00100, len=1
[Step=3001 Epoch=28.5] | Loss=0.00000 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.651 | L2-Norm(final)=2.906 | 4029.1 samples/s | 63.0 steps/s
[Step=3050 Epoch=29.0] | Loss=0.00000 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.610 | L2-Norm(final)=2.919 | 4060.6 samples/s | 63.4 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00000 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.567 | L2-Norm(final)=2.934 | 5498.5 samples/s | 85.9 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00000 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.525 | L2-Norm(final)=2.950 | 1852.6 samples/s | 28.9 steps/s
[Step=3200 Epoch=30.4] | Loss=0.00000 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=2.966 | 5349.2 samples/s | 83.6 steps/s
[Step=3250 Epoch=30.9] | Loss=0.00000 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.442 | L2-Norm(final)=2.981 | 2010.0 samples/s | 31.4 steps/s
[Step=3300 Epoch=31.4] | Loss=0.00000 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.400 | L2-Norm(final)=2.997 | 5152.3 samples/s | 80.5 steps/s
[Step=3350 Epoch=31.9] | Loss=0.00000 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.358 | L2-Norm(final)=3.014 | 1973.1 samples/s | 30.8 steps/s
[Step=3400 Epoch=32.3] | Loss=0.00000 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.317 | L2-Norm(final)=3.031 | 4579.2 samples/s | 71.6 steps/s
[Step=3450 Epoch=32.8] | Loss=0.00000 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.275 | L2-Norm(final)=3.048 | 2005.2 samples/s | 31.3 steps/s
[Step=3500 Epoch=33.3] | Loss=0.00000 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.234 | L2-Norm(final)=3.065 | 4156.1 samples/s | 64.9 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_1/client_state-step3500.h5

Train client 7: client_iccad2012_2
Local layers training...
LR=0.00100, len=1
[Step=3001 Epoch=28.7] | Loss=0.00001 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.992 | L2-Norm(final)=2.609 | 4195.3 samples/s | 65.6 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00003 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.971 | L2-Norm(final)=2.610 | 4271.9 samples/s | 66.7 steps/s
[Step=3100 Epoch=29.6] | Loss=0.00003 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.951 | L2-Norm(final)=2.611 | 5951.7 samples/s | 93.0 steps/s
[Step=3150 Epoch=30.1] | Loss=0.00004 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.932 | L2-Norm(final)=2.612 | 1848.3 samples/s | 28.9 steps/s
[Step=3200 Epoch=30.6] | Loss=0.00003 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.912 | L2-Norm(final)=2.612 | 5631.1 samples/s | 88.0 steps/s
[Step=3250 Epoch=31.0] | Loss=0.00003 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.893 | L2-Norm(final)=2.613 | 1800.7 samples/s | 28.1 steps/s
[Step=3300 Epoch=31.5] | Loss=0.00003 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.874 | L2-Norm(final)=2.614 | 4880.4 samples/s | 76.3 steps/s
[Step=3350 Epoch=32.0] | Loss=0.00003 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.855 | L2-Norm(final)=2.614 | 1833.4 samples/s | 28.6 steps/s
[Step=3400 Epoch=32.5] | Loss=0.00003 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.836 | L2-Norm(final)=2.615 | 4522.6 samples/s | 70.7 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00003 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.817 | L2-Norm(final)=2.616 | 1939.7 samples/s | 30.3 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00003 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.798 | L2-Norm(final)=2.616 | 4514.1 samples/s | 70.5 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_2/client_state-step3500.h5

Train client 8: client_iccad2012_3
Local layers training...
LR=0.00100, len=1
[Step=3001 Epoch=28.3] | Loss=0.00000 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.988 | L2-Norm(final)=2.926 | 4406.1 samples/s | 68.8 steps/s
[Step=3050 Epoch=28.7] | Loss=0.00000 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.948 | L2-Norm(final)=2.937 | 4146.4 samples/s | 64.8 steps/s
[Step=3100 Epoch=29.2] | Loss=0.00000 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.908 | L2-Norm(final)=2.949 | 5894.6 samples/s | 92.1 steps/s
[Step=3150 Epoch=29.7] | Loss=0.00000 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.868 | L2-Norm(final)=2.961 | 1892.8 samples/s | 29.6 steps/s
[Step=3200 Epoch=30.2] | Loss=0.00000 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.828 | L2-Norm(final)=2.974 | 5104.8 samples/s | 79.8 steps/s
[Step=3250 Epoch=30.6] | Loss=0.00000 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.788 | L2-Norm(final)=2.987 | 1875.6 samples/s | 29.3 steps/s
[Step=3300 Epoch=31.1] | Loss=0.00000 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.749 | L2-Norm(final)=3.000 | 4665.5 samples/s | 72.9 steps/s
[Step=3350 Epoch=31.6] | Loss=0.00000 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.709 | L2-Norm(final)=3.013 | 1939.9 samples/s | 30.3 steps/s
[Step=3400 Epoch=32.0] | Loss=0.00000 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.668 | L2-Norm(final)=3.026 | 4399.2 samples/s | 68.7 steps/s
[Step=3450 Epoch=32.5] | Loss=0.00000 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=3.039 | 2092.4 samples/s | 32.7 steps/s
[Step=3500 Epoch=33.0] | Loss=0.00000 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.589 | L2-Norm(final)=3.052 | 4301.1 samples/s | 67.2 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_3/client_state-step3500.h5

Train client 9: client_iccad2012_4
Local layers training...
LR=0.00100, len=1
[Step=3001 Epoch=28.6] | Loss=0.00000 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.830 | L2-Norm(final)=2.903 | 4374.4 samples/s | 68.4 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00000 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.792 | L2-Norm(final)=2.915 | 4235.5 samples/s | 66.2 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00000 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.753 | L2-Norm(final)=2.928 | 5552.4 samples/s | 86.8 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00000 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.714 | L2-Norm(final)=2.942 | 1813.0 samples/s | 28.3 steps/s
[Step=3200 Epoch=30.5] | Loss=0.00000 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.676 | L2-Norm(final)=2.956 | 5202.5 samples/s | 81.3 steps/s
[Step=3250 Epoch=31.0] | Loss=0.00000 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.637 | L2-Norm(final)=2.970 | 1819.9 samples/s | 28.4 steps/s
[Step=3300 Epoch=31.5] | Loss=0.00000 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.598 | L2-Norm(final)=2.984 | 5084.9 samples/s | 79.5 steps/s
[Step=3350 Epoch=31.9] | Loss=0.00000 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.559 | L2-Norm(final)=2.999 | 1958.5 samples/s | 30.6 steps/s
[Step=3400 Epoch=32.4] | Loss=0.00000 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.520 | L2-Norm(final)=3.013 | 4788.1 samples/s | 74.8 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00000 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.028 | 1975.2 samples/s | 30.9 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00000 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.443 | L2-Norm(final)=3.043 | 4384.9 samples/s | 68.5 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_4/client_state-step3500.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.17084 | acc=0.9280 | tpr=0.9394 | fpr=0.0969 | 4095.8 samples/s | 16.0 steps/s
Avg test loss: 0.17688, Avg test acc: 0.92447, Avg tpr: 0.93542, Avg fpr: 0.09960, total FA: 777

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.16269 | acc=0.9231 | tpr=0.9385 | fpr=0.1103 | 4185.9 samples/s | 16.4 steps/s
Avg test loss: 0.16810, Avg test acc: 0.92279, Avg tpr: 0.93781, Avg fpr: 0.11024, total FA: 860

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.17318 | acc=0.9259 | tpr=0.9456 | fpr=0.1169 | 4042.0 samples/s | 15.8 steps/s
Avg test loss: 0.17599, Avg test acc: 0.92387, Avg tpr: 0.94352, Avg fpr: 0.11934, total FA: 931

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.25356 | acc=0.8948 | tpr=0.8719 | fpr=0.0553 | 4346.2 samples/s | 17.0 steps/s
Avg test loss: 0.26360, Avg test acc: 0.89214, Avg tpr: 0.87067, Avg fpr: 0.06063, total FA: 473

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.17424 | acc=0.9219 | tpr=0.9380 | fpr=0.1132 | 4112.3 samples/s | 16.1 steps/s
Avg test loss: 0.17934, Avg test acc: 0.91926, Avg tpr: 0.93490, Avg fpr: 0.11511, total FA: 898

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.39122 | acc=0.3155 | tpr=0.0054 | fpr=0.0109 | 3918.1 samples/s | 15.3 steps/s
Avg test loss: 6.42109, Avg test acc: 0.31317, Avg tpr: 0.00589, Avg fpr: 0.01102, total FA: 86

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.41879 | acc=0.3134 | tpr=0.0104 | fpr=0.0285 | 4118.4 samples/s | 16.1 steps/s
Avg test loss: 5.44513, Avg test acc: 0.31096, Avg tpr: 0.01020, Avg fpr: 0.02756, total FA: 215

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=6.64997 | acc=0.3138 | tpr=0.0131 | fpr=0.0332 | 4055.5 samples/s | 15.8 steps/s
Avg test loss: 6.67063, Avg test acc: 0.31132, Avg tpr: 0.01317, Avg fpr: 0.03294, total FA: 257

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.07992 | acc=0.3134 | tpr=0.0178 | fpr=0.0446 | 3948.4 samples/s | 15.4 steps/s
Avg test loss: 5.10213, Avg test acc: 0.31228, Avg tpr: 0.01906, Avg fpr: 0.04282, total FA: 334

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.84692 | acc=0.3152 | tpr=0.0058 | fpr=0.0129 | 4007.5 samples/s | 15.7 steps/s
Avg test loss: 5.86717, Avg test acc: 0.31277, Avg tpr: 0.00629, Avg fpr: 0.01320, total FA: 103

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.30439 | acc=0.1639 | tpr=0.8628 | fpr=0.8487 | 4115.6 samples/s | 16.1 steps/s
[Step= 100] | Loss=4.29592 | acc=0.1661 | tpr=0.8550 | fpr=0.8468 | 7903.3 samples/s | 30.9 steps/s
[Step= 150] | Loss=4.31291 | acc=0.1657 | tpr=0.8516 | fpr=0.8469 | 7475.2 samples/s | 29.2 steps/s
[Step= 200] | Loss=4.30406 | acc=0.1665 | tpr=0.8492 | fpr=0.8459 | 7896.4 samples/s | 30.8 steps/s
[Step= 250] | Loss=4.31517 | acc=0.1662 | tpr=0.8472 | fpr=0.8462 | 7343.9 samples/s | 28.7 steps/s
[Step= 300] | Loss=4.31687 | acc=0.1652 | tpr=0.8480 | fpr=0.8472 | 7569.5 samples/s | 29.6 steps/s
[Step= 350] | Loss=4.31587 | acc=0.1652 | tpr=0.8516 | fpr=0.8472 | 7550.7 samples/s | 29.5 steps/s
[Step= 400] | Loss=4.31562 | acc=0.1657 | tpr=0.8545 | fpr=0.8468 | 8178.9 samples/s | 31.9 steps/s
[Step= 450] | Loss=4.31406 | acc=0.1659 | tpr=0.8535 | fpr=0.8466 | 7833.4 samples/s | 30.6 steps/s
[Step= 500] | Loss=4.31585 | acc=0.1659 | tpr=0.8573 | fpr=0.8466 | 7704.1 samples/s | 30.1 steps/s
[Step= 550] | Loss=4.31306 | acc=0.1661 | tpr=0.8559 | fpr=0.8464 | 13687.4 samples/s | 53.5 steps/s
Avg test loss: 4.31333, Avg test acc: 0.16602, Avg tpr: 0.85578, Avg fpr: 0.84652, total FA: 117537

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.98563 | acc=0.1256 | tpr=0.8274 | fpr=0.8870 | 4262.3 samples/s | 16.6 steps/s
[Step= 100] | Loss=3.95173 | acc=0.1282 | tpr=0.8294 | fpr=0.8849 | 7251.0 samples/s | 28.3 steps/s
[Step= 150] | Loss=3.96156 | acc=0.1272 | tpr=0.8300 | fpr=0.8857 | 8082.7 samples/s | 31.6 steps/s
[Step= 200] | Loss=3.95686 | acc=0.1284 | tpr=0.8339 | fpr=0.8845 | 7531.7 samples/s | 29.4 steps/s
[Step= 250] | Loss=3.96130 | acc=0.1285 | tpr=0.8314 | fpr=0.8843 | 7210.7 samples/s | 28.2 steps/s
[Step= 300] | Loss=3.96137 | acc=0.1285 | tpr=0.8313 | fpr=0.8843 | 7743.4 samples/s | 30.2 steps/s
[Step= 350] | Loss=3.95998 | acc=0.1285 | tpr=0.8303 | fpr=0.8843 | 7551.8 samples/s | 29.5 steps/s
[Step= 400] | Loss=3.96069 | acc=0.1287 | tpr=0.8342 | fpr=0.8842 | 7483.0 samples/s | 29.2 steps/s
[Step= 450] | Loss=3.96012 | acc=0.1284 | tpr=0.8330 | fpr=0.8844 | 7106.7 samples/s | 27.8 steps/s
[Step= 500] | Loss=3.96149 | acc=0.1284 | tpr=0.8308 | fpr=0.8843 | 7170.1 samples/s | 28.0 steps/s
[Step= 550] | Loss=3.96138 | acc=0.1287 | tpr=0.8337 | fpr=0.8842 | 13667.1 samples/s | 53.4 steps/s
Avg test loss: 3.96333, Avg test acc: 0.12858, Avg tpr: 0.83360, Avg fpr: 0.88423, total FA: 122774

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=3.99902 | acc=0.1475 | tpr=0.8230 | fpr=0.8646 | 3978.4 samples/s | 15.5 steps/s
[Step= 100] | Loss=3.96995 | acc=0.1520 | tpr=0.7910 | fpr=0.8600 | 7709.4 samples/s | 30.1 steps/s
[Step= 150] | Loss=3.97133 | acc=0.1526 | tpr=0.7954 | fpr=0.8592 | 7672.8 samples/s | 30.0 steps/s
[Step= 200] | Loss=3.95974 | acc=0.1532 | tpr=0.7891 | fpr=0.8583 | 7595.7 samples/s | 29.7 steps/s
[Step= 250] | Loss=3.96470 | acc=0.1545 | tpr=0.7948 | fpr=0.8572 | 7785.7 samples/s | 30.4 steps/s
[Step= 300] | Loss=3.96631 | acc=0.1538 | tpr=0.7978 | fpr=0.8579 | 7625.7 samples/s | 29.8 steps/s
[Step= 350] | Loss=3.96062 | acc=0.1538 | tpr=0.7959 | fpr=0.8579 | 7547.1 samples/s | 29.5 steps/s
[Step= 400] | Loss=3.96401 | acc=0.1540 | tpr=0.7938 | fpr=0.8576 | 7361.9 samples/s | 28.8 steps/s
[Step= 450] | Loss=3.96564 | acc=0.1532 | tpr=0.7965 | fpr=0.8585 | 7751.4 samples/s | 30.3 steps/s
[Step= 500] | Loss=3.96836 | acc=0.1528 | tpr=0.8000 | fpr=0.8589 | 7256.5 samples/s | 28.3 steps/s
[Step= 550] | Loss=3.96934 | acc=0.1527 | tpr=0.8002 | fpr=0.8591 | 14581.4 samples/s | 57.0 steps/s
Avg test loss: 3.97054, Avg test acc: 0.15254, Avg tpr: 0.80071, Avg fpr: 0.85924, total FA: 119304

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=3.28241 | acc=0.2423 | tpr=0.5000 | fpr=0.7624 | 4209.7 samples/s | 16.4 steps/s
[Step= 100] | Loss=3.26792 | acc=0.2418 | tpr=0.5117 | fpr=0.7633 | 7934.2 samples/s | 31.0 steps/s
[Step= 150] | Loss=3.25686 | acc=0.2426 | tpr=0.5072 | fpr=0.7623 | 7819.4 samples/s | 30.5 steps/s
[Step= 200] | Loss=3.25481 | acc=0.2429 | tpr=0.5005 | fpr=0.7618 | 7262.1 samples/s | 28.4 steps/s
[Step= 250] | Loss=3.25920 | acc=0.2427 | tpr=0.5066 | fpr=0.7621 | 7845.9 samples/s | 30.6 steps/s
[Step= 300] | Loss=3.25983 | acc=0.2427 | tpr=0.5062 | fpr=0.7621 | 7424.2 samples/s | 29.0 steps/s
[Step= 350] | Loss=3.25530 | acc=0.2424 | tpr=0.5041 | fpr=0.7623 | 7357.9 samples/s | 28.7 steps/s
[Step= 400] | Loss=3.25420 | acc=0.2432 | tpr=0.5137 | fpr=0.7617 | 7389.9 samples/s | 28.9 steps/s
[Step= 450] | Loss=3.25263 | acc=0.2436 | tpr=0.5131 | fpr=0.7613 | 7456.2 samples/s | 29.1 steps/s
[Step= 500] | Loss=3.25459 | acc=0.2432 | tpr=0.5141 | fpr=0.7617 | 7467.6 samples/s | 29.2 steps/s
[Step= 550] | Loss=3.25824 | acc=0.2432 | tpr=0.5185 | fpr=0.7618 | 13806.4 samples/s | 53.9 steps/s
Avg test loss: 3.25903, Avg test acc: 0.24315, Avg tpr: 0.51823, Avg fpr: 0.76185, total FA: 105782

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.26397 | acc=0.1246 | tpr=0.7389 | fpr=0.8864 | 4180.8 samples/s | 16.3 steps/s
[Step= 100] | Loss=4.23021 | acc=0.1282 | tpr=0.7655 | fpr=0.8837 | 8113.6 samples/s | 31.7 steps/s
[Step= 150] | Loss=4.23197 | acc=0.1279 | tpr=0.7435 | fpr=0.8834 | 7530.9 samples/s | 29.4 steps/s
[Step= 200] | Loss=4.22571 | acc=0.1283 | tpr=0.7421 | fpr=0.8828 | 8077.0 samples/s | 31.6 steps/s
[Step= 250] | Loss=4.23286 | acc=0.1284 | tpr=0.7424 | fpr=0.8828 | 7585.6 samples/s | 29.6 steps/s
[Step= 300] | Loss=4.24060 | acc=0.1275 | tpr=0.7425 | fpr=0.8837 | 7797.2 samples/s | 30.5 steps/s
[Step= 350] | Loss=4.24199 | acc=0.1279 | tpr=0.7458 | fpr=0.8834 | 7181.5 samples/s | 28.1 steps/s
[Step= 400] | Loss=4.23945 | acc=0.1280 | tpr=0.7555 | fpr=0.8834 | 7324.9 samples/s | 28.6 steps/s
[Step= 450] | Loss=4.24210 | acc=0.1279 | tpr=0.7546 | fpr=0.8835 | 6832.9 samples/s | 26.7 steps/s
[Step= 500] | Loss=4.24244 | acc=0.1277 | tpr=0.7524 | fpr=0.8836 | 7440.9 samples/s | 29.1 steps/s
[Step= 550] | Loss=4.24151 | acc=0.1275 | tpr=0.7537 | fpr=0.8839 | 13228.4 samples/s | 51.7 steps/s
Avg test loss: 4.24235, Avg test acc: 0.12732, Avg tpr: 0.75357, Avg fpr: 0.88407, total FA: 122751

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.05752 | acc=0.9816 | tpr=0.8407 | fpr=0.0159 | 3926.2 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.05736 | acc=0.9815 | tpr=0.8657 | fpr=0.0164 | 7647.7 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.05925 | acc=0.9810 | tpr=0.8746 | fpr=0.0171 | 7307.3 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.06039 | acc=0.9810 | tpr=0.8831 | fpr=0.0172 | 7905.0 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.06033 | acc=0.9811 | tpr=0.8847 | fpr=0.0172 | 7569.0 samples/s | 29.6 steps/s
[Step= 300] | Loss=0.06099 | acc=0.9811 | tpr=0.8836 | fpr=0.0172 | 7105.2 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.06090 | acc=0.9810 | tpr=0.8829 | fpr=0.0172 | 7507.0 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.06138 | acc=0.9808 | tpr=0.8829 | fpr=0.0174 | 7230.9 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.06291 | acc=0.9806 | tpr=0.8793 | fpr=0.0175 | 7882.4 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.06243 | acc=0.9808 | tpr=0.8797 | fpr=0.0174 | 7171.1 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.06187 | acc=0.9810 | tpr=0.8806 | fpr=0.0172 | 14267.0 samples/s | 55.7 steps/s
Avg test loss: 0.06173, Avg test acc: 0.98099, Avg tpr: 0.88035, Avg fpr: 0.01718, total FA: 2386

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.03907 | acc=0.9880 | tpr=0.8009 | fpr=0.0086 | 4145.0 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.03804 | acc=0.9871 | tpr=0.8102 | fpr=0.0096 | 7517.5 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.03895 | acc=0.9870 | tpr=0.8228 | fpr=0.0100 | 7829.1 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.04004 | acc=0.9867 | tpr=0.8230 | fpr=0.0103 | 7817.2 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.03986 | acc=0.9868 | tpr=0.8236 | fpr=0.0102 | 7382.6 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.04007 | acc=0.9867 | tpr=0.8182 | fpr=0.0102 | 7624.6 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.03992 | acc=0.9867 | tpr=0.8240 | fpr=0.0103 | 7420.0 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.04057 | acc=0.9866 | tpr=0.8200 | fpr=0.0104 | 8512.4 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.04088 | acc=0.9865 | tpr=0.8165 | fpr=0.0104 | 7007.9 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.04048 | acc=0.9866 | tpr=0.8207 | fpr=0.0104 | 7957.1 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.04039 | acc=0.9866 | tpr=0.8181 | fpr=0.0103 | 13820.1 samples/s | 54.0 steps/s
Avg test loss: 0.04034, Avg test acc: 0.98660, Avg tpr: 0.81894, Avg fpr: 0.01035, total FA: 1437

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.05006 | acc=0.9835 | tpr=0.9159 | fpr=0.0153 | 3972.8 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.04931 | acc=0.9830 | tpr=0.9296 | fpr=0.0160 | 7432.4 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.04963 | acc=0.9828 | tpr=0.9366 | fpr=0.0164 | 7535.6 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.04985 | acc=0.9826 | tpr=0.9399 | fpr=0.0166 | 7575.6 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.04984 | acc=0.9825 | tpr=0.9389 | fpr=0.0167 | 7786.0 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.05006 | acc=0.9824 | tpr=0.9353 | fpr=0.0167 | 7023.9 samples/s | 27.4 steps/s
[Step= 350] | Loss=0.04991 | acc=0.9825 | tpr=0.9349 | fpr=0.0167 | 7737.5 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.05064 | acc=0.9822 | tpr=0.9349 | fpr=0.0169 | 7824.5 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.05103 | acc=0.9820 | tpr=0.9314 | fpr=0.0171 | 7473.8 samples/s | 29.2 steps/s
[Step= 500] | Loss=0.05102 | acc=0.9822 | tpr=0.9344 | fpr=0.0170 | 7899.8 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.05053 | acc=0.9823 | tpr=0.9316 | fpr=0.0168 | 14467.1 samples/s | 56.5 steps/s
Avg test loss: 0.05047, Avg test acc: 0.98227, Avg tpr: 0.93185, Avg fpr: 0.01681, total FA: 2334

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.06613 | acc=0.9816 | tpr=0.8540 | fpr=0.0161 | 4117.0 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.06604 | acc=0.9820 | tpr=0.8678 | fpr=0.0159 | 7735.4 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.06911 | acc=0.9814 | tpr=0.8718 | fpr=0.0166 | 7163.4 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.07112 | acc=0.9811 | tpr=0.8798 | fpr=0.0170 | 7608.3 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.06963 | acc=0.9815 | tpr=0.8769 | fpr=0.0166 | 7417.0 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.07068 | acc=0.9813 | tpr=0.8735 | fpr=0.0167 | 7671.8 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.07026 | acc=0.9813 | tpr=0.8779 | fpr=0.0168 | 7418.6 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.07043 | acc=0.9812 | tpr=0.8786 | fpr=0.0169 | 7766.3 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.07178 | acc=0.9809 | tpr=0.8729 | fpr=0.0172 | 7471.9 samples/s | 29.2 steps/s
[Step= 500] | Loss=0.07140 | acc=0.9810 | tpr=0.8753 | fpr=0.0171 | 7690.7 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.07043 | acc=0.9812 | tpr=0.8762 | fpr=0.0169 | 13375.9 samples/s | 52.2 steps/s
Avg test loss: 0.07035, Avg test acc: 0.98120, Avg tpr: 0.87639, Avg fpr: 0.01690, total FA: 2346

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.06422 | acc=0.9827 | tpr=0.8540 | fpr=0.0150 | 4099.7 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.06559 | acc=0.9823 | tpr=0.8763 | fpr=0.0157 | 7613.0 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.06769 | acc=0.9821 | tpr=0.8804 | fpr=0.0160 | 7440.7 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.06807 | acc=0.9819 | tpr=0.8809 | fpr=0.0163 | 7495.5 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.06799 | acc=0.9821 | tpr=0.8830 | fpr=0.0161 | 7595.5 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.06923 | acc=0.9816 | tpr=0.8749 | fpr=0.0165 | 7720.7 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.06931 | acc=0.9815 | tpr=0.8785 | fpr=0.0166 | 7325.5 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.06986 | acc=0.9814 | tpr=0.8764 | fpr=0.0167 | 7509.3 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.07145 | acc=0.9810 | tpr=0.8734 | fpr=0.0170 | 7401.4 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.07052 | acc=0.9812 | tpr=0.8727 | fpr=0.0169 | 7230.3 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.07000 | acc=0.9813 | tpr=0.8699 | fpr=0.0167 | 14277.9 samples/s | 55.8 steps/s
Avg test loss: 0.06996, Avg test acc: 0.98128, Avg tpr: 0.87005, Avg fpr: 0.01669, total FA: 2318

server round 7/10

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=3501 Epoch=17.1] | Loss=0.03910 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.954 | L2-Norm(final)=2.314 | 4193.7 samples/s | 65.5 steps/s
[Step=3550 Epoch=17.3] | Loss=0.00987 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.949 | L2-Norm(final)=2.320 | 4213.4 samples/s | 65.8 steps/s
[Step=3600 Epoch=17.6] | Loss=0.01093 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.950 | L2-Norm(final)=2.321 | 4455.1 samples/s | 69.6 steps/s
[Step=3650 Epoch=17.8] | Loss=0.01170 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.949 | L2-Norm(final)=2.324 | 4552.0 samples/s | 71.1 steps/s
[Step=3700 Epoch=18.0] | Loss=0.01097 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.950 | L2-Norm(final)=2.325 | 6224.0 samples/s | 97.2 steps/s
[Step=3750 Epoch=18.3] | Loss=0.01048 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.951 | L2-Norm(final)=2.327 | 1937.5 samples/s | 30.3 steps/s
[Step=3800 Epoch=18.5] | Loss=0.01061 | Reg=0.00322 | acc=0.9688 | L2-Norm=17.951 | L2-Norm(final)=2.330 | 4659.7 samples/s | 72.8 steps/s
[Step=3850 Epoch=18.8] | Loss=0.01166 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.949 | L2-Norm(final)=2.329 | 4449.4 samples/s | 69.5 steps/s
[Step=3900 Epoch=19.0] | Loss=0.01191 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.949 | L2-Norm(final)=2.325 | 5474.8 samples/s | 85.5 steps/s
[Step=3950 Epoch=19.3] | Loss=0.01235 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.952 | L2-Norm(final)=2.322 | 1922.3 samples/s | 30.0 steps/s
[Step=4000 Epoch=19.5] | Loss=0.01232 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.957 | L2-Norm(final)=2.321 | 4272.2 samples/s | 66.8 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_0/client_state-step4000.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00100, len=1
[Step=3501 Epoch=17.1] | Loss=0.00803 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.205 | L2-Norm(final)=2.300 | 4291.0 samples/s | 67.0 steps/s
[Step=3550 Epoch=17.3] | Loss=0.01299 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.225 | L2-Norm(final)=2.305 | 4210.1 samples/s | 65.8 steps/s
[Step=3600 Epoch=17.6] | Loss=0.01913 | Reg=0.00333 | acc=0.9688 | L2-Norm=18.237 | L2-Norm(final)=2.298 | 4370.9 samples/s | 68.3 steps/s
[Step=3650 Epoch=17.8] | Loss=0.01871 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.254 | L2-Norm(final)=2.292 | 4372.2 samples/s | 68.3 steps/s
[Step=3700 Epoch=18.1] | Loss=0.01798 | Reg=0.00334 | acc=0.9688 | L2-Norm=18.271 | L2-Norm(final)=2.291 | 5877.3 samples/s | 91.8 steps/s
[Step=3750 Epoch=18.3] | Loss=0.01672 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.284 | L2-Norm(final)=2.290 | 1876.5 samples/s | 29.3 steps/s
[Step=3800 Epoch=18.5] | Loss=0.01636 | Reg=0.00335 | acc=0.9844 | L2-Norm=18.292 | L2-Norm(final)=2.289 | 4347.0 samples/s | 67.9 steps/s
[Step=3850 Epoch=18.8] | Loss=0.01620 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.300 | L2-Norm(final)=2.288 | 4624.2 samples/s | 72.3 steps/s
[Step=3900 Epoch=19.0] | Loss=0.01615 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.309 | L2-Norm(final)=2.287 | 5809.0 samples/s | 90.8 steps/s
[Step=3950 Epoch=19.3] | Loss=0.01586 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.318 | L2-Norm(final)=2.286 | 1979.2 samples/s | 30.9 steps/s
[Step=4000 Epoch=19.5] | Loss=0.01566 | Reg=0.00336 | acc=0.9688 | L2-Norm=18.325 | L2-Norm(final)=2.284 | 4668.6 samples/s | 72.9 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_1/client_state-step4000.h5

Train client 2: client_asml1_2
Local layers training...
LR=0.00100, len=1
[Step=3501 Epoch=17.1] | Loss=0.00624 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.539 | L2-Norm(final)=2.310 | 4212.7 samples/s | 65.8 steps/s
[Step=3550 Epoch=17.3] | Loss=0.00980 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.545 | L2-Norm(final)=2.317 | 4568.0 samples/s | 71.4 steps/s
[Step=3600 Epoch=17.5] | Loss=0.01045 | Reg=0.00344 | acc=0.9844 | L2-Norm=18.549 | L2-Norm(final)=2.321 | 4396.5 samples/s | 68.7 steps/s
[Step=3650 Epoch=17.8] | Loss=0.01211 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.559 | L2-Norm(final)=2.324 | 4346.3 samples/s | 67.9 steps/s
[Step=3700 Epoch=18.0] | Loss=0.01521 | Reg=0.00345 | acc=0.9844 | L2-Norm=18.570 | L2-Norm(final)=2.320 | 5696.3 samples/s | 89.0 steps/s
[Step=3750 Epoch=18.3] | Loss=0.01689 | Reg=0.00345 | acc=0.9531 | L2-Norm=18.584 | L2-Norm(final)=2.315 | 1888.4 samples/s | 29.5 steps/s
[Step=3800 Epoch=18.5] | Loss=0.01662 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.600 | L2-Norm(final)=2.312 | 4510.8 samples/s | 70.5 steps/s
[Step=3850 Epoch=18.8] | Loss=0.01668 | Reg=0.00346 | acc=0.9844 | L2-Norm=18.614 | L2-Norm(final)=2.311 | 4423.0 samples/s | 69.1 steps/s
[Step=3900 Epoch=19.0] | Loss=0.01817 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.632 | L2-Norm(final)=2.308 | 5720.1 samples/s | 89.4 steps/s
[Step=3950 Epoch=19.2] | Loss=0.01814 | Reg=0.00348 | acc=1.0000 | L2-Norm=18.654 | L2-Norm(final)=2.305 | 2023.1 samples/s | 31.6 steps/s
[Step=4000 Epoch=19.5] | Loss=0.01901 | Reg=0.00349 | acc=0.9688 | L2-Norm=18.676 | L2-Norm(final)=2.302 | 4360.5 samples/s | 68.1 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_2/client_state-step4000.h5

Train client 3: client_asml1_3
Local layers training...
LR=0.00100, len=1
[Step=3501 Epoch=17.1] | Loss=0.06012 | Reg=0.00323 | acc=0.9531 | L2-Norm=17.969 | L2-Norm(final)=2.347 | 4516.9 samples/s | 70.6 steps/s
[Step=3550 Epoch=17.3] | Loss=0.02035 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.982 | L2-Norm(final)=2.334 | 4561.1 samples/s | 71.3 steps/s
[Step=3600 Epoch=17.6] | Loss=0.01715 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.986 | L2-Norm(final)=2.334 | 4610.4 samples/s | 72.0 steps/s
[Step=3650 Epoch=17.8] | Loss=0.01715 | Reg=0.00324 | acc=0.9688 | L2-Norm=17.994 | L2-Norm(final)=2.333 | 4438.5 samples/s | 69.4 steps/s
[Step=3700 Epoch=18.0] | Loss=0.01750 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.001 | L2-Norm(final)=2.332 | 5887.2 samples/s | 92.0 steps/s
[Step=3750 Epoch=18.3] | Loss=0.01628 | Reg=0.00324 | acc=0.9688 | L2-Norm=18.007 | L2-Norm(final)=2.331 | 1888.7 samples/s | 29.5 steps/s
[Step=3800 Epoch=18.5] | Loss=0.01561 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.011 | L2-Norm(final)=2.331 | 4395.2 samples/s | 68.7 steps/s
[Step=3850 Epoch=18.8] | Loss=0.01547 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.017 | L2-Norm(final)=2.332 | 4260.4 samples/s | 66.6 steps/s
[Step=3900 Epoch=19.0] | Loss=0.01532 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.023 | L2-Norm(final)=2.333 | 5492.1 samples/s | 85.8 steps/s
[Step=3950 Epoch=19.3] | Loss=0.01506 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.031 | L2-Norm(final)=2.333 | 1991.9 samples/s | 31.1 steps/s
[Step=4000 Epoch=19.5] | Loss=0.01455 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.038 | L2-Norm(final)=2.333 | 4405.3 samples/s | 68.8 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_3/client_state-step4000.h5

Train client 4: client_asml1_4
Local layers training...
LR=0.00100, len=1
[Step=3501 Epoch=17.2] | Loss=0.00371 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.366 | L2-Norm(final)=2.325 | 4701.5 samples/s | 73.5 steps/s
[Step=3550 Epoch=17.4] | Loss=0.01614 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.375 | L2-Norm(final)=2.326 | 4012.6 samples/s | 62.7 steps/s
[Step=3600 Epoch=17.7] | Loss=0.01419 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.380 | L2-Norm(final)=2.326 | 4285.3 samples/s | 67.0 steps/s
[Step=3650 Epoch=17.9] | Loss=0.01412 | Reg=0.00338 | acc=0.9844 | L2-Norm=18.386 | L2-Norm(final)=2.327 | 4472.9 samples/s | 69.9 steps/s
[Step=3700 Epoch=18.1] | Loss=0.01529 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.388 | L2-Norm(final)=2.325 | 5829.9 samples/s | 91.1 steps/s
[Step=3750 Epoch=18.4] | Loss=0.01362 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.389 | L2-Norm(final)=2.325 | 1879.0 samples/s | 29.4 steps/s
[Step=3800 Epoch=18.6] | Loss=0.01332 | Reg=0.00338 | acc=0.9844 | L2-Norm=18.388 | L2-Norm(final)=2.326 | 4427.3 samples/s | 69.2 steps/s
[Step=3850 Epoch=18.9] | Loss=0.01321 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.386 | L2-Norm(final)=2.327 | 4371.8 samples/s | 68.3 steps/s
[Step=3900 Epoch=19.1] | Loss=0.01302 | Reg=0.00338 | acc=0.9688 | L2-Norm=18.386 | L2-Norm(final)=2.328 | 5687.2 samples/s | 88.9 steps/s
[Step=3950 Epoch=19.4] | Loss=0.01270 | Reg=0.00338 | acc=0.9844 | L2-Norm=18.386 | L2-Norm(final)=2.330 | 1950.1 samples/s | 30.5 steps/s
[Step=4000 Epoch=19.6] | Loss=0.01219 | Reg=0.00338 | acc=0.9688 | L2-Norm=18.386 | L2-Norm(final)=2.331 | 4665.4 samples/s | 72.9 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_4/client_state-step4000.h5

Train client 5: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=3501 Epoch=33.2] | Loss=0.00000 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.428 | L2-Norm(final)=3.258 | 4219.5 samples/s | 65.9 steps/s
[Step=3550 Epoch=33.6] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.386 | L2-Norm(final)=3.273 | 4103.8 samples/s | 64.1 steps/s
[Step=3600 Epoch=34.1] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.345 | L2-Norm(final)=3.290 | 5926.7 samples/s | 92.6 steps/s
[Step=3650 Epoch=34.6] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.304 | L2-Norm(final)=3.306 | 1776.0 samples/s | 27.8 steps/s
[Step=3700 Epoch=35.1] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.261 | L2-Norm(final)=3.319 | 5293.4 samples/s | 82.7 steps/s
[Step=3750 Epoch=35.5] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.217 | L2-Norm(final)=3.333 | 1934.2 samples/s | 30.2 steps/s
[Step=3800 Epoch=36.0] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.174 | L2-Norm(final)=3.347 | 4807.0 samples/s | 75.1 steps/s
[Step=3850 Epoch=36.5] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.131 | L2-Norm(final)=3.362 | 1945.4 samples/s | 30.4 steps/s
[Step=3900 Epoch=37.0] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=3.377 | 4752.8 samples/s | 74.3 steps/s
[Step=3950 Epoch=37.4] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.046 | L2-Norm(final)=3.392 | 2004.6 samples/s | 31.3 steps/s
[Step=4000 Epoch=37.9] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.003 | L2-Norm(final)=3.407 | 4609.0 samples/s | 72.0 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_0/client_state-step4000.h5

Train client 6: client_iccad2012_1
Local layers training...
LR=0.00100, len=1
[Step=3501 Epoch=33.3] | Loss=0.00000 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.821 | L2-Norm(final)=3.234 | 4428.3 samples/s | 69.2 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.780 | L2-Norm(final)=3.251 | 3623.8 samples/s | 56.6 steps/s
[Step=3600 Epoch=34.2] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.738 | L2-Norm(final)=3.269 | 5719.0 samples/s | 89.4 steps/s
[Step=3650 Epoch=34.7] | Loss=0.00000 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=3.285 | 1794.0 samples/s | 28.0 steps/s
[Step=3700 Epoch=35.2] | Loss=0.00000 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.656 | L2-Norm(final)=3.304 | 5197.2 samples/s | 81.2 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.615 | L2-Norm(final)=3.322 | 1865.7 samples/s | 29.2 steps/s
[Step=3800 Epoch=36.1] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.574 | L2-Norm(final)=3.341 | 4863.4 samples/s | 76.0 steps/s
[Step=3850 Epoch=36.6] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.536 | L2-Norm(final)=3.359 | 1926.0 samples/s | 30.1 steps/s
[Step=3900 Epoch=37.1] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.496 | L2-Norm(final)=3.376 | 4439.3 samples/s | 69.4 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00000 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.456 | L2-Norm(final)=3.391 | 1982.8 samples/s | 31.0 steps/s
[Step=4000 Epoch=38.0] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.416 | L2-Norm(final)=3.406 | 4427.3 samples/s | 69.2 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_1/client_state-step4000.h5

Train client 7: client_iccad2012_2
Local layers training...
LR=0.00100, len=1
[Step=3501 Epoch=33.4] | Loss=0.00003 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.612 | L2-Norm(final)=2.622 | 3905.2 samples/s | 61.0 steps/s
[Step=3550 Epoch=33.9] | Loss=0.00002 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.594 | L2-Norm(final)=2.623 | 3902.5 samples/s | 61.0 steps/s
[Step=3600 Epoch=34.4] | Loss=0.00002 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.576 | L2-Norm(final)=2.624 | 5482.5 samples/s | 85.7 steps/s
[Step=3650 Epoch=34.9] | Loss=0.00002 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.559 | L2-Norm(final)=2.624 | 1903.7 samples/s | 29.7 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00002 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.541 | L2-Norm(final)=2.625 | 5585.6 samples/s | 87.3 steps/s
[Step=3750 Epoch=35.8] | Loss=0.00002 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.523 | L2-Norm(final)=2.625 | 1842.1 samples/s | 28.8 steps/s
[Step=3800 Epoch=36.3] | Loss=0.00002 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.506 | L2-Norm(final)=2.626 | 4871.7 samples/s | 76.1 steps/s
[Step=3850 Epoch=36.8] | Loss=0.00002 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.488 | L2-Norm(final)=2.626 | 1850.8 samples/s | 28.9 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00002 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.471 | L2-Norm(final)=2.628 | 4721.7 samples/s | 73.8 steps/s
[Step=3950 Epoch=37.7] | Loss=0.00002 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.453 | L2-Norm(final)=2.630 | 1915.3 samples/s | 29.9 steps/s
[Step=4000 Epoch=38.2] | Loss=0.00002 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.436 | L2-Norm(final)=2.632 | 4532.6 samples/s | 70.8 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_2/client_state-step4000.h5

Train client 8: client_iccad2012_3
Local layers training...
LR=0.00100, len=1
[Step=3501 Epoch=33.0] | Loss=0.00000 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.189 | L2-Norm(final)=3.183 | 4158.9 samples/s | 65.0 steps/s
[Step=3550 Epoch=33.5] | Loss=0.00000 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=3.195 | 4280.5 samples/s | 66.9 steps/s
[Step=3600 Epoch=33.9] | Loss=0.00000 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.111 | L2-Norm(final)=3.210 | 5358.2 samples/s | 83.7 steps/s
[Step=3650 Epoch=34.4] | Loss=0.00000 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.074 | L2-Norm(final)=3.224 | 1809.7 samples/s | 28.3 steps/s
[Step=3700 Epoch=34.9] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.034 | L2-Norm(final)=3.236 | 5109.4 samples/s | 79.8 steps/s
[Step=3750 Epoch=35.3] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.994 | L2-Norm(final)=3.249 | 1870.3 samples/s | 29.2 steps/s
[Step=3800 Epoch=35.8] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.954 | L2-Norm(final)=3.262 | 4678.9 samples/s | 73.1 steps/s
[Step=3850 Epoch=36.3] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.914 | L2-Norm(final)=3.275 | 1894.1 samples/s | 29.6 steps/s
[Step=3900 Epoch=36.7] | Loss=0.00000 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.874 | L2-Norm(final)=3.289 | 4494.0 samples/s | 70.2 steps/s
[Step=3950 Epoch=37.2] | Loss=0.00000 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.834 | L2-Norm(final)=3.303 | 2007.6 samples/s | 31.4 steps/s
[Step=4000 Epoch=37.7] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.794 | L2-Norm(final)=3.318 | 4200.5 samples/s | 65.6 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_3/client_state-step4000.h5

Train client 9: client_iccad2012_4
Local layers training...
LR=0.00100, len=1
[Step=3501 Epoch=33.4] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.059 | L2-Norm(final)=3.197 | 3992.1 samples/s | 62.4 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.018 | L2-Norm(final)=3.207 | 3975.8 samples/s | 62.1 steps/s
[Step=3600 Epoch=34.3] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.979 | L2-Norm(final)=3.222 | 5696.8 samples/s | 89.0 steps/s
[Step=3650 Epoch=34.8] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.941 | L2-Norm(final)=3.240 | 1868.1 samples/s | 29.2 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=3.256 | 5445.3 samples/s | 85.1 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00000 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.863 | L2-Norm(final)=3.271 | 1842.1 samples/s | 28.8 steps/s
[Step=3800 Epoch=36.2] | Loss=0.00000 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=3.286 | 5292.7 samples/s | 82.7 steps/s
[Step=3850 Epoch=36.7] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.786 | L2-Norm(final)=3.303 | 1981.6 samples/s | 31.0 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.747 | L2-Norm(final)=3.319 | 4737.2 samples/s | 74.0 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00000 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.708 | L2-Norm(final)=3.335 | 1922.7 samples/s | 30.0 steps/s
[Step=4000 Epoch=38.1] | Loss=0.00000 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.669 | L2-Norm(final)=3.351 | 4463.1 samples/s | 69.7 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_4/client_state-step4000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.16524 | acc=0.9302 | tpr=0.9533 | fpr=0.1202 | 3995.6 samples/s | 15.6 steps/s
Avg test loss: 0.16808, Avg test acc: 0.92896, Avg tpr: 0.95343, Avg fpr: 0.12486, total FA: 974

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.17752 | acc=0.9277 | tpr=0.9483 | fpr=0.1169 | 4044.1 samples/s | 15.8 steps/s
Avg test loss: 0.17887, Avg test acc: 0.92640, Avg tpr: 0.94725, Avg fpr: 0.11947, total FA: 932

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.17338 | acc=0.9218 | tpr=0.9467 | fpr=0.1323 | 3960.3 samples/s | 15.5 steps/s
Avg test loss: 0.16873, Avg test acc: 0.92291, Avg tpr: 0.94859, Avg fpr: 0.13357, total FA: 1042

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.18954 | acc=0.9264 | tpr=0.9382 | fpr=0.0991 | 4180.8 samples/s | 16.3 steps/s
Avg test loss: 0.19631, Avg test acc: 0.92439, Avg tpr: 0.93845, Avg fpr: 0.10652, total FA: 831

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.21126 | acc=0.9241 | tpr=0.9296 | fpr=0.0877 | 3983.2 samples/s | 15.6 steps/s
Avg test loss: 0.21924, Avg test acc: 0.92059, Avg tpr: 0.92510, Avg fpr: 0.08935, total FA: 697

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.30123 | acc=0.3160 | tpr=0.0083 | fpr=0.0159 | 4068.9 samples/s | 15.9 steps/s
Avg test loss: 6.32982, Avg test acc: 0.31357, Avg tpr: 0.00874, Avg fpr: 0.01602, total FA: 125

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.93368 | acc=0.3079 | tpr=0.0221 | fpr=0.0716 | 4134.4 samples/s | 16.2 steps/s
Avg test loss: 4.95537, Avg test acc: 0.30651, Avg tpr: 0.02250, Avg fpr: 0.06884, total FA: 537

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=6.66713 | acc=0.3137 | tpr=0.0135 | fpr=0.0342 | 3955.1 samples/s | 15.4 steps/s
Avg test loss: 6.68789, Avg test acc: 0.31104, Avg tpr: 0.01329, Avg fpr: 0.03410, total FA: 266

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.97954 | acc=0.3127 | tpr=0.0203 | fpr=0.0523 | 4020.6 samples/s | 15.7 steps/s
Avg test loss: 5.00127, Avg test acc: 0.31180, Avg tpr: 0.02203, Avg fpr: 0.05089, total FA: 397

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.73025 | acc=0.3152 | tpr=0.0059 | fpr=0.0131 | 4010.2 samples/s | 15.7 steps/s
Avg test loss: 5.75066, Avg test acc: 0.31265, Avg tpr: 0.00624, Avg fpr: 0.01346, total FA: 105

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.84945 | acc=0.1380 | tpr=0.9292 | fpr=0.8763 | 4086.0 samples/s | 16.0 steps/s
[Step= 100] | Loss=4.84095 | acc=0.1407 | tpr=0.9062 | fpr=0.8736 | 7105.6 samples/s | 27.8 steps/s
[Step= 150] | Loss=4.85838 | acc=0.1386 | tpr=0.8919 | fpr=0.8752 | 7154.9 samples/s | 27.9 steps/s
[Step= 200] | Loss=4.85101 | acc=0.1393 | tpr=0.8918 | fpr=0.8744 | 7262.8 samples/s | 28.4 steps/s
[Step= 250] | Loss=4.86011 | acc=0.1391 | tpr=0.8891 | fpr=0.8746 | 6983.0 samples/s | 27.3 steps/s
[Step= 300] | Loss=4.86051 | acc=0.1384 | tpr=0.8873 | fpr=0.8752 | 7464.5 samples/s | 29.2 steps/s
[Step= 350] | Loss=4.85980 | acc=0.1389 | tpr=0.8854 | fpr=0.8747 | 7581.9 samples/s | 29.6 steps/s
[Step= 400] | Loss=4.86109 | acc=0.1390 | tpr=0.8835 | fpr=0.8745 | 7987.1 samples/s | 31.2 steps/s
[Step= 450] | Loss=4.85959 | acc=0.1393 | tpr=0.8836 | fpr=0.8742 | 7511.7 samples/s | 29.3 steps/s
[Step= 500] | Loss=4.86275 | acc=0.1390 | tpr=0.8872 | fpr=0.8745 | 7744.6 samples/s | 30.3 steps/s
[Step= 550] | Loss=4.86015 | acc=0.1389 | tpr=0.8846 | fpr=0.8746 | 13755.9 samples/s | 53.7 steps/s
Avg test loss: 4.86096, Avg test acc: 0.13883, Avg tpr: 0.88510, Avg fpr: 0.87474, total FA: 121456

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.31685 | acc=0.1199 | tpr=0.8894 | fpr=0.8939 | 4243.9 samples/s | 16.6 steps/s
[Step= 100] | Loss=4.29225 | acc=0.1204 | tpr=0.8699 | fpr=0.8936 | 7932.5 samples/s | 31.0 steps/s
[Step= 150] | Loss=4.30303 | acc=0.1189 | tpr=0.8602 | fpr=0.8948 | 6971.9 samples/s | 27.2 steps/s
[Step= 200] | Loss=4.29878 | acc=0.1187 | tpr=0.8568 | fpr=0.8947 | 7545.9 samples/s | 29.5 steps/s
[Step= 250] | Loss=4.30582 | acc=0.1188 | tpr=0.8559 | fpr=0.8946 | 8033.3 samples/s | 31.4 steps/s
[Step= 300] | Loss=4.30421 | acc=0.1184 | tpr=0.8531 | fpr=0.8950 | 7191.9 samples/s | 28.1 steps/s
[Step= 350] | Loss=4.30293 | acc=0.1180 | tpr=0.8560 | fpr=0.8954 | 7307.9 samples/s | 28.5 steps/s
[Step= 400] | Loss=4.30299 | acc=0.1182 | tpr=0.8600 | fpr=0.8953 | 7627.3 samples/s | 29.8 steps/s
[Step= 450] | Loss=4.30548 | acc=0.1181 | tpr=0.8588 | fpr=0.8954 | 7767.9 samples/s | 30.3 steps/s
[Step= 500] | Loss=4.30705 | acc=0.1177 | tpr=0.8568 | fpr=0.8956 | 7061.1 samples/s | 27.6 steps/s
[Step= 550] | Loss=4.30389 | acc=0.1180 | tpr=0.8583 | fpr=0.8954 | 14865.5 samples/s | 58.1 steps/s
Avg test loss: 4.30530, Avg test acc: 0.11795, Avg tpr: 0.85816, Avg fpr: 0.89550, total FA: 124339

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.20011 | acc=0.1223 | tpr=0.8850 | fpr=0.8914 | 3955.1 samples/s | 15.4 steps/s
[Step= 100] | Loss=4.18390 | acc=0.1240 | tpr=0.8763 | fpr=0.8901 | 7722.4 samples/s | 30.2 steps/s
[Step= 150] | Loss=4.20115 | acc=0.1226 | tpr=0.8790 | fpr=0.8913 | 8127.9 samples/s | 31.7 steps/s
[Step= 200] | Loss=4.19204 | acc=0.1232 | tpr=0.8743 | fpr=0.8905 | 7358.3 samples/s | 28.7 steps/s
[Step= 250] | Loss=4.19648 | acc=0.1237 | tpr=0.8742 | fpr=0.8900 | 7364.4 samples/s | 28.8 steps/s
[Step= 300] | Loss=4.20345 | acc=0.1228 | tpr=0.8764 | fpr=0.8909 | 7448.3 samples/s | 29.1 steps/s
[Step= 350] | Loss=4.20075 | acc=0.1228 | tpr=0.8754 | fpr=0.8909 | 7161.2 samples/s | 28.0 steps/s
[Step= 400] | Loss=4.20370 | acc=0.1226 | tpr=0.8731 | fpr=0.8910 | 7514.6 samples/s | 29.4 steps/s
[Step= 450] | Loss=4.20503 | acc=0.1224 | tpr=0.8788 | fpr=0.8913 | 7527.9 samples/s | 29.4 steps/s
[Step= 500] | Loss=4.20651 | acc=0.1224 | tpr=0.8815 | fpr=0.8913 | 7340.3 samples/s | 28.7 steps/s
[Step= 550] | Loss=4.20679 | acc=0.1227 | tpr=0.8806 | fpr=0.8910 | 13441.9 samples/s | 52.5 steps/s
Avg test loss: 4.20806, Avg test acc: 0.12265, Avg tpr: 0.88035, Avg fpr: 0.89113, total FA: 123731

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.52663 | acc=0.1785 | tpr=0.6504 | fpr=0.8300 | 3915.6 samples/s | 15.3 steps/s
[Step= 100] | Loss=4.51086 | acc=0.1775 | tpr=0.6461 | fpr=0.8312 | 7839.2 samples/s | 30.6 steps/s
[Step= 150] | Loss=4.50516 | acc=0.1771 | tpr=0.6268 | fpr=0.8312 | 7408.6 samples/s | 28.9 steps/s
[Step= 200] | Loss=4.50192 | acc=0.1779 | tpr=0.6240 | fpr=0.8302 | 7913.2 samples/s | 30.9 steps/s
[Step= 250] | Loss=4.50771 | acc=0.1783 | tpr=0.6192 | fpr=0.8298 | 7609.6 samples/s | 29.7 steps/s
[Step= 300] | Loss=4.50818 | acc=0.1778 | tpr=0.6189 | fpr=0.8303 | 7826.5 samples/s | 30.6 steps/s
[Step= 350] | Loss=4.50672 | acc=0.1774 | tpr=0.6187 | fpr=0.8306 | 7652.9 samples/s | 29.9 steps/s
[Step= 400] | Loss=4.50402 | acc=0.1783 | tpr=0.6258 | fpr=0.8298 | 7895.1 samples/s | 30.8 steps/s
[Step= 450] | Loss=4.50429 | acc=0.1780 | tpr=0.6256 | fpr=0.8302 | 7149.0 samples/s | 27.9 steps/s
[Step= 500] | Loss=4.50868 | acc=0.1781 | tpr=0.6322 | fpr=0.8301 | 7378.6 samples/s | 28.8 steps/s
[Step= 550] | Loss=4.50916 | acc=0.1779 | tpr=0.6347 | fpr=0.8304 | 13550.8 samples/s | 52.9 steps/s
Avg test loss: 4.51012, Avg test acc: 0.17772, Avg tpr: 0.63510, Avg fpr: 0.83059, total FA: 115326

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.42940 | acc=0.1763 | tpr=0.7080 | fpr=0.8332 | 4057.8 samples/s | 15.9 steps/s
[Step= 100] | Loss=4.40843 | acc=0.1784 | tpr=0.7228 | fpr=0.8318 | 7333.0 samples/s | 28.6 steps/s
[Step= 150] | Loss=4.41298 | acc=0.1779 | tpr=0.7118 | fpr=0.8319 | 7242.8 samples/s | 28.3 steps/s
[Step= 200] | Loss=4.41047 | acc=0.1789 | tpr=0.7115 | fpr=0.8308 | 7244.7 samples/s | 28.3 steps/s
[Step= 250] | Loss=4.41960 | acc=0.1775 | tpr=0.7004 | fpr=0.8320 | 7727.2 samples/s | 30.2 steps/s
[Step= 300] | Loss=4.42631 | acc=0.1766 | tpr=0.6953 | fpr=0.8328 | 7380.8 samples/s | 28.8 steps/s
[Step= 350] | Loss=4.42621 | acc=0.1766 | tpr=0.7019 | fpr=0.8329 | 7634.6 samples/s | 29.8 steps/s
[Step= 400] | Loss=4.42367 | acc=0.1765 | tpr=0.7139 | fpr=0.8332 | 7428.9 samples/s | 29.0 steps/s
[Step= 450] | Loss=4.43003 | acc=0.1761 | tpr=0.7147 | fpr=0.8337 | 7797.4 samples/s | 30.5 steps/s
[Step= 500] | Loss=4.43032 | acc=0.1760 | tpr=0.7137 | fpr=0.8337 | 7071.9 samples/s | 27.6 steps/s
[Step= 550] | Loss=4.42882 | acc=0.1759 | tpr=0.7151 | fpr=0.8339 | 13799.5 samples/s | 53.9 steps/s
Avg test loss: 4.42967, Avg test acc: 0.17587, Avg tpr: 0.71474, Avg fpr: 0.83393, total FA: 115789

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.06867 | acc=0.9790 | tpr=0.8673 | fpr=0.0190 | 4266.4 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.06905 | acc=0.9791 | tpr=0.8827 | fpr=0.0191 | 7179.6 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.07150 | acc=0.9785 | tpr=0.8934 | fpr=0.0199 | 7371.7 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.07295 | acc=0.9784 | tpr=0.9016 | fpr=0.0202 | 7385.1 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.07289 | acc=0.9784 | tpr=0.9022 | fpr=0.0202 | 7980.0 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.07354 | acc=0.9784 | tpr=0.9004 | fpr=0.0202 | 7254.9 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.07340 | acc=0.9784 | tpr=0.9011 | fpr=0.0202 | 7603.3 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.07402 | acc=0.9781 | tpr=0.9010 | fpr=0.0205 | 7481.2 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.07562 | acc=0.9780 | tpr=0.8982 | fpr=0.0205 | 7625.9 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.07503 | acc=0.9782 | tpr=0.8982 | fpr=0.0203 | 7416.0 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.07430 | acc=0.9785 | tpr=0.8985 | fpr=0.0200 | 14106.0 samples/s | 55.1 steps/s
Avg test loss: 0.07414, Avg test acc: 0.97852, Avg tpr: 0.89857, Avg fpr: 0.02003, total FA: 2781

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.05491 | acc=0.9834 | tpr=0.8717 | fpr=0.0146 | 4060.0 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.05491 | acc=0.9828 | tpr=0.8913 | fpr=0.0155 | 7168.0 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.05641 | acc=0.9823 | tpr=0.8890 | fpr=0.0160 | 7955.7 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.05812 | acc=0.9820 | tpr=0.8951 | fpr=0.0164 | 7686.7 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.05769 | acc=0.9824 | tpr=0.8978 | fpr=0.0161 | 7628.3 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.05786 | acc=0.9822 | tpr=0.8916 | fpr=0.0162 | 8033.1 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.05795 | acc=0.9822 | tpr=0.8942 | fpr=0.0162 | 7691.8 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.05855 | acc=0.9821 | tpr=0.8911 | fpr=0.0162 | 7405.8 samples/s | 28.9 steps/s
[Step= 450] | Loss=0.05894 | acc=0.9820 | tpr=0.8885 | fpr=0.0163 | 7178.9 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.05859 | acc=0.9821 | tpr=0.8903 | fpr=0.0162 | 7315.9 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.05812 | acc=0.9823 | tpr=0.8890 | fpr=0.0160 | 13376.8 samples/s | 52.3 steps/s
Avg test loss: 0.05807, Avg test acc: 0.98229, Avg tpr: 0.88946, Avg fpr: 0.01602, total FA: 2225

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.05304 | acc=0.9839 | tpr=0.9159 | fpr=0.0149 | 4022.5 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.05238 | acc=0.9833 | tpr=0.9339 | fpr=0.0158 | 7448.9 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.05273 | acc=0.9832 | tpr=0.9380 | fpr=0.0160 | 7575.3 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.05296 | acc=0.9829 | tpr=0.9399 | fpr=0.0163 | 7298.0 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.05292 | acc=0.9828 | tpr=0.9380 | fpr=0.0164 | 7985.3 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.05322 | acc=0.9827 | tpr=0.9345 | fpr=0.0165 | 7267.7 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.05307 | acc=0.9826 | tpr=0.9336 | fpr=0.0165 | 7713.9 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.05384 | acc=0.9824 | tpr=0.9338 | fpr=0.0167 | 7620.6 samples/s | 29.8 steps/s
[Step= 450] | Loss=0.05427 | acc=0.9821 | tpr=0.9304 | fpr=0.0169 | 7182.0 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.05425 | acc=0.9823 | tpr=0.9335 | fpr=0.0168 | 7715.2 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.05375 | acc=0.9825 | tpr=0.9308 | fpr=0.0166 | 13336.5 samples/s | 52.1 steps/s
Avg test loss: 0.05368, Avg test acc: 0.98246, Avg tpr: 0.93106, Avg fpr: 0.01661, total FA: 2306

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.07110 | acc=0.9807 | tpr=0.8673 | fpr=0.0173 | 4176.4 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.07113 | acc=0.9807 | tpr=0.8806 | fpr=0.0174 | 7187.6 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.07443 | acc=0.9803 | tpr=0.8818 | fpr=0.0179 | 7672.0 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.07673 | acc=0.9801 | tpr=0.8907 | fpr=0.0183 | 7493.8 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.07506 | acc=0.9805 | tpr=0.8891 | fpr=0.0179 | 7786.6 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.07617 | acc=0.9802 | tpr=0.8865 | fpr=0.0181 | 7601.6 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.07584 | acc=0.9803 | tpr=0.8917 | fpr=0.0181 | 8049.5 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.07608 | acc=0.9802 | tpr=0.8917 | fpr=0.0182 | 7283.5 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.07748 | acc=0.9798 | tpr=0.8851 | fpr=0.0185 | 7826.4 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.07711 | acc=0.9799 | tpr=0.8868 | fpr=0.0184 | 7674.4 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.07611 | acc=0.9800 | tpr=0.8870 | fpr=0.0183 | 13488.3 samples/s | 52.7 steps/s
Avg test loss: 0.07602, Avg test acc: 0.98002, Avg tpr: 0.88708, Avg fpr: 0.01829, total FA: 2540

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.06098 | acc=0.9834 | tpr=0.8673 | fpr=0.0146 | 4029.9 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.06241 | acc=0.9829 | tpr=0.8849 | fpr=0.0153 | 7846.3 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.06443 | acc=0.9826 | tpr=0.8876 | fpr=0.0156 | 7781.1 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.06478 | acc=0.9823 | tpr=0.8863 | fpr=0.0159 | 7514.0 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.06486 | acc=0.9825 | tpr=0.8865 | fpr=0.0158 | 7838.5 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.06606 | acc=0.9821 | tpr=0.8778 | fpr=0.0160 | 7708.7 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.06616 | acc=0.9819 | tpr=0.8817 | fpr=0.0163 | 7581.3 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.06674 | acc=0.9818 | tpr=0.8786 | fpr=0.0164 | 7321.0 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.06822 | acc=0.9814 | tpr=0.8759 | fpr=0.0167 | 7337.7 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.06734 | acc=0.9816 | tpr=0.8744 | fpr=0.0165 | 7861.6 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.06684 | acc=0.9816 | tpr=0.8723 | fpr=0.0164 | 14686.9 samples/s | 57.4 steps/s
Avg test loss: 0.06681, Avg test acc: 0.98165, Avg tpr: 0.87242, Avg fpr: 0.01636, total FA: 2272

server round 8/10

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.00233 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.995 | L2-Norm(final)=2.305 | 4175.8 samples/s | 65.2 steps/s
[Step=4050 Epoch=19.7] | Loss=0.00920 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.996 | L2-Norm(final)=2.310 | 4173.1 samples/s | 65.2 steps/s
[Step=4100 Epoch=20.0] | Loss=0.01065 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.000 | L2-Norm(final)=2.310 | 4374.3 samples/s | 68.3 steps/s
[Step=4150 Epoch=20.2] | Loss=0.01283 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.004 | L2-Norm(final)=2.307 | 4381.2 samples/s | 68.5 steps/s
[Step=4200 Epoch=20.5] | Loss=0.01301 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.005 | L2-Norm(final)=2.306 | 6192.8 samples/s | 96.8 steps/s
[Step=4250 Epoch=20.7] | Loss=0.01171 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.002 | L2-Norm(final)=2.304 | 1893.7 samples/s | 29.6 steps/s
[Step=4300 Epoch=21.0] | Loss=0.01184 | Reg=0.00324 | acc=0.9844 | L2-Norm=17.998 | L2-Norm(final)=2.303 | 4191.1 samples/s | 65.5 steps/s
[Step=4350 Epoch=21.2] | Loss=0.01148 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.990 | L2-Norm(final)=2.301 | 4311.4 samples/s | 67.4 steps/s
[Step=4400 Epoch=21.5] | Loss=0.01075 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.983 | L2-Norm(final)=2.301 | 5611.4 samples/s | 87.7 steps/s
[Step=4450 Epoch=21.7] | Loss=0.01020 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.974 | L2-Norm(final)=2.302 | 1950.9 samples/s | 30.5 steps/s
[Step=4500 Epoch=21.9] | Loss=0.00965 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.964 | L2-Norm(final)=2.303 | 4359.2 samples/s | 68.1 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_0/client_state-step4500.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.01499 | Reg=0.00339 | acc=0.9844 | L2-Norm=18.401 | L2-Norm(final)=2.266 | 4418.9 samples/s | 69.0 steps/s
[Step=4050 Epoch=19.8] | Loss=0.01067 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.396 | L2-Norm(final)=2.263 | 4263.0 samples/s | 66.6 steps/s
[Step=4100 Epoch=20.0] | Loss=0.01176 | Reg=0.00339 | acc=0.9688 | L2-Norm=18.403 | L2-Norm(final)=2.267 | 4525.3 samples/s | 70.7 steps/s
[Step=4150 Epoch=20.3] | Loss=0.01158 | Reg=0.00339 | acc=0.9688 | L2-Norm=18.406 | L2-Norm(final)=2.269 | 4495.1 samples/s | 70.2 steps/s
[Step=4200 Epoch=20.5] | Loss=0.01104 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.405 | L2-Norm(final)=2.270 | 6146.8 samples/s | 96.0 steps/s
[Step=4250 Epoch=20.7] | Loss=0.01023 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.404 | L2-Norm(final)=2.274 | 1934.6 samples/s | 30.2 steps/s
[Step=4300 Epoch=21.0] | Loss=0.00947 | Reg=0.00339 | acc=0.9844 | L2-Norm=18.398 | L2-Norm(final)=2.276 | 4506.9 samples/s | 70.4 steps/s
[Step=4350 Epoch=21.2] | Loss=0.00915 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.390 | L2-Norm(final)=2.278 | 4665.7 samples/s | 72.9 steps/s
[Step=4400 Epoch=21.5] | Loss=0.00895 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.381 | L2-Norm(final)=2.280 | 5363.5 samples/s | 83.8 steps/s
[Step=4450 Epoch=21.7] | Loss=0.00888 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.373 | L2-Norm(final)=2.281 | 1943.1 samples/s | 30.4 steps/s
[Step=4500 Epoch=22.0] | Loss=0.00843 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.363 | L2-Norm(final)=2.283 | 4364.7 samples/s | 68.2 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_1/client_state-step4500.h5

Train client 2: client_asml1_2
Local layers training...
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.00677 | Reg=0.00358 | acc=1.0000 | L2-Norm=18.918 | L2-Norm(final)=2.270 | 4148.9 samples/s | 64.8 steps/s
[Step=4050 Epoch=19.7] | Loss=0.01419 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.939 | L2-Norm(final)=2.274 | 4628.7 samples/s | 72.3 steps/s
[Step=4100 Epoch=20.0] | Loss=0.01472 | Reg=0.00359 | acc=0.9844 | L2-Norm=18.939 | L2-Norm(final)=2.271 | 4726.3 samples/s | 73.8 steps/s
[Step=4150 Epoch=20.2] | Loss=0.01446 | Reg=0.00359 | acc=0.9844 | L2-Norm=18.938 | L2-Norm(final)=2.270 | 4583.0 samples/s | 71.6 steps/s
[Step=4200 Epoch=20.5] | Loss=0.01402 | Reg=0.00359 | acc=0.9844 | L2-Norm=18.937 | L2-Norm(final)=2.270 | 6024.5 samples/s | 94.1 steps/s
[Step=4250 Epoch=20.7] | Loss=0.01396 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.937 | L2-Norm(final)=2.269 | 1963.3 samples/s | 30.7 steps/s
[Step=4300 Epoch=21.0] | Loss=0.01297 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.937 | L2-Norm(final)=2.269 | 4513.7 samples/s | 70.5 steps/s
[Step=4350 Epoch=21.2] | Loss=0.01195 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.934 | L2-Norm(final)=2.271 | 4535.9 samples/s | 70.9 steps/s
[Step=4400 Epoch=21.4] | Loss=0.01154 | Reg=0.00358 | acc=1.0000 | L2-Norm=18.929 | L2-Norm(final)=2.272 | 5884.9 samples/s | 92.0 steps/s
[Step=4450 Epoch=21.7] | Loss=0.01198 | Reg=0.00358 | acc=1.0000 | L2-Norm=18.922 | L2-Norm(final)=2.271 | 2012.0 samples/s | 31.4 steps/s
[Step=4500 Epoch=21.9] | Loss=0.01131 | Reg=0.00358 | acc=1.0000 | L2-Norm=18.914 | L2-Norm(final)=2.269 | 4459.5 samples/s | 69.7 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_2/client_state-step4500.h5

Train client 3: client_asml1_3
Local layers training...
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.00867 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.102 | L2-Norm(final)=2.335 | 4386.0 samples/s | 68.5 steps/s
[Step=4050 Epoch=19.8] | Loss=0.00936 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.104 | L2-Norm(final)=2.342 | 4611.6 samples/s | 72.1 steps/s
[Step=4100 Epoch=20.0] | Loss=0.01251 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.101 | L2-Norm(final)=2.334 | 4484.8 samples/s | 70.1 steps/s
[Step=4150 Epoch=20.2] | Loss=0.01198 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.098 | L2-Norm(final)=2.331 | 4547.1 samples/s | 71.0 steps/s
[Step=4200 Epoch=20.5] | Loss=0.01289 | Reg=0.00327 | acc=0.9844 | L2-Norm=18.094 | L2-Norm(final)=2.327 | 6075.6 samples/s | 94.9 steps/s
[Step=4250 Epoch=20.7] | Loss=0.01237 | Reg=0.00328 | acc=0.9844 | L2-Norm=18.099 | L2-Norm(final)=2.323 | 1887.8 samples/s | 29.5 steps/s
[Step=4300 Epoch=21.0] | Loss=0.01217 | Reg=0.00328 | acc=0.9531 | L2-Norm=18.106 | L2-Norm(final)=2.322 | 4414.8 samples/s | 69.0 steps/s
[Step=4350 Epoch=21.2] | Loss=0.01193 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.112 | L2-Norm(final)=2.320 | 4630.1 samples/s | 72.3 steps/s
[Step=4400 Epoch=21.5] | Loss=0.01190 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.119 | L2-Norm(final)=2.318 | 5533.6 samples/s | 86.5 steps/s
[Step=4450 Epoch=21.7] | Loss=0.01166 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.125 | L2-Norm(final)=2.317 | 1971.8 samples/s | 30.8 steps/s
[Step=4500 Epoch=21.9] | Loss=0.01150 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.130 | L2-Norm(final)=2.316 | 4372.6 samples/s | 68.3 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_3/client_state-step4500.h5

Train client 4: client_asml1_4
Local layers training...
LR=0.00100, len=1
[Step=4001 Epoch=19.6] | Loss=0.01685 | Reg=0.00338 | acc=0.9844 | L2-Norm=18.382 | L2-Norm(final)=2.352 | 4447.7 samples/s | 69.5 steps/s
[Step=4050 Epoch=19.9] | Loss=0.00595 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.382 | L2-Norm(final)=2.354 | 4261.7 samples/s | 66.6 steps/s
[Step=4100 Epoch=20.1] | Loss=0.00641 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.377 | L2-Norm(final)=2.356 | 4291.6 samples/s | 67.1 steps/s
[Step=4150 Epoch=20.4] | Loss=0.00752 | Reg=0.00337 | acc=0.9688 | L2-Norm=18.367 | L2-Norm(final)=2.357 | 4434.3 samples/s | 69.3 steps/s
[Step=4200 Epoch=20.6] | Loss=0.00848 | Reg=0.00337 | acc=0.9844 | L2-Norm=18.355 | L2-Norm(final)=2.358 | 6211.9 samples/s | 97.1 steps/s
[Step=4250 Epoch=20.8] | Loss=0.00848 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.347 | L2-Norm(final)=2.358 | 1891.6 samples/s | 29.6 steps/s
[Step=4300 Epoch=21.1] | Loss=0.00922 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.344 | L2-Norm(final)=2.358 | 4339.7 samples/s | 67.8 steps/s
[Step=4350 Epoch=21.3] | Loss=0.00932 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.344 | L2-Norm(final)=2.358 | 4325.3 samples/s | 67.6 steps/s
[Step=4400 Epoch=21.6] | Loss=0.00949 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.346 | L2-Norm(final)=2.357 | 5628.2 samples/s | 87.9 steps/s
[Step=4450 Epoch=21.8] | Loss=0.01004 | Reg=0.00337 | acc=0.9844 | L2-Norm=18.350 | L2-Norm(final)=2.356 | 1907.6 samples/s | 29.8 steps/s
[Step=4500 Epoch=22.1] | Loss=0.01097 | Reg=0.00337 | acc=0.9844 | L2-Norm=18.355 | L2-Norm(final)=2.354 | 4463.7 samples/s | 69.7 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_4/client_state-step4500.h5

Train client 5: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=4001 Epoch=37.9] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.577 | L2-Norm(final)=3.561 | 4424.8 samples/s | 69.1 steps/s
[Step=4050 Epoch=38.4] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.535 | L2-Norm(final)=3.574 | 3659.7 samples/s | 57.2 steps/s
[Step=4100 Epoch=38.9] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.493 | L2-Norm(final)=3.592 | 5614.0 samples/s | 87.7 steps/s
[Step=4150 Epoch=39.3] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.452 | L2-Norm(final)=3.610 | 1797.6 samples/s | 28.1 steps/s
[Step=4200 Epoch=39.8] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.410 | L2-Norm(final)=3.627 | 5147.0 samples/s | 80.4 steps/s
[Step=4250 Epoch=40.3] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.370 | L2-Norm(final)=3.645 | 1846.9 samples/s | 28.9 steps/s
[Step=4300 Epoch=40.7] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.329 | L2-Norm(final)=3.663 | 4666.5 samples/s | 72.9 steps/s
[Step=4350 Epoch=41.2] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.288 | L2-Norm(final)=3.680 | 1963.2 samples/s | 30.7 steps/s
[Step=4400 Epoch=41.7] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.246 | L2-Norm(final)=3.697 | 4603.1 samples/s | 71.9 steps/s
[Step=4450 Epoch=42.2] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.205 | L2-Norm(final)=3.714 | 1962.2 samples/s | 30.7 steps/s
[Step=4500 Epoch=42.6] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.163 | L2-Norm(final)=3.731 | 4472.5 samples/s | 69.9 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_0/client_state-step4500.h5

Train client 6: client_iccad2012_1
Local layers training...
LR=0.00100, len=1
[Step=4001 Epoch=38.1] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.009 | L2-Norm(final)=3.551 | 4173.7 samples/s | 65.2 steps/s
[Step=4050 Epoch=38.5] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.972 | L2-Norm(final)=3.566 | 4137.4 samples/s | 64.6 steps/s
[Step=4100 Epoch=39.0] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.932 | L2-Norm(final)=3.580 | 5798.6 samples/s | 90.6 steps/s
[Step=4150 Epoch=39.5] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.891 | L2-Norm(final)=3.594 | 1844.4 samples/s | 28.8 steps/s
[Step=4200 Epoch=40.0] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.850 | L2-Norm(final)=3.609 | 5494.8 samples/s | 85.9 steps/s
[Step=4250 Epoch=40.4] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=3.624 | 1821.0 samples/s | 28.5 steps/s
[Step=4300 Epoch=40.9] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.770 | L2-Norm(final)=3.640 | 4647.0 samples/s | 72.6 steps/s
[Step=4350 Epoch=41.4] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.730 | L2-Norm(final)=3.656 | 1867.9 samples/s | 29.2 steps/s
[Step=4400 Epoch=41.9] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.690 | L2-Norm(final)=3.673 | 4441.9 samples/s | 69.4 steps/s
[Step=4450 Epoch=42.3] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.650 | L2-Norm(final)=3.688 | 1931.1 samples/s | 30.2 steps/s
[Step=4500 Epoch=42.8] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.611 | L2-Norm(final)=3.705 | 4319.3 samples/s | 67.5 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_1/client_state-step4500.h5

Train client 7: client_iccad2012_2
Local layers training...
LR=0.00100, len=1
[Step=4001 Epoch=38.2] | Loss=0.00001 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.264 | L2-Norm(final)=2.657 | 4205.5 samples/s | 65.7 steps/s
[Step=4050 Epoch=38.7] | Loss=0.00001 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.247 | L2-Norm(final)=2.662 | 4128.1 samples/s | 64.5 steps/s
[Step=4100 Epoch=39.2] | Loss=0.00001 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.230 | L2-Norm(final)=2.670 | 5911.5 samples/s | 92.4 steps/s
[Step=4150 Epoch=39.6] | Loss=0.00001 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.212 | L2-Norm(final)=2.677 | 1787.2 samples/s | 27.9 steps/s
[Step=4200 Epoch=40.1] | Loss=0.00001 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.194 | L2-Norm(final)=2.684 | 5527.6 samples/s | 86.4 steps/s
[Step=4250 Epoch=40.6] | Loss=0.00001 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.176 | L2-Norm(final)=2.692 | 1893.4 samples/s | 29.6 steps/s
[Step=4300 Epoch=41.1] | Loss=0.00001 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.159 | L2-Norm(final)=2.699 | 5019.7 samples/s | 78.4 steps/s
[Step=4350 Epoch=41.5] | Loss=0.00001 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.141 | L2-Norm(final)=2.707 | 1870.8 samples/s | 29.2 steps/s
[Step=4400 Epoch=42.0] | Loss=0.00001 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.123 | L2-Norm(final)=2.714 | 4874.7 samples/s | 76.2 steps/s
[Step=4450 Epoch=42.5] | Loss=0.00001 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.105 | L2-Norm(final)=2.722 | 1959.2 samples/s | 30.6 steps/s
[Step=4500 Epoch=43.0] | Loss=0.00001 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.087 | L2-Norm(final)=2.730 | 4306.0 samples/s | 67.3 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_2/client_state-step4500.h5

Train client 8: client_iccad2012_3
Local layers training...
LR=0.00100, len=1
[Step=4001 Epoch=37.7] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.395 | L2-Norm(final)=3.466 | 4061.3 samples/s | 63.5 steps/s
[Step=4050 Epoch=38.2] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.356 | L2-Norm(final)=3.480 | 3713.0 samples/s | 58.0 steps/s
[Step=4100 Epoch=38.6] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.317 | L2-Norm(final)=3.497 | 5886.2 samples/s | 92.0 steps/s
[Step=4150 Epoch=39.1] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.279 | L2-Norm(final)=3.516 | 1833.7 samples/s | 28.7 steps/s
[Step=4200 Epoch=39.6] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.240 | L2-Norm(final)=3.533 | 5039.0 samples/s | 78.7 steps/s
[Step=4250 Epoch=40.0] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.201 | L2-Norm(final)=3.550 | 1910.1 samples/s | 29.8 steps/s
[Step=4300 Epoch=40.5] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.161 | L2-Norm(final)=3.566 | 4783.3 samples/s | 74.7 steps/s
[Step=4350 Epoch=41.0] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.122 | L2-Norm(final)=3.583 | 1978.8 samples/s | 30.9 steps/s
[Step=4400 Epoch=41.5] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.082 | L2-Norm(final)=3.600 | 4294.4 samples/s | 67.1 steps/s
[Step=4450 Epoch=41.9] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.043 | L2-Norm(final)=3.617 | 2044.9 samples/s | 32.0 steps/s
[Step=4500 Epoch=42.4] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.003 | L2-Norm(final)=3.635 | 4129.9 samples/s | 64.5 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_3/client_state-step4500.h5

Train client 9: client_iccad2012_4
Local layers training...
LR=0.00100, len=1
[Step=4001 Epoch=38.1] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.280 | L2-Norm(final)=3.518 | 4288.2 samples/s | 67.0 steps/s
[Step=4050 Epoch=38.6] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.241 | L2-Norm(final)=3.535 | 4049.7 samples/s | 63.3 steps/s
[Step=4100 Epoch=39.1] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.204 | L2-Norm(final)=3.556 | 5785.1 samples/s | 90.4 steps/s
[Step=4150 Epoch=39.6] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.168 | L2-Norm(final)=3.576 | 1861.5 samples/s | 29.1 steps/s
[Step=4200 Epoch=40.0] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.129 | L2-Norm(final)=3.593 | 5042.0 samples/s | 78.8 steps/s
[Step=4250 Epoch=40.5] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.090 | L2-Norm(final)=3.609 | 1848.0 samples/s | 28.9 steps/s
[Step=4300 Epoch=41.0] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.051 | L2-Norm(final)=3.627 | 5126.7 samples/s | 80.1 steps/s
[Step=4350 Epoch=41.5] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.012 | L2-Norm(final)=3.644 | 1872.0 samples/s | 29.3 steps/s
[Step=4400 Epoch=41.9] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.973 | L2-Norm(final)=3.662 | 4547.4 samples/s | 71.1 steps/s
[Step=4450 Epoch=42.4] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.935 | L2-Norm(final)=3.681 | 1949.7 samples/s | 30.5 steps/s
[Step=4500 Epoch=42.9] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.895 | L2-Norm(final)=3.698 | 4622.3 samples/s | 72.2 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_4/client_state-step4500.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.19954 | acc=0.9324 | tpr=0.9475 | fpr=0.1003 | 4042.2 samples/s | 15.8 steps/s
Avg test loss: 0.20642, Avg test acc: 0.92820, Avg tpr: 0.94364, Avg fpr: 0.10576, total FA: 825

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.22563 | acc=0.9309 | tpr=0.9597 | fpr=0.1316 | 3974.6 samples/s | 15.5 steps/s
Avg test loss: 0.22564, Avg test acc: 0.93052, Avg tpr: 0.95850, Avg fpr: 0.13101, total FA: 1022

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.21008 | acc=0.9294 | tpr=0.9445 | fpr=0.1036 | 4057.1 samples/s | 15.8 steps/s
Avg test loss: 0.20995, Avg test acc: 0.92772, Avg tpr: 0.94247, Avg fpr: 0.10473, total FA: 817

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.20392 | acc=0.9302 | tpr=0.9532 | fpr=0.1197 | 4045.9 samples/s | 15.8 steps/s
Avg test loss: 0.21198, Avg test acc: 0.92780, Avg tpr: 0.95291, Avg fpr: 0.12742, total FA: 994

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.20170 | acc=0.9230 | tpr=0.9439 | fpr=0.1224 | 4008.8 samples/s | 15.7 steps/s
Avg test loss: 0.20594, Avg test acc: 0.92111, Avg tpr: 0.94154, Avg fpr: 0.12383, total FA: 966

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.61043 | acc=0.3161 | tpr=0.0040 | fpr=0.0062 | 3989.5 samples/s | 15.6 steps/s
Avg test loss: 6.64198, Avg test acc: 0.31297, Avg tpr: 0.00385, Avg fpr: 0.00718, total FA: 56

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.10069 | acc=0.3107 | tpr=0.0217 | fpr=0.0617 | 4037.3 samples/s | 15.8 steps/s
Avg test loss: 5.12540, Avg test acc: 0.30804, Avg tpr: 0.02127, Avg fpr: 0.06127, total FA: 478

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=6.49254 | acc=0.3137 | tpr=0.0123 | fpr=0.0317 | 4084.6 samples/s | 16.0 steps/s
Avg test loss: 6.51264, Avg test acc: 0.31128, Avg tpr: 0.01241, Avg fpr: 0.03141, total FA: 245

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.06408 | acc=0.3142 | tpr=0.0148 | fpr=0.0357 | 3948.4 samples/s | 15.4 steps/s
Avg test loss: 5.08597, Avg test acc: 0.31285, Avg tpr: 0.01615, Avg fpr: 0.03461, total FA: 270

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.75780 | acc=0.3154 | tpr=0.0042 | fpr=0.0089 | 3940.4 samples/s | 15.4 steps/s
Avg test loss: 5.77856, Avg test acc: 0.31265, Avg tpr: 0.00455, Avg fpr: 0.00974, total FA: 76

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.16749 | acc=0.1548 | tpr=0.9071 | fpr=0.8588 | 4087.1 samples/s | 16.0 steps/s
[Step= 100] | Loss=5.16411 | acc=0.1570 | tpr=0.8870 | fpr=0.8567 | 7675.6 samples/s | 30.0 steps/s
[Step= 150] | Loss=5.18107 | acc=0.1560 | tpr=0.8689 | fpr=0.8571 | 7321.8 samples/s | 28.6 steps/s
[Step= 200] | Loss=5.17310 | acc=0.1562 | tpr=0.8656 | fpr=0.8567 | 6943.2 samples/s | 27.1 steps/s
[Step= 250] | Loss=5.18263 | acc=0.1561 | tpr=0.8603 | fpr=0.8567 | 8086.2 samples/s | 31.6 steps/s
[Step= 300] | Loss=5.18727 | acc=0.1554 | tpr=0.8582 | fpr=0.8574 | 7330.5 samples/s | 28.6 steps/s
[Step= 350] | Loss=5.18759 | acc=0.1554 | tpr=0.8597 | fpr=0.8574 | 7190.6 samples/s | 28.1 steps/s
[Step= 400] | Loss=5.19013 | acc=0.1558 | tpr=0.8627 | fpr=0.8570 | 7048.8 samples/s | 27.5 steps/s
[Step= 450] | Loss=5.18808 | acc=0.1559 | tpr=0.8612 | fpr=0.8569 | 7331.7 samples/s | 28.6 steps/s
[Step= 500] | Loss=5.19404 | acc=0.1557 | tpr=0.8634 | fpr=0.8571 | 7426.4 samples/s | 29.0 steps/s
[Step= 550] | Loss=5.19023 | acc=0.1558 | tpr=0.8627 | fpr=0.8570 | 12944.4 samples/s | 50.6 steps/s
Avg test loss: 5.19089, Avg test acc: 0.15573, Avg tpr: 0.86331, Avg fpr: 0.85713, total FA: 119011

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.51565 | acc=0.1107 | tpr=0.9159 | fpr=0.9038 | 4058.1 samples/s | 15.9 steps/s
[Step= 100] | Loss=5.48272 | acc=0.1108 | tpr=0.9254 | fpr=0.9044 | 7815.3 samples/s | 30.5 steps/s
[Step= 150] | Loss=5.50035 | acc=0.1088 | tpr=0.9150 | fpr=0.9060 | 7218.5 samples/s | 28.2 steps/s
[Step= 200] | Loss=5.49705 | acc=0.1085 | tpr=0.9071 | fpr=0.9060 | 7675.2 samples/s | 30.0 steps/s
[Step= 250] | Loss=5.50288 | acc=0.1082 | tpr=0.8996 | fpr=0.9063 | 7503.9 samples/s | 29.3 steps/s
[Step= 300] | Loss=5.50062 | acc=0.1075 | tpr=0.8960 | fpr=0.9069 | 7633.5 samples/s | 29.8 steps/s
[Step= 350] | Loss=5.49914 | acc=0.1070 | tpr=0.8992 | fpr=0.9074 | 7586.1 samples/s | 29.6 steps/s
[Step= 400] | Loss=5.49947 | acc=0.1074 | tpr=0.9037 | fpr=0.9071 | 8024.4 samples/s | 31.3 steps/s
[Step= 450] | Loss=5.50286 | acc=0.1074 | tpr=0.9046 | fpr=0.9071 | 7145.1 samples/s | 27.9 steps/s
[Step= 500] | Loss=5.50351 | acc=0.1071 | tpr=0.9031 | fpr=0.9073 | 7123.1 samples/s | 27.8 steps/s
[Step= 550] | Loss=5.49943 | acc=0.1072 | tpr=0.9037 | fpr=0.9072 | 13072.4 samples/s | 51.1 steps/s
Avg test loss: 5.50043, Avg test acc: 0.10717, Avg tpr: 0.90333, Avg fpr: 0.90730, total FA: 125977

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.05737 | acc=0.1438 | tpr=0.8319 | fpr=0.8685 | 3976.8 samples/s | 15.5 steps/s
[Step= 100] | Loss=5.02002 | acc=0.1465 | tpr=0.7996 | fpr=0.8657 | 7940.1 samples/s | 31.0 steps/s
[Step= 150] | Loss=5.03418 | acc=0.1464 | tpr=0.8084 | fpr=0.8658 | 7766.6 samples/s | 30.3 steps/s
[Step= 200] | Loss=5.02504 | acc=0.1468 | tpr=0.8011 | fpr=0.8651 | 7471.6 samples/s | 29.2 steps/s
[Step= 250] | Loss=5.03116 | acc=0.1470 | tpr=0.8000 | fpr=0.8649 | 7903.8 samples/s | 30.9 steps/s
[Step= 300] | Loss=5.03456 | acc=0.1464 | tpr=0.7985 | fpr=0.8655 | 8187.8 samples/s | 32.0 steps/s
[Step= 350] | Loss=5.02903 | acc=0.1458 | tpr=0.7990 | fpr=0.8661 | 8128.6 samples/s | 31.8 steps/s
[Step= 400] | Loss=5.02925 | acc=0.1457 | tpr=0.8025 | fpr=0.8663 | 7895.4 samples/s | 30.8 steps/s
[Step= 450] | Loss=5.03194 | acc=0.1449 | tpr=0.8057 | fpr=0.8671 | 7683.8 samples/s | 30.0 steps/s
[Step= 500] | Loss=5.03608 | acc=0.1447 | tpr=0.8079 | fpr=0.8673 | 7273.1 samples/s | 28.4 steps/s
[Step= 550] | Loss=5.03743 | acc=0.1447 | tpr=0.8094 | fpr=0.8674 | 14354.5 samples/s | 56.1 steps/s
Avg test loss: 5.03923, Avg test acc: 0.14452, Avg tpr: 0.80864, Avg fpr: 0.86755, total FA: 120458

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.95322 | acc=0.1558 | tpr=0.7788 | fpr=0.8554 | 4094.4 samples/s | 16.0 steps/s
[Step= 100] | Loss=4.94620 | acc=0.1568 | tpr=0.7591 | fpr=0.8545 | 8063.0 samples/s | 31.5 steps/s
[Step= 150] | Loss=4.94055 | acc=0.1570 | tpr=0.7478 | fpr=0.8539 | 8078.7 samples/s | 31.6 steps/s
[Step= 200] | Loss=4.94113 | acc=0.1576 | tpr=0.7421 | fpr=0.8530 | 7613.7 samples/s | 29.7 steps/s
[Step= 250] | Loss=4.95074 | acc=0.1586 | tpr=0.7432 | fpr=0.8521 | 7494.7 samples/s | 29.3 steps/s
[Step= 300] | Loss=4.95184 | acc=0.1581 | tpr=0.7375 | fpr=0.8524 | 7453.5 samples/s | 29.1 steps/s
[Step= 350] | Loss=4.94969 | acc=0.1576 | tpr=0.7370 | fpr=0.8529 | 7436.1 samples/s | 29.0 steps/s
[Step= 400] | Loss=4.94699 | acc=0.1582 | tpr=0.7440 | fpr=0.8525 | 7437.2 samples/s | 29.1 steps/s
[Step= 450] | Loss=4.94783 | acc=0.1579 | tpr=0.7415 | fpr=0.8527 | 7605.4 samples/s | 29.7 steps/s
[Step= 500] | Loss=4.95130 | acc=0.1579 | tpr=0.7441 | fpr=0.8527 | 7202.8 samples/s | 28.1 steps/s
[Step= 550] | Loss=4.95312 | acc=0.1577 | tpr=0.7477 | fpr=0.8530 | 14454.8 samples/s | 56.5 steps/s
Avg test loss: 4.95459, Avg test acc: 0.15765, Avg tpr: 0.74802, Avg fpr: 0.85308, total FA: 118449

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.16196 | acc=0.1061 | tpr=0.8761 | fpr=0.9077 | 4039.8 samples/s | 15.8 steps/s
[Step= 100] | Loss=6.12201 | acc=0.1080 | tpr=0.8742 | fpr=0.9063 | 7887.0 samples/s | 30.8 steps/s
[Step= 150] | Loss=6.12537 | acc=0.1070 | tpr=0.8718 | fpr=0.9071 | 7597.6 samples/s | 29.7 steps/s
[Step= 200] | Loss=6.11971 | acc=0.1073 | tpr=0.8667 | fpr=0.9066 | 7383.8 samples/s | 28.8 steps/s
[Step= 250] | Loss=6.12660 | acc=0.1069 | tpr=0.8751 | fpr=0.9071 | 7531.1 samples/s | 29.4 steps/s
[Step= 300] | Loss=6.13412 | acc=0.1066 | tpr=0.8713 | fpr=0.9073 | 7698.1 samples/s | 30.1 steps/s
[Step= 350] | Loss=6.13305 | acc=0.1068 | tpr=0.8698 | fpr=0.9071 | 7682.1 samples/s | 30.0 steps/s
[Step= 400] | Loss=6.13188 | acc=0.1066 | tpr=0.8704 | fpr=0.9073 | 7561.3 samples/s | 29.5 steps/s
[Step= 450] | Loss=6.13448 | acc=0.1061 | tpr=0.8710 | fpr=0.9078 | 7385.4 samples/s | 28.8 steps/s
[Step= 500] | Loss=6.13324 | acc=0.1058 | tpr=0.8722 | fpr=0.9080 | 7139.8 samples/s | 27.9 steps/s
[Step= 550] | Loss=6.13144 | acc=0.1058 | tpr=0.8723 | fpr=0.9081 | 8077.9 samples/s | 31.6 steps/s
Avg test loss: 6.13164, Avg test acc: 0.10573, Avg tpr: 0.87242, Avg fpr: 0.90821, total FA: 126103

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.05076 | acc=0.9842 | tpr=0.8230 | fpr=0.0129 | 4255.9 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.05073 | acc=0.9839 | tpr=0.8422 | fpr=0.0134 | 7739.0 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.05222 | acc=0.9834 | tpr=0.8501 | fpr=0.0141 | 7554.7 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.05310 | acc=0.9835 | tpr=0.8623 | fpr=0.0143 | 7459.8 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.05297 | acc=0.9835 | tpr=0.8646 | fpr=0.0143 | 8316.1 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.05370 | acc=0.9834 | tpr=0.8618 | fpr=0.0144 | 7710.6 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.05358 | acc=0.9834 | tpr=0.8629 | fpr=0.0144 | 8590.0 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.05396 | acc=0.9833 | tpr=0.8627 | fpr=0.0145 | 7123.1 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.05539 | acc=0.9829 | tpr=0.8583 | fpr=0.0148 | 7645.6 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.05503 | acc=0.9830 | tpr=0.8581 | fpr=0.0148 | 7316.3 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.05462 | acc=0.9831 | tpr=0.8579 | fpr=0.0146 | 6362.4 samples/s | 24.9 steps/s
Avg test loss: 0.05450, Avg test acc: 0.98314, Avg tpr: 0.85777, Avg fpr: 0.01458, total FA: 2025

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.05204 | acc=0.9845 | tpr=0.8628 | fpr=0.0133 | 3946.1 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.05202 | acc=0.9842 | tpr=0.8827 | fpr=0.0139 | 7446.9 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.05359 | acc=0.9838 | tpr=0.8818 | fpr=0.0143 | 7313.6 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.05524 | acc=0.9836 | tpr=0.8852 | fpr=0.0146 | 7458.8 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.05492 | acc=0.9839 | tpr=0.8891 | fpr=0.0144 | 7512.3 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.05511 | acc=0.9835 | tpr=0.8815 | fpr=0.0146 | 7294.4 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.05512 | acc=0.9835 | tpr=0.8848 | fpr=0.0147 | 8000.7 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.05576 | acc=0.9834 | tpr=0.8807 | fpr=0.0147 | 7098.6 samples/s | 27.7 steps/s
[Step= 450] | Loss=0.05610 | acc=0.9834 | tpr=0.8793 | fpr=0.0147 | 7185.7 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.05583 | acc=0.9835 | tpr=0.8811 | fpr=0.0147 | 5441.0 samples/s | 21.3 steps/s
[Step= 550] | Loss=0.05548 | acc=0.9836 | tpr=0.8794 | fpr=0.0145 | 10135.6 samples/s | 39.6 steps/s
Avg test loss: 0.05543, Avg test acc: 0.98360, Avg tpr: 0.87995, Avg fpr: 0.01452, total FA: 2016

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.05312 | acc=0.9846 | tpr=0.9071 | fpr=0.0140 | 3955.6 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.05234 | acc=0.9840 | tpr=0.9275 | fpr=0.0149 | 8288.9 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.05268 | acc=0.9838 | tpr=0.9308 | fpr=0.0152 | 6766.0 samples/s | 26.4 steps/s
[Step= 200] | Loss=0.05285 | acc=0.9838 | tpr=0.9322 | fpr=0.0153 | 7351.3 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.05280 | acc=0.9836 | tpr=0.9301 | fpr=0.0154 | 7201.1 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.05316 | acc=0.9836 | tpr=0.9273 | fpr=0.0154 | 7750.4 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.05300 | acc=0.9836 | tpr=0.9274 | fpr=0.0154 | 7392.4 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.05379 | acc=0.9834 | tpr=0.9267 | fpr=0.0156 | 7577.2 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.05422 | acc=0.9832 | tpr=0.9231 | fpr=0.0157 | 7784.8 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.05422 | acc=0.9834 | tpr=0.9264 | fpr=0.0156 | 4551.5 samples/s | 17.8 steps/s
[Step= 550] | Loss=0.05375 | acc=0.9835 | tpr=0.9232 | fpr=0.0155 | 14112.4 samples/s | 55.1 steps/s
Avg test loss: 0.05367, Avg test acc: 0.98345, Avg tpr: 0.92353, Avg fpr: 0.01546, total FA: 2146

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.06101 | acc=0.9827 | tpr=0.8407 | fpr=0.0147 | 4192.1 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.06106 | acc=0.9832 | tpr=0.8529 | fpr=0.0144 | 7583.3 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.06387 | acc=0.9828 | tpr=0.8573 | fpr=0.0149 | 7556.5 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.06580 | acc=0.9827 | tpr=0.8634 | fpr=0.0152 | 7217.2 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.06444 | acc=0.9829 | tpr=0.8594 | fpr=0.0148 | 7337.3 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.06552 | acc=0.9827 | tpr=0.8553 | fpr=0.0150 | 7575.5 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.06507 | acc=0.9828 | tpr=0.8616 | fpr=0.0150 | 7401.1 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.06528 | acc=0.9827 | tpr=0.8621 | fpr=0.0151 | 7210.9 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.06655 | acc=0.9824 | tpr=0.8569 | fpr=0.0154 | 7156.5 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.06627 | acc=0.9826 | tpr=0.8590 | fpr=0.0152 | 4808.6 samples/s | 18.8 steps/s
[Step= 550] | Loss=0.06541 | acc=0.9828 | tpr=0.8599 | fpr=0.0150 | 14537.5 samples/s | 56.8 steps/s
Avg test loss: 0.06534, Avg test acc: 0.98278, Avg tpr: 0.86014, Avg fpr: 0.01499, total FA: 2082

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.05774 | acc=0.9845 | tpr=0.8496 | fpr=0.0131 | 4123.6 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.05905 | acc=0.9840 | tpr=0.8678 | fpr=0.0138 | 7289.2 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.06096 | acc=0.9838 | tpr=0.8689 | fpr=0.0141 | 7587.9 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.06126 | acc=0.9836 | tpr=0.8710 | fpr=0.0144 | 8261.5 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.06131 | acc=0.9838 | tpr=0.8725 | fpr=0.0141 | 7566.3 samples/s | 29.6 steps/s
[Step= 300] | Loss=0.06257 | acc=0.9833 | tpr=0.8640 | fpr=0.0145 | 7627.4 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.06266 | acc=0.9832 | tpr=0.8654 | fpr=0.0146 | 7761.2 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.06324 | acc=0.9831 | tpr=0.8627 | fpr=0.0148 | 7124.2 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.06464 | acc=0.9827 | tpr=0.8612 | fpr=0.0151 | 5505.9 samples/s | 21.5 steps/s
[Step= 500] | Loss=0.06379 | acc=0.9829 | tpr=0.8599 | fpr=0.0149 | 5723.6 samples/s | 22.4 steps/s
[Step= 550] | Loss=0.06341 | acc=0.9829 | tpr=0.8563 | fpr=0.0148 | 13071.0 samples/s | 51.1 steps/s
Avg test loss: 0.06339, Avg test acc: 0.98290, Avg tpr: 0.85658, Avg fpr: 0.01480, total FA: 2055

server round 9/10

clients selected: [0 1 2 3 4 5 6 7 8 9]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=4501 Epoch=21.9] | Loss=0.00061 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.865 | L2-Norm(final)=2.316 | 4212.1 samples/s | 65.8 steps/s
[Step=4550 Epoch=22.2] | Loss=0.00675 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.850 | L2-Norm(final)=2.314 | 4112.2 samples/s | 64.3 steps/s
[Step=4600 Epoch=22.4] | Loss=0.00597 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.841 | L2-Norm(final)=2.317 | 4175.7 samples/s | 65.2 steps/s
[Step=4650 Epoch=22.7] | Loss=0.00583 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.828 | L2-Norm(final)=2.320 | 4209.0 samples/s | 65.8 steps/s
[Step=4700 Epoch=22.9] | Loss=0.00585 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.815 | L2-Norm(final)=2.323 | 5667.1 samples/s | 88.5 steps/s
[Step=4750 Epoch=23.2] | Loss=0.00575 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.804 | L2-Norm(final)=2.327 | 1872.9 samples/s | 29.3 steps/s
[Step=4800 Epoch=23.4] | Loss=0.00579 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.791 | L2-Norm(final)=2.329 | 4432.9 samples/s | 69.3 steps/s
[Step=4850 Epoch=23.6] | Loss=0.00601 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.781 | L2-Norm(final)=2.332 | 4395.5 samples/s | 68.7 steps/s
[Step=4900 Epoch=23.9] | Loss=0.00585 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.775 | L2-Norm(final)=2.336 | 5466.0 samples/s | 85.4 steps/s
[Step=4950 Epoch=24.1] | Loss=0.00770 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.776 | L2-Norm(final)=2.336 | 2005.2 samples/s | 31.3 steps/s
[Step=5000 Epoch=24.4] | Loss=0.00852 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.788 | L2-Norm(final)=2.334 | 4446.3 samples/s | 69.5 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_0/client_state-step5000.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00100, len=1
[Step=4501 Epoch=22.0] | Loss=0.00050 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.263 | L2-Norm(final)=2.305 | 4250.0 samples/s | 66.4 steps/s
[Step=4550 Epoch=22.2] | Loss=0.00343 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.251 | L2-Norm(final)=2.307 | 4342.5 samples/s | 67.9 steps/s
[Step=4600 Epoch=22.4] | Loss=0.00372 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.237 | L2-Norm(final)=2.308 | 4599.8 samples/s | 71.9 steps/s
[Step=4650 Epoch=22.7] | Loss=0.00450 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.225 | L2-Norm(final)=2.310 | 4706.7 samples/s | 73.5 steps/s
[Step=4700 Epoch=22.9] | Loss=0.00510 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.212 | L2-Norm(final)=2.312 | 5949.5 samples/s | 93.0 steps/s
[Step=4750 Epoch=23.2] | Loss=0.00605 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.205 | L2-Norm(final)=2.313 | 1886.1 samples/s | 29.5 steps/s
[Step=4800 Epoch=23.4] | Loss=0.00828 | Reg=0.00332 | acc=0.9844 | L2-Norm=18.210 | L2-Norm(final)=2.313 | 4203.0 samples/s | 65.7 steps/s
[Step=4850 Epoch=23.7] | Loss=0.01208 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.236 | L2-Norm(final)=2.305 | 4258.1 samples/s | 66.5 steps/s
[Step=4900 Epoch=23.9] | Loss=0.01290 | Reg=0.00334 | acc=0.9844 | L2-Norm=18.269 | L2-Norm(final)=2.297 | 5344.9 samples/s | 83.5 steps/s
[Step=4950 Epoch=24.2] | Loss=0.01302 | Reg=0.00335 | acc=0.9844 | L2-Norm=18.298 | L2-Norm(final)=2.290 | 1882.5 samples/s | 29.4 steps/s
[Step=5000 Epoch=24.4] | Loss=0.01310 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.321 | L2-Norm(final)=2.283 | 4176.5 samples/s | 65.3 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_1/client_state-step5000.h5

Train client 2: client_asml1_2
Local layers training...
LR=0.00100, len=1
[Step=4501 Epoch=21.9] | Loss=0.00801 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.831 | L2-Norm(final)=2.258 | 4196.6 samples/s | 65.6 steps/s
[Step=4550 Epoch=22.2] | Loss=0.00626 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.822 | L2-Norm(final)=2.260 | 4208.5 samples/s | 65.8 steps/s
[Step=4600 Epoch=22.4] | Loss=0.00976 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.813 | L2-Norm(final)=2.262 | 4239.0 samples/s | 66.2 steps/s
[Step=4650 Epoch=22.7] | Loss=0.00884 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.804 | L2-Norm(final)=2.259 | 4257.4 samples/s | 66.5 steps/s
[Step=4700 Epoch=22.9] | Loss=0.00911 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.800 | L2-Norm(final)=2.259 | 5619.8 samples/s | 87.8 steps/s
[Step=4750 Epoch=23.1] | Loss=0.01045 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.805 | L2-Norm(final)=2.258 | 1914.5 samples/s | 29.9 steps/s
[Step=4800 Epoch=23.4] | Loss=0.01147 | Reg=0.00354 | acc=0.9688 | L2-Norm=18.818 | L2-Norm(final)=2.254 | 4468.1 samples/s | 69.8 steps/s
[Step=4850 Epoch=23.6] | Loss=0.01172 | Reg=0.00355 | acc=0.9844 | L2-Norm=18.833 | L2-Norm(final)=2.253 | 4369.6 samples/s | 68.3 steps/s
[Step=4900 Epoch=23.9] | Loss=0.01222 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.848 | L2-Norm(final)=2.252 | 5390.1 samples/s | 84.2 steps/s
[Step=4950 Epoch=24.1] | Loss=0.01206 | Reg=0.00356 | acc=1.0000 | L2-Norm=18.862 | L2-Norm(final)=2.251 | 1964.9 samples/s | 30.7 steps/s
[Step=5000 Epoch=24.4] | Loss=0.01192 | Reg=0.00356 | acc=1.0000 | L2-Norm=18.875 | L2-Norm(final)=2.252 | 4421.2 samples/s | 69.1 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_2/client_state-step5000.h5

Train client 3: client_asml1_3
Local layers training...
LR=0.00100, len=1
[Step=4501 Epoch=21.9] | Loss=0.00221 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.157 | L2-Norm(final)=2.310 | 4528.8 samples/s | 70.8 steps/s
[Step=4550 Epoch=22.2] | Loss=0.00750 | Reg=0.00330 | acc=0.9844 | L2-Norm=18.153 | L2-Norm(final)=2.312 | 4068.8 samples/s | 63.6 steps/s
[Step=4600 Epoch=22.4] | Loss=0.00704 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.143 | L2-Norm(final)=2.316 | 4285.9 samples/s | 67.0 steps/s
[Step=4650 Epoch=22.7] | Loss=0.00790 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.138 | L2-Norm(final)=2.320 | 4411.8 samples/s | 68.9 steps/s
[Step=4700 Epoch=22.9] | Loss=0.01057 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.144 | L2-Norm(final)=2.316 | 6059.2 samples/s | 94.7 steps/s
[Step=4750 Epoch=23.2] | Loss=0.01087 | Reg=0.00330 | acc=0.9688 | L2-Norm=18.156 | L2-Norm(final)=2.309 | 1945.1 samples/s | 30.4 steps/s
[Step=4800 Epoch=23.4] | Loss=0.01199 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.174 | L2-Norm(final)=2.305 | 4321.0 samples/s | 67.5 steps/s
[Step=4850 Epoch=23.7] | Loss=0.01324 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.200 | L2-Norm(final)=2.301 | 4543.4 samples/s | 71.0 steps/s
[Step=4900 Epoch=23.9] | Loss=0.01340 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.225 | L2-Norm(final)=2.298 | 5329.1 samples/s | 83.3 steps/s
[Step=4950 Epoch=24.1] | Loss=0.01355 | Reg=0.00333 | acc=0.9688 | L2-Norm=18.248 | L2-Norm(final)=2.296 | 1900.0 samples/s | 29.7 steps/s
[Step=5000 Epoch=24.4] | Loss=0.01325 | Reg=0.00334 | acc=0.9688 | L2-Norm=18.268 | L2-Norm(final)=2.295 | 4149.2 samples/s | 64.8 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_3/client_state-step5000.h5

Train client 4: client_asml1_4
Local layers training...
LR=0.00100, len=1
[Step=4501 Epoch=22.1] | Loss=0.02274 | Reg=0.00341 | acc=0.9844 | L2-Norm=18.454 | L2-Norm(final)=2.336 | 4408.4 samples/s | 68.9 steps/s
[Step=4550 Epoch=22.3] | Loss=0.01544 | Reg=0.00341 | acc=0.9844 | L2-Norm=18.466 | L2-Norm(final)=2.333 | 4131.0 samples/s | 64.5 steps/s
[Step=4600 Epoch=22.6] | Loss=0.01414 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.476 | L2-Norm(final)=2.334 | 4701.2 samples/s | 73.5 steps/s
[Step=4650 Epoch=22.8] | Loss=0.01387 | Reg=0.00342 | acc=0.9844 | L2-Norm=18.493 | L2-Norm(final)=2.336 | 4333.8 samples/s | 67.7 steps/s
[Step=4700 Epoch=23.0] | Loss=0.01592 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.512 | L2-Norm(final)=2.334 | 5808.4 samples/s | 90.8 steps/s
[Step=4750 Epoch=23.3] | Loss=0.01551 | Reg=0.00343 | acc=0.9844 | L2-Norm=18.531 | L2-Norm(final)=2.328 | 1833.4 samples/s | 28.6 steps/s
[Step=4800 Epoch=23.5] | Loss=0.01526 | Reg=0.00344 | acc=0.9844 | L2-Norm=18.549 | L2-Norm(final)=2.324 | 4510.2 samples/s | 70.5 steps/s
[Step=4850 Epoch=23.8] | Loss=0.01529 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.563 | L2-Norm(final)=2.320 | 4572.5 samples/s | 71.4 steps/s
[Step=4900 Epoch=24.0] | Loss=0.01493 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.574 | L2-Norm(final)=2.316 | 5764.8 samples/s | 90.1 steps/s
[Step=4950 Epoch=24.3] | Loss=0.01402 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.581 | L2-Norm(final)=2.314 | 1918.1 samples/s | 30.0 steps/s
[Step=5000 Epoch=24.5] | Loss=0.01336 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.585 | L2-Norm(final)=2.314 | 4620.2 samples/s | 72.2 steps/s
Client model saved at models/model-a5i5_sr1.0/client_asml1_4/client_state-step5000.h5

Train client 5: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=4501 Epoch=42.7] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.746 | L2-Norm(final)=3.901 | 4065.9 samples/s | 63.5 steps/s
[Step=4550 Epoch=43.1] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.711 | L2-Norm(final)=3.924 | 4197.8 samples/s | 65.6 steps/s
[Step=4600 Epoch=43.6] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.669 | L2-Norm(final)=3.942 | 5780.1 samples/s | 90.3 steps/s
[Step=4650 Epoch=44.1] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.630 | L2-Norm(final)=3.962 | 1763.9 samples/s | 27.6 steps/s
[Step=4700 Epoch=44.5] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.589 | L2-Norm(final)=3.979 | 5026.7 samples/s | 78.5 steps/s
[Step=4750 Epoch=45.0] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.548 | L2-Norm(final)=3.997 | 1868.7 samples/s | 29.2 steps/s
[Step=4800 Epoch=45.5] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.507 | L2-Norm(final)=4.015 | 4814.2 samples/s | 75.2 steps/s
[Step=4850 Epoch=46.0] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.467 | L2-Norm(final)=4.034 | 1947.6 samples/s | 30.4 steps/s
[Step=4900 Epoch=46.4] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.426 | L2-Norm(final)=4.052 | 4481.1 samples/s | 70.0 steps/s
[Step=4950 Epoch=46.9] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.385 | L2-Norm(final)=4.070 | 1973.2 samples/s | 30.8 steps/s
[Step=5000 Epoch=47.4] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.345 | L2-Norm(final)=4.089 | 4388.3 samples/s | 68.6 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_0/client_state-step5000.h5

Train client 6: client_iccad2012_1
Local layers training...
LR=0.00100, len=1
[Step=4501 Epoch=42.8] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.220 | L2-Norm(final)=3.881 | 4227.1 samples/s | 66.0 steps/s
[Step=4550 Epoch=43.3] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.178 | L2-Norm(final)=3.892 | 3923.8 samples/s | 61.3 steps/s
[Step=4600 Epoch=43.8] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.137 | L2-Norm(final)=3.907 | 5800.2 samples/s | 90.6 steps/s
[Step=4650 Epoch=44.2] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.097 | L2-Norm(final)=3.923 | 1851.0 samples/s | 28.9 steps/s
[Step=4700 Epoch=44.7] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.056 | L2-Norm(final)=3.940 | 5446.5 samples/s | 85.1 steps/s
[Step=4750 Epoch=45.2] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.016 | L2-Norm(final)=3.957 | 1912.4 samples/s | 29.9 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.977 | L2-Norm(final)=3.976 | 4836.8 samples/s | 75.6 steps/s
[Step=4850 Epoch=46.1] | Loss=0.00000 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.939 | L2-Norm(final)=3.996 | 1971.0 samples/s | 30.8 steps/s
[Step=4900 Epoch=46.6] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=4.016 | 4598.7 samples/s | 71.9 steps/s
[Step=4950 Epoch=47.1] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.862 | L2-Norm(final)=4.034 | 2009.5 samples/s | 31.4 steps/s
[Step=5000 Epoch=47.6] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.823 | L2-Norm(final)=4.052 | 4165.1 samples/s | 65.1 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_1/client_state-step5000.h5

Train client 7: client_iccad2012_2
Local layers training...
LR=0.00100, len=1
[Step=4501 Epoch=43.0] | Loss=0.00000 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.906 | L2-Norm(final)=2.811 | 4107.2 samples/s | 64.2 steps/s
[Step=4550 Epoch=43.4] | Loss=0.00001 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.887 | L2-Norm(final)=2.820 | 3993.1 samples/s | 62.4 steps/s
[Step=4600 Epoch=43.9] | Loss=0.00001 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.869 | L2-Norm(final)=2.830 | 5827.4 samples/s | 91.1 steps/s
[Step=4650 Epoch=44.4] | Loss=0.00001 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=2.840 | 1836.4 samples/s | 28.7 steps/s
[Step=4700 Epoch=44.9] | Loss=0.00001 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.831 | L2-Norm(final)=2.848 | 5430.7 samples/s | 84.9 steps/s
[Step=4750 Epoch=45.4] | Loss=0.00001 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.812 | L2-Norm(final)=2.857 | 1832.4 samples/s | 28.6 steps/s
[Step=4800 Epoch=45.8] | Loss=0.00001 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.793 | L2-Norm(final)=2.867 | 4986.7 samples/s | 77.9 steps/s
[Step=4850 Epoch=46.3] | Loss=0.00001 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.774 | L2-Norm(final)=2.876 | 1259.2 samples/s | 19.7 steps/s
[Step=4900 Epoch=46.8] | Loss=0.00001 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.755 | L2-Norm(final)=2.885 | 4601.7 samples/s | 71.9 steps/s
[Step=4950 Epoch=47.3] | Loss=0.00001 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.736 | L2-Norm(final)=2.895 | 1912.1 samples/s | 29.9 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00001 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.717 | L2-Norm(final)=2.905 | 4611.9 samples/s | 72.1 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_2/client_state-step5000.h5

Train client 8: client_iccad2012_3
Local layers training...
LR=0.00100, len=1
[Step=4501 Epoch=42.4] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.609 | L2-Norm(final)=3.813 | 4141.7 samples/s | 64.7 steps/s
[Step=4550 Epoch=42.9] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.571 | L2-Norm(final)=3.834 | 3997.3 samples/s | 62.5 steps/s
[Step=4600 Epoch=43.3] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.532 | L2-Norm(final)=3.854 | 5848.4 samples/s | 91.4 steps/s
[Step=4650 Epoch=43.8] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.495 | L2-Norm(final)=3.875 | 1824.6 samples/s | 28.5 steps/s
[Step=4700 Epoch=44.3] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.457 | L2-Norm(final)=3.895 | 5470.2 samples/s | 85.5 steps/s
[Step=4750 Epoch=44.8] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.418 | L2-Norm(final)=3.913 | 1978.7 samples/s | 30.9 steps/s
[Step=4800 Epoch=45.2] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.379 | L2-Norm(final)=3.931 | 4536.5 samples/s | 70.9 steps/s
[Step=4850 Epoch=45.7] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.340 | L2-Norm(final)=3.949 | 1986.8 samples/s | 31.0 steps/s
[Step=4900 Epoch=46.2] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.301 | L2-Norm(final)=3.968 | 4453.2 samples/s | 69.6 steps/s
[Step=4950 Epoch=46.6] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.262 | L2-Norm(final)=3.986 | 2121.5 samples/s | 33.1 steps/s
[Step=5000 Epoch=47.1] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.223 | L2-Norm(final)=4.005 | 4273.9 samples/s | 66.8 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_3/client_state-step5000.h5

Train client 9: client_iccad2012_4
Local layers training...
LR=0.00100, len=1
[Step=4501 Epoch=42.9] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.504 | L2-Norm(final)=3.873 | 4360.5 samples/s | 68.1 steps/s
[Step=4550 Epoch=43.4] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.466 | L2-Norm(final)=3.893 | 3623.9 samples/s | 56.6 steps/s
[Step=4600 Epoch=43.8] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.428 | L2-Norm(final)=3.913 | 5515.3 samples/s | 86.2 steps/s
[Step=4650 Epoch=44.3] | Loss=0.12115 | Reg=0.00117 | acc=0.9531 | L2-Norm=10.803 | L2-Norm(final)=3.872 | 1843.0 samples/s | 28.8 steps/s
[Step=4700 Epoch=44.8] | Loss=0.10729 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.262 | L2-Norm(final)=3.836 | 5373.3 samples/s | 84.0 steps/s
[Step=4750 Epoch=45.3] | Loss=0.08937 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.555 | L2-Norm(final)=3.819 | 1858.3 samples/s | 29.0 steps/s
[Step=4800 Epoch=45.7] | Loss=0.07546 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.757 | L2-Norm(final)=3.811 | 5185.4 samples/s | 81.0 steps/s
[Step=4850 Epoch=46.2] | Loss=0.06496 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.902 | L2-Norm(final)=3.808 | 1960.8 samples/s | 30.6 steps/s
[Step=4900 Epoch=46.7] | Loss=0.05692 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.009 | L2-Norm(final)=3.806 | 4594.2 samples/s | 71.8 steps/s
[Step=4950 Epoch=47.2] | Loss=0.05065 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.090 | L2-Norm(final)=3.805 | 1917.7 samples/s | 30.0 steps/s
[Step=5000 Epoch=47.7] | Loss=0.04561 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=3.805 | 4658.6 samples/s | 72.8 steps/s
Client model saved at models/model-a5i5_sr1.0/client_iccad2012_4/client_state-step5000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.22300 | acc=0.9070 | tpr=0.8974 | fpr=0.0723 | 4116.3 samples/s | 16.1 steps/s
Avg test loss: 0.23200, Avg test acc: 0.90432, Avg tpr: 0.89660, Avg fpr: 0.07871, total FA: 614

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.21802 | acc=0.9270 | tpr=0.9548 | fpr=0.1335 | 4005.1 samples/s | 15.6 steps/s
Avg test loss: 0.21209, Avg test acc: 0.92884, Avg tpr: 0.95611, Avg fpr: 0.13114, total FA: 1023

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.22350 | acc=0.9274 | tpr=0.9549 | fpr=0.1323 | 3972.5 samples/s | 15.5 steps/s
Avg test loss: 0.22025, Avg test acc: 0.92752, Avg tpr: 0.95465, Avg fpr: 0.13216, total FA: 1031

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.20218 | acc=0.9280 | tpr=0.9546 | fpr=0.1298 | 4108.7 samples/s | 16.0 steps/s
Avg test loss: 0.21098, Avg test acc: 0.92539, Avg tpr: 0.95419, Avg fpr: 0.13793, total FA: 1076

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.20378 | acc=0.9306 | tpr=0.9538 | fpr=0.1197 | 3952.3 samples/s | 15.4 steps/s
Avg test loss: 0.20955, Avg test acc: 0.92920, Avg tpr: 0.95320, Avg fpr: 0.12357, total FA: 964

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.29453 | acc=0.3159 | tpr=0.0060 | fpr=0.0114 | 4147.5 samples/s | 16.2 steps/s
Avg test loss: 6.32496, Avg test acc: 0.31329, Avg tpr: 0.00641, Avg fpr: 0.01179, total FA: 92

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.01593 | acc=0.3108 | tpr=0.0151 | fpr=0.0471 | 3974.4 samples/s | 15.5 steps/s
Avg test loss: 5.04001, Avg test acc: 0.30912, Avg tpr: 0.01574, Avg fpr: 0.04564, total FA: 356

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=6.05256 | acc=0.3127 | tpr=0.0145 | fpr=0.0399 | 4084.1 samples/s | 16.0 steps/s
Avg test loss: 6.07091, Avg test acc: 0.31036, Avg tpr: 0.01492, Avg fpr: 0.03987, total FA: 311

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.88898 | acc=0.3121 | tpr=0.0218 | fpr=0.0575 | 4081.6 samples/s | 15.9 steps/s
Avg test loss: 4.91068, Avg test acc: 0.31156, Avg tpr: 0.02349, Avg fpr: 0.05486, total FA: 428

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=3.05374 | acc=0.3116 | tpr=0.0362 | fpr=0.0902 | 4084.5 samples/s | 16.0 steps/s
Avg test loss: 3.05010, Avg test acc: 0.31176, Avg tpr: 0.03509, Avg fpr: 0.07973, total FA: 622

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.16653 | acc=0.2089 | tpr=0.7345 | fpr=0.8005 | 4027.9 samples/s | 15.7 steps/s
[Step= 100] | Loss=4.16195 | acc=0.2109 | tpr=0.7186 | fpr=0.7986 | 7308.2 samples/s | 28.5 steps/s
[Step= 150] | Loss=4.18032 | acc=0.2092 | tpr=0.7089 | fpr=0.8000 | 7241.1 samples/s | 28.3 steps/s
[Step= 200] | Loss=4.16699 | acc=0.2103 | tpr=0.7279 | fpr=0.7991 | 7368.2 samples/s | 28.8 steps/s
[Step= 250] | Loss=4.17819 | acc=0.2100 | tpr=0.7266 | fpr=0.7994 | 7579.2 samples/s | 29.6 steps/s
[Step= 300] | Loss=4.17962 | acc=0.2098 | tpr=0.7331 | fpr=0.7997 | 7520.0 samples/s | 29.4 steps/s
[Step= 350] | Loss=4.17915 | acc=0.2103 | tpr=0.7383 | fpr=0.7993 | 7742.0 samples/s | 30.2 steps/s
[Step= 400] | Loss=4.18235 | acc=0.2104 | tpr=0.7407 | fpr=0.7993 | 7285.6 samples/s | 28.5 steps/s
[Step= 450] | Loss=4.18167 | acc=0.2103 | tpr=0.7400 | fpr=0.7993 | 7501.7 samples/s | 29.3 steps/s
[Step= 500] | Loss=4.18469 | acc=0.2102 | tpr=0.7405 | fpr=0.7993 | 7457.7 samples/s | 29.1 steps/s
[Step= 550] | Loss=4.18191 | acc=0.2101 | tpr=0.7425 | fpr=0.7995 | 14317.2 samples/s | 55.9 steps/s
Avg test loss: 4.18202, Avg test acc: 0.20996, Avg tpr: 0.74287, Avg fpr: 0.79973, total FA: 111041

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.17294 | acc=0.1095 | tpr=0.9071 | fpr=0.9048 | 4242.3 samples/s | 16.6 steps/s
[Step= 100] | Loss=5.13723 | acc=0.1120 | tpr=0.9126 | fpr=0.9030 | 7253.6 samples/s | 28.3 steps/s
[Step= 150] | Loss=5.15729 | acc=0.1111 | tpr=0.9078 | fpr=0.9036 | 7868.1 samples/s | 30.7 steps/s
[Step= 200] | Loss=5.15944 | acc=0.1110 | tpr=0.9049 | fpr=0.9035 | 8118.2 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.16653 | acc=0.1110 | tpr=0.9031 | fpr=0.9034 | 7546.4 samples/s | 29.5 steps/s
[Step= 300] | Loss=5.16442 | acc=0.1106 | tpr=0.9018 | fpr=0.9038 | 7713.5 samples/s | 30.1 steps/s
[Step= 350] | Loss=5.16970 | acc=0.1101 | tpr=0.9042 | fpr=0.9043 | 7103.8 samples/s | 27.7 steps/s
[Step= 400] | Loss=5.17256 | acc=0.1103 | tpr=0.9054 | fpr=0.9042 | 7253.0 samples/s | 28.3 steps/s
[Step= 450] | Loss=5.17417 | acc=0.1097 | tpr=0.9056 | fpr=0.9048 | 7459.1 samples/s | 29.1 steps/s
[Step= 500] | Loss=5.17550 | acc=0.1096 | tpr=0.9062 | fpr=0.9048 | 7611.7 samples/s | 29.7 steps/s
[Step= 550] | Loss=5.17292 | acc=0.1100 | tpr=0.9073 | fpr=0.9045 | 14118.9 samples/s | 55.2 steps/s
Avg test loss: 5.17444, Avg test acc: 0.10989, Avg tpr: 0.90689, Avg fpr: 0.90459, total FA: 125601

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.59494 | acc=0.1124 | tpr=0.8628 | fpr=0.9011 | 3964.5 samples/s | 15.5 steps/s
[Step= 100] | Loss=5.56746 | acc=0.1138 | tpr=0.8635 | fpr=0.9002 | 7742.2 samples/s | 30.2 steps/s
[Step= 150] | Loss=5.57612 | acc=0.1131 | tpr=0.8718 | fpr=0.9009 | 7624.2 samples/s | 29.8 steps/s
[Step= 200] | Loss=5.56412 | acc=0.1138 | tpr=0.8754 | fpr=0.9001 | 7183.7 samples/s | 28.1 steps/s
[Step= 250] | Loss=5.57225 | acc=0.1135 | tpr=0.8725 | fpr=0.9003 | 7371.1 samples/s | 28.8 steps/s
[Step= 300] | Loss=5.58014 | acc=0.1128 | tpr=0.8705 | fpr=0.9010 | 7910.9 samples/s | 30.9 steps/s
[Step= 350] | Loss=5.57567 | acc=0.1126 | tpr=0.8698 | fpr=0.9011 | 7246.6 samples/s | 28.3 steps/s
[Step= 400] | Loss=5.57755 | acc=0.1125 | tpr=0.8704 | fpr=0.9012 | 7642.5 samples/s | 29.9 steps/s
[Step= 450] | Loss=5.57817 | acc=0.1123 | tpr=0.8749 | fpr=0.9016 | 7098.8 samples/s | 27.7 steps/s
[Step= 500] | Loss=5.58156 | acc=0.1119 | tpr=0.8758 | fpr=0.9019 | 7281.1 samples/s | 28.4 steps/s
[Step= 550] | Loss=5.58021 | acc=0.1120 | tpr=0.8758 | fpr=0.9019 | 14544.5 samples/s | 56.8 steps/s
Avg test loss: 5.58116, Avg test acc: 0.11192, Avg tpr: 0.87559, Avg fpr: 0.90196, total FA: 125235

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.79850 | acc=0.1670 | tpr=0.7345 | fpr=0.8432 | 3900.8 samples/s | 15.2 steps/s
[Step= 100] | Loss=4.78677 | acc=0.1683 | tpr=0.7313 | fpr=0.8422 | 7724.5 samples/s | 30.2 steps/s
[Step= 150] | Loss=4.78109 | acc=0.1685 | tpr=0.7205 | fpr=0.8417 | 7536.5 samples/s | 29.4 steps/s
[Step= 200] | Loss=4.78069 | acc=0.1693 | tpr=0.7257 | fpr=0.8409 | 7500.7 samples/s | 29.3 steps/s
[Step= 250] | Loss=4.79215 | acc=0.1699 | tpr=0.7205 | fpr=0.8401 | 7409.9 samples/s | 28.9 steps/s
[Step= 300] | Loss=4.79521 | acc=0.1687 | tpr=0.7193 | fpr=0.8414 | 7203.3 samples/s | 28.1 steps/s
[Step= 350] | Loss=4.78910 | acc=0.1678 | tpr=0.7182 | fpr=0.8421 | 7546.9 samples/s | 29.5 steps/s
[Step= 400] | Loss=4.78748 | acc=0.1684 | tpr=0.7276 | fpr=0.8418 | 7394.1 samples/s | 28.9 steps/s
[Step= 450] | Loss=4.78509 | acc=0.1681 | tpr=0.7244 | fpr=0.8420 | 7558.7 samples/s | 29.5 steps/s
[Step= 500] | Loss=4.78564 | acc=0.1681 | tpr=0.7273 | fpr=0.8420 | 7677.4 samples/s | 30.0 steps/s
[Step= 550] | Loss=4.78685 | acc=0.1681 | tpr=0.7310 | fpr=0.8421 | 14235.2 samples/s | 55.6 steps/s
Avg test loss: 4.78839, Avg test acc: 0.16800, Avg tpr: 0.73098, Avg fpr: 0.84223, total FA: 116942

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=6.09079 | acc=0.1207 | tpr=0.8142 | fpr=0.8918 | 4009.2 samples/s | 15.7 steps/s
[Step= 100] | Loss=6.06475 | acc=0.1196 | tpr=0.8145 | fpr=0.8934 | 7737.3 samples/s | 30.2 steps/s
[Step= 150] | Loss=6.05396 | acc=0.1185 | tpr=0.7997 | fpr=0.8940 | 7083.7 samples/s | 27.7 steps/s
[Step= 200] | Loss=6.04263 | acc=0.1194 | tpr=0.8033 | fpr=0.8930 | 7469.8 samples/s | 29.2 steps/s
[Step= 250] | Loss=6.04902 | acc=0.1190 | tpr=0.8079 | fpr=0.8935 | 7550.0 samples/s | 29.5 steps/s
[Step= 300] | Loss=6.05219 | acc=0.1185 | tpr=0.8080 | fpr=0.8941 | 8237.4 samples/s | 32.2 steps/s
[Step= 350] | Loss=6.04984 | acc=0.1184 | tpr=0.8109 | fpr=0.8942 | 7180.1 samples/s | 28.0 steps/s
[Step= 400] | Loss=6.04766 | acc=0.1184 | tpr=0.8184 | fpr=0.8943 | 7430.7 samples/s | 29.0 steps/s
[Step= 450] | Loss=6.05316 | acc=0.1178 | tpr=0.8184 | fpr=0.8949 | 7526.9 samples/s | 29.4 steps/s
[Step= 500] | Loss=6.05091 | acc=0.1176 | tpr=0.8189 | fpr=0.8951 | 7759.5 samples/s | 30.3 steps/s
[Step= 550] | Loss=6.05274 | acc=0.1172 | tpr=0.8177 | fpr=0.8956 | 13303.6 samples/s | 52.0 steps/s
Avg test loss: 6.05310, Avg test acc: 0.11708, Avg tpr: 0.81775, Avg fpr: 0.89566, total FA: 124360

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.06294 | acc=0.9804 | tpr=0.8584 | fpr=0.0174 | 3883.7 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.06369 | acc=0.9806 | tpr=0.8763 | fpr=0.0175 | 7303.8 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.06599 | acc=0.9802 | tpr=0.8890 | fpr=0.0181 | 7834.5 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.06739 | acc=0.9801 | tpr=0.8984 | fpr=0.0184 | 7604.0 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.06734 | acc=0.9801 | tpr=0.8996 | fpr=0.0184 | 8162.4 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.06797 | acc=0.9800 | tpr=0.8967 | fpr=0.0185 | 8243.6 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.06790 | acc=0.9801 | tpr=0.8979 | fpr=0.0184 | 6991.5 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.06851 | acc=0.9798 | tpr=0.8972 | fpr=0.0187 | 8180.4 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.07002 | acc=0.9797 | tpr=0.8958 | fpr=0.0188 | 7344.7 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.06957 | acc=0.9798 | tpr=0.8947 | fpr=0.0187 | 7592.7 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.06888 | acc=0.9801 | tpr=0.8942 | fpr=0.0184 | 14416.1 samples/s | 56.3 steps/s
Avg test loss: 0.06873, Avg test acc: 0.98006, Avg tpr: 0.89382, Avg fpr: 0.01837, total FA: 2551

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.04548 | acc=0.9860 | tpr=0.8496 | fpr=0.0115 | 4020.0 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.04498 | acc=0.9853 | tpr=0.8550 | fpr=0.0123 | 7415.8 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.04610 | acc=0.9851 | tpr=0.8588 | fpr=0.0125 | 7295.1 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.04750 | acc=0.9848 | tpr=0.8590 | fpr=0.0129 | 7910.1 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.04724 | acc=0.9850 | tpr=0.8672 | fpr=0.0128 | 8083.9 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.04746 | acc=0.9846 | tpr=0.8596 | fpr=0.0131 | 8021.5 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.04740 | acc=0.9847 | tpr=0.8629 | fpr=0.0131 | 7861.3 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.04798 | acc=0.9846 | tpr=0.8600 | fpr=0.0131 | 6859.9 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.04825 | acc=0.9845 | tpr=0.8578 | fpr=0.0132 | 7173.0 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.04798 | acc=0.9846 | tpr=0.8604 | fpr=0.0132 | 7052.9 samples/s | 27.6 steps/s
[Step= 550] | Loss=0.04776 | acc=0.9847 | tpr=0.8583 | fpr=0.0130 | 13139.7 samples/s | 51.3 steps/s
Avg test loss: 0.04772, Avg test acc: 0.98469, Avg tpr: 0.85895, Avg fpr: 0.01302, total FA: 1808

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.06021 | acc=0.9831 | tpr=0.9159 | fpr=0.0157 | 3852.1 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.05990 | acc=0.9825 | tpr=0.9360 | fpr=0.0166 | 7240.1 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.06046 | acc=0.9824 | tpr=0.9424 | fpr=0.0168 | 7345.2 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.06070 | acc=0.9821 | tpr=0.9432 | fpr=0.0171 | 7752.0 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.06059 | acc=0.9821 | tpr=0.9415 | fpr=0.0172 | 7567.2 samples/s | 29.6 steps/s
[Step= 300] | Loss=0.06098 | acc=0.9820 | tpr=0.9375 | fpr=0.0172 | 7469.0 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.06084 | acc=0.9819 | tpr=0.9361 | fpr=0.0173 | 7405.2 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.06172 | acc=0.9817 | tpr=0.9360 | fpr=0.0175 | 7566.3 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.06220 | acc=0.9814 | tpr=0.9318 | fpr=0.0177 | 7661.3 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.06218 | acc=0.9817 | tpr=0.9344 | fpr=0.0175 | 7315.7 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.06160 | acc=0.9818 | tpr=0.9312 | fpr=0.0173 | 14547.5 samples/s | 56.8 steps/s
Avg test loss: 0.06151, Avg test acc: 0.98179, Avg tpr: 0.93146, Avg fpr: 0.01729, total FA: 2401

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.07326 | acc=0.9806 | tpr=0.8761 | fpr=0.0175 | 4006.4 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.07355 | acc=0.9807 | tpr=0.8934 | fpr=0.0176 | 7423.9 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.07699 | acc=0.9801 | tpr=0.8963 | fpr=0.0183 | 7602.7 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.07958 | acc=0.9800 | tpr=0.9038 | fpr=0.0186 | 7764.7 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.07775 | acc=0.9804 | tpr=0.9022 | fpr=0.0182 | 7233.3 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.07892 | acc=0.9802 | tpr=0.8982 | fpr=0.0183 | 7386.6 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.07864 | acc=0.9802 | tpr=0.9017 | fpr=0.0183 | 7602.8 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.07889 | acc=0.9802 | tpr=0.9010 | fpr=0.0184 | 7100.7 samples/s | 27.7 steps/s
[Step= 450] | Loss=0.08031 | acc=0.9797 | tpr=0.8934 | fpr=0.0187 | 7814.4 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.07997 | acc=0.9799 | tpr=0.8943 | fpr=0.0186 | 7855.7 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.07902 | acc=0.9799 | tpr=0.8945 | fpr=0.0185 | 13782.9 samples/s | 53.8 steps/s
Avg test loss: 0.07893, Avg test acc: 0.97995, Avg tpr: 0.89461, Avg fpr: 0.01850, total FA: 2569

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.06032 | acc=0.9805 | tpr=0.8850 | fpr=0.0178 | 3955.3 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.05865 | acc=0.9804 | tpr=0.9041 | fpr=0.0182 | 7364.9 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.06073 | acc=0.9799 | tpr=0.9135 | fpr=0.0189 | 7335.8 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.06162 | acc=0.9798 | tpr=0.9191 | fpr=0.0191 | 7999.7 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.06090 | acc=0.9800 | tpr=0.9118 | fpr=0.0187 | 7703.0 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.06203 | acc=0.9800 | tpr=0.9025 | fpr=0.0186 | 7776.3 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.06277 | acc=0.9798 | tpr=0.9004 | fpr=0.0187 | 7717.0 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.06353 | acc=0.9795 | tpr=0.8982 | fpr=0.0190 | 7685.9 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.06478 | acc=0.9793 | tpr=0.8948 | fpr=0.0192 | 7846.9 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.06468 | acc=0.9793 | tpr=0.8960 | fpr=0.0192 | 8197.9 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.06399 | acc=0.9795 | tpr=0.8953 | fpr=0.0189 | 13065.8 samples/s | 51.0 steps/s
Avg test loss: 0.06395, Avg test acc: 0.97953, Avg tpr: 0.89501, Avg fpr: 0.01893, total FA: 2629
