#clients of iccad2012: 2
#clients of asml1: 2
select ratio: 1.0
Total num clients: 4
client model path: ['models/model-no_server-a2i2/client_asml1_0', 'models/model-no_server-a2i2/client_asml1_1', 'models/model-no_server-a2i2/client_iccad2012_0', 'models/model-no_server-a2i2/client_iccad2012_1']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32814, 144, 32)
Using transform option: train
#pos = 17102, #neg = 15712
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32737, 144, 32)
Using transform option: train
#pos = 17179, #neg = 15558
loading data into the main memory...
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16703, 144, 32)
Using transform option: train
#pos = 8134, #neg = 8569
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16626, 144, 32)
Using transform option: train
#pos = 8099, #neg = 8527
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.36117 | Reg=0.00355 | acc=0.5000 | L2-Norm=18.850 | L2-Norm(final)=1.908 | 2812.1 samples/s | 43.9 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.30456 | Reg=0.00344 | acc=0.8438 | L2-Norm=18.534 | L2-Norm(final)=1.894 | 4478.4 samples/s | 70.0 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.26077 | Reg=0.00340 | acc=0.8906 | L2-Norm=18.433 | L2-Norm(final)=1.907 | 4528.0 samples/s | 70.8 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.23106 | Reg=0.00337 | acc=0.7812 | L2-Norm=18.365 | L2-Norm(final)=1.920 | 4588.6 samples/s | 71.7 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.21271 | Reg=0.00335 | acc=0.8281 | L2-Norm=18.314 | L2-Norm(final)=1.930 | 4664.2 samples/s | 72.9 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.19564 | Reg=0.00334 | acc=0.9219 | L2-Norm=18.277 | L2-Norm(final)=1.941 | 4623.9 samples/s | 72.2 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.18403 | Reg=0.00333 | acc=0.9531 | L2-Norm=18.247 | L2-Norm(final)=1.949 | 4622.4 samples/s | 72.2 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.17344 | Reg=0.00332 | acc=0.8906 | L2-Norm=18.222 | L2-Norm(final)=1.957 | 4482.1 samples/s | 70.0 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.16572 | Reg=0.00331 | acc=0.9219 | L2-Norm=18.200 | L2-Norm(final)=1.966 | 4505.3 samples/s | 70.4 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.15840 | Reg=0.00331 | acc=0.9219 | L2-Norm=18.182 | L2-Norm(final)=1.973 | 4442.3 samples/s | 69.4 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.15225 | Reg=0.00330 | acc=0.8906 | L2-Norm=18.166 | L2-Norm(final)=1.980 | 5355.4 samples/s | 83.7 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.14526 | Reg=0.00330 | acc=0.9531 | L2-Norm=18.152 | L2-Norm(final)=1.987 | 1812.0 samples/s | 28.3 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.13991 | Reg=0.00329 | acc=0.9531 | L2-Norm=18.141 | L2-Norm(final)=1.994 | 4329.9 samples/s | 67.7 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.13515 | Reg=0.00329 | acc=0.9688 | L2-Norm=18.132 | L2-Norm(final)=2.001 | 4389.7 samples/s | 68.6 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.13094 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.125 | L2-Norm(final)=2.008 | 4496.2 samples/s | 70.3 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.12716 | Reg=0.00328 | acc=0.8906 | L2-Norm=18.118 | L2-Norm(final)=2.014 | 4509.5 samples/s | 70.5 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.12395 | Reg=0.00328 | acc=0.9062 | L2-Norm=18.112 | L2-Norm(final)=2.019 | 4566.0 samples/s | 71.3 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step800.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.37283 | Reg=0.00355 | acc=0.5156 | L2-Norm=18.850 | L2-Norm(final)=1.907 | 4041.6 samples/s | 63.1 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.28982 | Reg=0.00341 | acc=0.7969 | L2-Norm=18.466 | L2-Norm(final)=1.905 | 4107.3 samples/s | 64.2 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.24974 | Reg=0.00336 | acc=0.8281 | L2-Norm=18.332 | L2-Norm(final)=1.917 | 4485.8 samples/s | 70.1 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.22116 | Reg=0.00333 | acc=0.8281 | L2-Norm=18.253 | L2-Norm(final)=1.927 | 4586.9 samples/s | 71.7 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.20226 | Reg=0.00331 | acc=0.9219 | L2-Norm=18.201 | L2-Norm(final)=1.936 | 4419.2 samples/s | 69.1 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.19011 | Reg=0.00330 | acc=0.8906 | L2-Norm=18.162 | L2-Norm(final)=1.943 | 4500.9 samples/s | 70.3 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.18073 | Reg=0.00329 | acc=0.8906 | L2-Norm=18.129 | L2-Norm(final)=1.948 | 4487.1 samples/s | 70.1 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.17162 | Reg=0.00328 | acc=0.9062 | L2-Norm=18.103 | L2-Norm(final)=1.953 | 4457.3 samples/s | 69.6 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.16298 | Reg=0.00327 | acc=0.9219 | L2-Norm=18.083 | L2-Norm(final)=1.959 | 4535.0 samples/s | 70.9 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.15664 | Reg=0.00326 | acc=0.9062 | L2-Norm=18.068 | L2-Norm(final)=1.964 | 4488.4 samples/s | 70.1 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.15156 | Reg=0.00326 | acc=0.8906 | L2-Norm=18.055 | L2-Norm(final)=1.968 | 5468.4 samples/s | 85.4 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.14490 | Reg=0.00326 | acc=0.8750 | L2-Norm=18.044 | L2-Norm(final)=1.973 | 1859.5 samples/s | 29.1 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.13923 | Reg=0.00325 | acc=0.9688 | L2-Norm=18.035 | L2-Norm(final)=1.979 | 4367.3 samples/s | 68.2 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.13466 | Reg=0.00325 | acc=0.9688 | L2-Norm=18.027 | L2-Norm(final)=1.984 | 4590.7 samples/s | 71.7 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.13082 | Reg=0.00325 | acc=0.9219 | L2-Norm=18.021 | L2-Norm(final)=1.989 | 4423.8 samples/s | 69.1 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.12719 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.015 | L2-Norm(final)=1.994 | 4303.6 samples/s | 67.2 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.12347 | Reg=0.00324 | acc=0.8750 | L2-Norm=18.010 | L2-Norm(final)=1.999 | 4437.5 samples/s | 69.3 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step800.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.33805 | Reg=0.00355 | acc=0.4375 | L2-Norm=18.850 | L2-Norm(final)=1.910 | 4214.0 samples/s | 65.8 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.13963 | Reg=0.00340 | acc=0.9688 | L2-Norm=18.449 | L2-Norm(final)=1.938 | 4003.7 samples/s | 62.6 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.08770 | Reg=0.00333 | acc=0.9844 | L2-Norm=18.257 | L2-Norm(final)=1.956 | 4218.6 samples/s | 65.9 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.06576 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.118 | L2-Norm(final)=1.967 | 4300.5 samples/s | 67.2 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.05453 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.008 | L2-Norm(final)=1.974 | 4251.4 samples/s | 66.4 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.04493 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.917 | L2-Norm(final)=1.981 | 5348.6 samples/s | 83.6 steps/s
[Step= 300 Epoch= 1.1] | Loss=0.03825 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.834 | L2-Norm(final)=1.988 | 1784.0 samples/s | 27.9 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.03311 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.758 | L2-Norm(final)=1.994 | 4313.6 samples/s | 67.4 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.02913 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.687 | L2-Norm(final)=1.999 | 4437.8 samples/s | 69.3 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.02598 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.618 | L2-Norm(final)=2.004 | 4342.7 samples/s | 67.9 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.02377 | Reg=0.00308 | acc=0.9844 | L2-Norm=17.552 | L2-Norm(final)=2.009 | 4851.4 samples/s | 75.8 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.02172 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.491 | L2-Norm(final)=2.013 | 1979.4 samples/s | 30.9 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.02007 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.434 | L2-Norm(final)=2.017 | 4281.2 samples/s | 66.9 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.01858 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.380 | L2-Norm(final)=2.021 | 4453.9 samples/s | 69.6 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.01730 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.327 | L2-Norm(final)=2.025 | 4375.8 samples/s | 68.4 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.01618 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.276 | L2-Norm(final)=2.029 | 4415.6 samples/s | 69.0 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.01542 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.227 | L2-Norm(final)=2.032 | 2017.9 samples/s | 31.5 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step800.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.31430 | Reg=0.00355 | acc=0.5312 | L2-Norm=18.850 | L2-Norm(final)=1.909 | 4337.9 samples/s | 67.8 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.15779 | Reg=0.00340 | acc=0.9531 | L2-Norm=18.442 | L2-Norm(final)=1.936 | 4041.5 samples/s | 63.1 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.10366 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.289 | L2-Norm(final)=1.951 | 4380.4 samples/s | 68.4 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.07559 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.180 | L2-Norm(final)=1.964 | 4367.7 samples/s | 68.2 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.06028 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.092 | L2-Norm(final)=1.976 | 4374.6 samples/s | 68.4 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.05022 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.017 | L2-Norm(final)=1.985 | 5658.4 samples/s | 88.4 steps/s
[Step= 300 Epoch= 1.2] | Loss=0.04269 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.951 | L2-Norm(final)=1.993 | 1913.3 samples/s | 29.9 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.03694 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.887 | L2-Norm(final)=2.001 | 4323.3 samples/s | 67.6 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.03272 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.828 | L2-Norm(final)=2.007 | 4326.3 samples/s | 67.6 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.02961 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.776 | L2-Norm(final)=2.013 | 4358.4 samples/s | 68.1 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.02681 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.728 | L2-Norm(final)=2.018 | 4929.7 samples/s | 77.0 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.02444 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.680 | L2-Norm(final)=2.023 | 1952.4 samples/s | 30.5 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.02246 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.632 | L2-Norm(final)=2.028 | 4375.3 samples/s | 68.4 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.02077 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.585 | L2-Norm(final)=2.032 | 4434.9 samples/s | 69.3 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.01930 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.539 | L2-Norm(final)=2.036 | 4263.5 samples/s | 66.6 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.01802 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.492 | L2-Norm(final)=2.040 | 4447.8 samples/s | 69.5 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.01690 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.444 | L2-Norm(final)=2.044 | 2051.1 samples/s | 32.0 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step800.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09041 | acc=0.9313 | tpr=0.9387 | fpr=0.0850 | 4169.6 samples/s | 16.3 steps/s
Avg test loss: 0.09158, Avg test acc: 0.92936, Avg tpr: 0.93723, Avg fpr: 0.08794, total FA: 686

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09479 | acc=0.9279 | tpr=0.9548 | fpr=0.1306 | 4078.6 samples/s | 15.9 steps/s
Avg test loss: 0.09525, Avg test acc: 0.92788, Avg tpr: 0.95460, Avg fpr: 0.13088, total FA: 1021

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.82085 | acc=0.3174 | tpr=0.0211 | fpr=0.0391 | 4121.6 samples/s | 16.1 steps/s
Avg test loss: 4.84077, Avg test acc: 0.31485, Avg tpr: 0.02104, Avg fpr: 0.03897, total FA: 304

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.18058 | acc=0.3152 | tpr=0.0162 | fpr=0.0354 | 3902.6 samples/s | 15.2 steps/s
Avg test loss: 6.21452, Avg test acc: 0.31265, Avg tpr: 0.01550, Avg fpr: 0.03384, total FA: 264

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=1.63605 | acc=0.1655 | tpr=0.8053 | fpr=0.8460 | 4059.4 samples/s | 15.9 steps/s
[Step= 100] | Loss=1.62424 | acc=0.1653 | tpr=0.7655 | fpr=0.8459 | 7498.6 samples/s | 29.3 steps/s
[Step= 150] | Loss=1.63109 | acc=0.1639 | tpr=0.7651 | fpr=0.8472 | 7279.6 samples/s | 28.4 steps/s
[Step= 200] | Loss=1.62955 | acc=0.1646 | tpr=0.7552 | fpr=0.8461 | 7603.7 samples/s | 29.7 steps/s
[Step= 250] | Loss=1.63083 | acc=0.1642 | tpr=0.7441 | fpr=0.8464 | 7434.0 samples/s | 29.0 steps/s
[Step= 300] | Loss=1.63323 | acc=0.1637 | tpr=0.7469 | fpr=0.8469 | 7414.2 samples/s | 29.0 steps/s
[Step= 350] | Loss=1.63222 | acc=0.1641 | tpr=0.7483 | fpr=0.8465 | 7242.0 samples/s | 28.3 steps/s
[Step= 400] | Loss=1.63242 | acc=0.1641 | tpr=0.7495 | fpr=0.8465 | 7080.9 samples/s | 27.7 steps/s
[Step= 450] | Loss=1.63251 | acc=0.1638 | tpr=0.7532 | fpr=0.8469 | 7488.5 samples/s | 29.3 steps/s
[Step= 500] | Loss=1.63371 | acc=0.1630 | tpr=0.7533 | fpr=0.8476 | 7482.7 samples/s | 29.2 steps/s
[Step= 550] | Loss=1.63351 | acc=0.1633 | tpr=0.7537 | fpr=0.8474 | 13385.6 samples/s | 52.3 steps/s
Avg test loss: 1.63406, Avg test acc: 0.16314, Avg tpr: 0.75396, Avg fpr: 0.84760, total FA: 117688

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=2.53802 | acc=0.1239 | tpr=0.7035 | fpr=0.8865 | 4227.7 samples/s | 16.5 steps/s
[Step= 100] | Loss=2.52212 | acc=0.1260 | tpr=0.7122 | fpr=0.8849 | 7547.4 samples/s | 29.5 steps/s
[Step= 150] | Loss=2.52077 | acc=0.1258 | tpr=0.7075 | fpr=0.8849 | 8222.7 samples/s | 32.1 steps/s
[Step= 200] | Loss=2.51662 | acc=0.1264 | tpr=0.7060 | fpr=0.8842 | 7717.2 samples/s | 30.1 steps/s
[Step= 250] | Loss=2.51851 | acc=0.1266 | tpr=0.7022 | fpr=0.8839 | 8047.1 samples/s | 31.4 steps/s
[Step= 300] | Loss=2.51918 | acc=0.1264 | tpr=0.6945 | fpr=0.8839 | 7224.4 samples/s | 28.2 steps/s
[Step= 350] | Loss=2.51767 | acc=0.1261 | tpr=0.6951 | fpr=0.8842 | 7758.7 samples/s | 30.3 steps/s
[Step= 400] | Loss=2.51881 | acc=0.1261 | tpr=0.6991 | fpr=0.8844 | 8229.0 samples/s | 32.1 steps/s
[Step= 450] | Loss=2.52066 | acc=0.1260 | tpr=0.7011 | fpr=0.8844 | 7899.0 samples/s | 30.9 steps/s
[Step= 500] | Loss=2.52333 | acc=0.1256 | tpr=0.7000 | fpr=0.8848 | 7514.7 samples/s | 29.4 steps/s
[Step= 550] | Loss=2.52269 | acc=0.1256 | tpr=0.7016 | fpr=0.8849 | 15034.4 samples/s | 58.7 steps/s
Avg test loss: 2.52321, Avg test acc: 0.12546, Avg tpr: 0.70246, Avg fpr: 0.88503, total FA: 122884

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.05778 | acc=0.9802 | tpr=0.9469 | fpr=0.0192 | 4150.4 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.05841 | acc=0.9794 | tpr=0.9531 | fpr=0.0201 | 8131.7 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.06016 | acc=0.9785 | tpr=0.9496 | fpr=0.0210 | 7782.0 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.05956 | acc=0.9785 | tpr=0.9519 | fpr=0.0210 | 7684.1 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.05984 | acc=0.9787 | tpr=0.9511 | fpr=0.0208 | 7600.5 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.06042 | acc=0.9784 | tpr=0.9476 | fpr=0.0210 | 7559.0 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.06058 | acc=0.9783 | tpr=0.9474 | fpr=0.0211 | 7599.7 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.06159 | acc=0.9781 | tpr=0.9447 | fpr=0.0213 | 7632.8 samples/s | 29.8 steps/s
[Step= 450] | Loss=0.06247 | acc=0.9778 | tpr=0.9445 | fpr=0.0216 | 7861.2 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.06221 | acc=0.9778 | tpr=0.9467 | fpr=0.0216 | 7840.4 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.06143 | acc=0.9780 | tpr=0.9463 | fpr=0.0214 | 13430.6 samples/s | 52.5 steps/s
Avg test loss: 0.06130, Avg test acc: 0.97803, Avg tpr: 0.94651, Avg fpr: 0.02140, total FA: 2971

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.07540 | acc=0.9802 | tpr=0.9602 | fpr=0.0194 | 3955.0 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.07804 | acc=0.9795 | tpr=0.9680 | fpr=0.0203 | 7664.2 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.08094 | acc=0.9786 | tpr=0.9625 | fpr=0.0211 | 7530.8 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.08210 | acc=0.9783 | tpr=0.9628 | fpr=0.0215 | 7602.8 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.08114 | acc=0.9784 | tpr=0.9616 | fpr=0.0213 | 7382.4 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.08168 | acc=0.9783 | tpr=0.9615 | fpr=0.0214 | 7447.4 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.08225 | acc=0.9781 | tpr=0.9637 | fpr=0.0216 | 7434.7 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.08300 | acc=0.9779 | tpr=0.9628 | fpr=0.0218 | 7501.4 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.08463 | acc=0.9776 | tpr=0.9620 | fpr=0.0221 | 7563.5 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.08452 | acc=0.9777 | tpr=0.9630 | fpr=0.0221 | 8011.6 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.08362 | acc=0.9779 | tpr=0.9626 | fpr=0.0218 | 14555.8 samples/s | 56.9 steps/s
Avg test loss: 0.08351, Avg test acc: 0.97790, Avg tpr: 0.96276, Avg fpr: 0.02183, total FA: 3031

server round 1/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step= 801 Epoch= 1.6] | Loss=0.04066 | Reg=0.00325 | acc=0.9688 | L2-Norm=18.036 | L2-Norm(final)=2.111 | 3666.2 samples/s | 57.3 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.05514 | Reg=0.00326 | acc=0.9531 | L2-Norm=18.063 | L2-Norm(final)=2.125 | 4475.5 samples/s | 69.9 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.05720 | Reg=0.00327 | acc=0.9531 | L2-Norm=18.071 | L2-Norm(final)=2.133 | 4660.6 samples/s | 72.8 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.05978 | Reg=0.00327 | acc=0.9844 | L2-Norm=18.075 | L2-Norm(final)=2.137 | 4610.4 samples/s | 72.0 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.05932 | Reg=0.00327 | acc=0.9688 | L2-Norm=18.076 | L2-Norm(final)=2.139 | 4597.8 samples/s | 71.8 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.05866 | Reg=0.00327 | acc=0.9531 | L2-Norm=18.078 | L2-Norm(final)=2.139 | 4597.4 samples/s | 71.8 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.05983 | Reg=0.00327 | acc=0.9531 | L2-Norm=18.077 | L2-Norm(final)=2.140 | 4516.1 samples/s | 70.6 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.06002 | Reg=0.00327 | acc=0.9688 | L2-Norm=18.077 | L2-Norm(final)=2.140 | 4612.4 samples/s | 72.1 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.05999 | Reg=0.00327 | acc=0.9062 | L2-Norm=18.076 | L2-Norm(final)=2.139 | 4662.9 samples/s | 72.9 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.05927 | Reg=0.00327 | acc=0.9688 | L2-Norm=18.076 | L2-Norm(final)=2.139 | 4694.4 samples/s | 73.4 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.05881 | Reg=0.00327 | acc=0.9844 | L2-Norm=18.078 | L2-Norm(final)=2.140 | 5580.9 samples/s | 87.2 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.05786 | Reg=0.00327 | acc=0.9531 | L2-Norm=18.082 | L2-Norm(final)=2.141 | 1884.7 samples/s | 29.4 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.05596 | Reg=0.00327 | acc=0.9375 | L2-Norm=18.087 | L2-Norm(final)=2.144 | 4552.0 samples/s | 71.1 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.05535 | Reg=0.00327 | acc=0.9531 | L2-Norm=18.091 | L2-Norm(final)=2.146 | 4657.6 samples/s | 72.8 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.05482 | Reg=0.00327 | acc=0.9219 | L2-Norm=18.095 | L2-Norm(final)=2.148 | 4638.2 samples/s | 72.5 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.05390 | Reg=0.00328 | acc=0.9531 | L2-Norm=18.099 | L2-Norm(final)=2.150 | 4650.3 samples/s | 72.7 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.05397 | Reg=0.00328 | acc=0.9531 | L2-Norm=18.103 | L2-Norm(final)=2.151 | 4538.0 samples/s | 70.9 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step1600.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00100, len=1
[Step= 801 Epoch= 1.6] | Loss=0.05820 | Reg=0.00322 | acc=0.9531 | L2-Norm=17.932 | L2-Norm(final)=2.074 | 4270.2 samples/s | 66.7 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.06501 | Reg=0.00322 | acc=0.9375 | L2-Norm=17.935 | L2-Norm(final)=2.075 | 4069.1 samples/s | 63.6 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.06130 | Reg=0.00322 | acc=0.9531 | L2-Norm=17.948 | L2-Norm(final)=2.084 | 4634.9 samples/s | 72.4 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.06031 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.953 | L2-Norm(final)=2.087 | 4645.1 samples/s | 72.6 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.05993 | Reg=0.00322 | acc=0.9219 | L2-Norm=17.958 | L2-Norm(final)=2.088 | 4686.3 samples/s | 73.2 steps/s
[Step=1050 Epoch= 2.1] | Loss=0.05860 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.960 | L2-Norm(final)=2.090 | 4470.6 samples/s | 69.9 steps/s
[Step=1100 Epoch= 2.2] | Loss=0.05984 | Reg=0.00323 | acc=0.9375 | L2-Norm=17.959 | L2-Norm(final)=2.090 | 4579.1 samples/s | 71.5 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.06024 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.958 | L2-Norm(final)=2.091 | 4637.1 samples/s | 72.5 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.05916 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.959 | L2-Norm(final)=2.092 | 4602.9 samples/s | 71.9 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.05902 | Reg=0.00323 | acc=0.9375 | L2-Norm=17.961 | L2-Norm(final)=2.094 | 4654.1 samples/s | 72.7 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.05920 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.963 | L2-Norm(final)=2.095 | 5751.7 samples/s | 89.9 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.05816 | Reg=0.00323 | acc=0.9375 | L2-Norm=17.966 | L2-Norm(final)=2.097 | 1919.1 samples/s | 30.0 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.05735 | Reg=0.00323 | acc=0.9531 | L2-Norm=17.969 | L2-Norm(final)=2.099 | 4603.8 samples/s | 71.9 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.05703 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.973 | L2-Norm(final)=2.101 | 4623.2 samples/s | 72.2 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.05612 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.979 | L2-Norm(final)=2.103 | 4657.7 samples/s | 72.8 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.05480 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.985 | L2-Norm(final)=2.105 | 4639.9 samples/s | 72.5 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.05422 | Reg=0.00324 | acc=0.9531 | L2-Norm=17.989 | L2-Norm(final)=2.107 | 4550.8 samples/s | 71.1 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step1600.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step= 801 Epoch= 3.1] | Loss=0.00005 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.476 | L2-Norm(final)=2.086 | 3995.4 samples/s | 62.4 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.01003 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.526 | L2-Norm(final)=2.074 | 3848.5 samples/s | 60.1 steps/s
[Step= 900 Epoch= 3.4] | Loss=0.00678 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.536 | L2-Norm(final)=2.074 | 4359.3 samples/s | 68.1 steps/s
[Step= 950 Epoch= 3.6] | Loss=0.00560 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.527 | L2-Norm(final)=2.075 | 4269.6 samples/s | 66.7 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.00432 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.507 | L2-Norm(final)=2.078 | 4249.9 samples/s | 66.4 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.00353 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.481 | L2-Norm(final)=2.080 | 5333.6 samples/s | 83.3 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.00296 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.452 | L2-Norm(final)=2.083 | 1845.1 samples/s | 28.8 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.00254 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.420 | L2-Norm(final)=2.085 | 4198.1 samples/s | 65.6 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.00223 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.386 | L2-Norm(final)=2.087 | 4160.8 samples/s | 65.0 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.00199 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.351 | L2-Norm(final)=2.089 | 4258.0 samples/s | 66.5 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.00179 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.315 | L2-Norm(final)=2.090 | 4759.2 samples/s | 74.4 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.00163 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.279 | L2-Norm(final)=2.091 | 1906.7 samples/s | 29.8 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.00149 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.242 | L2-Norm(final)=2.092 | 4380.5 samples/s | 68.4 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.00138 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.204 | L2-Norm(final)=2.093 | 4253.2 samples/s | 66.5 steps/s
[Step=1500 Epoch= 5.7] | Loss=0.00128 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.167 | L2-Norm(final)=2.094 | 4339.7 samples/s | 67.8 steps/s
[Step=1550 Epoch= 5.9] | Loss=0.00120 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.129 | L2-Norm(final)=2.095 | 4306.8 samples/s | 67.3 steps/s
[Step=1600 Epoch= 6.1] | Loss=0.00112 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.092 | L2-Norm(final)=2.096 | 1993.9 samples/s | 31.2 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step1600.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00100, len=1
[Step= 801 Epoch= 3.1] | Loss=0.00001 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.690 | L2-Norm(final)=2.098 | 3891.7 samples/s | 60.8 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.00004 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.641 | L2-Norm(final)=2.098 | 3962.6 samples/s | 61.9 steps/s
[Step= 900 Epoch= 3.5] | Loss=0.00004 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.592 | L2-Norm(final)=2.099 | 4248.5 samples/s | 66.4 steps/s
[Step= 950 Epoch= 3.7] | Loss=0.00004 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.543 | L2-Norm(final)=2.100 | 4177.6 samples/s | 65.3 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.00005 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.495 | L2-Norm(final)=2.101 | 4276.1 samples/s | 66.8 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.00004 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.447 | L2-Norm(final)=2.101 | 5301.6 samples/s | 82.8 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.00004 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.399 | L2-Norm(final)=2.102 | 1829.3 samples/s | 28.6 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.00003 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.352 | L2-Norm(final)=2.102 | 4156.5 samples/s | 64.9 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.00003 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.304 | L2-Norm(final)=2.103 | 4177.9 samples/s | 65.3 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.00003 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.257 | L2-Norm(final)=2.103 | 4150.0 samples/s | 64.8 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.00003 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.210 | L2-Norm(final)=2.104 | 4729.9 samples/s | 73.9 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.00003 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.163 | L2-Norm(final)=2.104 | 1901.8 samples/s | 29.7 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.00002 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.117 | L2-Norm(final)=2.105 | 4249.6 samples/s | 66.4 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.00002 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.071 | L2-Norm(final)=2.105 | 4232.7 samples/s | 66.1 steps/s
[Step=1500 Epoch= 5.8] | Loss=0.00002 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.024 | L2-Norm(final)=2.106 | 4199.5 samples/s | 65.6 steps/s
[Step=1550 Epoch= 6.0] | Loss=0.00002 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.979 | L2-Norm(final)=2.106 | 4304.9 samples/s | 67.3 steps/s
[Step=1600 Epoch= 6.2] | Loss=0.00002 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.933 | L2-Norm(final)=2.107 | 1971.0 samples/s | 30.8 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step1600.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08283 | acc=0.9400 | tpr=0.9529 | fpr=0.0880 | 4250.3 samples/s | 16.6 steps/s
Avg test loss: 0.08547, Avg test acc: 0.93958, Avg tpr: 0.95244, Avg fpr: 0.08871, total FA: 692

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08624 | acc=0.9400 | tpr=0.9371 | fpr=0.0538 | 4161.5 samples/s | 16.3 steps/s
Avg test loss: 0.08759, Avg test acc: 0.93854, Avg tpr: 0.93629, Avg fpr: 0.05653, total FA: 441

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.12008 | acc=0.3155 | tpr=0.0134 | fpr=0.0282 | 4110.0 samples/s | 16.1 steps/s
Avg test loss: 6.14833, Avg test acc: 0.31265, Avg tpr: 0.01300, Avg fpr: 0.02833, total FA: 221

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.61619 | acc=0.3158 | tpr=0.0118 | fpr=0.0240 | 4062.1 samples/s | 15.9 steps/s
Avg test loss: 6.65160, Avg test acc: 0.31293, Avg tpr: 0.01131, Avg fpr: 0.02371, total FA: 185

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=2.32668 | acc=0.1414 | tpr=0.7743 | fpr=0.8700 | 4144.3 samples/s | 16.2 steps/s
[Step= 100] | Loss=2.31289 | acc=0.1413 | tpr=0.7441 | fpr=0.8700 | 7607.9 samples/s | 29.7 steps/s
[Step= 150] | Loss=2.31866 | acc=0.1405 | tpr=0.7536 | fpr=0.8708 | 8410.0 samples/s | 32.9 steps/s
[Step= 200] | Loss=2.31853 | acc=0.1412 | tpr=0.7519 | fpr=0.8700 | 7788.4 samples/s | 30.4 steps/s
[Step= 250] | Loss=2.32073 | acc=0.1407 | tpr=0.7389 | fpr=0.8701 | 7463.6 samples/s | 29.2 steps/s
[Step= 300] | Loss=2.32126 | acc=0.1410 | tpr=0.7389 | fpr=0.8699 | 7869.0 samples/s | 30.7 steps/s
[Step= 350] | Loss=2.32012 | acc=0.1413 | tpr=0.7477 | fpr=0.8697 | 7552.5 samples/s | 29.5 steps/s
[Step= 400] | Loss=2.31985 | acc=0.1415 | tpr=0.7440 | fpr=0.8694 | 7778.8 samples/s | 30.4 steps/s
[Step= 450] | Loss=2.32081 | acc=0.1414 | tpr=0.7463 | fpr=0.8696 | 7633.3 samples/s | 29.8 steps/s
[Step= 500] | Loss=2.32391 | acc=0.1410 | tpr=0.7467 | fpr=0.8700 | 7371.8 samples/s | 28.8 steps/s
[Step= 550] | Loss=2.32397 | acc=0.1409 | tpr=0.7457 | fpr=0.8701 | 14197.6 samples/s | 55.5 steps/s
Avg test loss: 2.32495, Avg test acc: 0.14072, Avg tpr: 0.74525, Avg fpr: 0.87027, total FA: 120835

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=2.47733 | acc=0.1866 | tpr=0.6858 | fpr=0.8224 | 4115.1 samples/s | 16.1 steps/s
[Step= 100] | Loss=2.46025 | acc=0.1879 | tpr=0.6802 | fpr=0.8213 | 7605.7 samples/s | 29.7 steps/s
[Step= 150] | Loss=2.46120 | acc=0.1865 | tpr=0.6729 | fpr=0.8225 | 7399.4 samples/s | 28.9 steps/s
[Step= 200] | Loss=2.45775 | acc=0.1869 | tpr=0.6634 | fpr=0.8218 | 7502.9 samples/s | 29.3 steps/s
[Step= 250] | Loss=2.45869 | acc=0.1872 | tpr=0.6620 | fpr=0.8215 | 7463.1 samples/s | 29.2 steps/s
[Step= 300] | Loss=2.45976 | acc=0.1865 | tpr=0.6516 | fpr=0.8220 | 7711.7 samples/s | 30.1 steps/s
[Step= 350] | Loss=2.45928 | acc=0.1858 | tpr=0.6518 | fpr=0.8227 | 7064.7 samples/s | 27.6 steps/s
[Step= 400] | Loss=2.46038 | acc=0.1859 | tpr=0.6570 | fpr=0.8226 | 7455.0 samples/s | 29.1 steps/s
[Step= 450] | Loss=2.46160 | acc=0.1863 | tpr=0.6577 | fpr=0.8223 | 7434.6 samples/s | 29.0 steps/s
[Step= 500] | Loss=2.46523 | acc=0.1855 | tpr=0.6612 | fpr=0.8231 | 7277.7 samples/s | 28.4 steps/s
[Step= 550] | Loss=2.46371 | acc=0.1857 | tpr=0.6665 | fpr=0.8230 | 14012.9 samples/s | 54.7 steps/s
Avg test loss: 2.46447, Avg test acc: 0.18553, Avg tpr: 0.66719, Avg fpr: 0.82322, total FA: 114303

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09447 | acc=0.9808 | tpr=0.9558 | fpr=0.0188 | 4106.1 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.09535 | acc=0.9806 | tpr=0.9574 | fpr=0.0189 | 7501.9 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.09956 | acc=0.9800 | tpr=0.9553 | fpr=0.0195 | 7938.6 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.10106 | acc=0.9799 | tpr=0.9541 | fpr=0.0196 | 7862.1 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.09972 | acc=0.9800 | tpr=0.9546 | fpr=0.0195 | 7555.0 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.10094 | acc=0.9797 | tpr=0.9513 | fpr=0.0198 | 8232.8 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.10174 | acc=0.9794 | tpr=0.9537 | fpr=0.0202 | 7569.2 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.10348 | acc=0.9791 | tpr=0.9491 | fpr=0.0204 | 7911.3 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.10510 | acc=0.9788 | tpr=0.9479 | fpr=0.0206 | 7706.3 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.10436 | acc=0.9789 | tpr=0.9485 | fpr=0.0206 | 7548.9 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.10363 | acc=0.9790 | tpr=0.9483 | fpr=0.0205 | 14325.7 samples/s | 56.0 steps/s
Avg test loss: 0.10345, Avg test acc: 0.97900, Avg tpr: 0.94849, Avg fpr: 0.02045, total FA: 2839

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.07684 | acc=0.9822 | tpr=0.9513 | fpr=0.0173 | 4087.0 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.07930 | acc=0.9811 | tpr=0.9595 | fpr=0.0185 | 8097.8 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.08235 | acc=0.9802 | tpr=0.9553 | fpr=0.0194 | 7967.9 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.08334 | acc=0.9799 | tpr=0.9552 | fpr=0.0196 | 7512.0 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.08235 | acc=0.9801 | tpr=0.9546 | fpr=0.0194 | 8252.6 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.08298 | acc=0.9801 | tpr=0.9535 | fpr=0.0195 | 7787.8 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.08336 | acc=0.9801 | tpr=0.9568 | fpr=0.0195 | 7736.9 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.08411 | acc=0.9798 | tpr=0.9557 | fpr=0.0197 | 7616.5 samples/s | 29.8 steps/s
[Step= 450] | Loss=0.08574 | acc=0.9795 | tpr=0.9557 | fpr=0.0201 | 7342.9 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.08560 | acc=0.9796 | tpr=0.9564 | fpr=0.0200 | 7535.3 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.08473 | acc=0.9797 | tpr=0.9558 | fpr=0.0198 | 13104.8 samples/s | 51.2 steps/s
Avg test loss: 0.08462, Avg test acc: 0.97973, Avg tpr: 0.95563, Avg fpr: 0.01983, total FA: 2753

server round 2/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=1601 Epoch= 3.1] | Loss=0.02884 | Reg=0.00330 | acc=0.9844 | L2-Norm=18.172 | L2-Norm(final)=2.160 | 3768.8 samples/s | 58.9 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.03630 | Reg=0.00331 | acc=0.9688 | L2-Norm=18.188 | L2-Norm(final)=2.166 | 4373.1 samples/s | 68.3 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.03762 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.193 | L2-Norm(final)=2.172 | 4309.9 samples/s | 67.3 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.03777 | Reg=0.00331 | acc=0.9219 | L2-Norm=18.202 | L2-Norm(final)=2.177 | 4565.5 samples/s | 71.3 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.03864 | Reg=0.00331 | acc=0.9688 | L2-Norm=18.203 | L2-Norm(final)=2.178 | 4572.2 samples/s | 71.4 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.03901 | Reg=0.00331 | acc=0.9531 | L2-Norm=18.201 | L2-Norm(final)=2.178 | 4621.6 samples/s | 72.2 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.03859 | Reg=0.00331 | acc=0.9375 | L2-Norm=18.203 | L2-Norm(final)=2.179 | 4684.1 samples/s | 73.2 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.03980 | Reg=0.00331 | acc=0.9688 | L2-Norm=18.204 | L2-Norm(final)=2.179 | 4643.1 samples/s | 72.5 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.04015 | Reg=0.00331 | acc=0.9688 | L2-Norm=18.204 | L2-Norm(final)=2.179 | 4577.5 samples/s | 71.5 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.04047 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.206 | L2-Norm(final)=2.178 | 4591.0 samples/s | 71.7 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.04064 | Reg=0.00332 | acc=0.9531 | L2-Norm=18.208 | L2-Norm(final)=2.177 | 5615.4 samples/s | 87.7 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.04010 | Reg=0.00332 | acc=0.9375 | L2-Norm=18.211 | L2-Norm(final)=2.177 | 1853.6 samples/s | 29.0 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.03885 | Reg=0.00332 | acc=0.9688 | L2-Norm=18.216 | L2-Norm(final)=2.178 | 4381.9 samples/s | 68.5 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.03806 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.222 | L2-Norm(final)=2.179 | 4480.6 samples/s | 70.0 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.03759 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.227 | L2-Norm(final)=2.180 | 4457.7 samples/s | 69.7 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.03793 | Reg=0.00332 | acc=0.9688 | L2-Norm=18.233 | L2-Norm(final)=2.180 | 4410.2 samples/s | 68.9 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.03758 | Reg=0.00333 | acc=0.9844 | L2-Norm=18.238 | L2-Norm(final)=2.181 | 4513.8 samples/s | 70.5 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step2400.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00100, len=1
[Step=1601 Epoch= 3.1] | Loss=0.02245 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.064 | L2-Norm(final)=2.126 | 3938.8 samples/s | 61.5 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.03836 | Reg=0.00327 | acc=0.9531 | L2-Norm=18.079 | L2-Norm(final)=2.129 | 4545.0 samples/s | 71.0 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.04400 | Reg=0.00328 | acc=0.9531 | L2-Norm=18.098 | L2-Norm(final)=2.136 | 4427.1 samples/s | 69.2 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.04429 | Reg=0.00328 | acc=0.9375 | L2-Norm=18.109 | L2-Norm(final)=2.134 | 4499.5 samples/s | 70.3 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.04338 | Reg=0.00328 | acc=0.9844 | L2-Norm=18.118 | L2-Norm(final)=2.136 | 4360.8 samples/s | 68.1 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.04421 | Reg=0.00329 | acc=0.9531 | L2-Norm=18.125 | L2-Norm(final)=2.135 | 4446.5 samples/s | 69.5 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.04409 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.131 | L2-Norm(final)=2.133 | 4439.3 samples/s | 69.4 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.04255 | Reg=0.00329 | acc=0.9531 | L2-Norm=18.137 | L2-Norm(final)=2.133 | 4394.0 samples/s | 68.7 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.04151 | Reg=0.00329 | acc=0.9375 | L2-Norm=18.144 | L2-Norm(final)=2.135 | 4429.7 samples/s | 69.2 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.04153 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.152 | L2-Norm(final)=2.137 | 4499.7 samples/s | 70.3 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.04254 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.159 | L2-Norm(final)=2.137 | 5509.9 samples/s | 86.1 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.04161 | Reg=0.00330 | acc=0.9688 | L2-Norm=18.167 | L2-Norm(final)=2.138 | 1893.8 samples/s | 29.6 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.04084 | Reg=0.00330 | acc=0.9531 | L2-Norm=18.174 | L2-Norm(final)=2.139 | 4511.5 samples/s | 70.5 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.04046 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.182 | L2-Norm(final)=2.141 | 4540.6 samples/s | 70.9 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.03947 | Reg=0.00331 | acc=0.9688 | L2-Norm=18.190 | L2-Norm(final)=2.143 | 4589.1 samples/s | 71.7 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.03877 | Reg=0.00331 | acc=0.9688 | L2-Norm=18.197 | L2-Norm(final)=2.144 | 4609.8 samples/s | 72.0 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.03877 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.202 | L2-Norm(final)=2.145 | 4665.3 samples/s | 72.9 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step2400.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=1601 Epoch= 6.1] | Loss=0.00000 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.488 | L2-Norm(final)=2.107 | 3922.9 samples/s | 61.3 steps/s
[Step=1650 Epoch= 6.3] | Loss=0.00001 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.451 | L2-Norm(final)=2.108 | 4370.1 samples/s | 68.3 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.00001 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.413 | L2-Norm(final)=2.108 | 4358.8 samples/s | 68.1 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.00001 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.376 | L2-Norm(final)=2.108 | 4279.0 samples/s | 66.9 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.00001 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.338 | L2-Norm(final)=2.109 | 4378.3 samples/s | 68.4 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.00001 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.301 | L2-Norm(final)=2.109 | 5571.8 samples/s | 87.1 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00001 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.263 | L2-Norm(final)=2.109 | 1891.0 samples/s | 29.5 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00001 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.226 | L2-Norm(final)=2.110 | 4354.6 samples/s | 68.0 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00001 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.189 | L2-Norm(final)=2.110 | 4272.2 samples/s | 66.8 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.00001 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.152 | L2-Norm(final)=2.111 | 4415.1 samples/s | 69.0 steps/s
[Step=2100 Epoch= 8.0] | Loss=0.00001 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.115 | L2-Norm(final)=2.111 | 4882.5 samples/s | 76.3 steps/s
[Step=2150 Epoch= 8.2] | Loss=0.00001 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.078 | L2-Norm(final)=2.112 | 1972.6 samples/s | 30.8 steps/s
[Step=2200 Epoch= 8.4] | Loss=0.00001 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.041 | L2-Norm(final)=2.112 | 4359.7 samples/s | 68.1 steps/s
[Step=2250 Epoch= 8.6] | Loss=0.00001 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.004 | L2-Norm(final)=2.113 | 4283.5 samples/s | 66.9 steps/s
[Step=2300 Epoch= 8.8] | Loss=0.00001 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.967 | L2-Norm(final)=2.113 | 4409.6 samples/s | 68.9 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.00001 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.930 | L2-Norm(final)=2.114 | 4449.7 samples/s | 69.5 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.00001 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.893 | L2-Norm(final)=2.115 | 2074.7 samples/s | 32.4 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step2400.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00100, len=1
[Step=1601 Epoch= 6.2] | Loss=0.00000 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.202 | L2-Norm(final)=2.114 | 4267.6 samples/s | 66.7 steps/s
[Step=1650 Epoch= 6.4] | Loss=0.00001 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.159 | L2-Norm(final)=2.114 | 4118.9 samples/s | 64.4 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.00001 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.115 | L2-Norm(final)=2.115 | 4576.0 samples/s | 71.5 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.00001 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.071 | L2-Norm(final)=2.115 | 4277.7 samples/s | 66.8 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.00001 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.028 | L2-Norm(final)=2.116 | 4414.6 samples/s | 69.0 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.00001 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.984 | L2-Norm(final)=2.116 | 5714.3 samples/s | 89.3 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00001 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.941 | L2-Norm(final)=2.116 | 1853.5 samples/s | 29.0 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00001 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.898 | L2-Norm(final)=2.117 | 4371.3 samples/s | 68.3 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00001 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.855 | L2-Norm(final)=2.118 | 4255.7 samples/s | 66.5 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.00001 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.812 | L2-Norm(final)=2.118 | 4388.5 samples/s | 68.6 steps/s
[Step=2100 Epoch= 8.1] | Loss=0.00001 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.769 | L2-Norm(final)=2.119 | 4944.6 samples/s | 77.3 steps/s
[Step=2150 Epoch= 8.3] | Loss=0.00001 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.727 | L2-Norm(final)=2.119 | 1866.7 samples/s | 29.2 steps/s
[Step=2200 Epoch= 8.5] | Loss=0.00001 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.684 | L2-Norm(final)=2.120 | 4285.6 samples/s | 67.0 steps/s
[Step=2250 Epoch= 8.7] | Loss=0.00001 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.642 | L2-Norm(final)=2.121 | 4296.2 samples/s | 67.1 steps/s
[Step=2300 Epoch= 8.9] | Loss=0.00001 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.600 | L2-Norm(final)=2.121 | 4247.7 samples/s | 66.4 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.00001 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.557 | L2-Norm(final)=2.122 | 4303.7 samples/s | 67.2 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.00001 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.515 | L2-Norm(final)=2.123 | 1964.2 samples/s | 30.7 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step2400.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08619 | acc=0.9526 | tpr=0.9603 | fpr=0.0642 | 4200.7 samples/s | 16.4 steps/s
Avg test loss: 0.08773, Avg test acc: 0.95040, Avg tpr: 0.95821, Avg fpr: 0.06679, total FA: 521

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07761 | acc=0.9446 | tpr=0.9532 | fpr=0.0741 | 4208.0 samples/s | 16.4 steps/s
Avg test loss: 0.08127, Avg test acc: 0.94334, Avg tpr: 0.95337, Avg fpr: 0.07871, total FA: 614

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.08629 | acc=0.3145 | tpr=0.0127 | fpr=0.0302 | 4048.6 samples/s | 15.8 steps/s
Avg test loss: 6.11545, Avg test acc: 0.31192, Avg tpr: 0.01276, Avg fpr: 0.03012, total FA: 235

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.22917 | acc=0.3150 | tpr=0.0147 | fpr=0.0330 | 4109.1 samples/s | 16.1 steps/s
Avg test loss: 6.26228, Avg test acc: 0.31297, Avg tpr: 0.01457, Avg fpr: 0.03077, total FA: 240

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.17188 | acc=0.1525 | tpr=0.7345 | fpr=0.8580 | 4000.0 samples/s | 15.6 steps/s
[Step= 100] | Loss=3.13798 | acc=0.1527 | tpr=0.6887 | fpr=0.8573 | 7487.5 samples/s | 29.2 steps/s
[Step= 150] | Loss=3.14704 | acc=0.1524 | tpr=0.7104 | fpr=0.8579 | 7684.2 samples/s | 30.0 steps/s
[Step= 200] | Loss=3.14431 | acc=0.1532 | tpr=0.7027 | fpr=0.8568 | 7637.5 samples/s | 29.8 steps/s
[Step= 250] | Loss=3.14952 | acc=0.1538 | tpr=0.6996 | fpr=0.8561 | 8254.4 samples/s | 32.2 steps/s
[Step= 300] | Loss=3.14976 | acc=0.1536 | tpr=0.6975 | fpr=0.8564 | 7570.0 samples/s | 29.6 steps/s
[Step= 350] | Loss=3.14863 | acc=0.1537 | tpr=0.7044 | fpr=0.8563 | 7796.4 samples/s | 30.5 steps/s
[Step= 400] | Loss=3.14740 | acc=0.1538 | tpr=0.7090 | fpr=0.8563 | 7914.2 samples/s | 30.9 steps/s
[Step= 450] | Loss=3.14883 | acc=0.1538 | tpr=0.7113 | fpr=0.8563 | 7668.1 samples/s | 30.0 steps/s
[Step= 500] | Loss=3.15322 | acc=0.1532 | tpr=0.7101 | fpr=0.8569 | 7819.5 samples/s | 30.5 steps/s
[Step= 550] | Loss=3.15309 | acc=0.1534 | tpr=0.7155 | fpr=0.8568 | 14779.8 samples/s | 57.7 steps/s
Avg test loss: 3.15446, Avg test acc: 0.15324, Avg tpr: 0.71593, Avg fpr: 0.85699, total FA: 118991

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=2.80053 | acc=0.1484 | tpr=0.6947 | fpr=0.8615 | 4079.7 samples/s | 15.9 steps/s
[Step= 100] | Loss=2.78510 | acc=0.1487 | tpr=0.7079 | fpr=0.8618 | 8131.9 samples/s | 31.8 steps/s
[Step= 150] | Loss=2.78259 | acc=0.1496 | tpr=0.7233 | fpr=0.8610 | 7882.0 samples/s | 30.8 steps/s
[Step= 200] | Loss=2.78046 | acc=0.1494 | tpr=0.7224 | fpr=0.8611 | 7482.2 samples/s | 29.2 steps/s
[Step= 250] | Loss=2.78311 | acc=0.1489 | tpr=0.7179 | fpr=0.8615 | 7969.9 samples/s | 31.1 steps/s
[Step= 300] | Loss=2.78636 | acc=0.1482 | tpr=0.7091 | fpr=0.8620 | 7787.3 samples/s | 30.4 steps/s
[Step= 350] | Loss=2.78371 | acc=0.1486 | tpr=0.7120 | fpr=0.8616 | 7814.3 samples/s | 30.5 steps/s
[Step= 400] | Loss=2.78446 | acc=0.1486 | tpr=0.7172 | fpr=0.8617 | 7821.8 samples/s | 30.6 steps/s
[Step= 450] | Loss=2.78583 | acc=0.1489 | tpr=0.7152 | fpr=0.8613 | 7527.6 samples/s | 29.4 steps/s
[Step= 500] | Loss=2.78794 | acc=0.1483 | tpr=0.7172 | fpr=0.8620 | 7509.9 samples/s | 29.3 steps/s
[Step= 550] | Loss=2.78685 | acc=0.1480 | tpr=0.7159 | fpr=0.8623 | 14195.3 samples/s | 55.5 steps/s
Avg test loss: 2.78781, Avg test acc: 0.14791, Avg tpr: 0.71632, Avg fpr: 0.86242, total FA: 119745

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10082 | acc=0.9802 | tpr=0.9558 | fpr=0.0193 | 3931.2 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.10184 | acc=0.9801 | tpr=0.9574 | fpr=0.0195 | 7744.0 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.10631 | acc=0.9795 | tpr=0.9553 | fpr=0.0201 | 7307.1 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.10803 | acc=0.9794 | tpr=0.9552 | fpr=0.0202 | 7687.1 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.10658 | acc=0.9795 | tpr=0.9555 | fpr=0.0200 | 7640.2 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.10788 | acc=0.9792 | tpr=0.9527 | fpr=0.0203 | 7703.8 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.10876 | acc=0.9789 | tpr=0.9549 | fpr=0.0207 | 7760.3 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.11053 | acc=0.9786 | tpr=0.9497 | fpr=0.0209 | 7569.3 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.11231 | acc=0.9784 | tpr=0.9484 | fpr=0.0211 | 7177.6 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.11156 | acc=0.9785 | tpr=0.9489 | fpr=0.0210 | 7205.3 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.11079 | acc=0.9786 | tpr=0.9483 | fpr=0.0209 | 13859.2 samples/s | 54.1 steps/s
Avg test loss: 0.11058, Avg test acc: 0.97861, Avg tpr: 0.94849, Avg fpr: 0.02084, total FA: 2894

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.08329 | acc=0.9798 | tpr=0.9513 | fpr=0.0196 | 3953.1 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.08620 | acc=0.9792 | tpr=0.9616 | fpr=0.0205 | 7669.8 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.08959 | acc=0.9784 | tpr=0.9582 | fpr=0.0213 | 7543.3 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.09044 | acc=0.9783 | tpr=0.9585 | fpr=0.0214 | 7952.8 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.08942 | acc=0.9785 | tpr=0.9581 | fpr=0.0211 | 7407.3 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.09005 | acc=0.9785 | tpr=0.9585 | fpr=0.0212 | 8092.5 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.09047 | acc=0.9783 | tpr=0.9612 | fpr=0.0214 | 7617.6 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.09132 | acc=0.9781 | tpr=0.9595 | fpr=0.0216 | 7883.9 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.09301 | acc=0.9778 | tpr=0.9591 | fpr=0.0219 | 7987.2 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.09285 | acc=0.9778 | tpr=0.9599 | fpr=0.0219 | 7544.9 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.09191 | acc=0.9780 | tpr=0.9598 | fpr=0.0217 | 13814.1 samples/s | 54.0 steps/s
Avg test loss: 0.09179, Avg test acc: 0.97799, Avg tpr: 0.95998, Avg fpr: 0.02168, total FA: 3010

server round 3/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=2401 Epoch= 4.7] | Loss=0.01559 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.336 | L2-Norm(final)=2.197 | 4037.7 samples/s | 63.1 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.02638 | Reg=0.00337 | acc=0.9844 | L2-Norm=18.345 | L2-Norm(final)=2.203 | 4544.1 samples/s | 71.0 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.03007 | Reg=0.00337 | acc=0.9219 | L2-Norm=18.348 | L2-Norm(final)=2.202 | 4673.0 samples/s | 73.0 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.02910 | Reg=0.00337 | acc=0.9844 | L2-Norm=18.353 | L2-Norm(final)=2.203 | 4566.0 samples/s | 71.3 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.03094 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.363 | L2-Norm(final)=2.203 | 4545.5 samples/s | 71.0 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.03252 | Reg=0.00338 | acc=0.9688 | L2-Norm=18.374 | L2-Norm(final)=2.203 | 4519.6 samples/s | 70.6 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.03314 | Reg=0.00338 | acc=0.9844 | L2-Norm=18.384 | L2-Norm(final)=2.201 | 4733.3 samples/s | 74.0 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.03372 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.395 | L2-Norm(final)=2.200 | 4521.1 samples/s | 70.6 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.03440 | Reg=0.00339 | acc=0.9531 | L2-Norm=18.405 | L2-Norm(final)=2.198 | 4639.0 samples/s | 72.5 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.03459 | Reg=0.00339 | acc=0.9844 | L2-Norm=18.416 | L2-Norm(final)=2.196 | 4561.4 samples/s | 71.3 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.03422 | Reg=0.00339 | acc=0.9844 | L2-Norm=18.425 | L2-Norm(final)=2.194 | 5634.8 samples/s | 88.0 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.03374 | Reg=0.00340 | acc=0.9844 | L2-Norm=18.433 | L2-Norm(final)=2.193 | 1895.7 samples/s | 29.6 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.03355 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.441 | L2-Norm(final)=2.192 | 4546.1 samples/s | 71.0 steps/s
[Step=3050 Epoch= 5.9] | Loss=0.03283 | Reg=0.00340 | acc=0.9844 | L2-Norm=18.447 | L2-Norm(final)=2.192 | 4574.3 samples/s | 71.5 steps/s
[Step=3100 Epoch= 6.0] | Loss=0.03247 | Reg=0.00340 | acc=0.9531 | L2-Norm=18.451 | L2-Norm(final)=2.192 | 4484.9 samples/s | 70.1 steps/s
[Step=3150 Epoch= 6.1] | Loss=0.03245 | Reg=0.00341 | acc=0.9844 | L2-Norm=18.457 | L2-Norm(final)=2.192 | 4639.8 samples/s | 72.5 steps/s
[Step=3200 Epoch= 6.2] | Loss=0.03223 | Reg=0.00341 | acc=0.9375 | L2-Norm=18.463 | L2-Norm(final)=2.192 | 4719.7 samples/s | 73.7 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step3200.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00100, len=1
[Step=2401 Epoch= 4.7] | Loss=0.04356 | Reg=0.00334 | acc=0.9219 | L2-Norm=18.286 | L2-Norm(final)=2.146 | 4060.7 samples/s | 63.4 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.02862 | Reg=0.00335 | acc=0.9844 | L2-Norm=18.299 | L2-Norm(final)=2.154 | 4446.6 samples/s | 69.5 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.03060 | Reg=0.00335 | acc=0.9844 | L2-Norm=18.309 | L2-Norm(final)=2.155 | 4503.0 samples/s | 70.4 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.02904 | Reg=0.00336 | acc=0.9844 | L2-Norm=18.319 | L2-Norm(final)=2.158 | 4475.4 samples/s | 69.9 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.02961 | Reg=0.00336 | acc=0.9844 | L2-Norm=18.328 | L2-Norm(final)=2.159 | 4681.7 samples/s | 73.2 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.03006 | Reg=0.00336 | acc=0.9688 | L2-Norm=18.337 | L2-Norm(final)=2.161 | 4609.0 samples/s | 72.0 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.03154 | Reg=0.00336 | acc=0.9844 | L2-Norm=18.343 | L2-Norm(final)=2.160 | 4687.9 samples/s | 73.2 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.03110 | Reg=0.00337 | acc=0.9844 | L2-Norm=18.352 | L2-Norm(final)=2.159 | 4615.8 samples/s | 72.1 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.03148 | Reg=0.00337 | acc=0.9844 | L2-Norm=18.360 | L2-Norm(final)=2.159 | 4634.2 samples/s | 72.4 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.03187 | Reg=0.00337 | acc=0.9219 | L2-Norm=18.365 | L2-Norm(final)=2.158 | 4357.7 samples/s | 68.1 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.03196 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.370 | L2-Norm(final)=2.158 | 5596.3 samples/s | 87.4 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.03139 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.378 | L2-Norm(final)=2.159 | 1894.3 samples/s | 29.6 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.03131 | Reg=0.00338 | acc=0.9844 | L2-Norm=18.386 | L2-Norm(final)=2.160 | 4501.2 samples/s | 70.3 steps/s
[Step=3050 Epoch= 6.0] | Loss=0.03115 | Reg=0.00338 | acc=0.9688 | L2-Norm=18.395 | L2-Norm(final)=2.161 | 4616.9 samples/s | 72.1 steps/s
[Step=3100 Epoch= 6.1] | Loss=0.03143 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.405 | L2-Norm(final)=2.160 | 4445.6 samples/s | 69.5 steps/s
[Step=3150 Epoch= 6.2] | Loss=0.03189 | Reg=0.00339 | acc=0.9688 | L2-Norm=18.415 | L2-Norm(final)=2.158 | 4547.1 samples/s | 71.0 steps/s
[Step=3200 Epoch= 6.3] | Loss=0.03192 | Reg=0.00340 | acc=0.9844 | L2-Norm=18.426 | L2-Norm(final)=2.156 | 4392.2 samples/s | 68.6 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step3200.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=2401 Epoch= 9.2] | Loss=0.00000 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.303 | L2-Norm(final)=2.127 | 3984.1 samples/s | 62.3 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.00001 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.267 | L2-Norm(final)=2.128 | 4088.9 samples/s | 63.9 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.00001 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.230 | L2-Norm(final)=2.129 | 4191.9 samples/s | 65.5 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.00001 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.194 | L2-Norm(final)=2.130 | 4291.7 samples/s | 67.1 steps/s
[Step=2600 Epoch=10.0] | Loss=0.00001 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.157 | L2-Norm(final)=2.131 | 4259.7 samples/s | 66.6 steps/s
[Step=2650 Epoch=10.2] | Loss=0.00001 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=2.133 | 5310.2 samples/s | 83.0 steps/s
[Step=2700 Epoch=10.3] | Loss=0.00001 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.085 | L2-Norm(final)=2.134 | 1850.3 samples/s | 28.9 steps/s
[Step=2750 Epoch=10.5] | Loss=0.00001 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.049 | L2-Norm(final)=2.136 | 4318.2 samples/s | 67.5 steps/s
[Step=2800 Epoch=10.7] | Loss=0.00001 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.012 | L2-Norm(final)=2.137 | 4324.9 samples/s | 67.6 steps/s
[Step=2850 Epoch=10.9] | Loss=0.00001 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.976 | L2-Norm(final)=2.139 | 4373.0 samples/s | 68.3 steps/s
[Step=2900 Epoch=11.1] | Loss=0.00001 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.940 | L2-Norm(final)=2.141 | 4651.8 samples/s | 72.7 steps/s
[Step=2950 Epoch=11.3] | Loss=0.00001 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.904 | L2-Norm(final)=2.142 | 1897.4 samples/s | 29.6 steps/s
[Step=3000 Epoch=11.5] | Loss=0.00001 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.867 | L2-Norm(final)=2.144 | 4323.9 samples/s | 67.6 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00001 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.831 | L2-Norm(final)=2.146 | 4281.8 samples/s | 66.9 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00001 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.795 | L2-Norm(final)=2.149 | 4161.7 samples/s | 65.0 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00001 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.759 | L2-Norm(final)=2.151 | 4282.1 samples/s | 66.9 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00001 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.723 | L2-Norm(final)=2.153 | 1973.1 samples/s | 30.8 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step3200.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00100, len=1
[Step=2401 Epoch= 9.2] | Loss=0.00001 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.843 | L2-Norm(final)=2.134 | 3886.7 samples/s | 60.7 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.00001 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=2.134 | 3968.2 samples/s | 62.0 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.00001 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=2.135 | 4155.6 samples/s | 64.9 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.00001 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.722 | L2-Norm(final)=2.136 | 4173.3 samples/s | 65.2 steps/s
[Step=2600 Epoch=10.0] | Loss=0.00001 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.681 | L2-Norm(final)=2.137 | 4181.5 samples/s | 65.3 steps/s
[Step=2650 Epoch=10.2] | Loss=0.00001 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.641 | L2-Norm(final)=2.139 | 5476.8 samples/s | 85.6 steps/s
[Step=2700 Epoch=10.4] | Loss=0.00001 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.600 | L2-Norm(final)=2.140 | 1812.9 samples/s | 28.3 steps/s
[Step=2750 Epoch=10.6] | Loss=0.00001 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.560 | L2-Norm(final)=2.141 | 4206.5 samples/s | 65.7 steps/s
[Step=2800 Epoch=10.8] | Loss=0.00001 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.519 | L2-Norm(final)=2.143 | 4259.0 samples/s | 66.5 steps/s
[Step=2850 Epoch=11.0] | Loss=0.00001 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=2.144 | 4413.1 samples/s | 69.0 steps/s
[Step=2900 Epoch=11.2] | Loss=0.00001 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.439 | L2-Norm(final)=2.146 | 5028.6 samples/s | 78.6 steps/s
[Step=2950 Epoch=11.4] | Loss=0.00001 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.399 | L2-Norm(final)=2.148 | 1927.0 samples/s | 30.1 steps/s
[Step=3000 Epoch=11.5] | Loss=0.00001 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=2.150 | 4374.0 samples/s | 68.3 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00001 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.320 | L2-Norm(final)=2.152 | 4367.5 samples/s | 68.2 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.280 | L2-Norm(final)=2.154 | 4406.6 samples/s | 68.9 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=2.155 | 4485.1 samples/s | 70.1 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00001 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.202 | L2-Norm(final)=2.156 | 2019.2 samples/s | 31.6 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step3200.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08755 | acc=0.9481 | tpr=0.9485 | fpr=0.0528 | 4225.8 samples/s | 16.5 steps/s
Avg test loss: 0.08914, Avg test acc: 0.94695, Avg tpr: 0.94830, Avg fpr: 0.05602, total FA: 437

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08097 | acc=0.9492 | tpr=0.9483 | fpr=0.0488 | 4130.3 samples/s | 16.1 steps/s
Avg test loss: 0.08427, Avg test acc: 0.94755, Avg tpr: 0.94737, Avg fpr: 0.05204, total FA: 406

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.03608 | acc=0.3146 | tpr=0.0103 | fpr=0.0245 | 4222.9 samples/s | 16.5 steps/s
Avg test loss: 6.06607, Avg test acc: 0.31208, Avg tpr: 0.01061, Avg fpr: 0.02487, total FA: 194

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.30154 | acc=0.3160 | tpr=0.0138 | fpr=0.0278 | 4271.8 samples/s | 16.7 steps/s
Avg test loss: 6.33462, Avg test acc: 0.31337, Avg tpr: 0.01323, Avg fpr: 0.02654, total FA: 207

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=2.66269 | acc=0.1884 | tpr=0.6681 | fpr=0.8202 | 4166.4 samples/s | 16.3 steps/s
[Step= 100] | Loss=2.63746 | acc=0.1907 | tpr=0.6418 | fpr=0.8177 | 7786.9 samples/s | 30.4 steps/s
[Step= 150] | Loss=2.65277 | acc=0.1907 | tpr=0.6599 | fpr=0.8179 | 7959.0 samples/s | 31.1 steps/s
[Step= 200] | Loss=2.65294 | acc=0.1915 | tpr=0.6503 | fpr=0.8169 | 7723.5 samples/s | 30.2 steps/s
[Step= 250] | Loss=2.65847 | acc=0.1918 | tpr=0.6463 | fpr=0.8165 | 7635.8 samples/s | 29.8 steps/s
[Step= 300] | Loss=2.65773 | acc=0.1914 | tpr=0.6524 | fpr=0.8170 | 7659.3 samples/s | 29.9 steps/s
[Step= 350] | Loss=2.65763 | acc=0.1916 | tpr=0.6531 | fpr=0.8168 | 7144.1 samples/s | 27.9 steps/s
[Step= 400] | Loss=2.65732 | acc=0.1919 | tpr=0.6510 | fpr=0.8164 | 7709.8 samples/s | 30.1 steps/s
[Step= 450] | Loss=2.65716 | acc=0.1921 | tpr=0.6573 | fpr=0.8163 | 7497.5 samples/s | 29.3 steps/s
[Step= 500] | Loss=2.65919 | acc=0.1914 | tpr=0.6564 | fpr=0.8170 | 7491.8 samples/s | 29.3 steps/s
[Step= 550] | Loss=2.65944 | acc=0.1914 | tpr=0.6594 | fpr=0.8171 | 13986.0 samples/s | 54.6 steps/s
Avg test loss: 2.66067, Avg test acc: 0.19124, Avg tpr: 0.65967, Avg fpr: 0.81728, total FA: 113477

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.22663 | acc=0.1737 | tpr=0.6858 | fpr=0.8355 | 3922.0 samples/s | 15.3 steps/s
[Step= 100] | Loss=3.21324 | acc=0.1718 | tpr=0.6738 | fpr=0.8375 | 7420.0 samples/s | 29.0 steps/s
[Step= 150] | Loss=3.20879 | acc=0.1715 | tpr=0.6657 | fpr=0.8376 | 7465.0 samples/s | 29.2 steps/s
[Step= 200] | Loss=3.20473 | acc=0.1724 | tpr=0.6699 | fpr=0.8366 | 8006.8 samples/s | 31.3 steps/s
[Step= 250] | Loss=3.20632 | acc=0.1728 | tpr=0.6672 | fpr=0.8362 | 7280.2 samples/s | 28.4 steps/s
[Step= 300] | Loss=3.20937 | acc=0.1720 | tpr=0.6589 | fpr=0.8368 | 7309.8 samples/s | 28.6 steps/s
[Step= 350] | Loss=3.20800 | acc=0.1716 | tpr=0.6619 | fpr=0.8373 | 7567.4 samples/s | 29.6 steps/s
[Step= 400] | Loss=3.20592 | acc=0.1721 | tpr=0.6679 | fpr=0.8369 | 7391.5 samples/s | 28.9 steps/s
[Step= 450] | Loss=3.20731 | acc=0.1724 | tpr=0.6694 | fpr=0.8366 | 7671.3 samples/s | 30.0 steps/s
[Step= 500] | Loss=3.21163 | acc=0.1716 | tpr=0.6692 | fpr=0.8373 | 7725.7 samples/s | 30.2 steps/s
[Step= 550] | Loss=3.21062 | acc=0.1715 | tpr=0.6709 | fpr=0.8376 | 14293.5 samples/s | 55.8 steps/s
Avg test loss: 3.21201, Avg test acc: 0.17131, Avg tpr: 0.67076, Avg fpr: 0.83777, total FA: 116323

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09969 | acc=0.9814 | tpr=0.9513 | fpr=0.0181 | 4137.9 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.10060 | acc=0.9807 | tpr=0.9574 | fpr=0.0188 | 8272.5 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.10494 | acc=0.9801 | tpr=0.9539 | fpr=0.0194 | 7807.1 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.10686 | acc=0.9800 | tpr=0.9519 | fpr=0.0195 | 7682.0 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.10535 | acc=0.9802 | tpr=0.9528 | fpr=0.0193 | 7912.3 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.10659 | acc=0.9799 | tpr=0.9498 | fpr=0.0196 | 7863.1 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.10739 | acc=0.9796 | tpr=0.9518 | fpr=0.0199 | 7686.6 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.10912 | acc=0.9793 | tpr=0.9464 | fpr=0.0201 | 8259.4 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.11096 | acc=0.9791 | tpr=0.9455 | fpr=0.0203 | 7459.3 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.11023 | acc=0.9792 | tpr=0.9463 | fpr=0.0202 | 8008.0 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.10947 | acc=0.9793 | tpr=0.9459 | fpr=0.0200 | 14669.1 samples/s | 57.3 steps/s
Avg test loss: 0.10927, Avg test acc: 0.97936, Avg tpr: 0.94572, Avg fpr: 0.02003, total FA: 2781

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.08200 | acc=0.9802 | tpr=0.9513 | fpr=0.0192 | 4186.4 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.08480 | acc=0.9796 | tpr=0.9659 | fpr=0.0201 | 7879.9 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.08824 | acc=0.9788 | tpr=0.9611 | fpr=0.0209 | 7630.6 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.08892 | acc=0.9788 | tpr=0.9607 | fpr=0.0209 | 7672.6 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.08797 | acc=0.9788 | tpr=0.9598 | fpr=0.0209 | 7227.7 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.08855 | acc=0.9788 | tpr=0.9607 | fpr=0.0209 | 7978.0 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.08889 | acc=0.9787 | tpr=0.9631 | fpr=0.0210 | 7143.4 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.08976 | acc=0.9785 | tpr=0.9617 | fpr=0.0212 | 8016.7 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.09134 | acc=0.9781 | tpr=0.9615 | fpr=0.0216 | 7168.9 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.09120 | acc=0.9781 | tpr=0.9621 | fpr=0.0216 | 7260.6 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.09028 | acc=0.9783 | tpr=0.9622 | fpr=0.0214 | 14533.4 samples/s | 56.8 steps/s
Avg test loss: 0.09015, Avg test acc: 0.97834, Avg tpr: 0.96197, Avg fpr: 0.02136, total FA: 2966

server round 4/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=3201 Epoch= 6.2] | Loss=0.02531 | Reg=0.00345 | acc=0.9844 | L2-Norm=18.570 | L2-Norm(final)=2.198 | 3660.4 samples/s | 57.2 steps/s
[Step=3250 Epoch= 6.3] | Loss=0.02782 | Reg=0.00346 | acc=0.9688 | L2-Norm=18.593 | L2-Norm(final)=2.202 | 4209.4 samples/s | 65.8 steps/s
[Step=3300 Epoch= 6.4] | Loss=0.02569 | Reg=0.00346 | acc=0.9844 | L2-Norm=18.602 | L2-Norm(final)=2.208 | 4446.9 samples/s | 69.5 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.02949 | Reg=0.00346 | acc=0.9688 | L2-Norm=18.603 | L2-Norm(final)=2.207 | 4465.2 samples/s | 69.8 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.02946 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.609 | L2-Norm(final)=2.206 | 4505.3 samples/s | 70.4 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.02851 | Reg=0.00346 | acc=0.9844 | L2-Norm=18.613 | L2-Norm(final)=2.206 | 4490.7 samples/s | 70.2 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.02911 | Reg=0.00347 | acc=0.9531 | L2-Norm=18.618 | L2-Norm(final)=2.206 | 4380.5 samples/s | 68.4 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.02910 | Reg=0.00347 | acc=0.9531 | L2-Norm=18.626 | L2-Norm(final)=2.207 | 4475.2 samples/s | 69.9 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.02934 | Reg=0.00347 | acc=0.9844 | L2-Norm=18.634 | L2-Norm(final)=2.206 | 4387.0 samples/s | 68.5 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.02930 | Reg=0.00348 | acc=0.9844 | L2-Norm=18.645 | L2-Norm(final)=2.205 | 4256.3 samples/s | 66.5 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.02939 | Reg=0.00348 | acc=0.9531 | L2-Norm=18.657 | L2-Norm(final)=2.204 | 5460.5 samples/s | 85.3 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.02931 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.669 | L2-Norm(final)=2.203 | 1818.8 samples/s | 28.4 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.02872 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.679 | L2-Norm(final)=2.203 | 4413.7 samples/s | 69.0 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.02843 | Reg=0.00349 | acc=0.9844 | L2-Norm=18.689 | L2-Norm(final)=2.202 | 4360.0 samples/s | 68.1 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.02848 | Reg=0.00350 | acc=0.9844 | L2-Norm=18.697 | L2-Norm(final)=2.201 | 4458.4 samples/s | 69.7 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.02852 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.704 | L2-Norm(final)=2.199 | 4467.5 samples/s | 69.8 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.02802 | Reg=0.00350 | acc=0.9688 | L2-Norm=18.713 | L2-Norm(final)=2.199 | 4440.6 samples/s | 69.4 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step4000.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00100, len=1
[Step=3201 Epoch= 6.3] | Loss=0.03074 | Reg=0.00346 | acc=0.9688 | L2-Norm=18.605 | L2-Norm(final)=2.134 | 4151.8 samples/s | 64.9 steps/s
[Step=3250 Epoch= 6.4] | Loss=0.02331 | Reg=0.00347 | acc=0.9844 | L2-Norm=18.615 | L2-Norm(final)=2.139 | 3830.2 samples/s | 59.8 steps/s
[Step=3300 Epoch= 6.5] | Loss=0.02328 | Reg=0.00347 | acc=0.9844 | L2-Norm=18.618 | L2-Norm(final)=2.143 | 4416.7 samples/s | 69.0 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.02368 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.619 | L2-Norm(final)=2.143 | 4432.9 samples/s | 69.3 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.02421 | Reg=0.00347 | acc=0.9844 | L2-Norm=18.622 | L2-Norm(final)=2.143 | 4467.5 samples/s | 69.8 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.02550 | Reg=0.00347 | acc=0.9531 | L2-Norm=18.626 | L2-Norm(final)=2.143 | 4468.1 samples/s | 69.8 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.02585 | Reg=0.00347 | acc=0.9844 | L2-Norm=18.633 | L2-Norm(final)=2.144 | 4531.7 samples/s | 70.8 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.02635 | Reg=0.00348 | acc=1.0000 | L2-Norm=18.644 | L2-Norm(final)=2.144 | 4618.4 samples/s | 72.2 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.02735 | Reg=0.00348 | acc=1.0000 | L2-Norm=18.657 | L2-Norm(final)=2.144 | 4621.8 samples/s | 72.2 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.02728 | Reg=0.00349 | acc=0.9688 | L2-Norm=18.668 | L2-Norm(final)=2.144 | 4538.5 samples/s | 70.9 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.02716 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.678 | L2-Norm(final)=2.144 | 5625.5 samples/s | 87.9 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.02682 | Reg=0.00349 | acc=0.9844 | L2-Norm=18.687 | L2-Norm(final)=2.144 | 1964.7 samples/s | 30.7 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.02630 | Reg=0.00350 | acc=0.9688 | L2-Norm=18.695 | L2-Norm(final)=2.145 | 4659.9 samples/s | 72.8 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.02595 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.702 | L2-Norm(final)=2.145 | 4600.7 samples/s | 71.9 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.02607 | Reg=0.00350 | acc=0.9844 | L2-Norm=18.708 | L2-Norm(final)=2.146 | 4521.2 samples/s | 70.6 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.02581 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.714 | L2-Norm(final)=2.146 | 4615.7 samples/s | 72.1 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.02642 | Reg=0.00350 | acc=0.9844 | L2-Norm=18.721 | L2-Norm(final)=2.145 | 4630.7 samples/s | 72.4 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step4000.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=3201 Epoch=12.3] | Loss=0.00000 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.143 | L2-Norm(final)=2.190 | 4188.7 samples/s | 65.4 steps/s
[Step=3250 Epoch=12.5] | Loss=0.00001 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.107 | L2-Norm(final)=2.193 | 4304.8 samples/s | 67.3 steps/s
[Step=3300 Epoch=12.6] | Loss=0.00001 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.072 | L2-Norm(final)=2.195 | 4305.2 samples/s | 67.3 steps/s
[Step=3350 Epoch=12.8] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.036 | L2-Norm(final)=2.197 | 4435.8 samples/s | 69.3 steps/s
[Step=3400 Epoch=13.0] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.000 | L2-Norm(final)=2.200 | 4424.7 samples/s | 69.1 steps/s
[Step=3450 Epoch=13.2] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.964 | L2-Norm(final)=2.204 | 5503.5 samples/s | 86.0 steps/s
[Step=3500 Epoch=13.4] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.928 | L2-Norm(final)=2.207 | 1888.6 samples/s | 29.5 steps/s
[Step=3550 Epoch=13.6] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.892 | L2-Norm(final)=2.211 | 4393.7 samples/s | 68.7 steps/s
[Step=3600 Epoch=13.8] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.856 | L2-Norm(final)=2.215 | 4360.4 samples/s | 68.1 steps/s
[Step=3650 Epoch=14.0] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.821 | L2-Norm(final)=2.219 | 4402.3 samples/s | 68.8 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.785 | L2-Norm(final)=2.223 | 4831.1 samples/s | 75.5 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.749 | L2-Norm(final)=2.227 | 1982.5 samples/s | 31.0 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.713 | L2-Norm(final)=2.231 | 4303.5 samples/s | 67.2 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.677 | L2-Norm(final)=2.236 | 4313.9 samples/s | 67.4 steps/s
[Step=3900 Epoch=14.9] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.642 | L2-Norm(final)=2.240 | 4360.6 samples/s | 68.1 steps/s
[Step=3950 Epoch=15.1] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.606 | L2-Norm(final)=2.245 | 4463.7 samples/s | 69.7 steps/s
[Step=4000 Epoch=15.3] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.570 | L2-Norm(final)=2.250 | 2023.3 samples/s | 31.6 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step4000.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00100, len=1
[Step=3201 Epoch=12.3] | Loss=0.00000 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.573 | L2-Norm(final)=2.181 | 3864.7 samples/s | 60.4 steps/s
[Step=3250 Epoch=12.5] | Loss=0.00001 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.535 | L2-Norm(final)=2.184 | 4208.4 samples/s | 65.8 steps/s
[Step=3300 Epoch=12.7] | Loss=0.00001 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=2.186 | 4397.8 samples/s | 68.7 steps/s
[Step=3350 Epoch=12.9] | Loss=0.00001 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.456 | L2-Norm(final)=2.189 | 4211.6 samples/s | 65.8 steps/s
[Step=3400 Epoch=13.1] | Loss=0.00001 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.418 | L2-Norm(final)=2.192 | 4213.4 samples/s | 65.8 steps/s
[Step=3450 Epoch=13.3] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.380 | L2-Norm(final)=2.195 | 5407.4 samples/s | 84.5 steps/s
[Step=3500 Epoch=13.5] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.342 | L2-Norm(final)=2.198 | 1834.7 samples/s | 28.7 steps/s
[Step=3550 Epoch=13.7] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=2.202 | 4245.0 samples/s | 66.3 steps/s
[Step=3600 Epoch=13.9] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.265 | L2-Norm(final)=2.205 | 4243.1 samples/s | 66.3 steps/s
[Step=3650 Epoch=14.1] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.227 | L2-Norm(final)=2.209 | 4228.3 samples/s | 66.1 steps/s
[Step=3700 Epoch=14.2] | Loss=0.01160 | Reg=0.00149 | acc=0.9531 | L2-Norm=12.212 | L2-Norm(final)=2.208 | 4750.3 samples/s | 74.2 steps/s
[Step=3750 Epoch=14.4] | Loss=0.01329 | Reg=0.00153 | acc=0.9688 | L2-Norm=12.359 | L2-Norm(final)=2.195 | 1801.8 samples/s | 28.2 steps/s
[Step=3800 Epoch=14.6] | Loss=0.01313 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.500 | L2-Norm(final)=2.184 | 4250.6 samples/s | 66.4 steps/s
[Step=3850 Epoch=14.8] | Loss=0.01262 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.621 | L2-Norm(final)=2.176 | 4246.2 samples/s | 66.3 steps/s
[Step=3900 Epoch=15.0] | Loss=0.01224 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.721 | L2-Norm(final)=2.169 | 4300.7 samples/s | 67.2 steps/s
[Step=3950 Epoch=15.2] | Loss=0.01171 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.806 | L2-Norm(final)=2.164 | 4434.0 samples/s | 69.3 steps/s
[Step=4000 Epoch=15.4] | Loss=0.01123 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.882 | L2-Norm(final)=2.160 | 2030.7 samples/s | 31.7 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step4000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08619 | acc=0.9529 | tpr=0.9596 | fpr=0.0617 | 4088.8 samples/s | 16.0 steps/s
Avg test loss: 0.08655, Avg test acc: 0.95216, Avg tpr: 0.95955, Avg fpr: 0.06409, total FA: 500

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08492 | acc=0.9506 | tpr=0.9657 | fpr=0.0820 | 4001.5 samples/s | 15.6 steps/s
Avg test loss: 0.08632, Avg test acc: 0.95096, Avg tpr: 0.96608, Avg fpr: 0.08230, total FA: 642

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.79086 | acc=0.3134 | tpr=0.0111 | fpr=0.0300 | 4016.9 samples/s | 15.7 steps/s
Avg test loss: 5.82044, Avg test acc: 0.31140, Avg tpr: 0.01189, Avg fpr: 0.02987, total FA: 233

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.67010 | acc=0.3151 | tpr=0.0007 | fpr=0.0022 | 3956.6 samples/s | 15.5 steps/s
Avg test loss: 6.70273, Avg test acc: 0.31265, Avg tpr: 0.00117, Avg fpr: 0.00231, total FA: 18

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.34874 | acc=0.1688 | tpr=0.7788 | fpr=0.8421 | 4141.3 samples/s | 16.2 steps/s
[Step= 100] | Loss=3.31920 | acc=0.1717 | tpr=0.7633 | fpr=0.8393 | 7933.8 samples/s | 31.0 steps/s
[Step= 150] | Loss=3.33820 | acc=0.1712 | tpr=0.7767 | fpr=0.8400 | 7805.1 samples/s | 30.5 steps/s
[Step= 200] | Loss=3.33815 | acc=0.1710 | tpr=0.7716 | fpr=0.8399 | 7795.0 samples/s | 30.4 steps/s
[Step= 250] | Loss=3.34597 | acc=0.1708 | tpr=0.7616 | fpr=0.8399 | 8075.4 samples/s | 31.5 steps/s
[Step= 300] | Loss=3.34650 | acc=0.1703 | tpr=0.7687 | fpr=0.8406 | 7863.2 samples/s | 30.7 steps/s
[Step= 350] | Loss=3.34575 | acc=0.1704 | tpr=0.7740 | fpr=0.8405 | 7920.7 samples/s | 30.9 steps/s
[Step= 400] | Loss=3.34595 | acc=0.1705 | tpr=0.7735 | fpr=0.8404 | 8166.5 samples/s | 31.9 steps/s
[Step= 450] | Loss=3.34670 | acc=0.1706 | tpr=0.7785 | fpr=0.8404 | 8023.4 samples/s | 31.3 steps/s
[Step= 500] | Loss=3.34940 | acc=0.1703 | tpr=0.7828 | fpr=0.8407 | 7447.0 samples/s | 29.1 steps/s
[Step= 550] | Loss=3.35057 | acc=0.1703 | tpr=0.7875 | fpr=0.8410 | 15382.4 samples/s | 60.1 steps/s
Avg test loss: 3.35216, Avg test acc: 0.17014, Avg tpr: 0.78803, Avg fpr: 0.84109, total FA: 116784

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.18174 | acc=0.1320 | tpr=0.8496 | fpr=0.8809 | 4167.9 samples/s | 16.3 steps/s
[Step= 100] | Loss=4.15909 | acc=0.1336 | tpr=0.8273 | fpr=0.8793 | 7991.4 samples/s | 31.2 steps/s
[Step= 150] | Loss=4.15359 | acc=0.1341 | tpr=0.8112 | fpr=0.8783 | 8530.3 samples/s | 33.3 steps/s
[Step= 200] | Loss=4.14684 | acc=0.1346 | tpr=0.8087 | fpr=0.8777 | 7341.9 samples/s | 28.7 steps/s
[Step= 250] | Loss=4.14631 | acc=0.1342 | tpr=0.8017 | fpr=0.8780 | 8144.5 samples/s | 31.8 steps/s
[Step= 300] | Loss=4.15023 | acc=0.1335 | tpr=0.7956 | fpr=0.8785 | 7308.5 samples/s | 28.5 steps/s
[Step= 350] | Loss=4.14895 | acc=0.1331 | tpr=0.7996 | fpr=0.8790 | 7541.7 samples/s | 29.5 steps/s
[Step= 400] | Loss=4.14850 | acc=0.1334 | tpr=0.8025 | fpr=0.8787 | 7390.5 samples/s | 28.9 steps/s
[Step= 450] | Loss=4.15084 | acc=0.1336 | tpr=0.8014 | fpr=0.8785 | 7607.5 samples/s | 29.7 steps/s
[Step= 500] | Loss=4.15625 | acc=0.1329 | tpr=0.7996 | fpr=0.8791 | 7389.2 samples/s | 28.9 steps/s
[Step= 550] | Loss=4.15519 | acc=0.1326 | tpr=0.7975 | fpr=0.8795 | 13829.7 samples/s | 54.0 steps/s
Avg test loss: 4.15643, Avg test acc: 0.13248, Avg tpr: 0.79754, Avg fpr: 0.87961, total FA: 122132

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10976 | acc=0.9802 | tpr=0.9513 | fpr=0.0193 | 4171.8 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.11105 | acc=0.9798 | tpr=0.9574 | fpr=0.0198 | 7110.0 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.11576 | acc=0.9790 | tpr=0.9553 | fpr=0.0206 | 7426.8 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.11796 | acc=0.9789 | tpr=0.9530 | fpr=0.0206 | 7373.6 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.11630 | acc=0.9791 | tpr=0.9546 | fpr=0.0204 | 7379.4 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.11765 | acc=0.9788 | tpr=0.9527 | fpr=0.0208 | 7500.1 samples/s | 29.3 steps/s
[Step= 350] | Loss=0.11860 | acc=0.9784 | tpr=0.9549 | fpr=0.0211 | 7287.2 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.12031 | acc=0.9783 | tpr=0.9497 | fpr=0.0212 | 7456.7 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.12240 | acc=0.9781 | tpr=0.9484 | fpr=0.0214 | 7605.0 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.12165 | acc=0.9782 | tpr=0.9493 | fpr=0.0213 | 7074.0 samples/s | 27.6 steps/s
[Step= 550] | Loss=0.12081 | acc=0.9783 | tpr=0.9487 | fpr=0.0211 | 14246.5 samples/s | 55.7 steps/s
Avg test loss: 0.12058, Avg test acc: 0.97836, Avg tpr: 0.94849, Avg fpr: 0.02110, total FA: 2929

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.07255 | acc=0.9795 | tpr=0.9381 | fpr=0.0198 | 4065.5 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.07384 | acc=0.9790 | tpr=0.9552 | fpr=0.0205 | 7960.0 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.07733 | acc=0.9785 | tpr=0.9553 | fpr=0.0211 | 7966.8 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.07808 | acc=0.9784 | tpr=0.9596 | fpr=0.0213 | 7353.9 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.07670 | acc=0.9786 | tpr=0.9563 | fpr=0.0210 | 8087.4 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.07800 | acc=0.9783 | tpr=0.9535 | fpr=0.0212 | 7651.9 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.07887 | acc=0.9780 | tpr=0.9537 | fpr=0.0216 | 7792.3 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.07969 | acc=0.9779 | tpr=0.9519 | fpr=0.0217 | 7746.0 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.08148 | acc=0.9774 | tpr=0.9503 | fpr=0.0221 | 8033.0 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.08096 | acc=0.9777 | tpr=0.9520 | fpr=0.0219 | 7520.5 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.08030 | acc=0.9778 | tpr=0.9519 | fpr=0.0218 | 14203.2 samples/s | 55.5 steps/s
Avg test loss: 0.08019, Avg test acc: 0.97777, Avg tpr: 0.95166, Avg fpr: 0.02175, total FA: 3020

server round 5/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.03601 | Reg=0.00356 | acc=0.9844 | L2-Norm=18.858 | L2-Norm(final)=2.210 | 3830.8 samples/s | 59.9 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.02155 | Reg=0.00356 | acc=0.9844 | L2-Norm=18.869 | L2-Norm(final)=2.212 | 4236.3 samples/s | 66.2 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.02082 | Reg=0.00356 | acc=0.9844 | L2-Norm=18.878 | L2-Norm(final)=2.213 | 4611.5 samples/s | 72.1 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.02238 | Reg=0.00357 | acc=1.0000 | L2-Norm=18.887 | L2-Norm(final)=2.213 | 4557.5 samples/s | 71.2 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.02302 | Reg=0.00357 | acc=0.9844 | L2-Norm=18.897 | L2-Norm(final)=2.216 | 4644.2 samples/s | 72.6 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.02413 | Reg=0.00357 | acc=0.9844 | L2-Norm=18.905 | L2-Norm(final)=2.216 | 4502.9 samples/s | 70.4 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.02416 | Reg=0.00358 | acc=1.0000 | L2-Norm=18.916 | L2-Norm(final)=2.215 | 4608.5 samples/s | 72.0 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.02498 | Reg=0.00358 | acc=0.9688 | L2-Norm=18.930 | L2-Norm(final)=2.215 | 4536.9 samples/s | 70.9 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.02503 | Reg=0.00359 | acc=0.9375 | L2-Norm=18.945 | L2-Norm(final)=2.215 | 4693.7 samples/s | 73.3 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.02533 | Reg=0.00359 | acc=0.9375 | L2-Norm=18.959 | L2-Norm(final)=2.215 | 4494.0 samples/s | 70.2 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.02540 | Reg=0.00360 | acc=0.9688 | L2-Norm=18.971 | L2-Norm(final)=2.214 | 5448.4 samples/s | 85.1 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.02474 | Reg=0.00360 | acc=0.9531 | L2-Norm=18.983 | L2-Norm(final)=2.215 | 1915.6 samples/s | 29.9 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.02449 | Reg=0.00361 | acc=1.0000 | L2-Norm=18.993 | L2-Norm(final)=2.216 | 4477.7 samples/s | 70.0 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.02425 | Reg=0.00361 | acc=0.9844 | L2-Norm=19.004 | L2-Norm(final)=2.218 | 4534.9 samples/s | 70.9 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.02419 | Reg=0.00362 | acc=0.9844 | L2-Norm=19.015 | L2-Norm(final)=2.219 | 4508.1 samples/s | 70.4 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.02456 | Reg=0.00362 | acc=1.0000 | L2-Norm=19.026 | L2-Norm(final)=2.219 | 4564.1 samples/s | 71.3 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.02443 | Reg=0.00362 | acc=0.9531 | L2-Norm=19.038 | L2-Norm(final)=2.219 | 4440.9 samples/s | 69.4 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step4800.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.00865 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.854 | L2-Norm(final)=2.124 | 4217.7 samples/s | 65.9 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.02123 | Reg=0.00356 | acc=0.9688 | L2-Norm=18.873 | L2-Norm(final)=2.122 | 4056.1 samples/s | 63.4 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.02020 | Reg=0.00356 | acc=1.0000 | L2-Norm=18.875 | L2-Norm(final)=2.126 | 4408.8 samples/s | 68.9 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.02057 | Reg=0.00356 | acc=1.0000 | L2-Norm=18.876 | L2-Norm(final)=2.130 | 4443.3 samples/s | 69.4 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.02093 | Reg=0.00356 | acc=1.0000 | L2-Norm=18.878 | L2-Norm(final)=2.130 | 4510.1 samples/s | 70.5 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.02160 | Reg=0.00357 | acc=0.9688 | L2-Norm=18.884 | L2-Norm(final)=2.132 | 4556.2 samples/s | 71.2 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.02235 | Reg=0.00357 | acc=0.9688 | L2-Norm=18.891 | L2-Norm(final)=2.135 | 4601.9 samples/s | 71.9 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.02313 | Reg=0.00357 | acc=0.9844 | L2-Norm=18.899 | L2-Norm(final)=2.136 | 4635.1 samples/s | 72.4 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.02339 | Reg=0.00358 | acc=1.0000 | L2-Norm=18.908 | L2-Norm(final)=2.136 | 4626.6 samples/s | 72.3 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.02321 | Reg=0.00358 | acc=1.0000 | L2-Norm=18.917 | L2-Norm(final)=2.137 | 4654.6 samples/s | 72.7 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.02326 | Reg=0.00358 | acc=0.9844 | L2-Norm=18.925 | L2-Norm(final)=2.137 | 5590.9 samples/s | 87.4 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.02275 | Reg=0.00358 | acc=1.0000 | L2-Norm=18.933 | L2-Norm(final)=2.138 | 1930.0 samples/s | 30.2 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.02279 | Reg=0.00359 | acc=0.9844 | L2-Norm=18.942 | L2-Norm(final)=2.139 | 4548.5 samples/s | 71.1 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.02250 | Reg=0.00359 | acc=0.9688 | L2-Norm=18.952 | L2-Norm(final)=2.139 | 4488.4 samples/s | 70.1 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.02264 | Reg=0.00360 | acc=0.9531 | L2-Norm=18.962 | L2-Norm(final)=2.140 | 4392.7 samples/s | 68.6 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.02238 | Reg=0.00360 | acc=0.9844 | L2-Norm=18.972 | L2-Norm(final)=2.141 | 4296.1 samples/s | 67.1 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.02264 | Reg=0.00360 | acc=0.9844 | L2-Norm=18.984 | L2-Norm(final)=2.141 | 4373.0 samples/s | 68.3 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step4800.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=4001 Epoch=15.3] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.999 | L2-Norm(final)=2.328 | 3856.9 samples/s | 60.3 steps/s
[Step=4050 Epoch=15.5] | Loss=0.00001 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.964 | L2-Norm(final)=2.333 | 4066.8 samples/s | 63.5 steps/s
[Step=4100 Epoch=15.7] | Loss=0.00001 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.929 | L2-Norm(final)=2.339 | 4199.4 samples/s | 65.6 steps/s
[Step=4150 Epoch=15.9] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.894 | L2-Norm(final)=2.345 | 4105.6 samples/s | 64.2 steps/s
[Step=4200 Epoch=16.1] | Loss=0.00000 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.858 | L2-Norm(final)=2.352 | 4230.7 samples/s | 66.1 steps/s
[Step=4250 Epoch=16.3] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.822 | L2-Norm(final)=2.358 | 5198.2 samples/s | 81.2 steps/s
[Step=4300 Epoch=16.5] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.787 | L2-Norm(final)=2.365 | 1818.7 samples/s | 28.4 steps/s
[Step=4350 Epoch=16.7] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.751 | L2-Norm(final)=2.371 | 4093.9 samples/s | 64.0 steps/s
[Step=4400 Epoch=16.9] | Loss=0.00000 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.716 | L2-Norm(final)=2.378 | 4077.8 samples/s | 63.7 steps/s
[Step=4450 Epoch=17.1] | Loss=0.00000 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.680 | L2-Norm(final)=2.386 | 4230.8 samples/s | 66.1 steps/s
[Step=4500 Epoch=17.2] | Loss=0.00000 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.645 | L2-Norm(final)=2.394 | 4557.1 samples/s | 71.2 steps/s
[Step=4550 Epoch=17.4] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.610 | L2-Norm(final)=2.401 | 1967.2 samples/s | 30.7 steps/s
[Step=4600 Epoch=17.6] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.575 | L2-Norm(final)=2.409 | 4330.0 samples/s | 67.7 steps/s
[Step=4650 Epoch=17.8] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.540 | L2-Norm(final)=2.417 | 4378.0 samples/s | 68.4 steps/s
[Step=4700 Epoch=18.0] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.505 | L2-Norm(final)=2.425 | 4252.3 samples/s | 66.4 steps/s
[Step=4750 Epoch=18.2] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.470 | L2-Norm(final)=2.433 | 4320.2 samples/s | 67.5 steps/s
[Step=4800 Epoch=18.4] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.435 | L2-Norm(final)=2.442 | 2070.3 samples/s | 32.3 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step4800.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00100, len=1
[Step=4001 Epoch=15.4] | Loss=0.00042 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.997 | L2-Norm(final)=2.096 | 4031.8 samples/s | 63.0 steps/s
[Step=4050 Epoch=15.6] | Loss=0.00129 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.996 | L2-Norm(final)=2.100 | 3868.2 samples/s | 60.4 steps/s
[Step=4100 Epoch=15.8] | Loss=0.00084 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.988 | L2-Norm(final)=2.105 | 4256.6 samples/s | 66.5 steps/s
[Step=4150 Epoch=16.0] | Loss=0.00089 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.981 | L2-Norm(final)=2.108 | 4475.2 samples/s | 69.9 steps/s
[Step=4200 Epoch=16.2] | Loss=0.00082 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.972 | L2-Norm(final)=2.111 | 4371.8 samples/s | 68.3 steps/s
[Step=4250 Epoch=16.4] | Loss=0.00102 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.963 | L2-Norm(final)=2.114 | 5640.9 samples/s | 88.1 steps/s
[Step=4300 Epoch=16.6] | Loss=0.00089 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.949 | L2-Norm(final)=2.116 | 1813.8 samples/s | 28.3 steps/s
[Step=4350 Epoch=16.7] | Loss=0.00082 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.936 | L2-Norm(final)=2.117 | 4318.7 samples/s | 67.5 steps/s
[Step=4400 Epoch=16.9] | Loss=0.00076 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.923 | L2-Norm(final)=2.119 | 4441.5 samples/s | 69.4 steps/s
[Step=4450 Epoch=17.1] | Loss=0.00068 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.910 | L2-Norm(final)=2.121 | 4424.1 samples/s | 69.1 steps/s
[Step=4500 Epoch=17.3] | Loss=0.00062 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.896 | L2-Norm(final)=2.123 | 4913.4 samples/s | 76.8 steps/s
[Step=4550 Epoch=17.5] | Loss=0.00057 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.881 | L2-Norm(final)=2.124 | 1902.6 samples/s | 29.7 steps/s
[Step=4600 Epoch=17.7] | Loss=0.00052 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.865 | L2-Norm(final)=2.125 | 4344.2 samples/s | 67.9 steps/s
[Step=4650 Epoch=17.9] | Loss=0.00048 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.849 | L2-Norm(final)=2.126 | 4476.1 samples/s | 69.9 steps/s
[Step=4700 Epoch=18.1] | Loss=0.00045 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.833 | L2-Norm(final)=2.128 | 4376.1 samples/s | 68.4 steps/s
[Step=4750 Epoch=18.3] | Loss=0.00042 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.816 | L2-Norm(final)=2.129 | 4352.2 samples/s | 68.0 steps/s
[Step=4800 Epoch=18.5] | Loss=0.00040 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.800 | L2-Norm(final)=2.129 | 2030.5 samples/s | 31.7 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step4800.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09644 | acc=0.9478 | tpr=0.9490 | fpr=0.0548 | 4220.8 samples/s | 16.5 steps/s
Avg test loss: 0.09858, Avg test acc: 0.94799, Avg tpr: 0.94947, Avg fpr: 0.05525, total FA: 431

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09532 | acc=0.9466 | tpr=0.9663 | fpr=0.0961 | 4235.1 samples/s | 16.5 steps/s
Avg test loss: 0.09606, Avg test acc: 0.94655, Avg tpr: 0.96590, Avg fpr: 0.09601, total FA: 749

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.57548 | acc=0.3138 | tpr=0.0110 | fpr=0.0285 | 4091.6 samples/s | 16.0 steps/s
Avg test loss: 5.60506, Avg test acc: 0.31160, Avg tpr: 0.01177, Avg fpr: 0.02897, total FA: 226

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=9.32504 | acc=0.3155 | tpr=0.0006 | fpr=0.0007 | 4152.2 samples/s | 16.2 steps/s
Avg test loss: 9.37793, Avg test acc: 0.31281, Avg tpr: 0.00076, Avg fpr: 0.00090, total FA: 7

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.61317 | acc=0.1848 | tpr=0.7257 | fpr=0.8249 | 4078.6 samples/s | 15.9 steps/s
[Step= 100] | Loss=3.58973 | acc=0.1845 | tpr=0.6908 | fpr=0.8250 | 7835.8 samples/s | 30.6 steps/s
[Step= 150] | Loss=3.61180 | acc=0.1831 | tpr=0.6945 | fpr=0.8263 | 7768.8 samples/s | 30.3 steps/s
[Step= 200] | Loss=3.61082 | acc=0.1831 | tpr=0.6863 | fpr=0.8260 | 7443.2 samples/s | 29.1 steps/s
[Step= 250] | Loss=3.61890 | acc=0.1825 | tpr=0.6725 | fpr=0.8264 | 7702.4 samples/s | 30.1 steps/s
[Step= 300] | Loss=3.61823 | acc=0.1821 | tpr=0.6764 | fpr=0.8270 | 7373.4 samples/s | 28.8 steps/s
[Step= 350] | Loss=3.61636 | acc=0.1824 | tpr=0.6744 | fpr=0.8265 | 7600.3 samples/s | 29.7 steps/s
[Step= 400] | Loss=3.61608 | acc=0.1826 | tpr=0.6789 | fpr=0.8264 | 7503.2 samples/s | 29.3 steps/s
[Step= 450] | Loss=3.61395 | acc=0.1825 | tpr=0.6792 | fpr=0.8265 | 7895.6 samples/s | 30.8 steps/s
[Step= 500] | Loss=3.61666 | acc=0.1819 | tpr=0.6819 | fpr=0.8272 | 7228.7 samples/s | 28.2 steps/s
[Step= 550] | Loss=3.61816 | acc=0.1820 | tpr=0.6864 | fpr=0.8271 | 13284.3 samples/s | 51.9 steps/s
Avg test loss: 3.62033, Avg test acc: 0.18187, Avg tpr: 0.68661, Avg fpr: 0.82730, total FA: 114869

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.71657 | acc=0.1255 | tpr=0.8584 | fpr=0.8877 | 4103.0 samples/s | 16.0 steps/s
[Step= 100] | Loss=4.69215 | acc=0.1247 | tpr=0.8337 | fpr=0.8885 | 7754.8 samples/s | 30.3 steps/s
[Step= 150] | Loss=4.68550 | acc=0.1249 | tpr=0.8184 | fpr=0.8878 | 7759.3 samples/s | 30.3 steps/s
[Step= 200] | Loss=4.67520 | acc=0.1259 | tpr=0.8131 | fpr=0.8866 | 7855.5 samples/s | 30.7 steps/s
[Step= 250] | Loss=4.67950 | acc=0.1256 | tpr=0.8070 | fpr=0.8869 | 8249.6 samples/s | 32.2 steps/s
[Step= 300] | Loss=4.68335 | acc=0.1256 | tpr=0.8007 | fpr=0.8867 | 7302.8 samples/s | 28.5 steps/s
[Step= 350] | Loss=4.68070 | acc=0.1255 | tpr=0.8015 | fpr=0.8868 | 8172.8 samples/s | 31.9 steps/s
[Step= 400] | Loss=4.68004 | acc=0.1254 | tpr=0.8042 | fpr=0.8870 | 7691.8 samples/s | 30.0 steps/s
[Step= 450] | Loss=4.68033 | acc=0.1259 | tpr=0.8043 | fpr=0.8865 | 7706.3 samples/s | 30.1 steps/s
[Step= 500] | Loss=4.68748 | acc=0.1253 | tpr=0.8057 | fpr=0.8870 | 8209.0 samples/s | 32.1 steps/s
[Step= 550] | Loss=4.68645 | acc=0.1255 | tpr=0.8070 | fpr=0.8869 | 14345.5 samples/s | 56.0 steps/s
Avg test loss: 4.68818, Avg test acc: 0.12533, Avg tpr: 0.80745, Avg fpr: 0.88707, total FA: 123168

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12029 | acc=0.9788 | tpr=0.9513 | fpr=0.0207 | 4129.7 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.12206 | acc=0.9786 | tpr=0.9574 | fpr=0.0210 | 7654.6 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.12714 | acc=0.9779 | tpr=0.9568 | fpr=0.0217 | 7719.8 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.12956 | acc=0.9780 | tpr=0.9585 | fpr=0.0216 | 8203.7 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.12775 | acc=0.9782 | tpr=0.9590 | fpr=0.0214 | 7730.7 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.12918 | acc=0.9779 | tpr=0.9564 | fpr=0.0217 | 7896.6 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.13016 | acc=0.9776 | tpr=0.9593 | fpr=0.0221 | 7859.0 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.13192 | acc=0.9774 | tpr=0.9546 | fpr=0.0222 | 7473.5 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.13423 | acc=0.9772 | tpr=0.9528 | fpr=0.0223 | 7508.8 samples/s | 29.3 steps/s
[Step= 500] | Loss=0.13348 | acc=0.9773 | tpr=0.9533 | fpr=0.0223 | 7397.1 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.13256 | acc=0.9775 | tpr=0.9538 | fpr=0.0221 | 13685.1 samples/s | 53.5 steps/s
Avg test loss: 0.13229, Avg test acc: 0.97749, Avg tpr: 0.95365, Avg fpr: 0.02207, total FA: 3065

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.08696 | acc=0.9826 | tpr=0.9292 | fpr=0.0165 | 4055.0 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.08800 | acc=0.9820 | tpr=0.9488 | fpr=0.0174 | 7893.2 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.09199 | acc=0.9815 | tpr=0.9510 | fpr=0.0180 | 7828.8 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.09318 | acc=0.9812 | tpr=0.9497 | fpr=0.0182 | 7676.3 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.09172 | acc=0.9815 | tpr=0.9502 | fpr=0.0179 | 7668.1 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.09365 | acc=0.9812 | tpr=0.9462 | fpr=0.0181 | 8075.9 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.09428 | acc=0.9810 | tpr=0.9461 | fpr=0.0183 | 7741.3 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.09519 | acc=0.9809 | tpr=0.9447 | fpr=0.0184 | 7517.7 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.09724 | acc=0.9807 | tpr=0.9435 | fpr=0.0186 | 7264.1 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.09668 | acc=0.9808 | tpr=0.9458 | fpr=0.0186 | 7373.0 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.09593 | acc=0.9809 | tpr=0.9463 | fpr=0.0184 | 13958.9 samples/s | 54.5 steps/s
Avg test loss: 0.09582, Avg test acc: 0.98095, Avg tpr: 0.94612, Avg fpr: 0.01842, total FA: 2557

server round 6/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=4801 Epoch= 9.4] | Loss=0.02319 | Reg=0.00370 | acc=0.9844 | L2-Norm=19.224 | L2-Norm(final)=2.222 | 4157.2 samples/s | 65.0 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.02336 | Reg=0.00370 | acc=0.9844 | L2-Norm=19.235 | L2-Norm(final)=2.219 | 3646.6 samples/s | 57.0 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.02013 | Reg=0.00370 | acc=0.9688 | L2-Norm=19.240 | L2-Norm(final)=2.222 | 4399.1 samples/s | 68.7 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.02041 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.242 | L2-Norm(final)=2.224 | 4438.9 samples/s | 69.4 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.02016 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.246 | L2-Norm(final)=2.224 | 4571.6 samples/s | 71.4 steps/s
[Step=5050 Epoch= 9.8] | Loss=0.02091 | Reg=0.00371 | acc=0.9844 | L2-Norm=19.250 | L2-Norm(final)=2.225 | 4430.3 samples/s | 69.2 steps/s
[Step=5100 Epoch= 9.9] | Loss=0.02219 | Reg=0.00371 | acc=0.9688 | L2-Norm=19.256 | L2-Norm(final)=2.225 | 4455.0 samples/s | 69.6 steps/s
[Step=5150 Epoch=10.0] | Loss=0.02254 | Reg=0.00371 | acc=0.9531 | L2-Norm=19.266 | L2-Norm(final)=2.224 | 4537.1 samples/s | 70.9 steps/s
[Step=5200 Epoch=10.1] | Loss=0.02307 | Reg=0.00372 | acc=0.9844 | L2-Norm=19.276 | L2-Norm(final)=2.223 | 4506.1 samples/s | 70.4 steps/s
[Step=5250 Epoch=10.2] | Loss=0.02344 | Reg=0.00372 | acc=0.9844 | L2-Norm=19.289 | L2-Norm(final)=2.221 | 4687.9 samples/s | 73.2 steps/s
[Step=5300 Epoch=10.3] | Loss=0.02385 | Reg=0.00373 | acc=1.0000 | L2-Norm=19.302 | L2-Norm(final)=2.219 | 5670.2 samples/s | 88.6 steps/s
[Step=5350 Epoch=10.4] | Loss=0.02291 | Reg=0.00373 | acc=1.0000 | L2-Norm=19.314 | L2-Norm(final)=2.219 | 1904.4 samples/s | 29.8 steps/s
[Step=5400 Epoch=10.5] | Loss=0.02277 | Reg=0.00373 | acc=0.9844 | L2-Norm=19.324 | L2-Norm(final)=2.218 | 4586.3 samples/s | 71.7 steps/s
[Step=5450 Epoch=10.6] | Loss=0.02239 | Reg=0.00374 | acc=0.9844 | L2-Norm=19.334 | L2-Norm(final)=2.217 | 4528.9 samples/s | 70.8 steps/s
[Step=5500 Epoch=10.7] | Loss=0.02222 | Reg=0.00374 | acc=0.9844 | L2-Norm=19.344 | L2-Norm(final)=2.217 | 4678.1 samples/s | 73.1 steps/s
[Step=5550 Epoch=10.8] | Loss=0.02229 | Reg=0.00375 | acc=0.9844 | L2-Norm=19.353 | L2-Norm(final)=2.217 | 4746.6 samples/s | 74.2 steps/s
[Step=5600 Epoch=10.9] | Loss=0.02215 | Reg=0.00375 | acc=0.9844 | L2-Norm=19.364 | L2-Norm(final)=2.218 | 4595.0 samples/s | 71.8 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step5600.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00100, len=1
[Step=4801 Epoch= 9.4] | Loss=0.01875 | Reg=0.00368 | acc=0.9844 | L2-Norm=19.173 | L2-Norm(final)=2.136 | 4051.1 samples/s | 63.3 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.02320 | Reg=0.00368 | acc=1.0000 | L2-Norm=19.173 | L2-Norm(final)=2.130 | 4304.4 samples/s | 67.3 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.02094 | Reg=0.00368 | acc=1.0000 | L2-Norm=19.181 | L2-Norm(final)=2.139 | 4619.0 samples/s | 72.2 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.02231 | Reg=0.00368 | acc=1.0000 | L2-Norm=19.192 | L2-Norm(final)=2.140 | 4631.8 samples/s | 72.4 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.02334 | Reg=0.00369 | acc=0.9688 | L2-Norm=19.201 | L2-Norm(final)=2.139 | 4635.3 samples/s | 72.4 steps/s
[Step=5050 Epoch= 9.9] | Loss=0.02393 | Reg=0.00369 | acc=0.9844 | L2-Norm=19.212 | L2-Norm(final)=2.135 | 4605.7 samples/s | 72.0 steps/s
[Step=5100 Epoch=10.0] | Loss=0.02480 | Reg=0.00370 | acc=0.9844 | L2-Norm=19.225 | L2-Norm(final)=2.133 | 4529.4 samples/s | 70.8 steps/s
[Step=5150 Epoch=10.1] | Loss=0.02446 | Reg=0.00370 | acc=0.9688 | L2-Norm=19.241 | L2-Norm(final)=2.132 | 4578.0 samples/s | 71.5 steps/s
[Step=5200 Epoch=10.2] | Loss=0.02469 | Reg=0.00371 | acc=1.0000 | L2-Norm=19.258 | L2-Norm(final)=2.131 | 4608.9 samples/s | 72.0 steps/s
[Step=5250 Epoch=10.3] | Loss=0.02482 | Reg=0.00372 | acc=0.9688 | L2-Norm=19.275 | L2-Norm(final)=2.130 | 4639.5 samples/s | 72.5 steps/s
[Step=5300 Epoch=10.4] | Loss=0.02460 | Reg=0.00372 | acc=0.9688 | L2-Norm=19.291 | L2-Norm(final)=2.129 | 5734.4 samples/s | 89.6 steps/s
[Step=5350 Epoch=10.5] | Loss=0.02500 | Reg=0.00373 | acc=1.0000 | L2-Norm=19.307 | L2-Norm(final)=2.126 | 1905.6 samples/s | 29.8 steps/s
[Step=5400 Epoch=10.6] | Loss=0.02476 | Reg=0.00373 | acc=1.0000 | L2-Norm=19.322 | L2-Norm(final)=2.125 | 4614.2 samples/s | 72.1 steps/s
[Step=5450 Epoch=10.7] | Loss=0.02409 | Reg=0.00374 | acc=0.9844 | L2-Norm=19.336 | L2-Norm(final)=2.124 | 4658.7 samples/s | 72.8 steps/s
[Step=5500 Epoch=10.8] | Loss=0.02374 | Reg=0.00374 | acc=1.0000 | L2-Norm=19.349 | L2-Norm(final)=2.124 | 4610.7 samples/s | 72.0 steps/s
[Step=5550 Epoch=10.9] | Loss=0.02337 | Reg=0.00375 | acc=0.9688 | L2-Norm=19.364 | L2-Norm(final)=2.124 | 4617.7 samples/s | 72.2 steps/s
[Step=5600 Epoch=10.9] | Loss=0.02359 | Reg=0.00376 | acc=0.9375 | L2-Norm=19.378 | L2-Norm(final)=2.124 | 4672.6 samples/s | 73.0 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step5600.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=4801 Epoch=18.4] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=2.578 | 4021.1 samples/s | 62.8 steps/s
[Step=4850 Epoch=18.6] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.843 | L2-Norm(final)=2.584 | 4060.4 samples/s | 63.4 steps/s
[Step=4900 Epoch=18.8] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.809 | L2-Norm(final)=2.591 | 4428.5 samples/s | 69.2 steps/s
[Step=4950 Epoch=19.0] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.774 | L2-Norm(final)=2.599 | 4483.6 samples/s | 70.1 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.738 | L2-Norm(final)=2.606 | 4384.8 samples/s | 68.5 steps/s
[Step=5050 Epoch=19.3] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.703 | L2-Norm(final)=2.615 | 5458.7 samples/s | 85.3 steps/s
[Step=5100 Epoch=19.5] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.668 | L2-Norm(final)=2.623 | 1783.2 samples/s | 27.9 steps/s
[Step=5150 Epoch=19.7] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.633 | L2-Norm(final)=2.631 | 4221.0 samples/s | 66.0 steps/s
[Step=5200 Epoch=19.9] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.598 | L2-Norm(final)=2.640 | 4369.5 samples/s | 68.3 steps/s
[Step=5250 Epoch=20.1] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.563 | L2-Norm(final)=2.650 | 4297.0 samples/s | 67.1 steps/s
[Step=5300 Epoch=20.3] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.528 | L2-Norm(final)=2.659 | 4847.8 samples/s | 75.7 steps/s
[Step=5350 Epoch=20.5] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.494 | L2-Norm(final)=2.669 | 1911.7 samples/s | 29.9 steps/s
[Step=5400 Epoch=20.7] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.459 | L2-Norm(final)=2.679 | 4311.1 samples/s | 67.4 steps/s
[Step=5450 Epoch=20.9] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.424 | L2-Norm(final)=2.688 | 4207.8 samples/s | 65.7 steps/s
[Step=5500 Epoch=21.1] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.390 | L2-Norm(final)=2.698 | 4288.5 samples/s | 67.0 steps/s
[Step=5550 Epoch=21.3] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.355 | L2-Norm(final)=2.708 | 4290.1 samples/s | 67.0 steps/s
[Step=5600 Epoch=21.5] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.321 | L2-Norm(final)=2.719 | 2012.1 samples/s | 31.4 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step5600.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00100, len=1
[Step=4801 Epoch=18.5] | Loss=0.00016 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.534 | L2-Norm(final)=2.144 | 3965.7 samples/s | 62.0 steps/s
[Step=4850 Epoch=18.7] | Loss=0.00002 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.516 | L2-Norm(final)=2.145 | 4065.5 samples/s | 63.5 steps/s
[Step=4900 Epoch=18.9] | Loss=0.00002 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.497 | L2-Norm(final)=2.145 | 4319.0 samples/s | 67.5 steps/s
[Step=4950 Epoch=19.1] | Loss=0.00002 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.480 | L2-Norm(final)=2.146 | 4304.2 samples/s | 67.3 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.463 | L2-Norm(final)=2.147 | 4289.0 samples/s | 67.0 steps/s
[Step=5050 Epoch=19.4] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.445 | L2-Norm(final)=2.150 | 5313.4 samples/s | 83.0 steps/s
[Step=5100 Epoch=19.6] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.428 | L2-Norm(final)=2.152 | 1796.7 samples/s | 28.1 steps/s
[Step=5150 Epoch=19.8] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.410 | L2-Norm(final)=2.154 | 4285.8 samples/s | 67.0 steps/s
[Step=5200 Epoch=20.0] | Loss=0.00002 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.393 | L2-Norm(final)=2.155 | 4225.8 samples/s | 66.0 steps/s
[Step=5250 Epoch=20.2] | Loss=0.00002 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=2.157 | 4233.3 samples/s | 66.1 steps/s
[Step=5300 Epoch=20.4] | Loss=0.00002 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=2.158 | 4838.2 samples/s | 75.6 steps/s
[Step=5350 Epoch=20.6] | Loss=0.00002 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=2.160 | 1904.1 samples/s | 29.8 steps/s
[Step=5400 Epoch=20.8] | Loss=0.00002 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.323 | L2-Norm(final)=2.162 | 4103.3 samples/s | 64.1 steps/s
[Step=5450 Epoch=21.0] | Loss=0.00002 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.305 | L2-Norm(final)=2.163 | 4260.7 samples/s | 66.6 steps/s
[Step=5500 Epoch=21.2] | Loss=0.00002 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.288 | L2-Norm(final)=2.165 | 4136.7 samples/s | 64.6 steps/s
[Step=5550 Epoch=21.4] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.270 | L2-Norm(final)=2.167 | 4245.3 samples/s | 66.3 steps/s
[Step=5600 Epoch=21.6] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.252 | L2-Norm(final)=2.168 | 1929.0 samples/s | 30.1 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step5600.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09318 | acc=0.9503 | tpr=0.9533 | fpr=0.0562 | 4008.0 samples/s | 15.7 steps/s
Avg test loss: 0.09629, Avg test acc: 0.94871, Avg tpr: 0.95203, Avg fpr: 0.05858, total FA: 457

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08957 | acc=0.9450 | tpr=0.9755 | fpr=0.1212 | 4121.8 samples/s | 16.1 steps/s
Avg test loss: 0.09426, Avg test acc: 0.94507, Avg tpr: 0.97505, Avg fpr: 0.12088, total FA: 943

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.27607 | acc=0.3140 | tpr=0.0081 | fpr=0.0218 | 4166.5 samples/s | 16.3 steps/s
Avg test loss: 5.30431, Avg test acc: 0.31172, Avg tpr: 0.00892, Avg fpr: 0.02230, total FA: 174

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=8.94412 | acc=0.3155 | tpr=0.0007 | fpr=0.0010 | 4138.2 samples/s | 16.2 steps/s
Avg test loss: 8.99560, Avg test acc: 0.31285, Avg tpr: 0.00111, Avg fpr: 0.00154, total FA: 12

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.58776 | acc=0.1662 | tpr=0.7478 | fpr=0.8443 | 4181.8 samples/s | 16.3 steps/s
[Step= 100] | Loss=3.56718 | acc=0.1680 | tpr=0.7356 | fpr=0.8426 | 7792.2 samples/s | 30.4 steps/s
[Step= 150] | Loss=3.60063 | acc=0.1668 | tpr=0.7435 | fpr=0.8438 | 8058.9 samples/s | 31.5 steps/s
[Step= 200] | Loss=3.59679 | acc=0.1669 | tpr=0.7366 | fpr=0.8435 | 7549.5 samples/s | 29.5 steps/s
[Step= 250] | Loss=3.60479 | acc=0.1665 | tpr=0.7205 | fpr=0.8435 | 7961.8 samples/s | 31.1 steps/s
[Step= 300] | Loss=3.60173 | acc=0.1662 | tpr=0.7236 | fpr=0.8440 | 7774.5 samples/s | 30.4 steps/s
[Step= 350] | Loss=3.60001 | acc=0.1662 | tpr=0.7295 | fpr=0.8440 | 7497.7 samples/s | 29.3 steps/s
[Step= 400] | Loss=3.60162 | acc=0.1665 | tpr=0.7270 | fpr=0.8437 | 8249.6 samples/s | 32.2 steps/s
[Step= 450] | Loss=3.60273 | acc=0.1663 | tpr=0.7313 | fpr=0.8439 | 7816.8 samples/s | 30.5 steps/s
[Step= 500] | Loss=3.60431 | acc=0.1659 | tpr=0.7322 | fpr=0.8444 | 7852.1 samples/s | 30.7 steps/s
[Step= 550] | Loss=3.60550 | acc=0.1659 | tpr=0.7358 | fpr=0.8444 | 13802.4 samples/s | 53.9 steps/s
Avg test loss: 3.60758, Avg test acc: 0.16580, Avg tpr: 0.73574, Avg fpr: 0.84456, total FA: 117266

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.95488 | acc=0.1110 | tpr=0.8142 | fpr=0.9016 | 3974.7 samples/s | 15.5 steps/s
[Step= 100] | Loss=4.93419 | acc=0.1112 | tpr=0.7974 | fpr=0.9016 | 7529.1 samples/s | 29.4 steps/s
[Step= 150] | Loss=4.93192 | acc=0.1109 | tpr=0.8055 | fpr=0.9019 | 7554.5 samples/s | 29.5 steps/s
[Step= 200] | Loss=4.92108 | acc=0.1111 | tpr=0.8087 | fpr=0.9016 | 7979.6 samples/s | 31.2 steps/s
[Step= 250] | Loss=4.92521 | acc=0.1106 | tpr=0.8079 | fpr=0.9021 | 7972.4 samples/s | 31.1 steps/s
[Step= 300] | Loss=4.92573 | acc=0.1105 | tpr=0.8022 | fpr=0.9021 | 7863.3 samples/s | 30.7 steps/s
[Step= 350] | Loss=4.92572 | acc=0.1103 | tpr=0.8034 | fpr=0.9023 | 7296.3 samples/s | 28.5 steps/s
[Step= 400] | Loss=4.92291 | acc=0.1100 | tpr=0.8058 | fpr=0.9027 | 7624.8 samples/s | 29.8 steps/s
[Step= 450] | Loss=4.92470 | acc=0.1105 | tpr=0.8067 | fpr=0.9021 | 7239.4 samples/s | 28.3 steps/s
[Step= 500] | Loss=4.93205 | acc=0.1103 | tpr=0.8066 | fpr=0.9023 | 7647.7 samples/s | 29.9 steps/s
[Step= 550] | Loss=4.93072 | acc=0.1104 | tpr=0.8038 | fpr=0.9022 | 13705.2 samples/s | 53.5 steps/s
Avg test loss: 4.93258, Avg test acc: 0.11025, Avg tpr: 0.80428, Avg fpr: 0.90237, total FA: 125292

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11610 | acc=0.9796 | tpr=0.9513 | fpr=0.0199 | 4042.9 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.11807 | acc=0.9790 | tpr=0.9552 | fpr=0.0205 | 7720.4 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.12276 | acc=0.9783 | tpr=0.9524 | fpr=0.0213 | 7310.8 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.12516 | acc=0.9783 | tpr=0.9552 | fpr=0.0213 | 7505.7 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.12337 | acc=0.9785 | tpr=0.9563 | fpr=0.0211 | 7633.1 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.12470 | acc=0.9781 | tpr=0.9535 | fpr=0.0215 | 8112.6 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.12545 | acc=0.9778 | tpr=0.9555 | fpr=0.0218 | 7545.5 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.12721 | acc=0.9776 | tpr=0.9513 | fpr=0.0219 | 7622.2 samples/s | 29.8 steps/s
[Step= 450] | Loss=0.12950 | acc=0.9774 | tpr=0.9499 | fpr=0.0221 | 7931.5 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.12879 | acc=0.9775 | tpr=0.9507 | fpr=0.0220 | 7703.8 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.12794 | acc=0.9777 | tpr=0.9511 | fpr=0.0219 | 14635.3 samples/s | 57.2 steps/s
Avg test loss: 0.12769, Avg test acc: 0.97769, Avg tpr: 0.95127, Avg fpr: 0.02183, total FA: 3031

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09888 | acc=0.9817 | tpr=0.9381 | fpr=0.0175 | 4182.4 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.10063 | acc=0.9810 | tpr=0.9552 | fpr=0.0185 | 7874.9 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.10532 | acc=0.9805 | tpr=0.9553 | fpr=0.0190 | 7926.9 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.10671 | acc=0.9804 | tpr=0.9563 | fpr=0.0192 | 7791.3 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.10507 | acc=0.9805 | tpr=0.9572 | fpr=0.0190 | 7860.6 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.10722 | acc=0.9802 | tpr=0.9535 | fpr=0.0193 | 7581.7 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.10790 | acc=0.9801 | tpr=0.9530 | fpr=0.0194 | 7695.5 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.10887 | acc=0.9799 | tpr=0.9513 | fpr=0.0196 | 8200.4 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.11114 | acc=0.9796 | tpr=0.9494 | fpr=0.0199 | 7525.0 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.11049 | acc=0.9797 | tpr=0.9515 | fpr=0.0198 | 7797.6 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.10963 | acc=0.9799 | tpr=0.9515 | fpr=0.0196 | 14032.4 samples/s | 54.8 steps/s
Avg test loss: 0.10950, Avg test acc: 0.97986, Avg tpr: 0.95127, Avg fpr: 0.01962, total FA: 2724

server round 7/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=5601 Epoch=10.9] | Loss=0.02842 | Reg=0.00382 | acc=0.9688 | L2-Norm=19.547 | L2-Norm(final)=2.230 | 3796.5 samples/s | 59.3 steps/s
[Step=5650 Epoch=11.0] | Loss=0.01814 | Reg=0.00383 | acc=0.9844 | L2-Norm=19.560 | L2-Norm(final)=2.236 | 4253.7 samples/s | 66.5 steps/s
[Step=5700 Epoch=11.1] | Loss=0.02124 | Reg=0.00383 | acc=1.0000 | L2-Norm=19.566 | L2-Norm(final)=2.240 | 4540.4 samples/s | 70.9 steps/s
[Step=5750 Epoch=11.2] | Loss=0.02181 | Reg=0.00383 | acc=1.0000 | L2-Norm=19.576 | L2-Norm(final)=2.235 | 4493.6 samples/s | 70.2 steps/s
[Step=5800 Epoch=11.3] | Loss=0.02316 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.585 | L2-Norm(final)=2.230 | 4528.4 samples/s | 70.8 steps/s
[Step=5850 Epoch=11.4] | Loss=0.02353 | Reg=0.00384 | acc=0.9844 | L2-Norm=19.601 | L2-Norm(final)=2.227 | 4512.7 samples/s | 70.5 steps/s
[Step=5900 Epoch=11.5] | Loss=0.02328 | Reg=0.00385 | acc=0.9688 | L2-Norm=19.614 | L2-Norm(final)=2.223 | 4400.6 samples/s | 68.8 steps/s
[Step=5950 Epoch=11.6] | Loss=0.02325 | Reg=0.00385 | acc=0.9688 | L2-Norm=19.627 | L2-Norm(final)=2.222 | 4397.6 samples/s | 68.7 steps/s
[Step=6000 Epoch=11.7] | Loss=0.02352 | Reg=0.00386 | acc=0.9531 | L2-Norm=19.641 | L2-Norm(final)=2.220 | 4482.6 samples/s | 70.0 steps/s
[Step=6050 Epoch=11.8] | Loss=0.02350 | Reg=0.00386 | acc=0.9844 | L2-Norm=19.656 | L2-Norm(final)=2.219 | 4448.6 samples/s | 69.5 steps/s
[Step=6100 Epoch=11.9] | Loss=0.02403 | Reg=0.00387 | acc=0.9531 | L2-Norm=19.670 | L2-Norm(final)=2.217 | 5418.7 samples/s | 84.7 steps/s
[Step=6150 Epoch=12.0] | Loss=0.02403 | Reg=0.00388 | acc=0.9844 | L2-Norm=19.688 | L2-Norm(final)=2.215 | 1814.1 samples/s | 28.3 steps/s
[Step=6200 Epoch=12.1] | Loss=0.02383 | Reg=0.00388 | acc=0.9688 | L2-Norm=19.706 | L2-Norm(final)=2.214 | 4535.7 samples/s | 70.9 steps/s
[Step=6250 Epoch=12.2] | Loss=0.02336 | Reg=0.00389 | acc=1.0000 | L2-Norm=19.722 | L2-Norm(final)=2.214 | 4576.4 samples/s | 71.5 steps/s
[Step=6300 Epoch=12.3] | Loss=0.02326 | Reg=0.00390 | acc=0.9531 | L2-Norm=19.737 | L2-Norm(final)=2.214 | 4566.1 samples/s | 71.3 steps/s
[Step=6350 Epoch=12.4] | Loss=0.02325 | Reg=0.00390 | acc=0.9844 | L2-Norm=19.753 | L2-Norm(final)=2.213 | 4639.1 samples/s | 72.5 steps/s
[Step=6400 Epoch=12.5] | Loss=0.02276 | Reg=0.00391 | acc=1.0000 | L2-Norm=19.770 | L2-Norm(final)=2.213 | 4556.9 samples/s | 71.2 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step6400.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00100, len=1
[Step=5601 Epoch=10.9] | Loss=0.04354 | Reg=0.00384 | acc=0.9688 | L2-Norm=19.603 | L2-Norm(final)=2.106 | 4432.0 samples/s | 69.3 steps/s
[Step=5650 Epoch=11.0] | Loss=0.02224 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.621 | L2-Norm(final)=2.113 | 3937.5 samples/s | 61.5 steps/s
[Step=5700 Epoch=11.1] | Loss=0.02056 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.630 | L2-Norm(final)=2.111 | 4473.7 samples/s | 69.9 steps/s
[Step=5750 Epoch=11.2] | Loss=0.02082 | Reg=0.00386 | acc=0.9531 | L2-Norm=19.636 | L2-Norm(final)=2.114 | 4408.1 samples/s | 68.9 steps/s
[Step=5800 Epoch=11.3] | Loss=0.02069 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.645 | L2-Norm(final)=2.115 | 4486.0 samples/s | 70.1 steps/s
[Step=5850 Epoch=11.4] | Loss=0.01997 | Reg=0.00386 | acc=0.9531 | L2-Norm=19.654 | L2-Norm(final)=2.117 | 4513.9 samples/s | 70.5 steps/s
[Step=5900 Epoch=11.5] | Loss=0.02192 | Reg=0.00387 | acc=0.9688 | L2-Norm=19.665 | L2-Norm(final)=2.118 | 4510.4 samples/s | 70.5 steps/s
[Step=5950 Epoch=11.6] | Loss=0.02268 | Reg=0.00387 | acc=0.9688 | L2-Norm=19.679 | L2-Norm(final)=2.120 | 4455.5 samples/s | 69.6 steps/s
[Step=6000 Epoch=11.7] | Loss=0.02243 | Reg=0.00388 | acc=1.0000 | L2-Norm=19.692 | L2-Norm(final)=2.121 | 4476.7 samples/s | 69.9 steps/s
[Step=6050 Epoch=11.8] | Loss=0.02199 | Reg=0.00388 | acc=0.9688 | L2-Norm=19.703 | L2-Norm(final)=2.123 | 4455.5 samples/s | 69.6 steps/s
[Step=6100 Epoch=11.9] | Loss=0.02245 | Reg=0.00389 | acc=1.0000 | L2-Norm=19.713 | L2-Norm(final)=2.124 | 5408.2 samples/s | 84.5 steps/s
[Step=6150 Epoch=12.0] | Loss=0.02194 | Reg=0.00389 | acc=1.0000 | L2-Norm=19.724 | L2-Norm(final)=2.124 | 1880.0 samples/s | 29.4 steps/s
[Step=6200 Epoch=12.1] | Loss=0.02155 | Reg=0.00389 | acc=1.0000 | L2-Norm=19.734 | L2-Norm(final)=2.124 | 4364.1 samples/s | 68.2 steps/s
[Step=6250 Epoch=12.2] | Loss=0.02100 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.743 | L2-Norm(final)=2.125 | 4471.1 samples/s | 69.9 steps/s
[Step=6300 Epoch=12.3] | Loss=0.02106 | Reg=0.00390 | acc=0.9844 | L2-Norm=19.751 | L2-Norm(final)=2.126 | 4439.7 samples/s | 69.4 steps/s
[Step=6350 Epoch=12.4] | Loss=0.02117 | Reg=0.00390 | acc=0.9688 | L2-Norm=19.759 | L2-Norm(final)=2.126 | 4438.8 samples/s | 69.4 steps/s
[Step=6400 Epoch=12.5] | Loss=0.02108 | Reg=0.00391 | acc=1.0000 | L2-Norm=19.768 | L2-Norm(final)=2.125 | 4513.5 samples/s | 70.5 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step6400.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=5601 Epoch=21.5] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.775 | L2-Norm(final)=2.892 | 3958.7 samples/s | 61.9 steps/s
[Step=5650 Epoch=21.6] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.740 | L2-Norm(final)=2.900 | 3934.9 samples/s | 61.5 steps/s
[Step=5700 Epoch=21.8] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.705 | L2-Norm(final)=2.910 | 4268.6 samples/s | 66.7 steps/s
[Step=5750 Epoch=22.0] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.671 | L2-Norm(final)=2.922 | 4229.8 samples/s | 66.1 steps/s
[Step=5800 Epoch=22.2] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.637 | L2-Norm(final)=2.933 | 4372.3 samples/s | 68.3 steps/s
[Step=5850 Epoch=22.4] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=2.944 | 5508.9 samples/s | 86.1 steps/s
[Step=5900 Epoch=22.6] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.568 | L2-Norm(final)=2.955 | 1876.9 samples/s | 29.3 steps/s
[Step=5950 Epoch=22.8] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.533 | L2-Norm(final)=2.966 | 4419.5 samples/s | 69.1 steps/s
[Step=6000 Epoch=23.0] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.499 | L2-Norm(final)=2.977 | 4351.1 samples/s | 68.0 steps/s
[Step=6050 Epoch=23.2] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.465 | L2-Norm(final)=2.989 | 4376.1 samples/s | 68.4 steps/s
[Step=6100 Epoch=23.4] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.431 | L2-Norm(final)=3.001 | 4871.3 samples/s | 76.1 steps/s
[Step=6150 Epoch=23.6] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.397 | L2-Norm(final)=3.013 | 1953.6 samples/s | 30.5 steps/s
[Step=6200 Epoch=23.8] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.363 | L2-Norm(final)=3.025 | 4346.9 samples/s | 67.9 steps/s
[Step=6250 Epoch=23.9] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.329 | L2-Norm(final)=3.037 | 4352.7 samples/s | 68.0 steps/s
[Step=6300 Epoch=24.1] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.296 | L2-Norm(final)=3.050 | 4407.0 samples/s | 68.9 steps/s
[Step=6350 Epoch=24.3] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.263 | L2-Norm(final)=3.064 | 4433.5 samples/s | 69.3 steps/s
[Step=6400 Epoch=24.5] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.230 | L2-Norm(final)=3.077 | 2042.7 samples/s | 31.9 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step6400.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00100, len=1
[Step=5601 Epoch=21.6] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.968 | L2-Norm(final)=2.195 | 4191.3 samples/s | 65.5 steps/s
[Step=5650 Epoch=21.7] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.949 | L2-Norm(final)=2.197 | 4154.2 samples/s | 64.9 steps/s
[Step=5700 Epoch=21.9] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.931 | L2-Norm(final)=2.199 | 4435.0 samples/s | 69.3 steps/s
[Step=5750 Epoch=22.1] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.913 | L2-Norm(final)=2.200 | 4443.5 samples/s | 69.4 steps/s
[Step=5800 Epoch=22.3] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.895 | L2-Norm(final)=2.203 | 4256.6 samples/s | 66.5 steps/s
[Step=5850 Epoch=22.5] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.877 | L2-Norm(final)=2.205 | 5479.8 samples/s | 85.6 steps/s
[Step=5900 Epoch=22.7] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.859 | L2-Norm(final)=2.207 | 1865.0 samples/s | 29.1 steps/s
[Step=5950 Epoch=22.9] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.840 | L2-Norm(final)=2.209 | 4318.9 samples/s | 67.5 steps/s
[Step=6000 Epoch=23.1] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.822 | L2-Norm(final)=2.212 | 4364.7 samples/s | 68.2 steps/s
[Step=6050 Epoch=23.3] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.803 | L2-Norm(final)=2.214 | 4230.6 samples/s | 66.1 steps/s
[Step=6100 Epoch=23.5] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.785 | L2-Norm(final)=2.216 | 4678.0 samples/s | 73.1 steps/s
[Step=6150 Epoch=23.7] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.767 | L2-Norm(final)=2.219 | 1916.2 samples/s | 29.9 steps/s
[Step=6200 Epoch=23.9] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.748 | L2-Norm(final)=2.222 | 4438.3 samples/s | 69.3 steps/s
[Step=6250 Epoch=24.1] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.730 | L2-Norm(final)=2.225 | 4443.7 samples/s | 69.4 steps/s
[Step=6300 Epoch=24.3] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.711 | L2-Norm(final)=2.227 | 4486.8 samples/s | 70.1 steps/s
[Step=6350 Epoch=24.4] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.693 | L2-Norm(final)=2.230 | 4432.1 samples/s | 69.3 steps/s
[Step=6400 Epoch=24.6] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.674 | L2-Norm(final)=2.233 | 2061.7 samples/s | 32.2 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step6400.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11000 | acc=0.9481 | tpr=0.9520 | fpr=0.0602 | 4329.9 samples/s | 16.9 steps/s
Avg test loss: 0.10911, Avg test acc: 0.94795, Avg tpr: 0.95256, Avg fpr: 0.06217, total FA: 485

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08581 | acc=0.9563 | tpr=0.9673 | fpr=0.0676 | 3962.1 samples/s | 15.5 steps/s
Avg test loss: 0.08967, Avg test acc: 0.95436, Avg tpr: 0.96579, Avg fpr: 0.07076, total FA: 552

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.10026 | acc=0.3148 | tpr=0.0086 | fpr=0.0201 | 4081.9 samples/s | 15.9 steps/s
Avg test loss: 5.12688, Avg test acc: 0.31212, Avg tpr: 0.00898, Avg fpr: 0.02115, total FA: 165

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=8.29345 | acc=0.3155 | tpr=0.0007 | fpr=0.0010 | 4127.0 samples/s | 16.1 steps/s
Avg test loss: 8.34097, Avg test acc: 0.31281, Avg tpr: 0.00099, Avg fpr: 0.00141, total FA: 11

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.74563 | acc=0.1963 | tpr=0.7743 | fpr=0.8141 | 4108.7 samples/s | 16.0 steps/s
[Step= 100] | Loss=3.72208 | acc=0.1980 | tpr=0.7548 | fpr=0.8123 | 7889.1 samples/s | 30.8 steps/s
[Step= 150] | Loss=3.74645 | acc=0.1972 | tpr=0.7493 | fpr=0.8129 | 7674.8 samples/s | 30.0 steps/s
[Step= 200] | Loss=3.74507 | acc=0.1975 | tpr=0.7333 | fpr=0.8122 | 7663.1 samples/s | 29.9 steps/s
[Step= 250] | Loss=3.74454 | acc=0.1976 | tpr=0.7310 | fpr=0.8121 | 7767.5 samples/s | 30.3 steps/s
[Step= 300] | Loss=3.74319 | acc=0.1968 | tpr=0.7375 | fpr=0.8131 | 7633.8 samples/s | 29.8 steps/s
[Step= 350] | Loss=3.74022 | acc=0.1969 | tpr=0.7426 | fpr=0.8130 | 7427.1 samples/s | 29.0 steps/s
[Step= 400] | Loss=3.74544 | acc=0.1971 | tpr=0.7440 | fpr=0.8129 | 7870.0 samples/s | 30.7 steps/s
[Step= 450] | Loss=3.74601 | acc=0.1967 | tpr=0.7405 | fpr=0.8132 | 7845.2 samples/s | 30.6 steps/s
[Step= 500] | Loss=3.74515 | acc=0.1966 | tpr=0.7383 | fpr=0.8132 | 7699.0 samples/s | 30.1 steps/s
[Step= 550] | Loss=3.74673 | acc=0.1966 | tpr=0.7417 | fpr=0.8133 | 13595.3 samples/s | 53.1 steps/s
Avg test loss: 3.74903, Avg test acc: 0.19637, Avg tpr: 0.74128, Avg fpr: 0.81354, total FA: 112958

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.59352 | acc=0.1462 | tpr=0.7301 | fpr=0.8642 | 4159.5 samples/s | 16.2 steps/s
[Step= 100] | Loss=4.56827 | acc=0.1455 | tpr=0.7335 | fpr=0.8654 | 7535.4 samples/s | 29.4 steps/s
[Step= 150] | Loss=4.56864 | acc=0.1447 | tpr=0.7089 | fpr=0.8657 | 7760.0 samples/s | 30.3 steps/s
[Step= 200] | Loss=4.55806 | acc=0.1460 | tpr=0.7093 | fpr=0.8642 | 7444.0 samples/s | 29.1 steps/s
[Step= 250] | Loss=4.55523 | acc=0.1458 | tpr=0.7109 | fpr=0.8645 | 7576.7 samples/s | 29.6 steps/s
[Step= 300] | Loss=4.55496 | acc=0.1460 | tpr=0.7069 | fpr=0.8642 | 7357.0 samples/s | 28.7 steps/s
[Step= 350] | Loss=4.55444 | acc=0.1458 | tpr=0.7088 | fpr=0.8644 | 7304.8 samples/s | 28.5 steps/s
[Step= 400] | Loss=4.55142 | acc=0.1458 | tpr=0.7133 | fpr=0.8645 | 7670.4 samples/s | 30.0 steps/s
[Step= 450] | Loss=4.55483 | acc=0.1459 | tpr=0.7132 | fpr=0.8644 | 7208.8 samples/s | 28.2 steps/s
[Step= 500] | Loss=4.56414 | acc=0.1450 | tpr=0.7093 | fpr=0.8652 | 7579.0 samples/s | 29.6 steps/s
[Step= 550] | Loss=4.56374 | acc=0.1448 | tpr=0.7083 | fpr=0.8654 | 13278.8 samples/s | 51.9 steps/s
Avg test loss: 4.56573, Avg test acc: 0.14467, Avg tpr: 0.70800, Avg fpr: 0.86557, total FA: 120183

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12284 | acc=0.9802 | tpr=0.9558 | fpr=0.0194 | 4018.5 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.12508 | acc=0.9797 | tpr=0.9595 | fpr=0.0199 | 7773.2 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.13002 | acc=0.9789 | tpr=0.9553 | fpr=0.0207 | 7619.4 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.13307 | acc=0.9788 | tpr=0.9563 | fpr=0.0207 | 7372.6 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.13101 | acc=0.9792 | tpr=0.9581 | fpr=0.0205 | 7535.6 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.13247 | acc=0.9789 | tpr=0.9549 | fpr=0.0207 | 7814.9 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.13323 | acc=0.9786 | tpr=0.9568 | fpr=0.0210 | 7247.3 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.13483 | acc=0.9783 | tpr=0.9519 | fpr=0.0212 | 7690.6 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.13720 | acc=0.9780 | tpr=0.9494 | fpr=0.0215 | 7314.6 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.13640 | acc=0.9781 | tpr=0.9502 | fpr=0.0214 | 7846.4 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.13554 | acc=0.9783 | tpr=0.9511 | fpr=0.0212 | 13131.6 samples/s | 51.3 steps/s
Avg test loss: 0.13529, Avg test acc: 0.97832, Avg tpr: 0.95087, Avg fpr: 0.02118, total FA: 2941

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09806 | acc=0.9815 | tpr=0.9469 | fpr=0.0179 | 4195.6 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.10028 | acc=0.9810 | tpr=0.9616 | fpr=0.0187 | 7891.7 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.10508 | acc=0.9804 | tpr=0.9597 | fpr=0.0193 | 8293.3 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.10641 | acc=0.9803 | tpr=0.9607 | fpr=0.0193 | 7431.9 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.10487 | acc=0.9805 | tpr=0.9616 | fpr=0.0191 | 7986.8 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.10696 | acc=0.9802 | tpr=0.9593 | fpr=0.0194 | 7787.3 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.10758 | acc=0.9801 | tpr=0.9587 | fpr=0.0195 | 7855.0 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.10848 | acc=0.9800 | tpr=0.9573 | fpr=0.0196 | 8445.3 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.11068 | acc=0.9797 | tpr=0.9552 | fpr=0.0199 | 7335.4 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.10999 | acc=0.9797 | tpr=0.9564 | fpr=0.0198 | 7619.0 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.10916 | acc=0.9799 | tpr=0.9570 | fpr=0.0197 | 14916.5 samples/s | 58.3 steps/s
Avg test loss: 0.10902, Avg test acc: 0.97993, Avg tpr: 0.95681, Avg fpr: 0.01965, total FA: 2729

server round 8/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=6401 Epoch=12.5] | Loss=0.01227 | Reg=0.00401 | acc=0.9844 | L2-Norm=20.023 | L2-Norm(final)=2.221 | 4092.0 samples/s | 63.9 steps/s
[Step=6450 Epoch=12.6] | Loss=0.01818 | Reg=0.00401 | acc=0.9844 | L2-Norm=20.023 | L2-Norm(final)=2.222 | 3734.0 samples/s | 58.3 steps/s
[Step=6500 Epoch=12.7] | Loss=0.01795 | Reg=0.00401 | acc=1.0000 | L2-Norm=20.021 | L2-Norm(final)=2.217 | 4360.8 samples/s | 68.1 steps/s
[Step=6550 Epoch=12.8] | Loss=0.01903 | Reg=0.00401 | acc=0.9844 | L2-Norm=20.018 | L2-Norm(final)=2.214 | 4365.7 samples/s | 68.2 steps/s
[Step=6600 Epoch=12.9] | Loss=0.01997 | Reg=0.00401 | acc=0.9844 | L2-Norm=20.021 | L2-Norm(final)=2.209 | 4531.5 samples/s | 70.8 steps/s
[Step=6650 Epoch=13.0] | Loss=0.02029 | Reg=0.00401 | acc=1.0000 | L2-Norm=20.029 | L2-Norm(final)=2.207 | 4577.2 samples/s | 71.5 steps/s
[Step=6700 Epoch=13.1] | Loss=0.02001 | Reg=0.00402 | acc=0.9844 | L2-Norm=20.040 | L2-Norm(final)=2.204 | 4607.0 samples/s | 72.0 steps/s
[Step=6750 Epoch=13.2] | Loss=0.02010 | Reg=0.00402 | acc=0.9844 | L2-Norm=20.049 | L2-Norm(final)=2.203 | 4537.2 samples/s | 70.9 steps/s
[Step=6800 Epoch=13.3] | Loss=0.01979 | Reg=0.00402 | acc=1.0000 | L2-Norm=20.059 | L2-Norm(final)=2.203 | 4533.6 samples/s | 70.8 steps/s
[Step=6850 Epoch=13.4] | Loss=0.01980 | Reg=0.00403 | acc=0.9844 | L2-Norm=20.067 | L2-Norm(final)=2.203 | 4633.5 samples/s | 72.4 steps/s
[Step=6900 Epoch=13.5] | Loss=0.01962 | Reg=0.00403 | acc=0.9844 | L2-Norm=20.075 | L2-Norm(final)=2.203 | 5681.2 samples/s | 88.8 steps/s
[Step=6950 Epoch=13.6] | Loss=0.01943 | Reg=0.00403 | acc=1.0000 | L2-Norm=20.084 | L2-Norm(final)=2.203 | 1905.3 samples/s | 29.8 steps/s
[Step=7000 Epoch=13.7] | Loss=0.01909 | Reg=0.00404 | acc=0.9844 | L2-Norm=20.093 | L2-Norm(final)=2.203 | 4608.6 samples/s | 72.0 steps/s
[Step=7050 Epoch=13.8] | Loss=0.01903 | Reg=0.00404 | acc=0.9844 | L2-Norm=20.101 | L2-Norm(final)=2.203 | 4446.4 samples/s | 69.5 steps/s
[Step=7100 Epoch=13.8] | Loss=0.01910 | Reg=0.00404 | acc=1.0000 | L2-Norm=20.109 | L2-Norm(final)=2.202 | 4693.4 samples/s | 73.3 steps/s
[Step=7150 Epoch=13.9] | Loss=0.01905 | Reg=0.00405 | acc=0.9531 | L2-Norm=20.117 | L2-Norm(final)=2.201 | 4584.3 samples/s | 71.6 steps/s
[Step=7200 Epoch=14.0] | Loss=0.01906 | Reg=0.00405 | acc=0.9531 | L2-Norm=20.127 | L2-Norm(final)=2.200 | 4362.4 samples/s | 68.2 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step7200.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00100, len=1
[Step=6401 Epoch=12.5] | Loss=0.00170 | Reg=0.00397 | acc=1.0000 | L2-Norm=19.916 | L2-Norm(final)=2.119 | 4242.9 samples/s | 66.3 steps/s
[Step=6450 Epoch=12.6] | Loss=0.01717 | Reg=0.00397 | acc=0.9531 | L2-Norm=19.917 | L2-Norm(final)=2.126 | 4413.9 samples/s | 69.0 steps/s
[Step=6500 Epoch=12.7] | Loss=0.01758 | Reg=0.00397 | acc=1.0000 | L2-Norm=19.920 | L2-Norm(final)=2.126 | 4522.3 samples/s | 70.7 steps/s
[Step=6550 Epoch=12.8] | Loss=0.01687 | Reg=0.00397 | acc=0.9844 | L2-Norm=19.926 | L2-Norm(final)=2.130 | 4567.4 samples/s | 71.4 steps/s
[Step=6600 Epoch=12.9] | Loss=0.01737 | Reg=0.00397 | acc=1.0000 | L2-Norm=19.928 | L2-Norm(final)=2.132 | 4474.5 samples/s | 69.9 steps/s
[Step=6650 Epoch=13.0] | Loss=0.01709 | Reg=0.00397 | acc=0.9688 | L2-Norm=19.930 | L2-Norm(final)=2.132 | 4547.1 samples/s | 71.0 steps/s
[Step=6700 Epoch=13.1] | Loss=0.01688 | Reg=0.00397 | acc=0.9844 | L2-Norm=19.933 | L2-Norm(final)=2.133 | 4423.7 samples/s | 69.1 steps/s
[Step=6750 Epoch=13.2] | Loss=0.01702 | Reg=0.00397 | acc=1.0000 | L2-Norm=19.937 | L2-Norm(final)=2.133 | 4466.6 samples/s | 69.8 steps/s
[Step=6800 Epoch=13.3] | Loss=0.01783 | Reg=0.00398 | acc=0.9531 | L2-Norm=19.943 | L2-Norm(final)=2.133 | 4479.6 samples/s | 70.0 steps/s
[Step=6850 Epoch=13.4] | Loss=0.01831 | Reg=0.00398 | acc=1.0000 | L2-Norm=19.950 | L2-Norm(final)=2.133 | 4471.8 samples/s | 69.9 steps/s
[Step=6900 Epoch=13.5] | Loss=0.01888 | Reg=0.00398 | acc=0.9844 | L2-Norm=19.958 | L2-Norm(final)=2.132 | 5521.7 samples/s | 86.3 steps/s
[Step=6950 Epoch=13.6] | Loss=0.01920 | Reg=0.00399 | acc=0.9688 | L2-Norm=19.965 | L2-Norm(final)=2.131 | 1818.5 samples/s | 28.4 steps/s
[Step=7000 Epoch=13.7] | Loss=0.01874 | Reg=0.00399 | acc=1.0000 | L2-Norm=19.973 | L2-Norm(final)=2.130 | 4367.2 samples/s | 68.2 steps/s
[Step=7050 Epoch=13.8] | Loss=0.01887 | Reg=0.00399 | acc=0.9844 | L2-Norm=19.981 | L2-Norm(final)=2.129 | 4381.9 samples/s | 68.5 steps/s
[Step=7100 Epoch=13.9] | Loss=0.01919 | Reg=0.00400 | acc=0.9688 | L2-Norm=19.990 | L2-Norm(final)=2.127 | 4611.5 samples/s | 72.1 steps/s
[Step=7150 Epoch=14.0] | Loss=0.01940 | Reg=0.00400 | acc=1.0000 | L2-Norm=19.999 | L2-Norm(final)=2.125 | 4555.3 samples/s | 71.2 steps/s
[Step=7200 Epoch=14.1] | Loss=0.01927 | Reg=0.00400 | acc=1.0000 | L2-Norm=20.009 | L2-Norm(final)=2.124 | 4589.9 samples/s | 71.7 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step7200.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=6401 Epoch=24.5] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.702 | L2-Norm(final)=3.286 | 3845.2 samples/s | 60.1 steps/s
[Step=6450 Epoch=24.7] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.665 | L2-Norm(final)=3.292 | 4039.7 samples/s | 63.1 steps/s
[Step=6500 Epoch=24.9] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.630 | L2-Norm(final)=3.300 | 4433.9 samples/s | 69.3 steps/s
[Step=6550 Epoch=25.1] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.594 | L2-Norm(final)=3.310 | 4482.1 samples/s | 70.0 steps/s
[Step=6600 Epoch=25.3] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.560 | L2-Norm(final)=3.321 | 4392.7 samples/s | 68.6 steps/s
[Step=6650 Epoch=25.5] | Loss=0.06353 | Reg=0.00076 | acc=0.8750 | L2-Norm=8.680 | L2-Norm(final)=3.315 | 5607.4 samples/s | 87.6 steps/s
[Step=6700 Epoch=25.7] | Loss=0.06159 | Reg=0.00087 | acc=0.9688 | L2-Norm=9.249 | L2-Norm(final)=3.305 | 1893.3 samples/s | 29.6 steps/s
[Step=6750 Epoch=25.9] | Loss=0.05529 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.714 | L2-Norm(final)=3.306 | 4444.6 samples/s | 69.4 steps/s
[Step=6800 Epoch=26.1] | Loss=0.04992 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.051 | L2-Norm(final)=3.310 | 4446.7 samples/s | 69.5 steps/s
[Step=6850 Epoch=26.2] | Loss=0.04486 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.309 | L2-Norm(final)=3.314 | 4452.0 samples/s | 69.6 steps/s
[Step=6900 Epoch=26.4] | Loss=0.04080 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.512 | L2-Norm(final)=3.320 | 4946.8 samples/s | 77.3 steps/s
[Step=6950 Epoch=26.6] | Loss=0.03740 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.674 | L2-Norm(final)=3.326 | 1993.1 samples/s | 31.1 steps/s
[Step=7000 Epoch=26.8] | Loss=0.03441 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.806 | L2-Norm(final)=3.332 | 4521.5 samples/s | 70.6 steps/s
[Step=7050 Epoch=27.0] | Loss=0.03192 | Reg=0.00122 | acc=1.0000 | L2-Norm=10.914 | L2-Norm(final)=3.338 | 4410.1 samples/s | 68.9 steps/s
[Step=7100 Epoch=27.2] | Loss=0.02980 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.003 | L2-Norm(final)=3.344 | 4425.6 samples/s | 69.1 steps/s
[Step=7150 Epoch=27.4] | Loss=0.02786 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.077 | L2-Norm(final)=3.349 | 4429.5 samples/s | 69.2 steps/s
[Step=7200 Epoch=27.6] | Loss=0.02615 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.139 | L2-Norm(final)=3.355 | 2060.2 samples/s | 32.2 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step7200.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00100, len=1
[Step=6401 Epoch=24.6] | Loss=0.00000 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.372 | L2-Norm(final)=2.278 | 3864.7 samples/s | 60.4 steps/s
[Step=6450 Epoch=24.8] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.353 | L2-Norm(final)=2.281 | 3885.1 samples/s | 60.7 steps/s
[Step=6500 Epoch=25.0] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.334 | L2-Norm(final)=2.284 | 4328.0 samples/s | 67.6 steps/s
[Step=6550 Epoch=25.2] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=2.287 | 4471.0 samples/s | 69.9 steps/s
[Step=6600 Epoch=25.4] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=2.291 | 4389.7 samples/s | 68.6 steps/s
[Step=6650 Epoch=25.6] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.277 | L2-Norm(final)=2.294 | 5684.0 samples/s | 88.8 steps/s
[Step=6700 Epoch=25.8] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=2.298 | 1905.2 samples/s | 29.8 steps/s
[Step=6750 Epoch=26.0] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.237 | L2-Norm(final)=2.301 | 4466.3 samples/s | 69.8 steps/s
[Step=6800 Epoch=26.2] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.217 | L2-Norm(final)=2.305 | 4427.9 samples/s | 69.2 steps/s
[Step=6850 Epoch=26.4] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.197 | L2-Norm(final)=2.308 | 4471.3 samples/s | 69.9 steps/s
[Step=6900 Epoch=26.6] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.177 | L2-Norm(final)=2.312 | 5019.0 samples/s | 78.4 steps/s
[Step=6950 Epoch=26.8] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=2.316 | 2006.3 samples/s | 31.3 steps/s
[Step=7000 Epoch=26.9] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=2.321 | 4398.3 samples/s | 68.7 steps/s
[Step=7050 Epoch=27.1] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.116 | L2-Norm(final)=2.325 | 4458.4 samples/s | 69.7 steps/s
[Step=7100 Epoch=27.3] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.096 | L2-Norm(final)=2.329 | 4478.3 samples/s | 70.0 steps/s
[Step=7150 Epoch=27.5] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.076 | L2-Norm(final)=2.334 | 4505.5 samples/s | 70.4 steps/s
[Step=7200 Epoch=27.7] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.055 | L2-Norm(final)=2.338 | 2068.8 samples/s | 32.3 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step7200.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10413 | acc=0.9544 | tpr=0.9714 | fpr=0.0825 | 4404.9 samples/s | 17.2 steps/s
Avg test loss: 0.10669, Avg test acc: 0.95460, Avg tpr: 0.97220, Avg fpr: 0.08409, total FA: 656

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10823 | acc=0.9496 | tpr=0.9484 | fpr=0.0478 | 4323.7 samples/s | 16.9 steps/s
Avg test loss: 0.11186, Avg test acc: 0.94956, Avg tpr: 0.94970, Avg fpr: 0.05076, total FA: 396

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=3.63720 | acc=0.3137 | tpr=0.0045 | fpr=0.0146 | 4374.3 samples/s | 17.1 steps/s
Avg test loss: 3.64500, Avg test acc: 0.31192, Avg tpr: 0.00530, Avg fpr: 0.01372, total FA: 107

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.59806 | acc=0.3154 | tpr=0.0011 | fpr=0.0022 | 4343.7 samples/s | 17.0 steps/s
Avg test loss: 7.64218, Avg test acc: 0.31269, Avg tpr: 0.00152, Avg fpr: 0.00295, total FA: 23

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.88712 | acc=0.1398 | tpr=0.8097 | fpr=0.8723 | 4341.9 samples/s | 17.0 steps/s
[Step= 100] | Loss=4.84919 | acc=0.1419 | tpr=0.7974 | fpr=0.8704 | 8066.7 samples/s | 31.5 steps/s
[Step= 150] | Loss=4.88406 | acc=0.1397 | tpr=0.8055 | fpr=0.8725 | 8319.3 samples/s | 32.5 steps/s
[Step= 200] | Loss=4.87791 | acc=0.1407 | tpr=0.7978 | fpr=0.8713 | 8048.6 samples/s | 31.4 steps/s
[Step= 250] | Loss=4.88413 | acc=0.1405 | tpr=0.7948 | fpr=0.8714 | 8119.7 samples/s | 31.7 steps/s
[Step= 300] | Loss=4.88824 | acc=0.1403 | tpr=0.7964 | fpr=0.8717 | 8051.5 samples/s | 31.5 steps/s
[Step= 350] | Loss=4.88556 | acc=0.1406 | tpr=0.7996 | fpr=0.8713 | 8584.1 samples/s | 33.5 steps/s
[Step= 400] | Loss=4.89374 | acc=0.1403 | tpr=0.8003 | fpr=0.8717 | 7972.7 samples/s | 31.1 steps/s
[Step= 450] | Loss=4.89295 | acc=0.1401 | tpr=0.8009 | fpr=0.8719 | 8112.5 samples/s | 31.7 steps/s
[Step= 500] | Loss=4.89674 | acc=0.1395 | tpr=0.7987 | fpr=0.8724 | 8263.2 samples/s | 32.3 steps/s
[Step= 550] | Loss=4.89635 | acc=0.1399 | tpr=0.7994 | fpr=0.8721 | 14313.8 samples/s | 55.9 steps/s
Avg test loss: 4.89865, Avg test acc: 0.13975, Avg tpr: 0.79873, Avg fpr: 0.87223, total FA: 121107

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.09746 | acc=0.1729 | tpr=0.7212 | fpr=0.8370 | 4291.5 samples/s | 16.8 steps/s
[Step= 100] | Loss=5.06809 | acc=0.1724 | tpr=0.6802 | fpr=0.8371 | 8272.7 samples/s | 32.3 steps/s
[Step= 150] | Loss=5.07073 | acc=0.1710 | tpr=0.6628 | fpr=0.8381 | 8154.6 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.05842 | acc=0.1727 | tpr=0.6579 | fpr=0.8361 | 8402.0 samples/s | 32.8 steps/s
[Step= 250] | Loss=5.05898 | acc=0.1734 | tpr=0.6655 | fpr=0.8356 | 7918.7 samples/s | 30.9 steps/s
[Step= 300] | Loss=5.05822 | acc=0.1734 | tpr=0.6625 | fpr=0.8355 | 8381.2 samples/s | 32.7 steps/s
[Step= 350] | Loss=5.05652 | acc=0.1737 | tpr=0.6688 | fpr=0.8353 | 7770.5 samples/s | 30.4 steps/s
[Step= 400] | Loss=5.05260 | acc=0.1741 | tpr=0.6740 | fpr=0.8350 | 8242.4 samples/s | 32.2 steps/s
[Step= 450] | Loss=5.05681 | acc=0.1740 | tpr=0.6738 | fpr=0.8350 | 8019.1 samples/s | 31.3 steps/s
[Step= 500] | Loss=5.06441 | acc=0.1733 | tpr=0.6700 | fpr=0.8357 | 8004.5 samples/s | 31.3 steps/s
[Step= 550] | Loss=5.06404 | acc=0.1731 | tpr=0.6657 | fpr=0.8358 | 14995.5 samples/s | 58.6 steps/s
Avg test loss: 5.06654, Avg test acc: 0.17300, Avg tpr: 0.66640, Avg fpr: 0.83597, total FA: 116073

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.05557 | acc=0.9820 | tpr=0.9558 | fpr=0.0175 | 4083.3 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.05612 | acc=0.9820 | tpr=0.9680 | fpr=0.0177 | 8429.7 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.05874 | acc=0.9809 | tpr=0.9669 | fpr=0.0189 | 8094.9 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.05954 | acc=0.9809 | tpr=0.9705 | fpr=0.0189 | 7996.7 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.05918 | acc=0.9810 | tpr=0.9686 | fpr=0.0188 | 8391.8 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.05968 | acc=0.9808 | tpr=0.9658 | fpr=0.0190 | 8017.7 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.06008 | acc=0.9806 | tpr=0.9649 | fpr=0.0192 | 8016.2 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.06099 | acc=0.9802 | tpr=0.9628 | fpr=0.0195 | 8065.5 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.06201 | acc=0.9799 | tpr=0.9606 | fpr=0.0198 | 8237.8 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.06164 | acc=0.9801 | tpr=0.9608 | fpr=0.0196 | 7927.1 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.06123 | acc=0.9802 | tpr=0.9602 | fpr=0.0194 | 15192.0 samples/s | 59.3 steps/s
Avg test loss: 0.06117, Avg test acc: 0.98026, Avg tpr: 0.96038, Avg fpr: 0.01938, total FA: 2691

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11464 | acc=0.9801 | tpr=0.9513 | fpr=0.0194 | 4320.2 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.11794 | acc=0.9794 | tpr=0.9659 | fpr=0.0203 | 8345.1 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.12352 | acc=0.9784 | tpr=0.9640 | fpr=0.0213 | 7952.7 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.12512 | acc=0.9784 | tpr=0.9639 | fpr=0.0214 | 8525.7 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.12339 | acc=0.9785 | tpr=0.9651 | fpr=0.0212 | 7714.9 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.12576 | acc=0.9784 | tpr=0.9636 | fpr=0.0214 | 8311.5 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.12648 | acc=0.9783 | tpr=0.9643 | fpr=0.0215 | 8240.6 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.12755 | acc=0.9780 | tpr=0.9623 | fpr=0.0217 | 8128.1 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.13010 | acc=0.9777 | tpr=0.9601 | fpr=0.0220 | 8049.0 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.12933 | acc=0.9778 | tpr=0.9617 | fpr=0.0219 | 8015.8 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.12833 | acc=0.9780 | tpr=0.9626 | fpr=0.0217 | 14900.8 samples/s | 58.2 steps/s
Avg test loss: 0.12815, Avg test acc: 0.97800, Avg tpr: 0.96236, Avg fpr: 0.02171, total FA: 3015

server round 9/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00100, len=1
[Step=7201 Epoch=14.0] | Loss=0.00167 | Reg=0.00411 | acc=1.0000 | L2-Norm=20.282 | L2-Norm(final)=2.194 | 3815.2 samples/s | 59.6 steps/s
[Step=7250 Epoch=14.1] | Loss=0.01590 | Reg=0.00411 | acc=1.0000 | L2-Norm=20.284 | L2-Norm(final)=2.200 | 4397.9 samples/s | 68.7 steps/s
[Step=7300 Epoch=14.2] | Loss=0.01684 | Reg=0.00412 | acc=0.9844 | L2-Norm=20.289 | L2-Norm(final)=2.195 | 4674.2 samples/s | 73.0 steps/s
[Step=7350 Epoch=14.3] | Loss=0.01698 | Reg=0.00412 | acc=0.9844 | L2-Norm=20.291 | L2-Norm(final)=2.197 | 4409.4 samples/s | 68.9 steps/s
[Step=7400 Epoch=14.4] | Loss=0.01690 | Reg=0.00412 | acc=1.0000 | L2-Norm=20.295 | L2-Norm(final)=2.202 | 4353.8 samples/s | 68.0 steps/s
[Step=7450 Epoch=14.5] | Loss=0.01812 | Reg=0.00412 | acc=0.9844 | L2-Norm=20.303 | L2-Norm(final)=2.201 | 4260.5 samples/s | 66.6 steps/s
[Step=7500 Epoch=14.6] | Loss=0.01779 | Reg=0.00413 | acc=0.9844 | L2-Norm=20.314 | L2-Norm(final)=2.203 | 4362.3 samples/s | 68.2 steps/s
[Step=7550 Epoch=14.7] | Loss=0.01868 | Reg=0.00413 | acc=1.0000 | L2-Norm=20.325 | L2-Norm(final)=2.202 | 4534.5 samples/s | 70.9 steps/s
[Step=7600 Epoch=14.8] | Loss=0.01898 | Reg=0.00414 | acc=0.9375 | L2-Norm=20.337 | L2-Norm(final)=2.197 | 4464.3 samples/s | 69.8 steps/s
[Step=7650 Epoch=14.9] | Loss=0.02000 | Reg=0.00414 | acc=0.9844 | L2-Norm=20.352 | L2-Norm(final)=2.192 | 4465.0 samples/s | 69.8 steps/s
[Step=7700 Epoch=15.0] | Loss=0.02062 | Reg=0.00415 | acc=1.0000 | L2-Norm=20.366 | L2-Norm(final)=2.187 | 5506.2 samples/s | 86.0 steps/s
[Step=7750 Epoch=15.1] | Loss=0.02049 | Reg=0.00415 | acc=1.0000 | L2-Norm=20.380 | L2-Norm(final)=2.183 | 1882.7 samples/s | 29.4 steps/s
[Step=7800 Epoch=15.2] | Loss=0.02034 | Reg=0.00416 | acc=0.9844 | L2-Norm=20.391 | L2-Norm(final)=2.182 | 4495.0 samples/s | 70.2 steps/s
[Step=7850 Epoch=15.3] | Loss=0.02005 | Reg=0.00416 | acc=1.0000 | L2-Norm=20.402 | L2-Norm(final)=2.180 | 4561.0 samples/s | 71.3 steps/s
[Step=7900 Epoch=15.4] | Loss=0.01997 | Reg=0.00417 | acc=1.0000 | L2-Norm=20.413 | L2-Norm(final)=2.178 | 4471.6 samples/s | 69.9 steps/s
[Step=7950 Epoch=15.5] | Loss=0.02000 | Reg=0.00417 | acc=0.9844 | L2-Norm=20.422 | L2-Norm(final)=2.176 | 4444.4 samples/s | 69.4 steps/s
[Step=8000 Epoch=15.6] | Loss=0.01986 | Reg=0.00417 | acc=0.9844 | L2-Norm=20.432 | L2-Norm(final)=2.175 | 4562.1 samples/s | 71.3 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step8000.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00100, len=1
[Step=7201 Epoch=14.1] | Loss=0.00682 | Reg=0.00406 | acc=0.9844 | L2-Norm=20.156 | L2-Norm(final)=2.110 | 4334.4 samples/s | 67.7 steps/s
[Step=7250 Epoch=14.2] | Loss=0.01741 | Reg=0.00407 | acc=0.9844 | L2-Norm=20.165 | L2-Norm(final)=2.109 | 4146.8 samples/s | 64.8 steps/s
[Step=7300 Epoch=14.3] | Loss=0.01780 | Reg=0.00407 | acc=1.0000 | L2-Norm=20.168 | L2-Norm(final)=2.105 | 4548.8 samples/s | 71.1 steps/s
[Step=7350 Epoch=14.4] | Loss=0.01840 | Reg=0.00407 | acc=0.9688 | L2-Norm=20.167 | L2-Norm(final)=2.107 | 4479.3 samples/s | 70.0 steps/s
[Step=7400 Epoch=14.5] | Loss=0.01787 | Reg=0.00407 | acc=0.9844 | L2-Norm=20.167 | L2-Norm(final)=2.106 | 4578.7 samples/s | 71.5 steps/s
[Step=7450 Epoch=14.6] | Loss=0.01878 | Reg=0.00407 | acc=0.9844 | L2-Norm=20.171 | L2-Norm(final)=2.104 | 4547.8 samples/s | 71.1 steps/s
[Step=7500 Epoch=14.7] | Loss=0.01852 | Reg=0.00407 | acc=1.0000 | L2-Norm=20.177 | L2-Norm(final)=2.104 | 4517.5 samples/s | 70.6 steps/s
[Step=7550 Epoch=14.8] | Loss=0.01809 | Reg=0.00407 | acc=0.9844 | L2-Norm=20.185 | L2-Norm(final)=2.105 | 4600.4 samples/s | 71.9 steps/s
[Step=7600 Epoch=14.9] | Loss=0.01883 | Reg=0.00408 | acc=0.9531 | L2-Norm=20.193 | L2-Norm(final)=2.104 | 4371.1 samples/s | 68.3 steps/s
[Step=7650 Epoch=15.0] | Loss=0.01916 | Reg=0.00408 | acc=1.0000 | L2-Norm=20.202 | L2-Norm(final)=2.101 | 4561.8 samples/s | 71.3 steps/s
[Step=7700 Epoch=15.1] | Loss=0.01942 | Reg=0.00409 | acc=0.9844 | L2-Norm=20.213 | L2-Norm(final)=2.099 | 5523.1 samples/s | 86.3 steps/s
[Step=7750 Epoch=15.2] | Loss=0.01914 | Reg=0.00409 | acc=0.9844 | L2-Norm=20.224 | L2-Norm(final)=2.096 | 1931.5 samples/s | 30.2 steps/s
[Step=7800 Epoch=15.2] | Loss=0.01924 | Reg=0.00409 | acc=0.9844 | L2-Norm=20.233 | L2-Norm(final)=2.094 | 4542.8 samples/s | 71.0 steps/s
[Step=7850 Epoch=15.3] | Loss=0.01940 | Reg=0.00410 | acc=0.9844 | L2-Norm=20.243 | L2-Norm(final)=2.092 | 4393.0 samples/s | 68.6 steps/s
[Step=7900 Epoch=15.4] | Loss=0.01931 | Reg=0.00410 | acc=0.9531 | L2-Norm=20.253 | L2-Norm(final)=2.091 | 4412.7 samples/s | 68.9 steps/s
[Step=7950 Epoch=15.5] | Loss=0.01926 | Reg=0.00411 | acc=0.9844 | L2-Norm=20.263 | L2-Norm(final)=2.090 | 4424.5 samples/s | 69.1 steps/s
[Step=8000 Epoch=15.6] | Loss=0.01927 | Reg=0.00411 | acc=0.9688 | L2-Norm=20.273 | L2-Norm(final)=2.088 | 4404.4 samples/s | 68.8 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step8000.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00100, len=1
[Step=7201 Epoch=27.6] | Loss=0.00004 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.066 | L2-Norm(final)=3.444 | 3696.8 samples/s | 57.8 steps/s
[Step=7250 Epoch=27.8] | Loss=0.00021 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.043 | L2-Norm(final)=3.447 | 4224.4 samples/s | 66.0 steps/s
[Step=7300 Epoch=28.0] | Loss=0.00020 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.021 | L2-Norm(final)=3.450 | 4158.6 samples/s | 65.0 steps/s
[Step=7350 Epoch=28.2] | Loss=0.00018 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.997 | L2-Norm(final)=3.453 | 4126.8 samples/s | 64.5 steps/s
[Step=7400 Epoch=28.4] | Loss=0.00017 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.975 | L2-Norm(final)=3.457 | 4155.4 samples/s | 64.9 steps/s
[Step=7450 Epoch=28.5] | Loss=0.00015 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.955 | L2-Norm(final)=3.464 | 5277.5 samples/s | 82.5 steps/s
[Step=7500 Epoch=28.7] | Loss=0.00014 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.934 | L2-Norm(final)=3.470 | 1817.3 samples/s | 28.4 steps/s
[Step=7550 Epoch=28.9] | Loss=0.00013 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.914 | L2-Norm(final)=3.476 | 4242.7 samples/s | 66.3 steps/s
[Step=7600 Epoch=29.1] | Loss=0.00012 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.893 | L2-Norm(final)=3.483 | 4244.8 samples/s | 66.3 steps/s
[Step=7650 Epoch=29.3] | Loss=0.00012 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.872 | L2-Norm(final)=3.489 | 4224.2 samples/s | 66.0 steps/s
[Step=7700 Epoch=29.5] | Loss=0.00011 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.851 | L2-Norm(final)=3.496 | 4651.7 samples/s | 72.7 steps/s
[Step=7750 Epoch=29.7] | Loss=0.00010 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.830 | L2-Norm(final)=3.503 | 1934.0 samples/s | 30.2 steps/s
[Step=7800 Epoch=29.9] | Loss=0.00010 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.809 | L2-Norm(final)=3.509 | 4238.0 samples/s | 66.2 steps/s
[Step=7850 Epoch=30.1] | Loss=0.00009 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.788 | L2-Norm(final)=3.516 | 4318.6 samples/s | 67.5 steps/s
[Step=7900 Epoch=30.3] | Loss=0.00009 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.768 | L2-Norm(final)=3.522 | 4244.4 samples/s | 66.3 steps/s
[Step=7950 Epoch=30.5] | Loss=0.00008 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.748 | L2-Norm(final)=3.529 | 4283.0 samples/s | 66.9 steps/s
[Step=8000 Epoch=30.7] | Loss=0.00008 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.728 | L2-Norm(final)=3.536 | 2022.2 samples/s | 31.6 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step8000.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00100, len=1
[Step=7201 Epoch=27.7] | Loss=0.00000 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.723 | L2-Norm(final)=2.409 | 4263.5 samples/s | 66.6 steps/s
[Step=7250 Epoch=27.9] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.703 | L2-Norm(final)=2.414 | 3862.2 samples/s | 60.3 steps/s
[Step=7300 Epoch=28.1] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.681 | L2-Norm(final)=2.419 | 4220.3 samples/s | 65.9 steps/s
[Step=7350 Epoch=28.3] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.659 | L2-Norm(final)=2.424 | 4175.1 samples/s | 65.2 steps/s
[Step=7400 Epoch=28.5] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.637 | L2-Norm(final)=2.429 | 4153.8 samples/s | 64.9 steps/s
[Step=7450 Epoch=28.7] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.615 | L2-Norm(final)=2.434 | 5386.7 samples/s | 84.2 steps/s
[Step=7500 Epoch=28.9] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.593 | L2-Norm(final)=2.441 | 1845.4 samples/s | 28.8 steps/s
[Step=7550 Epoch=29.1] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.571 | L2-Norm(final)=2.446 | 4174.2 samples/s | 65.2 steps/s
[Step=7600 Epoch=29.3] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.549 | L2-Norm(final)=2.452 | 4148.7 samples/s | 64.8 steps/s
[Step=7650 Epoch=29.4] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.527 | L2-Norm(final)=2.458 | 4213.2 samples/s | 65.8 steps/s
[Step=7700 Epoch=29.6] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.506 | L2-Norm(final)=2.464 | 4695.4 samples/s | 73.4 steps/s
[Step=7750 Epoch=29.8] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.484 | L2-Norm(final)=2.470 | 1841.4 samples/s | 28.8 steps/s
[Step=7800 Epoch=30.0] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.463 | L2-Norm(final)=2.475 | 4186.6 samples/s | 65.4 steps/s
[Step=7850 Epoch=30.2] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.441 | L2-Norm(final)=2.481 | 4207.6 samples/s | 65.7 steps/s
[Step=7900 Epoch=30.4] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.419 | L2-Norm(final)=2.486 | 4307.6 samples/s | 67.3 steps/s
[Step=7950 Epoch=30.6] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.397 | L2-Norm(final)=2.492 | 4235.1 samples/s | 66.2 steps/s
[Step=8000 Epoch=30.8] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.374 | L2-Norm(final)=2.497 | 1948.5 samples/s | 30.4 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step8000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10538 | acc=0.9498 | tpr=0.9490 | fpr=0.0486 | 3948.9 samples/s | 15.4 steps/s
Avg test loss: 0.10881, Avg test acc: 0.94980, Avg tpr: 0.94976, Avg fpr: 0.05012, total FA: 391

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09701 | acc=0.9555 | tpr=0.9626 | fpr=0.0597 | 4039.2 samples/s | 15.8 steps/s
Avg test loss: 0.09996, Avg test acc: 0.95456, Avg tpr: 0.96270, Avg fpr: 0.06333, total FA: 494

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=3.87120 | acc=0.3141 | tpr=0.0063 | fpr=0.0176 | 4156.8 samples/s | 16.2 steps/s
Avg test loss: 3.88004, Avg test acc: 0.31216, Avg tpr: 0.00688, Avg fpr: 0.01641, total FA: 128

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=7.07321 | acc=0.3155 | tpr=0.0008 | fpr=0.0012 | 4129.7 samples/s | 16.1 steps/s
Avg test loss: 7.11452, Avg test acc: 0.31281, Avg tpr: 0.00128, Avg fpr: 0.00205, total FA: 16

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.14862 | acc=0.1813 | tpr=0.7611 | fpr=0.8291 | 4100.1 samples/s | 16.0 steps/s
[Step= 100] | Loss=4.12131 | acc=0.1843 | tpr=0.7420 | fpr=0.8261 | 8300.7 samples/s | 32.4 steps/s
[Step= 150] | Loss=4.15242 | acc=0.1835 | tpr=0.7320 | fpr=0.8266 | 7869.7 samples/s | 30.7 steps/s
[Step= 200] | Loss=4.15239 | acc=0.1844 | tpr=0.7268 | fpr=0.8255 | 7760.8 samples/s | 30.3 steps/s
[Step= 250] | Loss=4.16155 | acc=0.1832 | tpr=0.7258 | fpr=0.8266 | 7971.5 samples/s | 31.1 steps/s
[Step= 300] | Loss=4.16201 | acc=0.1825 | tpr=0.7273 | fpr=0.8274 | 7548.9 samples/s | 29.5 steps/s
[Step= 350] | Loss=4.16016 | acc=0.1829 | tpr=0.7282 | fpr=0.8269 | 7791.1 samples/s | 30.4 steps/s
[Step= 400] | Loss=4.16591 | acc=0.1833 | tpr=0.7336 | fpr=0.8267 | 7920.6 samples/s | 30.9 steps/s
[Step= 450] | Loss=4.16640 | acc=0.1830 | tpr=0.7386 | fpr=0.8271 | 7793.7 samples/s | 30.4 steps/s
[Step= 500] | Loss=4.16927 | acc=0.1822 | tpr=0.7361 | fpr=0.8278 | 8321.3 samples/s | 32.5 steps/s
[Step= 550] | Loss=4.17062 | acc=0.1823 | tpr=0.7366 | fpr=0.8277 | 14089.7 samples/s | 55.0 steps/s
Avg test loss: 4.17320, Avg test acc: 0.18219, Avg tpr: 0.73613, Avg fpr: 0.82788, total FA: 114949

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.40095 | acc=0.1525 | tpr=0.7389 | fpr=0.8580 | 3981.5 samples/s | 15.6 steps/s
[Step= 100] | Loss=5.38618 | acc=0.1523 | tpr=0.7058 | fpr=0.8580 | 7839.6 samples/s | 30.6 steps/s
[Step= 150] | Loss=5.39244 | acc=0.1521 | tpr=0.6988 | fpr=0.8580 | 7771.8 samples/s | 30.4 steps/s
[Step= 200] | Loss=5.37974 | acc=0.1534 | tpr=0.7005 | fpr=0.8566 | 7463.2 samples/s | 29.2 steps/s
[Step= 250] | Loss=5.38451 | acc=0.1531 | tpr=0.6934 | fpr=0.8568 | 7426.7 samples/s | 29.0 steps/s
[Step= 300] | Loss=5.38569 | acc=0.1525 | tpr=0.6931 | fpr=0.8573 | 7416.8 samples/s | 29.0 steps/s
[Step= 350] | Loss=5.38302 | acc=0.1524 | tpr=0.6938 | fpr=0.8574 | 7559.7 samples/s | 29.5 steps/s
[Step= 400] | Loss=5.37980 | acc=0.1527 | tpr=0.7024 | fpr=0.8572 | 7776.8 samples/s | 30.4 steps/s
[Step= 450] | Loss=5.38620 | acc=0.1526 | tpr=0.7045 | fpr=0.8574 | 7081.7 samples/s | 27.7 steps/s
[Step= 500] | Loss=5.39468 | acc=0.1519 | tpr=0.7031 | fpr=0.8580 | 7492.5 samples/s | 29.3 steps/s
[Step= 550] | Loss=5.39368 | acc=0.1521 | tpr=0.7051 | fpr=0.8579 | 13463.1 samples/s | 52.6 steps/s
Avg test loss: 5.39591, Avg test acc: 0.15195, Avg tpr: 0.70523, Avg fpr: 0.85810, total FA: 119146

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.07908 | acc=0.9815 | tpr=0.9425 | fpr=0.0178 | 4066.0 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.08001 | acc=0.9815 | tpr=0.9638 | fpr=0.0182 | 7561.1 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.08395 | acc=0.9804 | tpr=0.9640 | fpr=0.0193 | 7562.6 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.08495 | acc=0.9804 | tpr=0.9661 | fpr=0.0194 | 7702.2 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.08440 | acc=0.9806 | tpr=0.9633 | fpr=0.0191 | 7650.0 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.08519 | acc=0.9803 | tpr=0.9615 | fpr=0.0193 | 7276.9 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.08575 | acc=0.9801 | tpr=0.9612 | fpr=0.0196 | 7363.7 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.08690 | acc=0.9797 | tpr=0.9584 | fpr=0.0199 | 7329.6 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.08842 | acc=0.9793 | tpr=0.9562 | fpr=0.0202 | 7430.1 samples/s | 29.0 steps/s
[Step= 500] | Loss=0.08785 | acc=0.9795 | tpr=0.9568 | fpr=0.0201 | 7229.0 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.08731 | acc=0.9797 | tpr=0.9558 | fpr=0.0199 | 13840.5 samples/s | 54.1 steps/s
Avg test loss: 0.08721, Avg test acc: 0.97968, Avg tpr: 0.95602, Avg fpr: 0.01989, total FA: 2761

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11438 | acc=0.9814 | tpr=0.9469 | fpr=0.0180 | 4046.7 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.11832 | acc=0.9804 | tpr=0.9638 | fpr=0.0193 | 7754.0 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.12392 | acc=0.9794 | tpr=0.9611 | fpr=0.0202 | 7449.6 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.12567 | acc=0.9794 | tpr=0.9596 | fpr=0.0203 | 7460.7 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.12400 | acc=0.9795 | tpr=0.9598 | fpr=0.0201 | 7511.0 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.12643 | acc=0.9793 | tpr=0.9578 | fpr=0.0203 | 7693.2 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.12707 | acc=0.9793 | tpr=0.9580 | fpr=0.0204 | 7947.2 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.12809 | acc=0.9789 | tpr=0.9557 | fpr=0.0206 | 7560.3 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.13066 | acc=0.9786 | tpr=0.9537 | fpr=0.0209 | 7774.5 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.12980 | acc=0.9787 | tpr=0.9559 | fpr=0.0209 | 7717.0 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.12884 | acc=0.9789 | tpr=0.9566 | fpr=0.0207 | 14500.2 samples/s | 56.6 steps/s
Avg test loss: 0.12866, Avg test acc: 0.97888, Avg tpr: 0.95642, Avg fpr: 0.02071, total FA: 2876

server round 10/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00050, len=1
[Step=8001 Epoch=15.6] | Loss=0.06121 | Reg=0.00424 | acc=0.9531 | L2-Norm=20.587 | L2-Norm(final)=2.156 | 3788.1 samples/s | 59.2 steps/s
[Step=8050 Epoch=15.7] | Loss=0.01713 | Reg=0.00424 | acc=1.0000 | L2-Norm=20.584 | L2-Norm(final)=2.151 | 4297.3 samples/s | 67.1 steps/s
[Step=8100 Epoch=15.8] | Loss=0.01385 | Reg=0.00424 | acc=1.0000 | L2-Norm=20.580 | L2-Norm(final)=2.154 | 4656.6 samples/s | 72.8 steps/s
[Step=8150 Epoch=15.9] | Loss=0.01330 | Reg=0.00423 | acc=0.9844 | L2-Norm=20.576 | L2-Norm(final)=2.157 | 4611.6 samples/s | 72.1 steps/s
[Step=8200 Epoch=16.0] | Loss=0.01279 | Reg=0.00423 | acc=1.0000 | L2-Norm=20.572 | L2-Norm(final)=2.160 | 4521.3 samples/s | 70.6 steps/s
[Step=8250 Epoch=16.1] | Loss=0.01212 | Reg=0.00423 | acc=0.9688 | L2-Norm=20.567 | L2-Norm(final)=2.162 | 4551.3 samples/s | 71.1 steps/s
[Step=8300 Epoch=16.2] | Loss=0.01193 | Reg=0.00423 | acc=0.9844 | L2-Norm=20.561 | L2-Norm(final)=2.165 | 4632.8 samples/s | 72.4 steps/s
[Step=8350 Epoch=16.3] | Loss=0.01192 | Reg=0.00423 | acc=0.9531 | L2-Norm=20.555 | L2-Norm(final)=2.167 | 4791.7 samples/s | 74.9 steps/s
[Step=8400 Epoch=16.4] | Loss=0.01180 | Reg=0.00422 | acc=0.9844 | L2-Norm=20.548 | L2-Norm(final)=2.169 | 4606.2 samples/s | 72.0 steps/s
[Step=8450 Epoch=16.5] | Loss=0.01134 | Reg=0.00422 | acc=0.9844 | L2-Norm=20.542 | L2-Norm(final)=2.171 | 4602.4 samples/s | 71.9 steps/s
[Step=8500 Epoch=16.6] | Loss=0.01133 | Reg=0.00422 | acc=1.0000 | L2-Norm=20.535 | L2-Norm(final)=2.172 | 5520.9 samples/s | 86.3 steps/s
[Step=8550 Epoch=16.7] | Loss=0.01108 | Reg=0.00421 | acc=1.0000 | L2-Norm=20.529 | L2-Norm(final)=2.173 | 1815.0 samples/s | 28.4 steps/s
[Step=8600 Epoch=16.8] | Loss=0.01083 | Reg=0.00421 | acc=1.0000 | L2-Norm=20.522 | L2-Norm(final)=2.175 | 4627.3 samples/s | 72.3 steps/s
[Step=8650 Epoch=16.9] | Loss=0.01070 | Reg=0.00421 | acc=0.9688 | L2-Norm=20.515 | L2-Norm(final)=2.176 | 4667.2 samples/s | 72.9 steps/s
[Step=8700 Epoch=17.0] | Loss=0.01059 | Reg=0.00421 | acc=1.0000 | L2-Norm=20.508 | L2-Norm(final)=2.178 | 4518.7 samples/s | 70.6 steps/s
[Step=8750 Epoch=17.1] | Loss=0.01047 | Reg=0.00420 | acc=0.9688 | L2-Norm=20.501 | L2-Norm(final)=2.179 | 4535.5 samples/s | 70.9 steps/s
[Step=8800 Epoch=17.2] | Loss=0.01028 | Reg=0.00420 | acc=0.9844 | L2-Norm=20.493 | L2-Norm(final)=2.180 | 4593.6 samples/s | 71.8 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step8800.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00050, len=1
[Step=8001 Epoch=15.6] | Loss=0.00402 | Reg=0.00417 | acc=1.0000 | L2-Norm=20.415 | L2-Norm(final)=2.067 | 4332.4 samples/s | 67.7 steps/s
[Step=8050 Epoch=15.7] | Loss=0.01249 | Reg=0.00417 | acc=0.9844 | L2-Norm=20.414 | L2-Norm(final)=2.071 | 4470.4 samples/s | 69.9 steps/s
[Step=8100 Epoch=15.8] | Loss=0.01338 | Reg=0.00416 | acc=0.9688 | L2-Norm=20.408 | L2-Norm(final)=2.073 | 4636.7 samples/s | 72.4 steps/s
[Step=8150 Epoch=15.9] | Loss=0.01356 | Reg=0.00416 | acc=1.0000 | L2-Norm=20.402 | L2-Norm(final)=2.071 | 4580.9 samples/s | 71.6 steps/s
[Step=8200 Epoch=16.0] | Loss=0.01273 | Reg=0.00416 | acc=1.0000 | L2-Norm=20.396 | L2-Norm(final)=2.071 | 4701.8 samples/s | 73.5 steps/s
[Step=8250 Epoch=16.1] | Loss=0.01211 | Reg=0.00416 | acc=1.0000 | L2-Norm=20.391 | L2-Norm(final)=2.073 | 4411.3 samples/s | 68.9 steps/s
[Step=8300 Epoch=16.2] | Loss=0.01132 | Reg=0.00416 | acc=0.9688 | L2-Norm=20.386 | L2-Norm(final)=2.076 | 4668.2 samples/s | 72.9 steps/s
[Step=8350 Epoch=16.3] | Loss=0.01165 | Reg=0.00415 | acc=0.9844 | L2-Norm=20.380 | L2-Norm(final)=2.079 | 4579.0 samples/s | 71.5 steps/s
[Step=8400 Epoch=16.4] | Loss=0.01168 | Reg=0.00415 | acc=0.9844 | L2-Norm=20.374 | L2-Norm(final)=2.081 | 4483.4 samples/s | 70.1 steps/s
[Step=8450 Epoch=16.5] | Loss=0.01131 | Reg=0.00415 | acc=0.9844 | L2-Norm=20.368 | L2-Norm(final)=2.082 | 4547.5 samples/s | 71.1 steps/s
[Step=8500 Epoch=16.6] | Loss=0.01149 | Reg=0.00415 | acc=0.9688 | L2-Norm=20.362 | L2-Norm(final)=2.083 | 5415.4 samples/s | 84.6 steps/s
[Step=8550 Epoch=16.7] | Loss=0.01123 | Reg=0.00414 | acc=1.0000 | L2-Norm=20.356 | L2-Norm(final)=2.084 | 1843.2 samples/s | 28.8 steps/s
[Step=8600 Epoch=16.8] | Loss=0.01100 | Reg=0.00414 | acc=1.0000 | L2-Norm=20.349 | L2-Norm(final)=2.086 | 4382.1 samples/s | 68.5 steps/s
[Step=8650 Epoch=16.9] | Loss=0.01079 | Reg=0.00414 | acc=0.9844 | L2-Norm=20.342 | L2-Norm(final)=2.087 | 4372.0 samples/s | 68.3 steps/s
[Step=8700 Epoch=17.0] | Loss=0.01058 | Reg=0.00414 | acc=1.0000 | L2-Norm=20.335 | L2-Norm(final)=2.088 | 4374.6 samples/s | 68.4 steps/s
[Step=8750 Epoch=17.1] | Loss=0.01046 | Reg=0.00413 | acc=1.0000 | L2-Norm=20.328 | L2-Norm(final)=2.089 | 4461.3 samples/s | 69.7 steps/s
[Step=8800 Epoch=17.2] | Loss=0.01030 | Reg=0.00413 | acc=1.0000 | L2-Norm=20.321 | L2-Norm(final)=2.090 | 4556.7 samples/s | 71.2 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step8800.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00050, len=1
[Step=8001 Epoch=30.7] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.409 | L2-Norm(final)=3.642 | 4077.7 samples/s | 63.7 steps/s
[Step=8050 Epoch=30.8] | Loss=0.00002 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.398 | L2-Norm(final)=3.646 | 3708.4 samples/s | 57.9 steps/s
[Step=8100 Epoch=31.0] | Loss=0.00003 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.389 | L2-Norm(final)=3.649 | 4223.9 samples/s | 66.0 steps/s
[Step=8150 Epoch=31.2] | Loss=0.00003 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=3.652 | 4239.6 samples/s | 66.2 steps/s
[Step=8200 Epoch=31.4] | Loss=0.00003 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.371 | L2-Norm(final)=3.655 | 4291.5 samples/s | 67.1 steps/s
[Step=8250 Epoch=31.6] | Loss=0.00003 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.362 | L2-Norm(final)=3.659 | 5372.9 samples/s | 84.0 steps/s
[Step=8300 Epoch=31.8] | Loss=0.00003 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.353 | L2-Norm(final)=3.663 | 1828.3 samples/s | 28.6 steps/s
[Step=8350 Epoch=32.0] | Loss=0.00003 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.344 | L2-Norm(final)=3.666 | 4259.7 samples/s | 66.6 steps/s
[Step=8400 Epoch=32.2] | Loss=0.00003 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.335 | L2-Norm(final)=3.670 | 4202.6 samples/s | 65.7 steps/s
[Step=8450 Epoch=32.4] | Loss=0.00003 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.326 | L2-Norm(final)=3.674 | 4205.5 samples/s | 65.7 steps/s
[Step=8500 Epoch=32.6] | Loss=0.00003 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.317 | L2-Norm(final)=3.678 | 4723.1 samples/s | 73.8 steps/s
[Step=8550 Epoch=32.8] | Loss=0.00003 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.308 | L2-Norm(final)=3.682 | 1925.9 samples/s | 30.1 steps/s
[Step=8600 Epoch=33.0] | Loss=0.00003 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.300 | L2-Norm(final)=3.686 | 4265.1 samples/s | 66.6 steps/s
[Step=8650 Epoch=33.1] | Loss=0.00003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.291 | L2-Norm(final)=3.691 | 4291.1 samples/s | 67.0 steps/s
[Step=8700 Epoch=33.3] | Loss=0.00003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.282 | L2-Norm(final)=3.695 | 4296.9 samples/s | 67.1 steps/s
[Step=8750 Epoch=33.5] | Loss=0.00003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.273 | L2-Norm(final)=3.700 | 4213.0 samples/s | 65.8 steps/s
[Step=8800 Epoch=33.7] | Loss=0.00003 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.263 | L2-Norm(final)=3.704 | 2026.8 samples/s | 31.7 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step8800.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00050, len=1
[Step=8001 Epoch=30.8] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.010 | L2-Norm(final)=2.582 | 3925.8 samples/s | 61.3 steps/s
[Step=8050 Epoch=31.0] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.998 | L2-Norm(final)=2.584 | 3945.7 samples/s | 61.7 steps/s
[Step=8100 Epoch=31.2] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.985 | L2-Norm(final)=2.586 | 4253.6 samples/s | 66.5 steps/s
[Step=8150 Epoch=31.4] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.973 | L2-Norm(final)=2.589 | 4177.2 samples/s | 65.3 steps/s
[Step=8200 Epoch=31.6] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.961 | L2-Norm(final)=2.592 | 4214.6 samples/s | 65.9 steps/s
[Step=8250 Epoch=31.8] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.948 | L2-Norm(final)=2.594 | 5399.9 samples/s | 84.4 steps/s
[Step=8300 Epoch=31.9] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.935 | L2-Norm(final)=2.597 | 1760.3 samples/s | 27.5 steps/s
[Step=8350 Epoch=32.1] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.922 | L2-Norm(final)=2.600 | 3952.6 samples/s | 61.8 steps/s
[Step=8400 Epoch=32.3] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.909 | L2-Norm(final)=2.602 | 4089.9 samples/s | 63.9 steps/s
[Step=8450 Epoch=32.5] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.895 | L2-Norm(final)=2.605 | 4136.1 samples/s | 64.6 steps/s
[Step=8500 Epoch=32.7] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.882 | L2-Norm(final)=2.608 | 4802.8 samples/s | 75.0 steps/s
[Step=8550 Epoch=32.9] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.869 | L2-Norm(final)=2.611 | 1884.0 samples/s | 29.4 steps/s
[Step=8600 Epoch=33.1] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.855 | L2-Norm(final)=2.614 | 4243.7 samples/s | 66.3 steps/s
[Step=8650 Epoch=33.3] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.842 | L2-Norm(final)=2.617 | 4159.0 samples/s | 65.0 steps/s
[Step=8700 Epoch=33.5] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.828 | L2-Norm(final)=2.621 | 4218.7 samples/s | 65.9 steps/s
[Step=8750 Epoch=33.7] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.814 | L2-Norm(final)=2.624 | 4322.8 samples/s | 67.5 steps/s
[Step=8800 Epoch=33.9] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.800 | L2-Norm(final)=2.627 | 1944.5 samples/s | 30.4 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step8800.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11872 | acc=0.9577 | tpr=0.9627 | fpr=0.0533 | 4094.6 samples/s | 16.0 steps/s
Avg test loss: 0.12611, Avg test acc: 0.95524, Avg tpr: 0.96089, Avg fpr: 0.05717, total FA: 446

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10661 | acc=0.9587 | tpr=0.9642 | fpr=0.0530 | 4079.1 samples/s | 15.9 steps/s
Avg test loss: 0.10905, Avg test acc: 0.95893, Avg tpr: 0.96538, Avg fpr: 0.05525, total FA: 431

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=3.83872 | acc=0.3142 | tpr=0.0062 | fpr=0.0168 | 4227.5 samples/s | 16.5 steps/s
Avg test loss: 3.84779, Avg test acc: 0.31228, Avg tpr: 0.00682, Avg fpr: 0.01590, total FA: 124

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.63730 | acc=0.3152 | tpr=0.0011 | fpr=0.0027 | 4102.5 samples/s | 16.0 steps/s
Avg test loss: 6.67637, Avg test acc: 0.31261, Avg tpr: 0.00146, Avg fpr: 0.00308, total FA: 24

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.46939 | acc=0.1853 | tpr=0.7080 | fpr=0.8241 | 4226.7 samples/s | 16.5 steps/s
[Step= 100] | Loss=5.42674 | acc=0.1877 | tpr=0.6887 | fpr=0.8217 | 7948.6 samples/s | 31.0 steps/s
[Step= 150] | Loss=5.46136 | acc=0.1872 | tpr=0.6787 | fpr=0.8218 | 7702.8 samples/s | 30.1 steps/s
[Step= 200] | Loss=5.45798 | acc=0.1877 | tpr=0.6689 | fpr=0.8210 | 8406.5 samples/s | 32.8 steps/s
[Step= 250] | Loss=5.46698 | acc=0.1869 | tpr=0.6690 | fpr=0.8219 | 7643.2 samples/s | 29.9 steps/s
[Step= 300] | Loss=5.46650 | acc=0.1869 | tpr=0.6720 | fpr=0.8220 | 7774.4 samples/s | 30.4 steps/s
[Step= 350] | Loss=5.46188 | acc=0.1875 | tpr=0.6725 | fpr=0.8213 | 8246.6 samples/s | 32.2 steps/s
[Step= 400] | Loss=5.47097 | acc=0.1871 | tpr=0.6701 | fpr=0.8217 | 7379.5 samples/s | 28.8 steps/s
[Step= 450] | Loss=5.46979 | acc=0.1867 | tpr=0.6723 | fpr=0.8221 | 8057.2 samples/s | 31.5 steps/s
[Step= 500] | Loss=5.47354 | acc=0.1857 | tpr=0.6731 | fpr=0.8231 | 5513.0 samples/s | 21.5 steps/s
[Step= 550] | Loss=5.47458 | acc=0.1857 | tpr=0.6729 | fpr=0.8232 | 10075.7 samples/s | 39.4 steps/s
Avg test loss: 5.47773, Avg test acc: 0.18554, Avg tpr: 0.67235, Avg fpr: 0.82331, total FA: 114315

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.74932 | acc=0.1525 | tpr=0.7478 | fpr=0.8582 | 3997.2 samples/s | 15.6 steps/s
[Step= 100] | Loss=6.72318 | acc=0.1520 | tpr=0.7292 | fpr=0.8588 | 7533.4 samples/s | 29.4 steps/s
[Step= 150] | Loss=6.73609 | acc=0.1513 | tpr=0.7176 | fpr=0.8591 | 7523.4 samples/s | 29.4 steps/s
[Step= 200] | Loss=6.72115 | acc=0.1523 | tpr=0.7137 | fpr=0.8579 | 7781.3 samples/s | 30.4 steps/s
[Step= 250] | Loss=6.72450 | acc=0.1527 | tpr=0.7074 | fpr=0.8574 | 7188.3 samples/s | 28.1 steps/s
[Step= 300] | Loss=6.72519 | acc=0.1524 | tpr=0.7047 | fpr=0.8577 | 7942.6 samples/s | 31.0 steps/s
[Step= 350] | Loss=6.72445 | acc=0.1518 | tpr=0.7063 | fpr=0.8582 | 7613.1 samples/s | 29.7 steps/s
[Step= 400] | Loss=6.72016 | acc=0.1523 | tpr=0.7183 | fpr=0.8580 | 7317.7 samples/s | 28.6 steps/s
[Step= 450] | Loss=6.72713 | acc=0.1522 | tpr=0.7191 | fpr=0.8581 | 7483.0 samples/s | 29.2 steps/s
[Step= 500] | Loss=6.73882 | acc=0.1517 | tpr=0.7163 | fpr=0.8585 | 4873.3 samples/s | 19.0 steps/s
[Step= 550] | Loss=6.73912 | acc=0.1516 | tpr=0.7135 | fpr=0.8586 | 13374.3 samples/s | 52.2 steps/s
Avg test loss: 6.74157, Avg test acc: 0.15147, Avg tpr: 0.71315, Avg fpr: 0.85874, total FA: 119234

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08184 | acc=0.9819 | tpr=0.9425 | fpr=0.0174 | 4039.4 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.08276 | acc=0.9819 | tpr=0.9638 | fpr=0.0177 | 7570.8 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.08679 | acc=0.9808 | tpr=0.9640 | fpr=0.0189 | 7366.1 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.08778 | acc=0.9808 | tpr=0.9661 | fpr=0.0189 | 7451.1 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.08725 | acc=0.9810 | tpr=0.9624 | fpr=0.0187 | 7354.2 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.08806 | acc=0.9807 | tpr=0.9600 | fpr=0.0190 | 7751.7 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.08863 | acc=0.9805 | tpr=0.9599 | fpr=0.0191 | 8509.4 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.08981 | acc=0.9802 | tpr=0.9573 | fpr=0.0194 | 8005.8 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.09137 | acc=0.9798 | tpr=0.9552 | fpr=0.0197 | 8058.1 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.09078 | acc=0.9800 | tpr=0.9559 | fpr=0.0196 | 5345.3 samples/s | 20.9 steps/s
[Step= 550] | Loss=0.09023 | acc=0.9801 | tpr=0.9550 | fpr=0.0194 | 14982.8 samples/s | 58.5 steps/s
Avg test loss: 0.09014, Avg test acc: 0.98014, Avg tpr: 0.95523, Avg fpr: 0.01941, total FA: 2695

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11816 | acc=0.9802 | tpr=0.9558 | fpr=0.0193 | 4334.3 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.12263 | acc=0.9795 | tpr=0.9723 | fpr=0.0203 | 8490.9 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.12855 | acc=0.9785 | tpr=0.9683 | fpr=0.0213 | 7713.1 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.13023 | acc=0.9786 | tpr=0.9694 | fpr=0.0213 | 8084.1 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.12858 | acc=0.9787 | tpr=0.9694 | fpr=0.0211 | 8144.0 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.13097 | acc=0.9786 | tpr=0.9673 | fpr=0.0212 | 8298.8 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.13158 | acc=0.9785 | tpr=0.9681 | fpr=0.0213 | 8399.6 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.13268 | acc=0.9782 | tpr=0.9644 | fpr=0.0216 | 7740.2 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.13529 | acc=0.9778 | tpr=0.9620 | fpr=0.0219 | 5839.9 samples/s | 22.8 steps/s
[Step= 500] | Loss=0.13446 | acc=0.9778 | tpr=0.9634 | fpr=0.0219 | 6488.9 samples/s | 25.3 steps/s
[Step= 550] | Loss=0.13346 | acc=0.9780 | tpr=0.9642 | fpr=0.0218 | 14572.4 samples/s | 56.9 steps/s
Avg test loss: 0.13327, Avg test acc: 0.97801, Avg tpr: 0.96395, Avg fpr: 0.02174, total FA: 3018

server round 11/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00050, len=1
[Step=8801 Epoch=17.2] | Loss=0.00674 | Reg=0.00415 | acc=1.0000 | L2-Norm=20.374 | L2-Norm(final)=2.206 | 3942.7 samples/s | 61.6 steps/s
[Step=8850 Epoch=17.3] | Loss=0.00652 | Reg=0.00415 | acc=1.0000 | L2-Norm=20.369 | L2-Norm(final)=2.210 | 4525.9 samples/s | 70.7 steps/s
[Step=8900 Epoch=17.4] | Loss=0.00754 | Reg=0.00415 | acc=1.0000 | L2-Norm=20.361 | L2-Norm(final)=2.210 | 4639.5 samples/s | 72.5 steps/s
[Step=8950 Epoch=17.5] | Loss=0.00761 | Reg=0.00414 | acc=0.9844 | L2-Norm=20.353 | L2-Norm(final)=2.208 | 4706.2 samples/s | 73.5 steps/s
[Step=9000 Epoch=17.6] | Loss=0.00804 | Reg=0.00414 | acc=0.9844 | L2-Norm=20.345 | L2-Norm(final)=2.207 | 4363.4 samples/s | 68.2 steps/s
[Step=9050 Epoch=17.7] | Loss=0.00838 | Reg=0.00414 | acc=1.0000 | L2-Norm=20.336 | L2-Norm(final)=2.206 | 4262.8 samples/s | 66.6 steps/s
[Step=9100 Epoch=17.7] | Loss=0.00867 | Reg=0.00413 | acc=0.9688 | L2-Norm=20.328 | L2-Norm(final)=2.206 | 4260.9 samples/s | 66.6 steps/s
[Step=9150 Epoch=17.8] | Loss=0.00859 | Reg=0.00413 | acc=1.0000 | L2-Norm=20.321 | L2-Norm(final)=2.206 | 4399.1 samples/s | 68.7 steps/s
[Step=9200 Epoch=17.9] | Loss=0.00870 | Reg=0.00413 | acc=1.0000 | L2-Norm=20.314 | L2-Norm(final)=2.207 | 4709.6 samples/s | 73.6 steps/s
[Step=9250 Epoch=18.0] | Loss=0.00870 | Reg=0.00412 | acc=0.9844 | L2-Norm=20.306 | L2-Norm(final)=2.207 | 4559.1 samples/s | 71.2 steps/s
[Step=9300 Epoch=18.1] | Loss=0.00884 | Reg=0.00412 | acc=1.0000 | L2-Norm=20.299 | L2-Norm(final)=2.207 | 5488.7 samples/s | 85.8 steps/s
[Step=9350 Epoch=18.2] | Loss=0.00889 | Reg=0.00412 | acc=1.0000 | L2-Norm=20.292 | L2-Norm(final)=2.208 | 1843.9 samples/s | 28.8 steps/s
[Step=9400 Epoch=18.3] | Loss=0.00881 | Reg=0.00411 | acc=0.9688 | L2-Norm=20.284 | L2-Norm(final)=2.208 | 4548.2 samples/s | 71.1 steps/s
[Step=9450 Epoch=18.4] | Loss=0.00870 | Reg=0.00411 | acc=1.0000 | L2-Norm=20.277 | L2-Norm(final)=2.208 | 4556.8 samples/s | 71.2 steps/s
[Step=9500 Epoch=18.5] | Loss=0.00883 | Reg=0.00411 | acc=1.0000 | L2-Norm=20.269 | L2-Norm(final)=2.209 | 4519.8 samples/s | 70.6 steps/s
[Step=9550 Epoch=18.6] | Loss=0.00886 | Reg=0.00411 | acc=1.0000 | L2-Norm=20.262 | L2-Norm(final)=2.209 | 4541.0 samples/s | 71.0 steps/s
[Step=9600 Epoch=18.7] | Loss=0.00886 | Reg=0.00410 | acc=1.0000 | L2-Norm=20.255 | L2-Norm(final)=2.210 | 4581.9 samples/s | 71.6 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step9600.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00050, len=1
[Step=8801 Epoch=17.2] | Loss=0.00288 | Reg=0.00408 | acc=1.0000 | L2-Norm=20.198 | L2-Norm(final)=2.108 | 4080.7 samples/s | 63.8 steps/s
[Step=8850 Epoch=17.3] | Loss=0.00833 | Reg=0.00408 | acc=1.0000 | L2-Norm=20.189 | L2-Norm(final)=2.109 | 4428.4 samples/s | 69.2 steps/s
[Step=8900 Epoch=17.4] | Loss=0.00833 | Reg=0.00407 | acc=1.0000 | L2-Norm=20.181 | L2-Norm(final)=2.109 | 4506.2 samples/s | 70.4 steps/s
[Step=8950 Epoch=17.5] | Loss=0.00782 | Reg=0.00407 | acc=1.0000 | L2-Norm=20.171 | L2-Norm(final)=2.110 | 4557.1 samples/s | 71.2 steps/s
[Step=9000 Epoch=17.6] | Loss=0.00795 | Reg=0.00407 | acc=0.9844 | L2-Norm=20.163 | L2-Norm(final)=2.110 | 4549.5 samples/s | 71.1 steps/s
[Step=9050 Epoch=17.7] | Loss=0.00772 | Reg=0.00406 | acc=1.0000 | L2-Norm=20.154 | L2-Norm(final)=2.111 | 4508.7 samples/s | 70.4 steps/s
[Step=9100 Epoch=17.8] | Loss=0.00827 | Reg=0.00406 | acc=1.0000 | L2-Norm=20.146 | L2-Norm(final)=2.111 | 4509.1 samples/s | 70.5 steps/s
[Step=9150 Epoch=17.9] | Loss=0.00822 | Reg=0.00406 | acc=0.9844 | L2-Norm=20.137 | L2-Norm(final)=2.111 | 4555.8 samples/s | 71.2 steps/s
[Step=9200 Epoch=18.0] | Loss=0.00831 | Reg=0.00405 | acc=1.0000 | L2-Norm=20.129 | L2-Norm(final)=2.112 | 4472.4 samples/s | 69.9 steps/s
[Step=9250 Epoch=18.1] | Loss=0.00869 | Reg=0.00405 | acc=1.0000 | L2-Norm=20.120 | L2-Norm(final)=2.112 | 4533.2 samples/s | 70.8 steps/s
[Step=9300 Epoch=18.2] | Loss=0.00859 | Reg=0.00404 | acc=0.9844 | L2-Norm=20.112 | L2-Norm(final)=2.113 | 5599.1 samples/s | 87.5 steps/s
[Step=9350 Epoch=18.3] | Loss=0.00860 | Reg=0.00404 | acc=1.0000 | L2-Norm=20.104 | L2-Norm(final)=2.114 | 1895.8 samples/s | 29.6 steps/s
[Step=9400 Epoch=18.4] | Loss=0.00835 | Reg=0.00404 | acc=0.9844 | L2-Norm=20.096 | L2-Norm(final)=2.115 | 4454.0 samples/s | 69.6 steps/s
[Step=9450 Epoch=18.5] | Loss=0.00841 | Reg=0.00404 | acc=1.0000 | L2-Norm=20.088 | L2-Norm(final)=2.116 | 4553.7 samples/s | 71.2 steps/s
[Step=9500 Epoch=18.6] | Loss=0.00834 | Reg=0.00403 | acc=0.9844 | L2-Norm=20.079 | L2-Norm(final)=2.118 | 4510.3 samples/s | 70.5 steps/s
[Step=9550 Epoch=18.7] | Loss=0.00813 | Reg=0.00403 | acc=1.0000 | L2-Norm=20.071 | L2-Norm(final)=2.119 | 4407.7 samples/s | 68.9 steps/s
[Step=9600 Epoch=18.8] | Loss=0.00808 | Reg=0.00403 | acc=1.0000 | L2-Norm=20.063 | L2-Norm(final)=2.121 | 4442.2 samples/s | 69.4 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step9600.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00050, len=1
[Step=8801 Epoch=33.7] | Loss=0.00002 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.118 | L2-Norm(final)=3.782 | 4007.9 samples/s | 62.6 steps/s
[Step=8850 Epoch=33.9] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.109 | L2-Norm(final)=3.787 | 4030.0 samples/s | 63.0 steps/s
[Step=8900 Epoch=34.1] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.100 | L2-Norm(final)=3.793 | 4134.2 samples/s | 64.6 steps/s
[Step=8950 Epoch=34.3] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.091 | L2-Norm(final)=3.800 | 4192.0 samples/s | 65.5 steps/s
[Step=9000 Epoch=34.5] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.083 | L2-Norm(final)=3.807 | 4192.7 samples/s | 65.5 steps/s
[Step=9050 Epoch=34.7] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.073 | L2-Norm(final)=3.814 | 5173.8 samples/s | 80.8 steps/s
[Step=9100 Epoch=34.9] | Loss=0.00002 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.064 | L2-Norm(final)=3.821 | 1807.5 samples/s | 28.2 steps/s
[Step=9150 Epoch=35.1] | Loss=0.00002 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.054 | L2-Norm(final)=3.828 | 4124.6 samples/s | 64.4 steps/s
[Step=9200 Epoch=35.3] | Loss=0.00002 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.045 | L2-Norm(final)=3.835 | 4227.4 samples/s | 66.1 steps/s
[Step=9250 Epoch=35.4] | Loss=0.00002 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.035 | L2-Norm(final)=3.842 | 4263.8 samples/s | 66.6 steps/s
[Step=9300 Epoch=35.6] | Loss=0.00002 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.026 | L2-Norm(final)=3.850 | 4605.9 samples/s | 72.0 steps/s
[Step=9350 Epoch=35.8] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=3.858 | 1895.2 samples/s | 29.6 steps/s
[Step=9400 Epoch=36.0] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.008 | L2-Norm(final)=3.867 | 4211.1 samples/s | 65.8 steps/s
[Step=9450 Epoch=36.2] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.998 | L2-Norm(final)=3.875 | 4305.0 samples/s | 67.3 steps/s
[Step=9500 Epoch=36.4] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.989 | L2-Norm(final)=3.884 | 4186.0 samples/s | 65.4 steps/s
[Step=9550 Epoch=36.6] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.980 | L2-Norm(final)=3.892 | 4021.5 samples/s | 62.8 steps/s
[Step=9600 Epoch=36.8] | Loss=0.00002 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.970 | L2-Norm(final)=3.901 | 1971.0 samples/s | 30.8 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step9600.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00050, len=1
[Step=8801 Epoch=33.9] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.574 | L2-Norm(final)=2.680 | 4079.7 samples/s | 63.7 steps/s
[Step=8850 Epoch=34.1] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.560 | L2-Norm(final)=2.683 | 4328.8 samples/s | 67.6 steps/s
[Step=8900 Epoch=34.3] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.545 | L2-Norm(final)=2.687 | 4457.8 samples/s | 69.7 steps/s
[Step=8950 Epoch=34.5] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.529 | L2-Norm(final)=2.691 | 4435.7 samples/s | 69.3 steps/s
[Step=9000 Epoch=34.6] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.514 | L2-Norm(final)=2.695 | 4417.6 samples/s | 69.0 steps/s
[Step=9050 Epoch=34.8] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.498 | L2-Norm(final)=2.698 | 5715.5 samples/s | 89.3 steps/s
[Step=9100 Epoch=35.0] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.482 | L2-Norm(final)=2.702 | 1882.8 samples/s | 29.4 steps/s
[Step=9150 Epoch=35.2] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.466 | L2-Norm(final)=2.706 | 4367.8 samples/s | 68.2 steps/s
[Step=9200 Epoch=35.4] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.450 | L2-Norm(final)=2.710 | 4472.0 samples/s | 69.9 steps/s
[Step=9250 Epoch=35.6] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.434 | L2-Norm(final)=2.714 | 4396.6 samples/s | 68.7 steps/s
[Step=9300 Epoch=35.8] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.418 | L2-Norm(final)=2.718 | 5031.9 samples/s | 78.6 steps/s
[Step=9350 Epoch=36.0] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.401 | L2-Norm(final)=2.723 | 1987.6 samples/s | 31.1 steps/s
[Step=9400 Epoch=36.2] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.385 | L2-Norm(final)=2.727 | 4387.1 samples/s | 68.5 steps/s
[Step=9450 Epoch=36.4] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.368 | L2-Norm(final)=2.731 | 4430.7 samples/s | 69.2 steps/s
[Step=9500 Epoch=36.6] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.351 | L2-Norm(final)=2.735 | 4435.9 samples/s | 69.3 steps/s
[Step=9550 Epoch=36.8] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.334 | L2-Norm(final)=2.740 | 4483.3 samples/s | 70.1 steps/s
[Step=9600 Epoch=37.0] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.317 | L2-Norm(final)=2.744 | 1967.4 samples/s | 30.7 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step9600.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.12399 | acc=0.9577 | tpr=0.9655 | fpr=0.0595 | 4092.4 samples/s | 16.0 steps/s
Avg test loss: 0.13058, Avg test acc: 0.95508, Avg tpr: 0.96357, Avg fpr: 0.06358, total FA: 496

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.11492 | acc=0.9598 | tpr=0.9695 | fpr=0.0614 | 4075.8 samples/s | 15.9 steps/s
Avg test loss: 0.11897, Avg test acc: 0.95901, Avg tpr: 0.96940, Avg fpr: 0.06384, total FA: 498

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.03670 | acc=0.3145 | tpr=0.0054 | fpr=0.0141 | 4071.0 samples/s | 15.9 steps/s
Avg test loss: 4.04651, Avg test acc: 0.31240, Avg tpr: 0.00589, Avg fpr: 0.01346, total FA: 105

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.73071 | acc=0.3157 | tpr=0.0008 | fpr=0.0005 | 4313.1 samples/s | 16.8 steps/s
Avg test loss: 6.77014, Avg test acc: 0.31301, Avg tpr: 0.00093, Avg fpr: 0.00064, total FA: 5

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.25047 | acc=0.1741 | tpr=0.7522 | fpr=0.8362 | 4086.7 samples/s | 16.0 steps/s
[Step= 100] | Loss=5.20676 | acc=0.1767 | tpr=0.7399 | fpr=0.8338 | 7501.4 samples/s | 29.3 steps/s
[Step= 150] | Loss=5.24363 | acc=0.1743 | tpr=0.7233 | fpr=0.8358 | 7736.8 samples/s | 30.2 steps/s
[Step= 200] | Loss=5.23992 | acc=0.1746 | tpr=0.7126 | fpr=0.8351 | 4648.1 samples/s | 18.2 steps/s
[Step= 250] | Loss=5.25036 | acc=0.1735 | tpr=0.7092 | fpr=0.8363 | 7810.9 samples/s | 30.5 steps/s
[Step= 300] | Loss=5.25097 | acc=0.1730 | tpr=0.7113 | fpr=0.8368 | 7623.0 samples/s | 29.8 steps/s
[Step= 350] | Loss=5.24544 | acc=0.1733 | tpr=0.7132 | fpr=0.8365 | 7414.7 samples/s | 29.0 steps/s
[Step= 400] | Loss=5.25283 | acc=0.1733 | tpr=0.7128 | fpr=0.8365 | 7350.1 samples/s | 28.7 steps/s
[Step= 450] | Loss=5.25202 | acc=0.1730 | tpr=0.7171 | fpr=0.8368 | 7588.8 samples/s | 29.6 steps/s
[Step= 500] | Loss=5.25493 | acc=0.1725 | tpr=0.7159 | fpr=0.8373 | 7461.0 samples/s | 29.1 steps/s
[Step= 550] | Loss=5.25592 | acc=0.1724 | tpr=0.7163 | fpr=0.8375 | 13722.2 samples/s | 53.6 steps/s
Avg test loss: 5.25867, Avg test acc: 0.17219, Avg tpr: 0.71553, Avg fpr: 0.83769, total FA: 116311

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.21392 | acc=0.1514 | tpr=0.7876 | fpr=0.8600 | 4051.8 samples/s | 15.8 steps/s
[Step= 100] | Loss=7.18297 | acc=0.1503 | tpr=0.7655 | fpr=0.8612 | 7573.3 samples/s | 29.6 steps/s
[Step= 150] | Loss=7.19237 | acc=0.1496 | tpr=0.7565 | fpr=0.8616 | 7251.3 samples/s | 28.3 steps/s
[Step= 200] | Loss=7.17305 | acc=0.1504 | tpr=0.7530 | fpr=0.8605 | 4671.0 samples/s | 18.2 steps/s
[Step= 250] | Loss=7.17206 | acc=0.1506 | tpr=0.7493 | fpr=0.8603 | 7839.5 samples/s | 30.6 steps/s
[Step= 300] | Loss=7.17452 | acc=0.1505 | tpr=0.7447 | fpr=0.8604 | 7076.7 samples/s | 27.6 steps/s
[Step= 350] | Loss=7.17406 | acc=0.1500 | tpr=0.7445 | fpr=0.8608 | 7312.3 samples/s | 28.6 steps/s
[Step= 400] | Loss=7.17002 | acc=0.1504 | tpr=0.7533 | fpr=0.8605 | 7437.7 samples/s | 29.1 steps/s
[Step= 450] | Loss=7.17721 | acc=0.1504 | tpr=0.7566 | fpr=0.8606 | 7125.9 samples/s | 27.8 steps/s
[Step= 500] | Loss=7.19036 | acc=0.1497 | tpr=0.7542 | fpr=0.8612 | 7628.5 samples/s | 29.8 steps/s
[Step= 550] | Loss=7.19002 | acc=0.1495 | tpr=0.7517 | fpr=0.8615 | 13738.4 samples/s | 53.7 steps/s
Avg test loss: 7.19253, Avg test acc: 0.14937, Avg tpr: 0.75158, Avg fpr: 0.86158, total FA: 119628

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08078 | acc=0.9826 | tpr=0.9292 | fpr=0.0165 | 3883.0 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.08152 | acc=0.9828 | tpr=0.9510 | fpr=0.0166 | 7652.7 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.08542 | acc=0.9817 | tpr=0.9539 | fpr=0.0177 | 4744.0 samples/s | 18.5 steps/s
[Step= 200] | Loss=0.08638 | acc=0.9817 | tpr=0.9563 | fpr=0.0178 | 7792.8 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.08590 | acc=0.9819 | tpr=0.9528 | fpr=0.0176 | 7802.0 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.08672 | acc=0.9816 | tpr=0.9498 | fpr=0.0178 | 7597.3 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.08725 | acc=0.9815 | tpr=0.9505 | fpr=0.0180 | 7996.5 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.08842 | acc=0.9812 | tpr=0.9486 | fpr=0.0182 | 7429.5 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.08995 | acc=0.9809 | tpr=0.9469 | fpr=0.0185 | 7562.8 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.08937 | acc=0.9810 | tpr=0.9485 | fpr=0.0184 | 7637.5 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.08885 | acc=0.9811 | tpr=0.9479 | fpr=0.0183 | 14043.1 samples/s | 54.9 steps/s
Avg test loss: 0.08876, Avg test acc: 0.98115, Avg tpr: 0.94810, Avg fpr: 0.01825, total FA: 2534

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10740 | acc=0.9827 | tpr=0.9336 | fpr=0.0164 | 4177.2 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.11193 | acc=0.9820 | tpr=0.9424 | fpr=0.0173 | 7775.1 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.11723 | acc=0.9815 | tpr=0.9452 | fpr=0.0178 | 4777.2 samples/s | 18.7 steps/s
[Step= 200] | Loss=0.11900 | acc=0.9813 | tpr=0.9464 | fpr=0.0181 | 7618.8 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.11756 | acc=0.9813 | tpr=0.9459 | fpr=0.0180 | 7908.9 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.12009 | acc=0.9811 | tpr=0.9433 | fpr=0.0182 | 7428.4 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.12058 | acc=0.9810 | tpr=0.9436 | fpr=0.0183 | 6956.8 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.12155 | acc=0.9809 | tpr=0.9415 | fpr=0.0184 | 8109.6 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.12409 | acc=0.9806 | tpr=0.9411 | fpr=0.0187 | 7830.5 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.12317 | acc=0.9807 | tpr=0.9432 | fpr=0.0186 | 7366.4 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.12233 | acc=0.9809 | tpr=0.9439 | fpr=0.0185 | 13580.5 samples/s | 53.0 steps/s
Avg test loss: 0.12217, Avg test acc: 0.98087, Avg tpr: 0.94374, Avg fpr: 0.01846, total FA: 2563

server round 12/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00050, len=1
[Step=9601 Epoch=18.7] | Loss=0.02705 | Reg=0.00406 | acc=0.9844 | L2-Norm=20.137 | L2-Norm(final)=2.218 | 3845.1 samples/s | 60.1 steps/s
[Step=9650 Epoch=18.8] | Loss=0.00660 | Reg=0.00405 | acc=1.0000 | L2-Norm=20.127 | L2-Norm(final)=2.216 | 4254.7 samples/s | 66.5 steps/s
[Step=9700 Epoch=18.9] | Loss=0.00701 | Reg=0.00405 | acc=1.0000 | L2-Norm=20.119 | L2-Norm(final)=2.218 | 4480.3 samples/s | 70.0 steps/s
[Step=9750 Epoch=19.0] | Loss=0.00760 | Reg=0.00404 | acc=1.0000 | L2-Norm=20.111 | L2-Norm(final)=2.219 | 4528.4 samples/s | 70.8 steps/s
[Step=9800 Epoch=19.1] | Loss=0.00726 | Reg=0.00404 | acc=0.9688 | L2-Norm=20.104 | L2-Norm(final)=2.221 | 4555.7 samples/s | 71.2 steps/s
[Step=9850 Epoch=19.2] | Loss=0.00712 | Reg=0.00404 | acc=0.9844 | L2-Norm=20.097 | L2-Norm(final)=2.224 | 4586.4 samples/s | 71.7 steps/s
[Step=9900 Epoch=19.3] | Loss=0.00751 | Reg=0.00404 | acc=1.0000 | L2-Norm=20.090 | L2-Norm(final)=2.226 | 4596.1 samples/s | 71.8 steps/s
[Step=9950 Epoch=19.4] | Loss=0.00758 | Reg=0.00403 | acc=1.0000 | L2-Norm=20.083 | L2-Norm(final)=2.228 | 4673.3 samples/s | 73.0 steps/s
[Step=10000 Epoch=19.5] | Loss=0.00769 | Reg=0.00403 | acc=0.9844 | L2-Norm=20.076 | L2-Norm(final)=2.230 | 4584.2 samples/s | 71.6 steps/s
[Step=10050 Epoch=19.6] | Loss=0.00785 | Reg=0.00403 | acc=1.0000 | L2-Norm=20.070 | L2-Norm(final)=2.231 | 4626.4 samples/s | 72.3 steps/s
[Step=10100 Epoch=19.7] | Loss=0.00814 | Reg=0.00403 | acc=0.9844 | L2-Norm=20.063 | L2-Norm(final)=2.231 | 5478.5 samples/s | 85.6 steps/s
[Step=10150 Epoch=19.8] | Loss=0.00796 | Reg=0.00402 | acc=1.0000 | L2-Norm=20.057 | L2-Norm(final)=2.231 | 1832.6 samples/s | 28.6 steps/s
[Step=10200 Epoch=19.9] | Loss=0.00780 | Reg=0.00402 | acc=0.9844 | L2-Norm=20.050 | L2-Norm(final)=2.232 | 4475.3 samples/s | 69.9 steps/s
[Step=10250 Epoch=20.0] | Loss=0.00769 | Reg=0.00402 | acc=1.0000 | L2-Norm=20.044 | L2-Norm(final)=2.233 | 4441.3 samples/s | 69.4 steps/s
[Step=10300 Epoch=20.1] | Loss=0.00782 | Reg=0.00401 | acc=1.0000 | L2-Norm=20.037 | L2-Norm(final)=2.234 | 4441.6 samples/s | 69.4 steps/s
[Step=10350 Epoch=20.2] | Loss=0.00781 | Reg=0.00401 | acc=1.0000 | L2-Norm=20.031 | L2-Norm(final)=2.236 | 4471.8 samples/s | 69.9 steps/s
[Step=10400 Epoch=20.3] | Loss=0.00782 | Reg=0.00401 | acc=1.0000 | L2-Norm=20.025 | L2-Norm(final)=2.237 | 4485.9 samples/s | 70.1 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step10400.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00050, len=1
[Step=9601 Epoch=18.8] | Loss=0.00543 | Reg=0.00397 | acc=1.0000 | L2-Norm=19.935 | L2-Norm(final)=2.148 | 3898.9 samples/s | 60.9 steps/s
[Step=9650 Epoch=18.9] | Loss=0.00508 | Reg=0.00397 | acc=1.0000 | L2-Norm=19.926 | L2-Norm(final)=2.147 | 4274.3 samples/s | 66.8 steps/s
[Step=9700 Epoch=19.0] | Loss=0.00558 | Reg=0.00397 | acc=0.9688 | L2-Norm=19.916 | L2-Norm(final)=2.151 | 4474.4 samples/s | 69.9 steps/s
[Step=9750 Epoch=19.1] | Loss=0.00606 | Reg=0.00396 | acc=1.0000 | L2-Norm=19.907 | L2-Norm(final)=2.151 | 4454.7 samples/s | 69.6 steps/s
[Step=9800 Epoch=19.2] | Loss=0.00696 | Reg=0.00396 | acc=0.9844 | L2-Norm=19.900 | L2-Norm(final)=2.151 | 4579.8 samples/s | 71.6 steps/s
[Step=9850 Epoch=19.3] | Loss=0.00763 | Reg=0.00396 | acc=0.9688 | L2-Norm=19.894 | L2-Norm(final)=2.152 | 4333.8 samples/s | 67.7 steps/s
[Step=9900 Epoch=19.4] | Loss=0.00812 | Reg=0.00396 | acc=0.9844 | L2-Norm=19.887 | L2-Norm(final)=2.151 | 4528.7 samples/s | 70.8 steps/s
[Step=9950 Epoch=19.5] | Loss=0.00807 | Reg=0.00395 | acc=1.0000 | L2-Norm=19.881 | L2-Norm(final)=2.151 | 4526.7 samples/s | 70.7 steps/s
[Step=10000 Epoch=19.5] | Loss=0.00804 | Reg=0.00395 | acc=1.0000 | L2-Norm=19.875 | L2-Norm(final)=2.153 | 4508.5 samples/s | 70.4 steps/s
[Step=10050 Epoch=19.6] | Loss=0.00827 | Reg=0.00395 | acc=0.9844 | L2-Norm=19.869 | L2-Norm(final)=2.154 | 4423.0 samples/s | 69.1 steps/s
[Step=10100 Epoch=19.7] | Loss=0.00840 | Reg=0.00395 | acc=0.9844 | L2-Norm=19.862 | L2-Norm(final)=2.155 | 5499.3 samples/s | 85.9 steps/s
[Step=10150 Epoch=19.8] | Loss=0.00832 | Reg=0.00394 | acc=1.0000 | L2-Norm=19.857 | L2-Norm(final)=2.156 | 1893.1 samples/s | 29.6 steps/s
[Step=10200 Epoch=19.9] | Loss=0.00854 | Reg=0.00394 | acc=1.0000 | L2-Norm=19.851 | L2-Norm(final)=2.157 | 4360.5 samples/s | 68.1 steps/s
[Step=10250 Epoch=20.0] | Loss=0.00876 | Reg=0.00394 | acc=0.9844 | L2-Norm=19.845 | L2-Norm(final)=2.156 | 4571.0 samples/s | 71.4 steps/s
[Step=10300 Epoch=20.1] | Loss=0.00878 | Reg=0.00394 | acc=1.0000 | L2-Norm=19.840 | L2-Norm(final)=2.156 | 4581.3 samples/s | 71.6 steps/s
[Step=10350 Epoch=20.2] | Loss=0.00889 | Reg=0.00393 | acc=0.9688 | L2-Norm=19.835 | L2-Norm(final)=2.156 | 4474.3 samples/s | 69.9 steps/s
[Step=10400 Epoch=20.3] | Loss=0.00904 | Reg=0.00393 | acc=0.9844 | L2-Norm=19.831 | L2-Norm(final)=2.156 | 4395.1 samples/s | 68.7 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step10400.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00050, len=1
[Step=9601 Epoch=36.8] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.820 | L2-Norm(final)=4.048 | 3838.1 samples/s | 60.0 steps/s
[Step=9650 Epoch=37.0] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.809 | L2-Norm(final)=4.058 | 4001.2 samples/s | 62.5 steps/s
[Step=9700 Epoch=37.2] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.799 | L2-Norm(final)=4.069 | 4234.3 samples/s | 66.2 steps/s
[Step=9750 Epoch=37.4] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.790 | L2-Norm(final)=4.079 | 4143.8 samples/s | 64.7 steps/s
[Step=9800 Epoch=37.6] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.780 | L2-Norm(final)=4.090 | 4195.4 samples/s | 65.6 steps/s
[Step=9850 Epoch=37.7] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.770 | L2-Norm(final)=4.102 | 5273.5 samples/s | 82.4 steps/s
[Step=9900 Epoch=37.9] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.759 | L2-Norm(final)=4.113 | 1805.0 samples/s | 28.2 steps/s
[Step=9950 Epoch=38.1] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.750 | L2-Norm(final)=4.126 | 4255.5 samples/s | 66.5 steps/s
[Step=10000 Epoch=38.3] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.740 | L2-Norm(final)=4.139 | 4251.8 samples/s | 66.4 steps/s
[Step=10050 Epoch=38.5] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.730 | L2-Norm(final)=4.152 | 4041.0 samples/s | 63.1 steps/s
[Step=10100 Epoch=38.7] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.719 | L2-Norm(final)=4.165 | 4703.0 samples/s | 73.5 steps/s
[Step=10150 Epoch=38.9] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.709 | L2-Norm(final)=4.178 | 1895.7 samples/s | 29.6 steps/s
[Step=10200 Epoch=39.1] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.699 | L2-Norm(final)=4.191 | 4118.7 samples/s | 64.4 steps/s
[Step=10250 Epoch=39.3] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.689 | L2-Norm(final)=4.205 | 4171.5 samples/s | 65.2 steps/s
[Step=10300 Epoch=39.5] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.678 | L2-Norm(final)=4.219 | 4167.4 samples/s | 65.1 steps/s
[Step=10350 Epoch=39.7] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.668 | L2-Norm(final)=4.234 | 4346.3 samples/s | 67.9 steps/s
[Step=10400 Epoch=39.8] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.658 | L2-Norm(final)=4.248 | 2036.5 samples/s | 31.8 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step10400.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00050, len=1
[Step=9601 Epoch=37.0] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.042 | L2-Norm(final)=2.815 | 4165.6 samples/s | 65.1 steps/s
[Step=9650 Epoch=37.1] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.024 | L2-Norm(final)=2.823 | 4135.0 samples/s | 64.6 steps/s
[Step=9700 Epoch=37.3] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.005 | L2-Norm(final)=2.828 | 4359.1 samples/s | 68.1 steps/s
[Step=9750 Epoch=37.5] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.986 | L2-Norm(final)=2.832 | 4275.3 samples/s | 66.8 steps/s
[Step=9800 Epoch=37.7] | Loss=0.00000 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.966 | L2-Norm(final)=2.836 | 4319.2 samples/s | 67.5 steps/s
[Step=9850 Epoch=37.9] | Loss=0.00000 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.947 | L2-Norm(final)=2.840 | 5683.9 samples/s | 88.8 steps/s
[Step=9900 Epoch=38.1] | Loss=0.00000 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.928 | L2-Norm(final)=2.846 | 1856.2 samples/s | 29.0 steps/s
[Step=9950 Epoch=38.3] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.908 | L2-Norm(final)=2.851 | 4353.8 samples/s | 68.0 steps/s
[Step=10000 Epoch=38.5] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.888 | L2-Norm(final)=2.856 | 4317.2 samples/s | 67.5 steps/s
[Step=10050 Epoch=38.7] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.868 | L2-Norm(final)=2.861 | 4395.9 samples/s | 68.7 steps/s
[Step=10100 Epoch=38.9] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.848 | L2-Norm(final)=2.866 | 4940.8 samples/s | 77.2 steps/s
[Step=10150 Epoch=39.1] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.829 | L2-Norm(final)=2.872 | 1943.2 samples/s | 30.4 steps/s
[Step=10200 Epoch=39.3] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.809 | L2-Norm(final)=2.877 | 4398.5 samples/s | 68.7 steps/s
[Step=10250 Epoch=39.5] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.789 | L2-Norm(final)=2.883 | 4473.4 samples/s | 69.9 steps/s
[Step=10300 Epoch=39.6] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.769 | L2-Norm(final)=2.888 | 4304.7 samples/s | 67.3 steps/s
[Step=10350 Epoch=39.8] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.748 | L2-Norm(final)=2.894 | 4471.3 samples/s | 69.9 steps/s
[Step=10400 Epoch=40.0] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.728 | L2-Norm(final)=2.900 | 2040.3 samples/s | 31.9 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step10400.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.12777 | acc=0.9586 | tpr=0.9676 | fpr=0.0610 | 4197.1 samples/s | 16.4 steps/s
Avg test loss: 0.13325, Avg test acc: 0.95697, Avg tpr: 0.96579, Avg fpr: 0.06243, total FA: 487

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.11595 | acc=0.9569 | tpr=0.9747 | fpr=0.0818 | 4227.7 samples/s | 16.5 steps/s
Avg test loss: 0.12041, Avg test acc: 0.95709, Avg tpr: 0.97558, Avg fpr: 0.08358, total FA: 652

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.15568 | acc=0.3143 | tpr=0.0055 | fpr=0.0151 | 4186.1 samples/s | 16.4 steps/s
Avg test loss: 4.16611, Avg test acc: 0.31244, Avg tpr: 0.00647, Avg fpr: 0.01461, total FA: 114

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.31625 | acc=0.3156 | tpr=0.0009 | fpr=0.0010 | 4229.7 samples/s | 16.5 steps/s
Avg test loss: 6.35371, Avg test acc: 0.31289, Avg tpr: 0.00105, Avg fpr: 0.00128, total FA: 10

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.60903 | acc=0.1736 | tpr=0.7301 | fpr=0.8364 | 3364.9 samples/s | 13.1 steps/s
[Step= 100] | Loss=5.56842 | acc=0.1761 | tpr=0.7335 | fpr=0.8343 | 6270.7 samples/s | 24.5 steps/s
[Step= 150] | Loss=5.61122 | acc=0.1746 | tpr=0.7205 | fpr=0.8355 | 7917.7 samples/s | 30.9 steps/s
[Step= 200] | Loss=5.60850 | acc=0.1752 | tpr=0.7126 | fpr=0.8346 | 7732.1 samples/s | 30.2 steps/s
[Step= 250] | Loss=5.62161 | acc=0.1741 | tpr=0.7127 | fpr=0.8357 | 7803.5 samples/s | 30.5 steps/s
[Step= 300] | Loss=5.62292 | acc=0.1731 | tpr=0.7127 | fpr=0.8367 | 7541.9 samples/s | 29.5 steps/s
[Step= 350] | Loss=5.61647 | acc=0.1735 | tpr=0.7157 | fpr=0.8363 | 7555.6 samples/s | 29.5 steps/s
[Step= 400] | Loss=5.62347 | acc=0.1735 | tpr=0.7139 | fpr=0.8364 | 7427.6 samples/s | 29.0 steps/s
[Step= 450] | Loss=5.62230 | acc=0.1731 | tpr=0.7152 | fpr=0.8368 | 7556.8 samples/s | 29.5 steps/s
[Step= 500] | Loss=5.62690 | acc=0.1725 | tpr=0.7119 | fpr=0.8372 | 7528.3 samples/s | 29.4 steps/s
[Step= 550] | Loss=5.62771 | acc=0.1725 | tpr=0.7123 | fpr=0.8374 | 13532.7 samples/s | 52.9 steps/s
Avg test loss: 5.63045, Avg test acc: 0.17230, Avg tpr: 0.71157, Avg fpr: 0.83750, total FA: 116285

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.71253 | acc=0.1205 | tpr=0.8097 | fpr=0.8918 | 3042.8 samples/s | 11.9 steps/s
[Step= 100] | Loss=7.66568 | acc=0.1211 | tpr=0.8017 | fpr=0.8916 | 7453.0 samples/s | 29.1 steps/s
[Step= 150] | Loss=7.67500 | acc=0.1204 | tpr=0.7939 | fpr=0.8920 | 7764.4 samples/s | 30.3 steps/s
[Step= 200] | Loss=7.65687 | acc=0.1207 | tpr=0.7880 | fpr=0.8914 | 7299.6 samples/s | 28.5 steps/s
[Step= 250] | Loss=7.65985 | acc=0.1205 | tpr=0.7817 | fpr=0.8916 | 7497.4 samples/s | 29.3 steps/s
[Step= 300] | Loss=7.66662 | acc=0.1202 | tpr=0.7796 | fpr=0.8918 | 7758.4 samples/s | 30.3 steps/s
[Step= 350] | Loss=7.66273 | acc=0.1202 | tpr=0.7840 | fpr=0.8919 | 7469.7 samples/s | 29.2 steps/s
[Step= 400] | Loss=7.65716 | acc=0.1203 | tpr=0.7877 | fpr=0.8918 | 7535.1 samples/s | 29.4 steps/s
[Step= 450] | Loss=7.66367 | acc=0.1201 | tpr=0.7853 | fpr=0.8920 | 7566.0 samples/s | 29.6 steps/s
[Step= 500] | Loss=7.67525 | acc=0.1195 | tpr=0.7859 | fpr=0.8925 | 7603.6 samples/s | 29.7 steps/s
[Step= 550] | Loss=7.67584 | acc=0.1193 | tpr=0.7835 | fpr=0.8928 | 14113.8 samples/s | 55.1 steps/s
Avg test loss: 7.67831, Avg test acc: 0.11915, Avg tpr: 0.78328, Avg fpr: 0.89293, total FA: 123981

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08627 | acc=0.9823 | tpr=0.9381 | fpr=0.0169 | 3099.6 samples/s | 12.1 steps/s
[Step= 100] | Loss=0.08726 | acc=0.9821 | tpr=0.9616 | fpr=0.0175 | 8105.3 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.09147 | acc=0.9811 | tpr=0.9611 | fpr=0.0185 | 7871.4 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.09240 | acc=0.9811 | tpr=0.9628 | fpr=0.0185 | 7567.5 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.09186 | acc=0.9813 | tpr=0.9598 | fpr=0.0183 | 8072.7 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.09271 | acc=0.9811 | tpr=0.9578 | fpr=0.0185 | 7519.5 samples/s | 29.4 steps/s
[Step= 350] | Loss=0.09330 | acc=0.9808 | tpr=0.9574 | fpr=0.0187 | 8039.7 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.09453 | acc=0.9806 | tpr=0.9546 | fpr=0.0189 | 8259.5 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.09614 | acc=0.9803 | tpr=0.9533 | fpr=0.0192 | 7264.2 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.09554 | acc=0.9804 | tpr=0.9542 | fpr=0.0191 | 7826.4 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.09498 | acc=0.9806 | tpr=0.9530 | fpr=0.0189 | 13740.1 samples/s | 53.7 steps/s
Avg test loss: 0.09489, Avg test acc: 0.98061, Avg tpr: 0.95325, Avg fpr: 0.01889, total FA: 2623

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11535 | acc=0.9815 | tpr=0.9469 | fpr=0.0179 | 3085.7 samples/s | 12.1 steps/s
[Step= 100] | Loss=0.12094 | acc=0.9809 | tpr=0.9574 | fpr=0.0186 | 8256.1 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.12680 | acc=0.9803 | tpr=0.9568 | fpr=0.0193 | 7525.0 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.12839 | acc=0.9801 | tpr=0.9563 | fpr=0.0195 | 7999.6 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.12688 | acc=0.9802 | tpr=0.9563 | fpr=0.0194 | 7947.8 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.12948 | acc=0.9800 | tpr=0.9549 | fpr=0.0195 | 7896.9 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.12995 | acc=0.9799 | tpr=0.9555 | fpr=0.0196 | 7647.8 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.13105 | acc=0.9797 | tpr=0.9530 | fpr=0.0198 | 7535.4 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.13370 | acc=0.9793 | tpr=0.9513 | fpr=0.0201 | 7678.7 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.13278 | acc=0.9794 | tpr=0.9533 | fpr=0.0202 | 7155.1 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.13183 | acc=0.9795 | tpr=0.9538 | fpr=0.0201 | 13389.7 samples/s | 52.3 steps/s
Avg test loss: 0.13164, Avg test acc: 0.97949, Avg tpr: 0.95365, Avg fpr: 0.02004, total FA: 2782

server round 13/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00050, len=1
[Step=10401 Epoch=20.3] | Loss=0.00171 | Reg=0.00397 | acc=1.0000 | L2-Norm=19.931 | L2-Norm(final)=2.263 | 3203.7 samples/s | 50.1 steps/s
[Step=10450 Epoch=20.4] | Loss=0.00755 | Reg=0.00397 | acc=1.0000 | L2-Norm=19.925 | L2-Norm(final)=2.267 | 2263.0 samples/s | 35.4 steps/s
[Step=10500 Epoch=20.5] | Loss=0.00755 | Reg=0.00397 | acc=0.9844 | L2-Norm=19.919 | L2-Norm(final)=2.269 | 4577.7 samples/s | 71.5 steps/s
[Step=10550 Epoch=20.6] | Loss=0.00732 | Reg=0.00397 | acc=1.0000 | L2-Norm=19.915 | L2-Norm(final)=2.271 | 4570.5 samples/s | 71.4 steps/s
[Step=10600 Epoch=20.7] | Loss=0.00804 | Reg=0.00396 | acc=0.9844 | L2-Norm=19.909 | L2-Norm(final)=2.271 | 4225.3 samples/s | 66.0 steps/s
[Step=10650 Epoch=20.8] | Loss=0.00861 | Reg=0.00396 | acc=0.9844 | L2-Norm=19.903 | L2-Norm(final)=2.271 | 4590.2 samples/s | 71.7 steps/s
[Step=10700 Epoch=20.9] | Loss=0.00881 | Reg=0.00396 | acc=1.0000 | L2-Norm=19.898 | L2-Norm(final)=2.269 | 4502.4 samples/s | 70.4 steps/s
[Step=10750 Epoch=21.0] | Loss=0.00935 | Reg=0.00396 | acc=1.0000 | L2-Norm=19.894 | L2-Norm(final)=2.268 | 4511.0 samples/s | 70.5 steps/s
[Step=10800 Epoch=21.1] | Loss=0.00919 | Reg=0.00396 | acc=1.0000 | L2-Norm=19.892 | L2-Norm(final)=2.267 | 4510.7 samples/s | 70.5 steps/s
[Step=10850 Epoch=21.2] | Loss=0.00901 | Reg=0.00396 | acc=1.0000 | L2-Norm=19.889 | L2-Norm(final)=2.268 | 4540.6 samples/s | 70.9 steps/s
[Step=10900 Epoch=21.3] | Loss=0.00878 | Reg=0.00395 | acc=0.9688 | L2-Norm=19.885 | L2-Norm(final)=2.268 | 5347.1 samples/s | 83.5 steps/s
[Step=10950 Epoch=21.4] | Loss=0.00890 | Reg=0.00395 | acc=1.0000 | L2-Norm=19.882 | L2-Norm(final)=2.269 | 1823.5 samples/s | 28.5 steps/s
[Step=11000 Epoch=21.5] | Loss=0.00895 | Reg=0.00395 | acc=1.0000 | L2-Norm=19.877 | L2-Norm(final)=2.269 | 4442.5 samples/s | 69.4 steps/s
[Step=11050 Epoch=21.6] | Loss=0.00881 | Reg=0.00395 | acc=1.0000 | L2-Norm=19.874 | L2-Norm(final)=2.269 | 4339.3 samples/s | 67.8 steps/s
[Step=11100 Epoch=21.6] | Loss=0.00885 | Reg=0.00395 | acc=1.0000 | L2-Norm=19.869 | L2-Norm(final)=2.269 | 4333.6 samples/s | 67.7 steps/s
[Step=11150 Epoch=21.7] | Loss=0.00872 | Reg=0.00395 | acc=1.0000 | L2-Norm=19.865 | L2-Norm(final)=2.269 | 4350.8 samples/s | 68.0 steps/s
[Step=11200 Epoch=21.8] | Loss=0.00861 | Reg=0.00394 | acc=1.0000 | L2-Norm=19.860 | L2-Norm(final)=2.269 | 4408.8 samples/s | 68.9 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step11200.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00050, len=1
[Step=10401 Epoch=20.3] | Loss=0.00655 | Reg=0.00391 | acc=1.0000 | L2-Norm=19.770 | L2-Norm(final)=2.155 | 4100.5 samples/s | 64.1 steps/s
[Step=10450 Epoch=20.4] | Loss=0.00748 | Reg=0.00391 | acc=1.0000 | L2-Norm=19.771 | L2-Norm(final)=2.155 | 4114.4 samples/s | 64.3 steps/s
[Step=10500 Epoch=20.5] | Loss=0.00900 | Reg=0.00391 | acc=1.0000 | L2-Norm=19.767 | L2-Norm(final)=2.155 | 4363.5 samples/s | 68.2 steps/s
[Step=10550 Epoch=20.6] | Loss=0.00972 | Reg=0.00390 | acc=0.9844 | L2-Norm=19.761 | L2-Norm(final)=2.151 | 4465.3 samples/s | 69.8 steps/s
[Step=10600 Epoch=20.7] | Loss=0.01086 | Reg=0.00390 | acc=0.9688 | L2-Norm=19.757 | L2-Norm(final)=2.150 | 4432.9 samples/s | 69.3 steps/s
[Step=10650 Epoch=20.8] | Loss=0.01075 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.756 | L2-Norm(final)=2.148 | 4504.2 samples/s | 70.4 steps/s
[Step=10700 Epoch=20.9] | Loss=0.01022 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.755 | L2-Norm(final)=2.148 | 4483.2 samples/s | 70.1 steps/s
[Step=10750 Epoch=21.0] | Loss=0.00966 | Reg=0.00390 | acc=0.9844 | L2-Norm=19.753 | L2-Norm(final)=2.149 | 4450.2 samples/s | 69.5 steps/s
[Step=10800 Epoch=21.1] | Loss=0.00951 | Reg=0.00390 | acc=0.9844 | L2-Norm=19.749 | L2-Norm(final)=2.149 | 4458.2 samples/s | 69.7 steps/s
[Step=10850 Epoch=21.2] | Loss=0.00962 | Reg=0.00390 | acc=0.9844 | L2-Norm=19.745 | L2-Norm(final)=2.149 | 4525.0 samples/s | 70.7 steps/s
[Step=10900 Epoch=21.3] | Loss=0.00975 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.742 | L2-Norm(final)=2.149 | 5402.7 samples/s | 84.4 steps/s
[Step=10950 Epoch=21.4] | Loss=0.00950 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.739 | L2-Norm(final)=2.150 | 1918.6 samples/s | 30.0 steps/s
[Step=11000 Epoch=21.5] | Loss=0.00943 | Reg=0.00390 | acc=0.9844 | L2-Norm=19.736 | L2-Norm(final)=2.151 | 4505.6 samples/s | 70.4 steps/s
[Step=11050 Epoch=21.6] | Loss=0.00937 | Reg=0.00389 | acc=0.9844 | L2-Norm=19.733 | L2-Norm(final)=2.151 | 4383.6 samples/s | 68.5 steps/s
[Step=11100 Epoch=21.7] | Loss=0.00921 | Reg=0.00389 | acc=0.9844 | L2-Norm=19.731 | L2-Norm(final)=2.153 | 4426.9 samples/s | 69.2 steps/s
[Step=11150 Epoch=21.8] | Loss=0.00939 | Reg=0.00389 | acc=0.9688 | L2-Norm=19.729 | L2-Norm(final)=2.154 | 4486.3 samples/s | 70.1 steps/s
[Step=11200 Epoch=21.9] | Loss=0.00937 | Reg=0.00389 | acc=1.0000 | L2-Norm=19.727 | L2-Norm(final)=2.155 | 4393.3 samples/s | 68.6 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step11200.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00050, len=1
[Step=10401 Epoch=39.9] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.492 | L2-Norm(final)=4.481 | 4140.6 samples/s | 64.7 steps/s
[Step=10450 Epoch=40.0] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.481 | L2-Norm(final)=4.495 | 3965.7 samples/s | 62.0 steps/s
[Step=10500 Epoch=40.2] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=4.510 | 4173.6 samples/s | 65.2 steps/s
[Step=10550 Epoch=40.4] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.460 | L2-Norm(final)=4.527 | 4171.9 samples/s | 65.2 steps/s
[Step=10600 Epoch=40.6] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.450 | L2-Norm(final)=4.544 | 4220.9 samples/s | 66.0 steps/s
[Step=10650 Epoch=40.8] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.439 | L2-Norm(final)=4.560 | 5276.2 samples/s | 82.4 steps/s
[Step=10700 Epoch=41.0] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.428 | L2-Norm(final)=4.576 | 1806.3 samples/s | 28.2 steps/s
[Step=10750 Epoch=41.2] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.418 | L2-Norm(final)=4.593 | 4209.8 samples/s | 65.8 steps/s
[Step=10800 Epoch=41.4] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.407 | L2-Norm(final)=4.610 | 4167.8 samples/s | 65.1 steps/s
[Step=10850 Epoch=41.6] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.396 | L2-Norm(final)=4.627 | 4157.5 samples/s | 65.0 steps/s
[Step=10900 Epoch=41.8] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.385 | L2-Norm(final)=4.643 | 4692.7 samples/s | 73.3 steps/s
[Step=10950 Epoch=42.0] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.374 | L2-Norm(final)=4.659 | 1895.0 samples/s | 29.6 steps/s
[Step=11000 Epoch=42.1] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.363 | L2-Norm(final)=4.676 | 4349.5 samples/s | 68.0 steps/s
[Step=11050 Epoch=42.3] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.352 | L2-Norm(final)=4.693 | 4350.2 samples/s | 68.0 steps/s
[Step=11100 Epoch=42.5] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.341 | L2-Norm(final)=4.710 | 4343.9 samples/s | 67.9 steps/s
[Step=11150 Epoch=42.7] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.330 | L2-Norm(final)=4.727 | 4257.9 samples/s | 66.5 steps/s
[Step=11200 Epoch=42.9] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.319 | L2-Norm(final)=4.745 | 2065.7 samples/s | 32.3 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step11200.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00050, len=1
[Step=10401 Epoch=40.0] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.399 | L2-Norm(final)=2.992 | 3918.5 samples/s | 61.2 steps/s
[Step=10450 Epoch=40.2] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.377 | L2-Norm(final)=2.998 | 4347.8 samples/s | 67.9 steps/s
[Step=10500 Epoch=40.4] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.353 | L2-Norm(final)=3.004 | 4424.3 samples/s | 69.1 steps/s
[Step=10550 Epoch=40.6] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=3.009 | 4395.6 samples/s | 68.7 steps/s
[Step=10600 Epoch=40.8] | Loss=0.00272 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.343 | L2-Norm(final)=3.012 | 4428.2 samples/s | 69.2 steps/s
[Step=10650 Epoch=41.0] | Loss=0.00382 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.406 | L2-Norm(final)=3.003 | 5612.7 samples/s | 87.7 steps/s
[Step=10700 Epoch=41.2] | Loss=0.00336 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.456 | L2-Norm(final)=2.999 | 1874.3 samples/s | 29.3 steps/s
[Step=10750 Epoch=41.4] | Loss=0.00330 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.490 | L2-Norm(final)=2.998 | 4338.7 samples/s | 67.8 steps/s
[Step=10800 Epoch=41.6] | Loss=0.00323 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.519 | L2-Norm(final)=2.997 | 4426.7 samples/s | 69.2 steps/s
[Step=10850 Epoch=41.8] | Loss=0.00291 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=2.996 | 4410.8 samples/s | 68.9 steps/s
[Step=10900 Epoch=42.0] | Loss=0.00267 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.553 | L2-Norm(final)=2.997 | 4880.1 samples/s | 76.3 steps/s
[Step=10950 Epoch=42.2] | Loss=0.00244 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.563 | L2-Norm(final)=2.998 | 1943.4 samples/s | 30.4 steps/s
[Step=11000 Epoch=42.3] | Loss=0.00225 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.569 | L2-Norm(final)=2.999 | 4367.4 samples/s | 68.2 steps/s
[Step=11050 Epoch=42.5] | Loss=0.00208 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.572 | L2-Norm(final)=3.000 | 4417.7 samples/s | 69.0 steps/s
[Step=11100 Epoch=42.7] | Loss=0.00193 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.573 | L2-Norm(final)=3.001 | 4281.0 samples/s | 66.9 steps/s
[Step=11150 Epoch=42.9] | Loss=0.00181 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.572 | L2-Norm(final)=3.002 | 4485.5 samples/s | 70.1 steps/s
[Step=11200 Epoch=43.1] | Loss=0.00170 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.569 | L2-Norm(final)=3.004 | 2039.3 samples/s | 31.9 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step11200.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.12536 | acc=0.9584 | tpr=0.9698 | fpr=0.0662 | 4103.4 samples/s | 16.0 steps/s
Avg test loss: 0.13067, Avg test acc: 0.95641, Avg tpr: 0.96870, Avg fpr: 0.07063, total FA: 551

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10755 | acc=0.9592 | tpr=0.9643 | fpr=0.0518 | 4146.7 samples/s | 16.2 steps/s
Avg test loss: 0.11223, Avg test acc: 0.95813, Avg tpr: 0.96415, Avg fpr: 0.05512, total FA: 430

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.30242 | acc=0.3145 | tpr=0.0058 | fpr=0.0151 | 4009.4 samples/s | 15.7 steps/s
Avg test loss: 4.31347, Avg test acc: 0.31261, Avg tpr: 0.00653, Avg fpr: 0.01423, total FA: 111

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.84947 | acc=0.3148 | tpr=0.0022 | fpr=0.0064 | 4074.5 samples/s | 15.9 steps/s
Avg test loss: 5.87842, Avg test acc: 0.31240, Avg tpr: 0.00216, Avg fpr: 0.00526, total FA: 41

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.76257 | acc=0.1615 | tpr=0.7611 | fpr=0.8493 | 4054.1 samples/s | 15.8 steps/s
[Step= 100] | Loss=5.71978 | acc=0.1625 | tpr=0.7527 | fpr=0.8485 | 7820.2 samples/s | 30.5 steps/s
[Step= 150] | Loss=5.75146 | acc=0.1612 | tpr=0.7522 | fpr=0.8497 | 7504.2 samples/s | 29.3 steps/s
[Step= 200] | Loss=5.74909 | acc=0.1613 | tpr=0.7454 | fpr=0.8493 | 7955.1 samples/s | 31.1 steps/s
[Step= 250] | Loss=5.76459 | acc=0.1612 | tpr=0.7459 | fpr=0.8495 | 7319.6 samples/s | 28.6 steps/s
[Step= 300] | Loss=5.76846 | acc=0.1603 | tpr=0.7469 | fpr=0.8504 | 7401.7 samples/s | 28.9 steps/s
[Step= 350] | Loss=5.76346 | acc=0.1605 | tpr=0.7470 | fpr=0.8501 | 7828.3 samples/s | 30.6 steps/s
[Step= 400] | Loss=5.77043 | acc=0.1609 | tpr=0.7522 | fpr=0.8498 | 7030.8 samples/s | 27.5 steps/s
[Step= 450] | Loss=5.76764 | acc=0.1605 | tpr=0.7537 | fpr=0.8503 | 7596.5 samples/s | 29.7 steps/s
[Step= 500] | Loss=5.77226 | acc=0.1598 | tpr=0.7507 | fpr=0.8509 | 7337.3 samples/s | 28.7 steps/s
[Step= 550] | Loss=5.77271 | acc=0.1598 | tpr=0.7529 | fpr=0.8510 | 13068.1 samples/s | 51.0 steps/s
Avg test loss: 5.77489, Avg test acc: 0.15964, Avg tpr: 0.75277, Avg fpr: 0.85115, total FA: 118180

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.69076 | acc=0.1640 | tpr=0.7389 | fpr=0.8463 | 4161.5 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.65347 | acc=0.1638 | tpr=0.7207 | fpr=0.8466 | 7189.2 samples/s | 28.1 steps/s
[Step= 150] | Loss=6.66079 | acc=0.1636 | tpr=0.7161 | fpr=0.8466 | 7841.0 samples/s | 30.6 steps/s
[Step= 200] | Loss=6.64492 | acc=0.1653 | tpr=0.7180 | fpr=0.8448 | 7605.4 samples/s | 29.7 steps/s
[Step= 250] | Loss=6.64455 | acc=0.1654 | tpr=0.7135 | fpr=0.8446 | 7269.5 samples/s | 28.4 steps/s
[Step= 300] | Loss=6.64415 | acc=0.1654 | tpr=0.7069 | fpr=0.8445 | 7305.3 samples/s | 28.5 steps/s
[Step= 350] | Loss=6.63984 | acc=0.1648 | tpr=0.7113 | fpr=0.8451 | 7844.7 samples/s | 30.6 steps/s
[Step= 400] | Loss=6.63360 | acc=0.1651 | tpr=0.7183 | fpr=0.8449 | 7157.8 samples/s | 28.0 steps/s
[Step= 450] | Loss=6.63876 | acc=0.1649 | tpr=0.7147 | fpr=0.8450 | 7604.9 samples/s | 29.7 steps/s
[Step= 500] | Loss=6.64766 | acc=0.1642 | tpr=0.7119 | fpr=0.8457 | 7165.0 samples/s | 28.0 steps/s
[Step= 550] | Loss=6.64734 | acc=0.1640 | tpr=0.7083 | fpr=0.8459 | 13297.2 samples/s | 51.9 steps/s
Avg test loss: 6.64939, Avg test acc: 0.16390, Avg tpr: 0.70840, Avg fpr: 0.84600, total FA: 117465

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09059 | acc=0.9822 | tpr=0.9336 | fpr=0.0169 | 4143.3 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.09175 | acc=0.9822 | tpr=0.9510 | fpr=0.0172 | 7808.1 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.09623 | acc=0.9810 | tpr=0.9524 | fpr=0.0185 | 7706.3 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.09718 | acc=0.9812 | tpr=0.9563 | fpr=0.0183 | 7495.3 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.09655 | acc=0.9814 | tpr=0.9528 | fpr=0.0181 | 7784.4 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.09752 | acc=0.9811 | tpr=0.9505 | fpr=0.0183 | 7780.7 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.09812 | acc=0.9809 | tpr=0.9512 | fpr=0.0186 | 7769.9 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.09936 | acc=0.9807 | tpr=0.9491 | fpr=0.0188 | 7809.8 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.10107 | acc=0.9803 | tpr=0.9484 | fpr=0.0191 | 7751.8 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.10046 | acc=0.9805 | tpr=0.9493 | fpr=0.0190 | 7553.3 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.09987 | acc=0.9806 | tpr=0.9487 | fpr=0.0188 | 14526.2 samples/s | 56.7 steps/s
Avg test loss: 0.09977, Avg test acc: 0.98063, Avg tpr: 0.94889, Avg fpr: 0.01879, total FA: 2609

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09676 | acc=0.9815 | tpr=0.9513 | fpr=0.0180 | 4097.2 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.09997 | acc=0.9813 | tpr=0.9638 | fpr=0.0184 | 7779.6 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.10422 | acc=0.9807 | tpr=0.9640 | fpr=0.0190 | 7755.7 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.10423 | acc=0.9808 | tpr=0.9683 | fpr=0.0190 | 8181.9 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.10313 | acc=0.9809 | tpr=0.9694 | fpr=0.0189 | 7467.8 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.10488 | acc=0.9806 | tpr=0.9658 | fpr=0.0191 | 8055.2 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.10585 | acc=0.9804 | tpr=0.9668 | fpr=0.0193 | 7599.8 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.10684 | acc=0.9803 | tpr=0.9655 | fpr=0.0195 | 7698.7 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.10941 | acc=0.9799 | tpr=0.9630 | fpr=0.0198 | 7656.3 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.10869 | acc=0.9800 | tpr=0.9643 | fpr=0.0197 | 7207.9 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.10802 | acc=0.9801 | tpr=0.9642 | fpr=0.0196 | 13839.0 samples/s | 54.1 steps/s
Avg test loss: 0.10785, Avg test acc: 0.98014, Avg tpr: 0.96434, Avg fpr: 0.01957, total FA: 2717

server round 14/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00050, len=1
[Step=11201 Epoch=21.8] | Loss=0.00669 | Reg=0.00391 | acc=0.9844 | L2-Norm=19.784 | L2-Norm(final)=2.272 | 3807.1 samples/s | 59.5 steps/s
[Step=11250 Epoch=21.9] | Loss=0.00807 | Reg=0.00391 | acc=1.0000 | L2-Norm=19.783 | L2-Norm(final)=2.275 | 4204.5 samples/s | 65.7 steps/s
[Step=11300 Epoch=22.0] | Loss=0.00838 | Reg=0.00391 | acc=1.0000 | L2-Norm=19.782 | L2-Norm(final)=2.278 | 4505.4 samples/s | 70.4 steps/s
[Step=11350 Epoch=22.1] | Loss=0.00915 | Reg=0.00391 | acc=1.0000 | L2-Norm=19.778 | L2-Norm(final)=2.276 | 4586.2 samples/s | 71.7 steps/s
[Step=11400 Epoch=22.2] | Loss=0.00960 | Reg=0.00391 | acc=1.0000 | L2-Norm=19.776 | L2-Norm(final)=2.274 | 4576.9 samples/s | 71.5 steps/s
[Step=11450 Epoch=22.3] | Loss=0.00923 | Reg=0.00391 | acc=0.9844 | L2-Norm=19.775 | L2-Norm(final)=2.274 | 4523.3 samples/s | 70.7 steps/s
[Step=11500 Epoch=22.4] | Loss=0.00871 | Reg=0.00391 | acc=1.0000 | L2-Norm=19.773 | L2-Norm(final)=2.275 | 4524.6 samples/s | 70.7 steps/s
[Step=11550 Epoch=22.5] | Loss=0.00881 | Reg=0.00391 | acc=0.9688 | L2-Norm=19.771 | L2-Norm(final)=2.276 | 4505.9 samples/s | 70.4 steps/s
[Step=11600 Epoch=22.6] | Loss=0.00864 | Reg=0.00391 | acc=0.9844 | L2-Norm=19.767 | L2-Norm(final)=2.276 | 4528.0 samples/s | 70.7 steps/s
[Step=11650 Epoch=22.7] | Loss=0.00877 | Reg=0.00391 | acc=1.0000 | L2-Norm=19.763 | L2-Norm(final)=2.276 | 4467.2 samples/s | 69.8 steps/s
[Step=11700 Epoch=22.8] | Loss=0.00897 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.759 | L2-Norm(final)=2.276 | 5464.1 samples/s | 85.4 steps/s
[Step=11750 Epoch=22.9] | Loss=0.00910 | Reg=0.00390 | acc=0.9844 | L2-Norm=19.756 | L2-Norm(final)=2.276 | 1836.8 samples/s | 28.7 steps/s
[Step=11800 Epoch=23.0] | Loss=0.00897 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.752 | L2-Norm(final)=2.276 | 4450.4 samples/s | 69.5 steps/s
[Step=11850 Epoch=23.1] | Loss=0.00879 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.748 | L2-Norm(final)=2.277 | 4454.5 samples/s | 69.6 steps/s
[Step=11900 Epoch=23.2] | Loss=0.00870 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.745 | L2-Norm(final)=2.278 | 4428.2 samples/s | 69.2 steps/s
[Step=11950 Epoch=23.3] | Loss=0.00884 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.744 | L2-Norm(final)=2.279 | 4495.0 samples/s | 70.2 steps/s
[Step=12000 Epoch=23.4] | Loss=0.00895 | Reg=0.00390 | acc=0.9844 | L2-Norm=19.743 | L2-Norm(final)=2.280 | 4553.1 samples/s | 71.1 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step12000.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00050, len=1
[Step=11201 Epoch=21.9] | Loss=0.00070 | Reg=0.00388 | acc=1.0000 | L2-Norm=19.691 | L2-Norm(final)=2.166 | 3910.3 samples/s | 61.1 steps/s
[Step=11250 Epoch=22.0] | Loss=0.00737 | Reg=0.00388 | acc=0.9844 | L2-Norm=19.687 | L2-Norm(final)=2.169 | 4207.5 samples/s | 65.7 steps/s
[Step=11300 Epoch=22.1] | Loss=0.00708 | Reg=0.00387 | acc=0.9844 | L2-Norm=19.682 | L2-Norm(final)=2.172 | 4399.8 samples/s | 68.7 steps/s
[Step=11350 Epoch=22.2] | Loss=0.00828 | Reg=0.00387 | acc=0.9844 | L2-Norm=19.680 | L2-Norm(final)=2.171 | 4505.5 samples/s | 70.4 steps/s
[Step=11400 Epoch=22.3] | Loss=0.00837 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.678 | L2-Norm(final)=2.171 | 4494.5 samples/s | 70.2 steps/s
[Step=11450 Epoch=22.4] | Loss=0.00853 | Reg=0.00387 | acc=0.9844 | L2-Norm=19.675 | L2-Norm(final)=2.172 | 4544.2 samples/s | 71.0 steps/s
[Step=11500 Epoch=22.5] | Loss=0.00818 | Reg=0.00387 | acc=0.9844 | L2-Norm=19.674 | L2-Norm(final)=2.174 | 4487.2 samples/s | 70.1 steps/s
[Step=11550 Epoch=22.6] | Loss=0.00841 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.673 | L2-Norm(final)=2.176 | 4519.0 samples/s | 70.6 steps/s
[Step=11600 Epoch=22.7] | Loss=0.00876 | Reg=0.00387 | acc=0.9844 | L2-Norm=19.672 | L2-Norm(final)=2.177 | 4477.8 samples/s | 70.0 steps/s
[Step=11650 Epoch=22.8] | Loss=0.00882 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.670 | L2-Norm(final)=2.179 | 4420.6 samples/s | 69.1 steps/s
[Step=11700 Epoch=22.9] | Loss=0.00900 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.668 | L2-Norm(final)=2.180 | 5493.6 samples/s | 85.8 steps/s
[Step=11750 Epoch=23.0] | Loss=0.00880 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.666 | L2-Norm(final)=2.181 | 1887.2 samples/s | 29.5 steps/s
[Step=11800 Epoch=23.1] | Loss=0.00846 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.663 | L2-Norm(final)=2.182 | 4547.6 samples/s | 71.1 steps/s
[Step=11850 Epoch=23.2] | Loss=0.00840 | Reg=0.00387 | acc=0.9688 | L2-Norm=19.661 | L2-Norm(final)=2.184 | 4404.0 samples/s | 68.8 steps/s
[Step=11900 Epoch=23.3] | Loss=0.00842 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.658 | L2-Norm(final)=2.185 | 4447.6 samples/s | 69.5 steps/s
[Step=11950 Epoch=23.4] | Loss=0.00851 | Reg=0.00386 | acc=0.9844 | L2-Norm=19.656 | L2-Norm(final)=2.186 | 4472.6 samples/s | 69.9 steps/s
[Step=12000 Epoch=23.5] | Loss=0.00847 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.653 | L2-Norm(final)=2.187 | 4485.4 samples/s | 70.1 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step12000.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00050, len=1
[Step=11201 Epoch=42.9] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.143 | L2-Norm(final)=5.026 | 4081.6 samples/s | 63.8 steps/s
[Step=11250 Epoch=43.1] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.130 | L2-Norm(final)=5.043 | 3926.2 samples/s | 61.3 steps/s
[Step=11300 Epoch=43.3] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.118 | L2-Norm(final)=5.060 | 4247.9 samples/s | 66.4 steps/s
[Step=11350 Epoch=43.5] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.106 | L2-Norm(final)=5.079 | 4211.2 samples/s | 65.8 steps/s
[Step=11400 Epoch=43.7] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.095 | L2-Norm(final)=5.097 | 4153.8 samples/s | 64.9 steps/s
[Step=11450 Epoch=43.9] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.083 | L2-Norm(final)=5.115 | 5340.0 samples/s | 83.4 steps/s
[Step=11500 Epoch=44.1] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.073 | L2-Norm(final)=5.133 | 1815.6 samples/s | 28.4 steps/s
[Step=11550 Epoch=44.3] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.061 | L2-Norm(final)=5.151 | 4285.6 samples/s | 67.0 steps/s
[Step=11600 Epoch=44.4] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.049 | L2-Norm(final)=5.168 | 4151.9 samples/s | 64.9 steps/s
[Step=11650 Epoch=44.6] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.037 | L2-Norm(final)=5.185 | 4244.8 samples/s | 66.3 steps/s
[Step=11700 Epoch=44.8] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=5.203 | 4668.9 samples/s | 73.0 steps/s
[Step=11750 Epoch=45.0] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.013 | L2-Norm(final)=5.220 | 1880.4 samples/s | 29.4 steps/s
[Step=11800 Epoch=45.2] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.000 | L2-Norm(final)=5.238 | 4262.1 samples/s | 66.6 steps/s
[Step=11850 Epoch=45.4] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.988 | L2-Norm(final)=5.255 | 4111.3 samples/s | 64.2 steps/s
[Step=11900 Epoch=45.6] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.975 | L2-Norm(final)=5.273 | 4406.9 samples/s | 68.9 steps/s
[Step=11950 Epoch=45.8] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.963 | L2-Norm(final)=5.290 | 4295.5 samples/s | 67.1 steps/s
[Step=12000 Epoch=46.0] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.951 | L2-Norm(final)=5.308 | 1954.0 samples/s | 30.5 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step12000.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00050, len=1
[Step=11201 Epoch=43.1] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.517 | L2-Norm(final)=3.026 | 4400.5 samples/s | 68.8 steps/s
[Step=11250 Epoch=43.3] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.503 | L2-Norm(final)=3.027 | 3838.8 samples/s | 60.0 steps/s
[Step=11300 Epoch=43.5] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.489 | L2-Norm(final)=3.030 | 4395.5 samples/s | 68.7 steps/s
[Step=11350 Epoch=43.7] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.475 | L2-Norm(final)=3.033 | 4339.3 samples/s | 67.8 steps/s
[Step=11400 Epoch=43.9] | Loss=0.00002 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.462 | L2-Norm(final)=3.036 | 4303.9 samples/s | 67.2 steps/s
[Step=11450 Epoch=44.1] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.448 | L2-Norm(final)=3.038 | 5603.7 samples/s | 87.6 steps/s
[Step=11500 Epoch=44.3] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.433 | L2-Norm(final)=3.040 | 1880.3 samples/s | 29.4 steps/s
[Step=11550 Epoch=44.5] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.419 | L2-Norm(final)=3.042 | 4284.2 samples/s | 66.9 steps/s
[Step=11600 Epoch=44.7] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.405 | L2-Norm(final)=3.044 | 4309.0 samples/s | 67.3 steps/s
[Step=11650 Epoch=44.8] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.391 | L2-Norm(final)=3.046 | 4360.7 samples/s | 68.1 steps/s
[Step=11700 Epoch=45.0] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.377 | L2-Norm(final)=3.048 | 5003.4 samples/s | 78.2 steps/s
[Step=11750 Epoch=45.2] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.362 | L2-Norm(final)=3.050 | 1927.7 samples/s | 30.1 steps/s
[Step=11800 Epoch=45.4] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.348 | L2-Norm(final)=3.052 | 4329.7 samples/s | 67.7 steps/s
[Step=11850 Epoch=45.6] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.334 | L2-Norm(final)=3.054 | 4290.0 samples/s | 67.0 steps/s
[Step=11900 Epoch=45.8] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.319 | L2-Norm(final)=3.056 | 4386.8 samples/s | 68.5 steps/s
[Step=11950 Epoch=46.0] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.305 | L2-Norm(final)=3.058 | 4511.3 samples/s | 70.5 steps/s
[Step=12000 Epoch=46.2] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.291 | L2-Norm(final)=3.059 | 2016.3 samples/s | 31.5 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step12000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.13952 | acc=0.9559 | tpr=0.9688 | fpr=0.0723 | 4222.4 samples/s | 16.5 steps/s
Avg test loss: 0.14549, Avg test acc: 0.95436, Avg tpr: 0.96800, Avg fpr: 0.07563, total FA: 590

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.11842 | acc=0.9564 | tpr=0.9598 | fpr=0.0510 | 4129.5 samples/s | 16.1 steps/s
Avg test loss: 0.12184, Avg test acc: 0.95585, Avg tpr: 0.96025, Avg fpr: 0.05384, total FA: 420

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.31183 | acc=0.3144 | tpr=0.0060 | fpr=0.0161 | 4140.0 samples/s | 16.2 steps/s
Avg test loss: 4.32347, Avg test acc: 0.31220, Avg tpr: 0.00694, Avg fpr: 0.01641, total FA: 128

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.46749 | acc=0.3148 | tpr=0.0018 | fpr=0.0055 | 4170.2 samples/s | 16.3 steps/s
Avg test loss: 6.50015, Avg test acc: 0.31220, Avg tpr: 0.00157, Avg fpr: 0.00461, total FA: 36

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.03078 | acc=0.1669 | tpr=0.7788 | fpr=0.8441 | 4112.0 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.98534 | acc=0.1687 | tpr=0.7591 | fpr=0.8423 | 7654.6 samples/s | 29.9 steps/s
[Step= 150] | Loss=6.03003 | acc=0.1676 | tpr=0.7622 | fpr=0.8433 | 7775.5 samples/s | 30.4 steps/s
[Step= 200] | Loss=6.02756 | acc=0.1674 | tpr=0.7552 | fpr=0.8433 | 7548.7 samples/s | 29.5 steps/s
[Step= 250] | Loss=6.04272 | acc=0.1671 | tpr=0.7528 | fpr=0.8436 | 7902.1 samples/s | 30.9 steps/s
[Step= 300] | Loss=6.04345 | acc=0.1668 | tpr=0.7593 | fpr=0.8440 | 7505.3 samples/s | 29.3 steps/s
[Step= 350] | Loss=6.04123 | acc=0.1673 | tpr=0.7621 | fpr=0.8435 | 7641.6 samples/s | 29.8 steps/s
[Step= 400] | Loss=6.04536 | acc=0.1676 | tpr=0.7620 | fpr=0.8432 | 7603.8 samples/s | 29.7 steps/s
[Step= 450] | Loss=6.04540 | acc=0.1671 | tpr=0.7624 | fpr=0.8437 | 7340.1 samples/s | 28.7 steps/s
[Step= 500] | Loss=6.04932 | acc=0.1665 | tpr=0.7621 | fpr=0.8442 | 7562.9 samples/s | 29.5 steps/s
[Step= 550] | Loss=6.04919 | acc=0.1665 | tpr=0.7656 | fpr=0.8443 | 13130.4 samples/s | 51.3 steps/s
Avg test loss: 6.05171, Avg test acc: 0.16640, Avg tpr: 0.76545, Avg fpr: 0.84449, total FA: 117256

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.79123 | acc=0.1672 | tpr=0.7168 | fpr=0.8427 | 3949.7 samples/s | 15.4 steps/s
[Step= 100] | Loss=6.75603 | acc=0.1667 | tpr=0.6908 | fpr=0.8431 | 7363.6 samples/s | 28.8 steps/s
[Step= 150] | Loss=6.75811 | acc=0.1675 | tpr=0.6888 | fpr=0.8421 | 7672.4 samples/s | 30.0 steps/s
[Step= 200] | Loss=6.73564 | acc=0.1683 | tpr=0.6907 | fpr=0.8412 | 7318.3 samples/s | 28.6 steps/s
[Step= 250] | Loss=6.73412 | acc=0.1688 | tpr=0.6847 | fpr=0.8406 | 7507.6 samples/s | 29.3 steps/s
[Step= 300] | Loss=6.73544 | acc=0.1689 | tpr=0.6829 | fpr=0.8405 | 7866.3 samples/s | 30.7 steps/s
[Step= 350] | Loss=6.73193 | acc=0.1685 | tpr=0.6869 | fpr=0.8409 | 7076.8 samples/s | 27.6 steps/s
[Step= 400] | Loss=6.73086 | acc=0.1690 | tpr=0.6898 | fpr=0.8404 | 7567.6 samples/s | 29.6 steps/s
[Step= 450] | Loss=6.73746 | acc=0.1688 | tpr=0.6904 | fpr=0.8407 | 7259.8 samples/s | 28.4 steps/s
[Step= 500] | Loss=6.74628 | acc=0.1682 | tpr=0.6903 | fpr=0.8412 | 7450.9 samples/s | 29.1 steps/s
[Step= 550] | Loss=6.74487 | acc=0.1681 | tpr=0.6817 | fpr=0.8413 | 14182.1 samples/s | 55.4 steps/s
Avg test loss: 6.74773, Avg test acc: 0.16792, Avg tpr: 0.68185, Avg fpr: 0.84142, total FA: 116830

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09380 | acc=0.9820 | tpr=0.9513 | fpr=0.0174 | 3946.1 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.09522 | acc=0.9815 | tpr=0.9595 | fpr=0.0181 | 7487.9 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.09985 | acc=0.9804 | tpr=0.9611 | fpr=0.0192 | 8190.6 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.10076 | acc=0.9806 | tpr=0.9628 | fpr=0.0191 | 7703.9 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.10010 | acc=0.9808 | tpr=0.9598 | fpr=0.0188 | 7767.2 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.10107 | acc=0.9806 | tpr=0.9578 | fpr=0.0190 | 7696.3 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.10168 | acc=0.9804 | tpr=0.9574 | fpr=0.0192 | 7693.8 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.10298 | acc=0.9802 | tpr=0.9546 | fpr=0.0193 | 8105.4 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.10470 | acc=0.9799 | tpr=0.9537 | fpr=0.0197 | 7935.0 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.10409 | acc=0.9800 | tpr=0.9546 | fpr=0.0195 | 7819.1 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.10348 | acc=0.9802 | tpr=0.9534 | fpr=0.0193 | 14160.1 samples/s | 55.3 steps/s
Avg test loss: 0.10338, Avg test acc: 0.98020, Avg tpr: 0.95365, Avg fpr: 0.01932, total FA: 2682

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10326 | acc=0.9823 | tpr=0.9469 | fpr=0.0171 | 4132.9 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.10694 | acc=0.9819 | tpr=0.9616 | fpr=0.0177 | 7760.3 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.11148 | acc=0.9814 | tpr=0.9625 | fpr=0.0183 | 8410.4 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.11163 | acc=0.9814 | tpr=0.9661 | fpr=0.0183 | 7311.8 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.11050 | acc=0.9817 | tpr=0.9659 | fpr=0.0181 | 7881.7 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.11253 | acc=0.9814 | tpr=0.9636 | fpr=0.0183 | 8296.7 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.11343 | acc=0.9812 | tpr=0.9649 | fpr=0.0185 | 7585.6 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.11448 | acc=0.9810 | tpr=0.9628 | fpr=0.0187 | 8038.4 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.11726 | acc=0.9807 | tpr=0.9606 | fpr=0.0190 | 7485.9 samples/s | 29.2 steps/s
[Step= 500] | Loss=0.11645 | acc=0.9808 | tpr=0.9617 | fpr=0.0189 | 7314.9 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.11578 | acc=0.9809 | tpr=0.9614 | fpr=0.0188 | 14421.7 samples/s | 56.3 steps/s
Avg test loss: 0.11559, Avg test acc: 0.98089, Avg tpr: 0.96117, Avg fpr: 0.01875, total FA: 2604

server round 15/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00050, len=1
[Step=12001 Epoch=23.4] | Loss=0.00779 | Reg=0.00389 | acc=0.9844 | L2-Norm=19.735 | L2-Norm(final)=2.293 | 3588.6 samples/s | 56.1 steps/s
[Step=12050 Epoch=23.5] | Loss=0.00971 | Reg=0.00389 | acc=1.0000 | L2-Norm=19.735 | L2-Norm(final)=2.290 | 4185.0 samples/s | 65.4 steps/s
[Step=12100 Epoch=23.6] | Loss=0.00785 | Reg=0.00389 | acc=1.0000 | L2-Norm=19.730 | L2-Norm(final)=2.290 | 4371.8 samples/s | 68.3 steps/s
[Step=12150 Epoch=23.7] | Loss=0.00847 | Reg=0.00389 | acc=0.9844 | L2-Norm=19.726 | L2-Norm(final)=2.291 | 4413.8 samples/s | 69.0 steps/s
[Step=12200 Epoch=23.8] | Loss=0.00834 | Reg=0.00389 | acc=1.0000 | L2-Norm=19.725 | L2-Norm(final)=2.292 | 4439.8 samples/s | 69.4 steps/s
[Step=12250 Epoch=23.9] | Loss=0.00896 | Reg=0.00389 | acc=1.0000 | L2-Norm=19.724 | L2-Norm(final)=2.293 | 4464.1 samples/s | 69.8 steps/s
[Step=12300 Epoch=24.0] | Loss=0.00972 | Reg=0.00389 | acc=1.0000 | L2-Norm=19.726 | L2-Norm(final)=2.293 | 4513.9 samples/s | 70.5 steps/s
[Step=12350 Epoch=24.1] | Loss=0.00991 | Reg=0.00389 | acc=1.0000 | L2-Norm=19.730 | L2-Norm(final)=2.292 | 4558.2 samples/s | 71.2 steps/s
[Step=12400 Epoch=24.2] | Loss=0.01022 | Reg=0.00389 | acc=0.9844 | L2-Norm=19.735 | L2-Norm(final)=2.292 | 4585.9 samples/s | 71.7 steps/s
[Step=12450 Epoch=24.3] | Loss=0.01007 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.739 | L2-Norm(final)=2.292 | 4607.8 samples/s | 72.0 steps/s
[Step=12500 Epoch=24.4] | Loss=0.01028 | Reg=0.00390 | acc=0.9688 | L2-Norm=19.742 | L2-Norm(final)=2.292 | 5463.4 samples/s | 85.4 steps/s
[Step=12550 Epoch=24.5] | Loss=0.01033 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.744 | L2-Norm(final)=2.292 | 1857.5 samples/s | 29.0 steps/s
[Step=12600 Epoch=24.6] | Loss=0.01005 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.746 | L2-Norm(final)=2.292 | 4462.1 samples/s | 69.7 steps/s
[Step=12650 Epoch=24.7] | Loss=0.00990 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.747 | L2-Norm(final)=2.293 | 4544.6 samples/s | 71.0 steps/s
[Step=12700 Epoch=24.8] | Loss=0.00968 | Reg=0.00390 | acc=0.9688 | L2-Norm=19.749 | L2-Norm(final)=2.295 | 4457.3 samples/s | 69.6 steps/s
[Step=12750 Epoch=24.9] | Loss=0.00950 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.749 | L2-Norm(final)=2.297 | 4519.5 samples/s | 70.6 steps/s
[Step=12800 Epoch=25.0] | Loss=0.00951 | Reg=0.00390 | acc=0.9844 | L2-Norm=19.750 | L2-Norm(final)=2.298 | 4505.1 samples/s | 70.4 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step12800.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00050, len=1
[Step=12001 Epoch=23.5] | Loss=0.00304 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.614 | L2-Norm(final)=2.199 | 4168.9 samples/s | 65.1 steps/s
[Step=12050 Epoch=23.6] | Loss=0.00562 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.612 | L2-Norm(final)=2.206 | 4330.4 samples/s | 67.7 steps/s
[Step=12100 Epoch=23.7] | Loss=0.00761 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.612 | L2-Norm(final)=2.205 | 4523.3 samples/s | 70.7 steps/s
[Step=12150 Epoch=23.8] | Loss=0.00811 | Reg=0.00385 | acc=0.9688 | L2-Norm=19.614 | L2-Norm(final)=2.205 | 4487.2 samples/s | 70.1 steps/s
[Step=12200 Epoch=23.9] | Loss=0.00853 | Reg=0.00385 | acc=0.9844 | L2-Norm=19.614 | L2-Norm(final)=2.204 | 4429.4 samples/s | 69.2 steps/s
[Step=12250 Epoch=23.9] | Loss=0.00825 | Reg=0.00385 | acc=0.9844 | L2-Norm=19.615 | L2-Norm(final)=2.205 | 4529.2 samples/s | 70.8 steps/s
[Step=12300 Epoch=24.0] | Loss=0.00823 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.614 | L2-Norm(final)=2.206 | 4451.4 samples/s | 69.6 steps/s
[Step=12350 Epoch=24.1] | Loss=0.00825 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.613 | L2-Norm(final)=2.207 | 4487.5 samples/s | 70.1 steps/s
[Step=12400 Epoch=24.2] | Loss=0.00819 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.613 | L2-Norm(final)=2.209 | 4505.4 samples/s | 70.4 steps/s
[Step=12450 Epoch=24.3] | Loss=0.00830 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.612 | L2-Norm(final)=2.210 | 4452.9 samples/s | 69.6 steps/s
[Step=12500 Epoch=24.4] | Loss=0.00892 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.610 | L2-Norm(final)=2.212 | 5488.5 samples/s | 85.8 steps/s
[Step=12550 Epoch=24.5] | Loss=0.00877 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.609 | L2-Norm(final)=2.211 | 1897.6 samples/s | 29.6 steps/s
[Step=12600 Epoch=24.6] | Loss=0.00848 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.607 | L2-Norm(final)=2.212 | 4448.3 samples/s | 69.5 steps/s
[Step=12650 Epoch=24.7] | Loss=0.00836 | Reg=0.00384 | acc=0.9844 | L2-Norm=19.604 | L2-Norm(final)=2.212 | 4486.7 samples/s | 70.1 steps/s
[Step=12700 Epoch=24.8] | Loss=0.00819 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.601 | L2-Norm(final)=2.213 | 4456.5 samples/s | 69.6 steps/s
[Step=12750 Epoch=24.9] | Loss=0.00811 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.598 | L2-Norm(final)=2.213 | 4514.9 samples/s | 70.5 steps/s
[Step=12800 Epoch=25.0] | Loss=0.00810 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.594 | L2-Norm(final)=2.214 | 4474.9 samples/s | 69.9 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step12800.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00050, len=1
[Step=12001 Epoch=46.0] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.752 | L2-Norm(final)=5.596 | 4094.3 samples/s | 64.0 steps/s
[Step=12050 Epoch=46.2] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.738 | L2-Norm(final)=5.612 | 3662.6 samples/s | 57.2 steps/s
[Step=12100 Epoch=46.4] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.724 | L2-Norm(final)=5.627 | 4313.9 samples/s | 67.4 steps/s
[Step=12150 Epoch=46.6] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.710 | L2-Norm(final)=5.644 | 4136.8 samples/s | 64.6 steps/s
[Step=12200 Epoch=46.7] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.698 | L2-Norm(final)=5.663 | 4166.1 samples/s | 65.1 steps/s
[Step=12250 Epoch=46.9] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.685 | L2-Norm(final)=5.683 | 5344.0 samples/s | 83.5 steps/s
[Step=12300 Epoch=47.1] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.671 | L2-Norm(final)=5.702 | 1805.7 samples/s | 28.2 steps/s
[Step=12350 Epoch=47.3] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.658 | L2-Norm(final)=5.721 | 4271.9 samples/s | 66.7 steps/s
[Step=12400 Epoch=47.5] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.645 | L2-Norm(final)=5.740 | 4160.3 samples/s | 65.0 steps/s
[Step=12450 Epoch=47.7] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.631 | L2-Norm(final)=5.759 | 4136.0 samples/s | 64.6 steps/s
[Step=12500 Epoch=47.9] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.617 | L2-Norm(final)=5.778 | 4615.8 samples/s | 72.1 steps/s
[Step=12550 Epoch=48.1] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=5.796 | 1872.6 samples/s | 29.3 steps/s
[Step=12600 Epoch=48.3] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.589 | L2-Norm(final)=5.815 | 4242.4 samples/s | 66.3 steps/s
[Step=12650 Epoch=48.5] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.575 | L2-Norm(final)=5.833 | 4237.6 samples/s | 66.2 steps/s
[Step=12700 Epoch=48.7] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.561 | L2-Norm(final)=5.852 | 4203.8 samples/s | 65.7 steps/s
[Step=12750 Epoch=48.9] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.547 | L2-Norm(final)=5.870 | 4231.7 samples/s | 66.1 steps/s
[Step=12800 Epoch=49.0] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.532 | L2-Norm(final)=5.889 | 1950.5 samples/s | 30.5 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step12800.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00050, len=1
[Step=12001 Epoch=46.2] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.061 | L2-Norm(final)=3.090 | 3925.9 samples/s | 61.3 steps/s
[Step=12050 Epoch=46.4] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.047 | L2-Norm(final)=3.092 | 4103.7 samples/s | 64.1 steps/s
[Step=12100 Epoch=46.6] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.033 | L2-Norm(final)=3.097 | 4242.4 samples/s | 66.3 steps/s
[Step=12150 Epoch=46.8] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.019 | L2-Norm(final)=3.100 | 4431.7 samples/s | 69.2 steps/s
[Step=12200 Epoch=47.0] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.005 | L2-Norm(final)=3.104 | 4349.3 samples/s | 68.0 steps/s
[Step=12250 Epoch=47.2] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.990 | L2-Norm(final)=3.106 | 5617.9 samples/s | 87.8 steps/s
[Step=12300 Epoch=47.3] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.976 | L2-Norm(final)=3.109 | 1828.8 samples/s | 28.6 steps/s
[Step=12350 Epoch=47.5] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.961 | L2-Norm(final)=3.111 | 4435.0 samples/s | 69.3 steps/s
[Step=12400 Epoch=47.7] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.947 | L2-Norm(final)=3.114 | 4450.9 samples/s | 69.5 steps/s
[Step=12450 Epoch=47.9] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.932 | L2-Norm(final)=3.116 | 4368.4 samples/s | 68.3 steps/s
[Step=12500 Epoch=48.1] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.918 | L2-Norm(final)=3.119 | 4832.8 samples/s | 75.5 steps/s
[Step=12550 Epoch=48.3] | Loss=0.00001 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.903 | L2-Norm(final)=3.121 | 1947.9 samples/s | 30.4 steps/s
[Step=12600 Epoch=48.5] | Loss=0.00001 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.888 | L2-Norm(final)=3.124 | 4456.4 samples/s | 69.6 steps/s
[Step=12650 Epoch=48.7] | Loss=0.00001 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.874 | L2-Norm(final)=3.126 | 4341.4 samples/s | 67.8 steps/s
[Step=12700 Epoch=48.9] | Loss=0.00001 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.859 | L2-Norm(final)=3.129 | 4329.1 samples/s | 67.6 steps/s
[Step=12750 Epoch=49.1] | Loss=0.00001 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.844 | L2-Norm(final)=3.131 | 4458.1 samples/s | 69.7 steps/s
[Step=12800 Epoch=49.3] | Loss=0.00001 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.830 | L2-Norm(final)=3.134 | 2024.5 samples/s | 31.6 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step12800.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.13745 | acc=0.9538 | tpr=0.9586 | fpr=0.0565 | 4028.5 samples/s | 15.7 steps/s
Avg test loss: 0.14359, Avg test acc: 0.95244, Avg tpr: 0.95763, Avg fpr: 0.05897, total FA: 460

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.11762 | acc=0.9586 | tpr=0.9661 | fpr=0.0577 | 4107.8 samples/s | 16.0 steps/s
Avg test loss: 0.12534, Avg test acc: 0.95837, Avg tpr: 0.96637, Avg fpr: 0.05922, total FA: 462

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.46613 | acc=0.3144 | tpr=0.0047 | fpr=0.0131 | 4183.4 samples/s | 16.3 steps/s
Avg test loss: 4.47860, Avg test acc: 0.31240, Avg tpr: 0.00519, Avg fpr: 0.01192, total FA: 93

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.57438 | acc=0.3147 | tpr=0.0016 | fpr=0.0055 | 4097.0 samples/s | 16.0 steps/s
Avg test loss: 6.60797, Avg test acc: 0.31220, Avg tpr: 0.00152, Avg fpr: 0.00449, total FA: 35

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.39737 | acc=0.1761 | tpr=0.7257 | fpr=0.8338 | 4022.6 samples/s | 15.7 steps/s
[Step= 100] | Loss=5.35995 | acc=0.1808 | tpr=0.7143 | fpr=0.8292 | 7752.7 samples/s | 30.3 steps/s
[Step= 150] | Loss=5.40700 | acc=0.1789 | tpr=0.7262 | fpr=0.8312 | 7732.2 samples/s | 30.2 steps/s
[Step= 200] | Loss=5.40040 | acc=0.1792 | tpr=0.7180 | fpr=0.8306 | 7443.5 samples/s | 29.1 steps/s
[Step= 250] | Loss=5.41576 | acc=0.1790 | tpr=0.7162 | fpr=0.8308 | 7596.4 samples/s | 29.7 steps/s
[Step= 300] | Loss=5.41806 | acc=0.1783 | tpr=0.7149 | fpr=0.8315 | 7813.3 samples/s | 30.5 steps/s
[Step= 350] | Loss=5.41797 | acc=0.1788 | tpr=0.7163 | fpr=0.8310 | 7871.1 samples/s | 30.7 steps/s
[Step= 400] | Loss=5.42167 | acc=0.1789 | tpr=0.7166 | fpr=0.8308 | 7717.4 samples/s | 30.1 steps/s
[Step= 450] | Loss=5.42075 | acc=0.1783 | tpr=0.7167 | fpr=0.8314 | 7584.0 samples/s | 29.6 steps/s
[Step= 500] | Loss=5.42257 | acc=0.1778 | tpr=0.7159 | fpr=0.8319 | 7465.6 samples/s | 29.2 steps/s
[Step= 550] | Loss=5.42088 | acc=0.1780 | tpr=0.7163 | fpr=0.8318 | 13752.8 samples/s | 53.7 steps/s
Avg test loss: 5.42276, Avg test acc: 0.17786, Avg tpr: 0.71593, Avg fpr: 0.83192, total FA: 115511

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.29305 | acc=0.1574 | tpr=0.7788 | fpr=0.8537 | 4054.1 samples/s | 15.8 steps/s
[Step= 100] | Loss=7.25799 | acc=0.1593 | tpr=0.7484 | fpr=0.8517 | 7415.6 samples/s | 29.0 steps/s
[Step= 150] | Loss=7.26574 | acc=0.1593 | tpr=0.7392 | fpr=0.8514 | 7374.0 samples/s | 28.8 steps/s
[Step= 200] | Loss=7.24320 | acc=0.1604 | tpr=0.7366 | fpr=0.8501 | 7761.4 samples/s | 30.3 steps/s
[Step= 250] | Loss=7.24520 | acc=0.1601 | tpr=0.7284 | fpr=0.8502 | 7338.5 samples/s | 28.7 steps/s
[Step= 300] | Loss=7.24728 | acc=0.1600 | tpr=0.7309 | fpr=0.8504 | 7409.7 samples/s | 28.9 steps/s
[Step= 350] | Loss=7.24087 | acc=0.1594 | tpr=0.7351 | fpr=0.8511 | 7315.7 samples/s | 28.6 steps/s
[Step= 400] | Loss=7.23944 | acc=0.1595 | tpr=0.7407 | fpr=0.8510 | 7535.0 samples/s | 29.4 steps/s
[Step= 450] | Loss=7.24637 | acc=0.1590 | tpr=0.7381 | fpr=0.8515 | 7688.2 samples/s | 30.0 steps/s
[Step= 500] | Loss=7.25662 | acc=0.1583 | tpr=0.7388 | fpr=0.8522 | 7228.2 samples/s | 28.2 steps/s
[Step= 550] | Loss=7.25675 | acc=0.1579 | tpr=0.7346 | fpr=0.8526 | 13728.5 samples/s | 53.6 steps/s
Avg test loss: 7.25934, Avg test acc: 0.15773, Avg tpr: 0.73455, Avg fpr: 0.85276, total FA: 118404

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08681 | acc=0.9829 | tpr=0.9204 | fpr=0.0160 | 3951.0 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.08807 | acc=0.9832 | tpr=0.9424 | fpr=0.0161 | 7631.1 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.09212 | acc=0.9822 | tpr=0.9467 | fpr=0.0172 | 7517.4 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.09306 | acc=0.9824 | tpr=0.9508 | fpr=0.0171 | 7865.8 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.09249 | acc=0.9825 | tpr=0.9467 | fpr=0.0168 | 7747.2 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.09346 | acc=0.9822 | tpr=0.9447 | fpr=0.0171 | 7644.1 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.09406 | acc=0.9821 | tpr=0.9455 | fpr=0.0172 | 8096.5 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.09529 | acc=0.9819 | tpr=0.9415 | fpr=0.0174 | 7581.3 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.09690 | acc=0.9815 | tpr=0.9406 | fpr=0.0177 | 8005.1 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.09632 | acc=0.9817 | tpr=0.9423 | fpr=0.0176 | 7618.9 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.09580 | acc=0.9818 | tpr=0.9411 | fpr=0.0175 | 13780.3 samples/s | 53.8 steps/s
Avg test loss: 0.09571, Avg test acc: 0.98181, Avg tpr: 0.94136, Avg fpr: 0.01746, total FA: 2424

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10857 | acc=0.9823 | tpr=0.9469 | fpr=0.0171 | 4208.8 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.11265 | acc=0.9819 | tpr=0.9595 | fpr=0.0177 | 7717.6 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.11743 | acc=0.9814 | tpr=0.9611 | fpr=0.0182 | 7766.7 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.11768 | acc=0.9814 | tpr=0.9650 | fpr=0.0183 | 7692.8 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.11651 | acc=0.9816 | tpr=0.9651 | fpr=0.0181 | 7984.2 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.11870 | acc=0.9814 | tpr=0.9629 | fpr=0.0183 | 7480.0 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.11959 | acc=0.9812 | tpr=0.9637 | fpr=0.0185 | 7947.4 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.12070 | acc=0.9810 | tpr=0.9617 | fpr=0.0186 | 7697.2 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.12359 | acc=0.9807 | tpr=0.9596 | fpr=0.0190 | 7853.1 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.12273 | acc=0.9808 | tpr=0.9608 | fpr=0.0188 | 7182.7 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.12203 | acc=0.9809 | tpr=0.9610 | fpr=0.0187 | 14388.8 samples/s | 56.2 steps/s
Avg test loss: 0.12184, Avg test acc: 0.98090, Avg tpr: 0.96078, Avg fpr: 0.01873, total FA: 2601

server round 16/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00050, len=1
[Step=12801 Epoch=25.0] | Loss=0.01020 | Reg=0.00390 | acc=0.9844 | L2-Norm=19.760 | L2-Norm(final)=2.318 | 4423.0 samples/s | 69.1 steps/s
[Step=12850 Epoch=25.1] | Loss=0.00589 | Reg=0.00391 | acc=0.9844 | L2-Norm=19.761 | L2-Norm(final)=2.323 | 3933.6 samples/s | 61.5 steps/s
[Step=12900 Epoch=25.2] | Loss=0.00857 | Reg=0.00390 | acc=0.9688 | L2-Norm=19.758 | L2-Norm(final)=2.323 | 4486.0 samples/s | 70.1 steps/s
[Step=12950 Epoch=25.3] | Loss=0.00802 | Reg=0.00390 | acc=0.9844 | L2-Norm=19.754 | L2-Norm(final)=2.322 | 4523.1 samples/s | 70.7 steps/s
[Step=13000 Epoch=25.4] | Loss=0.00809 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.752 | L2-Norm(final)=2.323 | 4433.3 samples/s | 69.3 steps/s
[Step=13050 Epoch=25.5] | Loss=0.00808 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.750 | L2-Norm(final)=2.322 | 4403.3 samples/s | 68.8 steps/s
[Step=13100 Epoch=25.6] | Loss=0.00839 | Reg=0.00390 | acc=0.9844 | L2-Norm=19.747 | L2-Norm(final)=2.322 | 4470.8 samples/s | 69.9 steps/s
[Step=13150 Epoch=25.6] | Loss=0.00874 | Reg=0.00390 | acc=0.9688 | L2-Norm=19.744 | L2-Norm(final)=2.321 | 4443.4 samples/s | 69.4 steps/s
[Step=13200 Epoch=25.7] | Loss=0.00886 | Reg=0.00390 | acc=0.9688 | L2-Norm=19.741 | L2-Norm(final)=2.320 | 4442.6 samples/s | 69.4 steps/s
[Step=13250 Epoch=25.8] | Loss=0.00884 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.739 | L2-Norm(final)=2.319 | 4455.1 samples/s | 69.6 steps/s
[Step=13300 Epoch=25.9] | Loss=0.00856 | Reg=0.00390 | acc=1.0000 | L2-Norm=19.736 | L2-Norm(final)=2.319 | 5542.8 samples/s | 86.6 steps/s
[Step=13350 Epoch=26.0] | Loss=0.00867 | Reg=0.00389 | acc=1.0000 | L2-Norm=19.733 | L2-Norm(final)=2.319 | 1885.8 samples/s | 29.5 steps/s
[Step=13400 Epoch=26.1] | Loss=0.00871 | Reg=0.00389 | acc=0.9844 | L2-Norm=19.730 | L2-Norm(final)=2.319 | 4582.4 samples/s | 71.6 steps/s
[Step=13450 Epoch=26.2] | Loss=0.00853 | Reg=0.00389 | acc=0.9844 | L2-Norm=19.726 | L2-Norm(final)=2.319 | 4576.2 samples/s | 71.5 steps/s
[Step=13500 Epoch=26.3] | Loss=0.00833 | Reg=0.00389 | acc=1.0000 | L2-Norm=19.722 | L2-Norm(final)=2.319 | 4486.4 samples/s | 70.1 steps/s
[Step=13550 Epoch=26.4] | Loss=0.00823 | Reg=0.00389 | acc=1.0000 | L2-Norm=19.719 | L2-Norm(final)=2.320 | 4549.8 samples/s | 71.1 steps/s
[Step=13600 Epoch=26.5] | Loss=0.00819 | Reg=0.00389 | acc=0.9844 | L2-Norm=19.715 | L2-Norm(final)=2.320 | 4498.6 samples/s | 70.3 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step13600.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00050, len=1
[Step=12801 Epoch=25.0] | Loss=0.00004 | Reg=0.00382 | acc=1.0000 | L2-Norm=19.536 | L2-Norm(final)=2.220 | 4277.0 samples/s | 66.8 steps/s
[Step=12850 Epoch=25.1] | Loss=0.00538 | Reg=0.00381 | acc=1.0000 | L2-Norm=19.530 | L2-Norm(final)=2.222 | 3772.3 samples/s | 58.9 steps/s
[Step=12900 Epoch=25.2] | Loss=0.00646 | Reg=0.00381 | acc=1.0000 | L2-Norm=19.525 | L2-Norm(final)=2.221 | 4345.3 samples/s | 67.9 steps/s
[Step=12950 Epoch=25.3] | Loss=0.00679 | Reg=0.00381 | acc=1.0000 | L2-Norm=19.519 | L2-Norm(final)=2.221 | 4447.5 samples/s | 69.5 steps/s
[Step=13000 Epoch=25.4] | Loss=0.00767 | Reg=0.00381 | acc=1.0000 | L2-Norm=19.515 | L2-Norm(final)=2.219 | 4478.5 samples/s | 70.0 steps/s
[Step=13050 Epoch=25.5] | Loss=0.00762 | Reg=0.00381 | acc=1.0000 | L2-Norm=19.513 | L2-Norm(final)=2.219 | 4482.5 samples/s | 70.0 steps/s
[Step=13100 Epoch=25.6] | Loss=0.00828 | Reg=0.00381 | acc=1.0000 | L2-Norm=19.511 | L2-Norm(final)=2.218 | 4549.3 samples/s | 71.1 steps/s
[Step=13150 Epoch=25.7] | Loss=0.00857 | Reg=0.00381 | acc=1.0000 | L2-Norm=19.509 | L2-Norm(final)=2.217 | 4535.8 samples/s | 70.9 steps/s
[Step=13200 Epoch=25.8] | Loss=0.00838 | Reg=0.00380 | acc=1.0000 | L2-Norm=19.506 | L2-Norm(final)=2.216 | 4515.7 samples/s | 70.6 steps/s
[Step=13250 Epoch=25.9] | Loss=0.00866 | Reg=0.00380 | acc=1.0000 | L2-Norm=19.505 | L2-Norm(final)=2.216 | 4613.1 samples/s | 72.1 steps/s
[Step=13300 Epoch=26.0] | Loss=0.00887 | Reg=0.00380 | acc=1.0000 | L2-Norm=19.503 | L2-Norm(final)=2.215 | 5563.3 samples/s | 86.9 steps/s
[Step=13350 Epoch=26.1] | Loss=0.00883 | Reg=0.00380 | acc=1.0000 | L2-Norm=19.502 | L2-Norm(final)=2.214 | 1898.6 samples/s | 29.7 steps/s
[Step=13400 Epoch=26.2] | Loss=0.00870 | Reg=0.00380 | acc=0.9844 | L2-Norm=19.500 | L2-Norm(final)=2.214 | 4511.7 samples/s | 70.5 steps/s
[Step=13450 Epoch=26.3] | Loss=0.00874 | Reg=0.00380 | acc=1.0000 | L2-Norm=19.498 | L2-Norm(final)=2.214 | 4533.4 samples/s | 70.8 steps/s
[Step=13500 Epoch=26.4] | Loss=0.00858 | Reg=0.00380 | acc=0.9844 | L2-Norm=19.497 | L2-Norm(final)=2.214 | 4321.0 samples/s | 67.5 steps/s
[Step=13550 Epoch=26.5] | Loss=0.00868 | Reg=0.00380 | acc=0.9844 | L2-Norm=19.495 | L2-Norm(final)=2.214 | 4408.6 samples/s | 68.9 steps/s
[Step=13600 Epoch=26.6] | Loss=0.00869 | Reg=0.00380 | acc=1.0000 | L2-Norm=19.494 | L2-Norm(final)=2.214 | 4550.4 samples/s | 71.1 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step13600.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00050, len=1
[Step=12801 Epoch=49.0] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.302 | L2-Norm(final)=6.188 | 4033.1 samples/s | 63.0 steps/s
[Step=12850 Epoch=49.2] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.288 | L2-Norm(final)=6.210 | 4042.1 samples/s | 63.2 steps/s
[Step=12900 Epoch=49.4] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.272 | L2-Norm(final)=6.228 | 4349.1 samples/s | 68.0 steps/s
[Step=12950 Epoch=49.6] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.256 | L2-Norm(final)=6.248 | 4103.4 samples/s | 64.1 steps/s
[Step=13000 Epoch=49.8] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.241 | L2-Norm(final)=6.267 | 4237.9 samples/s | 66.2 steps/s
[Step=13050 Epoch=50.0] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.225 | L2-Norm(final)=6.286 | 5417.8 samples/s | 84.7 steps/s
[Step=13100 Epoch=50.2] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.209 | L2-Norm(final)=6.306 | 1819.9 samples/s | 28.4 steps/s
[Step=13150 Epoch=50.4] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.193 | L2-Norm(final)=6.326 | 4250.1 samples/s | 66.4 steps/s
[Step=13200 Epoch=50.6] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.177 | L2-Norm(final)=6.345 | 4199.8 samples/s | 65.6 steps/s
[Step=13250 Epoch=50.8] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.161 | L2-Norm(final)=6.364 | 4339.2 samples/s | 67.8 steps/s
[Step=13300 Epoch=51.0] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.145 | L2-Norm(final)=6.384 | 4592.4 samples/s | 71.8 steps/s
[Step=13350 Epoch=51.2] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.129 | L2-Norm(final)=6.404 | 1870.4 samples/s | 29.2 steps/s
[Step=13400 Epoch=51.3] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.112 | L2-Norm(final)=6.424 | 4228.9 samples/s | 66.1 steps/s
[Step=13450 Epoch=51.5] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.096 | L2-Norm(final)=6.443 | 4187.5 samples/s | 65.4 steps/s
[Step=13500 Epoch=51.7] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.079 | L2-Norm(final)=6.463 | 4164.7 samples/s | 65.1 steps/s
[Step=13550 Epoch=51.9] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.063 | L2-Norm(final)=6.483 | 4240.3 samples/s | 66.3 steps/s
[Step=13600 Epoch=52.1] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.046 | L2-Norm(final)=6.503 | 1977.2 samples/s | 30.9 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step13600.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00050, len=1
[Step=12801 Epoch=49.3] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.596 | L2-Norm(final)=3.175 | 3962.4 samples/s | 61.9 steps/s
[Step=12850 Epoch=49.5] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.581 | L2-Norm(final)=3.178 | 3933.8 samples/s | 61.5 steps/s
[Step=12900 Epoch=49.7] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.567 | L2-Norm(final)=3.182 | 4221.2 samples/s | 66.0 steps/s
[Step=12950 Epoch=49.8] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.552 | L2-Norm(final)=3.185 | 4336.0 samples/s | 67.8 steps/s
[Step=13000 Epoch=50.0] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.537 | L2-Norm(final)=3.188 | 4452.5 samples/s | 69.6 steps/s
[Step=13050 Epoch=50.2] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.523 | L2-Norm(final)=3.191 | 5547.7 samples/s | 86.7 steps/s
[Step=13100 Epoch=50.4] | Loss=0.00000 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.508 | L2-Norm(final)=3.194 | 1847.5 samples/s | 28.9 steps/s
[Step=13150 Epoch=50.6] | Loss=0.00000 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.493 | L2-Norm(final)=3.197 | 4361.3 samples/s | 68.1 steps/s
[Step=13200 Epoch=50.8] | Loss=0.00000 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.478 | L2-Norm(final)=3.201 | 4474.7 samples/s | 69.9 steps/s
[Step=13250 Epoch=51.0] | Loss=0.00000 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.463 | L2-Norm(final)=3.204 | 4411.2 samples/s | 68.9 steps/s
[Step=13300 Epoch=51.2] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.449 | L2-Norm(final)=3.207 | 4901.4 samples/s | 76.6 steps/s
[Step=13350 Epoch=51.4] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.434 | L2-Norm(final)=3.210 | 1924.2 samples/s | 30.1 steps/s
[Step=13400 Epoch=51.6] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.419 | L2-Norm(final)=3.214 | 4412.0 samples/s | 68.9 steps/s
[Step=13450 Epoch=51.8] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.405 | L2-Norm(final)=3.217 | 4397.8 samples/s | 68.7 steps/s
[Step=13500 Epoch=52.0] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.390 | L2-Norm(final)=3.220 | 4248.0 samples/s | 66.4 steps/s
[Step=13550 Epoch=52.2] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.375 | L2-Norm(final)=3.224 | 4390.1 samples/s | 68.6 steps/s
[Step=13600 Epoch=52.4] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.360 | L2-Norm(final)=3.228 | 2014.7 samples/s | 31.5 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step13600.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.13447 | acc=0.9592 | tpr=0.9681 | fpr=0.0600 | 4101.1 samples/s | 16.0 steps/s
Avg test loss: 0.13862, Avg test acc: 0.95689, Avg tpr: 0.96579, Avg fpr: 0.06268, total FA: 489

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.11781 | acc=0.9586 | tpr=0.9736 | fpr=0.0741 | 4213.0 samples/s | 16.5 steps/s
Avg test loss: 0.12406, Avg test acc: 0.95837, Avg tpr: 0.97383, Avg fpr: 0.07563, total FA: 590

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.32747 | acc=0.3144 | tpr=0.0074 | fpr=0.0191 | 4232.5 samples/s | 16.5 steps/s
Avg test loss: 4.33961, Avg test acc: 0.31277, Avg tpr: 0.00816, Avg fpr: 0.01731, total FA: 135

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.46915 | acc=0.3146 | tpr=0.0016 | fpr=0.0057 | 3871.2 samples/s | 15.1 steps/s
Avg test loss: 6.50250, Avg test acc: 0.31212, Avg tpr: 0.00163, Avg fpr: 0.00500, total FA: 39

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.99417 | acc=0.1652 | tpr=0.7655 | fpr=0.8456 | 4094.1 samples/s | 16.0 steps/s
[Step= 100] | Loss=5.95225 | acc=0.1675 | tpr=0.7420 | fpr=0.8432 | 7703.6 samples/s | 30.1 steps/s
[Step= 150] | Loss=6.00082 | acc=0.1664 | tpr=0.7464 | fpr=0.8443 | 7546.2 samples/s | 29.5 steps/s
[Step= 200] | Loss=5.99179 | acc=0.1672 | tpr=0.7464 | fpr=0.8433 | 7285.9 samples/s | 28.5 steps/s
[Step= 250] | Loss=6.00403 | acc=0.1671 | tpr=0.7450 | fpr=0.8434 | 7675.2 samples/s | 30.0 steps/s
[Step= 300] | Loss=6.00827 | acc=0.1667 | tpr=0.7513 | fpr=0.8439 | 7593.6 samples/s | 29.7 steps/s
[Step= 350] | Loss=6.00579 | acc=0.1672 | tpr=0.7520 | fpr=0.8434 | 7802.2 samples/s | 30.5 steps/s
[Step= 400] | Loss=6.00788 | acc=0.1673 | tpr=0.7549 | fpr=0.8434 | 7563.3 samples/s | 29.5 steps/s
[Step= 450] | Loss=6.00573 | acc=0.1667 | tpr=0.7546 | fpr=0.8440 | 7664.4 samples/s | 29.9 steps/s
[Step= 500] | Loss=6.01050 | acc=0.1663 | tpr=0.7551 | fpr=0.8443 | 7312.3 samples/s | 28.6 steps/s
[Step= 550] | Loss=6.01123 | acc=0.1666 | tpr=0.7589 | fpr=0.8442 | 13209.7 samples/s | 51.6 steps/s
Avg test loss: 6.01391, Avg test acc: 0.16644, Avg tpr: 0.75911, Avg fpr: 0.84433, total FA: 117234

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.24541 | acc=0.1331 | tpr=0.8186 | fpr=0.8792 | 4084.1 samples/s | 16.0 steps/s
[Step= 100] | Loss=7.21450 | acc=0.1335 | tpr=0.7932 | fpr=0.8788 | 7281.1 samples/s | 28.4 steps/s
[Step= 150] | Loss=7.22981 | acc=0.1345 | tpr=0.7839 | fpr=0.8775 | 7534.9 samples/s | 29.4 steps/s
[Step= 200] | Loss=7.21206 | acc=0.1354 | tpr=0.7760 | fpr=0.8762 | 7703.9 samples/s | 30.1 steps/s
[Step= 250] | Loss=7.21496 | acc=0.1358 | tpr=0.7659 | fpr=0.8757 | 7174.8 samples/s | 28.0 steps/s
[Step= 300] | Loss=7.21612 | acc=0.1354 | tpr=0.7607 | fpr=0.8760 | 7393.8 samples/s | 28.9 steps/s
[Step= 350] | Loss=7.21252 | acc=0.1353 | tpr=0.7671 | fpr=0.8761 | 7525.1 samples/s | 29.4 steps/s
[Step= 400] | Loss=7.20864 | acc=0.1355 | tpr=0.7719 | fpr=0.8761 | 7727.6 samples/s | 30.2 steps/s
[Step= 450] | Loss=7.21589 | acc=0.1355 | tpr=0.7702 | fpr=0.8760 | 7420.9 samples/s | 29.0 steps/s
[Step= 500] | Loss=7.22752 | acc=0.1350 | tpr=0.7709 | fpr=0.8765 | 7351.6 samples/s | 28.7 steps/s
[Step= 550] | Loss=7.22795 | acc=0.1349 | tpr=0.7664 | fpr=0.8766 | 13629.1 samples/s | 53.2 steps/s
Avg test loss: 7.23060, Avg test acc: 0.13477, Avg tpr: 0.76624, Avg fpr: 0.87671, total FA: 121729

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10232 | acc=0.9813 | tpr=0.9513 | fpr=0.0181 | 4017.4 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.10462 | acc=0.9809 | tpr=0.9638 | fpr=0.0188 | 7397.4 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.10973 | acc=0.9797 | tpr=0.9640 | fpr=0.0200 | 7493.0 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.11050 | acc=0.9799 | tpr=0.9661 | fpr=0.0199 | 7438.6 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.10958 | acc=0.9802 | tpr=0.9624 | fpr=0.0195 | 7287.9 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.11068 | acc=0.9800 | tpr=0.9607 | fpr=0.0197 | 7867.3 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.11150 | acc=0.9797 | tpr=0.9599 | fpr=0.0200 | 7369.0 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.11284 | acc=0.9794 | tpr=0.9568 | fpr=0.0202 | 7884.5 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.11472 | acc=0.9791 | tpr=0.9562 | fpr=0.0205 | 7957.2 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.11415 | acc=0.9793 | tpr=0.9564 | fpr=0.0203 | 7611.4 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.11344 | acc=0.9795 | tpr=0.9558 | fpr=0.0201 | 14431.2 samples/s | 56.4 steps/s
Avg test loss: 0.11334, Avg test acc: 0.97946, Avg tpr: 0.95602, Avg fpr: 0.02012, total FA: 2793

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11612 | acc=0.9818 | tpr=0.9469 | fpr=0.0176 | 4169.4 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.12072 | acc=0.9814 | tpr=0.9616 | fpr=0.0183 | 7775.0 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.12580 | acc=0.9808 | tpr=0.9611 | fpr=0.0189 | 7952.7 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.12618 | acc=0.9809 | tpr=0.9650 | fpr=0.0189 | 7544.6 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.12495 | acc=0.9810 | tpr=0.9651 | fpr=0.0187 | 8333.5 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.12733 | acc=0.9808 | tpr=0.9629 | fpr=0.0189 | 7444.6 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.12825 | acc=0.9806 | tpr=0.9643 | fpr=0.0191 | 7795.5 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.12942 | acc=0.9805 | tpr=0.9623 | fpr=0.0192 | 7748.6 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.13244 | acc=0.9801 | tpr=0.9601 | fpr=0.0195 | 7815.2 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.13151 | acc=0.9803 | tpr=0.9617 | fpr=0.0194 | 8092.1 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.13077 | acc=0.9804 | tpr=0.9618 | fpr=0.0193 | 13507.9 samples/s | 52.8 steps/s
Avg test loss: 0.13056, Avg test acc: 0.98039, Avg tpr: 0.96157, Avg fpr: 0.01927, total FA: 2676

server round 17/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00050, len=1
[Step=13601 Epoch=26.5] | Loss=0.00878 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.656 | L2-Norm(final)=2.331 | 3975.1 samples/s | 62.1 steps/s
[Step=13650 Epoch=26.6] | Loss=0.00767 | Reg=0.00386 | acc=0.9844 | L2-Norm=19.652 | L2-Norm(final)=2.332 | 4392.1 samples/s | 68.6 steps/s
[Step=13700 Epoch=26.7] | Loss=0.00775 | Reg=0.00386 | acc=0.9688 | L2-Norm=19.647 | L2-Norm(final)=2.331 | 4510.6 samples/s | 70.5 steps/s
[Step=13750 Epoch=26.8] | Loss=0.00840 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.646 | L2-Norm(final)=2.331 | 4219.1 samples/s | 65.9 steps/s
[Step=13800 Epoch=26.9] | Loss=0.00874 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.645 | L2-Norm(final)=2.329 | 4310.4 samples/s | 67.4 steps/s
[Step=13850 Epoch=27.0] | Loss=0.00832 | Reg=0.00386 | acc=0.9844 | L2-Norm=19.645 | L2-Norm(final)=2.330 | 4471.8 samples/s | 69.9 steps/s
[Step=13900 Epoch=27.1] | Loss=0.00811 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.643 | L2-Norm(final)=2.331 | 4320.8 samples/s | 67.5 steps/s
[Step=13950 Epoch=27.2] | Loss=0.00791 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.640 | L2-Norm(final)=2.333 | 4313.1 samples/s | 67.4 steps/s
[Step=14000 Epoch=27.3] | Loss=0.00816 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.638 | L2-Norm(final)=2.335 | 4446.3 samples/s | 69.5 steps/s
[Step=14050 Epoch=27.4] | Loss=0.00806 | Reg=0.00386 | acc=0.9844 | L2-Norm=19.636 | L2-Norm(final)=2.336 | 4355.9 samples/s | 68.1 steps/s
[Step=14100 Epoch=27.5] | Loss=0.00803 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.636 | L2-Norm(final)=2.337 | 5380.2 samples/s | 84.1 steps/s
[Step=14150 Epoch=27.6] | Loss=0.00817 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.635 | L2-Norm(final)=2.338 | 1851.9 samples/s | 28.9 steps/s
[Step=14200 Epoch=27.7] | Loss=0.00815 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.633 | L2-Norm(final)=2.338 | 4457.7 samples/s | 69.7 steps/s
[Step=14250 Epoch=27.8] | Loss=0.00789 | Reg=0.00385 | acc=0.9844 | L2-Norm=19.631 | L2-Norm(final)=2.339 | 4427.7 samples/s | 69.2 steps/s
[Step=14300 Epoch=27.9] | Loss=0.00769 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.629 | L2-Norm(final)=2.341 | 4522.5 samples/s | 70.7 steps/s
[Step=14350 Epoch=28.0] | Loss=0.00760 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.626 | L2-Norm(final)=2.342 | 4590.3 samples/s | 71.7 steps/s
[Step=14400 Epoch=28.1] | Loss=0.00762 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.623 | L2-Norm(final)=2.343 | 4557.3 samples/s | 71.2 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step14400.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00050, len=1
[Step=13601 Epoch=26.6] | Loss=0.00189 | Reg=0.00379 | acc=1.0000 | L2-Norm=19.473 | L2-Norm(final)=2.210 | 4196.1 samples/s | 65.6 steps/s
[Step=13650 Epoch=26.7] | Loss=0.00665 | Reg=0.00379 | acc=1.0000 | L2-Norm=19.473 | L2-Norm(final)=2.216 | 3980.4 samples/s | 62.2 steps/s
[Step=13700 Epoch=26.8] | Loss=0.00588 | Reg=0.00379 | acc=1.0000 | L2-Norm=19.468 | L2-Norm(final)=2.220 | 4354.1 samples/s | 68.0 steps/s
[Step=13750 Epoch=26.9] | Loss=0.00705 | Reg=0.00379 | acc=1.0000 | L2-Norm=19.464 | L2-Norm(final)=2.222 | 4626.3 samples/s | 72.3 steps/s
[Step=13800 Epoch=27.0] | Loss=0.00777 | Reg=0.00379 | acc=0.9688 | L2-Norm=19.460 | L2-Norm(final)=2.220 | 4562.4 samples/s | 71.3 steps/s
[Step=13850 Epoch=27.1] | Loss=0.00740 | Reg=0.00379 | acc=1.0000 | L2-Norm=19.456 | L2-Norm(final)=2.220 | 4543.1 samples/s | 71.0 steps/s
[Step=13900 Epoch=27.2] | Loss=0.00719 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.452 | L2-Norm(final)=2.220 | 4560.5 samples/s | 71.3 steps/s
[Step=13950 Epoch=27.3] | Loss=0.00714 | Reg=0.00378 | acc=0.9844 | L2-Norm=19.448 | L2-Norm(final)=2.221 | 4471.3 samples/s | 69.9 steps/s
[Step=14000 Epoch=27.4] | Loss=0.00742 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.445 | L2-Norm(final)=2.221 | 4543.1 samples/s | 71.0 steps/s
[Step=14050 Epoch=27.5] | Loss=0.00789 | Reg=0.00378 | acc=0.9844 | L2-Norm=19.444 | L2-Norm(final)=2.221 | 4549.5 samples/s | 71.1 steps/s
[Step=14100 Epoch=27.6] | Loss=0.00833 | Reg=0.00378 | acc=0.9688 | L2-Norm=19.444 | L2-Norm(final)=2.221 | 5581.0 samples/s | 87.2 steps/s
[Step=14150 Epoch=27.7] | Loss=0.00830 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.445 | L2-Norm(final)=2.220 | 1874.9 samples/s | 29.3 steps/s
[Step=14200 Epoch=27.8] | Loss=0.00805 | Reg=0.00378 | acc=0.9844 | L2-Norm=19.446 | L2-Norm(final)=2.220 | 4500.5 samples/s | 70.3 steps/s
[Step=14250 Epoch=27.9] | Loss=0.00816 | Reg=0.00378 | acc=0.9688 | L2-Norm=19.446 | L2-Norm(final)=2.221 | 4449.7 samples/s | 69.5 steps/s
[Step=14300 Epoch=28.0] | Loss=0.00808 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.446 | L2-Norm(final)=2.221 | 4531.7 samples/s | 70.8 steps/s
[Step=14350 Epoch=28.1] | Loss=0.00808 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.446 | L2-Norm(final)=2.222 | 4475.3 samples/s | 69.9 steps/s
[Step=14400 Epoch=28.2] | Loss=0.00811 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.445 | L2-Norm(final)=2.223 | 4546.4 samples/s | 71.0 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step14400.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00050, len=1
[Step=13601 Epoch=52.1] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.774 | L2-Norm(final)=6.818 | 3731.7 samples/s | 58.3 steps/s
[Step=13650 Epoch=52.3] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.757 | L2-Norm(final)=6.839 | 4325.2 samples/s | 67.6 steps/s
[Step=13700 Epoch=52.5] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.739 | L2-Norm(final)=6.858 | 4207.0 samples/s | 65.7 steps/s
[Step=13750 Epoch=52.7] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.721 | L2-Norm(final)=6.877 | 4293.2 samples/s | 67.1 steps/s
[Step=13800 Epoch=52.9] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.703 | L2-Norm(final)=6.897 | 4227.4 samples/s | 66.1 steps/s
[Step=13850 Epoch=53.1] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.685 | L2-Norm(final)=6.919 | 5305.1 samples/s | 82.9 steps/s
[Step=13900 Epoch=53.3] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.666 | L2-Norm(final)=6.939 | 1812.5 samples/s | 28.3 steps/s
[Step=13950 Epoch=53.5] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.648 | L2-Norm(final)=6.960 | 4249.9 samples/s | 66.4 steps/s
[Step=14000 Epoch=53.6] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.629 | L2-Norm(final)=6.980 | 4117.6 samples/s | 64.3 steps/s
[Step=14050 Epoch=53.8] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.611 | L2-Norm(final)=7.001 | 4237.4 samples/s | 66.2 steps/s
[Step=14100 Epoch=54.0] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.592 | L2-Norm(final)=7.023 | 4639.0 samples/s | 72.5 steps/s
[Step=14150 Epoch=54.2] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.574 | L2-Norm(final)=7.045 | 1896.2 samples/s | 29.6 steps/s
[Step=14200 Epoch=54.4] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.555 | L2-Norm(final)=7.066 | 4115.8 samples/s | 64.3 steps/s
[Step=14250 Epoch=54.6] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.535 | L2-Norm(final)=7.086 | 4216.0 samples/s | 65.9 steps/s
[Step=14300 Epoch=54.8] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.516 | L2-Norm(final)=7.107 | 4208.9 samples/s | 65.8 steps/s
[Step=14350 Epoch=55.0] | Loss=0.00000 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.497 | L2-Norm(final)=7.129 | 4175.2 samples/s | 65.2 steps/s
[Step=14400 Epoch=55.2] | Loss=0.00000 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.479 | L2-Norm(final)=7.152 | 1942.3 samples/s | 30.3 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step14400.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00050, len=1
[Step=13601 Epoch=52.4] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.124 | L2-Norm(final)=3.285 | 4255.0 samples/s | 66.5 steps/s
[Step=13650 Epoch=52.5] | Loss=0.00000 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.110 | L2-Norm(final)=3.290 | 3910.2 samples/s | 61.1 steps/s
[Step=13700 Epoch=52.7] | Loss=0.00000 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.095 | L2-Norm(final)=3.294 | 4206.7 samples/s | 65.7 steps/s
[Step=13750 Epoch=52.9] | Loss=0.00000 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.080 | L2-Norm(final)=3.298 | 4335.3 samples/s | 67.7 steps/s
[Step=13800 Epoch=53.1] | Loss=0.00000 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.065 | L2-Norm(final)=3.302 | 4233.2 samples/s | 66.1 steps/s
[Step=13850 Epoch=53.3] | Loss=0.00000 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.050 | L2-Norm(final)=3.307 | 5341.5 samples/s | 83.5 steps/s
[Step=13900 Epoch=53.5] | Loss=0.00000 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.035 | L2-Norm(final)=3.311 | 1795.7 samples/s | 28.1 steps/s
[Step=13950 Epoch=53.7] | Loss=0.00000 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.020 | L2-Norm(final)=3.316 | 4235.5 samples/s | 66.2 steps/s
[Step=14000 Epoch=53.9] | Loss=0.00000 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.005 | L2-Norm(final)=3.321 | 4306.4 samples/s | 67.3 steps/s
[Step=14050 Epoch=54.1] | Loss=0.00000 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.990 | L2-Norm(final)=3.325 | 4370.3 samples/s | 68.3 steps/s
[Step=14100 Epoch=54.3] | Loss=0.00000 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.975 | L2-Norm(final)=3.330 | 4975.4 samples/s | 77.7 steps/s
[Step=14150 Epoch=54.5] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.960 | L2-Norm(final)=3.335 | 1918.7 samples/s | 30.0 steps/s
[Step=14200 Epoch=54.7] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.945 | L2-Norm(final)=3.340 | 4352.3 samples/s | 68.0 steps/s
[Step=14250 Epoch=54.9] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.930 | L2-Norm(final)=3.345 | 4301.4 samples/s | 67.2 steps/s
[Step=14300 Epoch=55.0] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.915 | L2-Norm(final)=3.350 | 4450.6 samples/s | 69.5 steps/s
[Step=14350 Epoch=55.2] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.900 | L2-Norm(final)=3.355 | 4476.1 samples/s | 69.9 steps/s
[Step=14400 Epoch=55.4] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.885 | L2-Norm(final)=3.360 | 2013.3 samples/s | 31.5 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step14400.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.12576 | acc=0.9574 | tpr=0.9671 | fpr=0.0637 | 4071.7 samples/s | 15.9 steps/s
Avg test loss: 0.12960, Avg test acc: 0.95657, Avg tpr: 0.96619, Avg fpr: 0.06461, total FA: 504

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.13332 | acc=0.9570 | tpr=0.9712 | fpr=0.0741 | 4175.5 samples/s | 16.3 steps/s
Avg test loss: 0.13528, Avg test acc: 0.95685, Avg tpr: 0.97138, Avg fpr: 0.07512, total FA: 586

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.89120 | acc=0.3150 | tpr=0.0051 | fpr=0.0121 | 4108.1 samples/s | 16.0 steps/s
Avg test loss: 4.90718, Avg test acc: 0.31285, Avg tpr: 0.00525, Avg fpr: 0.01064, total FA: 83

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.34223 | acc=0.3147 | tpr=0.0016 | fpr=0.0055 | 4141.0 samples/s | 16.2 steps/s
Avg test loss: 6.37533, Avg test acc: 0.31216, Avg tpr: 0.00157, Avg fpr: 0.00474, total FA: 37

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.75514 | acc=0.1745 | tpr=0.7345 | fpr=0.8355 | 4142.6 samples/s | 16.2 steps/s
[Step= 100] | Loss=5.71972 | acc=0.1771 | tpr=0.7164 | fpr=0.8329 | 7863.9 samples/s | 30.7 steps/s
[Step= 150] | Loss=5.76779 | acc=0.1750 | tpr=0.7190 | fpr=0.8350 | 7560.5 samples/s | 29.5 steps/s
[Step= 200] | Loss=5.76042 | acc=0.1749 | tpr=0.7126 | fpr=0.8349 | 7774.4 samples/s | 30.4 steps/s
[Step= 250] | Loss=5.77557 | acc=0.1749 | tpr=0.7127 | fpr=0.8349 | 8305.7 samples/s | 32.4 steps/s
[Step= 300] | Loss=5.78224 | acc=0.1746 | tpr=0.7193 | fpr=0.8354 | 7093.5 samples/s | 27.7 steps/s
[Step= 350] | Loss=5.77986 | acc=0.1747 | tpr=0.7201 | fpr=0.8352 | 7727.4 samples/s | 30.2 steps/s
[Step= 400] | Loss=5.78449 | acc=0.1749 | tpr=0.7205 | fpr=0.8350 | 7375.3 samples/s | 28.8 steps/s
[Step= 450] | Loss=5.78494 | acc=0.1745 | tpr=0.7225 | fpr=0.8354 | 7789.2 samples/s | 30.4 steps/s
[Step= 500] | Loss=5.78862 | acc=0.1739 | tpr=0.7220 | fpr=0.8360 | 7556.7 samples/s | 29.5 steps/s
[Step= 550] | Loss=5.78889 | acc=0.1738 | tpr=0.7203 | fpr=0.8362 | 14702.9 samples/s | 57.4 steps/s
Avg test loss: 5.79145, Avg test acc: 0.17358, Avg tpr: 0.71989, Avg fpr: 0.83635, total FA: 116125

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.47162 | acc=0.1388 | tpr=0.7611 | fpr=0.8724 | 4180.8 samples/s | 16.3 steps/s
[Step= 100] | Loss=7.43024 | acc=0.1405 | tpr=0.7591 | fpr=0.8710 | 7818.3 samples/s | 30.5 steps/s
[Step= 150] | Loss=7.44130 | acc=0.1406 | tpr=0.7637 | fpr=0.8709 | 6911.3 samples/s | 27.0 steps/s
[Step= 200] | Loss=7.42567 | acc=0.1420 | tpr=0.7574 | fpr=0.8692 | 7666.7 samples/s | 29.9 steps/s
[Step= 250] | Loss=7.42554 | acc=0.1420 | tpr=0.7450 | fpr=0.8690 | 7612.6 samples/s | 29.7 steps/s
[Step= 300] | Loss=7.42859 | acc=0.1418 | tpr=0.7455 | fpr=0.8692 | 7449.6 samples/s | 29.1 steps/s
[Step= 350] | Loss=7.42506 | acc=0.1414 | tpr=0.7520 | fpr=0.8697 | 7421.0 samples/s | 29.0 steps/s
[Step= 400] | Loss=7.42267 | acc=0.1412 | tpr=0.7588 | fpr=0.8700 | 7375.3 samples/s | 28.8 steps/s
[Step= 450] | Loss=7.42940 | acc=0.1412 | tpr=0.7566 | fpr=0.8699 | 7420.5 samples/s | 29.0 steps/s
[Step= 500] | Loss=7.44070 | acc=0.1407 | tpr=0.7551 | fpr=0.8704 | 7454.8 samples/s | 29.1 steps/s
[Step= 550] | Loss=7.44198 | acc=0.1406 | tpr=0.7513 | fpr=0.8705 | 13493.0 samples/s | 52.7 steps/s
Avg test loss: 7.44427, Avg test acc: 0.14052, Avg tpr: 0.75119, Avg fpr: 0.87059, total FA: 120879

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08562 | acc=0.9833 | tpr=0.9469 | fpr=0.0161 | 4019.1 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.08724 | acc=0.9834 | tpr=0.9574 | fpr=0.0161 | 7389.7 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.09111 | acc=0.9826 | tpr=0.9582 | fpr=0.0170 | 7436.8 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.09163 | acc=0.9828 | tpr=0.9596 | fpr=0.0168 | 7221.3 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.09123 | acc=0.9830 | tpr=0.9555 | fpr=0.0165 | 7386.7 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.09193 | acc=0.9828 | tpr=0.9513 | fpr=0.0166 | 7555.4 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.09254 | acc=0.9828 | tpr=0.9512 | fpr=0.0166 | 7493.6 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.09376 | acc=0.9825 | tpr=0.9469 | fpr=0.0168 | 8350.6 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.09524 | acc=0.9823 | tpr=0.9460 | fpr=0.0170 | 7452.9 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.09479 | acc=0.9824 | tpr=0.9471 | fpr=0.0170 | 7488.7 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.09414 | acc=0.9825 | tpr=0.9459 | fpr=0.0168 | 13685.5 samples/s | 53.5 steps/s
Avg test loss: 0.09408, Avg test acc: 0.98249, Avg tpr: 0.94612, Avg fpr: 0.01685, total FA: 2340

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11740 | acc=0.9821 | tpr=0.9469 | fpr=0.0173 | 4189.4 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.12221 | acc=0.9815 | tpr=0.9616 | fpr=0.0181 | 7690.0 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.12733 | acc=0.9810 | tpr=0.9611 | fpr=0.0187 | 7939.0 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.12783 | acc=0.9811 | tpr=0.9639 | fpr=0.0186 | 7784.7 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.12660 | acc=0.9812 | tpr=0.9642 | fpr=0.0184 | 7984.6 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.12911 | acc=0.9810 | tpr=0.9615 | fpr=0.0187 | 7803.7 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.12995 | acc=0.9808 | tpr=0.9624 | fpr=0.0188 | 7612.7 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.13111 | acc=0.9807 | tpr=0.9606 | fpr=0.0190 | 8220.6 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.13412 | acc=0.9803 | tpr=0.9581 | fpr=0.0192 | 7619.2 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.13316 | acc=0.9805 | tpr=0.9599 | fpr=0.0192 | 8074.1 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.13241 | acc=0.9806 | tpr=0.9602 | fpr=0.0190 | 13636.7 samples/s | 53.3 steps/s
Avg test loss: 0.13219, Avg test acc: 0.98061, Avg tpr: 0.95998, Avg fpr: 0.01901, total FA: 2640

server round 18/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00050, len=1
[Step=14401 Epoch=28.1] | Loss=0.00140 | Reg=0.00383 | acc=1.0000 | L2-Norm=19.578 | L2-Norm(final)=2.361 | 3682.1 samples/s | 57.5 steps/s
[Step=14450 Epoch=28.2] | Loss=0.00686 | Reg=0.00383 | acc=1.0000 | L2-Norm=19.575 | L2-Norm(final)=2.366 | 4504.1 samples/s | 70.4 steps/s
[Step=14500 Epoch=28.3] | Loss=0.00639 | Reg=0.00383 | acc=1.0000 | L2-Norm=19.571 | L2-Norm(final)=2.369 | 4677.1 samples/s | 73.1 steps/s
[Step=14550 Epoch=28.4] | Loss=0.00615 | Reg=0.00383 | acc=1.0000 | L2-Norm=19.566 | L2-Norm(final)=2.372 | 4664.2 samples/s | 72.9 steps/s
[Step=14600 Epoch=28.5] | Loss=0.00589 | Reg=0.00383 | acc=1.0000 | L2-Norm=19.561 | L2-Norm(final)=2.374 | 4541.8 samples/s | 71.0 steps/s
[Step=14650 Epoch=28.6] | Loss=0.00627 | Reg=0.00382 | acc=1.0000 | L2-Norm=19.557 | L2-Norm(final)=2.375 | 4565.6 samples/s | 71.3 steps/s
[Step=14700 Epoch=28.7] | Loss=0.00634 | Reg=0.00382 | acc=1.0000 | L2-Norm=19.552 | L2-Norm(final)=2.377 | 4464.8 samples/s | 69.8 steps/s
[Step=14750 Epoch=28.8] | Loss=0.00653 | Reg=0.00382 | acc=0.9844 | L2-Norm=19.547 | L2-Norm(final)=2.378 | 4182.9 samples/s | 65.4 steps/s
[Step=14800 Epoch=28.9] | Loss=0.00672 | Reg=0.00382 | acc=1.0000 | L2-Norm=19.544 | L2-Norm(final)=2.379 | 4503.6 samples/s | 70.4 steps/s
[Step=14850 Epoch=29.0] | Loss=0.00711 | Reg=0.00382 | acc=0.9844 | L2-Norm=19.542 | L2-Norm(final)=2.379 | 4507.4 samples/s | 70.4 steps/s
[Step=14900 Epoch=29.1] | Loss=0.00731 | Reg=0.00382 | acc=1.0000 | L2-Norm=19.541 | L2-Norm(final)=2.378 | 5467.0 samples/s | 85.4 steps/s
[Step=14950 Epoch=29.2] | Loss=0.00753 | Reg=0.00382 | acc=0.9844 | L2-Norm=19.541 | L2-Norm(final)=2.377 | 1876.9 samples/s | 29.3 steps/s
[Step=15000 Epoch=29.3] | Loss=0.00775 | Reg=0.00382 | acc=0.9844 | L2-Norm=19.542 | L2-Norm(final)=2.377 | 4504.8 samples/s | 70.4 steps/s
[Step=15050 Epoch=29.4] | Loss=0.00788 | Reg=0.00382 | acc=1.0000 | L2-Norm=19.543 | L2-Norm(final)=2.375 | 4557.5 samples/s | 71.2 steps/s
[Step=15100 Epoch=29.5] | Loss=0.00812 | Reg=0.00382 | acc=0.9844 | L2-Norm=19.545 | L2-Norm(final)=2.375 | 4483.7 samples/s | 70.1 steps/s
[Step=15150 Epoch=29.5] | Loss=0.00827 | Reg=0.00382 | acc=1.0000 | L2-Norm=19.548 | L2-Norm(final)=2.374 | 4539.3 samples/s | 70.9 steps/s
[Step=15200 Epoch=29.6] | Loss=0.00832 | Reg=0.00382 | acc=1.0000 | L2-Norm=19.551 | L2-Norm(final)=2.374 | 4514.3 samples/s | 70.5 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step15200.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00050, len=1
[Step=14401 Epoch=28.2] | Loss=0.00062 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.432 | L2-Norm(final)=2.229 | 4025.6 samples/s | 62.9 steps/s
[Step=14450 Epoch=28.2] | Loss=0.01003 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.431 | L2-Norm(final)=2.227 | 4347.7 samples/s | 67.9 steps/s
[Step=14500 Epoch=28.3] | Loss=0.00907 | Reg=0.00378 | acc=0.9844 | L2-Norm=19.435 | L2-Norm(final)=2.228 | 4461.3 samples/s | 69.7 steps/s
[Step=14550 Epoch=28.4] | Loss=0.00869 | Reg=0.00378 | acc=0.9844 | L2-Norm=19.437 | L2-Norm(final)=2.229 | 4644.5 samples/s | 72.6 steps/s
[Step=14600 Epoch=28.5] | Loss=0.00899 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.437 | L2-Norm(final)=2.229 | 4556.2 samples/s | 71.2 steps/s
[Step=14650 Epoch=28.6] | Loss=0.00856 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.438 | L2-Norm(final)=2.230 | 4563.8 samples/s | 71.3 steps/s
[Step=14700 Epoch=28.7] | Loss=0.00833 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.436 | L2-Norm(final)=2.232 | 4562.4 samples/s | 71.3 steps/s
[Step=14750 Epoch=28.8] | Loss=0.00810 | Reg=0.00378 | acc=0.9844 | L2-Norm=19.434 | L2-Norm(final)=2.233 | 4561.8 samples/s | 71.3 steps/s
[Step=14800 Epoch=28.9] | Loss=0.00854 | Reg=0.00378 | acc=0.9688 | L2-Norm=19.433 | L2-Norm(final)=2.234 | 4514.8 samples/s | 70.5 steps/s
[Step=14850 Epoch=29.0] | Loss=0.00891 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.435 | L2-Norm(final)=2.234 | 4574.5 samples/s | 71.5 steps/s
[Step=14900 Epoch=29.1] | Loss=0.00915 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.436 | L2-Norm(final)=2.234 | 5546.0 samples/s | 86.7 steps/s
[Step=14950 Epoch=29.2] | Loss=0.00876 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.438 | L2-Norm(final)=2.234 | 1821.2 samples/s | 28.5 steps/s
[Step=15000 Epoch=29.3] | Loss=0.00885 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.439 | L2-Norm(final)=2.234 | 4498.9 samples/s | 70.3 steps/s
[Step=15050 Epoch=29.4] | Loss=0.00900 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.440 | L2-Norm(final)=2.234 | 4465.7 samples/s | 69.8 steps/s
[Step=15100 Epoch=29.5] | Loss=0.00889 | Reg=0.00378 | acc=0.9844 | L2-Norm=19.441 | L2-Norm(final)=2.235 | 4525.3 samples/s | 70.7 steps/s
[Step=15150 Epoch=29.6] | Loss=0.00885 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.442 | L2-Norm(final)=2.236 | 4480.0 samples/s | 70.0 steps/s
[Step=15200 Epoch=29.7] | Loss=0.00875 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.442 | L2-Norm(final)=2.236 | 4403.5 samples/s | 68.8 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step15200.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00050, len=1
[Step=14401 Epoch=55.2] | Loss=0.00000 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.204 | L2-Norm(final)=7.538 | 3741.6 samples/s | 58.5 steps/s
[Step=14450 Epoch=55.4] | Loss=0.00000 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.182 | L2-Norm(final)=7.550 | 4174.4 samples/s | 65.2 steps/s
[Step=14500 Epoch=55.6] | Loss=0.00496 | Reg=0.00067 | acc=0.9688 | L2-Norm=8.180 | L2-Norm(final)=7.555 | 4266.3 samples/s | 66.7 steps/s
[Step=14550 Epoch=55.8] | Loss=0.00700 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.234 | L2-Norm(final)=7.526 | 4227.9 samples/s | 66.1 steps/s
[Step=14600 Epoch=55.9] | Loss=0.00699 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.273 | L2-Norm(final)=7.500 | 4203.1 samples/s | 65.7 steps/s
[Step=14650 Epoch=56.1] | Loss=0.00590 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.299 | L2-Norm(final)=7.481 | 5217.0 samples/s | 81.5 steps/s
[Step=14700 Epoch=56.3] | Loss=0.00509 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.312 | L2-Norm(final)=7.469 | 1774.7 samples/s | 27.7 steps/s
[Step=14750 Epoch=56.5] | Loss=0.00446 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.319 | L2-Norm(final)=7.461 | 4069.1 samples/s | 63.6 steps/s
[Step=14800 Epoch=56.7] | Loss=0.00395 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.321 | L2-Norm(final)=7.455 | 4059.4 samples/s | 63.4 steps/s
[Step=14850 Epoch=56.9] | Loss=0.00358 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.321 | L2-Norm(final)=7.451 | 4172.2 samples/s | 65.2 steps/s
[Step=14900 Epoch=57.1] | Loss=0.00324 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.319 | L2-Norm(final)=7.449 | 4779.0 samples/s | 74.7 steps/s
[Step=14950 Epoch=57.3] | Loss=0.00295 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.315 | L2-Norm(final)=7.447 | 1911.1 samples/s | 29.9 steps/s
[Step=15000 Epoch=57.5] | Loss=0.00270 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.309 | L2-Norm(final)=7.446 | 4338.5 samples/s | 67.8 steps/s
[Step=15050 Epoch=57.7] | Loss=0.00250 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.302 | L2-Norm(final)=7.445 | 4242.4 samples/s | 66.3 steps/s
[Step=15100 Epoch=57.9] | Loss=0.00232 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.294 | L2-Norm(final)=7.444 | 4216.5 samples/s | 65.9 steps/s
[Step=15150 Epoch=58.0] | Loss=0.00217 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.286 | L2-Norm(final)=7.444 | 4243.0 samples/s | 66.3 steps/s
[Step=15200 Epoch=58.2] | Loss=0.00203 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.277 | L2-Norm(final)=7.443 | 1967.4 samples/s | 30.7 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step15200.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00050, len=1
[Step=14401 Epoch=55.4] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.644 | L2-Norm(final)=3.442 | 3903.0 samples/s | 61.0 steps/s
[Step=14450 Epoch=55.6] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.630 | L2-Norm(final)=3.449 | 3922.9 samples/s | 61.3 steps/s
[Step=14500 Epoch=55.8] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.615 | L2-Norm(final)=3.456 | 4212.6 samples/s | 65.8 steps/s
[Step=14550 Epoch=56.0] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.600 | L2-Norm(final)=3.462 | 4135.6 samples/s | 64.6 steps/s
[Step=14600 Epoch=56.2] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.585 | L2-Norm(final)=3.468 | 4170.4 samples/s | 65.2 steps/s
[Step=14650 Epoch=56.4] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.570 | L2-Norm(final)=3.475 | 5304.6 samples/s | 82.9 steps/s
[Step=14700 Epoch=56.6] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.555 | L2-Norm(final)=3.481 | 1801.0 samples/s | 28.1 steps/s
[Step=14750 Epoch=56.8] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.540 | L2-Norm(final)=3.487 | 4153.6 samples/s | 64.9 steps/s
[Step=14800 Epoch=57.0] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.525 | L2-Norm(final)=3.494 | 4200.6 samples/s | 65.6 steps/s
[Step=14850 Epoch=57.2] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.510 | L2-Norm(final)=3.500 | 4159.8 samples/s | 65.0 steps/s
[Step=14900 Epoch=57.4] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.495 | L2-Norm(final)=3.507 | 4761.9 samples/s | 74.4 steps/s
[Step=14950 Epoch=57.5] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.480 | L2-Norm(final)=3.514 | 1908.9 samples/s | 29.8 steps/s
[Step=15000 Epoch=57.7] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.465 | L2-Norm(final)=3.521 | 4366.2 samples/s | 68.2 steps/s
[Step=15050 Epoch=57.9] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.449 | L2-Norm(final)=3.527 | 4356.5 samples/s | 68.1 steps/s
[Step=15100 Epoch=58.1] | Loss=0.00000 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.434 | L2-Norm(final)=3.534 | 4404.6 samples/s | 68.8 steps/s
[Step=15150 Epoch=58.3] | Loss=0.00000 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.419 | L2-Norm(final)=3.541 | 4513.5 samples/s | 70.5 steps/s
[Step=15200 Epoch=58.5] | Loss=0.00000 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.404 | L2-Norm(final)=3.548 | 2007.3 samples/s | 31.4 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step15200.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.12619 | acc=0.9568 | tpr=0.9635 | fpr=0.0577 | 4276.2 samples/s | 16.7 steps/s
Avg test loss: 0.13072, Avg test acc: 0.95520, Avg tpr: 0.96159, Avg fpr: 0.05884, total FA: 459

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14002 | acc=0.9578 | tpr=0.9708 | fpr=0.0704 | 4203.4 samples/s | 16.4 steps/s
Avg test loss: 0.14295, Avg test acc: 0.95725, Avg tpr: 0.97109, Avg fpr: 0.07320, total FA: 571

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=3.95464 | acc=0.3134 | tpr=0.0079 | fpr=0.0233 | 4277.5 samples/s | 16.7 steps/s
Avg test loss: 3.96195, Avg test acc: 0.31120, Avg tpr: 0.00775, Avg fpr: 0.02141, total FA: 167

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=6.07982 | acc=0.3147 | tpr=0.0021 | fpr=0.0064 | 4355.3 samples/s | 17.0 steps/s
Avg test loss: 6.11184, Avg test acc: 0.31212, Avg tpr: 0.00210, Avg fpr: 0.00602, total FA: 47

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.45788 | acc=0.1814 | tpr=0.7345 | fpr=0.8285 | 4220.5 samples/s | 16.5 steps/s
[Step= 100] | Loss=5.42954 | acc=0.1837 | tpr=0.7271 | fpr=0.8264 | 7755.1 samples/s | 30.3 steps/s
[Step= 150] | Loss=5.46910 | acc=0.1823 | tpr=0.7363 | fpr=0.8279 | 7812.3 samples/s | 30.5 steps/s
[Step= 200] | Loss=5.45656 | acc=0.1818 | tpr=0.7224 | fpr=0.8280 | 7884.5 samples/s | 30.8 steps/s
[Step= 250] | Loss=5.46548 | acc=0.1815 | tpr=0.7179 | fpr=0.8283 | 7669.5 samples/s | 30.0 steps/s
[Step= 300] | Loss=5.46987 | acc=0.1808 | tpr=0.7207 | fpr=0.8291 | 7335.9 samples/s | 28.7 steps/s
[Step= 350] | Loss=5.46937 | acc=0.1810 | tpr=0.7220 | fpr=0.8288 | 7484.9 samples/s | 29.2 steps/s
[Step= 400] | Loss=5.47180 | acc=0.1816 | tpr=0.7292 | fpr=0.8284 | 7852.0 samples/s | 30.7 steps/s
[Step= 450] | Loss=5.47163 | acc=0.1810 | tpr=0.7293 | fpr=0.8290 | 7969.1 samples/s | 31.1 steps/s
[Step= 500] | Loss=5.47485 | acc=0.1807 | tpr=0.7295 | fpr=0.8292 | 7600.5 samples/s | 29.7 steps/s
[Step= 550] | Loss=5.47495 | acc=0.1806 | tpr=0.7302 | fpr=0.8294 | 14242.5 samples/s | 55.6 steps/s
Avg test loss: 5.47830, Avg test acc: 0.18046, Avg tpr: 0.73019, Avg fpr: 0.82953, total FA: 115179

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=8.04581 | acc=0.1397 | tpr=0.7743 | fpr=0.8717 | 4129.7 samples/s | 16.1 steps/s
[Step= 100] | Loss=7.99166 | acc=0.1404 | tpr=0.7505 | fpr=0.8710 | 7529.1 samples/s | 29.4 steps/s
[Step= 150] | Loss=8.00776 | acc=0.1401 | tpr=0.7406 | fpr=0.8710 | 7367.3 samples/s | 28.8 steps/s
[Step= 200] | Loss=7.98501 | acc=0.1416 | tpr=0.7377 | fpr=0.8692 | 7524.8 samples/s | 29.4 steps/s
[Step= 250] | Loss=7.98547 | acc=0.1415 | tpr=0.7284 | fpr=0.8692 | 7799.4 samples/s | 30.5 steps/s
[Step= 300] | Loss=7.98634 | acc=0.1410 | tpr=0.7251 | fpr=0.8696 | 7301.3 samples/s | 28.5 steps/s
[Step= 350] | Loss=7.98318 | acc=0.1409 | tpr=0.7326 | fpr=0.8698 | 7321.0 samples/s | 28.6 steps/s
[Step= 400] | Loss=7.97943 | acc=0.1410 | tpr=0.7407 | fpr=0.8699 | 7726.3 samples/s | 30.2 steps/s
[Step= 450] | Loss=7.98717 | acc=0.1409 | tpr=0.7366 | fpr=0.8699 | 7276.2 samples/s | 28.4 steps/s
[Step= 500] | Loss=7.99806 | acc=0.1406 | tpr=0.7374 | fpr=0.8702 | 7172.5 samples/s | 28.0 steps/s
[Step= 550] | Loss=7.99828 | acc=0.1403 | tpr=0.7342 | fpr=0.8705 | 13755.7 samples/s | 53.7 steps/s
Avg test loss: 8.00023, Avg test acc: 0.14023, Avg tpr: 0.73455, Avg fpr: 0.87057, total FA: 120877

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.06782 | acc=0.9835 | tpr=0.9513 | fpr=0.0159 | 4074.4 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.07048 | acc=0.9831 | tpr=0.9595 | fpr=0.0164 | 7404.9 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.07389 | acc=0.9824 | tpr=0.9568 | fpr=0.0171 | 7523.0 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.07393 | acc=0.9825 | tpr=0.9628 | fpr=0.0171 | 7118.0 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.07369 | acc=0.9827 | tpr=0.9607 | fpr=0.0169 | 7456.8 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.07383 | acc=0.9827 | tpr=0.9607 | fpr=0.0169 | 7412.3 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.07391 | acc=0.9826 | tpr=0.9599 | fpr=0.0170 | 7350.3 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.07457 | acc=0.9823 | tpr=0.9573 | fpr=0.0172 | 7871.9 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.07575 | acc=0.9820 | tpr=0.9547 | fpr=0.0175 | 7893.0 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.07540 | acc=0.9821 | tpr=0.9551 | fpr=0.0174 | 7482.8 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.07503 | acc=0.9823 | tpr=0.9522 | fpr=0.0172 | 14947.4 samples/s | 58.4 steps/s
Avg test loss: 0.07496, Avg test acc: 0.98227, Avg tpr: 0.95246, Avg fpr: 0.01719, total FA: 2387

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13537 | acc=0.9800 | tpr=0.9469 | fpr=0.0194 | 4148.9 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.14133 | acc=0.9798 | tpr=0.9659 | fpr=0.0199 | 7777.6 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.14726 | acc=0.9789 | tpr=0.9654 | fpr=0.0208 | 7839.4 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.14793 | acc=0.9791 | tpr=0.9683 | fpr=0.0207 | 8246.8 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.14661 | acc=0.9791 | tpr=0.9703 | fpr=0.0207 | 7581.1 samples/s | 29.6 steps/s
[Step= 300] | Loss=0.14947 | acc=0.9789 | tpr=0.9680 | fpr=0.0209 | 7867.8 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.15036 | acc=0.9788 | tpr=0.9687 | fpr=0.0210 | 7809.1 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.15164 | acc=0.9787 | tpr=0.9677 | fpr=0.0211 | 7753.7 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.15496 | acc=0.9783 | tpr=0.9659 | fpr=0.0215 | 7981.1 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.15390 | acc=0.9783 | tpr=0.9670 | fpr=0.0215 | 7931.3 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.15301 | acc=0.9784 | tpr=0.9666 | fpr=0.0214 | 13277.4 samples/s | 51.9 steps/s
Avg test loss: 0.15275, Avg test acc: 0.97845, Avg tpr: 0.96632, Avg fpr: 0.02133, total FA: 2962

server round 19/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00050, len=1
[Step=15201 Epoch=29.6] | Loss=0.00173 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.594 | L2-Norm(final)=2.372 | 3779.5 samples/s | 59.1 steps/s
[Step=15250 Epoch=29.7] | Loss=0.00655 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.593 | L2-Norm(final)=2.379 | 4530.9 samples/s | 70.8 steps/s
[Step=15300 Epoch=29.8] | Loss=0.00655 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.591 | L2-Norm(final)=2.383 | 4538.8 samples/s | 70.9 steps/s
[Step=15350 Epoch=29.9] | Loss=0.00851 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.593 | L2-Norm(final)=2.386 | 4575.9 samples/s | 71.5 steps/s
[Step=15400 Epoch=30.0] | Loss=0.00860 | Reg=0.00384 | acc=0.9844 | L2-Norm=19.597 | L2-Norm(final)=2.386 | 4620.6 samples/s | 72.2 steps/s
[Step=15450 Epoch=30.1] | Loss=0.00873 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.602 | L2-Norm(final)=2.388 | 4669.8 samples/s | 73.0 steps/s
[Step=15500 Epoch=30.2] | Loss=0.00896 | Reg=0.00384 | acc=1.0000 | L2-Norm=19.605 | L2-Norm(final)=2.388 | 4642.7 samples/s | 72.5 steps/s
[Step=15550 Epoch=30.3] | Loss=0.00900 | Reg=0.00384 | acc=0.9688 | L2-Norm=19.609 | L2-Norm(final)=2.388 | 4548.1 samples/s | 71.1 steps/s
[Step=15600 Epoch=30.4] | Loss=0.00919 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.612 | L2-Norm(final)=2.388 | 4447.2 samples/s | 69.5 steps/s
[Step=15650 Epoch=30.5] | Loss=0.00959 | Reg=0.00385 | acc=0.9844 | L2-Norm=19.614 | L2-Norm(final)=2.388 | 4458.5 samples/s | 69.7 steps/s
[Step=15700 Epoch=30.6] | Loss=0.01022 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.617 | L2-Norm(final)=2.387 | 5517.5 samples/s | 86.2 steps/s
[Step=15750 Epoch=30.7] | Loss=0.01099 | Reg=0.00385 | acc=0.9531 | L2-Norm=19.620 | L2-Norm(final)=2.384 | 1819.4 samples/s | 28.4 steps/s
[Step=15800 Epoch=30.8] | Loss=0.01074 | Reg=0.00385 | acc=0.9844 | L2-Norm=19.624 | L2-Norm(final)=2.381 | 4393.5 samples/s | 68.6 steps/s
[Step=15850 Epoch=30.9] | Loss=0.01060 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.627 | L2-Norm(final)=2.379 | 4416.0 samples/s | 69.0 steps/s
[Step=15900 Epoch=31.0] | Loss=0.01035 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.630 | L2-Norm(final)=2.377 | 4456.7 samples/s | 69.6 steps/s
[Step=15950 Epoch=31.1] | Loss=0.01013 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.632 | L2-Norm(final)=2.376 | 4523.8 samples/s | 70.7 steps/s
[Step=16000 Epoch=31.2] | Loss=0.01002 | Reg=0.00386 | acc=0.9844 | L2-Norm=19.635 | L2-Norm(final)=2.376 | 4392.5 samples/s | 68.6 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step16000.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00050, len=1
[Step=15201 Epoch=29.7] | Loss=0.00341 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.439 | L2-Norm(final)=2.246 | 4036.3 samples/s | 63.1 steps/s
[Step=15250 Epoch=29.8] | Loss=0.00515 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.436 | L2-Norm(final)=2.249 | 4338.5 samples/s | 67.8 steps/s
[Step=15300 Epoch=29.9] | Loss=0.00590 | Reg=0.00378 | acc=0.9844 | L2-Norm=19.432 | L2-Norm(final)=2.251 | 4489.6 samples/s | 70.2 steps/s
[Step=15350 Epoch=30.0] | Loss=0.00620 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.429 | L2-Norm(final)=2.252 | 4470.5 samples/s | 69.9 steps/s
[Step=15400 Epoch=30.1] | Loss=0.00659 | Reg=0.00377 | acc=0.9844 | L2-Norm=19.427 | L2-Norm(final)=2.253 | 4484.6 samples/s | 70.1 steps/s
[Step=15450 Epoch=30.2] | Loss=0.00673 | Reg=0.00377 | acc=0.9844 | L2-Norm=19.424 | L2-Norm(final)=2.254 | 4503.5 samples/s | 70.4 steps/s
[Step=15500 Epoch=30.3] | Loss=0.00691 | Reg=0.00377 | acc=0.9844 | L2-Norm=19.421 | L2-Norm(final)=2.254 | 4488.3 samples/s | 70.1 steps/s
[Step=15550 Epoch=30.4] | Loss=0.00689 | Reg=0.00377 | acc=1.0000 | L2-Norm=19.418 | L2-Norm(final)=2.254 | 4517.3 samples/s | 70.6 steps/s
[Step=15600 Epoch=30.5] | Loss=0.00703 | Reg=0.00377 | acc=0.9844 | L2-Norm=19.415 | L2-Norm(final)=2.254 | 4563.3 samples/s | 71.3 steps/s
[Step=15650 Epoch=30.6] | Loss=0.00718 | Reg=0.00377 | acc=1.0000 | L2-Norm=19.411 | L2-Norm(final)=2.255 | 4692.4 samples/s | 73.3 steps/s
[Step=15700 Epoch=30.7] | Loss=0.00735 | Reg=0.00377 | acc=1.0000 | L2-Norm=19.408 | L2-Norm(final)=2.255 | 5506.6 samples/s | 86.0 steps/s
[Step=15750 Epoch=30.8] | Loss=0.00733 | Reg=0.00377 | acc=1.0000 | L2-Norm=19.405 | L2-Norm(final)=2.255 | 1889.4 samples/s | 29.5 steps/s
[Step=15800 Epoch=30.9] | Loss=0.00718 | Reg=0.00376 | acc=1.0000 | L2-Norm=19.402 | L2-Norm(final)=2.256 | 4536.4 samples/s | 70.9 steps/s
[Step=15850 Epoch=31.0] | Loss=0.00731 | Reg=0.00376 | acc=0.9844 | L2-Norm=19.399 | L2-Norm(final)=2.256 | 4513.4 samples/s | 70.5 steps/s
[Step=15900 Epoch=31.1] | Loss=0.00752 | Reg=0.00376 | acc=1.0000 | L2-Norm=19.397 | L2-Norm(final)=2.257 | 4492.8 samples/s | 70.2 steps/s
[Step=15950 Epoch=31.2] | Loss=0.00737 | Reg=0.00376 | acc=1.0000 | L2-Norm=19.396 | L2-Norm(final)=2.258 | 4462.5 samples/s | 69.7 steps/s
[Step=16000 Epoch=31.3] | Loss=0.00742 | Reg=0.00376 | acc=1.0000 | L2-Norm=19.394 | L2-Norm(final)=2.259 | 4433.5 samples/s | 69.3 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step16000.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00050, len=1
[Step=15201 Epoch=58.2] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.126 | L2-Norm(final)=7.439 | 3878.6 samples/s | 60.6 steps/s
[Step=15250 Epoch=58.4] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.114 | L2-Norm(final)=7.439 | 4158.6 samples/s | 65.0 steps/s
[Step=15300 Epoch=58.6] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.100 | L2-Norm(final)=7.440 | 4251.4 samples/s | 66.4 steps/s
[Step=15350 Epoch=58.8] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.087 | L2-Norm(final)=7.441 | 4227.2 samples/s | 66.0 steps/s
[Step=15400 Epoch=59.0] | Loss=0.00002 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.074 | L2-Norm(final)=7.441 | 4315.9 samples/s | 67.4 steps/s
[Step=15450 Epoch=59.2] | Loss=0.00002 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.061 | L2-Norm(final)=7.442 | 5232.6 samples/s | 81.8 steps/s
[Step=15500 Epoch=59.4] | Loss=0.00002 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.048 | L2-Norm(final)=7.443 | 1840.5 samples/s | 28.8 steps/s
[Step=15550 Epoch=59.6] | Loss=0.00002 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.035 | L2-Norm(final)=7.444 | 4187.3 samples/s | 65.4 steps/s
[Step=15600 Epoch=59.8] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.022 | L2-Norm(final)=7.445 | 4362.1 samples/s | 68.2 steps/s
[Step=15650 Epoch=60.0] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.009 | L2-Norm(final)=7.446 | 4170.0 samples/s | 65.2 steps/s
[Step=15700 Epoch=60.2] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.996 | L2-Norm(final)=7.447 | 4688.8 samples/s | 73.3 steps/s
[Step=15750 Epoch=60.3] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.983 | L2-Norm(final)=7.448 | 1915.7 samples/s | 29.9 steps/s
[Step=15800 Epoch=60.5] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.970 | L2-Norm(final)=7.449 | 4282.9 samples/s | 66.9 steps/s
[Step=15850 Epoch=60.7] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.957 | L2-Norm(final)=7.450 | 4323.5 samples/s | 67.6 steps/s
[Step=15900 Epoch=60.9] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.944 | L2-Norm(final)=7.451 | 4227.8 samples/s | 66.1 steps/s
[Step=15950 Epoch=61.1] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.931 | L2-Norm(final)=7.452 | 4285.4 samples/s | 67.0 steps/s
[Step=16000 Epoch=61.3] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.918 | L2-Norm(final)=7.453 | 1945.8 samples/s | 30.4 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step16000.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00050, len=1
[Step=15201 Epoch=58.5] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.159 | L2-Norm(final)=3.664 | 3988.9 samples/s | 62.3 steps/s
[Step=15250 Epoch=58.7] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.143 | L2-Norm(final)=3.668 | 3980.1 samples/s | 62.2 steps/s
[Step=15300 Epoch=58.9] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.127 | L2-Norm(final)=3.675 | 4241.3 samples/s | 66.3 steps/s
[Step=15350 Epoch=59.1] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.112 | L2-Norm(final)=3.683 | 4371.1 samples/s | 68.3 steps/s
[Step=15400 Epoch=59.3] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.096 | L2-Norm(final)=3.691 | 4221.1 samples/s | 66.0 steps/s
[Step=15450 Epoch=59.5] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.081 | L2-Norm(final)=3.699 | 5257.3 samples/s | 82.1 steps/s
[Step=15500 Epoch=59.7] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.066 | L2-Norm(final)=3.708 | 1779.5 samples/s | 27.8 steps/s
[Step=15550 Epoch=59.9] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.050 | L2-Norm(final)=3.717 | 4156.8 samples/s | 65.0 steps/s
[Step=15600 Epoch=60.1] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.035 | L2-Norm(final)=3.726 | 4231.8 samples/s | 66.1 steps/s
[Step=15650 Epoch=60.2] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.019 | L2-Norm(final)=3.735 | 4278.6 samples/s | 66.9 steps/s
[Step=15700 Epoch=60.4] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.003 | L2-Norm(final)=3.744 | 4770.6 samples/s | 74.5 steps/s
[Step=15750 Epoch=60.6] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.988 | L2-Norm(final)=3.753 | 1863.6 samples/s | 29.1 steps/s
[Step=15800 Epoch=60.8] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.973 | L2-Norm(final)=3.762 | 4306.5 samples/s | 67.3 steps/s
[Step=15850 Epoch=61.0] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.958 | L2-Norm(final)=3.771 | 4252.5 samples/s | 66.4 steps/s
[Step=15900 Epoch=61.2] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.942 | L2-Norm(final)=3.779 | 4492.4 samples/s | 70.2 steps/s
[Step=15950 Epoch=61.4] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.926 | L2-Norm(final)=3.788 | 4402.8 samples/s | 68.8 steps/s
[Step=16000 Epoch=61.6] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.911 | L2-Norm(final)=3.797 | 1994.6 samples/s | 31.2 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step16000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.13560 | acc=0.9573 | tpr=0.9671 | fpr=0.0642 | 4215.0 samples/s | 16.5 steps/s
Avg test loss: 0.14156, Avg test acc: 0.95549, Avg tpr: 0.96520, Avg fpr: 0.06589, total FA: 514

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.12840 | acc=0.9560 | tpr=0.9589 | fpr=0.0503 | 4234.8 samples/s | 16.5 steps/s
Avg test loss: 0.13352, Avg test acc: 0.95532, Avg tpr: 0.95920, Avg fpr: 0.05320, total FA: 415

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.22343 | acc=0.3133 | tpr=0.0079 | fpr=0.0235 | 4138.9 samples/s | 16.2 steps/s
Avg test loss: 4.23125, Avg test acc: 0.31120, Avg tpr: 0.00775, Avg fpr: 0.02141, total FA: 167

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.99037 | acc=0.3149 | tpr=0.0017 | fpr=0.0050 | 4115.1 samples/s | 16.1 steps/s
Avg test loss: 6.02221, Avg test acc: 0.31236, Avg tpr: 0.00169, Avg fpr: 0.00436, total FA: 34

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.99020 | acc=0.1527 | tpr=0.7566 | fpr=0.8581 | 4149.9 samples/s | 16.2 steps/s
[Step= 100] | Loss=5.96262 | acc=0.1539 | tpr=0.7377 | fpr=0.8570 | 8173.3 samples/s | 31.9 steps/s
[Step= 150] | Loss=6.01049 | acc=0.1525 | tpr=0.7406 | fpr=0.8583 | 8078.4 samples/s | 31.6 steps/s
[Step= 200] | Loss=6.00444 | acc=0.1526 | tpr=0.7268 | fpr=0.8578 | 7783.1 samples/s | 30.4 steps/s
[Step= 250] | Loss=6.01829 | acc=0.1528 | tpr=0.7266 | fpr=0.8576 | 7701.4 samples/s | 30.1 steps/s
[Step= 300] | Loss=6.02428 | acc=0.1525 | tpr=0.7251 | fpr=0.8580 | 7697.4 samples/s | 30.1 steps/s
[Step= 350] | Loss=6.02142 | acc=0.1525 | tpr=0.7239 | fpr=0.8578 | 7661.9 samples/s | 29.9 steps/s
[Step= 400] | Loss=6.02097 | acc=0.1531 | tpr=0.7270 | fpr=0.8574 | 7674.3 samples/s | 30.0 steps/s
[Step= 450] | Loss=6.02207 | acc=0.1529 | tpr=0.7298 | fpr=0.8576 | 7765.2 samples/s | 30.3 steps/s
[Step= 500] | Loss=6.02800 | acc=0.1525 | tpr=0.7264 | fpr=0.8578 | 7365.3 samples/s | 28.8 steps/s
[Step= 550] | Loss=6.02991 | acc=0.1525 | tpr=0.7298 | fpr=0.8580 | 13532.9 samples/s | 52.9 steps/s
Avg test loss: 6.03238, Avg test acc: 0.15237, Avg tpr: 0.73019, Avg fpr: 0.85813, total FA: 119150

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.24439 | acc=0.1608 | tpr=0.7080 | fpr=0.8491 | 4045.1 samples/s | 15.8 steps/s
[Step= 100] | Loss=7.18276 | acc=0.1596 | tpr=0.6802 | fpr=0.8501 | 7485.3 samples/s | 29.2 steps/s
[Step= 150] | Loss=7.19230 | acc=0.1603 | tpr=0.6801 | fpr=0.8492 | 7479.4 samples/s | 29.2 steps/s
[Step= 200] | Loss=7.17082 | acc=0.1603 | tpr=0.6667 | fpr=0.8489 | 7472.8 samples/s | 29.2 steps/s
[Step= 250] | Loss=7.17373 | acc=0.1605 | tpr=0.6655 | fpr=0.8487 | 7470.9 samples/s | 29.2 steps/s
[Step= 300] | Loss=7.17625 | acc=0.1601 | tpr=0.6560 | fpr=0.8489 | 7550.3 samples/s | 29.5 steps/s
[Step= 350] | Loss=7.16960 | acc=0.1603 | tpr=0.6594 | fpr=0.8487 | 7711.5 samples/s | 30.1 steps/s
[Step= 400] | Loss=7.16465 | acc=0.1608 | tpr=0.6674 | fpr=0.8484 | 7235.9 samples/s | 28.3 steps/s
[Step= 450] | Loss=7.17225 | acc=0.1606 | tpr=0.6665 | fpr=0.8486 | 7537.9 samples/s | 29.4 steps/s
[Step= 500] | Loss=7.18227 | acc=0.1602 | tpr=0.6678 | fpr=0.8489 | 7350.1 samples/s | 28.7 steps/s
[Step= 550] | Loss=7.18320 | acc=0.1600 | tpr=0.6614 | fpr=0.8491 | 13678.0 samples/s | 53.4 steps/s
Avg test loss: 7.18502, Avg test acc: 0.15985, Avg tpr: 0.66165, Avg fpr: 0.84927, total FA: 117919

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.07348 | acc=0.9834 | tpr=0.9602 | fpr=0.0161 | 4113.2 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.07619 | acc=0.9828 | tpr=0.9638 | fpr=0.0168 | 7371.9 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.07990 | acc=0.9822 | tpr=0.9597 | fpr=0.0174 | 7753.8 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.07998 | acc=0.9823 | tpr=0.9650 | fpr=0.0174 | 6997.7 samples/s | 27.3 steps/s
[Step= 250] | Loss=0.07968 | acc=0.9825 | tpr=0.9624 | fpr=0.0172 | 7196.4 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.07987 | acc=0.9824 | tpr=0.9622 | fpr=0.0172 | 7256.7 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.07995 | acc=0.9824 | tpr=0.9612 | fpr=0.0173 | 7627.7 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.08070 | acc=0.9820 | tpr=0.9584 | fpr=0.0176 | 7422.0 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.08198 | acc=0.9817 | tpr=0.9557 | fpr=0.0178 | 6997.3 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.08163 | acc=0.9819 | tpr=0.9577 | fpr=0.0177 | 7528.5 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.08123 | acc=0.9820 | tpr=0.9554 | fpr=0.0175 | 13574.8 samples/s | 53.0 steps/s
Avg test loss: 0.08115, Avg test acc: 0.98200, Avg tpr: 0.95563, Avg fpr: 0.01752, total FA: 2432

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13123 | acc=0.9813 | tpr=0.9469 | fpr=0.0181 | 4129.1 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.13731 | acc=0.9808 | tpr=0.9659 | fpr=0.0189 | 7813.1 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.14302 | acc=0.9800 | tpr=0.9654 | fpr=0.0197 | 7804.9 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.14386 | acc=0.9801 | tpr=0.9683 | fpr=0.0196 | 7783.2 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.14259 | acc=0.9802 | tpr=0.9703 | fpr=0.0196 | 7743.7 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.14555 | acc=0.9800 | tpr=0.9680 | fpr=0.0198 | 8039.6 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.14621 | acc=0.9799 | tpr=0.9674 | fpr=0.0199 | 7622.4 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.14742 | acc=0.9796 | tpr=0.9655 | fpr=0.0201 | 8061.8 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.15057 | acc=0.9793 | tpr=0.9635 | fpr=0.0205 | 7851.3 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.14952 | acc=0.9793 | tpr=0.9648 | fpr=0.0204 | 7673.0 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.14868 | acc=0.9794 | tpr=0.9646 | fpr=0.0203 | 14386.8 samples/s | 56.2 steps/s
Avg test loss: 0.14844, Avg test acc: 0.97943, Avg tpr: 0.96434, Avg fpr: 0.02030, total FA: 2818

server round 20/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00025, len=1
[Step=16001 Epoch=31.2] | Loss=0.01167 | Reg=0.00387 | acc=0.9844 | L2-Norm=19.667 | L2-Norm(final)=2.366 | 3881.6 samples/s | 60.6 steps/s
[Step=16050 Epoch=31.3] | Loss=0.00480 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.665 | L2-Norm(final)=2.367 | 4321.2 samples/s | 67.5 steps/s
[Step=16100 Epoch=31.4] | Loss=0.00550 | Reg=0.00387 | acc=1.0000 | L2-Norm=19.663 | L2-Norm(final)=2.369 | 4521.0 samples/s | 70.6 steps/s
[Step=16150 Epoch=31.5] | Loss=0.00517 | Reg=0.00387 | acc=0.9844 | L2-Norm=19.661 | L2-Norm(final)=2.371 | 4641.6 samples/s | 72.5 steps/s
[Step=16200 Epoch=31.6] | Loss=0.00540 | Reg=0.00386 | acc=0.9844 | L2-Norm=19.658 | L2-Norm(final)=2.372 | 4651.5 samples/s | 72.7 steps/s
[Step=16250 Epoch=31.7] | Loss=0.00550 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.655 | L2-Norm(final)=2.373 | 4666.7 samples/s | 72.9 steps/s
[Step=16300 Epoch=31.8] | Loss=0.00563 | Reg=0.00386 | acc=0.9844 | L2-Norm=19.652 | L2-Norm(final)=2.374 | 4566.8 samples/s | 71.4 steps/s
[Step=16350 Epoch=31.9] | Loss=0.00568 | Reg=0.00386 | acc=0.9844 | L2-Norm=19.649 | L2-Norm(final)=2.374 | 4483.5 samples/s | 70.1 steps/s
[Step=16400 Epoch=32.0] | Loss=0.00557 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.645 | L2-Norm(final)=2.375 | 4645.9 samples/s | 72.6 steps/s
[Step=16450 Epoch=32.1] | Loss=0.00541 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.642 | L2-Norm(final)=2.376 | 4640.2 samples/s | 72.5 steps/s
[Step=16500 Epoch=32.2] | Loss=0.00538 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.639 | L2-Norm(final)=2.377 | 5494.5 samples/s | 85.9 steps/s
[Step=16550 Epoch=32.3] | Loss=0.00526 | Reg=0.00386 | acc=1.0000 | L2-Norm=19.636 | L2-Norm(final)=2.378 | 1814.0 samples/s | 28.3 steps/s
[Step=16600 Epoch=32.4] | Loss=0.00510 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.633 | L2-Norm(final)=2.379 | 4550.4 samples/s | 71.1 steps/s
[Step=16650 Epoch=32.5] | Loss=0.00495 | Reg=0.00385 | acc=0.9844 | L2-Norm=19.629 | L2-Norm(final)=2.380 | 4424.7 samples/s | 69.1 steps/s
[Step=16700 Epoch=32.6] | Loss=0.00490 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.626 | L2-Norm(final)=2.381 | 4495.7 samples/s | 70.2 steps/s
[Step=16750 Epoch=32.7] | Loss=0.00477 | Reg=0.00385 | acc=1.0000 | L2-Norm=19.623 | L2-Norm(final)=2.383 | 4551.1 samples/s | 71.1 steps/s
[Step=16800 Epoch=32.8] | Loss=0.00473 | Reg=0.00385 | acc=0.9844 | L2-Norm=19.619 | L2-Norm(final)=2.384 | 4513.4 samples/s | 70.5 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step16800.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00025, len=1
[Step=16001 Epoch=31.3] | Loss=0.00153 | Reg=0.00375 | acc=1.0000 | L2-Norm=19.361 | L2-Norm(final)=2.273 | 3926.5 samples/s | 61.4 steps/s
[Step=16050 Epoch=31.4] | Loss=0.00443 | Reg=0.00375 | acc=1.0000 | L2-Norm=19.357 | L2-Norm(final)=2.272 | 4135.5 samples/s | 64.6 steps/s
[Step=16100 Epoch=31.5] | Loss=0.00579 | Reg=0.00375 | acc=0.9844 | L2-Norm=19.356 | L2-Norm(final)=2.273 | 4488.4 samples/s | 70.1 steps/s
[Step=16150 Epoch=31.6] | Loss=0.00582 | Reg=0.00375 | acc=0.9844 | L2-Norm=19.353 | L2-Norm(final)=2.274 | 4494.0 samples/s | 70.2 steps/s
[Step=16200 Epoch=31.7] | Loss=0.00552 | Reg=0.00374 | acc=1.0000 | L2-Norm=19.351 | L2-Norm(final)=2.275 | 4505.3 samples/s | 70.4 steps/s
[Step=16250 Epoch=31.8] | Loss=0.00536 | Reg=0.00374 | acc=1.0000 | L2-Norm=19.349 | L2-Norm(final)=2.276 | 4532.3 samples/s | 70.8 steps/s
[Step=16300 Epoch=31.9] | Loss=0.00524 | Reg=0.00374 | acc=1.0000 | L2-Norm=19.346 | L2-Norm(final)=2.278 | 4635.2 samples/s | 72.4 steps/s
[Step=16350 Epoch=32.0] | Loss=0.00497 | Reg=0.00374 | acc=1.0000 | L2-Norm=19.343 | L2-Norm(final)=2.279 | 4626.5 samples/s | 72.3 steps/s
[Step=16400 Epoch=32.1] | Loss=0.00505 | Reg=0.00374 | acc=0.9844 | L2-Norm=19.340 | L2-Norm(final)=2.280 | 4579.7 samples/s | 71.6 steps/s
[Step=16450 Epoch=32.2] | Loss=0.00523 | Reg=0.00374 | acc=0.9844 | L2-Norm=19.336 | L2-Norm(final)=2.281 | 4468.4 samples/s | 69.8 steps/s
[Step=16500 Epoch=32.3] | Loss=0.00514 | Reg=0.00374 | acc=1.0000 | L2-Norm=19.333 | L2-Norm(final)=2.281 | 5543.2 samples/s | 86.6 steps/s
[Step=16550 Epoch=32.4] | Loss=0.00504 | Reg=0.00374 | acc=1.0000 | L2-Norm=19.329 | L2-Norm(final)=2.282 | 1918.5 samples/s | 30.0 steps/s
[Step=16600 Epoch=32.5] | Loss=0.00491 | Reg=0.00373 | acc=1.0000 | L2-Norm=19.326 | L2-Norm(final)=2.282 | 4466.5 samples/s | 69.8 steps/s
[Step=16650 Epoch=32.6] | Loss=0.00482 | Reg=0.00373 | acc=1.0000 | L2-Norm=19.322 | L2-Norm(final)=2.283 | 4543.7 samples/s | 71.0 steps/s
[Step=16700 Epoch=32.6] | Loss=0.00484 | Reg=0.00373 | acc=0.9844 | L2-Norm=19.319 | L2-Norm(final)=2.283 | 4513.1 samples/s | 70.5 steps/s
[Step=16750 Epoch=32.7] | Loss=0.00476 | Reg=0.00373 | acc=1.0000 | L2-Norm=19.315 | L2-Norm(final)=2.284 | 4456.0 samples/s | 69.6 steps/s
[Step=16800 Epoch=32.8] | Loss=0.00481 | Reg=0.00373 | acc=1.0000 | L2-Norm=19.312 | L2-Norm(final)=2.285 | 4522.2 samples/s | 70.7 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step16800.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00025, len=1
[Step=16001 Epoch=61.3] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.708 | L2-Norm(final)=7.471 | 4083.7 samples/s | 63.8 steps/s
[Step=16050 Epoch=61.5] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.701 | L2-Norm(final)=7.472 | 3910.2 samples/s | 61.1 steps/s
[Step=16100 Epoch=61.7] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.695 | L2-Norm(final)=7.473 | 4093.8 samples/s | 64.0 steps/s
[Step=16150 Epoch=61.9] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.688 | L2-Norm(final)=7.474 | 4003.4 samples/s | 62.6 steps/s
[Step=16200 Epoch=62.1] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.681 | L2-Norm(final)=7.475 | 4023.0 samples/s | 62.9 steps/s
[Step=16250 Epoch=62.3] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.674 | L2-Norm(final)=7.475 | 5420.2 samples/s | 84.7 steps/s
[Step=16300 Epoch=62.5] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.668 | L2-Norm(final)=7.476 | 1843.1 samples/s | 28.8 steps/s
[Step=16350 Epoch=62.6] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.661 | L2-Norm(final)=7.477 | 4221.3 samples/s | 66.0 steps/s
[Step=16400 Epoch=62.8] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.654 | L2-Norm(final)=7.478 | 4223.5 samples/s | 66.0 steps/s
[Step=16450 Epoch=63.0] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.647 | L2-Norm(final)=7.479 | 4238.0 samples/s | 66.2 steps/s
[Step=16500 Epoch=63.2] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.639 | L2-Norm(final)=7.480 | 4626.8 samples/s | 72.3 steps/s
[Step=16550 Epoch=63.4] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.632 | L2-Norm(final)=7.481 | 1899.3 samples/s | 29.7 steps/s
[Step=16600 Epoch=63.6] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.625 | L2-Norm(final)=7.481 | 4277.1 samples/s | 66.8 steps/s
[Step=16650 Epoch=63.8] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.618 | L2-Norm(final)=7.482 | 4149.5 samples/s | 64.8 steps/s
[Step=16700 Epoch=64.0] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.610 | L2-Norm(final)=7.483 | 4173.0 samples/s | 65.2 steps/s
[Step=16750 Epoch=64.2] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.603 | L2-Norm(final)=7.484 | 4235.4 samples/s | 66.2 steps/s
[Step=16800 Epoch=64.4] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.596 | L2-Norm(final)=7.485 | 1984.5 samples/s | 31.0 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step16800.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00025, len=1
[Step=16001 Epoch=61.6] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.658 | L2-Norm(final)=3.933 | 3775.1 samples/s | 59.0 steps/s
[Step=16050 Epoch=61.8] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.650 | L2-Norm(final)=3.936 | 4181.7 samples/s | 65.3 steps/s
[Step=16100 Epoch=62.0] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.642 | L2-Norm(final)=3.941 | 3894.7 samples/s | 60.9 steps/s
[Step=16150 Epoch=62.2] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.633 | L2-Norm(final)=3.945 | 4123.8 samples/s | 64.4 steps/s
[Step=16200 Epoch=62.4] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.625 | L2-Norm(final)=3.950 | 4029.3 samples/s | 63.0 steps/s
[Step=16250 Epoch=62.6] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.616 | L2-Norm(final)=3.955 | 5288.9 samples/s | 82.6 steps/s
[Step=16300 Epoch=62.7] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.608 | L2-Norm(final)=3.960 | 1815.0 samples/s | 28.4 steps/s
[Step=16350 Epoch=62.9] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.600 | L2-Norm(final)=3.965 | 4196.3 samples/s | 65.6 steps/s
[Step=16400 Epoch=63.1] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.591 | L2-Norm(final)=3.970 | 4274.6 samples/s | 66.8 steps/s
[Step=16450 Epoch=63.3] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.582 | L2-Norm(final)=3.975 | 4178.5 samples/s | 65.3 steps/s
[Step=16500 Epoch=63.5] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.573 | L2-Norm(final)=3.979 | 4816.2 samples/s | 75.3 steps/s
[Step=16550 Epoch=63.7] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.564 | L2-Norm(final)=3.985 | 1864.4 samples/s | 29.1 steps/s
[Step=16600 Epoch=63.9] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.555 | L2-Norm(final)=3.990 | 4269.2 samples/s | 66.7 steps/s
[Step=16650 Epoch=64.1] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.546 | L2-Norm(final)=3.995 | 4180.5 samples/s | 65.3 steps/s
[Step=16700 Epoch=64.3] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.537 | L2-Norm(final)=4.001 | 4282.6 samples/s | 66.9 steps/s
[Step=16750 Epoch=64.5] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.528 | L2-Norm(final)=4.006 | 4420.6 samples/s | 69.1 steps/s
[Step=16800 Epoch=64.7] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.519 | L2-Norm(final)=4.012 | 2011.2 samples/s | 31.4 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step16800.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.15845 | acc=0.9591 | tpr=0.9674 | fpr=0.0587 | 4224.2 samples/s | 16.5 steps/s
Avg test loss: 0.16694, Avg test acc: 0.95717, Avg tpr: 0.96619, Avg fpr: 0.06268, total FA: 489

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.15071 | acc=0.9588 | tpr=0.9691 | fpr=0.0634 | 4269.8 samples/s | 16.7 steps/s
Avg test loss: 0.15971, Avg test acc: 0.95821, Avg tpr: 0.96905, Avg fpr: 0.06563, total FA: 512

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.35558 | acc=0.3136 | tpr=0.0079 | fpr=0.0225 | 4242.1 samples/s | 16.6 steps/s
Avg test loss: 4.36375, Avg test acc: 0.31124, Avg tpr: 0.00758, Avg fpr: 0.02089, total FA: 163

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.90016 | acc=0.3148 | tpr=0.0017 | fpr=0.0052 | 4271.6 samples/s | 16.7 steps/s
Avg test loss: 5.93173, Avg test acc: 0.31236, Avg tpr: 0.00175, Avg fpr: 0.00449, total FA: 35

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.80836 | acc=0.1673 | tpr=0.7699 | fpr=0.8435 | 4192.7 samples/s | 16.4 steps/s
[Step= 100] | Loss=6.77208 | acc=0.1688 | tpr=0.7441 | fpr=0.8420 | 7887.9 samples/s | 30.8 steps/s
[Step= 150] | Loss=6.82220 | acc=0.1676 | tpr=0.7450 | fpr=0.8430 | 7638.3 samples/s | 29.8 steps/s
[Step= 200] | Loss=6.81401 | acc=0.1673 | tpr=0.7301 | fpr=0.8429 | 7812.7 samples/s | 30.5 steps/s
[Step= 250] | Loss=6.82980 | acc=0.1672 | tpr=0.7275 | fpr=0.8430 | 8032.1 samples/s | 31.4 steps/s
[Step= 300] | Loss=6.83698 | acc=0.1669 | tpr=0.7258 | fpr=0.8433 | 7570.7 samples/s | 29.6 steps/s
[Step= 350] | Loss=6.83334 | acc=0.1673 | tpr=0.7257 | fpr=0.8428 | 8064.9 samples/s | 31.5 steps/s
[Step= 400] | Loss=6.83400 | acc=0.1678 | tpr=0.7281 | fpr=0.8424 | 7386.9 samples/s | 28.9 steps/s
[Step= 450] | Loss=6.83565 | acc=0.1675 | tpr=0.7283 | fpr=0.8427 | 7541.5 samples/s | 29.5 steps/s
[Step= 500] | Loss=6.84239 | acc=0.1672 | tpr=0.7264 | fpr=0.8429 | 7535.9 samples/s | 29.4 steps/s
[Step= 550] | Loss=6.84395 | acc=0.1672 | tpr=0.7290 | fpr=0.8431 | 13401.1 samples/s | 52.3 steps/s
Avg test loss: 6.84683, Avg test acc: 0.16700, Avg tpr: 0.72900, Avg fpr: 0.84322, total FA: 117079

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=8.55661 | acc=0.1505 | tpr=0.7522 | fpr=0.8603 | 4059.5 samples/s | 15.9 steps/s
[Step= 100] | Loss=8.49513 | acc=0.1494 | tpr=0.7292 | fpr=0.8614 | 7924.2 samples/s | 31.0 steps/s
[Step= 150] | Loss=8.50783 | acc=0.1500 | tpr=0.7147 | fpr=0.8604 | 7635.1 samples/s | 29.8 steps/s
[Step= 200] | Loss=8.48459 | acc=0.1505 | tpr=0.7060 | fpr=0.8596 | 7694.9 samples/s | 30.1 steps/s
[Step= 250] | Loss=8.48793 | acc=0.1504 | tpr=0.6996 | fpr=0.8596 | 7599.7 samples/s | 29.7 steps/s
[Step= 300] | Loss=8.49004 | acc=0.1501 | tpr=0.6996 | fpr=0.8599 | 7464.7 samples/s | 29.2 steps/s
[Step= 350] | Loss=8.48390 | acc=0.1501 | tpr=0.7051 | fpr=0.8599 | 7474.2 samples/s | 29.2 steps/s
[Step= 400] | Loss=8.47960 | acc=0.1502 | tpr=0.7117 | fpr=0.8600 | 7825.4 samples/s | 30.6 steps/s
[Step= 450] | Loss=8.48925 | acc=0.1500 | tpr=0.7108 | fpr=0.8601 | 7682.8 samples/s | 30.0 steps/s
[Step= 500] | Loss=8.50096 | acc=0.1494 | tpr=0.7137 | fpr=0.8608 | 7124.8 samples/s | 27.8 steps/s
[Step= 550] | Loss=8.50183 | acc=0.1491 | tpr=0.7075 | fpr=0.8610 | 13999.3 samples/s | 54.7 steps/s
Avg test loss: 8.50385, Avg test acc: 0.14905, Avg tpr: 0.70761, Avg fpr: 0.86111, total FA: 119563

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.07521 | acc=0.9835 | tpr=0.9602 | fpr=0.0161 | 3820.7 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.07792 | acc=0.9830 | tpr=0.9638 | fpr=0.0167 | 7638.5 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.08174 | acc=0.9823 | tpr=0.9597 | fpr=0.0173 | 7069.9 samples/s | 27.6 steps/s
[Step= 200] | Loss=0.08184 | acc=0.9824 | tpr=0.9639 | fpr=0.0173 | 7797.8 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.08152 | acc=0.9826 | tpr=0.9616 | fpr=0.0171 | 7351.3 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.08174 | acc=0.9825 | tpr=0.9615 | fpr=0.0171 | 7484.2 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.08183 | acc=0.9824 | tpr=0.9606 | fpr=0.0172 | 7767.7 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.08260 | acc=0.9821 | tpr=0.9573 | fpr=0.0175 | 7227.0 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.08393 | acc=0.9818 | tpr=0.9542 | fpr=0.0177 | 7587.7 samples/s | 29.6 steps/s
[Step= 500] | Loss=0.08358 | acc=0.9819 | tpr=0.9559 | fpr=0.0176 | 7546.3 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.08318 | acc=0.9820 | tpr=0.9534 | fpr=0.0175 | 13299.0 samples/s | 51.9 steps/s
Avg test loss: 0.08309, Avg test acc: 0.98203, Avg tpr: 0.95365, Avg fpr: 0.01746, total FA: 2424

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13161 | acc=0.9812 | tpr=0.9425 | fpr=0.0181 | 3998.7 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.13789 | acc=0.9806 | tpr=0.9638 | fpr=0.0191 | 7860.4 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.14352 | acc=0.9798 | tpr=0.9640 | fpr=0.0199 | 8048.4 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.14446 | acc=0.9800 | tpr=0.9672 | fpr=0.0197 | 7510.1 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.14327 | acc=0.9802 | tpr=0.9694 | fpr=0.0196 | 8097.0 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.14635 | acc=0.9799 | tpr=0.9673 | fpr=0.0198 | 7665.7 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.14692 | acc=0.9798 | tpr=0.9662 | fpr=0.0200 | 7738.0 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.14812 | acc=0.9796 | tpr=0.9650 | fpr=0.0201 | 7997.7 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.15122 | acc=0.9793 | tpr=0.9630 | fpr=0.0204 | 7452.2 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.15019 | acc=0.9793 | tpr=0.9639 | fpr=0.0205 | 7928.0 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.14937 | acc=0.9794 | tpr=0.9642 | fpr=0.0203 | 14335.7 samples/s | 56.0 steps/s
Avg test loss: 0.14913, Avg test acc: 0.97944, Avg tpr: 0.96395, Avg fpr: 0.02028, total FA: 2816

server round 21/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00025, len=1
[Step=16801 Epoch=32.8] | Loss=0.00010 | Reg=0.00383 | acc=1.0000 | L2-Norm=19.562 | L2-Norm(final)=2.401 | 3713.9 samples/s | 58.0 steps/s
[Step=16850 Epoch=32.9] | Loss=0.00295 | Reg=0.00383 | acc=1.0000 | L2-Norm=19.558 | L2-Norm(final)=2.402 | 4613.2 samples/s | 72.1 steps/s
[Step=16900 Epoch=33.0] | Loss=0.00361 | Reg=0.00382 | acc=1.0000 | L2-Norm=19.555 | L2-Norm(final)=2.403 | 4704.5 samples/s | 73.5 steps/s
[Step=16950 Epoch=33.1] | Loss=0.00374 | Reg=0.00382 | acc=1.0000 | L2-Norm=19.552 | L2-Norm(final)=2.404 | 4641.2 samples/s | 72.5 steps/s
[Step=17000 Epoch=33.2] | Loss=0.00404 | Reg=0.00382 | acc=1.0000 | L2-Norm=19.548 | L2-Norm(final)=2.405 | 4549.6 samples/s | 71.1 steps/s
[Step=17050 Epoch=33.3] | Loss=0.00420 | Reg=0.00382 | acc=1.0000 | L2-Norm=19.545 | L2-Norm(final)=2.405 | 4574.4 samples/s | 71.5 steps/s
[Step=17100 Epoch=33.4] | Loss=0.00435 | Reg=0.00382 | acc=0.9688 | L2-Norm=19.541 | L2-Norm(final)=2.405 | 4616.3 samples/s | 72.1 steps/s
[Step=17150 Epoch=33.4] | Loss=0.00429 | Reg=0.00382 | acc=1.0000 | L2-Norm=19.537 | L2-Norm(final)=2.405 | 4671.0 samples/s | 73.0 steps/s
[Step=17200 Epoch=33.5] | Loss=0.00444 | Reg=0.00382 | acc=1.0000 | L2-Norm=19.533 | L2-Norm(final)=2.406 | 4655.1 samples/s | 72.7 steps/s
[Step=17250 Epoch=33.6] | Loss=0.00445 | Reg=0.00381 | acc=1.0000 | L2-Norm=19.528 | L2-Norm(final)=2.406 | 4632.3 samples/s | 72.4 steps/s
[Step=17300 Epoch=33.7] | Loss=0.00451 | Reg=0.00381 | acc=1.0000 | L2-Norm=19.524 | L2-Norm(final)=2.406 | 5539.6 samples/s | 86.6 steps/s
[Step=17350 Epoch=33.8] | Loss=0.00451 | Reg=0.00381 | acc=1.0000 | L2-Norm=19.520 | L2-Norm(final)=2.407 | 1871.9 samples/s | 29.2 steps/s
[Step=17400 Epoch=33.9] | Loss=0.00445 | Reg=0.00381 | acc=1.0000 | L2-Norm=19.516 | L2-Norm(final)=2.408 | 4657.8 samples/s | 72.8 steps/s
[Step=17450 Epoch=34.0] | Loss=0.00440 | Reg=0.00381 | acc=1.0000 | L2-Norm=19.512 | L2-Norm(final)=2.408 | 4607.7 samples/s | 72.0 steps/s
[Step=17500 Epoch=34.1] | Loss=0.00425 | Reg=0.00381 | acc=1.0000 | L2-Norm=19.508 | L2-Norm(final)=2.409 | 4518.2 samples/s | 70.6 steps/s
[Step=17550 Epoch=34.2] | Loss=0.00429 | Reg=0.00380 | acc=1.0000 | L2-Norm=19.504 | L2-Norm(final)=2.410 | 4596.6 samples/s | 71.8 steps/s
[Step=17600 Epoch=34.3] | Loss=0.00430 | Reg=0.00380 | acc=1.0000 | L2-Norm=19.500 | L2-Norm(final)=2.411 | 4480.0 samples/s | 70.0 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step17600.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00025, len=1
[Step=16801 Epoch=32.8] | Loss=0.02904 | Reg=0.00371 | acc=0.9844 | L2-Norm=19.253 | L2-Norm(final)=2.293 | 4183.1 samples/s | 65.4 steps/s
[Step=16850 Epoch=32.9] | Loss=0.00465 | Reg=0.00371 | acc=1.0000 | L2-Norm=19.250 | L2-Norm(final)=2.293 | 3946.7 samples/s | 61.7 steps/s
[Step=16900 Epoch=33.0] | Loss=0.00381 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.247 | L2-Norm(final)=2.295 | 4432.5 samples/s | 69.3 steps/s
[Step=16950 Epoch=33.1] | Loss=0.00345 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.244 | L2-Norm(final)=2.296 | 4486.4 samples/s | 70.1 steps/s
[Step=17000 Epoch=33.2] | Loss=0.00337 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.241 | L2-Norm(final)=2.298 | 4545.9 samples/s | 71.0 steps/s
[Step=17050 Epoch=33.3] | Loss=0.00364 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.237 | L2-Norm(final)=2.299 | 4567.8 samples/s | 71.4 steps/s
[Step=17100 Epoch=33.4] | Loss=0.00375 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.233 | L2-Norm(final)=2.299 | 4496.3 samples/s | 70.3 steps/s
[Step=17150 Epoch=33.5] | Loss=0.00413 | Reg=0.00370 | acc=0.9844 | L2-Norm=19.229 | L2-Norm(final)=2.300 | 4504.5 samples/s | 70.4 steps/s
[Step=17200 Epoch=33.6] | Loss=0.00422 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.225 | L2-Norm(final)=2.299 | 4464.7 samples/s | 69.8 steps/s
[Step=17250 Epoch=33.7] | Loss=0.00442 | Reg=0.00369 | acc=1.0000 | L2-Norm=19.221 | L2-Norm(final)=2.299 | 4445.8 samples/s | 69.5 steps/s
[Step=17300 Epoch=33.8] | Loss=0.00454 | Reg=0.00369 | acc=1.0000 | L2-Norm=19.217 | L2-Norm(final)=2.299 | 5369.9 samples/s | 83.9 steps/s
[Step=17350 Epoch=33.9] | Loss=0.00443 | Reg=0.00369 | acc=1.0000 | L2-Norm=19.213 | L2-Norm(final)=2.300 | 1843.7 samples/s | 28.8 steps/s
[Step=17400 Epoch=34.0] | Loss=0.00445 | Reg=0.00369 | acc=1.0000 | L2-Norm=19.210 | L2-Norm(final)=2.300 | 4398.6 samples/s | 68.7 steps/s
[Step=17450 Epoch=34.1] | Loss=0.00449 | Reg=0.00369 | acc=1.0000 | L2-Norm=19.206 | L2-Norm(final)=2.300 | 4445.6 samples/s | 69.5 steps/s
[Step=17500 Epoch=34.2] | Loss=0.00442 | Reg=0.00369 | acc=0.9844 | L2-Norm=19.202 | L2-Norm(final)=2.301 | 4538.4 samples/s | 70.9 steps/s
[Step=17550 Epoch=34.3] | Loss=0.00438 | Reg=0.00369 | acc=1.0000 | L2-Norm=19.198 | L2-Norm(final)=2.301 | 4543.7 samples/s | 71.0 steps/s
[Step=17600 Epoch=34.4] | Loss=0.00440 | Reg=0.00368 | acc=1.0000 | L2-Norm=19.194 | L2-Norm(final)=2.302 | 4631.7 samples/s | 72.4 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step17600.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00025, len=1
[Step=16801 Epoch=64.4] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.476 | L2-Norm(final)=7.501 | 3868.3 samples/s | 60.4 steps/s
[Step=16850 Epoch=64.6] | Loss=0.00001 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.468 | L2-Norm(final)=7.502 | 4003.6 samples/s | 62.6 steps/s
[Step=16900 Epoch=64.8] | Loss=0.00001 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.460 | L2-Norm(final)=7.503 | 4320.2 samples/s | 67.5 steps/s
[Step=16950 Epoch=64.9] | Loss=0.00001 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.452 | L2-Norm(final)=7.504 | 4309.9 samples/s | 67.3 steps/s
[Step=17000 Epoch=65.1] | Loss=0.00001 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.444 | L2-Norm(final)=7.505 | 4249.3 samples/s | 66.4 steps/s
[Step=17050 Epoch=65.3] | Loss=0.00001 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.436 | L2-Norm(final)=7.506 | 5303.1 samples/s | 82.9 steps/s
[Step=17100 Epoch=65.5] | Loss=0.00001 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.428 | L2-Norm(final)=7.507 | 1826.1 samples/s | 28.5 steps/s
[Step=17150 Epoch=65.7] | Loss=0.00001 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.420 | L2-Norm(final)=7.508 | 4235.5 samples/s | 66.2 steps/s
[Step=17200 Epoch=65.9] | Loss=0.00001 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.411 | L2-Norm(final)=7.509 | 4183.6 samples/s | 65.4 steps/s
[Step=17250 Epoch=66.1] | Loss=0.00001 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.403 | L2-Norm(final)=7.510 | 4218.6 samples/s | 65.9 steps/s
[Step=17300 Epoch=66.3] | Loss=0.00001 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.395 | L2-Norm(final)=7.511 | 4710.6 samples/s | 73.6 steps/s
[Step=17350 Epoch=66.5] | Loss=0.00001 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.386 | L2-Norm(final)=7.512 | 1898.4 samples/s | 29.7 steps/s
[Step=17400 Epoch=66.7] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.378 | L2-Norm(final)=7.514 | 4292.3 samples/s | 67.1 steps/s
[Step=17450 Epoch=66.9] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.369 | L2-Norm(final)=7.515 | 4246.4 samples/s | 66.3 steps/s
[Step=17500 Epoch=67.1] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.360 | L2-Norm(final)=7.516 | 4223.9 samples/s | 66.0 steps/s
[Step=17550 Epoch=67.2] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.352 | L2-Norm(final)=7.517 | 4202.5 samples/s | 65.7 steps/s
[Step=17600 Epoch=67.4] | Loss=0.00001 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.343 | L2-Norm(final)=7.518 | 1999.5 samples/s | 31.2 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step17600.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00025, len=1
[Step=16801 Epoch=64.7] | Loss=0.00001 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.370 | L2-Norm(final)=4.099 | 3733.5 samples/s | 58.3 steps/s
[Step=16850 Epoch=64.9] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.360 | L2-Norm(final)=4.105 | 4034.3 samples/s | 63.0 steps/s
[Step=16900 Epoch=65.1] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.350 | L2-Norm(final)=4.110 | 4239.9 samples/s | 66.2 steps/s
[Step=16950 Epoch=65.2] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.340 | L2-Norm(final)=4.117 | 4202.7 samples/s | 65.7 steps/s
[Step=17000 Epoch=65.4] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.330 | L2-Norm(final)=4.123 | 4195.8 samples/s | 65.6 steps/s
[Step=17050 Epoch=65.6] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.320 | L2-Norm(final)=4.130 | 5430.1 samples/s | 84.8 steps/s
[Step=17100 Epoch=65.8] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.310 | L2-Norm(final)=4.136 | 1814.2 samples/s | 28.3 steps/s
[Step=17150 Epoch=66.0] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.299 | L2-Norm(final)=4.143 | 4264.9 samples/s | 66.6 steps/s
[Step=17200 Epoch=66.2] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.289 | L2-Norm(final)=4.149 | 4260.4 samples/s | 66.6 steps/s
[Step=17250 Epoch=66.4] | Loss=0.00000 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.279 | L2-Norm(final)=4.156 | 4151.7 samples/s | 64.9 steps/s
[Step=17300 Epoch=66.6] | Loss=0.00000 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.269 | L2-Norm(final)=4.163 | 4726.0 samples/s | 73.8 steps/s
[Step=17350 Epoch=66.8] | Loss=0.00000 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.258 | L2-Norm(final)=4.170 | 1851.9 samples/s | 28.9 steps/s
[Step=17400 Epoch=67.0] | Loss=0.00000 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.248 | L2-Norm(final)=4.177 | 4220.0 samples/s | 65.9 steps/s
[Step=17450 Epoch=67.2] | Loss=0.00000 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.237 | L2-Norm(final)=4.184 | 4195.1 samples/s | 65.5 steps/s
[Step=17500 Epoch=67.4] | Loss=0.00000 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.226 | L2-Norm(final)=4.191 | 4210.3 samples/s | 65.8 steps/s
[Step=17550 Epoch=67.6] | Loss=0.00000 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.215 | L2-Norm(final)=4.197 | 4297.5 samples/s | 67.1 steps/s
[Step=17600 Epoch=67.7] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.204 | L2-Norm(final)=4.204 | 1998.4 samples/s | 31.2 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step17600.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.16421 | acc=0.9593 | tpr=0.9728 | fpr=0.0701 | 3992.3 samples/s | 15.6 steps/s
Avg test loss: 0.17233, Avg test acc: 0.95733, Avg tpr: 0.97156, Avg fpr: 0.07396, total FA: 577

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.15053 | acc=0.9582 | tpr=0.9661 | fpr=0.0590 | 4160.9 samples/s | 16.3 steps/s
Avg test loss: 0.15788, Avg test acc: 0.95733, Avg tpr: 0.96590, Avg fpr: 0.06153, total FA: 480

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.46751 | acc=0.3138 | tpr=0.0080 | fpr=0.0221 | 4318.6 samples/s | 16.9 steps/s
Avg test loss: 4.47596, Avg test acc: 0.31132, Avg tpr: 0.00758, Avg fpr: 0.02064, total FA: 161

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.75336 | acc=0.3147 | tpr=0.0018 | fpr=0.0059 | 4203.2 samples/s | 16.4 steps/s
Avg test loss: 5.78425, Avg test acc: 0.31228, Avg tpr: 0.00187, Avg fpr: 0.00500, total FA: 39

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.07861 | acc=0.1568 | tpr=0.7876 | fpr=0.8545 | 4142.2 samples/s | 16.2 steps/s
[Step= 100] | Loss=7.04399 | acc=0.1591 | tpr=0.7783 | fpr=0.8524 | 7940.2 samples/s | 31.0 steps/s
[Step= 150] | Loss=7.09724 | acc=0.1574 | tpr=0.7824 | fpr=0.8541 | 7869.5 samples/s | 30.7 steps/s
[Step= 200] | Loss=7.08799 | acc=0.1573 | tpr=0.7683 | fpr=0.8538 | 7923.9 samples/s | 31.0 steps/s
[Step= 250] | Loss=7.10433 | acc=0.1572 | tpr=0.7651 | fpr=0.8539 | 8111.5 samples/s | 31.7 steps/s
[Step= 300] | Loss=7.11235 | acc=0.1566 | tpr=0.7615 | fpr=0.8544 | 7766.3 samples/s | 30.3 steps/s
[Step= 350] | Loss=7.10868 | acc=0.1567 | tpr=0.7658 | fpr=0.8543 | 8140.3 samples/s | 31.8 steps/s
[Step= 400] | Loss=7.11021 | acc=0.1570 | tpr=0.7664 | fpr=0.8540 | 7584.6 samples/s | 29.6 steps/s
[Step= 450] | Loss=7.11273 | acc=0.1567 | tpr=0.7683 | fpr=0.8544 | 7825.4 samples/s | 30.6 steps/s
[Step= 500] | Loss=7.11965 | acc=0.1562 | tpr=0.7661 | fpr=0.8548 | 7695.5 samples/s | 30.1 steps/s
[Step= 550] | Loss=7.12074 | acc=0.1563 | tpr=0.7668 | fpr=0.8548 | 14098.6 samples/s | 55.1 steps/s
Avg test loss: 7.12373, Avg test acc: 0.15613, Avg tpr: 0.76704, Avg fpr: 0.85497, total FA: 118711

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=8.16662 | acc=0.1559 | tpr=0.7434 | fpr=0.8547 | 4109.4 samples/s | 16.1 steps/s
[Step= 100] | Loss=8.10102 | acc=0.1568 | tpr=0.7292 | fpr=0.8539 | 7553.6 samples/s | 29.5 steps/s
[Step= 150] | Loss=8.11509 | acc=0.1572 | tpr=0.7161 | fpr=0.8531 | 7680.5 samples/s | 30.0 steps/s
[Step= 200] | Loss=8.09410 | acc=0.1581 | tpr=0.7082 | fpr=0.8519 | 7395.8 samples/s | 28.9 steps/s
[Step= 250] | Loss=8.09773 | acc=0.1582 | tpr=0.7022 | fpr=0.8517 | 7603.4 samples/s | 29.7 steps/s
[Step= 300] | Loss=8.09969 | acc=0.1581 | tpr=0.7011 | fpr=0.8518 | 7785.0 samples/s | 30.4 steps/s
[Step= 350] | Loss=8.09459 | acc=0.1580 | tpr=0.7032 | fpr=0.8519 | 7772.1 samples/s | 30.4 steps/s
[Step= 400] | Loss=8.08991 | acc=0.1582 | tpr=0.7062 | fpr=0.8518 | 8448.4 samples/s | 33.0 steps/s
[Step= 450] | Loss=8.09946 | acc=0.1578 | tpr=0.7040 | fpr=0.8521 | 7032.2 samples/s | 27.5 steps/s
[Step= 500] | Loss=8.11095 | acc=0.1570 | tpr=0.7044 | fpr=0.8529 | 7407.6 samples/s | 28.9 steps/s
[Step= 550] | Loss=8.11081 | acc=0.1569 | tpr=0.6980 | fpr=0.8529 | 14232.7 samples/s | 55.6 steps/s
Avg test loss: 8.11259, Avg test acc: 0.15675, Avg tpr: 0.69810, Avg fpr: 0.85309, total FA: 118450

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.07788 | acc=0.9835 | tpr=0.9602 | fpr=0.0161 | 4027.4 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.08060 | acc=0.9829 | tpr=0.9638 | fpr=0.0168 | 7403.9 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.08456 | acc=0.9822 | tpr=0.9597 | fpr=0.0174 | 7482.7 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.08467 | acc=0.9823 | tpr=0.9639 | fpr=0.0174 | 7570.9 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.08432 | acc=0.9825 | tpr=0.9616 | fpr=0.0172 | 7366.4 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.08457 | acc=0.9824 | tpr=0.9615 | fpr=0.0172 | 7551.0 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.08466 | acc=0.9823 | tpr=0.9612 | fpr=0.0173 | 7315.8 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.08548 | acc=0.9820 | tpr=0.9579 | fpr=0.0176 | 7573.4 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.08686 | acc=0.9816 | tpr=0.9547 | fpr=0.0179 | 7294.2 samples/s | 28.5 steps/s
[Step= 500] | Loss=0.08651 | acc=0.9818 | tpr=0.9568 | fpr=0.0178 | 7752.4 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.08609 | acc=0.9819 | tpr=0.9546 | fpr=0.0176 | 13480.2 samples/s | 52.7 steps/s
Avg test loss: 0.08600, Avg test acc: 0.98189, Avg tpr: 0.95483, Avg fpr: 0.01762, total FA: 2446

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13731 | acc=0.9804 | tpr=0.9469 | fpr=0.0190 | 3967.5 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.14432 | acc=0.9797 | tpr=0.9659 | fpr=0.0201 | 7506.1 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.15007 | acc=0.9788 | tpr=0.9669 | fpr=0.0210 | 7368.5 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.15098 | acc=0.9790 | tpr=0.9705 | fpr=0.0208 | 8141.5 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.14976 | acc=0.9792 | tpr=0.9721 | fpr=0.0207 | 7826.6 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.15288 | acc=0.9791 | tpr=0.9702 | fpr=0.0208 | 7689.0 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.15339 | acc=0.9789 | tpr=0.9693 | fpr=0.0209 | 7995.2 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.15463 | acc=0.9787 | tpr=0.9688 | fpr=0.0211 | 7861.8 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.15770 | acc=0.9783 | tpr=0.9669 | fpr=0.0215 | 7896.8 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.15671 | acc=0.9783 | tpr=0.9674 | fpr=0.0215 | 7877.5 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.15584 | acc=0.9785 | tpr=0.9674 | fpr=0.0213 | 12813.8 samples/s | 50.1 steps/s
Avg test loss: 0.15557, Avg test acc: 0.97853, Avg tpr: 0.96712, Avg fpr: 0.02126, total FA: 2952

server round 22/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00025, len=1
[Step=17601 Epoch=34.3] | Loss=0.00149 | Reg=0.00378 | acc=1.0000 | L2-Norm=19.432 | L2-Norm(final)=2.424 | 3860.3 samples/s | 60.3 steps/s
[Step=17650 Epoch=34.4] | Loss=0.00322 | Reg=0.00377 | acc=1.0000 | L2-Norm=19.427 | L2-Norm(final)=2.425 | 4287.4 samples/s | 67.0 steps/s
[Step=17700 Epoch=34.5] | Loss=0.00380 | Reg=0.00377 | acc=0.9844 | L2-Norm=19.422 | L2-Norm(final)=2.426 | 4598.0 samples/s | 71.8 steps/s
[Step=17750 Epoch=34.6] | Loss=0.00419 | Reg=0.00377 | acc=1.0000 | L2-Norm=19.417 | L2-Norm(final)=2.426 | 4554.5 samples/s | 71.2 steps/s
[Step=17800 Epoch=34.7] | Loss=0.00469 | Reg=0.00377 | acc=0.9844 | L2-Norm=19.412 | L2-Norm(final)=2.426 | 4652.0 samples/s | 72.7 steps/s
[Step=17850 Epoch=34.8] | Loss=0.00439 | Reg=0.00377 | acc=1.0000 | L2-Norm=19.407 | L2-Norm(final)=2.426 | 4397.6 samples/s | 68.7 steps/s
[Step=17900 Epoch=34.9] | Loss=0.00417 | Reg=0.00376 | acc=0.9844 | L2-Norm=19.402 | L2-Norm(final)=2.427 | 4636.7 samples/s | 72.4 steps/s
[Step=17950 Epoch=35.0] | Loss=0.00421 | Reg=0.00376 | acc=1.0000 | L2-Norm=19.397 | L2-Norm(final)=2.428 | 4607.7 samples/s | 72.0 steps/s
[Step=18000 Epoch=35.1] | Loss=0.00429 | Reg=0.00376 | acc=1.0000 | L2-Norm=19.392 | L2-Norm(final)=2.429 | 4624.3 samples/s | 72.3 steps/s
[Step=18050 Epoch=35.2] | Loss=0.00426 | Reg=0.00376 | acc=1.0000 | L2-Norm=19.388 | L2-Norm(final)=2.430 | 4566.3 samples/s | 71.3 steps/s
[Step=18100 Epoch=35.3] | Loss=0.00426 | Reg=0.00376 | acc=0.9844 | L2-Norm=19.383 | L2-Norm(final)=2.431 | 5642.8 samples/s | 88.2 steps/s
[Step=18150 Epoch=35.4] | Loss=0.00427 | Reg=0.00376 | acc=1.0000 | L2-Norm=19.379 | L2-Norm(final)=2.432 | 1894.6 samples/s | 29.6 steps/s
[Step=18200 Epoch=35.5] | Loss=0.00428 | Reg=0.00375 | acc=1.0000 | L2-Norm=19.374 | L2-Norm(final)=2.433 | 4450.3 samples/s | 69.5 steps/s
[Step=18250 Epoch=35.6] | Loss=0.00431 | Reg=0.00375 | acc=0.9688 | L2-Norm=19.370 | L2-Norm(final)=2.434 | 4606.6 samples/s | 72.0 steps/s
[Step=18300 Epoch=35.7] | Loss=0.00437 | Reg=0.00375 | acc=1.0000 | L2-Norm=19.365 | L2-Norm(final)=2.434 | 4661.4 samples/s | 72.8 steps/s
[Step=18350 Epoch=35.8] | Loss=0.00441 | Reg=0.00375 | acc=1.0000 | L2-Norm=19.360 | L2-Norm(final)=2.435 | 4673.8 samples/s | 73.0 steps/s
[Step=18400 Epoch=35.9] | Loss=0.00439 | Reg=0.00375 | acc=1.0000 | L2-Norm=19.355 | L2-Norm(final)=2.436 | 4647.2 samples/s | 72.6 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step18400.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00025, len=1
[Step=17601 Epoch=34.4] | Loss=0.00013 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.131 | L2-Norm(final)=2.312 | 3991.8 samples/s | 62.4 steps/s
[Step=17650 Epoch=34.5] | Loss=0.00406 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.127 | L2-Norm(final)=2.314 | 4573.4 samples/s | 71.5 steps/s
[Step=17700 Epoch=34.6] | Loss=0.00387 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.123 | L2-Norm(final)=2.315 | 4644.9 samples/s | 72.6 steps/s
[Step=17750 Epoch=34.7] | Loss=0.00425 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.118 | L2-Norm(final)=2.317 | 4695.0 samples/s | 73.4 steps/s
[Step=17800 Epoch=34.8] | Loss=0.00427 | Reg=0.00365 | acc=0.9844 | L2-Norm=19.113 | L2-Norm(final)=2.317 | 4458.1 samples/s | 69.7 steps/s
[Step=17850 Epoch=34.9] | Loss=0.00403 | Reg=0.00365 | acc=1.0000 | L2-Norm=19.109 | L2-Norm(final)=2.317 | 4436.4 samples/s | 69.3 steps/s
[Step=17900 Epoch=35.0] | Loss=0.00417 | Reg=0.00365 | acc=0.9688 | L2-Norm=19.105 | L2-Norm(final)=2.318 | 4502.7 samples/s | 70.4 steps/s
[Step=17950 Epoch=35.1] | Loss=0.00400 | Reg=0.00365 | acc=1.0000 | L2-Norm=19.101 | L2-Norm(final)=2.319 | 4548.6 samples/s | 71.1 steps/s
[Step=18000 Epoch=35.2] | Loss=0.00407 | Reg=0.00365 | acc=1.0000 | L2-Norm=19.097 | L2-Norm(final)=2.320 | 4464.1 samples/s | 69.8 steps/s
[Step=18050 Epoch=35.3] | Loss=0.00415 | Reg=0.00365 | acc=1.0000 | L2-Norm=19.093 | L2-Norm(final)=2.321 | 4524.3 samples/s | 70.7 steps/s
[Step=18100 Epoch=35.4] | Loss=0.00403 | Reg=0.00364 | acc=1.0000 | L2-Norm=19.089 | L2-Norm(final)=2.322 | 5514.4 samples/s | 86.2 steps/s
[Step=18150 Epoch=35.5] | Loss=0.00392 | Reg=0.00364 | acc=1.0000 | L2-Norm=19.085 | L2-Norm(final)=2.324 | 1871.1 samples/s | 29.2 steps/s
[Step=18200 Epoch=35.6] | Loss=0.00382 | Reg=0.00364 | acc=1.0000 | L2-Norm=19.081 | L2-Norm(final)=2.325 | 4459.4 samples/s | 69.7 steps/s
[Step=18250 Epoch=35.7] | Loss=0.00382 | Reg=0.00364 | acc=0.9844 | L2-Norm=19.077 | L2-Norm(final)=2.326 | 4420.0 samples/s | 69.1 steps/s
[Step=18300 Epoch=35.8] | Loss=0.00383 | Reg=0.00364 | acc=1.0000 | L2-Norm=19.073 | L2-Norm(final)=2.327 | 4382.8 samples/s | 68.5 steps/s
[Step=18350 Epoch=35.9] | Loss=0.00388 | Reg=0.00364 | acc=1.0000 | L2-Norm=19.069 | L2-Norm(final)=2.327 | 4318.7 samples/s | 67.5 steps/s
[Step=18400 Epoch=36.0] | Loss=0.00383 | Reg=0.00363 | acc=1.0000 | L2-Norm=19.064 | L2-Norm(final)=2.328 | 4451.3 samples/s | 69.6 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step18400.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00025, len=1
[Step=17601 Epoch=67.4] | Loss=0.00000 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.203 | L2-Norm(final)=7.537 | 4246.3 samples/s | 66.3 steps/s
[Step=17650 Epoch=67.6] | Loss=0.00001 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.195 | L2-Norm(final)=7.538 | 3908.3 samples/s | 61.1 steps/s
[Step=17700 Epoch=67.8] | Loss=0.00000 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.185 | L2-Norm(final)=7.540 | 4346.8 samples/s | 67.9 steps/s
[Step=17750 Epoch=68.0] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.176 | L2-Norm(final)=7.541 | 4444.9 samples/s | 69.5 steps/s
[Step=17800 Epoch=68.2] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.167 | L2-Norm(final)=7.542 | 4328.4 samples/s | 67.6 steps/s
[Step=17850 Epoch=68.4] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.158 | L2-Norm(final)=7.543 | 5495.1 samples/s | 85.9 steps/s
[Step=17900 Epoch=68.6] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.148 | L2-Norm(final)=7.545 | 1817.2 samples/s | 28.4 steps/s
[Step=17950 Epoch=68.8] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.139 | L2-Norm(final)=7.546 | 4154.1 samples/s | 64.9 steps/s
[Step=18000 Epoch=69.0] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.130 | L2-Norm(final)=7.547 | 4381.1 samples/s | 68.5 steps/s
[Step=18050 Epoch=69.2] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.120 | L2-Norm(final)=7.549 | 4248.9 samples/s | 66.4 steps/s
[Step=18100 Epoch=69.4] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.111 | L2-Norm(final)=7.550 | 4763.6 samples/s | 74.4 steps/s
[Step=18150 Epoch=69.5] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.101 | L2-Norm(final)=7.551 | 1919.1 samples/s | 30.0 steps/s
[Step=18200 Epoch=69.7] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.092 | L2-Norm(final)=7.553 | 4343.2 samples/s | 67.9 steps/s
[Step=18250 Epoch=69.9] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.082 | L2-Norm(final)=7.554 | 4253.9 samples/s | 66.5 steps/s
[Step=18300 Epoch=70.1] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.072 | L2-Norm(final)=7.556 | 4202.8 samples/s | 65.7 steps/s
[Step=18350 Epoch=70.3] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.063 | L2-Norm(final)=7.557 | 4231.1 samples/s | 66.1 steps/s
[Step=18400 Epoch=70.5] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.053 | L2-Norm(final)=7.559 | 1975.6 samples/s | 30.9 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step18400.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00025, len=1
[Step=17601 Epoch=67.8] | Loss=0.00000 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.029 | L2-Norm(final)=4.319 | 3968.1 samples/s | 62.0 steps/s
[Step=17650 Epoch=67.9] | Loss=0.00000 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.017 | L2-Norm(final)=4.325 | 4030.3 samples/s | 63.0 steps/s
[Step=17700 Epoch=68.1] | Loss=0.00000 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.005 | L2-Norm(final)=4.332 | 4343.7 samples/s | 67.9 steps/s
[Step=17750 Epoch=68.3] | Loss=0.00000 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.992 | L2-Norm(final)=4.338 | 4241.4 samples/s | 66.3 steps/s
[Step=17800 Epoch=68.5] | Loss=0.00000 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.980 | L2-Norm(final)=4.346 | 4261.9 samples/s | 66.6 steps/s
[Step=17850 Epoch=68.7] | Loss=0.00000 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.969 | L2-Norm(final)=4.354 | 5361.6 samples/s | 83.8 steps/s
[Step=17900 Epoch=68.9] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.957 | L2-Norm(final)=4.362 | 1826.6 samples/s | 28.5 steps/s
[Step=17950 Epoch=69.1] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.944 | L2-Norm(final)=4.369 | 4197.2 samples/s | 65.6 steps/s
[Step=18000 Epoch=69.3] | Loss=0.00001 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.933 | L2-Norm(final)=4.377 | 4205.1 samples/s | 65.7 steps/s
[Step=18050 Epoch=69.5] | Loss=0.00084 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.936 | L2-Norm(final)=4.382 | 4239.9 samples/s | 66.2 steps/s
[Step=18100 Epoch=69.7] | Loss=0.00088 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.946 | L2-Norm(final)=4.384 | 4730.0 samples/s | 73.9 steps/s
[Step=18150 Epoch=69.9] | Loss=0.00082 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.955 | L2-Norm(final)=4.385 | 1886.7 samples/s | 29.5 steps/s
[Step=18200 Epoch=70.1] | Loss=0.00077 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.962 | L2-Norm(final)=4.386 | 4246.0 samples/s | 66.3 steps/s
[Step=18250 Epoch=70.3] | Loss=0.00072 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.968 | L2-Norm(final)=4.388 | 4203.9 samples/s | 65.7 steps/s
[Step=18300 Epoch=70.4] | Loss=0.00067 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.972 | L2-Norm(final)=4.390 | 4221.9 samples/s | 66.0 steps/s
[Step=18350 Epoch=70.6] | Loss=0.00063 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.976 | L2-Norm(final)=4.391 | 4255.8 samples/s | 66.5 steps/s
[Step=18400 Epoch=70.8] | Loss=0.00059 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.979 | L2-Norm(final)=4.393 | 1964.7 samples/s | 30.7 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step18400.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.17468 | acc=0.9587 | tpr=0.9743 | fpr=0.0751 | 3954.4 samples/s | 15.4 steps/s
Avg test loss: 0.18203, Avg test acc: 0.95633, Avg tpr: 0.97266, Avg fpr: 0.07961, total FA: 621

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.17103 | acc=0.9587 | tpr=0.9695 | fpr=0.0647 | 4179.1 samples/s | 16.3 steps/s
Avg test loss: 0.17836, Avg test acc: 0.95837, Avg tpr: 0.97016, Avg fpr: 0.06756, total FA: 527

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.57315 | acc=0.3137 | tpr=0.0079 | fpr=0.0221 | 4128.8 samples/s | 16.1 steps/s
Avg test loss: 4.58196, Avg test acc: 0.31128, Avg tpr: 0.00734, Avg fpr: 0.02025, total FA: 158

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.60783 | acc=0.3152 | tpr=0.0040 | fpr=0.0089 | 3908.9 samples/s | 15.3 steps/s
Avg test loss: 4.63167, Avg test acc: 0.31297, Avg tpr: 0.00402, Avg fpr: 0.00756, total FA: 59

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.43235 | acc=0.1482 | tpr=0.8097 | fpr=0.8637 | 4233.6 samples/s | 16.5 steps/s
[Step= 100] | Loss=7.39329 | acc=0.1502 | tpr=0.7846 | fpr=0.8616 | 7903.3 samples/s | 30.9 steps/s
[Step= 150] | Loss=7.44631 | acc=0.1483 | tpr=0.7911 | fpr=0.8636 | 7777.4 samples/s | 30.4 steps/s
[Step= 200] | Loss=7.43483 | acc=0.1482 | tpr=0.7847 | fpr=0.8634 | 7853.6 samples/s | 30.7 steps/s
[Step= 250] | Loss=7.45046 | acc=0.1480 | tpr=0.7817 | fpr=0.8635 | 7892.8 samples/s | 30.8 steps/s
[Step= 300] | Loss=7.45815 | acc=0.1472 | tpr=0.7760 | fpr=0.8642 | 7490.2 samples/s | 29.3 steps/s
[Step= 350] | Loss=7.45356 | acc=0.1472 | tpr=0.7783 | fpr=0.8642 | 7673.3 samples/s | 30.0 steps/s
[Step= 400] | Loss=7.45493 | acc=0.1475 | tpr=0.7795 | fpr=0.8640 | 7638.0 samples/s | 29.8 steps/s
[Step= 450] | Loss=7.45747 | acc=0.1472 | tpr=0.7809 | fpr=0.8643 | 7908.2 samples/s | 30.9 steps/s
[Step= 500] | Loss=7.46511 | acc=0.1467 | tpr=0.7784 | fpr=0.8647 | 7322.6 samples/s | 28.6 steps/s
[Step= 550] | Loss=7.46578 | acc=0.1468 | tpr=0.7780 | fpr=0.8646 | 13822.6 samples/s | 54.0 steps/s
Avg test loss: 7.46903, Avg test acc: 0.14670, Avg tpr: 0.77773, Avg fpr: 0.86477, total FA: 120072

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=9.25149 | acc=0.1434 | tpr=0.7743 | fpr=0.8680 | 4080.0 samples/s | 15.9 steps/s
[Step= 100] | Loss=9.19106 | acc=0.1438 | tpr=0.7569 | fpr=0.8676 | 7613.2 samples/s | 29.7 steps/s
[Step= 150] | Loss=9.20884 | acc=0.1439 | tpr=0.7493 | fpr=0.8673 | 7450.6 samples/s | 29.1 steps/s
[Step= 200] | Loss=9.18066 | acc=0.1444 | tpr=0.7475 | fpr=0.8666 | 7564.4 samples/s | 29.5 steps/s
[Step= 250] | Loss=9.18669 | acc=0.1441 | tpr=0.7406 | fpr=0.8667 | 7355.5 samples/s | 28.7 steps/s
[Step= 300] | Loss=9.19302 | acc=0.1438 | tpr=0.7440 | fpr=0.8672 | 7908.3 samples/s | 30.9 steps/s
[Step= 350] | Loss=9.18800 | acc=0.1435 | tpr=0.7451 | fpr=0.8675 | 7188.8 samples/s | 28.1 steps/s
[Step= 400] | Loss=9.18283 | acc=0.1435 | tpr=0.7505 | fpr=0.8675 | 7502.5 samples/s | 29.3 steps/s
[Step= 450] | Loss=9.19336 | acc=0.1435 | tpr=0.7507 | fpr=0.8675 | 7515.9 samples/s | 29.4 steps/s
[Step= 500] | Loss=9.20754 | acc=0.1428 | tpr=0.7515 | fpr=0.8681 | 7320.7 samples/s | 28.6 steps/s
[Step= 550] | Loss=9.20697 | acc=0.1427 | tpr=0.7437 | fpr=0.8682 | 14074.3 samples/s | 55.0 steps/s
Avg test loss: 9.20926, Avg test acc: 0.14255, Avg tpr: 0.74366, Avg fpr: 0.86838, total FA: 120573

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.07964 | acc=0.9837 | tpr=0.9602 | fpr=0.0159 | 3945.1 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.08235 | acc=0.9830 | tpr=0.9638 | fpr=0.0166 | 7580.9 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.08641 | acc=0.9823 | tpr=0.9597 | fpr=0.0173 | 7479.4 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.08653 | acc=0.9824 | tpr=0.9639 | fpr=0.0172 | 7603.8 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.08615 | acc=0.9826 | tpr=0.9616 | fpr=0.0171 | 7249.2 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.08642 | acc=0.9825 | tpr=0.9615 | fpr=0.0171 | 7660.1 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.08652 | acc=0.9824 | tpr=0.9612 | fpr=0.0172 | 7605.5 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.08738 | acc=0.9820 | tpr=0.9573 | fpr=0.0175 | 7283.6 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.08879 | acc=0.9817 | tpr=0.9542 | fpr=0.0178 | 7349.9 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.08845 | acc=0.9818 | tpr=0.9564 | fpr=0.0177 | 7309.2 samples/s | 28.6 steps/s
[Step= 550] | Loss=0.08802 | acc=0.9819 | tpr=0.9546 | fpr=0.0176 | 13825.4 samples/s | 54.0 steps/s
Avg test loss: 0.08792, Avg test acc: 0.98196, Avg tpr: 0.95483, Avg fpr: 0.01755, total FA: 2437

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11014 | acc=0.9781 | tpr=0.9469 | fpr=0.0213 | 4045.3 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.11582 | acc=0.9777 | tpr=0.9616 | fpr=0.0220 | 7453.4 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.12005 | acc=0.9768 | tpr=0.9625 | fpr=0.0230 | 7485.8 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.12035 | acc=0.9770 | tpr=0.9650 | fpr=0.0228 | 7469.1 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.11935 | acc=0.9771 | tpr=0.9677 | fpr=0.0227 | 7736.0 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.12121 | acc=0.9770 | tpr=0.9665 | fpr=0.0228 | 8367.6 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.12167 | acc=0.9770 | tpr=0.9668 | fpr=0.0228 | 7361.9 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.12305 | acc=0.9767 | tpr=0.9655 | fpr=0.0230 | 8119.7 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.12531 | acc=0.9764 | tpr=0.9635 | fpr=0.0234 | 7504.6 samples/s | 29.3 steps/s
[Step= 500] | Loss=0.12449 | acc=0.9765 | tpr=0.9648 | fpr=0.0233 | 7855.5 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.12341 | acc=0.9768 | tpr=0.9654 | fpr=0.0230 | 14530.6 samples/s | 56.8 steps/s
Avg test loss: 0.12315, Avg test acc: 0.97685, Avg tpr: 0.96553, Avg fpr: 0.02295, total FA: 3186

server round 23/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00025, len=1
[Step=18401 Epoch=35.9] | Loss=0.00584 | Reg=0.00372 | acc=1.0000 | L2-Norm=19.281 | L2-Norm(final)=2.448 | 4034.0 samples/s | 63.0 steps/s
[Step=18450 Epoch=36.0] | Loss=0.00371 | Reg=0.00372 | acc=1.0000 | L2-Norm=19.278 | L2-Norm(final)=2.451 | 4118.1 samples/s | 64.3 steps/s
[Step=18500 Epoch=36.1] | Loss=0.00373 | Reg=0.00371 | acc=0.9844 | L2-Norm=19.273 | L2-Norm(final)=2.452 | 4536.0 samples/s | 70.9 steps/s
[Step=18550 Epoch=36.2] | Loss=0.00455 | Reg=0.00371 | acc=0.9688 | L2-Norm=19.268 | L2-Norm(final)=2.452 | 4657.3 samples/s | 72.8 steps/s
[Step=18600 Epoch=36.3] | Loss=0.00431 | Reg=0.00371 | acc=1.0000 | L2-Norm=19.263 | L2-Norm(final)=2.452 | 4676.9 samples/s | 73.1 steps/s
[Step=18650 Epoch=36.4] | Loss=0.00426 | Reg=0.00371 | acc=1.0000 | L2-Norm=19.258 | L2-Norm(final)=2.452 | 4560.0 samples/s | 71.3 steps/s
[Step=18700 Epoch=36.5] | Loss=0.00445 | Reg=0.00371 | acc=0.9844 | L2-Norm=19.253 | L2-Norm(final)=2.453 | 4607.2 samples/s | 72.0 steps/s
[Step=18750 Epoch=36.6] | Loss=0.00437 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.248 | L2-Norm(final)=2.453 | 4565.8 samples/s | 71.3 steps/s
[Step=18800 Epoch=36.7] | Loss=0.00470 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.244 | L2-Norm(final)=2.454 | 4600.0 samples/s | 71.9 steps/s
[Step=18850 Epoch=36.8] | Loss=0.00474 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.239 | L2-Norm(final)=2.453 | 4528.4 samples/s | 70.8 steps/s
[Step=18900 Epoch=36.9] | Loss=0.00467 | Reg=0.00370 | acc=0.9844 | L2-Norm=19.235 | L2-Norm(final)=2.453 | 5482.4 samples/s | 85.7 steps/s
[Step=18950 Epoch=37.0] | Loss=0.00462 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.232 | L2-Norm(final)=2.454 | 1935.6 samples/s | 30.2 steps/s
[Step=19000 Epoch=37.1] | Loss=0.00467 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.228 | L2-Norm(final)=2.454 | 4640.8 samples/s | 72.5 steps/s
[Step=19050 Epoch=37.2] | Loss=0.00462 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.224 | L2-Norm(final)=2.455 | 4488.7 samples/s | 70.1 steps/s
[Step=19100 Epoch=37.3] | Loss=0.00464 | Reg=0.00369 | acc=1.0000 | L2-Norm=19.220 | L2-Norm(final)=2.456 | 4552.9 samples/s | 71.1 steps/s
[Step=19150 Epoch=37.3] | Loss=0.00462 | Reg=0.00369 | acc=1.0000 | L2-Norm=19.217 | L2-Norm(final)=2.457 | 4544.3 samples/s | 71.0 steps/s
[Step=19200 Epoch=37.4] | Loss=0.00459 | Reg=0.00369 | acc=0.9844 | L2-Norm=19.213 | L2-Norm(final)=2.457 | 4704.3 samples/s | 73.5 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step19200.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00025, len=1
[Step=18401 Epoch=36.0] | Loss=0.00210 | Reg=0.00361 | acc=1.0000 | L2-Norm=18.994 | L2-Norm(final)=2.342 | 4037.4 samples/s | 63.1 steps/s
[Step=18450 Epoch=36.1] | Loss=0.00484 | Reg=0.00361 | acc=1.0000 | L2-Norm=18.992 | L2-Norm(final)=2.342 | 4520.1 samples/s | 70.6 steps/s
[Step=18500 Epoch=36.2] | Loss=0.00411 | Reg=0.00361 | acc=1.0000 | L2-Norm=18.989 | L2-Norm(final)=2.341 | 4609.3 samples/s | 72.0 steps/s
[Step=18550 Epoch=36.3] | Loss=0.00475 | Reg=0.00360 | acc=1.0000 | L2-Norm=18.985 | L2-Norm(final)=2.341 | 4622.2 samples/s | 72.2 steps/s
[Step=18600 Epoch=36.4] | Loss=0.00462 | Reg=0.00360 | acc=0.9844 | L2-Norm=18.980 | L2-Norm(final)=2.340 | 4613.5 samples/s | 72.1 steps/s
[Step=18650 Epoch=36.5] | Loss=0.00448 | Reg=0.00360 | acc=1.0000 | L2-Norm=18.976 | L2-Norm(final)=2.340 | 4578.0 samples/s | 71.5 steps/s
[Step=18700 Epoch=36.6] | Loss=0.00446 | Reg=0.00360 | acc=0.9844 | L2-Norm=18.971 | L2-Norm(final)=2.340 | 4380.1 samples/s | 68.4 steps/s
[Step=18750 Epoch=36.7] | Loss=0.00442 | Reg=0.00360 | acc=1.0000 | L2-Norm=18.967 | L2-Norm(final)=2.340 | 4498.7 samples/s | 70.3 steps/s
[Step=18800 Epoch=36.8] | Loss=0.00424 | Reg=0.00360 | acc=1.0000 | L2-Norm=18.963 | L2-Norm(final)=2.341 | 4533.5 samples/s | 70.8 steps/s
[Step=18850 Epoch=36.9] | Loss=0.00436 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.959 | L2-Norm(final)=2.342 | 4471.6 samples/s | 69.9 steps/s
[Step=18900 Epoch=36.9] | Loss=0.00436 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.955 | L2-Norm(final)=2.342 | 5552.1 samples/s | 86.8 steps/s
[Step=18950 Epoch=37.0] | Loss=0.00449 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.950 | L2-Norm(final)=2.343 | 1883.3 samples/s | 29.4 steps/s
[Step=19000 Epoch=37.1] | Loss=0.00444 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.946 | L2-Norm(final)=2.343 | 4359.4 samples/s | 68.1 steps/s
[Step=19050 Epoch=37.2] | Loss=0.00441 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.942 | L2-Norm(final)=2.344 | 4410.1 samples/s | 68.9 steps/s
[Step=19100 Epoch=37.3] | Loss=0.00431 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.938 | L2-Norm(final)=2.345 | 4410.4 samples/s | 68.9 steps/s
[Step=19150 Epoch=37.4] | Loss=0.00431 | Reg=0.00358 | acc=1.0000 | L2-Norm=18.933 | L2-Norm(final)=2.346 | 4463.0 samples/s | 69.7 steps/s
[Step=19200 Epoch=37.5] | Loss=0.00421 | Reg=0.00358 | acc=1.0000 | L2-Norm=18.929 | L2-Norm(final)=2.347 | 4492.4 samples/s | 70.2 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step19200.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00025, len=1
[Step=18401 Epoch=70.5] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.897 | L2-Norm(final)=7.582 | 3949.1 samples/s | 61.7 steps/s
[Step=18450 Epoch=70.7] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.887 | L2-Norm(final)=7.584 | 4299.4 samples/s | 67.2 steps/s
[Step=18500 Epoch=70.9] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.877 | L2-Norm(final)=7.586 | 4346.7 samples/s | 67.9 steps/s
[Step=18550 Epoch=71.1] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.867 | L2-Norm(final)=7.587 | 4369.4 samples/s | 68.3 steps/s
[Step=18600 Epoch=71.3] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.857 | L2-Norm(final)=7.589 | 4201.6 samples/s | 65.6 steps/s
[Step=18650 Epoch=71.5] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.847 | L2-Norm(final)=7.591 | 5375.1 samples/s | 84.0 steps/s
[Step=18700 Epoch=71.7] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.837 | L2-Norm(final)=7.592 | 1822.3 samples/s | 28.5 steps/s
[Step=18750 Epoch=71.8] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.826 | L2-Norm(final)=7.594 | 4243.0 samples/s | 66.3 steps/s
[Step=18800 Epoch=72.0] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.816 | L2-Norm(final)=7.596 | 4181.1 samples/s | 65.3 steps/s
[Step=18850 Epoch=72.2] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.806 | L2-Norm(final)=7.598 | 4235.0 samples/s | 66.2 steps/s
[Step=18900 Epoch=72.4] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.796 | L2-Norm(final)=7.600 | 4680.4 samples/s | 73.1 steps/s
[Step=18950 Epoch=72.6] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.785 | L2-Norm(final)=7.602 | 1885.5 samples/s | 29.5 steps/s
[Step=19000 Epoch=72.8] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.775 | L2-Norm(final)=7.603 | 4221.6 samples/s | 66.0 steps/s
[Step=19050 Epoch=73.0] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.765 | L2-Norm(final)=7.605 | 4218.6 samples/s | 65.9 steps/s
[Step=19100 Epoch=73.2] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.754 | L2-Norm(final)=7.607 | 4210.6 samples/s | 65.8 steps/s
[Step=19150 Epoch=73.4] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.744 | L2-Norm(final)=7.609 | 4252.5 samples/s | 66.4 steps/s
[Step=19200 Epoch=73.6] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.733 | L2-Norm(final)=7.611 | 1975.8 samples/s | 30.9 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step19200.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00025, len=1
[Step=18401 Epoch=70.8] | Loss=0.00002 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.023 | L2-Norm(final)=4.416 | 3981.7 samples/s | 62.2 steps/s
[Step=18450 Epoch=71.0] | Loss=0.00003 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.022 | L2-Norm(final)=4.417 | 3971.0 samples/s | 62.0 steps/s
[Step=18500 Epoch=71.2] | Loss=0.00002 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.021 | L2-Norm(final)=4.419 | 4243.4 samples/s | 66.3 steps/s
[Step=18550 Epoch=71.4] | Loss=0.00002 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.019 | L2-Norm(final)=4.421 | 4217.9 samples/s | 65.9 steps/s
[Step=18600 Epoch=71.6] | Loss=0.00002 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.018 | L2-Norm(final)=4.422 | 4308.0 samples/s | 67.3 steps/s
[Step=18650 Epoch=71.8] | Loss=0.00002 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.017 | L2-Norm(final)=4.424 | 5437.9 samples/s | 85.0 steps/s
[Step=18700 Epoch=72.0] | Loss=0.00002 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.015 | L2-Norm(final)=4.426 | 1808.8 samples/s | 28.3 steps/s
[Step=18750 Epoch=72.2] | Loss=0.00002 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.014 | L2-Norm(final)=4.428 | 4238.2 samples/s | 66.2 steps/s
[Step=18800 Epoch=72.4] | Loss=0.00002 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.012 | L2-Norm(final)=4.430 | 4232.8 samples/s | 66.1 steps/s
[Step=18850 Epoch=72.6] | Loss=0.00002 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.011 | L2-Norm(final)=4.432 | 4356.3 samples/s | 68.1 steps/s
[Step=18900 Epoch=72.8] | Loss=0.00002 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.010 | L2-Norm(final)=4.434 | 4799.4 samples/s | 75.0 steps/s
[Step=18950 Epoch=72.9] | Loss=0.00002 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.008 | L2-Norm(final)=4.436 | 1837.9 samples/s | 28.7 steps/s
[Step=19000 Epoch=73.1] | Loss=0.00002 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.007 | L2-Norm(final)=4.438 | 3938.5 samples/s | 61.5 steps/s
[Step=19050 Epoch=73.3] | Loss=0.00001 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.005 | L2-Norm(final)=4.440 | 4020.6 samples/s | 62.8 steps/s
[Step=19100 Epoch=73.5] | Loss=0.00001 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.004 | L2-Norm(final)=4.442 | 3963.9 samples/s | 61.9 steps/s
[Step=19150 Epoch=73.7] | Loss=0.00001 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.003 | L2-Norm(final)=4.444 | 4229.6 samples/s | 66.1 steps/s
[Step=19200 Epoch=73.9] | Loss=0.00001 | Reg=0.00036 | acc=1.0000 | L2-Norm=6.001 | L2-Norm(final)=4.446 | 1938.6 samples/s | 30.3 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step19200.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.17409 | acc=0.9582 | tpr=0.9744 | fpr=0.0771 | 4082.6 samples/s | 15.9 steps/s
Avg test loss: 0.18049, Avg test acc: 0.95645, Avg tpr: 0.97319, Avg fpr: 0.08037, total FA: 627

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.17724 | acc=0.9588 | tpr=0.9710 | fpr=0.0676 | 4022.4 samples/s | 15.7 steps/s
Avg test loss: 0.18574, Avg test acc: 0.95917, Avg tpr: 0.97208, Avg fpr: 0.06922, total FA: 540

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.64962 | acc=0.3138 | tpr=0.0078 | fpr=0.0216 | 4329.1 samples/s | 16.9 steps/s
Avg test loss: 4.65868, Avg test acc: 0.31140, Avg tpr: 0.00729, Avg fpr: 0.01974, total FA: 154

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.25659 | acc=0.3149 | tpr=0.0038 | fpr=0.0094 | 4198.9 samples/s | 16.4 steps/s
Avg test loss: 5.28432, Avg test acc: 0.31281, Avg tpr: 0.00396, Avg fpr: 0.00795, total FA: 62

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.45890 | acc=0.1474 | tpr=0.7920 | fpr=0.8642 | 4114.7 samples/s | 16.1 steps/s
[Step= 100] | Loss=7.41827 | acc=0.1491 | tpr=0.7868 | fpr=0.8628 | 7806.8 samples/s | 30.5 steps/s
[Step= 150] | Loss=7.46566 | acc=0.1477 | tpr=0.7925 | fpr=0.8642 | 8173.7 samples/s | 31.9 steps/s
[Step= 200] | Loss=7.45504 | acc=0.1471 | tpr=0.7847 | fpr=0.8645 | 7484.7 samples/s | 29.2 steps/s
[Step= 250] | Loss=7.47297 | acc=0.1469 | tpr=0.7834 | fpr=0.8647 | 8151.7 samples/s | 31.8 steps/s
[Step= 300] | Loss=7.47988 | acc=0.1464 | tpr=0.7825 | fpr=0.8652 | 8025.6 samples/s | 31.4 steps/s
[Step= 350] | Loss=7.47674 | acc=0.1464 | tpr=0.7858 | fpr=0.8652 | 7511.3 samples/s | 29.3 steps/s
[Step= 400] | Loss=7.47732 | acc=0.1466 | tpr=0.7921 | fpr=0.8651 | 7922.6 samples/s | 30.9 steps/s
[Step= 450] | Loss=7.48091 | acc=0.1464 | tpr=0.7926 | fpr=0.8654 | 7596.3 samples/s | 29.7 steps/s
[Step= 500] | Loss=7.48924 | acc=0.1458 | tpr=0.7899 | fpr=0.8659 | 7864.5 samples/s | 30.7 steps/s
[Step= 550] | Loss=7.48989 | acc=0.1458 | tpr=0.7899 | fpr=0.8659 | 14075.8 samples/s | 55.0 steps/s
Avg test loss: 7.49307, Avg test acc: 0.14569, Avg tpr: 0.78962, Avg fpr: 0.86602, total FA: 120245

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=9.51475 | acc=0.1399 | tpr=0.7788 | fpr=0.8716 | 4131.3 samples/s | 16.1 steps/s
[Step= 100] | Loss=9.45596 | acc=0.1399 | tpr=0.7804 | fpr=0.8720 | 7895.9 samples/s | 30.8 steps/s
[Step= 150] | Loss=9.47206 | acc=0.1405 | tpr=0.7695 | fpr=0.8711 | 7428.0 samples/s | 29.0 steps/s
[Step= 200] | Loss=9.44241 | acc=0.1414 | tpr=0.7683 | fpr=0.8700 | 7611.4 samples/s | 29.7 steps/s
[Step= 250] | Loss=9.44814 | acc=0.1409 | tpr=0.7633 | fpr=0.8704 | 7448.4 samples/s | 29.1 steps/s
[Step= 300] | Loss=9.45391 | acc=0.1408 | tpr=0.7636 | fpr=0.8705 | 7631.5 samples/s | 29.8 steps/s
[Step= 350] | Loss=9.45096 | acc=0.1407 | tpr=0.7664 | fpr=0.8706 | 7786.1 samples/s | 30.4 steps/s
[Step= 400] | Loss=9.44514 | acc=0.1407 | tpr=0.7713 | fpr=0.8708 | 7724.4 samples/s | 30.2 steps/s
[Step= 450] | Loss=9.45736 | acc=0.1405 | tpr=0.7697 | fpr=0.8709 | 7190.2 samples/s | 28.1 steps/s
[Step= 500] | Loss=9.47106 | acc=0.1399 | tpr=0.7722 | fpr=0.8715 | 7365.0 samples/s | 28.8 steps/s
[Step= 550] | Loss=9.47118 | acc=0.1399 | tpr=0.7672 | fpr=0.8715 | 12928.3 samples/s | 50.5 steps/s
Avg test loss: 9.47329, Avg test acc: 0.13974, Avg tpr: 0.76743, Avg fpr: 0.87167, total FA: 121030

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08247 | acc=0.9832 | tpr=0.9602 | fpr=0.0164 | 3814.6 samples/s | 14.9 steps/s
[Step= 100] | Loss=0.08515 | acc=0.9827 | tpr=0.9638 | fpr=0.0169 | 7380.6 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.08936 | acc=0.9820 | tpr=0.9597 | fpr=0.0176 | 7618.5 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.08950 | acc=0.9822 | tpr=0.9639 | fpr=0.0175 | 7461.7 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.08906 | acc=0.9823 | tpr=0.9607 | fpr=0.0173 | 7677.2 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.08936 | acc=0.9823 | tpr=0.9607 | fpr=0.0173 | 7375.5 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.08947 | acc=0.9822 | tpr=0.9612 | fpr=0.0174 | 7277.7 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.09039 | acc=0.9818 | tpr=0.9573 | fpr=0.0177 | 7690.3 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.09186 | acc=0.9815 | tpr=0.9542 | fpr=0.0180 | 7341.5 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.09153 | acc=0.9816 | tpr=0.9564 | fpr=0.0179 | 7110.6 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.09108 | acc=0.9818 | tpr=0.9550 | fpr=0.0177 | 14277.2 samples/s | 55.8 steps/s
Avg test loss: 0.09098, Avg test acc: 0.98179, Avg tpr: 0.95523, Avg fpr: 0.01773, total FA: 2462

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12507 | acc=0.9782 | tpr=0.9469 | fpr=0.0212 | 4005.3 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.13163 | acc=0.9777 | tpr=0.9616 | fpr=0.0220 | 7362.8 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.13637 | acc=0.9769 | tpr=0.9625 | fpr=0.0228 | 7662.1 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.13684 | acc=0.9772 | tpr=0.9650 | fpr=0.0226 | 7286.2 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.13563 | acc=0.9773 | tpr=0.9677 | fpr=0.0225 | 7748.6 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.13783 | acc=0.9772 | tpr=0.9673 | fpr=0.0226 | 7773.9 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.13831 | acc=0.9772 | tpr=0.9674 | fpr=0.0226 | 7911.5 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.13982 | acc=0.9770 | tpr=0.9661 | fpr=0.0228 | 7687.1 samples/s | 30.0 steps/s
[Step= 450] | Loss=0.14236 | acc=0.9766 | tpr=0.9640 | fpr=0.0232 | 8108.9 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.14141 | acc=0.9767 | tpr=0.9652 | fpr=0.0231 | 7212.4 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.14022 | acc=0.9770 | tpr=0.9658 | fpr=0.0228 | 14332.1 samples/s | 56.0 steps/s
Avg test loss: 0.13992, Avg test acc: 0.97703, Avg tpr: 0.96593, Avg fpr: 0.02277, total FA: 3162

server round 24/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00025, len=1
[Step=19201 Epoch=37.4] | Loss=0.00514 | Reg=0.00367 | acc=1.0000 | L2-Norm=19.152 | L2-Norm(final)=2.470 | 3750.9 samples/s | 58.6 steps/s
[Step=19250 Epoch=37.5] | Loss=0.00527 | Reg=0.00367 | acc=0.9844 | L2-Norm=19.147 | L2-Norm(final)=2.464 | 4234.7 samples/s | 66.2 steps/s
[Step=19300 Epoch=37.6] | Loss=0.00527 | Reg=0.00366 | acc=0.9844 | L2-Norm=19.144 | L2-Norm(final)=2.465 | 4530.7 samples/s | 70.8 steps/s
[Step=19350 Epoch=37.7] | Loss=0.00493 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.140 | L2-Norm(final)=2.466 | 4611.2 samples/s | 72.1 steps/s
[Step=19400 Epoch=37.8] | Loss=0.00466 | Reg=0.00366 | acc=0.9844 | L2-Norm=19.136 | L2-Norm(final)=2.468 | 4520.3 samples/s | 70.6 steps/s
[Step=19450 Epoch=37.9] | Loss=0.00497 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.133 | L2-Norm(final)=2.470 | 4586.3 samples/s | 71.7 steps/s
[Step=19500 Epoch=38.0] | Loss=0.00514 | Reg=0.00366 | acc=0.9844 | L2-Norm=19.129 | L2-Norm(final)=2.470 | 4603.4 samples/s | 71.9 steps/s
[Step=19550 Epoch=38.1] | Loss=0.00500 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.126 | L2-Norm(final)=2.470 | 4736.5 samples/s | 74.0 steps/s
[Step=19600 Epoch=38.2] | Loss=0.00490 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.123 | L2-Norm(final)=2.471 | 4551.5 samples/s | 71.1 steps/s
[Step=19650 Epoch=38.3] | Loss=0.00501 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.120 | L2-Norm(final)=2.472 | 4531.4 samples/s | 70.8 steps/s
[Step=19700 Epoch=38.4] | Loss=0.00517 | Reg=0.00365 | acc=1.0000 | L2-Norm=19.118 | L2-Norm(final)=2.473 | 5642.5 samples/s | 88.2 steps/s
[Step=19750 Epoch=38.5] | Loss=0.00506 | Reg=0.00365 | acc=0.9844 | L2-Norm=19.115 | L2-Norm(final)=2.474 | 1891.3 samples/s | 29.6 steps/s
[Step=19800 Epoch=38.6] | Loss=0.00496 | Reg=0.00365 | acc=0.9844 | L2-Norm=19.112 | L2-Norm(final)=2.475 | 4646.9 samples/s | 72.6 steps/s
[Step=19850 Epoch=38.7] | Loss=0.00483 | Reg=0.00365 | acc=1.0000 | L2-Norm=19.109 | L2-Norm(final)=2.476 | 4564.8 samples/s | 71.3 steps/s
[Step=19900 Epoch=38.8] | Loss=0.00493 | Reg=0.00365 | acc=0.9844 | L2-Norm=19.106 | L2-Norm(final)=2.477 | 4562.4 samples/s | 71.3 steps/s
[Step=19950 Epoch=38.9] | Loss=0.00487 | Reg=0.00365 | acc=1.0000 | L2-Norm=19.102 | L2-Norm(final)=2.479 | 4527.5 samples/s | 70.7 steps/s
[Step=20000 Epoch=39.0] | Loss=0.00493 | Reg=0.00365 | acc=0.9844 | L2-Norm=19.099 | L2-Norm(final)=2.480 | 4684.5 samples/s | 73.2 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step20000.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00025, len=1
[Step=19201 Epoch=37.5] | Loss=0.00000 | Reg=0.00356 | acc=1.0000 | L2-Norm=18.864 | L2-Norm(final)=2.366 | 4103.2 samples/s | 64.1 steps/s
[Step=19250 Epoch=37.6] | Loss=0.00289 | Reg=0.00356 | acc=1.0000 | L2-Norm=18.860 | L2-Norm(final)=2.367 | 4213.6 samples/s | 65.8 steps/s
[Step=19300 Epoch=37.7] | Loss=0.00365 | Reg=0.00356 | acc=1.0000 | L2-Norm=18.856 | L2-Norm(final)=2.367 | 4430.8 samples/s | 69.2 steps/s
[Step=19350 Epoch=37.8] | Loss=0.00432 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.854 | L2-Norm(final)=2.365 | 4294.1 samples/s | 67.1 steps/s
[Step=19400 Epoch=37.9] | Loss=0.00426 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.852 | L2-Norm(final)=2.364 | 4443.0 samples/s | 69.4 steps/s
[Step=19450 Epoch=38.0] | Loss=0.00461 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.850 | L2-Norm(final)=2.364 | 4499.6 samples/s | 70.3 steps/s
[Step=19500 Epoch=38.1] | Loss=0.00510 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.849 | L2-Norm(final)=2.363 | 4537.5 samples/s | 70.9 steps/s
[Step=19550 Epoch=38.2] | Loss=0.00507 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.847 | L2-Norm(final)=2.363 | 4454.9 samples/s | 69.6 steps/s
[Step=19600 Epoch=38.3] | Loss=0.00512 | Reg=0.00355 | acc=0.9844 | L2-Norm=18.845 | L2-Norm(final)=2.362 | 4429.4 samples/s | 69.2 steps/s
[Step=19650 Epoch=38.4] | Loss=0.00509 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.842 | L2-Norm(final)=2.362 | 4485.2 samples/s | 70.1 steps/s
[Step=19700 Epoch=38.5] | Loss=0.00500 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.841 | L2-Norm(final)=2.363 | 5419.7 samples/s | 84.7 steps/s
[Step=19750 Epoch=38.6] | Loss=0.00508 | Reg=0.00355 | acc=0.9844 | L2-Norm=18.840 | L2-Norm(final)=2.363 | 1785.3 samples/s | 27.9 steps/s
[Step=19800 Epoch=38.7] | Loss=0.00508 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.839 | L2-Norm(final)=2.364 | 4512.9 samples/s | 70.5 steps/s
[Step=19850 Epoch=38.8] | Loss=0.00509 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.838 | L2-Norm(final)=2.364 | 4581.6 samples/s | 71.6 steps/s
[Step=19900 Epoch=38.9] | Loss=0.00490 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.838 | L2-Norm(final)=2.365 | 4561.3 samples/s | 71.3 steps/s
[Step=19950 Epoch=39.0] | Loss=0.00483 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.837 | L2-Norm(final)=2.366 | 4522.6 samples/s | 70.7 steps/s
[Step=20000 Epoch=39.1] | Loss=0.00476 | Reg=0.00355 | acc=0.9844 | L2-Norm=18.835 | L2-Norm(final)=2.367 | 4571.9 samples/s | 71.4 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step20000.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00025, len=1
[Step=19201 Epoch=73.6] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.566 | L2-Norm(final)=7.642 | 4247.4 samples/s | 66.4 steps/s
[Step=19250 Epoch=73.8] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.556 | L2-Norm(final)=7.644 | 3840.4 samples/s | 60.0 steps/s
[Step=19300 Epoch=74.0] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.545 | L2-Norm(final)=7.647 | 4394.8 samples/s | 68.7 steps/s
[Step=19350 Epoch=74.1] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.535 | L2-Norm(final)=7.649 | 4418.8 samples/s | 69.0 steps/s
[Step=19400 Epoch=74.3] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.524 | L2-Norm(final)=7.651 | 4236.9 samples/s | 66.2 steps/s
[Step=19450 Epoch=74.5] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.513 | L2-Norm(final)=7.654 | 5262.7 samples/s | 82.2 steps/s
[Step=19500 Epoch=74.7] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.503 | L2-Norm(final)=7.656 | 1782.9 samples/s | 27.9 steps/s
[Step=19550 Epoch=74.9] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.492 | L2-Norm(final)=7.658 | 4265.8 samples/s | 66.7 steps/s
[Step=19600 Epoch=75.1] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.481 | L2-Norm(final)=7.660 | 4305.4 samples/s | 67.3 steps/s
[Step=19650 Epoch=75.3] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.470 | L2-Norm(final)=7.663 | 4137.4 samples/s | 64.6 steps/s
[Step=19700 Epoch=75.5] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.459 | L2-Norm(final)=7.665 | 4754.3 samples/s | 74.3 steps/s
[Step=19750 Epoch=75.7] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.449 | L2-Norm(final)=7.667 | 1873.4 samples/s | 29.3 steps/s
[Step=19800 Epoch=75.9] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.438 | L2-Norm(final)=7.670 | 4255.6 samples/s | 66.5 steps/s
[Step=19850 Epoch=76.1] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.427 | L2-Norm(final)=7.673 | 4205.8 samples/s | 65.7 steps/s
[Step=19900 Epoch=76.2] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.416 | L2-Norm(final)=7.675 | 4253.2 samples/s | 66.5 steps/s
[Step=19950 Epoch=76.4] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.406 | L2-Norm(final)=7.678 | 4209.8 samples/s | 65.8 steps/s
[Step=20000 Epoch=76.6] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.395 | L2-Norm(final)=7.681 | 1970.0 samples/s | 30.8 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step20000.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00025, len=1
[Step=19201 Epoch=73.9] | Loss=0.00001 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.979 | L2-Norm(final)=4.479 | 3976.8 samples/s | 62.1 steps/s
[Step=19250 Epoch=74.1] | Loss=0.00001 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.978 | L2-Norm(final)=4.481 | 4073.1 samples/s | 63.6 steps/s
[Step=19300 Epoch=74.3] | Loss=0.00001 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.977 | L2-Norm(final)=4.484 | 4120.2 samples/s | 64.4 steps/s
[Step=19350 Epoch=74.5] | Loss=0.00001 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.975 | L2-Norm(final)=4.486 | 4227.7 samples/s | 66.1 steps/s
[Step=19400 Epoch=74.7] | Loss=0.00001 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.974 | L2-Norm(final)=4.488 | 4113.6 samples/s | 64.3 steps/s
[Step=19450 Epoch=74.9] | Loss=0.00001 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.972 | L2-Norm(final)=4.491 | 5110.0 samples/s | 79.8 steps/s
[Step=19500 Epoch=75.1] | Loss=0.00001 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.971 | L2-Norm(final)=4.493 | 1782.7 samples/s | 27.9 steps/s
[Step=19550 Epoch=75.3] | Loss=0.00001 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.970 | L2-Norm(final)=4.496 | 4249.8 samples/s | 66.4 steps/s
[Step=19600 Epoch=75.4] | Loss=0.00001 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.968 | L2-Norm(final)=4.499 | 4194.7 samples/s | 65.5 steps/s
[Step=19650 Epoch=75.6] | Loss=0.00001 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.967 | L2-Norm(final)=4.502 | 4220.0 samples/s | 65.9 steps/s
[Step=19700 Epoch=75.8] | Loss=0.00001 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.965 | L2-Norm(final)=4.505 | 4763.7 samples/s | 74.4 steps/s
[Step=19750 Epoch=76.0] | Loss=0.00001 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.964 | L2-Norm(final)=4.507 | 1850.2 samples/s | 28.9 steps/s
[Step=19800 Epoch=76.2] | Loss=0.00001 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.962 | L2-Norm(final)=4.510 | 4160.2 samples/s | 65.0 steps/s
[Step=19850 Epoch=76.4] | Loss=0.00001 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.961 | L2-Norm(final)=4.513 | 4182.6 samples/s | 65.4 steps/s
[Step=19900 Epoch=76.6] | Loss=0.00001 | Reg=0.00036 | acc=1.0000 | L2-Norm=5.959 | L2-Norm(final)=4.515 | 4141.3 samples/s | 64.7 steps/s
[Step=19950 Epoch=76.8] | Loss=0.00001 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.958 | L2-Norm(final)=4.518 | 4227.5 samples/s | 66.1 steps/s
[Step=20000 Epoch=77.0] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.956 | L2-Norm(final)=4.520 | 1933.2 samples/s | 30.2 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step20000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.16622 | acc=0.9583 | tpr=0.9717 | fpr=0.0709 | 3962.4 samples/s | 15.5 steps/s
Avg test loss: 0.17141, Avg test acc: 0.95625, Avg tpr: 0.97016, Avg fpr: 0.07435, total FA: 580

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.16816 | acc=0.9598 | tpr=0.9683 | fpr=0.0587 | 4090.8 samples/s | 16.0 steps/s
Avg test loss: 0.17683, Avg test acc: 0.95845, Avg tpr: 0.96812, Avg fpr: 0.06281, total FA: 490

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.71241 | acc=0.3141 | tpr=0.0074 | fpr=0.0201 | 4107.0 samples/s | 16.0 steps/s
Avg test loss: 4.72203, Avg test acc: 0.31148, Avg tpr: 0.00682, Avg fpr: 0.01846, total FA: 144

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.73520 | acc=0.3149 | tpr=0.0037 | fpr=0.0092 | 4210.7 samples/s | 16.4 steps/s
Avg test loss: 5.76609, Avg test acc: 0.31281, Avg tpr: 0.00396, Avg fpr: 0.00795, total FA: 62

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.73430 | acc=0.1625 | tpr=0.7743 | fpr=0.8485 | 4150.0 samples/s | 16.2 steps/s
[Step= 100] | Loss=6.69836 | acc=0.1629 | tpr=0.7484 | fpr=0.8480 | 7976.6 samples/s | 31.2 steps/s
[Step= 150] | Loss=6.73859 | acc=0.1623 | tpr=0.7550 | fpr=0.8486 | 7544.0 samples/s | 29.5 steps/s
[Step= 200] | Loss=6.72679 | acc=0.1615 | tpr=0.7432 | fpr=0.8490 | 8290.4 samples/s | 32.4 steps/s
[Step= 250] | Loss=6.74424 | acc=0.1612 | tpr=0.7441 | fpr=0.8494 | 7368.3 samples/s | 28.8 steps/s
[Step= 300] | Loss=6.75113 | acc=0.1610 | tpr=0.7447 | fpr=0.8497 | 7417.6 samples/s | 29.0 steps/s
[Step= 350] | Loss=6.74964 | acc=0.1610 | tpr=0.7439 | fpr=0.8496 | 7510.3 samples/s | 29.3 steps/s
[Step= 400] | Loss=6.75030 | acc=0.1611 | tpr=0.7451 | fpr=0.8495 | 7335.8 samples/s | 28.7 steps/s
[Step= 450] | Loss=6.75339 | acc=0.1607 | tpr=0.7478 | fpr=0.8499 | 7948.0 samples/s | 31.0 steps/s
[Step= 500] | Loss=6.76002 | acc=0.1602 | tpr=0.7454 | fpr=0.8504 | 7714.9 samples/s | 30.1 steps/s
[Step= 550] | Loss=6.75998 | acc=0.1603 | tpr=0.7453 | fpr=0.8503 | 12851.2 samples/s | 50.2 steps/s
Avg test loss: 6.76326, Avg test acc: 0.16017, Avg tpr: 0.74525, Avg fpr: 0.85047, total FA: 118086

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=8.59716 | acc=0.1666 | tpr=0.7257 | fpr=0.8434 | 4127.5 samples/s | 16.1 steps/s
[Step= 100] | Loss=8.54636 | acc=0.1671 | tpr=0.7100 | fpr=0.8430 | 7597.9 samples/s | 29.7 steps/s
[Step= 150] | Loss=8.55829 | acc=0.1680 | tpr=0.6945 | fpr=0.8417 | 7621.4 samples/s | 29.8 steps/s
[Step= 200] | Loss=8.53145 | acc=0.1693 | tpr=0.6842 | fpr=0.8401 | 7673.6 samples/s | 30.0 steps/s
[Step= 250] | Loss=8.53044 | acc=0.1690 | tpr=0.6716 | fpr=0.8402 | 8020.2 samples/s | 31.3 steps/s
[Step= 300] | Loss=8.53409 | acc=0.1690 | tpr=0.6691 | fpr=0.8401 | 7397.2 samples/s | 28.9 steps/s
[Step= 350] | Loss=8.52919 | acc=0.1692 | tpr=0.6731 | fpr=0.8400 | 7796.9 samples/s | 30.5 steps/s
[Step= 400] | Loss=8.52638 | acc=0.1692 | tpr=0.6789 | fpr=0.8401 | 7660.8 samples/s | 29.9 steps/s
[Step= 450] | Loss=8.53459 | acc=0.1689 | tpr=0.6777 | fpr=0.8403 | 7554.3 samples/s | 29.5 steps/s
[Step= 500] | Loss=8.54731 | acc=0.1684 | tpr=0.6780 | fpr=0.8408 | 7378.0 samples/s | 28.8 steps/s
[Step= 550] | Loss=8.54717 | acc=0.1681 | tpr=0.6729 | fpr=0.8411 | 13343.4 samples/s | 52.1 steps/s
Avg test loss: 8.54919, Avg test acc: 0.16799, Avg tpr: 0.67314, Avg fpr: 0.84119, total FA: 116798

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08400 | acc=0.9831 | tpr=0.9558 | fpr=0.0164 | 4001.5 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.08658 | acc=0.9828 | tpr=0.9595 | fpr=0.0168 | 7545.9 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.09092 | acc=0.9820 | tpr=0.9568 | fpr=0.0176 | 7520.1 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.09110 | acc=0.9822 | tpr=0.9617 | fpr=0.0174 | 7628.0 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.09062 | acc=0.9825 | tpr=0.9590 | fpr=0.0171 | 7270.2 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.09095 | acc=0.9824 | tpr=0.9593 | fpr=0.0172 | 7567.3 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.09108 | acc=0.9824 | tpr=0.9606 | fpr=0.0172 | 7414.2 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.09201 | acc=0.9820 | tpr=0.9573 | fpr=0.0175 | 7594.0 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.09352 | acc=0.9817 | tpr=0.9547 | fpr=0.0178 | 7203.2 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.09322 | acc=0.9818 | tpr=0.9568 | fpr=0.0177 | 7167.8 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.09276 | acc=0.9819 | tpr=0.9554 | fpr=0.0176 | 13273.0 samples/s | 51.8 steps/s
Avg test loss: 0.09265, Avg test acc: 0.98195, Avg tpr: 0.95563, Avg fpr: 0.01757, total FA: 2440

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13470 | acc=0.9786 | tpr=0.9469 | fpr=0.0208 | 4033.2 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.14187 | acc=0.9779 | tpr=0.9616 | fpr=0.0218 | 7631.1 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.14696 | acc=0.9771 | tpr=0.9625 | fpr=0.0227 | 7534.7 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.14753 | acc=0.9773 | tpr=0.9650 | fpr=0.0225 | 7533.3 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.14623 | acc=0.9775 | tpr=0.9677 | fpr=0.0224 | 7998.0 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.14865 | acc=0.9773 | tpr=0.9673 | fpr=0.0225 | 7613.8 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.14910 | acc=0.9773 | tpr=0.9662 | fpr=0.0225 | 8246.9 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.15062 | acc=0.9770 | tpr=0.9650 | fpr=0.0227 | 7179.9 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.15334 | acc=0.9767 | tpr=0.9630 | fpr=0.0230 | 7842.0 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.15231 | acc=0.9768 | tpr=0.9643 | fpr=0.0230 | 7704.7 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.15107 | acc=0.9771 | tpr=0.9650 | fpr=0.0227 | 14412.0 samples/s | 56.3 steps/s
Avg test loss: 0.15076, Avg test acc: 0.97709, Avg tpr: 0.96474, Avg fpr: 0.02269, total FA: 3150

server round 25/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00025, len=1
[Step=20001 Epoch=39.0] | Loss=0.00007 | Reg=0.00363 | acc=1.0000 | L2-Norm=19.043 | L2-Norm(final)=2.490 | 3652.0 samples/s | 57.1 steps/s
[Step=20050 Epoch=39.1] | Loss=0.00625 | Reg=0.00362 | acc=0.9844 | L2-Norm=19.038 | L2-Norm(final)=2.488 | 4576.3 samples/s | 71.5 steps/s
[Step=20100 Epoch=39.2] | Loss=0.00587 | Reg=0.00362 | acc=0.9844 | L2-Norm=19.035 | L2-Norm(final)=2.489 | 4589.5 samples/s | 71.7 steps/s
[Step=20150 Epoch=39.3] | Loss=0.00517 | Reg=0.00362 | acc=1.0000 | L2-Norm=19.033 | L2-Norm(final)=2.490 | 4565.5 samples/s | 71.3 steps/s
[Step=20200 Epoch=39.4] | Loss=0.00464 | Reg=0.00362 | acc=1.0000 | L2-Norm=19.030 | L2-Norm(final)=2.492 | 4476.6 samples/s | 69.9 steps/s
[Step=20250 Epoch=39.5] | Loss=0.00446 | Reg=0.00362 | acc=1.0000 | L2-Norm=19.027 | L2-Norm(final)=2.494 | 4634.1 samples/s | 72.4 steps/s
[Step=20300 Epoch=39.6] | Loss=0.00425 | Reg=0.00362 | acc=1.0000 | L2-Norm=19.023 | L2-Norm(final)=2.496 | 4754.1 samples/s | 74.3 steps/s
[Step=20350 Epoch=39.7] | Loss=0.00464 | Reg=0.00362 | acc=1.0000 | L2-Norm=19.019 | L2-Norm(final)=2.496 | 4568.3 samples/s | 71.4 steps/s
[Step=20400 Epoch=39.8] | Loss=0.00460 | Reg=0.00362 | acc=1.0000 | L2-Norm=19.016 | L2-Norm(final)=2.497 | 4553.3 samples/s | 71.1 steps/s
[Step=20450 Epoch=39.9] | Loss=0.00449 | Reg=0.00361 | acc=0.9844 | L2-Norm=19.012 | L2-Norm(final)=2.498 | 4645.2 samples/s | 72.6 steps/s
[Step=20500 Epoch=40.0] | Loss=0.00441 | Reg=0.00361 | acc=1.0000 | L2-Norm=19.009 | L2-Norm(final)=2.500 | 5610.7 samples/s | 87.7 steps/s
[Step=20550 Epoch=40.1] | Loss=0.00452 | Reg=0.00361 | acc=0.9688 | L2-Norm=19.006 | L2-Norm(final)=2.501 | 1902.0 samples/s | 29.7 steps/s
[Step=20600 Epoch=40.2] | Loss=0.00440 | Reg=0.00361 | acc=1.0000 | L2-Norm=19.002 | L2-Norm(final)=2.502 | 4430.3 samples/s | 69.2 steps/s
[Step=20650 Epoch=40.3] | Loss=0.00446 | Reg=0.00361 | acc=1.0000 | L2-Norm=18.999 | L2-Norm(final)=2.503 | 4301.7 samples/s | 67.2 steps/s
[Step=20700 Epoch=40.4] | Loss=0.00442 | Reg=0.00361 | acc=1.0000 | L2-Norm=18.995 | L2-Norm(final)=2.504 | 4355.8 samples/s | 68.1 steps/s
[Step=20750 Epoch=40.5] | Loss=0.00447 | Reg=0.00361 | acc=1.0000 | L2-Norm=18.991 | L2-Norm(final)=2.505 | 4563.7 samples/s | 71.3 steps/s
[Step=20800 Epoch=40.6] | Loss=0.00435 | Reg=0.00361 | acc=0.9844 | L2-Norm=18.987 | L2-Norm(final)=2.506 | 4791.8 samples/s | 74.9 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step20800.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00025, len=1
[Step=20001 Epoch=39.1] | Loss=0.00110 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.816 | L2-Norm(final)=2.382 | 3919.0 samples/s | 61.2 steps/s
[Step=20050 Epoch=39.2] | Loss=0.00261 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.814 | L2-Norm(final)=2.385 | 4299.0 samples/s | 67.2 steps/s
[Step=20100 Epoch=39.3] | Loss=0.00335 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.813 | L2-Norm(final)=2.387 | 4546.2 samples/s | 71.0 steps/s
[Step=20150 Epoch=39.4] | Loss=0.00346 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.811 | L2-Norm(final)=2.387 | 4523.7 samples/s | 70.7 steps/s
[Step=20200 Epoch=39.5] | Loss=0.00386 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.808 | L2-Norm(final)=2.387 | 4647.8 samples/s | 72.6 steps/s
[Step=20250 Epoch=39.6] | Loss=0.00394 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.805 | L2-Norm(final)=2.387 | 4426.7 samples/s | 69.2 steps/s
[Step=20300 Epoch=39.7] | Loss=0.00376 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.802 | L2-Norm(final)=2.386 | 4477.4 samples/s | 70.0 steps/s
[Step=20350 Epoch=39.8] | Loss=0.00392 | Reg=0.00353 | acc=0.9844 | L2-Norm=18.798 | L2-Norm(final)=2.386 | 4483.8 samples/s | 70.1 steps/s
[Step=20400 Epoch=39.9] | Loss=0.00398 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.795 | L2-Norm(final)=2.385 | 4549.8 samples/s | 71.1 steps/s
[Step=20450 Epoch=40.0] | Loss=0.00397 | Reg=0.00353 | acc=0.9844 | L2-Norm=18.792 | L2-Norm(final)=2.386 | 4586.1 samples/s | 71.7 steps/s
[Step=20500 Epoch=40.1] | Loss=0.00414 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.789 | L2-Norm(final)=2.386 | 5481.7 samples/s | 85.7 steps/s
[Step=20550 Epoch=40.2] | Loss=0.00405 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.786 | L2-Norm(final)=2.386 | 1907.3 samples/s | 29.8 steps/s
[Step=20600 Epoch=40.3] | Loss=0.00414 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.784 | L2-Norm(final)=2.387 | 4427.9 samples/s | 69.2 steps/s
[Step=20650 Epoch=40.4] | Loss=0.00412 | Reg=0.00353 | acc=0.9844 | L2-Norm=18.781 | L2-Norm(final)=2.387 | 4366.2 samples/s | 68.2 steps/s
[Step=20700 Epoch=40.5] | Loss=0.00414 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.779 | L2-Norm(final)=2.388 | 4434.5 samples/s | 69.3 steps/s
[Step=20750 Epoch=40.6] | Loss=0.00422 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.776 | L2-Norm(final)=2.388 | 4479.0 samples/s | 70.0 steps/s
[Step=20800 Epoch=40.7] | Loss=0.00433 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.774 | L2-Norm(final)=2.388 | 4448.9 samples/s | 69.5 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step20800.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00025, len=1
[Step=20001 Epoch=76.6] | Loss=0.00000 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.221 | L2-Norm(final)=7.723 | 4054.5 samples/s | 63.4 steps/s
[Step=20050 Epoch=76.8] | Loss=0.00000 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.210 | L2-Norm(final)=7.726 | 3805.3 samples/s | 59.5 steps/s
[Step=20100 Epoch=77.0] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.199 | L2-Norm(final)=7.728 | 4379.9 samples/s | 68.4 steps/s
[Step=20150 Epoch=77.2] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.189 | L2-Norm(final)=7.731 | 4243.4 samples/s | 66.3 steps/s
[Step=20200 Epoch=77.4] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.178 | L2-Norm(final)=7.734 | 4266.8 samples/s | 66.7 steps/s
[Step=20250 Epoch=77.6] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.167 | L2-Norm(final)=7.737 | 5473.1 samples/s | 85.5 steps/s
[Step=20300 Epoch=77.8] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.156 | L2-Norm(final)=7.740 | 1829.9 samples/s | 28.6 steps/s
[Step=20350 Epoch=78.0] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.145 | L2-Norm(final)=7.743 | 4275.7 samples/s | 66.8 steps/s
[Step=20400 Epoch=78.2] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.134 | L2-Norm(final)=7.746 | 4286.4 samples/s | 67.0 steps/s
[Step=20450 Epoch=78.4] | Loss=0.00000 | Reg=0.00037 | acc=1.0000 | L2-Norm=6.123 | L2-Norm(final)=7.749 | 4259.9 samples/s | 66.6 steps/s
[Step=20500 Epoch=78.5] | Loss=0.00000 | Reg=0.00037 | acc=1.0000 | L2-Norm=6.111 | L2-Norm(final)=7.752 | 4626.1 samples/s | 72.3 steps/s
[Step=20550 Epoch=78.7] | Loss=0.00000 | Reg=0.00037 | acc=1.0000 | L2-Norm=6.100 | L2-Norm(final)=7.755 | 1890.3 samples/s | 29.5 steps/s
[Step=20600 Epoch=78.9] | Loss=0.00000 | Reg=0.00037 | acc=1.0000 | L2-Norm=6.089 | L2-Norm(final)=7.758 | 4227.8 samples/s | 66.1 steps/s
[Step=20650 Epoch=79.1] | Loss=0.00000 | Reg=0.00037 | acc=1.0000 | L2-Norm=6.078 | L2-Norm(final)=7.762 | 4269.0 samples/s | 66.7 steps/s
[Step=20700 Epoch=79.3] | Loss=0.00000 | Reg=0.00037 | acc=1.0000 | L2-Norm=6.067 | L2-Norm(final)=7.765 | 4252.7 samples/s | 66.4 steps/s
[Step=20750 Epoch=79.5] | Loss=0.00000 | Reg=0.00037 | acc=1.0000 | L2-Norm=6.056 | L2-Norm(final)=7.768 | 4246.5 samples/s | 66.4 steps/s
[Step=20800 Epoch=79.7] | Loss=0.00000 | Reg=0.00037 | acc=1.0000 | L2-Norm=6.045 | L2-Norm(final)=7.772 | 1999.0 samples/s | 31.2 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step20800.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00025, len=1
[Step=20001 Epoch=77.0] | Loss=0.00001 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.931 | L2-Norm(final)=4.557 | 3812.6 samples/s | 59.6 steps/s
[Step=20050 Epoch=77.2] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.929 | L2-Norm(final)=4.559 | 4140.4 samples/s | 64.7 steps/s
[Step=20100 Epoch=77.4] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.927 | L2-Norm(final)=4.562 | 4326.3 samples/s | 67.6 steps/s
[Step=20150 Epoch=77.6] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.926 | L2-Norm(final)=4.564 | 4128.9 samples/s | 64.5 steps/s
[Step=20200 Epoch=77.8] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.924 | L2-Norm(final)=4.566 | 4281.1 samples/s | 66.9 steps/s
[Step=20250 Epoch=78.0] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.922 | L2-Norm(final)=4.568 | 5267.7 samples/s | 82.3 steps/s
[Step=20300 Epoch=78.1] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.920 | L2-Norm(final)=4.570 | 1811.2 samples/s | 28.3 steps/s
[Step=20350 Epoch=78.3] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.918 | L2-Norm(final)=4.571 | 4250.4 samples/s | 66.4 steps/s
[Step=20400 Epoch=78.5] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.916 | L2-Norm(final)=4.573 | 4267.0 samples/s | 66.7 steps/s
[Step=20450 Epoch=78.7] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.915 | L2-Norm(final)=4.575 | 4180.8 samples/s | 65.3 steps/s
[Step=20500 Epoch=78.9] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.913 | L2-Norm(final)=4.577 | 4696.2 samples/s | 73.4 steps/s
[Step=20550 Epoch=79.1] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.911 | L2-Norm(final)=4.579 | 1890.8 samples/s | 29.5 steps/s
[Step=20600 Epoch=79.3] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.909 | L2-Norm(final)=4.581 | 4166.5 samples/s | 65.1 steps/s
[Step=20650 Epoch=79.5] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.907 | L2-Norm(final)=4.583 | 4224.6 samples/s | 66.0 steps/s
[Step=20700 Epoch=79.7] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.905 | L2-Norm(final)=4.585 | 4187.6 samples/s | 65.4 steps/s
[Step=20750 Epoch=79.9] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.903 | L2-Norm(final)=4.588 | 4268.5 samples/s | 66.7 steps/s
[Step=20800 Epoch=80.1] | Loss=0.00000 | Reg=0.00035 | acc=1.0000 | L2-Norm=5.901 | L2-Norm(final)=4.590 | 1941.3 samples/s | 30.3 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step20800.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.18204 | acc=0.9580 | tpr=0.9681 | fpr=0.0639 | 3933.3 samples/s | 15.4 steps/s
Avg test loss: 0.19048, Avg test acc: 0.95649, Avg tpr: 0.96754, Avg fpr: 0.06781, total FA: 529

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.15625 | acc=0.9582 | tpr=0.9683 | fpr=0.0637 | 4182.2 samples/s | 16.3 steps/s
Avg test loss: 0.16331, Avg test acc: 0.95717, Avg tpr: 0.96876, Avg fpr: 0.06832, total FA: 533

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.71946 | acc=0.3144 | tpr=0.0080 | fpr=0.0203 | 4260.8 samples/s | 16.6 steps/s
Avg test loss: 4.72972, Avg test acc: 0.31172, Avg tpr: 0.00729, Avg fpr: 0.01872, total FA: 146

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.91311 | acc=0.3149 | tpr=0.0035 | fpr=0.0089 | 4306.3 samples/s | 16.8 steps/s
Avg test loss: 5.94515, Avg test acc: 0.31273, Avg tpr: 0.00379, Avg fpr: 0.00782, total FA: 61

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.17578 | acc=0.1767 | tpr=0.7566 | fpr=0.8337 | 4129.6 samples/s | 16.1 steps/s
[Step= 100] | Loss=7.13736 | acc=0.1762 | tpr=0.7292 | fpr=0.8341 | 7720.8 samples/s | 30.2 steps/s
[Step= 150] | Loss=7.18038 | acc=0.1755 | tpr=0.7363 | fpr=0.8348 | 8045.9 samples/s | 31.4 steps/s
[Step= 200] | Loss=7.16709 | acc=0.1754 | tpr=0.7224 | fpr=0.8345 | 7475.3 samples/s | 29.2 steps/s
[Step= 250] | Loss=7.18410 | acc=0.1751 | tpr=0.7240 | fpr=0.8349 | 8096.2 samples/s | 31.6 steps/s
[Step= 300] | Loss=7.19136 | acc=0.1744 | tpr=0.7265 | fpr=0.8357 | 7880.7 samples/s | 30.8 steps/s
[Step= 350] | Loss=7.18821 | acc=0.1748 | tpr=0.7257 | fpr=0.8352 | 7694.7 samples/s | 30.1 steps/s
[Step= 400] | Loss=7.19012 | acc=0.1752 | tpr=0.7270 | fpr=0.8349 | 7942.6 samples/s | 31.0 steps/s
[Step= 450] | Loss=7.19319 | acc=0.1745 | tpr=0.7283 | fpr=0.8355 | 7518.5 samples/s | 29.4 steps/s
[Step= 500] | Loss=7.20012 | acc=0.1740 | tpr=0.7269 | fpr=0.8359 | 8173.5 samples/s | 31.9 steps/s
[Step= 550] | Loss=7.19914 | acc=0.1742 | tpr=0.7258 | fpr=0.8358 | 13072.2 samples/s | 51.1 steps/s
Avg test loss: 7.20258, Avg test acc: 0.17412, Avg tpr: 0.72583, Avg fpr: 0.83591, total FA: 116064

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=8.19732 | acc=0.1571 | tpr=0.7212 | fpr=0.8530 | 4083.0 samples/s | 15.9 steps/s
[Step= 100] | Loss=8.14795 | acc=0.1570 | tpr=0.7058 | fpr=0.8532 | 7692.0 samples/s | 30.0 steps/s
[Step= 150] | Loss=8.16033 | acc=0.1582 | tpr=0.7061 | fpr=0.8519 | 7565.4 samples/s | 29.6 steps/s
[Step= 200] | Loss=8.13591 | acc=0.1590 | tpr=0.7016 | fpr=0.8509 | 7606.5 samples/s | 29.7 steps/s
[Step= 250] | Loss=8.13532 | acc=0.1586 | tpr=0.6952 | fpr=0.8512 | 7867.9 samples/s | 30.7 steps/s
[Step= 300] | Loss=8.13972 | acc=0.1585 | tpr=0.6924 | fpr=0.8512 | 7680.1 samples/s | 30.0 steps/s
[Step= 350] | Loss=8.13547 | acc=0.1584 | tpr=0.6982 | fpr=0.8514 | 7623.5 samples/s | 29.8 steps/s
[Step= 400] | Loss=8.13153 | acc=0.1585 | tpr=0.7035 | fpr=0.8514 | 7235.8 samples/s | 28.3 steps/s
[Step= 450] | Loss=8.14010 | acc=0.1580 | tpr=0.7030 | fpr=0.8519 | 7198.4 samples/s | 28.1 steps/s
[Step= 500] | Loss=8.15084 | acc=0.1574 | tpr=0.7053 | fpr=0.8525 | 7472.2 samples/s | 29.2 steps/s
[Step= 550] | Loss=8.15171 | acc=0.1572 | tpr=0.6984 | fpr=0.8526 | 13239.3 samples/s | 51.7 steps/s
Avg test loss: 8.15377, Avg test acc: 0.15710, Avg tpr: 0.69849, Avg fpr: 0.85274, total FA: 118401

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08779 | acc=0.9825 | tpr=0.9602 | fpr=0.0171 | 4086.9 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.09053 | acc=0.9822 | tpr=0.9659 | fpr=0.0175 | 7428.0 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.09507 | acc=0.9814 | tpr=0.9611 | fpr=0.0182 | 7568.7 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.09526 | acc=0.9817 | tpr=0.9650 | fpr=0.0180 | 7625.9 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.09469 | acc=0.9819 | tpr=0.9616 | fpr=0.0178 | 7331.4 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.09506 | acc=0.9819 | tpr=0.9622 | fpr=0.0178 | 7379.6 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.09519 | acc=0.9819 | tpr=0.9631 | fpr=0.0178 | 7368.4 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.09618 | acc=0.9815 | tpr=0.9595 | fpr=0.0181 | 7562.3 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.09772 | acc=0.9812 | tpr=0.9576 | fpr=0.0183 | 7179.1 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.09746 | acc=0.9813 | tpr=0.9595 | fpr=0.0183 | 7578.4 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.09694 | acc=0.9815 | tpr=0.9586 | fpr=0.0181 | 13363.7 samples/s | 52.2 steps/s
Avg test loss: 0.09683, Avg test acc: 0.98147, Avg tpr: 0.95880, Avg fpr: 0.01811, total FA: 2515

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13610 | acc=0.9791 | tpr=0.9469 | fpr=0.0203 | 4005.1 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.14343 | acc=0.9784 | tpr=0.9616 | fpr=0.0213 | 7906.5 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.14852 | acc=0.9777 | tpr=0.9625 | fpr=0.0221 | 7322.2 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.14918 | acc=0.9778 | tpr=0.9650 | fpr=0.0220 | 7311.9 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.14784 | acc=0.9780 | tpr=0.9677 | fpr=0.0218 | 8048.7 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.15036 | acc=0.9778 | tpr=0.9673 | fpr=0.0220 | 7308.1 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.15082 | acc=0.9778 | tpr=0.9662 | fpr=0.0220 | 7835.7 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.15232 | acc=0.9775 | tpr=0.9650 | fpr=0.0222 | 7951.9 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.15507 | acc=0.9772 | tpr=0.9630 | fpr=0.0225 | 7675.4 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.15400 | acc=0.9773 | tpr=0.9643 | fpr=0.0225 | 7778.8 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.15278 | acc=0.9775 | tpr=0.9650 | fpr=0.0222 | 14091.4 samples/s | 55.0 steps/s
Avg test loss: 0.15247, Avg test acc: 0.97756, Avg tpr: 0.96474, Avg fpr: 0.02220, total FA: 3083

server round 26/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00025, len=1
[Step=20801 Epoch=40.6] | Loss=0.00405 | Reg=0.00358 | acc=1.0000 | L2-Norm=18.927 | L2-Norm(final)=2.525 | 3687.8 samples/s | 57.6 steps/s
[Step=20850 Epoch=40.7] | Loss=0.00340 | Reg=0.00358 | acc=1.0000 | L2-Norm=18.923 | L2-Norm(final)=2.527 | 4396.9 samples/s | 68.7 steps/s
[Step=20900 Epoch=40.8] | Loss=0.00325 | Reg=0.00358 | acc=1.0000 | L2-Norm=18.919 | L2-Norm(final)=2.526 | 4493.2 samples/s | 70.2 steps/s
[Step=20950 Epoch=40.9] | Loss=0.00355 | Reg=0.00358 | acc=1.0000 | L2-Norm=18.915 | L2-Norm(final)=2.526 | 4560.4 samples/s | 71.3 steps/s
[Step=21000 Epoch=41.0] | Loss=0.00403 | Reg=0.00358 | acc=1.0000 | L2-Norm=18.911 | L2-Norm(final)=2.526 | 4636.7 samples/s | 72.4 steps/s
[Step=21050 Epoch=41.1] | Loss=0.00396 | Reg=0.00357 | acc=1.0000 | L2-Norm=18.907 | L2-Norm(final)=2.526 | 4626.9 samples/s | 72.3 steps/s
[Step=21100 Epoch=41.2] | Loss=0.00419 | Reg=0.00357 | acc=1.0000 | L2-Norm=18.904 | L2-Norm(final)=2.527 | 4649.4 samples/s | 72.6 steps/s
[Step=21150 Epoch=41.3] | Loss=0.00460 | Reg=0.00357 | acc=1.0000 | L2-Norm=18.901 | L2-Norm(final)=2.527 | 4556.9 samples/s | 71.2 steps/s
[Step=21200 Epoch=41.3] | Loss=0.00457 | Reg=0.00357 | acc=0.9844 | L2-Norm=18.898 | L2-Norm(final)=2.527 | 4528.2 samples/s | 70.8 steps/s
[Step=21250 Epoch=41.4] | Loss=0.00459 | Reg=0.00357 | acc=1.0000 | L2-Norm=18.895 | L2-Norm(final)=2.528 | 4606.8 samples/s | 72.0 steps/s
[Step=21300 Epoch=41.5] | Loss=0.00459 | Reg=0.00357 | acc=1.0000 | L2-Norm=18.892 | L2-Norm(final)=2.529 | 5657.0 samples/s | 88.4 steps/s
[Step=21350 Epoch=41.6] | Loss=0.00445 | Reg=0.00357 | acc=1.0000 | L2-Norm=18.889 | L2-Norm(final)=2.530 | 1873.1 samples/s | 29.3 steps/s
[Step=21400 Epoch=41.7] | Loss=0.00439 | Reg=0.00357 | acc=1.0000 | L2-Norm=18.886 | L2-Norm(final)=2.531 | 4492.1 samples/s | 70.2 steps/s
[Step=21450 Epoch=41.8] | Loss=0.00434 | Reg=0.00357 | acc=0.9844 | L2-Norm=18.883 | L2-Norm(final)=2.533 | 4579.7 samples/s | 71.6 steps/s
[Step=21500 Epoch=41.9] | Loss=0.00446 | Reg=0.00356 | acc=0.9844 | L2-Norm=18.879 | L2-Norm(final)=2.534 | 4639.1 samples/s | 72.5 steps/s
[Step=21550 Epoch=42.0] | Loss=0.00456 | Reg=0.00356 | acc=1.0000 | L2-Norm=18.876 | L2-Norm(final)=2.534 | 4678.2 samples/s | 73.1 steps/s
[Step=21600 Epoch=42.1] | Loss=0.00454 | Reg=0.00356 | acc=1.0000 | L2-Norm=18.873 | L2-Norm(final)=2.535 | 4583.6 samples/s | 71.6 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step21600.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00025, len=1
[Step=20801 Epoch=40.7] | Loss=0.00001 | Reg=0.00351 | acc=1.0000 | L2-Norm=18.735 | L2-Norm(final)=2.388 | 3858.0 samples/s | 60.3 steps/s
[Step=20850 Epoch=40.8] | Loss=0.00377 | Reg=0.00351 | acc=1.0000 | L2-Norm=18.732 | L2-Norm(final)=2.386 | 4594.7 samples/s | 71.8 steps/s
[Step=20900 Epoch=40.9] | Loss=0.00379 | Reg=0.00351 | acc=1.0000 | L2-Norm=18.731 | L2-Norm(final)=2.390 | 4661.7 samples/s | 72.8 steps/s
[Step=20950 Epoch=41.0] | Loss=0.00353 | Reg=0.00351 | acc=0.9688 | L2-Norm=18.729 | L2-Norm(final)=2.391 | 4524.4 samples/s | 70.7 steps/s
[Step=21000 Epoch=41.1] | Loss=0.00404 | Reg=0.00351 | acc=1.0000 | L2-Norm=18.727 | L2-Norm(final)=2.391 | 4346.5 samples/s | 67.9 steps/s
[Step=21050 Epoch=41.2] | Loss=0.00408 | Reg=0.00351 | acc=1.0000 | L2-Norm=18.724 | L2-Norm(final)=2.391 | 4487.7 samples/s | 70.1 steps/s
[Step=21100 Epoch=41.2] | Loss=0.00413 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.721 | L2-Norm(final)=2.392 | 4525.2 samples/s | 70.7 steps/s
[Step=21150 Epoch=41.3] | Loss=0.00392 | Reg=0.00350 | acc=0.9844 | L2-Norm=18.718 | L2-Norm(final)=2.393 | 4530.7 samples/s | 70.8 steps/s
[Step=21200 Epoch=41.4] | Loss=0.00395 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.716 | L2-Norm(final)=2.394 | 4513.3 samples/s | 70.5 steps/s
[Step=21250 Epoch=41.5] | Loss=0.00377 | Reg=0.00350 | acc=0.9844 | L2-Norm=18.713 | L2-Norm(final)=2.395 | 4468.6 samples/s | 69.8 steps/s
[Step=21300 Epoch=41.6] | Loss=0.00400 | Reg=0.00350 | acc=0.9844 | L2-Norm=18.710 | L2-Norm(final)=2.396 | 5518.0 samples/s | 86.2 steps/s
[Step=21350 Epoch=41.7] | Loss=0.00392 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.707 | L2-Norm(final)=2.396 | 1862.4 samples/s | 29.1 steps/s
[Step=21400 Epoch=41.8] | Loss=0.00386 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.704 | L2-Norm(final)=2.397 | 4420.3 samples/s | 69.1 steps/s
[Step=21450 Epoch=41.9] | Loss=0.00387 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.701 | L2-Norm(final)=2.397 | 4457.6 samples/s | 69.6 steps/s
[Step=21500 Epoch=42.0] | Loss=0.00384 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.698 | L2-Norm(final)=2.398 | 4494.3 samples/s | 70.2 steps/s
[Step=21550 Epoch=42.1] | Loss=0.00377 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.695 | L2-Norm(final)=2.399 | 4453.6 samples/s | 69.6 steps/s
[Step=21600 Epoch=42.2] | Loss=0.00378 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.691 | L2-Norm(final)=2.399 | 4611.8 samples/s | 72.1 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step21600.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00025, len=1
[Step=20801 Epoch=79.7] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.868 | L2-Norm(final)=7.828 | 3982.5 samples/s | 62.2 steps/s
[Step=20850 Epoch=79.9] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.857 | L2-Norm(final)=7.831 | 4196.1 samples/s | 65.6 steps/s
[Step=20900 Epoch=80.1] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.846 | L2-Norm(final)=7.834 | 4405.7 samples/s | 68.8 steps/s
[Step=20950 Epoch=80.3] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.835 | L2-Norm(final)=7.838 | 4355.4 samples/s | 68.1 steps/s
[Step=21000 Epoch=80.5] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.824 | L2-Norm(final)=7.842 | 4140.0 samples/s | 64.7 steps/s
[Step=21050 Epoch=80.7] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.813 | L2-Norm(final)=7.846 | 5320.0 samples/s | 83.1 steps/s
[Step=21100 Epoch=80.8] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.802 | L2-Norm(final)=7.850 | 1848.2 samples/s | 28.9 steps/s
[Step=21150 Epoch=81.0] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.791 | L2-Norm(final)=7.855 | 4270.0 samples/s | 66.7 steps/s
[Step=21200 Epoch=81.2] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.780 | L2-Norm(final)=7.859 | 4188.4 samples/s | 65.4 steps/s
[Step=21250 Epoch=81.4] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.769 | L2-Norm(final)=7.863 | 4155.1 samples/s | 64.9 steps/s
[Step=21300 Epoch=81.6] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.758 | L2-Norm(final)=7.867 | 4699.8 samples/s | 73.4 steps/s
[Step=21350 Epoch=81.8] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.747 | L2-Norm(final)=7.872 | 1909.1 samples/s | 29.8 steps/s
[Step=21400 Epoch=82.0] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.736 | L2-Norm(final)=7.876 | 4282.6 samples/s | 66.9 steps/s
[Step=21450 Epoch=82.2] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.725 | L2-Norm(final)=7.880 | 4225.5 samples/s | 66.0 steps/s
[Step=21500 Epoch=82.4] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.714 | L2-Norm(final)=7.884 | 4229.8 samples/s | 66.1 steps/s
[Step=21550 Epoch=82.6] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.702 | L2-Norm(final)=7.888 | 4243.2 samples/s | 66.3 steps/s
[Step=21600 Epoch=82.8] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.691 | L2-Norm(final)=7.892 | 1908.0 samples/s | 29.8 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step21600.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00025, len=1
[Step=20801 Epoch=80.1] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.869 | L2-Norm(final)=4.624 | 3832.6 samples/s | 59.9 steps/s
[Step=20850 Epoch=80.3] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.867 | L2-Norm(final)=4.626 | 3878.4 samples/s | 60.6 steps/s
[Step=20900 Epoch=80.5] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.864 | L2-Norm(final)=4.629 | 4274.7 samples/s | 66.8 steps/s
[Step=20950 Epoch=80.6] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.862 | L2-Norm(final)=4.631 | 4215.2 samples/s | 65.9 steps/s
[Step=21000 Epoch=80.8] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.860 | L2-Norm(final)=4.633 | 4226.2 samples/s | 66.0 steps/s
[Step=21050 Epoch=81.0] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.857 | L2-Norm(final)=4.636 | 5418.4 samples/s | 84.7 steps/s
[Step=21100 Epoch=81.2] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.855 | L2-Norm(final)=4.638 | 1824.8 samples/s | 28.5 steps/s
[Step=21150 Epoch=81.4] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.853 | L2-Norm(final)=4.641 | 4202.5 samples/s | 65.7 steps/s
[Step=21200 Epoch=81.6] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.850 | L2-Norm(final)=4.643 | 4200.9 samples/s | 65.6 steps/s
[Step=21250 Epoch=81.8] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.848 | L2-Norm(final)=4.646 | 4307.8 samples/s | 67.3 steps/s
[Step=21300 Epoch=82.0] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.845 | L2-Norm(final)=4.648 | 4910.0 samples/s | 76.7 steps/s
[Step=21350 Epoch=82.2] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.843 | L2-Norm(final)=4.651 | 1908.3 samples/s | 29.8 steps/s
[Step=21400 Epoch=82.4] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.840 | L2-Norm(final)=4.654 | 4303.4 samples/s | 67.2 steps/s
[Step=21450 Epoch=82.6] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.838 | L2-Norm(final)=4.657 | 4192.1 samples/s | 65.5 steps/s
[Step=21500 Epoch=82.8] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.836 | L2-Norm(final)=4.659 | 4231.0 samples/s | 66.1 steps/s
[Step=21550 Epoch=83.0] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.833 | L2-Norm(final)=4.662 | 4298.2 samples/s | 67.2 steps/s
[Step=21600 Epoch=83.1] | Loss=0.00000 | Reg=0.00034 | acc=1.0000 | L2-Norm=5.830 | L2-Norm(final)=4.665 | 1945.8 samples/s | 30.4 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step21600.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.17473 | acc=0.9587 | tpr=0.9732 | fpr=0.0728 | 4050.4 samples/s | 15.8 steps/s
Avg test loss: 0.18197, Avg test acc: 0.95709, Avg tpr: 0.97138, Avg fpr: 0.07435, total FA: 580

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.16953 | acc=0.9591 | tpr=0.9720 | fpr=0.0691 | 3985.1 samples/s | 15.6 steps/s
Avg test loss: 0.17516, Avg test acc: 0.95869, Avg tpr: 0.97220, Avg fpr: 0.07102, total FA: 554

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.84635 | acc=0.3143 | tpr=0.0072 | fpr=0.0188 | 4173.0 samples/s | 16.3 steps/s
Avg test loss: 4.85830, Avg test acc: 0.31184, Avg tpr: 0.00664, Avg fpr: 0.01692, total FA: 132

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.88975 | acc=0.3149 | tpr=0.0038 | fpr=0.0094 | 4091.0 samples/s | 16.0 steps/s
Avg test loss: 5.92161, Avg test acc: 0.31269, Avg tpr: 0.00408, Avg fpr: 0.00859, total FA: 67

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.27626 | acc=0.1588 | tpr=0.8097 | fpr=0.8530 | 4245.0 samples/s | 16.6 steps/s
[Step= 100] | Loss=7.24367 | acc=0.1588 | tpr=0.7868 | fpr=0.8529 | 7817.4 samples/s | 30.5 steps/s
[Step= 150] | Loss=7.29112 | acc=0.1576 | tpr=0.7939 | fpr=0.8541 | 7532.1 samples/s | 29.4 steps/s
[Step= 200] | Loss=7.28009 | acc=0.1574 | tpr=0.7847 | fpr=0.8541 | 7923.5 samples/s | 31.0 steps/s
[Step= 250] | Loss=7.29837 | acc=0.1573 | tpr=0.7825 | fpr=0.8541 | 7619.6 samples/s | 29.8 steps/s
[Step= 300] | Loss=7.30649 | acc=0.1565 | tpr=0.7825 | fpr=0.8549 | 8055.3 samples/s | 31.5 steps/s
[Step= 350] | Loss=7.30461 | acc=0.1567 | tpr=0.7815 | fpr=0.8546 | 7715.1 samples/s | 30.1 steps/s
[Step= 400] | Loss=7.30650 | acc=0.1571 | tpr=0.7834 | fpr=0.8543 | 7744.0 samples/s | 30.3 steps/s
[Step= 450] | Loss=7.30891 | acc=0.1567 | tpr=0.7833 | fpr=0.8547 | 7797.8 samples/s | 30.5 steps/s
[Step= 500] | Loss=7.31598 | acc=0.1562 | tpr=0.7850 | fpr=0.8551 | 7467.3 samples/s | 29.2 steps/s
[Step= 550] | Loss=7.31643 | acc=0.1563 | tpr=0.7827 | fpr=0.8551 | 14053.3 samples/s | 54.9 steps/s
Avg test loss: 7.31957, Avg test acc: 0.15610, Avg tpr: 0.78249, Avg fpr: 0.85529, total FA: 118755

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=9.01099 | acc=0.1459 | tpr=0.7655 | fpr=0.8653 | 4102.7 samples/s | 16.0 steps/s
[Step= 100] | Loss=8.96199 | acc=0.1447 | tpr=0.7505 | fpr=0.8666 | 7373.7 samples/s | 28.8 steps/s
[Step= 150] | Loss=8.97032 | acc=0.1464 | tpr=0.7421 | fpr=0.8645 | 7620.0 samples/s | 29.8 steps/s
[Step= 200] | Loss=8.94352 | acc=0.1468 | tpr=0.7344 | fpr=0.8639 | 7984.5 samples/s | 31.2 steps/s
[Step= 250] | Loss=8.94705 | acc=0.1466 | tpr=0.7284 | fpr=0.8640 | 7842.4 samples/s | 30.6 steps/s
[Step= 300] | Loss=8.95288 | acc=0.1462 | tpr=0.7287 | fpr=0.8644 | 7405.7 samples/s | 28.9 steps/s
[Step= 350] | Loss=8.94979 | acc=0.1459 | tpr=0.7307 | fpr=0.8647 | 7584.8 samples/s | 29.6 steps/s
[Step= 400] | Loss=8.94344 | acc=0.1460 | tpr=0.7391 | fpr=0.8648 | 7480.1 samples/s | 29.2 steps/s
[Step= 450] | Loss=8.95349 | acc=0.1457 | tpr=0.7371 | fpr=0.8650 | 7309.0 samples/s | 28.6 steps/s
[Step= 500] | Loss=8.96762 | acc=0.1450 | tpr=0.7388 | fpr=0.8658 | 7496.3 samples/s | 29.3 steps/s
[Step= 550] | Loss=8.96836 | acc=0.1451 | tpr=0.7342 | fpr=0.8656 | 14044.9 samples/s | 54.9 steps/s
Avg test loss: 8.97057, Avg test acc: 0.14499, Avg tpr: 0.73455, Avg fpr: 0.86572, total FA: 120204

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08850 | acc=0.9823 | tpr=0.9602 | fpr=0.0173 | 3894.7 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.09147 | acc=0.9821 | tpr=0.9638 | fpr=0.0175 | 7554.5 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.09614 | acc=0.9813 | tpr=0.9582 | fpr=0.0182 | 7287.0 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.09639 | acc=0.9817 | tpr=0.9628 | fpr=0.0180 | 7973.4 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.09576 | acc=0.9819 | tpr=0.9598 | fpr=0.0177 | 7604.2 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.09619 | acc=0.9819 | tpr=0.9607 | fpr=0.0177 | 7424.8 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.09631 | acc=0.9819 | tpr=0.9618 | fpr=0.0178 | 8156.9 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.09727 | acc=0.9815 | tpr=0.9579 | fpr=0.0180 | 7129.7 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.09885 | acc=0.9813 | tpr=0.9562 | fpr=0.0183 | 7307.2 samples/s | 28.5 steps/s
[Step= 500] | Loss=0.09862 | acc=0.9814 | tpr=0.9581 | fpr=0.0182 | 7511.9 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.09810 | acc=0.9816 | tpr=0.9566 | fpr=0.0180 | 12842.9 samples/s | 50.2 steps/s
Avg test loss: 0.09798, Avg test acc: 0.98157, Avg tpr: 0.95681, Avg fpr: 0.01798, total FA: 2497

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14014 | acc=0.9787 | tpr=0.9513 | fpr=0.0208 | 3965.2 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.14775 | acc=0.9778 | tpr=0.9638 | fpr=0.0219 | 7617.9 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.15294 | acc=0.9771 | tpr=0.9640 | fpr=0.0226 | 7746.2 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.15363 | acc=0.9773 | tpr=0.9661 | fpr=0.0225 | 7833.0 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.15228 | acc=0.9775 | tpr=0.9686 | fpr=0.0224 | 7760.1 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.15486 | acc=0.9773 | tpr=0.9680 | fpr=0.0225 | 7883.7 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.15533 | acc=0.9773 | tpr=0.9668 | fpr=0.0225 | 7731.2 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.15687 | acc=0.9770 | tpr=0.9661 | fpr=0.0228 | 7747.1 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.15967 | acc=0.9767 | tpr=0.9645 | fpr=0.0231 | 7717.8 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.15857 | acc=0.9768 | tpr=0.9656 | fpr=0.0230 | 7695.8 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.15732 | acc=0.9770 | tpr=0.9666 | fpr=0.0228 | 13944.8 samples/s | 54.5 steps/s
Avg test loss: 0.15700, Avg test acc: 0.97703, Avg tpr: 0.96632, Avg fpr: 0.02277, total FA: 3162

server round 27/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00025, len=1
[Step=21601 Epoch=42.1] | Loss=0.00000 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.825 | L2-Norm(final)=2.544 | 3881.2 samples/s | 60.6 steps/s
[Step=21650 Epoch=42.2] | Loss=0.00357 | Reg=0.00354 | acc=0.9844 | L2-Norm=18.822 | L2-Norm(final)=2.548 | 4362.9 samples/s | 68.2 steps/s
[Step=21700 Epoch=42.3] | Loss=0.00380 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.819 | L2-Norm(final)=2.550 | 4556.8 samples/s | 71.2 steps/s
[Step=21750 Epoch=42.4] | Loss=0.00389 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.815 | L2-Norm(final)=2.552 | 4565.1 samples/s | 71.3 steps/s
[Step=21800 Epoch=42.5] | Loss=0.00447 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.812 | L2-Norm(final)=2.552 | 4598.1 samples/s | 71.8 steps/s
[Step=21850 Epoch=42.6] | Loss=0.00485 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.808 | L2-Norm(final)=2.552 | 4561.6 samples/s | 71.3 steps/s
[Step=21900 Epoch=42.7] | Loss=0.00457 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.805 | L2-Norm(final)=2.551 | 4711.3 samples/s | 73.6 steps/s
[Step=21950 Epoch=42.8] | Loss=0.00452 | Reg=0.00354 | acc=0.9688 | L2-Norm=18.802 | L2-Norm(final)=2.551 | 4711.4 samples/s | 73.6 steps/s
[Step=22000 Epoch=42.9] | Loss=0.00447 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.800 | L2-Norm(final)=2.552 | 4519.6 samples/s | 70.6 steps/s
[Step=22050 Epoch=43.0] | Loss=0.00502 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.799 | L2-Norm(final)=2.553 | 4615.2 samples/s | 72.1 steps/s
[Step=22100 Epoch=43.1] | Loss=0.00511 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.799 | L2-Norm(final)=2.552 | 5493.2 samples/s | 85.8 steps/s
[Step=22150 Epoch=43.2] | Loss=0.00528 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.799 | L2-Norm(final)=2.552 | 1917.4 samples/s | 30.0 steps/s
[Step=22200 Epoch=43.3] | Loss=0.00509 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.800 | L2-Norm(final)=2.553 | 4557.8 samples/s | 71.2 steps/s
[Step=22250 Epoch=43.4] | Loss=0.00506 | Reg=0.00353 | acc=0.9844 | L2-Norm=18.800 | L2-Norm(final)=2.554 | 4542.6 samples/s | 71.0 steps/s
[Step=22300 Epoch=43.5] | Loss=0.00498 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.800 | L2-Norm(final)=2.555 | 4557.4 samples/s | 71.2 steps/s
[Step=22350 Epoch=43.6] | Loss=0.00499 | Reg=0.00353 | acc=0.9844 | L2-Norm=18.800 | L2-Norm(final)=2.555 | 4646.7 samples/s | 72.6 steps/s
[Step=22400 Epoch=43.7] | Loss=0.00484 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.799 | L2-Norm(final)=2.556 | 4534.6 samples/s | 70.9 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step22400.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00025, len=1
[Step=21601 Epoch=42.2] | Loss=0.00085 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.641 | L2-Norm(final)=2.410 | 3998.3 samples/s | 62.5 steps/s
[Step=21650 Epoch=42.3] | Loss=0.00348 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.638 | L2-Norm(final)=2.412 | 4465.2 samples/s | 69.8 steps/s
[Step=21700 Epoch=42.4] | Loss=0.00368 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.634 | L2-Norm(final)=2.411 | 4551.1 samples/s | 71.1 steps/s
[Step=21750 Epoch=42.5] | Loss=0.00343 | Reg=0.00347 | acc=0.9844 | L2-Norm=18.631 | L2-Norm(final)=2.412 | 4586.6 samples/s | 71.7 steps/s
[Step=21800 Epoch=42.6] | Loss=0.00312 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.628 | L2-Norm(final)=2.413 | 4649.5 samples/s | 72.6 steps/s
[Step=21850 Epoch=42.7] | Loss=0.00357 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.625 | L2-Norm(final)=2.415 | 4525.2 samples/s | 70.7 steps/s
[Step=21900 Epoch=42.8] | Loss=0.00352 | Reg=0.00347 | acc=0.9844 | L2-Norm=18.621 | L2-Norm(final)=2.415 | 4449.0 samples/s | 69.5 steps/s
[Step=21950 Epoch=42.9] | Loss=0.00368 | Reg=0.00347 | acc=0.9844 | L2-Norm=18.617 | L2-Norm(final)=2.414 | 4613.0 samples/s | 72.1 steps/s
[Step=22000 Epoch=43.0] | Loss=0.00370 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.614 | L2-Norm(final)=2.414 | 4589.0 samples/s | 71.7 steps/s
[Step=22050 Epoch=43.1] | Loss=0.00380 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.610 | L2-Norm(final)=2.414 | 4583.1 samples/s | 71.6 steps/s
[Step=22100 Epoch=43.2] | Loss=0.00382 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.606 | L2-Norm(final)=2.414 | 5630.3 samples/s | 88.0 steps/s
[Step=22150 Epoch=43.3] | Loss=0.00383 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.603 | L2-Norm(final)=2.415 | 1818.8 samples/s | 28.4 steps/s
[Step=22200 Epoch=43.4] | Loss=0.00366 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.599 | L2-Norm(final)=2.416 | 4403.7 samples/s | 68.8 steps/s
[Step=22250 Epoch=43.5] | Loss=0.00356 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.596 | L2-Norm(final)=2.417 | 4396.9 samples/s | 68.7 steps/s
[Step=22300 Epoch=43.6] | Loss=0.00368 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.592 | L2-Norm(final)=2.418 | 4448.5 samples/s | 69.5 steps/s
[Step=22350 Epoch=43.7] | Loss=0.00361 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.589 | L2-Norm(final)=2.419 | 4442.0 samples/s | 69.4 steps/s
[Step=22400 Epoch=43.8] | Loss=0.00366 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.585 | L2-Norm(final)=2.420 | 4439.3 samples/s | 69.4 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step22400.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00025, len=1
[Step=21601 Epoch=82.8] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.513 | L2-Norm(final)=7.964 | 4032.0 samples/s | 63.0 steps/s
[Step=21650 Epoch=83.0] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.502 | L2-Norm(final)=7.968 | 3894.6 samples/s | 60.9 steps/s
[Step=21700 Epoch=83.1] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.491 | L2-Norm(final)=7.974 | 4290.5 samples/s | 67.0 steps/s
[Step=21750 Epoch=83.3] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.480 | L2-Norm(final)=7.979 | 4392.2 samples/s | 68.6 steps/s
[Step=21800 Epoch=83.5] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.468 | L2-Norm(final)=7.984 | 4272.6 samples/s | 66.8 steps/s
[Step=21850 Epoch=83.7] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.457 | L2-Norm(final)=7.990 | 5383.0 samples/s | 84.1 steps/s
[Step=21900 Epoch=83.9] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.446 | L2-Norm(final)=7.995 | 1823.9 samples/s | 28.5 steps/s
[Step=21950 Epoch=84.1] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.434 | L2-Norm(final)=8.000 | 4316.5 samples/s | 67.4 steps/s
[Step=22000 Epoch=84.3] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.423 | L2-Norm(final)=8.005 | 4288.8 samples/s | 67.0 steps/s
[Step=22050 Epoch=84.5] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.411 | L2-Norm(final)=8.011 | 4224.1 samples/s | 66.0 steps/s
[Step=22100 Epoch=84.7] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.400 | L2-Norm(final)=8.016 | 4633.8 samples/s | 72.4 steps/s
[Step=22150 Epoch=84.9] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.389 | L2-Norm(final)=8.021 | 1908.9 samples/s | 29.8 steps/s
[Step=22200 Epoch=85.1] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.378 | L2-Norm(final)=8.027 | 4196.8 samples/s | 65.6 steps/s
[Step=22250 Epoch=85.3] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.366 | L2-Norm(final)=8.032 | 4257.8 samples/s | 66.5 steps/s
[Step=22300 Epoch=85.4] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.355 | L2-Norm(final)=8.038 | 4245.5 samples/s | 66.3 steps/s
[Step=22350 Epoch=85.6] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.344 | L2-Norm(final)=8.044 | 4278.7 samples/s | 66.9 steps/s
[Step=22400 Epoch=85.8] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.332 | L2-Norm(final)=8.049 | 1960.2 samples/s | 30.6 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step22400.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00025, len=1
[Step=21601 Epoch=83.2] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.788 | L2-Norm(final)=4.710 | 4040.8 samples/s | 63.1 steps/s
[Step=21650 Epoch=83.3] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.785 | L2-Norm(final)=4.713 | 3926.2 samples/s | 61.3 steps/s
[Step=21700 Epoch=83.5] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.782 | L2-Norm(final)=4.716 | 4222.2 samples/s | 66.0 steps/s
[Step=21750 Epoch=83.7] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.779 | L2-Norm(final)=4.719 | 4276.3 samples/s | 66.8 steps/s
[Step=21800 Epoch=83.9] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.777 | L2-Norm(final)=4.722 | 4165.8 samples/s | 65.1 steps/s
[Step=21850 Epoch=84.1] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.774 | L2-Norm(final)=4.726 | 5483.4 samples/s | 85.7 steps/s
[Step=21900 Epoch=84.3] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.771 | L2-Norm(final)=4.729 | 1807.5 samples/s | 28.2 steps/s
[Step=21950 Epoch=84.5] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.767 | L2-Norm(final)=4.732 | 4249.3 samples/s | 66.4 steps/s
[Step=22000 Epoch=84.7] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.764 | L2-Norm(final)=4.736 | 4223.1 samples/s | 66.0 steps/s
[Step=22050 Epoch=84.9] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.761 | L2-Norm(final)=4.739 | 4172.8 samples/s | 65.2 steps/s
[Step=22100 Epoch=85.1] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.758 | L2-Norm(final)=4.743 | 4782.7 samples/s | 74.7 steps/s
[Step=22150 Epoch=85.3] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.755 | L2-Norm(final)=4.746 | 1877.9 samples/s | 29.3 steps/s
[Step=22200 Epoch=85.5] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.752 | L2-Norm(final)=4.750 | 4199.6 samples/s | 65.6 steps/s
[Step=22250 Epoch=85.6] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.748 | L2-Norm(final)=4.753 | 4187.4 samples/s | 65.4 steps/s
[Step=22300 Epoch=85.8] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.745 | L2-Norm(final)=4.757 | 4169.6 samples/s | 65.2 steps/s
[Step=22350 Epoch=86.0] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.742 | L2-Norm(final)=4.761 | 4281.4 samples/s | 66.9 steps/s
[Step=22400 Epoch=86.2] | Loss=0.00000 | Reg=0.00033 | acc=1.0000 | L2-Norm=5.738 | L2-Norm(final)=4.765 | 1946.9 samples/s | 30.4 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step22400.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.19271 | acc=0.9580 | tpr=0.9707 | fpr=0.0694 | 4117.6 samples/s | 16.1 steps/s
Avg test loss: 0.19598, Avg test acc: 0.95661, Avg tpr: 0.96946, Avg fpr: 0.07166, total FA: 559

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.17143 | acc=0.9580 | tpr=0.9741 | fpr=0.0771 | 4065.6 samples/s | 15.9 steps/s
Avg test loss: 0.17930, Avg test acc: 0.95733, Avg tpr: 0.97418, Avg fpr: 0.07973, total FA: 622

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.91952 | acc=0.3147 | tpr=0.0073 | fpr=0.0178 | 4122.2 samples/s | 16.1 steps/s
Avg test loss: 4.93316, Avg test acc: 0.31196, Avg tpr: 0.00653, Avg fpr: 0.01628, total FA: 127

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.91843 | acc=0.3147 | tpr=0.0033 | fpr=0.0092 | 4116.8 samples/s | 16.1 steps/s
Avg test loss: 5.95022, Avg test acc: 0.31236, Avg tpr: 0.00350, Avg fpr: 0.00833, total FA: 65

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.56468 | acc=0.1646 | tpr=0.7920 | fpr=0.8467 | 4060.6 samples/s | 15.9 steps/s
[Step= 100] | Loss=7.53075 | acc=0.1654 | tpr=0.7761 | fpr=0.8460 | 8080.5 samples/s | 31.6 steps/s
[Step= 150] | Loss=7.57676 | acc=0.1644 | tpr=0.7781 | fpr=0.8469 | 7956.3 samples/s | 31.1 steps/s
[Step= 200] | Loss=7.56932 | acc=0.1636 | tpr=0.7650 | fpr=0.8473 | 7865.1 samples/s | 30.7 steps/s
[Step= 250] | Loss=7.58458 | acc=0.1631 | tpr=0.7651 | fpr=0.8479 | 7368.3 samples/s | 28.8 steps/s
[Step= 300] | Loss=7.59461 | acc=0.1623 | tpr=0.7593 | fpr=0.8486 | 7727.9 samples/s | 30.2 steps/s
[Step= 350] | Loss=7.59259 | acc=0.1627 | tpr=0.7621 | fpr=0.8482 | 7807.1 samples/s | 30.5 steps/s
[Step= 400] | Loss=7.59267 | acc=0.1631 | tpr=0.7642 | fpr=0.8478 | 7875.6 samples/s | 30.8 steps/s
[Step= 450] | Loss=7.59340 | acc=0.1626 | tpr=0.7644 | fpr=0.8483 | 5530.4 samples/s | 21.6 steps/s
[Step= 500] | Loss=7.60175 | acc=0.1621 | tpr=0.7652 | fpr=0.8488 | 7409.5 samples/s | 28.9 steps/s
[Step= 550] | Loss=7.60229 | acc=0.1622 | tpr=0.7652 | fpr=0.8488 | 15457.9 samples/s | 60.4 steps/s
Avg test loss: 7.60464, Avg test acc: 0.16203, Avg tpr: 0.76466, Avg fpr: 0.84892, total FA: 117871

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=9.05390 | acc=0.1397 | tpr=0.7876 | fpr=0.8720 | 4110.7 samples/s | 16.1 steps/s
[Step= 100] | Loss=9.01053 | acc=0.1386 | tpr=0.7846 | fpr=0.8734 | 7920.1 samples/s | 30.9 steps/s
[Step= 150] | Loss=9.02164 | acc=0.1399 | tpr=0.7723 | fpr=0.8717 | 7599.1 samples/s | 29.7 steps/s
[Step= 200] | Loss=8.99673 | acc=0.1407 | tpr=0.7661 | fpr=0.8707 | 7610.5 samples/s | 29.7 steps/s
[Step= 250] | Loss=8.99928 | acc=0.1407 | tpr=0.7616 | fpr=0.8706 | 7569.4 samples/s | 29.6 steps/s
[Step= 300] | Loss=9.00344 | acc=0.1402 | tpr=0.7585 | fpr=0.8710 | 7411.9 samples/s | 29.0 steps/s
[Step= 350] | Loss=9.00030 | acc=0.1401 | tpr=0.7583 | fpr=0.8711 | 7941.4 samples/s | 31.0 steps/s
[Step= 400] | Loss=8.99412 | acc=0.1403 | tpr=0.7648 | fpr=0.8710 | 7203.8 samples/s | 28.1 steps/s
[Step= 450] | Loss=9.00479 | acc=0.1400 | tpr=0.7624 | fpr=0.8713 | 4969.6 samples/s | 19.4 steps/s
[Step= 500] | Loss=9.01951 | acc=0.1393 | tpr=0.7634 | fpr=0.8720 | 7612.3 samples/s | 29.7 steps/s
[Step= 550] | Loss=9.01987 | acc=0.1396 | tpr=0.7593 | fpr=0.8717 | 13240.5 samples/s | 51.7 steps/s
Avg test loss: 9.02186, Avg test acc: 0.13943, Avg tpr: 0.75951, Avg fpr: 0.87185, total FA: 121054

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08910 | acc=0.9823 | tpr=0.9558 | fpr=0.0173 | 3983.2 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.09244 | acc=0.9818 | tpr=0.9616 | fpr=0.0179 | 7541.8 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.09711 | acc=0.9810 | tpr=0.9582 | fpr=0.0185 | 7524.1 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.09751 | acc=0.9813 | tpr=0.9628 | fpr=0.0183 | 7556.6 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.09687 | acc=0.9815 | tpr=0.9607 | fpr=0.0181 | 7225.6 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.09732 | acc=0.9815 | tpr=0.9615 | fpr=0.0182 | 7592.3 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.09748 | acc=0.9815 | tpr=0.9624 | fpr=0.0181 | 7485.2 samples/s | 29.2 steps/s
[Step= 400] | Loss=0.09842 | acc=0.9812 | tpr=0.9584 | fpr=0.0183 | 7080.2 samples/s | 27.7 steps/s
[Step= 450] | Loss=0.09999 | acc=0.9811 | tpr=0.9572 | fpr=0.0185 | 6465.4 samples/s | 25.3 steps/s
[Step= 500] | Loss=0.09979 | acc=0.9812 | tpr=0.9590 | fpr=0.0184 | 7576.0 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.09928 | acc=0.9813 | tpr=0.9582 | fpr=0.0183 | 13534.4 samples/s | 52.9 steps/s
Avg test loss: 0.09916, Avg test acc: 0.98133, Avg tpr: 0.95840, Avg fpr: 0.01825, total FA: 2534

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13865 | acc=0.9795 | tpr=0.9469 | fpr=0.0200 | 3961.3 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.14632 | acc=0.9784 | tpr=0.9616 | fpr=0.0212 | 7585.1 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.15137 | acc=0.9779 | tpr=0.9625 | fpr=0.0218 | 7807.0 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.15216 | acc=0.9781 | tpr=0.9650 | fpr=0.0217 | 6949.8 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.15077 | acc=0.9783 | tpr=0.9677 | fpr=0.0215 | 7763.3 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.15342 | acc=0.9781 | tpr=0.9673 | fpr=0.0217 | 7469.6 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.15390 | acc=0.9781 | tpr=0.9662 | fpr=0.0217 | 7785.1 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.15539 | acc=0.9778 | tpr=0.9655 | fpr=0.0220 | 7458.5 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.15819 | acc=0.9775 | tpr=0.9635 | fpr=0.0223 | 8112.7 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.15706 | acc=0.9776 | tpr=0.9648 | fpr=0.0222 | 7492.4 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.15584 | acc=0.9778 | tpr=0.9654 | fpr=0.0220 | 14309.5 samples/s | 55.9 steps/s
Avg test loss: 0.15553, Avg test acc: 0.97780, Avg tpr: 0.96513, Avg fpr: 0.02197, total FA: 3051

server round 28/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00025, len=1
[Step=22401 Epoch=43.7] | Loss=0.01186 | Reg=0.00353 | acc=0.9844 | L2-Norm=18.788 | L2-Norm(final)=2.570 | 3741.0 samples/s | 58.5 steps/s
[Step=22450 Epoch=43.8] | Loss=0.00391 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.787 | L2-Norm(final)=2.572 | 4509.8 samples/s | 70.5 steps/s
[Step=22500 Epoch=43.9] | Loss=0.00372 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.784 | L2-Norm(final)=2.571 | 4615.4 samples/s | 72.1 steps/s
[Step=22550 Epoch=44.0] | Loss=0.00358 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.781 | L2-Norm(final)=2.572 | 4593.0 samples/s | 71.8 steps/s
[Step=22600 Epoch=44.1] | Loss=0.00441 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.779 | L2-Norm(final)=2.572 | 4492.8 samples/s | 70.2 steps/s
[Step=22650 Epoch=44.2] | Loss=0.00427 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.776 | L2-Norm(final)=2.571 | 4582.9 samples/s | 71.6 steps/s
[Step=22700 Epoch=44.3] | Loss=0.00448 | Reg=0.00352 | acc=0.9844 | L2-Norm=18.774 | L2-Norm(final)=2.571 | 4712.7 samples/s | 73.6 steps/s
[Step=22750 Epoch=44.4] | Loss=0.00447 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.772 | L2-Norm(final)=2.571 | 4552.5 samples/s | 71.1 steps/s
[Step=22800 Epoch=44.5] | Loss=0.00455 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.769 | L2-Norm(final)=2.571 | 4676.5 samples/s | 73.1 steps/s
[Step=22850 Epoch=44.6] | Loss=0.00443 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.767 | L2-Norm(final)=2.570 | 4564.6 samples/s | 71.3 steps/s
[Step=22900 Epoch=44.7] | Loss=0.00461 | Reg=0.00352 | acc=0.9844 | L2-Norm=18.764 | L2-Norm(final)=2.570 | 5618.9 samples/s | 87.8 steps/s
[Step=22950 Epoch=44.8] | Loss=0.00457 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.761 | L2-Norm(final)=2.570 | 1867.9 samples/s | 29.2 steps/s
[Step=23000 Epoch=44.9] | Loss=0.00452 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.758 | L2-Norm(final)=2.569 | 4535.1 samples/s | 70.9 steps/s
[Step=23050 Epoch=45.0] | Loss=0.00447 | Reg=0.00352 | acc=0.9844 | L2-Norm=18.756 | L2-Norm(final)=2.569 | 4511.5 samples/s | 70.5 steps/s
[Step=23100 Epoch=45.1] | Loss=0.00450 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.754 | L2-Norm(final)=2.569 | 4645.8 samples/s | 72.6 steps/s
[Step=23150 Epoch=45.2] | Loss=0.00451 | Reg=0.00352 | acc=0.9688 | L2-Norm=18.751 | L2-Norm(final)=2.569 | 4661.8 samples/s | 72.8 steps/s
[Step=23200 Epoch=45.2] | Loss=0.00448 | Reg=0.00352 | acc=0.9844 | L2-Norm=18.749 | L2-Norm(final)=2.569 | 4625.4 samples/s | 72.3 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step23200.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00025, len=1
[Step=22401 Epoch=43.8] | Loss=0.00392 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.528 | L2-Norm(final)=2.434 | 4322.0 samples/s | 67.5 steps/s
[Step=22450 Epoch=43.9] | Loss=0.00595 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.526 | L2-Norm(final)=2.437 | 4163.5 samples/s | 65.1 steps/s
[Step=22500 Epoch=44.0] | Loss=0.00546 | Reg=0.00343 | acc=0.9844 | L2-Norm=18.526 | L2-Norm(final)=2.435 | 4535.3 samples/s | 70.9 steps/s
[Step=22550 Epoch=44.1] | Loss=0.00499 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.525 | L2-Norm(final)=2.435 | 4670.3 samples/s | 73.0 steps/s
[Step=22600 Epoch=44.2] | Loss=0.00494 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.524 | L2-Norm(final)=2.432 | 4298.5 samples/s | 67.2 steps/s
[Step=22650 Epoch=44.3] | Loss=0.00471 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.523 | L2-Norm(final)=2.431 | 4541.1 samples/s | 71.0 steps/s
[Step=22700 Epoch=44.4] | Loss=0.00463 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.522 | L2-Norm(final)=2.430 | 4524.5 samples/s | 70.7 steps/s
[Step=22750 Epoch=44.5] | Loss=0.00443 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.521 | L2-Norm(final)=2.430 | 4538.0 samples/s | 70.9 steps/s
[Step=22800 Epoch=44.6] | Loss=0.00478 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.520 | L2-Norm(final)=2.430 | 4467.6 samples/s | 69.8 steps/s
[Step=22850 Epoch=44.7] | Loss=0.00514 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.519 | L2-Norm(final)=2.429 | 4494.6 samples/s | 70.2 steps/s
[Step=22900 Epoch=44.8] | Loss=0.00526 | Reg=0.00343 | acc=0.9844 | L2-Norm=18.518 | L2-Norm(final)=2.428 | 5528.7 samples/s | 86.4 steps/s
[Step=22950 Epoch=44.9] | Loss=0.00511 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.517 | L2-Norm(final)=2.427 | 1876.7 samples/s | 29.3 steps/s
[Step=23000 Epoch=45.0] | Loss=0.00514 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.516 | L2-Norm(final)=2.427 | 4332.1 samples/s | 67.7 steps/s
[Step=23050 Epoch=45.1] | Loss=0.00497 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.515 | L2-Norm(final)=2.427 | 4416.1 samples/s | 69.0 steps/s
[Step=23100 Epoch=45.2] | Loss=0.00478 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.514 | L2-Norm(final)=2.428 | 4394.2 samples/s | 68.7 steps/s
[Step=23150 Epoch=45.3] | Loss=0.00476 | Reg=0.00343 | acc=0.9844 | L2-Norm=18.512 | L2-Norm(final)=2.428 | 4442.5 samples/s | 69.4 steps/s
[Step=23200 Epoch=45.4] | Loss=0.00490 | Reg=0.00343 | acc=0.9688 | L2-Norm=18.511 | L2-Norm(final)=2.429 | 4498.3 samples/s | 70.3 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step23200.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00025, len=1
[Step=22401 Epoch=85.8] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.150 | L2-Norm(final)=8.142 | 3841.5 samples/s | 60.0 steps/s
[Step=22450 Epoch=86.0] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.139 | L2-Norm(final)=8.147 | 4234.7 samples/s | 66.2 steps/s
[Step=22500 Epoch=86.2] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.128 | L2-Norm(final)=8.153 | 4264.7 samples/s | 66.6 steps/s
[Step=22550 Epoch=86.4] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.117 | L2-Norm(final)=8.158 | 4259.3 samples/s | 66.6 steps/s
[Step=22600 Epoch=86.6] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.105 | L2-Norm(final)=8.164 | 4312.3 samples/s | 67.4 steps/s
[Step=22650 Epoch=86.8] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.093 | L2-Norm(final)=8.170 | 5433.5 samples/s | 84.9 steps/s
[Step=22700 Epoch=87.0] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.082 | L2-Norm(final)=8.176 | 1839.6 samples/s | 28.7 steps/s
[Step=22750 Epoch=87.2] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.070 | L2-Norm(final)=8.182 | 4210.1 samples/s | 65.8 steps/s
[Step=22800 Epoch=87.4] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.058 | L2-Norm(final)=8.189 | 4244.5 samples/s | 66.3 steps/s
[Step=22850 Epoch=87.6] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.047 | L2-Norm(final)=8.195 | 4256.5 samples/s | 66.5 steps/s
[Step=22900 Epoch=87.7] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.035 | L2-Norm(final)=8.202 | 4702.5 samples/s | 73.5 steps/s
[Step=22950 Epoch=87.9] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.023 | L2-Norm(final)=8.208 | 1867.6 samples/s | 29.2 steps/s
[Step=23000 Epoch=88.1] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.012 | L2-Norm(final)=8.215 | 4413.0 samples/s | 69.0 steps/s
[Step=23050 Epoch=88.3] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.000 | L2-Norm(final)=8.222 | 4126.9 samples/s | 64.5 steps/s
[Step=23100 Epoch=88.5] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.988 | L2-Norm(final)=8.228 | 4215.8 samples/s | 65.9 steps/s
[Step=23150 Epoch=88.7] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.976 | L2-Norm(final)=8.235 | 4278.2 samples/s | 66.8 steps/s
[Step=23200 Epoch=88.9] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.964 | L2-Norm(final)=8.242 | 1995.3 samples/s | 31.2 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step23200.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00025, len=1
[Step=22401 Epoch=86.2] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.684 | L2-Norm(final)=4.827 | 3726.1 samples/s | 58.2 steps/s
[Step=22450 Epoch=86.4] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.680 | L2-Norm(final)=4.832 | 4283.3 samples/s | 66.9 steps/s
[Step=22500 Epoch=86.6] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.676 | L2-Norm(final)=4.835 | 4396.6 samples/s | 68.7 steps/s
[Step=22550 Epoch=86.8] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.672 | L2-Norm(final)=4.839 | 4231.0 samples/s | 66.1 steps/s
[Step=22600 Epoch=87.0] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.668 | L2-Norm(final)=4.843 | 4260.7 samples/s | 66.6 steps/s
[Step=22650 Epoch=87.2] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.664 | L2-Norm(final)=4.848 | 5310.5 samples/s | 83.0 steps/s
[Step=22700 Epoch=87.4] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.660 | L2-Norm(final)=4.853 | 1767.9 samples/s | 27.6 steps/s
[Step=22750 Epoch=87.6] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.656 | L2-Norm(final)=4.857 | 4166.4 samples/s | 65.1 steps/s
[Step=22800 Epoch=87.8] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.652 | L2-Norm(final)=4.862 | 4252.6 samples/s | 66.4 steps/s
[Step=22850 Epoch=88.0] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.648 | L2-Norm(final)=4.866 | 4301.9 samples/s | 67.2 steps/s
[Step=22900 Epoch=88.2] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.644 | L2-Norm(final)=4.871 | 4762.9 samples/s | 74.4 steps/s
[Step=22950 Epoch=88.3] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.640 | L2-Norm(final)=4.876 | 1896.8 samples/s | 29.6 steps/s
[Step=23000 Epoch=88.5] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.636 | L2-Norm(final)=4.881 | 4197.6 samples/s | 65.6 steps/s
[Step=23050 Epoch=88.7] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.631 | L2-Norm(final)=4.886 | 4202.5 samples/s | 65.7 steps/s
[Step=23100 Epoch=88.9] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.627 | L2-Norm(final)=4.891 | 4183.6 samples/s | 65.4 steps/s
[Step=23150 Epoch=89.1] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.623 | L2-Norm(final)=4.896 | 4231.4 samples/s | 66.1 steps/s
[Step=23200 Epoch=89.3] | Loss=0.00000 | Reg=0.00032 | acc=1.0000 | L2-Norm=5.618 | L2-Norm(final)=4.901 | 1955.0 samples/s | 30.5 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step23200.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.18796 | acc=0.9577 | tpr=0.9716 | fpr=0.0726 | 4033.7 samples/s | 15.8 steps/s
Avg test loss: 0.19343, Avg test acc: 0.95641, Avg tpr: 0.97033, Avg fpr: 0.07422, total FA: 579

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14989 | acc=0.9591 | tpr=0.9675 | fpr=0.0592 | 4078.8 samples/s | 15.9 steps/s
Avg test loss: 0.15758, Avg test acc: 0.95733, Avg tpr: 0.96695, Avg fpr: 0.06384, total FA: 498

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.83873 | acc=0.3146 | tpr=0.0091 | fpr=0.0221 | 4170.0 samples/s | 16.3 steps/s
Avg test loss: 4.85338, Avg test acc: 0.31216, Avg tpr: 0.00880, Avg fpr: 0.02064, total FA: 161

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.87530 | acc=0.3149 | tpr=0.0038 | fpr=0.0094 | 4174.8 samples/s | 16.3 steps/s
Avg test loss: 5.90687, Avg test acc: 0.31257, Avg tpr: 0.00391, Avg fpr: 0.00859, total FA: 67

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.48925 | acc=0.1604 | tpr=0.8274 | fpr=0.8516 | 4099.5 samples/s | 16.0 steps/s
[Step= 100] | Loss=7.46581 | acc=0.1607 | tpr=0.8017 | fpr=0.8513 | 8215.9 samples/s | 32.1 steps/s
[Step= 150] | Loss=7.51129 | acc=0.1596 | tpr=0.7925 | fpr=0.8521 | 4694.1 samples/s | 18.3 steps/s
[Step= 200] | Loss=7.50194 | acc=0.1591 | tpr=0.7803 | fpr=0.8522 | 8073.6 samples/s | 31.5 steps/s
[Step= 250] | Loss=7.51816 | acc=0.1589 | tpr=0.7808 | fpr=0.8524 | 7586.7 samples/s | 29.6 steps/s
[Step= 300] | Loss=7.52756 | acc=0.1578 | tpr=0.7782 | fpr=0.8535 | 7722.1 samples/s | 30.2 steps/s
[Step= 350] | Loss=7.52321 | acc=0.1579 | tpr=0.7783 | fpr=0.8533 | 7816.8 samples/s | 30.5 steps/s
[Step= 400] | Loss=7.52497 | acc=0.1581 | tpr=0.7806 | fpr=0.8532 | 8025.0 samples/s | 31.3 steps/s
[Step= 450] | Loss=7.52706 | acc=0.1578 | tpr=0.7804 | fpr=0.8535 | 7683.0 samples/s | 30.0 steps/s
[Step= 500] | Loss=7.53670 | acc=0.1573 | tpr=0.7753 | fpr=0.8539 | 7656.8 samples/s | 29.9 steps/s
[Step= 550] | Loss=7.53886 | acc=0.1573 | tpr=0.7748 | fpr=0.8539 | 14773.8 samples/s | 57.7 steps/s
Avg test loss: 7.54137, Avg test acc: 0.15720, Avg tpr: 0.77456, Avg fpr: 0.85402, total FA: 118579

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.69202 | acc=0.1740 | tpr=0.7124 | fpr=0.8357 | 4053.7 samples/s | 15.8 steps/s
[Step= 100] | Loss=7.65158 | acc=0.1742 | tpr=0.6908 | fpr=0.8355 | 5361.9 samples/s | 20.9 steps/s
[Step= 150] | Loss=7.66576 | acc=0.1752 | tpr=0.6830 | fpr=0.8341 | 6354.5 samples/s | 24.8 steps/s
[Step= 200] | Loss=7.64762 | acc=0.1757 | tpr=0.6699 | fpr=0.8333 | 7833.4 samples/s | 30.6 steps/s
[Step= 250] | Loss=7.64669 | acc=0.1755 | tpr=0.6611 | fpr=0.8334 | 7768.3 samples/s | 30.3 steps/s
[Step= 300] | Loss=7.64957 | acc=0.1754 | tpr=0.6589 | fpr=0.8334 | 7810.7 samples/s | 30.5 steps/s
[Step= 350] | Loss=7.64690 | acc=0.1755 | tpr=0.6562 | fpr=0.8332 | 7665.9 samples/s | 29.9 steps/s
[Step= 400] | Loss=7.64359 | acc=0.1755 | tpr=0.6647 | fpr=0.8334 | 7496.6 samples/s | 29.3 steps/s
[Step= 450] | Loss=7.65130 | acc=0.1753 | tpr=0.6621 | fpr=0.8335 | 7429.3 samples/s | 29.0 steps/s
[Step= 500] | Loss=7.66451 | acc=0.1747 | tpr=0.6656 | fpr=0.8342 | 7346.5 samples/s | 28.7 steps/s
[Step= 550] | Loss=7.66554 | acc=0.1744 | tpr=0.6586 | fpr=0.8344 | 14088.9 samples/s | 55.0 steps/s
Avg test loss: 7.66791, Avg test acc: 0.17429, Avg tpr: 0.65848, Avg fpr: 0.83451, total FA: 115870

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09558 | acc=0.9809 | tpr=0.9646 | fpr=0.0188 | 4020.4 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.09938 | acc=0.9806 | tpr=0.9680 | fpr=0.0192 | 4668.1 samples/s | 18.2 steps/s
[Step= 150] | Loss=0.10444 | acc=0.9797 | tpr=0.9654 | fpr=0.0200 | 7258.3 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.10497 | acc=0.9799 | tpr=0.9705 | fpr=0.0200 | 7453.1 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.10422 | acc=0.9801 | tpr=0.9686 | fpr=0.0197 | 7578.6 samples/s | 29.6 steps/s
[Step= 300] | Loss=0.10482 | acc=0.9801 | tpr=0.9695 | fpr=0.0197 | 7570.0 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.10500 | acc=0.9802 | tpr=0.9693 | fpr=0.0196 | 7877.1 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.10601 | acc=0.9799 | tpr=0.9661 | fpr=0.0199 | 7375.6 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.10763 | acc=0.9797 | tpr=0.9640 | fpr=0.0201 | 7455.1 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.10745 | acc=0.9798 | tpr=0.9652 | fpr=0.0200 | 7732.9 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.10685 | acc=0.9800 | tpr=0.9642 | fpr=0.0197 | 12745.2 samples/s | 49.8 steps/s
Avg test loss: 0.10671, Avg test acc: 0.98001, Avg tpr: 0.96434, Avg fpr: 0.01971, total FA: 2736

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14386 | acc=0.9787 | tpr=0.9469 | fpr=0.0208 | 4058.7 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.15209 | acc=0.9779 | tpr=0.9638 | fpr=0.0219 | 4567.2 samples/s | 17.8 steps/s
[Step= 150] | Loss=0.15725 | acc=0.9771 | tpr=0.9654 | fpr=0.0227 | 7642.6 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.15813 | acc=0.9774 | tpr=0.9705 | fpr=0.0225 | 7810.2 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.15671 | acc=0.9775 | tpr=0.9721 | fpr=0.0224 | 7736.8 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.15951 | acc=0.9773 | tpr=0.9709 | fpr=0.0226 | 7763.8 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.15999 | acc=0.9773 | tpr=0.9693 | fpr=0.0226 | 8152.5 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.16149 | acc=0.9770 | tpr=0.9683 | fpr=0.0228 | 7538.5 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.16433 | acc=0.9767 | tpr=0.9664 | fpr=0.0231 | 7979.8 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.16319 | acc=0.9768 | tpr=0.9674 | fpr=0.0230 | 7988.0 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.16195 | acc=0.9770 | tpr=0.9682 | fpr=0.0228 | 14201.0 samples/s | 55.5 steps/s
Avg test loss: 0.16162, Avg test acc: 0.97707, Avg tpr: 0.96830, Avg fpr: 0.02277, total FA: 3161

server round 29/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00025, len=1
[Step=23201 Epoch=45.3] | Loss=0.00137 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.709 | L2-Norm(final)=2.573 | 3905.6 samples/s | 61.0 steps/s
[Step=23250 Epoch=45.3] | Loss=0.00295 | Reg=0.00350 | acc=0.9844 | L2-Norm=18.709 | L2-Norm(final)=2.574 | 4412.7 samples/s | 68.9 steps/s
[Step=23300 Epoch=45.4] | Loss=0.00508 | Reg=0.00350 | acc=0.9844 | L2-Norm=18.708 | L2-Norm(final)=2.576 | 4574.7 samples/s | 71.5 steps/s
[Step=23350 Epoch=45.5] | Loss=0.00549 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.704 | L2-Norm(final)=2.572 | 4536.8 samples/s | 70.9 steps/s
[Step=23400 Epoch=45.6] | Loss=0.00563 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.702 | L2-Norm(final)=2.570 | 4577.5 samples/s | 71.5 steps/s
[Step=23450 Epoch=45.7] | Loss=0.00525 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.699 | L2-Norm(final)=2.569 | 4660.0 samples/s | 72.8 steps/s
[Step=23500 Epoch=45.8] | Loss=0.00495 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.697 | L2-Norm(final)=2.569 | 4716.4 samples/s | 73.7 steps/s
[Step=23550 Epoch=45.9] | Loss=0.00498 | Reg=0.00349 | acc=0.9844 | L2-Norm=18.695 | L2-Norm(final)=2.569 | 4495.5 samples/s | 70.2 steps/s
[Step=23600 Epoch=46.0] | Loss=0.00480 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.692 | L2-Norm(final)=2.570 | 4591.9 samples/s | 71.7 steps/s
[Step=23650 Epoch=46.1] | Loss=0.00466 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.690 | L2-Norm(final)=2.571 | 4636.5 samples/s | 72.4 steps/s
[Step=23700 Epoch=46.2] | Loss=0.00463 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.687 | L2-Norm(final)=2.571 | 5493.3 samples/s | 85.8 steps/s
[Step=23750 Epoch=46.3] | Loss=0.00443 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.685 | L2-Norm(final)=2.573 | 1858.8 samples/s | 29.0 steps/s
[Step=23800 Epoch=46.4] | Loss=0.00439 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.682 | L2-Norm(final)=2.574 | 4619.6 samples/s | 72.2 steps/s
[Step=23850 Epoch=46.5] | Loss=0.00431 | Reg=0.00349 | acc=0.9844 | L2-Norm=18.680 | L2-Norm(final)=2.575 | 4630.9 samples/s | 72.4 steps/s
[Step=23900 Epoch=46.6] | Loss=0.00425 | Reg=0.00349 | acc=0.9844 | L2-Norm=18.677 | L2-Norm(final)=2.576 | 4581.7 samples/s | 71.6 steps/s
[Step=23950 Epoch=46.7] | Loss=0.00430 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.675 | L2-Norm(final)=2.578 | 4654.6 samples/s | 72.7 steps/s
[Step=24000 Epoch=46.8] | Loss=0.00431 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.672 | L2-Norm(final)=2.578 | 4341.1 samples/s | 67.8 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step24000.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00025, len=1
[Step=23201 Epoch=45.4] | Loss=0.01338 | Reg=0.00342 | acc=0.9844 | L2-Norm=18.490 | L2-Norm(final)=2.431 | 4161.2 samples/s | 65.0 steps/s
[Step=23250 Epoch=45.5] | Loss=0.00399 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.491 | L2-Norm(final)=2.432 | 4204.7 samples/s | 65.7 steps/s
[Step=23300 Epoch=45.6] | Loss=0.00364 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.490 | L2-Norm(final)=2.436 | 4516.6 samples/s | 70.6 steps/s
[Step=23350 Epoch=45.6] | Loss=0.00396 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.488 | L2-Norm(final)=2.437 | 4469.2 samples/s | 69.8 steps/s
[Step=23400 Epoch=45.7] | Loss=0.00411 | Reg=0.00342 | acc=0.9844 | L2-Norm=18.486 | L2-Norm(final)=2.438 | 4424.4 samples/s | 69.1 steps/s
[Step=23450 Epoch=45.8] | Loss=0.00364 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.484 | L2-Norm(final)=2.439 | 4526.7 samples/s | 70.7 steps/s
[Step=23500 Epoch=45.9] | Loss=0.00352 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.482 | L2-Norm(final)=2.440 | 4440.3 samples/s | 69.4 steps/s
[Step=23550 Epoch=46.0] | Loss=0.00380 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.480 | L2-Norm(final)=2.441 | 4415.7 samples/s | 69.0 steps/s
[Step=23600 Epoch=46.1] | Loss=0.00375 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.478 | L2-Norm(final)=2.442 | 4320.5 samples/s | 67.5 steps/s
[Step=23650 Epoch=46.2] | Loss=0.00391 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.475 | L2-Norm(final)=2.443 | 4430.2 samples/s | 69.2 steps/s
[Step=23700 Epoch=46.3] | Loss=0.00401 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.473 | L2-Norm(final)=2.443 | 5405.8 samples/s | 84.5 steps/s
[Step=23750 Epoch=46.4] | Loss=0.00389 | Reg=0.00341 | acc=0.9531 | L2-Norm=18.471 | L2-Norm(final)=2.444 | 1902.4 samples/s | 29.7 steps/s
[Step=23800 Epoch=46.5] | Loss=0.00379 | Reg=0.00341 | acc=0.9844 | L2-Norm=18.469 | L2-Norm(final)=2.445 | 4497.4 samples/s | 70.3 steps/s
[Step=23850 Epoch=46.6] | Loss=0.00375 | Reg=0.00341 | acc=0.9844 | L2-Norm=18.467 | L2-Norm(final)=2.446 | 4587.9 samples/s | 71.7 steps/s
[Step=23900 Epoch=46.7] | Loss=0.00376 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.464 | L2-Norm(final)=2.446 | 4609.4 samples/s | 72.0 steps/s
[Step=23950 Epoch=46.8] | Loss=0.00369 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.462 | L2-Norm(final)=2.447 | 4603.3 samples/s | 71.9 steps/s
[Step=24000 Epoch=46.9] | Loss=0.00362 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.460 | L2-Norm(final)=2.447 | 4573.4 samples/s | 71.5 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step24000.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00025, len=1
[Step=23201 Epoch=88.9] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.774 | L2-Norm(final)=8.353 | 4108.2 samples/s | 64.2 steps/s
[Step=23250 Epoch=89.1] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.762 | L2-Norm(final)=8.358 | 3844.0 samples/s | 60.1 steps/s
[Step=23300 Epoch=89.3] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.749 | L2-Norm(final)=8.365 | 4288.9 samples/s | 67.0 steps/s
[Step=23350 Epoch=89.5] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.738 | L2-Norm(final)=8.374 | 4288.0 samples/s | 67.0 steps/s
[Step=23400 Epoch=89.7] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.727 | L2-Norm(final)=8.383 | 4316.8 samples/s | 67.4 steps/s
[Step=23450 Epoch=89.9] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.715 | L2-Norm(final)=8.391 | 5328.3 samples/s | 83.3 steps/s
[Step=23500 Epoch=90.0] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.703 | L2-Norm(final)=8.399 | 1802.4 samples/s | 28.2 steps/s
[Step=23550 Epoch=90.2] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.690 | L2-Norm(final)=8.407 | 4268.5 samples/s | 66.7 steps/s
[Step=23600 Epoch=90.4] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.678 | L2-Norm(final)=8.415 | 4289.3 samples/s | 67.0 steps/s
[Step=23650 Epoch=90.6] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.666 | L2-Norm(final)=8.423 | 4245.1 samples/s | 66.3 steps/s
[Step=23700 Epoch=90.8] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.653 | L2-Norm(final)=8.431 | 4790.6 samples/s | 74.9 steps/s
[Step=23750 Epoch=91.0] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.641 | L2-Norm(final)=8.439 | 1889.4 samples/s | 29.5 steps/s
[Step=23800 Epoch=91.2] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.629 | L2-Norm(final)=8.447 | 4216.8 samples/s | 65.9 steps/s
[Step=23850 Epoch=91.4] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.616 | L2-Norm(final)=8.455 | 4219.3 samples/s | 65.9 steps/s
[Step=23900 Epoch=91.6] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.604 | L2-Norm(final)=8.464 | 4226.9 samples/s | 66.0 steps/s
[Step=23950 Epoch=91.8] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.592 | L2-Norm(final)=8.473 | 4287.6 samples/s | 67.0 steps/s
[Step=24000 Epoch=92.0] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.580 | L2-Norm(final)=8.481 | 1986.7 samples/s | 31.0 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step24000.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00025, len=1
[Step=23201 Epoch=89.3] | Loss=0.00000 | Reg=0.00031 | acc=1.0000 | L2-Norm=5.546 | L2-Norm(final)=4.979 | 3795.5 samples/s | 59.3 steps/s
[Step=23250 Epoch=89.5] | Loss=0.00000 | Reg=0.00031 | acc=1.0000 | L2-Norm=5.541 | L2-Norm(final)=4.985 | 4014.6 samples/s | 62.7 steps/s
[Step=23300 Epoch=89.7] | Loss=0.00000 | Reg=0.00031 | acc=1.0000 | L2-Norm=5.537 | L2-Norm(final)=4.992 | 4322.2 samples/s | 67.5 steps/s
[Step=23350 Epoch=89.9] | Loss=0.00000 | Reg=0.00031 | acc=1.0000 | L2-Norm=5.532 | L2-Norm(final)=4.998 | 4191.9 samples/s | 65.5 steps/s
[Step=23400 Epoch=90.1] | Loss=0.00000 | Reg=0.00031 | acc=1.0000 | L2-Norm=5.527 | L2-Norm(final)=5.004 | 4224.6 samples/s | 66.0 steps/s
[Step=23450 Epoch=90.3] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.522 | L2-Norm(final)=5.009 | 5367.8 samples/s | 83.9 steps/s
[Step=23500 Epoch=90.5] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.516 | L2-Norm(final)=5.014 | 1806.5 samples/s | 28.2 steps/s
[Step=23550 Epoch=90.7] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.511 | L2-Norm(final)=5.020 | 4166.5 samples/s | 65.1 steps/s
[Step=23600 Epoch=90.8] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.505 | L2-Norm(final)=5.025 | 4195.5 samples/s | 65.6 steps/s
[Step=23650 Epoch=91.0] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.500 | L2-Norm(final)=5.031 | 4082.5 samples/s | 63.8 steps/s
[Step=23700 Epoch=91.2] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.495 | L2-Norm(final)=5.037 | 4814.1 samples/s | 75.2 steps/s
[Step=23750 Epoch=91.4] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.489 | L2-Norm(final)=5.043 | 1869.1 samples/s | 29.2 steps/s
[Step=23800 Epoch=91.6] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.484 | L2-Norm(final)=5.049 | 4260.2 samples/s | 66.6 steps/s
[Step=23850 Epoch=91.8] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.478 | L2-Norm(final)=5.056 | 4203.2 samples/s | 65.7 steps/s
[Step=23900 Epoch=92.0] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.472 | L2-Norm(final)=5.062 | 4184.1 samples/s | 65.4 steps/s
[Step=23950 Epoch=92.2] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.466 | L2-Norm(final)=5.068 | 4386.1 samples/s | 68.5 steps/s
[Step=24000 Epoch=92.4] | Loss=0.00000 | Reg=0.00030 | acc=1.0000 | L2-Norm=5.461 | L2-Norm(final)=5.075 | 1927.5 samples/s | 30.1 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step24000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.19052 | acc=0.9578 | tpr=0.9724 | fpr=0.0738 | 3491.3 samples/s | 13.6 steps/s
Avg test loss: 0.19610, Avg test acc: 0.95685, Avg tpr: 0.97097, Avg fpr: 0.07422, total FA: 579

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.17660 | acc=0.9594 | tpr=0.9715 | fpr=0.0669 | 3140.2 samples/s | 12.3 steps/s
Avg test loss: 0.18682, Avg test acc: 0.95785, Avg tpr: 0.97057, Avg fpr: 0.07012, total FA: 547

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.99840 | acc=0.3155 | tpr=0.0075 | fpr=0.0159 | 3083.4 samples/s | 12.0 steps/s
Avg test loss: 5.01652, Avg test acc: 0.31236, Avg tpr: 0.00664, Avg fpr: 0.01525, total FA: 119

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.68898 | acc=0.3159 | tpr=0.0066 | fpr=0.0124 | 3103.6 samples/s | 12.1 steps/s
Avg test loss: 5.71923, Avg test acc: 0.31337, Avg tpr: 0.00641, Avg fpr: 0.01154, total FA: 90

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.04917 | acc=0.1563 | tpr=0.7920 | fpr=0.8551 | 3055.3 samples/s | 11.9 steps/s
[Step= 100] | Loss=8.01507 | acc=0.1566 | tpr=0.7591 | fpr=0.8547 | 7650.8 samples/s | 29.9 steps/s
[Step= 150] | Loss=8.06592 | acc=0.1552 | tpr=0.7579 | fpr=0.8559 | 8060.9 samples/s | 31.5 steps/s
[Step= 200] | Loss=8.05768 | acc=0.1547 | tpr=0.7519 | fpr=0.8562 | 7701.7 samples/s | 30.1 steps/s
[Step= 250] | Loss=8.07443 | acc=0.1545 | tpr=0.7555 | fpr=0.8564 | 8178.3 samples/s | 31.9 steps/s
[Step= 300] | Loss=8.08231 | acc=0.1543 | tpr=0.7527 | fpr=0.8567 | 7731.3 samples/s | 30.2 steps/s
[Step= 350] | Loss=8.07809 | acc=0.1549 | tpr=0.7589 | fpr=0.8560 | 7218.2 samples/s | 28.2 steps/s
[Step= 400] | Loss=8.07833 | acc=0.1554 | tpr=0.7598 | fpr=0.8556 | 7024.9 samples/s | 27.4 steps/s
[Step= 450] | Loss=8.07942 | acc=0.1549 | tpr=0.7629 | fpr=0.8561 | 7330.0 samples/s | 28.6 steps/s
[Step= 500] | Loss=8.08882 | acc=0.1545 | tpr=0.7590 | fpr=0.8564 | 7321.8 samples/s | 28.6 steps/s
[Step= 550] | Loss=8.08888 | acc=0.1545 | tpr=0.7581 | fpr=0.8564 | 13854.5 samples/s | 54.1 steps/s
Avg test loss: 8.09187, Avg test acc: 0.15439, Avg tpr: 0.75792, Avg fpr: 0.85658, total FA: 118935

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=9.08866 | acc=0.1552 | tpr=0.7478 | fpr=0.8554 | 4164.4 samples/s | 16.3 steps/s
[Step= 100] | Loss=9.04493 | acc=0.1544 | tpr=0.7356 | fpr=0.8564 | 7788.3 samples/s | 30.4 steps/s
[Step= 150] | Loss=9.05593 | acc=0.1549 | tpr=0.7219 | fpr=0.8555 | 7953.0 samples/s | 31.1 steps/s
[Step= 200] | Loss=9.02985 | acc=0.1563 | tpr=0.7191 | fpr=0.8539 | 7452.5 samples/s | 29.1 steps/s
[Step= 250] | Loss=9.02915 | acc=0.1566 | tpr=0.7197 | fpr=0.8536 | 7788.1 samples/s | 30.4 steps/s
[Step= 300] | Loss=9.03006 | acc=0.1567 | tpr=0.7178 | fpr=0.8535 | 7425.8 samples/s | 29.0 steps/s
[Step= 350] | Loss=9.02479 | acc=0.1566 | tpr=0.7170 | fpr=0.8536 | 7513.8 samples/s | 29.4 steps/s
[Step= 400] | Loss=9.01823 | acc=0.1566 | tpr=0.7254 | fpr=0.8537 | 7418.8 samples/s | 29.0 steps/s
[Step= 450] | Loss=9.02890 | acc=0.1565 | tpr=0.7235 | fpr=0.8538 | 7352.3 samples/s | 28.7 steps/s
[Step= 500] | Loss=9.04505 | acc=0.1557 | tpr=0.7251 | fpr=0.8546 | 7761.7 samples/s | 30.3 steps/s
[Step= 550] | Loss=9.04437 | acc=0.1555 | tpr=0.7183 | fpr=0.8548 | 14219.2 samples/s | 55.5 steps/s
Avg test loss: 9.04732, Avg test acc: 0.15535, Avg tpr: 0.71870, Avg fpr: 0.85489, total FA: 118700

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08668 | acc=0.9823 | tpr=0.9558 | fpr=0.0173 | 3998.2 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.09060 | acc=0.9821 | tpr=0.9638 | fpr=0.0176 | 7556.6 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.09539 | acc=0.9813 | tpr=0.9611 | fpr=0.0183 | 7503.6 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.09597 | acc=0.9816 | tpr=0.9672 | fpr=0.0181 | 7557.9 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.09536 | acc=0.9817 | tpr=0.9642 | fpr=0.0180 | 7390.6 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.09610 | acc=0.9816 | tpr=0.9651 | fpr=0.0181 | 7993.8 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.09628 | acc=0.9816 | tpr=0.9649 | fpr=0.0181 | 7190.1 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.09723 | acc=0.9813 | tpr=0.9606 | fpr=0.0183 | 7417.8 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.09879 | acc=0.9811 | tpr=0.9586 | fpr=0.0185 | 7213.5 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.09861 | acc=0.9812 | tpr=0.9604 | fpr=0.0184 | 7386.1 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.09818 | acc=0.9813 | tpr=0.9586 | fpr=0.0182 | 13518.8 samples/s | 52.8 steps/s
Avg test loss: 0.09803, Avg test acc: 0.98136, Avg tpr: 0.95880, Avg fpr: 0.01823, total FA: 2531

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.17196 | acc=0.9767 | tpr=0.9646 | fpr=0.0231 | 4007.7 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.18187 | acc=0.9755 | tpr=0.9744 | fpr=0.0245 | 7890.9 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.18814 | acc=0.9744 | tpr=0.9726 | fpr=0.0255 | 7594.4 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.18916 | acc=0.9744 | tpr=0.9760 | fpr=0.0256 | 7862.5 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.18771 | acc=0.9744 | tpr=0.9773 | fpr=0.0256 | 7911.2 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.19088 | acc=0.9743 | tpr=0.9767 | fpr=0.0258 | 7789.6 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.19145 | acc=0.9742 | tpr=0.9750 | fpr=0.0258 | 7585.6 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.19326 | acc=0.9739 | tpr=0.9737 | fpr=0.0261 | 7945.9 samples/s | 31.0 steps/s
[Step= 450] | Loss=0.19653 | acc=0.9735 | tpr=0.9718 | fpr=0.0265 | 7616.3 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.19531 | acc=0.9734 | tpr=0.9722 | fpr=0.0265 | 8067.3 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.19378 | acc=0.9737 | tpr=0.9729 | fpr=0.0263 | 14214.4 samples/s | 55.5 steps/s
Avg test loss: 0.19337, Avg test acc: 0.97376, Avg tpr: 0.97306, Avg fpr: 0.02622, total FA: 3641

server round 30/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00013, len=1
[Step=24001 Epoch=46.8] | Loss=0.00000 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.630 | L2-Norm(final)=2.591 | 3809.3 samples/s | 59.5 steps/s
[Step=24050 Epoch=46.9] | Loss=0.00398 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.629 | L2-Norm(final)=2.592 | 4346.1 samples/s | 67.9 steps/s
[Step=24100 Epoch=47.0] | Loss=0.00479 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.627 | L2-Norm(final)=2.592 | 4579.1 samples/s | 71.5 steps/s
[Step=24150 Epoch=47.1] | Loss=0.00409 | Reg=0.00347 | acc=0.9844 | L2-Norm=18.625 | L2-Norm(final)=2.592 | 4633.6 samples/s | 72.4 steps/s
[Step=24200 Epoch=47.2] | Loss=0.00377 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.623 | L2-Norm(final)=2.592 | 4543.6 samples/s | 71.0 steps/s
[Step=24250 Epoch=47.3] | Loss=0.00358 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.621 | L2-Norm(final)=2.592 | 4520.7 samples/s | 70.6 steps/s
[Step=24300 Epoch=47.4] | Loss=0.00358 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.619 | L2-Norm(final)=2.593 | 4581.9 samples/s | 71.6 steps/s
[Step=24350 Epoch=47.5] | Loss=0.00346 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.617 | L2-Norm(final)=2.593 | 4548.6 samples/s | 71.1 steps/s
[Step=24400 Epoch=47.6] | Loss=0.00343 | Reg=0.00347 | acc=0.9844 | L2-Norm=18.616 | L2-Norm(final)=2.594 | 4552.0 samples/s | 71.1 steps/s
[Step=24450 Epoch=47.7] | Loss=0.00345 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.614 | L2-Norm(final)=2.595 | 4641.6 samples/s | 72.5 steps/s
[Step=24500 Epoch=47.8] | Loss=0.00343 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.612 | L2-Norm(final)=2.595 | 5710.7 samples/s | 89.2 steps/s
[Step=24550 Epoch=47.9] | Loss=0.00334 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.610 | L2-Norm(final)=2.596 | 1854.0 samples/s | 29.0 steps/s
[Step=24600 Epoch=48.0] | Loss=0.00336 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.609 | L2-Norm(final)=2.597 | 4566.3 samples/s | 71.3 steps/s
[Step=24650 Epoch=48.1] | Loss=0.00327 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.607 | L2-Norm(final)=2.597 | 4533.5 samples/s | 70.8 steps/s
[Step=24700 Epoch=48.2] | Loss=0.00323 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.605 | L2-Norm(final)=2.598 | 4682.8 samples/s | 73.2 steps/s
[Step=24750 Epoch=48.3] | Loss=0.00321 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.603 | L2-Norm(final)=2.598 | 4603.4 samples/s | 71.9 steps/s
[Step=24800 Epoch=48.4] | Loss=0.00320 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.601 | L2-Norm(final)=2.599 | 4557.9 samples/s | 71.2 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step24800.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00013, len=1
[Step=24001 Epoch=46.9] | Loss=0.00775 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.421 | L2-Norm(final)=2.457 | 4215.7 samples/s | 65.9 steps/s
[Step=24050 Epoch=47.0] | Loss=0.00378 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.419 | L2-Norm(final)=2.456 | 4137.2 samples/s | 64.6 steps/s
[Step=24100 Epoch=47.1] | Loss=0.00305 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.418 | L2-Norm(final)=2.457 | 4478.9 samples/s | 70.0 steps/s
[Step=24150 Epoch=47.2] | Loss=0.00322 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.416 | L2-Norm(final)=2.457 | 4631.5 samples/s | 72.4 steps/s
[Step=24200 Epoch=47.3] | Loss=0.00332 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.414 | L2-Norm(final)=2.458 | 4532.7 samples/s | 70.8 steps/s
[Step=24250 Epoch=47.4] | Loss=0.00317 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.413 | L2-Norm(final)=2.458 | 4497.7 samples/s | 70.3 steps/s
[Step=24300 Epoch=47.5] | Loss=0.00313 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.411 | L2-Norm(final)=2.458 | 4519.1 samples/s | 70.6 steps/s
[Step=24350 Epoch=47.6] | Loss=0.00320 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.409 | L2-Norm(final)=2.459 | 4402.7 samples/s | 68.8 steps/s
[Step=24400 Epoch=47.7] | Loss=0.00309 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.407 | L2-Norm(final)=2.459 | 4433.8 samples/s | 69.3 steps/s
[Step=24450 Epoch=47.8] | Loss=0.00305 | Reg=0.00339 | acc=0.9688 | L2-Norm=18.405 | L2-Norm(final)=2.459 | 4437.0 samples/s | 69.3 steps/s
[Step=24500 Epoch=47.9] | Loss=0.00307 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.403 | L2-Norm(final)=2.460 | 5422.3 samples/s | 84.7 steps/s
[Step=24550 Epoch=48.0] | Loss=0.00304 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.402 | L2-Norm(final)=2.461 | 1816.8 samples/s | 28.4 steps/s
[Step=24600 Epoch=48.1] | Loss=0.00300 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.400 | L2-Norm(final)=2.461 | 4406.2 samples/s | 68.8 steps/s
[Step=24650 Epoch=48.2] | Loss=0.00290 | Reg=0.00338 | acc=0.9844 | L2-Norm=18.398 | L2-Norm(final)=2.462 | 4453.0 samples/s | 69.6 steps/s
[Step=24700 Epoch=48.3] | Loss=0.00284 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.396 | L2-Norm(final)=2.463 | 4566.4 samples/s | 71.4 steps/s
[Step=24750 Epoch=48.4] | Loss=0.00283 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.394 | L2-Norm(final)=2.463 | 4540.0 samples/s | 70.9 steps/s
[Step=24800 Epoch=48.5] | Loss=0.00276 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.392 | L2-Norm(final)=2.464 | 4513.8 samples/s | 70.5 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step24800.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00013, len=1
[Step=24001 Epoch=92.0] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.383 | L2-Norm(final)=8.618 | 3917.8 samples/s | 61.2 steps/s
[Step=24050 Epoch=92.2] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.376 | L2-Norm(final)=8.621 | 3999.3 samples/s | 62.5 steps/s
[Step=24100 Epoch=92.3] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.369 | L2-Norm(final)=8.625 | 4262.2 samples/s | 66.6 steps/s
[Step=24150 Epoch=92.5] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.361 | L2-Norm(final)=8.628 | 4253.3 samples/s | 66.5 steps/s
[Step=24200 Epoch=92.7] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.354 | L2-Norm(final)=8.632 | 4329.0 samples/s | 67.6 steps/s
[Step=24250 Epoch=92.9] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.347 | L2-Norm(final)=8.635 | 5393.6 samples/s | 84.3 steps/s
[Step=24300 Epoch=93.1] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.339 | L2-Norm(final)=8.639 | 1804.0 samples/s | 28.2 steps/s
[Step=24350 Epoch=93.3] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.332 | L2-Norm(final)=8.643 | 4205.2 samples/s | 65.7 steps/s
[Step=24400 Epoch=93.5] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.325 | L2-Norm(final)=8.647 | 4186.6 samples/s | 65.4 steps/s
[Step=24450 Epoch=93.7] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.317 | L2-Norm(final)=8.652 | 4187.7 samples/s | 65.4 steps/s
[Step=24500 Epoch=93.9] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.310 | L2-Norm(final)=8.656 | 4721.5 samples/s | 73.8 steps/s
[Step=24550 Epoch=94.1] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.303 | L2-Norm(final)=8.660 | 1884.3 samples/s | 29.4 steps/s
[Step=24600 Epoch=94.3] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.296 | L2-Norm(final)=8.665 | 4246.0 samples/s | 66.3 steps/s
[Step=24650 Epoch=94.5] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.288 | L2-Norm(final)=8.670 | 4357.6 samples/s | 68.1 steps/s
[Step=24700 Epoch=94.6] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.281 | L2-Norm(final)=8.675 | 4164.8 samples/s | 65.1 steps/s
[Step=24750 Epoch=94.8] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.274 | L2-Norm(final)=8.680 | 4064.4 samples/s | 63.5 steps/s
[Step=24800 Epoch=95.0] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.267 | L2-Norm(final)=8.684 | 1968.4 samples/s | 30.8 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step24800.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00013, len=1
[Step=24001 Epoch=92.4] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.375 | L2-Norm(final)=5.184 | 4027.9 samples/s | 62.9 steps/s
[Step=24050 Epoch=92.6] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.372 | L2-Norm(final)=5.185 | 4133.1 samples/s | 64.6 steps/s
[Step=24100 Epoch=92.8] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.368 | L2-Norm(final)=5.187 | 4349.6 samples/s | 68.0 steps/s
[Step=24150 Epoch=93.0] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.365 | L2-Norm(final)=5.189 | 4279.5 samples/s | 66.9 steps/s
[Step=24200 Epoch=93.2] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.361 | L2-Norm(final)=5.192 | 4175.3 samples/s | 65.2 steps/s
[Step=24250 Epoch=93.3] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.358 | L2-Norm(final)=5.194 | 5337.1 samples/s | 83.4 steps/s
[Step=24300 Epoch=93.5] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.354 | L2-Norm(final)=5.196 | 1800.3 samples/s | 28.1 steps/s
[Step=24350 Epoch=93.7] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.350 | L2-Norm(final)=5.198 | 4233.3 samples/s | 66.1 steps/s
[Step=24400 Epoch=93.9] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.346 | L2-Norm(final)=5.200 | 4163.6 samples/s | 65.1 steps/s
[Step=24450 Epoch=94.1] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.343 | L2-Norm(final)=5.203 | 4162.5 samples/s | 65.0 steps/s
[Step=24500 Epoch=94.3] | Loss=0.00000 | Reg=0.00029 | acc=1.0000 | L2-Norm=5.339 | L2-Norm(final)=5.205 | 4807.4 samples/s | 75.1 steps/s
[Step=24550 Epoch=94.5] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.335 | L2-Norm(final)=5.207 | 1878.1 samples/s | 29.3 steps/s
[Step=24600 Epoch=94.7] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.331 | L2-Norm(final)=5.210 | 4208.9 samples/s | 65.8 steps/s
[Step=24650 Epoch=94.9] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.327 | L2-Norm(final)=5.212 | 4187.4 samples/s | 65.4 steps/s
[Step=24700 Epoch=95.1] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.323 | L2-Norm(final)=5.215 | 4194.8 samples/s | 65.5 steps/s
[Step=24750 Epoch=95.3] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.319 | L2-Norm(final)=5.217 | 4205.1 samples/s | 65.7 steps/s
[Step=24800 Epoch=95.5] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.315 | L2-Norm(final)=5.220 | 1943.2 samples/s | 30.4 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step24800.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.20449 | acc=0.9587 | tpr=0.9749 | fpr=0.0766 | 4138.0 samples/s | 16.2 steps/s
Avg test loss: 0.20889, Avg test acc: 0.95753, Avg tpr: 0.97360, Avg fpr: 0.07781, total FA: 607

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.18193 | acc=0.9595 | tpr=0.9712 | fpr=0.0659 | 4189.0 samples/s | 16.4 steps/s
Avg test loss: 0.19157, Avg test acc: 0.95845, Avg tpr: 0.97039, Avg fpr: 0.06781, total FA: 529

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.86709 | acc=0.3152 | tpr=0.0075 | fpr=0.0166 | 4270.8 samples/s | 16.7 steps/s
Avg test loss: 4.88532, Avg test acc: 0.31232, Avg tpr: 0.00694, Avg fpr: 0.01602, total FA: 125

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.87743 | acc=0.3152 | tpr=0.0038 | fpr=0.0087 | 4199.6 samples/s | 16.4 steps/s
Avg test loss: 5.90872, Avg test acc: 0.31281, Avg tpr: 0.00361, Avg fpr: 0.00718, total FA: 56

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.29496 | acc=0.1534 | tpr=0.8009 | fpr=0.8583 | 4201.3 samples/s | 16.4 steps/s
[Step= 100] | Loss=8.25815 | acc=0.1526 | tpr=0.7740 | fpr=0.8590 | 7669.0 samples/s | 30.0 steps/s
[Step= 150] | Loss=8.31308 | acc=0.1513 | tpr=0.7709 | fpr=0.8601 | 7826.9 samples/s | 30.6 steps/s
[Step= 200] | Loss=8.30392 | acc=0.1508 | tpr=0.7617 | fpr=0.8603 | 8114.6 samples/s | 31.7 steps/s
[Step= 250] | Loss=8.32007 | acc=0.1509 | tpr=0.7651 | fpr=0.8603 | 7462.0 samples/s | 29.1 steps/s
[Step= 300] | Loss=8.32929 | acc=0.1505 | tpr=0.7622 | fpr=0.8607 | 8111.9 samples/s | 31.7 steps/s
[Step= 350] | Loss=8.32383 | acc=0.1509 | tpr=0.7639 | fpr=0.8603 | 7616.0 samples/s | 29.7 steps/s
[Step= 400] | Loss=8.32382 | acc=0.1512 | tpr=0.7648 | fpr=0.8600 | 8124.2 samples/s | 31.7 steps/s
[Step= 450] | Loss=8.32467 | acc=0.1510 | tpr=0.7687 | fpr=0.8602 | 7888.3 samples/s | 30.8 steps/s
[Step= 500] | Loss=8.33581 | acc=0.1505 | tpr=0.7639 | fpr=0.8606 | 7414.6 samples/s | 29.0 steps/s
[Step= 550] | Loss=8.33694 | acc=0.1507 | tpr=0.7644 | fpr=0.8605 | 13778.3 samples/s | 53.8 steps/s
Avg test loss: 8.33970, Avg test acc: 0.15055, Avg tpr: 0.76426, Avg fpr: 0.86061, total FA: 119494

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=9.37153 | acc=0.1553 | tpr=0.7257 | fpr=0.8549 | 4175.3 samples/s | 16.3 steps/s
[Step= 100] | Loss=9.32205 | acc=0.1543 | tpr=0.7207 | fpr=0.8562 | 7379.8 samples/s | 28.8 steps/s
[Step= 150] | Loss=9.33411 | acc=0.1547 | tpr=0.7118 | fpr=0.8556 | 7692.4 samples/s | 30.0 steps/s
[Step= 200] | Loss=9.30736 | acc=0.1552 | tpr=0.7082 | fpr=0.8549 | 7583.2 samples/s | 29.6 steps/s
[Step= 250] | Loss=9.30385 | acc=0.1558 | tpr=0.7066 | fpr=0.8542 | 7621.7 samples/s | 29.8 steps/s
[Step= 300] | Loss=9.30516 | acc=0.1557 | tpr=0.7055 | fpr=0.8543 | 7999.9 samples/s | 31.2 steps/s
[Step= 350] | Loss=9.30123 | acc=0.1558 | tpr=0.7044 | fpr=0.8542 | 7575.6 samples/s | 29.6 steps/s
[Step= 400] | Loss=9.29521 | acc=0.1558 | tpr=0.7128 | fpr=0.8543 | 7637.0 samples/s | 29.8 steps/s
[Step= 450] | Loss=9.30693 | acc=0.1557 | tpr=0.7079 | fpr=0.8544 | 7654.8 samples/s | 29.9 steps/s
[Step= 500] | Loss=9.32386 | acc=0.1550 | tpr=0.7101 | fpr=0.8550 | 7769.2 samples/s | 30.3 steps/s
[Step= 550] | Loss=9.32400 | acc=0.1550 | tpr=0.7039 | fpr=0.8550 | 12640.0 samples/s | 49.4 steps/s
Avg test loss: 9.32693, Avg test acc: 0.15484, Avg tpr: 0.70444, Avg fpr: 0.85515, total FA: 118736

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08669 | acc=0.9819 | tpr=0.9558 | fpr=0.0177 | 3877.9 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.09070 | acc=0.9815 | tpr=0.9638 | fpr=0.0181 | 7473.2 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.09555 | acc=0.9808 | tpr=0.9625 | fpr=0.0188 | 7516.5 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.09618 | acc=0.9810 | tpr=0.9683 | fpr=0.0188 | 7439.9 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.09558 | acc=0.9812 | tpr=0.9668 | fpr=0.0185 | 7917.1 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.09639 | acc=0.9811 | tpr=0.9680 | fpr=0.0186 | 6958.7 samples/s | 27.2 steps/s
[Step= 350] | Loss=0.09653 | acc=0.9811 | tpr=0.9681 | fpr=0.0186 | 7362.6 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.09748 | acc=0.9809 | tpr=0.9644 | fpr=0.0188 | 7502.5 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.09906 | acc=0.9807 | tpr=0.9620 | fpr=0.0190 | 7049.8 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.09886 | acc=0.9807 | tpr=0.9634 | fpr=0.0190 | 7468.9 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.09841 | acc=0.9809 | tpr=0.9618 | fpr=0.0188 | 12741.9 samples/s | 49.8 steps/s
Avg test loss: 0.09827, Avg test acc: 0.98091, Avg tpr: 0.96197, Avg fpr: 0.01875, total FA: 2603

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13992 | acc=0.9796 | tpr=0.9469 | fpr=0.0198 | 3977.0 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.14829 | acc=0.9788 | tpr=0.9638 | fpr=0.0210 | 7562.8 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.15299 | acc=0.9779 | tpr=0.9654 | fpr=0.0218 | 7459.0 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.15405 | acc=0.9782 | tpr=0.9672 | fpr=0.0216 | 8111.0 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.15259 | acc=0.9784 | tpr=0.9686 | fpr=0.0215 | 7977.2 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.15560 | acc=0.9783 | tpr=0.9680 | fpr=0.0215 | 7701.1 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.15611 | acc=0.9783 | tpr=0.9662 | fpr=0.0215 | 7921.7 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.15751 | acc=0.9781 | tpr=0.9655 | fpr=0.0217 | 7507.9 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.16023 | acc=0.9777 | tpr=0.9640 | fpr=0.0221 | 8088.5 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.15907 | acc=0.9777 | tpr=0.9648 | fpr=0.0220 | 7551.4 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.15793 | acc=0.9780 | tpr=0.9658 | fpr=0.0218 | 14279.7 samples/s | 55.8 steps/s
Avg test loss: 0.15762, Avg test acc: 0.97802, Avg tpr: 0.96593, Avg fpr: 0.02176, total FA: 3022

server round 31/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00013, len=1
[Step=24801 Epoch=48.4] | Loss=0.00042 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.568 | L2-Norm(final)=2.607 | 3792.1 samples/s | 59.3 steps/s
[Step=24850 Epoch=48.5] | Loss=0.00254 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.566 | L2-Norm(final)=2.607 | 4096.9 samples/s | 64.0 steps/s
[Step=24900 Epoch=48.6] | Loss=0.00282 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.563 | L2-Norm(final)=2.608 | 4580.9 samples/s | 71.6 steps/s
[Step=24950 Epoch=48.7] | Loss=0.00275 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.561 | L2-Norm(final)=2.609 | 4494.1 samples/s | 70.2 steps/s
[Step=25000 Epoch=48.8] | Loss=0.00261 | Reg=0.00344 | acc=0.9844 | L2-Norm=18.559 | L2-Norm(final)=2.609 | 4616.2 samples/s | 72.1 steps/s
[Step=25050 Epoch=48.9] | Loss=0.00261 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.556 | L2-Norm(final)=2.610 | 4655.6 samples/s | 72.7 steps/s
[Step=25100 Epoch=49.0] | Loss=0.00283 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.554 | L2-Norm(final)=2.610 | 4559.1 samples/s | 71.2 steps/s
[Step=25150 Epoch=49.1] | Loss=0.00282 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.551 | L2-Norm(final)=2.611 | 4669.4 samples/s | 73.0 steps/s
[Step=25200 Epoch=49.1] | Loss=0.00284 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.549 | L2-Norm(final)=2.611 | 4684.1 samples/s | 73.2 steps/s
[Step=25250 Epoch=49.2] | Loss=0.00280 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.547 | L2-Norm(final)=2.612 | 4584.0 samples/s | 71.6 steps/s
[Step=25300 Epoch=49.3] | Loss=0.00297 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.544 | L2-Norm(final)=2.612 | 5678.8 samples/s | 88.7 steps/s
[Step=25350 Epoch=49.4] | Loss=0.00300 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.542 | L2-Norm(final)=2.613 | 1844.4 samples/s | 28.8 steps/s
[Step=25400 Epoch=49.5] | Loss=0.00304 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.540 | L2-Norm(final)=2.613 | 4635.8 samples/s | 72.4 steps/s
[Step=25450 Epoch=49.6] | Loss=0.00300 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.537 | L2-Norm(final)=2.613 | 4513.9 samples/s | 70.5 steps/s
[Step=25500 Epoch=49.7] | Loss=0.00290 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.535 | L2-Norm(final)=2.614 | 4628.6 samples/s | 72.3 steps/s
[Step=25550 Epoch=49.8] | Loss=0.00292 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.532 | L2-Norm(final)=2.614 | 4725.6 samples/s | 73.8 steps/s
[Step=25600 Epoch=49.9] | Loss=0.00302 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.530 | L2-Norm(final)=2.615 | 4599.7 samples/s | 71.9 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step25600.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00013, len=1
[Step=24801 Epoch=48.5] | Loss=0.00000 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.361 | L2-Norm(final)=2.473 | 3975.2 samples/s | 62.1 steps/s
[Step=24850 Epoch=48.6] | Loss=0.00251 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.358 | L2-Norm(final)=2.473 | 4444.5 samples/s | 69.4 steps/s
[Step=24900 Epoch=48.7] | Loss=0.00253 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.355 | L2-Norm(final)=2.473 | 4587.4 samples/s | 71.7 steps/s
[Step=24950 Epoch=48.8] | Loss=0.00240 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.353 | L2-Norm(final)=2.473 | 4695.9 samples/s | 73.4 steps/s
[Step=25000 Epoch=48.9] | Loss=0.00254 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.351 | L2-Norm(final)=2.473 | 4401.6 samples/s | 68.8 steps/s
[Step=25050 Epoch=49.0] | Loss=0.00244 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.348 | L2-Norm(final)=2.474 | 4556.5 samples/s | 71.2 steps/s
[Step=25100 Epoch=49.1] | Loss=0.00255 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.346 | L2-Norm(final)=2.475 | 4540.3 samples/s | 70.9 steps/s
[Step=25150 Epoch=49.2] | Loss=0.00258 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.344 | L2-Norm(final)=2.475 | 4484.8 samples/s | 70.1 steps/s
[Step=25200 Epoch=49.3] | Loss=0.00263 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.341 | L2-Norm(final)=2.476 | 4584.0 samples/s | 71.6 steps/s
[Step=25250 Epoch=49.4] | Loss=0.00266 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.339 | L2-Norm(final)=2.476 | 4484.3 samples/s | 70.1 steps/s
[Step=25300 Epoch=49.5] | Loss=0.00259 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.337 | L2-Norm(final)=2.477 | 5458.7 samples/s | 85.3 steps/s
[Step=25350 Epoch=49.6] | Loss=0.00268 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.334 | L2-Norm(final)=2.477 | 1792.1 samples/s | 28.0 steps/s
[Step=25400 Epoch=49.7] | Loss=0.00258 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.332 | L2-Norm(final)=2.478 | 4359.9 samples/s | 68.1 steps/s
[Step=25450 Epoch=49.8] | Loss=0.00259 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.329 | L2-Norm(final)=2.478 | 4424.7 samples/s | 69.1 steps/s
[Step=25500 Epoch=49.9] | Loss=0.00253 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.327 | L2-Norm(final)=2.479 | 4466.1 samples/s | 69.8 steps/s
[Step=25550 Epoch=49.9] | Loss=0.00259 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.325 | L2-Norm(final)=2.480 | 4454.2 samples/s | 69.6 steps/s
[Step=25600 Epoch=50.0] | Loss=0.00261 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.322 | L2-Norm(final)=2.480 | 4549.3 samples/s | 71.1 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step25600.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00013, len=1
[Step=24801 Epoch=95.0] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.148 | L2-Norm(final)=8.763 | 3795.5 samples/s | 59.3 steps/s
[Step=24850 Epoch=95.2] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.140 | L2-Norm(final)=8.767 | 4386.5 samples/s | 68.5 steps/s
[Step=24900 Epoch=95.4] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.131 | L2-Norm(final)=8.772 | 4389.4 samples/s | 68.6 steps/s
[Step=24950 Epoch=95.6] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.123 | L2-Norm(final)=8.777 | 4368.3 samples/s | 68.3 steps/s
[Step=25000 Epoch=95.8] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.114 | L2-Norm(final)=8.782 | 4323.6 samples/s | 67.6 steps/s
[Step=25050 Epoch=96.0] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.107 | L2-Norm(final)=8.787 | 5345.3 samples/s | 83.5 steps/s
[Step=25100 Epoch=96.2] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.099 | L2-Norm(final)=8.793 | 1805.4 samples/s | 28.2 steps/s
[Step=25150 Epoch=96.4] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.091 | L2-Norm(final)=8.799 | 4324.1 samples/s | 67.6 steps/s
[Step=25200 Epoch=96.6] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.083 | L2-Norm(final)=8.805 | 4283.3 samples/s | 66.9 steps/s
[Step=25250 Epoch=96.7] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.075 | L2-Norm(final)=8.811 | 4205.5 samples/s | 65.7 steps/s
[Step=25300 Epoch=96.9] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.067 | L2-Norm(final)=8.817 | 4757.3 samples/s | 74.3 steps/s
[Step=25350 Epoch=97.1] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.059 | L2-Norm(final)=8.823 | 1920.0 samples/s | 30.0 steps/s
[Step=25400 Epoch=97.3] | Loss=0.00004 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.052 | L2-Norm(final)=8.829 | 4231.8 samples/s | 66.1 steps/s
[Step=25450 Epoch=97.5] | Loss=0.00006 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.048 | L2-Norm(final)=8.835 | 4228.6 samples/s | 66.1 steps/s
[Step=25500 Epoch=97.7] | Loss=0.00006 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.046 | L2-Norm(final)=8.840 | 4261.0 samples/s | 66.6 steps/s
[Step=25550 Epoch=97.9] | Loss=0.00006 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.045 | L2-Norm(final)=8.845 | 4302.2 samples/s | 67.2 steps/s
[Step=25600 Epoch=98.1] | Loss=0.00006 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.044 | L2-Norm(final)=8.849 | 2011.0 samples/s | 31.4 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step25600.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00013, len=1
[Step=24801 Epoch=95.5] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.251 | L2-Norm(final)=5.264 | 4332.7 samples/s | 67.7 steps/s
[Step=24850 Epoch=95.7] | Loss=0.00000 | Reg=0.00028 | acc=1.0000 | L2-Norm=5.247 | L2-Norm(final)=5.268 | 3755.1 samples/s | 58.7 steps/s
[Step=24900 Epoch=95.8] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.243 | L2-Norm(final)=5.271 | 4305.3 samples/s | 67.3 steps/s
[Step=24950 Epoch=96.0] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.238 | L2-Norm(final)=5.273 | 4198.7 samples/s | 65.6 steps/s
[Step=25000 Epoch=96.2] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.234 | L2-Norm(final)=5.276 | 4210.9 samples/s | 65.8 steps/s
[Step=25050 Epoch=96.4] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.229 | L2-Norm(final)=5.280 | 5290.8 samples/s | 82.7 steps/s
[Step=25100 Epoch=96.6] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.224 | L2-Norm(final)=5.283 | 1827.4 samples/s | 28.6 steps/s
[Step=25150 Epoch=96.8] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.220 | L2-Norm(final)=5.286 | 4175.7 samples/s | 65.2 steps/s
[Step=25200 Epoch=97.0] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.215 | L2-Norm(final)=5.289 | 4237.4 samples/s | 66.2 steps/s
[Step=25250 Epoch=97.2] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.210 | L2-Norm(final)=5.292 | 4276.7 samples/s | 66.8 steps/s
[Step=25300 Epoch=97.4] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.205 | L2-Norm(final)=5.296 | 4750.9 samples/s | 74.2 steps/s
[Step=25350 Epoch=97.6] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.200 | L2-Norm(final)=5.299 | 1879.8 samples/s | 29.4 steps/s
[Step=25400 Epoch=97.8] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.195 | L2-Norm(final)=5.303 | 4205.1 samples/s | 65.7 steps/s
[Step=25450 Epoch=98.0] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.190 | L2-Norm(final)=5.306 | 4102.4 samples/s | 64.1 steps/s
[Step=25500 Epoch=98.2] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.185 | L2-Norm(final)=5.310 | 4232.0 samples/s | 66.1 steps/s
[Step=25550 Epoch=98.4] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.180 | L2-Norm(final)=5.314 | 4309.8 samples/s | 67.3 steps/s
[Step=25600 Epoch=98.5] | Loss=0.00000 | Reg=0.00027 | acc=1.0000 | L2-Norm=5.175 | L2-Norm(final)=5.317 | 1955.2 samples/s | 30.6 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step25600.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.19871 | acc=0.9587 | tpr=0.9719 | fpr=0.0701 | 4005.0 samples/s | 15.6 steps/s
Avg test loss: 0.20462, Avg test acc: 0.95737, Avg tpr: 0.97051, Avg fpr: 0.07153, total FA: 558

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.18500 | acc=0.9599 | tpr=0.9731 | fpr=0.0686 | 4073.5 samples/s | 15.9 steps/s
Avg test loss: 0.19555, Avg test acc: 0.95829, Avg tpr: 0.97237, Avg fpr: 0.07268, total FA: 567

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.53992 | acc=0.3166 | tpr=0.0079 | fpr=0.0131 | 4218.6 samples/s | 16.5 steps/s
Avg test loss: 4.55676, Avg test acc: 0.31361, Avg tpr: 0.00775, Avg fpr: 0.01372, total FA: 107

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.72766 | acc=0.3154 | tpr=0.0043 | fpr=0.0092 | 4098.7 samples/s | 16.0 steps/s
Avg test loss: 5.75804, Avg test acc: 0.31321, Avg tpr: 0.00431, Avg fpr: 0.00743, total FA: 58

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.07819 | acc=0.1641 | tpr=0.7699 | fpr=0.8467 | 4243.3 samples/s | 16.6 steps/s
[Step= 100] | Loss=8.03845 | acc=0.1638 | tpr=0.7441 | fpr=0.8470 | 7645.0 samples/s | 29.9 steps/s
[Step= 150] | Loss=8.09260 | acc=0.1625 | tpr=0.7450 | fpr=0.8482 | 7878.2 samples/s | 30.8 steps/s
[Step= 200] | Loss=8.08410 | acc=0.1622 | tpr=0.7366 | fpr=0.8483 | 7511.5 samples/s | 29.3 steps/s
[Step= 250] | Loss=8.10064 | acc=0.1624 | tpr=0.7389 | fpr=0.8481 | 8346.3 samples/s | 32.6 steps/s
[Step= 300] | Loss=8.11052 | acc=0.1619 | tpr=0.7375 | fpr=0.8486 | 7498.9 samples/s | 29.3 steps/s
[Step= 350] | Loss=8.10620 | acc=0.1623 | tpr=0.7408 | fpr=0.8482 | 8064.4 samples/s | 31.5 steps/s
[Step= 400] | Loss=8.10619 | acc=0.1627 | tpr=0.7423 | fpr=0.8479 | 7947.0 samples/s | 31.0 steps/s
[Step= 450] | Loss=8.10724 | acc=0.1625 | tpr=0.7459 | fpr=0.8481 | 7566.2 samples/s | 29.6 steps/s
[Step= 500] | Loss=8.11808 | acc=0.1622 | tpr=0.7405 | fpr=0.8482 | 7974.2 samples/s | 31.1 steps/s
[Step= 550] | Loss=8.11880 | acc=0.1622 | tpr=0.7421 | fpr=0.8483 | 14656.7 samples/s | 57.3 steps/s
Avg test loss: 8.12152, Avg test acc: 0.16207, Avg tpr: 0.74208, Avg fpr: 0.84847, total FA: 117809

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=9.44135 | acc=0.1515 | tpr=0.7611 | fpr=0.8595 | 4095.6 samples/s | 16.0 steps/s
[Step= 100] | Loss=9.39182 | acc=0.1501 | tpr=0.7441 | fpr=0.8610 | 7799.7 samples/s | 30.5 steps/s
[Step= 150] | Loss=9.40406 | acc=0.1513 | tpr=0.7291 | fpr=0.8593 | 7580.9 samples/s | 29.6 steps/s
[Step= 200] | Loss=9.37627 | acc=0.1521 | tpr=0.7333 | fpr=0.8585 | 7481.3 samples/s | 29.2 steps/s
[Step= 250] | Loss=9.37256 | acc=0.1525 | tpr=0.7328 | fpr=0.8580 | 7733.4 samples/s | 30.2 steps/s
[Step= 300] | Loss=9.37503 | acc=0.1523 | tpr=0.7295 | fpr=0.8582 | 7920.7 samples/s | 30.9 steps/s
[Step= 350] | Loss=9.37199 | acc=0.1523 | tpr=0.7314 | fpr=0.8582 | 7814.8 samples/s | 30.5 steps/s
[Step= 400] | Loss=9.36729 | acc=0.1524 | tpr=0.7374 | fpr=0.8583 | 7802.1 samples/s | 30.5 steps/s
[Step= 450] | Loss=9.37878 | acc=0.1521 | tpr=0.7352 | fpr=0.8585 | 7240.3 samples/s | 28.3 steps/s
[Step= 500] | Loss=9.39561 | acc=0.1514 | tpr=0.7361 | fpr=0.8592 | 7430.4 samples/s | 29.0 steps/s
[Step= 550] | Loss=9.39525 | acc=0.1514 | tpr=0.7306 | fpr=0.8591 | 13543.7 samples/s | 52.9 steps/s
Avg test loss: 9.39807, Avg test acc: 0.15131, Avg tpr: 0.73098, Avg fpr: 0.85923, total FA: 119302

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.07544 | acc=0.9830 | tpr=0.9558 | fpr=0.0165 | 4050.8 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.07936 | acc=0.9829 | tpr=0.9638 | fpr=0.0168 | 7607.3 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.08367 | acc=0.9820 | tpr=0.9640 | fpr=0.0176 | 7303.8 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.08405 | acc=0.9822 | tpr=0.9694 | fpr=0.0176 | 7569.0 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.08388 | acc=0.9823 | tpr=0.9659 | fpr=0.0174 | 7272.1 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.08445 | acc=0.9821 | tpr=0.9644 | fpr=0.0176 | 7518.1 samples/s | 29.4 steps/s
[Step= 350] | Loss=0.08455 | acc=0.9821 | tpr=0.9637 | fpr=0.0175 | 7631.4 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.08534 | acc=0.9819 | tpr=0.9606 | fpr=0.0177 | 7414.1 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.08674 | acc=0.9817 | tpr=0.9586 | fpr=0.0179 | 7209.7 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.08651 | acc=0.9818 | tpr=0.9604 | fpr=0.0178 | 7352.3 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.08627 | acc=0.9819 | tpr=0.9590 | fpr=0.0176 | 13424.0 samples/s | 52.4 steps/s
Avg test loss: 0.08616, Avg test acc: 0.98194, Avg tpr: 0.95919, Avg fpr: 0.01765, total FA: 2450

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14747 | acc=0.9792 | tpr=0.9469 | fpr=0.0202 | 4012.5 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.15642 | acc=0.9780 | tpr=0.9659 | fpr=0.0217 | 7383.5 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.16141 | acc=0.9772 | tpr=0.9669 | fpr=0.0226 | 7660.7 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.16253 | acc=0.9774 | tpr=0.9694 | fpr=0.0225 | 7657.1 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.16102 | acc=0.9774 | tpr=0.9703 | fpr=0.0225 | 8026.9 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.16410 | acc=0.9773 | tpr=0.9709 | fpr=0.0226 | 7569.9 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.16466 | acc=0.9773 | tpr=0.9693 | fpr=0.0226 | 7963.5 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.16612 | acc=0.9770 | tpr=0.9683 | fpr=0.0228 | 7651.1 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.16898 | acc=0.9766 | tpr=0.9664 | fpr=0.0232 | 8100.4 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.16780 | acc=0.9767 | tpr=0.9670 | fpr=0.0231 | 7774.6 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.16656 | acc=0.9769 | tpr=0.9674 | fpr=0.0229 | 13911.0 samples/s | 54.3 steps/s
Avg test loss: 0.16623, Avg test acc: 0.97693, Avg tpr: 0.96751, Avg fpr: 0.02290, total FA: 3179

server round 32/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00013, len=1
[Step=25601 Epoch=49.9] | Loss=0.00008 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.489 | L2-Norm(final)=2.622 | 3806.6 samples/s | 59.5 steps/s
[Step=25650 Epoch=50.0] | Loss=0.00274 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.487 | L2-Norm(final)=2.624 | 4509.9 samples/s | 70.5 steps/s
[Step=25700 Epoch=50.1] | Loss=0.00284 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.484 | L2-Norm(final)=2.624 | 4694.6 samples/s | 73.4 steps/s
[Step=25750 Epoch=50.2] | Loss=0.00247 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.482 | L2-Norm(final)=2.624 | 4580.8 samples/s | 71.6 steps/s
[Step=25800 Epoch=50.3] | Loss=0.00236 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.479 | L2-Norm(final)=2.625 | 4479.2 samples/s | 70.0 steps/s
[Step=25850 Epoch=50.4] | Loss=0.00257 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.477 | L2-Norm(final)=2.626 | 4582.5 samples/s | 71.6 steps/s
[Step=25900 Epoch=50.5] | Loss=0.00265 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.474 | L2-Norm(final)=2.626 | 4613.1 samples/s | 72.1 steps/s
[Step=25950 Epoch=50.6] | Loss=0.00291 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.471 | L2-Norm(final)=2.627 | 4674.1 samples/s | 73.0 steps/s
[Step=26000 Epoch=50.7] | Loss=0.00305 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.468 | L2-Norm(final)=2.627 | 4582.8 samples/s | 71.6 steps/s
[Step=26050 Epoch=50.8] | Loss=0.00310 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.466 | L2-Norm(final)=2.628 | 4546.0 samples/s | 71.0 steps/s
[Step=26100 Epoch=50.9] | Loss=0.00307 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.463 | L2-Norm(final)=2.628 | 5594.3 samples/s | 87.4 steps/s
[Step=26150 Epoch=51.0] | Loss=0.00304 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.460 | L2-Norm(final)=2.629 | 1896.3 samples/s | 29.6 steps/s
[Step=26200 Epoch=51.1] | Loss=0.00306 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.458 | L2-Norm(final)=2.629 | 4654.1 samples/s | 72.7 steps/s
[Step=26250 Epoch=51.2] | Loss=0.00315 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.455 | L2-Norm(final)=2.630 | 4530.9 samples/s | 70.8 steps/s
[Step=26300 Epoch=51.3] | Loss=0.00312 | Reg=0.00340 | acc=0.9688 | L2-Norm=18.452 | L2-Norm(final)=2.630 | 4509.1 samples/s | 70.5 steps/s
[Step=26350 Epoch=51.4] | Loss=0.00313 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.450 | L2-Norm(final)=2.630 | 4611.6 samples/s | 72.1 steps/s
[Step=26400 Epoch=51.5] | Loss=0.00315 | Reg=0.00340 | acc=0.9844 | L2-Norm=18.447 | L2-Norm(final)=2.631 | 4641.2 samples/s | 72.5 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step26400.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00013, len=1
[Step=25601 Epoch=50.0] | Loss=0.00001 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.283 | L2-Norm(final)=2.490 | 4220.8 samples/s | 66.0 steps/s
[Step=25650 Epoch=50.1] | Loss=0.00155 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.281 | L2-Norm(final)=2.490 | 4405.1 samples/s | 68.8 steps/s
[Step=25700 Epoch=50.2] | Loss=0.00205 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.278 | L2-Norm(final)=2.491 | 4576.8 samples/s | 71.5 steps/s
[Step=25750 Epoch=50.3] | Loss=0.00214 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.275 | L2-Norm(final)=2.491 | 4606.4 samples/s | 72.0 steps/s
[Step=25800 Epoch=50.4] | Loss=0.00242 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.273 | L2-Norm(final)=2.492 | 4578.1 samples/s | 71.5 steps/s
[Step=25850 Epoch=50.5] | Loss=0.00245 | Reg=0.00334 | acc=0.9844 | L2-Norm=18.270 | L2-Norm(final)=2.492 | 4680.1 samples/s | 73.1 steps/s
[Step=25900 Epoch=50.6] | Loss=0.00257 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.267 | L2-Norm(final)=2.493 | 4465.4 samples/s | 69.8 steps/s
[Step=25950 Epoch=50.7] | Loss=0.00243 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.265 | L2-Norm(final)=2.494 | 4419.8 samples/s | 69.1 steps/s
[Step=26000 Epoch=50.8] | Loss=0.00254 | Reg=0.00334 | acc=0.9844 | L2-Norm=18.262 | L2-Norm(final)=2.494 | 4610.1 samples/s | 72.0 steps/s
[Step=26050 Epoch=50.9] | Loss=0.00263 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.259 | L2-Norm(final)=2.495 | 4506.0 samples/s | 70.4 steps/s
[Step=26100 Epoch=51.0] | Loss=0.00263 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.256 | L2-Norm(final)=2.495 | 5517.2 samples/s | 86.2 steps/s
[Step=26150 Epoch=51.1] | Loss=0.00256 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.253 | L2-Norm(final)=2.495 | 1924.9 samples/s | 30.1 steps/s
[Step=26200 Epoch=51.2] | Loss=0.00256 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.251 | L2-Norm(final)=2.496 | 4512.6 samples/s | 70.5 steps/s
[Step=26250 Epoch=51.3] | Loss=0.00258 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.248 | L2-Norm(final)=2.496 | 4485.7 samples/s | 70.1 steps/s
[Step=26300 Epoch=51.4] | Loss=0.00254 | Reg=0.00333 | acc=0.9844 | L2-Norm=18.245 | L2-Norm(final)=2.497 | 4505.5 samples/s | 70.4 steps/s
[Step=26350 Epoch=51.5] | Loss=0.00246 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.242 | L2-Norm(final)=2.497 | 4456.5 samples/s | 69.6 steps/s
[Step=26400 Epoch=51.6] | Loss=0.00252 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.240 | L2-Norm(final)=2.498 | 4544.4 samples/s | 71.0 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step26400.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00013, len=1
[Step=25601 Epoch=98.1] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.022 | L2-Norm(final)=8.912 | 3765.2 samples/s | 58.8 steps/s
[Step=25650 Epoch=98.3] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.022 | L2-Norm(final)=8.913 | 3984.0 samples/s | 62.2 steps/s
[Step=25700 Epoch=98.5] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.021 | L2-Norm(final)=8.913 | 4225.8 samples/s | 66.0 steps/s
[Step=25750 Epoch=98.7] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.020 | L2-Norm(final)=8.913 | 4289.9 samples/s | 67.0 steps/s
[Step=25800 Epoch=98.9] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.020 | L2-Norm(final)=8.913 | 4311.9 samples/s | 67.4 steps/s
[Step=25850 Epoch=99.0] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.019 | L2-Norm(final)=8.914 | 5461.2 samples/s | 85.3 steps/s
[Step=25900 Epoch=99.2] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.019 | L2-Norm(final)=8.914 | 1799.3 samples/s | 28.1 steps/s
[Step=25950 Epoch=99.4] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.019 | L2-Norm(final)=8.914 | 4143.6 samples/s | 64.7 steps/s
[Step=26000 Epoch=99.6] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.018 | L2-Norm(final)=8.915 | 4258.8 samples/s | 66.5 steps/s
[Step=26050 Epoch=99.8] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.018 | L2-Norm(final)=8.915 | 4277.1 samples/s | 66.8 steps/s
[Step=26100 Epoch=100.0] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.018 | L2-Norm(final)=8.915 | 4694.2 samples/s | 73.3 steps/s
[Step=26150 Epoch=100.2] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.017 | L2-Norm(final)=8.916 | 1875.1 samples/s | 29.3 steps/s
[Step=26200 Epoch=100.4] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.017 | L2-Norm(final)=8.916 | 4263.8 samples/s | 66.6 steps/s
[Step=26250 Epoch=100.6] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.016 | L2-Norm(final)=8.916 | 4182.0 samples/s | 65.3 steps/s
[Step=26300 Epoch=100.8] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.016 | L2-Norm(final)=8.917 | 4282.1 samples/s | 66.9 steps/s
[Step=26350 Epoch=101.0] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.015 | L2-Norm(final)=8.917 | 4187.7 samples/s | 65.4 steps/s
[Step=26400 Epoch=101.2] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.015 | L2-Norm(final)=8.917 | 1934.2 samples/s | 30.2 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step26400.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00013, len=1
[Step=25601 Epoch=98.5] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.094 | L2-Norm(final)=5.381 | 3896.6 samples/s | 60.9 steps/s
[Step=25650 Epoch=98.7] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.088 | L2-Norm(final)=5.384 | 4109.1 samples/s | 64.2 steps/s
[Step=25700 Epoch=98.9] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.081 | L2-Norm(final)=5.387 | 4327.7 samples/s | 67.6 steps/s
[Step=25750 Epoch=99.1] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.075 | L2-Norm(final)=5.391 | 4221.5 samples/s | 66.0 steps/s
[Step=25800 Epoch=99.3] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.069 | L2-Norm(final)=5.396 | 4238.8 samples/s | 66.2 steps/s
[Step=25850 Epoch=99.5] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.063 | L2-Norm(final)=5.400 | 5390.7 samples/s | 84.2 steps/s
[Step=25900 Epoch=99.7] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.058 | L2-Norm(final)=5.405 | 1808.5 samples/s | 28.3 steps/s
[Step=25950 Epoch=99.9] | Loss=0.00000 | Reg=0.00026 | acc=1.0000 | L2-Norm=5.052 | L2-Norm(final)=5.410 | 4069.2 samples/s | 63.6 steps/s
[Step=26000 Epoch=100.1] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.047 | L2-Norm(final)=5.414 | 4072.0 samples/s | 63.6 steps/s
[Step=26050 Epoch=100.3] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.041 | L2-Norm(final)=5.419 | 4029.1 samples/s | 63.0 steps/s
[Step=26100 Epoch=100.5] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.034 | L2-Norm(final)=5.423 | 4633.7 samples/s | 72.4 steps/s
[Step=26150 Epoch=100.7] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.028 | L2-Norm(final)=5.427 | 1915.2 samples/s | 29.9 steps/s
[Step=26200 Epoch=100.9] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.022 | L2-Norm(final)=5.431 | 4318.9 samples/s | 67.5 steps/s
[Step=26250 Epoch=101.0] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.015 | L2-Norm(final)=5.435 | 4297.2 samples/s | 67.1 steps/s
[Step=26300 Epoch=101.2] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.008 | L2-Norm(final)=5.439 | 4217.3 samples/s | 65.9 steps/s
[Step=26350 Epoch=101.4] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=5.002 | L2-Norm(final)=5.443 | 4295.4 samples/s | 67.1 steps/s
[Step=26400 Epoch=101.6] | Loss=0.00008 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.996 | L2-Norm(final)=5.448 | 1911.9 samples/s | 29.9 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step26400.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.20201 | acc=0.9593 | tpr=0.9723 | fpr=0.0689 | 4113.2 samples/s | 16.1 steps/s
Avg test loss: 0.20701, Avg test acc: 0.95785, Avg tpr: 0.97062, Avg fpr: 0.07025, total FA: 548

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.18511 | acc=0.9591 | tpr=0.9681 | fpr=0.0605 | 3993.1 samples/s | 15.6 steps/s
Avg test loss: 0.19386, Avg test acc: 0.95817, Avg tpr: 0.96800, Avg fpr: 0.06345, total FA: 495

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.77060 | acc=0.3163 | tpr=0.0071 | fpr=0.0121 | 4103.4 samples/s | 16.0 steps/s
Avg test loss: 4.78853, Avg test acc: 0.31321, Avg tpr: 0.00682, Avg fpr: 0.01295, total FA: 101

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.68611 | acc=0.3159 | tpr=0.0127 | fpr=0.0258 | 4116.5 samples/s | 16.1 steps/s
Avg test loss: 4.70919, Avg test acc: 0.31397, Avg tpr: 0.01253, Avg fpr: 0.02307, total FA: 180

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.12018 | acc=0.1640 | tpr=0.7699 | fpr=0.8469 | 4127.0 samples/s | 16.1 steps/s
[Step= 100] | Loss=8.08383 | acc=0.1640 | tpr=0.7420 | fpr=0.8468 | 7965.0 samples/s | 31.1 steps/s
[Step= 150] | Loss=8.14052 | acc=0.1626 | tpr=0.7406 | fpr=0.8480 | 7706.7 samples/s | 30.1 steps/s
[Step= 200] | Loss=8.13116 | acc=0.1619 | tpr=0.7322 | fpr=0.8485 | 8098.0 samples/s | 31.6 steps/s
[Step= 250] | Loss=8.14637 | acc=0.1618 | tpr=0.7319 | fpr=0.8486 | 7417.7 samples/s | 29.0 steps/s
[Step= 300] | Loss=8.15647 | acc=0.1612 | tpr=0.7302 | fpr=0.8492 | 8360.0 samples/s | 32.7 steps/s
[Step= 350] | Loss=8.15239 | acc=0.1615 | tpr=0.7320 | fpr=0.8488 | 7323.0 samples/s | 28.6 steps/s
[Step= 400] | Loss=8.15173 | acc=0.1617 | tpr=0.7325 | fpr=0.8487 | 7768.4 samples/s | 30.3 steps/s
[Step= 450] | Loss=8.15244 | acc=0.1612 | tpr=0.7356 | fpr=0.8492 | 8568.5 samples/s | 33.5 steps/s
[Step= 500] | Loss=8.16376 | acc=0.1609 | tpr=0.7304 | fpr=0.8494 | 7021.7 samples/s | 27.4 steps/s
[Step= 550] | Loss=8.16496 | acc=0.1610 | tpr=0.7322 | fpr=0.8493 | 14561.0 samples/s | 56.9 steps/s
Avg test loss: 8.16764, Avg test acc: 0.16092, Avg tpr: 0.73217, Avg fpr: 0.84947, total FA: 117947

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=8.93069 | acc=0.1663 | tpr=0.7212 | fpr=0.8436 | 3972.4 samples/s | 15.5 steps/s
[Step= 100] | Loss=8.88012 | acc=0.1661 | tpr=0.7058 | fpr=0.8439 | 7732.3 samples/s | 30.2 steps/s
[Step= 150] | Loss=8.89227 | acc=0.1666 | tpr=0.6974 | fpr=0.8432 | 7847.8 samples/s | 30.7 steps/s
[Step= 200] | Loss=8.86422 | acc=0.1676 | tpr=0.6918 | fpr=0.8419 | 7500.4 samples/s | 29.3 steps/s
[Step= 250] | Loss=8.86029 | acc=0.1678 | tpr=0.6873 | fpr=0.8416 | 7522.8 samples/s | 29.4 steps/s
[Step= 300] | Loss=8.86242 | acc=0.1678 | tpr=0.6836 | fpr=0.8416 | 8107.3 samples/s | 31.7 steps/s
[Step= 350] | Loss=8.85891 | acc=0.1678 | tpr=0.6819 | fpr=0.8416 | 7261.8 samples/s | 28.4 steps/s
[Step= 400] | Loss=8.85334 | acc=0.1678 | tpr=0.6882 | fpr=0.8417 | 7676.6 samples/s | 30.0 steps/s
[Step= 450] | Loss=8.86504 | acc=0.1675 | tpr=0.6831 | fpr=0.8418 | 7670.1 samples/s | 30.0 steps/s
[Step= 500] | Loss=8.88104 | acc=0.1669 | tpr=0.6850 | fpr=0.8424 | 7569.3 samples/s | 29.6 steps/s
[Step= 550] | Loss=8.88097 | acc=0.1667 | tpr=0.6781 | fpr=0.8426 | 13890.9 samples/s | 54.3 steps/s
Avg test loss: 8.88369, Avg test acc: 0.16662, Avg tpr: 0.67829, Avg fpr: 0.84268, total FA: 117005

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.07724 | acc=0.9834 | tpr=0.9513 | fpr=0.0160 | 3974.6 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.08132 | acc=0.9830 | tpr=0.9616 | fpr=0.0166 | 7463.6 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.08569 | acc=0.9824 | tpr=0.9611 | fpr=0.0172 | 7401.6 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.08613 | acc=0.9825 | tpr=0.9672 | fpr=0.0172 | 7277.7 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.08590 | acc=0.9826 | tpr=0.9642 | fpr=0.0171 | 7840.9 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.08653 | acc=0.9824 | tpr=0.9622 | fpr=0.0172 | 7310.7 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.08665 | acc=0.9824 | tpr=0.9618 | fpr=0.0172 | 7786.7 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.08745 | acc=0.9822 | tpr=0.9590 | fpr=0.0174 | 7380.0 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.08890 | acc=0.9819 | tpr=0.9572 | fpr=0.0176 | 7660.8 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.08869 | acc=0.9820 | tpr=0.9586 | fpr=0.0175 | 7345.1 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.08844 | acc=0.9822 | tpr=0.9570 | fpr=0.0173 | 13526.6 samples/s | 52.8 steps/s
Avg test loss: 0.08831, Avg test acc: 0.98220, Avg tpr: 0.95721, Avg fpr: 0.01735, total FA: 2409

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.21468 | acc=0.9678 | tpr=0.9735 | fpr=0.0323 | 4084.3 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.22711 | acc=0.9669 | tpr=0.9872 | fpr=0.0335 | 7376.0 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.23599 | acc=0.9649 | tpr=0.9841 | fpr=0.0355 | 7534.5 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.23849 | acc=0.9647 | tpr=0.9869 | fpr=0.0357 | 7393.4 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.23650 | acc=0.9646 | tpr=0.9878 | fpr=0.0358 | 7301.4 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.23917 | acc=0.9646 | tpr=0.9869 | fpr=0.0358 | 7650.2 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.24030 | acc=0.9644 | tpr=0.9862 | fpr=0.0360 | 8220.0 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.24205 | acc=0.9641 | tpr=0.9858 | fpr=0.0363 | 7382.0 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.24601 | acc=0.9637 | tpr=0.9839 | fpr=0.0367 | 7397.0 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.24467 | acc=0.9636 | tpr=0.9837 | fpr=0.0367 | 7757.8 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.24289 | acc=0.9640 | tpr=0.9845 | fpr=0.0364 | 13876.5 samples/s | 54.2 steps/s
Avg test loss: 0.24235, Avg test acc: 0.96402, Avg tpr: 0.98455, Avg fpr: 0.03635, total FA: 5047

server round 33/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00013, len=1
[Step=26401 Epoch=51.5] | Loss=0.00138 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.403 | L2-Norm(final)=2.636 | 3982.8 samples/s | 62.2 steps/s
[Step=26450 Epoch=51.6] | Loss=0.00242 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.400 | L2-Norm(final)=2.635 | 4511.9 samples/s | 70.5 steps/s
[Step=26500 Epoch=51.7] | Loss=0.00273 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.397 | L2-Norm(final)=2.635 | 4640.1 samples/s | 72.5 steps/s
[Step=26550 Epoch=51.8] | Loss=0.00291 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.395 | L2-Norm(final)=2.636 | 4554.9 samples/s | 71.2 steps/s
[Step=26600 Epoch=51.9] | Loss=0.00293 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.392 | L2-Norm(final)=2.637 | 4561.1 samples/s | 71.3 steps/s
[Step=26650 Epoch=52.0] | Loss=0.00284 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.389 | L2-Norm(final)=2.638 | 4569.7 samples/s | 71.4 steps/s
[Step=26700 Epoch=52.1] | Loss=0.00281 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.387 | L2-Norm(final)=2.639 | 4607.6 samples/s | 72.0 steps/s
[Step=26750 Epoch=52.2] | Loss=0.00284 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.384 | L2-Norm(final)=2.639 | 4714.4 samples/s | 73.7 steps/s
[Step=26800 Epoch=52.3] | Loss=0.00277 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.381 | L2-Norm(final)=2.640 | 4567.4 samples/s | 71.4 steps/s
[Step=26850 Epoch=52.4] | Loss=0.00278 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.379 | L2-Norm(final)=2.641 | 4651.1 samples/s | 72.7 steps/s
[Step=26900 Epoch=52.5] | Loss=0.00293 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.376 | L2-Norm(final)=2.642 | 5481.1 samples/s | 85.6 steps/s
[Step=26950 Epoch=52.6] | Loss=0.00294 | Reg=0.00338 | acc=0.9844 | L2-Norm=18.373 | L2-Norm(final)=2.642 | 1908.1 samples/s | 29.8 steps/s
[Step=27000 Epoch=52.7] | Loss=0.00295 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.370 | L2-Norm(final)=2.643 | 4598.3 samples/s | 71.8 steps/s
[Step=27050 Epoch=52.8] | Loss=0.00297 | Reg=0.00337 | acc=0.9844 | L2-Norm=18.367 | L2-Norm(final)=2.644 | 4509.2 samples/s | 70.5 steps/s
[Step=27100 Epoch=52.9] | Loss=0.00295 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.365 | L2-Norm(final)=2.645 | 4572.9 samples/s | 71.5 steps/s
[Step=27150 Epoch=53.0] | Loss=0.00291 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.362 | L2-Norm(final)=2.646 | 4582.4 samples/s | 71.6 steps/s
[Step=27200 Epoch=53.1] | Loss=0.00293 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.359 | L2-Norm(final)=2.646 | 4653.9 samples/s | 72.7 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step27200.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00013, len=1
[Step=26401 Epoch=51.6] | Loss=0.00246 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.193 | L2-Norm(final)=2.507 | 4125.5 samples/s | 64.5 steps/s
[Step=26450 Epoch=51.7] | Loss=0.00197 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.190 | L2-Norm(final)=2.507 | 4368.6 samples/s | 68.3 steps/s
[Step=26500 Epoch=51.8] | Loss=0.00195 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.188 | L2-Norm(final)=2.508 | 4563.0 samples/s | 71.3 steps/s
[Step=26550 Epoch=51.9] | Loss=0.00196 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.185 | L2-Norm(final)=2.510 | 4583.2 samples/s | 71.6 steps/s
[Step=26600 Epoch=52.0] | Loss=0.00225 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.182 | L2-Norm(final)=2.511 | 4627.3 samples/s | 72.3 steps/s
[Step=26650 Epoch=52.1] | Loss=0.00256 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.179 | L2-Norm(final)=2.511 | 4569.7 samples/s | 71.4 steps/s
[Step=26700 Epoch=52.2] | Loss=0.00260 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.176 | L2-Norm(final)=2.511 | 4532.1 samples/s | 70.8 steps/s
[Step=26750 Epoch=52.3] | Loss=0.00252 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.173 | L2-Norm(final)=2.511 | 4470.9 samples/s | 69.9 steps/s
[Step=26800 Epoch=52.4] | Loss=0.00253 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.170 | L2-Norm(final)=2.511 | 4562.0 samples/s | 71.3 steps/s
[Step=26850 Epoch=52.5] | Loss=0.00251 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.167 | L2-Norm(final)=2.512 | 4613.2 samples/s | 72.1 steps/s
[Step=26900 Epoch=52.6] | Loss=0.00260 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.164 | L2-Norm(final)=2.513 | 5749.6 samples/s | 89.8 steps/s
[Step=26950 Epoch=52.7] | Loss=0.00268 | Reg=0.00330 | acc=0.9844 | L2-Norm=18.161 | L2-Norm(final)=2.514 | 1898.7 samples/s | 29.7 steps/s
[Step=27000 Epoch=52.8] | Loss=0.00277 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.159 | L2-Norm(final)=2.514 | 4508.5 samples/s | 70.4 steps/s
[Step=27050 Epoch=52.9] | Loss=0.00279 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.156 | L2-Norm(final)=2.515 | 4537.3 samples/s | 70.9 steps/s
[Step=27100 Epoch=53.0] | Loss=0.00277 | Reg=0.00330 | acc=0.9844 | L2-Norm=18.153 | L2-Norm(final)=2.515 | 4516.9 samples/s | 70.6 steps/s
[Step=27150 Epoch=53.1] | Loss=0.00278 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.151 | L2-Norm(final)=2.516 | 4470.2 samples/s | 69.8 steps/s
[Step=27200 Epoch=53.2] | Loss=0.00279 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.148 | L2-Norm(final)=2.516 | 4625.2 samples/s | 72.3 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step27200.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00013, len=1
[Step=26401 Epoch=101.2] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.007 | L2-Norm(final)=8.922 | 4438.5 samples/s | 69.4 steps/s
[Step=26450 Epoch=101.3] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.007 | L2-Norm(final)=8.922 | 3936.1 samples/s | 61.5 steps/s
[Step=26500 Epoch=101.5] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.006 | L2-Norm(final)=8.922 | 4216.2 samples/s | 65.9 steps/s
[Step=26550 Epoch=101.7] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.005 | L2-Norm(final)=8.922 | 4230.0 samples/s | 66.1 steps/s
[Step=26600 Epoch=101.9] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.005 | L2-Norm(final)=8.923 | 4249.5 samples/s | 66.4 steps/s
[Step=26650 Epoch=102.1] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.004 | L2-Norm(final)=8.923 | 5316.7 samples/s | 83.1 steps/s
[Step=26700 Epoch=102.3] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.004 | L2-Norm(final)=8.924 | 1853.3 samples/s | 29.0 steps/s
[Step=26750 Epoch=102.5] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.003 | L2-Norm(final)=8.924 | 4448.3 samples/s | 69.5 steps/s
[Step=26800 Epoch=102.7] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.003 | L2-Norm(final)=8.924 | 4260.9 samples/s | 66.6 steps/s
[Step=26850 Epoch=102.9] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.002 | L2-Norm(final)=8.925 | 4383.1 samples/s | 68.5 steps/s
[Step=26900 Epoch=103.1] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.001 | L2-Norm(final)=8.925 | 4909.0 samples/s | 76.7 steps/s
[Step=26950 Epoch=103.3] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.001 | L2-Norm(final)=8.925 | 1937.1 samples/s | 30.3 steps/s
[Step=27000 Epoch=103.5] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.000 | L2-Norm(final)=8.926 | 4214.3 samples/s | 65.8 steps/s
[Step=27050 Epoch=103.6] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.000 | L2-Norm(final)=8.926 | 4280.7 samples/s | 66.9 steps/s
[Step=27100 Epoch=103.8] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.999 | L2-Norm(final)=8.926 | 4239.3 samples/s | 66.2 steps/s
[Step=27150 Epoch=104.0] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.998 | L2-Norm(final)=8.927 | 4236.6 samples/s | 66.2 steps/s
[Step=27200 Epoch=104.2] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.998 | L2-Norm(final)=8.927 | 2019.7 samples/s | 31.6 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step27200.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00013, len=1
[Step=26401 Epoch=101.6] | Loss=0.00007 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.932 | L2-Norm(final)=5.514 | 3724.9 samples/s | 58.2 steps/s
[Step=26450 Epoch=101.8] | Loss=0.00039 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.959 | L2-Norm(final)=5.512 | 4136.6 samples/s | 64.6 steps/s
[Step=26500 Epoch=102.0] | Loss=0.00020 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.965 | L2-Norm(final)=5.513 | 4239.5 samples/s | 66.2 steps/s
[Step=26550 Epoch=102.2] | Loss=0.00013 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.966 | L2-Norm(final)=5.513 | 4128.9 samples/s | 64.5 steps/s
[Step=26600 Epoch=102.4] | Loss=0.00010 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.966 | L2-Norm(final)=5.514 | 4225.6 samples/s | 66.0 steps/s
[Step=26650 Epoch=102.6] | Loss=0.00009 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.966 | L2-Norm(final)=5.514 | 5355.3 samples/s | 83.7 steps/s
[Step=26700 Epoch=102.8] | Loss=0.00007 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.966 | L2-Norm(final)=5.514 | 1848.6 samples/s | 28.9 steps/s
[Step=26750 Epoch=103.0] | Loss=0.00006 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.965 | L2-Norm(final)=5.514 | 4300.0 samples/s | 67.2 steps/s
[Step=26800 Epoch=103.2] | Loss=0.00006 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.965 | L2-Norm(final)=5.515 | 4420.1 samples/s | 69.1 steps/s
[Step=26850 Epoch=103.4] | Loss=0.00005 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.965 | L2-Norm(final)=5.515 | 4260.2 samples/s | 66.6 steps/s
[Step=26900 Epoch=103.5] | Loss=0.00005 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.965 | L2-Norm(final)=5.515 | 4873.4 samples/s | 76.1 steps/s
[Step=26950 Epoch=103.7] | Loss=0.00004 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.964 | L2-Norm(final)=5.516 | 1890.3 samples/s | 29.5 steps/s
[Step=27000 Epoch=103.9] | Loss=0.00004 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.964 | L2-Norm(final)=5.516 | 4274.0 samples/s | 66.8 steps/s
[Step=27050 Epoch=104.1] | Loss=0.00004 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.964 | L2-Norm(final)=5.516 | 4277.7 samples/s | 66.8 steps/s
[Step=27100 Epoch=104.3] | Loss=0.00003 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.964 | L2-Norm(final)=5.516 | 4326.8 samples/s | 67.6 steps/s
[Step=27150 Epoch=104.5] | Loss=0.00003 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.963 | L2-Norm(final)=5.517 | 4281.7 samples/s | 66.9 steps/s
[Step=27200 Epoch=104.7] | Loss=0.00003 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.963 | L2-Norm(final)=5.517 | 1996.1 samples/s | 31.2 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step27200.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.21877 | acc=0.9581 | tpr=0.9703 | fpr=0.0684 | 4053.8 samples/s | 15.8 steps/s
Avg test loss: 0.22466, Avg test acc: 0.95713, Avg tpr: 0.96963, Avg fpr: 0.07038, total FA: 549

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.17477 | acc=0.9595 | tpr=0.9679 | fpr=0.0587 | 4061.5 samples/s | 15.9 steps/s
Avg test loss: 0.18315, Avg test acc: 0.95825, Avg tpr: 0.96695, Avg fpr: 0.06089, total FA: 475

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.81098 | acc=0.3165 | tpr=0.0078 | fpr=0.0131 | 4043.4 samples/s | 15.8 steps/s
Avg test loss: 4.82926, Avg test acc: 0.31349, Avg tpr: 0.00769, Avg fpr: 0.01397, total FA: 109

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.27555 | acc=0.3147 | tpr=0.0040 | fpr=0.0107 | 4185.2 samples/s | 16.3 steps/s
Avg test loss: 5.30116, Avg test acc: 0.31257, Avg tpr: 0.00408, Avg fpr: 0.00897, total FA: 70

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.48788 | acc=0.1706 | tpr=0.7699 | fpr=0.8401 | 4165.4 samples/s | 16.3 steps/s
[Step= 100] | Loss=8.45876 | acc=0.1698 | tpr=0.7249 | fpr=0.8406 | 7838.5 samples/s | 30.6 steps/s
[Step= 150] | Loss=8.51801 | acc=0.1684 | tpr=0.7305 | fpr=0.8419 | 8083.2 samples/s | 31.6 steps/s
[Step= 200] | Loss=8.50984 | acc=0.1677 | tpr=0.7235 | fpr=0.8424 | 7985.3 samples/s | 31.2 steps/s
[Step= 250] | Loss=8.52696 | acc=0.1677 | tpr=0.7301 | fpr=0.8425 | 8163.0 samples/s | 31.9 steps/s
[Step= 300] | Loss=8.53848 | acc=0.1668 | tpr=0.7309 | fpr=0.8434 | 7309.7 samples/s | 28.6 steps/s
[Step= 350] | Loss=8.53414 | acc=0.1673 | tpr=0.7326 | fpr=0.8430 | 8356.5 samples/s | 32.6 steps/s
[Step= 400] | Loss=8.53403 | acc=0.1673 | tpr=0.7336 | fpr=0.8430 | 7888.3 samples/s | 30.8 steps/s
[Step= 450] | Loss=8.53536 | acc=0.1667 | tpr=0.7361 | fpr=0.8436 | 7372.4 samples/s | 28.8 steps/s
[Step= 500] | Loss=8.54753 | acc=0.1663 | tpr=0.7322 | fpr=0.8440 | 7830.4 samples/s | 30.6 steps/s
[Step= 550] | Loss=8.54865 | acc=0.1663 | tpr=0.7338 | fpr=0.8440 | 14520.6 samples/s | 56.7 steps/s
Avg test loss: 8.55141, Avg test acc: 0.16614, Avg tpr: 0.73376, Avg fpr: 0.84417, total FA: 117212

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=8.49086 | acc=0.1720 | tpr=0.7035 | fpr=0.8375 | 4091.7 samples/s | 16.0 steps/s
[Step= 100] | Loss=8.43377 | acc=0.1718 | tpr=0.6823 | fpr=0.8377 | 7707.0 samples/s | 30.1 steps/s
[Step= 150] | Loss=8.44605 | acc=0.1721 | tpr=0.6758 | fpr=0.8372 | 8090.2 samples/s | 31.6 steps/s
[Step= 200] | Loss=8.41916 | acc=0.1735 | tpr=0.6776 | fpr=0.8357 | 7455.5 samples/s | 29.1 steps/s
[Step= 250] | Loss=8.41591 | acc=0.1737 | tpr=0.6716 | fpr=0.8354 | 8165.9 samples/s | 31.9 steps/s
[Step= 300] | Loss=8.41852 | acc=0.1736 | tpr=0.6713 | fpr=0.8354 | 7343.4 samples/s | 28.7 steps/s
[Step= 350] | Loss=8.41534 | acc=0.1736 | tpr=0.6706 | fpr=0.8354 | 7982.5 samples/s | 31.2 steps/s
[Step= 400] | Loss=8.40986 | acc=0.1737 | tpr=0.6778 | fpr=0.8355 | 7475.5 samples/s | 29.2 steps/s
[Step= 450] | Loss=8.42156 | acc=0.1732 | tpr=0.6733 | fpr=0.8358 | 7606.7 samples/s | 29.7 steps/s
[Step= 500] | Loss=8.43654 | acc=0.1727 | tpr=0.6758 | fpr=0.8364 | 7921.5 samples/s | 30.9 steps/s
[Step= 550] | Loss=8.43663 | acc=0.1724 | tpr=0.6689 | fpr=0.8366 | 12743.5 samples/s | 49.8 steps/s
Avg test loss: 8.43918, Avg test acc: 0.17230, Avg tpr: 0.66918, Avg fpr: 0.83673, total FA: 116178

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08209 | acc=0.9821 | tpr=0.9513 | fpr=0.0173 | 4100.9 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.08636 | acc=0.9818 | tpr=0.9616 | fpr=0.0178 | 7752.2 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.09099 | acc=0.9811 | tpr=0.9625 | fpr=0.0186 | 7455.2 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.09147 | acc=0.9813 | tpr=0.9683 | fpr=0.0185 | 7850.8 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.09115 | acc=0.9814 | tpr=0.9651 | fpr=0.0183 | 7299.7 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.09182 | acc=0.9813 | tpr=0.9644 | fpr=0.0184 | 7486.5 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.09195 | acc=0.9813 | tpr=0.9643 | fpr=0.0184 | 7519.5 samples/s | 29.4 steps/s
[Step= 400] | Loss=0.09280 | acc=0.9811 | tpr=0.9612 | fpr=0.0185 | 7612.0 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.09431 | acc=0.9809 | tpr=0.9591 | fpr=0.0187 | 7401.1 samples/s | 28.9 steps/s
[Step= 500] | Loss=0.09409 | acc=0.9810 | tpr=0.9608 | fpr=0.0186 | 7275.7 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.09377 | acc=0.9812 | tpr=0.9594 | fpr=0.0184 | 13657.0 samples/s | 53.3 steps/s
Avg test loss: 0.09364, Avg test acc: 0.98117, Avg tpr: 0.95959, Avg fpr: 0.01844, total FA: 2560

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15636 | acc=0.9788 | tpr=0.9513 | fpr=0.0208 | 4158.8 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.16579 | acc=0.9778 | tpr=0.9701 | fpr=0.0221 | 7407.8 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.17112 | acc=0.9769 | tpr=0.9697 | fpr=0.0230 | 7289.9 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.17185 | acc=0.9769 | tpr=0.9749 | fpr=0.0231 | 7509.9 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.16999 | acc=0.9769 | tpr=0.9755 | fpr=0.0230 | 7488.2 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.17278 | acc=0.9769 | tpr=0.9745 | fpr=0.0231 | 7723.2 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.17358 | acc=0.9768 | tpr=0.9731 | fpr=0.0231 | 7425.9 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.17515 | acc=0.9766 | tpr=0.9721 | fpr=0.0233 | 7242.9 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.17851 | acc=0.9762 | tpr=0.9703 | fpr=0.0237 | 7362.8 samples/s | 28.8 steps/s
[Step= 500] | Loss=0.17734 | acc=0.9763 | tpr=0.9705 | fpr=0.0236 | 8065.9 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.17595 | acc=0.9764 | tpr=0.9713 | fpr=0.0235 | 14782.9 samples/s | 57.7 steps/s
Avg test loss: 0.17560, Avg test acc: 0.97645, Avg tpr: 0.97147, Avg fpr: 0.02346, total FA: 3257

server round 34/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00013, len=1
[Step=27201 Epoch=53.1] | Loss=0.00026 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.315 | L2-Norm(final)=2.660 | 3943.1 samples/s | 61.6 steps/s
[Step=27250 Epoch=53.1] | Loss=0.00353 | Reg=0.00335 | acc=0.9844 | L2-Norm=18.312 | L2-Norm(final)=2.660 | 4423.8 samples/s | 69.1 steps/s
[Step=27300 Epoch=53.2] | Loss=0.00338 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.310 | L2-Norm(final)=2.659 | 4563.9 samples/s | 71.3 steps/s
[Step=27350 Epoch=53.3] | Loss=0.00368 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.307 | L2-Norm(final)=2.658 | 4487.7 samples/s | 70.1 steps/s
[Step=27400 Epoch=53.4] | Loss=0.00332 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.305 | L2-Norm(final)=2.658 | 4524.2 samples/s | 70.7 steps/s
[Step=27450 Epoch=53.5] | Loss=0.00300 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.302 | L2-Norm(final)=2.659 | 4675.2 samples/s | 73.1 steps/s
[Step=27500 Epoch=53.6] | Loss=0.00319 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.300 | L2-Norm(final)=2.659 | 4654.4 samples/s | 72.7 steps/s
[Step=27550 Epoch=53.7] | Loss=0.00328 | Reg=0.00335 | acc=0.9844 | L2-Norm=18.297 | L2-Norm(final)=2.660 | 4619.2 samples/s | 72.2 steps/s
[Step=27600 Epoch=53.8] | Loss=0.00302 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.294 | L2-Norm(final)=2.660 | 4674.0 samples/s | 73.0 steps/s
[Step=27650 Epoch=53.9] | Loss=0.00290 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.291 | L2-Norm(final)=2.661 | 4619.8 samples/s | 72.2 steps/s
[Step=27700 Epoch=54.0] | Loss=0.00311 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.288 | L2-Norm(final)=2.661 | 5630.7 samples/s | 88.0 steps/s
[Step=27750 Epoch=54.1] | Loss=0.00305 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.285 | L2-Norm(final)=2.661 | 1912.8 samples/s | 29.9 steps/s
[Step=27800 Epoch=54.2] | Loss=0.00306 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.282 | L2-Norm(final)=2.662 | 4613.6 samples/s | 72.1 steps/s
[Step=27850 Epoch=54.3] | Loss=0.00296 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.279 | L2-Norm(final)=2.663 | 4640.9 samples/s | 72.5 steps/s
[Step=27900 Epoch=54.4] | Loss=0.00294 | Reg=0.00334 | acc=0.9844 | L2-Norm=18.276 | L2-Norm(final)=2.664 | 4627.5 samples/s | 72.3 steps/s
[Step=27950 Epoch=54.5] | Loss=0.00291 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.273 | L2-Norm(final)=2.664 | 4562.2 samples/s | 71.3 steps/s
[Step=28000 Epoch=54.6] | Loss=0.00294 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.270 | L2-Norm(final)=2.665 | 4593.4 samples/s | 71.8 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step28000.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00013, len=1
[Step=27201 Epoch=53.2] | Loss=0.00000 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.103 | L2-Norm(final)=2.526 | 4299.8 samples/s | 67.2 steps/s
[Step=27250 Epoch=53.3] | Loss=0.00375 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.101 | L2-Norm(final)=2.526 | 4407.3 samples/s | 68.9 steps/s
[Step=27300 Epoch=53.4] | Loss=0.00290 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.098 | L2-Norm(final)=2.526 | 4526.8 samples/s | 70.7 steps/s
[Step=27350 Epoch=53.5] | Loss=0.00296 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.096 | L2-Norm(final)=2.527 | 4561.9 samples/s | 71.3 steps/s
[Step=27400 Epoch=53.6] | Loss=0.00279 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.094 | L2-Norm(final)=2.528 | 4515.8 samples/s | 70.6 steps/s
[Step=27450 Epoch=53.7] | Loss=0.00272 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.092 | L2-Norm(final)=2.530 | 4563.0 samples/s | 71.3 steps/s
[Step=27500 Epoch=53.8] | Loss=0.00265 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.089 | L2-Norm(final)=2.531 | 4692.9 samples/s | 73.3 steps/s
[Step=27550 Epoch=53.9] | Loss=0.00273 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.087 | L2-Norm(final)=2.532 | 4739.0 samples/s | 74.0 steps/s
[Step=27600 Epoch=54.0] | Loss=0.00276 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.084 | L2-Norm(final)=2.532 | 4627.7 samples/s | 72.3 steps/s
[Step=27650 Epoch=54.1] | Loss=0.00279 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.081 | L2-Norm(final)=2.533 | 4558.4 samples/s | 71.2 steps/s
[Step=27700 Epoch=54.2] | Loss=0.00274 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.078 | L2-Norm(final)=2.534 | 5611.5 samples/s | 87.7 steps/s
[Step=27750 Epoch=54.3] | Loss=0.00263 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.076 | L2-Norm(final)=2.534 | 1948.9 samples/s | 30.5 steps/s
[Step=27800 Epoch=54.3] | Loss=0.00266 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.073 | L2-Norm(final)=2.535 | 4339.0 samples/s | 67.8 steps/s
[Step=27850 Epoch=54.4] | Loss=0.00267 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.070 | L2-Norm(final)=2.536 | 4483.1 samples/s | 70.0 steps/s
[Step=27900 Epoch=54.5] | Loss=0.00266 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.067 | L2-Norm(final)=2.537 | 4448.1 samples/s | 69.5 steps/s
[Step=27950 Epoch=54.6] | Loss=0.00264 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.064 | L2-Norm(final)=2.537 | 4521.6 samples/s | 70.6 steps/s
[Step=28000 Epoch=54.7] | Loss=0.00263 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.061 | L2-Norm(final)=2.538 | 4462.3 samples/s | 69.7 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step28000.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00013, len=1
[Step=27201 Epoch=104.2] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.987 | L2-Norm(final)=8.934 | 3956.3 samples/s | 61.8 steps/s
[Step=27250 Epoch=104.4] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.986 | L2-Norm(final)=8.934 | 3896.9 samples/s | 60.9 steps/s
[Step=27300 Epoch=104.6] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.985 | L2-Norm(final)=8.934 | 4250.5 samples/s | 66.4 steps/s
[Step=27350 Epoch=104.8] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.985 | L2-Norm(final)=8.935 | 4231.1 samples/s | 66.1 steps/s
[Step=27400 Epoch=105.0] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.984 | L2-Norm(final)=8.935 | 4129.7 samples/s | 64.5 steps/s
[Step=27450 Epoch=105.2] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.983 | L2-Norm(final)=8.936 | 5094.4 samples/s | 79.6 steps/s
[Step=27500 Epoch=105.4] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.982 | L2-Norm(final)=8.936 | 1843.1 samples/s | 28.8 steps/s
[Step=27550 Epoch=105.6] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.981 | L2-Norm(final)=8.937 | 4310.6 samples/s | 67.4 steps/s
[Step=27600 Epoch=105.8] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.981 | L2-Norm(final)=8.937 | 4345.0 samples/s | 67.9 steps/s
[Step=27650 Epoch=105.9] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.980 | L2-Norm(final)=8.938 | 4404.0 samples/s | 68.8 steps/s
[Step=27700 Epoch=106.1] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.979 | L2-Norm(final)=8.938 | 4683.4 samples/s | 73.2 steps/s
[Step=27750 Epoch=106.3] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.978 | L2-Norm(final)=8.939 | 1942.9 samples/s | 30.4 steps/s
[Step=27800 Epoch=106.5] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.977 | L2-Norm(final)=8.939 | 4333.8 samples/s | 67.7 steps/s
[Step=27850 Epoch=106.7] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.976 | L2-Norm(final)=8.940 | 4159.6 samples/s | 65.0 steps/s
[Step=27900 Epoch=106.9] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.975 | L2-Norm(final)=8.940 | 4267.0 samples/s | 66.7 steps/s
[Step=27950 Epoch=107.1] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.974 | L2-Norm(final)=8.941 | 4245.3 samples/s | 66.3 steps/s
[Step=28000 Epoch=107.3] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.973 | L2-Norm(final)=8.942 | 1958.5 samples/s | 30.6 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step28000.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00013, len=1
[Step=27201 Epoch=104.7] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.958 | L2-Norm(final)=5.522 | 4002.9 samples/s | 62.5 steps/s
[Step=27250 Epoch=104.9] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.957 | L2-Norm(final)=5.522 | 3838.4 samples/s | 60.0 steps/s
[Step=27300 Epoch=105.1] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.957 | L2-Norm(final)=5.522 | 4242.2 samples/s | 66.3 steps/s
[Step=27350 Epoch=105.3] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.957 | L2-Norm(final)=5.523 | 4191.2 samples/s | 65.5 steps/s
[Step=27400 Epoch=105.5] | Loss=0.00001 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.957 | L2-Norm(final)=5.523 | 4262.8 samples/s | 66.6 steps/s
[Step=27450 Epoch=105.7] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.956 | L2-Norm(final)=5.523 | 5484.1 samples/s | 85.7 steps/s
[Step=27500 Epoch=105.9] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.956 | L2-Norm(final)=5.524 | 1790.0 samples/s | 28.0 steps/s
[Step=27550 Epoch=106.1] | Loss=0.00001 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.956 | L2-Norm(final)=5.524 | 4281.5 samples/s | 66.9 steps/s
[Step=27600 Epoch=106.2] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.955 | L2-Norm(final)=5.524 | 4227.8 samples/s | 66.1 steps/s
[Step=27650 Epoch=106.4] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.955 | L2-Norm(final)=5.525 | 4261.7 samples/s | 66.6 steps/s
[Step=27700 Epoch=106.6] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.954 | L2-Norm(final)=5.525 | 4740.2 samples/s | 74.1 steps/s
[Step=27750 Epoch=106.8] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.954 | L2-Norm(final)=5.525 | 1898.1 samples/s | 29.7 steps/s
[Step=27800 Epoch=107.0] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.954 | L2-Norm(final)=5.526 | 4238.8 samples/s | 66.2 steps/s
[Step=27850 Epoch=107.2] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.953 | L2-Norm(final)=5.526 | 4182.6 samples/s | 65.4 steps/s
[Step=27900 Epoch=107.4] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.953 | L2-Norm(final)=5.526 | 4311.4 samples/s | 67.4 steps/s
[Step=27950 Epoch=107.6] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.952 | L2-Norm(final)=5.527 | 4353.1 samples/s | 68.0 steps/s
[Step=28000 Epoch=107.8] | Loss=0.00000 | Reg=0.00025 | acc=1.0000 | L2-Norm=4.952 | L2-Norm(final)=5.527 | 1953.9 samples/s | 30.5 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step28000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.21331 | acc=0.9591 | tpr=0.9720 | fpr=0.0689 | 3917.7 samples/s | 15.3 steps/s
Avg test loss: 0.21863, Avg test acc: 0.95789, Avg tpr: 0.97103, Avg fpr: 0.07102, total FA: 554

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.19103 | acc=0.9577 | tpr=0.9645 | fpr=0.0572 | 4090.9 samples/s | 16.0 steps/s
Avg test loss: 0.20209, Avg test acc: 0.95669, Avg tpr: 0.96456, Avg fpr: 0.06063, total FA: 473

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.87587 | acc=0.3167 | tpr=0.0078 | fpr=0.0124 | 4027.3 samples/s | 15.7 steps/s
Avg test loss: 4.89463, Avg test acc: 0.31353, Avg tpr: 0.00752, Avg fpr: 0.01346, total FA: 105

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.46744 | acc=0.3144 | tpr=0.0035 | fpr=0.0107 | 3914.2 samples/s | 15.3 steps/s
Avg test loss: 5.49410, Avg test acc: 0.31240, Avg tpr: 0.00367, Avg fpr: 0.00859, total FA: 67

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.32023 | acc=0.1692 | tpr=0.7743 | fpr=0.8417 | 4205.6 samples/s | 16.4 steps/s
[Step= 100] | Loss=8.28818 | acc=0.1685 | tpr=0.7463 | fpr=0.8423 | 7724.9 samples/s | 30.2 steps/s
[Step= 150] | Loss=8.34526 | acc=0.1674 | tpr=0.7507 | fpr=0.8433 | 7508.5 samples/s | 29.3 steps/s
[Step= 200] | Loss=8.33721 | acc=0.1666 | tpr=0.7388 | fpr=0.8438 | 7761.9 samples/s | 30.3 steps/s
[Step= 250] | Loss=8.35305 | acc=0.1665 | tpr=0.7432 | fpr=0.8440 | 7645.5 samples/s | 29.9 steps/s
[Step= 300] | Loss=8.36378 | acc=0.1656 | tpr=0.7411 | fpr=0.8449 | 8077.7 samples/s | 31.6 steps/s
[Step= 350] | Loss=8.35959 | acc=0.1662 | tpr=0.7433 | fpr=0.8443 | 7577.0 samples/s | 29.6 steps/s
[Step= 400] | Loss=8.35918 | acc=0.1665 | tpr=0.7451 | fpr=0.8440 | 8388.6 samples/s | 32.8 steps/s
[Step= 450] | Loss=8.35996 | acc=0.1662 | tpr=0.7483 | fpr=0.8444 | 7309.4 samples/s | 28.6 steps/s
[Step= 500] | Loss=8.37126 | acc=0.1656 | tpr=0.7432 | fpr=0.8449 | 7412.9 samples/s | 29.0 steps/s
[Step= 550] | Loss=8.37279 | acc=0.1656 | tpr=0.7445 | fpr=0.8449 | 15210.1 samples/s | 59.4 steps/s
Avg test loss: 8.37587, Avg test acc: 0.16549, Avg tpr: 0.74406, Avg fpr: 0.84502, total FA: 117330

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=8.54577 | acc=0.1777 | tpr=0.7124 | fpr=0.8320 | 4163.3 samples/s | 16.3 steps/s
[Step= 100] | Loss=8.49859 | acc=0.1762 | tpr=0.6716 | fpr=0.8330 | 8043.5 samples/s | 31.4 steps/s
[Step= 150] | Loss=8.50663 | acc=0.1767 | tpr=0.6686 | fpr=0.8323 | 7429.7 samples/s | 29.0 steps/s
[Step= 200] | Loss=8.47538 | acc=0.1778 | tpr=0.6656 | fpr=0.8311 | 7975.7 samples/s | 31.2 steps/s
[Step= 250] | Loss=8.47225 | acc=0.1780 | tpr=0.6655 | fpr=0.8309 | 7456.0 samples/s | 29.1 steps/s
[Step= 300] | Loss=8.47366 | acc=0.1780 | tpr=0.6625 | fpr=0.8308 | 7615.0 samples/s | 29.7 steps/s
[Step= 350] | Loss=8.46869 | acc=0.1776 | tpr=0.6600 | fpr=0.8311 | 7553.6 samples/s | 29.5 steps/s
[Step= 400] | Loss=8.46333 | acc=0.1778 | tpr=0.6663 | fpr=0.8311 | 7837.4 samples/s | 30.6 steps/s
[Step= 450] | Loss=8.47412 | acc=0.1775 | tpr=0.6626 | fpr=0.8313 | 7631.8 samples/s | 29.8 steps/s
[Step= 500] | Loss=8.48900 | acc=0.1772 | tpr=0.6670 | fpr=0.8316 | 7834.8 samples/s | 30.6 steps/s
[Step= 550] | Loss=8.48792 | acc=0.1771 | tpr=0.6606 | fpr=0.8317 | 14154.4 samples/s | 55.3 steps/s
Avg test loss: 8.49056, Avg test acc: 0.17698, Avg tpr: 0.66086, Avg fpr: 0.83182, total FA: 115496

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08281 | acc=0.9823 | tpr=0.9513 | fpr=0.0172 | 4147.9 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.08714 | acc=0.9819 | tpr=0.9616 | fpr=0.0177 | 7495.4 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.09178 | acc=0.9811 | tpr=0.9625 | fpr=0.0185 | 7598.3 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.09227 | acc=0.9813 | tpr=0.9683 | fpr=0.0184 | 7263.1 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.09193 | acc=0.9815 | tpr=0.9651 | fpr=0.0182 | 7512.5 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.09262 | acc=0.9814 | tpr=0.9651 | fpr=0.0183 | 7264.0 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.09276 | acc=0.9814 | tpr=0.9649 | fpr=0.0183 | 7554.3 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.09361 | acc=0.9812 | tpr=0.9617 | fpr=0.0185 | 7625.7 samples/s | 29.8 steps/s
[Step= 450] | Loss=0.09514 | acc=0.9810 | tpr=0.9596 | fpr=0.0186 | 7846.7 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.09493 | acc=0.9811 | tpr=0.9612 | fpr=0.0185 | 7276.6 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.09461 | acc=0.9812 | tpr=0.9594 | fpr=0.0184 | 13916.7 samples/s | 54.4 steps/s
Avg test loss: 0.09447, Avg test acc: 0.98123, Avg tpr: 0.95959, Avg fpr: 0.01838, total FA: 2552

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15491 | acc=0.9793 | tpr=0.9469 | fpr=0.0201 | 3983.4 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.16434 | acc=0.9783 | tpr=0.9680 | fpr=0.0215 | 7742.3 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.16953 | acc=0.9774 | tpr=0.9683 | fpr=0.0224 | 7264.3 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.17027 | acc=0.9775 | tpr=0.9727 | fpr=0.0224 | 7594.0 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.16842 | acc=0.9776 | tpr=0.9738 | fpr=0.0224 | 7485.4 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.17127 | acc=0.9775 | tpr=0.9724 | fpr=0.0224 | 7165.1 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.17206 | acc=0.9774 | tpr=0.9712 | fpr=0.0224 | 7608.6 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.17364 | acc=0.9773 | tpr=0.9705 | fpr=0.0226 | 7279.1 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.17698 | acc=0.9768 | tpr=0.9688 | fpr=0.0230 | 7756.6 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.17579 | acc=0.9769 | tpr=0.9692 | fpr=0.0229 | 7835.0 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.17444 | acc=0.9771 | tpr=0.9702 | fpr=0.0227 | 13812.2 samples/s | 54.0 steps/s
Avg test loss: 0.17410, Avg test acc: 0.97715, Avg tpr: 0.97029, Avg fpr: 0.02272, total FA: 3155

server round 35/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00013, len=1
[Step=28001 Epoch=54.6] | Loss=0.00002 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.222 | L2-Norm(final)=2.679 | 3708.4 samples/s | 57.9 steps/s
[Step=28050 Epoch=54.7] | Loss=0.00333 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.219 | L2-Norm(final)=2.679 | 4465.1 samples/s | 69.8 steps/s
[Step=28100 Epoch=54.8] | Loss=0.00265 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.215 | L2-Norm(final)=2.680 | 4605.3 samples/s | 72.0 steps/s
[Step=28150 Epoch=54.9] | Loss=0.00262 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.212 | L2-Norm(final)=2.681 | 4449.8 samples/s | 69.5 steps/s
[Step=28200 Epoch=55.0] | Loss=0.00275 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.209 | L2-Norm(final)=2.682 | 4632.8 samples/s | 72.4 steps/s
[Step=28250 Epoch=55.1] | Loss=0.00273 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.207 | L2-Norm(final)=2.683 | 4638.3 samples/s | 72.5 steps/s
[Step=28300 Epoch=55.2] | Loss=0.00283 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.204 | L2-Norm(final)=2.683 | 4646.1 samples/s | 72.6 steps/s
[Step=28350 Epoch=55.3] | Loss=0.00292 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.200 | L2-Norm(final)=2.683 | 4654.0 samples/s | 72.7 steps/s
[Step=28400 Epoch=55.4] | Loss=0.00280 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.197 | L2-Norm(final)=2.683 | 4614.2 samples/s | 72.1 steps/s
[Step=28450 Epoch=55.5] | Loss=0.00287 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.194 | L2-Norm(final)=2.684 | 4488.9 samples/s | 70.1 steps/s
[Step=28500 Epoch=55.6] | Loss=0.00289 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.191 | L2-Norm(final)=2.684 | 5569.5 samples/s | 87.0 steps/s
[Step=28550 Epoch=55.7] | Loss=0.00299 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.188 | L2-Norm(final)=2.685 | 1844.4 samples/s | 28.8 steps/s
[Step=28600 Epoch=55.8] | Loss=0.00288 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.184 | L2-Norm(final)=2.686 | 4627.1 samples/s | 72.3 steps/s
[Step=28650 Epoch=55.9] | Loss=0.00285 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.181 | L2-Norm(final)=2.686 | 4555.4 samples/s | 71.2 steps/s
[Step=28700 Epoch=56.0] | Loss=0.00288 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=2.687 | 4585.7 samples/s | 71.7 steps/s
[Step=28750 Epoch=56.1] | Loss=0.00295 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.175 | L2-Norm(final)=2.688 | 4569.2 samples/s | 71.4 steps/s
[Step=28800 Epoch=56.2] | Loss=0.00289 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.172 | L2-Norm(final)=2.688 | 4566.7 samples/s | 71.4 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step28800.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00013, len=1
[Step=28001 Epoch=54.7] | Loss=0.00406 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.017 | L2-Norm(final)=2.551 | 4124.9 samples/s | 64.5 steps/s
[Step=28050 Epoch=54.8] | Loss=0.00233 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.015 | L2-Norm(final)=2.551 | 4414.6 samples/s | 69.0 steps/s
[Step=28100 Epoch=54.9] | Loss=0.00260 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.012 | L2-Norm(final)=2.551 | 4509.3 samples/s | 70.5 steps/s
[Step=28150 Epoch=55.0] | Loss=0.00352 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.009 | L2-Norm(final)=2.551 | 4571.2 samples/s | 71.4 steps/s
[Step=28200 Epoch=55.1] | Loss=0.00346 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.006 | L2-Norm(final)=2.550 | 4528.9 samples/s | 70.8 steps/s
[Step=28250 Epoch=55.2] | Loss=0.00329 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.003 | L2-Norm(final)=2.549 | 4623.7 samples/s | 72.2 steps/s
[Step=28300 Epoch=55.3] | Loss=0.00318 | Reg=0.00324 | acc=0.9844 | L2-Norm=18.000 | L2-Norm(final)=2.549 | 4667.6 samples/s | 72.9 steps/s
[Step=28350 Epoch=55.4] | Loss=0.00303 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.998 | L2-Norm(final)=2.550 | 4639.3 samples/s | 72.5 steps/s
[Step=28400 Epoch=55.5] | Loss=0.00296 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.995 | L2-Norm(final)=2.551 | 4541.4 samples/s | 71.0 steps/s
[Step=28450 Epoch=55.6] | Loss=0.00291 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.993 | L2-Norm(final)=2.552 | 4558.6 samples/s | 71.2 steps/s
[Step=28500 Epoch=55.7] | Loss=0.00282 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.990 | L2-Norm(final)=2.553 | 5477.9 samples/s | 85.6 steps/s
[Step=28550 Epoch=55.8] | Loss=0.00267 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.988 | L2-Norm(final)=2.554 | 1961.8 samples/s | 30.7 steps/s
[Step=28600 Epoch=55.9] | Loss=0.00268 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.985 | L2-Norm(final)=2.555 | 4460.0 samples/s | 69.7 steps/s
[Step=28650 Epoch=56.0] | Loss=0.00269 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.983 | L2-Norm(final)=2.556 | 4548.0 samples/s | 71.1 steps/s
[Step=28700 Epoch=56.1] | Loss=0.00280 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.981 | L2-Norm(final)=2.556 | 4531.6 samples/s | 70.8 steps/s
[Step=28750 Epoch=56.2] | Loss=0.00287 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.978 | L2-Norm(final)=2.556 | 4576.7 samples/s | 71.5 steps/s
[Step=28800 Epoch=56.3] | Loss=0.00283 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.975 | L2-Norm(final)=2.556 | 4668.6 samples/s | 72.9 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step28800.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00013, len=1
[Step=28001 Epoch=107.3] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.958 | L2-Norm(final)=8.951 | 4058.1 samples/s | 63.4 steps/s
[Step=28050 Epoch=107.5] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.957 | L2-Norm(final)=8.952 | 4013.5 samples/s | 62.7 steps/s
[Step=28100 Epoch=107.7] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.956 | L2-Norm(final)=8.952 | 4315.6 samples/s | 67.4 steps/s
[Step=28150 Epoch=107.9] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.955 | L2-Norm(final)=8.953 | 4248.4 samples/s | 66.4 steps/s
[Step=28200 Epoch=108.1] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.953 | L2-Norm(final)=8.954 | 4188.0 samples/s | 65.4 steps/s
[Step=28250 Epoch=108.2] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.952 | L2-Norm(final)=8.954 | 5367.1 samples/s | 83.9 steps/s
[Step=28300 Epoch=108.4] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.951 | L2-Norm(final)=8.955 | 1797.2 samples/s | 28.1 steps/s
[Step=28350 Epoch=108.6] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.950 | L2-Norm(final)=8.956 | 4107.0 samples/s | 64.2 steps/s
[Step=28400 Epoch=108.8] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.949 | L2-Norm(final)=8.956 | 4216.3 samples/s | 65.9 steps/s
[Step=28450 Epoch=109.0] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.947 | L2-Norm(final)=8.957 | 4248.9 samples/s | 66.4 steps/s
[Step=28500 Epoch=109.2] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.946 | L2-Norm(final)=8.958 | 4802.7 samples/s | 75.0 steps/s
[Step=28550 Epoch=109.4] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.945 | L2-Norm(final)=8.958 | 1947.8 samples/s | 30.4 steps/s
[Step=28600 Epoch=109.6] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.944 | L2-Norm(final)=8.959 | 4333.6 samples/s | 67.7 steps/s
[Step=28650 Epoch=109.8] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.942 | L2-Norm(final)=8.960 | 4304.1 samples/s | 67.3 steps/s
[Step=28700 Epoch=110.0] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.941 | L2-Norm(final)=8.961 | 4214.2 samples/s | 65.8 steps/s
[Step=28750 Epoch=110.2] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.940 | L2-Norm(final)=8.961 | 4332.7 samples/s | 67.7 steps/s
[Step=28800 Epoch=110.4] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.938 | L2-Norm(final)=8.962 | 1960.5 samples/s | 30.6 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step28800.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00013, len=1
[Step=28001 Epoch=107.8] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.944 | L2-Norm(final)=5.533 | 3805.9 samples/s | 59.5 steps/s
[Step=28050 Epoch=108.0] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.944 | L2-Norm(final)=5.533 | 4295.3 samples/s | 67.1 steps/s
[Step=28100 Epoch=108.2] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.943 | L2-Norm(final)=5.534 | 4278.9 samples/s | 66.9 steps/s
[Step=28150 Epoch=108.4] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.943 | L2-Norm(final)=5.534 | 4248.7 samples/s | 66.4 steps/s
[Step=28200 Epoch=108.6] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.943 | L2-Norm(final)=5.535 | 4268.7 samples/s | 66.7 steps/s
[Step=28250 Epoch=108.7] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.942 | L2-Norm(final)=5.535 | 5357.5 samples/s | 83.7 steps/s
[Step=28300 Epoch=108.9] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.941 | L2-Norm(final)=5.535 | 1742.9 samples/s | 27.2 steps/s
[Step=28350 Epoch=109.1] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.941 | L2-Norm(final)=5.536 | 4272.8 samples/s | 66.8 steps/s
[Step=28400 Epoch=109.3] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.940 | L2-Norm(final)=5.536 | 4276.5 samples/s | 66.8 steps/s
[Step=28450 Epoch=109.5] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.940 | L2-Norm(final)=5.537 | 4241.3 samples/s | 66.3 steps/s
[Step=28500 Epoch=109.7] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.939 | L2-Norm(final)=5.537 | 4832.0 samples/s | 75.5 steps/s
[Step=28550 Epoch=109.9] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.938 | L2-Norm(final)=5.538 | 1885.0 samples/s | 29.5 steps/s
[Step=28600 Epoch=110.1] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.938 | L2-Norm(final)=5.538 | 4191.0 samples/s | 65.5 steps/s
[Step=28650 Epoch=110.3] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.937 | L2-Norm(final)=5.539 | 4263.7 samples/s | 66.6 steps/s
[Step=28700 Epoch=110.5] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.936 | L2-Norm(final)=5.539 | 4251.7 samples/s | 66.4 steps/s
[Step=28750 Epoch=110.7] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.936 | L2-Norm(final)=5.540 | 4380.7 samples/s | 68.4 steps/s
[Step=28800 Epoch=110.9] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.935 | L2-Norm(final)=5.540 | 1971.5 samples/s | 30.8 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step28800.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.20541 | acc=0.9595 | tpr=0.9725 | fpr=0.0686 | 4128.0 samples/s | 16.1 steps/s
Avg test loss: 0.21117, Avg test acc: 0.95793, Avg tpr: 0.97092, Avg fpr: 0.07063, total FA: 551

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.18218 | acc=0.9587 | tpr=0.9728 | fpr=0.0719 | 4039.7 samples/s | 15.8 steps/s
Avg test loss: 0.19161, Avg test acc: 0.95801, Avg tpr: 0.97272, Avg fpr: 0.07435, total FA: 580

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.87341 | acc=0.3167 | tpr=0.0079 | fpr=0.0126 | 4075.2 samples/s | 15.9 steps/s
Avg test loss: 4.89236, Avg test acc: 0.31365, Avg tpr: 0.00769, Avg fpr: 0.01346, total FA: 105

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.58566 | acc=0.3145 | tpr=0.0038 | fpr=0.0107 | 3985.4 samples/s | 15.6 steps/s
Avg test loss: 5.61296, Avg test acc: 0.31253, Avg tpr: 0.00385, Avg fpr: 0.00859, total FA: 67

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.04470 | acc=0.1670 | tpr=0.7611 | fpr=0.8437 | 4110.0 samples/s | 16.1 steps/s
[Step= 100] | Loss=8.01291 | acc=0.1663 | tpr=0.7292 | fpr=0.8443 | 8091.9 samples/s | 31.6 steps/s
[Step= 150] | Loss=8.06991 | acc=0.1650 | tpr=0.7334 | fpr=0.8455 | 7836.6 samples/s | 30.6 steps/s
[Step= 200] | Loss=8.06298 | acc=0.1648 | tpr=0.7268 | fpr=0.8454 | 7835.4 samples/s | 30.6 steps/s
[Step= 250] | Loss=8.07557 | acc=0.1650 | tpr=0.7319 | fpr=0.8454 | 7670.9 samples/s | 30.0 steps/s
[Step= 300] | Loss=8.08643 | acc=0.1643 | tpr=0.7316 | fpr=0.8461 | 7835.3 samples/s | 30.6 steps/s
[Step= 350] | Loss=8.08284 | acc=0.1647 | tpr=0.7307 | fpr=0.8455 | 8013.1 samples/s | 31.3 steps/s
[Step= 400] | Loss=8.08315 | acc=0.1648 | tpr=0.7336 | fpr=0.8456 | 7369.3 samples/s | 28.8 steps/s
[Step= 450] | Loss=8.08354 | acc=0.1644 | tpr=0.7352 | fpr=0.8460 | 8007.2 samples/s | 31.3 steps/s
[Step= 500] | Loss=8.09430 | acc=0.1639 | tpr=0.7304 | fpr=0.8463 | 7945.2 samples/s | 31.0 steps/s
[Step= 550] | Loss=8.09532 | acc=0.1640 | tpr=0.7314 | fpr=0.8464 | 14476.4 samples/s | 56.5 steps/s
Avg test loss: 8.09807, Avg test acc: 0.16383, Avg tpr: 0.73098, Avg fpr: 0.84648, total FA: 117532

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=8.73413 | acc=0.1561 | tpr=0.7566 | fpr=0.8547 | 4152.6 samples/s | 16.2 steps/s
[Step= 100] | Loss=8.68830 | acc=0.1566 | tpr=0.7505 | fpr=0.8545 | 8222.5 samples/s | 32.1 steps/s
[Step= 150] | Loss=8.69881 | acc=0.1577 | tpr=0.7406 | fpr=0.8530 | 7574.6 samples/s | 29.6 steps/s
[Step= 200] | Loss=8.67240 | acc=0.1590 | tpr=0.7432 | fpr=0.8517 | 7826.6 samples/s | 30.6 steps/s
[Step= 250] | Loss=8.66993 | acc=0.1592 | tpr=0.7345 | fpr=0.8512 | 7958.5 samples/s | 31.1 steps/s
[Step= 300] | Loss=8.67240 | acc=0.1593 | tpr=0.7309 | fpr=0.8511 | 7515.9 samples/s | 29.4 steps/s
[Step= 350] | Loss=8.67077 | acc=0.1592 | tpr=0.7307 | fpr=0.8512 | 7786.2 samples/s | 30.4 steps/s
[Step= 400] | Loss=8.66382 | acc=0.1592 | tpr=0.7369 | fpr=0.8513 | 7539.7 samples/s | 29.5 steps/s
[Step= 450] | Loss=8.67545 | acc=0.1588 | tpr=0.7327 | fpr=0.8517 | 7630.7 samples/s | 29.8 steps/s
[Step= 500] | Loss=8.69122 | acc=0.1581 | tpr=0.7357 | fpr=0.8523 | 7476.5 samples/s | 29.2 steps/s
[Step= 550] | Loss=8.68973 | acc=0.1579 | tpr=0.7302 | fpr=0.8525 | 14155.9 samples/s | 55.3 steps/s
Avg test loss: 8.69249, Avg test acc: 0.15775, Avg tpr: 0.73059, Avg fpr: 0.85267, total FA: 118391

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08545 | acc=0.9822 | tpr=0.9558 | fpr=0.0173 | 4117.8 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.08989 | acc=0.9816 | tpr=0.9638 | fpr=0.0180 | 7682.8 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.09464 | acc=0.9807 | tpr=0.9640 | fpr=0.0190 | 7775.7 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.09513 | acc=0.9809 | tpr=0.9694 | fpr=0.0189 | 7436.5 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.09472 | acc=0.9810 | tpr=0.9659 | fpr=0.0187 | 7427.8 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.09545 | acc=0.9809 | tpr=0.9658 | fpr=0.0188 | 7434.7 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.09559 | acc=0.9809 | tpr=0.9656 | fpr=0.0188 | 7305.2 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.09647 | acc=0.9807 | tpr=0.9623 | fpr=0.0190 | 7561.4 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.09803 | acc=0.9805 | tpr=0.9601 | fpr=0.0191 | 7343.2 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.09783 | acc=0.9806 | tpr=0.9617 | fpr=0.0191 | 7356.5 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.09746 | acc=0.9807 | tpr=0.9598 | fpr=0.0189 | 13817.4 samples/s | 54.0 steps/s
Avg test loss: 0.09732, Avg test acc: 0.98073, Avg tpr: 0.95998, Avg fpr: 0.01889, total FA: 2623

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15796 | acc=0.9791 | tpr=0.9469 | fpr=0.0203 | 3900.8 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.16766 | acc=0.9781 | tpr=0.9680 | fpr=0.0217 | 7544.4 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.17294 | acc=0.9773 | tpr=0.9683 | fpr=0.0225 | 7450.7 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.17373 | acc=0.9773 | tpr=0.9727 | fpr=0.0226 | 7725.7 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.17187 | acc=0.9773 | tpr=0.9738 | fpr=0.0226 | 7307.7 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.17477 | acc=0.9773 | tpr=0.9724 | fpr=0.0226 | 7682.5 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.17555 | acc=0.9772 | tpr=0.9712 | fpr=0.0227 | 7275.9 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.17716 | acc=0.9769 | tpr=0.9705 | fpr=0.0229 | 7573.6 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.18055 | acc=0.9765 | tpr=0.9688 | fpr=0.0234 | 7312.5 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.17935 | acc=0.9766 | tpr=0.9692 | fpr=0.0233 | 7187.4 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.17797 | acc=0.9768 | tpr=0.9702 | fpr=0.0231 | 13543.2 samples/s | 52.9 steps/s
Avg test loss: 0.17763, Avg test acc: 0.97684, Avg tpr: 0.97029, Avg fpr: 0.02304, total FA: 3199

server round 36/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00013, len=1
[Step=28801 Epoch=56.2] | Loss=0.00010 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.126 | L2-Norm(final)=2.699 | 4038.9 samples/s | 63.1 steps/s
[Step=28850 Epoch=56.3] | Loss=0.00271 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.124 | L2-Norm(final)=2.701 | 4381.7 samples/s | 68.5 steps/s
[Step=28900 Epoch=56.4] | Loss=0.00228 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.121 | L2-Norm(final)=2.702 | 4616.8 samples/s | 72.1 steps/s
[Step=28950 Epoch=56.5] | Loss=0.00231 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.119 | L2-Norm(final)=2.703 | 4656.0 samples/s | 72.8 steps/s
[Step=29000 Epoch=56.6] | Loss=0.00242 | Reg=0.00328 | acc=0.9844 | L2-Norm=18.116 | L2-Norm(final)=2.704 | 4631.0 samples/s | 72.4 steps/s
[Step=29050 Epoch=56.7] | Loss=0.00289 | Reg=0.00328 | acc=0.9844 | L2-Norm=18.113 | L2-Norm(final)=2.705 | 4561.8 samples/s | 71.3 steps/s
[Step=29100 Epoch=56.8] | Loss=0.00287 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.110 | L2-Norm(final)=2.704 | 4563.8 samples/s | 71.3 steps/s
[Step=29150 Epoch=56.9] | Loss=0.00295 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.107 | L2-Norm(final)=2.704 | 4516.4 samples/s | 70.6 steps/s
[Step=29200 Epoch=57.0] | Loss=0.00316 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.104 | L2-Norm(final)=2.704 | 4671.2 samples/s | 73.0 steps/s
[Step=29250 Epoch=57.0] | Loss=0.00297 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.101 | L2-Norm(final)=2.705 | 4663.2 samples/s | 72.9 steps/s
[Step=29300 Epoch=57.1] | Loss=0.00307 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.098 | L2-Norm(final)=2.705 | 5508.5 samples/s | 86.1 steps/s
[Step=29350 Epoch=57.2] | Loss=0.00310 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.095 | L2-Norm(final)=2.705 | 1892.4 samples/s | 29.6 steps/s
[Step=29400 Epoch=57.3] | Loss=0.00308 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.093 | L2-Norm(final)=2.705 | 4639.6 samples/s | 72.5 steps/s
[Step=29450 Epoch=57.4] | Loss=0.00314 | Reg=0.00327 | acc=0.9844 | L2-Norm=18.090 | L2-Norm(final)=2.706 | 4687.5 samples/s | 73.2 steps/s
[Step=29500 Epoch=57.5] | Loss=0.00312 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.087 | L2-Norm(final)=2.707 | 4699.0 samples/s | 73.4 steps/s
[Step=29550 Epoch=57.6] | Loss=0.00311 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.085 | L2-Norm(final)=2.707 | 4521.1 samples/s | 70.6 steps/s
[Step=29600 Epoch=57.7] | Loss=0.00312 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.082 | L2-Norm(final)=2.708 | 4649.2 samples/s | 72.6 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step29600.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00013, len=1
[Step=28801 Epoch=56.3] | Loss=0.00064 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.933 | L2-Norm(final)=2.556 | 4141.2 samples/s | 64.7 steps/s
[Step=28850 Epoch=56.4] | Loss=0.00289 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.932 | L2-Norm(final)=2.558 | 4413.9 samples/s | 69.0 steps/s
[Step=28900 Epoch=56.5] | Loss=0.00287 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.929 | L2-Norm(final)=2.557 | 4618.1 samples/s | 72.2 steps/s
[Step=28950 Epoch=56.6] | Loss=0.00311 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.926 | L2-Norm(final)=2.558 | 4550.4 samples/s | 71.1 steps/s
[Step=29000 Epoch=56.7] | Loss=0.00300 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.924 | L2-Norm(final)=2.558 | 4555.4 samples/s | 71.2 steps/s
[Step=29050 Epoch=56.8] | Loss=0.00315 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.921 | L2-Norm(final)=2.558 | 4564.6 samples/s | 71.3 steps/s
[Step=29100 Epoch=56.9] | Loss=0.00293 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.919 | L2-Norm(final)=2.558 | 4652.5 samples/s | 72.7 steps/s
[Step=29150 Epoch=57.0] | Loss=0.00288 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.917 | L2-Norm(final)=2.558 | 4691.4 samples/s | 73.3 steps/s
[Step=29200 Epoch=57.1] | Loss=0.00284 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.914 | L2-Norm(final)=2.559 | 4585.0 samples/s | 71.6 steps/s
[Step=29250 Epoch=57.2] | Loss=0.00280 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.912 | L2-Norm(final)=2.559 | 4548.9 samples/s | 71.1 steps/s
[Step=29300 Epoch=57.3] | Loss=0.00276 | Reg=0.00321 | acc=0.9688 | L2-Norm=17.910 | L2-Norm(final)=2.560 | 5618.3 samples/s | 87.8 steps/s
[Step=29350 Epoch=57.4] | Loss=0.00281 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.908 | L2-Norm(final)=2.560 | 1853.0 samples/s | 29.0 steps/s
[Step=29400 Epoch=57.5] | Loss=0.00281 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.906 | L2-Norm(final)=2.561 | 4637.2 samples/s | 72.5 steps/s
[Step=29450 Epoch=57.6] | Loss=0.00270 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.904 | L2-Norm(final)=2.562 | 4609.4 samples/s | 72.0 steps/s
[Step=29500 Epoch=57.7] | Loss=0.00267 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.901 | L2-Norm(final)=2.563 | 4623.8 samples/s | 72.2 steps/s
[Step=29550 Epoch=57.8] | Loss=0.00260 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.899 | L2-Norm(final)=2.563 | 4571.5 samples/s | 71.4 steps/s
[Step=29600 Epoch=57.9] | Loss=0.00263 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.897 | L2-Norm(final)=2.564 | 4620.7 samples/s | 72.2 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step29600.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00013, len=1
[Step=28801 Epoch=110.4] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.916 | L2-Norm(final)=8.975 | 3894.3 samples/s | 60.8 steps/s
[Step=28850 Epoch=110.5] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.914 | L2-Norm(final)=8.976 | 4303.8 samples/s | 67.2 steps/s
[Step=28900 Epoch=110.7] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.912 | L2-Norm(final)=8.977 | 4424.1 samples/s | 69.1 steps/s
[Step=28950 Epoch=110.9] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.911 | L2-Norm(final)=8.978 | 4043.4 samples/s | 63.2 steps/s
[Step=29000 Epoch=111.1] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.910 | L2-Norm(final)=8.979 | 4178.1 samples/s | 65.3 steps/s
[Step=29050 Epoch=111.3] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.908 | L2-Norm(final)=8.980 | 5131.2 samples/s | 80.2 steps/s
[Step=29100 Epoch=111.5] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.906 | L2-Norm(final)=8.981 | 1823.9 samples/s | 28.5 steps/s
[Step=29150 Epoch=111.7] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.905 | L2-Norm(final)=8.982 | 4188.0 samples/s | 65.4 steps/s
[Step=29200 Epoch=111.9] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.903 | L2-Norm(final)=8.983 | 4221.3 samples/s | 66.0 steps/s
[Step=29250 Epoch=112.1] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.901 | L2-Norm(final)=8.985 | 4174.1 samples/s | 65.2 steps/s
[Step=29300 Epoch=112.3] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.900 | L2-Norm(final)=8.986 | 4634.9 samples/s | 72.4 steps/s
[Step=29350 Epoch=112.5] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.898 | L2-Norm(final)=8.987 | 1938.2 samples/s | 30.3 steps/s
[Step=29400 Epoch=112.7] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.896 | L2-Norm(final)=8.988 | 4328.3 samples/s | 67.6 steps/s
[Step=29450 Epoch=112.8] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.894 | L2-Norm(final)=8.990 | 4311.9 samples/s | 67.4 steps/s
[Step=29500 Epoch=113.0] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.892 | L2-Norm(final)=8.991 | 4314.1 samples/s | 67.4 steps/s
[Step=29550 Epoch=113.2] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.891 | L2-Norm(final)=8.992 | 4270.1 samples/s | 66.7 steps/s
[Step=29600 Epoch=113.4] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.889 | L2-Norm(final)=8.994 | 1980.8 samples/s | 30.9 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step29600.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00013, len=1
[Step=28801 Epoch=110.9] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.924 | L2-Norm(final)=5.548 | 3940.2 samples/s | 61.6 steps/s
[Step=28850 Epoch=111.1] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.923 | L2-Norm(final)=5.549 | 4379.7 samples/s | 68.4 steps/s
[Step=28900 Epoch=111.2] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.922 | L2-Norm(final)=5.550 | 4263.2 samples/s | 66.6 steps/s
[Step=28950 Epoch=111.4] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.921 | L2-Norm(final)=5.550 | 4301.7 samples/s | 67.2 steps/s
[Step=29000 Epoch=111.6] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.920 | L2-Norm(final)=5.551 | 4249.7 samples/s | 66.4 steps/s
[Step=29050 Epoch=111.8] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.919 | L2-Norm(final)=5.551 | 5526.5 samples/s | 86.4 steps/s
[Step=29100 Epoch=112.0] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.919 | L2-Norm(final)=5.552 | 1828.3 samples/s | 28.6 steps/s
[Step=29150 Epoch=112.2] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.918 | L2-Norm(final)=5.552 | 4217.5 samples/s | 65.9 steps/s
[Step=29200 Epoch=112.4] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.917 | L2-Norm(final)=5.553 | 4190.5 samples/s | 65.5 steps/s
[Step=29250 Epoch=112.6] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.916 | L2-Norm(final)=5.554 | 4218.6 samples/s | 65.9 steps/s
[Step=29300 Epoch=112.8] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.915 | L2-Norm(final)=5.554 | 4800.8 samples/s | 75.0 steps/s
[Step=29350 Epoch=113.0] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.914 | L2-Norm(final)=5.555 | 1909.3 samples/s | 29.8 steps/s
[Step=29400 Epoch=113.2] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.913 | L2-Norm(final)=5.555 | 4352.7 samples/s | 68.0 steps/s
[Step=29450 Epoch=113.4] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.912 | L2-Norm(final)=5.556 | 4262.9 samples/s | 66.6 steps/s
[Step=29500 Epoch=113.6] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.911 | L2-Norm(final)=5.557 | 4195.1 samples/s | 65.5 steps/s
[Step=29550 Epoch=113.7] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.910 | L2-Norm(final)=5.557 | 4297.3 samples/s | 67.1 steps/s
[Step=29600 Epoch=113.9] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.909 | L2-Norm(final)=5.558 | 1931.1 samples/s | 30.2 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step29600.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.20343 | acc=0.9578 | tpr=0.9681 | fpr=0.0644 | 4059.2 samples/s | 15.9 steps/s
Avg test loss: 0.20989, Avg test acc: 0.95701, Avg tpr: 0.96736, Avg fpr: 0.06576, total FA: 513

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.18352 | acc=0.9592 | tpr=0.9704 | fpr=0.0652 | 4037.7 samples/s | 15.8 steps/s
Avg test loss: 0.19427, Avg test acc: 0.95793, Avg tpr: 0.96998, Avg fpr: 0.06858, total FA: 535

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.91023 | acc=0.3166 | tpr=0.0072 | fpr=0.0116 | 4034.1 samples/s | 15.8 steps/s
Avg test loss: 4.92959, Avg test acc: 0.31325, Avg tpr: 0.00670, Avg fpr: 0.01256, total FA: 98

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.68730 | acc=0.3141 | tpr=0.0031 | fpr=0.0107 | 3992.0 samples/s | 15.6 steps/s
Avg test loss: 5.71518, Avg test acc: 0.31228, Avg tpr: 0.00344, Avg fpr: 0.00846, total FA: 66

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.48299 | acc=0.1852 | tpr=0.7389 | fpr=0.8247 | 4078.1 samples/s | 15.9 steps/s
[Step= 100] | Loss=7.44897 | acc=0.1847 | tpr=0.7058 | fpr=0.8250 | 8143.1 samples/s | 31.8 steps/s
[Step= 150] | Loss=7.50084 | acc=0.1833 | tpr=0.7075 | fpr=0.8264 | 7716.5 samples/s | 30.1 steps/s
[Step= 200] | Loss=7.49157 | acc=0.1833 | tpr=0.7038 | fpr=0.8262 | 7656.3 samples/s | 29.9 steps/s
[Step= 250] | Loss=7.50612 | acc=0.1833 | tpr=0.7092 | fpr=0.8263 | 7991.6 samples/s | 31.2 steps/s
[Step= 300] | Loss=7.51464 | acc=0.1826 | tpr=0.7105 | fpr=0.8271 | 7670.5 samples/s | 30.0 steps/s
[Step= 350] | Loss=7.51171 | acc=0.1833 | tpr=0.7088 | fpr=0.8263 | 8272.2 samples/s | 32.3 steps/s
[Step= 400] | Loss=7.51123 | acc=0.1836 | tpr=0.7112 | fpr=0.8260 | 7626.0 samples/s | 29.8 steps/s
[Step= 450] | Loss=7.51090 | acc=0.1832 | tpr=0.7152 | fpr=0.8265 | 8058.6 samples/s | 31.5 steps/s
[Step= 500] | Loss=7.52109 | acc=0.1826 | tpr=0.7110 | fpr=0.8270 | 7656.5 samples/s | 29.9 steps/s
[Step= 550] | Loss=7.52247 | acc=0.1826 | tpr=0.7115 | fpr=0.8270 | 13697.9 samples/s | 53.5 steps/s
Avg test loss: 7.52518, Avg test acc: 0.18245, Avg tpr: 0.71117, Avg fpr: 0.82716, total FA: 114849

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=8.57925 | acc=0.1630 | tpr=0.7257 | fpr=0.8471 | 4186.0 samples/s | 16.4 steps/s
[Step= 100] | Loss=8.53614 | acc=0.1626 | tpr=0.7186 | fpr=0.8478 | 7767.3 samples/s | 30.3 steps/s
[Step= 150] | Loss=8.54738 | acc=0.1631 | tpr=0.7046 | fpr=0.8469 | 7939.9 samples/s | 31.0 steps/s
[Step= 200] | Loss=8.52336 | acc=0.1640 | tpr=0.7082 | fpr=0.8459 | 7465.5 samples/s | 29.2 steps/s
[Step= 250] | Loss=8.51974 | acc=0.1646 | tpr=0.7083 | fpr=0.8453 | 7801.0 samples/s | 30.5 steps/s
[Step= 300] | Loss=8.52289 | acc=0.1646 | tpr=0.7055 | fpr=0.8452 | 7482.2 samples/s | 29.2 steps/s
[Step= 350] | Loss=8.52028 | acc=0.1644 | tpr=0.7032 | fpr=0.8454 | 8067.4 samples/s | 31.5 steps/s
[Step= 400] | Loss=8.51385 | acc=0.1648 | tpr=0.7101 | fpr=0.8451 | 7614.8 samples/s | 29.7 steps/s
[Step= 450] | Loss=8.52550 | acc=0.1645 | tpr=0.7079 | fpr=0.8453 | 7543.5 samples/s | 29.5 steps/s
[Step= 500] | Loss=8.54165 | acc=0.1640 | tpr=0.7097 | fpr=0.8459 | 7629.1 samples/s | 29.8 steps/s
[Step= 550] | Loss=8.54078 | acc=0.1639 | tpr=0.7031 | fpr=0.8459 | 13482.4 samples/s | 52.7 steps/s
Avg test loss: 8.54319, Avg test acc: 0.16377, Avg tpr: 0.70365, Avg fpr: 0.84605, total FA: 117472

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08324 | acc=0.9820 | tpr=0.9558 | fpr=0.0175 | 4095.0 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.08764 | acc=0.9818 | tpr=0.9638 | fpr=0.0178 | 7745.4 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.09222 | acc=0.9812 | tpr=0.9640 | fpr=0.0185 | 7723.2 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.09270 | acc=0.9814 | tpr=0.9694 | fpr=0.0184 | 7878.9 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.09228 | acc=0.9815 | tpr=0.9659 | fpr=0.0182 | 7779.0 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.09301 | acc=0.9814 | tpr=0.9658 | fpr=0.0183 | 7872.7 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.09314 | acc=0.9814 | tpr=0.9656 | fpr=0.0184 | 7183.4 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.09400 | acc=0.9811 | tpr=0.9623 | fpr=0.0186 | 7662.8 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.09552 | acc=0.9809 | tpr=0.9601 | fpr=0.0187 | 7314.6 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.09534 | acc=0.9810 | tpr=0.9617 | fpr=0.0187 | 7481.6 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.09500 | acc=0.9811 | tpr=0.9598 | fpr=0.0185 | 14382.1 samples/s | 56.2 steps/s
Avg test loss: 0.09486, Avg test acc: 0.98113, Avg tpr: 0.95998, Avg fpr: 0.01849, total FA: 2567

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15629 | acc=0.9794 | tpr=0.9469 | fpr=0.0200 | 4013.5 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.16595 | acc=0.9784 | tpr=0.9680 | fpr=0.0214 | 7382.9 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.17117 | acc=0.9776 | tpr=0.9683 | fpr=0.0223 | 7757.6 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.17197 | acc=0.9776 | tpr=0.9727 | fpr=0.0223 | 7429.6 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.17015 | acc=0.9776 | tpr=0.9738 | fpr=0.0223 | 7537.5 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.17305 | acc=0.9776 | tpr=0.9724 | fpr=0.0224 | 7934.2 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.17380 | acc=0.9775 | tpr=0.9712 | fpr=0.0224 | 7242.6 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.17538 | acc=0.9772 | tpr=0.9705 | fpr=0.0227 | 7234.3 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.17872 | acc=0.9768 | tpr=0.9684 | fpr=0.0230 | 7265.4 samples/s | 28.4 steps/s
[Step= 500] | Loss=0.17755 | acc=0.9769 | tpr=0.9687 | fpr=0.0230 | 7249.2 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.17619 | acc=0.9771 | tpr=0.9698 | fpr=0.0228 | 13418.3 samples/s | 52.4 steps/s
Avg test loss: 0.17585, Avg test acc: 0.97711, Avg tpr: 0.96989, Avg fpr: 0.02276, total FA: 3160

server round 37/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00013, len=1
[Step=29601 Epoch=57.7] | Loss=0.00002 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.039 | L2-Norm(final)=2.715 | 3991.6 samples/s | 62.4 steps/s
[Step=29650 Epoch=57.8] | Loss=0.00300 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.036 | L2-Norm(final)=2.714 | 4163.1 samples/s | 65.0 steps/s
[Step=29700 Epoch=57.9] | Loss=0.00277 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.033 | L2-Norm(final)=2.715 | 4375.0 samples/s | 68.4 steps/s
[Step=29750 Epoch=58.0] | Loss=0.00284 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.031 | L2-Norm(final)=2.716 | 4565.4 samples/s | 71.3 steps/s
[Step=29800 Epoch=58.1] | Loss=0.00305 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.028 | L2-Norm(final)=2.717 | 4600.7 samples/s | 71.9 steps/s
[Step=29850 Epoch=58.2] | Loss=0.00333 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.026 | L2-Norm(final)=2.718 | 4680.4 samples/s | 73.1 steps/s
[Step=29900 Epoch=58.3] | Loss=0.00319 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.024 | L2-Norm(final)=2.717 | 4636.2 samples/s | 72.4 steps/s
[Step=29950 Epoch=58.4] | Loss=0.00324 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.022 | L2-Norm(final)=2.717 | 4565.7 samples/s | 71.3 steps/s
[Step=30000 Epoch=58.5] | Loss=0.00323 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.020 | L2-Norm(final)=2.717 | 4547.5 samples/s | 71.1 steps/s
[Step=30050 Epoch=58.6] | Loss=0.00314 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.018 | L2-Norm(final)=2.717 | 4622.7 samples/s | 72.2 steps/s
[Step=30100 Epoch=58.7] | Loss=0.00310 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.016 | L2-Norm(final)=2.717 | 5651.3 samples/s | 88.3 steps/s
[Step=30150 Epoch=58.8] | Loss=0.00314 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.014 | L2-Norm(final)=2.718 | 1854.2 samples/s | 29.0 steps/s
[Step=30200 Epoch=58.9] | Loss=0.00304 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.012 | L2-Norm(final)=2.718 | 4495.0 samples/s | 70.2 steps/s
[Step=30250 Epoch=59.0] | Loss=0.00304 | Reg=0.00324 | acc=0.9844 | L2-Norm=18.010 | L2-Norm(final)=2.719 | 4557.9 samples/s | 71.2 steps/s
[Step=30300 Epoch=59.1] | Loss=0.00302 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.008 | L2-Norm(final)=2.720 | 4598.0 samples/s | 71.8 steps/s
[Step=30350 Epoch=59.2] | Loss=0.00302 | Reg=0.00324 | acc=0.9844 | L2-Norm=18.006 | L2-Norm(final)=2.720 | 4627.2 samples/s | 72.3 steps/s
[Step=30400 Epoch=59.3] | Loss=0.00301 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.004 | L2-Norm(final)=2.721 | 4697.3 samples/s | 73.4 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step30400.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00013, len=1
[Step=29601 Epoch=57.9] | Loss=0.00179 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.858 | L2-Norm(final)=2.576 | 4197.0 samples/s | 65.6 steps/s
[Step=29650 Epoch=58.0] | Loss=0.00252 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.856 | L2-Norm(final)=2.577 | 4564.1 samples/s | 71.3 steps/s
[Step=29700 Epoch=58.1] | Loss=0.00205 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.854 | L2-Norm(final)=2.578 | 4554.3 samples/s | 71.2 steps/s
[Step=29750 Epoch=58.2] | Loss=0.00211 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.851 | L2-Norm(final)=2.579 | 4681.8 samples/s | 73.2 steps/s
[Step=29800 Epoch=58.3] | Loss=0.00202 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.848 | L2-Norm(final)=2.580 | 4682.1 samples/s | 73.2 steps/s
[Step=29850 Epoch=58.4] | Loss=0.00230 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.845 | L2-Norm(final)=2.580 | 4674.0 samples/s | 73.0 steps/s
[Step=29900 Epoch=58.5] | Loss=0.00252 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.842 | L2-Norm(final)=2.580 | 4545.5 samples/s | 71.0 steps/s
[Step=29950 Epoch=58.6] | Loss=0.00256 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.839 | L2-Norm(final)=2.580 | 4633.2 samples/s | 72.4 steps/s
[Step=30000 Epoch=58.6] | Loss=0.00242 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.836 | L2-Norm(final)=2.580 | 4638.6 samples/s | 72.5 steps/s
[Step=30050 Epoch=58.7] | Loss=0.00249 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.834 | L2-Norm(final)=2.581 | 4671.3 samples/s | 73.0 steps/s
[Step=30100 Epoch=58.8] | Loss=0.00258 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.831 | L2-Norm(final)=2.581 | 5689.7 samples/s | 88.9 steps/s
[Step=30150 Epoch=58.9] | Loss=0.00251 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.829 | L2-Norm(final)=2.582 | 1930.6 samples/s | 30.2 steps/s
[Step=30200 Epoch=59.0] | Loss=0.00254 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.826 | L2-Norm(final)=2.583 | 4463.7 samples/s | 69.7 steps/s
[Step=30250 Epoch=59.1] | Loss=0.00258 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.824 | L2-Norm(final)=2.583 | 4695.4 samples/s | 73.4 steps/s
[Step=30300 Epoch=59.2] | Loss=0.00258 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.821 | L2-Norm(final)=2.583 | 4557.4 samples/s | 71.2 steps/s
[Step=30350 Epoch=59.3] | Loss=0.00253 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.819 | L2-Norm(final)=2.584 | 4578.2 samples/s | 71.5 steps/s
[Step=30400 Epoch=59.4] | Loss=0.00251 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.816 | L2-Norm(final)=2.585 | 4574.9 samples/s | 71.5 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step30400.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00013, len=1
[Step=29601 Epoch=113.4] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.858 | L2-Norm(final)=9.015 | 3891.4 samples/s | 60.8 steps/s
[Step=29650 Epoch=113.6] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.856 | L2-Norm(final)=9.017 | 4299.1 samples/s | 67.2 steps/s
[Step=29700 Epoch=113.8] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.854 | L2-Norm(final)=9.018 | 4396.2 samples/s | 68.7 steps/s
[Step=29750 Epoch=114.0] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.851 | L2-Norm(final)=9.020 | 4314.6 samples/s | 67.4 steps/s
[Step=29800 Epoch=114.2] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.849 | L2-Norm(final)=9.021 | 4368.6 samples/s | 68.3 steps/s
[Step=29850 Epoch=114.4] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.847 | L2-Norm(final)=9.023 | 5351.3 samples/s | 83.6 steps/s
[Step=29900 Epoch=114.6] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.845 | L2-Norm(final)=9.025 | 1886.7 samples/s | 29.5 steps/s
[Step=29950 Epoch=114.8] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.843 | L2-Norm(final)=9.027 | 4312.8 samples/s | 67.4 steps/s
[Step=30000 Epoch=114.9] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.841 | L2-Norm(final)=9.029 | 4362.6 samples/s | 68.2 steps/s
[Step=30050 Epoch=115.1] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.838 | L2-Norm(final)=9.031 | 4182.1 samples/s | 65.3 steps/s
[Step=30100 Epoch=115.3] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.836 | L2-Norm(final)=9.033 | 4799.6 samples/s | 75.0 steps/s
[Step=30150 Epoch=115.5] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.834 | L2-Norm(final)=9.035 | 1946.9 samples/s | 30.4 steps/s
[Step=30200 Epoch=115.7] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.831 | L2-Norm(final)=9.037 | 4319.1 samples/s | 67.5 steps/s
[Step=30250 Epoch=115.9] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.829 | L2-Norm(final)=9.039 | 4226.6 samples/s | 66.0 steps/s
[Step=30300 Epoch=116.1] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.826 | L2-Norm(final)=9.041 | 4219.9 samples/s | 65.9 steps/s
[Step=30350 Epoch=116.3] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.824 | L2-Norm(final)=9.043 | 4196.7 samples/s | 65.6 steps/s
[Step=30400 Epoch=116.5] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.821 | L2-Norm(final)=9.045 | 1940.8 samples/s | 30.3 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step30400.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00013, len=1
[Step=29601 Epoch=113.9] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.893 | L2-Norm(final)=5.569 | 3889.3 samples/s | 60.8 steps/s
[Step=29650 Epoch=114.1] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.891 | L2-Norm(final)=5.569 | 4144.1 samples/s | 64.8 steps/s
[Step=29700 Epoch=114.3] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.890 | L2-Norm(final)=5.570 | 4304.5 samples/s | 67.3 steps/s
[Step=29750 Epoch=114.5] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.889 | L2-Norm(final)=5.571 | 4312.8 samples/s | 67.4 steps/s
[Step=29800 Epoch=114.7] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.888 | L2-Norm(final)=5.572 | 4392.3 samples/s | 68.6 steps/s
[Step=29850 Epoch=114.9] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.886 | L2-Norm(final)=5.573 | 5361.7 samples/s | 83.8 steps/s
[Step=29900 Epoch=115.1] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.885 | L2-Norm(final)=5.573 | 1856.1 samples/s | 29.0 steps/s
[Step=29950 Epoch=115.3] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.884 | L2-Norm(final)=5.574 | 4303.3 samples/s | 67.2 steps/s
[Step=30000 Epoch=115.5] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.883 | L2-Norm(final)=5.575 | 4212.0 samples/s | 65.8 steps/s
[Step=30050 Epoch=115.7] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.881 | L2-Norm(final)=5.576 | 4270.8 samples/s | 66.7 steps/s
[Step=30100 Epoch=115.9] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.880 | L2-Norm(final)=5.577 | 4953.5 samples/s | 77.4 steps/s
[Step=30150 Epoch=116.1] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.879 | L2-Norm(final)=5.578 | 1896.1 samples/s | 29.6 steps/s
[Step=30200 Epoch=116.3] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.877 | L2-Norm(final)=5.579 | 4305.4 samples/s | 67.3 steps/s
[Step=30250 Epoch=116.4] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.876 | L2-Norm(final)=5.580 | 4228.9 samples/s | 66.1 steps/s
[Step=30300 Epoch=116.6] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.874 | L2-Norm(final)=5.580 | 4147.3 samples/s | 64.8 steps/s
[Step=30350 Epoch=116.8] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.873 | L2-Norm(final)=5.581 | 4331.2 samples/s | 67.7 steps/s
[Step=30400 Epoch=117.0] | Loss=0.00000 | Reg=0.00024 | acc=1.0000 | L2-Norm=4.872 | L2-Norm(final)=5.582 | 1990.2 samples/s | 31.1 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step30400.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.20444 | acc=0.9592 | tpr=0.9712 | fpr=0.0669 | 4005.6 samples/s | 15.6 steps/s
Avg test loss: 0.20967, Avg test acc: 0.95805, Avg tpr: 0.96992, Avg fpr: 0.06807, total FA: 531

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.18566 | acc=0.9596 | tpr=0.9691 | fpr=0.0610 | 3985.0 samples/s | 15.6 steps/s
Avg test loss: 0.19590, Avg test acc: 0.95841, Avg tpr: 0.96911, Avg fpr: 0.06512, total FA: 508

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.92938 | acc=0.3167 | tpr=0.0068 | fpr=0.0104 | 3988.6 samples/s | 15.6 steps/s
Avg test loss: 4.94911, Avg test acc: 0.31349, Avg tpr: 0.00629, Avg fpr: 0.01090, total FA: 85

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.73228 | acc=0.3141 | tpr=0.0031 | fpr=0.0107 | 4034.4 samples/s | 15.8 steps/s
Avg test loss: 5.76044, Avg test acc: 0.31228, Avg tpr: 0.00344, Avg fpr: 0.00846, total FA: 66

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=7.65465 | acc=0.1759 | tpr=0.7743 | fpr=0.8349 | 4003.6 samples/s | 15.6 steps/s
[Step= 100] | Loss=7.62281 | acc=0.1748 | tpr=0.7313 | fpr=0.8355 | 7374.2 samples/s | 28.8 steps/s
[Step= 150] | Loss=7.67633 | acc=0.1735 | tpr=0.7363 | fpr=0.8368 | 7316.5 samples/s | 28.6 steps/s
[Step= 200] | Loss=7.66937 | acc=0.1726 | tpr=0.7301 | fpr=0.8375 | 8103.3 samples/s | 31.7 steps/s
[Step= 250] | Loss=7.68357 | acc=0.1730 | tpr=0.7380 | fpr=0.8373 | 7510.5 samples/s | 29.3 steps/s
[Step= 300] | Loss=7.69217 | acc=0.1720 | tpr=0.7367 | fpr=0.8382 | 7981.3 samples/s | 31.2 steps/s
[Step= 350] | Loss=7.68866 | acc=0.1726 | tpr=0.7370 | fpr=0.8376 | 7764.7 samples/s | 30.3 steps/s
[Step= 400] | Loss=7.68944 | acc=0.1727 | tpr=0.7380 | fpr=0.8375 | 7659.0 samples/s | 29.9 steps/s
[Step= 450] | Loss=7.68934 | acc=0.1724 | tpr=0.7420 | fpr=0.8379 | 7924.7 samples/s | 31.0 steps/s
[Step= 500] | Loss=7.69969 | acc=0.1719 | tpr=0.7370 | fpr=0.8383 | 7674.9 samples/s | 30.0 steps/s
[Step= 550] | Loss=7.70090 | acc=0.1719 | tpr=0.7374 | fpr=0.8383 | 14568.9 samples/s | 56.9 steps/s
Avg test loss: 7.70370, Avg test acc: 0.17178, Avg tpr: 0.73693, Avg fpr: 0.83849, total FA: 116423

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=8.69797 | acc=0.1673 | tpr=0.7345 | fpr=0.8429 | 4153.7 samples/s | 16.2 steps/s
[Step= 100] | Loss=8.66013 | acc=0.1672 | tpr=0.7186 | fpr=0.8431 | 8112.9 samples/s | 31.7 steps/s
[Step= 150] | Loss=8.67054 | acc=0.1677 | tpr=0.7104 | fpr=0.8423 | 7541.4 samples/s | 29.5 steps/s
[Step= 200] | Loss=8.64195 | acc=0.1683 | tpr=0.7115 | fpr=0.8416 | 7917.2 samples/s | 30.9 steps/s
[Step= 250] | Loss=8.64072 | acc=0.1687 | tpr=0.7083 | fpr=0.8411 | 7617.8 samples/s | 29.8 steps/s
[Step= 300] | Loss=8.64271 | acc=0.1688 | tpr=0.7033 | fpr=0.8410 | 8167.0 samples/s | 31.9 steps/s
[Step= 350] | Loss=8.63904 | acc=0.1686 | tpr=0.7019 | fpr=0.8411 | 7468.3 samples/s | 29.2 steps/s
[Step= 400] | Loss=8.63209 | acc=0.1687 | tpr=0.7079 | fpr=0.8411 | 7671.8 samples/s | 30.0 steps/s
[Step= 450] | Loss=8.64351 | acc=0.1684 | tpr=0.7040 | fpr=0.8413 | 7861.2 samples/s | 30.7 steps/s
[Step= 500] | Loss=8.65867 | acc=0.1677 | tpr=0.7048 | fpr=0.8420 | 7713.6 samples/s | 30.1 steps/s
[Step= 550] | Loss=8.65711 | acc=0.1677 | tpr=0.6980 | fpr=0.8420 | 13965.3 samples/s | 54.6 steps/s
Avg test loss: 8.65944, Avg test acc: 0.16752, Avg tpr: 0.69810, Avg fpr: 0.84213, total FA: 116928

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08128 | acc=0.9821 | tpr=0.9513 | fpr=0.0173 | 4068.5 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.08567 | acc=0.9820 | tpr=0.9616 | fpr=0.0176 | 7465.7 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.09010 | acc=0.9814 | tpr=0.9625 | fpr=0.0182 | 7894.6 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.09056 | acc=0.9816 | tpr=0.9683 | fpr=0.0181 | 7558.9 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.09010 | acc=0.9818 | tpr=0.9651 | fpr=0.0179 | 8117.8 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.09085 | acc=0.9817 | tpr=0.9644 | fpr=0.0180 | 7657.2 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.09099 | acc=0.9816 | tpr=0.9643 | fpr=0.0181 | 7285.3 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.09181 | acc=0.9813 | tpr=0.9606 | fpr=0.0183 | 7392.0 samples/s | 28.9 steps/s
[Step= 450] | Loss=0.09331 | acc=0.9812 | tpr=0.9591 | fpr=0.0184 | 7524.1 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.09316 | acc=0.9812 | tpr=0.9608 | fpr=0.0184 | 7571.3 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.09283 | acc=0.9814 | tpr=0.9590 | fpr=0.0182 | 13635.9 samples/s | 53.3 steps/s
Avg test loss: 0.09269, Avg test acc: 0.98138, Avg tpr: 0.95919, Avg fpr: 0.01822, total FA: 2530

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15496 | acc=0.9794 | tpr=0.9469 | fpr=0.0200 | 3969.9 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.16459 | acc=0.9784 | tpr=0.9680 | fpr=0.0214 | 7603.5 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.16977 | acc=0.9775 | tpr=0.9683 | fpr=0.0224 | 7471.1 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.17061 | acc=0.9775 | tpr=0.9727 | fpr=0.0224 | 7679.7 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.16881 | acc=0.9775 | tpr=0.9738 | fpr=0.0224 | 7264.3 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.17170 | acc=0.9775 | tpr=0.9724 | fpr=0.0224 | 7384.1 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.17241 | acc=0.9774 | tpr=0.9712 | fpr=0.0225 | 7433.9 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.17396 | acc=0.9771 | tpr=0.9699 | fpr=0.0228 | 7628.9 samples/s | 29.8 steps/s
[Step= 450] | Loss=0.17725 | acc=0.9767 | tpr=0.9684 | fpr=0.0232 | 7187.9 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.17609 | acc=0.9768 | tpr=0.9687 | fpr=0.0231 | 7516.9 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.17475 | acc=0.9770 | tpr=0.9698 | fpr=0.0229 | 13549.7 samples/s | 52.9 steps/s
Avg test loss: 0.17441, Avg test acc: 0.97699, Avg tpr: 0.96989, Avg fpr: 0.02288, total FA: 3177

server round 38/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00013, len=1
[Step=30401 Epoch=59.3] | Loss=0.00009 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.970 | L2-Norm(final)=2.729 | 4089.8 samples/s | 63.9 steps/s
[Step=30450 Epoch=59.4] | Loss=0.00391 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.968 | L2-Norm(final)=2.730 | 3981.2 samples/s | 62.2 steps/s
[Step=30500 Epoch=59.5] | Loss=0.00313 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.965 | L2-Norm(final)=2.731 | 4396.3 samples/s | 68.7 steps/s
[Step=30550 Epoch=59.6] | Loss=0.00329 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.963 | L2-Norm(final)=2.731 | 4458.0 samples/s | 69.7 steps/s
[Step=30600 Epoch=59.7] | Loss=0.00320 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.961 | L2-Norm(final)=2.731 | 4282.7 samples/s | 66.9 steps/s
[Step=30650 Epoch=59.8] | Loss=0.00316 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=2.732 | 4431.9 samples/s | 69.2 steps/s
[Step=30700 Epoch=59.9] | Loss=0.00292 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.956 | L2-Norm(final)=2.732 | 4596.8 samples/s | 71.8 steps/s
[Step=30750 Epoch=60.0] | Loss=0.00302 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.954 | L2-Norm(final)=2.732 | 4473.1 samples/s | 69.9 steps/s
[Step=30800 Epoch=60.1] | Loss=0.00326 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.952 | L2-Norm(final)=2.731 | 4461.7 samples/s | 69.7 steps/s
[Step=30850 Epoch=60.2] | Loss=0.00310 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.950 | L2-Norm(final)=2.731 | 4626.6 samples/s | 72.3 steps/s
[Step=30900 Epoch=60.3] | Loss=0.00307 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.947 | L2-Norm(final)=2.732 | 5611.8 samples/s | 87.7 steps/s
[Step=30950 Epoch=60.4] | Loss=0.00303 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.945 | L2-Norm(final)=2.732 | 1891.2 samples/s | 29.6 steps/s
[Step=31000 Epoch=60.5] | Loss=0.00304 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.943 | L2-Norm(final)=2.732 | 4581.5 samples/s | 71.6 steps/s
[Step=31050 Epoch=60.6] | Loss=0.00295 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.941 | L2-Norm(final)=2.733 | 4555.5 samples/s | 71.2 steps/s
[Step=31100 Epoch=60.7] | Loss=0.00299 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.939 | L2-Norm(final)=2.733 | 4665.7 samples/s | 72.9 steps/s
[Step=31150 Epoch=60.8] | Loss=0.00294 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.937 | L2-Norm(final)=2.734 | 4632.7 samples/s | 72.4 steps/s
[Step=31200 Epoch=60.9] | Loss=0.00298 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.934 | L2-Norm(final)=2.734 | 4593.1 samples/s | 71.8 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step31200.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00013, len=1
[Step=30401 Epoch=59.4] | Loss=0.00493 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.777 | L2-Norm(final)=2.594 | 4103.4 samples/s | 64.1 steps/s
[Step=30450 Epoch=59.5] | Loss=0.00537 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.773 | L2-Norm(final)=2.589 | 4070.7 samples/s | 63.6 steps/s
[Step=30500 Epoch=59.6] | Loss=0.00381 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.772 | L2-Norm(final)=2.589 | 4592.8 samples/s | 71.8 steps/s
[Step=30550 Epoch=59.7] | Loss=0.00340 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.770 | L2-Norm(final)=2.589 | 4668.2 samples/s | 72.9 steps/s
[Step=30600 Epoch=59.8] | Loss=0.00303 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.768 | L2-Norm(final)=2.590 | 4615.4 samples/s | 72.1 steps/s
[Step=30650 Epoch=59.9] | Loss=0.00293 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.766 | L2-Norm(final)=2.592 | 4626.5 samples/s | 72.3 steps/s
[Step=30700 Epoch=60.0] | Loss=0.00281 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.764 | L2-Norm(final)=2.593 | 4672.1 samples/s | 73.0 steps/s
[Step=30750 Epoch=60.1] | Loss=0.00266 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.762 | L2-Norm(final)=2.594 | 4587.0 samples/s | 71.7 steps/s
[Step=30800 Epoch=60.2] | Loss=0.00298 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.760 | L2-Norm(final)=2.595 | 4628.3 samples/s | 72.3 steps/s
[Step=30850 Epoch=60.3] | Loss=0.00310 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.758 | L2-Norm(final)=2.595 | 4598.1 samples/s | 71.8 steps/s
[Step=30900 Epoch=60.4] | Loss=0.00313 | Reg=0.00315 | acc=0.9844 | L2-Norm=17.756 | L2-Norm(final)=2.594 | 5597.4 samples/s | 87.5 steps/s
[Step=30950 Epoch=60.5] | Loss=0.00303 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.753 | L2-Norm(final)=2.594 | 1918.4 samples/s | 30.0 steps/s
[Step=31000 Epoch=60.6] | Loss=0.00302 | Reg=0.00315 | acc=0.9844 | L2-Norm=17.751 | L2-Norm(final)=2.594 | 4624.4 samples/s | 72.3 steps/s
[Step=31050 Epoch=60.7] | Loss=0.00299 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.749 | L2-Norm(final)=2.594 | 4662.5 samples/s | 72.9 steps/s
[Step=31100 Epoch=60.8] | Loss=0.00302 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.747 | L2-Norm(final)=2.595 | 4596.2 samples/s | 71.8 steps/s
[Step=31150 Epoch=60.9] | Loss=0.00299 | Reg=0.00315 | acc=0.9688 | L2-Norm=17.745 | L2-Norm(final)=2.595 | 4556.9 samples/s | 71.2 steps/s
[Step=31200 Epoch=61.0] | Loss=0.00289 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.742 | L2-Norm(final)=2.595 | 4548.3 samples/s | 71.1 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step31200.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00013, len=1
[Step=30401 Epoch=116.5] | Loss=0.00000 | Reg=0.00014 | acc=1.0000 | L2-Norm=3.781 | L2-Norm(final)=9.080 | 3934.3 samples/s | 61.5 steps/s
[Step=30450 Epoch=116.7] | Loss=0.00000 | Reg=0.00014 | acc=1.0000 | L2-Norm=3.778 | L2-Norm(final)=9.083 | 4442.1 samples/s | 69.4 steps/s
[Step=30500 Epoch=116.9] | Loss=0.00000 | Reg=0.00014 | acc=1.0000 | L2-Norm=3.775 | L2-Norm(final)=9.086 | 4368.7 samples/s | 68.3 steps/s
[Step=30550 Epoch=117.1] | Loss=0.00000 | Reg=0.00014 | acc=1.0000 | L2-Norm=3.772 | L2-Norm(final)=9.088 | 4293.4 samples/s | 67.1 steps/s
[Step=30600 Epoch=117.2] | Loss=0.00000 | Reg=0.00014 | acc=1.0000 | L2-Norm=3.769 | L2-Norm(final)=9.091 | 4279.7 samples/s | 66.9 steps/s
[Step=30650 Epoch=117.4] | Loss=0.00000 | Reg=0.00014 | acc=1.0000 | L2-Norm=3.766 | L2-Norm(final)=9.093 | 5393.2 samples/s | 84.3 steps/s
[Step=30700 Epoch=117.6] | Loss=0.00000 | Reg=0.00014 | acc=1.0000 | L2-Norm=3.763 | L2-Norm(final)=9.096 | 1890.4 samples/s | 29.5 steps/s
[Step=30750 Epoch=117.8] | Loss=0.00000 | Reg=0.00014 | acc=1.0000 | L2-Norm=3.760 | L2-Norm(final)=9.099 | 4228.6 samples/s | 66.1 steps/s
[Step=30800 Epoch=118.0] | Loss=0.00000 | Reg=0.00014 | acc=1.0000 | L2-Norm=3.757 | L2-Norm(final)=9.102 | 4307.2 samples/s | 67.3 steps/s
[Step=30850 Epoch=118.2] | Loss=0.00000 | Reg=0.00014 | acc=1.0000 | L2-Norm=3.754 | L2-Norm(final)=9.105 | 4245.5 samples/s | 66.3 steps/s
[Step=30900 Epoch=118.4] | Loss=0.00000 | Reg=0.00014 | acc=1.0000 | L2-Norm=3.751 | L2-Norm(final)=9.108 | 4694.1 samples/s | 73.3 steps/s
[Step=30950 Epoch=118.6] | Loss=0.00000 | Reg=0.00014 | acc=1.0000 | L2-Norm=3.748 | L2-Norm(final)=9.111 | 1889.2 samples/s | 29.5 steps/s
[Step=31000 Epoch=118.8] | Loss=0.00000 | Reg=0.00014 | acc=1.0000 | L2-Norm=3.745 | L2-Norm(final)=9.115 | 3991.6 samples/s | 62.4 steps/s
[Step=31050 Epoch=119.0] | Loss=0.00000 | Reg=0.00014 | acc=1.0000 | L2-Norm=3.742 | L2-Norm(final)=9.118 | 3983.9 samples/s | 62.2 steps/s
[Step=31100 Epoch=119.2] | Loss=0.00000 | Reg=0.00014 | acc=1.0000 | L2-Norm=3.739 | L2-Norm(final)=9.121 | 4127.1 samples/s | 64.5 steps/s
[Step=31150 Epoch=119.4] | Loss=0.00000 | Reg=0.00014 | acc=1.0000 | L2-Norm=3.736 | L2-Norm(final)=9.125 | 4122.4 samples/s | 64.4 steps/s
[Step=31200 Epoch=119.5] | Loss=0.00000 | Reg=0.00014 | acc=1.0000 | L2-Norm=3.732 | L2-Norm(final)=9.128 | 1923.6 samples/s | 30.1 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step31200.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00013, len=1
[Step=30401 Epoch=117.0] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.848 | L2-Norm(final)=5.598 | 3785.0 samples/s | 59.1 steps/s
[Step=30450 Epoch=117.2] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.846 | L2-Norm(final)=5.599 | 4309.1 samples/s | 67.3 steps/s
[Step=30500 Epoch=117.4] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.844 | L2-Norm(final)=5.600 | 4258.0 samples/s | 66.5 steps/s
[Step=30550 Epoch=117.6] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.842 | L2-Norm(final)=5.601 | 4234.8 samples/s | 66.2 steps/s
[Step=30600 Epoch=117.8] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.841 | L2-Norm(final)=5.602 | 4392.5 samples/s | 68.6 steps/s
[Step=30650 Epoch=118.0] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.839 | L2-Norm(final)=5.603 | 5562.7 samples/s | 86.9 steps/s
[Step=30700 Epoch=118.2] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.837 | L2-Norm(final)=5.605 | 1761.4 samples/s | 27.5 steps/s
[Step=30750 Epoch=118.4] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.835 | L2-Norm(final)=5.606 | 4262.4 samples/s | 66.6 steps/s
[Step=30800 Epoch=118.6] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.833 | L2-Norm(final)=5.607 | 4212.1 samples/s | 65.8 steps/s
[Step=30850 Epoch=118.8] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.831 | L2-Norm(final)=5.608 | 4221.2 samples/s | 66.0 steps/s
[Step=30900 Epoch=118.9] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.830 | L2-Norm(final)=5.609 | 4830.3 samples/s | 75.5 steps/s
[Step=30950 Epoch=119.1] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.828 | L2-Norm(final)=5.611 | 1905.2 samples/s | 29.8 steps/s
[Step=31000 Epoch=119.3] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.826 | L2-Norm(final)=5.612 | 4223.8 samples/s | 66.0 steps/s
[Step=31050 Epoch=119.5] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.824 | L2-Norm(final)=5.613 | 4199.6 samples/s | 65.6 steps/s
[Step=31100 Epoch=119.7] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.822 | L2-Norm(final)=5.615 | 4224.7 samples/s | 66.0 steps/s
[Step=31150 Epoch=119.9] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.820 | L2-Norm(final)=5.616 | 4206.1 samples/s | 65.7 steps/s
[Step=31200 Epoch=120.1] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.818 | L2-Norm(final)=5.617 | 1985.5 samples/s | 31.0 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step31200.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.20605 | acc=0.9589 | tpr=0.9724 | fpr=0.0704 | 4055.7 samples/s | 15.8 steps/s
Avg test loss: 0.21173, Avg test acc: 0.95817, Avg tpr: 0.97167, Avg fpr: 0.07153, total FA: 558

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.18010 | acc=0.9588 | tpr=0.9676 | fpr=0.0602 | 4018.7 samples/s | 15.7 steps/s
Avg test loss: 0.18993, Avg test acc: 0.95761, Avg tpr: 0.96759, Avg fpr: 0.06435, total FA: 502

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.83292 | acc=0.3170 | tpr=0.0076 | fpr=0.0111 | 3987.5 samples/s | 15.6 steps/s
Avg test loss: 4.85276, Avg test acc: 0.31389, Avg tpr: 0.00734, Avg fpr: 0.01192, total FA: 93

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.81116 | acc=0.3142 | tpr=0.0029 | fpr=0.0097 | 3996.3 samples/s | 15.6 steps/s
Avg test loss: 5.83974, Avg test acc: 0.31224, Avg tpr: 0.00315, Avg fpr: 0.00795, total FA: 62

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.08925 | acc=0.1665 | tpr=0.8053 | fpr=0.8450 | 3967.7 samples/s | 15.5 steps/s
[Step= 100] | Loss=8.05183 | acc=0.1657 | tpr=0.7591 | fpr=0.8453 | 7328.3 samples/s | 28.6 steps/s
[Step= 150] | Loss=8.10677 | acc=0.1648 | tpr=0.7608 | fpr=0.8462 | 7631.7 samples/s | 29.8 steps/s
[Step= 200] | Loss=8.09926 | acc=0.1637 | tpr=0.7508 | fpr=0.8470 | 7608.8 samples/s | 29.7 steps/s
[Step= 250] | Loss=8.11483 | acc=0.1636 | tpr=0.7546 | fpr=0.8472 | 7429.6 samples/s | 29.0 steps/s
[Step= 300] | Loss=8.12345 | acc=0.1627 | tpr=0.7520 | fpr=0.8480 | 8084.8 samples/s | 31.6 steps/s
[Step= 350] | Loss=8.12034 | acc=0.1631 | tpr=0.7533 | fpr=0.8476 | 7715.5 samples/s | 30.1 steps/s
[Step= 400] | Loss=8.12136 | acc=0.1633 | tpr=0.7527 | fpr=0.8474 | 8020.9 samples/s | 31.3 steps/s
[Step= 450] | Loss=8.12116 | acc=0.1629 | tpr=0.7571 | fpr=0.8479 | 7593.0 samples/s | 29.7 steps/s
[Step= 500] | Loss=8.13159 | acc=0.1625 | tpr=0.7520 | fpr=0.8481 | 7648.2 samples/s | 29.9 steps/s
[Step= 550] | Loss=8.13224 | acc=0.1625 | tpr=0.7533 | fpr=0.8483 | 14964.0 samples/s | 58.5 steps/s
Avg test loss: 8.13499, Avg test acc: 0.16232, Avg tpr: 0.75317, Avg fpr: 0.84842, total FA: 117801

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=8.52695 | acc=0.1668 | tpr=0.7345 | fpr=0.8434 | 4091.3 samples/s | 16.0 steps/s
[Step= 100] | Loss=8.47966 | acc=0.1657 | tpr=0.7058 | fpr=0.8444 | 7967.3 samples/s | 31.1 steps/s
[Step= 150] | Loss=8.48934 | acc=0.1665 | tpr=0.7017 | fpr=0.8434 | 7700.1 samples/s | 30.1 steps/s
[Step= 200] | Loss=8.46299 | acc=0.1674 | tpr=0.7038 | fpr=0.8424 | 7956.6 samples/s | 31.1 steps/s
[Step= 250] | Loss=8.46149 | acc=0.1681 | tpr=0.7031 | fpr=0.8416 | 7609.5 samples/s | 29.7 steps/s
[Step= 300] | Loss=8.46227 | acc=0.1683 | tpr=0.7004 | fpr=0.8414 | 7766.9 samples/s | 30.3 steps/s
[Step= 350] | Loss=8.46027 | acc=0.1677 | tpr=0.6994 | fpr=0.8419 | 7707.0 samples/s | 30.1 steps/s
[Step= 400] | Loss=8.45308 | acc=0.1678 | tpr=0.7057 | fpr=0.8420 | 7770.0 samples/s | 30.4 steps/s
[Step= 450] | Loss=8.46566 | acc=0.1675 | tpr=0.7016 | fpr=0.8422 | 7725.5 samples/s | 30.2 steps/s
[Step= 500] | Loss=8.48090 | acc=0.1668 | tpr=0.7035 | fpr=0.8429 | 7468.9 samples/s | 29.2 steps/s
[Step= 550] | Loss=8.48026 | acc=0.1666 | tpr=0.6952 | fpr=0.8430 | 13437.3 samples/s | 52.5 steps/s
Avg test loss: 8.48268, Avg test acc: 0.16650, Avg tpr: 0.69572, Avg fpr: 0.84312, total FA: 117066

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08614 | acc=0.9812 | tpr=0.9558 | fpr=0.0184 | 4108.8 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.09074 | acc=0.9807 | tpr=0.9680 | fpr=0.0190 | 7462.7 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.09531 | acc=0.9800 | tpr=0.9683 | fpr=0.0198 | 7703.2 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.09578 | acc=0.9802 | tpr=0.9738 | fpr=0.0197 | 7622.2 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.09526 | acc=0.9803 | tpr=0.9712 | fpr=0.0195 | 8163.9 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.09602 | acc=0.9802 | tpr=0.9716 | fpr=0.0196 | 7113.4 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.09613 | acc=0.9802 | tpr=0.9712 | fpr=0.0197 | 7359.7 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.09697 | acc=0.9799 | tpr=0.9677 | fpr=0.0198 | 7249.9 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.09847 | acc=0.9797 | tpr=0.9654 | fpr=0.0200 | 7509.4 samples/s | 29.3 steps/s
[Step= 500] | Loss=0.09834 | acc=0.9799 | tpr=0.9665 | fpr=0.0199 | 7562.3 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.09794 | acc=0.9800 | tpr=0.9650 | fpr=0.0198 | 13336.2 samples/s | 52.1 steps/s
Avg test loss: 0.09778, Avg test acc: 0.97998, Avg tpr: 0.96513, Avg fpr: 0.01975, total FA: 2742

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14806 | acc=0.9796 | tpr=0.9469 | fpr=0.0198 | 3877.4 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.15736 | acc=0.9787 | tpr=0.9680 | fpr=0.0211 | 7525.1 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.16223 | acc=0.9779 | tpr=0.9683 | fpr=0.0219 | 7461.7 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.16308 | acc=0.9779 | tpr=0.9727 | fpr=0.0220 | 7567.2 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.16135 | acc=0.9780 | tpr=0.9738 | fpr=0.0219 | 7187.9 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.16420 | acc=0.9780 | tpr=0.9724 | fpr=0.0219 | 7534.5 samples/s | 29.4 steps/s
[Step= 350] | Loss=0.16485 | acc=0.9779 | tpr=0.9712 | fpr=0.0220 | 7332.1 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.16631 | acc=0.9776 | tpr=0.9699 | fpr=0.0223 | 8036.5 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.16943 | acc=0.9772 | tpr=0.9684 | fpr=0.0227 | 6956.1 samples/s | 27.2 steps/s
[Step= 500] | Loss=0.16832 | acc=0.9772 | tpr=0.9683 | fpr=0.0226 | 7556.0 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.16706 | acc=0.9774 | tpr=0.9694 | fpr=0.0224 | 13367.9 samples/s | 52.2 steps/s
Avg test loss: 0.16673, Avg test acc: 0.97747, Avg tpr: 0.96949, Avg fpr: 0.02238, total FA: 3108

server round 39/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00013, len=1
[Step=31201 Epoch=60.9] | Loss=0.00004 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.899 | L2-Norm(final)=2.742 | 4040.6 samples/s | 63.1 steps/s
[Step=31250 Epoch=60.9] | Loss=0.00227 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.897 | L2-Norm(final)=2.743 | 4123.6 samples/s | 64.4 steps/s
[Step=31300 Epoch=61.0] | Loss=0.00185 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.894 | L2-Norm(final)=2.745 | 4394.4 samples/s | 68.7 steps/s
[Step=31350 Epoch=61.1] | Loss=0.00186 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.892 | L2-Norm(final)=2.746 | 4402.2 samples/s | 68.8 steps/s
[Step=31400 Epoch=61.2] | Loss=0.00206 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.890 | L2-Norm(final)=2.747 | 4460.0 samples/s | 69.7 steps/s
[Step=31450 Epoch=61.3] | Loss=0.00239 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.887 | L2-Norm(final)=2.747 | 4453.8 samples/s | 69.6 steps/s
[Step=31500 Epoch=61.4] | Loss=0.00255 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.884 | L2-Norm(final)=2.748 | 4509.9 samples/s | 70.5 steps/s
[Step=31550 Epoch=61.5] | Loss=0.00263 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.882 | L2-Norm(final)=2.748 | 4547.2 samples/s | 71.0 steps/s
[Step=31600 Epoch=61.6] | Loss=0.00265 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.879 | L2-Norm(final)=2.748 | 4631.0 samples/s | 72.4 steps/s
[Step=31650 Epoch=61.7] | Loss=0.00283 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.877 | L2-Norm(final)=2.748 | 4583.6 samples/s | 71.6 steps/s
[Step=31700 Epoch=61.8] | Loss=0.00275 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.874 | L2-Norm(final)=2.749 | 5682.7 samples/s | 88.8 steps/s
[Step=31750 Epoch=61.9] | Loss=0.00272 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.872 | L2-Norm(final)=2.749 | 1895.0 samples/s | 29.6 steps/s
[Step=31800 Epoch=62.0] | Loss=0.00270 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.869 | L2-Norm(final)=2.749 | 4562.2 samples/s | 71.3 steps/s
[Step=31850 Epoch=62.1] | Loss=0.00267 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.867 | L2-Norm(final)=2.750 | 4569.2 samples/s | 71.4 steps/s
[Step=31900 Epoch=62.2] | Loss=0.00268 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.865 | L2-Norm(final)=2.751 | 4671.8 samples/s | 73.0 steps/s
[Step=31950 Epoch=62.3] | Loss=0.00271 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.863 | L2-Norm(final)=2.752 | 4594.5 samples/s | 71.8 steps/s
[Step=32000 Epoch=62.4] | Loss=0.00274 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.860 | L2-Norm(final)=2.752 | 4610.2 samples/s | 72.0 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step32000.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00013, len=1
[Step=31201 Epoch=61.0] | Loss=0.00001 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.708 | L2-Norm(final)=2.597 | 4177.3 samples/s | 65.3 steps/s
[Step=31250 Epoch=61.1] | Loss=0.00191 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.706 | L2-Norm(final)=2.598 | 4204.5 samples/s | 65.7 steps/s
[Step=31300 Epoch=61.2] | Loss=0.00216 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.703 | L2-Norm(final)=2.599 | 4625.0 samples/s | 72.3 steps/s
[Step=31350 Epoch=61.3] | Loss=0.00281 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.701 | L2-Norm(final)=2.599 | 4676.1 samples/s | 73.1 steps/s
[Step=31400 Epoch=61.4] | Loss=0.00287 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.699 | L2-Norm(final)=2.599 | 4574.3 samples/s | 71.5 steps/s
[Step=31450 Epoch=61.5] | Loss=0.00277 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.696 | L2-Norm(final)=2.600 | 4618.1 samples/s | 72.2 steps/s
[Step=31500 Epoch=61.6] | Loss=0.00252 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.694 | L2-Norm(final)=2.600 | 4489.8 samples/s | 70.2 steps/s
[Step=31550 Epoch=61.7] | Loss=0.00244 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.692 | L2-Norm(final)=2.601 | 4584.5 samples/s | 71.6 steps/s
[Step=31600 Epoch=61.8] | Loss=0.00242 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.690 | L2-Norm(final)=2.602 | 4678.8 samples/s | 73.1 steps/s
[Step=31650 Epoch=61.9] | Loss=0.00246 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.688 | L2-Norm(final)=2.603 | 4695.5 samples/s | 73.4 steps/s
[Step=31700 Epoch=62.0] | Loss=0.00240 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.685 | L2-Norm(final)=2.604 | 5572.3 samples/s | 87.1 steps/s
[Step=31750 Epoch=62.1] | Loss=0.00242 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.683 | L2-Norm(final)=2.605 | 1920.4 samples/s | 30.0 steps/s
[Step=31800 Epoch=62.2] | Loss=0.00244 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.681 | L2-Norm(final)=2.605 | 4592.7 samples/s | 71.8 steps/s
[Step=31850 Epoch=62.3] | Loss=0.00230 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.679 | L2-Norm(final)=2.606 | 4703.3 samples/s | 73.5 steps/s
[Step=31900 Epoch=62.4] | Loss=0.00237 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.677 | L2-Norm(final)=2.607 | 4647.1 samples/s | 72.6 steps/s
[Step=31950 Epoch=62.5] | Loss=0.00233 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.674 | L2-Norm(final)=2.608 | 4637.4 samples/s | 72.5 steps/s
[Step=32000 Epoch=62.6] | Loss=0.00236 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.672 | L2-Norm(final)=2.608 | 4691.7 samples/s | 73.3 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step32000.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00013, len=1
[Step=31201 Epoch=119.6] | Loss=0.00000 | Reg=0.00014 | acc=1.0000 | L2-Norm=3.680 | L2-Norm(final)=9.185 | 4182.6 samples/s | 65.4 steps/s
[Step=31250 Epoch=119.7] | Loss=0.00000 | Reg=0.00014 | acc=1.0000 | L2-Norm=3.676 | L2-Norm(final)=9.188 | 3922.0 samples/s | 61.3 steps/s
[Step=31300 Epoch=119.9] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.672 | L2-Norm(final)=9.192 | 4265.2 samples/s | 66.6 steps/s
[Step=31350 Epoch=120.1] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.668 | L2-Norm(final)=9.196 | 4362.3 samples/s | 68.2 steps/s
[Step=31400 Epoch=120.3] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.665 | L2-Norm(final)=9.200 | 4410.6 samples/s | 68.9 steps/s
[Step=31450 Epoch=120.5] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.661 | L2-Norm(final)=9.205 | 5535.2 samples/s | 86.5 steps/s
[Step=31500 Epoch=120.7] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.657 | L2-Norm(final)=9.209 | 1866.7 samples/s | 29.2 steps/s
[Step=31550 Epoch=120.9] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.654 | L2-Norm(final)=9.213 | 4379.2 samples/s | 68.4 steps/s
[Step=31600 Epoch=121.1] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.650 | L2-Norm(final)=9.218 | 4516.0 samples/s | 70.6 steps/s
[Step=31650 Epoch=121.3] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.646 | L2-Norm(final)=9.223 | 4374.8 samples/s | 68.4 steps/s
[Step=31700 Epoch=121.5] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.642 | L2-Norm(final)=9.227 | 4729.9 samples/s | 73.9 steps/s
[Step=31750 Epoch=121.7] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.638 | L2-Norm(final)=9.232 | 1923.3 samples/s | 30.1 steps/s
[Step=31800 Epoch=121.8] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.634 | L2-Norm(final)=9.237 | 4237.6 samples/s | 66.2 steps/s
[Step=31850 Epoch=122.0] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.630 | L2-Norm(final)=9.243 | 4323.8 samples/s | 67.6 steps/s
[Step=31900 Epoch=122.2] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.626 | L2-Norm(final)=9.248 | 4213.8 samples/s | 65.8 steps/s
[Step=31950 Epoch=122.4] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.622 | L2-Norm(final)=9.253 | 4240.1 samples/s | 66.3 steps/s
[Step=32000 Epoch=122.6] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.618 | L2-Norm(final)=9.258 | 1961.6 samples/s | 30.6 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step32000.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00013, len=1
[Step=31201 Epoch=120.1] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.784 | L2-Norm(final)=5.640 | 3917.8 samples/s | 61.2 steps/s
[Step=31250 Epoch=120.3] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.782 | L2-Norm(final)=5.641 | 4074.9 samples/s | 63.7 steps/s
[Step=31300 Epoch=120.5] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.780 | L2-Norm(final)=5.643 | 4301.5 samples/s | 67.2 steps/s
[Step=31350 Epoch=120.7] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.777 | L2-Norm(final)=5.645 | 4195.1 samples/s | 65.5 steps/s
[Step=31400 Epoch=120.9] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.775 | L2-Norm(final)=5.646 | 4318.1 samples/s | 67.5 steps/s
[Step=31450 Epoch=121.1] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.772 | L2-Norm(final)=5.648 | 5448.7 samples/s | 85.1 steps/s
[Step=31500 Epoch=121.3] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.770 | L2-Norm(final)=5.650 | 1835.7 samples/s | 28.7 steps/s
[Step=31550 Epoch=121.4] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.767 | L2-Norm(final)=5.651 | 4296.5 samples/s | 67.1 steps/s
[Step=31600 Epoch=121.6] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.764 | L2-Norm(final)=5.653 | 4338.6 samples/s | 67.8 steps/s
[Step=31650 Epoch=121.8] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.762 | L2-Norm(final)=5.655 | 4213.9 samples/s | 65.8 steps/s
[Step=31700 Epoch=122.0] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.759 | L2-Norm(final)=5.656 | 4989.2 samples/s | 78.0 steps/s
[Step=31750 Epoch=122.2] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.756 | L2-Norm(final)=5.658 | 1910.6 samples/s | 29.9 steps/s
[Step=31800 Epoch=122.4] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.754 | L2-Norm(final)=5.660 | 4234.6 samples/s | 66.2 steps/s
[Step=31850 Epoch=122.6] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.751 | L2-Norm(final)=5.662 | 4226.9 samples/s | 66.0 steps/s
[Step=31900 Epoch=122.8] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.748 | L2-Norm(final)=5.664 | 4272.3 samples/s | 66.8 steps/s
[Step=31950 Epoch=123.0] | Loss=0.00000 | Reg=0.00023 | acc=1.0000 | L2-Norm=4.745 | L2-Norm(final)=5.666 | 4328.5 samples/s | 67.6 steps/s
[Step=32000 Epoch=123.2] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.742 | L2-Norm(final)=5.668 | 1984.8 samples/s | 31.0 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step32000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.20941 | acc=0.9590 | tpr=0.9741 | fpr=0.0738 | 4036.5 samples/s | 15.8 steps/s
Avg test loss: 0.21432, Avg test acc: 0.95745, Avg tpr: 0.97220, Avg fpr: 0.07499, total FA: 585

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.19403 | acc=0.9599 | tpr=0.9746 | fpr=0.0719 | 4026.0 samples/s | 15.7 steps/s
Avg test loss: 0.20195, Avg test acc: 0.95857, Avg tpr: 0.97459, Avg fpr: 0.07666, total FA: 598

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.81833 | acc=0.3177 | tpr=0.0076 | fpr=0.0089 | 4171.9 samples/s | 16.3 steps/s
Avg test loss: 4.83888, Avg test acc: 0.31449, Avg tpr: 0.00758, Avg fpr: 0.01051, total FA: 82

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.86652 | acc=0.3142 | tpr=0.0027 | fpr=0.0094 | 3950.1 samples/s | 15.4 steps/s
Avg test loss: 5.89534, Avg test acc: 0.31228, Avg tpr: 0.00309, Avg fpr: 0.00769, total FA: 60

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.01440 | acc=0.1645 | tpr=0.7743 | fpr=0.8465 | 3975.3 samples/s | 15.5 steps/s
[Step= 100] | Loss=7.97763 | acc=0.1644 | tpr=0.7420 | fpr=0.8464 | 7423.2 samples/s | 29.0 steps/s
[Step= 150] | Loss=8.03308 | acc=0.1638 | tpr=0.7478 | fpr=0.8470 | 7497.3 samples/s | 29.3 steps/s
[Step= 200] | Loss=8.02544 | acc=0.1627 | tpr=0.7410 | fpr=0.8479 | 7380.3 samples/s | 28.8 steps/s
[Step= 250] | Loss=8.04177 | acc=0.1627 | tpr=0.7493 | fpr=0.8480 | 8185.0 samples/s | 32.0 steps/s
[Step= 300] | Loss=8.05080 | acc=0.1620 | tpr=0.7505 | fpr=0.8487 | 7599.0 samples/s | 29.7 steps/s
[Step= 350] | Loss=8.04691 | acc=0.1624 | tpr=0.7533 | fpr=0.8483 | 7783.6 samples/s | 30.4 steps/s
[Step= 400] | Loss=8.04846 | acc=0.1627 | tpr=0.7549 | fpr=0.8481 | 8040.9 samples/s | 31.4 steps/s
[Step= 450] | Loss=8.04743 | acc=0.1624 | tpr=0.7566 | fpr=0.8484 | 7800.4 samples/s | 30.5 steps/s
[Step= 500] | Loss=8.05822 | acc=0.1619 | tpr=0.7511 | fpr=0.8487 | 7816.6 samples/s | 30.5 steps/s
[Step= 550] | Loss=8.05935 | acc=0.1621 | tpr=0.7529 | fpr=0.8487 | 14193.1 samples/s | 55.4 steps/s
Avg test loss: 8.06191, Avg test acc: 0.16193, Avg tpr: 0.75238, Avg fpr: 0.84880, total FA: 117854

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=9.48972 | acc=0.1483 | tpr=0.7832 | fpr=0.8631 | 4273.9 samples/s | 16.7 steps/s
[Step= 100] | Loss=9.43701 | acc=0.1465 | tpr=0.7676 | fpr=0.8651 | 7979.1 samples/s | 31.2 steps/s
[Step= 150] | Loss=9.44880 | acc=0.1468 | tpr=0.7507 | fpr=0.8643 | 7592.0 samples/s | 29.7 steps/s
[Step= 200] | Loss=9.42047 | acc=0.1474 | tpr=0.7486 | fpr=0.8635 | 7744.9 samples/s | 30.3 steps/s
[Step= 250] | Loss=9.41658 | acc=0.1477 | tpr=0.7459 | fpr=0.8631 | 7736.4 samples/s | 30.2 steps/s
[Step= 300] | Loss=9.41936 | acc=0.1480 | tpr=0.7447 | fpr=0.8629 | 7991.7 samples/s | 31.2 steps/s
[Step= 350] | Loss=9.41857 | acc=0.1479 | tpr=0.7451 | fpr=0.8629 | 7653.2 samples/s | 29.9 steps/s
[Step= 400] | Loss=9.41101 | acc=0.1481 | tpr=0.7516 | fpr=0.8628 | 8020.5 samples/s | 31.3 steps/s
[Step= 450] | Loss=9.42434 | acc=0.1479 | tpr=0.7512 | fpr=0.8630 | 7889.4 samples/s | 30.8 steps/s
[Step= 500] | Loss=9.44125 | acc=0.1473 | tpr=0.7533 | fpr=0.8637 | 7481.6 samples/s | 29.2 steps/s
[Step= 550] | Loss=9.44156 | acc=0.1473 | tpr=0.7473 | fpr=0.8636 | 14943.5 samples/s | 58.4 steps/s
Avg test loss: 9.44403, Avg test acc: 0.14721, Avg tpr: 0.74762, Avg fpr: 0.86371, total FA: 119924

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08940 | acc=0.9803 | tpr=0.9602 | fpr=0.0193 | 4260.3 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.09403 | acc=0.9798 | tpr=0.9723 | fpr=0.0200 | 7289.9 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.09860 | acc=0.9792 | tpr=0.9712 | fpr=0.0206 | 7517.6 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.09905 | acc=0.9794 | tpr=0.9760 | fpr=0.0205 | 7754.3 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.09848 | acc=0.9795 | tpr=0.9755 | fpr=0.0204 | 7934.0 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.09929 | acc=0.9794 | tpr=0.9760 | fpr=0.0205 | 7982.0 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.09937 | acc=0.9794 | tpr=0.9750 | fpr=0.0205 | 7104.2 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.10025 | acc=0.9792 | tpr=0.9716 | fpr=0.0207 | 7128.1 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.10173 | acc=0.9789 | tpr=0.9688 | fpr=0.0209 | 7349.0 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.10161 | acc=0.9790 | tpr=0.9696 | fpr=0.0208 | 7531.7 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.10115 | acc=0.9792 | tpr=0.9678 | fpr=0.0206 | 13555.9 samples/s | 53.0 steps/s
Avg test loss: 0.10099, Avg test acc: 0.97917, Avg tpr: 0.96791, Avg fpr: 0.02063, total FA: 2864

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14388 | acc=0.9798 | tpr=0.9469 | fpr=0.0196 | 4009.2 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.15309 | acc=0.9787 | tpr=0.9680 | fpr=0.0211 | 7982.9 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.15784 | acc=0.9779 | tpr=0.9683 | fpr=0.0219 | 7319.4 samples/s | 28.6 steps/s
[Step= 200] | Loss=0.15879 | acc=0.9778 | tpr=0.9716 | fpr=0.0221 | 7516.1 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.15712 | acc=0.9780 | tpr=0.9729 | fpr=0.0219 | 7509.8 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.15998 | acc=0.9780 | tpr=0.9716 | fpr=0.0219 | 7191.5 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.16054 | acc=0.9780 | tpr=0.9699 | fpr=0.0219 | 7849.1 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.16192 | acc=0.9777 | tpr=0.9688 | fpr=0.0222 | 7267.2 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.16494 | acc=0.9772 | tpr=0.9674 | fpr=0.0226 | 7317.6 samples/s | 28.6 steps/s
[Step= 500] | Loss=0.16387 | acc=0.9773 | tpr=0.9674 | fpr=0.0225 | 7433.1 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.16267 | acc=0.9776 | tpr=0.9682 | fpr=0.0223 | 13422.7 samples/s | 52.4 steps/s
Avg test loss: 0.16235, Avg test acc: 0.97758, Avg tpr: 0.96830, Avg fpr: 0.02225, total FA: 3089

server round 40/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00006, len=1
[Step=32001 Epoch=62.4] | Loss=0.00000 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.821 | L2-Norm(final)=2.763 | 4085.7 samples/s | 63.8 steps/s
[Step=32050 Epoch=62.5] | Loss=0.00347 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.819 | L2-Norm(final)=2.763 | 4248.1 samples/s | 66.4 steps/s
[Step=32100 Epoch=62.6] | Loss=0.00253 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.817 | L2-Norm(final)=2.763 | 4349.7 samples/s | 68.0 steps/s
[Step=32150 Epoch=62.7] | Loss=0.00256 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.816 | L2-Norm(final)=2.763 | 4404.8 samples/s | 68.8 steps/s
[Step=32200 Epoch=62.8] | Loss=0.00251 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.815 | L2-Norm(final)=2.764 | 4448.4 samples/s | 69.5 steps/s
[Step=32250 Epoch=62.9] | Loss=0.00227 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.814 | L2-Norm(final)=2.765 | 4415.5 samples/s | 69.0 steps/s
[Step=32300 Epoch=63.0] | Loss=0.00238 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.812 | L2-Norm(final)=2.765 | 4378.0 samples/s | 68.4 steps/s
[Step=32350 Epoch=63.1] | Loss=0.00253 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.811 | L2-Norm(final)=2.766 | 4456.5 samples/s | 69.6 steps/s
[Step=32400 Epoch=63.2] | Loss=0.00262 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.809 | L2-Norm(final)=2.766 | 4567.7 samples/s | 71.4 steps/s
[Step=32450 Epoch=63.3] | Loss=0.00266 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.808 | L2-Norm(final)=2.767 | 4653.2 samples/s | 72.7 steps/s
[Step=32500 Epoch=63.4] | Loss=0.00259 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.807 | L2-Norm(final)=2.767 | 5649.6 samples/s | 88.3 steps/s
[Step=32550 Epoch=63.5] | Loss=0.00255 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.805 | L2-Norm(final)=2.768 | 1913.2 samples/s | 29.9 steps/s
[Step=32600 Epoch=63.6] | Loss=0.00254 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.804 | L2-Norm(final)=2.768 | 4563.3 samples/s | 71.3 steps/s
[Step=32650 Epoch=63.7] | Loss=0.00248 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.802 | L2-Norm(final)=2.769 | 4496.5 samples/s | 70.3 steps/s
[Step=32700 Epoch=63.8] | Loss=0.00249 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.801 | L2-Norm(final)=2.769 | 4594.2 samples/s | 71.8 steps/s
[Step=32750 Epoch=63.9] | Loss=0.00256 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.799 | L2-Norm(final)=2.770 | 4516.5 samples/s | 70.6 steps/s
[Step=32800 Epoch=64.0] | Loss=0.00254 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.798 | L2-Norm(final)=2.770 | 4695.4 samples/s | 73.4 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step32800.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00006, len=1
[Step=32001 Epoch=62.6] | Loss=0.00691 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.634 | L2-Norm(final)=2.617 | 4193.9 samples/s | 65.5 steps/s
[Step=32050 Epoch=62.7] | Loss=0.00281 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.632 | L2-Norm(final)=2.617 | 4563.2 samples/s | 71.3 steps/s
[Step=32100 Epoch=62.8] | Loss=0.00284 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.631 | L2-Norm(final)=2.617 | 4518.0 samples/s | 70.6 steps/s
[Step=32150 Epoch=62.9] | Loss=0.00267 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.629 | L2-Norm(final)=2.617 | 4618.2 samples/s | 72.2 steps/s
[Step=32200 Epoch=63.0] | Loss=0.00245 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.628 | L2-Norm(final)=2.617 | 4517.6 samples/s | 70.6 steps/s
[Step=32250 Epoch=63.0] | Loss=0.00232 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.626 | L2-Norm(final)=2.617 | 4679.7 samples/s | 73.1 steps/s
[Step=32300 Epoch=63.1] | Loss=0.00247 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.625 | L2-Norm(final)=2.618 | 4654.3 samples/s | 72.7 steps/s
[Step=32350 Epoch=63.2] | Loss=0.00246 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.623 | L2-Norm(final)=2.618 | 4598.3 samples/s | 71.8 steps/s
[Step=32400 Epoch=63.3] | Loss=0.00232 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.622 | L2-Norm(final)=2.618 | 4664.7 samples/s | 72.9 steps/s
[Step=32450 Epoch=63.4] | Loss=0.00236 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.621 | L2-Norm(final)=2.619 | 4631.9 samples/s | 72.4 steps/s
[Step=32500 Epoch=63.5] | Loss=0.00229 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.619 | L2-Norm(final)=2.619 | 5676.4 samples/s | 88.7 steps/s
[Step=32550 Epoch=63.6] | Loss=0.00234 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.618 | L2-Norm(final)=2.620 | 1949.8 samples/s | 30.5 steps/s
[Step=32600 Epoch=63.7] | Loss=0.00228 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.617 | L2-Norm(final)=2.620 | 4584.5 samples/s | 71.6 steps/s
[Step=32650 Epoch=63.8] | Loss=0.00226 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.615 | L2-Norm(final)=2.621 | 4616.9 samples/s | 72.1 steps/s
[Step=32700 Epoch=63.9] | Loss=0.00221 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.614 | L2-Norm(final)=2.621 | 4570.2 samples/s | 71.4 steps/s
[Step=32750 Epoch=64.0] | Loss=0.00216 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.612 | L2-Norm(final)=2.622 | 4605.7 samples/s | 72.0 steps/s
[Step=32800 Epoch=64.1] | Loss=0.00221 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.611 | L2-Norm(final)=2.622 | 4670.4 samples/s | 73.0 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step32800.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00006, len=1
[Step=32001 Epoch=122.6] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.551 | L2-Norm(final)=9.343 | 4024.5 samples/s | 62.9 steps/s
[Step=32050 Epoch=122.8] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.549 | L2-Norm(final)=9.345 | 4089.9 samples/s | 63.9 steps/s
[Step=32100 Epoch=123.0] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.546 | L2-Norm(final)=9.348 | 4375.0 samples/s | 68.4 steps/s
[Step=32150 Epoch=123.2] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.544 | L2-Norm(final)=9.351 | 4483.1 samples/s | 70.0 steps/s
[Step=32200 Epoch=123.4] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.541 | L2-Norm(final)=9.354 | 4343.4 samples/s | 67.9 steps/s
[Step=32250 Epoch=123.6] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.539 | L2-Norm(final)=9.357 | 5461.4 samples/s | 85.3 steps/s
[Step=32300 Epoch=123.8] | Loss=0.00000 | Reg=0.00013 | acc=1.0000 | L2-Norm=3.536 | L2-Norm(final)=9.360 | 1805.2 samples/s | 28.2 steps/s
[Step=32350 Epoch=124.0] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.534 | L2-Norm(final)=9.363 | 4283.1 samples/s | 66.9 steps/s
[Step=32400 Epoch=124.1] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.531 | L2-Norm(final)=9.366 | 4361.2 samples/s | 68.1 steps/s
[Step=32450 Epoch=124.3] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.529 | L2-Norm(final)=9.370 | 4363.9 samples/s | 68.2 steps/s
[Step=32500 Epoch=124.5] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.526 | L2-Norm(final)=9.373 | 4828.9 samples/s | 75.5 steps/s
[Step=32550 Epoch=124.7] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.523 | L2-Norm(final)=9.376 | 1900.0 samples/s | 29.7 steps/s
[Step=32600 Epoch=124.9] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.521 | L2-Norm(final)=9.379 | 4342.6 samples/s | 67.9 steps/s
[Step=32650 Epoch=125.1] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.518 | L2-Norm(final)=9.383 | 4347.5 samples/s | 67.9 steps/s
[Step=32700 Epoch=125.3] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.515 | L2-Norm(final)=9.386 | 4199.8 samples/s | 65.6 steps/s
[Step=32750 Epoch=125.5] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.512 | L2-Norm(final)=9.389 | 4231.5 samples/s | 66.1 steps/s
[Step=32800 Epoch=125.7] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.510 | L2-Norm(final)=9.393 | 1998.4 samples/s | 31.2 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step32800.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00006, len=1
[Step=32001 Epoch=123.2] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.697 | L2-Norm(final)=5.700 | 3880.1 samples/s | 60.6 steps/s
[Step=32050 Epoch=123.4] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.695 | L2-Norm(final)=5.701 | 4207.1 samples/s | 65.7 steps/s
[Step=32100 Epoch=123.6] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.693 | L2-Norm(final)=5.703 | 4219.8 samples/s | 65.9 steps/s
[Step=32150 Epoch=123.8] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.692 | L2-Norm(final)=5.704 | 4204.9 samples/s | 65.7 steps/s
[Step=32200 Epoch=124.0] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.690 | L2-Norm(final)=5.705 | 4277.9 samples/s | 66.8 steps/s
[Step=32250 Epoch=124.1] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.688 | L2-Norm(final)=5.706 | 5502.0 samples/s | 86.0 steps/s
[Step=32300 Epoch=124.3] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.686 | L2-Norm(final)=5.707 | 1832.0 samples/s | 28.6 steps/s
[Step=32350 Epoch=124.5] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.685 | L2-Norm(final)=5.709 | 4371.7 samples/s | 68.3 steps/s
[Step=32400 Epoch=124.7] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.683 | L2-Norm(final)=5.710 | 4265.7 samples/s | 66.7 steps/s
[Step=32450 Epoch=124.9] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.681 | L2-Norm(final)=5.711 | 4241.9 samples/s | 66.3 steps/s
[Step=32500 Epoch=125.1] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.679 | L2-Norm(final)=5.712 | 4812.2 samples/s | 75.2 steps/s
[Step=32550 Epoch=125.3] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.677 | L2-Norm(final)=5.714 | 1905.1 samples/s | 29.8 steps/s
[Step=32600 Epoch=125.5] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.675 | L2-Norm(final)=5.715 | 4318.5 samples/s | 67.5 steps/s
[Step=32650 Epoch=125.7] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.673 | L2-Norm(final)=5.716 | 4207.9 samples/s | 65.7 steps/s
[Step=32700 Epoch=125.9] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.671 | L2-Norm(final)=5.718 | 4241.5 samples/s | 66.3 steps/s
[Step=32750 Epoch=126.1] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.669 | L2-Norm(final)=5.719 | 4290.6 samples/s | 67.0 steps/s
[Step=32800 Epoch=126.3] | Loss=0.00000 | Reg=0.00022 | acc=1.0000 | L2-Norm=4.667 | L2-Norm(final)=5.721 | 1973.0 samples/s | 30.8 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step32800.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.22546 | acc=0.9587 | tpr=0.9728 | fpr=0.0721 | 3995.0 samples/s | 15.6 steps/s
Avg test loss: 0.22980, Avg test acc: 0.95761, Avg tpr: 0.97144, Avg fpr: 0.07281, total FA: 568

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.19832 | acc=0.9603 | tpr=0.9730 | fpr=0.0671 | 4012.1 samples/s | 15.7 steps/s
Avg test loss: 0.20743, Avg test acc: 0.95885, Avg tpr: 0.97284, Avg fpr: 0.07191, total FA: 561

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.96248 | acc=0.3175 | tpr=0.0058 | fpr=0.0057 | 4043.0 samples/s | 15.8 steps/s
Avg test loss: 4.98387, Avg test acc: 0.31449, Avg tpr: 0.00571, Avg fpr: 0.00641, total FA: 50

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.84875 | acc=0.3143 | tpr=0.0027 | fpr=0.0092 | 4000.9 samples/s | 15.6 steps/s
Avg test loss: 5.87737, Avg test acc: 0.31220, Avg tpr: 0.00297, Avg fpr: 0.00769, total FA: 60

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.56259 | acc=0.1658 | tpr=0.7920 | fpr=0.8455 | 4020.8 samples/s | 15.7 steps/s
[Step= 100] | Loss=8.52563 | acc=0.1646 | tpr=0.7527 | fpr=0.8463 | 7314.0 samples/s | 28.6 steps/s
[Step= 150] | Loss=8.58669 | acc=0.1633 | tpr=0.7594 | fpr=0.8477 | 7381.6 samples/s | 28.8 steps/s
[Step= 200] | Loss=8.57994 | acc=0.1623 | tpr=0.7497 | fpr=0.8484 | 7592.3 samples/s | 29.7 steps/s
[Step= 250] | Loss=8.59552 | acc=0.1623 | tpr=0.7520 | fpr=0.8485 | 7975.4 samples/s | 31.2 steps/s
[Step= 300] | Loss=8.60513 | acc=0.1615 | tpr=0.7505 | fpr=0.8492 | 7694.6 samples/s | 30.1 steps/s
[Step= 350] | Loss=8.60087 | acc=0.1619 | tpr=0.7514 | fpr=0.8488 | 7855.8 samples/s | 30.7 steps/s
[Step= 400] | Loss=8.60276 | acc=0.1622 | tpr=0.7500 | fpr=0.8485 | 7726.9 samples/s | 30.2 steps/s
[Step= 450] | Loss=8.60262 | acc=0.1619 | tpr=0.7537 | fpr=0.8489 | 7712.1 samples/s | 30.1 steps/s
[Step= 500] | Loss=8.61399 | acc=0.1614 | tpr=0.7480 | fpr=0.8491 | 7977.2 samples/s | 31.2 steps/s
[Step= 550] | Loss=8.61500 | acc=0.1617 | tpr=0.7493 | fpr=0.8490 | 14618.8 samples/s | 57.1 steps/s
Avg test loss: 8.61774, Avg test acc: 0.16153, Avg tpr: 0.74921, Avg fpr: 0.84915, total FA: 117903

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=9.35636 | acc=0.1554 | tpr=0.7655 | fpr=0.8556 | 4263.1 samples/s | 16.7 steps/s
[Step= 100] | Loss=9.30889 | acc=0.1539 | tpr=0.7527 | fpr=0.8573 | 7754.5 samples/s | 30.3 steps/s
[Step= 150] | Loss=9.32030 | acc=0.1543 | tpr=0.7378 | fpr=0.8564 | 7932.8 samples/s | 31.0 steps/s
[Step= 200] | Loss=9.29191 | acc=0.1552 | tpr=0.7377 | fpr=0.8554 | 7868.8 samples/s | 30.7 steps/s
[Step= 250] | Loss=9.28826 | acc=0.1558 | tpr=0.7371 | fpr=0.8548 | 7706.9 samples/s | 30.1 steps/s
[Step= 300] | Loss=9.29031 | acc=0.1559 | tpr=0.7345 | fpr=0.8547 | 7982.0 samples/s | 31.2 steps/s
[Step= 350] | Loss=9.28862 | acc=0.1555 | tpr=0.7332 | fpr=0.8550 | 7600.3 samples/s | 29.7 steps/s
[Step= 400] | Loss=9.28082 | acc=0.1557 | tpr=0.7407 | fpr=0.8549 | 8481.5 samples/s | 33.1 steps/s
[Step= 450] | Loss=9.29392 | acc=0.1555 | tpr=0.7395 | fpr=0.8551 | 7514.9 samples/s | 29.4 steps/s
[Step= 500] | Loss=9.31143 | acc=0.1548 | tpr=0.7410 | fpr=0.8558 | 7940.2 samples/s | 31.0 steps/s
[Step= 550] | Loss=9.31113 | acc=0.1548 | tpr=0.7342 | fpr=0.8558 | 13499.6 samples/s | 52.7 steps/s
Avg test loss: 9.31378, Avg test acc: 0.15463, Avg tpr: 0.73455, Avg fpr: 0.85591, total FA: 118842

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08076 | acc=0.9823 | tpr=0.9513 | fpr=0.0172 | 4139.4 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.08499 | acc=0.9818 | tpr=0.9638 | fpr=0.0178 | 7939.6 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.08916 | acc=0.9815 | tpr=0.9654 | fpr=0.0182 | 7697.7 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.08962 | acc=0.9814 | tpr=0.9716 | fpr=0.0184 | 7777.9 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.08900 | acc=0.9816 | tpr=0.9703 | fpr=0.0182 | 7721.0 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.08980 | acc=0.9814 | tpr=0.9702 | fpr=0.0183 | 7848.1 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.08989 | acc=0.9814 | tpr=0.9693 | fpr=0.0184 | 7090.8 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.09069 | acc=0.9811 | tpr=0.9650 | fpr=0.0186 | 7816.9 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.09209 | acc=0.9809 | tpr=0.9630 | fpr=0.0188 | 7749.1 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.09200 | acc=0.9809 | tpr=0.9643 | fpr=0.0188 | 7944.5 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.09166 | acc=0.9811 | tpr=0.9626 | fpr=0.0186 | 13058.8 samples/s | 51.0 steps/s
Avg test loss: 0.09151, Avg test acc: 0.98108, Avg tpr: 0.96276, Avg fpr: 0.01859, total FA: 2581

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14022 | acc=0.9798 | tpr=0.9469 | fpr=0.0196 | 3949.8 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.14930 | acc=0.9786 | tpr=0.9659 | fpr=0.0211 | 7596.4 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.15395 | acc=0.9779 | tpr=0.9669 | fpr=0.0219 | 7543.1 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.15489 | acc=0.9778 | tpr=0.9705 | fpr=0.0220 | 7349.0 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.15329 | acc=0.9779 | tpr=0.9721 | fpr=0.0220 | 7552.0 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.15610 | acc=0.9779 | tpr=0.9709 | fpr=0.0219 | 7716.6 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.15656 | acc=0.9779 | tpr=0.9699 | fpr=0.0219 | 7580.2 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.15790 | acc=0.9776 | tpr=0.9688 | fpr=0.0222 | 7526.4 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.16080 | acc=0.9772 | tpr=0.9679 | fpr=0.0226 | 7510.1 samples/s | 29.3 steps/s
[Step= 500] | Loss=0.15979 | acc=0.9773 | tpr=0.9678 | fpr=0.0226 | 7180.4 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.15863 | acc=0.9775 | tpr=0.9682 | fpr=0.0223 | 13584.5 samples/s | 53.1 steps/s
Avg test loss: 0.15832, Avg test acc: 0.97751, Avg tpr: 0.96830, Avg fpr: 0.02232, total FA: 3099

server round 41/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00006, len=1
[Step=32801 Epoch=64.0] | Loss=0.00339 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.774 | L2-Norm(final)=2.778 | 3898.1 samples/s | 60.9 steps/s
[Step=32850 Epoch=64.1] | Loss=0.00191 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.772 | L2-Norm(final)=2.778 | 4254.3 samples/s | 66.5 steps/s
[Step=32900 Epoch=64.2] | Loss=0.00176 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.771 | L2-Norm(final)=2.779 | 4319.8 samples/s | 67.5 steps/s
[Step=32950 Epoch=64.3] | Loss=0.00174 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.769 | L2-Norm(final)=2.779 | 4346.4 samples/s | 67.9 steps/s
[Step=33000 Epoch=64.4] | Loss=0.00206 | Reg=0.00316 | acc=0.9844 | L2-Norm=17.768 | L2-Norm(final)=2.780 | 4406.5 samples/s | 68.9 steps/s
[Step=33050 Epoch=64.5] | Loss=0.00214 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.766 | L2-Norm(final)=2.780 | 4436.7 samples/s | 69.3 steps/s
[Step=33100 Epoch=64.6] | Loss=0.00231 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.764 | L2-Norm(final)=2.780 | 4536.9 samples/s | 70.9 steps/s
[Step=33150 Epoch=64.7] | Loss=0.00234 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.763 | L2-Norm(final)=2.780 | 4543.9 samples/s | 71.0 steps/s
[Step=33200 Epoch=64.8] | Loss=0.00238 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.761 | L2-Norm(final)=2.781 | 4466.3 samples/s | 69.8 steps/s
[Step=33250 Epoch=64.9] | Loss=0.00249 | Reg=0.00315 | acc=0.9844 | L2-Norm=17.759 | L2-Norm(final)=2.781 | 4439.0 samples/s | 69.4 steps/s
[Step=33300 Epoch=64.9] | Loss=0.00246 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.758 | L2-Norm(final)=2.781 | 5438.4 samples/s | 85.0 steps/s
[Step=33350 Epoch=65.0] | Loss=0.00239 | Reg=0.00315 | acc=0.9844 | L2-Norm=17.756 | L2-Norm(final)=2.782 | 1869.7 samples/s | 29.2 steps/s
[Step=33400 Epoch=65.1] | Loss=0.00234 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.754 | L2-Norm(final)=2.782 | 4512.9 samples/s | 70.5 steps/s
[Step=33450 Epoch=65.2] | Loss=0.00238 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.753 | L2-Norm(final)=2.783 | 4573.8 samples/s | 71.5 steps/s
[Step=33500 Epoch=65.3] | Loss=0.00241 | Reg=0.00315 | acc=0.9844 | L2-Norm=17.751 | L2-Norm(final)=2.783 | 4599.9 samples/s | 71.9 steps/s
[Step=33550 Epoch=65.4] | Loss=0.00240 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.749 | L2-Norm(final)=2.784 | 4594.9 samples/s | 71.8 steps/s
[Step=33600 Epoch=65.5] | Loss=0.00237 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.747 | L2-Norm(final)=2.784 | 4551.9 samples/s | 71.1 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step33600.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00006, len=1
[Step=32801 Epoch=64.1] | Loss=0.00407 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.586 | L2-Norm(final)=2.628 | 4027.9 samples/s | 62.9 steps/s
[Step=32850 Epoch=64.2] | Loss=0.00231 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.585 | L2-Norm(final)=2.629 | 4536.2 samples/s | 70.9 steps/s
[Step=32900 Epoch=64.3] | Loss=0.00191 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.583 | L2-Norm(final)=2.629 | 4664.3 samples/s | 72.9 steps/s
[Step=32950 Epoch=64.4] | Loss=0.00210 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.581 | L2-Norm(final)=2.630 | 4609.7 samples/s | 72.0 steps/s
[Step=33000 Epoch=64.5] | Loss=0.00214 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.580 | L2-Norm(final)=2.630 | 4605.2 samples/s | 72.0 steps/s
[Step=33050 Epoch=64.6] | Loss=0.00233 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.578 | L2-Norm(final)=2.630 | 4529.0 samples/s | 70.8 steps/s
[Step=33100 Epoch=64.7] | Loss=0.00223 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.576 | L2-Norm(final)=2.630 | 4510.2 samples/s | 70.5 steps/s
[Step=33150 Epoch=64.8] | Loss=0.00219 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.574 | L2-Norm(final)=2.630 | 4603.0 samples/s | 71.9 steps/s
[Step=33200 Epoch=64.9] | Loss=0.00207 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.572 | L2-Norm(final)=2.631 | 4679.7 samples/s | 73.1 steps/s
[Step=33250 Epoch=65.0] | Loss=0.00217 | Reg=0.00309 | acc=0.9844 | L2-Norm=17.570 | L2-Norm(final)=2.631 | 4665.5 samples/s | 72.9 steps/s
[Step=33300 Epoch=65.1] | Loss=0.00216 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.569 | L2-Norm(final)=2.631 | 5609.0 samples/s | 87.6 steps/s
[Step=33350 Epoch=65.2] | Loss=0.00216 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.567 | L2-Norm(final)=2.631 | 1921.1 samples/s | 30.0 steps/s
[Step=33400 Epoch=65.3] | Loss=0.00212 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.565 | L2-Norm(final)=2.632 | 4617.3 samples/s | 72.1 steps/s
[Step=33450 Epoch=65.4] | Loss=0.00206 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.563 | L2-Norm(final)=2.632 | 4591.2 samples/s | 71.7 steps/s
[Step=33500 Epoch=65.5] | Loss=0.00202 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.562 | L2-Norm(final)=2.633 | 4542.3 samples/s | 71.0 steps/s
[Step=33550 Epoch=65.6] | Loss=0.00203 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.560 | L2-Norm(final)=2.633 | 4606.6 samples/s | 72.0 steps/s
[Step=33600 Epoch=65.7] | Loss=0.00199 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.558 | L2-Norm(final)=2.634 | 4510.5 samples/s | 70.5 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step33600.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00006, len=1
[Step=32801 Epoch=125.7] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.466 | L2-Norm(final)=9.450 | 4176.9 samples/s | 65.3 steps/s
[Step=32850 Epoch=125.9] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.463 | L2-Norm(final)=9.454 | 4094.8 samples/s | 64.0 steps/s
[Step=32900 Epoch=126.1] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.460 | L2-Norm(final)=9.459 | 4321.9 samples/s | 67.5 steps/s
[Step=32950 Epoch=126.3] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.457 | L2-Norm(final)=9.463 | 4372.0 samples/s | 68.3 steps/s
[Step=33000 Epoch=126.4] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.454 | L2-Norm(final)=9.467 | 4225.3 samples/s | 66.0 steps/s
[Step=33050 Epoch=126.6] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.450 | L2-Norm(final)=9.471 | 5571.8 samples/s | 87.1 steps/s
[Step=33100 Epoch=126.8] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.447 | L2-Norm(final)=9.475 | 1880.2 samples/s | 29.4 steps/s
[Step=33150 Epoch=127.0] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.444 | L2-Norm(final)=9.479 | 4337.0 samples/s | 67.8 steps/s
[Step=33200 Epoch=127.2] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.440 | L2-Norm(final)=9.484 | 4193.7 samples/s | 65.5 steps/s
[Step=33250 Epoch=127.4] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.437 | L2-Norm(final)=9.488 | 4176.0 samples/s | 65.3 steps/s
[Step=33300 Epoch=127.6] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.434 | L2-Norm(final)=9.492 | 4789.9 samples/s | 74.8 steps/s
[Step=33350 Epoch=127.8] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.430 | L2-Norm(final)=9.497 | 1889.3 samples/s | 29.5 steps/s
[Step=33400 Epoch=128.0] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.427 | L2-Norm(final)=9.501 | 4259.6 samples/s | 66.6 steps/s
[Step=33450 Epoch=128.2] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.423 | L2-Norm(final)=9.506 | 4180.3 samples/s | 65.3 steps/s
[Step=33500 Epoch=128.4] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.420 | L2-Norm(final)=9.510 | 4253.6 samples/s | 66.5 steps/s
[Step=33550 Epoch=128.6] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.416 | L2-Norm(final)=9.515 | 4235.1 samples/s | 66.2 steps/s
[Step=33600 Epoch=128.7] | Loss=0.00000 | Reg=0.00012 | acc=1.0000 | L2-Norm=3.413 | L2-Norm(final)=9.520 | 1942.8 samples/s | 30.4 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step33600.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00006, len=1
[Step=32801 Epoch=126.3] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.634 | L2-Norm(final)=5.743 | 4137.6 samples/s | 64.7 steps/s
[Step=32850 Epoch=126.5] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.632 | L2-Norm(final)=5.744 | 4064.3 samples/s | 63.5 steps/s
[Step=32900 Epoch=126.6] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.630 | L2-Norm(final)=5.746 | 4452.1 samples/s | 69.6 steps/s
[Step=32950 Epoch=126.8] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.627 | L2-Norm(final)=5.747 | 4425.3 samples/s | 69.1 steps/s
[Step=33000 Epoch=127.0] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.625 | L2-Norm(final)=5.749 | 4275.5 samples/s | 66.8 steps/s
[Step=33050 Epoch=127.2] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.623 | L2-Norm(final)=5.751 | 5286.7 samples/s | 82.6 steps/s
[Step=33100 Epoch=127.4] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.620 | L2-Norm(final)=5.752 | 1838.2 samples/s | 28.7 steps/s
[Step=33150 Epoch=127.6] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.618 | L2-Norm(final)=5.754 | 4311.4 samples/s | 67.4 steps/s
[Step=33200 Epoch=127.8] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.615 | L2-Norm(final)=5.756 | 4187.9 samples/s | 65.4 steps/s
[Step=33250 Epoch=128.0] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.613 | L2-Norm(final)=5.757 | 4336.6 samples/s | 67.8 steps/s
[Step=33300 Epoch=128.2] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.610 | L2-Norm(final)=5.759 | 4833.8 samples/s | 75.5 steps/s
[Step=33350 Epoch=128.4] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.608 | L2-Norm(final)=5.761 | 1878.9 samples/s | 29.4 steps/s
[Step=33400 Epoch=128.6] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.605 | L2-Norm(final)=5.763 | 4217.7 samples/s | 65.9 steps/s
[Step=33450 Epoch=128.8] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.602 | L2-Norm(final)=5.765 | 4226.1 samples/s | 66.0 steps/s
[Step=33500 Epoch=129.0] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.600 | L2-Norm(final)=5.766 | 4244.1 samples/s | 66.3 steps/s
[Step=33550 Epoch=129.1] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.597 | L2-Norm(final)=5.768 | 4291.5 samples/s | 67.1 steps/s
[Step=33600 Epoch=129.3] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.594 | L2-Norm(final)=5.770 | 1975.4 samples/s | 30.9 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step33600.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.22395 | acc=0.9592 | tpr=0.9714 | fpr=0.0671 | 4187.1 samples/s | 16.4 steps/s
Avg test loss: 0.23024, Avg test acc: 0.95837, Avg tpr: 0.97004, Avg fpr: 0.06730, total FA: 525

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.19857 | acc=0.9597 | tpr=0.9698 | fpr=0.0622 | 4126.8 samples/s | 16.1 steps/s
Avg test loss: 0.20759, Avg test acc: 0.95821, Avg tpr: 0.96934, Avg fpr: 0.06627, total FA: 517

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.85129 | acc=0.3180 | tpr=0.0073 | fpr=0.0072 | 4081.7 samples/s | 15.9 steps/s
Avg test loss: 4.87292, Avg test acc: 0.31505, Avg tpr: 0.00746, Avg fpr: 0.00846, total FA: 66

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.77600 | acc=0.3142 | tpr=0.0027 | fpr=0.0094 | 4000.1 samples/s | 15.6 steps/s
Avg test loss: 5.80411, Avg test acc: 0.31220, Avg tpr: 0.00303, Avg fpr: 0.00782, total FA: 61

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.38545 | acc=0.1737 | tpr=0.7655 | fpr=0.8370 | 4081.3 samples/s | 15.9 steps/s
[Step= 100] | Loss=8.34684 | acc=0.1743 | tpr=0.7292 | fpr=0.8361 | 7473.5 samples/s | 29.2 steps/s
[Step= 150] | Loss=8.40621 | acc=0.1733 | tpr=0.7349 | fpr=0.8371 | 7374.9 samples/s | 28.8 steps/s
[Step= 200] | Loss=8.39940 | acc=0.1724 | tpr=0.7268 | fpr=0.8377 | 8192.2 samples/s | 32.0 steps/s
[Step= 250] | Loss=8.41516 | acc=0.1724 | tpr=0.7293 | fpr=0.8377 | 7711.9 samples/s | 30.1 steps/s
[Step= 300] | Loss=8.42490 | acc=0.1717 | tpr=0.7302 | fpr=0.8385 | 7659.5 samples/s | 29.9 steps/s
[Step= 350] | Loss=8.42102 | acc=0.1722 | tpr=0.7307 | fpr=0.8380 | 7685.5 samples/s | 30.0 steps/s
[Step= 400] | Loss=8.42202 | acc=0.1723 | tpr=0.7292 | fpr=0.8378 | 7639.7 samples/s | 29.8 steps/s
[Step= 450] | Loss=8.42125 | acc=0.1719 | tpr=0.7337 | fpr=0.8383 | 8064.2 samples/s | 31.5 steps/s
[Step= 500] | Loss=8.43237 | acc=0.1716 | tpr=0.7291 | fpr=0.8385 | 7520.5 samples/s | 29.4 steps/s
[Step= 550] | Loss=8.43389 | acc=0.1716 | tpr=0.7298 | fpr=0.8385 | 14916.9 samples/s | 58.3 steps/s
Avg test loss: 8.43663, Avg test acc: 0.17145, Avg tpr: 0.72940, Avg fpr: 0.83869, total FA: 116451

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=9.14765 | acc=0.1636 | tpr=0.7389 | fpr=0.8467 | 4249.7 samples/s | 16.6 steps/s
[Step= 100] | Loss=9.10105 | acc=0.1630 | tpr=0.7271 | fpr=0.8476 | 7890.0 samples/s | 30.8 steps/s
[Step= 150] | Loss=9.11133 | acc=0.1636 | tpr=0.7104 | fpr=0.8465 | 7626.6 samples/s | 29.8 steps/s
[Step= 200] | Loss=9.08280 | acc=0.1645 | tpr=0.7158 | fpr=0.8455 | 8044.9 samples/s | 31.4 steps/s
[Step= 250] | Loss=9.07893 | acc=0.1651 | tpr=0.7127 | fpr=0.8449 | 7830.8 samples/s | 30.6 steps/s
[Step= 300] | Loss=9.07994 | acc=0.1651 | tpr=0.7098 | fpr=0.8448 | 7767.7 samples/s | 30.3 steps/s
[Step= 350] | Loss=9.07819 | acc=0.1646 | tpr=0.7088 | fpr=0.8453 | 8152.5 samples/s | 31.8 steps/s
[Step= 400] | Loss=9.07048 | acc=0.1649 | tpr=0.7155 | fpr=0.8452 | 7400.2 samples/s | 28.9 steps/s
[Step= 450] | Loss=9.08372 | acc=0.1645 | tpr=0.7142 | fpr=0.8455 | 8062.8 samples/s | 31.5 steps/s
[Step= 500] | Loss=9.10126 | acc=0.1638 | tpr=0.7163 | fpr=0.8461 | 7497.6 samples/s | 29.3 steps/s
[Step= 550] | Loss=9.10074 | acc=0.1637 | tpr=0.7083 | fpr=0.8462 | 14407.0 samples/s | 56.3 steps/s
Avg test loss: 9.10346, Avg test acc: 0.16358, Avg tpr: 0.70840, Avg fpr: 0.84633, total FA: 117511

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09400 | acc=0.9795 | tpr=0.9646 | fpr=0.0202 | 4109.1 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.09865 | acc=0.9787 | tpr=0.9744 | fpr=0.0212 | 7672.6 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.10325 | acc=0.9781 | tpr=0.9726 | fpr=0.0218 | 7900.8 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.10389 | acc=0.9782 | tpr=0.9770 | fpr=0.0217 | 7409.7 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.10316 | acc=0.9783 | tpr=0.9764 | fpr=0.0217 | 7162.3 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.10414 | acc=0.9782 | tpr=0.9767 | fpr=0.0218 | 7136.6 samples/s | 27.9 steps/s
[Step= 350] | Loss=0.10420 | acc=0.9782 | tpr=0.9775 | fpr=0.0218 | 7846.3 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.10516 | acc=0.9780 | tpr=0.9748 | fpr=0.0219 | 8002.9 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.10665 | acc=0.9777 | tpr=0.9722 | fpr=0.0222 | 7742.5 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.10654 | acc=0.9778 | tpr=0.9731 | fpr=0.0221 | 7356.1 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.10602 | acc=0.9780 | tpr=0.9721 | fpr=0.0219 | 14086.2 samples/s | 55.0 steps/s
Avg test loss: 0.10584, Avg test acc: 0.97803, Avg tpr: 0.97227, Avg fpr: 0.02187, total FA: 3036

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13995 | acc=0.9792 | tpr=0.9513 | fpr=0.0203 | 4152.0 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.14906 | acc=0.9782 | tpr=0.9701 | fpr=0.0217 | 7398.2 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.15380 | acc=0.9773 | tpr=0.9697 | fpr=0.0226 | 7539.6 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.15474 | acc=0.9771 | tpr=0.9738 | fpr=0.0228 | 7431.0 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.15321 | acc=0.9773 | tpr=0.9747 | fpr=0.0227 | 7556.5 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.15598 | acc=0.9773 | tpr=0.9745 | fpr=0.0227 | 7697.7 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.15637 | acc=0.9772 | tpr=0.9737 | fpr=0.0227 | 7187.1 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.15769 | acc=0.9769 | tpr=0.9721 | fpr=0.0230 | 7556.6 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.16054 | acc=0.9765 | tpr=0.9708 | fpr=0.0234 | 7589.4 samples/s | 29.6 steps/s
[Step= 500] | Loss=0.15959 | acc=0.9765 | tpr=0.9705 | fpr=0.0234 | 7603.3 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.15842 | acc=0.9768 | tpr=0.9710 | fpr=0.0231 | 13580.9 samples/s | 53.1 steps/s
Avg test loss: 0.15811, Avg test acc: 0.97683, Avg tpr: 0.97108, Avg fpr: 0.02306, total FA: 3202

server round 42/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00006, len=1
[Step=33601 Epoch=65.5] | Loss=0.00001 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.719 | L2-Norm(final)=2.792 | 4406.6 samples/s | 68.9 steps/s
[Step=33650 Epoch=65.6] | Loss=0.00139 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.718 | L2-Norm(final)=2.793 | 4032.1 samples/s | 63.0 steps/s
[Step=33700 Epoch=65.7] | Loss=0.00212 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.716 | L2-Norm(final)=2.793 | 4463.8 samples/s | 69.7 steps/s
[Step=33750 Epoch=65.8] | Loss=0.00235 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.714 | L2-Norm(final)=2.794 | 4425.4 samples/s | 69.1 steps/s
[Step=33800 Epoch=65.9] | Loss=0.00243 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.713 | L2-Norm(final)=2.794 | 4443.1 samples/s | 69.4 steps/s
[Step=33850 Epoch=66.0] | Loss=0.00248 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.711 | L2-Norm(final)=2.794 | 4398.6 samples/s | 68.7 steps/s
[Step=33900 Epoch=66.1] | Loss=0.00254 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.709 | L2-Norm(final)=2.795 | 4540.8 samples/s | 71.0 steps/s
[Step=33950 Epoch=66.2] | Loss=0.00256 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.707 | L2-Norm(final)=2.795 | 4641.3 samples/s | 72.5 steps/s
[Step=34000 Epoch=66.3] | Loss=0.00264 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.705 | L2-Norm(final)=2.795 | 4585.0 samples/s | 71.6 steps/s
[Step=34050 Epoch=66.4] | Loss=0.00270 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.703 | L2-Norm(final)=2.795 | 4602.5 samples/s | 71.9 steps/s
[Step=34100 Epoch=66.5] | Loss=0.00255 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.701 | L2-Norm(final)=2.796 | 5671.4 samples/s | 88.6 steps/s
[Step=34150 Epoch=66.6] | Loss=0.00251 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.699 | L2-Norm(final)=2.796 | 1849.2 samples/s | 28.9 steps/s
[Step=34200 Epoch=66.7] | Loss=0.00248 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.697 | L2-Norm(final)=2.797 | 4575.8 samples/s | 71.5 steps/s
[Step=34250 Epoch=66.8] | Loss=0.00252 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.695 | L2-Norm(final)=2.797 | 4359.8 samples/s | 68.1 steps/s
[Step=34300 Epoch=66.9] | Loss=0.00249 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.694 | L2-Norm(final)=2.798 | 4605.7 samples/s | 72.0 steps/s
[Step=34350 Epoch=67.0] | Loss=0.00250 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.692 | L2-Norm(final)=2.798 | 4669.7 samples/s | 73.0 steps/s
[Step=34400 Epoch=67.1] | Loss=0.00244 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.690 | L2-Norm(final)=2.799 | 4593.1 samples/s | 71.8 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step34400.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00006, len=1
[Step=33601 Epoch=65.7] | Loss=0.00041 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.530 | L2-Norm(final)=2.641 | 4235.0 samples/s | 66.2 steps/s
[Step=33650 Epoch=65.8] | Loss=0.00185 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.528 | L2-Norm(final)=2.642 | 4432.0 samples/s | 69.3 steps/s
[Step=33700 Epoch=65.9] | Loss=0.00155 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.526 | L2-Norm(final)=2.643 | 4655.6 samples/s | 72.7 steps/s
[Step=33750 Epoch=66.0] | Loss=0.00151 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.524 | L2-Norm(final)=2.643 | 4628.2 samples/s | 72.3 steps/s
[Step=33800 Epoch=66.1] | Loss=0.00184 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.522 | L2-Norm(final)=2.644 | 4618.0 samples/s | 72.2 steps/s
[Step=33850 Epoch=66.2] | Loss=0.00206 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.520 | L2-Norm(final)=2.644 | 4598.3 samples/s | 71.8 steps/s
[Step=33900 Epoch=66.3] | Loss=0.00202 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.518 | L2-Norm(final)=2.644 | 4548.6 samples/s | 71.1 steps/s
[Step=33950 Epoch=66.4] | Loss=0.00207 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.516 | L2-Norm(final)=2.644 | 4600.2 samples/s | 71.9 steps/s
[Step=34000 Epoch=66.5] | Loss=0.00209 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.514 | L2-Norm(final)=2.644 | 4698.0 samples/s | 73.4 steps/s
[Step=34050 Epoch=66.6] | Loss=0.00211 | Reg=0.00307 | acc=0.9844 | L2-Norm=17.512 | L2-Norm(final)=2.645 | 4631.5 samples/s | 72.4 steps/s
[Step=34100 Epoch=66.7] | Loss=0.00216 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.510 | L2-Norm(final)=2.645 | 5625.2 samples/s | 87.9 steps/s
[Step=34150 Epoch=66.8] | Loss=0.00209 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.508 | L2-Norm(final)=2.645 | 1924.0 samples/s | 30.1 steps/s
[Step=34200 Epoch=66.9] | Loss=0.00208 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.506 | L2-Norm(final)=2.646 | 4607.2 samples/s | 72.0 steps/s
[Step=34250 Epoch=67.0] | Loss=0.00206 | Reg=0.00306 | acc=0.9844 | L2-Norm=17.504 | L2-Norm(final)=2.646 | 4674.7 samples/s | 73.0 steps/s
[Step=34300 Epoch=67.1] | Loss=0.00203 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.502 | L2-Norm(final)=2.646 | 4676.6 samples/s | 73.1 steps/s
[Step=34350 Epoch=67.2] | Loss=0.00208 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.500 | L2-Norm(final)=2.647 | 4634.7 samples/s | 72.4 steps/s
[Step=34400 Epoch=67.3] | Loss=0.00201 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.498 | L2-Norm(final)=2.647 | 4703.3 samples/s | 73.5 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step34400.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00006, len=1
[Step=33601 Epoch=128.7] | Loss=0.00000 | Reg=0.00011 | acc=1.0000 | L2-Norm=3.358 | L2-Norm(final)=9.597 | 4025.9 samples/s | 62.9 steps/s
[Step=33650 Epoch=128.9] | Loss=0.00000 | Reg=0.00011 | acc=1.0000 | L2-Norm=3.355 | L2-Norm(final)=9.603 | 4098.7 samples/s | 64.0 steps/s
[Step=33700 Epoch=129.1] | Loss=0.00000 | Reg=0.00011 | acc=1.0000 | L2-Norm=3.352 | L2-Norm(final)=9.608 | 4347.6 samples/s | 67.9 steps/s
[Step=33750 Epoch=129.3] | Loss=0.00000 | Reg=0.00011 | acc=1.0000 | L2-Norm=3.348 | L2-Norm(final)=9.613 | 4449.9 samples/s | 69.5 steps/s
[Step=33800 Epoch=129.5] | Loss=0.00000 | Reg=0.00011 | acc=1.0000 | L2-Norm=3.344 | L2-Norm(final)=9.619 | 4361.5 samples/s | 68.1 steps/s
[Step=33850 Epoch=129.7] | Loss=0.00000 | Reg=0.00011 | acc=1.0000 | L2-Norm=3.340 | L2-Norm(final)=9.624 | 5531.5 samples/s | 86.4 steps/s
[Step=33900 Epoch=129.9] | Loss=0.00000 | Reg=0.00011 | acc=1.0000 | L2-Norm=3.336 | L2-Norm(final)=9.630 | 1855.5 samples/s | 29.0 steps/s
[Step=33950 Epoch=130.1] | Loss=0.00000 | Reg=0.00011 | acc=1.0000 | L2-Norm=3.332 | L2-Norm(final)=9.635 | 4373.0 samples/s | 68.3 steps/s
[Step=34000 Epoch=130.3] | Loss=0.00000 | Reg=0.00011 | acc=1.0000 | L2-Norm=3.328 | L2-Norm(final)=9.640 | 4460.5 samples/s | 69.7 steps/s
[Step=34050 Epoch=130.5] | Loss=0.00000 | Reg=0.00011 | acc=1.0000 | L2-Norm=3.324 | L2-Norm(final)=9.645 | 4302.9 samples/s | 67.2 steps/s
[Step=34100 Epoch=130.7] | Loss=0.00000 | Reg=0.00011 | acc=1.0000 | L2-Norm=3.320 | L2-Norm(final)=9.651 | 4922.8 samples/s | 76.9 steps/s
[Step=34150 Epoch=130.9] | Loss=0.00000 | Reg=0.00011 | acc=1.0000 | L2-Norm=3.316 | L2-Norm(final)=9.657 | 1923.7 samples/s | 30.1 steps/s
[Step=34200 Epoch=131.0] | Loss=0.00000 | Reg=0.00011 | acc=1.0000 | L2-Norm=3.312 | L2-Norm(final)=9.663 | 4292.4 samples/s | 67.1 steps/s
[Step=34250 Epoch=131.2] | Loss=0.00000 | Reg=0.00011 | acc=1.0000 | L2-Norm=3.308 | L2-Norm(final)=9.669 | 4333.6 samples/s | 67.7 steps/s
[Step=34300 Epoch=131.4] | Loss=0.00000 | Reg=0.00011 | acc=1.0000 | L2-Norm=3.304 | L2-Norm(final)=9.675 | 4269.6 samples/s | 66.7 steps/s
[Step=34350 Epoch=131.6] | Loss=0.00000 | Reg=0.00011 | acc=1.0000 | L2-Norm=3.300 | L2-Norm(final)=9.680 | 4299.9 samples/s | 67.2 steps/s
[Step=34400 Epoch=131.8] | Loss=0.00000 | Reg=0.00011 | acc=1.0000 | L2-Norm=3.295 | L2-Norm(final)=9.686 | 1974.1 samples/s | 30.8 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step34400.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00006, len=1
[Step=33601 Epoch=129.3] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.549 | L2-Norm(final)=5.801 | 3870.7 samples/s | 60.5 steps/s
[Step=33650 Epoch=129.5] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.546 | L2-Norm(final)=5.803 | 4147.9 samples/s | 64.8 steps/s
[Step=33700 Epoch=129.7] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.543 | L2-Norm(final)=5.804 | 4191.7 samples/s | 65.5 steps/s
[Step=33750 Epoch=129.9] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.540 | L2-Norm(final)=5.807 | 4291.0 samples/s | 67.0 steps/s
[Step=33800 Epoch=130.1] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.537 | L2-Norm(final)=5.809 | 4275.7 samples/s | 66.8 steps/s
[Step=33850 Epoch=130.3] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.534 | L2-Norm(final)=5.811 | 5465.1 samples/s | 85.4 steps/s
[Step=33900 Epoch=130.5] | Loss=0.00000 | Reg=0.00021 | acc=1.0000 | L2-Norm=4.530 | L2-Norm(final)=5.814 | 1849.9 samples/s | 28.9 steps/s
[Step=33950 Epoch=130.7] | Loss=0.00000 | Reg=0.00020 | acc=1.0000 | L2-Norm=4.527 | L2-Norm(final)=5.816 | 4302.7 samples/s | 67.2 steps/s
[Step=34000 Epoch=130.9] | Loss=0.00000 | Reg=0.00020 | acc=1.0000 | L2-Norm=4.524 | L2-Norm(final)=5.818 | 4336.8 samples/s | 67.8 steps/s
[Step=34050 Epoch=131.1] | Loss=0.00000 | Reg=0.00020 | acc=1.0000 | L2-Norm=4.520 | L2-Norm(final)=5.821 | 4318.4 samples/s | 67.5 steps/s
[Step=34100 Epoch=131.3] | Loss=0.00000 | Reg=0.00020 | acc=1.0000 | L2-Norm=4.517 | L2-Norm(final)=5.823 | 4756.8 samples/s | 74.3 steps/s
[Step=34150 Epoch=131.5] | Loss=0.00000 | Reg=0.00020 | acc=1.0000 | L2-Norm=4.514 | L2-Norm(final)=5.826 | 1890.5 samples/s | 29.5 steps/s
[Step=34200 Epoch=131.6] | Loss=0.00000 | Reg=0.00020 | acc=1.0000 | L2-Norm=4.510 | L2-Norm(final)=5.828 | 4077.5 samples/s | 63.7 steps/s
[Step=34250 Epoch=131.8] | Loss=0.00000 | Reg=0.00020 | acc=1.0000 | L2-Norm=4.507 | L2-Norm(final)=5.831 | 4323.4 samples/s | 67.6 steps/s
[Step=34300 Epoch=132.0] | Loss=0.00000 | Reg=0.00020 | acc=1.0000 | L2-Norm=4.503 | L2-Norm(final)=5.833 | 4206.4 samples/s | 65.7 steps/s
[Step=34350 Epoch=132.2] | Loss=0.00000 | Reg=0.00020 | acc=1.0000 | L2-Norm=4.500 | L2-Norm(final)=5.836 | 4296.4 samples/s | 67.1 steps/s
[Step=34400 Epoch=132.4] | Loss=0.00000 | Reg=0.00020 | acc=1.0000 | L2-Norm=4.496 | L2-Norm(final)=5.838 | 1964.9 samples/s | 30.7 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step34400.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.23945 | acc=0.9582 | tpr=0.9736 | fpr=0.0753 | 3985.4 samples/s | 15.6 steps/s
Avg test loss: 0.24321, Avg test acc: 0.95693, Avg tpr: 0.97243, Avg fpr: 0.07717, total FA: 602

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.20464 | acc=0.9595 | tpr=0.9728 | fpr=0.0696 | 3972.2 samples/s | 15.5 steps/s
Avg test loss: 0.21349, Avg test acc: 0.95821, Avg tpr: 0.97272, Avg fpr: 0.07371, total FA: 575

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.13927 | acc=0.3163 | tpr=0.0023 | fpr=0.0017 | 4059.2 samples/s | 15.9 steps/s
Avg test loss: 5.16250, Avg test acc: 0.31341, Avg tpr: 0.00227, Avg fpr: 0.00231, total FA: 18

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.80821 | acc=0.3143 | tpr=0.0029 | fpr=0.0094 | 4014.3 samples/s | 15.7 steps/s
Avg test loss: 5.83622, Avg test acc: 0.31224, Avg tpr: 0.00309, Avg fpr: 0.00782, total FA: 61

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=9.05911 | acc=0.1593 | tpr=0.8053 | fpr=0.8523 | 3950.2 samples/s | 15.4 steps/s
[Step= 100] | Loss=9.02210 | acc=0.1574 | tpr=0.7655 | fpr=0.8539 | 7449.5 samples/s | 29.1 steps/s
[Step= 150] | Loss=9.08472 | acc=0.1563 | tpr=0.7752 | fpr=0.8551 | 7567.1 samples/s | 29.6 steps/s
[Step= 200] | Loss=9.07776 | acc=0.1555 | tpr=0.7639 | fpr=0.8555 | 7480.0 samples/s | 29.2 steps/s
[Step= 250] | Loss=9.09551 | acc=0.1555 | tpr=0.7668 | fpr=0.8557 | 7570.8 samples/s | 29.6 steps/s
[Step= 300] | Loss=9.10623 | acc=0.1547 | tpr=0.7658 | fpr=0.8565 | 7644.4 samples/s | 29.9 steps/s
[Step= 350] | Loss=9.10197 | acc=0.1550 | tpr=0.7683 | fpr=0.8561 | 8104.2 samples/s | 31.7 steps/s
[Step= 400] | Loss=9.10315 | acc=0.1554 | tpr=0.7702 | fpr=0.8558 | 7487.0 samples/s | 29.2 steps/s
[Step= 450] | Loss=9.10296 | acc=0.1552 | tpr=0.7722 | fpr=0.8560 | 8158.2 samples/s | 31.9 steps/s
[Step= 500] | Loss=9.11457 | acc=0.1547 | tpr=0.7670 | fpr=0.8564 | 7535.6 samples/s | 29.4 steps/s
[Step= 550] | Loss=9.11583 | acc=0.1548 | tpr=0.7668 | fpr=0.8563 | 13705.4 samples/s | 53.5 steps/s
Avg test loss: 9.11874, Avg test acc: 0.15464, Avg tpr: 0.76664, Avg fpr: 0.85648, total FA: 118921

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=9.61940 | acc=0.1527 | tpr=0.7655 | fpr=0.8584 | 4118.8 samples/s | 16.1 steps/s
[Step= 100] | Loss=9.57472 | acc=0.1513 | tpr=0.7527 | fpr=0.8599 | 8383.5 samples/s | 32.7 steps/s
[Step= 150] | Loss=9.58533 | acc=0.1512 | tpr=0.7378 | fpr=0.8596 | 7440.5 samples/s | 29.1 steps/s
[Step= 200] | Loss=9.55568 | acc=0.1521 | tpr=0.7388 | fpr=0.8586 | 8106.8 samples/s | 31.7 steps/s
[Step= 250] | Loss=9.55229 | acc=0.1529 | tpr=0.7380 | fpr=0.8578 | 7471.4 samples/s | 29.2 steps/s
[Step= 300] | Loss=9.55466 | acc=0.1529 | tpr=0.7367 | fpr=0.8578 | 8336.4 samples/s | 32.6 steps/s
[Step= 350] | Loss=9.55307 | acc=0.1525 | tpr=0.7351 | fpr=0.8580 | 7340.7 samples/s | 28.7 steps/s
[Step= 400] | Loss=9.54479 | acc=0.1528 | tpr=0.7434 | fpr=0.8579 | 8097.3 samples/s | 31.6 steps/s
[Step= 450] | Loss=9.55795 | acc=0.1526 | tpr=0.7434 | fpr=0.8581 | 7649.7 samples/s | 29.9 steps/s
[Step= 500] | Loss=9.57638 | acc=0.1519 | tpr=0.7454 | fpr=0.8588 | 7093.5 samples/s | 27.7 steps/s
[Step= 550] | Loss=9.57616 | acc=0.1518 | tpr=0.7382 | fpr=0.8589 | 14074.3 samples/s | 55.0 steps/s
Avg test loss: 9.57883, Avg test acc: 0.15164, Avg tpr: 0.73851, Avg fpr: 0.85903, total FA: 119275

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.06996 | acc=0.9843 | tpr=0.9513 | fpr=0.0151 | 4157.4 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.07361 | acc=0.9839 | tpr=0.9574 | fpr=0.0156 | 7397.8 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.07697 | acc=0.9833 | tpr=0.9582 | fpr=0.0162 | 7608.7 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.07727 | acc=0.9833 | tpr=0.9639 | fpr=0.0163 | 7840.5 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.07664 | acc=0.9834 | tpr=0.9616 | fpr=0.0162 | 7730.8 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.07749 | acc=0.9832 | tpr=0.9600 | fpr=0.0163 | 8094.5 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.07757 | acc=0.9832 | tpr=0.9593 | fpr=0.0163 | 7610.4 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.07830 | acc=0.9829 | tpr=0.9557 | fpr=0.0166 | 8233.4 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.07941 | acc=0.9827 | tpr=0.9547 | fpr=0.0168 | 7120.2 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.07939 | acc=0.9828 | tpr=0.9551 | fpr=0.0167 | 7504.2 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.07915 | acc=0.9829 | tpr=0.9542 | fpr=0.0166 | 13328.5 samples/s | 52.1 steps/s
Avg test loss: 0.07902, Avg test acc: 0.98293, Avg tpr: 0.95444, Avg fpr: 0.01655, total FA: 2298

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14187 | acc=0.9786 | tpr=0.9513 | fpr=0.0209 | 4008.5 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.15121 | acc=0.9774 | tpr=0.9680 | fpr=0.0224 | 7507.1 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.15619 | acc=0.9765 | tpr=0.9683 | fpr=0.0233 | 7349.7 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.15723 | acc=0.9765 | tpr=0.9716 | fpr=0.0234 | 7994.9 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.15572 | acc=0.9766 | tpr=0.9729 | fpr=0.0234 | 7392.5 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.15850 | acc=0.9765 | tpr=0.9724 | fpr=0.0234 | 7808.1 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.15881 | acc=0.9765 | tpr=0.9718 | fpr=0.0234 | 7748.4 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.16011 | acc=0.9763 | tpr=0.9705 | fpr=0.0236 | 7067.6 samples/s | 27.6 steps/s
[Step= 450] | Loss=0.16297 | acc=0.9758 | tpr=0.9693 | fpr=0.0240 | 7415.2 samples/s | 29.0 steps/s
[Step= 500] | Loss=0.16206 | acc=0.9759 | tpr=0.9692 | fpr=0.0240 | 7723.3 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.16086 | acc=0.9761 | tpr=0.9698 | fpr=0.0238 | 13802.6 samples/s | 53.9 steps/s
Avg test loss: 0.16054, Avg test acc: 0.97615, Avg tpr: 0.96989, Avg fpr: 0.02374, total FA: 3296

server round 43/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00006, len=1
[Step=34401 Epoch=67.1] | Loss=0.00000 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.661 | L2-Norm(final)=2.810 | 3743.9 samples/s | 58.5 steps/s
[Step=34450 Epoch=67.2] | Loss=0.00336 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.659 | L2-Norm(final)=2.811 | 4310.4 samples/s | 67.3 steps/s
[Step=34500 Epoch=67.3] | Loss=0.00294 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.658 | L2-Norm(final)=2.811 | 4462.0 samples/s | 69.7 steps/s
[Step=34550 Epoch=67.4] | Loss=0.00273 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.655 | L2-Norm(final)=2.811 | 4469.4 samples/s | 69.8 steps/s
[Step=34600 Epoch=67.5] | Loss=0.00245 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.653 | L2-Norm(final)=2.812 | 4527.7 samples/s | 70.7 steps/s
[Step=34650 Epoch=67.6] | Loss=0.00260 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.651 | L2-Norm(final)=2.812 | 4431.8 samples/s | 69.2 steps/s
[Step=34700 Epoch=67.7] | Loss=0.00256 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.650 | L2-Norm(final)=2.812 | 4481.1 samples/s | 70.0 steps/s
[Step=34750 Epoch=67.8] | Loss=0.00255 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.648 | L2-Norm(final)=2.813 | 4315.5 samples/s | 67.4 steps/s
[Step=34800 Epoch=67.9] | Loss=0.00250 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.646 | L2-Norm(final)=2.813 | 4586.2 samples/s | 71.7 steps/s
[Step=34850 Epoch=68.0] | Loss=0.00246 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.644 | L2-Norm(final)=2.814 | 4573.1 samples/s | 71.5 steps/s
[Step=34900 Epoch=68.1] | Loss=0.00247 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.642 | L2-Norm(final)=2.814 | 5600.3 samples/s | 87.5 steps/s
[Step=34950 Epoch=68.2] | Loss=0.00244 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.641 | L2-Norm(final)=2.814 | 1884.0 samples/s | 29.4 steps/s
[Step=35000 Epoch=68.3] | Loss=0.00236 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.639 | L2-Norm(final)=2.815 | 4475.0 samples/s | 69.9 steps/s
[Step=35050 Epoch=68.4] | Loss=0.00235 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.637 | L2-Norm(final)=2.815 | 4647.0 samples/s | 72.6 steps/s
[Step=35100 Epoch=68.5] | Loss=0.00236 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.635 | L2-Norm(final)=2.816 | 4625.0 samples/s | 72.3 steps/s
[Step=35150 Epoch=68.6] | Loss=0.00234 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.633 | L2-Norm(final)=2.816 | 4540.7 samples/s | 70.9 steps/s
[Step=35200 Epoch=68.7] | Loss=0.00231 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.631 | L2-Norm(final)=2.817 | 4590.7 samples/s | 71.7 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step35200.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00006, len=1
[Step=34401 Epoch=67.3] | Loss=0.00000 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.467 | L2-Norm(final)=2.655 | 4006.6 samples/s | 62.6 steps/s
[Step=34450 Epoch=67.3] | Loss=0.00194 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.465 | L2-Norm(final)=2.655 | 4560.7 samples/s | 71.3 steps/s
[Step=34500 Epoch=67.4] | Loss=0.00167 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.463 | L2-Norm(final)=2.655 | 4667.6 samples/s | 72.9 steps/s
[Step=34550 Epoch=67.5] | Loss=0.00214 | Reg=0.00305 | acc=0.9844 | L2-Norm=17.461 | L2-Norm(final)=2.655 | 4582.9 samples/s | 71.6 steps/s
[Step=34600 Epoch=67.6] | Loss=0.00195 | Reg=0.00305 | acc=0.9844 | L2-Norm=17.459 | L2-Norm(final)=2.656 | 4537.8 samples/s | 70.9 steps/s
[Step=34650 Epoch=67.7] | Loss=0.00190 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.457 | L2-Norm(final)=2.656 | 4567.5 samples/s | 71.4 steps/s
[Step=34700 Epoch=67.8] | Loss=0.00189 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.454 | L2-Norm(final)=2.657 | 4594.3 samples/s | 71.8 steps/s
[Step=34750 Epoch=67.9] | Loss=0.00196 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.452 | L2-Norm(final)=2.657 | 4681.8 samples/s | 73.2 steps/s
[Step=34800 Epoch=68.0] | Loss=0.00208 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.450 | L2-Norm(final)=2.658 | 4650.5 samples/s | 72.7 steps/s
[Step=34850 Epoch=68.1] | Loss=0.00218 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.448 | L2-Norm(final)=2.658 | 4619.6 samples/s | 72.2 steps/s
[Step=34900 Epoch=68.2] | Loss=0.00217 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.446 | L2-Norm(final)=2.658 | 5583.8 samples/s | 87.2 steps/s
[Step=34950 Epoch=68.3] | Loss=0.00209 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.444 | L2-Norm(final)=2.659 | 1944.7 samples/s | 30.4 steps/s
[Step=35000 Epoch=68.4] | Loss=0.00217 | Reg=0.00304 | acc=0.9844 | L2-Norm=17.441 | L2-Norm(final)=2.659 | 4648.0 samples/s | 72.6 steps/s
[Step=35050 Epoch=68.5] | Loss=0.00214 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.439 | L2-Norm(final)=2.660 | 4605.9 samples/s | 72.0 steps/s
[Step=35100 Epoch=68.6] | Loss=0.00213 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.437 | L2-Norm(final)=2.660 | 4523.9 samples/s | 70.7 steps/s
[Step=35150 Epoch=68.7] | Loss=0.00213 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.435 | L2-Norm(final)=2.660 | 4547.7 samples/s | 71.1 steps/s
[Step=35200 Epoch=68.8] | Loss=0.00212 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.433 | L2-Norm(final)=2.661 | 4573.6 samples/s | 71.5 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step35200.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00006, len=1
[Step=34401 Epoch=131.8] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.229 | L2-Norm(final)=9.782 | 4352.3 samples/s | 68.0 steps/s
[Step=34450 Epoch=132.0] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.225 | L2-Norm(final)=9.789 | 3831.1 samples/s | 59.9 steps/s
[Step=34500 Epoch=132.2] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.220 | L2-Norm(final)=9.795 | 4290.0 samples/s | 67.0 steps/s
[Step=34550 Epoch=132.4] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.215 | L2-Norm(final)=9.801 | 4293.1 samples/s | 67.1 steps/s
[Step=34600 Epoch=132.6] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.210 | L2-Norm(final)=9.808 | 4312.2 samples/s | 67.4 steps/s
[Step=34650 Epoch=132.8] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.207 | L2-Norm(final)=9.815 | 5533.8 samples/s | 86.5 steps/s
[Step=34700 Epoch=133.0] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.205 | L2-Norm(final)=9.823 | 1870.0 samples/s | 29.2 steps/s
[Step=34750 Epoch=133.1] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.202 | L2-Norm(final)=9.831 | 4208.2 samples/s | 65.8 steps/s
[Step=34800 Epoch=133.3] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.198 | L2-Norm(final)=9.838 | 4363.1 samples/s | 68.2 steps/s
[Step=34850 Epoch=133.5] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.194 | L2-Norm(final)=9.844 | 4260.1 samples/s | 66.6 steps/s
[Step=34900 Epoch=133.7] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.190 | L2-Norm(final)=9.851 | 4811.1 samples/s | 75.2 steps/s
[Step=34950 Epoch=133.9] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.186 | L2-Norm(final)=9.857 | 1967.3 samples/s | 30.7 steps/s
[Step=35000 Epoch=134.1] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.182 | L2-Norm(final)=9.863 | 4053.4 samples/s | 63.3 steps/s
[Step=35050 Epoch=134.3] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.177 | L2-Norm(final)=9.869 | 4235.9 samples/s | 66.2 steps/s
[Step=35100 Epoch=134.5] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.174 | L2-Norm(final)=9.876 | 4233.3 samples/s | 66.1 steps/s
[Step=35150 Epoch=134.7] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.170 | L2-Norm(final)=9.882 | 4320.6 samples/s | 67.5 steps/s
[Step=35200 Epoch=134.9] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.166 | L2-Norm(final)=9.889 | 1976.0 samples/s | 30.9 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step35200.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00006, len=1
[Step=34401 Epoch=132.4] | Loss=0.00000 | Reg=0.00020 | acc=1.0000 | L2-Norm=4.439 | L2-Norm(final)=5.881 | 3941.0 samples/s | 61.6 steps/s
[Step=34450 Epoch=132.6] | Loss=0.00000 | Reg=0.00020 | acc=1.0000 | L2-Norm=4.435 | L2-Norm(final)=5.884 | 3994.6 samples/s | 62.4 steps/s
[Step=34500 Epoch=132.8] | Loss=0.00000 | Reg=0.00020 | acc=1.0000 | L2-Norm=4.431 | L2-Norm(final)=5.886 | 4113.3 samples/s | 64.3 steps/s
[Step=34550 Epoch=133.0] | Loss=0.00000 | Reg=0.00020 | acc=1.0000 | L2-Norm=4.427 | L2-Norm(final)=5.889 | 4136.5 samples/s | 64.6 steps/s
[Step=34600 Epoch=133.2] | Loss=0.00000 | Reg=0.00020 | acc=1.0000 | L2-Norm=4.423 | L2-Norm(final)=5.892 | 4183.6 samples/s | 65.4 steps/s
[Step=34650 Epoch=133.4] | Loss=0.00000 | Reg=0.00020 | acc=1.0000 | L2-Norm=4.418 | L2-Norm(final)=5.895 | 5297.0 samples/s | 82.8 steps/s
[Step=34700 Epoch=133.6] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.414 | L2-Norm(final)=5.897 | 1815.3 samples/s | 28.4 steps/s
[Step=34750 Epoch=133.8] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.410 | L2-Norm(final)=5.900 | 4274.3 samples/s | 66.8 steps/s
[Step=34800 Epoch=134.0] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.405 | L2-Norm(final)=5.903 | 4337.1 samples/s | 67.8 steps/s
[Step=34850 Epoch=134.2] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.401 | L2-Norm(final)=5.906 | 4318.8 samples/s | 67.5 steps/s
[Step=34900 Epoch=134.3] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.396 | L2-Norm(final)=5.909 | 4900.4 samples/s | 76.6 steps/s
[Step=34950 Epoch=134.5] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.392 | L2-Norm(final)=5.912 | 1906.1 samples/s | 29.8 steps/s
[Step=35000 Epoch=134.7] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.388 | L2-Norm(final)=5.915 | 4288.1 samples/s | 67.0 steps/s
[Step=35050 Epoch=134.9] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.383 | L2-Norm(final)=5.918 | 4315.8 samples/s | 67.4 steps/s
[Step=35100 Epoch=135.1] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.378 | L2-Norm(final)=5.921 | 4329.2 samples/s | 67.6 steps/s
[Step=35150 Epoch=135.3] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.374 | L2-Norm(final)=5.925 | 4296.0 samples/s | 67.1 steps/s
[Step=35200 Epoch=135.5] | Loss=0.00000 | Reg=0.00019 | acc=1.0000 | L2-Norm=4.369 | L2-Norm(final)=5.928 | 1927.5 samples/s | 30.1 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step35200.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.23941 | acc=0.9585 | tpr=0.9738 | fpr=0.0746 | 3970.2 samples/s | 15.5 steps/s
Avg test loss: 0.24270, Avg test acc: 0.95737, Avg tpr: 0.97284, Avg fpr: 0.07666, total FA: 598

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.20084 | acc=0.9594 | tpr=0.9700 | fpr=0.0637 | 4004.0 samples/s | 15.6 steps/s
Avg test loss: 0.21010, Avg test acc: 0.95797, Avg tpr: 0.96998, Avg fpr: 0.06845, total FA: 534

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.95229 | acc=0.3179 | tpr=0.0058 | fpr=0.0045 | 3953.1 samples/s | 15.4 steps/s
Avg test loss: 4.97479, Avg test acc: 0.31489, Avg tpr: 0.00595, Avg fpr: 0.00564, total FA: 44

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.81883 | acc=0.3145 | tpr=0.0023 | fpr=0.0077 | 4033.6 samples/s | 15.8 steps/s
Avg test loss: 5.84658, Avg test acc: 0.31224, Avg tpr: 0.00239, Avg fpr: 0.00628, total FA: 49

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=9.10545 | acc=0.1598 | tpr=0.8053 | fpr=0.8518 | 4040.1 samples/s | 15.8 steps/s
[Step= 100] | Loss=9.07115 | acc=0.1588 | tpr=0.7655 | fpr=0.8525 | 7509.6 samples/s | 29.3 steps/s
[Step= 150] | Loss=9.13333 | acc=0.1573 | tpr=0.7752 | fpr=0.8541 | 7590.1 samples/s | 29.6 steps/s
[Step= 200] | Loss=9.12599 | acc=0.1565 | tpr=0.7672 | fpr=0.8546 | 7544.1 samples/s | 29.5 steps/s
[Step= 250] | Loss=9.14269 | acc=0.1565 | tpr=0.7703 | fpr=0.8547 | 7468.6 samples/s | 29.2 steps/s
[Step= 300] | Loss=9.15370 | acc=0.1559 | tpr=0.7695 | fpr=0.8553 | 7764.8 samples/s | 30.3 steps/s
[Step= 350] | Loss=9.14899 | acc=0.1563 | tpr=0.7702 | fpr=0.8549 | 7524.8 samples/s | 29.4 steps/s
[Step= 400] | Loss=9.14983 | acc=0.1565 | tpr=0.7702 | fpr=0.8547 | 8202.1 samples/s | 32.0 steps/s
[Step= 450] | Loss=9.14979 | acc=0.1562 | tpr=0.7722 | fpr=0.8550 | 7617.9 samples/s | 29.8 steps/s
[Step= 500] | Loss=9.16104 | acc=0.1557 | tpr=0.7678 | fpr=0.8553 | 7999.0 samples/s | 31.2 steps/s
[Step= 550] | Loss=9.16264 | acc=0.1558 | tpr=0.7676 | fpr=0.8553 | 14400.5 samples/s | 56.3 steps/s
Avg test loss: 9.16563, Avg test acc: 0.15569, Avg tpr: 0.76743, Avg fpr: 0.85543, total FA: 118775

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=9.16920 | acc=0.1634 | tpr=0.7478 | fpr=0.8471 | 4327.1 samples/s | 16.9 steps/s
[Step= 100] | Loss=9.12611 | acc=0.1621 | tpr=0.7313 | fpr=0.8485 | 7254.5 samples/s | 28.3 steps/s
[Step= 150] | Loss=9.13595 | acc=0.1624 | tpr=0.7190 | fpr=0.8479 | 8001.2 samples/s | 31.3 steps/s
[Step= 200] | Loss=9.10680 | acc=0.1633 | tpr=0.7235 | fpr=0.8469 | 7693.8 samples/s | 30.1 steps/s
[Step= 250] | Loss=9.10360 | acc=0.1637 | tpr=0.7214 | fpr=0.8465 | 7897.6 samples/s | 30.8 steps/s
[Step= 300] | Loss=9.10546 | acc=0.1636 | tpr=0.7193 | fpr=0.8465 | 7904.6 samples/s | 30.9 steps/s
[Step= 350] | Loss=9.10318 | acc=0.1631 | tpr=0.7163 | fpr=0.8469 | 7564.8 samples/s | 29.5 steps/s
[Step= 400] | Loss=9.09536 | acc=0.1633 | tpr=0.7243 | fpr=0.8469 | 7699.8 samples/s | 30.1 steps/s
[Step= 450] | Loss=9.10830 | acc=0.1631 | tpr=0.7235 | fpr=0.8471 | 7700.2 samples/s | 30.1 steps/s
[Step= 500] | Loss=9.12616 | acc=0.1624 | tpr=0.7247 | fpr=0.8478 | 7790.8 samples/s | 30.4 steps/s
[Step= 550] | Loss=9.12563 | acc=0.1623 | tpr=0.7171 | fpr=0.8478 | 14960.8 samples/s | 58.4 steps/s
Avg test loss: 9.12824, Avg test acc: 0.16217, Avg tpr: 0.71712, Avg fpr: 0.84792, total FA: 117732

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10015 | acc=0.9785 | tpr=0.9646 | fpr=0.0212 | 4265.5 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.10468 | acc=0.9777 | tpr=0.9744 | fpr=0.0222 | 7218.7 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.10943 | acc=0.9771 | tpr=0.9741 | fpr=0.0228 | 7907.7 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.11038 | acc=0.9772 | tpr=0.9792 | fpr=0.0228 | 7525.0 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.10959 | acc=0.9773 | tpr=0.9782 | fpr=0.0228 | 7527.7 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.11072 | acc=0.9771 | tpr=0.9775 | fpr=0.0229 | 7673.1 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.11067 | acc=0.9772 | tpr=0.9787 | fpr=0.0228 | 7324.5 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.11172 | acc=0.9769 | tpr=0.9765 | fpr=0.0231 | 7917.5 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.11320 | acc=0.9766 | tpr=0.9747 | fpr=0.0234 | 7811.9 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.11310 | acc=0.9768 | tpr=0.9753 | fpr=0.0232 | 7549.5 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.11250 | acc=0.9769 | tpr=0.9753 | fpr=0.0230 | 12844.0 samples/s | 50.2 steps/s
Avg test loss: 0.11230, Avg test acc: 0.97697, Avg tpr: 0.97544, Avg fpr: 0.02300, total FA: 3194

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12914 | acc=0.9795 | tpr=0.9469 | fpr=0.0199 | 3998.9 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.13768 | acc=0.9787 | tpr=0.9659 | fpr=0.0211 | 7885.5 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.14202 | acc=0.9779 | tpr=0.9669 | fpr=0.0219 | 7091.1 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.14303 | acc=0.9779 | tpr=0.9694 | fpr=0.0219 | 7294.6 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.14168 | acc=0.9780 | tpr=0.9703 | fpr=0.0218 | 7435.4 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.14447 | acc=0.9780 | tpr=0.9702 | fpr=0.0218 | 7687.3 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.14476 | acc=0.9780 | tpr=0.9693 | fpr=0.0219 | 7858.1 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.14595 | acc=0.9777 | tpr=0.9672 | fpr=0.0221 | 7864.5 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.14854 | acc=0.9773 | tpr=0.9664 | fpr=0.0225 | 7487.8 samples/s | 29.2 steps/s
[Step= 500] | Loss=0.14765 | acc=0.9773 | tpr=0.9665 | fpr=0.0225 | 7611.6 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.14664 | acc=0.9776 | tpr=0.9674 | fpr=0.0223 | 13050.2 samples/s | 51.0 steps/s
Avg test loss: 0.14636, Avg test acc: 0.97759, Avg tpr: 0.96751, Avg fpr: 0.02223, total FA: 3086

server round 44/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00006, len=1
[Step=35201 Epoch=68.7] | Loss=0.00002 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.601 | L2-Norm(final)=2.824 | 4152.7 samples/s | 64.9 steps/s
[Step=35250 Epoch=68.8] | Loss=0.00255 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.600 | L2-Norm(final)=2.824 | 4112.7 samples/s | 64.3 steps/s
[Step=35300 Epoch=68.8] | Loss=0.00179 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.598 | L2-Norm(final)=2.825 | 4435.1 samples/s | 69.3 steps/s
[Step=35350 Epoch=68.9] | Loss=0.00232 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.596 | L2-Norm(final)=2.826 | 4393.9 samples/s | 68.7 steps/s
[Step=35400 Epoch=69.0] | Loss=0.00223 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.594 | L2-Norm(final)=2.826 | 4380.8 samples/s | 68.5 steps/s
[Step=35450 Epoch=69.1] | Loss=0.00239 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.593 | L2-Norm(final)=2.826 | 4490.0 samples/s | 70.2 steps/s
[Step=35500 Epoch=69.2] | Loss=0.00252 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.591 | L2-Norm(final)=2.827 | 4408.5 samples/s | 68.9 steps/s
[Step=35550 Epoch=69.3] | Loss=0.00255 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.589 | L2-Norm(final)=2.827 | 4451.0 samples/s | 69.5 steps/s
[Step=35600 Epoch=69.4] | Loss=0.00263 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.587 | L2-Norm(final)=2.827 | 4557.4 samples/s | 71.2 steps/s
[Step=35650 Epoch=69.5] | Loss=0.00248 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.585 | L2-Norm(final)=2.827 | 4424.7 samples/s | 69.1 steps/s
[Step=35700 Epoch=69.6] | Loss=0.00250 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.583 | L2-Norm(final)=2.828 | 5436.4 samples/s | 84.9 steps/s
[Step=35750 Epoch=69.7] | Loss=0.00254 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.581 | L2-Norm(final)=2.828 | 1870.7 samples/s | 29.2 steps/s
[Step=35800 Epoch=69.8] | Loss=0.00256 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.579 | L2-Norm(final)=2.829 | 4565.6 samples/s | 71.3 steps/s
[Step=35850 Epoch=69.9] | Loss=0.00252 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.577 | L2-Norm(final)=2.829 | 4507.0 samples/s | 70.4 steps/s
[Step=35900 Epoch=70.0] | Loss=0.00254 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.575 | L2-Norm(final)=2.830 | 4519.3 samples/s | 70.6 steps/s
[Step=35950 Epoch=70.1] | Loss=0.00249 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.574 | L2-Norm(final)=2.830 | 4436.2 samples/s | 69.3 steps/s
[Step=36000 Epoch=70.2] | Loss=0.00245 | Reg=0.00309 | acc=0.9844 | L2-Norm=17.572 | L2-Norm(final)=2.831 | 4546.3 samples/s | 71.0 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step36000.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00006, len=1
[Step=35201 Epoch=68.8] | Loss=0.00002 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.400 | L2-Norm(final)=2.669 | 3965.0 samples/s | 62.0 steps/s
[Step=35250 Epoch=68.9] | Loss=0.00175 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.398 | L2-Norm(final)=2.669 | 4496.6 samples/s | 70.3 steps/s
[Step=35300 Epoch=69.0] | Loss=0.00150 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.396 | L2-Norm(final)=2.670 | 4555.7 samples/s | 71.2 steps/s
[Step=35350 Epoch=69.1] | Loss=0.00184 | Reg=0.00303 | acc=0.9844 | L2-Norm=17.394 | L2-Norm(final)=2.671 | 4569.4 samples/s | 71.4 steps/s
[Step=35400 Epoch=69.2] | Loss=0.00216 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.392 | L2-Norm(final)=2.671 | 4641.6 samples/s | 72.5 steps/s
[Step=35450 Epoch=69.3] | Loss=0.00212 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.389 | L2-Norm(final)=2.671 | 4575.5 samples/s | 71.5 steps/s
[Step=35500 Epoch=69.4] | Loss=0.00223 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.387 | L2-Norm(final)=2.672 | 4584.7 samples/s | 71.6 steps/s
[Step=35550 Epoch=69.5] | Loss=0.00204 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.385 | L2-Norm(final)=2.672 | 4530.1 samples/s | 70.8 steps/s
[Step=35600 Epoch=69.6] | Loss=0.00197 | Reg=0.00302 | acc=0.9844 | L2-Norm=17.382 | L2-Norm(final)=2.672 | 4599.5 samples/s | 71.9 steps/s
[Step=35650 Epoch=69.7] | Loss=0.00217 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.380 | L2-Norm(final)=2.673 | 4582.7 samples/s | 71.6 steps/s
[Step=35700 Epoch=69.8] | Loss=0.00211 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.378 | L2-Norm(final)=2.673 | 5694.9 samples/s | 89.0 steps/s
[Step=35750 Epoch=69.9] | Loss=0.00207 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.376 | L2-Norm(final)=2.674 | 1915.9 samples/s | 29.9 steps/s
[Step=35800 Epoch=70.0] | Loss=0.00206 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.374 | L2-Norm(final)=2.674 | 4584.7 samples/s | 71.6 steps/s
[Step=35850 Epoch=70.1] | Loss=0.00211 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.372 | L2-Norm(final)=2.675 | 4695.5 samples/s | 73.4 steps/s
[Step=35900 Epoch=70.2] | Loss=0.00206 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.370 | L2-Norm(final)=2.675 | 4643.0 samples/s | 72.5 steps/s
[Step=35950 Epoch=70.3] | Loss=0.00210 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.367 | L2-Norm(final)=2.676 | 4373.7 samples/s | 68.3 steps/s
[Step=36000 Epoch=70.4] | Loss=0.00215 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.365 | L2-Norm(final)=2.676 | 4299.6 samples/s | 67.2 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step36000.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00006, len=1
[Step=35201 Epoch=134.9] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.108 | L2-Norm(final)=9.999 | 3996.3 samples/s | 62.4 steps/s
[Step=35250 Epoch=135.1] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.106 | L2-Norm(final)=10.007 | 4136.1 samples/s | 64.6 steps/s
[Step=35300 Epoch=135.3] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.102 | L2-Norm(final)=10.013 | 4416.0 samples/s | 69.0 steps/s
[Step=35350 Epoch=135.4] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.098 | L2-Norm(final)=10.019 | 4219.1 samples/s | 65.9 steps/s
[Step=35400 Epoch=135.6] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.093 | L2-Norm(final)=10.025 | 4386.1 samples/s | 68.5 steps/s
[Step=35450 Epoch=135.8] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.089 | L2-Norm(final)=10.030 | 5352.9 samples/s | 83.6 steps/s
[Step=35500 Epoch=136.0] | Loss=0.00000 | Reg=0.00010 | acc=1.0000 | L2-Norm=3.084 | L2-Norm(final)=10.036 | 1900.8 samples/s | 29.7 steps/s
[Step=35550 Epoch=136.2] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=3.079 | L2-Norm(final)=10.042 | 4316.3 samples/s | 67.4 steps/s
[Step=35600 Epoch=136.4] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=3.075 | L2-Norm(final)=10.047 | 4296.5 samples/s | 67.1 steps/s
[Step=35650 Epoch=136.6] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=3.070 | L2-Norm(final)=10.053 | 4487.5 samples/s | 70.1 steps/s
[Step=35700 Epoch=136.8] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=3.065 | L2-Norm(final)=10.059 | 4809.1 samples/s | 75.1 steps/s
[Step=35750 Epoch=137.0] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=3.061 | L2-Norm(final)=10.065 | 1968.4 samples/s | 30.8 steps/s
[Step=35800 Epoch=137.2] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=3.057 | L2-Norm(final)=10.072 | 4338.0 samples/s | 67.8 steps/s
[Step=35850 Epoch=137.4] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=3.053 | L2-Norm(final)=10.079 | 4284.4 samples/s | 66.9 steps/s
[Step=35900 Epoch=137.6] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=3.049 | L2-Norm(final)=10.085 | 4443.4 samples/s | 69.4 steps/s
[Step=35950 Epoch=137.7] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=3.045 | L2-Norm(final)=10.092 | 4385.1 samples/s | 68.5 steps/s
[Step=36000 Epoch=137.9] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=3.040 | L2-Norm(final)=10.099 | 2036.4 samples/s | 31.8 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step36000.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00006, len=1
[Step=35201 Epoch=135.5] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.295 | L2-Norm(final)=5.981 | 3983.5 samples/s | 62.2 steps/s
[Step=35250 Epoch=135.7] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.290 | L2-Norm(final)=5.984 | 3637.0 samples/s | 56.8 steps/s
[Step=35300 Epoch=135.9] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.284 | L2-Norm(final)=5.988 | 4143.9 samples/s | 64.7 steps/s
[Step=35350 Epoch=136.1] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.279 | L2-Norm(final)=5.991 | 4317.3 samples/s | 67.5 steps/s
[Step=35400 Epoch=136.3] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.273 | L2-Norm(final)=5.994 | 4245.5 samples/s | 66.3 steps/s
[Step=35450 Epoch=136.5] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.268 | L2-Norm(final)=5.998 | 5383.3 samples/s | 84.1 steps/s
[Step=35500 Epoch=136.7] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.263 | L2-Norm(final)=6.002 | 1788.2 samples/s | 27.9 steps/s
[Step=35550 Epoch=136.8] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.259 | L2-Norm(final)=6.007 | 4225.1 samples/s | 66.0 steps/s
[Step=35600 Epoch=137.0] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.254 | L2-Norm(final)=6.011 | 4212.8 samples/s | 65.8 steps/s
[Step=35650 Epoch=137.2] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.249 | L2-Norm(final)=6.016 | 4243.6 samples/s | 66.3 steps/s
[Step=35700 Epoch=137.4] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.244 | L2-Norm(final)=6.020 | 4727.3 samples/s | 73.9 steps/s
[Step=35750 Epoch=137.6] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.239 | L2-Norm(final)=6.024 | 1933.5 samples/s | 30.2 steps/s
[Step=35800 Epoch=137.8] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.234 | L2-Norm(final)=6.028 | 4333.7 samples/s | 67.7 steps/s
[Step=35850 Epoch=138.0] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.228 | L2-Norm(final)=6.032 | 4349.7 samples/s | 68.0 steps/s
[Step=35900 Epoch=138.2] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.222 | L2-Norm(final)=6.036 | 4381.1 samples/s | 68.5 steps/s
[Step=35950 Epoch=138.4] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.217 | L2-Norm(final)=6.040 | 4448.8 samples/s | 69.5 steps/s
[Step=36000 Epoch=138.6] | Loss=0.00000 | Reg=0.00018 | acc=1.0000 | L2-Norm=4.212 | L2-Norm(final)=6.044 | 1962.3 samples/s | 30.7 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step36000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.23142 | acc=0.9587 | tpr=0.9724 | fpr=0.0709 | 4014.0 samples/s | 15.7 steps/s
Avg test loss: 0.23588, Avg test acc: 0.95769, Avg tpr: 0.97092, Avg fpr: 0.07140, total FA: 557

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.20161 | acc=0.9586 | tpr=0.9674 | fpr=0.0605 | 4009.5 samples/s | 15.7 steps/s
Avg test loss: 0.20995, Avg test acc: 0.95721, Avg tpr: 0.96684, Avg fpr: 0.06397, total FA: 499

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.02786 | acc=0.3167 | tpr=0.0026 | fpr=0.0012 | 4060.6 samples/s | 15.9 steps/s
Avg test loss: 5.05157, Avg test acc: 0.31353, Avg tpr: 0.00233, Avg fpr: 0.00205, total FA: 16

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.84455 | acc=0.3146 | tpr=0.0019 | fpr=0.0064 | 3990.4 samples/s | 15.6 steps/s
Avg test loss: 5.87229, Avg test acc: 0.31232, Avg tpr: 0.00198, Avg fpr: 0.00513, total FA: 40

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.57802 | acc=0.1691 | tpr=0.7832 | fpr=0.8420 | 4074.8 samples/s | 15.9 steps/s
[Step= 100] | Loss=8.54249 | acc=0.1686 | tpr=0.7463 | fpr=0.8422 | 7121.0 samples/s | 27.8 steps/s
[Step= 150] | Loss=8.60341 | acc=0.1672 | tpr=0.7522 | fpr=0.8436 | 7531.4 samples/s | 29.4 steps/s
[Step= 200] | Loss=8.59637 | acc=0.1666 | tpr=0.7464 | fpr=0.8440 | 7204.3 samples/s | 28.1 steps/s
[Step= 250] | Loss=8.61438 | acc=0.1667 | tpr=0.7485 | fpr=0.8439 | 7490.9 samples/s | 29.3 steps/s
[Step= 300] | Loss=8.62423 | acc=0.1659 | tpr=0.7498 | fpr=0.8448 | 7633.0 samples/s | 29.8 steps/s
[Step= 350] | Loss=8.61927 | acc=0.1662 | tpr=0.7520 | fpr=0.8444 | 7572.0 samples/s | 29.6 steps/s
[Step= 400] | Loss=8.61992 | acc=0.1665 | tpr=0.7511 | fpr=0.8441 | 6654.8 samples/s | 26.0 steps/s
[Step= 450] | Loss=8.61974 | acc=0.1661 | tpr=0.7551 | fpr=0.8446 | 7687.9 samples/s | 30.0 steps/s
[Step= 500] | Loss=8.63149 | acc=0.1657 | tpr=0.7493 | fpr=0.8449 | 7643.8 samples/s | 29.9 steps/s
[Step= 550] | Loss=8.63327 | acc=0.1658 | tpr=0.7493 | fpr=0.8448 | 15019.7 samples/s | 58.7 steps/s
Avg test loss: 8.63615, Avg test acc: 0.16570, Avg tpr: 0.74921, Avg fpr: 0.84490, total FA: 117313

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=9.07615 | acc=0.1684 | tpr=0.7124 | fpr=0.8414 | 4162.0 samples/s | 16.3 steps/s
[Step= 100] | Loss=9.03119 | acc=0.1683 | tpr=0.7058 | fpr=0.8417 | 7899.1 samples/s | 30.9 steps/s
[Step= 150] | Loss=9.04103 | acc=0.1685 | tpr=0.6916 | fpr=0.8411 | 7525.2 samples/s | 29.4 steps/s
[Step= 200] | Loss=9.01305 | acc=0.1694 | tpr=0.6984 | fpr=0.8402 | 8363.2 samples/s | 32.7 steps/s
[Step= 250] | Loss=9.00927 | acc=0.1703 | tpr=0.6943 | fpr=0.8393 | 7406.7 samples/s | 28.9 steps/s
[Step= 300] | Loss=9.01057 | acc=0.1705 | tpr=0.6924 | fpr=0.8390 | 7964.4 samples/s | 31.1 steps/s
[Step= 350] | Loss=9.00851 | acc=0.1701 | tpr=0.6900 | fpr=0.8393 | 7745.5 samples/s | 30.3 steps/s
[Step= 400] | Loss=9.00039 | acc=0.1703 | tpr=0.6997 | fpr=0.8393 | 7457.2 samples/s | 29.1 steps/s
[Step= 450] | Loss=9.01353 | acc=0.1701 | tpr=0.6957 | fpr=0.8395 | 8023.3 samples/s | 31.3 steps/s
[Step= 500] | Loss=9.03143 | acc=0.1693 | tpr=0.6978 | fpr=0.8402 | 7355.8 samples/s | 28.7 steps/s
[Step= 550] | Loss=9.03132 | acc=0.1692 | tpr=0.6904 | fpr=0.8403 | 15141.6 samples/s | 59.1 steps/s
Avg test loss: 9.03408, Avg test acc: 0.16904, Avg tpr: 0.69057, Avg fpr: 0.84044, total FA: 116694

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08746 | acc=0.9810 | tpr=0.9558 | fpr=0.0185 | 4093.7 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.09140 | acc=0.9809 | tpr=0.9701 | fpr=0.0189 | 8171.7 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.09556 | acc=0.9801 | tpr=0.9697 | fpr=0.0198 | 7868.4 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.09639 | acc=0.9798 | tpr=0.9738 | fpr=0.0200 | 7866.0 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.09555 | acc=0.9799 | tpr=0.9729 | fpr=0.0200 | 7415.6 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.09661 | acc=0.9797 | tpr=0.9709 | fpr=0.0202 | 7564.7 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.09663 | acc=0.9797 | tpr=0.9706 | fpr=0.0201 | 7662.1 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.09755 | acc=0.9794 | tpr=0.9666 | fpr=0.0204 | 7554.1 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.09889 | acc=0.9791 | tpr=0.9654 | fpr=0.0206 | 7922.9 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.09886 | acc=0.9792 | tpr=0.9665 | fpr=0.0206 | 7871.5 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.09834 | acc=0.9794 | tpr=0.9670 | fpr=0.0204 | 8496.7 samples/s | 33.2 steps/s
Avg test loss: 0.09816, Avg test acc: 0.97942, Avg tpr: 0.96712, Avg fpr: 0.02036, total FA: 2827

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12874 | acc=0.9791 | tpr=0.9469 | fpr=0.0204 | 4101.7 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.13708 | acc=0.9784 | tpr=0.9659 | fpr=0.0214 | 7539.1 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.14149 | acc=0.9777 | tpr=0.9654 | fpr=0.0221 | 7536.2 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.14249 | acc=0.9775 | tpr=0.9672 | fpr=0.0223 | 7494.9 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.14117 | acc=0.9777 | tpr=0.9686 | fpr=0.0222 | 7306.8 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.14396 | acc=0.9776 | tpr=0.9680 | fpr=0.0223 | 7564.4 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.14418 | acc=0.9776 | tpr=0.9674 | fpr=0.0222 | 6694.4 samples/s | 26.2 steps/s
[Step= 400] | Loss=0.14538 | acc=0.9774 | tpr=0.9655 | fpr=0.0224 | 7807.8 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.14797 | acc=0.9770 | tpr=0.9649 | fpr=0.0228 | 7111.7 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.14716 | acc=0.9771 | tpr=0.9648 | fpr=0.0227 | 7266.2 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.14613 | acc=0.9773 | tpr=0.9654 | fpr=0.0225 | 7152.3 samples/s | 27.9 steps/s
Avg test loss: 0.14585, Avg test acc: 0.97732, Avg tpr: 0.96513, Avg fpr: 0.02246, total FA: 3119

server round 45/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00006, len=1
[Step=36001 Epoch=70.2] | Loss=0.00528 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.541 | L2-Norm(final)=2.838 | 3932.2 samples/s | 61.4 steps/s
[Step=36050 Epoch=70.3] | Loss=0.00200 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.540 | L2-Norm(final)=2.839 | 4080.8 samples/s | 63.8 steps/s
[Step=36100 Epoch=70.4] | Loss=0.00222 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.538 | L2-Norm(final)=2.840 | 4421.3 samples/s | 69.1 steps/s
[Step=36150 Epoch=70.5] | Loss=0.00223 | Reg=0.00308 | acc=0.9844 | L2-Norm=17.537 | L2-Norm(final)=2.841 | 4435.3 samples/s | 69.3 steps/s
[Step=36200 Epoch=70.6] | Loss=0.00240 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.535 | L2-Norm(final)=2.842 | 4428.6 samples/s | 69.2 steps/s
[Step=36250 Epoch=70.7] | Loss=0.00248 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.533 | L2-Norm(final)=2.842 | 4441.2 samples/s | 69.4 steps/s
[Step=36300 Epoch=70.8] | Loss=0.00240 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.531 | L2-Norm(final)=2.842 | 4378.9 samples/s | 68.4 steps/s
[Step=36350 Epoch=70.9] | Loss=0.00236 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.529 | L2-Norm(final)=2.842 | 4433.7 samples/s | 69.3 steps/s
[Step=36400 Epoch=71.0] | Loss=0.00243 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.527 | L2-Norm(final)=2.842 | 4532.4 samples/s | 70.8 steps/s
[Step=36450 Epoch=71.1] | Loss=0.00240 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.525 | L2-Norm(final)=2.842 | 4444.7 samples/s | 69.4 steps/s
[Step=36500 Epoch=71.2] | Loss=0.00247 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.523 | L2-Norm(final)=2.843 | 5401.1 samples/s | 84.4 steps/s
[Step=36550 Epoch=71.3] | Loss=0.00244 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.521 | L2-Norm(final)=2.843 | 1790.6 samples/s | 28.0 steps/s
[Step=36600 Epoch=71.4] | Loss=0.00243 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.519 | L2-Norm(final)=2.843 | 4585.9 samples/s | 71.7 steps/s
[Step=36650 Epoch=71.5] | Loss=0.00240 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.517 | L2-Norm(final)=2.844 | 4386.4 samples/s | 68.5 steps/s
[Step=36700 Epoch=71.6] | Loss=0.00235 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.515 | L2-Norm(final)=2.844 | 4484.5 samples/s | 70.1 steps/s
[Step=36750 Epoch=71.7] | Loss=0.00240 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.513 | L2-Norm(final)=2.845 | 4516.1 samples/s | 70.6 steps/s
[Step=36800 Epoch=71.8] | Loss=0.00243 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.511 | L2-Norm(final)=2.845 | 4424.3 samples/s | 69.1 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step36800.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00006, len=1
[Step=36001 Epoch=70.4] | Loss=0.00003 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.331 | L2-Norm(final)=2.683 | 3827.4 samples/s | 59.8 steps/s
[Step=36050 Epoch=70.5] | Loss=0.00124 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.329 | L2-Norm(final)=2.684 | 4734.7 samples/s | 74.0 steps/s
[Step=36100 Epoch=70.6] | Loss=0.00180 | Reg=0.00300 | acc=0.9844 | L2-Norm=17.328 | L2-Norm(final)=2.685 | 4587.4 samples/s | 71.7 steps/s
[Step=36150 Epoch=70.7] | Loss=0.00171 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.326 | L2-Norm(final)=2.685 | 4624.1 samples/s | 72.3 steps/s
[Step=36200 Epoch=70.8] | Loss=0.00166 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.324 | L2-Norm(final)=2.686 | 4657.1 samples/s | 72.8 steps/s
[Step=36250 Epoch=70.9] | Loss=0.00195 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.322 | L2-Norm(final)=2.687 | 4543.8 samples/s | 71.0 steps/s
[Step=36300 Epoch=71.0] | Loss=0.00196 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.320 | L2-Norm(final)=2.688 | 4591.7 samples/s | 71.7 steps/s
[Step=36350 Epoch=71.1] | Loss=0.00203 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.318 | L2-Norm(final)=2.688 | 4520.1 samples/s | 70.6 steps/s
[Step=36400 Epoch=71.2] | Loss=0.00199 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.316 | L2-Norm(final)=2.688 | 4652.3 samples/s | 72.7 steps/s
[Step=36450 Epoch=71.3] | Loss=0.00204 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.314 | L2-Norm(final)=2.689 | 4711.8 samples/s | 73.6 steps/s
[Step=36500 Epoch=71.4] | Loss=0.00210 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.312 | L2-Norm(final)=2.689 | 5715.9 samples/s | 89.3 steps/s
[Step=36550 Epoch=71.5] | Loss=0.00218 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.310 | L2-Norm(final)=2.690 | 1887.0 samples/s | 29.5 steps/s
[Step=36600 Epoch=71.6] | Loss=0.00213 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.308 | L2-Norm(final)=2.690 | 4592.2 samples/s | 71.8 steps/s
[Step=36650 Epoch=71.6] | Loss=0.00217 | Reg=0.00299 | acc=0.9844 | L2-Norm=17.306 | L2-Norm(final)=2.690 | 4648.5 samples/s | 72.6 steps/s
[Step=36700 Epoch=71.7] | Loss=0.00218 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.303 | L2-Norm(final)=2.691 | 4652.1 samples/s | 72.7 steps/s
[Step=36750 Epoch=71.8] | Loss=0.00217 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.301 | L2-Norm(final)=2.691 | 4519.1 samples/s | 70.6 steps/s
[Step=36800 Epoch=71.9] | Loss=0.00214 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.299 | L2-Norm(final)=2.692 | 4574.1 samples/s | 71.5 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step36800.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00006, len=1
[Step=36001 Epoch=137.9] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.972 | L2-Norm(final)=10.207 | 4228.9 samples/s | 66.1 steps/s
[Step=36050 Epoch=138.1] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.968 | L2-Norm(final)=10.214 | 4184.2 samples/s | 65.4 steps/s
[Step=36100 Epoch=138.3] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.964 | L2-Norm(final)=10.222 | 4421.0 samples/s | 69.1 steps/s
[Step=36150 Epoch=138.5] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.960 | L2-Norm(final)=10.229 | 4340.1 samples/s | 67.8 steps/s
[Step=36200 Epoch=138.7] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.955 | L2-Norm(final)=10.236 | 4346.3 samples/s | 67.9 steps/s
[Step=36250 Epoch=138.9] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.950 | L2-Norm(final)=10.243 | 5380.4 samples/s | 84.1 steps/s
[Step=36300 Epoch=139.1] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.945 | L2-Norm(final)=10.250 | 1893.7 samples/s | 29.6 steps/s
[Step=36350 Epoch=139.3] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.941 | L2-Norm(final)=10.257 | 4297.4 samples/s | 67.1 steps/s
[Step=36400 Epoch=139.5] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.936 | L2-Norm(final)=10.265 | 4268.8 samples/s | 66.7 steps/s
[Step=36450 Epoch=139.7] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.932 | L2-Norm(final)=10.273 | 4315.2 samples/s | 67.4 steps/s
[Step=36500 Epoch=139.9] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.928 | L2-Norm(final)=10.280 | 4782.2 samples/s | 74.7 steps/s
[Step=36550 Epoch=140.0] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.924 | L2-Norm(final)=10.288 | 1979.7 samples/s | 30.9 steps/s
[Step=36600 Epoch=140.2] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.920 | L2-Norm(final)=10.297 | 4314.8 samples/s | 67.4 steps/s
[Step=36650 Epoch=140.4] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.919 | L2-Norm(final)=10.306 | 4235.0 samples/s | 66.2 steps/s
[Step=36700 Epoch=140.6] | Loss=0.00001 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.919 | L2-Norm(final)=10.315 | 4361.2 samples/s | 68.1 steps/s
[Step=36750 Epoch=140.8] | Loss=0.00001 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.920 | L2-Norm(final)=10.324 | 4557.1 samples/s | 71.2 steps/s
[Step=36800 Epoch=141.0] | Loss=0.00001 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.921 | L2-Norm(final)=10.332 | 2011.0 samples/s | 31.4 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step36800.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00006, len=1
[Step=36001 Epoch=138.6] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.124 | L2-Norm(final)=6.113 | 3975.7 samples/s | 62.1 steps/s
[Step=36050 Epoch=138.8] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.119 | L2-Norm(final)=6.117 | 4177.6 samples/s | 65.3 steps/s
[Step=36100 Epoch=139.0] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.113 | L2-Norm(final)=6.122 | 4411.3 samples/s | 68.9 steps/s
[Step=36150 Epoch=139.2] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.106 | L2-Norm(final)=6.126 | 4085.7 samples/s | 63.8 steps/s
[Step=36200 Epoch=139.3] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.100 | L2-Norm(final)=6.131 | 4277.0 samples/s | 66.8 steps/s
[Step=36250 Epoch=139.5] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.094 | L2-Norm(final)=6.135 | 5490.0 samples/s | 85.8 steps/s
[Step=36300 Epoch=139.7] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.088 | L2-Norm(final)=6.140 | 1833.1 samples/s | 28.6 steps/s
[Step=36350 Epoch=139.9] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.083 | L2-Norm(final)=6.145 | 4373.6 samples/s | 68.3 steps/s
[Step=36400 Epoch=140.1] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.077 | L2-Norm(final)=6.150 | 4213.1 samples/s | 65.8 steps/s
[Step=36450 Epoch=140.3] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.071 | L2-Norm(final)=6.155 | 4303.5 samples/s | 67.2 steps/s
[Step=36500 Epoch=140.5] | Loss=0.00000 | Reg=0.00017 | acc=1.0000 | L2-Norm=4.065 | L2-Norm(final)=6.160 | 4594.1 samples/s | 71.8 steps/s
[Step=36550 Epoch=140.7] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.059 | L2-Norm(final)=6.165 | 1870.0 samples/s | 29.2 steps/s
[Step=36600 Epoch=140.9] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.053 | L2-Norm(final)=6.171 | 4275.9 samples/s | 66.8 steps/s
[Step=36650 Epoch=141.1] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.049 | L2-Norm(final)=6.177 | 4299.2 samples/s | 67.2 steps/s
[Step=36700 Epoch=141.3] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.045 | L2-Norm(final)=6.183 | 4207.1 samples/s | 65.7 steps/s
[Step=36750 Epoch=141.5] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.040 | L2-Norm(final)=6.188 | 4410.7 samples/s | 68.9 steps/s
[Step=36800 Epoch=141.7] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=4.035 | L2-Norm(final)=6.194 | 2021.4 samples/s | 31.6 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step36800.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.23737 | acc=0.9583 | tpr=0.9736 | fpr=0.0751 | 4101.4 samples/s | 16.0 steps/s
Avg test loss: 0.24144, Avg test acc: 0.95749, Avg tpr: 0.97266, Avg fpr: 0.07589, total FA: 592

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.19765 | acc=0.9595 | tpr=0.9690 | fpr=0.0612 | 3973.3 samples/s | 15.5 steps/s
Avg test loss: 0.20671, Avg test acc: 0.95781, Avg tpr: 0.96841, Avg fpr: 0.06550, total FA: 511

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.47971 | acc=0.3163 | tpr=0.0018 | fpr=0.0007 | 4006.2 samples/s | 15.6 steps/s
Avg test loss: 5.50738, Avg test acc: 0.31361, Avg tpr: 0.00204, Avg fpr: 0.00115, total FA: 9

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.81590 | acc=0.3144 | tpr=0.0014 | fpr=0.0059 | 4071.3 samples/s | 15.9 steps/s
Avg test loss: 5.84242, Avg test acc: 0.31212, Avg tpr: 0.00146, Avg fpr: 0.00461, total FA: 36

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.91061 | acc=0.1636 | tpr=0.7965 | fpr=0.8478 | 3933.5 samples/s | 15.4 steps/s
[Step= 100] | Loss=8.87679 | acc=0.1623 | tpr=0.7569 | fpr=0.8488 | 6945.5 samples/s | 27.1 steps/s
[Step= 150] | Loss=8.93901 | acc=0.1605 | tpr=0.7651 | fpr=0.8506 | 7530.7 samples/s | 29.4 steps/s
[Step= 200] | Loss=8.93189 | acc=0.1596 | tpr=0.7596 | fpr=0.8513 | 7474.5 samples/s | 29.2 steps/s
[Step= 250] | Loss=8.94832 | acc=0.1598 | tpr=0.7642 | fpr=0.8512 | 5072.8 samples/s | 19.8 steps/s
[Step= 300] | Loss=8.95768 | acc=0.1593 | tpr=0.7644 | fpr=0.8518 | 7028.8 samples/s | 27.5 steps/s
[Step= 350] | Loss=8.95304 | acc=0.1597 | tpr=0.7658 | fpr=0.8513 | 7411.6 samples/s | 29.0 steps/s
[Step= 400] | Loss=8.95371 | acc=0.1600 | tpr=0.7642 | fpr=0.8510 | 7238.1 samples/s | 28.3 steps/s
[Step= 450] | Loss=8.95384 | acc=0.1597 | tpr=0.7668 | fpr=0.8513 | 7926.2 samples/s | 31.0 steps/s
[Step= 500] | Loss=8.96566 | acc=0.1593 | tpr=0.7626 | fpr=0.8516 | 7393.1 samples/s | 28.9 steps/s
[Step= 550] | Loss=8.96643 | acc=0.1595 | tpr=0.7636 | fpr=0.8515 | 13523.9 samples/s | 52.8 steps/s
Avg test loss: 8.96933, Avg test acc: 0.15937, Avg tpr: 0.76347, Avg fpr: 0.85161, total FA: 118244

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=8.85080 | acc=0.1684 | tpr=0.7434 | fpr=0.8420 | 3649.2 samples/s | 14.3 steps/s
[Step= 100] | Loss=8.80580 | acc=0.1671 | tpr=0.7228 | fpr=0.8433 | 8377.5 samples/s | 32.7 steps/s
[Step= 150] | Loss=8.81535 | acc=0.1679 | tpr=0.7075 | fpr=0.8420 | 7378.9 samples/s | 28.8 steps/s
[Step= 200] | Loss=8.78630 | acc=0.1687 | tpr=0.7104 | fpr=0.8412 | 8284.3 samples/s | 32.4 steps/s
[Step= 250] | Loss=8.78235 | acc=0.1692 | tpr=0.7066 | fpr=0.8406 | 5267.7 samples/s | 20.6 steps/s
[Step= 300] | Loss=8.78433 | acc=0.1691 | tpr=0.7040 | fpr=0.8406 | 7923.8 samples/s | 31.0 steps/s
[Step= 350] | Loss=8.78225 | acc=0.1686 | tpr=0.7007 | fpr=0.8411 | 8033.4 samples/s | 31.4 steps/s
[Step= 400] | Loss=8.77484 | acc=0.1688 | tpr=0.7084 | fpr=0.8410 | 7562.1 samples/s | 29.5 steps/s
[Step= 450] | Loss=8.78764 | acc=0.1686 | tpr=0.7064 | fpr=0.8412 | 7465.4 samples/s | 29.2 steps/s
[Step= 500] | Loss=8.80451 | acc=0.1680 | tpr=0.7079 | fpr=0.8418 | 7883.4 samples/s | 30.8 steps/s
[Step= 550] | Loss=8.80438 | acc=0.1678 | tpr=0.7012 | fpr=0.8419 | 14825.7 samples/s | 57.9 steps/s
Avg test loss: 8.80696, Avg test acc: 0.16769, Avg tpr: 0.70127, Avg fpr: 0.84201, total FA: 116911

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08765 | acc=0.9821 | tpr=0.9558 | fpr=0.0174 | 4219.0 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.09050 | acc=0.9822 | tpr=0.9680 | fpr=0.0175 | 7752.6 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.09463 | acc=0.9812 | tpr=0.9683 | fpr=0.0186 | 7664.0 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.09500 | acc=0.9811 | tpr=0.9705 | fpr=0.0187 | 7264.3 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.09409 | acc=0.9812 | tpr=0.9694 | fpr=0.0186 | 4810.1 samples/s | 18.8 steps/s
[Step= 300] | Loss=0.09517 | acc=0.9812 | tpr=0.9673 | fpr=0.0186 | 7655.0 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.09534 | acc=0.9811 | tpr=0.9662 | fpr=0.0187 | 7894.2 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.09640 | acc=0.9808 | tpr=0.9617 | fpr=0.0189 | 7580.6 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.09768 | acc=0.9805 | tpr=0.9611 | fpr=0.0191 | 7945.7 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.09754 | acc=0.9807 | tpr=0.9621 | fpr=0.0190 | 7487.1 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.09703 | acc=0.9809 | tpr=0.9622 | fpr=0.0188 | 14024.8 samples/s | 54.8 steps/s
Avg test loss: 0.09688, Avg test acc: 0.98087, Avg tpr: 0.96236, Avg fpr: 0.01880, total FA: 2610

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14440 | acc=0.9771 | tpr=0.9513 | fpr=0.0224 | 4257.7 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.15394 | acc=0.9763 | tpr=0.9680 | fpr=0.0236 | 7169.6 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.15936 | acc=0.9754 | tpr=0.9683 | fpr=0.0245 | 7620.5 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.16034 | acc=0.9755 | tpr=0.9716 | fpr=0.0244 | 4669.6 samples/s | 18.2 steps/s
[Step= 250] | Loss=0.15912 | acc=0.9755 | tpr=0.9721 | fpr=0.0245 | 7400.1 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.16195 | acc=0.9754 | tpr=0.9724 | fpr=0.0245 | 7391.3 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.16196 | acc=0.9754 | tpr=0.9718 | fpr=0.0245 | 7769.4 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.16340 | acc=0.9751 | tpr=0.9694 | fpr=0.0247 | 7074.6 samples/s | 27.6 steps/s
[Step= 450] | Loss=0.16634 | acc=0.9748 | tpr=0.9688 | fpr=0.0251 | 7584.8 samples/s | 29.6 steps/s
[Step= 500] | Loss=0.16552 | acc=0.9748 | tpr=0.9687 | fpr=0.0251 | 7258.6 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.16424 | acc=0.9750 | tpr=0.9690 | fpr=0.0249 | 14040.1 samples/s | 54.8 steps/s
Avg test loss: 0.16393, Avg test acc: 0.97501, Avg tpr: 0.96870, Avg fpr: 0.02488, total FA: 3454

server round 46/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00006, len=1
[Step=36801 Epoch=71.8] | Loss=0.00002 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.482 | L2-Norm(final)=2.854 | 4134.7 samples/s | 64.6 steps/s
[Step=36850 Epoch=71.9] | Loss=0.00342 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.480 | L2-Norm(final)=2.854 | 3898.9 samples/s | 60.9 steps/s
[Step=36900 Epoch=72.0] | Loss=0.00293 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.478 | L2-Norm(final)=2.855 | 4406.1 samples/s | 68.8 steps/s
[Step=36950 Epoch=72.1] | Loss=0.00269 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.476 | L2-Norm(final)=2.855 | 4447.4 samples/s | 69.5 steps/s
[Step=37000 Epoch=72.2] | Loss=0.00259 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.475 | L2-Norm(final)=2.856 | 4434.3 samples/s | 69.3 steps/s
[Step=37050 Epoch=72.3] | Loss=0.00270 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.472 | L2-Norm(final)=2.856 | 4466.5 samples/s | 69.8 steps/s
[Step=37100 Epoch=72.4] | Loss=0.00251 | Reg=0.00305 | acc=0.9844 | L2-Norm=17.470 | L2-Norm(final)=2.856 | 4502.8 samples/s | 70.4 steps/s
[Step=37150 Epoch=72.5] | Loss=0.00254 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.469 | L2-Norm(final)=2.856 | 4384.0 samples/s | 68.5 steps/s
[Step=37200 Epoch=72.6] | Loss=0.00248 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.467 | L2-Norm(final)=2.857 | 4454.8 samples/s | 69.6 steps/s
[Step=37250 Epoch=72.7] | Loss=0.00243 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.465 | L2-Norm(final)=2.857 | 4368.2 samples/s | 68.3 steps/s
[Step=37300 Epoch=72.7] | Loss=0.00242 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.464 | L2-Norm(final)=2.858 | 5191.9 samples/s | 81.1 steps/s
[Step=37350 Epoch=72.8] | Loss=0.00243 | Reg=0.00305 | acc=0.9844 | L2-Norm=17.462 | L2-Norm(final)=2.858 | 1806.5 samples/s | 28.2 steps/s
[Step=37400 Epoch=72.9] | Loss=0.00249 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.460 | L2-Norm(final)=2.859 | 4421.1 samples/s | 69.1 steps/s
[Step=37450 Epoch=73.0] | Loss=0.00243 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.459 | L2-Norm(final)=2.859 | 4490.2 samples/s | 70.2 steps/s
[Step=37500 Epoch=73.1] | Loss=0.00243 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.457 | L2-Norm(final)=2.860 | 4423.9 samples/s | 69.1 steps/s
[Step=37550 Epoch=73.2] | Loss=0.00250 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.455 | L2-Norm(final)=2.860 | 4441.0 samples/s | 69.4 steps/s
[Step=37600 Epoch=73.3] | Loss=0.00250 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.454 | L2-Norm(final)=2.860 | 4640.9 samples/s | 72.5 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step37600.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00006, len=1
[Step=36801 Epoch=71.9] | Loss=0.00237 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.267 | L2-Norm(final)=2.701 | 4188.1 samples/s | 65.4 steps/s
[Step=36850 Epoch=72.0] | Loss=0.00086 | Reg=0.00298 | acc=0.9844 | L2-Norm=17.265 | L2-Norm(final)=2.702 | 4430.3 samples/s | 69.2 steps/s
[Step=36900 Epoch=72.1] | Loss=0.00159 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.264 | L2-Norm(final)=2.703 | 4624.9 samples/s | 72.3 steps/s
[Step=36950 Epoch=72.2] | Loss=0.00192 | Reg=0.00298 | acc=0.9844 | L2-Norm=17.262 | L2-Norm(final)=2.704 | 4587.5 samples/s | 71.7 steps/s
[Step=37000 Epoch=72.3] | Loss=0.00191 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.260 | L2-Norm(final)=2.705 | 4539.5 samples/s | 70.9 steps/s
[Step=37050 Epoch=72.4] | Loss=0.00195 | Reg=0.00298 | acc=0.9844 | L2-Norm=17.258 | L2-Norm(final)=2.706 | 4560.6 samples/s | 71.3 steps/s
[Step=37100 Epoch=72.5] | Loss=0.00190 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.256 | L2-Norm(final)=2.706 | 4661.4 samples/s | 72.8 steps/s
[Step=37150 Epoch=72.6] | Loss=0.00202 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.254 | L2-Norm(final)=2.707 | 4671.6 samples/s | 73.0 steps/s
[Step=37200 Epoch=72.7] | Loss=0.00198 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.252 | L2-Norm(final)=2.707 | 4537.8 samples/s | 70.9 steps/s
[Step=37250 Epoch=72.8] | Loss=0.00216 | Reg=0.00298 | acc=0.9844 | L2-Norm=17.250 | L2-Norm(final)=2.708 | 4638.2 samples/s | 72.5 steps/s
[Step=37300 Epoch=72.9] | Loss=0.00208 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.248 | L2-Norm(final)=2.708 | 5644.4 samples/s | 88.2 steps/s
[Step=37350 Epoch=73.0] | Loss=0.00206 | Reg=0.00297 | acc=0.9844 | L2-Norm=17.246 | L2-Norm(final)=2.709 | 1955.6 samples/s | 30.6 steps/s
[Step=37400 Epoch=73.1] | Loss=0.00209 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.244 | L2-Norm(final)=2.710 | 4612.0 samples/s | 72.1 steps/s
[Step=37450 Epoch=73.2] | Loss=0.00211 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.242 | L2-Norm(final)=2.710 | 4562.5 samples/s | 71.3 steps/s
[Step=37500 Epoch=73.3] | Loss=0.00210 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.240 | L2-Norm(final)=2.711 | 4570.8 samples/s | 71.4 steps/s
[Step=37550 Epoch=73.4] | Loss=0.00210 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.238 | L2-Norm(final)=2.712 | 4530.8 samples/s | 70.8 steps/s
[Step=37600 Epoch=73.5] | Loss=0.00213 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.236 | L2-Norm(final)=2.712 | 4651.7 samples/s | 72.7 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step37600.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00006, len=1
[Step=36801 Epoch=141.0] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.933 | L2-Norm(final)=10.453 | 4000.5 samples/s | 62.5 steps/s
[Step=36850 Epoch=141.2] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.932 | L2-Norm(final)=10.454 | 4206.2 samples/s | 65.7 steps/s
[Step=36900 Epoch=141.4] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.931 | L2-Norm(final)=10.455 | 4317.9 samples/s | 67.5 steps/s
[Step=36950 Epoch=141.6] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.930 | L2-Norm(final)=10.455 | 4336.3 samples/s | 67.8 steps/s
[Step=37000 Epoch=141.8] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.929 | L2-Norm(final)=10.456 | 4432.2 samples/s | 69.3 steps/s
[Step=37050 Epoch=142.0] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.928 | L2-Norm(final)=10.457 | 5511.3 samples/s | 86.1 steps/s
[Step=37100 Epoch=142.2] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.927 | L2-Norm(final)=10.458 | 1849.4 samples/s | 28.9 steps/s
[Step=37150 Epoch=142.3] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.926 | L2-Norm(final)=10.459 | 4330.3 samples/s | 67.7 steps/s
[Step=37200 Epoch=142.5] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.925 | L2-Norm(final)=10.460 | 4413.5 samples/s | 69.0 steps/s
[Step=37250 Epoch=142.7] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.924 | L2-Norm(final)=10.461 | 4343.4 samples/s | 67.9 steps/s
[Step=37300 Epoch=142.9] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.923 | L2-Norm(final)=10.461 | 4859.0 samples/s | 75.9 steps/s
[Step=37350 Epoch=143.1] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.922 | L2-Norm(final)=10.462 | 1954.1 samples/s | 30.5 steps/s
[Step=37400 Epoch=143.3] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.921 | L2-Norm(final)=10.463 | 4221.8 samples/s | 66.0 steps/s
[Step=37450 Epoch=143.5] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.920 | L2-Norm(final)=10.463 | 4378.1 samples/s | 68.4 steps/s
[Step=37500 Epoch=143.7] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.919 | L2-Norm(final)=10.464 | 4413.5 samples/s | 69.0 steps/s
[Step=37550 Epoch=143.9] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.918 | L2-Norm(final)=10.465 | 4406.5 samples/s | 68.9 steps/s
[Step=37600 Epoch=144.1] | Loss=0.00000 | Reg=0.00009 | acc=1.0000 | L2-Norm=2.916 | L2-Norm(final)=10.465 | 2036.4 samples/s | 31.8 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step37600.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00006, len=1
[Step=36801 Epoch=141.7] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.957 | L2-Norm(final)=6.275 | 4082.4 samples/s | 63.8 steps/s
[Step=36850 Epoch=141.9] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.950 | L2-Norm(final)=6.278 | 3952.6 samples/s | 61.8 steps/s
[Step=36900 Epoch=142.0] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.945 | L2-Norm(final)=6.282 | 4259.0 samples/s | 66.5 steps/s
[Step=36950 Epoch=142.2] | Loss=0.00017 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.942 | L2-Norm(final)=6.288 | 4409.8 samples/s | 68.9 steps/s
[Step=37000 Epoch=142.4] | Loss=0.00021 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.943 | L2-Norm(final)=6.292 | 4219.3 samples/s | 65.9 steps/s
[Step=37050 Epoch=142.6] | Loss=0.00019 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.945 | L2-Norm(final)=6.295 | 5401.6 samples/s | 84.4 steps/s
[Step=37100 Epoch=142.8] | Loss=0.00016 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.947 | L2-Norm(final)=6.296 | 1810.5 samples/s | 28.3 steps/s
[Step=37150 Epoch=143.0] | Loss=0.00014 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.948 | L2-Norm(final)=6.298 | 4202.2 samples/s | 65.7 steps/s
[Step=37200 Epoch=143.2] | Loss=0.00012 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.949 | L2-Norm(final)=6.299 | 4238.0 samples/s | 66.2 steps/s
[Step=37250 Epoch=143.4] | Loss=0.00011 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.950 | L2-Norm(final)=6.300 | 4214.6 samples/s | 65.9 steps/s
[Step=37300 Epoch=143.6] | Loss=0.00010 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.950 | L2-Norm(final)=6.300 | 4789.7 samples/s | 74.8 steps/s
[Step=37350 Epoch=143.8] | Loss=0.00009 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.951 | L2-Norm(final)=6.301 | 1918.5 samples/s | 30.0 steps/s
[Step=37400 Epoch=144.0] | Loss=0.00008 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.951 | L2-Norm(final)=6.302 | 4292.1 samples/s | 67.1 steps/s
[Step=37450 Epoch=144.2] | Loss=0.00008 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.952 | L2-Norm(final)=6.302 | 4387.4 samples/s | 68.6 steps/s
[Step=37500 Epoch=144.4] | Loss=0.00007 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.952 | L2-Norm(final)=6.302 | 4369.0 samples/s | 68.3 steps/s
[Step=37550 Epoch=144.5] | Loss=0.00007 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.952 | L2-Norm(final)=6.303 | 4389.1 samples/s | 68.6 steps/s
[Step=37600 Epoch=144.7] | Loss=0.00006 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.952 | L2-Norm(final)=6.303 | 2020.7 samples/s | 31.6 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step37600.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.22890 | acc=0.9585 | tpr=0.9722 | fpr=0.0711 | 2984.5 samples/s | 11.7 steps/s
Avg test loss: 0.23416, Avg test acc: 0.95729, Avg tpr: 0.97092, Avg fpr: 0.07268, total FA: 567

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.19942 | acc=0.9594 | tpr=0.9701 | fpr=0.0639 | 4107.9 samples/s | 16.0 steps/s
Avg test loss: 0.20875, Avg test acc: 0.95797, Avg tpr: 0.96992, Avg fpr: 0.06832, total FA: 533

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.34941 | acc=0.3162 | tpr=0.0016 | fpr=0.0005 | 4008.8 samples/s | 15.7 steps/s
Avg test loss: 5.37647, Avg test acc: 0.31329, Avg tpr: 0.00146, Avg fpr: 0.00090, total FA: 7

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.79850 | acc=0.3149 | tpr=0.0013 | fpr=0.0040 | 4014.7 samples/s | 15.7 steps/s
Avg test loss: 5.82489, Avg test acc: 0.31244, Avg tpr: 0.00140, Avg fpr: 0.00346, total FA: 27

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.53838 | acc=0.1675 | tpr=0.7965 | fpr=0.8438 | 4068.0 samples/s | 15.9 steps/s
[Step= 100] | Loss=8.50617 | acc=0.1671 | tpr=0.7441 | fpr=0.8436 | 7429.1 samples/s | 29.0 steps/s
[Step= 150] | Loss=8.56527 | acc=0.1661 | tpr=0.7536 | fpr=0.8447 | 7494.8 samples/s | 29.3 steps/s
[Step= 200] | Loss=8.55882 | acc=0.1652 | tpr=0.7464 | fpr=0.8454 | 7571.0 samples/s | 29.6 steps/s
[Step= 250] | Loss=8.57701 | acc=0.1654 | tpr=0.7502 | fpr=0.8453 | 7496.9 samples/s | 29.3 steps/s
[Step= 300] | Loss=8.58617 | acc=0.1646 | tpr=0.7527 | fpr=0.8462 | 7269.0 samples/s | 28.4 steps/s
[Step= 350] | Loss=8.58226 | acc=0.1647 | tpr=0.7533 | fpr=0.8460 | 7496.9 samples/s | 29.3 steps/s
[Step= 400] | Loss=8.58187 | acc=0.1649 | tpr=0.7527 | fpr=0.8458 | 7808.7 samples/s | 30.5 steps/s
[Step= 450] | Loss=8.58105 | acc=0.1646 | tpr=0.7561 | fpr=0.8462 | 7864.8 samples/s | 30.7 steps/s
[Step= 500] | Loss=8.59206 | acc=0.1642 | tpr=0.7515 | fpr=0.8464 | 7708.7 samples/s | 30.1 steps/s
[Step= 550] | Loss=8.59275 | acc=0.1642 | tpr=0.7521 | fpr=0.8465 | 14155.8 samples/s | 55.3 steps/s
Avg test loss: 8.59557, Avg test acc: 0.16406, Avg tpr: 0.75198, Avg fpr: 0.84662, total FA: 117552

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=8.99732 | acc=0.1636 | tpr=0.7434 | fpr=0.8468 | 4213.9 samples/s | 16.5 steps/s
[Step= 100] | Loss=8.95408 | acc=0.1625 | tpr=0.7249 | fpr=0.8480 | 7494.7 samples/s | 29.3 steps/s
[Step= 150] | Loss=8.96272 | acc=0.1632 | tpr=0.7118 | fpr=0.8469 | 7982.6 samples/s | 31.2 steps/s
[Step= 200] | Loss=8.93375 | acc=0.1639 | tpr=0.7148 | fpr=0.8461 | 7723.3 samples/s | 30.2 steps/s
[Step= 250] | Loss=8.93007 | acc=0.1646 | tpr=0.7118 | fpr=0.8454 | 7958.7 samples/s | 31.1 steps/s
[Step= 300] | Loss=8.93151 | acc=0.1644 | tpr=0.7084 | fpr=0.8455 | 7986.9 samples/s | 31.2 steps/s
[Step= 350] | Loss=8.92937 | acc=0.1640 | tpr=0.7038 | fpr=0.8458 | 7600.0 samples/s | 29.7 steps/s
[Step= 400] | Loss=8.92198 | acc=0.1643 | tpr=0.7133 | fpr=0.8457 | 7605.4 samples/s | 29.7 steps/s
[Step= 450] | Loss=8.93484 | acc=0.1641 | tpr=0.7118 | fpr=0.8458 | 8115.1 samples/s | 31.7 steps/s
[Step= 500] | Loss=8.95203 | acc=0.1635 | tpr=0.7145 | fpr=0.8465 | 7708.2 samples/s | 30.1 steps/s
[Step= 550] | Loss=8.95183 | acc=0.1634 | tpr=0.7055 | fpr=0.8465 | 13864.9 samples/s | 54.2 steps/s
Avg test loss: 8.95443, Avg test acc: 0.16324, Avg tpr: 0.70563, Avg fpr: 0.84662, total FA: 117552

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08621 | acc=0.9823 | tpr=0.9558 | fpr=0.0173 | 4394.1 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.08955 | acc=0.9820 | tpr=0.9638 | fpr=0.0177 | 7116.3 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.09367 | acc=0.9812 | tpr=0.9654 | fpr=0.0185 | 7815.5 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.09418 | acc=0.9811 | tpr=0.9694 | fpr=0.0187 | 7743.0 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.09309 | acc=0.9812 | tpr=0.9686 | fpr=0.0186 | 7629.9 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.09413 | acc=0.9810 | tpr=0.9658 | fpr=0.0187 | 7363.4 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.09423 | acc=0.9810 | tpr=0.9649 | fpr=0.0187 | 8112.0 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.09529 | acc=0.9807 | tpr=0.9606 | fpr=0.0190 | 7469.5 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.09651 | acc=0.9804 | tpr=0.9601 | fpr=0.0192 | 7664.7 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.09641 | acc=0.9805 | tpr=0.9612 | fpr=0.0191 | 7605.0 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.09588 | acc=0.9807 | tpr=0.9618 | fpr=0.0190 | 13768.4 samples/s | 53.8 steps/s
Avg test loss: 0.09572, Avg test acc: 0.98071, Avg tpr: 0.96197, Avg fpr: 0.01895, total FA: 2631

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14403 | acc=0.9789 | tpr=0.9513 | fpr=0.0206 | 3906.0 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.15304 | acc=0.9780 | tpr=0.9680 | fpr=0.0218 | 7592.1 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.15870 | acc=0.9771 | tpr=0.9683 | fpr=0.0228 | 7340.1 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.16041 | acc=0.9769 | tpr=0.9705 | fpr=0.0229 | 7392.3 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.15907 | acc=0.9769 | tpr=0.9703 | fpr=0.0230 | 7514.5 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.16190 | acc=0.9768 | tpr=0.9702 | fpr=0.0231 | 7641.1 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.16192 | acc=0.9768 | tpr=0.9693 | fpr=0.0230 | 7736.6 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.16324 | acc=0.9766 | tpr=0.9677 | fpr=0.0232 | 7538.2 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.16634 | acc=0.9761 | tpr=0.9674 | fpr=0.0237 | 7215.2 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.16545 | acc=0.9762 | tpr=0.9670 | fpr=0.0236 | 7369.9 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.16424 | acc=0.9765 | tpr=0.9674 | fpr=0.0234 | 14393.9 samples/s | 56.2 steps/s
Avg test loss: 0.16395, Avg test acc: 0.97649, Avg tpr: 0.96712, Avg fpr: 0.02333, total FA: 3240

server round 47/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00006, len=1
[Step=37601 Epoch=73.3] | Loss=0.00005 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.426 | L2-Norm(final)=2.862 | 4338.2 samples/s | 67.8 steps/s
[Step=37650 Epoch=73.4] | Loss=0.00162 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.425 | L2-Norm(final)=2.862 | 4058.0 samples/s | 63.4 steps/s
[Step=37700 Epoch=73.5] | Loss=0.00181 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.423 | L2-Norm(final)=2.863 | 4421.0 samples/s | 69.1 steps/s
[Step=37750 Epoch=73.6] | Loss=0.00214 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.422 | L2-Norm(final)=2.864 | 4358.4 samples/s | 68.1 steps/s
[Step=37800 Epoch=73.7] | Loss=0.00248 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.420 | L2-Norm(final)=2.865 | 4492.8 samples/s | 70.2 steps/s
[Step=37850 Epoch=73.8] | Loss=0.00237 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.419 | L2-Norm(final)=2.865 | 4471.5 samples/s | 69.9 steps/s
[Step=37900 Epoch=73.9] | Loss=0.00225 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.417 | L2-Norm(final)=2.866 | 4526.6 samples/s | 70.7 steps/s
[Step=37950 Epoch=74.0] | Loss=0.00239 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.415 | L2-Norm(final)=2.866 | 4515.8 samples/s | 70.6 steps/s
[Step=38000 Epoch=74.1] | Loss=0.00238 | Reg=0.00303 | acc=0.9844 | L2-Norm=17.413 | L2-Norm(final)=2.866 | 4418.7 samples/s | 69.0 steps/s
[Step=38050 Epoch=74.2] | Loss=0.00239 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.412 | L2-Norm(final)=2.867 | 4432.0 samples/s | 69.3 steps/s
[Step=38100 Epoch=74.3] | Loss=0.00236 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.410 | L2-Norm(final)=2.867 | 5379.2 samples/s | 84.0 steps/s
[Step=38150 Epoch=74.4] | Loss=0.00242 | Reg=0.00303 | acc=0.9844 | L2-Norm=17.408 | L2-Norm(final)=2.868 | 1860.5 samples/s | 29.1 steps/s
[Step=38200 Epoch=74.5] | Loss=0.00232 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.407 | L2-Norm(final)=2.868 | 4358.3 samples/s | 68.1 steps/s
[Step=38250 Epoch=74.6] | Loss=0.00233 | Reg=0.00303 | acc=0.9844 | L2-Norm=17.405 | L2-Norm(final)=2.869 | 4457.5 samples/s | 69.6 steps/s
[Step=38300 Epoch=74.7] | Loss=0.00236 | Reg=0.00303 | acc=0.9844 | L2-Norm=17.404 | L2-Norm(final)=2.869 | 4392.5 samples/s | 68.6 steps/s
[Step=38350 Epoch=74.8] | Loss=0.00239 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.402 | L2-Norm(final)=2.870 | 4481.1 samples/s | 70.0 steps/s
[Step=38400 Epoch=74.9] | Loss=0.00245 | Reg=0.00303 | acc=0.9844 | L2-Norm=17.401 | L2-Norm(final)=2.870 | 4404.5 samples/s | 68.8 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step38400.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00006, len=1
[Step=37601 Epoch=73.5] | Loss=0.00290 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.206 | L2-Norm(final)=2.721 | 4287.7 samples/s | 67.0 steps/s
[Step=37650 Epoch=73.6] | Loss=0.00201 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.204 | L2-Norm(final)=2.722 | 4191.9 samples/s | 65.5 steps/s
[Step=37700 Epoch=73.7] | Loss=0.00250 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.202 | L2-Norm(final)=2.721 | 4563.6 samples/s | 71.3 steps/s
[Step=37750 Epoch=73.8] | Loss=0.00248 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.200 | L2-Norm(final)=2.721 | 4621.7 samples/s | 72.2 steps/s
[Step=37800 Epoch=73.9] | Loss=0.00233 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.198 | L2-Norm(final)=2.722 | 4635.0 samples/s | 72.4 steps/s
[Step=37850 Epoch=74.0] | Loss=0.00226 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.196 | L2-Norm(final)=2.722 | 4572.8 samples/s | 71.5 steps/s
[Step=37900 Epoch=74.1] | Loss=0.00221 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.195 | L2-Norm(final)=2.723 | 4570.5 samples/s | 71.4 steps/s
[Step=37950 Epoch=74.2] | Loss=0.00221 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.193 | L2-Norm(final)=2.724 | 4548.1 samples/s | 71.1 steps/s
[Step=38000 Epoch=74.3] | Loss=0.00209 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.191 | L2-Norm(final)=2.724 | 4614.5 samples/s | 72.1 steps/s
[Step=38050 Epoch=74.4] | Loss=0.00202 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.189 | L2-Norm(final)=2.725 | 4671.7 samples/s | 73.0 steps/s
[Step=38100 Epoch=74.5] | Loss=0.00207 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.187 | L2-Norm(final)=2.726 | 5747.3 samples/s | 89.8 steps/s
[Step=38150 Epoch=74.6] | Loss=0.00215 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.185 | L2-Norm(final)=2.726 | 1910.7 samples/s | 29.9 steps/s
[Step=38200 Epoch=74.7] | Loss=0.00208 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.183 | L2-Norm(final)=2.727 | 4587.3 samples/s | 71.7 steps/s
[Step=38250 Epoch=74.8] | Loss=0.00205 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.182 | L2-Norm(final)=2.727 | 4590.4 samples/s | 71.7 steps/s
[Step=38300 Epoch=74.9] | Loss=0.00206 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.180 | L2-Norm(final)=2.728 | 4620.0 samples/s | 72.2 steps/s
[Step=38350 Epoch=75.0] | Loss=0.00198 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.178 | L2-Norm(final)=2.728 | 4561.4 samples/s | 71.3 steps/s
[Step=38400 Epoch=75.1] | Loss=0.00200 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.176 | L2-Norm(final)=2.729 | 4532.5 samples/s | 70.8 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step38400.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00006, len=1
[Step=37601 Epoch=144.1] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.898 | L2-Norm(final)=10.477 | 4041.3 samples/s | 63.1 steps/s
[Step=37650 Epoch=144.3] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.897 | L2-Norm(final)=10.478 | 4413.6 samples/s | 69.0 steps/s
[Step=37700 Epoch=144.5] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.895 | L2-Norm(final)=10.479 | 4422.7 samples/s | 69.1 steps/s
[Step=37750 Epoch=144.6] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.894 | L2-Norm(final)=10.480 | 4374.2 samples/s | 68.3 steps/s
[Step=37800 Epoch=144.8] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.893 | L2-Norm(final)=10.481 | 4375.3 samples/s | 68.4 steps/s
[Step=37850 Epoch=145.0] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.891 | L2-Norm(final)=10.482 | 5410.3 samples/s | 84.5 steps/s
[Step=37900 Epoch=145.2] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.890 | L2-Norm(final)=10.482 | 1882.0 samples/s | 29.4 steps/s
[Step=37950 Epoch=145.4] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.889 | L2-Norm(final)=10.484 | 4349.4 samples/s | 68.0 steps/s
[Step=38000 Epoch=145.6] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.888 | L2-Norm(final)=10.485 | 4362.6 samples/s | 68.2 steps/s
[Step=38050 Epoch=145.8] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.886 | L2-Norm(final)=10.486 | 4296.4 samples/s | 67.1 steps/s
[Step=38100 Epoch=146.0] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.885 | L2-Norm(final)=10.487 | 4819.2 samples/s | 75.3 steps/s
[Step=38150 Epoch=146.2] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.884 | L2-Norm(final)=10.488 | 1984.1 samples/s | 31.0 steps/s
[Step=38200 Epoch=146.4] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.882 | L2-Norm(final)=10.489 | 4310.5 samples/s | 67.4 steps/s
[Step=38250 Epoch=146.6] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.881 | L2-Norm(final)=10.490 | 4358.3 samples/s | 68.1 steps/s
[Step=38300 Epoch=146.8] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.880 | L2-Norm(final)=10.491 | 4437.5 samples/s | 69.3 steps/s
[Step=38350 Epoch=146.9] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.878 | L2-Norm(final)=10.492 | 4298.0 samples/s | 67.2 steps/s
[Step=38400 Epoch=147.1] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.877 | L2-Norm(final)=10.494 | 1969.2 samples/s | 30.8 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step38400.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00006, len=1
[Step=37601 Epoch=144.7] | Loss=0.00001 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.954 | L2-Norm(final)=6.308 | 3839.9 samples/s | 60.0 steps/s
[Step=37650 Epoch=144.9] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.954 | L2-Norm(final)=6.308 | 4284.5 samples/s | 66.9 steps/s
[Step=37700 Epoch=145.1] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.954 | L2-Norm(final)=6.308 | 4407.6 samples/s | 68.9 steps/s
[Step=37750 Epoch=145.3] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.954 | L2-Norm(final)=6.308 | 4162.2 samples/s | 65.0 steps/s
[Step=37800 Epoch=145.5] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.954 | L2-Norm(final)=6.308 | 4237.3 samples/s | 66.2 steps/s
[Step=37850 Epoch=145.7] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.953 | L2-Norm(final)=6.309 | 5440.7 samples/s | 85.0 steps/s
[Step=37900 Epoch=145.9] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.953 | L2-Norm(final)=6.309 | 1766.7 samples/s | 27.6 steps/s
[Step=37950 Epoch=146.1] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.953 | L2-Norm(final)=6.309 | 4195.5 samples/s | 65.6 steps/s
[Step=38000 Epoch=146.3] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.953 | L2-Norm(final)=6.309 | 4150.9 samples/s | 64.9 steps/s
[Step=38050 Epoch=146.5] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.953 | L2-Norm(final)=6.309 | 4295.2 samples/s | 67.1 steps/s
[Step=38100 Epoch=146.7] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.953 | L2-Norm(final)=6.309 | 4698.3 samples/s | 73.4 steps/s
[Step=38150 Epoch=146.9] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.953 | L2-Norm(final)=6.309 | 1868.3 samples/s | 29.2 steps/s
[Step=38200 Epoch=147.0] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.952 | L2-Norm(final)=6.309 | 4204.9 samples/s | 65.7 steps/s
[Step=38250 Epoch=147.2] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.952 | L2-Norm(final)=6.309 | 4285.4 samples/s | 67.0 steps/s
[Step=38300 Epoch=147.4] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.952 | L2-Norm(final)=6.309 | 4258.7 samples/s | 66.5 steps/s
[Step=38350 Epoch=147.6] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.952 | L2-Norm(final)=6.310 | 4441.3 samples/s | 69.4 steps/s
[Step=38400 Epoch=147.8] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.952 | L2-Norm(final)=6.310 | 2038.8 samples/s | 31.9 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step38400.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.22804 | acc=0.9587 | tpr=0.9716 | fpr=0.0691 | 4177.7 samples/s | 16.3 steps/s
Avg test loss: 0.23366, Avg test acc: 0.95741, Avg tpr: 0.97016, Avg fpr: 0.07063, total FA: 551

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.20652 | acc=0.9595 | tpr=0.9720 | fpr=0.0676 | 4066.0 samples/s | 15.9 steps/s
Avg test loss: 0.21615, Avg test acc: 0.95797, Avg tpr: 0.97162, Avg fpr: 0.07204, total FA: 562

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.18032 | acc=0.3159 | tpr=0.0010 | fpr=0.0005 | 4008.7 samples/s | 15.7 steps/s
Avg test loss: 5.20621, Avg test acc: 0.31301, Avg tpr: 0.00099, Avg fpr: 0.00077, total FA: 6

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.79877 | acc=0.3149 | tpr=0.0013 | fpr=0.0040 | 4024.3 samples/s | 15.7 steps/s
Avg test loss: 5.82520, Avg test acc: 0.31244, Avg tpr: 0.00140, Avg fpr: 0.00346, total FA: 27

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.37181 | acc=0.1738 | tpr=0.7743 | fpr=0.8370 | 4010.2 samples/s | 15.7 steps/s
[Step= 100] | Loss=8.33717 | acc=0.1730 | tpr=0.7377 | fpr=0.8375 | 7415.0 samples/s | 29.0 steps/s
[Step= 150] | Loss=8.39584 | acc=0.1717 | tpr=0.7478 | fpr=0.8389 | 7756.5 samples/s | 30.3 steps/s
[Step= 200] | Loss=8.38948 | acc=0.1709 | tpr=0.7410 | fpr=0.8394 | 7396.1 samples/s | 28.9 steps/s
[Step= 250] | Loss=8.40586 | acc=0.1710 | tpr=0.7441 | fpr=0.8394 | 7496.6 samples/s | 29.3 steps/s
[Step= 300] | Loss=8.41553 | acc=0.1702 | tpr=0.7462 | fpr=0.8403 | 7629.9 samples/s | 29.8 steps/s
[Step= 350] | Loss=8.41089 | acc=0.1706 | tpr=0.7464 | fpr=0.8399 | 7499.6 samples/s | 29.3 steps/s
[Step= 400] | Loss=8.41088 | acc=0.1708 | tpr=0.7451 | fpr=0.8396 | 7205.8 samples/s | 28.1 steps/s
[Step= 450] | Loss=8.41024 | acc=0.1705 | tpr=0.7483 | fpr=0.8400 | 7738.4 samples/s | 30.2 steps/s
[Step= 500] | Loss=8.42153 | acc=0.1701 | tpr=0.7436 | fpr=0.8403 | 7433.9 samples/s | 29.0 steps/s
[Step= 550] | Loss=8.42283 | acc=0.1702 | tpr=0.7449 | fpr=0.8403 | 14275.9 samples/s | 55.8 steps/s
Avg test loss: 8.42548, Avg test acc: 0.17005, Avg tpr: 0.74485, Avg fpr: 0.84040, total FA: 116688

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=9.32539 | acc=0.1590 | tpr=0.7611 | fpr=0.8518 | 4109.1 samples/s | 16.1 steps/s
[Step= 100] | Loss=9.28078 | acc=0.1581 | tpr=0.7420 | fpr=0.8528 | 8398.5 samples/s | 32.8 steps/s
[Step= 150] | Loss=9.29071 | acc=0.1587 | tpr=0.7262 | fpr=0.8517 | 7647.8 samples/s | 29.9 steps/s
[Step= 200] | Loss=9.26089 | acc=0.1597 | tpr=0.7290 | fpr=0.8507 | 7361.1 samples/s | 28.8 steps/s
[Step= 250] | Loss=9.25737 | acc=0.1603 | tpr=0.7258 | fpr=0.8500 | 7799.8 samples/s | 30.5 steps/s
[Step= 300] | Loss=9.25899 | acc=0.1602 | tpr=0.7244 | fpr=0.8501 | 7702.3 samples/s | 30.1 steps/s
[Step= 350] | Loss=9.25685 | acc=0.1599 | tpr=0.7220 | fpr=0.8503 | 8622.5 samples/s | 33.7 steps/s
[Step= 400] | Loss=9.24904 | acc=0.1602 | tpr=0.7303 | fpr=0.8501 | 7301.5 samples/s | 28.5 steps/s
[Step= 450] | Loss=9.26250 | acc=0.1599 | tpr=0.7293 | fpr=0.8504 | 8252.9 samples/s | 32.2 steps/s
[Step= 500] | Loss=9.28054 | acc=0.1594 | tpr=0.7317 | fpr=0.8510 | 7626.1 samples/s | 29.8 steps/s
[Step= 550] | Loss=9.28029 | acc=0.1593 | tpr=0.7242 | fpr=0.8510 | 13734.2 samples/s | 53.6 steps/s
Avg test loss: 9.28300, Avg test acc: 0.15913, Avg tpr: 0.72425, Avg fpr: 0.85115, total FA: 118180

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08477 | acc=0.9817 | tpr=0.9513 | fpr=0.0177 | 4171.6 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.08818 | acc=0.9815 | tpr=0.9616 | fpr=0.0181 | 7893.4 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.09221 | acc=0.9808 | tpr=0.9640 | fpr=0.0189 | 7881.7 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.09281 | acc=0.9807 | tpr=0.9694 | fpr=0.0191 | 7619.9 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.09169 | acc=0.9808 | tpr=0.9686 | fpr=0.0189 | 7794.9 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.09275 | acc=0.9807 | tpr=0.9665 | fpr=0.0191 | 7708.0 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.09282 | acc=0.9806 | tpr=0.9656 | fpr=0.0191 | 7888.7 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.09385 | acc=0.9803 | tpr=0.9617 | fpr=0.0193 | 7337.2 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.09504 | acc=0.9801 | tpr=0.9611 | fpr=0.0196 | 7936.6 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.09497 | acc=0.9802 | tpr=0.9617 | fpr=0.0195 | 7528.1 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.09444 | acc=0.9804 | tpr=0.9622 | fpr=0.0193 | 13461.0 samples/s | 52.6 steps/s
Avg test loss: 0.09427, Avg test acc: 0.98039, Avg tpr: 0.96236, Avg fpr: 0.01929, total FA: 2678

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14302 | acc=0.9788 | tpr=0.9513 | fpr=0.0208 | 4244.7 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.15199 | acc=0.9779 | tpr=0.9680 | fpr=0.0219 | 7818.1 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.15761 | acc=0.9770 | tpr=0.9683 | fpr=0.0229 | 7498.0 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.15926 | acc=0.9768 | tpr=0.9705 | fpr=0.0230 | 7403.7 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.15796 | acc=0.9768 | tpr=0.9703 | fpr=0.0231 | 8073.4 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.16078 | acc=0.9767 | tpr=0.9702 | fpr=0.0232 | 7247.4 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.16078 | acc=0.9767 | tpr=0.9693 | fpr=0.0232 | 7660.0 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.16210 | acc=0.9765 | tpr=0.9677 | fpr=0.0233 | 7772.3 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.16515 | acc=0.9761 | tpr=0.9674 | fpr=0.0238 | 7132.5 samples/s | 27.9 steps/s
[Step= 500] | Loss=0.16428 | acc=0.9762 | tpr=0.9674 | fpr=0.0237 | 7590.2 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.16309 | acc=0.9764 | tpr=0.9678 | fpr=0.0235 | 13651.4 samples/s | 53.3 steps/s
Avg test loss: 0.16280, Avg test acc: 0.97640, Avg tpr: 0.96751, Avg fpr: 0.02344, total FA: 3255

server round 48/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00006, len=1
[Step=38401 Epoch=74.9] | Loss=0.01059 | Reg=0.00302 | acc=0.9844 | L2-Norm=17.377 | L2-Norm(final)=2.876 | 3699.6 samples/s | 57.8 steps/s
[Step=38450 Epoch=75.0] | Loss=0.00245 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.376 | L2-Norm(final)=2.876 | 4277.3 samples/s | 66.8 steps/s
[Step=38500 Epoch=75.1] | Loss=0.00237 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.374 | L2-Norm(final)=2.877 | 4431.5 samples/s | 69.2 steps/s
[Step=38550 Epoch=75.2] | Loss=0.00232 | Reg=0.00302 | acc=0.9844 | L2-Norm=17.373 | L2-Norm(final)=2.878 | 4374.3 samples/s | 68.3 steps/s
[Step=38600 Epoch=75.3] | Loss=0.00223 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.371 | L2-Norm(final)=2.878 | 4414.7 samples/s | 69.0 steps/s
[Step=38650 Epoch=75.4] | Loss=0.00224 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.370 | L2-Norm(final)=2.878 | 4453.9 samples/s | 69.6 steps/s
[Step=38700 Epoch=75.5] | Loss=0.00221 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.368 | L2-Norm(final)=2.879 | 4439.4 samples/s | 69.4 steps/s
[Step=38750 Epoch=75.6] | Loss=0.00225 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.367 | L2-Norm(final)=2.879 | 4424.7 samples/s | 69.1 steps/s
[Step=38800 Epoch=75.7] | Loss=0.00227 | Reg=0.00302 | acc=0.9844 | L2-Norm=17.365 | L2-Norm(final)=2.879 | 4452.1 samples/s | 69.6 steps/s
[Step=38850 Epoch=75.8] | Loss=0.00229 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.363 | L2-Norm(final)=2.880 | 4474.1 samples/s | 69.9 steps/s
[Step=38900 Epoch=75.9] | Loss=0.00236 | Reg=0.00301 | acc=0.9844 | L2-Norm=17.362 | L2-Norm(final)=2.880 | 5323.3 samples/s | 83.2 steps/s
[Step=38950 Epoch=76.0] | Loss=0.00235 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.360 | L2-Norm(final)=2.881 | 1738.7 samples/s | 27.2 steps/s
[Step=39000 Epoch=76.1] | Loss=0.00234 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.358 | L2-Norm(final)=2.881 | 4210.6 samples/s | 65.8 steps/s
[Step=39050 Epoch=76.2] | Loss=0.00237 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.357 | L2-Norm(final)=2.882 | 4299.5 samples/s | 67.2 steps/s
[Step=39100 Epoch=76.3] | Loss=0.00232 | Reg=0.00301 | acc=0.9844 | L2-Norm=17.355 | L2-Norm(final)=2.882 | 4357.0 samples/s | 68.1 steps/s
[Step=39150 Epoch=76.4] | Loss=0.00237 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.354 | L2-Norm(final)=2.882 | 4404.7 samples/s | 68.8 steps/s
[Step=39200 Epoch=76.5] | Loss=0.00237 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.352 | L2-Norm(final)=2.883 | 4503.5 samples/s | 70.4 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step39200.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00006, len=1
[Step=38401 Epoch=75.1] | Loss=0.00006 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.148 | L2-Norm(final)=2.737 | 4007.4 samples/s | 62.6 steps/s
[Step=38450 Epoch=75.2] | Loss=0.00246 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.146 | L2-Norm(final)=2.735 | 4296.9 samples/s | 67.1 steps/s
[Step=38500 Epoch=75.3] | Loss=0.00211 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.144 | L2-Norm(final)=2.736 | 4414.9 samples/s | 69.0 steps/s
[Step=38550 Epoch=75.4] | Loss=0.00247 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.143 | L2-Norm(final)=2.737 | 4465.2 samples/s | 69.8 steps/s
[Step=38600 Epoch=75.5] | Loss=0.00234 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.141 | L2-Norm(final)=2.737 | 4471.8 samples/s | 69.9 steps/s
[Step=38650 Epoch=75.6] | Loss=0.00218 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.139 | L2-Norm(final)=2.738 | 4489.3 samples/s | 70.1 steps/s
[Step=38700 Epoch=75.7] | Loss=0.00203 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.137 | L2-Norm(final)=2.738 | 4534.9 samples/s | 70.9 steps/s
[Step=38750 Epoch=75.8] | Loss=0.00204 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.135 | L2-Norm(final)=2.739 | 4583.6 samples/s | 71.6 steps/s
[Step=38800 Epoch=75.9] | Loss=0.00195 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.134 | L2-Norm(final)=2.740 | 4631.3 samples/s | 72.4 steps/s
[Step=38850 Epoch=76.0] | Loss=0.00199 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.132 | L2-Norm(final)=2.740 | 4658.5 samples/s | 72.8 steps/s
[Step=38900 Epoch=76.0] | Loss=0.00211 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.130 | L2-Norm(final)=2.741 | 5617.4 samples/s | 87.8 steps/s
[Step=38950 Epoch=76.1] | Loss=0.00204 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.128 | L2-Norm(final)=2.741 | 1917.5 samples/s | 30.0 steps/s
[Step=39000 Epoch=76.2] | Loss=0.00200 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.126 | L2-Norm(final)=2.742 | 4553.4 samples/s | 71.1 steps/s
[Step=39050 Epoch=76.3] | Loss=0.00200 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.125 | L2-Norm(final)=2.743 | 4651.8 samples/s | 72.7 steps/s
[Step=39100 Epoch=76.4] | Loss=0.00201 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.123 | L2-Norm(final)=2.743 | 4567.8 samples/s | 71.4 steps/s
[Step=39150 Epoch=76.5] | Loss=0.00206 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.121 | L2-Norm(final)=2.744 | 4608.2 samples/s | 72.0 steps/s
[Step=39200 Epoch=76.6] | Loss=0.00207 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.119 | L2-Norm(final)=2.744 | 4627.0 samples/s | 72.3 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step39200.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00006, len=1
[Step=38401 Epoch=147.1] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.855 | L2-Norm(final)=10.514 | 4077.5 samples/s | 63.7 steps/s
[Step=38450 Epoch=147.3] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.854 | L2-Norm(final)=10.516 | 4147.5 samples/s | 64.8 steps/s
[Step=38500 Epoch=147.5] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.853 | L2-Norm(final)=10.517 | 4407.8 samples/s | 68.9 steps/s
[Step=38550 Epoch=147.7] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.851 | L2-Norm(final)=10.519 | 4280.1 samples/s | 66.9 steps/s
[Step=38600 Epoch=147.9] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.850 | L2-Norm(final)=10.521 | 4273.4 samples/s | 66.8 steps/s
[Step=38650 Epoch=148.1] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.848 | L2-Norm(final)=10.522 | 5475.3 samples/s | 85.6 steps/s
[Step=38700 Epoch=148.3] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.847 | L2-Norm(final)=10.524 | 1872.1 samples/s | 29.3 steps/s
[Step=38750 Epoch=148.5] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.845 | L2-Norm(final)=10.526 | 4405.4 samples/s | 68.8 steps/s
[Step=38800 Epoch=148.7] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.844 | L2-Norm(final)=10.527 | 4412.0 samples/s | 68.9 steps/s
[Step=38850 Epoch=148.9] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.842 | L2-Norm(final)=10.529 | 4358.2 samples/s | 68.1 steps/s
[Step=38900 Epoch=149.1] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.841 | L2-Norm(final)=10.531 | 4791.2 samples/s | 74.9 steps/s
[Step=38950 Epoch=149.2] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.839 | L2-Norm(final)=10.533 | 1962.6 samples/s | 30.7 steps/s
[Step=39000 Epoch=149.4] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.838 | L2-Norm(final)=10.535 | 4428.3 samples/s | 69.2 steps/s
[Step=39050 Epoch=149.6] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.836 | L2-Norm(final)=10.537 | 4392.0 samples/s | 68.6 steps/s
[Step=39100 Epoch=149.8] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.835 | L2-Norm(final)=10.539 | 4291.7 samples/s | 67.1 steps/s
[Step=39150 Epoch=150.0] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.833 | L2-Norm(final)=10.542 | 4351.4 samples/s | 68.0 steps/s
[Step=39200 Epoch=150.2] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.832 | L2-Norm(final)=10.544 | 2067.5 samples/s | 32.3 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step39200.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00006, len=1
[Step=38401 Epoch=147.8] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.949 | L2-Norm(final)=6.311 | 4245.2 samples/s | 66.3 steps/s
[Step=38450 Epoch=148.0] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.949 | L2-Norm(final)=6.311 | 4080.2 samples/s | 63.8 steps/s
[Step=38500 Epoch=148.2] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.948 | L2-Norm(final)=6.312 | 4301.0 samples/s | 67.2 steps/s
[Step=38550 Epoch=148.4] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.948 | L2-Norm(final)=6.312 | 4370.8 samples/s | 68.3 steps/s
[Step=38600 Epoch=148.6] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.948 | L2-Norm(final)=6.312 | 4412.2 samples/s | 68.9 steps/s
[Step=38650 Epoch=148.8] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.948 | L2-Norm(final)=6.312 | 5161.8 samples/s | 80.7 steps/s
[Step=38700 Epoch=149.0] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.948 | L2-Norm(final)=6.312 | 1812.9 samples/s | 28.3 steps/s
[Step=38750 Epoch=149.2] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.947 | L2-Norm(final)=6.312 | 4281.6 samples/s | 66.9 steps/s
[Step=38800 Epoch=149.4] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.947 | L2-Norm(final)=6.312 | 4236.1 samples/s | 66.2 steps/s
[Step=38850 Epoch=149.5] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.947 | L2-Norm(final)=6.312 | 4261.6 samples/s | 66.6 steps/s
[Step=38900 Epoch=149.7] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.947 | L2-Norm(final)=6.313 | 4820.0 samples/s | 75.3 steps/s
[Step=38950 Epoch=149.9] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.946 | L2-Norm(final)=6.313 | 1912.5 samples/s | 29.9 steps/s
[Step=39000 Epoch=150.1] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.946 | L2-Norm(final)=6.313 | 4195.1 samples/s | 65.5 steps/s
[Step=39050 Epoch=150.3] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.946 | L2-Norm(final)=6.313 | 4180.0 samples/s | 65.3 steps/s
[Step=39100 Epoch=150.5] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.946 | L2-Norm(final)=6.313 | 4285.1 samples/s | 67.0 steps/s
[Step=39150 Epoch=150.7] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.945 | L2-Norm(final)=6.313 | 4380.0 samples/s | 68.4 steps/s
[Step=39200 Epoch=150.9] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.945 | L2-Norm(final)=6.313 | 1959.3 samples/s | 30.6 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step39200.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.24381 | acc=0.9584 | tpr=0.9742 | fpr=0.0758 | 4115.1 samples/s | 16.1 steps/s
Avg test loss: 0.24808, Avg test acc: 0.95701, Avg tpr: 0.97266, Avg fpr: 0.07743, total FA: 604

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.20182 | acc=0.9590 | tpr=0.9687 | fpr=0.0622 | 3965.1 samples/s | 15.5 steps/s
Avg test loss: 0.21064, Avg test acc: 0.95773, Avg tpr: 0.96847, Avg fpr: 0.06589, total FA: 514

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.12487 | acc=0.3157 | tpr=0.0007 | fpr=0.0002 | 4026.3 samples/s | 15.7 steps/s
Avg test loss: 5.15016, Avg test acc: 0.31293, Avg tpr: 0.00070, Avg fpr: 0.00038, total FA: 3

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.80077 | acc=0.3149 | tpr=0.0013 | fpr=0.0040 | 4130.6 samples/s | 16.1 steps/s
Avg test loss: 5.82723, Avg test acc: 0.31244, Avg tpr: 0.00140, Avg fpr: 0.00346, total FA: 27

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=9.02078 | acc=0.1622 | tpr=0.8009 | fpr=0.8493 | 4096.0 samples/s | 16.0 steps/s
[Step= 100] | Loss=8.98518 | acc=0.1614 | tpr=0.7569 | fpr=0.8497 | 7268.9 samples/s | 28.4 steps/s
[Step= 150] | Loss=9.04842 | acc=0.1601 | tpr=0.7709 | fpr=0.8512 | 7601.7 samples/s | 29.7 steps/s
[Step= 200] | Loss=9.04194 | acc=0.1589 | tpr=0.7617 | fpr=0.8521 | 7409.4 samples/s | 28.9 steps/s
[Step= 250] | Loss=9.05972 | acc=0.1590 | tpr=0.7677 | fpr=0.8521 | 7656.4 samples/s | 29.9 steps/s
[Step= 300] | Loss=9.07099 | acc=0.1583 | tpr=0.7687 | fpr=0.8528 | 7476.3 samples/s | 29.2 steps/s
[Step= 350] | Loss=9.06588 | acc=0.1585 | tpr=0.7714 | fpr=0.8527 | 8229.4 samples/s | 32.1 steps/s
[Step= 400] | Loss=9.06611 | acc=0.1587 | tpr=0.7730 | fpr=0.8524 | 7064.0 samples/s | 27.6 steps/s
[Step= 450] | Loss=9.06624 | acc=0.1584 | tpr=0.7746 | fpr=0.8528 | 7441.7 samples/s | 29.1 steps/s
[Step= 500] | Loss=9.07785 | acc=0.1580 | tpr=0.7700 | fpr=0.8530 | 7416.3 samples/s | 29.0 steps/s
[Step= 550] | Loss=9.07924 | acc=0.1582 | tpr=0.7700 | fpr=0.8529 | 14326.7 samples/s | 56.0 steps/s
Avg test loss: 9.08206, Avg test acc: 0.15804, Avg tpr: 0.76981, Avg fpr: 0.85308, total FA: 118448

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=8.91526 | acc=0.1693 | tpr=0.7345 | fpr=0.8409 | 4112.2 samples/s | 16.1 steps/s
[Step= 100] | Loss=8.87360 | acc=0.1682 | tpr=0.7122 | fpr=0.8420 | 8109.9 samples/s | 31.7 steps/s
[Step= 150] | Loss=8.88135 | acc=0.1684 | tpr=0.6988 | fpr=0.8414 | 7523.2 samples/s | 29.4 steps/s
[Step= 200] | Loss=8.85243 | acc=0.1695 | tpr=0.7071 | fpr=0.8403 | 8205.2 samples/s | 32.1 steps/s
[Step= 250] | Loss=8.84982 | acc=0.1700 | tpr=0.7022 | fpr=0.8396 | 7640.4 samples/s | 29.8 steps/s
[Step= 300] | Loss=8.85143 | acc=0.1700 | tpr=0.7025 | fpr=0.8397 | 8080.9 samples/s | 31.6 steps/s
[Step= 350] | Loss=8.84923 | acc=0.1695 | tpr=0.7001 | fpr=0.8401 | 7926.8 samples/s | 31.0 steps/s
[Step= 400] | Loss=8.84149 | acc=0.1697 | tpr=0.7095 | fpr=0.8401 | 7862.0 samples/s | 30.7 steps/s
[Step= 450] | Loss=8.85462 | acc=0.1696 | tpr=0.7084 | fpr=0.8402 | 7669.9 samples/s | 30.0 steps/s
[Step= 500] | Loss=8.87216 | acc=0.1688 | tpr=0.7097 | fpr=0.8409 | 7951.4 samples/s | 31.1 steps/s
[Step= 550] | Loss=8.87203 | acc=0.1688 | tpr=0.7027 | fpr=0.8409 | 13816.1 samples/s | 54.0 steps/s
Avg test loss: 8.87467, Avg test acc: 0.16870, Avg tpr: 0.70285, Avg fpr: 0.84101, total FA: 116773

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08256 | acc=0.9820 | tpr=0.9513 | fpr=0.0175 | 4221.3 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.08583 | acc=0.9816 | tpr=0.9616 | fpr=0.0181 | 7638.6 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.08969 | acc=0.9809 | tpr=0.9640 | fpr=0.0188 | 8150.4 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.09034 | acc=0.9808 | tpr=0.9694 | fpr=0.0190 | 7830.2 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.08921 | acc=0.9809 | tpr=0.9694 | fpr=0.0189 | 7719.4 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.09025 | acc=0.9808 | tpr=0.9673 | fpr=0.0190 | 8039.5 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.09029 | acc=0.9807 | tpr=0.9668 | fpr=0.0190 | 7284.0 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.09128 | acc=0.9803 | tpr=0.9628 | fpr=0.0194 | 7663.1 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.09243 | acc=0.9801 | tpr=0.9620 | fpr=0.0196 | 7548.8 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.09239 | acc=0.9801 | tpr=0.9626 | fpr=0.0196 | 7402.8 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.09187 | acc=0.9803 | tpr=0.9634 | fpr=0.0194 | 13506.0 samples/s | 52.8 steps/s
Avg test loss: 0.09171, Avg test acc: 0.98031, Avg tpr: 0.96355, Avg fpr: 0.01938, total FA: 2691

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14029 | acc=0.9788 | tpr=0.9513 | fpr=0.0207 | 4001.3 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.14913 | acc=0.9780 | tpr=0.9680 | fpr=0.0218 | 7785.8 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.15460 | acc=0.9771 | tpr=0.9683 | fpr=0.0228 | 7651.7 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.15620 | acc=0.9770 | tpr=0.9705 | fpr=0.0229 | 7486.3 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.15492 | acc=0.9770 | tpr=0.9703 | fpr=0.0229 | 7422.4 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.15772 | acc=0.9769 | tpr=0.9702 | fpr=0.0230 | 7694.2 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.15772 | acc=0.9769 | tpr=0.9693 | fpr=0.0230 | 7519.3 samples/s | 29.4 steps/s
[Step= 400] | Loss=0.15903 | acc=0.9767 | tpr=0.9677 | fpr=0.0231 | 7776.2 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.16202 | acc=0.9762 | tpr=0.9674 | fpr=0.0236 | 7342.9 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.16116 | acc=0.9763 | tpr=0.9674 | fpr=0.0235 | 7393.0 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.16000 | acc=0.9765 | tpr=0.9678 | fpr=0.0233 | 14078.0 samples/s | 55.0 steps/s
Avg test loss: 0.15972, Avg test acc: 0.97655, Avg tpr: 0.96751, Avg fpr: 0.02328, total FA: 3233

server round 49/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Local layers training...
LR=0.00006, len=1
[Step=39201 Epoch=76.5] | Loss=0.00000 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.327 | L2-Norm(final)=2.890 | 3900.6 samples/s | 60.9 steps/s
[Step=39250 Epoch=76.6] | Loss=0.00289 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.325 | L2-Norm(final)=2.890 | 4194.0 samples/s | 65.5 steps/s
[Step=39300 Epoch=76.7] | Loss=0.00237 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.324 | L2-Norm(final)=2.890 | 4472.7 samples/s | 69.9 steps/s
[Step=39350 Epoch=76.7] | Loss=0.00227 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.322 | L2-Norm(final)=2.890 | 4445.6 samples/s | 69.5 steps/s
[Step=39400 Epoch=76.8] | Loss=0.00234 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.321 | L2-Norm(final)=2.890 | 4513.0 samples/s | 70.5 steps/s
[Step=39450 Epoch=76.9] | Loss=0.00240 | Reg=0.00300 | acc=0.9844 | L2-Norm=17.319 | L2-Norm(final)=2.891 | 4476.4 samples/s | 69.9 steps/s
[Step=39500 Epoch=77.0] | Loss=0.00241 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.317 | L2-Norm(final)=2.891 | 4431.0 samples/s | 69.2 steps/s
[Step=39550 Epoch=77.1] | Loss=0.00242 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.316 | L2-Norm(final)=2.891 | 4391.8 samples/s | 68.6 steps/s
[Step=39600 Epoch=77.2] | Loss=0.00227 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.314 | L2-Norm(final)=2.892 | 4489.6 samples/s | 70.1 steps/s
[Step=39650 Epoch=77.3] | Loss=0.00238 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.312 | L2-Norm(final)=2.892 | 4437.9 samples/s | 69.3 steps/s
[Step=39700 Epoch=77.4] | Loss=0.00231 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.311 | L2-Norm(final)=2.893 | 5321.5 samples/s | 83.1 steps/s
[Step=39750 Epoch=77.5] | Loss=0.00232 | Reg=0.00300 | acc=0.9844 | L2-Norm=17.309 | L2-Norm(final)=2.893 | 1832.6 samples/s | 28.6 steps/s
[Step=39800 Epoch=77.6] | Loss=0.00235 | Reg=0.00300 | acc=0.9844 | L2-Norm=17.308 | L2-Norm(final)=2.894 | 4416.4 samples/s | 69.0 steps/s
[Step=39850 Epoch=77.7] | Loss=0.00233 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.306 | L2-Norm(final)=2.895 | 4454.9 samples/s | 69.6 steps/s
[Step=39900 Epoch=77.8] | Loss=0.00236 | Reg=0.00299 | acc=0.9844 | L2-Norm=17.305 | L2-Norm(final)=2.895 | 4404.8 samples/s | 68.8 steps/s
[Step=39950 Epoch=77.9] | Loss=0.00237 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.303 | L2-Norm(final)=2.896 | 4373.5 samples/s | 68.3 steps/s
[Step=40000 Epoch=78.0] | Loss=0.00233 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.301 | L2-Norm(final)=2.896 | 4475.3 samples/s | 69.9 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_0/client_state-step40000.h5

Train client 1: client_asml1_1
Local layers training...
LR=0.00006, len=1
[Step=39201 Epoch=76.6] | Loss=0.00396 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.090 | L2-Norm(final)=2.754 | 4378.5 samples/s | 68.4 steps/s
[Step=39250 Epoch=76.7] | Loss=0.00070 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.088 | L2-Norm(final)=2.754 | 3943.5 samples/s | 61.6 steps/s
[Step=39300 Epoch=76.8] | Loss=0.00132 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.086 | L2-Norm(final)=2.755 | 4513.8 samples/s | 70.5 steps/s
[Step=39350 Epoch=76.9] | Loss=0.00152 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.085 | L2-Norm(final)=2.756 | 4506.8 samples/s | 70.4 steps/s
[Step=39400 Epoch=77.0] | Loss=0.00150 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.083 | L2-Norm(final)=2.757 | 4533.4 samples/s | 70.8 steps/s
[Step=39450 Epoch=77.1] | Loss=0.00175 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.081 | L2-Norm(final)=2.757 | 4415.4 samples/s | 69.0 steps/s
[Step=39500 Epoch=77.2] | Loss=0.00181 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.079 | L2-Norm(final)=2.758 | 4420.6 samples/s | 69.1 steps/s
[Step=39550 Epoch=77.3] | Loss=0.00185 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.077 | L2-Norm(final)=2.758 | 4478.9 samples/s | 70.0 steps/s
[Step=39600 Epoch=77.4] | Loss=0.00196 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.075 | L2-Norm(final)=2.759 | 4515.0 samples/s | 70.5 steps/s
[Step=39650 Epoch=77.5] | Loss=0.00200 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.073 | L2-Norm(final)=2.760 | 4595.8 samples/s | 71.8 steps/s
[Step=39700 Epoch=77.6] | Loss=0.00208 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.071 | L2-Norm(final)=2.760 | 5614.9 samples/s | 87.7 steps/s
[Step=39750 Epoch=77.7] | Loss=0.00207 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.069 | L2-Norm(final)=2.761 | 1959.4 samples/s | 30.6 steps/s
[Step=39800 Epoch=77.8] | Loss=0.00206 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.067 | L2-Norm(final)=2.761 | 4598.8 samples/s | 71.9 steps/s
[Step=39850 Epoch=77.9] | Loss=0.00204 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.066 | L2-Norm(final)=2.762 | 4557.6 samples/s | 71.2 steps/s
[Step=39900 Epoch=78.0] | Loss=0.00202 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.064 | L2-Norm(final)=2.763 | 4673.3 samples/s | 73.0 steps/s
[Step=39950 Epoch=78.1] | Loss=0.00201 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.062 | L2-Norm(final)=2.763 | 4608.3 samples/s | 72.0 steps/s
[Step=40000 Epoch=78.2] | Loss=0.00206 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.060 | L2-Norm(final)=2.764 | 4657.8 samples/s | 72.8 steps/s
Client model saved at models/model-no_server-a2i2/client_asml1_1/client_state-step40000.h5

Train client 2: client_iccad2012_0
Local layers training...
LR=0.00006, len=1
[Step=39201 Epoch=150.2] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.808 | L2-Norm(final)=10.580 | 4003.1 samples/s | 62.5 steps/s
[Step=39250 Epoch=150.4] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.806 | L2-Norm(final)=10.583 | 4221.9 samples/s | 66.0 steps/s
[Step=39300 Epoch=150.6] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.804 | L2-Norm(final)=10.585 | 4402.6 samples/s | 68.8 steps/s
[Step=39350 Epoch=150.8] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.803 | L2-Norm(final)=10.588 | 4289.0 samples/s | 67.0 steps/s
[Step=39400 Epoch=151.0] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.801 | L2-Norm(final)=10.591 | 4423.1 samples/s | 69.1 steps/s
[Step=39450 Epoch=151.2] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.799 | L2-Norm(final)=10.594 | 5584.6 samples/s | 87.3 steps/s
[Step=39500 Epoch=151.4] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.798 | L2-Norm(final)=10.597 | 1881.8 samples/s | 29.4 steps/s
[Step=39550 Epoch=151.5] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.796 | L2-Norm(final)=10.600 | 4204.9 samples/s | 65.7 steps/s
[Step=39600 Epoch=151.7] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.794 | L2-Norm(final)=10.603 | 4393.4 samples/s | 68.6 steps/s
[Step=39650 Epoch=151.9] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.793 | L2-Norm(final)=10.606 | 4448.7 samples/s | 69.5 steps/s
[Step=39700 Epoch=152.1] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.791 | L2-Norm(final)=10.609 | 4853.5 samples/s | 75.8 steps/s
[Step=39750 Epoch=152.3] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.789 | L2-Norm(final)=10.612 | 1951.4 samples/s | 30.5 steps/s
[Step=39800 Epoch=152.5] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.788 | L2-Norm(final)=10.616 | 4421.4 samples/s | 69.1 steps/s
[Step=39850 Epoch=152.7] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.786 | L2-Norm(final)=10.619 | 4504.3 samples/s | 70.4 steps/s
[Step=39900 Epoch=152.9] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.784 | L2-Norm(final)=10.622 | 4391.4 samples/s | 68.6 steps/s
[Step=39950 Epoch=153.1] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.782 | L2-Norm(final)=10.626 | 4297.6 samples/s | 67.2 steps/s
[Step=40000 Epoch=153.3] | Loss=0.00000 | Reg=0.00008 | acc=1.0000 | L2-Norm=2.781 | L2-Norm(final)=10.629 | 2031.3 samples/s | 31.7 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_0/client_state-step40000.h5

Train client 3: client_iccad2012_1
Local layers training...
LR=0.00006, len=1
[Step=39201 Epoch=150.9] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.941 | L2-Norm(final)=6.316 | 4374.3 samples/s | 68.3 steps/s
[Step=39250 Epoch=151.1] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.941 | L2-Norm(final)=6.316 | 3861.6 samples/s | 60.3 steps/s
[Step=39300 Epoch=151.3] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.941 | L2-Norm(final)=6.316 | 4381.2 samples/s | 68.5 steps/s
[Step=39350 Epoch=151.5] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.940 | L2-Norm(final)=6.316 | 4353.9 samples/s | 68.0 steps/s
[Step=39400 Epoch=151.7] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.940 | L2-Norm(final)=6.316 | 4365.6 samples/s | 68.2 steps/s
[Step=39450 Epoch=151.9] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.940 | L2-Norm(final)=6.317 | 5666.8 samples/s | 88.5 steps/s
[Step=39500 Epoch=152.1] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.939 | L2-Norm(final)=6.317 | 1847.9 samples/s | 28.9 steps/s
[Step=39550 Epoch=152.2] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.939 | L2-Norm(final)=6.317 | 4343.5 samples/s | 67.9 steps/s
[Step=39600 Epoch=152.4] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.939 | L2-Norm(final)=6.317 | 4158.3 samples/s | 65.0 steps/s
[Step=39650 Epoch=152.6] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.939 | L2-Norm(final)=6.317 | 4323.8 samples/s | 67.6 steps/s
[Step=39700 Epoch=152.8] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.938 | L2-Norm(final)=6.317 | 4920.2 samples/s | 76.9 steps/s
[Step=39750 Epoch=153.0] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.938 | L2-Norm(final)=6.318 | 1915.9 samples/s | 29.9 steps/s
[Step=39800 Epoch=153.2] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.938 | L2-Norm(final)=6.318 | 4188.9 samples/s | 65.5 steps/s
[Step=39850 Epoch=153.4] | Loss=0.00000 | Reg=0.00016 | acc=1.0000 | L2-Norm=3.937 | L2-Norm(final)=6.318 | 4207.2 samples/s | 65.7 steps/s
[Step=39900 Epoch=153.6] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.937 | L2-Norm(final)=6.318 | 4166.2 samples/s | 65.1 steps/s
[Step=39950 Epoch=153.8] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.936 | L2-Norm(final)=6.318 | 4240.1 samples/s | 66.3 steps/s
[Step=40000 Epoch=154.0] | Loss=0.00000 | Reg=0.00015 | acc=1.0000 | L2-Norm=3.936 | L2-Norm(final)=6.319 | 1962.4 samples/s | 30.7 steps/s
Client model saved at models/model-no_server-a2i2/client_iccad2012_1/client_state-step40000.h5

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.23162 | acc=0.9584 | tpr=0.9719 | fpr=0.0711 | 4228.4 samples/s | 16.5 steps/s
Avg test loss: 0.23715, Avg test acc: 0.95745, Avg tpr: 0.97080, Avg fpr: 0.07191, total FA: 561

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.20681 | acc=0.9590 | tpr=0.9704 | fpr=0.0659 | 4042.0 samples/s | 15.8 steps/s
Avg test loss: 0.21534, Avg test acc: 0.95753, Avg tpr: 0.97022, Avg fpr: 0.07038, total FA: 549

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.15541 | acc=0.3155 | tpr=0.0003 | fpr=0.0002 | 4054.6 samples/s | 15.8 steps/s
Avg test loss: 5.18075, Avg test acc: 0.31265, Avg tpr: 0.00029, Avg fpr: 0.00038, total FA: 3

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.80133 | acc=0.3149 | tpr=0.0013 | fpr=0.0040 | 4151.9 samples/s | 16.2 steps/s
Avg test loss: 5.82781, Avg test acc: 0.31248, Avg tpr: 0.00140, Avg fpr: 0.00333, total FA: 26

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=8.60943 | acc=0.1679 | tpr=0.7832 | fpr=0.8432 | 4095.1 samples/s | 16.0 steps/s
[Step= 100] | Loss=8.57509 | acc=0.1680 | tpr=0.7463 | fpr=0.8428 | 7647.0 samples/s | 29.9 steps/s
[Step= 150] | Loss=8.63562 | acc=0.1664 | tpr=0.7565 | fpr=0.8445 | 7826.7 samples/s | 30.6 steps/s
[Step= 200] | Loss=8.62923 | acc=0.1658 | tpr=0.7486 | fpr=0.8448 | 7163.4 samples/s | 28.0 steps/s
[Step= 250] | Loss=8.64636 | acc=0.1658 | tpr=0.7528 | fpr=0.8449 | 7595.9 samples/s | 29.7 steps/s
[Step= 300] | Loss=8.65678 | acc=0.1652 | tpr=0.7549 | fpr=0.8456 | 7509.6 samples/s | 29.3 steps/s
[Step= 350] | Loss=8.65198 | acc=0.1656 | tpr=0.7558 | fpr=0.8451 | 7479.5 samples/s | 29.2 steps/s
[Step= 400] | Loss=8.65211 | acc=0.1658 | tpr=0.7527 | fpr=0.8449 | 7370.8 samples/s | 28.8 steps/s
[Step= 450] | Loss=8.65148 | acc=0.1654 | tpr=0.7556 | fpr=0.8453 | 7464.9 samples/s | 29.2 steps/s
[Step= 500] | Loss=8.66340 | acc=0.1649 | tpr=0.7511 | fpr=0.8457 | 7593.1 samples/s | 29.7 steps/s
[Step= 550] | Loss=8.66469 | acc=0.1651 | tpr=0.7529 | fpr=0.8455 | 13485.9 samples/s | 52.7 steps/s
Avg test loss: 8.66745, Avg test acc: 0.16503, Avg tpr: 0.75277, Avg fpr: 0.84565, total FA: 117417

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=9.27182 | acc=0.1620 | tpr=0.7434 | fpr=0.8485 | 4112.2 samples/s | 16.1 steps/s
[Step= 100] | Loss=9.22805 | acc=0.1608 | tpr=0.7292 | fpr=0.8498 | 7746.5 samples/s | 30.3 steps/s
[Step= 150] | Loss=9.23662 | acc=0.1610 | tpr=0.7147 | fpr=0.8492 | 7781.9 samples/s | 30.4 steps/s
[Step= 200] | Loss=9.20692 | acc=0.1618 | tpr=0.7180 | fpr=0.8483 | 7652.0 samples/s | 29.9 steps/s
[Step= 250] | Loss=9.20368 | acc=0.1626 | tpr=0.7162 | fpr=0.8475 | 7805.6 samples/s | 30.5 steps/s
[Step= 300] | Loss=9.20617 | acc=0.1626 | tpr=0.7149 | fpr=0.8475 | 7682.7 samples/s | 30.0 steps/s
[Step= 350] | Loss=9.20405 | acc=0.1621 | tpr=0.7145 | fpr=0.8479 | 7695.4 samples/s | 30.1 steps/s
[Step= 400] | Loss=9.19657 | acc=0.1624 | tpr=0.7232 | fpr=0.8478 | 7950.9 samples/s | 31.1 steps/s
[Step= 450] | Loss=9.21034 | acc=0.1622 | tpr=0.7230 | fpr=0.8480 | 7974.7 samples/s | 31.2 steps/s
[Step= 500] | Loss=9.22860 | acc=0.1615 | tpr=0.7256 | fpr=0.8487 | 7486.8 samples/s | 29.2 steps/s
[Step= 550] | Loss=9.22865 | acc=0.1615 | tpr=0.7199 | fpr=0.8487 | 14531.3 samples/s | 56.8 steps/s
Avg test loss: 9.23132, Avg test acc: 0.16136, Avg tpr: 0.71989, Avg fpr: 0.84879, total FA: 117853

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08301 | acc=0.9814 | tpr=0.9513 | fpr=0.0181 | 4129.3 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.08611 | acc=0.9810 | tpr=0.9616 | fpr=0.0186 | 8198.9 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.08997 | acc=0.9804 | tpr=0.9654 | fpr=0.0194 | 7679.9 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.09068 | acc=0.9803 | tpr=0.9705 | fpr=0.0195 | 7957.7 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.08953 | acc=0.9805 | tpr=0.9703 | fpr=0.0193 | 7793.0 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.09061 | acc=0.9803 | tpr=0.9680 | fpr=0.0195 | 7500.7 samples/s | 29.3 steps/s
[Step= 350] | Loss=0.09059 | acc=0.9803 | tpr=0.9681 | fpr=0.0195 | 7707.1 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.09157 | acc=0.9798 | tpr=0.9644 | fpr=0.0199 | 7979.8 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.09272 | acc=0.9796 | tpr=0.9635 | fpr=0.0201 | 7756.0 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.09269 | acc=0.9797 | tpr=0.9634 | fpr=0.0200 | 7630.7 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.09216 | acc=0.9799 | tpr=0.9642 | fpr=0.0198 | 13690.8 samples/s | 53.5 steps/s
Avg test loss: 0.09200, Avg test acc: 0.97992, Avg tpr: 0.96434, Avg fpr: 0.01980, total FA: 2749

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13604 | acc=0.9793 | tpr=0.9513 | fpr=0.0202 | 4132.7 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.14468 | acc=0.9785 | tpr=0.9680 | fpr=0.0213 | 7494.0 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.14991 | acc=0.9775 | tpr=0.9683 | fpr=0.0223 | 8201.1 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.15144 | acc=0.9774 | tpr=0.9705 | fpr=0.0225 | 7251.6 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.15018 | acc=0.9774 | tpr=0.9703 | fpr=0.0225 | 7260.1 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.15298 | acc=0.9774 | tpr=0.9702 | fpr=0.0225 | 7899.0 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.15298 | acc=0.9774 | tpr=0.9693 | fpr=0.0225 | 7033.2 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.15428 | acc=0.9772 | tpr=0.9677 | fpr=0.0226 | 7838.6 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.15717 | acc=0.9767 | tpr=0.9669 | fpr=0.0231 | 7894.7 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.15633 | acc=0.9768 | tpr=0.9670 | fpr=0.0230 | 6982.3 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.15522 | acc=0.9770 | tpr=0.9674 | fpr=0.0229 | 14187.4 samples/s | 55.4 steps/s
Avg test loss: 0.15495, Avg test acc: 0.97699, Avg tpr: 0.96712, Avg fpr: 0.02283, total FA: 3170
