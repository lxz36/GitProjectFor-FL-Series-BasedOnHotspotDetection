#clients of iccad2012: 2
#clients of asml1: 2
select ratio: 1.0
Total num clients: 4
client model path: ['models/model-a2i2_sr1.0/client_asml1_0', 'models/model-a2i2_sr1.0/client_asml1_1', 'models/model-a2i2_sr1.0/client_iccad2012_0', 'models/model-a2i2_sr1.0/client_iccad2012_1']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32814, 144, 32)
Using transform option: train
#pos = 17102, #neg = 15712
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32737, 144, 32)
Using transform option: train
#pos = 17179, #neg = 15558
loading data into the main memory...
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16703, 144, 32)
Using transform option: train
#pos = 8134, #neg = 8569
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16626, 144, 32)
Using transform option: train
#pos = 8099, #neg = 8527
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35670 | Reg=0.00358 | acc=0.5312 | L2-Norm=18.925 | L2-Norm(final)=2.130 | 2325.9 samples/s | 36.3 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.32624 | Reg=0.00338 | acc=0.7031 | L2-Norm=18.395 | L2-Norm(final)=2.112 | 4944.7 samples/s | 77.3 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.31288 | Reg=0.00329 | acc=0.6562 | L2-Norm=18.137 | L2-Norm(final)=2.114 | 4638.7 samples/s | 72.5 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.30674 | Reg=0.00323 | acc=0.7031 | L2-Norm=17.978 | L2-Norm(final)=2.117 | 4576.3 samples/s | 71.5 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.30222 | Reg=0.00320 | acc=0.7656 | L2-Norm=17.874 | L2-Norm(final)=2.124 | 4656.5 samples/s | 72.8 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.29891 | Reg=0.00317 | acc=0.7656 | L2-Norm=17.806 | L2-Norm(final)=2.129 | 4623.5 samples/s | 72.2 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.29604 | Reg=0.00315 | acc=0.7188 | L2-Norm=17.759 | L2-Norm(final)=2.136 | 4656.9 samples/s | 72.8 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.29142 | Reg=0.00314 | acc=0.7812 | L2-Norm=17.727 | L2-Norm(final)=2.145 | 4637.8 samples/s | 72.5 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.28826 | Reg=0.00314 | acc=0.7812 | L2-Norm=17.704 | L2-Norm(final)=2.157 | 4654.6 samples/s | 72.7 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.28458 | Reg=0.00313 | acc=0.7812 | L2-Norm=17.692 | L2-Norm(final)=2.171 | 4659.3 samples/s | 72.8 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.28223 | Reg=0.00313 | acc=0.8281 | L2-Norm=17.685 | L2-Norm(final)=2.185 | 5963.6 samples/s | 93.2 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.0] | Loss=0.23466 | Reg=0.00311 | acc=0.7500 | L2-Norm=17.648 | L2-Norm(final)=2.331 | 3197.8 samples/s | 50.0 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.27297 | Reg=0.00311 | acc=0.8281 | L2-Norm=17.637 | L2-Norm(final)=2.316 | 3630.8 samples/s | 56.7 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.23055 | Reg=0.00312 | acc=0.8906 | L2-Norm=17.665 | L2-Norm(final)=2.326 | 3916.9 samples/s | 61.2 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.20884 | Reg=0.00313 | acc=0.9062 | L2-Norm=17.691 | L2-Norm(final)=2.335 | 3952.0 samples/s | 61.8 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.19218 | Reg=0.00314 | acc=0.9375 | L2-Norm=17.719 | L2-Norm(final)=2.344 | 3951.5 samples/s | 61.7 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.18103 | Reg=0.00315 | acc=0.8750 | L2-Norm=17.745 | L2-Norm(final)=2.351 | 3921.6 samples/s | 61.3 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.17290 | Reg=0.00316 | acc=0.8906 | L2-Norm=17.767 | L2-Norm(final)=2.356 | 3922.2 samples/s | 61.3 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.16580 | Reg=0.00316 | acc=0.8750 | L2-Norm=17.785 | L2-Norm(final)=2.361 | 3971.4 samples/s | 62.1 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.15851 | Reg=0.00317 | acc=0.8906 | L2-Norm=17.803 | L2-Norm(final)=2.366 | 3965.9 samples/s | 62.0 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.15337 | Reg=0.00318 | acc=0.8750 | L2-Norm=17.819 | L2-Norm(final)=2.371 | 3913.7 samples/s | 61.2 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.14826 | Reg=0.00318 | acc=0.9375 | L2-Norm=17.833 | L2-Norm(final)=2.375 | 4797.1 samples/s | 75.0 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.14234 | Reg=0.00319 | acc=0.8750 | L2-Norm=17.848 | L2-Norm(final)=2.379 | 1493.8 samples/s | 23.3 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.13788 | Reg=0.00319 | acc=0.9062 | L2-Norm=17.864 | L2-Norm(final)=2.384 | 3936.4 samples/s | 61.5 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.13333 | Reg=0.00320 | acc=0.9062 | L2-Norm=17.880 | L2-Norm(final)=2.388 | 3893.2 samples/s | 60.8 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.12886 | Reg=0.00320 | acc=0.9219 | L2-Norm=17.895 | L2-Norm(final)=2.393 | 3940.9 samples/s | 61.6 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.12541 | Reg=0.00321 | acc=0.9688 | L2-Norm=17.908 | L2-Norm(final)=2.397 | 3923.3 samples/s | 61.3 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.12267 | Reg=0.00321 | acc=0.9062 | L2-Norm=17.922 | L2-Norm(final)=2.401 | 3946.2 samples/s | 61.7 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.12030 | Reg=0.00322 | acc=0.8750 | L2-Norm=17.937 | L2-Norm(final)=2.405 | 3888.2 samples/s | 60.8 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.11743 | Reg=0.00322 | acc=0.9062 | L2-Norm=17.950 | L2-Norm(final)=2.408 | 3909.6 samples/s | 61.1 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.11489 | Reg=0.00323 | acc=0.9531 | L2-Norm=17.963 | L2-Norm(final)=2.412 | 3945.6 samples/s | 61.7 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.11255 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.976 | L2-Norm(final)=2.415 | 4220.0 samples/s | 65.9 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.11022 | Reg=0.00324 | acc=0.8906 | L2-Norm=17.988 | L2-Norm(final)=2.419 | 1572.5 samples/s | 24.6 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.10782 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.000 | L2-Norm(final)=2.422 | 3980.1 samples/s | 62.2 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.10559 | Reg=0.00324 | acc=0.9688 | L2-Norm=18.012 | L2-Norm(final)=2.425 | 3948.1 samples/s | 61.7 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.10324 | Reg=0.00325 | acc=0.9531 | L2-Norm=18.024 | L2-Norm(final)=2.429 | 3912.8 samples/s | 61.1 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.10131 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.036 | L2-Norm(final)=2.433 | 3923.7 samples/s | 61.3 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.09931 | Reg=0.00326 | acc=0.9688 | L2-Norm=18.048 | L2-Norm(final)=2.436 | 3988.3 samples/s | 62.3 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.09785 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.059 | L2-Norm(final)=2.439 | 3898.2 samples/s | 60.9 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.09638 | Reg=0.00327 | acc=0.9531 | L2-Norm=18.070 | L2-Norm(final)=2.442 | 3915.0 samples/s | 61.2 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.09483 | Reg=0.00327 | acc=0.9688 | L2-Norm=18.081 | L2-Norm(final)=2.445 | 3931.7 samples/s | 61.4 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.09337 | Reg=0.00327 | acc=0.9844 | L2-Norm=18.091 | L2-Norm(final)=2.448 | 3947.7 samples/s | 61.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step2000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34187 | Reg=0.00358 | acc=0.6250 | L2-Norm=18.925 | L2-Norm(final)=2.130 | 3258.3 samples/s | 50.9 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.31768 | Reg=0.00339 | acc=0.6875 | L2-Norm=18.400 | L2-Norm(final)=2.125 | 4525.8 samples/s | 70.7 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.30609 | Reg=0.00330 | acc=0.7500 | L2-Norm=18.155 | L2-Norm(final)=2.131 | 4807.4 samples/s | 75.1 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.30005 | Reg=0.00325 | acc=0.6875 | L2-Norm=18.025 | L2-Norm(final)=2.141 | 4511.9 samples/s | 70.5 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.29459 | Reg=0.00322 | acc=0.8125 | L2-Norm=17.947 | L2-Norm(final)=2.151 | 4753.6 samples/s | 74.3 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.29044 | Reg=0.00321 | acc=0.7031 | L2-Norm=17.902 | L2-Norm(final)=2.163 | 4665.8 samples/s | 72.9 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.28845 | Reg=0.00320 | acc=0.7500 | L2-Norm=17.876 | L2-Norm(final)=2.175 | 4680.5 samples/s | 73.1 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.28603 | Reg=0.00319 | acc=0.7031 | L2-Norm=17.863 | L2-Norm(final)=2.186 | 4644.4 samples/s | 72.6 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.28301 | Reg=0.00319 | acc=0.8281 | L2-Norm=17.857 | L2-Norm(final)=2.198 | 4716.4 samples/s | 73.7 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.28030 | Reg=0.00319 | acc=0.8125 | L2-Norm=17.858 | L2-Norm(final)=2.212 | 4687.8 samples/s | 73.2 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.27754 | Reg=0.00319 | acc=0.7656 | L2-Norm=17.864 | L2-Norm(final)=2.227 | 6147.2 samples/s | 96.0 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.0] | Loss=0.24944 | Reg=0.00322 | acc=0.7500 | L2-Norm=17.936 | L2-Norm(final)=2.378 | 3395.3 samples/s | 53.1 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.23081 | Reg=0.00322 | acc=0.8594 | L2-Norm=17.940 | L2-Norm(final)=2.384 | 3648.2 samples/s | 57.0 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.21025 | Reg=0.00323 | acc=0.8438 | L2-Norm=17.964 | L2-Norm(final)=2.391 | 3960.1 samples/s | 61.9 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.19630 | Reg=0.00324 | acc=0.8281 | L2-Norm=17.994 | L2-Norm(final)=2.401 | 3957.6 samples/s | 61.8 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.18552 | Reg=0.00325 | acc=0.8750 | L2-Norm=18.017 | L2-Norm(final)=2.408 | 3927.2 samples/s | 61.4 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.17679 | Reg=0.00325 | acc=0.9531 | L2-Norm=18.041 | L2-Norm(final)=2.416 | 3960.5 samples/s | 61.9 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.16902 | Reg=0.00326 | acc=0.8438 | L2-Norm=18.064 | L2-Norm(final)=2.423 | 3953.5 samples/s | 61.8 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.16181 | Reg=0.00327 | acc=0.8906 | L2-Norm=18.087 | L2-Norm(final)=2.430 | 3983.2 samples/s | 62.2 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.15531 | Reg=0.00328 | acc=0.8906 | L2-Norm=18.108 | L2-Norm(final)=2.437 | 3928.0 samples/s | 61.4 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.15001 | Reg=0.00328 | acc=0.9375 | L2-Norm=18.123 | L2-Norm(final)=2.442 | 3907.3 samples/s | 61.1 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.14465 | Reg=0.00329 | acc=0.8750 | L2-Norm=18.138 | L2-Norm(final)=2.447 | 4892.7 samples/s | 76.4 steps/s
[Step=1050 Epoch= 2.1] | Loss=0.13894 | Reg=0.00330 | acc=0.9219 | L2-Norm=18.153 | L2-Norm(final)=2.453 | 1507.2 samples/s | 23.5 steps/s
[Step=1100 Epoch= 2.2] | Loss=0.13419 | Reg=0.00330 | acc=0.9375 | L2-Norm=18.167 | L2-Norm(final)=2.459 | 3928.0 samples/s | 61.4 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.13037 | Reg=0.00331 | acc=0.8906 | L2-Norm=18.181 | L2-Norm(final)=2.464 | 3965.0 samples/s | 62.0 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.12686 | Reg=0.00331 | acc=0.9219 | L2-Norm=18.196 | L2-Norm(final)=2.470 | 3931.8 samples/s | 61.4 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.12320 | Reg=0.00332 | acc=0.9688 | L2-Norm=18.211 | L2-Norm(final)=2.475 | 3964.1 samples/s | 61.9 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.12014 | Reg=0.00332 | acc=0.9688 | L2-Norm=18.225 | L2-Norm(final)=2.480 | 3965.2 samples/s | 62.0 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.11726 | Reg=0.00333 | acc=0.9844 | L2-Norm=18.239 | L2-Norm(final)=2.484 | 4040.7 samples/s | 63.1 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.11514 | Reg=0.00333 | acc=0.9062 | L2-Norm=18.252 | L2-Norm(final)=2.488 | 3902.5 samples/s | 61.0 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.11298 | Reg=0.00334 | acc=0.9062 | L2-Norm=18.266 | L2-Norm(final)=2.491 | 4012.8 samples/s | 62.7 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.11074 | Reg=0.00334 | acc=0.9688 | L2-Norm=18.280 | L2-Norm(final)=2.495 | 4265.2 samples/s | 66.6 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.10831 | Reg=0.00335 | acc=0.9688 | L2-Norm=18.293 | L2-Norm(final)=2.498 | 1569.9 samples/s | 24.5 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.10595 | Reg=0.00335 | acc=0.9688 | L2-Norm=18.306 | L2-Norm(final)=2.501 | 3949.3 samples/s | 61.7 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.10386 | Reg=0.00336 | acc=0.9062 | L2-Norm=18.319 | L2-Norm(final)=2.504 | 3916.9 samples/s | 61.2 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.10218 | Reg=0.00336 | acc=0.9844 | L2-Norm=18.333 | L2-Norm(final)=2.507 | 3965.1 samples/s | 62.0 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.10038 | Reg=0.00337 | acc=0.9531 | L2-Norm=18.346 | L2-Norm(final)=2.510 | 3961.6 samples/s | 61.9 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.09868 | Reg=0.00337 | acc=0.9531 | L2-Norm=18.359 | L2-Norm(final)=2.512 | 3967.1 samples/s | 62.0 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.09698 | Reg=0.00338 | acc=0.9844 | L2-Norm=18.371 | L2-Norm(final)=2.515 | 3939.5 samples/s | 61.6 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.09543 | Reg=0.00338 | acc=0.9844 | L2-Norm=18.384 | L2-Norm(final)=2.517 | 3982.9 samples/s | 62.2 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.09424 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.396 | L2-Norm(final)=2.520 | 3975.8 samples/s | 62.1 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.09304 | Reg=0.00339 | acc=0.9844 | L2-Norm=18.408 | L2-Norm(final)=2.522 | 3920.9 samples/s | 61.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step2000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.43371 | Reg=0.00358 | acc=0.4688 | L2-Norm=18.925 | L2-Norm(final)=2.131 | 3206.5 samples/s | 50.1 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.26600 | Reg=0.00340 | acc=0.8594 | L2-Norm=18.437 | L2-Norm(final)=2.138 | 4112.0 samples/s | 64.2 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.21398 | Reg=0.00335 | acc=0.9219 | L2-Norm=18.296 | L2-Norm(final)=2.189 | 4438.3 samples/s | 69.3 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.18509 | Reg=0.00333 | acc=0.9062 | L2-Norm=18.247 | L2-Norm(final)=2.237 | 4390.1 samples/s | 68.6 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.16845 | Reg=0.00332 | acc=0.9219 | L2-Norm=18.225 | L2-Norm(final)=2.278 | 4318.5 samples/s | 67.5 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.15679 | Reg=0.00332 | acc=0.9062 | L2-Norm=18.217 | L2-Norm(final)=2.312 | 5962.2 samples/s | 93.2 steps/s
[Step= 300 Epoch= 1.1] | Loss=0.14595 | Reg=0.00332 | acc=0.9062 | L2-Norm=18.214 | L2-Norm(final)=2.341 | 1558.1 samples/s | 24.3 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.13758 | Reg=0.00332 | acc=0.9375 | L2-Norm=18.213 | L2-Norm(final)=2.370 | 4231.4 samples/s | 66.1 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.13083 | Reg=0.00332 | acc=0.9531 | L2-Norm=18.215 | L2-Norm(final)=2.397 | 4452.4 samples/s | 69.6 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.12678 | Reg=0.00332 | acc=0.9219 | L2-Norm=18.218 | L2-Norm(final)=2.422 | 4373.4 samples/s | 68.3 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.12183 | Reg=0.00332 | acc=0.9531 | L2-Norm=18.224 | L2-Norm(final)=2.446 | 4873.1 samples/s | 76.1 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.9] | Loss=0.05858 | Reg=0.00335 | acc=0.9688 | L2-Norm=18.292 | L2-Norm(final)=2.682 | 3037.1 samples/s | 47.5 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.05927 | Reg=0.00335 | acc=0.9375 | L2-Norm=18.294 | L2-Norm(final)=2.693 | 3730.2 samples/s | 58.3 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.05026 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.261 | L2-Norm(final)=2.700 | 3733.8 samples/s | 58.3 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.03909 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.235 | L2-Norm(final)=2.707 | 3854.7 samples/s | 60.2 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.03164 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.211 | L2-Norm(final)=2.715 | 3668.9 samples/s | 57.3 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.02641 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.187 | L2-Norm(final)=2.723 | 4728.7 samples/s | 73.9 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.02242 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.162 | L2-Norm(final)=2.729 | 1436.7 samples/s | 22.4 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.01944 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.138 | L2-Norm(final)=2.735 | 3651.4 samples/s | 57.1 steps/s
[Step= 900 Epoch= 3.4] | Loss=0.01714 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.112 | L2-Norm(final)=2.741 | 3703.3 samples/s | 57.9 steps/s
[Step= 950 Epoch= 3.6] | Loss=0.01528 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.086 | L2-Norm(final)=2.746 | 3662.6 samples/s | 57.2 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.01387 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.059 | L2-Norm(final)=2.750 | 4085.5 samples/s | 63.8 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.01275 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.033 | L2-Norm(final)=2.753 | 1509.4 samples/s | 23.6 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.01171 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.007 | L2-Norm(final)=2.757 | 3679.1 samples/s | 57.5 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.01082 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.980 | L2-Norm(final)=2.760 | 3736.9 samples/s | 58.4 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.01005 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.952 | L2-Norm(final)=2.763 | 3684.2 samples/s | 57.6 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.00939 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.923 | L2-Norm(final)=2.765 | 3720.8 samples/s | 58.1 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.00881 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.894 | L2-Norm(final)=2.768 | 1624.5 samples/s | 25.4 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.00830 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.864 | L2-Norm(final)=2.770 | 3737.2 samples/s | 58.4 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.00784 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.834 | L2-Norm(final)=2.772 | 3671.2 samples/s | 57.4 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.00743 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.803 | L2-Norm(final)=2.774 | 3715.2 samples/s | 58.0 steps/s
[Step=1500 Epoch= 5.7] | Loss=0.00706 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.772 | L2-Norm(final)=2.776 | 3688.3 samples/s | 57.6 steps/s
[Step=1550 Epoch= 5.9] | Loss=0.00673 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.741 | L2-Norm(final)=2.777 | 1584.1 samples/s | 24.8 steps/s
[Step=1600 Epoch= 6.1] | Loss=0.00642 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.710 | L2-Norm(final)=2.779 | 3750.9 samples/s | 58.6 steps/s
[Step=1650 Epoch= 6.3] | Loss=0.00614 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.678 | L2-Norm(final)=2.780 | 3712.3 samples/s | 58.0 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.00589 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.647 | L2-Norm(final)=2.781 | 3750.5 samples/s | 58.6 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.00566 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.615 | L2-Norm(final)=2.783 | 3711.9 samples/s | 58.0 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.00544 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.583 | L2-Norm(final)=2.784 | 5102.9 samples/s | 79.7 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.00524 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.551 | L2-Norm(final)=2.785 | 1398.2 samples/s | 21.8 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00505 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.519 | L2-Norm(final)=2.786 | 3730.9 samples/s | 58.3 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00488 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.487 | L2-Norm(final)=2.787 | 3683.7 samples/s | 57.6 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00472 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.455 | L2-Norm(final)=2.788 | 3702.5 samples/s | 57.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step2000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.37832 | Reg=0.00358 | acc=0.5625 | L2-Norm=18.925 | L2-Norm(final)=2.130 | 3202.4 samples/s | 50.0 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.24972 | Reg=0.00341 | acc=0.9062 | L2-Norm=18.457 | L2-Norm(final)=2.147 | 4120.2 samples/s | 64.4 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.20900 | Reg=0.00335 | acc=0.9062 | L2-Norm=18.303 | L2-Norm(final)=2.188 | 4306.7 samples/s | 67.3 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.18375 | Reg=0.00332 | acc=0.8750 | L2-Norm=18.233 | L2-Norm(final)=2.230 | 4360.1 samples/s | 68.1 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.16767 | Reg=0.00331 | acc=0.9062 | L2-Norm=18.200 | L2-Norm(final)=2.268 | 4395.5 samples/s | 68.7 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.15567 | Reg=0.00331 | acc=0.8594 | L2-Norm=18.188 | L2-Norm(final)=2.302 | 5965.0 samples/s | 93.2 steps/s
[Step= 300 Epoch= 1.2] | Loss=0.14628 | Reg=0.00331 | acc=0.9531 | L2-Norm=18.181 | L2-Norm(final)=2.331 | 1532.2 samples/s | 23.9 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.13852 | Reg=0.00330 | acc=0.9531 | L2-Norm=18.179 | L2-Norm(final)=2.359 | 4399.6 samples/s | 68.7 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.13243 | Reg=0.00331 | acc=0.8750 | L2-Norm=18.181 | L2-Norm(final)=2.386 | 4335.6 samples/s | 67.7 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.12774 | Reg=0.00331 | acc=0.9531 | L2-Norm=18.191 | L2-Norm(final)=2.411 | 4350.0 samples/s | 68.0 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.12446 | Reg=0.00331 | acc=0.8281 | L2-Norm=18.201 | L2-Norm(final)=2.435 | 5110.5 samples/s | 79.9 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.9] | Loss=0.06209 | Reg=0.00335 | acc=0.9531 | L2-Norm=18.309 | L2-Norm(final)=2.662 | 3139.4 samples/s | 49.1 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.06048 | Reg=0.00334 | acc=0.9375 | L2-Norm=18.283 | L2-Norm(final)=2.670 | 3639.5 samples/s | 56.9 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.04524 | Reg=0.00334 | acc=0.9688 | L2-Norm=18.272 | L2-Norm(final)=2.682 | 3793.3 samples/s | 59.3 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.03675 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.259 | L2-Norm(final)=2.691 | 3747.8 samples/s | 58.6 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.03355 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.240 | L2-Norm(final)=2.697 | 3765.8 samples/s | 58.8 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.02886 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.223 | L2-Norm(final)=2.702 | 4762.1 samples/s | 74.4 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.02452 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.207 | L2-Norm(final)=2.708 | 1437.7 samples/s | 22.5 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.02132 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.189 | L2-Norm(final)=2.713 | 3803.3 samples/s | 59.4 steps/s
[Step= 900 Epoch= 3.5] | Loss=0.01908 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.170 | L2-Norm(final)=2.718 | 3753.4 samples/s | 58.6 steps/s
[Step= 950 Epoch= 3.7] | Loss=0.01719 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.151 | L2-Norm(final)=2.723 | 3754.5 samples/s | 58.7 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.01562 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.130 | L2-Norm(final)=2.727 | 4280.6 samples/s | 66.9 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.01427 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.109 | L2-Norm(final)=2.731 | 1523.3 samples/s | 23.8 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.01311 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.086 | L2-Norm(final)=2.735 | 3763.8 samples/s | 58.8 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.01212 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.062 | L2-Norm(final)=2.738 | 3757.8 samples/s | 58.7 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.01127 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.038 | L2-Norm(final)=2.741 | 3750.0 samples/s | 58.6 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.01052 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.012 | L2-Norm(final)=2.744 | 3782.9 samples/s | 59.1 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.00987 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.986 | L2-Norm(final)=2.747 | 1639.3 samples/s | 25.6 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.00929 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.959 | L2-Norm(final)=2.749 | 3755.6 samples/s | 58.7 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.00878 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.932 | L2-Norm(final)=2.751 | 3745.9 samples/s | 58.5 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.00832 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.904 | L2-Norm(final)=2.753 | 3736.7 samples/s | 58.4 steps/s
[Step=1500 Epoch= 5.8] | Loss=0.00791 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.876 | L2-Norm(final)=2.755 | 3743.3 samples/s | 58.5 steps/s
[Step=1550 Epoch= 6.0] | Loss=0.00753 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.848 | L2-Norm(final)=2.757 | 1615.1 samples/s | 25.2 steps/s
[Step=1600 Epoch= 6.2] | Loss=0.00719 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.819 | L2-Norm(final)=2.759 | 3706.7 samples/s | 57.9 steps/s
[Step=1650 Epoch= 6.4] | Loss=0.00688 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.791 | L2-Norm(final)=2.761 | 3764.4 samples/s | 58.8 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.00660 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.761 | L2-Norm(final)=2.763 | 3706.3 samples/s | 57.9 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.00633 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.732 | L2-Norm(final)=2.765 | 3719.9 samples/s | 58.1 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.00609 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.703 | L2-Norm(final)=2.767 | 5569.3 samples/s | 87.0 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.00587 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.673 | L2-Norm(final)=2.769 | 1407.4 samples/s | 22.0 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00566 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.643 | L2-Norm(final)=2.771 | 3764.7 samples/s | 58.8 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00546 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.614 | L2-Norm(final)=2.773 | 3772.9 samples/s | 59.0 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00528 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.584 | L2-Norm(final)=2.775 | 3744.8 samples/s | 58.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step2000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08204 | acc=0.9430 | tpr=0.9530 | fpr=0.0788 | 3517.9 samples/s | 13.7 steps/s
Avg test loss: 0.08279, Avg test acc: 0.94146, Avg tpr: 0.95075, Avg fpr: 0.07896, total FA: 616

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08789 | acc=0.9384 | tpr=0.9431 | fpr=0.0719 | 3523.8 samples/s | 13.8 steps/s
Avg test loss: 0.09030, Avg test acc: 0.93605, Avg tpr: 0.93962, Avg fpr: 0.07179, total FA: 560

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=3.48208 | acc=0.3170 | tpr=0.0292 | fpr=0.0582 | 3552.3 samples/s | 13.9 steps/s
Avg test loss: 3.48634, Avg test acc: 0.31413, Avg tpr: 0.02862, Avg fpr: 0.05794, total FA: 452

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=3.56087 | acc=0.3135 | tpr=0.0299 | fpr=0.0706 | 3523.6 samples/s | 13.8 steps/s
Avg test loss: 3.58147, Avg test acc: 0.31092, Avg tpr: 0.02856, Avg fpr: 0.06807, total FA: 531

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.23904 | acc=0.1023 | tpr=0.8584 | fpr=0.9113 | 3535.9 samples/s | 13.8 steps/s
[Step= 100] | Loss=3.23413 | acc=0.1051 | tpr=0.8678 | fpr=0.9091 | 6952.1 samples/s | 27.2 steps/s
[Step= 150] | Loss=3.24421 | acc=0.1039 | tpr=0.8674 | fpr=0.9102 | 7061.3 samples/s | 27.6 steps/s
[Step= 200] | Loss=3.23718 | acc=0.1035 | tpr=0.8710 | fpr=0.9105 | 6663.6 samples/s | 26.0 steps/s
[Step= 250] | Loss=3.24190 | acc=0.1040 | tpr=0.8716 | fpr=0.9100 | 6728.2 samples/s | 26.3 steps/s
[Step= 300] | Loss=3.24406 | acc=0.1037 | tpr=0.8698 | fpr=0.9103 | 6835.5 samples/s | 26.7 steps/s
[Step= 350] | Loss=3.23979 | acc=0.1041 | tpr=0.8735 | fpr=0.9098 | 6900.2 samples/s | 27.0 steps/s
[Step= 400] | Loss=3.23746 | acc=0.1043 | tpr=0.8775 | fpr=0.9097 | 6703.5 samples/s | 26.2 steps/s
[Step= 450] | Loss=3.23799 | acc=0.1038 | tpr=0.8783 | fpr=0.9102 | 6689.4 samples/s | 26.1 steps/s
[Step= 500] | Loss=3.23860 | acc=0.1034 | tpr=0.8775 | fpr=0.9105 | 6897.0 samples/s | 26.9 steps/s
[Step= 550] | Loss=3.23794 | acc=0.1034 | tpr=0.8758 | fpr=0.9106 | 12553.8 samples/s | 49.0 steps/s
Avg test loss: 3.23891, Avg test acc: 0.10333, Avg tpr: 0.87599, Avg fpr: 0.91072, total FA: 126451

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=2.65141 | acc=0.1385 | tpr=0.8894 | fpr=0.8750 | 3563.8 samples/s | 13.9 steps/s
[Step= 100] | Loss=2.64098 | acc=0.1411 | tpr=0.8849 | fpr=0.8728 | 6588.1 samples/s | 25.7 steps/s
[Step= 150] | Loss=2.64433 | acc=0.1395 | tpr=0.8890 | fpr=0.8743 | 6762.4 samples/s | 26.4 steps/s
[Step= 200] | Loss=2.64411 | acc=0.1390 | tpr=0.8820 | fpr=0.8745 | 6887.0 samples/s | 26.9 steps/s
[Step= 250] | Loss=2.64762 | acc=0.1389 | tpr=0.8707 | fpr=0.8744 | 6704.3 samples/s | 26.2 steps/s
[Step= 300] | Loss=2.65035 | acc=0.1388 | tpr=0.8713 | fpr=0.8746 | 6955.4 samples/s | 27.2 steps/s
[Step= 350] | Loss=2.64864 | acc=0.1393 | tpr=0.8716 | fpr=0.8740 | 6709.9 samples/s | 26.2 steps/s
[Step= 400] | Loss=2.64884 | acc=0.1397 | tpr=0.8714 | fpr=0.8736 | 6818.4 samples/s | 26.6 steps/s
[Step= 450] | Loss=2.64903 | acc=0.1396 | tpr=0.8720 | fpr=0.8737 | 6839.6 samples/s | 26.7 steps/s
[Step= 500] | Loss=2.64995 | acc=0.1394 | tpr=0.8696 | fpr=0.8738 | 6925.7 samples/s | 27.1 steps/s
[Step= 550] | Loss=2.64955 | acc=0.1391 | tpr=0.8703 | fpr=0.8742 | 11885.7 samples/s | 46.4 steps/s
Avg test loss: 2.65031, Avg test acc: 0.13912, Avg tpr: 0.87084, Avg fpr: 0.87419, total FA: 121379

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.05359 | acc=0.9838 | tpr=0.9027 | fpr=0.0148 | 3470.0 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.05501 | acc=0.9839 | tpr=0.9190 | fpr=0.0149 | 6816.1 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.05604 | acc=0.9832 | tpr=0.9179 | fpr=0.0156 | 6871.5 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.05786 | acc=0.9828 | tpr=0.9180 | fpr=0.0160 | 6817.0 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.05749 | acc=0.9830 | tpr=0.9100 | fpr=0.0157 | 7157.3 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.05819 | acc=0.9828 | tpr=0.9076 | fpr=0.0158 | 6635.8 samples/s | 25.9 steps/s
[Step= 350] | Loss=0.05813 | acc=0.9828 | tpr=0.9067 | fpr=0.0158 | 6851.9 samples/s | 26.8 steps/s
[Step= 400] | Loss=0.05895 | acc=0.9825 | tpr=0.9037 | fpr=0.0161 | 6923.8 samples/s | 27.0 steps/s
[Step= 450] | Loss=0.06047 | acc=0.9823 | tpr=0.9031 | fpr=0.0162 | 6594.4 samples/s | 25.8 steps/s
[Step= 500] | Loss=0.06003 | acc=0.9823 | tpr=0.9057 | fpr=0.0163 | 6867.5 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.05996 | acc=0.9824 | tpr=0.9041 | fpr=0.0162 | 12455.6 samples/s | 48.7 steps/s
Avg test loss: 0.05984, Avg test acc: 0.98237, Avg tpr: 0.90333, Avg fpr: 0.01620, total FA: 2249

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.06176 | acc=0.9830 | tpr=0.9027 | fpr=0.0156 | 3539.4 samples/s | 13.8 steps/s
[Step= 100] | Loss=0.06354 | acc=0.9821 | tpr=0.9147 | fpr=0.0167 | 6748.0 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.06384 | acc=0.9817 | tpr=0.9207 | fpr=0.0172 | 6887.5 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.06493 | acc=0.9815 | tpr=0.9246 | fpr=0.0174 | 6915.6 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.06389 | acc=0.9817 | tpr=0.9179 | fpr=0.0171 | 7112.0 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.06520 | acc=0.9813 | tpr=0.9127 | fpr=0.0174 | 6726.1 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.06547 | acc=0.9812 | tpr=0.9155 | fpr=0.0176 | 6876.6 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.06607 | acc=0.9809 | tpr=0.9103 | fpr=0.0178 | 6785.9 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.06717 | acc=0.9807 | tpr=0.9090 | fpr=0.0180 | 6818.2 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.06675 | acc=0.9808 | tpr=0.9106 | fpr=0.0180 | 6864.0 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.06635 | acc=0.9807 | tpr=0.9105 | fpr=0.0180 | 12508.5 samples/s | 48.9 steps/s
Avg test loss: 0.06626, Avg test acc: 0.98072, Avg tpr: 0.91006, Avg fpr: 0.01800, total FA: 2499

server round 1/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=2001 Epoch= 3.9] | Loss=0.22597 | Reg=0.00249 | acc=0.7969 | L2-Norm=15.787 | L2-Norm(final)=2.530 | 3187.7 samples/s | 49.8 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.14967 | Reg=0.00258 | acc=0.7344 | L2-Norm=16.065 | L2-Norm(final)=2.557 | 4024.8 samples/s | 62.9 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.14383 | Reg=0.00263 | acc=0.9219 | L2-Norm=16.208 | L2-Norm(final)=2.579 | 4381.8 samples/s | 68.5 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.13545 | Reg=0.00266 | acc=0.9531 | L2-Norm=16.310 | L2-Norm(final)=2.594 | 4302.9 samples/s | 67.2 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.13165 | Reg=0.00268 | acc=0.9375 | L2-Norm=16.379 | L2-Norm(final)=2.608 | 4345.6 samples/s | 67.9 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.13115 | Reg=0.00270 | acc=0.7969 | L2-Norm=16.436 | L2-Norm(final)=2.620 | 4369.6 samples/s | 68.3 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.12851 | Reg=0.00272 | acc=0.9531 | L2-Norm=16.488 | L2-Norm(final)=2.634 | 4416.6 samples/s | 69.0 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.12650 | Reg=0.00273 | acc=0.9062 | L2-Norm=16.535 | L2-Norm(final)=2.647 | 4334.8 samples/s | 67.7 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.12454 | Reg=0.00275 | acc=0.9062 | L2-Norm=16.582 | L2-Norm(final)=2.662 | 4325.5 samples/s | 67.6 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.12314 | Reg=0.00277 | acc=0.8750 | L2-Norm=16.627 | L2-Norm(final)=2.676 | 4394.2 samples/s | 68.7 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.12230 | Reg=0.00278 | acc=0.8281 | L2-Norm=16.665 | L2-Norm(final)=2.688 | 5419.0 samples/s | 84.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 4.9] | Loss=0.10190 | Reg=0.00290 | acc=0.8906 | L2-Norm=17.034 | L2-Norm(final)=2.809 | 3331.4 samples/s | 52.1 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.14445 | Reg=0.00292 | acc=0.8125 | L2-Norm=17.075 | L2-Norm(final)=2.806 | 3641.5 samples/s | 56.9 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.13167 | Reg=0.00293 | acc=0.8750 | L2-Norm=17.120 | L2-Norm(final)=2.804 | 3891.3 samples/s | 60.8 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.11863 | Reg=0.00294 | acc=0.9688 | L2-Norm=17.151 | L2-Norm(final)=2.808 | 3940.8 samples/s | 61.6 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.11182 | Reg=0.00295 | acc=0.9375 | L2-Norm=17.173 | L2-Norm(final)=2.810 | 3889.9 samples/s | 60.8 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.10815 | Reg=0.00296 | acc=0.9219 | L2-Norm=17.190 | L2-Norm(final)=2.811 | 3943.9 samples/s | 61.6 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.10381 | Reg=0.00296 | acc=0.9062 | L2-Norm=17.207 | L2-Norm(final)=2.812 | 3843.9 samples/s | 60.1 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.10065 | Reg=0.00297 | acc=0.8906 | L2-Norm=17.221 | L2-Norm(final)=2.813 | 3986.4 samples/s | 62.3 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.09680 | Reg=0.00297 | acc=0.8906 | L2-Norm=17.235 | L2-Norm(final)=2.814 | 3916.5 samples/s | 61.2 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.09410 | Reg=0.00297 | acc=0.9062 | L2-Norm=17.248 | L2-Norm(final)=2.815 | 3905.6 samples/s | 61.0 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.09194 | Reg=0.00298 | acc=0.9531 | L2-Norm=17.260 | L2-Norm(final)=2.816 | 4823.2 samples/s | 75.4 steps/s
[Step=3050 Epoch= 5.9] | Loss=0.08924 | Reg=0.00298 | acc=0.9531 | L2-Norm=17.272 | L2-Norm(final)=2.817 | 1470.3 samples/s | 23.0 steps/s
[Step=3100 Epoch= 6.0] | Loss=0.08616 | Reg=0.00299 | acc=0.9531 | L2-Norm=17.285 | L2-Norm(final)=2.818 | 3818.7 samples/s | 59.7 steps/s
[Step=3150 Epoch= 6.1] | Loss=0.08384 | Reg=0.00299 | acc=0.9844 | L2-Norm=17.298 | L2-Norm(final)=2.820 | 3883.6 samples/s | 60.7 steps/s
[Step=3200 Epoch= 6.2] | Loss=0.08164 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.310 | L2-Norm(final)=2.821 | 3896.1 samples/s | 60.9 steps/s
[Step=3250 Epoch= 6.3] | Loss=0.07985 | Reg=0.00300 | acc=0.9688 | L2-Norm=17.322 | L2-Norm(final)=2.822 | 3874.1 samples/s | 60.5 steps/s
[Step=3300 Epoch= 6.4] | Loss=0.07797 | Reg=0.00300 | acc=0.9375 | L2-Norm=17.333 | L2-Norm(final)=2.824 | 3865.3 samples/s | 60.4 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.07679 | Reg=0.00301 | acc=0.9219 | L2-Norm=17.345 | L2-Norm(final)=2.825 | 3989.3 samples/s | 62.3 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.07577 | Reg=0.00301 | acc=0.9688 | L2-Norm=17.355 | L2-Norm(final)=2.826 | 3897.8 samples/s | 60.9 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.07459 | Reg=0.00302 | acc=0.9688 | L2-Norm=17.367 | L2-Norm(final)=2.827 | 3903.2 samples/s | 61.0 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.07340 | Reg=0.00302 | acc=0.9688 | L2-Norm=17.378 | L2-Norm(final)=2.829 | 4170.4 samples/s | 65.2 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.07214 | Reg=0.00302 | acc=0.9844 | L2-Norm=17.389 | L2-Norm(final)=2.830 | 1587.6 samples/s | 24.8 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.07051 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.401 | L2-Norm(final)=2.832 | 3915.1 samples/s | 61.2 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.06949 | Reg=0.00303 | acc=0.9844 | L2-Norm=17.412 | L2-Norm(final)=2.834 | 3956.7 samples/s | 61.8 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.06829 | Reg=0.00304 | acc=0.9688 | L2-Norm=17.425 | L2-Norm(final)=2.835 | 3943.6 samples/s | 61.6 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.06723 | Reg=0.00304 | acc=0.9844 | L2-Norm=17.436 | L2-Norm(final)=2.837 | 3935.9 samples/s | 61.5 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.06670 | Reg=0.00304 | acc=0.9844 | L2-Norm=17.448 | L2-Norm(final)=2.838 | 3924.8 samples/s | 61.3 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.06575 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.460 | L2-Norm(final)=2.840 | 3939.9 samples/s | 61.6 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.06476 | Reg=0.00305 | acc=0.9375 | L2-Norm=17.472 | L2-Norm(final)=2.841 | 3913.7 samples/s | 61.2 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.06402 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.484 | L2-Norm(final)=2.842 | 3937.0 samples/s | 61.5 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.06330 | Reg=0.00306 | acc=0.9531 | L2-Norm=17.497 | L2-Norm(final)=2.843 | 3945.5 samples/s | 61.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step4000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=2001 Epoch= 3.9] | Loss=0.20350 | Reg=0.00249 | acc=0.7969 | L2-Norm=15.787 | L2-Norm(final)=2.588 | 3259.6 samples/s | 50.9 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.15388 | Reg=0.00260 | acc=0.9219 | L2-Norm=16.118 | L2-Norm(final)=2.610 | 4113.5 samples/s | 64.3 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.14228 | Reg=0.00266 | acc=0.9375 | L2-Norm=16.298 | L2-Norm(final)=2.632 | 4365.1 samples/s | 68.2 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.13506 | Reg=0.00269 | acc=0.9062 | L2-Norm=16.411 | L2-Norm(final)=2.651 | 4372.7 samples/s | 68.3 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.13370 | Reg=0.00272 | acc=0.9688 | L2-Norm=16.503 | L2-Norm(final)=2.665 | 4351.4 samples/s | 68.0 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.13074 | Reg=0.00275 | acc=0.9219 | L2-Norm=16.582 | L2-Norm(final)=2.678 | 4378.4 samples/s | 68.4 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.12774 | Reg=0.00277 | acc=0.8750 | L2-Norm=16.649 | L2-Norm(final)=2.690 | 4367.6 samples/s | 68.2 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.12616 | Reg=0.00279 | acc=0.9688 | L2-Norm=16.709 | L2-Norm(final)=2.702 | 4411.2 samples/s | 68.9 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.12535 | Reg=0.00281 | acc=0.9062 | L2-Norm=16.765 | L2-Norm(final)=2.713 | 4366.5 samples/s | 68.2 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.12512 | Reg=0.00283 | acc=0.9062 | L2-Norm=16.819 | L2-Norm(final)=2.724 | 4348.5 samples/s | 67.9 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.12372 | Reg=0.00285 | acc=0.9844 | L2-Norm=16.867 | L2-Norm(final)=2.734 | 5560.5 samples/s | 86.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 4.9] | Loss=0.10358 | Reg=0.00300 | acc=0.9062 | L2-Norm=17.320 | L2-Norm(final)=2.844 | 3152.6 samples/s | 49.3 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.12445 | Reg=0.00300 | acc=0.9844 | L2-Norm=17.333 | L2-Norm(final)=2.841 | 3938.3 samples/s | 61.5 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.12369 | Reg=0.00301 | acc=0.9375 | L2-Norm=17.350 | L2-Norm(final)=2.837 | 3888.0 samples/s | 60.8 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.11774 | Reg=0.00301 | acc=0.8594 | L2-Norm=17.362 | L2-Norm(final)=2.833 | 3928.0 samples/s | 61.4 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.11229 | Reg=0.00302 | acc=0.9688 | L2-Norm=17.371 | L2-Norm(final)=2.829 | 3967.8 samples/s | 62.0 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.10743 | Reg=0.00302 | acc=0.8438 | L2-Norm=17.380 | L2-Norm(final)=2.827 | 3946.1 samples/s | 61.7 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.10271 | Reg=0.00303 | acc=0.9375 | L2-Norm=17.393 | L2-Norm(final)=2.826 | 3945.3 samples/s | 61.6 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.09980 | Reg=0.00303 | acc=0.9688 | L2-Norm=17.411 | L2-Norm(final)=2.826 | 3949.2 samples/s | 61.7 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.09702 | Reg=0.00304 | acc=0.9531 | L2-Norm=17.427 | L2-Norm(final)=2.827 | 3948.9 samples/s | 61.7 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.09361 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.442 | L2-Norm(final)=2.828 | 3958.5 samples/s | 61.9 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.09170 | Reg=0.00305 | acc=0.9531 | L2-Norm=17.456 | L2-Norm(final)=2.829 | 4903.4 samples/s | 76.6 steps/s
[Step=3050 Epoch= 6.0] | Loss=0.08876 | Reg=0.00305 | acc=0.9688 | L2-Norm=17.470 | L2-Norm(final)=2.830 | 1526.7 samples/s | 23.9 steps/s
[Step=3100 Epoch= 6.1] | Loss=0.08554 | Reg=0.00306 | acc=0.9375 | L2-Norm=17.485 | L2-Norm(final)=2.832 | 3959.0 samples/s | 61.9 steps/s
[Step=3150 Epoch= 6.2] | Loss=0.08409 | Reg=0.00306 | acc=0.9531 | L2-Norm=17.500 | L2-Norm(final)=2.833 | 3921.2 samples/s | 61.3 steps/s
[Step=3200 Epoch= 6.3] | Loss=0.08217 | Reg=0.00307 | acc=0.9688 | L2-Norm=17.514 | L2-Norm(final)=2.834 | 3943.6 samples/s | 61.6 steps/s
[Step=3250 Epoch= 6.4] | Loss=0.08031 | Reg=0.00307 | acc=0.9531 | L2-Norm=17.529 | L2-Norm(final)=2.836 | 3908.5 samples/s | 61.1 steps/s
[Step=3300 Epoch= 6.5] | Loss=0.07903 | Reg=0.00308 | acc=0.9062 | L2-Norm=17.542 | L2-Norm(final)=2.837 | 3954.6 samples/s | 61.8 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.07746 | Reg=0.00308 | acc=0.9844 | L2-Norm=17.555 | L2-Norm(final)=2.838 | 4007.8 samples/s | 62.6 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.07584 | Reg=0.00309 | acc=0.9688 | L2-Norm=17.569 | L2-Norm(final)=2.839 | 3925.2 samples/s | 61.3 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.07445 | Reg=0.00309 | acc=0.9688 | L2-Norm=17.583 | L2-Norm(final)=2.840 | 3969.4 samples/s | 62.0 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.07331 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.596 | L2-Norm(final)=2.841 | 4261.4 samples/s | 66.6 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.07195 | Reg=0.00310 | acc=0.9531 | L2-Norm=17.609 | L2-Norm(final)=2.842 | 1566.7 samples/s | 24.5 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.07061 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.622 | L2-Norm(final)=2.843 | 3976.3 samples/s | 62.1 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.06918 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.635 | L2-Norm(final)=2.845 | 3883.4 samples/s | 60.7 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.06807 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.648 | L2-Norm(final)=2.846 | 3930.8 samples/s | 61.4 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.06706 | Reg=0.00312 | acc=0.9531 | L2-Norm=17.660 | L2-Norm(final)=2.847 | 3918.6 samples/s | 61.2 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.06600 | Reg=0.00312 | acc=0.9688 | L2-Norm=17.672 | L2-Norm(final)=2.848 | 3953.2 samples/s | 61.8 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.06518 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.685 | L2-Norm(final)=2.849 | 3965.3 samples/s | 62.0 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.06454 | Reg=0.00313 | acc=0.9531 | L2-Norm=17.698 | L2-Norm(final)=2.850 | 3907.6 samples/s | 61.1 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.06368 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.710 | L2-Norm(final)=2.852 | 3981.0 samples/s | 62.2 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.06305 | Reg=0.00314 | acc=0.9531 | L2-Norm=17.723 | L2-Norm(final)=2.853 | 3929.8 samples/s | 61.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step4000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=2001 Epoch= 7.7] | Loss=0.20464 | Reg=0.00249 | acc=0.8125 | L2-Norm=15.787 | L2-Norm(final)=2.818 | 3104.1 samples/s | 48.5 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.07175 | Reg=0.00261 | acc=0.9688 | L2-Norm=16.160 | L2-Norm(final)=2.842 | 4192.0 samples/s | 65.5 steps/s
[Step=2100 Epoch= 8.0] | Loss=0.05445 | Reg=0.00268 | acc=0.9531 | L2-Norm=16.360 | L2-Norm(final)=2.868 | 4016.4 samples/s | 62.8 steps/s
[Step=2150 Epoch= 8.2] | Loss=0.05019 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.477 | L2-Norm(final)=2.890 | 4175.3 samples/s | 65.2 steps/s
[Step=2200 Epoch= 8.4] | Loss=0.04509 | Reg=0.00275 | acc=0.9375 | L2-Norm=16.572 | L2-Norm(final)=2.909 | 4157.1 samples/s | 65.0 steps/s
[Step=2250 Epoch= 8.6] | Loss=0.04132 | Reg=0.00277 | acc=0.9844 | L2-Norm=16.643 | L2-Norm(final)=2.929 | 5482.7 samples/s | 85.7 steps/s
[Step=2300 Epoch= 8.8] | Loss=0.03801 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.709 | L2-Norm(final)=2.950 | 1574.8 samples/s | 24.6 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.03521 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.763 | L2-Norm(final)=2.972 | 4197.6 samples/s | 65.6 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.03285 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.808 | L2-Norm(final)=2.995 | 4117.4 samples/s | 64.3 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.03140 | Reg=0.00284 | acc=0.9844 | L2-Norm=16.848 | L2-Norm(final)=3.017 | 4170.0 samples/s | 65.2 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.03067 | Reg=0.00285 | acc=0.9844 | L2-Norm=16.887 | L2-Norm(final)=3.039 | 4678.9 samples/s | 73.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 9.6] | Loss=0.00525 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.268 | L2-Norm(final)=3.257 | 3287.0 samples/s | 51.4 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.06415 | Reg=0.00302 | acc=0.9688 | L2-Norm=17.373 | L2-Norm(final)=3.226 | 3451.8 samples/s | 53.9 steps/s
[Step=2600 Epoch=10.0] | Loss=0.04060 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.406 | L2-Norm(final)=3.225 | 3707.5 samples/s | 57.9 steps/s
[Step=2650 Epoch=10.2] | Loss=0.03004 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.416 | L2-Norm(final)=3.229 | 3728.3 samples/s | 58.3 steps/s
[Step=2700 Epoch=10.3] | Loss=0.02514 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.416 | L2-Norm(final)=3.233 | 3743.1 samples/s | 58.5 steps/s
[Step=2750 Epoch=10.5] | Loss=0.02087 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.413 | L2-Norm(final)=3.238 | 4675.7 samples/s | 73.1 steps/s
[Step=2800 Epoch=10.7] | Loss=0.01780 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.406 | L2-Norm(final)=3.242 | 1516.3 samples/s | 23.7 steps/s
[Step=2850 Epoch=10.9] | Loss=0.01538 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.397 | L2-Norm(final)=3.245 | 3633.7 samples/s | 56.8 steps/s
[Step=2900 Epoch=11.1] | Loss=0.01354 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.384 | L2-Norm(final)=3.249 | 3751.4 samples/s | 58.6 steps/s
[Step=2950 Epoch=11.3] | Loss=0.01210 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.369 | L2-Norm(final)=3.253 | 3765.2 samples/s | 58.8 steps/s
[Step=3000 Epoch=11.5] | Loss=0.01093 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.351 | L2-Norm(final)=3.256 | 4090.2 samples/s | 63.9 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00995 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.333 | L2-Norm(final)=3.259 | 1522.8 samples/s | 23.8 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00912 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.313 | L2-Norm(final)=3.262 | 3706.7 samples/s | 57.9 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00842 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.292 | L2-Norm(final)=3.265 | 3704.2 samples/s | 57.9 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00783 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.271 | L2-Norm(final)=3.267 | 3700.8 samples/s | 57.8 steps/s
[Step=3250 Epoch=12.5] | Loss=0.00731 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.248 | L2-Norm(final)=3.269 | 3765.1 samples/s | 58.8 steps/s
[Step=3300 Epoch=12.6] | Loss=0.00685 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.226 | L2-Norm(final)=3.271 | 1586.9 samples/s | 24.8 steps/s
[Step=3350 Epoch=12.8] | Loss=0.00645 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.203 | L2-Norm(final)=3.273 | 3741.7 samples/s | 58.5 steps/s
[Step=3400 Epoch=13.0] | Loss=0.00610 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.179 | L2-Norm(final)=3.275 | 3724.7 samples/s | 58.2 steps/s
[Step=3450 Epoch=13.2] | Loss=0.00578 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.156 | L2-Norm(final)=3.276 | 3759.7 samples/s | 58.7 steps/s
[Step=3500 Epoch=13.4] | Loss=0.00549 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.132 | L2-Norm(final)=3.278 | 3738.7 samples/s | 58.4 steps/s
[Step=3550 Epoch=13.6] | Loss=0.00523 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.107 | L2-Norm(final)=3.280 | 1608.0 samples/s | 25.1 steps/s
[Step=3600 Epoch=13.8] | Loss=0.00499 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.083 | L2-Norm(final)=3.281 | 3673.1 samples/s | 57.4 steps/s
[Step=3650 Epoch=14.0] | Loss=0.00477 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.058 | L2-Norm(final)=3.283 | 3748.9 samples/s | 58.6 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00458 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.033 | L2-Norm(final)=3.284 | 3657.7 samples/s | 57.2 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00439 | Reg=0.00289 | acc=1.0000 | L2-Norm=17.009 | L2-Norm(final)=3.286 | 3736.1 samples/s | 58.4 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00423 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.984 | L2-Norm(final)=3.287 | 5119.0 samples/s | 80.0 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00407 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.958 | L2-Norm(final)=3.289 | 1437.6 samples/s | 22.5 steps/s
[Step=3900 Epoch=14.9] | Loss=0.00392 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.933 | L2-Norm(final)=3.290 | 3744.8 samples/s | 58.5 steps/s
[Step=3950 Epoch=15.1] | Loss=0.00379 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.908 | L2-Norm(final)=3.292 | 3733.0 samples/s | 58.3 steps/s
[Step=4000 Epoch=15.3] | Loss=0.00366 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.883 | L2-Norm(final)=3.293 | 3688.7 samples/s | 57.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step4000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=2001 Epoch= 7.7] | Loss=0.19391 | Reg=0.00249 | acc=0.8281 | L2-Norm=15.787 | L2-Norm(final)=2.834 | 3120.0 samples/s | 48.7 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.06954 | Reg=0.00261 | acc=0.9844 | L2-Norm=16.150 | L2-Norm(final)=2.846 | 3885.1 samples/s | 60.7 steps/s
[Step=2100 Epoch= 8.1] | Loss=0.05725 | Reg=0.00265 | acc=0.9844 | L2-Norm=16.292 | L2-Norm(final)=2.867 | 4134.7 samples/s | 64.6 steps/s
[Step=2150 Epoch= 8.3] | Loss=0.05259 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.379 | L2-Norm(final)=2.883 | 4111.5 samples/s | 64.2 steps/s
[Step=2200 Epoch= 8.5] | Loss=0.05010 | Reg=0.00271 | acc=0.9844 | L2-Norm=16.456 | L2-Norm(final)=2.895 | 3994.5 samples/s | 62.4 steps/s
[Step=2250 Epoch= 8.7] | Loss=0.04601 | Reg=0.00273 | acc=0.9844 | L2-Norm=16.515 | L2-Norm(final)=2.908 | 5430.4 samples/s | 84.8 steps/s
[Step=2300 Epoch= 8.9] | Loss=0.04406 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.561 | L2-Norm(final)=2.924 | 1484.9 samples/s | 23.2 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.04089 | Reg=0.00276 | acc=0.9844 | L2-Norm=16.605 | L2-Norm(final)=2.941 | 4054.2 samples/s | 63.3 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.03898 | Reg=0.00277 | acc=0.9844 | L2-Norm=16.651 | L2-Norm(final)=2.960 | 4095.7 samples/s | 64.0 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.03751 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.693 | L2-Norm(final)=2.979 | 4153.2 samples/s | 64.9 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.03587 | Reg=0.00280 | acc=0.9844 | L2-Norm=16.731 | L2-Norm(final)=2.999 | 4761.9 samples/s | 74.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 9.6] | Loss=0.01438 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.087 | L2-Norm(final)=3.201 | 3133.5 samples/s | 49.0 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.13679 | Reg=0.00299 | acc=0.9688 | L2-Norm=17.283 | L2-Norm(final)=3.091 | 3569.8 samples/s | 55.8 steps/s
[Step=2600 Epoch=10.0] | Loss=0.08199 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.405 | L2-Norm(final)=3.076 | 3699.6 samples/s | 57.8 steps/s
[Step=2650 Epoch=10.2] | Loss=0.05867 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.457 | L2-Norm(final)=3.077 | 3717.8 samples/s | 58.1 steps/s
[Step=2700 Epoch=10.4] | Loss=0.04559 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.479 | L2-Norm(final)=3.080 | 3718.5 samples/s | 58.1 steps/s
[Step=2750 Epoch=10.6] | Loss=0.03803 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.486 | L2-Norm(final)=3.084 | 4773.1 samples/s | 74.6 steps/s
[Step=2800 Epoch=10.8] | Loss=0.03207 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.488 | L2-Norm(final)=3.088 | 1434.7 samples/s | 22.4 steps/s
[Step=2850 Epoch=11.0] | Loss=0.02757 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.485 | L2-Norm(final)=3.092 | 3728.1 samples/s | 58.3 steps/s
[Step=2900 Epoch=11.2] | Loss=0.02420 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.478 | L2-Norm(final)=3.095 | 3670.8 samples/s | 57.4 steps/s
[Step=2950 Epoch=11.4] | Loss=0.02159 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.468 | L2-Norm(final)=3.099 | 3721.0 samples/s | 58.1 steps/s
[Step=3000 Epoch=11.5] | Loss=0.01946 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.457 | L2-Norm(final)=3.102 | 4212.2 samples/s | 65.8 steps/s
[Step=3050 Epoch=11.7] | Loss=0.01785 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.443 | L2-Norm(final)=3.105 | 1504.5 samples/s | 23.5 steps/s
[Step=3100 Epoch=11.9] | Loss=0.01638 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.430 | L2-Norm(final)=3.108 | 3773.0 samples/s | 59.0 steps/s
[Step=3150 Epoch=12.1] | Loss=0.01514 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.415 | L2-Norm(final)=3.110 | 3700.8 samples/s | 57.8 steps/s
[Step=3200 Epoch=12.3] | Loss=0.01407 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.399 | L2-Norm(final)=3.113 | 3726.1 samples/s | 58.2 steps/s
[Step=3250 Epoch=12.5] | Loss=0.01313 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.382 | L2-Norm(final)=3.115 | 3760.0 samples/s | 58.7 steps/s
[Step=3300 Epoch=12.7] | Loss=0.01232 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.365 | L2-Norm(final)=3.117 | 1593.6 samples/s | 24.9 steps/s
[Step=3350 Epoch=12.9] | Loss=0.01159 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.347 | L2-Norm(final)=3.119 | 3667.9 samples/s | 57.3 steps/s
[Step=3400 Epoch=13.1] | Loss=0.01095 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.328 | L2-Norm(final)=3.121 | 3736.0 samples/s | 58.4 steps/s
[Step=3450 Epoch=13.3] | Loss=0.01038 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.309 | L2-Norm(final)=3.122 | 3740.8 samples/s | 58.5 steps/s
[Step=3500 Epoch=13.5] | Loss=0.00986 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.290 | L2-Norm(final)=3.124 | 3719.4 samples/s | 58.1 steps/s
[Step=3550 Epoch=13.7] | Loss=0.00939 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.270 | L2-Norm(final)=3.125 | 1586.1 samples/s | 24.8 steps/s
[Step=3600 Epoch=13.9] | Loss=0.00897 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.250 | L2-Norm(final)=3.127 | 3771.5 samples/s | 58.9 steps/s
[Step=3650 Epoch=14.1] | Loss=0.00858 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.230 | L2-Norm(final)=3.128 | 3724.8 samples/s | 58.2 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00822 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.209 | L2-Norm(final)=3.129 | 3725.5 samples/s | 58.2 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00789 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.189 | L2-Norm(final)=3.130 | 3742.2 samples/s | 58.5 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00759 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.168 | L2-Norm(final)=3.131 | 5562.6 samples/s | 86.9 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00731 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.147 | L2-Norm(final)=3.132 | 1414.0 samples/s | 22.1 steps/s
[Step=3900 Epoch=15.0] | Loss=0.00705 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.125 | L2-Norm(final)=3.133 | 3738.1 samples/s | 58.4 steps/s
[Step=3950 Epoch=15.2] | Loss=0.00681 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.104 | L2-Norm(final)=3.134 | 3692.8 samples/s | 57.7 steps/s
[Step=4000 Epoch=15.4] | Loss=0.00658 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.082 | L2-Norm(final)=3.135 | 3701.3 samples/s | 57.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08166 | acc=0.9409 | tpr=0.9416 | fpr=0.0605 | 3574.5 samples/s | 14.0 steps/s
Avg test loss: 0.08318, Avg test acc: 0.93938, Avg tpr: 0.93886, Avg fpr: 0.05948, total FA: 464

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07843 | acc=0.9435 | tpr=0.9437 | fpr=0.0570 | 3533.1 samples/s | 13.8 steps/s
Avg test loss: 0.08302, Avg test acc: 0.94142, Avg tpr: 0.94107, Avg fpr: 0.05781, total FA: 451

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.00917 | acc=0.3090 | tpr=0.0179 | fpr=0.0590 | 3535.0 samples/s | 13.8 steps/s
Avg test loss: 4.01760, Avg test acc: 0.30720, Avg tpr: 0.01853, Avg fpr: 0.05794, total FA: 452

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.40477 | acc=0.3038 | tpr=0.0212 | fpr=0.0825 | 3521.0 samples/s | 13.8 steps/s
Avg test loss: 4.40893, Avg test acc: 0.30075, Avg tpr: 0.02122, Avg fpr: 0.08448, total FA: 659

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.30811 | acc=0.1338 | tpr=0.7257 | fpr=0.8768 | 3516.8 samples/s | 13.7 steps/s
[Step= 100] | Loss=3.29329 | acc=0.1344 | tpr=0.8038 | fpr=0.8781 | 6820.7 samples/s | 26.6 steps/s
[Step= 150] | Loss=3.30012 | acc=0.1329 | tpr=0.7954 | fpr=0.8792 | 6873.6 samples/s | 26.9 steps/s
[Step= 200] | Loss=3.29172 | acc=0.1326 | tpr=0.7869 | fpr=0.8793 | 6864.1 samples/s | 26.8 steps/s
[Step= 250] | Loss=3.29697 | acc=0.1322 | tpr=0.7747 | fpr=0.8795 | 7100.9 samples/s | 27.7 steps/s
[Step= 300] | Loss=3.29980 | acc=0.1314 | tpr=0.7724 | fpr=0.8803 | 6783.8 samples/s | 26.5 steps/s
[Step= 350] | Loss=3.29451 | acc=0.1319 | tpr=0.7733 | fpr=0.8797 | 6853.9 samples/s | 26.8 steps/s
[Step= 400] | Loss=3.29291 | acc=0.1318 | tpr=0.7708 | fpr=0.8798 | 6716.9 samples/s | 26.2 steps/s
[Step= 450] | Loss=3.29361 | acc=0.1320 | tpr=0.7760 | fpr=0.8797 | 6961.1 samples/s | 27.2 steps/s
[Step= 500] | Loss=3.29329 | acc=0.1318 | tpr=0.7771 | fpr=0.8799 | 6719.6 samples/s | 26.2 steps/s
[Step= 550] | Loss=3.29293 | acc=0.1317 | tpr=0.7807 | fpr=0.8801 | 12873.8 samples/s | 50.3 steps/s
Avg test loss: 3.29378, Avg test acc: 0.13162, Avg tpr: 0.78090, Avg fpr: 0.88018, total FA: 122211

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.46186 | acc=0.1220 | tpr=0.8805 | fpr=0.8917 | 3517.5 samples/s | 13.7 steps/s
[Step= 100] | Loss=3.46002 | acc=0.1215 | tpr=0.8785 | fpr=0.8926 | 6628.7 samples/s | 25.9 steps/s
[Step= 150] | Loss=3.45980 | acc=0.1211 | tpr=0.8934 | fpr=0.8931 | 6976.2 samples/s | 27.3 steps/s
[Step= 200] | Loss=3.45752 | acc=0.1212 | tpr=0.8918 | fpr=0.8928 | 6812.9 samples/s | 26.6 steps/s
[Step= 250] | Loss=3.46317 | acc=0.1207 | tpr=0.8882 | fpr=0.8932 | 6761.5 samples/s | 26.4 steps/s
[Step= 300] | Loss=3.46706 | acc=0.1211 | tpr=0.8836 | fpr=0.8928 | 6687.0 samples/s | 26.1 steps/s
[Step= 350] | Loss=3.46934 | acc=0.1213 | tpr=0.8854 | fpr=0.8925 | 6877.3 samples/s | 26.9 steps/s
[Step= 400] | Loss=3.46812 | acc=0.1219 | tpr=0.8851 | fpr=0.8920 | 6892.1 samples/s | 26.9 steps/s
[Step= 450] | Loss=3.47137 | acc=0.1220 | tpr=0.8880 | fpr=0.8920 | 6463.2 samples/s | 25.2 steps/s
[Step= 500] | Loss=3.47093 | acc=0.1218 | tpr=0.8863 | fpr=0.8920 | 6773.7 samples/s | 26.5 steps/s
[Step= 550] | Loss=3.47161 | acc=0.1218 | tpr=0.8894 | fpr=0.8921 | 12232.0 samples/s | 47.8 steps/s
Avg test loss: 3.47259, Avg test acc: 0.12179, Avg tpr: 0.88946, Avg fpr: 0.89216, total FA: 123875

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.07414 | acc=0.9833 | tpr=0.9292 | fpr=0.0157 | 3517.4 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.07710 | acc=0.9821 | tpr=0.9318 | fpr=0.0169 | 6806.5 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.08039 | acc=0.9810 | tpr=0.9294 | fpr=0.0181 | 6766.5 samples/s | 26.4 steps/s
[Step= 200] | Loss=0.08188 | acc=0.9807 | tpr=0.9311 | fpr=0.0184 | 6947.5 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.08054 | acc=0.9810 | tpr=0.9319 | fpr=0.0181 | 6856.7 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.08235 | acc=0.9807 | tpr=0.9316 | fpr=0.0184 | 7151.9 samples/s | 27.9 steps/s
[Step= 350] | Loss=0.08270 | acc=0.9804 | tpr=0.9317 | fpr=0.0187 | 6634.2 samples/s | 25.9 steps/s
[Step= 400] | Loss=0.08403 | acc=0.9801 | tpr=0.9278 | fpr=0.0189 | 6715.2 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.08632 | acc=0.9797 | tpr=0.9236 | fpr=0.0192 | 6901.3 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.08574 | acc=0.9798 | tpr=0.9260 | fpr=0.0192 | 6687.1 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.08545 | acc=0.9799 | tpr=0.9232 | fpr=0.0191 | 12745.7 samples/s | 49.8 steps/s
Avg test loss: 0.08525, Avg test acc: 0.97994, Avg tpr: 0.92353, Avg fpr: 0.01904, total FA: 2643

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.06966 | acc=0.9825 | tpr=0.9071 | fpr=0.0161 | 3480.9 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.07590 | acc=0.9812 | tpr=0.9382 | fpr=0.0180 | 7024.5 samples/s | 27.4 steps/s
[Step= 150] | Loss=0.07562 | acc=0.9804 | tpr=0.9409 | fpr=0.0189 | 6660.8 samples/s | 26.0 steps/s
[Step= 200] | Loss=0.07710 | acc=0.9805 | tpr=0.9475 | fpr=0.0189 | 6786.5 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.07659 | acc=0.9807 | tpr=0.9450 | fpr=0.0186 | 7022.3 samples/s | 27.4 steps/s
[Step= 300] | Loss=0.07843 | acc=0.9802 | tpr=0.9418 | fpr=0.0191 | 6933.7 samples/s | 27.1 steps/s
[Step= 350] | Loss=0.07949 | acc=0.9797 | tpr=0.9399 | fpr=0.0195 | 6897.6 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.08083 | acc=0.9795 | tpr=0.9371 | fpr=0.0197 | 6769.5 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.08228 | acc=0.9793 | tpr=0.9377 | fpr=0.0199 | 6614.0 samples/s | 25.8 steps/s
[Step= 500] | Loss=0.08201 | acc=0.9794 | tpr=0.9401 | fpr=0.0198 | 6771.7 samples/s | 26.5 steps/s
[Step= 550] | Loss=0.08140 | acc=0.9794 | tpr=0.9387 | fpr=0.0198 | 13033.5 samples/s | 50.9 steps/s
Avg test loss: 0.08114, Avg test acc: 0.97947, Avg tpr: 0.93859, Avg fpr: 0.01978, total FA: 2747

server round 2/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.28291 | Reg=0.00241 | acc=0.6875 | L2-Norm=15.516 | L2-Norm(final)=2.865 | 3137.0 samples/s | 49.0 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.14795 | Reg=0.00258 | acc=0.8906 | L2-Norm=16.062 | L2-Norm(final)=2.951 | 4001.1 samples/s | 62.5 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.13291 | Reg=0.00269 | acc=0.9062 | L2-Norm=16.397 | L2-Norm(final)=2.999 | 4383.0 samples/s | 68.5 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.12612 | Reg=0.00277 | acc=0.9531 | L2-Norm=16.625 | L2-Norm(final)=3.035 | 4391.8 samples/s | 68.6 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.12135 | Reg=0.00282 | acc=0.9062 | L2-Norm=16.795 | L2-Norm(final)=3.062 | 4378.3 samples/s | 68.4 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.11761 | Reg=0.00287 | acc=0.9844 | L2-Norm=16.924 | L2-Norm(final)=3.088 | 4356.0 samples/s | 68.1 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.11530 | Reg=0.00291 | acc=0.9375 | L2-Norm=17.036 | L2-Norm(final)=3.112 | 4312.3 samples/s | 67.4 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.11353 | Reg=0.00294 | acc=0.9688 | L2-Norm=17.141 | L2-Norm(final)=3.134 | 4417.4 samples/s | 69.0 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.11304 | Reg=0.00297 | acc=0.9219 | L2-Norm=17.235 | L2-Norm(final)=3.153 | 4380.9 samples/s | 68.5 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.11170 | Reg=0.00300 | acc=0.9062 | L2-Norm=17.323 | L2-Norm(final)=3.171 | 4404.2 samples/s | 68.8 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.11126 | Reg=0.00303 | acc=0.8906 | L2-Norm=17.403 | L2-Norm(final)=3.189 | 5589.7 samples/s | 87.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch= 8.8] | Loss=0.08255 | Reg=0.00331 | acc=0.9219 | L2-Norm=18.194 | L2-Norm(final)=3.356 | 3323.0 samples/s | 51.9 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.10083 | Reg=0.00333 | acc=0.9531 | L2-Norm=18.241 | L2-Norm(final)=3.359 | 3496.0 samples/s | 54.6 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.10102 | Reg=0.00333 | acc=0.9375 | L2-Norm=18.239 | L2-Norm(final)=3.345 | 3930.7 samples/s | 61.4 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.09509 | Reg=0.00333 | acc=0.9375 | L2-Norm=18.236 | L2-Norm(final)=3.336 | 4004.1 samples/s | 62.6 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.09221 | Reg=0.00332 | acc=0.9219 | L2-Norm=18.228 | L2-Norm(final)=3.329 | 3924.8 samples/s | 61.3 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.08747 | Reg=0.00332 | acc=0.9375 | L2-Norm=18.225 | L2-Norm(final)=3.323 | 3917.4 samples/s | 61.2 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.08526 | Reg=0.00332 | acc=0.9688 | L2-Norm=18.224 | L2-Norm(final)=3.318 | 3961.7 samples/s | 61.9 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.08353 | Reg=0.00332 | acc=0.9062 | L2-Norm=18.222 | L2-Norm(final)=3.313 | 3960.6 samples/s | 61.9 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.08000 | Reg=0.00332 | acc=0.9688 | L2-Norm=18.219 | L2-Norm(final)=3.309 | 3906.3 samples/s | 61.0 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.07752 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.217 | L2-Norm(final)=3.305 | 3953.7 samples/s | 61.8 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.07666 | Reg=0.00332 | acc=0.9688 | L2-Norm=18.212 | L2-Norm(final)=3.299 | 4774.6 samples/s | 74.6 steps/s
[Step=5050 Epoch= 9.8] | Loss=0.07345 | Reg=0.00332 | acc=0.9688 | L2-Norm=18.209 | L2-Norm(final)=3.296 | 1506.0 samples/s | 23.5 steps/s
[Step=5100 Epoch= 9.9] | Loss=0.07115 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.207 | L2-Norm(final)=3.294 | 3926.6 samples/s | 61.4 steps/s
[Step=5150 Epoch=10.0] | Loss=0.06922 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.204 | L2-Norm(final)=3.292 | 3956.6 samples/s | 61.8 steps/s
[Step=5200 Epoch=10.1] | Loss=0.06793 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.201 | L2-Norm(final)=3.289 | 3881.3 samples/s | 60.6 steps/s
[Step=5250 Epoch=10.2] | Loss=0.06658 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.199 | L2-Norm(final)=3.286 | 3896.8 samples/s | 60.9 steps/s
[Step=5300 Epoch=10.3] | Loss=0.06512 | Reg=0.00331 | acc=0.9375 | L2-Norm=18.197 | L2-Norm(final)=3.283 | 3958.8 samples/s | 61.9 steps/s
[Step=5350 Epoch=10.4] | Loss=0.06458 | Reg=0.00331 | acc=0.9219 | L2-Norm=18.195 | L2-Norm(final)=3.281 | 3958.0 samples/s | 61.8 steps/s
[Step=5400 Epoch=10.5] | Loss=0.06355 | Reg=0.00331 | acc=0.9375 | L2-Norm=18.194 | L2-Norm(final)=3.279 | 3864.5 samples/s | 60.4 steps/s
[Step=5450 Epoch=10.6] | Loss=0.06308 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.194 | L2-Norm(final)=3.277 | 3920.7 samples/s | 61.3 steps/s
[Step=5500 Epoch=10.7] | Loss=0.06230 | Reg=0.00331 | acc=0.9531 | L2-Norm=18.194 | L2-Norm(final)=3.275 | 4164.3 samples/s | 65.1 steps/s
[Step=5550 Epoch=10.8] | Loss=0.06110 | Reg=0.00331 | acc=0.9688 | L2-Norm=18.195 | L2-Norm(final)=3.273 | 1570.9 samples/s | 24.5 steps/s
[Step=5600 Epoch=10.9] | Loss=0.05974 | Reg=0.00331 | acc=0.9688 | L2-Norm=18.196 | L2-Norm(final)=3.272 | 3895.4 samples/s | 60.9 steps/s
[Step=5650 Epoch=11.0] | Loss=0.05850 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.199 | L2-Norm(final)=3.272 | 3875.2 samples/s | 60.5 steps/s
[Step=5700 Epoch=11.1] | Loss=0.05774 | Reg=0.00331 | acc=0.9688 | L2-Norm=18.201 | L2-Norm(final)=3.271 | 3915.3 samples/s | 61.2 steps/s
[Step=5750 Epoch=11.2] | Loss=0.05702 | Reg=0.00331 | acc=0.9531 | L2-Norm=18.204 | L2-Norm(final)=3.270 | 3922.8 samples/s | 61.3 steps/s
[Step=5800 Epoch=11.3] | Loss=0.05609 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.207 | L2-Norm(final)=3.269 | 3927.6 samples/s | 61.4 steps/s
[Step=5850 Epoch=11.4] | Loss=0.05570 | Reg=0.00332 | acc=0.9844 | L2-Norm=18.210 | L2-Norm(final)=3.268 | 3971.3 samples/s | 62.1 steps/s
[Step=5900 Epoch=11.5] | Loss=0.05483 | Reg=0.00332 | acc=0.9688 | L2-Norm=18.212 | L2-Norm(final)=3.266 | 3912.5 samples/s | 61.1 steps/s
[Step=5950 Epoch=11.6] | Loss=0.05394 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.215 | L2-Norm(final)=3.265 | 3890.3 samples/s | 60.8 steps/s
[Step=6000 Epoch=11.7] | Loss=0.05334 | Reg=0.00332 | acc=0.9844 | L2-Norm=18.218 | L2-Norm(final)=3.264 | 3905.6 samples/s | 61.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step6000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.31480 | Reg=0.00241 | acc=0.6406 | L2-Norm=15.516 | L2-Norm(final)=2.883 | 3402.6 samples/s | 53.2 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.15753 | Reg=0.00255 | acc=0.8906 | L2-Norm=15.952 | L2-Norm(final)=2.963 | 4069.1 samples/s | 63.6 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.14282 | Reg=0.00263 | acc=0.9062 | L2-Norm=16.206 | L2-Norm(final)=3.001 | 4362.9 samples/s | 68.2 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.13373 | Reg=0.00268 | acc=0.9062 | L2-Norm=16.373 | L2-Norm(final)=3.029 | 4279.9 samples/s | 66.9 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.12946 | Reg=0.00273 | acc=0.9531 | L2-Norm=16.509 | L2-Norm(final)=3.052 | 4437.9 samples/s | 69.3 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.12722 | Reg=0.00277 | acc=0.8906 | L2-Norm=16.633 | L2-Norm(final)=3.076 | 4312.4 samples/s | 67.4 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.12330 | Reg=0.00280 | acc=0.9688 | L2-Norm=16.737 | L2-Norm(final)=3.097 | 4384.9 samples/s | 68.5 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.12114 | Reg=0.00283 | acc=0.9531 | L2-Norm=16.828 | L2-Norm(final)=3.118 | 4352.2 samples/s | 68.0 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.11939 | Reg=0.00286 | acc=0.7969 | L2-Norm=16.915 | L2-Norm(final)=3.138 | 4295.6 samples/s | 67.1 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.11740 | Reg=0.00289 | acc=0.9062 | L2-Norm=16.996 | L2-Norm(final)=3.157 | 4336.4 samples/s | 67.8 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.11544 | Reg=0.00292 | acc=0.9062 | L2-Norm=17.070 | L2-Norm(final)=3.175 | 5558.9 samples/s | 86.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch= 8.8] | Loss=0.09859 | Reg=0.00317 | acc=0.9062 | L2-Norm=17.791 | L2-Norm(final)=3.359 | 3353.5 samples/s | 52.4 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.10146 | Reg=0.00318 | acc=0.9062 | L2-Norm=17.827 | L2-Norm(final)=3.364 | 3847.5 samples/s | 60.1 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.09366 | Reg=0.00318 | acc=0.9375 | L2-Norm=17.831 | L2-Norm(final)=3.351 | 3923.5 samples/s | 61.3 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.09089 | Reg=0.00318 | acc=0.9688 | L2-Norm=17.837 | L2-Norm(final)=3.344 | 3944.8 samples/s | 61.6 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.08764 | Reg=0.00318 | acc=0.9688 | L2-Norm=17.843 | L2-Norm(final)=3.336 | 3935.7 samples/s | 61.5 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.08450 | Reg=0.00319 | acc=0.9688 | L2-Norm=17.853 | L2-Norm(final)=3.331 | 3943.1 samples/s | 61.6 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.08386 | Reg=0.00319 | acc=0.9688 | L2-Norm=17.865 | L2-Norm(final)=3.327 | 3898.9 samples/s | 60.9 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.08180 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.878 | L2-Norm(final)=3.323 | 3951.6 samples/s | 61.7 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.07967 | Reg=0.00320 | acc=0.9219 | L2-Norm=17.888 | L2-Norm(final)=3.321 | 3952.7 samples/s | 61.8 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.07762 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.898 | L2-Norm(final)=3.319 | 3938.6 samples/s | 61.5 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.07558 | Reg=0.00321 | acc=0.9688 | L2-Norm=17.907 | L2-Norm(final)=3.318 | 4832.0 samples/s | 75.5 steps/s
[Step=5050 Epoch= 9.9] | Loss=0.07304 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.918 | L2-Norm(final)=3.317 | 1518.9 samples/s | 23.7 steps/s
[Step=5100 Epoch=10.0] | Loss=0.07021 | Reg=0.00321 | acc=0.9688 | L2-Norm=17.929 | L2-Norm(final)=3.317 | 3888.9 samples/s | 60.8 steps/s
[Step=5150 Epoch=10.1] | Loss=0.06821 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.940 | L2-Norm(final)=3.317 | 3917.0 samples/s | 61.2 steps/s
[Step=5200 Epoch=10.2] | Loss=0.06681 | Reg=0.00322 | acc=0.9688 | L2-Norm=17.949 | L2-Norm(final)=3.317 | 3934.3 samples/s | 61.5 steps/s
[Step=5250 Epoch=10.3] | Loss=0.06527 | Reg=0.00323 | acc=0.9531 | L2-Norm=17.959 | L2-Norm(final)=3.317 | 3926.6 samples/s | 61.4 steps/s
[Step=5300 Epoch=10.4] | Loss=0.06443 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.969 | L2-Norm(final)=3.316 | 3941.8 samples/s | 61.6 steps/s
[Step=5350 Epoch=10.5] | Loss=0.06379 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.979 | L2-Norm(final)=3.316 | 3925.9 samples/s | 61.3 steps/s
[Step=5400 Epoch=10.6] | Loss=0.06263 | Reg=0.00324 | acc=0.9688 | L2-Norm=17.989 | L2-Norm(final)=3.315 | 3950.2 samples/s | 61.7 steps/s
[Step=5450 Epoch=10.7] | Loss=0.06179 | Reg=0.00324 | acc=0.9531 | L2-Norm=17.998 | L2-Norm(final)=3.313 | 3946.2 samples/s | 61.7 steps/s
[Step=5500 Epoch=10.8] | Loss=0.06096 | Reg=0.00324 | acc=0.9531 | L2-Norm=18.007 | L2-Norm(final)=3.312 | 4278.3 samples/s | 66.8 steps/s
[Step=5550 Epoch=10.9] | Loss=0.05986 | Reg=0.00325 | acc=0.9688 | L2-Norm=18.018 | L2-Norm(final)=3.311 | 1570.0 samples/s | 24.5 steps/s
[Step=5600 Epoch=10.9] | Loss=0.05832 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.028 | L2-Norm(final)=3.312 | 3983.7 samples/s | 62.2 steps/s
[Step=5650 Epoch=11.0] | Loss=0.05761 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.039 | L2-Norm(final)=3.312 | 3884.3 samples/s | 60.7 steps/s
[Step=5700 Epoch=11.1] | Loss=0.05690 | Reg=0.00326 | acc=0.9688 | L2-Norm=18.049 | L2-Norm(final)=3.311 | 3922.9 samples/s | 61.3 steps/s
[Step=5750 Epoch=11.2] | Loss=0.05604 | Reg=0.00326 | acc=0.9688 | L2-Norm=18.059 | L2-Norm(final)=3.311 | 3912.4 samples/s | 61.1 steps/s
[Step=5800 Epoch=11.3] | Loss=0.05538 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.069 | L2-Norm(final)=3.311 | 3979.3 samples/s | 62.2 steps/s
[Step=5850 Epoch=11.4] | Loss=0.05469 | Reg=0.00327 | acc=0.9531 | L2-Norm=18.079 | L2-Norm(final)=3.310 | 3960.6 samples/s | 61.9 steps/s
[Step=5900 Epoch=11.5] | Loss=0.05442 | Reg=0.00327 | acc=0.9531 | L2-Norm=18.088 | L2-Norm(final)=3.309 | 3953.2 samples/s | 61.8 steps/s
[Step=5950 Epoch=11.6] | Loss=0.05382 | Reg=0.00328 | acc=0.9688 | L2-Norm=18.097 | L2-Norm(final)=3.308 | 3915.5 samples/s | 61.2 steps/s
[Step=6000 Epoch=11.7] | Loss=0.05315 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.106 | L2-Norm(final)=3.307 | 3962.7 samples/s | 61.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step6000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=4001 Epoch=15.3] | Loss=0.08023 | Reg=0.00241 | acc=0.9531 | L2-Norm=15.516 | L2-Norm(final)=3.339 | 3255.7 samples/s | 50.9 steps/s
[Step=4050 Epoch=15.5] | Loss=0.03666 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.833 | L2-Norm(final)=3.424 | 3816.4 samples/s | 59.6 steps/s
[Step=4100 Epoch=15.7] | Loss=0.03361 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.992 | L2-Norm(final)=3.452 | 4134.6 samples/s | 64.6 steps/s
[Step=4150 Epoch=15.9] | Loss=0.03137 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.106 | L2-Norm(final)=3.472 | 4182.4 samples/s | 65.4 steps/s
[Step=4200 Epoch=16.1] | Loss=0.02889 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.203 | L2-Norm(final)=3.494 | 4118.8 samples/s | 64.4 steps/s
[Step=4250 Epoch=16.3] | Loss=0.02662 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.302 | L2-Norm(final)=3.518 | 5379.0 samples/s | 84.0 steps/s
[Step=4300 Epoch=16.5] | Loss=0.02502 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.382 | L2-Norm(final)=3.542 | 1527.9 samples/s | 23.9 steps/s
[Step=4350 Epoch=16.7] | Loss=0.02347 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.459 | L2-Norm(final)=3.567 | 4049.9 samples/s | 63.3 steps/s
[Step=4400 Epoch=16.9] | Loss=0.02245 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.530 | L2-Norm(final)=3.591 | 4135.1 samples/s | 64.6 steps/s
[Step=4450 Epoch=17.1] | Loss=0.02151 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.594 | L2-Norm(final)=3.615 | 4123.6 samples/s | 64.4 steps/s
[Step=4500 Epoch=17.2] | Loss=0.02035 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.652 | L2-Norm(final)=3.640 | 4700.4 samples/s | 73.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=17.2] | Loss=0.00309 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.203 | L2-Norm(final)=3.892 | 3237.7 samples/s | 50.6 steps/s
[Step=4550 Epoch=17.4] | Loss=0.04430 | Reg=0.00299 | acc=0.9844 | L2-Norm=17.278 | L2-Norm(final)=3.878 | 3533.9 samples/s | 55.2 steps/s
[Step=4600 Epoch=17.6] | Loss=0.03263 | Reg=0.00300 | acc=0.9688 | L2-Norm=17.319 | L2-Norm(final)=3.826 | 3797.1 samples/s | 59.3 steps/s
[Step=4650 Epoch=17.8] | Loss=0.02524 | Reg=0.00300 | acc=0.9844 | L2-Norm=17.325 | L2-Norm(final)=3.811 | 3784.5 samples/s | 59.1 steps/s
[Step=4700 Epoch=18.0] | Loss=0.02084 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.317 | L2-Norm(final)=3.804 | 3720.2 samples/s | 58.1 steps/s
[Step=4750 Epoch=18.2] | Loss=0.01783 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.303 | L2-Norm(final)=3.802 | 4711.4 samples/s | 73.6 steps/s
[Step=4800 Epoch=18.4] | Loss=0.01501 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.284 | L2-Norm(final)=3.802 | 1495.0 samples/s | 23.4 steps/s
[Step=4850 Epoch=18.6] | Loss=0.01292 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.262 | L2-Norm(final)=3.803 | 3654.3 samples/s | 57.1 steps/s
[Step=4900 Epoch=18.8] | Loss=0.01133 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.238 | L2-Norm(final)=3.805 | 3734.9 samples/s | 58.4 steps/s
[Step=4950 Epoch=19.0] | Loss=0.01010 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.212 | L2-Norm(final)=3.807 | 3778.4 samples/s | 59.0 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00912 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.186 | L2-Norm(final)=3.809 | 4109.9 samples/s | 64.2 steps/s
[Step=5050 Epoch=19.3] | Loss=0.00830 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.158 | L2-Norm(final)=3.811 | 1569.7 samples/s | 24.5 steps/s
[Step=5100 Epoch=19.5] | Loss=0.00761 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.130 | L2-Norm(final)=3.814 | 3746.0 samples/s | 58.5 steps/s
[Step=5150 Epoch=19.7] | Loss=0.00703 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.101 | L2-Norm(final)=3.815 | 3744.6 samples/s | 58.5 steps/s
[Step=5200 Epoch=19.9] | Loss=0.00653 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.072 | L2-Norm(final)=3.817 | 3707.5 samples/s | 57.9 steps/s
[Step=5250 Epoch=20.1] | Loss=0.00610 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.042 | L2-Norm(final)=3.819 | 3740.4 samples/s | 58.4 steps/s
[Step=5300 Epoch=20.3] | Loss=0.00572 | Reg=0.00289 | acc=1.0000 | L2-Norm=17.012 | L2-Norm(final)=3.820 | 1591.8 samples/s | 24.9 steps/s
[Step=5350 Epoch=20.5] | Loss=0.00538 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.981 | L2-Norm(final)=3.822 | 3837.3 samples/s | 60.0 steps/s
[Step=5400 Epoch=20.7] | Loss=0.00509 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.951 | L2-Norm(final)=3.823 | 3751.4 samples/s | 58.6 steps/s
[Step=5450 Epoch=20.9] | Loss=0.00482 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.920 | L2-Norm(final)=3.825 | 3735.4 samples/s | 58.4 steps/s
[Step=5500 Epoch=21.1] | Loss=0.00458 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.889 | L2-Norm(final)=3.826 | 3735.2 samples/s | 58.4 steps/s
[Step=5550 Epoch=21.3] | Loss=0.00436 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.858 | L2-Norm(final)=3.827 | 1616.5 samples/s | 25.3 steps/s
[Step=5600 Epoch=21.5] | Loss=0.00417 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.827 | L2-Norm(final)=3.829 | 3730.1 samples/s | 58.3 steps/s
[Step=5650 Epoch=21.6] | Loss=0.00398 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.796 | L2-Norm(final)=3.830 | 3784.4 samples/s | 59.1 steps/s
[Step=5700 Epoch=21.8] | Loss=0.00382 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.764 | L2-Norm(final)=3.831 | 3782.3 samples/s | 59.1 steps/s
[Step=5750 Epoch=22.0] | Loss=0.00367 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.733 | L2-Norm(final)=3.832 | 3684.5 samples/s | 57.6 steps/s
[Step=5800 Epoch=22.2] | Loss=0.00353 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.702 | L2-Norm(final)=3.833 | 5127.6 samples/s | 80.1 steps/s
[Step=5850 Epoch=22.4] | Loss=0.00340 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.671 | L2-Norm(final)=3.834 | 1444.8 samples/s | 22.6 steps/s
[Step=5900 Epoch=22.6] | Loss=0.00328 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.639 | L2-Norm(final)=3.836 | 3761.0 samples/s | 58.8 steps/s
[Step=5950 Epoch=22.8] | Loss=0.00316 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.608 | L2-Norm(final)=3.837 | 3752.3 samples/s | 58.6 steps/s
[Step=6000 Epoch=23.0] | Loss=0.00306 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.576 | L2-Norm(final)=3.838 | 3792.6 samples/s | 59.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step6000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=4001 Epoch=15.4] | Loss=0.09333 | Reg=0.00241 | acc=0.9062 | L2-Norm=15.516 | L2-Norm(final)=3.162 | 3322.7 samples/s | 51.9 steps/s
[Step=4050 Epoch=15.6] | Loss=0.04243 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.784 | L2-Norm(final)=3.235 | 3779.0 samples/s | 59.0 steps/s
[Step=4100 Epoch=15.8] | Loss=0.03747 | Reg=0.00255 | acc=0.9531 | L2-Norm=15.981 | L2-Norm(final)=3.275 | 4123.7 samples/s | 64.4 steps/s
[Step=4150 Epoch=16.0] | Loss=0.03335 | Reg=0.00260 | acc=0.9531 | L2-Norm=16.120 | L2-Norm(final)=3.312 | 4053.0 samples/s | 63.3 steps/s
[Step=4200 Epoch=16.2] | Loss=0.03166 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.227 | L2-Norm(final)=3.342 | 4121.0 samples/s | 64.4 steps/s
[Step=4250 Epoch=16.4] | Loss=0.03057 | Reg=0.00267 | acc=0.9688 | L2-Norm=16.324 | L2-Norm(final)=3.372 | 5479.0 samples/s | 85.6 steps/s
[Step=4300 Epoch=16.6] | Loss=0.02924 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.413 | L2-Norm(final)=3.397 | 1526.0 samples/s | 23.8 steps/s
[Step=4350 Epoch=16.7] | Loss=0.02788 | Reg=0.00272 | acc=0.9688 | L2-Norm=16.493 | L2-Norm(final)=3.423 | 4141.6 samples/s | 64.7 steps/s
[Step=4400 Epoch=16.9] | Loss=0.02631 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.563 | L2-Norm(final)=3.448 | 4146.2 samples/s | 64.8 steps/s
[Step=4450 Epoch=17.1] | Loss=0.02485 | Reg=0.00277 | acc=0.9844 | L2-Norm=16.626 | L2-Norm(final)=3.476 | 4073.2 samples/s | 63.6 steps/s
[Step=4500 Epoch=17.3] | Loss=0.02387 | Reg=0.00279 | acc=0.9844 | L2-Norm=16.686 | L2-Norm(final)=3.505 | 4776.0 samples/s | 74.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=17.3] | Loss=0.01727 | Reg=0.00299 | acc=0.9844 | L2-Norm=17.281 | L2-Norm(final)=3.794 | 3284.7 samples/s | 51.3 steps/s
[Step=4550 Epoch=17.5] | Loss=0.03858 | Reg=0.00301 | acc=0.9688 | L2-Norm=17.360 | L2-Norm(final)=3.777 | 3562.4 samples/s | 55.7 steps/s
[Step=4600 Epoch=17.7] | Loss=0.03257 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.409 | L2-Norm(final)=3.739 | 3718.4 samples/s | 58.1 steps/s
[Step=4650 Epoch=17.9] | Loss=0.02429 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.418 | L2-Norm(final)=3.730 | 3691.3 samples/s | 57.7 steps/s
[Step=4700 Epoch=18.1] | Loss=0.01961 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.412 | L2-Norm(final)=3.729 | 3670.2 samples/s | 57.3 steps/s
[Step=4750 Epoch=18.3] | Loss=0.01763 | Reg=0.00303 | acc=0.9531 | L2-Norm=17.402 | L2-Norm(final)=3.730 | 4732.2 samples/s | 73.9 steps/s
[Step=4800 Epoch=18.5] | Loss=0.01524 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.389 | L2-Norm(final)=3.730 | 1442.6 samples/s | 22.5 steps/s
[Step=4850 Epoch=18.7] | Loss=0.01315 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.372 | L2-Norm(final)=3.732 | 3680.9 samples/s | 57.5 steps/s
[Step=4900 Epoch=18.9] | Loss=0.01169 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.351 | L2-Norm(final)=3.734 | 3704.2 samples/s | 57.9 steps/s
[Step=4950 Epoch=19.1] | Loss=0.01042 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.327 | L2-Norm(final)=3.736 | 3702.5 samples/s | 57.9 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00940 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.302 | L2-Norm(final)=3.738 | 4194.8 samples/s | 65.5 steps/s
[Step=5050 Epoch=19.4] | Loss=0.00855 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.275 | L2-Norm(final)=3.740 | 1527.4 samples/s | 23.9 steps/s
[Step=5100 Epoch=19.6] | Loss=0.00784 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.247 | L2-Norm(final)=3.742 | 3720.0 samples/s | 58.1 steps/s
[Step=5150 Epoch=19.8] | Loss=0.00724 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.219 | L2-Norm(final)=3.744 | 3771.4 samples/s | 58.9 steps/s
[Step=5200 Epoch=20.0] | Loss=0.00673 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.190 | L2-Norm(final)=3.745 | 3705.2 samples/s | 57.9 steps/s
[Step=5250 Epoch=20.2] | Loss=0.00628 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.160 | L2-Norm(final)=3.747 | 3820.7 samples/s | 59.7 steps/s
[Step=5300 Epoch=20.4] | Loss=0.00589 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.130 | L2-Norm(final)=3.749 | 1565.2 samples/s | 24.5 steps/s
[Step=5350 Epoch=20.6] | Loss=0.00555 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.100 | L2-Norm(final)=3.750 | 3724.8 samples/s | 58.2 steps/s
[Step=5400 Epoch=20.8] | Loss=0.00524 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.069 | L2-Norm(final)=3.751 | 3734.3 samples/s | 58.3 steps/s
[Step=5450 Epoch=21.0] | Loss=0.00496 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.038 | L2-Norm(final)=3.753 | 3711.3 samples/s | 58.0 steps/s
[Step=5500 Epoch=21.2] | Loss=0.00472 | Reg=0.00289 | acc=1.0000 | L2-Norm=17.008 | L2-Norm(final)=3.754 | 3658.2 samples/s | 57.2 steps/s
[Step=5550 Epoch=21.4] | Loss=0.00449 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.977 | L2-Norm(final)=3.755 | 1615.7 samples/s | 25.2 steps/s
[Step=5600 Epoch=21.6] | Loss=0.00429 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.945 | L2-Norm(final)=3.756 | 3701.7 samples/s | 57.8 steps/s
[Step=5650 Epoch=21.7] | Loss=0.00411 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.914 | L2-Norm(final)=3.757 | 3745.8 samples/s | 58.5 steps/s
[Step=5700 Epoch=21.9] | Loss=0.00394 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.883 | L2-Norm(final)=3.758 | 3753.5 samples/s | 58.6 steps/s
[Step=5750 Epoch=22.1] | Loss=0.00378 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.852 | L2-Norm(final)=3.759 | 3750.1 samples/s | 58.6 steps/s
[Step=5800 Epoch=22.3] | Loss=0.00363 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.820 | L2-Norm(final)=3.760 | 5467.0 samples/s | 85.4 steps/s
[Step=5850 Epoch=22.5] | Loss=0.00350 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.789 | L2-Norm(final)=3.761 | 1424.1 samples/s | 22.3 steps/s
[Step=5900 Epoch=22.7] | Loss=0.00338 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.758 | L2-Norm(final)=3.762 | 3711.0 samples/s | 58.0 steps/s
[Step=5950 Epoch=22.9] | Loss=0.00326 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.726 | L2-Norm(final)=3.763 | 3696.9 samples/s | 57.8 steps/s
[Step=6000 Epoch=23.1] | Loss=0.00315 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.695 | L2-Norm(final)=3.764 | 3747.0 samples/s | 58.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step6000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07007 | acc=0.9548 | tpr=0.9601 | fpr=0.0565 | 3515.8 samples/s | 13.7 steps/s
Avg test loss: 0.07128, Avg test acc: 0.95360, Avg tpr: 0.95920, Avg fpr: 0.05871, total FA: 458

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07032 | acc=0.9542 | tpr=0.9670 | fpr=0.0736 | 3507.4 samples/s | 13.7 steps/s
Avg test loss: 0.07313, Avg test acc: 0.95208, Avg tpr: 0.96433, Avg fpr: 0.07486, total FA: 584

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=3.85750 | acc=0.3086 | tpr=0.0167 | fpr=0.0575 | 3522.4 samples/s | 13.8 steps/s
Avg test loss: 3.88124, Avg test acc: 0.30543, Avg tpr: 0.01626, Avg fpr: 0.05858, total FA: 457

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.23263 | acc=0.3082 | tpr=0.0156 | fpr=0.0565 | 3524.1 samples/s | 13.8 steps/s
Avg test loss: 4.24871, Avg test acc: 0.30740, Avg tpr: 0.01597, Avg fpr: 0.05166, total FA: 403

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.36029 | acc=0.1026 | tpr=0.8407 | fpr=0.9107 | 3543.3 samples/s | 13.8 steps/s
[Step= 100] | Loss=4.33950 | acc=0.1048 | tpr=0.8550 | fpr=0.9092 | 6814.3 samples/s | 26.6 steps/s
[Step= 150] | Loss=4.34335 | acc=0.1038 | tpr=0.8516 | fpr=0.9100 | 7014.4 samples/s | 27.4 steps/s
[Step= 200] | Loss=4.33252 | acc=0.1036 | tpr=0.8514 | fpr=0.9101 | 6961.9 samples/s | 27.2 steps/s
[Step= 250] | Loss=4.33712 | acc=0.1035 | tpr=0.8489 | fpr=0.9101 | 6884.0 samples/s | 26.9 steps/s
[Step= 300] | Loss=4.34264 | acc=0.1032 | tpr=0.8531 | fpr=0.9105 | 6924.9 samples/s | 27.1 steps/s
[Step= 350] | Loss=4.33679 | acc=0.1037 | tpr=0.8597 | fpr=0.9101 | 7012.1 samples/s | 27.4 steps/s
[Step= 400] | Loss=4.33553 | acc=0.1037 | tpr=0.8556 | fpr=0.9099 | 6878.9 samples/s | 26.9 steps/s
[Step= 450] | Loss=4.33579 | acc=0.1035 | tpr=0.8564 | fpr=0.9102 | 6746.6 samples/s | 26.4 steps/s
[Step= 500] | Loss=4.33388 | acc=0.1036 | tpr=0.8581 | fpr=0.9100 | 7041.4 samples/s | 27.5 steps/s
[Step= 550] | Loss=4.33462 | acc=0.1037 | tpr=0.8548 | fpr=0.9099 | 12085.4 samples/s | 47.2 steps/s
Avg test loss: 4.33546, Avg test acc: 0.10361, Avg tpr: 0.85499, Avg fpr: 0.91005, total FA: 126358

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.45480 | acc=0.0691 | tpr=0.9248 | fpr=0.9463 | 3526.3 samples/s | 13.8 steps/s
[Step= 100] | Loss=5.43326 | acc=0.0693 | tpr=0.9019 | fpr=0.9462 | 7016.3 samples/s | 27.4 steps/s
[Step= 150] | Loss=5.44139 | acc=0.0689 | tpr=0.8991 | fpr=0.9464 | 6809.5 samples/s | 26.6 steps/s
[Step= 200] | Loss=5.43133 | acc=0.0689 | tpr=0.9027 | fpr=0.9462 | 6889.7 samples/s | 26.9 steps/s
[Step= 250] | Loss=5.43436 | acc=0.0691 | tpr=0.8952 | fpr=0.9460 | 6731.9 samples/s | 26.3 steps/s
[Step= 300] | Loss=5.43495 | acc=0.0692 | tpr=0.8953 | fpr=0.9459 | 6990.3 samples/s | 27.3 steps/s
[Step= 350] | Loss=5.43480 | acc=0.0689 | tpr=0.8929 | fpr=0.9461 | 6861.8 samples/s | 26.8 steps/s
[Step= 400] | Loss=5.43330 | acc=0.0691 | tpr=0.8922 | fpr=0.9459 | 6736.3 samples/s | 26.3 steps/s
[Step= 450] | Loss=5.43664 | acc=0.0691 | tpr=0.8953 | fpr=0.9458 | 6723.5 samples/s | 26.3 steps/s
[Step= 500] | Loss=5.43527 | acc=0.0689 | tpr=0.8934 | fpr=0.9460 | 6744.1 samples/s | 26.3 steps/s
[Step= 550] | Loss=5.43656 | acc=0.0688 | tpr=0.8922 | fpr=0.9462 | 12283.0 samples/s | 48.0 steps/s
Avg test loss: 5.43730, Avg test acc: 0.06878, Avg tpr: 0.89223, Avg fpr: 0.94619, total FA: 131377

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08945 | acc=0.9807 | tpr=0.9071 | fpr=0.0180 | 3486.1 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.09071 | acc=0.9802 | tpr=0.9318 | fpr=0.0189 | 7025.1 samples/s | 27.4 steps/s
[Step= 150] | Loss=0.09351 | acc=0.9797 | tpr=0.9308 | fpr=0.0194 | 6589.7 samples/s | 25.7 steps/s
[Step= 200] | Loss=0.09601 | acc=0.9795 | tpr=0.9322 | fpr=0.0196 | 6794.2 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.09453 | acc=0.9797 | tpr=0.9328 | fpr=0.0194 | 6914.8 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.09626 | acc=0.9792 | tpr=0.9345 | fpr=0.0200 | 6913.7 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.09694 | acc=0.9790 | tpr=0.9349 | fpr=0.0202 | 6790.4 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.09870 | acc=0.9787 | tpr=0.9316 | fpr=0.0204 | 6646.1 samples/s | 26.0 steps/s
[Step= 450] | Loss=0.10072 | acc=0.9783 | tpr=0.9275 | fpr=0.0207 | 6840.2 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.09976 | acc=0.9785 | tpr=0.9304 | fpr=0.0206 | 6672.1 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.09919 | acc=0.9786 | tpr=0.9280 | fpr=0.0205 | 12586.7 samples/s | 49.2 steps/s
Avg test loss: 0.09895, Avg test acc: 0.97864, Avg tpr: 0.92789, Avg fpr: 0.02044, total FA: 2838

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.06746 | acc=0.9825 | tpr=0.9336 | fpr=0.0166 | 3487.4 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.06888 | acc=0.9819 | tpr=0.9446 | fpr=0.0174 | 6859.3 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.07136 | acc=0.9811 | tpr=0.9496 | fpr=0.0183 | 7227.0 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.07228 | acc=0.9808 | tpr=0.9497 | fpr=0.0187 | 6521.2 samples/s | 25.5 steps/s
[Step= 250] | Loss=0.07089 | acc=0.9811 | tpr=0.9493 | fpr=0.0183 | 6978.0 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.07249 | acc=0.9809 | tpr=0.9484 | fpr=0.0185 | 6844.8 samples/s | 26.7 steps/s
[Step= 350] | Loss=0.07243 | acc=0.9808 | tpr=0.9461 | fpr=0.0186 | 6779.9 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.07287 | acc=0.9807 | tpr=0.9426 | fpr=0.0186 | 6971.3 samples/s | 27.2 steps/s
[Step= 450] | Loss=0.07419 | acc=0.9804 | tpr=0.9416 | fpr=0.0189 | 6782.7 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.07371 | acc=0.9805 | tpr=0.9419 | fpr=0.0188 | 6581.7 samples/s | 25.7 steps/s
[Step= 550] | Loss=0.07334 | acc=0.9806 | tpr=0.9415 | fpr=0.0187 | 12847.5 samples/s | 50.2 steps/s
Avg test loss: 0.07311, Avg test acc: 0.98057, Avg tpr: 0.94097, Avg fpr: 0.01871, total FA: 2598

server round 3/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=6001 Epoch=11.7] | Loss=0.13235 | Reg=0.00238 | acc=0.9219 | L2-Norm=15.431 | L2-Norm(final)=3.238 | 3092.7 samples/s | 48.3 steps/s
[Step=6050 Epoch=11.8] | Loss=0.09781 | Reg=0.00245 | acc=0.9375 | L2-Norm=15.654 | L2-Norm(final)=3.306 | 4154.9 samples/s | 64.9 steps/s
[Step=6100 Epoch=11.9] | Loss=0.09574 | Reg=0.00251 | acc=0.9062 | L2-Norm=15.837 | L2-Norm(final)=3.356 | 4322.4 samples/s | 67.5 steps/s
[Step=6150 Epoch=12.0] | Loss=0.09403 | Reg=0.00255 | acc=0.9375 | L2-Norm=15.961 | L2-Norm(final)=3.395 | 4349.3 samples/s | 68.0 steps/s
[Step=6200 Epoch=12.1] | Loss=0.09202 | Reg=0.00258 | acc=0.9219 | L2-Norm=16.073 | L2-Norm(final)=3.429 | 4362.9 samples/s | 68.2 steps/s
[Step=6250 Epoch=12.2] | Loss=0.09055 | Reg=0.00262 | acc=0.9219 | L2-Norm=16.173 | L2-Norm(final)=3.461 | 4415.5 samples/s | 69.0 steps/s
[Step=6300 Epoch=12.3] | Loss=0.08932 | Reg=0.00265 | acc=0.9531 | L2-Norm=16.263 | L2-Norm(final)=3.488 | 4364.4 samples/s | 68.2 steps/s
[Step=6350 Epoch=12.4] | Loss=0.08749 | Reg=0.00267 | acc=0.9375 | L2-Norm=16.345 | L2-Norm(final)=3.514 | 4392.7 samples/s | 68.6 steps/s
[Step=6400 Epoch=12.5] | Loss=0.08694 | Reg=0.00270 | acc=0.9375 | L2-Norm=16.420 | L2-Norm(final)=3.540 | 4473.1 samples/s | 69.9 steps/s
[Step=6450 Epoch=12.6] | Loss=0.08631 | Reg=0.00272 | acc=0.9688 | L2-Norm=16.491 | L2-Norm(final)=3.562 | 4349.7 samples/s | 68.0 steps/s
[Step=6500 Epoch=12.7] | Loss=0.08525 | Reg=0.00274 | acc=0.9375 | L2-Norm=16.559 | L2-Norm(final)=3.585 | 5469.3 samples/s | 85.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=12.7] | Loss=0.05370 | Reg=0.00297 | acc=0.9531 | L2-Norm=17.230 | L2-Norm(final)=3.813 | 3225.5 samples/s | 50.4 steps/s
[Step=6550 Epoch=12.8] | Loss=0.08769 | Reg=0.00298 | acc=0.9375 | L2-Norm=17.269 | L2-Norm(final)=3.808 | 3650.0 samples/s | 57.0 steps/s
[Step=6600 Epoch=12.9] | Loss=0.09045 | Reg=0.00299 | acc=0.9844 | L2-Norm=17.297 | L2-Norm(final)=3.785 | 3920.5 samples/s | 61.3 steps/s
[Step=6650 Epoch=13.0] | Loss=0.08289 | Reg=0.00300 | acc=0.9531 | L2-Norm=17.332 | L2-Norm(final)=3.772 | 3921.3 samples/s | 61.3 steps/s
[Step=6700 Epoch=13.1] | Loss=0.08083 | Reg=0.00301 | acc=0.9219 | L2-Norm=17.356 | L2-Norm(final)=3.761 | 3915.1 samples/s | 61.2 steps/s
[Step=6750 Epoch=13.2] | Loss=0.07788 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.379 | L2-Norm(final)=3.750 | 3940.9 samples/s | 61.6 steps/s
[Step=6800 Epoch=13.3] | Loss=0.07397 | Reg=0.00303 | acc=0.9531 | L2-Norm=17.398 | L2-Norm(final)=3.744 | 3941.3 samples/s | 61.6 steps/s
[Step=6850 Epoch=13.4] | Loss=0.07258 | Reg=0.00303 | acc=0.9688 | L2-Norm=17.414 | L2-Norm(final)=3.739 | 3960.4 samples/s | 61.9 steps/s
[Step=6900 Epoch=13.5] | Loss=0.06966 | Reg=0.00304 | acc=0.9531 | L2-Norm=17.432 | L2-Norm(final)=3.735 | 3960.1 samples/s | 61.9 steps/s
[Step=6950 Epoch=13.6] | Loss=0.06830 | Reg=0.00304 | acc=0.9375 | L2-Norm=17.448 | L2-Norm(final)=3.732 | 3947.8 samples/s | 61.7 steps/s
[Step=7000 Epoch=13.7] | Loss=0.06655 | Reg=0.00305 | acc=0.9375 | L2-Norm=17.465 | L2-Norm(final)=3.731 | 4770.4 samples/s | 74.5 steps/s
[Step=7050 Epoch=13.8] | Loss=0.06413 | Reg=0.00306 | acc=0.9375 | L2-Norm=17.479 | L2-Norm(final)=3.729 | 1538.3 samples/s | 24.0 steps/s
[Step=7100 Epoch=13.8] | Loss=0.06219 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.493 | L2-Norm(final)=3.728 | 3880.8 samples/s | 60.6 steps/s
[Step=7150 Epoch=13.9] | Loss=0.06004 | Reg=0.00307 | acc=0.9844 | L2-Norm=17.508 | L2-Norm(final)=3.727 | 3981.6 samples/s | 62.2 steps/s
[Step=7200 Epoch=14.0] | Loss=0.05904 | Reg=0.00307 | acc=0.9375 | L2-Norm=17.523 | L2-Norm(final)=3.727 | 3919.9 samples/s | 61.2 steps/s
[Step=7250 Epoch=14.1] | Loss=0.05742 | Reg=0.00308 | acc=0.9844 | L2-Norm=17.536 | L2-Norm(final)=3.725 | 3916.5 samples/s | 61.2 steps/s
[Step=7300 Epoch=14.2] | Loss=0.05627 | Reg=0.00308 | acc=0.9688 | L2-Norm=17.549 | L2-Norm(final)=3.725 | 3932.9 samples/s | 61.5 steps/s
[Step=7350 Epoch=14.3] | Loss=0.05525 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.561 | L2-Norm(final)=3.723 | 3945.7 samples/s | 61.7 steps/s
[Step=7400 Epoch=14.4] | Loss=0.05441 | Reg=0.00309 | acc=0.9688 | L2-Norm=17.572 | L2-Norm(final)=3.722 | 3967.8 samples/s | 62.0 steps/s
[Step=7450 Epoch=14.5] | Loss=0.05399 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.584 | L2-Norm(final)=3.720 | 3976.0 samples/s | 62.1 steps/s
[Step=7500 Epoch=14.6] | Loss=0.05359 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.596 | L2-Norm(final)=3.718 | 4184.9 samples/s | 65.4 steps/s
[Step=7550 Epoch=14.7] | Loss=0.05254 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.608 | L2-Norm(final)=3.716 | 1564.2 samples/s | 24.4 steps/s
[Step=7600 Epoch=14.8] | Loss=0.05146 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.620 | L2-Norm(final)=3.715 | 3909.0 samples/s | 61.1 steps/s
[Step=7650 Epoch=14.9] | Loss=0.05076 | Reg=0.00311 | acc=0.9531 | L2-Norm=17.631 | L2-Norm(final)=3.714 | 3892.3 samples/s | 60.8 steps/s
[Step=7700 Epoch=15.0] | Loss=0.05002 | Reg=0.00311 | acc=0.9375 | L2-Norm=17.643 | L2-Norm(final)=3.713 | 3936.1 samples/s | 61.5 steps/s
[Step=7750 Epoch=15.1] | Loss=0.04947 | Reg=0.00312 | acc=0.9688 | L2-Norm=17.653 | L2-Norm(final)=3.712 | 3966.2 samples/s | 62.0 steps/s
[Step=7800 Epoch=15.2] | Loss=0.04880 | Reg=0.00312 | acc=0.9688 | L2-Norm=17.664 | L2-Norm(final)=3.710 | 3945.2 samples/s | 61.6 steps/s
[Step=7850 Epoch=15.3] | Loss=0.04814 | Reg=0.00312 | acc=0.9688 | L2-Norm=17.676 | L2-Norm(final)=3.710 | 3917.0 samples/s | 61.2 steps/s
[Step=7900 Epoch=15.4] | Loss=0.04773 | Reg=0.00313 | acc=0.9531 | L2-Norm=17.687 | L2-Norm(final)=3.708 | 3900.9 samples/s | 61.0 steps/s
[Step=7950 Epoch=15.5] | Loss=0.04716 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.698 | L2-Norm(final)=3.707 | 3962.7 samples/s | 61.9 steps/s
[Step=8000 Epoch=15.6] | Loss=0.04692 | Reg=0.00314 | acc=0.9531 | L2-Norm=17.708 | L2-Norm(final)=3.705 | 3932.7 samples/s | 61.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step8000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=6001 Epoch=11.7] | Loss=0.12167 | Reg=0.00238 | acc=0.9531 | L2-Norm=15.431 | L2-Norm(final)=3.292 | 3407.8 samples/s | 53.2 steps/s
[Step=6050 Epoch=11.8] | Loss=0.10428 | Reg=0.00246 | acc=0.8750 | L2-Norm=15.669 | L2-Norm(final)=3.363 | 3910.7 samples/s | 61.1 steps/s
[Step=6100 Epoch=11.9] | Loss=0.09729 | Reg=0.00252 | acc=0.9375 | L2-Norm=15.869 | L2-Norm(final)=3.412 | 4394.8 samples/s | 68.7 steps/s
[Step=6150 Epoch=12.0] | Loss=0.09547 | Reg=0.00256 | acc=0.8906 | L2-Norm=16.005 | L2-Norm(final)=3.449 | 4426.8 samples/s | 69.2 steps/s
[Step=6200 Epoch=12.1] | Loss=0.09337 | Reg=0.00260 | acc=0.9531 | L2-Norm=16.128 | L2-Norm(final)=3.482 | 4382.3 samples/s | 68.5 steps/s
[Step=6250 Epoch=12.2] | Loss=0.09162 | Reg=0.00264 | acc=0.9219 | L2-Norm=16.241 | L2-Norm(final)=3.516 | 4289.0 samples/s | 67.0 steps/s
[Step=6300 Epoch=12.3] | Loss=0.09031 | Reg=0.00267 | acc=0.9062 | L2-Norm=16.343 | L2-Norm(final)=3.547 | 4377.8 samples/s | 68.4 steps/s
[Step=6350 Epoch=12.4] | Loss=0.08769 | Reg=0.00270 | acc=0.9375 | L2-Norm=16.436 | L2-Norm(final)=3.575 | 4355.8 samples/s | 68.1 steps/s
[Step=6400 Epoch=12.5] | Loss=0.08674 | Reg=0.00273 | acc=0.8906 | L2-Norm=16.522 | L2-Norm(final)=3.602 | 4398.0 samples/s | 68.7 steps/s
[Step=6450 Epoch=12.6] | Loss=0.08509 | Reg=0.00276 | acc=0.9688 | L2-Norm=16.601 | L2-Norm(final)=3.627 | 4313.5 samples/s | 67.4 steps/s
[Step=6500 Epoch=12.7] | Loss=0.08481 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.677 | L2-Norm(final)=3.653 | 5588.4 samples/s | 87.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=12.7] | Loss=0.06784 | Reg=0.00303 | acc=0.9688 | L2-Norm=17.418 | L2-Norm(final)=3.890 | 3151.3 samples/s | 49.2 steps/s
[Step=6550 Epoch=12.8] | Loss=0.07452 | Reg=0.00305 | acc=0.9688 | L2-Norm=17.467 | L2-Norm(final)=3.894 | 3920.3 samples/s | 61.3 steps/s
[Step=6600 Epoch=12.9] | Loss=0.07586 | Reg=0.00306 | acc=0.9375 | L2-Norm=17.483 | L2-Norm(final)=3.877 | 3901.5 samples/s | 61.0 steps/s
[Step=6650 Epoch=13.0] | Loss=0.07578 | Reg=0.00307 | acc=0.9062 | L2-Norm=17.507 | L2-Norm(final)=3.863 | 3906.1 samples/s | 61.0 steps/s
[Step=6700 Epoch=13.1] | Loss=0.07511 | Reg=0.00307 | acc=0.9219 | L2-Norm=17.528 | L2-Norm(final)=3.852 | 3851.4 samples/s | 60.2 steps/s
[Step=6750 Epoch=13.2] | Loss=0.07417 | Reg=0.00308 | acc=0.9219 | L2-Norm=17.546 | L2-Norm(final)=3.840 | 3845.9 samples/s | 60.1 steps/s
[Step=6800 Epoch=13.3] | Loss=0.07233 | Reg=0.00309 | acc=0.9531 | L2-Norm=17.568 | L2-Norm(final)=3.832 | 3896.0 samples/s | 60.9 steps/s
[Step=6850 Epoch=13.4] | Loss=0.06948 | Reg=0.00309 | acc=0.9531 | L2-Norm=17.587 | L2-Norm(final)=3.827 | 3934.0 samples/s | 61.5 steps/s
[Step=6900 Epoch=13.5] | Loss=0.06780 | Reg=0.00310 | acc=0.9531 | L2-Norm=17.604 | L2-Norm(final)=3.822 | 3938.5 samples/s | 61.5 steps/s
[Step=6950 Epoch=13.6] | Loss=0.06582 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.617 | L2-Norm(final)=3.816 | 3893.2 samples/s | 60.8 steps/s
[Step=7000 Epoch=13.7] | Loss=0.06494 | Reg=0.00311 | acc=0.9375 | L2-Norm=17.630 | L2-Norm(final)=3.810 | 4847.7 samples/s | 75.7 steps/s
[Step=7050 Epoch=13.8] | Loss=0.06327 | Reg=0.00311 | acc=0.9688 | L2-Norm=17.645 | L2-Norm(final)=3.806 | 1498.0 samples/s | 23.4 steps/s
[Step=7100 Epoch=13.9] | Loss=0.06122 | Reg=0.00312 | acc=0.9531 | L2-Norm=17.661 | L2-Norm(final)=3.803 | 3953.3 samples/s | 61.8 steps/s
[Step=7150 Epoch=14.0] | Loss=0.05993 | Reg=0.00312 | acc=0.9531 | L2-Norm=17.677 | L2-Norm(final)=3.800 | 3845.3 samples/s | 60.1 steps/s
[Step=7200 Epoch=14.1] | Loss=0.05837 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.692 | L2-Norm(final)=3.797 | 3896.0 samples/s | 60.9 steps/s
[Step=7250 Epoch=14.2] | Loss=0.05768 | Reg=0.00314 | acc=0.9688 | L2-Norm=17.707 | L2-Norm(final)=3.795 | 3916.1 samples/s | 61.2 steps/s
[Step=7300 Epoch=14.3] | Loss=0.05669 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.722 | L2-Norm(final)=3.793 | 3915.2 samples/s | 61.2 steps/s
[Step=7350 Epoch=14.4] | Loss=0.05562 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.737 | L2-Norm(final)=3.792 | 3921.9 samples/s | 61.3 steps/s
[Step=7400 Epoch=14.5] | Loss=0.05440 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.753 | L2-Norm(final)=3.790 | 3910.8 samples/s | 61.1 steps/s
[Step=7450 Epoch=14.6] | Loss=0.05361 | Reg=0.00316 | acc=0.9688 | L2-Norm=17.768 | L2-Norm(final)=3.789 | 3878.6 samples/s | 60.6 steps/s
[Step=7500 Epoch=14.7] | Loss=0.05302 | Reg=0.00316 | acc=0.9688 | L2-Norm=17.783 | L2-Norm(final)=3.788 | 4258.5 samples/s | 66.5 steps/s
[Step=7550 Epoch=14.8] | Loss=0.05190 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.797 | L2-Norm(final)=3.786 | 1554.5 samples/s | 24.3 steps/s
[Step=7600 Epoch=14.9] | Loss=0.05083 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.811 | L2-Norm(final)=3.785 | 3919.9 samples/s | 61.2 steps/s
[Step=7650 Epoch=15.0] | Loss=0.05009 | Reg=0.00318 | acc=0.9531 | L2-Norm=17.824 | L2-Norm(final)=3.784 | 3935.3 samples/s | 61.5 steps/s
[Step=7700 Epoch=15.1] | Loss=0.04939 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.837 | L2-Norm(final)=3.783 | 3917.9 samples/s | 61.2 steps/s
[Step=7750 Epoch=15.2] | Loss=0.04882 | Reg=0.00319 | acc=0.9688 | L2-Norm=17.851 | L2-Norm(final)=3.782 | 3901.2 samples/s | 61.0 steps/s
[Step=7800 Epoch=15.2] | Loss=0.04821 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.864 | L2-Norm(final)=3.781 | 3993.1 samples/s | 62.4 steps/s
[Step=7850 Epoch=15.3] | Loss=0.04757 | Reg=0.00320 | acc=0.9688 | L2-Norm=17.878 | L2-Norm(final)=3.779 | 3894.0 samples/s | 60.8 steps/s
[Step=7900 Epoch=15.4] | Loss=0.04696 | Reg=0.00320 | acc=0.9531 | L2-Norm=17.891 | L2-Norm(final)=3.778 | 3880.4 samples/s | 60.6 steps/s
[Step=7950 Epoch=15.5] | Loss=0.04647 | Reg=0.00321 | acc=0.9531 | L2-Norm=17.905 | L2-Norm(final)=3.777 | 3928.7 samples/s | 61.4 steps/s
[Step=8000 Epoch=15.6] | Loss=0.04615 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.918 | L2-Norm(final)=3.776 | 3948.0 samples/s | 61.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step8000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=6001 Epoch=23.0] | Loss=0.14057 | Reg=0.00238 | acc=0.9219 | L2-Norm=15.431 | L2-Norm(final)=3.871 | 3135.3 samples/s | 49.0 steps/s
[Step=6050 Epoch=23.2] | Loss=0.02753 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.694 | L2-Norm(final)=3.876 | 3934.7 samples/s | 61.5 steps/s
[Step=6100 Epoch=23.4] | Loss=0.02237 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.841 | L2-Norm(final)=3.901 | 4191.1 samples/s | 65.5 steps/s
[Step=6150 Epoch=23.6] | Loss=0.01794 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.945 | L2-Norm(final)=3.932 | 4201.1 samples/s | 65.6 steps/s
[Step=6200 Epoch=23.8] | Loss=0.01545 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.020 | L2-Norm(final)=3.966 | 4026.9 samples/s | 62.9 steps/s
[Step=6250 Epoch=23.9] | Loss=0.01378 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.082 | L2-Norm(final)=3.999 | 5553.1 samples/s | 86.8 steps/s
[Step=6300 Epoch=24.1] | Loss=0.01239 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.133 | L2-Norm(final)=4.030 | 1497.6 samples/s | 23.4 steps/s
[Step=6350 Epoch=24.3] | Loss=0.01139 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.179 | L2-Norm(final)=4.061 | 4160.9 samples/s | 65.0 steps/s
[Step=6400 Epoch=24.5] | Loss=0.01058 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.221 | L2-Norm(final)=4.093 | 4170.7 samples/s | 65.2 steps/s
[Step=6450 Epoch=24.7] | Loss=0.00991 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.260 | L2-Norm(final)=4.125 | 4104.4 samples/s | 64.1 steps/s
[Step=6500 Epoch=24.9] | Loss=0.00939 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.293 | L2-Norm(final)=4.156 | 4684.4 samples/s | 73.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=24.9] | Loss=0.00720 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.607 | L2-Norm(final)=4.463 | 3180.5 samples/s | 49.7 steps/s
[Step=6550 Epoch=25.1] | Loss=0.03314 | Reg=0.00281 | acc=0.9844 | L2-Norm=16.751 | L2-Norm(final)=4.440 | 3544.4 samples/s | 55.4 steps/s
[Step=6600 Epoch=25.3] | Loss=0.02490 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.900 | L2-Norm(final)=4.370 | 3726.9 samples/s | 58.2 steps/s
[Step=6650 Epoch=25.5] | Loss=0.02178 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.958 | L2-Norm(final)=4.336 | 3775.9 samples/s | 59.0 steps/s
[Step=6700 Epoch=25.7] | Loss=0.01691 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.984 | L2-Norm(final)=4.318 | 3657.0 samples/s | 57.1 steps/s
[Step=6750 Epoch=25.9] | Loss=0.01422 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.992 | L2-Norm(final)=4.309 | 4772.4 samples/s | 74.6 steps/s
[Step=6800 Epoch=26.1] | Loss=0.01199 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.989 | L2-Norm(final)=4.304 | 1463.6 samples/s | 22.9 steps/s
[Step=6850 Epoch=26.2] | Loss=0.01046 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.979 | L2-Norm(final)=4.302 | 3744.0 samples/s | 58.5 steps/s
[Step=6900 Epoch=26.4] | Loss=0.00919 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.965 | L2-Norm(final)=4.301 | 3721.7 samples/s | 58.2 steps/s
[Step=6950 Epoch=26.6] | Loss=0.00818 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.946 | L2-Norm(final)=4.301 | 3720.9 samples/s | 58.1 steps/s
[Step=7000 Epoch=26.8] | Loss=0.00736 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.925 | L2-Norm(final)=4.302 | 4125.2 samples/s | 64.5 steps/s
[Step=7050 Epoch=27.0] | Loss=0.00670 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.901 | L2-Norm(final)=4.303 | 1542.2 samples/s | 24.1 steps/s
[Step=7100 Epoch=27.2] | Loss=0.00614 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.875 | L2-Norm(final)=4.303 | 3750.7 samples/s | 58.6 steps/s
[Step=7150 Epoch=27.4] | Loss=0.00567 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.847 | L2-Norm(final)=4.304 | 3757.1 samples/s | 58.7 steps/s
[Step=7200 Epoch=27.6] | Loss=0.00527 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.819 | L2-Norm(final)=4.305 | 3729.0 samples/s | 58.3 steps/s
[Step=7250 Epoch=27.8] | Loss=0.00492 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.789 | L2-Norm(final)=4.306 | 3744.4 samples/s | 58.5 steps/s
[Step=7300 Epoch=28.0] | Loss=0.00461 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.759 | L2-Norm(final)=4.306 | 1576.3 samples/s | 24.6 steps/s
[Step=7350 Epoch=28.2] | Loss=0.00434 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.728 | L2-Norm(final)=4.307 | 3810.4 samples/s | 59.5 steps/s
[Step=7400 Epoch=28.4] | Loss=0.00410 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.697 | L2-Norm(final)=4.308 | 3718.7 samples/s | 58.1 steps/s
[Step=7450 Epoch=28.5] | Loss=0.00389 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.665 | L2-Norm(final)=4.308 | 3730.5 samples/s | 58.3 steps/s
[Step=7500 Epoch=28.7] | Loss=0.00369 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.633 | L2-Norm(final)=4.309 | 3715.2 samples/s | 58.1 steps/s
[Step=7550 Epoch=28.9] | Loss=0.00352 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.600 | L2-Norm(final)=4.310 | 1591.0 samples/s | 24.9 steps/s
[Step=7600 Epoch=29.1] | Loss=0.00336 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.568 | L2-Norm(final)=4.310 | 3724.6 samples/s | 58.2 steps/s
[Step=7650 Epoch=29.3] | Loss=0.00321 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.535 | L2-Norm(final)=4.311 | 3739.5 samples/s | 58.4 steps/s
[Step=7700 Epoch=29.5] | Loss=0.00308 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.502 | L2-Norm(final)=4.312 | 3744.4 samples/s | 58.5 steps/s
[Step=7750 Epoch=29.7] | Loss=0.00296 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.468 | L2-Norm(final)=4.312 | 3748.5 samples/s | 58.6 steps/s
[Step=7800 Epoch=29.9] | Loss=0.00284 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.435 | L2-Norm(final)=4.313 | 5106.5 samples/s | 79.8 steps/s
[Step=7850 Epoch=30.1] | Loss=0.00274 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.401 | L2-Norm(final)=4.313 | 1444.7 samples/s | 22.6 steps/s
[Step=7900 Epoch=30.3] | Loss=0.00264 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.367 | L2-Norm(final)=4.314 | 3762.4 samples/s | 58.8 steps/s
[Step=7950 Epoch=30.5] | Loss=0.00255 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.333 | L2-Norm(final)=4.315 | 3749.3 samples/s | 58.6 steps/s
[Step=8000 Epoch=30.7] | Loss=0.00247 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.299 | L2-Norm(final)=4.315 | 3734.5 samples/s | 58.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step8000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=6001 Epoch=23.1] | Loss=0.09736 | Reg=0.00238 | acc=0.9219 | L2-Norm=15.431 | L2-Norm(final)=3.789 | 3098.4 samples/s | 48.4 steps/s
[Step=6050 Epoch=23.3] | Loss=0.03479 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.706 | L2-Norm(final)=3.793 | 4113.1 samples/s | 64.3 steps/s
[Step=6100 Epoch=23.5] | Loss=0.02493 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.853 | L2-Norm(final)=3.825 | 4190.3 samples/s | 65.5 steps/s
[Step=6150 Epoch=23.7] | Loss=0.02066 | Reg=0.00254 | acc=0.9688 | L2-Norm=15.946 | L2-Norm(final)=3.860 | 4121.1 samples/s | 64.4 steps/s
[Step=6200 Epoch=23.9] | Loss=0.01902 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.018 | L2-Norm(final)=3.891 | 4164.4 samples/s | 65.1 steps/s
[Step=6250 Epoch=24.1] | Loss=0.01753 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.078 | L2-Norm(final)=3.922 | 5551.3 samples/s | 86.7 steps/s
[Step=6300 Epoch=24.3] | Loss=0.01594 | Reg=0.00260 | acc=0.9844 | L2-Norm=16.133 | L2-Norm(final)=3.952 | 1551.0 samples/s | 24.2 steps/s
[Step=6350 Epoch=24.4] | Loss=0.01456 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.183 | L2-Norm(final)=3.984 | 4227.1 samples/s | 66.0 steps/s
[Step=6400 Epoch=24.6] | Loss=0.01354 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.227 | L2-Norm(final)=4.017 | 4021.0 samples/s | 62.8 steps/s
[Step=6450 Epoch=24.8] | Loss=0.01289 | Reg=0.00265 | acc=0.9844 | L2-Norm=16.269 | L2-Norm(final)=4.050 | 4239.0 samples/s | 66.2 steps/s
[Step=6500 Epoch=25.0] | Loss=0.01230 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.308 | L2-Norm(final)=4.081 | 4701.0 samples/s | 73.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=25.0] | Loss=0.00155 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.681 | L2-Norm(final)=4.397 | 3030.3 samples/s | 47.3 steps/s
[Step=6550 Epoch=25.2] | Loss=0.06040 | Reg=0.00284 | acc=0.9688 | L2-Norm=16.838 | L2-Norm(final)=4.306 | 3648.6 samples/s | 57.0 steps/s
[Step=6600 Epoch=25.4] | Loss=0.03865 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.950 | L2-Norm(final)=4.241 | 3766.9 samples/s | 58.9 steps/s
[Step=6650 Epoch=25.6] | Loss=0.02902 | Reg=0.00288 | acc=0.9844 | L2-Norm=16.984 | L2-Norm(final)=4.231 | 3691.2 samples/s | 57.7 steps/s
[Step=6700 Epoch=25.8] | Loss=0.02381 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.989 | L2-Norm(final)=4.228 | 3733.9 samples/s | 58.3 steps/s
[Step=6750 Epoch=26.0] | Loss=0.01986 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.983 | L2-Norm(final)=4.230 | 4723.8 samples/s | 73.8 steps/s
[Step=6800 Epoch=26.2] | Loss=0.01685 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.971 | L2-Norm(final)=4.236 | 1458.6 samples/s | 22.8 steps/s
[Step=6850 Epoch=26.4] | Loss=0.01454 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.955 | L2-Norm(final)=4.241 | 3781.6 samples/s | 59.1 steps/s
[Step=6900 Epoch=26.6] | Loss=0.01282 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.938 | L2-Norm(final)=4.248 | 3678.8 samples/s | 57.5 steps/s
[Step=6950 Epoch=26.8] | Loss=0.01141 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.919 | L2-Norm(final)=4.254 | 3746.1 samples/s | 58.5 steps/s
[Step=7000 Epoch=26.9] | Loss=0.01029 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.897 | L2-Norm(final)=4.259 | 4172.2 samples/s | 65.2 steps/s
[Step=7050 Epoch=27.1] | Loss=0.00937 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.873 | L2-Norm(final)=4.264 | 1488.3 samples/s | 23.3 steps/s
[Step=7100 Epoch=27.3] | Loss=0.00860 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.848 | L2-Norm(final)=4.269 | 3712.4 samples/s | 58.0 steps/s
[Step=7150 Epoch=27.5] | Loss=0.00794 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.821 | L2-Norm(final)=4.273 | 3729.0 samples/s | 58.3 steps/s
[Step=7200 Epoch=27.7] | Loss=0.00738 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.794 | L2-Norm(final)=4.277 | 3680.2 samples/s | 57.5 steps/s
[Step=7250 Epoch=27.9] | Loss=0.00689 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.766 | L2-Norm(final)=4.280 | 3803.7 samples/s | 59.4 steps/s
[Step=7300 Epoch=28.1] | Loss=0.00646 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.737 | L2-Norm(final)=4.284 | 1568.9 samples/s | 24.5 steps/s
[Step=7350 Epoch=28.3] | Loss=0.00608 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.707 | L2-Norm(final)=4.287 | 3776.0 samples/s | 59.0 steps/s
[Step=7400 Epoch=28.5] | Loss=0.00575 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.678 | L2-Norm(final)=4.290 | 3693.1 samples/s | 57.7 steps/s
[Step=7450 Epoch=28.7] | Loss=0.00545 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.648 | L2-Norm(final)=4.293 | 3685.0 samples/s | 57.6 steps/s
[Step=7500 Epoch=28.9] | Loss=0.00518 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.617 | L2-Norm(final)=4.295 | 3740.5 samples/s | 58.4 steps/s
[Step=7550 Epoch=29.1] | Loss=0.00493 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.586 | L2-Norm(final)=4.297 | 1610.8 samples/s | 25.2 steps/s
[Step=7600 Epoch=29.3] | Loss=0.00471 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.555 | L2-Norm(final)=4.300 | 3726.4 samples/s | 58.2 steps/s
[Step=7650 Epoch=29.4] | Loss=0.00450 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.524 | L2-Norm(final)=4.302 | 3712.4 samples/s | 58.0 steps/s
[Step=7700 Epoch=29.6] | Loss=0.00432 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.493 | L2-Norm(final)=4.304 | 3753.9 samples/s | 58.7 steps/s
[Step=7750 Epoch=29.8] | Loss=0.00415 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.461 | L2-Norm(final)=4.306 | 3747.8 samples/s | 58.6 steps/s
[Step=7800 Epoch=30.0] | Loss=0.00399 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.430 | L2-Norm(final)=4.308 | 5464.2 samples/s | 85.4 steps/s
[Step=7850 Epoch=30.2] | Loss=0.00384 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.398 | L2-Norm(final)=4.310 | 1388.8 samples/s | 21.7 steps/s
[Step=7900 Epoch=30.4] | Loss=0.00370 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.366 | L2-Norm(final)=4.312 | 3728.2 samples/s | 58.3 steps/s
[Step=7950 Epoch=30.6] | Loss=0.00358 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.334 | L2-Norm(final)=4.313 | 3727.2 samples/s | 58.2 steps/s
[Step=8000 Epoch=30.8] | Loss=0.00346 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.302 | L2-Norm(final)=4.315 | 3724.4 samples/s | 58.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07326 | acc=0.9489 | tpr=0.9516 | fpr=0.0570 | 3504.8 samples/s | 13.7 steps/s
Avg test loss: 0.07513, Avg test acc: 0.94887, Avg tpr: 0.95151, Avg fpr: 0.05692, total FA: 444

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06774 | acc=0.9537 | tpr=0.9654 | fpr=0.0716 | 3514.0 samples/s | 13.7 steps/s
Avg test loss: 0.07244, Avg test acc: 0.95264, Avg tpr: 0.96334, Avg fpr: 0.07089, total FA: 553

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.93896 | acc=0.3136 | tpr=0.0121 | fpr=0.0317 | 3537.4 samples/s | 13.8 steps/s
Avg test loss: 4.95638, Avg test acc: 0.31008, Avg tpr: 0.01107, Avg fpr: 0.03230, total FA: 252

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.07765 | acc=0.3095 | tpr=0.0167 | fpr=0.0548 | 3493.4 samples/s | 13.6 steps/s
Avg test loss: 4.09639, Avg test acc: 0.30684, Avg tpr: 0.01667, Avg fpr: 0.05499, total FA: 429

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.69705 | acc=0.1110 | tpr=0.7788 | fpr=0.9010 | 3517.2 samples/s | 13.7 steps/s
[Step= 100] | Loss=3.67424 | acc=0.1129 | tpr=0.8166 | fpr=0.9002 | 6846.8 samples/s | 26.7 steps/s
[Step= 150] | Loss=3.67058 | acc=0.1135 | tpr=0.8184 | fpr=0.8994 | 6850.8 samples/s | 26.8 steps/s
[Step= 200] | Loss=3.65948 | acc=0.1137 | tpr=0.8120 | fpr=0.8990 | 7009.3 samples/s | 27.4 steps/s
[Step= 250] | Loss=3.66666 | acc=0.1135 | tpr=0.8105 | fpr=0.8992 | 6778.5 samples/s | 26.5 steps/s
[Step= 300] | Loss=3.66638 | acc=0.1134 | tpr=0.8131 | fpr=0.8994 | 6890.7 samples/s | 26.9 steps/s
[Step= 350] | Loss=3.66362 | acc=0.1142 | tpr=0.8190 | fpr=0.8986 | 6988.3 samples/s | 27.3 steps/s
[Step= 400] | Loss=3.66217 | acc=0.1143 | tpr=0.8173 | fpr=0.8984 | 6754.7 samples/s | 26.4 steps/s
[Step= 450] | Loss=3.66518 | acc=0.1141 | tpr=0.8169 | fpr=0.8987 | 6875.4 samples/s | 26.9 steps/s
[Step= 500] | Loss=3.66385 | acc=0.1141 | tpr=0.8181 | fpr=0.8986 | 6923.3 samples/s | 27.0 steps/s
[Step= 550] | Loss=3.66321 | acc=0.1142 | tpr=0.8225 | fpr=0.8986 | 12070.1 samples/s | 47.1 steps/s
Avg test loss: 3.66394, Avg test acc: 0.11418, Avg tpr: 0.82250, Avg fpr: 0.89869, total FA: 124782

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.81362 | acc=0.0834 | tpr=0.8274 | fpr=0.9299 | 3568.5 samples/s | 13.9 steps/s
[Step= 100] | Loss=4.79154 | acc=0.0843 | tpr=0.8401 | fpr=0.9298 | 6651.2 samples/s | 26.0 steps/s
[Step= 150] | Loss=4.80345 | acc=0.0834 | tpr=0.8473 | fpr=0.9306 | 6838.7 samples/s | 26.7 steps/s
[Step= 200] | Loss=4.79386 | acc=0.0837 | tpr=0.8404 | fpr=0.9301 | 6875.5 samples/s | 26.9 steps/s
[Step= 250] | Loss=4.80113 | acc=0.0840 | tpr=0.8376 | fpr=0.9298 | 7193.6 samples/s | 28.1 steps/s
[Step= 300] | Loss=4.80203 | acc=0.0835 | tpr=0.8335 | fpr=0.9302 | 6616.8 samples/s | 25.8 steps/s
[Step= 350] | Loss=4.79671 | acc=0.0843 | tpr=0.8341 | fpr=0.9293 | 6960.8 samples/s | 27.2 steps/s
[Step= 400] | Loss=4.79268 | acc=0.0843 | tpr=0.8337 | fpr=0.9293 | 6567.0 samples/s | 25.7 steps/s
[Step= 450] | Loss=4.80041 | acc=0.0840 | tpr=0.8345 | fpr=0.9296 | 6732.5 samples/s | 26.3 steps/s
[Step= 500] | Loss=4.80134 | acc=0.0840 | tpr=0.8326 | fpr=0.9295 | 6811.0 samples/s | 26.6 steps/s
[Step= 550] | Loss=4.80460 | acc=0.0839 | tpr=0.8349 | fpr=0.9298 | 12404.7 samples/s | 48.5 steps/s
Avg test loss: 4.80564, Avg test acc: 0.08389, Avg tpr: 0.83479, Avg fpr: 0.92976, total FA: 129096

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10748 | acc=0.9789 | tpr=0.8894 | fpr=0.0195 | 3437.0 samples/s | 13.4 steps/s
[Step= 100] | Loss=0.11183 | acc=0.9782 | tpr=0.9211 | fpr=0.0207 | 6846.9 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.11527 | acc=0.9777 | tpr=0.9280 | fpr=0.0214 | 6730.5 samples/s | 26.3 steps/s
[Step= 200] | Loss=0.11687 | acc=0.9778 | tpr=0.9333 | fpr=0.0214 | 6759.2 samples/s | 26.4 steps/s
[Step= 250] | Loss=0.11363 | acc=0.9782 | tpr=0.9310 | fpr=0.0210 | 7178.5 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.11677 | acc=0.9778 | tpr=0.9287 | fpr=0.0213 | 6580.2 samples/s | 25.7 steps/s
[Step= 350] | Loss=0.11755 | acc=0.9777 | tpr=0.9267 | fpr=0.0214 | 6844.9 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.11925 | acc=0.9774 | tpr=0.9234 | fpr=0.0216 | 6616.7 samples/s | 25.8 steps/s
[Step= 450] | Loss=0.12143 | acc=0.9770 | tpr=0.9197 | fpr=0.0220 | 6752.8 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.12054 | acc=0.9772 | tpr=0.9229 | fpr=0.0218 | 6690.3 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.11920 | acc=0.9775 | tpr=0.9232 | fpr=0.0215 | 12588.0 samples/s | 49.2 steps/s
Avg test loss: 0.11888, Avg test acc: 0.97751, Avg tpr: 0.92314, Avg fpr: 0.02150, total FA: 2985

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.08703 | acc=0.9812 | tpr=0.9469 | fpr=0.0182 | 3514.5 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.09151 | acc=0.9805 | tpr=0.9510 | fpr=0.0189 | 6955.5 samples/s | 27.2 steps/s
[Step= 150] | Loss=0.09531 | acc=0.9797 | tpr=0.9524 | fpr=0.0198 | 6777.4 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.09665 | acc=0.9795 | tpr=0.9552 | fpr=0.0200 | 6882.0 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.09509 | acc=0.9798 | tpr=0.9485 | fpr=0.0197 | 6931.5 samples/s | 27.1 steps/s
[Step= 300] | Loss=0.09656 | acc=0.9795 | tpr=0.9455 | fpr=0.0199 | 6761.7 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.09725 | acc=0.9793 | tpr=0.9430 | fpr=0.0201 | 6809.3 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.09801 | acc=0.9792 | tpr=0.9431 | fpr=0.0202 | 6896.4 samples/s | 26.9 steps/s
[Step= 450] | Loss=0.09912 | acc=0.9790 | tpr=0.9406 | fpr=0.0203 | 6769.5 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.09862 | acc=0.9790 | tpr=0.9423 | fpr=0.0204 | 6749.4 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.09823 | acc=0.9790 | tpr=0.9415 | fpr=0.0203 | 12132.7 samples/s | 47.4 steps/s
Avg test loss: 0.09803, Avg test acc: 0.97903, Avg tpr: 0.94097, Avg fpr: 0.02028, total FA: 2816

server round 4/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=8001 Epoch=15.6] | Loss=0.08330 | Reg=0.00235 | acc=0.9531 | L2-Norm=15.338 | L2-Norm(final)=3.647 | 3186.5 samples/s | 49.8 steps/s
[Step=8050 Epoch=15.7] | Loss=0.09194 | Reg=0.00243 | acc=0.9375 | L2-Norm=15.583 | L2-Norm(final)=3.723 | 3957.5 samples/s | 61.8 steps/s
[Step=8100 Epoch=15.8] | Loss=0.09144 | Reg=0.00249 | acc=0.8906 | L2-Norm=15.764 | L2-Norm(final)=3.766 | 4382.9 samples/s | 68.5 steps/s
[Step=8150 Epoch=15.9] | Loss=0.08779 | Reg=0.00253 | acc=0.9375 | L2-Norm=15.905 | L2-Norm(final)=3.792 | 4332.4 samples/s | 67.7 steps/s
[Step=8200 Epoch=16.0] | Loss=0.08709 | Reg=0.00257 | acc=0.9375 | L2-Norm=16.028 | L2-Norm(final)=3.820 | 4354.5 samples/s | 68.0 steps/s
[Step=8250 Epoch=16.1] | Loss=0.08649 | Reg=0.00260 | acc=0.9531 | L2-Norm=16.133 | L2-Norm(final)=3.846 | 4356.2 samples/s | 68.1 steps/s
[Step=8300 Epoch=16.2] | Loss=0.08499 | Reg=0.00264 | acc=0.8906 | L2-Norm=16.235 | L2-Norm(final)=3.872 | 4362.3 samples/s | 68.2 steps/s
[Step=8350 Epoch=16.3] | Loss=0.08400 | Reg=0.00267 | acc=0.9375 | L2-Norm=16.329 | L2-Norm(final)=3.896 | 4466.2 samples/s | 69.8 steps/s
[Step=8400 Epoch=16.4] | Loss=0.08301 | Reg=0.00270 | acc=0.8750 | L2-Norm=16.418 | L2-Norm(final)=3.923 | 4328.0 samples/s | 67.6 steps/s
[Step=8450 Epoch=16.5] | Loss=0.08219 | Reg=0.00273 | acc=0.9844 | L2-Norm=16.500 | L2-Norm(final)=3.949 | 4387.6 samples/s | 68.6 steps/s
[Step=8500 Epoch=16.6] | Loss=0.08166 | Reg=0.00275 | acc=0.9531 | L2-Norm=16.579 | L2-Norm(final)=3.976 | 5514.6 samples/s | 86.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=16.6] | Loss=0.08916 | Reg=0.00302 | acc=0.9375 | L2-Norm=17.367 | L2-Norm(final)=4.236 | 3257.0 samples/s | 50.9 steps/s
[Step=8550 Epoch=16.7] | Loss=0.07626 | Reg=0.00303 | acc=0.9531 | L2-Norm=17.408 | L2-Norm(final)=4.232 | 3498.8 samples/s | 54.7 steps/s
[Step=8600 Epoch=16.8] | Loss=0.07177 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.429 | L2-Norm(final)=4.213 | 3952.1 samples/s | 61.8 steps/s
[Step=8650 Epoch=16.9] | Loss=0.06920 | Reg=0.00305 | acc=0.9531 | L2-Norm=17.451 | L2-Norm(final)=4.202 | 3836.7 samples/s | 59.9 steps/s
[Step=8700 Epoch=17.0] | Loss=0.06672 | Reg=0.00305 | acc=0.9062 | L2-Norm=17.472 | L2-Norm(final)=4.194 | 3961.4 samples/s | 61.9 steps/s
[Step=8750 Epoch=17.1] | Loss=0.06360 | Reg=0.00306 | acc=0.9375 | L2-Norm=17.490 | L2-Norm(final)=4.187 | 3913.0 samples/s | 61.1 steps/s
[Step=8800 Epoch=17.2] | Loss=0.06170 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.508 | L2-Norm(final)=4.182 | 3944.0 samples/s | 61.6 steps/s
[Step=8850 Epoch=17.3] | Loss=0.05960 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.523 | L2-Norm(final)=4.177 | 3892.9 samples/s | 60.8 steps/s
[Step=8900 Epoch=17.4] | Loss=0.05829 | Reg=0.00307 | acc=0.9062 | L2-Norm=17.535 | L2-Norm(final)=4.172 | 3933.2 samples/s | 61.5 steps/s
[Step=8950 Epoch=17.5] | Loss=0.05775 | Reg=0.00308 | acc=0.9844 | L2-Norm=17.546 | L2-Norm(final)=4.168 | 3949.0 samples/s | 61.7 steps/s
[Step=9000 Epoch=17.6] | Loss=0.05698 | Reg=0.00308 | acc=0.9531 | L2-Norm=17.558 | L2-Norm(final)=4.163 | 4825.3 samples/s | 75.4 steps/s
[Step=9050 Epoch=17.7] | Loss=0.05490 | Reg=0.00309 | acc=0.9531 | L2-Norm=17.570 | L2-Norm(final)=4.161 | 1463.9 samples/s | 22.9 steps/s
[Step=9100 Epoch=17.7] | Loss=0.05285 | Reg=0.00309 | acc=0.9531 | L2-Norm=17.580 | L2-Norm(final)=4.159 | 3851.9 samples/s | 60.2 steps/s
[Step=9150 Epoch=17.8] | Loss=0.05155 | Reg=0.00309 | acc=0.9688 | L2-Norm=17.589 | L2-Norm(final)=4.157 | 3967.4 samples/s | 62.0 steps/s
[Step=9200 Epoch=17.9] | Loss=0.05083 | Reg=0.00310 | acc=0.9531 | L2-Norm=17.598 | L2-Norm(final)=4.155 | 3943.2 samples/s | 61.6 steps/s
[Step=9250 Epoch=18.0] | Loss=0.04954 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.608 | L2-Norm(final)=4.153 | 3940.4 samples/s | 61.6 steps/s
[Step=9300 Epoch=18.1] | Loss=0.04911 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.619 | L2-Norm(final)=4.151 | 3950.2 samples/s | 61.7 steps/s
[Step=9350 Epoch=18.2] | Loss=0.04841 | Reg=0.00311 | acc=0.9531 | L2-Norm=17.630 | L2-Norm(final)=4.148 | 3951.6 samples/s | 61.7 steps/s
[Step=9400 Epoch=18.3] | Loss=0.04816 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.641 | L2-Norm(final)=4.145 | 3938.3 samples/s | 61.5 steps/s
[Step=9450 Epoch=18.4] | Loss=0.04776 | Reg=0.00312 | acc=0.9688 | L2-Norm=17.653 | L2-Norm(final)=4.141 | 3959.9 samples/s | 61.9 steps/s
[Step=9500 Epoch=18.5] | Loss=0.04710 | Reg=0.00312 | acc=0.9844 | L2-Norm=17.665 | L2-Norm(final)=4.138 | 4161.8 samples/s | 65.0 steps/s
[Step=9550 Epoch=18.6] | Loss=0.04647 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.677 | L2-Norm(final)=4.134 | 1551.7 samples/s | 24.2 steps/s
[Step=9600 Epoch=18.7] | Loss=0.04554 | Reg=0.00313 | acc=0.9531 | L2-Norm=17.688 | L2-Norm(final)=4.132 | 3963.7 samples/s | 61.9 steps/s
[Step=9650 Epoch=18.8] | Loss=0.04461 | Reg=0.00313 | acc=0.9531 | L2-Norm=17.699 | L2-Norm(final)=4.130 | 3906.3 samples/s | 61.0 steps/s
[Step=9700 Epoch=18.9] | Loss=0.04382 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.709 | L2-Norm(final)=4.127 | 3986.4 samples/s | 62.3 steps/s
[Step=9750 Epoch=19.0] | Loss=0.04336 | Reg=0.00314 | acc=0.9688 | L2-Norm=17.719 | L2-Norm(final)=4.125 | 3945.7 samples/s | 61.7 steps/s
[Step=9800 Epoch=19.1] | Loss=0.04283 | Reg=0.00314 | acc=0.9531 | L2-Norm=17.730 | L2-Norm(final)=4.122 | 3921.3 samples/s | 61.3 steps/s
[Step=9850 Epoch=19.2] | Loss=0.04242 | Reg=0.00315 | acc=0.9844 | L2-Norm=17.740 | L2-Norm(final)=4.120 | 3963.2 samples/s | 61.9 steps/s
[Step=9900 Epoch=19.3] | Loss=0.04204 | Reg=0.00315 | acc=0.9219 | L2-Norm=17.751 | L2-Norm(final)=4.118 | 3956.8 samples/s | 61.8 steps/s
[Step=9950 Epoch=19.4] | Loss=0.04148 | Reg=0.00315 | acc=0.9844 | L2-Norm=17.761 | L2-Norm(final)=4.115 | 3969.5 samples/s | 62.0 steps/s
[Step=10000 Epoch=19.5] | Loss=0.04110 | Reg=0.00316 | acc=0.9844 | L2-Norm=17.771 | L2-Norm(final)=4.113 | 3922.9 samples/s | 61.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step10000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=8001 Epoch=15.6] | Loss=0.11324 | Reg=0.00235 | acc=0.9375 | L2-Norm=15.338 | L2-Norm(final)=3.748 | 3477.6 samples/s | 54.3 steps/s
[Step=8050 Epoch=15.7] | Loss=0.09831 | Reg=0.00241 | acc=0.9219 | L2-Norm=15.518 | L2-Norm(final)=3.809 | 3852.0 samples/s | 60.2 steps/s
[Step=8100 Epoch=15.8] | Loss=0.09046 | Reg=0.00246 | acc=0.9688 | L2-Norm=15.675 | L2-Norm(final)=3.855 | 4254.4 samples/s | 66.5 steps/s
[Step=8150 Epoch=15.9] | Loss=0.08918 | Reg=0.00250 | acc=0.9688 | L2-Norm=15.805 | L2-Norm(final)=3.895 | 4342.4 samples/s | 67.9 steps/s
[Step=8200 Epoch=16.0] | Loss=0.08699 | Reg=0.00254 | acc=0.9062 | L2-Norm=15.929 | L2-Norm(final)=3.933 | 4355.1 samples/s | 68.0 steps/s
[Step=8250 Epoch=16.1] | Loss=0.08579 | Reg=0.00257 | acc=0.9375 | L2-Norm=16.038 | L2-Norm(final)=3.965 | 4333.0 samples/s | 67.7 steps/s
[Step=8300 Epoch=16.2] | Loss=0.08416 | Reg=0.00260 | acc=0.9688 | L2-Norm=16.133 | L2-Norm(final)=3.996 | 4273.9 samples/s | 66.8 steps/s
[Step=8350 Epoch=16.3] | Loss=0.08385 | Reg=0.00263 | acc=0.9375 | L2-Norm=16.219 | L2-Norm(final)=4.023 | 4385.6 samples/s | 68.5 steps/s
[Step=8400 Epoch=16.4] | Loss=0.08278 | Reg=0.00266 | acc=0.9375 | L2-Norm=16.300 | L2-Norm(final)=4.051 | 4335.6 samples/s | 67.7 steps/s
[Step=8450 Epoch=16.5] | Loss=0.08194 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.376 | L2-Norm(final)=4.080 | 4393.4 samples/s | 68.6 steps/s
[Step=8500 Epoch=16.6] | Loss=0.08108 | Reg=0.00271 | acc=0.9531 | L2-Norm=16.446 | L2-Norm(final)=4.107 | 5420.9 samples/s | 84.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=16.6] | Loss=0.06235 | Reg=0.00294 | acc=0.9531 | L2-Norm=17.136 | L2-Norm(final)=4.391 | 3342.9 samples/s | 52.2 steps/s
[Step=8550 Epoch=16.7] | Loss=0.06918 | Reg=0.00296 | acc=0.9062 | L2-Norm=17.215 | L2-Norm(final)=4.410 | 3637.7 samples/s | 56.8 steps/s
[Step=8600 Epoch=16.8] | Loss=0.07725 | Reg=0.00299 | acc=0.9219 | L2-Norm=17.280 | L2-Norm(final)=4.395 | 3873.5 samples/s | 60.5 steps/s
[Step=8650 Epoch=16.9] | Loss=0.07397 | Reg=0.00300 | acc=0.9688 | L2-Norm=17.333 | L2-Norm(final)=4.379 | 3884.7 samples/s | 60.7 steps/s
[Step=8700 Epoch=17.0] | Loss=0.07030 | Reg=0.00302 | acc=0.9688 | L2-Norm=17.370 | L2-Norm(final)=4.371 | 3849.2 samples/s | 60.1 steps/s
[Step=8750 Epoch=17.1] | Loss=0.06620 | Reg=0.00303 | acc=0.9062 | L2-Norm=17.401 | L2-Norm(final)=4.366 | 3889.8 samples/s | 60.8 steps/s
[Step=8800 Epoch=17.2] | Loss=0.06360 | Reg=0.00304 | acc=0.9688 | L2-Norm=17.429 | L2-Norm(final)=4.361 | 3927.1 samples/s | 61.4 steps/s
[Step=8850 Epoch=17.3] | Loss=0.06270 | Reg=0.00305 | acc=0.9219 | L2-Norm=17.456 | L2-Norm(final)=4.357 | 3819.4 samples/s | 59.7 steps/s
[Step=8900 Epoch=17.4] | Loss=0.06206 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.480 | L2-Norm(final)=4.350 | 3889.9 samples/s | 60.8 steps/s
[Step=8950 Epoch=17.5] | Loss=0.06071 | Reg=0.00306 | acc=0.9844 | L2-Norm=17.501 | L2-Norm(final)=4.342 | 3943.7 samples/s | 61.6 steps/s
[Step=9000 Epoch=17.6] | Loss=0.05939 | Reg=0.00307 | acc=0.9688 | L2-Norm=17.521 | L2-Norm(final)=4.337 | 4816.8 samples/s | 75.3 steps/s
[Step=9050 Epoch=17.7] | Loss=0.05721 | Reg=0.00308 | acc=0.9688 | L2-Norm=17.541 | L2-Norm(final)=4.332 | 1496.9 samples/s | 23.4 steps/s
[Step=9100 Epoch=17.8] | Loss=0.05543 | Reg=0.00308 | acc=0.9688 | L2-Norm=17.560 | L2-Norm(final)=4.328 | 3924.0 samples/s | 61.3 steps/s
[Step=9150 Epoch=17.9] | Loss=0.05402 | Reg=0.00309 | acc=0.9531 | L2-Norm=17.577 | L2-Norm(final)=4.325 | 3909.5 samples/s | 61.1 steps/s
[Step=9200 Epoch=18.0] | Loss=0.05275 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.593 | L2-Norm(final)=4.322 | 3894.0 samples/s | 60.8 steps/s
[Step=9250 Epoch=18.1] | Loss=0.05130 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.610 | L2-Norm(final)=4.319 | 3935.7 samples/s | 61.5 steps/s
[Step=9300 Epoch=18.2] | Loss=0.05069 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.626 | L2-Norm(final)=4.316 | 3915.5 samples/s | 61.2 steps/s
[Step=9350 Epoch=18.3] | Loss=0.04986 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.642 | L2-Norm(final)=4.313 | 3936.8 samples/s | 61.5 steps/s
[Step=9400 Epoch=18.4] | Loss=0.04912 | Reg=0.00312 | acc=0.9844 | L2-Norm=17.658 | L2-Norm(final)=4.311 | 3915.8 samples/s | 61.2 steps/s
[Step=9450 Epoch=18.5] | Loss=0.04886 | Reg=0.00312 | acc=0.9688 | L2-Norm=17.674 | L2-Norm(final)=4.307 | 3926.7 samples/s | 61.4 steps/s
[Step=9500 Epoch=18.6] | Loss=0.04814 | Reg=0.00313 | acc=0.9688 | L2-Norm=17.691 | L2-Norm(final)=4.304 | 4289.5 samples/s | 67.0 steps/s
[Step=9550 Epoch=18.7] | Loss=0.04737 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.708 | L2-Norm(final)=4.301 | 1570.7 samples/s | 24.5 steps/s
[Step=9600 Epoch=18.8] | Loss=0.04604 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.724 | L2-Norm(final)=4.299 | 3944.1 samples/s | 61.6 steps/s
[Step=9650 Epoch=18.9] | Loss=0.04506 | Reg=0.00315 | acc=0.9844 | L2-Norm=17.738 | L2-Norm(final)=4.298 | 3918.7 samples/s | 61.2 steps/s
[Step=9700 Epoch=19.0] | Loss=0.04454 | Reg=0.00315 | acc=0.9844 | L2-Norm=17.753 | L2-Norm(final)=4.296 | 3905.3 samples/s | 61.0 steps/s
[Step=9750 Epoch=19.1] | Loss=0.04406 | Reg=0.00316 | acc=0.9375 | L2-Norm=17.767 | L2-Norm(final)=4.294 | 3909.8 samples/s | 61.1 steps/s
[Step=9800 Epoch=19.2] | Loss=0.04339 | Reg=0.00316 | acc=0.9688 | L2-Norm=17.781 | L2-Norm(final)=4.292 | 3922.8 samples/s | 61.3 steps/s
[Step=9850 Epoch=19.3] | Loss=0.04290 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.795 | L2-Norm(final)=4.290 | 3959.7 samples/s | 61.9 steps/s
[Step=9900 Epoch=19.4] | Loss=0.04228 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.809 | L2-Norm(final)=4.288 | 3932.5 samples/s | 61.4 steps/s
[Step=9950 Epoch=19.5] | Loss=0.04188 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.823 | L2-Norm(final)=4.286 | 3967.4 samples/s | 62.0 steps/s
[Step=10000 Epoch=19.5] | Loss=0.04155 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.837 | L2-Norm(final)=4.285 | 3950.7 samples/s | 61.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step10000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=8001 Epoch=30.7] | Loss=0.07351 | Reg=0.00235 | acc=0.9375 | L2-Norm=15.338 | L2-Norm(final)=4.331 | 3207.9 samples/s | 50.1 steps/s
[Step=8050 Epoch=30.8] | Loss=0.01647 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.601 | L2-Norm(final)=4.344 | 3996.4 samples/s | 62.4 steps/s
[Step=8100 Epoch=31.0] | Loss=0.01244 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.703 | L2-Norm(final)=4.365 | 4141.8 samples/s | 64.7 steps/s
[Step=8150 Epoch=31.2] | Loss=0.01136 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.798 | L2-Norm(final)=4.392 | 4133.2 samples/s | 64.6 steps/s
[Step=8200 Epoch=31.4] | Loss=0.01031 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.875 | L2-Norm(final)=4.417 | 4120.2 samples/s | 64.4 steps/s
[Step=8250 Epoch=31.6] | Loss=0.00972 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.944 | L2-Norm(final)=4.446 | 5351.8 samples/s | 83.6 steps/s
[Step=8300 Epoch=31.8] | Loss=0.00887 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.005 | L2-Norm(final)=4.473 | 1541.0 samples/s | 24.1 steps/s
[Step=8350 Epoch=32.0] | Loss=0.00804 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.054 | L2-Norm(final)=4.500 | 4017.4 samples/s | 62.8 steps/s
[Step=8400 Epoch=32.2] | Loss=0.00753 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.094 | L2-Norm(final)=4.528 | 4159.6 samples/s | 65.0 steps/s
[Step=8450 Epoch=32.4] | Loss=0.00686 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.127 | L2-Norm(final)=4.556 | 4129.9 samples/s | 64.5 steps/s
[Step=8500 Epoch=32.6] | Loss=0.00659 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.155 | L2-Norm(final)=4.584 | 4558.1 samples/s | 71.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=32.6] | Loss=0.00188 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.436 | L2-Norm(final)=4.861 | 3270.6 samples/s | 51.1 steps/s
[Step=8550 Epoch=32.8] | Loss=0.02660 | Reg=0.00272 | acc=0.9375 | L2-Norm=16.507 | L2-Norm(final)=4.850 | 3540.6 samples/s | 55.3 steps/s
[Step=8600 Epoch=33.0] | Loss=0.02180 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.710 | L2-Norm(final)=4.766 | 3735.3 samples/s | 58.4 steps/s
[Step=8650 Epoch=33.1] | Loss=0.01794 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.809 | L2-Norm(final)=4.740 | 3721.7 samples/s | 58.2 steps/s
[Step=8700 Epoch=33.3] | Loss=0.01472 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.859 | L2-Norm(final)=4.728 | 3765.4 samples/s | 58.8 steps/s
[Step=8750 Epoch=33.5] | Loss=0.01223 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.883 | L2-Norm(final)=4.726 | 4721.1 samples/s | 73.8 steps/s
[Step=8800 Epoch=33.7] | Loss=0.01043 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.890 | L2-Norm(final)=4.726 | 1447.9 samples/s | 22.6 steps/s
[Step=8850 Epoch=33.9] | Loss=0.00897 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.885 | L2-Norm(final)=4.727 | 3674.5 samples/s | 57.4 steps/s
[Step=8900 Epoch=34.1] | Loss=0.00788 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.871 | L2-Norm(final)=4.729 | 3705.4 samples/s | 57.9 steps/s
[Step=8950 Epoch=34.3] | Loss=0.00706 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.852 | L2-Norm(final)=4.732 | 3758.3 samples/s | 58.7 steps/s
[Step=9000 Epoch=34.5] | Loss=0.00640 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.829 | L2-Norm(final)=4.735 | 4132.3 samples/s | 64.6 steps/s
[Step=9050 Epoch=34.7] | Loss=0.00583 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.803 | L2-Norm(final)=4.739 | 1525.9 samples/s | 23.8 steps/s
[Step=9100 Epoch=34.9] | Loss=0.00535 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.775 | L2-Norm(final)=4.742 | 3800.9 samples/s | 59.4 steps/s
[Step=9150 Epoch=35.1] | Loss=0.00494 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.745 | L2-Norm(final)=4.744 | 3731.8 samples/s | 58.3 steps/s
[Step=9200 Epoch=35.3] | Loss=0.00459 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.713 | L2-Norm(final)=4.747 | 3746.8 samples/s | 58.5 steps/s
[Step=9250 Epoch=35.4] | Loss=0.00429 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.680 | L2-Norm(final)=4.750 | 3702.8 samples/s | 57.9 steps/s
[Step=9300 Epoch=35.6] | Loss=0.00402 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.646 | L2-Norm(final)=4.752 | 1648.8 samples/s | 25.8 steps/s
[Step=9350 Epoch=35.8] | Loss=0.00379 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.611 | L2-Norm(final)=4.754 | 3743.6 samples/s | 58.5 steps/s
[Step=9400 Epoch=36.0] | Loss=0.00358 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.576 | L2-Norm(final)=4.756 | 3697.3 samples/s | 57.8 steps/s
[Step=9450 Epoch=36.2] | Loss=0.00339 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.540 | L2-Norm(final)=4.758 | 3760.5 samples/s | 58.8 steps/s
[Step=9500 Epoch=36.4] | Loss=0.00322 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.503 | L2-Norm(final)=4.759 | 3764.8 samples/s | 58.8 steps/s
[Step=9550 Epoch=36.6] | Loss=0.00307 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.466 | L2-Norm(final)=4.761 | 1577.8 samples/s | 24.7 steps/s
[Step=9600 Epoch=36.8] | Loss=0.00293 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.429 | L2-Norm(final)=4.763 | 3770.8 samples/s | 58.9 steps/s
[Step=9650 Epoch=37.0] | Loss=0.00280 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.392 | L2-Norm(final)=4.764 | 3732.0 samples/s | 58.3 steps/s
[Step=9700 Epoch=37.2] | Loss=0.00268 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.354 | L2-Norm(final)=4.765 | 3730.9 samples/s | 58.3 steps/s
[Step=9750 Epoch=37.4] | Loss=0.00258 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.316 | L2-Norm(final)=4.767 | 3796.7 samples/s | 59.3 steps/s
[Step=9800 Epoch=37.6] | Loss=0.00248 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.278 | L2-Norm(final)=4.768 | 5151.0 samples/s | 80.5 steps/s
[Step=9850 Epoch=37.7] | Loss=0.00239 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.239 | L2-Norm(final)=4.769 | 1439.9 samples/s | 22.5 steps/s
[Step=9900 Epoch=37.9] | Loss=0.00230 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.201 | L2-Norm(final)=4.770 | 3800.5 samples/s | 59.4 steps/s
[Step=9950 Epoch=38.1] | Loss=0.00222 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.163 | L2-Norm(final)=4.772 | 3698.9 samples/s | 57.8 steps/s
[Step=10000 Epoch=38.3] | Loss=0.00215 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.124 | L2-Norm(final)=4.773 | 3776.9 samples/s | 59.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step10000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=8001 Epoch=30.8] | Loss=0.03786 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.338 | L2-Norm(final)=4.367 | 3156.9 samples/s | 49.3 steps/s
[Step=8050 Epoch=31.0] | Loss=0.02415 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.613 | L2-Norm(final)=4.352 | 4046.8 samples/s | 63.2 steps/s
[Step=8100 Epoch=31.2] | Loss=0.01910 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.749 | L2-Norm(final)=4.373 | 4103.8 samples/s | 64.1 steps/s
[Step=8150 Epoch=31.4] | Loss=0.01669 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.848 | L2-Norm(final)=4.396 | 4187.1 samples/s | 65.4 steps/s
[Step=8200 Epoch=31.6] | Loss=0.01426 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.938 | L2-Norm(final)=4.426 | 4130.4 samples/s | 64.5 steps/s
[Step=8250 Epoch=31.8] | Loss=0.01311 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.016 | L2-Norm(final)=4.458 | 5499.9 samples/s | 85.9 steps/s
[Step=8300 Epoch=31.9] | Loss=0.01149 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.078 | L2-Norm(final)=4.488 | 1497.4 samples/s | 23.4 steps/s
[Step=8350 Epoch=32.1] | Loss=0.01057 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.126 | L2-Norm(final)=4.520 | 4102.5 samples/s | 64.1 steps/s
[Step=8400 Epoch=32.3] | Loss=0.01000 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.170 | L2-Norm(final)=4.551 | 4114.6 samples/s | 64.3 steps/s
[Step=8450 Epoch=32.5] | Loss=0.00938 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.209 | L2-Norm(final)=4.584 | 4126.9 samples/s | 64.5 steps/s
[Step=8500 Epoch=32.7] | Loss=0.00882 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.248 | L2-Norm(final)=4.618 | 4798.9 samples/s | 75.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=32.7] | Loss=0.00513 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.625 | L2-Norm(final)=4.952 | 3260.9 samples/s | 51.0 steps/s
[Step=8550 Epoch=32.9] | Loss=0.02107 | Reg=0.00279 | acc=0.9844 | L2-Norm=16.701 | L2-Norm(final)=4.959 | 3460.5 samples/s | 54.1 steps/s
[Step=8600 Epoch=33.1] | Loss=0.02502 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.889 | L2-Norm(final)=4.878 | 3790.9 samples/s | 59.2 steps/s
[Step=8650 Epoch=33.3] | Loss=0.01995 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.984 | L2-Norm(final)=4.838 | 3664.7 samples/s | 57.3 steps/s
[Step=8700 Epoch=33.5] | Loss=0.01616 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.021 | L2-Norm(final)=4.822 | 3726.3 samples/s | 58.2 steps/s
[Step=8750 Epoch=33.7] | Loss=0.01372 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.034 | L2-Norm(final)=4.818 | 4753.9 samples/s | 74.3 steps/s
[Step=8800 Epoch=33.9] | Loss=0.01182 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.034 | L2-Norm(final)=4.817 | 1492.8 samples/s | 23.3 steps/s
[Step=8850 Epoch=34.1] | Loss=0.01025 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.025 | L2-Norm(final)=4.818 | 3724.4 samples/s | 58.2 steps/s
[Step=8900 Epoch=34.3] | Loss=0.00905 | Reg=0.00289 | acc=1.0000 | L2-Norm=17.010 | L2-Norm(final)=4.820 | 3717.6 samples/s | 58.1 steps/s
[Step=8950 Epoch=34.5] | Loss=0.00808 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.990 | L2-Norm(final)=4.824 | 3719.6 samples/s | 58.1 steps/s
[Step=9000 Epoch=34.6] | Loss=0.00729 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.967 | L2-Norm(final)=4.828 | 4250.7 samples/s | 66.4 steps/s
[Step=9050 Epoch=34.8] | Loss=0.00664 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.940 | L2-Norm(final)=4.831 | 1551.8 samples/s | 24.2 steps/s
[Step=9100 Epoch=35.0] | Loss=0.00608 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.912 | L2-Norm(final)=4.835 | 3671.2 samples/s | 57.4 steps/s
[Step=9150 Epoch=35.2] | Loss=0.00562 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.881 | L2-Norm(final)=4.838 | 3768.0 samples/s | 58.9 steps/s
[Step=9200 Epoch=35.4] | Loss=0.00522 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.849 | L2-Norm(final)=4.841 | 3752.1 samples/s | 58.6 steps/s
[Step=9250 Epoch=35.6] | Loss=0.00487 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.816 | L2-Norm(final)=4.843 | 3754.2 samples/s | 58.7 steps/s
[Step=9300 Epoch=35.8] | Loss=0.00457 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.782 | L2-Norm(final)=4.845 | 1586.6 samples/s | 24.8 steps/s
[Step=9350 Epoch=36.0] | Loss=0.00430 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.747 | L2-Norm(final)=4.847 | 3741.5 samples/s | 58.5 steps/s
[Step=9400 Epoch=36.2] | Loss=0.00406 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.711 | L2-Norm(final)=4.849 | 3706.3 samples/s | 57.9 steps/s
[Step=9450 Epoch=36.4] | Loss=0.00385 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.676 | L2-Norm(final)=4.851 | 3749.9 samples/s | 58.6 steps/s
[Step=9500 Epoch=36.6] | Loss=0.00366 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.639 | L2-Norm(final)=4.853 | 3685.5 samples/s | 57.6 steps/s
[Step=9550 Epoch=36.8] | Loss=0.00348 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.603 | L2-Norm(final)=4.855 | 1550.7 samples/s | 24.2 steps/s
[Step=9600 Epoch=37.0] | Loss=0.00333 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.566 | L2-Norm(final)=4.856 | 3743.3 samples/s | 58.5 steps/s
[Step=9650 Epoch=37.1] | Loss=0.00318 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.528 | L2-Norm(final)=4.858 | 3718.9 samples/s | 58.1 steps/s
[Step=9700 Epoch=37.3] | Loss=0.00305 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.491 | L2-Norm(final)=4.859 | 3714.5 samples/s | 58.0 steps/s
[Step=9750 Epoch=37.5] | Loss=0.00293 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.453 | L2-Norm(final)=4.860 | 3722.3 samples/s | 58.2 steps/s
[Step=9800 Epoch=37.7] | Loss=0.00282 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.416 | L2-Norm(final)=4.862 | 5425.7 samples/s | 84.8 steps/s
[Step=9850 Epoch=37.9] | Loss=0.00271 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.378 | L2-Norm(final)=4.863 | 1378.9 samples/s | 21.5 steps/s
[Step=9900 Epoch=38.1] | Loss=0.00261 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.340 | L2-Norm(final)=4.864 | 3720.2 samples/s | 58.1 steps/s
[Step=9950 Epoch=38.3] | Loss=0.00253 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.301 | L2-Norm(final)=4.866 | 3643.1 samples/s | 56.9 steps/s
[Step=10000 Epoch=38.5] | Loss=0.00244 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.263 | L2-Norm(final)=4.867 | 3756.9 samples/s | 58.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step10000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07021 | acc=0.9527 | tpr=0.9497 | fpr=0.0409 | 3502.9 samples/s | 13.7 steps/s
Avg test loss: 0.07373, Avg test acc: 0.95256, Avg tpr: 0.95063, Avg fpr: 0.04320, total FA: 337

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06337 | acc=0.9582 | tpr=0.9740 | fpr=0.0761 | 3525.4 samples/s | 13.8 steps/s
Avg test loss: 0.06858, Avg test acc: 0.95629, Avg tpr: 0.97127, Avg fpr: 0.07666, total FA: 598

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.97806 | acc=0.3116 | tpr=0.0083 | fpr=0.0300 | 3500.2 samples/s | 13.7 steps/s
Avg test loss: 5.00849, Avg test acc: 0.30944, Avg tpr: 0.00868, Avg fpr: 0.02910, total FA: 227

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.50528 | acc=0.3119 | tpr=0.0088 | fpr=0.0300 | 3579.7 samples/s | 14.0 steps/s
Avg test loss: 4.52547, Avg test acc: 0.31076, Avg tpr: 0.00921, Avg fpr: 0.02602, total FA: 203

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.53479 | acc=0.1155 | tpr=0.7035 | fpr=0.8950 | 3570.4 samples/s | 13.9 steps/s
[Step= 100] | Loss=4.51479 | acc=0.1184 | tpr=0.7399 | fpr=0.8932 | 6527.9 samples/s | 25.5 steps/s
[Step= 150] | Loss=4.51235 | acc=0.1183 | tpr=0.7464 | fpr=0.8933 | 7082.2 samples/s | 27.7 steps/s
[Step= 200] | Loss=4.49453 | acc=0.1188 | tpr=0.7355 | fpr=0.8924 | 6779.4 samples/s | 26.5 steps/s
[Step= 250] | Loss=4.50014 | acc=0.1188 | tpr=0.7415 | fpr=0.8926 | 7371.7 samples/s | 28.8 steps/s
[Step= 300] | Loss=4.49948 | acc=0.1190 | tpr=0.7396 | fpr=0.8923 | 6496.3 samples/s | 25.4 steps/s
[Step= 350] | Loss=4.49243 | acc=0.1199 | tpr=0.7383 | fpr=0.8913 | 6986.7 samples/s | 27.3 steps/s
[Step= 400] | Loss=4.49060 | acc=0.1195 | tpr=0.7434 | fpr=0.8918 | 6712.9 samples/s | 26.2 steps/s
[Step= 450] | Loss=4.49384 | acc=0.1190 | tpr=0.7468 | fpr=0.8924 | 6872.6 samples/s | 26.8 steps/s
[Step= 500] | Loss=4.49443 | acc=0.1187 | tpr=0.7463 | fpr=0.8926 | 6678.8 samples/s | 26.1 steps/s
[Step= 550] | Loss=4.49677 | acc=0.1188 | tpr=0.7449 | fpr=0.8925 | 12361.5 samples/s | 48.3 steps/s
Avg test loss: 4.49875, Avg test acc: 0.11877, Avg tpr: 0.74525, Avg fpr: 0.89262, total FA: 123938

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.11309 | acc=0.1112 | tpr=0.8274 | fpr=0.9017 | 3492.9 samples/s | 13.6 steps/s
[Step= 100] | Loss=5.07732 | acc=0.1115 | tpr=0.8443 | fpr=0.9022 | 7071.9 samples/s | 27.6 steps/s
[Step= 150] | Loss=5.09585 | acc=0.1102 | tpr=0.8429 | fpr=0.9033 | 6900.1 samples/s | 27.0 steps/s
[Step= 200] | Loss=5.08627 | acc=0.1105 | tpr=0.8448 | fpr=0.9028 | 6918.6 samples/s | 27.0 steps/s
[Step= 250] | Loss=5.09719 | acc=0.1108 | tpr=0.8402 | fpr=0.9025 | 6822.2 samples/s | 26.6 steps/s
[Step= 300] | Loss=5.09931 | acc=0.1104 | tpr=0.8327 | fpr=0.9028 | 6883.9 samples/s | 26.9 steps/s
[Step= 350] | Loss=5.09377 | acc=0.1110 | tpr=0.8328 | fpr=0.9021 | 7011.0 samples/s | 27.4 steps/s
[Step= 400] | Loss=5.08921 | acc=0.1115 | tpr=0.8299 | fpr=0.9016 | 6669.4 samples/s | 26.1 steps/s
[Step= 450] | Loss=5.09338 | acc=0.1111 | tpr=0.8325 | fpr=0.9020 | 6932.9 samples/s | 27.1 steps/s
[Step= 500] | Loss=5.09299 | acc=0.1109 | tpr=0.8352 | fpr=0.9021 | 6805.8 samples/s | 26.6 steps/s
[Step= 550] | Loss=5.09606 | acc=0.1109 | tpr=0.8376 | fpr=0.9023 | 12598.6 samples/s | 49.2 steps/s
Avg test loss: 5.09776, Avg test acc: 0.11088, Avg tpr: 0.83716, Avg fpr: 0.90232, total FA: 125285

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10967 | acc=0.9814 | tpr=0.9204 | fpr=0.0175 | 3518.3 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.11393 | acc=0.9800 | tpr=0.9318 | fpr=0.0191 | 6910.1 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.11968 | acc=0.9793 | tpr=0.9323 | fpr=0.0199 | 7026.6 samples/s | 27.4 steps/s
[Step= 200] | Loss=0.12087 | acc=0.9794 | tpr=0.9388 | fpr=0.0199 | 7007.7 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.11786 | acc=0.9799 | tpr=0.9380 | fpr=0.0194 | 6699.1 samples/s | 26.2 steps/s
[Step= 300] | Loss=0.11933 | acc=0.9797 | tpr=0.9389 | fpr=0.0196 | 6890.6 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.11977 | acc=0.9794 | tpr=0.9374 | fpr=0.0199 | 6833.0 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.12114 | acc=0.9792 | tpr=0.9354 | fpr=0.0200 | 6810.8 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.12322 | acc=0.9789 | tpr=0.9323 | fpr=0.0202 | 6700.2 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.12273 | acc=0.9790 | tpr=0.9339 | fpr=0.0202 | 6865.3 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.12195 | acc=0.9792 | tpr=0.9324 | fpr=0.0200 | 12381.2 samples/s | 48.4 steps/s
Avg test loss: 0.12172, Avg test acc: 0.97918, Avg tpr: 0.93225, Avg fpr: 0.01996, total FA: 2772

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.08769 | acc=0.9831 | tpr=0.9292 | fpr=0.0159 | 3493.0 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.09422 | acc=0.9824 | tpr=0.9446 | fpr=0.0169 | 6831.2 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.09737 | acc=0.9817 | tpr=0.9452 | fpr=0.0176 | 6794.2 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.09855 | acc=0.9817 | tpr=0.9475 | fpr=0.0177 | 6931.0 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.09649 | acc=0.9817 | tpr=0.9424 | fpr=0.0175 | 6828.2 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.09882 | acc=0.9812 | tpr=0.9433 | fpr=0.0181 | 6788.3 samples/s | 26.5 steps/s
[Step= 350] | Loss=0.09920 | acc=0.9810 | tpr=0.9418 | fpr=0.0183 | 6930.3 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.10022 | acc=0.9808 | tpr=0.9409 | fpr=0.0184 | 6689.4 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.10151 | acc=0.9805 | tpr=0.9387 | fpr=0.0187 | 6778.0 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.10069 | acc=0.9807 | tpr=0.9414 | fpr=0.0186 | 6633.8 samples/s | 25.9 steps/s
[Step= 550] | Loss=0.10009 | acc=0.9809 | tpr=0.9403 | fpr=0.0184 | 12779.2 samples/s | 49.9 steps/s
Avg test loss: 0.09987, Avg test acc: 0.98088, Avg tpr: 0.94017, Avg fpr: 0.01838, total FA: 2552

server round 5/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=10001 Epoch=19.5] | Loss=0.10744 | Reg=0.00231 | acc=0.9062 | L2-Norm=15.189 | L2-Norm(final)=4.049 | 3066.4 samples/s | 47.9 steps/s
[Step=10050 Epoch=19.6] | Loss=0.08130 | Reg=0.00234 | acc=0.9688 | L2-Norm=15.309 | L2-Norm(final)=4.095 | 4186.0 samples/s | 65.4 steps/s
[Step=10100 Epoch=19.7] | Loss=0.07526 | Reg=0.00238 | acc=0.9531 | L2-Norm=15.418 | L2-Norm(final)=4.133 | 4405.3 samples/s | 68.8 steps/s
[Step=10150 Epoch=19.8] | Loss=0.07177 | Reg=0.00241 | acc=0.9375 | L2-Norm=15.509 | L2-Norm(final)=4.172 | 4292.2 samples/s | 67.1 steps/s
[Step=10200 Epoch=19.9] | Loss=0.06977 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.598 | L2-Norm(final)=4.204 | 4332.3 samples/s | 67.7 steps/s
[Step=10250 Epoch=20.0] | Loss=0.06792 | Reg=0.00246 | acc=0.9219 | L2-Norm=15.678 | L2-Norm(final)=4.232 | 4382.7 samples/s | 68.5 steps/s
[Step=10300 Epoch=20.1] | Loss=0.06736 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.752 | L2-Norm(final)=4.260 | 4365.3 samples/s | 68.2 steps/s
[Step=10350 Epoch=20.2] | Loss=0.06599 | Reg=0.00250 | acc=0.9219 | L2-Norm=15.820 | L2-Norm(final)=4.285 | 4376.1 samples/s | 68.4 steps/s
[Step=10400 Epoch=20.3] | Loss=0.06523 | Reg=0.00252 | acc=0.9531 | L2-Norm=15.886 | L2-Norm(final)=4.309 | 4413.5 samples/s | 69.0 steps/s
[Step=10450 Epoch=20.4] | Loss=0.06473 | Reg=0.00255 | acc=0.9219 | L2-Norm=15.949 | L2-Norm(final)=4.330 | 4352.0 samples/s | 68.0 steps/s
[Step=10500 Epoch=20.5] | Loss=0.06403 | Reg=0.00256 | acc=0.9844 | L2-Norm=16.011 | L2-Norm(final)=4.352 | 5540.6 samples/s | 86.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=20.5] | Loss=0.05634 | Reg=0.00276 | acc=0.9375 | L2-Norm=16.623 | L2-Norm(final)=4.572 | 3213.7 samples/s | 50.2 steps/s
[Step=10550 Epoch=20.6] | Loss=0.06621 | Reg=0.00278 | acc=0.9844 | L2-Norm=16.688 | L2-Norm(final)=4.564 | 3627.4 samples/s | 56.7 steps/s
[Step=10600 Epoch=20.7] | Loss=0.06036 | Reg=0.00280 | acc=0.9688 | L2-Norm=16.737 | L2-Norm(final)=4.546 | 3945.3 samples/s | 61.6 steps/s
[Step=10650 Epoch=20.8] | Loss=0.06328 | Reg=0.00282 | acc=0.9375 | L2-Norm=16.781 | L2-Norm(final)=4.531 | 3904.5 samples/s | 61.0 steps/s
[Step=10700 Epoch=20.9] | Loss=0.06118 | Reg=0.00283 | acc=0.9688 | L2-Norm=16.824 | L2-Norm(final)=4.515 | 3939.5 samples/s | 61.6 steps/s
[Step=10750 Epoch=21.0] | Loss=0.05956 | Reg=0.00284 | acc=0.9688 | L2-Norm=16.861 | L2-Norm(final)=4.503 | 3956.0 samples/s | 61.8 steps/s
[Step=10800 Epoch=21.1] | Loss=0.05796 | Reg=0.00285 | acc=0.9844 | L2-Norm=16.895 | L2-Norm(final)=4.492 | 4018.6 samples/s | 62.8 steps/s
[Step=10850 Epoch=21.2] | Loss=0.05602 | Reg=0.00287 | acc=0.9844 | L2-Norm=16.928 | L2-Norm(final)=4.484 | 3927.2 samples/s | 61.4 steps/s
[Step=10900 Epoch=21.3] | Loss=0.05498 | Reg=0.00288 | acc=0.9531 | L2-Norm=16.959 | L2-Norm(final)=4.478 | 4005.7 samples/s | 62.6 steps/s
[Step=10950 Epoch=21.4] | Loss=0.05421 | Reg=0.00289 | acc=0.9531 | L2-Norm=16.988 | L2-Norm(final)=4.472 | 3940.2 samples/s | 61.6 steps/s
[Step=11000 Epoch=21.5] | Loss=0.05245 | Reg=0.00290 | acc=0.9688 | L2-Norm=17.019 | L2-Norm(final)=4.468 | 4791.2 samples/s | 74.9 steps/s
[Step=11050 Epoch=21.6] | Loss=0.05123 | Reg=0.00291 | acc=0.9844 | L2-Norm=17.048 | L2-Norm(final)=4.465 | 1477.3 samples/s | 23.1 steps/s
[Step=11100 Epoch=21.6] | Loss=0.04963 | Reg=0.00292 | acc=0.9688 | L2-Norm=17.075 | L2-Norm(final)=4.463 | 3924.7 samples/s | 61.3 steps/s
[Step=11150 Epoch=21.7] | Loss=0.04793 | Reg=0.00292 | acc=0.9844 | L2-Norm=17.100 | L2-Norm(final)=4.461 | 3936.9 samples/s | 61.5 steps/s
[Step=11200 Epoch=21.8] | Loss=0.04714 | Reg=0.00293 | acc=0.9531 | L2-Norm=17.124 | L2-Norm(final)=4.459 | 3946.7 samples/s | 61.7 steps/s
[Step=11250 Epoch=21.9] | Loss=0.04634 | Reg=0.00294 | acc=0.9844 | L2-Norm=17.147 | L2-Norm(final)=4.456 | 3955.6 samples/s | 61.8 steps/s
[Step=11300 Epoch=22.0] | Loss=0.04543 | Reg=0.00295 | acc=0.9219 | L2-Norm=17.169 | L2-Norm(final)=4.453 | 3881.9 samples/s | 60.7 steps/s
[Step=11350 Epoch=22.1] | Loss=0.04464 | Reg=0.00296 | acc=0.9844 | L2-Norm=17.191 | L2-Norm(final)=4.451 | 3949.4 samples/s | 61.7 steps/s
[Step=11400 Epoch=22.2] | Loss=0.04423 | Reg=0.00296 | acc=0.9688 | L2-Norm=17.213 | L2-Norm(final)=4.448 | 3970.7 samples/s | 62.0 steps/s
[Step=11450 Epoch=22.3] | Loss=0.04370 | Reg=0.00297 | acc=0.9531 | L2-Norm=17.234 | L2-Norm(final)=4.444 | 3948.8 samples/s | 61.7 steps/s
[Step=11500 Epoch=22.4] | Loss=0.04340 | Reg=0.00298 | acc=0.9844 | L2-Norm=17.254 | L2-Norm(final)=4.441 | 4133.1 samples/s | 64.6 steps/s
[Step=11550 Epoch=22.5] | Loss=0.04265 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.274 | L2-Norm(final)=4.438 | 1574.7 samples/s | 24.6 steps/s
[Step=11600 Epoch=22.6] | Loss=0.04193 | Reg=0.00299 | acc=0.9688 | L2-Norm=17.293 | L2-Norm(final)=4.436 | 3939.9 samples/s | 61.6 steps/s
[Step=11650 Epoch=22.7] | Loss=0.04113 | Reg=0.00300 | acc=0.9688 | L2-Norm=17.311 | L2-Norm(final)=4.434 | 3918.6 samples/s | 61.2 steps/s
[Step=11700 Epoch=22.8] | Loss=0.04041 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.329 | L2-Norm(final)=4.432 | 3962.5 samples/s | 61.9 steps/s
[Step=11750 Epoch=22.9] | Loss=0.03990 | Reg=0.00301 | acc=0.9688 | L2-Norm=17.346 | L2-Norm(final)=4.430 | 3953.7 samples/s | 61.8 steps/s
[Step=11800 Epoch=23.0] | Loss=0.03958 | Reg=0.00302 | acc=0.9688 | L2-Norm=17.363 | L2-Norm(final)=4.427 | 3920.7 samples/s | 61.3 steps/s
[Step=11850 Epoch=23.1] | Loss=0.03919 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.381 | L2-Norm(final)=4.425 | 3937.4 samples/s | 61.5 steps/s
[Step=11900 Epoch=23.2] | Loss=0.03875 | Reg=0.00303 | acc=0.9844 | L2-Norm=17.398 | L2-Norm(final)=4.423 | 3940.7 samples/s | 61.6 steps/s
[Step=11950 Epoch=23.3] | Loss=0.03853 | Reg=0.00303 | acc=0.9844 | L2-Norm=17.416 | L2-Norm(final)=4.421 | 3952.8 samples/s | 61.8 steps/s
[Step=12000 Epoch=23.4] | Loss=0.03824 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.433 | L2-Norm(final)=4.419 | 3937.4 samples/s | 61.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step12000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=10001 Epoch=19.6] | Loss=0.06999 | Reg=0.00231 | acc=0.9688 | L2-Norm=15.189 | L2-Norm(final)=4.231 | 3263.0 samples/s | 51.0 steps/s
[Step=10050 Epoch=19.6] | Loss=0.07957 | Reg=0.00237 | acc=0.8906 | L2-Norm=15.378 | L2-Norm(final)=4.260 | 4197.8 samples/s | 65.6 steps/s
[Step=10100 Epoch=19.7] | Loss=0.07704 | Reg=0.00241 | acc=0.9062 | L2-Norm=15.509 | L2-Norm(final)=4.287 | 4424.3 samples/s | 69.1 steps/s
[Step=10150 Epoch=19.8] | Loss=0.07372 | Reg=0.00244 | acc=0.9375 | L2-Norm=15.620 | L2-Norm(final)=4.326 | 4293.3 samples/s | 67.1 steps/s
[Step=10200 Epoch=19.9] | Loss=0.07304 | Reg=0.00247 | acc=0.9375 | L2-Norm=15.722 | L2-Norm(final)=4.358 | 4347.5 samples/s | 67.9 steps/s
[Step=10250 Epoch=20.0] | Loss=0.07178 | Reg=0.00250 | acc=0.9219 | L2-Norm=15.815 | L2-Norm(final)=4.384 | 4367.2 samples/s | 68.2 steps/s
[Step=10300 Epoch=20.1] | Loss=0.07000 | Reg=0.00253 | acc=0.9375 | L2-Norm=15.898 | L2-Norm(final)=4.412 | 4337.6 samples/s | 67.8 steps/s
[Step=10350 Epoch=20.2] | Loss=0.07003 | Reg=0.00255 | acc=0.9531 | L2-Norm=15.976 | L2-Norm(final)=4.438 | 4311.3 samples/s | 67.4 steps/s
[Step=10400 Epoch=20.3] | Loss=0.06902 | Reg=0.00258 | acc=0.9375 | L2-Norm=16.052 | L2-Norm(final)=4.465 | 4446.1 samples/s | 69.5 steps/s
[Step=10450 Epoch=20.4] | Loss=0.06865 | Reg=0.00260 | acc=0.9844 | L2-Norm=16.121 | L2-Norm(final)=4.492 | 4340.5 samples/s | 67.8 steps/s
[Step=10500 Epoch=20.5] | Loss=0.06807 | Reg=0.00262 | acc=0.9688 | L2-Norm=16.188 | L2-Norm(final)=4.518 | 5562.9 samples/s | 86.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=20.5] | Loss=0.04329 | Reg=0.00284 | acc=0.9531 | L2-Norm=16.848 | L2-Norm(final)=4.786 | 3428.9 samples/s | 53.6 steps/s
[Step=10550 Epoch=20.6] | Loss=0.05647 | Reg=0.00286 | acc=0.9688 | L2-Norm=16.925 | L2-Norm(final)=4.797 | 3561.7 samples/s | 55.7 steps/s
[Step=10600 Epoch=20.7] | Loss=0.05702 | Reg=0.00289 | acc=0.9375 | L2-Norm=16.989 | L2-Norm(final)=4.786 | 3904.1 samples/s | 61.0 steps/s
[Step=10650 Epoch=20.8] | Loss=0.05726 | Reg=0.00290 | acc=0.9531 | L2-Norm=17.038 | L2-Norm(final)=4.766 | 3950.3 samples/s | 61.7 steps/s
[Step=10700 Epoch=20.9] | Loss=0.05796 | Reg=0.00292 | acc=0.9531 | L2-Norm=17.076 | L2-Norm(final)=4.748 | 3956.8 samples/s | 61.8 steps/s
[Step=10750 Epoch=21.0] | Loss=0.05619 | Reg=0.00293 | acc=0.9688 | L2-Norm=17.112 | L2-Norm(final)=4.736 | 3995.4 samples/s | 62.4 steps/s
[Step=10800 Epoch=21.1] | Loss=0.05719 | Reg=0.00294 | acc=0.9844 | L2-Norm=17.146 | L2-Norm(final)=4.723 | 3910.2 samples/s | 61.1 steps/s
[Step=10850 Epoch=21.2] | Loss=0.05561 | Reg=0.00295 | acc=0.9688 | L2-Norm=17.179 | L2-Norm(final)=4.715 | 3929.9 samples/s | 61.4 steps/s
[Step=10900 Epoch=21.3] | Loss=0.05369 | Reg=0.00296 | acc=0.9844 | L2-Norm=17.209 | L2-Norm(final)=4.709 | 3936.2 samples/s | 61.5 steps/s
[Step=10950 Epoch=21.4] | Loss=0.05461 | Reg=0.00297 | acc=0.9688 | L2-Norm=17.237 | L2-Norm(final)=4.702 | 3978.0 samples/s | 62.2 steps/s
[Step=11000 Epoch=21.5] | Loss=0.05445 | Reg=0.00298 | acc=0.9375 | L2-Norm=17.267 | L2-Norm(final)=4.694 | 4809.1 samples/s | 75.1 steps/s
[Step=11050 Epoch=21.6] | Loss=0.05245 | Reg=0.00299 | acc=0.9844 | L2-Norm=17.296 | L2-Norm(final)=4.689 | 1548.9 samples/s | 24.2 steps/s
[Step=11100 Epoch=21.7] | Loss=0.05157 | Reg=0.00300 | acc=0.9688 | L2-Norm=17.322 | L2-Norm(final)=4.685 | 3913.3 samples/s | 61.1 steps/s
[Step=11150 Epoch=21.8] | Loss=0.05009 | Reg=0.00301 | acc=0.9688 | L2-Norm=17.347 | L2-Norm(final)=4.680 | 3947.5 samples/s | 61.7 steps/s
[Step=11200 Epoch=21.9] | Loss=0.04876 | Reg=0.00302 | acc=0.9844 | L2-Norm=17.371 | L2-Norm(final)=4.677 | 3891.5 samples/s | 60.8 steps/s
[Step=11250 Epoch=22.0] | Loss=0.04796 | Reg=0.00303 | acc=0.9688 | L2-Norm=17.394 | L2-Norm(final)=4.674 | 3933.0 samples/s | 61.5 steps/s
[Step=11300 Epoch=22.1] | Loss=0.04706 | Reg=0.00303 | acc=0.9688 | L2-Norm=17.416 | L2-Norm(final)=4.671 | 3963.4 samples/s | 61.9 steps/s
[Step=11350 Epoch=22.2] | Loss=0.04603 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.437 | L2-Norm(final)=4.670 | 3969.3 samples/s | 62.0 steps/s
[Step=11400 Epoch=22.3] | Loss=0.04534 | Reg=0.00305 | acc=0.9844 | L2-Norm=17.458 | L2-Norm(final)=4.668 | 3943.3 samples/s | 61.6 steps/s
[Step=11450 Epoch=22.4] | Loss=0.04441 | Reg=0.00306 | acc=0.9688 | L2-Norm=17.479 | L2-Norm(final)=4.667 | 3925.3 samples/s | 61.3 steps/s
[Step=11500 Epoch=22.5] | Loss=0.04368 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.499 | L2-Norm(final)=4.666 | 4300.5 samples/s | 67.2 steps/s
[Step=11550 Epoch=22.6] | Loss=0.04321 | Reg=0.00307 | acc=0.9844 | L2-Norm=17.519 | L2-Norm(final)=4.665 | 1578.0 samples/s | 24.7 steps/s
[Step=11600 Epoch=22.7] | Loss=0.04249 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.538 | L2-Norm(final)=4.664 | 3903.1 samples/s | 61.0 steps/s
[Step=11650 Epoch=22.8] | Loss=0.04176 | Reg=0.00308 | acc=0.9531 | L2-Norm=17.558 | L2-Norm(final)=4.663 | 3943.2 samples/s | 61.6 steps/s
[Step=11700 Epoch=22.9] | Loss=0.04120 | Reg=0.00309 | acc=0.9844 | L2-Norm=17.577 | L2-Norm(final)=4.662 | 3912.1 samples/s | 61.1 steps/s
[Step=11750 Epoch=23.0] | Loss=0.04083 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.595 | L2-Norm(final)=4.661 | 3960.4 samples/s | 61.9 steps/s
[Step=11800 Epoch=23.1] | Loss=0.04028 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.614 | L2-Norm(final)=4.660 | 3926.6 samples/s | 61.4 steps/s
[Step=11850 Epoch=23.2] | Loss=0.03988 | Reg=0.00311 | acc=0.9688 | L2-Norm=17.632 | L2-Norm(final)=4.659 | 3945.2 samples/s | 61.6 steps/s
[Step=11900 Epoch=23.3] | Loss=0.03947 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.650 | L2-Norm(final)=4.659 | 3906.1 samples/s | 61.0 steps/s
[Step=11950 Epoch=23.4] | Loss=0.03904 | Reg=0.00312 | acc=0.9844 | L2-Norm=17.668 | L2-Norm(final)=4.658 | 3911.8 samples/s | 61.1 steps/s
[Step=12000 Epoch=23.5] | Loss=0.03867 | Reg=0.00313 | acc=0.9688 | L2-Norm=17.686 | L2-Norm(final)=4.656 | 3949.4 samples/s | 61.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step12000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=10001 Epoch=38.3] | Loss=0.05990 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.189 | L2-Norm(final)=4.805 | 3283.3 samples/s | 51.3 steps/s
[Step=10050 Epoch=38.5] | Loss=0.01521 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.479 | L2-Norm(final)=4.775 | 3731.7 samples/s | 58.3 steps/s
[Step=10100 Epoch=38.7] | Loss=0.01046 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.661 | L2-Norm(final)=4.796 | 4068.3 samples/s | 63.6 steps/s
[Step=10150 Epoch=38.9] | Loss=0.00816 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.762 | L2-Norm(final)=4.824 | 4108.2 samples/s | 64.2 steps/s
[Step=10200 Epoch=39.1] | Loss=0.00713 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.820 | L2-Norm(final)=4.852 | 4151.6 samples/s | 64.9 steps/s
[Step=10250 Epoch=39.3] | Loss=0.00642 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.875 | L2-Norm(final)=4.878 | 5275.6 samples/s | 82.4 steps/s
[Step=10300 Epoch=39.5] | Loss=0.00558 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.920 | L2-Norm(final)=4.903 | 1503.3 samples/s | 23.5 steps/s
[Step=10350 Epoch=39.7] | Loss=0.00501 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.949 | L2-Norm(final)=4.928 | 4083.8 samples/s | 63.8 steps/s
[Step=10400 Epoch=39.8] | Loss=0.00464 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.973 | L2-Norm(final)=4.953 | 4115.1 samples/s | 64.3 steps/s
[Step=10450 Epoch=40.0] | Loss=0.00425 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.989 | L2-Norm(final)=4.977 | 4102.8 samples/s | 64.1 steps/s
[Step=10500 Epoch=40.2] | Loss=0.00396 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.999 | L2-Norm(final)=5.002 | 4605.1 samples/s | 72.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=40.2] | Loss=0.00095 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.086 | L2-Norm(final)=5.252 | 3058.7 samples/s | 47.8 steps/s
[Step=10550 Epoch=40.4] | Loss=0.00065 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.059 | L2-Norm(final)=5.269 | 3673.9 samples/s | 57.4 steps/s
[Step=10600 Epoch=40.6] | Loss=0.01274 | Reg=0.00260 | acc=0.9531 | L2-Norm=16.129 | L2-Norm(final)=5.257 | 3674.5 samples/s | 57.4 steps/s
[Step=10650 Epoch=40.8] | Loss=0.01377 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.311 | L2-Norm(final)=5.208 | 3705.1 samples/s | 57.9 steps/s
[Step=10700 Epoch=41.0] | Loss=0.01180 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.419 | L2-Norm(final)=5.177 | 3744.6 samples/s | 58.5 steps/s
[Step=10750 Epoch=41.2] | Loss=0.01064 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.481 | L2-Norm(final)=5.160 | 4668.4 samples/s | 72.9 steps/s
[Step=10800 Epoch=41.4] | Loss=0.00916 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.520 | L2-Norm(final)=5.151 | 1486.9 samples/s | 23.2 steps/s
[Step=10850 Epoch=41.6] | Loss=0.00788 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.541 | L2-Norm(final)=5.146 | 3707.0 samples/s | 57.9 steps/s
[Step=10900 Epoch=41.8] | Loss=0.00706 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.546 | L2-Norm(final)=5.143 | 3708.9 samples/s | 58.0 steps/s
[Step=10950 Epoch=42.0] | Loss=0.00656 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.544 | L2-Norm(final)=5.138 | 3705.8 samples/s | 57.9 steps/s
[Step=11000 Epoch=42.1] | Loss=0.00602 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.537 | L2-Norm(final)=5.134 | 4054.9 samples/s | 63.4 steps/s
[Step=11050 Epoch=42.3] | Loss=0.00549 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.524 | L2-Norm(final)=5.131 | 1492.4 samples/s | 23.3 steps/s
[Step=11100 Epoch=42.5] | Loss=0.00504 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.507 | L2-Norm(final)=5.129 | 3719.3 samples/s | 58.1 steps/s
[Step=11150 Epoch=42.7] | Loss=0.00466 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.486 | L2-Norm(final)=5.128 | 3738.3 samples/s | 58.4 steps/s
[Step=11200 Epoch=42.9] | Loss=0.00433 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.463 | L2-Norm(final)=5.128 | 3678.5 samples/s | 57.5 steps/s
[Step=11250 Epoch=43.1] | Loss=0.00404 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.438 | L2-Norm(final)=5.128 | 3771.8 samples/s | 58.9 steps/s
[Step=11300 Epoch=43.3] | Loss=0.00384 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.411 | L2-Norm(final)=5.127 | 1612.5 samples/s | 25.2 steps/s
[Step=11350 Epoch=43.5] | Loss=0.00362 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.385 | L2-Norm(final)=5.127 | 3824.0 samples/s | 59.8 steps/s
[Step=11400 Epoch=43.7] | Loss=0.00343 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.358 | L2-Norm(final)=5.127 | 3684.5 samples/s | 57.6 steps/s
[Step=11450 Epoch=43.9] | Loss=0.00325 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.330 | L2-Norm(final)=5.127 | 3726.9 samples/s | 58.2 steps/s
[Step=11500 Epoch=44.1] | Loss=0.00308 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.300 | L2-Norm(final)=5.128 | 3715.6 samples/s | 58.1 steps/s
[Step=11550 Epoch=44.3] | Loss=0.00294 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.270 | L2-Norm(final)=5.128 | 1626.4 samples/s | 25.4 steps/s
[Step=11600 Epoch=44.4] | Loss=0.00281 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.239 | L2-Norm(final)=5.128 | 3640.0 samples/s | 56.9 steps/s
[Step=11650 Epoch=44.6] | Loss=0.00268 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.207 | L2-Norm(final)=5.129 | 3749.1 samples/s | 58.6 steps/s
[Step=11700 Epoch=44.8] | Loss=0.00257 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.175 | L2-Norm(final)=5.129 | 3729.5 samples/s | 58.3 steps/s
[Step=11750 Epoch=45.0] | Loss=0.00247 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.142 | L2-Norm(final)=5.130 | 3742.2 samples/s | 58.5 steps/s
[Step=11800 Epoch=45.2] | Loss=0.00238 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.109 | L2-Norm(final)=5.131 | 5094.0 samples/s | 79.6 steps/s
[Step=11850 Epoch=45.4] | Loss=0.00229 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.075 | L2-Norm(final)=5.131 | 1410.5 samples/s | 22.0 steps/s
[Step=11900 Epoch=45.6] | Loss=0.00221 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.041 | L2-Norm(final)=5.132 | 3729.6 samples/s | 58.3 steps/s
[Step=11950 Epoch=45.8] | Loss=0.00213 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.007 | L2-Norm(final)=5.133 | 3710.6 samples/s | 58.0 steps/s
[Step=12000 Epoch=46.0] | Loss=0.00206 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.973 | L2-Norm(final)=5.134 | 3674.7 samples/s | 57.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step12000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=10001 Epoch=38.5] | Loss=0.03145 | Reg=0.00231 | acc=0.9688 | L2-Norm=15.189 | L2-Norm(final)=4.901 | 3331.5 samples/s | 52.1 steps/s
[Step=10050 Epoch=38.7] | Loss=0.01589 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.481 | L2-Norm(final)=4.892 | 3711.3 samples/s | 58.0 steps/s
[Step=10100 Epoch=38.9] | Loss=0.01151 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.653 | L2-Norm(final)=4.926 | 4038.1 samples/s | 63.1 steps/s
[Step=10150 Epoch=39.1] | Loss=0.00950 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.747 | L2-Norm(final)=4.963 | 4091.5 samples/s | 63.9 steps/s
[Step=10200 Epoch=39.3] | Loss=0.00906 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.821 | L2-Norm(final)=4.997 | 4131.5 samples/s | 64.6 steps/s
[Step=10250 Epoch=39.5] | Loss=0.00795 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.879 | L2-Norm(final)=5.028 | 5443.6 samples/s | 85.1 steps/s
[Step=10300 Epoch=39.6] | Loss=0.00708 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.927 | L2-Norm(final)=5.061 | 1529.3 samples/s | 23.9 steps/s
[Step=10350 Epoch=39.8] | Loss=0.00632 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.967 | L2-Norm(final)=5.094 | 4058.0 samples/s | 63.4 steps/s
[Step=10400 Epoch=40.0] | Loss=0.00574 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.994 | L2-Norm(final)=5.126 | 4210.5 samples/s | 65.8 steps/s
[Step=10450 Epoch=40.2] | Loss=0.00535 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.015 | L2-Norm(final)=5.157 | 4004.3 samples/s | 62.6 steps/s
[Step=10500 Epoch=40.4] | Loss=0.00497 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.036 | L2-Norm(final)=5.188 | 4828.7 samples/s | 75.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=40.4] | Loss=0.00106 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.234 | L2-Norm(final)=5.492 | 3058.4 samples/s | 47.8 steps/s
[Step=10550 Epoch=40.6] | Loss=0.02904 | Reg=0.00269 | acc=0.9688 | L2-Norm=16.410 | L2-Norm(final)=5.446 | 3744.5 samples/s | 58.5 steps/s
[Step=10600 Epoch=40.8] | Loss=0.02318 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.658 | L2-Norm(final)=5.338 | 3720.8 samples/s | 58.1 steps/s
[Step=10650 Epoch=41.0] | Loss=0.01867 | Reg=0.00281 | acc=0.9844 | L2-Norm=16.764 | L2-Norm(final)=5.296 | 3690.8 samples/s | 57.7 steps/s
[Step=10700 Epoch=41.2] | Loss=0.01522 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.816 | L2-Norm(final)=5.277 | 3782.6 samples/s | 59.1 steps/s
[Step=10750 Epoch=41.4] | Loss=0.01234 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.842 | L2-Norm(final)=5.271 | 4710.1 samples/s | 73.6 steps/s
[Step=10800 Epoch=41.6] | Loss=0.01079 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.855 | L2-Norm(final)=5.269 | 1450.4 samples/s | 22.7 steps/s
[Step=10850 Epoch=41.8] | Loss=0.00928 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.858 | L2-Norm(final)=5.269 | 3730.7 samples/s | 58.3 steps/s
[Step=10900 Epoch=42.0] | Loss=0.00820 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.851 | L2-Norm(final)=5.270 | 3697.6 samples/s | 57.8 steps/s
[Step=10950 Epoch=42.2] | Loss=0.00736 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.838 | L2-Norm(final)=5.272 | 3699.6 samples/s | 57.8 steps/s
[Step=11000 Epoch=42.3] | Loss=0.00664 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.822 | L2-Norm(final)=5.275 | 4224.4 samples/s | 66.0 steps/s
[Step=11050 Epoch=42.5] | Loss=0.00604 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.801 | L2-Norm(final)=5.277 | 1534.0 samples/s | 24.0 steps/s
[Step=11100 Epoch=42.7] | Loss=0.00553 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.777 | L2-Norm(final)=5.280 | 3763.1 samples/s | 58.8 steps/s
[Step=11150 Epoch=42.9] | Loss=0.00511 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.751 | L2-Norm(final)=5.282 | 3716.1 samples/s | 58.1 steps/s
[Step=11200 Epoch=43.1] | Loss=0.00475 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.723 | L2-Norm(final)=5.284 | 3722.4 samples/s | 58.2 steps/s
[Step=11250 Epoch=43.3] | Loss=0.00444 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.694 | L2-Norm(final)=5.286 | 3761.3 samples/s | 58.8 steps/s
[Step=11300 Epoch=43.5] | Loss=0.00416 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.665 | L2-Norm(final)=5.289 | 1563.7 samples/s | 24.4 steps/s
[Step=11350 Epoch=43.7] | Loss=0.00392 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.634 | L2-Norm(final)=5.291 | 3788.9 samples/s | 59.2 steps/s
[Step=11400 Epoch=43.9] | Loss=0.00370 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.602 | L2-Norm(final)=5.292 | 3737.1 samples/s | 58.4 steps/s
[Step=11450 Epoch=44.1] | Loss=0.00351 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.570 | L2-Norm(final)=5.294 | 3743.2 samples/s | 58.5 steps/s
[Step=11500 Epoch=44.3] | Loss=0.00333 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.537 | L2-Norm(final)=5.296 | 3742.2 samples/s | 58.5 steps/s
[Step=11550 Epoch=44.5] | Loss=0.00318 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.503 | L2-Norm(final)=5.297 | 1566.2 samples/s | 24.5 steps/s
[Step=11600 Epoch=44.7] | Loss=0.00303 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.469 | L2-Norm(final)=5.299 | 3713.9 samples/s | 58.0 steps/s
[Step=11650 Epoch=44.8] | Loss=0.00290 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.435 | L2-Norm(final)=5.300 | 3720.1 samples/s | 58.1 steps/s
[Step=11700 Epoch=45.0] | Loss=0.00278 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.400 | L2-Norm(final)=5.302 | 3741.3 samples/s | 58.5 steps/s
[Step=11750 Epoch=45.2] | Loss=0.00267 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.365 | L2-Norm(final)=5.303 | 3696.0 samples/s | 57.8 steps/s
[Step=11800 Epoch=45.4] | Loss=0.00257 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.330 | L2-Norm(final)=5.304 | 5614.7 samples/s | 87.7 steps/s
[Step=11850 Epoch=45.6] | Loss=0.00247 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.295 | L2-Norm(final)=5.306 | 1424.1 samples/s | 22.3 steps/s
[Step=11900 Epoch=45.8] | Loss=0.00238 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.259 | L2-Norm(final)=5.307 | 3733.4 samples/s | 58.3 steps/s
[Step=11950 Epoch=46.0] | Loss=0.00230 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.223 | L2-Norm(final)=5.308 | 3752.2 samples/s | 58.6 steps/s
[Step=12000 Epoch=46.2] | Loss=0.00223 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.187 | L2-Norm(final)=5.309 | 3699.5 samples/s | 57.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07221 | acc=0.9550 | tpr=0.9565 | fpr=0.0483 | 3532.5 samples/s | 13.8 steps/s
Avg test loss: 0.07434, Avg test acc: 0.95288, Avg tpr: 0.95564, Avg fpr: 0.05320, total FA: 415

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06541 | acc=0.9589 | tpr=0.9684 | fpr=0.0617 | 3502.8 samples/s | 13.7 steps/s
Avg test loss: 0.07362, Avg test acc: 0.95733, Avg tpr: 0.96550, Avg fpr: 0.06063, total FA: 473

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.87934 | acc=0.3107 | tpr=0.0083 | fpr=0.0327 | 3525.2 samples/s | 13.8 steps/s
Avg test loss: 4.90400, Avg test acc: 0.30768, Avg tpr: 0.00822, Avg fpr: 0.03371, total FA: 263

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.33437 | acc=0.3073 | tpr=0.0086 | fpr=0.0441 | 3490.4 samples/s | 13.6 steps/s
Avg test loss: 5.34725, Avg test acc: 0.30531, Avg tpr: 0.00880, Avg fpr: 0.04256, total FA: 332

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.71733 | acc=0.0854 | tpr=0.8009 | fpr=0.9275 | 3466.1 samples/s | 13.5 steps/s
[Step= 100] | Loss=4.70633 | acc=0.0853 | tpr=0.8166 | fpr=0.9284 | 6882.2 samples/s | 26.9 steps/s
[Step= 150] | Loss=4.72413 | acc=0.0840 | tpr=0.8127 | fpr=0.9294 | 6860.2 samples/s | 26.8 steps/s
[Step= 200] | Loss=4.71202 | acc=0.0843 | tpr=0.8055 | fpr=0.9289 | 6796.0 samples/s | 26.5 steps/s
[Step= 250] | Loss=4.71856 | acc=0.0839 | tpr=0.8017 | fpr=0.9292 | 6996.1 samples/s | 27.3 steps/s
[Step= 300] | Loss=4.72241 | acc=0.0837 | tpr=0.7905 | fpr=0.9292 | 6699.7 samples/s | 26.2 steps/s
[Step= 350] | Loss=4.71833 | acc=0.0842 | tpr=0.7877 | fpr=0.9286 | 6921.0 samples/s | 27.0 steps/s
[Step= 400] | Loss=4.71677 | acc=0.0845 | tpr=0.7894 | fpr=0.9283 | 6875.3 samples/s | 26.9 steps/s
[Step= 450] | Loss=4.71976 | acc=0.0843 | tpr=0.7911 | fpr=0.9285 | 6712.8 samples/s | 26.2 steps/s
[Step= 500] | Loss=4.72271 | acc=0.0841 | tpr=0.7885 | fpr=0.9286 | 6926.8 samples/s | 27.1 steps/s
[Step= 550] | Loss=4.72293 | acc=0.0840 | tpr=0.7879 | fpr=0.9287 | 12053.5 samples/s | 47.1 steps/s
Avg test loss: 4.72359, Avg test acc: 0.08403, Avg tpr: 0.78803, Avg fpr: 0.92876, total FA: 128957

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.88551 | acc=0.1020 | tpr=0.8186 | fpr=0.9108 | 3498.6 samples/s | 13.7 steps/s
[Step= 100] | Loss=5.85344 | acc=0.1038 | tpr=0.8465 | fpr=0.9101 | 7267.7 samples/s | 28.4 steps/s
[Step= 150] | Loss=5.87636 | acc=0.1028 | tpr=0.8487 | fpr=0.9109 | 6673.1 samples/s | 26.1 steps/s
[Step= 200] | Loss=5.87359 | acc=0.1034 | tpr=0.8426 | fpr=0.9101 | 6946.9 samples/s | 27.1 steps/s
[Step= 250] | Loss=5.87861 | acc=0.1034 | tpr=0.8437 | fpr=0.9101 | 6728.1 samples/s | 26.3 steps/s
[Step= 300] | Loss=5.89029 | acc=0.1029 | tpr=0.8385 | fpr=0.9106 | 7015.8 samples/s | 27.4 steps/s
[Step= 350] | Loss=5.88467 | acc=0.1027 | tpr=0.8391 | fpr=0.9107 | 6652.8 samples/s | 26.0 steps/s
[Step= 400] | Loss=5.88059 | acc=0.1031 | tpr=0.8403 | fpr=0.9103 | 6928.3 samples/s | 27.1 steps/s
[Step= 450] | Loss=5.88730 | acc=0.1029 | tpr=0.8452 | fpr=0.9106 | 6736.0 samples/s | 26.3 steps/s
[Step= 500] | Loss=5.88648 | acc=0.1026 | tpr=0.8463 | fpr=0.9108 | 6728.6 samples/s | 26.3 steps/s
[Step= 550] | Loss=5.88803 | acc=0.1027 | tpr=0.8472 | fpr=0.9109 | 12822.4 samples/s | 50.1 steps/s
Avg test loss: 5.88997, Avg test acc: 0.10259, Avg tpr: 0.84707, Avg fpr: 0.91095, total FA: 126483

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10436 | acc=0.9805 | tpr=0.8938 | fpr=0.0180 | 3504.0 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.10964 | acc=0.9797 | tpr=0.9190 | fpr=0.0191 | 6893.1 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.11292 | acc=0.9790 | tpr=0.9251 | fpr=0.0200 | 6854.9 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.11314 | acc=0.9795 | tpr=0.9257 | fpr=0.0196 | 6896.6 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.10972 | acc=0.9799 | tpr=0.9258 | fpr=0.0191 | 6921.0 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.11201 | acc=0.9796 | tpr=0.9251 | fpr=0.0194 | 6858.4 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.11214 | acc=0.9795 | tpr=0.9261 | fpr=0.0196 | 6961.7 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.11375 | acc=0.9791 | tpr=0.9240 | fpr=0.0199 | 6854.3 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.11565 | acc=0.9788 | tpr=0.9226 | fpr=0.0202 | 6869.7 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.11525 | acc=0.9789 | tpr=0.9256 | fpr=0.0202 | 6701.0 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.11440 | acc=0.9791 | tpr=0.9228 | fpr=0.0199 | 12168.8 samples/s | 47.5 steps/s
Avg test loss: 0.11416, Avg test acc: 0.97907, Avg tpr: 0.92274, Avg fpr: 0.01991, total FA: 2764

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10715 | acc=0.9816 | tpr=0.9336 | fpr=0.0175 | 3496.6 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.11394 | acc=0.9805 | tpr=0.9424 | fpr=0.0188 | 6946.2 samples/s | 27.1 steps/s
[Step= 150] | Loss=0.11871 | acc=0.9796 | tpr=0.9452 | fpr=0.0198 | 6830.5 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.12062 | acc=0.9795 | tpr=0.9443 | fpr=0.0199 | 7051.6 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.11900 | acc=0.9796 | tpr=0.9467 | fpr=0.0198 | 6880.5 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.12260 | acc=0.9792 | tpr=0.9462 | fpr=0.0202 | 6892.5 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.12324 | acc=0.9791 | tpr=0.9449 | fpr=0.0203 | 6837.7 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.12475 | acc=0.9789 | tpr=0.9442 | fpr=0.0205 | 6853.9 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.12664 | acc=0.9785 | tpr=0.9406 | fpr=0.0208 | 6614.8 samples/s | 25.8 steps/s
[Step= 500] | Loss=0.12598 | acc=0.9785 | tpr=0.9427 | fpr=0.0208 | 6849.2 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.12503 | acc=0.9787 | tpr=0.9431 | fpr=0.0206 | 12634.7 samples/s | 49.4 steps/s
Avg test loss: 0.12471, Avg test acc: 0.97874, Avg tpr: 0.94334, Avg fpr: 0.02061, total FA: 2862

server round 6/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=12001 Epoch=23.4] | Loss=0.08740 | Reg=0.00227 | acc=0.9375 | L2-Norm=15.075 | L2-Norm(final)=4.345 | 3046.1 samples/s | 47.6 steps/s
[Step=12050 Epoch=23.5] | Loss=0.07418 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.245 | L2-Norm(final)=4.404 | 4024.8 samples/s | 62.9 steps/s
[Step=12100 Epoch=23.6] | Loss=0.06778 | Reg=0.00237 | acc=0.9688 | L2-Norm=15.385 | L2-Norm(final)=4.464 | 4313.0 samples/s | 67.4 steps/s
[Step=12150 Epoch=23.7] | Loss=0.06626 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.496 | L2-Norm(final)=4.509 | 4328.7 samples/s | 67.6 steps/s
[Step=12200 Epoch=23.8] | Loss=0.06572 | Reg=0.00243 | acc=0.9375 | L2-Norm=15.602 | L2-Norm(final)=4.548 | 4344.0 samples/s | 67.9 steps/s
[Step=12250 Epoch=23.9] | Loss=0.06585 | Reg=0.00247 | acc=0.9688 | L2-Norm=15.700 | L2-Norm(final)=4.579 | 4349.4 samples/s | 68.0 steps/s
[Step=12300 Epoch=24.0] | Loss=0.06457 | Reg=0.00249 | acc=0.9531 | L2-Norm=15.791 | L2-Norm(final)=4.607 | 4342.2 samples/s | 67.8 steps/s
[Step=12350 Epoch=24.1] | Loss=0.06378 | Reg=0.00252 | acc=0.9688 | L2-Norm=15.874 | L2-Norm(final)=4.637 | 4311.0 samples/s | 67.4 steps/s
[Step=12400 Epoch=24.2] | Loss=0.06288 | Reg=0.00255 | acc=0.9844 | L2-Norm=15.952 | L2-Norm(final)=4.663 | 4342.8 samples/s | 67.9 steps/s
[Step=12450 Epoch=24.3] | Loss=0.06239 | Reg=0.00257 | acc=0.9531 | L2-Norm=16.026 | L2-Norm(final)=4.689 | 4324.3 samples/s | 67.6 steps/s
[Step=12500 Epoch=24.4] | Loss=0.06238 | Reg=0.00259 | acc=0.9688 | L2-Norm=16.097 | L2-Norm(final)=4.713 | 5432.0 samples/s | 84.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=24.4] | Loss=0.05185 | Reg=0.00282 | acc=0.9375 | L2-Norm=16.791 | L2-Norm(final)=4.957 | 3026.7 samples/s | 47.3 steps/s
[Step=12550 Epoch=24.5] | Loss=0.05252 | Reg=0.00284 | acc=0.9375 | L2-Norm=16.854 | L2-Norm(final)=4.965 | 3822.7 samples/s | 59.7 steps/s
[Step=12600 Epoch=24.6] | Loss=0.05602 | Reg=0.00286 | acc=0.9531 | L2-Norm=16.920 | L2-Norm(final)=4.950 | 3838.5 samples/s | 60.0 steps/s
[Step=12650 Epoch=24.7] | Loss=0.05618 | Reg=0.00288 | acc=0.9531 | L2-Norm=16.970 | L2-Norm(final)=4.932 | 3891.0 samples/s | 60.8 steps/s
[Step=12700 Epoch=24.8] | Loss=0.05689 | Reg=0.00289 | acc=0.9844 | L2-Norm=17.012 | L2-Norm(final)=4.917 | 3899.7 samples/s | 60.9 steps/s
[Step=12750 Epoch=24.9] | Loss=0.05484 | Reg=0.00291 | acc=0.9688 | L2-Norm=17.052 | L2-Norm(final)=4.906 | 3929.5 samples/s | 61.4 steps/s
[Step=12800 Epoch=25.0] | Loss=0.05404 | Reg=0.00292 | acc=0.9531 | L2-Norm=17.085 | L2-Norm(final)=4.896 | 3930.1 samples/s | 61.4 steps/s
[Step=12850 Epoch=25.1] | Loss=0.05333 | Reg=0.00293 | acc=0.9844 | L2-Norm=17.116 | L2-Norm(final)=4.886 | 3911.3 samples/s | 61.1 steps/s
[Step=12900 Epoch=25.2] | Loss=0.05169 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.144 | L2-Norm(final)=4.880 | 3927.5 samples/s | 61.4 steps/s
[Step=12950 Epoch=25.3] | Loss=0.05052 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.171 | L2-Norm(final)=4.875 | 3935.1 samples/s | 61.5 steps/s
[Step=13000 Epoch=25.4] | Loss=0.04939 | Reg=0.00296 | acc=0.9531 | L2-Norm=17.196 | L2-Norm(final)=4.869 | 4817.7 samples/s | 75.3 steps/s
[Step=13050 Epoch=25.5] | Loss=0.04770 | Reg=0.00297 | acc=0.9531 | L2-Norm=17.219 | L2-Norm(final)=4.864 | 1472.1 samples/s | 23.0 steps/s
[Step=13100 Epoch=25.6] | Loss=0.04613 | Reg=0.00297 | acc=0.9844 | L2-Norm=17.241 | L2-Norm(final)=4.861 | 3952.6 samples/s | 61.8 steps/s
[Step=13150 Epoch=25.6] | Loss=0.04528 | Reg=0.00298 | acc=0.9375 | L2-Norm=17.261 | L2-Norm(final)=4.857 | 3880.1 samples/s | 60.6 steps/s
[Step=13200 Epoch=25.7] | Loss=0.04421 | Reg=0.00299 | acc=0.9688 | L2-Norm=17.280 | L2-Norm(final)=4.854 | 3912.1 samples/s | 61.1 steps/s
[Step=13250 Epoch=25.8] | Loss=0.04327 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.298 | L2-Norm(final)=4.851 | 3913.4 samples/s | 61.1 steps/s
[Step=13300 Epoch=25.9] | Loss=0.04260 | Reg=0.00300 | acc=0.9844 | L2-Norm=17.315 | L2-Norm(final)=4.848 | 3944.0 samples/s | 61.6 steps/s
[Step=13350 Epoch=26.0] | Loss=0.04158 | Reg=0.00300 | acc=0.9844 | L2-Norm=17.333 | L2-Norm(final)=4.845 | 3956.1 samples/s | 61.8 steps/s
[Step=13400 Epoch=26.1] | Loss=0.04108 | Reg=0.00301 | acc=0.9844 | L2-Norm=17.350 | L2-Norm(final)=4.842 | 3895.0 samples/s | 60.9 steps/s
[Step=13450 Epoch=26.2] | Loss=0.04075 | Reg=0.00302 | acc=0.9688 | L2-Norm=17.366 | L2-Norm(final)=4.839 | 3914.5 samples/s | 61.2 steps/s
[Step=13500 Epoch=26.3] | Loss=0.04036 | Reg=0.00302 | acc=0.9375 | L2-Norm=17.382 | L2-Norm(final)=4.835 | 4191.3 samples/s | 65.5 steps/s
[Step=13550 Epoch=26.4] | Loss=0.03984 | Reg=0.00303 | acc=0.9531 | L2-Norm=17.397 | L2-Norm(final)=4.831 | 1574.4 samples/s | 24.6 steps/s
[Step=13600 Epoch=26.5] | Loss=0.03945 | Reg=0.00303 | acc=0.9688 | L2-Norm=17.413 | L2-Norm(final)=4.828 | 3932.5 samples/s | 61.4 steps/s
[Step=13650 Epoch=26.6] | Loss=0.03861 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.428 | L2-Norm(final)=4.825 | 3906.8 samples/s | 61.0 steps/s
[Step=13700 Epoch=26.7] | Loss=0.03778 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.442 | L2-Norm(final)=4.823 | 3910.0 samples/s | 61.1 steps/s
[Step=13750 Epoch=26.8] | Loss=0.03729 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.455 | L2-Norm(final)=4.820 | 3908.1 samples/s | 61.1 steps/s
[Step=13800 Epoch=26.9] | Loss=0.03682 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.468 | L2-Norm(final)=4.818 | 3961.3 samples/s | 61.9 steps/s
[Step=13850 Epoch=27.0] | Loss=0.03629 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.482 | L2-Norm(final)=4.816 | 3913.6 samples/s | 61.1 steps/s
[Step=13900 Epoch=27.1] | Loss=0.03614 | Reg=0.00306 | acc=0.9844 | L2-Norm=17.496 | L2-Norm(final)=4.813 | 3965.7 samples/s | 62.0 steps/s
[Step=13950 Epoch=27.2] | Loss=0.03561 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.510 | L2-Norm(final)=4.811 | 3915.2 samples/s | 61.2 steps/s
[Step=14000 Epoch=27.3] | Loss=0.03532 | Reg=0.00307 | acc=0.9688 | L2-Norm=17.523 | L2-Norm(final)=4.808 | 3894.0 samples/s | 60.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step14000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=12001 Epoch=23.5] | Loss=0.10350 | Reg=0.00227 | acc=0.9062 | L2-Norm=15.075 | L2-Norm(final)=4.612 | 3303.1 samples/s | 51.6 steps/s
[Step=12050 Epoch=23.6] | Loss=0.07593 | Reg=0.00232 | acc=0.9531 | L2-Norm=15.235 | L2-Norm(final)=4.650 | 4114.7 samples/s | 64.3 steps/s
[Step=12100 Epoch=23.7] | Loss=0.07410 | Reg=0.00236 | acc=0.9375 | L2-Norm=15.370 | L2-Norm(final)=4.690 | 4291.3 samples/s | 67.1 steps/s
[Step=12150 Epoch=23.8] | Loss=0.07297 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.479 | L2-Norm(final)=4.725 | 4373.1 samples/s | 68.3 steps/s
[Step=12200 Epoch=23.9] | Loss=0.07223 | Reg=0.00243 | acc=0.8906 | L2-Norm=15.576 | L2-Norm(final)=4.755 | 4293.4 samples/s | 67.1 steps/s
[Step=12250 Epoch=23.9] | Loss=0.07142 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.673 | L2-Norm(final)=4.779 | 4353.5 samples/s | 68.0 steps/s
[Step=12300 Epoch=24.0] | Loss=0.07139 | Reg=0.00249 | acc=0.9531 | L2-Norm=15.763 | L2-Norm(final)=4.804 | 4384.2 samples/s | 68.5 steps/s
[Step=12350 Epoch=24.1] | Loss=0.07180 | Reg=0.00251 | acc=0.9844 | L2-Norm=15.844 | L2-Norm(final)=4.827 | 4384.1 samples/s | 68.5 steps/s
[Step=12400 Epoch=24.2] | Loss=0.07132 | Reg=0.00254 | acc=0.8750 | L2-Norm=15.920 | L2-Norm(final)=4.854 | 4390.1 samples/s | 68.6 steps/s
[Step=12450 Epoch=24.3] | Loss=0.07067 | Reg=0.00256 | acc=0.9844 | L2-Norm=15.990 | L2-Norm(final)=4.879 | 4373.6 samples/s | 68.3 steps/s
[Step=12500 Epoch=24.4] | Loss=0.07041 | Reg=0.00258 | acc=0.9375 | L2-Norm=16.058 | L2-Norm(final)=4.904 | 5660.2 samples/s | 88.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=24.4] | Loss=0.06717 | Reg=0.00280 | acc=0.9375 | L2-Norm=16.738 | L2-Norm(final)=5.151 | 3177.0 samples/s | 49.6 steps/s
[Step=12550 Epoch=24.5] | Loss=0.05381 | Reg=0.00283 | acc=0.9375 | L2-Norm=16.821 | L2-Norm(final)=5.183 | 3901.4 samples/s | 61.0 steps/s
[Step=12600 Epoch=24.6] | Loss=0.05822 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.892 | L2-Norm(final)=5.167 | 3926.0 samples/s | 61.3 steps/s
[Step=12650 Epoch=24.7] | Loss=0.05689 | Reg=0.00288 | acc=0.9688 | L2-Norm=16.960 | L2-Norm(final)=5.147 | 3938.8 samples/s | 61.5 steps/s
[Step=12700 Epoch=24.8] | Loss=0.05740 | Reg=0.00290 | acc=0.9375 | L2-Norm=17.018 | L2-Norm(final)=5.133 | 3949.2 samples/s | 61.7 steps/s
[Step=12750 Epoch=24.9] | Loss=0.05671 | Reg=0.00291 | acc=0.9375 | L2-Norm=17.069 | L2-Norm(final)=5.118 | 3940.7 samples/s | 61.6 steps/s
[Step=12800 Epoch=25.0] | Loss=0.05494 | Reg=0.00293 | acc=0.9844 | L2-Norm=17.113 | L2-Norm(final)=5.106 | 3946.8 samples/s | 61.7 steps/s
[Step=12850 Epoch=25.1] | Loss=0.05349 | Reg=0.00294 | acc=0.9844 | L2-Norm=17.152 | L2-Norm(final)=5.097 | 3936.1 samples/s | 61.5 steps/s
[Step=12900 Epoch=25.2] | Loss=0.05360 | Reg=0.00295 | acc=0.9531 | L2-Norm=17.186 | L2-Norm(final)=5.087 | 3945.3 samples/s | 61.6 steps/s
[Step=12950 Epoch=25.3] | Loss=0.05213 | Reg=0.00297 | acc=0.9531 | L2-Norm=17.219 | L2-Norm(final)=5.076 | 3968.1 samples/s | 62.0 steps/s
[Step=13000 Epoch=25.4] | Loss=0.05090 | Reg=0.00298 | acc=0.9531 | L2-Norm=17.249 | L2-Norm(final)=5.070 | 4851.9 samples/s | 75.8 steps/s
[Step=13050 Epoch=25.5] | Loss=0.04926 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.278 | L2-Norm(final)=5.064 | 1516.5 samples/s | 23.7 steps/s
[Step=13100 Epoch=25.6] | Loss=0.04766 | Reg=0.00300 | acc=0.9688 | L2-Norm=17.305 | L2-Norm(final)=5.059 | 3914.3 samples/s | 61.2 steps/s
[Step=13150 Epoch=25.7] | Loss=0.04624 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.330 | L2-Norm(final)=5.055 | 3956.2 samples/s | 61.8 steps/s
[Step=13200 Epoch=25.8] | Loss=0.04477 | Reg=0.00301 | acc=0.9844 | L2-Norm=17.355 | L2-Norm(final)=5.053 | 3949.7 samples/s | 61.7 steps/s
[Step=13250 Epoch=25.9] | Loss=0.04427 | Reg=0.00302 | acc=0.9688 | L2-Norm=17.379 | L2-Norm(final)=5.049 | 3905.4 samples/s | 61.0 steps/s
[Step=13300 Epoch=26.0] | Loss=0.04321 | Reg=0.00303 | acc=0.9844 | L2-Norm=17.402 | L2-Norm(final)=5.046 | 3930.7 samples/s | 61.4 steps/s
[Step=13350 Epoch=26.1] | Loss=0.04287 | Reg=0.00304 | acc=0.9844 | L2-Norm=17.424 | L2-Norm(final)=5.042 | 3908.7 samples/s | 61.1 steps/s
[Step=13400 Epoch=26.2] | Loss=0.04210 | Reg=0.00304 | acc=0.9688 | L2-Norm=17.444 | L2-Norm(final)=5.039 | 3956.8 samples/s | 61.8 steps/s
[Step=13450 Epoch=26.3] | Loss=0.04170 | Reg=0.00305 | acc=0.9531 | L2-Norm=17.464 | L2-Norm(final)=5.036 | 3968.5 samples/s | 62.0 steps/s
[Step=13500 Epoch=26.4] | Loss=0.04094 | Reg=0.00306 | acc=0.9844 | L2-Norm=17.484 | L2-Norm(final)=5.032 | 4242.0 samples/s | 66.3 steps/s
[Step=13550 Epoch=26.5] | Loss=0.04017 | Reg=0.00306 | acc=0.9844 | L2-Norm=17.503 | L2-Norm(final)=5.029 | 1564.0 samples/s | 24.4 steps/s
[Step=13600 Epoch=26.6] | Loss=0.03956 | Reg=0.00307 | acc=0.9844 | L2-Norm=17.521 | L2-Norm(final)=5.026 | 3902.9 samples/s | 61.0 steps/s
[Step=13650 Epoch=26.7] | Loss=0.03869 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.539 | L2-Norm(final)=5.024 | 3916.1 samples/s | 61.2 steps/s
[Step=13700 Epoch=26.8] | Loss=0.03843 | Reg=0.00308 | acc=0.9688 | L2-Norm=17.556 | L2-Norm(final)=5.022 | 3869.1 samples/s | 60.5 steps/s
[Step=13750 Epoch=26.9] | Loss=0.03797 | Reg=0.00309 | acc=0.9844 | L2-Norm=17.575 | L2-Norm(final)=5.019 | 3927.6 samples/s | 61.4 steps/s
[Step=13800 Epoch=27.0] | Loss=0.03750 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.594 | L2-Norm(final)=5.017 | 3931.4 samples/s | 61.4 steps/s
[Step=13850 Epoch=27.1] | Loss=0.03717 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.612 | L2-Norm(final)=5.014 | 3914.7 samples/s | 61.2 steps/s
[Step=13900 Epoch=27.2] | Loss=0.03668 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.630 | L2-Norm(final)=5.012 | 3928.9 samples/s | 61.4 steps/s
[Step=13950 Epoch=27.3] | Loss=0.03637 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.648 | L2-Norm(final)=5.010 | 3934.3 samples/s | 61.5 steps/s
[Step=14000 Epoch=27.4] | Loss=0.03599 | Reg=0.00312 | acc=0.9844 | L2-Norm=17.665 | L2-Norm(final)=5.008 | 3912.3 samples/s | 61.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step14000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=12001 Epoch=46.0] | Loss=0.01595 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.075 | L2-Norm(final)=5.160 | 3343.5 samples/s | 52.2 steps/s
[Step=12050 Epoch=46.2] | Loss=0.00561 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.198 | L2-Norm(final)=5.183 | 3675.4 samples/s | 57.4 steps/s
[Step=12100 Epoch=46.4] | Loss=0.00456 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.304 | L2-Norm(final)=5.219 | 4153.0 samples/s | 64.9 steps/s
[Step=12150 Epoch=46.6] | Loss=0.00351 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.378 | L2-Norm(final)=5.260 | 4063.3 samples/s | 63.5 steps/s
[Step=12200 Epoch=46.7] | Loss=0.00343 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.412 | L2-Norm(final)=5.291 | 4178.6 samples/s | 65.3 steps/s
[Step=12250 Epoch=46.9] | Loss=0.00362 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.452 | L2-Norm(final)=5.310 | 5279.6 samples/s | 82.5 steps/s
[Step=12300 Epoch=47.1] | Loss=0.00320 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.491 | L2-Norm(final)=5.325 | 1533.3 samples/s | 24.0 steps/s
[Step=12350 Epoch=47.3] | Loss=0.00289 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.516 | L2-Norm(final)=5.343 | 4148.1 samples/s | 64.8 steps/s
[Step=12400 Epoch=47.5] | Loss=0.00268 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.534 | L2-Norm(final)=5.362 | 4129.4 samples/s | 64.5 steps/s
[Step=12450 Epoch=47.7] | Loss=0.00251 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.552 | L2-Norm(final)=5.381 | 4116.0 samples/s | 64.3 steps/s
[Step=12500 Epoch=47.9] | Loss=0.00229 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.564 | L2-Norm(final)=5.400 | 4585.8 samples/s | 71.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=47.9] | Loss=0.00011 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.633 | L2-Norm(final)=5.582 | 3337.9 samples/s | 52.2 steps/s
[Step=12550 Epoch=48.1] | Loss=0.00730 | Reg=0.00244 | acc=0.9531 | L2-Norm=15.605 | L2-Norm(final)=5.581 | 3375.0 samples/s | 52.7 steps/s
[Step=12600 Epoch=48.3] | Loss=0.01600 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.821 | L2-Norm(final)=5.512 | 3755.6 samples/s | 58.7 steps/s
[Step=12650 Epoch=48.5] | Loss=0.01413 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.021 | L2-Norm(final)=5.466 | 3687.5 samples/s | 57.6 steps/s
[Step=12700 Epoch=48.7] | Loss=0.01208 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.134 | L2-Norm(final)=5.445 | 3716.7 samples/s | 58.1 steps/s
[Step=12750 Epoch=48.9] | Loss=0.01019 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.205 | L2-Norm(final)=5.438 | 4653.1 samples/s | 72.7 steps/s
[Step=12800 Epoch=49.0] | Loss=0.00905 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.245 | L2-Norm(final)=5.435 | 1446.2 samples/s | 22.6 steps/s
[Step=12850 Epoch=49.2] | Loss=0.00802 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.267 | L2-Norm(final)=5.430 | 3696.6 samples/s | 57.8 steps/s
[Step=12900 Epoch=49.4] | Loss=0.00707 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.276 | L2-Norm(final)=5.429 | 3697.6 samples/s | 57.8 steps/s
[Step=12950 Epoch=49.6] | Loss=0.00630 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.275 | L2-Norm(final)=5.430 | 3731.5 samples/s | 58.3 steps/s
[Step=13000 Epoch=49.8] | Loss=0.00567 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.267 | L2-Norm(final)=5.432 | 4070.7 samples/s | 63.6 steps/s
[Step=13050 Epoch=50.0] | Loss=0.00516 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.252 | L2-Norm(final)=5.434 | 1547.2 samples/s | 24.2 steps/s
[Step=13100 Epoch=50.2] | Loss=0.00473 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.234 | L2-Norm(final)=5.436 | 3764.8 samples/s | 58.8 steps/s
[Step=13150 Epoch=50.4] | Loss=0.00437 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.212 | L2-Norm(final)=5.438 | 3748.2 samples/s | 58.6 steps/s
[Step=13200 Epoch=50.6] | Loss=0.00406 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.188 | L2-Norm(final)=5.440 | 3669.4 samples/s | 57.3 steps/s
[Step=13250 Epoch=50.8] | Loss=0.00379 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.162 | L2-Norm(final)=5.442 | 3744.2 samples/s | 58.5 steps/s
[Step=13300 Epoch=51.0] | Loss=0.00355 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.135 | L2-Norm(final)=5.443 | 1563.5 samples/s | 24.4 steps/s
[Step=13350 Epoch=51.2] | Loss=0.00335 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.106 | L2-Norm(final)=5.445 | 3723.4 samples/s | 58.2 steps/s
[Step=13400 Epoch=51.3] | Loss=0.00316 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.076 | L2-Norm(final)=5.447 | 3693.5 samples/s | 57.7 steps/s
[Step=13450 Epoch=51.5] | Loss=0.00300 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.046 | L2-Norm(final)=5.448 | 3685.1 samples/s | 57.6 steps/s
[Step=13500 Epoch=51.7] | Loss=0.00285 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.014 | L2-Norm(final)=5.450 | 3725.0 samples/s | 58.2 steps/s
[Step=13550 Epoch=51.9] | Loss=0.00271 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.983 | L2-Norm(final)=5.452 | 1562.1 samples/s | 24.4 steps/s
[Step=13600 Epoch=52.1] | Loss=0.00259 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.950 | L2-Norm(final)=5.453 | 3694.2 samples/s | 57.7 steps/s
[Step=13650 Epoch=52.3] | Loss=0.00248 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.918 | L2-Norm(final)=5.456 | 3712.7 samples/s | 58.0 steps/s
[Step=13700 Epoch=52.5] | Loss=0.00237 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.885 | L2-Norm(final)=5.458 | 3645.1 samples/s | 57.0 steps/s
[Step=13750 Epoch=52.7] | Loss=0.00228 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.852 | L2-Norm(final)=5.461 | 3721.4 samples/s | 58.1 steps/s
[Step=13800 Epoch=52.9] | Loss=0.00219 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.818 | L2-Norm(final)=5.463 | 5114.1 samples/s | 79.9 steps/s
[Step=13850 Epoch=53.1] | Loss=0.00211 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.784 | L2-Norm(final)=5.466 | 1415.0 samples/s | 22.1 steps/s
[Step=13900 Epoch=53.3] | Loss=0.00203 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.751 | L2-Norm(final)=5.470 | 3767.5 samples/s | 58.9 steps/s
[Step=13950 Epoch=53.5] | Loss=0.00196 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.717 | L2-Norm(final)=5.473 | 3730.9 samples/s | 58.3 steps/s
[Step=14000 Epoch=53.6] | Loss=0.00190 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.683 | L2-Norm(final)=5.476 | 3735.3 samples/s | 58.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step14000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=12001 Epoch=46.2] | Loss=0.05481 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.075 | L2-Norm(final)=5.339 | 3481.0 samples/s | 54.4 steps/s
[Step=12050 Epoch=46.4] | Loss=0.01164 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.303 | L2-Norm(final)=5.356 | 3766.2 samples/s | 58.8 steps/s
[Step=12100 Epoch=46.6] | Loss=0.00948 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.478 | L2-Norm(final)=5.381 | 4042.1 samples/s | 63.2 steps/s
[Step=12150 Epoch=46.8] | Loss=0.00773 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.595 | L2-Norm(final)=5.409 | 4121.0 samples/s | 64.4 steps/s
[Step=12200 Epoch=47.0] | Loss=0.00702 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.685 | L2-Norm(final)=5.440 | 4056.5 samples/s | 63.4 steps/s
[Step=12250 Epoch=47.2] | Loss=0.00614 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.760 | L2-Norm(final)=5.473 | 5531.0 samples/s | 86.4 steps/s
[Step=12300 Epoch=47.3] | Loss=0.00550 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.819 | L2-Norm(final)=5.507 | 1506.3 samples/s | 23.5 steps/s
[Step=12350 Epoch=47.5] | Loss=0.00490 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.860 | L2-Norm(final)=5.540 | 4170.0 samples/s | 65.2 steps/s
[Step=12400 Epoch=47.7] | Loss=0.00448 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.892 | L2-Norm(final)=5.574 | 4114.5 samples/s | 64.3 steps/s
[Step=12450 Epoch=47.9] | Loss=0.00409 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.916 | L2-Norm(final)=5.606 | 4120.2 samples/s | 64.4 steps/s
[Step=12500 Epoch=48.1] | Loss=0.00373 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.932 | L2-Norm(final)=5.637 | 4712.2 samples/s | 73.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=48.1] | Loss=0.00018 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.056 | L2-Norm(final)=5.931 | 3163.7 samples/s | 49.4 steps/s
[Step=12550 Epoch=48.3] | Loss=0.02092 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.252 | L2-Norm(final)=5.886 | 3591.5 samples/s | 56.1 steps/s
[Step=12600 Epoch=48.5] | Loss=0.02081 | Reg=0.00274 | acc=0.9531 | L2-Norm=16.561 | L2-Norm(final)=5.818 | 3702.8 samples/s | 57.9 steps/s
[Step=12650 Epoch=48.7] | Loss=0.01902 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.737 | L2-Norm(final)=5.764 | 3751.9 samples/s | 58.6 steps/s
[Step=12700 Epoch=48.9] | Loss=0.01568 | Reg=0.00284 | acc=0.9844 | L2-Norm=16.842 | L2-Norm(final)=5.734 | 3726.5 samples/s | 58.2 steps/s
[Step=12750 Epoch=49.1] | Loss=0.01324 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.903 | L2-Norm(final)=5.721 | 4733.5 samples/s | 74.0 steps/s
[Step=12800 Epoch=49.3] | Loss=0.01140 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.939 | L2-Norm(final)=5.715 | 1500.6 samples/s | 23.4 steps/s
[Step=12850 Epoch=49.5] | Loss=0.00982 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.956 | L2-Norm(final)=5.712 | 3707.7 samples/s | 57.9 steps/s
[Step=12900 Epoch=49.7] | Loss=0.00867 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.958 | L2-Norm(final)=5.712 | 3716.1 samples/s | 58.1 steps/s
[Step=12950 Epoch=49.8] | Loss=0.00775 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.953 | L2-Norm(final)=5.713 | 3753.2 samples/s | 58.6 steps/s
[Step=13000 Epoch=50.0] | Loss=0.00699 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.941 | L2-Norm(final)=5.714 | 4189.0 samples/s | 65.5 steps/s
[Step=13050 Epoch=50.2] | Loss=0.00636 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.925 | L2-Norm(final)=5.716 | 1540.4 samples/s | 24.1 steps/s
[Step=13100 Epoch=50.4] | Loss=0.00583 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.905 | L2-Norm(final)=5.717 | 3740.4 samples/s | 58.4 steps/s
[Step=13150 Epoch=50.6] | Loss=0.00538 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.881 | L2-Norm(final)=5.718 | 3741.1 samples/s | 58.5 steps/s
[Step=13200 Epoch=50.8] | Loss=0.00500 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.856 | L2-Norm(final)=5.720 | 3719.4 samples/s | 58.1 steps/s
[Step=13250 Epoch=51.0] | Loss=0.00467 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.829 | L2-Norm(final)=5.721 | 3805.8 samples/s | 59.5 steps/s
[Step=13300 Epoch=51.2] | Loss=0.00438 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.800 | L2-Norm(final)=5.722 | 1609.6 samples/s | 25.1 steps/s
[Step=13350 Epoch=51.4] | Loss=0.00412 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.770 | L2-Norm(final)=5.724 | 3728.1 samples/s | 58.3 steps/s
[Step=13400 Epoch=51.6] | Loss=0.00389 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.739 | L2-Norm(final)=5.725 | 3719.1 samples/s | 58.1 steps/s
[Step=13450 Epoch=51.8] | Loss=0.00369 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.708 | L2-Norm(final)=5.726 | 3706.8 samples/s | 57.9 steps/s
[Step=13500 Epoch=52.0] | Loss=0.00350 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.676 | L2-Norm(final)=5.727 | 3755.2 samples/s | 58.7 steps/s
[Step=13550 Epoch=52.2] | Loss=0.00334 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.643 | L2-Norm(final)=5.728 | 1596.6 samples/s | 24.9 steps/s
[Step=13600 Epoch=52.4] | Loss=0.00318 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.610 | L2-Norm(final)=5.729 | 3763.7 samples/s | 58.8 steps/s
[Step=13650 Epoch=52.5] | Loss=0.00305 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.576 | L2-Norm(final)=5.730 | 3713.5 samples/s | 58.0 steps/s
[Step=13700 Epoch=52.7] | Loss=0.00292 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.543 | L2-Norm(final)=5.731 | 3787.3 samples/s | 59.2 steps/s
[Step=13750 Epoch=52.9] | Loss=0.00280 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.508 | L2-Norm(final)=5.732 | 3682.2 samples/s | 57.5 steps/s
[Step=13800 Epoch=53.1] | Loss=0.00270 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.474 | L2-Norm(final)=5.733 | 5378.6 samples/s | 84.0 steps/s
[Step=13850 Epoch=53.3] | Loss=0.00260 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.440 | L2-Norm(final)=5.734 | 1401.1 samples/s | 21.9 steps/s
[Step=13900 Epoch=53.5] | Loss=0.00250 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.405 | L2-Norm(final)=5.735 | 3685.9 samples/s | 57.6 steps/s
[Step=13950 Epoch=53.7] | Loss=0.00242 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.370 | L2-Norm(final)=5.736 | 3727.1 samples/s | 58.2 steps/s
[Step=14000 Epoch=53.9] | Loss=0.00234 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.335 | L2-Norm(final)=5.736 | 3707.9 samples/s | 57.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step14000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06690 | acc=0.9530 | tpr=0.9507 | fpr=0.0419 | 3569.4 samples/s | 13.9 steps/s
Avg test loss: 0.07125, Avg test acc: 0.95124, Avg tpr: 0.94900, Avg fpr: 0.04384, total FA: 342

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07005 | acc=0.9573 | tpr=0.9645 | fpr=0.0585 | 3532.8 samples/s | 13.8 steps/s
Avg test loss: 0.07442, Avg test acc: 0.95553, Avg tpr: 0.96194, Avg fpr: 0.05858, total FA: 457

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.73430 | acc=0.3025 | tpr=0.0183 | fpr=0.0803 | 3526.5 samples/s | 13.8 steps/s
Avg test loss: 4.75309, Avg test acc: 0.30067, Avg tpr: 0.02011, Avg fpr: 0.08230, total FA: 642

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.75697 | acc=0.3123 | tpr=0.0160 | fpr=0.0444 | 3536.1 samples/s | 13.8 steps/s
Avg test loss: 5.77377, Avg test acc: 0.31052, Avg tpr: 0.01644, Avg fpr: 0.04269, total FA: 333

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.73164 | acc=0.1092 | tpr=0.7522 | fpr=0.9023 | 3557.7 samples/s | 13.9 steps/s
[Step= 100] | Loss=3.71307 | acc=0.1119 | tpr=0.7484 | fpr=0.9000 | 6768.7 samples/s | 26.4 steps/s
[Step= 150] | Loss=3.71410 | acc=0.1116 | tpr=0.7406 | fpr=0.9000 | 6897.0 samples/s | 26.9 steps/s
[Step= 200] | Loss=3.70132 | acc=0.1114 | tpr=0.7235 | fpr=0.8998 | 6838.4 samples/s | 26.7 steps/s
[Step= 250] | Loss=3.70335 | acc=0.1113 | tpr=0.7249 | fpr=0.8999 | 6886.6 samples/s | 26.9 steps/s
[Step= 300] | Loss=3.70264 | acc=0.1113 | tpr=0.7236 | fpr=0.8998 | 6830.0 samples/s | 26.7 steps/s
[Step= 350] | Loss=3.69627 | acc=0.1124 | tpr=0.7307 | fpr=0.8988 | 7305.0 samples/s | 28.5 steps/s
[Step= 400] | Loss=3.69398 | acc=0.1123 | tpr=0.7336 | fpr=0.8990 | 6362.4 samples/s | 24.9 steps/s
[Step= 450] | Loss=3.69771 | acc=0.1119 | tpr=0.7356 | fpr=0.8995 | 4413.7 samples/s | 17.2 steps/s
[Step= 500] | Loss=3.69717 | acc=0.1115 | tpr=0.7330 | fpr=0.8997 | 6562.4 samples/s | 25.6 steps/s
[Step= 550] | Loss=3.69747 | acc=0.1115 | tpr=0.7302 | fpr=0.8997 | 12377.3 samples/s | 48.3 steps/s
Avg test loss: 3.69869, Avg test acc: 0.11142, Avg tpr: 0.73019, Avg fpr: 0.89983, total FA: 124940

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.50839 | acc=0.0826 | tpr=0.8186 | fpr=0.9307 | 3497.7 samples/s | 13.7 steps/s
[Step= 100] | Loss=6.46005 | acc=0.0843 | tpr=0.8529 | fpr=0.9300 | 6817.4 samples/s | 26.6 steps/s
[Step= 150] | Loss=6.47423 | acc=0.0848 | tpr=0.8602 | fpr=0.9295 | 6762.2 samples/s | 26.4 steps/s
[Step= 200] | Loss=6.46603 | acc=0.0841 | tpr=0.8536 | fpr=0.9299 | 7143.3 samples/s | 27.9 steps/s
[Step= 250] | Loss=6.47707 | acc=0.0840 | tpr=0.8559 | fpr=0.9300 | 6634.2 samples/s | 25.9 steps/s
[Step= 300] | Loss=6.47898 | acc=0.0835 | tpr=0.8516 | fpr=0.9305 | 7072.8 samples/s | 27.6 steps/s
[Step= 350] | Loss=6.47436 | acc=0.0837 | tpr=0.8528 | fpr=0.9303 | 6716.3 samples/s | 26.2 steps/s
[Step= 400] | Loss=6.46786 | acc=0.0839 | tpr=0.8534 | fpr=0.9301 | 6818.6 samples/s | 26.6 steps/s
[Step= 450] | Loss=6.47423 | acc=0.0839 | tpr=0.8535 | fpr=0.9301 | 4123.6 samples/s | 16.1 steps/s
[Step= 500] | Loss=6.47365 | acc=0.0837 | tpr=0.8533 | fpr=0.9302 | 6728.6 samples/s | 26.3 steps/s
[Step= 550] | Loss=6.47473 | acc=0.0835 | tpr=0.8548 | fpr=0.9306 | 12446.9 samples/s | 48.6 steps/s
Avg test loss: 6.47702, Avg test acc: 0.08338, Avg tpr: 0.85460, Avg fpr: 0.93064, total FA: 129218

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08975 | acc=0.9820 | tpr=0.9558 | fpr=0.0175 | 3494.6 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.09684 | acc=0.9809 | tpr=0.9531 | fpr=0.0186 | 6778.1 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.09990 | acc=0.9800 | tpr=0.9524 | fpr=0.0195 | 6801.6 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.10086 | acc=0.9800 | tpr=0.9497 | fpr=0.0195 | 6917.0 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.09886 | acc=0.9802 | tpr=0.9467 | fpr=0.0191 | 6953.8 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.10073 | acc=0.9800 | tpr=0.9455 | fpr=0.0193 | 6732.3 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.10118 | acc=0.9798 | tpr=0.9468 | fpr=0.0196 | 6987.7 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.10234 | acc=0.9795 | tpr=0.9431 | fpr=0.0198 | 6421.0 samples/s | 25.1 steps/s
[Step= 450] | Loss=0.10420 | acc=0.9791 | tpr=0.9421 | fpr=0.0202 | 5273.3 samples/s | 20.6 steps/s
[Step= 500] | Loss=0.10349 | acc=0.9793 | tpr=0.9449 | fpr=0.0201 | 6845.9 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.10254 | acc=0.9795 | tpr=0.9439 | fpr=0.0198 | 12261.6 samples/s | 47.9 steps/s
Avg test loss: 0.10236, Avg test acc: 0.97952, Avg tpr: 0.94374, Avg fpr: 0.01983, total FA: 2754

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14476 | acc=0.9785 | tpr=0.9469 | fpr=0.0209 | 3536.7 samples/s | 13.8 steps/s
[Step= 100] | Loss=0.15549 | acc=0.9775 | tpr=0.9574 | fpr=0.0221 | 6703.1 samples/s | 26.2 steps/s
[Step= 150] | Loss=0.16255 | acc=0.9765 | tpr=0.9582 | fpr=0.0231 | 6975.2 samples/s | 27.2 steps/s
[Step= 200] | Loss=0.16472 | acc=0.9767 | tpr=0.9563 | fpr=0.0230 | 6813.7 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.16159 | acc=0.9767 | tpr=0.9572 | fpr=0.0229 | 6824.1 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.16548 | acc=0.9762 | tpr=0.9542 | fpr=0.0234 | 6827.8 samples/s | 26.7 steps/s
[Step= 350] | Loss=0.16625 | acc=0.9761 | tpr=0.9537 | fpr=0.0235 | 6936.1 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.16732 | acc=0.9760 | tpr=0.9535 | fpr=0.0236 | 6872.8 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.17008 | acc=0.9758 | tpr=0.9533 | fpr=0.0238 | 6692.3 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.16939 | acc=0.9758 | tpr=0.9542 | fpr=0.0238 | 6844.4 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.16834 | acc=0.9759 | tpr=0.9530 | fpr=0.0237 | 12280.8 samples/s | 48.0 steps/s
Avg test loss: 0.16802, Avg test acc: 0.97591, Avg tpr: 0.95285, Avg fpr: 0.02367, total FA: 3287

server round 7/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=14001 Epoch=27.3] | Loss=0.08973 | Reg=0.00227 | acc=0.9219 | L2-Norm=15.082 | L2-Norm(final)=4.719 | 3266.9 samples/s | 51.0 steps/s
[Step=14050 Epoch=27.4] | Loss=0.06732 | Reg=0.00232 | acc=0.9531 | L2-Norm=15.225 | L2-Norm(final)=4.771 | 3757.7 samples/s | 58.7 steps/s
[Step=14100 Epoch=27.5] | Loss=0.06458 | Reg=0.00236 | acc=0.9688 | L2-Norm=15.358 | L2-Norm(final)=4.816 | 4398.0 samples/s | 68.7 steps/s
[Step=14150 Epoch=27.6] | Loss=0.06152 | Reg=0.00239 | acc=0.9062 | L2-Norm=15.472 | L2-Norm(final)=4.851 | 4332.8 samples/s | 67.7 steps/s
[Step=14200 Epoch=27.7] | Loss=0.06086 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.572 | L2-Norm(final)=4.879 | 4375.4 samples/s | 68.4 steps/s
[Step=14250 Epoch=27.8] | Loss=0.06099 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.660 | L2-Norm(final)=4.904 | 4390.2 samples/s | 68.6 steps/s
[Step=14300 Epoch=27.9] | Loss=0.05976 | Reg=0.00248 | acc=0.9531 | L2-Norm=15.745 | L2-Norm(final)=4.927 | 4334.7 samples/s | 67.7 steps/s
[Step=14350 Epoch=28.0] | Loss=0.05967 | Reg=0.00251 | acc=0.9531 | L2-Norm=15.824 | L2-Norm(final)=4.949 | 4349.8 samples/s | 68.0 steps/s
[Step=14400 Epoch=28.1] | Loss=0.05963 | Reg=0.00253 | acc=0.9531 | L2-Norm=15.899 | L2-Norm(final)=4.970 | 4360.6 samples/s | 68.1 steps/s
[Step=14450 Epoch=28.2] | Loss=0.05933 | Reg=0.00255 | acc=0.9531 | L2-Norm=15.973 | L2-Norm(final)=4.990 | 4411.8 samples/s | 68.9 steps/s
[Step=14500 Epoch=28.3] | Loss=0.05890 | Reg=0.00258 | acc=0.9062 | L2-Norm=16.044 | L2-Norm(final)=5.010 | 5478.2 samples/s | 85.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=14501 Epoch=28.3] | Loss=0.02661 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.737 | L2-Norm(final)=5.222 | 3385.7 samples/s | 52.9 steps/s
[Step=14550 Epoch=28.4] | Loss=0.05338 | Reg=0.00283 | acc=0.9219 | L2-Norm=16.815 | L2-Norm(final)=5.235 | 3367.5 samples/s | 52.6 steps/s
[Step=14600 Epoch=28.5] | Loss=0.05704 | Reg=0.00286 | acc=0.9688 | L2-Norm=16.903 | L2-Norm(final)=5.212 | 3917.0 samples/s | 61.2 steps/s
[Step=14650 Epoch=28.6] | Loss=0.05340 | Reg=0.00288 | acc=0.9219 | L2-Norm=16.971 | L2-Norm(final)=5.198 | 3952.4 samples/s | 61.8 steps/s
[Step=14700 Epoch=28.7] | Loss=0.05425 | Reg=0.00290 | acc=0.9219 | L2-Norm=17.023 | L2-Norm(final)=5.187 | 3918.4 samples/s | 61.2 steps/s
[Step=14750 Epoch=28.8] | Loss=0.05232 | Reg=0.00291 | acc=0.9375 | L2-Norm=17.071 | L2-Norm(final)=5.177 | 3937.7 samples/s | 61.5 steps/s
[Step=14800 Epoch=28.9] | Loss=0.05202 | Reg=0.00293 | acc=0.9688 | L2-Norm=17.115 | L2-Norm(final)=5.165 | 3940.5 samples/s | 61.6 steps/s
[Step=14850 Epoch=29.0] | Loss=0.05013 | Reg=0.00294 | acc=0.9688 | L2-Norm=17.151 | L2-Norm(final)=5.156 | 3894.9 samples/s | 60.9 steps/s
[Step=14900 Epoch=29.1] | Loss=0.04843 | Reg=0.00295 | acc=0.9844 | L2-Norm=17.182 | L2-Norm(final)=5.150 | 3960.3 samples/s | 61.9 steps/s
[Step=14950 Epoch=29.2] | Loss=0.04705 | Reg=0.00296 | acc=0.9688 | L2-Norm=17.208 | L2-Norm(final)=5.145 | 3912.5 samples/s | 61.1 steps/s
[Step=15000 Epoch=29.3] | Loss=0.04536 | Reg=0.00297 | acc=0.9844 | L2-Norm=17.231 | L2-Norm(final)=5.140 | 4774.6 samples/s | 74.6 steps/s
[Step=15050 Epoch=29.4] | Loss=0.04383 | Reg=0.00298 | acc=0.9531 | L2-Norm=17.253 | L2-Norm(final)=5.135 | 1470.2 samples/s | 23.0 steps/s
[Step=15100 Epoch=29.5] | Loss=0.04244 | Reg=0.00298 | acc=0.9688 | L2-Norm=17.274 | L2-Norm(final)=5.131 | 3892.6 samples/s | 60.8 steps/s
[Step=15150 Epoch=29.5] | Loss=0.04159 | Reg=0.00299 | acc=0.9844 | L2-Norm=17.294 | L2-Norm(final)=5.126 | 3899.1 samples/s | 60.9 steps/s
[Step=15200 Epoch=29.6] | Loss=0.04074 | Reg=0.00300 | acc=0.9844 | L2-Norm=17.313 | L2-Norm(final)=5.121 | 3942.8 samples/s | 61.6 steps/s
[Step=15250 Epoch=29.7] | Loss=0.04005 | Reg=0.00300 | acc=0.9688 | L2-Norm=17.331 | L2-Norm(final)=5.116 | 3873.0 samples/s | 60.5 steps/s
[Step=15300 Epoch=29.8] | Loss=0.03927 | Reg=0.00301 | acc=0.9688 | L2-Norm=17.348 | L2-Norm(final)=5.111 | 3917.6 samples/s | 61.2 steps/s
[Step=15350 Epoch=29.9] | Loss=0.03885 | Reg=0.00302 | acc=0.9844 | L2-Norm=17.365 | L2-Norm(final)=5.106 | 3906.1 samples/s | 61.0 steps/s
[Step=15400 Epoch=30.0] | Loss=0.03876 | Reg=0.00302 | acc=0.9844 | L2-Norm=17.383 | L2-Norm(final)=5.101 | 3924.7 samples/s | 61.3 steps/s
[Step=15450 Epoch=30.1] | Loss=0.03820 | Reg=0.00303 | acc=0.9688 | L2-Norm=17.400 | L2-Norm(final)=5.097 | 3905.6 samples/s | 61.0 steps/s
[Step=15500 Epoch=30.2] | Loss=0.03770 | Reg=0.00303 | acc=0.9844 | L2-Norm=17.418 | L2-Norm(final)=5.093 | 4129.6 samples/s | 64.5 steps/s
[Step=15550 Epoch=30.3] | Loss=0.03702 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.436 | L2-Norm(final)=5.089 | 1576.5 samples/s | 24.6 steps/s
[Step=15600 Epoch=30.4] | Loss=0.03640 | Reg=0.00305 | acc=0.9844 | L2-Norm=17.453 | L2-Norm(final)=5.085 | 3877.6 samples/s | 60.6 steps/s
[Step=15650 Epoch=30.5] | Loss=0.03591 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.470 | L2-Norm(final)=5.082 | 3921.6 samples/s | 61.3 steps/s
[Step=15700 Epoch=30.6] | Loss=0.03544 | Reg=0.00306 | acc=0.9688 | L2-Norm=17.486 | L2-Norm(final)=5.079 | 3907.5 samples/s | 61.1 steps/s
[Step=15750 Epoch=30.7] | Loss=0.03491 | Reg=0.00306 | acc=0.9844 | L2-Norm=17.503 | L2-Norm(final)=5.076 | 3893.8 samples/s | 60.8 steps/s
[Step=15800 Epoch=30.8] | Loss=0.03478 | Reg=0.00307 | acc=0.9844 | L2-Norm=17.519 | L2-Norm(final)=5.072 | 3907.3 samples/s | 61.1 steps/s
[Step=15850 Epoch=30.9] | Loss=0.03454 | Reg=0.00308 | acc=0.9844 | L2-Norm=17.536 | L2-Norm(final)=5.069 | 3940.5 samples/s | 61.6 steps/s
[Step=15900 Epoch=31.0] | Loss=0.03418 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.553 | L2-Norm(final)=5.065 | 3942.8 samples/s | 61.6 steps/s
[Step=15950 Epoch=31.1] | Loss=0.03389 | Reg=0.00309 | acc=0.9375 | L2-Norm=17.570 | L2-Norm(final)=5.062 | 3908.6 samples/s | 61.1 steps/s
[Step=16000 Epoch=31.2] | Loss=0.03371 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.587 | L2-Norm(final)=5.058 | 3923.3 samples/s | 61.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step16000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=14001 Epoch=27.4] | Loss=0.07733 | Reg=0.00227 | acc=0.9375 | L2-Norm=15.082 | L2-Norm(final)=4.939 | 3404.5 samples/s | 53.2 steps/s
[Step=14050 Epoch=27.5] | Loss=0.06868 | Reg=0.00232 | acc=0.9375 | L2-Norm=15.228 | L2-Norm(final)=4.985 | 3883.9 samples/s | 60.7 steps/s
[Step=14100 Epoch=27.6] | Loss=0.07258 | Reg=0.00236 | acc=0.9688 | L2-Norm=15.363 | L2-Norm(final)=5.019 | 4401.9 samples/s | 68.8 steps/s
[Step=14150 Epoch=27.7] | Loss=0.06984 | Reg=0.00239 | acc=0.9375 | L2-Norm=15.470 | L2-Norm(final)=5.040 | 4263.1 samples/s | 66.6 steps/s
[Step=14200 Epoch=27.8] | Loss=0.06701 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.563 | L2-Norm(final)=5.068 | 4374.4 samples/s | 68.3 steps/s
[Step=14250 Epoch=27.9] | Loss=0.06618 | Reg=0.00245 | acc=0.9531 | L2-Norm=15.650 | L2-Norm(final)=5.097 | 4373.0 samples/s | 68.3 steps/s
[Step=14300 Epoch=28.0] | Loss=0.06560 | Reg=0.00248 | acc=0.9531 | L2-Norm=15.735 | L2-Norm(final)=5.122 | 4438.4 samples/s | 69.4 steps/s
[Step=14350 Epoch=28.1] | Loss=0.06477 | Reg=0.00250 | acc=0.9531 | L2-Norm=15.816 | L2-Norm(final)=5.150 | 4330.8 samples/s | 67.7 steps/s
[Step=14400 Epoch=28.2] | Loss=0.06363 | Reg=0.00253 | acc=0.9688 | L2-Norm=15.894 | L2-Norm(final)=5.178 | 4348.9 samples/s | 68.0 steps/s
[Step=14450 Epoch=28.2] | Loss=0.06406 | Reg=0.00255 | acc=0.9531 | L2-Norm=15.966 | L2-Norm(final)=5.201 | 4436.7 samples/s | 69.3 steps/s
[Step=14500 Epoch=28.3] | Loss=0.06364 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.035 | L2-Norm(final)=5.225 | 5515.8 samples/s | 86.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=14501 Epoch=28.3] | Loss=0.03843 | Reg=0.00280 | acc=0.9844 | L2-Norm=16.724 | L2-Norm(final)=5.468 | 3243.4 samples/s | 50.7 steps/s
[Step=14550 Epoch=28.4] | Loss=0.05550 | Reg=0.00282 | acc=0.9375 | L2-Norm=16.786 | L2-Norm(final)=5.483 | 3874.5 samples/s | 60.5 steps/s
[Step=14600 Epoch=28.5] | Loss=0.05612 | Reg=0.00284 | acc=0.9219 | L2-Norm=16.854 | L2-Norm(final)=5.470 | 3913.1 samples/s | 61.1 steps/s
[Step=14650 Epoch=28.6] | Loss=0.05522 | Reg=0.00286 | acc=0.9688 | L2-Norm=16.915 | L2-Norm(final)=5.447 | 3915.2 samples/s | 61.2 steps/s
[Step=14700 Epoch=28.7] | Loss=0.05179 | Reg=0.00288 | acc=0.9531 | L2-Norm=16.965 | L2-Norm(final)=5.433 | 3901.5 samples/s | 61.0 steps/s
[Step=14750 Epoch=28.8] | Loss=0.05112 | Reg=0.00289 | acc=1.0000 | L2-Norm=17.008 | L2-Norm(final)=5.419 | 3918.9 samples/s | 61.2 steps/s
[Step=14800 Epoch=28.9] | Loss=0.04972 | Reg=0.00291 | acc=0.9375 | L2-Norm=17.045 | L2-Norm(final)=5.409 | 3977.1 samples/s | 62.1 steps/s
[Step=14850 Epoch=29.0] | Loss=0.04788 | Reg=0.00292 | acc=0.9688 | L2-Norm=17.078 | L2-Norm(final)=5.399 | 3940.0 samples/s | 61.6 steps/s
[Step=14900 Epoch=29.1] | Loss=0.04598 | Reg=0.00293 | acc=0.9688 | L2-Norm=17.111 | L2-Norm(final)=5.391 | 3920.9 samples/s | 61.3 steps/s
[Step=14950 Epoch=29.2] | Loss=0.04597 | Reg=0.00294 | acc=0.9688 | L2-Norm=17.143 | L2-Norm(final)=5.383 | 3897.5 samples/s | 60.9 steps/s
[Step=15000 Epoch=29.3] | Loss=0.04566 | Reg=0.00295 | acc=0.9531 | L2-Norm=17.175 | L2-Norm(final)=5.375 | 4899.9 samples/s | 76.6 steps/s
[Step=15050 Epoch=29.4] | Loss=0.04448 | Reg=0.00296 | acc=0.9375 | L2-Norm=17.206 | L2-Norm(final)=5.368 | 1518.2 samples/s | 23.7 steps/s
[Step=15100 Epoch=29.5] | Loss=0.04334 | Reg=0.00297 | acc=0.9844 | L2-Norm=17.237 | L2-Norm(final)=5.362 | 3923.2 samples/s | 61.3 steps/s
[Step=15150 Epoch=29.6] | Loss=0.04237 | Reg=0.00298 | acc=0.9688 | L2-Norm=17.267 | L2-Norm(final)=5.358 | 3903.5 samples/s | 61.0 steps/s
[Step=15200 Epoch=29.7] | Loss=0.04140 | Reg=0.00299 | acc=0.9688 | L2-Norm=17.295 | L2-Norm(final)=5.353 | 3981.2 samples/s | 62.2 steps/s
[Step=15250 Epoch=29.8] | Loss=0.04059 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.321 | L2-Norm(final)=5.349 | 3910.7 samples/s | 61.1 steps/s
[Step=15300 Epoch=29.9] | Loss=0.03988 | Reg=0.00301 | acc=0.9844 | L2-Norm=17.346 | L2-Norm(final)=5.345 | 3909.3 samples/s | 61.1 steps/s
[Step=15350 Epoch=30.0] | Loss=0.03913 | Reg=0.00302 | acc=0.9844 | L2-Norm=17.369 | L2-Norm(final)=5.341 | 3906.9 samples/s | 61.0 steps/s
[Step=15400 Epoch=30.1] | Loss=0.03842 | Reg=0.00303 | acc=0.9844 | L2-Norm=17.392 | L2-Norm(final)=5.337 | 3983.8 samples/s | 62.2 steps/s
[Step=15450 Epoch=30.2] | Loss=0.03796 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.413 | L2-Norm(final)=5.334 | 3950.0 samples/s | 61.7 steps/s
[Step=15500 Epoch=30.3] | Loss=0.03770 | Reg=0.00304 | acc=0.9531 | L2-Norm=17.433 | L2-Norm(final)=5.331 | 4234.8 samples/s | 66.2 steps/s
[Step=15550 Epoch=30.4] | Loss=0.03714 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.454 | L2-Norm(final)=5.327 | 1567.4 samples/s | 24.5 steps/s
[Step=15600 Epoch=30.5] | Loss=0.03658 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.474 | L2-Norm(final)=5.324 | 3863.6 samples/s | 60.4 steps/s
[Step=15650 Epoch=30.6] | Loss=0.03587 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.494 | L2-Norm(final)=5.321 | 3892.6 samples/s | 60.8 steps/s
[Step=15700 Epoch=30.7] | Loss=0.03535 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.513 | L2-Norm(final)=5.318 | 3891.7 samples/s | 60.8 steps/s
[Step=15750 Epoch=30.8] | Loss=0.03492 | Reg=0.00307 | acc=0.9688 | L2-Norm=17.531 | L2-Norm(final)=5.316 | 3936.3 samples/s | 61.5 steps/s
[Step=15800 Epoch=30.9] | Loss=0.03465 | Reg=0.00308 | acc=0.9688 | L2-Norm=17.550 | L2-Norm(final)=5.313 | 3958.7 samples/s | 61.9 steps/s
[Step=15850 Epoch=31.0] | Loss=0.03426 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.568 | L2-Norm(final)=5.310 | 3887.8 samples/s | 60.7 steps/s
[Step=15900 Epoch=31.1] | Loss=0.03382 | Reg=0.00309 | acc=0.9844 | L2-Norm=17.586 | L2-Norm(final)=5.307 | 3918.2 samples/s | 61.2 steps/s
[Step=15950 Epoch=31.2] | Loss=0.03357 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.603 | L2-Norm(final)=5.304 | 3928.2 samples/s | 61.4 steps/s
[Step=16000 Epoch=31.3] | Loss=0.03330 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.620 | L2-Norm(final)=5.301 | 3939.7 samples/s | 61.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step16000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=14001 Epoch=53.6] | Loss=0.02919 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.082 | L2-Norm(final)=5.583 | 3069.8 samples/s | 48.0 steps/s
[Step=14050 Epoch=53.8] | Loss=0.00775 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.313 | L2-Norm(final)=5.611 | 4111.9 samples/s | 64.2 steps/s
[Step=14100 Epoch=54.0] | Loss=0.00571 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.472 | L2-Norm(final)=5.630 | 4185.8 samples/s | 65.4 steps/s
[Step=14150 Epoch=54.2] | Loss=0.00400 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.543 | L2-Norm(final)=5.648 | 4110.8 samples/s | 64.2 steps/s
[Step=14200 Epoch=54.4] | Loss=0.00369 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.569 | L2-Norm(final)=5.667 | 4016.6 samples/s | 62.8 steps/s
[Step=14250 Epoch=54.6] | Loss=0.00314 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.580 | L2-Norm(final)=5.684 | 5371.0 samples/s | 83.9 steps/s
[Step=14300 Epoch=54.8] | Loss=0.00269 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.580 | L2-Norm(final)=5.701 | 1544.1 samples/s | 24.1 steps/s
[Step=14350 Epoch=55.0] | Loss=0.00236 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.571 | L2-Norm(final)=5.718 | 4165.0 samples/s | 65.1 steps/s
[Step=14400 Epoch=55.2] | Loss=0.00216 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.557 | L2-Norm(final)=5.734 | 4082.9 samples/s | 63.8 steps/s
[Step=14450 Epoch=55.4] | Loss=0.00196 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.540 | L2-Norm(final)=5.749 | 4138.2 samples/s | 64.7 steps/s
[Step=14500 Epoch=55.6] | Loss=0.00178 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.521 | L2-Norm(final)=5.764 | 4655.2 samples/s | 72.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=14501 Epoch=55.6] | Loss=0.00019 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.316 | L2-Norm(final)=5.910 | 3183.1 samples/s | 49.7 steps/s
[Step=14550 Epoch=55.8] | Loss=0.00031 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.277 | L2-Norm(final)=5.920 | 3527.9 samples/s | 55.1 steps/s
[Step=14600 Epoch=55.9] | Loss=0.00970 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.334 | L2-Norm(final)=5.909 | 3708.4 samples/s | 57.9 steps/s
[Step=14650 Epoch=56.1] | Loss=0.01383 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.595 | L2-Norm(final)=5.823 | 3692.6 samples/s | 57.7 steps/s
[Step=14700 Epoch=56.3] | Loss=0.01130 | Reg=0.00249 | acc=0.9844 | L2-Norm=15.774 | L2-Norm(final)=5.770 | 3776.5 samples/s | 59.0 steps/s
[Step=14750 Epoch=56.5] | Loss=0.00976 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.877 | L2-Norm(final)=5.743 | 4688.3 samples/s | 73.3 steps/s
[Step=14800 Epoch=56.7] | Loss=0.00842 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.938 | L2-Norm(final)=5.726 | 1458.0 samples/s | 22.8 steps/s
[Step=14850 Epoch=56.9] | Loss=0.00728 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.976 | L2-Norm(final)=5.715 | 3744.7 samples/s | 58.5 steps/s
[Step=14900 Epoch=57.1] | Loss=0.00672 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.997 | L2-Norm(final)=5.707 | 3739.7 samples/s | 58.4 steps/s
[Step=14950 Epoch=57.3] | Loss=0.00608 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.009 | L2-Norm(final)=5.699 | 3711.7 samples/s | 58.0 steps/s
[Step=15000 Epoch=57.5] | Loss=0.00548 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.014 | L2-Norm(final)=5.694 | 4144.5 samples/s | 64.8 steps/s
[Step=15050 Epoch=57.7] | Loss=0.00501 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.012 | L2-Norm(final)=5.690 | 1545.1 samples/s | 24.1 steps/s
[Step=15100 Epoch=57.9] | Loss=0.00459 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.005 | L2-Norm(final)=5.688 | 3634.3 samples/s | 56.8 steps/s
[Step=15150 Epoch=58.0] | Loss=0.00424 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.994 | L2-Norm(final)=5.687 | 3714.8 samples/s | 58.0 steps/s
[Step=15200 Epoch=58.2] | Loss=0.00395 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.980 | L2-Norm(final)=5.686 | 3656.1 samples/s | 57.1 steps/s
[Step=15250 Epoch=58.4] | Loss=0.00369 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.964 | L2-Norm(final)=5.686 | 3745.3 samples/s | 58.5 steps/s
[Step=15300 Epoch=58.6] | Loss=0.00346 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.946 | L2-Norm(final)=5.686 | 1559.1 samples/s | 24.4 steps/s
[Step=15350 Epoch=58.8] | Loss=0.00326 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.926 | L2-Norm(final)=5.686 | 3787.9 samples/s | 59.2 steps/s
[Step=15400 Epoch=59.0] | Loss=0.00308 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.905 | L2-Norm(final)=5.687 | 3701.9 samples/s | 57.8 steps/s
[Step=15450 Epoch=59.2] | Loss=0.00291 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.882 | L2-Norm(final)=5.687 | 3721.5 samples/s | 58.1 steps/s
[Step=15500 Epoch=59.4] | Loss=0.00277 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.858 | L2-Norm(final)=5.687 | 3706.4 samples/s | 57.9 steps/s
[Step=15550 Epoch=59.6] | Loss=0.00264 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.833 | L2-Norm(final)=5.688 | 1584.5 samples/s | 24.8 steps/s
[Step=15600 Epoch=59.8] | Loss=0.00252 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.808 | L2-Norm(final)=5.688 | 3705.9 samples/s | 57.9 steps/s
[Step=15650 Epoch=60.0] | Loss=0.00241 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.782 | L2-Norm(final)=5.689 | 3687.5 samples/s | 57.6 steps/s
[Step=15700 Epoch=60.2] | Loss=0.00231 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.755 | L2-Norm(final)=5.689 | 3677.0 samples/s | 57.5 steps/s
[Step=15750 Epoch=60.3] | Loss=0.00222 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.728 | L2-Norm(final)=5.690 | 3715.1 samples/s | 58.0 steps/s
[Step=15800 Epoch=60.5] | Loss=0.00213 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.701 | L2-Norm(final)=5.690 | 5095.8 samples/s | 79.6 steps/s
[Step=15850 Epoch=60.7] | Loss=0.00205 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.673 | L2-Norm(final)=5.691 | 1440.6 samples/s | 22.5 steps/s
[Step=15900 Epoch=60.9] | Loss=0.00198 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.645 | L2-Norm(final)=5.691 | 3770.6 samples/s | 58.9 steps/s
[Step=15950 Epoch=61.1] | Loss=0.00191 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.617 | L2-Norm(final)=5.692 | 3660.7 samples/s | 57.2 steps/s
[Step=16000 Epoch=61.3] | Loss=0.00185 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.588 | L2-Norm(final)=5.693 | 3744.8 samples/s | 58.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step16000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=14001 Epoch=53.9] | Loss=0.00766 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.082 | L2-Norm(final)=5.763 | 3341.1 samples/s | 52.2 steps/s
[Step=14050 Epoch=54.1] | Loss=0.01150 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.314 | L2-Norm(final)=5.770 | 3713.6 samples/s | 58.0 steps/s
[Step=14100 Epoch=54.3] | Loss=0.00761 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.500 | L2-Norm(final)=5.782 | 4184.4 samples/s | 65.4 steps/s
[Step=14150 Epoch=54.5] | Loss=0.00590 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.583 | L2-Norm(final)=5.805 | 4050.9 samples/s | 63.3 steps/s
[Step=14200 Epoch=54.7] | Loss=0.00501 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.634 | L2-Norm(final)=5.827 | 4137.3 samples/s | 64.6 steps/s
[Step=14250 Epoch=54.9] | Loss=0.00448 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.669 | L2-Norm(final)=5.850 | 5339.7 samples/s | 83.4 steps/s
[Step=14300 Epoch=55.0] | Loss=0.00383 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.698 | L2-Norm(final)=5.873 | 1498.9 samples/s | 23.4 steps/s
[Step=14350 Epoch=55.2] | Loss=0.00335 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.712 | L2-Norm(final)=5.896 | 4111.4 samples/s | 64.2 steps/s
[Step=14400 Epoch=55.4] | Loss=0.00306 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.718 | L2-Norm(final)=5.917 | 4090.7 samples/s | 63.9 steps/s
[Step=14450 Epoch=55.6] | Loss=0.00281 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.722 | L2-Norm(final)=5.938 | 4108.6 samples/s | 64.2 steps/s
[Step=14500 Epoch=55.8] | Loss=0.00262 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.724 | L2-Norm(final)=5.960 | 4775.1 samples/s | 74.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=14501 Epoch=55.8] | Loss=0.00045 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.728 | L2-Norm(final)=6.181 | 3222.0 samples/s | 50.3 steps/s
[Step=14550 Epoch=56.0] | Loss=0.01941 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.895 | L2-Norm(final)=6.156 | 3477.9 samples/s | 54.3 steps/s
[Step=14600 Epoch=56.2] | Loss=0.02523 | Reg=0.00265 | acc=0.9688 | L2-Norm=16.276 | L2-Norm(final)=6.035 | 3719.7 samples/s | 58.1 steps/s
[Step=14650 Epoch=56.4] | Loss=0.02038 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.479 | L2-Norm(final)=5.964 | 3805.7 samples/s | 59.5 steps/s
[Step=14700 Epoch=56.6] | Loss=0.01641 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.583 | L2-Norm(final)=5.928 | 3712.4 samples/s | 58.0 steps/s
[Step=14750 Epoch=56.8] | Loss=0.01379 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.641 | L2-Norm(final)=5.908 | 4761.2 samples/s | 74.4 steps/s
[Step=14800 Epoch=57.0] | Loss=0.01198 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.672 | L2-Norm(final)=5.895 | 1480.4 samples/s | 23.1 steps/s
[Step=14850 Epoch=57.2] | Loss=0.01091 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.693 | L2-Norm(final)=5.885 | 3685.7 samples/s | 57.6 steps/s
[Step=14900 Epoch=57.4] | Loss=0.00960 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.705 | L2-Norm(final)=5.879 | 3708.3 samples/s | 57.9 steps/s
[Step=14950 Epoch=57.5] | Loss=0.00856 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.708 | L2-Norm(final)=5.876 | 3721.8 samples/s | 58.2 steps/s
[Step=15000 Epoch=57.7] | Loss=0.00772 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.704 | L2-Norm(final)=5.875 | 4214.0 samples/s | 65.8 steps/s
[Step=15050 Epoch=57.9] | Loss=0.00703 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.694 | L2-Norm(final)=5.875 | 1535.5 samples/s | 24.0 steps/s
[Step=15100 Epoch=58.1] | Loss=0.00644 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.681 | L2-Norm(final)=5.875 | 3745.2 samples/s | 58.5 steps/s
[Step=15150 Epoch=58.3] | Loss=0.00595 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.665 | L2-Norm(final)=5.875 | 3727.7 samples/s | 58.2 steps/s
[Step=15200 Epoch=58.5] | Loss=0.00553 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.646 | L2-Norm(final)=5.876 | 3745.7 samples/s | 58.5 steps/s
[Step=15250 Epoch=58.7] | Loss=0.00516 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.625 | L2-Norm(final)=5.877 | 3828.7 samples/s | 59.8 steps/s
[Step=15300 Epoch=58.9] | Loss=0.00484 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.603 | L2-Norm(final)=5.878 | 1562.3 samples/s | 24.4 steps/s
[Step=15350 Epoch=59.1] | Loss=0.00456 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.579 | L2-Norm(final)=5.879 | 3774.3 samples/s | 59.0 steps/s
[Step=15400 Epoch=59.3] | Loss=0.00430 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.555 | L2-Norm(final)=5.881 | 3744.6 samples/s | 58.5 steps/s
[Step=15450 Epoch=59.5] | Loss=0.00408 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.530 | L2-Norm(final)=5.882 | 3745.4 samples/s | 58.5 steps/s
[Step=15500 Epoch=59.7] | Loss=0.00388 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.504 | L2-Norm(final)=5.884 | 3677.6 samples/s | 57.5 steps/s
[Step=15550 Epoch=59.9] | Loss=0.00369 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.477 | L2-Norm(final)=5.886 | 1622.8 samples/s | 25.4 steps/s
[Step=15600 Epoch=60.1] | Loss=0.00352 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.450 | L2-Norm(final)=5.888 | 3720.4 samples/s | 58.1 steps/s
[Step=15650 Epoch=60.2] | Loss=0.00337 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.422 | L2-Norm(final)=5.890 | 3693.7 samples/s | 57.7 steps/s
[Step=15700 Epoch=60.4] | Loss=0.00323 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.394 | L2-Norm(final)=5.893 | 3693.7 samples/s | 57.7 steps/s
[Step=15750 Epoch=60.6] | Loss=0.00310 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.366 | L2-Norm(final)=5.895 | 3812.2 samples/s | 59.6 steps/s
[Step=15800 Epoch=60.8] | Loss=0.00298 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.337 | L2-Norm(final)=5.897 | 5354.0 samples/s | 83.7 steps/s
[Step=15850 Epoch=61.0] | Loss=0.00287 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.308 | L2-Norm(final)=5.899 | 1395.1 samples/s | 21.8 steps/s
[Step=15900 Epoch=61.2] | Loss=0.00277 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.279 | L2-Norm(final)=5.902 | 3730.6 samples/s | 58.3 steps/s
[Step=15950 Epoch=61.4] | Loss=0.00268 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.250 | L2-Norm(final)=5.904 | 3682.3 samples/s | 57.5 steps/s
[Step=16000 Epoch=61.6] | Loss=0.00259 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.221 | L2-Norm(final)=5.907 | 3690.9 samples/s | 57.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07026 | acc=0.9569 | tpr=0.9580 | fpr=0.0456 | 2612.2 samples/s | 10.2 steps/s
Avg test loss: 0.07198, Avg test acc: 0.95561, Avg tpr: 0.95687, Avg fpr: 0.04717, total FA: 368

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06098 | acc=0.9618 | tpr=0.9701 | fpr=0.0562 | 3530.4 samples/s | 13.8 steps/s
Avg test loss: 0.06651, Avg test acc: 0.95961, Avg tpr: 0.96730, Avg fpr: 0.05730, total FA: 447

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.04255 | acc=0.3127 | tpr=0.0060 | fpr=0.0216 | 3572.7 samples/s | 14.0 steps/s
Avg test loss: 5.05602, Avg test acc: 0.31008, Avg tpr: 0.00694, Avg fpr: 0.02320, total FA: 181

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.43711 | acc=0.3080 | tpr=0.0090 | fpr=0.0429 | 3541.7 samples/s | 13.8 steps/s
Avg test loss: 5.45527, Avg test acc: 0.30635, Avg tpr: 0.00892, Avg fpr: 0.03948, total FA: 308

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.12310 | acc=0.0992 | tpr=0.8053 | fpr=0.9135 | 3517.3 samples/s | 13.7 steps/s
[Step= 100] | Loss=5.09284 | acc=0.0993 | tpr=0.7910 | fpr=0.9136 | 6805.8 samples/s | 26.6 steps/s
[Step= 150] | Loss=5.09456 | acc=0.0994 | tpr=0.7911 | fpr=0.9134 | 7035.3 samples/s | 27.5 steps/s
[Step= 200] | Loss=5.07610 | acc=0.0996 | tpr=0.7847 | fpr=0.9129 | 7024.3 samples/s | 27.4 steps/s
[Step= 250] | Loss=5.08236 | acc=0.0996 | tpr=0.7904 | fpr=0.9130 | 6788.6 samples/s | 26.5 steps/s
[Step= 300] | Loss=5.08098 | acc=0.0992 | tpr=0.7862 | fpr=0.9134 | 6920.1 samples/s | 27.0 steps/s
[Step= 350] | Loss=5.07421 | acc=0.1000 | tpr=0.7871 | fpr=0.9124 | 6878.5 samples/s | 26.9 steps/s
[Step= 400] | Loss=5.07227 | acc=0.0999 | tpr=0.7888 | fpr=0.9126 | 6764.1 samples/s | 26.4 steps/s
[Step= 450] | Loss=5.07806 | acc=0.0997 | tpr=0.7892 | fpr=0.9128 | 6838.5 samples/s | 26.7 steps/s
[Step= 500] | Loss=5.08108 | acc=0.0998 | tpr=0.7877 | fpr=0.9126 | 6712.3 samples/s | 26.2 steps/s
[Step= 550] | Loss=5.08312 | acc=0.0996 | tpr=0.7831 | fpr=0.9128 | 12122.0 samples/s | 47.4 steps/s
Avg test loss: 5.08401, Avg test acc: 0.09951, Avg tpr: 0.78328, Avg fpr: 0.91292, total FA: 126757

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.83636 | acc=0.1006 | tpr=0.8540 | fpr=0.9129 | 3467.8 samples/s | 13.5 steps/s
[Step= 100] | Loss=5.79623 | acc=0.1008 | tpr=0.8614 | fpr=0.9134 | 6774.4 samples/s | 26.5 steps/s
[Step= 150] | Loss=5.81274 | acc=0.0985 | tpr=0.8545 | fpr=0.9154 | 6840.1 samples/s | 26.7 steps/s
[Step= 200] | Loss=5.80393 | acc=0.0982 | tpr=0.8481 | fpr=0.9154 | 6828.1 samples/s | 26.7 steps/s
[Step= 250] | Loss=5.80631 | acc=0.0984 | tpr=0.8428 | fpr=0.9151 | 6931.5 samples/s | 27.1 steps/s
[Step= 300] | Loss=5.80928 | acc=0.0981 | tpr=0.8393 | fpr=0.9154 | 6781.1 samples/s | 26.5 steps/s
[Step= 350] | Loss=5.80748 | acc=0.0986 | tpr=0.8428 | fpr=0.9149 | 6777.2 samples/s | 26.5 steps/s
[Step= 400] | Loss=5.80345 | acc=0.0988 | tpr=0.8446 | fpr=0.9147 | 6887.8 samples/s | 26.9 steps/s
[Step= 450] | Loss=5.81138 | acc=0.0987 | tpr=0.8481 | fpr=0.9149 | 6600.7 samples/s | 25.8 steps/s
[Step= 500] | Loss=5.81060 | acc=0.0987 | tpr=0.8485 | fpr=0.9148 | 7140.9 samples/s | 27.9 steps/s
[Step= 550] | Loss=5.81003 | acc=0.0988 | tpr=0.8492 | fpr=0.9149 | 11888.9 samples/s | 46.4 steps/s
Avg test loss: 5.81211, Avg test acc: 0.09868, Avg tpr: 0.84905, Avg fpr: 0.91496, total FA: 127040

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09566 | acc=0.9824 | tpr=0.9204 | fpr=0.0165 | 3561.5 samples/s | 13.9 steps/s
[Step= 100] | Loss=0.09836 | acc=0.9821 | tpr=0.9424 | fpr=0.0171 | 6650.4 samples/s | 26.0 steps/s
[Step= 150] | Loss=0.10181 | acc=0.9813 | tpr=0.9438 | fpr=0.0180 | 6836.6 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.10338 | acc=0.9812 | tpr=0.9454 | fpr=0.0182 | 7029.9 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.10261 | acc=0.9814 | tpr=0.9424 | fpr=0.0179 | 6877.3 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.10472 | acc=0.9811 | tpr=0.9418 | fpr=0.0182 | 6846.9 samples/s | 26.7 steps/s
[Step= 350] | Loss=0.10404 | acc=0.9811 | tpr=0.9430 | fpr=0.0182 | 6946.9 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.10508 | acc=0.9808 | tpr=0.9409 | fpr=0.0184 | 6703.1 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.10720 | acc=0.9805 | tpr=0.9387 | fpr=0.0187 | 6646.4 samples/s | 26.0 steps/s
[Step= 500] | Loss=0.10668 | acc=0.9807 | tpr=0.9401 | fpr=0.0186 | 6817.6 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.10601 | acc=0.9808 | tpr=0.9387 | fpr=0.0185 | 12738.5 samples/s | 49.8 steps/s
Avg test loss: 0.10580, Avg test acc: 0.98078, Avg tpr: 0.93780, Avg fpr: 0.01844, total FA: 2560

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09203 | acc=0.9816 | tpr=0.9336 | fpr=0.0175 | 3520.8 samples/s | 13.8 steps/s
[Step= 100] | Loss=0.09603 | acc=0.9811 | tpr=0.9467 | fpr=0.0182 | 6794.0 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.09938 | acc=0.9801 | tpr=0.9510 | fpr=0.0193 | 6946.6 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.10079 | acc=0.9800 | tpr=0.9519 | fpr=0.0195 | 7076.5 samples/s | 27.6 steps/s
[Step= 250] | Loss=0.09917 | acc=0.9803 | tpr=0.9537 | fpr=0.0193 | 6745.5 samples/s | 26.3 steps/s
[Step= 300] | Loss=0.10156 | acc=0.9799 | tpr=0.9520 | fpr=0.0195 | 6791.8 samples/s | 26.5 steps/s
[Step= 350] | Loss=0.10153 | acc=0.9799 | tpr=0.9530 | fpr=0.0196 | 6937.2 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.10272 | acc=0.9797 | tpr=0.9497 | fpr=0.0198 | 6904.7 samples/s | 27.0 steps/s
[Step= 450] | Loss=0.10431 | acc=0.9795 | tpr=0.9479 | fpr=0.0200 | 6638.8 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.10398 | acc=0.9796 | tpr=0.9502 | fpr=0.0198 | 6734.1 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.10365 | acc=0.9796 | tpr=0.9483 | fpr=0.0198 | 12582.4 samples/s | 49.2 steps/s
Avg test loss: 0.10347, Avg test acc: 0.97962, Avg tpr: 0.94731, Avg fpr: 0.01979, total FA: 2748

server round 8/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=16001 Epoch=31.2] | Loss=0.03291 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.128 | L2-Norm(final)=4.945 | 3067.1 samples/s | 47.9 steps/s
[Step=16050 Epoch=31.3] | Loss=0.06201 | Reg=0.00234 | acc=0.9688 | L2-Norm=15.289 | L2-Norm(final)=4.988 | 4244.8 samples/s | 66.3 steps/s
[Step=16100 Epoch=31.4] | Loss=0.06050 | Reg=0.00238 | acc=0.9688 | L2-Norm=15.415 | L2-Norm(final)=5.031 | 4343.3 samples/s | 67.9 steps/s
[Step=16150 Epoch=31.5] | Loss=0.05935 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.522 | L2-Norm(final)=5.065 | 4490.2 samples/s | 70.2 steps/s
[Step=16200 Epoch=31.6] | Loss=0.05807 | Reg=0.00244 | acc=0.9531 | L2-Norm=15.618 | L2-Norm(final)=5.100 | 4353.1 samples/s | 68.0 steps/s
[Step=16250 Epoch=31.7] | Loss=0.05763 | Reg=0.00247 | acc=0.9531 | L2-Norm=15.704 | L2-Norm(final)=5.129 | 4420.6 samples/s | 69.1 steps/s
[Step=16300 Epoch=31.8] | Loss=0.05597 | Reg=0.00249 | acc=0.9844 | L2-Norm=15.783 | L2-Norm(final)=5.156 | 4458.3 samples/s | 69.7 steps/s
[Step=16350 Epoch=31.9] | Loss=0.05530 | Reg=0.00252 | acc=0.9688 | L2-Norm=15.858 | L2-Norm(final)=5.185 | 4280.8 samples/s | 66.9 steps/s
[Step=16400 Epoch=32.0] | Loss=0.05500 | Reg=0.00254 | acc=0.9531 | L2-Norm=15.931 | L2-Norm(final)=5.213 | 4378.4 samples/s | 68.4 steps/s
[Step=16450 Epoch=32.1] | Loss=0.05482 | Reg=0.00256 | acc=0.9688 | L2-Norm=16.002 | L2-Norm(final)=5.238 | 4385.6 samples/s | 68.5 steps/s
[Step=16500 Epoch=32.2] | Loss=0.05455 | Reg=0.00258 | acc=0.9688 | L2-Norm=16.070 | L2-Norm(final)=5.262 | 5532.2 samples/s | 86.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=16501 Epoch=32.2] | Loss=0.03214 | Reg=0.00280 | acc=0.9531 | L2-Norm=16.735 | L2-Norm(final)=5.503 | 3332.8 samples/s | 52.1 steps/s
[Step=16550 Epoch=32.3] | Loss=0.04438 | Reg=0.00283 | acc=0.9688 | L2-Norm=16.831 | L2-Norm(final)=5.530 | 3565.5 samples/s | 55.7 steps/s
[Step=16600 Epoch=32.4] | Loss=0.04594 | Reg=0.00286 | acc=0.9219 | L2-Norm=16.920 | L2-Norm(final)=5.508 | 3909.8 samples/s | 61.1 steps/s
[Step=16650 Epoch=32.5] | Loss=0.04394 | Reg=0.00288 | acc=0.9688 | L2-Norm=16.984 | L2-Norm(final)=5.497 | 3948.1 samples/s | 61.7 steps/s
[Step=16700 Epoch=32.6] | Loss=0.04487 | Reg=0.00290 | acc=0.9844 | L2-Norm=17.034 | L2-Norm(final)=5.491 | 3921.4 samples/s | 61.3 steps/s
[Step=16750 Epoch=32.7] | Loss=0.04646 | Reg=0.00292 | acc=0.9531 | L2-Norm=17.082 | L2-Norm(final)=5.481 | 3939.7 samples/s | 61.6 steps/s
[Step=16800 Epoch=32.8] | Loss=0.04588 | Reg=0.00293 | acc=0.9688 | L2-Norm=17.124 | L2-Norm(final)=5.471 | 3952.1 samples/s | 61.8 steps/s
[Step=16850 Epoch=32.9] | Loss=0.04582 | Reg=0.00295 | acc=0.9688 | L2-Norm=17.163 | L2-Norm(final)=5.462 | 3908.8 samples/s | 61.1 steps/s
[Step=16900 Epoch=33.0] | Loss=0.04474 | Reg=0.00296 | acc=0.9688 | L2-Norm=17.198 | L2-Norm(final)=5.453 | 3979.8 samples/s | 62.2 steps/s
[Step=16950 Epoch=33.1] | Loss=0.04376 | Reg=0.00297 | acc=0.9844 | L2-Norm=17.228 | L2-Norm(final)=5.445 | 4001.5 samples/s | 62.5 steps/s
[Step=17000 Epoch=33.2] | Loss=0.04272 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.256 | L2-Norm(final)=5.439 | 4770.8 samples/s | 74.5 steps/s
[Step=17050 Epoch=33.3] | Loss=0.04176 | Reg=0.00299 | acc=0.9688 | L2-Norm=17.283 | L2-Norm(final)=5.434 | 1469.7 samples/s | 23.0 steps/s
[Step=17100 Epoch=33.4] | Loss=0.04051 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.308 | L2-Norm(final)=5.429 | 3922.1 samples/s | 61.3 steps/s
[Step=17150 Epoch=33.4] | Loss=0.03941 | Reg=0.00300 | acc=0.9531 | L2-Norm=17.331 | L2-Norm(final)=5.426 | 3918.2 samples/s | 61.2 steps/s
[Step=17200 Epoch=33.5] | Loss=0.03880 | Reg=0.00301 | acc=0.9688 | L2-Norm=17.352 | L2-Norm(final)=5.422 | 3949.5 samples/s | 61.7 steps/s
[Step=17250 Epoch=33.6] | Loss=0.03812 | Reg=0.00302 | acc=0.9844 | L2-Norm=17.372 | L2-Norm(final)=5.418 | 3942.7 samples/s | 61.6 steps/s
[Step=17300 Epoch=33.7] | Loss=0.03763 | Reg=0.00303 | acc=0.9844 | L2-Norm=17.392 | L2-Norm(final)=5.414 | 3984.3 samples/s | 62.3 steps/s
[Step=17350 Epoch=33.8] | Loss=0.03739 | Reg=0.00303 | acc=0.9688 | L2-Norm=17.411 | L2-Norm(final)=5.409 | 3919.5 samples/s | 61.2 steps/s
[Step=17400 Epoch=33.9] | Loss=0.03674 | Reg=0.00304 | acc=0.9844 | L2-Norm=17.430 | L2-Norm(final)=5.405 | 3975.6 samples/s | 62.1 steps/s
[Step=17450 Epoch=34.0] | Loss=0.03622 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.449 | L2-Norm(final)=5.402 | 3944.3 samples/s | 61.6 steps/s
[Step=17500 Epoch=34.1] | Loss=0.03568 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.467 | L2-Norm(final)=5.398 | 4164.4 samples/s | 65.1 steps/s
[Step=17550 Epoch=34.2] | Loss=0.03511 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.485 | L2-Norm(final)=5.395 | 1563.1 samples/s | 24.4 steps/s
[Step=17600 Epoch=34.3] | Loss=0.03478 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.503 | L2-Norm(final)=5.392 | 3940.3 samples/s | 61.6 steps/s
[Step=17650 Epoch=34.4] | Loss=0.03415 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.520 | L2-Norm(final)=5.389 | 3863.3 samples/s | 60.4 steps/s
[Step=17700 Epoch=34.5] | Loss=0.03376 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.538 | L2-Norm(final)=5.386 | 3892.7 samples/s | 60.8 steps/s
[Step=17750 Epoch=34.6] | Loss=0.03319 | Reg=0.00308 | acc=0.9844 | L2-Norm=17.555 | L2-Norm(final)=5.383 | 3941.6 samples/s | 61.6 steps/s
[Step=17800 Epoch=34.7] | Loss=0.03279 | Reg=0.00309 | acc=0.9844 | L2-Norm=17.572 | L2-Norm(final)=5.381 | 3874.3 samples/s | 60.5 steps/s
[Step=17850 Epoch=34.8] | Loss=0.03251 | Reg=0.00309 | acc=0.9688 | L2-Norm=17.588 | L2-Norm(final)=5.378 | 3943.5 samples/s | 61.6 steps/s
[Step=17900 Epoch=34.9] | Loss=0.03219 | Reg=0.00310 | acc=0.9375 | L2-Norm=17.604 | L2-Norm(final)=5.376 | 3898.8 samples/s | 60.9 steps/s
[Step=17950 Epoch=35.0] | Loss=0.03188 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.620 | L2-Norm(final)=5.374 | 3931.0 samples/s | 61.4 steps/s
[Step=18000 Epoch=35.1] | Loss=0.03148 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.635 | L2-Norm(final)=5.371 | 3924.7 samples/s | 61.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step18000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=16001 Epoch=31.3] | Loss=0.08471 | Reg=0.00229 | acc=0.9375 | L2-Norm=15.128 | L2-Norm(final)=5.204 | 3418.5 samples/s | 53.4 steps/s
[Step=16050 Epoch=31.4] | Loss=0.06090 | Reg=0.00234 | acc=0.9688 | L2-Norm=15.297 | L2-Norm(final)=5.256 | 3953.3 samples/s | 61.8 steps/s
[Step=16100 Epoch=31.5] | Loss=0.05890 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.447 | L2-Norm(final)=5.310 | 4284.5 samples/s | 66.9 steps/s
[Step=16150 Epoch=31.6] | Loss=0.05617 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.555 | L2-Norm(final)=5.352 | 4376.9 samples/s | 68.4 steps/s
[Step=16200 Epoch=31.7] | Loss=0.05388 | Reg=0.00245 | acc=0.9531 | L2-Norm=15.650 | L2-Norm(final)=5.393 | 4380.9 samples/s | 68.5 steps/s
[Step=16250 Epoch=31.8] | Loss=0.05454 | Reg=0.00248 | acc=0.9062 | L2-Norm=15.740 | L2-Norm(final)=5.430 | 4312.9 samples/s | 67.4 steps/s
[Step=16300 Epoch=31.9] | Loss=0.05473 | Reg=0.00251 | acc=0.9219 | L2-Norm=15.825 | L2-Norm(final)=5.460 | 4352.4 samples/s | 68.0 steps/s
[Step=16350 Epoch=32.0] | Loss=0.05416 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.906 | L2-Norm(final)=5.489 | 4336.1 samples/s | 67.8 steps/s
[Step=16400 Epoch=32.1] | Loss=0.05426 | Reg=0.00256 | acc=0.9844 | L2-Norm=15.987 | L2-Norm(final)=5.518 | 4369.4 samples/s | 68.3 steps/s
[Step=16450 Epoch=32.2] | Loss=0.05386 | Reg=0.00258 | acc=0.9375 | L2-Norm=16.067 | L2-Norm(final)=5.546 | 4339.2 samples/s | 67.8 steps/s
[Step=16500 Epoch=32.3] | Loss=0.05328 | Reg=0.00261 | acc=0.9219 | L2-Norm=16.142 | L2-Norm(final)=5.575 | 5579.0 samples/s | 87.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=16501 Epoch=32.3] | Loss=0.04333 | Reg=0.00285 | acc=0.9844 | L2-Norm=16.870 | L2-Norm(final)=5.852 | 3240.1 samples/s | 50.6 steps/s
[Step=16550 Epoch=32.4] | Loss=0.04390 | Reg=0.00287 | acc=0.9219 | L2-Norm=16.941 | L2-Norm(final)=5.858 | 3729.7 samples/s | 58.3 steps/s
[Step=16600 Epoch=32.5] | Loss=0.04340 | Reg=0.00290 | acc=0.9844 | L2-Norm=17.015 | L2-Norm(final)=5.848 | 3902.0 samples/s | 61.0 steps/s
[Step=16650 Epoch=32.6] | Loss=0.04561 | Reg=0.00292 | acc=0.9375 | L2-Norm=17.075 | L2-Norm(final)=5.838 | 3921.2 samples/s | 61.3 steps/s
[Step=16700 Epoch=32.6] | Loss=0.04660 | Reg=0.00293 | acc=0.9688 | L2-Norm=17.129 | L2-Norm(final)=5.825 | 3930.9 samples/s | 61.4 steps/s
[Step=16750 Epoch=32.7] | Loss=0.04811 | Reg=0.00295 | acc=0.9531 | L2-Norm=17.175 | L2-Norm(final)=5.805 | 3954.8 samples/s | 61.8 steps/s
[Step=16800 Epoch=32.8] | Loss=0.04643 | Reg=0.00296 | acc=0.9844 | L2-Norm=17.216 | L2-Norm(final)=5.789 | 3939.1 samples/s | 61.5 steps/s
[Step=16850 Epoch=32.9] | Loss=0.04635 | Reg=0.00298 | acc=0.9375 | L2-Norm=17.253 | L2-Norm(final)=5.777 | 3987.0 samples/s | 62.3 steps/s
[Step=16900 Epoch=33.0] | Loss=0.04664 | Reg=0.00299 | acc=0.9688 | L2-Norm=17.287 | L2-Norm(final)=5.765 | 3960.1 samples/s | 61.9 steps/s
[Step=16950 Epoch=33.1] | Loss=0.04522 | Reg=0.00300 | acc=0.9219 | L2-Norm=17.319 | L2-Norm(final)=5.756 | 3950.1 samples/s | 61.7 steps/s
[Step=17000 Epoch=33.2] | Loss=0.04416 | Reg=0.00301 | acc=0.9531 | L2-Norm=17.349 | L2-Norm(final)=5.749 | 4896.2 samples/s | 76.5 steps/s
[Step=17050 Epoch=33.3] | Loss=0.04274 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.377 | L2-Norm(final)=5.742 | 1486.0 samples/s | 23.2 steps/s
[Step=17100 Epoch=33.4] | Loss=0.04114 | Reg=0.00303 | acc=0.9688 | L2-Norm=17.402 | L2-Norm(final)=5.738 | 3893.2 samples/s | 60.8 steps/s
[Step=17150 Epoch=33.5] | Loss=0.04009 | Reg=0.00304 | acc=0.9688 | L2-Norm=17.426 | L2-Norm(final)=5.734 | 3915.7 samples/s | 61.2 steps/s
[Step=17200 Epoch=33.6] | Loss=0.03921 | Reg=0.00305 | acc=0.9844 | L2-Norm=17.449 | L2-Norm(final)=5.729 | 3937.9 samples/s | 61.5 steps/s
[Step=17250 Epoch=33.7] | Loss=0.03857 | Reg=0.00305 | acc=0.9688 | L2-Norm=17.471 | L2-Norm(final)=5.725 | 3910.3 samples/s | 61.1 steps/s
[Step=17300 Epoch=33.8] | Loss=0.03772 | Reg=0.00306 | acc=0.9688 | L2-Norm=17.492 | L2-Norm(final)=5.721 | 3926.5 samples/s | 61.4 steps/s
[Step=17350 Epoch=33.9] | Loss=0.03741 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.512 | L2-Norm(final)=5.717 | 3930.2 samples/s | 61.4 steps/s
[Step=17400 Epoch=34.0] | Loss=0.03706 | Reg=0.00307 | acc=0.9844 | L2-Norm=17.533 | L2-Norm(final)=5.712 | 3931.6 samples/s | 61.4 steps/s
[Step=17450 Epoch=34.1] | Loss=0.03691 | Reg=0.00308 | acc=0.9688 | L2-Norm=17.553 | L2-Norm(final)=5.707 | 3951.1 samples/s | 61.7 steps/s
[Step=17500 Epoch=34.2] | Loss=0.03669 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.574 | L2-Norm(final)=5.702 | 4279.8 samples/s | 66.9 steps/s
[Step=17550 Epoch=34.3] | Loss=0.03600 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.595 | L2-Norm(final)=5.698 | 1618.8 samples/s | 25.3 steps/s
[Step=17600 Epoch=34.4] | Loss=0.03557 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.616 | L2-Norm(final)=5.695 | 3952.9 samples/s | 61.8 steps/s
[Step=17650 Epoch=34.5] | Loss=0.03514 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.636 | L2-Norm(final)=5.691 | 3939.6 samples/s | 61.6 steps/s
[Step=17700 Epoch=34.6] | Loss=0.03464 | Reg=0.00312 | acc=0.9844 | L2-Norm=17.655 | L2-Norm(final)=5.688 | 3956.4 samples/s | 61.8 steps/s
[Step=17750 Epoch=34.7] | Loss=0.03424 | Reg=0.00312 | acc=0.9531 | L2-Norm=17.674 | L2-Norm(final)=5.684 | 3917.0 samples/s | 61.2 steps/s
[Step=17800 Epoch=34.8] | Loss=0.03393 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.692 | L2-Norm(final)=5.681 | 3936.0 samples/s | 61.5 steps/s
[Step=17850 Epoch=34.9] | Loss=0.03357 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.710 | L2-Norm(final)=5.677 | 3970.4 samples/s | 62.0 steps/s
[Step=17900 Epoch=35.0] | Loss=0.03319 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.727 | L2-Norm(final)=5.674 | 3936.7 samples/s | 61.5 steps/s
[Step=17950 Epoch=35.1] | Loss=0.03279 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.744 | L2-Norm(final)=5.671 | 3973.4 samples/s | 62.1 steps/s
[Step=18000 Epoch=35.2] | Loss=0.03246 | Reg=0.00316 | acc=0.9844 | L2-Norm=17.761 | L2-Norm(final)=5.667 | 3914.5 samples/s | 61.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step18000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=16001 Epoch=61.3] | Loss=0.05991 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.128 | L2-Norm(final)=5.710 | 3251.6 samples/s | 50.8 steps/s
[Step=16050 Epoch=61.5] | Loss=0.00593 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.353 | L2-Norm(final)=5.712 | 3722.8 samples/s | 58.2 steps/s
[Step=16100 Epoch=61.7] | Loss=0.00365 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.435 | L2-Norm(final)=5.740 | 4154.3 samples/s | 64.9 steps/s
[Step=16150 Epoch=61.9] | Loss=0.00291 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.474 | L2-Norm(final)=5.767 | 4065.5 samples/s | 63.5 steps/s
[Step=16200 Epoch=62.1] | Loss=0.00277 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.504 | L2-Norm(final)=5.787 | 4194.3 samples/s | 65.5 steps/s
[Step=16250 Epoch=62.3] | Loss=0.00231 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.525 | L2-Norm(final)=5.804 | 5305.6 samples/s | 82.9 steps/s
[Step=16300 Epoch=62.5] | Loss=0.00199 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.535 | L2-Norm(final)=5.821 | 1520.9 samples/s | 23.8 steps/s
[Step=16350 Epoch=62.6] | Loss=0.00173 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.533 | L2-Norm(final)=5.837 | 4144.5 samples/s | 64.8 steps/s
[Step=16400 Epoch=62.8] | Loss=0.00155 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.523 | L2-Norm(final)=5.852 | 4063.4 samples/s | 63.5 steps/s
[Step=16450 Epoch=63.0] | Loss=0.00145 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.511 | L2-Norm(final)=5.867 | 4193.2 samples/s | 65.5 steps/s
[Step=16500 Epoch=63.2] | Loss=0.00132 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.497 | L2-Norm(final)=5.880 | 4650.3 samples/s | 72.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=16501 Epoch=63.2] | Loss=0.00014 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.338 | L2-Norm(final)=6.012 | 3056.9 samples/s | 47.8 steps/s
[Step=16550 Epoch=63.4] | Loss=0.00010 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.294 | L2-Norm(final)=6.021 | 3636.8 samples/s | 56.8 steps/s
[Step=16600 Epoch=63.6] | Loss=0.00008 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.245 | L2-Norm(final)=6.028 | 3742.1 samples/s | 58.5 steps/s
[Step=16650 Epoch=63.8] | Loss=0.00006 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.200 | L2-Norm(final)=6.034 | 3733.9 samples/s | 58.3 steps/s
[Step=16700 Epoch=64.0] | Loss=0.00006 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.152 | L2-Norm(final)=6.039 | 3719.2 samples/s | 58.1 steps/s
[Step=16750 Epoch=64.2] | Loss=0.00009 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.104 | L2-Norm(final)=6.043 | 4747.0 samples/s | 74.2 steps/s
[Step=16800 Epoch=64.4] | Loss=0.00178 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.087 | L2-Norm(final)=6.044 | 1440.1 samples/s | 22.5 steps/s
[Step=16850 Epoch=64.6] | Loss=0.00531 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.183 | L2-Norm(final)=6.010 | 3689.4 samples/s | 57.6 steps/s
[Step=16900 Epoch=64.8] | Loss=0.00528 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.296 | L2-Norm(final)=5.974 | 3729.2 samples/s | 58.3 steps/s
[Step=16950 Epoch=64.9] | Loss=0.00511 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.386 | L2-Norm(final)=5.948 | 3726.4 samples/s | 58.2 steps/s
[Step=17000 Epoch=65.1] | Loss=0.00481 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.460 | L2-Norm(final)=5.927 | 4171.3 samples/s | 65.2 steps/s
[Step=17050 Epoch=65.3] | Loss=0.00447 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.518 | L2-Norm(final)=5.911 | 1563.3 samples/s | 24.4 steps/s
[Step=17100 Epoch=65.5] | Loss=0.00421 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.565 | L2-Norm(final)=5.898 | 3749.2 samples/s | 58.6 steps/s
[Step=17150 Epoch=65.7] | Loss=0.00404 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.603 | L2-Norm(final)=5.887 | 3753.1 samples/s | 58.6 steps/s
[Step=17200 Epoch=65.9] | Loss=0.00381 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.635 | L2-Norm(final)=5.878 | 3770.1 samples/s | 58.9 steps/s
[Step=17250 Epoch=66.1] | Loss=0.00368 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.660 | L2-Norm(final)=5.870 | 3717.5 samples/s | 58.1 steps/s
[Step=17300 Epoch=66.3] | Loss=0.00353 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.680 | L2-Norm(final)=5.864 | 1593.7 samples/s | 24.9 steps/s
[Step=17350 Epoch=66.5] | Loss=0.00334 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.696 | L2-Norm(final)=5.859 | 3773.0 samples/s | 59.0 steps/s
[Step=17400 Epoch=66.7] | Loss=0.00315 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.706 | L2-Norm(final)=5.854 | 3668.1 samples/s | 57.3 steps/s
[Step=17450 Epoch=66.9] | Loss=0.00299 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.712 | L2-Norm(final)=5.851 | 3748.9 samples/s | 58.6 steps/s
[Step=17500 Epoch=67.1] | Loss=0.00284 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.714 | L2-Norm(final)=5.847 | 3754.9 samples/s | 58.7 steps/s
[Step=17550 Epoch=67.2] | Loss=0.00271 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.714 | L2-Norm(final)=5.845 | 1601.2 samples/s | 25.0 steps/s
[Step=17600 Epoch=67.4] | Loss=0.00258 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.710 | L2-Norm(final)=5.842 | 3734.2 samples/s | 58.3 steps/s
[Step=17650 Epoch=67.6] | Loss=0.00247 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.704 | L2-Norm(final)=5.840 | 3755.2 samples/s | 58.7 steps/s
[Step=17700 Epoch=67.8] | Loss=0.00237 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.695 | L2-Norm(final)=5.838 | 3770.8 samples/s | 58.9 steps/s
[Step=17750 Epoch=68.0] | Loss=0.00227 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.685 | L2-Norm(final)=5.836 | 3701.0 samples/s | 57.8 steps/s
[Step=17800 Epoch=68.2] | Loss=0.00219 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.674 | L2-Norm(final)=5.835 | 5043.2 samples/s | 78.8 steps/s
[Step=17850 Epoch=68.4] | Loss=0.00211 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.661 | L2-Norm(final)=5.833 | 1437.5 samples/s | 22.5 steps/s
[Step=17900 Epoch=68.6] | Loss=0.00203 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.647 | L2-Norm(final)=5.832 | 3787.4 samples/s | 59.2 steps/s
[Step=17950 Epoch=68.8] | Loss=0.00196 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.631 | L2-Norm(final)=5.831 | 3677.3 samples/s | 57.5 steps/s
[Step=18000 Epoch=69.0] | Loss=0.00190 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.615 | L2-Norm(final)=5.830 | 3745.7 samples/s | 58.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step18000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=16001 Epoch=61.6] | Loss=0.03216 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.128 | L2-Norm(final)=5.982 | 3260.0 samples/s | 50.9 steps/s
[Step=16050 Epoch=61.8] | Loss=0.00748 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.354 | L2-Norm(final)=6.008 | 3878.3 samples/s | 60.6 steps/s
[Step=16100 Epoch=62.0] | Loss=0.00495 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.463 | L2-Norm(final)=6.037 | 4074.7 samples/s | 63.7 steps/s
[Step=16150 Epoch=62.2] | Loss=0.00398 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.513 | L2-Norm(final)=6.064 | 4125.9 samples/s | 64.5 steps/s
[Step=16200 Epoch=62.4] | Loss=0.00321 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.544 | L2-Norm(final)=6.089 | 4159.4 samples/s | 65.0 steps/s
[Step=16250 Epoch=62.6] | Loss=0.00309 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.565 | L2-Norm(final)=6.111 | 5241.0 samples/s | 81.9 steps/s
[Step=16300 Epoch=62.7] | Loss=0.00272 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.587 | L2-Norm(final)=6.132 | 1547.9 samples/s | 24.2 steps/s
[Step=16350 Epoch=62.9] | Loss=0.00245 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.601 | L2-Norm(final)=6.154 | 4127.6 samples/s | 64.5 steps/s
[Step=16400 Epoch=63.1] | Loss=0.00217 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.608 | L2-Norm(final)=6.174 | 4094.3 samples/s | 64.0 steps/s
[Step=16450 Epoch=63.3] | Loss=0.00197 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.608 | L2-Norm(final)=6.193 | 4066.4 samples/s | 63.5 steps/s
[Step=16500 Epoch=63.5] | Loss=0.00183 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.605 | L2-Norm(final)=6.211 | 4762.3 samples/s | 74.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=16501 Epoch=63.5] | Loss=0.00014 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.573 | L2-Norm(final)=6.396 | 3224.7 samples/s | 50.4 steps/s
[Step=16550 Epoch=63.7] | Loss=0.00277 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.557 | L2-Norm(final)=6.410 | 3411.1 samples/s | 53.3 steps/s
[Step=16600 Epoch=63.9] | Loss=0.01505 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.811 | L2-Norm(final)=6.344 | 3675.2 samples/s | 57.4 steps/s
[Step=16650 Epoch=64.1] | Loss=0.01249 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.016 | L2-Norm(final)=6.297 | 3726.3 samples/s | 58.2 steps/s
[Step=16700 Epoch=64.3] | Loss=0.01036 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.120 | L2-Norm(final)=6.272 | 3685.4 samples/s | 57.6 steps/s
[Step=16750 Epoch=64.5] | Loss=0.00845 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.176 | L2-Norm(final)=6.261 | 4753.1 samples/s | 74.3 steps/s
[Step=16800 Epoch=64.7] | Loss=0.00710 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.206 | L2-Norm(final)=6.257 | 1482.8 samples/s | 23.2 steps/s
[Step=16850 Epoch=64.9] | Loss=0.00611 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.217 | L2-Norm(final)=6.256 | 3700.9 samples/s | 57.8 steps/s
[Step=16900 Epoch=65.1] | Loss=0.00566 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.221 | L2-Norm(final)=6.256 | 3696.8 samples/s | 57.8 steps/s
[Step=16950 Epoch=65.2] | Loss=0.00515 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.222 | L2-Norm(final)=6.256 | 3695.5 samples/s | 57.7 steps/s
[Step=17000 Epoch=65.4] | Loss=0.00491 | Reg=0.00263 | acc=0.9688 | L2-Norm=16.221 | L2-Norm(final)=6.257 | 4209.5 samples/s | 65.8 steps/s
[Step=17050 Epoch=65.6] | Loss=0.00476 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.224 | L2-Norm(final)=6.257 | 1502.7 samples/s | 23.5 steps/s
[Step=17100 Epoch=65.8] | Loss=0.00450 | Reg=0.00263 | acc=0.9844 | L2-Norm=16.225 | L2-Norm(final)=6.257 | 3736.9 samples/s | 58.4 steps/s
[Step=17150 Epoch=66.0] | Loss=0.00440 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.223 | L2-Norm(final)=6.255 | 3760.1 samples/s | 58.8 steps/s
[Step=17200 Epoch=66.2] | Loss=0.00410 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.219 | L2-Norm(final)=6.253 | 3727.9 samples/s | 58.2 steps/s
[Step=17250 Epoch=66.4] | Loss=0.00383 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.211 | L2-Norm(final)=6.251 | 3793.3 samples/s | 59.3 steps/s
[Step=17300 Epoch=66.6] | Loss=0.00360 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.201 | L2-Norm(final)=6.251 | 1595.5 samples/s | 24.9 steps/s
[Step=17350 Epoch=66.8] | Loss=0.00339 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.188 | L2-Norm(final)=6.250 | 3743.6 samples/s | 58.5 steps/s
[Step=17400 Epoch=67.0] | Loss=0.00320 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.173 | L2-Norm(final)=6.250 | 3713.4 samples/s | 58.0 steps/s
[Step=17450 Epoch=67.2] | Loss=0.00303 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.157 | L2-Norm(final)=6.250 | 3774.7 samples/s | 59.0 steps/s
[Step=17500 Epoch=67.4] | Loss=0.00288 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.139 | L2-Norm(final)=6.250 | 3728.8 samples/s | 58.3 steps/s
[Step=17550 Epoch=67.6] | Loss=0.00274 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.120 | L2-Norm(final)=6.250 | 1594.8 samples/s | 24.9 steps/s
[Step=17600 Epoch=67.7] | Loss=0.00262 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.100 | L2-Norm(final)=6.251 | 3733.1 samples/s | 58.3 steps/s
[Step=17650 Epoch=67.9] | Loss=0.00251 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.079 | L2-Norm(final)=6.251 | 3724.9 samples/s | 58.2 steps/s
[Step=17700 Epoch=68.1] | Loss=0.00240 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.057 | L2-Norm(final)=6.251 | 3720.3 samples/s | 58.1 steps/s
[Step=17750 Epoch=68.3] | Loss=0.00231 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.034 | L2-Norm(final)=6.252 | 3744.9 samples/s | 58.5 steps/s
[Step=17800 Epoch=68.5] | Loss=0.00222 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.011 | L2-Norm(final)=6.252 | 5507.6 samples/s | 86.1 steps/s
[Step=17850 Epoch=68.7] | Loss=0.00214 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.988 | L2-Norm(final)=6.253 | 1420.0 samples/s | 22.2 steps/s
[Step=17900 Epoch=68.9] | Loss=0.00206 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.964 | L2-Norm(final)=6.254 | 3729.4 samples/s | 58.3 steps/s
[Step=17950 Epoch=69.1] | Loss=0.00199 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.939 | L2-Norm(final)=6.254 | 3740.1 samples/s | 58.4 steps/s
[Step=18000 Epoch=69.3] | Loss=0.00192 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.914 | L2-Norm(final)=6.255 | 3709.9 samples/s | 58.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step18000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07241 | acc=0.9625 | tpr=0.9735 | fpr=0.0614 | 3570.0 samples/s | 13.9 steps/s
Avg test loss: 0.07561, Avg test acc: 0.95949, Avg tpr: 0.97185, Avg fpr: 0.06768, total FA: 528

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06453 | acc=0.9582 | tpr=0.9613 | fpr=0.0486 | 3538.2 samples/s | 13.8 steps/s
Avg test loss: 0.06995, Avg test acc: 0.95681, Avg tpr: 0.95879, Avg fpr: 0.04756, total FA: 371

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=7.14663 | acc=0.3130 | tpr=0.0080 | fpr=0.0248 | 3488.8 samples/s | 13.6 steps/s
Avg test loss: 7.16441, Avg test acc: 0.31028, Avg tpr: 0.00793, Avg fpr: 0.02474, total FA: 193

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.42144 | acc=0.3112 | tpr=0.0123 | fpr=0.0399 | 3574.9 samples/s | 14.0 steps/s
Avg test loss: 5.42780, Avg test acc: 0.30776, Avg tpr: 0.01195, Avg fpr: 0.04166, total FA: 325

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.97753 | acc=0.0792 | tpr=0.8850 | fpr=0.9353 | 3566.9 samples/s | 13.9 steps/s
[Step= 100] | Loss=5.94734 | acc=0.0808 | tpr=0.8870 | fpr=0.9342 | 6719.1 samples/s | 26.2 steps/s
[Step= 150] | Loss=5.95554 | acc=0.0805 | tpr=0.8833 | fpr=0.9342 | 6897.2 samples/s | 26.9 steps/s
[Step= 200] | Loss=5.94184 | acc=0.0807 | tpr=0.8765 | fpr=0.9338 | 6761.8 samples/s | 26.4 steps/s
[Step= 250] | Loss=5.93971 | acc=0.0812 | tpr=0.8795 | fpr=0.9334 | 6783.7 samples/s | 26.5 steps/s
[Step= 300] | Loss=5.93950 | acc=0.0812 | tpr=0.8771 | fpr=0.9334 | 6910.0 samples/s | 27.0 steps/s
[Step= 350] | Loss=5.93375 | acc=0.0811 | tpr=0.8785 | fpr=0.9333 | 6915.9 samples/s | 27.0 steps/s
[Step= 400] | Loss=5.93001 | acc=0.0812 | tpr=0.8796 | fpr=0.9333 | 6885.8 samples/s | 26.9 steps/s
[Step= 450] | Loss=5.93696 | acc=0.0811 | tpr=0.8827 | fpr=0.9335 | 6761.4 samples/s | 26.4 steps/s
[Step= 500] | Loss=5.94150 | acc=0.0808 | tpr=0.8802 | fpr=0.9336 | 6659.3 samples/s | 26.0 steps/s
[Step= 550] | Loss=5.94242 | acc=0.0809 | tpr=0.8810 | fpr=0.9337 | 12823.4 samples/s | 50.1 steps/s
Avg test loss: 5.94344, Avg test acc: 0.08085, Avg tpr: 0.88074, Avg fpr: 0.93369, total FA: 129641

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.75735 | acc=0.1037 | tpr=0.8363 | fpr=0.9095 | 3510.0 samples/s | 13.7 steps/s
[Step= 100] | Loss=5.73504 | acc=0.1049 | tpr=0.8294 | fpr=0.9086 | 7042.0 samples/s | 27.5 steps/s
[Step= 150] | Loss=5.75881 | acc=0.1043 | tpr=0.8386 | fpr=0.9092 | 6868.9 samples/s | 26.8 steps/s
[Step= 200] | Loss=5.74572 | acc=0.1043 | tpr=0.8339 | fpr=0.9090 | 6765.7 samples/s | 26.4 steps/s
[Step= 250] | Loss=5.74448 | acc=0.1043 | tpr=0.8288 | fpr=0.9089 | 7083.9 samples/s | 27.7 steps/s
[Step= 300] | Loss=5.74656 | acc=0.1043 | tpr=0.8284 | fpr=0.9089 | 6836.4 samples/s | 26.7 steps/s
[Step= 350] | Loss=5.74719 | acc=0.1045 | tpr=0.8284 | fpr=0.9087 | 6904.2 samples/s | 27.0 steps/s
[Step= 400] | Loss=5.74519 | acc=0.1042 | tpr=0.8304 | fpr=0.9090 | 6856.6 samples/s | 26.8 steps/s
[Step= 450] | Loss=5.75024 | acc=0.1041 | tpr=0.8325 | fpr=0.9091 | 6800.7 samples/s | 26.6 steps/s
[Step= 500] | Loss=5.74816 | acc=0.1038 | tpr=0.8304 | fpr=0.9093 | 6661.9 samples/s | 26.0 steps/s
[Step= 550] | Loss=5.75000 | acc=0.1039 | tpr=0.8325 | fpr=0.9093 | 12751.8 samples/s | 49.8 steps/s
Avg test loss: 5.75197, Avg test acc: 0.10386, Avg tpr: 0.83201, Avg fpr: 0.90938, total FA: 126265

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10297 | acc=0.9824 | tpr=0.9513 | fpr=0.0170 | 3543.8 samples/s | 13.8 steps/s
[Step= 100] | Loss=0.10514 | acc=0.9823 | tpr=0.9595 | fpr=0.0172 | 6563.0 samples/s | 25.6 steps/s
[Step= 150] | Loss=0.10968 | acc=0.9816 | tpr=0.9553 | fpr=0.0180 | 6966.0 samples/s | 27.2 steps/s
[Step= 200] | Loss=0.11210 | acc=0.9812 | tpr=0.9497 | fpr=0.0183 | 6664.6 samples/s | 26.0 steps/s
[Step= 250] | Loss=0.10924 | acc=0.9816 | tpr=0.9493 | fpr=0.0178 | 6777.9 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.11161 | acc=0.9812 | tpr=0.9462 | fpr=0.0181 | 6852.8 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.11112 | acc=0.9809 | tpr=0.9461 | fpr=0.0184 | 6651.6 samples/s | 26.0 steps/s
[Step= 400] | Loss=0.11319 | acc=0.9806 | tpr=0.9393 | fpr=0.0187 | 6860.5 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.11502 | acc=0.9802 | tpr=0.9387 | fpr=0.0191 | 6733.9 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.11408 | acc=0.9804 | tpr=0.9410 | fpr=0.0189 | 6640.3 samples/s | 25.9 steps/s
[Step= 550] | Loss=0.11347 | acc=0.9805 | tpr=0.9379 | fpr=0.0187 | 12672.6 samples/s | 49.5 steps/s
Avg test loss: 0.11325, Avg test acc: 0.98051, Avg tpr: 0.93700, Avg fpr: 0.01870, total FA: 2596

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.08460 | acc=0.9850 | tpr=0.9425 | fpr=0.0142 | 3463.4 samples/s | 13.5 steps/s
[Step= 100] | Loss=0.09065 | acc=0.9838 | tpr=0.9467 | fpr=0.0156 | 6834.8 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.09417 | acc=0.9831 | tpr=0.9539 | fpr=0.0164 | 6900.6 samples/s | 27.0 steps/s
[Step= 200] | Loss=0.09622 | acc=0.9833 | tpr=0.9552 | fpr=0.0162 | 6964.6 samples/s | 27.2 steps/s
[Step= 250] | Loss=0.09559 | acc=0.9834 | tpr=0.9537 | fpr=0.0161 | 6660.0 samples/s | 26.0 steps/s
[Step= 300] | Loss=0.09737 | acc=0.9832 | tpr=0.9513 | fpr=0.0162 | 6781.7 samples/s | 26.5 steps/s
[Step= 350] | Loss=0.09758 | acc=0.9830 | tpr=0.9505 | fpr=0.0164 | 6895.9 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.09859 | acc=0.9828 | tpr=0.9453 | fpr=0.0165 | 6661.2 samples/s | 26.0 steps/s
[Step= 450] | Loss=0.09959 | acc=0.9827 | tpr=0.9445 | fpr=0.0166 | 6801.9 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.09929 | acc=0.9827 | tpr=0.9445 | fpr=0.0166 | 6677.8 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.09888 | acc=0.9828 | tpr=0.9447 | fpr=0.0165 | 12423.8 samples/s | 48.5 steps/s
Avg test loss: 0.09871, Avg test acc: 0.98280, Avg tpr: 0.94414, Avg fpr: 0.01649, total FA: 2290

server round 9/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=18001 Epoch=35.1] | Loss=0.07539 | Reg=0.00232 | acc=0.9688 | L2-Norm=15.236 | L2-Norm(final)=5.305 | 3024.2 samples/s | 47.3 steps/s
[Step=18050 Epoch=35.2] | Loss=0.06073 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.357 | L2-Norm(final)=5.358 | 4528.8 samples/s | 70.8 steps/s
[Step=18100 Epoch=35.3] | Loss=0.06003 | Reg=0.00240 | acc=0.9375 | L2-Norm=15.489 | L2-Norm(final)=5.396 | 4316.8 samples/s | 67.5 steps/s
[Step=18150 Epoch=35.4] | Loss=0.05964 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.606 | L2-Norm(final)=5.432 | 4384.3 samples/s | 68.5 steps/s
[Step=18200 Epoch=35.5] | Loss=0.05807 | Reg=0.00247 | acc=0.9062 | L2-Norm=15.706 | L2-Norm(final)=5.459 | 4318.3 samples/s | 67.5 steps/s
[Step=18250 Epoch=35.6] | Loss=0.05699 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.797 | L2-Norm(final)=5.486 | 4406.1 samples/s | 68.8 steps/s
[Step=18300 Epoch=35.7] | Loss=0.05739 | Reg=0.00252 | acc=0.9375 | L2-Norm=15.883 | L2-Norm(final)=5.515 | 4499.3 samples/s | 70.3 steps/s
[Step=18350 Epoch=35.8] | Loss=0.05657 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.969 | L2-Norm(final)=5.544 | 4365.4 samples/s | 68.2 steps/s
[Step=18400 Epoch=35.9] | Loss=0.05610 | Reg=0.00258 | acc=0.9688 | L2-Norm=16.050 | L2-Norm(final)=5.571 | 4345.4 samples/s | 67.9 steps/s
[Step=18450 Epoch=36.0] | Loss=0.05549 | Reg=0.00260 | acc=0.9688 | L2-Norm=16.126 | L2-Norm(final)=5.596 | 4389.1 samples/s | 68.6 steps/s
[Step=18500 Epoch=36.1] | Loss=0.05488 | Reg=0.00263 | acc=0.9375 | L2-Norm=16.197 | L2-Norm(final)=5.621 | 5488.9 samples/s | 85.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=18501 Epoch=36.1] | Loss=0.05274 | Reg=0.00285 | acc=0.9531 | L2-Norm=16.896 | L2-Norm(final)=5.875 | 3205.1 samples/s | 50.1 steps/s
[Step=18550 Epoch=36.2] | Loss=0.04474 | Reg=0.00287 | acc=0.9688 | L2-Norm=16.954 | L2-Norm(final)=5.886 | 3808.8 samples/s | 59.5 steps/s
[Step=18600 Epoch=36.3] | Loss=0.04999 | Reg=0.00290 | acc=0.9688 | L2-Norm=17.020 | L2-Norm(final)=5.857 | 3912.7 samples/s | 61.1 steps/s
[Step=18650 Epoch=36.4] | Loss=0.05081 | Reg=0.00292 | acc=0.9531 | L2-Norm=17.086 | L2-Norm(final)=5.831 | 3940.2 samples/s | 61.6 steps/s
[Step=18700 Epoch=36.5] | Loss=0.04847 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.140 | L2-Norm(final)=5.816 | 3974.5 samples/s | 62.1 steps/s
[Step=18750 Epoch=36.6] | Loss=0.04698 | Reg=0.00296 | acc=0.9844 | L2-Norm=17.190 | L2-Norm(final)=5.805 | 3916.4 samples/s | 61.2 steps/s
[Step=18800 Epoch=36.7] | Loss=0.04661 | Reg=0.00297 | acc=0.9688 | L2-Norm=17.234 | L2-Norm(final)=5.794 | 3941.9 samples/s | 61.6 steps/s
[Step=18850 Epoch=36.8] | Loss=0.04544 | Reg=0.00298 | acc=0.9844 | L2-Norm=17.275 | L2-Norm(final)=5.784 | 3956.7 samples/s | 61.8 steps/s
[Step=18900 Epoch=36.9] | Loss=0.04421 | Reg=0.00300 | acc=0.9688 | L2-Norm=17.312 | L2-Norm(final)=5.778 | 3950.5 samples/s | 61.7 steps/s
[Step=18950 Epoch=37.0] | Loss=0.04307 | Reg=0.00301 | acc=0.9844 | L2-Norm=17.346 | L2-Norm(final)=5.771 | 3930.7 samples/s | 61.4 steps/s
[Step=19000 Epoch=37.1] | Loss=0.04275 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.376 | L2-Norm(final)=5.764 | 4780.6 samples/s | 74.7 steps/s
[Step=19050 Epoch=37.2] | Loss=0.04171 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.404 | L2-Norm(final)=5.758 | 1483.4 samples/s | 23.2 steps/s
[Step=19100 Epoch=37.3] | Loss=0.04059 | Reg=0.00304 | acc=0.9531 | L2-Norm=17.429 | L2-Norm(final)=5.752 | 3922.5 samples/s | 61.3 steps/s
[Step=19150 Epoch=37.3] | Loss=0.03917 | Reg=0.00305 | acc=0.9844 | L2-Norm=17.450 | L2-Norm(final)=5.748 | 3869.5 samples/s | 60.5 steps/s
[Step=19200 Epoch=37.4] | Loss=0.03817 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.470 | L2-Norm(final)=5.744 | 3942.5 samples/s | 61.6 steps/s
[Step=19250 Epoch=37.5] | Loss=0.03728 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.489 | L2-Norm(final)=5.740 | 3953.6 samples/s | 61.8 steps/s
[Step=19300 Epoch=37.6] | Loss=0.03678 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.508 | L2-Norm(final)=5.736 | 3943.8 samples/s | 61.6 steps/s
[Step=19350 Epoch=37.7] | Loss=0.03628 | Reg=0.00307 | acc=0.9844 | L2-Norm=17.527 | L2-Norm(final)=5.732 | 3932.7 samples/s | 61.4 steps/s
[Step=19400 Epoch=37.8] | Loss=0.03559 | Reg=0.00308 | acc=0.9688 | L2-Norm=17.547 | L2-Norm(final)=5.729 | 3933.2 samples/s | 61.5 steps/s
[Step=19450 Epoch=37.9] | Loss=0.03519 | Reg=0.00309 | acc=0.9688 | L2-Norm=17.565 | L2-Norm(final)=5.726 | 3918.7 samples/s | 61.2 steps/s
[Step=19500 Epoch=38.0] | Loss=0.03446 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.583 | L2-Norm(final)=5.724 | 4177.5 samples/s | 65.3 steps/s
[Step=19550 Epoch=38.1] | Loss=0.03391 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.601 | L2-Norm(final)=5.722 | 1595.3 samples/s | 24.9 steps/s
[Step=19600 Epoch=38.2] | Loss=0.03320 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.619 | L2-Norm(final)=5.720 | 3882.2 samples/s | 60.7 steps/s
[Step=19650 Epoch=38.3] | Loss=0.03277 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.636 | L2-Norm(final)=5.718 | 3954.6 samples/s | 61.8 steps/s
[Step=19700 Epoch=38.4] | Loss=0.03217 | Reg=0.00312 | acc=0.9844 | L2-Norm=17.653 | L2-Norm(final)=5.717 | 3885.0 samples/s | 60.7 steps/s
[Step=19750 Epoch=38.5] | Loss=0.03165 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.670 | L2-Norm(final)=5.715 | 3915.1 samples/s | 61.2 steps/s
[Step=19800 Epoch=38.6] | Loss=0.03131 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.686 | L2-Norm(final)=5.714 | 3940.7 samples/s | 61.6 steps/s
[Step=19850 Epoch=38.7] | Loss=0.03093 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.702 | L2-Norm(final)=5.712 | 3930.4 samples/s | 61.4 steps/s
[Step=19900 Epoch=38.8] | Loss=0.03085 | Reg=0.00314 | acc=0.9531 | L2-Norm=17.717 | L2-Norm(final)=5.710 | 3936.8 samples/s | 61.5 steps/s
[Step=19950 Epoch=38.9] | Loss=0.03083 | Reg=0.00315 | acc=0.9531 | L2-Norm=17.732 | L2-Norm(final)=5.707 | 3983.0 samples/s | 62.2 steps/s
[Step=20000 Epoch=39.0] | Loss=0.03061 | Reg=0.00315 | acc=0.9688 | L2-Norm=17.748 | L2-Norm(final)=5.704 | 3968.6 samples/s | 62.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step20000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=18001 Epoch=35.2] | Loss=0.06561 | Reg=0.00232 | acc=0.9688 | L2-Norm=15.236 | L2-Norm(final)=5.559 | 3162.7 samples/s | 49.4 steps/s
[Step=18050 Epoch=35.3] | Loss=0.06576 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.371 | L2-Norm(final)=5.606 | 4397.2 samples/s | 68.7 steps/s
[Step=18100 Epoch=35.4] | Loss=0.06230 | Reg=0.00240 | acc=0.8906 | L2-Norm=15.501 | L2-Norm(final)=5.653 | 4365.7 samples/s | 68.2 steps/s
[Step=18150 Epoch=35.5] | Loss=0.06089 | Reg=0.00244 | acc=0.9375 | L2-Norm=15.608 | L2-Norm(final)=5.690 | 4377.5 samples/s | 68.4 steps/s
[Step=18200 Epoch=35.6] | Loss=0.06020 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.702 | L2-Norm(final)=5.721 | 4395.5 samples/s | 68.7 steps/s
[Step=18250 Epoch=35.7] | Loss=0.05935 | Reg=0.00249 | acc=0.9688 | L2-Norm=15.790 | L2-Norm(final)=5.748 | 4363.2 samples/s | 68.2 steps/s
[Step=18300 Epoch=35.8] | Loss=0.05955 | Reg=0.00252 | acc=0.9375 | L2-Norm=15.875 | L2-Norm(final)=5.774 | 4374.1 samples/s | 68.3 steps/s
[Step=18350 Epoch=35.9] | Loss=0.05896 | Reg=0.00255 | acc=0.9688 | L2-Norm=15.956 | L2-Norm(final)=5.800 | 4381.1 samples/s | 68.5 steps/s
[Step=18400 Epoch=36.0] | Loss=0.05809 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.035 | L2-Norm(final)=5.827 | 4357.6 samples/s | 68.1 steps/s
[Step=18450 Epoch=36.1] | Loss=0.05734 | Reg=0.00260 | acc=0.9531 | L2-Norm=16.111 | L2-Norm(final)=5.856 | 4332.8 samples/s | 67.7 steps/s
[Step=18500 Epoch=36.2] | Loss=0.05687 | Reg=0.00262 | acc=0.9531 | L2-Norm=16.184 | L2-Norm(final)=5.883 | 5648.0 samples/s | 88.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=18501 Epoch=36.2] | Loss=0.04458 | Reg=0.00286 | acc=0.9844 | L2-Norm=16.900 | L2-Norm(final)=6.152 | 3429.7 samples/s | 53.6 steps/s
[Step=18550 Epoch=36.3] | Loss=0.04921 | Reg=0.00288 | acc=0.9375 | L2-Norm=16.963 | L2-Norm(final)=6.162 | 3546.8 samples/s | 55.4 steps/s
[Step=18600 Epoch=36.4] | Loss=0.04992 | Reg=0.00291 | acc=0.9375 | L2-Norm=17.049 | L2-Norm(final)=6.137 | 3889.0 samples/s | 60.8 steps/s
[Step=18650 Epoch=36.5] | Loss=0.04700 | Reg=0.00293 | acc=0.9375 | L2-Norm=17.122 | L2-Norm(final)=6.121 | 3896.7 samples/s | 60.9 steps/s
[Step=18700 Epoch=36.6] | Loss=0.04587 | Reg=0.00295 | acc=0.9531 | L2-Norm=17.186 | L2-Norm(final)=6.109 | 3888.7 samples/s | 60.8 steps/s
[Step=18750 Epoch=36.7] | Loss=0.04581 | Reg=0.00297 | acc=0.9844 | L2-Norm=17.240 | L2-Norm(final)=6.097 | 3938.2 samples/s | 61.5 steps/s
[Step=18800 Epoch=36.8] | Loss=0.04428 | Reg=0.00299 | acc=0.9375 | L2-Norm=17.287 | L2-Norm(final)=6.090 | 3934.3 samples/s | 61.5 steps/s
[Step=18850 Epoch=36.9] | Loss=0.04380 | Reg=0.00300 | acc=0.9375 | L2-Norm=17.328 | L2-Norm(final)=6.081 | 3960.1 samples/s | 61.9 steps/s
[Step=18900 Epoch=36.9] | Loss=0.04278 | Reg=0.00302 | acc=0.9688 | L2-Norm=17.365 | L2-Norm(final)=6.074 | 3874.3 samples/s | 60.5 steps/s
[Step=18950 Epoch=37.0] | Loss=0.04204 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.399 | L2-Norm(final)=6.067 | 3957.2 samples/s | 61.8 steps/s
[Step=19000 Epoch=37.1] | Loss=0.04138 | Reg=0.00304 | acc=0.9844 | L2-Norm=17.430 | L2-Norm(final)=6.062 | 4861.6 samples/s | 76.0 steps/s
[Step=19050 Epoch=37.2] | Loss=0.04043 | Reg=0.00305 | acc=0.9844 | L2-Norm=17.459 | L2-Norm(final)=6.056 | 1520.7 samples/s | 23.8 steps/s
[Step=19100 Epoch=37.3] | Loss=0.03918 | Reg=0.00306 | acc=0.9531 | L2-Norm=17.487 | L2-Norm(final)=6.051 | 3888.6 samples/s | 60.8 steps/s
[Step=19150 Epoch=37.4] | Loss=0.03808 | Reg=0.00307 | acc=0.9844 | L2-Norm=17.514 | L2-Norm(final)=6.047 | 3926.4 samples/s | 61.3 steps/s
[Step=19200 Epoch=37.5] | Loss=0.03718 | Reg=0.00308 | acc=0.9844 | L2-Norm=17.537 | L2-Norm(final)=6.044 | 3843.6 samples/s | 60.1 steps/s
[Step=19250 Epoch=37.6] | Loss=0.03649 | Reg=0.00308 | acc=0.9688 | L2-Norm=17.561 | L2-Norm(final)=6.041 | 3902.1 samples/s | 61.0 steps/s
[Step=19300 Epoch=37.7] | Loss=0.03601 | Reg=0.00309 | acc=0.9844 | L2-Norm=17.584 | L2-Norm(final)=6.037 | 3917.2 samples/s | 61.2 steps/s
[Step=19350 Epoch=37.8] | Loss=0.03541 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.607 | L2-Norm(final)=6.033 | 3927.4 samples/s | 61.4 steps/s
[Step=19400 Epoch=37.9] | Loss=0.03472 | Reg=0.00311 | acc=0.9688 | L2-Norm=17.628 | L2-Norm(final)=6.030 | 3941.0 samples/s | 61.6 steps/s
[Step=19450 Epoch=38.0] | Loss=0.03429 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.649 | L2-Norm(final)=6.027 | 3908.0 samples/s | 61.1 steps/s
[Step=19500 Epoch=38.1] | Loss=0.03369 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.670 | L2-Norm(final)=6.025 | 4275.6 samples/s | 66.8 steps/s
[Step=19550 Epoch=38.2] | Loss=0.03328 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.690 | L2-Norm(final)=6.023 | 1632.2 samples/s | 25.5 steps/s
[Step=19600 Epoch=38.3] | Loss=0.03255 | Reg=0.00314 | acc=0.9688 | L2-Norm=17.710 | L2-Norm(final)=6.021 | 3948.2 samples/s | 61.7 steps/s
[Step=19650 Epoch=38.4] | Loss=0.03208 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.728 | L2-Norm(final)=6.019 | 3952.9 samples/s | 61.8 steps/s
[Step=19700 Epoch=38.5] | Loss=0.03178 | Reg=0.00315 | acc=0.9375 | L2-Norm=17.747 | L2-Norm(final)=6.018 | 3903.1 samples/s | 61.0 steps/s
[Step=19750 Epoch=38.6] | Loss=0.03145 | Reg=0.00316 | acc=0.9844 | L2-Norm=17.766 | L2-Norm(final)=6.017 | 3910.8 samples/s | 61.1 steps/s
[Step=19800 Epoch=38.7] | Loss=0.03113 | Reg=0.00316 | acc=0.9844 | L2-Norm=17.784 | L2-Norm(final)=6.015 | 3919.1 samples/s | 61.2 steps/s
[Step=19850 Epoch=38.8] | Loss=0.03054 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.803 | L2-Norm(final)=6.014 | 3960.2 samples/s | 61.9 steps/s
[Step=19900 Epoch=38.9] | Loss=0.03052 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.822 | L2-Norm(final)=6.013 | 3948.4 samples/s | 61.7 steps/s
[Step=19950 Epoch=39.0] | Loss=0.03038 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.841 | L2-Norm(final)=6.012 | 3954.1 samples/s | 61.8 steps/s
[Step=20000 Epoch=39.1] | Loss=0.02999 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.860 | L2-Norm(final)=6.010 | 3960.3 samples/s | 61.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step20000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=18001 Epoch=69.0] | Loss=0.00478 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.236 | L2-Norm(final)=5.801 | 3220.0 samples/s | 50.3 steps/s
[Step=18050 Epoch=69.2] | Loss=0.00440 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.318 | L2-Norm(final)=5.821 | 3853.0 samples/s | 60.2 steps/s
[Step=18100 Epoch=69.4] | Loss=0.00275 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.373 | L2-Norm(final)=5.851 | 4149.1 samples/s | 64.8 steps/s
[Step=18150 Epoch=69.5] | Loss=0.00242 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.392 | L2-Norm(final)=5.883 | 4073.6 samples/s | 63.7 steps/s
[Step=18200 Epoch=69.7] | Loss=0.00202 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.406 | L2-Norm(final)=5.910 | 4186.8 samples/s | 65.4 steps/s
[Step=18250 Epoch=69.9] | Loss=0.00180 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.411 | L2-Norm(final)=5.933 | 5364.4 samples/s | 83.8 steps/s
[Step=18300 Epoch=70.1] | Loss=0.00158 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.421 | L2-Norm(final)=5.954 | 1502.3 samples/s | 23.5 steps/s
[Step=18350 Epoch=70.3] | Loss=0.00138 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.420 | L2-Norm(final)=5.975 | 4148.4 samples/s | 64.8 steps/s
[Step=18400 Epoch=70.5] | Loss=0.00123 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.412 | L2-Norm(final)=5.992 | 4144.4 samples/s | 64.8 steps/s
[Step=18450 Epoch=70.7] | Loss=0.00110 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.399 | L2-Norm(final)=6.008 | 4125.9 samples/s | 64.5 steps/s
[Step=18500 Epoch=70.9] | Loss=0.00100 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.383 | L2-Norm(final)=6.022 | 4622.7 samples/s | 72.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=18501 Epoch=70.9] | Loss=0.00005 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.206 | L2-Norm(final)=6.161 | 3297.8 samples/s | 51.5 steps/s
[Step=18550 Epoch=71.1] | Loss=0.00008 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.169 | L2-Norm(final)=6.169 | 3405.7 samples/s | 53.2 steps/s
[Step=18600 Epoch=71.3] | Loss=0.00006 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.126 | L2-Norm(final)=6.176 | 3682.1 samples/s | 57.5 steps/s
[Step=18650 Epoch=71.5] | Loss=0.00441 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.141 | L2-Norm(final)=6.173 | 3741.2 samples/s | 58.5 steps/s
[Step=18700 Epoch=71.7] | Loss=0.00805 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.270 | L2-Norm(final)=6.120 | 3755.3 samples/s | 58.7 steps/s
[Step=18750 Epoch=71.8] | Loss=0.00758 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.397 | L2-Norm(final)=6.074 | 4719.4 samples/s | 73.7 steps/s
[Step=18800 Epoch=72.0] | Loss=0.00694 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.489 | L2-Norm(final)=6.041 | 1456.8 samples/s | 22.8 steps/s
[Step=18850 Epoch=72.2] | Loss=0.00606 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.552 | L2-Norm(final)=6.018 | 3684.2 samples/s | 57.6 steps/s
[Step=18900 Epoch=72.4] | Loss=0.00590 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.598 | L2-Norm(final)=6.002 | 3728.0 samples/s | 58.3 steps/s
[Step=18950 Epoch=72.6] | Loss=0.00593 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.650 | L2-Norm(final)=5.987 | 3789.2 samples/s | 59.2 steps/s
[Step=19000 Epoch=72.8] | Loss=0.00562 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.700 | L2-Norm(final)=5.974 | 4189.6 samples/s | 65.5 steps/s
[Step=19050 Epoch=73.0] | Loss=0.00515 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.740 | L2-Norm(final)=5.963 | 1535.6 samples/s | 24.0 steps/s
[Step=19100 Epoch=73.2] | Loss=0.00473 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.768 | L2-Norm(final)=5.955 | 3780.1 samples/s | 59.1 steps/s
[Step=19150 Epoch=73.4] | Loss=0.00437 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.788 | L2-Norm(final)=5.948 | 3720.7 samples/s | 58.1 steps/s
[Step=19200 Epoch=73.6] | Loss=0.00406 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.800 | L2-Norm(final)=5.943 | 3681.4 samples/s | 57.5 steps/s
[Step=19250 Epoch=73.8] | Loss=0.00380 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.806 | L2-Norm(final)=5.939 | 3760.2 samples/s | 58.8 steps/s
[Step=19300 Epoch=74.0] | Loss=0.00356 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.808 | L2-Norm(final)=5.935 | 1600.9 samples/s | 25.0 steps/s
[Step=19350 Epoch=74.1] | Loss=0.00335 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.806 | L2-Norm(final)=5.932 | 3804.2 samples/s | 59.4 steps/s
[Step=19400 Epoch=74.3] | Loss=0.00317 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.801 | L2-Norm(final)=5.930 | 3703.5 samples/s | 57.9 steps/s
[Step=19450 Epoch=74.5] | Loss=0.00300 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.794 | L2-Norm(final)=5.928 | 3730.3 samples/s | 58.3 steps/s
[Step=19500 Epoch=74.7] | Loss=0.00285 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.784 | L2-Norm(final)=5.926 | 3808.7 samples/s | 59.5 steps/s
[Step=19550 Epoch=74.9] | Loss=0.00272 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.773 | L2-Norm(final)=5.924 | 1540.2 samples/s | 24.1 steps/s
[Step=19600 Epoch=75.1] | Loss=0.00259 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.760 | L2-Norm(final)=5.923 | 3671.5 samples/s | 57.4 steps/s
[Step=19650 Epoch=75.3] | Loss=0.00248 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.745 | L2-Norm(final)=5.922 | 3759.7 samples/s | 58.7 steps/s
[Step=19700 Epoch=75.5] | Loss=0.00238 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.730 | L2-Norm(final)=5.921 | 3758.7 samples/s | 58.7 steps/s
[Step=19750 Epoch=75.7] | Loss=0.00228 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.713 | L2-Norm(final)=5.920 | 3702.5 samples/s | 57.9 steps/s
[Step=19800 Epoch=75.9] | Loss=0.00220 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.696 | L2-Norm(final)=5.919 | 5084.8 samples/s | 79.4 steps/s
[Step=19850 Epoch=76.1] | Loss=0.00212 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.677 | L2-Norm(final)=5.918 | 1465.0 samples/s | 22.9 steps/s
[Step=19900 Epoch=76.2] | Loss=0.00204 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.658 | L2-Norm(final)=5.918 | 3698.5 samples/s | 57.8 steps/s
[Step=19950 Epoch=76.4] | Loss=0.00197 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.639 | L2-Norm(final)=5.918 | 3732.6 samples/s | 58.3 steps/s
[Step=20000 Epoch=76.6] | Loss=0.00190 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.619 | L2-Norm(final)=5.917 | 3748.2 samples/s | 58.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step20000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=18001 Epoch=69.3] | Loss=0.00096 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.236 | L2-Norm(final)=6.280 | 3059.2 samples/s | 47.8 steps/s
[Step=18050 Epoch=69.5] | Loss=0.00627 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.392 | L2-Norm(final)=6.290 | 4194.3 samples/s | 65.5 steps/s
[Step=18100 Epoch=69.7] | Loss=0.00451 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.471 | L2-Norm(final)=6.313 | 4184.0 samples/s | 65.4 steps/s
[Step=18150 Epoch=69.9] | Loss=0.00357 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.499 | L2-Norm(final)=6.336 | 4141.6 samples/s | 64.7 steps/s
[Step=18200 Epoch=70.1] | Loss=0.00375 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.515 | L2-Norm(final)=6.359 | 4101.0 samples/s | 64.1 steps/s
[Step=18250 Epoch=70.3] | Loss=0.00320 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.534 | L2-Norm(final)=6.378 | 5528.7 samples/s | 86.4 steps/s
[Step=18300 Epoch=70.4] | Loss=0.00318 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.546 | L2-Norm(final)=6.396 | 1529.9 samples/s | 23.9 steps/s
[Step=18350 Epoch=70.6] | Loss=0.00283 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.554 | L2-Norm(final)=6.413 | 4128.0 samples/s | 64.5 steps/s
[Step=18400 Epoch=70.8] | Loss=0.00253 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.556 | L2-Norm(final)=6.431 | 4155.2 samples/s | 64.9 steps/s
[Step=18450 Epoch=71.0] | Loss=0.00230 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.554 | L2-Norm(final)=6.450 | 4125.7 samples/s | 64.5 steps/s
[Step=18500 Epoch=71.2] | Loss=0.00210 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.549 | L2-Norm(final)=6.469 | 4788.1 samples/s | 74.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=18501 Epoch=71.2] | Loss=0.00025 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.481 | L2-Norm(final)=6.651 | 3172.3 samples/s | 49.6 steps/s
[Step=18550 Epoch=71.4] | Loss=0.00021 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.449 | L2-Norm(final)=6.661 | 3480.2 samples/s | 54.4 steps/s
[Step=18600 Epoch=71.6] | Loss=0.00457 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.463 | L2-Norm(final)=6.666 | 3713.1 samples/s | 58.0 steps/s
[Step=18650 Epoch=71.8] | Loss=0.00652 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.659 | L2-Norm(final)=6.635 | 3724.4 samples/s | 58.2 steps/s
[Step=18700 Epoch=72.0] | Loss=0.00837 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.827 | L2-Norm(final)=6.605 | 3719.7 samples/s | 58.1 steps/s
[Step=18750 Epoch=72.2] | Loss=0.00742 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.954 | L2-Norm(final)=6.585 | 4708.7 samples/s | 73.6 steps/s
[Step=18800 Epoch=72.4] | Loss=0.00638 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.040 | L2-Norm(final)=6.576 | 1444.8 samples/s | 22.6 steps/s
[Step=18850 Epoch=72.6] | Loss=0.00566 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.094 | L2-Norm(final)=6.572 | 3699.2 samples/s | 57.8 steps/s
[Step=18900 Epoch=72.8] | Loss=0.00513 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.130 | L2-Norm(final)=6.569 | 3695.9 samples/s | 57.7 steps/s
[Step=18950 Epoch=72.9] | Loss=0.00466 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.153 | L2-Norm(final)=6.565 | 3736.5 samples/s | 58.4 steps/s
[Step=19000 Epoch=73.1] | Loss=0.00440 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.168 | L2-Norm(final)=6.563 | 4190.2 samples/s | 65.5 steps/s
[Step=19050 Epoch=73.3] | Loss=0.00414 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.176 | L2-Norm(final)=6.561 | 1486.4 samples/s | 23.2 steps/s
[Step=19100 Epoch=73.5] | Loss=0.00387 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.182 | L2-Norm(final)=6.559 | 3759.1 samples/s | 58.7 steps/s
[Step=19150 Epoch=73.7] | Loss=0.00359 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.183 | L2-Norm(final)=6.558 | 3667.5 samples/s | 57.3 steps/s
[Step=19200 Epoch=73.9] | Loss=0.00335 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.180 | L2-Norm(final)=6.558 | 3678.9 samples/s | 57.5 steps/s
[Step=19250 Epoch=74.1] | Loss=0.00313 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.173 | L2-Norm(final)=6.559 | 3767.7 samples/s | 58.9 steps/s
[Step=19300 Epoch=74.3] | Loss=0.00294 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.164 | L2-Norm(final)=6.559 | 1550.0 samples/s | 24.2 steps/s
[Step=19350 Epoch=74.5] | Loss=0.00276 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.151 | L2-Norm(final)=6.560 | 3717.0 samples/s | 58.1 steps/s
[Step=19400 Epoch=74.7] | Loss=0.00261 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.137 | L2-Norm(final)=6.561 | 3720.9 samples/s | 58.1 steps/s
[Step=19450 Epoch=74.9] | Loss=0.00247 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.121 | L2-Norm(final)=6.562 | 3764.0 samples/s | 58.8 steps/s
[Step=19500 Epoch=75.1] | Loss=0.00235 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.104 | L2-Norm(final)=6.562 | 3688.9 samples/s | 57.6 steps/s
[Step=19550 Epoch=75.3] | Loss=0.00224 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.085 | L2-Norm(final)=6.563 | 1545.7 samples/s | 24.2 steps/s
[Step=19600 Epoch=75.4] | Loss=0.00214 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.065 | L2-Norm(final)=6.564 | 3719.7 samples/s | 58.1 steps/s
[Step=19650 Epoch=75.6] | Loss=0.00205 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.044 | L2-Norm(final)=6.565 | 3734.3 samples/s | 58.3 steps/s
[Step=19700 Epoch=75.8] | Loss=0.00196 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.023 | L2-Norm(final)=6.565 | 3738.0 samples/s | 58.4 steps/s
[Step=19750 Epoch=76.0] | Loss=0.00188 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.000 | L2-Norm(final)=6.566 | 3691.6 samples/s | 57.7 steps/s
[Step=19800 Epoch=76.2] | Loss=0.00181 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.977 | L2-Norm(final)=6.567 | 5624.4 samples/s | 87.9 steps/s
[Step=19850 Epoch=76.4] | Loss=0.00174 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.954 | L2-Norm(final)=6.568 | 1371.9 samples/s | 21.4 steps/s
[Step=19900 Epoch=76.6] | Loss=0.00168 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.930 | L2-Norm(final)=6.569 | 3775.6 samples/s | 59.0 steps/s
[Step=19950 Epoch=76.8] | Loss=0.00162 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.905 | L2-Norm(final)=6.570 | 3717.8 samples/s | 58.1 steps/s
[Step=20000 Epoch=77.0] | Loss=0.00157 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.880 | L2-Norm(final)=6.570 | 3721.0 samples/s | 58.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06721 | acc=0.9622 | tpr=0.9704 | fpr=0.0557 | 3501.5 samples/s | 13.7 steps/s
Avg test loss: 0.07184, Avg test acc: 0.95981, Avg tpr: 0.96730, Avg fpr: 0.05666, total FA: 442

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07176 | acc=0.9637 | tpr=0.9741 | fpr=0.0590 | 3575.5 samples/s | 14.0 steps/s
Avg test loss: 0.07806, Avg test acc: 0.96081, Avg tpr: 0.97115, Avg fpr: 0.06192, total FA: 483

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.56272 | acc=0.3125 | tpr=0.0213 | fpr=0.0553 | 3496.2 samples/s | 13.7 steps/s
Avg test loss: 5.57318, Avg test acc: 0.31064, Avg tpr: 0.02081, Avg fpr: 0.05192, total FA: 405

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.27089 | acc=0.3123 | tpr=0.0189 | fpr=0.0508 | 3500.4 samples/s | 13.7 steps/s
Avg test loss: 5.29241, Avg test acc: 0.30932, Avg tpr: 0.01859, Avg fpr: 0.05128, total FA: 400

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.04453 | acc=0.1148 | tpr=0.7434 | fpr=0.8965 | 3507.1 samples/s | 13.7 steps/s
[Step= 100] | Loss=5.01593 | acc=0.1162 | tpr=0.7505 | fpr=0.8956 | 6913.5 samples/s | 27.0 steps/s
[Step= 150] | Loss=5.02822 | acc=0.1145 | tpr=0.7464 | fpr=0.8971 | 6954.7 samples/s | 27.2 steps/s
[Step= 200] | Loss=5.00892 | acc=0.1156 | tpr=0.7355 | fpr=0.8957 | 7018.8 samples/s | 27.4 steps/s
[Step= 250] | Loss=5.00869 | acc=0.1161 | tpr=0.7380 | fpr=0.8953 | 6722.9 samples/s | 26.3 steps/s
[Step= 300] | Loss=5.00505 | acc=0.1159 | tpr=0.7382 | fpr=0.8954 | 7057.5 samples/s | 27.6 steps/s
[Step= 350] | Loss=5.00047 | acc=0.1161 | tpr=0.7370 | fpr=0.8951 | 6738.9 samples/s | 26.3 steps/s
[Step= 400] | Loss=5.00214 | acc=0.1165 | tpr=0.7336 | fpr=0.8947 | 6822.0 samples/s | 26.6 steps/s
[Step= 450] | Loss=5.00813 | acc=0.1162 | tpr=0.7342 | fpr=0.8950 | 6911.3 samples/s | 27.0 steps/s
[Step= 500] | Loss=5.01257 | acc=0.1161 | tpr=0.7322 | fpr=0.8950 | 6636.6 samples/s | 25.9 steps/s
[Step= 550] | Loss=5.01365 | acc=0.1161 | tpr=0.7326 | fpr=0.8951 | 12713.8 samples/s | 49.7 steps/s
Avg test loss: 5.01498, Avg test acc: 0.11609, Avg tpr: 0.73257, Avg fpr: 0.89512, total FA: 124285

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.03479 | acc=0.0927 | tpr=0.7611 | fpr=0.9194 | 3506.5 samples/s | 13.7 steps/s
[Step= 100] | Loss=6.97573 | acc=0.0934 | tpr=0.7612 | fpr=0.9191 | 7160.8 samples/s | 28.0 steps/s
[Step= 150] | Loss=7.00125 | acc=0.0932 | tpr=0.7637 | fpr=0.9191 | 6716.3 samples/s | 26.2 steps/s
[Step= 200] | Loss=6.98896 | acc=0.0924 | tpr=0.7552 | fpr=0.9197 | 6986.3 samples/s | 27.3 steps/s
[Step= 250] | Loss=6.99536 | acc=0.0924 | tpr=0.7546 | fpr=0.9197 | 7034.2 samples/s | 27.5 steps/s
[Step= 300] | Loss=7.00219 | acc=0.0924 | tpr=0.7513 | fpr=0.9196 | 6753.0 samples/s | 26.4 steps/s
[Step= 350] | Loss=6.99619 | acc=0.0922 | tpr=0.7477 | fpr=0.9197 | 6815.0 samples/s | 26.6 steps/s
[Step= 400] | Loss=6.99320 | acc=0.0927 | tpr=0.7484 | fpr=0.9192 | 6777.9 samples/s | 26.5 steps/s
[Step= 450] | Loss=6.99721 | acc=0.0923 | tpr=0.7493 | fpr=0.9196 | 6853.8 samples/s | 26.8 steps/s
[Step= 500] | Loss=6.99976 | acc=0.0922 | tpr=0.7489 | fpr=0.9197 | 6981.2 samples/s | 27.3 steps/s
[Step= 550] | Loss=6.99858 | acc=0.0922 | tpr=0.7509 | fpr=0.9198 | 11992.0 samples/s | 46.8 steps/s
Avg test loss: 7.00103, Avg test acc: 0.09213, Avg tpr: 0.75119, Avg fpr: 0.91985, total FA: 127719

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11360 | acc=0.9833 | tpr=0.9248 | fpr=0.0157 | 3453.7 samples/s | 13.5 steps/s
[Step= 100] | Loss=0.11711 | acc=0.9828 | tpr=0.9467 | fpr=0.0165 | 6879.1 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.12172 | acc=0.9820 | tpr=0.9496 | fpr=0.0174 | 6704.8 samples/s | 26.2 steps/s
[Step= 200] | Loss=0.12349 | acc=0.9820 | tpr=0.9519 | fpr=0.0175 | 6882.9 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.12164 | acc=0.9820 | tpr=0.9459 | fpr=0.0173 | 6811.4 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.12413 | acc=0.9817 | tpr=0.9418 | fpr=0.0175 | 6759.7 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.12484 | acc=0.9814 | tpr=0.9405 | fpr=0.0179 | 6907.2 samples/s | 27.0 steps/s
[Step= 400] | Loss=0.12666 | acc=0.9812 | tpr=0.9354 | fpr=0.0179 | 6731.4 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.12894 | acc=0.9809 | tpr=0.9343 | fpr=0.0182 | 6680.0 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.12795 | acc=0.9811 | tpr=0.9374 | fpr=0.0181 | 6716.5 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.12686 | acc=0.9813 | tpr=0.9363 | fpr=0.0179 | 12613.4 samples/s | 49.3 steps/s
Avg test loss: 0.12663, Avg test acc: 0.98129, Avg tpr: 0.93582, Avg fpr: 0.01788, total FA: 2483

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09590 | acc=0.9835 | tpr=0.9292 | fpr=0.0155 | 3509.5 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.10119 | acc=0.9826 | tpr=0.9510 | fpr=0.0168 | 6814.2 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.10545 | acc=0.9817 | tpr=0.9510 | fpr=0.0177 | 6917.7 samples/s | 27.0 steps/s
[Step= 200] | Loss=0.10678 | acc=0.9818 | tpr=0.9508 | fpr=0.0177 | 6766.2 samples/s | 26.4 steps/s
[Step= 250] | Loss=0.10507 | acc=0.9820 | tpr=0.9502 | fpr=0.0174 | 7006.7 samples/s | 27.4 steps/s
[Step= 300] | Loss=0.10774 | acc=0.9818 | tpr=0.9476 | fpr=0.0176 | 6832.8 samples/s | 26.7 steps/s
[Step= 350] | Loss=0.10816 | acc=0.9815 | tpr=0.9499 | fpr=0.0179 | 6977.3 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.10946 | acc=0.9813 | tpr=0.9447 | fpr=0.0180 | 6677.9 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.11057 | acc=0.9812 | tpr=0.9435 | fpr=0.0181 | 6682.3 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.11020 | acc=0.9814 | tpr=0.9449 | fpr=0.0180 | 6752.3 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.10927 | acc=0.9816 | tpr=0.9443 | fpr=0.0178 | 12705.2 samples/s | 49.6 steps/s
Avg test loss: 0.10919, Avg test acc: 0.98155, Avg tpr: 0.94374, Avg fpr: 0.01777, total FA: 2467

server round 10/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=20001 Epoch=39.0] | Loss=0.02805 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.331 | L2-Norm(final)=5.615 | 3156.3 samples/s | 49.3 steps/s
[Step=20050 Epoch=39.1] | Loss=0.06243 | Reg=0.00236 | acc=0.9219 | L2-Norm=15.366 | L2-Norm(final)=5.632 | 4023.5 samples/s | 62.9 steps/s
[Step=20100 Epoch=39.2] | Loss=0.05891 | Reg=0.00237 | acc=0.9219 | L2-Norm=15.408 | L2-Norm(final)=5.648 | 4340.3 samples/s | 67.8 steps/s
[Step=20150 Epoch=39.3] | Loss=0.05380 | Reg=0.00239 | acc=0.9219 | L2-Norm=15.446 | L2-Norm(final)=5.669 | 4406.5 samples/s | 68.9 steps/s
[Step=20200 Epoch=39.4] | Loss=0.05127 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.484 | L2-Norm(final)=5.694 | 4397.2 samples/s | 68.7 steps/s
[Step=20250 Epoch=39.5] | Loss=0.05020 | Reg=0.00241 | acc=0.9531 | L2-Norm=15.520 | L2-Norm(final)=5.719 | 4385.6 samples/s | 68.5 steps/s
[Step=20300 Epoch=39.6] | Loss=0.04944 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.552 | L2-Norm(final)=5.739 | 4395.2 samples/s | 68.7 steps/s
[Step=20350 Epoch=39.7] | Loss=0.04940 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.583 | L2-Norm(final)=5.756 | 4354.0 samples/s | 68.0 steps/s
[Step=20400 Epoch=39.8] | Loss=0.04958 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.615 | L2-Norm(final)=5.774 | 4362.2 samples/s | 68.2 steps/s
[Step=20450 Epoch=39.9] | Loss=0.04968 | Reg=0.00245 | acc=0.9531 | L2-Norm=15.646 | L2-Norm(final)=5.792 | 4471.9 samples/s | 69.9 steps/s
[Step=20500 Epoch=40.0] | Loss=0.04908 | Reg=0.00246 | acc=0.9688 | L2-Norm=15.676 | L2-Norm(final)=5.808 | 5437.3 samples/s | 85.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=40.0] | Loss=0.04020 | Reg=0.00255 | acc=0.9688 | L2-Norm=15.974 | L2-Norm(final)=5.969 | 3263.5 samples/s | 51.0 steps/s
[Step=20550 Epoch=40.1] | Loss=0.03557 | Reg=0.00256 | acc=0.9844 | L2-Norm=16.003 | L2-Norm(final)=5.992 | 3500.3 samples/s | 54.7 steps/s
[Step=20600 Epoch=40.2] | Loss=0.03333 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.025 | L2-Norm(final)=5.996 | 3986.0 samples/s | 62.3 steps/s
[Step=20650 Epoch=40.3] | Loss=0.03172 | Reg=0.00257 | acc=0.9531 | L2-Norm=16.041 | L2-Norm(final)=5.995 | 3965.6 samples/s | 62.0 steps/s
[Step=20700 Epoch=40.4] | Loss=0.03078 | Reg=0.00258 | acc=0.9844 | L2-Norm=16.054 | L2-Norm(final)=5.994 | 3907.7 samples/s | 61.1 steps/s
[Step=20750 Epoch=40.5] | Loss=0.02976 | Reg=0.00258 | acc=0.9844 | L2-Norm=16.065 | L2-Norm(final)=5.993 | 3983.5 samples/s | 62.2 steps/s
[Step=20800 Epoch=40.6] | Loss=0.02842 | Reg=0.00258 | acc=0.9531 | L2-Norm=16.076 | L2-Norm(final)=5.993 | 3936.1 samples/s | 61.5 steps/s
[Step=20850 Epoch=40.7] | Loss=0.02782 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.087 | L2-Norm(final)=5.994 | 3947.7 samples/s | 61.7 steps/s
[Step=20900 Epoch=40.8] | Loss=0.02732 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.097 | L2-Norm(final)=5.994 | 3960.7 samples/s | 61.9 steps/s
[Step=20950 Epoch=40.9] | Loss=0.02687 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.106 | L2-Norm(final)=5.994 | 3970.1 samples/s | 62.0 steps/s
[Step=21000 Epoch=41.0] | Loss=0.02641 | Reg=0.00260 | acc=0.9688 | L2-Norm=16.115 | L2-Norm(final)=5.993 | 4792.6 samples/s | 74.9 steps/s
[Step=21050 Epoch=41.1] | Loss=0.02578 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.122 | L2-Norm(final)=5.991 | 1484.8 samples/s | 23.2 steps/s
[Step=21100 Epoch=41.2] | Loss=0.02476 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.129 | L2-Norm(final)=5.991 | 3871.9 samples/s | 60.5 steps/s
[Step=21150 Epoch=41.3] | Loss=0.02383 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.135 | L2-Norm(final)=5.991 | 3909.9 samples/s | 61.1 steps/s
[Step=21200 Epoch=41.3] | Loss=0.02354 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.140 | L2-Norm(final)=5.991 | 3911.0 samples/s | 61.1 steps/s
[Step=21250 Epoch=41.4] | Loss=0.02276 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.145 | L2-Norm(final)=5.992 | 4011.8 samples/s | 62.7 steps/s
[Step=21300 Epoch=41.5] | Loss=0.02205 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.150 | L2-Norm(final)=5.993 | 3947.1 samples/s | 61.7 steps/s
[Step=21350 Epoch=41.6] | Loss=0.02166 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.155 | L2-Norm(final)=5.994 | 3930.4 samples/s | 61.4 steps/s
[Step=21400 Epoch=41.7] | Loss=0.02125 | Reg=0.00261 | acc=0.9844 | L2-Norm=16.159 | L2-Norm(final)=5.995 | 3978.2 samples/s | 62.2 steps/s
[Step=21450 Epoch=41.8] | Loss=0.02103 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.163 | L2-Norm(final)=5.996 | 3947.8 samples/s | 61.7 steps/s
[Step=21500 Epoch=41.9] | Loss=0.02078 | Reg=0.00261 | acc=0.9844 | L2-Norm=16.168 | L2-Norm(final)=5.998 | 4136.9 samples/s | 64.6 steps/s
[Step=21550 Epoch=42.0] | Loss=0.02059 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.172 | L2-Norm(final)=5.999 | 1567.7 samples/s | 24.5 steps/s
[Step=21600 Epoch=42.1] | Loss=0.02016 | Reg=0.00262 | acc=0.9688 | L2-Norm=16.176 | L2-Norm(final)=6.000 | 3974.8 samples/s | 62.1 steps/s
[Step=21650 Epoch=42.2] | Loss=0.01986 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.180 | L2-Norm(final)=6.001 | 3884.2 samples/s | 60.7 steps/s
[Step=21700 Epoch=42.3] | Loss=0.01949 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.183 | L2-Norm(final)=6.003 | 3926.6 samples/s | 61.4 steps/s
[Step=21750 Epoch=42.4] | Loss=0.01913 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.187 | L2-Norm(final)=6.004 | 3904.8 samples/s | 61.0 steps/s
[Step=21800 Epoch=42.5] | Loss=0.01892 | Reg=0.00262 | acc=0.9688 | L2-Norm=16.190 | L2-Norm(final)=6.006 | 4018.3 samples/s | 62.8 steps/s
[Step=21850 Epoch=42.6] | Loss=0.01864 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.193 | L2-Norm(final)=6.007 | 3973.4 samples/s | 62.1 steps/s
[Step=21900 Epoch=42.7] | Loss=0.01850 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.196 | L2-Norm(final)=6.008 | 3948.1 samples/s | 61.7 steps/s
[Step=21950 Epoch=42.8] | Loss=0.01837 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.200 | L2-Norm(final)=6.009 | 3945.7 samples/s | 61.7 steps/s
[Step=22000 Epoch=42.9] | Loss=0.01812 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.203 | L2-Norm(final)=6.011 | 3950.6 samples/s | 61.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step22000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=20001 Epoch=39.1] | Loss=0.11464 | Reg=0.00235 | acc=0.8594 | L2-Norm=15.331 | L2-Norm(final)=5.961 | 3352.3 samples/s | 52.4 steps/s
[Step=20050 Epoch=39.2] | Loss=0.05440 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.366 | L2-Norm(final)=5.987 | 4207.3 samples/s | 65.7 steps/s
[Step=20100 Epoch=39.3] | Loss=0.05357 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.412 | L2-Norm(final)=6.014 | 4324.4 samples/s | 67.6 steps/s
[Step=20150 Epoch=39.4] | Loss=0.05202 | Reg=0.00239 | acc=0.9531 | L2-Norm=15.455 | L2-Norm(final)=6.036 | 4391.5 samples/s | 68.6 steps/s
[Step=20200 Epoch=39.5] | Loss=0.05146 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.495 | L2-Norm(final)=6.056 | 4347.4 samples/s | 67.9 steps/s
[Step=20250 Epoch=39.6] | Loss=0.05048 | Reg=0.00241 | acc=0.9531 | L2-Norm=15.530 | L2-Norm(final)=6.075 | 4345.4 samples/s | 67.9 steps/s
[Step=20300 Epoch=39.7] | Loss=0.04968 | Reg=0.00242 | acc=0.9531 | L2-Norm=15.565 | L2-Norm(final)=6.094 | 4414.2 samples/s | 69.0 steps/s
[Step=20350 Epoch=39.8] | Loss=0.04901 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.599 | L2-Norm(final)=6.113 | 4380.9 samples/s | 68.5 steps/s
[Step=20400 Epoch=39.9] | Loss=0.04888 | Reg=0.00244 | acc=0.9688 | L2-Norm=15.632 | L2-Norm(final)=6.132 | 4526.0 samples/s | 70.7 steps/s
[Step=20450 Epoch=40.0] | Loss=0.04851 | Reg=0.00245 | acc=0.9375 | L2-Norm=15.664 | L2-Norm(final)=6.150 | 4318.9 samples/s | 67.5 steps/s
[Step=20500 Epoch=40.1] | Loss=0.04873 | Reg=0.00246 | acc=0.9688 | L2-Norm=15.695 | L2-Norm(final)=6.168 | 5578.3 samples/s | 87.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=40.1] | Loss=0.02474 | Reg=0.00256 | acc=0.9844 | L2-Norm=16.006 | L2-Norm(final)=6.343 | 3200.4 samples/s | 50.0 steps/s
[Step=20550 Epoch=40.2] | Loss=0.04117 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.028 | L2-Norm(final)=6.349 | 3821.2 samples/s | 59.7 steps/s
[Step=20600 Epoch=40.3] | Loss=0.03195 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.049 | L2-Norm(final)=6.358 | 3905.7 samples/s | 61.0 steps/s
[Step=20650 Epoch=40.4] | Loss=0.03298 | Reg=0.00258 | acc=0.9688 | L2-Norm=16.063 | L2-Norm(final)=6.360 | 3903.2 samples/s | 61.0 steps/s
[Step=20700 Epoch=40.5] | Loss=0.03177 | Reg=0.00258 | acc=0.9844 | L2-Norm=16.076 | L2-Norm(final)=6.359 | 3908.2 samples/s | 61.1 steps/s
[Step=20750 Epoch=40.6] | Loss=0.03077 | Reg=0.00259 | acc=0.9688 | L2-Norm=16.087 | L2-Norm(final)=6.358 | 3946.1 samples/s | 61.7 steps/s
[Step=20800 Epoch=40.7] | Loss=0.02994 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.097 | L2-Norm(final)=6.356 | 3931.4 samples/s | 61.4 steps/s
[Step=20850 Epoch=40.8] | Loss=0.02913 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.106 | L2-Norm(final)=6.355 | 3913.2 samples/s | 61.1 steps/s
[Step=20900 Epoch=40.9] | Loss=0.02873 | Reg=0.00260 | acc=0.9531 | L2-Norm=16.114 | L2-Norm(final)=6.354 | 3926.7 samples/s | 61.4 steps/s
[Step=20950 Epoch=41.0] | Loss=0.02740 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.123 | L2-Norm(final)=6.354 | 3933.3 samples/s | 61.5 steps/s
[Step=21000 Epoch=41.1] | Loss=0.02669 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.130 | L2-Norm(final)=6.354 | 4819.3 samples/s | 75.3 steps/s
[Step=21050 Epoch=41.2] | Loss=0.02579 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.137 | L2-Norm(final)=6.353 | 1475.5 samples/s | 23.1 steps/s
[Step=21100 Epoch=41.2] | Loss=0.02491 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.143 | L2-Norm(final)=6.353 | 3947.7 samples/s | 61.7 steps/s
[Step=21150 Epoch=41.3] | Loss=0.02416 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.149 | L2-Norm(final)=6.354 | 3890.8 samples/s | 60.8 steps/s
[Step=21200 Epoch=41.4] | Loss=0.02342 | Reg=0.00261 | acc=0.9844 | L2-Norm=16.156 | L2-Norm(final)=6.355 | 3885.8 samples/s | 60.7 steps/s
[Step=21250 Epoch=41.5] | Loss=0.02283 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.162 | L2-Norm(final)=6.356 | 3968.3 samples/s | 62.0 steps/s
[Step=21300 Epoch=41.6] | Loss=0.02240 | Reg=0.00261 | acc=0.9844 | L2-Norm=16.167 | L2-Norm(final)=6.357 | 3978.7 samples/s | 62.2 steps/s
[Step=21350 Epoch=41.7] | Loss=0.02191 | Reg=0.00262 | acc=0.9688 | L2-Norm=16.173 | L2-Norm(final)=6.358 | 3931.8 samples/s | 61.4 steps/s
[Step=21400 Epoch=41.8] | Loss=0.02155 | Reg=0.00262 | acc=0.9688 | L2-Norm=16.178 | L2-Norm(final)=6.359 | 3890.9 samples/s | 60.8 steps/s
[Step=21450 Epoch=41.9] | Loss=0.02109 | Reg=0.00262 | acc=0.9688 | L2-Norm=16.182 | L2-Norm(final)=6.360 | 3882.8 samples/s | 60.7 steps/s
[Step=21500 Epoch=42.0] | Loss=0.02092 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.187 | L2-Norm(final)=6.361 | 4266.9 samples/s | 66.7 steps/s
[Step=21550 Epoch=42.1] | Loss=0.02054 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.191 | L2-Norm(final)=6.363 | 1553.7 samples/s | 24.3 steps/s
[Step=21600 Epoch=42.2] | Loss=0.02014 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.195 | L2-Norm(final)=6.364 | 4001.6 samples/s | 62.5 steps/s
[Step=21650 Epoch=42.3] | Loss=0.01981 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.199 | L2-Norm(final)=6.366 | 3896.7 samples/s | 60.9 steps/s
[Step=21700 Epoch=42.4] | Loss=0.01949 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.202 | L2-Norm(final)=6.367 | 3907.2 samples/s | 61.1 steps/s
[Step=21750 Epoch=42.5] | Loss=0.01927 | Reg=0.00263 | acc=0.9844 | L2-Norm=16.206 | L2-Norm(final)=6.369 | 3922.2 samples/s | 61.3 steps/s
[Step=21800 Epoch=42.6] | Loss=0.01907 | Reg=0.00263 | acc=0.9844 | L2-Norm=16.210 | L2-Norm(final)=6.370 | 3951.7 samples/s | 61.7 steps/s
[Step=21850 Epoch=42.7] | Loss=0.01873 | Reg=0.00263 | acc=0.9844 | L2-Norm=16.214 | L2-Norm(final)=6.372 | 3984.5 samples/s | 62.3 steps/s
[Step=21900 Epoch=42.8] | Loss=0.01843 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.217 | L2-Norm(final)=6.374 | 3950.0 samples/s | 61.7 steps/s
[Step=21950 Epoch=42.9] | Loss=0.01826 | Reg=0.00263 | acc=0.9844 | L2-Norm=16.221 | L2-Norm(final)=6.375 | 3946.6 samples/s | 61.7 steps/s
[Step=22000 Epoch=43.0] | Loss=0.01809 | Reg=0.00263 | acc=0.9844 | L2-Norm=16.225 | L2-Norm(final)=6.377 | 3948.9 samples/s | 61.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step22000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=20001 Epoch=76.6] | Loss=0.00294 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.331 | L2-Norm(final)=5.908 | 3169.7 samples/s | 49.5 steps/s
[Step=20050 Epoch=76.8] | Loss=0.00224 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.327 | L2-Norm(final)=5.929 | 4029.1 samples/s | 63.0 steps/s
[Step=20100 Epoch=77.0] | Loss=0.00216 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.316 | L2-Norm(final)=5.951 | 4105.3 samples/s | 64.1 steps/s
[Step=20150 Epoch=77.2] | Loss=0.00170 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.315 | L2-Norm(final)=5.968 | 4105.5 samples/s | 64.1 steps/s
[Step=20200 Epoch=77.4] | Loss=0.00152 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.309 | L2-Norm(final)=5.982 | 4149.5 samples/s | 64.8 steps/s
[Step=20250 Epoch=77.6] | Loss=0.00134 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.302 | L2-Norm(final)=5.994 | 5439.8 samples/s | 85.0 steps/s
[Step=20300 Epoch=77.8] | Loss=0.00115 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.295 | L2-Norm(final)=6.004 | 1497.8 samples/s | 23.4 steps/s
[Step=20350 Epoch=78.0] | Loss=0.00104 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.286 | L2-Norm(final)=6.014 | 4154.4 samples/s | 64.9 steps/s
[Step=20400 Epoch=78.2] | Loss=0.00098 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.276 | L2-Norm(final)=6.024 | 4074.8 samples/s | 63.7 steps/s
[Step=20450 Epoch=78.4] | Loss=0.00090 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.268 | L2-Norm(final)=6.034 | 4155.7 samples/s | 64.9 steps/s
[Step=20500 Epoch=78.5] | Loss=0.00083 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.259 | L2-Norm(final)=6.044 | 4580.9 samples/s | 71.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=78.6] | Loss=0.00007 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.168 | L2-Norm(final)=6.137 | 3541.2 samples/s | 55.3 steps/s
[Step=20550 Epoch=78.7] | Loss=0.00014 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.153 | L2-Norm(final)=6.145 | 3473.9 samples/s | 54.3 steps/s
[Step=20600 Epoch=78.9] | Loss=0.00009 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.133 | L2-Norm(final)=6.151 | 3712.1 samples/s | 58.0 steps/s
[Step=20650 Epoch=79.1] | Loss=0.00009 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.110 | L2-Norm(final)=6.155 | 3739.8 samples/s | 58.4 steps/s
[Step=20700 Epoch=79.3] | Loss=0.00009 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.088 | L2-Norm(final)=6.159 | 3724.3 samples/s | 58.2 steps/s
[Step=20750 Epoch=79.5] | Loss=0.00009 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.067 | L2-Norm(final)=6.163 | 4774.1 samples/s | 74.6 steps/s
[Step=20800 Epoch=79.7] | Loss=0.00008 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.046 | L2-Norm(final)=6.167 | 1478.0 samples/s | 23.1 steps/s
[Step=20850 Epoch=79.9] | Loss=0.00007 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.024 | L2-Norm(final)=6.170 | 3752.7 samples/s | 58.6 steps/s
[Step=20900 Epoch=80.1] | Loss=0.00006 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.002 | L2-Norm(final)=6.173 | 3756.3 samples/s | 58.7 steps/s
[Step=20950 Epoch=80.3] | Loss=0.00006 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.979 | L2-Norm(final)=6.175 | 3746.5 samples/s | 58.5 steps/s
[Step=21000 Epoch=80.5] | Loss=0.00005 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.956 | L2-Norm(final)=6.177 | 4137.6 samples/s | 64.6 steps/s
[Step=21050 Epoch=80.7] | Loss=0.00005 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.933 | L2-Norm(final)=6.179 | 1555.6 samples/s | 24.3 steps/s
[Step=21100 Epoch=80.8] | Loss=0.00005 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.910 | L2-Norm(final)=6.181 | 3734.9 samples/s | 58.4 steps/s
[Step=21150 Epoch=81.0] | Loss=0.00004 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.887 | L2-Norm(final)=6.183 | 3760.7 samples/s | 58.8 steps/s
[Step=21200 Epoch=81.2] | Loss=0.00004 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.864 | L2-Norm(final)=6.184 | 3770.6 samples/s | 58.9 steps/s
[Step=21250 Epoch=81.4] | Loss=0.00004 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.841 | L2-Norm(final)=6.186 | 3692.8 samples/s | 57.7 steps/s
[Step=21300 Epoch=81.6] | Loss=0.00004 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.818 | L2-Norm(final)=6.187 | 1592.0 samples/s | 24.9 steps/s
[Step=21350 Epoch=81.8] | Loss=0.00003 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.795 | L2-Norm(final)=6.189 | 3762.5 samples/s | 58.8 steps/s
[Step=21400 Epoch=82.0] | Loss=0.00003 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.771 | L2-Norm(final)=6.190 | 3749.8 samples/s | 58.6 steps/s
[Step=21450 Epoch=82.2] | Loss=0.00003 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.748 | L2-Norm(final)=6.192 | 3665.6 samples/s | 57.3 steps/s
[Step=21500 Epoch=82.4] | Loss=0.00003 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.725 | L2-Norm(final)=6.193 | 3750.9 samples/s | 58.6 steps/s
[Step=21550 Epoch=82.6] | Loss=0.00003 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.702 | L2-Norm(final)=6.194 | 1577.7 samples/s | 24.7 steps/s
[Step=21600 Epoch=82.8] | Loss=0.00003 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.679 | L2-Norm(final)=6.196 | 3695.0 samples/s | 57.7 steps/s
[Step=21650 Epoch=83.0] | Loss=0.00003 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.655 | L2-Norm(final)=6.197 | 3744.0 samples/s | 58.5 steps/s
[Step=21700 Epoch=83.1] | Loss=0.00003 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.632 | L2-Norm(final)=6.198 | 3782.5 samples/s | 59.1 steps/s
[Step=21750 Epoch=83.3] | Loss=0.00003 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.609 | L2-Norm(final)=6.199 | 3716.0 samples/s | 58.1 steps/s
[Step=21800 Epoch=83.5] | Loss=0.00003 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.585 | L2-Norm(final)=6.201 | 5141.3 samples/s | 80.3 steps/s
[Step=21850 Epoch=83.7] | Loss=0.00002 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.562 | L2-Norm(final)=6.202 | 1451.1 samples/s | 22.7 steps/s
[Step=21900 Epoch=83.9] | Loss=0.00002 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.539 | L2-Norm(final)=6.203 | 3714.9 samples/s | 58.0 steps/s
[Step=21950 Epoch=84.1] | Loss=0.00002 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.515 | L2-Norm(final)=6.204 | 3797.2 samples/s | 59.3 steps/s
[Step=22000 Epoch=84.3] | Loss=0.00002 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.492 | L2-Norm(final)=6.206 | 3688.9 samples/s | 57.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step22000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=20001 Epoch=77.0] | Loss=0.02267 | Reg=0.00235 | acc=0.9688 | L2-Norm=15.331 | L2-Norm(final)=6.594 | 3482.0 samples/s | 54.4 steps/s
[Step=20050 Epoch=77.2] | Loss=0.00495 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.343 | L2-Norm(final)=6.600 | 3532.4 samples/s | 55.2 steps/s
[Step=20100 Epoch=77.4] | Loss=0.00381 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.346 | L2-Norm(final)=6.625 | 4175.8 samples/s | 65.2 steps/s
[Step=20150 Epoch=77.6] | Loss=0.00325 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.347 | L2-Norm(final)=6.645 | 4078.1 samples/s | 63.7 steps/s
[Step=20200 Epoch=77.8] | Loss=0.00282 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.348 | L2-Norm(final)=6.662 | 4147.7 samples/s | 64.8 steps/s
[Step=20250 Epoch=78.0] | Loss=0.00241 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.350 | L2-Norm(final)=6.677 | 5631.1 samples/s | 88.0 steps/s
[Step=20300 Epoch=78.1] | Loss=0.00206 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.350 | L2-Norm(final)=6.691 | 1508.5 samples/s | 23.6 steps/s
[Step=20350 Epoch=78.3] | Loss=0.00188 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.346 | L2-Norm(final)=6.705 | 4214.5 samples/s | 65.9 steps/s
[Step=20400 Epoch=78.5] | Loss=0.00170 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.343 | L2-Norm(final)=6.719 | 4052.0 samples/s | 63.3 steps/s
[Step=20450 Epoch=78.7] | Loss=0.00160 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.340 | L2-Norm(final)=6.732 | 4110.4 samples/s | 64.2 steps/s
[Step=20500 Epoch=78.9] | Loss=0.00148 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.336 | L2-Norm(final)=6.745 | 4744.5 samples/s | 74.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=78.9] | Loss=0.00002 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.296 | L2-Norm(final)=6.873 | 3228.7 samples/s | 50.4 steps/s
[Step=20550 Epoch=79.1] | Loss=0.00020 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.285 | L2-Norm(final)=6.884 | 3538.5 samples/s | 55.3 steps/s
[Step=20600 Epoch=79.3] | Loss=0.00018 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.265 | L2-Norm(final)=6.893 | 3698.4 samples/s | 57.8 steps/s
[Step=20650 Epoch=79.5] | Loss=0.00083 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.255 | L2-Norm(final)=6.899 | 3735.2 samples/s | 58.4 steps/s
[Step=20700 Epoch=79.7] | Loss=0.00110 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.263 | L2-Norm(final)=6.902 | 3742.7 samples/s | 58.5 steps/s
[Step=20750 Epoch=79.9] | Loss=0.00113 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.274 | L2-Norm(final)=6.907 | 4839.3 samples/s | 75.6 steps/s
[Step=20800 Epoch=80.1] | Loss=0.00097 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.282 | L2-Norm(final)=6.912 | 1496.8 samples/s | 23.4 steps/s
[Step=20850 Epoch=80.3] | Loss=0.00094 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.282 | L2-Norm(final)=6.916 | 3724.5 samples/s | 58.2 steps/s
[Step=20900 Epoch=80.5] | Loss=0.00091 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.281 | L2-Norm(final)=6.919 | 3805.2 samples/s | 59.5 steps/s
[Step=20950 Epoch=80.6] | Loss=0.00083 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.278 | L2-Norm(final)=6.921 | 3755.8 samples/s | 58.7 steps/s
[Step=21000 Epoch=80.8] | Loss=0.00076 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.273 | L2-Norm(final)=6.924 | 4224.7 samples/s | 66.0 steps/s
[Step=21050 Epoch=81.0] | Loss=0.00069 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.266 | L2-Norm(final)=6.927 | 1487.1 samples/s | 23.2 steps/s
[Step=21100 Epoch=81.2] | Loss=0.00064 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.257 | L2-Norm(final)=6.930 | 3742.2 samples/s | 58.5 steps/s
[Step=21150 Epoch=81.4] | Loss=0.00059 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.246 | L2-Norm(final)=6.932 | 3637.5 samples/s | 56.8 steps/s
[Step=21200 Epoch=81.6] | Loss=0.00055 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.235 | L2-Norm(final)=6.934 | 3702.3 samples/s | 57.8 steps/s
[Step=21250 Epoch=81.8] | Loss=0.00051 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.222 | L2-Norm(final)=6.936 | 3742.2 samples/s | 58.5 steps/s
[Step=21300 Epoch=82.0] | Loss=0.00048 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.208 | L2-Norm(final)=6.938 | 1555.5 samples/s | 24.3 steps/s
[Step=21350 Epoch=82.2] | Loss=0.00045 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.193 | L2-Norm(final)=6.940 | 3735.9 samples/s | 58.4 steps/s
[Step=21400 Epoch=82.4] | Loss=0.00043 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.179 | L2-Norm(final)=6.941 | 3669.4 samples/s | 57.3 steps/s
[Step=21450 Epoch=82.6] | Loss=0.00041 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.163 | L2-Norm(final)=6.943 | 3698.9 samples/s | 57.8 steps/s
[Step=21500 Epoch=82.8] | Loss=0.00039 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.147 | L2-Norm(final)=6.944 | 3730.6 samples/s | 58.3 steps/s
[Step=21550 Epoch=83.0] | Loss=0.00037 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.131 | L2-Norm(final)=6.945 | 1623.7 samples/s | 25.4 steps/s
[Step=21600 Epoch=83.1] | Loss=0.00035 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.115 | L2-Norm(final)=6.946 | 3616.5 samples/s | 56.5 steps/s
[Step=21650 Epoch=83.3] | Loss=0.00034 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.098 | L2-Norm(final)=6.948 | 3672.5 samples/s | 57.4 steps/s
[Step=21700 Epoch=83.5] | Loss=0.00032 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.081 | L2-Norm(final)=6.949 | 3703.0 samples/s | 57.9 steps/s
[Step=21750 Epoch=83.7] | Loss=0.00031 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.063 | L2-Norm(final)=6.950 | 3690.6 samples/s | 57.7 steps/s
[Step=21800 Epoch=83.9] | Loss=0.00030 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.046 | L2-Norm(final)=6.951 | 5411.4 samples/s | 84.6 steps/s
[Step=21850 Epoch=84.1] | Loss=0.00029 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.028 | L2-Norm(final)=6.952 | 1364.2 samples/s | 21.3 steps/s
[Step=21900 Epoch=84.3] | Loss=0.00028 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.011 | L2-Norm(final)=6.953 | 3703.2 samples/s | 57.9 steps/s
[Step=21950 Epoch=84.5] | Loss=0.00027 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.993 | L2-Norm(final)=6.954 | 3692.5 samples/s | 57.7 steps/s
[Step=22000 Epoch=84.7] | Loss=0.00026 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.974 | L2-Norm(final)=6.956 | 3706.0 samples/s | 57.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step22000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07235 | acc=0.9660 | tpr=0.9758 | fpr=0.0553 | 3528.5 samples/s | 13.8 steps/s
Avg test loss: 0.07551, Avg test acc: 0.96446, Avg tpr: 0.97430, Avg fpr: 0.05717, total FA: 446

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05776 | acc=0.9680 | tpr=0.9771 | fpr=0.0515 | 3513.2 samples/s | 13.7 steps/s
Avg test loss: 0.06562, Avg test acc: 0.96606, Avg tpr: 0.97546, Avg fpr: 0.05461, total FA: 426

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.29717 | acc=0.3101 | tpr=0.0213 | fpr=0.0629 | 3506.6 samples/s | 13.7 steps/s
Avg test loss: 5.29851, Avg test acc: 0.30792, Avg tpr: 0.02209, Avg fpr: 0.06345, total FA: 495

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.54544 | acc=0.3086 | tpr=0.0251 | fpr=0.0758 | 3509.0 samples/s | 13.7 steps/s
Avg test loss: 5.54452, Avg test acc: 0.30611, Avg tpr: 0.02617, Avg fpr: 0.07820, total FA: 610

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.73811 | acc=0.0939 | tpr=0.8053 | fpr=0.9189 | 3497.6 samples/s | 13.7 steps/s
[Step= 100] | Loss=6.69869 | acc=0.0954 | tpr=0.8188 | fpr=0.9181 | 6831.9 samples/s | 26.7 steps/s
[Step= 150] | Loss=6.72095 | acc=0.0941 | tpr=0.8156 | fpr=0.9192 | 6946.2 samples/s | 27.1 steps/s
[Step= 200] | Loss=6.70817 | acc=0.0939 | tpr=0.8044 | fpr=0.9191 | 7062.1 samples/s | 27.6 steps/s
[Step= 250] | Loss=6.70815 | acc=0.0939 | tpr=0.8070 | fpr=0.9191 | 6715.2 samples/s | 26.2 steps/s
[Step= 300] | Loss=6.71084 | acc=0.0938 | tpr=0.8058 | fpr=0.9192 | 6880.9 samples/s | 26.9 steps/s
[Step= 350] | Loss=6.70733 | acc=0.0938 | tpr=0.8084 | fpr=0.9192 | 6977.1 samples/s | 27.3 steps/s
[Step= 400] | Loss=6.70169 | acc=0.0938 | tpr=0.8036 | fpr=0.9191 | 6824.7 samples/s | 26.7 steps/s
[Step= 450] | Loss=6.70884 | acc=0.0937 | tpr=0.8072 | fpr=0.9192 | 6647.5 samples/s | 26.0 steps/s
[Step= 500] | Loss=6.71218 | acc=0.0934 | tpr=0.8070 | fpr=0.9195 | 6873.3 samples/s | 26.8 steps/s
[Step= 550] | Loss=6.71235 | acc=0.0936 | tpr=0.8106 | fpr=0.9194 | 12263.4 samples/s | 47.9 steps/s
Avg test loss: 6.71372, Avg test acc: 0.09352, Avg tpr: 0.81022, Avg fpr: 0.91951, total FA: 127672

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.59637 | acc=0.1042 | tpr=0.7876 | fpr=0.9081 | 3503.2 samples/s | 13.7 steps/s
[Step= 100] | Loss=6.53913 | acc=0.1066 | tpr=0.7910 | fpr=0.9062 | 7089.4 samples/s | 27.7 steps/s
[Step= 150] | Loss=6.54309 | acc=0.1061 | tpr=0.8069 | fpr=0.9068 | 6820.5 samples/s | 26.6 steps/s
[Step= 200] | Loss=6.52830 | acc=0.1058 | tpr=0.7913 | fpr=0.9067 | 7030.2 samples/s | 27.5 steps/s
[Step= 250] | Loss=6.52696 | acc=0.1061 | tpr=0.7904 | fpr=0.9063 | 6774.9 samples/s | 26.5 steps/s
[Step= 300] | Loss=6.52938 | acc=0.1061 | tpr=0.7905 | fpr=0.9064 | 6842.5 samples/s | 26.7 steps/s
[Step= 350] | Loss=6.52921 | acc=0.1064 | tpr=0.7940 | fpr=0.9061 | 7013.5 samples/s | 27.4 steps/s
[Step= 400] | Loss=6.52538 | acc=0.1067 | tpr=0.7910 | fpr=0.9058 | 6795.3 samples/s | 26.5 steps/s
[Step= 450] | Loss=6.53771 | acc=0.1063 | tpr=0.7936 | fpr=0.9062 | 6579.7 samples/s | 25.7 steps/s
[Step= 500] | Loss=6.53751 | acc=0.1062 | tpr=0.7938 | fpr=0.9062 | 6964.5 samples/s | 27.2 steps/s
[Step= 550] | Loss=6.53772 | acc=0.1066 | tpr=0.7979 | fpr=0.9060 | 12141.4 samples/s | 47.4 steps/s
Avg test loss: 6.54001, Avg test acc: 0.10651, Avg tpr: 0.79754, Avg fpr: 0.90605, total FA: 125803

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10370 | acc=0.9825 | tpr=0.9381 | fpr=0.0167 | 3488.0 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.10754 | acc=0.9816 | tpr=0.9510 | fpr=0.0178 | 6924.6 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.11072 | acc=0.9809 | tpr=0.9496 | fpr=0.0185 | 6850.2 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.11141 | acc=0.9813 | tpr=0.9508 | fpr=0.0182 | 6836.3 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.10899 | acc=0.9817 | tpr=0.9511 | fpr=0.0177 | 6812.3 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.11103 | acc=0.9813 | tpr=0.9505 | fpr=0.0181 | 6902.0 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.11111 | acc=0.9812 | tpr=0.9518 | fpr=0.0182 | 7047.0 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.11276 | acc=0.9809 | tpr=0.9453 | fpr=0.0185 | 6655.7 samples/s | 26.0 steps/s
[Step= 450] | Loss=0.11457 | acc=0.9807 | tpr=0.9445 | fpr=0.0186 | 6594.6 samples/s | 25.8 steps/s
[Step= 500] | Loss=0.11397 | acc=0.9808 | tpr=0.9467 | fpr=0.0186 | 6744.3 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.11319 | acc=0.9810 | tpr=0.9451 | fpr=0.0184 | 12567.1 samples/s | 49.1 steps/s
Avg test loss: 0.11311, Avg test acc: 0.98096, Avg tpr: 0.94453, Avg fpr: 0.01838, total FA: 2552

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13914 | acc=0.9805 | tpr=0.9292 | fpr=0.0185 | 3455.1 samples/s | 13.5 steps/s
[Step= 100] | Loss=0.14599 | acc=0.9801 | tpr=0.9467 | fpr=0.0193 | 6843.8 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.15104 | acc=0.9790 | tpr=0.9553 | fpr=0.0206 | 6889.1 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.15322 | acc=0.9794 | tpr=0.9563 | fpr=0.0202 | 6806.7 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.15083 | acc=0.9796 | tpr=0.9546 | fpr=0.0200 | 6816.9 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.15452 | acc=0.9792 | tpr=0.9527 | fpr=0.0204 | 6950.8 samples/s | 27.2 steps/s
[Step= 350] | Loss=0.15404 | acc=0.9791 | tpr=0.9524 | fpr=0.0204 | 7041.1 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.15573 | acc=0.9790 | tpr=0.9497 | fpr=0.0205 | 6640.3 samples/s | 25.9 steps/s
[Step= 450] | Loss=0.15866 | acc=0.9786 | tpr=0.9479 | fpr=0.0208 | 6732.5 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.15789 | acc=0.9787 | tpr=0.9502 | fpr=0.0208 | 6745.7 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.15688 | acc=0.9789 | tpr=0.9507 | fpr=0.0206 | 12247.0 samples/s | 47.8 steps/s
Avg test loss: 0.15676, Avg test acc: 0.97890, Avg tpr: 0.95008, Avg fpr: 0.02058, total FA: 2857

server round 11/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=22001 Epoch=42.9] | Loss=0.03003 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.767 | L2-Norm(final)=6.059 | 3314.1 samples/s | 51.8 steps/s
[Step=22050 Epoch=43.0] | Loss=0.02366 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.801 | L2-Norm(final)=6.064 | 3927.4 samples/s | 61.4 steps/s
[Step=22100 Epoch=43.1] | Loss=0.02414 | Reg=0.00220 | acc=0.9531 | L2-Norm=14.840 | L2-Norm(final)=6.068 | 4350.1 samples/s | 68.0 steps/s
[Step=22150 Epoch=43.2] | Loss=0.02247 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.875 | L2-Norm(final)=6.077 | 4391.3 samples/s | 68.6 steps/s
[Step=22200 Epoch=43.3] | Loss=0.02204 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.905 | L2-Norm(final)=6.090 | 4391.3 samples/s | 68.6 steps/s
[Step=22250 Epoch=43.4] | Loss=0.02300 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.933 | L2-Norm(final)=6.102 | 4376.9 samples/s | 68.4 steps/s
[Step=22300 Epoch=43.5] | Loss=0.02246 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.960 | L2-Norm(final)=6.112 | 4363.4 samples/s | 68.2 steps/s
[Step=22350 Epoch=43.6] | Loss=0.02210 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.984 | L2-Norm(final)=6.122 | 4358.0 samples/s | 68.1 steps/s
[Step=22400 Epoch=43.7] | Loss=0.02218 | Reg=0.00225 | acc=0.9531 | L2-Norm=15.006 | L2-Norm(final)=6.132 | 4394.0 samples/s | 68.7 steps/s
[Step=22450 Epoch=43.8] | Loss=0.02236 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.028 | L2-Norm(final)=6.141 | 4377.4 samples/s | 68.4 steps/s
[Step=22500 Epoch=43.9] | Loss=0.02215 | Reg=0.00226 | acc=0.9531 | L2-Norm=15.049 | L2-Norm(final)=6.151 | 5551.5 samples/s | 86.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=43.9] | Loss=0.01262 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.252 | L2-Norm(final)=6.245 | 3325.2 samples/s | 52.0 steps/s
[Step=22550 Epoch=44.0] | Loss=0.02113 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.270 | L2-Norm(final)=6.252 | 3628.9 samples/s | 56.7 steps/s
[Step=22600 Epoch=44.1] | Loss=0.02230 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.289 | L2-Norm(final)=6.254 | 3927.4 samples/s | 61.4 steps/s
[Step=22650 Epoch=44.2] | Loss=0.02411 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.309 | L2-Norm(final)=6.254 | 3940.3 samples/s | 61.6 steps/s
[Step=22700 Epoch=44.3] | Loss=0.02428 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.331 | L2-Norm(final)=6.252 | 3891.1 samples/s | 60.8 steps/s
[Step=22750 Epoch=44.4] | Loss=0.02404 | Reg=0.00236 | acc=0.9531 | L2-Norm=15.351 | L2-Norm(final)=6.249 | 3983.1 samples/s | 62.2 steps/s
[Step=22800 Epoch=44.5] | Loss=0.02343 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.371 | L2-Norm(final)=6.247 | 3936.8 samples/s | 61.5 steps/s
[Step=22850 Epoch=44.6] | Loss=0.02342 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.389 | L2-Norm(final)=6.247 | 3971.0 samples/s | 62.0 steps/s
[Step=22900 Epoch=44.7] | Loss=0.02318 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.405 | L2-Norm(final)=6.246 | 3920.7 samples/s | 61.3 steps/s
[Step=22950 Epoch=44.8] | Loss=0.02285 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.421 | L2-Norm(final)=6.246 | 3952.6 samples/s | 61.8 steps/s
[Step=23000 Epoch=44.9] | Loss=0.02295 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.435 | L2-Norm(final)=6.246 | 4798.8 samples/s | 75.0 steps/s
[Step=23050 Epoch=45.0] | Loss=0.02243 | Reg=0.00239 | acc=0.9688 | L2-Norm=15.450 | L2-Norm(final)=6.246 | 1468.8 samples/s | 23.0 steps/s
[Step=23100 Epoch=45.1] | Loss=0.02166 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.464 | L2-Norm(final)=6.247 | 3913.6 samples/s | 61.1 steps/s
[Step=23150 Epoch=45.2] | Loss=0.02108 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.477 | L2-Norm(final)=6.248 | 3948.0 samples/s | 61.7 steps/s
[Step=23200 Epoch=45.2] | Loss=0.02045 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.488 | L2-Norm(final)=6.249 | 3981.8 samples/s | 62.2 steps/s
[Step=23250 Epoch=45.3] | Loss=0.02027 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.499 | L2-Norm(final)=6.250 | 3935.1 samples/s | 61.5 steps/s
[Step=23300 Epoch=45.4] | Loss=0.02015 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.509 | L2-Norm(final)=6.251 | 3943.6 samples/s | 61.6 steps/s
[Step=23350 Epoch=45.5] | Loss=0.01978 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.519 | L2-Norm(final)=6.252 | 3927.1 samples/s | 61.4 steps/s
[Step=23400 Epoch=45.6] | Loss=0.01935 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.527 | L2-Norm(final)=6.252 | 3938.6 samples/s | 61.5 steps/s
[Step=23450 Epoch=45.7] | Loss=0.01911 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.536 | L2-Norm(final)=6.253 | 3998.3 samples/s | 62.5 steps/s
[Step=23500 Epoch=45.8] | Loss=0.01886 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.544 | L2-Norm(final)=6.254 | 4154.4 samples/s | 64.9 steps/s
[Step=23550 Epoch=45.9] | Loss=0.01862 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.552 | L2-Norm(final)=6.255 | 1539.3 samples/s | 24.1 steps/s
[Step=23600 Epoch=46.0] | Loss=0.01818 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.559 | L2-Norm(final)=6.255 | 3910.9 samples/s | 61.1 steps/s
[Step=23650 Epoch=46.1] | Loss=0.01787 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.567 | L2-Norm(final)=6.256 | 3938.6 samples/s | 61.5 steps/s
[Step=23700 Epoch=46.2] | Loss=0.01755 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.574 | L2-Norm(final)=6.257 | 3945.9 samples/s | 61.7 steps/s
[Step=23750 Epoch=46.3] | Loss=0.01732 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.580 | L2-Norm(final)=6.258 | 3946.6 samples/s | 61.7 steps/s
[Step=23800 Epoch=46.4] | Loss=0.01728 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.587 | L2-Norm(final)=6.259 | 3939.4 samples/s | 61.6 steps/s
[Step=23850 Epoch=46.5] | Loss=0.01720 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.593 | L2-Norm(final)=6.260 | 3938.0 samples/s | 61.5 steps/s
[Step=23900 Epoch=46.6] | Loss=0.01698 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.600 | L2-Norm(final)=6.260 | 3923.8 samples/s | 61.3 steps/s
[Step=23950 Epoch=46.7] | Loss=0.01683 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.607 | L2-Norm(final)=6.261 | 3949.3 samples/s | 61.7 steps/s
[Step=24000 Epoch=46.8] | Loss=0.01679 | Reg=0.00244 | acc=0.9688 | L2-Norm=15.613 | L2-Norm(final)=6.262 | 3958.2 samples/s | 61.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step24000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=22001 Epoch=43.0] | Loss=0.01550 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.767 | L2-Norm(final)=6.419 | 3200.0 samples/s | 50.0 steps/s
[Step=22050 Epoch=43.1] | Loss=0.02720 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.804 | L2-Norm(final)=6.427 | 4337.6 samples/s | 67.8 steps/s
[Step=22100 Epoch=43.2] | Loss=0.02519 | Reg=0.00220 | acc=0.9688 | L2-Norm=14.844 | L2-Norm(final)=6.440 | 4363.1 samples/s | 68.2 steps/s
[Step=22150 Epoch=43.3] | Loss=0.02343 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.875 | L2-Norm(final)=6.455 | 4404.7 samples/s | 68.8 steps/s
[Step=22200 Epoch=43.4] | Loss=0.02243 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.904 | L2-Norm(final)=6.471 | 4393.7 samples/s | 68.7 steps/s
[Step=22250 Epoch=43.5] | Loss=0.02298 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.930 | L2-Norm(final)=6.484 | 4316.6 samples/s | 67.4 steps/s
[Step=22300 Epoch=43.6] | Loss=0.02227 | Reg=0.00224 | acc=0.9375 | L2-Norm=14.956 | L2-Norm(final)=6.497 | 4326.5 samples/s | 67.6 steps/s
[Step=22350 Epoch=43.7] | Loss=0.02238 | Reg=0.00224 | acc=0.9531 | L2-Norm=14.982 | L2-Norm(final)=6.510 | 4408.7 samples/s | 68.9 steps/s
[Step=22400 Epoch=43.8] | Loss=0.02196 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.006 | L2-Norm(final)=6.522 | 4461.2 samples/s | 69.7 steps/s
[Step=22450 Epoch=43.9] | Loss=0.02210 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.028 | L2-Norm(final)=6.534 | 4377.5 samples/s | 68.4 steps/s
[Step=22500 Epoch=44.0] | Loss=0.02173 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.050 | L2-Norm(final)=6.544 | 5599.1 samples/s | 87.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=44.0] | Loss=0.00684 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.262 | L2-Norm(final)=6.639 | 3211.7 samples/s | 50.2 steps/s
[Step=22550 Epoch=44.1] | Loss=0.01663 | Reg=0.00234 | acc=0.9688 | L2-Norm=15.283 | L2-Norm(final)=6.656 | 3898.4 samples/s | 60.9 steps/s
[Step=22600 Epoch=44.2] | Loss=0.01959 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.306 | L2-Norm(final)=6.661 | 3911.3 samples/s | 61.1 steps/s
[Step=22650 Epoch=44.3] | Loss=0.02102 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.326 | L2-Norm(final)=6.658 | 3953.7 samples/s | 61.8 steps/s
[Step=22700 Epoch=44.4] | Loss=0.02098 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.345 | L2-Norm(final)=6.657 | 3920.9 samples/s | 61.3 steps/s
[Step=22750 Epoch=44.5] | Loss=0.02049 | Reg=0.00236 | acc=0.9688 | L2-Norm=15.363 | L2-Norm(final)=6.657 | 3970.2 samples/s | 62.0 steps/s
[Step=22800 Epoch=44.6] | Loss=0.02085 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.381 | L2-Norm(final)=6.656 | 3905.7 samples/s | 61.0 steps/s
[Step=22850 Epoch=44.7] | Loss=0.02108 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.398 | L2-Norm(final)=6.656 | 3939.9 samples/s | 61.6 steps/s
[Step=22900 Epoch=44.8] | Loss=0.02169 | Reg=0.00238 | acc=0.9688 | L2-Norm=15.415 | L2-Norm(final)=6.653 | 3957.3 samples/s | 61.8 steps/s
[Step=22950 Epoch=44.9] | Loss=0.02208 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.432 | L2-Norm(final)=6.651 | 3975.2 samples/s | 62.1 steps/s
[Step=23000 Epoch=45.0] | Loss=0.02211 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.449 | L2-Norm(final)=6.648 | 4909.1 samples/s | 76.7 steps/s
[Step=23050 Epoch=45.1] | Loss=0.02175 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.465 | L2-Norm(final)=6.646 | 1487.5 samples/s | 23.2 steps/s
[Step=23100 Epoch=45.2] | Loss=0.02090 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.481 | L2-Norm(final)=6.646 | 3931.7 samples/s | 61.4 steps/s
[Step=23150 Epoch=45.3] | Loss=0.02057 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.495 | L2-Norm(final)=6.647 | 3937.1 samples/s | 61.5 steps/s
[Step=23200 Epoch=45.4] | Loss=0.02019 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.509 | L2-Norm(final)=6.647 | 3839.5 samples/s | 60.0 steps/s
[Step=23250 Epoch=45.5] | Loss=0.02000 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.521 | L2-Norm(final)=6.647 | 3951.1 samples/s | 61.7 steps/s
[Step=23300 Epoch=45.6] | Loss=0.01962 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.533 | L2-Norm(final)=6.646 | 3898.4 samples/s | 60.9 steps/s
[Step=23350 Epoch=45.6] | Loss=0.01948 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.544 | L2-Norm(final)=6.646 | 3947.6 samples/s | 61.7 steps/s
[Step=23400 Epoch=45.7] | Loss=0.01923 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.554 | L2-Norm(final)=6.646 | 3893.4 samples/s | 60.8 steps/s
[Step=23450 Epoch=45.8] | Loss=0.01908 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.564 | L2-Norm(final)=6.645 | 3901.0 samples/s | 61.0 steps/s
[Step=23500 Epoch=45.9] | Loss=0.01901 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.574 | L2-Norm(final)=6.645 | 4264.2 samples/s | 66.6 steps/s
[Step=23550 Epoch=46.0] | Loss=0.01881 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.582 | L2-Norm(final)=6.644 | 1582.8 samples/s | 24.7 steps/s
[Step=23600 Epoch=46.1] | Loss=0.01846 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.590 | L2-Norm(final)=6.644 | 3880.8 samples/s | 60.6 steps/s
[Step=23650 Epoch=46.2] | Loss=0.01810 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.598 | L2-Norm(final)=6.643 | 3869.9 samples/s | 60.5 steps/s
[Step=23700 Epoch=46.3] | Loss=0.01794 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.605 | L2-Norm(final)=6.643 | 3939.8 samples/s | 61.6 steps/s
[Step=23750 Epoch=46.4] | Loss=0.01767 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.612 | L2-Norm(final)=6.643 | 3891.7 samples/s | 60.8 steps/s
[Step=23800 Epoch=46.5] | Loss=0.01740 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.619 | L2-Norm(final)=6.643 | 3990.6 samples/s | 62.4 steps/s
[Step=23850 Epoch=46.6] | Loss=0.01724 | Reg=0.00244 | acc=0.9688 | L2-Norm=15.626 | L2-Norm(final)=6.643 | 3913.3 samples/s | 61.1 steps/s
[Step=23900 Epoch=46.7] | Loss=0.01709 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.632 | L2-Norm(final)=6.643 | 3905.3 samples/s | 61.0 steps/s
[Step=23950 Epoch=46.8] | Loss=0.01697 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.638 | L2-Norm(final)=6.643 | 3953.0 samples/s | 61.8 steps/s
[Step=24000 Epoch=46.9] | Loss=0.01677 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.644 | L2-Norm(final)=6.643 | 3920.0 samples/s | 61.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step24000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=22001 Epoch=84.3] | Loss=0.00050 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.767 | L2-Norm(final)=6.243 | 3192.0 samples/s | 49.9 steps/s
[Step=22050 Epoch=84.5] | Loss=0.00205 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.801 | L2-Norm(final)=6.258 | 3845.4 samples/s | 60.1 steps/s
[Step=22100 Epoch=84.7] | Loss=0.00226 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.859 | L2-Norm(final)=6.264 | 4062.7 samples/s | 63.5 steps/s
[Step=22150 Epoch=84.9] | Loss=0.00162 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.897 | L2-Norm(final)=6.268 | 4121.5 samples/s | 64.4 steps/s
[Step=22200 Epoch=85.1] | Loss=0.00137 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.914 | L2-Norm(final)=6.273 | 4188.3 samples/s | 65.4 steps/s
[Step=22250 Epoch=85.3] | Loss=0.00139 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.923 | L2-Norm(final)=6.278 | 5223.3 samples/s | 81.6 steps/s
[Step=22300 Epoch=85.4] | Loss=0.00118 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.932 | L2-Norm(final)=6.281 | 1543.6 samples/s | 24.1 steps/s
[Step=22350 Epoch=85.6] | Loss=0.00102 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.934 | L2-Norm(final)=6.284 | 4064.6 samples/s | 63.5 steps/s
[Step=22400 Epoch=85.8] | Loss=0.00090 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.931 | L2-Norm(final)=6.287 | 4150.2 samples/s | 64.8 steps/s
[Step=22450 Epoch=86.0] | Loss=0.00081 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.926 | L2-Norm(final)=6.291 | 4092.8 samples/s | 64.0 steps/s
[Step=22500 Epoch=86.2] | Loss=0.00074 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.918 | L2-Norm(final)=6.294 | 4575.4 samples/s | 71.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=86.2] | Loss=0.00002 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.837 | L2-Norm(final)=6.328 | 3106.7 samples/s | 48.5 steps/s
[Step=22550 Epoch=86.4] | Loss=0.00004 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.810 | L2-Norm(final)=6.331 | 3560.3 samples/s | 55.6 steps/s
[Step=22600 Epoch=86.6] | Loss=0.00003 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.779 | L2-Norm(final)=6.333 | 3703.2 samples/s | 57.9 steps/s
[Step=22650 Epoch=86.8] | Loss=0.00003 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.747 | L2-Norm(final)=6.335 | 3707.3 samples/s | 57.9 steps/s
[Step=22700 Epoch=87.0] | Loss=0.00002 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.715 | L2-Norm(final)=6.337 | 3768.2 samples/s | 58.9 steps/s
[Step=22750 Epoch=87.2] | Loss=0.00002 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.682 | L2-Norm(final)=6.338 | 4721.5 samples/s | 73.8 steps/s
[Step=22800 Epoch=87.4] | Loss=0.00002 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.650 | L2-Norm(final)=6.340 | 1461.7 samples/s | 22.8 steps/s
[Step=22850 Epoch=87.6] | Loss=0.00002 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.617 | L2-Norm(final)=6.341 | 3738.6 samples/s | 58.4 steps/s
[Step=22900 Epoch=87.7] | Loss=0.00002 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.584 | L2-Norm(final)=6.341 | 3759.7 samples/s | 58.7 steps/s
[Step=22950 Epoch=87.9] | Loss=0.00001 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.551 | L2-Norm(final)=6.342 | 3756.3 samples/s | 58.7 steps/s
[Step=23000 Epoch=88.1] | Loss=0.00001 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.519 | L2-Norm(final)=6.343 | 4086.6 samples/s | 63.9 steps/s
[Step=23050 Epoch=88.3] | Loss=0.00001 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.486 | L2-Norm(final)=6.343 | 1547.6 samples/s | 24.2 steps/s
[Step=23100 Epoch=88.5] | Loss=0.00001 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.453 | L2-Norm(final)=6.344 | 3739.2 samples/s | 58.4 steps/s
[Step=23150 Epoch=88.7] | Loss=0.00001 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.420 | L2-Norm(final)=6.345 | 3739.0 samples/s | 58.4 steps/s
[Step=23200 Epoch=88.9] | Loss=0.00001 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.387 | L2-Norm(final)=6.345 | 3735.3 samples/s | 58.4 steps/s
[Step=23250 Epoch=89.1] | Loss=0.00001 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.353 | L2-Norm(final)=6.346 | 3752.3 samples/s | 58.6 steps/s
[Step=23300 Epoch=89.3] | Loss=0.00001 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.320 | L2-Norm(final)=6.346 | 1601.8 samples/s | 25.0 steps/s
[Step=23350 Epoch=89.5] | Loss=0.00001 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.287 | L2-Norm(final)=6.347 | 3764.5 samples/s | 58.8 steps/s
[Step=23400 Epoch=89.7] | Loss=0.00001 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.254 | L2-Norm(final)=6.347 | 3740.4 samples/s | 58.4 steps/s
[Step=23450 Epoch=89.9] | Loss=0.00001 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.221 | L2-Norm(final)=6.348 | 3747.2 samples/s | 58.6 steps/s
[Step=23500 Epoch=90.0] | Loss=0.00001 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.188 | L2-Norm(final)=6.348 | 3743.9 samples/s | 58.5 steps/s
[Step=23550 Epoch=90.2] | Loss=0.00001 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.154 | L2-Norm(final)=6.349 | 1618.8 samples/s | 25.3 steps/s
[Step=23600 Epoch=90.4] | Loss=0.00001 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=6.349 | 3817.3 samples/s | 59.6 steps/s
[Step=23650 Epoch=90.6] | Loss=0.00001 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.088 | L2-Norm(final)=6.350 | 3712.5 samples/s | 58.0 steps/s
[Step=23700 Epoch=90.8] | Loss=0.00001 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.054 | L2-Norm(final)=6.350 | 3714.8 samples/s | 58.0 steps/s
[Step=23750 Epoch=91.0] | Loss=0.00001 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.021 | L2-Norm(final)=6.351 | 3777.4 samples/s | 59.0 steps/s
[Step=23800 Epoch=91.2] | Loss=0.00001 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.988 | L2-Norm(final)=6.351 | 5132.1 samples/s | 80.2 steps/s
[Step=23850 Epoch=91.4] | Loss=0.00001 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.954 | L2-Norm(final)=6.352 | 1431.7 samples/s | 22.4 steps/s
[Step=23900 Epoch=91.6] | Loss=0.00001 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.920 | L2-Norm(final)=6.352 | 3728.3 samples/s | 58.3 steps/s
[Step=23950 Epoch=91.8] | Loss=0.00001 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.887 | L2-Norm(final)=6.353 | 3698.9 samples/s | 57.8 steps/s
[Step=24000 Epoch=92.0] | Loss=0.00001 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.853 | L2-Norm(final)=6.353 | 3705.4 samples/s | 57.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step24000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=22001 Epoch=84.7] | Loss=0.00087 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.767 | L2-Norm(final)=6.988 | 3253.9 samples/s | 50.8 steps/s
[Step=22050 Epoch=84.9] | Loss=0.00078 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.777 | L2-Norm(final)=6.999 | 3942.6 samples/s | 61.6 steps/s
[Step=22100 Epoch=85.1] | Loss=0.00101 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.792 | L2-Norm(final)=7.006 | 4093.6 samples/s | 64.0 steps/s
[Step=22150 Epoch=85.3] | Loss=0.00076 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.806 | L2-Norm(final)=7.015 | 4106.8 samples/s | 64.2 steps/s
[Step=22200 Epoch=85.5] | Loss=0.00060 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.808 | L2-Norm(final)=7.022 | 4169.9 samples/s | 65.2 steps/s
[Step=22250 Epoch=85.6] | Loss=0.00050 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.802 | L2-Norm(final)=7.030 | 5630.2 samples/s | 88.0 steps/s
[Step=22300 Epoch=85.8] | Loss=0.00045 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.795 | L2-Norm(final)=7.037 | 1545.6 samples/s | 24.2 steps/s
[Step=22350 Epoch=86.0] | Loss=0.00039 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.786 | L2-Norm(final)=7.043 | 4014.2 samples/s | 62.7 steps/s
[Step=22400 Epoch=86.2] | Loss=0.00035 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.775 | L2-Norm(final)=7.049 | 4133.3 samples/s | 64.6 steps/s
[Step=22450 Epoch=86.4] | Loss=0.00032 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.763 | L2-Norm(final)=7.054 | 4204.2 samples/s | 65.7 steps/s
[Step=22500 Epoch=86.6] | Loss=0.00029 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.751 | L2-Norm(final)=7.059 | 4734.6 samples/s | 74.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=86.6] | Loss=0.00006 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.623 | L2-Norm(final)=7.108 | 3174.0 samples/s | 49.6 steps/s
[Step=22550 Epoch=86.8] | Loss=0.00002 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.600 | L2-Norm(final)=7.111 | 3508.8 samples/s | 54.8 steps/s
[Step=22600 Epoch=87.0] | Loss=0.00004 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.575 | L2-Norm(final)=7.114 | 3746.2 samples/s | 58.5 steps/s
[Step=22650 Epoch=87.2] | Loss=0.00003 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.549 | L2-Norm(final)=7.117 | 3750.7 samples/s | 58.6 steps/s
[Step=22700 Epoch=87.4] | Loss=0.00003 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.523 | L2-Norm(final)=7.120 | 3717.3 samples/s | 58.1 steps/s
[Step=22750 Epoch=87.6] | Loss=0.00002 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.497 | L2-Norm(final)=7.121 | 4806.4 samples/s | 75.1 steps/s
[Step=22800 Epoch=87.8] | Loss=0.00002 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.470 | L2-Norm(final)=7.123 | 1446.9 samples/s | 22.6 steps/s
[Step=22850 Epoch=88.0] | Loss=0.00002 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.444 | L2-Norm(final)=7.125 | 3752.2 samples/s | 58.6 steps/s
[Step=22900 Epoch=88.2] | Loss=0.00002 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.417 | L2-Norm(final)=7.126 | 3738.9 samples/s | 58.4 steps/s
[Step=22950 Epoch=88.3] | Loss=0.00002 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.390 | L2-Norm(final)=7.127 | 3742.5 samples/s | 58.5 steps/s
[Step=23000 Epoch=88.5] | Loss=0.00001 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.363 | L2-Norm(final)=7.129 | 4244.2 samples/s | 66.3 steps/s
[Step=23050 Epoch=88.7] | Loss=0.00001 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.336 | L2-Norm(final)=7.130 | 1553.7 samples/s | 24.3 steps/s
[Step=23100 Epoch=88.9] | Loss=0.00001 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.309 | L2-Norm(final)=7.131 | 3738.2 samples/s | 58.4 steps/s
[Step=23150 Epoch=89.1] | Loss=0.00001 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.282 | L2-Norm(final)=7.132 | 3701.5 samples/s | 57.8 steps/s
[Step=23200 Epoch=89.3] | Loss=0.00001 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.255 | L2-Norm(final)=7.133 | 3711.1 samples/s | 58.0 steps/s
[Step=23250 Epoch=89.5] | Loss=0.00001 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.228 | L2-Norm(final)=7.133 | 3829.3 samples/s | 59.8 steps/s
[Step=23300 Epoch=89.7] | Loss=0.00001 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.201 | L2-Norm(final)=7.134 | 1601.2 samples/s | 25.0 steps/s
[Step=23350 Epoch=89.9] | Loss=0.00001 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.174 | L2-Norm(final)=7.135 | 3724.7 samples/s | 58.2 steps/s
[Step=23400 Epoch=90.1] | Loss=0.00001 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.147 | L2-Norm(final)=7.136 | 3782.8 samples/s | 59.1 steps/s
[Step=23450 Epoch=90.3] | Loss=0.00001 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.120 | L2-Norm(final)=7.137 | 3704.2 samples/s | 57.9 steps/s
[Step=23500 Epoch=90.5] | Loss=0.00001 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=7.138 | 3714.9 samples/s | 58.0 steps/s
[Step=23550 Epoch=90.7] | Loss=0.00001 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.065 | L2-Norm(final)=7.139 | 1606.9 samples/s | 25.1 steps/s
[Step=23600 Epoch=90.8] | Loss=0.00001 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.038 | L2-Norm(final)=7.139 | 3743.9 samples/s | 58.5 steps/s
[Step=23650 Epoch=91.0] | Loss=0.00001 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.011 | L2-Norm(final)=7.140 | 3740.6 samples/s | 58.4 steps/s
[Step=23700 Epoch=91.2] | Loss=0.00001 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.983 | L2-Norm(final)=7.141 | 3754.5 samples/s | 58.7 steps/s
[Step=23750 Epoch=91.4] | Loss=0.00001 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.956 | L2-Norm(final)=7.142 | 3702.7 samples/s | 57.9 steps/s
[Step=23800 Epoch=91.6] | Loss=0.00001 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.928 | L2-Norm(final)=7.143 | 5532.9 samples/s | 86.5 steps/s
[Step=23850 Epoch=91.8] | Loss=0.00001 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.900 | L2-Norm(final)=7.144 | 1405.3 samples/s | 22.0 steps/s
[Step=23900 Epoch=92.0] | Loss=0.00001 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.873 | L2-Norm(final)=7.145 | 3707.1 samples/s | 57.9 steps/s
[Step=23950 Epoch=92.2] | Loss=0.00001 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.845 | L2-Norm(final)=7.145 | 3684.6 samples/s | 57.6 steps/s
[Step=24000 Epoch=92.4] | Loss=0.00001 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.817 | L2-Norm(final)=7.146 | 3715.0 samples/s | 58.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06628 | acc=0.9651 | tpr=0.9673 | fpr=0.0396 | 3457.9 samples/s | 13.5 steps/s
Avg test loss: 0.07032, Avg test acc: 0.96386, Avg tpr: 0.96590, Avg fpr: 0.04064, total FA: 317

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06270 | acc=0.9677 | tpr=0.9797 | fpr=0.0582 | 3494.4 samples/s | 13.7 steps/s
Avg test loss: 0.06952, Avg test acc: 0.96614, Avg tpr: 0.97785, Avg fpr: 0.05961, total FA: 465

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.19285 | acc=0.3133 | tpr=0.0202 | fpr=0.0503 | 3494.1 samples/s | 13.6 steps/s
Avg test loss: 6.20015, Avg test acc: 0.31100, Avg tpr: 0.02063, Avg fpr: 0.05038, total FA: 393

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.41115 | acc=0.3160 | tpr=0.0314 | fpr=0.0659 | 3493.3 samples/s | 13.6 steps/s
Avg test loss: 5.41480, Avg test acc: 0.31469, Avg tpr: 0.03322, Avg fpr: 0.06627, total FA: 517

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.55360 | acc=0.1026 | tpr=0.8230 | fpr=0.9104 | 3477.1 samples/s | 13.6 steps/s
[Step= 100] | Loss=5.52564 | acc=0.1044 | tpr=0.8145 | fpr=0.9088 | 7013.3 samples/s | 27.4 steps/s
[Step= 150] | Loss=5.54738 | acc=0.1025 | tpr=0.8040 | fpr=0.9104 | 6958.8 samples/s | 27.2 steps/s
[Step= 200] | Loss=5.53334 | acc=0.1018 | tpr=0.7956 | fpr=0.9108 | 6711.0 samples/s | 26.2 steps/s
[Step= 250] | Loss=5.52744 | acc=0.1021 | tpr=0.7948 | fpr=0.9105 | 7059.8 samples/s | 27.6 steps/s
[Step= 300] | Loss=5.52978 | acc=0.1018 | tpr=0.7971 | fpr=0.9109 | 6635.0 samples/s | 25.9 steps/s
[Step= 350] | Loss=5.52589 | acc=0.1025 | tpr=0.8015 | fpr=0.9102 | 6887.9 samples/s | 26.9 steps/s
[Step= 400] | Loss=5.52271 | acc=0.1025 | tpr=0.7976 | fpr=0.9101 | 7014.3 samples/s | 27.4 steps/s
[Step= 450] | Loss=5.52891 | acc=0.1021 | tpr=0.7994 | fpr=0.9105 | 6648.8 samples/s | 26.0 steps/s
[Step= 500] | Loss=5.53050 | acc=0.1023 | tpr=0.7956 | fpr=0.9102 | 6849.7 samples/s | 26.8 steps/s
[Step= 550] | Loss=5.52873 | acc=0.1026 | tpr=0.7979 | fpr=0.9101 | 11942.4 samples/s | 46.7 steps/s
Avg test loss: 5.53056, Avg test acc: 0.10250, Avg tpr: 0.79794, Avg fpr: 0.91014, total FA: 126371

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.87584 | acc=0.0918 | tpr=0.8186 | fpr=0.9213 | 3494.0 samples/s | 13.6 steps/s
[Step= 100] | Loss=6.83924 | acc=0.0916 | tpr=0.8188 | fpr=0.9220 | 6874.6 samples/s | 26.9 steps/s
[Step= 150] | Loss=6.85540 | acc=0.0921 | tpr=0.8199 | fpr=0.9213 | 6857.3 samples/s | 26.8 steps/s
[Step= 200] | Loss=6.84681 | acc=0.0915 | tpr=0.8077 | fpr=0.9215 | 7005.8 samples/s | 27.4 steps/s
[Step= 250] | Loss=6.84621 | acc=0.0914 | tpr=0.8009 | fpr=0.9216 | 6876.0 samples/s | 26.9 steps/s
[Step= 300] | Loss=6.85152 | acc=0.0911 | tpr=0.8015 | fpr=0.9218 | 6706.0 samples/s | 26.2 steps/s
[Step= 350] | Loss=6.85080 | acc=0.0914 | tpr=0.8059 | fpr=0.9216 | 6979.2 samples/s | 27.3 steps/s
[Step= 400] | Loss=6.84719 | acc=0.0916 | tpr=0.8053 | fpr=0.9214 | 6793.0 samples/s | 26.5 steps/s
[Step= 450] | Loss=6.85542 | acc=0.0911 | tpr=0.8072 | fpr=0.9219 | 6875.5 samples/s | 26.9 steps/s
[Step= 500] | Loss=6.85667 | acc=0.0912 | tpr=0.8088 | fpr=0.9217 | 6750.7 samples/s | 26.4 steps/s
[Step= 550] | Loss=6.85657 | acc=0.0916 | tpr=0.8142 | fpr=0.9216 | 12344.2 samples/s | 48.2 steps/s
Avg test loss: 6.85796, Avg test acc: 0.09151, Avg tpr: 0.81379, Avg fpr: 0.92162, total FA: 127965

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11813 | acc=0.9824 | tpr=0.9381 | fpr=0.0168 | 3479.4 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.12301 | acc=0.9816 | tpr=0.9531 | fpr=0.0178 | 6990.2 samples/s | 27.3 steps/s
[Step= 150] | Loss=0.12681 | acc=0.9809 | tpr=0.9510 | fpr=0.0185 | 6821.5 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.12809 | acc=0.9811 | tpr=0.9530 | fpr=0.0184 | 6869.9 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.12499 | acc=0.9815 | tpr=0.9493 | fpr=0.0179 | 6901.5 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.12716 | acc=0.9810 | tpr=0.9491 | fpr=0.0184 | 6849.5 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.12703 | acc=0.9810 | tpr=0.9493 | fpr=0.0185 | 6806.1 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.12892 | acc=0.9807 | tpr=0.9437 | fpr=0.0186 | 6779.7 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.13116 | acc=0.9805 | tpr=0.9421 | fpr=0.0188 | 6846.7 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.13082 | acc=0.9806 | tpr=0.9445 | fpr=0.0188 | 6881.7 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.12991 | acc=0.9808 | tpr=0.9431 | fpr=0.0185 | 12865.6 samples/s | 50.3 steps/s
Avg test loss: 0.12988, Avg test acc: 0.98078, Avg tpr: 0.94255, Avg fpr: 0.01852, total FA: 2572

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11524 | acc=0.9809 | tpr=0.9336 | fpr=0.0182 | 3487.5 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.11948 | acc=0.9808 | tpr=0.9531 | fpr=0.0187 | 6752.1 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.12272 | acc=0.9800 | tpr=0.9597 | fpr=0.0196 | 6815.9 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.12378 | acc=0.9801 | tpr=0.9596 | fpr=0.0195 | 7017.9 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.12179 | acc=0.9805 | tpr=0.9572 | fpr=0.0191 | 6763.7 samples/s | 26.4 steps/s
[Step= 300] | Loss=0.12446 | acc=0.9800 | tpr=0.9542 | fpr=0.0195 | 6760.4 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.12424 | acc=0.9801 | tpr=0.9549 | fpr=0.0195 | 6741.1 samples/s | 26.3 steps/s
[Step= 400] | Loss=0.12602 | acc=0.9798 | tpr=0.9519 | fpr=0.0197 | 6845.4 samples/s | 26.7 steps/s
[Step= 450] | Loss=0.12815 | acc=0.9796 | tpr=0.9513 | fpr=0.0199 | 6671.8 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.12758 | acc=0.9796 | tpr=0.9533 | fpr=0.0199 | 6678.9 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.12666 | acc=0.9798 | tpr=0.9526 | fpr=0.0198 | 12295.8 samples/s | 48.0 steps/s
Avg test loss: 0.12663, Avg test acc: 0.97973, Avg tpr: 0.95206, Avg fpr: 0.01976, total FA: 2744

server round 12/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=24001 Epoch=46.8] | Loss=0.01454 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.968 | L2-Norm(final)=6.288 | 3056.9 samples/s | 47.8 steps/s
[Step=24050 Epoch=46.9] | Loss=0.01517 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.997 | L2-Norm(final)=6.292 | 4283.8 samples/s | 66.9 steps/s
[Step=24100 Epoch=47.0] | Loss=0.01555 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.019 | L2-Norm(final)=6.300 | 4311.5 samples/s | 67.4 steps/s
[Step=24150 Epoch=47.1] | Loss=0.01511 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.037 | L2-Norm(final)=6.310 | 4302.0 samples/s | 67.2 steps/s
[Step=24200 Epoch=47.2] | Loss=0.01536 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.055 | L2-Norm(final)=6.318 | 4359.1 samples/s | 68.1 steps/s
[Step=24250 Epoch=47.3] | Loss=0.01533 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.073 | L2-Norm(final)=6.325 | 4417.8 samples/s | 69.0 steps/s
[Step=24300 Epoch=47.4] | Loss=0.01527 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.092 | L2-Norm(final)=6.332 | 4413.0 samples/s | 69.0 steps/s
[Step=24350 Epoch=47.5] | Loss=0.01514 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.109 | L2-Norm(final)=6.339 | 4338.5 samples/s | 67.8 steps/s
[Step=24400 Epoch=47.6] | Loss=0.01502 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.126 | L2-Norm(final)=6.346 | 4410.5 samples/s | 68.9 steps/s
[Step=24450 Epoch=47.7] | Loss=0.01471 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.142 | L2-Norm(final)=6.353 | 4348.8 samples/s | 67.9 steps/s
[Step=24500 Epoch=47.8] | Loss=0.01481 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.157 | L2-Norm(final)=6.360 | 5434.2 samples/s | 84.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=47.8] | Loss=0.00484 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.311 | L2-Norm(final)=6.423 | 3442.9 samples/s | 53.8 steps/s
[Step=24550 Epoch=47.9] | Loss=0.01221 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.328 | L2-Norm(final)=6.431 | 3454.2 samples/s | 54.0 steps/s
[Step=24600 Epoch=48.0] | Loss=0.01493 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.349 | L2-Norm(final)=6.436 | 3969.0 samples/s | 62.0 steps/s
[Step=24650 Epoch=48.1] | Loss=0.01712 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.373 | L2-Norm(final)=6.436 | 3890.7 samples/s | 60.8 steps/s
[Step=24700 Epoch=48.2] | Loss=0.01831 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.398 | L2-Norm(final)=6.438 | 3967.8 samples/s | 62.0 steps/s
[Step=24750 Epoch=48.3] | Loss=0.01826 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.421 | L2-Norm(final)=6.441 | 3930.3 samples/s | 61.4 steps/s
[Step=24800 Epoch=48.4] | Loss=0.01871 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.444 | L2-Norm(final)=6.442 | 3930.7 samples/s | 61.4 steps/s
[Step=24850 Epoch=48.5] | Loss=0.01917 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.468 | L2-Norm(final)=6.443 | 3912.6 samples/s | 61.1 steps/s
[Step=24900 Epoch=48.6] | Loss=0.01931 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.489 | L2-Norm(final)=6.444 | 3958.6 samples/s | 61.9 steps/s
[Step=24950 Epoch=48.7] | Loss=0.01951 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.509 | L2-Norm(final)=6.445 | 3926.2 samples/s | 61.3 steps/s
[Step=25000 Epoch=48.8] | Loss=0.01957 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.527 | L2-Norm(final)=6.445 | 4786.0 samples/s | 74.8 steps/s
[Step=25050 Epoch=48.9] | Loss=0.01927 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.544 | L2-Norm(final)=6.446 | 1507.3 samples/s | 23.6 steps/s
[Step=25100 Epoch=49.0] | Loss=0.01881 | Reg=0.00212 | acc=0.9375 | L2-Norm=14.561 | L2-Norm(final)=6.448 | 3926.8 samples/s | 61.4 steps/s
[Step=25150 Epoch=49.1] | Loss=0.01838 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.576 | L2-Norm(final)=6.450 | 3940.9 samples/s | 61.6 steps/s
[Step=25200 Epoch=49.1] | Loss=0.01801 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.591 | L2-Norm(final)=6.452 | 3940.6 samples/s | 61.6 steps/s
[Step=25250 Epoch=49.2] | Loss=0.01788 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.605 | L2-Norm(final)=6.454 | 3948.2 samples/s | 61.7 steps/s
[Step=25300 Epoch=49.3] | Loss=0.01772 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.619 | L2-Norm(final)=6.455 | 3958.7 samples/s | 61.9 steps/s
[Step=25350 Epoch=49.4] | Loss=0.01769 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.633 | L2-Norm(final)=6.457 | 3947.6 samples/s | 61.7 steps/s
[Step=25400 Epoch=49.5] | Loss=0.01766 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.646 | L2-Norm(final)=6.459 | 4008.8 samples/s | 62.6 steps/s
[Step=25450 Epoch=49.6] | Loss=0.01751 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.659 | L2-Norm(final)=6.460 | 3961.0 samples/s | 61.9 steps/s
[Step=25500 Epoch=49.7] | Loss=0.01736 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.672 | L2-Norm(final)=6.462 | 4188.1 samples/s | 65.4 steps/s
[Step=25550 Epoch=49.8] | Loss=0.01711 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.684 | L2-Norm(final)=6.464 | 1571.2 samples/s | 24.6 steps/s
[Step=25600 Epoch=49.9] | Loss=0.01696 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.696 | L2-Norm(final)=6.466 | 3918.9 samples/s | 61.2 steps/s
[Step=25650 Epoch=50.0] | Loss=0.01680 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.708 | L2-Norm(final)=6.467 | 3967.6 samples/s | 62.0 steps/s
[Step=25700 Epoch=50.1] | Loss=0.01649 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.720 | L2-Norm(final)=6.469 | 3881.6 samples/s | 60.7 steps/s
[Step=25750 Epoch=50.2] | Loss=0.01625 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.731 | L2-Norm(final)=6.471 | 3928.1 samples/s | 61.4 steps/s
[Step=25800 Epoch=50.3] | Loss=0.01612 | Reg=0.00217 | acc=0.9688 | L2-Norm=14.741 | L2-Norm(final)=6.473 | 3922.4 samples/s | 61.3 steps/s
[Step=25850 Epoch=50.4] | Loss=0.01595 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.751 | L2-Norm(final)=6.475 | 3969.1 samples/s | 62.0 steps/s
[Step=25900 Epoch=50.5] | Loss=0.01576 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.761 | L2-Norm(final)=6.477 | 3961.4 samples/s | 61.9 steps/s
[Step=25950 Epoch=50.6] | Loss=0.01572 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.770 | L2-Norm(final)=6.478 | 3924.8 samples/s | 61.3 steps/s
[Step=26000 Epoch=50.7] | Loss=0.01562 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.780 | L2-Norm(final)=6.480 | 3936.1 samples/s | 61.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step26000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=24001 Epoch=46.9] | Loss=0.00342 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.968 | L2-Norm(final)=6.648 | 3141.8 samples/s | 49.1 steps/s
[Step=24050 Epoch=47.0] | Loss=0.01722 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.999 | L2-Norm(final)=6.652 | 4357.6 samples/s | 68.1 steps/s
[Step=24100 Epoch=47.1] | Loss=0.01716 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.030 | L2-Norm(final)=6.659 | 4384.2 samples/s | 68.5 steps/s
[Step=24150 Epoch=47.2] | Loss=0.01591 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.054 | L2-Norm(final)=6.668 | 4330.6 samples/s | 67.7 steps/s
[Step=24200 Epoch=47.3] | Loss=0.01559 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.073 | L2-Norm(final)=6.676 | 4384.7 samples/s | 68.5 steps/s
[Step=24250 Epoch=47.4] | Loss=0.01481 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.091 | L2-Norm(final)=6.684 | 4387.0 samples/s | 68.5 steps/s
[Step=24300 Epoch=47.5] | Loss=0.01490 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.107 | L2-Norm(final)=6.692 | 4436.1 samples/s | 69.3 steps/s
[Step=24350 Epoch=47.6] | Loss=0.01463 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.123 | L2-Norm(final)=6.700 | 4378.5 samples/s | 68.4 steps/s
[Step=24400 Epoch=47.7] | Loss=0.01443 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.139 | L2-Norm(final)=6.708 | 4304.5 samples/s | 67.3 steps/s
[Step=24450 Epoch=47.8] | Loss=0.01467 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.154 | L2-Norm(final)=6.716 | 4336.1 samples/s | 67.8 steps/s
[Step=24500 Epoch=47.9] | Loss=0.01480 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.170 | L2-Norm(final)=6.722 | 5552.2 samples/s | 86.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=47.9] | Loss=0.02754 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.323 | L2-Norm(final)=6.782 | 3191.4 samples/s | 49.9 steps/s
[Step=24550 Epoch=48.0] | Loss=0.01543 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.342 | L2-Norm(final)=6.787 | 3900.6 samples/s | 60.9 steps/s
[Step=24600 Epoch=48.1] | Loss=0.01604 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.366 | L2-Norm(final)=6.788 | 3916.6 samples/s | 61.2 steps/s
[Step=24650 Epoch=48.2] | Loss=0.01780 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.391 | L2-Norm(final)=6.793 | 3942.9 samples/s | 61.6 steps/s
[Step=24700 Epoch=48.3] | Loss=0.01939 | Reg=0.00208 | acc=0.9531 | L2-Norm=14.415 | L2-Norm(final)=6.791 | 3968.7 samples/s | 62.0 steps/s
[Step=24750 Epoch=48.4] | Loss=0.02016 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.439 | L2-Norm(final)=6.790 | 3946.7 samples/s | 61.7 steps/s
[Step=24800 Epoch=48.5] | Loss=0.01999 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.465 | L2-Norm(final)=6.792 | 3978.0 samples/s | 62.2 steps/s
[Step=24850 Epoch=48.6] | Loss=0.02010 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.489 | L2-Norm(final)=6.793 | 3964.0 samples/s | 61.9 steps/s
[Step=24900 Epoch=48.7] | Loss=0.02073 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.512 | L2-Norm(final)=6.794 | 3995.7 samples/s | 62.4 steps/s
[Step=24950 Epoch=48.8] | Loss=0.02044 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.534 | L2-Norm(final)=6.795 | 3906.4 samples/s | 61.0 steps/s
[Step=25000 Epoch=48.9] | Loss=0.02034 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.556 | L2-Norm(final)=6.796 | 4924.3 samples/s | 76.9 steps/s
[Step=25050 Epoch=49.0] | Loss=0.01978 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.576 | L2-Norm(final)=6.797 | 1507.2 samples/s | 23.6 steps/s
[Step=25100 Epoch=49.1] | Loss=0.01916 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.594 | L2-Norm(final)=6.799 | 3886.9 samples/s | 60.7 steps/s
[Step=25150 Epoch=49.2] | Loss=0.01909 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.610 | L2-Norm(final)=6.801 | 3934.9 samples/s | 61.5 steps/s
[Step=25200 Epoch=49.3] | Loss=0.01899 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.625 | L2-Norm(final)=6.801 | 3927.8 samples/s | 61.4 steps/s
[Step=25250 Epoch=49.4] | Loss=0.01867 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.639 | L2-Norm(final)=6.801 | 3971.0 samples/s | 62.0 steps/s
[Step=25300 Epoch=49.5] | Loss=0.01836 | Reg=0.00215 | acc=0.9531 | L2-Norm=14.652 | L2-Norm(final)=6.803 | 3948.4 samples/s | 61.7 steps/s
[Step=25350 Epoch=49.6] | Loss=0.01839 | Reg=0.00215 | acc=0.9531 | L2-Norm=14.665 | L2-Norm(final)=6.804 | 3946.6 samples/s | 61.7 steps/s
[Step=25400 Epoch=49.7] | Loss=0.01821 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.678 | L2-Norm(final)=6.805 | 3955.0 samples/s | 61.8 steps/s
[Step=25450 Epoch=49.8] | Loss=0.01797 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.691 | L2-Norm(final)=6.806 | 3959.2 samples/s | 61.9 steps/s
[Step=25500 Epoch=49.9] | Loss=0.01773 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.703 | L2-Norm(final)=6.807 | 4333.4 samples/s | 67.7 steps/s
[Step=25550 Epoch=49.9] | Loss=0.01750 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.714 | L2-Norm(final)=6.808 | 1544.6 samples/s | 24.1 steps/s
[Step=25600 Epoch=50.0] | Loss=0.01709 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.725 | L2-Norm(final)=6.810 | 3975.7 samples/s | 62.1 steps/s
[Step=25650 Epoch=50.1] | Loss=0.01689 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.736 | L2-Norm(final)=6.811 | 3939.3 samples/s | 61.6 steps/s
[Step=25700 Epoch=50.2] | Loss=0.01670 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.746 | L2-Norm(final)=6.813 | 3908.8 samples/s | 61.1 steps/s
[Step=25750 Epoch=50.3] | Loss=0.01650 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.755 | L2-Norm(final)=6.814 | 4009.8 samples/s | 62.7 steps/s
[Step=25800 Epoch=50.4] | Loss=0.01629 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.764 | L2-Norm(final)=6.815 | 3965.2 samples/s | 62.0 steps/s
[Step=25850 Epoch=50.5] | Loss=0.01606 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.773 | L2-Norm(final)=6.816 | 3935.6 samples/s | 61.5 steps/s
[Step=25900 Epoch=50.6] | Loss=0.01593 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.782 | L2-Norm(final)=6.818 | 3907.4 samples/s | 61.1 steps/s
[Step=25950 Epoch=50.7] | Loss=0.01582 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.791 | L2-Norm(final)=6.819 | 4016.0 samples/s | 62.8 steps/s
[Step=26000 Epoch=50.8] | Loss=0.01571 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.799 | L2-Norm(final)=6.820 | 3922.1 samples/s | 61.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step26000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=24001 Epoch=92.0] | Loss=0.00091 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.968 | L2-Norm(final)=6.369 | 3186.7 samples/s | 49.8 steps/s
[Step=24050 Epoch=92.2] | Loss=0.00344 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.087 | L2-Norm(final)=6.376 | 3843.9 samples/s | 60.1 steps/s
[Step=24100 Epoch=92.3] | Loss=0.00307 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.193 | L2-Norm(final)=6.377 | 4095.2 samples/s | 64.0 steps/s
[Step=24150 Epoch=92.5] | Loss=0.00244 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.249 | L2-Norm(final)=6.378 | 4058.9 samples/s | 63.4 steps/s
[Step=24200 Epoch=92.7] | Loss=0.00191 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.279 | L2-Norm(final)=6.380 | 4217.2 samples/s | 65.9 steps/s
[Step=24250 Epoch=92.9] | Loss=0.00162 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.294 | L2-Norm(final)=6.383 | 5194.0 samples/s | 81.2 steps/s
[Step=24300 Epoch=93.1] | Loss=0.00138 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.304 | L2-Norm(final)=6.388 | 1507.0 samples/s | 23.5 steps/s
[Step=24350 Epoch=93.3] | Loss=0.00121 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.308 | L2-Norm(final)=6.391 | 4072.3 samples/s | 63.6 steps/s
[Step=24400 Epoch=93.5] | Loss=0.00107 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.308 | L2-Norm(final)=6.395 | 4089.9 samples/s | 63.9 steps/s
[Step=24450 Epoch=93.7] | Loss=0.00096 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.307 | L2-Norm(final)=6.399 | 4100.1 samples/s | 64.1 steps/s
[Step=24500 Epoch=93.9] | Loss=0.00087 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.304 | L2-Norm(final)=6.402 | 4626.3 samples/s | 72.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=93.9] | Loss=0.00001 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.266 | L2-Norm(final)=6.434 | 3128.7 samples/s | 48.9 steps/s
[Step=24550 Epoch=94.1] | Loss=0.00347 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.253 | L2-Norm(final)=6.436 | 3659.0 samples/s | 57.2 steps/s
[Step=24600 Epoch=94.3] | Loss=0.01414 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.379 | L2-Norm(final)=6.388 | 3728.3 samples/s | 58.3 steps/s
[Step=24650 Epoch=94.5] | Loss=0.01041 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.471 | L2-Norm(final)=6.356 | 3720.7 samples/s | 58.1 steps/s
[Step=24700 Epoch=94.6] | Loss=0.00806 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.516 | L2-Norm(final)=6.341 | 3660.1 samples/s | 57.2 steps/s
[Step=24750 Epoch=94.8] | Loss=0.00649 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.540 | L2-Norm(final)=6.333 | 4696.3 samples/s | 73.4 steps/s
[Step=24800 Epoch=95.0] | Loss=0.00544 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.553 | L2-Norm(final)=6.328 | 1431.0 samples/s | 22.4 steps/s
[Step=24850 Epoch=95.2] | Loss=0.00467 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.560 | L2-Norm(final)=6.326 | 3759.6 samples/s | 58.7 steps/s
[Step=24900 Epoch=95.4] | Loss=0.00409 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.562 | L2-Norm(final)=6.324 | 3682.0 samples/s | 57.5 steps/s
[Step=24950 Epoch=95.6] | Loss=0.00364 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.562 | L2-Norm(final)=6.323 | 3726.5 samples/s | 58.2 steps/s
[Step=25000 Epoch=95.8] | Loss=0.00328 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.559 | L2-Norm(final)=6.322 | 4109.5 samples/s | 64.2 steps/s
[Step=25050 Epoch=96.0] | Loss=0.00298 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.555 | L2-Norm(final)=6.321 | 1509.6 samples/s | 23.6 steps/s
[Step=25100 Epoch=96.2] | Loss=0.00274 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.551 | L2-Norm(final)=6.321 | 3721.5 samples/s | 58.1 steps/s
[Step=25150 Epoch=96.4] | Loss=0.00253 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.545 | L2-Norm(final)=6.321 | 3663.1 samples/s | 57.2 steps/s
[Step=25200 Epoch=96.6] | Loss=0.00235 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.538 | L2-Norm(final)=6.321 | 3741.4 samples/s | 58.5 steps/s
[Step=25250 Epoch=96.7] | Loss=0.00219 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.531 | L2-Norm(final)=6.321 | 3687.6 samples/s | 57.6 steps/s
[Step=25300 Epoch=96.9] | Loss=0.00206 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.524 | L2-Norm(final)=6.321 | 1556.2 samples/s | 24.3 steps/s
[Step=25350 Epoch=97.1] | Loss=0.00194 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.516 | L2-Norm(final)=6.322 | 3791.0 samples/s | 59.2 steps/s
[Step=25400 Epoch=97.3] | Loss=0.00183 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.508 | L2-Norm(final)=6.322 | 3759.0 samples/s | 58.7 steps/s
[Step=25450 Epoch=97.5] | Loss=0.00173 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.500 | L2-Norm(final)=6.323 | 3728.2 samples/s | 58.3 steps/s
[Step=25500 Epoch=97.7] | Loss=0.00165 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.491 | L2-Norm(final)=6.324 | 3715.1 samples/s | 58.0 steps/s
[Step=25550 Epoch=97.9] | Loss=0.00157 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.482 | L2-Norm(final)=6.324 | 1609.6 samples/s | 25.2 steps/s
[Step=25600 Epoch=98.1] | Loss=0.00150 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.473 | L2-Norm(final)=6.325 | 3760.4 samples/s | 58.8 steps/s
[Step=25650 Epoch=98.3] | Loss=0.00143 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.464 | L2-Norm(final)=6.326 | 3673.3 samples/s | 57.4 steps/s
[Step=25700 Epoch=98.5] | Loss=0.00137 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.455 | L2-Norm(final)=6.327 | 3735.4 samples/s | 58.4 steps/s
[Step=25750 Epoch=98.7] | Loss=0.00132 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.445 | L2-Norm(final)=6.328 | 3794.6 samples/s | 59.3 steps/s
[Step=25800 Epoch=98.9] | Loss=0.00127 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.435 | L2-Norm(final)=6.328 | 5053.1 samples/s | 79.0 steps/s
[Step=25850 Epoch=99.0] | Loss=0.00122 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.425 | L2-Norm(final)=6.330 | 1405.8 samples/s | 22.0 steps/s
[Step=25900 Epoch=99.2] | Loss=0.00118 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.416 | L2-Norm(final)=6.331 | 3729.9 samples/s | 58.3 steps/s
[Step=25950 Epoch=99.4] | Loss=0.00114 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.405 | L2-Norm(final)=6.332 | 3727.5 samples/s | 58.2 steps/s
[Step=26000 Epoch=99.6] | Loss=0.00110 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.395 | L2-Norm(final)=6.333 | 3703.9 samples/s | 57.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step26000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=24001 Epoch=92.4] | Loss=0.01703 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.968 | L2-Norm(final)=7.173 | 3104.3 samples/s | 48.5 steps/s
[Step=24050 Epoch=92.6] | Loss=0.00212 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.090 | L2-Norm(final)=7.173 | 4094.3 samples/s | 64.0 steps/s
[Step=24100 Epoch=92.8] | Loss=0.00321 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.188 | L2-Norm(final)=7.171 | 4134.7 samples/s | 64.6 steps/s
[Step=24150 Epoch=93.0] | Loss=0.00267 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.266 | L2-Norm(final)=7.167 | 4164.8 samples/s | 65.1 steps/s
[Step=24200 Epoch=93.2] | Loss=0.00209 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.309 | L2-Norm(final)=7.167 | 4117.9 samples/s | 64.3 steps/s
[Step=24250 Epoch=93.3] | Loss=0.00180 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.331 | L2-Norm(final)=7.169 | 5467.7 samples/s | 85.4 steps/s
[Step=24300 Epoch=93.5] | Loss=0.00154 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.347 | L2-Norm(final)=7.170 | 1516.7 samples/s | 23.7 steps/s
[Step=24350 Epoch=93.7] | Loss=0.00134 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.356 | L2-Norm(final)=7.173 | 4099.9 samples/s | 64.1 steps/s
[Step=24400 Epoch=93.9] | Loss=0.00118 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.361 | L2-Norm(final)=7.175 | 4148.0 samples/s | 64.8 steps/s
[Step=24450 Epoch=94.1] | Loss=0.00105 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.362 | L2-Norm(final)=7.177 | 4098.8 samples/s | 64.0 steps/s
[Step=24500 Epoch=94.3] | Loss=0.00095 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.361 | L2-Norm(final)=7.179 | 4772.2 samples/s | 74.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=94.3] | Loss=0.00000 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.342 | L2-Norm(final)=7.200 | 3306.1 samples/s | 51.7 steps/s
[Step=24550 Epoch=94.5] | Loss=0.00003 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.316 | L2-Norm(final)=7.202 | 3388.9 samples/s | 53.0 steps/s
[Step=24600 Epoch=94.7] | Loss=0.00003 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.287 | L2-Norm(final)=7.203 | 3758.3 samples/s | 58.7 steps/s
[Step=24650 Epoch=94.9] | Loss=0.00168 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.258 | L2-Norm(final)=7.204 | 3796.6 samples/s | 59.3 steps/s
[Step=24700 Epoch=95.1] | Loss=0.00679 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.298 | L2-Norm(final)=7.182 | 3761.2 samples/s | 58.8 steps/s
[Step=24750 Epoch=95.3] | Loss=0.00621 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.350 | L2-Norm(final)=7.158 | 4798.5 samples/s | 75.0 steps/s
[Step=24800 Epoch=95.5] | Loss=0.00529 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.386 | L2-Norm(final)=7.142 | 1444.9 samples/s | 22.6 steps/s
[Step=24850 Epoch=95.7] | Loss=0.00461 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.410 | L2-Norm(final)=7.131 | 3760.3 samples/s | 58.8 steps/s
[Step=24900 Epoch=95.8] | Loss=0.00406 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.426 | L2-Norm(final)=7.124 | 3722.8 samples/s | 58.2 steps/s
[Step=24950 Epoch=96.0] | Loss=0.00371 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.437 | L2-Norm(final)=7.118 | 3715.1 samples/s | 58.0 steps/s
[Step=25000 Epoch=96.2] | Loss=0.00338 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.445 | L2-Norm(final)=7.114 | 4188.7 samples/s | 65.4 steps/s
[Step=25050 Epoch=96.4] | Loss=0.00308 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.450 | L2-Norm(final)=7.110 | 1487.5 samples/s | 23.2 steps/s
[Step=25100 Epoch=96.6] | Loss=0.00283 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.454 | L2-Norm(final)=7.107 | 3691.5 samples/s | 57.7 steps/s
[Step=25150 Epoch=96.8] | Loss=0.00261 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.455 | L2-Norm(final)=7.105 | 3702.9 samples/s | 57.9 steps/s
[Step=25200 Epoch=97.0] | Loss=0.00243 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.455 | L2-Norm(final)=7.103 | 3763.5 samples/s | 58.8 steps/s
[Step=25250 Epoch=97.2] | Loss=0.00227 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.454 | L2-Norm(final)=7.101 | 3829.1 samples/s | 59.8 steps/s
[Step=25300 Epoch=97.4] | Loss=0.00213 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.451 | L2-Norm(final)=7.100 | 1602.3 samples/s | 25.0 steps/s
[Step=25350 Epoch=97.6] | Loss=0.00200 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.448 | L2-Norm(final)=7.099 | 3779.1 samples/s | 59.0 steps/s
[Step=25400 Epoch=97.8] | Loss=0.00189 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.445 | L2-Norm(final)=7.098 | 3714.1 samples/s | 58.0 steps/s
[Step=25450 Epoch=98.0] | Loss=0.00179 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.440 | L2-Norm(final)=7.097 | 3755.3 samples/s | 58.7 steps/s
[Step=25500 Epoch=98.2] | Loss=0.00170 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.436 | L2-Norm(final)=7.097 | 3737.8 samples/s | 58.4 steps/s
[Step=25550 Epoch=98.4] | Loss=0.00162 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.430 | L2-Norm(final)=7.096 | 1615.0 samples/s | 25.2 steps/s
[Step=25600 Epoch=98.5] | Loss=0.00155 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.425 | L2-Norm(final)=7.096 | 3790.6 samples/s | 59.2 steps/s
[Step=25650 Epoch=98.7] | Loss=0.00148 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.419 | L2-Norm(final)=7.096 | 3729.4 samples/s | 58.3 steps/s
[Step=25700 Epoch=98.9] | Loss=0.00142 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.413 | L2-Norm(final)=7.096 | 3752.3 samples/s | 58.6 steps/s
[Step=25750 Epoch=99.1] | Loss=0.00137 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.406 | L2-Norm(final)=7.095 | 3760.8 samples/s | 58.8 steps/s
[Step=25800 Epoch=99.3] | Loss=0.00131 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.400 | L2-Norm(final)=7.095 | 5503.1 samples/s | 86.0 steps/s
[Step=25850 Epoch=99.5] | Loss=0.00127 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.393 | L2-Norm(final)=7.095 | 1393.4 samples/s | 21.8 steps/s
[Step=25900 Epoch=99.7] | Loss=0.00122 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.386 | L2-Norm(final)=7.095 | 3751.6 samples/s | 58.6 steps/s
[Step=25950 Epoch=99.9] | Loss=0.00118 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.378 | L2-Norm(final)=7.095 | 3706.0 samples/s | 57.9 steps/s
[Step=26000 Epoch=100.1] | Loss=0.00114 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.371 | L2-Norm(final)=7.095 | 3737.6 samples/s | 58.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step26000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06378 | acc=0.9659 | tpr=0.9686 | fpr=0.0399 | 3493.1 samples/s | 13.6 steps/s
Avg test loss: 0.06689, Avg test acc: 0.96386, Avg tpr: 0.96596, Avg fpr: 0.04076, total FA: 318

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06583 | acc=0.9651 | tpr=0.9728 | fpr=0.0518 | 3536.1 samples/s | 13.8 steps/s
Avg test loss: 0.07401, Avg test acc: 0.96282, Avg tpr: 0.97086, Avg fpr: 0.05486, total FA: 428

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.50690 | acc=0.3083 | tpr=0.0171 | fpr=0.0595 | 3531.2 samples/s | 13.8 steps/s
Avg test loss: 5.51138, Avg test acc: 0.30603, Avg tpr: 0.01719, Avg fpr: 0.05871, total FA: 458

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.19474 | acc=0.3159 | tpr=0.0278 | fpr=0.0587 | 3477.1 samples/s | 13.6 steps/s
Avg test loss: 5.19172, Avg test acc: 0.31361, Avg tpr: 0.02757, Avg fpr: 0.05730, total FA: 447

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.91842 | acc=0.1139 | tpr=0.7876 | fpr=0.8982 | 3492.8 samples/s | 13.6 steps/s
[Step= 100] | Loss=4.88709 | acc=0.1141 | tpr=0.7825 | fpr=0.8983 | 6810.7 samples/s | 26.6 steps/s
[Step= 150] | Loss=4.89520 | acc=0.1127 | tpr=0.7839 | fpr=0.8996 | 6903.9 samples/s | 27.0 steps/s
[Step= 200] | Loss=4.88580 | acc=0.1123 | tpr=0.7716 | fpr=0.8997 | 6749.1 samples/s | 26.4 steps/s
[Step= 250] | Loss=4.88114 | acc=0.1124 | tpr=0.7712 | fpr=0.8996 | 6829.5 samples/s | 26.7 steps/s
[Step= 300] | Loss=4.88270 | acc=0.1125 | tpr=0.7724 | fpr=0.8996 | 6709.4 samples/s | 26.2 steps/s
[Step= 350] | Loss=4.88020 | acc=0.1126 | tpr=0.7714 | fpr=0.8994 | 6808.6 samples/s | 26.6 steps/s
[Step= 400] | Loss=4.87731 | acc=0.1125 | tpr=0.7648 | fpr=0.8993 | 6902.1 samples/s | 27.0 steps/s
[Step= 450] | Loss=4.88532 | acc=0.1122 | tpr=0.7668 | fpr=0.8997 | 6573.5 samples/s | 25.7 steps/s
[Step= 500] | Loss=4.88770 | acc=0.1121 | tpr=0.7687 | fpr=0.8997 | 6597.6 samples/s | 25.8 steps/s
[Step= 550] | Loss=4.88760 | acc=0.1123 | tpr=0.7672 | fpr=0.8996 | 12568.0 samples/s | 49.1 steps/s
Avg test loss: 4.88863, Avg test acc: 0.11227, Avg tpr: 0.76743, Avg fpr: 0.89964, total FA: 124913

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.04223 | acc=0.0916 | tpr=0.8319 | fpr=0.9217 | 3534.7 samples/s | 13.8 steps/s
[Step= 100] | Loss=7.00606 | acc=0.0932 | tpr=0.8273 | fpr=0.9205 | 6820.4 samples/s | 26.6 steps/s
[Step= 150] | Loss=7.01644 | acc=0.0933 | tpr=0.8256 | fpr=0.9202 | 7018.9 samples/s | 27.4 steps/s
[Step= 200] | Loss=7.00959 | acc=0.0921 | tpr=0.8109 | fpr=0.9210 | 6688.9 samples/s | 26.1 steps/s
[Step= 250] | Loss=7.01184 | acc=0.0924 | tpr=0.8070 | fpr=0.9207 | 6758.3 samples/s | 26.4 steps/s
[Step= 300] | Loss=7.01553 | acc=0.0919 | tpr=0.8051 | fpr=0.9211 | 6826.4 samples/s | 26.7 steps/s
[Step= 350] | Loss=7.00985 | acc=0.0919 | tpr=0.8084 | fpr=0.9211 | 7046.0 samples/s | 27.5 steps/s
[Step= 400] | Loss=7.00621 | acc=0.0922 | tpr=0.8025 | fpr=0.9207 | 6559.9 samples/s | 25.6 steps/s
[Step= 450] | Loss=7.01370 | acc=0.0920 | tpr=0.8033 | fpr=0.9209 | 6813.7 samples/s | 26.6 steps/s
[Step= 500] | Loss=7.01468 | acc=0.0919 | tpr=0.8026 | fpr=0.9209 | 6843.2 samples/s | 26.7 steps/s
[Step= 550] | Loss=7.01428 | acc=0.0922 | tpr=0.8062 | fpr=0.9208 | 12087.6 samples/s | 47.2 steps/s
Avg test loss: 7.01638, Avg test acc: 0.09218, Avg tpr: 0.80626, Avg fpr: 0.92081, total FA: 127852

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10845 | acc=0.9823 | tpr=0.9115 | fpr=0.0164 | 3489.4 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.11141 | acc=0.9816 | tpr=0.9339 | fpr=0.0175 | 7041.9 samples/s | 27.5 steps/s
[Step= 150] | Loss=0.11472 | acc=0.9812 | tpr=0.9366 | fpr=0.0180 | 6844.5 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.11604 | acc=0.9814 | tpr=0.9443 | fpr=0.0179 | 6824.7 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.11399 | acc=0.9819 | tpr=0.9441 | fpr=0.0174 | 6941.7 samples/s | 27.1 steps/s
[Step= 300] | Loss=0.11696 | acc=0.9815 | tpr=0.9418 | fpr=0.0177 | 6829.6 samples/s | 26.7 steps/s
[Step= 350] | Loss=0.11711 | acc=0.9814 | tpr=0.9418 | fpr=0.0179 | 6862.0 samples/s | 26.8 steps/s
[Step= 400] | Loss=0.11915 | acc=0.9812 | tpr=0.9365 | fpr=0.0180 | 6775.2 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.12108 | acc=0.9809 | tpr=0.9362 | fpr=0.0183 | 6865.7 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.12063 | acc=0.9810 | tpr=0.9388 | fpr=0.0183 | 6876.5 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.11987 | acc=0.9811 | tpr=0.9367 | fpr=0.0181 | 12443.2 samples/s | 48.6 steps/s
Avg test loss: 0.11979, Avg test acc: 0.98108, Avg tpr: 0.93582, Avg fpr: 0.01810, total FA: 2513

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10878 | acc=0.9807 | tpr=0.9425 | fpr=0.0186 | 3487.1 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.11625 | acc=0.9803 | tpr=0.9467 | fpr=0.0191 | 6878.4 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.11937 | acc=0.9796 | tpr=0.9524 | fpr=0.0199 | 6800.7 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.11991 | acc=0.9799 | tpr=0.9541 | fpr=0.0196 | 6971.9 samples/s | 27.2 steps/s
[Step= 250] | Loss=0.11854 | acc=0.9800 | tpr=0.9520 | fpr=0.0195 | 6861.4 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.12123 | acc=0.9798 | tpr=0.9505 | fpr=0.0197 | 6829.7 samples/s | 26.7 steps/s
[Step= 350] | Loss=0.12118 | acc=0.9798 | tpr=0.9530 | fpr=0.0197 | 7047.2 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.12297 | acc=0.9795 | tpr=0.9508 | fpr=0.0200 | 6744.5 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.12490 | acc=0.9792 | tpr=0.9499 | fpr=0.0202 | 6666.2 samples/s | 26.0 steps/s
[Step= 500] | Loss=0.12393 | acc=0.9793 | tpr=0.9511 | fpr=0.0202 | 6770.2 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.12307 | acc=0.9795 | tpr=0.9507 | fpr=0.0200 | 12199.9 samples/s | 47.7 steps/s
Avg test loss: 0.12291, Avg test acc: 0.97952, Avg tpr: 0.95008, Avg fpr: 0.01995, total FA: 2770

server round 13/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=26001 Epoch=50.7] | Loss=0.01877 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.095 | L2-Norm(final)=6.526 | 3039.9 samples/s | 47.5 steps/s
[Step=26050 Epoch=50.8] | Loss=0.02458 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.149 | L2-Norm(final)=6.544 | 4161.2 samples/s | 65.0 steps/s
[Step=26100 Epoch=50.9] | Loss=0.02317 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.191 | L2-Norm(final)=6.567 | 4324.4 samples/s | 67.6 steps/s
[Step=26150 Epoch=51.0] | Loss=0.02257 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.220 | L2-Norm(final)=6.588 | 4301.9 samples/s | 67.2 steps/s
[Step=26200 Epoch=51.1] | Loss=0.02271 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.248 | L2-Norm(final)=6.609 | 4329.9 samples/s | 67.7 steps/s
[Step=26250 Epoch=51.2] | Loss=0.02223 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.275 | L2-Norm(final)=6.627 | 4344.3 samples/s | 67.9 steps/s
[Step=26300 Epoch=51.3] | Loss=0.02171 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.301 | L2-Norm(final)=6.643 | 4492.2 samples/s | 70.2 steps/s
[Step=26350 Epoch=51.4] | Loss=0.02143 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.326 | L2-Norm(final)=6.660 | 4324.8 samples/s | 67.6 steps/s
[Step=26400 Epoch=51.5] | Loss=0.02117 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.351 | L2-Norm(final)=6.676 | 4336.1 samples/s | 67.8 steps/s
[Step=26450 Epoch=51.6] | Loss=0.02066 | Reg=0.00207 | acc=0.9531 | L2-Norm=14.373 | L2-Norm(final)=6.692 | 4374.9 samples/s | 68.4 steps/s
[Step=26500 Epoch=51.7] | Loss=0.02032 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.395 | L2-Norm(final)=6.707 | 5473.3 samples/s | 85.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=26501 Epoch=51.7] | Loss=0.02110 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.613 | L2-Norm(final)=6.861 | 3106.1 samples/s | 48.5 steps/s
[Step=26550 Epoch=51.8] | Loss=0.01749 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.632 | L2-Norm(final)=6.874 | 3675.0 samples/s | 57.4 steps/s
[Step=26600 Epoch=51.9] | Loss=0.02000 | Reg=0.00215 | acc=0.9531 | L2-Norm=14.658 | L2-Norm(final)=6.876 | 3916.3 samples/s | 61.2 steps/s
[Step=26650 Epoch=52.0] | Loss=0.02041 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.682 | L2-Norm(final)=6.877 | 3877.2 samples/s | 60.6 steps/s
[Step=26700 Epoch=52.1] | Loss=0.02078 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.705 | L2-Norm(final)=6.879 | 3909.1 samples/s | 61.1 steps/s
[Step=26750 Epoch=52.2] | Loss=0.02058 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.725 | L2-Norm(final)=6.881 | 3926.2 samples/s | 61.3 steps/s
[Step=26800 Epoch=52.3] | Loss=0.02131 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.743 | L2-Norm(final)=6.880 | 3912.9 samples/s | 61.1 steps/s
[Step=26850 Epoch=52.4] | Loss=0.02058 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.762 | L2-Norm(final)=6.878 | 3906.5 samples/s | 61.0 steps/s
[Step=26900 Epoch=52.5] | Loss=0.02128 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.778 | L2-Norm(final)=6.877 | 3950.3 samples/s | 61.7 steps/s
[Step=26950 Epoch=52.6] | Loss=0.02095 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.794 | L2-Norm(final)=6.875 | 3888.6 samples/s | 60.8 steps/s
[Step=27000 Epoch=52.7] | Loss=0.02050 | Reg=0.00219 | acc=0.9531 | L2-Norm=14.808 | L2-Norm(final)=6.875 | 4791.5 samples/s | 74.9 steps/s
[Step=27050 Epoch=52.8] | Loss=0.02018 | Reg=0.00220 | acc=0.9531 | L2-Norm=14.821 | L2-Norm(final)=6.874 | 1455.0 samples/s | 22.7 steps/s
[Step=27100 Epoch=52.9] | Loss=0.01984 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.834 | L2-Norm(final)=6.874 | 3920.6 samples/s | 61.3 steps/s
[Step=27150 Epoch=53.0] | Loss=0.01919 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.845 | L2-Norm(final)=6.874 | 3930.4 samples/s | 61.4 steps/s
[Step=27200 Epoch=53.1] | Loss=0.01875 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.856 | L2-Norm(final)=6.874 | 3927.8 samples/s | 61.4 steps/s
[Step=27250 Epoch=53.1] | Loss=0.01833 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.866 | L2-Norm(final)=6.875 | 3860.7 samples/s | 60.3 steps/s
[Step=27300 Epoch=53.2] | Loss=0.01826 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.875 | L2-Norm(final)=6.875 | 3936.7 samples/s | 61.5 steps/s
[Step=27350 Epoch=53.3] | Loss=0.01799 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.885 | L2-Norm(final)=6.876 | 3958.5 samples/s | 61.9 steps/s
[Step=27400 Epoch=53.4] | Loss=0.01769 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.895 | L2-Norm(final)=6.878 | 3952.5 samples/s | 61.8 steps/s
[Step=27450 Epoch=53.5] | Loss=0.01736 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.904 | L2-Norm(final)=6.880 | 3950.2 samples/s | 61.7 steps/s
[Step=27500 Epoch=53.6] | Loss=0.01728 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.913 | L2-Norm(final)=6.881 | 4202.4 samples/s | 65.7 steps/s
[Step=27550 Epoch=53.7] | Loss=0.01712 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.922 | L2-Norm(final)=6.882 | 1485.8 samples/s | 23.2 steps/s
[Step=27600 Epoch=53.8] | Loss=0.01673 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.931 | L2-Norm(final)=6.884 | 3947.9 samples/s | 61.7 steps/s
[Step=27650 Epoch=53.9] | Loss=0.01665 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.939 | L2-Norm(final)=6.885 | 3965.6 samples/s | 62.0 steps/s
[Step=27700 Epoch=54.0] | Loss=0.01636 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.947 | L2-Norm(final)=6.887 | 3911.8 samples/s | 61.1 steps/s
[Step=27750 Epoch=54.1] | Loss=0.01622 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.955 | L2-Norm(final)=6.888 | 3951.8 samples/s | 61.7 steps/s
[Step=27800 Epoch=54.2] | Loss=0.01602 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.962 | L2-Norm(final)=6.889 | 3982.7 samples/s | 62.2 steps/s
[Step=27850 Epoch=54.3] | Loss=0.01579 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.970 | L2-Norm(final)=6.891 | 3949.5 samples/s | 61.7 steps/s
[Step=27900 Epoch=54.4] | Loss=0.01556 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.977 | L2-Norm(final)=6.893 | 3943.1 samples/s | 61.6 steps/s
[Step=27950 Epoch=54.5] | Loss=0.01548 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.984 | L2-Norm(final)=6.895 | 3971.2 samples/s | 62.0 steps/s
[Step=28000 Epoch=54.6] | Loss=0.01543 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.991 | L2-Norm(final)=6.896 | 3943.2 samples/s | 61.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step28000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=26001 Epoch=50.8] | Loss=0.08353 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.095 | L2-Norm(final)=6.862 | 3268.3 samples/s | 51.1 steps/s
[Step=26050 Epoch=50.9] | Loss=0.02392 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.138 | L2-Norm(final)=6.880 | 4099.4 samples/s | 64.1 steps/s
[Step=26100 Epoch=51.0] | Loss=0.02539 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.176 | L2-Norm(final)=6.903 | 4388.5 samples/s | 68.6 steps/s
[Step=26150 Epoch=51.1] | Loss=0.02388 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.207 | L2-Norm(final)=6.924 | 4400.8 samples/s | 68.8 steps/s
[Step=26200 Epoch=51.2] | Loss=0.02278 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.235 | L2-Norm(final)=6.943 | 4360.7 samples/s | 68.1 steps/s
[Step=26250 Epoch=51.3] | Loss=0.02198 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.260 | L2-Norm(final)=6.961 | 4377.9 samples/s | 68.4 steps/s
[Step=26300 Epoch=51.4] | Loss=0.02133 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.283 | L2-Norm(final)=6.979 | 4386.0 samples/s | 68.5 steps/s
[Step=26350 Epoch=51.5] | Loss=0.02131 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.306 | L2-Norm(final)=6.998 | 4383.1 samples/s | 68.5 steps/s
[Step=26400 Epoch=51.6] | Loss=0.02083 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.329 | L2-Norm(final)=7.016 | 4441.5 samples/s | 69.4 steps/s
[Step=26450 Epoch=51.7] | Loss=0.02061 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.351 | L2-Norm(final)=7.032 | 4420.8 samples/s | 69.1 steps/s
[Step=26500 Epoch=51.8] | Loss=0.02034 | Reg=0.00207 | acc=0.9531 | L2-Norm=14.372 | L2-Norm(final)=7.049 | 5538.2 samples/s | 86.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=26501 Epoch=51.8] | Loss=0.04549 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.572 | L2-Norm(final)=7.204 | 3121.0 samples/s | 48.8 steps/s
[Step=26550 Epoch=51.9] | Loss=0.01743 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.600 | L2-Norm(final)=7.219 | 3935.1 samples/s | 61.5 steps/s
[Step=26600 Epoch=52.0] | Loss=0.02084 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.623 | L2-Norm(final)=7.223 | 3912.0 samples/s | 61.1 steps/s
[Step=26650 Epoch=52.1] | Loss=0.02082 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.646 | L2-Norm(final)=7.224 | 3949.8 samples/s | 61.7 steps/s
[Step=26700 Epoch=52.2] | Loss=0.02083 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.668 | L2-Norm(final)=7.220 | 3954.1 samples/s | 61.8 steps/s
[Step=26750 Epoch=52.3] | Loss=0.02054 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.690 | L2-Norm(final)=7.220 | 3923.8 samples/s | 61.3 steps/s
[Step=26800 Epoch=52.4] | Loss=0.02158 | Reg=0.00216 | acc=0.9531 | L2-Norm=14.711 | L2-Norm(final)=7.217 | 4010.8 samples/s | 62.7 steps/s
[Step=26850 Epoch=52.5] | Loss=0.02154 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.731 | L2-Norm(final)=7.214 | 3935.3 samples/s | 61.5 steps/s
[Step=26900 Epoch=52.6] | Loss=0.02145 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.749 | L2-Norm(final)=7.212 | 3908.8 samples/s | 61.1 steps/s
[Step=26950 Epoch=52.7] | Loss=0.02103 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.767 | L2-Norm(final)=7.211 | 3944.6 samples/s | 61.6 steps/s
[Step=27000 Epoch=52.8] | Loss=0.02070 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.784 | L2-Norm(final)=7.210 | 4930.2 samples/s | 77.0 steps/s
[Step=27050 Epoch=52.9] | Loss=0.02008 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.800 | L2-Norm(final)=7.210 | 1486.1 samples/s | 23.2 steps/s
[Step=27100 Epoch=53.0] | Loss=0.01946 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.815 | L2-Norm(final)=7.210 | 3937.0 samples/s | 61.5 steps/s
[Step=27150 Epoch=53.1] | Loss=0.01908 | Reg=0.00220 | acc=0.9688 | L2-Norm=14.829 | L2-Norm(final)=7.211 | 3935.1 samples/s | 61.5 steps/s
[Step=27200 Epoch=53.2] | Loss=0.01862 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.843 | L2-Norm(final)=7.212 | 3936.4 samples/s | 61.5 steps/s
[Step=27250 Epoch=53.3] | Loss=0.01851 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.855 | L2-Norm(final)=7.212 | 3932.0 samples/s | 61.4 steps/s
[Step=27300 Epoch=53.4] | Loss=0.01836 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.866 | L2-Norm(final)=7.212 | 3976.4 samples/s | 62.1 steps/s
[Step=27350 Epoch=53.5] | Loss=0.01825 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.878 | L2-Norm(final)=7.211 | 3967.7 samples/s | 62.0 steps/s
[Step=27400 Epoch=53.6] | Loss=0.01806 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.888 | L2-Norm(final)=7.211 | 3930.5 samples/s | 61.4 steps/s
[Step=27450 Epoch=53.7] | Loss=0.01788 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.899 | L2-Norm(final)=7.210 | 3932.2 samples/s | 61.4 steps/s
[Step=27500 Epoch=53.8] | Loss=0.01776 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.909 | L2-Norm(final)=7.210 | 4275.0 samples/s | 66.8 steps/s
[Step=27550 Epoch=53.9] | Loss=0.01752 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.920 | L2-Norm(final)=7.211 | 1565.0 samples/s | 24.5 steps/s
[Step=27600 Epoch=54.0] | Loss=0.01726 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.930 | L2-Norm(final)=7.212 | 3954.6 samples/s | 61.8 steps/s
[Step=27650 Epoch=54.1] | Loss=0.01703 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.939 | L2-Norm(final)=7.212 | 3838.5 samples/s | 60.0 steps/s
[Step=27700 Epoch=54.2] | Loss=0.01668 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.948 | L2-Norm(final)=7.213 | 3948.2 samples/s | 61.7 steps/s
[Step=27750 Epoch=54.3] | Loss=0.01655 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.957 | L2-Norm(final)=7.214 | 4015.8 samples/s | 62.7 steps/s
[Step=27800 Epoch=54.3] | Loss=0.01631 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.966 | L2-Norm(final)=7.215 | 3945.7 samples/s | 61.7 steps/s
[Step=27850 Epoch=54.4] | Loss=0.01614 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.974 | L2-Norm(final)=7.217 | 3965.1 samples/s | 62.0 steps/s
[Step=27900 Epoch=54.5] | Loss=0.01602 | Reg=0.00224 | acc=0.9531 | L2-Norm=14.982 | L2-Norm(final)=7.218 | 3921.2 samples/s | 61.3 steps/s
[Step=27950 Epoch=54.6] | Loss=0.01590 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.990 | L2-Norm(final)=7.219 | 3985.1 samples/s | 62.3 steps/s
[Step=28000 Epoch=54.7] | Loss=0.01578 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.998 | L2-Norm(final)=7.220 | 4003.3 samples/s | 62.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step28000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=26001 Epoch=99.6] | Loss=0.00054 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.095 | L2-Norm(final)=6.371 | 3146.0 samples/s | 49.2 steps/s
[Step=26050 Epoch=99.8] | Loss=0.00069 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.107 | L2-Norm(final)=6.381 | 4148.0 samples/s | 64.8 steps/s
[Step=26100 Epoch=100.0] | Loss=0.00057 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.118 | L2-Norm(final)=6.391 | 4134.2 samples/s | 64.6 steps/s
[Step=26150 Epoch=100.2] | Loss=0.00045 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.127 | L2-Norm(final)=6.402 | 4204.0 samples/s | 65.7 steps/s
[Step=26200 Epoch=100.4] | Loss=0.00037 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.127 | L2-Norm(final)=6.411 | 4173.3 samples/s | 65.2 steps/s
[Step=26250 Epoch=100.6] | Loss=0.00033 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.125 | L2-Norm(final)=6.419 | 5302.7 samples/s | 82.9 steps/s
[Step=26300 Epoch=100.8] | Loss=0.00031 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.125 | L2-Norm(final)=6.427 | 1506.7 samples/s | 23.5 steps/s
[Step=26350 Epoch=101.0] | Loss=0.00028 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.123 | L2-Norm(final)=6.433 | 4118.7 samples/s | 64.4 steps/s
[Step=26400 Epoch=101.2] | Loss=0.00025 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.118 | L2-Norm(final)=6.439 | 4084.0 samples/s | 63.8 steps/s
[Step=26450 Epoch=101.3] | Loss=0.00023 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.112 | L2-Norm(final)=6.445 | 4063.1 samples/s | 63.5 steps/s
[Step=26500 Epoch=101.5] | Loss=0.00022 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.105 | L2-Norm(final)=6.450 | 4658.6 samples/s | 72.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=26501 Epoch=101.5] | Loss=0.00000 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.041 | L2-Norm(final)=6.504 | 3390.4 samples/s | 53.0 steps/s
[Step=26550 Epoch=101.7] | Loss=0.00003 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.025 | L2-Norm(final)=6.507 | 3301.0 samples/s | 51.6 steps/s
[Step=26600 Epoch=101.9] | Loss=0.00004 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.008 | L2-Norm(final)=6.511 | 3750.6 samples/s | 58.6 steps/s
[Step=26650 Epoch=102.1] | Loss=0.00004 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.991 | L2-Norm(final)=6.514 | 3732.8 samples/s | 58.3 steps/s
[Step=26700 Epoch=102.3] | Loss=0.00003 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.975 | L2-Norm(final)=6.518 | 3782.8 samples/s | 59.1 steps/s
[Step=26750 Epoch=102.5] | Loss=0.00003 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.958 | L2-Norm(final)=6.521 | 4625.2 samples/s | 72.3 steps/s
[Step=26800 Epoch=102.7] | Loss=0.00003 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.941 | L2-Norm(final)=6.523 | 1476.9 samples/s | 23.1 steps/s
[Step=26850 Epoch=102.9] | Loss=0.00002 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.924 | L2-Norm(final)=6.526 | 3766.7 samples/s | 58.9 steps/s
[Step=26900 Epoch=103.1] | Loss=0.00002 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.907 | L2-Norm(final)=6.528 | 3695.1 samples/s | 57.7 steps/s
[Step=26950 Epoch=103.3] | Loss=0.00002 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.890 | L2-Norm(final)=6.529 | 3708.6 samples/s | 57.9 steps/s
[Step=27000 Epoch=103.5] | Loss=0.00002 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.873 | L2-Norm(final)=6.531 | 4098.9 samples/s | 64.0 steps/s
[Step=27050 Epoch=103.6] | Loss=0.00002 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.855 | L2-Norm(final)=6.533 | 1548.5 samples/s | 24.2 steps/s
[Step=27100 Epoch=103.8] | Loss=0.00002 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.838 | L2-Norm(final)=6.534 | 3671.1 samples/s | 57.4 steps/s
[Step=27150 Epoch=104.0] | Loss=0.00002 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.821 | L2-Norm(final)=6.536 | 3710.7 samples/s | 58.0 steps/s
[Step=27200 Epoch=104.2] | Loss=0.00002 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=6.537 | 3651.8 samples/s | 57.1 steps/s
[Step=27250 Epoch=104.4] | Loss=0.00002 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.786 | L2-Norm(final)=6.538 | 3653.2 samples/s | 57.1 steps/s
[Step=27300 Epoch=104.6] | Loss=0.00001 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.769 | L2-Norm(final)=6.540 | 1605.7 samples/s | 25.1 steps/s
[Step=27350 Epoch=104.8] | Loss=0.00001 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.751 | L2-Norm(final)=6.541 | 3779.2 samples/s | 59.1 steps/s
[Step=27400 Epoch=105.0] | Loss=0.00001 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.734 | L2-Norm(final)=6.542 | 3707.1 samples/s | 57.9 steps/s
[Step=27450 Epoch=105.2] | Loss=0.00001 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.716 | L2-Norm(final)=6.543 | 3753.3 samples/s | 58.6 steps/s
[Step=27500 Epoch=105.4] | Loss=0.00001 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.699 | L2-Norm(final)=6.544 | 3636.7 samples/s | 56.8 steps/s
[Step=27550 Epoch=105.6] | Loss=0.00001 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.681 | L2-Norm(final)=6.546 | 1580.0 samples/s | 24.7 steps/s
[Step=27600 Epoch=105.8] | Loss=0.00001 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.664 | L2-Norm(final)=6.547 | 3728.0 samples/s | 58.2 steps/s
[Step=27650 Epoch=105.9] | Loss=0.00001 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.646 | L2-Norm(final)=6.548 | 3709.8 samples/s | 58.0 steps/s
[Step=27700 Epoch=106.1] | Loss=0.00001 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.628 | L2-Norm(final)=6.549 | 3701.7 samples/s | 57.8 steps/s
[Step=27750 Epoch=106.3] | Loss=0.00001 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.610 | L2-Norm(final)=6.550 | 3686.8 samples/s | 57.6 steps/s
[Step=27800 Epoch=106.5] | Loss=0.00001 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.592 | L2-Norm(final)=6.551 | 5100.5 samples/s | 79.7 steps/s
[Step=27850 Epoch=106.7] | Loss=0.00001 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.575 | L2-Norm(final)=6.553 | 1437.2 samples/s | 22.5 steps/s
[Step=27900 Epoch=106.9] | Loss=0.00001 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=6.554 | 3669.7 samples/s | 57.3 steps/s
[Step=27950 Epoch=107.1] | Loss=0.00001 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.538 | L2-Norm(final)=6.555 | 3696.9 samples/s | 57.8 steps/s
[Step=28000 Epoch=107.3] | Loss=0.00001 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.520 | L2-Norm(final)=6.556 | 3728.0 samples/s | 58.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step28000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=26001 Epoch=100.1] | Loss=0.00076 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.095 | L2-Norm(final)=7.099 | 3325.5 samples/s | 52.0 steps/s
[Step=26050 Epoch=100.3] | Loss=0.00125 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.117 | L2-Norm(final)=7.109 | 3790.1 samples/s | 59.2 steps/s
[Step=26100 Epoch=100.5] | Loss=0.00083 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.131 | L2-Norm(final)=7.120 | 4142.9 samples/s | 64.7 steps/s
[Step=26150 Epoch=100.7] | Loss=0.00070 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.137 | L2-Norm(final)=7.129 | 4155.8 samples/s | 64.9 steps/s
[Step=26200 Epoch=100.9] | Loss=0.00057 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.144 | L2-Norm(final)=7.138 | 4090.2 samples/s | 63.9 steps/s
[Step=26250 Epoch=101.0] | Loss=0.00049 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.144 | L2-Norm(final)=7.144 | 5458.4 samples/s | 85.3 steps/s
[Step=26300 Epoch=101.2] | Loss=0.00044 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.142 | L2-Norm(final)=7.151 | 1513.9 samples/s | 23.7 steps/s
[Step=26350 Epoch=101.4] | Loss=0.00040 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.140 | L2-Norm(final)=7.156 | 4136.5 samples/s | 64.6 steps/s
[Step=26400 Epoch=101.6] | Loss=0.00036 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.137 | L2-Norm(final)=7.162 | 4129.8 samples/s | 64.5 steps/s
[Step=26450 Epoch=101.8] | Loss=0.00033 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.133 | L2-Norm(final)=7.167 | 4089.2 samples/s | 63.9 steps/s
[Step=26500 Epoch=102.0] | Loss=0.00030 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.129 | L2-Norm(final)=7.172 | 4743.6 samples/s | 74.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=26501 Epoch=102.0] | Loss=0.00021 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.081 | L2-Norm(final)=7.219 | 3018.0 samples/s | 47.2 steps/s
[Step=26550 Epoch=102.2] | Loss=0.00008 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.069 | L2-Norm(final)=7.223 | 3745.0 samples/s | 58.5 steps/s
[Step=26600 Epoch=102.4] | Loss=0.00007 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.059 | L2-Norm(final)=7.226 | 3721.1 samples/s | 58.1 steps/s
[Step=26650 Epoch=102.6] | Loss=0.00005 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.046 | L2-Norm(final)=7.229 | 3763.4 samples/s | 58.8 steps/s
[Step=26700 Epoch=102.8] | Loss=0.00005 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.033 | L2-Norm(final)=7.232 | 3687.3 samples/s | 57.6 steps/s
[Step=26750 Epoch=103.0] | Loss=0.00004 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.019 | L2-Norm(final)=7.234 | 4797.7 samples/s | 75.0 steps/s
[Step=26800 Epoch=103.2] | Loss=0.00004 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.006 | L2-Norm(final)=7.236 | 1463.5 samples/s | 22.9 steps/s
[Step=26850 Epoch=103.4] | Loss=0.00003 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.992 | L2-Norm(final)=7.238 | 3695.1 samples/s | 57.7 steps/s
[Step=26900 Epoch=103.5] | Loss=0.00003 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.978 | L2-Norm(final)=7.239 | 3729.7 samples/s | 58.3 steps/s
[Step=26950 Epoch=103.7] | Loss=0.00003 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.965 | L2-Norm(final)=7.241 | 3719.3 samples/s | 58.1 steps/s
[Step=27000 Epoch=103.9] | Loss=0.00003 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.951 | L2-Norm(final)=7.242 | 4251.7 samples/s | 66.4 steps/s
[Step=27050 Epoch=104.1] | Loss=0.00003 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.937 | L2-Norm(final)=7.244 | 1470.3 samples/s | 23.0 steps/s
[Step=27100 Epoch=104.3] | Loss=0.00002 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.923 | L2-Norm(final)=7.245 | 3682.5 samples/s | 57.5 steps/s
[Step=27150 Epoch=104.5] | Loss=0.00002 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.909 | L2-Norm(final)=7.247 | 3712.7 samples/s | 58.0 steps/s
[Step=27200 Epoch=104.7] | Loss=0.00002 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.895 | L2-Norm(final)=7.248 | 3691.9 samples/s | 57.7 steps/s
[Step=27250 Epoch=104.9] | Loss=0.00002 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.881 | L2-Norm(final)=7.249 | 3783.5 samples/s | 59.1 steps/s
[Step=27300 Epoch=105.1] | Loss=0.00002 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.867 | L2-Norm(final)=7.250 | 1557.4 samples/s | 24.3 steps/s
[Step=27350 Epoch=105.3] | Loss=0.00002 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.853 | L2-Norm(final)=7.252 | 3787.4 samples/s | 59.2 steps/s
[Step=27400 Epoch=105.5] | Loss=0.00002 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.838 | L2-Norm(final)=7.253 | 3737.0 samples/s | 58.4 steps/s
[Step=27450 Epoch=105.7] | Loss=0.00002 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.824 | L2-Norm(final)=7.254 | 3757.6 samples/s | 58.7 steps/s
[Step=27500 Epoch=105.9] | Loss=0.00002 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.810 | L2-Norm(final)=7.255 | 3699.7 samples/s | 57.8 steps/s
[Step=27550 Epoch=106.1] | Loss=0.00002 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.796 | L2-Norm(final)=7.256 | 1590.6 samples/s | 24.9 steps/s
[Step=27600 Epoch=106.2] | Loss=0.00002 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.781 | L2-Norm(final)=7.257 | 3735.2 samples/s | 58.4 steps/s
[Step=27650 Epoch=106.4] | Loss=0.00002 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.767 | L2-Norm(final)=7.258 | 3748.3 samples/s | 58.6 steps/s
[Step=27700 Epoch=106.6] | Loss=0.00002 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.752 | L2-Norm(final)=7.260 | 3742.1 samples/s | 58.5 steps/s
[Step=27750 Epoch=106.8] | Loss=0.00001 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.738 | L2-Norm(final)=7.261 | 3698.8 samples/s | 57.8 steps/s
[Step=27800 Epoch=107.0] | Loss=0.00001 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.723 | L2-Norm(final)=7.262 | 5491.5 samples/s | 85.8 steps/s
[Step=27850 Epoch=107.2] | Loss=0.00001 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.708 | L2-Norm(final)=7.263 | 1402.0 samples/s | 21.9 steps/s
[Step=27900 Epoch=107.4] | Loss=0.00001 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.693 | L2-Norm(final)=7.264 | 3705.4 samples/s | 57.9 steps/s
[Step=27950 Epoch=107.6] | Loss=0.00001 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.678 | L2-Norm(final)=7.265 | 3705.7 samples/s | 57.9 steps/s
[Step=28000 Epoch=107.8] | Loss=0.00001 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.663 | L2-Norm(final)=7.266 | 3669.6 samples/s | 57.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06599 | acc=0.9637 | tpr=0.9698 | fpr=0.0496 | 3505.5 samples/s | 13.7 steps/s
Avg test loss: 0.06912, Avg test acc: 0.96310, Avg tpr: 0.96882, Avg fpr: 0.04948, total FA: 386

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06742 | acc=0.9657 | tpr=0.9701 | fpr=0.0439 | 3490.7 samples/s | 13.6 steps/s
Avg test loss: 0.07816, Avg test acc: 0.96334, Avg tpr: 0.96893, Avg fpr: 0.04897, total FA: 382

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.27144 | acc=0.3130 | tpr=0.0246 | fpr=0.0610 | 3516.9 samples/s | 13.7 steps/s
Avg test loss: 5.27727, Avg test acc: 0.31036, Avg tpr: 0.02541, Avg fpr: 0.06294, total FA: 491

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.00876 | acc=0.3183 | tpr=0.0332 | fpr=0.0627 | 3500.3 samples/s | 13.7 steps/s
Avg test loss: 5.01071, Avg test acc: 0.31593, Avg tpr: 0.03398, Avg fpr: 0.06397, total FA: 499

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.10852 | acc=0.0975 | tpr=0.7788 | fpr=0.9147 | 3480.3 samples/s | 13.6 steps/s
[Step= 100] | Loss=6.07836 | acc=0.0996 | tpr=0.7974 | fpr=0.9134 | 7012.8 samples/s | 27.4 steps/s
[Step= 150] | Loss=6.08796 | acc=0.0993 | tpr=0.7954 | fpr=0.9135 | 6806.0 samples/s | 26.6 steps/s
[Step= 200] | Loss=6.07591 | acc=0.0994 | tpr=0.7891 | fpr=0.9131 | 6786.3 samples/s | 26.5 steps/s
[Step= 250] | Loss=6.07052 | acc=0.0996 | tpr=0.7878 | fpr=0.9129 | 6875.7 samples/s | 26.9 steps/s
[Step= 300] | Loss=6.07482 | acc=0.0992 | tpr=0.7920 | fpr=0.9135 | 6759.8 samples/s | 26.4 steps/s
[Step= 350] | Loss=6.07079 | acc=0.0993 | tpr=0.7915 | fpr=0.9133 | 6850.1 samples/s | 26.8 steps/s
[Step= 400] | Loss=6.06609 | acc=0.0993 | tpr=0.7861 | fpr=0.9131 | 6870.4 samples/s | 26.8 steps/s
[Step= 450] | Loss=6.07111 | acc=0.0987 | tpr=0.7887 | fpr=0.9138 | 6592.8 samples/s | 25.8 steps/s
[Step= 500] | Loss=6.07737 | acc=0.0986 | tpr=0.7916 | fpr=0.9140 | 6869.7 samples/s | 26.8 steps/s
[Step= 550] | Loss=6.07711 | acc=0.0988 | tpr=0.7939 | fpr=0.9139 | 12005.8 samples/s | 46.9 steps/s
Avg test loss: 6.07933, Avg test acc: 0.09869, Avg tpr: 0.79398, Avg fpr: 0.91395, total FA: 126900

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.65823 | acc=0.1134 | tpr=0.8053 | fpr=0.8990 | 3454.7 samples/s | 13.5 steps/s
[Step= 100] | Loss=6.62800 | acc=0.1145 | tpr=0.8081 | fpr=0.8985 | 6981.8 samples/s | 27.3 steps/s
[Step= 150] | Loss=6.64310 | acc=0.1140 | tpr=0.8040 | fpr=0.8987 | 6804.5 samples/s | 26.6 steps/s
[Step= 200] | Loss=6.62064 | acc=0.1134 | tpr=0.7880 | fpr=0.8989 | 6927.5 samples/s | 27.1 steps/s
[Step= 250] | Loss=6.62293 | acc=0.1131 | tpr=0.7921 | fpr=0.8993 | 6965.5 samples/s | 27.2 steps/s
[Step= 300] | Loss=6.62667 | acc=0.1132 | tpr=0.7935 | fpr=0.8992 | 6818.7 samples/s | 26.6 steps/s
[Step= 350] | Loss=6.62234 | acc=0.1130 | tpr=0.7984 | fpr=0.8994 | 6768.4 samples/s | 26.4 steps/s
[Step= 400] | Loss=6.61858 | acc=0.1132 | tpr=0.7949 | fpr=0.8992 | 6893.4 samples/s | 26.9 steps/s
[Step= 450] | Loss=6.62718 | acc=0.1126 | tpr=0.7950 | fpr=0.8998 | 6700.0 samples/s | 26.2 steps/s
[Step= 500] | Loss=6.62858 | acc=0.1126 | tpr=0.7947 | fpr=0.8997 | 6758.9 samples/s | 26.4 steps/s
[Step= 550] | Loss=6.62814 | acc=0.1128 | tpr=0.7986 | fpr=0.8997 | 12602.4 samples/s | 49.2 steps/s
Avg test loss: 6.62992, Avg test acc: 0.11271, Avg tpr: 0.79834, Avg fpr: 0.89975, total FA: 124929

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11498 | acc=0.9815 | tpr=0.9248 | fpr=0.0175 | 3538.7 samples/s | 13.8 steps/s
[Step= 100] | Loss=0.11832 | acc=0.9812 | tpr=0.9467 | fpr=0.0181 | 6700.5 samples/s | 26.2 steps/s
[Step= 150] | Loss=0.12137 | acc=0.9804 | tpr=0.9481 | fpr=0.0190 | 7183.6 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.12207 | acc=0.9806 | tpr=0.9486 | fpr=0.0188 | 6711.3 samples/s | 26.2 steps/s
[Step= 250] | Loss=0.11971 | acc=0.9810 | tpr=0.9467 | fpr=0.0184 | 6691.3 samples/s | 26.1 steps/s
[Step= 300] | Loss=0.12211 | acc=0.9806 | tpr=0.9484 | fpr=0.0188 | 6887.3 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.12165 | acc=0.9807 | tpr=0.9493 | fpr=0.0188 | 6991.4 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.12355 | acc=0.9804 | tpr=0.9442 | fpr=0.0190 | 6849.7 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.12553 | acc=0.9801 | tpr=0.9435 | fpr=0.0192 | 6631.1 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.12521 | acc=0.9802 | tpr=0.9454 | fpr=0.0192 | 6643.9 samples/s | 26.0 steps/s
[Step= 550] | Loss=0.12446 | acc=0.9804 | tpr=0.9443 | fpr=0.0190 | 12915.2 samples/s | 50.5 steps/s
Avg test loss: 0.12437, Avg test acc: 0.98036, Avg tpr: 0.94374, Avg fpr: 0.01897, total FA: 2634

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11828 | acc=0.9804 | tpr=0.9381 | fpr=0.0188 | 3530.6 samples/s | 13.8 steps/s
[Step= 100] | Loss=0.12218 | acc=0.9802 | tpr=0.9595 | fpr=0.0195 | 6818.5 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.12514 | acc=0.9791 | tpr=0.9611 | fpr=0.0206 | 6877.4 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.12562 | acc=0.9794 | tpr=0.9639 | fpr=0.0203 | 6928.5 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.12399 | acc=0.9798 | tpr=0.9633 | fpr=0.0199 | 7097.5 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.12673 | acc=0.9793 | tpr=0.9622 | fpr=0.0204 | 6476.0 samples/s | 25.3 steps/s
[Step= 350] | Loss=0.12648 | acc=0.9794 | tpr=0.9618 | fpr=0.0203 | 6988.2 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.12834 | acc=0.9792 | tpr=0.9573 | fpr=0.0205 | 6828.3 samples/s | 26.7 steps/s
[Step= 450] | Loss=0.13038 | acc=0.9790 | tpr=0.9557 | fpr=0.0206 | 6927.2 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.13014 | acc=0.9789 | tpr=0.9577 | fpr=0.0207 | 6697.5 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.12930 | acc=0.9790 | tpr=0.9566 | fpr=0.0206 | 12524.1 samples/s | 48.9 steps/s
Avg test loss: 0.12924, Avg test acc: 0.97904, Avg tpr: 0.95602, Avg fpr: 0.02054, total FA: 2852

server round 14/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=28001 Epoch=54.6] | Loss=0.00337 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.851 | L2-Norm(final)=6.927 | 3034.0 samples/s | 47.4 steps/s
[Step=28050 Epoch=54.7] | Loss=0.01307 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.892 | L2-Norm(final)=6.933 | 4274.7 samples/s | 66.8 steps/s
[Step=28100 Epoch=54.8] | Loss=0.01350 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.924 | L2-Norm(final)=6.942 | 4424.7 samples/s | 69.1 steps/s
[Step=28150 Epoch=54.9] | Loss=0.01378 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.945 | L2-Norm(final)=6.950 | 4322.9 samples/s | 67.5 steps/s
[Step=28200 Epoch=55.0] | Loss=0.01411 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.963 | L2-Norm(final)=6.957 | 4336.4 samples/s | 67.8 steps/s
[Step=28250 Epoch=55.1] | Loss=0.01419 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.980 | L2-Norm(final)=6.964 | 4345.9 samples/s | 67.9 steps/s
[Step=28300 Epoch=55.2] | Loss=0.01370 | Reg=0.00196 | acc=0.9688 | L2-Norm=13.997 | L2-Norm(final)=6.971 | 4420.7 samples/s | 69.1 steps/s
[Step=28350 Epoch=55.3] | Loss=0.01364 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.011 | L2-Norm(final)=6.978 | 4403.2 samples/s | 68.8 steps/s
[Step=28400 Epoch=55.4] | Loss=0.01321 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.024 | L2-Norm(final)=6.986 | 4448.8 samples/s | 69.5 steps/s
[Step=28450 Epoch=55.5] | Loss=0.01307 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.037 | L2-Norm(final)=6.994 | 4343.5 samples/s | 67.9 steps/s
[Step=28500 Epoch=55.6] | Loss=0.01279 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.049 | L2-Norm(final)=7.002 | 5525.1 samples/s | 86.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=28501 Epoch=55.6] | Loss=0.00252 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.168 | L2-Norm(final)=7.076 | 3067.2 samples/s | 47.9 steps/s
[Step=28550 Epoch=55.7] | Loss=0.01226 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.185 | L2-Norm(final)=7.084 | 3821.1 samples/s | 59.7 steps/s
[Step=28600 Epoch=55.8] | Loss=0.01562 | Reg=0.00202 | acc=0.9688 | L2-Norm=14.206 | L2-Norm(final)=7.087 | 3913.9 samples/s | 61.2 steps/s
[Step=28650 Epoch=55.9] | Loss=0.01632 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.230 | L2-Norm(final)=7.089 | 3950.3 samples/s | 61.7 steps/s
[Step=28700 Epoch=56.0] | Loss=0.01776 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.255 | L2-Norm(final)=7.089 | 3937.1 samples/s | 61.5 steps/s
[Step=28750 Epoch=56.1] | Loss=0.01800 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.278 | L2-Norm(final)=7.088 | 3916.6 samples/s | 61.2 steps/s
[Step=28800 Epoch=56.2] | Loss=0.01796 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.299 | L2-Norm(final)=7.088 | 3964.5 samples/s | 61.9 steps/s
[Step=28850 Epoch=56.3] | Loss=0.01773 | Reg=0.00205 | acc=0.9688 | L2-Norm=14.318 | L2-Norm(final)=7.088 | 3915.3 samples/s | 61.2 steps/s
[Step=28900 Epoch=56.4] | Loss=0.01791 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.335 | L2-Norm(final)=7.088 | 3901.0 samples/s | 61.0 steps/s
[Step=28950 Epoch=56.5] | Loss=0.01777 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.352 | L2-Norm(final)=7.087 | 3944.9 samples/s | 61.6 steps/s
[Step=29000 Epoch=56.6] | Loss=0.01746 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.368 | L2-Norm(final)=7.087 | 4754.7 samples/s | 74.3 steps/s
[Step=29050 Epoch=56.7] | Loss=0.01701 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.385 | L2-Norm(final)=7.088 | 1478.0 samples/s | 23.1 steps/s
[Step=29100 Epoch=56.8] | Loss=0.01665 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.400 | L2-Norm(final)=7.089 | 3900.9 samples/s | 61.0 steps/s
[Step=29150 Epoch=56.9] | Loss=0.01644 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.414 | L2-Norm(final)=7.090 | 3873.1 samples/s | 60.5 steps/s
[Step=29200 Epoch=57.0] | Loss=0.01622 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.427 | L2-Norm(final)=7.091 | 3911.8 samples/s | 61.1 steps/s
[Step=29250 Epoch=57.0] | Loss=0.01608 | Reg=0.00209 | acc=0.9531 | L2-Norm=14.440 | L2-Norm(final)=7.093 | 3936.5 samples/s | 61.5 steps/s
[Step=29300 Epoch=57.1] | Loss=0.01600 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.453 | L2-Norm(final)=7.094 | 3903.9 samples/s | 61.0 steps/s
[Step=29350 Epoch=57.2] | Loss=0.01594 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.466 | L2-Norm(final)=7.095 | 3917.6 samples/s | 61.2 steps/s
[Step=29400 Epoch=57.3] | Loss=0.01600 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.479 | L2-Norm(final)=7.096 | 3951.9 samples/s | 61.7 steps/s
[Step=29450 Epoch=57.4] | Loss=0.01584 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.491 | L2-Norm(final)=7.097 | 3947.7 samples/s | 61.7 steps/s
[Step=29500 Epoch=57.5] | Loss=0.01581 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.503 | L2-Norm(final)=7.098 | 4160.2 samples/s | 65.0 steps/s
[Step=29550 Epoch=57.6] | Loss=0.01574 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.514 | L2-Norm(final)=7.098 | 1531.5 samples/s | 23.9 steps/s
[Step=29600 Epoch=57.7] | Loss=0.01566 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.525 | L2-Norm(final)=7.099 | 3903.1 samples/s | 61.0 steps/s
[Step=29650 Epoch=57.8] | Loss=0.01544 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.536 | L2-Norm(final)=7.099 | 3900.2 samples/s | 60.9 steps/s
[Step=29700 Epoch=57.9] | Loss=0.01508 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.547 | L2-Norm(final)=7.100 | 3874.8 samples/s | 60.5 steps/s
[Step=29750 Epoch=58.0] | Loss=0.01497 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.557 | L2-Norm(final)=7.102 | 3888.3 samples/s | 60.8 steps/s
[Step=29800 Epoch=58.1] | Loss=0.01475 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.566 | L2-Norm(final)=7.103 | 3986.5 samples/s | 62.3 steps/s
[Step=29850 Epoch=58.2] | Loss=0.01464 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.576 | L2-Norm(final)=7.104 | 3951.9 samples/s | 61.7 steps/s
[Step=29900 Epoch=58.3] | Loss=0.01449 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.586 | L2-Norm(final)=7.106 | 3939.6 samples/s | 61.6 steps/s
[Step=29950 Epoch=58.4] | Loss=0.01438 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.595 | L2-Norm(final)=7.107 | 3929.5 samples/s | 61.4 steps/s
[Step=30000 Epoch=58.5] | Loss=0.01435 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.604 | L2-Norm(final)=7.108 | 3942.6 samples/s | 61.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step30000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=28001 Epoch=54.7] | Loss=0.00956 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.851 | L2-Norm(final)=7.249 | 3246.2 samples/s | 50.7 steps/s
[Step=28050 Epoch=54.8] | Loss=0.01380 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.891 | L2-Norm(final)=7.251 | 3737.9 samples/s | 58.4 steps/s
[Step=28100 Epoch=54.9] | Loss=0.01360 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.912 | L2-Norm(final)=7.262 | 4300.8 samples/s | 67.2 steps/s
[Step=28150 Epoch=55.0] | Loss=0.01293 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.930 | L2-Norm(final)=7.275 | 4378.7 samples/s | 68.4 steps/s
[Step=28200 Epoch=55.1] | Loss=0.01368 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.946 | L2-Norm(final)=7.284 | 4425.1 samples/s | 69.1 steps/s
[Step=28250 Epoch=55.2] | Loss=0.01393 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=7.290 | 4452.3 samples/s | 69.6 steps/s
[Step=28300 Epoch=55.3] | Loss=0.01415 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.975 | L2-Norm(final)=7.298 | 4328.9 samples/s | 67.6 steps/s
[Step=28350 Epoch=55.4] | Loss=0.01391 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.989 | L2-Norm(final)=7.306 | 4358.1 samples/s | 68.1 steps/s
[Step=28400 Epoch=55.5] | Loss=0.01377 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.004 | L2-Norm(final)=7.314 | 4426.3 samples/s | 69.2 steps/s
[Step=28450 Epoch=55.6] | Loss=0.01357 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.019 | L2-Norm(final)=7.322 | 4445.8 samples/s | 69.5 steps/s
[Step=28500 Epoch=55.7] | Loss=0.01323 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.033 | L2-Norm(final)=7.331 | 5627.5 samples/s | 87.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=28501 Epoch=55.7] | Loss=0.03246 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.175 | L2-Norm(final)=7.420 | 3348.3 samples/s | 52.3 steps/s
[Step=28550 Epoch=55.8] | Loss=0.01440 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.195 | L2-Norm(final)=7.426 | 3734.8 samples/s | 58.4 steps/s
[Step=28600 Epoch=55.9] | Loss=0.01672 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.221 | L2-Norm(final)=7.423 | 3930.5 samples/s | 61.4 steps/s
[Step=28650 Epoch=56.0] | Loss=0.01695 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.245 | L2-Norm(final)=7.417 | 3905.2 samples/s | 61.0 steps/s
[Step=28700 Epoch=56.1] | Loss=0.01742 | Reg=0.00204 | acc=0.9531 | L2-Norm=14.269 | L2-Norm(final)=7.417 | 3933.3 samples/s | 61.5 steps/s
[Step=28750 Epoch=56.2] | Loss=0.01805 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.292 | L2-Norm(final)=7.416 | 3922.4 samples/s | 61.3 steps/s
[Step=28800 Epoch=56.3] | Loss=0.01792 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.311 | L2-Norm(final)=7.416 | 3916.0 samples/s | 61.2 steps/s
[Step=28850 Epoch=56.4] | Loss=0.01834 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.329 | L2-Norm(final)=7.416 | 3960.6 samples/s | 61.9 steps/s
[Step=28900 Epoch=56.5] | Loss=0.01815 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.348 | L2-Norm(final)=7.417 | 3951.1 samples/s | 61.7 steps/s
[Step=28950 Epoch=56.6] | Loss=0.01839 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.367 | L2-Norm(final)=7.418 | 3909.7 samples/s | 61.1 steps/s
[Step=29000 Epoch=56.7] | Loss=0.01825 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.385 | L2-Norm(final)=7.419 | 4833.9 samples/s | 75.5 steps/s
[Step=29050 Epoch=56.8] | Loss=0.01795 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.401 | L2-Norm(final)=7.419 | 1514.4 samples/s | 23.7 steps/s
[Step=29100 Epoch=56.9] | Loss=0.01731 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.416 | L2-Norm(final)=7.420 | 3943.9 samples/s | 61.6 steps/s
[Step=29150 Epoch=57.0] | Loss=0.01720 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.429 | L2-Norm(final)=7.421 | 3934.9 samples/s | 61.5 steps/s
[Step=29200 Epoch=57.1] | Loss=0.01695 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.443 | L2-Norm(final)=7.421 | 3953.2 samples/s | 61.8 steps/s
[Step=29250 Epoch=57.2] | Loss=0.01668 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.456 | L2-Norm(final)=7.422 | 3905.5 samples/s | 61.0 steps/s
[Step=29300 Epoch=57.3] | Loss=0.01651 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.469 | L2-Norm(final)=7.423 | 3978.3 samples/s | 62.2 steps/s
[Step=29350 Epoch=57.4] | Loss=0.01635 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.481 | L2-Norm(final)=7.424 | 3975.2 samples/s | 62.1 steps/s
[Step=29400 Epoch=57.5] | Loss=0.01618 | Reg=0.00210 | acc=0.9531 | L2-Norm=14.493 | L2-Norm(final)=7.426 | 3979.4 samples/s | 62.2 steps/s
[Step=29450 Epoch=57.6] | Loss=0.01591 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.504 | L2-Norm(final)=7.427 | 3942.4 samples/s | 61.6 steps/s
[Step=29500 Epoch=57.7] | Loss=0.01581 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.514 | L2-Norm(final)=7.429 | 4243.3 samples/s | 66.3 steps/s
[Step=29550 Epoch=57.8] | Loss=0.01569 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.525 | L2-Norm(final)=7.430 | 1606.0 samples/s | 25.1 steps/s
[Step=29600 Epoch=57.9] | Loss=0.01555 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.535 | L2-Norm(final)=7.431 | 3984.0 samples/s | 62.2 steps/s
[Step=29650 Epoch=58.0] | Loss=0.01550 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.545 | L2-Norm(final)=7.431 | 3893.5 samples/s | 60.8 steps/s
[Step=29700 Epoch=58.1] | Loss=0.01543 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.556 | L2-Norm(final)=7.432 | 3916.5 samples/s | 61.2 steps/s
[Step=29750 Epoch=58.2] | Loss=0.01551 | Reg=0.00212 | acc=0.9531 | L2-Norm=14.568 | L2-Norm(final)=7.433 | 3912.8 samples/s | 61.1 steps/s
[Step=29800 Epoch=58.3] | Loss=0.01552 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.578 | L2-Norm(final)=7.433 | 3958.5 samples/s | 61.9 steps/s
[Step=29850 Epoch=58.4] | Loss=0.01537 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.589 | L2-Norm(final)=7.434 | 3969.2 samples/s | 62.0 steps/s
[Step=29900 Epoch=58.5] | Loss=0.01528 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.600 | L2-Norm(final)=7.435 | 3943.4 samples/s | 61.6 steps/s
[Step=29950 Epoch=58.6] | Loss=0.01506 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.610 | L2-Norm(final)=7.435 | 3974.0 samples/s | 62.1 steps/s
[Step=30000 Epoch=58.6] | Loss=0.01496 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.620 | L2-Norm(final)=7.436 | 3936.4 samples/s | 61.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step30000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=28001 Epoch=107.3] | Loss=0.00110 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.851 | L2-Norm(final)=6.591 | 3142.9 samples/s | 49.1 steps/s
[Step=28050 Epoch=107.5] | Loss=0.00169 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.909 | L2-Norm(final)=6.605 | 4022.3 samples/s | 62.8 steps/s
[Step=28100 Epoch=107.7] | Loss=0.00141 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.992 | L2-Norm(final)=6.610 | 4107.7 samples/s | 64.2 steps/s
[Step=28150 Epoch=107.9] | Loss=0.00100 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.039 | L2-Norm(final)=6.613 | 4188.9 samples/s | 65.5 steps/s
[Step=28200 Epoch=108.1] | Loss=0.00079 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.057 | L2-Norm(final)=6.617 | 4030.0 samples/s | 63.0 steps/s
[Step=28250 Epoch=108.2] | Loss=0.00096 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.066 | L2-Norm(final)=6.620 | 5485.9 samples/s | 85.7 steps/s
[Step=28300 Epoch=108.4] | Loss=0.00084 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.080 | L2-Norm(final)=6.623 | 1505.5 samples/s | 23.5 steps/s
[Step=28350 Epoch=108.6] | Loss=0.00073 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.088 | L2-Norm(final)=6.627 | 4133.9 samples/s | 64.6 steps/s
[Step=28400 Epoch=108.8] | Loss=0.00065 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.091 | L2-Norm(final)=6.630 | 4121.8 samples/s | 64.4 steps/s
[Step=28450 Epoch=109.0] | Loss=0.00059 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.091 | L2-Norm(final)=6.634 | 4192.2 samples/s | 65.5 steps/s
[Step=28500 Epoch=109.2] | Loss=0.00053 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=6.637 | 4643.9 samples/s | 72.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=28501 Epoch=109.2] | Loss=0.00001 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.055 | L2-Norm(final)=6.670 | 2977.4 samples/s | 46.5 steps/s
[Step=28550 Epoch=109.4] | Loss=0.00002 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.033 | L2-Norm(final)=6.672 | 3884.5 samples/s | 60.7 steps/s
[Step=28600 Epoch=109.6] | Loss=0.00001 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.006 | L2-Norm(final)=6.673 | 3737.8 samples/s | 58.4 steps/s
[Step=28650 Epoch=109.8] | Loss=0.00001 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.978 | L2-Norm(final)=6.675 | 3773.7 samples/s | 59.0 steps/s
[Step=28700 Epoch=110.0] | Loss=0.00001 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.951 | L2-Norm(final)=6.676 | 3749.0 samples/s | 58.6 steps/s
[Step=28750 Epoch=110.2] | Loss=0.00001 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.925 | L2-Norm(final)=6.677 | 4684.7 samples/s | 73.2 steps/s
[Step=28800 Epoch=110.4] | Loss=0.00001 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.897 | L2-Norm(final)=6.678 | 1479.0 samples/s | 23.1 steps/s
[Step=28850 Epoch=110.5] | Loss=0.00001 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.870 | L2-Norm(final)=6.679 | 3703.8 samples/s | 57.9 steps/s
[Step=28900 Epoch=110.7] | Loss=0.00001 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.843 | L2-Norm(final)=6.680 | 3734.1 samples/s | 58.3 steps/s
[Step=28950 Epoch=110.9] | Loss=0.00001 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.815 | L2-Norm(final)=6.681 | 3726.0 samples/s | 58.2 steps/s
[Step=29000 Epoch=111.1] | Loss=0.00001 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.787 | L2-Norm(final)=6.681 | 4156.7 samples/s | 64.9 steps/s
[Step=29050 Epoch=111.3] | Loss=0.00001 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.760 | L2-Norm(final)=6.682 | 1557.9 samples/s | 24.3 steps/s
[Step=29100 Epoch=111.5] | Loss=0.00001 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.732 | L2-Norm(final)=6.682 | 3730.1 samples/s | 58.3 steps/s
[Step=29150 Epoch=111.7] | Loss=0.00001 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.704 | L2-Norm(final)=6.683 | 3775.5 samples/s | 59.0 steps/s
[Step=29200 Epoch=111.9] | Loss=0.00001 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.676 | L2-Norm(final)=6.683 | 3731.8 samples/s | 58.3 steps/s
[Step=29250 Epoch=112.1] | Loss=0.00001 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.648 | L2-Norm(final)=6.684 | 3735.3 samples/s | 58.4 steps/s
[Step=29300 Epoch=112.3] | Loss=0.00001 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.620 | L2-Norm(final)=6.684 | 1617.2 samples/s | 25.3 steps/s
[Step=29350 Epoch=112.5] | Loss=0.00001 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.592 | L2-Norm(final)=6.685 | 3770.5 samples/s | 58.9 steps/s
[Step=29400 Epoch=112.7] | Loss=0.00001 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.564 | L2-Norm(final)=6.685 | 3745.8 samples/s | 58.5 steps/s
[Step=29450 Epoch=112.8] | Loss=0.00001 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.535 | L2-Norm(final)=6.686 | 3747.1 samples/s | 58.5 steps/s
[Step=29500 Epoch=113.0] | Loss=0.00001 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.507 | L2-Norm(final)=6.686 | 3725.5 samples/s | 58.2 steps/s
[Step=29550 Epoch=113.2] | Loss=0.00000 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=6.686 | 1576.1 samples/s | 24.6 steps/s
[Step=29600 Epoch=113.4] | Loss=0.00000 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.449 | L2-Norm(final)=6.687 | 3734.1 samples/s | 58.3 steps/s
[Step=29650 Epoch=113.6] | Loss=0.00000 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.420 | L2-Norm(final)=6.687 | 3687.6 samples/s | 57.6 steps/s
[Step=29700 Epoch=113.8] | Loss=0.00000 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.391 | L2-Norm(final)=6.688 | 3695.5 samples/s | 57.7 steps/s
[Step=29750 Epoch=114.0] | Loss=0.00000 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=6.688 | 3702.2 samples/s | 57.8 steps/s
[Step=29800 Epoch=114.2] | Loss=0.00000 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.332 | L2-Norm(final)=6.688 | 5090.6 samples/s | 79.5 steps/s
[Step=29850 Epoch=114.4] | Loss=0.00000 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.303 | L2-Norm(final)=6.689 | 1391.8 samples/s | 21.7 steps/s
[Step=29900 Epoch=114.6] | Loss=0.00000 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.273 | L2-Norm(final)=6.689 | 3710.3 samples/s | 58.0 steps/s
[Step=29950 Epoch=114.8] | Loss=0.00000 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.243 | L2-Norm(final)=6.690 | 3653.1 samples/s | 57.1 steps/s
[Step=30000 Epoch=114.9] | Loss=0.00000 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.213 | L2-Norm(final)=6.690 | 3698.0 samples/s | 57.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step30000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=28001 Epoch=107.8] | Loss=0.00043 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.851 | L2-Norm(final)=7.301 | 3018.0 samples/s | 47.2 steps/s
[Step=28050 Epoch=108.0] | Loss=0.00143 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.894 | L2-Norm(final)=7.313 | 4088.4 samples/s | 63.9 steps/s
[Step=28100 Epoch=108.2] | Loss=0.00146 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.967 | L2-Norm(final)=7.317 | 4107.6 samples/s | 64.2 steps/s
[Step=28150 Epoch=108.4] | Loss=0.00127 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.016 | L2-Norm(final)=7.322 | 4128.6 samples/s | 64.5 steps/s
[Step=28200 Epoch=108.6] | Loss=0.00101 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.047 | L2-Norm(final)=7.328 | 4150.9 samples/s | 64.9 steps/s
[Step=28250 Epoch=108.7] | Loss=0.00083 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.062 | L2-Norm(final)=7.333 | 5385.6 samples/s | 84.2 steps/s
[Step=28300 Epoch=108.9] | Loss=0.00072 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.069 | L2-Norm(final)=7.338 | 1662.6 samples/s | 26.0 steps/s
[Step=28350 Epoch=109.1] | Loss=0.00063 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.071 | L2-Norm(final)=7.343 | 4633.9 samples/s | 72.4 steps/s
[Step=28400 Epoch=109.3] | Loss=0.00055 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.070 | L2-Norm(final)=7.347 | 4952.1 samples/s | 77.4 steps/s
[Step=28450 Epoch=109.5] | Loss=0.00050 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.067 | L2-Norm(final)=7.351 | 4904.8 samples/s | 76.6 steps/s
[Step=28500 Epoch=109.7] | Loss=0.00045 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.062 | L2-Norm(final)=7.355 | 5688.0 samples/s | 88.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=28501 Epoch=109.7] | Loss=0.00000 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.010 | L2-Norm(final)=7.391 | 3707.1 samples/s | 57.9 steps/s
[Step=28550 Epoch=109.9] | Loss=0.00003 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.991 | L2-Norm(final)=7.394 | 4021.4 samples/s | 62.8 steps/s
[Step=28600 Epoch=110.1] | Loss=0.00003 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.969 | L2-Norm(final)=7.396 | 4305.0 samples/s | 67.3 steps/s
[Step=28650 Epoch=110.3] | Loss=0.00002 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.947 | L2-Norm(final)=7.398 | 4570.6 samples/s | 71.4 steps/s
[Step=28700 Epoch=110.5] | Loss=0.00002 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.924 | L2-Norm(final)=7.399 | 4232.6 samples/s | 66.1 steps/s
[Step=28750 Epoch=110.7] | Loss=0.00002 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.901 | L2-Norm(final)=7.401 | 5755.7 samples/s | 89.9 steps/s
[Step=28800 Epoch=110.9] | Loss=0.00002 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.878 | L2-Norm(final)=7.402 | 1695.5 samples/s | 26.5 steps/s
[Step=28850 Epoch=111.1] | Loss=0.00001 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.855 | L2-Norm(final)=7.403 | 4401.6 samples/s | 68.8 steps/s
[Step=28900 Epoch=111.2] | Loss=0.00001 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.832 | L2-Norm(final)=7.404 | 4465.6 samples/s | 69.8 steps/s
[Step=28950 Epoch=111.4] | Loss=0.00001 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.808 | L2-Norm(final)=7.405 | 4309.8 samples/s | 67.3 steps/s
[Step=29000 Epoch=111.6] | Loss=0.00001 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=7.405 | 4923.4 samples/s | 76.9 steps/s
[Step=29050 Epoch=111.8] | Loss=0.00001 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.761 | L2-Norm(final)=7.406 | 1814.4 samples/s | 28.3 steps/s
[Step=29100 Epoch=112.0] | Loss=0.00001 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.738 | L2-Norm(final)=7.407 | 4611.0 samples/s | 72.0 steps/s
[Step=29150 Epoch=112.2] | Loss=0.00001 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=7.407 | 4339.3 samples/s | 67.8 steps/s
[Step=29200 Epoch=112.4] | Loss=0.00001 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.690 | L2-Norm(final)=7.408 | 4602.9 samples/s | 71.9 steps/s
[Step=29250 Epoch=112.6] | Loss=0.00001 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.666 | L2-Norm(final)=7.408 | 4530.8 samples/s | 70.8 steps/s
[Step=29300 Epoch=112.8] | Loss=0.00001 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.642 | L2-Norm(final)=7.409 | 1853.7 samples/s | 29.0 steps/s
[Step=29350 Epoch=113.0] | Loss=0.00001 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=7.409 | 4647.4 samples/s | 72.6 steps/s
[Step=29400 Epoch=113.2] | Loss=0.00001 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.594 | L2-Norm(final)=7.410 | 4415.1 samples/s | 69.0 steps/s
[Step=29450 Epoch=113.4] | Loss=0.00001 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.569 | L2-Norm(final)=7.410 | 4394.7 samples/s | 68.7 steps/s
[Step=29500 Epoch=113.6] | Loss=0.00001 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.545 | L2-Norm(final)=7.411 | 4515.1 samples/s | 70.5 steps/s
[Step=29550 Epoch=113.7] | Loss=0.00001 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.520 | L2-Norm(final)=7.411 | 1815.2 samples/s | 28.4 steps/s
[Step=29600 Epoch=113.9] | Loss=0.00001 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.496 | L2-Norm(final)=7.412 | 4457.3 samples/s | 69.6 steps/s
[Step=29650 Epoch=114.1] | Loss=0.00001 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.471 | L2-Norm(final)=7.412 | 4463.5 samples/s | 69.7 steps/s
[Step=29700 Epoch=114.3] | Loss=0.00001 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.446 | L2-Norm(final)=7.413 | 4387.2 samples/s | 68.5 steps/s
[Step=29750 Epoch=114.5] | Loss=0.00001 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.422 | L2-Norm(final)=7.413 | 4242.5 samples/s | 66.3 steps/s
[Step=29800 Epoch=114.7] | Loss=0.00001 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.397 | L2-Norm(final)=7.414 | 6324.2 samples/s | 98.8 steps/s
[Step=29850 Epoch=114.9] | Loss=0.00001 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=7.414 | 1615.8 samples/s | 25.2 steps/s
[Step=29900 Epoch=115.1] | Loss=0.00001 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=7.415 | 4316.7 samples/s | 67.4 steps/s
[Step=29950 Epoch=115.3] | Loss=0.00001 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.321 | L2-Norm(final)=7.415 | 4286.2 samples/s | 67.0 steps/s
[Step=30000 Epoch=115.5] | Loss=0.00001 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.295 | L2-Norm(final)=7.416 | 4153.4 samples/s | 64.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step30000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06043 | acc=0.9678 | tpr=0.9744 | fpr=0.0466 | 4069.4 samples/s | 15.9 steps/s
Avg test loss: 0.06411, Avg test acc: 0.96658, Avg tpr: 0.97278, Avg fpr: 0.04705, total FA: 367

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07021 | acc=0.9659 | tpr=0.9688 | fpr=0.0404 | 3540.0 samples/s | 13.8 steps/s
Avg test loss: 0.08035, Avg test acc: 0.96254, Avg tpr: 0.96520, Avg fpr: 0.04333, total FA: 338

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.31453 | acc=0.3113 | tpr=0.0187 | fpr=0.0535 | 3528.6 samples/s | 13.8 steps/s
Avg test loss: 6.33033, Avg test acc: 0.30892, Avg tpr: 0.01918, Avg fpr: 0.05384, total FA: 420

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.67460 | acc=0.3130 | tpr=0.0286 | fpr=0.0696 | 3528.9 samples/s | 13.8 steps/s
Avg test loss: 5.67624, Avg test acc: 0.31140, Avg tpr: 0.03019, Avg fpr: 0.07012, total FA: 547

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.95313 | acc=0.1005 | tpr=0.7788 | fpr=0.9117 | 3530.7 samples/s | 13.8 steps/s
[Step= 100] | Loss=5.92853 | acc=0.1029 | tpr=0.7953 | fpr=0.9101 | 6878.9 samples/s | 26.9 steps/s
[Step= 150] | Loss=5.93498 | acc=0.1012 | tpr=0.7968 | fpr=0.9116 | 6816.5 samples/s | 26.6 steps/s
[Step= 200] | Loss=5.91845 | acc=0.1006 | tpr=0.7891 | fpr=0.9119 | 6849.0 samples/s | 26.8 steps/s
[Step= 250] | Loss=5.90893 | acc=0.1007 | tpr=0.7930 | fpr=0.9119 | 6695.7 samples/s | 26.2 steps/s
[Step= 300] | Loss=5.91320 | acc=0.1009 | tpr=0.7913 | fpr=0.9117 | 6863.5 samples/s | 26.8 steps/s
[Step= 350] | Loss=5.90853 | acc=0.1005 | tpr=0.7902 | fpr=0.9120 | 6967.7 samples/s | 27.2 steps/s
[Step= 400] | Loss=5.90359 | acc=0.1005 | tpr=0.7867 | fpr=0.9120 | 6855.9 samples/s | 26.8 steps/s
[Step= 450] | Loss=5.91169 | acc=0.1003 | tpr=0.7882 | fpr=0.9121 | 6788.6 samples/s | 26.5 steps/s
[Step= 500] | Loss=5.91665 | acc=0.1004 | tpr=0.7903 | fpr=0.9120 | 7012.3 samples/s | 27.4 steps/s
[Step= 550] | Loss=5.91741 | acc=0.1007 | tpr=0.7959 | fpr=0.9119 | 12078.9 samples/s | 47.2 steps/s
Avg test loss: 5.91957, Avg test acc: 0.10065, Avg tpr: 0.79556, Avg fpr: 0.91198, total FA: 126627

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.38972 | acc=0.1091 | tpr=0.7699 | fpr=0.9027 | 3500.7 samples/s | 13.7 steps/s
[Step= 100] | Loss=6.35700 | acc=0.1091 | tpr=0.7953 | fpr=0.9037 | 6847.8 samples/s | 26.7 steps/s
[Step= 150] | Loss=6.37921 | acc=0.1084 | tpr=0.7997 | fpr=0.9043 | 7217.6 samples/s | 28.2 steps/s
[Step= 200] | Loss=6.35905 | acc=0.1083 | tpr=0.7749 | fpr=0.9038 | 6689.6 samples/s | 26.1 steps/s
[Step= 250] | Loss=6.35950 | acc=0.1082 | tpr=0.7721 | fpr=0.9039 | 6842.7 samples/s | 26.7 steps/s
[Step= 300] | Loss=6.36432 | acc=0.1083 | tpr=0.7745 | fpr=0.9039 | 7041.7 samples/s | 27.5 steps/s
[Step= 350] | Loss=6.36168 | acc=0.1082 | tpr=0.7733 | fpr=0.9039 | 6793.1 samples/s | 26.5 steps/s
[Step= 400] | Loss=6.35796 | acc=0.1087 | tpr=0.7752 | fpr=0.9034 | 6829.5 samples/s | 26.7 steps/s
[Step= 450] | Loss=6.36691 | acc=0.1084 | tpr=0.7751 | fpr=0.9038 | 6838.4 samples/s | 26.7 steps/s
[Step= 500] | Loss=6.36952 | acc=0.1080 | tpr=0.7753 | fpr=0.9041 | 6760.4 samples/s | 26.4 steps/s
[Step= 550] | Loss=6.37158 | acc=0.1082 | tpr=0.7799 | fpr=0.9040 | 12356.4 samples/s | 48.3 steps/s
Avg test loss: 6.37342, Avg test acc: 0.10815, Avg tpr: 0.77971, Avg fpr: 0.90405, total FA: 125526

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11784 | acc=0.9816 | tpr=0.9204 | fpr=0.0173 | 3504.8 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.12168 | acc=0.9816 | tpr=0.9360 | fpr=0.0175 | 6924.9 samples/s | 27.1 steps/s
[Step= 150] | Loss=0.12447 | acc=0.9810 | tpr=0.9352 | fpr=0.0181 | 7096.4 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.12540 | acc=0.9813 | tpr=0.9366 | fpr=0.0179 | 6688.6 samples/s | 26.1 steps/s
[Step= 250] | Loss=0.12276 | acc=0.9816 | tpr=0.9380 | fpr=0.0176 | 7014.7 samples/s | 27.4 steps/s
[Step= 300] | Loss=0.12514 | acc=0.9812 | tpr=0.9404 | fpr=0.0180 | 6760.6 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.12490 | acc=0.9812 | tpr=0.9405 | fpr=0.0180 | 6900.3 samples/s | 27.0 steps/s
[Step= 400] | Loss=0.12695 | acc=0.9810 | tpr=0.9354 | fpr=0.0181 | 6645.3 samples/s | 26.0 steps/s
[Step= 450] | Loss=0.12920 | acc=0.9808 | tpr=0.9343 | fpr=0.0184 | 6954.8 samples/s | 27.2 steps/s
[Step= 500] | Loss=0.12866 | acc=0.9809 | tpr=0.9370 | fpr=0.0183 | 6589.5 samples/s | 25.7 steps/s
[Step= 550] | Loss=0.12809 | acc=0.9811 | tpr=0.9367 | fpr=0.0181 | 12572.2 samples/s | 49.1 steps/s
Avg test loss: 0.12802, Avg test acc: 0.98104, Avg tpr: 0.93621, Avg fpr: 0.01814, total FA: 2519

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11734 | acc=0.9805 | tpr=0.9336 | fpr=0.0186 | 3513.2 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.12081 | acc=0.9811 | tpr=0.9531 | fpr=0.0184 | 6962.1 samples/s | 27.2 steps/s
[Step= 150] | Loss=0.12348 | acc=0.9804 | tpr=0.9496 | fpr=0.0190 | 6791.2 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.12468 | acc=0.9804 | tpr=0.9530 | fpr=0.0191 | 6830.1 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.12347 | acc=0.9806 | tpr=0.9537 | fpr=0.0189 | 6969.9 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.12628 | acc=0.9802 | tpr=0.9520 | fpr=0.0193 | 6898.9 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.12581 | acc=0.9803 | tpr=0.9530 | fpr=0.0192 | 6981.1 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.12762 | acc=0.9801 | tpr=0.9508 | fpr=0.0193 | 6725.4 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.12991 | acc=0.9799 | tpr=0.9494 | fpr=0.0196 | 6755.1 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.12959 | acc=0.9798 | tpr=0.9511 | fpr=0.0196 | 6904.3 samples/s | 27.0 steps/s
[Step= 550] | Loss=0.12899 | acc=0.9800 | tpr=0.9499 | fpr=0.0195 | 12703.1 samples/s | 49.6 steps/s
Avg test loss: 0.12897, Avg test acc: 0.97997, Avg tpr: 0.94929, Avg fpr: 0.01947, total FA: 2703

server round 15/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=30001 Epoch=58.5] | Loss=0.01951 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.334 | L2-Norm(final)=7.137 | 3054.4 samples/s | 47.7 steps/s
[Step=30050 Epoch=58.6] | Loss=0.01540 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.387 | L2-Norm(final)=7.145 | 4236.4 samples/s | 66.2 steps/s
[Step=30100 Epoch=58.7] | Loss=0.01521 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.429 | L2-Norm(final)=7.146 | 4367.0 samples/s | 68.2 steps/s
[Step=30150 Epoch=58.8] | Loss=0.01424 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.450 | L2-Norm(final)=7.149 | 4370.9 samples/s | 68.3 steps/s
[Step=30200 Epoch=58.9] | Loss=0.01444 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.466 | L2-Norm(final)=7.154 | 4387.5 samples/s | 68.6 steps/s
[Step=30250 Epoch=59.0] | Loss=0.01367 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.479 | L2-Norm(final)=7.158 | 4316.3 samples/s | 67.4 steps/s
[Step=30300 Epoch=59.1] | Loss=0.01309 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.491 | L2-Norm(final)=7.163 | 4376.2 samples/s | 68.4 steps/s
[Step=30350 Epoch=59.2] | Loss=0.01254 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.502 | L2-Norm(final)=7.169 | 4311.5 samples/s | 67.4 steps/s
[Step=30400 Epoch=59.3] | Loss=0.01224 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.513 | L2-Norm(final)=7.175 | 4336.8 samples/s | 67.8 steps/s
[Step=30450 Epoch=59.4] | Loss=0.01192 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.524 | L2-Norm(final)=7.182 | 4391.3 samples/s | 68.6 steps/s
[Step=30500 Epoch=59.5] | Loss=0.01185 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.534 | L2-Norm(final)=7.188 | 5454.0 samples/s | 85.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=30501 Epoch=59.5] | Loss=0.00894 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.644 | L2-Norm(final)=7.245 | 3239.8 samples/s | 50.6 steps/s
[Step=30550 Epoch=59.6] | Loss=0.01178 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.660 | L2-Norm(final)=7.251 | 3606.6 samples/s | 56.4 steps/s
[Step=30600 Epoch=59.7] | Loss=0.01650 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.679 | L2-Norm(final)=7.246 | 3970.9 samples/s | 62.0 steps/s
[Step=30650 Epoch=59.8] | Loss=0.01726 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.700 | L2-Norm(final)=7.245 | 3919.1 samples/s | 61.2 steps/s
[Step=30700 Epoch=59.9] | Loss=0.01764 | Reg=0.00188 | acc=0.9531 | L2-Norm=13.724 | L2-Norm(final)=7.246 | 3877.0 samples/s | 60.6 steps/s
[Step=30750 Epoch=60.0] | Loss=0.01819 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.749 | L2-Norm(final)=7.245 | 3938.3 samples/s | 61.5 steps/s
[Step=30800 Epoch=60.1] | Loss=0.01804 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.772 | L2-Norm(final)=7.246 | 3946.0 samples/s | 61.7 steps/s
[Step=30850 Epoch=60.2] | Loss=0.01776 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.793 | L2-Norm(final)=7.248 | 3929.3 samples/s | 61.4 steps/s
[Step=30900 Epoch=60.3] | Loss=0.01750 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.812 | L2-Norm(final)=7.250 | 3909.6 samples/s | 61.1 steps/s
[Step=30950 Epoch=60.4] | Loss=0.01768 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.830 | L2-Norm(final)=7.251 | 3947.3 samples/s | 61.7 steps/s
[Step=31000 Epoch=60.5] | Loss=0.01772 | Reg=0.00192 | acc=0.9531 | L2-Norm=13.848 | L2-Norm(final)=7.252 | 4782.9 samples/s | 74.7 steps/s
[Step=31050 Epoch=60.6] | Loss=0.01733 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.865 | L2-Norm(final)=7.253 | 1526.7 samples/s | 23.9 steps/s
[Step=31100 Epoch=60.7] | Loss=0.01706 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.881 | L2-Norm(final)=7.255 | 3888.2 samples/s | 60.8 steps/s
[Step=31150 Epoch=60.8] | Loss=0.01638 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.896 | L2-Norm(final)=7.258 | 3884.4 samples/s | 60.7 steps/s
[Step=31200 Epoch=60.9] | Loss=0.01654 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.911 | L2-Norm(final)=7.260 | 3914.0 samples/s | 61.2 steps/s
[Step=31250 Epoch=60.9] | Loss=0.01637 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.925 | L2-Norm(final)=7.262 | 3906.1 samples/s | 61.0 steps/s
[Step=31300 Epoch=61.0] | Loss=0.01621 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.939 | L2-Norm(final)=7.264 | 3926.6 samples/s | 61.4 steps/s
[Step=31350 Epoch=61.1] | Loss=0.01607 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.953 | L2-Norm(final)=7.266 | 4002.7 samples/s | 62.5 steps/s
[Step=31400 Epoch=61.2] | Loss=0.01566 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.966 | L2-Norm(final)=7.268 | 3911.1 samples/s | 61.1 steps/s
[Step=31450 Epoch=61.3] | Loss=0.01571 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.979 | L2-Norm(final)=7.270 | 3957.7 samples/s | 61.8 steps/s
[Step=31500 Epoch=61.4] | Loss=0.01570 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.991 | L2-Norm(final)=7.272 | 4150.3 samples/s | 64.8 steps/s
[Step=31550 Epoch=61.5] | Loss=0.01563 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.004 | L2-Norm(final)=7.273 | 1514.6 samples/s | 23.7 steps/s
[Step=31600 Epoch=61.6] | Loss=0.01536 | Reg=0.00196 | acc=0.9688 | L2-Norm=14.016 | L2-Norm(final)=7.275 | 3943.9 samples/s | 61.6 steps/s
[Step=31650 Epoch=61.7] | Loss=0.01521 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.028 | L2-Norm(final)=7.277 | 3890.1 samples/s | 60.8 steps/s
[Step=31700 Epoch=61.8] | Loss=0.01517 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.040 | L2-Norm(final)=7.279 | 3954.4 samples/s | 61.8 steps/s
[Step=31750 Epoch=61.9] | Loss=0.01508 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.051 | L2-Norm(final)=7.280 | 3916.7 samples/s | 61.2 steps/s
[Step=31800 Epoch=62.0] | Loss=0.01491 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.062 | L2-Norm(final)=7.282 | 3948.4 samples/s | 61.7 steps/s
[Step=31850 Epoch=62.1] | Loss=0.01489 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.072 | L2-Norm(final)=7.283 | 3915.4 samples/s | 61.2 steps/s
[Step=31900 Epoch=62.2] | Loss=0.01480 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.083 | L2-Norm(final)=7.285 | 3964.4 samples/s | 61.9 steps/s
[Step=31950 Epoch=62.3] | Loss=0.01470 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.094 | L2-Norm(final)=7.286 | 3961.9 samples/s | 61.9 steps/s
[Step=32000 Epoch=62.4] | Loss=0.01466 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.104 | L2-Norm(final)=7.288 | 3937.8 samples/s | 61.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step32000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=30001 Epoch=58.7] | Loss=0.00152 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.334 | L2-Norm(final)=7.458 | 3240.5 samples/s | 50.6 steps/s
[Step=30050 Epoch=58.7] | Loss=0.01338 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.390 | L2-Norm(final)=7.463 | 4222.7 samples/s | 66.0 steps/s
[Step=30100 Epoch=58.8] | Loss=0.01257 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.421 | L2-Norm(final)=7.470 | 4306.6 samples/s | 67.3 steps/s
[Step=30150 Epoch=58.9] | Loss=0.01346 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.438 | L2-Norm(final)=7.478 | 4358.0 samples/s | 68.1 steps/s
[Step=30200 Epoch=59.0] | Loss=0.01285 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=7.484 | 4416.7 samples/s | 69.0 steps/s
[Step=30250 Epoch=59.1] | Loss=0.01209 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.464 | L2-Norm(final)=7.491 | 4369.1 samples/s | 68.3 steps/s
[Step=30300 Epoch=59.2] | Loss=0.01166 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.476 | L2-Norm(final)=7.500 | 4353.0 samples/s | 68.0 steps/s
[Step=30350 Epoch=59.3] | Loss=0.01211 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.488 | L2-Norm(final)=7.509 | 4385.7 samples/s | 68.5 steps/s
[Step=30400 Epoch=59.4] | Loss=0.01192 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.501 | L2-Norm(final)=7.515 | 4362.1 samples/s | 68.2 steps/s
[Step=30450 Epoch=59.5] | Loss=0.01184 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.512 | L2-Norm(final)=7.521 | 4368.6 samples/s | 68.3 steps/s
[Step=30500 Epoch=59.6] | Loss=0.01186 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.523 | L2-Norm(final)=7.527 | 5649.0 samples/s | 88.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=30501 Epoch=59.6] | Loss=0.00156 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.634 | L2-Norm(final)=7.590 | 3331.3 samples/s | 52.1 steps/s
[Step=30550 Epoch=59.7] | Loss=0.01109 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.648 | L2-Norm(final)=7.597 | 3727.9 samples/s | 58.2 steps/s
[Step=30600 Epoch=59.8] | Loss=0.01196 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.666 | L2-Norm(final)=7.605 | 3896.8 samples/s | 60.9 steps/s
[Step=30650 Epoch=59.9] | Loss=0.01487 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.688 | L2-Norm(final)=7.608 | 3952.8 samples/s | 61.8 steps/s
[Step=30700 Epoch=60.0] | Loss=0.01453 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.709 | L2-Norm(final)=7.610 | 3921.7 samples/s | 61.3 steps/s
[Step=30750 Epoch=60.1] | Loss=0.01493 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.728 | L2-Norm(final)=7.613 | 3936.2 samples/s | 61.5 steps/s
[Step=30800 Epoch=60.2] | Loss=0.01567 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.748 | L2-Norm(final)=7.614 | 3912.5 samples/s | 61.1 steps/s
[Step=30850 Epoch=60.3] | Loss=0.01603 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.767 | L2-Norm(final)=7.615 | 3949.7 samples/s | 61.7 steps/s
[Step=30900 Epoch=60.4] | Loss=0.01656 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.787 | L2-Norm(final)=7.616 | 3968.3 samples/s | 62.0 steps/s
[Step=30950 Epoch=60.5] | Loss=0.01669 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.806 | L2-Norm(final)=7.618 | 4010.0 samples/s | 62.7 steps/s
[Step=31000 Epoch=60.6] | Loss=0.01657 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.825 | L2-Norm(final)=7.620 | 4863.5 samples/s | 76.0 steps/s
[Step=31050 Epoch=60.7] | Loss=0.01629 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.843 | L2-Norm(final)=7.624 | 1489.1 samples/s | 23.3 steps/s
[Step=31100 Epoch=60.8] | Loss=0.01634 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.859 | L2-Norm(final)=7.626 | 3882.9 samples/s | 60.7 steps/s
[Step=31150 Epoch=60.9] | Loss=0.01620 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.875 | L2-Norm(final)=7.628 | 3963.5 samples/s | 61.9 steps/s
[Step=31200 Epoch=61.0] | Loss=0.01566 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.891 | L2-Norm(final)=7.631 | 3934.1 samples/s | 61.5 steps/s
[Step=31250 Epoch=61.1] | Loss=0.01559 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.906 | L2-Norm(final)=7.635 | 3923.9 samples/s | 61.3 steps/s
[Step=31300 Epoch=61.2] | Loss=0.01530 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.920 | L2-Norm(final)=7.638 | 3996.5 samples/s | 62.4 steps/s
[Step=31350 Epoch=61.3] | Loss=0.01530 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.933 | L2-Norm(final)=7.640 | 3968.8 samples/s | 62.0 steps/s
[Step=31400 Epoch=61.4] | Loss=0.01510 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.946 | L2-Norm(final)=7.642 | 3984.6 samples/s | 62.3 steps/s
[Step=31450 Epoch=61.5] | Loss=0.01504 | Reg=0.00195 | acc=0.9531 | L2-Norm=13.959 | L2-Norm(final)=7.644 | 3929.7 samples/s | 61.4 steps/s
[Step=31500 Epoch=61.6] | Loss=0.01490 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.972 | L2-Norm(final)=7.646 | 4291.8 samples/s | 67.1 steps/s
[Step=31550 Epoch=61.7] | Loss=0.01471 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.984 | L2-Norm(final)=7.648 | 1588.6 samples/s | 24.8 steps/s
[Step=31600 Epoch=61.8] | Loss=0.01452 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.995 | L2-Norm(final)=7.650 | 3936.7 samples/s | 61.5 steps/s
[Step=31650 Epoch=61.9] | Loss=0.01434 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.006 | L2-Norm(final)=7.653 | 3983.2 samples/s | 62.2 steps/s
[Step=31700 Epoch=62.0] | Loss=0.01411 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.017 | L2-Norm(final)=7.655 | 3929.8 samples/s | 61.4 steps/s
[Step=31750 Epoch=62.1] | Loss=0.01392 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.027 | L2-Norm(final)=7.657 | 3950.3 samples/s | 61.7 steps/s
[Step=31800 Epoch=62.2] | Loss=0.01381 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.037 | L2-Norm(final)=7.659 | 3925.8 samples/s | 61.3 steps/s
[Step=31850 Epoch=62.3] | Loss=0.01388 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.046 | L2-Norm(final)=7.661 | 3975.9 samples/s | 62.1 steps/s
[Step=31900 Epoch=62.4] | Loss=0.01385 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.056 | L2-Norm(final)=7.663 | 3960.4 samples/s | 61.9 steps/s
[Step=31950 Epoch=62.5] | Loss=0.01369 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.065 | L2-Norm(final)=7.664 | 3948.6 samples/s | 61.7 steps/s
[Step=32000 Epoch=62.6] | Loss=0.01353 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.073 | L2-Norm(final)=7.666 | 3932.4 samples/s | 61.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step32000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=30001 Epoch=115.0] | Loss=0.00112 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.334 | L2-Norm(final)=6.703 | 3290.2 samples/s | 51.4 steps/s
[Step=30050 Epoch=115.1] | Loss=0.00259 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.431 | L2-Norm(final)=6.711 | 3712.4 samples/s | 58.0 steps/s
[Step=30100 Epoch=115.3] | Loss=0.00225 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.552 | L2-Norm(final)=6.716 | 4210.1 samples/s | 65.8 steps/s
[Step=30150 Epoch=115.5] | Loss=0.00204 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=6.719 | 4057.0 samples/s | 63.4 steps/s
[Step=30200 Epoch=115.7] | Loss=0.00169 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.658 | L2-Norm(final)=6.721 | 4131.6 samples/s | 64.6 steps/s
[Step=30250 Epoch=115.9] | Loss=0.00139 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.680 | L2-Norm(final)=6.723 | 5354.5 samples/s | 83.7 steps/s
[Step=30300 Epoch=116.1] | Loss=0.00121 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.694 | L2-Norm(final)=6.726 | 1497.5 samples/s | 23.4 steps/s
[Step=30350 Epoch=116.3] | Loss=0.00105 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.701 | L2-Norm(final)=6.729 | 4055.2 samples/s | 63.4 steps/s
[Step=30400 Epoch=116.5] | Loss=0.00092 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.705 | L2-Norm(final)=6.732 | 4107.9 samples/s | 64.2 steps/s
[Step=30450 Epoch=116.7] | Loss=0.00082 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.705 | L2-Norm(final)=6.734 | 4139.1 samples/s | 64.7 steps/s
[Step=30500 Epoch=116.9] | Loss=0.00075 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.703 | L2-Norm(final)=6.737 | 4643.7 samples/s | 72.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=30501 Epoch=116.9] | Loss=0.00007 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.676 | L2-Norm(final)=6.760 | 3223.3 samples/s | 50.4 steps/s
[Step=30550 Epoch=117.1] | Loss=0.00547 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.699 | L2-Norm(final)=6.758 | 3445.2 samples/s | 53.8 steps/s
[Step=30600 Epoch=117.2] | Loss=0.01286 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.851 | L2-Norm(final)=6.717 | 3711.2 samples/s | 58.0 steps/s
[Step=30650 Epoch=117.4] | Loss=0.00924 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.938 | L2-Norm(final)=6.693 | 3756.3 samples/s | 58.7 steps/s
[Step=30700 Epoch=117.6] | Loss=0.00721 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.984 | L2-Norm(final)=6.684 | 3663.4 samples/s | 57.2 steps/s
[Step=30750 Epoch=117.8] | Loss=0.00605 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.011 | L2-Norm(final)=6.680 | 4852.4 samples/s | 75.8 steps/s
[Step=30800 Epoch=118.0] | Loss=0.00507 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.027 | L2-Norm(final)=6.677 | 1468.2 samples/s | 22.9 steps/s
[Step=30850 Epoch=118.2] | Loss=0.00449 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.036 | L2-Norm(final)=6.676 | 3712.2 samples/s | 58.0 steps/s
[Step=30900 Epoch=118.4] | Loss=0.00397 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.041 | L2-Norm(final)=6.675 | 3730.6 samples/s | 58.3 steps/s
[Step=30950 Epoch=118.6] | Loss=0.00354 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.044 | L2-Norm(final)=6.674 | 3718.7 samples/s | 58.1 steps/s
[Step=31000 Epoch=118.8] | Loss=0.00319 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.044 | L2-Norm(final)=6.673 | 4109.8 samples/s | 64.2 steps/s
[Step=31050 Epoch=119.0] | Loss=0.00292 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.042 | L2-Norm(final)=6.673 | 1535.3 samples/s | 24.0 steps/s
[Step=31100 Epoch=119.2] | Loss=0.00268 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.039 | L2-Norm(final)=6.673 | 3747.9 samples/s | 58.6 steps/s
[Step=31150 Epoch=119.4] | Loss=0.00247 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.036 | L2-Norm(final)=6.673 | 3683.0 samples/s | 57.5 steps/s
[Step=31200 Epoch=119.5] | Loss=0.00230 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.031 | L2-Norm(final)=6.674 | 3744.0 samples/s | 58.5 steps/s
[Step=31250 Epoch=119.7] | Loss=0.00214 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.026 | L2-Norm(final)=6.674 | 3729.2 samples/s | 58.3 steps/s
[Step=31300 Epoch=119.9] | Loss=0.00201 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.020 | L2-Norm(final)=6.674 | 1614.9 samples/s | 25.2 steps/s
[Step=31350 Epoch=120.1] | Loss=0.00189 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.014 | L2-Norm(final)=6.674 | 3741.5 samples/s | 58.5 steps/s
[Step=31400 Epoch=120.3] | Loss=0.00179 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.007 | L2-Norm(final)=6.675 | 3708.3 samples/s | 57.9 steps/s
[Step=31450 Epoch=120.5] | Loss=0.00170 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.000 | L2-Norm(final)=6.675 | 3722.0 samples/s | 58.2 steps/s
[Step=31500 Epoch=120.7] | Loss=0.00161 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.993 | L2-Norm(final)=6.675 | 3684.6 samples/s | 57.6 steps/s
[Step=31550 Epoch=120.9] | Loss=0.00153 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.985 | L2-Norm(final)=6.676 | 1598.6 samples/s | 25.0 steps/s
[Step=31600 Epoch=121.1] | Loss=0.00147 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.978 | L2-Norm(final)=6.676 | 3767.0 samples/s | 58.9 steps/s
[Step=31650 Epoch=121.3] | Loss=0.00140 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.970 | L2-Norm(final)=6.676 | 3654.9 samples/s | 57.1 steps/s
[Step=31700 Epoch=121.5] | Loss=0.00134 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=6.677 | 3734.0 samples/s | 58.3 steps/s
[Step=31750 Epoch=121.7] | Loss=0.00129 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.953 | L2-Norm(final)=6.677 | 3765.9 samples/s | 58.8 steps/s
[Step=31800 Epoch=121.8] | Loss=0.00124 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.945 | L2-Norm(final)=6.677 | 5074.2 samples/s | 79.3 steps/s
[Step=31850 Epoch=122.0] | Loss=0.00120 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.936 | L2-Norm(final)=6.678 | 1398.7 samples/s | 21.9 steps/s
[Step=31900 Epoch=122.2] | Loss=0.00115 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.927 | L2-Norm(final)=6.678 | 3715.5 samples/s | 58.1 steps/s
[Step=31950 Epoch=122.4] | Loss=0.00111 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.918 | L2-Norm(final)=6.678 | 3692.2 samples/s | 57.7 steps/s
[Step=32000 Epoch=122.6] | Loss=0.00108 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.909 | L2-Norm(final)=6.679 | 3752.5 samples/s | 58.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step32000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=30001 Epoch=115.5] | Loss=0.00804 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.334 | L2-Norm(final)=7.432 | 3298.0 samples/s | 51.5 steps/s
[Step=30050 Epoch=115.7] | Loss=0.00511 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.445 | L2-Norm(final)=7.430 | 3963.9 samples/s | 61.9 steps/s
[Step=30100 Epoch=115.9] | Loss=0.00421 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.566 | L2-Norm(final)=7.421 | 4152.6 samples/s | 64.9 steps/s
[Step=30150 Epoch=116.1] | Loss=0.00298 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.638 | L2-Norm(final)=7.416 | 4183.5 samples/s | 65.4 steps/s
[Step=30200 Epoch=116.3] | Loss=0.00253 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.679 | L2-Norm(final)=7.415 | 4020.6 samples/s | 62.8 steps/s
[Step=30250 Epoch=116.4] | Loss=0.00224 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.707 | L2-Norm(final)=7.416 | 5499.7 samples/s | 85.9 steps/s
[Step=30300 Epoch=116.6] | Loss=0.00190 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.727 | L2-Norm(final)=7.418 | 1489.6 samples/s | 23.3 steps/s
[Step=30350 Epoch=116.8] | Loss=0.00164 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.740 | L2-Norm(final)=7.419 | 4072.6 samples/s | 63.6 steps/s
[Step=30400 Epoch=117.0] | Loss=0.00145 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.748 | L2-Norm(final)=7.421 | 4083.9 samples/s | 63.8 steps/s
[Step=30450 Epoch=117.2] | Loss=0.00130 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.753 | L2-Norm(final)=7.423 | 4058.8 samples/s | 63.4 steps/s
[Step=30500 Epoch=117.4] | Loss=0.00117 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.755 | L2-Norm(final)=7.425 | 4749.8 samples/s | 74.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=30501 Epoch=117.4] | Loss=0.00003 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.770 | L2-Norm(final)=7.445 | 3225.1 samples/s | 50.4 steps/s
[Step=30550 Epoch=117.6] | Loss=0.02468 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.868 | L2-Norm(final)=7.412 | 3409.6 samples/s | 53.3 steps/s
[Step=30600 Epoch=117.8] | Loss=0.01788 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.990 | L2-Norm(final)=7.372 | 3762.7 samples/s | 58.8 steps/s
[Step=30650 Epoch=118.0] | Loss=0.01292 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.038 | L2-Norm(final)=7.358 | 3689.3 samples/s | 57.6 steps/s
[Step=30700 Epoch=118.2] | Loss=0.00999 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.063 | L2-Norm(final)=7.353 | 3757.3 samples/s | 58.7 steps/s
[Step=30750 Epoch=118.4] | Loss=0.00806 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.077 | L2-Norm(final)=7.351 | 4779.2 samples/s | 74.7 steps/s
[Step=30800 Epoch=118.6] | Loss=0.00674 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.085 | L2-Norm(final)=7.350 | 1443.2 samples/s | 22.6 steps/s
[Step=30850 Epoch=118.8] | Loss=0.00578 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.088 | L2-Norm(final)=7.350 | 3699.8 samples/s | 57.8 steps/s
[Step=30900 Epoch=118.9] | Loss=0.00507 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=7.350 | 3750.4 samples/s | 58.6 steps/s
[Step=30950 Epoch=119.1] | Loss=0.00452 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.087 | L2-Norm(final)=7.351 | 3752.7 samples/s | 58.6 steps/s
[Step=31000 Epoch=119.3] | Loss=0.00408 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.085 | L2-Norm(final)=7.352 | 4210.4 samples/s | 65.8 steps/s
[Step=31050 Epoch=119.5] | Loss=0.00371 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.082 | L2-Norm(final)=7.353 | 1531.8 samples/s | 23.9 steps/s
[Step=31100 Epoch=119.7] | Loss=0.00340 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.078 | L2-Norm(final)=7.354 | 3756.6 samples/s | 58.7 steps/s
[Step=31150 Epoch=119.9] | Loss=0.00314 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.073 | L2-Norm(final)=7.355 | 3716.7 samples/s | 58.1 steps/s
[Step=31200 Epoch=120.1] | Loss=0.00292 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.068 | L2-Norm(final)=7.356 | 3683.4 samples/s | 57.6 steps/s
[Step=31250 Epoch=120.3] | Loss=0.00273 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.063 | L2-Norm(final)=7.357 | 3762.2 samples/s | 58.8 steps/s
[Step=31300 Epoch=120.5] | Loss=0.00256 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.057 | L2-Norm(final)=7.358 | 1549.6 samples/s | 24.2 steps/s
[Step=31350 Epoch=120.7] | Loss=0.00241 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.051 | L2-Norm(final)=7.358 | 3796.8 samples/s | 59.3 steps/s
[Step=31400 Epoch=120.9] | Loss=0.00228 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.045 | L2-Norm(final)=7.359 | 3660.8 samples/s | 57.2 steps/s
[Step=31450 Epoch=121.1] | Loss=0.00216 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.039 | L2-Norm(final)=7.360 | 3755.0 samples/s | 58.7 steps/s
[Step=31500 Epoch=121.3] | Loss=0.00205 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.032 | L2-Norm(final)=7.361 | 3731.1 samples/s | 58.3 steps/s
[Step=31550 Epoch=121.4] | Loss=0.00195 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.025 | L2-Norm(final)=7.362 | 1571.2 samples/s | 24.6 steps/s
[Step=31600 Epoch=121.6] | Loss=0.00187 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.018 | L2-Norm(final)=7.363 | 3762.4 samples/s | 58.8 steps/s
[Step=31650 Epoch=121.8] | Loss=0.00178 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.011 | L2-Norm(final)=7.364 | 3727.2 samples/s | 58.2 steps/s
[Step=31700 Epoch=122.0] | Loss=0.00171 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.004 | L2-Norm(final)=7.365 | 3724.2 samples/s | 58.2 steps/s
[Step=31750 Epoch=122.2] | Loss=0.00164 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.997 | L2-Norm(final)=7.366 | 3700.3 samples/s | 57.8 steps/s
[Step=31800 Epoch=122.4] | Loss=0.00158 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.989 | L2-Norm(final)=7.367 | 5530.7 samples/s | 86.4 steps/s
[Step=31850 Epoch=122.6] | Loss=0.00152 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.982 | L2-Norm(final)=7.368 | 1431.1 samples/s | 22.4 steps/s
[Step=31900 Epoch=122.8] | Loss=0.00147 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.974 | L2-Norm(final)=7.369 | 3722.6 samples/s | 58.2 steps/s
[Step=31950 Epoch=123.0] | Loss=0.00142 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.966 | L2-Norm(final)=7.370 | 3703.4 samples/s | 57.9 steps/s
[Step=32000 Epoch=123.2] | Loss=0.00137 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.958 | L2-Norm(final)=7.372 | 3694.2 samples/s | 57.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06542 | acc=0.9656 | tpr=0.9743 | fpr=0.0533 | 3499.3 samples/s | 13.7 steps/s
Avg test loss: 0.07155, Avg test acc: 0.96442, Avg tpr: 0.97290, Avg fpr: 0.05422, total FA: 423

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07261 | acc=0.9688 | tpr=0.9758 | fpr=0.0466 | 3542.2 samples/s | 13.8 steps/s
Avg test loss: 0.08146, Avg test acc: 0.96690, Avg tpr: 0.97366, Avg fpr: 0.04794, total FA: 374

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.62075 | acc=0.3106 | tpr=0.0209 | fpr=0.0602 | 3506.2 samples/s | 13.7 steps/s
Avg test loss: 5.64995, Avg test acc: 0.30788, Avg tpr: 0.02127, Avg fpr: 0.06179, total FA: 482

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.26910 | acc=0.3079 | tpr=0.0181 | fpr=0.0629 | 3517.4 samples/s | 13.7 steps/s
Avg test loss: 5.26421, Avg test acc: 0.30451, Avg tpr: 0.01906, Avg fpr: 0.06768, total FA: 528

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.54222 | acc=0.0980 | tpr=0.8496 | fpr=0.9155 | 3522.0 samples/s | 13.8 steps/s
[Step= 100] | Loss=6.50902 | acc=0.1003 | tpr=0.8678 | fpr=0.9141 | 6880.3 samples/s | 26.9 steps/s
[Step= 150] | Loss=6.51797 | acc=0.0986 | tpr=0.8617 | fpr=0.9155 | 6786.5 samples/s | 26.5 steps/s
[Step= 200] | Loss=6.50888 | acc=0.0981 | tpr=0.8481 | fpr=0.9156 | 7053.0 samples/s | 27.6 steps/s
[Step= 250] | Loss=6.50777 | acc=0.0983 | tpr=0.8472 | fpr=0.9153 | 6921.7 samples/s | 27.0 steps/s
[Step= 300] | Loss=6.50959 | acc=0.0980 | tpr=0.8524 | fpr=0.9158 | 6792.6 samples/s | 26.5 steps/s
[Step= 350] | Loss=6.50727 | acc=0.0983 | tpr=0.8491 | fpr=0.9153 | 6927.1 samples/s | 27.1 steps/s
[Step= 400] | Loss=6.50422 | acc=0.0983 | tpr=0.8441 | fpr=0.9152 | 6735.6 samples/s | 26.3 steps/s
[Step= 450] | Loss=6.51112 | acc=0.0981 | tpr=0.8432 | fpr=0.9154 | 6856.3 samples/s | 26.8 steps/s
[Step= 500] | Loss=6.51522 | acc=0.0980 | tpr=0.8432 | fpr=0.9154 | 6784.3 samples/s | 26.5 steps/s
[Step= 550] | Loss=6.51432 | acc=0.0981 | tpr=0.8436 | fpr=0.9155 | 12446.5 samples/s | 48.6 steps/s
Avg test loss: 6.51639, Avg test acc: 0.09801, Avg tpr: 0.84350, Avg fpr: 0.91554, total FA: 127121

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.57677 | acc=0.1029 | tpr=0.8142 | fpr=0.9099 | 3470.6 samples/s | 13.6 steps/s
[Step= 100] | Loss=7.52653 | acc=0.1039 | tpr=0.8252 | fpr=0.9096 | 6788.0 samples/s | 26.5 steps/s
[Step= 150] | Loss=7.54275 | acc=0.1028 | tpr=0.8184 | fpr=0.9104 | 6914.5 samples/s | 27.0 steps/s
[Step= 200] | Loss=7.52335 | acc=0.1023 | tpr=0.8066 | fpr=0.9105 | 6797.7 samples/s | 26.6 steps/s
[Step= 250] | Loss=7.53071 | acc=0.1018 | tpr=0.8052 | fpr=0.9110 | 6766.8 samples/s | 26.4 steps/s
[Step= 300] | Loss=7.53707 | acc=0.1021 | tpr=0.8080 | fpr=0.9108 | 6799.8 samples/s | 26.6 steps/s
[Step= 350] | Loss=7.53341 | acc=0.1022 | tpr=0.8103 | fpr=0.9107 | 6709.5 samples/s | 26.2 steps/s
[Step= 400] | Loss=7.53115 | acc=0.1019 | tpr=0.8080 | fpr=0.9109 | 7029.5 samples/s | 27.5 steps/s
[Step= 450] | Loss=7.54078 | acc=0.1016 | tpr=0.8077 | fpr=0.9112 | 6567.8 samples/s | 25.7 steps/s
[Step= 500] | Loss=7.54785 | acc=0.1015 | tpr=0.8062 | fpr=0.9112 | 6809.0 samples/s | 26.6 steps/s
[Step= 550] | Loss=7.54803 | acc=0.1019 | tpr=0.8102 | fpr=0.9110 | 11586.1 samples/s | 45.3 steps/s
Avg test loss: 7.55024, Avg test acc: 0.10178, Avg tpr: 0.80983, Avg fpr: 0.91109, total FA: 126503

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11496 | acc=0.9805 | tpr=0.9204 | fpr=0.0185 | 3518.1 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.11621 | acc=0.9805 | tpr=0.9424 | fpr=0.0188 | 6675.3 samples/s | 26.1 steps/s
[Step= 150] | Loss=0.12030 | acc=0.9797 | tpr=0.9481 | fpr=0.0197 | 6880.1 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.12215 | acc=0.9797 | tpr=0.9475 | fpr=0.0197 | 6852.5 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.11953 | acc=0.9800 | tpr=0.9467 | fpr=0.0194 | 6747.7 samples/s | 26.4 steps/s
[Step= 300] | Loss=0.12306 | acc=0.9795 | tpr=0.9462 | fpr=0.0198 | 6861.6 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.12343 | acc=0.9792 | tpr=0.9474 | fpr=0.0202 | 6861.3 samples/s | 26.8 steps/s
[Step= 400] | Loss=0.12539 | acc=0.9788 | tpr=0.9437 | fpr=0.0205 | 6931.0 samples/s | 27.1 steps/s
[Step= 450] | Loss=0.12688 | acc=0.9787 | tpr=0.9445 | fpr=0.0207 | 6673.8 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.12592 | acc=0.9789 | tpr=0.9480 | fpr=0.0206 | 6719.0 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.12496 | acc=0.9790 | tpr=0.9475 | fpr=0.0204 | 12741.5 samples/s | 49.8 steps/s
Avg test loss: 0.12479, Avg test acc: 0.97901, Avg tpr: 0.94691, Avg fpr: 0.02040, total FA: 2833

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11061 | acc=0.9817 | tpr=0.9248 | fpr=0.0173 | 3483.7 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.11769 | acc=0.9804 | tpr=0.9360 | fpr=0.0188 | 6902.0 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.12039 | acc=0.9796 | tpr=0.9366 | fpr=0.0197 | 6882.8 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.12178 | acc=0.9796 | tpr=0.9377 | fpr=0.0196 | 7004.3 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.12074 | acc=0.9797 | tpr=0.9362 | fpr=0.0195 | 6816.6 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.12334 | acc=0.9793 | tpr=0.9389 | fpr=0.0199 | 6808.4 samples/s | 26.6 steps/s
[Step= 350] | Loss=0.12312 | acc=0.9791 | tpr=0.9411 | fpr=0.0202 | 7011.8 samples/s | 27.4 steps/s
[Step= 400] | Loss=0.12496 | acc=0.9789 | tpr=0.9409 | fpr=0.0204 | 6817.8 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.12798 | acc=0.9785 | tpr=0.9391 | fpr=0.0208 | 6846.7 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.12763 | acc=0.9784 | tpr=0.9419 | fpr=0.0209 | 6877.4 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.12691 | acc=0.9786 | tpr=0.9411 | fpr=0.0207 | 11661.8 samples/s | 45.6 steps/s
Avg test loss: 0.12670, Avg test acc: 0.97862, Avg tpr: 0.94057, Avg fpr: 0.02069, total FA: 2873

server round 16/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=32001 Epoch=62.4] | Loss=0.04805 | Reg=0.00184 | acc=0.9531 | L2-Norm=13.564 | L2-Norm(final)=7.342 | 3086.9 samples/s | 48.2 steps/s
[Step=32050 Epoch=62.5] | Loss=0.02278 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.606 | L2-Norm(final)=7.356 | 4360.7 samples/s | 68.1 steps/s
[Step=32100 Epoch=62.6] | Loss=0.02110 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.642 | L2-Norm(final)=7.377 | 4307.9 samples/s | 67.3 steps/s
[Step=32150 Epoch=62.7] | Loss=0.02044 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.672 | L2-Norm(final)=7.398 | 4440.9 samples/s | 69.4 steps/s
[Step=32200 Epoch=62.8] | Loss=0.02039 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.699 | L2-Norm(final)=7.415 | 4341.1 samples/s | 67.8 steps/s
[Step=32250 Epoch=62.9] | Loss=0.01933 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.724 | L2-Norm(final)=7.431 | 4377.0 samples/s | 68.4 steps/s
[Step=32300 Epoch=63.0] | Loss=0.01897 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.748 | L2-Norm(final)=7.446 | 4437.3 samples/s | 69.3 steps/s
[Step=32350 Epoch=63.1] | Loss=0.01830 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.770 | L2-Norm(final)=7.462 | 4366.0 samples/s | 68.2 steps/s
[Step=32400 Epoch=63.2] | Loss=0.01844 | Reg=0.00190 | acc=0.9531 | L2-Norm=13.792 | L2-Norm(final)=7.477 | 4476.5 samples/s | 69.9 steps/s
[Step=32450 Epoch=63.3] | Loss=0.01777 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.811 | L2-Norm(final)=7.490 | 4419.6 samples/s | 69.1 steps/s
[Step=32500 Epoch=63.4] | Loss=0.01753 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.830 | L2-Norm(final)=7.503 | 5513.7 samples/s | 86.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=32501 Epoch=63.4] | Loss=0.01832 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.018 | L2-Norm(final)=7.635 | 3173.4 samples/s | 49.6 steps/s
[Step=32550 Epoch=63.5] | Loss=0.01412 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.040 | L2-Norm(final)=7.649 | 3664.8 samples/s | 57.3 steps/s
[Step=32600 Epoch=63.6] | Loss=0.01815 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.061 | L2-Norm(final)=7.648 | 3933.7 samples/s | 61.5 steps/s
[Step=32650 Epoch=63.7] | Loss=0.01917 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.082 | L2-Norm(final)=7.646 | 3981.0 samples/s | 62.2 steps/s
[Step=32700 Epoch=63.8] | Loss=0.01958 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.104 | L2-Norm(final)=7.644 | 3916.9 samples/s | 61.2 steps/s
[Step=32750 Epoch=63.9] | Loss=0.01934 | Reg=0.00200 | acc=0.9531 | L2-Norm=14.126 | L2-Norm(final)=7.644 | 3986.8 samples/s | 62.3 steps/s
[Step=32800 Epoch=64.0] | Loss=0.01954 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.146 | L2-Norm(final)=7.640 | 3954.2 samples/s | 61.8 steps/s
[Step=32850 Epoch=64.1] | Loss=0.02015 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.163 | L2-Norm(final)=7.638 | 3910.6 samples/s | 61.1 steps/s
[Step=32900 Epoch=64.2] | Loss=0.02003 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.180 | L2-Norm(final)=7.637 | 3947.2 samples/s | 61.7 steps/s
[Step=32950 Epoch=64.3] | Loss=0.01992 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.196 | L2-Norm(final)=7.635 | 3962.8 samples/s | 61.9 steps/s
[Step=33000 Epoch=64.4] | Loss=0.01934 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.211 | L2-Norm(final)=7.635 | 4886.3 samples/s | 76.3 steps/s
[Step=33050 Epoch=64.5] | Loss=0.01899 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.226 | L2-Norm(final)=7.635 | 1503.8 samples/s | 23.5 steps/s
[Step=33100 Epoch=64.6] | Loss=0.01838 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.239 | L2-Norm(final)=7.634 | 3923.2 samples/s | 61.3 steps/s
[Step=33150 Epoch=64.7] | Loss=0.01801 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.252 | L2-Norm(final)=7.634 | 3947.0 samples/s | 61.7 steps/s
[Step=33200 Epoch=64.8] | Loss=0.01765 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.264 | L2-Norm(final)=7.635 | 3982.7 samples/s | 62.2 steps/s
[Step=33250 Epoch=64.9] | Loss=0.01734 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.275 | L2-Norm(final)=7.635 | 3968.2 samples/s | 62.0 steps/s
[Step=33300 Epoch=64.9] | Loss=0.01703 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.286 | L2-Norm(final)=7.635 | 3970.4 samples/s | 62.0 steps/s
[Step=33350 Epoch=65.0] | Loss=0.01666 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.297 | L2-Norm(final)=7.636 | 3979.0 samples/s | 62.2 steps/s
[Step=33400 Epoch=65.1] | Loss=0.01656 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.307 | L2-Norm(final)=7.636 | 3925.7 samples/s | 61.3 steps/s
[Step=33450 Epoch=65.2] | Loss=0.01661 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.316 | L2-Norm(final)=7.637 | 3948.5 samples/s | 61.7 steps/s
[Step=33500 Epoch=65.3] | Loss=0.01646 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.325 | L2-Norm(final)=7.637 | 4150.8 samples/s | 64.9 steps/s
[Step=33550 Epoch=65.4] | Loss=0.01613 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.334 | L2-Norm(final)=7.638 | 1546.2 samples/s | 24.2 steps/s
[Step=33600 Epoch=65.5] | Loss=0.01583 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.343 | L2-Norm(final)=7.639 | 3927.5 samples/s | 61.4 steps/s
[Step=33650 Epoch=65.6] | Loss=0.01554 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.351 | L2-Norm(final)=7.640 | 3860.1 samples/s | 60.3 steps/s
[Step=33700 Epoch=65.7] | Loss=0.01533 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.359 | L2-Norm(final)=7.641 | 3933.9 samples/s | 61.5 steps/s
[Step=33750 Epoch=65.8] | Loss=0.01535 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.367 | L2-Norm(final)=7.642 | 3852.8 samples/s | 60.2 steps/s
[Step=33800 Epoch=65.9] | Loss=0.01531 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.374 | L2-Norm(final)=7.642 | 3968.4 samples/s | 62.0 steps/s
[Step=33850 Epoch=66.0] | Loss=0.01534 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.381 | L2-Norm(final)=7.642 | 3909.2 samples/s | 61.1 steps/s
[Step=33900 Epoch=66.1] | Loss=0.01532 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.389 | L2-Norm(final)=7.643 | 3925.3 samples/s | 61.3 steps/s
[Step=33950 Epoch=66.2] | Loss=0.01523 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.396 | L2-Norm(final)=7.643 | 3913.1 samples/s | 61.1 steps/s
[Step=34000 Epoch=66.3] | Loss=0.01505 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.403 | L2-Norm(final)=7.644 | 3913.1 samples/s | 61.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step34000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=32001 Epoch=62.6] | Loss=0.03810 | Reg=0.00184 | acc=0.9531 | L2-Norm=13.564 | L2-Norm(final)=7.717 | 3411.8 samples/s | 53.3 steps/s
[Step=32050 Epoch=62.7] | Loss=0.02624 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.621 | L2-Norm(final)=7.734 | 3937.7 samples/s | 61.5 steps/s
[Step=32100 Epoch=62.8] | Loss=0.02423 | Reg=0.00187 | acc=0.9531 | L2-Norm=13.658 | L2-Norm(final)=7.755 | 4326.3 samples/s | 67.6 steps/s
[Step=32150 Epoch=62.9] | Loss=0.02278 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.689 | L2-Norm(final)=7.774 | 4357.8 samples/s | 68.1 steps/s
[Step=32200 Epoch=63.0] | Loss=0.02220 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.717 | L2-Norm(final)=7.794 | 4320.2 samples/s | 67.5 steps/s
[Step=32250 Epoch=63.0] | Loss=0.02221 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.741 | L2-Norm(final)=7.813 | 4284.8 samples/s | 66.9 steps/s
[Step=32300 Epoch=63.1] | Loss=0.02162 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.764 | L2-Norm(final)=7.830 | 4330.3 samples/s | 67.7 steps/s
[Step=32350 Epoch=63.2] | Loss=0.02131 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.786 | L2-Norm(final)=7.846 | 4288.6 samples/s | 67.0 steps/s
[Step=32400 Epoch=63.3] | Loss=0.02108 | Reg=0.00191 | acc=0.9531 | L2-Norm=13.807 | L2-Norm(final)=7.862 | 4341.3 samples/s | 67.8 steps/s
[Step=32450 Epoch=63.4] | Loss=0.02072 | Reg=0.00191 | acc=0.9531 | L2-Norm=13.827 | L2-Norm(final)=7.876 | 4299.3 samples/s | 67.2 steps/s
[Step=32500 Epoch=63.5] | Loss=0.02033 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.845 | L2-Norm(final)=7.888 | 5664.4 samples/s | 88.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=32501 Epoch=63.5] | Loss=0.01038 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.031 | L2-Norm(final)=8.020 | 3091.9 samples/s | 48.3 steps/s
[Step=32550 Epoch=63.6] | Loss=0.01940 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.056 | L2-Norm(final)=8.029 | 3920.4 samples/s | 61.3 steps/s
[Step=32600 Epoch=63.7] | Loss=0.02016 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.082 | L2-Norm(final)=8.028 | 3942.9 samples/s | 61.6 steps/s
[Step=32650 Epoch=63.8] | Loss=0.01863 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.107 | L2-Norm(final)=8.029 | 3931.0 samples/s | 61.4 steps/s
[Step=32700 Epoch=63.9] | Loss=0.02029 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.135 | L2-Norm(final)=8.030 | 3975.6 samples/s | 62.1 steps/s
[Step=32750 Epoch=64.0] | Loss=0.02109 | Reg=0.00201 | acc=0.9531 | L2-Norm=14.162 | L2-Norm(final)=8.027 | 3910.5 samples/s | 61.1 steps/s
[Step=32800 Epoch=64.1] | Loss=0.02147 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.187 | L2-Norm(final)=8.024 | 3931.5 samples/s | 61.4 steps/s
[Step=32850 Epoch=64.2] | Loss=0.02147 | Reg=0.00202 | acc=0.9531 | L2-Norm=14.210 | L2-Norm(final)=8.022 | 3964.7 samples/s | 61.9 steps/s
[Step=32900 Epoch=64.3] | Loss=0.02143 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.229 | L2-Norm(final)=8.019 | 4065.6 samples/s | 63.5 steps/s
[Step=32950 Epoch=64.4] | Loss=0.02142 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.247 | L2-Norm(final)=8.015 | 3961.1 samples/s | 61.9 steps/s
[Step=33000 Epoch=64.5] | Loss=0.02147 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.264 | L2-Norm(final)=8.012 | 4804.6 samples/s | 75.1 steps/s
[Step=33050 Epoch=64.6] | Loss=0.02054 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.280 | L2-Norm(final)=8.010 | 1498.8 samples/s | 23.4 steps/s
[Step=33100 Epoch=64.7] | Loss=0.02008 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.294 | L2-Norm(final)=8.010 | 3854.9 samples/s | 60.2 steps/s
[Step=33150 Epoch=64.8] | Loss=0.01967 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.308 | L2-Norm(final)=8.010 | 3873.2 samples/s | 60.5 steps/s
[Step=33200 Epoch=64.9] | Loss=0.01934 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.321 | L2-Norm(final)=8.009 | 3901.4 samples/s | 61.0 steps/s
[Step=33250 Epoch=65.0] | Loss=0.01884 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.332 | L2-Norm(final)=8.009 | 3997.4 samples/s | 62.5 steps/s
[Step=33300 Epoch=65.1] | Loss=0.01846 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.343 | L2-Norm(final)=8.009 | 3961.6 samples/s | 61.9 steps/s
[Step=33350 Epoch=65.2] | Loss=0.01812 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.353 | L2-Norm(final)=8.010 | 3937.3 samples/s | 61.5 steps/s
[Step=33400 Epoch=65.3] | Loss=0.01786 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.364 | L2-Norm(final)=8.011 | 3929.5 samples/s | 61.4 steps/s
[Step=33450 Epoch=65.4] | Loss=0.01762 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.374 | L2-Norm(final)=8.012 | 3967.6 samples/s | 62.0 steps/s
[Step=33500 Epoch=65.5] | Loss=0.01742 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.385 | L2-Norm(final)=8.013 | 4266.0 samples/s | 66.7 steps/s
[Step=33550 Epoch=65.6] | Loss=0.01723 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.395 | L2-Norm(final)=8.014 | 1599.7 samples/s | 25.0 steps/s
[Step=33600 Epoch=65.7] | Loss=0.01683 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.405 | L2-Norm(final)=8.015 | 3887.3 samples/s | 60.7 steps/s
[Step=33650 Epoch=65.8] | Loss=0.01652 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.415 | L2-Norm(final)=8.017 | 3914.4 samples/s | 61.2 steps/s
[Step=33700 Epoch=65.9] | Loss=0.01622 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.425 | L2-Norm(final)=8.019 | 3947.7 samples/s | 61.7 steps/s
[Step=33750 Epoch=66.0] | Loss=0.01603 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.434 | L2-Norm(final)=8.020 | 3947.8 samples/s | 61.7 steps/s
[Step=33800 Epoch=66.1] | Loss=0.01588 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.443 | L2-Norm(final)=8.022 | 3927.2 samples/s | 61.4 steps/s
[Step=33850 Epoch=66.2] | Loss=0.01578 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.452 | L2-Norm(final)=8.023 | 3929.7 samples/s | 61.4 steps/s
[Step=33900 Epoch=66.3] | Loss=0.01578 | Reg=0.00209 | acc=0.9531 | L2-Norm=14.460 | L2-Norm(final)=8.024 | 3940.0 samples/s | 61.6 steps/s
[Step=33950 Epoch=66.4] | Loss=0.01560 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.469 | L2-Norm(final)=8.025 | 3946.8 samples/s | 61.7 steps/s
[Step=34000 Epoch=66.5] | Loss=0.01565 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.477 | L2-Norm(final)=8.027 | 3982.8 samples/s | 62.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step34000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=32001 Epoch=122.6] | Loss=0.00017 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.564 | L2-Norm(final)=6.688 | 3394.7 samples/s | 53.0 steps/s
[Step=32050 Epoch=122.8] | Loss=0.00085 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.580 | L2-Norm(final)=6.696 | 3580.1 samples/s | 55.9 steps/s
[Step=32100 Epoch=123.0] | Loss=0.00057 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.595 | L2-Norm(final)=6.708 | 4172.3 samples/s | 65.2 steps/s
[Step=32150 Epoch=123.2] | Loss=0.00044 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.602 | L2-Norm(final)=6.721 | 4137.9 samples/s | 64.7 steps/s
[Step=32200 Epoch=123.4] | Loss=0.00044 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.606 | L2-Norm(final)=6.730 | 4097.2 samples/s | 64.0 steps/s
[Step=32250 Epoch=123.6] | Loss=0.00046 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=6.739 | 5276.0 samples/s | 82.4 steps/s
[Step=32300 Epoch=123.8] | Loss=0.00045 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.627 | L2-Norm(final)=6.748 | 1554.9 samples/s | 24.3 steps/s
[Step=32350 Epoch=124.0] | Loss=0.00040 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.634 | L2-Norm(final)=6.756 | 4127.4 samples/s | 64.5 steps/s
[Step=32400 Epoch=124.1] | Loss=0.00036 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.636 | L2-Norm(final)=6.763 | 4205.7 samples/s | 65.7 steps/s
[Step=32450 Epoch=124.3] | Loss=0.00032 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.635 | L2-Norm(final)=6.769 | 4087.2 samples/s | 63.9 steps/s
[Step=32500 Epoch=124.5] | Loss=0.00030 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.632 | L2-Norm(final)=6.776 | 4527.8 samples/s | 70.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=32501 Epoch=124.5] | Loss=0.00039 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.598 | L2-Norm(final)=6.840 | 3170.3 samples/s | 49.5 steps/s
[Step=32550 Epoch=124.7] | Loss=0.00005 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.588 | L2-Norm(final)=6.846 | 3620.1 samples/s | 56.6 steps/s
[Step=32600 Epoch=124.9] | Loss=0.00004 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.573 | L2-Norm(final)=6.849 | 3717.9 samples/s | 58.1 steps/s
[Step=32650 Epoch=125.1] | Loss=0.00004 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=6.852 | 3738.1 samples/s | 58.4 steps/s
[Step=32700 Epoch=125.3] | Loss=0.00004 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.542 | L2-Norm(final)=6.856 | 3731.3 samples/s | 58.3 steps/s
[Step=32750 Epoch=125.5] | Loss=0.00003 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.527 | L2-Norm(final)=6.859 | 4618.8 samples/s | 72.2 steps/s
[Step=32800 Epoch=125.7] | Loss=0.00003 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.512 | L2-Norm(final)=6.861 | 1452.5 samples/s | 22.7 steps/s
[Step=32850 Epoch=125.9] | Loss=0.00003 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.497 | L2-Norm(final)=6.864 | 3757.2 samples/s | 58.7 steps/s
[Step=32900 Epoch=126.1] | Loss=0.00002 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=6.866 | 3732.0 samples/s | 58.3 steps/s
[Step=32950 Epoch=126.3] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.466 | L2-Norm(final)=6.867 | 3722.6 samples/s | 58.2 steps/s
[Step=33000 Epoch=126.4] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.450 | L2-Norm(final)=6.869 | 4147.9 samples/s | 64.8 steps/s
[Step=33050 Epoch=126.6] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.434 | L2-Norm(final)=6.870 | 1551.0 samples/s | 24.2 steps/s
[Step=33100 Epoch=126.8] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.418 | L2-Norm(final)=6.872 | 3751.6 samples/s | 58.6 steps/s
[Step=33150 Epoch=127.0] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=6.873 | 3778.1 samples/s | 59.0 steps/s
[Step=33200 Epoch=127.2] | Loss=0.00002 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.386 | L2-Norm(final)=6.874 | 3678.0 samples/s | 57.5 steps/s
[Step=33250 Epoch=127.4] | Loss=0.00002 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=6.876 | 3788.0 samples/s | 59.2 steps/s
[Step=33300 Epoch=127.6] | Loss=0.00001 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=6.877 | 1585.6 samples/s | 24.8 steps/s
[Step=33350 Epoch=127.8] | Loss=0.00001 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.338 | L2-Norm(final)=6.878 | 3804.5 samples/s | 59.4 steps/s
[Step=33400 Epoch=128.0] | Loss=0.00001 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.322 | L2-Norm(final)=6.879 | 3716.1 samples/s | 58.1 steps/s
[Step=33450 Epoch=128.2] | Loss=0.00001 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.306 | L2-Norm(final)=6.880 | 3730.0 samples/s | 58.3 steps/s
[Step=33500 Epoch=128.4] | Loss=0.00001 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=6.881 | 3713.3 samples/s | 58.0 steps/s
[Step=33550 Epoch=128.6] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.273 | L2-Norm(final)=6.882 | 1561.8 samples/s | 24.4 steps/s
[Step=33600 Epoch=128.7] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.257 | L2-Norm(final)=6.883 | 3710.0 samples/s | 58.0 steps/s
[Step=33650 Epoch=128.9] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=6.884 | 3786.8 samples/s | 59.2 steps/s
[Step=33700 Epoch=129.1] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.224 | L2-Norm(final)=6.885 | 3765.7 samples/s | 58.8 steps/s
[Step=33750 Epoch=129.3] | Loss=0.00001 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.208 | L2-Norm(final)=6.886 | 3714.1 samples/s | 58.0 steps/s
[Step=33800 Epoch=129.5] | Loss=0.00001 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.191 | L2-Norm(final)=6.887 | 5042.1 samples/s | 78.8 steps/s
[Step=33850 Epoch=129.7] | Loss=0.00001 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.174 | L2-Norm(final)=6.888 | 1421.2 samples/s | 22.2 steps/s
[Step=33900 Epoch=129.9] | Loss=0.00001 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.158 | L2-Norm(final)=6.890 | 3684.8 samples/s | 57.6 steps/s
[Step=33950 Epoch=130.1] | Loss=0.00001 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.141 | L2-Norm(final)=6.891 | 3685.2 samples/s | 57.6 steps/s
[Step=34000 Epoch=130.3] | Loss=0.00001 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.124 | L2-Norm(final)=6.892 | 3707.1 samples/s | 57.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step34000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=32001 Epoch=123.2] | Loss=0.00053 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.564 | L2-Norm(final)=7.408 | 3330.2 samples/s | 52.0 steps/s
[Step=32050 Epoch=123.4] | Loss=0.00131 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.586 | L2-Norm(final)=7.422 | 3713.6 samples/s | 58.0 steps/s
[Step=32100 Epoch=123.6] | Loss=0.00119 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.614 | L2-Norm(final)=7.435 | 4183.6 samples/s | 65.4 steps/s
[Step=32150 Epoch=123.8] | Loss=0.00097 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.636 | L2-Norm(final)=7.447 | 4142.5 samples/s | 64.7 steps/s
[Step=32200 Epoch=124.0] | Loss=0.00088 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.648 | L2-Norm(final)=7.456 | 4106.4 samples/s | 64.2 steps/s
[Step=32250 Epoch=124.1] | Loss=0.00088 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.655 | L2-Norm(final)=7.464 | 5471.0 samples/s | 85.5 steps/s
[Step=32300 Epoch=124.3] | Loss=0.00078 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.659 | L2-Norm(final)=7.470 | 1541.2 samples/s | 24.1 steps/s
[Step=32350 Epoch=124.5] | Loss=0.00069 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.662 | L2-Norm(final)=7.476 | 4058.7 samples/s | 63.4 steps/s
[Step=32400 Epoch=124.7] | Loss=0.00063 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.662 | L2-Norm(final)=7.482 | 4026.2 samples/s | 62.9 steps/s
[Step=32450 Epoch=124.9] | Loss=0.00057 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.662 | L2-Norm(final)=7.488 | 4094.3 samples/s | 64.0 steps/s
[Step=32500 Epoch=125.1] | Loss=0.00052 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.661 | L2-Norm(final)=7.493 | 4796.3 samples/s | 74.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=32501 Epoch=125.1] | Loss=0.00003 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.642 | L2-Norm(final)=7.546 | 3229.1 samples/s | 50.5 steps/s
[Step=32550 Epoch=125.3] | Loss=0.00015 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.634 | L2-Norm(final)=7.551 | 3476.3 samples/s | 54.3 steps/s
[Step=32600 Epoch=125.5] | Loss=0.00013 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.627 | L2-Norm(final)=7.555 | 3697.9 samples/s | 57.8 steps/s
[Step=32650 Epoch=125.7] | Loss=0.00012 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.620 | L2-Norm(final)=7.560 | 3789.7 samples/s | 59.2 steps/s
[Step=32700 Epoch=125.9] | Loss=0.00009 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.611 | L2-Norm(final)=7.563 | 3691.2 samples/s | 57.7 steps/s
[Step=32750 Epoch=126.1] | Loss=0.00008 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.600 | L2-Norm(final)=7.566 | 4815.6 samples/s | 75.2 steps/s
[Step=32800 Epoch=126.3] | Loss=0.00007 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.589 | L2-Norm(final)=7.568 | 1467.0 samples/s | 22.9 steps/s
[Step=32850 Epoch=126.5] | Loss=0.00006 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.578 | L2-Norm(final)=7.570 | 3657.8 samples/s | 57.2 steps/s
[Step=32900 Epoch=126.6] | Loss=0.00005 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.566 | L2-Norm(final)=7.572 | 3720.4 samples/s | 58.1 steps/s
[Step=32950 Epoch=126.8] | Loss=0.00005 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.554 | L2-Norm(final)=7.573 | 3721.9 samples/s | 58.2 steps/s
[Step=33000 Epoch=127.0] | Loss=0.00004 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.542 | L2-Norm(final)=7.574 | 4187.3 samples/s | 65.4 steps/s
[Step=33050 Epoch=127.2] | Loss=0.00004 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.530 | L2-Norm(final)=7.575 | 1515.7 samples/s | 23.7 steps/s
[Step=33100 Epoch=127.4] | Loss=0.00004 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.517 | L2-Norm(final)=7.576 | 3772.3 samples/s | 58.9 steps/s
[Step=33150 Epoch=127.6] | Loss=0.00004 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.505 | L2-Norm(final)=7.577 | 3744.6 samples/s | 58.5 steps/s
[Step=33200 Epoch=127.8] | Loss=0.00003 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=7.578 | 3759.8 samples/s | 58.7 steps/s
[Step=33250 Epoch=128.0] | Loss=0.00003 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=7.579 | 3803.9 samples/s | 59.4 steps/s
[Step=33300 Epoch=128.2] | Loss=0.00003 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.466 | L2-Norm(final)=7.580 | 1585.6 samples/s | 24.8 steps/s
[Step=33350 Epoch=128.4] | Loss=0.00003 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.454 | L2-Norm(final)=7.581 | 3727.2 samples/s | 58.2 steps/s
[Step=33400 Epoch=128.6] | Loss=0.00003 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.441 | L2-Norm(final)=7.582 | 3724.7 samples/s | 58.2 steps/s
[Step=33450 Epoch=128.8] | Loss=0.00003 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.428 | L2-Norm(final)=7.582 | 3666.3 samples/s | 57.3 steps/s
[Step=33500 Epoch=129.0] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.415 | L2-Norm(final)=7.583 | 3699.9 samples/s | 57.8 steps/s
[Step=33550 Epoch=129.1] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.401 | L2-Norm(final)=7.584 | 1596.6 samples/s | 24.9 steps/s
[Step=33600 Epoch=129.3] | Loss=0.00002 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.388 | L2-Norm(final)=7.585 | 3779.7 samples/s | 59.1 steps/s
[Step=33650 Epoch=129.5] | Loss=0.00002 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=7.585 | 3711.4 samples/s | 58.0 steps/s
[Step=33700 Epoch=129.7] | Loss=0.00002 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=7.586 | 3739.5 samples/s | 58.4 steps/s
[Step=33750 Epoch=129.9] | Loss=0.00002 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=7.587 | 3753.0 samples/s | 58.6 steps/s
[Step=33800 Epoch=130.1] | Loss=0.00002 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.334 | L2-Norm(final)=7.587 | 5437.3 samples/s | 85.0 steps/s
[Step=33850 Epoch=130.3] | Loss=0.00002 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.321 | L2-Norm(final)=7.588 | 1392.0 samples/s | 21.7 steps/s
[Step=33900 Epoch=130.5] | Loss=0.00002 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.307 | L2-Norm(final)=7.589 | 3817.5 samples/s | 59.6 steps/s
[Step=33950 Epoch=130.7] | Loss=0.00002 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.293 | L2-Norm(final)=7.589 | 3644.6 samples/s | 56.9 steps/s
[Step=34000 Epoch=130.9] | Loss=0.00002 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.279 | L2-Norm(final)=7.590 | 3745.9 samples/s | 58.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step34000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06506 | acc=0.9667 | tpr=0.9707 | fpr=0.0419 | 3533.8 samples/s | 13.8 steps/s
Avg test loss: 0.07062, Avg test acc: 0.96358, Avg tpr: 0.96754, Avg fpr: 0.04512, total FA: 352

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06062 | acc=0.9639 | tpr=0.9636 | fpr=0.0354 | 3508.5 samples/s | 13.7 steps/s
Avg test loss: 0.06682, Avg test acc: 0.96246, Avg tpr: 0.96328, Avg fpr: 0.03935, total FA: 307

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.38181 | acc=0.3134 | tpr=0.0187 | fpr=0.0468 | 3502.5 samples/s | 13.7 steps/s
Avg test loss: 5.39314, Avg test acc: 0.31012, Avg tpr: 0.01842, Avg fpr: 0.04833, total FA: 377

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.19879 | acc=0.3180 | tpr=0.0265 | fpr=0.0491 | 3514.5 samples/s | 13.7 steps/s
Avg test loss: 5.21070, Avg test acc: 0.31545, Avg tpr: 0.02780, Avg fpr: 0.05192, total FA: 405

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.62447 | acc=0.0988 | tpr=0.7478 | fpr=0.9129 | 3519.1 samples/s | 13.7 steps/s
[Step= 100] | Loss=5.60507 | acc=0.1007 | tpr=0.7612 | fpr=0.9117 | 6932.8 samples/s | 27.1 steps/s
[Step= 150] | Loss=5.61825 | acc=0.0996 | tpr=0.7723 | fpr=0.9128 | 6760.5 samples/s | 26.4 steps/s
[Step= 200] | Loss=5.59936 | acc=0.0993 | tpr=0.7519 | fpr=0.9126 | 6951.0 samples/s | 27.2 steps/s
[Step= 250] | Loss=5.59991 | acc=0.0995 | tpr=0.7511 | fpr=0.9124 | 6937.8 samples/s | 27.1 steps/s
[Step= 300] | Loss=5.60181 | acc=0.0989 | tpr=0.7542 | fpr=0.9130 | 6787.3 samples/s | 26.5 steps/s
[Step= 350] | Loss=5.59680 | acc=0.0989 | tpr=0.7552 | fpr=0.9130 | 6914.6 samples/s | 27.0 steps/s
[Step= 400] | Loss=5.59227 | acc=0.0987 | tpr=0.7566 | fpr=0.9132 | 6620.6 samples/s | 25.9 steps/s
[Step= 450] | Loss=5.59666 | acc=0.0985 | tpr=0.7614 | fpr=0.9135 | 6807.9 samples/s | 26.6 steps/s
[Step= 500] | Loss=5.59928 | acc=0.0988 | tpr=0.7665 | fpr=0.9132 | 6864.8 samples/s | 26.8 steps/s
[Step= 550] | Loss=5.59846 | acc=0.0990 | tpr=0.7688 | fpr=0.9131 | 12881.7 samples/s | 50.3 steps/s
Avg test loss: 5.59981, Avg test acc: 0.09896, Avg tpr: 0.76862, Avg fpr: 0.91321, total FA: 126798

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.92997 | acc=0.1309 | tpr=0.8186 | fpr=0.8815 | 3573.5 samples/s | 14.0 steps/s
[Step= 100] | Loss=5.89082 | acc=0.1295 | tpr=0.8273 | fpr=0.8835 | 6732.1 samples/s | 26.3 steps/s
[Step= 150] | Loss=5.90683 | acc=0.1301 | tpr=0.8300 | fpr=0.8828 | 6962.9 samples/s | 27.2 steps/s
[Step= 200] | Loss=5.89359 | acc=0.1296 | tpr=0.8208 | fpr=0.8830 | 7336.2 samples/s | 28.7 steps/s
[Step= 250] | Loss=5.89491 | acc=0.1293 | tpr=0.8122 | fpr=0.8831 | 6947.5 samples/s | 27.1 steps/s
[Step= 300] | Loss=5.89727 | acc=0.1294 | tpr=0.8131 | fpr=0.8830 | 6479.2 samples/s | 25.3 steps/s
[Step= 350] | Loss=5.89761 | acc=0.1296 | tpr=0.8134 | fpr=0.8828 | 6891.1 samples/s | 26.9 steps/s
[Step= 400] | Loss=5.89357 | acc=0.1299 | tpr=0.8140 | fpr=0.8826 | 6980.1 samples/s | 27.3 steps/s
[Step= 450] | Loss=5.90075 | acc=0.1297 | tpr=0.8165 | fpr=0.8827 | 6601.3 samples/s | 25.8 steps/s
[Step= 500] | Loss=5.90435 | acc=0.1299 | tpr=0.8163 | fpr=0.8825 | 6968.7 samples/s | 27.2 steps/s
[Step= 550] | Loss=5.90554 | acc=0.1299 | tpr=0.8205 | fpr=0.8826 | 11933.1 samples/s | 46.6 steps/s
Avg test loss: 5.90806, Avg test acc: 0.12982, Avg tpr: 0.82013, Avg fpr: 0.88273, total FA: 122565

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11271 | acc=0.9804 | tpr=0.9204 | fpr=0.0185 | 3459.2 samples/s | 13.5 steps/s
[Step= 100] | Loss=0.11535 | acc=0.9807 | tpr=0.9467 | fpr=0.0187 | 6877.8 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.11838 | acc=0.9801 | tpr=0.9467 | fpr=0.0193 | 6816.6 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.11901 | acc=0.9802 | tpr=0.9464 | fpr=0.0192 | 6979.5 samples/s | 27.3 steps/s
[Step= 250] | Loss=0.11718 | acc=0.9803 | tpr=0.9441 | fpr=0.0190 | 6661.9 samples/s | 26.0 steps/s
[Step= 300] | Loss=0.11920 | acc=0.9800 | tpr=0.9469 | fpr=0.0194 | 6700.7 samples/s | 26.2 steps/s
[Step= 350] | Loss=0.11881 | acc=0.9800 | tpr=0.9474 | fpr=0.0194 | 6812.1 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.12059 | acc=0.9797 | tpr=0.9420 | fpr=0.0196 | 6689.4 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.12274 | acc=0.9795 | tpr=0.9411 | fpr=0.0198 | 6678.7 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.12236 | acc=0.9796 | tpr=0.9427 | fpr=0.0198 | 6766.1 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.12161 | acc=0.9797 | tpr=0.9423 | fpr=0.0196 | 12334.1 samples/s | 48.2 steps/s
Avg test loss: 0.12152, Avg test acc: 0.97968, Avg tpr: 0.94176, Avg fpr: 0.01963, total FA: 2726

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11977 | acc=0.9805 | tpr=0.9381 | fpr=0.0187 | 3479.6 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.12351 | acc=0.9804 | tpr=0.9595 | fpr=0.0192 | 6888.9 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.12602 | acc=0.9795 | tpr=0.9625 | fpr=0.0202 | 6891.3 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.12652 | acc=0.9797 | tpr=0.9639 | fpr=0.0200 | 6821.7 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.12512 | acc=0.9798 | tpr=0.9624 | fpr=0.0199 | 6910.2 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.12789 | acc=0.9794 | tpr=0.9607 | fpr=0.0203 | 6894.0 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.12745 | acc=0.9793 | tpr=0.9606 | fpr=0.0203 | 6754.9 samples/s | 26.4 steps/s
[Step= 400] | Loss=0.12956 | acc=0.9792 | tpr=0.9573 | fpr=0.0204 | 6783.4 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.13183 | acc=0.9790 | tpr=0.9552 | fpr=0.0206 | 6827.8 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.13161 | acc=0.9790 | tpr=0.9573 | fpr=0.0206 | 6851.7 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.13063 | acc=0.9791 | tpr=0.9558 | fpr=0.0205 | 12217.5 samples/s | 47.7 steps/s
Avg test loss: 0.13053, Avg test acc: 0.97905, Avg tpr: 0.95523, Avg fpr: 0.02052, total FA: 2849

server round 17/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=34001 Epoch=66.3] | Loss=0.03698 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.420 | L2-Norm(final)=7.661 | 2947.7 samples/s | 46.1 steps/s
[Step=34050 Epoch=66.4] | Loss=0.01470 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.464 | L2-Norm(final)=7.662 | 4251.6 samples/s | 66.4 steps/s
[Step=34100 Epoch=66.5] | Loss=0.01277 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.482 | L2-Norm(final)=7.669 | 4312.6 samples/s | 67.4 steps/s
[Step=34150 Epoch=66.6] | Loss=0.01219 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.493 | L2-Norm(final)=7.677 | 4409.3 samples/s | 68.9 steps/s
[Step=34200 Epoch=66.7] | Loss=0.01183 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.503 | L2-Norm(final)=7.686 | 4466.6 samples/s | 69.8 steps/s
[Step=34250 Epoch=66.8] | Loss=0.01127 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.513 | L2-Norm(final)=7.695 | 4346.7 samples/s | 67.9 steps/s
[Step=34300 Epoch=66.9] | Loss=0.01138 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.523 | L2-Norm(final)=7.704 | 4363.3 samples/s | 68.2 steps/s
[Step=34350 Epoch=67.0] | Loss=0.01146 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.533 | L2-Norm(final)=7.712 | 4347.9 samples/s | 67.9 steps/s
[Step=34400 Epoch=67.1] | Loss=0.01113 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.544 | L2-Norm(final)=7.719 | 4432.0 samples/s | 69.3 steps/s
[Step=34450 Epoch=67.2] | Loss=0.01086 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.554 | L2-Norm(final)=7.726 | 4397.0 samples/s | 68.7 steps/s
[Step=34500 Epoch=67.3] | Loss=0.01062 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.564 | L2-Norm(final)=7.734 | 5538.9 samples/s | 86.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=34501 Epoch=67.3] | Loss=0.00594 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.667 | L2-Norm(final)=7.801 | 3062.3 samples/s | 47.8 steps/s
[Step=34550 Epoch=67.4] | Loss=0.01147 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.683 | L2-Norm(final)=7.807 | 3843.5 samples/s | 60.1 steps/s
[Step=34600 Epoch=67.5] | Loss=0.01264 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.704 | L2-Norm(final)=7.811 | 3969.4 samples/s | 62.0 steps/s
[Step=34650 Epoch=67.6] | Loss=0.01318 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.729 | L2-Norm(final)=7.815 | 3913.1 samples/s | 61.1 steps/s
[Step=34700 Epoch=67.7] | Loss=0.01352 | Reg=0.00189 | acc=0.9375 | L2-Norm=13.748 | L2-Norm(final)=7.818 | 3911.7 samples/s | 61.1 steps/s
[Step=34750 Epoch=67.8] | Loss=0.01508 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.768 | L2-Norm(final)=7.818 | 3975.8 samples/s | 62.1 steps/s
[Step=34800 Epoch=67.9] | Loss=0.01528 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.790 | L2-Norm(final)=7.818 | 3972.1 samples/s | 62.1 steps/s
[Step=34850 Epoch=68.0] | Loss=0.01613 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.809 | L2-Norm(final)=7.817 | 3957.7 samples/s | 61.8 steps/s
[Step=34900 Epoch=68.1] | Loss=0.01609 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.827 | L2-Norm(final)=7.817 | 3969.3 samples/s | 62.0 steps/s
[Step=34950 Epoch=68.2] | Loss=0.01620 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.844 | L2-Norm(final)=7.816 | 3973.0 samples/s | 62.1 steps/s
[Step=35000 Epoch=68.3] | Loss=0.01650 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.860 | L2-Norm(final)=7.816 | 4822.5 samples/s | 75.4 steps/s
[Step=35050 Epoch=68.4] | Loss=0.01609 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.876 | L2-Norm(final)=7.816 | 1485.3 samples/s | 23.2 steps/s
[Step=35100 Epoch=68.5] | Loss=0.01575 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.891 | L2-Norm(final)=7.818 | 3895.6 samples/s | 60.9 steps/s
[Step=35150 Epoch=68.6] | Loss=0.01547 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.906 | L2-Norm(final)=7.820 | 3924.3 samples/s | 61.3 steps/s
[Step=35200 Epoch=68.7] | Loss=0.01523 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.920 | L2-Norm(final)=7.821 | 3886.5 samples/s | 60.7 steps/s
[Step=35250 Epoch=68.8] | Loss=0.01527 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.933 | L2-Norm(final)=7.823 | 3920.9 samples/s | 61.3 steps/s
[Step=35300 Epoch=68.8] | Loss=0.01504 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.947 | L2-Norm(final)=7.824 | 3921.5 samples/s | 61.3 steps/s
[Step=35350 Epoch=68.9] | Loss=0.01498 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.960 | L2-Norm(final)=7.825 | 3900.5 samples/s | 60.9 steps/s
[Step=35400 Epoch=69.0] | Loss=0.01493 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.972 | L2-Norm(final)=7.827 | 3959.5 samples/s | 61.9 steps/s
[Step=35450 Epoch=69.1] | Loss=0.01492 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.985 | L2-Norm(final)=7.828 | 3929.7 samples/s | 61.4 steps/s
[Step=35500 Epoch=69.2] | Loss=0.01479 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.998 | L2-Norm(final)=7.829 | 4199.8 samples/s | 65.6 steps/s
[Step=35550 Epoch=69.3] | Loss=0.01455 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.010 | L2-Norm(final)=7.831 | 1532.6 samples/s | 23.9 steps/s
[Step=35600 Epoch=69.4] | Loss=0.01436 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.022 | L2-Norm(final)=7.833 | 3916.3 samples/s | 61.2 steps/s
[Step=35650 Epoch=69.5] | Loss=0.01427 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.034 | L2-Norm(final)=7.835 | 3865.9 samples/s | 60.4 steps/s
[Step=35700 Epoch=69.6] | Loss=0.01428 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.045 | L2-Norm(final)=7.836 | 3950.6 samples/s | 61.7 steps/s
[Step=35750 Epoch=69.7] | Loss=0.01417 | Reg=0.00198 | acc=0.9531 | L2-Norm=14.057 | L2-Norm(final)=7.838 | 3979.4 samples/s | 62.2 steps/s
[Step=35800 Epoch=69.8] | Loss=0.01408 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.068 | L2-Norm(final)=7.840 | 3936.0 samples/s | 61.5 steps/s
[Step=35850 Epoch=69.9] | Loss=0.01390 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.078 | L2-Norm(final)=7.841 | 3935.5 samples/s | 61.5 steps/s
[Step=35900 Epoch=70.0] | Loss=0.01391 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.089 | L2-Norm(final)=7.843 | 3937.8 samples/s | 61.5 steps/s
[Step=35950 Epoch=70.1] | Loss=0.01394 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.099 | L2-Norm(final)=7.845 | 3951.3 samples/s | 61.7 steps/s
[Step=36000 Epoch=70.2] | Loss=0.01381 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.110 | L2-Norm(final)=7.846 | 3951.7 samples/s | 61.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step36000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=34001 Epoch=66.5] | Loss=0.00113 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.420 | L2-Norm(final)=8.060 | 3282.7 samples/s | 51.3 steps/s
[Step=34050 Epoch=66.6] | Loss=0.01648 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.456 | L2-Norm(final)=8.054 | 4196.7 samples/s | 65.6 steps/s
[Step=34100 Epoch=66.7] | Loss=0.01483 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.483 | L2-Norm(final)=8.056 | 4294.8 samples/s | 67.1 steps/s
[Step=34150 Epoch=66.8] | Loss=0.01406 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.503 | L2-Norm(final)=8.063 | 4351.5 samples/s | 68.0 steps/s
[Step=34200 Epoch=66.9] | Loss=0.01329 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.519 | L2-Norm(final)=8.073 | 4381.9 samples/s | 68.5 steps/s
[Step=34250 Epoch=67.0] | Loss=0.01309 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.532 | L2-Norm(final)=8.083 | 4406.5 samples/s | 68.9 steps/s
[Step=34300 Epoch=67.1] | Loss=0.01270 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.544 | L2-Norm(final)=8.091 | 4405.2 samples/s | 68.8 steps/s
[Step=34350 Epoch=67.2] | Loss=0.01222 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.556 | L2-Norm(final)=8.100 | 4356.2 samples/s | 68.1 steps/s
[Step=34400 Epoch=67.3] | Loss=0.01191 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.568 | L2-Norm(final)=8.109 | 4324.9 samples/s | 67.6 steps/s
[Step=34450 Epoch=67.3] | Loss=0.01170 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.579 | L2-Norm(final)=8.117 | 4442.1 samples/s | 69.4 steps/s
[Step=34500 Epoch=67.4] | Loss=0.01151 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.589 | L2-Norm(final)=8.125 | 5549.7 samples/s | 86.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=34501 Epoch=67.4] | Loss=0.00212 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.690 | L2-Norm(final)=8.209 | 3202.7 samples/s | 50.0 steps/s
[Step=34550 Epoch=67.5] | Loss=0.01115 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.704 | L2-Norm(final)=8.217 | 3796.9 samples/s | 59.3 steps/s
[Step=34600 Epoch=67.6] | Loss=0.01353 | Reg=0.00188 | acc=0.9375 | L2-Norm=13.722 | L2-Norm(final)=8.220 | 3890.4 samples/s | 60.8 steps/s
[Step=34650 Epoch=67.7] | Loss=0.01519 | Reg=0.00189 | acc=0.9531 | L2-Norm=13.735 | L2-Norm(final)=8.217 | 3955.3 samples/s | 61.8 steps/s
[Step=34700 Epoch=67.8] | Loss=0.01454 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.751 | L2-Norm(final)=8.216 | 3889.2 samples/s | 60.8 steps/s
[Step=34750 Epoch=67.9] | Loss=0.01541 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.768 | L2-Norm(final)=8.214 | 3889.9 samples/s | 60.8 steps/s
[Step=34800 Epoch=68.0] | Loss=0.01561 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.787 | L2-Norm(final)=8.210 | 3876.9 samples/s | 60.6 steps/s
[Step=34850 Epoch=68.1] | Loss=0.01551 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.804 | L2-Norm(final)=8.207 | 3896.5 samples/s | 60.9 steps/s
[Step=34900 Epoch=68.2] | Loss=0.01552 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.820 | L2-Norm(final)=8.205 | 3938.5 samples/s | 61.5 steps/s
[Step=34950 Epoch=68.3] | Loss=0.01558 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.836 | L2-Norm(final)=8.204 | 3907.7 samples/s | 61.1 steps/s
[Step=35000 Epoch=68.4] | Loss=0.01601 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.851 | L2-Norm(final)=8.203 | 4845.0 samples/s | 75.7 steps/s
[Step=35050 Epoch=68.5] | Loss=0.01603 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.866 | L2-Norm(final)=8.201 | 1466.7 samples/s | 22.9 steps/s
[Step=35100 Epoch=68.6] | Loss=0.01547 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.881 | L2-Norm(final)=8.202 | 3943.2 samples/s | 61.6 steps/s
[Step=35150 Epoch=68.7] | Loss=0.01519 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.895 | L2-Norm(final)=8.203 | 3855.2 samples/s | 60.2 steps/s
[Step=35200 Epoch=68.8] | Loss=0.01522 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.908 | L2-Norm(final)=8.203 | 3968.1 samples/s | 62.0 steps/s
[Step=35250 Epoch=68.9] | Loss=0.01517 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.921 | L2-Norm(final)=8.205 | 3904.3 samples/s | 61.0 steps/s
[Step=35300 Epoch=69.0] | Loss=0.01499 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.935 | L2-Norm(final)=8.205 | 3914.0 samples/s | 61.2 steps/s
[Step=35350 Epoch=69.1] | Loss=0.01515 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.948 | L2-Norm(final)=8.206 | 3888.9 samples/s | 60.8 steps/s
[Step=35400 Epoch=69.2] | Loss=0.01508 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.962 | L2-Norm(final)=8.206 | 3955.5 samples/s | 61.8 steps/s
[Step=35450 Epoch=69.3] | Loss=0.01506 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.975 | L2-Norm(final)=8.206 | 3902.8 samples/s | 61.0 steps/s
[Step=35500 Epoch=69.4] | Loss=0.01488 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.988 | L2-Norm(final)=8.207 | 4256.3 samples/s | 66.5 steps/s
[Step=35550 Epoch=69.5] | Loss=0.01475 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.000 | L2-Norm(final)=8.208 | 1582.3 samples/s | 24.7 steps/s
[Step=35600 Epoch=69.6] | Loss=0.01448 | Reg=0.00196 | acc=0.9688 | L2-Norm=14.012 | L2-Norm(final)=8.209 | 3934.2 samples/s | 61.5 steps/s
[Step=35650 Epoch=69.7] | Loss=0.01425 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.024 | L2-Norm(final)=8.210 | 3893.9 samples/s | 60.8 steps/s
[Step=35700 Epoch=69.8] | Loss=0.01428 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.035 | L2-Norm(final)=8.211 | 3937.2 samples/s | 61.5 steps/s
[Step=35750 Epoch=69.9] | Loss=0.01408 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.045 | L2-Norm(final)=8.212 | 3928.4 samples/s | 61.4 steps/s
[Step=35800 Epoch=70.0] | Loss=0.01390 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.056 | L2-Norm(final)=8.213 | 3941.1 samples/s | 61.6 steps/s
[Step=35850 Epoch=70.1] | Loss=0.01390 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.065 | L2-Norm(final)=8.214 | 3941.5 samples/s | 61.6 steps/s
[Step=35900 Epoch=70.2] | Loss=0.01382 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.075 | L2-Norm(final)=8.215 | 3924.2 samples/s | 61.3 steps/s
[Step=35950 Epoch=70.3] | Loss=0.01369 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.085 | L2-Norm(final)=8.216 | 3918.7 samples/s | 61.2 steps/s
[Step=36000 Epoch=70.4] | Loss=0.01351 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.094 | L2-Norm(final)=8.217 | 3935.4 samples/s | 61.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step36000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=34001 Epoch=130.3] | Loss=0.00118 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.420 | L2-Norm(final)=6.926 | 3151.2 samples/s | 49.2 steps/s
[Step=34050 Epoch=130.5] | Loss=0.00096 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.448 | L2-Norm(final)=6.944 | 3976.0 samples/s | 62.1 steps/s
[Step=34100 Epoch=130.7] | Loss=0.00093 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.500 | L2-Norm(final)=6.949 | 4059.3 samples/s | 63.4 steps/s
[Step=34150 Epoch=130.9] | Loss=0.00074 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.534 | L2-Norm(final)=6.958 | 4097.8 samples/s | 64.0 steps/s
[Step=34200 Epoch=131.0] | Loss=0.00071 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.554 | L2-Norm(final)=6.967 | 4036.7 samples/s | 63.1 steps/s
[Step=34250 Epoch=131.2] | Loss=0.00060 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.565 | L2-Norm(final)=6.975 | 5404.9 samples/s | 84.5 steps/s
[Step=34300 Epoch=131.4] | Loss=0.00051 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.570 | L2-Norm(final)=6.982 | 1499.9 samples/s | 23.4 steps/s
[Step=34350 Epoch=131.6] | Loss=0.00045 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.570 | L2-Norm(final)=6.989 | 4096.2 samples/s | 64.0 steps/s
[Step=34400 Epoch=131.8] | Loss=0.00039 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.567 | L2-Norm(final)=6.995 | 4078.7 samples/s | 63.7 steps/s
[Step=34450 Epoch=132.0] | Loss=0.00035 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.562 | L2-Norm(final)=7.000 | 4091.9 samples/s | 63.9 steps/s
[Step=34500 Epoch=132.2] | Loss=0.00032 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.556 | L2-Norm(final)=7.005 | 4607.0 samples/s | 72.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=34501 Epoch=132.2] | Loss=0.00002 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=7.053 | 3304.9 samples/s | 51.6 steps/s
[Step=34550 Epoch=132.4] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.472 | L2-Norm(final)=7.056 | 3424.4 samples/s | 53.5 steps/s
[Step=34600 Epoch=132.6] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.446 | L2-Norm(final)=7.058 | 3754.8 samples/s | 58.7 steps/s
[Step=34650 Epoch=132.8] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.420 | L2-Norm(final)=7.060 | 3732.0 samples/s | 58.3 steps/s
[Step=34700 Epoch=133.0] | Loss=0.00001 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.394 | L2-Norm(final)=7.061 | 3674.6 samples/s | 57.4 steps/s
[Step=34750 Epoch=133.1] | Loss=0.00001 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=7.063 | 4681.0 samples/s | 73.1 steps/s
[Step=34800 Epoch=133.3] | Loss=0.00001 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=7.064 | 1499.4 samples/s | 23.4 steps/s
[Step=34850 Epoch=133.5] | Loss=0.00001 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.316 | L2-Norm(final)=7.065 | 3750.5 samples/s | 58.6 steps/s
[Step=34900 Epoch=133.7] | Loss=0.00001 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=7.066 | 3750.7 samples/s | 58.6 steps/s
[Step=34950 Epoch=133.9] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.263 | L2-Norm(final)=7.067 | 3728.4 samples/s | 58.3 steps/s
[Step=35000 Epoch=134.1] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.237 | L2-Norm(final)=7.068 | 4124.5 samples/s | 64.4 steps/s
[Step=35050 Epoch=134.3] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.210 | L2-Norm(final)=7.069 | 1511.0 samples/s | 23.6 steps/s
[Step=35100 Epoch=134.5] | Loss=0.00001 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.183 | L2-Norm(final)=7.069 | 3701.5 samples/s | 57.8 steps/s
[Step=35150 Epoch=134.7] | Loss=0.00001 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.156 | L2-Norm(final)=7.070 | 3762.9 samples/s | 58.8 steps/s
[Step=35200 Epoch=134.9] | Loss=0.00001 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.129 | L2-Norm(final)=7.071 | 3785.6 samples/s | 59.1 steps/s
[Step=35250 Epoch=135.1] | Loss=0.00001 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.101 | L2-Norm(final)=7.071 | 3693.4 samples/s | 57.7 steps/s
[Step=35300 Epoch=135.3] | Loss=0.00001 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.074 | L2-Norm(final)=7.072 | 1557.0 samples/s | 24.3 steps/s
[Step=35350 Epoch=135.4] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.047 | L2-Norm(final)=7.073 | 3738.6 samples/s | 58.4 steps/s
[Step=35400 Epoch=135.6] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.019 | L2-Norm(final)=7.073 | 3722.9 samples/s | 58.2 steps/s
[Step=35450 Epoch=135.8] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.992 | L2-Norm(final)=7.074 | 3747.1 samples/s | 58.5 steps/s
[Step=35500 Epoch=136.0] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.964 | L2-Norm(final)=7.074 | 3732.3 samples/s | 58.3 steps/s
[Step=35550 Epoch=136.2] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.936 | L2-Norm(final)=7.075 | 1621.2 samples/s | 25.3 steps/s
[Step=35600 Epoch=136.4] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.908 | L2-Norm(final)=7.075 | 3674.9 samples/s | 57.4 steps/s
[Step=35650 Epoch=136.6] | Loss=0.00000 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.880 | L2-Norm(final)=7.076 | 3729.9 samples/s | 58.3 steps/s
[Step=35700 Epoch=136.8] | Loss=0.00000 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.852 | L2-Norm(final)=7.077 | 3729.9 samples/s | 58.3 steps/s
[Step=35750 Epoch=137.0] | Loss=0.00000 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.824 | L2-Norm(final)=7.077 | 3769.7 samples/s | 58.9 steps/s
[Step=35800 Epoch=137.2] | Loss=0.00000 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.795 | L2-Norm(final)=7.078 | 5038.5 samples/s | 78.7 steps/s
[Step=35850 Epoch=137.4] | Loss=0.00000 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.767 | L2-Norm(final)=7.079 | 1402.1 samples/s | 21.9 steps/s
[Step=35900 Epoch=137.6] | Loss=0.00000 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.738 | L2-Norm(final)=7.079 | 3672.4 samples/s | 57.4 steps/s
[Step=35950 Epoch=137.7] | Loss=0.00000 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.710 | L2-Norm(final)=7.080 | 3687.8 samples/s | 57.6 steps/s
[Step=36000 Epoch=137.9] | Loss=0.00000 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.681 | L2-Norm(final)=7.081 | 3758.6 samples/s | 58.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step36000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=34001 Epoch=130.9] | Loss=0.00008 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.420 | L2-Norm(final)=7.611 | 3207.2 samples/s | 50.1 steps/s
[Step=34050 Epoch=131.1] | Loss=0.00067 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.454 | L2-Norm(final)=7.627 | 3804.4 samples/s | 59.4 steps/s
[Step=34100 Epoch=131.3] | Loss=0.00060 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.489 | L2-Norm(final)=7.643 | 4184.5 samples/s | 65.4 steps/s
[Step=34150 Epoch=131.5] | Loss=0.00075 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.527 | L2-Norm(final)=7.656 | 4218.3 samples/s | 65.9 steps/s
[Step=34200 Epoch=131.6] | Loss=0.00065 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.563 | L2-Norm(final)=7.664 | 4064.0 samples/s | 63.5 steps/s
[Step=34250 Epoch=131.8] | Loss=0.00056 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.585 | L2-Norm(final)=7.672 | 5357.6 samples/s | 83.7 steps/s
[Step=34300 Epoch=132.0] | Loss=0.00048 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.598 | L2-Norm(final)=7.680 | 1505.2 samples/s | 23.5 steps/s
[Step=34350 Epoch=132.2] | Loss=0.00042 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.604 | L2-Norm(final)=7.686 | 4137.4 samples/s | 64.6 steps/s
[Step=34400 Epoch=132.4] | Loss=0.00037 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.606 | L2-Norm(final)=7.692 | 4084.6 samples/s | 63.8 steps/s
[Step=34450 Epoch=132.6] | Loss=0.00033 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.605 | L2-Norm(final)=7.698 | 4142.4 samples/s | 64.7 steps/s
[Step=34500 Epoch=132.8] | Loss=0.00031 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.603 | L2-Norm(final)=7.703 | 4809.3 samples/s | 75.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=34501 Epoch=132.8] | Loss=0.00003 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.570 | L2-Norm(final)=7.755 | 3365.8 samples/s | 52.6 steps/s
[Step=34550 Epoch=133.0] | Loss=0.00003 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.553 | L2-Norm(final)=7.757 | 3422.0 samples/s | 53.5 steps/s
[Step=34600 Epoch=133.2] | Loss=0.00038 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.536 | L2-Norm(final)=7.760 | 3705.0 samples/s | 57.9 steps/s
[Step=34650 Epoch=133.4] | Loss=0.00930 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.619 | L2-Norm(final)=7.729 | 3731.7 samples/s | 58.3 steps/s
[Step=34700 Epoch=133.6] | Loss=0.00889 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.709 | L2-Norm(final)=7.692 | 3767.3 samples/s | 58.9 steps/s
[Step=34750 Epoch=133.8] | Loss=0.00762 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.766 | L2-Norm(final)=7.669 | 4759.2 samples/s | 74.4 steps/s
[Step=34800 Epoch=134.0] | Loss=0.00641 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=7.655 | 1463.9 samples/s | 22.9 steps/s
[Step=34850 Epoch=134.2] | Loss=0.00551 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.827 | L2-Norm(final)=7.646 | 3686.2 samples/s | 57.6 steps/s
[Step=34900 Epoch=134.3] | Loss=0.00485 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.844 | L2-Norm(final)=7.640 | 3755.5 samples/s | 58.7 steps/s
[Step=34950 Epoch=134.5] | Loss=0.00432 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.855 | L2-Norm(final)=7.635 | 3804.5 samples/s | 59.4 steps/s
[Step=35000 Epoch=134.7] | Loss=0.00391 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.863 | L2-Norm(final)=7.632 | 4226.0 samples/s | 66.0 steps/s
[Step=35050 Epoch=134.9] | Loss=0.00356 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.869 | L2-Norm(final)=7.630 | 1509.9 samples/s | 23.6 steps/s
[Step=35100 Epoch=135.1] | Loss=0.00326 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.873 | L2-Norm(final)=7.628 | 3731.3 samples/s | 58.3 steps/s
[Step=35150 Epoch=135.3] | Loss=0.00301 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.874 | L2-Norm(final)=7.627 | 3709.7 samples/s | 58.0 steps/s
[Step=35200 Epoch=135.5] | Loss=0.00280 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.874 | L2-Norm(final)=7.626 | 3711.6 samples/s | 58.0 steps/s
[Step=35250 Epoch=135.7] | Loss=0.00261 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.873 | L2-Norm(final)=7.625 | 3787.3 samples/s | 59.2 steps/s
[Step=35300 Epoch=135.9] | Loss=0.00245 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.871 | L2-Norm(final)=7.625 | 1588.2 samples/s | 24.8 steps/s
[Step=35350 Epoch=136.1] | Loss=0.00231 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.868 | L2-Norm(final)=7.624 | 3688.9 samples/s | 57.6 steps/s
[Step=35400 Epoch=136.3] | Loss=0.00218 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.864 | L2-Norm(final)=7.624 | 3733.3 samples/s | 58.3 steps/s
[Step=35450 Epoch=136.5] | Loss=0.00207 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.860 | L2-Norm(final)=7.624 | 3673.7 samples/s | 57.4 steps/s
[Step=35500 Epoch=136.7] | Loss=0.00196 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.855 | L2-Norm(final)=7.624 | 3622.5 samples/s | 56.6 steps/s
[Step=35550 Epoch=136.8] | Loss=0.00187 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=7.624 | 1580.6 samples/s | 24.7 steps/s
[Step=35600 Epoch=137.0] | Loss=0.00179 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.845 | L2-Norm(final)=7.624 | 3809.5 samples/s | 59.5 steps/s
[Step=35650 Epoch=137.2] | Loss=0.00171 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.839 | L2-Norm(final)=7.624 | 3654.1 samples/s | 57.1 steps/s
[Step=35700 Epoch=137.4] | Loss=0.00164 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.833 | L2-Norm(final)=7.624 | 3700.3 samples/s | 57.8 steps/s
[Step=35750 Epoch=137.6] | Loss=0.00157 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.826 | L2-Norm(final)=7.625 | 3678.6 samples/s | 57.5 steps/s
[Step=35800 Epoch=137.8] | Loss=0.00151 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.820 | L2-Norm(final)=7.625 | 5379.3 samples/s | 84.1 steps/s
[Step=35850 Epoch=138.0] | Loss=0.00146 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.813 | L2-Norm(final)=7.625 | 1397.2 samples/s | 21.8 steps/s
[Step=35900 Epoch=138.2] | Loss=0.00141 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.806 | L2-Norm(final)=7.626 | 3728.3 samples/s | 58.3 steps/s
[Step=35950 Epoch=138.4] | Loss=0.00136 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.799 | L2-Norm(final)=7.626 | 3693.8 samples/s | 57.7 steps/s
[Step=36000 Epoch=138.6] | Loss=0.00131 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.791 | L2-Norm(final)=7.627 | 3754.5 samples/s | 58.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06435 | acc=0.9671 | tpr=0.9701 | fpr=0.0394 | 3532.8 samples/s | 13.8 steps/s
Avg test loss: 0.07091, Avg test acc: 0.96494, Avg tpr: 0.96742, Avg fpr: 0.04051, total FA: 316

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07560 | acc=0.9623 | tpr=0.9595 | fpr=0.0315 | 3565.5 samples/s | 13.9 steps/s
Avg test loss: 0.08256, Avg test acc: 0.96037, Avg tpr: 0.95809, Avg fpr: 0.03461, total FA: 270

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.81974 | acc=0.3180 | tpr=0.0191 | fpr=0.0330 | 3498.3 samples/s | 13.7 steps/s
Avg test loss: 5.82754, Avg test acc: 0.31389, Avg tpr: 0.01789, Avg fpr: 0.03512, total FA: 274

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.36251 | acc=0.3105 | tpr=0.0192 | fpr=0.0567 | 3503.2 samples/s | 13.7 steps/s
Avg test loss: 5.36596, Avg test acc: 0.30635, Avg tpr: 0.01824, Avg fpr: 0.05999, total FA: 468

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.69200 | acc=0.1090 | tpr=0.7920 | fpr=0.9033 | 3529.0 samples/s | 13.8 steps/s
[Step= 100] | Loss=5.65690 | acc=0.1071 | tpr=0.7868 | fpr=0.9055 | 6772.9 samples/s | 26.5 steps/s
[Step= 150] | Loss=5.67527 | acc=0.1064 | tpr=0.7925 | fpr=0.9062 | 6989.9 samples/s | 27.3 steps/s
[Step= 200] | Loss=5.66028 | acc=0.1060 | tpr=0.7770 | fpr=0.9063 | 4121.5 samples/s | 16.1 steps/s
[Step= 250] | Loss=5.65916 | acc=0.1061 | tpr=0.7712 | fpr=0.9060 | 7138.1 samples/s | 27.9 steps/s
[Step= 300] | Loss=5.65819 | acc=0.1060 | tpr=0.7702 | fpr=0.9061 | 6666.1 samples/s | 26.0 steps/s
[Step= 350] | Loss=5.65420 | acc=0.1064 | tpr=0.7752 | fpr=0.9057 | 6870.0 samples/s | 26.8 steps/s
[Step= 400] | Loss=5.65020 | acc=0.1063 | tpr=0.7713 | fpr=0.9057 | 7021.8 samples/s | 27.4 steps/s
[Step= 450] | Loss=5.65768 | acc=0.1060 | tpr=0.7751 | fpr=0.9061 | 6520.3 samples/s | 25.5 steps/s
[Step= 500] | Loss=5.66100 | acc=0.1058 | tpr=0.7767 | fpr=0.9063 | 6930.7 samples/s | 27.1 steps/s
[Step= 550] | Loss=5.66152 | acc=0.1059 | tpr=0.7776 | fpr=0.9063 | 11998.3 samples/s | 46.9 steps/s
Avg test loss: 5.66402, Avg test acc: 0.10588, Avg tpr: 0.77734, Avg fpr: 0.90633, total FA: 125842

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.07257 | acc=0.1297 | tpr=0.5929 | fpr=0.8786 | 3524.8 samples/s | 13.8 steps/s
[Step= 100] | Loss=6.02969 | acc=0.1308 | tpr=0.6269 | fpr=0.8785 | 6907.8 samples/s | 27.0 steps/s
[Step= 150] | Loss=6.04294 | acc=0.1304 | tpr=0.6340 | fpr=0.8789 | 6634.2 samples/s | 25.9 steps/s
[Step= 200] | Loss=6.02660 | acc=0.1308 | tpr=0.6186 | fpr=0.8781 | 4187.7 samples/s | 16.4 steps/s
[Step= 250] | Loss=6.02967 | acc=0.1310 | tpr=0.6175 | fpr=0.8778 | 6952.5 samples/s | 27.2 steps/s
[Step= 300] | Loss=6.03097 | acc=0.1311 | tpr=0.6240 | fpr=0.8779 | 6884.1 samples/s | 26.9 steps/s
[Step= 350] | Loss=6.03004 | acc=0.1313 | tpr=0.6255 | fpr=0.8776 | 6843.6 samples/s | 26.7 steps/s
[Step= 400] | Loss=6.02452 | acc=0.1320 | tpr=0.6291 | fpr=0.8771 | 6761.5 samples/s | 26.4 steps/s
[Step= 450] | Loss=6.03187 | acc=0.1318 | tpr=0.6324 | fpr=0.8772 | 6681.9 samples/s | 26.1 steps/s
[Step= 500] | Loss=6.03315 | acc=0.1320 | tpr=0.6348 | fpr=0.8770 | 6903.1 samples/s | 27.0 steps/s
[Step= 550] | Loss=6.03349 | acc=0.1322 | tpr=0.6371 | fpr=0.8770 | 12206.0 samples/s | 47.7 steps/s
Avg test loss: 6.03579, Avg test acc: 0.13211, Avg tpr: 0.63708, Avg fpr: 0.87707, total FA: 121780

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11228 | acc=0.9809 | tpr=0.9425 | fpr=0.0184 | 3500.4 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.11526 | acc=0.9803 | tpr=0.9446 | fpr=0.0190 | 6883.0 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.11778 | acc=0.9797 | tpr=0.9438 | fpr=0.0196 | 4481.8 samples/s | 17.5 steps/s
[Step= 200] | Loss=0.11778 | acc=0.9799 | tpr=0.9421 | fpr=0.0194 | 6144.6 samples/s | 24.0 steps/s
[Step= 250] | Loss=0.11624 | acc=0.9801 | tpr=0.9424 | fpr=0.0192 | 6901.5 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.11816 | acc=0.9799 | tpr=0.9440 | fpr=0.0195 | 6944.0 samples/s | 27.1 steps/s
[Step= 350] | Loss=0.11763 | acc=0.9799 | tpr=0.9436 | fpr=0.0194 | 7160.6 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.11928 | acc=0.9798 | tpr=0.9398 | fpr=0.0195 | 6321.8 samples/s | 24.7 steps/s
[Step= 450] | Loss=0.12161 | acc=0.9795 | tpr=0.9387 | fpr=0.0197 | 7195.3 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.12135 | acc=0.9796 | tpr=0.9419 | fpr=0.0197 | 6226.6 samples/s | 24.3 steps/s
[Step= 550] | Loss=0.12079 | acc=0.9797 | tpr=0.9415 | fpr=0.0196 | 12490.3 samples/s | 48.8 steps/s
Avg test loss: 0.12072, Avg test acc: 0.97973, Avg tpr: 0.94097, Avg fpr: 0.01957, total FA: 2717

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11673 | acc=0.9808 | tpr=0.9159 | fpr=0.0181 | 3488.4 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.12004 | acc=0.9809 | tpr=0.9254 | fpr=0.0180 | 6890.5 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.12350 | acc=0.9804 | tpr=0.9352 | fpr=0.0188 | 4116.2 samples/s | 16.1 steps/s
[Step= 200] | Loss=0.12539 | acc=0.9803 | tpr=0.9344 | fpr=0.0189 | 6896.7 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.12389 | acc=0.9805 | tpr=0.9345 | fpr=0.0187 | 6780.4 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.12692 | acc=0.9799 | tpr=0.9338 | fpr=0.0192 | 6850.9 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.12597 | acc=0.9800 | tpr=0.9349 | fpr=0.0192 | 6781.3 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.12761 | acc=0.9799 | tpr=0.9333 | fpr=0.0193 | 6721.9 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.12984 | acc=0.9797 | tpr=0.9328 | fpr=0.0194 | 6734.3 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.12917 | acc=0.9798 | tpr=0.9352 | fpr=0.0194 | 6796.7 samples/s | 26.5 steps/s
[Step= 550] | Loss=0.12857 | acc=0.9799 | tpr=0.9339 | fpr=0.0193 | 12302.5 samples/s | 48.1 steps/s
Avg test loss: 0.12845, Avg test acc: 0.97990, Avg tpr: 0.93344, Avg fpr: 0.01926, total FA: 2674

server round 18/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=36001 Epoch=70.2] | Loss=0.00578 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.183 | L2-Norm(final)=7.897 | 3177.1 samples/s | 49.6 steps/s
[Step=36050 Epoch=70.3] | Loss=0.01156 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.209 | L2-Norm(final)=7.908 | 4084.9 samples/s | 63.8 steps/s
[Step=36100 Epoch=70.4] | Loss=0.01253 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.229 | L2-Norm(final)=7.922 | 4392.3 samples/s | 68.6 steps/s
[Step=36150 Epoch=70.5] | Loss=0.01382 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.246 | L2-Norm(final)=7.934 | 4344.5 samples/s | 67.9 steps/s
[Step=36200 Epoch=70.6] | Loss=0.01368 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.263 | L2-Norm(final)=7.945 | 4360.2 samples/s | 68.1 steps/s
[Step=36250 Epoch=70.7] | Loss=0.01311 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.280 | L2-Norm(final)=7.956 | 4343.7 samples/s | 67.9 steps/s
[Step=36300 Epoch=70.8] | Loss=0.01329 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.296 | L2-Norm(final)=7.967 | 4435.1 samples/s | 69.3 steps/s
[Step=36350 Epoch=70.9] | Loss=0.01294 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=7.977 | 4357.8 samples/s | 68.1 steps/s
[Step=36400 Epoch=71.0] | Loss=0.01266 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.326 | L2-Norm(final)=7.987 | 4394.0 samples/s | 68.7 steps/s
[Step=36450 Epoch=71.1] | Loss=0.01266 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.339 | L2-Norm(final)=7.996 | 4400.2 samples/s | 68.8 steps/s
[Step=36500 Epoch=71.2] | Loss=0.01233 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.353 | L2-Norm(final)=8.005 | 5578.8 samples/s | 87.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=36501 Epoch=71.2] | Loss=0.00341 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=8.090 | 3292.2 samples/s | 51.4 steps/s
[Step=36550 Epoch=71.3] | Loss=0.00970 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.490 | L2-Norm(final)=8.095 | 3606.3 samples/s | 56.3 steps/s
[Step=36600 Epoch=71.4] | Loss=0.01190 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.507 | L2-Norm(final)=8.097 | 3974.0 samples/s | 62.1 steps/s
[Step=36650 Epoch=71.5] | Loss=0.01381 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.527 | L2-Norm(final)=8.096 | 3938.5 samples/s | 61.5 steps/s
[Step=36700 Epoch=71.6] | Loss=0.01451 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.549 | L2-Norm(final)=8.095 | 3935.3 samples/s | 61.5 steps/s
[Step=36750 Epoch=71.7] | Loss=0.01565 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.570 | L2-Norm(final)=8.094 | 3919.4 samples/s | 61.2 steps/s
[Step=36800 Epoch=71.8] | Loss=0.01548 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.591 | L2-Norm(final)=8.094 | 3953.2 samples/s | 61.8 steps/s
[Step=36850 Epoch=71.9] | Loss=0.01578 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.610 | L2-Norm(final)=8.096 | 3953.5 samples/s | 61.8 steps/s
[Step=36900 Epoch=72.0] | Loss=0.01619 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.628 | L2-Norm(final)=8.096 | 3966.9 samples/s | 62.0 steps/s
[Step=36950 Epoch=72.1] | Loss=0.01605 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.644 | L2-Norm(final)=8.095 | 3900.9 samples/s | 61.0 steps/s
[Step=37000 Epoch=72.2] | Loss=0.01621 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.660 | L2-Norm(final)=8.096 | 4838.2 samples/s | 75.6 steps/s
[Step=37050 Epoch=72.3] | Loss=0.01598 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.677 | L2-Norm(final)=8.097 | 1448.4 samples/s | 22.6 steps/s
[Step=37100 Epoch=72.4] | Loss=0.01578 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.692 | L2-Norm(final)=8.099 | 3881.2 samples/s | 60.6 steps/s
[Step=37150 Epoch=72.5] | Loss=0.01558 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.707 | L2-Norm(final)=8.100 | 3917.8 samples/s | 61.2 steps/s
[Step=37200 Epoch=72.6] | Loss=0.01542 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.721 | L2-Norm(final)=8.102 | 3910.9 samples/s | 61.1 steps/s
[Step=37250 Epoch=72.7] | Loss=0.01527 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.734 | L2-Norm(final)=8.103 | 3977.9 samples/s | 62.2 steps/s
[Step=37300 Epoch=72.7] | Loss=0.01503 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.747 | L2-Norm(final)=8.105 | 3864.6 samples/s | 60.4 steps/s
[Step=37350 Epoch=72.8] | Loss=0.01503 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.760 | L2-Norm(final)=8.107 | 3943.9 samples/s | 61.6 steps/s
[Step=37400 Epoch=72.9] | Loss=0.01498 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.772 | L2-Norm(final)=8.109 | 3948.4 samples/s | 61.7 steps/s
[Step=37450 Epoch=73.0] | Loss=0.01481 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.783 | L2-Norm(final)=8.110 | 3917.0 samples/s | 61.2 steps/s
[Step=37500 Epoch=73.1] | Loss=0.01485 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.795 | L2-Norm(final)=8.111 | 4185.6 samples/s | 65.4 steps/s
[Step=37550 Epoch=73.2] | Loss=0.01487 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.806 | L2-Norm(final)=8.111 | 1533.9 samples/s | 24.0 steps/s
[Step=37600 Epoch=73.3] | Loss=0.01472 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.817 | L2-Norm(final)=8.111 | 3924.5 samples/s | 61.3 steps/s
[Step=37650 Epoch=73.4] | Loss=0.01459 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.829 | L2-Norm(final)=8.112 | 3915.3 samples/s | 61.2 steps/s
[Step=37700 Epoch=73.5] | Loss=0.01431 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.839 | L2-Norm(final)=8.113 | 3955.6 samples/s | 61.8 steps/s
[Step=37750 Epoch=73.6] | Loss=0.01422 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.849 | L2-Norm(final)=8.115 | 3949.0 samples/s | 61.7 steps/s
[Step=37800 Epoch=73.7] | Loss=0.01406 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.859 | L2-Norm(final)=8.116 | 3943.0 samples/s | 61.6 steps/s
[Step=37850 Epoch=73.8] | Loss=0.01406 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.869 | L2-Norm(final)=8.116 | 3968.7 samples/s | 62.0 steps/s
[Step=37900 Epoch=73.9] | Loss=0.01402 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.879 | L2-Norm(final)=8.117 | 3992.9 samples/s | 62.4 steps/s
[Step=37950 Epoch=74.0] | Loss=0.01391 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.890 | L2-Norm(final)=8.118 | 3993.8 samples/s | 62.4 steps/s
[Step=38000 Epoch=74.1] | Loss=0.01390 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.900 | L2-Norm(final)=8.120 | 4001.0 samples/s | 62.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step38000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=36001 Epoch=70.4] | Loss=0.01714 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.183 | L2-Norm(final)=8.251 | 3199.4 samples/s | 50.0 steps/s
[Step=36050 Epoch=70.5] | Loss=0.01286 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.225 | L2-Norm(final)=8.271 | 4349.4 samples/s | 68.0 steps/s
[Step=36100 Epoch=70.6] | Loss=0.01137 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.252 | L2-Norm(final)=8.287 | 4362.6 samples/s | 68.2 steps/s
[Step=36150 Epoch=70.7] | Loss=0.01232 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.274 | L2-Norm(final)=8.303 | 4329.3 samples/s | 67.6 steps/s
[Step=36200 Epoch=70.8] | Loss=0.01324 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.294 | L2-Norm(final)=8.316 | 4267.1 samples/s | 66.7 steps/s
[Step=36250 Epoch=70.9] | Loss=0.01312 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.313 | L2-Norm(final)=8.328 | 4387.7 samples/s | 68.6 steps/s
[Step=36300 Epoch=71.0] | Loss=0.01321 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.332 | L2-Norm(final)=8.339 | 4385.7 samples/s | 68.5 steps/s
[Step=36350 Epoch=71.1] | Loss=0.01269 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.348 | L2-Norm(final)=8.350 | 4445.0 samples/s | 69.5 steps/s
[Step=36400 Epoch=71.2] | Loss=0.01296 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.365 | L2-Norm(final)=8.361 | 4319.4 samples/s | 67.5 steps/s
[Step=36450 Epoch=71.3] | Loss=0.01271 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.381 | L2-Norm(final)=8.370 | 4435.5 samples/s | 69.3 steps/s
[Step=36500 Epoch=71.4] | Loss=0.01261 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.396 | L2-Norm(final)=8.380 | 5559.9 samples/s | 86.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=36501 Epoch=71.4] | Loss=0.01483 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.540 | L2-Norm(final)=8.481 | 3366.8 samples/s | 52.6 steps/s
[Step=36550 Epoch=71.5] | Loss=0.01233 | Reg=0.00184 | acc=0.9531 | L2-Norm=13.554 | L2-Norm(final)=8.490 | 3755.9 samples/s | 58.7 steps/s
[Step=36600 Epoch=71.6] | Loss=0.01423 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.574 | L2-Norm(final)=8.493 | 3922.4 samples/s | 61.3 steps/s
[Step=36650 Epoch=71.6] | Loss=0.01539 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.596 | L2-Norm(final)=8.492 | 3927.5 samples/s | 61.4 steps/s
[Step=36700 Epoch=71.7] | Loss=0.01556 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=8.493 | 3988.4 samples/s | 62.3 steps/s
[Step=36750 Epoch=71.8] | Loss=0.01570 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.639 | L2-Norm(final)=8.496 | 3942.1 samples/s | 61.6 steps/s
[Step=36800 Epoch=71.9] | Loss=0.01623 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.658 | L2-Norm(final)=8.497 | 3950.8 samples/s | 61.7 steps/s
[Step=36850 Epoch=72.0] | Loss=0.01717 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.676 | L2-Norm(final)=8.497 | 3986.0 samples/s | 62.3 steps/s
[Step=36900 Epoch=72.1] | Loss=0.01692 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.696 | L2-Norm(final)=8.497 | 3995.9 samples/s | 62.4 steps/s
[Step=36950 Epoch=72.2] | Loss=0.01669 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=8.497 | 3920.2 samples/s | 61.3 steps/s
[Step=37000 Epoch=72.3] | Loss=0.01687 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.732 | L2-Norm(final)=8.498 | 4813.7 samples/s | 75.2 steps/s
[Step=37050 Epoch=72.4] | Loss=0.01663 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.751 | L2-Norm(final)=8.499 | 1516.7 samples/s | 23.7 steps/s
[Step=37100 Epoch=72.5] | Loss=0.01641 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.768 | L2-Norm(final)=8.499 | 3893.9 samples/s | 60.8 steps/s
[Step=37150 Epoch=72.6] | Loss=0.01625 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.785 | L2-Norm(final)=8.499 | 3965.3 samples/s | 62.0 steps/s
[Step=37200 Epoch=72.7] | Loss=0.01600 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.801 | L2-Norm(final)=8.500 | 3951.3 samples/s | 61.7 steps/s
[Step=37250 Epoch=72.8] | Loss=0.01600 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.816 | L2-Norm(final)=8.500 | 3916.4 samples/s | 61.2 steps/s
[Step=37300 Epoch=72.9] | Loss=0.01595 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.831 | L2-Norm(final)=8.500 | 3942.4 samples/s | 61.6 steps/s
[Step=37350 Epoch=73.0] | Loss=0.01597 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.846 | L2-Norm(final)=8.501 | 3971.8 samples/s | 62.1 steps/s
[Step=37400 Epoch=73.1] | Loss=0.01583 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.860 | L2-Norm(final)=8.501 | 3960.9 samples/s | 61.9 steps/s
[Step=37450 Epoch=73.2] | Loss=0.01584 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.874 | L2-Norm(final)=8.501 | 3922.1 samples/s | 61.3 steps/s
[Step=37500 Epoch=73.3] | Loss=0.01579 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.888 | L2-Norm(final)=8.502 | 4266.8 samples/s | 66.7 steps/s
[Step=37550 Epoch=73.4] | Loss=0.01549 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.902 | L2-Norm(final)=8.502 | 1561.5 samples/s | 24.4 steps/s
[Step=37600 Epoch=73.5] | Loss=0.01517 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.915 | L2-Norm(final)=8.503 | 3938.3 samples/s | 61.5 steps/s
[Step=37650 Epoch=73.6] | Loss=0.01508 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.927 | L2-Norm(final)=8.504 | 3894.1 samples/s | 60.8 steps/s
[Step=37700 Epoch=73.7] | Loss=0.01495 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.938 | L2-Norm(final)=8.504 | 3886.7 samples/s | 60.7 steps/s
[Step=37750 Epoch=73.8] | Loss=0.01477 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.949 | L2-Norm(final)=8.505 | 3937.5 samples/s | 61.5 steps/s
[Step=37800 Epoch=73.9] | Loss=0.01466 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.960 | L2-Norm(final)=8.505 | 3943.0 samples/s | 61.6 steps/s
[Step=37850 Epoch=74.0] | Loss=0.01469 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.971 | L2-Norm(final)=8.505 | 3934.1 samples/s | 61.5 steps/s
[Step=37900 Epoch=74.1] | Loss=0.01458 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.981 | L2-Norm(final)=8.505 | 3893.9 samples/s | 60.8 steps/s
[Step=37950 Epoch=74.2] | Loss=0.01450 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.990 | L2-Norm(final)=8.505 | 3931.2 samples/s | 61.4 steps/s
[Step=38000 Epoch=74.3] | Loss=0.01438 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.000 | L2-Norm(final)=8.505 | 3937.2 samples/s | 61.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step38000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=36001 Epoch=137.9] | Loss=0.00178 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.183 | L2-Norm(final)=7.102 | 3399.6 samples/s | 53.1 steps/s
[Step=36050 Epoch=138.1] | Loss=0.00110 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.226 | L2-Norm(final)=7.128 | 3517.4 samples/s | 55.0 steps/s
[Step=36100 Epoch=138.3] | Loss=0.00091 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.266 | L2-Norm(final)=7.141 | 4176.6 samples/s | 65.3 steps/s
[Step=36150 Epoch=138.5] | Loss=0.00080 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.286 | L2-Norm(final)=7.152 | 3998.3 samples/s | 62.5 steps/s
[Step=36200 Epoch=138.7] | Loss=0.00067 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.305 | L2-Norm(final)=7.162 | 4210.9 samples/s | 65.8 steps/s
[Step=36250 Epoch=138.9] | Loss=0.00067 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.316 | L2-Norm(final)=7.171 | 5182.1 samples/s | 81.0 steps/s
[Step=36300 Epoch=139.1] | Loss=0.00058 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.321 | L2-Norm(final)=7.179 | 1524.0 samples/s | 23.8 steps/s
[Step=36350 Epoch=139.3] | Loss=0.00050 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.322 | L2-Norm(final)=7.186 | 4049.2 samples/s | 63.3 steps/s
[Step=36400 Epoch=139.5] | Loss=0.00045 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.319 | L2-Norm(final)=7.192 | 4054.9 samples/s | 63.4 steps/s
[Step=36450 Epoch=139.7] | Loss=0.00040 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.314 | L2-Norm(final)=7.197 | 4138.1 samples/s | 64.7 steps/s
[Step=36500 Epoch=139.9] | Loss=0.00036 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.309 | L2-Norm(final)=7.202 | 4595.6 samples/s | 71.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=36501 Epoch=139.9] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.244 | L2-Norm(final)=7.252 | 3142.3 samples/s | 49.1 steps/s
[Step=36550 Epoch=140.0] | Loss=0.00159 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.237 | L2-Norm(final)=7.256 | 3614.7 samples/s | 56.5 steps/s
[Step=36600 Epoch=140.2] | Loss=0.01077 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.401 | L2-Norm(final)=7.210 | 3720.9 samples/s | 58.1 steps/s
[Step=36650 Epoch=140.4] | Loss=0.01059 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.529 | L2-Norm(final)=7.166 | 3683.1 samples/s | 57.5 steps/s
[Step=36700 Epoch=140.6] | Loss=0.00900 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.606 | L2-Norm(final)=7.137 | 3749.2 samples/s | 58.6 steps/s
[Step=36750 Epoch=140.8] | Loss=0.00734 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.654 | L2-Norm(final)=7.119 | 4693.8 samples/s | 73.3 steps/s
[Step=36800 Epoch=141.0] | Loss=0.00617 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.685 | L2-Norm(final)=7.107 | 1443.3 samples/s | 22.6 steps/s
[Step=36850 Epoch=141.2] | Loss=0.00529 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.704 | L2-Norm(final)=7.100 | 3717.5 samples/s | 58.1 steps/s
[Step=36900 Epoch=141.4] | Loss=0.00464 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.717 | L2-Norm(final)=7.094 | 3717.5 samples/s | 58.1 steps/s
[Step=36950 Epoch=141.6] | Loss=0.00412 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.724 | L2-Norm(final)=7.090 | 3680.9 samples/s | 57.5 steps/s
[Step=37000 Epoch=141.8] | Loss=0.00371 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.729 | L2-Norm(final)=7.087 | 4159.0 samples/s | 65.0 steps/s
[Step=37050 Epoch=142.0] | Loss=0.00342 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.731 | L2-Norm(final)=7.084 | 1521.1 samples/s | 23.8 steps/s
[Step=37100 Epoch=142.2] | Loss=0.00314 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.732 | L2-Norm(final)=7.082 | 3778.6 samples/s | 59.0 steps/s
[Step=37150 Epoch=142.3] | Loss=0.00290 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.731 | L2-Norm(final)=7.081 | 3730.9 samples/s | 58.3 steps/s
[Step=37200 Epoch=142.5] | Loss=0.00269 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.729 | L2-Norm(final)=7.080 | 3720.8 samples/s | 58.1 steps/s
[Step=37250 Epoch=142.7] | Loss=0.00251 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.726 | L2-Norm(final)=7.079 | 3740.5 samples/s | 58.4 steps/s
[Step=37300 Epoch=142.9] | Loss=0.00236 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.723 | L2-Norm(final)=7.078 | 1543.0 samples/s | 24.1 steps/s
[Step=37350 Epoch=143.1] | Loss=0.00222 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.719 | L2-Norm(final)=7.078 | 3843.9 samples/s | 60.1 steps/s
[Step=37400 Epoch=143.3] | Loss=0.00210 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=7.077 | 3713.3 samples/s | 58.0 steps/s
[Step=37450 Epoch=143.5] | Loss=0.00199 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.709 | L2-Norm(final)=7.077 | 3694.2 samples/s | 57.7 steps/s
[Step=37500 Epoch=143.7] | Loss=0.00189 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.704 | L2-Norm(final)=7.077 | 3695.1 samples/s | 57.7 steps/s
[Step=37550 Epoch=143.9] | Loss=0.00180 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=7.077 | 1599.0 samples/s | 25.0 steps/s
[Step=37600 Epoch=144.1] | Loss=0.00172 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.692 | L2-Norm(final)=7.077 | 3668.1 samples/s | 57.3 steps/s
[Step=37650 Epoch=144.3] | Loss=0.00164 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.685 | L2-Norm(final)=7.077 | 3698.9 samples/s | 57.8 steps/s
[Step=37700 Epoch=144.5] | Loss=0.00158 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.679 | L2-Norm(final)=7.077 | 3732.9 samples/s | 58.3 steps/s
[Step=37750 Epoch=144.6] | Loss=0.00151 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.672 | L2-Norm(final)=7.077 | 3746.2 samples/s | 58.5 steps/s
[Step=37800 Epoch=144.8] | Loss=0.00146 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.665 | L2-Norm(final)=7.077 | 5034.8 samples/s | 78.7 steps/s
[Step=37850 Epoch=145.0] | Loss=0.00140 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.658 | L2-Norm(final)=7.078 | 1416.9 samples/s | 22.1 steps/s
[Step=37900 Epoch=145.2] | Loss=0.00135 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.651 | L2-Norm(final)=7.078 | 3733.1 samples/s | 58.3 steps/s
[Step=37950 Epoch=145.4] | Loss=0.00131 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.643 | L2-Norm(final)=7.078 | 3721.5 samples/s | 58.1 steps/s
[Step=38000 Epoch=145.6] | Loss=0.00126 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.635 | L2-Norm(final)=7.079 | 3725.6 samples/s | 58.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step38000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=36001 Epoch=138.6] | Loss=0.00002 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.183 | L2-Norm(final)=7.641 | 3040.5 samples/s | 47.5 steps/s
[Step=36050 Epoch=138.8] | Loss=0.00077 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.208 | L2-Norm(final)=7.648 | 4174.1 samples/s | 65.2 steps/s
[Step=36100 Epoch=139.0] | Loss=0.00051 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.225 | L2-Norm(final)=7.659 | 4150.1 samples/s | 64.8 steps/s
[Step=36150 Epoch=139.2] | Loss=0.00049 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.230 | L2-Norm(final)=7.667 | 4022.7 samples/s | 62.9 steps/s
[Step=36200 Epoch=139.3] | Loss=0.00039 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.236 | L2-Norm(final)=7.674 | 4140.8 samples/s | 64.7 steps/s
[Step=36250 Epoch=139.5] | Loss=0.00034 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.238 | L2-Norm(final)=7.680 | 5377.7 samples/s | 84.0 steps/s
[Step=36300 Epoch=139.7] | Loss=0.00029 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.237 | L2-Norm(final)=7.685 | 1500.7 samples/s | 23.4 steps/s
[Step=36350 Epoch=139.9] | Loss=0.00026 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.235 | L2-Norm(final)=7.690 | 4178.8 samples/s | 65.3 steps/s
[Step=36400 Epoch=140.1] | Loss=0.00023 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.231 | L2-Norm(final)=7.694 | 4047.0 samples/s | 63.2 steps/s
[Step=36450 Epoch=140.3] | Loss=0.00021 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.227 | L2-Norm(final)=7.699 | 4194.3 samples/s | 65.5 steps/s
[Step=36500 Epoch=140.5] | Loss=0.00019 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.222 | L2-Norm(final)=7.703 | 4711.4 samples/s | 73.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=36501 Epoch=140.5] | Loss=0.00000 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.176 | L2-Norm(final)=7.745 | 3159.3 samples/s | 49.4 steps/s
[Step=36550 Epoch=140.7] | Loss=0.00002 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.166 | L2-Norm(final)=7.747 | 3526.0 samples/s | 55.1 steps/s
[Step=36600 Epoch=140.9] | Loss=0.00003 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.155 | L2-Norm(final)=7.750 | 3721.6 samples/s | 58.2 steps/s
[Step=36650 Epoch=141.1] | Loss=0.00003 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.144 | L2-Norm(final)=7.752 | 3730.6 samples/s | 58.3 steps/s
[Step=36700 Epoch=141.3] | Loss=0.00003 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.132 | L2-Norm(final)=7.755 | 3712.2 samples/s | 58.0 steps/s
[Step=36750 Epoch=141.5] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.121 | L2-Norm(final)=7.758 | 4733.5 samples/s | 74.0 steps/s
[Step=36800 Epoch=141.7] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.110 | L2-Norm(final)=7.760 | 1447.5 samples/s | 22.6 steps/s
[Step=36850 Epoch=141.9] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.098 | L2-Norm(final)=7.762 | 3677.1 samples/s | 57.5 steps/s
[Step=36900 Epoch=142.0] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.086 | L2-Norm(final)=7.764 | 3705.5 samples/s | 57.9 steps/s
[Step=36950 Epoch=142.2] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.074 | L2-Norm(final)=7.766 | 3741.1 samples/s | 58.5 steps/s
[Step=37000 Epoch=142.4] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.061 | L2-Norm(final)=7.767 | 4202.8 samples/s | 65.7 steps/s
[Step=37050 Epoch=142.6] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.049 | L2-Norm(final)=7.769 | 1054.1 samples/s | 16.5 steps/s
[Step=37100 Epoch=142.8] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.037 | L2-Norm(final)=7.770 | 3761.4 samples/s | 58.8 steps/s
[Step=37150 Epoch=143.0] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.024 | L2-Norm(final)=7.771 | 3431.7 samples/s | 53.6 steps/s
[Step=37200 Epoch=143.2] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.011 | L2-Norm(final)=7.773 | 3724.7 samples/s | 58.2 steps/s
[Step=37250 Epoch=143.4] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.999 | L2-Norm(final)=7.774 | 3799.9 samples/s | 59.4 steps/s
[Step=37300 Epoch=143.6] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.986 | L2-Norm(final)=7.776 | 1572.6 samples/s | 24.6 steps/s
[Step=37350 Epoch=143.8] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.973 | L2-Norm(final)=7.777 | 3742.9 samples/s | 58.5 steps/s
[Step=37400 Epoch=144.0] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=7.778 | 3708.5 samples/s | 57.9 steps/s
[Step=37450 Epoch=144.2] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.948 | L2-Norm(final)=7.780 | 3724.3 samples/s | 58.2 steps/s
[Step=37500 Epoch=144.4] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.935 | L2-Norm(final)=7.781 | 3763.5 samples/s | 58.8 steps/s
[Step=37550 Epoch=144.5] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.922 | L2-Norm(final)=7.782 | 1580.9 samples/s | 24.7 steps/s
[Step=37600 Epoch=144.7] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.908 | L2-Norm(final)=7.783 | 3733.6 samples/s | 58.3 steps/s
[Step=37650 Epoch=144.9] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.895 | L2-Norm(final)=7.785 | 3723.0 samples/s | 58.2 steps/s
[Step=37700 Epoch=145.1] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.882 | L2-Norm(final)=7.786 | 3695.8 samples/s | 57.7 steps/s
[Step=37750 Epoch=145.3] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.869 | L2-Norm(final)=7.787 | 3672.5 samples/s | 57.4 steps/s
[Step=37800 Epoch=145.5] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.855 | L2-Norm(final)=7.789 | 5447.3 samples/s | 85.1 steps/s
[Step=37850 Epoch=145.7] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.842 | L2-Norm(final)=7.790 | 1443.3 samples/s | 22.6 steps/s
[Step=37900 Epoch=145.9] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.828 | L2-Norm(final)=7.791 | 3678.6 samples/s | 57.5 steps/s
[Step=37950 Epoch=146.1] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.814 | L2-Norm(final)=7.792 | 3747.5 samples/s | 58.6 steps/s
[Step=38000 Epoch=146.3] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.801 | L2-Norm(final)=7.794 | 3725.7 samples/s | 58.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step38000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06710 | acc=0.9658 | tpr=0.9801 | fpr=0.0654 | 3523.4 samples/s | 13.8 steps/s
Avg test loss: 0.07120, Avg test acc: 0.96454, Avg tpr: 0.97884, Avg fpr: 0.06691, total FA: 522

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06560 | acc=0.9683 | tpr=0.9782 | fpr=0.0533 | 3561.3 samples/s | 13.9 steps/s
Avg test loss: 0.07394, Avg test acc: 0.96658, Avg tpr: 0.97692, Avg fpr: 0.05615, total FA: 438

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.49846 | acc=0.3073 | tpr=0.0088 | fpr=0.0444 | 3518.7 samples/s | 13.7 steps/s
Avg test loss: 5.51628, Avg test acc: 0.30475, Avg tpr: 0.00921, Avg fpr: 0.04525, total FA: 353

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.95524 | acc=0.3182 | tpr=0.0294 | fpr=0.0548 | 3480.3 samples/s | 13.6 steps/s
Avg test loss: 4.95927, Avg test acc: 0.31641, Avg tpr: 0.03048, Avg fpr: 0.05474, total FA: 427

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.50880 | acc=0.0928 | tpr=0.8319 | fpr=0.9205 | 3488.0 samples/s | 13.6 steps/s
[Step= 100] | Loss=6.45723 | acc=0.0938 | tpr=0.8486 | fpr=0.9203 | 7358.8 samples/s | 28.7 steps/s
[Step= 150] | Loss=6.47070 | acc=0.0930 | tpr=0.8487 | fpr=0.9209 | 6485.8 samples/s | 25.3 steps/s
[Step= 200] | Loss=6.45386 | acc=0.0925 | tpr=0.8306 | fpr=0.9209 | 7007.9 samples/s | 27.4 steps/s
[Step= 250] | Loss=6.45288 | acc=0.0922 | tpr=0.8271 | fpr=0.9212 | 6849.4 samples/s | 26.8 steps/s
[Step= 300] | Loss=6.45636 | acc=0.0919 | tpr=0.8291 | fpr=0.9216 | 6853.3 samples/s | 26.8 steps/s
[Step= 350] | Loss=6.45684 | acc=0.0920 | tpr=0.8303 | fpr=0.9214 | 6905.1 samples/s | 27.0 steps/s
[Step= 400] | Loss=6.45135 | acc=0.0923 | tpr=0.8304 | fpr=0.9211 | 6706.9 samples/s | 26.2 steps/s
[Step= 450] | Loss=6.45550 | acc=0.0922 | tpr=0.8345 | fpr=0.9212 | 6799.8 samples/s | 26.6 steps/s
[Step= 500] | Loss=6.45978 | acc=0.0921 | tpr=0.8339 | fpr=0.9213 | 6707.8 samples/s | 26.2 steps/s
[Step= 550] | Loss=6.46088 | acc=0.0921 | tpr=0.8333 | fpr=0.9214 | 12562.8 samples/s | 49.1 steps/s
Avg test loss: 6.46238, Avg test acc: 0.09198, Avg tpr: 0.83281, Avg fpr: 0.92148, total FA: 127946

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.87634 | acc=0.0993 | tpr=0.8319 | fpr=0.9139 | 3510.8 samples/s | 13.7 steps/s
[Step= 100] | Loss=6.84335 | acc=0.1012 | tpr=0.8401 | fpr=0.9126 | 7092.2 samples/s | 27.7 steps/s
[Step= 150] | Loss=6.86868 | acc=0.1004 | tpr=0.8386 | fpr=0.9131 | 6672.8 samples/s | 26.1 steps/s
[Step= 200] | Loss=6.84344 | acc=0.0997 | tpr=0.8208 | fpr=0.9134 | 6962.8 samples/s | 27.2 steps/s
[Step= 250] | Loss=6.84622 | acc=0.0993 | tpr=0.8114 | fpr=0.9137 | 7067.0 samples/s | 27.6 steps/s
[Step= 300] | Loss=6.84830 | acc=0.0987 | tpr=0.8095 | fpr=0.9142 | 6822.6 samples/s | 26.7 steps/s
[Step= 350] | Loss=6.84599 | acc=0.0988 | tpr=0.8134 | fpr=0.9142 | 6582.0 samples/s | 25.7 steps/s
[Step= 400] | Loss=6.83864 | acc=0.0992 | tpr=0.8135 | fpr=0.9138 | 6969.3 samples/s | 27.2 steps/s
[Step= 450] | Loss=6.84482 | acc=0.0986 | tpr=0.8155 | fpr=0.9144 | 6602.3 samples/s | 25.8 steps/s
[Step= 500] | Loss=6.84616 | acc=0.0986 | tpr=0.8137 | fpr=0.9143 | 7069.7 samples/s | 27.6 steps/s
[Step= 550] | Loss=6.84575 | acc=0.0990 | tpr=0.8205 | fpr=0.9141 | 12123.0 samples/s | 47.4 steps/s
Avg test loss: 6.84764, Avg test acc: 0.09890, Avg tpr: 0.82052, Avg fpr: 0.91422, total FA: 126938

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11174 | acc=0.9826 | tpr=0.9336 | fpr=0.0165 | 3511.0 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.11573 | acc=0.9829 | tpr=0.9488 | fpr=0.0164 | 6884.2 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.12048 | acc=0.9818 | tpr=0.9467 | fpr=0.0176 | 6817.2 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.12228 | acc=0.9818 | tpr=0.9454 | fpr=0.0176 | 6947.3 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.12066 | acc=0.9820 | tpr=0.9415 | fpr=0.0173 | 6886.4 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.12320 | acc=0.9817 | tpr=0.9404 | fpr=0.0175 | 6954.0 samples/s | 27.2 steps/s
[Step= 350] | Loss=0.12316 | acc=0.9815 | tpr=0.9411 | fpr=0.0178 | 6839.2 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.12510 | acc=0.9811 | tpr=0.9360 | fpr=0.0181 | 6732.8 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.12732 | acc=0.9808 | tpr=0.9348 | fpr=0.0183 | 6762.5 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.12650 | acc=0.9810 | tpr=0.9366 | fpr=0.0182 | 6755.2 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.12586 | acc=0.9811 | tpr=0.9355 | fpr=0.0181 | 11954.2 samples/s | 46.7 steps/s
Avg test loss: 0.12567, Avg test acc: 0.98111, Avg tpr: 0.93502, Avg fpr: 0.01806, total FA: 2507

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13022 | acc=0.9794 | tpr=0.9336 | fpr=0.0198 | 3488.4 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.13364 | acc=0.9793 | tpr=0.9552 | fpr=0.0203 | 6872.7 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.13655 | acc=0.9784 | tpr=0.9524 | fpr=0.0211 | 6914.0 samples/s | 27.0 steps/s
[Step= 200] | Loss=0.13716 | acc=0.9786 | tpr=0.9563 | fpr=0.0210 | 6814.2 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.13567 | acc=0.9786 | tpr=0.9546 | fpr=0.0210 | 6962.9 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.13890 | acc=0.9780 | tpr=0.9527 | fpr=0.0215 | 6757.1 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.13832 | acc=0.9780 | tpr=0.9530 | fpr=0.0216 | 6769.9 samples/s | 26.4 steps/s
[Step= 400] | Loss=0.14015 | acc=0.9780 | tpr=0.9508 | fpr=0.0215 | 6790.4 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.14265 | acc=0.9777 | tpr=0.9484 | fpr=0.0217 | 6759.5 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.14244 | acc=0.9777 | tpr=0.9507 | fpr=0.0218 | 6805.7 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.14153 | acc=0.9778 | tpr=0.9507 | fpr=0.0217 | 12443.8 samples/s | 48.6 steps/s
Avg test loss: 0.14139, Avg test acc: 0.97784, Avg tpr: 0.95008, Avg fpr: 0.02166, total FA: 3007

server round 19/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=38001 Epoch=74.1] | Loss=0.00085 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.193 | L2-Norm(final)=8.158 | 3071.0 samples/s | 48.0 steps/s
[Step=38050 Epoch=74.2] | Loss=0.01936 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.231 | L2-Norm(final)=8.162 | 4307.2 samples/s | 67.3 steps/s
[Step=38100 Epoch=74.3] | Loss=0.01633 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.259 | L2-Norm(final)=8.173 | 4316.7 samples/s | 67.4 steps/s
[Step=38150 Epoch=74.4] | Loss=0.01637 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.280 | L2-Norm(final)=8.184 | 4402.8 samples/s | 68.8 steps/s
[Step=38200 Epoch=74.5] | Loss=0.01612 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.299 | L2-Norm(final)=8.195 | 4316.8 samples/s | 67.5 steps/s
[Step=38250 Epoch=74.6] | Loss=0.01570 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.317 | L2-Norm(final)=8.208 | 4357.0 samples/s | 68.1 steps/s
[Step=38300 Epoch=74.7] | Loss=0.01540 | Reg=0.00178 | acc=0.9531 | L2-Norm=13.334 | L2-Norm(final)=8.221 | 4409.0 samples/s | 68.9 steps/s
[Step=38350 Epoch=74.8] | Loss=0.01501 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=8.233 | 4333.5 samples/s | 67.7 steps/s
[Step=38400 Epoch=74.9] | Loss=0.01472 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.366 | L2-Norm(final)=8.245 | 4451.9 samples/s | 69.6 steps/s
[Step=38450 Epoch=75.0] | Loss=0.01432 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=8.258 | 4307.2 samples/s | 67.3 steps/s
[Step=38500 Epoch=75.1] | Loss=0.01400 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.395 | L2-Norm(final)=8.271 | 5499.0 samples/s | 85.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=38501 Epoch=75.1] | Loss=0.00442 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.540 | L2-Norm(final)=8.397 | 3158.4 samples/s | 49.4 steps/s
[Step=38550 Epoch=75.2] | Loss=0.01738 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.562 | L2-Norm(final)=8.397 | 3844.4 samples/s | 60.1 steps/s
[Step=38600 Epoch=75.3] | Loss=0.01630 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.584 | L2-Norm(final)=8.396 | 3865.2 samples/s | 60.4 steps/s
[Step=38650 Epoch=75.4] | Loss=0.01734 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.601 | L2-Norm(final)=8.395 | 3909.0 samples/s | 61.1 steps/s
[Step=38700 Epoch=75.5] | Loss=0.01772 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.620 | L2-Norm(final)=8.394 | 3901.0 samples/s | 61.0 steps/s
[Step=38750 Epoch=75.6] | Loss=0.01724 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.638 | L2-Norm(final)=8.392 | 3949.1 samples/s | 61.7 steps/s
[Step=38800 Epoch=75.7] | Loss=0.01714 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.656 | L2-Norm(final)=8.391 | 3943.6 samples/s | 61.6 steps/s
[Step=38850 Epoch=75.8] | Loss=0.01639 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.674 | L2-Norm(final)=8.390 | 3916.8 samples/s | 61.2 steps/s
[Step=38900 Epoch=75.9] | Loss=0.01657 | Reg=0.00187 | acc=0.9375 | L2-Norm=13.690 | L2-Norm(final)=8.391 | 3952.8 samples/s | 61.8 steps/s
[Step=38950 Epoch=76.0] | Loss=0.01666 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=8.391 | 3934.0 samples/s | 61.5 steps/s
[Step=39000 Epoch=76.1] | Loss=0.01650 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.721 | L2-Norm(final)=8.391 | 4778.1 samples/s | 74.7 steps/s
[Step=39050 Epoch=76.2] | Loss=0.01641 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.735 | L2-Norm(final)=8.392 | 1496.1 samples/s | 23.4 steps/s
[Step=39100 Epoch=76.3] | Loss=0.01591 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.749 | L2-Norm(final)=8.394 | 3869.3 samples/s | 60.5 steps/s
[Step=39150 Epoch=76.4] | Loss=0.01563 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.763 | L2-Norm(final)=8.396 | 3913.8 samples/s | 61.2 steps/s
[Step=39200 Epoch=76.5] | Loss=0.01539 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.776 | L2-Norm(final)=8.397 | 3911.8 samples/s | 61.1 steps/s
[Step=39250 Epoch=76.6] | Loss=0.01517 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.788 | L2-Norm(final)=8.399 | 3901.4 samples/s | 61.0 steps/s
[Step=39300 Epoch=76.7] | Loss=0.01503 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.800 | L2-Norm(final)=8.401 | 3968.1 samples/s | 62.0 steps/s
[Step=39350 Epoch=76.7] | Loss=0.01482 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.811 | L2-Norm(final)=8.403 | 3918.6 samples/s | 61.2 steps/s
[Step=39400 Epoch=76.8] | Loss=0.01466 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.822 | L2-Norm(final)=8.405 | 3967.5 samples/s | 62.0 steps/s
[Step=39450 Epoch=76.9] | Loss=0.01497 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.832 | L2-Norm(final)=8.407 | 3939.9 samples/s | 61.6 steps/s
[Step=39500 Epoch=77.0] | Loss=0.01499 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.843 | L2-Norm(final)=8.408 | 4166.2 samples/s | 65.1 steps/s
[Step=39550 Epoch=77.1] | Loss=0.01485 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.855 | L2-Norm(final)=8.408 | 1552.8 samples/s | 24.3 steps/s
[Step=39600 Epoch=77.2] | Loss=0.01481 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.867 | L2-Norm(final)=8.409 | 3986.0 samples/s | 62.3 steps/s
[Step=39650 Epoch=77.3] | Loss=0.01477 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.878 | L2-Norm(final)=8.410 | 3958.1 samples/s | 61.8 steps/s
[Step=39700 Epoch=77.4] | Loss=0.01456 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.890 | L2-Norm(final)=8.411 | 3939.2 samples/s | 61.6 steps/s
[Step=39750 Epoch=77.5] | Loss=0.01445 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.901 | L2-Norm(final)=8.413 | 3945.3 samples/s | 61.6 steps/s
[Step=39800 Epoch=77.6] | Loss=0.01432 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.911 | L2-Norm(final)=8.414 | 3986.3 samples/s | 62.3 steps/s
[Step=39850 Epoch=77.7] | Loss=0.01419 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.922 | L2-Norm(final)=8.415 | 3959.0 samples/s | 61.9 steps/s
[Step=39900 Epoch=77.8] | Loss=0.01415 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.932 | L2-Norm(final)=8.416 | 3925.3 samples/s | 61.3 steps/s
[Step=39950 Epoch=77.9] | Loss=0.01405 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.942 | L2-Norm(final)=8.417 | 3908.2 samples/s | 61.1 steps/s
[Step=40000 Epoch=78.0] | Loss=0.01394 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.952 | L2-Norm(final)=8.419 | 3944.4 samples/s | 61.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step40000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=38001 Epoch=74.3] | Loss=0.02402 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.193 | L2-Norm(final)=8.515 | 3477.1 samples/s | 54.3 steps/s
[Step=38050 Epoch=74.4] | Loss=0.01741 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.217 | L2-Norm(final)=8.529 | 4025.8 samples/s | 62.9 steps/s
[Step=38100 Epoch=74.5] | Loss=0.01682 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.239 | L2-Norm(final)=8.544 | 4376.6 samples/s | 68.4 steps/s
[Step=38150 Epoch=74.6] | Loss=0.01566 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.259 | L2-Norm(final)=8.556 | 4416.7 samples/s | 69.0 steps/s
[Step=38200 Epoch=74.7] | Loss=0.01500 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.275 | L2-Norm(final)=8.566 | 4319.5 samples/s | 67.5 steps/s
[Step=38250 Epoch=74.8] | Loss=0.01446 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=8.577 | 4258.5 samples/s | 66.5 steps/s
[Step=38300 Epoch=74.9] | Loss=0.01415 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.306 | L2-Norm(final)=8.588 | 4388.0 samples/s | 68.6 steps/s
[Step=38350 Epoch=75.0] | Loss=0.01433 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.322 | L2-Norm(final)=8.601 | 4385.1 samples/s | 68.5 steps/s
[Step=38400 Epoch=75.1] | Loss=0.01369 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.337 | L2-Norm(final)=8.612 | 4298.0 samples/s | 67.2 steps/s
[Step=38450 Epoch=75.2] | Loss=0.01354 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=8.623 | 4351.4 samples/s | 68.0 steps/s
[Step=38500 Epoch=75.3] | Loss=0.01332 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.366 | L2-Norm(final)=8.635 | 5574.1 samples/s | 87.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=38501 Epoch=75.3] | Loss=0.00610 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.505 | L2-Norm(final)=8.742 | 3266.6 samples/s | 51.0 steps/s
[Step=38550 Epoch=75.4] | Loss=0.00928 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.520 | L2-Norm(final)=8.751 | 3800.6 samples/s | 59.4 steps/s
[Step=38600 Epoch=75.5] | Loss=0.01135 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.539 | L2-Norm(final)=8.758 | 3929.6 samples/s | 61.4 steps/s
[Step=38650 Epoch=75.6] | Loss=0.01293 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.559 | L2-Norm(final)=8.762 | 3915.9 samples/s | 61.2 steps/s
[Step=38700 Epoch=75.7] | Loss=0.01456 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.578 | L2-Norm(final)=8.762 | 3892.6 samples/s | 60.8 steps/s
[Step=38750 Epoch=75.8] | Loss=0.01611 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.598 | L2-Norm(final)=8.758 | 3912.1 samples/s | 61.1 steps/s
[Step=38800 Epoch=75.9] | Loss=0.01582 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.620 | L2-Norm(final)=8.757 | 3980.9 samples/s | 62.2 steps/s
[Step=38850 Epoch=76.0] | Loss=0.01551 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.640 | L2-Norm(final)=8.756 | 3952.4 samples/s | 61.8 steps/s
[Step=38900 Epoch=76.0] | Loss=0.01618 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.659 | L2-Norm(final)=8.755 | 3892.1 samples/s | 60.8 steps/s
[Step=38950 Epoch=76.1] | Loss=0.01612 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.676 | L2-Norm(final)=8.754 | 3982.8 samples/s | 62.2 steps/s
[Step=39000 Epoch=76.2] | Loss=0.01592 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.692 | L2-Norm(final)=8.754 | 4915.1 samples/s | 76.8 steps/s
[Step=39050 Epoch=76.3] | Loss=0.01591 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.708 | L2-Norm(final)=8.754 | 1501.4 samples/s | 23.5 steps/s
[Step=39100 Epoch=76.4] | Loss=0.01593 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.723 | L2-Norm(final)=8.754 | 3906.2 samples/s | 61.0 steps/s
[Step=39150 Epoch=76.5] | Loss=0.01569 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.738 | L2-Norm(final)=8.754 | 3939.4 samples/s | 61.6 steps/s
[Step=39200 Epoch=76.6] | Loss=0.01556 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.752 | L2-Norm(final)=8.755 | 3884.3 samples/s | 60.7 steps/s
[Step=39250 Epoch=76.7] | Loss=0.01541 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.766 | L2-Norm(final)=8.755 | 3941.3 samples/s | 61.6 steps/s
[Step=39300 Epoch=76.8] | Loss=0.01563 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.780 | L2-Norm(final)=8.755 | 3939.8 samples/s | 61.6 steps/s
[Step=39350 Epoch=76.9] | Loss=0.01548 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.793 | L2-Norm(final)=8.754 | 3943.7 samples/s | 61.6 steps/s
[Step=39400 Epoch=77.0] | Loss=0.01552 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.807 | L2-Norm(final)=8.754 | 3980.0 samples/s | 62.2 steps/s
[Step=39450 Epoch=77.1] | Loss=0.01549 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.819 | L2-Norm(final)=8.754 | 3946.2 samples/s | 61.7 steps/s
[Step=39500 Epoch=77.2] | Loss=0.01531 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.832 | L2-Norm(final)=8.753 | 4254.6 samples/s | 66.5 steps/s
[Step=39550 Epoch=77.3] | Loss=0.01506 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.843 | L2-Norm(final)=8.753 | 1595.3 samples/s | 24.9 steps/s
[Step=39600 Epoch=77.4] | Loss=0.01480 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.854 | L2-Norm(final)=8.753 | 3935.0 samples/s | 61.5 steps/s
[Step=39650 Epoch=77.5] | Loss=0.01463 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.865 | L2-Norm(final)=8.753 | 3900.2 samples/s | 60.9 steps/s
[Step=39700 Epoch=77.6] | Loss=0.01449 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.875 | L2-Norm(final)=8.753 | 3909.4 samples/s | 61.1 steps/s
[Step=39750 Epoch=77.7] | Loss=0.01429 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.885 | L2-Norm(final)=8.754 | 3979.3 samples/s | 62.2 steps/s
[Step=39800 Epoch=77.8] | Loss=0.01413 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.895 | L2-Norm(final)=8.754 | 3964.9 samples/s | 62.0 steps/s
[Step=39850 Epoch=77.9] | Loss=0.01411 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.904 | L2-Norm(final)=8.754 | 3903.7 samples/s | 61.0 steps/s
[Step=39900 Epoch=78.0] | Loss=0.01388 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.913 | L2-Norm(final)=8.755 | 3942.0 samples/s | 61.6 steps/s
[Step=39950 Epoch=78.1] | Loss=0.01384 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.922 | L2-Norm(final)=8.755 | 3962.1 samples/s | 61.9 steps/s
[Step=40000 Epoch=78.2] | Loss=0.01381 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.931 | L2-Norm(final)=8.755 | 3986.9 samples/s | 62.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step40000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=38001 Epoch=145.6] | Loss=0.00946 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.193 | L2-Norm(final)=7.090 | 3328.7 samples/s | 52.0 steps/s
[Step=38050 Epoch=145.8] | Loss=0.00064 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.212 | L2-Norm(final)=7.095 | 3749.5 samples/s | 58.6 steps/s
[Step=38100 Epoch=146.0] | Loss=0.00042 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.218 | L2-Norm(final)=7.103 | 4046.7 samples/s | 63.2 steps/s
[Step=38150 Epoch=146.2] | Loss=0.00033 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.218 | L2-Norm(final)=7.110 | 4080.0 samples/s | 63.7 steps/s
[Step=38200 Epoch=146.4] | Loss=0.00031 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.217 | L2-Norm(final)=7.117 | 4073.9 samples/s | 63.7 steps/s
[Step=38250 Epoch=146.6] | Loss=0.00031 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.219 | L2-Norm(final)=7.124 | 5407.5 samples/s | 84.5 steps/s
[Step=38300 Epoch=146.8] | Loss=0.00027 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.220 | L2-Norm(final)=7.129 | 1529.6 samples/s | 23.9 steps/s
[Step=38350 Epoch=146.9] | Loss=0.00024 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.218 | L2-Norm(final)=7.135 | 4220.1 samples/s | 65.9 steps/s
[Step=38400 Epoch=147.1] | Loss=0.00022 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.214 | L2-Norm(final)=7.140 | 4042.6 samples/s | 63.2 steps/s
[Step=38450 Epoch=147.3] | Loss=0.00020 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.210 | L2-Norm(final)=7.144 | 4192.9 samples/s | 65.5 steps/s
[Step=38500 Epoch=147.5] | Loss=0.00018 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.204 | L2-Norm(final)=7.149 | 4539.0 samples/s | 70.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=38501 Epoch=147.5] | Loss=0.00002 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.149 | L2-Norm(final)=7.193 | 3203.0 samples/s | 50.0 steps/s
[Step=38550 Epoch=147.7] | Loss=0.00003 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.139 | L2-Norm(final)=7.197 | 3538.4 samples/s | 55.3 steps/s
[Step=38600 Epoch=147.9] | Loss=0.00003 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.126 | L2-Norm(final)=7.200 | 3739.5 samples/s | 58.4 steps/s
[Step=38650 Epoch=148.1] | Loss=0.00003 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.114 | L2-Norm(final)=7.203 | 3680.3 samples/s | 57.5 steps/s
[Step=38700 Epoch=148.3] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.101 | L2-Norm(final)=7.206 | 3786.7 samples/s | 59.2 steps/s
[Step=38750 Epoch=148.5] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.088 | L2-Norm(final)=7.208 | 4616.0 samples/s | 72.1 steps/s
[Step=38800 Epoch=148.7] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.076 | L2-Norm(final)=7.211 | 1439.1 samples/s | 22.5 steps/s
[Step=38850 Epoch=148.9] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.063 | L2-Norm(final)=7.213 | 3693.8 samples/s | 57.7 steps/s
[Step=38900 Epoch=149.1] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.050 | L2-Norm(final)=7.215 | 3737.8 samples/s | 58.4 steps/s
[Step=38950 Epoch=149.2] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.037 | L2-Norm(final)=7.217 | 3731.3 samples/s | 58.3 steps/s
[Step=39000 Epoch=149.4] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.024 | L2-Norm(final)=7.218 | 4130.9 samples/s | 64.5 steps/s
[Step=39050 Epoch=149.6] | Loss=0.00002 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.011 | L2-Norm(final)=7.220 | 1514.7 samples/s | 23.7 steps/s
[Step=39100 Epoch=149.8] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.998 | L2-Norm(final)=7.221 | 3750.5 samples/s | 58.6 steps/s
[Step=39150 Epoch=150.0] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.985 | L2-Norm(final)=7.223 | 3765.2 samples/s | 58.8 steps/s
[Step=39200 Epoch=150.2] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.972 | L2-Norm(final)=7.224 | 3671.1 samples/s | 57.4 steps/s
[Step=39250 Epoch=150.4] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.958 | L2-Norm(final)=7.225 | 3730.0 samples/s | 58.3 steps/s
[Step=39300 Epoch=150.6] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.945 | L2-Norm(final)=7.227 | 1644.8 samples/s | 25.7 steps/s
[Step=39350 Epoch=150.8] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.932 | L2-Norm(final)=7.228 | 3809.8 samples/s | 59.5 steps/s
[Step=39400 Epoch=151.0] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.918 | L2-Norm(final)=7.229 | 3742.3 samples/s | 58.5 steps/s
[Step=39450 Epoch=151.2] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=7.231 | 3793.3 samples/s | 59.3 steps/s
[Step=39500 Epoch=151.4] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.891 | L2-Norm(final)=7.232 | 3694.9 samples/s | 57.7 steps/s
[Step=39550 Epoch=151.5] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.878 | L2-Norm(final)=7.233 | 1576.1 samples/s | 24.6 steps/s
[Step=39600 Epoch=151.7] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.864 | L2-Norm(final)=7.234 | 3721.5 samples/s | 58.1 steps/s
[Step=39650 Epoch=151.9] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.851 | L2-Norm(final)=7.235 | 3697.1 samples/s | 57.8 steps/s
[Step=39700 Epoch=152.1] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.837 | L2-Norm(final)=7.237 | 3671.4 samples/s | 57.4 steps/s
[Step=39750 Epoch=152.3] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.823 | L2-Norm(final)=7.238 | 3728.9 samples/s | 58.3 steps/s
[Step=39800 Epoch=152.5] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.809 | L2-Norm(final)=7.239 | 4921.9 samples/s | 76.9 steps/s
[Step=39850 Epoch=152.7] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.795 | L2-Norm(final)=7.240 | 1439.9 samples/s | 22.5 steps/s
[Step=39900 Epoch=152.9] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.781 | L2-Norm(final)=7.241 | 3675.3 samples/s | 57.4 steps/s
[Step=39950 Epoch=153.1] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.767 | L2-Norm(final)=7.242 | 3708.6 samples/s | 57.9 steps/s
[Step=40000 Epoch=153.3] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.753 | L2-Norm(final)=7.244 | 3720.5 samples/s | 58.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step40000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=38001 Epoch=146.3] | Loss=0.00046 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.193 | L2-Norm(final)=7.833 | 3176.8 samples/s | 49.6 steps/s
[Step=38050 Epoch=146.5] | Loss=0.00243 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.267 | L2-Norm(final)=7.840 | 4101.7 samples/s | 64.1 steps/s
[Step=38100 Epoch=146.7] | Loss=0.00145 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.335 | L2-Norm(final)=7.843 | 4152.2 samples/s | 64.9 steps/s
[Step=38150 Epoch=146.9] | Loss=0.00122 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=7.850 | 4100.1 samples/s | 64.1 steps/s
[Step=38200 Epoch=147.0] | Loss=0.00101 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=7.857 | 4087.8 samples/s | 63.9 steps/s
[Step=38250 Epoch=147.2] | Loss=0.00090 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.392 | L2-Norm(final)=7.864 | 5569.2 samples/s | 87.0 steps/s
[Step=38300 Epoch=147.4] | Loss=0.00077 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=7.871 | 1562.3 samples/s | 24.4 steps/s
[Step=38350 Epoch=147.6] | Loss=0.00069 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.407 | L2-Norm(final)=7.877 | 4131.9 samples/s | 64.6 steps/s
[Step=38400 Epoch=147.8] | Loss=0.00062 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.410 | L2-Norm(final)=7.882 | 4172.8 samples/s | 65.2 steps/s
[Step=38450 Epoch=148.0] | Loss=0.00056 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.412 | L2-Norm(final)=7.887 | 4131.5 samples/s | 64.6 steps/s
[Step=38500 Epoch=148.2] | Loss=0.00051 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.411 | L2-Norm(final)=7.892 | 4829.2 samples/s | 75.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=38501 Epoch=148.2] | Loss=0.00001 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.393 | L2-Norm(final)=7.938 | 3245.3 samples/s | 50.7 steps/s
[Step=38550 Epoch=148.4] | Loss=0.00009 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.388 | L2-Norm(final)=7.942 | 3527.3 samples/s | 55.1 steps/s
[Step=38600 Epoch=148.6] | Loss=0.00006 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.371 | L2-Norm(final)=7.945 | 3708.3 samples/s | 57.9 steps/s
[Step=38650 Epoch=148.8] | Loss=0.00492 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.390 | L2-Norm(final)=7.939 | 3763.6 samples/s | 58.8 steps/s
[Step=38700 Epoch=149.0] | Loss=0.00661 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.463 | L2-Norm(final)=7.905 | 3707.8 samples/s | 57.9 steps/s
[Step=38750 Epoch=149.2] | Loss=0.00603 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.526 | L2-Norm(final)=7.881 | 4874.7 samples/s | 76.2 steps/s
[Step=38800 Epoch=149.4] | Loss=0.00509 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.570 | L2-Norm(final)=7.865 | 1468.8 samples/s | 22.9 steps/s
[Step=38850 Epoch=149.5] | Loss=0.00441 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.600 | L2-Norm(final)=7.855 | 3705.1 samples/s | 57.9 steps/s
[Step=38900 Epoch=149.7] | Loss=0.00387 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.621 | L2-Norm(final)=7.848 | 3719.2 samples/s | 58.1 steps/s
[Step=38950 Epoch=149.9] | Loss=0.00361 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.636 | L2-Norm(final)=7.844 | 3667.3 samples/s | 57.3 steps/s
[Step=39000 Epoch=150.1] | Loss=0.00333 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.649 | L2-Norm(final)=7.840 | 4247.0 samples/s | 66.4 steps/s
[Step=39050 Epoch=150.3] | Loss=0.00303 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.658 | L2-Norm(final)=7.838 | 1511.2 samples/s | 23.6 steps/s
[Step=39100 Epoch=150.5] | Loss=0.00278 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.665 | L2-Norm(final)=7.836 | 3771.1 samples/s | 58.9 steps/s
[Step=39150 Epoch=150.7] | Loss=0.00257 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.669 | L2-Norm(final)=7.835 | 3776.6 samples/s | 59.0 steps/s
[Step=39200 Epoch=150.9] | Loss=0.00239 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.672 | L2-Norm(final)=7.834 | 3738.7 samples/s | 58.4 steps/s
[Step=39250 Epoch=151.1] | Loss=0.00223 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.673 | L2-Norm(final)=7.834 | 3749.4 samples/s | 58.6 steps/s
[Step=39300 Epoch=151.3] | Loss=0.00210 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.673 | L2-Norm(final)=7.834 | 1573.2 samples/s | 24.6 steps/s
[Step=39350 Epoch=151.5] | Loss=0.00197 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.672 | L2-Norm(final)=7.834 | 3689.7 samples/s | 57.7 steps/s
[Step=39400 Epoch=151.7] | Loss=0.00187 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.670 | L2-Norm(final)=7.834 | 3666.7 samples/s | 57.3 steps/s
[Step=39450 Epoch=151.9] | Loss=0.00177 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.667 | L2-Norm(final)=7.834 | 3701.7 samples/s | 57.8 steps/s
[Step=39500 Epoch=152.1] | Loss=0.00168 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.664 | L2-Norm(final)=7.834 | 3761.7 samples/s | 58.8 steps/s
[Step=39550 Epoch=152.2] | Loss=0.00160 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.660 | L2-Norm(final)=7.835 | 1559.4 samples/s | 24.4 steps/s
[Step=39600 Epoch=152.4] | Loss=0.00153 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.656 | L2-Norm(final)=7.836 | 3700.7 samples/s | 57.8 steps/s
[Step=39650 Epoch=152.6] | Loss=0.00146 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.651 | L2-Norm(final)=7.836 | 3723.3 samples/s | 58.2 steps/s
[Step=39700 Epoch=152.8] | Loss=0.00140 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.646 | L2-Norm(final)=7.837 | 3727.2 samples/s | 58.2 steps/s
[Step=39750 Epoch=153.0] | Loss=0.00135 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.641 | L2-Norm(final)=7.838 | 3701.3 samples/s | 57.8 steps/s
[Step=39800 Epoch=153.2] | Loss=0.00130 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.635 | L2-Norm(final)=7.839 | 5514.3 samples/s | 86.2 steps/s
[Step=39850 Epoch=153.4] | Loss=0.00125 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.629 | L2-Norm(final)=7.840 | 1395.6 samples/s | 21.8 steps/s
[Step=39900 Epoch=153.6] | Loss=0.00120 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.623 | L2-Norm(final)=7.841 | 3709.3 samples/s | 58.0 steps/s
[Step=39950 Epoch=153.8] | Loss=0.00116 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.616 | L2-Norm(final)=7.842 | 3726.4 samples/s | 58.2 steps/s
[Step=40000 Epoch=154.0] | Loss=0.00112 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.609 | L2-Norm(final)=7.843 | 3782.4 samples/s | 59.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07590 | acc=0.9678 | tpr=0.9751 | fpr=0.0481 | 3527.5 samples/s | 13.8 steps/s
Avg test loss: 0.08086, Avg test acc: 0.96510, Avg tpr: 0.97220, Avg fpr: 0.05051, total FA: 394

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06064 | acc=0.9701 | tpr=0.9781 | fpr=0.0473 | 3558.7 samples/s | 13.9 steps/s
Avg test loss: 0.06932, Avg test acc: 0.96722, Avg tpr: 0.97581, Avg fpr: 0.05166, total FA: 403

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.33029 | acc=0.3137 | tpr=0.0181 | fpr=0.0444 | 3514.3 samples/s | 13.7 steps/s
Avg test loss: 5.33850, Avg test acc: 0.31172, Avg tpr: 0.01853, Avg fpr: 0.04346, total FA: 339

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.70949 | acc=0.3122 | tpr=0.0159 | fpr=0.0444 | 3508.5 samples/s | 13.7 steps/s
Avg test loss: 4.71141, Avg test acc: 0.31008, Avg tpr: 0.01679, Avg fpr: 0.04487, total FA: 350

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.70718 | acc=0.0965 | tpr=0.8407 | fpr=0.9169 | 3492.1 samples/s | 13.6 steps/s
[Step= 100] | Loss=6.69557 | acc=0.0971 | tpr=0.8401 | fpr=0.9168 | 7084.7 samples/s | 27.7 steps/s
[Step= 150] | Loss=6.71654 | acc=0.0962 | tpr=0.8530 | fpr=0.9177 | 6717.4 samples/s | 26.2 steps/s
[Step= 200] | Loss=6.69975 | acc=0.0964 | tpr=0.8361 | fpr=0.9171 | 6666.8 samples/s | 26.0 steps/s
[Step= 250] | Loss=6.69755 | acc=0.0961 | tpr=0.8288 | fpr=0.9172 | 6807.4 samples/s | 26.6 steps/s
[Step= 300] | Loss=6.69797 | acc=0.0960 | tpr=0.8327 | fpr=0.9175 | 6898.7 samples/s | 26.9 steps/s
[Step= 350] | Loss=6.69560 | acc=0.0959 | tpr=0.8353 | fpr=0.9175 | 6953.7 samples/s | 27.2 steps/s
[Step= 400] | Loss=6.69072 | acc=0.0957 | tpr=0.8310 | fpr=0.9177 | 6700.4 samples/s | 26.2 steps/s
[Step= 450] | Loss=6.69687 | acc=0.0955 | tpr=0.8335 | fpr=0.9178 | 6791.3 samples/s | 26.5 steps/s
[Step= 500] | Loss=6.70257 | acc=0.0954 | tpr=0.8322 | fpr=0.9179 | 6776.2 samples/s | 26.5 steps/s
[Step= 550] | Loss=6.69996 | acc=0.0956 | tpr=0.8333 | fpr=0.9178 | 12164.4 samples/s | 47.5 steps/s
Avg test loss: 6.70194, Avg test acc: 0.09551, Avg tpr: 0.83281, Avg fpr: 0.91789, total FA: 127447

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.99510 | acc=0.1087 | tpr=0.8274 | fpr=0.9042 | 3549.8 samples/s | 13.9 steps/s
[Step= 100] | Loss=6.95747 | acc=0.1092 | tpr=0.8358 | fpr=0.9044 | 6516.4 samples/s | 25.5 steps/s
[Step= 150] | Loss=6.97785 | acc=0.1094 | tpr=0.8444 | fpr=0.9041 | 7017.5 samples/s | 27.4 steps/s
[Step= 200] | Loss=6.95917 | acc=0.1088 | tpr=0.8284 | fpr=0.9042 | 6767.8 samples/s | 26.4 steps/s
[Step= 250] | Loss=6.95776 | acc=0.1086 | tpr=0.8218 | fpr=0.9044 | 6741.1 samples/s | 26.3 steps/s
[Step= 300] | Loss=6.95978 | acc=0.1087 | tpr=0.8189 | fpr=0.9042 | 6894.4 samples/s | 26.9 steps/s
[Step= 350] | Loss=6.95895 | acc=0.1083 | tpr=0.8215 | fpr=0.9046 | 6931.5 samples/s | 27.1 steps/s
[Step= 400] | Loss=6.95570 | acc=0.1083 | tpr=0.8173 | fpr=0.9046 | 6706.2 samples/s | 26.2 steps/s
[Step= 450] | Loss=6.96344 | acc=0.1081 | tpr=0.8174 | fpr=0.9048 | 6557.3 samples/s | 25.6 steps/s
[Step= 500] | Loss=6.96664 | acc=0.1079 | tpr=0.8185 | fpr=0.9050 | 6948.7 samples/s | 27.1 steps/s
[Step= 550] | Loss=6.96836 | acc=0.1080 | tpr=0.8237 | fpr=0.9050 | 12547.6 samples/s | 49.0 steps/s
Avg test loss: 6.97034, Avg test acc: 0.10787, Avg tpr: 0.82330, Avg fpr: 0.90513, total FA: 125676

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11405 | acc=0.9811 | tpr=0.9248 | fpr=0.0179 | 3497.6 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.11577 | acc=0.9811 | tpr=0.9424 | fpr=0.0182 | 6814.9 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.11847 | acc=0.9804 | tpr=0.9424 | fpr=0.0189 | 7128.6 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.11946 | acc=0.9804 | tpr=0.9399 | fpr=0.0188 | 6666.0 samples/s | 26.0 steps/s
[Step= 250] | Loss=0.11769 | acc=0.9807 | tpr=0.9380 | fpr=0.0186 | 7034.9 samples/s | 27.5 steps/s
[Step= 300] | Loss=0.11992 | acc=0.9804 | tpr=0.9396 | fpr=0.0189 | 6713.4 samples/s | 26.2 steps/s
[Step= 350] | Loss=0.11977 | acc=0.9803 | tpr=0.9411 | fpr=0.0190 | 6904.3 samples/s | 27.0 steps/s
[Step= 400] | Loss=0.12160 | acc=0.9800 | tpr=0.9360 | fpr=0.0192 | 6861.5 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.12384 | acc=0.9798 | tpr=0.9362 | fpr=0.0194 | 6719.5 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.12348 | acc=0.9799 | tpr=0.9396 | fpr=0.0194 | 6694.4 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.12291 | acc=0.9801 | tpr=0.9387 | fpr=0.0192 | 12621.2 samples/s | 49.3 steps/s
Avg test loss: 0.12280, Avg test acc: 0.98008, Avg tpr: 0.93819, Avg fpr: 0.01916, total FA: 2660

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14352 | acc=0.9802 | tpr=0.9292 | fpr=0.0188 | 3596.1 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.15299 | acc=0.9792 | tpr=0.9446 | fpr=0.0201 | 6630.1 samples/s | 25.9 steps/s
[Step= 150] | Loss=0.15908 | acc=0.9783 | tpr=0.9510 | fpr=0.0212 | 6729.1 samples/s | 26.3 steps/s
[Step= 200] | Loss=0.16100 | acc=0.9784 | tpr=0.9508 | fpr=0.0211 | 6809.2 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.15974 | acc=0.9785 | tpr=0.9520 | fpr=0.0210 | 6816.8 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.16368 | acc=0.9779 | tpr=0.9513 | fpr=0.0216 | 6859.7 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.16355 | acc=0.9777 | tpr=0.9512 | fpr=0.0218 | 6773.3 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.16525 | acc=0.9775 | tpr=0.9491 | fpr=0.0220 | 6779.3 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.16866 | acc=0.9770 | tpr=0.9474 | fpr=0.0225 | 6902.8 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.16859 | acc=0.9770 | tpr=0.9485 | fpr=0.0225 | 6700.7 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.16745 | acc=0.9771 | tpr=0.9483 | fpr=0.0223 | 12574.7 samples/s | 49.1 steps/s
Avg test loss: 0.16731, Avg test acc: 0.97715, Avg tpr: 0.94810, Avg fpr: 0.02232, total FA: 3099

server round 20/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=40001 Epoch=78.0] | Loss=0.01017 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.183 | L2-Norm(final)=8.455 | 3123.6 samples/s | 48.8 steps/s
[Step=40050 Epoch=78.1] | Loss=0.01461 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.193 | L2-Norm(final)=8.458 | 4118.4 samples/s | 64.3 steps/s
[Step=40100 Epoch=78.2] | Loss=0.01247 | Reg=0.00174 | acc=0.9688 | L2-Norm=13.200 | L2-Norm(final)=8.460 | 4303.9 samples/s | 67.2 steps/s
[Step=40150 Epoch=78.3] | Loss=0.01230 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.206 | L2-Norm(final)=8.466 | 4359.2 samples/s | 68.1 steps/s
[Step=40200 Epoch=78.4] | Loss=0.01276 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.211 | L2-Norm(final)=8.472 | 4334.7 samples/s | 67.7 steps/s
[Step=40250 Epoch=78.5] | Loss=0.01241 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.216 | L2-Norm(final)=8.478 | 4482.8 samples/s | 70.0 steps/s
[Step=40300 Epoch=78.6] | Loss=0.01228 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.222 | L2-Norm(final)=8.485 | 4382.6 samples/s | 68.5 steps/s
[Step=40350 Epoch=78.7] | Loss=0.01224 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.227 | L2-Norm(final)=8.492 | 4395.7 samples/s | 68.7 steps/s
[Step=40400 Epoch=78.8] | Loss=0.01217 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.233 | L2-Norm(final)=8.498 | 4279.5 samples/s | 66.9 steps/s
[Step=40450 Epoch=78.9] | Loss=0.01196 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.238 | L2-Norm(final)=8.505 | 4324.9 samples/s | 67.6 steps/s
[Step=40500 Epoch=79.0] | Loss=0.01197 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.244 | L2-Norm(final)=8.511 | 5470.6 samples/s | 85.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=40501 Epoch=79.0] | Loss=0.00523 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.298 | L2-Norm(final)=8.575 | 3037.5 samples/s | 47.5 steps/s
[Step=40550 Epoch=79.1] | Loss=0.00889 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.306 | L2-Norm(final)=8.582 | 3702.9 samples/s | 57.9 steps/s
[Step=40600 Epoch=79.2] | Loss=0.00947 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.314 | L2-Norm(final)=8.590 | 3909.8 samples/s | 61.1 steps/s
[Step=40650 Epoch=79.3] | Loss=0.00949 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.320 | L2-Norm(final)=8.595 | 3877.8 samples/s | 60.6 steps/s
[Step=40700 Epoch=79.4] | Loss=0.01017 | Reg=0.00178 | acc=0.9531 | L2-Norm=13.326 | L2-Norm(final)=8.598 | 3930.5 samples/s | 61.4 steps/s
[Step=40750 Epoch=79.5] | Loss=0.01016 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.331 | L2-Norm(final)=8.600 | 3928.4 samples/s | 61.4 steps/s
[Step=40800 Epoch=79.6] | Loss=0.00988 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.336 | L2-Norm(final)=8.603 | 3971.6 samples/s | 62.1 steps/s
[Step=40850 Epoch=79.7] | Loss=0.00994 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=8.605 | 3938.9 samples/s | 61.5 steps/s
[Step=40900 Epoch=79.8] | Loss=0.01051 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=8.606 | 3917.2 samples/s | 61.2 steps/s
[Step=40950 Epoch=79.9] | Loss=0.01066 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.349 | L2-Norm(final)=8.608 | 3924.0 samples/s | 61.3 steps/s
[Step=41000 Epoch=80.0] | Loss=0.01064 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=8.609 | 4825.8 samples/s | 75.4 steps/s
[Step=41050 Epoch=80.1] | Loss=0.01024 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=8.611 | 1407.1 samples/s | 22.0 steps/s
[Step=41100 Epoch=80.2] | Loss=0.00993 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=8.613 | 3947.3 samples/s | 61.7 steps/s
[Step=41150 Epoch=80.3] | Loss=0.00968 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.364 | L2-Norm(final)=8.615 | 3894.6 samples/s | 60.9 steps/s
[Step=41200 Epoch=80.4] | Loss=0.00939 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.367 | L2-Norm(final)=8.617 | 3879.9 samples/s | 60.6 steps/s
[Step=41250 Epoch=80.5] | Loss=0.00925 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.370 | L2-Norm(final)=8.620 | 3917.6 samples/s | 61.2 steps/s
[Step=41300 Epoch=80.6] | Loss=0.00914 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.373 | L2-Norm(final)=8.622 | 3905.0 samples/s | 61.0 steps/s
[Step=41350 Epoch=80.6] | Loss=0.00914 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.376 | L2-Norm(final)=8.624 | 3906.7 samples/s | 61.0 steps/s
[Step=41400 Epoch=80.7] | Loss=0.00912 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.379 | L2-Norm(final)=8.626 | 3987.1 samples/s | 62.3 steps/s
[Step=41450 Epoch=80.8] | Loss=0.00917 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.381 | L2-Norm(final)=8.627 | 3942.0 samples/s | 61.6 steps/s
[Step=41500 Epoch=80.9] | Loss=0.00913 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.384 | L2-Norm(final)=8.629 | 4198.6 samples/s | 65.6 steps/s
[Step=41550 Epoch=81.0] | Loss=0.00910 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=8.631 | 1497.5 samples/s | 23.4 steps/s
[Step=41600 Epoch=81.1] | Loss=0.00896 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.390 | L2-Norm(final)=8.633 | 3917.5 samples/s | 61.2 steps/s
[Step=41650 Epoch=81.2] | Loss=0.00881 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.392 | L2-Norm(final)=8.634 | 3911.4 samples/s | 61.1 steps/s
[Step=41700 Epoch=81.3] | Loss=0.00864 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.395 | L2-Norm(final)=8.636 | 4019.1 samples/s | 62.8 steps/s
[Step=41750 Epoch=81.4] | Loss=0.00866 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.397 | L2-Norm(final)=8.638 | 3952.3 samples/s | 61.8 steps/s
[Step=41800 Epoch=81.5] | Loss=0.00862 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.400 | L2-Norm(final)=8.640 | 3914.4 samples/s | 61.2 steps/s
[Step=41850 Epoch=81.6] | Loss=0.00859 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=8.642 | 3965.4 samples/s | 62.0 steps/s
[Step=41900 Epoch=81.7] | Loss=0.00860 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.404 | L2-Norm(final)=8.643 | 3935.4 samples/s | 61.5 steps/s
[Step=41950 Epoch=81.8] | Loss=0.00857 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.407 | L2-Norm(final)=8.644 | 3946.2 samples/s | 61.7 steps/s
[Step=42000 Epoch=81.9] | Loss=0.00853 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.409 | L2-Norm(final)=8.646 | 3916.9 samples/s | 61.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step42000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=40001 Epoch=78.2] | Loss=0.00916 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.183 | L2-Norm(final)=8.758 | 3326.4 samples/s | 52.0 steps/s
[Step=40050 Epoch=78.3] | Loss=0.01447 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.193 | L2-Norm(final)=8.766 | 4034.8 samples/s | 63.0 steps/s
[Step=40100 Epoch=78.4] | Loss=0.01268 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.201 | L2-Norm(final)=8.771 | 4349.0 samples/s | 68.0 steps/s
[Step=40150 Epoch=78.5] | Loss=0.01309 | Reg=0.00174 | acc=0.9688 | L2-Norm=13.207 | L2-Norm(final)=8.776 | 4355.2 samples/s | 68.0 steps/s
[Step=40200 Epoch=78.6] | Loss=0.01271 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.213 | L2-Norm(final)=8.782 | 4424.2 samples/s | 69.1 steps/s
[Step=40250 Epoch=78.7] | Loss=0.01188 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.218 | L2-Norm(final)=8.788 | 4383.7 samples/s | 68.5 steps/s
[Step=40300 Epoch=78.8] | Loss=0.01176 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.223 | L2-Norm(final)=8.795 | 4396.1 samples/s | 68.7 steps/s
[Step=40350 Epoch=78.9] | Loss=0.01181 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.228 | L2-Norm(final)=8.802 | 4315.9 samples/s | 67.4 steps/s
[Step=40400 Epoch=79.0] | Loss=0.01169 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.232 | L2-Norm(final)=8.808 | 4392.7 samples/s | 68.6 steps/s
[Step=40450 Epoch=79.1] | Loss=0.01149 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.237 | L2-Norm(final)=8.815 | 4486.2 samples/s | 70.1 steps/s
[Step=40500 Epoch=79.2] | Loss=0.01151 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.241 | L2-Norm(final)=8.821 | 5516.5 samples/s | 86.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=40501 Epoch=79.2] | Loss=0.00604 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.285 | L2-Norm(final)=8.883 | 3317.0 samples/s | 51.8 steps/s
[Step=40550 Epoch=79.3] | Loss=0.00985 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.290 | L2-Norm(final)=8.889 | 3760.3 samples/s | 58.8 steps/s
[Step=40600 Epoch=79.4] | Loss=0.01113 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.296 | L2-Norm(final)=8.892 | 3919.7 samples/s | 61.2 steps/s
[Step=40650 Epoch=79.5] | Loss=0.01081 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.302 | L2-Norm(final)=8.894 | 3923.4 samples/s | 61.3 steps/s
[Step=40700 Epoch=79.6] | Loss=0.01050 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.307 | L2-Norm(final)=8.898 | 3957.1 samples/s | 61.8 steps/s
[Step=40750 Epoch=79.7] | Loss=0.00994 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.312 | L2-Norm(final)=8.901 | 3910.2 samples/s | 61.1 steps/s
[Step=40800 Epoch=79.8] | Loss=0.01015 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.317 | L2-Norm(final)=8.904 | 3983.0 samples/s | 62.2 steps/s
[Step=40850 Epoch=79.9] | Loss=0.01104 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.321 | L2-Norm(final)=8.906 | 3920.5 samples/s | 61.3 steps/s
[Step=40900 Epoch=80.0] | Loss=0.01084 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.326 | L2-Norm(final)=8.906 | 3941.2 samples/s | 61.6 steps/s
[Step=40950 Epoch=80.1] | Loss=0.01087 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.330 | L2-Norm(final)=8.907 | 3923.5 samples/s | 61.3 steps/s
[Step=41000 Epoch=80.2] | Loss=0.01079 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.334 | L2-Norm(final)=8.909 | 4891.7 samples/s | 76.4 steps/s
[Step=41050 Epoch=80.3] | Loss=0.01044 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.339 | L2-Norm(final)=8.910 | 1516.2 samples/s | 23.7 steps/s
[Step=41100 Epoch=80.3] | Loss=0.01010 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=8.912 | 3891.1 samples/s | 60.8 steps/s
[Step=41150 Epoch=80.4] | Loss=0.00998 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=8.914 | 3895.6 samples/s | 60.9 steps/s
[Step=41200 Epoch=80.5] | Loss=0.00988 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.350 | L2-Norm(final)=8.916 | 3956.1 samples/s | 61.8 steps/s
[Step=41250 Epoch=80.6] | Loss=0.00979 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.353 | L2-Norm(final)=8.918 | 3919.0 samples/s | 61.2 steps/s
[Step=41300 Epoch=80.7] | Loss=0.00960 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=8.919 | 3981.0 samples/s | 62.2 steps/s
[Step=41350 Epoch=80.8] | Loss=0.00939 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.359 | L2-Norm(final)=8.921 | 3971.6 samples/s | 62.1 steps/s
[Step=41400 Epoch=80.9] | Loss=0.00937 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=8.923 | 3929.9 samples/s | 61.4 steps/s
[Step=41450 Epoch=81.0] | Loss=0.00929 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.364 | L2-Norm(final)=8.925 | 3960.9 samples/s | 61.9 steps/s
[Step=41500 Epoch=81.1] | Loss=0.00923 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.367 | L2-Norm(final)=8.926 | 4288.8 samples/s | 67.0 steps/s
[Step=41550 Epoch=81.2] | Loss=0.00906 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=8.928 | 1586.6 samples/s | 24.8 steps/s
[Step=41600 Epoch=81.3] | Loss=0.00891 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.372 | L2-Norm(final)=8.929 | 3907.0 samples/s | 61.0 steps/s
[Step=41650 Epoch=81.4] | Loss=0.00872 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.375 | L2-Norm(final)=8.931 | 3932.8 samples/s | 61.5 steps/s
[Step=41700 Epoch=81.5] | Loss=0.00856 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.377 | L2-Norm(final)=8.933 | 3949.8 samples/s | 61.7 steps/s
[Step=41750 Epoch=81.6] | Loss=0.00847 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=8.935 | 3934.7 samples/s | 61.5 steps/s
[Step=41800 Epoch=81.7] | Loss=0.00845 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.382 | L2-Norm(final)=8.936 | 3861.5 samples/s | 60.3 steps/s
[Step=41850 Epoch=81.8] | Loss=0.00840 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.384 | L2-Norm(final)=8.938 | 3959.8 samples/s | 61.9 steps/s
[Step=41900 Epoch=81.9] | Loss=0.00843 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.386 | L2-Norm(final)=8.939 | 3963.7 samples/s | 61.9 steps/s
[Step=41950 Epoch=82.0] | Loss=0.00843 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.389 | L2-Norm(final)=8.941 | 3904.5 samples/s | 61.0 steps/s
[Step=42000 Epoch=82.1] | Loss=0.00842 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.391 | L2-Norm(final)=8.943 | 3932.7 samples/s | 61.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step42000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=40001 Epoch=153.3] | Loss=0.00027 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.183 | L2-Norm(final)=7.279 | 3208.8 samples/s | 50.1 steps/s
[Step=40050 Epoch=153.5] | Loss=0.00093 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.180 | L2-Norm(final)=7.291 | 3897.4 samples/s | 60.9 steps/s
[Step=40100 Epoch=153.6] | Loss=0.00089 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.192 | L2-Norm(final)=7.299 | 4145.0 samples/s | 64.8 steps/s
[Step=40150 Epoch=153.8] | Loss=0.00067 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.198 | L2-Norm(final)=7.307 | 4138.3 samples/s | 64.7 steps/s
[Step=40200 Epoch=154.0] | Loss=0.00057 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.200 | L2-Norm(final)=7.315 | 4117.3 samples/s | 64.3 steps/s
[Step=40250 Epoch=154.2] | Loss=0.00050 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.202 | L2-Norm(final)=7.323 | 5358.3 samples/s | 83.7 steps/s
[Step=40300 Epoch=154.4] | Loss=0.00043 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.202 | L2-Norm(final)=7.330 | 1515.1 samples/s | 23.7 steps/s
[Step=40350 Epoch=154.6] | Loss=0.00038 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.201 | L2-Norm(final)=7.336 | 4072.0 samples/s | 63.6 steps/s
[Step=40400 Epoch=154.8] | Loss=0.00034 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.199 | L2-Norm(final)=7.342 | 4111.5 samples/s | 64.2 steps/s
[Step=40450 Epoch=155.0] | Loss=0.00031 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.196 | L2-Norm(final)=7.348 | 4173.3 samples/s | 65.2 steps/s
[Step=40500 Epoch=155.2] | Loss=0.00029 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.193 | L2-Norm(final)=7.353 | 4630.8 samples/s | 72.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=40501 Epoch=155.2] | Loss=0.00005 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.162 | L2-Norm(final)=7.402 | 3217.0 samples/s | 50.3 steps/s
[Step=40550 Epoch=155.4] | Loss=0.00006 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.152 | L2-Norm(final)=7.406 | 3498.0 samples/s | 54.7 steps/s
[Step=40600 Epoch=155.6] | Loss=0.00004 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.141 | L2-Norm(final)=7.409 | 3742.1 samples/s | 58.5 steps/s
[Step=40650 Epoch=155.8] | Loss=0.00003 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.130 | L2-Norm(final)=7.412 | 3688.8 samples/s | 57.6 steps/s
[Step=40700 Epoch=155.9] | Loss=0.00003 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.117 | L2-Norm(final)=7.414 | 3769.7 samples/s | 58.9 steps/s
[Step=40750 Epoch=156.1] | Loss=0.00003 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.105 | L2-Norm(final)=7.416 | 4676.0 samples/s | 73.1 steps/s
[Step=40800 Epoch=156.3] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.093 | L2-Norm(final)=7.418 | 1430.7 samples/s | 22.4 steps/s
[Step=40850 Epoch=156.5] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.080 | L2-Norm(final)=7.419 | 3743.0 samples/s | 58.5 steps/s
[Step=40900 Epoch=156.7] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.067 | L2-Norm(final)=7.420 | 3682.3 samples/s | 57.5 steps/s
[Step=40950 Epoch=156.9] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.054 | L2-Norm(final)=7.421 | 3732.9 samples/s | 58.3 steps/s
[Step=41000 Epoch=157.1] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.041 | L2-Norm(final)=7.423 | 4127.6 samples/s | 64.5 steps/s
[Step=41050 Epoch=157.3] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.028 | L2-Norm(final)=7.424 | 1515.0 samples/s | 23.7 steps/s
[Step=41100 Epoch=157.5] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.015 | L2-Norm(final)=7.425 | 3754.2 samples/s | 58.7 steps/s
[Step=41150 Epoch=157.7] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.002 | L2-Norm(final)=7.425 | 3723.6 samples/s | 58.2 steps/s
[Step=41200 Epoch=157.9] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.988 | L2-Norm(final)=7.426 | 3706.2 samples/s | 57.9 steps/s
[Step=41250 Epoch=158.1] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.974 | L2-Norm(final)=7.427 | 3726.2 samples/s | 58.2 steps/s
[Step=41300 Epoch=158.2] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=7.428 | 1598.0 samples/s | 25.0 steps/s
[Step=41350 Epoch=158.4] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.947 | L2-Norm(final)=7.429 | 3733.7 samples/s | 58.3 steps/s
[Step=41400 Epoch=158.6] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.933 | L2-Norm(final)=7.430 | 3785.6 samples/s | 59.2 steps/s
[Step=41450 Epoch=158.8] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.919 | L2-Norm(final)=7.430 | 3660.8 samples/s | 57.2 steps/s
[Step=41500 Epoch=159.0] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=7.431 | 3663.4 samples/s | 57.2 steps/s
[Step=41550 Epoch=159.2] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.890 | L2-Norm(final)=7.432 | 1578.0 samples/s | 24.7 steps/s
[Step=41600 Epoch=159.4] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.876 | L2-Norm(final)=7.433 | 3704.9 samples/s | 57.9 steps/s
[Step=41650 Epoch=159.6] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.862 | L2-Norm(final)=7.433 | 3726.9 samples/s | 58.2 steps/s
[Step=41700 Epoch=159.8] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.847 | L2-Norm(final)=7.434 | 3679.2 samples/s | 57.5 steps/s
[Step=41750 Epoch=160.0] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.832 | L2-Norm(final)=7.435 | 3688.7 samples/s | 57.6 steps/s
[Step=41800 Epoch=160.2] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.817 | L2-Norm(final)=7.436 | 5112.7 samples/s | 79.9 steps/s
[Step=41850 Epoch=160.4] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.803 | L2-Norm(final)=7.436 | 1409.1 samples/s | 22.0 steps/s
[Step=41900 Epoch=160.5] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.788 | L2-Norm(final)=7.437 | 3734.8 samples/s | 58.4 steps/s
[Step=41950 Epoch=160.7] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.772 | L2-Norm(final)=7.438 | 3711.9 samples/s | 58.0 steps/s
[Step=42000 Epoch=160.9] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.757 | L2-Norm(final)=7.438 | 3664.4 samples/s | 57.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step42000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=40001 Epoch=154.0] | Loss=0.00039 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.183 | L2-Norm(final)=7.878 | 3389.2 samples/s | 53.0 steps/s
[Step=40050 Epoch=154.2] | Loss=0.00074 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.186 | L2-Norm(final)=7.884 | 3654.3 samples/s | 57.1 steps/s
[Step=40100 Epoch=154.4] | Loss=0.00046 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.189 | L2-Norm(final)=7.891 | 4085.6 samples/s | 63.8 steps/s
[Step=40150 Epoch=154.6] | Loss=0.00043 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.190 | L2-Norm(final)=7.896 | 4071.9 samples/s | 63.6 steps/s
[Step=40200 Epoch=154.7] | Loss=0.00036 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.190 | L2-Norm(final)=7.901 | 4072.7 samples/s | 63.6 steps/s
[Step=40250 Epoch=154.9] | Loss=0.00032 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.191 | L2-Norm(final)=7.906 | 5447.4 samples/s | 85.1 steps/s
[Step=40300 Epoch=155.1] | Loss=0.00029 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.191 | L2-Norm(final)=7.911 | 1502.2 samples/s | 23.5 steps/s
[Step=40350 Epoch=155.3] | Loss=0.00025 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.190 | L2-Norm(final)=7.916 | 4141.2 samples/s | 64.7 steps/s
[Step=40400 Epoch=155.5] | Loss=0.00023 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.189 | L2-Norm(final)=7.920 | 4093.3 samples/s | 64.0 steps/s
[Step=40450 Epoch=155.7] | Loss=0.00021 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.187 | L2-Norm(final)=7.924 | 4159.2 samples/s | 65.0 steps/s
[Step=40500 Epoch=155.9] | Loss=0.00020 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.186 | L2-Norm(final)=7.927 | 4754.1 samples/s | 74.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=40501 Epoch=155.9] | Loss=0.00004 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.171 | L2-Norm(final)=7.965 | 3141.9 samples/s | 49.1 steps/s
[Step=40550 Epoch=156.1] | Loss=0.00005 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.167 | L2-Norm(final)=7.968 | 3649.7 samples/s | 57.0 steps/s
[Step=40600 Epoch=156.3] | Loss=0.00005 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.161 | L2-Norm(final)=7.971 | 3695.5 samples/s | 57.7 steps/s
[Step=40650 Epoch=156.5] | Loss=0.00004 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.155 | L2-Norm(final)=7.973 | 3706.7 samples/s | 57.9 steps/s
[Step=40700 Epoch=156.7] | Loss=0.00004 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.149 | L2-Norm(final)=7.975 | 3742.4 samples/s | 58.5 steps/s
[Step=40750 Epoch=156.9] | Loss=0.00004 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.143 | L2-Norm(final)=7.977 | 4776.6 samples/s | 74.6 steps/s
[Step=40800 Epoch=157.1] | Loss=0.00003 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.137 | L2-Norm(final)=7.979 | 1435.1 samples/s | 22.4 steps/s
[Step=40850 Epoch=157.2] | Loss=0.00003 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.130 | L2-Norm(final)=7.981 | 3763.3 samples/s | 58.8 steps/s
[Step=40900 Epoch=157.4] | Loss=0.00003 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.124 | L2-Norm(final)=7.983 | 3719.2 samples/s | 58.1 steps/s
[Step=40950 Epoch=157.6] | Loss=0.00003 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.117 | L2-Norm(final)=7.984 | 3749.5 samples/s | 58.6 steps/s
[Step=41000 Epoch=157.8] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.110 | L2-Norm(final)=7.985 | 4182.5 samples/s | 65.4 steps/s
[Step=41050 Epoch=158.0] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.103 | L2-Norm(final)=7.987 | 1522.4 samples/s | 23.8 steps/s
[Step=41100 Epoch=158.2] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.097 | L2-Norm(final)=7.988 | 3745.8 samples/s | 58.5 steps/s
[Step=41150 Epoch=158.4] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.089 | L2-Norm(final)=7.989 | 3761.3 samples/s | 58.8 steps/s
[Step=41200 Epoch=158.6] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.082 | L2-Norm(final)=7.990 | 3768.2 samples/s | 58.9 steps/s
[Step=41250 Epoch=158.8] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.075 | L2-Norm(final)=7.991 | 3743.2 samples/s | 58.5 steps/s
[Step=41300 Epoch=159.0] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.068 | L2-Norm(final)=7.992 | 1570.8 samples/s | 24.5 steps/s
[Step=41350 Epoch=159.2] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.061 | L2-Norm(final)=7.993 | 3807.4 samples/s | 59.5 steps/s
[Step=41400 Epoch=159.4] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.053 | L2-Norm(final)=7.994 | 3706.0 samples/s | 57.9 steps/s
[Step=41450 Epoch=159.6] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.046 | L2-Norm(final)=7.995 | 3722.7 samples/s | 58.2 steps/s
[Step=41500 Epoch=159.7] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.038 | L2-Norm(final)=7.996 | 3755.0 samples/s | 58.7 steps/s
[Step=41550 Epoch=159.9] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.030 | L2-Norm(final)=7.997 | 1598.0 samples/s | 25.0 steps/s
[Step=41600 Epoch=160.1] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.023 | L2-Norm(final)=7.998 | 3795.7 samples/s | 59.3 steps/s
[Step=41650 Epoch=160.3] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.015 | L2-Norm(final)=7.999 | 3780.4 samples/s | 59.1 steps/s
[Step=41700 Epoch=160.5] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.007 | L2-Norm(final)=8.000 | 3697.6 samples/s | 57.8 steps/s
[Step=41750 Epoch=160.7] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.999 | L2-Norm(final)=8.001 | 3765.6 samples/s | 58.8 steps/s
[Step=41800 Epoch=160.9] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.991 | L2-Norm(final)=8.002 | 5398.9 samples/s | 84.4 steps/s
[Step=41850 Epoch=161.1] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.983 | L2-Norm(final)=8.003 | 1401.8 samples/s | 21.9 steps/s
[Step=41900 Epoch=161.3] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.975 | L2-Norm(final)=8.003 | 3732.4 samples/s | 58.3 steps/s
[Step=41950 Epoch=161.5] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.967 | L2-Norm(final)=8.004 | 3746.4 samples/s | 58.5 steps/s
[Step=42000 Epoch=161.7] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.959 | L2-Norm(final)=8.005 | 3741.4 samples/s | 58.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step42000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06345 | acc=0.9705 | tpr=0.9760 | fpr=0.0416 | 3514.1 samples/s | 13.7 steps/s
Avg test loss: 0.06958, Avg test acc: 0.96795, Avg tpr: 0.97290, Avg fpr: 0.04294, total FA: 335

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06343 | acc=0.9708 | tpr=0.9760 | fpr=0.0406 | 3558.9 samples/s | 13.9 steps/s
Avg test loss: 0.07161, Avg test acc: 0.96859, Avg tpr: 0.97412, Avg fpr: 0.04358, total FA: 340

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.56155 | acc=0.3132 | tpr=0.0188 | fpr=0.0476 | 3488.9 samples/s | 13.6 steps/s
Avg test loss: 5.56525, Avg test acc: 0.31052, Avg tpr: 0.01935, Avg fpr: 0.04910, total FA: 383

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.96856 | acc=0.3172 | tpr=0.0237 | fpr=0.0456 | 3592.0 samples/s | 14.0 steps/s
Avg test loss: 4.96991, Avg test acc: 0.31513, Avg tpr: 0.02471, Avg fpr: 0.04615, total FA: 360

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.99464 | acc=0.1094 | tpr=0.8628 | fpr=0.9042 | 3510.8 samples/s | 13.7 steps/s
[Step= 100] | Loss=5.97071 | acc=0.1095 | tpr=0.8593 | fpr=0.9045 | 6863.0 samples/s | 26.8 steps/s
[Step= 150] | Loss=5.98723 | acc=0.1080 | tpr=0.8631 | fpr=0.9059 | 6634.2 samples/s | 25.9 steps/s
[Step= 200] | Loss=5.97095 | acc=0.1079 | tpr=0.8503 | fpr=0.9056 | 6896.8 samples/s | 26.9 steps/s
[Step= 250] | Loss=5.96799 | acc=0.1076 | tpr=0.8445 | fpr=0.9059 | 6797.9 samples/s | 26.6 steps/s
[Step= 300] | Loss=5.97002 | acc=0.1074 | tpr=0.8473 | fpr=0.9061 | 6816.0 samples/s | 26.6 steps/s
[Step= 350] | Loss=5.96801 | acc=0.1076 | tpr=0.8491 | fpr=0.9058 | 6850.2 samples/s | 26.8 steps/s
[Step= 400] | Loss=5.96405 | acc=0.1078 | tpr=0.8463 | fpr=0.9056 | 6683.5 samples/s | 26.1 steps/s
[Step= 450] | Loss=5.97084 | acc=0.1075 | tpr=0.8496 | fpr=0.9060 | 6708.9 samples/s | 26.2 steps/s
[Step= 500] | Loss=5.97337 | acc=0.1074 | tpr=0.8502 | fpr=0.9060 | 7181.3 samples/s | 28.1 steps/s
[Step= 550] | Loss=5.97295 | acc=0.1076 | tpr=0.8520 | fpr=0.9060 | 11394.6 samples/s | 44.5 steps/s
Avg test loss: 5.97482, Avg test acc: 0.10748, Avg tpr: 0.85143, Avg fpr: 0.90605, total FA: 125803

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.47635 | acc=0.1077 | tpr=0.8584 | fpr=0.9058 | 3478.4 samples/s | 13.6 steps/s
[Step= 100] | Loss=6.43433 | acc=0.1094 | tpr=0.8593 | fpr=0.9046 | 6878.3 samples/s | 26.9 steps/s
[Step= 150] | Loss=6.44894 | acc=0.1095 | tpr=0.8573 | fpr=0.9043 | 6995.0 samples/s | 27.3 steps/s
[Step= 200] | Loss=6.43122 | acc=0.1094 | tpr=0.8492 | fpr=0.9041 | 6664.5 samples/s | 26.0 steps/s
[Step= 250] | Loss=6.42797 | acc=0.1096 | tpr=0.8437 | fpr=0.9038 | 6932.4 samples/s | 27.1 steps/s
[Step= 300] | Loss=6.42915 | acc=0.1096 | tpr=0.8407 | fpr=0.9037 | 6821.8 samples/s | 26.6 steps/s
[Step= 350] | Loss=6.42705 | acc=0.1101 | tpr=0.8447 | fpr=0.9032 | 7083.0 samples/s | 27.7 steps/s
[Step= 400] | Loss=6.42371 | acc=0.1103 | tpr=0.8408 | fpr=0.9030 | 6814.6 samples/s | 26.6 steps/s
[Step= 450] | Loss=6.43291 | acc=0.1100 | tpr=0.8432 | fpr=0.9033 | 6611.1 samples/s | 25.8 steps/s
[Step= 500] | Loss=6.43398 | acc=0.1100 | tpr=0.8449 | fpr=0.9033 | 6974.0 samples/s | 27.2 steps/s
[Step= 550] | Loss=6.43175 | acc=0.1103 | tpr=0.8468 | fpr=0.9031 | 12076.3 samples/s | 47.2 steps/s
Avg test loss: 6.43368, Avg test acc: 0.11021, Avg tpr: 0.84628, Avg fpr: 0.90317, total FA: 125404

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12699 | acc=0.9808 | tpr=0.9248 | fpr=0.0182 | 3477.9 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.12980 | acc=0.9806 | tpr=0.9424 | fpr=0.0187 | 6880.8 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.13277 | acc=0.9800 | tpr=0.9438 | fpr=0.0193 | 6725.7 samples/s | 26.3 steps/s
[Step= 200] | Loss=0.13373 | acc=0.9801 | tpr=0.9443 | fpr=0.0193 | 7070.1 samples/s | 27.6 steps/s
[Step= 250] | Loss=0.13200 | acc=0.9804 | tpr=0.9450 | fpr=0.0190 | 6636.6 samples/s | 25.9 steps/s
[Step= 300] | Loss=0.13463 | acc=0.9802 | tpr=0.9462 | fpr=0.0192 | 6915.8 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.13426 | acc=0.9801 | tpr=0.9461 | fpr=0.0193 | 6909.7 samples/s | 27.0 steps/s
[Step= 400] | Loss=0.13616 | acc=0.9798 | tpr=0.9415 | fpr=0.0195 | 6830.6 samples/s | 26.7 steps/s
[Step= 450] | Loss=0.13890 | acc=0.9796 | tpr=0.9411 | fpr=0.0197 | 6849.2 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.13881 | acc=0.9796 | tpr=0.9441 | fpr=0.0198 | 6730.1 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.13811 | acc=0.9797 | tpr=0.9423 | fpr=0.0196 | 12732.0 samples/s | 49.7 steps/s
Avg test loss: 0.13799, Avg test acc: 0.97971, Avg tpr: 0.94176, Avg fpr: 0.01960, total FA: 2722

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12811 | acc=0.9806 | tpr=0.9248 | fpr=0.0184 | 3490.3 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.13160 | acc=0.9801 | tpr=0.9510 | fpr=0.0194 | 6883.5 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.13448 | acc=0.9795 | tpr=0.9524 | fpr=0.0200 | 6958.6 samples/s | 27.2 steps/s
[Step= 200] | Loss=0.13510 | acc=0.9797 | tpr=0.9530 | fpr=0.0198 | 6817.7 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.13380 | acc=0.9798 | tpr=0.9546 | fpr=0.0197 | 6909.8 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.13687 | acc=0.9793 | tpr=0.9535 | fpr=0.0202 | 6912.0 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.13641 | acc=0.9793 | tpr=0.9543 | fpr=0.0202 | 6712.7 samples/s | 26.2 steps/s
[Step= 400] | Loss=0.13830 | acc=0.9791 | tpr=0.9524 | fpr=0.0204 | 6798.0 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.14125 | acc=0.9788 | tpr=0.9503 | fpr=0.0207 | 6655.7 samples/s | 26.0 steps/s
[Step= 500] | Loss=0.14104 | acc=0.9787 | tpr=0.9520 | fpr=0.0208 | 6710.7 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.14017 | acc=0.9788 | tpr=0.9511 | fpr=0.0207 | 12541.7 samples/s | 49.0 steps/s
Avg test loss: 0.14009, Avg test acc: 0.97883, Avg tpr: 0.95048, Avg fpr: 0.02066, total FA: 2868

server round 21/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=42001 Epoch=81.9] | Loss=0.00582 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=8.688 | 3087.6 samples/s | 48.2 steps/s
[Step=42050 Epoch=82.0] | Loss=0.00894 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.897 | L2-Norm(final)=8.690 | 4162.8 samples/s | 65.0 steps/s
[Step=42100 Epoch=82.1] | Loss=0.00791 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.907 | L2-Norm(final)=8.695 | 4383.3 samples/s | 68.5 steps/s
[Step=42150 Epoch=82.2] | Loss=0.00822 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.913 | L2-Norm(final)=8.700 | 4310.2 samples/s | 67.3 steps/s
[Step=42200 Epoch=82.3] | Loss=0.00817 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.919 | L2-Norm(final)=8.706 | 4347.5 samples/s | 67.9 steps/s
[Step=42250 Epoch=82.4] | Loss=0.00810 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.925 | L2-Norm(final)=8.712 | 4391.2 samples/s | 68.6 steps/s
[Step=42300 Epoch=82.5] | Loss=0.00871 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.930 | L2-Norm(final)=8.717 | 4405.5 samples/s | 68.8 steps/s
[Step=42350 Epoch=82.6] | Loss=0.00891 | Reg=0.00167 | acc=0.9688 | L2-Norm=12.936 | L2-Norm(final)=8.721 | 4390.4 samples/s | 68.6 steps/s
[Step=42400 Epoch=82.7] | Loss=0.00877 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.942 | L2-Norm(final)=8.725 | 4356.0 samples/s | 68.1 steps/s
[Step=42450 Epoch=82.8] | Loss=0.00856 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.948 | L2-Norm(final)=8.730 | 4346.1 samples/s | 67.9 steps/s
[Step=42500 Epoch=82.9] | Loss=0.00857 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.953 | L2-Norm(final)=8.734 | 5507.6 samples/s | 86.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=42501 Epoch=82.9] | Loss=0.00115 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.006 | L2-Norm(final)=8.780 | 3058.7 samples/s | 47.8 steps/s
[Step=42550 Epoch=83.0] | Loss=0.00681 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.012 | L2-Norm(final)=8.786 | 3767.9 samples/s | 58.9 steps/s
[Step=42600 Epoch=83.1] | Loss=0.00727 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.018 | L2-Norm(final)=8.789 | 3886.0 samples/s | 60.7 steps/s
[Step=42650 Epoch=83.2] | Loss=0.00888 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.025 | L2-Norm(final)=8.790 | 4008.1 samples/s | 62.6 steps/s
[Step=42700 Epoch=83.3] | Loss=0.00894 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.033 | L2-Norm(final)=8.792 | 3906.4 samples/s | 61.0 steps/s
[Step=42750 Epoch=83.4] | Loss=0.00959 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.039 | L2-Norm(final)=8.794 | 3893.4 samples/s | 60.8 steps/s
[Step=42800 Epoch=83.5] | Loss=0.01042 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.044 | L2-Norm(final)=8.795 | 3958.3 samples/s | 61.8 steps/s
[Step=42850 Epoch=83.6] | Loss=0.01037 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.049 | L2-Norm(final)=8.796 | 3955.5 samples/s | 61.8 steps/s
[Step=42900 Epoch=83.7] | Loss=0.01026 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.055 | L2-Norm(final)=8.797 | 3954.8 samples/s | 61.8 steps/s
[Step=42950 Epoch=83.8] | Loss=0.01052 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.061 | L2-Norm(final)=8.799 | 3982.7 samples/s | 62.2 steps/s
[Step=43000 Epoch=83.9] | Loss=0.01044 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.067 | L2-Norm(final)=8.802 | 4777.0 samples/s | 74.6 steps/s
[Step=43050 Epoch=84.0] | Loss=0.01009 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.073 | L2-Norm(final)=8.804 | 1468.1 samples/s | 22.9 steps/s
[Step=43100 Epoch=84.1] | Loss=0.00970 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.079 | L2-Norm(final)=8.807 | 3917.9 samples/s | 61.2 steps/s
[Step=43150 Epoch=84.2] | Loss=0.00954 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.084 | L2-Norm(final)=8.810 | 3912.4 samples/s | 61.1 steps/s
[Step=43200 Epoch=84.3] | Loss=0.00938 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.089 | L2-Norm(final)=8.812 | 3930.3 samples/s | 61.4 steps/s
[Step=43250 Epoch=84.4] | Loss=0.00927 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.093 | L2-Norm(final)=8.814 | 3899.7 samples/s | 60.9 steps/s
[Step=43300 Epoch=84.5] | Loss=0.00927 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.098 | L2-Norm(final)=8.816 | 3921.7 samples/s | 61.3 steps/s
[Step=43350 Epoch=84.5] | Loss=0.00914 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.102 | L2-Norm(final)=8.818 | 3904.3 samples/s | 61.0 steps/s
[Step=43400 Epoch=84.6] | Loss=0.00905 | Reg=0.00172 | acc=0.9688 | L2-Norm=13.107 | L2-Norm(final)=8.820 | 3979.4 samples/s | 62.2 steps/s
[Step=43450 Epoch=84.7] | Loss=0.00906 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.111 | L2-Norm(final)=8.822 | 3966.7 samples/s | 62.0 steps/s
[Step=43500 Epoch=84.8] | Loss=0.00914 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.115 | L2-Norm(final)=8.824 | 4172.5 samples/s | 65.2 steps/s
[Step=43550 Epoch=84.9] | Loss=0.00912 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.118 | L2-Norm(final)=8.825 | 1523.4 samples/s | 23.8 steps/s
[Step=43600 Epoch=85.0] | Loss=0.00906 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.122 | L2-Norm(final)=8.827 | 3953.4 samples/s | 61.8 steps/s
[Step=43650 Epoch=85.1] | Loss=0.00893 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.125 | L2-Norm(final)=8.829 | 3969.9 samples/s | 62.0 steps/s
[Step=43700 Epoch=85.2] | Loss=0.00888 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.129 | L2-Norm(final)=8.830 | 3903.1 samples/s | 61.0 steps/s
[Step=43750 Epoch=85.3] | Loss=0.00876 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.133 | L2-Norm(final)=8.832 | 3936.7 samples/s | 61.5 steps/s
[Step=43800 Epoch=85.4] | Loss=0.00868 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.136 | L2-Norm(final)=8.834 | 3955.4 samples/s | 61.8 steps/s
[Step=43850 Epoch=85.5] | Loss=0.00864 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.139 | L2-Norm(final)=8.836 | 4029.8 samples/s | 63.0 steps/s
[Step=43900 Epoch=85.6] | Loss=0.00862 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.143 | L2-Norm(final)=8.838 | 3946.2 samples/s | 61.7 steps/s
[Step=43950 Epoch=85.7] | Loss=0.00864 | Reg=0.00173 | acc=0.9688 | L2-Norm=13.146 | L2-Norm(final)=8.839 | 3922.7 samples/s | 61.3 steps/s
[Step=44000 Epoch=85.8] | Loss=0.00855 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.149 | L2-Norm(final)=8.841 | 3916.7 samples/s | 61.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step44000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=42001 Epoch=82.1] | Loss=0.02733 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.886 | L2-Norm(final)=8.993 | 3321.8 samples/s | 51.9 steps/s
[Step=42050 Epoch=82.2] | Loss=0.01075 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.897 | L2-Norm(final)=8.993 | 4028.5 samples/s | 62.9 steps/s
[Step=42100 Epoch=82.3] | Loss=0.01003 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.904 | L2-Norm(final)=8.995 | 4315.2 samples/s | 67.4 steps/s
[Step=42150 Epoch=82.4] | Loss=0.00928 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.910 | L2-Norm(final)=8.997 | 4352.4 samples/s | 68.0 steps/s
[Step=42200 Epoch=82.5] | Loss=0.00911 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.916 | L2-Norm(final)=9.001 | 4356.6 samples/s | 68.1 steps/s
[Step=42250 Epoch=82.6] | Loss=0.00893 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.921 | L2-Norm(final)=9.006 | 4362.9 samples/s | 68.2 steps/s
[Step=42300 Epoch=82.7] | Loss=0.00883 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.926 | L2-Norm(final)=9.012 | 4457.8 samples/s | 69.7 steps/s
[Step=42350 Epoch=82.8] | Loss=0.00849 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.931 | L2-Norm(final)=9.019 | 4317.0 samples/s | 67.5 steps/s
[Step=42400 Epoch=82.9] | Loss=0.00891 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.936 | L2-Norm(final)=9.025 | 4344.8 samples/s | 67.9 steps/s
[Step=42450 Epoch=83.0] | Loss=0.00883 | Reg=0.00167 | acc=0.9688 | L2-Norm=12.941 | L2-Norm(final)=9.031 | 4413.1 samples/s | 69.0 steps/s
[Step=42500 Epoch=83.1] | Loss=0.00867 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.946 | L2-Norm(final)=9.038 | 5705.0 samples/s | 89.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=42501 Epoch=83.1] | Loss=0.00607 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.994 | L2-Norm(final)=9.101 | 3464.7 samples/s | 54.1 steps/s
[Step=42550 Epoch=83.2] | Loss=0.00589 | Reg=0.00169 | acc=0.9844 | L2-Norm=13.000 | L2-Norm(final)=9.108 | 3482.5 samples/s | 54.4 steps/s
[Step=42600 Epoch=83.3] | Loss=0.00739 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.007 | L2-Norm(final)=9.112 | 3932.3 samples/s | 61.4 steps/s
[Step=42650 Epoch=83.4] | Loss=0.00849 | Reg=0.00169 | acc=0.9844 | L2-Norm=13.015 | L2-Norm(final)=9.115 | 3902.2 samples/s | 61.0 steps/s
[Step=42700 Epoch=83.5] | Loss=0.00835 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.022 | L2-Norm(final)=9.117 | 3970.9 samples/s | 62.0 steps/s
[Step=42750 Epoch=83.6] | Loss=0.00983 | Reg=0.00170 | acc=0.9688 | L2-Norm=13.028 | L2-Norm(final)=9.119 | 3885.1 samples/s | 60.7 steps/s
[Step=42800 Epoch=83.7] | Loss=0.01015 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.036 | L2-Norm(final)=9.120 | 3958.4 samples/s | 61.9 steps/s
[Step=42850 Epoch=83.8] | Loss=0.01008 | Reg=0.00170 | acc=0.9531 | L2-Norm=13.044 | L2-Norm(final)=9.122 | 3940.5 samples/s | 61.6 steps/s
[Step=42900 Epoch=83.9] | Loss=0.00995 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.051 | L2-Norm(final)=9.123 | 3940.2 samples/s | 61.6 steps/s
[Step=42950 Epoch=84.0] | Loss=0.01023 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.057 | L2-Norm(final)=9.125 | 3924.7 samples/s | 61.3 steps/s
[Step=43000 Epoch=84.1] | Loss=0.01026 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.064 | L2-Norm(final)=9.126 | 4804.1 samples/s | 75.1 steps/s
[Step=43050 Epoch=84.2] | Loss=0.01005 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.070 | L2-Norm(final)=9.128 | 1538.2 samples/s | 24.0 steps/s
[Step=43100 Epoch=84.3] | Loss=0.00990 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.075 | L2-Norm(final)=9.129 | 3890.7 samples/s | 60.8 steps/s
[Step=43150 Epoch=84.4] | Loss=0.00976 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.081 | L2-Norm(final)=9.131 | 3946.5 samples/s | 61.7 steps/s
[Step=43200 Epoch=84.5] | Loss=0.00969 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.086 | L2-Norm(final)=9.133 | 3893.8 samples/s | 60.8 steps/s
[Step=43250 Epoch=84.6] | Loss=0.00959 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.091 | L2-Norm(final)=9.134 | 3929.8 samples/s | 61.4 steps/s
[Step=43300 Epoch=84.7] | Loss=0.00942 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.095 | L2-Norm(final)=9.136 | 3985.5 samples/s | 62.3 steps/s
[Step=43350 Epoch=84.7] | Loss=0.00932 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.100 | L2-Norm(final)=9.138 | 3935.3 samples/s | 61.5 steps/s
[Step=43400 Epoch=84.8] | Loss=0.00928 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=9.140 | 3890.9 samples/s | 60.8 steps/s
[Step=43450 Epoch=84.9] | Loss=0.00933 | Reg=0.00172 | acc=0.9531 | L2-Norm=13.108 | L2-Norm(final)=9.142 | 3978.3 samples/s | 62.2 steps/s
[Step=43500 Epoch=85.0] | Loss=0.00927 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.112 | L2-Norm(final)=9.143 | 4233.2 samples/s | 66.1 steps/s
[Step=43550 Epoch=85.1] | Loss=0.00914 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.116 | L2-Norm(final)=9.144 | 1603.1 samples/s | 25.0 steps/s
[Step=43600 Epoch=85.2] | Loss=0.00902 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.120 | L2-Norm(final)=9.146 | 3944.1 samples/s | 61.6 steps/s
[Step=43650 Epoch=85.3] | Loss=0.00889 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.124 | L2-Norm(final)=9.147 | 3955.9 samples/s | 61.8 steps/s
[Step=43700 Epoch=85.4] | Loss=0.00881 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.127 | L2-Norm(final)=9.149 | 3898.5 samples/s | 60.9 steps/s
[Step=43750 Epoch=85.5] | Loss=0.00877 | Reg=0.00172 | acc=0.9688 | L2-Norm=13.131 | L2-Norm(final)=9.151 | 3944.2 samples/s | 61.6 steps/s
[Step=43800 Epoch=85.6] | Loss=0.00869 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.134 | L2-Norm(final)=9.153 | 3965.1 samples/s | 62.0 steps/s
[Step=43850 Epoch=85.7] | Loss=0.00860 | Reg=0.00173 | acc=0.9531 | L2-Norm=13.138 | L2-Norm(final)=9.154 | 3890.5 samples/s | 60.8 steps/s
[Step=43900 Epoch=85.8] | Loss=0.00858 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.141 | L2-Norm(final)=9.156 | 3974.1 samples/s | 62.1 steps/s
[Step=43950 Epoch=85.9] | Loss=0.00859 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.145 | L2-Norm(final)=9.158 | 3959.0 samples/s | 61.9 steps/s
[Step=44000 Epoch=86.0] | Loss=0.00855 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.148 | L2-Norm(final)=9.159 | 3933.3 samples/s | 61.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step44000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=42001 Epoch=160.9] | Loss=0.00004 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=7.460 | 3273.8 samples/s | 51.2 steps/s
[Step=42050 Epoch=161.1] | Loss=0.00048 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.904 | L2-Norm(final)=7.469 | 3906.8 samples/s | 61.0 steps/s
[Step=42100 Epoch=161.3] | Loss=0.00033 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.907 | L2-Norm(final)=7.479 | 4169.4 samples/s | 65.1 steps/s
[Step=42150 Epoch=161.5] | Loss=0.00027 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.909 | L2-Norm(final)=7.488 | 4125.9 samples/s | 64.5 steps/s
[Step=42200 Epoch=161.7] | Loss=0.00024 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.911 | L2-Norm(final)=7.496 | 4110.0 samples/s | 64.2 steps/s
[Step=42250 Epoch=161.9] | Loss=0.00021 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.912 | L2-Norm(final)=7.503 | 5324.1 samples/s | 83.2 steps/s
[Step=42300 Epoch=162.1] | Loss=0.00018 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.911 | L2-Norm(final)=7.509 | 1532.9 samples/s | 24.0 steps/s
[Step=42350 Epoch=162.3] | Loss=0.00016 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.908 | L2-Norm(final)=7.513 | 4089.9 samples/s | 63.9 steps/s
[Step=42400 Epoch=162.5] | Loss=0.00014 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=7.518 | 4064.8 samples/s | 63.5 steps/s
[Step=42450 Epoch=162.7] | Loss=0.00013 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=7.522 | 4090.0 samples/s | 63.9 steps/s
[Step=42500 Epoch=162.8] | Loss=0.00012 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.896 | L2-Norm(final)=7.525 | 4635.8 samples/s | 72.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=42501 Epoch=162.8] | Loss=0.00002 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.846 | L2-Norm(final)=7.561 | 3098.1 samples/s | 48.4 steps/s
[Step=42550 Epoch=163.0] | Loss=0.00002 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.830 | L2-Norm(final)=7.564 | 3681.2 samples/s | 57.5 steps/s
[Step=42600 Epoch=163.2] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.809 | L2-Norm(final)=7.565 | 3703.5 samples/s | 57.9 steps/s
[Step=42650 Epoch=163.4] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.788 | L2-Norm(final)=7.567 | 3726.0 samples/s | 58.2 steps/s
[Step=42700 Epoch=163.6] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.767 | L2-Norm(final)=7.568 | 3732.9 samples/s | 58.3 steps/s
[Step=42750 Epoch=163.8] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.745 | L2-Norm(final)=7.570 | 4696.8 samples/s | 73.4 steps/s
[Step=42800 Epoch=164.0] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.723 | L2-Norm(final)=7.571 | 1469.5 samples/s | 23.0 steps/s
[Step=42850 Epoch=164.2] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.701 | L2-Norm(final)=7.572 | 3698.8 samples/s | 57.8 steps/s
[Step=42900 Epoch=164.4] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.678 | L2-Norm(final)=7.572 | 3732.2 samples/s | 58.3 steps/s
[Step=42950 Epoch=164.6] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.656 | L2-Norm(final)=7.573 | 3731.0 samples/s | 58.3 steps/s
[Step=43000 Epoch=164.8] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.633 | L2-Norm(final)=7.574 | 4174.5 samples/s | 65.2 steps/s
[Step=43050 Epoch=165.0] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.610 | L2-Norm(final)=7.574 | 1494.5 samples/s | 23.4 steps/s
[Step=43100 Epoch=165.1] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.587 | L2-Norm(final)=7.575 | 3760.8 samples/s | 58.8 steps/s
[Step=43150 Epoch=165.3] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.563 | L2-Norm(final)=7.576 | 3718.9 samples/s | 58.1 steps/s
[Step=43200 Epoch=165.5] | Loss=0.00001 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.540 | L2-Norm(final)=7.576 | 3716.1 samples/s | 58.1 steps/s
[Step=43250 Epoch=165.7] | Loss=0.00001 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.516 | L2-Norm(final)=7.577 | 3730.3 samples/s | 58.3 steps/s
[Step=43300 Epoch=165.9] | Loss=0.00000 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.492 | L2-Norm(final)=7.577 | 1575.9 samples/s | 24.6 steps/s
[Step=43350 Epoch=166.1] | Loss=0.00000 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.468 | L2-Norm(final)=7.578 | 3808.2 samples/s | 59.5 steps/s
[Step=43400 Epoch=166.3] | Loss=0.00000 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.444 | L2-Norm(final)=7.578 | 3694.3 samples/s | 57.7 steps/s
[Step=43450 Epoch=166.5] | Loss=0.00000 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.420 | L2-Norm(final)=7.579 | 3767.7 samples/s | 58.9 steps/s
[Step=43500 Epoch=166.7] | Loss=0.00000 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.396 | L2-Norm(final)=7.579 | 3715.7 samples/s | 58.1 steps/s
[Step=43550 Epoch=166.9] | Loss=0.00000 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=7.579 | 1615.4 samples/s | 25.2 steps/s
[Step=43600 Epoch=167.1] | Loss=0.00000 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.346 | L2-Norm(final)=7.580 | 3707.2 samples/s | 57.9 steps/s
[Step=43650 Epoch=167.3] | Loss=0.00000 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.321 | L2-Norm(final)=7.580 | 3731.4 samples/s | 58.3 steps/s
[Step=43700 Epoch=167.4] | Loss=0.00000 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=7.581 | 3727.3 samples/s | 58.2 steps/s
[Step=43750 Epoch=167.6] | Loss=0.00000 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.271 | L2-Norm(final)=7.581 | 3755.3 samples/s | 58.7 steps/s
[Step=43800 Epoch=167.8] | Loss=0.00000 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.246 | L2-Norm(final)=7.582 | 5001.5 samples/s | 78.1 steps/s
[Step=43850 Epoch=168.0] | Loss=0.00000 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.220 | L2-Norm(final)=7.583 | 1479.1 samples/s | 23.1 steps/s
[Step=43900 Epoch=168.2] | Loss=0.00000 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.194 | L2-Norm(final)=7.583 | 3768.4 samples/s | 58.9 steps/s
[Step=43950 Epoch=168.4] | Loss=0.00000 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=7.584 | 3744.5 samples/s | 58.5 steps/s
[Step=44000 Epoch=168.6] | Loss=0.00000 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=7.584 | 3698.6 samples/s | 57.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step44000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=42001 Epoch=161.7] | Loss=0.00003 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=8.032 | 3198.6 samples/s | 50.0 steps/s
[Step=42050 Epoch=161.9] | Loss=0.00024 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.894 | L2-Norm(final)=8.039 | 3955.8 samples/s | 61.8 steps/s
[Step=42100 Epoch=162.1] | Loss=0.00021 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=8.047 | 4059.1 samples/s | 63.4 steps/s
[Step=42150 Epoch=162.3] | Loss=0.00018 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.904 | L2-Norm(final)=8.055 | 4056.6 samples/s | 63.4 steps/s
[Step=42200 Epoch=162.4] | Loss=0.00015 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=8.061 | 4067.4 samples/s | 63.6 steps/s
[Step=42250 Epoch=162.6] | Loss=0.00013 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.904 | L2-Norm(final)=8.067 | 5495.9 samples/s | 85.9 steps/s
[Step=42300 Epoch=162.8] | Loss=0.00011 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.903 | L2-Norm(final)=8.072 | 1522.4 samples/s | 23.8 steps/s
[Step=42350 Epoch=163.0] | Loss=0.00010 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=8.076 | 4089.8 samples/s | 63.9 steps/s
[Step=42400 Epoch=163.2] | Loss=0.00009 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.896 | L2-Norm(final)=8.080 | 4107.5 samples/s | 64.2 steps/s
[Step=42450 Epoch=163.4] | Loss=0.00009 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.892 | L2-Norm(final)=8.084 | 4109.3 samples/s | 64.2 steps/s
[Step=42500 Epoch=163.6] | Loss=0.00008 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.888 | L2-Norm(final)=8.088 | 4751.5 samples/s | 74.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=42501 Epoch=163.6] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.845 | L2-Norm(final)=8.123 | 3065.9 samples/s | 47.9 steps/s
[Step=42550 Epoch=163.8] | Loss=0.00002 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.836 | L2-Norm(final)=8.126 | 3680.4 samples/s | 57.5 steps/s
[Step=42600 Epoch=164.0] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.824 | L2-Norm(final)=8.128 | 3726.8 samples/s | 58.2 steps/s
[Step=42650 Epoch=164.2] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.812 | L2-Norm(final)=8.130 | 3684.6 samples/s | 57.6 steps/s
[Step=42700 Epoch=164.4] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.799 | L2-Norm(final)=8.131 | 3730.6 samples/s | 58.3 steps/s
[Step=42750 Epoch=164.6] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=8.133 | 4738.0 samples/s | 74.0 steps/s
[Step=42800 Epoch=164.8] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.774 | L2-Norm(final)=8.135 | 1462.6 samples/s | 22.9 steps/s
[Step=42850 Epoch=164.9] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.762 | L2-Norm(final)=8.136 | 3717.5 samples/s | 58.1 steps/s
[Step=42900 Epoch=165.1] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.749 | L2-Norm(final)=8.138 | 3671.8 samples/s | 57.4 steps/s
[Step=42950 Epoch=165.3] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.735 | L2-Norm(final)=8.139 | 3746.6 samples/s | 58.5 steps/s
[Step=43000 Epoch=165.5] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.722 | L2-Norm(final)=8.140 | 4266.9 samples/s | 66.7 steps/s
[Step=43050 Epoch=165.7] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.708 | L2-Norm(final)=8.141 | 1479.1 samples/s | 23.1 steps/s
[Step=43100 Epoch=165.9] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.695 | L2-Norm(final)=8.142 | 3681.0 samples/s | 57.5 steps/s
[Step=43150 Epoch=166.1] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.681 | L2-Norm(final)=8.143 | 3697.4 samples/s | 57.8 steps/s
[Step=43200 Epoch=166.3] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.667 | L2-Norm(final)=8.144 | 3720.4 samples/s | 58.1 steps/s
[Step=43250 Epoch=166.5] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.653 | L2-Norm(final)=8.146 | 3756.0 samples/s | 58.7 steps/s
[Step=43300 Epoch=166.7] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.639 | L2-Norm(final)=8.147 | 1552.1 samples/s | 24.3 steps/s
[Step=43350 Epoch=166.9] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.625 | L2-Norm(final)=8.147 | 3714.4 samples/s | 58.0 steps/s
[Step=43400 Epoch=167.1] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.611 | L2-Norm(final)=8.148 | 3748.3 samples/s | 58.6 steps/s
[Step=43450 Epoch=167.3] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.596 | L2-Norm(final)=8.149 | 3652.6 samples/s | 57.1 steps/s
[Step=43500 Epoch=167.4] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.582 | L2-Norm(final)=8.150 | 3751.1 samples/s | 58.6 steps/s
[Step=43550 Epoch=167.6] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.567 | L2-Norm(final)=8.151 | 1592.2 samples/s | 24.9 steps/s
[Step=43600 Epoch=167.8] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.552 | L2-Norm(final)=8.152 | 3776.8 samples/s | 59.0 steps/s
[Step=43650 Epoch=168.0] | Loss=0.00001 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=8.153 | 3703.3 samples/s | 57.9 steps/s
[Step=43700 Epoch=168.2] | Loss=0.00001 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.522 | L2-Norm(final)=8.154 | 3723.7 samples/s | 58.2 steps/s
[Step=43750 Epoch=168.4] | Loss=0.00001 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.507 | L2-Norm(final)=8.155 | 3716.0 samples/s | 58.1 steps/s
[Step=43800 Epoch=168.6] | Loss=0.00001 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.492 | L2-Norm(final)=8.156 | 5513.3 samples/s | 86.1 steps/s
[Step=43850 Epoch=168.8] | Loss=0.00001 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.477 | L2-Norm(final)=8.157 | 1391.3 samples/s | 21.7 steps/s
[Step=43900 Epoch=169.0] | Loss=0.00001 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.461 | L2-Norm(final)=8.158 | 3761.3 samples/s | 58.8 steps/s
[Step=43950 Epoch=169.2] | Loss=0.00001 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.446 | L2-Norm(final)=8.159 | 3720.5 samples/s | 58.1 steps/s
[Step=44000 Epoch=169.4] | Loss=0.00001 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=8.160 | 3733.2 samples/s | 58.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step44000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06628 | acc=0.9699 | tpr=0.9763 | fpr=0.0439 | 3699.3 samples/s | 14.5 steps/s
Avg test loss: 0.07253, Avg test acc: 0.96755, Avg tpr: 0.97377, Avg fpr: 0.04615, total FA: 360

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06387 | acc=0.9688 | tpr=0.9731 | fpr=0.0406 | 3516.9 samples/s | 13.7 steps/s
Avg test loss: 0.07076, Avg test acc: 0.96702, Avg tpr: 0.97214, Avg fpr: 0.04423, total FA: 345

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.68845 | acc=0.3155 | tpr=0.0178 | fpr=0.0382 | 3579.1 samples/s | 14.0 steps/s
Avg test loss: 5.70267, Avg test acc: 0.31196, Avg tpr: 0.01766, Avg fpr: 0.04076, total FA: 318

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.23598 | acc=0.3172 | tpr=0.0232 | fpr=0.0444 | 3528.8 samples/s | 13.8 steps/s
Avg test loss: 5.24190, Avg test acc: 0.31453, Avg tpr: 0.02384, Avg fpr: 0.04615, total FA: 360

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.56199 | acc=0.1001 | tpr=0.8274 | fpr=0.9130 | 3522.9 samples/s | 13.8 steps/s
[Step= 100] | Loss=6.52622 | acc=0.1013 | tpr=0.8422 | fpr=0.9125 | 6732.6 samples/s | 26.3 steps/s
[Step= 150] | Loss=6.54107 | acc=0.1009 | tpr=0.8458 | fpr=0.9128 | 6894.1 samples/s | 26.9 steps/s
[Step= 200] | Loss=6.52147 | acc=0.1007 | tpr=0.8273 | fpr=0.9125 | 7287.0 samples/s | 28.5 steps/s
[Step= 250] | Loss=6.51748 | acc=0.1007 | tpr=0.8245 | fpr=0.9125 | 6412.3 samples/s | 25.0 steps/s
[Step= 300] | Loss=6.51905 | acc=0.1005 | tpr=0.8240 | fpr=0.9127 | 7188.4 samples/s | 28.1 steps/s
[Step= 350] | Loss=6.51588 | acc=0.1007 | tpr=0.8284 | fpr=0.9125 | 6757.0 samples/s | 26.4 steps/s
[Step= 400] | Loss=6.51128 | acc=0.1007 | tpr=0.8244 | fpr=0.9125 | 6775.7 samples/s | 26.5 steps/s
[Step= 450] | Loss=6.51821 | acc=0.1006 | tpr=0.8306 | fpr=0.9127 | 6714.6 samples/s | 26.2 steps/s
[Step= 500] | Loss=6.52107 | acc=0.1006 | tpr=0.8308 | fpr=0.9126 | 6820.1 samples/s | 26.6 steps/s
[Step= 550] | Loss=6.52060 | acc=0.1010 | tpr=0.8333 | fpr=0.9123 | 12105.6 samples/s | 47.3 steps/s
Avg test loss: 6.52285, Avg test acc: 0.10088, Avg tpr: 0.83281, Avg fpr: 0.91243, total FA: 126689

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.05496 | acc=0.1129 | tpr=0.8186 | fpr=0.8998 | 3501.4 samples/s | 13.7 steps/s
[Step= 100] | Loss=6.01791 | acc=0.1138 | tpr=0.8081 | fpr=0.8992 | 6838.5 samples/s | 26.7 steps/s
[Step= 150] | Loss=6.02844 | acc=0.1140 | tpr=0.8184 | fpr=0.8989 | 7151.5 samples/s | 27.9 steps/s
[Step= 200] | Loss=6.01299 | acc=0.1138 | tpr=0.8033 | fpr=0.8988 | 6526.3 samples/s | 25.5 steps/s
[Step= 250] | Loss=6.01189 | acc=0.1138 | tpr=0.7956 | fpr=0.8986 | 6897.9 samples/s | 26.9 steps/s
[Step= 300] | Loss=6.01297 | acc=0.1136 | tpr=0.7927 | fpr=0.8988 | 6798.7 samples/s | 26.6 steps/s
[Step= 350] | Loss=6.01212 | acc=0.1140 | tpr=0.7984 | fpr=0.8985 | 6806.5 samples/s | 26.6 steps/s
[Step= 400] | Loss=6.00983 | acc=0.1143 | tpr=0.7943 | fpr=0.8980 | 6616.9 samples/s | 25.8 steps/s
[Step= 450] | Loss=6.01727 | acc=0.1141 | tpr=0.7975 | fpr=0.8983 | 6830.6 samples/s | 26.7 steps/s
[Step= 500] | Loss=6.01882 | acc=0.1142 | tpr=0.7974 | fpr=0.8981 | 6659.0 samples/s | 26.0 steps/s
[Step= 550] | Loss=6.01964 | acc=0.1144 | tpr=0.8002 | fpr=0.8981 | 12355.7 samples/s | 48.3 steps/s
Avg test loss: 6.02114, Avg test acc: 0.11427, Avg tpr: 0.79992, Avg fpr: 0.89820, total FA: 124713

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12847 | acc=0.9813 | tpr=0.9381 | fpr=0.0179 | 3485.7 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.13150 | acc=0.9810 | tpr=0.9488 | fpr=0.0184 | 7185.3 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.13507 | acc=0.9803 | tpr=0.9467 | fpr=0.0191 | 6645.4 samples/s | 26.0 steps/s
[Step= 200] | Loss=0.13604 | acc=0.9803 | tpr=0.9443 | fpr=0.0190 | 6689.0 samples/s | 26.1 steps/s
[Step= 250] | Loss=0.13424 | acc=0.9806 | tpr=0.9441 | fpr=0.0188 | 6863.9 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.13681 | acc=0.9802 | tpr=0.9455 | fpr=0.0192 | 6753.0 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.13669 | acc=0.9801 | tpr=0.9455 | fpr=0.0193 | 6796.9 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.13852 | acc=0.9799 | tpr=0.9420 | fpr=0.0194 | 6812.6 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.14122 | acc=0.9796 | tpr=0.9396 | fpr=0.0197 | 6745.4 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.14105 | acc=0.9797 | tpr=0.9427 | fpr=0.0197 | 6750.6 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.14028 | acc=0.9798 | tpr=0.9423 | fpr=0.0195 | 12239.0 samples/s | 47.8 steps/s
Avg test loss: 0.14017, Avg test acc: 0.97981, Avg tpr: 0.94176, Avg fpr: 0.01950, total FA: 2707

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13010 | acc=0.9810 | tpr=0.9292 | fpr=0.0181 | 3515.7 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.13361 | acc=0.9805 | tpr=0.9552 | fpr=0.0190 | 6761.7 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.13679 | acc=0.9796 | tpr=0.9524 | fpr=0.0199 | 6995.0 samples/s | 27.3 steps/s
[Step= 200] | Loss=0.13757 | acc=0.9797 | tpr=0.9541 | fpr=0.0198 | 6937.9 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.13633 | acc=0.9798 | tpr=0.9546 | fpr=0.0197 | 6590.4 samples/s | 25.7 steps/s
[Step= 300] | Loss=0.13938 | acc=0.9793 | tpr=0.9535 | fpr=0.0202 | 6882.3 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.13888 | acc=0.9793 | tpr=0.9537 | fpr=0.0202 | 6931.6 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.14077 | acc=0.9791 | tpr=0.9513 | fpr=0.0204 | 6738.3 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.14377 | acc=0.9788 | tpr=0.9484 | fpr=0.0207 | 6789.7 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.14351 | acc=0.9788 | tpr=0.9502 | fpr=0.0207 | 6835.9 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.14255 | acc=0.9790 | tpr=0.9503 | fpr=0.0205 | 12268.8 samples/s | 47.9 steps/s
Avg test loss: 0.14246, Avg test acc: 0.97901, Avg tpr: 0.94968, Avg fpr: 0.02046, total FA: 2841

server round 22/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=44001 Epoch=85.8] | Loss=0.02662 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.332 | L2-Norm(final)=8.891 | 3092.8 samples/s | 48.3 steps/s
[Step=44050 Epoch=85.9] | Loss=0.01024 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.342 | L2-Norm(final)=8.892 | 4060.2 samples/s | 63.4 steps/s
[Step=44100 Epoch=86.0] | Loss=0.00944 | Reg=0.00153 | acc=0.9375 | L2-Norm=12.352 | L2-Norm(final)=8.896 | 4320.3 samples/s | 67.5 steps/s
[Step=44150 Epoch=86.1] | Loss=0.00938 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.358 | L2-Norm(final)=8.900 | 4414.0 samples/s | 69.0 steps/s
[Step=44200 Epoch=86.2] | Loss=0.00881 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.365 | L2-Norm(final)=8.906 | 4374.1 samples/s | 68.3 steps/s
[Step=44250 Epoch=86.3] | Loss=0.00883 | Reg=0.00153 | acc=0.9688 | L2-Norm=12.372 | L2-Norm(final)=8.912 | 4389.0 samples/s | 68.6 steps/s
[Step=44300 Epoch=86.4] | Loss=0.00901 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.378 | L2-Norm(final)=8.918 | 4309.2 samples/s | 67.3 steps/s
[Step=44350 Epoch=86.5] | Loss=0.00901 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.384 | L2-Norm(final)=8.924 | 4434.2 samples/s | 69.3 steps/s
[Step=44400 Epoch=86.6] | Loss=0.00869 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.391 | L2-Norm(final)=8.931 | 4401.2 samples/s | 68.8 steps/s
[Step=44450 Epoch=86.7] | Loss=0.00865 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.397 | L2-Norm(final)=8.937 | 4296.7 samples/s | 67.1 steps/s
[Step=44500 Epoch=86.8] | Loss=0.00849 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.404 | L2-Norm(final)=8.944 | 5454.8 samples/s | 85.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=44501 Epoch=86.8] | Loss=0.01544 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.464 | L2-Norm(final)=9.007 | 2954.3 samples/s | 46.2 steps/s
[Step=44550 Epoch=86.9] | Loss=0.00763 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.468 | L2-Norm(final)=9.012 | 4012.4 samples/s | 62.7 steps/s
[Step=44600 Epoch=87.0] | Loss=0.00948 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=9.012 | 3871.0 samples/s | 60.5 steps/s
[Step=44650 Epoch=87.1] | Loss=0.00983 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.485 | L2-Norm(final)=9.016 | 3955.8 samples/s | 61.8 steps/s
[Step=44700 Epoch=87.2] | Loss=0.01029 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=9.021 | 3903.6 samples/s | 61.0 steps/s
[Step=44750 Epoch=87.3] | Loss=0.01115 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.505 | L2-Norm(final)=9.024 | 3913.7 samples/s | 61.2 steps/s
[Step=44800 Epoch=87.4] | Loss=0.01084 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.516 | L2-Norm(final)=9.027 | 3918.1 samples/s | 61.2 steps/s
[Step=44850 Epoch=87.5] | Loss=0.01070 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.526 | L2-Norm(final)=9.030 | 3896.2 samples/s | 60.9 steps/s
[Step=44900 Epoch=87.6] | Loss=0.01084 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.535 | L2-Norm(final)=9.034 | 3940.1 samples/s | 61.6 steps/s
[Step=44950 Epoch=87.7] | Loss=0.01087 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.543 | L2-Norm(final)=9.037 | 3963.4 samples/s | 61.9 steps/s
[Step=45000 Epoch=87.8] | Loss=0.01058 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.551 | L2-Norm(final)=9.041 | 4885.6 samples/s | 76.3 steps/s
[Step=45050 Epoch=87.9] | Loss=0.01034 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.559 | L2-Norm(final)=9.045 | 1454.7 samples/s | 22.7 steps/s
[Step=45100 Epoch=88.0] | Loss=0.00995 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.565 | L2-Norm(final)=9.049 | 3939.3 samples/s | 61.6 steps/s
[Step=45150 Epoch=88.1] | Loss=0.00987 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.572 | L2-Norm(final)=9.052 | 3919.2 samples/s | 61.2 steps/s
[Step=45200 Epoch=88.2] | Loss=0.01005 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.577 | L2-Norm(final)=9.055 | 3878.0 samples/s | 60.6 steps/s
[Step=45250 Epoch=88.3] | Loss=0.00977 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.583 | L2-Norm(final)=9.057 | 3922.0 samples/s | 61.3 steps/s
[Step=45300 Epoch=88.4] | Loss=0.00971 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.588 | L2-Norm(final)=9.060 | 3927.5 samples/s | 61.4 steps/s
[Step=45350 Epoch=88.5] | Loss=0.00971 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.593 | L2-Norm(final)=9.062 | 3945.6 samples/s | 61.7 steps/s
[Step=45400 Epoch=88.5] | Loss=0.00956 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.598 | L2-Norm(final)=9.064 | 3957.2 samples/s | 61.8 steps/s
[Step=45450 Epoch=88.6] | Loss=0.00953 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.603 | L2-Norm(final)=9.066 | 3966.5 samples/s | 62.0 steps/s
[Step=45500 Epoch=88.7] | Loss=0.00949 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.608 | L2-Norm(final)=9.069 | 4139.1 samples/s | 64.7 steps/s
[Step=45550 Epoch=88.8] | Loss=0.00934 | Reg=0.00159 | acc=0.9688 | L2-Norm=12.612 | L2-Norm(final)=9.071 | 1570.8 samples/s | 24.5 steps/s
[Step=45600 Epoch=88.9] | Loss=0.00922 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.617 | L2-Norm(final)=9.074 | 3908.4 samples/s | 61.1 steps/s
[Step=45650 Epoch=89.0] | Loss=0.00911 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.621 | L2-Norm(final)=9.076 | 3931.5 samples/s | 61.4 steps/s
[Step=45700 Epoch=89.1] | Loss=0.00899 | Reg=0.00159 | acc=0.9688 | L2-Norm=12.625 | L2-Norm(final)=9.079 | 3929.5 samples/s | 61.4 steps/s
[Step=45750 Epoch=89.2] | Loss=0.00886 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.629 | L2-Norm(final)=9.081 | 3909.1 samples/s | 61.1 steps/s
[Step=45800 Epoch=89.3] | Loss=0.00874 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.633 | L2-Norm(final)=9.084 | 3927.0 samples/s | 61.4 steps/s
[Step=45850 Epoch=89.4] | Loss=0.00866 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.637 | L2-Norm(final)=9.086 | 3939.0 samples/s | 61.5 steps/s
[Step=45900 Epoch=89.5] | Loss=0.00865 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.640 | L2-Norm(final)=9.088 | 3915.4 samples/s | 61.2 steps/s
[Step=45950 Epoch=89.6] | Loss=0.00867 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.644 | L2-Norm(final)=9.091 | 3942.0 samples/s | 61.6 steps/s
[Step=46000 Epoch=89.7] | Loss=0.00857 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.647 | L2-Norm(final)=9.093 | 3948.1 samples/s | 61.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step46000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=44001 Epoch=86.0] | Loss=0.00062 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.332 | L2-Norm(final)=9.197 | 3396.8 samples/s | 53.1 steps/s
[Step=44050 Epoch=86.1] | Loss=0.00752 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.342 | L2-Norm(final)=9.203 | 4087.7 samples/s | 63.9 steps/s
[Step=44100 Epoch=86.2] | Loss=0.00768 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.349 | L2-Norm(final)=9.207 | 4402.1 samples/s | 68.8 steps/s
[Step=44150 Epoch=86.3] | Loss=0.00746 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.355 | L2-Norm(final)=9.213 | 4276.4 samples/s | 66.8 steps/s
[Step=44200 Epoch=86.4] | Loss=0.00783 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.360 | L2-Norm(final)=9.219 | 4415.5 samples/s | 69.0 steps/s
[Step=44250 Epoch=86.5] | Loss=0.00783 | Reg=0.00153 | acc=0.9688 | L2-Norm=12.367 | L2-Norm(final)=9.225 | 4293.8 samples/s | 67.1 steps/s
[Step=44300 Epoch=86.6] | Loss=0.00781 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.374 | L2-Norm(final)=9.231 | 4391.8 samples/s | 68.6 steps/s
[Step=44350 Epoch=86.7] | Loss=0.00785 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.380 | L2-Norm(final)=9.236 | 4331.7 samples/s | 67.7 steps/s
[Step=44400 Epoch=86.8] | Loss=0.00816 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.386 | L2-Norm(final)=9.242 | 4421.2 samples/s | 69.1 steps/s
[Step=44450 Epoch=86.9] | Loss=0.00817 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.391 | L2-Norm(final)=9.247 | 4315.7 samples/s | 67.4 steps/s
[Step=44500 Epoch=87.0] | Loss=0.00809 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.396 | L2-Norm(final)=9.252 | 5665.0 samples/s | 88.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=44501 Epoch=87.0] | Loss=0.00023 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.446 | L2-Norm(final)=9.304 | 3327.4 samples/s | 52.0 steps/s
[Step=44550 Epoch=87.1] | Loss=0.00818 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.453 | L2-Norm(final)=9.311 | 3709.8 samples/s | 58.0 steps/s
[Step=44600 Epoch=87.2] | Loss=0.00999 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.463 | L2-Norm(final)=9.313 | 3913.9 samples/s | 61.2 steps/s
[Step=44650 Epoch=87.3] | Loss=0.01062 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.473 | L2-Norm(final)=9.315 | 3897.2 samples/s | 60.9 steps/s
[Step=44700 Epoch=87.4] | Loss=0.01066 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.482 | L2-Norm(final)=9.318 | 3927.0 samples/s | 61.4 steps/s
[Step=44750 Epoch=87.5] | Loss=0.01081 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.490 | L2-Norm(final)=9.320 | 3996.9 samples/s | 62.5 steps/s
[Step=44800 Epoch=87.6] | Loss=0.01130 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=9.322 | 3943.3 samples/s | 61.6 steps/s
[Step=44850 Epoch=87.7] | Loss=0.01139 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.506 | L2-Norm(final)=9.325 | 3993.3 samples/s | 62.4 steps/s
[Step=44900 Epoch=87.8] | Loss=0.01094 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.514 | L2-Norm(final)=9.328 | 3913.8 samples/s | 61.2 steps/s
[Step=44950 Epoch=87.9] | Loss=0.01044 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.522 | L2-Norm(final)=9.332 | 3997.9 samples/s | 62.5 steps/s
[Step=45000 Epoch=88.0] | Loss=0.01025 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.529 | L2-Norm(final)=9.336 | 4870.6 samples/s | 76.1 steps/s
[Step=45050 Epoch=88.1] | Loss=0.01003 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=9.340 | 1466.6 samples/s | 22.9 steps/s
[Step=45100 Epoch=88.2] | Loss=0.00983 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.542 | L2-Norm(final)=9.343 | 3873.8 samples/s | 60.5 steps/s
[Step=45150 Epoch=88.3] | Loss=0.00972 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.548 | L2-Norm(final)=9.346 | 3830.1 samples/s | 59.8 steps/s
[Step=45200 Epoch=88.4] | Loss=0.00970 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.554 | L2-Norm(final)=9.349 | 3919.2 samples/s | 61.2 steps/s
[Step=45250 Epoch=88.5] | Loss=0.00985 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.559 | L2-Norm(final)=9.351 | 3890.0 samples/s | 60.8 steps/s
[Step=45300 Epoch=88.6] | Loss=0.00971 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.564 | L2-Norm(final)=9.353 | 3968.6 samples/s | 62.0 steps/s
[Step=45350 Epoch=88.7] | Loss=0.00957 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.569 | L2-Norm(final)=9.356 | 3900.4 samples/s | 60.9 steps/s
[Step=45400 Epoch=88.8] | Loss=0.00950 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.574 | L2-Norm(final)=9.358 | 3883.6 samples/s | 60.7 steps/s
[Step=45450 Epoch=88.9] | Loss=0.00954 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.579 | L2-Norm(final)=9.360 | 3911.5 samples/s | 61.1 steps/s
[Step=45500 Epoch=89.0] | Loss=0.00939 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.583 | L2-Norm(final)=9.363 | 4220.7 samples/s | 65.9 steps/s
[Step=45550 Epoch=89.0] | Loss=0.00920 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.588 | L2-Norm(final)=9.365 | 1597.5 samples/s | 25.0 steps/s
[Step=45600 Epoch=89.1] | Loss=0.00908 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.593 | L2-Norm(final)=9.368 | 3895.8 samples/s | 60.9 steps/s
[Step=45650 Epoch=89.2] | Loss=0.00893 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.597 | L2-Norm(final)=9.370 | 3903.8 samples/s | 61.0 steps/s
[Step=45700 Epoch=89.3] | Loss=0.00883 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.602 | L2-Norm(final)=9.373 | 3924.4 samples/s | 61.3 steps/s
[Step=45750 Epoch=89.4] | Loss=0.00878 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.606 | L2-Norm(final)=9.376 | 3890.2 samples/s | 60.8 steps/s
[Step=45800 Epoch=89.5] | Loss=0.00868 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.610 | L2-Norm(final)=9.378 | 3934.9 samples/s | 61.5 steps/s
[Step=45850 Epoch=89.6] | Loss=0.00861 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.614 | L2-Norm(final)=9.380 | 3945.4 samples/s | 61.6 steps/s
[Step=45900 Epoch=89.7] | Loss=0.00859 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.618 | L2-Norm(final)=9.383 | 3921.6 samples/s | 61.3 steps/s
[Step=45950 Epoch=89.8] | Loss=0.00849 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.622 | L2-Norm(final)=9.385 | 3936.7 samples/s | 61.5 steps/s
[Step=46000 Epoch=89.9] | Loss=0.00844 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.626 | L2-Norm(final)=9.388 | 3953.7 samples/s | 61.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step46000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=44001 Epoch=168.6] | Loss=0.00014 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.332 | L2-Norm(final)=7.602 | 3292.2 samples/s | 51.4 steps/s
[Step=44050 Epoch=168.8] | Loss=0.00017 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.329 | L2-Norm(final)=7.618 | 3717.2 samples/s | 58.1 steps/s
[Step=44100 Epoch=169.0] | Loss=0.00045 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.341 | L2-Norm(final)=7.631 | 4120.0 samples/s | 64.4 steps/s
[Step=44150 Epoch=169.2] | Loss=0.00033 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.357 | L2-Norm(final)=7.636 | 4071.6 samples/s | 63.6 steps/s
[Step=44200 Epoch=169.4] | Loss=0.00027 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.365 | L2-Norm(final)=7.641 | 4268.4 samples/s | 66.7 steps/s
[Step=44250 Epoch=169.6] | Loss=0.00024 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.369 | L2-Norm(final)=7.645 | 5283.6 samples/s | 82.6 steps/s
[Step=44300 Epoch=169.7] | Loss=0.00020 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.372 | L2-Norm(final)=7.649 | 1510.6 samples/s | 23.6 steps/s
[Step=44350 Epoch=169.9] | Loss=0.00018 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=7.653 | 4160.2 samples/s | 65.0 steps/s
[Step=44400 Epoch=170.1] | Loss=0.00016 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.369 | L2-Norm(final)=7.656 | 4050.1 samples/s | 63.3 steps/s
[Step=44450 Epoch=170.3] | Loss=0.00014 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.366 | L2-Norm(final)=7.659 | 4118.8 samples/s | 64.4 steps/s
[Step=44500 Epoch=170.5] | Loss=0.00013 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.363 | L2-Norm(final)=7.661 | 4640.6 samples/s | 72.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=44501 Epoch=170.5] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.325 | L2-Norm(final)=7.687 | 3434.9 samples/s | 53.7 steps/s
[Step=44550 Epoch=170.7] | Loss=0.00017 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.322 | L2-Norm(final)=7.690 | 3295.8 samples/s | 51.5 steps/s
[Step=44600 Epoch=170.9] | Loss=0.00133 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.352 | L2-Norm(final)=7.691 | 3691.4 samples/s | 57.7 steps/s
[Step=44650 Epoch=171.1] | Loss=0.00265 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.395 | L2-Norm(final)=7.680 | 3759.4 samples/s | 58.7 steps/s
[Step=44700 Epoch=171.3] | Loss=0.00273 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.429 | L2-Norm(final)=7.669 | 3717.1 samples/s | 58.1 steps/s
[Step=44750 Epoch=171.5] | Loss=0.00221 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.451 | L2-Norm(final)=7.663 | 4608.5 samples/s | 72.0 steps/s
[Step=44800 Epoch=171.7] | Loss=0.00199 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.465 | L2-Norm(final)=7.659 | 1459.0 samples/s | 22.8 steps/s
[Step=44850 Epoch=171.8] | Loss=0.00176 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.474 | L2-Norm(final)=7.656 | 3655.2 samples/s | 57.1 steps/s
[Step=44900 Epoch=172.0] | Loss=0.00154 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.481 | L2-Norm(final)=7.654 | 3743.5 samples/s | 58.5 steps/s
[Step=44950 Epoch=172.2] | Loss=0.00137 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.486 | L2-Norm(final)=7.652 | 3731.5 samples/s | 58.3 steps/s
[Step=45000 Epoch=172.4] | Loss=0.00123 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.489 | L2-Norm(final)=7.651 | 4102.1 samples/s | 64.1 steps/s
[Step=45050 Epoch=172.6] | Loss=0.00112 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.490 | L2-Norm(final)=7.650 | 1499.5 samples/s | 23.4 steps/s
[Step=45100 Epoch=172.8] | Loss=0.00103 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.491 | L2-Norm(final)=7.649 | 3706.9 samples/s | 57.9 steps/s
[Step=45150 Epoch=173.0] | Loss=0.00095 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.492 | L2-Norm(final)=7.649 | 3728.2 samples/s | 58.3 steps/s
[Step=45200 Epoch=173.2] | Loss=0.00088 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.491 | L2-Norm(final)=7.648 | 3695.5 samples/s | 57.7 steps/s
[Step=45250 Epoch=173.4] | Loss=0.00083 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.491 | L2-Norm(final)=7.648 | 3777.5 samples/s | 59.0 steps/s
[Step=45300 Epoch=173.6] | Loss=0.00077 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.490 | L2-Norm(final)=7.648 | 1631.6 samples/s | 25.5 steps/s
[Step=45350 Epoch=173.8] | Loss=0.00073 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.488 | L2-Norm(final)=7.648 | 3786.1 samples/s | 59.2 steps/s
[Step=45400 Epoch=174.0] | Loss=0.00069 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.487 | L2-Norm(final)=7.648 | 3681.3 samples/s | 57.5 steps/s
[Step=45450 Epoch=174.1] | Loss=0.00065 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.485 | L2-Norm(final)=7.648 | 3709.0 samples/s | 58.0 steps/s
[Step=45500 Epoch=174.3] | Loss=0.00062 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=7.648 | 3703.2 samples/s | 57.9 steps/s
[Step=45550 Epoch=174.5] | Loss=0.00059 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.481 | L2-Norm(final)=7.648 | 1604.1 samples/s | 25.1 steps/s
[Step=45600 Epoch=174.7] | Loss=0.00056 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=7.648 | 3757.8 samples/s | 58.7 steps/s
[Step=45650 Epoch=174.9] | Loss=0.00054 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.477 | L2-Norm(final)=7.648 | 3719.2 samples/s | 58.1 steps/s
[Step=45700 Epoch=175.1] | Loss=0.00052 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.474 | L2-Norm(final)=7.648 | 3767.4 samples/s | 58.9 steps/s
[Step=45750 Epoch=175.3] | Loss=0.00050 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.471 | L2-Norm(final)=7.648 | 3666.7 samples/s | 57.3 steps/s
[Step=45800 Epoch=175.5] | Loss=0.00048 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.469 | L2-Norm(final)=7.648 | 5134.7 samples/s | 80.2 steps/s
[Step=45850 Epoch=175.7] | Loss=0.00046 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.466 | L2-Norm(final)=7.648 | 1380.6 samples/s | 21.6 steps/s
[Step=45900 Epoch=175.9] | Loss=0.00044 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.463 | L2-Norm(final)=7.648 | 3709.2 samples/s | 58.0 steps/s
[Step=45950 Epoch=176.1] | Loss=0.00043 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.460 | L2-Norm(final)=7.649 | 3684.0 samples/s | 57.6 steps/s
[Step=46000 Epoch=176.3] | Loss=0.00041 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.457 | L2-Norm(final)=7.649 | 3734.9 samples/s | 58.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step46000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=44001 Epoch=169.4] | Loss=0.00012 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.332 | L2-Norm(final)=8.189 | 3393.1 samples/s | 53.0 steps/s
[Step=44050 Epoch=169.6] | Loss=0.00048 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.357 | L2-Norm(final)=8.192 | 3687.3 samples/s | 57.6 steps/s
[Step=44100 Epoch=169.8] | Loss=0.00051 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.379 | L2-Norm(final)=8.196 | 4111.9 samples/s | 64.2 steps/s
[Step=44150 Epoch=170.0] | Loss=0.00044 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.398 | L2-Norm(final)=8.199 | 4144.1 samples/s | 64.8 steps/s
[Step=44200 Epoch=170.1] | Loss=0.00034 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.410 | L2-Norm(final)=8.202 | 4116.2 samples/s | 64.3 steps/s
[Step=44250 Epoch=170.3] | Loss=0.00029 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=8.204 | 5422.4 samples/s | 84.7 steps/s
[Step=44300 Epoch=170.5] | Loss=0.00024 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=8.207 | 1491.3 samples/s | 23.3 steps/s
[Step=44350 Epoch=170.7] | Loss=0.00021 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.420 | L2-Norm(final)=8.209 | 4146.7 samples/s | 64.8 steps/s
[Step=44400 Epoch=170.9] | Loss=0.00019 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=8.211 | 4091.1 samples/s | 63.9 steps/s
[Step=44450 Epoch=171.1] | Loss=0.00017 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.418 | L2-Norm(final)=8.213 | 4095.5 samples/s | 64.0 steps/s
[Step=44500 Epoch=171.3] | Loss=0.00015 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=8.215 | 4724.5 samples/s | 73.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=44501 Epoch=171.3] | Loss=0.00002 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.394 | L2-Norm(final)=8.234 | 3276.4 samples/s | 51.2 steps/s
[Step=44550 Epoch=171.5] | Loss=0.00249 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.391 | L2-Norm(final)=8.234 | 3377.0 samples/s | 52.8 steps/s
[Step=44600 Epoch=171.7] | Loss=0.00259 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.425 | L2-Norm(final)=8.225 | 3673.3 samples/s | 57.4 steps/s
[Step=44650 Epoch=171.9] | Loss=0.00200 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.445 | L2-Norm(final)=8.222 | 3689.8 samples/s | 57.7 steps/s
[Step=44700 Epoch=172.1] | Loss=0.00201 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.458 | L2-Norm(final)=8.219 | 3713.7 samples/s | 58.0 steps/s
[Step=44750 Epoch=172.3] | Loss=0.00172 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.468 | L2-Norm(final)=8.218 | 4706.9 samples/s | 73.5 steps/s
[Step=44800 Epoch=172.5] | Loss=0.00145 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=8.217 | 1418.8 samples/s | 22.2 steps/s
[Step=44850 Epoch=172.6] | Loss=0.00127 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=8.217 | 3742.1 samples/s | 58.5 steps/s
[Step=44900 Epoch=172.8] | Loss=0.00111 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=8.217 | 3691.8 samples/s | 57.7 steps/s
[Step=44950 Epoch=173.0] | Loss=0.00099 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=8.218 | 3696.0 samples/s | 57.7 steps/s
[Step=45000 Epoch=173.2] | Loss=0.00090 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=8.218 | 4264.3 samples/s | 66.6 steps/s
[Step=45050 Epoch=173.4] | Loss=0.00082 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=8.218 | 1486.5 samples/s | 23.2 steps/s
[Step=45100 Epoch=173.6] | Loss=0.00075 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=8.219 | 3739.3 samples/s | 58.4 steps/s
[Step=45150 Epoch=173.8] | Loss=0.00069 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.480 | L2-Norm(final)=8.219 | 3781.3 samples/s | 59.1 steps/s
[Step=45200 Epoch=174.0] | Loss=0.00064 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=8.220 | 3717.6 samples/s | 58.1 steps/s
[Step=45250 Epoch=174.2] | Loss=0.00060 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=8.220 | 3799.8 samples/s | 59.4 steps/s
[Step=45300 Epoch=174.4] | Loss=0.00056 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.474 | L2-Norm(final)=8.221 | 1552.9 samples/s | 24.3 steps/s
[Step=45350 Epoch=174.6] | Loss=0.00053 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.472 | L2-Norm(final)=8.221 | 3809.5 samples/s | 59.5 steps/s
[Step=45400 Epoch=174.8] | Loss=0.00050 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.469 | L2-Norm(final)=8.222 | 3706.8 samples/s | 57.9 steps/s
[Step=45450 Epoch=175.0] | Loss=0.00048 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.466 | L2-Norm(final)=8.222 | 3634.7 samples/s | 56.8 steps/s
[Step=45500 Epoch=175.1] | Loss=0.00045 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.463 | L2-Norm(final)=8.222 | 3780.6 samples/s | 59.1 steps/s
[Step=45550 Epoch=175.3] | Loss=0.00043 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.460 | L2-Norm(final)=8.223 | 1572.2 samples/s | 24.6 steps/s
[Step=45600 Epoch=175.5] | Loss=0.00041 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.457 | L2-Norm(final)=8.223 | 3757.0 samples/s | 58.7 steps/s
[Step=45650 Epoch=175.7] | Loss=0.00039 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.453 | L2-Norm(final)=8.224 | 3674.1 samples/s | 57.4 steps/s
[Step=45700 Epoch=175.9] | Loss=0.00038 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.450 | L2-Norm(final)=8.224 | 3728.9 samples/s | 58.3 steps/s
[Step=45750 Epoch=176.1] | Loss=0.00036 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.446 | L2-Norm(final)=8.225 | 3749.5 samples/s | 58.6 steps/s
[Step=45800 Epoch=176.3] | Loss=0.00035 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.443 | L2-Norm(final)=8.225 | 5138.7 samples/s | 80.3 steps/s
[Step=45850 Epoch=176.5] | Loss=0.00034 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=8.225 | 1394.3 samples/s | 21.8 steps/s
[Step=45900 Epoch=176.7] | Loss=0.00033 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.435 | L2-Norm(final)=8.226 | 3738.6 samples/s | 58.4 steps/s
[Step=45950 Epoch=176.9] | Loss=0.00031 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.431 | L2-Norm(final)=8.226 | 3733.3 samples/s | 58.3 steps/s
[Step=46000 Epoch=177.1] | Loss=0.00030 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.427 | L2-Norm(final)=8.227 | 3698.3 samples/s | 57.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step46000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06874 | acc=0.9694 | tpr=0.9775 | fpr=0.0483 | 3525.3 samples/s | 13.8 steps/s
Avg test loss: 0.07359, Avg test acc: 0.96859, Avg tpr: 0.97622, Avg fpr: 0.04820, total FA: 376

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06599 | acc=0.9695 | tpr=0.9741 | fpr=0.0406 | 3543.1 samples/s | 13.8 steps/s
Avg test loss: 0.07315, Avg test acc: 0.96682, Avg tpr: 0.97220, Avg fpr: 0.04499, total FA: 351

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=6.13905 | acc=0.3039 | tpr=0.0088 | fpr=0.0553 | 3525.1 samples/s | 13.8 steps/s
Avg test loss: 6.15110, Avg test acc: 0.30155, Avg tpr: 0.00991, Avg fpr: 0.05704, total FA: 445

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.35468 | acc=0.3142 | tpr=0.0265 | fpr=0.0610 | 3519.9 samples/s | 13.7 steps/s
Avg test loss: 5.36024, Avg test acc: 0.31076, Avg tpr: 0.02594, Avg fpr: 0.06281, total FA: 490

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.81263 | acc=0.0919 | tpr=0.8938 | fpr=0.9225 | 3494.0 samples/s | 13.6 steps/s
[Step= 100] | Loss=6.79295 | acc=0.0934 | tpr=0.8977 | fpr=0.9216 | 6756.4 samples/s | 26.4 steps/s
[Step= 150] | Loss=6.81634 | acc=0.0932 | tpr=0.8991 | fpr=0.9217 | 6860.7 samples/s | 26.8 steps/s
[Step= 200] | Loss=6.79465 | acc=0.0933 | tpr=0.8852 | fpr=0.9211 | 6886.9 samples/s | 26.9 steps/s
[Step= 250] | Loss=6.79344 | acc=0.0936 | tpr=0.8812 | fpr=0.9208 | 6927.6 samples/s | 27.1 steps/s
[Step= 300] | Loss=6.79707 | acc=0.0933 | tpr=0.8800 | fpr=0.9211 | 6849.4 samples/s | 26.8 steps/s
[Step= 350] | Loss=6.79616 | acc=0.0935 | tpr=0.8842 | fpr=0.9208 | 6860.6 samples/s | 26.8 steps/s
[Step= 400] | Loss=6.79183 | acc=0.0935 | tpr=0.8829 | fpr=0.9209 | 6909.8 samples/s | 27.0 steps/s
[Step= 450] | Loss=6.80056 | acc=0.0933 | tpr=0.8846 | fpr=0.9210 | 6680.6 samples/s | 26.1 steps/s
[Step= 500] | Loss=6.80401 | acc=0.0933 | tpr=0.8837 | fpr=0.9210 | 6724.6 samples/s | 26.3 steps/s
[Step= 550] | Loss=6.80405 | acc=0.0935 | tpr=0.8846 | fpr=0.9208 | 12779.0 samples/s | 49.9 steps/s
Avg test loss: 6.80581, Avg test acc: 0.09346, Avg tpr: 0.88391, Avg fpr: 0.92091, total FA: 127867

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.45724 | acc=0.1055 | tpr=0.8628 | fpr=0.9081 | 3506.2 samples/s | 13.7 steps/s
[Step= 100] | Loss=6.41418 | acc=0.1080 | tpr=0.8571 | fpr=0.9060 | 6852.6 samples/s | 26.8 steps/s
[Step= 150] | Loss=6.42578 | acc=0.1075 | tpr=0.8516 | fpr=0.9062 | 6713.3 samples/s | 26.2 steps/s
[Step= 200] | Loss=6.40993 | acc=0.1069 | tpr=0.8393 | fpr=0.9064 | 7139.6 samples/s | 27.9 steps/s
[Step= 250] | Loss=6.40949 | acc=0.1072 | tpr=0.8341 | fpr=0.9060 | 6839.3 samples/s | 26.7 steps/s
[Step= 300] | Loss=6.41411 | acc=0.1071 | tpr=0.8276 | fpr=0.9060 | 6891.5 samples/s | 26.9 steps/s
[Step= 350] | Loss=6.41179 | acc=0.1075 | tpr=0.8334 | fpr=0.9057 | 6781.8 samples/s | 26.5 steps/s
[Step= 400] | Loss=6.40793 | acc=0.1077 | tpr=0.8321 | fpr=0.9055 | 6756.1 samples/s | 26.4 steps/s
[Step= 450] | Loss=6.41409 | acc=0.1073 | tpr=0.8340 | fpr=0.9059 | 7090.0 samples/s | 27.7 steps/s
[Step= 500] | Loss=6.41687 | acc=0.1073 | tpr=0.8335 | fpr=0.9058 | 6448.5 samples/s | 25.2 steps/s
[Step= 550] | Loss=6.41604 | acc=0.1075 | tpr=0.8365 | fpr=0.9057 | 12673.8 samples/s | 49.5 steps/s
Avg test loss: 6.41789, Avg test acc: 0.10740, Avg tpr: 0.83637, Avg fpr: 0.90585, total FA: 125775

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11800 | acc=0.9816 | tpr=0.9248 | fpr=0.0173 | 3499.2 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.11846 | acc=0.9818 | tpr=0.9424 | fpr=0.0174 | 6842.5 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.12248 | acc=0.9811 | tpr=0.9467 | fpr=0.0183 | 6861.8 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.12415 | acc=0.9809 | tpr=0.9486 | fpr=0.0185 | 6950.9 samples/s | 27.2 steps/s
[Step= 250] | Loss=0.12257 | acc=0.9812 | tpr=0.9493 | fpr=0.0182 | 6832.1 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.12471 | acc=0.9809 | tpr=0.9440 | fpr=0.0184 | 6959.2 samples/s | 27.2 steps/s
[Step= 350] | Loss=0.12484 | acc=0.9808 | tpr=0.9443 | fpr=0.0186 | 6878.1 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.12626 | acc=0.9806 | tpr=0.9431 | fpr=0.0188 | 6532.1 samples/s | 25.5 steps/s
[Step= 450] | Loss=0.12869 | acc=0.9803 | tpr=0.9435 | fpr=0.0191 | 6978.4 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.12800 | acc=0.9804 | tpr=0.9467 | fpr=0.0190 | 6739.3 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.12710 | acc=0.9805 | tpr=0.9463 | fpr=0.0189 | 11897.6 samples/s | 46.5 steps/s
Avg test loss: 0.12705, Avg test acc: 0.98048, Avg tpr: 0.94572, Avg fpr: 0.01888, total FA: 2622

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11035 | acc=0.9817 | tpr=0.9425 | fpr=0.0176 | 3478.6 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.11403 | acc=0.9818 | tpr=0.9595 | fpr=0.0178 | 6767.4 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.11687 | acc=0.9807 | tpr=0.9553 | fpr=0.0189 | 6861.3 samples/s | 26.8 steps/s
[Step= 200] | Loss=0.11745 | acc=0.9806 | tpr=0.9563 | fpr=0.0189 | 6792.8 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.11685 | acc=0.9807 | tpr=0.9528 | fpr=0.0188 | 6772.9 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.11934 | acc=0.9803 | tpr=0.9513 | fpr=0.0192 | 6886.3 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.11894 | acc=0.9803 | tpr=0.9512 | fpr=0.0192 | 7096.6 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.12019 | acc=0.9802 | tpr=0.9497 | fpr=0.0193 | 6576.4 samples/s | 25.7 steps/s
[Step= 450] | Loss=0.12234 | acc=0.9799 | tpr=0.9460 | fpr=0.0195 | 6905.7 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.12173 | acc=0.9800 | tpr=0.9489 | fpr=0.0195 | 6644.4 samples/s | 26.0 steps/s
[Step= 550] | Loss=0.12104 | acc=0.9802 | tpr=0.9483 | fpr=0.0193 | 12760.9 samples/s | 49.8 steps/s
Avg test loss: 0.12094, Avg test acc: 0.98015, Avg tpr: 0.94770, Avg fpr: 0.01926, total FA: 2674

server round 23/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=46001 Epoch=89.7] | Loss=0.00275 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.383 | L2-Norm(final)=9.165 | 3063.9 samples/s | 47.9 steps/s
[Step=46050 Epoch=89.8] | Loss=0.01079 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.399 | L2-Norm(final)=9.169 | 4253.6 samples/s | 66.5 steps/s
[Step=46100 Epoch=89.9] | Loss=0.01056 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.414 | L2-Norm(final)=9.179 | 4302.9 samples/s | 67.2 steps/s
[Step=46150 Epoch=90.0] | Loss=0.00961 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.426 | L2-Norm(final)=9.189 | 4391.8 samples/s | 68.6 steps/s
[Step=46200 Epoch=90.1] | Loss=0.00943 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.436 | L2-Norm(final)=9.200 | 4255.4 samples/s | 66.5 steps/s
[Step=46250 Epoch=90.2] | Loss=0.01011 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.446 | L2-Norm(final)=9.209 | 4398.2 samples/s | 68.7 steps/s
[Step=46300 Epoch=90.3] | Loss=0.01020 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.455 | L2-Norm(final)=9.216 | 4330.3 samples/s | 67.7 steps/s
[Step=46350 Epoch=90.4] | Loss=0.01008 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=9.223 | 4387.0 samples/s | 68.5 steps/s
[Step=46400 Epoch=90.5] | Loss=0.00999 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.472 | L2-Norm(final)=9.229 | 4394.8 samples/s | 68.7 steps/s
[Step=46450 Epoch=90.6] | Loss=0.01000 | Reg=0.00156 | acc=0.9531 | L2-Norm=12.480 | L2-Norm(final)=9.236 | 4359.2 samples/s | 68.1 steps/s
[Step=46500 Epoch=90.7] | Loss=0.00976 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.487 | L2-Norm(final)=9.243 | 5591.0 samples/s | 87.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=46501 Epoch=90.7] | Loss=0.00100 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.560 | L2-Norm(final)=9.309 | 3069.8 samples/s | 48.0 steps/s
[Step=46550 Epoch=90.8] | Loss=0.00775 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.568 | L2-Norm(final)=9.317 | 3689.5 samples/s | 57.6 steps/s
[Step=46600 Epoch=90.9] | Loss=0.01218 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.581 | L2-Norm(final)=9.319 | 3922.1 samples/s | 61.3 steps/s
[Step=46650 Epoch=91.0] | Loss=0.01275 | Reg=0.00159 | acc=0.9688 | L2-Norm=12.594 | L2-Norm(final)=9.316 | 3905.3 samples/s | 61.0 steps/s
[Step=46700 Epoch=91.1] | Loss=0.01264 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.607 | L2-Norm(final)=9.316 | 3952.5 samples/s | 61.8 steps/s
[Step=46750 Epoch=91.2] | Loss=0.01199 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.618 | L2-Norm(final)=9.317 | 3941.4 samples/s | 61.6 steps/s
[Step=46800 Epoch=91.3] | Loss=0.01245 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.628 | L2-Norm(final)=9.319 | 3956.1 samples/s | 61.8 steps/s
[Step=46850 Epoch=91.4] | Loss=0.01208 | Reg=0.00160 | acc=0.9688 | L2-Norm=12.637 | L2-Norm(final)=9.321 | 3948.1 samples/s | 61.7 steps/s
[Step=46900 Epoch=91.5] | Loss=0.01193 | Reg=0.00160 | acc=0.9688 | L2-Norm=12.645 | L2-Norm(final)=9.323 | 3946.0 samples/s | 61.7 steps/s
[Step=46950 Epoch=91.6] | Loss=0.01181 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.652 | L2-Norm(final)=9.324 | 3972.1 samples/s | 62.1 steps/s
[Step=47000 Epoch=91.7] | Loss=0.01187 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.659 | L2-Norm(final)=9.327 | 4832.8 samples/s | 75.5 steps/s
[Step=47050 Epoch=91.8] | Loss=0.01154 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.666 | L2-Norm(final)=9.329 | 1461.7 samples/s | 22.8 steps/s
[Step=47100 Epoch=91.9] | Loss=0.01122 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=9.331 | 3937.4 samples/s | 61.5 steps/s
[Step=47150 Epoch=92.0] | Loss=0.01125 | Reg=0.00161 | acc=0.9688 | L2-Norm=12.678 | L2-Norm(final)=9.334 | 3898.4 samples/s | 60.9 steps/s
[Step=47200 Epoch=92.1] | Loss=0.01087 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.684 | L2-Norm(final)=9.336 | 3917.1 samples/s | 61.2 steps/s
[Step=47250 Epoch=92.2] | Loss=0.01064 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.689 | L2-Norm(final)=9.338 | 3962.8 samples/s | 61.9 steps/s
[Step=47300 Epoch=92.3] | Loss=0.01044 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.694 | L2-Norm(final)=9.341 | 3939.6 samples/s | 61.6 steps/s
[Step=47350 Epoch=92.4] | Loss=0.01021 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.698 | L2-Norm(final)=9.343 | 4002.6 samples/s | 62.5 steps/s
[Step=47400 Epoch=92.4] | Loss=0.01029 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.703 | L2-Norm(final)=9.345 | 3938.7 samples/s | 61.5 steps/s
[Step=47450 Epoch=92.5] | Loss=0.01011 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.707 | L2-Norm(final)=9.347 | 3984.8 samples/s | 62.3 steps/s
[Step=47500 Epoch=92.6] | Loss=0.01006 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.710 | L2-Norm(final)=9.349 | 4112.1 samples/s | 64.3 steps/s
[Step=47550 Epoch=92.7] | Loss=0.00994 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.714 | L2-Norm(final)=9.350 | 1567.9 samples/s | 24.5 steps/s
[Step=47600 Epoch=92.8] | Loss=0.00972 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.717 | L2-Norm(final)=9.352 | 3989.5 samples/s | 62.3 steps/s
[Step=47650 Epoch=92.9] | Loss=0.00953 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.721 | L2-Norm(final)=9.354 | 3922.8 samples/s | 61.3 steps/s
[Step=47700 Epoch=93.0] | Loss=0.00942 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.724 | L2-Norm(final)=9.356 | 3951.5 samples/s | 61.7 steps/s
[Step=47750 Epoch=93.1] | Loss=0.00926 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.727 | L2-Norm(final)=9.357 | 3908.6 samples/s | 61.1 steps/s
[Step=47800 Epoch=93.2] | Loss=0.00920 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.730 | L2-Norm(final)=9.359 | 3955.7 samples/s | 61.8 steps/s
[Step=47850 Epoch=93.3] | Loss=0.00921 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.733 | L2-Norm(final)=9.361 | 3937.9 samples/s | 61.5 steps/s
[Step=47900 Epoch=93.4] | Loss=0.00910 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.736 | L2-Norm(final)=9.363 | 3985.9 samples/s | 62.3 steps/s
[Step=47950 Epoch=93.5] | Loss=0.00898 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.738 | L2-Norm(final)=9.365 | 3891.0 samples/s | 60.8 steps/s
[Step=48000 Epoch=93.6] | Loss=0.00889 | Reg=0.00162 | acc=0.9531 | L2-Norm=12.741 | L2-Norm(final)=9.366 | 3933.4 samples/s | 61.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step48000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=46001 Epoch=89.9] | Loss=0.01293 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.383 | L2-Norm(final)=9.457 | 3289.4 samples/s | 51.4 steps/s
[Step=46050 Epoch=90.0] | Loss=0.01417 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.395 | L2-Norm(final)=9.462 | 4174.6 samples/s | 65.2 steps/s
[Step=46100 Epoch=90.1] | Loss=0.01114 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.409 | L2-Norm(final)=9.473 | 4358.6 samples/s | 68.1 steps/s
[Step=46150 Epoch=90.2] | Loss=0.00984 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.419 | L2-Norm(final)=9.485 | 4256.2 samples/s | 66.5 steps/s
[Step=46200 Epoch=90.3] | Loss=0.01022 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.427 | L2-Norm(final)=9.495 | 4412.8 samples/s | 69.0 steps/s
[Step=46250 Epoch=90.4] | Loss=0.00995 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.435 | L2-Norm(final)=9.503 | 4325.0 samples/s | 67.6 steps/s
[Step=46300 Epoch=90.5] | Loss=0.01022 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.442 | L2-Norm(final)=9.510 | 4426.0 samples/s | 69.2 steps/s
[Step=46350 Epoch=90.6] | Loss=0.01021 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.448 | L2-Norm(final)=9.517 | 4342.4 samples/s | 67.9 steps/s
[Step=46400 Epoch=90.7] | Loss=0.00994 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.454 | L2-Norm(final)=9.523 | 4388.5 samples/s | 68.6 steps/s
[Step=46450 Epoch=90.8] | Loss=0.00990 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.461 | L2-Norm(final)=9.530 | 4437.6 samples/s | 69.3 steps/s
[Step=46500 Epoch=90.9] | Loss=0.00978 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.467 | L2-Norm(final)=9.537 | 5524.9 samples/s | 86.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=46501 Epoch=90.9] | Loss=0.00276 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.529 | L2-Norm(final)=9.605 | 3256.0 samples/s | 50.9 steps/s
[Step=46550 Epoch=91.0] | Loss=0.01018 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.540 | L2-Norm(final)=9.613 | 3763.5 samples/s | 58.8 steps/s
[Step=46600 Epoch=91.1] | Loss=0.01095 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.553 | L2-Norm(final)=9.614 | 3979.4 samples/s | 62.2 steps/s
[Step=46650 Epoch=91.2] | Loss=0.01110 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.563 | L2-Norm(final)=9.613 | 3954.5 samples/s | 61.8 steps/s
[Step=46700 Epoch=91.3] | Loss=0.01196 | Reg=0.00158 | acc=0.9688 | L2-Norm=12.571 | L2-Norm(final)=9.614 | 3902.6 samples/s | 61.0 steps/s
[Step=46750 Epoch=91.4] | Loss=0.01178 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.579 | L2-Norm(final)=9.614 | 3964.6 samples/s | 61.9 steps/s
[Step=46800 Epoch=91.5] | Loss=0.01147 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.587 | L2-Norm(final)=9.615 | 3972.1 samples/s | 62.1 steps/s
[Step=46850 Epoch=91.6] | Loss=0.01103 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.594 | L2-Norm(final)=9.616 | 3941.7 samples/s | 61.6 steps/s
[Step=46900 Epoch=91.7] | Loss=0.01097 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.601 | L2-Norm(final)=9.617 | 3931.5 samples/s | 61.4 steps/s
[Step=46950 Epoch=91.8] | Loss=0.01112 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.608 | L2-Norm(final)=9.618 | 3955.1 samples/s | 61.8 steps/s
[Step=47000 Epoch=91.9] | Loss=0.01105 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.614 | L2-Norm(final)=9.619 | 4883.4 samples/s | 76.3 steps/s
[Step=47050 Epoch=92.0] | Loss=0.01071 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.620 | L2-Norm(final)=9.621 | 1501.8 samples/s | 23.5 steps/s
[Step=47100 Epoch=92.1] | Loss=0.01053 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.625 | L2-Norm(final)=9.623 | 3968.4 samples/s | 62.0 steps/s
[Step=47150 Epoch=92.2] | Loss=0.01027 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.630 | L2-Norm(final)=9.624 | 3954.9 samples/s | 61.8 steps/s
[Step=47200 Epoch=92.3] | Loss=0.01003 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.635 | L2-Norm(final)=9.626 | 3964.2 samples/s | 61.9 steps/s
[Step=47250 Epoch=92.4] | Loss=0.00994 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.640 | L2-Norm(final)=9.628 | 3904.3 samples/s | 61.0 steps/s
[Step=47300 Epoch=92.5] | Loss=0.00971 | Reg=0.00160 | acc=0.9688 | L2-Norm=12.645 | L2-Norm(final)=9.630 | 3933.0 samples/s | 61.5 steps/s
[Step=47350 Epoch=92.6] | Loss=0.00966 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.649 | L2-Norm(final)=9.632 | 3981.4 samples/s | 62.2 steps/s
[Step=47400 Epoch=92.7] | Loss=0.00967 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.654 | L2-Norm(final)=9.634 | 3977.7 samples/s | 62.2 steps/s
[Step=47450 Epoch=92.8] | Loss=0.00962 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.658 | L2-Norm(final)=9.635 | 3977.8 samples/s | 62.2 steps/s
[Step=47500 Epoch=92.9] | Loss=0.00957 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.662 | L2-Norm(final)=9.637 | 4301.7 samples/s | 67.2 steps/s
[Step=47550 Epoch=93.0] | Loss=0.00931 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.666 | L2-Norm(final)=9.638 | 1579.1 samples/s | 24.7 steps/s
[Step=47600 Epoch=93.1] | Loss=0.00913 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.670 | L2-Norm(final)=9.640 | 3907.8 samples/s | 61.1 steps/s
[Step=47650 Epoch=93.2] | Loss=0.00902 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=9.641 | 3912.4 samples/s | 61.1 steps/s
[Step=47700 Epoch=93.3] | Loss=0.00893 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.677 | L2-Norm(final)=9.643 | 3962.8 samples/s | 61.9 steps/s
[Step=47750 Epoch=93.4] | Loss=0.00885 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.680 | L2-Norm(final)=9.644 | 3943.1 samples/s | 61.6 steps/s
[Step=47800 Epoch=93.4] | Loss=0.00892 | Reg=0.00161 | acc=0.9688 | L2-Norm=12.683 | L2-Norm(final)=9.646 | 3962.2 samples/s | 61.9 steps/s
[Step=47850 Epoch=93.5] | Loss=0.00879 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=9.647 | 3956.1 samples/s | 61.8 steps/s
[Step=47900 Epoch=93.6] | Loss=0.00873 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.690 | L2-Norm(final)=9.648 | 3936.7 samples/s | 61.5 steps/s
[Step=47950 Epoch=93.7] | Loss=0.00866 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.693 | L2-Norm(final)=9.649 | 3906.8 samples/s | 61.0 steps/s
[Step=48000 Epoch=93.8] | Loss=0.00861 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.697 | L2-Norm(final)=9.651 | 3884.5 samples/s | 60.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step48000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=46001 Epoch=176.3] | Loss=0.00003 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.383 | L2-Norm(final)=7.654 | 3340.1 samples/s | 52.2 steps/s
[Step=46050 Epoch=176.4] | Loss=0.00018 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.383 | L2-Norm(final)=7.657 | 3670.1 samples/s | 57.3 steps/s
[Step=46100 Epoch=176.6] | Loss=0.00013 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.384 | L2-Norm(final)=7.660 | 4120.0 samples/s | 64.4 steps/s
[Step=46150 Epoch=176.8] | Loss=0.00010 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.383 | L2-Norm(final)=7.663 | 4101.0 samples/s | 64.1 steps/s
[Step=46200 Epoch=177.0] | Loss=0.00009 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.382 | L2-Norm(final)=7.665 | 4076.1 samples/s | 63.7 steps/s
[Step=46250 Epoch=177.2] | Loss=0.00008 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.380 | L2-Norm(final)=7.668 | 5337.4 samples/s | 83.4 steps/s
[Step=46300 Epoch=177.4] | Loss=0.00007 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.379 | L2-Norm(final)=7.670 | 1508.2 samples/s | 23.6 steps/s
[Step=46350 Epoch=177.6] | Loss=0.00006 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.377 | L2-Norm(final)=7.673 | 4132.2 samples/s | 64.6 steps/s
[Step=46400 Epoch=177.8] | Loss=0.00006 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.375 | L2-Norm(final)=7.675 | 4122.4 samples/s | 64.4 steps/s
[Step=46450 Epoch=178.0] | Loss=0.00006 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=7.677 | 4147.3 samples/s | 64.8 steps/s
[Step=46500 Epoch=178.2] | Loss=0.00005 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=7.679 | 4442.3 samples/s | 69.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=46501 Epoch=178.2] | Loss=0.00008 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.348 | L2-Norm(final)=7.701 | 3276.9 samples/s | 51.2 steps/s
[Step=46550 Epoch=178.4] | Loss=0.00003 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.344 | L2-Norm(final)=7.703 | 3489.7 samples/s | 54.5 steps/s
[Step=46600 Epoch=178.6] | Loss=0.00002 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.339 | L2-Norm(final)=7.705 | 3739.2 samples/s | 58.4 steps/s
[Step=46650 Epoch=178.7] | Loss=0.00002 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.334 | L2-Norm(final)=7.707 | 3734.9 samples/s | 58.4 steps/s
[Step=46700 Epoch=178.9] | Loss=0.00002 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.328 | L2-Norm(final)=7.708 | 3698.5 samples/s | 57.8 steps/s
[Step=46750 Epoch=179.1] | Loss=0.00002 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.323 | L2-Norm(final)=7.710 | 4782.2 samples/s | 74.7 steps/s
[Step=46800 Epoch=179.3] | Loss=0.00002 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.317 | L2-Norm(final)=7.711 | 1471.9 samples/s | 23.0 steps/s
[Step=46850 Epoch=179.5] | Loss=0.00002 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=7.712 | 3762.9 samples/s | 58.8 steps/s
[Step=46900 Epoch=179.7] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.305 | L2-Norm(final)=7.714 | 3733.9 samples/s | 58.3 steps/s
[Step=46950 Epoch=179.9] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.299 | L2-Norm(final)=7.715 | 3799.5 samples/s | 59.4 steps/s
[Step=47000 Epoch=180.1] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.293 | L2-Norm(final)=7.716 | 4057.6 samples/s | 63.4 steps/s
[Step=47050 Epoch=180.3] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=7.717 | 1538.5 samples/s | 24.0 steps/s
[Step=47100 Epoch=180.5] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.281 | L2-Norm(final)=7.718 | 3744.6 samples/s | 58.5 steps/s
[Step=47150 Epoch=180.7] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.275 | L2-Norm(final)=7.720 | 3712.0 samples/s | 58.0 steps/s
[Step=47200 Epoch=180.9] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=7.721 | 3721.6 samples/s | 58.1 steps/s
[Step=47250 Epoch=181.0] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=7.722 | 3767.7 samples/s | 58.9 steps/s
[Step=47300 Epoch=181.2] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=7.723 | 1580.3 samples/s | 24.7 steps/s
[Step=47350 Epoch=181.4] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.249 | L2-Norm(final)=7.724 | 3783.3 samples/s | 59.1 steps/s
[Step=47400 Epoch=181.6] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.243 | L2-Norm(final)=7.725 | 3758.6 samples/s | 58.7 steps/s
[Step=47450 Epoch=181.8] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=7.726 | 3715.6 samples/s | 58.1 steps/s
[Step=47500 Epoch=182.0] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.229 | L2-Norm(final)=7.727 | 3717.2 samples/s | 58.1 steps/s
[Step=47550 Epoch=182.2] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=7.728 | 1596.2 samples/s | 24.9 steps/s
[Step=47600 Epoch=182.4] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.216 | L2-Norm(final)=7.729 | 3753.6 samples/s | 58.6 steps/s
[Step=47650 Epoch=182.6] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.209 | L2-Norm(final)=7.730 | 3688.3 samples/s | 57.6 steps/s
[Step=47700 Epoch=182.8] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.202 | L2-Norm(final)=7.731 | 3664.5 samples/s | 57.3 steps/s
[Step=47750 Epoch=183.0] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.195 | L2-Norm(final)=7.732 | 3738.2 samples/s | 58.4 steps/s
[Step=47800 Epoch=183.2] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.188 | L2-Norm(final)=7.734 | 5221.4 samples/s | 81.6 steps/s
[Step=47850 Epoch=183.3] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.181 | L2-Norm(final)=7.735 | 1402.4 samples/s | 21.9 steps/s
[Step=47900 Epoch=183.5] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=7.736 | 3707.7 samples/s | 57.9 steps/s
[Step=47950 Epoch=183.7] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=7.737 | 3729.8 samples/s | 58.3 steps/s
[Step=48000 Epoch=183.9] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=7.738 | 3773.2 samples/s | 59.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step48000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=46001 Epoch=177.1] | Loss=0.00014 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.383 | L2-Norm(final)=8.239 | 3043.4 samples/s | 47.6 steps/s
[Step=46050 Epoch=177.3] | Loss=0.00057 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.396 | L2-Norm(final)=8.245 | 4070.8 samples/s | 63.6 steps/s
[Step=46100 Epoch=177.5] | Loss=0.00033 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.406 | L2-Norm(final)=8.250 | 4123.5 samples/s | 64.4 steps/s
[Step=46150 Epoch=177.6] | Loss=0.00025 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.409 | L2-Norm(final)=8.254 | 4122.7 samples/s | 64.4 steps/s
[Step=46200 Epoch=177.8] | Loss=0.00020 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.410 | L2-Norm(final)=8.258 | 4103.9 samples/s | 64.1 steps/s
[Step=46250 Epoch=178.0] | Loss=0.00017 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.409 | L2-Norm(final)=8.261 | 5428.2 samples/s | 84.8 steps/s
[Step=46300 Epoch=178.2] | Loss=0.00015 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.407 | L2-Norm(final)=8.264 | 1531.6 samples/s | 23.9 steps/s
[Step=46350 Epoch=178.4] | Loss=0.00013 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.406 | L2-Norm(final)=8.266 | 4122.8 samples/s | 64.4 steps/s
[Step=46400 Epoch=178.6] | Loss=0.00012 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.404 | L2-Norm(final)=8.269 | 4048.6 samples/s | 63.3 steps/s
[Step=46450 Epoch=178.8] | Loss=0.00011 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.401 | L2-Norm(final)=8.271 | 4074.0 samples/s | 63.7 steps/s
[Step=46500 Epoch=179.0] | Loss=0.00010 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.399 | L2-Norm(final)=8.274 | 4775.0 samples/s | 74.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=46501 Epoch=179.0] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.376 | L2-Norm(final)=8.299 | 3320.8 samples/s | 51.9 steps/s
[Step=46550 Epoch=179.2] | Loss=0.00002 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=8.301 | 3459.4 samples/s | 54.1 steps/s
[Step=46600 Epoch=179.4] | Loss=0.00002 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.365 | L2-Norm(final)=8.303 | 3687.2 samples/s | 57.6 steps/s
[Step=46650 Epoch=179.6] | Loss=0.00002 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.359 | L2-Norm(final)=8.305 | 3760.3 samples/s | 58.8 steps/s
[Step=46700 Epoch=179.8] | Loss=0.00002 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.353 | L2-Norm(final)=8.307 | 3758.9 samples/s | 58.7 steps/s
[Step=46750 Epoch=180.0] | Loss=0.00002 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.346 | L2-Norm(final)=8.309 | 4818.6 samples/s | 75.3 steps/s
[Step=46800 Epoch=180.2] | Loss=0.00002 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.339 | L2-Norm(final)=8.310 | 1433.0 samples/s | 22.4 steps/s
[Step=46850 Epoch=180.3] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.333 | L2-Norm(final)=8.312 | 3798.4 samples/s | 59.3 steps/s
[Step=46900 Epoch=180.5] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.326 | L2-Norm(final)=8.313 | 3781.6 samples/s | 59.1 steps/s
[Step=46950 Epoch=180.7] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.319 | L2-Norm(final)=8.314 | 3702.3 samples/s | 57.8 steps/s
[Step=47000 Epoch=180.9] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.312 | L2-Norm(final)=8.315 | 4242.7 samples/s | 66.3 steps/s
[Step=47050 Epoch=181.1] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=8.316 | 1486.1 samples/s | 23.2 steps/s
[Step=47100 Epoch=181.3] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=8.317 | 3718.2 samples/s | 58.1 steps/s
[Step=47150 Epoch=181.5] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.290 | L2-Norm(final)=8.318 | 3744.7 samples/s | 58.5 steps/s
[Step=47200 Epoch=181.7] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.282 | L2-Norm(final)=8.319 | 3685.4 samples/s | 57.6 steps/s
[Step=47250 Epoch=181.9] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.275 | L2-Norm(final)=8.320 | 3813.2 samples/s | 59.6 steps/s
[Step=47300 Epoch=182.1] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.267 | L2-Norm(final)=8.321 | 1602.6 samples/s | 25.0 steps/s
[Step=47350 Epoch=182.3] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=8.322 | 3730.5 samples/s | 58.3 steps/s
[Step=47400 Epoch=182.5] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.252 | L2-Norm(final)=8.323 | 3740.9 samples/s | 58.5 steps/s
[Step=47450 Epoch=182.7] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=8.324 | 3803.9 samples/s | 59.4 steps/s
[Step=47500 Epoch=182.8] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=8.325 | 3753.2 samples/s | 58.6 steps/s
[Step=47550 Epoch=183.0] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=8.326 | 1565.6 samples/s | 24.5 steps/s
[Step=47600 Epoch=183.2] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.220 | L2-Norm(final)=8.327 | 3740.5 samples/s | 58.4 steps/s
[Step=47650 Epoch=183.4] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=8.328 | 3679.5 samples/s | 57.5 steps/s
[Step=47700 Epoch=183.6] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.203 | L2-Norm(final)=8.329 | 3749.0 samples/s | 58.6 steps/s
[Step=47750 Epoch=183.8] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.195 | L2-Norm(final)=8.330 | 3728.1 samples/s | 58.3 steps/s
[Step=47800 Epoch=184.0] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.186 | L2-Norm(final)=8.331 | 5482.9 samples/s | 85.7 steps/s
[Step=47850 Epoch=184.2] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=8.332 | 1417.9 samples/s | 22.2 steps/s
[Step=47900 Epoch=184.4] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=8.333 | 3666.4 samples/s | 57.3 steps/s
[Step=47950 Epoch=184.6] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=8.334 | 3717.2 samples/s | 58.1 steps/s
[Step=48000 Epoch=184.8] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=8.335 | 3759.4 samples/s | 58.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step48000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07010 | acc=0.9705 | tpr=0.9775 | fpr=0.0448 | 3483.2 samples/s | 13.6 steps/s
Avg test loss: 0.07578, Avg test acc: 0.96851, Avg tpr: 0.97500, Avg fpr: 0.04576, total FA: 357

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06745 | acc=0.9720 | tpr=0.9779 | fpr=0.0406 | 3584.1 samples/s | 14.0 steps/s
Avg test loss: 0.07821, Avg test acc: 0.96907, Avg tpr: 0.97581, Avg fpr: 0.04576, total FA: 357

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.54898 | acc=0.3141 | tpr=0.0165 | fpr=0.0396 | 3494.0 samples/s | 13.6 steps/s
Avg test loss: 5.55972, Avg test acc: 0.31192, Avg tpr: 0.01719, Avg fpr: 0.03987, total FA: 311

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.03946 | acc=0.3159 | tpr=0.0208 | fpr=0.0434 | 3458.3 samples/s | 13.5 steps/s
Avg test loss: 5.04951, Avg test acc: 0.31333, Avg tpr: 0.02104, Avg fpr: 0.04384, total FA: 342

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.70941 | acc=0.0994 | tpr=0.8584 | fpr=0.9143 | 3525.2 samples/s | 13.8 steps/s
[Step= 100] | Loss=6.68168 | acc=0.1003 | tpr=0.8678 | fpr=0.9140 | 6815.3 samples/s | 26.6 steps/s
[Step= 150] | Loss=6.70037 | acc=0.0994 | tpr=0.8660 | fpr=0.9147 | 6875.0 samples/s | 26.9 steps/s
[Step= 200] | Loss=6.68146 | acc=0.0996 | tpr=0.8492 | fpr=0.9140 | 6742.5 samples/s | 26.3 steps/s
[Step= 250] | Loss=6.67822 | acc=0.1000 | tpr=0.8428 | fpr=0.9135 | 6886.1 samples/s | 26.9 steps/s
[Step= 300] | Loss=6.67947 | acc=0.1001 | tpr=0.8451 | fpr=0.9135 | 6920.8 samples/s | 27.0 steps/s
[Step= 350] | Loss=6.67934 | acc=0.1001 | tpr=0.8497 | fpr=0.9135 | 6723.7 samples/s | 26.3 steps/s
[Step= 400] | Loss=6.67588 | acc=0.1001 | tpr=0.8479 | fpr=0.9135 | 6822.3 samples/s | 26.6 steps/s
[Step= 450] | Loss=6.68335 | acc=0.1000 | tpr=0.8515 | fpr=0.9137 | 6867.6 samples/s | 26.8 steps/s
[Step= 500] | Loss=6.68652 | acc=0.1001 | tpr=0.8511 | fpr=0.9135 | 6787.9 samples/s | 26.5 steps/s
[Step= 550] | Loss=6.68754 | acc=0.1004 | tpr=0.8544 | fpr=0.9133 | 12611.6 samples/s | 49.3 steps/s
Avg test loss: 6.68973, Avg test acc: 0.10029, Avg tpr: 0.85380, Avg fpr: 0.91341, total FA: 126825

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.04065 | acc=0.1044 | tpr=0.8274 | fpr=0.9086 | 3498.4 samples/s | 13.7 steps/s
[Step= 100] | Loss=7.00161 | acc=0.1070 | tpr=0.8337 | fpr=0.9066 | 7121.7 samples/s | 27.8 steps/s
[Step= 150] | Loss=7.01821 | acc=0.1068 | tpr=0.8372 | fpr=0.9066 | 6522.8 samples/s | 25.5 steps/s
[Step= 200] | Loss=7.00039 | acc=0.1064 | tpr=0.8230 | fpr=0.9066 | 6822.1 samples/s | 26.6 steps/s
[Step= 250] | Loss=6.99636 | acc=0.1067 | tpr=0.8166 | fpr=0.9063 | 6899.5 samples/s | 27.0 steps/s
[Step= 300] | Loss=6.99734 | acc=0.1063 | tpr=0.8145 | fpr=0.9066 | 7173.9 samples/s | 28.0 steps/s
[Step= 350] | Loss=6.99588 | acc=0.1066 | tpr=0.8209 | fpr=0.9064 | 6572.9 samples/s | 25.7 steps/s
[Step= 400] | Loss=6.99483 | acc=0.1066 | tpr=0.8140 | fpr=0.9063 | 6787.3 samples/s | 26.5 steps/s
[Step= 450] | Loss=7.00294 | acc=0.1064 | tpr=0.8174 | fpr=0.9065 | 6617.6 samples/s | 25.8 steps/s
[Step= 500] | Loss=7.00567 | acc=0.1063 | tpr=0.8167 | fpr=0.9065 | 6873.3 samples/s | 26.8 steps/s
[Step= 550] | Loss=7.00650 | acc=0.1063 | tpr=0.8189 | fpr=0.9066 | 12411.1 samples/s | 48.5 steps/s
Avg test loss: 7.00819, Avg test acc: 0.10624, Avg tpr: 0.81854, Avg fpr: 0.90670, total FA: 125894

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11832 | acc=0.9814 | tpr=0.9425 | fpr=0.0179 | 3602.2 samples/s | 14.1 steps/s
[Step= 100] | Loss=0.12019 | acc=0.9814 | tpr=0.9531 | fpr=0.0181 | 7056.5 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.12346 | acc=0.9806 | tpr=0.9481 | fpr=0.0188 | 6371.7 samples/s | 24.9 steps/s
[Step= 200] | Loss=0.12434 | acc=0.9808 | tpr=0.9486 | fpr=0.0186 | 6877.1 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.12256 | acc=0.9812 | tpr=0.9485 | fpr=0.0182 | 7031.7 samples/s | 27.5 steps/s
[Step= 300] | Loss=0.12496 | acc=0.9809 | tpr=0.9484 | fpr=0.0185 | 7041.8 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.12462 | acc=0.9809 | tpr=0.9487 | fpr=0.0185 | 6572.8 samples/s | 25.7 steps/s
[Step= 400] | Loss=0.12623 | acc=0.9808 | tpr=0.9464 | fpr=0.0186 | 6777.5 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.12876 | acc=0.9805 | tpr=0.9450 | fpr=0.0189 | 6727.0 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.12848 | acc=0.9805 | tpr=0.9476 | fpr=0.0189 | 6839.2 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.12775 | acc=0.9807 | tpr=0.9475 | fpr=0.0187 | 12442.3 samples/s | 48.6 steps/s
Avg test loss: 0.12764, Avg test acc: 0.98065, Avg tpr: 0.94691, Avg fpr: 0.01874, total FA: 2602

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12633 | acc=0.9807 | tpr=0.9381 | fpr=0.0185 | 3509.3 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.12862 | acc=0.9805 | tpr=0.9595 | fpr=0.0191 | 6960.1 samples/s | 27.2 steps/s
[Step= 150] | Loss=0.13201 | acc=0.9795 | tpr=0.9553 | fpr=0.0200 | 6780.1 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.13270 | acc=0.9797 | tpr=0.9552 | fpr=0.0198 | 6817.3 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.13123 | acc=0.9799 | tpr=0.9537 | fpr=0.0197 | 6828.6 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.13403 | acc=0.9796 | tpr=0.9542 | fpr=0.0200 | 6959.6 samples/s | 27.2 steps/s
[Step= 350] | Loss=0.13371 | acc=0.9795 | tpr=0.9537 | fpr=0.0200 | 6952.3 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.13540 | acc=0.9794 | tpr=0.9524 | fpr=0.0201 | 6714.5 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.13801 | acc=0.9791 | tpr=0.9508 | fpr=0.0204 | 6670.2 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.13764 | acc=0.9791 | tpr=0.9529 | fpr=0.0204 | 6717.0 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.13663 | acc=0.9793 | tpr=0.9526 | fpr=0.0202 | 12621.9 samples/s | 49.3 steps/s
Avg test loss: 0.13653, Avg test acc: 0.97930, Avg tpr: 0.95206, Avg fpr: 0.02021, total FA: 2806

server round 24/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=48001 Epoch=93.6] | Loss=0.00201 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.270 | L2-Norm(final)=9.424 | 3044.5 samples/s | 47.6 steps/s
[Step=48050 Epoch=93.7] | Loss=0.00787 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.286 | L2-Norm(final)=9.425 | 4228.8 samples/s | 66.1 steps/s
[Step=48100 Epoch=93.8] | Loss=0.00949 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=9.427 | 4345.4 samples/s | 67.9 steps/s
[Step=48150 Epoch=93.9] | Loss=0.00891 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=9.429 | 4425.4 samples/s | 69.1 steps/s
[Step=48200 Epoch=94.0] | Loss=0.00814 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.306 | L2-Norm(final)=9.434 | 4247.0 samples/s | 66.4 steps/s
[Step=48250 Epoch=94.1] | Loss=0.00867 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.311 | L2-Norm(final)=9.438 | 4398.5 samples/s | 68.7 steps/s
[Step=48300 Epoch=94.2] | Loss=0.00871 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.316 | L2-Norm(final)=9.442 | 4384.7 samples/s | 68.5 steps/s
[Step=48350 Epoch=94.3] | Loss=0.00836 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.321 | L2-Norm(final)=9.445 | 4436.9 samples/s | 69.3 steps/s
[Step=48400 Epoch=94.4] | Loss=0.00808 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.325 | L2-Norm(final)=9.450 | 4342.3 samples/s | 67.8 steps/s
[Step=48450 Epoch=94.5] | Loss=0.00786 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.330 | L2-Norm(final)=9.454 | 4353.0 samples/s | 68.0 steps/s
[Step=48500 Epoch=94.6] | Loss=0.00776 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.335 | L2-Norm(final)=9.459 | 5457.5 samples/s | 85.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=48501 Epoch=94.6] | Loss=0.03484 | Reg=0.00153 | acc=0.9688 | L2-Norm=12.381 | L2-Norm(final)=9.511 | 3020.5 samples/s | 47.2 steps/s
[Step=48550 Epoch=94.7] | Loss=0.00876 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.387 | L2-Norm(final)=9.514 | 3820.6 samples/s | 59.7 steps/s
[Step=48600 Epoch=94.8] | Loss=0.00970 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.397 | L2-Norm(final)=9.516 | 3900.4 samples/s | 60.9 steps/s
[Step=48650 Epoch=94.9] | Loss=0.01123 | Reg=0.00154 | acc=0.9688 | L2-Norm=12.408 | L2-Norm(final)=9.518 | 3868.4 samples/s | 60.4 steps/s
[Step=48700 Epoch=95.0] | Loss=0.01120 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.418 | L2-Norm(final)=9.520 | 3917.9 samples/s | 61.2 steps/s
[Step=48750 Epoch=95.1] | Loss=0.01110 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.427 | L2-Norm(final)=9.523 | 3874.9 samples/s | 60.5 steps/s
[Step=48800 Epoch=95.2] | Loss=0.01108 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.435 | L2-Norm(final)=9.525 | 3972.6 samples/s | 62.1 steps/s
[Step=48850 Epoch=95.3] | Loss=0.01098 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.442 | L2-Norm(final)=9.527 | 3993.1 samples/s | 62.4 steps/s
[Step=48900 Epoch=95.4] | Loss=0.01050 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.449 | L2-Norm(final)=9.530 | 3952.7 samples/s | 61.8 steps/s
[Step=48950 Epoch=95.5] | Loss=0.01041 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.456 | L2-Norm(final)=9.533 | 3907.9 samples/s | 61.1 steps/s
[Step=49000 Epoch=95.6] | Loss=0.01022 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.462 | L2-Norm(final)=9.535 | 4815.0 samples/s | 75.2 steps/s
[Step=49050 Epoch=95.7] | Loss=0.00999 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.468 | L2-Norm(final)=9.538 | 1508.2 samples/s | 23.6 steps/s
[Step=49100 Epoch=95.8] | Loss=0.00981 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.473 | L2-Norm(final)=9.540 | 3925.5 samples/s | 61.3 steps/s
[Step=49150 Epoch=95.9] | Loss=0.00952 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=9.543 | 3977.3 samples/s | 62.1 steps/s
[Step=49200 Epoch=96.0] | Loss=0.00948 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=9.545 | 3929.8 samples/s | 61.4 steps/s
[Step=49250 Epoch=96.1] | Loss=0.00956 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.489 | L2-Norm(final)=9.548 | 3928.1 samples/s | 61.4 steps/s
[Step=49300 Epoch=96.2] | Loss=0.00936 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.494 | L2-Norm(final)=9.550 | 3976.9 samples/s | 62.1 steps/s
[Step=49350 Epoch=96.3] | Loss=0.00933 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.498 | L2-Norm(final)=9.552 | 3987.7 samples/s | 62.3 steps/s
[Step=49400 Epoch=96.3] | Loss=0.00915 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.503 | L2-Norm(final)=9.555 | 3960.4 samples/s | 61.9 steps/s
[Step=49450 Epoch=96.4] | Loss=0.00921 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.507 | L2-Norm(final)=9.557 | 3988.5 samples/s | 62.3 steps/s
[Step=49500 Epoch=96.5] | Loss=0.00921 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.512 | L2-Norm(final)=9.560 | 4145.0 samples/s | 64.8 steps/s
[Step=49550 Epoch=96.6] | Loss=0.00917 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.516 | L2-Norm(final)=9.562 | 1558.4 samples/s | 24.4 steps/s
[Step=49600 Epoch=96.7] | Loss=0.00915 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.521 | L2-Norm(final)=9.564 | 3957.8 samples/s | 61.8 steps/s
[Step=49650 Epoch=96.8] | Loss=0.00903 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.525 | L2-Norm(final)=9.566 | 3962.3 samples/s | 61.9 steps/s
[Step=49700 Epoch=96.9] | Loss=0.00891 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.529 | L2-Norm(final)=9.569 | 3928.6 samples/s | 61.4 steps/s
[Step=49750 Epoch=97.0] | Loss=0.00877 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.533 | L2-Norm(final)=9.571 | 3970.1 samples/s | 62.0 steps/s
[Step=49800 Epoch=97.1] | Loss=0.00870 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.536 | L2-Norm(final)=9.573 | 3949.8 samples/s | 61.7 steps/s
[Step=49850 Epoch=97.2] | Loss=0.00860 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.540 | L2-Norm(final)=9.575 | 3955.3 samples/s | 61.8 steps/s
[Step=49900 Epoch=97.3] | Loss=0.00861 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.544 | L2-Norm(final)=9.577 | 3938.1 samples/s | 61.5 steps/s
[Step=49950 Epoch=97.4] | Loss=0.00854 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.548 | L2-Norm(final)=9.579 | 3940.6 samples/s | 61.6 steps/s
[Step=50000 Epoch=97.5] | Loss=0.00858 | Reg=0.00158 | acc=0.9688 | L2-Norm=12.551 | L2-Norm(final)=9.581 | 3950.8 samples/s | 61.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step50000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=48001 Epoch=93.8] | Loss=0.01736 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.270 | L2-Norm(final)=9.695 | 3294.0 samples/s | 51.5 steps/s
[Step=48050 Epoch=93.9] | Loss=0.00775 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.282 | L2-Norm(final)=9.698 | 4069.3 samples/s | 63.6 steps/s
[Step=48100 Epoch=94.0] | Loss=0.00839 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.291 | L2-Norm(final)=9.700 | 4384.9 samples/s | 68.5 steps/s
[Step=48150 Epoch=94.1] | Loss=0.00831 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.296 | L2-Norm(final)=9.704 | 4361.9 samples/s | 68.2 steps/s
[Step=48200 Epoch=94.2] | Loss=0.00840 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=9.708 | 4385.9 samples/s | 68.5 steps/s
[Step=48250 Epoch=94.3] | Loss=0.00832 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.305 | L2-Norm(final)=9.712 | 4424.9 samples/s | 69.1 steps/s
[Step=48300 Epoch=94.4] | Loss=0.00822 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.309 | L2-Norm(final)=9.716 | 4345.8 samples/s | 67.9 steps/s
[Step=48350 Epoch=94.5] | Loss=0.00808 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.313 | L2-Norm(final)=9.721 | 4336.1 samples/s | 67.8 steps/s
[Step=48400 Epoch=94.6] | Loss=0.00797 | Reg=0.00152 | acc=0.9688 | L2-Norm=12.317 | L2-Norm(final)=9.726 | 4420.0 samples/s | 69.1 steps/s
[Step=48450 Epoch=94.7] | Loss=0.00789 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.321 | L2-Norm(final)=9.732 | 4354.6 samples/s | 68.0 steps/s
[Step=48500 Epoch=94.8] | Loss=0.00774 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.325 | L2-Norm(final)=9.736 | 5544.3 samples/s | 86.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=48501 Epoch=94.8] | Loss=0.02704 | Reg=0.00153 | acc=0.9688 | L2-Norm=12.367 | L2-Norm(final)=9.784 | 3265.3 samples/s | 51.0 steps/s
[Step=48550 Epoch=94.9] | Loss=0.00685 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=9.789 | 3810.3 samples/s | 59.5 steps/s
[Step=48600 Epoch=95.0] | Loss=0.00876 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.380 | L2-Norm(final)=9.791 | 3921.5 samples/s | 61.3 steps/s
[Step=48650 Epoch=95.1] | Loss=0.00844 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.387 | L2-Norm(final)=9.793 | 3957.6 samples/s | 61.8 steps/s
[Step=48700 Epoch=95.2] | Loss=0.00823 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.394 | L2-Norm(final)=9.796 | 3918.3 samples/s | 61.2 steps/s
[Step=48750 Epoch=95.3] | Loss=0.00926 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.402 | L2-Norm(final)=9.798 | 3964.2 samples/s | 61.9 steps/s
[Step=48800 Epoch=95.4] | Loss=0.00963 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.410 | L2-Norm(final)=9.800 | 3976.7 samples/s | 62.1 steps/s
[Step=48850 Epoch=95.5] | Loss=0.00994 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=9.801 | 3997.6 samples/s | 62.5 steps/s
[Step=48900 Epoch=95.6] | Loss=0.00999 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.427 | L2-Norm(final)=9.803 | 3968.3 samples/s | 62.0 steps/s
[Step=48950 Epoch=95.7] | Loss=0.01002 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.435 | L2-Norm(final)=9.804 | 3967.8 samples/s | 62.0 steps/s
[Step=49000 Epoch=95.8] | Loss=0.01001 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.442 | L2-Norm(final)=9.807 | 4935.1 samples/s | 77.1 steps/s
[Step=49050 Epoch=95.9] | Loss=0.00988 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.449 | L2-Norm(final)=9.809 | 1523.7 samples/s | 23.8 steps/s
[Step=49100 Epoch=96.0] | Loss=0.00961 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.456 | L2-Norm(final)=9.811 | 3901.3 samples/s | 61.0 steps/s
[Step=49150 Epoch=96.1] | Loss=0.00944 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.462 | L2-Norm(final)=9.814 | 3968.5 samples/s | 62.0 steps/s
[Step=49200 Epoch=96.2] | Loss=0.00935 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.468 | L2-Norm(final)=9.816 | 3935.3 samples/s | 61.5 steps/s
[Step=49250 Epoch=96.3] | Loss=0.00934 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.473 | L2-Norm(final)=9.818 | 3931.8 samples/s | 61.4 steps/s
[Step=49300 Epoch=96.4] | Loss=0.00932 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=9.820 | 3951.1 samples/s | 61.7 steps/s
[Step=49350 Epoch=96.5] | Loss=0.00916 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=9.822 | 3997.9 samples/s | 62.5 steps/s
[Step=49400 Epoch=96.6] | Loss=0.00905 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.488 | L2-Norm(final)=9.824 | 3948.8 samples/s | 61.7 steps/s
[Step=49450 Epoch=96.7] | Loss=0.00901 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.492 | L2-Norm(final)=9.826 | 3970.1 samples/s | 62.0 steps/s
[Step=49500 Epoch=96.8] | Loss=0.00895 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.497 | L2-Norm(final)=9.827 | 4292.1 samples/s | 67.1 steps/s
[Step=49550 Epoch=96.9] | Loss=0.00889 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.501 | L2-Norm(final)=9.829 | 1561.2 samples/s | 24.4 steps/s
[Step=49600 Epoch=97.0] | Loss=0.00873 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.505 | L2-Norm(final)=9.831 | 3964.0 samples/s | 61.9 steps/s
[Step=49650 Epoch=97.1] | Loss=0.00866 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.509 | L2-Norm(final)=9.833 | 3968.8 samples/s | 62.0 steps/s
[Step=49700 Epoch=97.2] | Loss=0.00860 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.513 | L2-Norm(final)=9.835 | 3910.7 samples/s | 61.1 steps/s
[Step=49750 Epoch=97.3] | Loss=0.00850 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.517 | L2-Norm(final)=9.836 | 3951.5 samples/s | 61.7 steps/s
[Step=49800 Epoch=97.4] | Loss=0.00843 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.521 | L2-Norm(final)=9.838 | 3967.1 samples/s | 62.0 steps/s
[Step=49850 Epoch=97.5] | Loss=0.00828 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.524 | L2-Norm(final)=9.840 | 3992.8 samples/s | 62.4 steps/s
[Step=49900 Epoch=97.6] | Loss=0.00828 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=9.843 | 3940.9 samples/s | 61.6 steps/s
[Step=49950 Epoch=97.7] | Loss=0.00830 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.531 | L2-Norm(final)=9.844 | 3938.6 samples/s | 61.5 steps/s
[Step=50000 Epoch=97.7] | Loss=0.00829 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.535 | L2-Norm(final)=9.846 | 3942.6 samples/s | 61.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step50000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=48001 Epoch=183.9] | Loss=0.00007 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.270 | L2-Norm(final)=7.774 | 3215.3 samples/s | 50.2 steps/s
[Step=48050 Epoch=184.1] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.273 | L2-Norm(final)=7.780 | 3911.7 samples/s | 61.1 steps/s
[Step=48100 Epoch=184.3] | Loss=0.00008 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.279 | L2-Norm(final)=7.786 | 4185.1 samples/s | 65.4 steps/s
[Step=48150 Epoch=184.5] | Loss=0.00006 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.277 | L2-Norm(final)=7.790 | 4017.8 samples/s | 62.8 steps/s
[Step=48200 Epoch=184.7] | Loss=0.00006 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.273 | L2-Norm(final)=7.795 | 4155.6 samples/s | 64.9 steps/s
[Step=48250 Epoch=184.9] | Loss=0.00005 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.269 | L2-Norm(final)=7.799 | 5283.1 samples/s | 82.5 steps/s
[Step=48300 Epoch=185.1] | Loss=0.00005 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.264 | L2-Norm(final)=7.803 | 1521.2 samples/s | 23.8 steps/s
[Step=48350 Epoch=185.3] | Loss=0.00004 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=7.807 | 4070.3 samples/s | 63.6 steps/s
[Step=48400 Epoch=185.5] | Loss=0.00004 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=7.811 | 4077.7 samples/s | 63.7 steps/s
[Step=48450 Epoch=185.6] | Loss=0.00003 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.248 | L2-Norm(final)=7.814 | 4152.2 samples/s | 64.9 steps/s
[Step=48500 Epoch=185.8] | Loss=0.00003 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=7.818 | 4644.0 samples/s | 72.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=48501 Epoch=185.8] | Loss=0.00002 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.186 | L2-Norm(final)=7.851 | 3155.4 samples/s | 49.3 steps/s
[Step=48550 Epoch=186.0] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=7.853 | 3621.9 samples/s | 56.6 steps/s
[Step=48600 Epoch=186.2] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=7.856 | 3785.4 samples/s | 59.1 steps/s
[Step=48650 Epoch=186.4] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=7.858 | 3741.7 samples/s | 58.5 steps/s
[Step=48700 Epoch=186.6] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=7.860 | 3710.3 samples/s | 58.0 steps/s
[Step=48750 Epoch=186.8] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.126 | L2-Norm(final)=7.862 | 4737.5 samples/s | 74.0 steps/s
[Step=48800 Epoch=187.0] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.114 | L2-Norm(final)=7.865 | 1453.7 samples/s | 22.7 steps/s
[Step=48850 Epoch=187.2] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.101 | L2-Norm(final)=7.867 | 3696.5 samples/s | 57.8 steps/s
[Step=48900 Epoch=187.4] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.087 | L2-Norm(final)=7.868 | 3757.0 samples/s | 58.7 steps/s
[Step=48950 Epoch=187.6] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.074 | L2-Norm(final)=7.870 | 3661.5 samples/s | 57.2 steps/s
[Step=49000 Epoch=187.8] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.061 | L2-Norm(final)=7.872 | 4102.4 samples/s | 64.1 steps/s
[Step=49050 Epoch=187.9] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.047 | L2-Norm(final)=7.873 | 1494.2 samples/s | 23.3 steps/s
[Step=49100 Epoch=188.1] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.034 | L2-Norm(final)=7.875 | 3723.9 samples/s | 58.2 steps/s
[Step=49150 Epoch=188.3] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.020 | L2-Norm(final)=7.876 | 3751.9 samples/s | 58.6 steps/s
[Step=49200 Epoch=188.5] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.006 | L2-Norm(final)=7.878 | 3736.9 samples/s | 58.4 steps/s
[Step=49250 Epoch=188.7] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.993 | L2-Norm(final)=7.880 | 3672.8 samples/s | 57.4 steps/s
[Step=49300 Epoch=188.9] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.979 | L2-Norm(final)=7.882 | 1539.8 samples/s | 24.1 steps/s
[Step=49350 Epoch=189.1] | Loss=0.00001 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.965 | L2-Norm(final)=7.883 | 3703.7 samples/s | 57.9 steps/s
[Step=49400 Epoch=189.3] | Loss=0.00001 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.950 | L2-Norm(final)=7.885 | 3719.4 samples/s | 58.1 steps/s
[Step=49450 Epoch=189.5] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.936 | L2-Norm(final)=7.887 | 3702.3 samples/s | 57.8 steps/s
[Step=49500 Epoch=189.7] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.922 | L2-Norm(final)=7.889 | 3706.6 samples/s | 57.9 steps/s
[Step=49550 Epoch=189.9] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.907 | L2-Norm(final)=7.891 | 1594.6 samples/s | 24.9 steps/s
[Step=49600 Epoch=190.0] | Loss=0.00000 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.893 | L2-Norm(final)=7.893 | 3624.5 samples/s | 56.6 steps/s
[Step=49650 Epoch=190.2] | Loss=0.00000 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.878 | L2-Norm(final)=7.895 | 3719.0 samples/s | 58.1 steps/s
[Step=49700 Epoch=190.4] | Loss=0.00000 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.864 | L2-Norm(final)=7.897 | 3700.6 samples/s | 57.8 steps/s
[Step=49750 Epoch=190.6] | Loss=0.00000 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.849 | L2-Norm(final)=7.898 | 3709.3 samples/s | 58.0 steps/s
[Step=49800 Epoch=190.8] | Loss=0.00000 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.834 | L2-Norm(final)=7.900 | 5137.7 samples/s | 80.3 steps/s
[Step=49850 Epoch=191.0] | Loss=0.00000 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.819 | L2-Norm(final)=7.902 | 1442.6 samples/s | 22.5 steps/s
[Step=49900 Epoch=191.2] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.803 | L2-Norm(final)=7.904 | 3713.2 samples/s | 58.0 steps/s
[Step=49950 Epoch=191.4] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.788 | L2-Norm(final)=7.906 | 3808.0 samples/s | 59.5 steps/s
[Step=50000 Epoch=191.6] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.773 | L2-Norm(final)=7.908 | 3688.8 samples/s | 57.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step50000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=48001 Epoch=184.8] | Loss=0.00002 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.270 | L2-Norm(final)=8.364 | 3326.7 samples/s | 52.0 steps/s
[Step=48050 Epoch=185.0] | Loss=0.00038 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=8.364 | 3677.0 samples/s | 57.5 steps/s
[Step=48100 Epoch=185.2] | Loss=0.00028 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.309 | L2-Norm(final)=8.370 | 4096.4 samples/s | 64.0 steps/s
[Step=48150 Epoch=185.3] | Loss=0.00021 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.314 | L2-Norm(final)=8.375 | 4167.3 samples/s | 65.1 steps/s
[Step=48200 Epoch=185.5] | Loss=0.00017 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=8.380 | 4137.0 samples/s | 64.6 steps/s
[Step=48250 Epoch=185.7] | Loss=0.00014 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.314 | L2-Norm(final)=8.384 | 5489.5 samples/s | 85.8 steps/s
[Step=48300 Epoch=185.9] | Loss=0.00012 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=8.387 | 1494.3 samples/s | 23.3 steps/s
[Step=48350 Epoch=186.1] | Loss=0.00010 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.307 | L2-Norm(final)=8.390 | 4136.8 samples/s | 64.6 steps/s
[Step=48400 Epoch=186.3] | Loss=0.00009 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=8.392 | 4130.1 samples/s | 64.5 steps/s
[Step=48450 Epoch=186.5] | Loss=0.00009 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.299 | L2-Norm(final)=8.395 | 4131.1 samples/s | 64.5 steps/s
[Step=48500 Epoch=186.7] | Loss=0.00008 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.295 | L2-Norm(final)=8.398 | 4796.7 samples/s | 74.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=48501 Epoch=186.7] | Loss=0.00000 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.251 | L2-Norm(final)=8.423 | 3073.6 samples/s | 48.0 steps/s
[Step=48550 Epoch=186.9] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.241 | L2-Norm(final)=8.425 | 3716.4 samples/s | 58.1 steps/s
[Step=48600 Epoch=187.1] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.228 | L2-Norm(final)=8.427 | 3727.1 samples/s | 58.2 steps/s
[Step=48650 Epoch=187.3] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.215 | L2-Norm(final)=8.429 | 3718.6 samples/s | 58.1 steps/s
[Step=48700 Epoch=187.5] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.202 | L2-Norm(final)=8.431 | 3755.7 samples/s | 58.7 steps/s
[Step=48750 Epoch=187.7] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.188 | L2-Norm(final)=8.433 | 4779.3 samples/s | 74.7 steps/s
[Step=48800 Epoch=187.9] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=8.434 | 1460.4 samples/s | 22.8 steps/s
[Step=48850 Epoch=188.0] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=8.435 | 3743.4 samples/s | 58.5 steps/s
[Step=48900 Epoch=188.2] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.145 | L2-Norm(final)=8.436 | 3746.3 samples/s | 58.5 steps/s
[Step=48950 Epoch=188.4] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.130 | L2-Norm(final)=8.437 | 3754.4 samples/s | 58.7 steps/s
[Step=49000 Epoch=188.6] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.115 | L2-Norm(final)=8.438 | 4222.4 samples/s | 66.0 steps/s
[Step=49050 Epoch=188.8] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.100 | L2-Norm(final)=8.439 | 1555.4 samples/s | 24.3 steps/s
[Step=49100 Epoch=189.0] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.085 | L2-Norm(final)=8.440 | 3664.4 samples/s | 57.3 steps/s
[Step=49150 Epoch=189.2] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=8.441 | 3704.5 samples/s | 57.9 steps/s
[Step=49200 Epoch=189.4] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.055 | L2-Norm(final)=8.442 | 3683.5 samples/s | 57.6 steps/s
[Step=49250 Epoch=189.6] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.039 | L2-Norm(final)=8.443 | 3772.3 samples/s | 58.9 steps/s
[Step=49300 Epoch=189.8] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.024 | L2-Norm(final)=8.444 | 1624.0 samples/s | 25.4 steps/s
[Step=49350 Epoch=190.0] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.008 | L2-Norm(final)=8.445 | 3694.7 samples/s | 57.7 steps/s
[Step=49400 Epoch=190.2] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.992 | L2-Norm(final)=8.446 | 3737.6 samples/s | 58.4 steps/s
[Step=49450 Epoch=190.4] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.976 | L2-Norm(final)=8.447 | 3709.3 samples/s | 58.0 steps/s
[Step=49500 Epoch=190.5] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.960 | L2-Norm(final)=8.448 | 3722.2 samples/s | 58.2 steps/s
[Step=49550 Epoch=190.7] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.944 | L2-Norm(final)=8.449 | 1594.4 samples/s | 24.9 steps/s
[Step=49600 Epoch=190.9] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.927 | L2-Norm(final)=8.450 | 3719.3 samples/s | 58.1 steps/s
[Step=49650 Epoch=191.1] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.911 | L2-Norm(final)=8.451 | 3772.5 samples/s | 58.9 steps/s
[Step=49700 Epoch=191.3] | Loss=0.00000 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.894 | L2-Norm(final)=8.452 | 3640.1 samples/s | 56.9 steps/s
[Step=49750 Epoch=191.5] | Loss=0.00000 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.877 | L2-Norm(final)=8.453 | 3753.0 samples/s | 58.6 steps/s
[Step=49800 Epoch=191.7] | Loss=0.00000 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.860 | L2-Norm(final)=8.454 | 5489.7 samples/s | 85.8 steps/s
[Step=49850 Epoch=191.9] | Loss=0.00000 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.843 | L2-Norm(final)=8.455 | 1382.2 samples/s | 21.6 steps/s
[Step=49900 Epoch=192.1] | Loss=0.00000 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=8.456 | 3708.1 samples/s | 57.9 steps/s
[Step=49950 Epoch=192.3] | Loss=0.00000 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.808 | L2-Norm(final)=8.457 | 3715.0 samples/s | 58.0 steps/s
[Step=50000 Epoch=192.5] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.790 | L2-Norm(final)=8.458 | 3708.9 samples/s | 58.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step50000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06638 | acc=0.9718 | tpr=0.9805 | fpr=0.0471 | 3578.1 samples/s | 14.0 steps/s
Avg test loss: 0.07188, Avg test acc: 0.96863, Avg tpr: 0.97756, Avg fpr: 0.05102, total FA: 398

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06003 | acc=0.9712 | tpr=0.9796 | fpr=0.0471 | 3528.5 samples/s | 13.8 steps/s
Avg test loss: 0.07147, Avg test acc: 0.96863, Avg tpr: 0.97791, Avg fpr: 0.05179, total FA: 404

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.44426 | acc=0.3109 | tpr=0.0171 | fpr=0.0510 | 3525.2 samples/s | 13.8 steps/s
Avg test loss: 5.45626, Avg test acc: 0.30892, Avg tpr: 0.01766, Avg fpr: 0.05051, total FA: 394

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.18358 | acc=0.3157 | tpr=0.0234 | fpr=0.0496 | 3536.0 samples/s | 13.8 steps/s
Avg test loss: 5.19252, Avg test acc: 0.31273, Avg tpr: 0.02349, Avg fpr: 0.05115, total FA: 399

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.55803 | acc=0.0933 | tpr=0.8540 | fpr=0.9204 | 3512.4 samples/s | 13.7 steps/s
[Step= 100] | Loss=6.53533 | acc=0.0933 | tpr=0.8486 | fpr=0.9208 | 7030.6 samples/s | 27.5 steps/s
[Step= 150] | Loss=6.54991 | acc=0.0930 | tpr=0.8617 | fpr=0.9211 | 6788.1 samples/s | 26.5 steps/s
[Step= 200] | Loss=6.53257 | acc=0.0934 | tpr=0.8546 | fpr=0.9204 | 6881.8 samples/s | 26.9 steps/s
[Step= 250] | Loss=6.53085 | acc=0.0938 | tpr=0.8541 | fpr=0.9201 | 6954.3 samples/s | 27.2 steps/s
[Step= 300] | Loss=6.53395 | acc=0.0936 | tpr=0.8560 | fpr=0.9203 | 6864.0 samples/s | 26.8 steps/s
[Step= 350] | Loss=6.53389 | acc=0.0938 | tpr=0.8616 | fpr=0.9201 | 6810.2 samples/s | 26.6 steps/s
[Step= 400] | Loss=6.52831 | acc=0.0938 | tpr=0.8572 | fpr=0.9200 | 6744.0 samples/s | 26.3 steps/s
[Step= 450] | Loss=6.53490 | acc=0.0935 | tpr=0.8608 | fpr=0.9204 | 6828.1 samples/s | 26.7 steps/s
[Step= 500] | Loss=6.53757 | acc=0.0938 | tpr=0.8621 | fpr=0.9201 | 6644.6 samples/s | 26.0 steps/s
[Step= 550] | Loss=6.53677 | acc=0.0941 | tpr=0.8635 | fpr=0.9199 | 12503.3 samples/s | 48.8 steps/s
Avg test loss: 6.53877, Avg test acc: 0.09404, Avg tpr: 0.86292, Avg fpr: 0.91993, total FA: 127731

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.62130 | acc=0.0976 | tpr=0.8982 | fpr=0.9168 | 3493.3 samples/s | 13.6 steps/s
[Step= 100] | Loss=6.58982 | acc=0.0996 | tpr=0.8870 | fpr=0.9150 | 6853.7 samples/s | 26.8 steps/s
[Step= 150] | Loss=6.60463 | acc=0.0996 | tpr=0.8876 | fpr=0.9149 | 6799.8 samples/s | 26.6 steps/s
[Step= 200] | Loss=6.58707 | acc=0.0997 | tpr=0.8809 | fpr=0.9145 | 6814.5 samples/s | 26.6 steps/s
[Step= 250] | Loss=6.58431 | acc=0.1000 | tpr=0.8742 | fpr=0.9142 | 6827.3 samples/s | 26.7 steps/s
[Step= 300] | Loss=6.58752 | acc=0.1000 | tpr=0.8705 | fpr=0.9140 | 6743.4 samples/s | 26.3 steps/s
[Step= 350] | Loss=6.58820 | acc=0.1003 | tpr=0.8735 | fpr=0.9137 | 6745.3 samples/s | 26.3 steps/s
[Step= 400] | Loss=6.58409 | acc=0.1005 | tpr=0.8736 | fpr=0.9136 | 6865.9 samples/s | 26.8 steps/s
[Step= 450] | Loss=6.59057 | acc=0.1000 | tpr=0.8763 | fpr=0.9141 | 6702.0 samples/s | 26.2 steps/s
[Step= 500] | Loss=6.59058 | acc=0.1000 | tpr=0.8775 | fpr=0.9140 | 6777.6 samples/s | 26.5 steps/s
[Step= 550] | Loss=6.59052 | acc=0.1001 | tpr=0.8782 | fpr=0.9140 | 12570.1 samples/s | 49.1 steps/s
Avg test loss: 6.59218, Avg test acc: 0.10002, Avg tpr: 0.87758, Avg fpr: 0.91411, total FA: 126923

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11718 | acc=0.9810 | tpr=0.9381 | fpr=0.0182 | 3492.5 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.11958 | acc=0.9811 | tpr=0.9510 | fpr=0.0184 | 7091.4 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.12274 | acc=0.9805 | tpr=0.9496 | fpr=0.0190 | 6791.8 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.12361 | acc=0.9805 | tpr=0.9486 | fpr=0.0189 | 6715.7 samples/s | 26.2 steps/s
[Step= 250] | Loss=0.12192 | acc=0.9809 | tpr=0.9485 | fpr=0.0185 | 6872.4 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.12411 | acc=0.9807 | tpr=0.9491 | fpr=0.0187 | 6767.7 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.12380 | acc=0.9806 | tpr=0.9493 | fpr=0.0188 | 6895.2 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.12537 | acc=0.9804 | tpr=0.9464 | fpr=0.0189 | 6755.9 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.12787 | acc=0.9802 | tpr=0.9440 | fpr=0.0192 | 6788.3 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.12761 | acc=0.9802 | tpr=0.9471 | fpr=0.0192 | 6773.6 samples/s | 26.5 steps/s
[Step= 550] | Loss=0.12696 | acc=0.9804 | tpr=0.9475 | fpr=0.0190 | 12281.4 samples/s | 48.0 steps/s
Avg test loss: 0.12684, Avg test acc: 0.98039, Avg tpr: 0.94691, Avg fpr: 0.01900, total FA: 2638

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12164 | acc=0.9807 | tpr=0.9336 | fpr=0.0185 | 3516.0 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.12472 | acc=0.9804 | tpr=0.9574 | fpr=0.0192 | 6819.9 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.12767 | acc=0.9796 | tpr=0.9568 | fpr=0.0200 | 6799.6 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.12841 | acc=0.9797 | tpr=0.9574 | fpr=0.0198 | 6895.0 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.12736 | acc=0.9799 | tpr=0.9572 | fpr=0.0197 | 6825.9 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.13000 | acc=0.9796 | tpr=0.9578 | fpr=0.0200 | 6923.7 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.12971 | acc=0.9796 | tpr=0.9568 | fpr=0.0200 | 6779.0 samples/s | 26.5 steps/s
[Step= 400] | Loss=0.13120 | acc=0.9794 | tpr=0.9557 | fpr=0.0202 | 6877.5 samples/s | 26.9 steps/s
[Step= 450] | Loss=0.13375 | acc=0.9791 | tpr=0.9523 | fpr=0.0204 | 6613.2 samples/s | 25.8 steps/s
[Step= 500] | Loss=0.13333 | acc=0.9791 | tpr=0.9542 | fpr=0.0205 | 6947.2 samples/s | 27.1 steps/s
[Step= 550] | Loss=0.13232 | acc=0.9793 | tpr=0.9546 | fpr=0.0202 | 12543.3 samples/s | 49.0 steps/s
Avg test loss: 0.13225, Avg test acc: 0.97931, Avg tpr: 0.95404, Avg fpr: 0.02023, total FA: 2809

server round 25/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=50001 Epoch=97.5] | Loss=0.00516 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.863 | L2-Norm(final)=9.637 | 3129.4 samples/s | 48.9 steps/s
[Step=50050 Epoch=97.6] | Loss=0.00967 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.878 | L2-Norm(final)=9.641 | 4094.2 samples/s | 64.0 steps/s
[Step=50100 Epoch=97.7] | Loss=0.00901 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.887 | L2-Norm(final)=9.647 | 4317.4 samples/s | 67.5 steps/s
[Step=50150 Epoch=97.8] | Loss=0.00868 | Reg=0.00141 | acc=0.9531 | L2-Norm=11.895 | L2-Norm(final)=9.654 | 4375.3 samples/s | 68.4 steps/s
[Step=50200 Epoch=97.9] | Loss=0.00848 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.902 | L2-Norm(final)=9.662 | 4376.0 samples/s | 68.4 steps/s
[Step=50250 Epoch=98.0] | Loss=0.00819 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.908 | L2-Norm(final)=9.668 | 4398.8 samples/s | 68.7 steps/s
[Step=50300 Epoch=98.1] | Loss=0.00824 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.913 | L2-Norm(final)=9.675 | 4395.5 samples/s | 68.7 steps/s
[Step=50350 Epoch=98.2] | Loss=0.00811 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.919 | L2-Norm(final)=9.682 | 4412.8 samples/s | 69.0 steps/s
[Step=50400 Epoch=98.3] | Loss=0.00786 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.926 | L2-Norm(final)=9.688 | 4326.0 samples/s | 67.6 steps/s
[Step=50450 Epoch=98.4] | Loss=0.00778 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.932 | L2-Norm(final)=9.694 | 4357.4 samples/s | 68.1 steps/s
[Step=50500 Epoch=98.5] | Loss=0.00769 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.937 | L2-Norm(final)=9.699 | 5596.8 samples/s | 87.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=50501 Epoch=98.5] | Loss=0.02129 | Reg=0.00144 | acc=0.9688 | L2-Norm=11.985 | L2-Norm(final)=9.750 | 3165.6 samples/s | 49.5 steps/s
[Step=50550 Epoch=98.6] | Loss=0.00874 | Reg=0.00144 | acc=0.9688 | L2-Norm=11.990 | L2-Norm(final)=9.755 | 3610.5 samples/s | 56.4 steps/s
[Step=50600 Epoch=98.7] | Loss=0.00793 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.995 | L2-Norm(final)=9.756 | 3916.3 samples/s | 61.2 steps/s
[Step=50650 Epoch=98.8] | Loss=0.00796 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.002 | L2-Norm(final)=9.760 | 3927.8 samples/s | 61.4 steps/s
[Step=50700 Epoch=98.9] | Loss=0.00842 | Reg=0.00144 | acc=0.9844 | L2-Norm=12.009 | L2-Norm(final)=9.765 | 3924.2 samples/s | 61.3 steps/s
[Step=50750 Epoch=99.0] | Loss=0.00888 | Reg=0.00144 | acc=0.9844 | L2-Norm=12.018 | L2-Norm(final)=9.770 | 3942.4 samples/s | 61.6 steps/s
[Step=50800 Epoch=99.1] | Loss=0.00889 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.027 | L2-Norm(final)=9.773 | 3962.4 samples/s | 61.9 steps/s
[Step=50850 Epoch=99.2] | Loss=0.00942 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.037 | L2-Norm(final)=9.776 | 3931.9 samples/s | 61.4 steps/s
[Step=50900 Epoch=99.3] | Loss=0.00994 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.046 | L2-Norm(final)=9.777 | 3945.8 samples/s | 61.7 steps/s
[Step=50950 Epoch=99.4] | Loss=0.01010 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.055 | L2-Norm(final)=9.779 | 3943.0 samples/s | 61.6 steps/s
[Step=51000 Epoch=99.5] | Loss=0.00993 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.064 | L2-Norm(final)=9.782 | 4872.1 samples/s | 76.1 steps/s
[Step=51050 Epoch=99.6] | Loss=0.00959 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=9.785 | 1512.2 samples/s | 23.6 steps/s
[Step=51100 Epoch=99.7] | Loss=0.00941 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.081 | L2-Norm(final)=9.788 | 3909.7 samples/s | 61.1 steps/s
[Step=51150 Epoch=99.8] | Loss=0.00936 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.088 | L2-Norm(final)=9.791 | 3990.9 samples/s | 62.4 steps/s
[Step=51200 Epoch=99.9] | Loss=0.00938 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.095 | L2-Norm(final)=9.794 | 3893.7 samples/s | 60.8 steps/s
[Step=51250 Epoch=100.0] | Loss=0.00918 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.101 | L2-Norm(final)=9.797 | 3943.2 samples/s | 61.6 steps/s
[Step=51300 Epoch=100.1] | Loss=0.00914 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.108 | L2-Norm(final)=9.801 | 3971.8 samples/s | 62.1 steps/s
[Step=51350 Epoch=100.2] | Loss=0.00915 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.114 | L2-Norm(final)=9.804 | 3944.2 samples/s | 61.6 steps/s
[Step=51400 Epoch=100.2] | Loss=0.00918 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.120 | L2-Norm(final)=9.806 | 3938.5 samples/s | 61.5 steps/s
[Step=51450 Epoch=100.3] | Loss=0.00919 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.126 | L2-Norm(final)=9.809 | 3963.0 samples/s | 61.9 steps/s
[Step=51500 Epoch=100.4] | Loss=0.00924 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.131 | L2-Norm(final)=9.811 | 4119.2 samples/s | 64.4 steps/s
[Step=51550 Epoch=100.5] | Loss=0.00916 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.137 | L2-Norm(final)=9.814 | 1498.3 samples/s | 23.4 steps/s
[Step=51600 Epoch=100.6] | Loss=0.00901 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=9.816 | 3931.2 samples/s | 61.4 steps/s
[Step=51650 Epoch=100.7] | Loss=0.00890 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=9.818 | 3876.7 samples/s | 60.6 steps/s
[Step=51700 Epoch=100.8] | Loss=0.00882 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=9.821 | 3913.2 samples/s | 61.1 steps/s
[Step=51750 Epoch=100.9] | Loss=0.00877 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.158 | L2-Norm(final)=9.823 | 3833.7 samples/s | 59.9 steps/s
[Step=51800 Epoch=101.0] | Loss=0.00869 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.162 | L2-Norm(final)=9.826 | 3898.1 samples/s | 60.9 steps/s
[Step=51850 Epoch=101.1] | Loss=0.00869 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=9.828 | 3917.9 samples/s | 61.2 steps/s
[Step=51900 Epoch=101.2] | Loss=0.00863 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.172 | L2-Norm(final)=9.831 | 3902.0 samples/s | 61.0 steps/s
[Step=51950 Epoch=101.3] | Loss=0.00864 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=9.833 | 3903.0 samples/s | 61.0 steps/s
[Step=52000 Epoch=101.4] | Loss=0.00854 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.181 | L2-Norm(final)=9.835 | 3946.2 samples/s | 61.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step52000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=50001 Epoch=97.8] | Loss=0.04737 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.863 | L2-Norm(final)=9.897 | 3185.1 samples/s | 49.8 steps/s
[Step=50050 Epoch=97.8] | Loss=0.00943 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.883 | L2-Norm(final)=9.900 | 4247.5 samples/s | 66.4 steps/s
[Step=50100 Epoch=97.9] | Loss=0.00827 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.893 | L2-Norm(final)=9.907 | 4243.5 samples/s | 66.3 steps/s
[Step=50150 Epoch=98.0] | Loss=0.00740 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.899 | L2-Norm(final)=9.916 | 4321.8 samples/s | 67.5 steps/s
[Step=50200 Epoch=98.1] | Loss=0.00774 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.905 | L2-Norm(final)=9.925 | 4368.0 samples/s | 68.3 steps/s
[Step=50250 Epoch=98.2] | Loss=0.00768 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.911 | L2-Norm(final)=9.930 | 4371.0 samples/s | 68.3 steps/s
[Step=50300 Epoch=98.3] | Loss=0.00782 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.916 | L2-Norm(final)=9.936 | 4341.0 samples/s | 67.8 steps/s
[Step=50350 Epoch=98.4] | Loss=0.00776 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.921 | L2-Norm(final)=9.941 | 4374.1 samples/s | 68.3 steps/s
[Step=50400 Epoch=98.5] | Loss=0.00760 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.927 | L2-Norm(final)=9.948 | 4354.3 samples/s | 68.0 steps/s
[Step=50450 Epoch=98.6] | Loss=0.00746 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.933 | L2-Norm(final)=9.954 | 4279.8 samples/s | 66.9 steps/s
[Step=50500 Epoch=98.7] | Loss=0.00749 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.938 | L2-Norm(final)=9.960 | 5536.8 samples/s | 86.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=50501 Epoch=98.7] | Loss=0.00075 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.991 | L2-Norm(final)=10.021 | 3114.0 samples/s | 48.7 steps/s
[Step=50550 Epoch=98.8] | Loss=0.00674 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.998 | L2-Norm(final)=10.026 | 4039.0 samples/s | 63.1 steps/s
[Step=50600 Epoch=98.9] | Loss=0.00659 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.009 | L2-Norm(final)=10.033 | 3941.5 samples/s | 61.6 steps/s
[Step=50650 Epoch=99.0] | Loss=0.00813 | Reg=0.00144 | acc=0.9688 | L2-Norm=12.016 | L2-Norm(final)=10.037 | 3864.7 samples/s | 60.4 steps/s
[Step=50700 Epoch=99.1] | Loss=0.00896 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.023 | L2-Norm(final)=10.038 | 3888.3 samples/s | 60.8 steps/s
[Step=50750 Epoch=99.2] | Loss=0.00899 | Reg=0.00145 | acc=0.9688 | L2-Norm=12.031 | L2-Norm(final)=10.039 | 3851.0 samples/s | 60.2 steps/s
[Step=50800 Epoch=99.3] | Loss=0.01003 | Reg=0.00145 | acc=0.9688 | L2-Norm=12.038 | L2-Norm(final)=10.041 | 3893.9 samples/s | 60.8 steps/s
[Step=50850 Epoch=99.4] | Loss=0.00996 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.046 | L2-Norm(final)=10.043 | 3948.3 samples/s | 61.7 steps/s
[Step=50900 Epoch=99.5] | Loss=0.01027 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.054 | L2-Norm(final)=10.045 | 3960.9 samples/s | 61.9 steps/s
[Step=50950 Epoch=99.6] | Loss=0.01008 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.062 | L2-Norm(final)=10.047 | 3972.8 samples/s | 62.1 steps/s
[Step=51000 Epoch=99.7] | Loss=0.00987 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.069 | L2-Norm(final)=10.050 | 4767.0 samples/s | 74.5 steps/s
[Step=51050 Epoch=99.8] | Loss=0.00970 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.076 | L2-Norm(final)=10.052 | 1505.1 samples/s | 23.5 steps/s
[Step=51100 Epoch=99.9] | Loss=0.00964 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.083 | L2-Norm(final)=10.054 | 3878.4 samples/s | 60.6 steps/s
[Step=51150 Epoch=100.0] | Loss=0.00962 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.090 | L2-Norm(final)=10.056 | 3895.1 samples/s | 60.9 steps/s
[Step=51200 Epoch=100.1] | Loss=0.00941 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.096 | L2-Norm(final)=10.058 | 3941.3 samples/s | 61.6 steps/s
[Step=51250 Epoch=100.2] | Loss=0.00926 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.102 | L2-Norm(final)=10.060 | 3936.5 samples/s | 61.5 steps/s
[Step=51300 Epoch=100.3] | Loss=0.00923 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.108 | L2-Norm(final)=10.063 | 3964.2 samples/s | 61.9 steps/s
[Step=51350 Epoch=100.4] | Loss=0.00913 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.114 | L2-Norm(final)=10.065 | 3956.6 samples/s | 61.8 steps/s
[Step=51400 Epoch=100.5] | Loss=0.00912 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.119 | L2-Norm(final)=10.067 | 3984.4 samples/s | 62.3 steps/s
[Step=51450 Epoch=100.6] | Loss=0.00915 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.125 | L2-Norm(final)=10.069 | 3903.7 samples/s | 61.0 steps/s
[Step=51500 Epoch=100.7] | Loss=0.00902 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.130 | L2-Norm(final)=10.071 | 4294.7 samples/s | 67.1 steps/s
[Step=51550 Epoch=100.8] | Loss=0.00897 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=10.073 | 1554.5 samples/s | 24.3 steps/s
[Step=51600 Epoch=100.9] | Loss=0.00886 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=10.075 | 3946.3 samples/s | 61.7 steps/s
[Step=51650 Epoch=101.0] | Loss=0.00881 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=10.077 | 3925.5 samples/s | 61.3 steps/s
[Step=51700 Epoch=101.1] | Loss=0.00870 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.151 | L2-Norm(final)=10.080 | 3930.1 samples/s | 61.4 steps/s
[Step=51750 Epoch=101.2] | Loss=0.00865 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.155 | L2-Norm(final)=10.082 | 3938.5 samples/s | 61.5 steps/s
[Step=51800 Epoch=101.3] | Loss=0.00872 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=10.084 | 3906.7 samples/s | 61.0 steps/s
[Step=51850 Epoch=101.4] | Loss=0.00859 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=10.086 | 3959.6 samples/s | 61.9 steps/s
[Step=51900 Epoch=101.5] | Loss=0.00849 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=10.088 | 3953.2 samples/s | 61.8 steps/s
[Step=51950 Epoch=101.6] | Loss=0.00846 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=10.090 | 3970.3 samples/s | 62.0 steps/s
[Step=52000 Epoch=101.7] | Loss=0.00843 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.178 | L2-Norm(final)=10.092 | 3946.4 samples/s | 61.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step52000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=50001 Epoch=191.6] | Loss=0.00009 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.863 | L2-Norm(final)=7.971 | 3291.7 samples/s | 51.4 steps/s
[Step=50050 Epoch=191.8] | Loss=0.00014 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.877 | L2-Norm(final)=7.984 | 3800.7 samples/s | 59.4 steps/s
[Step=50100 Epoch=192.0] | Loss=0.00012 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.885 | L2-Norm(final)=7.993 | 4173.0 samples/s | 65.2 steps/s
[Step=50150 Epoch=192.2] | Loss=0.00010 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.886 | L2-Norm(final)=8.002 | 4057.4 samples/s | 63.4 steps/s
[Step=50200 Epoch=192.3] | Loss=0.00008 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.885 | L2-Norm(final)=8.010 | 4134.8 samples/s | 64.6 steps/s
[Step=50250 Epoch=192.5] | Loss=0.00007 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.882 | L2-Norm(final)=8.017 | 5403.9 samples/s | 84.4 steps/s
[Step=50300 Epoch=192.7] | Loss=0.00006 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.877 | L2-Norm(final)=8.022 | 1523.5 samples/s | 23.8 steps/s
[Step=50350 Epoch=192.9] | Loss=0.00005 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.870 | L2-Norm(final)=8.027 | 4119.9 samples/s | 64.4 steps/s
[Step=50400 Epoch=193.1] | Loss=0.00005 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.864 | L2-Norm(final)=8.032 | 4159.5 samples/s | 65.0 steps/s
[Step=50450 Epoch=193.3] | Loss=0.00004 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.856 | L2-Norm(final)=8.036 | 4130.2 samples/s | 64.5 steps/s
[Step=50500 Epoch=193.5] | Loss=0.00004 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.849 | L2-Norm(final)=8.040 | 4552.0 samples/s | 71.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=50501 Epoch=193.5] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.777 | L2-Norm(final)=8.081 | 3317.5 samples/s | 51.8 steps/s
[Step=50550 Epoch=193.7] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.758 | L2-Norm(final)=8.085 | 3387.6 samples/s | 52.9 steps/s
[Step=50600 Epoch=193.9] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.735 | L2-Norm(final)=8.087 | 3778.9 samples/s | 59.0 steps/s
[Step=50650 Epoch=194.1] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.711 | L2-Norm(final)=8.090 | 3692.1 samples/s | 57.7 steps/s
[Step=50700 Epoch=194.3] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.686 | L2-Norm(final)=8.092 | 3743.2 samples/s | 58.5 steps/s
[Step=50750 Epoch=194.5] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.662 | L2-Norm(final)=8.094 | 4738.3 samples/s | 74.0 steps/s
[Step=50800 Epoch=194.6] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.637 | L2-Norm(final)=8.096 | 1473.9 samples/s | 23.0 steps/s
[Step=50850 Epoch=194.8] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.612 | L2-Norm(final)=8.097 | 3714.1 samples/s | 58.0 steps/s
[Step=50900 Epoch=195.0] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.587 | L2-Norm(final)=8.099 | 3791.0 samples/s | 59.2 steps/s
[Step=50950 Epoch=195.2] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.562 | L2-Norm(final)=8.100 | 3685.2 samples/s | 57.6 steps/s
[Step=51000 Epoch=195.4] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.537 | L2-Norm(final)=8.102 | 4134.9 samples/s | 64.6 steps/s
[Step=51050 Epoch=195.6] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.511 | L2-Norm(final)=8.103 | 1522.1 samples/s | 23.8 steps/s
[Step=51100 Epoch=195.8] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.485 | L2-Norm(final)=8.105 | 3743.9 samples/s | 58.5 steps/s
[Step=51150 Epoch=196.0] | Loss=0.00000 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.459 | L2-Norm(final)=8.106 | 3743.4 samples/s | 58.5 steps/s
[Step=51200 Epoch=196.2] | Loss=0.00000 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.433 | L2-Norm(final)=8.107 | 3769.2 samples/s | 58.9 steps/s
[Step=51250 Epoch=196.4] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.407 | L2-Norm(final)=8.109 | 3738.3 samples/s | 58.4 steps/s
[Step=51300 Epoch=196.6] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.381 | L2-Norm(final)=8.110 | 1561.2 samples/s | 24.4 steps/s
[Step=51350 Epoch=196.8] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=8.112 | 3798.1 samples/s | 59.3 steps/s
[Step=51400 Epoch=196.9] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.328 | L2-Norm(final)=8.113 | 3707.6 samples/s | 57.9 steps/s
[Step=51450 Epoch=197.1] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.302 | L2-Norm(final)=8.115 | 3727.6 samples/s | 58.2 steps/s
[Step=51500 Epoch=197.3] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.275 | L2-Norm(final)=8.117 | 3779.8 samples/s | 59.1 steps/s
[Step=51550 Epoch=197.5] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.248 | L2-Norm(final)=8.118 | 1595.2 samples/s | 24.9 steps/s
[Step=51600 Epoch=197.7] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.221 | L2-Norm(final)=8.120 | 3707.5 samples/s | 57.9 steps/s
[Step=51650 Epoch=197.9] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.194 | L2-Norm(final)=8.122 | 3781.0 samples/s | 59.1 steps/s
[Step=51700 Epoch=198.1] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.167 | L2-Norm(final)=8.124 | 3690.5 samples/s | 57.7 steps/s
[Step=51750 Epoch=198.3] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.139 | L2-Norm(final)=8.126 | 3729.3 samples/s | 58.3 steps/s
[Step=51800 Epoch=198.5] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.112 | L2-Norm(final)=8.127 | 5087.4 samples/s | 79.5 steps/s
[Step=51850 Epoch=198.7] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.084 | L2-Norm(final)=8.129 | 1432.2 samples/s | 22.4 steps/s
[Step=51900 Epoch=198.9] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.056 | L2-Norm(final)=8.131 | 3666.0 samples/s | 57.3 steps/s
[Step=51950 Epoch=199.1] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.028 | L2-Norm(final)=8.134 | 3740.2 samples/s | 58.4 steps/s
[Step=52000 Epoch=199.2] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.000 | L2-Norm(final)=8.136 | 3728.0 samples/s | 58.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step52000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=50001 Epoch=192.5] | Loss=0.00004 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.863 | L2-Norm(final)=8.493 | 3177.9 samples/s | 49.7 steps/s
[Step=50050 Epoch=192.7] | Loss=0.00023 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.885 | L2-Norm(final)=8.501 | 3876.8 samples/s | 60.6 steps/s
[Step=50100 Epoch=192.9] | Loss=0.00023 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.906 | L2-Norm(final)=8.510 | 4099.1 samples/s | 64.0 steps/s
[Step=50150 Epoch=193.0] | Loss=0.00017 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.918 | L2-Norm(final)=8.518 | 4068.6 samples/s | 63.6 steps/s
[Step=50200 Epoch=193.2] | Loss=0.00013 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.922 | L2-Norm(final)=8.524 | 4068.4 samples/s | 63.6 steps/s
[Step=50250 Epoch=193.4] | Loss=0.00011 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.922 | L2-Norm(final)=8.529 | 5541.7 samples/s | 86.6 steps/s
[Step=50300 Epoch=193.6] | Loss=0.00009 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.920 | L2-Norm(final)=8.533 | 1470.5 samples/s | 23.0 steps/s
[Step=50350 Epoch=193.8] | Loss=0.00008 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.917 | L2-Norm(final)=8.536 | 4141.9 samples/s | 64.7 steps/s
[Step=50400 Epoch=194.0] | Loss=0.00007 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.913 | L2-Norm(final)=8.539 | 4113.4 samples/s | 64.3 steps/s
[Step=50450 Epoch=194.2] | Loss=0.00007 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.908 | L2-Norm(final)=8.543 | 4054.6 samples/s | 63.4 steps/s
[Step=50500 Epoch=194.4] | Loss=0.00006 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.904 | L2-Norm(final)=8.545 | 4748.0 samples/s | 74.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=50501 Epoch=194.4] | Loss=0.00000 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.856 | L2-Norm(final)=8.574 | 3442.2 samples/s | 53.8 steps/s
[Step=50550 Epoch=194.6] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.835 | L2-Norm(final)=8.576 | 3186.4 samples/s | 49.8 steps/s
[Step=50600 Epoch=194.8] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.809 | L2-Norm(final)=8.577 | 3735.1 samples/s | 58.4 steps/s
[Step=50650 Epoch=195.0] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.782 | L2-Norm(final)=8.579 | 3704.0 samples/s | 57.9 steps/s
[Step=50700 Epoch=195.2] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.755 | L2-Norm(final)=8.580 | 3706.1 samples/s | 57.9 steps/s
[Step=50750 Epoch=195.4] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.727 | L2-Norm(final)=8.581 | 4810.1 samples/s | 75.2 steps/s
[Step=50800 Epoch=195.5] | Loss=0.00000 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.700 | L2-Norm(final)=8.583 | 1459.6 samples/s | 22.8 steps/s
[Step=50850 Epoch=195.7] | Loss=0.00000 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.672 | L2-Norm(final)=8.584 | 3676.2 samples/s | 57.4 steps/s
[Step=50900 Epoch=195.9] | Loss=0.00000 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.644 | L2-Norm(final)=8.585 | 3720.4 samples/s | 58.1 steps/s
[Step=50950 Epoch=196.1] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.615 | L2-Norm(final)=8.586 | 3755.9 samples/s | 58.7 steps/s
[Step=51000 Epoch=196.3] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.586 | L2-Norm(final)=8.587 | 4236.2 samples/s | 66.2 steps/s
[Step=51050 Epoch=196.5] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.558 | L2-Norm(final)=8.588 | 1490.0 samples/s | 23.3 steps/s
[Step=51100 Epoch=196.7] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.528 | L2-Norm(final)=8.589 | 3755.1 samples/s | 58.7 steps/s
[Step=51150 Epoch=196.9] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.499 | L2-Norm(final)=8.590 | 3688.1 samples/s | 57.6 steps/s
[Step=51200 Epoch=197.1] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.470 | L2-Norm(final)=8.591 | 3788.4 samples/s | 59.2 steps/s
[Step=51250 Epoch=197.3] | Loss=0.00000 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.440 | L2-Norm(final)=8.592 | 3771.0 samples/s | 58.9 steps/s
[Step=51300 Epoch=197.5] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.410 | L2-Norm(final)=8.592 | 1519.9 samples/s | 23.7 steps/s
[Step=51350 Epoch=197.7] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=8.593 | 3751.0 samples/s | 58.6 steps/s
[Step=51400 Epoch=197.9] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.350 | L2-Norm(final)=8.594 | 3697.2 samples/s | 57.8 steps/s
[Step=51450 Epoch=198.1] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.319 | L2-Norm(final)=8.595 | 3688.8 samples/s | 57.6 steps/s
[Step=51500 Epoch=198.2] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=8.596 | 3751.1 samples/s | 58.6 steps/s
[Step=51550 Epoch=198.4] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.258 | L2-Norm(final)=8.597 | 1580.0 samples/s | 24.7 steps/s
[Step=51600 Epoch=198.6] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.227 | L2-Norm(final)=8.598 | 3750.7 samples/s | 58.6 steps/s
[Step=51650 Epoch=198.8] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.195 | L2-Norm(final)=8.599 | 3769.2 samples/s | 58.9 steps/s
[Step=51700 Epoch=199.0] | Loss=0.00000 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.164 | L2-Norm(final)=8.600 | 3696.0 samples/s | 57.7 steps/s
[Step=51750 Epoch=199.2] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.132 | L2-Norm(final)=8.601 | 3798.4 samples/s | 59.3 steps/s
[Step=51800 Epoch=199.4] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.100 | L2-Norm(final)=8.603 | 5572.3 samples/s | 87.1 steps/s
[Step=51850 Epoch=199.6] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.068 | L2-Norm(final)=8.604 | 1429.0 samples/s | 22.3 steps/s
[Step=51900 Epoch=199.8] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.036 | L2-Norm(final)=8.605 | 3681.8 samples/s | 57.5 steps/s
[Step=51950 Epoch=200.0] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.004 | L2-Norm(final)=8.606 | 3719.0 samples/s | 58.1 steps/s
[Step=52000 Epoch=200.2] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.971 | L2-Norm(final)=8.607 | 3732.9 samples/s | 58.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step52000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06637 | acc=0.9709 | tpr=0.9766 | fpr=0.0416 | 3546.3 samples/s | 13.9 steps/s
Avg test loss: 0.07251, Avg test acc: 0.96895, Avg tpr: 0.97430, Avg fpr: 0.04282, total FA: 334

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06597 | acc=0.9679 | tpr=0.9685 | fpr=0.0334 | 3511.9 samples/s | 13.7 steps/s
Avg test loss: 0.07357, Avg test acc: 0.96482, Avg tpr: 0.96684, Avg fpr: 0.03961, total FA: 309

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.30774 | acc=0.3088 | tpr=0.0157 | fpr=0.0548 | 3483.9 samples/s | 13.6 steps/s
Avg test loss: 5.31941, Avg test acc: 0.30583, Avg tpr: 0.01545, Avg fpr: 0.05551, total FA: 433

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.27062 | acc=0.3152 | tpr=0.0204 | fpr=0.0446 | 3515.0 samples/s | 13.7 steps/s
Avg test loss: 5.28080, Avg test acc: 0.31248, Avg tpr: 0.02005, Avg fpr: 0.04435, total FA: 346

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.31827 | acc=0.0882 | tpr=0.7655 | fpr=0.9240 | 3491.6 samples/s | 13.6 steps/s
[Step= 100] | Loss=6.28301 | acc=0.0901 | tpr=0.7910 | fpr=0.9230 | 6938.2 samples/s | 27.1 steps/s
[Step= 150] | Loss=6.30060 | acc=0.0902 | tpr=0.8069 | fpr=0.9230 | 6856.8 samples/s | 26.8 steps/s
[Step= 200] | Loss=6.28221 | acc=0.0901 | tpr=0.7836 | fpr=0.9225 | 6788.1 samples/s | 26.5 steps/s
[Step= 250] | Loss=6.28122 | acc=0.0903 | tpr=0.7738 | fpr=0.9221 | 6991.4 samples/s | 27.3 steps/s
[Step= 300] | Loss=6.28354 | acc=0.0902 | tpr=0.7811 | fpr=0.9224 | 6857.4 samples/s | 26.8 steps/s
[Step= 350] | Loss=6.28393 | acc=0.0905 | tpr=0.7846 | fpr=0.9221 | 6907.5 samples/s | 27.0 steps/s
[Step= 400] | Loss=6.27943 | acc=0.0904 | tpr=0.7801 | fpr=0.9221 | 6780.5 samples/s | 26.5 steps/s
[Step= 450] | Loss=6.28611 | acc=0.0905 | tpr=0.7843 | fpr=0.9221 | 6834.4 samples/s | 26.7 steps/s
[Step= 500] | Loss=6.28857 | acc=0.0907 | tpr=0.7850 | fpr=0.9219 | 6806.9 samples/s | 26.6 steps/s
[Step= 550] | Loss=6.28791 | acc=0.0907 | tpr=0.7855 | fpr=0.9219 | 12156.5 samples/s | 47.5 steps/s
Avg test loss: 6.28966, Avg test acc: 0.09063, Avg tpr: 0.78526, Avg fpr: 0.92199, total FA: 128017

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.78785 | acc=0.1285 | tpr=0.8274 | fpr=0.8840 | 3508.1 samples/s | 13.7 steps/s
[Step= 100] | Loss=5.75824 | acc=0.1280 | tpr=0.8273 | fpr=0.8850 | 6911.8 samples/s | 27.0 steps/s
[Step= 150] | Loss=5.77764 | acc=0.1276 | tpr=0.8357 | fpr=0.8854 | 6942.6 samples/s | 27.1 steps/s
[Step= 200] | Loss=5.76013 | acc=0.1279 | tpr=0.8219 | fpr=0.8847 | 6777.1 samples/s | 26.5 steps/s
[Step= 250] | Loss=5.75682 | acc=0.1280 | tpr=0.8210 | fpr=0.8847 | 6641.0 samples/s | 25.9 steps/s
[Step= 300] | Loss=5.75719 | acc=0.1283 | tpr=0.8175 | fpr=0.8842 | 6973.2 samples/s | 27.2 steps/s
[Step= 350] | Loss=5.75733 | acc=0.1288 | tpr=0.8259 | fpr=0.8839 | 6785.7 samples/s | 26.5 steps/s
[Step= 400] | Loss=5.75425 | acc=0.1291 | tpr=0.8244 | fpr=0.8835 | 6659.7 samples/s | 26.0 steps/s
[Step= 450] | Loss=5.76158 | acc=0.1285 | tpr=0.8262 | fpr=0.8841 | 6694.4 samples/s | 26.2 steps/s
[Step= 500] | Loss=5.76355 | acc=0.1287 | tpr=0.8264 | fpr=0.8839 | 7066.2 samples/s | 27.6 steps/s
[Step= 550] | Loss=5.76390 | acc=0.1288 | tpr=0.8273 | fpr=0.8839 | 12202.8 samples/s | 47.7 steps/s
Avg test loss: 5.76573, Avg test acc: 0.12865, Avg tpr: 0.82686, Avg fpr: 0.88404, total FA: 122747

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11232 | acc=0.9811 | tpr=0.9381 | fpr=0.0181 | 3484.8 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.11527 | acc=0.9806 | tpr=0.9552 | fpr=0.0189 | 6926.6 samples/s | 27.1 steps/s
[Step= 150] | Loss=0.11852 | acc=0.9801 | tpr=0.9553 | fpr=0.0194 | 6714.3 samples/s | 26.2 steps/s
[Step= 200] | Loss=0.11928 | acc=0.9801 | tpr=0.9552 | fpr=0.0194 | 6977.9 samples/s | 27.3 steps/s
[Step= 250] | Loss=0.11768 | acc=0.9805 | tpr=0.9555 | fpr=0.0191 | 6959.7 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.11957 | acc=0.9802 | tpr=0.9564 | fpr=0.0194 | 6681.8 samples/s | 26.1 steps/s
[Step= 350] | Loss=0.11948 | acc=0.9801 | tpr=0.9555 | fpr=0.0194 | 6974.4 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.12098 | acc=0.9799 | tpr=0.9513 | fpr=0.0196 | 6726.4 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.12335 | acc=0.9796 | tpr=0.9489 | fpr=0.0198 | 7001.9 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.12307 | acc=0.9797 | tpr=0.9515 | fpr=0.0198 | 6416.8 samples/s | 25.1 steps/s
[Step= 550] | Loss=0.12237 | acc=0.9799 | tpr=0.9515 | fpr=0.0196 | 12788.9 samples/s | 50.0 steps/s
Avg test loss: 0.12226, Avg test acc: 0.97990, Avg tpr: 0.95087, Avg fpr: 0.01957, total FA: 2717

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10793 | acc=0.9827 | tpr=0.9336 | fpr=0.0165 | 3484.5 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.11108 | acc=0.9823 | tpr=0.9531 | fpr=0.0171 | 7153.8 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.11333 | acc=0.9813 | tpr=0.9553 | fpr=0.0182 | 6760.3 samples/s | 26.4 steps/s
[Step= 200] | Loss=0.11460 | acc=0.9813 | tpr=0.9552 | fpr=0.0182 | 7008.1 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.11351 | acc=0.9814 | tpr=0.9546 | fpr=0.0181 | 6772.5 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.11562 | acc=0.9811 | tpr=0.9527 | fpr=0.0184 | 7174.3 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.11537 | acc=0.9810 | tpr=0.9524 | fpr=0.0185 | 6713.0 samples/s | 26.2 steps/s
[Step= 400] | Loss=0.11682 | acc=0.9808 | tpr=0.9508 | fpr=0.0187 | 6742.5 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.11928 | acc=0.9805 | tpr=0.9484 | fpr=0.0189 | 6737.8 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.11880 | acc=0.9806 | tpr=0.9507 | fpr=0.0189 | 6732.0 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.11796 | acc=0.9809 | tpr=0.9511 | fpr=0.0186 | 12761.4 samples/s | 49.8 steps/s
Avg test loss: 0.11790, Avg test acc: 0.98087, Avg tpr: 0.95048, Avg fpr: 0.01857, total FA: 2579

server round 26/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=52001 Epoch=101.4] | Loss=0.00237 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.058 | L2-Norm(final)=9.897 | 3170.2 samples/s | 49.5 steps/s
[Step=52050 Epoch=101.5] | Loss=0.01231 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.072 | L2-Norm(final)=9.902 | 4194.6 samples/s | 65.5 steps/s
[Step=52100 Epoch=101.6] | Loss=0.01039 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.085 | L2-Norm(final)=9.910 | 4396.2 samples/s | 68.7 steps/s
[Step=52150 Epoch=101.7] | Loss=0.01067 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.095 | L2-Norm(final)=9.920 | 4352.8 samples/s | 68.0 steps/s
[Step=52200 Epoch=101.8] | Loss=0.01080 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=9.930 | 4385.3 samples/s | 68.5 steps/s
[Step=52250 Epoch=101.9] | Loss=0.01038 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.113 | L2-Norm(final)=9.938 | 4338.5 samples/s | 67.8 steps/s
[Step=52300 Epoch=102.0] | Loss=0.01000 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.122 | L2-Norm(final)=9.946 | 4359.0 samples/s | 68.1 steps/s
[Step=52350 Epoch=102.1] | Loss=0.00975 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.130 | L2-Norm(final)=9.954 | 4380.1 samples/s | 68.4 steps/s
[Step=52400 Epoch=102.2] | Loss=0.00967 | Reg=0.00124 | acc=0.9688 | L2-Norm=11.138 | L2-Norm(final)=9.963 | 4426.2 samples/s | 69.2 steps/s
[Step=52450 Epoch=102.3] | Loss=0.00940 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.145 | L2-Norm(final)=9.971 | 4428.8 samples/s | 69.2 steps/s
[Step=52500 Epoch=102.4] | Loss=0.00922 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.152 | L2-Norm(final)=9.980 | 5495.4 samples/s | 85.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=52501 Epoch=102.4] | Loss=0.00079 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.221 | L2-Norm(final)=10.062 | 3291.0 samples/s | 51.4 steps/s
[Step=52550 Epoch=102.5] | Loss=0.00727 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.232 | L2-Norm(final)=10.071 | 3546.5 samples/s | 55.4 steps/s
[Step=52600 Epoch=102.6] | Loss=0.00924 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.246 | L2-Norm(final)=10.078 | 3918.0 samples/s | 61.2 steps/s
[Step=52650 Epoch=102.7] | Loss=0.01019 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.257 | L2-Norm(final)=10.083 | 3922.2 samples/s | 61.3 steps/s
[Step=52700 Epoch=102.8] | Loss=0.01062 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.268 | L2-Norm(final)=10.087 | 3932.3 samples/s | 61.4 steps/s
[Step=52750 Epoch=102.9] | Loss=0.01125 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.281 | L2-Norm(final)=10.091 | 3962.5 samples/s | 61.9 steps/s
[Step=52800 Epoch=103.0] | Loss=0.01138 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.294 | L2-Norm(final)=10.094 | 3925.2 samples/s | 61.3 steps/s
[Step=52850 Epoch=103.1] | Loss=0.01126 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.306 | L2-Norm(final)=10.099 | 3872.5 samples/s | 60.5 steps/s
[Step=52900 Epoch=103.2] | Loss=0.01123 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.317 | L2-Norm(final)=10.104 | 3887.9 samples/s | 60.7 steps/s
[Step=52950 Epoch=103.3] | Loss=0.01130 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.328 | L2-Norm(final)=10.109 | 3961.7 samples/s | 61.9 steps/s
[Step=53000 Epoch=103.4] | Loss=0.01110 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.338 | L2-Norm(final)=10.114 | 4805.6 samples/s | 75.1 steps/s
[Step=53050 Epoch=103.5] | Loss=0.01120 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.348 | L2-Norm(final)=10.119 | 1498.3 samples/s | 23.4 steps/s
[Step=53100 Epoch=103.6] | Loss=0.01087 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=10.124 | 3884.9 samples/s | 60.7 steps/s
[Step=53150 Epoch=103.7] | Loss=0.01048 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.366 | L2-Norm(final)=10.129 | 3887.6 samples/s | 60.7 steps/s
[Step=53200 Epoch=103.8] | Loss=0.01038 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.374 | L2-Norm(final)=10.134 | 3860.5 samples/s | 60.3 steps/s
[Step=53250 Epoch=103.9] | Loss=0.01025 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.382 | L2-Norm(final)=10.139 | 3914.4 samples/s | 61.2 steps/s
[Step=53300 Epoch=104.0] | Loss=0.01014 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.390 | L2-Norm(final)=10.144 | 3944.8 samples/s | 61.6 steps/s
[Step=53350 Epoch=104.1] | Loss=0.01003 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.397 | L2-Norm(final)=10.148 | 3887.5 samples/s | 60.7 steps/s
[Step=53400 Epoch=104.2] | Loss=0.01012 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.404 | L2-Norm(final)=10.152 | 3922.4 samples/s | 61.3 steps/s
[Step=53450 Epoch=104.2] | Loss=0.01015 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.411 | L2-Norm(final)=10.156 | 3885.8 samples/s | 60.7 steps/s
[Step=53500 Epoch=104.3] | Loss=0.01000 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.418 | L2-Norm(final)=10.160 | 4180.6 samples/s | 65.3 steps/s
[Step=53550 Epoch=104.4] | Loss=0.00988 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.425 | L2-Norm(final)=10.164 | 1563.9 samples/s | 24.4 steps/s
[Step=53600 Epoch=104.5] | Loss=0.00974 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.431 | L2-Norm(final)=10.168 | 3895.8 samples/s | 60.9 steps/s
[Step=53650 Epoch=104.6] | Loss=0.00967 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.438 | L2-Norm(final)=10.173 | 3926.0 samples/s | 61.3 steps/s
[Step=53700 Epoch=104.7] | Loss=0.00955 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.444 | L2-Norm(final)=10.177 | 3891.9 samples/s | 60.8 steps/s
[Step=53750 Epoch=104.8] | Loss=0.00948 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.450 | L2-Norm(final)=10.181 | 3936.2 samples/s | 61.5 steps/s
[Step=53800 Epoch=104.9] | Loss=0.00934 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.455 | L2-Norm(final)=10.185 | 3907.0 samples/s | 61.0 steps/s
[Step=53850 Epoch=105.0] | Loss=0.00923 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.461 | L2-Norm(final)=10.189 | 3907.9 samples/s | 61.1 steps/s
[Step=53900 Epoch=105.1] | Loss=0.00917 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.467 | L2-Norm(final)=10.193 | 3909.3 samples/s | 61.1 steps/s
[Step=53950 Epoch=105.2] | Loss=0.00906 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.472 | L2-Norm(final)=10.196 | 3972.6 samples/s | 62.1 steps/s
[Step=54000 Epoch=105.3] | Loss=0.00910 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.477 | L2-Norm(final)=10.200 | 3921.8 samples/s | 61.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step54000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=52001 Epoch=101.7] | Loss=0.04128 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.058 | L2-Norm(final)=10.158 | 3379.7 samples/s | 52.8 steps/s
[Step=52050 Epoch=101.8] | Loss=0.01215 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.078 | L2-Norm(final)=10.164 | 3933.8 samples/s | 61.5 steps/s
[Step=52100 Epoch=101.9] | Loss=0.01081 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.093 | L2-Norm(final)=10.172 | 4307.6 samples/s | 67.3 steps/s
[Step=52150 Epoch=102.0] | Loss=0.01050 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.102 | L2-Norm(final)=10.181 | 4376.9 samples/s | 68.4 steps/s
[Step=52200 Epoch=102.0] | Loss=0.00972 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.110 | L2-Norm(final)=10.191 | 4352.5 samples/s | 68.0 steps/s
[Step=52250 Epoch=102.1] | Loss=0.00948 | Reg=0.00124 | acc=0.9688 | L2-Norm=11.118 | L2-Norm(final)=10.199 | 4317.2 samples/s | 67.5 steps/s
[Step=52300 Epoch=102.2] | Loss=0.00943 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.125 | L2-Norm(final)=10.207 | 4345.8 samples/s | 67.9 steps/s
[Step=52350 Epoch=102.3] | Loss=0.00926 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.132 | L2-Norm(final)=10.215 | 4410.3 samples/s | 68.9 steps/s
[Step=52400 Epoch=102.4] | Loss=0.00946 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.139 | L2-Norm(final)=10.222 | 4373.5 samples/s | 68.3 steps/s
[Step=52450 Epoch=102.5] | Loss=0.00937 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.147 | L2-Norm(final)=10.229 | 4340.3 samples/s | 67.8 steps/s
[Step=52500 Epoch=102.6] | Loss=0.00927 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.154 | L2-Norm(final)=10.236 | 5520.2 samples/s | 86.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=52501 Epoch=102.6] | Loss=0.00710 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.223 | L2-Norm(final)=10.307 | 3242.2 samples/s | 50.7 steps/s
[Step=52550 Epoch=102.7] | Loss=0.01199 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.235 | L2-Norm(final)=10.312 | 3858.4 samples/s | 60.3 steps/s
[Step=52600 Epoch=102.8] | Loss=0.01140 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.249 | L2-Norm(final)=10.317 | 3947.5 samples/s | 61.7 steps/s
[Step=52650 Epoch=102.9] | Loss=0.01111 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.263 | L2-Norm(final)=10.323 | 3953.1 samples/s | 61.8 steps/s
[Step=52700 Epoch=103.0] | Loss=0.01091 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.276 | L2-Norm(final)=10.329 | 3864.0 samples/s | 60.4 steps/s
[Step=52750 Epoch=103.1] | Loss=0.01161 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=10.334 | 3919.9 samples/s | 61.2 steps/s
[Step=52800 Epoch=103.2] | Loss=0.01181 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.298 | L2-Norm(final)=10.338 | 3947.7 samples/s | 61.7 steps/s
[Step=52850 Epoch=103.3] | Loss=0.01164 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.309 | L2-Norm(final)=10.342 | 3987.4 samples/s | 62.3 steps/s
[Step=52900 Epoch=103.4] | Loss=0.01193 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.319 | L2-Norm(final)=10.347 | 3930.9 samples/s | 61.4 steps/s
[Step=52950 Epoch=103.5] | Loss=0.01185 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.329 | L2-Norm(final)=10.351 | 3924.4 samples/s | 61.3 steps/s
[Step=53000 Epoch=103.6] | Loss=0.01187 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.338 | L2-Norm(final)=10.355 | 4861.6 samples/s | 76.0 steps/s
[Step=53050 Epoch=103.7] | Loss=0.01166 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.347 | L2-Norm(final)=10.359 | 1550.8 samples/s | 24.2 steps/s
[Step=53100 Epoch=103.8] | Loss=0.01121 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.356 | L2-Norm(final)=10.363 | 3892.2 samples/s | 60.8 steps/s
[Step=53150 Epoch=103.9] | Loss=0.01098 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=10.367 | 3963.3 samples/s | 61.9 steps/s
[Step=53200 Epoch=104.0] | Loss=0.01093 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.372 | L2-Norm(final)=10.371 | 3925.0 samples/s | 61.3 steps/s
[Step=53250 Epoch=104.1] | Loss=0.01070 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.379 | L2-Norm(final)=10.375 | 3896.5 samples/s | 60.9 steps/s
[Step=53300 Epoch=104.2] | Loss=0.01062 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.386 | L2-Norm(final)=10.378 | 3953.2 samples/s | 61.8 steps/s
[Step=53350 Epoch=104.3] | Loss=0.01059 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.393 | L2-Norm(final)=10.382 | 3980.0 samples/s | 62.2 steps/s
[Step=53400 Epoch=104.4] | Loss=0.01061 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.399 | L2-Norm(final)=10.385 | 3944.7 samples/s | 61.6 steps/s
[Step=53450 Epoch=104.5] | Loss=0.01041 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.406 | L2-Norm(final)=10.389 | 3919.0 samples/s | 61.2 steps/s
[Step=53500 Epoch=104.6] | Loss=0.01030 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.413 | L2-Norm(final)=10.392 | 4266.1 samples/s | 66.7 steps/s
[Step=53550 Epoch=104.7] | Loss=0.01019 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.419 | L2-Norm(final)=10.396 | 1633.7 samples/s | 25.5 steps/s
[Step=53600 Epoch=104.8] | Loss=0.01013 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.425 | L2-Norm(final)=10.399 | 3986.7 samples/s | 62.3 steps/s
[Step=53650 Epoch=104.9] | Loss=0.01000 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.431 | L2-Norm(final)=10.403 | 3919.8 samples/s | 61.2 steps/s
[Step=53700 Epoch=105.0] | Loss=0.00987 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.437 | L2-Norm(final)=10.406 | 3915.0 samples/s | 61.2 steps/s
[Step=53750 Epoch=105.1] | Loss=0.00978 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.443 | L2-Norm(final)=10.410 | 3951.7 samples/s | 61.7 steps/s
[Step=53800 Epoch=105.2] | Loss=0.00966 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.449 | L2-Norm(final)=10.413 | 3919.7 samples/s | 61.2 steps/s
[Step=53850 Epoch=105.3] | Loss=0.00960 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.454 | L2-Norm(final)=10.416 | 3965.7 samples/s | 62.0 steps/s
[Step=53900 Epoch=105.4] | Loss=0.00957 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.460 | L2-Norm(final)=10.419 | 3954.9 samples/s | 61.8 steps/s
[Step=53950 Epoch=105.5] | Loss=0.00951 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.465 | L2-Norm(final)=10.422 | 3939.9 samples/s | 61.6 steps/s
[Step=54000 Epoch=105.6] | Loss=0.00949 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.470 | L2-Norm(final)=10.425 | 3938.2 samples/s | 61.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step54000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=52001 Epoch=199.2] | Loss=0.00007 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.058 | L2-Norm(final)=8.202 | 3242.6 samples/s | 50.7 steps/s
[Step=52050 Epoch=199.4] | Loss=0.00021 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.083 | L2-Norm(final)=8.219 | 3927.4 samples/s | 61.4 steps/s
[Step=52100 Epoch=199.6] | Loss=0.00013 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.101 | L2-Norm(final)=8.233 | 4080.8 samples/s | 63.8 steps/s
[Step=52150 Epoch=199.8] | Loss=0.00011 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.104 | L2-Norm(final)=8.241 | 4101.7 samples/s | 64.1 steps/s
[Step=52200 Epoch=200.0] | Loss=0.00022 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.108 | L2-Norm(final)=8.248 | 4167.3 samples/s | 65.1 steps/s
[Step=52250 Epoch=200.2] | Loss=0.00021 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.119 | L2-Norm(final)=8.254 | 5439.4 samples/s | 85.0 steps/s
[Step=52300 Epoch=200.4] | Loss=0.00021 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.128 | L2-Norm(final)=8.258 | 1547.9 samples/s | 24.2 steps/s
[Step=52350 Epoch=200.6] | Loss=0.00018 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.135 | L2-Norm(final)=8.262 | 4157.8 samples/s | 65.0 steps/s
[Step=52400 Epoch=200.8] | Loss=0.00016 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.139 | L2-Norm(final)=8.265 | 4113.4 samples/s | 64.3 steps/s
[Step=52450 Epoch=201.0] | Loss=0.00014 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.142 | L2-Norm(final)=8.267 | 4197.9 samples/s | 65.6 steps/s
[Step=52500 Epoch=201.2] | Loss=0.00014 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.144 | L2-Norm(final)=8.269 | 4538.1 samples/s | 70.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=52501 Epoch=201.2] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.158 | L2-Norm(final)=8.291 | 3226.3 samples/s | 50.4 steps/s
[Step=52550 Epoch=201.4] | Loss=0.00146 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.156 | L2-Norm(final)=8.292 | 3549.2 samples/s | 55.5 steps/s
[Step=52600 Epoch=201.5] | Loss=0.00196 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.204 | L2-Norm(final)=8.286 | 3726.1 samples/s | 58.2 steps/s
[Step=52650 Epoch=201.7] | Loss=0.00237 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.233 | L2-Norm(final)=8.283 | 3754.8 samples/s | 58.7 steps/s
[Step=52700 Epoch=201.9] | Loss=0.00212 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.253 | L2-Norm(final)=8.277 | 3723.5 samples/s | 58.2 steps/s
[Step=52750 Epoch=202.1] | Loss=0.00172 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.266 | L2-Norm(final)=8.272 | 4775.2 samples/s | 74.6 steps/s
[Step=52800 Epoch=202.3] | Loss=0.00145 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.275 | L2-Norm(final)=8.270 | 1462.6 samples/s | 22.9 steps/s
[Step=52850 Epoch=202.5] | Loss=0.00125 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.281 | L2-Norm(final)=8.268 | 3742.0 samples/s | 58.5 steps/s
[Step=52900 Epoch=202.7] | Loss=0.00110 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.284 | L2-Norm(final)=8.267 | 3715.9 samples/s | 58.1 steps/s
[Step=52950 Epoch=202.9] | Loss=0.00098 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=8.266 | 3742.6 samples/s | 58.5 steps/s
[Step=53000 Epoch=203.1] | Loss=0.00093 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=8.266 | 4147.8 samples/s | 64.8 steps/s
[Step=53050 Epoch=203.3] | Loss=0.00091 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.290 | L2-Norm(final)=8.265 | 1532.5 samples/s | 23.9 steps/s
[Step=53100 Epoch=203.5] | Loss=0.00083 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.291 | L2-Norm(final)=8.265 | 3703.7 samples/s | 57.9 steps/s
[Step=53150 Epoch=203.7] | Loss=0.00077 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.292 | L2-Norm(final)=8.265 | 3688.9 samples/s | 57.6 steps/s
[Step=53200 Epoch=203.8] | Loss=0.00072 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.292 | L2-Norm(final)=8.264 | 3734.5 samples/s | 58.4 steps/s
[Step=53250 Epoch=204.0] | Loss=0.00067 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.292 | L2-Norm(final)=8.264 | 3740.7 samples/s | 58.4 steps/s
[Step=53300 Epoch=204.2] | Loss=0.00063 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.292 | L2-Norm(final)=8.264 | 1590.4 samples/s | 24.8 steps/s
[Step=53350 Epoch=204.4] | Loss=0.00059 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.291 | L2-Norm(final)=8.265 | 3792.0 samples/s | 59.3 steps/s
[Step=53400 Epoch=204.6] | Loss=0.00056 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.290 | L2-Norm(final)=8.265 | 3769.6 samples/s | 58.9 steps/s
[Step=53450 Epoch=204.8] | Loss=0.00053 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.289 | L2-Norm(final)=8.265 | 3690.7 samples/s | 57.7 steps/s
[Step=53500 Epoch=205.0] | Loss=0.00051 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.288 | L2-Norm(final)=8.265 | 3728.0 samples/s | 58.3 steps/s
[Step=53550 Epoch=205.2] | Loss=0.00048 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=8.265 | 1565.8 samples/s | 24.5 steps/s
[Step=53600 Epoch=205.4] | Loss=0.00046 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=8.265 | 3772.4 samples/s | 58.9 steps/s
[Step=53650 Epoch=205.6] | Loss=0.00044 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=8.265 | 3715.1 samples/s | 58.0 steps/s
[Step=53700 Epoch=205.8] | Loss=0.00042 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.281 | L2-Norm(final)=8.265 | 3773.0 samples/s | 59.0 steps/s
[Step=53750 Epoch=206.0] | Loss=0.00040 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.279 | L2-Norm(final)=8.266 | 3710.7 samples/s | 58.0 steps/s
[Step=53800 Epoch=206.1] | Loss=0.00039 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.277 | L2-Norm(final)=8.266 | 5069.4 samples/s | 79.2 steps/s
[Step=53850 Epoch=206.3] | Loss=0.00038 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.275 | L2-Norm(final)=8.266 | 1421.3 samples/s | 22.2 steps/s
[Step=53900 Epoch=206.5] | Loss=0.00036 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.273 | L2-Norm(final)=8.266 | 3670.0 samples/s | 57.3 steps/s
[Step=53950 Epoch=206.7] | Loss=0.00035 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.271 | L2-Norm(final)=8.266 | 3724.7 samples/s | 58.2 steps/s
[Step=54000 Epoch=206.9] | Loss=0.00034 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.268 | L2-Norm(final)=8.266 | 3700.9 samples/s | 57.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step54000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=52001 Epoch=200.2] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.058 | L2-Norm(final)=8.645 | 3150.7 samples/s | 49.2 steps/s
[Step=52050 Epoch=200.4] | Loss=0.00042 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.099 | L2-Norm(final)=8.650 | 4012.0 samples/s | 62.7 steps/s
[Step=52100 Epoch=200.6] | Loss=0.00025 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.126 | L2-Norm(final)=8.657 | 4084.2 samples/s | 63.8 steps/s
[Step=52150 Epoch=200.7] | Loss=0.00019 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.135 | L2-Norm(final)=8.664 | 4046.6 samples/s | 63.2 steps/s
[Step=52200 Epoch=200.9] | Loss=0.00015 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.138 | L2-Norm(final)=8.670 | 4105.4 samples/s | 64.1 steps/s
[Step=52250 Epoch=201.1] | Loss=0.00013 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.138 | L2-Norm(final)=8.675 | 5406.3 samples/s | 84.5 steps/s
[Step=52300 Epoch=201.3] | Loss=0.00011 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.137 | L2-Norm(final)=8.679 | 1497.9 samples/s | 23.4 steps/s
[Step=52350 Epoch=201.5] | Loss=0.00010 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.134 | L2-Norm(final)=8.683 | 4017.7 samples/s | 62.8 steps/s
[Step=52400 Epoch=201.7] | Loss=0.00009 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.131 | L2-Norm(final)=8.687 | 4135.9 samples/s | 64.6 steps/s
[Step=52450 Epoch=201.9] | Loss=0.00008 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.127 | L2-Norm(final)=8.690 | 4030.0 samples/s | 63.0 steps/s
[Step=52500 Epoch=202.1] | Loss=0.00007 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.123 | L2-Norm(final)=8.694 | 4727.4 samples/s | 73.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=52501 Epoch=202.1] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.084 | L2-Norm(final)=8.725 | 3299.0 samples/s | 51.5 steps/s
[Step=52550 Epoch=202.3] | Loss=0.00008 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.051 | L2-Norm(final)=8.728 | 3394.4 samples/s | 53.0 steps/s
[Step=52600 Epoch=202.5] | Loss=0.00475 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.078 | L2-Norm(final)=8.719 | 3710.5 samples/s | 58.0 steps/s
[Step=52650 Epoch=202.7] | Loss=0.00468 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.120 | L2-Norm(final)=8.704 | 3728.2 samples/s | 58.3 steps/s
[Step=52700 Epoch=202.9] | Loss=0.00371 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.146 | L2-Norm(final)=8.696 | 3656.9 samples/s | 57.1 steps/s
[Step=52750 Epoch=203.1] | Loss=0.00304 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.162 | L2-Norm(final)=8.692 | 4689.8 samples/s | 73.3 steps/s
[Step=52800 Epoch=203.2] | Loss=0.00255 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.173 | L2-Norm(final)=8.690 | 1443.7 samples/s | 22.6 steps/s
[Step=52850 Epoch=203.4] | Loss=0.00219 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.180 | L2-Norm(final)=8.689 | 3673.4 samples/s | 57.4 steps/s
[Step=52900 Epoch=203.6] | Loss=0.00193 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.185 | L2-Norm(final)=8.688 | 3680.3 samples/s | 57.5 steps/s
[Step=52950 Epoch=203.8] | Loss=0.00171 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.188 | L2-Norm(final)=8.687 | 3756.2 samples/s | 58.7 steps/s
[Step=53000 Epoch=204.0] | Loss=0.00155 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=8.687 | 4184.8 samples/s | 65.4 steps/s
[Step=53050 Epoch=204.2] | Loss=0.00141 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=8.687 | 1522.3 samples/s | 23.8 steps/s
[Step=53100 Epoch=204.4] | Loss=0.00130 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.192 | L2-Norm(final)=8.687 | 3750.4 samples/s | 58.6 steps/s
[Step=53150 Epoch=204.6] | Loss=0.00120 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.193 | L2-Norm(final)=8.688 | 3691.4 samples/s | 57.7 steps/s
[Step=53200 Epoch=204.8] | Loss=0.00111 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.192 | L2-Norm(final)=8.688 | 3738.1 samples/s | 58.4 steps/s
[Step=53250 Epoch=205.0] | Loss=0.00104 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.192 | L2-Norm(final)=8.688 | 3815.0 samples/s | 59.6 steps/s
[Step=53300 Epoch=205.2] | Loss=0.00098 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=8.689 | 1558.3 samples/s | 24.3 steps/s
[Step=53350 Epoch=205.4] | Loss=0.00092 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=8.689 | 3728.1 samples/s | 58.3 steps/s
[Step=53400 Epoch=205.6] | Loss=0.00087 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.189 | L2-Norm(final)=8.689 | 3739.8 samples/s | 58.4 steps/s
[Step=53450 Epoch=205.8] | Loss=0.00082 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.188 | L2-Norm(final)=8.690 | 3703.3 samples/s | 57.9 steps/s
[Step=53500 Epoch=205.9] | Loss=0.00078 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.187 | L2-Norm(final)=8.690 | 3736.6 samples/s | 58.4 steps/s
[Step=53550 Epoch=206.1] | Loss=0.00075 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.185 | L2-Norm(final)=8.690 | 1601.4 samples/s | 25.0 steps/s
[Step=53600 Epoch=206.3] | Loss=0.00071 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.184 | L2-Norm(final)=8.691 | 3773.8 samples/s | 59.0 steps/s
[Step=53650 Epoch=206.5] | Loss=0.00068 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.182 | L2-Norm(final)=8.691 | 3711.3 samples/s | 58.0 steps/s
[Step=53700 Epoch=206.7] | Loss=0.00065 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.180 | L2-Norm(final)=8.692 | 3758.9 samples/s | 58.7 steps/s
[Step=53750 Epoch=206.9] | Loss=0.00063 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=8.692 | 3751.3 samples/s | 58.6 steps/s
[Step=53800 Epoch=207.1] | Loss=0.00060 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=8.692 | 5466.0 samples/s | 85.4 steps/s
[Step=53850 Epoch=207.3] | Loss=0.00058 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.174 | L2-Norm(final)=8.693 | 1373.9 samples/s | 21.5 steps/s
[Step=53900 Epoch=207.5] | Loss=0.00056 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.172 | L2-Norm(final)=8.693 | 3724.9 samples/s | 58.2 steps/s
[Step=53950 Epoch=207.7] | Loss=0.00054 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.170 | L2-Norm(final)=8.694 | 3735.7 samples/s | 58.4 steps/s
[Step=54000 Epoch=207.9] | Loss=0.00052 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.167 | L2-Norm(final)=8.694 | 3752.7 samples/s | 58.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step54000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06481 | acc=0.9718 | tpr=0.9827 | fpr=0.0518 | 3504.5 samples/s | 13.7 steps/s
Avg test loss: 0.07057, Avg test acc: 0.96971, Avg tpr: 0.98059, Avg fpr: 0.05422, total FA: 423

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05925 | acc=0.9697 | tpr=0.9731 | fpr=0.0377 | 3500.9 samples/s | 13.7 steps/s
Avg test loss: 0.06734, Avg test acc: 0.96714, Avg tpr: 0.97127, Avg fpr: 0.04192, total FA: 327

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.52655 | acc=0.3069 | tpr=0.0215 | fpr=0.0733 | 3526.2 samples/s | 13.8 steps/s
Avg test loss: 5.52651, Avg test acc: 0.30487, Avg tpr: 0.02145, Avg fpr: 0.07179, total FA: 560

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.09779 | acc=0.3137 | tpr=0.0129 | fpr=0.0332 | 3519.5 samples/s | 13.7 steps/s
Avg test loss: 5.10921, Avg test acc: 0.31184, Avg tpr: 0.01440, Avg fpr: 0.03397, total FA: 265

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.11230 | acc=0.0890 | tpr=0.8230 | fpr=0.9242 | 3588.1 samples/s | 14.0 steps/s
[Step= 100] | Loss=6.08172 | acc=0.0920 | tpr=0.8380 | fpr=0.9219 | 6723.9 samples/s | 26.3 steps/s
[Step= 150] | Loss=6.09720 | acc=0.0914 | tpr=0.8473 | fpr=0.9225 | 7018.0 samples/s | 27.4 steps/s
[Step= 200] | Loss=6.08115 | acc=0.0907 | tpr=0.8350 | fpr=0.9229 | 6785.5 samples/s | 26.5 steps/s
[Step= 250] | Loss=6.07888 | acc=0.0910 | tpr=0.8314 | fpr=0.9224 | 7031.8 samples/s | 27.5 steps/s
[Step= 300] | Loss=6.08000 | acc=0.0908 | tpr=0.8320 | fpr=0.9228 | 6743.6 samples/s | 26.3 steps/s
[Step= 350] | Loss=6.07946 | acc=0.0911 | tpr=0.8391 | fpr=0.9225 | 6945.9 samples/s | 27.1 steps/s
[Step= 400] | Loss=6.07703 | acc=0.0911 | tpr=0.8386 | fpr=0.9225 | 6758.6 samples/s | 26.4 steps/s
[Step= 450] | Loss=6.08195 | acc=0.0910 | tpr=0.8423 | fpr=0.9227 | 6663.2 samples/s | 26.0 steps/s
[Step= 500] | Loss=6.08500 | acc=0.0911 | tpr=0.8432 | fpr=0.9225 | 6844.9 samples/s | 26.7 steps/s
[Step= 550] | Loss=6.08582 | acc=0.0913 | tpr=0.8440 | fpr=0.9224 | 11984.7 samples/s | 46.8 steps/s
Avg test loss: 6.08771, Avg test acc: 0.09123, Avg tpr: 0.84350, Avg fpr: 0.92245, total FA: 128080

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.49365 | acc=0.1165 | tpr=0.8496 | fpr=0.8967 | 3443.6 samples/s | 13.5 steps/s
[Step= 100] | Loss=5.46783 | acc=0.1177 | tpr=0.8443 | fpr=0.8959 | 6916.6 samples/s | 27.0 steps/s
[Step= 150] | Loss=5.48522 | acc=0.1167 | tpr=0.8501 | fpr=0.8968 | 7020.3 samples/s | 27.4 steps/s
[Step= 200] | Loss=5.46794 | acc=0.1167 | tpr=0.8361 | fpr=0.8964 | 6603.7 samples/s | 25.8 steps/s
[Step= 250] | Loss=5.46729 | acc=0.1169 | tpr=0.8262 | fpr=0.8960 | 6923.0 samples/s | 27.0 steps/s
[Step= 300] | Loss=5.46785 | acc=0.1167 | tpr=0.8225 | fpr=0.8961 | 6756.1 samples/s | 26.4 steps/s
[Step= 350] | Loss=5.46669 | acc=0.1171 | tpr=0.8309 | fpr=0.8959 | 6628.3 samples/s | 25.9 steps/s
[Step= 400] | Loss=5.46300 | acc=0.1174 | tpr=0.8288 | fpr=0.8955 | 6835.3 samples/s | 26.7 steps/s
[Step= 450] | Loss=5.46984 | acc=0.1170 | tpr=0.8296 | fpr=0.8959 | 6653.4 samples/s | 26.0 steps/s
[Step= 500] | Loss=5.47210 | acc=0.1169 | tpr=0.8295 | fpr=0.8960 | 7206.7 samples/s | 28.2 steps/s
[Step= 550] | Loss=5.47341 | acc=0.1168 | tpr=0.8317 | fpr=0.8961 | 10887.4 samples/s | 42.5 steps/s
Avg test loss: 5.47500, Avg test acc: 0.11673, Avg tpr: 0.83122, Avg fpr: 0.89626, total FA: 124444

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12653 | acc=0.9812 | tpr=0.9336 | fpr=0.0180 | 3487.3 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.12873 | acc=0.9809 | tpr=0.9424 | fpr=0.0183 | 7017.3 samples/s | 27.4 steps/s
[Step= 150] | Loss=0.13106 | acc=0.9805 | tpr=0.9467 | fpr=0.0189 | 6716.1 samples/s | 26.2 steps/s
[Step= 200] | Loss=0.13408 | acc=0.9804 | tpr=0.9432 | fpr=0.0190 | 6647.9 samples/s | 26.0 steps/s
[Step= 250] | Loss=0.13201 | acc=0.9807 | tpr=0.9459 | fpr=0.0187 | 6973.6 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.13496 | acc=0.9803 | tpr=0.9433 | fpr=0.0190 | 7031.5 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.13454 | acc=0.9803 | tpr=0.9474 | fpr=0.0191 | 6798.1 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.13623 | acc=0.9799 | tpr=0.9420 | fpr=0.0194 | 6824.7 samples/s | 26.7 steps/s
[Step= 450] | Loss=0.13856 | acc=0.9796 | tpr=0.9401 | fpr=0.0197 | 6833.1 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.13773 | acc=0.9798 | tpr=0.9427 | fpr=0.0196 | 6742.2 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.13734 | acc=0.9799 | tpr=0.9419 | fpr=0.0194 | 12753.8 samples/s | 49.8 steps/s
Avg test loss: 0.13705, Avg test acc: 0.97990, Avg tpr: 0.94136, Avg fpr: 0.01940, total FA: 2694

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10608 | acc=0.9806 | tpr=0.9292 | fpr=0.0185 | 3519.1 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.10910 | acc=0.9801 | tpr=0.9510 | fpr=0.0193 | 6862.5 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.11160 | acc=0.9792 | tpr=0.9510 | fpr=0.0203 | 6793.6 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.11158 | acc=0.9792 | tpr=0.9530 | fpr=0.0203 | 7047.1 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.11134 | acc=0.9794 | tpr=0.9485 | fpr=0.0201 | 6879.0 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.11406 | acc=0.9788 | tpr=0.9440 | fpr=0.0205 | 6634.2 samples/s | 25.9 steps/s
[Step= 350] | Loss=0.11395 | acc=0.9788 | tpr=0.9455 | fpr=0.0206 | 6935.7 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.11551 | acc=0.9789 | tpr=0.9431 | fpr=0.0205 | 6727.6 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.11778 | acc=0.9786 | tpr=0.9426 | fpr=0.0207 | 7338.3 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.11766 | acc=0.9787 | tpr=0.9454 | fpr=0.0207 | 6509.1 samples/s | 25.4 steps/s
[Step= 550] | Loss=0.11702 | acc=0.9788 | tpr=0.9451 | fpr=0.0206 | 12123.9 samples/s | 47.4 steps/s
Avg test loss: 0.11694, Avg test acc: 0.97884, Avg tpr: 0.94453, Avg fpr: 0.02054, total FA: 2852

server round 27/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=54001 Epoch=105.3] | Loss=0.00482 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.213 | L2-Norm(final)=10.303 | 3050.0 samples/s | 47.7 steps/s
[Step=54050 Epoch=105.4] | Loss=0.01373 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.235 | L2-Norm(final)=10.316 | 4334.2 samples/s | 67.7 steps/s
[Step=54100 Epoch=105.5] | Loss=0.01383 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.254 | L2-Norm(final)=10.326 | 4425.1 samples/s | 69.1 steps/s
[Step=54150 Epoch=105.6] | Loss=0.01301 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.268 | L2-Norm(final)=10.337 | 4375.6 samples/s | 68.4 steps/s
[Step=54200 Epoch=105.7] | Loss=0.01261 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.278 | L2-Norm(final)=10.347 | 4400.4 samples/s | 68.8 steps/s
[Step=54250 Epoch=105.8] | Loss=0.01242 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.289 | L2-Norm(final)=10.358 | 4293.7 samples/s | 67.1 steps/s
[Step=54300 Epoch=105.9] | Loss=0.01231 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.299 | L2-Norm(final)=10.368 | 4455.4 samples/s | 69.6 steps/s
[Step=54350 Epoch=106.0] | Loss=0.01236 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.309 | L2-Norm(final)=10.379 | 4289.8 samples/s | 67.0 steps/s
[Step=54400 Epoch=106.1] | Loss=0.01224 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.319 | L2-Norm(final)=10.389 | 4397.6 samples/s | 68.7 steps/s
[Step=54450 Epoch=106.2] | Loss=0.01188 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.328 | L2-Norm(final)=10.399 | 4377.3 samples/s | 68.4 steps/s
[Step=54500 Epoch=106.3] | Loss=0.01176 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.337 | L2-Norm(final)=10.409 | 5556.5 samples/s | 86.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=54501 Epoch=106.3] | Loss=0.00234 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.426 | L2-Norm(final)=10.508 | 3232.8 samples/s | 50.5 steps/s
[Step=54550 Epoch=106.4] | Loss=0.01024 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.435 | L2-Norm(final)=10.516 | 3490.4 samples/s | 54.5 steps/s
[Step=54600 Epoch=106.5] | Loss=0.01040 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.443 | L2-Norm(final)=10.519 | 3959.1 samples/s | 61.9 steps/s
[Step=54650 Epoch=106.6] | Loss=0.01017 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.451 | L2-Norm(final)=10.523 | 3930.3 samples/s | 61.4 steps/s
[Step=54700 Epoch=106.7] | Loss=0.01079 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.460 | L2-Norm(final)=10.527 | 3945.7 samples/s | 61.7 steps/s
[Step=54750 Epoch=106.8] | Loss=0.01121 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.470 | L2-Norm(final)=10.530 | 3865.9 samples/s | 60.4 steps/s
[Step=54800 Epoch=106.9] | Loss=0.01128 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.482 | L2-Norm(final)=10.533 | 3871.6 samples/s | 60.5 steps/s
[Step=54850 Epoch=107.0] | Loss=0.01141 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.492 | L2-Norm(final)=10.536 | 3953.6 samples/s | 61.8 steps/s
[Step=54900 Epoch=107.1] | Loss=0.01157 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.502 | L2-Norm(final)=10.538 | 3912.8 samples/s | 61.1 steps/s
[Step=54950 Epoch=107.2] | Loss=0.01121 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.511 | L2-Norm(final)=10.541 | 3986.1 samples/s | 62.3 steps/s
[Step=55000 Epoch=107.3] | Loss=0.01139 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.519 | L2-Norm(final)=10.543 | 4830.3 samples/s | 75.5 steps/s
[Step=55050 Epoch=107.4] | Loss=0.01099 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.527 | L2-Norm(final)=10.546 | 1446.4 samples/s | 22.6 steps/s
[Step=55100 Epoch=107.5] | Loss=0.01074 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.534 | L2-Norm(final)=10.549 | 3905.5 samples/s | 61.0 steps/s
[Step=55150 Epoch=107.6] | Loss=0.01060 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.541 | L2-Norm(final)=10.552 | 3931.3 samples/s | 61.4 steps/s
[Step=55200 Epoch=107.7] | Loss=0.01046 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.547 | L2-Norm(final)=10.554 | 3883.7 samples/s | 60.7 steps/s
[Step=55250 Epoch=107.8] | Loss=0.01020 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.553 | L2-Norm(final)=10.557 | 3943.7 samples/s | 61.6 steps/s
[Step=55300 Epoch=107.9] | Loss=0.01019 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.558 | L2-Norm(final)=10.560 | 3918.5 samples/s | 61.2 steps/s
[Step=55350 Epoch=108.0] | Loss=0.01007 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.564 | L2-Norm(final)=10.563 | 3934.6 samples/s | 61.5 steps/s
[Step=55400 Epoch=108.1] | Loss=0.00994 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.569 | L2-Norm(final)=10.566 | 3918.3 samples/s | 61.2 steps/s
[Step=55450 Epoch=108.1] | Loss=0.00981 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.574 | L2-Norm(final)=10.569 | 3888.8 samples/s | 60.8 steps/s
[Step=55500 Epoch=108.2] | Loss=0.00966 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.579 | L2-Norm(final)=10.573 | 4116.2 samples/s | 64.3 steps/s
[Step=55550 Epoch=108.3] | Loss=0.00953 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.584 | L2-Norm(final)=10.576 | 1537.3 samples/s | 24.0 steps/s
[Step=55600 Epoch=108.4] | Loss=0.00946 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.589 | L2-Norm(final)=10.579 | 3877.9 samples/s | 60.6 steps/s
[Step=55650 Epoch=108.5] | Loss=0.00930 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.594 | L2-Norm(final)=10.582 | 3887.6 samples/s | 60.7 steps/s
[Step=55700 Epoch=108.6] | Loss=0.00922 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.598 | L2-Norm(final)=10.585 | 3934.0 samples/s | 61.5 steps/s
[Step=55750 Epoch=108.7] | Loss=0.00914 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.603 | L2-Norm(final)=10.588 | 3915.3 samples/s | 61.2 steps/s
[Step=55800 Epoch=108.8] | Loss=0.00905 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.607 | L2-Norm(final)=10.591 | 3914.8 samples/s | 61.2 steps/s
[Step=55850 Epoch=108.9] | Loss=0.00899 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.612 | L2-Norm(final)=10.594 | 3922.0 samples/s | 61.3 steps/s
[Step=55900 Epoch=109.0] | Loss=0.00889 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.616 | L2-Norm(final)=10.597 | 3930.0 samples/s | 61.4 steps/s
[Step=55950 Epoch=109.1] | Loss=0.00889 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=10.600 | 3935.2 samples/s | 61.5 steps/s
[Step=56000 Epoch=109.2] | Loss=0.00884 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.624 | L2-Norm(final)=10.603 | 3934.1 samples/s | 61.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step56000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=54001 Epoch=105.6] | Loss=0.01519 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.213 | L2-Norm(final)=10.507 | 3364.6 samples/s | 52.6 steps/s
[Step=54050 Epoch=105.7] | Loss=0.01403 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.231 | L2-Norm(final)=10.520 | 4155.4 samples/s | 64.9 steps/s
[Step=54100 Epoch=105.8] | Loss=0.01300 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.247 | L2-Norm(final)=10.534 | 4306.8 samples/s | 67.3 steps/s
[Step=54150 Epoch=105.9] | Loss=0.01270 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.259 | L2-Norm(final)=10.548 | 4304.3 samples/s | 67.3 steps/s
[Step=54200 Epoch=106.0] | Loss=0.01229 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.269 | L2-Norm(final)=10.561 | 4390.3 samples/s | 68.6 steps/s
[Step=54250 Epoch=106.1] | Loss=0.01187 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.278 | L2-Norm(final)=10.572 | 4321.2 samples/s | 67.5 steps/s
[Step=54300 Epoch=106.2] | Loss=0.01142 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.287 | L2-Norm(final)=10.582 | 4388.6 samples/s | 68.6 steps/s
[Step=54350 Epoch=106.3] | Loss=0.01151 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.295 | L2-Norm(final)=10.593 | 4368.7 samples/s | 68.3 steps/s
[Step=54400 Epoch=106.4] | Loss=0.01144 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.303 | L2-Norm(final)=10.604 | 4335.7 samples/s | 67.7 steps/s
[Step=54450 Epoch=106.4] | Loss=0.01125 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.311 | L2-Norm(final)=10.615 | 4348.8 samples/s | 68.0 steps/s
[Step=54500 Epoch=106.5] | Loss=0.01088 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.319 | L2-Norm(final)=10.626 | 5531.0 samples/s | 86.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=54501 Epoch=106.5] | Loss=0.00336 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.397 | L2-Norm(final)=10.734 | 3275.1 samples/s | 51.2 steps/s
[Step=54550 Epoch=106.6] | Loss=0.01079 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.412 | L2-Norm(final)=10.742 | 3715.7 samples/s | 58.1 steps/s
[Step=54600 Epoch=106.7] | Loss=0.01016 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.426 | L2-Norm(final)=10.748 | 3941.1 samples/s | 61.6 steps/s
[Step=54650 Epoch=106.8] | Loss=0.01048 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.437 | L2-Norm(final)=10.751 | 3874.9 samples/s | 60.5 steps/s
[Step=54700 Epoch=106.9] | Loss=0.01033 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.448 | L2-Norm(final)=10.755 | 3927.5 samples/s | 61.4 steps/s
[Step=54750 Epoch=107.0] | Loss=0.01081 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.456 | L2-Norm(final)=10.759 | 3942.0 samples/s | 61.6 steps/s
[Step=54800 Epoch=107.1] | Loss=0.01062 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.464 | L2-Norm(final)=10.762 | 3923.3 samples/s | 61.3 steps/s
[Step=54850 Epoch=107.2] | Loss=0.01073 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.471 | L2-Norm(final)=10.766 | 3954.8 samples/s | 61.8 steps/s
[Step=54900 Epoch=107.3] | Loss=0.01114 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.478 | L2-Norm(final)=10.770 | 3959.2 samples/s | 61.9 steps/s
[Step=54950 Epoch=107.4] | Loss=0.01082 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.486 | L2-Norm(final)=10.773 | 3936.0 samples/s | 61.5 steps/s
[Step=55000 Epoch=107.5] | Loss=0.01051 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.493 | L2-Norm(final)=10.776 | 4840.5 samples/s | 75.6 steps/s
[Step=55050 Epoch=107.6] | Loss=0.01027 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.499 | L2-Norm(final)=10.780 | 1539.7 samples/s | 24.1 steps/s
[Step=55100 Epoch=107.7] | Loss=0.01004 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.505 | L2-Norm(final)=10.783 | 3902.4 samples/s | 61.0 steps/s
[Step=55150 Epoch=107.8] | Loss=0.00993 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.512 | L2-Norm(final)=10.787 | 3927.6 samples/s | 61.4 steps/s
[Step=55200 Epoch=107.9] | Loss=0.00976 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.518 | L2-Norm(final)=10.790 | 3917.6 samples/s | 61.2 steps/s
[Step=55250 Epoch=108.0] | Loss=0.00955 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.524 | L2-Norm(final)=10.794 | 3908.7 samples/s | 61.1 steps/s
[Step=55300 Epoch=108.1] | Loss=0.00947 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.530 | L2-Norm(final)=10.797 | 3941.3 samples/s | 61.6 steps/s
[Step=55350 Epoch=108.2] | Loss=0.00925 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.535 | L2-Norm(final)=10.801 | 3965.5 samples/s | 62.0 steps/s
[Step=55400 Epoch=108.3] | Loss=0.00918 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.541 | L2-Norm(final)=10.804 | 3944.0 samples/s | 61.6 steps/s
[Step=55450 Epoch=108.4] | Loss=0.00919 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.546 | L2-Norm(final)=10.807 | 3956.8 samples/s | 61.8 steps/s
[Step=55500 Epoch=108.5] | Loss=0.00921 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.550 | L2-Norm(final)=10.810 | 4277.4 samples/s | 66.8 steps/s
[Step=55550 Epoch=108.6] | Loss=0.00910 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.555 | L2-Norm(final)=10.812 | 1588.7 samples/s | 24.8 steps/s
[Step=55600 Epoch=108.7] | Loss=0.00888 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.559 | L2-Norm(final)=10.815 | 3926.0 samples/s | 61.3 steps/s
[Step=55650 Epoch=108.8] | Loss=0.00874 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.564 | L2-Norm(final)=10.818 | 3978.7 samples/s | 62.2 steps/s
[Step=55700 Epoch=108.9] | Loss=0.00872 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.568 | L2-Norm(final)=10.820 | 3882.9 samples/s | 60.7 steps/s
[Step=55750 Epoch=109.0] | Loss=0.00863 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.573 | L2-Norm(final)=10.823 | 3945.7 samples/s | 61.7 steps/s
[Step=55800 Epoch=109.1] | Loss=0.00864 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.577 | L2-Norm(final)=10.825 | 3942.8 samples/s | 61.6 steps/s
[Step=55850 Epoch=109.2] | Loss=0.00861 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.581 | L2-Norm(final)=10.828 | 3960.6 samples/s | 61.9 steps/s
[Step=55900 Epoch=109.3] | Loss=0.00854 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.585 | L2-Norm(final)=10.830 | 3927.8 samples/s | 61.4 steps/s
[Step=55950 Epoch=109.4] | Loss=0.00852 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.589 | L2-Norm(final)=10.832 | 3955.3 samples/s | 61.8 steps/s
[Step=56000 Epoch=109.5] | Loss=0.00855 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.593 | L2-Norm(final)=10.834 | 3919.0 samples/s | 61.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step56000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=54001 Epoch=206.9] | Loss=0.00043 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.213 | L2-Norm(final)=8.273 | 3236.9 samples/s | 50.6 steps/s
[Step=54050 Epoch=207.1] | Loss=0.00014 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.217 | L2-Norm(final)=8.278 | 3904.9 samples/s | 61.0 steps/s
[Step=54100 Epoch=207.3] | Loss=0.00011 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.219 | L2-Norm(final)=8.284 | 4119.8 samples/s | 64.4 steps/s
[Step=54150 Epoch=207.5] | Loss=0.00010 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.220 | L2-Norm(final)=8.289 | 4185.9 samples/s | 65.4 steps/s
[Step=54200 Epoch=207.7] | Loss=0.00009 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.221 | L2-Norm(final)=8.294 | 4102.8 samples/s | 64.1 steps/s
[Step=54250 Epoch=207.9] | Loss=0.00008 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.221 | L2-Norm(final)=8.299 | 5362.9 samples/s | 83.8 steps/s
[Step=54300 Epoch=208.1] | Loss=0.00007 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.221 | L2-Norm(final)=8.303 | 1508.6 samples/s | 23.6 steps/s
[Step=54350 Epoch=208.3] | Loss=0.00007 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.220 | L2-Norm(final)=8.307 | 4101.7 samples/s | 64.1 steps/s
[Step=54400 Epoch=208.4] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.220 | L2-Norm(final)=8.311 | 4200.9 samples/s | 65.6 steps/s
[Step=54450 Epoch=208.6] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.219 | L2-Norm(final)=8.316 | 4069.7 samples/s | 63.6 steps/s
[Step=54500 Epoch=208.8] | Loss=0.00005 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.218 | L2-Norm(final)=8.320 | 4677.2 samples/s | 73.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=54501 Epoch=208.8] | Loss=0.00009 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=8.359 | 3283.6 samples/s | 51.3 steps/s
[Step=54550 Epoch=209.0] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.204 | L2-Norm(final)=8.363 | 3480.2 samples/s | 54.4 steps/s
[Step=54600 Epoch=209.2] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.201 | L2-Norm(final)=8.366 | 3756.7 samples/s | 58.7 steps/s
[Step=54650 Epoch=209.4] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.197 | L2-Norm(final)=8.369 | 3676.7 samples/s | 57.4 steps/s
[Step=54700 Epoch=209.6] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.193 | L2-Norm(final)=8.372 | 3765.9 samples/s | 58.8 steps/s
[Step=54750 Epoch=209.8] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.189 | L2-Norm(final)=8.375 | 4705.5 samples/s | 73.5 steps/s
[Step=54800 Epoch=210.0] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.184 | L2-Norm(final)=8.377 | 1480.9 samples/s | 23.1 steps/s
[Step=54850 Epoch=210.2] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.180 | L2-Norm(final)=8.379 | 3740.5 samples/s | 58.4 steps/s
[Step=54900 Epoch=210.4] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.175 | L2-Norm(final)=8.381 | 3757.9 samples/s | 58.7 steps/s
[Step=54950 Epoch=210.5] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.170 | L2-Norm(final)=8.383 | 3718.4 samples/s | 58.1 steps/s
[Step=55000 Epoch=210.7] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.165 | L2-Norm(final)=8.385 | 4104.1 samples/s | 64.1 steps/s
[Step=55050 Epoch=210.9] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.160 | L2-Norm(final)=8.387 | 1502.3 samples/s | 23.5 steps/s
[Step=55100 Epoch=211.1] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=8.388 | 3746.6 samples/s | 58.5 steps/s
[Step=55150 Epoch=211.3] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.149 | L2-Norm(final)=8.390 | 3735.4 samples/s | 58.4 steps/s
[Step=55200 Epoch=211.5] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.144 | L2-Norm(final)=8.391 | 3730.4 samples/s | 58.3 steps/s
[Step=55250 Epoch=211.7] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.139 | L2-Norm(final)=8.393 | 3806.5 samples/s | 59.5 steps/s
[Step=55300 Epoch=211.9] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.133 | L2-Norm(final)=8.394 | 1594.9 samples/s | 24.9 steps/s
[Step=55350 Epoch=212.1] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.128 | L2-Norm(final)=8.396 | 3775.7 samples/s | 59.0 steps/s
[Step=55400 Epoch=212.3] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.122 | L2-Norm(final)=8.397 | 3737.8 samples/s | 58.4 steps/s
[Step=55450 Epoch=212.5] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.116 | L2-Norm(final)=8.399 | 3742.7 samples/s | 58.5 steps/s
[Step=55500 Epoch=212.7] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.111 | L2-Norm(final)=8.400 | 3764.2 samples/s | 58.8 steps/s
[Step=55550 Epoch=212.8] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.105 | L2-Norm(final)=8.401 | 1580.5 samples/s | 24.7 steps/s
[Step=55600 Epoch=213.0] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.099 | L2-Norm(final)=8.403 | 3729.2 samples/s | 58.3 steps/s
[Step=55650 Epoch=213.2] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.093 | L2-Norm(final)=8.404 | 3765.5 samples/s | 58.8 steps/s
[Step=55700 Epoch=213.4] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=8.405 | 3750.7 samples/s | 58.6 steps/s
[Step=55750 Epoch=213.6] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.082 | L2-Norm(final)=8.407 | 3749.8 samples/s | 58.6 steps/s
[Step=55800 Epoch=213.8] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.076 | L2-Norm(final)=8.408 | 5064.7 samples/s | 79.1 steps/s
[Step=55850 Epoch=214.0] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.069 | L2-Norm(final)=8.409 | 1464.6 samples/s | 22.9 steps/s
[Step=55900 Epoch=214.2] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.063 | L2-Norm(final)=8.411 | 3664.2 samples/s | 57.3 steps/s
[Step=55950 Epoch=214.4] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.057 | L2-Norm(final)=8.412 | 3678.9 samples/s | 57.5 steps/s
[Step=56000 Epoch=214.6] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.051 | L2-Norm(final)=8.414 | 3706.3 samples/s | 57.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step56000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=54001 Epoch=207.9] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.213 | L2-Norm(final)=8.706 | 3175.2 samples/s | 49.6 steps/s
[Step=54050 Epoch=208.1] | Loss=0.00045 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.224 | L2-Norm(final)=8.710 | 3902.9 samples/s | 61.0 steps/s
[Step=54100 Epoch=208.3] | Loss=0.00032 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.233 | L2-Norm(final)=8.714 | 4232.9 samples/s | 66.1 steps/s
[Step=54150 Epoch=208.4] | Loss=0.00023 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.237 | L2-Norm(final)=8.718 | 4130.7 samples/s | 64.5 steps/s
[Step=54200 Epoch=208.6] | Loss=0.00019 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.238 | L2-Norm(final)=8.721 | 4007.0 samples/s | 62.6 steps/s
[Step=54250 Epoch=208.8] | Loss=0.00016 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.239 | L2-Norm(final)=8.724 | 5510.4 samples/s | 86.1 steps/s
[Step=54300 Epoch=209.0] | Loss=0.00014 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.239 | L2-Norm(final)=8.727 | 1486.6 samples/s | 23.2 steps/s
[Step=54350 Epoch=209.2] | Loss=0.00013 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.238 | L2-Norm(final)=8.729 | 4146.8 samples/s | 64.8 steps/s
[Step=54400 Epoch=209.4] | Loss=0.00012 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.237 | L2-Norm(final)=8.732 | 4033.8 samples/s | 63.0 steps/s
[Step=54450 Epoch=209.6] | Loss=0.00011 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.236 | L2-Norm(final)=8.735 | 4105.6 samples/s | 64.1 steps/s
[Step=54500 Epoch=209.8] | Loss=0.00010 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.235 | L2-Norm(final)=8.738 | 4688.5 samples/s | 73.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=54501 Epoch=209.8] | Loss=0.00003 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.222 | L2-Norm(final)=8.764 | 3087.8 samples/s | 48.2 steps/s
[Step=54550 Epoch=210.0] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.218 | L2-Norm(final)=8.766 | 3587.2 samples/s | 56.0 steps/s
[Step=54600 Epoch=210.2] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.214 | L2-Norm(final)=8.768 | 3692.8 samples/s | 57.7 steps/s
[Step=54650 Epoch=210.4] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.209 | L2-Norm(final)=8.770 | 3745.3 samples/s | 58.5 steps/s
[Step=54700 Epoch=210.6] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.205 | L2-Norm(final)=8.773 | 3725.4 samples/s | 58.2 steps/s
[Step=54750 Epoch=210.8] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.200 | L2-Norm(final)=8.775 | 4687.4 samples/s | 73.2 steps/s
[Step=54800 Epoch=210.9] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.196 | L2-Norm(final)=8.777 | 1420.5 samples/s | 22.2 steps/s
[Step=54850 Epoch=211.1] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.191 | L2-Norm(final)=8.779 | 3745.9 samples/s | 58.5 steps/s
[Step=54900 Epoch=211.3] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.186 | L2-Norm(final)=8.781 | 3732.0 samples/s | 58.3 steps/s
[Step=54950 Epoch=211.5] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.181 | L2-Norm(final)=8.783 | 3678.7 samples/s | 57.5 steps/s
[Step=55000 Epoch=211.7] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=8.785 | 4211.6 samples/s | 65.8 steps/s
[Step=55050 Epoch=211.9] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.171 | L2-Norm(final)=8.786 | 1532.7 samples/s | 23.9 steps/s
[Step=55100 Epoch=212.1] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.166 | L2-Norm(final)=8.788 | 3755.5 samples/s | 58.7 steps/s
[Step=55150 Epoch=212.3] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.161 | L2-Norm(final)=8.789 | 3724.9 samples/s | 58.2 steps/s
[Step=55200 Epoch=212.5] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.156 | L2-Norm(final)=8.791 | 3701.1 samples/s | 57.8 steps/s
[Step=55250 Epoch=212.7] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.150 | L2-Norm(final)=8.792 | 3774.8 samples/s | 59.0 steps/s
[Step=55300 Epoch=212.9] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.145 | L2-Norm(final)=8.794 | 1584.4 samples/s | 24.8 steps/s
[Step=55350 Epoch=213.1] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.140 | L2-Norm(final)=8.795 | 3723.4 samples/s | 58.2 steps/s
[Step=55400 Epoch=213.3] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.134 | L2-Norm(final)=8.797 | 3755.4 samples/s | 58.7 steps/s
[Step=55450 Epoch=213.4] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.129 | L2-Norm(final)=8.798 | 3687.6 samples/s | 57.6 steps/s
[Step=55500 Epoch=213.6] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.123 | L2-Norm(final)=8.799 | 3759.3 samples/s | 58.7 steps/s
[Step=55550 Epoch=213.8] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.117 | L2-Norm(final)=8.801 | 1569.2 samples/s | 24.5 steps/s
[Step=55600 Epoch=214.0] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.112 | L2-Norm(final)=8.802 | 3745.0 samples/s | 58.5 steps/s
[Step=55650 Epoch=214.2] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.106 | L2-Norm(final)=8.803 | 3719.8 samples/s | 58.1 steps/s
[Step=55700 Epoch=214.4] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.100 | L2-Norm(final)=8.805 | 3748.1 samples/s | 58.6 steps/s
[Step=55750 Epoch=214.6] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=8.806 | 3733.2 samples/s | 58.3 steps/s
[Step=55800 Epoch=214.8] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=8.807 | 5419.1 samples/s | 84.7 steps/s
[Step=55850 Epoch=215.0] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.082 | L2-Norm(final)=8.809 | 1391.0 samples/s | 21.7 steps/s
[Step=55900 Epoch=215.2] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.076 | L2-Norm(final)=8.810 | 3685.0 samples/s | 57.6 steps/s
[Step=55950 Epoch=215.4] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.070 | L2-Norm(final)=8.811 | 3709.0 samples/s | 58.0 steps/s
[Step=56000 Epoch=215.6] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.064 | L2-Norm(final)=8.813 | 3773.5 samples/s | 59.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step56000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06668 | acc=0.9696 | tpr=0.9752 | fpr=0.0426 | 3511.7 samples/s | 13.7 steps/s
Avg test loss: 0.07348, Avg test acc: 0.96759, Avg tpr: 0.97383, Avg fpr: 0.04615, total FA: 360

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06292 | acc=0.9703 | tpr=0.9806 | fpr=0.0520 | 3467.9 samples/s | 13.5 steps/s
Avg test loss: 0.07093, Avg test acc: 0.96718, Avg tpr: 0.97896, Avg fpr: 0.05871, total FA: 458

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.24875 | acc=0.3133 | tpr=0.0152 | fpr=0.0394 | 3514.9 samples/s | 13.7 steps/s
Avg test loss: 5.25952, Avg test acc: 0.31076, Avg tpr: 0.01527, Avg fpr: 0.03935, total FA: 307

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.70675 | acc=0.3156 | tpr=0.0200 | fpr=0.0424 | 3532.9 samples/s | 13.8 steps/s
Avg test loss: 4.71440, Avg test acc: 0.31281, Avg tpr: 0.01993, Avg fpr: 0.04307, total FA: 336

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.19083 | acc=0.1113 | tpr=0.8540 | fpr=0.9021 | 3502.5 samples/s | 13.7 steps/s
[Step= 100] | Loss=6.16210 | acc=0.1119 | tpr=0.8465 | fpr=0.9018 | 6874.7 samples/s | 26.9 steps/s
[Step= 150] | Loss=6.17566 | acc=0.1115 | tpr=0.8473 | fpr=0.9020 | 6986.0 samples/s | 27.3 steps/s
[Step= 200] | Loss=6.15558 | acc=0.1113 | tpr=0.8328 | fpr=0.9018 | 6905.7 samples/s | 27.0 steps/s
[Step= 250] | Loss=6.15358 | acc=0.1117 | tpr=0.8288 | fpr=0.9013 | 6943.8 samples/s | 27.1 steps/s
[Step= 300] | Loss=6.15484 | acc=0.1115 | tpr=0.8276 | fpr=0.9015 | 6937.6 samples/s | 27.1 steps/s
[Step= 350] | Loss=6.15147 | acc=0.1118 | tpr=0.8328 | fpr=0.9013 | 6823.1 samples/s | 26.7 steps/s
[Step= 400] | Loss=6.14774 | acc=0.1118 | tpr=0.8271 | fpr=0.9012 | 6912.5 samples/s | 27.0 steps/s
[Step= 450] | Loss=6.15477 | acc=0.1117 | tpr=0.8315 | fpr=0.9014 | 6774.5 samples/s | 26.5 steps/s
[Step= 500] | Loss=6.15750 | acc=0.1117 | tpr=0.8335 | fpr=0.9014 | 6809.8 samples/s | 26.6 steps/s
[Step= 550] | Loss=6.15817 | acc=0.1119 | tpr=0.8361 | fpr=0.9012 | 12529.2 samples/s | 48.9 steps/s
Avg test loss: 6.16005, Avg test acc: 0.11180, Avg tpr: 0.83558, Avg fpr: 0.90135, total FA: 125151

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.75211 | acc=0.0951 | tpr=0.8496 | fpr=0.9185 | 3466.9 samples/s | 13.5 steps/s
[Step= 100] | Loss=6.71602 | acc=0.0985 | tpr=0.8593 | fpr=0.9157 | 7018.4 samples/s | 27.4 steps/s
[Step= 150] | Loss=6.73036 | acc=0.0976 | tpr=0.8617 | fpr=0.9165 | 6665.4 samples/s | 26.0 steps/s
[Step= 200] | Loss=6.71504 | acc=0.0969 | tpr=0.8525 | fpr=0.9169 | 6792.2 samples/s | 26.5 steps/s
[Step= 250] | Loss=6.71384 | acc=0.0969 | tpr=0.8507 | fpr=0.9168 | 6955.3 samples/s | 27.2 steps/s
[Step= 300] | Loss=6.71656 | acc=0.0964 | tpr=0.8465 | fpr=0.9173 | 6667.0 samples/s | 26.0 steps/s
[Step= 350] | Loss=6.71660 | acc=0.0963 | tpr=0.8516 | fpr=0.9174 | 6926.1 samples/s | 27.1 steps/s
[Step= 400] | Loss=6.71339 | acc=0.0965 | tpr=0.8485 | fpr=0.9172 | 6639.3 samples/s | 25.9 steps/s
[Step= 450] | Loss=6.72124 | acc=0.0962 | tpr=0.8510 | fpr=0.9175 | 6818.2 samples/s | 26.6 steps/s
[Step= 500] | Loss=6.72326 | acc=0.0962 | tpr=0.8507 | fpr=0.9175 | 6614.4 samples/s | 25.8 steps/s
[Step= 550] | Loss=6.72416 | acc=0.0961 | tpr=0.8524 | fpr=0.9176 | 12071.5 samples/s | 47.2 steps/s
Avg test loss: 6.72563, Avg test acc: 0.09609, Avg tpr: 0.85182, Avg fpr: 0.91765, total FA: 127414

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11045 | acc=0.9820 | tpr=0.9425 | fpr=0.0173 | 3481.6 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.11278 | acc=0.9818 | tpr=0.9552 | fpr=0.0177 | 6923.7 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.11510 | acc=0.9811 | tpr=0.9539 | fpr=0.0184 | 6880.5 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.11589 | acc=0.9811 | tpr=0.9530 | fpr=0.0184 | 6757.4 samples/s | 26.4 steps/s
[Step= 250] | Loss=0.11449 | acc=0.9814 | tpr=0.9511 | fpr=0.0181 | 6876.0 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.11656 | acc=0.9810 | tpr=0.9505 | fpr=0.0184 | 6845.1 samples/s | 26.7 steps/s
[Step= 350] | Loss=0.11614 | acc=0.9810 | tpr=0.9505 | fpr=0.0185 | 6819.6 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.11771 | acc=0.9808 | tpr=0.9469 | fpr=0.0186 | 6710.3 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.12002 | acc=0.9805 | tpr=0.9445 | fpr=0.0189 | 6940.0 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.11976 | acc=0.9805 | tpr=0.9467 | fpr=0.0189 | 6671.3 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.11940 | acc=0.9807 | tpr=0.9467 | fpr=0.0187 | 12871.3 samples/s | 50.3 steps/s
Avg test loss: 0.11930, Avg test acc: 0.98065, Avg tpr: 0.94612, Avg fpr: 0.01872, total FA: 2599

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11003 | acc=0.9811 | tpr=0.9425 | fpr=0.0182 | 3572.0 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.11253 | acc=0.9806 | tpr=0.9595 | fpr=0.0190 | 6554.2 samples/s | 25.6 steps/s
[Step= 150] | Loss=0.11474 | acc=0.9797 | tpr=0.9582 | fpr=0.0199 | 6873.8 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.11551 | acc=0.9798 | tpr=0.9574 | fpr=0.0197 | 6977.8 samples/s | 27.3 steps/s
[Step= 250] | Loss=0.11451 | acc=0.9799 | tpr=0.9563 | fpr=0.0196 | 6883.0 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.11682 | acc=0.9796 | tpr=0.9571 | fpr=0.0200 | 6831.6 samples/s | 26.7 steps/s
[Step= 350] | Loss=0.11639 | acc=0.9797 | tpr=0.9562 | fpr=0.0199 | 6958.0 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.11789 | acc=0.9796 | tpr=0.9540 | fpr=0.0200 | 6767.6 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.12015 | acc=0.9793 | tpr=0.9518 | fpr=0.0202 | 6799.4 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.11980 | acc=0.9793 | tpr=0.9537 | fpr=0.0203 | 6751.6 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.11927 | acc=0.9794 | tpr=0.9534 | fpr=0.0201 | 12611.3 samples/s | 49.3 steps/s
Avg test loss: 0.11920, Avg test acc: 0.97941, Avg tpr: 0.95285, Avg fpr: 0.02011, total FA: 2792

server round 28/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=56001 Epoch=109.2] | Loss=0.00064 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.207 | L2-Norm(final)=10.690 | 3251.1 samples/s | 50.8 steps/s
[Step=56050 Epoch=109.3] | Loss=0.01026 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.227 | L2-Norm(final)=10.692 | 3985.1 samples/s | 62.3 steps/s
[Step=56100 Epoch=109.4] | Loss=0.00963 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.239 | L2-Norm(final)=10.695 | 4318.7 samples/s | 67.5 steps/s
[Step=56150 Epoch=109.5] | Loss=0.00926 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.250 | L2-Norm(final)=10.700 | 4348.4 samples/s | 67.9 steps/s
[Step=56200 Epoch=109.6] | Loss=0.00939 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.259 | L2-Norm(final)=10.706 | 4367.6 samples/s | 68.2 steps/s
[Step=56250 Epoch=109.7] | Loss=0.00932 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.267 | L2-Norm(final)=10.712 | 4435.1 samples/s | 69.3 steps/s
[Step=56300 Epoch=109.8] | Loss=0.00911 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.274 | L2-Norm(final)=10.718 | 4410.2 samples/s | 68.9 steps/s
[Step=56350 Epoch=109.9] | Loss=0.00888 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.280 | L2-Norm(final)=10.725 | 4339.8 samples/s | 67.8 steps/s
[Step=56400 Epoch=110.0] | Loss=0.00873 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.286 | L2-Norm(final)=10.732 | 4430.2 samples/s | 69.2 steps/s
[Step=56450 Epoch=110.1] | Loss=0.00890 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.292 | L2-Norm(final)=10.739 | 4403.5 samples/s | 68.8 steps/s
[Step=56500 Epoch=110.2] | Loss=0.00862 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.299 | L2-Norm(final)=10.745 | 5545.6 samples/s | 86.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=56501 Epoch=110.2] | Loss=0.00180 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.359 | L2-Norm(final)=10.810 | 3092.5 samples/s | 48.3 steps/s
[Step=56550 Epoch=110.3] | Loss=0.00875 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.366 | L2-Norm(final)=10.818 | 3780.9 samples/s | 59.1 steps/s
[Step=56600 Epoch=110.4] | Loss=0.00839 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.373 | L2-Norm(final)=10.821 | 3964.3 samples/s | 61.9 steps/s
[Step=56650 Epoch=110.5] | Loss=0.00942 | Reg=0.00130 | acc=0.9531 | L2-Norm=11.381 | L2-Norm(final)=10.822 | 3971.0 samples/s | 62.0 steps/s
[Step=56700 Epoch=110.6] | Loss=0.01001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.390 | L2-Norm(final)=10.825 | 3973.6 samples/s | 62.1 steps/s
[Step=56750 Epoch=110.7] | Loss=0.01054 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.397 | L2-Norm(final)=10.827 | 3968.2 samples/s | 62.0 steps/s
[Step=56800 Epoch=110.8] | Loss=0.01073 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.406 | L2-Norm(final)=10.829 | 3928.8 samples/s | 61.4 steps/s
[Step=56850 Epoch=110.9] | Loss=0.01051 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.415 | L2-Norm(final)=10.832 | 3948.2 samples/s | 61.7 steps/s
[Step=56900 Epoch=111.0] | Loss=0.01051 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.423 | L2-Norm(final)=10.836 | 3948.1 samples/s | 61.7 steps/s
[Step=56950 Epoch=111.1] | Loss=0.01073 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.432 | L2-Norm(final)=10.839 | 3970.9 samples/s | 62.0 steps/s
[Step=57000 Epoch=111.2] | Loss=0.01072 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.440 | L2-Norm(final)=10.842 | 4708.5 samples/s | 73.6 steps/s
[Step=57050 Epoch=111.3] | Loss=0.01035 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.448 | L2-Norm(final)=10.845 | 1495.6 samples/s | 23.4 steps/s
[Step=57100 Epoch=111.4] | Loss=0.00994 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.456 | L2-Norm(final)=10.849 | 3938.4 samples/s | 61.5 steps/s
[Step=57150 Epoch=111.5] | Loss=0.00981 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.463 | L2-Norm(final)=10.853 | 3939.1 samples/s | 61.5 steps/s
[Step=57200 Epoch=111.6] | Loss=0.00964 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.470 | L2-Norm(final)=10.857 | 3869.4 samples/s | 60.5 steps/s
[Step=57250 Epoch=111.7] | Loss=0.00957 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.477 | L2-Norm(final)=10.861 | 3921.9 samples/s | 61.3 steps/s
[Step=57300 Epoch=111.8] | Loss=0.00940 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.484 | L2-Norm(final)=10.864 | 3951.2 samples/s | 61.7 steps/s
[Step=57350 Epoch=111.9] | Loss=0.00942 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.490 | L2-Norm(final)=10.868 | 3972.4 samples/s | 62.1 steps/s
[Step=57400 Epoch=112.0] | Loss=0.00936 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.496 | L2-Norm(final)=10.871 | 3924.6 samples/s | 61.3 steps/s
[Step=57450 Epoch=112.0] | Loss=0.00930 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.502 | L2-Norm(final)=10.875 | 4001.7 samples/s | 62.5 steps/s
[Step=57500 Epoch=112.1] | Loss=0.00927 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.507 | L2-Norm(final)=10.878 | 4202.4 samples/s | 65.7 steps/s
[Step=57550 Epoch=112.2] | Loss=0.00915 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.513 | L2-Norm(final)=10.881 | 1606.3 samples/s | 25.1 steps/s
[Step=57600 Epoch=112.3] | Loss=0.00893 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.518 | L2-Norm(final)=10.885 | 3963.2 samples/s | 61.9 steps/s
[Step=57650 Epoch=112.4] | Loss=0.00888 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.523 | L2-Norm(final)=10.888 | 3924.9 samples/s | 61.3 steps/s
[Step=57700 Epoch=112.5] | Loss=0.00872 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.528 | L2-Norm(final)=10.891 | 3921.6 samples/s | 61.3 steps/s
[Step=57750 Epoch=112.6] | Loss=0.00867 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.533 | L2-Norm(final)=10.894 | 3932.6 samples/s | 61.4 steps/s
[Step=57800 Epoch=112.7] | Loss=0.00856 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.538 | L2-Norm(final)=10.898 | 3902.2 samples/s | 61.0 steps/s
[Step=57850 Epoch=112.8] | Loss=0.00847 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.543 | L2-Norm(final)=10.901 | 3911.8 samples/s | 61.1 steps/s
[Step=57900 Epoch=112.9] | Loss=0.00843 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.548 | L2-Norm(final)=10.904 | 3938.4 samples/s | 61.5 steps/s
[Step=57950 Epoch=113.0] | Loss=0.00843 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.552 | L2-Norm(final)=10.907 | 3981.4 samples/s | 62.2 steps/s
[Step=58000 Epoch=113.1] | Loss=0.00845 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.557 | L2-Norm(final)=10.910 | 3898.1 samples/s | 60.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step58000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=56001 Epoch=109.5] | Loss=0.00378 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.207 | L2-Norm(final)=10.898 | 3163.5 samples/s | 49.4 steps/s
[Step=56050 Epoch=109.6] | Loss=0.00828 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.218 | L2-Norm(final)=10.900 | 4334.9 samples/s | 67.7 steps/s
[Step=56100 Epoch=109.7] | Loss=0.00932 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.225 | L2-Norm(final)=10.907 | 4388.5 samples/s | 68.6 steps/s
[Step=56150 Epoch=109.8] | Loss=0.00881 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.231 | L2-Norm(final)=10.911 | 4294.6 samples/s | 67.1 steps/s
[Step=56200 Epoch=109.9] | Loss=0.00841 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.237 | L2-Norm(final)=10.917 | 4334.2 samples/s | 67.7 steps/s
[Step=56250 Epoch=110.0] | Loss=0.00792 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.242 | L2-Norm(final)=10.924 | 4363.3 samples/s | 68.2 steps/s
[Step=56300 Epoch=110.1] | Loss=0.00797 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.248 | L2-Norm(final)=10.930 | 4421.7 samples/s | 69.1 steps/s
[Step=56350 Epoch=110.2] | Loss=0.00777 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.253 | L2-Norm(final)=10.936 | 4304.5 samples/s | 67.3 steps/s
[Step=56400 Epoch=110.3] | Loss=0.00768 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.259 | L2-Norm(final)=10.943 | 4404.0 samples/s | 68.8 steps/s
[Step=56450 Epoch=110.4] | Loss=0.00762 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.265 | L2-Norm(final)=10.950 | 4320.0 samples/s | 67.5 steps/s
[Step=56500 Epoch=110.5] | Loss=0.00754 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.270 | L2-Norm(final)=10.956 | 5599.8 samples/s | 87.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=56501 Epoch=110.5] | Loss=0.00067 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.326 | L2-Norm(final)=11.025 | 3281.8 samples/s | 51.3 steps/s
[Step=56550 Epoch=110.6] | Loss=0.00698 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.333 | L2-Norm(final)=11.031 | 3707.9 samples/s | 57.9 steps/s
[Step=56600 Epoch=110.7] | Loss=0.00715 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.345 | L2-Norm(final)=11.037 | 3931.0 samples/s | 61.4 steps/s
[Step=56650 Epoch=110.7] | Loss=0.00816 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.354 | L2-Norm(final)=11.041 | 3939.7 samples/s | 61.6 steps/s
[Step=56700 Epoch=110.8] | Loss=0.00925 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.364 | L2-Norm(final)=11.045 | 3963.8 samples/s | 61.9 steps/s
[Step=56750 Epoch=110.9] | Loss=0.00949 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.374 | L2-Norm(final)=11.048 | 3901.3 samples/s | 61.0 steps/s
[Step=56800 Epoch=111.0] | Loss=0.00956 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.383 | L2-Norm(final)=11.052 | 3981.5 samples/s | 62.2 steps/s
[Step=56850 Epoch=111.1] | Loss=0.00947 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.391 | L2-Norm(final)=11.056 | 3943.2 samples/s | 61.6 steps/s
[Step=56900 Epoch=111.2] | Loss=0.01002 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.399 | L2-Norm(final)=11.059 | 3983.0 samples/s | 62.2 steps/s
[Step=56950 Epoch=111.3] | Loss=0.00982 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.407 | L2-Norm(final)=11.062 | 3930.7 samples/s | 61.4 steps/s
[Step=57000 Epoch=111.4] | Loss=0.00961 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.414 | L2-Norm(final)=11.065 | 4901.2 samples/s | 76.6 steps/s
[Step=57050 Epoch=111.5] | Loss=0.00957 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.421 | L2-Norm(final)=11.069 | 1503.9 samples/s | 23.5 steps/s
[Step=57100 Epoch=111.6] | Loss=0.00945 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.427 | L2-Norm(final)=11.072 | 3920.8 samples/s | 61.3 steps/s
[Step=57150 Epoch=111.7] | Loss=0.00924 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.434 | L2-Norm(final)=11.075 | 3955.7 samples/s | 61.8 steps/s
[Step=57200 Epoch=111.8] | Loss=0.00920 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.440 | L2-Norm(final)=11.078 | 3950.3 samples/s | 61.7 steps/s
[Step=57250 Epoch=111.9] | Loss=0.00918 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.446 | L2-Norm(final)=11.081 | 3936.2 samples/s | 61.5 steps/s
[Step=57300 Epoch=112.0] | Loss=0.00905 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.452 | L2-Norm(final)=11.084 | 3949.1 samples/s | 61.7 steps/s
[Step=57350 Epoch=112.1] | Loss=0.00905 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.458 | L2-Norm(final)=11.087 | 3950.4 samples/s | 61.7 steps/s
[Step=57400 Epoch=112.2] | Loss=0.00896 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.464 | L2-Norm(final)=11.090 | 3889.1 samples/s | 60.8 steps/s
[Step=57450 Epoch=112.3] | Loss=0.00903 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.470 | L2-Norm(final)=11.093 | 3951.0 samples/s | 61.7 steps/s
[Step=57500 Epoch=112.4] | Loss=0.00905 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=11.096 | 4195.6 samples/s | 65.6 steps/s
[Step=57550 Epoch=112.5] | Loss=0.00901 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.482 | L2-Norm(final)=11.099 | 1594.9 samples/s | 24.9 steps/s
[Step=57600 Epoch=112.6] | Loss=0.00894 | Reg=0.00132 | acc=0.9688 | L2-Norm=11.488 | L2-Norm(final)=11.102 | 3896.1 samples/s | 60.9 steps/s
[Step=57650 Epoch=112.7] | Loss=0.00898 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.494 | L2-Norm(final)=11.105 | 3910.6 samples/s | 61.1 steps/s
[Step=57700 Epoch=112.8] | Loss=0.00901 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.500 | L2-Norm(final)=11.107 | 3914.8 samples/s | 61.2 steps/s
[Step=57750 Epoch=112.9] | Loss=0.00884 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.506 | L2-Norm(final)=11.110 | 3952.5 samples/s | 61.8 steps/s
[Step=57800 Epoch=113.0] | Loss=0.00879 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.511 | L2-Norm(final)=11.113 | 3915.8 samples/s | 61.2 steps/s
[Step=57850 Epoch=113.1] | Loss=0.00877 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.516 | L2-Norm(final)=11.116 | 3939.0 samples/s | 61.5 steps/s
[Step=57900 Epoch=113.2] | Loss=0.00871 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.522 | L2-Norm(final)=11.118 | 3946.6 samples/s | 61.7 steps/s
[Step=57950 Epoch=113.3] | Loss=0.00869 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.527 | L2-Norm(final)=11.121 | 3973.6 samples/s | 62.1 steps/s
[Step=58000 Epoch=113.4] | Loss=0.00862 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.532 | L2-Norm(final)=11.124 | 3980.1 samples/s | 62.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step58000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=56001 Epoch=214.6] | Loss=0.00004 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.207 | L2-Norm(final)=8.455 | 3298.1 samples/s | 51.5 steps/s
[Step=56050 Epoch=214.8] | Loss=0.00013 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.214 | L2-Norm(final)=8.461 | 3786.2 samples/s | 59.2 steps/s
[Step=56100 Epoch=215.0] | Loss=0.00018 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.221 | L2-Norm(final)=8.468 | 4049.5 samples/s | 63.3 steps/s
[Step=56150 Epoch=215.1] | Loss=0.00015 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.230 | L2-Norm(final)=8.474 | 4166.3 samples/s | 65.1 steps/s
[Step=56200 Epoch=215.3] | Loss=0.00012 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.234 | L2-Norm(final)=8.480 | 4094.4 samples/s | 64.0 steps/s
[Step=56250 Epoch=215.5] | Loss=0.00011 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.236 | L2-Norm(final)=8.485 | 5373.2 samples/s | 84.0 steps/s
[Step=56300 Epoch=215.7] | Loss=0.00009 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.235 | L2-Norm(final)=8.490 | 1502.6 samples/s | 23.5 steps/s
[Step=56350 Epoch=215.9] | Loss=0.00008 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.234 | L2-Norm(final)=8.494 | 4077.7 samples/s | 63.7 steps/s
[Step=56400 Epoch=216.1] | Loss=0.00007 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.232 | L2-Norm(final)=8.498 | 4071.2 samples/s | 63.6 steps/s
[Step=56450 Epoch=216.3] | Loss=0.00007 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.229 | L2-Norm(final)=8.502 | 4106.2 samples/s | 64.2 steps/s
[Step=56500 Epoch=216.5] | Loss=0.00006 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.226 | L2-Norm(final)=8.505 | 4676.8 samples/s | 73.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=56501 Epoch=216.5] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.195 | L2-Norm(final)=8.542 | 3226.5 samples/s | 50.4 steps/s
[Step=56550 Epoch=216.7] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.188 | L2-Norm(final)=8.545 | 3563.4 samples/s | 55.7 steps/s
[Step=56600 Epoch=216.9] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=8.547 | 3720.0 samples/s | 58.1 steps/s
[Step=56650 Epoch=217.1] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.168 | L2-Norm(final)=8.549 | 3682.1 samples/s | 57.5 steps/s
[Step=56700 Epoch=217.3] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.157 | L2-Norm(final)=8.551 | 3722.9 samples/s | 58.2 steps/s
[Step=56750 Epoch=217.4] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.147 | L2-Norm(final)=8.553 | 4708.0 samples/s | 73.6 steps/s
[Step=56800 Epoch=217.6] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.136 | L2-Norm(final)=8.554 | 1475.9 samples/s | 23.1 steps/s
[Step=56850 Epoch=217.8] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.126 | L2-Norm(final)=8.556 | 3718.9 samples/s | 58.1 steps/s
[Step=56900 Epoch=218.0] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.115 | L2-Norm(final)=8.557 | 3739.2 samples/s | 58.4 steps/s
[Step=56950 Epoch=218.2] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.104 | L2-Norm(final)=8.558 | 3669.9 samples/s | 57.3 steps/s
[Step=57000 Epoch=218.4] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.092 | L2-Norm(final)=8.560 | 4133.5 samples/s | 64.6 steps/s
[Step=57050 Epoch=218.6] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.081 | L2-Norm(final)=8.561 | 1515.3 samples/s | 23.7 steps/s
[Step=57100 Epoch=218.8] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.070 | L2-Norm(final)=8.562 | 3756.4 samples/s | 58.7 steps/s
[Step=57150 Epoch=219.0] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.058 | L2-Norm(final)=8.563 | 3750.1 samples/s | 58.6 steps/s
[Step=57200 Epoch=219.2] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.046 | L2-Norm(final)=8.564 | 3682.1 samples/s | 57.5 steps/s
[Step=57250 Epoch=219.4] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.035 | L2-Norm(final)=8.565 | 3711.1 samples/s | 58.0 steps/s
[Step=57300 Epoch=219.6] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.023 | L2-Norm(final)=8.566 | 1637.2 samples/s | 25.6 steps/s
[Step=57350 Epoch=219.7] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.011 | L2-Norm(final)=8.567 | 3728.7 samples/s | 58.3 steps/s
[Step=57400 Epoch=219.9] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.999 | L2-Norm(final)=8.568 | 3716.2 samples/s | 58.1 steps/s
[Step=57450 Epoch=220.1] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.986 | L2-Norm(final)=8.569 | 3805.5 samples/s | 59.5 steps/s
[Step=57500 Epoch=220.3] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.974 | L2-Norm(final)=8.570 | 3742.4 samples/s | 58.5 steps/s
[Step=57550 Epoch=220.5] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.962 | L2-Norm(final)=8.571 | 1618.8 samples/s | 25.3 steps/s
[Step=57600 Epoch=220.7] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.949 | L2-Norm(final)=8.572 | 3781.7 samples/s | 59.1 steps/s
[Step=57650 Epoch=220.9] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.937 | L2-Norm(final)=8.573 | 3684.1 samples/s | 57.6 steps/s
[Step=57700 Epoch=221.1] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.924 | L2-Norm(final)=8.574 | 3725.9 samples/s | 58.2 steps/s
[Step=57750 Epoch=221.3] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.911 | L2-Norm(final)=8.575 | 3744.1 samples/s | 58.5 steps/s
[Step=57800 Epoch=221.5] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.898 | L2-Norm(final)=8.577 | 5132.4 samples/s | 80.2 steps/s
[Step=57850 Epoch=221.7] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.885 | L2-Norm(final)=8.578 | 1447.1 samples/s | 22.6 steps/s
[Step=57900 Epoch=221.9] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.872 | L2-Norm(final)=8.579 | 3727.5 samples/s | 58.2 steps/s
[Step=57950 Epoch=222.0] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.859 | L2-Norm(final)=8.580 | 3709.3 samples/s | 58.0 steps/s
[Step=58000 Epoch=222.2] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.845 | L2-Norm(final)=8.581 | 3733.8 samples/s | 58.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step58000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=56001 Epoch=215.6] | Loss=0.00028 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.207 | L2-Norm(final)=8.852 | 3172.4 samples/s | 49.6 steps/s
[Step=56050 Epoch=215.8] | Loss=0.00052 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.239 | L2-Norm(final)=8.852 | 3998.6 samples/s | 62.5 steps/s
[Step=56100 Epoch=216.0] | Loss=0.00031 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.251 | L2-Norm(final)=8.856 | 4135.4 samples/s | 64.6 steps/s
[Step=56150 Epoch=216.1] | Loss=0.00024 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.257 | L2-Norm(final)=8.862 | 4112.2 samples/s | 64.3 steps/s
[Step=56200 Epoch=216.3] | Loss=0.00018 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.258 | L2-Norm(final)=8.866 | 4161.5 samples/s | 65.0 steps/s
[Step=56250 Epoch=216.5] | Loss=0.00016 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.257 | L2-Norm(final)=8.870 | 5427.5 samples/s | 84.8 steps/s
[Step=56300 Epoch=216.7] | Loss=0.00014 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.255 | L2-Norm(final)=8.873 | 1506.0 samples/s | 23.5 steps/s
[Step=56350 Epoch=216.9] | Loss=0.00012 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.252 | L2-Norm(final)=8.876 | 4167.9 samples/s | 65.1 steps/s
[Step=56400 Epoch=217.1] | Loss=0.00011 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.249 | L2-Norm(final)=8.879 | 4083.9 samples/s | 63.8 steps/s
[Step=56450 Epoch=217.3] | Loss=0.00010 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.246 | L2-Norm(final)=8.882 | 4114.5 samples/s | 64.3 steps/s
[Step=56500 Epoch=217.5] | Loss=0.00009 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.243 | L2-Norm(final)=8.885 | 4843.2 samples/s | 75.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=56501 Epoch=217.5] | Loss=0.00003 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.209 | L2-Norm(final)=8.912 | 3264.2 samples/s | 51.0 steps/s
[Step=56550 Epoch=217.7] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.202 | L2-Norm(final)=8.915 | 3471.8 samples/s | 54.2 steps/s
[Step=56600 Epoch=217.9] | Loss=0.00002 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.193 | L2-Norm(final)=8.917 | 3723.2 samples/s | 58.2 steps/s
[Step=56650 Epoch=218.1] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.183 | L2-Norm(final)=8.918 | 3726.3 samples/s | 58.2 steps/s
[Step=56700 Epoch=218.3] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.173 | L2-Norm(final)=8.920 | 3696.3 samples/s | 57.8 steps/s
[Step=56750 Epoch=218.5] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.163 | L2-Norm(final)=8.921 | 4862.6 samples/s | 76.0 steps/s
[Step=56800 Epoch=218.6] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.153 | L2-Norm(final)=8.922 | 1421.9 samples/s | 22.2 steps/s
[Step=56850 Epoch=218.8] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.142 | L2-Norm(final)=8.924 | 3721.8 samples/s | 58.2 steps/s
[Step=56900 Epoch=219.0] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.132 | L2-Norm(final)=8.925 | 3676.4 samples/s | 57.4 steps/s
[Step=56950 Epoch=219.2] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.121 | L2-Norm(final)=8.926 | 3698.4 samples/s | 57.8 steps/s
[Step=57000 Epoch=219.4] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.110 | L2-Norm(final)=8.926 | 4132.0 samples/s | 64.6 steps/s
[Step=57050 Epoch=219.6] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.099 | L2-Norm(final)=8.927 | 1490.6 samples/s | 23.3 steps/s
[Step=57100 Epoch=219.8] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.088 | L2-Norm(final)=8.928 | 3652.3 samples/s | 57.1 steps/s
[Step=57150 Epoch=220.0] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.077 | L2-Norm(final)=8.929 | 3684.5 samples/s | 57.6 steps/s
[Step=57200 Epoch=220.2] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.066 | L2-Norm(final)=8.930 | 3697.4 samples/s | 57.8 steps/s
[Step=57250 Epoch=220.4] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.055 | L2-Norm(final)=8.931 | 3775.0 samples/s | 59.0 steps/s
[Step=57300 Epoch=220.6] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.043 | L2-Norm(final)=8.932 | 1577.1 samples/s | 24.6 steps/s
[Step=57350 Epoch=220.8] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.032 | L2-Norm(final)=8.932 | 3694.5 samples/s | 57.7 steps/s
[Step=57400 Epoch=221.0] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.020 | L2-Norm(final)=8.933 | 3748.0 samples/s | 58.6 steps/s
[Step=57450 Epoch=221.1] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.008 | L2-Norm(final)=8.934 | 3727.4 samples/s | 58.2 steps/s
[Step=57500 Epoch=221.3] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.996 | L2-Norm(final)=8.935 | 3730.4 samples/s | 58.3 steps/s
[Step=57550 Epoch=221.5] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.984 | L2-Norm(final)=8.936 | 1571.4 samples/s | 24.6 steps/s
[Step=57600 Epoch=221.7] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.972 | L2-Norm(final)=8.937 | 3767.6 samples/s | 58.9 steps/s
[Step=57650 Epoch=221.9] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.960 | L2-Norm(final)=8.937 | 3763.7 samples/s | 58.8 steps/s
[Step=57700 Epoch=222.1] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.948 | L2-Norm(final)=8.938 | 3702.7 samples/s | 57.9 steps/s
[Step=57750 Epoch=222.3] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.935 | L2-Norm(final)=8.939 | 3708.8 samples/s | 57.9 steps/s
[Step=57800 Epoch=222.5] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=8.940 | 5502.9 samples/s | 86.0 steps/s
[Step=57850 Epoch=222.7] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.910 | L2-Norm(final)=8.941 | 1389.1 samples/s | 21.7 steps/s
[Step=57900 Epoch=222.9] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.897 | L2-Norm(final)=8.942 | 3646.8 samples/s | 57.0 steps/s
[Step=57950 Epoch=223.1] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.884 | L2-Norm(final)=8.943 | 3692.8 samples/s | 57.7 steps/s
[Step=58000 Epoch=223.3] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.871 | L2-Norm(final)=8.943 | 3696.0 samples/s | 57.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step58000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06580 | acc=0.9695 | tpr=0.9748 | fpr=0.0419 | 3503.1 samples/s | 13.7 steps/s
Avg test loss: 0.07068, Avg test acc: 0.96755, Avg tpr: 0.97284, Avg fpr: 0.04410, total FA: 344

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07624 | acc=0.9684 | tpr=0.9816 | fpr=0.0605 | 3530.4 samples/s | 13.8 steps/s
Avg test loss: 0.08404, Avg test acc: 0.96638, Avg tpr: 0.98077, Avg fpr: 0.06525, total FA: 509

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.38365 | acc=0.3147 | tpr=0.0138 | fpr=0.0320 | 3507.5 samples/s | 13.7 steps/s
Avg test loss: 5.39723, Avg test acc: 0.31228, Avg tpr: 0.01445, Avg fpr: 0.03269, total FA: 255

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.93166 | acc=0.3178 | tpr=0.0207 | fpr=0.0369 | 3517.9 samples/s | 13.7 steps/s
Avg test loss: 4.93941, Avg test acc: 0.31529, Avg tpr: 0.02081, Avg fpr: 0.03705, total FA: 289

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.98933 | acc=0.1148 | tpr=0.8186 | fpr=0.8978 | 3512.2 samples/s | 13.7 steps/s
[Step= 100] | Loss=5.96495 | acc=0.1149 | tpr=0.8166 | fpr=0.8982 | 6851.6 samples/s | 26.8 steps/s
[Step= 150] | Loss=5.97987 | acc=0.1137 | tpr=0.8271 | fpr=0.8995 | 4220.4 samples/s | 16.5 steps/s
[Step= 200] | Loss=5.96069 | acc=0.1139 | tpr=0.8175 | fpr=0.8989 | 7328.3 samples/s | 28.6 steps/s
[Step= 250] | Loss=5.95818 | acc=0.1143 | tpr=0.8122 | fpr=0.8984 | 6627.4 samples/s | 25.9 steps/s
[Step= 300] | Loss=5.95961 | acc=0.1140 | tpr=0.8124 | fpr=0.8987 | 6699.9 samples/s | 26.2 steps/s
[Step= 350] | Loss=5.95891 | acc=0.1143 | tpr=0.8197 | fpr=0.8985 | 6901.7 samples/s | 27.0 steps/s
[Step= 400] | Loss=5.95748 | acc=0.1141 | tpr=0.8146 | fpr=0.8986 | 6734.7 samples/s | 26.3 steps/s
[Step= 450] | Loss=5.96371 | acc=0.1139 | tpr=0.8189 | fpr=0.8989 | 6979.4 samples/s | 27.3 steps/s
[Step= 500] | Loss=5.96752 | acc=0.1138 | tpr=0.8211 | fpr=0.8990 | 6646.4 samples/s | 26.0 steps/s
[Step= 550] | Loss=5.96646 | acc=0.1141 | tpr=0.8217 | fpr=0.8988 | 12542.4 samples/s | 49.0 steps/s
Avg test loss: 5.96812, Avg test acc: 0.11404, Avg tpr: 0.82132, Avg fpr: 0.89882, total FA: 124799

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=7.60681 | acc=0.0882 | tpr=0.8717 | fpr=0.9259 | 3494.0 samples/s | 13.6 steps/s
[Step= 100] | Loss=7.56984 | acc=0.0898 | tpr=0.8785 | fpr=0.9250 | 4846.6 samples/s | 18.9 steps/s
[Step= 150] | Loss=7.58985 | acc=0.0893 | tpr=0.8804 | fpr=0.9253 | 5607.3 samples/s | 21.9 steps/s
[Step= 200] | Loss=7.57242 | acc=0.0886 | tpr=0.8645 | fpr=0.9255 | 6881.3 samples/s | 26.9 steps/s
[Step= 250] | Loss=7.57063 | acc=0.0887 | tpr=0.8585 | fpr=0.9253 | 6932.2 samples/s | 27.1 steps/s
[Step= 300] | Loss=7.57159 | acc=0.0883 | tpr=0.8495 | fpr=0.9256 | 6959.0 samples/s | 27.2 steps/s
[Step= 350] | Loss=7.57228 | acc=0.0885 | tpr=0.8541 | fpr=0.9254 | 6917.3 samples/s | 27.0 steps/s
[Step= 400] | Loss=7.56853 | acc=0.0887 | tpr=0.8523 | fpr=0.9252 | 6824.6 samples/s | 26.7 steps/s
[Step= 450] | Loss=7.57577 | acc=0.0885 | tpr=0.8559 | fpr=0.9254 | 6674.7 samples/s | 26.1 steps/s
[Step= 500] | Loss=7.57682 | acc=0.0882 | tpr=0.8555 | fpr=0.9256 | 6594.9 samples/s | 25.8 steps/s
[Step= 550] | Loss=7.57623 | acc=0.0883 | tpr=0.8575 | fpr=0.9257 | 12620.0 samples/s | 49.3 steps/s
Avg test loss: 7.57771, Avg test acc: 0.08822, Avg tpr: 0.85737, Avg fpr: 0.92576, total FA: 128540

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10962 | acc=0.9818 | tpr=0.9381 | fpr=0.0174 | 3467.5 samples/s | 13.5 steps/s
[Step= 100] | Loss=0.11209 | acc=0.9818 | tpr=0.9531 | fpr=0.0177 | 4221.0 samples/s | 16.5 steps/s
[Step= 150] | Loss=0.11455 | acc=0.9811 | tpr=0.9524 | fpr=0.0183 | 6713.3 samples/s | 26.2 steps/s
[Step= 200] | Loss=0.11527 | acc=0.9811 | tpr=0.9497 | fpr=0.0184 | 6937.1 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.11395 | acc=0.9812 | tpr=0.9467 | fpr=0.0181 | 6772.2 samples/s | 26.5 steps/s
[Step= 300] | Loss=0.11601 | acc=0.9809 | tpr=0.9469 | fpr=0.0184 | 6771.6 samples/s | 26.5 steps/s
[Step= 350] | Loss=0.11567 | acc=0.9809 | tpr=0.9468 | fpr=0.0185 | 6880.3 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.11699 | acc=0.9808 | tpr=0.9447 | fpr=0.0185 | 6610.4 samples/s | 25.8 steps/s
[Step= 450] | Loss=0.11925 | acc=0.9805 | tpr=0.9435 | fpr=0.0188 | 7010.7 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.11897 | acc=0.9806 | tpr=0.9463 | fpr=0.0188 | 6930.4 samples/s | 27.1 steps/s
[Step= 550] | Loss=0.11855 | acc=0.9808 | tpr=0.9459 | fpr=0.0186 | 12121.8 samples/s | 47.4 steps/s
Avg test loss: 0.11845, Avg test acc: 0.98077, Avg tpr: 0.94532, Avg fpr: 0.01859, total FA: 2581

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11009 | acc=0.9821 | tpr=0.9425 | fpr=0.0172 | 3454.7 samples/s | 13.5 steps/s
[Step= 100] | Loss=0.11330 | acc=0.9817 | tpr=0.9616 | fpr=0.0179 | 4182.6 samples/s | 16.3 steps/s
[Step= 150] | Loss=0.11571 | acc=0.9808 | tpr=0.9597 | fpr=0.0188 | 6878.6 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.11659 | acc=0.9808 | tpr=0.9574 | fpr=0.0188 | 6944.1 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.11551 | acc=0.9809 | tpr=0.9555 | fpr=0.0186 | 6910.3 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.11787 | acc=0.9805 | tpr=0.9549 | fpr=0.0191 | 6725.8 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.11745 | acc=0.9804 | tpr=0.9543 | fpr=0.0191 | 6990.7 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.11886 | acc=0.9803 | tpr=0.9524 | fpr=0.0192 | 6554.3 samples/s | 25.6 steps/s
[Step= 450] | Loss=0.12118 | acc=0.9799 | tpr=0.9499 | fpr=0.0195 | 6836.1 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.12082 | acc=0.9800 | tpr=0.9515 | fpr=0.0195 | 6672.8 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.12023 | acc=0.9802 | tpr=0.9519 | fpr=0.0193 | 12466.2 samples/s | 48.7 steps/s
Avg test loss: 0.12016, Avg test acc: 0.98021, Avg tpr: 0.95127, Avg fpr: 0.01927, total FA: 2675

server round 29/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=58001 Epoch=113.1] | Loss=0.00458 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.970 | L2-Norm(final)=10.991 | 3173.1 samples/s | 49.6 steps/s
[Step=58050 Epoch=113.2] | Loss=0.00765 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.983 | L2-Norm(final)=10.997 | 3943.6 samples/s | 61.6 steps/s
[Step=58100 Epoch=113.3] | Loss=0.00744 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.994 | L2-Norm(final)=11.003 | 4357.7 samples/s | 68.1 steps/s
[Step=58150 Epoch=113.4] | Loss=0.00725 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.003 | L2-Norm(final)=11.011 | 4420.0 samples/s | 69.1 steps/s
[Step=58200 Epoch=113.5] | Loss=0.00783 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.010 | L2-Norm(final)=11.018 | 4332.7 samples/s | 67.7 steps/s
[Step=58250 Epoch=113.6] | Loss=0.00758 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.019 | L2-Norm(final)=11.025 | 4341.4 samples/s | 67.8 steps/s
[Step=58300 Epoch=113.7] | Loss=0.00748 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.026 | L2-Norm(final)=11.032 | 4407.4 samples/s | 68.9 steps/s
[Step=58350 Epoch=113.8] | Loss=0.00772 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.034 | L2-Norm(final)=11.039 | 4393.8 samples/s | 68.7 steps/s
[Step=58400 Epoch=113.9] | Loss=0.00764 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.041 | L2-Norm(final)=11.046 | 4290.0 samples/s | 67.0 steps/s
[Step=58450 Epoch=114.0] | Loss=0.00753 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.047 | L2-Norm(final)=11.053 | 4403.6 samples/s | 68.8 steps/s
[Step=58500 Epoch=114.1] | Loss=0.00742 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.054 | L2-Norm(final)=11.060 | 5458.5 samples/s | 85.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=58501 Epoch=114.1] | Loss=0.01030 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.124 | L2-Norm(final)=11.125 | 3082.5 samples/s | 48.2 steps/s
[Step=58550 Epoch=114.2] | Loss=0.00868 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.134 | L2-Norm(final)=11.131 | 3891.7 samples/s | 60.8 steps/s
[Step=58600 Epoch=114.3] | Loss=0.00884 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.141 | L2-Norm(final)=11.133 | 3986.6 samples/s | 62.3 steps/s
[Step=58650 Epoch=114.4] | Loss=0.00865 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.150 | L2-Norm(final)=11.137 | 3927.1 samples/s | 61.4 steps/s
[Step=58700 Epoch=114.5] | Loss=0.00961 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.160 | L2-Norm(final)=11.141 | 3943.2 samples/s | 61.6 steps/s
[Step=58750 Epoch=114.6] | Loss=0.01049 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.172 | L2-Norm(final)=11.143 | 3970.5 samples/s | 62.0 steps/s
[Step=58800 Epoch=114.7] | Loss=0.01144 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.184 | L2-Norm(final)=11.145 | 3918.8 samples/s | 61.2 steps/s
[Step=58850 Epoch=114.8] | Loss=0.01157 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.196 | L2-Norm(final)=11.147 | 3948.7 samples/s | 61.7 steps/s
[Step=58900 Epoch=114.9] | Loss=0.01113 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.208 | L2-Norm(final)=11.150 | 3981.3 samples/s | 62.2 steps/s
[Step=58950 Epoch=115.0] | Loss=0.01126 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.220 | L2-Norm(final)=11.154 | 3963.1 samples/s | 61.9 steps/s
[Step=59000 Epoch=115.1] | Loss=0.01096 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.230 | L2-Norm(final)=11.157 | 4866.4 samples/s | 76.0 steps/s
[Step=59050 Epoch=115.2] | Loss=0.01095 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.240 | L2-Norm(final)=11.161 | 1471.6 samples/s | 23.0 steps/s
[Step=59100 Epoch=115.3] | Loss=0.01055 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.249 | L2-Norm(final)=11.164 | 3933.6 samples/s | 61.5 steps/s
[Step=59150 Epoch=115.4] | Loss=0.01036 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.257 | L2-Norm(final)=11.168 | 3930.8 samples/s | 61.4 steps/s
[Step=59200 Epoch=115.5] | Loss=0.01017 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.264 | L2-Norm(final)=11.172 | 3912.0 samples/s | 61.1 steps/s
[Step=59250 Epoch=115.6] | Loss=0.01005 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.272 | L2-Norm(final)=11.176 | 3961.2 samples/s | 61.9 steps/s
[Step=59300 Epoch=115.7] | Loss=0.00986 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.279 | L2-Norm(final)=11.180 | 3947.8 samples/s | 61.7 steps/s
[Step=59350 Epoch=115.8] | Loss=0.00984 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.286 | L2-Norm(final)=11.184 | 3906.2 samples/s | 61.0 steps/s
[Step=59400 Epoch=115.9] | Loss=0.00976 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.292 | L2-Norm(final)=11.187 | 3986.6 samples/s | 62.3 steps/s
[Step=59450 Epoch=116.0] | Loss=0.00974 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.299 | L2-Norm(final)=11.190 | 3990.1 samples/s | 62.3 steps/s
[Step=59500 Epoch=116.0] | Loss=0.00966 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.305 | L2-Norm(final)=11.193 | 4189.6 samples/s | 65.5 steps/s
[Step=59550 Epoch=116.1] | Loss=0.00953 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.311 | L2-Norm(final)=11.196 | 1563.8 samples/s | 24.4 steps/s
[Step=59600 Epoch=116.2] | Loss=0.00933 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.317 | L2-Norm(final)=11.199 | 4019.8 samples/s | 62.8 steps/s
[Step=59650 Epoch=116.3] | Loss=0.00911 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.322 | L2-Norm(final)=11.202 | 3935.6 samples/s | 61.5 steps/s
[Step=59700 Epoch=116.4] | Loss=0.00912 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.327 | L2-Norm(final)=11.205 | 3928.8 samples/s | 61.4 steps/s
[Step=59750 Epoch=116.5] | Loss=0.00903 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.333 | L2-Norm(final)=11.208 | 3916.1 samples/s | 61.2 steps/s
[Step=59800 Epoch=116.6] | Loss=0.00898 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.338 | L2-Norm(final)=11.212 | 3916.9 samples/s | 61.2 steps/s
[Step=59850 Epoch=116.7] | Loss=0.00898 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.343 | L2-Norm(final)=11.214 | 3978.3 samples/s | 62.2 steps/s
[Step=59900 Epoch=116.8] | Loss=0.00896 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.348 | L2-Norm(final)=11.217 | 3963.5 samples/s | 61.9 steps/s
[Step=59950 Epoch=116.9] | Loss=0.00899 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.353 | L2-Norm(final)=11.220 | 3945.7 samples/s | 61.7 steps/s
[Step=60000 Epoch=117.0] | Loss=0.00891 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=11.223 | 3962.4 samples/s | 61.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step60000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=58001 Epoch=113.4] | Loss=0.01952 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.970 | L2-Norm(final)=11.208 | 2847.8 samples/s | 44.5 steps/s
[Step=58050 Epoch=113.5] | Loss=0.00981 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.979 | L2-Norm(final)=11.209 | 2039.2 samples/s | 31.9 steps/s
[Step=58100 Epoch=113.6] | Loss=0.00970 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.986 | L2-Norm(final)=11.216 | 3979.2 samples/s | 62.2 steps/s
[Step=58150 Epoch=113.7] | Loss=0.00860 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.992 | L2-Norm(final)=11.225 | 4381.5 samples/s | 68.5 steps/s
[Step=58200 Epoch=113.8] | Loss=0.00852 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.998 | L2-Norm(final)=11.232 | 4125.1 samples/s | 64.5 steps/s
[Step=58250 Epoch=113.9] | Loss=0.00848 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.005 | L2-Norm(final)=11.239 | 4266.3 samples/s | 66.7 steps/s
[Step=58300 Epoch=114.0] | Loss=0.00813 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.011 | L2-Norm(final)=11.245 | 4427.1 samples/s | 69.2 steps/s
[Step=58350 Epoch=114.1] | Loss=0.00780 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.017 | L2-Norm(final)=11.251 | 4038.1 samples/s | 63.1 steps/s
[Step=58400 Epoch=114.2] | Loss=0.00764 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.022 | L2-Norm(final)=11.258 | 4371.3 samples/s | 68.3 steps/s
[Step=58450 Epoch=114.3] | Loss=0.00758 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.028 | L2-Norm(final)=11.264 | 4321.1 samples/s | 67.5 steps/s
[Step=58500 Epoch=114.4] | Loss=0.00758 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.034 | L2-Norm(final)=11.270 | 5493.8 samples/s | 85.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=58501 Epoch=114.4] | Loss=0.02484 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.089 | L2-Norm(final)=11.333 | 3248.0 samples/s | 50.8 steps/s
[Step=58550 Epoch=114.5] | Loss=0.00599 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.097 | L2-Norm(final)=11.341 | 3780.8 samples/s | 59.1 steps/s
[Step=58600 Epoch=114.6] | Loss=0.00780 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.106 | L2-Norm(final)=11.345 | 3900.3 samples/s | 60.9 steps/s
[Step=58650 Epoch=114.7] | Loss=0.00844 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.114 | L2-Norm(final)=11.349 | 3870.5 samples/s | 60.5 steps/s
[Step=58700 Epoch=114.8] | Loss=0.00888 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.124 | L2-Norm(final)=11.352 | 3924.1 samples/s | 61.3 steps/s
[Step=58750 Epoch=114.9] | Loss=0.00967 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.134 | L2-Norm(final)=11.356 | 3935.0 samples/s | 61.5 steps/s
[Step=58800 Epoch=115.0] | Loss=0.00986 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.143 | L2-Norm(final)=11.359 | 3928.5 samples/s | 61.4 steps/s
[Step=58850 Epoch=115.1] | Loss=0.01023 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.152 | L2-Norm(final)=11.362 | 3920.9 samples/s | 61.3 steps/s
[Step=58900 Epoch=115.1] | Loss=0.01007 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.160 | L2-Norm(final)=11.365 | 3952.8 samples/s | 61.8 steps/s
[Step=58950 Epoch=115.2] | Loss=0.01022 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.169 | L2-Norm(final)=11.369 | 3897.7 samples/s | 60.9 steps/s
[Step=59000 Epoch=115.3] | Loss=0.00979 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.177 | L2-Norm(final)=11.373 | 4924.7 samples/s | 76.9 steps/s
[Step=59050 Epoch=115.4] | Loss=0.00986 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.185 | L2-Norm(final)=11.377 | 1511.8 samples/s | 23.6 steps/s
[Step=59100 Epoch=115.5] | Loss=0.00967 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.193 | L2-Norm(final)=11.380 | 3977.9 samples/s | 62.2 steps/s
[Step=59150 Epoch=115.6] | Loss=0.00970 | Reg=0.00125 | acc=0.9531 | L2-Norm=11.200 | L2-Norm(final)=11.384 | 3909.6 samples/s | 61.1 steps/s
[Step=59200 Epoch=115.7] | Loss=0.00959 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.207 | L2-Norm(final)=11.387 | 3971.4 samples/s | 62.1 steps/s
[Step=59250 Epoch=115.8] | Loss=0.00949 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.214 | L2-Norm(final)=11.390 | 3920.8 samples/s | 61.3 steps/s
[Step=59300 Epoch=115.9] | Loss=0.00949 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.221 | L2-Norm(final)=11.393 | 3909.1 samples/s | 61.1 steps/s
[Step=59350 Epoch=116.0] | Loss=0.00948 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.228 | L2-Norm(final)=11.396 | 3911.0 samples/s | 61.1 steps/s
[Step=59400 Epoch=116.1] | Loss=0.00946 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.235 | L2-Norm(final)=11.399 | 3998.1 samples/s | 62.5 steps/s
[Step=59450 Epoch=116.2] | Loss=0.00941 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.241 | L2-Norm(final)=11.402 | 3956.5 samples/s | 61.8 steps/s
[Step=59500 Epoch=116.3] | Loss=0.00925 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.248 | L2-Norm(final)=11.405 | 4236.4 samples/s | 66.2 steps/s
[Step=59550 Epoch=116.4] | Loss=0.00914 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.254 | L2-Norm(final)=11.408 | 1597.3 samples/s | 25.0 steps/s
[Step=59600 Epoch=116.5] | Loss=0.00896 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=11.411 | 3967.2 samples/s | 62.0 steps/s
[Step=59650 Epoch=116.6] | Loss=0.00886 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.266 | L2-Norm(final)=11.415 | 3878.0 samples/s | 60.6 steps/s
[Step=59700 Epoch=116.7] | Loss=0.00872 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.271 | L2-Norm(final)=11.418 | 3908.9 samples/s | 61.1 steps/s
[Step=59750 Epoch=116.8] | Loss=0.00857 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.277 | L2-Norm(final)=11.422 | 3967.6 samples/s | 62.0 steps/s
[Step=59800 Epoch=116.9] | Loss=0.00857 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.282 | L2-Norm(final)=11.425 | 3940.9 samples/s | 61.6 steps/s
[Step=59850 Epoch=117.0] | Loss=0.00858 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.287 | L2-Norm(final)=11.428 | 3951.7 samples/s | 61.7 steps/s
[Step=59900 Epoch=117.1] | Loss=0.00847 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.292 | L2-Norm(final)=11.431 | 3946.8 samples/s | 61.7 steps/s
[Step=59950 Epoch=117.2] | Loss=0.00839 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.297 | L2-Norm(final)=11.434 | 3971.6 samples/s | 62.1 steps/s
[Step=60000 Epoch=117.3] | Loss=0.00833 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.302 | L2-Norm(final)=11.437 | 3906.4 samples/s | 61.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step60000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=58001 Epoch=222.2] | Loss=0.00065 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.970 | L2-Norm(final)=8.619 | 3141.2 samples/s | 49.1 steps/s
[Step=58050 Epoch=222.4] | Loss=0.00023 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.987 | L2-Norm(final)=8.636 | 3950.7 samples/s | 61.7 steps/s
[Step=58100 Epoch=222.6] | Loss=0.00013 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.001 | L2-Norm(final)=8.653 | 4190.3 samples/s | 65.5 steps/s
[Step=58150 Epoch=222.8] | Loss=0.00010 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.001 | L2-Norm(final)=8.663 | 4017.7 samples/s | 62.8 steps/s
[Step=58200 Epoch=223.0] | Loss=0.00009 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.998 | L2-Norm(final)=8.672 | 4128.6 samples/s | 64.5 steps/s
[Step=58250 Epoch=223.2] | Loss=0.00008 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.996 | L2-Norm(final)=8.680 | 5287.8 samples/s | 82.6 steps/s
[Step=58300 Epoch=223.4] | Loss=0.00007 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.992 | L2-Norm(final)=8.687 | 1538.1 samples/s | 24.0 steps/s
[Step=58350 Epoch=223.6] | Loss=0.00006 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.988 | L2-Norm(final)=8.694 | 4085.6 samples/s | 63.8 steps/s
[Step=58400 Epoch=223.8] | Loss=0.00005 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.983 | L2-Norm(final)=8.700 | 4170.8 samples/s | 65.2 steps/s
[Step=58450 Epoch=224.0] | Loss=0.00005 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.977 | L2-Norm(final)=8.706 | 4034.2 samples/s | 63.0 steps/s
[Step=58500 Epoch=224.2] | Loss=0.00005 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.972 | L2-Norm(final)=8.712 | 4681.9 samples/s | 73.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=58501 Epoch=224.2] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.917 | L2-Norm(final)=8.765 | 3385.1 samples/s | 52.9 steps/s
[Step=58550 Epoch=224.3] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.901 | L2-Norm(final)=8.769 | 3424.7 samples/s | 53.5 steps/s
[Step=58600 Epoch=224.5] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.882 | L2-Norm(final)=8.773 | 3694.3 samples/s | 57.7 steps/s
[Step=58650 Epoch=224.7] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.861 | L2-Norm(final)=8.775 | 3709.2 samples/s | 58.0 steps/s
[Step=58700 Epoch=224.9] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.840 | L2-Norm(final)=8.778 | 3708.7 samples/s | 57.9 steps/s
[Step=58750 Epoch=225.1] | Loss=0.00084 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.825 | L2-Norm(final)=8.780 | 4754.8 samples/s | 74.3 steps/s
[Step=58800 Epoch=225.3] | Loss=0.00099 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.835 | L2-Norm(final)=8.777 | 1481.8 samples/s | 23.2 steps/s
[Step=58850 Epoch=225.5] | Loss=0.00115 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.848 | L2-Norm(final)=8.774 | 3757.7 samples/s | 58.7 steps/s
[Step=58900 Epoch=225.7] | Loss=0.00102 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.858 | L2-Norm(final)=8.771 | 3754.8 samples/s | 58.7 steps/s
[Step=58950 Epoch=225.9] | Loss=0.00093 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.866 | L2-Norm(final)=8.769 | 3715.1 samples/s | 58.0 steps/s
[Step=59000 Epoch=226.1] | Loss=0.00085 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.872 | L2-Norm(final)=8.768 | 4129.1 samples/s | 64.5 steps/s
[Step=59050 Epoch=226.3] | Loss=0.00078 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.877 | L2-Norm(final)=8.767 | 1557.6 samples/s | 24.3 steps/s
[Step=59100 Epoch=226.5] | Loss=0.00071 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=8.766 | 3787.9 samples/s | 59.2 steps/s
[Step=59150 Epoch=226.6] | Loss=0.00066 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.883 | L2-Norm(final)=8.766 | 3745.9 samples/s | 58.5 steps/s
[Step=59200 Epoch=226.8] | Loss=0.00061 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.885 | L2-Norm(final)=8.765 | 3706.2 samples/s | 57.9 steps/s
[Step=59250 Epoch=227.0] | Loss=0.00057 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.886 | L2-Norm(final)=8.765 | 3753.4 samples/s | 58.6 steps/s
[Step=59300 Epoch=227.2] | Loss=0.00054 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.887 | L2-Norm(final)=8.765 | 1591.2 samples/s | 24.9 steps/s
[Step=59350 Epoch=227.4] | Loss=0.00051 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.887 | L2-Norm(final)=8.765 | 3787.2 samples/s | 59.2 steps/s
[Step=59400 Epoch=227.6] | Loss=0.00048 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.888 | L2-Norm(final)=8.765 | 3814.0 samples/s | 59.6 steps/s
[Step=59450 Epoch=227.8] | Loss=0.00046 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.887 | L2-Norm(final)=8.765 | 3750.4 samples/s | 58.6 steps/s
[Step=59500 Epoch=228.0] | Loss=0.00043 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.887 | L2-Norm(final)=8.765 | 3681.4 samples/s | 57.5 steps/s
[Step=59550 Epoch=228.2] | Loss=0.00041 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.886 | L2-Norm(final)=8.766 | 1634.0 samples/s | 25.5 steps/s
[Step=59600 Epoch=228.4] | Loss=0.00039 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.885 | L2-Norm(final)=8.766 | 3700.5 samples/s | 57.8 steps/s
[Step=59650 Epoch=228.6] | Loss=0.00038 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.884 | L2-Norm(final)=8.766 | 3684.4 samples/s | 57.6 steps/s
[Step=59700 Epoch=228.7] | Loss=0.00036 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.883 | L2-Norm(final)=8.766 | 3731.4 samples/s | 58.3 steps/s
[Step=59750 Epoch=228.9] | Loss=0.00035 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.882 | L2-Norm(final)=8.767 | 3705.7 samples/s | 57.9 steps/s
[Step=59800 Epoch=229.1] | Loss=0.00033 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=8.767 | 5092.1 samples/s | 79.6 steps/s
[Step=59850 Epoch=229.3] | Loss=0.00032 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.878 | L2-Norm(final)=8.767 | 1429.1 samples/s | 22.3 steps/s
[Step=59900 Epoch=229.5] | Loss=0.00031 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.877 | L2-Norm(final)=8.768 | 3737.3 samples/s | 58.4 steps/s
[Step=59950 Epoch=229.7] | Loss=0.00030 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.875 | L2-Norm(final)=8.768 | 3758.4 samples/s | 58.7 steps/s
[Step=60000 Epoch=229.9] | Loss=0.00029 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.873 | L2-Norm(final)=8.769 | 3735.0 samples/s | 58.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step60000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=58001 Epoch=223.3] | Loss=0.00011 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.970 | L2-Norm(final)=8.971 | 3302.9 samples/s | 51.6 steps/s
[Step=58050 Epoch=223.5] | Loss=0.00020 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.999 | L2-Norm(final)=8.982 | 3829.1 samples/s | 59.8 steps/s
[Step=58100 Epoch=223.6] | Loss=0.00014 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.005 | L2-Norm(final)=8.990 | 4120.2 samples/s | 64.4 steps/s
[Step=58150 Epoch=223.8] | Loss=0.00012 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.008 | L2-Norm(final)=8.999 | 4122.3 samples/s | 64.4 steps/s
[Step=58200 Epoch=224.0] | Loss=0.00010 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.010 | L2-Norm(final)=9.008 | 4208.9 samples/s | 65.8 steps/s
[Step=58250 Epoch=224.2] | Loss=0.00009 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.008 | L2-Norm(final)=9.015 | 5426.1 samples/s | 84.8 steps/s
[Step=58300 Epoch=224.4] | Loss=0.00007 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.006 | L2-Norm(final)=9.021 | 1483.5 samples/s | 23.2 steps/s
[Step=58350 Epoch=224.6] | Loss=0.00006 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.002 | L2-Norm(final)=9.026 | 4104.6 samples/s | 64.1 steps/s
[Step=58400 Epoch=224.8] | Loss=0.00006 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.997 | L2-Norm(final)=9.031 | 4105.4 samples/s | 64.1 steps/s
[Step=58450 Epoch=225.0] | Loss=0.00005 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.992 | L2-Norm(final)=9.036 | 4179.2 samples/s | 65.3 steps/s
[Step=58500 Epoch=225.2] | Loss=0.00005 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.988 | L2-Norm(final)=9.040 | 4771.7 samples/s | 74.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=58501 Epoch=225.2] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.939 | L2-Norm(final)=9.085 | 3167.0 samples/s | 49.5 steps/s
[Step=58550 Epoch=225.4] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.924 | L2-Norm(final)=9.087 | 3557.3 samples/s | 55.6 steps/s
[Step=58600 Epoch=225.6] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.904 | L2-Norm(final)=9.090 | 3710.5 samples/s | 58.0 steps/s
[Step=58650 Epoch=225.8] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.884 | L2-Norm(final)=9.092 | 3731.6 samples/s | 58.3 steps/s
[Step=58700 Epoch=226.0] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.864 | L2-Norm(final)=9.094 | 3775.0 samples/s | 59.0 steps/s
[Step=58750 Epoch=226.2] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.844 | L2-Norm(final)=9.097 | 4751.0 samples/s | 74.2 steps/s
[Step=58800 Epoch=226.3] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.823 | L2-Norm(final)=9.098 | 1424.8 samples/s | 22.3 steps/s
[Step=58850 Epoch=226.5] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.802 | L2-Norm(final)=9.100 | 3688.5 samples/s | 57.6 steps/s
[Step=58900 Epoch=226.7] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.781 | L2-Norm(final)=9.101 | 3773.7 samples/s | 59.0 steps/s
[Step=58950 Epoch=226.9] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.759 | L2-Norm(final)=9.103 | 3671.6 samples/s | 57.4 steps/s
[Step=59000 Epoch=227.1] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.737 | L2-Norm(final)=9.104 | 4200.4 samples/s | 65.6 steps/s
[Step=59050 Epoch=227.3] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.715 | L2-Norm(final)=9.105 | 1473.5 samples/s | 23.0 steps/s
[Step=59100 Epoch=227.5] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.692 | L2-Norm(final)=9.106 | 3711.4 samples/s | 58.0 steps/s
[Step=59150 Epoch=227.7] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.670 | L2-Norm(final)=9.107 | 3705.2 samples/s | 57.9 steps/s
[Step=59200 Epoch=227.9] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.647 | L2-Norm(final)=9.108 | 3706.8 samples/s | 57.9 steps/s
[Step=59250 Epoch=228.1] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=9.109 | 3768.5 samples/s | 58.9 steps/s
[Step=59300 Epoch=228.3] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.601 | L2-Norm(final)=9.110 | 1565.8 samples/s | 24.5 steps/s
[Step=59350 Epoch=228.5] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.578 | L2-Norm(final)=9.111 | 3710.5 samples/s | 58.0 steps/s
[Step=59400 Epoch=228.7] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.555 | L2-Norm(final)=9.112 | 3687.9 samples/s | 57.6 steps/s
[Step=59450 Epoch=228.8] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.531 | L2-Norm(final)=9.113 | 3729.9 samples/s | 58.3 steps/s
[Step=59500 Epoch=229.0] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.508 | L2-Norm(final)=9.114 | 3706.1 samples/s | 57.9 steps/s
[Step=59550 Epoch=229.2] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.484 | L2-Norm(final)=9.115 | 1559.9 samples/s | 24.4 steps/s
[Step=59600 Epoch=229.4] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.460 | L2-Norm(final)=9.117 | 3770.7 samples/s | 58.9 steps/s
[Step=59650 Epoch=229.6] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.436 | L2-Norm(final)=9.118 | 3682.5 samples/s | 57.5 steps/s
[Step=59700 Epoch=229.8] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.412 | L2-Norm(final)=9.119 | 3701.8 samples/s | 57.8 steps/s
[Step=59750 Epoch=230.0] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.387 | L2-Norm(final)=9.120 | 3689.6 samples/s | 57.7 steps/s
[Step=59800 Epoch=230.2] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.363 | L2-Norm(final)=9.121 | 5493.9 samples/s | 85.8 steps/s
[Step=59850 Epoch=230.4] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.338 | L2-Norm(final)=9.123 | 1394.7 samples/s | 21.8 steps/s
[Step=59900 Epoch=230.6] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.314 | L2-Norm(final)=9.124 | 3642.1 samples/s | 56.9 steps/s
[Step=59950 Epoch=230.8] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.289 | L2-Norm(final)=9.125 | 3671.1 samples/s | 57.4 steps/s
[Step=60000 Epoch=231.0] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.264 | L2-Norm(final)=9.127 | 3692.8 samples/s | 57.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step60000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06978 | acc=0.9705 | tpr=0.9805 | fpr=0.0510 | 3535.9 samples/s | 13.8 steps/s
Avg test loss: 0.07332, Avg test acc: 0.96851, Avg tpr: 0.97808, Avg fpr: 0.05256, total FA: 410

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07079 | acc=0.9707 | tpr=0.9823 | fpr=0.0545 | 3554.5 samples/s | 13.9 steps/s
Avg test loss: 0.07743, Avg test acc: 0.96855, Avg tpr: 0.98042, Avg fpr: 0.05756, total FA: 449

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.89083 | acc=0.3109 | tpr=0.0181 | fpr=0.0533 | 3531.4 samples/s | 13.8 steps/s
Avg test loss: 4.89928, Avg test acc: 0.30880, Avg tpr: 0.01859, Avg fpr: 0.05294, total FA: 413

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.86716 | acc=0.3155 | tpr=0.0220 | fpr=0.0471 | 3528.4 samples/s | 13.8 steps/s
Avg test loss: 4.87491, Avg test acc: 0.31212, Avg tpr: 0.02151, Avg fpr: 0.04871, total FA: 380

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.46527 | acc=0.0786 | tpr=0.8850 | fpr=0.9359 | 3567.7 samples/s | 13.9 steps/s
[Step= 100] | Loss=6.44396 | acc=0.0802 | tpr=0.8913 | fpr=0.9349 | 6812.3 samples/s | 26.6 steps/s
[Step= 150] | Loss=6.46080 | acc=0.0797 | tpr=0.8847 | fpr=0.9352 | 6816.3 samples/s | 26.6 steps/s
[Step= 200] | Loss=6.44065 | acc=0.0793 | tpr=0.8754 | fpr=0.9352 | 6836.2 samples/s | 26.7 steps/s
[Step= 250] | Loss=6.43902 | acc=0.0797 | tpr=0.8707 | fpr=0.9347 | 7133.2 samples/s | 27.9 steps/s
[Step= 300] | Loss=6.44108 | acc=0.0796 | tpr=0.8720 | fpr=0.9348 | 6692.6 samples/s | 26.1 steps/s
[Step= 350] | Loss=6.43968 | acc=0.0801 | tpr=0.8766 | fpr=0.9343 | 7237.8 samples/s | 28.3 steps/s
[Step= 400] | Loss=6.43464 | acc=0.0800 | tpr=0.8747 | fpr=0.9344 | 6709.2 samples/s | 26.2 steps/s
[Step= 450] | Loss=6.44001 | acc=0.0799 | tpr=0.8734 | fpr=0.9345 | 6475.0 samples/s | 25.3 steps/s
[Step= 500] | Loss=6.44182 | acc=0.0798 | tpr=0.8718 | fpr=0.9345 | 6804.1 samples/s | 26.6 steps/s
[Step= 550] | Loss=6.44168 | acc=0.0798 | tpr=0.8723 | fpr=0.9346 | 12804.8 samples/s | 50.0 steps/s
Avg test loss: 6.44354, Avg test acc: 0.07972, Avg tpr: 0.87163, Avg fpr: 0.93468, total FA: 129778

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.67062 | acc=0.1004 | tpr=0.8761 | fpr=0.9136 | 3498.4 samples/s | 13.7 steps/s
[Step= 100] | Loss=6.63737 | acc=0.1025 | tpr=0.8870 | fpr=0.9121 | 6972.7 samples/s | 27.2 steps/s
[Step= 150] | Loss=6.65368 | acc=0.1021 | tpr=0.8804 | fpr=0.9122 | 6922.6 samples/s | 27.0 steps/s
[Step= 200] | Loss=6.63545 | acc=0.1019 | tpr=0.8732 | fpr=0.9121 | 6787.3 samples/s | 26.5 steps/s
[Step= 250] | Loss=6.63423 | acc=0.1020 | tpr=0.8655 | fpr=0.9119 | 6991.5 samples/s | 27.3 steps/s
[Step= 300] | Loss=6.63779 | acc=0.1015 | tpr=0.8611 | fpr=0.9124 | 6813.4 samples/s | 26.6 steps/s
[Step= 350] | Loss=6.63793 | acc=0.1016 | tpr=0.8666 | fpr=0.9123 | 6748.5 samples/s | 26.4 steps/s
[Step= 400] | Loss=6.63424 | acc=0.1019 | tpr=0.8605 | fpr=0.9119 | 6927.3 samples/s | 27.1 steps/s
[Step= 450] | Loss=6.64247 | acc=0.1015 | tpr=0.8632 | fpr=0.9123 | 7054.4 samples/s | 27.6 steps/s
[Step= 500] | Loss=6.64499 | acc=0.1015 | tpr=0.8639 | fpr=0.9123 | 6581.0 samples/s | 25.7 steps/s
[Step= 550] | Loss=6.64566 | acc=0.1016 | tpr=0.8663 | fpr=0.9123 | 12285.2 samples/s | 48.0 steps/s
Avg test loss: 6.64670, Avg test acc: 0.10156, Avg tpr: 0.86569, Avg fpr: 0.91233, total FA: 126675

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11786 | acc=0.9815 | tpr=0.9425 | fpr=0.0178 | 3496.8 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.12038 | acc=0.9812 | tpr=0.9574 | fpr=0.0183 | 6924.1 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.12365 | acc=0.9801 | tpr=0.9496 | fpr=0.0193 | 6763.3 samples/s | 26.4 steps/s
[Step= 200] | Loss=0.12502 | acc=0.9801 | tpr=0.9454 | fpr=0.0192 | 6904.3 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.12368 | acc=0.9803 | tpr=0.9432 | fpr=0.0190 | 6817.4 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.12620 | acc=0.9800 | tpr=0.9418 | fpr=0.0193 | 6941.0 samples/s | 27.1 steps/s
[Step= 350] | Loss=0.12615 | acc=0.9799 | tpr=0.9430 | fpr=0.0194 | 6883.3 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.12779 | acc=0.9797 | tpr=0.9398 | fpr=0.0196 | 6613.8 samples/s | 25.8 steps/s
[Step= 450] | Loss=0.13060 | acc=0.9793 | tpr=0.9391 | fpr=0.0200 | 6780.9 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.13022 | acc=0.9794 | tpr=0.9423 | fpr=0.0200 | 6638.1 samples/s | 25.9 steps/s
[Step= 550] | Loss=0.12958 | acc=0.9795 | tpr=0.9407 | fpr=0.0198 | 12430.9 samples/s | 48.6 steps/s
Avg test loss: 0.12944, Avg test acc: 0.97947, Avg tpr: 0.94017, Avg fpr: 0.01982, total FA: 2752

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11067 | acc=0.9817 | tpr=0.9381 | fpr=0.0175 | 3483.5 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.11497 | acc=0.9810 | tpr=0.9574 | fpr=0.0185 | 6895.7 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.11773 | acc=0.9798 | tpr=0.9582 | fpr=0.0198 | 7089.3 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.11857 | acc=0.9798 | tpr=0.9574 | fpr=0.0198 | 6612.0 samples/s | 25.8 steps/s
[Step= 250] | Loss=0.11726 | acc=0.9799 | tpr=0.9546 | fpr=0.0196 | 6851.3 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.11974 | acc=0.9795 | tpr=0.9549 | fpr=0.0201 | 7077.5 samples/s | 27.6 steps/s
[Step= 350] | Loss=0.11930 | acc=0.9795 | tpr=0.9549 | fpr=0.0200 | 6659.7 samples/s | 26.0 steps/s
[Step= 400] | Loss=0.12062 | acc=0.9794 | tpr=0.9540 | fpr=0.0201 | 6855.8 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.12302 | acc=0.9791 | tpr=0.9513 | fpr=0.0204 | 6792.7 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.12264 | acc=0.9791 | tpr=0.9533 | fpr=0.0204 | 6812.3 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.12186 | acc=0.9793 | tpr=0.9534 | fpr=0.0202 | 12942.6 samples/s | 50.6 steps/s
Avg test loss: 0.12181, Avg test acc: 0.97932, Avg tpr: 0.95325, Avg fpr: 0.02020, total FA: 2805

server round 30/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=60001 Epoch=117.0] | Loss=0.00431 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.674 | L2-Norm(final)=11.302 | 3141.4 samples/s | 49.1 steps/s
[Step=60050 Epoch=117.1] | Loss=0.01104 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.680 | L2-Norm(final)=11.304 | 4114.6 samples/s | 64.3 steps/s
[Step=60100 Epoch=117.2] | Loss=0.00903 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.685 | L2-Norm(final)=11.309 | 4313.6 samples/s | 67.4 steps/s
[Step=60150 Epoch=117.3] | Loss=0.00866 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.691 | L2-Norm(final)=11.314 | 4382.5 samples/s | 68.5 steps/s
[Step=60200 Epoch=117.4] | Loss=0.00895 | Reg=0.00114 | acc=0.9844 | L2-Norm=10.696 | L2-Norm(final)=11.320 | 4419.4 samples/s | 69.1 steps/s
[Step=60250 Epoch=117.5] | Loss=0.00849 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.700 | L2-Norm(final)=11.325 | 4362.0 samples/s | 68.2 steps/s
[Step=60300 Epoch=117.6] | Loss=0.00837 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=11.331 | 4309.8 samples/s | 67.3 steps/s
[Step=60350 Epoch=117.7] | Loss=0.00847 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.709 | L2-Norm(final)=11.337 | 4414.7 samples/s | 69.0 steps/s
[Step=60400 Epoch=117.8] | Loss=0.00848 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.713 | L2-Norm(final)=11.342 | 4430.8 samples/s | 69.2 steps/s
[Step=60450 Epoch=117.9] | Loss=0.00853 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.716 | L2-Norm(final)=11.348 | 4431.2 samples/s | 69.2 steps/s
[Step=60500 Epoch=118.0] | Loss=0.00842 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.720 | L2-Norm(final)=11.353 | 5482.7 samples/s | 85.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=60501 Epoch=118.0] | Loss=0.00786 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.760 | L2-Norm(final)=11.407 | 3160.7 samples/s | 49.4 steps/s
[Step=60550 Epoch=118.1] | Loss=0.00850 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.765 | L2-Norm(final)=11.412 | 3697.3 samples/s | 57.8 steps/s
[Step=60600 Epoch=118.2] | Loss=0.00794 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.770 | L2-Norm(final)=11.417 | 3986.1 samples/s | 62.3 steps/s
[Step=60650 Epoch=118.3] | Loss=0.00839 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.774 | L2-Norm(final)=11.421 | 3939.7 samples/s | 61.6 steps/s
[Step=60700 Epoch=118.4] | Loss=0.00822 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.779 | L2-Norm(final)=11.425 | 3928.6 samples/s | 61.4 steps/s
[Step=60750 Epoch=118.5] | Loss=0.00824 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.784 | L2-Norm(final)=11.430 | 4030.3 samples/s | 63.0 steps/s
[Step=60800 Epoch=118.6] | Loss=0.00824 | Reg=0.00116 | acc=0.9688 | L2-Norm=10.788 | L2-Norm(final)=11.434 | 3970.1 samples/s | 62.0 steps/s
[Step=60850 Epoch=118.7] | Loss=0.00798 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.792 | L2-Norm(final)=11.437 | 3977.1 samples/s | 62.1 steps/s
[Step=60900 Epoch=118.8] | Loss=0.00759 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.795 | L2-Norm(final)=11.441 | 3959.4 samples/s | 61.9 steps/s
[Step=60950 Epoch=118.9] | Loss=0.00754 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.799 | L2-Norm(final)=11.445 | 3976.5 samples/s | 62.1 steps/s
[Step=61000 Epoch=119.0] | Loss=0.00734 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.802 | L2-Norm(final)=11.448 | 4858.4 samples/s | 75.9 steps/s
[Step=61050 Epoch=119.1] | Loss=0.00715 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.806 | L2-Norm(final)=11.452 | 1464.1 samples/s | 22.9 steps/s
[Step=61100 Epoch=119.2] | Loss=0.00703 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.809 | L2-Norm(final)=11.456 | 3917.1 samples/s | 61.2 steps/s
[Step=61150 Epoch=119.3] | Loss=0.00691 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.812 | L2-Norm(final)=11.460 | 3958.3 samples/s | 61.8 steps/s
[Step=61200 Epoch=119.4] | Loss=0.00681 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.816 | L2-Norm(final)=11.464 | 3938.8 samples/s | 61.5 steps/s
[Step=61250 Epoch=119.5] | Loss=0.00682 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.818 | L2-Norm(final)=11.467 | 3944.2 samples/s | 61.6 steps/s
[Step=61300 Epoch=119.6] | Loss=0.00675 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.821 | L2-Norm(final)=11.470 | 3979.9 samples/s | 62.2 steps/s
[Step=61350 Epoch=119.7] | Loss=0.00667 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.824 | L2-Norm(final)=11.474 | 3947.4 samples/s | 61.7 steps/s
[Step=61400 Epoch=119.8] | Loss=0.00679 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.827 | L2-Norm(final)=11.477 | 3913.5 samples/s | 61.1 steps/s
[Step=61450 Epoch=119.9] | Loss=0.00684 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.829 | L2-Norm(final)=11.479 | 3935.8 samples/s | 61.5 steps/s
[Step=61500 Epoch=119.9] | Loss=0.00678 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.832 | L2-Norm(final)=11.482 | 4204.9 samples/s | 65.7 steps/s
[Step=61550 Epoch=120.0] | Loss=0.00671 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.834 | L2-Norm(final)=11.485 | 1608.3 samples/s | 25.1 steps/s
[Step=61600 Epoch=120.1] | Loss=0.00661 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.837 | L2-Norm(final)=11.488 | 3946.2 samples/s | 61.7 steps/s
[Step=61650 Epoch=120.2] | Loss=0.00649 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.840 | L2-Norm(final)=11.491 | 3923.7 samples/s | 61.3 steps/s
[Step=61700 Epoch=120.3] | Loss=0.00636 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.842 | L2-Norm(final)=11.495 | 3962.4 samples/s | 61.9 steps/s
[Step=61750 Epoch=120.4] | Loss=0.00644 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.845 | L2-Norm(final)=11.498 | 3964.8 samples/s | 62.0 steps/s
[Step=61800 Epoch=120.5] | Loss=0.00637 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.847 | L2-Norm(final)=11.501 | 3931.2 samples/s | 61.4 steps/s
[Step=61850 Epoch=120.6] | Loss=0.00634 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.849 | L2-Norm(final)=11.503 | 3926.8 samples/s | 61.4 steps/s
[Step=61900 Epoch=120.7] | Loss=0.00636 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.852 | L2-Norm(final)=11.506 | 3958.3 samples/s | 61.8 steps/s
[Step=61950 Epoch=120.8] | Loss=0.00632 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.854 | L2-Norm(final)=11.509 | 3964.4 samples/s | 61.9 steps/s
[Step=62000 Epoch=120.9] | Loss=0.00628 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.856 | L2-Norm(final)=11.512 | 3934.9 samples/s | 61.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step62000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=60001 Epoch=117.3] | Loss=0.00099 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.674 | L2-Norm(final)=11.525 | 3238.2 samples/s | 50.6 steps/s
[Step=60050 Epoch=117.4] | Loss=0.00793 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.679 | L2-Norm(final)=11.529 | 4232.6 samples/s | 66.1 steps/s
[Step=60100 Epoch=117.5] | Loss=0.00780 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.683 | L2-Norm(final)=11.536 | 4409.7 samples/s | 68.9 steps/s
[Step=60150 Epoch=117.6] | Loss=0.00825 | Reg=0.00114 | acc=0.9844 | L2-Norm=10.687 | L2-Norm(final)=11.542 | 4355.0 samples/s | 68.0 steps/s
[Step=60200 Epoch=117.7] | Loss=0.00785 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.691 | L2-Norm(final)=11.548 | 4418.3 samples/s | 69.0 steps/s
[Step=60250 Epoch=117.8] | Loss=0.00792 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.694 | L2-Norm(final)=11.554 | 4421.7 samples/s | 69.1 steps/s
[Step=60300 Epoch=117.9] | Loss=0.00796 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.698 | L2-Norm(final)=11.560 | 4305.3 samples/s | 67.3 steps/s
[Step=60350 Epoch=118.0] | Loss=0.00803 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.702 | L2-Norm(final)=11.566 | 4373.5 samples/s | 68.3 steps/s
[Step=60400 Epoch=118.1] | Loss=0.00831 | Reg=0.00115 | acc=0.9688 | L2-Norm=10.706 | L2-Norm(final)=11.571 | 4341.8 samples/s | 67.8 steps/s
[Step=60450 Epoch=118.2] | Loss=0.00864 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.709 | L2-Norm(final)=11.576 | 4412.8 samples/s | 69.0 steps/s
[Step=60500 Epoch=118.3] | Loss=0.00868 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.713 | L2-Norm(final)=11.581 | 5661.8 samples/s | 88.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=60501 Epoch=118.3] | Loss=0.00568 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.750 | L2-Norm(final)=11.629 | 3342.5 samples/s | 52.2 steps/s
[Step=60550 Epoch=118.4] | Loss=0.00730 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.755 | L2-Norm(final)=11.635 | 3699.9 samples/s | 57.8 steps/s
[Step=60600 Epoch=118.5] | Loss=0.00714 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.760 | L2-Norm(final)=11.639 | 3988.7 samples/s | 62.3 steps/s
[Step=60650 Epoch=118.6] | Loss=0.00761 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.766 | L2-Norm(final)=11.643 | 3911.1 samples/s | 61.1 steps/s
[Step=60700 Epoch=118.7] | Loss=0.00755 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.770 | L2-Norm(final)=11.647 | 3923.9 samples/s | 61.3 steps/s
[Step=60750 Epoch=118.8] | Loss=0.00770 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.775 | L2-Norm(final)=11.651 | 3939.2 samples/s | 61.5 steps/s
[Step=60800 Epoch=118.9] | Loss=0.00783 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.779 | L2-Norm(final)=11.654 | 4027.3 samples/s | 62.9 steps/s
[Step=60850 Epoch=119.0] | Loss=0.00768 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.783 | L2-Norm(final)=11.658 | 3938.2 samples/s | 61.5 steps/s
[Step=60900 Epoch=119.1] | Loss=0.00745 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.787 | L2-Norm(final)=11.661 | 3937.5 samples/s | 61.5 steps/s
[Step=60950 Epoch=119.2] | Loss=0.00747 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.791 | L2-Norm(final)=11.665 | 3963.6 samples/s | 61.9 steps/s
[Step=61000 Epoch=119.3] | Loss=0.00752 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.794 | L2-Norm(final)=11.668 | 4854.3 samples/s | 75.8 steps/s
[Step=61050 Epoch=119.4] | Loss=0.00737 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.798 | L2-Norm(final)=11.672 | 1521.9 samples/s | 23.8 steps/s
[Step=61100 Epoch=119.4] | Loss=0.00715 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.801 | L2-Norm(final)=11.675 | 3856.5 samples/s | 60.3 steps/s
[Step=61150 Epoch=119.5] | Loss=0.00693 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.804 | L2-Norm(final)=11.678 | 3982.0 samples/s | 62.2 steps/s
[Step=61200 Epoch=119.6] | Loss=0.00688 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.807 | L2-Norm(final)=11.681 | 3925.1 samples/s | 61.3 steps/s
[Step=61250 Epoch=119.7] | Loss=0.00674 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=11.684 | 3961.0 samples/s | 61.9 steps/s
[Step=61300 Epoch=119.8] | Loss=0.00678 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.812 | L2-Norm(final)=11.687 | 3901.9 samples/s | 61.0 steps/s
[Step=61350 Epoch=119.9] | Loss=0.00669 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.815 | L2-Norm(final)=11.690 | 3902.0 samples/s | 61.0 steps/s
[Step=61400 Epoch=120.0] | Loss=0.00667 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.817 | L2-Norm(final)=11.693 | 3973.9 samples/s | 62.1 steps/s
[Step=61450 Epoch=120.1] | Loss=0.00660 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.820 | L2-Norm(final)=11.695 | 3953.6 samples/s | 61.8 steps/s
[Step=61500 Epoch=120.2] | Loss=0.00671 | Reg=0.00117 | acc=0.9688 | L2-Norm=10.822 | L2-Norm(final)=11.698 | 4188.8 samples/s | 65.5 steps/s
[Step=61550 Epoch=120.3] | Loss=0.00662 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.825 | L2-Norm(final)=11.701 | 1574.8 samples/s | 24.6 steps/s
[Step=61600 Epoch=120.4] | Loss=0.00652 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.827 | L2-Norm(final)=11.703 | 3952.3 samples/s | 61.8 steps/s
[Step=61650 Epoch=120.5] | Loss=0.00646 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.830 | L2-Norm(final)=11.706 | 3869.7 samples/s | 60.5 steps/s
[Step=61700 Epoch=120.6] | Loss=0.00639 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.832 | L2-Norm(final)=11.709 | 3909.5 samples/s | 61.1 steps/s
[Step=61750 Epoch=120.7] | Loss=0.00631 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.834 | L2-Norm(final)=11.711 | 3897.9 samples/s | 60.9 steps/s
[Step=61800 Epoch=120.8] | Loss=0.00625 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.837 | L2-Norm(final)=11.714 | 3884.7 samples/s | 60.7 steps/s
[Step=61850 Epoch=120.9] | Loss=0.00624 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.839 | L2-Norm(final)=11.717 | 3962.2 samples/s | 61.9 steps/s
[Step=61900 Epoch=121.0] | Loss=0.00622 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.841 | L2-Norm(final)=11.719 | 3978.9 samples/s | 62.2 steps/s
[Step=61950 Epoch=121.1] | Loss=0.00627 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.844 | L2-Norm(final)=11.722 | 3912.2 samples/s | 61.1 steps/s
[Step=62000 Epoch=121.2] | Loss=0.00618 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.846 | L2-Norm(final)=11.724 | 3905.0 samples/s | 61.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step62000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=60001 Epoch=229.9] | Loss=0.00009 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.674 | L2-Norm(final)=8.784 | 3189.9 samples/s | 49.8 steps/s
[Step=60050 Epoch=230.1] | Loss=0.00012 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.675 | L2-Norm(final)=8.787 | 3820.4 samples/s | 59.7 steps/s
[Step=60100 Epoch=230.3] | Loss=0.00011 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.676 | L2-Norm(final)=8.790 | 4167.8 samples/s | 65.1 steps/s
[Step=60150 Epoch=230.5] | Loss=0.00010 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.677 | L2-Norm(final)=8.793 | 4101.9 samples/s | 64.1 steps/s
[Step=60200 Epoch=230.7] | Loss=0.00010 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.679 | L2-Norm(final)=8.795 | 4114.4 samples/s | 64.3 steps/s
[Step=60250 Epoch=230.9] | Loss=0.00009 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.680 | L2-Norm(final)=8.798 | 5326.4 samples/s | 83.2 steps/s
[Step=60300 Epoch=231.0] | Loss=0.00009 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.682 | L2-Norm(final)=8.801 | 1530.7 samples/s | 23.9 steps/s
[Step=60350 Epoch=231.2] | Loss=0.00008 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.683 | L2-Norm(final)=8.803 | 3971.4 samples/s | 62.1 steps/s
[Step=60400 Epoch=231.4] | Loss=0.00007 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.683 | L2-Norm(final)=8.806 | 4152.3 samples/s | 64.9 steps/s
[Step=60450 Epoch=231.6] | Loss=0.00007 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.684 | L2-Norm(final)=8.808 | 4064.3 samples/s | 63.5 steps/s
[Step=60500 Epoch=231.8] | Loss=0.00007 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.684 | L2-Norm(final)=8.811 | 4668.1 samples/s | 72.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=60501 Epoch=231.8] | Loss=0.00002 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.687 | L2-Norm(final)=8.836 | 3216.4 samples/s | 50.3 steps/s
[Step=60550 Epoch=232.0] | Loss=0.00003 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.686 | L2-Norm(final)=8.838 | 3591.5 samples/s | 56.1 steps/s
[Step=60600 Epoch=232.2] | Loss=0.00003 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.685 | L2-Norm(final)=8.840 | 3732.3 samples/s | 58.3 steps/s
[Step=60650 Epoch=232.4] | Loss=0.00003 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.683 | L2-Norm(final)=8.842 | 3766.7 samples/s | 58.9 steps/s
[Step=60700 Epoch=232.6] | Loss=0.00003 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.681 | L2-Norm(final)=8.844 | 3740.0 samples/s | 58.4 steps/s
[Step=60750 Epoch=232.8] | Loss=0.00003 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.679 | L2-Norm(final)=8.846 | 4646.2 samples/s | 72.6 steps/s
[Step=60800 Epoch=233.0] | Loss=0.00002 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.677 | L2-Norm(final)=8.847 | 1466.3 samples/s | 22.9 steps/s
[Step=60850 Epoch=233.2] | Loss=0.00002 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.674 | L2-Norm(final)=8.849 | 3741.1 samples/s | 58.5 steps/s
[Step=60900 Epoch=233.3] | Loss=0.00002 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.672 | L2-Norm(final)=8.850 | 3706.5 samples/s | 57.9 steps/s
[Step=60950 Epoch=233.5] | Loss=0.00002 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.669 | L2-Norm(final)=8.851 | 3702.2 samples/s | 57.8 steps/s
[Step=61000 Epoch=233.7] | Loss=0.00002 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.667 | L2-Norm(final)=8.852 | 4097.2 samples/s | 64.0 steps/s
[Step=61050 Epoch=233.9] | Loss=0.00002 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.664 | L2-Norm(final)=8.854 | 1489.6 samples/s | 23.3 steps/s
[Step=61100 Epoch=234.1] | Loss=0.00002 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.662 | L2-Norm(final)=8.855 | 3793.3 samples/s | 59.3 steps/s
[Step=61150 Epoch=234.3] | Loss=0.00002 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.659 | L2-Norm(final)=8.856 | 3688.0 samples/s | 57.6 steps/s
[Step=61200 Epoch=234.5] | Loss=0.00002 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.656 | L2-Norm(final)=8.857 | 3722.8 samples/s | 58.2 steps/s
[Step=61250 Epoch=234.7] | Loss=0.00002 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.654 | L2-Norm(final)=8.858 | 3750.8 samples/s | 58.6 steps/s
[Step=61300 Epoch=234.9] | Loss=0.00002 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.651 | L2-Norm(final)=8.859 | 1598.4 samples/s | 25.0 steps/s
[Step=61350 Epoch=235.1] | Loss=0.00002 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.648 | L2-Norm(final)=8.860 | 3722.7 samples/s | 58.2 steps/s
[Step=61400 Epoch=235.3] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.645 | L2-Norm(final)=8.861 | 3715.1 samples/s | 58.0 steps/s
[Step=61450 Epoch=235.5] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.642 | L2-Norm(final)=8.862 | 3747.2 samples/s | 58.6 steps/s
[Step=61500 Epoch=235.6] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.639 | L2-Norm(final)=8.863 | 3738.1 samples/s | 58.4 steps/s
[Step=61550 Epoch=235.8] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.636 | L2-Norm(final)=8.864 | 1572.7 samples/s | 24.6 steps/s
[Step=61600 Epoch=236.0] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.633 | L2-Norm(final)=8.865 | 3689.7 samples/s | 57.7 steps/s
[Step=61650 Epoch=236.2] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.630 | L2-Norm(final)=8.866 | 3696.7 samples/s | 57.8 steps/s
[Step=61700 Epoch=236.4] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.627 | L2-Norm(final)=8.867 | 3747.2 samples/s | 58.6 steps/s
[Step=61750 Epoch=236.6] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=8.867 | 3749.9 samples/s | 58.6 steps/s
[Step=61800 Epoch=236.8] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.621 | L2-Norm(final)=8.868 | 5073.2 samples/s | 79.3 steps/s
[Step=61850 Epoch=237.0] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.617 | L2-Norm(final)=8.869 | 1434.2 samples/s | 22.4 steps/s
[Step=61900 Epoch=237.2] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.614 | L2-Norm(final)=8.870 | 3709.9 samples/s | 58.0 steps/s
[Step=61950 Epoch=237.4] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.611 | L2-Norm(final)=8.871 | 3750.2 samples/s | 58.6 steps/s
[Step=62000 Epoch=237.6] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.607 | L2-Norm(final)=8.872 | 3763.0 samples/s | 58.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step62000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=60001 Epoch=231.0] | Loss=0.00016 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.674 | L2-Norm(final)=9.170 | 3463.5 samples/s | 54.1 steps/s
[Step=60050 Epoch=231.2] | Loss=0.00025 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.680 | L2-Norm(final)=9.180 | 3721.0 samples/s | 58.1 steps/s
[Step=60100 Epoch=231.3] | Loss=0.00026 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.690 | L2-Norm(final)=9.193 | 4089.3 samples/s | 63.9 steps/s
[Step=60150 Epoch=231.5] | Loss=0.00019 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.699 | L2-Norm(final)=9.204 | 4109.9 samples/s | 64.2 steps/s
[Step=60200 Epoch=231.7] | Loss=0.00015 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.703 | L2-Norm(final)=9.211 | 4091.4 samples/s | 63.9 steps/s
[Step=60250 Epoch=231.9] | Loss=0.00013 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.704 | L2-Norm(final)=9.217 | 5490.3 samples/s | 85.8 steps/s
[Step=60300 Epoch=232.1] | Loss=0.00011 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=9.223 | 1537.6 samples/s | 24.0 steps/s
[Step=60350 Epoch=232.3] | Loss=0.00010 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.704 | L2-Norm(final)=9.227 | 4211.4 samples/s | 65.8 steps/s
[Step=60400 Epoch=232.5] | Loss=0.00009 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.703 | L2-Norm(final)=9.232 | 4056.6 samples/s | 63.4 steps/s
[Step=60450 Epoch=232.7] | Loss=0.00008 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.701 | L2-Norm(final)=9.236 | 4166.2 samples/s | 65.1 steps/s
[Step=60500 Epoch=232.9] | Loss=0.00007 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.699 | L2-Norm(final)=9.239 | 4767.1 samples/s | 74.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=60501 Epoch=232.9] | Loss=0.00003 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.680 | L2-Norm(final)=9.277 | 3269.9 samples/s | 51.1 steps/s
[Step=60550 Epoch=233.1] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.665 | L2-Norm(final)=9.279 | 3523.8 samples/s | 55.1 steps/s
[Step=60600 Epoch=233.3] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.645 | L2-Norm(final)=9.281 | 3769.4 samples/s | 58.9 steps/s
[Step=60650 Epoch=233.5] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.625 | L2-Norm(final)=9.282 | 3726.9 samples/s | 58.2 steps/s
[Step=60700 Epoch=233.7] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.604 | L2-Norm(final)=9.283 | 3770.0 samples/s | 58.9 steps/s
[Step=60750 Epoch=233.9] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.583 | L2-Norm(final)=9.285 | 4723.5 samples/s | 73.8 steps/s
[Step=60800 Epoch=234.0] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.561 | L2-Norm(final)=9.286 | 1476.5 samples/s | 23.1 steps/s
[Step=60850 Epoch=234.2] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.539 | L2-Norm(final)=9.287 | 3737.3 samples/s | 58.4 steps/s
[Step=60900 Epoch=234.4] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.517 | L2-Norm(final)=9.287 | 3723.8 samples/s | 58.2 steps/s
[Step=60950 Epoch=234.6] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.495 | L2-Norm(final)=9.288 | 3736.8 samples/s | 58.4 steps/s
[Step=61000 Epoch=234.8] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=9.289 | 4230.9 samples/s | 66.1 steps/s
[Step=61050 Epoch=235.0] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.449 | L2-Norm(final)=9.289 | 1487.8 samples/s | 23.2 steps/s
[Step=61100 Epoch=235.2] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.426 | L2-Norm(final)=9.290 | 3727.7 samples/s | 58.2 steps/s
[Step=61150 Epoch=235.4] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.403 | L2-Norm(final)=9.291 | 3745.0 samples/s | 58.5 steps/s
[Step=61200 Epoch=235.6] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.380 | L2-Norm(final)=9.291 | 3735.7 samples/s | 58.4 steps/s
[Step=61250 Epoch=235.8] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.356 | L2-Norm(final)=9.292 | 3822.8 samples/s | 59.7 steps/s
[Step=61300 Epoch=236.0] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.332 | L2-Norm(final)=9.292 | 1595.3 samples/s | 24.9 steps/s
[Step=61350 Epoch=236.2] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.308 | L2-Norm(final)=9.293 | 3794.1 samples/s | 59.3 steps/s
[Step=61400 Epoch=236.4] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.284 | L2-Norm(final)=9.294 | 3767.3 samples/s | 58.9 steps/s
[Step=61450 Epoch=236.5] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.259 | L2-Norm(final)=9.294 | 3700.7 samples/s | 57.8 steps/s
[Step=61500 Epoch=236.7] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.234 | L2-Norm(final)=9.295 | 3739.0 samples/s | 58.4 steps/s
[Step=61550 Epoch=236.9] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.210 | L2-Norm(final)=9.295 | 1574.7 samples/s | 24.6 steps/s
[Step=61600 Epoch=237.1] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.185 | L2-Norm(final)=9.296 | 3766.7 samples/s | 58.9 steps/s
[Step=61650 Epoch=237.3] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.159 | L2-Norm(final)=9.297 | 3752.2 samples/s | 58.6 steps/s
[Step=61700 Epoch=237.5] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.134 | L2-Norm(final)=9.297 | 3708.0 samples/s | 57.9 steps/s
[Step=61750 Epoch=237.7] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.108 | L2-Norm(final)=9.298 | 3758.6 samples/s | 58.7 steps/s
[Step=61800 Epoch=237.9] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.083 | L2-Norm(final)=9.299 | 5301.2 samples/s | 82.8 steps/s
[Step=61850 Epoch=238.1] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.057 | L2-Norm(final)=9.300 | 1389.2 samples/s | 21.7 steps/s
[Step=61900 Epoch=238.3] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.031 | L2-Norm(final)=9.300 | 3693.2 samples/s | 57.7 steps/s
[Step=61950 Epoch=238.5] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.004 | L2-Norm(final)=9.301 | 3719.8 samples/s | 58.1 steps/s
[Step=62000 Epoch=238.7] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.978 | L2-Norm(final)=9.302 | 3650.8 samples/s | 57.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step62000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06478 | acc=0.9712 | tpr=0.9787 | fpr=0.0451 | 3487.2 samples/s | 13.6 steps/s
Avg test loss: 0.07103, Avg test acc: 0.96847, Avg tpr: 0.97575, Avg fpr: 0.04756, total FA: 371

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06499 | acc=0.9712 | tpr=0.9784 | fpr=0.0446 | 3476.9 samples/s | 13.6 steps/s
Avg test loss: 0.07121, Avg test acc: 0.96971, Avg tpr: 0.97820, Avg fpr: 0.04897, total FA: 382

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.82393 | acc=0.3161 | tpr=0.0212 | fpr=0.0436 | 3459.6 samples/s | 13.5 steps/s
Avg test loss: 4.83293, Avg test acc: 0.31373, Avg tpr: 0.02063, Avg fpr: 0.04166, total FA: 325

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.04811 | acc=0.3162 | tpr=0.0185 | fpr=0.0374 | 3499.6 samples/s | 13.7 steps/s
Avg test loss: 5.05934, Avg test acc: 0.31313, Avg tpr: 0.01836, Avg fpr: 0.03858, total FA: 301

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.10542 | acc=0.1027 | tpr=0.8407 | fpr=0.9105 | 3534.2 samples/s | 13.8 steps/s
[Step= 100] | Loss=6.08418 | acc=0.1042 | tpr=0.8571 | fpr=0.9098 | 6803.3 samples/s | 26.6 steps/s
[Step= 150] | Loss=6.10270 | acc=0.1035 | tpr=0.8660 | fpr=0.9106 | 6867.9 samples/s | 26.8 steps/s
[Step= 200] | Loss=6.08432 | acc=0.1033 | tpr=0.8579 | fpr=0.9105 | 6877.8 samples/s | 26.9 steps/s
[Step= 250] | Loss=6.08381 | acc=0.1037 | tpr=0.8524 | fpr=0.9099 | 6960.3 samples/s | 27.2 steps/s
[Step= 300] | Loss=6.08630 | acc=0.1031 | tpr=0.8509 | fpr=0.9105 | 7025.7 samples/s | 27.4 steps/s
[Step= 350] | Loss=6.08479 | acc=0.1035 | tpr=0.8560 | fpr=0.9101 | 6644.9 samples/s | 26.0 steps/s
[Step= 400] | Loss=6.08165 | acc=0.1035 | tpr=0.8518 | fpr=0.9101 | 6860.3 samples/s | 26.8 steps/s
[Step= 450] | Loss=6.08831 | acc=0.1033 | tpr=0.8539 | fpr=0.9104 | 6591.9 samples/s | 25.7 steps/s
[Step= 500] | Loss=6.09070 | acc=0.1031 | tpr=0.8546 | fpr=0.9104 | 6909.4 samples/s | 27.0 steps/s
[Step= 550] | Loss=6.09041 | acc=0.1034 | tpr=0.8540 | fpr=0.9103 | 12607.2 samples/s | 49.2 steps/s
Avg test loss: 6.09166, Avg test acc: 0.10324, Avg tpr: 0.85341, Avg fpr: 0.91040, total FA: 126407

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.49780 | acc=0.1009 | tpr=0.8673 | fpr=0.9129 | 3486.8 samples/s | 13.6 steps/s
[Step= 100] | Loss=6.47874 | acc=0.1043 | tpr=0.8806 | fpr=0.9102 | 7081.4 samples/s | 27.7 steps/s
[Step= 150] | Loss=6.49384 | acc=0.1035 | tpr=0.8804 | fpr=0.9108 | 6678.2 samples/s | 26.1 steps/s
[Step= 200] | Loss=6.47518 | acc=0.1032 | tpr=0.8754 | fpr=0.9109 | 6975.5 samples/s | 27.2 steps/s
[Step= 250] | Loss=6.47326 | acc=0.1034 | tpr=0.8734 | fpr=0.9106 | 6976.8 samples/s | 27.3 steps/s
[Step= 300] | Loss=6.47489 | acc=0.1030 | tpr=0.8698 | fpr=0.9110 | 6812.8 samples/s | 26.6 steps/s
[Step= 350] | Loss=6.47445 | acc=0.1033 | tpr=0.8754 | fpr=0.9107 | 6807.7 samples/s | 26.6 steps/s
[Step= 400] | Loss=6.47047 | acc=0.1035 | tpr=0.8714 | fpr=0.9105 | 6740.8 samples/s | 26.3 steps/s
[Step= 450] | Loss=6.47878 | acc=0.1031 | tpr=0.8724 | fpr=0.9109 | 6751.9 samples/s | 26.4 steps/s
[Step= 500] | Loss=6.48010 | acc=0.1029 | tpr=0.8736 | fpr=0.9110 | 6938.3 samples/s | 27.1 steps/s
[Step= 550] | Loss=6.48010 | acc=0.1032 | tpr=0.8747 | fpr=0.9109 | 12238.4 samples/s | 47.8 steps/s
Avg test loss: 6.48114, Avg test acc: 0.10306, Avg tpr: 0.87441, Avg fpr: 0.91096, total FA: 126485

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10855 | acc=0.9810 | tpr=0.9381 | fpr=0.0182 | 3548.9 samples/s | 13.9 steps/s
[Step= 100] | Loss=0.11185 | acc=0.9809 | tpr=0.9552 | fpr=0.0187 | 6759.6 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.11433 | acc=0.9801 | tpr=0.9539 | fpr=0.0195 | 7049.8 samples/s | 27.5 steps/s
[Step= 200] | Loss=0.11504 | acc=0.9801 | tpr=0.9508 | fpr=0.0194 | 6715.3 samples/s | 26.2 steps/s
[Step= 250] | Loss=0.11350 | acc=0.9804 | tpr=0.9493 | fpr=0.0190 | 6701.2 samples/s | 26.2 steps/s
[Step= 300] | Loss=0.11568 | acc=0.9801 | tpr=0.9484 | fpr=0.0193 | 6918.5 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.11538 | acc=0.9801 | tpr=0.9487 | fpr=0.0193 | 6876.3 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.11681 | acc=0.9800 | tpr=0.9464 | fpr=0.0194 | 6884.0 samples/s | 26.9 steps/s
[Step= 450] | Loss=0.11915 | acc=0.9797 | tpr=0.9440 | fpr=0.0197 | 6749.0 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.11897 | acc=0.9797 | tpr=0.9471 | fpr=0.0197 | 6748.5 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.11837 | acc=0.9798 | tpr=0.9471 | fpr=0.0196 | 12498.2 samples/s | 48.8 steps/s
Avg test loss: 0.11828, Avg test acc: 0.97984, Avg tpr: 0.94651, Avg fpr: 0.01955, total FA: 2715

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10910 | acc=0.9824 | tpr=0.9292 | fpr=0.0166 | 3503.1 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.11324 | acc=0.9818 | tpr=0.9531 | fpr=0.0176 | 7035.9 samples/s | 27.5 steps/s
[Step= 150] | Loss=0.11558 | acc=0.9810 | tpr=0.9568 | fpr=0.0186 | 6803.2 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.11656 | acc=0.9808 | tpr=0.9563 | fpr=0.0187 | 6774.2 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.11532 | acc=0.9809 | tpr=0.9520 | fpr=0.0186 | 6680.6 samples/s | 26.1 steps/s
[Step= 300] | Loss=0.11765 | acc=0.9805 | tpr=0.9505 | fpr=0.0189 | 6813.1 samples/s | 26.6 steps/s
[Step= 350] | Loss=0.11720 | acc=0.9805 | tpr=0.9512 | fpr=0.0190 | 6989.9 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.11857 | acc=0.9804 | tpr=0.9502 | fpr=0.0191 | 6680.2 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.12093 | acc=0.9800 | tpr=0.9479 | fpr=0.0194 | 6716.3 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.12068 | acc=0.9800 | tpr=0.9507 | fpr=0.0195 | 6675.6 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.11994 | acc=0.9802 | tpr=0.9511 | fpr=0.0193 | 12485.2 samples/s | 48.8 steps/s
Avg test loss: 0.11989, Avg test acc: 0.98022, Avg tpr: 0.95087, Avg fpr: 0.01925, total FA: 2673

server round 31/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=62001 Epoch=120.9] | Loss=0.00522 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.324 | L2-Norm(final)=11.594 | 3145.5 samples/s | 49.1 steps/s
[Step=62050 Epoch=121.0] | Loss=0.00789 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.331 | L2-Norm(final)=11.599 | 3910.2 samples/s | 61.1 steps/s
[Step=62100 Epoch=121.1] | Loss=0.01006 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.337 | L2-Norm(final)=11.602 | 4374.0 samples/s | 68.3 steps/s
[Step=62150 Epoch=121.2] | Loss=0.00989 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.341 | L2-Norm(final)=11.606 | 4404.5 samples/s | 68.8 steps/s
[Step=62200 Epoch=121.3] | Loss=0.00956 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.346 | L2-Norm(final)=11.610 | 4420.1 samples/s | 69.1 steps/s
[Step=62250 Epoch=121.4] | Loss=0.00931 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.350 | L2-Norm(final)=11.615 | 4404.6 samples/s | 68.8 steps/s
[Step=62300 Epoch=121.5] | Loss=0.00885 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.355 | L2-Norm(final)=11.622 | 4331.3 samples/s | 67.7 steps/s
[Step=62350 Epoch=121.6] | Loss=0.00868 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.360 | L2-Norm(final)=11.628 | 4338.6 samples/s | 67.8 steps/s
[Step=62400 Epoch=121.7] | Loss=0.00860 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.364 | L2-Norm(final)=11.635 | 4416.1 samples/s | 69.0 steps/s
[Step=62450 Epoch=121.8] | Loss=0.00839 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.369 | L2-Norm(final)=11.641 | 4319.2 samples/s | 67.5 steps/s
[Step=62500 Epoch=121.9] | Loss=0.00822 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.373 | L2-Norm(final)=11.646 | 5521.4 samples/s | 86.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=62501 Epoch=121.9] | Loss=0.01539 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.412 | L2-Norm(final)=11.706 | 3235.6 samples/s | 50.6 steps/s
[Step=62550 Epoch=122.0] | Loss=0.00764 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.417 | L2-Norm(final)=11.711 | 3528.2 samples/s | 55.1 steps/s
[Step=62600 Epoch=122.1] | Loss=0.00845 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.425 | L2-Norm(final)=11.716 | 3918.2 samples/s | 61.2 steps/s
[Step=62650 Epoch=122.2] | Loss=0.00900 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.432 | L2-Norm(final)=11.719 | 3952.6 samples/s | 61.8 steps/s
[Step=62700 Epoch=122.3] | Loss=0.00861 | Reg=0.00109 | acc=0.9688 | L2-Norm=10.438 | L2-Norm(final)=11.723 | 3912.2 samples/s | 61.1 steps/s
[Step=62750 Epoch=122.4] | Loss=0.00825 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.443 | L2-Norm(final)=11.727 | 4000.2 samples/s | 62.5 steps/s
[Step=62800 Epoch=122.5] | Loss=0.00835 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.449 | L2-Norm(final)=11.732 | 3983.8 samples/s | 62.2 steps/s
[Step=62850 Epoch=122.6] | Loss=0.00841 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.454 | L2-Norm(final)=11.736 | 3946.9 samples/s | 61.7 steps/s
[Step=62900 Epoch=122.7] | Loss=0.00822 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.459 | L2-Norm(final)=11.740 | 3959.8 samples/s | 61.9 steps/s
[Step=62950 Epoch=122.8] | Loss=0.00839 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.464 | L2-Norm(final)=11.744 | 3872.0 samples/s | 60.5 steps/s
[Step=63000 Epoch=122.9] | Loss=0.00829 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.469 | L2-Norm(final)=11.748 | 4823.5 samples/s | 75.4 steps/s
[Step=63050 Epoch=123.0] | Loss=0.00817 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.474 | L2-Norm(final)=11.752 | 1482.0 samples/s | 23.2 steps/s
[Step=63100 Epoch=123.1] | Loss=0.00810 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.478 | L2-Norm(final)=11.756 | 3917.6 samples/s | 61.2 steps/s
[Step=63150 Epoch=123.2] | Loss=0.00793 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.482 | L2-Norm(final)=11.760 | 3884.0 samples/s | 60.7 steps/s
[Step=63200 Epoch=123.3] | Loss=0.00790 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.486 | L2-Norm(final)=11.764 | 3968.6 samples/s | 62.0 steps/s
[Step=63250 Epoch=123.4] | Loss=0.00780 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.490 | L2-Norm(final)=11.767 | 3922.3 samples/s | 61.3 steps/s
[Step=63300 Epoch=123.5] | Loss=0.00762 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.494 | L2-Norm(final)=11.771 | 3984.3 samples/s | 62.3 steps/s
[Step=63350 Epoch=123.6] | Loss=0.00746 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.497 | L2-Norm(final)=11.774 | 3926.7 samples/s | 61.4 steps/s
[Step=63400 Epoch=123.7] | Loss=0.00744 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.501 | L2-Norm(final)=11.778 | 3969.3 samples/s | 62.0 steps/s
[Step=63450 Epoch=123.8] | Loss=0.00733 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.504 | L2-Norm(final)=11.782 | 3937.1 samples/s | 61.5 steps/s
[Step=63500 Epoch=123.8] | Loss=0.00728 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.507 | L2-Norm(final)=11.785 | 4198.8 samples/s | 65.6 steps/s
[Step=63550 Epoch=123.9] | Loss=0.00719 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.511 | L2-Norm(final)=11.788 | 1515.6 samples/s | 23.7 steps/s
[Step=63600 Epoch=124.0] | Loss=0.00708 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.514 | L2-Norm(final)=11.792 | 3994.1 samples/s | 62.4 steps/s
[Step=63650 Epoch=124.1] | Loss=0.00704 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.517 | L2-Norm(final)=11.795 | 3935.7 samples/s | 61.5 steps/s
[Step=63700 Epoch=124.2] | Loss=0.00697 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.520 | L2-Norm(final)=11.799 | 3948.7 samples/s | 61.7 steps/s
[Step=63750 Epoch=124.3] | Loss=0.00688 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.523 | L2-Norm(final)=11.802 | 3926.2 samples/s | 61.3 steps/s
[Step=63800 Epoch=124.4] | Loss=0.00680 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.526 | L2-Norm(final)=11.806 | 3965.6 samples/s | 62.0 steps/s
[Step=63850 Epoch=124.5] | Loss=0.00681 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.529 | L2-Norm(final)=11.809 | 3948.0 samples/s | 61.7 steps/s
[Step=63900 Epoch=124.6] | Loss=0.00679 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.532 | L2-Norm(final)=11.812 | 3892.8 samples/s | 60.8 steps/s
[Step=63950 Epoch=124.7] | Loss=0.00673 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.535 | L2-Norm(final)=11.815 | 3944.3 samples/s | 61.6 steps/s
[Step=64000 Epoch=124.8] | Loss=0.00672 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.537 | L2-Norm(final)=11.818 | 3952.6 samples/s | 61.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step64000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=62001 Epoch=121.2] | Loss=0.00232 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.324 | L2-Norm(final)=11.802 | 3085.7 samples/s | 48.2 steps/s
[Step=62050 Epoch=121.3] | Loss=0.00728 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.330 | L2-Norm(final)=11.806 | 4325.0 samples/s | 67.6 steps/s
[Step=62100 Epoch=121.4] | Loss=0.00725 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.336 | L2-Norm(final)=11.811 | 4392.8 samples/s | 68.6 steps/s
[Step=62150 Epoch=121.5] | Loss=0.00769 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.341 | L2-Norm(final)=11.817 | 4387.0 samples/s | 68.5 steps/s
[Step=62200 Epoch=121.6] | Loss=0.00807 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.345 | L2-Norm(final)=11.823 | 4387.5 samples/s | 68.6 steps/s
[Step=62250 Epoch=121.7] | Loss=0.00826 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.349 | L2-Norm(final)=11.828 | 4427.0 samples/s | 69.2 steps/s
[Step=62300 Epoch=121.8] | Loss=0.00831 | Reg=0.00107 | acc=0.9688 | L2-Norm=10.353 | L2-Norm(final)=11.834 | 4346.0 samples/s | 67.9 steps/s
[Step=62350 Epoch=121.9] | Loss=0.00815 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.357 | L2-Norm(final)=11.839 | 4435.1 samples/s | 69.3 steps/s
[Step=62400 Epoch=122.0] | Loss=0.00807 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.360 | L2-Norm(final)=11.845 | 4389.4 samples/s | 68.6 steps/s
[Step=62450 Epoch=122.1] | Loss=0.00809 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.364 | L2-Norm(final)=11.850 | 4414.9 samples/s | 69.0 steps/s
[Step=62500 Epoch=122.2] | Loss=0.00809 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.367 | L2-Norm(final)=11.856 | 5556.1 samples/s | 86.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=62501 Epoch=122.2] | Loss=0.01382 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.397 | L2-Norm(final)=11.909 | 3201.9 samples/s | 50.0 steps/s
[Step=62550 Epoch=122.3] | Loss=0.00858 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=11.915 | 3879.3 samples/s | 60.6 steps/s
[Step=62600 Epoch=122.4] | Loss=0.00825 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.411 | L2-Norm(final)=11.921 | 3920.4 samples/s | 61.3 steps/s
[Step=62650 Epoch=122.5] | Loss=0.00838 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.418 | L2-Norm(final)=11.926 | 3937.0 samples/s | 61.5 steps/s
[Step=62700 Epoch=122.6] | Loss=0.00823 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.423 | L2-Norm(final)=11.931 | 3961.6 samples/s | 61.9 steps/s
[Step=62750 Epoch=122.7] | Loss=0.00840 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.428 | L2-Norm(final)=11.936 | 3952.0 samples/s | 61.8 steps/s
[Step=62800 Epoch=122.8] | Loss=0.00820 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.433 | L2-Norm(final)=11.940 | 3953.9 samples/s | 61.8 steps/s
[Step=62850 Epoch=122.9] | Loss=0.00840 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.439 | L2-Norm(final)=11.944 | 3927.7 samples/s | 61.4 steps/s
[Step=62900 Epoch=123.0] | Loss=0.00832 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.443 | L2-Norm(final)=11.948 | 3947.9 samples/s | 61.7 steps/s
[Step=62950 Epoch=123.1] | Loss=0.00816 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.448 | L2-Norm(final)=11.952 | 3992.6 samples/s | 62.4 steps/s
[Step=63000 Epoch=123.2] | Loss=0.00810 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.453 | L2-Norm(final)=11.956 | 4909.4 samples/s | 76.7 steps/s
[Step=63050 Epoch=123.3] | Loss=0.00802 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.457 | L2-Norm(final)=11.960 | 1507.6 samples/s | 23.6 steps/s
[Step=63100 Epoch=123.4] | Loss=0.00782 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.462 | L2-Norm(final)=11.965 | 3941.0 samples/s | 61.6 steps/s
[Step=63150 Epoch=123.5] | Loss=0.00790 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.466 | L2-Norm(final)=11.969 | 3937.5 samples/s | 61.5 steps/s
[Step=63200 Epoch=123.6] | Loss=0.00773 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=11.972 | 3969.4 samples/s | 62.0 steps/s
[Step=63250 Epoch=123.7] | Loss=0.00749 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.474 | L2-Norm(final)=11.976 | 3898.7 samples/s | 60.9 steps/s
[Step=63300 Epoch=123.7] | Loss=0.00735 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.478 | L2-Norm(final)=11.980 | 4010.3 samples/s | 62.7 steps/s
[Step=63350 Epoch=123.8] | Loss=0.00736 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.482 | L2-Norm(final)=11.983 | 4002.7 samples/s | 62.5 steps/s
[Step=63400 Epoch=123.9] | Loss=0.00730 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.485 | L2-Norm(final)=11.987 | 3991.5 samples/s | 62.4 steps/s
[Step=63450 Epoch=124.0] | Loss=0.00712 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.488 | L2-Norm(final)=11.990 | 3911.9 samples/s | 61.1 steps/s
[Step=63500 Epoch=124.1] | Loss=0.00707 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.492 | L2-Norm(final)=11.993 | 4292.0 samples/s | 67.1 steps/s
[Step=63550 Epoch=124.2] | Loss=0.00709 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.495 | L2-Norm(final)=11.997 | 1559.2 samples/s | 24.4 steps/s
[Step=63600 Epoch=124.3] | Loss=0.00706 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.498 | L2-Norm(final)=12.000 | 3909.5 samples/s | 61.1 steps/s
[Step=63650 Epoch=124.4] | Loss=0.00695 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.501 | L2-Norm(final)=12.003 | 3923.0 samples/s | 61.3 steps/s
[Step=63700 Epoch=124.5] | Loss=0.00688 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.505 | L2-Norm(final)=12.006 | 3967.1 samples/s | 62.0 steps/s
[Step=63750 Epoch=124.6] | Loss=0.00683 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.508 | L2-Norm(final)=12.009 | 3928.9 samples/s | 61.4 steps/s
[Step=63800 Epoch=124.7] | Loss=0.00675 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.511 | L2-Norm(final)=12.013 | 3945.2 samples/s | 61.6 steps/s
[Step=63850 Epoch=124.8] | Loss=0.00673 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.513 | L2-Norm(final)=12.016 | 3954.1 samples/s | 61.8 steps/s
[Step=63900 Epoch=124.9] | Loss=0.00673 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.516 | L2-Norm(final)=12.019 | 3949.1 samples/s | 61.7 steps/s
[Step=63950 Epoch=125.0] | Loss=0.00666 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.519 | L2-Norm(final)=12.021 | 3942.6 samples/s | 61.6 steps/s
[Step=64000 Epoch=125.1] | Loss=0.00662 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.522 | L2-Norm(final)=12.024 | 3970.8 samples/s | 62.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step64000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=62001 Epoch=237.6] | Loss=0.00002 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.324 | L2-Norm(final)=8.898 | 3237.4 samples/s | 50.6 steps/s
[Step=62050 Epoch=237.8] | Loss=0.00010 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.326 | L2-Norm(final)=8.903 | 3832.3 samples/s | 59.9 steps/s
[Step=62100 Epoch=237.9] | Loss=0.00009 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.329 | L2-Norm(final)=8.907 | 4152.4 samples/s | 64.9 steps/s
[Step=62150 Epoch=238.1] | Loss=0.00007 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.331 | L2-Norm(final)=8.912 | 4123.7 samples/s | 64.4 steps/s
[Step=62200 Epoch=238.3] | Loss=0.00006 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.332 | L2-Norm(final)=8.916 | 4125.4 samples/s | 64.5 steps/s
[Step=62250 Epoch=238.5] | Loss=0.00006 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.332 | L2-Norm(final)=8.920 | 5319.8 samples/s | 83.1 steps/s
[Step=62300 Epoch=238.7] | Loss=0.00005 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.332 | L2-Norm(final)=8.924 | 1492.9 samples/s | 23.3 steps/s
[Step=62350 Epoch=238.9] | Loss=0.00005 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.332 | L2-Norm(final)=8.928 | 4106.8 samples/s | 64.2 steps/s
[Step=62400 Epoch=239.1] | Loss=0.00005 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.331 | L2-Norm(final)=8.931 | 4148.4 samples/s | 64.8 steps/s
[Step=62450 Epoch=239.3] | Loss=0.00004 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.330 | L2-Norm(final)=8.934 | 4066.7 samples/s | 63.5 steps/s
[Step=62500 Epoch=239.5] | Loss=0.00004 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.329 | L2-Norm(final)=8.937 | 4555.6 samples/s | 71.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=62501 Epoch=239.5] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.317 | L2-Norm(final)=8.968 | 3207.2 samples/s | 50.1 steps/s
[Step=62550 Epoch=239.7] | Loss=0.00002 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.314 | L2-Norm(final)=8.971 | 3433.5 samples/s | 53.6 steps/s
[Step=62600 Epoch=239.9] | Loss=0.00002 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.310 | L2-Norm(final)=8.973 | 3688.3 samples/s | 57.6 steps/s
[Step=62650 Epoch=240.1] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.305 | L2-Norm(final)=8.975 | 3678.8 samples/s | 57.5 steps/s
[Step=62700 Epoch=240.2] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.300 | L2-Norm(final)=8.977 | 3710.2 samples/s | 58.0 steps/s
[Step=62750 Epoch=240.4] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=8.979 | 4612.0 samples/s | 72.1 steps/s
[Step=62800 Epoch=240.6] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=8.980 | 1467.2 samples/s | 22.9 steps/s
[Step=62850 Epoch=240.8] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.284 | L2-Norm(final)=8.982 | 3710.2 samples/s | 58.0 steps/s
[Step=62900 Epoch=241.0] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.279 | L2-Norm(final)=8.983 | 3701.0 samples/s | 57.8 steps/s
[Step=62950 Epoch=241.2] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.273 | L2-Norm(final)=8.985 | 3705.3 samples/s | 57.9 steps/s
[Step=63000 Epoch=241.4] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.267 | L2-Norm(final)=8.986 | 4115.4 samples/s | 64.3 steps/s
[Step=63050 Epoch=241.6] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.262 | L2-Norm(final)=8.987 | 1509.8 samples/s | 23.6 steps/s
[Step=63100 Epoch=241.8] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.256 | L2-Norm(final)=8.989 | 3638.3 samples/s | 56.8 steps/s
[Step=63150 Epoch=242.0] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.250 | L2-Norm(final)=8.990 | 3694.8 samples/s | 57.7 steps/s
[Step=63200 Epoch=242.2] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.244 | L2-Norm(final)=8.991 | 3719.0 samples/s | 58.1 steps/s
[Step=63250 Epoch=242.4] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.237 | L2-Norm(final)=8.992 | 3692.0 samples/s | 57.7 steps/s
[Step=63300 Epoch=242.5] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.231 | L2-Norm(final)=8.993 | 1584.7 samples/s | 24.8 steps/s
[Step=63350 Epoch=242.7] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.225 | L2-Norm(final)=8.994 | 3754.0 samples/s | 58.7 steps/s
[Step=63400 Epoch=242.9] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.219 | L2-Norm(final)=8.995 | 3707.2 samples/s | 57.9 steps/s
[Step=63450 Epoch=243.1] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.212 | L2-Norm(final)=8.996 | 3706.4 samples/s | 57.9 steps/s
[Step=63500 Epoch=243.3] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.206 | L2-Norm(final)=8.997 | 3786.4 samples/s | 59.2 steps/s
[Step=63550 Epoch=243.5] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.199 | L2-Norm(final)=8.998 | 1542.1 samples/s | 24.1 steps/s
[Step=63600 Epoch=243.7] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.192 | L2-Norm(final)=8.999 | 3705.2 samples/s | 57.9 steps/s
[Step=63650 Epoch=243.9] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.186 | L2-Norm(final)=9.000 | 3764.2 samples/s | 58.8 steps/s
[Step=63700 Epoch=244.1] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.179 | L2-Norm(final)=9.001 | 3752.6 samples/s | 58.6 steps/s
[Step=63750 Epoch=244.3] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.172 | L2-Norm(final)=9.002 | 3712.8 samples/s | 58.0 steps/s
[Step=63800 Epoch=244.5] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.165 | L2-Norm(final)=9.003 | 5047.6 samples/s | 78.9 steps/s
[Step=63850 Epoch=244.7] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.158 | L2-Norm(final)=9.004 | 1428.6 samples/s | 22.3 steps/s
[Step=63900 Epoch=244.8] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.151 | L2-Norm(final)=9.005 | 3744.4 samples/s | 58.5 steps/s
[Step=63950 Epoch=245.0] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.144 | L2-Norm(final)=9.006 | 3734.3 samples/s | 58.3 steps/s
[Step=64000 Epoch=245.2] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.137 | L2-Norm(final)=9.007 | 3713.1 samples/s | 58.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step64000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=62001 Epoch=238.7] | Loss=0.00007 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.324 | L2-Norm(final)=9.326 | 3230.7 samples/s | 50.5 steps/s
[Step=62050 Epoch=238.9] | Loss=0.00006 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.316 | L2-Norm(final)=9.336 | 3797.3 samples/s | 59.3 steps/s
[Step=62100 Epoch=239.0] | Loss=0.00005 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.315 | L2-Norm(final)=9.347 | 4121.1 samples/s | 64.4 steps/s
[Step=62150 Epoch=239.2] | Loss=0.00004 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.313 | L2-Norm(final)=9.357 | 4165.2 samples/s | 65.1 steps/s
[Step=62200 Epoch=239.4] | Loss=0.00004 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.310 | L2-Norm(final)=9.366 | 4145.3 samples/s | 64.8 steps/s
[Step=62250 Epoch=239.6] | Loss=0.00004 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.308 | L2-Norm(final)=9.374 | 5493.3 samples/s | 85.8 steps/s
[Step=62300 Epoch=239.8] | Loss=0.00003 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.306 | L2-Norm(final)=9.381 | 1511.7 samples/s | 23.6 steps/s
[Step=62350 Epoch=240.0] | Loss=0.00003 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.302 | L2-Norm(final)=9.388 | 4138.9 samples/s | 64.7 steps/s
[Step=62400 Epoch=240.2] | Loss=0.00003 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.298 | L2-Norm(final)=9.393 | 4156.9 samples/s | 65.0 steps/s
[Step=62450 Epoch=240.4] | Loss=0.00003 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.294 | L2-Norm(final)=9.399 | 4150.7 samples/s | 64.9 steps/s
[Step=62500 Epoch=240.6] | Loss=0.00003 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=9.404 | 4656.7 samples/s | 72.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=62501 Epoch=240.6] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.244 | L2-Norm(final)=9.454 | 3227.0 samples/s | 50.4 steps/s
[Step=62550 Epoch=240.8] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.211 | L2-Norm(final)=9.458 | 3391.3 samples/s | 53.0 steps/s
[Step=62600 Epoch=241.0] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.169 | L2-Norm(final)=9.461 | 3735.7 samples/s | 58.4 steps/s
[Step=62650 Epoch=241.2] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.125 | L2-Norm(final)=9.463 | 3703.5 samples/s | 57.9 steps/s
[Step=62700 Epoch=241.4] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.081 | L2-Norm(final)=9.465 | 3706.2 samples/s | 57.9 steps/s
[Step=62750 Epoch=241.5] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.036 | L2-Norm(final)=9.467 | 4776.1 samples/s | 74.6 steps/s
[Step=62800 Epoch=241.7] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.993 | L2-Norm(final)=9.468 | 1419.0 samples/s | 22.2 steps/s
[Step=62850 Epoch=241.9] | Loss=0.00000 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.948 | L2-Norm(final)=9.470 | 3739.5 samples/s | 58.4 steps/s
[Step=62900 Epoch=242.1] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=9.471 | 3677.7 samples/s | 57.5 steps/s
[Step=62950 Epoch=242.3] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.860 | L2-Norm(final)=9.473 | 3687.8 samples/s | 57.6 steps/s
[Step=63000 Epoch=242.5] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=9.474 | 4244.1 samples/s | 66.3 steps/s
[Step=63050 Epoch=242.7] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.771 | L2-Norm(final)=9.475 | 1527.0 samples/s | 23.9 steps/s
[Step=63100 Epoch=242.9] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.727 | L2-Norm(final)=9.476 | 3685.1 samples/s | 57.6 steps/s
[Step=63150 Epoch=243.1] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.682 | L2-Norm(final)=9.478 | 3721.3 samples/s | 58.1 steps/s
[Step=63200 Epoch=243.3] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.637 | L2-Norm(final)=9.479 | 3719.5 samples/s | 58.1 steps/s
[Step=63250 Epoch=243.5] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=9.480 | 3850.1 samples/s | 60.2 steps/s
[Step=63300 Epoch=243.7] | Loss=0.00003 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.550 | L2-Norm(final)=9.482 | 1559.9 samples/s | 24.4 steps/s
[Step=63350 Epoch=243.9] | Loss=0.00004 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.514 | L2-Norm(final)=9.484 | 3743.2 samples/s | 58.5 steps/s
[Step=63400 Epoch=244.1] | Loss=0.00004 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.483 | L2-Norm(final)=9.485 | 3710.8 samples/s | 58.0 steps/s
[Step=63450 Epoch=244.2] | Loss=0.00004 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.455 | L2-Norm(final)=9.487 | 3695.0 samples/s | 57.7 steps/s
[Step=63500 Epoch=244.4] | Loss=0.00004 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.429 | L2-Norm(final)=9.488 | 3717.6 samples/s | 58.1 steps/s
[Step=63550 Epoch=244.6] | Loss=0.00004 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.406 | L2-Norm(final)=9.490 | 1572.3 samples/s | 24.6 steps/s
[Step=63600 Epoch=244.8] | Loss=0.00004 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.384 | L2-Norm(final)=9.491 | 3776.5 samples/s | 59.0 steps/s
[Step=63650 Epoch=245.0] | Loss=0.00003 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.365 | L2-Norm(final)=9.493 | 3691.5 samples/s | 57.7 steps/s
[Step=63700 Epoch=245.2] | Loss=0.00003 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.346 | L2-Norm(final)=9.494 | 3756.1 samples/s | 58.7 steps/s
[Step=63750 Epoch=245.4] | Loss=0.00003 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.329 | L2-Norm(final)=9.495 | 3784.4 samples/s | 59.1 steps/s
[Step=63800 Epoch=245.6] | Loss=0.00003 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.312 | L2-Norm(final)=9.496 | 5384.6 samples/s | 84.1 steps/s
[Step=63850 Epoch=245.8] | Loss=0.00003 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.297 | L2-Norm(final)=9.498 | 1385.1 samples/s | 21.6 steps/s
[Step=63900 Epoch=246.0] | Loss=0.00003 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.283 | L2-Norm(final)=9.499 | 3693.3 samples/s | 57.7 steps/s
[Step=63950 Epoch=246.2] | Loss=0.00003 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.269 | L2-Norm(final)=9.500 | 3675.6 samples/s | 57.4 steps/s
[Step=64000 Epoch=246.4] | Loss=0.00003 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.256 | L2-Norm(final)=9.501 | 3728.7 samples/s | 58.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step64000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06259 | acc=0.9712 | tpr=0.9798 | fpr=0.0476 | 3557.8 samples/s | 13.9 steps/s
Avg test loss: 0.06787, Avg test acc: 0.96923, Avg tpr: 0.97739, Avg fpr: 0.04871, total FA: 380

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06222 | acc=0.9714 | tpr=0.9774 | fpr=0.0416 | 3489.2 samples/s | 13.6 steps/s
Avg test loss: 0.06972, Avg test acc: 0.96879, Avg tpr: 0.97570, Avg fpr: 0.04640, total FA: 362

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.09951 | acc=0.3146 | tpr=0.0203 | fpr=0.0463 | 3494.0 samples/s | 13.6 steps/s
Avg test loss: 5.10860, Avg test acc: 0.31144, Avg tpr: 0.01935, Avg fpr: 0.04615, total FA: 360

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.98545 | acc=0.3077 | tpr=0.0228 | fpr=0.0738 | 3471.2 samples/s | 13.6 steps/s
Avg test loss: 4.99060, Avg test acc: 0.30491, Avg tpr: 0.02232, Avg fpr: 0.07358, total FA: 574

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.14140 | acc=0.0970 | tpr=0.8717 | fpr=0.9169 | 3473.1 samples/s | 13.6 steps/s
[Step= 100] | Loss=6.11964 | acc=0.0978 | tpr=0.8742 | fpr=0.9167 | 6918.4 samples/s | 27.0 steps/s
[Step= 150] | Loss=6.13754 | acc=0.0967 | tpr=0.8732 | fpr=0.9175 | 6973.4 samples/s | 27.2 steps/s
[Step= 200] | Loss=6.11658 | acc=0.0968 | tpr=0.8634 | fpr=0.9172 | 6901.4 samples/s | 27.0 steps/s
[Step= 250] | Loss=6.11546 | acc=0.0971 | tpr=0.8576 | fpr=0.9168 | 6653.8 samples/s | 26.0 steps/s
[Step= 300] | Loss=6.11722 | acc=0.0966 | tpr=0.8567 | fpr=0.9172 | 6854.1 samples/s | 26.8 steps/s
[Step= 350] | Loss=6.11542 | acc=0.0970 | tpr=0.8635 | fpr=0.9170 | 6774.9 samples/s | 26.5 steps/s
[Step= 400] | Loss=6.11239 | acc=0.0968 | tpr=0.8605 | fpr=0.9170 | 6894.8 samples/s | 26.9 steps/s
[Step= 450] | Loss=6.11959 | acc=0.0967 | tpr=0.8622 | fpr=0.9172 | 6590.8 samples/s | 25.7 steps/s
[Step= 500] | Loss=6.12238 | acc=0.0966 | tpr=0.8621 | fpr=0.9173 | 6794.6 samples/s | 26.5 steps/s
[Step= 550] | Loss=6.12205 | acc=0.0969 | tpr=0.8623 | fpr=0.9170 | 12662.3 samples/s | 49.5 steps/s
Avg test loss: 6.12303, Avg test acc: 0.09686, Avg tpr: 0.86173, Avg fpr: 0.91705, total FA: 127330

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.98732 | acc=0.1083 | tpr=0.8584 | fpr=0.9052 | 3522.1 samples/s | 13.8 steps/s
[Step= 100] | Loss=5.96095 | acc=0.1113 | tpr=0.8699 | fpr=0.9029 | 6832.0 samples/s | 26.7 steps/s
[Step= 150] | Loss=5.97521 | acc=0.1105 | tpr=0.8660 | fpr=0.9034 | 6817.8 samples/s | 26.6 steps/s
[Step= 200] | Loss=5.95786 | acc=0.1105 | tpr=0.8579 | fpr=0.9031 | 6903.5 samples/s | 27.0 steps/s
[Step= 250] | Loss=5.95703 | acc=0.1108 | tpr=0.8550 | fpr=0.9028 | 6969.3 samples/s | 27.2 steps/s
[Step= 300] | Loss=5.95931 | acc=0.1106 | tpr=0.8531 | fpr=0.9029 | 6779.9 samples/s | 26.5 steps/s
[Step= 350] | Loss=5.95882 | acc=0.1110 | tpr=0.8585 | fpr=0.9026 | 6826.1 samples/s | 26.7 steps/s
[Step= 400] | Loss=5.95417 | acc=0.1112 | tpr=0.8550 | fpr=0.9023 | 6947.0 samples/s | 27.1 steps/s
[Step= 450] | Loss=5.96056 | acc=0.1109 | tpr=0.8569 | fpr=0.9026 | 6842.2 samples/s | 26.7 steps/s
[Step= 500] | Loss=5.96115 | acc=0.1109 | tpr=0.8573 | fpr=0.9026 | 6810.0 samples/s | 26.6 steps/s
[Step= 550] | Loss=5.96133 | acc=0.1112 | tpr=0.8583 | fpr=0.9024 | 12391.8 samples/s | 48.4 steps/s
Avg test loss: 5.96228, Avg test acc: 0.11106, Avg tpr: 0.85777, Avg fpr: 0.90251, total FA: 125312

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11259 | acc=0.9812 | tpr=0.9381 | fpr=0.0180 | 3491.1 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.11594 | acc=0.9810 | tpr=0.9574 | fpr=0.0186 | 6797.6 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.11854 | acc=0.9802 | tpr=0.9568 | fpr=0.0194 | 7143.6 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.11914 | acc=0.9801 | tpr=0.9530 | fpr=0.0194 | 6807.3 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.11752 | acc=0.9805 | tpr=0.9511 | fpr=0.0190 | 6722.7 samples/s | 26.3 steps/s
[Step= 300] | Loss=0.11965 | acc=0.9802 | tpr=0.9520 | fpr=0.0193 | 6985.7 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.11936 | acc=0.9801 | tpr=0.9518 | fpr=0.0194 | 6722.7 samples/s | 26.3 steps/s
[Step= 400] | Loss=0.12082 | acc=0.9800 | tpr=0.9502 | fpr=0.0195 | 6846.5 samples/s | 26.7 steps/s
[Step= 450] | Loss=0.12325 | acc=0.9797 | tpr=0.9474 | fpr=0.0197 | 6707.5 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.12301 | acc=0.9797 | tpr=0.9502 | fpr=0.0198 | 6853.3 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.12238 | acc=0.9799 | tpr=0.9499 | fpr=0.0196 | 12312.3 samples/s | 48.1 steps/s
Avg test loss: 0.12228, Avg test acc: 0.97989, Avg tpr: 0.94929, Avg fpr: 0.01955, total FA: 2715

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10975 | acc=0.9814 | tpr=0.9469 | fpr=0.0180 | 3543.8 samples/s | 13.8 steps/s
[Step= 100] | Loss=0.11330 | acc=0.9813 | tpr=0.9616 | fpr=0.0183 | 6893.3 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.11617 | acc=0.9802 | tpr=0.9640 | fpr=0.0195 | 6873.6 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.11782 | acc=0.9802 | tpr=0.9628 | fpr=0.0194 | 6708.8 samples/s | 26.2 steps/s
[Step= 250] | Loss=0.11666 | acc=0.9804 | tpr=0.9598 | fpr=0.0192 | 6766.5 samples/s | 26.4 steps/s
[Step= 300] | Loss=0.11945 | acc=0.9800 | tpr=0.9578 | fpr=0.0196 | 6931.0 samples/s | 27.1 steps/s
[Step= 350] | Loss=0.11905 | acc=0.9801 | tpr=0.9574 | fpr=0.0195 | 6808.5 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.12042 | acc=0.9800 | tpr=0.9546 | fpr=0.0196 | 6740.7 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.12260 | acc=0.9796 | tpr=0.9533 | fpr=0.0199 | 6693.6 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.12250 | acc=0.9796 | tpr=0.9555 | fpr=0.0199 | 6671.4 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.12163 | acc=0.9798 | tpr=0.9554 | fpr=0.0198 | 12603.8 samples/s | 49.2 steps/s
Avg test loss: 0.12153, Avg test acc: 0.97981, Avg tpr: 0.95483, Avg fpr: 0.01974, total FA: 2741

server round 32/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=64001 Epoch=124.8] | Loss=0.01063 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.933 | L2-Norm(final)=11.909 | 3047.9 samples/s | 47.6 steps/s
[Step=64050 Epoch=124.9] | Loss=0.01117 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.942 | L2-Norm(final)=11.915 | 4104.1 samples/s | 64.1 steps/s
[Step=64100 Epoch=125.0] | Loss=0.01118 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.950 | L2-Norm(final)=11.923 | 4405.2 samples/s | 68.8 steps/s
[Step=64150 Epoch=125.1] | Loss=0.01083 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.956 | L2-Norm(final)=11.930 | 4283.9 samples/s | 66.9 steps/s
[Step=64200 Epoch=125.2] | Loss=0.01069 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.962 | L2-Norm(final)=11.937 | 4323.8 samples/s | 67.6 steps/s
[Step=64250 Epoch=125.3] | Loss=0.01044 | Reg=0.00099 | acc=0.9688 | L2-Norm=9.968 | L2-Norm(final)=11.944 | 4443.5 samples/s | 69.4 steps/s
[Step=64300 Epoch=125.4] | Loss=0.00986 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.973 | L2-Norm(final)=11.952 | 4386.2 samples/s | 68.5 steps/s
[Step=64350 Epoch=125.5] | Loss=0.00962 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=11.960 | 4257.6 samples/s | 66.5 steps/s
[Step=64400 Epoch=125.6] | Loss=0.00925 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.984 | L2-Norm(final)=11.968 | 4396.1 samples/s | 68.7 steps/s
[Step=64450 Epoch=125.7] | Loss=0.00917 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.989 | L2-Norm(final)=11.975 | 4364.2 samples/s | 68.2 steps/s
[Step=64500 Epoch=125.8] | Loss=0.00929 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.994 | L2-Norm(final)=11.983 | 5373.7 samples/s | 84.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=64501 Epoch=125.8] | Loss=0.00727 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.042 | L2-Norm(final)=12.053 | 3299.9 samples/s | 51.6 steps/s
[Step=64550 Epoch=125.9] | Loss=0.01013 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.049 | L2-Norm(final)=12.059 | 3617.1 samples/s | 56.5 steps/s
[Step=64600 Epoch=126.0] | Loss=0.01061 | Reg=0.00101 | acc=0.9219 | L2-Norm=10.057 | L2-Norm(final)=12.065 | 3887.9 samples/s | 60.7 steps/s
[Step=64650 Epoch=126.1] | Loss=0.01064 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.065 | L2-Norm(final)=12.069 | 3955.3 samples/s | 61.8 steps/s
[Step=64700 Epoch=126.2] | Loss=0.01051 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.072 | L2-Norm(final)=12.075 | 3918.7 samples/s | 61.2 steps/s
[Step=64750 Epoch=126.3] | Loss=0.00990 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.079 | L2-Norm(final)=12.080 | 3979.2 samples/s | 62.2 steps/s
[Step=64800 Epoch=126.4] | Loss=0.00948 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.085 | L2-Norm(final)=12.085 | 3978.0 samples/s | 62.2 steps/s
[Step=64850 Epoch=126.5] | Loss=0.00959 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.091 | L2-Norm(final)=12.090 | 3965.6 samples/s | 62.0 steps/s
[Step=64900 Epoch=126.6] | Loss=0.00939 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.097 | L2-Norm(final)=12.094 | 3911.1 samples/s | 61.1 steps/s
[Step=64950 Epoch=126.7] | Loss=0.00939 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.102 | L2-Norm(final)=12.098 | 4000.7 samples/s | 62.5 steps/s
[Step=65000 Epoch=126.8] | Loss=0.00924 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.107 | L2-Norm(final)=12.102 | 4742.4 samples/s | 74.1 steps/s
[Step=65050 Epoch=126.9] | Loss=0.00896 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.112 | L2-Norm(final)=12.107 | 1449.0 samples/s | 22.6 steps/s
[Step=65100 Epoch=127.0] | Loss=0.00882 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.117 | L2-Norm(final)=12.111 | 3843.9 samples/s | 60.1 steps/s
[Step=65150 Epoch=127.1] | Loss=0.00856 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.122 | L2-Norm(final)=12.115 | 3859.7 samples/s | 60.3 steps/s
[Step=65200 Epoch=127.2] | Loss=0.00841 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.126 | L2-Norm(final)=12.119 | 3833.6 samples/s | 59.9 steps/s
[Step=65250 Epoch=127.3] | Loss=0.00823 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.131 | L2-Norm(final)=12.124 | 3833.1 samples/s | 59.9 steps/s
[Step=65300 Epoch=127.4] | Loss=0.00818 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=12.128 | 3815.7 samples/s | 59.6 steps/s
[Step=65350 Epoch=127.5] | Loss=0.00809 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.139 | L2-Norm(final)=12.132 | 3945.9 samples/s | 61.7 steps/s
[Step=65400 Epoch=127.6] | Loss=0.00802 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.144 | L2-Norm(final)=12.136 | 3987.0 samples/s | 62.3 steps/s
[Step=65450 Epoch=127.7] | Loss=0.00798 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.148 | L2-Norm(final)=12.140 | 3942.5 samples/s | 61.6 steps/s
[Step=65500 Epoch=127.8] | Loss=0.00789 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.152 | L2-Norm(final)=12.144 | 4199.6 samples/s | 65.6 steps/s
[Step=65550 Epoch=127.8] | Loss=0.00769 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.155 | L2-Norm(final)=12.148 | 1525.7 samples/s | 23.8 steps/s
[Step=65600 Epoch=127.9] | Loss=0.00755 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.159 | L2-Norm(final)=12.152 | 3971.6 samples/s | 62.1 steps/s
[Step=65650 Epoch=128.0] | Loss=0.00747 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.163 | L2-Norm(final)=12.156 | 3933.8 samples/s | 61.5 steps/s
[Step=65700 Epoch=128.1] | Loss=0.00742 | Reg=0.00103 | acc=0.9688 | L2-Norm=10.166 | L2-Norm(final)=12.159 | 3933.2 samples/s | 61.5 steps/s
[Step=65750 Epoch=128.2] | Loss=0.00734 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.169 | L2-Norm(final)=12.163 | 3953.3 samples/s | 61.8 steps/s
[Step=65800 Epoch=128.3] | Loss=0.00733 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.172 | L2-Norm(final)=12.166 | 3932.5 samples/s | 61.4 steps/s
[Step=65850 Epoch=128.4] | Loss=0.00736 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.176 | L2-Norm(final)=12.170 | 3970.8 samples/s | 62.0 steps/s
[Step=65900 Epoch=128.5] | Loss=0.00727 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.179 | L2-Norm(final)=12.173 | 3896.2 samples/s | 60.9 steps/s
[Step=65950 Epoch=128.6] | Loss=0.00727 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.182 | L2-Norm(final)=12.176 | 3969.8 samples/s | 62.0 steps/s
[Step=66000 Epoch=128.7] | Loss=0.00720 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.185 | L2-Norm(final)=12.179 | 3938.8 samples/s | 61.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step66000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=64001 Epoch=125.1] | Loss=0.00168 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.933 | L2-Norm(final)=12.108 | 3195.5 samples/s | 49.9 steps/s
[Step=64050 Epoch=125.2] | Loss=0.01440 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.940 | L2-Norm(final)=12.113 | 4338.0 samples/s | 67.8 steps/s
[Step=64100 Epoch=125.3] | Loss=0.01235 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.947 | L2-Norm(final)=12.120 | 4469.3 samples/s | 69.8 steps/s
[Step=64150 Epoch=125.4] | Loss=0.01124 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.954 | L2-Norm(final)=12.128 | 4352.4 samples/s | 68.0 steps/s
[Step=64200 Epoch=125.5] | Loss=0.01062 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.959 | L2-Norm(final)=12.137 | 4290.2 samples/s | 67.0 steps/s
[Step=64250 Epoch=125.6] | Loss=0.01036 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.964 | L2-Norm(final)=12.145 | 4329.4 samples/s | 67.6 steps/s
[Step=64300 Epoch=125.7] | Loss=0.01003 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.969 | L2-Norm(final)=12.153 | 4421.4 samples/s | 69.1 steps/s
[Step=64350 Epoch=125.8] | Loss=0.00985 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.974 | L2-Norm(final)=12.161 | 4427.7 samples/s | 69.2 steps/s
[Step=64400 Epoch=125.9] | Loss=0.00962 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=12.169 | 4333.5 samples/s | 67.7 steps/s
[Step=64450 Epoch=126.0] | Loss=0.00933 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.984 | L2-Norm(final)=12.177 | 4411.5 samples/s | 68.9 steps/s
[Step=64500 Epoch=126.1] | Loss=0.00913 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.989 | L2-Norm(final)=12.185 | 5629.1 samples/s | 88.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=64501 Epoch=126.1] | Loss=0.01104 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.035 | L2-Norm(final)=12.262 | 3310.7 samples/s | 51.7 steps/s
[Step=64550 Epoch=126.2] | Loss=0.00786 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.042 | L2-Norm(final)=12.269 | 3705.9 samples/s | 57.9 steps/s
[Step=64600 Epoch=126.3] | Loss=0.00887 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.050 | L2-Norm(final)=12.275 | 3932.8 samples/s | 61.5 steps/s
[Step=64650 Epoch=126.4] | Loss=0.00938 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.057 | L2-Norm(final)=12.280 | 3955.1 samples/s | 61.8 steps/s
[Step=64700 Epoch=126.5] | Loss=0.00930 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.064 | L2-Norm(final)=12.285 | 3889.6 samples/s | 60.8 steps/s
[Step=64750 Epoch=126.6] | Loss=0.00898 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.070 | L2-Norm(final)=12.289 | 3965.6 samples/s | 62.0 steps/s
[Step=64800 Epoch=126.7] | Loss=0.00879 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.076 | L2-Norm(final)=12.294 | 3966.3 samples/s | 62.0 steps/s
[Step=64850 Epoch=126.8] | Loss=0.00880 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.082 | L2-Norm(final)=12.299 | 3938.0 samples/s | 61.5 steps/s
[Step=64900 Epoch=126.9] | Loss=0.00867 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.087 | L2-Norm(final)=12.303 | 3964.4 samples/s | 61.9 steps/s
[Step=64950 Epoch=127.0] | Loss=0.00863 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.093 | L2-Norm(final)=12.308 | 3963.9 samples/s | 61.9 steps/s
[Step=65000 Epoch=127.1] | Loss=0.00874 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.098 | L2-Norm(final)=12.312 | 4844.3 samples/s | 75.7 steps/s
[Step=65050 Epoch=127.2] | Loss=0.00865 | Reg=0.00102 | acc=0.9688 | L2-Norm=10.103 | L2-Norm(final)=12.317 | 1527.9 samples/s | 23.9 steps/s
[Step=65100 Epoch=127.3] | Loss=0.00840 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.107 | L2-Norm(final)=12.321 | 3979.3 samples/s | 62.2 steps/s
[Step=65150 Epoch=127.4] | Loss=0.00830 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.112 | L2-Norm(final)=12.325 | 3925.6 samples/s | 61.3 steps/s
[Step=65200 Epoch=127.5] | Loss=0.00814 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.116 | L2-Norm(final)=12.329 | 3909.2 samples/s | 61.1 steps/s
[Step=65250 Epoch=127.6] | Loss=0.00793 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.121 | L2-Norm(final)=12.333 | 3940.7 samples/s | 61.6 steps/s
[Step=65300 Epoch=127.7] | Loss=0.00784 | Reg=0.00103 | acc=0.9531 | L2-Norm=10.125 | L2-Norm(final)=12.337 | 3955.4 samples/s | 61.8 steps/s
[Step=65350 Epoch=127.8] | Loss=0.00777 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.129 | L2-Norm(final)=12.341 | 3953.7 samples/s | 61.8 steps/s
[Step=65400 Epoch=127.9] | Loss=0.00770 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.132 | L2-Norm(final)=12.345 | 3932.8 samples/s | 61.5 steps/s
[Step=65450 Epoch=128.0] | Loss=0.00761 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.136 | L2-Norm(final)=12.348 | 3991.0 samples/s | 62.4 steps/s
[Step=65500 Epoch=128.1] | Loss=0.00749 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.139 | L2-Norm(final)=12.352 | 4296.2 samples/s | 67.1 steps/s
[Step=65550 Epoch=128.1] | Loss=0.00743 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.143 | L2-Norm(final)=12.356 | 1588.3 samples/s | 24.8 steps/s
[Step=65600 Epoch=128.2] | Loss=0.00726 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.147 | L2-Norm(final)=12.359 | 3980.3 samples/s | 62.2 steps/s
[Step=65650 Epoch=128.3] | Loss=0.00714 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.150 | L2-Norm(final)=12.363 | 3913.3 samples/s | 61.1 steps/s
[Step=65700 Epoch=128.4] | Loss=0.00710 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.154 | L2-Norm(final)=12.366 | 3947.0 samples/s | 61.7 steps/s
[Step=65750 Epoch=128.5] | Loss=0.00709 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.157 | L2-Norm(final)=12.370 | 3943.1 samples/s | 61.6 steps/s
[Step=65800 Epoch=128.6] | Loss=0.00701 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.160 | L2-Norm(final)=12.373 | 3954.2 samples/s | 61.8 steps/s
[Step=65850 Epoch=128.7] | Loss=0.00694 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.163 | L2-Norm(final)=12.376 | 3914.7 samples/s | 61.2 steps/s
[Step=65900 Epoch=128.8] | Loss=0.00692 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.166 | L2-Norm(final)=12.380 | 3980.4 samples/s | 62.2 steps/s
[Step=65950 Epoch=128.9] | Loss=0.00692 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.169 | L2-Norm(final)=12.383 | 3945.9 samples/s | 61.7 steps/s
[Step=66000 Epoch=129.0] | Loss=0.00689 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.172 | L2-Norm(final)=12.386 | 3968.3 samples/s | 62.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step66000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=64001 Epoch=245.2] | Loss=0.00003 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.933 | L2-Norm(final)=9.038 | 3337.7 samples/s | 52.2 steps/s
[Step=64050 Epoch=245.4] | Loss=0.00041 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.942 | L2-Norm(final)=9.047 | 3718.3 samples/s | 58.1 steps/s
[Step=64100 Epoch=245.6] | Loss=0.00027 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.954 | L2-Norm(final)=9.051 | 4173.3 samples/s | 65.2 steps/s
[Step=64150 Epoch=245.8] | Loss=0.00020 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.960 | L2-Norm(final)=9.056 | 4186.0 samples/s | 65.4 steps/s
[Step=64200 Epoch=246.0] | Loss=0.00016 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.962 | L2-Norm(final)=9.060 | 4082.1 samples/s | 63.8 steps/s
[Step=64250 Epoch=246.2] | Loss=0.00014 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.963 | L2-Norm(final)=9.063 | 5392.9 samples/s | 84.3 steps/s
[Step=64300 Epoch=246.4] | Loss=0.00012 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.963 | L2-Norm(final)=9.066 | 1515.4 samples/s | 23.7 steps/s
[Step=64350 Epoch=246.6] | Loss=0.00011 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.963 | L2-Norm(final)=9.069 | 4102.3 samples/s | 64.1 steps/s
[Step=64400 Epoch=246.8] | Loss=0.00010 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.962 | L2-Norm(final)=9.072 | 4161.7 samples/s | 65.0 steps/s
[Step=64450 Epoch=246.9] | Loss=0.00009 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.961 | L2-Norm(final)=9.075 | 4120.3 samples/s | 64.4 steps/s
[Step=64500 Epoch=247.1] | Loss=0.00008 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.960 | L2-Norm(final)=9.077 | 4587.2 samples/s | 71.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=64501 Epoch=247.1] | Loss=0.00004 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.949 | L2-Norm(final)=9.103 | 3216.6 samples/s | 50.3 steps/s
[Step=64550 Epoch=247.3] | Loss=0.00002 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.944 | L2-Norm(final)=9.105 | 3505.2 samples/s | 54.8 steps/s
[Step=64600 Epoch=247.5] | Loss=0.00002 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.936 | L2-Norm(final)=9.107 | 3726.7 samples/s | 58.2 steps/s
[Step=64650 Epoch=247.7] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.928 | L2-Norm(final)=9.109 | 3668.1 samples/s | 57.3 steps/s
[Step=64700 Epoch=247.9] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.919 | L2-Norm(final)=9.110 | 3718.4 samples/s | 58.1 steps/s
[Step=64750 Epoch=248.1] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.910 | L2-Norm(final)=9.111 | 4633.1 samples/s | 72.4 steps/s
[Step=64800 Epoch=248.3] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=9.112 | 1439.5 samples/s | 22.5 steps/s
[Step=64850 Epoch=248.5] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.892 | L2-Norm(final)=9.113 | 3709.5 samples/s | 58.0 steps/s
[Step=64900 Epoch=248.7] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=9.114 | 3687.7 samples/s | 57.6 steps/s
[Step=64950 Epoch=248.9] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=9.115 | 3706.4 samples/s | 57.9 steps/s
[Step=65000 Epoch=249.1] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.863 | L2-Norm(final)=9.116 | 4098.4 samples/s | 64.0 steps/s
[Step=65050 Epoch=249.2] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.853 | L2-Norm(final)=9.117 | 1519.0 samples/s | 23.7 steps/s
[Step=65100 Epoch=249.4] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=9.118 | 3615.3 samples/s | 56.5 steps/s
[Step=65150 Epoch=249.6] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.832 | L2-Norm(final)=9.119 | 3689.2 samples/s | 57.6 steps/s
[Step=65200 Epoch=249.8] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.822 | L2-Norm(final)=9.119 | 3727.5 samples/s | 58.2 steps/s
[Step=65250 Epoch=250.0] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.811 | L2-Norm(final)=9.120 | 3687.3 samples/s | 57.6 steps/s
[Step=65300 Epoch=250.2] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.800 | L2-Norm(final)=9.121 | 1588.9 samples/s | 24.8 steps/s
[Step=65350 Epoch=250.4] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.789 | L2-Norm(final)=9.122 | 3715.1 samples/s | 58.0 steps/s
[Step=65400 Epoch=250.6] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.778 | L2-Norm(final)=9.123 | 3717.2 samples/s | 58.1 steps/s
[Step=65450 Epoch=250.8] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=9.124 | 3657.6 samples/s | 57.2 steps/s
[Step=65500 Epoch=251.0] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.756 | L2-Norm(final)=9.124 | 3756.3 samples/s | 58.7 steps/s
[Step=65550 Epoch=251.2] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.744 | L2-Norm(final)=9.125 | 1571.2 samples/s | 24.6 steps/s
[Step=65600 Epoch=251.4] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.733 | L2-Norm(final)=9.126 | 3700.2 samples/s | 57.8 steps/s
[Step=65650 Epoch=251.5] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.721 | L2-Norm(final)=9.127 | 3729.9 samples/s | 58.3 steps/s
[Step=65700 Epoch=251.7] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.709 | L2-Norm(final)=9.128 | 3689.5 samples/s | 57.6 steps/s
[Step=65750 Epoch=251.9] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.697 | L2-Norm(final)=9.128 | 3740.9 samples/s | 58.5 steps/s
[Step=65800 Epoch=252.1] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.685 | L2-Norm(final)=9.129 | 5066.9 samples/s | 79.2 steps/s
[Step=65850 Epoch=252.3] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.673 | L2-Norm(final)=9.130 | 1401.0 samples/s | 21.9 steps/s
[Step=65900 Epoch=252.5] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.660 | L2-Norm(final)=9.131 | 3654.2 samples/s | 57.1 steps/s
[Step=65950 Epoch=252.7] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.648 | L2-Norm(final)=9.132 | 3706.5 samples/s | 57.9 steps/s
[Step=66000 Epoch=252.9] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.635 | L2-Norm(final)=9.133 | 3746.6 samples/s | 58.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step66000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=64001 Epoch=246.4] | Loss=0.00027 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.933 | L2-Norm(final)=9.529 | 3369.0 samples/s | 52.6 steps/s
[Step=64050 Epoch=246.6] | Loss=0.00008 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.932 | L2-Norm(final)=9.533 | 3754.2 samples/s | 58.7 steps/s
[Step=64100 Epoch=246.7] | Loss=0.00006 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.934 | L2-Norm(final)=9.537 | 4138.8 samples/s | 64.7 steps/s
[Step=64150 Epoch=246.9] | Loss=0.00005 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.934 | L2-Norm(final)=9.540 | 4158.4 samples/s | 65.0 steps/s
[Step=64200 Epoch=247.1] | Loss=0.00004 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.934 | L2-Norm(final)=9.543 | 4026.3 samples/s | 62.9 steps/s
[Step=64250 Epoch=247.3] | Loss=0.00004 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.932 | L2-Norm(final)=9.546 | 5405.9 samples/s | 84.5 steps/s
[Step=64300 Epoch=247.5] | Loss=0.00003 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.931 | L2-Norm(final)=9.548 | 1510.5 samples/s | 23.6 steps/s
[Step=64350 Epoch=247.7] | Loss=0.00003 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.929 | L2-Norm(final)=9.550 | 4091.5 samples/s | 63.9 steps/s
[Step=64400 Epoch=247.9] | Loss=0.00003 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.927 | L2-Norm(final)=9.552 | 4097.0 samples/s | 64.0 steps/s
[Step=64450 Epoch=248.1] | Loss=0.00003 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.925 | L2-Norm(final)=9.555 | 4152.2 samples/s | 64.9 steps/s
[Step=64500 Epoch=248.3] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.923 | L2-Norm(final)=9.557 | 4791.8 samples/s | 74.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=64501 Epoch=248.3] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=9.577 | 3223.1 samples/s | 50.4 steps/s
[Step=64550 Epoch=248.5] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=9.579 | 3488.1 samples/s | 54.5 steps/s
[Step=64600 Epoch=248.7] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.893 | L2-Norm(final)=9.580 | 3755.4 samples/s | 58.7 steps/s
[Step=64650 Epoch=248.9] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.887 | L2-Norm(final)=9.582 | 3765.9 samples/s | 58.8 steps/s
[Step=64700 Epoch=249.1] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.881 | L2-Norm(final)=9.583 | 3725.5 samples/s | 58.2 steps/s
[Step=64750 Epoch=249.2] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=9.584 | 4737.4 samples/s | 74.0 steps/s
[Step=64800 Epoch=249.4] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.868 | L2-Norm(final)=9.586 | 1444.2 samples/s | 22.6 steps/s
[Step=64850 Epoch=249.6] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.862 | L2-Norm(final)=9.587 | 3672.1 samples/s | 57.4 steps/s
[Step=64900 Epoch=249.8] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.855 | L2-Norm(final)=9.588 | 3733.1 samples/s | 58.3 steps/s
[Step=64950 Epoch=250.0] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.849 | L2-Norm(final)=9.589 | 3703.4 samples/s | 57.9 steps/s
[Step=65000 Epoch=250.2] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=9.590 | 4223.9 samples/s | 66.0 steps/s
[Step=65050 Epoch=250.4] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.835 | L2-Norm(final)=9.591 | 1509.8 samples/s | 23.6 steps/s
[Step=65100 Epoch=250.6] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.828 | L2-Norm(final)=9.592 | 3706.6 samples/s | 57.9 steps/s
[Step=65150 Epoch=250.8] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.821 | L2-Norm(final)=9.593 | 3715.2 samples/s | 58.0 steps/s
[Step=65200 Epoch=251.0] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.814 | L2-Norm(final)=9.594 | 3687.3 samples/s | 57.6 steps/s
[Step=65250 Epoch=251.2] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=9.595 | 3830.7 samples/s | 59.9 steps/s
[Step=65300 Epoch=251.4] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.799 | L2-Norm(final)=9.596 | 1575.8 samples/s | 24.6 steps/s
[Step=65350 Epoch=251.6] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.792 | L2-Norm(final)=9.597 | 3707.7 samples/s | 57.9 steps/s
[Step=65400 Epoch=251.8] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.784 | L2-Norm(final)=9.598 | 3751.5 samples/s | 58.6 steps/s
[Step=65450 Epoch=251.9] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.777 | L2-Norm(final)=9.599 | 3702.0 samples/s | 57.8 steps/s
[Step=65500 Epoch=252.1] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.769 | L2-Norm(final)=9.600 | 3759.2 samples/s | 58.7 steps/s
[Step=65550 Epoch=252.3] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.762 | L2-Norm(final)=9.601 | 1589.4 samples/s | 24.8 steps/s
[Step=65600 Epoch=252.5] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.754 | L2-Norm(final)=9.602 | 3726.1 samples/s | 58.2 steps/s
[Step=65650 Epoch=252.7] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.746 | L2-Norm(final)=9.603 | 3737.5 samples/s | 58.4 steps/s
[Step=65700 Epoch=252.9] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.738 | L2-Norm(final)=9.604 | 3734.9 samples/s | 58.4 steps/s
[Step=65750 Epoch=253.1] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.730 | L2-Norm(final)=9.605 | 3714.7 samples/s | 58.0 steps/s
[Step=65800 Epoch=253.3] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.722 | L2-Norm(final)=9.606 | 5456.3 samples/s | 85.3 steps/s
[Step=65850 Epoch=253.5] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.714 | L2-Norm(final)=9.607 | 1397.7 samples/s | 21.8 steps/s
[Step=65900 Epoch=253.7] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.706 | L2-Norm(final)=9.608 | 3753.0 samples/s | 58.6 steps/s
[Step=65950 Epoch=253.9] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.697 | L2-Norm(final)=9.609 | 3752.1 samples/s | 58.6 steps/s
[Step=66000 Epoch=254.1] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.689 | L2-Norm(final)=9.610 | 3709.6 samples/s | 58.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step66000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06257 | acc=0.9688 | tpr=0.9722 | fpr=0.0384 | 3495.8 samples/s | 13.7 steps/s
Avg test loss: 0.06729, Avg test acc: 0.96727, Avg tpr: 0.97039, Avg fpr: 0.03961, total FA: 309

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06398 | acc=0.9691 | tpr=0.9777 | fpr=0.0496 | 3512.4 samples/s | 13.7 steps/s
Avg test loss: 0.07052, Avg test acc: 0.96747, Avg tpr: 0.97744, Avg fpr: 0.05448, total FA: 425

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.35295 | acc=0.3095 | tpr=0.0169 | fpr=0.0550 | 3496.5 samples/s | 13.7 steps/s
Avg test loss: 5.36190, Avg test acc: 0.30660, Avg tpr: 0.01655, Avg fpr: 0.05551, total FA: 433

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.71388 | acc=0.3160 | tpr=0.0204 | fpr=0.0421 | 3518.2 samples/s | 13.7 steps/s
Avg test loss: 4.72188, Avg test acc: 0.31301, Avg tpr: 0.02005, Avg fpr: 0.04269, total FA: 333

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.49375 | acc=0.1118 | tpr=0.8407 | fpr=0.9013 | 3502.0 samples/s | 13.7 steps/s
[Step= 100] | Loss=5.47566 | acc=0.1136 | tpr=0.8593 | fpr=0.9003 | 6813.9 samples/s | 26.6 steps/s
[Step= 150] | Loss=5.49117 | acc=0.1118 | tpr=0.8602 | fpr=0.9019 | 6812.0 samples/s | 26.6 steps/s
[Step= 200] | Loss=5.47202 | acc=0.1123 | tpr=0.8536 | fpr=0.9012 | 6948.6 samples/s | 27.1 steps/s
[Step= 250] | Loss=5.47373 | acc=0.1127 | tpr=0.8489 | fpr=0.9008 | 6895.7 samples/s | 26.9 steps/s
[Step= 300] | Loss=5.47538 | acc=0.1126 | tpr=0.8480 | fpr=0.9009 | 6777.8 samples/s | 26.5 steps/s
[Step= 350] | Loss=5.47354 | acc=0.1129 | tpr=0.8541 | fpr=0.9006 | 6784.9 samples/s | 26.5 steps/s
[Step= 400] | Loss=5.47031 | acc=0.1129 | tpr=0.8512 | fpr=0.9005 | 6868.0 samples/s | 26.8 steps/s
[Step= 450] | Loss=5.47701 | acc=0.1126 | tpr=0.8535 | fpr=0.9009 | 6734.0 samples/s | 26.3 steps/s
[Step= 500] | Loss=5.47896 | acc=0.1124 | tpr=0.8533 | fpr=0.9009 | 6810.7 samples/s | 26.6 steps/s
[Step= 550] | Loss=5.47841 | acc=0.1127 | tpr=0.8532 | fpr=0.9007 | 11900.2 samples/s | 46.5 steps/s
Avg test loss: 5.47944, Avg test acc: 0.11261, Avg tpr: 0.85261, Avg fpr: 0.90084, total FA: 125080

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.12468 | acc=0.1033 | tpr=0.8805 | fpr=0.9107 | 3500.5 samples/s | 13.7 steps/s
[Step= 100] | Loss=6.10596 | acc=0.1051 | tpr=0.8849 | fpr=0.9094 | 6646.9 samples/s | 26.0 steps/s
[Step= 150] | Loss=6.12280 | acc=0.1041 | tpr=0.8804 | fpr=0.9102 | 6811.4 samples/s | 26.6 steps/s
[Step= 200] | Loss=6.10494 | acc=0.1036 | tpr=0.8754 | fpr=0.9105 | 6783.9 samples/s | 26.5 steps/s
[Step= 250] | Loss=6.10517 | acc=0.1037 | tpr=0.8716 | fpr=0.9103 | 6853.3 samples/s | 26.8 steps/s
[Step= 300] | Loss=6.10681 | acc=0.1034 | tpr=0.8669 | fpr=0.9105 | 6696.2 samples/s | 26.2 steps/s
[Step= 350] | Loss=6.10726 | acc=0.1040 | tpr=0.8729 | fpr=0.9100 | 6920.9 samples/s | 27.0 steps/s
[Step= 400] | Loss=6.10313 | acc=0.1042 | tpr=0.8714 | fpr=0.9098 | 7068.1 samples/s | 27.6 steps/s
[Step= 450] | Loss=6.11101 | acc=0.1038 | tpr=0.8734 | fpr=0.9101 | 6628.8 samples/s | 25.9 steps/s
[Step= 500] | Loss=6.11193 | acc=0.1038 | tpr=0.8762 | fpr=0.9102 | 6954.2 samples/s | 27.2 steps/s
[Step= 550] | Loss=6.11185 | acc=0.1039 | tpr=0.8774 | fpr=0.9101 | 12057.7 samples/s | 47.1 steps/s
Avg test loss: 6.11273, Avg test acc: 0.10383, Avg tpr: 0.87718, Avg fpr: 0.91023, total FA: 126384

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11132 | acc=0.9823 | tpr=0.9381 | fpr=0.0169 | 3491.0 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.11461 | acc=0.9818 | tpr=0.9574 | fpr=0.0177 | 6943.3 samples/s | 27.1 steps/s
[Step= 150] | Loss=0.11707 | acc=0.9809 | tpr=0.9568 | fpr=0.0186 | 6810.4 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.11770 | acc=0.9809 | tpr=0.9563 | fpr=0.0187 | 6908.6 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.11623 | acc=0.9812 | tpr=0.9546 | fpr=0.0183 | 6982.1 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.11825 | acc=0.9808 | tpr=0.9542 | fpr=0.0187 | 7016.9 samples/s | 27.4 steps/s
[Step= 350] | Loss=0.11813 | acc=0.9807 | tpr=0.9537 | fpr=0.0188 | 6703.3 samples/s | 26.2 steps/s
[Step= 400] | Loss=0.11955 | acc=0.9806 | tpr=0.9508 | fpr=0.0188 | 7036.4 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.12190 | acc=0.9803 | tpr=0.9484 | fpr=0.0192 | 6626.8 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.12172 | acc=0.9803 | tpr=0.9511 | fpr=0.0192 | 6957.0 samples/s | 27.2 steps/s
[Step= 550] | Loss=0.12105 | acc=0.9805 | tpr=0.9507 | fpr=0.0190 | 12422.8 samples/s | 48.5 steps/s
Avg test loss: 0.12095, Avg test acc: 0.98047, Avg tpr: 0.95008, Avg fpr: 0.01898, total FA: 2635

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10485 | acc=0.9813 | tpr=0.9336 | fpr=0.0178 | 3506.8 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.10834 | acc=0.9810 | tpr=0.9552 | fpr=0.0185 | 6885.3 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.11054 | acc=0.9800 | tpr=0.9568 | fpr=0.0196 | 6895.7 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.11140 | acc=0.9801 | tpr=0.9585 | fpr=0.0195 | 6863.3 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.11042 | acc=0.9803 | tpr=0.9555 | fpr=0.0193 | 6870.1 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.11266 | acc=0.9799 | tpr=0.9564 | fpr=0.0197 | 6752.3 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.11229 | acc=0.9799 | tpr=0.9562 | fpr=0.0196 | 6986.4 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.11364 | acc=0.9799 | tpr=0.9551 | fpr=0.0197 | 6822.8 samples/s | 26.7 steps/s
[Step= 450] | Loss=0.11584 | acc=0.9795 | tpr=0.9533 | fpr=0.0200 | 6807.4 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.11566 | acc=0.9795 | tpr=0.9555 | fpr=0.0200 | 6752.8 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.11503 | acc=0.9797 | tpr=0.9554 | fpr=0.0199 | 12421.4 samples/s | 48.5 steps/s
Avg test loss: 0.11497, Avg test acc: 0.97969, Avg tpr: 0.95483, Avg fpr: 0.01986, total FA: 2757

server round 33/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=66001 Epoch=128.7] | Loss=0.00335 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.748 | L2-Norm(final)=12.275 | 3060.2 samples/s | 47.8 steps/s
[Step=66050 Epoch=128.8] | Loss=0.00946 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.758 | L2-Norm(final)=12.279 | 4206.1 samples/s | 65.7 steps/s
[Step=66100 Epoch=128.9] | Loss=0.00988 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.765 | L2-Norm(final)=12.287 | 4321.1 samples/s | 67.5 steps/s
[Step=66150 Epoch=129.0] | Loss=0.00984 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.771 | L2-Norm(final)=12.293 | 4292.2 samples/s | 67.1 steps/s
[Step=66200 Epoch=129.1] | Loss=0.00990 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.776 | L2-Norm(final)=12.300 | 4330.9 samples/s | 67.7 steps/s
[Step=66250 Epoch=129.2] | Loss=0.00946 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.781 | L2-Norm(final)=12.306 | 4377.8 samples/s | 68.4 steps/s
[Step=66300 Epoch=129.3] | Loss=0.00913 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.786 | L2-Norm(final)=12.313 | 4292.2 samples/s | 67.1 steps/s
[Step=66350 Epoch=129.4] | Loss=0.00878 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.791 | L2-Norm(final)=12.319 | 4319.9 samples/s | 67.5 steps/s
[Step=66400 Epoch=129.5] | Loss=0.00869 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.796 | L2-Norm(final)=12.326 | 4296.0 samples/s | 67.1 steps/s
[Step=66450 Epoch=129.6] | Loss=0.00875 | Reg=0.00096 | acc=0.9688 | L2-Norm=9.800 | L2-Norm(final)=12.333 | 4360.9 samples/s | 68.1 steps/s
[Step=66500 Epoch=129.7] | Loss=0.00891 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.805 | L2-Norm(final)=12.339 | 5565.9 samples/s | 87.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=66501 Epoch=129.7] | Loss=0.00611 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.849 | L2-Norm(final)=12.404 | 3084.1 samples/s | 48.2 steps/s
[Step=66550 Epoch=129.8] | Loss=0.00837 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.855 | L2-Norm(final)=12.410 | 3724.5 samples/s | 58.2 steps/s
[Step=66600 Epoch=129.9] | Loss=0.00930 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.864 | L2-Norm(final)=12.417 | 3880.5 samples/s | 60.6 steps/s
[Step=66650 Epoch=130.0] | Loss=0.00896 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.872 | L2-Norm(final)=12.423 | 3931.6 samples/s | 61.4 steps/s
[Step=66700 Epoch=130.1] | Loss=0.00959 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.879 | L2-Norm(final)=12.428 | 3946.6 samples/s | 61.7 steps/s
[Step=66750 Epoch=130.2] | Loss=0.00938 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.886 | L2-Norm(final)=12.433 | 3958.2 samples/s | 61.8 steps/s
[Step=66800 Epoch=130.3] | Loss=0.00924 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.892 | L2-Norm(final)=12.438 | 3931.2 samples/s | 61.4 steps/s
[Step=66850 Epoch=130.4] | Loss=0.00944 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.898 | L2-Norm(final)=12.443 | 3940.4 samples/s | 61.6 steps/s
[Step=66900 Epoch=130.5] | Loss=0.00931 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.904 | L2-Norm(final)=12.448 | 3930.2 samples/s | 61.4 steps/s
[Step=66950 Epoch=130.6] | Loss=0.00920 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.910 | L2-Norm(final)=12.452 | 3951.2 samples/s | 61.7 steps/s
[Step=67000 Epoch=130.7] | Loss=0.00919 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.915 | L2-Norm(final)=12.456 | 4791.7 samples/s | 74.9 steps/s
[Step=67050 Epoch=130.8] | Loss=0.00886 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.920 | L2-Norm(final)=12.461 | 1516.9 samples/s | 23.7 steps/s
[Step=67100 Epoch=130.9] | Loss=0.00880 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.925 | L2-Norm(final)=12.465 | 3940.9 samples/s | 61.6 steps/s
[Step=67150 Epoch=131.0] | Loss=0.00864 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.930 | L2-Norm(final)=12.470 | 3928.6 samples/s | 61.4 steps/s
[Step=67200 Epoch=131.1] | Loss=0.00857 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.935 | L2-Norm(final)=12.474 | 3965.0 samples/s | 62.0 steps/s
[Step=67250 Epoch=131.2] | Loss=0.00851 | Reg=0.00099 | acc=0.9531 | L2-Norm=9.939 | L2-Norm(final)=12.477 | 3925.2 samples/s | 61.3 steps/s
[Step=67300 Epoch=131.3] | Loss=0.00838 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.943 | L2-Norm(final)=12.481 | 3938.6 samples/s | 61.5 steps/s
[Step=67350 Epoch=131.4] | Loss=0.00832 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.947 | L2-Norm(final)=12.485 | 3920.0 samples/s | 61.3 steps/s
[Step=67400 Epoch=131.5] | Loss=0.00832 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.951 | L2-Norm(final)=12.489 | 3960.0 samples/s | 61.9 steps/s
[Step=67450 Epoch=131.6] | Loss=0.00828 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.955 | L2-Norm(final)=12.492 | 3968.6 samples/s | 62.0 steps/s
[Step=67500 Epoch=131.7] | Loss=0.00818 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.959 | L2-Norm(final)=12.496 | 4121.9 samples/s | 64.4 steps/s
[Step=67550 Epoch=131.7] | Loss=0.00799 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.962 | L2-Norm(final)=12.499 | 1514.1 samples/s | 23.7 steps/s
[Step=67600 Epoch=131.8] | Loss=0.00787 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.966 | L2-Norm(final)=12.502 | 3950.0 samples/s | 61.7 steps/s
[Step=67650 Epoch=131.9] | Loss=0.00774 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.969 | L2-Norm(final)=12.506 | 3830.7 samples/s | 59.9 steps/s
[Step=67700 Epoch=132.0] | Loss=0.00761 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.973 | L2-Norm(final)=12.509 | 3926.7 samples/s | 61.4 steps/s
[Step=67750 Epoch=132.1] | Loss=0.00759 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=12.512 | 3928.0 samples/s | 61.4 steps/s
[Step=67800 Epoch=132.2] | Loss=0.00756 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=12.516 | 3901.5 samples/s | 61.0 steps/s
[Step=67850 Epoch=132.3] | Loss=0.00751 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.982 | L2-Norm(final)=12.519 | 3980.4 samples/s | 62.2 steps/s
[Step=67900 Epoch=132.4] | Loss=0.00750 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.985 | L2-Norm(final)=12.522 | 3931.8 samples/s | 61.4 steps/s
[Step=67950 Epoch=132.5] | Loss=0.00743 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.988 | L2-Norm(final)=12.525 | 3922.2 samples/s | 61.3 steps/s
[Step=68000 Epoch=132.6] | Loss=0.00736 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.992 | L2-Norm(final)=12.529 | 3899.9 samples/s | 60.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step68000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=66001 Epoch=129.0] | Loss=0.00451 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.748 | L2-Norm(final)=12.481 | 3238.4 samples/s | 50.6 steps/s
[Step=66050 Epoch=129.1] | Loss=0.00928 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.756 | L2-Norm(final)=12.485 | 4286.4 samples/s | 67.0 steps/s
[Step=66100 Epoch=129.2] | Loss=0.00975 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.761 | L2-Norm(final)=12.491 | 4369.8 samples/s | 68.3 steps/s
[Step=66150 Epoch=129.3] | Loss=0.01003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.766 | L2-Norm(final)=12.497 | 4453.3 samples/s | 69.6 steps/s
[Step=66200 Epoch=129.4] | Loss=0.00975 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.771 | L2-Norm(final)=12.503 | 4310.1 samples/s | 67.3 steps/s
[Step=66250 Epoch=129.5] | Loss=0.00934 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.776 | L2-Norm(final)=12.510 | 4430.7 samples/s | 69.2 steps/s
[Step=66300 Epoch=129.6] | Loss=0.00915 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.780 | L2-Norm(final)=12.517 | 4419.3 samples/s | 69.1 steps/s
[Step=66350 Epoch=129.7] | Loss=0.00902 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.785 | L2-Norm(final)=12.523 | 4426.6 samples/s | 69.2 steps/s
[Step=66400 Epoch=129.8] | Loss=0.00878 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.790 | L2-Norm(final)=12.530 | 4443.7 samples/s | 69.4 steps/s
[Step=66450 Epoch=129.9] | Loss=0.00876 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.795 | L2-Norm(final)=12.537 | 4291.2 samples/s | 67.1 steps/s
[Step=66500 Epoch=130.0] | Loss=0.00866 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.799 | L2-Norm(final)=12.543 | 5665.2 samples/s | 88.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=66501 Epoch=130.0] | Loss=0.00092 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.841 | L2-Norm(final)=12.603 | 3326.3 samples/s | 52.0 steps/s
[Step=66550 Epoch=130.1] | Loss=0.01077 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.847 | L2-Norm(final)=12.609 | 3669.0 samples/s | 57.3 steps/s
[Step=66600 Epoch=130.2] | Loss=0.00958 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.855 | L2-Norm(final)=12.613 | 3915.2 samples/s | 61.2 steps/s
[Step=66650 Epoch=130.3] | Loss=0.00882 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.862 | L2-Norm(final)=12.619 | 3922.4 samples/s | 61.3 steps/s
[Step=66700 Epoch=130.4] | Loss=0.00914 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.869 | L2-Norm(final)=12.625 | 3963.4 samples/s | 61.9 steps/s
[Step=66750 Epoch=130.5] | Loss=0.00933 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=12.630 | 3947.9 samples/s | 61.7 steps/s
[Step=66800 Epoch=130.6] | Loss=0.00910 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.881 | L2-Norm(final)=12.634 | 3964.4 samples/s | 61.9 steps/s
[Step=66850 Epoch=130.7] | Loss=0.00882 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.886 | L2-Norm(final)=12.639 | 3948.6 samples/s | 61.7 steps/s
[Step=66900 Epoch=130.8] | Loss=0.00897 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.891 | L2-Norm(final)=12.644 | 4008.6 samples/s | 62.6 steps/s
[Step=66950 Epoch=130.9] | Loss=0.00882 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.896 | L2-Norm(final)=12.648 | 3913.5 samples/s | 61.1 steps/s
[Step=67000 Epoch=131.0] | Loss=0.00875 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=12.652 | 4901.7 samples/s | 76.6 steps/s
[Step=67050 Epoch=131.1] | Loss=0.00844 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.906 | L2-Norm(final)=12.656 | 1521.0 samples/s | 23.8 steps/s
[Step=67100 Epoch=131.2] | Loss=0.00830 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.911 | L2-Norm(final)=12.661 | 3947.5 samples/s | 61.7 steps/s
[Step=67150 Epoch=131.3] | Loss=0.00818 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.915 | L2-Norm(final)=12.665 | 3937.5 samples/s | 61.5 steps/s
[Step=67200 Epoch=131.4] | Loss=0.00796 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.919 | L2-Norm(final)=12.669 | 3946.3 samples/s | 61.7 steps/s
[Step=67250 Epoch=131.5] | Loss=0.00778 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.924 | L2-Norm(final)=12.672 | 3993.1 samples/s | 62.4 steps/s
[Step=67300 Epoch=131.6] | Loss=0.00763 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.928 | L2-Norm(final)=12.676 | 3918.3 samples/s | 61.2 steps/s
[Step=67350 Epoch=131.7] | Loss=0.00767 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.932 | L2-Norm(final)=12.680 | 3952.8 samples/s | 61.8 steps/s
[Step=67400 Epoch=131.8] | Loss=0.00761 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.935 | L2-Norm(final)=12.684 | 3957.4 samples/s | 61.8 steps/s
[Step=67450 Epoch=131.9] | Loss=0.00762 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.939 | L2-Norm(final)=12.687 | 3983.3 samples/s | 62.2 steps/s
[Step=67500 Epoch=132.0] | Loss=0.00760 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.943 | L2-Norm(final)=12.691 | 4306.2 samples/s | 67.3 steps/s
[Step=67550 Epoch=132.1] | Loss=0.00747 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.946 | L2-Norm(final)=12.694 | 1588.7 samples/s | 24.8 steps/s
[Step=67600 Epoch=132.2] | Loss=0.00732 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.950 | L2-Norm(final)=12.698 | 4003.8 samples/s | 62.6 steps/s
[Step=67650 Epoch=132.3] | Loss=0.00725 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.953 | L2-Norm(final)=12.702 | 3939.7 samples/s | 61.6 steps/s
[Step=67700 Epoch=132.4] | Loss=0.00723 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.957 | L2-Norm(final)=12.705 | 3955.6 samples/s | 61.8 steps/s
[Step=67750 Epoch=132.4] | Loss=0.00717 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.960 | L2-Norm(final)=12.708 | 3934.8 samples/s | 61.5 steps/s
[Step=67800 Epoch=132.5] | Loss=0.00713 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.964 | L2-Norm(final)=12.712 | 3941.9 samples/s | 61.6 steps/s
[Step=67850 Epoch=132.6] | Loss=0.00707 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.967 | L2-Norm(final)=12.715 | 3919.8 samples/s | 61.2 steps/s
[Step=67900 Epoch=132.7] | Loss=0.00705 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.970 | L2-Norm(final)=12.718 | 3979.0 samples/s | 62.2 steps/s
[Step=67950 Epoch=132.8] | Loss=0.00699 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.973 | L2-Norm(final)=12.721 | 4002.3 samples/s | 62.5 steps/s
[Step=68000 Epoch=132.9] | Loss=0.00695 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=12.725 | 3948.3 samples/s | 61.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step68000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=66001 Epoch=252.9] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.748 | L2-Norm(final)=9.159 | 3358.8 samples/s | 52.5 steps/s
[Step=66050 Epoch=253.1] | Loss=0.00009 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.749 | L2-Norm(final)=9.169 | 3650.1 samples/s | 57.0 steps/s
[Step=66100 Epoch=253.3] | Loss=0.00008 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=9.178 | 4118.5 samples/s | 64.4 steps/s
[Step=66150 Epoch=253.5] | Loss=0.00007 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.753 | L2-Norm(final)=9.186 | 4161.0 samples/s | 65.0 steps/s
[Step=66200 Epoch=253.7] | Loss=0.00006 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.754 | L2-Norm(final)=9.193 | 4083.6 samples/s | 63.8 steps/s
[Step=66250 Epoch=253.8] | Loss=0.00005 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.753 | L2-Norm(final)=9.199 | 5363.9 samples/s | 83.8 steps/s
[Step=66300 Epoch=254.0] | Loss=0.00005 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.752 | L2-Norm(final)=9.204 | 1518.1 samples/s | 23.7 steps/s
[Step=66350 Epoch=254.2] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=9.209 | 4149.9 samples/s | 64.8 steps/s
[Step=66400 Epoch=254.4] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.748 | L2-Norm(final)=9.213 | 4259.0 samples/s | 66.5 steps/s
[Step=66450 Epoch=254.6] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.746 | L2-Norm(final)=9.217 | 4063.2 samples/s | 63.5 steps/s
[Step=66500 Epoch=254.8] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.743 | L2-Norm(final)=9.221 | 4598.0 samples/s | 71.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=66501 Epoch=254.8] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.717 | L2-Norm(final)=9.260 | 3132.8 samples/s | 49.0 steps/s
[Step=66550 Epoch=255.0] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.704 | L2-Norm(final)=9.264 | 3627.3 samples/s | 56.7 steps/s
[Step=66600 Epoch=255.2] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.688 | L2-Norm(final)=9.267 | 3703.3 samples/s | 57.9 steps/s
[Step=66650 Epoch=255.4] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.669 | L2-Norm(final)=9.269 | 3727.4 samples/s | 58.2 steps/s
[Step=66700 Epoch=255.6] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.650 | L2-Norm(final)=9.271 | 3726.4 samples/s | 58.2 steps/s
[Step=66750 Epoch=255.8] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.631 | L2-Norm(final)=9.272 | 4748.4 samples/s | 74.2 steps/s
[Step=66800 Epoch=256.0] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.612 | L2-Norm(final)=9.274 | 1482.8 samples/s | 23.2 steps/s
[Step=66850 Epoch=256.1] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=9.276 | 3694.0 samples/s | 57.7 steps/s
[Step=66900 Epoch=256.3] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.574 | L2-Norm(final)=9.277 | 3714.8 samples/s | 58.0 steps/s
[Step=66950 Epoch=256.5] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.555 | L2-Norm(final)=9.279 | 3708.7 samples/s | 57.9 steps/s
[Step=67000 Epoch=256.7] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.535 | L2-Norm(final)=9.280 | 4074.9 samples/s | 63.7 steps/s
[Step=67050 Epoch=256.9] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.515 | L2-Norm(final)=9.281 | 1529.3 samples/s | 23.9 steps/s
[Step=67100 Epoch=257.1] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.495 | L2-Norm(final)=9.282 | 3693.4 samples/s | 57.7 steps/s
[Step=67150 Epoch=257.3] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.474 | L2-Norm(final)=9.283 | 3708.8 samples/s | 57.9 steps/s
[Step=67200 Epoch=257.5] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.453 | L2-Norm(final)=9.284 | 3691.7 samples/s | 57.7 steps/s
[Step=67250 Epoch=257.7] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.432 | L2-Norm(final)=9.285 | 3674.7 samples/s | 57.4 steps/s
[Step=67300 Epoch=257.9] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.411 | L2-Norm(final)=9.286 | 1557.5 samples/s | 24.3 steps/s
[Step=67350 Epoch=258.1] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.390 | L2-Norm(final)=9.287 | 3764.9 samples/s | 58.8 steps/s
[Step=67400 Epoch=258.3] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.368 | L2-Norm(final)=9.288 | 3738.5 samples/s | 58.4 steps/s
[Step=67450 Epoch=258.4] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.347 | L2-Norm(final)=9.289 | 3759.9 samples/s | 58.7 steps/s
[Step=67500 Epoch=258.6] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.325 | L2-Norm(final)=9.290 | 3751.4 samples/s | 58.6 steps/s
[Step=67550 Epoch=258.8] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.303 | L2-Norm(final)=9.291 | 1551.7 samples/s | 24.2 steps/s
[Step=67600 Epoch=259.0] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.280 | L2-Norm(final)=9.292 | 3686.1 samples/s | 57.6 steps/s
[Step=67650 Epoch=259.2] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.258 | L2-Norm(final)=9.293 | 3764.4 samples/s | 58.8 steps/s
[Step=67700 Epoch=259.4] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.235 | L2-Norm(final)=9.294 | 3632.0 samples/s | 56.7 steps/s
[Step=67750 Epoch=259.6] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.213 | L2-Norm(final)=9.295 | 3686.5 samples/s | 57.6 steps/s
[Step=67800 Epoch=259.8] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.190 | L2-Norm(final)=9.296 | 5088.1 samples/s | 79.5 steps/s
[Step=67850 Epoch=260.0] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.167 | L2-Norm(final)=9.297 | 1398.4 samples/s | 21.9 steps/s
[Step=67900 Epoch=260.2] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.143 | L2-Norm(final)=9.298 | 3695.4 samples/s | 57.7 steps/s
[Step=67950 Epoch=260.4] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.120 | L2-Norm(final)=9.300 | 3714.0 samples/s | 58.0 steps/s
[Step=68000 Epoch=260.6] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.096 | L2-Norm(final)=9.301 | 3704.5 samples/s | 57.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step68000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=66001 Epoch=254.1] | Loss=0.00005 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.748 | L2-Norm(final)=9.639 | 3231.4 samples/s | 50.5 steps/s
[Step=66050 Epoch=254.3] | Loss=0.00009 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.746 | L2-Norm(final)=9.647 | 3818.5 samples/s | 59.7 steps/s
[Step=66100 Epoch=254.4] | Loss=0.00008 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.752 | L2-Norm(final)=9.655 | 4057.9 samples/s | 63.4 steps/s
[Step=66150 Epoch=254.6] | Loss=0.00006 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.753 | L2-Norm(final)=9.662 | 4189.1 samples/s | 65.5 steps/s
[Step=66200 Epoch=254.8] | Loss=0.00005 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.752 | L2-Norm(final)=9.667 | 4084.3 samples/s | 63.8 steps/s
[Step=66250 Epoch=255.0] | Loss=0.00005 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.752 | L2-Norm(final)=9.673 | 5409.5 samples/s | 84.5 steps/s
[Step=66300 Epoch=255.2] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=9.679 | 1485.7 samples/s | 23.2 steps/s
[Step=66350 Epoch=255.4] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.748 | L2-Norm(final)=9.683 | 4050.8 samples/s | 63.3 steps/s
[Step=66400 Epoch=255.6] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.746 | L2-Norm(final)=9.687 | 4180.8 samples/s | 65.3 steps/s
[Step=66450 Epoch=255.8] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.743 | L2-Norm(final)=9.690 | 4092.4 samples/s | 63.9 steps/s
[Step=66500 Epoch=256.0] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.740 | L2-Norm(final)=9.693 | 4757.3 samples/s | 74.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=66501 Epoch=256.0] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.708 | L2-Norm(final)=9.724 | 3113.3 samples/s | 48.6 steps/s
[Step=66550 Epoch=256.2] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.698 | L2-Norm(final)=9.726 | 3695.0 samples/s | 57.7 steps/s
[Step=66600 Epoch=256.4] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.686 | L2-Norm(final)=9.728 | 3731.0 samples/s | 58.3 steps/s
[Step=66650 Epoch=256.6] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.673 | L2-Norm(final)=9.730 | 3722.2 samples/s | 58.2 steps/s
[Step=66700 Epoch=256.8] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.660 | L2-Norm(final)=9.732 | 3746.7 samples/s | 58.5 steps/s
[Step=66750 Epoch=256.9] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.646 | L2-Norm(final)=9.734 | 4817.9 samples/s | 75.3 steps/s
[Step=66800 Epoch=257.1] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.633 | L2-Norm(final)=9.735 | 1453.2 samples/s | 22.7 steps/s
[Step=66850 Epoch=257.3] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.619 | L2-Norm(final)=9.736 | 3811.4 samples/s | 59.6 steps/s
[Step=66900 Epoch=257.5] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.605 | L2-Norm(final)=9.738 | 3699.3 samples/s | 57.8 steps/s
[Step=66950 Epoch=257.7] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.591 | L2-Norm(final)=9.739 | 3771.5 samples/s | 58.9 steps/s
[Step=67000 Epoch=257.9] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=9.740 | 4202.5 samples/s | 65.7 steps/s
[Step=67050 Epoch=258.1] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.562 | L2-Norm(final)=9.741 | 1567.5 samples/s | 24.5 steps/s
[Step=67100 Epoch=258.3] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.547 | L2-Norm(final)=9.743 | 3713.4 samples/s | 58.0 steps/s
[Step=67150 Epoch=258.5] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.533 | L2-Norm(final)=9.744 | 3753.8 samples/s | 58.7 steps/s
[Step=67200 Epoch=258.7] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.518 | L2-Norm(final)=9.745 | 3710.9 samples/s | 58.0 steps/s
[Step=67250 Epoch=258.9] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.503 | L2-Norm(final)=9.746 | 3842.6 samples/s | 60.0 steps/s
[Step=67300 Epoch=259.1] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.488 | L2-Norm(final)=9.747 | 1527.9 samples/s | 23.9 steps/s
[Step=67350 Epoch=259.3] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.473 | L2-Norm(final)=9.749 | 3793.1 samples/s | 59.3 steps/s
[Step=67400 Epoch=259.4] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.458 | L2-Norm(final)=9.750 | 3753.7 samples/s | 58.7 steps/s
[Step=67450 Epoch=259.6] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.442 | L2-Norm(final)=9.751 | 3717.4 samples/s | 58.1 steps/s
[Step=67500 Epoch=259.8] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.427 | L2-Norm(final)=9.752 | 3717.9 samples/s | 58.1 steps/s
[Step=67550 Epoch=260.0] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.411 | L2-Norm(final)=9.754 | 1647.1 samples/s | 25.7 steps/s
[Step=67600 Epoch=260.2] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.396 | L2-Norm(final)=9.755 | 3699.9 samples/s | 57.8 steps/s
[Step=67650 Epoch=260.4] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.380 | L2-Norm(final)=9.757 | 3767.2 samples/s | 58.9 steps/s
[Step=67700 Epoch=260.6] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.364 | L2-Norm(final)=9.758 | 3751.0 samples/s | 58.6 steps/s
[Step=67750 Epoch=260.8] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.348 | L2-Norm(final)=9.759 | 3698.0 samples/s | 57.8 steps/s
[Step=67800 Epoch=261.0] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.332 | L2-Norm(final)=9.761 | 5535.3 samples/s | 86.5 steps/s
[Step=67850 Epoch=261.2] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.316 | L2-Norm(final)=9.762 | 1414.5 samples/s | 22.1 steps/s
[Step=67900 Epoch=261.4] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=9.764 | 3734.0 samples/s | 58.3 steps/s
[Step=67950 Epoch=261.6] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.283 | L2-Norm(final)=9.766 | 3694.0 samples/s | 57.7 steps/s
[Step=68000 Epoch=261.8] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.266 | L2-Norm(final)=9.767 | 3801.2 samples/s | 59.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step68000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06333 | acc=0.9694 | tpr=0.9709 | fpr=0.0339 | 3509.0 samples/s | 13.7 steps/s
Avg test loss: 0.07029, Avg test acc: 0.96654, Avg tpr: 0.96847, Avg fpr: 0.03769, total FA: 294

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06000 | acc=0.9702 | tpr=0.9781 | fpr=0.0471 | 3533.6 samples/s | 13.8 steps/s
Avg test loss: 0.06648, Avg test acc: 0.96839, Avg tpr: 0.97774, Avg fpr: 0.05217, total FA: 407

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.34430 | acc=0.3107 | tpr=0.0120 | fpr=0.0406 | 3557.6 samples/s | 13.9 steps/s
Avg test loss: 5.35632, Avg test acc: 0.30772, Avg tpr: 0.01160, Avg fpr: 0.04102, total FA: 320

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.72120 | acc=0.3133 | tpr=0.0191 | fpr=0.0478 | 3519.1 samples/s | 13.7 steps/s
Avg test loss: 4.73082, Avg test acc: 0.31040, Avg tpr: 0.01888, Avg fpr: 0.04846, total FA: 378

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.92200 | acc=0.1295 | tpr=0.8319 | fpr=0.8831 | 3510.5 samples/s | 13.7 steps/s
[Step= 100] | Loss=4.90515 | acc=0.1305 | tpr=0.8443 | fpr=0.8828 | 6822.7 samples/s | 26.7 steps/s
[Step= 150] | Loss=4.92148 | acc=0.1291 | tpr=0.8415 | fpr=0.8840 | 6795.8 samples/s | 26.5 steps/s
[Step= 200] | Loss=4.90342 | acc=0.1297 | tpr=0.8328 | fpr=0.8831 | 6802.3 samples/s | 26.6 steps/s
[Step= 250] | Loss=4.90456 | acc=0.1299 | tpr=0.8245 | fpr=0.8827 | 6721.0 samples/s | 26.3 steps/s
[Step= 300] | Loss=4.90652 | acc=0.1296 | tpr=0.8218 | fpr=0.8830 | 6845.1 samples/s | 26.7 steps/s
[Step= 350] | Loss=4.90317 | acc=0.1303 | tpr=0.8309 | fpr=0.8824 | 6879.8 samples/s | 26.9 steps/s
[Step= 400] | Loss=4.90028 | acc=0.1304 | tpr=0.8271 | fpr=0.8823 | 6701.4 samples/s | 26.2 steps/s
[Step= 450] | Loss=4.90741 | acc=0.1299 | tpr=0.8301 | fpr=0.8828 | 7191.0 samples/s | 28.1 steps/s
[Step= 500] | Loss=4.90941 | acc=0.1298 | tpr=0.8313 | fpr=0.8829 | 6352.1 samples/s | 24.8 steps/s
[Step= 550] | Loss=4.91027 | acc=0.1298 | tpr=0.8305 | fpr=0.8829 | 12425.4 samples/s | 48.5 steps/s
Avg test loss: 4.91126, Avg test acc: 0.12970, Avg tpr: 0.82964, Avg fpr: 0.88302, total FA: 122606

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.82921 | acc=0.1066 | tpr=0.8761 | fpr=0.9072 | 3527.4 samples/s | 13.8 steps/s
[Step= 100] | Loss=5.80115 | acc=0.1076 | tpr=0.8785 | fpr=0.9068 | 6689.2 samples/s | 26.1 steps/s
[Step= 150] | Loss=5.81556 | acc=0.1063 | tpr=0.8718 | fpr=0.9078 | 6685.5 samples/s | 26.1 steps/s
[Step= 200] | Loss=5.79849 | acc=0.1062 | tpr=0.8623 | fpr=0.9076 | 6963.1 samples/s | 27.2 steps/s
[Step= 250] | Loss=5.79694 | acc=0.1062 | tpr=0.8585 | fpr=0.9075 | 7002.7 samples/s | 27.4 steps/s
[Step= 300] | Loss=5.79979 | acc=0.1058 | tpr=0.8538 | fpr=0.9079 | 6742.8 samples/s | 26.3 steps/s
[Step= 350] | Loss=5.79844 | acc=0.1062 | tpr=0.8579 | fpr=0.9074 | 7121.1 samples/s | 27.8 steps/s
[Step= 400] | Loss=5.79555 | acc=0.1061 | tpr=0.8523 | fpr=0.9074 | 6475.1 samples/s | 25.3 steps/s
[Step= 450] | Loss=5.80222 | acc=0.1058 | tpr=0.8549 | fpr=0.9078 | 6667.1 samples/s | 26.0 steps/s
[Step= 500] | Loss=5.80257 | acc=0.1057 | tpr=0.8564 | fpr=0.9078 | 6574.7 samples/s | 25.7 steps/s
[Step= 550] | Loss=5.80261 | acc=0.1060 | tpr=0.8571 | fpr=0.9076 | 12719.9 samples/s | 49.7 steps/s
Avg test loss: 5.80359, Avg test acc: 0.10591, Avg tpr: 0.85697, Avg fpr: 0.90774, total FA: 126038

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10131 | acc=0.9835 | tpr=0.9336 | fpr=0.0156 | 3525.2 samples/s | 13.8 steps/s
[Step= 100] | Loss=0.10498 | acc=0.9831 | tpr=0.9488 | fpr=0.0163 | 6753.8 samples/s | 26.4 steps/s
[Step= 150] | Loss=0.10702 | acc=0.9824 | tpr=0.9510 | fpr=0.0170 | 7062.5 samples/s | 27.6 steps/s
[Step= 200] | Loss=0.10806 | acc=0.9823 | tpr=0.9497 | fpr=0.0171 | 6789.3 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.10678 | acc=0.9825 | tpr=0.9459 | fpr=0.0168 | 6861.6 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.10868 | acc=0.9822 | tpr=0.9418 | fpr=0.0171 | 6748.2 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.10866 | acc=0.9821 | tpr=0.9430 | fpr=0.0172 | 6961.2 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.11010 | acc=0.9819 | tpr=0.9398 | fpr=0.0173 | 6829.8 samples/s | 26.7 steps/s
[Step= 450] | Loss=0.11230 | acc=0.9815 | tpr=0.9387 | fpr=0.0177 | 6844.3 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.11206 | acc=0.9816 | tpr=0.9427 | fpr=0.0177 | 6711.3 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.11143 | acc=0.9818 | tpr=0.9423 | fpr=0.0175 | 12523.6 samples/s | 48.9 steps/s
Avg test loss: 0.11133, Avg test acc: 0.98175, Avg tpr: 0.94176, Avg fpr: 0.01752, total FA: 2433

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10808 | acc=0.9812 | tpr=0.9336 | fpr=0.0180 | 3517.4 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.11218 | acc=0.9805 | tpr=0.9552 | fpr=0.0190 | 6916.6 samples/s | 27.0 steps/s
[Step= 150] | Loss=0.11450 | acc=0.9795 | tpr=0.9582 | fpr=0.0202 | 6756.6 samples/s | 26.4 steps/s
[Step= 200] | Loss=0.11553 | acc=0.9794 | tpr=0.9574 | fpr=0.0202 | 6869.8 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.11453 | acc=0.9796 | tpr=0.9546 | fpr=0.0199 | 6799.0 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.11670 | acc=0.9792 | tpr=0.9542 | fpr=0.0204 | 6931.0 samples/s | 27.1 steps/s
[Step= 350] | Loss=0.11645 | acc=0.9792 | tpr=0.9543 | fpr=0.0204 | 6824.9 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.11778 | acc=0.9791 | tpr=0.9535 | fpr=0.0205 | 6869.7 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.12012 | acc=0.9787 | tpr=0.9523 | fpr=0.0208 | 6704.6 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.11993 | acc=0.9787 | tpr=0.9546 | fpr=0.0209 | 6889.1 samples/s | 26.9 steps/s
[Step= 550] | Loss=0.11917 | acc=0.9788 | tpr=0.9546 | fpr=0.0207 | 12531.6 samples/s | 49.0 steps/s
Avg test loss: 0.11910, Avg test acc: 0.97886, Avg tpr: 0.95404, Avg fpr: 0.02069, total FA: 2873

server round 34/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=68001 Epoch=132.6] | Loss=0.05151 | Reg=0.00086 | acc=0.9531 | L2-Norm=9.254 | L2-Norm(final)=12.626 | 3165.5 samples/s | 49.5 steps/s
[Step=68050 Epoch=132.7] | Loss=0.01417 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.267 | L2-Norm(final)=12.629 | 3993.0 samples/s | 62.4 steps/s
[Step=68100 Epoch=132.8] | Loss=0.01346 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.275 | L2-Norm(final)=12.637 | 4386.1 samples/s | 68.5 steps/s
[Step=68150 Epoch=132.9] | Loss=0.01364 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.282 | L2-Norm(final)=12.646 | 4438.9 samples/s | 69.4 steps/s
[Step=68200 Epoch=133.0] | Loss=0.01280 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.290 | L2-Norm(final)=12.654 | 4347.4 samples/s | 67.9 steps/s
[Step=68250 Epoch=133.1] | Loss=0.01268 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.296 | L2-Norm(final)=12.663 | 4373.4 samples/s | 68.3 steps/s
[Step=68300 Epoch=133.2] | Loss=0.01218 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.302 | L2-Norm(final)=12.671 | 4444.8 samples/s | 69.5 steps/s
[Step=68350 Epoch=133.3] | Loss=0.01193 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.308 | L2-Norm(final)=12.679 | 4416.5 samples/s | 69.0 steps/s
[Step=68400 Epoch=133.4] | Loss=0.01160 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.314 | L2-Norm(final)=12.687 | 4361.7 samples/s | 68.2 steps/s
[Step=68450 Epoch=133.5] | Loss=0.01106 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.320 | L2-Norm(final)=12.694 | 4352.7 samples/s | 68.0 steps/s
[Step=68500 Epoch=133.6] | Loss=0.01095 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.325 | L2-Norm(final)=12.702 | 5398.6 samples/s | 84.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=68501 Epoch=133.6] | Loss=0.00463 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.377 | L2-Norm(final)=12.777 | 3086.3 samples/s | 48.2 steps/s
[Step=68550 Epoch=133.7] | Loss=0.00982 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.386 | L2-Norm(final)=12.783 | 3926.5 samples/s | 61.4 steps/s
[Step=68600 Epoch=133.8] | Loss=0.01096 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.397 | L2-Norm(final)=12.789 | 3922.8 samples/s | 61.3 steps/s
[Step=68650 Epoch=133.9] | Loss=0.01126 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.406 | L2-Norm(final)=12.794 | 3901.8 samples/s | 61.0 steps/s
[Step=68700 Epoch=134.0] | Loss=0.01077 | Reg=0.00089 | acc=0.9688 | L2-Norm=9.414 | L2-Norm(final)=12.799 | 3923.1 samples/s | 61.3 steps/s
[Step=68750 Epoch=134.1] | Loss=0.01087 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.422 | L2-Norm(final)=12.804 | 3958.0 samples/s | 61.8 steps/s
[Step=68800 Epoch=134.2] | Loss=0.01133 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.429 | L2-Norm(final)=12.809 | 3954.7 samples/s | 61.8 steps/s
[Step=68850 Epoch=134.3] | Loss=0.01099 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.436 | L2-Norm(final)=12.813 | 3923.5 samples/s | 61.3 steps/s
[Step=68900 Epoch=134.4] | Loss=0.01062 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.443 | L2-Norm(final)=12.818 | 3953.4 samples/s | 61.8 steps/s
[Step=68950 Epoch=134.5] | Loss=0.01041 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.450 | L2-Norm(final)=12.823 | 4013.6 samples/s | 62.7 steps/s
[Step=69000 Epoch=134.6] | Loss=0.01023 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.456 | L2-Norm(final)=12.828 | 4806.8 samples/s | 75.1 steps/s
[Step=69050 Epoch=134.7] | Loss=0.00984 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.462 | L2-Norm(final)=12.833 | 1437.3 samples/s | 22.5 steps/s
[Step=69100 Epoch=134.8] | Loss=0.00958 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.468 | L2-Norm(final)=12.838 | 3952.1 samples/s | 61.8 steps/s
[Step=69150 Epoch=134.9] | Loss=0.00957 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.474 | L2-Norm(final)=12.843 | 3930.2 samples/s | 61.4 steps/s
[Step=69200 Epoch=135.0] | Loss=0.00947 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.479 | L2-Norm(final)=12.847 | 3940.3 samples/s | 61.6 steps/s
[Step=69250 Epoch=135.1] | Loss=0.00920 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.484 | L2-Norm(final)=12.851 | 3959.0 samples/s | 61.9 steps/s
[Step=69300 Epoch=135.2] | Loss=0.00918 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.489 | L2-Norm(final)=12.856 | 3954.5 samples/s | 61.8 steps/s
[Step=69350 Epoch=135.3] | Loss=0.00908 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.493 | L2-Norm(final)=12.860 | 3947.3 samples/s | 61.7 steps/s
[Step=69400 Epoch=135.4] | Loss=0.00902 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.498 | L2-Norm(final)=12.864 | 3960.4 samples/s | 61.9 steps/s
[Step=69450 Epoch=135.5] | Loss=0.00891 | Reg=0.00090 | acc=0.9688 | L2-Norm=9.502 | L2-Norm(final)=12.868 | 3957.2 samples/s | 61.8 steps/s
[Step=69500 Epoch=135.6] | Loss=0.00878 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.506 | L2-Norm(final)=12.872 | 4153.3 samples/s | 64.9 steps/s
[Step=69550 Epoch=135.6] | Loss=0.00867 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.510 | L2-Norm(final)=12.876 | 1509.2 samples/s | 23.6 steps/s
[Step=69600 Epoch=135.7] | Loss=0.00855 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.514 | L2-Norm(final)=12.880 | 3975.3 samples/s | 62.1 steps/s
[Step=69650 Epoch=135.8] | Loss=0.00840 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.518 | L2-Norm(final)=12.884 | 3908.7 samples/s | 61.1 steps/s
[Step=69700 Epoch=135.9] | Loss=0.00826 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.522 | L2-Norm(final)=12.888 | 3918.6 samples/s | 61.2 steps/s
[Step=69750 Epoch=136.0] | Loss=0.00816 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.526 | L2-Norm(final)=12.892 | 3928.6 samples/s | 61.4 steps/s
[Step=69800 Epoch=136.1] | Loss=0.00809 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.530 | L2-Norm(final)=12.896 | 3921.2 samples/s | 61.3 steps/s
[Step=69850 Epoch=136.2] | Loss=0.00807 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.534 | L2-Norm(final)=12.899 | 3967.5 samples/s | 62.0 steps/s
[Step=69900 Epoch=136.3] | Loss=0.00806 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.537 | L2-Norm(final)=12.903 | 3941.1 samples/s | 61.6 steps/s
[Step=69950 Epoch=136.4] | Loss=0.00797 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.541 | L2-Norm(final)=12.907 | 3947.7 samples/s | 61.7 steps/s
[Step=70000 Epoch=136.5] | Loss=0.00801 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.545 | L2-Norm(final)=12.910 | 3964.8 samples/s | 62.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step70000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=68001 Epoch=132.9] | Loss=0.01193 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.254 | L2-Norm(final)=12.820 | 3596.9 samples/s | 56.2 steps/s
[Step=68050 Epoch=133.0] | Loss=0.01244 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.264 | L2-Norm(final)=12.827 | 3820.1 samples/s | 59.7 steps/s
[Step=68100 Epoch=133.1] | Loss=0.01108 | Reg=0.00086 | acc=0.9531 | L2-Norm=9.271 | L2-Norm(final)=12.835 | 4366.7 samples/s | 68.2 steps/s
[Step=68150 Epoch=133.2] | Loss=0.01157 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.278 | L2-Norm(final)=12.844 | 4356.6 samples/s | 68.1 steps/s
[Step=68200 Epoch=133.3] | Loss=0.01143 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.285 | L2-Norm(final)=12.853 | 4448.6 samples/s | 69.5 steps/s
[Step=68250 Epoch=133.4] | Loss=0.01153 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.291 | L2-Norm(final)=12.861 | 4290.7 samples/s | 67.0 steps/s
[Step=68300 Epoch=133.5] | Loss=0.01159 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.297 | L2-Norm(final)=12.869 | 4322.1 samples/s | 67.5 steps/s
[Step=68350 Epoch=133.6] | Loss=0.01110 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.302 | L2-Norm(final)=12.876 | 4369.0 samples/s | 68.3 steps/s
[Step=68400 Epoch=133.7] | Loss=0.01089 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.308 | L2-Norm(final)=12.884 | 4364.6 samples/s | 68.2 steps/s
[Step=68450 Epoch=133.8] | Loss=0.01084 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.313 | L2-Norm(final)=12.892 | 4353.1 samples/s | 68.0 steps/s
[Step=68500 Epoch=133.9] | Loss=0.01079 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.318 | L2-Norm(final)=12.899 | 5672.0 samples/s | 88.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=68501 Epoch=133.9] | Loss=0.00827 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.369 | L2-Norm(final)=12.970 | 3109.6 samples/s | 48.6 steps/s
[Step=68550 Epoch=134.0] | Loss=0.01015 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.377 | L2-Norm(final)=12.976 | 3955.2 samples/s | 61.8 steps/s
[Step=68600 Epoch=134.1] | Loss=0.01019 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.387 | L2-Norm(final)=12.982 | 3953.4 samples/s | 61.8 steps/s
[Step=68650 Epoch=134.2] | Loss=0.01030 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.395 | L2-Norm(final)=12.988 | 3881.5 samples/s | 60.6 steps/s
[Step=68700 Epoch=134.3] | Loss=0.01002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.403 | L2-Norm(final)=12.994 | 3930.5 samples/s | 61.4 steps/s
[Step=68750 Epoch=134.4] | Loss=0.01015 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.411 | L2-Norm(final)=13.001 | 3922.1 samples/s | 61.3 steps/s
[Step=68800 Epoch=134.5] | Loss=0.00983 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.419 | L2-Norm(final)=13.006 | 3951.6 samples/s | 61.7 steps/s
[Step=68850 Epoch=134.6] | Loss=0.01036 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.425 | L2-Norm(final)=13.012 | 3922.7 samples/s | 61.3 steps/s
[Step=68900 Epoch=134.7] | Loss=0.01027 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.432 | L2-Norm(final)=13.016 | 3924.0 samples/s | 61.3 steps/s
[Step=68950 Epoch=134.8] | Loss=0.01001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.438 | L2-Norm(final)=13.021 | 3972.1 samples/s | 62.1 steps/s
[Step=69000 Epoch=134.9] | Loss=0.00997 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.444 | L2-Norm(final)=13.026 | 4892.4 samples/s | 76.4 steps/s
[Step=69050 Epoch=135.0] | Loss=0.00965 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.450 | L2-Norm(final)=13.031 | 1532.3 samples/s | 23.9 steps/s
[Step=69100 Epoch=135.1] | Loss=0.00932 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.456 | L2-Norm(final)=13.036 | 3847.5 samples/s | 60.1 steps/s
[Step=69150 Epoch=135.2] | Loss=0.00905 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.461 | L2-Norm(final)=13.041 | 3912.0 samples/s | 61.1 steps/s
[Step=69200 Epoch=135.3] | Loss=0.00885 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.466 | L2-Norm(final)=13.045 | 3972.7 samples/s | 62.1 steps/s
[Step=69250 Epoch=135.4] | Loss=0.00876 | Reg=0.00090 | acc=0.9688 | L2-Norm=9.471 | L2-Norm(final)=13.050 | 3945.0 samples/s | 61.6 steps/s
[Step=69300 Epoch=135.5] | Loss=0.00867 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.475 | L2-Norm(final)=13.054 | 3956.6 samples/s | 61.8 steps/s
[Step=69350 Epoch=135.6] | Loss=0.00862 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.480 | L2-Norm(final)=13.058 | 3908.8 samples/s | 61.1 steps/s
[Step=69400 Epoch=135.7] | Loss=0.00860 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.484 | L2-Norm(final)=13.062 | 3937.3 samples/s | 61.5 steps/s
[Step=69450 Epoch=135.8] | Loss=0.00867 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.488 | L2-Norm(final)=13.066 | 3971.0 samples/s | 62.0 steps/s
[Step=69500 Epoch=135.9] | Loss=0.00864 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.493 | L2-Norm(final)=13.070 | 4252.2 samples/s | 66.4 steps/s
[Step=69550 Epoch=136.0] | Loss=0.00847 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.497 | L2-Norm(final)=13.073 | 1538.0 samples/s | 24.0 steps/s
[Step=69600 Epoch=136.1] | Loss=0.00840 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.501 | L2-Norm(final)=13.077 | 3941.0 samples/s | 61.6 steps/s
[Step=69650 Epoch=136.2] | Loss=0.00831 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.505 | L2-Norm(final)=13.081 | 3896.4 samples/s | 60.9 steps/s
[Step=69700 Epoch=136.3] | Loss=0.00826 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.509 | L2-Norm(final)=13.084 | 3985.6 samples/s | 62.3 steps/s
[Step=69750 Epoch=136.4] | Loss=0.00819 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.512 | L2-Norm(final)=13.088 | 3925.5 samples/s | 61.3 steps/s
[Step=69800 Epoch=136.5] | Loss=0.00808 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.516 | L2-Norm(final)=13.091 | 3997.0 samples/s | 62.5 steps/s
[Step=69850 Epoch=136.6] | Loss=0.00806 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.520 | L2-Norm(final)=13.095 | 3976.8 samples/s | 62.1 steps/s
[Step=69900 Epoch=136.7] | Loss=0.00797 | Reg=0.00091 | acc=0.9688 | L2-Norm=9.523 | L2-Norm(final)=13.098 | 3991.4 samples/s | 62.4 steps/s
[Step=69950 Epoch=136.8] | Loss=0.00787 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.527 | L2-Norm(final)=13.102 | 3942.5 samples/s | 61.6 steps/s
[Step=70000 Epoch=136.8] | Loss=0.00780 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.531 | L2-Norm(final)=13.105 | 3988.7 samples/s | 62.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step70000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=68001 Epoch=260.6] | Loss=0.00003 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.254 | L2-Norm(final)=9.340 | 3473.2 samples/s | 54.3 steps/s
[Step=68050 Epoch=260.7] | Loss=0.00010 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.256 | L2-Norm(final)=9.355 | 3773.8 samples/s | 59.0 steps/s
[Step=68100 Epoch=260.9] | Loss=0.00007 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.260 | L2-Norm(final)=9.370 | 4136.9 samples/s | 64.6 steps/s
[Step=68150 Epoch=261.1] | Loss=0.00006 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.261 | L2-Norm(final)=9.381 | 4234.5 samples/s | 66.2 steps/s
[Step=68200 Epoch=261.3] | Loss=0.00006 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.263 | L2-Norm(final)=9.391 | 4060.2 samples/s | 63.4 steps/s
[Step=68250 Epoch=261.5] | Loss=0.00005 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.264 | L2-Norm(final)=9.400 | 5440.5 samples/s | 85.0 steps/s
[Step=68300 Epoch=261.7] | Loss=0.00005 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.264 | L2-Norm(final)=9.407 | 1537.9 samples/s | 24.0 steps/s
[Step=68350 Epoch=261.9] | Loss=0.00004 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.263 | L2-Norm(final)=9.412 | 4174.1 samples/s | 65.2 steps/s
[Step=68400 Epoch=262.1] | Loss=0.00004 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.261 | L2-Norm(final)=9.417 | 4066.7 samples/s | 63.5 steps/s
[Step=68450 Epoch=262.3] | Loss=0.00003 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.258 | L2-Norm(final)=9.422 | 4240.2 samples/s | 66.3 steps/s
[Step=68500 Epoch=262.5] | Loss=0.00003 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.255 | L2-Norm(final)=9.426 | 4658.6 samples/s | 72.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=68501 Epoch=262.5] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.225 | L2-Norm(final)=9.468 | 3156.5 samples/s | 49.3 steps/s
[Step=68550 Epoch=262.7] | Loss=0.00002 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.200 | L2-Norm(final)=9.471 | 3613.1 samples/s | 56.5 steps/s
[Step=68600 Epoch=262.9] | Loss=0.00002 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.180 | L2-Norm(final)=9.476 | 3773.6 samples/s | 59.0 steps/s
[Step=68650 Epoch=263.0] | Loss=0.00002 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.162 | L2-Norm(final)=9.480 | 3732.8 samples/s | 58.3 steps/s
[Step=68700 Epoch=263.2] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.143 | L2-Norm(final)=9.483 | 3719.1 samples/s | 58.1 steps/s
[Step=68750 Epoch=263.4] | Loss=0.00023 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.129 | L2-Norm(final)=9.486 | 4738.4 samples/s | 74.0 steps/s
[Step=68800 Epoch=263.6] | Loss=0.00034 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.128 | L2-Norm(final)=9.488 | 1441.3 samples/s | 22.5 steps/s
[Step=68850 Epoch=263.8] | Loss=0.00041 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.130 | L2-Norm(final)=9.489 | 3775.5 samples/s | 59.0 steps/s
[Step=68900 Epoch=264.0] | Loss=0.00036 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.133 | L2-Norm(final)=9.490 | 3614.2 samples/s | 56.5 steps/s
[Step=68950 Epoch=264.2] | Loss=0.00033 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.135 | L2-Norm(final)=9.491 | 3762.4 samples/s | 58.8 steps/s
[Step=69000 Epoch=264.4] | Loss=0.00030 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.137 | L2-Norm(final)=9.492 | 4168.4 samples/s | 65.1 steps/s
[Step=69050 Epoch=264.6] | Loss=0.00027 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.138 | L2-Norm(final)=9.493 | 1494.3 samples/s | 23.3 steps/s
[Step=69100 Epoch=264.8] | Loss=0.00025 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.138 | L2-Norm(final)=9.494 | 3796.2 samples/s | 59.3 steps/s
[Step=69150 Epoch=265.0] | Loss=0.00023 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.138 | L2-Norm(final)=9.494 | 3682.4 samples/s | 57.5 steps/s
[Step=69200 Epoch=265.1] | Loss=0.00022 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.138 | L2-Norm(final)=9.495 | 3714.3 samples/s | 58.0 steps/s
[Step=69250 Epoch=265.3] | Loss=0.00020 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.138 | L2-Norm(final)=9.496 | 3714.1 samples/s | 58.0 steps/s
[Step=69300 Epoch=265.5] | Loss=0.00019 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.138 | L2-Norm(final)=9.496 | 1591.0 samples/s | 24.9 steps/s
[Step=69350 Epoch=265.7] | Loss=0.00018 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.137 | L2-Norm(final)=9.497 | 3791.3 samples/s | 59.2 steps/s
[Step=69400 Epoch=265.9] | Loss=0.00017 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.137 | L2-Norm(final)=9.497 | 3728.7 samples/s | 58.3 steps/s
[Step=69450 Epoch=266.1] | Loss=0.00016 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.136 | L2-Norm(final)=9.498 | 3757.0 samples/s | 58.7 steps/s
[Step=69500 Epoch=266.3] | Loss=0.00015 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.135 | L2-Norm(final)=9.498 | 3677.3 samples/s | 57.5 steps/s
[Step=69550 Epoch=266.5] | Loss=0.00015 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.134 | L2-Norm(final)=9.499 | 1596.9 samples/s | 25.0 steps/s
[Step=69600 Epoch=266.7] | Loss=0.00014 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.133 | L2-Norm(final)=9.499 | 3796.2 samples/s | 59.3 steps/s
[Step=69650 Epoch=266.9] | Loss=0.00013 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.132 | L2-Norm(final)=9.500 | 3734.1 samples/s | 58.3 steps/s
[Step=69700 Epoch=267.1] | Loss=0.00013 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.131 | L2-Norm(final)=9.500 | 3767.6 samples/s | 58.9 steps/s
[Step=69750 Epoch=267.3] | Loss=0.00012 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.130 | L2-Norm(final)=9.501 | 3694.6 samples/s | 57.7 steps/s
[Step=69800 Epoch=267.4] | Loss=0.00012 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.128 | L2-Norm(final)=9.501 | 5101.0 samples/s | 79.7 steps/s
[Step=69850 Epoch=267.6] | Loss=0.00011 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.127 | L2-Norm(final)=9.501 | 1414.7 samples/s | 22.1 steps/s
[Step=69900 Epoch=267.8] | Loss=0.00011 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.126 | L2-Norm(final)=9.502 | 3705.1 samples/s | 57.9 steps/s
[Step=69950 Epoch=268.0] | Loss=0.00011 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.124 | L2-Norm(final)=9.502 | 3711.8 samples/s | 58.0 steps/s
[Step=70000 Epoch=268.2] | Loss=0.00010 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.123 | L2-Norm(final)=9.503 | 3662.7 samples/s | 57.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step70000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=68001 Epoch=261.8] | Loss=0.00007 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.254 | L2-Norm(final)=9.818 | 3185.4 samples/s | 49.8 steps/s
[Step=68050 Epoch=262.0] | Loss=0.00021 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.260 | L2-Norm(final)=9.831 | 4227.5 samples/s | 66.1 steps/s
[Step=68100 Epoch=262.1] | Loss=0.00014 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.273 | L2-Norm(final)=9.839 | 3981.5 samples/s | 62.2 steps/s
[Step=68150 Epoch=262.3] | Loss=0.00010 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.278 | L2-Norm(final)=9.845 | 4140.7 samples/s | 64.7 steps/s
[Step=68200 Epoch=262.5] | Loss=0.00008 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.279 | L2-Norm(final)=9.850 | 4105.4 samples/s | 64.1 steps/s
[Step=68250 Epoch=262.7] | Loss=0.00007 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.279 | L2-Norm(final)=9.853 | 5431.6 samples/s | 84.9 steps/s
[Step=68300 Epoch=262.9] | Loss=0.00006 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.278 | L2-Norm(final)=9.857 | 1526.7 samples/s | 23.9 steps/s
[Step=68350 Epoch=263.1] | Loss=0.00006 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.277 | L2-Norm(final)=9.860 | 4050.2 samples/s | 63.3 steps/s
[Step=68400 Epoch=263.3] | Loss=0.00005 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.275 | L2-Norm(final)=9.864 | 4144.5 samples/s | 64.8 steps/s
[Step=68450 Epoch=263.5] | Loss=0.00005 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.273 | L2-Norm(final)=9.867 | 4107.8 samples/s | 64.2 steps/s
[Step=68500 Epoch=263.7] | Loss=0.00004 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.271 | L2-Norm(final)=9.869 | 4745.4 samples/s | 74.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=68501 Epoch=263.7] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.248 | L2-Norm(final)=9.897 | 3288.6 samples/s | 51.4 steps/s
[Step=68550 Epoch=263.9] | Loss=0.00009 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.237 | L2-Norm(final)=9.900 | 3375.6 samples/s | 52.7 steps/s
[Step=68600 Epoch=264.1] | Loss=0.00077 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.252 | L2-Norm(final)=9.900 | 3728.5 samples/s | 58.3 steps/s
[Step=68650 Epoch=264.3] | Loss=0.00072 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.269 | L2-Norm(final)=9.899 | 3686.8 samples/s | 57.6 steps/s
[Step=68700 Epoch=264.5] | Loss=0.00059 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.280 | L2-Norm(final)=9.900 | 3692.3 samples/s | 57.7 steps/s
[Step=68750 Epoch=264.6] | Loss=0.00047 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.286 | L2-Norm(final)=9.901 | 4712.7 samples/s | 73.6 steps/s
[Step=68800 Epoch=264.8] | Loss=0.00040 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.290 | L2-Norm(final)=9.902 | 1435.7 samples/s | 22.4 steps/s
[Step=68850 Epoch=265.0] | Loss=0.00034 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.293 | L2-Norm(final)=9.903 | 3667.5 samples/s | 57.3 steps/s
[Step=68900 Epoch=265.2] | Loss=0.00030 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.294 | L2-Norm(final)=9.903 | 3661.3 samples/s | 57.2 steps/s
[Step=68950 Epoch=265.4] | Loss=0.00027 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.295 | L2-Norm(final)=9.904 | 3722.4 samples/s | 58.2 steps/s
[Step=69000 Epoch=265.6] | Loss=0.00024 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.295 | L2-Norm(final)=9.904 | 4217.2 samples/s | 65.9 steps/s
[Step=69050 Epoch=265.8] | Loss=0.00022 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.295 | L2-Norm(final)=9.905 | 1509.7 samples/s | 23.6 steps/s
[Step=69100 Epoch=266.0] | Loss=0.00020 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.295 | L2-Norm(final)=9.905 | 3767.6 samples/s | 58.9 steps/s
[Step=69150 Epoch=266.2] | Loss=0.00019 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.295 | L2-Norm(final)=9.906 | 3711.5 samples/s | 58.0 steps/s
[Step=69200 Epoch=266.4] | Loss=0.00018 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.294 | L2-Norm(final)=9.906 | 3686.8 samples/s | 57.6 steps/s
[Step=69250 Epoch=266.6] | Loss=0.00016 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.293 | L2-Norm(final)=9.907 | 3777.6 samples/s | 59.0 steps/s
[Step=69300 Epoch=266.8] | Loss=0.00015 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.292 | L2-Norm(final)=9.907 | 1579.6 samples/s | 24.7 steps/s
[Step=69350 Epoch=267.0] | Loss=0.00015 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.291 | L2-Norm(final)=9.907 | 3750.0 samples/s | 58.6 steps/s
[Step=69400 Epoch=267.1] | Loss=0.00014 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.290 | L2-Norm(final)=9.908 | 3727.5 samples/s | 58.2 steps/s
[Step=69450 Epoch=267.3] | Loss=0.00013 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.289 | L2-Norm(final)=9.908 | 3717.6 samples/s | 58.1 steps/s
[Step=69500 Epoch=267.5] | Loss=0.00012 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.288 | L2-Norm(final)=9.908 | 3776.3 samples/s | 59.0 steps/s
[Step=69550 Epoch=267.7] | Loss=0.00012 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.286 | L2-Norm(final)=9.909 | 1573.2 samples/s | 24.6 steps/s
[Step=69600 Epoch=267.9] | Loss=0.00011 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.285 | L2-Norm(final)=9.909 | 3748.1 samples/s | 58.6 steps/s
[Step=69650 Epoch=268.1] | Loss=0.00011 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=9.909 | 3759.2 samples/s | 58.7 steps/s
[Step=69700 Epoch=268.3] | Loss=0.00010 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.282 | L2-Norm(final)=9.910 | 3779.6 samples/s | 59.1 steps/s
[Step=69750 Epoch=268.5] | Loss=0.00010 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.281 | L2-Norm(final)=9.910 | 3709.0 samples/s | 58.0 steps/s
[Step=69800 Epoch=268.7] | Loss=0.00010 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.279 | L2-Norm(final)=9.910 | 5551.2 samples/s | 86.7 steps/s
[Step=69850 Epoch=268.9] | Loss=0.00009 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.278 | L2-Norm(final)=9.911 | 1411.3 samples/s | 22.1 steps/s
[Step=69900 Epoch=269.1] | Loss=0.00009 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.276 | L2-Norm(final)=9.911 | 3694.7 samples/s | 57.7 steps/s
[Step=69950 Epoch=269.3] | Loss=0.00009 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.274 | L2-Norm(final)=9.911 | 3744.0 samples/s | 58.5 steps/s
[Step=70000 Epoch=269.5] | Loss=0.00008 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.272 | L2-Norm(final)=9.912 | 3703.7 samples/s | 57.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step70000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05748 | acc=0.9707 | tpr=0.9797 | fpr=0.0488 | 3573.2 samples/s | 14.0 steps/s
Avg test loss: 0.06400, Avg test acc: 0.96819, Avg tpr: 0.97744, Avg fpr: 0.05217, total FA: 407

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06296 | acc=0.9712 | tpr=0.9831 | fpr=0.0548 | 3551.8 samples/s | 13.9 steps/s
Avg test loss: 0.06961, Avg test acc: 0.96867, Avg tpr: 0.98205, Avg fpr: 0.06076, total FA: 474

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.24232 | acc=0.3117 | tpr=0.0112 | fpr=0.0357 | 3519.1 samples/s | 13.7 steps/s
Avg test loss: 5.25062, Avg test acc: 0.31004, Avg tpr: 0.01160, Avg fpr: 0.03359, total FA: 262

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.13837 | acc=0.3152 | tpr=0.0178 | fpr=0.0391 | 3518.7 samples/s | 13.7 steps/s
Avg test loss: 5.14899, Avg test acc: 0.31224, Avg tpr: 0.01795, Avg fpr: 0.04051, total FA: 316

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.05241 | acc=0.1093 | tpr=0.8496 | fpr=0.9040 | 3538.3 samples/s | 13.8 steps/s
[Step= 100] | Loss=5.03267 | acc=0.1114 | tpr=0.8721 | fpr=0.9028 | 6785.4 samples/s | 26.5 steps/s
[Step= 150] | Loss=5.04486 | acc=0.1109 | tpr=0.8732 | fpr=0.9031 | 7203.2 samples/s | 28.1 steps/s
[Step= 200] | Loss=5.02761 | acc=0.1109 | tpr=0.8689 | fpr=0.9029 | 6759.5 samples/s | 26.4 steps/s
[Step= 250] | Loss=5.02952 | acc=0.1110 | tpr=0.8611 | fpr=0.9027 | 6881.9 samples/s | 26.9 steps/s
[Step= 300] | Loss=5.03141 | acc=0.1102 | tpr=0.8582 | fpr=0.9034 | 6774.0 samples/s | 26.5 steps/s
[Step= 350] | Loss=5.02745 | acc=0.1107 | tpr=0.8641 | fpr=0.9030 | 6861.1 samples/s | 26.8 steps/s
[Step= 400] | Loss=5.02524 | acc=0.1106 | tpr=0.8600 | fpr=0.9030 | 6856.0 samples/s | 26.8 steps/s
[Step= 450] | Loss=5.03178 | acc=0.1102 | tpr=0.8622 | fpr=0.9035 | 6886.0 samples/s | 26.9 steps/s
[Step= 500] | Loss=5.03311 | acc=0.1102 | tpr=0.8639 | fpr=0.9034 | 6672.4 samples/s | 26.1 steps/s
[Step= 550] | Loss=5.03310 | acc=0.1105 | tpr=0.8647 | fpr=0.9032 | 12592.5 samples/s | 49.2 steps/s
Avg test loss: 5.03406, Avg test acc: 0.11040, Avg tpr: 0.86410, Avg fpr: 0.90330, total FA: 125422

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.91882 | acc=0.1002 | tpr=0.9027 | fpr=0.9142 | 3517.5 samples/s | 13.7 steps/s
[Step= 100] | Loss=5.90071 | acc=0.1018 | tpr=0.9041 | fpr=0.9131 | 6713.6 samples/s | 26.2 steps/s
[Step= 150] | Loss=5.91675 | acc=0.1011 | tpr=0.9035 | fpr=0.9137 | 6880.9 samples/s | 26.9 steps/s
[Step= 200] | Loss=5.89939 | acc=0.1010 | tpr=0.8962 | fpr=0.9135 | 7066.8 samples/s | 27.6 steps/s
[Step= 250] | Loss=5.89981 | acc=0.1014 | tpr=0.8943 | fpr=0.9131 | 6622.9 samples/s | 25.9 steps/s
[Step= 300] | Loss=5.90434 | acc=0.1007 | tpr=0.8902 | fpr=0.9137 | 6774.0 samples/s | 26.5 steps/s
[Step= 350] | Loss=5.90341 | acc=0.1009 | tpr=0.8936 | fpr=0.9135 | 6658.4 samples/s | 26.0 steps/s
[Step= 400] | Loss=5.90030 | acc=0.1009 | tpr=0.8906 | fpr=0.9134 | 6846.0 samples/s | 26.7 steps/s
[Step= 450] | Loss=5.90768 | acc=0.1006 | tpr=0.8919 | fpr=0.9138 | 6688.8 samples/s | 26.1 steps/s
[Step= 500] | Loss=5.90884 | acc=0.1005 | tpr=0.8934 | fpr=0.9138 | 6719.8 samples/s | 26.2 steps/s
[Step= 550] | Loss=5.90883 | acc=0.1007 | tpr=0.8934 | fpr=0.9137 | 12398.4 samples/s | 48.4 steps/s
Avg test loss: 5.90997, Avg test acc: 0.10062, Avg tpr: 0.89303, Avg fpr: 0.91378, total FA: 126877

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09479 | acc=0.9831 | tpr=0.9469 | fpr=0.0162 | 3487.1 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.09753 | acc=0.9827 | tpr=0.9574 | fpr=0.0168 | 6825.3 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.09988 | acc=0.9820 | tpr=0.9582 | fpr=0.0176 | 6845.6 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.10129 | acc=0.9821 | tpr=0.9585 | fpr=0.0175 | 6824.8 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.10041 | acc=0.9823 | tpr=0.9546 | fpr=0.0172 | 6958.0 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.10268 | acc=0.9820 | tpr=0.9527 | fpr=0.0175 | 6822.1 samples/s | 26.6 steps/s
[Step= 350] | Loss=0.10269 | acc=0.9819 | tpr=0.9543 | fpr=0.0176 | 6685.7 samples/s | 26.1 steps/s
[Step= 400] | Loss=0.10402 | acc=0.9817 | tpr=0.9497 | fpr=0.0177 | 7069.4 samples/s | 27.6 steps/s
[Step= 450] | Loss=0.10613 | acc=0.9814 | tpr=0.9484 | fpr=0.0180 | 6634.4 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.10582 | acc=0.9814 | tpr=0.9511 | fpr=0.0181 | 6957.4 samples/s | 27.2 steps/s
[Step= 550] | Loss=0.10493 | acc=0.9815 | tpr=0.9519 | fpr=0.0179 | 12231.4 samples/s | 47.8 steps/s
Avg test loss: 0.10484, Avg test acc: 0.98154, Avg tpr: 0.95127, Avg fpr: 0.01791, total FA: 2487

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10916 | acc=0.9822 | tpr=0.9336 | fpr=0.0169 | 3478.9 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.11383 | acc=0.9816 | tpr=0.9574 | fpr=0.0179 | 6864.7 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.11645 | acc=0.9806 | tpr=0.9597 | fpr=0.0190 | 6886.9 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.11761 | acc=0.9804 | tpr=0.9585 | fpr=0.0192 | 6953.9 samples/s | 27.2 steps/s
[Step= 250] | Loss=0.11638 | acc=0.9805 | tpr=0.9546 | fpr=0.0191 | 6913.5 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.11873 | acc=0.9801 | tpr=0.9549 | fpr=0.0194 | 6885.8 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.11801 | acc=0.9801 | tpr=0.9555 | fpr=0.0195 | 6738.1 samples/s | 26.3 steps/s
[Step= 400] | Loss=0.11922 | acc=0.9800 | tpr=0.9540 | fpr=0.0195 | 6742.4 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.12147 | acc=0.9797 | tpr=0.9523 | fpr=0.0198 | 6803.2 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.12135 | acc=0.9796 | tpr=0.9551 | fpr=0.0200 | 6848.1 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.12059 | acc=0.9799 | tpr=0.9554 | fpr=0.0197 | 12596.2 samples/s | 49.2 steps/s
Avg test loss: 0.12055, Avg test acc: 0.97989, Avg tpr: 0.95523, Avg fpr: 0.01966, total FA: 2730

server round 35/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=70001 Epoch=136.5] | Loss=0.00376 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.315 | L2-Norm(final)=13.012 | 3139.0 samples/s | 49.0 steps/s
[Step=70050 Epoch=136.6] | Loss=0.01336 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=13.019 | 4312.9 samples/s | 67.4 steps/s
[Step=70100 Epoch=136.7] | Loss=0.01232 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.345 | L2-Norm(final)=13.028 | 4305.8 samples/s | 67.3 steps/s
[Step=70150 Epoch=136.8] | Loss=0.01206 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.355 | L2-Norm(final)=13.039 | 4335.1 samples/s | 67.7 steps/s
[Step=70200 Epoch=136.9] | Loss=0.01195 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.365 | L2-Norm(final)=13.049 | 4428.0 samples/s | 69.2 steps/s
[Step=70250 Epoch=137.0] | Loss=0.01163 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.373 | L2-Norm(final)=13.058 | 4377.0 samples/s | 68.4 steps/s
[Step=70300 Epoch=137.1] | Loss=0.01130 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.380 | L2-Norm(final)=13.067 | 4432.9 samples/s | 69.3 steps/s
[Step=70350 Epoch=137.2] | Loss=0.01150 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.388 | L2-Norm(final)=13.076 | 4342.9 samples/s | 67.9 steps/s
[Step=70400 Epoch=137.3] | Loss=0.01100 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.395 | L2-Norm(final)=13.084 | 4376.2 samples/s | 68.4 steps/s
[Step=70450 Epoch=137.4] | Loss=0.01074 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.403 | L2-Norm(final)=13.093 | 4348.7 samples/s | 67.9 steps/s
[Step=70500 Epoch=137.5] | Loss=0.01077 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.409 | L2-Norm(final)=13.100 | 5550.3 samples/s | 86.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=70501 Epoch=137.5] | Loss=0.00610 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.474 | L2-Norm(final)=13.173 | 3130.2 samples/s | 48.9 steps/s
[Step=70550 Epoch=137.6] | Loss=0.00988 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.482 | L2-Norm(final)=13.180 | 3866.3 samples/s | 60.4 steps/s
[Step=70600 Epoch=137.7] | Loss=0.01048 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.490 | L2-Norm(final)=13.184 | 3935.5 samples/s | 61.5 steps/s
[Step=70650 Epoch=137.8] | Loss=0.01023 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.498 | L2-Norm(final)=13.189 | 4020.2 samples/s | 62.8 steps/s
[Step=70700 Epoch=137.9] | Loss=0.01050 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.505 | L2-Norm(final)=13.193 | 3849.0 samples/s | 60.1 steps/s
[Step=70750 Epoch=138.0] | Loss=0.01089 | Reg=0.00090 | acc=0.9688 | L2-Norm=9.512 | L2-Norm(final)=13.197 | 3927.5 samples/s | 61.4 steps/s
[Step=70800 Epoch=138.1] | Loss=0.01116 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.518 | L2-Norm(final)=13.200 | 3972.0 samples/s | 62.1 steps/s
[Step=70850 Epoch=138.2] | Loss=0.01097 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.524 | L2-Norm(final)=13.203 | 3943.0 samples/s | 61.6 steps/s
[Step=70900 Epoch=138.3] | Loss=0.01069 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.529 | L2-Norm(final)=13.207 | 3974.3 samples/s | 62.1 steps/s
[Step=70950 Epoch=138.4] | Loss=0.01042 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.534 | L2-Norm(final)=13.211 | 3943.8 samples/s | 61.6 steps/s
[Step=71000 Epoch=138.5] | Loss=0.01024 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=13.215 | 4822.3 samples/s | 75.3 steps/s
[Step=71050 Epoch=138.6] | Loss=0.00995 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.545 | L2-Norm(final)=13.219 | 1532.2 samples/s | 23.9 steps/s
[Step=71100 Epoch=138.7] | Loss=0.00952 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.549 | L2-Norm(final)=13.222 | 3950.3 samples/s | 61.7 steps/s
[Step=71150 Epoch=138.8] | Loss=0.00936 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.554 | L2-Norm(final)=13.226 | 3944.8 samples/s | 61.6 steps/s
[Step=71200 Epoch=138.9] | Loss=0.00913 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.558 | L2-Norm(final)=13.230 | 3907.6 samples/s | 61.1 steps/s
[Step=71250 Epoch=139.0] | Loss=0.00897 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.562 | L2-Norm(final)=13.233 | 3960.3 samples/s | 61.9 steps/s
[Step=71300 Epoch=139.1] | Loss=0.00875 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.566 | L2-Norm(final)=13.237 | 3970.1 samples/s | 62.0 steps/s
[Step=71350 Epoch=139.2] | Loss=0.00875 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.569 | L2-Norm(final)=13.240 | 3967.2 samples/s | 62.0 steps/s
[Step=71400 Epoch=139.3] | Loss=0.00873 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.573 | L2-Norm(final)=13.243 | 3948.0 samples/s | 61.7 steps/s
[Step=71450 Epoch=139.4] | Loss=0.00865 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=13.246 | 3910.5 samples/s | 61.1 steps/s
[Step=71500 Epoch=139.5] | Loss=0.00873 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.580 | L2-Norm(final)=13.249 | 4198.6 samples/s | 65.6 steps/s
[Step=71550 Epoch=139.6] | Loss=0.00870 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.583 | L2-Norm(final)=13.252 | 1594.4 samples/s | 24.9 steps/s
[Step=71600 Epoch=139.6] | Loss=0.00859 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.586 | L2-Norm(final)=13.254 | 3871.6 samples/s | 60.5 steps/s
[Step=71650 Epoch=139.7] | Loss=0.00851 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.590 | L2-Norm(final)=13.257 | 3940.2 samples/s | 61.6 steps/s
[Step=71700 Epoch=139.8] | Loss=0.00835 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=13.260 | 3908.1 samples/s | 61.1 steps/s
[Step=71750 Epoch=139.9] | Loss=0.00830 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.596 | L2-Norm(final)=13.263 | 3958.6 samples/s | 61.9 steps/s
[Step=71800 Epoch=140.0] | Loss=0.00826 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.599 | L2-Norm(final)=13.266 | 3930.3 samples/s | 61.4 steps/s
[Step=71850 Epoch=140.1] | Loss=0.00819 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.601 | L2-Norm(final)=13.269 | 3861.2 samples/s | 60.3 steps/s
[Step=71900 Epoch=140.2] | Loss=0.00812 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=13.271 | 3950.7 samples/s | 61.7 steps/s
[Step=71950 Epoch=140.3] | Loss=0.00800 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.607 | L2-Norm(final)=13.274 | 3939.8 samples/s | 61.6 steps/s
[Step=72000 Epoch=140.4] | Loss=0.00797 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.609 | L2-Norm(final)=13.277 | 3920.3 samples/s | 61.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step72000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=70001 Epoch=136.9] | Loss=0.00441 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.315 | L2-Norm(final)=13.209 | 3452.5 samples/s | 53.9 steps/s
[Step=70050 Epoch=136.9] | Loss=0.01208 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.326 | L2-Norm(final)=13.218 | 4124.2 samples/s | 64.4 steps/s
[Step=70100 Epoch=137.0] | Loss=0.01234 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.334 | L2-Norm(final)=13.228 | 4404.3 samples/s | 68.8 steps/s
[Step=70150 Epoch=137.1] | Loss=0.01138 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.340 | L2-Norm(final)=13.237 | 4279.2 samples/s | 66.9 steps/s
[Step=70200 Epoch=137.2] | Loss=0.01137 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.346 | L2-Norm(final)=13.246 | 4344.2 samples/s | 67.9 steps/s
[Step=70250 Epoch=137.3] | Loss=0.01108 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.353 | L2-Norm(final)=13.255 | 4356.8 samples/s | 68.1 steps/s
[Step=70300 Epoch=137.4] | Loss=0.01111 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.359 | L2-Norm(final)=13.264 | 4354.1 samples/s | 68.0 steps/s
[Step=70350 Epoch=137.5] | Loss=0.01124 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.366 | L2-Norm(final)=13.273 | 4383.9 samples/s | 68.5 steps/s
[Step=70400 Epoch=137.6] | Loss=0.01103 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.372 | L2-Norm(final)=13.281 | 4303.0 samples/s | 67.2 steps/s
[Step=70450 Epoch=137.7] | Loss=0.01083 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.378 | L2-Norm(final)=13.289 | 4304.4 samples/s | 67.3 steps/s
[Step=70500 Epoch=137.8] | Loss=0.01067 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.383 | L2-Norm(final)=13.296 | 5575.3 samples/s | 87.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=70501 Epoch=137.8] | Loss=0.00997 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.438 | L2-Norm(final)=13.371 | 3278.6 samples/s | 51.2 steps/s
[Step=70550 Epoch=137.9] | Loss=0.00905 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.446 | L2-Norm(final)=13.377 | 3802.8 samples/s | 59.4 steps/s
[Step=70600 Epoch=138.0] | Loss=0.00864 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.454 | L2-Norm(final)=13.383 | 3916.1 samples/s | 61.2 steps/s
[Step=70650 Epoch=138.1] | Loss=0.00910 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.462 | L2-Norm(final)=13.389 | 3941.6 samples/s | 61.6 steps/s
[Step=70700 Epoch=138.2] | Loss=0.00852 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.469 | L2-Norm(final)=13.395 | 3890.6 samples/s | 60.8 steps/s
[Step=70750 Epoch=138.3] | Loss=0.00830 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.477 | L2-Norm(final)=13.400 | 3943.8 samples/s | 61.6 steps/s
[Step=70800 Epoch=138.4] | Loss=0.00858 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.483 | L2-Norm(final)=13.405 | 3917.7 samples/s | 61.2 steps/s
[Step=70850 Epoch=138.5] | Loss=0.00878 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.488 | L2-Norm(final)=13.409 | 3916.1 samples/s | 61.2 steps/s
[Step=70900 Epoch=138.6] | Loss=0.00885 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.494 | L2-Norm(final)=13.413 | 3943.3 samples/s | 61.6 steps/s
[Step=70950 Epoch=138.7] | Loss=0.00877 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.499 | L2-Norm(final)=13.417 | 3920.7 samples/s | 61.3 steps/s
[Step=71000 Epoch=138.8] | Loss=0.00887 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.504 | L2-Norm(final)=13.420 | 4866.2 samples/s | 76.0 steps/s
[Step=71050 Epoch=138.9] | Loss=0.00861 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.509 | L2-Norm(final)=13.424 | 1492.6 samples/s | 23.3 steps/s
[Step=71100 Epoch=139.0] | Loss=0.00865 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.514 | L2-Norm(final)=13.428 | 3916.8 samples/s | 61.2 steps/s
[Step=71150 Epoch=139.1] | Loss=0.00853 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.518 | L2-Norm(final)=13.431 | 3945.7 samples/s | 61.7 steps/s
[Step=71200 Epoch=139.2] | Loss=0.00833 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.523 | L2-Norm(final)=13.435 | 3940.0 samples/s | 61.6 steps/s
[Step=71250 Epoch=139.3] | Loss=0.00815 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.527 | L2-Norm(final)=13.438 | 3906.4 samples/s | 61.0 steps/s
[Step=71300 Epoch=139.4] | Loss=0.00817 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.531 | L2-Norm(final)=13.442 | 3934.3 samples/s | 61.5 steps/s
[Step=71350 Epoch=139.5] | Loss=0.00814 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.535 | L2-Norm(final)=13.445 | 3972.8 samples/s | 62.1 steps/s
[Step=71400 Epoch=139.6] | Loss=0.00804 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=13.448 | 3961.0 samples/s | 61.9 steps/s
[Step=71450 Epoch=139.7] | Loss=0.00790 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.543 | L2-Norm(final)=13.452 | 3916.4 samples/s | 61.2 steps/s
[Step=71500 Epoch=139.8] | Loss=0.00788 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.547 | L2-Norm(final)=13.455 | 4298.8 samples/s | 67.2 steps/s
[Step=71550 Epoch=139.9] | Loss=0.00780 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.551 | L2-Norm(final)=13.458 | 1570.9 samples/s | 24.5 steps/s
[Step=71600 Epoch=140.0] | Loss=0.00765 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.554 | L2-Norm(final)=13.461 | 3952.5 samples/s | 61.8 steps/s
[Step=71650 Epoch=140.1] | Loss=0.00756 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.557 | L2-Norm(final)=13.464 | 3884.8 samples/s | 60.7 steps/s
[Step=71700 Epoch=140.2] | Loss=0.00754 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.561 | L2-Norm(final)=13.467 | 3946.7 samples/s | 61.7 steps/s
[Step=71750 Epoch=140.3] | Loss=0.00743 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.564 | L2-Norm(final)=13.470 | 3901.9 samples/s | 61.0 steps/s
[Step=71800 Epoch=140.4] | Loss=0.00739 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.567 | L2-Norm(final)=13.473 | 3955.7 samples/s | 61.8 steps/s
[Step=71850 Epoch=140.5] | Loss=0.00737 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.570 | L2-Norm(final)=13.475 | 3996.9 samples/s | 62.5 steps/s
[Step=71900 Epoch=140.6] | Loss=0.00731 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.573 | L2-Norm(final)=13.478 | 3995.1 samples/s | 62.4 steps/s
[Step=71950 Epoch=140.7] | Loss=0.00736 | Reg=0.00092 | acc=0.9531 | L2-Norm=9.576 | L2-Norm(final)=13.481 | 3921.5 samples/s | 61.3 steps/s
[Step=72000 Epoch=140.8] | Loss=0.00733 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.580 | L2-Norm(final)=13.484 | 3931.0 samples/s | 61.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step72000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=70001 Epoch=268.2] | Loss=0.00008 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.315 | L2-Norm(final)=9.513 | 3219.5 samples/s | 50.3 steps/s
[Step=70050 Epoch=268.4] | Loss=0.00010 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.315 | L2-Norm(final)=9.516 | 3821.8 samples/s | 59.7 steps/s
[Step=70100 Epoch=268.6] | Loss=0.00007 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.315 | L2-Norm(final)=9.520 | 4110.9 samples/s | 64.2 steps/s
[Step=70150 Epoch=268.8] | Loss=0.00006 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.314 | L2-Norm(final)=9.522 | 4110.1 samples/s | 64.2 steps/s
[Step=70200 Epoch=269.0] | Loss=0.00005 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.314 | L2-Norm(final)=9.525 | 4096.0 samples/s | 64.0 steps/s
[Step=70250 Epoch=269.2] | Loss=0.00005 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.313 | L2-Norm(final)=9.528 | 5350.8 samples/s | 83.6 steps/s
[Step=70300 Epoch=269.4] | Loss=0.00005 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.313 | L2-Norm(final)=9.531 | 1507.7 samples/s | 23.6 steps/s
[Step=70350 Epoch=269.6] | Loss=0.00004 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.312 | L2-Norm(final)=9.534 | 4176.7 samples/s | 65.3 steps/s
[Step=70400 Epoch=269.7] | Loss=0.00004 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.312 | L2-Norm(final)=9.537 | 4165.0 samples/s | 65.1 steps/s
[Step=70450 Epoch=269.9] | Loss=0.00004 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.311 | L2-Norm(final)=9.540 | 4078.4 samples/s | 63.7 steps/s
[Step=70500 Epoch=270.1] | Loss=0.00004 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.310 | L2-Norm(final)=9.542 | 4625.5 samples/s | 72.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=70501 Epoch=270.1] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.302 | L2-Norm(final)=9.569 | 3301.9 samples/s | 51.6 steps/s
[Step=70550 Epoch=270.3] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.300 | L2-Norm(final)=9.571 | 3393.4 samples/s | 53.0 steps/s
[Step=70600 Epoch=270.5] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.297 | L2-Norm(final)=9.573 | 3718.4 samples/s | 58.1 steps/s
[Step=70650 Epoch=270.7] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.295 | L2-Norm(final)=9.575 | 3685.8 samples/s | 57.6 steps/s
[Step=70700 Epoch=270.9] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.292 | L2-Norm(final)=9.577 | 3743.1 samples/s | 58.5 steps/s
[Step=70750 Epoch=271.1] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.289 | L2-Norm(final)=9.579 | 4745.6 samples/s | 74.1 steps/s
[Step=70800 Epoch=271.3] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.287 | L2-Norm(final)=9.581 | 1458.1 samples/s | 22.8 steps/s
[Step=70850 Epoch=271.5] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=9.582 | 3679.8 samples/s | 57.5 steps/s
[Step=70900 Epoch=271.7] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.281 | L2-Norm(final)=9.584 | 3768.1 samples/s | 58.9 steps/s
[Step=70950 Epoch=271.9] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.277 | L2-Norm(final)=9.585 | 3712.4 samples/s | 58.0 steps/s
[Step=71000 Epoch=272.0] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.274 | L2-Norm(final)=9.587 | 4109.8 samples/s | 64.2 steps/s
[Step=71050 Epoch=272.2] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.271 | L2-Norm(final)=9.588 | 1519.2 samples/s | 23.7 steps/s
[Step=71100 Epoch=272.4] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.268 | L2-Norm(final)=9.590 | 3787.8 samples/s | 59.2 steps/s
[Step=71150 Epoch=272.6] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.264 | L2-Norm(final)=9.591 | 3815.9 samples/s | 59.6 steps/s
[Step=71200 Epoch=272.8] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.261 | L2-Norm(final)=9.592 | 3719.4 samples/s | 58.1 steps/s
[Step=71250 Epoch=273.0] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.258 | L2-Norm(final)=9.594 | 3711.8 samples/s | 58.0 steps/s
[Step=71300 Epoch=273.2] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.254 | L2-Norm(final)=9.595 | 1618.4 samples/s | 25.3 steps/s
[Step=71350 Epoch=273.4] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.251 | L2-Norm(final)=9.596 | 3799.1 samples/s | 59.4 steps/s
[Step=71400 Epoch=273.6] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.247 | L2-Norm(final)=9.597 | 3722.9 samples/s | 58.2 steps/s
[Step=71450 Epoch=273.8] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.243 | L2-Norm(final)=9.599 | 3757.9 samples/s | 58.7 steps/s
[Step=71500 Epoch=274.0] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.240 | L2-Norm(final)=9.600 | 3722.1 samples/s | 58.2 steps/s
[Step=71550 Epoch=274.2] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.236 | L2-Norm(final)=9.601 | 1659.8 samples/s | 25.9 steps/s
[Step=71600 Epoch=274.3] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.232 | L2-Norm(final)=9.602 | 3579.5 samples/s | 55.9 steps/s
[Step=71650 Epoch=274.5] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.228 | L2-Norm(final)=9.603 | 3703.3 samples/s | 57.9 steps/s
[Step=71700 Epoch=274.7] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.224 | L2-Norm(final)=9.604 | 3784.0 samples/s | 59.1 steps/s
[Step=71750 Epoch=274.9] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.220 | L2-Norm(final)=9.605 | 3709.0 samples/s | 58.0 steps/s
[Step=71800 Epoch=275.1] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.216 | L2-Norm(final)=9.606 | 5155.5 samples/s | 80.6 steps/s
[Step=71850 Epoch=275.3] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.212 | L2-Norm(final)=9.608 | 1446.4 samples/s | 22.6 steps/s
[Step=71900 Epoch=275.5] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.208 | L2-Norm(final)=9.609 | 3748.2 samples/s | 58.6 steps/s
[Step=71950 Epoch=275.7] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.204 | L2-Norm(final)=9.610 | 3806.0 samples/s | 59.5 steps/s
[Step=72000 Epoch=275.9] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.200 | L2-Norm(final)=9.611 | 3723.3 samples/s | 58.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step72000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=70001 Epoch=269.5] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.315 | L2-Norm(final)=9.921 | 3218.2 samples/s | 50.3 steps/s
[Step=70050 Epoch=269.6] | Loss=0.00018 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.319 | L2-Norm(final)=9.925 | 3903.0 samples/s | 61.0 steps/s
[Step=70100 Epoch=269.8] | Loss=0.00014 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.324 | L2-Norm(final)=9.930 | 4088.4 samples/s | 63.9 steps/s
[Step=70150 Epoch=270.0] | Loss=0.00012 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.326 | L2-Norm(final)=9.934 | 4068.9 samples/s | 63.6 steps/s
[Step=70200 Epoch=270.2] | Loss=0.00011 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.326 | L2-Norm(final)=9.937 | 4129.9 samples/s | 64.5 steps/s
[Step=70250 Epoch=270.4] | Loss=0.00012 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.328 | L2-Norm(final)=9.942 | 5443.0 samples/s | 85.0 steps/s
[Step=70300 Epoch=270.6] | Loss=0.00011 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.330 | L2-Norm(final)=9.945 | 1498.4 samples/s | 23.4 steps/s
[Step=70350 Epoch=270.8] | Loss=0.00010 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=9.949 | 4104.8 samples/s | 64.1 steps/s
[Step=70400 Epoch=271.0] | Loss=0.00009 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=9.952 | 4076.3 samples/s | 63.7 steps/s
[Step=70450 Epoch=271.2] | Loss=0.00008 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=9.955 | 4197.8 samples/s | 65.6 steps/s
[Step=70500 Epoch=271.4] | Loss=0.00008 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=9.957 | 4663.1 samples/s | 72.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=70501 Epoch=271.4] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.330 | L2-Norm(final)=9.984 | 3041.0 samples/s | 47.5 steps/s
[Step=70550 Epoch=271.6] | Loss=0.00003 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.328 | L2-Norm(final)=9.986 | 3744.5 samples/s | 58.5 steps/s
[Step=70600 Epoch=271.8] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.325 | L2-Norm(final)=9.988 | 3710.0 samples/s | 58.0 steps/s
[Step=70650 Epoch=272.0] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.322 | L2-Norm(final)=9.989 | 3765.6 samples/s | 58.8 steps/s
[Step=70700 Epoch=272.2] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.319 | L2-Norm(final)=9.991 | 3710.3 samples/s | 58.0 steps/s
[Step=70750 Epoch=272.3] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.317 | L2-Norm(final)=9.992 | 4736.3 samples/s | 74.0 steps/s
[Step=70800 Epoch=272.5] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.314 | L2-Norm(final)=9.994 | 1448.7 samples/s | 22.6 steps/s
[Step=70850 Epoch=272.7] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.311 | L2-Norm(final)=9.995 | 3674.7 samples/s | 57.4 steps/s
[Step=70900 Epoch=272.9] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.307 | L2-Norm(final)=9.996 | 3733.9 samples/s | 58.3 steps/s
[Step=70950 Epoch=273.1] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.304 | L2-Norm(final)=9.997 | 3713.1 samples/s | 58.0 steps/s
[Step=71000 Epoch=273.3] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.301 | L2-Norm(final)=9.998 | 4248.5 samples/s | 66.4 steps/s
[Step=71050 Epoch=273.5] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.297 | L2-Norm(final)=9.999 | 1500.5 samples/s | 23.4 steps/s
[Step=71100 Epoch=273.7] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.294 | L2-Norm(final)=10.000 | 3704.5 samples/s | 57.9 steps/s
[Step=71150 Epoch=273.9] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.290 | L2-Norm(final)=10.001 | 3712.7 samples/s | 58.0 steps/s
[Step=71200 Epoch=274.1] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.287 | L2-Norm(final)=10.002 | 3678.2 samples/s | 57.5 steps/s
[Step=71250 Epoch=274.3] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.283 | L2-Norm(final)=10.003 | 3819.7 samples/s | 59.7 steps/s
[Step=71300 Epoch=274.5] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.279 | L2-Norm(final)=10.003 | 1590.4 samples/s | 24.9 steps/s
[Step=71350 Epoch=274.7] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.275 | L2-Norm(final)=10.004 | 3761.9 samples/s | 58.8 steps/s
[Step=71400 Epoch=274.8] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.272 | L2-Norm(final)=10.005 | 3684.5 samples/s | 57.6 steps/s
[Step=71450 Epoch=275.0] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.268 | L2-Norm(final)=10.006 | 3698.8 samples/s | 57.8 steps/s
[Step=71500 Epoch=275.2] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.264 | L2-Norm(final)=10.007 | 3694.3 samples/s | 57.7 steps/s
[Step=71550 Epoch=275.4] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.260 | L2-Norm(final)=10.007 | 1552.5 samples/s | 24.3 steps/s
[Step=71600 Epoch=275.6] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.256 | L2-Norm(final)=10.008 | 3691.1 samples/s | 57.7 steps/s
[Step=71650 Epoch=275.8] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.252 | L2-Norm(final)=10.009 | 3684.1 samples/s | 57.6 steps/s
[Step=71700 Epoch=276.0] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.248 | L2-Norm(final)=10.010 | 3716.8 samples/s | 58.1 steps/s
[Step=71750 Epoch=276.2] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.244 | L2-Norm(final)=10.010 | 3710.7 samples/s | 58.0 steps/s
[Step=71800 Epoch=276.4] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.239 | L2-Norm(final)=10.011 | 5503.7 samples/s | 86.0 steps/s
[Step=71850 Epoch=276.6] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.235 | L2-Norm(final)=10.012 | 1386.8 samples/s | 21.7 steps/s
[Step=71900 Epoch=276.8] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.231 | L2-Norm(final)=10.013 | 3766.3 samples/s | 58.8 steps/s
[Step=71950 Epoch=277.0] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.226 | L2-Norm(final)=10.013 | 3745.9 samples/s | 58.5 steps/s
[Step=72000 Epoch=277.2] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.222 | L2-Norm(final)=10.014 | 3725.8 samples/s | 58.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step72000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06018 | acc=0.9695 | tpr=0.9727 | fpr=0.0377 | 3510.9 samples/s | 13.7 steps/s
Avg test loss: 0.06702, Avg test acc: 0.96735, Avg tpr: 0.97080, Avg fpr: 0.04025, total FA: 314

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06144 | acc=0.9705 | tpr=0.9791 | fpr=0.0481 | 3516.8 samples/s | 13.7 steps/s
Avg test loss: 0.06750, Avg test acc: 0.96887, Avg tpr: 0.97791, Avg fpr: 0.05102, total FA: 398

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.95717 | acc=0.3120 | tpr=0.0152 | fpr=0.0436 | 3532.4 samples/s | 13.8 steps/s
Avg test loss: 4.96759, Avg test acc: 0.30904, Avg tpr: 0.01486, Avg fpr: 0.04397, total FA: 343

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.61786 | acc=0.3170 | tpr=0.0185 | fpr=0.0349 | 3518.8 samples/s | 13.7 steps/s
Avg test loss: 4.62925, Avg test acc: 0.31445, Avg tpr: 0.01848, Avg fpr: 0.03461, total FA: 270

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.19678 | acc=0.1149 | tpr=0.8540 | fpr=0.8984 | 3551.2 samples/s | 13.9 steps/s
[Step= 100] | Loss=5.18153 | acc=0.1163 | tpr=0.8614 | fpr=0.8976 | 7007.8 samples/s | 27.4 steps/s
[Step= 150] | Loss=5.19418 | acc=0.1156 | tpr=0.8631 | fpr=0.8982 | 6835.9 samples/s | 26.7 steps/s
[Step= 200] | Loss=5.17523 | acc=0.1157 | tpr=0.8536 | fpr=0.8977 | 6797.6 samples/s | 26.6 steps/s
[Step= 250] | Loss=5.17663 | acc=0.1159 | tpr=0.8480 | fpr=0.8974 | 7060.0 samples/s | 27.6 steps/s
[Step= 300] | Loss=5.17832 | acc=0.1156 | tpr=0.8429 | fpr=0.8977 | 6781.0 samples/s | 26.5 steps/s
[Step= 350] | Loss=5.17385 | acc=0.1162 | tpr=0.8503 | fpr=0.8971 | 6940.1 samples/s | 27.1 steps/s
[Step= 400] | Loss=5.17059 | acc=0.1163 | tpr=0.8474 | fpr=0.8969 | 6839.9 samples/s | 26.7 steps/s
[Step= 450] | Loss=5.17749 | acc=0.1159 | tpr=0.8486 | fpr=0.8974 | 6827.7 samples/s | 26.7 steps/s
[Step= 500] | Loss=5.17845 | acc=0.1157 | tpr=0.8485 | fpr=0.8975 | 6607.7 samples/s | 25.8 steps/s
[Step= 550] | Loss=5.17857 | acc=0.1158 | tpr=0.8488 | fpr=0.8975 | 12987.4 samples/s | 50.7 steps/s
Avg test loss: 5.17962, Avg test acc: 0.11575, Avg tpr: 0.84826, Avg fpr: 0.89756, total FA: 124625

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.68164 | acc=0.1134 | tpr=0.8894 | fpr=0.9005 | 3581.2 samples/s | 14.0 steps/s
[Step= 100] | Loss=5.66244 | acc=0.1154 | tpr=0.8913 | fpr=0.8991 | 6690.6 samples/s | 26.1 steps/s
[Step= 150] | Loss=5.67822 | acc=0.1143 | tpr=0.8890 | fpr=0.8999 | 6893.1 samples/s | 26.9 steps/s
[Step= 200] | Loss=5.66217 | acc=0.1147 | tpr=0.8809 | fpr=0.8993 | 6922.9 samples/s | 27.0 steps/s
[Step= 250] | Loss=5.66223 | acc=0.1146 | tpr=0.8760 | fpr=0.8993 | 6750.6 samples/s | 26.4 steps/s
[Step= 300] | Loss=5.66636 | acc=0.1139 | tpr=0.8705 | fpr=0.8998 | 7092.4 samples/s | 27.7 steps/s
[Step= 350] | Loss=5.66480 | acc=0.1147 | tpr=0.8754 | fpr=0.8991 | 6597.1 samples/s | 25.8 steps/s
[Step= 400] | Loss=5.66098 | acc=0.1149 | tpr=0.8731 | fpr=0.8989 | 6671.0 samples/s | 26.1 steps/s
[Step= 450] | Loss=5.66937 | acc=0.1147 | tpr=0.8754 | fpr=0.8991 | 6683.4 samples/s | 26.1 steps/s
[Step= 500] | Loss=5.66930 | acc=0.1147 | tpr=0.8767 | fpr=0.8990 | 6764.6 samples/s | 26.4 steps/s
[Step= 550] | Loss=5.66921 | acc=0.1149 | tpr=0.8762 | fpr=0.8989 | 12599.1 samples/s | 49.2 steps/s
Avg test loss: 5.67023, Avg test acc: 0.11483, Avg tpr: 0.87599, Avg fpr: 0.89900, total FA: 124825

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09983 | acc=0.9823 | tpr=0.9381 | fpr=0.0169 | 3513.1 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.10354 | acc=0.9818 | tpr=0.9574 | fpr=0.0177 | 6878.6 samples/s | 26.9 steps/s
[Step= 150] | Loss=0.10579 | acc=0.9811 | tpr=0.9582 | fpr=0.0185 | 6810.0 samples/s | 26.6 steps/s
[Step= 200] | Loss=0.10659 | acc=0.9810 | tpr=0.9563 | fpr=0.0185 | 6936.0 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.10526 | acc=0.9815 | tpr=0.9546 | fpr=0.0180 | 7083.5 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.10713 | acc=0.9812 | tpr=0.9549 | fpr=0.0183 | 6708.1 samples/s | 26.2 steps/s
[Step= 350] | Loss=0.10692 | acc=0.9810 | tpr=0.9549 | fpr=0.0185 | 6654.4 samples/s | 26.0 steps/s
[Step= 400] | Loss=0.10826 | acc=0.9809 | tpr=0.9530 | fpr=0.0186 | 6675.4 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.11041 | acc=0.9805 | tpr=0.9513 | fpr=0.0190 | 6846.9 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.11009 | acc=0.9805 | tpr=0.9537 | fpr=0.0190 | 6735.9 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.10944 | acc=0.9807 | tpr=0.9542 | fpr=0.0188 | 12141.3 samples/s | 47.4 steps/s
Avg test loss: 0.10935, Avg test acc: 0.98069, Avg tpr: 0.95365, Avg fpr: 0.01882, total FA: 2613

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10529 | acc=0.9821 | tpr=0.9336 | fpr=0.0170 | 3494.3 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.10976 | acc=0.9816 | tpr=0.9552 | fpr=0.0179 | 6841.5 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.11199 | acc=0.9806 | tpr=0.9582 | fpr=0.0190 | 6793.3 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.11290 | acc=0.9805 | tpr=0.9574 | fpr=0.0191 | 6908.5 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.11174 | acc=0.9806 | tpr=0.9546 | fpr=0.0189 | 7005.0 samples/s | 27.4 steps/s
[Step= 300] | Loss=0.11386 | acc=0.9803 | tpr=0.9549 | fpr=0.0192 | 6618.1 samples/s | 25.9 steps/s
[Step= 350] | Loss=0.11353 | acc=0.9802 | tpr=0.9549 | fpr=0.0193 | 6930.8 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.11489 | acc=0.9800 | tpr=0.9535 | fpr=0.0195 | 6901.5 samples/s | 27.0 steps/s
[Step= 450] | Loss=0.11713 | acc=0.9797 | tpr=0.9523 | fpr=0.0198 | 6771.8 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.11682 | acc=0.9797 | tpr=0.9551 | fpr=0.0199 | 6669.2 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.11610 | acc=0.9798 | tpr=0.9550 | fpr=0.0197 | 12773.3 samples/s | 49.9 steps/s
Avg test loss: 0.11606, Avg test acc: 0.97984, Avg tpr: 0.95444, Avg fpr: 0.01970, total FA: 2735

server round 36/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=72001 Epoch=140.4] | Loss=0.00097 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.328 | L2-Norm(final)=13.355 | 3192.8 samples/s | 49.9 steps/s
[Step=72050 Epoch=140.5] | Loss=0.00906 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.335 | L2-Norm(final)=13.360 | 4204.6 samples/s | 65.7 steps/s
[Step=72100 Epoch=140.6] | Loss=0.00801 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.342 | L2-Norm(final)=13.367 | 4397.3 samples/s | 68.7 steps/s
[Step=72150 Epoch=140.7] | Loss=0.00824 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.348 | L2-Norm(final)=13.373 | 4405.0 samples/s | 68.8 steps/s
[Step=72200 Epoch=140.8] | Loss=0.00843 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.355 | L2-Norm(final)=13.379 | 4410.3 samples/s | 68.9 steps/s
[Step=72250 Epoch=140.9] | Loss=0.00848 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.362 | L2-Norm(final)=13.385 | 4432.2 samples/s | 69.3 steps/s
[Step=72300 Epoch=141.0] | Loss=0.00858 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.368 | L2-Norm(final)=13.391 | 4345.7 samples/s | 67.9 steps/s
[Step=72350 Epoch=141.1] | Loss=0.00847 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.374 | L2-Norm(final)=13.397 | 4537.7 samples/s | 70.9 steps/s
[Step=72400 Epoch=141.2] | Loss=0.00844 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.380 | L2-Norm(final)=13.403 | 4358.6 samples/s | 68.1 steps/s
[Step=72450 Epoch=141.3] | Loss=0.00816 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.385 | L2-Norm(final)=13.409 | 4410.3 samples/s | 68.9 steps/s
[Step=72500 Epoch=141.4] | Loss=0.00828 | Reg=0.00088 | acc=0.9688 | L2-Norm=9.390 | L2-Norm(final)=13.415 | 5430.6 samples/s | 84.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=72501 Epoch=141.4] | Loss=0.00204 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.441 | L2-Norm(final)=13.475 | 3142.7 samples/s | 49.1 steps/s
[Step=72550 Epoch=141.5] | Loss=0.00915 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.448 | L2-Norm(final)=13.478 | 3918.3 samples/s | 61.2 steps/s
[Step=72600 Epoch=141.6] | Loss=0.00936 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.454 | L2-Norm(final)=13.482 | 3937.7 samples/s | 61.5 steps/s
[Step=72650 Epoch=141.7] | Loss=0.00939 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.461 | L2-Norm(final)=13.485 | 3959.6 samples/s | 61.9 steps/s
[Step=72700 Epoch=141.8] | Loss=0.00920 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.467 | L2-Norm(final)=13.489 | 3935.4 samples/s | 61.5 steps/s
[Step=72750 Epoch=141.9] | Loss=0.00873 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.473 | L2-Norm(final)=13.493 | 3944.5 samples/s | 61.6 steps/s
[Step=72800 Epoch=142.0] | Loss=0.00871 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.478 | L2-Norm(final)=13.498 | 3989.7 samples/s | 62.3 steps/s
[Step=72850 Epoch=142.1] | Loss=0.00885 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.484 | L2-Norm(final)=13.502 | 3992.7 samples/s | 62.4 steps/s
[Step=72900 Epoch=142.2] | Loss=0.00893 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.490 | L2-Norm(final)=13.507 | 3941.2 samples/s | 61.6 steps/s
[Step=72950 Epoch=142.3] | Loss=0.00889 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.496 | L2-Norm(final)=13.510 | 3950.1 samples/s | 61.7 steps/s
[Step=73000 Epoch=142.4] | Loss=0.00882 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.502 | L2-Norm(final)=13.514 | 4890.3 samples/s | 76.4 steps/s
[Step=73050 Epoch=142.5] | Loss=0.00859 | Reg=0.00090 | acc=0.9688 | L2-Norm=9.507 | L2-Norm(final)=13.518 | 1535.1 samples/s | 24.0 steps/s
[Step=73100 Epoch=142.6] | Loss=0.00837 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.512 | L2-Norm(final)=13.522 | 3929.3 samples/s | 61.4 steps/s
[Step=73150 Epoch=142.7] | Loss=0.00830 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.517 | L2-Norm(final)=13.526 | 3939.9 samples/s | 61.6 steps/s
[Step=73200 Epoch=142.8] | Loss=0.00825 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.521 | L2-Norm(final)=13.530 | 3937.4 samples/s | 61.5 steps/s
[Step=73250 Epoch=142.9] | Loss=0.00808 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.526 | L2-Norm(final)=13.533 | 3934.5 samples/s | 61.5 steps/s
[Step=73300 Epoch=143.0] | Loss=0.00789 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.530 | L2-Norm(final)=13.537 | 3918.2 samples/s | 61.2 steps/s
[Step=73350 Epoch=143.1] | Loss=0.00791 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.534 | L2-Norm(final)=13.540 | 3850.6 samples/s | 60.2 steps/s
[Step=73400 Epoch=143.2] | Loss=0.00785 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.538 | L2-Norm(final)=13.543 | 3893.9 samples/s | 60.8 steps/s
[Step=73450 Epoch=143.3] | Loss=0.00782 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.542 | L2-Norm(final)=13.547 | 3923.6 samples/s | 61.3 steps/s
[Step=73500 Epoch=143.4] | Loss=0.00781 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.545 | L2-Norm(final)=13.550 | 4247.9 samples/s | 66.4 steps/s
[Step=73550 Epoch=143.5] | Loss=0.00775 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.549 | L2-Norm(final)=13.553 | 1545.3 samples/s | 24.1 steps/s
[Step=73600 Epoch=143.5] | Loss=0.00762 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.552 | L2-Norm(final)=13.556 | 3951.6 samples/s | 61.7 steps/s
[Step=73650 Epoch=143.6] | Loss=0.00746 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.556 | L2-Norm(final)=13.559 | 3916.2 samples/s | 61.2 steps/s
[Step=73700 Epoch=143.7] | Loss=0.00743 | Reg=0.00091 | acc=0.9688 | L2-Norm=9.559 | L2-Norm(final)=13.562 | 3915.8 samples/s | 61.2 steps/s
[Step=73750 Epoch=143.8] | Loss=0.00736 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.562 | L2-Norm(final)=13.565 | 3932.2 samples/s | 61.4 steps/s
[Step=73800 Epoch=143.9] | Loss=0.00733 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.565 | L2-Norm(final)=13.568 | 3906.6 samples/s | 61.0 steps/s
[Step=73850 Epoch=144.0] | Loss=0.00729 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.568 | L2-Norm(final)=13.571 | 3947.2 samples/s | 61.7 steps/s
[Step=73900 Epoch=144.1] | Loss=0.00731 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.571 | L2-Norm(final)=13.573 | 3982.9 samples/s | 62.2 steps/s
[Step=73950 Epoch=144.2] | Loss=0.00731 | Reg=0.00092 | acc=0.9688 | L2-Norm=9.574 | L2-Norm(final)=13.576 | 3898.3 samples/s | 60.9 steps/s
[Step=74000 Epoch=144.3] | Loss=0.00737 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=13.578 | 3921.6 samples/s | 61.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step74000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=72001 Epoch=140.8] | Loss=0.01564 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.328 | L2-Norm(final)=13.563 | 3248.1 samples/s | 50.8 steps/s
[Step=72050 Epoch=140.9] | Loss=0.00982 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.340 | L2-Norm(final)=13.566 | 4224.1 samples/s | 66.0 steps/s
[Step=72100 Epoch=141.0] | Loss=0.00914 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.345 | L2-Norm(final)=13.572 | 4295.6 samples/s | 67.1 steps/s
[Step=72150 Epoch=141.1] | Loss=0.00857 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.349 | L2-Norm(final)=13.579 | 4332.0 samples/s | 67.7 steps/s
[Step=72200 Epoch=141.1] | Loss=0.00833 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.353 | L2-Norm(final)=13.585 | 4392.0 samples/s | 68.6 steps/s
[Step=72250 Epoch=141.2] | Loss=0.00832 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.357 | L2-Norm(final)=13.591 | 4391.7 samples/s | 68.6 steps/s
[Step=72300 Epoch=141.3] | Loss=0.00833 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.361 | L2-Norm(final)=13.598 | 4389.3 samples/s | 68.6 steps/s
[Step=72350 Epoch=141.4] | Loss=0.00847 | Reg=0.00088 | acc=0.9688 | L2-Norm=9.366 | L2-Norm(final)=13.604 | 4393.7 samples/s | 68.7 steps/s
[Step=72400 Epoch=141.5] | Loss=0.00833 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.371 | L2-Norm(final)=13.610 | 4382.6 samples/s | 68.5 steps/s
[Step=72450 Epoch=141.6] | Loss=0.00807 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.375 | L2-Norm(final)=13.616 | 4359.9 samples/s | 68.1 steps/s
[Step=72500 Epoch=141.7] | Loss=0.00799 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.380 | L2-Norm(final)=13.623 | 5523.7 samples/s | 86.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=72501 Epoch=141.7] | Loss=0.00108 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.424 | L2-Norm(final)=13.684 | 3255.9 samples/s | 50.9 steps/s
[Step=72550 Epoch=141.8] | Loss=0.00721 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.429 | L2-Norm(final)=13.688 | 3773.8 samples/s | 59.0 steps/s
[Step=72600 Epoch=141.9] | Loss=0.00755 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.436 | L2-Norm(final)=13.693 | 3955.1 samples/s | 61.8 steps/s
[Step=72650 Epoch=142.0] | Loss=0.00770 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.443 | L2-Norm(final)=13.698 | 3890.8 samples/s | 60.8 steps/s
[Step=72700 Epoch=142.1] | Loss=0.00789 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.449 | L2-Norm(final)=13.703 | 3948.2 samples/s | 61.7 steps/s
[Step=72750 Epoch=142.2] | Loss=0.00819 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.454 | L2-Norm(final)=13.707 | 3941.4 samples/s | 61.6 steps/s
[Step=72800 Epoch=142.3] | Loss=0.00814 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.459 | L2-Norm(final)=13.710 | 3933.9 samples/s | 61.5 steps/s
[Step=72850 Epoch=142.4] | Loss=0.00856 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.464 | L2-Norm(final)=13.713 | 3962.3 samples/s | 61.9 steps/s
[Step=72900 Epoch=142.5] | Loss=0.00859 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.469 | L2-Norm(final)=13.716 | 3945.2 samples/s | 61.6 steps/s
[Step=72950 Epoch=142.6] | Loss=0.00868 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.473 | L2-Norm(final)=13.720 | 3984.6 samples/s | 62.3 steps/s
[Step=73000 Epoch=142.7] | Loss=0.00855 | Reg=0.00090 | acc=0.9688 | L2-Norm=9.478 | L2-Norm(final)=13.723 | 4806.8 samples/s | 75.1 steps/s
[Step=73050 Epoch=142.8] | Loss=0.00842 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.483 | L2-Norm(final)=13.726 | 1486.4 samples/s | 23.2 steps/s
[Step=73100 Epoch=142.9] | Loss=0.00828 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.487 | L2-Norm(final)=13.730 | 3925.6 samples/s | 61.3 steps/s
[Step=73150 Epoch=143.0] | Loss=0.00799 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.491 | L2-Norm(final)=13.733 | 3901.9 samples/s | 61.0 steps/s
[Step=73200 Epoch=143.1] | Loss=0.00794 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.495 | L2-Norm(final)=13.736 | 3874.8 samples/s | 60.5 steps/s
[Step=73250 Epoch=143.2] | Loss=0.00797 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.499 | L2-Norm(final)=13.740 | 3908.0 samples/s | 61.1 steps/s
[Step=73300 Epoch=143.3] | Loss=0.00782 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.503 | L2-Norm(final)=13.743 | 3982.6 samples/s | 62.2 steps/s
[Step=73350 Epoch=143.4] | Loss=0.00765 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.507 | L2-Norm(final)=13.746 | 3935.6 samples/s | 61.5 steps/s
[Step=73400 Epoch=143.5] | Loss=0.00762 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.510 | L2-Norm(final)=13.749 | 3906.9 samples/s | 61.0 steps/s
[Step=73450 Epoch=143.6] | Loss=0.00766 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.514 | L2-Norm(final)=13.752 | 3904.4 samples/s | 61.0 steps/s
[Step=73500 Epoch=143.7] | Loss=0.00755 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.517 | L2-Norm(final)=13.754 | 4260.1 samples/s | 66.6 steps/s
[Step=73550 Epoch=143.8] | Loss=0.00743 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.520 | L2-Norm(final)=13.757 | 1602.2 samples/s | 25.0 steps/s
[Step=73600 Epoch=143.9] | Loss=0.00737 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.524 | L2-Norm(final)=13.760 | 3892.2 samples/s | 60.8 steps/s
[Step=73650 Epoch=144.0] | Loss=0.00744 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.527 | L2-Norm(final)=13.763 | 3894.7 samples/s | 60.9 steps/s
[Step=73700 Epoch=144.1] | Loss=0.00739 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.530 | L2-Norm(final)=13.766 | 3889.4 samples/s | 60.8 steps/s
[Step=73750 Epoch=144.2] | Loss=0.00738 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.534 | L2-Norm(final)=13.769 | 3916.5 samples/s | 61.2 steps/s
[Step=73800 Epoch=144.3] | Loss=0.00725 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.537 | L2-Norm(final)=13.771 | 3907.6 samples/s | 61.1 steps/s
[Step=73850 Epoch=144.4] | Loss=0.00719 | Reg=0.00091 | acc=0.9688 | L2-Norm=9.540 | L2-Norm(final)=13.774 | 3959.1 samples/s | 61.9 steps/s
[Step=73900 Epoch=144.5] | Loss=0.00715 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.543 | L2-Norm(final)=13.777 | 3953.6 samples/s | 61.8 steps/s
[Step=73950 Epoch=144.6] | Loss=0.00711 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.546 | L2-Norm(final)=13.780 | 3968.8 samples/s | 62.0 steps/s
[Step=74000 Epoch=144.7] | Loss=0.00704 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.549 | L2-Norm(final)=13.782 | 3943.3 samples/s | 61.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step74000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=72001 Epoch=275.9] | Loss=0.00004 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.328 | L2-Norm(final)=9.644 | 3062.3 samples/s | 47.8 steps/s
[Step=72050 Epoch=276.1] | Loss=0.00008 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.327 | L2-Norm(final)=9.649 | 4104.6 samples/s | 64.1 steps/s
[Step=72100 Epoch=276.3] | Loss=0.00006 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.327 | L2-Norm(final)=9.656 | 4086.7 samples/s | 63.9 steps/s
[Step=72150 Epoch=276.5] | Loss=0.00005 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.326 | L2-Norm(final)=9.662 | 4106.2 samples/s | 64.2 steps/s
[Step=72200 Epoch=276.6] | Loss=0.00005 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.325 | L2-Norm(final)=9.668 | 4088.7 samples/s | 63.9 steps/s
[Step=72250 Epoch=276.8] | Loss=0.00004 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.324 | L2-Norm(final)=9.673 | 5494.5 samples/s | 85.9 steps/s
[Step=72300 Epoch=277.0] | Loss=0.00004 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.322 | L2-Norm(final)=9.678 | 1517.0 samples/s | 23.7 steps/s
[Step=72350 Epoch=277.2] | Loss=0.00004 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.320 | L2-Norm(final)=9.682 | 4155.2 samples/s | 64.9 steps/s
[Step=72400 Epoch=277.4] | Loss=0.00003 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.317 | L2-Norm(final)=9.687 | 4100.0 samples/s | 64.1 steps/s
[Step=72450 Epoch=277.6] | Loss=0.00003 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.315 | L2-Norm(final)=9.690 | 4075.7 samples/s | 63.7 steps/s
[Step=72500 Epoch=277.8] | Loss=0.00003 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.312 | L2-Norm(final)=9.694 | 4616.9 samples/s | 72.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=72501 Epoch=277.8] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=9.729 | 3253.0 samples/s | 50.8 steps/s
[Step=72550 Epoch=278.0] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.278 | L2-Norm(final)=9.732 | 3581.1 samples/s | 56.0 steps/s
[Step=72600 Epoch=278.2] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.271 | L2-Norm(final)=9.735 | 3764.9 samples/s | 58.8 steps/s
[Step=72650 Epoch=278.4] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.265 | L2-Norm(final)=9.737 | 3724.3 samples/s | 58.2 steps/s
[Step=72700 Epoch=278.6] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.258 | L2-Norm(final)=9.740 | 3773.3 samples/s | 59.0 steps/s
[Step=72750 Epoch=278.8] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.250 | L2-Norm(final)=9.742 | 4683.3 samples/s | 73.2 steps/s
[Step=72800 Epoch=278.9] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.243 | L2-Norm(final)=9.744 | 1442.5 samples/s | 22.5 steps/s
[Step=72850 Epoch=279.1] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.236 | L2-Norm(final)=9.746 | 3723.8 samples/s | 58.2 steps/s
[Step=72900 Epoch=279.3] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.228 | L2-Norm(final)=9.748 | 3740.5 samples/s | 58.4 steps/s
[Step=72950 Epoch=279.5] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.220 | L2-Norm(final)=9.749 | 3730.6 samples/s | 58.3 steps/s
[Step=73000 Epoch=279.7] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.212 | L2-Norm(final)=9.751 | 4138.0 samples/s | 64.7 steps/s
[Step=73050 Epoch=279.9] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.204 | L2-Norm(final)=9.752 | 1472.4 samples/s | 23.0 steps/s
[Step=73100 Epoch=280.1] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.196 | L2-Norm(final)=9.754 | 3745.8 samples/s | 58.5 steps/s
[Step=73150 Epoch=280.3] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.188 | L2-Norm(final)=9.755 | 3705.9 samples/s | 57.9 steps/s
[Step=73200 Epoch=280.5] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.180 | L2-Norm(final)=9.757 | 3719.3 samples/s | 58.1 steps/s
[Step=73250 Epoch=280.7] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.171 | L2-Norm(final)=9.758 | 3711.3 samples/s | 58.0 steps/s
[Step=73300 Epoch=280.9] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.163 | L2-Norm(final)=9.760 | 1579.1 samples/s | 24.7 steps/s
[Step=73350 Epoch=281.1] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.155 | L2-Norm(final)=9.761 | 3791.9 samples/s | 59.2 steps/s
[Step=73400 Epoch=281.2] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.146 | L2-Norm(final)=9.763 | 3706.8 samples/s | 57.9 steps/s
[Step=73450 Epoch=281.4] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.137 | L2-Norm(final)=9.764 | 3676.8 samples/s | 57.4 steps/s
[Step=73500 Epoch=281.6] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.129 | L2-Norm(final)=9.765 | 3737.3 samples/s | 58.4 steps/s
[Step=73550 Epoch=281.8] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.120 | L2-Norm(final)=9.767 | 1565.9 samples/s | 24.5 steps/s
[Step=73600 Epoch=282.0] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.111 | L2-Norm(final)=9.768 | 3724.6 samples/s | 58.2 steps/s
[Step=73650 Epoch=282.2] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.102 | L2-Norm(final)=9.770 | 3773.0 samples/s | 59.0 steps/s
[Step=73700 Epoch=282.4] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.093 | L2-Norm(final)=9.771 | 3709.0 samples/s | 58.0 steps/s
[Step=73750 Epoch=282.6] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.084 | L2-Norm(final)=9.772 | 3699.1 samples/s | 57.8 steps/s
[Step=73800 Epoch=282.8] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.075 | L2-Norm(final)=9.774 | 5101.0 samples/s | 79.7 steps/s
[Step=73850 Epoch=283.0] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.066 | L2-Norm(final)=9.775 | 1422.0 samples/s | 22.2 steps/s
[Step=73900 Epoch=283.2] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.057 | L2-Norm(final)=9.777 | 3722.1 samples/s | 58.2 steps/s
[Step=73950 Epoch=283.4] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.047 | L2-Norm(final)=9.778 | 3727.5 samples/s | 58.2 steps/s
[Step=74000 Epoch=283.5] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.038 | L2-Norm(final)=9.780 | 3745.2 samples/s | 58.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step74000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=72001 Epoch=277.2] | Loss=0.00004 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.328 | L2-Norm(final)=10.036 | 3108.3 samples/s | 48.6 steps/s
[Step=72050 Epoch=277.3] | Loss=0.00009 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.328 | L2-Norm(final)=10.042 | 4098.5 samples/s | 64.0 steps/s
[Step=72100 Epoch=277.5] | Loss=0.00007 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.330 | L2-Norm(final)=10.050 | 4097.7 samples/s | 64.0 steps/s
[Step=72150 Epoch=277.7] | Loss=0.00007 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.329 | L2-Norm(final)=10.056 | 4103.1 samples/s | 64.1 steps/s
[Step=72200 Epoch=277.9] | Loss=0.00007 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.330 | L2-Norm(final)=10.062 | 4145.3 samples/s | 64.8 steps/s
[Step=72250 Epoch=278.1] | Loss=0.00006 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.332 | L2-Norm(final)=10.068 | 5458.4 samples/s | 85.3 steps/s
[Step=72300 Epoch=278.3] | Loss=0.00006 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.332 | L2-Norm(final)=10.074 | 1527.0 samples/s | 23.9 steps/s
[Step=72350 Epoch=278.5] | Loss=0.00005 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.332 | L2-Norm(final)=10.078 | 4120.1 samples/s | 64.4 steps/s
[Step=72400 Epoch=278.7] | Loss=0.00005 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=10.083 | 4171.4 samples/s | 65.2 steps/s
[Step=72450 Epoch=278.9] | Loss=0.00004 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.330 | L2-Norm(final)=10.087 | 4137.2 samples/s | 64.6 steps/s
[Step=72500 Epoch=279.1] | Loss=0.00004 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.328 | L2-Norm(final)=10.091 | 4752.3 samples/s | 74.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=72501 Epoch=279.1] | Loss=0.00002 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.311 | L2-Norm(final)=10.128 | 3210.8 samples/s | 50.2 steps/s
[Step=72550 Epoch=279.3] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.306 | L2-Norm(final)=10.129 | 3524.4 samples/s | 55.1 steps/s
[Step=72600 Epoch=279.5] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.298 | L2-Norm(final)=10.131 | 3746.6 samples/s | 58.5 steps/s
[Step=72650 Epoch=279.7] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.291 | L2-Norm(final)=10.133 | 3704.8 samples/s | 57.9 steps/s
[Step=72700 Epoch=279.9] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=10.136 | 3763.4 samples/s | 58.8 steps/s
[Step=72750 Epoch=280.0] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.277 | L2-Norm(final)=10.138 | 4693.0 samples/s | 73.3 steps/s
[Step=72800 Epoch=280.2] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.270 | L2-Norm(final)=10.140 | 1425.6 samples/s | 22.3 steps/s
[Step=72850 Epoch=280.4] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.262 | L2-Norm(final)=10.141 | 3684.3 samples/s | 57.6 steps/s
[Step=72900 Epoch=280.6] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.254 | L2-Norm(final)=10.143 | 3642.2 samples/s | 56.9 steps/s
[Step=72950 Epoch=280.8] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.247 | L2-Norm(final)=10.144 | 3746.7 samples/s | 58.5 steps/s
[Step=73000 Epoch=281.0] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.239 | L2-Norm(final)=10.145 | 4252.2 samples/s | 66.4 steps/s
[Step=73050 Epoch=281.2] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.230 | L2-Norm(final)=10.147 | 1525.8 samples/s | 23.8 steps/s
[Step=73100 Epoch=281.4] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.222 | L2-Norm(final)=10.148 | 3703.5 samples/s | 57.9 steps/s
[Step=73150 Epoch=281.6] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.214 | L2-Norm(final)=10.149 | 3649.9 samples/s | 57.0 steps/s
[Step=73200 Epoch=281.8] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.206 | L2-Norm(final)=10.150 | 3752.3 samples/s | 58.6 steps/s
[Step=73250 Epoch=282.0] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.197 | L2-Norm(final)=10.151 | 3735.8 samples/s | 58.4 steps/s
[Step=73300 Epoch=282.2] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.188 | L2-Norm(final)=10.153 | 1540.4 samples/s | 24.1 steps/s
[Step=73350 Epoch=282.4] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.180 | L2-Norm(final)=10.154 | 3731.4 samples/s | 58.3 steps/s
[Step=73400 Epoch=282.5] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.171 | L2-Norm(final)=10.155 | 3715.8 samples/s | 58.1 steps/s
[Step=73450 Epoch=282.7] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.162 | L2-Norm(final)=10.156 | 3676.2 samples/s | 57.4 steps/s
[Step=73500 Epoch=282.9] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.153 | L2-Norm(final)=10.157 | 3693.7 samples/s | 57.7 steps/s
[Step=73550 Epoch=283.1] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.144 | L2-Norm(final)=10.158 | 1584.6 samples/s | 24.8 steps/s
[Step=73600 Epoch=283.3] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.135 | L2-Norm(final)=10.159 | 3769.8 samples/s | 58.9 steps/s
[Step=73650 Epoch=283.5] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.126 | L2-Norm(final)=10.160 | 3711.7 samples/s | 58.0 steps/s
[Step=73700 Epoch=283.7] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.116 | L2-Norm(final)=10.161 | 3779.1 samples/s | 59.0 steps/s
[Step=73750 Epoch=283.9] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.107 | L2-Norm(final)=10.162 | 3664.8 samples/s | 57.3 steps/s
[Step=73800 Epoch=284.1] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.098 | L2-Norm(final)=10.163 | 5543.6 samples/s | 86.6 steps/s
[Step=73850 Epoch=284.3] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.088 | L2-Norm(final)=10.165 | 1362.8 samples/s | 21.3 steps/s
[Step=73900 Epoch=284.5] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.078 | L2-Norm(final)=10.166 | 3660.3 samples/s | 57.2 steps/s
[Step=73950 Epoch=284.7] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.069 | L2-Norm(final)=10.167 | 3688.2 samples/s | 57.6 steps/s
[Step=74000 Epoch=284.9] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.059 | L2-Norm(final)=10.168 | 3741.0 samples/s | 58.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step74000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05803 | acc=0.9695 | tpr=0.9710 | fpr=0.0337 | 3497.7 samples/s | 13.7 steps/s
Avg test loss: 0.06480, Avg test acc: 0.96686, Avg tpr: 0.96905, Avg fpr: 0.03794, total FA: 296

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06339 | acc=0.9702 | tpr=0.9779 | fpr=0.0463 | 3503.6 samples/s | 13.7 steps/s
Avg test loss: 0.06983, Avg test acc: 0.96807, Avg tpr: 0.97704, Avg fpr: 0.05166, total FA: 403

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.10221 | acc=0.3107 | tpr=0.0140 | fpr=0.0451 | 3522.8 samples/s | 13.8 steps/s
Avg test loss: 5.11378, Avg test acc: 0.30788, Avg tpr: 0.01387, Avg fpr: 0.04551, total FA: 355

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.68124 | acc=0.3162 | tpr=0.0194 | fpr=0.0391 | 3492.0 samples/s | 13.6 steps/s
Avg test loss: 4.69264, Avg test acc: 0.31353, Avg tpr: 0.01953, Avg fpr: 0.03987, total FA: 311

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.73059 | acc=0.1250 | tpr=0.8097 | fpr=0.8873 | 3533.9 samples/s | 13.8 steps/s
[Step= 100] | Loss=4.71548 | acc=0.1264 | tpr=0.8294 | fpr=0.8867 | 6943.9 samples/s | 27.1 steps/s
[Step= 150] | Loss=4.73022 | acc=0.1261 | tpr=0.8343 | fpr=0.8870 | 6682.6 samples/s | 26.1 steps/s
[Step= 200] | Loss=4.71373 | acc=0.1262 | tpr=0.8219 | fpr=0.8865 | 7153.9 samples/s | 27.9 steps/s
[Step= 250] | Loss=4.71567 | acc=0.1263 | tpr=0.8166 | fpr=0.8863 | 6709.2 samples/s | 26.2 steps/s
[Step= 300] | Loss=4.71849 | acc=0.1259 | tpr=0.8131 | fpr=0.8866 | 6809.0 samples/s | 26.6 steps/s
[Step= 350] | Loss=4.71385 | acc=0.1264 | tpr=0.8228 | fpr=0.8862 | 7038.8 samples/s | 27.5 steps/s
[Step= 400] | Loss=4.71114 | acc=0.1266 | tpr=0.8222 | fpr=0.8861 | 6885.3 samples/s | 26.9 steps/s
[Step= 450] | Loss=4.71771 | acc=0.1262 | tpr=0.8242 | fpr=0.8864 | 6623.2 samples/s | 25.9 steps/s
[Step= 500] | Loss=4.71885 | acc=0.1262 | tpr=0.8251 | fpr=0.8865 | 6896.5 samples/s | 26.9 steps/s
[Step= 550] | Loss=4.71867 | acc=0.1264 | tpr=0.8249 | fpr=0.8863 | 12456.2 samples/s | 48.7 steps/s
Avg test loss: 4.71954, Avg test acc: 0.12626, Avg tpr: 0.82409, Avg fpr: 0.88642, total FA: 123078

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.07521 | acc=0.1044 | tpr=0.8540 | fpr=0.9091 | 3501.9 samples/s | 13.7 steps/s
[Step= 100] | Loss=6.05566 | acc=0.1071 | tpr=0.8657 | fpr=0.9071 | 7012.0 samples/s | 27.4 steps/s
[Step= 150] | Loss=6.07100 | acc=0.1059 | tpr=0.8674 | fpr=0.9082 | 6818.5 samples/s | 26.6 steps/s
[Step= 200] | Loss=6.05670 | acc=0.1055 | tpr=0.8590 | fpr=0.9082 | 7113.5 samples/s | 27.8 steps/s
[Step= 250] | Loss=6.05870 | acc=0.1057 | tpr=0.8541 | fpr=0.9079 | 6667.8 samples/s | 26.0 steps/s
[Step= 300] | Loss=6.06213 | acc=0.1052 | tpr=0.8495 | fpr=0.9084 | 6932.6 samples/s | 27.1 steps/s
[Step= 350] | Loss=6.06059 | acc=0.1059 | tpr=0.8560 | fpr=0.9077 | 6804.2 samples/s | 26.6 steps/s
[Step= 400] | Loss=6.05674 | acc=0.1061 | tpr=0.8523 | fpr=0.9074 | 6786.5 samples/s | 26.5 steps/s
[Step= 450] | Loss=6.06503 | acc=0.1059 | tpr=0.8549 | fpr=0.9077 | 6862.8 samples/s | 26.8 steps/s
[Step= 500] | Loss=6.06513 | acc=0.1060 | tpr=0.8555 | fpr=0.9075 | 6767.6 samples/s | 26.4 steps/s
[Step= 550] | Loss=6.06504 | acc=0.1062 | tpr=0.8559 | fpr=0.9074 | 12813.1 samples/s | 50.1 steps/s
Avg test loss: 6.06595, Avg test acc: 0.10612, Avg tpr: 0.85578, Avg fpr: 0.90750, total FA: 126005

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10111 | acc=0.9825 | tpr=0.9381 | fpr=0.0167 | 3541.2 samples/s | 13.8 steps/s
[Step= 100] | Loss=0.10485 | acc=0.9822 | tpr=0.9574 | fpr=0.0173 | 6807.8 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.10721 | acc=0.9813 | tpr=0.9582 | fpr=0.0182 | 6703.2 samples/s | 26.2 steps/s
[Step= 200] | Loss=0.10786 | acc=0.9813 | tpr=0.9585 | fpr=0.0183 | 6862.6 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.10660 | acc=0.9817 | tpr=0.9555 | fpr=0.0178 | 7007.9 samples/s | 27.4 steps/s
[Step= 300] | Loss=0.10836 | acc=0.9814 | tpr=0.9542 | fpr=0.0181 | 6761.9 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.10818 | acc=0.9813 | tpr=0.9537 | fpr=0.0182 | 6719.1 samples/s | 26.2 steps/s
[Step= 400] | Loss=0.10955 | acc=0.9812 | tpr=0.9519 | fpr=0.0183 | 6658.7 samples/s | 26.0 steps/s
[Step= 450] | Loss=0.11172 | acc=0.9808 | tpr=0.9508 | fpr=0.0186 | 6883.3 samples/s | 26.9 steps/s
[Step= 500] | Loss=0.11136 | acc=0.9809 | tpr=0.9533 | fpr=0.0187 | 6864.8 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.11073 | acc=0.9810 | tpr=0.9530 | fpr=0.0185 | 12161.0 samples/s | 47.5 steps/s
Avg test loss: 0.11063, Avg test acc: 0.98099, Avg tpr: 0.95246, Avg fpr: 0.01849, total FA: 2567

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10618 | acc=0.9815 | tpr=0.9336 | fpr=0.0177 | 3483.2 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.11073 | acc=0.9811 | tpr=0.9552 | fpr=0.0184 | 6805.3 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.11296 | acc=0.9801 | tpr=0.9582 | fpr=0.0195 | 6927.3 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.11387 | acc=0.9801 | tpr=0.9585 | fpr=0.0195 | 6800.1 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.11288 | acc=0.9802 | tpr=0.9555 | fpr=0.0194 | 6971.2 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.11494 | acc=0.9798 | tpr=0.9556 | fpr=0.0198 | 6735.4 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.11462 | acc=0.9798 | tpr=0.9555 | fpr=0.0198 | 6886.7 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.11597 | acc=0.9796 | tpr=0.9540 | fpr=0.0200 | 6779.8 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.11824 | acc=0.9792 | tpr=0.9528 | fpr=0.0203 | 6703.1 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.11792 | acc=0.9793 | tpr=0.9555 | fpr=0.0203 | 6856.2 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.11717 | acc=0.9795 | tpr=0.9558 | fpr=0.0201 | 12580.8 samples/s | 49.1 steps/s
Avg test loss: 0.11713, Avg test acc: 0.97949, Avg tpr: 0.95563, Avg fpr: 0.02007, total FA: 2787

server round 37/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=74001 Epoch=144.3] | Loss=0.00893 | Reg=0.00084 | acc=0.9844 | L2-Norm=9.140 | L2-Norm(final)=13.650 | 2999.3 samples/s | 46.9 steps/s
[Step=74050 Epoch=144.4] | Loss=0.00806 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.148 | L2-Norm(final)=13.655 | 4591.6 samples/s | 71.7 steps/s
[Step=74100 Epoch=144.5] | Loss=0.00919 | Reg=0.00084 | acc=0.9844 | L2-Norm=9.157 | L2-Norm(final)=13.662 | 4405.3 samples/s | 68.8 steps/s
[Step=74150 Epoch=144.6] | Loss=0.00878 | Reg=0.00084 | acc=0.9844 | L2-Norm=9.165 | L2-Norm(final)=13.669 | 4430.5 samples/s | 69.2 steps/s
[Step=74200 Epoch=144.7] | Loss=0.00896 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.172 | L2-Norm(final)=13.675 | 4319.2 samples/s | 67.5 steps/s
[Step=74250 Epoch=144.8] | Loss=0.00885 | Reg=0.00084 | acc=0.9844 | L2-Norm=9.178 | L2-Norm(final)=13.682 | 4418.6 samples/s | 69.0 steps/s
[Step=74300 Epoch=144.9] | Loss=0.00875 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.184 | L2-Norm(final)=13.689 | 4495.6 samples/s | 70.2 steps/s
[Step=74350 Epoch=145.0] | Loss=0.00894 | Reg=0.00084 | acc=0.9844 | L2-Norm=9.190 | L2-Norm(final)=13.695 | 4300.7 samples/s | 67.2 steps/s
[Step=74400 Epoch=145.1] | Loss=0.00893 | Reg=0.00085 | acc=0.9688 | L2-Norm=9.196 | L2-Norm(final)=13.702 | 4471.6 samples/s | 69.9 steps/s
[Step=74450 Epoch=145.2] | Loss=0.00874 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.202 | L2-Norm(final)=13.708 | 4414.5 samples/s | 69.0 steps/s
[Step=74500 Epoch=145.3] | Loss=0.00857 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.208 | L2-Norm(final)=13.715 | 5471.3 samples/s | 85.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=74501 Epoch=145.3] | Loss=0.01485 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.264 | L2-Norm(final)=13.781 | 3332.3 samples/s | 52.1 steps/s
[Step=74550 Epoch=145.4] | Loss=0.00849 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.271 | L2-Norm(final)=13.789 | 3542.5 samples/s | 55.4 steps/s
[Step=74600 Epoch=145.5] | Loss=0.00902 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.280 | L2-Norm(final)=13.794 | 3904.8 samples/s | 61.0 steps/s
[Step=74650 Epoch=145.6] | Loss=0.00884 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.287 | L2-Norm(final)=13.799 | 3952.0 samples/s | 61.7 steps/s
[Step=74700 Epoch=145.7] | Loss=0.00873 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.295 | L2-Norm(final)=13.805 | 3947.4 samples/s | 61.7 steps/s
[Step=74750 Epoch=145.8] | Loss=0.00892 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.302 | L2-Norm(final)=13.810 | 3915.0 samples/s | 61.2 steps/s
[Step=74800 Epoch=145.9] | Loss=0.00911 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.309 | L2-Norm(final)=13.814 | 3956.2 samples/s | 61.8 steps/s
[Step=74850 Epoch=146.0] | Loss=0.00946 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.315 | L2-Norm(final)=13.818 | 3928.5 samples/s | 61.4 steps/s
[Step=74900 Epoch=146.1] | Loss=0.00953 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.321 | L2-Norm(final)=13.821 | 3957.6 samples/s | 61.8 steps/s
[Step=74950 Epoch=146.2] | Loss=0.00942 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.326 | L2-Norm(final)=13.825 | 3980.4 samples/s | 62.2 steps/s
[Step=75000 Epoch=146.3] | Loss=0.00933 | Reg=0.00087 | acc=0.9531 | L2-Norm=9.332 | L2-Norm(final)=13.828 | 4835.2 samples/s | 75.5 steps/s
[Step=75050 Epoch=146.4] | Loss=0.00929 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.337 | L2-Norm(final)=13.832 | 1485.9 samples/s | 23.2 steps/s
[Step=75100 Epoch=146.5] | Loss=0.00908 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.342 | L2-Norm(final)=13.835 | 3922.8 samples/s | 61.3 steps/s
[Step=75150 Epoch=146.6] | Loss=0.00883 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.347 | L2-Norm(final)=13.839 | 3965.5 samples/s | 62.0 steps/s
[Step=75200 Epoch=146.7] | Loss=0.00860 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.352 | L2-Norm(final)=13.843 | 3919.1 samples/s | 61.2 steps/s
[Step=75250 Epoch=146.8] | Loss=0.00852 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.356 | L2-Norm(final)=13.846 | 3935.3 samples/s | 61.5 steps/s
[Step=75300 Epoch=146.9] | Loss=0.00833 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.360 | L2-Norm(final)=13.850 | 3962.4 samples/s | 61.9 steps/s
[Step=75350 Epoch=147.0] | Loss=0.00837 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.365 | L2-Norm(final)=13.853 | 3922.9 samples/s | 61.3 steps/s
[Step=75400 Epoch=147.1] | Loss=0.00825 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.369 | L2-Norm(final)=13.857 | 3961.9 samples/s | 61.9 steps/s
[Step=75450 Epoch=147.2] | Loss=0.00818 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.373 | L2-Norm(final)=13.860 | 3942.0 samples/s | 61.6 steps/s
[Step=75500 Epoch=147.3] | Loss=0.00811 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.377 | L2-Norm(final)=13.863 | 4164.3 samples/s | 65.1 steps/s
[Step=75550 Epoch=147.4] | Loss=0.00803 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.380 | L2-Norm(final)=13.866 | 1566.6 samples/s | 24.5 steps/s
[Step=75600 Epoch=147.4] | Loss=0.00788 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.384 | L2-Norm(final)=13.870 | 3935.1 samples/s | 61.5 steps/s
[Step=75650 Epoch=147.5] | Loss=0.00785 | Reg=0.00088 | acc=0.9688 | L2-Norm=9.388 | L2-Norm(final)=13.873 | 3914.9 samples/s | 61.2 steps/s
[Step=75700 Epoch=147.6] | Loss=0.00769 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.392 | L2-Norm(final)=13.877 | 3973.9 samples/s | 62.1 steps/s
[Step=75750 Epoch=147.7] | Loss=0.00765 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.395 | L2-Norm(final)=13.880 | 3917.5 samples/s | 61.2 steps/s
[Step=75800 Epoch=147.8] | Loss=0.00752 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.399 | L2-Norm(final)=13.883 | 3948.3 samples/s | 61.7 steps/s
[Step=75850 Epoch=147.9] | Loss=0.00749 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.402 | L2-Norm(final)=13.886 | 3983.7 samples/s | 62.2 steps/s
[Step=75900 Epoch=148.0] | Loss=0.00749 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.405 | L2-Norm(final)=13.889 | 3980.1 samples/s | 62.2 steps/s
[Step=75950 Epoch=148.1] | Loss=0.00750 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.409 | L2-Norm(final)=13.893 | 3931.9 samples/s | 61.4 steps/s
[Step=76000 Epoch=148.2] | Loss=0.00746 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.412 | L2-Norm(final)=13.895 | 3943.5 samples/s | 61.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step76000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=74001 Epoch=144.7] | Loss=0.01102 | Reg=0.00084 | acc=0.9844 | L2-Norm=9.140 | L2-Norm(final)=13.863 | 3200.1 samples/s | 50.0 steps/s
[Step=74050 Epoch=144.8] | Loss=0.00845 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.151 | L2-Norm(final)=13.868 | 4445.0 samples/s | 69.5 steps/s
[Step=74100 Epoch=144.9] | Loss=0.00810 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.159 | L2-Norm(final)=13.876 | 4352.7 samples/s | 68.0 steps/s
[Step=74150 Epoch=145.0] | Loss=0.00900 | Reg=0.00084 | acc=0.9844 | L2-Norm=9.165 | L2-Norm(final)=13.883 | 4392.2 samples/s | 68.6 steps/s
[Step=74200 Epoch=145.1] | Loss=0.00900 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.170 | L2-Norm(final)=13.890 | 4326.2 samples/s | 67.6 steps/s
[Step=74250 Epoch=145.2] | Loss=0.00881 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.175 | L2-Norm(final)=13.897 | 4534.2 samples/s | 70.8 steps/s
[Step=74300 Epoch=145.3] | Loss=0.00880 | Reg=0.00084 | acc=0.9844 | L2-Norm=9.180 | L2-Norm(final)=13.903 | 4392.2 samples/s | 68.6 steps/s
[Step=74350 Epoch=145.4] | Loss=0.00902 | Reg=0.00084 | acc=0.9844 | L2-Norm=9.184 | L2-Norm(final)=13.910 | 4325.1 samples/s | 67.6 steps/s
[Step=74400 Epoch=145.5] | Loss=0.00896 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.189 | L2-Norm(final)=13.916 | 4450.2 samples/s | 69.5 steps/s
[Step=74450 Epoch=145.5] | Loss=0.00885 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.194 | L2-Norm(final)=13.922 | 4376.8 samples/s | 68.4 steps/s
[Step=74500 Epoch=145.6] | Loss=0.00885 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.198 | L2-Norm(final)=13.928 | 5631.7 samples/s | 88.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=74501 Epoch=145.6] | Loss=0.00107 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.244 | L2-Norm(final)=13.986 | 3279.6 samples/s | 51.2 steps/s
[Step=74550 Epoch=145.7] | Loss=0.00751 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.251 | L2-Norm(final)=13.992 | 3715.2 samples/s | 58.1 steps/s
[Step=74600 Epoch=145.8] | Loss=0.00938 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.258 | L2-Norm(final)=13.997 | 3938.3 samples/s | 61.5 steps/s
[Step=74650 Epoch=145.9] | Loss=0.00862 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.265 | L2-Norm(final)=14.001 | 3960.8 samples/s | 61.9 steps/s
[Step=74700 Epoch=146.0] | Loss=0.00887 | Reg=0.00086 | acc=0.9688 | L2-Norm=9.272 | L2-Norm(final)=14.006 | 3977.8 samples/s | 62.2 steps/s
[Step=74750 Epoch=146.1] | Loss=0.00862 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.278 | L2-Norm(final)=14.010 | 3932.5 samples/s | 61.4 steps/s
[Step=74800 Epoch=146.2] | Loss=0.00847 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=14.015 | 3925.6 samples/s | 61.3 steps/s
[Step=74850 Epoch=146.3] | Loss=0.00846 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.290 | L2-Norm(final)=14.019 | 3886.3 samples/s | 60.7 steps/s
[Step=74900 Epoch=146.4] | Loss=0.00844 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.296 | L2-Norm(final)=14.023 | 3937.1 samples/s | 61.5 steps/s
[Step=74950 Epoch=146.5] | Loss=0.00864 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.301 | L2-Norm(final)=14.027 | 3922.4 samples/s | 61.3 steps/s
[Step=75000 Epoch=146.6] | Loss=0.00863 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.306 | L2-Norm(final)=14.031 | 4933.5 samples/s | 77.1 steps/s
[Step=75050 Epoch=146.7] | Loss=0.00834 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.311 | L2-Norm(final)=14.035 | 1504.6 samples/s | 23.5 steps/s
[Step=75100 Epoch=146.8] | Loss=0.00813 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.316 | L2-Norm(final)=14.038 | 3901.7 samples/s | 61.0 steps/s
[Step=75150 Epoch=146.9] | Loss=0.00791 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.320 | L2-Norm(final)=14.042 | 3865.7 samples/s | 60.4 steps/s
[Step=75200 Epoch=147.0] | Loss=0.00800 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.325 | L2-Norm(final)=14.046 | 3917.9 samples/s | 61.2 steps/s
[Step=75250 Epoch=147.1] | Loss=0.00793 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.329 | L2-Norm(final)=14.049 | 3893.9 samples/s | 60.8 steps/s
[Step=75300 Epoch=147.2] | Loss=0.00794 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.333 | L2-Norm(final)=14.053 | 3951.5 samples/s | 61.7 steps/s
[Step=75350 Epoch=147.3] | Loss=0.00799 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.338 | L2-Norm(final)=14.056 | 3913.7 samples/s | 61.2 steps/s
[Step=75400 Epoch=147.4] | Loss=0.00784 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.342 | L2-Norm(final)=14.059 | 3971.4 samples/s | 62.1 steps/s
[Step=75450 Epoch=147.5] | Loss=0.00776 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.345 | L2-Norm(final)=14.063 | 3908.2 samples/s | 61.1 steps/s
[Step=75500 Epoch=147.6] | Loss=0.00761 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.349 | L2-Norm(final)=14.066 | 4237.5 samples/s | 66.2 steps/s
[Step=75550 Epoch=147.7] | Loss=0.00766 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.353 | L2-Norm(final)=14.069 | 1579.0 samples/s | 24.7 steps/s
[Step=75600 Epoch=147.8] | Loss=0.00754 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.356 | L2-Norm(final)=14.072 | 3953.0 samples/s | 61.8 steps/s
[Step=75650 Epoch=147.9] | Loss=0.00749 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.360 | L2-Norm(final)=14.075 | 3954.1 samples/s | 61.8 steps/s
[Step=75700 Epoch=148.0] | Loss=0.00744 | Reg=0.00088 | acc=0.9688 | L2-Norm=9.363 | L2-Norm(final)=14.078 | 3884.4 samples/s | 60.7 steps/s
[Step=75750 Epoch=148.1] | Loss=0.00734 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.367 | L2-Norm(final)=14.081 | 3917.6 samples/s | 61.2 steps/s
[Step=75800 Epoch=148.2] | Loss=0.00721 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.370 | L2-Norm(final)=14.084 | 3908.5 samples/s | 61.1 steps/s
[Step=75850 Epoch=148.3] | Loss=0.00714 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.373 | L2-Norm(final)=14.087 | 3933.7 samples/s | 61.5 steps/s
[Step=75900 Epoch=148.4] | Loss=0.00700 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.377 | L2-Norm(final)=14.091 | 3945.4 samples/s | 61.6 steps/s
[Step=75950 Epoch=148.5] | Loss=0.00701 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.380 | L2-Norm(final)=14.094 | 3920.6 samples/s | 61.3 steps/s
[Step=76000 Epoch=148.6] | Loss=0.00700 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.383 | L2-Norm(final)=14.097 | 3889.8 samples/s | 60.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step76000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=74001 Epoch=283.5] | Loss=0.00005 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.140 | L2-Norm(final)=9.825 | 3188.9 samples/s | 49.8 steps/s
[Step=74050 Epoch=283.7] | Loss=0.00007 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.140 | L2-Norm(final)=9.839 | 3911.8 samples/s | 61.1 steps/s
[Step=74100 Epoch=283.9] | Loss=0.00005 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.141 | L2-Norm(final)=9.853 | 4127.5 samples/s | 64.5 steps/s
[Step=74150 Epoch=284.1] | Loss=0.00004 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.138 | L2-Norm(final)=9.864 | 4120.5 samples/s | 64.4 steps/s
[Step=74200 Epoch=284.3] | Loss=0.00003 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.135 | L2-Norm(final)=9.873 | 4095.7 samples/s | 64.0 steps/s
[Step=74250 Epoch=284.5] | Loss=0.00003 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.131 | L2-Norm(final)=9.881 | 5514.5 samples/s | 86.2 steps/s
[Step=74300 Epoch=284.7] | Loss=0.00003 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.126 | L2-Norm(final)=9.888 | 1530.9 samples/s | 23.9 steps/s
[Step=74350 Epoch=284.9] | Loss=0.00002 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.121 | L2-Norm(final)=9.895 | 4072.3 samples/s | 63.6 steps/s
[Step=74400 Epoch=285.1] | Loss=0.00002 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.116 | L2-Norm(final)=9.902 | 4216.8 samples/s | 65.9 steps/s
[Step=74450 Epoch=285.3] | Loss=0.00002 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.111 | L2-Norm(final)=9.908 | 4064.9 samples/s | 63.5 steps/s
[Step=74500 Epoch=285.5] | Loss=0.00002 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.106 | L2-Norm(final)=9.914 | 4626.1 samples/s | 72.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=74501 Epoch=285.5] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.052 | L2-Norm(final)=9.970 | 3060.0 samples/s | 47.8 steps/s
[Step=74550 Epoch=285.6] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.040 | L2-Norm(final)=9.975 | 3756.2 samples/s | 58.7 steps/s
[Step=74600 Epoch=285.8] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.026 | L2-Norm(final)=9.980 | 3769.3 samples/s | 58.9 steps/s
[Step=74650 Epoch=286.0] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.011 | L2-Norm(final)=9.984 | 3722.7 samples/s | 58.2 steps/s
[Step=74700 Epoch=286.2] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.996 | L2-Norm(final)=9.987 | 3687.4 samples/s | 57.6 steps/s
[Step=74750 Epoch=286.4] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.981 | L2-Norm(final)=9.991 | 4747.2 samples/s | 74.2 steps/s
[Step=74800 Epoch=286.6] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.965 | L2-Norm(final)=9.994 | 1436.0 samples/s | 22.4 steps/s
[Step=74850 Epoch=286.8] | Loss=0.00000 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.949 | L2-Norm(final)=9.997 | 3733.5 samples/s | 58.3 steps/s
[Step=74900 Epoch=287.0] | Loss=0.00000 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.933 | L2-Norm(final)=10.000 | 3747.7 samples/s | 58.6 steps/s
[Step=74950 Epoch=287.2] | Loss=0.00000 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.917 | L2-Norm(final)=10.002 | 3746.1 samples/s | 58.5 steps/s
[Step=75000 Epoch=287.4] | Loss=0.00000 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.900 | L2-Norm(final)=10.005 | 4160.2 samples/s | 65.0 steps/s
[Step=75050 Epoch=287.6] | Loss=0.00000 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.884 | L2-Norm(final)=10.008 | 1554.0 samples/s | 24.3 steps/s
[Step=75100 Epoch=287.8] | Loss=0.00000 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.868 | L2-Norm(final)=10.010 | 3766.9 samples/s | 58.9 steps/s
[Step=75150 Epoch=287.9] | Loss=0.00000 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.851 | L2-Norm(final)=10.013 | 3729.3 samples/s | 58.3 steps/s
[Step=75200 Epoch=288.1] | Loss=0.00000 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.834 | L2-Norm(final)=10.015 | 3767.4 samples/s | 58.9 steps/s
[Step=75250 Epoch=288.3] | Loss=0.00000 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.818 | L2-Norm(final)=10.018 | 3718.0 samples/s | 58.1 steps/s
[Step=75300 Epoch=288.5] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.801 | L2-Norm(final)=10.021 | 1571.7 samples/s | 24.6 steps/s
[Step=75350 Epoch=288.7] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.784 | L2-Norm(final)=10.023 | 3795.5 samples/s | 59.3 steps/s
[Step=75400 Epoch=288.9] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.767 | L2-Norm(final)=10.026 | 3734.5 samples/s | 58.4 steps/s
[Step=75450 Epoch=289.1] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.750 | L2-Norm(final)=10.029 | 3714.8 samples/s | 58.0 steps/s
[Step=75500 Epoch=289.3] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.733 | L2-Norm(final)=10.032 | 3704.6 samples/s | 57.9 steps/s
[Step=75550 Epoch=289.5] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.716 | L2-Norm(final)=10.035 | 1587.5 samples/s | 24.8 steps/s
[Step=75600 Epoch=289.7] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.699 | L2-Norm(final)=10.037 | 3746.9 samples/s | 58.5 steps/s
[Step=75650 Epoch=289.9] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.682 | L2-Norm(final)=10.040 | 3727.1 samples/s | 58.2 steps/s
[Step=75700 Epoch=290.1] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.664 | L2-Norm(final)=10.043 | 3707.0 samples/s | 57.9 steps/s
[Step=75750 Epoch=290.2] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.647 | L2-Norm(final)=10.046 | 3762.2 samples/s | 58.8 steps/s
[Step=75800 Epoch=290.4] | Loss=0.00000 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.629 | L2-Norm(final)=10.049 | 5125.4 samples/s | 80.1 steps/s
[Step=75850 Epoch=290.6] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.612 | L2-Norm(final)=10.053 | 1458.3 samples/s | 22.8 steps/s
[Step=75900 Epoch=290.8] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.594 | L2-Norm(final)=10.056 | 3781.3 samples/s | 59.1 steps/s
[Step=75950 Epoch=291.0] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.576 | L2-Norm(final)=10.059 | 3735.3 samples/s | 58.4 steps/s
[Step=76000 Epoch=291.2] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.559 | L2-Norm(final)=10.062 | 3692.3 samples/s | 57.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step76000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=74001 Epoch=284.9] | Loss=0.00010 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.140 | L2-Norm(final)=10.203 | 3304.8 samples/s | 51.6 steps/s
[Step=74050 Epoch=285.0] | Loss=0.00006 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.140 | L2-Norm(final)=10.214 | 3832.9 samples/s | 59.9 steps/s
[Step=74100 Epoch=285.2] | Loss=0.00015 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.148 | L2-Norm(final)=10.223 | 4067.6 samples/s | 63.6 steps/s
[Step=74150 Epoch=285.4] | Loss=0.00012 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.158 | L2-Norm(final)=10.229 | 4091.2 samples/s | 63.9 steps/s
[Step=74200 Epoch=285.6] | Loss=0.00010 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.164 | L2-Norm(final)=10.234 | 4136.4 samples/s | 64.6 steps/s
[Step=74250 Epoch=285.8] | Loss=0.00008 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.166 | L2-Norm(final)=10.238 | 5541.1 samples/s | 86.6 steps/s
[Step=74300 Epoch=286.0] | Loss=0.00007 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.167 | L2-Norm(final)=10.241 | 1515.0 samples/s | 23.7 steps/s
[Step=74350 Epoch=286.2] | Loss=0.00006 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.166 | L2-Norm(final)=10.244 | 4089.9 samples/s | 63.9 steps/s
[Step=74400 Epoch=286.4] | Loss=0.00006 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.166 | L2-Norm(final)=10.246 | 4174.0 samples/s | 65.2 steps/s
[Step=74450 Epoch=286.6] | Loss=0.00005 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.164 | L2-Norm(final)=10.249 | 4080.9 samples/s | 63.8 steps/s
[Step=74500 Epoch=286.8] | Loss=0.00005 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.163 | L2-Norm(final)=10.251 | 4747.3 samples/s | 74.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=74501 Epoch=286.8] | Loss=0.00002 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.147 | L2-Norm(final)=10.272 | 3314.6 samples/s | 51.8 steps/s
[Step=74550 Epoch=287.0] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.138 | L2-Norm(final)=10.274 | 3401.4 samples/s | 53.1 steps/s
[Step=74600 Epoch=287.2] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.125 | L2-Norm(final)=10.275 | 3719.8 samples/s | 58.1 steps/s
[Step=74650 Epoch=287.4] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.112 | L2-Norm(final)=10.276 | 3746.1 samples/s | 58.5 steps/s
[Step=74700 Epoch=287.5] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.099 | L2-Norm(final)=10.277 | 3719.0 samples/s | 58.1 steps/s
[Step=74750 Epoch=287.7] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.086 | L2-Norm(final)=10.278 | 4784.3 samples/s | 74.8 steps/s
[Step=74800 Epoch=287.9] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.072 | L2-Norm(final)=10.279 | 1449.1 samples/s | 22.6 steps/s
[Step=74850 Epoch=288.1] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.058 | L2-Norm(final)=10.280 | 3657.0 samples/s | 57.1 steps/s
[Step=74900 Epoch=288.3] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.044 | L2-Norm(final)=10.281 | 3717.3 samples/s | 58.1 steps/s
[Step=74950 Epoch=288.5] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.029 | L2-Norm(final)=10.282 | 3706.4 samples/s | 57.9 steps/s
[Step=75000 Epoch=288.7] | Loss=0.00000 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.015 | L2-Norm(final)=10.282 | 4239.9 samples/s | 66.2 steps/s
[Step=75050 Epoch=288.9] | Loss=0.00000 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.000 | L2-Norm(final)=10.283 | 1486.5 samples/s | 23.2 steps/s
[Step=75100 Epoch=289.1] | Loss=0.00000 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.985 | L2-Norm(final)=10.283 | 3769.6 samples/s | 58.9 steps/s
[Step=75150 Epoch=289.3] | Loss=0.00000 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.970 | L2-Norm(final)=10.284 | 3722.6 samples/s | 58.2 steps/s
[Step=75200 Epoch=289.5] | Loss=0.00000 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.954 | L2-Norm(final)=10.285 | 3720.2 samples/s | 58.1 steps/s
[Step=75250 Epoch=289.7] | Loss=0.00000 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.939 | L2-Norm(final)=10.285 | 3774.7 samples/s | 59.0 steps/s
[Step=75300 Epoch=289.9] | Loss=0.00000 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.923 | L2-Norm(final)=10.286 | 1558.2 samples/s | 24.3 steps/s
[Step=75350 Epoch=290.1] | Loss=0.00000 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.907 | L2-Norm(final)=10.286 | 3739.7 samples/s | 58.4 steps/s
[Step=75400 Epoch=290.2] | Loss=0.00000 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.891 | L2-Norm(final)=10.287 | 3604.1 samples/s | 56.3 steps/s
[Step=75450 Epoch=290.4] | Loss=0.00000 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.875 | L2-Norm(final)=10.288 | 3733.4 samples/s | 58.3 steps/s
[Step=75500 Epoch=290.6] | Loss=0.00000 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.859 | L2-Norm(final)=10.288 | 3684.0 samples/s | 57.6 steps/s
[Step=75550 Epoch=290.8] | Loss=0.00000 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.842 | L2-Norm(final)=10.289 | 1634.7 samples/s | 25.5 steps/s
[Step=75600 Epoch=291.0] | Loss=0.00000 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.826 | L2-Norm(final)=10.289 | 3717.1 samples/s | 58.1 steps/s
[Step=75650 Epoch=291.2] | Loss=0.00000 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.809 | L2-Norm(final)=10.290 | 3743.4 samples/s | 58.5 steps/s
[Step=75700 Epoch=291.4] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.792 | L2-Norm(final)=10.291 | 3691.3 samples/s | 57.7 steps/s
[Step=75750 Epoch=291.6] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.775 | L2-Norm(final)=10.291 | 3707.2 samples/s | 57.9 steps/s
[Step=75800 Epoch=291.8] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.758 | L2-Norm(final)=10.292 | 5569.9 samples/s | 87.0 steps/s
[Step=75850 Epoch=292.0] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.740 | L2-Norm(final)=10.293 | 1394.0 samples/s | 21.8 steps/s
[Step=75900 Epoch=292.2] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.723 | L2-Norm(final)=10.294 | 3665.9 samples/s | 57.3 steps/s
[Step=75950 Epoch=292.4] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.705 | L2-Norm(final)=10.294 | 3703.4 samples/s | 57.9 steps/s
[Step=76000 Epoch=292.6] | Loss=0.00000 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.687 | L2-Norm(final)=10.295 | 3735.3 samples/s | 58.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step76000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06055 | acc=0.9701 | tpr=0.9723 | fpr=0.0347 | 3498.9 samples/s | 13.7 steps/s
Avg test loss: 0.06754, Avg test acc: 0.96739, Avg tpr: 0.96963, Avg fpr: 0.03756, total FA: 293

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05896 | acc=0.9705 | tpr=0.9767 | fpr=0.0429 | 3522.9 samples/s | 13.8 steps/s
Avg test loss: 0.06511, Avg test acc: 0.96767, Avg tpr: 0.97476, Avg fpr: 0.04794, total FA: 374

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.18691 | acc=0.3087 | tpr=0.0118 | fpr=0.0466 | 3455.7 samples/s | 13.5 steps/s
Avg test loss: 5.20088, Avg test acc: 0.30591, Avg tpr: 0.01195, Avg fpr: 0.04756, total FA: 371

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.79669 | acc=0.3155 | tpr=0.0187 | fpr=0.0399 | 3504.0 samples/s | 13.7 steps/s
Avg test loss: 4.81156, Avg test acc: 0.31297, Avg tpr: 0.01859, Avg fpr: 0.03961, total FA: 309

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.11869 | acc=0.1264 | tpr=0.8097 | fpr=0.8859 | 3532.5 samples/s | 13.8 steps/s
[Step= 100] | Loss=5.10497 | acc=0.1279 | tpr=0.8316 | fpr=0.8852 | 6657.0 samples/s | 26.0 steps/s
[Step= 150] | Loss=5.11659 | acc=0.1268 | tpr=0.8314 | fpr=0.8862 | 6785.2 samples/s | 26.5 steps/s
[Step= 200] | Loss=5.09913 | acc=0.1268 | tpr=0.8153 | fpr=0.8857 | 6859.8 samples/s | 26.8 steps/s
[Step= 250] | Loss=5.10149 | acc=0.1271 | tpr=0.8096 | fpr=0.8854 | 6793.4 samples/s | 26.5 steps/s
[Step= 300] | Loss=5.10390 | acc=0.1264 | tpr=0.8058 | fpr=0.8860 | 6918.0 samples/s | 27.0 steps/s
[Step= 350] | Loss=5.09958 | acc=0.1269 | tpr=0.8159 | fpr=0.8856 | 6796.6 samples/s | 26.5 steps/s
[Step= 400] | Loss=5.09607 | acc=0.1271 | tpr=0.8129 | fpr=0.8854 | 6797.6 samples/s | 26.6 steps/s
[Step= 450] | Loss=5.10338 | acc=0.1266 | tpr=0.8160 | fpr=0.8860 | 6801.4 samples/s | 26.6 steps/s
[Step= 500] | Loss=5.10463 | acc=0.1264 | tpr=0.8167 | fpr=0.8861 | 6731.9 samples/s | 26.3 steps/s
[Step= 550] | Loss=5.10481 | acc=0.1267 | tpr=0.8154 | fpr=0.8859 | 12324.0 samples/s | 48.1 steps/s
Avg test loss: 5.10595, Avg test acc: 0.12652, Avg tpr: 0.81498, Avg fpr: 0.88599, total FA: 123018

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.37850 | acc=0.1170 | tpr=0.8496 | fpr=0.8962 | 3527.4 samples/s | 13.8 steps/s
[Step= 100] | Loss=5.35727 | acc=0.1197 | tpr=0.8614 | fpr=0.8942 | 6711.4 samples/s | 26.2 steps/s
[Step= 150] | Loss=5.36890 | acc=0.1188 | tpr=0.8660 | fpr=0.8949 | 6855.5 samples/s | 26.8 steps/s
[Step= 200] | Loss=5.35486 | acc=0.1190 | tpr=0.8579 | fpr=0.8944 | 6882.0 samples/s | 26.9 steps/s
[Step= 250] | Loss=5.35534 | acc=0.1192 | tpr=0.8541 | fpr=0.8942 | 6992.3 samples/s | 27.3 steps/s
[Step= 300] | Loss=5.35859 | acc=0.1187 | tpr=0.8480 | fpr=0.8946 | 6673.2 samples/s | 26.1 steps/s
[Step= 350] | Loss=5.35677 | acc=0.1193 | tpr=0.8547 | fpr=0.8940 | 7127.5 samples/s | 27.8 steps/s
[Step= 400] | Loss=5.35275 | acc=0.1195 | tpr=0.8539 | fpr=0.8938 | 6686.0 samples/s | 26.1 steps/s
[Step= 450] | Loss=5.36065 | acc=0.1192 | tpr=0.8564 | fpr=0.8942 | 6692.2 samples/s | 26.1 steps/s
[Step= 500] | Loss=5.35961 | acc=0.1193 | tpr=0.8559 | fpr=0.8940 | 6751.6 samples/s | 26.4 steps/s
[Step= 550] | Loss=5.35969 | acc=0.1196 | tpr=0.8556 | fpr=0.8938 | 13070.2 samples/s | 51.1 steps/s
Avg test loss: 5.36070, Avg test acc: 0.11952, Avg tpr: 0.85539, Avg fpr: 0.89386, total FA: 124110

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09756 | acc=0.9826 | tpr=0.9381 | fpr=0.0166 | 3500.6 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.10134 | acc=0.9823 | tpr=0.9531 | fpr=0.0171 | 6955.6 samples/s | 27.2 steps/s
[Step= 150] | Loss=0.10372 | acc=0.9814 | tpr=0.9539 | fpr=0.0181 | 6950.3 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.10450 | acc=0.9815 | tpr=0.9552 | fpr=0.0180 | 6696.0 samples/s | 26.2 steps/s
[Step= 250] | Loss=0.10347 | acc=0.9818 | tpr=0.9511 | fpr=0.0177 | 7033.9 samples/s | 27.5 steps/s
[Step= 300] | Loss=0.10503 | acc=0.9815 | tpr=0.9505 | fpr=0.0179 | 6763.9 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.10498 | acc=0.9814 | tpr=0.9505 | fpr=0.0180 | 6896.7 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.10632 | acc=0.9812 | tpr=0.9475 | fpr=0.0182 | 6904.3 samples/s | 27.0 steps/s
[Step= 450] | Loss=0.10846 | acc=0.9808 | tpr=0.9460 | fpr=0.0185 | 6777.6 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.10811 | acc=0.9809 | tpr=0.9493 | fpr=0.0185 | 6832.0 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.10746 | acc=0.9811 | tpr=0.9495 | fpr=0.0183 | 12103.1 samples/s | 47.3 steps/s
Avg test loss: 0.10736, Avg test acc: 0.98111, Avg tpr: 0.94889, Avg fpr: 0.01831, total FA: 2542

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10337 | acc=0.9824 | tpr=0.9425 | fpr=0.0169 | 3468.8 samples/s | 13.5 steps/s
[Step= 100] | Loss=0.10844 | acc=0.9817 | tpr=0.9595 | fpr=0.0179 | 6717.1 samples/s | 26.2 steps/s
[Step= 150] | Loss=0.11045 | acc=0.9807 | tpr=0.9611 | fpr=0.0189 | 6846.1 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.11165 | acc=0.9805 | tpr=0.9596 | fpr=0.0191 | 6860.1 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.11077 | acc=0.9806 | tpr=0.9563 | fpr=0.0189 | 6856.4 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.11257 | acc=0.9802 | tpr=0.9549 | fpr=0.0193 | 6691.3 samples/s | 26.1 steps/s
[Step= 350] | Loss=0.11230 | acc=0.9802 | tpr=0.9555 | fpr=0.0194 | 6810.8 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.11363 | acc=0.9800 | tpr=0.9540 | fpr=0.0195 | 6776.0 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.11586 | acc=0.9797 | tpr=0.9533 | fpr=0.0199 | 6623.6 samples/s | 25.9 steps/s
[Step= 500] | Loss=0.11554 | acc=0.9797 | tpr=0.9555 | fpr=0.0198 | 6698.4 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.11479 | acc=0.9800 | tpr=0.9554 | fpr=0.0196 | 12176.5 samples/s | 47.6 steps/s
Avg test loss: 0.11475, Avg test acc: 0.97996, Avg tpr: 0.95523, Avg fpr: 0.01959, total FA: 2720

server round 38/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=76001 Epoch=148.2] | Loss=0.01237 | Reg=0.00076 | acc=0.9844 | L2-Norm=8.703 | L2-Norm(final)=13.983 | 3164.3 samples/s | 49.4 steps/s
[Step=76050 Epoch=148.3] | Loss=0.01219 | Reg=0.00076 | acc=0.9844 | L2-Norm=8.712 | L2-Norm(final)=13.991 | 4117.7 samples/s | 64.3 steps/s
[Step=76100 Epoch=148.4] | Loss=0.01283 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.724 | L2-Norm(final)=14.002 | 4300.4 samples/s | 67.2 steps/s
[Step=76150 Epoch=148.5] | Loss=0.01249 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.737 | L2-Norm(final)=14.010 | 4354.8 samples/s | 68.0 steps/s
[Step=76200 Epoch=148.6] | Loss=0.01164 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.746 | L2-Norm(final)=14.019 | 4436.3 samples/s | 69.3 steps/s
[Step=76250 Epoch=148.7] | Loss=0.01167 | Reg=0.00077 | acc=0.9844 | L2-Norm=8.755 | L2-Norm(final)=14.027 | 4299.6 samples/s | 67.2 steps/s
[Step=76300 Epoch=148.8] | Loss=0.01168 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.763 | L2-Norm(final)=14.034 | 4404.4 samples/s | 68.8 steps/s
[Step=76350 Epoch=148.9] | Loss=0.01148 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.771 | L2-Norm(final)=14.042 | 4378.0 samples/s | 68.4 steps/s
[Step=76400 Epoch=149.0] | Loss=0.01157 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.779 | L2-Norm(final)=14.049 | 4441.5 samples/s | 69.4 steps/s
[Step=76450 Epoch=149.1] | Loss=0.01155 | Reg=0.00077 | acc=0.9844 | L2-Norm=8.786 | L2-Norm(final)=14.056 | 4427.6 samples/s | 69.2 steps/s
[Step=76500 Epoch=149.2] | Loss=0.01149 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.792 | L2-Norm(final)=14.063 | 5485.5 samples/s | 85.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=76501 Epoch=149.2] | Loss=0.00257 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.857 | L2-Norm(final)=14.129 | 3008.4 samples/s | 47.0 steps/s
[Step=76550 Epoch=149.3] | Loss=0.01108 | Reg=0.00079 | acc=0.9688 | L2-Norm=8.867 | L2-Norm(final)=14.135 | 3837.3 samples/s | 60.0 steps/s
[Step=76600 Epoch=149.4] | Loss=0.01129 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.877 | L2-Norm(final)=14.141 | 3901.7 samples/s | 61.0 steps/s
[Step=76650 Epoch=149.5] | Loss=0.01161 | Reg=0.00079 | acc=0.9688 | L2-Norm=8.887 | L2-Norm(final)=14.147 | 3927.3 samples/s | 61.4 steps/s
[Step=76700 Epoch=149.6] | Loss=0.01074 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.897 | L2-Norm(final)=14.153 | 3912.5 samples/s | 61.1 steps/s
[Step=76750 Epoch=149.7] | Loss=0.01021 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.905 | L2-Norm(final)=14.160 | 3954.8 samples/s | 61.8 steps/s
[Step=76800 Epoch=149.8] | Loss=0.00982 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.913 | L2-Norm(final)=14.166 | 3915.8 samples/s | 61.2 steps/s
[Step=76850 Epoch=149.9] | Loss=0.01028 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.920 | L2-Norm(final)=14.171 | 3964.8 samples/s | 62.0 steps/s
[Step=76900 Epoch=150.0] | Loss=0.01067 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.927 | L2-Norm(final)=14.175 | 3944.7 samples/s | 61.6 steps/s
[Step=76950 Epoch=150.1] | Loss=0.01068 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.933 | L2-Norm(final)=14.180 | 3973.4 samples/s | 62.1 steps/s
[Step=77000 Epoch=150.2] | Loss=0.01062 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.939 | L2-Norm(final)=14.184 | 4789.6 samples/s | 74.8 steps/s
[Step=77050 Epoch=150.3] | Loss=0.01049 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.945 | L2-Norm(final)=14.188 | 1453.9 samples/s | 22.7 steps/s
[Step=77100 Epoch=150.4] | Loss=0.01031 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.951 | L2-Norm(final)=14.193 | 3930.9 samples/s | 61.4 steps/s
[Step=77150 Epoch=150.5] | Loss=0.01005 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.957 | L2-Norm(final)=14.197 | 3949.7 samples/s | 61.7 steps/s
[Step=77200 Epoch=150.6] | Loss=0.00986 | Reg=0.00080 | acc=0.9688 | L2-Norm=8.962 | L2-Norm(final)=14.201 | 3905.9 samples/s | 61.0 steps/s
[Step=77250 Epoch=150.7] | Loss=0.00974 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.967 | L2-Norm(final)=14.205 | 3964.9 samples/s | 62.0 steps/s
[Step=77300 Epoch=150.8] | Loss=0.00959 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.972 | L2-Norm(final)=14.209 | 3916.3 samples/s | 61.2 steps/s
[Step=77350 Epoch=150.9] | Loss=0.00949 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.977 | L2-Norm(final)=14.213 | 3961.8 samples/s | 61.9 steps/s
[Step=77400 Epoch=151.0] | Loss=0.00956 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.981 | L2-Norm(final)=14.216 | 4000.4 samples/s | 62.5 steps/s
[Step=77450 Epoch=151.1] | Loss=0.00961 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.986 | L2-Norm(final)=14.220 | 3929.9 samples/s | 61.4 steps/s
[Step=77500 Epoch=151.2] | Loss=0.00935 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.990 | L2-Norm(final)=14.224 | 4183.7 samples/s | 65.4 steps/s
[Step=77550 Epoch=151.3] | Loss=0.00916 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.995 | L2-Norm(final)=14.228 | 1567.8 samples/s | 24.5 steps/s
[Step=77600 Epoch=151.4] | Loss=0.00900 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.999 | L2-Norm(final)=14.231 | 3966.2 samples/s | 62.0 steps/s
[Step=77650 Epoch=151.4] | Loss=0.00892 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.003 | L2-Norm(final)=14.235 | 3940.9 samples/s | 61.6 steps/s
[Step=77700 Epoch=151.5] | Loss=0.00881 | Reg=0.00081 | acc=0.9688 | L2-Norm=9.007 | L2-Norm(final)=14.239 | 3944.7 samples/s | 61.6 steps/s
[Step=77750 Epoch=151.6] | Loss=0.00873 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.012 | L2-Norm(final)=14.242 | 3906.5 samples/s | 61.0 steps/s
[Step=77800 Epoch=151.7] | Loss=0.00863 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.016 | L2-Norm(final)=14.246 | 3950.6 samples/s | 61.7 steps/s
[Step=77850 Epoch=151.8] | Loss=0.00850 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.020 | L2-Norm(final)=14.250 | 3976.7 samples/s | 62.1 steps/s
[Step=77900 Epoch=151.9] | Loss=0.00849 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.024 | L2-Norm(final)=14.253 | 3968.8 samples/s | 62.0 steps/s
[Step=77950 Epoch=152.0] | Loss=0.00837 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.027 | L2-Norm(final)=14.257 | 3948.1 samples/s | 61.7 steps/s
[Step=78000 Epoch=152.1] | Loss=0.00836 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.031 | L2-Norm(final)=14.260 | 3971.7 samples/s | 62.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step78000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=76001 Epoch=148.6] | Loss=0.00665 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.703 | L2-Norm(final)=14.188 | 3366.2 samples/s | 52.6 steps/s
[Step=76050 Epoch=148.7] | Loss=0.01061 | Reg=0.00076 | acc=0.9844 | L2-Norm=8.712 | L2-Norm(final)=14.196 | 4063.7 samples/s | 63.5 steps/s
[Step=76100 Epoch=148.8] | Loss=0.01218 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.722 | L2-Norm(final)=14.204 | 4401.4 samples/s | 68.8 steps/s
[Step=76150 Epoch=148.9] | Loss=0.01237 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.729 | L2-Norm(final)=14.212 | 4358.6 samples/s | 68.1 steps/s
[Step=76200 Epoch=149.0] | Loss=0.01221 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.736 | L2-Norm(final)=14.221 | 4403.8 samples/s | 68.8 steps/s
[Step=76250 Epoch=149.1] | Loss=0.01139 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.743 | L2-Norm(final)=14.229 | 4401.4 samples/s | 68.8 steps/s
[Step=76300 Epoch=149.2] | Loss=0.01143 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.750 | L2-Norm(final)=14.238 | 4331.8 samples/s | 67.7 steps/s
[Step=76350 Epoch=149.3] | Loss=0.01128 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.756 | L2-Norm(final)=14.246 | 4498.9 samples/s | 70.3 steps/s
[Step=76400 Epoch=149.4] | Loss=0.01096 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.763 | L2-Norm(final)=14.255 | 4349.0 samples/s | 68.0 steps/s
[Step=76450 Epoch=149.5] | Loss=0.01095 | Reg=0.00077 | acc=0.9844 | L2-Norm=8.769 | L2-Norm(final)=14.263 | 4291.3 samples/s | 67.1 steps/s
[Step=76500 Epoch=149.6] | Loss=0.01060 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.775 | L2-Norm(final)=14.271 | 5570.1 samples/s | 87.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=76501 Epoch=149.6] | Loss=0.01164 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.836 | L2-Norm(final)=14.350 | 3175.9 samples/s | 49.6 steps/s
[Step=76550 Epoch=149.7] | Loss=0.01172 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.844 | L2-Norm(final)=14.358 | 3908.5 samples/s | 61.1 steps/s
[Step=76600 Epoch=149.8] | Loss=0.01090 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.853 | L2-Norm(final)=14.363 | 3902.4 samples/s | 61.0 steps/s
[Step=76650 Epoch=149.8] | Loss=0.01170 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.863 | L2-Norm(final)=14.369 | 3919.6 samples/s | 61.2 steps/s
[Step=76700 Epoch=149.9] | Loss=0.01154 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.872 | L2-Norm(final)=14.375 | 4012.4 samples/s | 62.7 steps/s
[Step=76750 Epoch=150.0] | Loss=0.01130 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.881 | L2-Norm(final)=14.381 | 3952.2 samples/s | 61.8 steps/s
[Step=76800 Epoch=150.1] | Loss=0.01142 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.889 | L2-Norm(final)=14.386 | 3938.5 samples/s | 61.5 steps/s
[Step=76850 Epoch=150.2] | Loss=0.01127 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.897 | L2-Norm(final)=14.391 | 3945.3 samples/s | 61.6 steps/s
[Step=76900 Epoch=150.3] | Loss=0.01097 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.904 | L2-Norm(final)=14.397 | 3955.4 samples/s | 61.8 steps/s
[Step=76950 Epoch=150.4] | Loss=0.01061 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.911 | L2-Norm(final)=14.402 | 3973.0 samples/s | 62.1 steps/s
[Step=77000 Epoch=150.5] | Loss=0.01026 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.918 | L2-Norm(final)=14.408 | 4973.8 samples/s | 77.7 steps/s
[Step=77050 Epoch=150.6] | Loss=0.00989 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.925 | L2-Norm(final)=14.413 | 1517.3 samples/s | 23.7 steps/s
[Step=77100 Epoch=150.7] | Loss=0.00961 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.931 | L2-Norm(final)=14.418 | 3881.3 samples/s | 60.6 steps/s
[Step=77150 Epoch=150.8] | Loss=0.00946 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.937 | L2-Norm(final)=14.422 | 3924.8 samples/s | 61.3 steps/s
[Step=77200 Epoch=150.9] | Loss=0.00938 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.942 | L2-Norm(final)=14.427 | 3918.2 samples/s | 61.2 steps/s
[Step=77250 Epoch=151.0] | Loss=0.00923 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.948 | L2-Norm(final)=14.431 | 3948.6 samples/s | 61.7 steps/s
[Step=77300 Epoch=151.1] | Loss=0.00909 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.953 | L2-Norm(final)=14.436 | 4002.3 samples/s | 62.5 steps/s
[Step=77350 Epoch=151.2] | Loss=0.00892 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.958 | L2-Norm(final)=14.440 | 3922.5 samples/s | 61.3 steps/s
[Step=77400 Epoch=151.3] | Loss=0.00877 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.963 | L2-Norm(final)=14.444 | 3937.5 samples/s | 61.5 steps/s
[Step=77450 Epoch=151.4] | Loss=0.00871 | Reg=0.00080 | acc=0.9688 | L2-Norm=8.968 | L2-Norm(final)=14.448 | 3966.1 samples/s | 62.0 steps/s
[Step=77500 Epoch=151.5] | Loss=0.00862 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.972 | L2-Norm(final)=14.452 | 4279.3 samples/s | 66.9 steps/s
[Step=77550 Epoch=151.6] | Loss=0.00857 | Reg=0.00081 | acc=0.9844 | L2-Norm=8.977 | L2-Norm(final)=14.456 | 1566.3 samples/s | 24.5 steps/s
[Step=77600 Epoch=151.7] | Loss=0.00846 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.981 | L2-Norm(final)=14.460 | 3956.3 samples/s | 61.8 steps/s
[Step=77650 Epoch=151.8] | Loss=0.00843 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.985 | L2-Norm(final)=14.463 | 3909.3 samples/s | 61.1 steps/s
[Step=77700 Epoch=151.9] | Loss=0.00839 | Reg=0.00081 | acc=0.9844 | L2-Norm=8.989 | L2-Norm(final)=14.467 | 3978.1 samples/s | 62.2 steps/s
[Step=77750 Epoch=152.0] | Loss=0.00826 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.993 | L2-Norm(final)=14.470 | 3942.1 samples/s | 61.6 steps/s
[Step=77800 Epoch=152.1] | Loss=0.00822 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.997 | L2-Norm(final)=14.474 | 3969.1 samples/s | 62.0 steps/s
[Step=77850 Epoch=152.2] | Loss=0.00811 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.001 | L2-Norm(final)=14.477 | 3949.2 samples/s | 61.7 steps/s
[Step=77900 Epoch=152.3] | Loss=0.00797 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.005 | L2-Norm(final)=14.480 | 4021.6 samples/s | 62.8 steps/s
[Step=77950 Epoch=152.4] | Loss=0.00789 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.008 | L2-Norm(final)=14.484 | 3970.0 samples/s | 62.0 steps/s
[Step=78000 Epoch=152.5] | Loss=0.00784 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.012 | L2-Norm(final)=14.487 | 3935.4 samples/s | 61.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step78000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=76001 Epoch=291.2] | Loss=0.00007 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.703 | L2-Norm(final)=10.164 | 3178.0 samples/s | 49.7 steps/s
[Step=76050 Epoch=291.4] | Loss=0.00009 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.714 | L2-Norm(final)=10.182 | 4026.8 samples/s | 62.9 steps/s
[Step=76100 Epoch=291.6] | Loss=0.00005 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.715 | L2-Norm(final)=10.196 | 4131.9 samples/s | 64.6 steps/s
[Step=76150 Epoch=291.8] | Loss=0.00004 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.712 | L2-Norm(final)=10.207 | 4027.5 samples/s | 62.9 steps/s
[Step=76200 Epoch=292.0] | Loss=0.00003 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.707 | L2-Norm(final)=10.216 | 4151.6 samples/s | 64.9 steps/s
[Step=76250 Epoch=292.2] | Loss=0.00003 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.702 | L2-Norm(final)=10.224 | 5436.4 samples/s | 84.9 steps/s
[Step=76300 Epoch=292.4] | Loss=0.00003 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.695 | L2-Norm(final)=10.231 | 1481.0 samples/s | 23.1 steps/s
[Step=76350 Epoch=292.5] | Loss=0.00002 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.689 | L2-Norm(final)=10.237 | 4194.8 samples/s | 65.5 steps/s
[Step=76400 Epoch=292.7] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.683 | L2-Norm(final)=10.243 | 3992.5 samples/s | 62.4 steps/s
[Step=76450 Epoch=292.9] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.676 | L2-Norm(final)=10.249 | 4047.3 samples/s | 63.2 steps/s
[Step=76500 Epoch=293.1] | Loss=0.00002 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.670 | L2-Norm(final)=10.255 | 4635.3 samples/s | 72.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=76501 Epoch=293.1] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.610 | L2-Norm(final)=10.315 | 3351.9 samples/s | 52.4 steps/s
[Step=76550 Epoch=293.3] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.591 | L2-Norm(final)=10.321 | 3397.2 samples/s | 53.1 steps/s
[Step=76600 Epoch=293.5] | Loss=0.00001 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.566 | L2-Norm(final)=10.326 | 3721.0 samples/s | 58.1 steps/s
[Step=76650 Epoch=293.7] | Loss=0.00001 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.539 | L2-Norm(final)=10.330 | 3722.5 samples/s | 58.2 steps/s
[Step=76700 Epoch=293.9] | Loss=0.00001 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.511 | L2-Norm(final)=10.333 | 3766.9 samples/s | 58.9 steps/s
[Step=76750 Epoch=294.1] | Loss=0.00001 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.483 | L2-Norm(final)=10.336 | 4543.0 samples/s | 71.0 steps/s
[Step=76800 Epoch=294.3] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.455 | L2-Norm(final)=10.339 | 1437.4 samples/s | 22.5 steps/s
[Step=76850 Epoch=294.5] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.426 | L2-Norm(final)=10.341 | 3707.0 samples/s | 57.9 steps/s
[Step=76900 Epoch=294.7] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.397 | L2-Norm(final)=10.344 | 3662.6 samples/s | 57.2 steps/s
[Step=76950 Epoch=294.8] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.368 | L2-Norm(final)=10.346 | 3692.7 samples/s | 57.7 steps/s
[Step=77000 Epoch=295.0] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.339 | L2-Norm(final)=10.349 | 4089.8 samples/s | 63.9 steps/s
[Step=77050 Epoch=295.2] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.310 | L2-Norm(final)=10.351 | 1550.7 samples/s | 24.2 steps/s
[Step=77100 Epoch=295.4] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.280 | L2-Norm(final)=10.354 | 3789.8 samples/s | 59.2 steps/s
[Step=77150 Epoch=295.6] | Loss=0.00000 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.251 | L2-Norm(final)=10.356 | 3717.5 samples/s | 58.1 steps/s
[Step=77200 Epoch=295.8] | Loss=0.00000 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.222 | L2-Norm(final)=10.359 | 3743.9 samples/s | 58.5 steps/s
[Step=77250 Epoch=296.0] | Loss=0.00000 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.192 | L2-Norm(final)=10.361 | 3735.8 samples/s | 58.4 steps/s
[Step=77300 Epoch=296.2] | Loss=0.00000 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.163 | L2-Norm(final)=10.364 | 1568.7 samples/s | 24.5 steps/s
[Step=77350 Epoch=296.4] | Loss=0.00000 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.134 | L2-Norm(final)=10.367 | 3749.8 samples/s | 58.6 steps/s
[Step=77400 Epoch=296.6] | Loss=0.00000 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.105 | L2-Norm(final)=10.370 | 3708.2 samples/s | 57.9 steps/s
[Step=77450 Epoch=296.8] | Loss=0.00000 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.076 | L2-Norm(final)=10.373 | 3735.4 samples/s | 58.4 steps/s
[Step=77500 Epoch=297.0] | Loss=0.00000 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.046 | L2-Norm(final)=10.376 | 3731.9 samples/s | 58.3 steps/s
[Step=77550 Epoch=297.1] | Loss=0.00000 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.018 | L2-Norm(final)=10.380 | 1576.0 samples/s | 24.6 steps/s
[Step=77600 Epoch=297.3] | Loss=0.00000 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.988 | L2-Norm(final)=10.383 | 3717.2 samples/s | 58.1 steps/s
[Step=77650 Epoch=297.5] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.959 | L2-Norm(final)=10.386 | 3772.9 samples/s | 59.0 steps/s
[Step=77700 Epoch=297.7] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.930 | L2-Norm(final)=10.390 | 3732.2 samples/s | 58.3 steps/s
[Step=77750 Epoch=297.9] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.901 | L2-Norm(final)=10.393 | 3692.4 samples/s | 57.7 steps/s
[Step=77800 Epoch=298.1] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.872 | L2-Norm(final)=10.397 | 5130.6 samples/s | 80.2 steps/s
[Step=77850 Epoch=298.3] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.843 | L2-Norm(final)=10.401 | 1423.9 samples/s | 22.2 steps/s
[Step=77900 Epoch=298.5] | Loss=0.00000 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.814 | L2-Norm(final)=10.405 | 3704.2 samples/s | 57.9 steps/s
[Step=77950 Epoch=298.7] | Loss=0.00000 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.785 | L2-Norm(final)=10.409 | 3745.4 samples/s | 58.5 steps/s
[Step=78000 Epoch=298.9] | Loss=0.00000 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.757 | L2-Norm(final)=10.413 | 3694.3 samples/s | 57.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step78000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=76001 Epoch=292.6] | Loss=0.00004 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.703 | L2-Norm(final)=10.318 | 3334.1 samples/s | 52.1 steps/s
[Step=76050 Epoch=292.7] | Loss=0.00010 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.704 | L2-Norm(final)=10.331 | 3855.9 samples/s | 60.2 steps/s
[Step=76100 Epoch=292.9] | Loss=0.00008 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.710 | L2-Norm(final)=10.344 | 4141.6 samples/s | 64.7 steps/s
[Step=76150 Epoch=293.1] | Loss=0.00006 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.712 | L2-Norm(final)=10.354 | 4158.0 samples/s | 65.0 steps/s
[Step=76200 Epoch=293.3] | Loss=0.00005 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.712 | L2-Norm(final)=10.361 | 4078.9 samples/s | 63.7 steps/s
[Step=76250 Epoch=293.5] | Loss=0.00004 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.711 | L2-Norm(final)=10.368 | 5616.3 samples/s | 87.8 steps/s
[Step=76300 Epoch=293.7] | Loss=0.00004 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.710 | L2-Norm(final)=10.375 | 1503.3 samples/s | 23.5 steps/s
[Step=76350 Epoch=293.9] | Loss=0.00004 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.708 | L2-Norm(final)=10.381 | 4130.6 samples/s | 64.5 steps/s
[Step=76400 Epoch=294.1] | Loss=0.00003 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.706 | L2-Norm(final)=10.387 | 4082.1 samples/s | 63.8 steps/s
[Step=76450 Epoch=294.3] | Loss=0.00003 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.704 | L2-Norm(final)=10.392 | 4186.4 samples/s | 65.4 steps/s
[Step=76500 Epoch=294.5] | Loss=0.00003 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.702 | L2-Norm(final)=10.397 | 4780.4 samples/s | 74.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=76501 Epoch=294.5] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.676 | L2-Norm(final)=10.447 | 3167.0 samples/s | 49.5 steps/s
[Step=76550 Epoch=294.7] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.659 | L2-Norm(final)=10.451 | 3615.4 samples/s | 56.5 steps/s
[Step=76600 Epoch=294.9] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.633 | L2-Norm(final)=10.454 | 3791.7 samples/s | 59.2 steps/s
[Step=76650 Epoch=295.1] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.606 | L2-Norm(final)=10.456 | 3667.9 samples/s | 57.3 steps/s
[Step=76700 Epoch=295.2] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.581 | L2-Norm(final)=10.459 | 3804.4 samples/s | 59.4 steps/s
[Step=76750 Epoch=295.4] | Loss=0.00001 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.555 | L2-Norm(final)=10.462 | 4787.5 samples/s | 74.8 steps/s
[Step=76800 Epoch=295.6] | Loss=0.00001 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.530 | L2-Norm(final)=10.464 | 1450.4 samples/s | 22.7 steps/s
[Step=76850 Epoch=295.8] | Loss=0.00001 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.503 | L2-Norm(final)=10.466 | 3731.1 samples/s | 58.3 steps/s
[Step=76900 Epoch=296.0] | Loss=0.00001 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.476 | L2-Norm(final)=10.467 | 3768.2 samples/s | 58.9 steps/s
[Step=76950 Epoch=296.2] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.449 | L2-Norm(final)=10.469 | 3748.9 samples/s | 58.6 steps/s
[Step=77000 Epoch=296.4] | Loss=0.00000 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.421 | L2-Norm(final)=10.470 | 4210.7 samples/s | 65.8 steps/s
[Step=77050 Epoch=296.6] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.394 | L2-Norm(final)=10.472 | 1542.4 samples/s | 24.1 steps/s
[Step=77100 Epoch=296.8] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.366 | L2-Norm(final)=10.473 | 3747.3 samples/s | 58.6 steps/s
[Step=77150 Epoch=297.0] | Loss=0.00000 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.338 | L2-Norm(final)=10.474 | 3706.6 samples/s | 57.9 steps/s
[Step=77200 Epoch=297.2] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.309 | L2-Norm(final)=10.476 | 3711.0 samples/s | 58.0 steps/s
[Step=77250 Epoch=297.4] | Loss=0.00000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.281 | L2-Norm(final)=10.477 | 3777.9 samples/s | 59.0 steps/s
[Step=77300 Epoch=297.6] | Loss=0.00000 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.253 | L2-Norm(final)=10.479 | 1604.9 samples/s | 25.1 steps/s
[Step=77350 Epoch=297.8] | Loss=0.00000 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.224 | L2-Norm(final)=10.480 | 3782.4 samples/s | 59.1 steps/s
[Step=77400 Epoch=297.9] | Loss=0.00000 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.196 | L2-Norm(final)=10.482 | 3747.9 samples/s | 58.6 steps/s
[Step=77450 Epoch=298.1] | Loss=0.00000 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.167 | L2-Norm(final)=10.483 | 3750.0 samples/s | 58.6 steps/s
[Step=77500 Epoch=298.3] | Loss=0.00000 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.138 | L2-Norm(final)=10.485 | 3701.1 samples/s | 57.8 steps/s
[Step=77550 Epoch=298.5] | Loss=0.00000 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.109 | L2-Norm(final)=10.486 | 1623.3 samples/s | 25.4 steps/s
[Step=77600 Epoch=298.7] | Loss=0.00000 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.081 | L2-Norm(final)=10.488 | 3706.5 samples/s | 57.9 steps/s
[Step=77650 Epoch=298.9] | Loss=0.00000 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.052 | L2-Norm(final)=10.490 | 3718.6 samples/s | 58.1 steps/s
[Step=77700 Epoch=299.1] | Loss=0.00000 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.023 | L2-Norm(final)=10.492 | 3809.4 samples/s | 59.5 steps/s
[Step=77750 Epoch=299.3] | Loss=0.00000 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.994 | L2-Norm(final)=10.494 | 3728.7 samples/s | 58.3 steps/s
[Step=77800 Epoch=299.5] | Loss=0.00000 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.965 | L2-Norm(final)=10.496 | 5448.4 samples/s | 85.1 steps/s
[Step=77850 Epoch=299.7] | Loss=0.00002 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.937 | L2-Norm(final)=10.498 | 1384.1 samples/s | 21.6 steps/s
[Step=77900 Epoch=299.9] | Loss=0.00007 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.911 | L2-Norm(final)=10.500 | 3713.9 samples/s | 58.0 steps/s
[Step=77950 Epoch=300.1] | Loss=0.00007 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.889 | L2-Norm(final)=10.501 | 3757.3 samples/s | 58.7 steps/s
[Step=78000 Epoch=300.3] | Loss=0.00008 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.867 | L2-Norm(final)=10.503 | 3760.6 samples/s | 58.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step78000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06054 | acc=0.9702 | tpr=0.9800 | fpr=0.0513 | 3520.6 samples/s | 13.8 steps/s
Avg test loss: 0.06685, Avg test acc: 0.96803, Avg tpr: 0.97768, Avg fpr: 0.05320, total FA: 415

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05967 | acc=0.9701 | tpr=0.9747 | fpr=0.0399 | 3504.9 samples/s | 13.7 steps/s
Avg test loss: 0.06520, Avg test acc: 0.96835, Avg tpr: 0.97406, Avg fpr: 0.04423, total FA: 345

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.22734 | acc=0.3071 | tpr=0.0118 | fpr=0.0515 | 3467.1 samples/s | 13.5 steps/s
Avg test loss: 5.24415, Avg test acc: 0.30367, Avg tpr: 0.01177, Avg fpr: 0.05435, total FA: 424

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=3.99533 | acc=0.3177 | tpr=0.0153 | fpr=0.0258 | 3486.7 samples/s | 13.6 steps/s
Avg test loss: 4.01040, Avg test acc: 0.31469, Avg tpr: 0.01527, Avg fpr: 0.02679, total FA: 209

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.44837 | acc=0.1116 | tpr=0.8673 | fpr=0.9019 | 3458.2 samples/s | 13.5 steps/s
[Step= 100] | Loss=5.42231 | acc=0.1134 | tpr=0.8849 | fpr=0.9010 | 7013.3 samples/s | 27.4 steps/s
[Step= 150] | Loss=5.43044 | acc=0.1120 | tpr=0.8890 | fpr=0.9023 | 7016.4 samples/s | 27.4 steps/s
[Step= 200] | Loss=5.41397 | acc=0.1121 | tpr=0.8831 | fpr=0.9019 | 5521.0 samples/s | 21.6 steps/s
[Step= 250] | Loss=5.41905 | acc=0.1118 | tpr=0.8751 | fpr=0.9021 | 6812.6 samples/s | 26.6 steps/s
[Step= 300] | Loss=5.42160 | acc=0.1112 | tpr=0.8705 | fpr=0.9026 | 6929.4 samples/s | 27.1 steps/s
[Step= 350] | Loss=5.41768 | acc=0.1117 | tpr=0.8754 | fpr=0.9022 | 6708.6 samples/s | 26.2 steps/s
[Step= 400] | Loss=5.41489 | acc=0.1119 | tpr=0.8747 | fpr=0.9020 | 4711.0 samples/s | 18.4 steps/s
[Step= 450] | Loss=5.42119 | acc=0.1113 | tpr=0.8754 | fpr=0.9025 | 6822.0 samples/s | 26.6 steps/s
[Step= 500] | Loss=5.42162 | acc=0.1113 | tpr=0.8767 | fpr=0.9026 | 6583.5 samples/s | 25.7 steps/s
[Step= 550] | Loss=5.42187 | acc=0.1115 | tpr=0.8770 | fpr=0.9024 | 12718.6 samples/s | 49.7 steps/s
Avg test loss: 5.42264, Avg test acc: 0.11142, Avg tpr: 0.87678, Avg fpr: 0.90250, total FA: 125310

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.41440 | acc=0.1170 | tpr=0.8407 | fpr=0.8960 | 3509.8 samples/s | 13.7 steps/s
[Step= 100] | Loss=5.39425 | acc=0.1183 | tpr=0.8486 | fpr=0.8953 | 6845.9 samples/s | 26.7 steps/s
[Step= 150] | Loss=5.40910 | acc=0.1171 | tpr=0.8516 | fpr=0.8964 | 6731.2 samples/s | 26.3 steps/s
[Step= 200] | Loss=5.39219 | acc=0.1174 | tpr=0.8404 | fpr=0.8958 | 5874.5 samples/s | 22.9 steps/s
[Step= 250] | Loss=5.39442 | acc=0.1176 | tpr=0.8341 | fpr=0.8954 | 7097.6 samples/s | 27.7 steps/s
[Step= 300] | Loss=5.39680 | acc=0.1170 | tpr=0.8298 | fpr=0.8960 | 6753.5 samples/s | 26.4 steps/s
[Step= 350] | Loss=5.39406 | acc=0.1177 | tpr=0.8378 | fpr=0.8954 | 5756.8 samples/s | 22.5 steps/s
[Step= 400] | Loss=5.38953 | acc=0.1179 | tpr=0.8337 | fpr=0.8951 | 5324.1 samples/s | 20.8 steps/s
[Step= 450] | Loss=5.39717 | acc=0.1176 | tpr=0.8359 | fpr=0.8954 | 6734.5 samples/s | 26.3 steps/s
[Step= 500] | Loss=5.39684 | acc=0.1176 | tpr=0.8352 | fpr=0.8953 | 6710.0 samples/s | 26.2 steps/s
[Step= 550] | Loss=5.39654 | acc=0.1178 | tpr=0.8361 | fpr=0.8952 | 12654.3 samples/s | 49.4 steps/s
Avg test loss: 5.39749, Avg test acc: 0.11771, Avg tpr: 0.83558, Avg fpr: 0.89534, total FA: 124316

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09542 | acc=0.9826 | tpr=0.9425 | fpr=0.0167 | 3473.9 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.10046 | acc=0.9821 | tpr=0.9552 | fpr=0.0174 | 6783.1 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.10339 | acc=0.9813 | tpr=0.9553 | fpr=0.0182 | 6628.4 samples/s | 25.9 steps/s
[Step= 200] | Loss=0.10448 | acc=0.9813 | tpr=0.9563 | fpr=0.0183 | 7016.1 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.10345 | acc=0.9816 | tpr=0.9528 | fpr=0.0179 | 6612.8 samples/s | 25.8 steps/s
[Step= 300] | Loss=0.10506 | acc=0.9813 | tpr=0.9505 | fpr=0.0181 | 6711.4 samples/s | 26.2 steps/s
[Step= 350] | Loss=0.10522 | acc=0.9813 | tpr=0.9512 | fpr=0.0182 | 4457.1 samples/s | 17.4 steps/s
[Step= 400] | Loss=0.10661 | acc=0.9810 | tpr=0.9475 | fpr=0.0184 | 6746.3 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.10882 | acc=0.9806 | tpr=0.9464 | fpr=0.0188 | 6514.0 samples/s | 25.4 steps/s
[Step= 500] | Loss=0.10853 | acc=0.9806 | tpr=0.9489 | fpr=0.0188 | 7215.5 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.10779 | acc=0.9808 | tpr=0.9483 | fpr=0.0186 | 11155.3 samples/s | 43.6 steps/s
Avg test loss: 0.10767, Avg test acc: 0.98077, Avg tpr: 0.94770, Avg fpr: 0.01863, total FA: 2587

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09804 | acc=0.9809 | tpr=0.9381 | fpr=0.0184 | 3483.9 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.10275 | acc=0.9800 | tpr=0.9595 | fpr=0.0196 | 6841.1 samples/s | 26.7 steps/s
[Step= 150] | Loss=0.10689 | acc=0.9788 | tpr=0.9611 | fpr=0.0209 | 6676.5 samples/s | 26.1 steps/s
[Step= 200] | Loss=0.10833 | acc=0.9786 | tpr=0.9607 | fpr=0.0211 | 6816.0 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.10747 | acc=0.9785 | tpr=0.9563 | fpr=0.0211 | 6709.2 samples/s | 26.2 steps/s
[Step= 300] | Loss=0.10957 | acc=0.9780 | tpr=0.9535 | fpr=0.0216 | 7053.8 samples/s | 27.6 steps/s
[Step= 350] | Loss=0.10938 | acc=0.9779 | tpr=0.9543 | fpr=0.0217 | 4284.9 samples/s | 16.7 steps/s
[Step= 400] | Loss=0.11057 | acc=0.9777 | tpr=0.9524 | fpr=0.0219 | 6632.5 samples/s | 25.9 steps/s
[Step= 450] | Loss=0.11294 | acc=0.9772 | tpr=0.9513 | fpr=0.0223 | 6720.5 samples/s | 26.3 steps/s
[Step= 500] | Loss=0.11263 | acc=0.9772 | tpr=0.9537 | fpr=0.0223 | 6762.0 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.11172 | acc=0.9774 | tpr=0.9522 | fpr=0.0222 | 12616.5 samples/s | 49.3 steps/s
Avg test loss: 0.11166, Avg test acc: 0.97740, Avg tpr: 0.95206, Avg fpr: 0.02214, total FA: 3074

server round 39/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=78001 Epoch=152.1] | Loss=0.04912 | Reg=0.00064 | acc=0.9688 | L2-Norm=7.980 | L2-Norm(final)=14.362 | 2948.5 samples/s | 46.1 steps/s
[Step=78050 Epoch=152.2] | Loss=0.02268 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.999 | L2-Norm(final)=14.375 | 4425.2 samples/s | 69.1 steps/s
[Step=78100 Epoch=152.3] | Loss=0.02223 | Reg=0.00064 | acc=0.9844 | L2-Norm=8.017 | L2-Norm(final)=14.393 | 4491.3 samples/s | 70.2 steps/s
[Step=78150 Epoch=152.4] | Loss=0.02103 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.033 | L2-Norm(final)=14.409 | 4288.1 samples/s | 67.0 steps/s
[Step=78200 Epoch=152.5] | Loss=0.02042 | Reg=0.00065 | acc=0.9844 | L2-Norm=8.048 | L2-Norm(final)=14.424 | 4368.8 samples/s | 68.3 steps/s
[Step=78250 Epoch=152.6] | Loss=0.02009 | Reg=0.00065 | acc=0.9844 | L2-Norm=8.062 | L2-Norm(final)=14.438 | 4381.5 samples/s | 68.5 steps/s
[Step=78300 Epoch=152.7] | Loss=0.01974 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.075 | L2-Norm(final)=14.450 | 4396.1 samples/s | 68.7 steps/s
[Step=78350 Epoch=152.8] | Loss=0.01976 | Reg=0.00065 | acc=0.9844 | L2-Norm=8.088 | L2-Norm(final)=14.462 | 4346.4 samples/s | 67.9 steps/s
[Step=78400 Epoch=152.9] | Loss=0.01944 | Reg=0.00066 | acc=0.9531 | L2-Norm=8.101 | L2-Norm(final)=14.474 | 4357.1 samples/s | 68.1 steps/s
[Step=78450 Epoch=153.0] | Loss=0.01927 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.113 | L2-Norm(final)=14.485 | 4356.0 samples/s | 68.1 steps/s
[Step=78500 Epoch=153.1] | Loss=0.01895 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.124 | L2-Norm(final)=14.495 | 5589.9 samples/s | 87.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=78501 Epoch=153.1] | Loss=0.01963 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.236 | L2-Norm(final)=14.597 | 3142.8 samples/s | 49.1 steps/s
[Step=78550 Epoch=153.2] | Loss=0.01738 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.250 | L2-Norm(final)=14.606 | 3746.5 samples/s | 58.5 steps/s
[Step=78600 Epoch=153.3] | Loss=0.01641 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.264 | L2-Norm(final)=14.613 | 3907.8 samples/s | 61.1 steps/s
[Step=78650 Epoch=153.4] | Loss=0.01574 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.278 | L2-Norm(final)=14.621 | 3947.9 samples/s | 61.7 steps/s
[Step=78700 Epoch=153.5] | Loss=0.01487 | Reg=0.00069 | acc=0.9844 | L2-Norm=8.291 | L2-Norm(final)=14.628 | 3914.8 samples/s | 61.2 steps/s
[Step=78750 Epoch=153.6] | Loss=0.01482 | Reg=0.00069 | acc=0.9688 | L2-Norm=8.303 | L2-Norm(final)=14.634 | 3949.6 samples/s | 61.7 steps/s
[Step=78800 Epoch=153.7] | Loss=0.01515 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.314 | L2-Norm(final)=14.640 | 3967.6 samples/s | 62.0 steps/s
[Step=78850 Epoch=153.8] | Loss=0.01539 | Reg=0.00069 | acc=0.9844 | L2-Norm=8.325 | L2-Norm(final)=14.646 | 3952.3 samples/s | 61.8 steps/s
[Step=78900 Epoch=153.9] | Loss=0.01541 | Reg=0.00069 | acc=0.9688 | L2-Norm=8.336 | L2-Norm(final)=14.651 | 3920.7 samples/s | 61.3 steps/s
[Step=78950 Epoch=154.0] | Loss=0.01507 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.345 | L2-Norm(final)=14.657 | 3945.4 samples/s | 61.6 steps/s
[Step=79000 Epoch=154.1] | Loss=0.01474 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.355 | L2-Norm(final)=14.662 | 4786.4 samples/s | 74.8 steps/s
[Step=79050 Epoch=154.2] | Loss=0.01410 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.364 | L2-Norm(final)=14.667 | 1533.6 samples/s | 24.0 steps/s
[Step=79100 Epoch=154.3] | Loss=0.01361 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.372 | L2-Norm(final)=14.672 | 3871.8 samples/s | 60.5 steps/s
[Step=79150 Epoch=154.4] | Loss=0.01334 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.380 | L2-Norm(final)=14.677 | 3917.8 samples/s | 61.2 steps/s
[Step=79200 Epoch=154.5] | Loss=0.01299 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.388 | L2-Norm(final)=14.681 | 3888.5 samples/s | 60.8 steps/s
[Step=79250 Epoch=154.6] | Loss=0.01276 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.395 | L2-Norm(final)=14.686 | 3919.1 samples/s | 61.2 steps/s
[Step=79300 Epoch=154.7] | Loss=0.01232 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.402 | L2-Norm(final)=14.690 | 3941.5 samples/s | 61.6 steps/s
[Step=79350 Epoch=154.8] | Loss=0.01224 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.409 | L2-Norm(final)=14.695 | 3929.0 samples/s | 61.4 steps/s
[Step=79400 Epoch=154.9] | Loss=0.01204 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.415 | L2-Norm(final)=14.699 | 3905.5 samples/s | 61.0 steps/s
[Step=79450 Epoch=155.0] | Loss=0.01196 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.422 | L2-Norm(final)=14.704 | 3944.2 samples/s | 61.6 steps/s
[Step=79500 Epoch=155.1] | Loss=0.01184 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.428 | L2-Norm(final)=14.708 | 4171.8 samples/s | 65.2 steps/s
[Step=79550 Epoch=155.2] | Loss=0.01163 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.434 | L2-Norm(final)=14.712 | 1554.3 samples/s | 24.3 steps/s
[Step=79600 Epoch=155.3] | Loss=0.01145 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.439 | L2-Norm(final)=14.716 | 3998.4 samples/s | 62.5 steps/s
[Step=79650 Epoch=155.3] | Loss=0.01131 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.445 | L2-Norm(final)=14.720 | 3942.9 samples/s | 61.6 steps/s
[Step=79700 Epoch=155.4] | Loss=0.01125 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.451 | L2-Norm(final)=14.723 | 3946.0 samples/s | 61.7 steps/s
[Step=79750 Epoch=155.5] | Loss=0.01114 | Reg=0.00072 | acc=0.9844 | L2-Norm=8.456 | L2-Norm(final)=14.727 | 3960.0 samples/s | 61.9 steps/s
[Step=79800 Epoch=155.6] | Loss=0.01092 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.462 | L2-Norm(final)=14.731 | 3914.7 samples/s | 61.2 steps/s
[Step=79850 Epoch=155.7] | Loss=0.01074 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.467 | L2-Norm(final)=14.735 | 3965.5 samples/s | 62.0 steps/s
[Step=79900 Epoch=155.8] | Loss=0.01056 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.472 | L2-Norm(final)=14.738 | 3937.5 samples/s | 61.5 steps/s
[Step=79950 Epoch=155.9] | Loss=0.01054 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.477 | L2-Norm(final)=14.742 | 3978.6 samples/s | 62.2 steps/s
[Step=80000 Epoch=156.0] | Loss=0.01047 | Reg=0.00072 | acc=0.9844 | L2-Norm=8.482 | L2-Norm(final)=14.745 | 3948.6 samples/s | 61.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step80000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=78001 Epoch=152.5] | Loss=0.01716 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.980 | L2-Norm(final)=14.586 | 3476.9 samples/s | 54.3 steps/s
[Step=78050 Epoch=152.6] | Loss=0.02034 | Reg=0.00064 | acc=0.9844 | L2-Norm=8.000 | L2-Norm(final)=14.602 | 3850.2 samples/s | 60.2 steps/s
[Step=78100 Epoch=152.7] | Loss=0.01996 | Reg=0.00064 | acc=0.9844 | L2-Norm=8.017 | L2-Norm(final)=14.620 | 4371.7 samples/s | 68.3 steps/s
[Step=78150 Epoch=152.8] | Loss=0.02017 | Reg=0.00065 | acc=0.9844 | L2-Norm=8.031 | L2-Norm(final)=14.636 | 4396.2 samples/s | 68.7 steps/s
[Step=78200 Epoch=152.9] | Loss=0.01963 | Reg=0.00065 | acc=0.9688 | L2-Norm=8.045 | L2-Norm(final)=14.650 | 4395.3 samples/s | 68.7 steps/s
[Step=78250 Epoch=153.0] | Loss=0.01962 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.057 | L2-Norm(final)=14.663 | 4464.9 samples/s | 69.8 steps/s
[Step=78300 Epoch=153.1] | Loss=0.01913 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.069 | L2-Norm(final)=14.676 | 4331.2 samples/s | 67.7 steps/s
[Step=78350 Epoch=153.2] | Loss=0.01862 | Reg=0.00065 | acc=0.9844 | L2-Norm=8.081 | L2-Norm(final)=14.689 | 4341.3 samples/s | 67.8 steps/s
[Step=78400 Epoch=153.3] | Loss=0.01854 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.093 | L2-Norm(final)=14.701 | 4404.2 samples/s | 68.8 steps/s
[Step=78450 Epoch=153.4] | Loss=0.01840 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.104 | L2-Norm(final)=14.712 | 4377.5 samples/s | 68.4 steps/s
[Step=78500 Epoch=153.5] | Loss=0.01830 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.115 | L2-Norm(final)=14.723 | 5722.9 samples/s | 89.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=78501 Epoch=153.5] | Loss=0.00439 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.222 | L2-Norm(final)=14.831 | 3231.5 samples/s | 50.5 steps/s
[Step=78550 Epoch=153.6] | Loss=0.01782 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.237 | L2-Norm(final)=14.840 | 3846.6 samples/s | 60.1 steps/s
[Step=78600 Epoch=153.7] | Loss=0.01821 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.256 | L2-Norm(final)=14.848 | 3927.4 samples/s | 61.4 steps/s
[Step=78650 Epoch=153.8] | Loss=0.01703 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.273 | L2-Norm(final)=14.855 | 3953.8 samples/s | 61.8 steps/s
[Step=78700 Epoch=153.9] | Loss=0.01580 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.287 | L2-Norm(final)=14.862 | 3956.0 samples/s | 61.8 steps/s
[Step=78750 Epoch=154.0] | Loss=0.01562 | Reg=0.00069 | acc=0.9844 | L2-Norm=8.298 | L2-Norm(final)=14.869 | 3951.0 samples/s | 61.7 steps/s
[Step=78800 Epoch=154.1] | Loss=0.01553 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.309 | L2-Norm(final)=14.875 | 3961.7 samples/s | 61.9 steps/s
[Step=78850 Epoch=154.1] | Loss=0.01515 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.319 | L2-Norm(final)=14.881 | 3974.4 samples/s | 62.1 steps/s
[Step=78900 Epoch=154.2] | Loss=0.01487 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.328 | L2-Norm(final)=14.887 | 3934.7 samples/s | 61.5 steps/s
[Step=78950 Epoch=154.3] | Loss=0.01459 | Reg=0.00070 | acc=0.9688 | L2-Norm=8.337 | L2-Norm(final)=14.892 | 4052.7 samples/s | 63.3 steps/s
[Step=79000 Epoch=154.4] | Loss=0.01415 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.346 | L2-Norm(final)=14.898 | 4841.6 samples/s | 75.6 steps/s
[Step=79050 Epoch=154.5] | Loss=0.01380 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.354 | L2-Norm(final)=14.903 | 1496.2 samples/s | 23.4 steps/s
[Step=79100 Epoch=154.6] | Loss=0.01338 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.361 | L2-Norm(final)=14.908 | 3940.8 samples/s | 61.6 steps/s
[Step=79150 Epoch=154.7] | Loss=0.01279 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.369 | L2-Norm(final)=14.913 | 3930.3 samples/s | 61.4 steps/s
[Step=79200 Epoch=154.8] | Loss=0.01269 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.376 | L2-Norm(final)=14.918 | 3928.9 samples/s | 61.4 steps/s
[Step=79250 Epoch=154.9] | Loss=0.01256 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.383 | L2-Norm(final)=14.923 | 3995.0 samples/s | 62.4 steps/s
[Step=79300 Epoch=155.0] | Loss=0.01239 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.389 | L2-Norm(final)=14.928 | 3942.9 samples/s | 61.6 steps/s
[Step=79350 Epoch=155.1] | Loss=0.01212 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.395 | L2-Norm(final)=14.932 | 3907.2 samples/s | 61.1 steps/s
[Step=79400 Epoch=155.2] | Loss=0.01191 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.402 | L2-Norm(final)=14.936 | 3954.6 samples/s | 61.8 steps/s
[Step=79450 Epoch=155.3] | Loss=0.01175 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.408 | L2-Norm(final)=14.941 | 3959.2 samples/s | 61.9 steps/s
[Step=79500 Epoch=155.4] | Loss=0.01156 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.413 | L2-Norm(final)=14.945 | 4296.1 samples/s | 67.1 steps/s
[Step=79550 Epoch=155.5] | Loss=0.01140 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.419 | L2-Norm(final)=14.949 | 1603.2 samples/s | 25.0 steps/s
[Step=79600 Epoch=155.6] | Loss=0.01118 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.425 | L2-Norm(final)=14.953 | 3918.2 samples/s | 61.2 steps/s
[Step=79650 Epoch=155.7] | Loss=0.01089 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.430 | L2-Norm(final)=14.958 | 3903.8 samples/s | 61.0 steps/s
[Step=79700 Epoch=155.8] | Loss=0.01073 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.436 | L2-Norm(final)=14.962 | 3945.3 samples/s | 61.6 steps/s
[Step=79750 Epoch=155.9] | Loss=0.01060 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.441 | L2-Norm(final)=14.966 | 3929.4 samples/s | 61.4 steps/s
[Step=79800 Epoch=156.0] | Loss=0.01054 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.446 | L2-Norm(final)=14.970 | 3937.7 samples/s | 61.5 steps/s
[Step=79850 Epoch=156.1] | Loss=0.01054 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.451 | L2-Norm(final)=14.974 | 3878.1 samples/s | 60.6 steps/s
[Step=79900 Epoch=156.2] | Loss=0.01040 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.456 | L2-Norm(final)=14.978 | 3966.5 samples/s | 62.0 steps/s
[Step=79950 Epoch=156.3] | Loss=0.01031 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.461 | L2-Norm(final)=14.982 | 3908.6 samples/s | 61.1 steps/s
[Step=80000 Epoch=156.4] | Loss=0.01021 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.466 | L2-Norm(final)=14.986 | 3932.1 samples/s | 61.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step80000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=78001 Epoch=298.9] | Loss=0.00012 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.980 | L2-Norm(final)=10.540 | 3195.0 samples/s | 49.9 steps/s
[Step=78050 Epoch=299.1] | Loss=0.00025 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.997 | L2-Norm(final)=10.566 | 3830.5 samples/s | 59.9 steps/s
[Step=78100 Epoch=299.3] | Loss=0.00015 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.006 | L2-Norm(final)=10.580 | 4140.1 samples/s | 64.7 steps/s
[Step=78150 Epoch=299.4] | Loss=0.00010 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.007 | L2-Norm(final)=10.590 | 4113.8 samples/s | 64.3 steps/s
[Step=78200 Epoch=299.6] | Loss=0.00008 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.005 | L2-Norm(final)=10.599 | 4056.8 samples/s | 63.4 steps/s
[Step=78250 Epoch=299.8] | Loss=0.00007 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.003 | L2-Norm(final)=10.606 | 5366.5 samples/s | 83.9 steps/s
[Step=78300 Epoch=300.0] | Loss=0.00006 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.000 | L2-Norm(final)=10.613 | 1507.2 samples/s | 23.5 steps/s
[Step=78350 Epoch=300.2] | Loss=0.00005 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.996 | L2-Norm(final)=10.619 | 4074.5 samples/s | 63.7 steps/s
[Step=78400 Epoch=300.4] | Loss=0.00005 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.993 | L2-Norm(final)=10.626 | 4103.1 samples/s | 64.1 steps/s
[Step=78450 Epoch=300.6] | Loss=0.00004 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.990 | L2-Norm(final)=10.632 | 4110.7 samples/s | 64.2 steps/s
[Step=78500 Epoch=300.8] | Loss=0.00004 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.986 | L2-Norm(final)=10.638 | 4630.0 samples/s | 72.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=78501 Epoch=300.8] | Loss=0.00006 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.949 | L2-Norm(final)=10.694 | 3074.2 samples/s | 48.0 steps/s
[Step=78550 Epoch=301.0] | Loss=0.00011 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.944 | L2-Norm(final)=10.702 | 3625.7 samples/s | 56.7 steps/s
[Step=78600 Epoch=301.2] | Loss=0.00078 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.972 | L2-Norm(final)=10.707 | 3737.5 samples/s | 58.4 steps/s
[Step=78650 Epoch=301.4] | Loss=0.00093 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.994 | L2-Norm(final)=10.705 | 3730.9 samples/s | 58.3 steps/s
[Step=78700 Epoch=301.6] | Loss=0.00076 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.009 | L2-Norm(final)=10.704 | 3679.5 samples/s | 57.5 steps/s
[Step=78750 Epoch=301.7] | Loss=0.00061 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.018 | L2-Norm(final)=10.704 | 4691.0 samples/s | 73.3 steps/s
[Step=78800 Epoch=301.9] | Loss=0.00065 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.024 | L2-Norm(final)=10.704 | 1452.6 samples/s | 22.7 steps/s
[Step=78850 Epoch=302.1] | Loss=0.00067 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.029 | L2-Norm(final)=10.704 | 3663.6 samples/s | 57.2 steps/s
[Step=78900 Epoch=302.3] | Loss=0.00060 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.033 | L2-Norm(final)=10.704 | 3760.0 samples/s | 58.7 steps/s
[Step=78950 Epoch=302.5] | Loss=0.00053 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.037 | L2-Norm(final)=10.704 | 3707.1 samples/s | 57.9 steps/s
[Step=79000 Epoch=302.7] | Loss=0.00048 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.039 | L2-Norm(final)=10.705 | 4098.8 samples/s | 64.0 steps/s
[Step=79050 Epoch=302.9] | Loss=0.00044 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.041 | L2-Norm(final)=10.705 | 1547.8 samples/s | 24.2 steps/s
[Step=79100 Epoch=303.1] | Loss=0.00040 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.043 | L2-Norm(final)=10.705 | 3741.0 samples/s | 58.5 steps/s
[Step=79150 Epoch=303.3] | Loss=0.00037 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.044 | L2-Norm(final)=10.706 | 3680.0 samples/s | 57.5 steps/s
[Step=79200 Epoch=303.5] | Loss=0.00035 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.044 | L2-Norm(final)=10.706 | 3703.7 samples/s | 57.9 steps/s
[Step=79250 Epoch=303.7] | Loss=0.00032 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.045 | L2-Norm(final)=10.707 | 3753.2 samples/s | 58.6 steps/s
[Step=79300 Epoch=303.8] | Loss=0.00030 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.045 | L2-Norm(final)=10.707 | 1559.1 samples/s | 24.4 steps/s
[Step=79350 Epoch=304.0] | Loss=0.00029 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.045 | L2-Norm(final)=10.708 | 3848.9 samples/s | 60.1 steps/s
[Step=79400 Epoch=304.2] | Loss=0.00027 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.045 | L2-Norm(final)=10.708 | 3649.8 samples/s | 57.0 steps/s
[Step=79450 Epoch=304.4] | Loss=0.00026 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.045 | L2-Norm(final)=10.709 | 3719.4 samples/s | 58.1 steps/s
[Step=79500 Epoch=304.6] | Loss=0.00024 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.044 | L2-Norm(final)=10.709 | 3712.8 samples/s | 58.0 steps/s
[Step=79550 Epoch=304.8] | Loss=0.00023 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.044 | L2-Norm(final)=10.710 | 1580.8 samples/s | 24.7 steps/s
[Step=79600 Epoch=305.0] | Loss=0.00022 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.043 | L2-Norm(final)=10.710 | 3705.2 samples/s | 57.9 steps/s
[Step=79650 Epoch=305.2] | Loss=0.00021 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.043 | L2-Norm(final)=10.711 | 3732.3 samples/s | 58.3 steps/s
[Step=79700 Epoch=305.4] | Loss=0.00020 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.042 | L2-Norm(final)=10.711 | 3682.4 samples/s | 57.5 steps/s
[Step=79750 Epoch=305.6] | Loss=0.00020 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.041 | L2-Norm(final)=10.712 | 3680.2 samples/s | 57.5 steps/s
[Step=79800 Epoch=305.8] | Loss=0.00019 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.041 | L2-Norm(final)=10.712 | 4998.6 samples/s | 78.1 steps/s
[Step=79850 Epoch=306.0] | Loss=0.00018 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.040 | L2-Norm(final)=10.712 | 1413.8 samples/s | 22.1 steps/s
[Step=79900 Epoch=306.1] | Loss=0.00018 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.039 | L2-Norm(final)=10.713 | 3663.9 samples/s | 57.2 steps/s
[Step=79950 Epoch=306.3] | Loss=0.00017 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.038 | L2-Norm(final)=10.713 | 3700.3 samples/s | 57.8 steps/s
[Step=80000 Epoch=306.5] | Loss=0.00016 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.037 | L2-Norm(final)=10.714 | 3679.1 samples/s | 57.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step80000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=78001 Epoch=300.3] | Loss=0.00012 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.980 | L2-Norm(final)=10.556 | 3235.8 samples/s | 50.6 steps/s
[Step=78050 Epoch=300.4] | Loss=0.00022 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.985 | L2-Norm(final)=10.559 | 3865.6 samples/s | 60.4 steps/s
[Step=78100 Epoch=300.6] | Loss=0.00019 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.986 | L2-Norm(final)=10.562 | 4098.8 samples/s | 64.0 steps/s
[Step=78150 Epoch=300.8] | Loss=0.00017 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.988 | L2-Norm(final)=10.565 | 4113.2 samples/s | 64.3 steps/s
[Step=78200 Epoch=301.0] | Loss=0.00014 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.989 | L2-Norm(final)=10.568 | 4159.0 samples/s | 65.0 steps/s
[Step=78250 Epoch=301.2] | Loss=0.00013 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.991 | L2-Norm(final)=10.570 | 5445.6 samples/s | 85.1 steps/s
[Step=78300 Epoch=301.4] | Loss=0.00012 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.991 | L2-Norm(final)=10.572 | 1529.7 samples/s | 23.9 steps/s
[Step=78350 Epoch=301.6] | Loss=0.00011 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.992 | L2-Norm(final)=10.574 | 4142.1 samples/s | 64.7 steps/s
[Step=78400 Epoch=301.8] | Loss=0.00011 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.993 | L2-Norm(final)=10.577 | 4141.5 samples/s | 64.7 steps/s
[Step=78450 Epoch=302.0] | Loss=0.00011 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.993 | L2-Norm(final)=10.579 | 4092.0 samples/s | 63.9 steps/s
[Step=78500 Epoch=302.2] | Loss=0.00010 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.994 | L2-Norm(final)=10.581 | 4711.0 samples/s | 73.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=78501 Epoch=302.2] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.000 | L2-Norm(final)=10.603 | 3227.0 samples/s | 50.4 steps/s
[Step=78550 Epoch=302.4] | Loss=0.00005 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.000 | L2-Norm(final)=10.605 | 3502.0 samples/s | 54.7 steps/s
[Step=78600 Epoch=302.6] | Loss=0.00005 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.000 | L2-Norm(final)=10.606 | 3681.3 samples/s | 57.5 steps/s
[Step=78650 Epoch=302.8] | Loss=0.00004 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.999 | L2-Norm(final)=10.608 | 3715.7 samples/s | 58.1 steps/s
[Step=78700 Epoch=302.9] | Loss=0.00004 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.999 | L2-Norm(final)=10.610 | 3725.7 samples/s | 58.2 steps/s
[Step=78750 Epoch=303.1] | Loss=0.00004 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.998 | L2-Norm(final)=10.611 | 4820.9 samples/s | 75.3 steps/s
[Step=78800 Epoch=303.3] | Loss=0.00004 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.998 | L2-Norm(final)=10.612 | 1476.8 samples/s | 23.1 steps/s
[Step=78850 Epoch=303.5] | Loss=0.00003 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.997 | L2-Norm(final)=10.614 | 3700.0 samples/s | 57.8 steps/s
[Step=78900 Epoch=303.7] | Loss=0.00003 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.996 | L2-Norm(final)=10.615 | 3776.8 samples/s | 59.0 steps/s
[Step=78950 Epoch=303.9] | Loss=0.00003 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.994 | L2-Norm(final)=10.616 | 3733.6 samples/s | 58.3 steps/s
[Step=79000 Epoch=304.1] | Loss=0.00003 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.993 | L2-Norm(final)=10.617 | 4221.6 samples/s | 66.0 steps/s
[Step=79050 Epoch=304.3] | Loss=0.00003 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.992 | L2-Norm(final)=10.618 | 1052.3 samples/s | 16.4 steps/s
[Step=79100 Epoch=304.5] | Loss=0.00003 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.991 | L2-Norm(final)=10.619 | 3814.9 samples/s | 59.6 steps/s
[Step=79150 Epoch=304.7] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.989 | L2-Norm(final)=10.620 | 3407.6 samples/s | 53.2 steps/s
[Step=79200 Epoch=304.9] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.988 | L2-Norm(final)=10.620 | 3718.3 samples/s | 58.1 steps/s
[Step=79250 Epoch=305.1] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.987 | L2-Norm(final)=10.621 | 3578.4 samples/s | 55.9 steps/s
[Step=79300 Epoch=305.3] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.985 | L2-Norm(final)=10.622 | 1600.9 samples/s | 25.0 steps/s
[Step=79350 Epoch=305.4] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.984 | L2-Norm(final)=10.623 | 3739.5 samples/s | 58.4 steps/s
[Step=79400 Epoch=305.6] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.983 | L2-Norm(final)=10.624 | 3708.6 samples/s | 57.9 steps/s
[Step=79450 Epoch=305.8] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.981 | L2-Norm(final)=10.625 | 3750.8 samples/s | 58.6 steps/s
[Step=79500 Epoch=306.0] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.980 | L2-Norm(final)=10.625 | 3689.7 samples/s | 57.7 steps/s
[Step=79550 Epoch=306.2] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.978 | L2-Norm(final)=10.626 | 1643.2 samples/s | 25.7 steps/s
[Step=79600 Epoch=306.4] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.977 | L2-Norm(final)=10.627 | 3705.5 samples/s | 57.9 steps/s
[Step=79650 Epoch=306.6] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.975 | L2-Norm(final)=10.628 | 3724.6 samples/s | 58.2 steps/s
[Step=79700 Epoch=306.8] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.973 | L2-Norm(final)=10.629 | 3700.1 samples/s | 57.8 steps/s
[Step=79750 Epoch=307.0] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.972 | L2-Norm(final)=10.629 | 3743.8 samples/s | 58.5 steps/s
[Step=79800 Epoch=307.2] | Loss=0.00002 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.970 | L2-Norm(final)=10.630 | 5322.3 samples/s | 83.2 steps/s
[Step=79850 Epoch=307.4] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.968 | L2-Norm(final)=10.631 | 1393.9 samples/s | 21.8 steps/s
[Step=79900 Epoch=307.6] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.967 | L2-Norm(final)=10.632 | 3747.2 samples/s | 58.6 steps/s
[Step=79950 Epoch=307.8] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.965 | L2-Norm(final)=10.632 | 3629.9 samples/s | 56.7 steps/s
[Step=80000 Epoch=308.0] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.963 | L2-Norm(final)=10.633 | 3714.1 samples/s | 58.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step80000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05820 | acc=0.9684 | tpr=0.9710 | fpr=0.0372 | 3487.2 samples/s | 13.6 steps/s
Avg test loss: 0.06327, Avg test acc: 0.96646, Avg tpr: 0.96940, Avg fpr: 0.03999, total FA: 312

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05747 | acc=0.9699 | tpr=0.9779 | fpr=0.0473 | 3527.4 samples/s | 13.8 steps/s
Avg test loss: 0.06221, Avg test acc: 0.96751, Avg tpr: 0.97709, Avg fpr: 0.05358, total FA: 418

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.81876 | acc=0.3057 | tpr=0.0106 | fpr=0.0535 | 3514.7 samples/s | 13.7 steps/s
Avg test loss: 4.82805, Avg test acc: 0.30371, Avg tpr: 0.01067, Avg fpr: 0.05179, total FA: 404

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.26515 | acc=0.3162 | tpr=0.0192 | fpr=0.0387 | 3491.5 samples/s | 13.6 steps/s
Avg test loss: 4.27781, Avg test acc: 0.31349, Avg tpr: 0.01906, Avg fpr: 0.03897, total FA: 304

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.77769 | acc=0.1203 | tpr=0.8584 | fpr=0.8930 | 3532.6 samples/s | 13.8 steps/s
[Step= 100] | Loss=4.76170 | acc=0.1214 | tpr=0.8742 | fpr=0.8927 | 6721.1 samples/s | 26.3 steps/s
[Step= 150] | Loss=4.77164 | acc=0.1203 | tpr=0.8718 | fpr=0.8935 | 6760.9 samples/s | 26.4 steps/s
[Step= 200] | Loss=4.75652 | acc=0.1210 | tpr=0.8656 | fpr=0.8926 | 6893.7 samples/s | 26.9 steps/s
[Step= 250] | Loss=4.76053 | acc=0.1211 | tpr=0.8568 | fpr=0.8923 | 6745.4 samples/s | 26.3 steps/s
[Step= 300] | Loss=4.76210 | acc=0.1202 | tpr=0.8502 | fpr=0.8932 | 6930.4 samples/s | 27.1 steps/s
[Step= 350] | Loss=4.75695 | acc=0.1207 | tpr=0.8566 | fpr=0.8927 | 6759.4 samples/s | 26.4 steps/s
[Step= 400] | Loss=4.75474 | acc=0.1206 | tpr=0.8512 | fpr=0.8927 | 6800.3 samples/s | 26.6 steps/s
[Step= 450] | Loss=4.76138 | acc=0.1200 | tpr=0.8520 | fpr=0.8933 | 6679.3 samples/s | 26.1 steps/s
[Step= 500] | Loss=4.76256 | acc=0.1198 | tpr=0.8520 | fpr=0.8934 | 6664.6 samples/s | 26.0 steps/s
[Step= 550] | Loss=4.76306 | acc=0.1201 | tpr=0.8516 | fpr=0.8932 | 12689.5 samples/s | 49.6 steps/s
Avg test loss: 4.76385, Avg test acc: 0.11995, Avg tpr: 0.85103, Avg fpr: 0.89334, total FA: 124039

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.26735 | acc=0.1136 | tpr=0.8938 | fpr=0.9004 | 3502.8 samples/s | 13.7 steps/s
[Step= 100] | Loss=5.24432 | acc=0.1150 | tpr=0.9019 | fpr=0.8996 | 6898.7 samples/s | 26.9 steps/s
[Step= 150] | Loss=5.25866 | acc=0.1139 | tpr=0.9063 | fpr=0.9007 | 6885.9 samples/s | 26.9 steps/s
[Step= 200] | Loss=5.24495 | acc=0.1139 | tpr=0.8995 | fpr=0.9004 | 6818.2 samples/s | 26.6 steps/s
[Step= 250] | Loss=5.24860 | acc=0.1140 | tpr=0.8934 | fpr=0.9002 | 6826.8 samples/s | 26.7 steps/s
[Step= 300] | Loss=5.25072 | acc=0.1136 | tpr=0.8887 | fpr=0.9006 | 6926.2 samples/s | 27.1 steps/s
[Step= 350] | Loss=5.24868 | acc=0.1140 | tpr=0.8923 | fpr=0.9001 | 6685.4 samples/s | 26.1 steps/s
[Step= 400] | Loss=5.24535 | acc=0.1142 | tpr=0.8906 | fpr=0.8999 | 6783.0 samples/s | 26.5 steps/s
[Step= 450] | Loss=5.25310 | acc=0.1141 | tpr=0.8905 | fpr=0.9000 | 6904.7 samples/s | 27.0 steps/s
[Step= 500] | Loss=5.25279 | acc=0.1142 | tpr=0.8925 | fpr=0.8999 | 6950.0 samples/s | 27.1 steps/s
[Step= 550] | Loss=5.25190 | acc=0.1144 | tpr=0.8922 | fpr=0.8998 | 12057.1 samples/s | 47.1 steps/s
Avg test loss: 5.25244, Avg test acc: 0.11430, Avg tpr: 0.89184, Avg fpr: 0.89983, total FA: 124940

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09735 | acc=0.9825 | tpr=0.9425 | fpr=0.0168 | 3523.9 samples/s | 13.8 steps/s
[Step= 100] | Loss=0.10071 | acc=0.9819 | tpr=0.9531 | fpr=0.0175 | 6867.2 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.10566 | acc=0.9810 | tpr=0.9568 | fpr=0.0185 | 6840.4 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.10713 | acc=0.9810 | tpr=0.9541 | fpr=0.0185 | 7019.6 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.10567 | acc=0.9813 | tpr=0.9502 | fpr=0.0181 | 6842.7 samples/s | 26.7 steps/s
[Step= 300] | Loss=0.10792 | acc=0.9809 | tpr=0.9491 | fpr=0.0185 | 6788.5 samples/s | 26.5 steps/s
[Step= 350] | Loss=0.10784 | acc=0.9808 | tpr=0.9505 | fpr=0.0186 | 6996.5 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.10924 | acc=0.9806 | tpr=0.9469 | fpr=0.0188 | 6764.3 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.11143 | acc=0.9802 | tpr=0.9450 | fpr=0.0192 | 6920.9 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.11114 | acc=0.9803 | tpr=0.9480 | fpr=0.0192 | 6728.4 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.11030 | acc=0.9804 | tpr=0.9483 | fpr=0.0190 | 12658.7 samples/s | 49.4 steps/s
Avg test loss: 0.11020, Avg test acc: 0.98041, Avg tpr: 0.94770, Avg fpr: 0.01900, total FA: 2638

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09996 | acc=0.9813 | tpr=0.9425 | fpr=0.0180 | 3498.9 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.10455 | acc=0.9805 | tpr=0.9595 | fpr=0.0191 | 6778.5 samples/s | 26.5 steps/s
[Step= 150] | Loss=0.10739 | acc=0.9795 | tpr=0.9611 | fpr=0.0201 | 6755.0 samples/s | 26.4 steps/s
[Step= 200] | Loss=0.10845 | acc=0.9794 | tpr=0.9607 | fpr=0.0202 | 6882.4 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.10766 | acc=0.9794 | tpr=0.9572 | fpr=0.0202 | 6673.7 samples/s | 26.1 steps/s
[Step= 300] | Loss=0.10941 | acc=0.9791 | tpr=0.9578 | fpr=0.0205 | 6868.3 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.10919 | acc=0.9791 | tpr=0.9580 | fpr=0.0206 | 6849.5 samples/s | 26.8 steps/s
[Step= 400] | Loss=0.11042 | acc=0.9789 | tpr=0.9562 | fpr=0.0207 | 6754.6 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.11259 | acc=0.9785 | tpr=0.9552 | fpr=0.0210 | 6793.6 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.11236 | acc=0.9786 | tpr=0.9577 | fpr=0.0210 | 6522.1 samples/s | 25.5 steps/s
[Step= 550] | Loss=0.11161 | acc=0.9788 | tpr=0.9578 | fpr=0.0208 | 12704.7 samples/s | 49.6 steps/s
Avg test loss: 0.11158, Avg test acc: 0.97880, Avg tpr: 0.95721, Avg fpr: 0.02081, total FA: 2889

server round 40/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=80001 Epoch=156.0] | Loss=0.01347 | Reg=0.00067 | acc=0.9844 | L2-Norm=8.182 | L2-Norm(final)=14.850 | 3079.6 samples/s | 48.1 steps/s
[Step=80050 Epoch=156.1] | Loss=0.01455 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.189 | L2-Norm(final)=14.854 | 3963.0 samples/s | 61.9 steps/s
[Step=80100 Epoch=156.2] | Loss=0.01476 | Reg=0.00067 | acc=0.9844 | L2-Norm=8.196 | L2-Norm(final)=14.860 | 4298.1 samples/s | 67.2 steps/s
[Step=80150 Epoch=156.3] | Loss=0.01414 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.203 | L2-Norm(final)=14.865 | 4318.2 samples/s | 67.5 steps/s
[Step=80200 Epoch=156.4] | Loss=0.01454 | Reg=0.00067 | acc=0.9844 | L2-Norm=8.210 | L2-Norm(final)=14.870 | 4436.1 samples/s | 69.3 steps/s
[Step=80250 Epoch=156.5] | Loss=0.01426 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.216 | L2-Norm(final)=14.875 | 4303.7 samples/s | 67.2 steps/s
[Step=80300 Epoch=156.6] | Loss=0.01418 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.222 | L2-Norm(final)=14.880 | 4304.1 samples/s | 67.3 steps/s
[Step=80350 Epoch=156.7] | Loss=0.01382 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.228 | L2-Norm(final)=14.885 | 4396.4 samples/s | 68.7 steps/s
[Step=80400 Epoch=156.8] | Loss=0.01372 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.234 | L2-Norm(final)=14.889 | 4360.1 samples/s | 68.1 steps/s
[Step=80450 Epoch=156.9] | Loss=0.01333 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.240 | L2-Norm(final)=14.894 | 4398.9 samples/s | 68.7 steps/s
[Step=80500 Epoch=157.0] | Loss=0.01334 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.246 | L2-Norm(final)=14.899 | 5412.4 samples/s | 84.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=80501 Epoch=157.0] | Loss=0.00687 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.301 | L2-Norm(final)=14.946 | 3322.6 samples/s | 51.9 steps/s
[Step=80550 Epoch=157.1] | Loss=0.01069 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.308 | L2-Norm(final)=14.950 | 3490.8 samples/s | 54.5 steps/s
[Step=80600 Epoch=157.2] | Loss=0.01128 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.316 | L2-Norm(final)=14.955 | 3871.2 samples/s | 60.5 steps/s
[Step=80650 Epoch=157.3] | Loss=0.01147 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.322 | L2-Norm(final)=14.959 | 3887.5 samples/s | 60.7 steps/s
[Step=80700 Epoch=157.4] | Loss=0.01142 | Reg=0.00069 | acc=0.9688 | L2-Norm=8.329 | L2-Norm(final)=14.962 | 3850.7 samples/s | 60.2 steps/s
[Step=80750 Epoch=157.5] | Loss=0.01088 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.334 | L2-Norm(final)=14.966 | 3946.5 samples/s | 61.7 steps/s
[Step=80800 Epoch=157.6] | Loss=0.01074 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.340 | L2-Norm(final)=14.969 | 3943.8 samples/s | 61.6 steps/s
[Step=80850 Epoch=157.7] | Loss=0.01072 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.346 | L2-Norm(final)=14.973 | 3885.1 samples/s | 60.7 steps/s
[Step=80900 Epoch=157.8] | Loss=0.01058 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.351 | L2-Norm(final)=14.976 | 4000.8 samples/s | 62.5 steps/s
[Step=80950 Epoch=157.9] | Loss=0.01047 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.355 | L2-Norm(final)=14.979 | 3919.0 samples/s | 61.2 steps/s
[Step=81000 Epoch=158.0] | Loss=0.01043 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.360 | L2-Norm(final)=14.982 | 4808.6 samples/s | 75.1 steps/s
[Step=81050 Epoch=158.1] | Loss=0.01020 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.365 | L2-Norm(final)=14.985 | 1497.6 samples/s | 23.4 steps/s
[Step=81100 Epoch=158.2] | Loss=0.00989 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.370 | L2-Norm(final)=14.988 | 3936.8 samples/s | 61.5 steps/s
[Step=81150 Epoch=158.3] | Loss=0.00973 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.374 | L2-Norm(final)=14.992 | 3918.0 samples/s | 61.2 steps/s
[Step=81200 Epoch=158.4] | Loss=0.00946 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.378 | L2-Norm(final)=14.995 | 3912.9 samples/s | 61.1 steps/s
[Step=81250 Epoch=158.5] | Loss=0.00931 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.382 | L2-Norm(final)=14.998 | 3946.9 samples/s | 61.7 steps/s
[Step=81300 Epoch=158.6] | Loss=0.00930 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.387 | L2-Norm(final)=15.001 | 3914.8 samples/s | 61.2 steps/s
[Step=81350 Epoch=158.7] | Loss=0.00922 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.391 | L2-Norm(final)=15.003 | 3915.6 samples/s | 61.2 steps/s
[Step=81400 Epoch=158.8] | Loss=0.00917 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.395 | L2-Norm(final)=15.006 | 3935.8 samples/s | 61.5 steps/s
[Step=81450 Epoch=158.9] | Loss=0.00909 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.398 | L2-Norm(final)=15.009 | 3900.2 samples/s | 60.9 steps/s
[Step=81500 Epoch=159.0] | Loss=0.00903 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.402 | L2-Norm(final)=15.012 | 4156.5 samples/s | 64.9 steps/s
[Step=81550 Epoch=159.1] | Loss=0.00885 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.406 | L2-Norm(final)=15.015 | 1557.1 samples/s | 24.3 steps/s
[Step=81600 Epoch=159.2] | Loss=0.00877 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.410 | L2-Norm(final)=15.017 | 3922.6 samples/s | 61.3 steps/s
[Step=81650 Epoch=159.2] | Loss=0.00870 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.413 | L2-Norm(final)=15.020 | 3943.5 samples/s | 61.6 steps/s
[Step=81700 Epoch=159.3] | Loss=0.00867 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.417 | L2-Norm(final)=15.023 | 3901.2 samples/s | 61.0 steps/s
[Step=81750 Epoch=159.4] | Loss=0.00863 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.421 | L2-Norm(final)=15.025 | 3948.1 samples/s | 61.7 steps/s
[Step=81800 Epoch=159.5] | Loss=0.00853 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.424 | L2-Norm(final)=15.028 | 3938.0 samples/s | 61.5 steps/s
[Step=81850 Epoch=159.6] | Loss=0.00843 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.428 | L2-Norm(final)=15.031 | 3928.4 samples/s | 61.4 steps/s
[Step=81900 Epoch=159.7] | Loss=0.00829 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.431 | L2-Norm(final)=15.033 | 3910.9 samples/s | 61.1 steps/s
[Step=81950 Epoch=159.8] | Loss=0.00822 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.434 | L2-Norm(final)=15.036 | 3902.3 samples/s | 61.0 steps/s
[Step=82000 Epoch=159.9] | Loss=0.00813 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.438 | L2-Norm(final)=15.039 | 3930.8 samples/s | 61.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step82000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=80001 Epoch=156.4] | Loss=0.01877 | Reg=0.00067 | acc=0.9844 | L2-Norm=8.182 | L2-Norm(final)=15.100 | 3365.0 samples/s | 52.6 steps/s
[Step=80050 Epoch=156.5] | Loss=0.01476 | Reg=0.00067 | acc=0.9688 | L2-Norm=8.189 | L2-Norm(final)=15.104 | 3974.5 samples/s | 62.1 steps/s
[Step=80100 Epoch=156.6] | Loss=0.01412 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.197 | L2-Norm(final)=15.109 | 4365.6 samples/s | 68.2 steps/s
[Step=80150 Epoch=156.7] | Loss=0.01425 | Reg=0.00067 | acc=0.9844 | L2-Norm=8.203 | L2-Norm(final)=15.115 | 4376.3 samples/s | 68.4 steps/s
[Step=80200 Epoch=156.8] | Loss=0.01394 | Reg=0.00067 | acc=0.9688 | L2-Norm=8.209 | L2-Norm(final)=15.120 | 4358.7 samples/s | 68.1 steps/s
[Step=80250 Epoch=156.9] | Loss=0.01370 | Reg=0.00067 | acc=0.9844 | L2-Norm=8.214 | L2-Norm(final)=15.125 | 4403.8 samples/s | 68.8 steps/s
[Step=80300 Epoch=157.0] | Loss=0.01366 | Reg=0.00068 | acc=0.9531 | L2-Norm=8.220 | L2-Norm(final)=15.130 | 4306.6 samples/s | 67.3 steps/s
[Step=80350 Epoch=157.1] | Loss=0.01362 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.225 | L2-Norm(final)=15.134 | 4328.7 samples/s | 67.6 steps/s
[Step=80400 Epoch=157.2] | Loss=0.01355 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.230 | L2-Norm(final)=15.139 | 4319.5 samples/s | 67.5 steps/s
[Step=80450 Epoch=157.3] | Loss=0.01319 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.235 | L2-Norm(final)=15.144 | 4355.5 samples/s | 68.1 steps/s
[Step=80500 Epoch=157.4] | Loss=0.01306 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.240 | L2-Norm(final)=15.148 | 5567.3 samples/s | 87.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=80501 Epoch=157.4] | Loss=0.01504 | Reg=0.00069 | acc=0.9844 | L2-Norm=8.289 | L2-Norm(final)=15.194 | 3366.6 samples/s | 52.6 steps/s
[Step=80550 Epoch=157.5] | Loss=0.01302 | Reg=0.00069 | acc=0.9844 | L2-Norm=8.295 | L2-Norm(final)=15.198 | 3670.9 samples/s | 57.4 steps/s
[Step=80600 Epoch=157.6] | Loss=0.01224 | Reg=0.00069 | acc=0.9844 | L2-Norm=8.302 | L2-Norm(final)=15.203 | 3968.3 samples/s | 62.0 steps/s
[Step=80650 Epoch=157.7] | Loss=0.01219 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.308 | L2-Norm(final)=15.207 | 3919.3 samples/s | 61.2 steps/s
[Step=80700 Epoch=157.8] | Loss=0.01184 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.314 | L2-Norm(final)=15.210 | 3931.4 samples/s | 61.4 steps/s
[Step=80750 Epoch=157.9] | Loss=0.01135 | Reg=0.00069 | acc=0.9844 | L2-Norm=8.319 | L2-Norm(final)=15.214 | 3964.9 samples/s | 62.0 steps/s
[Step=80800 Epoch=158.0] | Loss=0.01096 | Reg=0.00069 | acc=0.9844 | L2-Norm=8.325 | L2-Norm(final)=15.217 | 3873.9 samples/s | 60.5 steps/s
[Step=80850 Epoch=158.1] | Loss=0.01069 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.330 | L2-Norm(final)=15.221 | 3904.2 samples/s | 61.0 steps/s
[Step=80900 Epoch=158.2] | Loss=0.01040 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.335 | L2-Norm(final)=15.225 | 3940.7 samples/s | 61.6 steps/s
[Step=80950 Epoch=158.3] | Loss=0.01047 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.340 | L2-Norm(final)=15.228 | 3966.6 samples/s | 62.0 steps/s
[Step=81000 Epoch=158.4] | Loss=0.01026 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.344 | L2-Norm(final)=15.231 | 4915.6 samples/s | 76.8 steps/s
[Step=81050 Epoch=158.5] | Loss=0.00997 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.349 | L2-Norm(final)=15.235 | 1472.3 samples/s | 23.0 steps/s
[Step=81100 Epoch=158.5] | Loss=0.00968 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.354 | L2-Norm(final)=15.238 | 3904.0 samples/s | 61.0 steps/s
[Step=81150 Epoch=158.6] | Loss=0.00949 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.358 | L2-Norm(final)=15.241 | 3883.6 samples/s | 60.7 steps/s
[Step=81200 Epoch=158.7] | Loss=0.00933 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.363 | L2-Norm(final)=15.245 | 3942.4 samples/s | 61.6 steps/s
[Step=81250 Epoch=158.8] | Loss=0.00926 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.367 | L2-Norm(final)=15.248 | 3962.4 samples/s | 61.9 steps/s
[Step=81300 Epoch=158.9] | Loss=0.00912 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.371 | L2-Norm(final)=15.251 | 3897.0 samples/s | 60.9 steps/s
[Step=81350 Epoch=159.0] | Loss=0.00912 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.375 | L2-Norm(final)=15.254 | 3919.2 samples/s | 61.2 steps/s
[Step=81400 Epoch=159.1] | Loss=0.00895 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.379 | L2-Norm(final)=15.257 | 3946.9 samples/s | 61.7 steps/s
[Step=81450 Epoch=159.2] | Loss=0.00880 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.383 | L2-Norm(final)=15.260 | 3924.6 samples/s | 61.3 steps/s
[Step=81500 Epoch=159.3] | Loss=0.00864 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.387 | L2-Norm(final)=15.263 | 4231.2 samples/s | 66.1 steps/s
[Step=81550 Epoch=159.4] | Loss=0.00852 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.390 | L2-Norm(final)=15.266 | 1556.8 samples/s | 24.3 steps/s
[Step=81600 Epoch=159.5] | Loss=0.00842 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.394 | L2-Norm(final)=15.269 | 3900.4 samples/s | 60.9 steps/s
[Step=81650 Epoch=159.6] | Loss=0.00828 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.397 | L2-Norm(final)=15.272 | 3928.2 samples/s | 61.4 steps/s
[Step=81700 Epoch=159.7] | Loss=0.00820 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.401 | L2-Norm(final)=15.275 | 3895.0 samples/s | 60.9 steps/s
[Step=81750 Epoch=159.8] | Loss=0.00814 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.404 | L2-Norm(final)=15.278 | 3870.8 samples/s | 60.5 steps/s
[Step=81800 Epoch=159.9] | Loss=0.00809 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.408 | L2-Norm(final)=15.280 | 3917.3 samples/s | 61.2 steps/s
[Step=81850 Epoch=160.0] | Loss=0.00804 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.411 | L2-Norm(final)=15.283 | 3937.5 samples/s | 61.5 steps/s
[Step=81900 Epoch=160.1] | Loss=0.00792 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.414 | L2-Norm(final)=15.286 | 3933.7 samples/s | 61.5 steps/s
[Step=81950 Epoch=160.2] | Loss=0.00785 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.418 | L2-Norm(final)=15.289 | 3942.4 samples/s | 61.6 steps/s
[Step=82000 Epoch=160.3] | Loss=0.00781 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.421 | L2-Norm(final)=15.291 | 3801.9 samples/s | 59.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step82000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=80001 Epoch=306.5] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.182 | L2-Norm(final)=10.728 | 3545.4 samples/s | 55.4 steps/s
[Step=80050 Epoch=306.7] | Loss=0.00010 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.180 | L2-Norm(final)=10.729 | 3651.4 samples/s | 57.1 steps/s
[Step=80100 Epoch=306.9] | Loss=0.00010 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.180 | L2-Norm(final)=10.730 | 4122.7 samples/s | 64.4 steps/s
[Step=80150 Epoch=307.1] | Loss=0.00009 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.180 | L2-Norm(final)=10.732 | 4095.8 samples/s | 64.0 steps/s
[Step=80200 Epoch=307.3] | Loss=0.00008 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.180 | L2-Norm(final)=10.734 | 4090.9 samples/s | 63.9 steps/s
[Step=80250 Epoch=307.5] | Loss=0.00008 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.180 | L2-Norm(final)=10.736 | 5328.1 samples/s | 83.3 steps/s
[Step=80300 Epoch=307.7] | Loss=0.00007 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.180 | L2-Norm(final)=10.737 | 1545.0 samples/s | 24.1 steps/s
[Step=80350 Epoch=307.9] | Loss=0.00007 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.180 | L2-Norm(final)=10.739 | 4066.9 samples/s | 63.5 steps/s
[Step=80400 Epoch=308.1] | Loss=0.00006 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.180 | L2-Norm(final)=10.741 | 4074.7 samples/s | 63.7 steps/s
[Step=80450 Epoch=308.3] | Loss=0.00006 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.180 | L2-Norm(final)=10.742 | 4087.7 samples/s | 63.9 steps/s
[Step=80500 Epoch=308.4] | Loss=0.00006 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.180 | L2-Norm(final)=10.744 | 4582.3 samples/s | 71.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=80501 Epoch=308.5] | Loss=0.00005 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.178 | L2-Norm(final)=10.758 | 3207.2 samples/s | 50.1 steps/s
[Step=80550 Epoch=308.6] | Loss=0.00003 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.177 | L2-Norm(final)=10.759 | 3562.8 samples/s | 55.7 steps/s
[Step=80600 Epoch=308.8] | Loss=0.00003 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.176 | L2-Norm(final)=10.760 | 3664.8 samples/s | 57.3 steps/s
[Step=80650 Epoch=309.0] | Loss=0.00003 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.176 | L2-Norm(final)=10.761 | 3710.1 samples/s | 58.0 steps/s
[Step=80700 Epoch=309.2] | Loss=0.00003 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.175 | L2-Norm(final)=10.763 | 3693.0 samples/s | 57.7 steps/s
[Step=80750 Epoch=309.4] | Loss=0.00003 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.174 | L2-Norm(final)=10.764 | 4754.6 samples/s | 74.3 steps/s
[Step=80800 Epoch=309.6] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.173 | L2-Norm(final)=10.765 | 1441.9 samples/s | 22.5 steps/s
[Step=80850 Epoch=309.8] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.172 | L2-Norm(final)=10.766 | 3763.9 samples/s | 58.8 steps/s
[Step=80900 Epoch=310.0] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.171 | L2-Norm(final)=10.766 | 3690.1 samples/s | 57.7 steps/s
[Step=80950 Epoch=310.2] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.170 | L2-Norm(final)=10.767 | 3725.1 samples/s | 58.2 steps/s
[Step=81000 Epoch=310.4] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.168 | L2-Norm(final)=10.768 | 4113.8 samples/s | 64.3 steps/s
[Step=81050 Epoch=310.6] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.167 | L2-Norm(final)=10.769 | 1503.2 samples/s | 23.5 steps/s
[Step=81100 Epoch=310.7] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.166 | L2-Norm(final)=10.770 | 3745.7 samples/s | 58.5 steps/s
[Step=81150 Epoch=310.9] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.164 | L2-Norm(final)=10.771 | 3671.0 samples/s | 57.4 steps/s
[Step=81200 Epoch=311.1] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.163 | L2-Norm(final)=10.771 | 3704.7 samples/s | 57.9 steps/s
[Step=81250 Epoch=311.3] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.162 | L2-Norm(final)=10.772 | 3750.8 samples/s | 58.6 steps/s
[Step=81300 Epoch=311.5] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.160 | L2-Norm(final)=10.773 | 1572.9 samples/s | 24.6 steps/s
[Step=81350 Epoch=311.7] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.159 | L2-Norm(final)=10.774 | 3760.4 samples/s | 58.8 steps/s
[Step=81400 Epoch=311.9] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.157 | L2-Norm(final)=10.774 | 3804.0 samples/s | 59.4 steps/s
[Step=81450 Epoch=312.1] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.156 | L2-Norm(final)=10.775 | 3659.2 samples/s | 57.2 steps/s
[Step=81500 Epoch=312.3] | Loss=0.00002 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.154 | L2-Norm(final)=10.776 | 3753.6 samples/s | 58.7 steps/s
[Step=81550 Epoch=312.5] | Loss=0.00002 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.153 | L2-Norm(final)=10.776 | 1566.5 samples/s | 24.5 steps/s
[Step=81600 Epoch=312.7] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.151 | L2-Norm(final)=10.777 | 3756.6 samples/s | 58.7 steps/s
[Step=81650 Epoch=312.9] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.150 | L2-Norm(final)=10.778 | 3735.4 samples/s | 58.4 steps/s
[Step=81700 Epoch=313.0] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.148 | L2-Norm(final)=10.778 | 3743.5 samples/s | 58.5 steps/s
[Step=81750 Epoch=313.2] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.146 | L2-Norm(final)=10.779 | 3707.7 samples/s | 57.9 steps/s
[Step=81800 Epoch=313.4] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.145 | L2-Norm(final)=10.780 | 5123.3 samples/s | 80.1 steps/s
[Step=81850 Epoch=313.6] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.143 | L2-Norm(final)=10.780 | 1438.9 samples/s | 22.5 steps/s
[Step=81900 Epoch=313.8] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.141 | L2-Norm(final)=10.781 | 3697.5 samples/s | 57.8 steps/s
[Step=81950 Epoch=314.0] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.140 | L2-Norm(final)=10.782 | 3705.3 samples/s | 57.9 steps/s
[Step=82000 Epoch=314.2] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.138 | L2-Norm(final)=10.782 | 3696.3 samples/s | 57.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step82000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=80001 Epoch=308.0] | Loss=0.00005 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.182 | L2-Norm(final)=10.655 | 3658.2 samples/s | 57.2 steps/s
[Step=80050 Epoch=308.1] | Loss=0.00030 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.184 | L2-Norm(final)=10.658 | 3393.1 samples/s | 53.0 steps/s
[Step=80100 Epoch=308.3] | Loss=0.00026 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.187 | L2-Norm(final)=10.662 | 4107.9 samples/s | 64.2 steps/s
[Step=80150 Epoch=308.5] | Loss=0.00023 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.189 | L2-Norm(final)=10.666 | 4123.7 samples/s | 64.4 steps/s
[Step=80200 Epoch=308.7] | Loss=0.00020 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.191 | L2-Norm(final)=10.670 | 4111.7 samples/s | 64.2 steps/s
[Step=80250 Epoch=308.9] | Loss=0.00018 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.192 | L2-Norm(final)=10.673 | 5468.9 samples/s | 85.5 steps/s
[Step=80300 Epoch=309.1] | Loss=0.00016 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.193 | L2-Norm(final)=10.676 | 1477.0 samples/s | 23.1 steps/s
[Step=80350 Epoch=309.3] | Loss=0.00015 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.194 | L2-Norm(final)=10.679 | 4044.3 samples/s | 63.2 steps/s
[Step=80400 Epoch=309.5] | Loss=0.00014 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.195 | L2-Norm(final)=10.681 | 4132.2 samples/s | 64.6 steps/s
[Step=80450 Epoch=309.7] | Loss=0.00013 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.195 | L2-Norm(final)=10.684 | 4072.4 samples/s | 63.6 steps/s
[Step=80500 Epoch=309.9] | Loss=0.00013 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.196 | L2-Norm(final)=10.687 | 4770.5 samples/s | 74.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=80501 Epoch=309.9] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.199 | L2-Norm(final)=10.711 | 3177.7 samples/s | 49.7 steps/s
[Step=80550 Epoch=310.1] | Loss=0.00007 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.199 | L2-Norm(final)=10.714 | 3569.1 samples/s | 55.8 steps/s
[Step=80600 Epoch=310.3] | Loss=0.00005 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.198 | L2-Norm(final)=10.716 | 3745.6 samples/s | 58.5 steps/s
[Step=80650 Epoch=310.5] | Loss=0.00005 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.197 | L2-Norm(final)=10.717 | 3760.0 samples/s | 58.8 steps/s
[Step=80700 Epoch=310.6] | Loss=0.00004 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.196 | L2-Norm(final)=10.719 | 3645.3 samples/s | 57.0 steps/s
[Step=80750 Epoch=310.8] | Loss=0.00004 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.194 | L2-Norm(final)=10.720 | 4810.4 samples/s | 75.2 steps/s
[Step=80800 Epoch=311.0] | Loss=0.00004 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.193 | L2-Norm(final)=10.722 | 1441.4 samples/s | 22.5 steps/s
[Step=80850 Epoch=311.2] | Loss=0.00003 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.191 | L2-Norm(final)=10.723 | 3647.1 samples/s | 57.0 steps/s
[Step=80900 Epoch=311.4] | Loss=0.00003 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.190 | L2-Norm(final)=10.724 | 3707.4 samples/s | 57.9 steps/s
[Step=80950 Epoch=311.6] | Loss=0.00003 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.188 | L2-Norm(final)=10.725 | 3690.7 samples/s | 57.7 steps/s
[Step=81000 Epoch=311.8] | Loss=0.00003 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.186 | L2-Norm(final)=10.726 | 4227.1 samples/s | 66.0 steps/s
[Step=81050 Epoch=312.0] | Loss=0.00003 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.184 | L2-Norm(final)=10.727 | 1498.3 samples/s | 23.4 steps/s
[Step=81100 Epoch=312.2] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.182 | L2-Norm(final)=10.728 | 3778.1 samples/s | 59.0 steps/s
[Step=81150 Epoch=312.4] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.180 | L2-Norm(final)=10.729 | 3733.7 samples/s | 58.3 steps/s
[Step=81200 Epoch=312.6] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.178 | L2-Norm(final)=10.729 | 3745.4 samples/s | 58.5 steps/s
[Step=81250 Epoch=312.8] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.176 | L2-Norm(final)=10.730 | 3762.4 samples/s | 58.8 steps/s
[Step=81300 Epoch=313.0] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.174 | L2-Norm(final)=10.731 | 1574.9 samples/s | 24.6 steps/s
[Step=81350 Epoch=313.1] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.172 | L2-Norm(final)=10.732 | 3754.3 samples/s | 58.7 steps/s
[Step=81400 Epoch=313.3] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.170 | L2-Norm(final)=10.733 | 3698.0 samples/s | 57.8 steps/s
[Step=81450 Epoch=313.5] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.168 | L2-Norm(final)=10.733 | 3709.0 samples/s | 58.0 steps/s
[Step=81500 Epoch=313.7] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.165 | L2-Norm(final)=10.734 | 3730.7 samples/s | 58.3 steps/s
[Step=81550 Epoch=313.9] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.163 | L2-Norm(final)=10.735 | 1525.2 samples/s | 23.8 steps/s
[Step=81600 Epoch=314.1] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.161 | L2-Norm(final)=10.735 | 3740.6 samples/s | 58.4 steps/s
[Step=81650 Epoch=314.3] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.158 | L2-Norm(final)=10.736 | 3745.5 samples/s | 58.5 steps/s
[Step=81700 Epoch=314.5] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.156 | L2-Norm(final)=10.737 | 3715.6 samples/s | 58.1 steps/s
[Step=81750 Epoch=314.7] | Loss=0.00002 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.153 | L2-Norm(final)=10.738 | 3728.7 samples/s | 58.3 steps/s
[Step=81800 Epoch=314.9] | Loss=0.00002 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.151 | L2-Norm(final)=10.738 | 5484.1 samples/s | 85.7 steps/s
[Step=81850 Epoch=315.1] | Loss=0.00002 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.148 | L2-Norm(final)=10.739 | 1430.7 samples/s | 22.4 steps/s
[Step=81900 Epoch=315.3] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.146 | L2-Norm(final)=10.740 | 3731.9 samples/s | 58.3 steps/s
[Step=81950 Epoch=315.5] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.143 | L2-Norm(final)=10.740 | 3809.8 samples/s | 59.5 steps/s
[Step=82000 Epoch=315.7] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.140 | L2-Norm(final)=10.741 | 3720.1 samples/s | 58.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step82000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05641 | acc=0.9700 | tpr=0.9746 | fpr=0.0399 | 3505.2 samples/s | 13.7 steps/s
Avg test loss: 0.06170, Avg test acc: 0.96739, Avg tpr: 0.97272, Avg fpr: 0.04435, total FA: 346

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05423 | acc=0.9701 | tpr=0.9787 | fpr=0.0486 | 3480.9 samples/s | 13.6 steps/s
Avg test loss: 0.05938, Avg test acc: 0.96883, Avg tpr: 0.97878, Avg fpr: 0.05307, total FA: 414

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.75941 | acc=0.3129 | tpr=0.0147 | fpr=0.0396 | 3476.8 samples/s | 13.6 steps/s
Avg test loss: 4.76966, Avg test acc: 0.31056, Avg tpr: 0.01533, Avg fpr: 0.04012, total FA: 313

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.32094 | acc=0.3175 | tpr=0.0192 | fpr=0.0347 | 3483.7 samples/s | 13.6 steps/s
Avg test loss: 4.33204, Avg test acc: 0.31513, Avg tpr: 0.01906, Avg fpr: 0.03371, total FA: 263

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.15857 | acc=0.1148 | tpr=0.8805 | fpr=0.8989 | 3475.9 samples/s | 13.6 steps/s
[Step= 100] | Loss=5.13902 | acc=0.1165 | tpr=0.8934 | fpr=0.8980 | 6956.8 samples/s | 27.2 steps/s
[Step= 150] | Loss=5.15064 | acc=0.1151 | tpr=0.8948 | fpr=0.8993 | 6687.2 samples/s | 26.1 steps/s
[Step= 200] | Loss=5.13400 | acc=0.1155 | tpr=0.8885 | fpr=0.8986 | 6873.3 samples/s | 26.8 steps/s
[Step= 250] | Loss=5.13925 | acc=0.1156 | tpr=0.8803 | fpr=0.8984 | 6947.1 samples/s | 27.1 steps/s
[Step= 300] | Loss=5.14088 | acc=0.1150 | tpr=0.8800 | fpr=0.8989 | 6726.3 samples/s | 26.3 steps/s
[Step= 350] | Loss=5.13574 | acc=0.1151 | tpr=0.8842 | fpr=0.8988 | 6828.8 samples/s | 26.7 steps/s
[Step= 400] | Loss=5.13330 | acc=0.1151 | tpr=0.8818 | fpr=0.8988 | 6686.0 samples/s | 26.1 steps/s
[Step= 450] | Loss=5.14067 | acc=0.1147 | tpr=0.8822 | fpr=0.8992 | 6890.7 samples/s | 26.9 steps/s
[Step= 500] | Loss=5.14149 | acc=0.1147 | tpr=0.8819 | fpr=0.8992 | 6818.4 samples/s | 26.6 steps/s
[Step= 550] | Loss=5.14068 | acc=0.1149 | tpr=0.8830 | fpr=0.8990 | 12455.7 samples/s | 48.7 steps/s
Avg test loss: 5.14122, Avg test acc: 0.11480, Avg tpr: 0.88233, Avg fpr: 0.89915, total FA: 124845

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.39266 | acc=0.1098 | tpr=0.8938 | fpr=0.9042 | 3499.6 samples/s | 13.7 steps/s
[Step= 100] | Loss=5.37126 | acc=0.1107 | tpr=0.9019 | fpr=0.9040 | 6774.1 samples/s | 26.5 steps/s
[Step= 150] | Loss=5.38717 | acc=0.1094 | tpr=0.9078 | fpr=0.9053 | 6986.9 samples/s | 27.3 steps/s
[Step= 200] | Loss=5.37385 | acc=0.1095 | tpr=0.8984 | fpr=0.9049 | 6834.8 samples/s | 26.7 steps/s
[Step= 250] | Loss=5.37954 | acc=0.1096 | tpr=0.8908 | fpr=0.9047 | 6764.5 samples/s | 26.4 steps/s
[Step= 300] | Loss=5.38282 | acc=0.1090 | tpr=0.8865 | fpr=0.9051 | 6745.5 samples/s | 26.3 steps/s
[Step= 350] | Loss=5.37961 | acc=0.1095 | tpr=0.8898 | fpr=0.9047 | 6980.2 samples/s | 27.3 steps/s
[Step= 400] | Loss=5.37638 | acc=0.1097 | tpr=0.8884 | fpr=0.9044 | 6671.4 samples/s | 26.1 steps/s
[Step= 450] | Loss=5.38490 | acc=0.1094 | tpr=0.8890 | fpr=0.9047 | 6655.2 samples/s | 26.0 steps/s
[Step= 500] | Loss=5.38475 | acc=0.1095 | tpr=0.8907 | fpr=0.9046 | 6981.9 samples/s | 27.3 steps/s
[Step= 550] | Loss=5.38363 | acc=0.1096 | tpr=0.8898 | fpr=0.9046 | 11875.3 samples/s | 46.4 steps/s
Avg test loss: 5.38420, Avg test acc: 0.10951, Avg tpr: 0.88946, Avg fpr: 0.90467, total FA: 125611

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09486 | acc=0.9819 | tpr=0.9381 | fpr=0.0173 | 3518.2 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.09875 | acc=0.9818 | tpr=0.9552 | fpr=0.0177 | 6644.0 samples/s | 26.0 steps/s
[Step= 150] | Loss=0.10187 | acc=0.9808 | tpr=0.9582 | fpr=0.0188 | 6993.6 samples/s | 27.3 steps/s
[Step= 200] | Loss=0.10272 | acc=0.9808 | tpr=0.9585 | fpr=0.0188 | 6675.2 samples/s | 26.1 steps/s
[Step= 250] | Loss=0.10170 | acc=0.9812 | tpr=0.9563 | fpr=0.0184 | 7253.5 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.10334 | acc=0.9808 | tpr=0.9564 | fpr=0.0188 | 6593.6 samples/s | 25.8 steps/s
[Step= 350] | Loss=0.10314 | acc=0.9807 | tpr=0.9562 | fpr=0.0189 | 6831.4 samples/s | 26.7 steps/s
[Step= 400] | Loss=0.10446 | acc=0.9805 | tpr=0.9540 | fpr=0.0190 | 6960.0 samples/s | 27.2 steps/s
[Step= 450] | Loss=0.10661 | acc=0.9801 | tpr=0.9533 | fpr=0.0194 | 6593.5 samples/s | 25.8 steps/s
[Step= 500] | Loss=0.10625 | acc=0.9802 | tpr=0.9559 | fpr=0.0194 | 6688.4 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.10560 | acc=0.9804 | tpr=0.9550 | fpr=0.0192 | 12960.1 samples/s | 50.6 steps/s
Avg test loss: 0.10551, Avg test acc: 0.98036, Avg tpr: 0.95444, Avg fpr: 0.01917, total FA: 2662

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10224 | acc=0.9808 | tpr=0.9425 | fpr=0.0185 | 3486.7 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.10687 | acc=0.9802 | tpr=0.9595 | fpr=0.0194 | 6858.2 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.11014 | acc=0.9793 | tpr=0.9611 | fpr=0.0204 | 7050.9 samples/s | 27.5 steps/s
[Step= 200] | Loss=0.11127 | acc=0.9794 | tpr=0.9596 | fpr=0.0202 | 6784.8 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.11031 | acc=0.9796 | tpr=0.9563 | fpr=0.0200 | 6985.6 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.11219 | acc=0.9792 | tpr=0.9571 | fpr=0.0204 | 6583.6 samples/s | 25.7 steps/s
[Step= 350] | Loss=0.11201 | acc=0.9792 | tpr=0.9574 | fpr=0.0204 | 6798.4 samples/s | 26.6 steps/s
[Step= 400] | Loss=0.11326 | acc=0.9790 | tpr=0.9557 | fpr=0.0206 | 6662.0 samples/s | 26.0 steps/s
[Step= 450] | Loss=0.11549 | acc=0.9786 | tpr=0.9547 | fpr=0.0210 | 6713.4 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.11520 | acc=0.9787 | tpr=0.9573 | fpr=0.0210 | 6712.7 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.11447 | acc=0.9789 | tpr=0.9570 | fpr=0.0207 | 12583.3 samples/s | 49.2 steps/s
Avg test loss: 0.11442, Avg test acc: 0.97889, Avg tpr: 0.95642, Avg fpr: 0.02071, total FA: 2875

server round 41/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=82001 Epoch=159.9] | Loss=0.00248 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.256 | L2-Norm(final)=15.118 | 3125.3 samples/s | 48.8 steps/s
[Step=82050 Epoch=160.0] | Loss=0.00967 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.260 | L2-Norm(final)=15.121 | 4233.0 samples/s | 66.1 steps/s
[Step=82100 Epoch=160.1] | Loss=0.01061 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.265 | L2-Norm(final)=15.124 | 4299.9 samples/s | 67.2 steps/s
[Step=82150 Epoch=160.2] | Loss=0.01008 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.270 | L2-Norm(final)=15.128 | 4452.0 samples/s | 69.6 steps/s
[Step=82200 Epoch=160.3] | Loss=0.01032 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.275 | L2-Norm(final)=15.132 | 4322.8 samples/s | 67.5 steps/s
[Step=82250 Epoch=160.4] | Loss=0.01069 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.279 | L2-Norm(final)=15.136 | 4322.6 samples/s | 67.5 steps/s
[Step=82300 Epoch=160.5] | Loss=0.01087 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.284 | L2-Norm(final)=15.139 | 4329.5 samples/s | 67.6 steps/s
[Step=82350 Epoch=160.6] | Loss=0.01074 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.289 | L2-Norm(final)=15.143 | 4366.3 samples/s | 68.2 steps/s
[Step=82400 Epoch=160.7] | Loss=0.01081 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.294 | L2-Norm(final)=15.147 | 4443.2 samples/s | 69.4 steps/s
[Step=82450 Epoch=160.8] | Loss=0.01053 | Reg=0.00069 | acc=0.9844 | L2-Norm=8.299 | L2-Norm(final)=15.150 | 4266.0 samples/s | 66.7 steps/s
[Step=82500 Epoch=160.9] | Loss=0.01059 | Reg=0.00069 | acc=0.9844 | L2-Norm=8.303 | L2-Norm(final)=15.153 | 5419.9 samples/s | 84.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=82501 Epoch=160.9] | Loss=0.00270 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.347 | L2-Norm(final)=15.188 | 3245.3 samples/s | 50.7 steps/s
[Step=82550 Epoch=161.0] | Loss=0.00878 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.353 | L2-Norm(final)=15.191 | 3628.5 samples/s | 56.7 steps/s
[Step=82600 Epoch=161.1] | Loss=0.00908 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.359 | L2-Norm(final)=15.195 | 3915.9 samples/s | 61.2 steps/s
[Step=82650 Epoch=161.2] | Loss=0.00900 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.365 | L2-Norm(final)=15.198 | 3889.2 samples/s | 60.8 steps/s
[Step=82700 Epoch=161.3] | Loss=0.00941 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.371 | L2-Norm(final)=15.201 | 3881.8 samples/s | 60.7 steps/s
[Step=82750 Epoch=161.4] | Loss=0.00955 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.376 | L2-Norm(final)=15.204 | 3916.8 samples/s | 61.2 steps/s
[Step=82800 Epoch=161.5] | Loss=0.00944 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.380 | L2-Norm(final)=15.207 | 3949.1 samples/s | 61.7 steps/s
[Step=82850 Epoch=161.6] | Loss=0.00961 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.385 | L2-Norm(final)=15.210 | 3910.2 samples/s | 61.1 steps/s
[Step=82900 Epoch=161.7] | Loss=0.00932 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.389 | L2-Norm(final)=15.213 | 3945.6 samples/s | 61.6 steps/s
[Step=82950 Epoch=161.8] | Loss=0.00924 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.393 | L2-Norm(final)=15.216 | 3970.0 samples/s | 62.0 steps/s
[Step=83000 Epoch=161.9] | Loss=0.00931 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.398 | L2-Norm(final)=15.219 | 4813.5 samples/s | 75.2 steps/s
[Step=83050 Epoch=162.0] | Loss=0.00924 | Reg=0.00071 | acc=0.9688 | L2-Norm=8.402 | L2-Norm(final)=15.222 | 1444.1 samples/s | 22.6 steps/s
[Step=83100 Epoch=162.1] | Loss=0.00913 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.406 | L2-Norm(final)=15.225 | 3912.9 samples/s | 61.1 steps/s
[Step=83150 Epoch=162.2] | Loss=0.00893 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.410 | L2-Norm(final)=15.228 | 3915.7 samples/s | 61.2 steps/s
[Step=83200 Epoch=162.3] | Loss=0.00878 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.414 | L2-Norm(final)=15.231 | 3930.1 samples/s | 61.4 steps/s
[Step=83250 Epoch=162.4] | Loss=0.00857 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.418 | L2-Norm(final)=15.233 | 3941.6 samples/s | 61.6 steps/s
[Step=83300 Epoch=162.5] | Loss=0.00837 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.422 | L2-Norm(final)=15.236 | 3928.7 samples/s | 61.4 steps/s
[Step=83350 Epoch=162.6] | Loss=0.00825 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.426 | L2-Norm(final)=15.239 | 3957.3 samples/s | 61.8 steps/s
[Step=83400 Epoch=162.7] | Loss=0.00820 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.429 | L2-Norm(final)=15.242 | 3932.6 samples/s | 61.4 steps/s
[Step=83450 Epoch=162.8] | Loss=0.00819 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.433 | L2-Norm(final)=15.244 | 3961.1 samples/s | 61.9 steps/s
[Step=83500 Epoch=162.9] | Loss=0.00810 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.436 | L2-Norm(final)=15.247 | 4123.7 samples/s | 64.4 steps/s
[Step=83550 Epoch=163.0] | Loss=0.00805 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.439 | L2-Norm(final)=15.249 | 1558.6 samples/s | 24.4 steps/s
[Step=83600 Epoch=163.1] | Loss=0.00789 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.443 | L2-Norm(final)=15.252 | 3940.2 samples/s | 61.6 steps/s
[Step=83650 Epoch=163.1] | Loss=0.00776 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.446 | L2-Norm(final)=15.255 | 3889.1 samples/s | 60.8 steps/s
[Step=83700 Epoch=163.2] | Loss=0.00772 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.449 | L2-Norm(final)=15.257 | 3902.0 samples/s | 61.0 steps/s
[Step=83750 Epoch=163.3] | Loss=0.00772 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.453 | L2-Norm(final)=15.260 | 3921.2 samples/s | 61.3 steps/s
[Step=83800 Epoch=163.4] | Loss=0.00761 | Reg=0.00072 | acc=0.9844 | L2-Norm=8.456 | L2-Norm(final)=15.262 | 3929.4 samples/s | 61.4 steps/s
[Step=83850 Epoch=163.5] | Loss=0.00757 | Reg=0.00072 | acc=0.9688 | L2-Norm=8.459 | L2-Norm(final)=15.264 | 3916.2 samples/s | 61.2 steps/s
[Step=83900 Epoch=163.6] | Loss=0.00755 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.462 | L2-Norm(final)=15.267 | 3916.6 samples/s | 61.2 steps/s
[Step=83950 Epoch=163.7] | Loss=0.00754 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.465 | L2-Norm(final)=15.269 | 3940.5 samples/s | 61.6 steps/s
[Step=84000 Epoch=163.8] | Loss=0.00746 | Reg=0.00072 | acc=1.0000 | L2-Norm=8.468 | L2-Norm(final)=15.271 | 3957.3 samples/s | 61.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step84000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=82001 Epoch=160.3] | Loss=0.00057 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.256 | L2-Norm(final)=15.372 | 3330.0 samples/s | 52.0 steps/s
[Step=82050 Epoch=160.4] | Loss=0.01141 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.260 | L2-Norm(final)=15.374 | 4076.5 samples/s | 63.7 steps/s
[Step=82100 Epoch=160.5] | Loss=0.01130 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.264 | L2-Norm(final)=15.377 | 4367.3 samples/s | 68.2 steps/s
[Step=82150 Epoch=160.6] | Loss=0.01153 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.269 | L2-Norm(final)=15.381 | 4366.8 samples/s | 68.2 steps/s
[Step=82200 Epoch=160.7] | Loss=0.01102 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.273 | L2-Norm(final)=15.385 | 4328.5 samples/s | 67.6 steps/s
[Step=82250 Epoch=160.8] | Loss=0.01111 | Reg=0.00069 | acc=0.9688 | L2-Norm=8.278 | L2-Norm(final)=15.389 | 4393.5 samples/s | 68.6 steps/s
[Step=82300 Epoch=160.9] | Loss=0.01045 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.282 | L2-Norm(final)=15.392 | 4312.7 samples/s | 67.4 steps/s
[Step=82350 Epoch=161.0] | Loss=0.01057 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.286 | L2-Norm(final)=15.396 | 4449.4 samples/s | 69.5 steps/s
[Step=82400 Epoch=161.1] | Loss=0.01042 | Reg=0.00069 | acc=0.9531 | L2-Norm=8.289 | L2-Norm(final)=15.400 | 4347.7 samples/s | 67.9 steps/s
[Step=82450 Epoch=161.2] | Loss=0.01014 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.293 | L2-Norm(final)=15.403 | 4392.9 samples/s | 68.6 steps/s
[Step=82500 Epoch=161.3] | Loss=0.01013 | Reg=0.00069 | acc=0.9844 | L2-Norm=8.297 | L2-Norm(final)=15.407 | 5527.5 samples/s | 86.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=82501 Epoch=161.3] | Loss=0.00504 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.337 | L2-Norm(final)=15.442 | 3250.6 samples/s | 50.8 steps/s
[Step=82550 Epoch=161.4] | Loss=0.00973 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.342 | L2-Norm(final)=15.445 | 3738.3 samples/s | 58.4 steps/s
[Step=82600 Epoch=161.5] | Loss=0.00974 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.347 | L2-Norm(final)=15.448 | 3922.9 samples/s | 61.3 steps/s
[Step=82650 Epoch=161.6] | Loss=0.00955 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.352 | L2-Norm(final)=15.452 | 3951.9 samples/s | 61.7 steps/s
[Step=82700 Epoch=161.7] | Loss=0.00969 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.357 | L2-Norm(final)=15.455 | 3881.6 samples/s | 60.7 steps/s
[Step=82750 Epoch=161.8] | Loss=0.00955 | Reg=0.00070 | acc=0.9688 | L2-Norm=8.362 | L2-Norm(final)=15.459 | 3963.9 samples/s | 61.9 steps/s
[Step=82800 Epoch=161.9] | Loss=0.00928 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.367 | L2-Norm(final)=15.462 | 3924.4 samples/s | 61.3 steps/s
[Step=82850 Epoch=162.0] | Loss=0.00932 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.372 | L2-Norm(final)=15.465 | 3949.7 samples/s | 61.7 steps/s
[Step=82900 Epoch=162.1] | Loss=0.00938 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.376 | L2-Norm(final)=15.468 | 3997.8 samples/s | 62.5 steps/s
[Step=82950 Epoch=162.2] | Loss=0.00915 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.381 | L2-Norm(final)=15.471 | 3911.1 samples/s | 61.1 steps/s
[Step=83000 Epoch=162.3] | Loss=0.00911 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.385 | L2-Norm(final)=15.474 | 4832.2 samples/s | 75.5 steps/s
[Step=83050 Epoch=162.4] | Loss=0.00883 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.390 | L2-Norm(final)=15.477 | 1496.9 samples/s | 23.4 steps/s
[Step=83100 Epoch=162.5] | Loss=0.00877 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.394 | L2-Norm(final)=15.480 | 3911.1 samples/s | 61.1 steps/s
[Step=83150 Epoch=162.6] | Loss=0.00851 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.398 | L2-Norm(final)=15.483 | 3938.8 samples/s | 61.5 steps/s
[Step=83200 Epoch=162.7] | Loss=0.00838 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.402 | L2-Norm(final)=15.486 | 3921.9 samples/s | 61.3 steps/s
[Step=83250 Epoch=162.8] | Loss=0.00819 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.406 | L2-Norm(final)=15.489 | 3926.1 samples/s | 61.3 steps/s
[Step=83300 Epoch=162.8] | Loss=0.00808 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.409 | L2-Norm(final)=15.491 | 3933.1 samples/s | 61.5 steps/s
[Step=83350 Epoch=162.9] | Loss=0.00815 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.413 | L2-Norm(final)=15.494 | 3930.3 samples/s | 61.4 steps/s
[Step=83400 Epoch=163.0] | Loss=0.00803 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.417 | L2-Norm(final)=15.497 | 3930.5 samples/s | 61.4 steps/s
[Step=83450 Epoch=163.1] | Loss=0.00792 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.420 | L2-Norm(final)=15.499 | 3955.0 samples/s | 61.8 steps/s
[Step=83500 Epoch=163.2] | Loss=0.00784 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.423 | L2-Norm(final)=15.502 | 4226.4 samples/s | 66.0 steps/s
[Step=83550 Epoch=163.3] | Loss=0.00776 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.427 | L2-Norm(final)=15.504 | 1547.0 samples/s | 24.2 steps/s
[Step=83600 Epoch=163.4] | Loss=0.00767 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.430 | L2-Norm(final)=15.507 | 3931.5 samples/s | 61.4 steps/s
[Step=83650 Epoch=163.5] | Loss=0.00752 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.433 | L2-Norm(final)=15.510 | 3975.4 samples/s | 62.1 steps/s
[Step=83700 Epoch=163.6] | Loss=0.00748 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.436 | L2-Norm(final)=15.512 | 3918.0 samples/s | 61.2 steps/s
[Step=83750 Epoch=163.7] | Loss=0.00731 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.439 | L2-Norm(final)=15.515 | 3899.8 samples/s | 60.9 steps/s
[Step=83800 Epoch=163.8] | Loss=0.00727 | Reg=0.00071 | acc=0.9688 | L2-Norm=8.443 | L2-Norm(final)=15.517 | 3929.4 samples/s | 61.4 steps/s
[Step=83850 Epoch=163.9] | Loss=0.00724 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.446 | L2-Norm(final)=15.520 | 3919.6 samples/s | 61.2 steps/s
[Step=83900 Epoch=164.0] | Loss=0.00720 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.449 | L2-Norm(final)=15.522 | 3922.1 samples/s | 61.3 steps/s
[Step=83950 Epoch=164.1] | Loss=0.00717 | Reg=0.00071 | acc=0.9844 | L2-Norm=8.452 | L2-Norm(final)=15.525 | 3939.0 samples/s | 61.5 steps/s
[Step=84000 Epoch=164.2] | Loss=0.00709 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.455 | L2-Norm(final)=15.527 | 3872.8 samples/s | 60.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step84000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=82001 Epoch=314.2] | Loss=0.00004 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.256 | L2-Norm(final)=10.801 | 3195.1 samples/s | 49.9 steps/s
[Step=82050 Epoch=314.4] | Loss=0.00006 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.253 | L2-Norm(final)=10.803 | 3851.6 samples/s | 60.2 steps/s
[Step=82100 Epoch=314.6] | Loss=0.00006 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.252 | L2-Norm(final)=10.806 | 4116.7 samples/s | 64.3 steps/s
[Step=82150 Epoch=314.8] | Loss=0.00005 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.251 | L2-Norm(final)=10.809 | 4115.4 samples/s | 64.3 steps/s
[Step=82200 Epoch=315.0] | Loss=0.00005 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.250 | L2-Norm(final)=10.812 | 4156.0 samples/s | 64.9 steps/s
[Step=82250 Epoch=315.2] | Loss=0.00004 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.249 | L2-Norm(final)=10.814 | 5276.6 samples/s | 82.4 steps/s
[Step=82300 Epoch=315.3] | Loss=0.00004 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.248 | L2-Norm(final)=10.817 | 1497.3 samples/s | 23.4 steps/s
[Step=82350 Epoch=315.5] | Loss=0.00004 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.247 | L2-Norm(final)=10.819 | 4147.4 samples/s | 64.8 steps/s
[Step=82400 Epoch=315.7] | Loss=0.00003 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.246 | L2-Norm(final)=10.821 | 4093.0 samples/s | 64.0 steps/s
[Step=82450 Epoch=315.9] | Loss=0.00003 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.244 | L2-Norm(final)=10.823 | 4141.4 samples/s | 64.7 steps/s
[Step=82500 Epoch=316.1] | Loss=0.00003 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.243 | L2-Norm(final)=10.825 | 4623.1 samples/s | 72.2 steps/s
All layers training...
LR=0.00006, len=1
[Step=82501 Epoch=316.1] | Loss=0.00001 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.229 | L2-Norm(final)=10.846 | 3152.5 samples/s | 49.3 steps/s
[Step=82550 Epoch=316.3] | Loss=0.00002 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.226 | L2-Norm(final)=10.848 | 3571.3 samples/s | 55.8 steps/s
[Step=82600 Epoch=316.5] | Loss=0.00002 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.224 | L2-Norm(final)=10.850 | 3722.8 samples/s | 58.2 steps/s
[Step=82650 Epoch=316.7] | Loss=0.00002 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.221 | L2-Norm(final)=10.851 | 3737.2 samples/s | 58.4 steps/s
[Step=82700 Epoch=316.9] | Loss=0.00002 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.218 | L2-Norm(final)=10.853 | 3666.1 samples/s | 57.3 steps/s
[Step=82750 Epoch=317.1] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.215 | L2-Norm(final)=10.854 | 4757.0 samples/s | 74.3 steps/s
[Step=82800 Epoch=317.3] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.212 | L2-Norm(final)=10.856 | 1512.3 samples/s | 23.6 steps/s
[Step=82850 Epoch=317.5] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.208 | L2-Norm(final)=10.857 | 3724.2 samples/s | 58.2 steps/s
[Step=82900 Epoch=317.6] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.205 | L2-Norm(final)=10.858 | 3749.6 samples/s | 58.6 steps/s
[Step=82950 Epoch=317.8] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.201 | L2-Norm(final)=10.859 | 3720.9 samples/s | 58.1 steps/s
[Step=83000 Epoch=318.0] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.198 | L2-Norm(final)=10.860 | 4151.6 samples/s | 64.9 steps/s
[Step=83050 Epoch=318.2] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.194 | L2-Norm(final)=10.862 | 1552.5 samples/s | 24.3 steps/s
[Step=83100 Epoch=318.4] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.191 | L2-Norm(final)=10.863 | 3663.6 samples/s | 57.2 steps/s
[Step=83150 Epoch=318.6] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.187 | L2-Norm(final)=10.864 | 3758.1 samples/s | 58.7 steps/s
[Step=83200 Epoch=318.8] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.184 | L2-Norm(final)=10.865 | 3680.6 samples/s | 57.5 steps/s
[Step=83250 Epoch=319.0] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.180 | L2-Norm(final)=10.866 | 3718.0 samples/s | 58.1 steps/s
[Step=83300 Epoch=319.2] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.176 | L2-Norm(final)=10.867 | 1546.5 samples/s | 24.2 steps/s
[Step=83350 Epoch=319.4] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.172 | L2-Norm(final)=10.868 | 3783.5 samples/s | 59.1 steps/s
[Step=83400 Epoch=319.6] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.168 | L2-Norm(final)=10.868 | 3722.0 samples/s | 58.2 steps/s
[Step=83450 Epoch=319.8] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.164 | L2-Norm(final)=10.869 | 3712.9 samples/s | 58.0 steps/s
[Step=83500 Epoch=319.9] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.160 | L2-Norm(final)=10.870 | 3727.5 samples/s | 58.2 steps/s
[Step=83550 Epoch=320.1] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.156 | L2-Norm(final)=10.871 | 1620.4 samples/s | 25.3 steps/s
[Step=83600 Epoch=320.3] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.152 | L2-Norm(final)=10.872 | 3716.3 samples/s | 58.1 steps/s
[Step=83650 Epoch=320.5] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.148 | L2-Norm(final)=10.873 | 3703.9 samples/s | 57.9 steps/s
[Step=83700 Epoch=320.7] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.144 | L2-Norm(final)=10.874 | 3715.6 samples/s | 58.1 steps/s
[Step=83750 Epoch=320.9] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.140 | L2-Norm(final)=10.875 | 3722.9 samples/s | 58.2 steps/s
[Step=83800 Epoch=321.1] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.136 | L2-Norm(final)=10.875 | 5082.3 samples/s | 79.4 steps/s
[Step=83850 Epoch=321.3] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.131 | L2-Norm(final)=10.876 | 1433.9 samples/s | 22.4 steps/s
[Step=83900 Epoch=321.5] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.127 | L2-Norm(final)=10.877 | 3736.3 samples/s | 58.4 steps/s
[Step=83950 Epoch=321.7] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.123 | L2-Norm(final)=10.878 | 3686.0 samples/s | 57.6 steps/s
[Step=84000 Epoch=321.9] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.118 | L2-Norm(final)=10.879 | 3744.3 samples/s | 58.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step84000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=82001 Epoch=315.7] | Loss=0.00013 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.256 | L2-Norm(final)=10.761 | 3406.3 samples/s | 53.2 steps/s
[Step=82050 Epoch=315.8] | Loss=0.00010 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.254 | L2-Norm(final)=10.765 | 3595.9 samples/s | 56.2 steps/s
[Step=82100 Epoch=316.0] | Loss=0.00010 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.255 | L2-Norm(final)=10.771 | 4111.8 samples/s | 64.2 steps/s
[Step=82150 Epoch=316.2] | Loss=0.00009 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.257 | L2-Norm(final)=10.775 | 4075.5 samples/s | 63.7 steps/s
[Step=82200 Epoch=316.4] | Loss=0.00008 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.257 | L2-Norm(final)=10.779 | 4181.7 samples/s | 65.3 steps/s
[Step=82250 Epoch=316.6] | Loss=0.00008 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.257 | L2-Norm(final)=10.782 | 5483.2 samples/s | 85.7 steps/s
[Step=82300 Epoch=316.8] | Loss=0.00007 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.257 | L2-Norm(final)=10.786 | 1473.0 samples/s | 23.0 steps/s
[Step=82350 Epoch=317.0] | Loss=0.00006 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.256 | L2-Norm(final)=10.789 | 4117.2 samples/s | 64.3 steps/s
[Step=82400 Epoch=317.2] | Loss=0.00006 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.255 | L2-Norm(final)=10.792 | 4166.2 samples/s | 65.1 steps/s
[Step=82450 Epoch=317.4] | Loss=0.00006 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.255 | L2-Norm(final)=10.795 | 4085.3 samples/s | 63.8 steps/s
[Step=82500 Epoch=317.6] | Loss=0.00005 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.254 | L2-Norm(final)=10.798 | 4645.3 samples/s | 72.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=82501 Epoch=317.6] | Loss=0.00000 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.246 | L2-Norm(final)=10.827 | 3330.2 samples/s | 52.0 steps/s
[Step=82550 Epoch=317.8] | Loss=0.00002 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.244 | L2-Norm(final)=10.829 | 3399.6 samples/s | 53.1 steps/s
[Step=82600 Epoch=318.0] | Loss=0.00002 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.240 | L2-Norm(final)=10.831 | 3687.4 samples/s | 57.6 steps/s
[Step=82650 Epoch=318.2] | Loss=0.00002 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.236 | L2-Norm(final)=10.833 | 3736.7 samples/s | 58.4 steps/s
[Step=82700 Epoch=318.3] | Loss=0.00002 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.232 | L2-Norm(final)=10.835 | 3704.3 samples/s | 57.9 steps/s
[Step=82750 Epoch=318.5] | Loss=0.00002 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.228 | L2-Norm(final)=10.836 | 4787.1 samples/s | 74.8 steps/s
[Step=82800 Epoch=318.7] | Loss=0.00002 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.224 | L2-Norm(final)=10.838 | 1456.6 samples/s | 22.8 steps/s
[Step=82850 Epoch=318.9] | Loss=0.00001 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.220 | L2-Norm(final)=10.839 | 3715.4 samples/s | 58.1 steps/s
[Step=82900 Epoch=319.1] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.215 | L2-Norm(final)=10.840 | 3762.0 samples/s | 58.8 steps/s
[Step=82950 Epoch=319.3] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.210 | L2-Norm(final)=10.841 | 3750.2 samples/s | 58.6 steps/s
[Step=83000 Epoch=319.5] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.206 | L2-Norm(final)=10.843 | 4194.0 samples/s | 65.5 steps/s
[Step=83050 Epoch=319.7] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.201 | L2-Norm(final)=10.844 | 1533.0 samples/s | 24.0 steps/s
[Step=83100 Epoch=319.9] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.196 | L2-Norm(final)=10.845 | 3770.4 samples/s | 58.9 steps/s
[Step=83150 Epoch=320.1] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.191 | L2-Norm(final)=10.846 | 3712.9 samples/s | 58.0 steps/s
[Step=83200 Epoch=320.3] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.186 | L2-Norm(final)=10.847 | 3712.3 samples/s | 58.0 steps/s
[Step=83250 Epoch=320.5] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.181 | L2-Norm(final)=10.847 | 3843.1 samples/s | 60.0 steps/s
[Step=83300 Epoch=320.7] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.175 | L2-Norm(final)=10.848 | 1570.3 samples/s | 24.5 steps/s
[Step=83350 Epoch=320.8] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.170 | L2-Norm(final)=10.849 | 3749.6 samples/s | 58.6 steps/s
[Step=83400 Epoch=321.0] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.165 | L2-Norm(final)=10.850 | 3759.6 samples/s | 58.7 steps/s
[Step=83450 Epoch=321.2] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.159 | L2-Norm(final)=10.851 | 3708.4 samples/s | 57.9 steps/s
[Step=83500 Epoch=321.4] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.153 | L2-Norm(final)=10.852 | 3765.8 samples/s | 58.8 steps/s
[Step=83550 Epoch=321.6] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.148 | L2-Norm(final)=10.853 | 1572.8 samples/s | 24.6 steps/s
[Step=83600 Epoch=321.8] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.142 | L2-Norm(final)=10.854 | 3745.6 samples/s | 58.5 steps/s
[Step=83650 Epoch=322.0] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.136 | L2-Norm(final)=10.854 | 3718.7 samples/s | 58.1 steps/s
[Step=83700 Epoch=322.2] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.130 | L2-Norm(final)=10.855 | 3711.7 samples/s | 58.0 steps/s
[Step=83750 Epoch=322.4] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.124 | L2-Norm(final)=10.856 | 3718.4 samples/s | 58.1 steps/s
[Step=83800 Epoch=322.6] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.118 | L2-Norm(final)=10.857 | 5428.2 samples/s | 84.8 steps/s
[Step=83850 Epoch=322.8] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.112 | L2-Norm(final)=10.858 | 1420.5 samples/s | 22.2 steps/s
[Step=83900 Epoch=323.0] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.106 | L2-Norm(final)=10.858 | 3681.7 samples/s | 57.5 steps/s
[Step=83950 Epoch=323.2] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.100 | L2-Norm(final)=10.859 | 3751.2 samples/s | 58.6 steps/s
[Step=84000 Epoch=323.3] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.094 | L2-Norm(final)=10.860 | 3719.9 samples/s | 58.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step84000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05529 | acc=0.9701 | tpr=0.9749 | fpr=0.0404 | 3518.4 samples/s | 13.7 steps/s
Avg test loss: 0.06096, Avg test acc: 0.96819, Avg tpr: 0.97331, Avg fpr: 0.04307, total FA: 336

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05621 | acc=0.9698 | tpr=0.9749 | fpr=0.0411 | 3520.5 samples/s | 13.8 steps/s
Avg test loss: 0.06146, Avg test acc: 0.96839, Avg tpr: 0.97465, Avg fpr: 0.04538, total FA: 354

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.05542 | acc=0.3114 | tpr=0.0146 | fpr=0.0441 | 3510.5 samples/s | 13.7 steps/s
Avg test loss: 5.06718, Avg test acc: 0.30924, Avg tpr: 0.01515, Avg fpr: 0.04397, total FA: 343

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.59791 | acc=0.3172 | tpr=0.0189 | fpr=0.0352 | 3507.6 samples/s | 13.7 steps/s
Avg test loss: 4.60972, Avg test acc: 0.31437, Avg tpr: 0.01848, Avg fpr: 0.03487, total FA: 272

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.13601 | acc=0.1187 | tpr=0.8496 | fpr=0.8945 | 3531.1 samples/s | 13.8 steps/s
[Step= 100] | Loss=5.11651 | acc=0.1208 | tpr=0.8785 | fpr=0.8934 | 6780.4 samples/s | 26.5 steps/s
[Step= 150] | Loss=5.12957 | acc=0.1195 | tpr=0.8790 | fpr=0.8945 | 6866.9 samples/s | 26.8 steps/s
[Step= 200] | Loss=5.11344 | acc=0.1200 | tpr=0.8732 | fpr=0.8937 | 6947.4 samples/s | 27.1 steps/s
[Step= 250] | Loss=5.11883 | acc=0.1201 | tpr=0.8620 | fpr=0.8934 | 6713.6 samples/s | 26.2 steps/s
[Step= 300] | Loss=5.12070 | acc=0.1193 | tpr=0.8604 | fpr=0.8942 | 7000.3 samples/s | 27.3 steps/s
[Step= 350] | Loss=5.11508 | acc=0.1198 | tpr=0.8660 | fpr=0.8938 | 6695.7 samples/s | 26.2 steps/s
[Step= 400] | Loss=5.11280 | acc=0.1198 | tpr=0.8627 | fpr=0.8937 | 6719.7 samples/s | 26.2 steps/s
[Step= 450] | Loss=5.12004 | acc=0.1193 | tpr=0.8647 | fpr=0.8942 | 6593.0 samples/s | 25.8 steps/s
[Step= 500] | Loss=5.12079 | acc=0.1193 | tpr=0.8652 | fpr=0.8942 | 6810.9 samples/s | 26.6 steps/s
[Step= 550] | Loss=5.12020 | acc=0.1197 | tpr=0.8675 | fpr=0.8939 | 12590.1 samples/s | 49.2 steps/s
Avg test loss: 5.12081, Avg test acc: 0.11958, Avg tpr: 0.86688, Avg fpr: 0.89401, total FA: 124131

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.34826 | acc=0.1203 | tpr=0.8628 | fpr=0.8930 | 3535.6 samples/s | 13.8 steps/s
[Step= 100] | Loss=5.32537 | acc=0.1222 | tpr=0.8806 | fpr=0.8919 | 6600.7 samples/s | 25.8 steps/s
[Step= 150] | Loss=5.34009 | acc=0.1210 | tpr=0.8818 | fpr=0.8930 | 6911.8 samples/s | 27.0 steps/s
[Step= 200] | Loss=5.32683 | acc=0.1211 | tpr=0.8732 | fpr=0.8926 | 6764.3 samples/s | 26.4 steps/s
[Step= 250] | Loss=5.33287 | acc=0.1210 | tpr=0.8646 | fpr=0.8925 | 6816.6 samples/s | 26.6 steps/s
[Step= 300] | Loss=5.33685 | acc=0.1204 | tpr=0.8604 | fpr=0.8931 | 6905.6 samples/s | 27.0 steps/s
[Step= 350] | Loss=5.33330 | acc=0.1210 | tpr=0.8666 | fpr=0.8925 | 6986.8 samples/s | 27.3 steps/s
[Step= 400] | Loss=5.32968 | acc=0.1213 | tpr=0.8643 | fpr=0.8922 | 6749.2 samples/s | 26.4 steps/s
[Step= 450] | Loss=5.33803 | acc=0.1210 | tpr=0.8656 | fpr=0.8926 | 6709.9 samples/s | 26.2 steps/s
[Step= 500] | Loss=5.33780 | acc=0.1211 | tpr=0.8674 | fpr=0.8924 | 6738.3 samples/s | 26.3 steps/s
[Step= 550] | Loss=5.33701 | acc=0.1212 | tpr=0.8671 | fpr=0.8923 | 12461.1 samples/s | 48.7 steps/s
Avg test loss: 5.33756, Avg test acc: 0.12113, Avg tpr: 0.86688, Avg fpr: 0.89242, total FA: 123911

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10030 | acc=0.9820 | tpr=0.9381 | fpr=0.0172 | 3532.3 samples/s | 13.8 steps/s
[Step= 100] | Loss=0.10459 | acc=0.9819 | tpr=0.9552 | fpr=0.0176 | 6717.0 samples/s | 26.2 steps/s
[Step= 150] | Loss=0.10775 | acc=0.9810 | tpr=0.9597 | fpr=0.0186 | 6997.3 samples/s | 27.3 steps/s
[Step= 200] | Loss=0.10864 | acc=0.9809 | tpr=0.9596 | fpr=0.0187 | 6788.8 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.10761 | acc=0.9813 | tpr=0.9563 | fpr=0.0182 | 6886.9 samples/s | 26.9 steps/s
[Step= 300] | Loss=0.10926 | acc=0.9810 | tpr=0.9556 | fpr=0.0185 | 6859.0 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.10908 | acc=0.9808 | tpr=0.9555 | fpr=0.0187 | 6880.3 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.11049 | acc=0.9806 | tpr=0.9535 | fpr=0.0189 | 6759.4 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.11276 | acc=0.9803 | tpr=0.9528 | fpr=0.0192 | 6937.3 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.11233 | acc=0.9804 | tpr=0.9555 | fpr=0.0192 | 6700.9 samples/s | 26.2 steps/s
[Step= 550] | Loss=0.11165 | acc=0.9805 | tpr=0.9546 | fpr=0.0190 | 12410.9 samples/s | 48.5 steps/s
Avg test loss: 0.11155, Avg test acc: 0.98052, Avg tpr: 0.95404, Avg fpr: 0.01900, total FA: 2638

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10376 | acc=0.9816 | tpr=0.9425 | fpr=0.0177 | 3559.4 samples/s | 13.9 steps/s
[Step= 100] | Loss=0.10856 | acc=0.9810 | tpr=0.9595 | fpr=0.0186 | 6745.1 samples/s | 26.3 steps/s
[Step= 150] | Loss=0.11176 | acc=0.9800 | tpr=0.9611 | fpr=0.0196 | 6974.0 samples/s | 27.2 steps/s
[Step= 200] | Loss=0.11302 | acc=0.9800 | tpr=0.9607 | fpr=0.0196 | 6743.2 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.11213 | acc=0.9801 | tpr=0.9572 | fpr=0.0195 | 6926.0 samples/s | 27.1 steps/s
[Step= 300] | Loss=0.11392 | acc=0.9798 | tpr=0.9571 | fpr=0.0198 | 6751.5 samples/s | 26.4 steps/s
[Step= 350] | Loss=0.11374 | acc=0.9797 | tpr=0.9574 | fpr=0.0199 | 6895.5 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.11501 | acc=0.9794 | tpr=0.9557 | fpr=0.0201 | 6778.8 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.11727 | acc=0.9791 | tpr=0.9547 | fpr=0.0205 | 6820.1 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.11694 | acc=0.9791 | tpr=0.9573 | fpr=0.0205 | 6790.0 samples/s | 26.5 steps/s
[Step= 550] | Loss=0.11619 | acc=0.9793 | tpr=0.9570 | fpr=0.0203 | 12548.4 samples/s | 49.0 steps/s
Avg test loss: 0.11615, Avg test acc: 0.97931, Avg tpr: 0.95642, Avg fpr: 0.02027, total FA: 2815

server round 42/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=84001 Epoch=163.8] | Loss=0.00474 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.201 | L2-Norm(final)=15.340 | 3160.5 samples/s | 49.4 steps/s
[Step=84050 Epoch=163.9] | Loss=0.00962 | Reg=0.00067 | acc=0.9844 | L2-Norm=8.206 | L2-Norm(final)=15.343 | 4037.3 samples/s | 63.1 steps/s
[Step=84100 Epoch=164.0] | Loss=0.01101 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.210 | L2-Norm(final)=15.347 | 4337.3 samples/s | 67.8 steps/s
[Step=84150 Epoch=164.1] | Loss=0.01133 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.215 | L2-Norm(final)=15.350 | 4361.0 samples/s | 68.1 steps/s
[Step=84200 Epoch=164.2] | Loss=0.01144 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.220 | L2-Norm(final)=15.354 | 4355.9 samples/s | 68.1 steps/s
[Step=84250 Epoch=164.3] | Loss=0.01102 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.224 | L2-Norm(final)=15.357 | 4480.4 samples/s | 70.0 steps/s
[Step=84300 Epoch=164.4] | Loss=0.01089 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.229 | L2-Norm(final)=15.360 | 4364.3 samples/s | 68.2 steps/s
[Step=84350 Epoch=164.5] | Loss=0.01084 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.233 | L2-Norm(final)=15.363 | 4374.6 samples/s | 68.4 steps/s
[Step=84400 Epoch=164.6] | Loss=0.01045 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.237 | L2-Norm(final)=15.367 | 4395.1 samples/s | 68.7 steps/s
[Step=84450 Epoch=164.7] | Loss=0.01035 | Reg=0.00068 | acc=0.9844 | L2-Norm=8.242 | L2-Norm(final)=15.370 | 4352.0 samples/s | 68.0 steps/s
[Step=84500 Epoch=164.8] | Loss=0.01026 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.246 | L2-Norm(final)=15.373 | 5524.0 samples/s | 86.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=84501 Epoch=164.8] | Loss=0.00408 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.286 | L2-Norm(final)=15.404 | 2934.3 samples/s | 45.8 steps/s
[Step=84550 Epoch=164.9] | Loss=0.00959 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.291 | L2-Norm(final)=15.408 | 3866.6 samples/s | 60.4 steps/s
[Step=84600 Epoch=165.0] | Loss=0.00956 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.296 | L2-Norm(final)=15.410 | 3861.7 samples/s | 60.3 steps/s
[Step=84650 Epoch=165.1] | Loss=0.00973 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.301 | L2-Norm(final)=15.413 | 3864.8 samples/s | 60.4 steps/s
[Step=84700 Epoch=165.2] | Loss=0.00980 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.307 | L2-Norm(final)=15.416 | 3902.6 samples/s | 61.0 steps/s
[Step=84750 Epoch=165.3] | Loss=0.01000 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.312 | L2-Norm(final)=15.419 | 3958.0 samples/s | 61.8 steps/s
[Step=84800 Epoch=165.4] | Loss=0.00993 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.317 | L2-Norm(final)=15.423 | 3943.7 samples/s | 61.6 steps/s
[Step=84850 Epoch=165.5] | Loss=0.00944 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.321 | L2-Norm(final)=15.426 | 3859.0 samples/s | 60.3 steps/s
[Step=84900 Epoch=165.6] | Loss=0.00949 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.326 | L2-Norm(final)=15.429 | 3891.3 samples/s | 60.8 steps/s
[Step=84950 Epoch=165.7] | Loss=0.00964 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.330 | L2-Norm(final)=15.431 | 3955.6 samples/s | 61.8 steps/s
[Step=85000 Epoch=165.8] | Loss=0.00949 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.334 | L2-Norm(final)=15.434 | 4782.5 samples/s | 74.7 steps/s
[Step=85050 Epoch=165.9] | Loss=0.00932 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.338 | L2-Norm(final)=15.437 | 1453.5 samples/s | 22.7 steps/s
[Step=85100 Epoch=166.0] | Loss=0.00915 | Reg=0.00070 | acc=0.9688 | L2-Norm=8.342 | L2-Norm(final)=15.440 | 3904.1 samples/s | 61.0 steps/s
[Step=85150 Epoch=166.1] | Loss=0.00893 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.346 | L2-Norm(final)=15.443 | 3886.3 samples/s | 60.7 steps/s
[Step=85200 Epoch=166.2] | Loss=0.00881 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.350 | L2-Norm(final)=15.445 | 3888.2 samples/s | 60.8 steps/s
[Step=85250 Epoch=166.3] | Loss=0.00875 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.354 | L2-Norm(final)=15.448 | 3902.6 samples/s | 61.0 steps/s
[Step=85300 Epoch=166.4] | Loss=0.00856 | Reg=0.00070 | acc=0.9688 | L2-Norm=8.357 | L2-Norm(final)=15.450 | 3946.9 samples/s | 61.7 steps/s
[Step=85350 Epoch=166.5] | Loss=0.00847 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.361 | L2-Norm(final)=15.453 | 3898.3 samples/s | 60.9 steps/s
[Step=85400 Epoch=166.6] | Loss=0.00839 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.364 | L2-Norm(final)=15.456 | 3914.3 samples/s | 61.2 steps/s
[Step=85450 Epoch=166.7] | Loss=0.00829 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.368 | L2-Norm(final)=15.458 | 3939.1 samples/s | 61.5 steps/s
[Step=85500 Epoch=166.8] | Loss=0.00822 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.371 | L2-Norm(final)=15.460 | 4142.4 samples/s | 64.7 steps/s
[Step=85550 Epoch=166.9] | Loss=0.00810 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.374 | L2-Norm(final)=15.463 | 1544.5 samples/s | 24.1 steps/s
[Step=85600 Epoch=167.0] | Loss=0.00803 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.377 | L2-Norm(final)=15.465 | 3862.2 samples/s | 60.3 steps/s
[Step=85650 Epoch=167.1] | Loss=0.00801 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.380 | L2-Norm(final)=15.468 | 3890.0 samples/s | 60.8 steps/s
[Step=85700 Epoch=167.1] | Loss=0.00795 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.383 | L2-Norm(final)=15.470 | 3918.0 samples/s | 61.2 steps/s
[Step=85750 Epoch=167.2] | Loss=0.00782 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.387 | L2-Norm(final)=15.472 | 3886.2 samples/s | 60.7 steps/s
[Step=85800 Epoch=167.3] | Loss=0.00772 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.390 | L2-Norm(final)=15.475 | 3921.0 samples/s | 61.3 steps/s
[Step=85850 Epoch=167.4] | Loss=0.00770 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.393 | L2-Norm(final)=15.477 | 3955.4 samples/s | 61.8 steps/s
[Step=85900 Epoch=167.5] | Loss=0.00762 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.396 | L2-Norm(final)=15.479 | 3938.6 samples/s | 61.5 steps/s
[Step=85950 Epoch=167.6] | Loss=0.00760 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.399 | L2-Norm(final)=15.482 | 3918.2 samples/s | 61.2 steps/s
[Step=86000 Epoch=167.7] | Loss=0.00752 | Reg=0.00071 | acc=1.0000 | L2-Norm=8.401 | L2-Norm(final)=15.484 | 3919.0 samples/s | 61.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step86000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=84001 Epoch=164.2] | Loss=0.00090 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.201 | L2-Norm(final)=15.601 | 3408.8 samples/s | 53.3 steps/s
[Step=84050 Epoch=164.3] | Loss=0.01049 | Reg=0.00067 | acc=0.9688 | L2-Norm=8.205 | L2-Norm(final)=15.603 | 3973.3 samples/s | 62.1 steps/s
[Step=84100 Epoch=164.4] | Loss=0.01014 | Reg=0.00067 | acc=0.9844 | L2-Norm=8.209 | L2-Norm(final)=15.606 | 4386.4 samples/s | 68.5 steps/s
[Step=84150 Epoch=164.5] | Loss=0.01026 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.213 | L2-Norm(final)=15.609 | 4315.4 samples/s | 67.4 steps/s
[Step=84200 Epoch=164.6] | Loss=0.01034 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.217 | L2-Norm(final)=15.612 | 4393.8 samples/s | 68.7 steps/s
[Step=84250 Epoch=164.7] | Loss=0.01001 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.221 | L2-Norm(final)=15.616 | 4396.9 samples/s | 68.7 steps/s
[Step=84300 Epoch=164.8] | Loss=0.00971 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.225 | L2-Norm(final)=15.619 | 4332.8 samples/s | 67.7 steps/s
[Step=84350 Epoch=164.9] | Loss=0.00975 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.229 | L2-Norm(final)=15.623 | 4411.7 samples/s | 68.9 steps/s
[Step=84400 Epoch=165.0] | Loss=0.00970 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.232 | L2-Norm(final)=15.627 | 4326.7 samples/s | 67.6 steps/s
[Step=84450 Epoch=165.1] | Loss=0.00980 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.236 | L2-Norm(final)=15.630 | 4401.1 samples/s | 68.8 steps/s
[Step=84500 Epoch=165.2] | Loss=0.00987 | Reg=0.00068 | acc=1.0000 | L2-Norm=8.240 | L2-Norm(final)=15.633 | 5556.5 samples/s | 86.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=84501 Epoch=165.2] | Loss=0.02483 | Reg=0.00069 | acc=0.9688 | L2-Norm=8.277 | L2-Norm(final)=15.668 | 3190.2 samples/s | 49.8 steps/s
[Step=84550 Epoch=165.3] | Loss=0.01069 | Reg=0.00069 | acc=0.9844 | L2-Norm=8.282 | L2-Norm(final)=15.671 | 3883.9 samples/s | 60.7 steps/s
[Step=84600 Epoch=165.4] | Loss=0.01023 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.287 | L2-Norm(final)=15.674 | 3950.2 samples/s | 61.7 steps/s
[Step=84650 Epoch=165.5] | Loss=0.00962 | Reg=0.00069 | acc=0.9844 | L2-Norm=8.293 | L2-Norm(final)=15.677 | 3930.6 samples/s | 61.4 steps/s
[Step=84700 Epoch=165.6] | Loss=0.00956 | Reg=0.00069 | acc=0.9844 | L2-Norm=8.298 | L2-Norm(final)=15.681 | 3898.9 samples/s | 60.9 steps/s
[Step=84750 Epoch=165.7] | Loss=0.00941 | Reg=0.00069 | acc=0.9844 | L2-Norm=8.303 | L2-Norm(final)=15.683 | 3934.3 samples/s | 61.5 steps/s
[Step=84800 Epoch=165.8] | Loss=0.00927 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.308 | L2-Norm(final)=15.687 | 3962.2 samples/s | 61.9 steps/s
[Step=84850 Epoch=165.9] | Loss=0.00901 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.312 | L2-Norm(final)=15.690 | 3880.1 samples/s | 60.6 steps/s
[Step=84900 Epoch=166.0] | Loss=0.00884 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.316 | L2-Norm(final)=15.692 | 4016.7 samples/s | 62.8 steps/s
[Step=84950 Epoch=166.1] | Loss=0.00860 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.321 | L2-Norm(final)=15.695 | 3930.0 samples/s | 61.4 steps/s
[Step=85000 Epoch=166.2] | Loss=0.00867 | Reg=0.00069 | acc=0.9844 | L2-Norm=8.325 | L2-Norm(final)=15.699 | 4916.5 samples/s | 76.8 steps/s
[Step=85050 Epoch=166.3] | Loss=0.00853 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.329 | L2-Norm(final)=15.701 | 1483.0 samples/s | 23.2 steps/s
[Step=85100 Epoch=166.4] | Loss=0.00844 | Reg=0.00069 | acc=1.0000 | L2-Norm=8.333 | L2-Norm(final)=15.704 | 3945.3 samples/s | 61.6 steps/s
[Step=85150 Epoch=166.5] | Loss=0.00826 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.337 | L2-Norm(final)=15.707 | 3957.6 samples/s | 61.8 steps/s
[Step=85200 Epoch=166.6] | Loss=0.00807 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.341 | L2-Norm(final)=15.710 | 3889.0 samples/s | 60.8 steps/s
[Step=85250 Epoch=166.7] | Loss=0.00798 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.344 | L2-Norm(final)=15.713 | 3935.0 samples/s | 61.5 steps/s
[Step=85300 Epoch=166.8] | Loss=0.00780 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.348 | L2-Norm(final)=15.715 | 4016.5 samples/s | 62.8 steps/s
[Step=85350 Epoch=166.9] | Loss=0.00776 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.352 | L2-Norm(final)=15.718 | 3935.2 samples/s | 61.5 steps/s
[Step=85400 Epoch=167.0] | Loss=0.00770 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.355 | L2-Norm(final)=15.721 | 3910.6 samples/s | 61.1 steps/s
[Step=85450 Epoch=167.1] | Loss=0.00764 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.358 | L2-Norm(final)=15.723 | 4000.6 samples/s | 62.5 steps/s
[Step=85500 Epoch=167.2] | Loss=0.00760 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.362 | L2-Norm(final)=15.726 | 4326.3 samples/s | 67.6 steps/s
[Step=85550 Epoch=167.2] | Loss=0.00754 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.365 | L2-Norm(final)=15.728 | 1562.4 samples/s | 24.4 steps/s
[Step=85600 Epoch=167.3] | Loss=0.00750 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.368 | L2-Norm(final)=15.731 | 3937.8 samples/s | 61.5 steps/s
[Step=85650 Epoch=167.4] | Loss=0.00737 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.372 | L2-Norm(final)=15.733 | 3966.9 samples/s | 62.0 steps/s
[Step=85700 Epoch=167.5] | Loss=0.00733 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.375 | L2-Norm(final)=15.736 | 3872.0 samples/s | 60.5 steps/s
[Step=85750 Epoch=167.6] | Loss=0.00724 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.378 | L2-Norm(final)=15.738 | 3963.5 samples/s | 61.9 steps/s
[Step=85800 Epoch=167.7] | Loss=0.00717 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.381 | L2-Norm(final)=15.741 | 3934.7 samples/s | 61.5 steps/s
[Step=85850 Epoch=167.8] | Loss=0.00708 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.384 | L2-Norm(final)=15.743 | 3936.9 samples/s | 61.5 steps/s
[Step=85900 Epoch=167.9] | Loss=0.00705 | Reg=0.00070 | acc=0.9844 | L2-Norm=8.387 | L2-Norm(final)=15.745 | 3904.3 samples/s | 61.0 steps/s
[Step=85950 Epoch=168.0] | Loss=0.00698 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.390 | L2-Norm(final)=15.748 | 3962.7 samples/s | 61.9 steps/s
[Step=86000 Epoch=168.1] | Loss=0.00695 | Reg=0.00070 | acc=1.0000 | L2-Norm=8.393 | L2-Norm(final)=15.750 | 3953.9 samples/s | 61.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step86000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=84001 Epoch=321.9] | Loss=0.00001 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.201 | L2-Norm(final)=10.905 | 3210.9 samples/s | 50.2 steps/s
[Step=84050 Epoch=322.0] | Loss=0.00005 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.200 | L2-Norm(final)=10.909 | 3883.1 samples/s | 60.7 steps/s
[Step=84100 Epoch=322.2] | Loss=0.00004 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.198 | L2-Norm(final)=10.914 | 4080.7 samples/s | 63.8 steps/s
[Step=84150 Epoch=322.4] | Loss=0.00003 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.195 | L2-Norm(final)=10.917 | 4052.4 samples/s | 63.3 steps/s
[Step=84200 Epoch=322.6] | Loss=0.00003 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.192 | L2-Norm(final)=10.921 | 4144.6 samples/s | 64.8 steps/s
[Step=84250 Epoch=322.8] | Loss=0.00003 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.189 | L2-Norm(final)=10.925 | 5338.3 samples/s | 83.4 steps/s
[Step=84300 Epoch=323.0] | Loss=0.00003 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.187 | L2-Norm(final)=10.929 | 1490.7 samples/s | 23.3 steps/s
[Step=84350 Epoch=323.2] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.184 | L2-Norm(final)=10.932 | 4133.5 samples/s | 64.6 steps/s
[Step=84400 Epoch=323.4] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.181 | L2-Norm(final)=10.935 | 4095.9 samples/s | 64.0 steps/s
[Step=84450 Epoch=323.6] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.178 | L2-Norm(final)=10.938 | 4111.1 samples/s | 64.2 steps/s
[Step=84500 Epoch=323.8] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.175 | L2-Norm(final)=10.941 | 4628.4 samples/s | 72.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=84501 Epoch=323.8] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.144 | L2-Norm(final)=10.972 | 3073.3 samples/s | 48.0 steps/s
[Step=84550 Epoch=324.0] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.139 | L2-Norm(final)=10.974 | 3611.8 samples/s | 56.4 steps/s
[Step=84600 Epoch=324.2] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.133 | L2-Norm(final)=10.977 | 3713.6 samples/s | 58.0 steps/s
[Step=84650 Epoch=324.3] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.126 | L2-Norm(final)=10.979 | 3775.1 samples/s | 59.0 steps/s
[Step=84700 Epoch=324.5] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.120 | L2-Norm(final)=10.981 | 3653.3 samples/s | 57.1 steps/s
[Step=84750 Epoch=324.7] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.113 | L2-Norm(final)=10.983 | 4610.0 samples/s | 72.0 steps/s
[Step=84800 Epoch=324.9] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.106 | L2-Norm(final)=10.984 | 1487.2 samples/s | 23.2 steps/s
[Step=84850 Epoch=325.1] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.099 | L2-Norm(final)=10.986 | 3766.7 samples/s | 58.9 steps/s
[Step=84900 Epoch=325.3] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.092 | L2-Norm(final)=10.987 | 3702.4 samples/s | 57.9 steps/s
[Step=84950 Epoch=325.5] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.085 | L2-Norm(final)=10.989 | 3729.8 samples/s | 58.3 steps/s
[Step=85000 Epoch=325.7] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.077 | L2-Norm(final)=10.990 | 4111.1 samples/s | 64.2 steps/s
[Step=85050 Epoch=325.9] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.070 | L2-Norm(final)=10.992 | 1498.2 samples/s | 23.4 steps/s
[Step=85100 Epoch=326.1] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.062 | L2-Norm(final)=10.993 | 3737.1 samples/s | 58.4 steps/s
[Step=85150 Epoch=326.3] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.055 | L2-Norm(final)=10.994 | 3687.1 samples/s | 57.6 steps/s
[Step=85200 Epoch=326.5] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.047 | L2-Norm(final)=10.996 | 3671.9 samples/s | 57.4 steps/s
[Step=85250 Epoch=326.6] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.039 | L2-Norm(final)=10.997 | 3673.8 samples/s | 57.4 steps/s
[Step=85300 Epoch=326.8] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.032 | L2-Norm(final)=10.998 | 1606.4 samples/s | 25.1 steps/s
[Step=85350 Epoch=327.0] | Loss=0.00000 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.024 | L2-Norm(final)=11.000 | 3781.6 samples/s | 59.1 steps/s
[Step=85400 Epoch=327.2] | Loss=0.00000 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.016 | L2-Norm(final)=11.001 | 3698.8 samples/s | 57.8 steps/s
[Step=85450 Epoch=327.4] | Loss=0.00000 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.008 | L2-Norm(final)=11.002 | 3721.9 samples/s | 58.2 steps/s
[Step=85500 Epoch=327.6] | Loss=0.00000 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.000 | L2-Norm(final)=11.003 | 3689.2 samples/s | 57.6 steps/s
[Step=85550 Epoch=327.8] | Loss=0.00000 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.992 | L2-Norm(final)=11.005 | 1566.3 samples/s | 24.5 steps/s
[Step=85600 Epoch=328.0] | Loss=0.00000 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.984 | L2-Norm(final)=11.006 | 3685.7 samples/s | 57.6 steps/s
[Step=85650 Epoch=328.2] | Loss=0.00000 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.975 | L2-Norm(final)=11.007 | 3678.5 samples/s | 57.5 steps/s
[Step=85700 Epoch=328.4] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.967 | L2-Norm(final)=11.008 | 3752.5 samples/s | 58.6 steps/s
[Step=85750 Epoch=328.6] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.959 | L2-Norm(final)=11.010 | 3635.0 samples/s | 56.8 steps/s
[Step=85800 Epoch=328.8] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.950 | L2-Norm(final)=11.011 | 5014.8 samples/s | 78.4 steps/s
[Step=85850 Epoch=328.9] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.942 | L2-Norm(final)=11.012 | 1411.0 samples/s | 22.0 steps/s
[Step=85900 Epoch=329.1] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.933 | L2-Norm(final)=11.014 | 3683.3 samples/s | 57.6 steps/s
[Step=85950 Epoch=329.3] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.925 | L2-Norm(final)=11.015 | 3699.4 samples/s | 57.8 steps/s
[Step=86000 Epoch=329.5] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.916 | L2-Norm(final)=11.016 | 3758.2 samples/s | 58.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step86000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=84001 Epoch=323.4] | Loss=0.00033 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.201 | L2-Norm(final)=10.885 | 3356.3 samples/s | 52.4 steps/s
[Step=84050 Epoch=323.5] | Loss=0.00006 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.198 | L2-Norm(final)=10.891 | 3603.1 samples/s | 56.3 steps/s
[Step=84100 Epoch=323.7] | Loss=0.00004 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.196 | L2-Norm(final)=10.897 | 4099.9 samples/s | 64.1 steps/s
[Step=84150 Epoch=323.9] | Loss=0.00004 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.194 | L2-Norm(final)=10.903 | 4107.4 samples/s | 64.2 steps/s
[Step=84200 Epoch=324.1] | Loss=0.00004 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.192 | L2-Norm(final)=10.909 | 4082.0 samples/s | 63.8 steps/s
[Step=84250 Epoch=324.3] | Loss=0.00004 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.191 | L2-Norm(final)=10.915 | 5421.7 samples/s | 84.7 steps/s
[Step=84300 Epoch=324.5] | Loss=0.00004 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.189 | L2-Norm(final)=10.920 | 1529.8 samples/s | 23.9 steps/s
[Step=84350 Epoch=324.7] | Loss=0.00003 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.187 | L2-Norm(final)=10.924 | 4067.1 samples/s | 63.5 steps/s
[Step=84400 Epoch=324.9] | Loss=0.00003 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.185 | L2-Norm(final)=10.929 | 4110.0 samples/s | 64.2 steps/s
[Step=84450 Epoch=325.1] | Loss=0.00003 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.183 | L2-Norm(final)=10.933 | 4133.2 samples/s | 64.6 steps/s
[Step=84500 Epoch=325.3] | Loss=0.00003 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.180 | L2-Norm(final)=10.937 | 4717.0 samples/s | 73.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=84501 Epoch=325.3] | Loss=0.00002 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.156 | L2-Norm(final)=10.976 | 3041.9 samples/s | 47.5 steps/s
[Step=84550 Epoch=325.5] | Loss=0.00002 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.150 | L2-Norm(final)=10.979 | 3687.9 samples/s | 57.6 steps/s
[Step=84600 Epoch=325.7] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.141 | L2-Norm(final)=10.982 | 3745.9 samples/s | 58.5 steps/s
[Step=84650 Epoch=325.9] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.132 | L2-Norm(final)=10.984 | 3696.7 samples/s | 57.8 steps/s
[Step=84700 Epoch=326.0] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.123 | L2-Norm(final)=10.987 | 3750.2 samples/s | 58.6 steps/s
[Step=84750 Epoch=326.2] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.114 | L2-Norm(final)=10.989 | 4668.2 samples/s | 72.9 steps/s
[Step=84800 Epoch=326.4] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.105 | L2-Norm(final)=10.990 | 1463.3 samples/s | 22.9 steps/s
[Step=84850 Epoch=326.6] | Loss=0.00001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.095 | L2-Norm(final)=10.992 | 3715.4 samples/s | 58.1 steps/s
[Step=84900 Epoch=326.8] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.084 | L2-Norm(final)=10.994 | 3698.7 samples/s | 57.8 steps/s
[Step=84950 Epoch=327.0] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.074 | L2-Norm(final)=10.995 | 3721.5 samples/s | 58.1 steps/s
[Step=85000 Epoch=327.2] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.063 | L2-Norm(final)=10.996 | 4209.9 samples/s | 65.8 steps/s
[Step=85050 Epoch=327.4] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.052 | L2-Norm(final)=10.997 | 1526.6 samples/s | 23.9 steps/s
[Step=85100 Epoch=327.6] | Loss=0.00001 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.042 | L2-Norm(final)=10.999 | 3724.1 samples/s | 58.2 steps/s
[Step=85150 Epoch=327.8] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.031 | L2-Norm(final)=11.000 | 3714.2 samples/s | 58.0 steps/s
[Step=85200 Epoch=328.0] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.019 | L2-Norm(final)=11.001 | 3724.8 samples/s | 58.2 steps/s
[Step=85250 Epoch=328.2] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.008 | L2-Norm(final)=11.002 | 3714.3 samples/s | 58.0 steps/s
[Step=85300 Epoch=328.4] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.997 | L2-Norm(final)=11.003 | 1556.5 samples/s | 24.3 steps/s
[Step=85350 Epoch=328.5] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.985 | L2-Norm(final)=11.005 | 3699.1 samples/s | 57.8 steps/s
[Step=85400 Epoch=328.7] | Loss=0.00001 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.974 | L2-Norm(final)=11.006 | 3674.1 samples/s | 57.4 steps/s
[Step=85450 Epoch=328.9] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.962 | L2-Norm(final)=11.007 | 3761.5 samples/s | 58.8 steps/s
[Step=85500 Epoch=329.1] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.950 | L2-Norm(final)=11.008 | 3646.7 samples/s | 57.0 steps/s
[Step=85550 Epoch=329.3] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.939 | L2-Norm(final)=11.010 | 1600.4 samples/s | 25.0 steps/s
[Step=85600 Epoch=329.5] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.927 | L2-Norm(final)=11.011 | 3773.0 samples/s | 59.0 steps/s
[Step=85650 Epoch=329.7] | Loss=0.00000 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.915 | L2-Norm(final)=11.012 | 3704.0 samples/s | 57.9 steps/s
[Step=85700 Epoch=329.9] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.902 | L2-Norm(final)=11.013 | 3745.3 samples/s | 58.5 steps/s
[Step=85750 Epoch=330.1] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.890 | L2-Norm(final)=11.015 | 3748.6 samples/s | 58.6 steps/s
[Step=85800 Epoch=330.3] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.878 | L2-Norm(final)=11.016 | 5478.1 samples/s | 85.6 steps/s
[Step=85850 Epoch=330.5] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.865 | L2-Norm(final)=11.017 | 1380.0 samples/s | 21.6 steps/s
[Step=85900 Epoch=330.7] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.853 | L2-Norm(final)=11.019 | 3710.9 samples/s | 58.0 steps/s
[Step=85950 Epoch=330.9] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.840 | L2-Norm(final)=11.020 | 3777.5 samples/s | 59.0 steps/s
[Step=86000 Epoch=331.0] | Loss=0.00000 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.827 | L2-Norm(final)=11.022 | 3669.7 samples/s | 57.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step86000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05449 | acc=0.9716 | tpr=0.9798 | fpr=0.0463 | 3482.2 samples/s | 13.6 steps/s
Avg test loss: 0.06045, Avg test acc: 0.96895, Avg tpr: 0.97779, Avg fpr: 0.05051, total FA: 394

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05660 | acc=0.9700 | tpr=0.9754 | fpr=0.0416 | 3502.8 samples/s | 13.7 steps/s
Avg test loss: 0.06181, Avg test acc: 0.96831, Avg tpr: 0.97535, Avg fpr: 0.04717, total FA: 368

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.23377 | acc=0.3096 | tpr=0.0131 | fpr=0.0466 | 3531.0 samples/s | 13.8 steps/s
Avg test loss: 5.24658, Avg test acc: 0.30752, Avg tpr: 0.01364, Avg fpr: 0.04615, total FA: 360

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.69098 | acc=0.3137 | tpr=0.0193 | fpr=0.0468 | 3523.8 samples/s | 13.8 steps/s
Avg test loss: 4.70272, Avg test acc: 0.31124, Avg tpr: 0.01935, Avg fpr: 0.04679, total FA: 365

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.25331 | acc=0.1147 | tpr=0.8761 | fpr=0.8990 | 3478.1 samples/s | 13.6 steps/s
[Step= 100] | Loss=5.23307 | acc=0.1171 | tpr=0.8891 | fpr=0.8973 | 6877.6 samples/s | 26.9 steps/s
[Step= 150] | Loss=5.24540 | acc=0.1160 | tpr=0.8963 | fpr=0.8984 | 7218.7 samples/s | 28.2 steps/s
[Step= 200] | Loss=5.22860 | acc=0.1163 | tpr=0.8863 | fpr=0.8978 | 6633.3 samples/s | 25.9 steps/s
[Step= 250] | Loss=5.23444 | acc=0.1164 | tpr=0.8769 | fpr=0.8974 | 6588.4 samples/s | 25.7 steps/s
[Step= 300] | Loss=5.23644 | acc=0.1156 | tpr=0.8764 | fpr=0.8982 | 6763.6 samples/s | 26.4 steps/s
[Step= 350] | Loss=5.23083 | acc=0.1158 | tpr=0.8804 | fpr=0.8980 | 6992.7 samples/s | 27.3 steps/s
[Step= 400] | Loss=5.22795 | acc=0.1157 | tpr=0.8786 | fpr=0.8982 | 6616.7 samples/s | 25.8 steps/s
[Step= 450] | Loss=5.23535 | acc=0.1152 | tpr=0.8788 | fpr=0.8986 | 6836.5 samples/s | 26.7 steps/s
[Step= 500] | Loss=5.23618 | acc=0.1152 | tpr=0.8789 | fpr=0.8986 | 6795.8 samples/s | 26.5 steps/s
[Step= 550] | Loss=5.23565 | acc=0.1155 | tpr=0.8802 | fpr=0.8984 | 11965.1 samples/s | 46.7 steps/s
Avg test loss: 5.23642, Avg test acc: 0.11543, Avg tpr: 0.87956, Avg fpr: 0.89846, total FA: 124749

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.49650 | acc=0.1147 | tpr=0.8540 | fpr=0.8986 | 3482.5 samples/s | 13.6 steps/s
[Step= 100] | Loss=5.47410 | acc=0.1161 | tpr=0.8742 | fpr=0.8981 | 6955.9 samples/s | 27.2 steps/s
[Step= 150] | Loss=5.49031 | acc=0.1150 | tpr=0.8761 | fpr=0.8990 | 6691.8 samples/s | 26.1 steps/s
[Step= 200] | Loss=5.47681 | acc=0.1155 | tpr=0.8710 | fpr=0.8982 | 6778.8 samples/s | 26.5 steps/s
[Step= 250] | Loss=5.48385 | acc=0.1157 | tpr=0.8655 | fpr=0.8979 | 6897.8 samples/s | 26.9 steps/s
[Step= 300] | Loss=5.48794 | acc=0.1150 | tpr=0.8582 | fpr=0.8985 | 6685.9 samples/s | 26.1 steps/s
[Step= 350] | Loss=5.48414 | acc=0.1156 | tpr=0.8629 | fpr=0.8980 | 6868.2 samples/s | 26.8 steps/s
[Step= 400] | Loss=5.48005 | acc=0.1159 | tpr=0.8616 | fpr=0.8976 | 6661.7 samples/s | 26.0 steps/s
[Step= 450] | Loss=5.48873 | acc=0.1156 | tpr=0.8632 | fpr=0.8980 | 6758.0 samples/s | 26.4 steps/s
[Step= 500] | Loss=5.48858 | acc=0.1157 | tpr=0.8652 | fpr=0.8978 | 6661.9 samples/s | 26.0 steps/s
[Step= 550] | Loss=5.48794 | acc=0.1159 | tpr=0.8647 | fpr=0.8977 | 12565.6 samples/s | 49.1 steps/s
Avg test loss: 5.48849, Avg test acc: 0.11579, Avg tpr: 0.86450, Avg fpr: 0.89782, total FA: 124661

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09999 | acc=0.9827 | tpr=0.9381 | fpr=0.0165 | 3508.1 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.10423 | acc=0.9821 | tpr=0.9531 | fpr=0.0173 | 6711.9 samples/s | 26.2 steps/s
[Step= 150] | Loss=0.10726 | acc=0.9813 | tpr=0.9568 | fpr=0.0182 | 6943.8 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.10825 | acc=0.9812 | tpr=0.9574 | fpr=0.0183 | 7354.9 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.10727 | acc=0.9816 | tpr=0.9528 | fpr=0.0179 | 7218.8 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.10888 | acc=0.9813 | tpr=0.9513 | fpr=0.0181 | 7709.2 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.10877 | acc=0.9812 | tpr=0.9512 | fpr=0.0183 | 7433.1 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.11023 | acc=0.9810 | tpr=0.9491 | fpr=0.0184 | 7203.2 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.11249 | acc=0.9807 | tpr=0.9489 | fpr=0.0188 | 7194.3 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.11205 | acc=0.9807 | tpr=0.9520 | fpr=0.0188 | 6838.3 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.11135 | acc=0.9809 | tpr=0.9515 | fpr=0.0186 | 12969.2 samples/s | 50.7 steps/s
Avg test loss: 0.11125, Avg test acc: 0.98085, Avg tpr: 0.95087, Avg fpr: 0.01860, total FA: 2583

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10554 | acc=0.9813 | tpr=0.9513 | fpr=0.0181 | 3928.0 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.11030 | acc=0.9807 | tpr=0.9638 | fpr=0.0190 | 7506.3 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.11365 | acc=0.9797 | tpr=0.9654 | fpr=0.0201 | 8142.0 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.11514 | acc=0.9796 | tpr=0.9661 | fpr=0.0202 | 8635.8 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.11428 | acc=0.9796 | tpr=0.9624 | fpr=0.0201 | 7962.5 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.11603 | acc=0.9793 | tpr=0.9622 | fpr=0.0204 | 8980.0 samples/s | 35.1 steps/s
[Step= 350] | Loss=0.11592 | acc=0.9792 | tpr=0.9618 | fpr=0.0205 | 7848.7 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.11719 | acc=0.9789 | tpr=0.9595 | fpr=0.0208 | 7478.9 samples/s | 29.2 steps/s
[Step= 450] | Loss=0.11952 | acc=0.9785 | tpr=0.9581 | fpr=0.0212 | 6925.7 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.11922 | acc=0.9785 | tpr=0.9604 | fpr=0.0211 | 6734.1 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.11838 | acc=0.9788 | tpr=0.9598 | fpr=0.0209 | 12635.3 samples/s | 49.4 steps/s
Avg test loss: 0.11833, Avg test acc: 0.97878, Avg tpr: 0.95919, Avg fpr: 0.02086, total FA: 2897

server round 43/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=86001 Epoch=167.7] | Loss=0.00820 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.958 | L2-Norm(final)=15.551 | 3073.0 samples/s | 48.0 steps/s
[Step=86050 Epoch=167.8] | Loss=0.01359 | Reg=0.00063 | acc=0.9688 | L2-Norm=7.963 | L2-Norm(final)=15.554 | 4206.5 samples/s | 65.7 steps/s
[Step=86100 Epoch=167.9] | Loss=0.01276 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.969 | L2-Norm(final)=15.557 | 4374.8 samples/s | 68.4 steps/s
[Step=86150 Epoch=168.0] | Loss=0.01245 | Reg=0.00064 | acc=0.9844 | L2-Norm=7.974 | L2-Norm(final)=15.562 | 4343.0 samples/s | 67.9 steps/s
[Step=86200 Epoch=168.1] | Loss=0.01225 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.980 | L2-Norm(final)=15.566 | 4387.9 samples/s | 68.6 steps/s
[Step=86250 Epoch=168.2] | Loss=0.01246 | Reg=0.00064 | acc=0.9844 | L2-Norm=7.985 | L2-Norm(final)=15.570 | 4381.7 samples/s | 68.5 steps/s
[Step=86300 Epoch=168.3] | Loss=0.01244 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.990 | L2-Norm(final)=15.574 | 4269.9 samples/s | 66.7 steps/s
[Step=86350 Epoch=168.4] | Loss=0.01252 | Reg=0.00064 | acc=0.9844 | L2-Norm=7.995 | L2-Norm(final)=15.578 | 4372.8 samples/s | 68.3 steps/s
[Step=86400 Epoch=168.5] | Loss=0.01227 | Reg=0.00064 | acc=0.9844 | L2-Norm=8.000 | L2-Norm(final)=15.582 | 4403.2 samples/s | 68.8 steps/s
[Step=86450 Epoch=168.6] | Loss=0.01258 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.005 | L2-Norm(final)=15.585 | 4400.6 samples/s | 68.8 steps/s
[Step=86500 Epoch=168.7] | Loss=0.01238 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.010 | L2-Norm(final)=15.589 | 5532.9 samples/s | 86.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=86501 Epoch=168.7] | Loss=0.00634 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.057 | L2-Norm(final)=15.625 | 3116.6 samples/s | 48.7 steps/s
[Step=86550 Epoch=168.8] | Loss=0.00901 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.062 | L2-Norm(final)=15.629 | 3756.2 samples/s | 58.7 steps/s
[Step=86600 Epoch=168.9] | Loss=0.01110 | Reg=0.00065 | acc=0.9844 | L2-Norm=8.068 | L2-Norm(final)=15.632 | 3849.4 samples/s | 60.1 steps/s
[Step=86650 Epoch=169.0] | Loss=0.01131 | Reg=0.00065 | acc=0.9844 | L2-Norm=8.074 | L2-Norm(final)=15.635 | 3944.4 samples/s | 61.6 steps/s
[Step=86700 Epoch=169.1] | Loss=0.01105 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.080 | L2-Norm(final)=15.639 | 3926.1 samples/s | 61.3 steps/s
[Step=86750 Epoch=169.2] | Loss=0.01047 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.086 | L2-Norm(final)=15.642 | 3932.5 samples/s | 61.4 steps/s
[Step=86800 Epoch=169.3] | Loss=0.01017 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.091 | L2-Norm(final)=15.646 | 3923.2 samples/s | 61.3 steps/s
[Step=86850 Epoch=169.4] | Loss=0.01001 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.096 | L2-Norm(final)=15.649 | 3959.7 samples/s | 61.9 steps/s
[Step=86900 Epoch=169.5] | Loss=0.00999 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.101 | L2-Norm(final)=15.652 | 3983.9 samples/s | 62.2 steps/s
[Step=86950 Epoch=169.6] | Loss=0.01000 | Reg=0.00066 | acc=0.9688 | L2-Norm=8.106 | L2-Norm(final)=15.655 | 3888.8 samples/s | 60.8 steps/s
[Step=87000 Epoch=169.7] | Loss=0.01027 | Reg=0.00066 | acc=0.9688 | L2-Norm=8.111 | L2-Norm(final)=15.658 | 4853.4 samples/s | 75.8 steps/s
[Step=87050 Epoch=169.8] | Loss=0.01012 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.116 | L2-Norm(final)=15.661 | 1473.9 samples/s | 23.0 steps/s
[Step=87100 Epoch=169.9] | Loss=0.00974 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.120 | L2-Norm(final)=15.664 | 3891.0 samples/s | 60.8 steps/s
[Step=87150 Epoch=170.0] | Loss=0.00960 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.125 | L2-Norm(final)=15.667 | 3928.5 samples/s | 61.4 steps/s
[Step=87200 Epoch=170.1] | Loss=0.00946 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.129 | L2-Norm(final)=15.670 | 3931.5 samples/s | 61.4 steps/s
[Step=87250 Epoch=170.2] | Loss=0.00931 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.133 | L2-Norm(final)=15.673 | 3950.4 samples/s | 61.7 steps/s
[Step=87300 Epoch=170.3] | Loss=0.00929 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.137 | L2-Norm(final)=15.676 | 3988.1 samples/s | 62.3 steps/s
[Step=87350 Epoch=170.4] | Loss=0.00912 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.141 | L2-Norm(final)=15.678 | 3916.9 samples/s | 61.2 steps/s
[Step=87400 Epoch=170.5] | Loss=0.00898 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.145 | L2-Norm(final)=15.681 | 3950.2 samples/s | 61.7 steps/s
[Step=87450 Epoch=170.6] | Loss=0.00890 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.149 | L2-Norm(final)=15.684 | 3970.5 samples/s | 62.0 steps/s
[Step=87500 Epoch=170.7] | Loss=0.00887 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.153 | L2-Norm(final)=15.686 | 4186.2 samples/s | 65.4 steps/s
[Step=87550 Epoch=170.8] | Loss=0.00880 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.156 | L2-Norm(final)=15.689 | 1553.4 samples/s | 24.3 steps/s
[Step=87600 Epoch=170.9] | Loss=0.00872 | Reg=0.00067 | acc=0.9688 | L2-Norm=8.160 | L2-Norm(final)=15.692 | 3993.0 samples/s | 62.4 steps/s
[Step=87650 Epoch=171.0] | Loss=0.00864 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.163 | L2-Norm(final)=15.694 | 3908.9 samples/s | 61.1 steps/s
[Step=87700 Epoch=171.0] | Loss=0.00851 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.167 | L2-Norm(final)=15.697 | 3881.1 samples/s | 60.6 steps/s
[Step=87750 Epoch=171.1] | Loss=0.00841 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.170 | L2-Norm(final)=15.699 | 3944.4 samples/s | 61.6 steps/s
[Step=87800 Epoch=171.2] | Loss=0.00834 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.174 | L2-Norm(final)=15.702 | 3945.8 samples/s | 61.7 steps/s
[Step=87850 Epoch=171.3] | Loss=0.00830 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.177 | L2-Norm(final)=15.704 | 3925.3 samples/s | 61.3 steps/s
[Step=87900 Epoch=171.4] | Loss=0.00828 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.181 | L2-Norm(final)=15.707 | 3935.0 samples/s | 61.5 steps/s
[Step=87950 Epoch=171.5] | Loss=0.00821 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.184 | L2-Norm(final)=15.709 | 3937.6 samples/s | 61.5 steps/s
[Step=88000 Epoch=171.6] | Loss=0.00813 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.187 | L2-Norm(final)=15.712 | 3928.0 samples/s | 61.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step88000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=86001 Epoch=168.1] | Loss=0.03169 | Reg=0.00063 | acc=0.9688 | L2-Norm=7.958 | L2-Norm(final)=15.820 | 3509.7 samples/s | 54.8 steps/s
[Step=86050 Epoch=168.2] | Loss=0.01405 | Reg=0.00063 | acc=0.9844 | L2-Norm=7.964 | L2-Norm(final)=15.823 | 3823.0 samples/s | 59.7 steps/s
[Step=86100 Epoch=168.3] | Loss=0.01419 | Reg=0.00064 | acc=0.9844 | L2-Norm=7.969 | L2-Norm(final)=15.827 | 4301.3 samples/s | 67.2 steps/s
[Step=86150 Epoch=168.4] | Loss=0.01276 | Reg=0.00064 | acc=0.9844 | L2-Norm=7.974 | L2-Norm(final)=15.832 | 4445.3 samples/s | 69.5 steps/s
[Step=86200 Epoch=168.5] | Loss=0.01251 | Reg=0.00064 | acc=0.9844 | L2-Norm=7.979 | L2-Norm(final)=15.836 | 4343.5 samples/s | 67.9 steps/s
[Step=86250 Epoch=168.6] | Loss=0.01202 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.983 | L2-Norm(final)=15.840 | 4384.7 samples/s | 68.5 steps/s
[Step=86300 Epoch=168.7] | Loss=0.01209 | Reg=0.00064 | acc=0.9844 | L2-Norm=7.987 | L2-Norm(final)=15.845 | 4360.0 samples/s | 68.1 steps/s
[Step=86350 Epoch=168.8] | Loss=0.01228 | Reg=0.00064 | acc=0.9844 | L2-Norm=7.992 | L2-Norm(final)=15.849 | 4378.3 samples/s | 68.4 steps/s
[Step=86400 Epoch=168.9] | Loss=0.01202 | Reg=0.00064 | acc=1.0000 | L2-Norm=7.996 | L2-Norm(final)=15.853 | 4302.4 samples/s | 67.2 steps/s
[Step=86450 Epoch=169.0] | Loss=0.01196 | Reg=0.00064 | acc=1.0000 | L2-Norm=8.001 | L2-Norm(final)=15.857 | 4415.7 samples/s | 69.0 steps/s
[Step=86500 Epoch=169.1] | Loss=0.01188 | Reg=0.00064 | acc=0.9844 | L2-Norm=8.005 | L2-Norm(final)=15.861 | 5667.6 samples/s | 88.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=86501 Epoch=169.1] | Loss=0.00330 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.049 | L2-Norm(final)=15.900 | 3534.5 samples/s | 55.2 steps/s
[Step=86550 Epoch=169.2] | Loss=0.00890 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.054 | L2-Norm(final)=15.904 | 3520.1 samples/s | 55.0 steps/s
[Step=86600 Epoch=169.3] | Loss=0.00918 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.061 | L2-Norm(final)=15.908 | 3925.5 samples/s | 61.3 steps/s
[Step=86650 Epoch=169.4] | Loss=0.00906 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.067 | L2-Norm(final)=15.912 | 3934.2 samples/s | 61.5 steps/s
[Step=86700 Epoch=169.5] | Loss=0.00914 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.073 | L2-Norm(final)=15.916 | 3892.7 samples/s | 60.8 steps/s
[Step=86750 Epoch=169.6] | Loss=0.00945 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.079 | L2-Norm(final)=15.920 | 3883.2 samples/s | 60.7 steps/s
[Step=86800 Epoch=169.7] | Loss=0.00948 | Reg=0.00065 | acc=1.0000 | L2-Norm=8.085 | L2-Norm(final)=15.923 | 3961.9 samples/s | 61.9 steps/s
[Step=86850 Epoch=169.8] | Loss=0.00995 | Reg=0.00065 | acc=0.9531 | L2-Norm=8.090 | L2-Norm(final)=15.927 | 3937.2 samples/s | 61.5 steps/s
[Step=86900 Epoch=169.9] | Loss=0.00988 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.096 | L2-Norm(final)=15.930 | 3938.1 samples/s | 61.5 steps/s
[Step=86950 Epoch=170.0] | Loss=0.00964 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.101 | L2-Norm(final)=15.933 | 3970.8 samples/s | 62.0 steps/s
[Step=87000 Epoch=170.1] | Loss=0.00969 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.105 | L2-Norm(final)=15.936 | 4881.6 samples/s | 76.3 steps/s
[Step=87050 Epoch=170.2] | Loss=0.00958 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.110 | L2-Norm(final)=15.939 | 1553.7 samples/s | 24.3 steps/s
[Step=87100 Epoch=170.3] | Loss=0.00926 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.114 | L2-Norm(final)=15.942 | 3875.2 samples/s | 60.6 steps/s
[Step=87150 Epoch=170.4] | Loss=0.00909 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.119 | L2-Norm(final)=15.945 | 3872.3 samples/s | 60.5 steps/s
[Step=87200 Epoch=170.5] | Loss=0.00884 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.123 | L2-Norm(final)=15.948 | 3872.8 samples/s | 60.5 steps/s
[Step=87250 Epoch=170.6] | Loss=0.00868 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.127 | L2-Norm(final)=15.951 | 3934.2 samples/s | 61.5 steps/s
[Step=87300 Epoch=170.7] | Loss=0.00862 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.131 | L2-Norm(final)=15.954 | 3922.3 samples/s | 61.3 steps/s
[Step=87350 Epoch=170.8] | Loss=0.00864 | Reg=0.00066 | acc=0.9688 | L2-Norm=8.135 | L2-Norm(final)=15.957 | 3941.8 samples/s | 61.6 steps/s
[Step=87400 Epoch=170.9] | Loss=0.00860 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.139 | L2-Norm(final)=15.960 | 3971.4 samples/s | 62.1 steps/s
[Step=87450 Epoch=171.0] | Loss=0.00853 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.142 | L2-Norm(final)=15.962 | 3908.6 samples/s | 61.1 steps/s
[Step=87500 Epoch=171.1] | Loss=0.00848 | Reg=0.00066 | acc=0.9844 | L2-Norm=8.146 | L2-Norm(final)=15.965 | 4263.4 samples/s | 66.6 steps/s
[Step=87550 Epoch=171.2] | Loss=0.00840 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.150 | L2-Norm(final)=15.968 | 1577.4 samples/s | 24.6 steps/s
[Step=87600 Epoch=171.3] | Loss=0.00832 | Reg=0.00066 | acc=1.0000 | L2-Norm=8.154 | L2-Norm(final)=15.971 | 3941.6 samples/s | 61.6 steps/s
[Step=87650 Epoch=171.4] | Loss=0.00822 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.157 | L2-Norm(final)=15.973 | 3927.9 samples/s | 61.4 steps/s
[Step=87700 Epoch=171.5] | Loss=0.00812 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.161 | L2-Norm(final)=15.976 | 3941.1 samples/s | 61.6 steps/s
[Step=87750 Epoch=171.5] | Loss=0.00801 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.164 | L2-Norm(final)=15.978 | 3926.4 samples/s | 61.3 steps/s
[Step=87800 Epoch=171.6] | Loss=0.00794 | Reg=0.00067 | acc=0.9844 | L2-Norm=8.167 | L2-Norm(final)=15.981 | 3939.8 samples/s | 61.6 steps/s
[Step=87850 Epoch=171.7] | Loss=0.00786 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.171 | L2-Norm(final)=15.983 | 3947.8 samples/s | 61.7 steps/s
[Step=87900 Epoch=171.8] | Loss=0.00774 | Reg=0.00067 | acc=0.9844 | L2-Norm=8.174 | L2-Norm(final)=15.986 | 3964.1 samples/s | 61.9 steps/s
[Step=87950 Epoch=171.9] | Loss=0.00768 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.177 | L2-Norm(final)=15.989 | 3936.6 samples/s | 61.5 steps/s
[Step=88000 Epoch=172.0] | Loss=0.00766 | Reg=0.00067 | acc=1.0000 | L2-Norm=8.180 | L2-Norm(final)=15.991 | 3934.7 samples/s | 61.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step88000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=86001 Epoch=329.5] | Loss=0.00003 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.958 | L2-Norm(final)=11.057 | 3178.9 samples/s | 49.7 steps/s
[Step=86050 Epoch=329.7] | Loss=0.00005 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.957 | L2-Norm(final)=11.066 | 3922.5 samples/s | 61.3 steps/s
[Step=86100 Epoch=329.9] | Loss=0.00004 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.955 | L2-Norm(final)=11.074 | 4123.8 samples/s | 64.4 steps/s
[Step=86150 Epoch=330.1] | Loss=0.00003 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.951 | L2-Norm(final)=11.081 | 4088.2 samples/s | 63.9 steps/s
[Step=86200 Epoch=330.3] | Loss=0.00003 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.948 | L2-Norm(final)=11.087 | 4195.7 samples/s | 65.6 steps/s
[Step=86250 Epoch=330.5] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.944 | L2-Norm(final)=11.093 | 5250.9 samples/s | 82.0 steps/s
[Step=86300 Epoch=330.7] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.939 | L2-Norm(final)=11.098 | 1541.2 samples/s | 24.1 steps/s
[Step=86350 Epoch=330.9] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.935 | L2-Norm(final)=11.103 | 4030.1 samples/s | 63.0 steps/s
[Step=86400 Epoch=331.1] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.931 | L2-Norm(final)=11.108 | 4071.2 samples/s | 63.6 steps/s
[Step=86450 Epoch=331.2] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.927 | L2-Norm(final)=11.112 | 4198.5 samples/s | 65.6 steps/s
[Step=86500 Epoch=331.4] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.922 | L2-Norm(final)=11.116 | 4617.3 samples/s | 72.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=86501 Epoch=331.4] | Loss=0.00000 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.878 | L2-Norm(final)=11.158 | 3049.8 samples/s | 47.7 steps/s
[Step=86550 Epoch=331.6] | Loss=0.00001 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.868 | L2-Norm(final)=11.162 | 3655.0 samples/s | 57.1 steps/s
[Step=86600 Epoch=331.8] | Loss=0.00001 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.856 | L2-Norm(final)=11.165 | 3714.3 samples/s | 58.0 steps/s
[Step=86650 Epoch=332.0] | Loss=0.00001 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.844 | L2-Norm(final)=11.168 | 3693.6 samples/s | 57.7 steps/s
[Step=86700 Epoch=332.2] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.831 | L2-Norm(final)=11.170 | 3775.3 samples/s | 59.0 steps/s
[Step=86750 Epoch=332.4] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.819 | L2-Norm(final)=11.173 | 4642.5 samples/s | 72.5 steps/s
[Step=86800 Epoch=332.6] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.806 | L2-Norm(final)=11.175 | 1443.7 samples/s | 22.6 steps/s
[Step=86850 Epoch=332.8] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.793 | L2-Norm(final)=11.178 | 3716.9 samples/s | 58.1 steps/s
[Step=86900 Epoch=333.0] | Loss=0.00000 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.780 | L2-Norm(final)=11.180 | 3692.6 samples/s | 57.7 steps/s
[Step=86950 Epoch=333.2] | Loss=0.00000 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.766 | L2-Norm(final)=11.182 | 3777.3 samples/s | 59.0 steps/s
[Step=87000 Epoch=333.4] | Loss=0.00000 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.753 | L2-Norm(final)=11.184 | 4054.4 samples/s | 63.4 steps/s
[Step=87050 Epoch=333.5] | Loss=0.00000 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.739 | L2-Norm(final)=11.186 | 1519.8 samples/s | 23.7 steps/s
[Step=87100 Epoch=333.7] | Loss=0.00000 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.726 | L2-Norm(final)=11.188 | 3673.6 samples/s | 57.4 steps/s
[Step=87150 Epoch=333.9] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.712 | L2-Norm(final)=11.190 | 3728.3 samples/s | 58.3 steps/s
[Step=87200 Epoch=334.1] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.698 | L2-Norm(final)=11.192 | 3682.3 samples/s | 57.5 steps/s
[Step=87250 Epoch=334.3] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.684 | L2-Norm(final)=11.193 | 3727.5 samples/s | 58.2 steps/s
[Step=87300 Epoch=334.5] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.670 | L2-Norm(final)=11.195 | 1533.0 samples/s | 24.0 steps/s
[Step=87350 Epoch=334.7] | Loss=0.00000 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.656 | L2-Norm(final)=11.197 | 3753.2 samples/s | 58.6 steps/s
[Step=87400 Epoch=334.9] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.642 | L2-Norm(final)=11.199 | 3768.0 samples/s | 58.9 steps/s
[Step=87450 Epoch=335.1] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.628 | L2-Norm(final)=11.201 | 3722.7 samples/s | 58.2 steps/s
[Step=87500 Epoch=335.3] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.614 | L2-Norm(final)=11.203 | 3671.1 samples/s | 57.4 steps/s
[Step=87550 Epoch=335.5] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.599 | L2-Norm(final)=11.205 | 1610.6 samples/s | 25.2 steps/s
[Step=87600 Epoch=335.7] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.585 | L2-Norm(final)=11.207 | 3723.1 samples/s | 58.2 steps/s
[Step=87650 Epoch=335.8] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.571 | L2-Norm(final)=11.209 | 3686.5 samples/s | 57.6 steps/s
[Step=87700 Epoch=336.0] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.556 | L2-Norm(final)=11.211 | 3770.4 samples/s | 58.9 steps/s
[Step=87750 Epoch=336.2] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.542 | L2-Norm(final)=11.213 | 3685.9 samples/s | 57.6 steps/s
[Step=87800 Epoch=336.4] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.527 | L2-Norm(final)=11.215 | 5176.8 samples/s | 80.9 steps/s
[Step=87850 Epoch=336.6] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.513 | L2-Norm(final)=11.218 | 1406.2 samples/s | 22.0 steps/s
[Step=87900 Epoch=336.8] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.498 | L2-Norm(final)=11.220 | 3753.4 samples/s | 58.6 steps/s
[Step=87950 Epoch=337.0] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.483 | L2-Norm(final)=11.222 | 3749.4 samples/s | 58.6 steps/s
[Step=88000 Epoch=337.2] | Loss=0.00000 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.469 | L2-Norm(final)=11.225 | 3699.8 samples/s | 57.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step88000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=86001 Epoch=331.1] | Loss=0.00001 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.958 | L2-Norm(final)=11.064 | 3140.5 samples/s | 49.1 steps/s
[Step=86050 Epoch=331.2] | Loss=0.00004 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.951 | L2-Norm(final)=11.074 | 3874.9 samples/s | 60.5 steps/s
[Step=86100 Epoch=331.4] | Loss=0.00004 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.949 | L2-Norm(final)=11.086 | 4135.7 samples/s | 64.6 steps/s
[Step=86150 Epoch=331.6] | Loss=0.00004 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.948 | L2-Norm(final)=11.096 | 4128.8 samples/s | 64.5 steps/s
[Step=86200 Epoch=331.8] | Loss=0.00003 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.947 | L2-Norm(final)=11.104 | 4101.8 samples/s | 64.1 steps/s
[Step=86250 Epoch=332.0] | Loss=0.00003 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.944 | L2-Norm(final)=11.111 | 5397.5 samples/s | 84.3 steps/s
[Step=86300 Epoch=332.2] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.941 | L2-Norm(final)=11.117 | 1483.3 samples/s | 23.2 steps/s
[Step=86350 Epoch=332.4] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.937 | L2-Norm(final)=11.122 | 4127.7 samples/s | 64.5 steps/s
[Step=86400 Epoch=332.6] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.934 | L2-Norm(final)=11.128 | 4167.4 samples/s | 65.1 steps/s
[Step=86450 Epoch=332.8] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.930 | L2-Norm(final)=11.132 | 4055.1 samples/s | 63.4 steps/s
[Step=86500 Epoch=333.0] | Loss=0.00002 | Reg=0.00063 | acc=1.0000 | L2-Norm=7.926 | L2-Norm(final)=11.137 | 4717.5 samples/s | 73.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=86501 Epoch=333.0] | Loss=0.00001 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.890 | L2-Norm(final)=11.187 | 3002.0 samples/s | 46.9 steps/s
[Step=86550 Epoch=333.2] | Loss=0.00001 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.877 | L2-Norm(final)=11.191 | 3764.6 samples/s | 58.8 steps/s
[Step=86600 Epoch=333.4] | Loss=0.00001 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.859 | L2-Norm(final)=11.194 | 3731.1 samples/s | 58.3 steps/s
[Step=86650 Epoch=333.5] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.841 | L2-Norm(final)=11.197 | 3778.5 samples/s | 59.0 steps/s
[Step=86700 Epoch=333.7] | Loss=0.00002 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.828 | L2-Norm(final)=11.201 | 3680.9 samples/s | 57.5 steps/s
[Step=86750 Epoch=333.9] | Loss=0.00002 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.819 | L2-Norm(final)=11.206 | 4814.9 samples/s | 75.2 steps/s
[Step=86800 Epoch=334.1] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.810 | L2-Norm(final)=11.210 | 1447.0 samples/s | 22.6 steps/s
[Step=86850 Epoch=334.3] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.800 | L2-Norm(final)=11.213 | 3703.7 samples/s | 57.9 steps/s
[Step=86900 Epoch=334.5] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.790 | L2-Norm(final)=11.216 | 3734.2 samples/s | 58.3 steps/s
[Step=86950 Epoch=334.7] | Loss=0.00001 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.781 | L2-Norm(final)=11.219 | 3721.7 samples/s | 58.2 steps/s
[Step=87000 Epoch=334.9] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.771 | L2-Norm(final)=11.221 | 4180.6 samples/s | 65.3 steps/s
[Step=87050 Epoch=335.1] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.761 | L2-Norm(final)=11.223 | 1541.0 samples/s | 24.1 steps/s
[Step=87100 Epoch=335.3] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.750 | L2-Norm(final)=11.225 | 3747.9 samples/s | 58.6 steps/s
[Step=87150 Epoch=335.5] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.740 | L2-Norm(final)=11.227 | 3727.0 samples/s | 58.2 steps/s
[Step=87200 Epoch=335.7] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.729 | L2-Norm(final)=11.228 | 3739.4 samples/s | 58.4 steps/s
[Step=87250 Epoch=335.9] | Loss=0.00001 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.718 | L2-Norm(final)=11.230 | 3793.6 samples/s | 59.3 steps/s
[Step=87300 Epoch=336.1] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.707 | L2-Norm(final)=11.231 | 1588.8 samples/s | 24.8 steps/s
[Step=87350 Epoch=336.2] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.696 | L2-Norm(final)=11.233 | 3751.1 samples/s | 58.6 steps/s
[Step=87400 Epoch=336.4] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.685 | L2-Norm(final)=11.234 | 3715.1 samples/s | 58.0 steps/s
[Step=87450 Epoch=336.6] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.674 | L2-Norm(final)=11.236 | 3760.7 samples/s | 58.8 steps/s
[Step=87500 Epoch=336.8] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.663 | L2-Norm(final)=11.237 | 3706.7 samples/s | 57.9 steps/s
[Step=87550 Epoch=337.0] | Loss=0.00001 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.652 | L2-Norm(final)=11.238 | 1579.3 samples/s | 24.7 steps/s
[Step=87600 Epoch=337.2] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.640 | L2-Norm(final)=11.240 | 3761.6 samples/s | 58.8 steps/s
[Step=87650 Epoch=337.4] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.629 | L2-Norm(final)=11.241 | 3696.7 samples/s | 57.8 steps/s
[Step=87700 Epoch=337.6] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.617 | L2-Norm(final)=11.243 | 3742.4 samples/s | 58.5 steps/s
[Step=87750 Epoch=337.8] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.605 | L2-Norm(final)=11.244 | 3683.4 samples/s | 57.6 steps/s
[Step=87800 Epoch=338.0] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.594 | L2-Norm(final)=11.246 | 5550.8 samples/s | 86.7 steps/s
[Step=87850 Epoch=338.2] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.582 | L2-Norm(final)=11.247 | 1422.5 samples/s | 22.2 steps/s
[Step=87900 Epoch=338.4] | Loss=0.00001 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.570 | L2-Norm(final)=11.249 | 3718.9 samples/s | 58.1 steps/s
[Step=87950 Epoch=338.6] | Loss=0.00001 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.558 | L2-Norm(final)=11.250 | 3733.8 samples/s | 58.3 steps/s
[Step=88000 Epoch=338.7] | Loss=0.00000 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.546 | L2-Norm(final)=11.252 | 3693.5 samples/s | 57.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step88000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05411 | acc=0.9702 | tpr=0.9757 | fpr=0.0416 | 3476.8 samples/s | 13.6 steps/s
Avg test loss: 0.05952, Avg test acc: 0.96831, Avg tpr: 0.97453, Avg fpr: 0.04538, total FA: 354

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05576 | acc=0.9695 | tpr=0.9726 | fpr=0.0374 | 3525.1 samples/s | 13.8 steps/s
Avg test loss: 0.06023, Avg test acc: 0.96843, Avg tpr: 0.97278, Avg fpr: 0.04115, total FA: 321

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.32182 | acc=0.3085 | tpr=0.0118 | fpr=0.0471 | 3512.7 samples/s | 13.7 steps/s
Avg test loss: 5.33668, Avg test acc: 0.30547, Avg tpr: 0.01183, Avg fpr: 0.04871, total FA: 380

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.79777 | acc=0.3131 | tpr=0.0162 | fpr=0.0421 | 3533.1 samples/s | 13.8 steps/s
Avg test loss: 4.81018, Avg test acc: 0.31056, Avg tpr: 0.01626, Avg fpr: 0.04217, total FA: 329

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.14263 | acc=0.1158 | tpr=0.8673 | fpr=0.8977 | 3567.2 samples/s | 13.9 steps/s
[Step= 100] | Loss=5.11946 | acc=0.1187 | tpr=0.8891 | fpr=0.8957 | 6638.8 samples/s | 25.9 steps/s
[Step= 150] | Loss=5.13000 | acc=0.1174 | tpr=0.8948 | fpr=0.8969 | 7004.1 samples/s | 27.4 steps/s
[Step= 200] | Loss=5.11442 | acc=0.1178 | tpr=0.8874 | fpr=0.8962 | 6684.0 samples/s | 26.1 steps/s
[Step= 250] | Loss=5.12040 | acc=0.1179 | tpr=0.8769 | fpr=0.8959 | 7016.4 samples/s | 27.4 steps/s
[Step= 300] | Loss=5.12246 | acc=0.1173 | tpr=0.8749 | fpr=0.8965 | 6578.8 samples/s | 25.7 steps/s
[Step= 350] | Loss=5.11777 | acc=0.1178 | tpr=0.8798 | fpr=0.8960 | 6920.8 samples/s | 27.0 steps/s
[Step= 400] | Loss=5.11509 | acc=0.1179 | tpr=0.8780 | fpr=0.8959 | 6618.5 samples/s | 25.9 steps/s
[Step= 450] | Loss=5.12201 | acc=0.1173 | tpr=0.8783 | fpr=0.8965 | 6781.4 samples/s | 26.5 steps/s
[Step= 500] | Loss=5.12264 | acc=0.1173 | tpr=0.8797 | fpr=0.8965 | 6810.6 samples/s | 26.6 steps/s
[Step= 550] | Loss=5.12215 | acc=0.1174 | tpr=0.8806 | fpr=0.8964 | 11886.5 samples/s | 46.4 steps/s
Avg test loss: 5.12291, Avg test acc: 0.11734, Avg tpr: 0.88035, Avg fpr: 0.89653, total FA: 124482

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.05273 | acc=0.1216 | tpr=0.8451 | fpr=0.8914 | 3470.8 samples/s | 13.6 steps/s
[Step= 100] | Loss=5.03045 | acc=0.1232 | tpr=0.8742 | fpr=0.8908 | 6838.3 samples/s | 26.7 steps/s
[Step= 150] | Loss=5.04419 | acc=0.1222 | tpr=0.8804 | fpr=0.8917 | 7010.2 samples/s | 27.4 steps/s
[Step= 200] | Loss=5.03102 | acc=0.1226 | tpr=0.8732 | fpr=0.8910 | 6719.3 samples/s | 26.2 steps/s
[Step= 250] | Loss=5.03795 | acc=0.1226 | tpr=0.8646 | fpr=0.8909 | 6751.6 samples/s | 26.4 steps/s
[Step= 300] | Loss=5.04126 | acc=0.1218 | tpr=0.8611 | fpr=0.8916 | 7028.2 samples/s | 27.5 steps/s
[Step= 350] | Loss=5.03777 | acc=0.1225 | tpr=0.8660 | fpr=0.8910 | 6739.1 samples/s | 26.3 steps/s
[Step= 400] | Loss=5.03428 | acc=0.1228 | tpr=0.8638 | fpr=0.8907 | 6820.7 samples/s | 26.6 steps/s
[Step= 450] | Loss=5.04233 | acc=0.1225 | tpr=0.8651 | fpr=0.8910 | 6897.9 samples/s | 26.9 steps/s
[Step= 500] | Loss=5.04204 | acc=0.1225 | tpr=0.8670 | fpr=0.8909 | 6710.1 samples/s | 26.2 steps/s
[Step= 550] | Loss=5.04125 | acc=0.1227 | tpr=0.8667 | fpr=0.8908 | 12620.0 samples/s | 49.3 steps/s
Avg test loss: 5.04191, Avg test acc: 0.12260, Avg tpr: 0.86648, Avg fpr: 0.89092, total FA: 123703

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09555 | acc=0.9827 | tpr=0.9425 | fpr=0.0165 | 3558.3 samples/s | 13.9 steps/s
[Step= 100] | Loss=0.09989 | acc=0.9823 | tpr=0.9552 | fpr=0.0172 | 6511.5 samples/s | 25.4 steps/s
[Step= 150] | Loss=0.10293 | acc=0.9813 | tpr=0.9568 | fpr=0.0182 | 6936.9 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.10403 | acc=0.9813 | tpr=0.9574 | fpr=0.0182 | 6852.0 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.10320 | acc=0.9817 | tpr=0.9555 | fpr=0.0178 | 6803.3 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.10480 | acc=0.9816 | tpr=0.9549 | fpr=0.0180 | 7051.6 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.10476 | acc=0.9815 | tpr=0.9555 | fpr=0.0180 | 6659.1 samples/s | 26.0 steps/s
[Step= 400] | Loss=0.10623 | acc=0.9812 | tpr=0.9519 | fpr=0.0182 | 6709.1 samples/s | 26.2 steps/s
[Step= 450] | Loss=0.10843 | acc=0.9808 | tpr=0.9503 | fpr=0.0186 | 6833.5 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.10804 | acc=0.9809 | tpr=0.9533 | fpr=0.0186 | 6722.2 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.10730 | acc=0.9811 | tpr=0.9526 | fpr=0.0184 | 12720.1 samples/s | 49.7 steps/s
Avg test loss: 0.10720, Avg test acc: 0.98106, Avg tpr: 0.95206, Avg fpr: 0.01841, total FA: 2556

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09846 | acc=0.9819 | tpr=0.9469 | fpr=0.0175 | 3530.5 samples/s | 13.8 steps/s
[Step= 100] | Loss=0.10276 | acc=0.9814 | tpr=0.9616 | fpr=0.0182 | 6616.2 samples/s | 25.8 steps/s
[Step= 150] | Loss=0.10588 | acc=0.9804 | tpr=0.9625 | fpr=0.0193 | 6973.7 samples/s | 27.2 steps/s
[Step= 200] | Loss=0.10735 | acc=0.9803 | tpr=0.9628 | fpr=0.0194 | 6856.4 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.10656 | acc=0.9803 | tpr=0.9598 | fpr=0.0193 | 6866.2 samples/s | 26.8 steps/s
[Step= 300] | Loss=0.10820 | acc=0.9799 | tpr=0.9593 | fpr=0.0197 | 6817.5 samples/s | 26.6 steps/s
[Step= 350] | Loss=0.10799 | acc=0.9798 | tpr=0.9593 | fpr=0.0198 | 7038.4 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.10922 | acc=0.9796 | tpr=0.9573 | fpr=0.0200 | 6565.5 samples/s | 25.6 steps/s
[Step= 450] | Loss=0.11145 | acc=0.9792 | tpr=0.9562 | fpr=0.0204 | 6767.7 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.11117 | acc=0.9793 | tpr=0.9581 | fpr=0.0204 | 6738.2 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.11036 | acc=0.9795 | tpr=0.9578 | fpr=0.0201 | 12248.4 samples/s | 47.8 steps/s
Avg test loss: 0.11033, Avg test acc: 0.97949, Avg tpr: 0.95721, Avg fpr: 0.02010, total FA: 2791

server round 44/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=88001 Epoch=171.6] | Loss=0.03917 | Reg=0.00058 | acc=0.9531 | L2-Norm=7.616 | L2-Norm(final)=15.786 | 3321.3 samples/s | 51.9 steps/s
[Step=88050 Epoch=171.7] | Loss=0.01958 | Reg=0.00058 | acc=0.9531 | L2-Norm=7.623 | L2-Norm(final)=15.791 | 4001.7 samples/s | 62.5 steps/s
[Step=88100 Epoch=171.8] | Loss=0.01862 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.631 | L2-Norm(final)=15.796 | 4386.3 samples/s | 68.5 steps/s
[Step=88150 Epoch=171.9] | Loss=0.01845 | Reg=0.00058 | acc=0.9844 | L2-Norm=7.638 | L2-Norm(final)=15.802 | 4293.9 samples/s | 67.1 steps/s
[Step=88200 Epoch=172.0] | Loss=0.01803 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.645 | L2-Norm(final)=15.807 | 4420.0 samples/s | 69.1 steps/s
[Step=88250 Epoch=172.1] | Loss=0.01772 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.652 | L2-Norm(final)=15.812 | 4346.8 samples/s | 67.9 steps/s
[Step=88300 Epoch=172.2] | Loss=0.01705 | Reg=0.00059 | acc=0.9844 | L2-Norm=7.658 | L2-Norm(final)=15.817 | 4401.8 samples/s | 68.8 steps/s
[Step=88350 Epoch=172.3] | Loss=0.01712 | Reg=0.00059 | acc=0.9844 | L2-Norm=7.665 | L2-Norm(final)=15.821 | 4361.4 samples/s | 68.1 steps/s
[Step=88400 Epoch=172.4] | Loss=0.01662 | Reg=0.00059 | acc=0.9844 | L2-Norm=7.671 | L2-Norm(final)=15.826 | 4385.5 samples/s | 68.5 steps/s
[Step=88450 Epoch=172.5] | Loss=0.01644 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.676 | L2-Norm(final)=15.831 | 4481.6 samples/s | 70.0 steps/s
[Step=88500 Epoch=172.6] | Loss=0.01612 | Reg=0.00059 | acc=0.9844 | L2-Norm=7.682 | L2-Norm(final)=15.835 | 5354.3 samples/s | 83.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=88501 Epoch=172.6] | Loss=0.00997 | Reg=0.00060 | acc=0.9844 | L2-Norm=7.738 | L2-Norm(final)=15.881 | 3178.0 samples/s | 49.7 steps/s
[Step=88550 Epoch=172.7] | Loss=0.01270 | Reg=0.00060 | acc=0.9844 | L2-Norm=7.744 | L2-Norm(final)=15.885 | 3711.2 samples/s | 58.0 steps/s
[Step=88600 Epoch=172.8] | Loss=0.01302 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.752 | L2-Norm(final)=15.889 | 3995.0 samples/s | 62.4 steps/s
[Step=88650 Epoch=172.9] | Loss=0.01322 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.760 | L2-Norm(final)=15.894 | 3939.6 samples/s | 61.6 steps/s
[Step=88700 Epoch=173.0] | Loss=0.01310 | Reg=0.00060 | acc=0.9844 | L2-Norm=7.767 | L2-Norm(final)=15.898 | 3904.5 samples/s | 61.0 steps/s
[Step=88750 Epoch=173.1] | Loss=0.01331 | Reg=0.00060 | acc=0.9844 | L2-Norm=7.774 | L2-Norm(final)=15.901 | 3962.8 samples/s | 61.9 steps/s
[Step=88800 Epoch=173.2] | Loss=0.01269 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.780 | L2-Norm(final)=15.905 | 3977.2 samples/s | 62.1 steps/s
[Step=88850 Epoch=173.3] | Loss=0.01298 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.787 | L2-Norm(final)=15.909 | 3922.6 samples/s | 61.3 steps/s
[Step=88900 Epoch=173.4] | Loss=0.01274 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.793 | L2-Norm(final)=15.913 | 3951.3 samples/s | 61.7 steps/s
[Step=88950 Epoch=173.5] | Loss=0.01284 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.799 | L2-Norm(final)=15.916 | 3893.7 samples/s | 60.8 steps/s
[Step=89000 Epoch=173.6] | Loss=0.01282 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.805 | L2-Norm(final)=15.920 | 4800.7 samples/s | 75.0 steps/s
[Step=89050 Epoch=173.7] | Loss=0.01250 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.811 | L2-Norm(final)=15.923 | 1480.0 samples/s | 23.1 steps/s
[Step=89100 Epoch=173.8] | Loss=0.01212 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.816 | L2-Norm(final)=15.927 | 3879.6 samples/s | 60.6 steps/s
[Step=89150 Epoch=173.9] | Loss=0.01189 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.822 | L2-Norm(final)=15.930 | 3954.9 samples/s | 61.8 steps/s
[Step=89200 Epoch=174.0] | Loss=0.01175 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.827 | L2-Norm(final)=15.934 | 3836.5 samples/s | 59.9 steps/s
[Step=89250 Epoch=174.1] | Loss=0.01151 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.832 | L2-Norm(final)=15.937 | 3940.4 samples/s | 61.6 steps/s
[Step=89300 Epoch=174.2] | Loss=0.01132 | Reg=0.00061 | acc=0.9688 | L2-Norm=7.837 | L2-Norm(final)=15.941 | 3930.3 samples/s | 61.4 steps/s
[Step=89350 Epoch=174.3] | Loss=0.01115 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.842 | L2-Norm(final)=15.944 | 3901.4 samples/s | 61.0 steps/s
[Step=89400 Epoch=174.4] | Loss=0.01098 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.847 | L2-Norm(final)=15.947 | 3895.9 samples/s | 60.9 steps/s
[Step=89450 Epoch=174.5] | Loss=0.01085 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.852 | L2-Norm(final)=15.950 | 3933.2 samples/s | 61.5 steps/s
[Step=89500 Epoch=174.6] | Loss=0.01068 | Reg=0.00062 | acc=0.9688 | L2-Norm=7.856 | L2-Norm(final)=15.953 | 4182.1 samples/s | 65.3 steps/s
[Step=89550 Epoch=174.7] | Loss=0.01053 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.861 | L2-Norm(final)=15.957 | 1503.3 samples/s | 23.5 steps/s
[Step=89600 Epoch=174.8] | Loss=0.01036 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.865 | L2-Norm(final)=15.960 | 3943.8 samples/s | 61.6 steps/s
[Step=89650 Epoch=174.9] | Loss=0.01019 | Reg=0.00062 | acc=0.9844 | L2-Norm=7.870 | L2-Norm(final)=15.963 | 3933.4 samples/s | 61.5 steps/s
[Step=89700 Epoch=174.9] | Loss=0.01008 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.874 | L2-Norm(final)=15.966 | 3865.8 samples/s | 60.4 steps/s
[Step=89750 Epoch=175.0] | Loss=0.00998 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.879 | L2-Norm(final)=15.969 | 3876.4 samples/s | 60.6 steps/s
[Step=89800 Epoch=175.1] | Loss=0.00992 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.883 | L2-Norm(final)=15.972 | 3918.4 samples/s | 61.2 steps/s
[Step=89850 Epoch=175.2] | Loss=0.00981 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.887 | L2-Norm(final)=15.975 | 3890.4 samples/s | 60.8 steps/s
[Step=89900 Epoch=175.3] | Loss=0.00977 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.891 | L2-Norm(final)=15.978 | 3913.5 samples/s | 61.1 steps/s
[Step=89950 Epoch=175.4] | Loss=0.00966 | Reg=0.00062 | acc=0.9844 | L2-Norm=7.895 | L2-Norm(final)=15.980 | 3894.2 samples/s | 60.8 steps/s
[Step=90000 Epoch=175.5] | Loss=0.00958 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.899 | L2-Norm(final)=15.983 | 3924.2 samples/s | 61.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step90000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=88001 Epoch=172.0] | Loss=0.01042 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.616 | L2-Norm(final)=16.066 | 3210.2 samples/s | 50.2 steps/s
[Step=88050 Epoch=172.1] | Loss=0.01693 | Reg=0.00058 | acc=0.9844 | L2-Norm=7.625 | L2-Norm(final)=16.070 | 4252.2 samples/s | 66.4 steps/s
[Step=88100 Epoch=172.2] | Loss=0.01713 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.632 | L2-Norm(final)=16.076 | 4308.7 samples/s | 67.3 steps/s
[Step=88150 Epoch=172.3] | Loss=0.01697 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.639 | L2-Norm(final)=16.081 | 4371.1 samples/s | 68.3 steps/s
[Step=88200 Epoch=172.4] | Loss=0.01659 | Reg=0.00058 | acc=0.9844 | L2-Norm=7.646 | L2-Norm(final)=16.087 | 4337.2 samples/s | 67.8 steps/s
[Step=88250 Epoch=172.5] | Loss=0.01632 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.653 | L2-Norm(final)=16.092 | 4306.3 samples/s | 67.3 steps/s
[Step=88300 Epoch=172.6] | Loss=0.01599 | Reg=0.00059 | acc=0.9688 | L2-Norm=7.659 | L2-Norm(final)=16.097 | 4388.6 samples/s | 68.6 steps/s
[Step=88350 Epoch=172.7] | Loss=0.01563 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.664 | L2-Norm(final)=16.102 | 4335.1 samples/s | 67.7 steps/s
[Step=88400 Epoch=172.8] | Loss=0.01560 | Reg=0.00059 | acc=0.9844 | L2-Norm=7.670 | L2-Norm(final)=16.107 | 4345.3 samples/s | 67.9 steps/s
[Step=88450 Epoch=172.9] | Loss=0.01553 | Reg=0.00059 | acc=0.9844 | L2-Norm=7.675 | L2-Norm(final)=16.112 | 4384.2 samples/s | 68.5 steps/s
[Step=88500 Epoch=173.0] | Loss=0.01575 | Reg=0.00059 | acc=1.0000 | L2-Norm=7.680 | L2-Norm(final)=16.116 | 5634.9 samples/s | 88.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=88501 Epoch=173.0] | Loss=0.00522 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.732 | L2-Norm(final)=16.160 | 3290.3 samples/s | 51.4 steps/s
[Step=88550 Epoch=173.1] | Loss=0.01505 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.739 | L2-Norm(final)=16.164 | 3630.2 samples/s | 56.7 steps/s
[Step=88600 Epoch=173.2] | Loss=0.01464 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.747 | L2-Norm(final)=16.168 | 3899.9 samples/s | 60.9 steps/s
[Step=88650 Epoch=173.3] | Loss=0.01455 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.755 | L2-Norm(final)=16.172 | 3902.7 samples/s | 61.0 steps/s
[Step=88700 Epoch=173.4] | Loss=0.01373 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.762 | L2-Norm(final)=16.176 | 3920.2 samples/s | 61.3 steps/s
[Step=88750 Epoch=173.5] | Loss=0.01325 | Reg=0.00060 | acc=0.9844 | L2-Norm=7.769 | L2-Norm(final)=16.180 | 3877.9 samples/s | 60.6 steps/s
[Step=88800 Epoch=173.6] | Loss=0.01293 | Reg=0.00060 | acc=1.0000 | L2-Norm=7.775 | L2-Norm(final)=16.183 | 3925.5 samples/s | 61.3 steps/s
[Step=88850 Epoch=173.7] | Loss=0.01254 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.781 | L2-Norm(final)=16.187 | 3944.2 samples/s | 61.6 steps/s
[Step=88900 Epoch=173.8] | Loss=0.01260 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.787 | L2-Norm(final)=16.191 | 3993.9 samples/s | 62.4 steps/s
[Step=88950 Epoch=173.9] | Loss=0.01264 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.793 | L2-Norm(final)=16.194 | 3917.0 samples/s | 61.2 steps/s
[Step=89000 Epoch=174.0] | Loss=0.01241 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.799 | L2-Norm(final)=16.197 | 4825.3 samples/s | 75.4 steps/s
[Step=89050 Epoch=174.1] | Loss=0.01207 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.805 | L2-Norm(final)=16.201 | 1492.7 samples/s | 23.3 steps/s
[Step=89100 Epoch=174.2] | Loss=0.01181 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.810 | L2-Norm(final)=16.204 | 3909.9 samples/s | 61.1 steps/s
[Step=89150 Epoch=174.3] | Loss=0.01161 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.815 | L2-Norm(final)=16.208 | 3902.2 samples/s | 61.0 steps/s
[Step=89200 Epoch=174.4] | Loss=0.01133 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.820 | L2-Norm(final)=16.211 | 3891.6 samples/s | 60.8 steps/s
[Step=89250 Epoch=174.5] | Loss=0.01108 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.825 | L2-Norm(final)=16.214 | 3907.7 samples/s | 61.1 steps/s
[Step=89300 Epoch=174.6] | Loss=0.01085 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.830 | L2-Norm(final)=16.218 | 3918.0 samples/s | 61.2 steps/s
[Step=89350 Epoch=174.7] | Loss=0.01069 | Reg=0.00061 | acc=1.0000 | L2-Norm=7.835 | L2-Norm(final)=16.221 | 3890.9 samples/s | 60.8 steps/s
[Step=89400 Epoch=174.8] | Loss=0.01061 | Reg=0.00061 | acc=0.9844 | L2-Norm=7.839 | L2-Norm(final)=16.224 | 3836.5 samples/s | 59.9 steps/s
[Step=89450 Epoch=174.9] | Loss=0.01040 | Reg=0.00062 | acc=0.9844 | L2-Norm=7.844 | L2-Norm(final)=16.227 | 3907.8 samples/s | 61.1 steps/s
[Step=89500 Epoch=175.0] | Loss=0.01037 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.848 | L2-Norm(final)=16.230 | 4280.9 samples/s | 66.9 steps/s
[Step=89550 Epoch=175.1] | Loss=0.01024 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.853 | L2-Norm(final)=16.233 | 1610.6 samples/s | 25.2 steps/s
[Step=89600 Epoch=175.2] | Loss=0.01006 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.857 | L2-Norm(final)=16.236 | 3917.6 samples/s | 61.2 steps/s
[Step=89650 Epoch=175.3] | Loss=0.00986 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.862 | L2-Norm(final)=16.239 | 3966.4 samples/s | 62.0 steps/s
[Step=89700 Epoch=175.4] | Loss=0.00980 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.866 | L2-Norm(final)=16.242 | 3850.1 samples/s | 60.2 steps/s
[Step=89750 Epoch=175.5] | Loss=0.00968 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.870 | L2-Norm(final)=16.245 | 3936.9 samples/s | 61.5 steps/s
[Step=89800 Epoch=175.6] | Loss=0.00957 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.874 | L2-Norm(final)=16.248 | 3922.8 samples/s | 61.3 steps/s
[Step=89850 Epoch=175.7] | Loss=0.00949 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.878 | L2-Norm(final)=16.251 | 3922.4 samples/s | 61.3 steps/s
[Step=89900 Epoch=175.8] | Loss=0.00942 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.882 | L2-Norm(final)=16.254 | 3926.2 samples/s | 61.3 steps/s
[Step=89950 Epoch=175.8] | Loss=0.00933 | Reg=0.00062 | acc=0.9844 | L2-Norm=7.886 | L2-Norm(final)=16.256 | 3914.7 samples/s | 61.2 steps/s
[Step=90000 Epoch=175.9] | Loss=0.00922 | Reg=0.00062 | acc=1.0000 | L2-Norm=7.890 | L2-Norm(final)=16.259 | 3973.1 samples/s | 62.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step90000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=88001 Epoch=337.2] | Loss=0.00002 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.616 | L2-Norm(final)=11.297 | 3083.7 samples/s | 48.2 steps/s
[Step=88050 Epoch=337.4] | Loss=0.00006 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.611 | L2-Norm(final)=11.313 | 4000.0 samples/s | 62.5 steps/s
[Step=88100 Epoch=337.6] | Loss=0.00005 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.613 | L2-Norm(final)=11.325 | 4110.1 samples/s | 64.2 steps/s
[Step=88150 Epoch=337.8] | Loss=0.00004 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.613 | L2-Norm(final)=11.333 | 4156.9 samples/s | 65.0 steps/s
[Step=88200 Epoch=338.0] | Loss=0.00003 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.611 | L2-Norm(final)=11.339 | 4138.4 samples/s | 64.7 steps/s
[Step=88250 Epoch=338.1] | Loss=0.00002 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.608 | L2-Norm(final)=11.343 | 5359.7 samples/s | 83.7 steps/s
[Step=88300 Epoch=338.3] | Loss=0.00002 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.605 | L2-Norm(final)=11.348 | 1502.9 samples/s | 23.5 steps/s
[Step=88350 Epoch=338.5] | Loss=0.00002 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.601 | L2-Norm(final)=11.352 | 4099.5 samples/s | 64.1 steps/s
[Step=88400 Epoch=338.7] | Loss=0.00002 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.598 | L2-Norm(final)=11.356 | 4175.0 samples/s | 65.2 steps/s
[Step=88450 Epoch=338.9] | Loss=0.00002 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.594 | L2-Norm(final)=11.360 | 4082.9 samples/s | 63.8 steps/s
[Step=88500 Epoch=339.1] | Loss=0.00002 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.590 | L2-Norm(final)=11.363 | 4601.1 samples/s | 71.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=88501 Epoch=339.1] | Loss=0.00003 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.553 | L2-Norm(final)=11.399 | 3248.2 samples/s | 50.8 steps/s
[Step=88550 Epoch=339.3] | Loss=0.00001 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.539 | L2-Norm(final)=11.402 | 3457.3 samples/s | 54.0 steps/s
[Step=88600 Epoch=339.5] | Loss=0.00001 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.519 | L2-Norm(final)=11.404 | 3747.8 samples/s | 58.6 steps/s
[Step=88650 Epoch=339.7] | Loss=0.00001 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.498 | L2-Norm(final)=11.406 | 3738.4 samples/s | 58.4 steps/s
[Step=88700 Epoch=339.9] | Loss=0.00001 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.477 | L2-Norm(final)=11.408 | 3789.8 samples/s | 59.2 steps/s
[Step=88750 Epoch=340.1] | Loss=0.00001 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.457 | L2-Norm(final)=11.410 | 4686.1 samples/s | 73.2 steps/s
[Step=88800 Epoch=340.3] | Loss=0.00000 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.437 | L2-Norm(final)=11.413 | 1459.8 samples/s | 22.8 steps/s
[Step=88850 Epoch=340.4] | Loss=0.00000 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.417 | L2-Norm(final)=11.415 | 3760.6 samples/s | 58.8 steps/s
[Step=88900 Epoch=340.6] | Loss=0.00000 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.397 | L2-Norm(final)=11.416 | 3716.1 samples/s | 58.1 steps/s
[Step=88950 Epoch=340.8] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.377 | L2-Norm(final)=11.418 | 3720.1 samples/s | 58.1 steps/s
[Step=89000 Epoch=341.0] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.357 | L2-Norm(final)=11.420 | 4113.9 samples/s | 64.3 steps/s
[Step=89050 Epoch=341.2] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.336 | L2-Norm(final)=11.421 | 1517.1 samples/s | 23.7 steps/s
[Step=89100 Epoch=341.4] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.316 | L2-Norm(final)=11.423 | 3690.9 samples/s | 57.7 steps/s
[Step=89150 Epoch=341.6] | Loss=0.00000 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.296 | L2-Norm(final)=11.424 | 3723.1 samples/s | 58.2 steps/s
[Step=89200 Epoch=341.8] | Loss=0.00000 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.275 | L2-Norm(final)=11.426 | 3723.9 samples/s | 58.2 steps/s
[Step=89250 Epoch=342.0] | Loss=0.00000 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.255 | L2-Norm(final)=11.427 | 3755.2 samples/s | 58.7 steps/s
[Step=89300 Epoch=342.2] | Loss=0.00000 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.234 | L2-Norm(final)=11.429 | 1597.0 samples/s | 25.0 steps/s
[Step=89350 Epoch=342.4] | Loss=0.00000 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.213 | L2-Norm(final)=11.431 | 3750.7 samples/s | 58.6 steps/s
[Step=89400 Epoch=342.5] | Loss=0.00000 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.193 | L2-Norm(final)=11.432 | 3716.3 samples/s | 58.1 steps/s
[Step=89450 Epoch=342.7] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.172 | L2-Norm(final)=11.434 | 3773.3 samples/s | 59.0 steps/s
[Step=89500 Epoch=342.9] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.151 | L2-Norm(final)=11.436 | 3743.4 samples/s | 58.5 steps/s
[Step=89550 Epoch=343.1] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.131 | L2-Norm(final)=11.438 | 1580.6 samples/s | 24.7 steps/s
[Step=89600 Epoch=343.3] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.110 | L2-Norm(final)=11.440 | 3740.8 samples/s | 58.5 steps/s
[Step=89650 Epoch=343.5] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.090 | L2-Norm(final)=11.442 | 3762.0 samples/s | 58.8 steps/s
[Step=89700 Epoch=343.7] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.069 | L2-Norm(final)=11.444 | 3698.7 samples/s | 57.8 steps/s
[Step=89750 Epoch=343.9] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.049 | L2-Norm(final)=11.446 | 3748.6 samples/s | 58.6 steps/s
[Step=89800 Epoch=344.1] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.028 | L2-Norm(final)=11.448 | 5022.3 samples/s | 78.5 steps/s
[Step=89850 Epoch=344.3] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.008 | L2-Norm(final)=11.450 | 1433.5 samples/s | 22.4 steps/s
[Step=89900 Epoch=344.5] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.987 | L2-Norm(final)=11.452 | 3625.6 samples/s | 56.6 steps/s
[Step=89950 Epoch=344.7] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.967 | L2-Norm(final)=11.454 | 3725.8 samples/s | 58.2 steps/s
[Step=90000 Epoch=344.8] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.947 | L2-Norm(final)=11.457 | 3693.3 samples/s | 57.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step90000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=88001 Epoch=338.8] | Loss=0.00002 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.616 | L2-Norm(final)=11.300 | 3132.9 samples/s | 49.0 steps/s
[Step=88050 Epoch=338.9] | Loss=0.00007 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.611 | L2-Norm(final)=11.311 | 4024.9 samples/s | 62.9 steps/s
[Step=88100 Epoch=339.1] | Loss=0.00008 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.619 | L2-Norm(final)=11.321 | 4079.7 samples/s | 63.7 steps/s
[Step=88150 Epoch=339.3] | Loss=0.00006 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.622 | L2-Norm(final)=11.328 | 4055.4 samples/s | 63.4 steps/s
[Step=88200 Epoch=339.5] | Loss=0.00005 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.623 | L2-Norm(final)=11.333 | 4133.0 samples/s | 64.6 steps/s
[Step=88250 Epoch=339.7] | Loss=0.00004 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.623 | L2-Norm(final)=11.337 | 5443.9 samples/s | 85.1 steps/s
[Step=88300 Epoch=339.9] | Loss=0.00004 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.622 | L2-Norm(final)=11.341 | 1464.9 samples/s | 22.9 steps/s
[Step=88350 Epoch=340.1] | Loss=0.00004 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.621 | L2-Norm(final)=11.344 | 4130.2 samples/s | 64.5 steps/s
[Step=88400 Epoch=340.3] | Loss=0.00003 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.620 | L2-Norm(final)=11.347 | 3978.6 samples/s | 62.2 steps/s
[Step=88450 Epoch=340.5] | Loss=0.00003 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.618 | L2-Norm(final)=11.350 | 4078.4 samples/s | 63.7 steps/s
[Step=88500 Epoch=340.7] | Loss=0.00003 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.617 | L2-Norm(final)=11.353 | 4739.1 samples/s | 74.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=88501 Epoch=340.7] | Loss=0.00000 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.603 | L2-Norm(final)=11.382 | 3164.5 samples/s | 49.4 steps/s
[Step=88550 Epoch=340.9] | Loss=0.00001 | Reg=0.00058 | acc=1.0000 | L2-Norm=7.592 | L2-Norm(final)=11.384 | 3443.7 samples/s | 53.8 steps/s
[Step=88600 Epoch=341.1] | Loss=0.00001 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.578 | L2-Norm(final)=11.385 | 3709.9 samples/s | 58.0 steps/s
[Step=88650 Epoch=341.2] | Loss=0.00001 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.564 | L2-Norm(final)=11.387 | 3664.5 samples/s | 57.3 steps/s
[Step=88700 Epoch=341.4] | Loss=0.00001 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.551 | L2-Norm(final)=11.389 | 3757.1 samples/s | 58.7 steps/s
[Step=88750 Epoch=341.6] | Loss=0.00001 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.538 | L2-Norm(final)=11.391 | 4706.6 samples/s | 73.5 steps/s
[Step=88800 Epoch=341.8] | Loss=0.00001 | Reg=0.00057 | acc=1.0000 | L2-Norm=7.524 | L2-Norm(final)=11.392 | 1461.2 samples/s | 22.8 steps/s
[Step=88850 Epoch=342.0] | Loss=0.00001 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.509 | L2-Norm(final)=11.393 | 3691.8 samples/s | 57.7 steps/s
[Step=88900 Epoch=342.2] | Loss=0.00001 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.494 | L2-Norm(final)=11.395 | 3719.6 samples/s | 58.1 steps/s
[Step=88950 Epoch=342.4] | Loss=0.00001 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.480 | L2-Norm(final)=11.396 | 3742.6 samples/s | 58.5 steps/s
[Step=89000 Epoch=342.6] | Loss=0.00001 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.465 | L2-Norm(final)=11.397 | 4247.4 samples/s | 66.4 steps/s
[Step=89050 Epoch=342.8] | Loss=0.00001 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.450 | L2-Norm(final)=11.398 | 1503.2 samples/s | 23.5 steps/s
[Step=89100 Epoch=343.0] | Loss=0.00001 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.435 | L2-Norm(final)=11.399 | 3669.0 samples/s | 57.3 steps/s
[Step=89150 Epoch=343.2] | Loss=0.00000 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.420 | L2-Norm(final)=11.400 | 3738.9 samples/s | 58.4 steps/s
[Step=89200 Epoch=343.4] | Loss=0.00000 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.404 | L2-Norm(final)=11.401 | 3659.8 samples/s | 57.2 steps/s
[Step=89250 Epoch=343.6] | Loss=0.00000 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.389 | L2-Norm(final)=11.402 | 3801.5 samples/s | 59.4 steps/s
[Step=89300 Epoch=343.8] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.373 | L2-Norm(final)=11.403 | 1554.3 samples/s | 24.3 steps/s
[Step=89350 Epoch=343.9] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.358 | L2-Norm(final)=11.404 | 3703.5 samples/s | 57.9 steps/s
[Step=89400 Epoch=344.1] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.342 | L2-Norm(final)=11.405 | 3740.4 samples/s | 58.4 steps/s
[Step=89450 Epoch=344.3] | Loss=0.00000 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.326 | L2-Norm(final)=11.406 | 3751.6 samples/s | 58.6 steps/s
[Step=89500 Epoch=344.5] | Loss=0.00000 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.310 | L2-Norm(final)=11.407 | 3667.2 samples/s | 57.3 steps/s
[Step=89550 Epoch=344.7] | Loss=0.00000 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.294 | L2-Norm(final)=11.408 | 1561.9 samples/s | 24.4 steps/s
[Step=89600 Epoch=344.9] | Loss=0.00000 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.277 | L2-Norm(final)=11.409 | 3744.1 samples/s | 58.5 steps/s
[Step=89650 Epoch=345.1] | Loss=0.00000 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.261 | L2-Norm(final)=11.410 | 3713.6 samples/s | 58.0 steps/s
[Step=89700 Epoch=345.3] | Loss=0.00000 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.245 | L2-Norm(final)=11.411 | 3711.7 samples/s | 58.0 steps/s
[Step=89750 Epoch=345.5] | Loss=0.00000 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.228 | L2-Norm(final)=11.412 | 3706.1 samples/s | 57.9 steps/s
[Step=89800 Epoch=345.7] | Loss=0.00000 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.212 | L2-Norm(final)=11.413 | 5558.3 samples/s | 86.8 steps/s
[Step=89850 Epoch=345.9] | Loss=0.00000 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.195 | L2-Norm(final)=11.414 | 1425.1 samples/s | 22.3 steps/s
[Step=89900 Epoch=346.1] | Loss=0.00000 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.179 | L2-Norm(final)=11.416 | 3731.6 samples/s | 58.3 steps/s
[Step=89950 Epoch=346.3] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.162 | L2-Norm(final)=11.417 | 3762.2 samples/s | 58.8 steps/s
[Step=90000 Epoch=346.4] | Loss=0.00000 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.145 | L2-Norm(final)=11.418 | 3738.9 samples/s | 58.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step90000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05438 | acc=0.9690 | tpr=0.9720 | fpr=0.0377 | 3502.9 samples/s | 13.7 steps/s
Avg test loss: 0.05925, Avg test acc: 0.96654, Avg tpr: 0.97057, Avg fpr: 0.04230, total FA: 330

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05745 | acc=0.9677 | tpr=0.9663 | fpr=0.0295 | 3485.8 samples/s | 13.6 steps/s
Avg test loss: 0.06207, Avg test acc: 0.96538, Avg tpr: 0.96520, Avg fpr: 0.03423, total FA: 267

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.21634 | acc=0.3084 | tpr=0.0140 | fpr=0.0525 | 3509.8 samples/s | 13.7 steps/s
Avg test loss: 5.23330, Avg test acc: 0.30455, Avg tpr: 0.01393, Avg fpr: 0.05627, total FA: 439

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.01659 | acc=0.3130 | tpr=0.0137 | fpr=0.0372 | 3526.5 samples/s | 13.8 steps/s
Avg test loss: 5.02998, Avg test acc: 0.31024, Avg tpr: 0.01376, Avg fpr: 0.03769, total FA: 294

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.61362 | acc=0.1212 | tpr=0.8584 | fpr=0.8920 | 3500.9 samples/s | 13.7 steps/s
[Step= 100] | Loss=4.59582 | acc=0.1234 | tpr=0.8849 | fpr=0.8908 | 7026.3 samples/s | 27.4 steps/s
[Step= 150] | Loss=4.60625 | acc=0.1222 | tpr=0.8890 | fpr=0.8919 | 6758.4 samples/s | 26.4 steps/s
[Step= 200] | Loss=4.59106 | acc=0.1229 | tpr=0.8831 | fpr=0.8910 | 6787.3 samples/s | 26.5 steps/s
[Step= 250] | Loss=4.59751 | acc=0.1230 | tpr=0.8690 | fpr=0.8906 | 6970.3 samples/s | 27.2 steps/s
[Step= 300] | Loss=4.59800 | acc=0.1222 | tpr=0.8684 | fpr=0.8914 | 6778.2 samples/s | 26.5 steps/s
[Step= 350] | Loss=4.59361 | acc=0.1228 | tpr=0.8735 | fpr=0.8909 | 6889.8 samples/s | 26.9 steps/s
[Step= 400] | Loss=4.59113 | acc=0.1227 | tpr=0.8676 | fpr=0.8908 | 6989.5 samples/s | 27.3 steps/s
[Step= 450] | Loss=4.59762 | acc=0.1223 | tpr=0.8685 | fpr=0.8913 | 6711.5 samples/s | 26.2 steps/s
[Step= 500] | Loss=4.59840 | acc=0.1221 | tpr=0.8692 | fpr=0.8914 | 6847.1 samples/s | 26.7 steps/s
[Step= 550] | Loss=4.59798 | acc=0.1222 | tpr=0.8707 | fpr=0.8914 | 12499.2 samples/s | 48.8 steps/s
Avg test loss: 4.59855, Avg test acc: 0.12210, Avg tpr: 0.87005, Avg fpr: 0.89149, total FA: 123782

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.45649 | acc=0.1374 | tpr=0.8319 | fpr=0.8751 | 3518.4 samples/s | 13.7 steps/s
[Step= 100] | Loss=4.43512 | acc=0.1391 | tpr=0.8593 | fpr=0.8743 | 6906.8 samples/s | 27.0 steps/s
[Step= 150] | Loss=4.44851 | acc=0.1376 | tpr=0.8588 | fpr=0.8756 | 6855.8 samples/s | 26.8 steps/s
[Step= 200] | Loss=4.43701 | acc=0.1377 | tpr=0.8514 | fpr=0.8753 | 6845.8 samples/s | 26.7 steps/s
[Step= 250] | Loss=4.44372 | acc=0.1376 | tpr=0.8437 | fpr=0.8753 | 6864.5 samples/s | 26.8 steps/s
[Step= 300] | Loss=4.44644 | acc=0.1368 | tpr=0.8356 | fpr=0.8759 | 6898.6 samples/s | 26.9 steps/s
[Step= 350] | Loss=4.44353 | acc=0.1376 | tpr=0.8422 | fpr=0.8752 | 6850.6 samples/s | 26.8 steps/s
[Step= 400] | Loss=4.44008 | acc=0.1377 | tpr=0.8370 | fpr=0.8750 | 6544.7 samples/s | 25.6 steps/s
[Step= 450] | Loss=4.44724 | acc=0.1374 | tpr=0.8389 | fpr=0.8754 | 6772.9 samples/s | 26.5 steps/s
[Step= 500] | Loss=4.44696 | acc=0.1374 | tpr=0.8414 | fpr=0.8753 | 6706.4 samples/s | 26.2 steps/s
[Step= 550] | Loss=4.44586 | acc=0.1376 | tpr=0.8432 | fpr=0.8752 | 12499.3 samples/s | 48.8 steps/s
Avg test loss: 4.44648, Avg test acc: 0.13753, Avg tpr: 0.84311, Avg fpr: 0.87530, total FA: 121533

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09966 | acc=0.9819 | tpr=0.9513 | fpr=0.0176 | 3476.2 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.10447 | acc=0.9811 | tpr=0.9616 | fpr=0.0186 | 6996.4 samples/s | 27.3 steps/s
[Step= 150] | Loss=0.10808 | acc=0.9799 | tpr=0.9625 | fpr=0.0198 | 6576.8 samples/s | 25.7 steps/s
[Step= 200] | Loss=0.10932 | acc=0.9798 | tpr=0.9628 | fpr=0.0199 | 6784.9 samples/s | 26.5 steps/s
[Step= 250] | Loss=0.10834 | acc=0.9802 | tpr=0.9598 | fpr=0.0195 | 7004.6 samples/s | 27.4 steps/s
[Step= 300] | Loss=0.11012 | acc=0.9799 | tpr=0.9593 | fpr=0.0197 | 6695.7 samples/s | 26.2 steps/s
[Step= 350] | Loss=0.11023 | acc=0.9799 | tpr=0.9599 | fpr=0.0197 | 6890.2 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.11172 | acc=0.9796 | tpr=0.9557 | fpr=0.0199 | 6806.5 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.11397 | acc=0.9792 | tpr=0.9547 | fpr=0.0204 | 6659.3 samples/s | 26.0 steps/s
[Step= 500] | Loss=0.11358 | acc=0.9793 | tpr=0.9573 | fpr=0.0203 | 6786.2 samples/s | 26.5 steps/s
[Step= 550] | Loss=0.11266 | acc=0.9794 | tpr=0.9562 | fpr=0.0201 | 12117.8 samples/s | 47.3 steps/s
Avg test loss: 0.11253, Avg test acc: 0.97944, Avg tpr: 0.95602, Avg fpr: 0.02013, total FA: 2795

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09897 | acc=0.9817 | tpr=0.9469 | fpr=0.0177 | 3562.9 samples/s | 13.9 steps/s
[Step= 100] | Loss=0.10376 | acc=0.9811 | tpr=0.9595 | fpr=0.0185 | 6587.7 samples/s | 25.7 steps/s
[Step= 150] | Loss=0.10695 | acc=0.9802 | tpr=0.9640 | fpr=0.0195 | 6828.4 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.10852 | acc=0.9799 | tpr=0.9639 | fpr=0.0198 | 6823.9 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.10771 | acc=0.9801 | tpr=0.9616 | fpr=0.0196 | 6819.6 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.10937 | acc=0.9797 | tpr=0.9615 | fpr=0.0200 | 6898.7 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.10932 | acc=0.9796 | tpr=0.9612 | fpr=0.0201 | 6940.9 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.11047 | acc=0.9794 | tpr=0.9579 | fpr=0.0203 | 6674.6 samples/s | 26.1 steps/s
[Step= 450] | Loss=0.11264 | acc=0.9790 | tpr=0.9567 | fpr=0.0206 | 6806.6 samples/s | 26.6 steps/s
[Step= 500] | Loss=0.11241 | acc=0.9790 | tpr=0.9586 | fpr=0.0207 | 6737.5 samples/s | 26.3 steps/s
[Step= 550] | Loss=0.11159 | acc=0.9792 | tpr=0.9578 | fpr=0.0204 | 12172.4 samples/s | 47.5 steps/s
Avg test loss: 0.11154, Avg test acc: 0.97918, Avg tpr: 0.95721, Avg fpr: 0.02043, total FA: 2836

server round 45/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=90001 Epoch=175.5] | Loss=0.01107 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.171 | L2-Norm(final)=16.066 | 3036.9 samples/s | 47.5 steps/s
[Step=90050 Epoch=175.6] | Loss=0.02289 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.181 | L2-Norm(final)=16.071 | 4165.9 samples/s | 65.1 steps/s
[Step=90100 Epoch=175.7] | Loss=0.02742 | Reg=0.00052 | acc=0.9688 | L2-Norm=7.190 | L2-Norm(final)=16.077 | 4400.3 samples/s | 68.8 steps/s
[Step=90150 Epoch=175.8] | Loss=0.02576 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.197 | L2-Norm(final)=16.082 | 4272.9 samples/s | 66.8 steps/s
[Step=90200 Epoch=175.9] | Loss=0.02507 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.205 | L2-Norm(final)=16.086 | 4362.0 samples/s | 68.2 steps/s
[Step=90250 Epoch=176.0] | Loss=0.02545 | Reg=0.00052 | acc=0.9531 | L2-Norm=7.212 | L2-Norm(final)=16.091 | 4448.7 samples/s | 69.5 steps/s
[Step=90300 Epoch=176.1] | Loss=0.02484 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.219 | L2-Norm(final)=16.095 | 4375.0 samples/s | 68.4 steps/s
[Step=90350 Epoch=176.2] | Loss=0.02427 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.226 | L2-Norm(final)=16.100 | 4365.6 samples/s | 68.2 steps/s
[Step=90400 Epoch=176.3] | Loss=0.02432 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.233 | L2-Norm(final)=16.104 | 4367.2 samples/s | 68.2 steps/s
[Step=90450 Epoch=176.4] | Loss=0.02419 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.239 | L2-Norm(final)=16.109 | 4343.3 samples/s | 67.9 steps/s
[Step=90500 Epoch=176.5] | Loss=0.02388 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.246 | L2-Norm(final)=16.113 | 5481.3 samples/s | 85.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=90501 Epoch=176.5] | Loss=0.00823 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.309 | L2-Norm(final)=16.155 | 3280.6 samples/s | 51.3 steps/s
[Step=90550 Epoch=176.6] | Loss=0.02170 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.317 | L2-Norm(final)=16.159 | 3574.4 samples/s | 55.9 steps/s
[Step=90600 Epoch=176.7] | Loss=0.02048 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.327 | L2-Norm(final)=16.163 | 3923.6 samples/s | 61.3 steps/s
[Step=90650 Epoch=176.8] | Loss=0.01986 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.335 | L2-Norm(final)=16.167 | 3923.8 samples/s | 61.3 steps/s
[Step=90700 Epoch=176.9] | Loss=0.01950 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.343 | L2-Norm(final)=16.171 | 3925.9 samples/s | 61.3 steps/s
[Step=90750 Epoch=177.0] | Loss=0.01861 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.352 | L2-Norm(final)=16.175 | 3921.3 samples/s | 61.3 steps/s
[Step=90800 Epoch=177.1] | Loss=0.01816 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.359 | L2-Norm(final)=16.179 | 3966.5 samples/s | 62.0 steps/s
[Step=90850 Epoch=177.2] | Loss=0.01813 | Reg=0.00054 | acc=0.9531 | L2-Norm=7.367 | L2-Norm(final)=16.182 | 3899.9 samples/s | 60.9 steps/s
[Step=90900 Epoch=177.3] | Loss=0.01795 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.374 | L2-Norm(final)=16.186 | 3932.7 samples/s | 61.4 steps/s
[Step=90950 Epoch=177.4] | Loss=0.01751 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.381 | L2-Norm(final)=16.190 | 3955.0 samples/s | 61.8 steps/s
[Step=91000 Epoch=177.5] | Loss=0.01727 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.388 | L2-Norm(final)=16.193 | 4840.5 samples/s | 75.6 steps/s
[Step=91050 Epoch=177.6] | Loss=0.01673 | Reg=0.00055 | acc=0.9844 | L2-Norm=7.395 | L2-Norm(final)=16.197 | 1463.9 samples/s | 22.9 steps/s
[Step=91100 Epoch=177.7] | Loss=0.01621 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.401 | L2-Norm(final)=16.201 | 3939.1 samples/s | 61.5 steps/s
[Step=91150 Epoch=177.8] | Loss=0.01582 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.408 | L2-Norm(final)=16.204 | 3933.7 samples/s | 61.5 steps/s
[Step=91200 Epoch=177.9] | Loss=0.01552 | Reg=0.00055 | acc=0.9844 | L2-Norm=7.414 | L2-Norm(final)=16.208 | 3965.5 samples/s | 62.0 steps/s
[Step=91250 Epoch=178.0] | Loss=0.01519 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.420 | L2-Norm(final)=16.211 | 3942.5 samples/s | 61.6 steps/s
[Step=91300 Epoch=178.1] | Loss=0.01497 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.426 | L2-Norm(final)=16.215 | 3955.6 samples/s | 61.8 steps/s
[Step=91350 Epoch=178.2] | Loss=0.01475 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.432 | L2-Norm(final)=16.218 | 3926.8 samples/s | 61.4 steps/s
[Step=91400 Epoch=178.3] | Loss=0.01453 | Reg=0.00055 | acc=0.9844 | L2-Norm=7.437 | L2-Norm(final)=16.221 | 3957.4 samples/s | 61.8 steps/s
[Step=91450 Epoch=178.4] | Loss=0.01424 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.443 | L2-Norm(final)=16.225 | 3953.6 samples/s | 61.8 steps/s
[Step=91500 Epoch=178.5] | Loss=0.01409 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.448 | L2-Norm(final)=16.228 | 4127.4 samples/s | 64.5 steps/s
[Step=91550 Epoch=178.6] | Loss=0.01385 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.454 | L2-Norm(final)=16.231 | 1560.2 samples/s | 24.4 steps/s
[Step=91600 Epoch=178.7] | Loss=0.01360 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.459 | L2-Norm(final)=16.234 | 3962.3 samples/s | 61.9 steps/s
[Step=91650 Epoch=178.8] | Loss=0.01343 | Reg=0.00056 | acc=0.9844 | L2-Norm=7.464 | L2-Norm(final)=16.237 | 3911.3 samples/s | 61.1 steps/s
[Step=91700 Epoch=178.9] | Loss=0.01328 | Reg=0.00056 | acc=0.9688 | L2-Norm=7.469 | L2-Norm(final)=16.241 | 3949.9 samples/s | 61.7 steps/s
[Step=91750 Epoch=178.9] | Loss=0.01310 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.474 | L2-Norm(final)=16.244 | 3967.1 samples/s | 62.0 steps/s
[Step=91800 Epoch=179.0] | Loss=0.01290 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.479 | L2-Norm(final)=16.247 | 4022.1 samples/s | 62.8 steps/s
[Step=91850 Epoch=179.1] | Loss=0.01271 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.484 | L2-Norm(final)=16.250 | 3936.8 samples/s | 61.5 steps/s
[Step=91900 Epoch=179.2] | Loss=0.01251 | Reg=0.00056 | acc=0.9688 | L2-Norm=7.489 | L2-Norm(final)=16.253 | 3946.6 samples/s | 61.7 steps/s
[Step=91950 Epoch=179.3] | Loss=0.01242 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.494 | L2-Norm(final)=16.256 | 3971.8 samples/s | 62.1 steps/s
[Step=92000 Epoch=179.4] | Loss=0.01236 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.499 | L2-Norm(final)=16.259 | 3985.6 samples/s | 62.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step92000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=90001 Epoch=175.9] | Loss=0.04266 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.171 | L2-Norm(final)=16.342 | 3560.6 samples/s | 55.6 steps/s
[Step=90050 Epoch=176.0] | Loss=0.02520 | Reg=0.00052 | acc=0.9688 | L2-Norm=7.181 | L2-Norm(final)=16.347 | 3832.8 samples/s | 59.9 steps/s
[Step=90100 Epoch=176.1] | Loss=0.02468 | Reg=0.00052 | acc=0.9531 | L2-Norm=7.189 | L2-Norm(final)=16.354 | 4365.6 samples/s | 68.2 steps/s
[Step=90150 Epoch=176.2] | Loss=0.02449 | Reg=0.00052 | acc=0.9688 | L2-Norm=7.197 | L2-Norm(final)=16.360 | 4338.1 samples/s | 67.8 steps/s
[Step=90200 Epoch=176.3] | Loss=0.02389 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.205 | L2-Norm(final)=16.366 | 4382.3 samples/s | 68.5 steps/s
[Step=90250 Epoch=176.4] | Loss=0.02378 | Reg=0.00052 | acc=0.9531 | L2-Norm=7.212 | L2-Norm(final)=16.371 | 4289.2 samples/s | 67.0 steps/s
[Step=90300 Epoch=176.5] | Loss=0.02363 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.219 | L2-Norm(final)=16.377 | 4401.1 samples/s | 68.8 steps/s
[Step=90350 Epoch=176.6] | Loss=0.02364 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.226 | L2-Norm(final)=16.382 | 4468.0 samples/s | 69.8 steps/s
[Step=90400 Epoch=176.7] | Loss=0.02329 | Reg=0.00052 | acc=0.9688 | L2-Norm=7.232 | L2-Norm(final)=16.387 | 4341.8 samples/s | 67.8 steps/s
[Step=90450 Epoch=176.8] | Loss=0.02315 | Reg=0.00052 | acc=0.9688 | L2-Norm=7.238 | L2-Norm(final)=16.392 | 4414.6 samples/s | 69.0 steps/s
[Step=90500 Epoch=176.9] | Loss=0.02299 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.245 | L2-Norm(final)=16.397 | 5526.8 samples/s | 86.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=90501 Epoch=176.9] | Loss=0.01726 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.303 | L2-Norm(final)=16.444 | 3180.7 samples/s | 49.7 steps/s
[Step=90550 Epoch=177.0] | Loss=0.01938 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.312 | L2-Norm(final)=16.448 | 3827.5 samples/s | 59.8 steps/s
[Step=90600 Epoch=177.1] | Loss=0.01846 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.321 | L2-Norm(final)=16.453 | 3907.5 samples/s | 61.1 steps/s
[Step=90650 Epoch=177.2] | Loss=0.01797 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.330 | L2-Norm(final)=16.457 | 3868.3 samples/s | 60.4 steps/s
[Step=90700 Epoch=177.3] | Loss=0.01804 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.339 | L2-Norm(final)=16.462 | 3897.8 samples/s | 60.9 steps/s
[Step=90750 Epoch=177.4] | Loss=0.01746 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.347 | L2-Norm(final)=16.466 | 3944.0 samples/s | 61.6 steps/s
[Step=90800 Epoch=177.5] | Loss=0.01718 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.355 | L2-Norm(final)=16.470 | 3937.6 samples/s | 61.5 steps/s
[Step=90850 Epoch=177.6] | Loss=0.01690 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.362 | L2-Norm(final)=16.474 | 3921.0 samples/s | 61.3 steps/s
[Step=90900 Epoch=177.7] | Loss=0.01680 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.369 | L2-Norm(final)=16.478 | 3922.2 samples/s | 61.3 steps/s
[Step=90950 Epoch=177.8] | Loss=0.01674 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.376 | L2-Norm(final)=16.482 | 3896.8 samples/s | 60.9 steps/s
[Step=91000 Epoch=177.9] | Loss=0.01650 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.383 | L2-Norm(final)=16.486 | 4837.5 samples/s | 75.6 steps/s
[Step=91050 Epoch=178.0] | Loss=0.01614 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.390 | L2-Norm(final)=16.490 | 1533.4 samples/s | 24.0 steps/s
[Step=91100 Epoch=178.1] | Loss=0.01567 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.397 | L2-Norm(final)=16.494 | 3869.0 samples/s | 60.5 steps/s
[Step=91150 Epoch=178.2] | Loss=0.01514 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.404 | L2-Norm(final)=16.498 | 3841.9 samples/s | 60.0 steps/s
[Step=91200 Epoch=178.3] | Loss=0.01479 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.410 | L2-Norm(final)=16.502 | 3908.9 samples/s | 61.1 steps/s
[Step=91250 Epoch=178.4] | Loss=0.01449 | Reg=0.00055 | acc=0.9688 | L2-Norm=7.416 | L2-Norm(final)=16.506 | 3941.8 samples/s | 61.6 steps/s
[Step=91300 Epoch=178.5] | Loss=0.01421 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.422 | L2-Norm(final)=16.509 | 3888.1 samples/s | 60.8 steps/s
[Step=91350 Epoch=178.6] | Loss=0.01399 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.428 | L2-Norm(final)=16.513 | 3920.5 samples/s | 61.3 steps/s
[Step=91400 Epoch=178.7] | Loss=0.01382 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.434 | L2-Norm(final)=16.517 | 3882.4 samples/s | 60.7 steps/s
[Step=91450 Epoch=178.8] | Loss=0.01361 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.439 | L2-Norm(final)=16.520 | 4000.9 samples/s | 62.5 steps/s
[Step=91500 Epoch=178.9] | Loss=0.01337 | Reg=0.00055 | acc=1.0000 | L2-Norm=7.445 | L2-Norm(final)=16.524 | 4265.4 samples/s | 66.6 steps/s
[Step=91550 Epoch=179.0] | Loss=0.01328 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.450 | L2-Norm(final)=16.527 | 1566.1 samples/s | 24.5 steps/s
[Step=91600 Epoch=179.1] | Loss=0.01302 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.456 | L2-Norm(final)=16.531 | 3908.8 samples/s | 61.1 steps/s
[Step=91650 Epoch=179.2] | Loss=0.01285 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.461 | L2-Norm(final)=16.534 | 3892.9 samples/s | 60.8 steps/s
[Step=91700 Epoch=179.3] | Loss=0.01267 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.466 | L2-Norm(final)=16.537 | 3850.3 samples/s | 60.2 steps/s
[Step=91750 Epoch=179.4] | Loss=0.01249 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.472 | L2-Norm(final)=16.541 | 3918.7 samples/s | 61.2 steps/s
[Step=91800 Epoch=179.5] | Loss=0.01228 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.477 | L2-Norm(final)=16.544 | 3920.2 samples/s | 61.3 steps/s
[Step=91850 Epoch=179.6] | Loss=0.01217 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.482 | L2-Norm(final)=16.547 | 3925.9 samples/s | 61.3 steps/s
[Step=91900 Epoch=179.7] | Loss=0.01206 | Reg=0.00056 | acc=0.9844 | L2-Norm=7.487 | L2-Norm(final)=16.551 | 3933.1 samples/s | 61.5 steps/s
[Step=91950 Epoch=179.8] | Loss=0.01197 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.491 | L2-Norm(final)=16.554 | 3936.0 samples/s | 61.5 steps/s
[Step=92000 Epoch=179.9] | Loss=0.01180 | Reg=0.00056 | acc=1.0000 | L2-Norm=7.496 | L2-Norm(final)=16.557 | 3957.8 samples/s | 61.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step92000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=90001 Epoch=344.9] | Loss=0.00111 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.171 | L2-Norm(final)=11.530 | 3208.7 samples/s | 50.1 steps/s
[Step=90050 Epoch=345.0] | Loss=0.00006 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.171 | L2-Norm(final)=11.543 | 3903.6 samples/s | 61.0 steps/s
[Step=90100 Epoch=345.2] | Loss=0.00004 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.168 | L2-Norm(final)=11.553 | 4089.1 samples/s | 63.9 steps/s
[Step=90150 Epoch=345.4] | Loss=0.00003 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.165 | L2-Norm(final)=11.562 | 4105.2 samples/s | 64.1 steps/s
[Step=90200 Epoch=345.6] | Loss=0.00003 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.162 | L2-Norm(final)=11.569 | 4192.0 samples/s | 65.5 steps/s
[Step=90250 Epoch=345.8] | Loss=0.00003 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.159 | L2-Norm(final)=11.576 | 5304.8 samples/s | 82.9 steps/s
[Step=90300 Epoch=346.0] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.156 | L2-Norm(final)=11.583 | 1522.9 samples/s | 23.8 steps/s
[Step=90350 Epoch=346.2] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.152 | L2-Norm(final)=11.589 | 4119.2 samples/s | 64.4 steps/s
[Step=90400 Epoch=346.4] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.149 | L2-Norm(final)=11.594 | 4114.3 samples/s | 64.3 steps/s
[Step=90450 Epoch=346.6] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.145 | L2-Norm(final)=11.599 | 4137.9 samples/s | 64.7 steps/s
[Step=90500 Epoch=346.8] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.141 | L2-Norm(final)=11.604 | 4642.5 samples/s | 72.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=90501 Epoch=346.8] | Loss=0.00000 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.105 | L2-Norm(final)=11.655 | 3089.8 samples/s | 48.3 steps/s
[Step=90550 Epoch=347.0] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.094 | L2-Norm(final)=11.661 | 3595.5 samples/s | 56.2 steps/s
[Step=90600 Epoch=347.1] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.083 | L2-Norm(final)=11.667 | 3716.4 samples/s | 58.1 steps/s
[Step=90650 Epoch=347.3] | Loss=0.00003 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.077 | L2-Norm(final)=11.674 | 3740.9 samples/s | 58.5 steps/s
[Step=90700 Epoch=347.5] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.072 | L2-Norm(final)=11.679 | 3657.5 samples/s | 57.1 steps/s
[Step=90750 Epoch=347.7] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.067 | L2-Norm(final)=11.682 | 4755.0 samples/s | 74.3 steps/s
[Step=90800 Epoch=347.9] | Loss=0.00002 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.062 | L2-Norm(final)=11.685 | 1464.4 samples/s | 22.9 steps/s
[Step=90850 Epoch=348.1] | Loss=0.00001 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.056 | L2-Norm(final)=11.687 | 3703.8 samples/s | 57.9 steps/s
[Step=90900 Epoch=348.3] | Loss=0.00001 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.049 | L2-Norm(final)=11.689 | 3707.8 samples/s | 57.9 steps/s
[Step=90950 Epoch=348.5] | Loss=0.00001 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.043 | L2-Norm(final)=11.691 | 3712.6 samples/s | 58.0 steps/s
[Step=91000 Epoch=348.7] | Loss=0.00001 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.036 | L2-Norm(final)=11.692 | 4158.7 samples/s | 65.0 steps/s
[Step=91050 Epoch=348.9] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.030 | L2-Norm(final)=11.693 | 1524.3 samples/s | 23.8 steps/s
[Step=91100 Epoch=349.1] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.023 | L2-Norm(final)=11.695 | 3717.9 samples/s | 58.1 steps/s
[Step=91150 Epoch=349.3] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.016 | L2-Norm(final)=11.696 | 3770.7 samples/s | 58.9 steps/s
[Step=91200 Epoch=349.4] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.009 | L2-Norm(final)=11.697 | 3726.3 samples/s | 58.2 steps/s
[Step=91250 Epoch=349.6] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.001 | L2-Norm(final)=11.698 | 3687.7 samples/s | 57.6 steps/s
[Step=91300 Epoch=349.8] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.994 | L2-Norm(final)=11.699 | 1576.8 samples/s | 24.6 steps/s
[Step=91350 Epoch=350.0] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.987 | L2-Norm(final)=11.700 | 3794.2 samples/s | 59.3 steps/s
[Step=91400 Epoch=350.2] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.979 | L2-Norm(final)=11.701 | 3711.6 samples/s | 58.0 steps/s
[Step=91450 Epoch=350.4] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.972 | L2-Norm(final)=11.702 | 3697.3 samples/s | 57.8 steps/s
[Step=91500 Epoch=350.6] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.964 | L2-Norm(final)=11.703 | 3727.6 samples/s | 58.2 steps/s
[Step=91550 Epoch=350.8] | Loss=0.00001 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.957 | L2-Norm(final)=11.704 | 1631.7 samples/s | 25.5 steps/s
[Step=91600 Epoch=351.0] | Loss=0.00001 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.949 | L2-Norm(final)=11.705 | 3675.9 samples/s | 57.4 steps/s
[Step=91650 Epoch=351.2] | Loss=0.00001 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.941 | L2-Norm(final)=11.706 | 3754.4 samples/s | 58.7 steps/s
[Step=91700 Epoch=351.4] | Loss=0.00001 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.933 | L2-Norm(final)=11.707 | 3778.2 samples/s | 59.0 steps/s
[Step=91750 Epoch=351.6] | Loss=0.00001 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.925 | L2-Norm(final)=11.708 | 3719.0 samples/s | 58.1 steps/s
[Step=91800 Epoch=351.7] | Loss=0.00001 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.917 | L2-Norm(final)=11.709 | 5101.0 samples/s | 79.7 steps/s
[Step=91850 Epoch=351.9] | Loss=0.00001 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.909 | L2-Norm(final)=11.710 | 1448.2 samples/s | 22.6 steps/s
[Step=91900 Epoch=352.1] | Loss=0.00001 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.901 | L2-Norm(final)=11.711 | 3661.0 samples/s | 57.2 steps/s
[Step=91950 Epoch=352.3] | Loss=0.00001 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.893 | L2-Norm(final)=11.712 | 3727.3 samples/s | 58.2 steps/s
[Step=92000 Epoch=352.5] | Loss=0.00001 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.884 | L2-Norm(final)=11.713 | 3753.7 samples/s | 58.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step92000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=90001 Epoch=346.4] | Loss=0.00005 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.171 | L2-Norm(final)=11.455 | 3018.2 samples/s | 47.2 steps/s
[Step=90050 Epoch=346.6] | Loss=0.00008 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.168 | L2-Norm(final)=11.467 | 4166.2 samples/s | 65.1 steps/s
[Step=90100 Epoch=346.8] | Loss=0.00008 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.172 | L2-Norm(final)=11.480 | 4181.3 samples/s | 65.3 steps/s
[Step=90150 Epoch=347.0] | Loss=0.00006 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.175 | L2-Norm(final)=11.489 | 4154.6 samples/s | 64.9 steps/s
[Step=90200 Epoch=347.2] | Loss=0.00006 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.176 | L2-Norm(final)=11.496 | 4159.2 samples/s | 65.0 steps/s
[Step=90250 Epoch=347.4] | Loss=0.00006 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.177 | L2-Norm(final)=11.503 | 5408.1 samples/s | 84.5 steps/s
[Step=90300 Epoch=347.6] | Loss=0.00005 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.178 | L2-Norm(final)=11.509 | 1508.8 samples/s | 23.6 steps/s
[Step=90350 Epoch=347.8] | Loss=0.00005 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.179 | L2-Norm(final)=11.514 | 4143.3 samples/s | 64.7 steps/s
[Step=90400 Epoch=348.0] | Loss=0.00004 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.179 | L2-Norm(final)=11.518 | 3946.2 samples/s | 61.7 steps/s
[Step=90450 Epoch=348.2] | Loss=0.00004 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.178 | L2-Norm(final)=11.522 | 4131.3 samples/s | 64.6 steps/s
[Step=90500 Epoch=348.4] | Loss=0.00004 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.178 | L2-Norm(final)=11.526 | 4684.1 samples/s | 73.2 steps/s
All layers training...
LR=0.00006, len=1
[Step=90501 Epoch=348.4] | Loss=0.00003 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.171 | L2-Norm(final)=11.565 | 3164.5 samples/s | 49.4 steps/s
[Step=90550 Epoch=348.6] | Loss=0.00003 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.169 | L2-Norm(final)=11.570 | 3290.4 samples/s | 51.4 steps/s
[Step=90600 Epoch=348.8] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.164 | L2-Norm(final)=11.573 | 3622.4 samples/s | 56.6 steps/s
[Step=90650 Epoch=348.9] | Loss=0.00002 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.156 | L2-Norm(final)=11.576 | 3585.1 samples/s | 56.0 steps/s
[Step=90700 Epoch=349.1] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.147 | L2-Norm(final)=11.578 | 3764.6 samples/s | 58.8 steps/s
[Step=90750 Epoch=349.3] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.138 | L2-Norm(final)=11.579 | 4813.3 samples/s | 75.2 steps/s
[Step=90800 Epoch=349.5] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.128 | L2-Norm(final)=11.581 | 1456.6 samples/s | 22.8 steps/s
[Step=90850 Epoch=349.7] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.117 | L2-Norm(final)=11.582 | 3735.9 samples/s | 58.4 steps/s
[Step=90900 Epoch=349.9] | Loss=0.00001 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.106 | L2-Norm(final)=11.583 | 3745.6 samples/s | 58.5 steps/s
[Step=90950 Epoch=350.1] | Loss=0.00001 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.095 | L2-Norm(final)=11.584 | 3738.3 samples/s | 58.4 steps/s
[Step=91000 Epoch=350.3] | Loss=0.00001 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.084 | L2-Norm(final)=11.585 | 4279.5 samples/s | 66.9 steps/s
[Step=91050 Epoch=350.5] | Loss=0.00001 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.073 | L2-Norm(final)=11.586 | 1544.2 samples/s | 24.1 steps/s
[Step=91100 Epoch=350.7] | Loss=0.00001 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.061 | L2-Norm(final)=11.587 | 3727.5 samples/s | 58.2 steps/s
[Step=91150 Epoch=350.9] | Loss=0.00001 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.049 | L2-Norm(final)=11.588 | 3750.0 samples/s | 58.6 steps/s
[Step=91200 Epoch=351.1] | Loss=0.00001 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.037 | L2-Norm(final)=11.589 | 3753.9 samples/s | 58.7 steps/s
[Step=91250 Epoch=351.3] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.026 | L2-Norm(final)=11.589 | 3764.9 samples/s | 58.8 steps/s
[Step=91300 Epoch=351.4] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.013 | L2-Norm(final)=11.590 | 1583.3 samples/s | 24.7 steps/s
[Step=91350 Epoch=351.6] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.001 | L2-Norm(final)=11.591 | 3728.7 samples/s | 58.3 steps/s
[Step=91400 Epoch=351.8] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.989 | L2-Norm(final)=11.592 | 3705.7 samples/s | 57.9 steps/s
[Step=91450 Epoch=352.0] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.976 | L2-Norm(final)=11.593 | 3741.0 samples/s | 58.5 steps/s
[Step=91500 Epoch=352.2] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.964 | L2-Norm(final)=11.594 | 3793.1 samples/s | 59.3 steps/s
[Step=91550 Epoch=352.4] | Loss=0.00001 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.951 | L2-Norm(final)=11.595 | 1585.0 samples/s | 24.8 steps/s
[Step=91600 Epoch=352.6] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.938 | L2-Norm(final)=11.595 | 3686.7 samples/s | 57.6 steps/s
[Step=91650 Epoch=352.8] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.925 | L2-Norm(final)=11.596 | 3695.6 samples/s | 57.7 steps/s
[Step=91700 Epoch=353.0] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.912 | L2-Norm(final)=11.597 | 3733.2 samples/s | 58.3 steps/s
[Step=91750 Epoch=353.2] | Loss=0.00000 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.899 | L2-Norm(final)=11.598 | 3691.9 samples/s | 57.7 steps/s
[Step=91800 Epoch=353.4] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.886 | L2-Norm(final)=11.599 | 5485.9 samples/s | 85.7 steps/s
[Step=91850 Epoch=353.6] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.873 | L2-Norm(final)=11.600 | 1386.9 samples/s | 21.7 steps/s
[Step=91900 Epoch=353.8] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.859 | L2-Norm(final)=11.601 | 3661.9 samples/s | 57.2 steps/s
[Step=91950 Epoch=354.0] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.846 | L2-Norm(final)=11.602 | 3740.7 samples/s | 58.4 steps/s
[Step=92000 Epoch=354.1] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.832 | L2-Norm(final)=11.603 | 3648.3 samples/s | 57.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step92000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05139 | acc=0.9691 | tpr=0.9799 | fpr=0.0543 | 3502.5 samples/s | 13.7 steps/s
Avg test loss: 0.05591, Avg test acc: 0.96634, Avg tpr: 0.97814, Avg fpr: 0.05961, total FA: 465

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05480 | acc=0.9673 | tpr=0.9682 | fpr=0.0347 | 3492.0 samples/s | 13.6 steps/s
Avg test loss: 0.05888, Avg test acc: 0.96566, Avg tpr: 0.96765, Avg fpr: 0.03871, total FA: 302

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.46148 | acc=0.3098 | tpr=0.0140 | fpr=0.0478 | 3499.4 samples/s | 13.7 steps/s
Avg test loss: 5.48068, Avg test acc: 0.30587, Avg tpr: 0.01341, Avg fpr: 0.05089, total FA: 397

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.05795 | acc=0.3112 | tpr=0.0146 | fpr=0.0448 | 3516.8 samples/s | 13.7 steps/s
Avg test loss: 5.07228, Avg test acc: 0.30884, Avg tpr: 0.01475, Avg fpr: 0.04435, total FA: 346

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.79376 | acc=0.1056 | tpr=0.8982 | fpr=0.9086 | 3492.8 samples/s | 13.6 steps/s
[Step= 100] | Loss=4.77356 | acc=0.1065 | tpr=0.9254 | fpr=0.9088 | 6894.7 samples/s | 26.9 steps/s
[Step= 150] | Loss=4.78308 | acc=0.1054 | tpr=0.9323 | fpr=0.9098 | 6739.9 samples/s | 26.3 steps/s
[Step= 200] | Loss=4.76884 | acc=0.1055 | tpr=0.9158 | fpr=0.9093 | 6917.6 samples/s | 27.0 steps/s
[Step= 250] | Loss=4.77516 | acc=0.1055 | tpr=0.9109 | fpr=0.9092 | 6832.3 samples/s | 26.7 steps/s
[Step= 300] | Loss=4.77495 | acc=0.1049 | tpr=0.9113 | fpr=0.9098 | 6825.4 samples/s | 26.7 steps/s
[Step= 350] | Loss=4.77087 | acc=0.1052 | tpr=0.9130 | fpr=0.9094 | 6753.1 samples/s | 26.4 steps/s
[Step= 400] | Loss=4.76882 | acc=0.1051 | tpr=0.9108 | fpr=0.9095 | 6879.4 samples/s | 26.9 steps/s
[Step= 450] | Loss=4.77476 | acc=0.1047 | tpr=0.9094 | fpr=0.9099 | 6914.6 samples/s | 27.0 steps/s
[Step= 500] | Loss=4.77541 | acc=0.1047 | tpr=0.9106 | fpr=0.9099 | 6555.1 samples/s | 25.6 steps/s
[Step= 550] | Loss=4.77450 | acc=0.1048 | tpr=0.9097 | fpr=0.9098 | 12682.4 samples/s | 49.5 steps/s
Avg test loss: 4.77509, Avg test acc: 0.10474, Avg tpr: 0.90927, Avg fpr: 0.90988, total FA: 126335

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.55029 | acc=0.1293 | tpr=0.8496 | fpr=0.8836 | 3482.9 samples/s | 13.6 steps/s
[Step= 100] | Loss=4.52995 | acc=0.1300 | tpr=0.8806 | fpr=0.8840 | 6994.8 samples/s | 27.3 steps/s
[Step= 150] | Loss=4.54280 | acc=0.1287 | tpr=0.8790 | fpr=0.8851 | 6899.4 samples/s | 27.0 steps/s
[Step= 200] | Loss=4.53128 | acc=0.1288 | tpr=0.8710 | fpr=0.8847 | 6947.7 samples/s | 27.1 steps/s
[Step= 250] | Loss=4.53767 | acc=0.1284 | tpr=0.8576 | fpr=0.8849 | 6758.2 samples/s | 26.4 steps/s
[Step= 300] | Loss=4.53917 | acc=0.1279 | tpr=0.8531 | fpr=0.8853 | 6796.2 samples/s | 26.5 steps/s
[Step= 350] | Loss=4.53676 | acc=0.1286 | tpr=0.8597 | fpr=0.8847 | 7366.4 samples/s | 28.8 steps/s
[Step= 400] | Loss=4.53426 | acc=0.1286 | tpr=0.8561 | fpr=0.8847 | 6410.8 samples/s | 25.0 steps/s
[Step= 450] | Loss=4.54130 | acc=0.1281 | tpr=0.8578 | fpr=0.8851 | 6713.5 samples/s | 26.2 steps/s
[Step= 500] | Loss=4.54179 | acc=0.1279 | tpr=0.8604 | fpr=0.8853 | 6867.0 samples/s | 26.8 steps/s
[Step= 550] | Loss=4.54068 | acc=0.1280 | tpr=0.8611 | fpr=0.8853 | 12613.5 samples/s | 49.3 steps/s
Avg test loss: 4.54125, Avg test acc: 0.12794, Avg tpr: 0.86094, Avg fpr: 0.88539, total FA: 122934

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09660 | acc=0.9827 | tpr=0.9469 | fpr=0.0166 | 3497.2 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.10124 | acc=0.9821 | tpr=0.9574 | fpr=0.0174 | 6983.9 samples/s | 27.3 steps/s
[Step= 150] | Loss=0.10471 | acc=0.9812 | tpr=0.9597 | fpr=0.0184 | 6897.7 samples/s | 26.9 steps/s
[Step= 200] | Loss=0.10597 | acc=0.9811 | tpr=0.9596 | fpr=0.0185 | 6844.5 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.10504 | acc=0.9815 | tpr=0.9563 | fpr=0.0180 | 7165.3 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.10675 | acc=0.9812 | tpr=0.9556 | fpr=0.0183 | 6587.1 samples/s | 25.7 steps/s
[Step= 350] | Loss=0.10688 | acc=0.9811 | tpr=0.9555 | fpr=0.0184 | 6607.1 samples/s | 25.8 steps/s
[Step= 400] | Loss=0.10830 | acc=0.9809 | tpr=0.9519 | fpr=0.0186 | 6723.5 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.11051 | acc=0.9805 | tpr=0.9503 | fpr=0.0190 | 6753.6 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.11005 | acc=0.9806 | tpr=0.9533 | fpr=0.0189 | 6752.3 samples/s | 26.4 steps/s
[Step= 550] | Loss=0.10924 | acc=0.9807 | tpr=0.9522 | fpr=0.0188 | 12242.8 samples/s | 47.8 steps/s
Avg test loss: 0.10911, Avg test acc: 0.98072, Avg tpr: 0.95166, Avg fpr: 0.01875, total FA: 2604

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10095 | acc=0.9821 | tpr=0.9513 | fpr=0.0173 | 3452.5 samples/s | 13.5 steps/s
[Step= 100] | Loss=0.10567 | acc=0.9814 | tpr=0.9616 | fpr=0.0182 | 7170.9 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.10917 | acc=0.9804 | tpr=0.9654 | fpr=0.0193 | 6462.9 samples/s | 25.2 steps/s
[Step= 200] | Loss=0.11108 | acc=0.9800 | tpr=0.9650 | fpr=0.0197 | 6833.5 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.11025 | acc=0.9801 | tpr=0.9616 | fpr=0.0195 | 6755.7 samples/s | 26.4 steps/s
[Step= 300] | Loss=0.11208 | acc=0.9799 | tpr=0.9615 | fpr=0.0198 | 6927.4 samples/s | 27.1 steps/s
[Step= 350] | Loss=0.11216 | acc=0.9799 | tpr=0.9618 | fpr=0.0198 | 6902.4 samples/s | 27.0 steps/s
[Step= 400] | Loss=0.11333 | acc=0.9797 | tpr=0.9595 | fpr=0.0200 | 6748.7 samples/s | 26.4 steps/s
[Step= 450] | Loss=0.11560 | acc=0.9793 | tpr=0.9581 | fpr=0.0204 | 6759.4 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.11532 | acc=0.9793 | tpr=0.9599 | fpr=0.0204 | 6939.9 samples/s | 27.1 steps/s
[Step= 550] | Loss=0.11446 | acc=0.9795 | tpr=0.9590 | fpr=0.0202 | 11798.0 samples/s | 46.1 steps/s
Avg test loss: 0.11441, Avg test acc: 0.97947, Avg tpr: 0.95840, Avg fpr: 0.02015, total FA: 2798

server round 46/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=92001 Epoch=179.4] | Loss=0.05130 | Reg=0.00049 | acc=0.9375 | L2-Norm=7.003 | L2-Norm(final)=16.347 | 3175.5 samples/s | 49.6 steps/s
[Step=92050 Epoch=179.5] | Loss=0.02990 | Reg=0.00049 | acc=0.9688 | L2-Norm=7.011 | L2-Norm(final)=16.350 | 4067.5 samples/s | 63.6 steps/s
[Step=92100 Epoch=179.6] | Loss=0.02695 | Reg=0.00049 | acc=0.9844 | L2-Norm=7.019 | L2-Norm(final)=16.355 | 4361.3 samples/s | 68.1 steps/s
[Step=92150 Epoch=179.7] | Loss=0.02620 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.027 | L2-Norm(final)=16.359 | 4411.9 samples/s | 68.9 steps/s
[Step=92200 Epoch=179.8] | Loss=0.02506 | Reg=0.00049 | acc=0.9531 | L2-Norm=7.035 | L2-Norm(final)=16.364 | 4308.2 samples/s | 67.3 steps/s
[Step=92250 Epoch=179.9] | Loss=0.02465 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.042 | L2-Norm(final)=16.369 | 4304.8 samples/s | 67.3 steps/s
[Step=92300 Epoch=180.0] | Loss=0.02428 | Reg=0.00050 | acc=0.9844 | L2-Norm=7.049 | L2-Norm(final)=16.374 | 4338.9 samples/s | 67.8 steps/s
[Step=92350 Epoch=180.1] | Loss=0.02411 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.056 | L2-Norm(final)=16.379 | 4431.1 samples/s | 69.2 steps/s
[Step=92400 Epoch=180.2] | Loss=0.02378 | Reg=0.00050 | acc=0.9844 | L2-Norm=7.063 | L2-Norm(final)=16.383 | 4284.0 samples/s | 66.9 steps/s
[Step=92450 Epoch=180.3] | Loss=0.02350 | Reg=0.00050 | acc=0.9844 | L2-Norm=7.069 | L2-Norm(final)=16.388 | 4359.7 samples/s | 68.1 steps/s
[Step=92500 Epoch=180.4] | Loss=0.02329 | Reg=0.00050 | acc=0.9844 | L2-Norm=7.076 | L2-Norm(final)=16.392 | 5435.0 samples/s | 84.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=92501 Epoch=180.4] | Loss=0.04640 | Reg=0.00051 | acc=0.9688 | L2-Norm=7.138 | L2-Norm(final)=16.434 | 3065.9 samples/s | 47.9 steps/s
[Step=92550 Epoch=180.5] | Loss=0.02073 | Reg=0.00051 | acc=0.9531 | L2-Norm=7.148 | L2-Norm(final)=16.438 | 3807.8 samples/s | 59.5 steps/s
[Step=92600 Epoch=180.6] | Loss=0.02060 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.157 | L2-Norm(final)=16.442 | 3884.1 samples/s | 60.7 steps/s
[Step=92650 Epoch=180.7] | Loss=0.01961 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.166 | L2-Norm(final)=16.446 | 3912.0 samples/s | 61.1 steps/s
[Step=92700 Epoch=180.8] | Loss=0.01931 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.174 | L2-Norm(final)=16.450 | 3913.1 samples/s | 61.1 steps/s
[Step=92750 Epoch=180.9] | Loss=0.01895 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.182 | L2-Norm(final)=16.454 | 3931.7 samples/s | 61.4 steps/s
[Step=92800 Epoch=181.0] | Loss=0.01834 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.189 | L2-Norm(final)=16.457 | 3938.4 samples/s | 61.5 steps/s
[Step=92850 Epoch=181.1] | Loss=0.01803 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.197 | L2-Norm(final)=16.461 | 3884.0 samples/s | 60.7 steps/s
[Step=92900 Epoch=181.2] | Loss=0.01779 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.204 | L2-Norm(final)=16.465 | 3916.0 samples/s | 61.2 steps/s
[Step=92950 Epoch=181.3] | Loss=0.01764 | Reg=0.00052 | acc=0.9688 | L2-Norm=7.211 | L2-Norm(final)=16.469 | 3927.0 samples/s | 61.4 steps/s
[Step=93000 Epoch=181.4] | Loss=0.01745 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.218 | L2-Norm(final)=16.472 | 4766.7 samples/s | 74.5 steps/s
[Step=93050 Epoch=181.5] | Loss=0.01700 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.225 | L2-Norm(final)=16.476 | 1511.7 samples/s | 23.6 steps/s
[Step=93100 Epoch=181.6] | Loss=0.01645 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.231 | L2-Norm(final)=16.479 | 3881.3 samples/s | 60.6 steps/s
[Step=93150 Epoch=181.7] | Loss=0.01604 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.238 | L2-Norm(final)=16.483 | 3902.9 samples/s | 61.0 steps/s
[Step=93200 Epoch=181.8] | Loss=0.01562 | Reg=0.00052 | acc=0.9688 | L2-Norm=7.244 | L2-Norm(final)=16.486 | 3946.0 samples/s | 61.7 steps/s
[Step=93250 Epoch=181.9] | Loss=0.01538 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.251 | L2-Norm(final)=16.490 | 3871.1 samples/s | 60.5 steps/s
[Step=93300 Epoch=182.0] | Loss=0.01520 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.257 | L2-Norm(final)=16.493 | 3936.3 samples/s | 61.5 steps/s
[Step=93350 Epoch=182.1] | Loss=0.01487 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.263 | L2-Norm(final)=16.497 | 3949.2 samples/s | 61.7 steps/s
[Step=93400 Epoch=182.2] | Loss=0.01469 | Reg=0.00053 | acc=0.9688 | L2-Norm=7.268 | L2-Norm(final)=16.500 | 3951.0 samples/s | 61.7 steps/s
[Step=93450 Epoch=182.3] | Loss=0.01449 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.274 | L2-Norm(final)=16.503 | 3925.6 samples/s | 61.3 steps/s
[Step=93500 Epoch=182.4] | Loss=0.01438 | Reg=0.00053 | acc=0.9688 | L2-Norm=7.280 | L2-Norm(final)=16.507 | 4187.7 samples/s | 65.4 steps/s
[Step=93550 Epoch=182.5] | Loss=0.01414 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.285 | L2-Norm(final)=16.510 | 1520.2 samples/s | 23.8 steps/s
[Step=93600 Epoch=182.6] | Loss=0.01390 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.291 | L2-Norm(final)=16.513 | 3961.4 samples/s | 61.9 steps/s
[Step=93650 Epoch=182.7] | Loss=0.01371 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.296 | L2-Norm(final)=16.516 | 3928.1 samples/s | 61.4 steps/s
[Step=93700 Epoch=182.8] | Loss=0.01351 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.302 | L2-Norm(final)=16.519 | 3914.3 samples/s | 61.2 steps/s
[Step=93750 Epoch=182.8] | Loss=0.01333 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.307 | L2-Norm(final)=16.522 | 3931.5 samples/s | 61.4 steps/s
[Step=93800 Epoch=182.9] | Loss=0.01322 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.312 | L2-Norm(final)=16.525 | 3954.1 samples/s | 61.8 steps/s
[Step=93850 Epoch=183.0] | Loss=0.01310 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.317 | L2-Norm(final)=16.528 | 3957.5 samples/s | 61.8 steps/s
[Step=93900 Epoch=183.1] | Loss=0.01299 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.322 | L2-Norm(final)=16.531 | 3947.2 samples/s | 61.7 steps/s
[Step=93950 Epoch=183.2] | Loss=0.01284 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.327 | L2-Norm(final)=16.534 | 3969.3 samples/s | 62.0 steps/s
[Step=94000 Epoch=183.3] | Loss=0.01269 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.332 | L2-Norm(final)=16.537 | 3915.8 samples/s | 61.2 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step94000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=92001 Epoch=179.9] | Loss=0.07504 | Reg=0.00049 | acc=0.9375 | L2-Norm=7.003 | L2-Norm(final)=16.652 | 3361.5 samples/s | 52.5 steps/s
[Step=92050 Epoch=180.0] | Loss=0.02836 | Reg=0.00049 | acc=0.9531 | L2-Norm=7.011 | L2-Norm(final)=16.656 | 4083.2 samples/s | 63.8 steps/s
[Step=92100 Epoch=180.1] | Loss=0.02571 | Reg=0.00049 | acc=0.9844 | L2-Norm=7.020 | L2-Norm(final)=16.661 | 4307.8 samples/s | 67.3 steps/s
[Step=92150 Epoch=180.2] | Loss=0.02579 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.028 | L2-Norm(final)=16.667 | 4340.9 samples/s | 67.8 steps/s
[Step=92200 Epoch=180.2] | Loss=0.02458 | Reg=0.00049 | acc=0.9844 | L2-Norm=7.035 | L2-Norm(final)=16.672 | 4381.0 samples/s | 68.5 steps/s
[Step=92250 Epoch=180.3] | Loss=0.02377 | Reg=0.00050 | acc=0.9688 | L2-Norm=7.042 | L2-Norm(final)=16.677 | 4398.1 samples/s | 68.7 steps/s
[Step=92300 Epoch=180.4] | Loss=0.02356 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.049 | L2-Norm(final)=16.683 | 4419.9 samples/s | 69.1 steps/s
[Step=92350 Epoch=180.5] | Loss=0.02367 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.056 | L2-Norm(final)=16.688 | 4378.5 samples/s | 68.4 steps/s
[Step=92400 Epoch=180.6] | Loss=0.02342 | Reg=0.00050 | acc=0.9688 | L2-Norm=7.062 | L2-Norm(final)=16.693 | 4408.8 samples/s | 68.9 steps/s
[Step=92450 Epoch=180.7] | Loss=0.02284 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.069 | L2-Norm(final)=16.698 | 4361.8 samples/s | 68.2 steps/s
[Step=92500 Epoch=180.8] | Loss=0.02269 | Reg=0.00050 | acc=0.9844 | L2-Norm=7.075 | L2-Norm(final)=16.702 | 5663.5 samples/s | 88.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=92501 Epoch=180.8] | Loss=0.06382 | Reg=0.00051 | acc=0.9688 | L2-Norm=7.138 | L2-Norm(final)=16.748 | 3120.0 samples/s | 48.8 steps/s
[Step=92550 Epoch=180.9] | Loss=0.01975 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.147 | L2-Norm(final)=16.752 | 3987.1 samples/s | 62.3 steps/s
[Step=92600 Epoch=181.0] | Loss=0.02098 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.156 | L2-Norm(final)=16.757 | 3921.0 samples/s | 61.3 steps/s
[Step=92650 Epoch=181.1] | Loss=0.02123 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.165 | L2-Norm(final)=16.761 | 3945.4 samples/s | 61.6 steps/s
[Step=92700 Epoch=181.2] | Loss=0.02031 | Reg=0.00051 | acc=0.9688 | L2-Norm=7.174 | L2-Norm(final)=16.765 | 3948.7 samples/s | 61.7 steps/s
[Step=92750 Epoch=181.3] | Loss=0.01908 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.183 | L2-Norm(final)=16.769 | 3929.9 samples/s | 61.4 steps/s
[Step=92800 Epoch=181.4] | Loss=0.01847 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.191 | L2-Norm(final)=16.773 | 3939.4 samples/s | 61.6 steps/s
[Step=92850 Epoch=181.5] | Loss=0.01827 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.198 | L2-Norm(final)=16.778 | 3903.1 samples/s | 61.0 steps/s
[Step=92900 Epoch=181.6] | Loss=0.01787 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.206 | L2-Norm(final)=16.782 | 3943.4 samples/s | 61.6 steps/s
[Step=92950 Epoch=181.7] | Loss=0.01734 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.213 | L2-Norm(final)=16.786 | 3925.8 samples/s | 61.3 steps/s
[Step=93000 Epoch=181.8] | Loss=0.01706 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.220 | L2-Norm(final)=16.790 | 4926.2 samples/s | 77.0 steps/s
[Step=93050 Epoch=181.9] | Loss=0.01673 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.227 | L2-Norm(final)=16.793 | 1502.1 samples/s | 23.5 steps/s
[Step=93100 Epoch=182.0] | Loss=0.01622 | Reg=0.00052 | acc=0.9688 | L2-Norm=7.234 | L2-Norm(final)=16.797 | 3914.7 samples/s | 61.2 steps/s
[Step=93150 Epoch=182.1] | Loss=0.01579 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.240 | L2-Norm(final)=16.801 | 3902.6 samples/s | 61.0 steps/s
[Step=93200 Epoch=182.2] | Loss=0.01569 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.246 | L2-Norm(final)=16.805 | 3925.9 samples/s | 61.3 steps/s
[Step=93250 Epoch=182.3] | Loss=0.01534 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.253 | L2-Norm(final)=16.808 | 3925.7 samples/s | 61.3 steps/s
[Step=93300 Epoch=182.4] | Loss=0.01509 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.259 | L2-Norm(final)=16.812 | 3974.4 samples/s | 62.1 steps/s
[Step=93350 Epoch=182.5] | Loss=0.01479 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.265 | L2-Norm(final)=16.815 | 3917.1 samples/s | 61.2 steps/s
[Step=93400 Epoch=182.6] | Loss=0.01454 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.271 | L2-Norm(final)=16.819 | 3916.7 samples/s | 61.2 steps/s
[Step=93450 Epoch=182.7] | Loss=0.01435 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.276 | L2-Norm(final)=16.822 | 3940.5 samples/s | 61.6 steps/s
[Step=93500 Epoch=182.8] | Loss=0.01418 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.282 | L2-Norm(final)=16.826 | 4235.1 samples/s | 66.2 steps/s
[Step=93550 Epoch=182.9] | Loss=0.01394 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.287 | L2-Norm(final)=16.829 | 1541.7 samples/s | 24.1 steps/s
[Step=93600 Epoch=183.0] | Loss=0.01370 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.293 | L2-Norm(final)=16.832 | 3898.9 samples/s | 60.9 steps/s
[Step=93650 Epoch=183.1] | Loss=0.01345 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.298 | L2-Norm(final)=16.836 | 3850.1 samples/s | 60.2 steps/s
[Step=93700 Epoch=183.2] | Loss=0.01321 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.304 | L2-Norm(final)=16.839 | 3877.7 samples/s | 60.6 steps/s
[Step=93750 Epoch=183.3] | Loss=0.01307 | Reg=0.00053 | acc=0.9844 | L2-Norm=7.309 | L2-Norm(final)=16.842 | 3930.2 samples/s | 61.4 steps/s
[Step=93800 Epoch=183.4] | Loss=0.01290 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.314 | L2-Norm(final)=16.845 | 3933.8 samples/s | 61.5 steps/s
[Step=93850 Epoch=183.5] | Loss=0.01266 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.319 | L2-Norm(final)=16.849 | 3888.9 samples/s | 60.8 steps/s
[Step=93900 Epoch=183.6] | Loss=0.01258 | Reg=0.00054 | acc=0.9844 | L2-Norm=7.325 | L2-Norm(final)=16.852 | 3938.6 samples/s | 61.5 steps/s
[Step=93950 Epoch=183.7] | Loss=0.01250 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.330 | L2-Norm(final)=16.855 | 3933.7 samples/s | 61.5 steps/s
[Step=94000 Epoch=183.8] | Loss=0.01241 | Reg=0.00054 | acc=1.0000 | L2-Norm=7.335 | L2-Norm(final)=16.858 | 3898.9 samples/s | 60.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step94000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=92001 Epoch=352.5] | Loss=0.00001 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.003 | L2-Norm(final)=11.746 | 3291.0 samples/s | 51.4 steps/s
[Step=92050 Epoch=352.7] | Loss=0.00008 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.003 | L2-Norm(final)=11.757 | 3660.5 samples/s | 57.2 steps/s
[Step=92100 Epoch=352.9] | Loss=0.00006 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.005 | L2-Norm(final)=11.768 | 4052.0 samples/s | 63.3 steps/s
[Step=92150 Epoch=353.1] | Loss=0.00005 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.004 | L2-Norm(final)=11.776 | 4112.0 samples/s | 64.2 steps/s
[Step=92200 Epoch=353.3] | Loss=0.00004 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.003 | L2-Norm(final)=11.782 | 4016.8 samples/s | 62.8 steps/s
[Step=92250 Epoch=353.5] | Loss=0.00003 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.000 | L2-Norm(final)=11.787 | 5463.2 samples/s | 85.4 steps/s
[Step=92300 Epoch=353.7] | Loss=0.00003 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.998 | L2-Norm(final)=11.791 | 1500.4 samples/s | 23.4 steps/s
[Step=92350 Epoch=353.9] | Loss=0.00003 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.995 | L2-Norm(final)=11.796 | 4190.4 samples/s | 65.5 steps/s
[Step=92400 Epoch=354.0] | Loss=0.00003 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.993 | L2-Norm(final)=11.801 | 4019.0 samples/s | 62.8 steps/s
[Step=92450 Epoch=354.2] | Loss=0.00002 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.990 | L2-Norm(final)=11.805 | 4103.9 samples/s | 64.1 steps/s
[Step=92500 Epoch=354.4] | Loss=0.00002 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.987 | L2-Norm(final)=11.809 | 4663.1 samples/s | 72.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=92501 Epoch=354.4] | Loss=0.00001 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.959 | L2-Norm(final)=11.848 | 3234.2 samples/s | 50.5 steps/s
[Step=92550 Epoch=354.6] | Loss=0.00001 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.951 | L2-Norm(final)=11.851 | 3500.7 samples/s | 54.7 steps/s
[Step=92600 Epoch=354.8] | Loss=0.00001 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.941 | L2-Norm(final)=11.854 | 3752.0 samples/s | 58.6 steps/s
[Step=92650 Epoch=355.0] | Loss=0.00001 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.930 | L2-Norm(final)=11.857 | 3708.1 samples/s | 57.9 steps/s
[Step=92700 Epoch=355.2] | Loss=0.00001 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.919 | L2-Norm(final)=11.859 | 3725.9 samples/s | 58.2 steps/s
[Step=92750 Epoch=355.4] | Loss=0.00001 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.908 | L2-Norm(final)=11.862 | 4665.6 samples/s | 72.9 steps/s
[Step=92800 Epoch=355.6] | Loss=0.00001 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.896 | L2-Norm(final)=11.864 | 1477.2 samples/s | 23.1 steps/s
[Step=92850 Epoch=355.8] | Loss=0.00001 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.884 | L2-Norm(final)=11.865 | 3712.7 samples/s | 58.0 steps/s
[Step=92900 Epoch=356.0] | Loss=0.00001 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.872 | L2-Norm(final)=11.867 | 3686.5 samples/s | 57.6 steps/s
[Step=92950 Epoch=356.2] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.859 | L2-Norm(final)=11.869 | 3743.1 samples/s | 58.5 steps/s
[Step=93000 Epoch=356.3] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.847 | L2-Norm(final)=11.870 | 4083.6 samples/s | 63.8 steps/s
[Step=93050 Epoch=356.5] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.834 | L2-Norm(final)=11.872 | 1523.4 samples/s | 23.8 steps/s
[Step=93100 Epoch=356.7] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.821 | L2-Norm(final)=11.873 | 3704.0 samples/s | 57.9 steps/s
[Step=93150 Epoch=356.9] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.808 | L2-Norm(final)=11.875 | 3737.1 samples/s | 58.4 steps/s
[Step=93200 Epoch=357.1] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.795 | L2-Norm(final)=11.876 | 3709.5 samples/s | 58.0 steps/s
[Step=93250 Epoch=357.3] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.782 | L2-Norm(final)=11.878 | 3665.3 samples/s | 57.3 steps/s
[Step=93300 Epoch=357.5] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.769 | L2-Norm(final)=11.879 | 1588.6 samples/s | 24.8 steps/s
[Step=93350 Epoch=357.7] | Loss=0.00000 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.755 | L2-Norm(final)=11.881 | 3722.8 samples/s | 58.2 steps/s
[Step=93400 Epoch=357.9] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.742 | L2-Norm(final)=11.882 | 3694.9 samples/s | 57.7 steps/s
[Step=93450 Epoch=358.1] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.729 | L2-Norm(final)=11.884 | 3715.5 samples/s | 58.1 steps/s
[Step=93500 Epoch=358.3] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.715 | L2-Norm(final)=11.886 | 3754.2 samples/s | 58.7 steps/s
[Step=93550 Epoch=358.5] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.701 | L2-Norm(final)=11.887 | 1555.0 samples/s | 24.3 steps/s
[Step=93600 Epoch=358.6] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.688 | L2-Norm(final)=11.889 | 3803.2 samples/s | 59.4 steps/s
[Step=93650 Epoch=358.8] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.674 | L2-Norm(final)=11.891 | 3743.1 samples/s | 58.5 steps/s
[Step=93700 Epoch=359.0] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.660 | L2-Norm(final)=11.892 | 3716.7 samples/s | 58.1 steps/s
[Step=93750 Epoch=359.2] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.646 | L2-Norm(final)=11.894 | 3727.8 samples/s | 58.2 steps/s
[Step=93800 Epoch=359.4] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.633 | L2-Norm(final)=11.896 | 5073.2 samples/s | 79.3 steps/s
[Step=93850 Epoch=359.6] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.619 | L2-Norm(final)=11.898 | 1429.6 samples/s | 22.3 steps/s
[Step=93900 Epoch=359.8] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.605 | L2-Norm(final)=11.900 | 3741.2 samples/s | 58.5 steps/s
[Step=93950 Epoch=360.0] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.591 | L2-Norm(final)=11.902 | 3644.8 samples/s | 57.0 steps/s
[Step=94000 Epoch=360.2] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.577 | L2-Norm(final)=11.904 | 3792.2 samples/s | 59.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step94000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=92001 Epoch=354.1] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.003 | L2-Norm(final)=11.636 | 3280.8 samples/s | 51.3 steps/s
[Step=92050 Epoch=354.3] | Loss=0.00008 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.002 | L2-Norm(final)=11.647 | 3851.1 samples/s | 60.2 steps/s
[Step=92100 Epoch=354.5] | Loss=0.00007 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.005 | L2-Norm(final)=11.659 | 4183.2 samples/s | 65.4 steps/s
[Step=92150 Epoch=354.7] | Loss=0.00007 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.008 | L2-Norm(final)=11.668 | 4093.9 samples/s | 64.0 steps/s
[Step=92200 Epoch=354.9] | Loss=0.00006 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.009 | L2-Norm(final)=11.675 | 4210.9 samples/s | 65.8 steps/s
[Step=92250 Epoch=355.1] | Loss=0.00006 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.010 | L2-Norm(final)=11.682 | 5490.3 samples/s | 85.8 steps/s
[Step=92300 Epoch=355.3] | Loss=0.00005 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.010 | L2-Norm(final)=11.687 | 1516.5 samples/s | 23.7 steps/s
[Step=92350 Epoch=355.5] | Loss=0.00005 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.009 | L2-Norm(final)=11.692 | 4204.8 samples/s | 65.7 steps/s
[Step=92400 Epoch=355.7] | Loss=0.00004 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.009 | L2-Norm(final)=11.697 | 4131.5 samples/s | 64.6 steps/s
[Step=92450 Epoch=355.9] | Loss=0.00004 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.008 | L2-Norm(final)=11.701 | 4183.3 samples/s | 65.4 steps/s
[Step=92500 Epoch=356.1] | Loss=0.00004 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.007 | L2-Norm(final)=11.705 | 4682.0 samples/s | 73.2 steps/s
All layers training...
LR=0.00006, len=1
[Step=92501 Epoch=356.1] | Loss=0.00000 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.995 | L2-Norm(final)=11.744 | 3142.5 samples/s | 49.1 steps/s
[Step=92550 Epoch=356.3] | Loss=0.00004 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.991 | L2-Norm(final)=11.748 | 3582.0 samples/s | 56.0 steps/s
[Step=92600 Epoch=356.5] | Loss=0.00003 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.992 | L2-Norm(final)=11.753 | 3700.7 samples/s | 57.8 steps/s
[Step=92650 Epoch=356.6] | Loss=0.00002 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.988 | L2-Norm(final)=11.756 | 3758.7 samples/s | 58.7 steps/s
[Step=92700 Epoch=356.8] | Loss=0.00002 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.982 | L2-Norm(final)=11.759 | 3758.9 samples/s | 58.7 steps/s
[Step=92750 Epoch=357.0] | Loss=0.00004 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.976 | L2-Norm(final)=11.761 | 4736.2 samples/s | 74.0 steps/s
[Step=92800 Epoch=357.2] | Loss=0.00005 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.973 | L2-Norm(final)=11.764 | 1486.8 samples/s | 23.2 steps/s
[Step=92850 Epoch=357.4] | Loss=0.00005 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.971 | L2-Norm(final)=11.766 | 3713.9 samples/s | 58.0 steps/s
[Step=92900 Epoch=357.6] | Loss=0.00004 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.969 | L2-Norm(final)=11.769 | 3783.1 samples/s | 59.1 steps/s
[Step=92950 Epoch=357.8] | Loss=0.00004 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.967 | L2-Norm(final)=11.770 | 3739.9 samples/s | 58.4 steps/s
[Step=93000 Epoch=358.0] | Loss=0.00004 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.966 | L2-Norm(final)=11.772 | 4232.2 samples/s | 66.1 steps/s
[Step=93050 Epoch=358.2] | Loss=0.00003 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.964 | L2-Norm(final)=11.774 | 1528.3 samples/s | 23.9 steps/s
[Step=93100 Epoch=358.4] | Loss=0.00003 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.962 | L2-Norm(final)=11.775 | 3741.4 samples/s | 58.5 steps/s
[Step=93150 Epoch=358.6] | Loss=0.00003 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.960 | L2-Norm(final)=11.777 | 3683.8 samples/s | 57.6 steps/s
[Step=93200 Epoch=358.8] | Loss=0.00003 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.958 | L2-Norm(final)=11.778 | 3763.3 samples/s | 58.8 steps/s
[Step=93250 Epoch=359.0] | Loss=0.00003 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.956 | L2-Norm(final)=11.779 | 3798.9 samples/s | 59.4 steps/s
[Step=93300 Epoch=359.1] | Loss=0.00002 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.953 | L2-Norm(final)=11.780 | 1564.4 samples/s | 24.4 steps/s
[Step=93350 Epoch=359.3] | Loss=0.00002 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.951 | L2-Norm(final)=11.781 | 3816.5 samples/s | 59.6 steps/s
[Step=93400 Epoch=359.5] | Loss=0.00002 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.949 | L2-Norm(final)=11.782 | 3750.2 samples/s | 58.6 steps/s
[Step=93450 Epoch=359.7] | Loss=0.00002 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.946 | L2-Norm(final)=11.782 | 3755.1 samples/s | 58.7 steps/s
[Step=93500 Epoch=359.9] | Loss=0.00002 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.944 | L2-Norm(final)=11.783 | 3706.4 samples/s | 57.9 steps/s
[Step=93550 Epoch=360.1] | Loss=0.00002 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.941 | L2-Norm(final)=11.784 | 1594.0 samples/s | 24.9 steps/s
[Step=93600 Epoch=360.3] | Loss=0.00002 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.938 | L2-Norm(final)=11.785 | 3701.2 samples/s | 57.8 steps/s
[Step=93650 Epoch=360.5] | Loss=0.00002 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.936 | L2-Norm(final)=11.786 | 3718.9 samples/s | 58.1 steps/s
[Step=93700 Epoch=360.7] | Loss=0.00002 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.933 | L2-Norm(final)=11.786 | 3731.5 samples/s | 58.3 steps/s
[Step=93750 Epoch=360.9] | Loss=0.00002 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.930 | L2-Norm(final)=11.787 | 3681.0 samples/s | 57.5 steps/s
[Step=93800 Epoch=361.1] | Loss=0.00002 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.927 | L2-Norm(final)=11.788 | 5534.0 samples/s | 86.5 steps/s
[Step=93850 Epoch=361.3] | Loss=0.00002 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.925 | L2-Norm(final)=11.788 | 1396.8 samples/s | 21.8 steps/s
[Step=93900 Epoch=361.5] | Loss=0.00002 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.922 | L2-Norm(final)=11.789 | 3732.2 samples/s | 58.3 steps/s
[Step=93950 Epoch=361.7] | Loss=0.00001 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.919 | L2-Norm(final)=11.789 | 3668.1 samples/s | 57.3 steps/s
[Step=94000 Epoch=361.8] | Loss=0.00001 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.916 | L2-Norm(final)=11.790 | 3691.6 samples/s | 57.7 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step94000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05304 | acc=0.9688 | tpr=0.9772 | fpr=0.0493 | 3551.0 samples/s | 13.9 steps/s
Avg test loss: 0.05693, Avg test acc: 0.96626, Avg tpr: 0.97523, Avg fpr: 0.05345, total FA: 417

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05284 | acc=0.9682 | tpr=0.9714 | fpr=0.0387 | 3524.9 samples/s | 13.8 steps/s
Avg test loss: 0.05648, Avg test acc: 0.96618, Avg tpr: 0.97068, Avg fpr: 0.04371, total FA: 341

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.36621 | acc=0.3106 | tpr=0.0114 | fpr=0.0396 | 3514.9 samples/s | 13.7 steps/s
Avg test loss: 5.38524, Avg test acc: 0.30748, Avg tpr: 0.01119, Avg fpr: 0.04089, total FA: 319

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.04727 | acc=0.3150 | tpr=0.0146 | fpr=0.0327 | 3525.2 samples/s | 13.8 steps/s
Avg test loss: 5.06100, Avg test acc: 0.31277, Avg tpr: 0.01515, Avg fpr: 0.03269, total FA: 255

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.94995 | acc=0.1071 | tpr=0.8938 | fpr=0.9070 | 3499.9 samples/s | 13.7 steps/s
[Step= 100] | Loss=4.92739 | acc=0.1084 | tpr=0.9147 | fpr=0.9067 | 6885.8 samples/s | 26.9 steps/s
[Step= 150] | Loss=4.93617 | acc=0.1073 | tpr=0.9222 | fpr=0.9077 | 6753.5 samples/s | 26.4 steps/s
[Step= 200] | Loss=4.92221 | acc=0.1071 | tpr=0.9093 | fpr=0.9075 | 6794.6 samples/s | 26.5 steps/s
[Step= 250] | Loss=4.92884 | acc=0.1071 | tpr=0.8996 | fpr=0.9073 | 6943.7 samples/s | 27.1 steps/s
[Step= 300] | Loss=4.92855 | acc=0.1066 | tpr=0.8975 | fpr=0.9079 | 6940.7 samples/s | 27.1 steps/s
[Step= 350] | Loss=4.92515 | acc=0.1070 | tpr=0.8992 | fpr=0.9074 | 6644.1 samples/s | 26.0 steps/s
[Step= 400] | Loss=4.92297 | acc=0.1067 | tpr=0.8933 | fpr=0.9076 | 6824.5 samples/s | 26.7 steps/s
[Step= 450] | Loss=4.92883 | acc=0.1063 | tpr=0.8929 | fpr=0.9080 | 6846.8 samples/s | 26.7 steps/s
[Step= 500] | Loss=4.92989 | acc=0.1064 | tpr=0.8943 | fpr=0.9079 | 6622.1 samples/s | 25.9 steps/s
[Step= 550] | Loss=4.92934 | acc=0.1064 | tpr=0.8938 | fpr=0.9079 | 12432.1 samples/s | 48.6 steps/s
Avg test loss: 4.92987, Avg test acc: 0.10639, Avg tpr: 0.89342, Avg fpr: 0.90792, total FA: 126063

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.61252 | acc=0.1247 | tpr=0.8805 | fpr=0.8889 | 3467.4 samples/s | 13.5 steps/s
[Step= 100] | Loss=4.59177 | acc=0.1249 | tpr=0.9041 | fpr=0.8896 | 6948.4 samples/s | 27.1 steps/s
[Step= 150] | Loss=4.60408 | acc=0.1239 | tpr=0.9092 | fpr=0.8905 | 6896.1 samples/s | 26.9 steps/s
[Step= 200] | Loss=4.59242 | acc=0.1240 | tpr=0.8995 | fpr=0.8901 | 6830.5 samples/s | 26.7 steps/s
[Step= 250] | Loss=4.59930 | acc=0.1236 | tpr=0.8847 | fpr=0.8902 | 6897.6 samples/s | 26.9 steps/s
[Step= 300] | Loss=4.60062 | acc=0.1229 | tpr=0.8793 | fpr=0.8909 | 6725.3 samples/s | 26.3 steps/s
[Step= 350] | Loss=4.59879 | acc=0.1234 | tpr=0.8829 | fpr=0.8903 | 6856.1 samples/s | 26.8 steps/s
[Step= 400] | Loss=4.59652 | acc=0.1233 | tpr=0.8764 | fpr=0.8904 | 7170.9 samples/s | 28.0 steps/s
[Step= 450] | Loss=4.60360 | acc=0.1229 | tpr=0.8773 | fpr=0.8908 | 6428.1 samples/s | 25.1 steps/s
[Step= 500] | Loss=4.60457 | acc=0.1228 | tpr=0.8806 | fpr=0.8909 | 6876.6 samples/s | 26.9 steps/s
[Step= 550] | Loss=4.60386 | acc=0.1229 | tpr=0.8810 | fpr=0.8909 | 12455.1 samples/s | 48.7 steps/s
Avg test loss: 4.60435, Avg test acc: 0.12285, Avg tpr: 0.88074, Avg fpr: 0.89093, total FA: 123704

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08829 | acc=0.9830 | tpr=0.9469 | fpr=0.0163 | 3574.8 samples/s | 14.0 steps/s
[Step= 100] | Loss=0.09247 | acc=0.9828 | tpr=0.9595 | fpr=0.0168 | 6659.3 samples/s | 26.0 steps/s
[Step= 150] | Loss=0.09541 | acc=0.9818 | tpr=0.9597 | fpr=0.0178 | 7109.8 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.09663 | acc=0.9818 | tpr=0.9585 | fpr=0.0178 | 6721.8 samples/s | 26.3 steps/s
[Step= 250] | Loss=0.09593 | acc=0.9821 | tpr=0.9555 | fpr=0.0174 | 6941.6 samples/s | 27.1 steps/s
[Step= 300] | Loss=0.09739 | acc=0.9818 | tpr=0.9542 | fpr=0.0177 | 6986.4 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.09754 | acc=0.9818 | tpr=0.9543 | fpr=0.0177 | 6935.4 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.09884 | acc=0.9815 | tpr=0.9502 | fpr=0.0179 | 6737.1 samples/s | 26.3 steps/s
[Step= 450] | Loss=0.10089 | acc=0.9811 | tpr=0.9489 | fpr=0.0183 | 6691.4 samples/s | 26.1 steps/s
[Step= 500] | Loss=0.10047 | acc=0.9812 | tpr=0.9520 | fpr=0.0182 | 6813.9 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.09973 | acc=0.9813 | tpr=0.9507 | fpr=0.0181 | 12386.0 samples/s | 48.4 steps/s
Avg test loss: 0.09960, Avg test acc: 0.98132, Avg tpr: 0.95008, Avg fpr: 0.01811, total FA: 2515

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10107 | acc=0.9823 | tpr=0.9558 | fpr=0.0172 | 3498.4 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.10539 | acc=0.9819 | tpr=0.9659 | fpr=0.0178 | 6717.4 samples/s | 26.2 steps/s
[Step= 150] | Loss=0.10888 | acc=0.9808 | tpr=0.9683 | fpr=0.0190 | 6774.7 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.11076 | acc=0.9805 | tpr=0.9683 | fpr=0.0193 | 6880.1 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.10977 | acc=0.9807 | tpr=0.9651 | fpr=0.0190 | 6913.9 samples/s | 27.0 steps/s
[Step= 300] | Loss=0.11166 | acc=0.9804 | tpr=0.9644 | fpr=0.0193 | 6731.8 samples/s | 26.3 steps/s
[Step= 350] | Loss=0.11166 | acc=0.9803 | tpr=0.9643 | fpr=0.0195 | 6628.7 samples/s | 25.9 steps/s
[Step= 400] | Loss=0.11300 | acc=0.9800 | tpr=0.9617 | fpr=0.0197 | 6801.4 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.11522 | acc=0.9795 | tpr=0.9601 | fpr=0.0201 | 6705.8 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.11480 | acc=0.9796 | tpr=0.9617 | fpr=0.0201 | 6788.7 samples/s | 26.5 steps/s
[Step= 550] | Loss=0.11390 | acc=0.9798 | tpr=0.9606 | fpr=0.0199 | 12474.8 samples/s | 48.7 steps/s
Avg test loss: 0.11383, Avg test acc: 0.97980, Avg tpr: 0.95998, Avg fpr: 0.01984, total FA: 2755

server round 47/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=94001 Epoch=183.3] | Loss=0.02716 | Reg=0.00048 | acc=0.9844 | L2-Norm=6.902 | L2-Norm(final)=16.626 | 3129.7 samples/s | 48.9 steps/s
[Step=94050 Epoch=183.4] | Loss=0.02257 | Reg=0.00048 | acc=0.9844 | L2-Norm=6.910 | L2-Norm(final)=16.630 | 4006.2 samples/s | 62.6 steps/s
[Step=94100 Epoch=183.5] | Loss=0.02106 | Reg=0.00048 | acc=0.9844 | L2-Norm=6.918 | L2-Norm(final)=16.636 | 4430.4 samples/s | 69.2 steps/s
[Step=94150 Epoch=183.6] | Loss=0.02182 | Reg=0.00048 | acc=0.9844 | L2-Norm=6.926 | L2-Norm(final)=16.641 | 4357.3 samples/s | 68.1 steps/s
[Step=94200 Epoch=183.7] | Loss=0.02182 | Reg=0.00048 | acc=0.9844 | L2-Norm=6.933 | L2-Norm(final)=16.646 | 4315.2 samples/s | 67.4 steps/s
[Step=94250 Epoch=183.8] | Loss=0.02280 | Reg=0.00048 | acc=0.9531 | L2-Norm=6.941 | L2-Norm(final)=16.651 | 4331.1 samples/s | 67.7 steps/s
[Step=94300 Epoch=183.9] | Loss=0.02264 | Reg=0.00048 | acc=0.9688 | L2-Norm=6.948 | L2-Norm(final)=16.656 | 4323.5 samples/s | 67.6 steps/s
[Step=94350 Epoch=184.0] | Loss=0.02220 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.956 | L2-Norm(final)=16.661 | 4435.3 samples/s | 69.3 steps/s
[Step=94400 Epoch=184.1] | Loss=0.02197 | Reg=0.00048 | acc=0.9844 | L2-Norm=6.963 | L2-Norm(final)=16.665 | 4380.6 samples/s | 68.4 steps/s
[Step=94450 Epoch=184.2] | Loss=0.02168 | Reg=0.00049 | acc=0.9844 | L2-Norm=6.970 | L2-Norm(final)=16.670 | 4272.6 samples/s | 66.8 steps/s
[Step=94500 Epoch=184.3] | Loss=0.02179 | Reg=0.00049 | acc=0.9844 | L2-Norm=6.977 | L2-Norm(final)=16.675 | 5405.2 samples/s | 84.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=94501 Epoch=184.3] | Loss=0.01634 | Reg=0.00050 | acc=0.9844 | L2-Norm=7.046 | L2-Norm(final)=16.721 | 3094.9 samples/s | 48.4 steps/s
[Step=94550 Epoch=184.4] | Loss=0.02086 | Reg=0.00050 | acc=0.9688 | L2-Norm=7.054 | L2-Norm(final)=16.725 | 3787.8 samples/s | 59.2 steps/s
[Step=94600 Epoch=184.5] | Loss=0.01952 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.063 | L2-Norm(final)=16.728 | 3909.9 samples/s | 61.1 steps/s
[Step=94650 Epoch=184.6] | Loss=0.02049 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.072 | L2-Norm(final)=16.732 | 3930.1 samples/s | 61.4 steps/s
[Step=94700 Epoch=184.7] | Loss=0.01964 | Reg=0.00050 | acc=0.9844 | L2-Norm=7.081 | L2-Norm(final)=16.736 | 3904.0 samples/s | 61.0 steps/s
[Step=94750 Epoch=184.8] | Loss=0.01925 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.089 | L2-Norm(final)=16.739 | 3908.2 samples/s | 61.1 steps/s
[Step=94800 Epoch=184.9] | Loss=0.01893 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.097 | L2-Norm(final)=16.743 | 3890.2 samples/s | 60.8 steps/s
[Step=94850 Epoch=185.0] | Loss=0.01832 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.105 | L2-Norm(final)=16.747 | 3876.9 samples/s | 60.6 steps/s
[Step=94900 Epoch=185.1] | Loss=0.01782 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.112 | L2-Norm(final)=16.751 | 3881.7 samples/s | 60.7 steps/s
[Step=94950 Epoch=185.2] | Loss=0.01753 | Reg=0.00051 | acc=0.9375 | L2-Norm=7.120 | L2-Norm(final)=16.755 | 3926.9 samples/s | 61.4 steps/s
[Step=95000 Epoch=185.3] | Loss=0.01723 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.127 | L2-Norm(final)=16.759 | 4830.5 samples/s | 75.5 steps/s
[Step=95050 Epoch=185.4] | Loss=0.01667 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.134 | L2-Norm(final)=16.762 | 1516.1 samples/s | 23.7 steps/s
[Step=95100 Epoch=185.5] | Loss=0.01612 | Reg=0.00051 | acc=0.9688 | L2-Norm=7.141 | L2-Norm(final)=16.766 | 3929.0 samples/s | 61.4 steps/s
[Step=95150 Epoch=185.6] | Loss=0.01566 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.148 | L2-Norm(final)=16.769 | 3927.2 samples/s | 61.4 steps/s
[Step=95200 Epoch=185.7] | Loss=0.01523 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.154 | L2-Norm(final)=16.773 | 3927.2 samples/s | 61.4 steps/s
[Step=95250 Epoch=185.8] | Loss=0.01506 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.161 | L2-Norm(final)=16.776 | 3874.4 samples/s | 60.5 steps/s
[Step=95300 Epoch=185.9] | Loss=0.01489 | Reg=0.00051 | acc=0.9688 | L2-Norm=7.167 | L2-Norm(final)=16.780 | 3906.0 samples/s | 61.0 steps/s
[Step=95350 Epoch=186.0] | Loss=0.01471 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.173 | L2-Norm(final)=16.783 | 3888.3 samples/s | 60.8 steps/s
[Step=95400 Epoch=186.1] | Loss=0.01462 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.179 | L2-Norm(final)=16.786 | 3977.3 samples/s | 62.1 steps/s
[Step=95450 Epoch=186.2] | Loss=0.01447 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.185 | L2-Norm(final)=16.790 | 3972.3 samples/s | 62.1 steps/s
[Step=95500 Epoch=186.3] | Loss=0.01427 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.191 | L2-Norm(final)=16.793 | 4151.1 samples/s | 64.9 steps/s
[Step=95550 Epoch=186.4] | Loss=0.01398 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.197 | L2-Norm(final)=16.796 | 1507.8 samples/s | 23.6 steps/s
[Step=95600 Epoch=186.5] | Loss=0.01380 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.202 | L2-Norm(final)=16.800 | 3950.5 samples/s | 61.7 steps/s
[Step=95650 Epoch=186.6] | Loss=0.01348 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.208 | L2-Norm(final)=16.803 | 3883.3 samples/s | 60.7 steps/s
[Step=95700 Epoch=186.7] | Loss=0.01343 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.214 | L2-Norm(final)=16.806 | 3915.9 samples/s | 61.2 steps/s
[Step=95750 Epoch=186.7] | Loss=0.01322 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.219 | L2-Norm(final)=16.809 | 3934.7 samples/s | 61.5 steps/s
[Step=95800 Epoch=186.8] | Loss=0.01309 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.224 | L2-Norm(final)=16.812 | 3935.1 samples/s | 61.5 steps/s
[Step=95850 Epoch=186.9] | Loss=0.01295 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.230 | L2-Norm(final)=16.815 | 3928.1 samples/s | 61.4 steps/s
[Step=95900 Epoch=187.0] | Loss=0.01278 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.235 | L2-Norm(final)=16.818 | 3948.1 samples/s | 61.7 steps/s
[Step=95950 Epoch=187.1] | Loss=0.01260 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.240 | L2-Norm(final)=16.821 | 3950.0 samples/s | 61.7 steps/s
[Step=96000 Epoch=187.2] | Loss=0.01252 | Reg=0.00053 | acc=1.0000 | L2-Norm=7.246 | L2-Norm(final)=16.824 | 3943.7 samples/s | 61.6 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step96000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=94001 Epoch=183.8] | Loss=0.02492 | Reg=0.00048 | acc=0.9844 | L2-Norm=6.902 | L2-Norm(final)=16.950 | 3393.2 samples/s | 53.0 steps/s
[Step=94050 Epoch=183.9] | Loss=0.02311 | Reg=0.00048 | acc=0.9688 | L2-Norm=6.910 | L2-Norm(final)=16.955 | 3932.3 samples/s | 61.4 steps/s
[Step=94100 Epoch=184.0] | Loss=0.02336 | Reg=0.00048 | acc=0.9688 | L2-Norm=6.919 | L2-Norm(final)=16.961 | 4370.5 samples/s | 68.3 steps/s
[Step=94150 Epoch=184.1] | Loss=0.02384 | Reg=0.00048 | acc=0.9844 | L2-Norm=6.927 | L2-Norm(final)=16.966 | 4329.2 samples/s | 67.6 steps/s
[Step=94200 Epoch=184.2] | Loss=0.02348 | Reg=0.00048 | acc=0.9844 | L2-Norm=6.936 | L2-Norm(final)=16.971 | 4374.6 samples/s | 68.4 steps/s
[Step=94250 Epoch=184.3] | Loss=0.02276 | Reg=0.00048 | acc=0.9531 | L2-Norm=6.943 | L2-Norm(final)=16.977 | 4356.6 samples/s | 68.1 steps/s
[Step=94300 Epoch=184.4] | Loss=0.02250 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.951 | L2-Norm(final)=16.982 | 4257.3 samples/s | 66.5 steps/s
[Step=94350 Epoch=184.5] | Loss=0.02261 | Reg=0.00048 | acc=0.9844 | L2-Norm=6.958 | L2-Norm(final)=16.986 | 4358.8 samples/s | 68.1 steps/s
[Step=94400 Epoch=184.5] | Loss=0.02213 | Reg=0.00049 | acc=0.9688 | L2-Norm=6.964 | L2-Norm(final)=16.991 | 4383.6 samples/s | 68.5 steps/s
[Step=94450 Epoch=184.6] | Loss=0.02186 | Reg=0.00049 | acc=0.9844 | L2-Norm=6.971 | L2-Norm(final)=16.996 | 4365.6 samples/s | 68.2 steps/s
[Step=94500 Epoch=184.7] | Loss=0.02156 | Reg=0.00049 | acc=0.9844 | L2-Norm=6.977 | L2-Norm(final)=17.000 | 5550.0 samples/s | 86.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=94501 Epoch=184.7] | Loss=0.01578 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.040 | L2-Norm(final)=17.044 | 3316.1 samples/s | 51.8 steps/s
[Step=94550 Epoch=184.8] | Loss=0.01758 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.049 | L2-Norm(final)=17.048 | 3755.1 samples/s | 58.7 steps/s
[Step=94600 Epoch=184.9] | Loss=0.01778 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.059 | L2-Norm(final)=17.053 | 3932.2 samples/s | 61.4 steps/s
[Step=94650 Epoch=185.0] | Loss=0.01902 | Reg=0.00050 | acc=0.9844 | L2-Norm=7.067 | L2-Norm(final)=17.056 | 3920.7 samples/s | 61.3 steps/s
[Step=94700 Epoch=185.1] | Loss=0.01866 | Reg=0.00050 | acc=0.9844 | L2-Norm=7.076 | L2-Norm(final)=17.060 | 3914.3 samples/s | 61.2 steps/s
[Step=94750 Epoch=185.2] | Loss=0.01806 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.084 | L2-Norm(final)=17.064 | 3927.5 samples/s | 61.4 steps/s
[Step=94800 Epoch=185.3] | Loss=0.01786 | Reg=0.00050 | acc=0.9844 | L2-Norm=7.092 | L2-Norm(final)=17.068 | 3968.3 samples/s | 62.0 steps/s
[Step=94850 Epoch=185.4] | Loss=0.01823 | Reg=0.00050 | acc=1.0000 | L2-Norm=7.099 | L2-Norm(final)=17.072 | 3978.4 samples/s | 62.2 steps/s
[Step=94900 Epoch=185.5] | Loss=0.01776 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.106 | L2-Norm(final)=17.075 | 3916.5 samples/s | 61.2 steps/s
[Step=94950 Epoch=185.6] | Loss=0.01732 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.113 | L2-Norm(final)=17.079 | 3936.8 samples/s | 61.5 steps/s
[Step=95000 Epoch=185.7] | Loss=0.01701 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.121 | L2-Norm(final)=17.083 | 4918.7 samples/s | 76.9 steps/s
[Step=95050 Epoch=185.8] | Loss=0.01649 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.127 | L2-Norm(final)=17.087 | 1532.7 samples/s | 23.9 steps/s
[Step=95100 Epoch=185.9] | Loss=0.01623 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.134 | L2-Norm(final)=17.090 | 3937.2 samples/s | 61.5 steps/s
[Step=95150 Epoch=186.0] | Loss=0.01587 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.141 | L2-Norm(final)=17.094 | 3932.2 samples/s | 61.4 steps/s
[Step=95200 Epoch=186.1] | Loss=0.01573 | Reg=0.00051 | acc=0.9844 | L2-Norm=7.147 | L2-Norm(final)=17.098 | 3951.1 samples/s | 61.7 steps/s
[Step=95250 Epoch=186.2] | Loss=0.01544 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.153 | L2-Norm(final)=17.101 | 3929.6 samples/s | 61.4 steps/s
[Step=95300 Epoch=186.3] | Loss=0.01516 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.159 | L2-Norm(final)=17.104 | 3937.5 samples/s | 61.5 steps/s
[Step=95350 Epoch=186.4] | Loss=0.01490 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.166 | L2-Norm(final)=17.108 | 3941.6 samples/s | 61.6 steps/s
[Step=95400 Epoch=186.5] | Loss=0.01465 | Reg=0.00051 | acc=1.0000 | L2-Norm=7.172 | L2-Norm(final)=17.111 | 3959.9 samples/s | 61.9 steps/s
[Step=95450 Epoch=186.6] | Loss=0.01447 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.178 | L2-Norm(final)=17.115 | 3964.8 samples/s | 61.9 steps/s
[Step=95500 Epoch=186.7] | Loss=0.01432 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.183 | L2-Norm(final)=17.118 | 4301.5 samples/s | 67.2 steps/s
[Step=95550 Epoch=186.8] | Loss=0.01413 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.189 | L2-Norm(final)=17.121 | 1562.1 samples/s | 24.4 steps/s
[Step=95600 Epoch=186.9] | Loss=0.01387 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.195 | L2-Norm(final)=17.125 | 3968.6 samples/s | 62.0 steps/s
[Step=95650 Epoch=187.0] | Loss=0.01365 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.200 | L2-Norm(final)=17.128 | 3923.2 samples/s | 61.3 steps/s
[Step=95700 Epoch=187.1] | Loss=0.01337 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.206 | L2-Norm(final)=17.131 | 3930.8 samples/s | 61.4 steps/s
[Step=95750 Epoch=187.2] | Loss=0.01325 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.211 | L2-Norm(final)=17.134 | 3927.9 samples/s | 61.4 steps/s
[Step=95800 Epoch=187.3] | Loss=0.01309 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.217 | L2-Norm(final)=17.137 | 3940.7 samples/s | 61.6 steps/s
[Step=95850 Epoch=187.4] | Loss=0.01291 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.222 | L2-Norm(final)=17.140 | 3938.8 samples/s | 61.5 steps/s
[Step=95900 Epoch=187.5] | Loss=0.01282 | Reg=0.00052 | acc=1.0000 | L2-Norm=7.227 | L2-Norm(final)=17.144 | 3938.1 samples/s | 61.5 steps/s
[Step=95950 Epoch=187.6] | Loss=0.01274 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.233 | L2-Norm(final)=17.147 | 3898.6 samples/s | 60.9 steps/s
[Step=96000 Epoch=187.7] | Loss=0.01257 | Reg=0.00052 | acc=0.9844 | L2-Norm=7.238 | L2-Norm(final)=17.150 | 3960.7 samples/s | 61.9 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step96000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=94001 Epoch=360.2] | Loss=0.00003 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.902 | L2-Norm(final)=11.963 | 3010.6 samples/s | 47.0 steps/s
[Step=94050 Epoch=360.4] | Loss=0.00006 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.896 | L2-Norm(final)=11.973 | 4120.2 samples/s | 64.4 steps/s
[Step=94100 Epoch=360.6] | Loss=0.00004 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.894 | L2-Norm(final)=11.981 | 4131.0 samples/s | 64.5 steps/s
[Step=94150 Epoch=360.7] | Loss=0.00003 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.892 | L2-Norm(final)=11.989 | 4106.5 samples/s | 64.2 steps/s
[Step=94200 Epoch=360.9] | Loss=0.00003 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.888 | L2-Norm(final)=11.996 | 4113.8 samples/s | 64.3 steps/s
[Step=94250 Epoch=361.1] | Loss=0.00003 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.885 | L2-Norm(final)=12.002 | 5397.0 samples/s | 84.3 steps/s
[Step=94300 Epoch=361.3] | Loss=0.00002 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.882 | L2-Norm(final)=12.008 | 1478.0 samples/s | 23.1 steps/s
[Step=94350 Epoch=361.5] | Loss=0.00002 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.878 | L2-Norm(final)=12.013 | 4089.2 samples/s | 63.9 steps/s
[Step=94400 Epoch=361.7] | Loss=0.00002 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.875 | L2-Norm(final)=12.018 | 4105.8 samples/s | 64.2 steps/s
[Step=94450 Epoch=361.9] | Loss=0.00002 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.871 | L2-Norm(final)=12.023 | 4088.6 samples/s | 63.9 steps/s
[Step=94500 Epoch=362.1] | Loss=0.00002 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.868 | L2-Norm(final)=12.028 | 4608.2 samples/s | 72.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=94501 Epoch=362.1] | Loss=0.00000 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.831 | L2-Norm(final)=12.074 | 3008.8 samples/s | 47.0 steps/s
[Step=94550 Epoch=362.3] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.818 | L2-Norm(final)=12.077 | 3695.7 samples/s | 57.7 steps/s
[Step=94600 Epoch=362.5] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.802 | L2-Norm(final)=12.081 | 3687.8 samples/s | 57.6 steps/s
[Step=94650 Epoch=362.7] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.784 | L2-Norm(final)=12.083 | 3712.5 samples/s | 58.0 steps/s
[Step=94700 Epoch=362.9] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.765 | L2-Norm(final)=12.085 | 3673.3 samples/s | 57.4 steps/s
[Step=94750 Epoch=363.0] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.746 | L2-Norm(final)=12.088 | 4703.6 samples/s | 73.5 steps/s
[Step=94800 Epoch=363.2] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.727 | L2-Norm(final)=12.090 | 1426.0 samples/s | 22.3 steps/s
[Step=94850 Epoch=363.4] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.707 | L2-Norm(final)=12.092 | 3694.0 samples/s | 57.7 steps/s
[Step=94900 Epoch=363.6] | Loss=0.00000 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.688 | L2-Norm(final)=12.093 | 3674.6 samples/s | 57.4 steps/s
[Step=94950 Epoch=363.8] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.668 | L2-Norm(final)=12.095 | 3733.6 samples/s | 58.3 steps/s
[Step=95000 Epoch=364.0] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.647 | L2-Norm(final)=12.096 | 4126.5 samples/s | 64.5 steps/s
[Step=95050 Epoch=364.2] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.628 | L2-Norm(final)=12.098 | 1496.7 samples/s | 23.4 steps/s
[Step=95100 Epoch=364.4] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.608 | L2-Norm(final)=12.100 | 3747.4 samples/s | 58.6 steps/s
[Step=95150 Epoch=364.6] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.588 | L2-Norm(final)=12.101 | 3723.3 samples/s | 58.2 steps/s
[Step=95200 Epoch=364.8] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.568 | L2-Norm(final)=12.103 | 3789.3 samples/s | 59.2 steps/s
[Step=95250 Epoch=365.0] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.548 | L2-Norm(final)=12.105 | 3673.1 samples/s | 57.4 steps/s
[Step=95300 Epoch=365.2] | Loss=0.00000 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.528 | L2-Norm(final)=12.106 | 1612.2 samples/s | 25.2 steps/s
[Step=95350 Epoch=365.3] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.509 | L2-Norm(final)=12.108 | 3746.8 samples/s | 58.5 steps/s
[Step=95400 Epoch=365.5] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.489 | L2-Norm(final)=12.110 | 3760.7 samples/s | 58.8 steps/s
[Step=95450 Epoch=365.7] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.469 | L2-Norm(final)=12.112 | 3701.7 samples/s | 57.8 steps/s
[Step=95500 Epoch=365.9] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.450 | L2-Norm(final)=12.114 | 3736.5 samples/s | 58.4 steps/s
[Step=95550 Epoch=366.1] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.431 | L2-Norm(final)=12.116 | 1619.3 samples/s | 25.3 steps/s
[Step=95600 Epoch=366.3] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.412 | L2-Norm(final)=12.118 | 3721.6 samples/s | 58.1 steps/s
[Step=95650 Epoch=366.5] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.393 | L2-Norm(final)=12.120 | 3663.2 samples/s | 57.2 steps/s
[Step=95700 Epoch=366.7] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.374 | L2-Norm(final)=12.122 | 3682.2 samples/s | 57.5 steps/s
[Step=95750 Epoch=366.9] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.355 | L2-Norm(final)=12.124 | 3712.5 samples/s | 58.0 steps/s
[Step=95800 Epoch=367.1] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.336 | L2-Norm(final)=12.126 | 5035.8 samples/s | 78.7 steps/s
[Step=95850 Epoch=367.3] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.317 | L2-Norm(final)=12.128 | 1423.6 samples/s | 22.2 steps/s
[Step=95900 Epoch=367.5] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.298 | L2-Norm(final)=12.131 | 3711.5 samples/s | 58.0 steps/s
[Step=95950 Epoch=367.6] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.280 | L2-Norm(final)=12.133 | 3710.5 samples/s | 58.0 steps/s
[Step=96000 Epoch=367.8] | Loss=0.00000 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.261 | L2-Norm(final)=12.135 | 3734.9 samples/s | 58.4 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step96000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=94001 Epoch=361.8] | Loss=0.00008 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.902 | L2-Norm(final)=11.809 | 3339.3 samples/s | 52.2 steps/s
[Step=94050 Epoch=362.0] | Loss=0.00006 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.900 | L2-Norm(final)=11.814 | 3686.4 samples/s | 57.6 steps/s
[Step=94100 Epoch=362.2] | Loss=0.00005 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.899 | L2-Norm(final)=11.820 | 4173.0 samples/s | 65.2 steps/s
[Step=94150 Epoch=362.4] | Loss=0.00006 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.899 | L2-Norm(final)=11.827 | 4072.4 samples/s | 63.6 steps/s
[Step=94200 Epoch=362.6] | Loss=0.00005 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.900 | L2-Norm(final)=11.834 | 4146.4 samples/s | 64.8 steps/s
[Step=94250 Epoch=362.8] | Loss=0.00005 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.901 | L2-Norm(final)=11.840 | 5393.0 samples/s | 84.3 steps/s
[Step=94300 Epoch=363.0] | Loss=0.00005 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.900 | L2-Norm(final)=11.846 | 1511.6 samples/s | 23.6 steps/s
[Step=94350 Epoch=363.2] | Loss=0.00004 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.900 | L2-Norm(final)=11.850 | 4088.7 samples/s | 63.9 steps/s
[Step=94400 Epoch=363.4] | Loss=0.00004 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.899 | L2-Norm(final)=11.855 | 4191.4 samples/s | 65.5 steps/s
[Step=94450 Epoch=363.6] | Loss=0.00004 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.899 | L2-Norm(final)=11.859 | 4072.9 samples/s | 63.6 steps/s
[Step=94500 Epoch=363.8] | Loss=0.00004 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.898 | L2-Norm(final)=11.863 | 4755.4 samples/s | 74.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=94501 Epoch=363.8] | Loss=0.00002 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.889 | L2-Norm(final)=11.905 | 3173.9 samples/s | 49.6 steps/s
[Step=94550 Epoch=364.0] | Loss=0.00001 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.886 | L2-Norm(final)=11.908 | 3581.2 samples/s | 56.0 steps/s
[Step=94600 Epoch=364.2] | Loss=0.00001 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.883 | L2-Norm(final)=11.911 | 3729.8 samples/s | 58.3 steps/s
[Step=94650 Epoch=364.3] | Loss=0.00001 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.880 | L2-Norm(final)=11.913 | 3744.4 samples/s | 58.5 steps/s
[Step=94700 Epoch=364.5] | Loss=0.00001 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.876 | L2-Norm(final)=11.915 | 3786.0 samples/s | 59.2 steps/s
[Step=94750 Epoch=364.7] | Loss=0.00001 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.871 | L2-Norm(final)=11.917 | 4751.8 samples/s | 74.2 steps/s
[Step=94800 Epoch=364.9] | Loss=0.00001 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.867 | L2-Norm(final)=11.919 | 1432.8 samples/s | 22.4 steps/s
[Step=94850 Epoch=365.1] | Loss=0.00001 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.863 | L2-Norm(final)=11.921 | 3762.4 samples/s | 58.8 steps/s
[Step=94900 Epoch=365.3] | Loss=0.00001 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.858 | L2-Norm(final)=11.923 | 3732.6 samples/s | 58.3 steps/s
[Step=94950 Epoch=365.5] | Loss=0.00001 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.854 | L2-Norm(final)=11.925 | 3691.4 samples/s | 57.7 steps/s
[Step=95000 Epoch=365.7] | Loss=0.00001 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.849 | L2-Norm(final)=11.926 | 4223.8 samples/s | 66.0 steps/s
[Step=95050 Epoch=365.9] | Loss=0.00001 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.844 | L2-Norm(final)=11.928 | 1534.4 samples/s | 24.0 steps/s
[Step=95100 Epoch=366.1] | Loss=0.00001 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.839 | L2-Norm(final)=11.929 | 3702.6 samples/s | 57.9 steps/s
[Step=95150 Epoch=366.3] | Loss=0.00001 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.833 | L2-Norm(final)=11.931 | 3744.3 samples/s | 58.5 steps/s
[Step=95200 Epoch=366.5] | Loss=0.00001 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.828 | L2-Norm(final)=11.932 | 3764.8 samples/s | 58.8 steps/s
[Step=95250 Epoch=366.7] | Loss=0.00001 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.823 | L2-Norm(final)=11.934 | 3769.1 samples/s | 58.9 steps/s
[Step=95300 Epoch=366.8] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.817 | L2-Norm(final)=11.935 | 1569.6 samples/s | 24.5 steps/s
[Step=95350 Epoch=367.0] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.812 | L2-Norm(final)=11.936 | 3734.3 samples/s | 58.3 steps/s
[Step=95400 Epoch=367.2] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.806 | L2-Norm(final)=11.938 | 3714.4 samples/s | 58.0 steps/s
[Step=95450 Epoch=367.4] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.801 | L2-Norm(final)=11.939 | 3729.9 samples/s | 58.3 steps/s
[Step=95500 Epoch=367.6] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.795 | L2-Norm(final)=11.940 | 3731.2 samples/s | 58.3 steps/s
[Step=95550 Epoch=367.8] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.789 | L2-Norm(final)=11.941 | 1643.3 samples/s | 25.7 steps/s
[Step=95600 Epoch=368.0] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.783 | L2-Norm(final)=11.943 | 3737.5 samples/s | 58.4 steps/s
[Step=95650 Epoch=368.2] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.777 | L2-Norm(final)=11.944 | 3789.1 samples/s | 59.2 steps/s
[Step=95700 Epoch=368.4] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.771 | L2-Norm(final)=11.945 | 3721.4 samples/s | 58.1 steps/s
[Step=95750 Epoch=368.6] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.766 | L2-Norm(final)=11.947 | 3678.3 samples/s | 57.5 steps/s
[Step=95800 Epoch=368.8] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.759 | L2-Norm(final)=11.948 | 5500.1 samples/s | 85.9 steps/s
[Step=95850 Epoch=369.0] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.753 | L2-Norm(final)=11.949 | 1386.7 samples/s | 21.7 steps/s
[Step=95900 Epoch=369.2] | Loss=0.00001 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.747 | L2-Norm(final)=11.951 | 3731.6 samples/s | 58.3 steps/s
[Step=95950 Epoch=369.3] | Loss=0.00001 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.741 | L2-Norm(final)=11.952 | 3687.4 samples/s | 57.6 steps/s
[Step=96000 Epoch=369.5] | Loss=0.00001 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.735 | L2-Norm(final)=11.953 | 3734.4 samples/s | 58.3 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step96000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05521 | acc=0.9681 | tpr=0.9687 | fpr=0.0332 | 3540.1 samples/s | 13.8 steps/s
Avg test loss: 0.05970, Avg test acc: 0.96578, Avg tpr: 0.96654, Avg fpr: 0.03589, total FA: 280

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05037 | acc=0.9689 | tpr=0.9743 | fpr=0.0429 | 3520.4 samples/s | 13.8 steps/s
Avg test loss: 0.05486, Avg test acc: 0.96755, Avg tpr: 0.97430, Avg fpr: 0.04730, total FA: 369

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.44441 | acc=0.3121 | tpr=0.0097 | fpr=0.0312 | 3548.5 samples/s | 13.9 steps/s
Avg test loss: 5.46535, Avg test acc: 0.30932, Avg tpr: 0.00950, Avg fpr: 0.03128, total FA: 244

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.96852 | acc=0.3116 | tpr=0.0194 | fpr=0.0540 | 3491.4 samples/s | 13.6 steps/s
Avg test loss: 4.98302, Avg test acc: 0.30916, Avg tpr: 0.01912, Avg fpr: 0.05294, total FA: 413

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.41339 | acc=0.1245 | tpr=0.8584 | fpr=0.8887 | 3472.5 samples/s | 13.6 steps/s
[Step= 100] | Loss=4.39603 | acc=0.1261 | tpr=0.8891 | fpr=0.8882 | 6936.9 samples/s | 27.1 steps/s
[Step= 150] | Loss=4.40473 | acc=0.1253 | tpr=0.8919 | fpr=0.8888 | 6737.2 samples/s | 26.3 steps/s
[Step= 200] | Loss=4.39180 | acc=0.1255 | tpr=0.8820 | fpr=0.8883 | 7027.2 samples/s | 27.4 steps/s
[Step= 250] | Loss=4.39870 | acc=0.1254 | tpr=0.8699 | fpr=0.8882 | 6587.5 samples/s | 25.7 steps/s
[Step= 300] | Loss=4.39910 | acc=0.1250 | tpr=0.8698 | fpr=0.8886 | 6733.9 samples/s | 26.3 steps/s
[Step= 350] | Loss=4.39620 | acc=0.1256 | tpr=0.8748 | fpr=0.8880 | 6912.4 samples/s | 27.0 steps/s
[Step= 400] | Loss=4.39421 | acc=0.1255 | tpr=0.8671 | fpr=0.8880 | 6857.5 samples/s | 26.8 steps/s
[Step= 450] | Loss=4.39985 | acc=0.1249 | tpr=0.8685 | fpr=0.8886 | 6593.6 samples/s | 25.8 steps/s
[Step= 500] | Loss=4.40059 | acc=0.1248 | tpr=0.8705 | fpr=0.8887 | 6875.4 samples/s | 26.9 steps/s
[Step= 550] | Loss=4.39992 | acc=0.1250 | tpr=0.8711 | fpr=0.8886 | 12004.6 samples/s | 46.9 steps/s
Avg test loss: 4.40045, Avg test acc: 0.12493, Avg tpr: 0.87084, Avg fpr: 0.88863, total FA: 123385

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.57569 | acc=0.1214 | tpr=0.8805 | fpr=0.8922 | 3524.0 samples/s | 13.8 steps/s
[Step= 100] | Loss=4.55448 | acc=0.1221 | tpr=0.9041 | fpr=0.8925 | 6771.3 samples/s | 26.5 steps/s
[Step= 150] | Loss=4.56813 | acc=0.1209 | tpr=0.9164 | fpr=0.8937 | 6731.6 samples/s | 26.3 steps/s
[Step= 200] | Loss=4.55801 | acc=0.1206 | tpr=0.9071 | fpr=0.8937 | 7000.7 samples/s | 27.3 steps/s
[Step= 250] | Loss=4.56392 | acc=0.1205 | tpr=0.8943 | fpr=0.8936 | 6976.0 samples/s | 27.2 steps/s
[Step= 300] | Loss=4.56519 | acc=0.1198 | tpr=0.8895 | fpr=0.8942 | 6757.8 samples/s | 26.4 steps/s
[Step= 350] | Loss=4.56305 | acc=0.1204 | tpr=0.8936 | fpr=0.8936 | 6808.5 samples/s | 26.6 steps/s
[Step= 400] | Loss=4.56102 | acc=0.1202 | tpr=0.8889 | fpr=0.8938 | 6704.1 samples/s | 26.2 steps/s
[Step= 450] | Loss=4.56825 | acc=0.1198 | tpr=0.8895 | fpr=0.8942 | 6760.5 samples/s | 26.4 steps/s
[Step= 500] | Loss=4.56966 | acc=0.1196 | tpr=0.8925 | fpr=0.8943 | 6790.6 samples/s | 26.5 steps/s
[Step= 550] | Loss=4.56890 | acc=0.1196 | tpr=0.8930 | fpr=0.8944 | 12720.6 samples/s | 49.7 steps/s
Avg test loss: 4.56940, Avg test acc: 0.11956, Avg tpr: 0.89263, Avg fpr: 0.89450, total FA: 124199

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08801 | acc=0.9837 | tpr=0.9469 | fpr=0.0157 | 3507.2 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.09225 | acc=0.9833 | tpr=0.9574 | fpr=0.0162 | 7130.8 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.09546 | acc=0.9824 | tpr=0.9582 | fpr=0.0171 | 6682.0 samples/s | 26.1 steps/s
[Step= 200] | Loss=0.09686 | acc=0.9824 | tpr=0.9585 | fpr=0.0172 | 7459.0 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.09597 | acc=0.9827 | tpr=0.9555 | fpr=0.0168 | 6364.6 samples/s | 24.9 steps/s
[Step= 300] | Loss=0.09757 | acc=0.9823 | tpr=0.9542 | fpr=0.0171 | 6917.0 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.09782 | acc=0.9822 | tpr=0.9555 | fpr=0.0173 | 6954.3 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.09914 | acc=0.9819 | tpr=0.9508 | fpr=0.0175 | 6816.4 samples/s | 26.6 steps/s
[Step= 450] | Loss=0.10112 | acc=0.9816 | tpr=0.9499 | fpr=0.0178 | 6828.7 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.10069 | acc=0.9816 | tpr=0.9529 | fpr=0.0178 | 6936.8 samples/s | 27.1 steps/s
[Step= 550] | Loss=0.09991 | acc=0.9818 | tpr=0.9519 | fpr=0.0177 | 11989.2 samples/s | 46.8 steps/s
Avg test loss: 0.09976, Avg test acc: 0.98176, Avg tpr: 0.95166, Avg fpr: 0.01770, total FA: 2457

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10729 | acc=0.9807 | tpr=0.9558 | fpr=0.0188 | 3481.6 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.11216 | acc=0.9799 | tpr=0.9659 | fpr=0.0199 | 7064.2 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.11584 | acc=0.9790 | tpr=0.9697 | fpr=0.0209 | 6719.0 samples/s | 26.2 steps/s
[Step= 200] | Loss=0.11761 | acc=0.9788 | tpr=0.9705 | fpr=0.0211 | 7113.0 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.11671 | acc=0.9790 | tpr=0.9686 | fpr=0.0208 | 6821.7 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.11844 | acc=0.9786 | tpr=0.9673 | fpr=0.0211 | 6858.5 samples/s | 26.8 steps/s
[Step= 350] | Loss=0.11854 | acc=0.9785 | tpr=0.9674 | fpr=0.0213 | 6893.9 samples/s | 26.9 steps/s
[Step= 400] | Loss=0.11989 | acc=0.9782 | tpr=0.9644 | fpr=0.0215 | 6771.7 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.12228 | acc=0.9778 | tpr=0.9625 | fpr=0.0219 | 6853.2 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.12197 | acc=0.9778 | tpr=0.9643 | fpr=0.0219 | 6856.3 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.12100 | acc=0.9781 | tpr=0.9634 | fpr=0.0216 | 12506.9 samples/s | 48.9 steps/s
Avg test loss: 0.12093, Avg test acc: 0.97814, Avg tpr: 0.96315, Avg fpr: 0.02159, total FA: 2998

server round 48/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=96001 Epoch=187.2] | Loss=0.01650 | Reg=0.00044 | acc=0.9844 | L2-Norm=6.666 | L2-Norm(final)=16.914 | 3049.5 samples/s | 47.6 steps/s
[Step=96050 Epoch=187.3] | Loss=0.02872 | Reg=0.00045 | acc=0.9531 | L2-Norm=6.675 | L2-Norm(final)=16.918 | 4170.4 samples/s | 65.2 steps/s
[Step=96100 Epoch=187.4] | Loss=0.02902 | Reg=0.00045 | acc=0.9375 | L2-Norm=6.684 | L2-Norm(final)=16.923 | 4321.3 samples/s | 67.5 steps/s
[Step=96150 Epoch=187.5] | Loss=0.02845 | Reg=0.00045 | acc=0.9844 | L2-Norm=6.693 | L2-Norm(final)=16.928 | 4328.4 samples/s | 67.6 steps/s
[Step=96200 Epoch=187.6] | Loss=0.02775 | Reg=0.00045 | acc=0.9844 | L2-Norm=6.701 | L2-Norm(final)=16.932 | 4325.5 samples/s | 67.6 steps/s
[Step=96250 Epoch=187.7] | Loss=0.02694 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.709 | L2-Norm(final)=16.937 | 4362.2 samples/s | 68.2 steps/s
[Step=96300 Epoch=187.8] | Loss=0.02706 | Reg=0.00045 | acc=0.9844 | L2-Norm=6.717 | L2-Norm(final)=16.942 | 4359.5 samples/s | 68.1 steps/s
[Step=96350 Epoch=187.9] | Loss=0.02653 | Reg=0.00045 | acc=0.9844 | L2-Norm=6.724 | L2-Norm(final)=16.946 | 4302.4 samples/s | 67.2 steps/s
[Step=96400 Epoch=188.0] | Loss=0.02583 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.732 | L2-Norm(final)=16.951 | 4351.9 samples/s | 68.0 steps/s
[Step=96450 Epoch=188.1] | Loss=0.02581 | Reg=0.00045 | acc=0.9688 | L2-Norm=6.739 | L2-Norm(final)=16.955 | 4299.0 samples/s | 67.2 steps/s
[Step=96500 Epoch=188.2] | Loss=0.02574 | Reg=0.00046 | acc=0.9844 | L2-Norm=6.745 | L2-Norm(final)=16.960 | 5454.9 samples/s | 85.2 steps/s
All layers training...
LR=0.00006, len=1
[Step=96501 Epoch=188.2] | Loss=0.01509 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.814 | L2-Norm(final)=17.001 | 3134.6 samples/s | 49.0 steps/s
[Step=96550 Epoch=188.3] | Loss=0.02713 | Reg=0.00047 | acc=0.9688 | L2-Norm=6.822 | L2-Norm(final)=17.005 | 3546.9 samples/s | 55.4 steps/s
[Step=96600 Epoch=188.4] | Loss=0.02478 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.832 | L2-Norm(final)=17.009 | 3918.5 samples/s | 61.2 steps/s
[Step=96650 Epoch=188.5] | Loss=0.02298 | Reg=0.00047 | acc=0.9844 | L2-Norm=6.841 | L2-Norm(final)=17.013 | 3853.7 samples/s | 60.2 steps/s
[Step=96700 Epoch=188.6] | Loss=0.02247 | Reg=0.00047 | acc=0.9844 | L2-Norm=6.850 | L2-Norm(final)=17.017 | 3905.9 samples/s | 61.0 steps/s
[Step=96750 Epoch=188.7] | Loss=0.02161 | Reg=0.00047 | acc=0.9688 | L2-Norm=6.859 | L2-Norm(final)=17.021 | 3900.0 samples/s | 60.9 steps/s
[Step=96800 Epoch=188.8] | Loss=0.02097 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.867 | L2-Norm(final)=17.025 | 3919.6 samples/s | 61.2 steps/s
[Step=96850 Epoch=188.9] | Loss=0.02032 | Reg=0.00047 | acc=0.9844 | L2-Norm=6.876 | L2-Norm(final)=17.028 | 3897.6 samples/s | 60.9 steps/s
[Step=96900 Epoch=189.0] | Loss=0.01967 | Reg=0.00047 | acc=0.9844 | L2-Norm=6.883 | L2-Norm(final)=17.032 | 3898.3 samples/s | 60.9 steps/s
[Step=96950 Epoch=189.1] | Loss=0.01943 | Reg=0.00047 | acc=0.9844 | L2-Norm=6.891 | L2-Norm(final)=17.036 | 3922.0 samples/s | 61.3 steps/s
[Step=97000 Epoch=189.2] | Loss=0.01920 | Reg=0.00048 | acc=0.9844 | L2-Norm=6.899 | L2-Norm(final)=17.040 | 4765.3 samples/s | 74.5 steps/s
[Step=97050 Epoch=189.3] | Loss=0.01858 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.906 | L2-Norm(final)=17.043 | 1502.6 samples/s | 23.5 steps/s
[Step=97100 Epoch=189.4] | Loss=0.01815 | Reg=0.00048 | acc=0.9688 | L2-Norm=6.913 | L2-Norm(final)=17.047 | 3872.9 samples/s | 60.5 steps/s
[Step=97150 Epoch=189.5] | Loss=0.01771 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.920 | L2-Norm(final)=17.050 | 3899.0 samples/s | 60.9 steps/s
[Step=97200 Epoch=189.6] | Loss=0.01727 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.927 | L2-Norm(final)=17.054 | 3914.0 samples/s | 61.2 steps/s
[Step=97250 Epoch=189.7] | Loss=0.01683 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.934 | L2-Norm(final)=17.057 | 3933.2 samples/s | 61.5 steps/s
[Step=97300 Epoch=189.8] | Loss=0.01649 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.940 | L2-Norm(final)=17.060 | 3928.5 samples/s | 61.4 steps/s
[Step=97350 Epoch=189.9] | Loss=0.01634 | Reg=0.00048 | acc=0.9688 | L2-Norm=6.947 | L2-Norm(final)=17.064 | 3904.3 samples/s | 61.0 steps/s
[Step=97400 Epoch=190.0] | Loss=0.01612 | Reg=0.00048 | acc=0.9844 | L2-Norm=6.953 | L2-Norm(final)=17.067 | 3942.1 samples/s | 61.6 steps/s
[Step=97450 Epoch=190.1] | Loss=0.01599 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.959 | L2-Norm(final)=17.070 | 3927.9 samples/s | 61.4 steps/s
[Step=97500 Epoch=190.2] | Loss=0.01580 | Reg=0.00049 | acc=0.9844 | L2-Norm=6.965 | L2-Norm(final)=17.074 | 4099.1 samples/s | 64.0 steps/s
[Step=97550 Epoch=190.3] | Loss=0.01559 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.972 | L2-Norm(final)=17.077 | 1560.5 samples/s | 24.4 steps/s
[Step=97600 Epoch=190.4] | Loss=0.01534 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.978 | L2-Norm(final)=17.080 | 3966.4 samples/s | 62.0 steps/s
[Step=97650 Epoch=190.5] | Loss=0.01504 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.984 | L2-Norm(final)=17.083 | 3912.4 samples/s | 61.1 steps/s
[Step=97700 Epoch=190.6] | Loss=0.01483 | Reg=0.00049 | acc=0.9688 | L2-Norm=6.990 | L2-Norm(final)=17.087 | 3865.3 samples/s | 60.4 steps/s
[Step=97750 Epoch=190.7] | Loss=0.01471 | Reg=0.00049 | acc=0.9844 | L2-Norm=6.995 | L2-Norm(final)=17.090 | 3908.2 samples/s | 61.1 steps/s
[Step=97800 Epoch=190.7] | Loss=0.01449 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.001 | L2-Norm(final)=17.093 | 3934.8 samples/s | 61.5 steps/s
[Step=97850 Epoch=190.8] | Loss=0.01431 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.007 | L2-Norm(final)=17.096 | 3965.5 samples/s | 62.0 steps/s
[Step=97900 Epoch=190.9] | Loss=0.01417 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.012 | L2-Norm(final)=17.099 | 3940.1 samples/s | 61.6 steps/s
[Step=97950 Epoch=191.0] | Loss=0.01400 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.018 | L2-Norm(final)=17.102 | 3896.8 samples/s | 60.9 steps/s
[Step=98000 Epoch=191.1] | Loss=0.01395 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.023 | L2-Norm(final)=17.105 | 3953.3 samples/s | 61.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step98000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=96001 Epoch=187.7] | Loss=0.04864 | Reg=0.00044 | acc=0.9531 | L2-Norm=6.666 | L2-Norm(final)=17.240 | 3335.2 samples/s | 52.1 steps/s
[Step=96050 Epoch=187.8] | Loss=0.02834 | Reg=0.00045 | acc=0.9688 | L2-Norm=6.676 | L2-Norm(final)=17.244 | 4115.7 samples/s | 64.3 steps/s
[Step=96100 Epoch=187.9] | Loss=0.02776 | Reg=0.00045 | acc=0.9688 | L2-Norm=6.686 | L2-Norm(final)=17.249 | 4308.1 samples/s | 67.3 steps/s
[Step=96150 Epoch=188.0] | Loss=0.02726 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.695 | L2-Norm(final)=17.254 | 4387.2 samples/s | 68.6 steps/s
[Step=96200 Epoch=188.1] | Loss=0.02705 | Reg=0.00045 | acc=0.9844 | L2-Norm=6.703 | L2-Norm(final)=17.259 | 4393.1 samples/s | 68.6 steps/s
[Step=96250 Epoch=188.2] | Loss=0.02608 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.711 | L2-Norm(final)=17.265 | 4362.2 samples/s | 68.2 steps/s
[Step=96300 Epoch=188.3] | Loss=0.02587 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.719 | L2-Norm(final)=17.270 | 4432.2 samples/s | 69.3 steps/s
[Step=96350 Epoch=188.4] | Loss=0.02547 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.726 | L2-Norm(final)=17.275 | 4342.5 samples/s | 67.9 steps/s
[Step=96400 Epoch=188.5] | Loss=0.02520 | Reg=0.00045 | acc=0.9688 | L2-Norm=6.733 | L2-Norm(final)=17.279 | 4433.3 samples/s | 69.3 steps/s
[Step=96450 Epoch=188.6] | Loss=0.02489 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.740 | L2-Norm(final)=17.284 | 4336.4 samples/s | 67.8 steps/s
[Step=96500 Epoch=188.7] | Loss=0.02463 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.746 | L2-Norm(final)=17.288 | 5656.7 samples/s | 88.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=96501 Epoch=188.7] | Loss=0.02666 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.810 | L2-Norm(final)=17.333 | 3231.1 samples/s | 50.5 steps/s
[Step=96550 Epoch=188.8] | Loss=0.01996 | Reg=0.00046 | acc=1.0000 | L2-Norm=6.819 | L2-Norm(final)=17.337 | 3769.5 samples/s | 58.9 steps/s
[Step=96600 Epoch=188.9] | Loss=0.01915 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.827 | L2-Norm(final)=17.341 | 3971.7 samples/s | 62.1 steps/s
[Step=96650 Epoch=188.9] | Loss=0.02001 | Reg=0.00047 | acc=0.9531 | L2-Norm=6.836 | L2-Norm(final)=17.345 | 3874.7 samples/s | 60.5 steps/s
[Step=96700 Epoch=189.0] | Loss=0.01999 | Reg=0.00047 | acc=0.9844 | L2-Norm=6.844 | L2-Norm(final)=17.349 | 3916.3 samples/s | 61.2 steps/s
[Step=96750 Epoch=189.1] | Loss=0.02000 | Reg=0.00047 | acc=0.9844 | L2-Norm=6.852 | L2-Norm(final)=17.352 | 3911.8 samples/s | 61.1 steps/s
[Step=96800 Epoch=189.2] | Loss=0.01952 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.860 | L2-Norm(final)=17.356 | 4012.5 samples/s | 62.7 steps/s
[Step=96850 Epoch=189.3] | Loss=0.01959 | Reg=0.00047 | acc=1.0000 | L2-Norm=6.868 | L2-Norm(final)=17.360 | 3917.2 samples/s | 61.2 steps/s
[Step=96900 Epoch=189.4] | Loss=0.01934 | Reg=0.00047 | acc=0.9844 | L2-Norm=6.876 | L2-Norm(final)=17.364 | 3961.2 samples/s | 61.9 steps/s
[Step=96950 Epoch=189.5] | Loss=0.01896 | Reg=0.00047 | acc=0.9844 | L2-Norm=6.883 | L2-Norm(final)=17.368 | 3914.0 samples/s | 61.2 steps/s
[Step=97000 Epoch=189.6] | Loss=0.01907 | Reg=0.00047 | acc=0.9844 | L2-Norm=6.891 | L2-Norm(final)=17.372 | 4875.4 samples/s | 76.2 steps/s
[Step=97050 Epoch=189.7] | Loss=0.01865 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.898 | L2-Norm(final)=17.375 | 1540.4 samples/s | 24.1 steps/s
[Step=97100 Epoch=189.8] | Loss=0.01815 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.906 | L2-Norm(final)=17.379 | 3863.0 samples/s | 60.4 steps/s
[Step=97150 Epoch=189.9] | Loss=0.01756 | Reg=0.00048 | acc=0.9844 | L2-Norm=6.913 | L2-Norm(final)=17.383 | 3919.8 samples/s | 61.2 steps/s
[Step=97200 Epoch=190.0] | Loss=0.01730 | Reg=0.00048 | acc=0.9844 | L2-Norm=6.920 | L2-Norm(final)=17.386 | 3930.0 samples/s | 61.4 steps/s
[Step=97250 Epoch=190.1] | Loss=0.01697 | Reg=0.00048 | acc=0.9844 | L2-Norm=6.927 | L2-Norm(final)=17.390 | 3905.7 samples/s | 61.0 steps/s
[Step=97300 Epoch=190.2] | Loss=0.01673 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.933 | L2-Norm(final)=17.394 | 3992.9 samples/s | 62.4 steps/s
[Step=97350 Epoch=190.3] | Loss=0.01647 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.940 | L2-Norm(final)=17.397 | 3930.5 samples/s | 61.4 steps/s
[Step=97400 Epoch=190.4] | Loss=0.01623 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.946 | L2-Norm(final)=17.401 | 3929.9 samples/s | 61.4 steps/s
[Step=97450 Epoch=190.5] | Loss=0.01597 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.952 | L2-Norm(final)=17.404 | 3965.0 samples/s | 62.0 steps/s
[Step=97500 Epoch=190.6] | Loss=0.01574 | Reg=0.00048 | acc=1.0000 | L2-Norm=6.959 | L2-Norm(final)=17.408 | 4247.3 samples/s | 66.4 steps/s
[Step=97550 Epoch=190.7] | Loss=0.01540 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.965 | L2-Norm(final)=17.411 | 1565.5 samples/s | 24.5 steps/s
[Step=97600 Epoch=190.8] | Loss=0.01510 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.971 | L2-Norm(final)=17.414 | 3952.4 samples/s | 61.8 steps/s
[Step=97650 Epoch=190.9] | Loss=0.01482 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.977 | L2-Norm(final)=17.418 | 3922.5 samples/s | 61.3 steps/s
[Step=97700 Epoch=191.0] | Loss=0.01460 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.983 | L2-Norm(final)=17.421 | 3937.9 samples/s | 61.5 steps/s
[Step=97750 Epoch=191.1] | Loss=0.01446 | Reg=0.00049 | acc=0.9844 | L2-Norm=6.989 | L2-Norm(final)=17.425 | 3906.0 samples/s | 61.0 steps/s
[Step=97800 Epoch=191.2] | Loss=0.01427 | Reg=0.00049 | acc=1.0000 | L2-Norm=6.994 | L2-Norm(final)=17.428 | 3929.0 samples/s | 61.4 steps/s
[Step=97850 Epoch=191.3] | Loss=0.01410 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.000 | L2-Norm(final)=17.431 | 3959.9 samples/s | 61.9 steps/s
[Step=97900 Epoch=191.4] | Loss=0.01401 | Reg=0.00049 | acc=0.9844 | L2-Norm=7.006 | L2-Norm(final)=17.435 | 3965.4 samples/s | 62.0 steps/s
[Step=97950 Epoch=191.5] | Loss=0.01386 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.011 | L2-Norm(final)=17.438 | 3949.1 samples/s | 61.7 steps/s
[Step=98000 Epoch=191.6] | Loss=0.01373 | Reg=0.00049 | acc=1.0000 | L2-Norm=7.017 | L2-Norm(final)=17.441 | 3911.2 samples/s | 61.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step98000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=96001 Epoch=367.8] | Loss=0.00001 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.666 | L2-Norm(final)=12.206 | 3420.7 samples/s | 53.4 steps/s
[Step=96050 Epoch=368.0] | Loss=0.00009 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.667 | L2-Norm(final)=12.221 | 3618.1 samples/s | 56.5 steps/s
[Step=96100 Epoch=368.2] | Loss=0.00005 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.670 | L2-Norm(final)=12.229 | 4140.8 samples/s | 64.7 steps/s
[Step=96150 Epoch=368.4] | Loss=0.00004 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.669 | L2-Norm(final)=12.235 | 4082.6 samples/s | 63.8 steps/s
[Step=96200 Epoch=368.6] | Loss=0.00003 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.667 | L2-Norm(final)=12.239 | 4119.8 samples/s | 64.4 steps/s
[Step=96250 Epoch=368.8] | Loss=0.00003 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.663 | L2-Norm(final)=12.243 | 5481.4 samples/s | 85.6 steps/s
[Step=96300 Epoch=369.0] | Loss=0.00003 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.660 | L2-Norm(final)=12.247 | 1508.1 samples/s | 23.6 steps/s
[Step=96350 Epoch=369.2] | Loss=0.00002 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.657 | L2-Norm(final)=12.251 | 4183.2 samples/s | 65.4 steps/s
[Step=96400 Epoch=369.4] | Loss=0.00002 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.653 | L2-Norm(final)=12.254 | 4162.3 samples/s | 65.0 steps/s
[Step=96450 Epoch=369.6] | Loss=0.00002 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.650 | L2-Norm(final)=12.257 | 4093.4 samples/s | 64.0 steps/s
[Step=96500 Epoch=369.8] | Loss=0.00002 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.646 | L2-Norm(final)=12.261 | 4689.7 samples/s | 73.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=96501 Epoch=369.8] | Loss=0.00000 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.611 | L2-Norm(final)=12.293 | 3164.3 samples/s | 49.4 steps/s
[Step=96550 Epoch=369.9] | Loss=0.00002 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.595 | L2-Norm(final)=12.296 | 3644.9 samples/s | 57.0 steps/s
[Step=96600 Epoch=370.1] | Loss=0.00001 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.582 | L2-Norm(final)=12.300 | 3682.9 samples/s | 57.5 steps/s
[Step=96650 Epoch=370.3] | Loss=0.00001 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.566 | L2-Norm(final)=12.303 | 3761.5 samples/s | 58.8 steps/s
[Step=96700 Epoch=370.5] | Loss=0.00001 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.550 | L2-Norm(final)=12.304 | 3743.2 samples/s | 58.5 steps/s
[Step=96750 Epoch=370.7] | Loss=0.00001 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.534 | L2-Norm(final)=12.306 | 4667.4 samples/s | 72.9 steps/s
[Step=96800 Epoch=370.9] | Loss=0.00001 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.517 | L2-Norm(final)=12.308 | 1486.7 samples/s | 23.2 steps/s
[Step=96850 Epoch=371.1] | Loss=0.00001 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.500 | L2-Norm(final)=12.309 | 3671.2 samples/s | 57.4 steps/s
[Step=96900 Epoch=371.3] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.483 | L2-Norm(final)=12.310 | 3752.5 samples/s | 58.6 steps/s
[Step=96950 Epoch=371.5] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.466 | L2-Norm(final)=12.311 | 3720.6 samples/s | 58.1 steps/s
[Step=97000 Epoch=371.7] | Loss=0.00000 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.448 | L2-Norm(final)=12.312 | 4150.5 samples/s | 64.9 steps/s
[Step=97050 Epoch=371.9] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.431 | L2-Norm(final)=12.314 | 1503.8 samples/s | 23.5 steps/s
[Step=97100 Epoch=372.1] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.413 | L2-Norm(final)=12.315 | 3757.1 samples/s | 58.7 steps/s
[Step=97150 Epoch=372.2] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.396 | L2-Norm(final)=12.316 | 3714.6 samples/s | 58.0 steps/s
[Step=97200 Epoch=372.4] | Loss=0.00000 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.378 | L2-Norm(final)=12.317 | 3714.7 samples/s | 58.0 steps/s
[Step=97250 Epoch=372.6] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.360 | L2-Norm(final)=12.318 | 3733.6 samples/s | 58.3 steps/s
[Step=97300 Epoch=372.8] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.342 | L2-Norm(final)=12.319 | 1527.6 samples/s | 23.9 steps/s
[Step=97350 Epoch=373.0] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.325 | L2-Norm(final)=12.320 | 3751.3 samples/s | 58.6 steps/s
[Step=97400 Epoch=373.2] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.307 | L2-Norm(final)=12.321 | 3739.9 samples/s | 58.4 steps/s
[Step=97450 Epoch=373.4] | Loss=0.00000 | Reg=0.00040 | acc=1.0000 | L2-Norm=6.289 | L2-Norm(final)=12.322 | 3650.7 samples/s | 57.0 steps/s
[Step=97500 Epoch=373.6] | Loss=0.00000 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.271 | L2-Norm(final)=12.324 | 3663.8 samples/s | 57.2 steps/s
[Step=97550 Epoch=373.8] | Loss=0.00000 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.253 | L2-Norm(final)=12.325 | 1597.9 samples/s | 25.0 steps/s
[Step=97600 Epoch=374.0] | Loss=0.00000 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.236 | L2-Norm(final)=12.326 | 3651.7 samples/s | 57.1 steps/s
[Step=97650 Epoch=374.2] | Loss=0.00000 | Reg=0.00039 | acc=1.0000 | L2-Norm=6.218 | L2-Norm(final)=12.328 | 3717.3 samples/s | 58.1 steps/s
[Step=97700 Epoch=374.4] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.200 | L2-Norm(final)=12.329 | 3683.4 samples/s | 57.6 steps/s
[Step=97750 Epoch=374.5] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.182 | L2-Norm(final)=12.330 | 3710.2 samples/s | 58.0 steps/s
[Step=97800 Epoch=374.7] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.164 | L2-Norm(final)=12.332 | 5054.4 samples/s | 79.0 steps/s
[Step=97850 Epoch=374.9] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.146 | L2-Norm(final)=12.333 | 1418.3 samples/s | 22.2 steps/s
[Step=97900 Epoch=375.1] | Loss=0.00000 | Reg=0.00038 | acc=1.0000 | L2-Norm=6.128 | L2-Norm(final)=12.335 | 3664.8 samples/s | 57.3 steps/s
[Step=97950 Epoch=375.3] | Loss=0.00000 | Reg=0.00037 | acc=1.0000 | L2-Norm=6.110 | L2-Norm(final)=12.336 | 3664.4 samples/s | 57.3 steps/s
[Step=98000 Epoch=375.5] | Loss=0.00000 | Reg=0.00037 | acc=1.0000 | L2-Norm=6.093 | L2-Norm(final)=12.338 | 3712.7 samples/s | 58.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step98000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=96001 Epoch=369.5] | Loss=0.00003 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.666 | L2-Norm(final)=11.995 | 3031.1 samples/s | 47.4 steps/s
[Step=96050 Epoch=369.7] | Loss=0.00028 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.670 | L2-Norm(final)=12.005 | 4180.2 samples/s | 65.3 steps/s
[Step=96100 Epoch=369.9] | Loss=0.00017 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.678 | L2-Norm(final)=12.011 | 4102.3 samples/s | 64.1 steps/s
[Step=96150 Epoch=370.1] | Loss=0.00012 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.681 | L2-Norm(final)=12.016 | 4113.3 samples/s | 64.3 steps/s
[Step=96200 Epoch=370.3] | Loss=0.00011 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.682 | L2-Norm(final)=12.020 | 4084.3 samples/s | 63.8 steps/s
[Step=96250 Epoch=370.5] | Loss=0.00010 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.683 | L2-Norm(final)=12.024 | 5516.2 samples/s | 86.2 steps/s
[Step=96300 Epoch=370.7] | Loss=0.00010 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.684 | L2-Norm(final)=12.028 | 1510.5 samples/s | 23.6 steps/s
[Step=96350 Epoch=370.9] | Loss=0.00009 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.685 | L2-Norm(final)=12.032 | 4115.3 samples/s | 64.3 steps/s
[Step=96400 Epoch=371.1] | Loss=0.00008 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.685 | L2-Norm(final)=12.036 | 4195.8 samples/s | 65.6 steps/s
[Step=96450 Epoch=371.3] | Loss=0.00008 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.686 | L2-Norm(final)=12.039 | 4067.0 samples/s | 63.5 steps/s
[Step=96500 Epoch=371.5] | Loss=0.00007 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.686 | L2-Norm(final)=12.043 | 4708.7 samples/s | 73.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=96501 Epoch=371.5] | Loss=0.00017 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.687 | L2-Norm(final)=12.075 | 3208.7 samples/s | 50.1 steps/s
[Step=96550 Epoch=371.7] | Loss=0.00004 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.689 | L2-Norm(final)=12.078 | 3511.2 samples/s | 54.9 steps/s
[Step=96600 Epoch=371.9] | Loss=0.00003 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.687 | L2-Norm(final)=12.081 | 3726.2 samples/s | 58.2 steps/s
[Step=96650 Epoch=372.0] | Loss=0.00003 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.687 | L2-Norm(final)=12.083 | 3697.9 samples/s | 57.8 steps/s
[Step=96700 Epoch=372.2] | Loss=0.00003 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.685 | L2-Norm(final)=12.085 | 3682.5 samples/s | 57.5 steps/s
[Step=96750 Epoch=372.4] | Loss=0.00002 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.682 | L2-Norm(final)=12.087 | 4790.8 samples/s | 74.9 steps/s
[Step=96800 Epoch=372.6] | Loss=0.00002 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.679 | L2-Norm(final)=12.088 | 1442.9 samples/s | 22.5 steps/s
[Step=96850 Epoch=372.8] | Loss=0.00002 | Reg=0.00045 | acc=1.0000 | L2-Norm=6.675 | L2-Norm(final)=12.089 | 3744.8 samples/s | 58.5 steps/s
[Step=96900 Epoch=373.0] | Loss=0.00002 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.670 | L2-Norm(final)=12.090 | 3642.9 samples/s | 56.9 steps/s
[Step=96950 Epoch=373.2] | Loss=0.00001 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.666 | L2-Norm(final)=12.091 | 3729.2 samples/s | 58.3 steps/s
[Step=97000 Epoch=373.4] | Loss=0.00001 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.661 | L2-Norm(final)=12.092 | 4209.0 samples/s | 65.8 steps/s
[Step=97050 Epoch=373.6] | Loss=0.00001 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.656 | L2-Norm(final)=12.093 | 1504.0 samples/s | 23.5 steps/s
[Step=97100 Epoch=373.8] | Loss=0.00001 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.651 | L2-Norm(final)=12.093 | 3717.3 samples/s | 58.1 steps/s
[Step=97150 Epoch=374.0] | Loss=0.00001 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.645 | L2-Norm(final)=12.094 | 3747.4 samples/s | 58.6 steps/s
[Step=97200 Epoch=374.2] | Loss=0.00001 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.640 | L2-Norm(final)=12.095 | 3716.7 samples/s | 58.1 steps/s
[Step=97250 Epoch=374.4] | Loss=0.00001 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.634 | L2-Norm(final)=12.095 | 3761.2 samples/s | 58.8 steps/s
[Step=97300 Epoch=374.5] | Loss=0.00001 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.629 | L2-Norm(final)=12.096 | 1578.3 samples/s | 24.7 steps/s
[Step=97350 Epoch=374.7] | Loss=0.00001 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.623 | L2-Norm(final)=12.097 | 3753.7 samples/s | 58.7 steps/s
[Step=97400 Epoch=374.9] | Loss=0.00001 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.617 | L2-Norm(final)=12.097 | 3698.2 samples/s | 57.8 steps/s
[Step=97450 Epoch=375.1] | Loss=0.00001 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.611 | L2-Norm(final)=12.098 | 3734.8 samples/s | 58.4 steps/s
[Step=97500 Epoch=375.3] | Loss=0.00001 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.606 | L2-Norm(final)=12.098 | 3726.8 samples/s | 58.2 steps/s
[Step=97550 Epoch=375.5] | Loss=0.00001 | Reg=0.00044 | acc=1.0000 | L2-Norm=6.599 | L2-Norm(final)=12.099 | 1579.6 samples/s | 24.7 steps/s
[Step=97600 Epoch=375.7] | Loss=0.00001 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.593 | L2-Norm(final)=12.099 | 3768.8 samples/s | 58.9 steps/s
[Step=97650 Epoch=375.9] | Loss=0.00001 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.587 | L2-Norm(final)=12.100 | 3739.1 samples/s | 58.4 steps/s
[Step=97700 Epoch=376.1] | Loss=0.00001 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.581 | L2-Norm(final)=12.101 | 3740.6 samples/s | 58.4 steps/s
[Step=97750 Epoch=376.3] | Loss=0.00001 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.575 | L2-Norm(final)=12.101 | 3700.5 samples/s | 57.8 steps/s
[Step=97800 Epoch=376.5] | Loss=0.00001 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.568 | L2-Norm(final)=12.102 | 5483.6 samples/s | 85.7 steps/s
[Step=97850 Epoch=376.7] | Loss=0.00001 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.562 | L2-Norm(final)=12.102 | 1400.3 samples/s | 21.9 steps/s
[Step=97900 Epoch=376.9] | Loss=0.00001 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.555 | L2-Norm(final)=12.103 | 3683.4 samples/s | 57.6 steps/s
[Step=97950 Epoch=377.0] | Loss=0.00001 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.548 | L2-Norm(final)=12.104 | 3681.6 samples/s | 57.5 steps/s
[Step=98000 Epoch=377.2] | Loss=0.00001 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.542 | L2-Norm(final)=12.104 | 3766.1 samples/s | 58.8 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step98000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05578 | acc=0.9650 | tpr=0.9630 | fpr=0.0307 | 3533.8 samples/s | 13.8 steps/s
Avg test loss: 0.05984, Avg test acc: 0.96266, Avg tpr: 0.96060, Avg fpr: 0.03282, total FA: 256

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05094 | acc=0.9689 | tpr=0.9754 | fpr=0.0451 | 3520.9 samples/s | 13.8 steps/s
Avg test loss: 0.05472, Avg test acc: 0.96694, Avg tpr: 0.97465, Avg fpr: 0.04999, total FA: 390

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.49912 | acc=0.3130 | tpr=0.0091 | fpr=0.0273 | 3522.1 samples/s | 13.8 steps/s
Avg test loss: 5.51947, Avg test acc: 0.30992, Avg tpr: 0.00863, Avg fpr: 0.02743, total FA: 214

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.13605 | acc=0.3121 | tpr=0.0185 | fpr=0.0503 | 3590.1 samples/s | 14.0 steps/s
Avg test loss: 5.15121, Avg test acc: 0.30936, Avg tpr: 0.01818, Avg fpr: 0.05025, total FA: 392

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.03438 | acc=0.1296 | tpr=0.8761 | fpr=0.8838 | 3527.2 samples/s | 13.8 steps/s
[Step= 100] | Loss=4.01554 | acc=0.1320 | tpr=0.9019 | fpr=0.8824 | 6951.8 samples/s | 27.2 steps/s
[Step= 150] | Loss=4.02478 | acc=0.1315 | tpr=0.9078 | fpr=0.8828 | 6769.3 samples/s | 26.4 steps/s
[Step= 200] | Loss=4.01320 | acc=0.1319 | tpr=0.8973 | fpr=0.8821 | 6963.5 samples/s | 27.2 steps/s
[Step= 250] | Loss=4.01934 | acc=0.1319 | tpr=0.8838 | fpr=0.8818 | 6675.9 samples/s | 26.1 steps/s
[Step= 300] | Loss=4.01927 | acc=0.1315 | tpr=0.8800 | fpr=0.8822 | 6839.3 samples/s | 26.7 steps/s
[Step= 350] | Loss=4.01655 | acc=0.1320 | tpr=0.8842 | fpr=0.8816 | 6697.9 samples/s | 26.2 steps/s
[Step= 400] | Loss=4.01503 | acc=0.1319 | tpr=0.8780 | fpr=0.8816 | 7094.9 samples/s | 27.7 steps/s
[Step= 450] | Loss=4.02039 | acc=0.1314 | tpr=0.8778 | fpr=0.8822 | 6498.1 samples/s | 25.4 steps/s
[Step= 500] | Loss=4.02136 | acc=0.1312 | tpr=0.8793 | fpr=0.8823 | 6580.7 samples/s | 25.7 steps/s
[Step= 550] | Loss=4.02089 | acc=0.1313 | tpr=0.8790 | fpr=0.8823 | 12142.5 samples/s | 47.4 steps/s
Avg test loss: 4.02139, Avg test acc: 0.13126, Avg tpr: 0.87876, Avg fpr: 0.88233, total FA: 122510

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.83564 | acc=0.1176 | tpr=0.8761 | fpr=0.8961 | 3444.3 samples/s | 13.5 steps/s
[Step= 100] | Loss=4.80922 | acc=0.1186 | tpr=0.8998 | fpr=0.8960 | 6919.9 samples/s | 27.0 steps/s
[Step= 150] | Loss=4.82065 | acc=0.1178 | tpr=0.9121 | fpr=0.8968 | 6942.9 samples/s | 27.1 steps/s
[Step= 200] | Loss=4.80986 | acc=0.1177 | tpr=0.9005 | fpr=0.8966 | 6760.9 samples/s | 26.4 steps/s
[Step= 250] | Loss=4.81642 | acc=0.1172 | tpr=0.8873 | fpr=0.8968 | 7165.1 samples/s | 28.0 steps/s
[Step= 300] | Loss=4.81742 | acc=0.1164 | tpr=0.8815 | fpr=0.8976 | 6528.4 samples/s | 25.5 steps/s
[Step= 350] | Loss=4.81518 | acc=0.1170 | tpr=0.8854 | fpr=0.8970 | 6966.0 samples/s | 27.2 steps/s
[Step= 400] | Loss=4.81302 | acc=0.1167 | tpr=0.8813 | fpr=0.8972 | 6619.8 samples/s | 25.9 steps/s
[Step= 450] | Loss=4.81992 | acc=0.1163 | tpr=0.8817 | fpr=0.8976 | 6797.8 samples/s | 26.6 steps/s
[Step= 500] | Loss=4.82105 | acc=0.1162 | tpr=0.8846 | fpr=0.8977 | 6886.8 samples/s | 26.9 steps/s
[Step= 550] | Loss=4.82035 | acc=0.1163 | tpr=0.8846 | fpr=0.8977 | 12386.6 samples/s | 48.4 steps/s
Avg test loss: 4.82085, Avg test acc: 0.11622, Avg tpr: 0.88431, Avg fpr: 0.89774, total FA: 124650

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08616 | acc=0.9841 | tpr=0.9469 | fpr=0.0152 | 3569.5 samples/s | 13.9 steps/s
[Step= 100] | Loss=0.08997 | acc=0.9838 | tpr=0.9574 | fpr=0.0157 | 6667.7 samples/s | 26.0 steps/s
[Step= 150] | Loss=0.09320 | acc=0.9828 | tpr=0.9582 | fpr=0.0168 | 6710.1 samples/s | 26.2 steps/s
[Step= 200] | Loss=0.09461 | acc=0.9827 | tpr=0.9617 | fpr=0.0169 | 6999.1 samples/s | 27.3 steps/s
[Step= 250] | Loss=0.09388 | acc=0.9829 | tpr=0.9581 | fpr=0.0166 | 6752.1 samples/s | 26.4 steps/s
[Step= 300] | Loss=0.09539 | acc=0.9826 | tpr=0.9571 | fpr=0.0169 | 6953.7 samples/s | 27.2 steps/s
[Step= 350] | Loss=0.09571 | acc=0.9825 | tpr=0.9580 | fpr=0.0171 | 6936.7 samples/s | 27.1 steps/s
[Step= 400] | Loss=0.09702 | acc=0.9822 | tpr=0.9530 | fpr=0.0173 | 6795.1 samples/s | 26.5 steps/s
[Step= 450] | Loss=0.09890 | acc=0.9818 | tpr=0.9518 | fpr=0.0177 | 6755.6 samples/s | 26.4 steps/s
[Step= 500] | Loss=0.09846 | acc=0.9818 | tpr=0.9542 | fpr=0.0177 | 6617.6 samples/s | 25.9 steps/s
[Step= 550] | Loss=0.09769 | acc=0.9820 | tpr=0.9522 | fpr=0.0175 | 12779.0 samples/s | 49.9 steps/s
Avg test loss: 0.09753, Avg test acc: 0.98198, Avg tpr: 0.95206, Avg fpr: 0.01748, total FA: 2427

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10583 | acc=0.9813 | tpr=0.9558 | fpr=0.0182 | 3549.3 samples/s | 13.9 steps/s
[Step= 100] | Loss=0.11104 | acc=0.9806 | tpr=0.9638 | fpr=0.0191 | 6645.9 samples/s | 26.0 steps/s
[Step= 150] | Loss=0.11493 | acc=0.9795 | tpr=0.9683 | fpr=0.0203 | 7016.0 samples/s | 27.4 steps/s
[Step= 200] | Loss=0.11672 | acc=0.9791 | tpr=0.9672 | fpr=0.0207 | 6652.7 samples/s | 26.0 steps/s
[Step= 250] | Loss=0.11573 | acc=0.9794 | tpr=0.9642 | fpr=0.0203 | 7153.8 samples/s | 27.9 steps/s
[Step= 300] | Loss=0.11744 | acc=0.9791 | tpr=0.9644 | fpr=0.0206 | 6771.9 samples/s | 26.5 steps/s
[Step= 350] | Loss=0.11751 | acc=0.9791 | tpr=0.9649 | fpr=0.0207 | 6966.0 samples/s | 27.2 steps/s
[Step= 400] | Loss=0.11874 | acc=0.9788 | tpr=0.9623 | fpr=0.0209 | 6857.7 samples/s | 26.8 steps/s
[Step= 450] | Loss=0.12103 | acc=0.9784 | tpr=0.9606 | fpr=0.0212 | 6941.2 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.12070 | acc=0.9785 | tpr=0.9626 | fpr=0.0212 | 6813.3 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.11975 | acc=0.9788 | tpr=0.9614 | fpr=0.0209 | 12835.3 samples/s | 50.1 steps/s
Avg test loss: 0.11968, Avg test acc: 0.97876, Avg tpr: 0.96078, Avg fpr: 0.02091, total FA: 2904

server round 49/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=98001 Epoch=191.1] | Loss=0.05341 | Reg=0.00042 | acc=0.9688 | L2-Norm=6.480 | L2-Norm(final)=17.195 | 3058.2 samples/s | 47.8 steps/s
[Step=98050 Epoch=191.2] | Loss=0.03208 | Reg=0.00042 | acc=0.9688 | L2-Norm=6.491 | L2-Norm(final)=17.199 | 4305.5 samples/s | 67.3 steps/s
[Step=98100 Epoch=191.3] | Loss=0.03124 | Reg=0.00042 | acc=0.9844 | L2-Norm=6.501 | L2-Norm(final)=17.204 | 4268.6 samples/s | 66.7 steps/s
[Step=98150 Epoch=191.4] | Loss=0.03064 | Reg=0.00042 | acc=0.9844 | L2-Norm=6.510 | L2-Norm(final)=17.208 | 4382.6 samples/s | 68.5 steps/s
[Step=98200 Epoch=191.5] | Loss=0.03052 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.518 | L2-Norm(final)=17.213 | 4316.0 samples/s | 67.4 steps/s
[Step=98250 Epoch=191.6] | Loss=0.02921 | Reg=0.00043 | acc=0.9844 | L2-Norm=6.526 | L2-Norm(final)=17.217 | 4349.8 samples/s | 68.0 steps/s
[Step=98300 Epoch=191.7] | Loss=0.02884 | Reg=0.00043 | acc=0.9688 | L2-Norm=6.533 | L2-Norm(final)=17.221 | 4387.2 samples/s | 68.5 steps/s
[Step=98350 Epoch=191.8] | Loss=0.02877 | Reg=0.00043 | acc=0.9844 | L2-Norm=6.541 | L2-Norm(final)=17.225 | 4407.9 samples/s | 68.9 steps/s
[Step=98400 Epoch=191.9] | Loss=0.02841 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.548 | L2-Norm(final)=17.230 | 4452.8 samples/s | 69.6 steps/s
[Step=98450 Epoch=192.0] | Loss=0.02794 | Reg=0.00043 | acc=0.9531 | L2-Norm=6.555 | L2-Norm(final)=17.234 | 4313.0 samples/s | 67.4 steps/s
[Step=98500 Epoch=192.1] | Loss=0.02774 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.562 | L2-Norm(final)=17.238 | 5512.9 samples/s | 86.1 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_0/client_state-step98500.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=98001 Epoch=191.6] | Loss=0.02572 | Reg=0.00042 | acc=0.9844 | L2-Norm=6.480 | L2-Norm(final)=17.538 | 3346.0 samples/s | 52.3 steps/s
[Step=98050 Epoch=191.7] | Loss=0.03030 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.490 | L2-Norm(final)=17.543 | 4168.9 samples/s | 65.1 steps/s
[Step=98100 Epoch=191.8] | Loss=0.02984 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.500 | L2-Norm(final)=17.549 | 4309.6 samples/s | 67.3 steps/s
[Step=98150 Epoch=191.9] | Loss=0.02844 | Reg=0.00042 | acc=0.9688 | L2-Norm=6.509 | L2-Norm(final)=17.554 | 4378.8 samples/s | 68.4 steps/s
[Step=98200 Epoch=192.0] | Loss=0.02797 | Reg=0.00042 | acc=0.9531 | L2-Norm=6.519 | L2-Norm(final)=17.560 | 4285.9 samples/s | 67.0 steps/s
[Step=98250 Epoch=192.1] | Loss=0.02796 | Reg=0.00043 | acc=0.9844 | L2-Norm=6.527 | L2-Norm(final)=17.565 | 4391.9 samples/s | 68.6 steps/s
[Step=98300 Epoch=192.2] | Loss=0.02773 | Reg=0.00043 | acc=1.0000 | L2-Norm=6.535 | L2-Norm(final)=17.570 | 4298.1 samples/s | 67.2 steps/s
[Step=98350 Epoch=192.3] | Loss=0.02774 | Reg=0.00043 | acc=0.9688 | L2-Norm=6.543 | L2-Norm(final)=17.575 | 4405.3 samples/s | 68.8 steps/s
[Step=98400 Epoch=192.4] | Loss=0.02803 | Reg=0.00043 | acc=0.9844 | L2-Norm=6.550 | L2-Norm(final)=17.579 | 4318.4 samples/s | 67.5 steps/s
[Step=98450 Epoch=192.5] | Loss=0.02747 | Reg=0.00043 | acc=0.9688 | L2-Norm=6.558 | L2-Norm(final)=17.584 | 4388.4 samples/s | 68.6 steps/s
[Step=98500 Epoch=192.6] | Loss=0.02718 | Reg=0.00043 | acc=0.9844 | L2-Norm=6.564 | L2-Norm(final)=17.588 | 5471.7 samples/s | 85.5 steps/s
Client model saved at models/model-a2i2_sr1.0/client_asml1_1/client_state-step98500.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=98001 Epoch=375.5] | Loss=0.00002 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.480 | L2-Norm(final)=12.389 | 3151.3 samples/s | 49.2 steps/s
[Step=98050 Epoch=375.7] | Loss=0.00005 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.472 | L2-Norm(final)=12.401 | 3973.9 samples/s | 62.1 steps/s
[Step=98100 Epoch=375.9] | Loss=0.00003 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.468 | L2-Norm(final)=12.411 | 4164.0 samples/s | 65.1 steps/s
[Step=98150 Epoch=376.1] | Loss=0.00003 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.462 | L2-Norm(final)=12.418 | 4060.4 samples/s | 63.4 steps/s
[Step=98200 Epoch=376.3] | Loss=0.00002 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.456 | L2-Norm(final)=12.424 | 4214.2 samples/s | 65.8 steps/s
[Step=98250 Epoch=376.5] | Loss=0.00002 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.451 | L2-Norm(final)=12.430 | 5200.4 samples/s | 81.3 steps/s
[Step=98300 Epoch=376.7] | Loss=0.00002 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.445 | L2-Norm(final)=12.436 | 1519.1 samples/s | 23.7 steps/s
[Step=98350 Epoch=376.8] | Loss=0.00002 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.439 | L2-Norm(final)=12.441 | 4045.4 samples/s | 63.2 steps/s
[Step=98400 Epoch=377.0] | Loss=0.00002 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.434 | L2-Norm(final)=12.447 | 4123.4 samples/s | 64.4 steps/s
[Step=98450 Epoch=377.2] | Loss=0.00002 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.428 | L2-Norm(final)=12.452 | 4116.0 samples/s | 64.3 steps/s
[Step=98500 Epoch=377.4] | Loss=0.00001 | Reg=0.00041 | acc=1.0000 | L2-Norm=6.423 | L2-Norm(final)=12.456 | 4541.9 samples/s | 71.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_0/client_state-step98500.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=98001 Epoch=377.2] | Loss=0.00037 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.480 | L2-Norm(final)=12.123 | 3213.9 samples/s | 50.2 steps/s
[Step=98050 Epoch=377.4] | Loss=0.00056 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.484 | L2-Norm(final)=12.133 | 3903.0 samples/s | 61.0 steps/s
[Step=98100 Epoch=377.6] | Loss=0.00035 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.496 | L2-Norm(final)=12.139 | 4152.9 samples/s | 64.9 steps/s
[Step=98150 Epoch=377.8] | Loss=0.00026 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.501 | L2-Norm(final)=12.142 | 4115.1 samples/s | 64.3 steps/s
[Step=98200 Epoch=378.0] | Loss=0.00021 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.503 | L2-Norm(final)=12.144 | 4198.3 samples/s | 65.6 steps/s
[Step=98250 Epoch=378.2] | Loss=0.00018 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.504 | L2-Norm(final)=12.147 | 5474.2 samples/s | 85.5 steps/s
[Step=98300 Epoch=378.4] | Loss=0.00016 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.505 | L2-Norm(final)=12.149 | 1500.4 samples/s | 23.4 steps/s
[Step=98350 Epoch=378.6] | Loss=0.00015 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.506 | L2-Norm(final)=12.151 | 4077.5 samples/s | 63.7 steps/s
[Step=98400 Epoch=378.8] | Loss=0.00014 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.507 | L2-Norm(final)=12.153 | 4184.4 samples/s | 65.4 steps/s
[Step=98450 Epoch=379.0] | Loss=0.00013 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.507 | L2-Norm(final)=12.154 | 4157.3 samples/s | 65.0 steps/s
[Step=98500 Epoch=379.2] | Loss=0.00012 | Reg=0.00042 | acc=1.0000 | L2-Norm=6.507 | L2-Norm(final)=12.156 | 4671.6 samples/s | 73.0 steps/s
Client model saved at models/model-a2i2_sr1.0/client_iccad2012_1/client_state-step98500.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05164 | acc=0.9638 | tpr=0.9703 | fpr=0.0503 | 3549.7 samples/s | 13.9 steps/s
Avg test loss: 0.05375, Avg test acc: 0.96310, Avg tpr: 0.97080, Avg fpr: 0.05384, total FA: 420

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05236 | acc=0.9637 | tpr=0.9675 | fpr=0.0444 | 3495.3 samples/s | 13.7 steps/s
Avg test loss: 0.05448, Avg test acc: 0.96282, Avg tpr: 0.96788, Avg fpr: 0.04833, total FA: 377

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.32886 | acc=0.3105 | tpr=0.0116 | fpr=0.0406 | 3550.8 samples/s | 13.9 steps/s
Avg test loss: 5.34270, Avg test acc: 0.30748, Avg tpr: 0.01172, Avg fpr: 0.04205, total FA: 328

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.30400 | acc=0.3145 | tpr=0.0233 | fpr=0.0530 | 3535.1 samples/s | 13.8 steps/s
Avg test loss: 4.31649, Avg test acc: 0.31180, Avg tpr: 0.02314, Avg fpr: 0.05333, total FA: 416

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.43084 | acc=0.1142 | tpr=0.8938 | fpr=0.8998 | 3505.3 samples/s | 13.7 steps/s
[Step= 100] | Loss=3.41582 | acc=0.1164 | tpr=0.9190 | fpr=0.8986 | 6896.4 samples/s | 26.9 steps/s
[Step= 150] | Loss=3.42322 | acc=0.1160 | tpr=0.9294 | fpr=0.8990 | 6779.2 samples/s | 26.5 steps/s
[Step= 200] | Loss=3.41487 | acc=0.1160 | tpr=0.9191 | fpr=0.8987 | 6880.9 samples/s | 26.9 steps/s
[Step= 250] | Loss=3.41935 | acc=0.1160 | tpr=0.9100 | fpr=0.8985 | 6907.8 samples/s | 27.0 steps/s
[Step= 300] | Loss=3.41926 | acc=0.1153 | tpr=0.9084 | fpr=0.8991 | 6970.3 samples/s | 27.2 steps/s
[Step= 350] | Loss=3.41720 | acc=0.1158 | tpr=0.9105 | fpr=0.8986 | 6799.5 samples/s | 26.6 steps/s
[Step= 400] | Loss=3.41584 | acc=0.1157 | tpr=0.9103 | fpr=0.8987 | 6822.1 samples/s | 26.6 steps/s
[Step= 450] | Loss=3.42060 | acc=0.1150 | tpr=0.9085 | fpr=0.8994 | 6833.4 samples/s | 26.7 steps/s
[Step= 500] | Loss=3.42165 | acc=0.1151 | tpr=0.9110 | fpr=0.8993 | 6753.4 samples/s | 26.4 steps/s
[Step= 550] | Loss=3.42049 | acc=0.1152 | tpr=0.9097 | fpr=0.8992 | 12363.1 samples/s | 48.3 steps/s
Avg test loss: 3.42095, Avg test acc: 0.11516, Avg tpr: 0.90927, Avg fpr: 0.89927, total FA: 124862

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.47870 | acc=0.1187 | tpr=0.8761 | fpr=0.8949 | 3574.5 samples/s | 14.0 steps/s
[Step= 100] | Loss=3.46427 | acc=0.1207 | tpr=0.9062 | fpr=0.8939 | 6675.3 samples/s | 26.1 steps/s
[Step= 150] | Loss=3.47271 | acc=0.1201 | tpr=0.9236 | fpr=0.8947 | 6871.4 samples/s | 26.8 steps/s
[Step= 200] | Loss=3.46386 | acc=0.1202 | tpr=0.9158 | fpr=0.8942 | 7220.1 samples/s | 28.2 steps/s
[Step= 250] | Loss=3.46892 | acc=0.1201 | tpr=0.9083 | fpr=0.8943 | 6641.5 samples/s | 25.9 steps/s
[Step= 300] | Loss=3.46946 | acc=0.1195 | tpr=0.9040 | fpr=0.8948 | 6736.2 samples/s | 26.3 steps/s
[Step= 350] | Loss=3.46732 | acc=0.1199 | tpr=0.9073 | fpr=0.8944 | 6951.0 samples/s | 27.2 steps/s
[Step= 400] | Loss=3.46605 | acc=0.1198 | tpr=0.9065 | fpr=0.8945 | 6813.0 samples/s | 26.6 steps/s
[Step= 450] | Loss=3.47098 | acc=0.1192 | tpr=0.9051 | fpr=0.8950 | 6649.1 samples/s | 26.0 steps/s
[Step= 500] | Loss=3.47217 | acc=0.1193 | tpr=0.9070 | fpr=0.8949 | 6778.6 samples/s | 26.5 steps/s
[Step= 550] | Loss=3.47089 | acc=0.1195 | tpr=0.9061 | fpr=0.8948 | 12485.6 samples/s | 48.8 steps/s
Avg test loss: 3.47132, Avg test acc: 0.11944, Avg tpr: 0.90571, Avg fpr: 0.89486, total FA: 124249

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.08747 | acc=0.9833 | tpr=0.9425 | fpr=0.0160 | 3486.3 samples/s | 13.6 steps/s
[Step= 100] | Loss=0.09113 | acc=0.9830 | tpr=0.9552 | fpr=0.0165 | 6800.7 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.09384 | acc=0.9822 | tpr=0.9597 | fpr=0.0174 | 6680.5 samples/s | 26.1 steps/s
[Step= 200] | Loss=0.09512 | acc=0.9820 | tpr=0.9596 | fpr=0.0176 | 6929.4 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.09453 | acc=0.9823 | tpr=0.9572 | fpr=0.0172 | 6623.9 samples/s | 25.9 steps/s
[Step= 300] | Loss=0.09576 | acc=0.9822 | tpr=0.9564 | fpr=0.0174 | 6883.5 samples/s | 26.9 steps/s
[Step= 350] | Loss=0.09580 | acc=0.9821 | tpr=0.9568 | fpr=0.0174 | 6988.6 samples/s | 27.3 steps/s
[Step= 400] | Loss=0.09706 | acc=0.9819 | tpr=0.9546 | fpr=0.0176 | 4213.9 samples/s | 16.5 steps/s
[Step= 450] | Loss=0.09905 | acc=0.9816 | tpr=0.9533 | fpr=0.0179 | 6970.0 samples/s | 27.2 steps/s
[Step= 500] | Loss=0.09858 | acc=0.9816 | tpr=0.9559 | fpr=0.0179 | 6809.3 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.09785 | acc=0.9818 | tpr=0.9554 | fpr=0.0177 | 12085.3 samples/s | 47.2 steps/s
Avg test loss: 0.09775, Avg test acc: 0.98178, Avg tpr: 0.95483, Avg fpr: 0.01773, total FA: 2462

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09773 | acc=0.9798 | tpr=0.9558 | fpr=0.0198 | 3498.6 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.10172 | acc=0.9793 | tpr=0.9659 | fpr=0.0204 | 6859.1 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.10529 | acc=0.9783 | tpr=0.9697 | fpr=0.0216 | 6775.9 samples/s | 26.5 steps/s
[Step= 200] | Loss=0.10677 | acc=0.9780 | tpr=0.9716 | fpr=0.0219 | 6821.6 samples/s | 26.6 steps/s
[Step= 250] | Loss=0.10588 | acc=0.9785 | tpr=0.9694 | fpr=0.0214 | 7088.1 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.10727 | acc=0.9782 | tpr=0.9687 | fpr=0.0217 | 6671.4 samples/s | 26.1 steps/s
[Step= 350] | Loss=0.10759 | acc=0.9780 | tpr=0.9687 | fpr=0.0218 | 6281.7 samples/s | 24.5 steps/s
[Step= 400] | Loss=0.10895 | acc=0.9777 | tpr=0.9661 | fpr=0.0221 | 4795.2 samples/s | 18.7 steps/s
[Step= 450] | Loss=0.11103 | acc=0.9774 | tpr=0.9645 | fpr=0.0224 | 6904.5 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.11073 | acc=0.9774 | tpr=0.9661 | fpr=0.0224 | 6668.6 samples/s | 26.0 steps/s
[Step= 550] | Loss=0.10978 | acc=0.9777 | tpr=0.9658 | fpr=0.0221 | 12772.7 samples/s | 49.9 steps/s
Avg test loss: 0.10970, Avg test acc: 0.97769, Avg tpr: 0.96513, Avg fpr: 0.02208, total FA: 3066
