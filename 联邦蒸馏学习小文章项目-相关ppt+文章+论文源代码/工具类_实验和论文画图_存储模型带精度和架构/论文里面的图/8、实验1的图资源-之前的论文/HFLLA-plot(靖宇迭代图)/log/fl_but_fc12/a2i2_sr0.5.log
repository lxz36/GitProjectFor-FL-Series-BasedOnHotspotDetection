#clients of iccad2012: 2
#clients of asml1: 2
select ratio: 0.5
Total num clients: 4
client model path: ['models/model-a2i2_sr0.5/client_asml1_0', 'models/model-a2i2_sr0.5/client_asml1_1', 'models/model-a2i2_sr0.5/client_iccad2012_0', 'models/model-a2i2_sr0.5/client_iccad2012_1']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32814, 144, 32)
Using transform option: train
#pos = 17102, #neg = 15712
Allocated dataset with size (24958, 144, 32)
Resampled dataset to size (32737, 144, 32)
Using transform option: train
#pos = 17179, #neg = 15558
loading data into the main memory...
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16703, 144, 32)
Using transform option: train
#pos = 8134, #neg = 8569
Allocated dataset with size (9150, 144, 32)
Resampled dataset to size (16626, 144, 32)
Using transform option: train
#pos = 8099, #neg = 8527
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34742 | Reg=0.00359 | acc=0.5469 | L2-Norm=18.949 | L2-Norm(final)=1.966 | 2862.6 samples/s | 44.7 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.32272 | Reg=0.00344 | acc=0.7500 | L2-Norm=18.552 | L2-Norm(final)=1.961 | 6261.2 samples/s | 97.8 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.31062 | Reg=0.00337 | acc=0.5938 | L2-Norm=18.363 | L2-Norm(final)=1.975 | 6059.9 samples/s | 94.7 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.30465 | Reg=0.00333 | acc=0.7500 | L2-Norm=18.246 | L2-Norm(final)=1.989 | 5959.4 samples/s | 93.1 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.29814 | Reg=0.00330 | acc=0.6562 | L2-Norm=18.166 | L2-Norm(final)=2.004 | 5844.5 samples/s | 91.3 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.29267 | Reg=0.00328 | acc=0.7188 | L2-Norm=18.113 | L2-Norm(final)=2.024 | 6156.9 samples/s | 96.2 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.28708 | Reg=0.00327 | acc=0.6875 | L2-Norm=18.082 | L2-Norm(final)=2.045 | 6006.9 samples/s | 93.9 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.28457 | Reg=0.00326 | acc=0.7344 | L2-Norm=18.063 | L2-Norm(final)=2.068 | 6247.7 samples/s | 97.6 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.28090 | Reg=0.00326 | acc=0.7812 | L2-Norm=18.052 | L2-Norm(final)=2.089 | 5841.9 samples/s | 91.3 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.27709 | Reg=0.00326 | acc=0.7500 | L2-Norm=18.047 | L2-Norm(final)=2.111 | 6204.5 samples/s | 96.9 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.27469 | Reg=0.00326 | acc=0.7344 | L2-Norm=18.047 | L2-Norm(final)=2.132 | 7718.9 samples/s | 120.6 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.0] | Loss=0.24911 | Reg=0.00326 | acc=0.7812 | L2-Norm=18.062 | L2-Norm(final)=2.351 | 3760.3 samples/s | 58.8 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.22387 | Reg=0.00327 | acc=0.8281 | L2-Norm=18.083 | L2-Norm(final)=2.367 | 5137.2 samples/s | 80.3 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.19694 | Reg=0.00328 | acc=0.8594 | L2-Norm=18.102 | L2-Norm(final)=2.383 | 5043.7 samples/s | 78.8 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.18321 | Reg=0.00328 | acc=0.8438 | L2-Norm=18.112 | L2-Norm(final)=2.394 | 5109.4 samples/s | 79.8 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.17433 | Reg=0.00328 | acc=0.8750 | L2-Norm=18.121 | L2-Norm(final)=2.402 | 5038.3 samples/s | 78.7 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.16675 | Reg=0.00329 | acc=0.9062 | L2-Norm=18.130 | L2-Norm(final)=2.408 | 5097.2 samples/s | 79.6 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.15839 | Reg=0.00329 | acc=0.9062 | L2-Norm=18.141 | L2-Norm(final)=2.414 | 5095.8 samples/s | 79.6 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.15077 | Reg=0.00330 | acc=0.9219 | L2-Norm=18.152 | L2-Norm(final)=2.420 | 5132.5 samples/s | 80.2 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.14557 | Reg=0.00330 | acc=0.9219 | L2-Norm=18.163 | L2-Norm(final)=2.426 | 5033.0 samples/s | 78.6 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.14217 | Reg=0.00330 | acc=0.8906 | L2-Norm=18.175 | L2-Norm(final)=2.431 | 5064.6 samples/s | 79.1 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.13794 | Reg=0.00331 | acc=0.9531 | L2-Norm=18.188 | L2-Norm(final)=2.436 | 6267.6 samples/s | 97.9 steps/s
[Step=1050 Epoch= 2.1] | Loss=0.13328 | Reg=0.00331 | acc=0.9219 | L2-Norm=18.201 | L2-Norm(final)=2.440 | 1945.5 samples/s | 30.4 steps/s
[Step=1100 Epoch= 2.2] | Loss=0.12777 | Reg=0.00332 | acc=0.9531 | L2-Norm=18.216 | L2-Norm(final)=2.446 | 5068.5 samples/s | 79.2 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.12423 | Reg=0.00332 | acc=0.9688 | L2-Norm=18.228 | L2-Norm(final)=2.452 | 5111.6 samples/s | 79.9 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.12126 | Reg=0.00333 | acc=0.9219 | L2-Norm=18.239 | L2-Norm(final)=2.456 | 4983.8 samples/s | 77.9 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.11807 | Reg=0.00333 | acc=0.8438 | L2-Norm=18.249 | L2-Norm(final)=2.461 | 5059.7 samples/s | 79.1 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.11496 | Reg=0.00333 | acc=0.9688 | L2-Norm=18.259 | L2-Norm(final)=2.465 | 5071.9 samples/s | 79.2 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.11252 | Reg=0.00334 | acc=0.9375 | L2-Norm=18.269 | L2-Norm(final)=2.470 | 5070.0 samples/s | 79.2 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.10994 | Reg=0.00334 | acc=0.9375 | L2-Norm=18.279 | L2-Norm(final)=2.474 | 5145.4 samples/s | 80.4 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.10773 | Reg=0.00335 | acc=0.9219 | L2-Norm=18.290 | L2-Norm(final)=2.478 | 4991.0 samples/s | 78.0 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.10568 | Reg=0.00335 | acc=0.9688 | L2-Norm=18.300 | L2-Norm(final)=2.482 | 5477.7 samples/s | 85.6 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.10365 | Reg=0.00335 | acc=0.9688 | L2-Norm=18.310 | L2-Norm(final)=2.485 | 2026.7 samples/s | 31.7 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.10153 | Reg=0.00336 | acc=0.9844 | L2-Norm=18.320 | L2-Norm(final)=2.489 | 5019.1 samples/s | 78.4 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.09915 | Reg=0.00336 | acc=0.9688 | L2-Norm=18.331 | L2-Norm(final)=2.493 | 5064.4 samples/s | 79.1 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.09747 | Reg=0.00336 | acc=0.9375 | L2-Norm=18.341 | L2-Norm(final)=2.496 | 5016.8 samples/s | 78.4 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.09561 | Reg=0.00337 | acc=0.9688 | L2-Norm=18.351 | L2-Norm(final)=2.499 | 5028.4 samples/s | 78.6 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.09410 | Reg=0.00337 | acc=0.9375 | L2-Norm=18.362 | L2-Norm(final)=2.502 | 5072.1 samples/s | 79.3 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.09259 | Reg=0.00338 | acc=0.9531 | L2-Norm=18.372 | L2-Norm(final)=2.505 | 5005.8 samples/s | 78.2 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.09121 | Reg=0.00338 | acc=0.9688 | L2-Norm=18.382 | L2-Norm(final)=2.508 | 5095.6 samples/s | 79.6 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.08978 | Reg=0.00338 | acc=0.9844 | L2-Norm=18.393 | L2-Norm(final)=2.511 | 5048.3 samples/s | 78.9 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.08880 | Reg=0.00339 | acc=0.9531 | L2-Norm=18.403 | L2-Norm(final)=2.514 | 5070.7 samples/s | 79.2 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step2000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34344 | Reg=0.00359 | acc=0.5625 | L2-Norm=18.949 | L2-Norm(final)=1.967 | 4117.0 samples/s | 64.3 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.22890 | Reg=0.00347 | acc=0.8750 | L2-Norm=18.624 | L2-Norm(final)=2.008 | 4953.0 samples/s | 77.4 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.18829 | Reg=0.00343 | acc=0.9062 | L2-Norm=18.519 | L2-Norm(final)=2.068 | 5683.7 samples/s | 88.8 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.17108 | Reg=0.00341 | acc=0.9531 | L2-Norm=18.462 | L2-Norm(final)=2.109 | 5703.8 samples/s | 89.1 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.15745 | Reg=0.00340 | acc=0.9688 | L2-Norm=18.432 | L2-Norm(final)=2.140 | 5704.4 samples/s | 89.1 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.14549 | Reg=0.00339 | acc=0.9219 | L2-Norm=18.411 | L2-Norm(final)=2.168 | 7813.2 samples/s | 122.1 steps/s
[Step= 300 Epoch= 1.2] | Loss=0.13667 | Reg=0.00338 | acc=0.9688 | L2-Norm=18.395 | L2-Norm(final)=2.196 | 1963.7 samples/s | 30.7 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.12970 | Reg=0.00338 | acc=0.9688 | L2-Norm=18.384 | L2-Norm(final)=2.222 | 5647.8 samples/s | 88.2 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.12395 | Reg=0.00338 | acc=0.9688 | L2-Norm=18.378 | L2-Norm(final)=2.247 | 5676.0 samples/s | 88.7 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.11942 | Reg=0.00338 | acc=0.9844 | L2-Norm=18.376 | L2-Norm(final)=2.273 | 5674.4 samples/s | 88.7 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.11603 | Reg=0.00338 | acc=0.9688 | L2-Norm=18.377 | L2-Norm(final)=2.298 | 6706.2 samples/s | 104.8 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.9] | Loss=0.03212 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.404 | L2-Norm(final)=2.543 | 3743.4 samples/s | 58.5 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.13044 | Reg=0.00339 | acc=0.9375 | L2-Norm=18.410 | L2-Norm(final)=2.509 | 4800.4 samples/s | 75.0 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.08525 | Reg=0.00340 | acc=0.9531 | L2-Norm=18.429 | L2-Norm(final)=2.524 | 4731.4 samples/s | 73.9 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.06259 | Reg=0.00340 | acc=0.9844 | L2-Norm=18.442 | L2-Norm(final)=2.542 | 4800.2 samples/s | 75.0 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.04990 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.445 | L2-Norm(final)=2.558 | 4784.7 samples/s | 74.8 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.04136 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.444 | L2-Norm(final)=2.572 | 6205.7 samples/s | 97.0 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.03514 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.440 | L2-Norm(final)=2.584 | 1859.1 samples/s | 29.0 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.03046 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.432 | L2-Norm(final)=2.593 | 4716.0 samples/s | 73.7 steps/s
[Step= 900 Epoch= 3.5] | Loss=0.02718 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.425 | L2-Norm(final)=2.602 | 4785.8 samples/s | 74.8 steps/s
[Step= 950 Epoch= 3.7] | Loss=0.02450 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.417 | L2-Norm(final)=2.610 | 4802.2 samples/s | 75.0 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.02252 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.409 | L2-Norm(final)=2.617 | 5452.5 samples/s | 85.2 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.02057 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.400 | L2-Norm(final)=2.624 | 1922.6 samples/s | 30.0 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.01891 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.390 | L2-Norm(final)=2.630 | 4806.7 samples/s | 75.1 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.01747 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.377 | L2-Norm(final)=2.635 | 4842.3 samples/s | 75.7 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.01625 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.363 | L2-Norm(final)=2.641 | 4777.1 samples/s | 74.6 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.01518 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.348 | L2-Norm(final)=2.645 | 4853.4 samples/s | 75.8 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.01425 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.331 | L2-Norm(final)=2.650 | 2011.6 samples/s | 31.4 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.01342 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.314 | L2-Norm(final)=2.654 | 4874.9 samples/s | 76.2 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.01268 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.295 | L2-Norm(final)=2.657 | 4829.1 samples/s | 75.5 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.01201 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.275 | L2-Norm(final)=2.661 | 4791.9 samples/s | 74.9 steps/s
[Step=1500 Epoch= 5.8] | Loss=0.01142 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.254 | L2-Norm(final)=2.664 | 4774.7 samples/s | 74.6 steps/s
[Step=1550 Epoch= 6.0] | Loss=0.01087 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.233 | L2-Norm(final)=2.667 | 2038.2 samples/s | 31.8 steps/s
[Step=1600 Epoch= 6.2] | Loss=0.01038 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.210 | L2-Norm(final)=2.670 | 4832.2 samples/s | 75.5 steps/s
[Step=1650 Epoch= 6.4] | Loss=0.00993 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.187 | L2-Norm(final)=2.672 | 4771.8 samples/s | 74.6 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.00952 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.164 | L2-Norm(final)=2.675 | 4788.9 samples/s | 74.8 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.00914 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.140 | L2-Norm(final)=2.677 | 4776.1 samples/s | 74.6 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.00879 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.115 | L2-Norm(final)=2.679 | 7063.6 samples/s | 110.4 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.00847 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.090 | L2-Norm(final)=2.681 | 1786.6 samples/s | 27.9 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00816 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.064 | L2-Norm(final)=2.683 | 4770.3 samples/s | 74.5 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00788 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.038 | L2-Norm(final)=2.685 | 4821.2 samples/s | 75.3 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00762 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.012 | L2-Norm(final)=2.687 | 4763.6 samples/s | 74.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step2000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.36175 | acc=0.4209 | tpr=0.3043 | fpr=0.3261 | 4412.6 samples/s | 17.2 steps/s
Avg test loss: 0.36236, Avg test acc: 0.42391, Avg tpr: 0.30845, Avg fpr: 0.32214, total FA: 2513

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07916 | acc=0.9418 | tpr=0.9403 | fpr=0.0550 | 4450.6 samples/s | 17.4 steps/s
Avg test loss: 0.08274, Avg test acc: 0.93970, Avg tpr: 0.93880, Avg fpr: 0.05833, total FA: 455

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=0.36175 | acc=0.4209 | tpr=0.3043 | fpr=0.3261 | 4476.7 samples/s | 17.5 steps/s
Avg test loss: 0.36236, Avg test acc: 0.42391, Avg tpr: 0.30845, Avg fpr: 0.32214, total FA: 2513

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.16564 | acc=0.3185 | tpr=0.0152 | fpr=0.0228 | 4476.3 samples/s | 17.5 steps/s
Avg test loss: 4.16613, Avg test acc: 0.31517, Avg tpr: 0.01463, Avg fpr: 0.02384, total FA: 186

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=0.33214 | acc=0.6381 | tpr=0.3496 | fpr=0.3567 | 4470.9 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.33221 | acc=0.6372 | tpr=0.3156 | fpr=0.3568 | 8766.4 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.33210 | acc=0.6348 | tpr=0.3127 | fpr=0.3593 | 8689.7 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.33223 | acc=0.6338 | tpr=0.3148 | fpr=0.3604 | 9201.1 samples/s | 35.9 steps/s
[Step= 250] | Loss=0.33219 | acc=0.6334 | tpr=0.3083 | fpr=0.3607 | 8706.0 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.33227 | acc=0.6338 | tpr=0.3149 | fpr=0.3604 | 8571.5 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.33218 | acc=0.6342 | tpr=0.3212 | fpr=0.3602 | 9387.1 samples/s | 36.7 steps/s
[Step= 400] | Loss=0.33217 | acc=0.6339 | tpr=0.3233 | fpr=0.3605 | 8399.7 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.33212 | acc=0.6347 | tpr=0.3189 | fpr=0.3595 | 8792.1 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.33209 | acc=0.6350 | tpr=0.3181 | fpr=0.3593 | 8991.8 samples/s | 35.1 steps/s
[Step= 550] | Loss=0.33213 | acc=0.6349 | tpr=0.3187 | fpr=0.3594 | 15798.5 samples/s | 61.7 steps/s
Avg test loss: 0.33212, Avg test acc: 0.63488, Avg tpr: 0.31854, Avg fpr: 0.35937, total FA: 49898

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=2.75757 | acc=0.0996 | tpr=0.7699 | fpr=0.9124 | 4464.7 samples/s | 17.4 steps/s
[Step= 100] | Loss=2.75566 | acc=0.1007 | tpr=0.7974 | fpr=0.9123 | 9109.1 samples/s | 35.6 steps/s
[Step= 150] | Loss=2.76097 | acc=0.0990 | tpr=0.8026 | fpr=0.9140 | 8507.2 samples/s | 33.2 steps/s
[Step= 200] | Loss=2.76346 | acc=0.0988 | tpr=0.7902 | fpr=0.9138 | 8799.3 samples/s | 34.4 steps/s
[Step= 250] | Loss=2.76830 | acc=0.0982 | tpr=0.7921 | fpr=0.9144 | 8966.2 samples/s | 35.0 steps/s
[Step= 300] | Loss=2.76970 | acc=0.0982 | tpr=0.7927 | fpr=0.9145 | 8756.1 samples/s | 34.2 steps/s
[Step= 350] | Loss=2.76848 | acc=0.0978 | tpr=0.7940 | fpr=0.9148 | 8669.0 samples/s | 33.9 steps/s
[Step= 400] | Loss=2.76529 | acc=0.0978 | tpr=0.7976 | fpr=0.9149 | 9026.5 samples/s | 35.3 steps/s
[Step= 450] | Loss=2.76598 | acc=0.0974 | tpr=0.7980 | fpr=0.9153 | 8638.4 samples/s | 33.7 steps/s
[Step= 500] | Loss=2.76686 | acc=0.0975 | tpr=0.7978 | fpr=0.9152 | 9193.7 samples/s | 35.9 steps/s
[Step= 550] | Loss=2.76771 | acc=0.0973 | tpr=0.7971 | fpr=0.9154 | 14745.9 samples/s | 57.6 steps/s
Avg test loss: 2.76847, Avg test acc: 0.09727, Avg tpr: 0.79675, Avg fpr: 0.91545, total FA: 127108

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.33214 | acc=0.6381 | tpr=0.3496 | fpr=0.3567 | 4516.7 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.33221 | acc=0.6372 | tpr=0.3156 | fpr=0.3568 | 8775.7 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.33210 | acc=0.6348 | tpr=0.3127 | fpr=0.3593 | 8586.2 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.33223 | acc=0.6338 | tpr=0.3148 | fpr=0.3604 | 8797.1 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.33219 | acc=0.6334 | tpr=0.3083 | fpr=0.3607 | 8835.3 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.33227 | acc=0.6338 | tpr=0.3149 | fpr=0.3604 | 9556.7 samples/s | 37.3 steps/s
[Step= 350] | Loss=0.33218 | acc=0.6342 | tpr=0.3212 | fpr=0.3602 | 8162.8 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.33217 | acc=0.6339 | tpr=0.3233 | fpr=0.3605 | 8975.8 samples/s | 35.1 steps/s
[Step= 450] | Loss=0.33212 | acc=0.6347 | tpr=0.3189 | fpr=0.3595 | 8786.2 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.33209 | acc=0.6350 | tpr=0.3181 | fpr=0.3593 | 9327.3 samples/s | 36.4 steps/s
[Step= 550] | Loss=0.33213 | acc=0.6349 | tpr=0.3187 | fpr=0.3594 | 14553.8 samples/s | 56.9 steps/s
Avg test loss: 0.33212, Avg test acc: 0.63488, Avg tpr: 0.31854, Avg fpr: 0.35937, total FA: 49898

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.07920 | acc=0.9802 | tpr=0.9027 | fpr=0.0185 | 4457.4 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.08026 | acc=0.9798 | tpr=0.9232 | fpr=0.0191 | 8908.1 samples/s | 34.8 steps/s
[Step= 150] | Loss=0.08355 | acc=0.9790 | tpr=0.9222 | fpr=0.0200 | 8648.7 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.08388 | acc=0.9793 | tpr=0.9268 | fpr=0.0197 | 9437.1 samples/s | 36.9 steps/s
[Step= 250] | Loss=0.08255 | acc=0.9796 | tpr=0.9214 | fpr=0.0193 | 8396.1 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.08425 | acc=0.9792 | tpr=0.9200 | fpr=0.0197 | 8788.4 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.08531 | acc=0.9789 | tpr=0.9211 | fpr=0.0201 | 8778.6 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.08628 | acc=0.9788 | tpr=0.9179 | fpr=0.0201 | 9026.3 samples/s | 35.3 steps/s
[Step= 450] | Loss=0.08884 | acc=0.9783 | tpr=0.9167 | fpr=0.0205 | 8666.4 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.08820 | acc=0.9784 | tpr=0.9172 | fpr=0.0205 | 9288.3 samples/s | 36.3 steps/s
[Step= 550] | Loss=0.08702 | acc=0.9786 | tpr=0.9164 | fpr=0.0203 | 14286.0 samples/s | 55.8 steps/s
Avg test loss: 0.08693, Avg test acc: 0.97857, Avg tpr: 0.91680, Avg fpr: 0.02030, total FA: 2819

server round 1/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.30192 | Reg=0.00290 | acc=0.7031 | L2-Norm=17.038 | L2-Norm(final)=1.969 | 4066.3 samples/s | 63.5 steps/s
[Step=  50 Epoch= 0.1] | Loss=0.23655 | Reg=0.00290 | acc=0.8906 | L2-Norm=17.037 | L2-Norm(final)=2.031 | 5291.7 samples/s | 82.7 steps/s
[Step= 100 Epoch= 0.2] | Loss=0.21694 | Reg=0.00292 | acc=0.8125 | L2-Norm=17.083 | L2-Norm(final)=2.077 | 6051.3 samples/s | 94.6 steps/s
[Step= 150 Epoch= 0.3] | Loss=0.21063 | Reg=0.00293 | acc=0.8125 | L2-Norm=17.128 | L2-Norm(final)=2.110 | 6071.5 samples/s | 94.9 steps/s
[Step= 200 Epoch= 0.4] | Loss=0.20475 | Reg=0.00295 | acc=0.8906 | L2-Norm=17.164 | L2-Norm(final)=2.136 | 6110.0 samples/s | 95.5 steps/s
[Step= 250 Epoch= 0.5] | Loss=0.20087 | Reg=0.00296 | acc=0.9375 | L2-Norm=17.197 | L2-Norm(final)=2.161 | 6054.5 samples/s | 94.6 steps/s
[Step= 300 Epoch= 0.6] | Loss=0.19882 | Reg=0.00297 | acc=0.7812 | L2-Norm=17.230 | L2-Norm(final)=2.183 | 6092.9 samples/s | 95.2 steps/s
[Step= 350 Epoch= 0.7] | Loss=0.19534 | Reg=0.00298 | acc=0.9531 | L2-Norm=17.266 | L2-Norm(final)=2.205 | 6039.5 samples/s | 94.4 steps/s
[Step= 400 Epoch= 0.8] | Loss=0.19298 | Reg=0.00299 | acc=0.8281 | L2-Norm=17.302 | L2-Norm(final)=2.227 | 6049.4 samples/s | 94.5 steps/s
[Step= 450 Epoch= 0.9] | Loss=0.19063 | Reg=0.00301 | acc=0.8906 | L2-Norm=17.339 | L2-Norm(final)=2.248 | 6049.1 samples/s | 94.5 steps/s
[Step= 500 Epoch= 1.0] | Loss=0.18877 | Reg=0.00302 | acc=0.8438 | L2-Norm=17.376 | L2-Norm(final)=2.267 | 7771.3 samples/s | 121.4 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.0] | Loss=0.15756 | Reg=0.00315 | acc=0.8906 | L2-Norm=17.743 | L2-Norm(final)=2.463 | 3606.0 samples/s | 56.3 steps/s
[Step= 550 Epoch= 1.1] | Loss=0.17945 | Reg=0.00316 | acc=0.9062 | L2-Norm=17.778 | L2-Norm(final)=2.452 | 4959.4 samples/s | 77.5 steps/s
[Step= 600 Epoch= 1.2] | Loss=0.15687 | Reg=0.00317 | acc=0.8906 | L2-Norm=17.810 | L2-Norm(final)=2.464 | 4997.1 samples/s | 78.1 steps/s
[Step= 650 Epoch= 1.3] | Loss=0.14596 | Reg=0.00318 | acc=0.9375 | L2-Norm=17.830 | L2-Norm(final)=2.472 | 5030.8 samples/s | 78.6 steps/s
[Step= 700 Epoch= 1.4] | Loss=0.13622 | Reg=0.00318 | acc=0.9219 | L2-Norm=17.846 | L2-Norm(final)=2.478 | 5083.3 samples/s | 79.4 steps/s
[Step= 750 Epoch= 1.5] | Loss=0.13104 | Reg=0.00319 | acc=0.8906 | L2-Norm=17.865 | L2-Norm(final)=2.485 | 5141.9 samples/s | 80.3 steps/s
[Step= 800 Epoch= 1.6] | Loss=0.12546 | Reg=0.00320 | acc=0.9062 | L2-Norm=17.888 | L2-Norm(final)=2.490 | 4980.7 samples/s | 77.8 steps/s
[Step= 850 Epoch= 1.7] | Loss=0.12085 | Reg=0.00321 | acc=0.9219 | L2-Norm=17.909 | L2-Norm(final)=2.495 | 5060.7 samples/s | 79.1 steps/s
[Step= 900 Epoch= 1.8] | Loss=0.11658 | Reg=0.00321 | acc=0.9062 | L2-Norm=17.928 | L2-Norm(final)=2.500 | 5062.4 samples/s | 79.1 steps/s
[Step= 950 Epoch= 1.9] | Loss=0.11298 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.945 | L2-Norm(final)=2.505 | 5056.5 samples/s | 79.0 steps/s
[Step=1000 Epoch= 2.0] | Loss=0.10954 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.962 | L2-Norm(final)=2.510 | 6174.5 samples/s | 96.5 steps/s
[Step=1050 Epoch= 2.0] | Loss=0.10498 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.979 | L2-Norm(final)=2.516 | 1899.2 samples/s | 29.7 steps/s
[Step=1100 Epoch= 2.1] | Loss=0.10239 | Reg=0.00324 | acc=0.8750 | L2-Norm=17.995 | L2-Norm(final)=2.521 | 4951.2 samples/s | 77.4 steps/s
[Step=1150 Epoch= 2.2] | Loss=0.09923 | Reg=0.00324 | acc=0.9531 | L2-Norm=18.013 | L2-Norm(final)=2.526 | 5078.6 samples/s | 79.4 steps/s
[Step=1200 Epoch= 2.3] | Loss=0.09699 | Reg=0.00325 | acc=0.9375 | L2-Norm=18.029 | L2-Norm(final)=2.531 | 5052.0 samples/s | 78.9 steps/s
[Step=1250 Epoch= 2.4] | Loss=0.09479 | Reg=0.00326 | acc=0.9219 | L2-Norm=18.045 | L2-Norm(final)=2.536 | 5007.7 samples/s | 78.2 steps/s
[Step=1300 Epoch= 2.5] | Loss=0.09226 | Reg=0.00326 | acc=0.9375 | L2-Norm=18.061 | L2-Norm(final)=2.541 | 4997.6 samples/s | 78.1 steps/s
[Step=1350 Epoch= 2.6] | Loss=0.09050 | Reg=0.00327 | acc=0.9062 | L2-Norm=18.078 | L2-Norm(final)=2.546 | 5067.9 samples/s | 79.2 steps/s
[Step=1400 Epoch= 2.7] | Loss=0.08897 | Reg=0.00328 | acc=0.9531 | L2-Norm=18.096 | L2-Norm(final)=2.550 | 5086.7 samples/s | 79.5 steps/s
[Step=1450 Epoch= 2.8] | Loss=0.08801 | Reg=0.00328 | acc=0.9844 | L2-Norm=18.115 | L2-Norm(final)=2.555 | 5063.1 samples/s | 79.1 steps/s
[Step=1500 Epoch= 2.9] | Loss=0.08639 | Reg=0.00329 | acc=0.9531 | L2-Norm=18.133 | L2-Norm(final)=2.559 | 5289.0 samples/s | 82.6 steps/s
[Step=1550 Epoch= 3.0] | Loss=0.08509 | Reg=0.00330 | acc=0.9688 | L2-Norm=18.151 | L2-Norm(final)=2.563 | 1935.6 samples/s | 30.2 steps/s
[Step=1600 Epoch= 3.1] | Loss=0.08310 | Reg=0.00330 | acc=0.9531 | L2-Norm=18.168 | L2-Norm(final)=2.567 | 5055.9 samples/s | 79.0 steps/s
[Step=1650 Epoch= 3.2] | Loss=0.08147 | Reg=0.00331 | acc=0.9531 | L2-Norm=18.185 | L2-Norm(final)=2.571 | 4986.1 samples/s | 77.9 steps/s
[Step=1700 Epoch= 3.3] | Loss=0.08002 | Reg=0.00331 | acc=0.9688 | L2-Norm=18.202 | L2-Norm(final)=2.576 | 5109.9 samples/s | 79.8 steps/s
[Step=1750 Epoch= 3.4] | Loss=0.07875 | Reg=0.00332 | acc=0.9375 | L2-Norm=18.219 | L2-Norm(final)=2.579 | 4988.6 samples/s | 77.9 steps/s
[Step=1800 Epoch= 3.5] | Loss=0.07811 | Reg=0.00333 | acc=0.9688 | L2-Norm=18.235 | L2-Norm(final)=2.582 | 5053.8 samples/s | 79.0 steps/s
[Step=1850 Epoch= 3.6] | Loss=0.07709 | Reg=0.00333 | acc=0.9219 | L2-Norm=18.252 | L2-Norm(final)=2.585 | 5111.5 samples/s | 79.9 steps/s
[Step=1900 Epoch= 3.7] | Loss=0.07618 | Reg=0.00334 | acc=0.9688 | L2-Norm=18.269 | L2-Norm(final)=2.588 | 5017.1 samples/s | 78.4 steps/s
[Step=1950 Epoch= 3.8] | Loss=0.07522 | Reg=0.00334 | acc=0.9219 | L2-Norm=18.285 | L2-Norm(final)=2.590 | 5092.3 samples/s | 79.6 steps/s
[Step=2000 Epoch= 3.9] | Loss=0.07426 | Reg=0.00335 | acc=0.9688 | L2-Norm=18.302 | L2-Norm(final)=2.593 | 4972.8 samples/s | 77.7 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step2000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=2001 Epoch= 7.7] | Loss=0.21264 | Reg=0.00290 | acc=0.8594 | L2-Norm=17.038 | L2-Norm(final)=2.744 | 3861.5 samples/s | 60.3 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.09285 | Reg=0.00302 | acc=0.9219 | L2-Norm=17.371 | L2-Norm(final)=2.789 | 5054.6 samples/s | 79.0 steps/s
[Step=2100 Epoch= 8.1] | Loss=0.07603 | Reg=0.00308 | acc=0.9844 | L2-Norm=17.548 | L2-Norm(final)=2.835 | 5365.3 samples/s | 83.8 steps/s
[Step=2150 Epoch= 8.3] | Loss=0.06664 | Reg=0.00311 | acc=0.9688 | L2-Norm=17.646 | L2-Norm(final)=2.867 | 5274.5 samples/s | 82.4 steps/s
[Step=2200 Epoch= 8.5] | Loss=0.06222 | Reg=0.00314 | acc=0.9688 | L2-Norm=17.715 | L2-Norm(final)=2.896 | 5320.1 samples/s | 83.1 steps/s
[Step=2250 Epoch= 8.7] | Loss=0.05882 | Reg=0.00316 | acc=0.9844 | L2-Norm=17.772 | L2-Norm(final)=2.919 | 7135.1 samples/s | 111.5 steps/s
[Step=2300 Epoch= 8.9] | Loss=0.05391 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.833 | L2-Norm(final)=2.943 | 1918.1 samples/s | 30.0 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.05053 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.887 | L2-Norm(final)=2.969 | 5265.8 samples/s | 82.3 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.04853 | Reg=0.00322 | acc=0.9688 | L2-Norm=17.937 | L2-Norm(final)=2.994 | 5303.7 samples/s | 82.9 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.04700 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.983 | L2-Norm(final)=3.019 | 5445.6 samples/s | 85.1 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.04566 | Reg=0.00325 | acc=0.9688 | L2-Norm=18.026 | L2-Norm(final)=3.043 | 6207.0 samples/s | 97.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 9.6] | Loss=0.01304 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.448 | L2-Norm(final)=3.289 | 3914.4 samples/s | 61.2 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.10290 | Reg=0.00346 | acc=0.9688 | L2-Norm=18.592 | L2-Norm(final)=3.227 | 4434.6 samples/s | 69.3 steps/s
[Step=2600 Epoch=10.0] | Loss=0.06331 | Reg=0.00348 | acc=1.0000 | L2-Norm=18.660 | L2-Norm(final)=3.230 | 4848.6 samples/s | 75.8 steps/s
[Step=2650 Epoch=10.2] | Loss=0.04584 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.680 | L2-Norm(final)=3.242 | 4762.3 samples/s | 74.4 steps/s
[Step=2700 Epoch=10.4] | Loss=0.03625 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.686 | L2-Norm(final)=3.252 | 4785.0 samples/s | 74.8 steps/s
[Step=2750 Epoch=10.6] | Loss=0.02951 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.684 | L2-Norm(final)=3.263 | 6127.3 samples/s | 95.7 steps/s
[Step=2800 Epoch=10.8] | Loss=0.02522 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.676 | L2-Norm(final)=3.272 | 1873.6 samples/s | 29.3 steps/s
[Step=2850 Epoch=11.0] | Loss=0.02190 | Reg=0.00348 | acc=1.0000 | L2-Norm=18.666 | L2-Norm(final)=3.281 | 4792.7 samples/s | 74.9 steps/s
[Step=2900 Epoch=11.2] | Loss=0.01929 | Reg=0.00348 | acc=1.0000 | L2-Norm=18.653 | L2-Norm(final)=3.288 | 4774.9 samples/s | 74.6 steps/s
[Step=2950 Epoch=11.4] | Loss=0.01736 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.639 | L2-Norm(final)=3.294 | 4779.6 samples/s | 74.7 steps/s
[Step=3000 Epoch=11.5] | Loss=0.01574 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.624 | L2-Norm(final)=3.300 | 5468.0 samples/s | 85.4 steps/s
[Step=3050 Epoch=11.7] | Loss=0.01435 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.607 | L2-Norm(final)=3.306 | 1948.1 samples/s | 30.4 steps/s
[Step=3100 Epoch=11.9] | Loss=0.01317 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.590 | L2-Norm(final)=3.311 | 4795.4 samples/s | 74.9 steps/s
[Step=3150 Epoch=12.1] | Loss=0.01217 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.572 | L2-Norm(final)=3.315 | 4799.5 samples/s | 75.0 steps/s
[Step=3200 Epoch=12.3] | Loss=0.01131 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.552 | L2-Norm(final)=3.320 | 4755.6 samples/s | 74.3 steps/s
[Step=3250 Epoch=12.5] | Loss=0.01056 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.532 | L2-Norm(final)=3.324 | 4874.4 samples/s | 76.2 steps/s
[Step=3300 Epoch=12.7] | Loss=0.00990 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.511 | L2-Norm(final)=3.327 | 2000.2 samples/s | 31.3 steps/s
[Step=3350 Epoch=12.9] | Loss=0.00932 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.490 | L2-Norm(final)=3.330 | 4889.0 samples/s | 76.4 steps/s
[Step=3400 Epoch=13.1] | Loss=0.00881 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.468 | L2-Norm(final)=3.333 | 4800.8 samples/s | 75.0 steps/s
[Step=3450 Epoch=13.3] | Loss=0.00835 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.445 | L2-Norm(final)=3.336 | 4777.3 samples/s | 74.6 steps/s
[Step=3500 Epoch=13.5] | Loss=0.00793 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.422 | L2-Norm(final)=3.339 | 4793.0 samples/s | 74.9 steps/s
[Step=3550 Epoch=13.7] | Loss=0.00756 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.399 | L2-Norm(final)=3.342 | 2034.6 samples/s | 31.8 steps/s
[Step=3600 Epoch=13.9] | Loss=0.00722 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.376 | L2-Norm(final)=3.344 | 4778.6 samples/s | 74.7 steps/s
[Step=3650 Epoch=14.1] | Loss=0.00691 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.352 | L2-Norm(final)=3.346 | 4807.9 samples/s | 75.1 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00662 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.328 | L2-Norm(final)=3.348 | 4819.4 samples/s | 75.3 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00636 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.303 | L2-Norm(final)=3.350 | 4775.7 samples/s | 74.6 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00611 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.279 | L2-Norm(final)=3.352 | 6962.8 samples/s | 108.8 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00589 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.254 | L2-Norm(final)=3.354 | 1793.9 samples/s | 28.0 steps/s
[Step=3900 Epoch=15.0] | Loss=0.00568 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.229 | L2-Norm(final)=3.356 | 4875.0 samples/s | 76.2 steps/s
[Step=3950 Epoch=15.2] | Loss=0.00548 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.203 | L2-Norm(final)=3.358 | 4698.0 samples/s | 73.4 steps/s
[Step=4000 Epoch=15.4] | Loss=0.00530 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.178 | L2-Norm(final)=3.360 | 4883.3 samples/s | 76.3 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07347 | acc=0.9507 | tpr=0.9652 | fpr=0.0808 | 4522.4 samples/s | 17.7 steps/s
Avg test loss: 0.07476, Avg test acc: 0.95036, Avg tpr: 0.96608, Avg fpr: 0.08422, total FA: 657

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07916 | acc=0.9418 | tpr=0.9403 | fpr=0.0550 | 4507.7 samples/s | 17.6 steps/s
Avg test loss: 0.08274, Avg test acc: 0.93970, Avg tpr: 0.93880, Avg fpr: 0.05833, total FA: 455

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=0.36175 | acc=0.4209 | tpr=0.3043 | fpr=0.3261 | 4445.1 samples/s | 17.4 steps/s
Avg test loss: 0.36236, Avg test acc: 0.42391, Avg tpr: 0.30845, Avg fpr: 0.32214, total FA: 2513

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=3.60997 | acc=0.3171 | tpr=0.0079 | fpr=0.0114 | 4482.1 samples/s | 17.5 steps/s
Avg test loss: 3.62282, Avg test acc: 0.31473, Avg tpr: 0.00804, Avg fpr: 0.01077, total FA: 84

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.23841 | acc=0.0916 | tpr=0.8451 | fpr=0.9220 | 4495.3 samples/s | 17.6 steps/s
[Step= 100] | Loss=3.23309 | acc=0.0899 | tpr=0.8166 | fpr=0.9236 | 9084.1 samples/s | 35.5 steps/s
[Step= 150] | Loss=3.23408 | acc=0.0898 | tpr=0.8127 | fpr=0.9235 | 8322.0 samples/s | 32.5 steps/s
[Step= 200] | Loss=3.23449 | acc=0.0898 | tpr=0.8219 | fpr=0.9236 | 8745.2 samples/s | 34.2 steps/s
[Step= 250] | Loss=3.24011 | acc=0.0902 | tpr=0.8227 | fpr=0.9231 | 9096.0 samples/s | 35.5 steps/s
[Step= 300] | Loss=3.24263 | acc=0.0899 | tpr=0.8233 | fpr=0.9235 | 8616.6 samples/s | 33.7 steps/s
[Step= 350] | Loss=3.24284 | acc=0.0898 | tpr=0.8291 | fpr=0.9236 | 8717.0 samples/s | 34.1 steps/s
[Step= 400] | Loss=3.24041 | acc=0.0901 | tpr=0.8315 | fpr=0.9234 | 8838.8 samples/s | 34.5 steps/s
[Step= 450] | Loss=3.24243 | acc=0.0895 | tpr=0.8315 | fpr=0.9239 | 9410.1 samples/s | 36.8 steps/s
[Step= 500] | Loss=3.24388 | acc=0.0894 | tpr=0.8339 | fpr=0.9241 | 8500.4 samples/s | 33.2 steps/s
[Step= 550] | Loss=3.24453 | acc=0.0894 | tpr=0.8333 | fpr=0.9241 | 15625.4 samples/s | 61.0 steps/s
Avg test loss: 3.24536, Avg test acc: 0.08931, Avg tpr: 0.83320, Avg fpr: 0.92421, total FA: 128325

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=2.75757 | acc=0.0996 | tpr=0.7699 | fpr=0.9124 | 4468.4 samples/s | 17.5 steps/s
[Step= 100] | Loss=2.75566 | acc=0.1007 | tpr=0.7974 | fpr=0.9123 | 9273.0 samples/s | 36.2 steps/s
[Step= 150] | Loss=2.76097 | acc=0.0990 | tpr=0.8026 | fpr=0.9140 | 8668.5 samples/s | 33.9 steps/s
[Step= 200] | Loss=2.76346 | acc=0.0988 | tpr=0.7902 | fpr=0.9138 | 8472.9 samples/s | 33.1 steps/s
[Step= 250] | Loss=2.76830 | acc=0.0982 | tpr=0.7921 | fpr=0.9144 | 8924.0 samples/s | 34.9 steps/s
[Step= 300] | Loss=2.76970 | acc=0.0982 | tpr=0.7927 | fpr=0.9145 | 8828.7 samples/s | 34.5 steps/s
[Step= 350] | Loss=2.76848 | acc=0.0978 | tpr=0.7940 | fpr=0.9148 | 9080.3 samples/s | 35.5 steps/s
[Step= 400] | Loss=2.76529 | acc=0.0978 | tpr=0.7976 | fpr=0.9149 | 8588.2 samples/s | 33.5 steps/s
[Step= 450] | Loss=2.76598 | acc=0.0974 | tpr=0.7980 | fpr=0.9153 | 8847.7 samples/s | 34.6 steps/s
[Step= 500] | Loss=2.76686 | acc=0.0975 | tpr=0.7978 | fpr=0.9152 | 8840.6 samples/s | 34.5 steps/s
[Step= 550] | Loss=2.76771 | acc=0.0973 | tpr=0.7971 | fpr=0.9154 | 15121.0 samples/s | 59.1 steps/s
Avg test loss: 2.76847, Avg test acc: 0.09727, Avg tpr: 0.79675, Avg fpr: 0.91545, total FA: 127108

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.33214 | acc=0.6381 | tpr=0.3496 | fpr=0.3567 | 4446.7 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.33221 | acc=0.6372 | tpr=0.3156 | fpr=0.3568 | 8953.0 samples/s | 35.0 steps/s
[Step= 150] | Loss=0.33210 | acc=0.6348 | tpr=0.3127 | fpr=0.3593 | 8796.6 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.33223 | acc=0.6338 | tpr=0.3148 | fpr=0.3604 | 8826.0 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.33219 | acc=0.6334 | tpr=0.3083 | fpr=0.3607 | 8856.7 samples/s | 34.6 steps/s
[Step= 300] | Loss=0.33227 | acc=0.6338 | tpr=0.3149 | fpr=0.3604 | 8636.3 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.33218 | acc=0.6342 | tpr=0.3212 | fpr=0.3602 | 8728.1 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.33217 | acc=0.6339 | tpr=0.3233 | fpr=0.3605 | 9396.2 samples/s | 36.7 steps/s
[Step= 450] | Loss=0.33212 | acc=0.6347 | tpr=0.3189 | fpr=0.3595 | 8245.6 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.33209 | acc=0.6350 | tpr=0.3181 | fpr=0.3593 | 9166.2 samples/s | 35.8 steps/s
[Step= 550] | Loss=0.33213 | acc=0.6349 | tpr=0.3187 | fpr=0.3594 | 15279.2 samples/s | 59.7 steps/s
Avg test loss: 0.33212, Avg test acc: 0.63488, Avg tpr: 0.31854, Avg fpr: 0.35937, total FA: 49898

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09256 | acc=0.9825 | tpr=0.9204 | fpr=0.0164 | 4520.4 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.09631 | acc=0.9814 | tpr=0.9296 | fpr=0.0176 | 8582.8 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.10081 | acc=0.9801 | tpr=0.9352 | fpr=0.0190 | 9230.9 samples/s | 36.1 steps/s
[Step= 200] | Loss=0.10247 | acc=0.9802 | tpr=0.9399 | fpr=0.0190 | 8491.9 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.10066 | acc=0.9804 | tpr=0.9345 | fpr=0.0188 | 9206.6 samples/s | 36.0 steps/s
[Step= 300] | Loss=0.10227 | acc=0.9801 | tpr=0.9316 | fpr=0.0190 | 8581.1 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.10350 | acc=0.9799 | tpr=0.9324 | fpr=0.0193 | 9161.1 samples/s | 35.8 steps/s
[Step= 400] | Loss=0.10427 | acc=0.9798 | tpr=0.9300 | fpr=0.0193 | 8208.6 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.10681 | acc=0.9793 | tpr=0.9289 | fpr=0.0198 | 8887.7 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.10615 | acc=0.9794 | tpr=0.9282 | fpr=0.0197 | 9179.1 samples/s | 35.9 steps/s
[Step= 550] | Loss=0.10540 | acc=0.9796 | tpr=0.9304 | fpr=0.0195 | 14897.3 samples/s | 58.2 steps/s
Avg test loss: 0.10517, Avg test acc: 0.97958, Avg tpr: 0.93067, Avg fpr: 0.01953, total FA: 2712

server round 2/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=2001 Epoch= 3.9] | Loss=0.21202 | Reg=0.00278 | acc=0.9531 | L2-Norm=16.687 | L2-Norm(final)=2.668 | 3555.2 samples/s | 55.5 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.14798 | Reg=0.00287 | acc=0.8594 | L2-Norm=16.948 | L2-Norm(final)=2.754 | 5618.4 samples/s | 87.8 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.13607 | Reg=0.00292 | acc=0.9219 | L2-Norm=17.101 | L2-Norm(final)=2.816 | 5651.1 samples/s | 88.3 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.12960 | Reg=0.00296 | acc=0.9531 | L2-Norm=17.212 | L2-Norm(final)=2.867 | 5632.4 samples/s | 88.0 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.12550 | Reg=0.00300 | acc=0.8438 | L2-Norm=17.306 | L2-Norm(final)=2.912 | 5724.0 samples/s | 89.4 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.12252 | Reg=0.00303 | acc=0.9375 | L2-Norm=17.390 | L2-Norm(final)=2.950 | 5732.4 samples/s | 89.6 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.12042 | Reg=0.00305 | acc=0.9531 | L2-Norm=17.463 | L2-Norm(final)=2.986 | 5524.2 samples/s | 86.3 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.11790 | Reg=0.00307 | acc=0.9375 | L2-Norm=17.530 | L2-Norm(final)=3.019 | 5728.7 samples/s | 89.5 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.11652 | Reg=0.00310 | acc=0.8750 | L2-Norm=17.592 | L2-Norm(final)=3.050 | 5657.5 samples/s | 88.4 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.11432 | Reg=0.00312 | acc=0.9062 | L2-Norm=17.652 | L2-Norm(final)=3.082 | 5655.6 samples/s | 88.4 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.11326 | Reg=0.00314 | acc=0.9531 | L2-Norm=17.707 | L2-Norm(final)=3.111 | 7116.4 samples/s | 111.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 4.9] | Loss=0.04428 | Reg=0.00333 | acc=0.9688 | L2-Norm=18.249 | L2-Norm(final)=3.398 | 3514.3 samples/s | 54.9 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.10554 | Reg=0.00335 | acc=0.8281 | L2-Norm=18.291 | L2-Norm(final)=3.404 | 5250.2 samples/s | 82.0 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.10716 | Reg=0.00335 | acc=0.9062 | L2-Norm=18.306 | L2-Norm(final)=3.386 | 5086.2 samples/s | 79.5 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.10275 | Reg=0.00336 | acc=0.9531 | L2-Norm=18.323 | L2-Norm(final)=3.374 | 5072.7 samples/s | 79.3 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.09647 | Reg=0.00336 | acc=0.9375 | L2-Norm=18.341 | L2-Norm(final)=3.369 | 5007.7 samples/s | 78.2 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.09399 | Reg=0.00337 | acc=0.9688 | L2-Norm=18.359 | L2-Norm(final)=3.365 | 4987.7 samples/s | 77.9 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.09140 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.377 | L2-Norm(final)=3.361 | 5036.4 samples/s | 78.7 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.08890 | Reg=0.00338 | acc=0.9688 | L2-Norm=18.393 | L2-Norm(final)=3.357 | 5011.6 samples/s | 78.3 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.08650 | Reg=0.00339 | acc=0.9531 | L2-Norm=18.409 | L2-Norm(final)=3.355 | 4949.9 samples/s | 77.3 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.08417 | Reg=0.00340 | acc=0.9531 | L2-Norm=18.426 | L2-Norm(final)=3.354 | 5073.9 samples/s | 79.3 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.08184 | Reg=0.00340 | acc=0.9531 | L2-Norm=18.442 | L2-Norm(final)=3.354 | 6194.9 samples/s | 96.8 steps/s
[Step=3050 Epoch= 5.9] | Loss=0.07956 | Reg=0.00341 | acc=0.9688 | L2-Norm=18.457 | L2-Norm(final)=3.352 | 1853.2 samples/s | 29.0 steps/s
[Step=3100 Epoch= 6.0] | Loss=0.07668 | Reg=0.00341 | acc=0.9531 | L2-Norm=18.473 | L2-Norm(final)=3.353 | 5082.0 samples/s | 79.4 steps/s
[Step=3150 Epoch= 6.1] | Loss=0.07419 | Reg=0.00342 | acc=0.9688 | L2-Norm=18.487 | L2-Norm(final)=3.354 | 5051.3 samples/s | 78.9 steps/s
[Step=3200 Epoch= 6.2] | Loss=0.07296 | Reg=0.00342 | acc=0.9844 | L2-Norm=18.502 | L2-Norm(final)=3.354 | 5092.8 samples/s | 79.6 steps/s
[Step=3250 Epoch= 6.3] | Loss=0.07133 | Reg=0.00343 | acc=0.9844 | L2-Norm=18.517 | L2-Norm(final)=3.354 | 5024.5 samples/s | 78.5 steps/s
[Step=3300 Epoch= 6.4] | Loss=0.07014 | Reg=0.00343 | acc=0.9844 | L2-Norm=18.531 | L2-Norm(final)=3.355 | 5033.1 samples/s | 78.6 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.06853 | Reg=0.00344 | acc=0.9219 | L2-Norm=18.546 | L2-Norm(final)=3.355 | 5064.3 samples/s | 79.1 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.06759 | Reg=0.00344 | acc=0.8906 | L2-Norm=18.560 | L2-Norm(final)=3.355 | 5049.4 samples/s | 78.9 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.06671 | Reg=0.00345 | acc=0.9688 | L2-Norm=18.572 | L2-Norm(final)=3.354 | 5089.1 samples/s | 79.5 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.06568 | Reg=0.00345 | acc=0.9844 | L2-Norm=18.585 | L2-Norm(final)=3.353 | 5362.4 samples/s | 83.8 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.06413 | Reg=0.00346 | acc=0.9531 | L2-Norm=18.598 | L2-Norm(final)=3.354 | 1938.8 samples/s | 30.3 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.06267 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.611 | L2-Norm(final)=3.354 | 5102.3 samples/s | 79.7 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.06161 | Reg=0.00347 | acc=0.9688 | L2-Norm=18.623 | L2-Norm(final)=3.355 | 5001.7 samples/s | 78.2 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.06071 | Reg=0.00347 | acc=0.9688 | L2-Norm=18.635 | L2-Norm(final)=3.356 | 5099.8 samples/s | 79.7 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.06010 | Reg=0.00348 | acc=0.9531 | L2-Norm=18.646 | L2-Norm(final)=3.356 | 5085.2 samples/s | 79.5 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.05920 | Reg=0.00348 | acc=0.9688 | L2-Norm=18.658 | L2-Norm(final)=3.357 | 5009.3 samples/s | 78.3 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.05863 | Reg=0.00349 | acc=0.9375 | L2-Norm=18.670 | L2-Norm(final)=3.357 | 5038.7 samples/s | 78.7 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.05813 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.681 | L2-Norm(final)=3.357 | 5130.1 samples/s | 80.2 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.05761 | Reg=0.00350 | acc=0.9844 | L2-Norm=18.694 | L2-Norm(final)=3.357 | 4974.7 samples/s | 77.7 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.05687 | Reg=0.00350 | acc=0.9688 | L2-Norm=18.706 | L2-Norm(final)=3.357 | 5079.8 samples/s | 79.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step4000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.32742 | Reg=0.00278 | acc=0.6094 | L2-Norm=16.687 | L2-Norm(final)=1.967 | 3810.6 samples/s | 59.5 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.15478 | Reg=0.00282 | acc=0.9219 | L2-Norm=16.788 | L2-Norm(final)=2.097 | 5342.5 samples/s | 83.5 steps/s
[Step= 100 Epoch= 0.4] | Loss=0.11389 | Reg=0.00286 | acc=0.9531 | L2-Norm=16.917 | L2-Norm(final)=2.212 | 5711.8 samples/s | 89.2 steps/s
[Step= 150 Epoch= 0.6] | Loss=0.09876 | Reg=0.00289 | acc=0.9844 | L2-Norm=16.987 | L2-Norm(final)=2.287 | 5669.4 samples/s | 88.6 steps/s
[Step= 200 Epoch= 0.8] | Loss=0.09007 | Reg=0.00290 | acc=0.9219 | L2-Norm=17.032 | L2-Norm(final)=2.341 | 5716.0 samples/s | 89.3 steps/s
[Step= 250 Epoch= 1.0] | Loss=0.08491 | Reg=0.00292 | acc=0.9688 | L2-Norm=17.073 | L2-Norm(final)=2.388 | 7516.5 samples/s | 117.4 steps/s
[Step= 300 Epoch= 1.1] | Loss=0.08077 | Reg=0.00293 | acc=0.9844 | L2-Norm=17.111 | L2-Norm(final)=2.431 | 1966.3 samples/s | 30.7 steps/s
[Step= 350 Epoch= 1.3] | Loss=0.07650 | Reg=0.00294 | acc=0.9688 | L2-Norm=17.152 | L2-Norm(final)=2.472 | 5692.5 samples/s | 88.9 steps/s
[Step= 400 Epoch= 1.5] | Loss=0.07302 | Reg=0.00296 | acc=0.9531 | L2-Norm=17.195 | L2-Norm(final)=2.514 | 5729.6 samples/s | 89.5 steps/s
[Step= 450 Epoch= 1.7] | Loss=0.07025 | Reg=0.00297 | acc=0.9688 | L2-Norm=17.240 | L2-Norm(final)=2.557 | 5705.6 samples/s | 89.1 steps/s
[Step= 500 Epoch= 1.9] | Loss=0.06757 | Reg=0.00299 | acc=0.9844 | L2-Norm=17.286 | L2-Norm(final)=2.599 | 6408.9 samples/s | 100.1 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 1.9] | Loss=0.07043 | Reg=0.00315 | acc=0.9688 | L2-Norm=17.746 | L2-Norm(final)=3.016 | 3923.7 samples/s | 61.3 steps/s
[Step= 550 Epoch= 2.1] | Loss=0.04108 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.739 | L2-Norm(final)=3.022 | 4507.1 samples/s | 70.4 steps/s
[Step= 600 Epoch= 2.3] | Loss=0.02813 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.715 | L2-Norm(final)=3.032 | 4897.5 samples/s | 76.5 steps/s
[Step= 650 Epoch= 2.5] | Loss=0.02128 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.699 | L2-Norm(final)=3.045 | 4773.6 samples/s | 74.6 steps/s
[Step= 700 Epoch= 2.7] | Loss=0.01975 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.688 | L2-Norm(final)=3.057 | 4763.0 samples/s | 74.4 steps/s
[Step= 750 Epoch= 2.9] | Loss=0.01689 | Reg=0.00312 | acc=0.9844 | L2-Norm=17.673 | L2-Norm(final)=3.066 | 6082.7 samples/s | 95.0 steps/s
[Step= 800 Epoch= 3.1] | Loss=0.01480 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.655 | L2-Norm(final)=3.073 | 1884.1 samples/s | 29.4 steps/s
[Step= 850 Epoch= 3.3] | Loss=0.01276 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.633 | L2-Norm(final)=3.080 | 4806.9 samples/s | 75.1 steps/s
[Step= 900 Epoch= 3.4] | Loss=0.01129 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.607 | L2-Norm(final)=3.087 | 4824.0 samples/s | 75.4 steps/s
[Step= 950 Epoch= 3.6] | Loss=0.01007 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.579 | L2-Norm(final)=3.093 | 4693.5 samples/s | 73.3 steps/s
[Step=1000 Epoch= 3.8] | Loss=0.00909 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.547 | L2-Norm(final)=3.099 | 5388.8 samples/s | 84.2 steps/s
[Step=1050 Epoch= 4.0] | Loss=0.00827 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.514 | L2-Norm(final)=3.104 | 1951.5 samples/s | 30.5 steps/s
[Step=1100 Epoch= 4.2] | Loss=0.00759 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.478 | L2-Norm(final)=3.108 | 4798.5 samples/s | 75.0 steps/s
[Step=1150 Epoch= 4.4] | Loss=0.00701 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.441 | L2-Norm(final)=3.112 | 4704.8 samples/s | 73.5 steps/s
[Step=1200 Epoch= 4.6] | Loss=0.00651 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.403 | L2-Norm(final)=3.116 | 4785.1 samples/s | 74.8 steps/s
[Step=1250 Epoch= 4.8] | Loss=0.00608 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.364 | L2-Norm(final)=3.119 | 4770.8 samples/s | 74.5 steps/s
[Step=1300 Epoch= 5.0] | Loss=0.00570 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.324 | L2-Norm(final)=3.122 | 2030.1 samples/s | 31.7 steps/s
[Step=1350 Epoch= 5.2] | Loss=0.00537 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.283 | L2-Norm(final)=3.125 | 4874.6 samples/s | 76.2 steps/s
[Step=1400 Epoch= 5.4] | Loss=0.00507 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.242 | L2-Norm(final)=3.128 | 4727.0 samples/s | 73.9 steps/s
[Step=1450 Epoch= 5.6] | Loss=0.00481 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.200 | L2-Norm(final)=3.130 | 4709.3 samples/s | 73.6 steps/s
[Step=1500 Epoch= 5.7] | Loss=0.00457 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.158 | L2-Norm(final)=3.132 | 4828.5 samples/s | 75.4 steps/s
[Step=1550 Epoch= 5.9] | Loss=0.00435 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.115 | L2-Norm(final)=3.134 | 2034.7 samples/s | 31.8 steps/s
[Step=1600 Epoch= 6.1] | Loss=0.00415 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.072 | L2-Norm(final)=3.136 | 4777.2 samples/s | 74.6 steps/s
[Step=1650 Epoch= 6.3] | Loss=0.00397 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.029 | L2-Norm(final)=3.138 | 4756.4 samples/s | 74.3 steps/s
[Step=1700 Epoch= 6.5] | Loss=0.00381 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.986 | L2-Norm(final)=3.140 | 4805.4 samples/s | 75.1 steps/s
[Step=1750 Epoch= 6.7] | Loss=0.00366 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.943 | L2-Norm(final)=3.142 | 4792.5 samples/s | 74.9 steps/s
[Step=1800 Epoch= 6.9] | Loss=0.00352 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.899 | L2-Norm(final)=3.144 | 6435.3 samples/s | 100.6 steps/s
[Step=1850 Epoch= 7.1] | Loss=0.00339 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.855 | L2-Norm(final)=3.145 | 1825.1 samples/s | 28.5 steps/s
[Step=1900 Epoch= 7.3] | Loss=0.00327 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.811 | L2-Norm(final)=3.147 | 4765.3 samples/s | 74.5 steps/s
[Step=1950 Epoch= 7.5] | Loss=0.00316 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.767 | L2-Norm(final)=3.148 | 4867.2 samples/s | 76.0 steps/s
[Step=2000 Epoch= 7.7] | Loss=0.00305 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.723 | L2-Norm(final)=3.150 | 4788.0 samples/s | 74.8 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step2000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07363 | acc=0.9445 | tpr=0.9435 | fpr=0.0535 | 4411.7 samples/s | 17.2 steps/s
Avg test loss: 0.07557, Avg test acc: 0.94399, Avg tpr: 0.94306, Avg fpr: 0.05397, total FA: 421

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07916 | acc=0.9418 | tpr=0.9403 | fpr=0.0550 | 4487.6 samples/s | 17.5 steps/s
Avg test loss: 0.08274, Avg test acc: 0.93970, Avg tpr: 0.93880, Avg fpr: 0.05833, total FA: 455

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.14562 | acc=0.3102 | tpr=0.0244 | fpr=0.0691 | 4489.2 samples/s | 17.5 steps/s
Avg test loss: 4.15241, Avg test acc: 0.30764, Avg tpr: 0.02366, Avg fpr: 0.06781, total FA: 529

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=3.60997 | acc=0.3171 | tpr=0.0079 | fpr=0.0114 | 4446.2 samples/s | 17.4 steps/s
Avg test loss: 3.62282, Avg test acc: 0.31473, Avg tpr: 0.00804, Avg fpr: 0.01077, total FA: 84

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.38788 | acc=0.1261 | tpr=0.6593 | fpr=0.8835 | 4483.6 samples/s | 17.5 steps/s
[Step= 100] | Loss=3.36936 | acc=0.1265 | tpr=0.6546 | fpr=0.8833 | 8780.9 samples/s | 34.3 steps/s
[Step= 150] | Loss=3.37015 | acc=0.1262 | tpr=0.6657 | fpr=0.8838 | 8706.2 samples/s | 34.0 steps/s
[Step= 200] | Loss=3.37258 | acc=0.1266 | tpr=0.6754 | fpr=0.8834 | 9000.5 samples/s | 35.2 steps/s
[Step= 250] | Loss=3.37128 | acc=0.1280 | tpr=0.6760 | fpr=0.8820 | 8605.4 samples/s | 33.6 steps/s
[Step= 300] | Loss=3.37081 | acc=0.1282 | tpr=0.6771 | fpr=0.8818 | 8903.3 samples/s | 34.8 steps/s
[Step= 350] | Loss=3.37131 | acc=0.1281 | tpr=0.6738 | fpr=0.8818 | 8897.7 samples/s | 34.8 steps/s
[Step= 400] | Loss=3.36978 | acc=0.1283 | tpr=0.6751 | fpr=0.8816 | 8959.1 samples/s | 35.0 steps/s
[Step= 450] | Loss=3.37293 | acc=0.1283 | tpr=0.6733 | fpr=0.8816 | 8707.4 samples/s | 34.0 steps/s
[Step= 500] | Loss=3.37327 | acc=0.1283 | tpr=0.6714 | fpr=0.8815 | 8714.0 samples/s | 34.0 steps/s
[Step= 550] | Loss=3.37512 | acc=0.1279 | tpr=0.6725 | fpr=0.8819 | 15907.1 samples/s | 62.1 steps/s
Avg test loss: 3.37584, Avg test acc: 0.12785, Avg tpr: 0.67274, Avg fpr: 0.88205, total FA: 122471

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=2.75757 | acc=0.0996 | tpr=0.7699 | fpr=0.9124 | 4488.3 samples/s | 17.5 steps/s
[Step= 100] | Loss=2.75566 | acc=0.1007 | tpr=0.7974 | fpr=0.9123 | 8732.9 samples/s | 34.1 steps/s
[Step= 150] | Loss=2.76097 | acc=0.0990 | tpr=0.8026 | fpr=0.9140 | 9359.2 samples/s | 36.6 steps/s
[Step= 200] | Loss=2.76346 | acc=0.0988 | tpr=0.7902 | fpr=0.9138 | 8288.2 samples/s | 32.4 steps/s
[Step= 250] | Loss=2.76830 | acc=0.0982 | tpr=0.7921 | fpr=0.9144 | 8957.8 samples/s | 35.0 steps/s
[Step= 300] | Loss=2.76970 | acc=0.0982 | tpr=0.7927 | fpr=0.9145 | 8664.0 samples/s | 33.8 steps/s
[Step= 350] | Loss=2.76848 | acc=0.0978 | tpr=0.7940 | fpr=0.9148 | 9111.0 samples/s | 35.6 steps/s
[Step= 400] | Loss=2.76529 | acc=0.0978 | tpr=0.7976 | fpr=0.9149 | 8817.8 samples/s | 34.4 steps/s
[Step= 450] | Loss=2.76598 | acc=0.0974 | tpr=0.7980 | fpr=0.9153 | 8485.9 samples/s | 33.1 steps/s
[Step= 500] | Loss=2.76686 | acc=0.0975 | tpr=0.7978 | fpr=0.9152 | 8835.2 samples/s | 34.5 steps/s
[Step= 550] | Loss=2.76771 | acc=0.0973 | tpr=0.7971 | fpr=0.9154 | 16409.9 samples/s | 64.1 steps/s
Avg test loss: 2.76847, Avg test acc: 0.09727, Avg tpr: 0.79675, Avg fpr: 0.91545, total FA: 127108

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09230 | acc=0.9813 | tpr=0.9159 | fpr=0.0175 | 4410.9 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.09527 | acc=0.9805 | tpr=0.9339 | fpr=0.0187 | 9202.9 samples/s | 35.9 steps/s
[Step= 150] | Loss=0.09853 | acc=0.9795 | tpr=0.9380 | fpr=0.0198 | 8474.4 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.09961 | acc=0.9794 | tpr=0.9366 | fpr=0.0198 | 8768.7 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.09716 | acc=0.9797 | tpr=0.9336 | fpr=0.0195 | 9071.1 samples/s | 35.4 steps/s
[Step= 300] | Loss=0.09823 | acc=0.9794 | tpr=0.9273 | fpr=0.0196 | 8500.9 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.09932 | acc=0.9791 | tpr=0.9267 | fpr=0.0199 | 8910.4 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.10027 | acc=0.9790 | tpr=0.9234 | fpr=0.0200 | 8718.2 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.10260 | acc=0.9786 | tpr=0.9216 | fpr=0.0203 | 9177.0 samples/s | 35.8 steps/s
[Step= 500] | Loss=0.10208 | acc=0.9788 | tpr=0.9229 | fpr=0.0202 | 8369.4 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.10124 | acc=0.9789 | tpr=0.9196 | fpr=0.0201 | 16176.5 samples/s | 63.2 steps/s
Avg test loss: 0.10104, Avg test acc: 0.97887, Avg tpr: 0.91997, Avg fpr: 0.02006, total FA: 2785

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09256 | acc=0.9825 | tpr=0.9204 | fpr=0.0164 | 4511.8 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.09631 | acc=0.9814 | tpr=0.9296 | fpr=0.0176 | 8485.0 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.10081 | acc=0.9801 | tpr=0.9352 | fpr=0.0190 | 8896.6 samples/s | 34.8 steps/s
[Step= 200] | Loss=0.10247 | acc=0.9802 | tpr=0.9399 | fpr=0.0190 | 8902.3 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.10066 | acc=0.9804 | tpr=0.9345 | fpr=0.0188 | 8884.3 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.10227 | acc=0.9801 | tpr=0.9316 | fpr=0.0190 | 8851.3 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.10350 | acc=0.9799 | tpr=0.9324 | fpr=0.0193 | 8844.5 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.10427 | acc=0.9798 | tpr=0.9300 | fpr=0.0193 | 8840.6 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.10681 | acc=0.9793 | tpr=0.9289 | fpr=0.0198 | 9008.4 samples/s | 35.2 steps/s
[Step= 500] | Loss=0.10615 | acc=0.9794 | tpr=0.9282 | fpr=0.0197 | 8478.0 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.10540 | acc=0.9796 | tpr=0.9304 | fpr=0.0195 | 15969.9 samples/s | 62.4 steps/s
Avg test loss: 0.10517, Avg test acc: 0.97958, Avg tpr: 0.93067, Avg fpr: 0.01953, total FA: 2712

server round 3/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=2001 Epoch= 3.9] | Loss=0.21504 | Reg=0.00252 | acc=0.8281 | L2-Norm=15.887 | L2-Norm(final)=2.595 | 3945.6 samples/s | 61.7 steps/s
[Step=2050 Epoch= 4.0] | Loss=0.13474 | Reg=0.00271 | acc=0.8906 | L2-Norm=16.445 | L2-Norm(final)=2.702 | 5147.9 samples/s | 80.4 steps/s
[Step=2100 Epoch= 4.1] | Loss=0.11931 | Reg=0.00281 | acc=0.8594 | L2-Norm=16.755 | L2-Norm(final)=2.765 | 5676.2 samples/s | 88.7 steps/s
[Step=2150 Epoch= 4.2] | Loss=0.11246 | Reg=0.00288 | acc=0.9375 | L2-Norm=16.973 | L2-Norm(final)=2.813 | 5638.3 samples/s | 88.1 steps/s
[Step=2200 Epoch= 4.3] | Loss=0.10800 | Reg=0.00294 | acc=0.8594 | L2-Norm=17.140 | L2-Norm(final)=2.856 | 5664.2 samples/s | 88.5 steps/s
[Step=2250 Epoch= 4.4] | Loss=0.10534 | Reg=0.00299 | acc=0.8906 | L2-Norm=17.274 | L2-Norm(final)=2.894 | 5792.3 samples/s | 90.5 steps/s
[Step=2300 Epoch= 4.5] | Loss=0.10352 | Reg=0.00303 | acc=0.9688 | L2-Norm=17.389 | L2-Norm(final)=2.930 | 5546.6 samples/s | 86.7 steps/s
[Step=2350 Epoch= 4.6] | Loss=0.10190 | Reg=0.00306 | acc=0.9688 | L2-Norm=17.490 | L2-Norm(final)=2.961 | 5697.0 samples/s | 89.0 steps/s
[Step=2400 Epoch= 4.7] | Loss=0.09950 | Reg=0.00309 | acc=0.9375 | L2-Norm=17.582 | L2-Norm(final)=2.991 | 5710.6 samples/s | 89.2 steps/s
[Step=2450 Epoch= 4.8] | Loss=0.09789 | Reg=0.00312 | acc=0.8906 | L2-Norm=17.663 | L2-Norm(final)=3.019 | 5743.1 samples/s | 89.7 steps/s
[Step=2500 Epoch= 4.9] | Loss=0.09664 | Reg=0.00315 | acc=0.9531 | L2-Norm=17.738 | L2-Norm(final)=3.046 | 7081.5 samples/s | 110.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 4.9] | Loss=0.07413 | Reg=0.00340 | acc=0.9531 | L2-Norm=18.444 | L2-Norm(final)=3.306 | 3810.1 samples/s | 59.5 steps/s
[Step=2550 Epoch= 5.0] | Loss=0.09458 | Reg=0.00341 | acc=0.8750 | L2-Norm=18.469 | L2-Norm(final)=3.307 | 4966.5 samples/s | 77.6 steps/s
[Step=2600 Epoch= 5.1] | Loss=0.09151 | Reg=0.00341 | acc=0.9375 | L2-Norm=18.475 | L2-Norm(final)=3.293 | 5049.4 samples/s | 78.9 steps/s
[Step=2650 Epoch= 5.2] | Loss=0.08832 | Reg=0.00342 | acc=0.9531 | L2-Norm=18.481 | L2-Norm(final)=3.280 | 5077.7 samples/s | 79.3 steps/s
[Step=2700 Epoch= 5.3] | Loss=0.08796 | Reg=0.00342 | acc=0.8906 | L2-Norm=18.482 | L2-Norm(final)=3.268 | 5009.4 samples/s | 78.3 steps/s
[Step=2750 Epoch= 5.4] | Loss=0.08512 | Reg=0.00341 | acc=0.9688 | L2-Norm=18.479 | L2-Norm(final)=3.258 | 5056.7 samples/s | 79.0 steps/s
[Step=2800 Epoch= 5.5] | Loss=0.08205 | Reg=0.00341 | acc=0.9219 | L2-Norm=18.479 | L2-Norm(final)=3.248 | 5102.3 samples/s | 79.7 steps/s
[Step=2850 Epoch= 5.6] | Loss=0.08039 | Reg=0.00341 | acc=0.9062 | L2-Norm=18.479 | L2-Norm(final)=3.240 | 5042.0 samples/s | 78.8 steps/s
[Step=2900 Epoch= 5.7] | Loss=0.07965 | Reg=0.00342 | acc=0.9688 | L2-Norm=18.481 | L2-Norm(final)=3.232 | 5068.4 samples/s | 79.2 steps/s
[Step=2950 Epoch= 5.8] | Loss=0.07730 | Reg=0.00342 | acc=0.9844 | L2-Norm=18.483 | L2-Norm(final)=3.225 | 5037.9 samples/s | 78.7 steps/s
[Step=3000 Epoch= 5.9] | Loss=0.07492 | Reg=0.00342 | acc=0.9688 | L2-Norm=18.485 | L2-Norm(final)=3.220 | 6212.7 samples/s | 97.1 steps/s
[Step=3050 Epoch= 6.0] | Loss=0.07250 | Reg=0.00342 | acc=0.9844 | L2-Norm=18.489 | L2-Norm(final)=3.217 | 1935.4 samples/s | 30.2 steps/s
[Step=3100 Epoch= 6.1] | Loss=0.07045 | Reg=0.00342 | acc=0.9375 | L2-Norm=18.492 | L2-Norm(final)=3.214 | 5066.2 samples/s | 79.2 steps/s
[Step=3150 Epoch= 6.2] | Loss=0.06892 | Reg=0.00342 | acc=0.9844 | L2-Norm=18.496 | L2-Norm(final)=3.211 | 4931.4 samples/s | 77.1 steps/s
[Step=3200 Epoch= 6.3] | Loss=0.06700 | Reg=0.00342 | acc=0.9844 | L2-Norm=18.502 | L2-Norm(final)=3.210 | 5065.9 samples/s | 79.2 steps/s
[Step=3250 Epoch= 6.4] | Loss=0.06573 | Reg=0.00343 | acc=0.9531 | L2-Norm=18.509 | L2-Norm(final)=3.209 | 5101.0 samples/s | 79.7 steps/s
[Step=3300 Epoch= 6.5] | Loss=0.06476 | Reg=0.00343 | acc=0.9688 | L2-Norm=18.515 | L2-Norm(final)=3.208 | 5014.1 samples/s | 78.3 steps/s
[Step=3350 Epoch= 6.5] | Loss=0.06397 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.522 | L2-Norm(final)=3.206 | 5050.5 samples/s | 78.9 steps/s
[Step=3400 Epoch= 6.6] | Loss=0.06332 | Reg=0.00343 | acc=0.9688 | L2-Norm=18.528 | L2-Norm(final)=3.204 | 5054.4 samples/s | 79.0 steps/s
[Step=3450 Epoch= 6.7] | Loss=0.06255 | Reg=0.00344 | acc=0.9531 | L2-Norm=18.535 | L2-Norm(final)=3.202 | 5079.6 samples/s | 79.4 steps/s
[Step=3500 Epoch= 6.8] | Loss=0.06174 | Reg=0.00344 | acc=0.9844 | L2-Norm=18.542 | L2-Norm(final)=3.200 | 5460.9 samples/s | 85.3 steps/s
[Step=3550 Epoch= 6.9] | Loss=0.06052 | Reg=0.00344 | acc=0.9688 | L2-Norm=18.549 | L2-Norm(final)=3.198 | 2009.9 samples/s | 31.4 steps/s
[Step=3600 Epoch= 7.0] | Loss=0.05896 | Reg=0.00344 | acc=0.9375 | L2-Norm=18.557 | L2-Norm(final)=3.197 | 5018.3 samples/s | 78.4 steps/s
[Step=3650 Epoch= 7.1] | Loss=0.05792 | Reg=0.00345 | acc=0.9688 | L2-Norm=18.565 | L2-Norm(final)=3.197 | 4998.6 samples/s | 78.1 steps/s
[Step=3700 Epoch= 7.2] | Loss=0.05682 | Reg=0.00345 | acc=0.9688 | L2-Norm=18.573 | L2-Norm(final)=3.197 | 5057.4 samples/s | 79.0 steps/s
[Step=3750 Epoch= 7.3] | Loss=0.05598 | Reg=0.00345 | acc=0.9844 | L2-Norm=18.582 | L2-Norm(final)=3.197 | 5059.0 samples/s | 79.0 steps/s
[Step=3800 Epoch= 7.4] | Loss=0.05509 | Reg=0.00346 | acc=0.9531 | L2-Norm=18.590 | L2-Norm(final)=3.196 | 5044.1 samples/s | 78.8 steps/s
[Step=3850 Epoch= 7.5] | Loss=0.05449 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.599 | L2-Norm(final)=3.196 | 5060.3 samples/s | 79.1 steps/s
[Step=3900 Epoch= 7.6] | Loss=0.05408 | Reg=0.00346 | acc=0.9219 | L2-Norm=18.607 | L2-Norm(final)=3.196 | 5134.8 samples/s | 80.2 steps/s
[Step=3950 Epoch= 7.7] | Loss=0.05336 | Reg=0.00347 | acc=0.9531 | L2-Norm=18.615 | L2-Norm(final)=3.195 | 5024.8 samples/s | 78.5 steps/s
[Step=4000 Epoch= 7.8] | Loss=0.05319 | Reg=0.00347 | acc=0.9375 | L2-Norm=18.624 | L2-Norm(final)=3.195 | 5089.3 samples/s | 79.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step4000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=4001 Epoch=15.4] | Loss=0.07836 | Reg=0.00252 | acc=0.9688 | L2-Norm=15.887 | L2-Norm(final)=3.412 | 3978.9 samples/s | 62.2 steps/s
[Step=4050 Epoch=15.6] | Loss=0.04718 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.169 | L2-Norm(final)=3.483 | 4902.0 samples/s | 76.6 steps/s
[Step=4100 Epoch=15.8] | Loss=0.04215 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.351 | L2-Norm(final)=3.534 | 5466.2 samples/s | 85.4 steps/s
[Step=4150 Epoch=16.0] | Loss=0.03560 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.480 | L2-Norm(final)=3.570 | 5159.1 samples/s | 80.6 steps/s
[Step=4200 Epoch=16.2] | Loss=0.03211 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.574 | L2-Norm(final)=3.607 | 5320.1 samples/s | 83.1 steps/s
[Step=4250 Epoch=16.4] | Loss=0.02960 | Reg=0.00278 | acc=0.9844 | L2-Norm=16.657 | L2-Norm(final)=3.644 | 7132.0 samples/s | 111.4 steps/s
[Step=4300 Epoch=16.6] | Loss=0.02735 | Reg=0.00280 | acc=0.9531 | L2-Norm=16.722 | L2-Norm(final)=3.678 | 1926.2 samples/s | 30.1 steps/s
[Step=4350 Epoch=16.7] | Loss=0.02511 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.780 | L2-Norm(final)=3.713 | 5378.7 samples/s | 84.0 steps/s
[Step=4400 Epoch=16.9] | Loss=0.02364 | Reg=0.00283 | acc=0.9688 | L2-Norm=16.833 | L2-Norm(final)=3.747 | 5287.3 samples/s | 82.6 steps/s
[Step=4450 Epoch=17.1] | Loss=0.02275 | Reg=0.00285 | acc=0.9844 | L2-Norm=16.882 | L2-Norm(final)=3.780 | 5351.3 samples/s | 83.6 steps/s
[Step=4500 Epoch=17.3] | Loss=0.02184 | Reg=0.00287 | acc=0.9688 | L2-Norm=16.930 | L2-Norm(final)=3.812 | 6176.1 samples/s | 96.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=17.3] | Loss=0.02158 | Reg=0.00303 | acc=0.9844 | L2-Norm=17.405 | L2-Norm(final)=4.135 | 3965.3 samples/s | 62.0 steps/s
[Step=4550 Epoch=17.5] | Loss=0.03999 | Reg=0.00306 | acc=0.9688 | L2-Norm=17.507 | L2-Norm(final)=4.099 | 4303.8 samples/s | 67.2 steps/s
[Step=4600 Epoch=17.7] | Loss=0.02893 | Reg=0.00308 | acc=0.9844 | L2-Norm=17.560 | L2-Norm(final)=4.085 | 4837.4 samples/s | 75.6 steps/s
[Step=4650 Epoch=17.9] | Loss=0.02174 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.572 | L2-Norm(final)=4.084 | 4813.8 samples/s | 75.2 steps/s
[Step=4700 Epoch=18.1] | Loss=0.01721 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.569 | L2-Norm(final)=4.088 | 4817.6 samples/s | 75.3 steps/s
[Step=4750 Epoch=18.3] | Loss=0.01469 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.560 | L2-Norm(final)=4.094 | 6100.8 samples/s | 95.3 steps/s
[Step=4800 Epoch=18.5] | Loss=0.01250 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.549 | L2-Norm(final)=4.100 | 1867.6 samples/s | 29.2 steps/s
[Step=4850 Epoch=18.7] | Loss=0.01077 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.533 | L2-Norm(final)=4.106 | 4745.3 samples/s | 74.1 steps/s
[Step=4900 Epoch=18.9] | Loss=0.00944 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.513 | L2-Norm(final)=4.111 | 4800.2 samples/s | 75.0 steps/s
[Step=4950 Epoch=19.1] | Loss=0.00846 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.490 | L2-Norm(final)=4.116 | 4828.8 samples/s | 75.5 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00764 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.466 | L2-Norm(final)=4.120 | 5437.8 samples/s | 85.0 steps/s
[Step=5050 Epoch=19.4] | Loss=0.00698 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.441 | L2-Norm(final)=4.124 | 1938.9 samples/s | 30.3 steps/s
[Step=5100 Epoch=19.6] | Loss=0.00641 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.414 | L2-Norm(final)=4.127 | 4793.0 samples/s | 74.9 steps/s
[Step=5150 Epoch=19.8] | Loss=0.00592 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.387 | L2-Norm(final)=4.131 | 4878.2 samples/s | 76.2 steps/s
[Step=5200 Epoch=20.0] | Loss=0.00550 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.359 | L2-Norm(final)=4.133 | 4651.5 samples/s | 72.7 steps/s
[Step=5250 Epoch=20.2] | Loss=0.00514 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.331 | L2-Norm(final)=4.136 | 4909.6 samples/s | 76.7 steps/s
[Step=5300 Epoch=20.4] | Loss=0.00482 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.301 | L2-Norm(final)=4.138 | 2015.1 samples/s | 31.5 steps/s
[Step=5350 Epoch=20.6] | Loss=0.00454 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.271 | L2-Norm(final)=4.141 | 4935.4 samples/s | 77.1 steps/s
[Step=5400 Epoch=20.8] | Loss=0.00429 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.241 | L2-Norm(final)=4.143 | 4728.0 samples/s | 73.9 steps/s
[Step=5450 Epoch=21.0] | Loss=0.00406 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.210 | L2-Norm(final)=4.144 | 4875.4 samples/s | 76.2 steps/s
[Step=5500 Epoch=21.2] | Loss=0.00386 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.179 | L2-Norm(final)=4.146 | 4714.8 samples/s | 73.7 steps/s
[Step=5550 Epoch=21.4] | Loss=0.00368 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.148 | L2-Norm(final)=4.148 | 2029.6 samples/s | 31.7 steps/s
[Step=5600 Epoch=21.6] | Loss=0.00351 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.117 | L2-Norm(final)=4.149 | 4983.0 samples/s | 77.9 steps/s
[Step=5650 Epoch=21.7] | Loss=0.00336 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.085 | L2-Norm(final)=4.151 | 4662.8 samples/s | 72.9 steps/s
[Step=5700 Epoch=21.9] | Loss=0.00322 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.053 | L2-Norm(final)=4.152 | 4756.7 samples/s | 74.3 steps/s
[Step=5750 Epoch=22.1] | Loss=0.00309 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.021 | L2-Norm(final)=4.153 | 4780.5 samples/s | 74.7 steps/s
[Step=5800 Epoch=22.3] | Loss=0.00297 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.989 | L2-Norm(final)=4.155 | 7098.3 samples/s | 110.9 steps/s
[Step=5850 Epoch=22.5] | Loss=0.00286 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.956 | L2-Norm(final)=4.156 | 1795.6 samples/s | 28.1 steps/s
[Step=5900 Epoch=22.7] | Loss=0.00276 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.924 | L2-Norm(final)=4.157 | 4781.1 samples/s | 74.7 steps/s
[Step=5950 Epoch=22.9] | Loss=0.00267 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.891 | L2-Norm(final)=4.158 | 4744.4 samples/s | 74.1 steps/s
[Step=6000 Epoch=23.1] | Loss=0.00258 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.858 | L2-Norm(final)=4.159 | 4740.5 samples/s | 74.1 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step6000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07363 | acc=0.9445 | tpr=0.9435 | fpr=0.0535 | 4461.8 samples/s | 17.4 steps/s
Avg test loss: 0.07557, Avg test acc: 0.94399, Avg tpr: 0.94306, Avg fpr: 0.05397, total FA: 421

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07104 | acc=0.9494 | tpr=0.9507 | fpr=0.0535 | 4511.5 samples/s | 17.6 steps/s
Avg test loss: 0.07610, Avg test acc: 0.94731, Avg tpr: 0.94894, Avg fpr: 0.05627, total FA: 439

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.14562 | acc=0.3102 | tpr=0.0244 | fpr=0.0691 | 4521.4 samples/s | 17.7 steps/s
Avg test loss: 4.15241, Avg test acc: 0.30764, Avg tpr: 0.02366, Avg fpr: 0.06781, total FA: 529

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.74828 | acc=0.3146 | tpr=0.0080 | fpr=0.0196 | 4471.6 samples/s | 17.5 steps/s
Avg test loss: 4.76162, Avg test acc: 0.31144, Avg tpr: 0.00769, Avg fpr: 0.02051, total FA: 160

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.38788 | acc=0.1261 | tpr=0.6593 | fpr=0.8835 | 4474.6 samples/s | 17.5 steps/s
[Step= 100] | Loss=3.36936 | acc=0.1265 | tpr=0.6546 | fpr=0.8833 | 8814.7 samples/s | 34.4 steps/s
[Step= 150] | Loss=3.37015 | acc=0.1262 | tpr=0.6657 | fpr=0.8838 | 8907.3 samples/s | 34.8 steps/s
[Step= 200] | Loss=3.37258 | acc=0.1266 | tpr=0.6754 | fpr=0.8834 | 8756.8 samples/s | 34.2 steps/s
[Step= 250] | Loss=3.37128 | acc=0.1280 | tpr=0.6760 | fpr=0.8820 | 9039.6 samples/s | 35.3 steps/s
[Step= 300] | Loss=3.37081 | acc=0.1282 | tpr=0.6771 | fpr=0.8818 | 8832.3 samples/s | 34.5 steps/s
[Step= 350] | Loss=3.37131 | acc=0.1281 | tpr=0.6738 | fpr=0.8818 | 8505.2 samples/s | 33.2 steps/s
[Step= 400] | Loss=3.36978 | acc=0.1283 | tpr=0.6751 | fpr=0.8816 | 9255.2 samples/s | 36.2 steps/s
[Step= 450] | Loss=3.37293 | acc=0.1283 | tpr=0.6733 | fpr=0.8816 | 8718.3 samples/s | 34.1 steps/s
[Step= 500] | Loss=3.37327 | acc=0.1283 | tpr=0.6714 | fpr=0.8815 | 8828.6 samples/s | 34.5 steps/s
[Step= 550] | Loss=3.37512 | acc=0.1279 | tpr=0.6725 | fpr=0.8819 | 15473.9 samples/s | 60.4 steps/s
Avg test loss: 3.37584, Avg test acc: 0.12785, Avg tpr: 0.67274, Avg fpr: 0.88205, total FA: 122471

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.25921 | acc=0.1352 | tpr=0.7566 | fpr=0.8760 | 4475.2 samples/s | 17.5 steps/s
[Step= 100] | Loss=3.22413 | acc=0.1366 | tpr=0.7825 | fpr=0.8755 | 8853.8 samples/s | 34.6 steps/s
[Step= 150] | Loss=3.22862 | acc=0.1361 | tpr=0.7781 | fpr=0.8757 | 8691.9 samples/s | 34.0 steps/s
[Step= 200] | Loss=3.22520 | acc=0.1355 | tpr=0.7661 | fpr=0.8759 | 8755.1 samples/s | 34.2 steps/s
[Step= 250] | Loss=3.22839 | acc=0.1363 | tpr=0.7703 | fpr=0.8753 | 8699.3 samples/s | 34.0 steps/s
[Step= 300] | Loss=3.22815 | acc=0.1365 | tpr=0.7702 | fpr=0.8750 | 9039.7 samples/s | 35.3 steps/s
[Step= 350] | Loss=3.23076 | acc=0.1361 | tpr=0.7621 | fpr=0.8753 | 8457.3 samples/s | 33.0 steps/s
[Step= 400] | Loss=3.23011 | acc=0.1367 | tpr=0.7604 | fpr=0.8747 | 8942.0 samples/s | 34.9 steps/s
[Step= 450] | Loss=3.23238 | acc=0.1365 | tpr=0.7590 | fpr=0.8748 | 8969.3 samples/s | 35.0 steps/s
[Step= 500] | Loss=3.23362 | acc=0.1365 | tpr=0.7595 | fpr=0.8747 | 8670.4 samples/s | 33.9 steps/s
[Step= 550] | Loss=3.23543 | acc=0.1363 | tpr=0.7581 | fpr=0.8749 | 16244.8 samples/s | 63.5 steps/s
Avg test loss: 3.23585, Avg test acc: 0.13637, Avg tpr: 0.75872, Avg fpr: 0.87494, total FA: 121484

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09230 | acc=0.9813 | tpr=0.9159 | fpr=0.0175 | 4438.4 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.09527 | acc=0.9805 | tpr=0.9339 | fpr=0.0187 | 8850.7 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.09853 | acc=0.9795 | tpr=0.9380 | fpr=0.0198 | 8621.0 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.09961 | acc=0.9794 | tpr=0.9366 | fpr=0.0198 | 8813.3 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.09716 | acc=0.9797 | tpr=0.9336 | fpr=0.0195 | 8984.5 samples/s | 35.1 steps/s
[Step= 300] | Loss=0.09823 | acc=0.9794 | tpr=0.9273 | fpr=0.0196 | 8695.6 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.09932 | acc=0.9791 | tpr=0.9267 | fpr=0.0199 | 9006.5 samples/s | 35.2 steps/s
[Step= 400] | Loss=0.10027 | acc=0.9790 | tpr=0.9234 | fpr=0.0200 | 8480.0 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.10260 | acc=0.9786 | tpr=0.9216 | fpr=0.0203 | 8791.3 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.10208 | acc=0.9788 | tpr=0.9229 | fpr=0.0202 | 8805.7 samples/s | 34.4 steps/s
[Step= 550] | Loss=0.10124 | acc=0.9789 | tpr=0.9196 | fpr=0.0201 | 15938.5 samples/s | 62.3 steps/s
Avg test loss: 0.10104, Avg test acc: 0.97887, Avg tpr: 0.91997, Avg fpr: 0.02006, total FA: 2785

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10932 | acc=0.9805 | tpr=0.9204 | fpr=0.0184 | 4464.7 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.11455 | acc=0.9798 | tpr=0.9382 | fpr=0.0194 | 8982.1 samples/s | 35.1 steps/s
[Step= 150] | Loss=0.12044 | acc=0.9790 | tpr=0.9366 | fpr=0.0202 | 9310.1 samples/s | 36.4 steps/s
[Step= 200] | Loss=0.12137 | acc=0.9794 | tpr=0.9443 | fpr=0.0200 | 8192.2 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.11871 | acc=0.9794 | tpr=0.9432 | fpr=0.0199 | 8535.6 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.12096 | acc=0.9789 | tpr=0.9404 | fpr=0.0204 | 9022.4 samples/s | 35.2 steps/s
[Step= 350] | Loss=0.12198 | acc=0.9789 | tpr=0.9436 | fpr=0.0204 | 9025.0 samples/s | 35.3 steps/s
[Step= 400] | Loss=0.12272 | acc=0.9787 | tpr=0.9426 | fpr=0.0207 | 8475.9 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.12546 | acc=0.9783 | tpr=0.9416 | fpr=0.0210 | 8820.8 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.12519 | acc=0.9783 | tpr=0.9419 | fpr=0.0210 | 8923.7 samples/s | 34.9 steps/s
[Step= 550] | Loss=0.12434 | acc=0.9784 | tpr=0.9391 | fpr=0.0209 | 15645.7 samples/s | 61.1 steps/s
Avg test loss: 0.12409, Avg test acc: 0.97845, Avg tpr: 0.93899, Avg fpr: 0.02084, total FA: 2893

server round 4/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.12195 | Reg=0.00247 | acc=0.9219 | L2-Norm=15.721 | L2-Norm(final)=3.355 | 3465.2 samples/s | 54.1 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.08188 | Reg=0.00256 | acc=0.9688 | L2-Norm=16.009 | L2-Norm(final)=3.430 | 5457.5 samples/s | 85.3 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.07563 | Reg=0.00263 | acc=0.9531 | L2-Norm=16.204 | L2-Norm(final)=3.482 | 5654.1 samples/s | 88.3 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.07122 | Reg=0.00267 | acc=0.9688 | L2-Norm=16.344 | L2-Norm(final)=3.517 | 5774.2 samples/s | 90.2 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.06954 | Reg=0.00271 | acc=0.9219 | L2-Norm=16.453 | L2-Norm(final)=3.551 | 5609.1 samples/s | 87.6 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.06747 | Reg=0.00274 | acc=0.9375 | L2-Norm=16.539 | L2-Norm(final)=3.579 | 5653.0 samples/s | 88.3 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.06748 | Reg=0.00276 | acc=0.9375 | L2-Norm=16.615 | L2-Norm(final)=3.604 | 5686.5 samples/s | 88.9 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.06618 | Reg=0.00278 | acc=0.9531 | L2-Norm=16.680 | L2-Norm(final)=3.625 | 5683.3 samples/s | 88.8 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.06593 | Reg=0.00280 | acc=0.9688 | L2-Norm=16.738 | L2-Norm(final)=3.645 | 5708.9 samples/s | 89.2 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.06534 | Reg=0.00282 | acc=0.9219 | L2-Norm=16.791 | L2-Norm(final)=3.664 | 5654.9 samples/s | 88.4 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.06531 | Reg=0.00284 | acc=0.9844 | L2-Norm=16.843 | L2-Norm(final)=3.682 | 7147.0 samples/s | 111.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch= 8.8] | Loss=0.07986 | Reg=0.00302 | acc=0.9375 | L2-Norm=17.369 | L2-Norm(final)=3.868 | 3400.4 samples/s | 53.1 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.07462 | Reg=0.00304 | acc=0.9219 | L2-Norm=17.440 | L2-Norm(final)=3.870 | 5139.4 samples/s | 80.3 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.08023 | Reg=0.00306 | acc=0.9062 | L2-Norm=17.484 | L2-Norm(final)=3.841 | 5076.7 samples/s | 79.3 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.07593 | Reg=0.00307 | acc=0.9062 | L2-Norm=17.522 | L2-Norm(final)=3.830 | 4984.2 samples/s | 77.9 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.07303 | Reg=0.00308 | acc=0.9375 | L2-Norm=17.552 | L2-Norm(final)=3.823 | 5035.5 samples/s | 78.7 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.07082 | Reg=0.00309 | acc=0.9531 | L2-Norm=17.574 | L2-Norm(final)=3.816 | 5041.0 samples/s | 78.8 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.06825 | Reg=0.00310 | acc=0.9531 | L2-Norm=17.595 | L2-Norm(final)=3.810 | 4988.8 samples/s | 77.9 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.06648 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.615 | L2-Norm(final)=3.806 | 5029.8 samples/s | 78.6 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.06559 | Reg=0.00311 | acc=0.9531 | L2-Norm=17.635 | L2-Norm(final)=3.801 | 5059.9 samples/s | 79.1 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.06424 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.654 | L2-Norm(final)=3.796 | 5030.5 samples/s | 78.6 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.06368 | Reg=0.00312 | acc=0.9844 | L2-Norm=17.673 | L2-Norm(final)=3.792 | 6174.1 samples/s | 96.5 steps/s
[Step=5050 Epoch= 9.8] | Loss=0.06140 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.693 | L2-Norm(final)=3.787 | 1870.5 samples/s | 29.2 steps/s
[Step=5100 Epoch= 9.9] | Loss=0.05923 | Reg=0.00314 | acc=0.9219 | L2-Norm=17.712 | L2-Norm(final)=3.785 | 4965.6 samples/s | 77.6 steps/s
[Step=5150 Epoch=10.0] | Loss=0.05773 | Reg=0.00314 | acc=0.9375 | L2-Norm=17.731 | L2-Norm(final)=3.784 | 5025.1 samples/s | 78.5 steps/s
[Step=5200 Epoch=10.1] | Loss=0.05651 | Reg=0.00315 | acc=0.9688 | L2-Norm=17.750 | L2-Norm(final)=3.783 | 5022.8 samples/s | 78.5 steps/s
[Step=5250 Epoch=10.2] | Loss=0.05525 | Reg=0.00316 | acc=0.9844 | L2-Norm=17.768 | L2-Norm(final)=3.783 | 5135.5 samples/s | 80.2 steps/s
[Step=5300 Epoch=10.3] | Loss=0.05442 | Reg=0.00316 | acc=0.9688 | L2-Norm=17.787 | L2-Norm(final)=3.783 | 4967.0 samples/s | 77.6 steps/s
[Step=5350 Epoch=10.4] | Loss=0.05342 | Reg=0.00317 | acc=0.9531 | L2-Norm=17.805 | L2-Norm(final)=3.782 | 5110.2 samples/s | 79.8 steps/s
[Step=5400 Epoch=10.5] | Loss=0.05297 | Reg=0.00318 | acc=0.9688 | L2-Norm=17.821 | L2-Norm(final)=3.781 | 5000.7 samples/s | 78.1 steps/s
[Step=5450 Epoch=10.6] | Loss=0.05227 | Reg=0.00318 | acc=0.9531 | L2-Norm=17.836 | L2-Norm(final)=3.780 | 4920.1 samples/s | 76.9 steps/s
[Step=5500 Epoch=10.7] | Loss=0.05171 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.851 | L2-Norm(final)=3.779 | 5406.8 samples/s | 84.5 steps/s
[Step=5550 Epoch=10.8] | Loss=0.05083 | Reg=0.00319 | acc=0.9531 | L2-Norm=17.866 | L2-Norm(final)=3.777 | 1960.3 samples/s | 30.6 steps/s
[Step=5600 Epoch=10.9] | Loss=0.04963 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.881 | L2-Norm(final)=3.776 | 5057.4 samples/s | 79.0 steps/s
[Step=5650 Epoch=11.0] | Loss=0.04889 | Reg=0.00320 | acc=0.9688 | L2-Norm=17.896 | L2-Norm(final)=3.776 | 4995.0 samples/s | 78.0 steps/s
[Step=5700 Epoch=11.1] | Loss=0.04838 | Reg=0.00321 | acc=0.9531 | L2-Norm=17.912 | L2-Norm(final)=3.775 | 5111.4 samples/s | 79.9 steps/s
[Step=5750 Epoch=11.2] | Loss=0.04770 | Reg=0.00321 | acc=0.9688 | L2-Norm=17.927 | L2-Norm(final)=3.774 | 5061.5 samples/s | 79.1 steps/s
[Step=5800 Epoch=11.3] | Loss=0.04722 | Reg=0.00322 | acc=0.9688 | L2-Norm=17.942 | L2-Norm(final)=3.773 | 4999.6 samples/s | 78.1 steps/s
[Step=5850 Epoch=11.4] | Loss=0.04682 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.956 | L2-Norm(final)=3.772 | 5083.7 samples/s | 79.4 steps/s
[Step=5900 Epoch=11.5] | Loss=0.04623 | Reg=0.00323 | acc=0.9531 | L2-Norm=17.970 | L2-Norm(final)=3.771 | 5085.3 samples/s | 79.5 steps/s
[Step=5950 Epoch=11.6] | Loss=0.04575 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.985 | L2-Norm(final)=3.771 | 5006.8 samples/s | 78.2 steps/s
[Step=6000 Epoch=11.7] | Loss=0.04542 | Reg=0.00324 | acc=0.9375 | L2-Norm=17.999 | L2-Norm(final)=3.770 | 5055.2 samples/s | 79.0 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step6000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=4001 Epoch= 7.8] | Loss=0.08542 | Reg=0.00247 | acc=0.9531 | L2-Norm=15.721 | L2-Norm(final)=3.168 | 4053.7 samples/s | 63.3 steps/s
[Step=4050 Epoch= 7.9] | Loss=0.07961 | Reg=0.00255 | acc=0.9844 | L2-Norm=15.981 | L2-Norm(final)=3.244 | 5126.1 samples/s | 80.1 steps/s
[Step=4100 Epoch= 8.0] | Loss=0.07712 | Reg=0.00262 | acc=0.9375 | L2-Norm=16.178 | L2-Norm(final)=3.304 | 5568.7 samples/s | 87.0 steps/s
[Step=4150 Epoch= 8.1] | Loss=0.07267 | Reg=0.00267 | acc=0.9219 | L2-Norm=16.325 | L2-Norm(final)=3.347 | 5677.6 samples/s | 88.7 steps/s
[Step=4200 Epoch= 8.2] | Loss=0.07259 | Reg=0.00270 | acc=0.9375 | L2-Norm=16.438 | L2-Norm(final)=3.381 | 5758.2 samples/s | 90.0 steps/s
[Step=4250 Epoch= 8.3] | Loss=0.07045 | Reg=0.00274 | acc=0.9531 | L2-Norm=16.536 | L2-Norm(final)=3.411 | 5545.3 samples/s | 86.6 steps/s
[Step=4300 Epoch= 8.4] | Loss=0.07003 | Reg=0.00277 | acc=0.9375 | L2-Norm=16.625 | L2-Norm(final)=3.437 | 5695.7 samples/s | 89.0 steps/s
[Step=4350 Epoch= 8.5] | Loss=0.06867 | Reg=0.00279 | acc=0.9688 | L2-Norm=16.705 | L2-Norm(final)=3.460 | 5600.8 samples/s | 87.5 steps/s
[Step=4400 Epoch= 8.6] | Loss=0.06803 | Reg=0.00282 | acc=0.9688 | L2-Norm=16.779 | L2-Norm(final)=3.484 | 5695.6 samples/s | 89.0 steps/s
[Step=4450 Epoch= 8.7] | Loss=0.06746 | Reg=0.00284 | acc=0.9844 | L2-Norm=16.850 | L2-Norm(final)=3.507 | 5667.5 samples/s | 88.6 steps/s
[Step=4500 Epoch= 8.8] | Loss=0.06688 | Reg=0.00286 | acc=0.9688 | L2-Norm=16.914 | L2-Norm(final)=3.528 | 7182.2 samples/s | 112.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch= 8.8] | Loss=0.04290 | Reg=0.00307 | acc=0.9688 | L2-Norm=17.526 | L2-Norm(final)=3.738 | 3813.6 samples/s | 59.6 steps/s
[Step=4550 Epoch= 8.9] | Loss=0.06422 | Reg=0.00308 | acc=0.9688 | L2-Norm=17.547 | L2-Norm(final)=3.740 | 5028.4 samples/s | 78.6 steps/s
[Step=4600 Epoch= 9.0] | Loss=0.07141 | Reg=0.00309 | acc=0.8594 | L2-Norm=17.575 | L2-Norm(final)=3.719 | 5065.5 samples/s | 79.1 steps/s
[Step=4650 Epoch= 9.1] | Loss=0.07047 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.605 | L2-Norm(final)=3.706 | 4998.1 samples/s | 78.1 steps/s
[Step=4700 Epoch= 9.2] | Loss=0.07007 | Reg=0.00311 | acc=0.9688 | L2-Norm=17.634 | L2-Norm(final)=3.696 | 5021.1 samples/s | 78.5 steps/s
[Step=4750 Epoch= 9.3] | Loss=0.07022 | Reg=0.00312 | acc=0.9375 | L2-Norm=17.662 | L2-Norm(final)=3.685 | 5049.0 samples/s | 78.9 steps/s
[Step=4800 Epoch= 9.4] | Loss=0.06913 | Reg=0.00313 | acc=0.9531 | L2-Norm=17.683 | L2-Norm(final)=3.674 | 4987.0 samples/s | 77.9 steps/s
[Step=4850 Epoch= 9.5] | Loss=0.06838 | Reg=0.00313 | acc=0.9688 | L2-Norm=17.700 | L2-Norm(final)=3.665 | 5020.3 samples/s | 78.4 steps/s
[Step=4900 Epoch= 9.6] | Loss=0.06737 | Reg=0.00314 | acc=0.9688 | L2-Norm=17.716 | L2-Norm(final)=3.659 | 5024.7 samples/s | 78.5 steps/s
[Step=4950 Epoch= 9.7] | Loss=0.06587 | Reg=0.00314 | acc=0.9531 | L2-Norm=17.732 | L2-Norm(final)=3.652 | 5048.5 samples/s | 78.9 steps/s
[Step=5000 Epoch= 9.8] | Loss=0.06443 | Reg=0.00315 | acc=0.9531 | L2-Norm=17.749 | L2-Norm(final)=3.648 | 6249.3 samples/s | 97.6 steps/s
[Step=5050 Epoch= 9.9] | Loss=0.06242 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.764 | L2-Norm(final)=3.644 | 1932.6 samples/s | 30.2 steps/s
[Step=5100 Epoch=10.0] | Loss=0.06024 | Reg=0.00316 | acc=0.9375 | L2-Norm=17.781 | L2-Norm(final)=3.642 | 5041.0 samples/s | 78.8 steps/s
[Step=5150 Epoch=10.1] | Loss=0.05857 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.799 | L2-Norm(final)=3.640 | 5061.3 samples/s | 79.1 steps/s
[Step=5200 Epoch=10.2] | Loss=0.05673 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.817 | L2-Norm(final)=3.638 | 5045.5 samples/s | 78.8 steps/s
[Step=5250 Epoch=10.3] | Loss=0.05619 | Reg=0.00318 | acc=0.9688 | L2-Norm=17.836 | L2-Norm(final)=3.637 | 4989.2 samples/s | 78.0 steps/s
[Step=5300 Epoch=10.4] | Loss=0.05535 | Reg=0.00319 | acc=0.9375 | L2-Norm=17.853 | L2-Norm(final)=3.634 | 5077.9 samples/s | 79.3 steps/s
[Step=5350 Epoch=10.5] | Loss=0.05450 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.868 | L2-Norm(final)=3.632 | 5092.6 samples/s | 79.6 steps/s
[Step=5400 Epoch=10.6] | Loss=0.05396 | Reg=0.00320 | acc=0.9219 | L2-Norm=17.882 | L2-Norm(final)=3.630 | 5038.4 samples/s | 78.7 steps/s
[Step=5450 Epoch=10.7] | Loss=0.05340 | Reg=0.00320 | acc=0.9375 | L2-Norm=17.897 | L2-Norm(final)=3.627 | 5056.9 samples/s | 79.0 steps/s
[Step=5500 Epoch=10.8] | Loss=0.05270 | Reg=0.00321 | acc=0.9531 | L2-Norm=17.912 | L2-Norm(final)=3.624 | 5483.8 samples/s | 85.7 steps/s
[Step=5550 Epoch=10.9] | Loss=0.05218 | Reg=0.00321 | acc=0.9688 | L2-Norm=17.926 | L2-Norm(final)=3.621 | 2019.3 samples/s | 31.6 steps/s
[Step=5600 Epoch=10.9] | Loss=0.05112 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.940 | L2-Norm(final)=3.619 | 4997.4 samples/s | 78.1 steps/s
[Step=5650 Epoch=11.0] | Loss=0.05027 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.953 | L2-Norm(final)=3.617 | 5021.2 samples/s | 78.5 steps/s
[Step=5700 Epoch=11.1] | Loss=0.04979 | Reg=0.00323 | acc=0.9375 | L2-Norm=17.966 | L2-Norm(final)=3.616 | 5141.1 samples/s | 80.3 steps/s
[Step=5750 Epoch=11.2] | Loss=0.04901 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.978 | L2-Norm(final)=3.614 | 5009.1 samples/s | 78.3 steps/s
[Step=5800 Epoch=11.3] | Loss=0.04829 | Reg=0.00324 | acc=0.9688 | L2-Norm=17.991 | L2-Norm(final)=3.613 | 5039.7 samples/s | 78.7 steps/s
[Step=5850 Epoch=11.4] | Loss=0.04759 | Reg=0.00324 | acc=0.9688 | L2-Norm=18.002 | L2-Norm(final)=3.611 | 5107.1 samples/s | 79.8 steps/s
[Step=5900 Epoch=11.5] | Loss=0.04690 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.014 | L2-Norm(final)=3.610 | 4992.5 samples/s | 78.0 steps/s
[Step=5950 Epoch=11.6] | Loss=0.04657 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.025 | L2-Norm(final)=3.609 | 5070.3 samples/s | 79.2 steps/s
[Step=6000 Epoch=11.7] | Loss=0.04604 | Reg=0.00325 | acc=0.9375 | L2-Norm=18.037 | L2-Norm(final)=3.608 | 5055.3 samples/s | 79.0 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step6000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06939 | acc=0.9541 | tpr=0.9577 | fpr=0.0538 | 4512.4 samples/s | 17.6 steps/s
Avg test loss: 0.06939, Avg test acc: 0.95396, Avg tpr: 0.95914, Avg fpr: 0.05743, total FA: 448

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06911 | acc=0.9558 | tpr=0.9653 | fpr=0.0649 | 4464.2 samples/s | 17.4 steps/s
Avg test loss: 0.07371, Avg test acc: 0.95432, Avg tpr: 0.96386, Avg fpr: 0.06666, total FA: 520

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.14562 | acc=0.3102 | tpr=0.0244 | fpr=0.0691 | 4429.9 samples/s | 17.3 steps/s
Avg test loss: 4.15241, Avg test acc: 0.30764, Avg tpr: 0.02366, Avg fpr: 0.06781, total FA: 529

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.74828 | acc=0.3146 | tpr=0.0080 | fpr=0.0196 | 4441.6 samples/s | 17.4 steps/s
Avg test loss: 4.76162, Avg test acc: 0.31144, Avg tpr: 0.00769, Avg fpr: 0.02051, total FA: 160

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.41742 | acc=0.0950 | tpr=0.7832 | fpr=0.9174 | 4483.1 samples/s | 17.5 steps/s
[Step= 100] | Loss=4.39982 | acc=0.0971 | tpr=0.7569 | fpr=0.9152 | 8882.5 samples/s | 34.7 steps/s
[Step= 150] | Loss=4.40174 | acc=0.0963 | tpr=0.7695 | fpr=0.9161 | 9000.2 samples/s | 35.2 steps/s
[Step= 200] | Loss=4.40632 | acc=0.0961 | tpr=0.7760 | fpr=0.9163 | 8800.1 samples/s | 34.4 steps/s
[Step= 250] | Loss=4.40870 | acc=0.0958 | tpr=0.7790 | fpr=0.9166 | 8736.6 samples/s | 34.1 steps/s
[Step= 300] | Loss=4.40981 | acc=0.0958 | tpr=0.7825 | fpr=0.9167 | 8711.5 samples/s | 34.0 steps/s
[Step= 350] | Loss=4.41128 | acc=0.0957 | tpr=0.7815 | fpr=0.9167 | 8702.4 samples/s | 34.0 steps/s
[Step= 400] | Loss=4.41114 | acc=0.0958 | tpr=0.7877 | fpr=0.9168 | 9104.6 samples/s | 35.6 steps/s
[Step= 450] | Loss=4.41580 | acc=0.0959 | tpr=0.7882 | fpr=0.9167 | 8412.7 samples/s | 32.9 steps/s
[Step= 500] | Loss=4.41668 | acc=0.0956 | tpr=0.7890 | fpr=0.9169 | 8957.0 samples/s | 35.0 steps/s
[Step= 550] | Loss=4.41740 | acc=0.0958 | tpr=0.7923 | fpr=0.9169 | 15625.2 samples/s | 61.0 steps/s
Avg test loss: 4.41863, Avg test acc: 0.09570, Avg tpr: 0.79239, Avg fpr: 0.91696, total FA: 127318

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.63186 | acc=0.1128 | tpr=0.7920 | fpr=0.8994 | 4420.5 samples/s | 17.3 steps/s
[Step= 100] | Loss=4.60912 | acc=0.1137 | tpr=0.7953 | fpr=0.8990 | 8819.3 samples/s | 34.5 steps/s
[Step= 150] | Loss=4.63002 | acc=0.1126 | tpr=0.7968 | fpr=0.9000 | 8982.7 samples/s | 35.1 steps/s
[Step= 200] | Loss=4.62897 | acc=0.1130 | tpr=0.7945 | fpr=0.8994 | 8414.5 samples/s | 32.9 steps/s
[Step= 250] | Loss=4.62930 | acc=0.1134 | tpr=0.8017 | fpr=0.8992 | 9110.8 samples/s | 35.6 steps/s
[Step= 300] | Loss=4.62722 | acc=0.1135 | tpr=0.8065 | fpr=0.8991 | 8763.1 samples/s | 34.2 steps/s
[Step= 350] | Loss=4.62627 | acc=0.1130 | tpr=0.8034 | fpr=0.8995 | 8716.9 samples/s | 34.1 steps/s
[Step= 400] | Loss=4.62131 | acc=0.1138 | tpr=0.8036 | fpr=0.8988 | 8799.3 samples/s | 34.4 steps/s
[Step= 450] | Loss=4.62448 | acc=0.1137 | tpr=0.7994 | fpr=0.8988 | 8772.8 samples/s | 34.3 steps/s
[Step= 500] | Loss=4.62696 | acc=0.1133 | tpr=0.7996 | fpr=0.8991 | 8824.5 samples/s | 34.5 steps/s
[Step= 550] | Loss=4.63020 | acc=0.1135 | tpr=0.8014 | fpr=0.8990 | 15914.8 samples/s | 62.2 steps/s
Avg test loss: 4.63060, Avg test acc: 0.11351, Avg tpr: 0.80111, Avg fpr: 0.89899, total FA: 124823

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09230 | acc=0.9813 | tpr=0.9159 | fpr=0.0175 | 4416.0 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.09527 | acc=0.9805 | tpr=0.9339 | fpr=0.0187 | 8887.6 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.09853 | acc=0.9795 | tpr=0.9380 | fpr=0.0198 | 8767.5 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.09961 | acc=0.9794 | tpr=0.9366 | fpr=0.0198 | 8694.5 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.09716 | acc=0.9797 | tpr=0.9336 | fpr=0.0195 | 9154.8 samples/s | 35.8 steps/s
[Step= 300] | Loss=0.09823 | acc=0.9794 | tpr=0.9273 | fpr=0.0196 | 9004.3 samples/s | 35.2 steps/s
[Step= 350] | Loss=0.09932 | acc=0.9791 | tpr=0.9267 | fpr=0.0199 | 8300.9 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.10027 | acc=0.9790 | tpr=0.9234 | fpr=0.0200 | 8744.1 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.10260 | acc=0.9786 | tpr=0.9216 | fpr=0.0203 | 9042.7 samples/s | 35.3 steps/s
[Step= 500] | Loss=0.10208 | acc=0.9788 | tpr=0.9229 | fpr=0.0202 | 8444.6 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.10124 | acc=0.9789 | tpr=0.9196 | fpr=0.0201 | 16086.7 samples/s | 62.8 steps/s
Avg test loss: 0.10104, Avg test acc: 0.97887, Avg tpr: 0.91997, Avg fpr: 0.02006, total FA: 2785

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10932 | acc=0.9805 | tpr=0.9204 | fpr=0.0184 | 4454.0 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.11455 | acc=0.9798 | tpr=0.9382 | fpr=0.0194 | 9092.4 samples/s | 35.5 steps/s
[Step= 150] | Loss=0.12044 | acc=0.9790 | tpr=0.9366 | fpr=0.0202 | 8597.5 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.12137 | acc=0.9794 | tpr=0.9443 | fpr=0.0200 | 8480.2 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.11871 | acc=0.9794 | tpr=0.9432 | fpr=0.0199 | 8840.9 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.12096 | acc=0.9789 | tpr=0.9404 | fpr=0.0204 | 8771.4 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.12198 | acc=0.9789 | tpr=0.9436 | fpr=0.0204 | 8893.6 samples/s | 34.7 steps/s
[Step= 400] | Loss=0.12272 | acc=0.9787 | tpr=0.9426 | fpr=0.0207 | 8714.1 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.12546 | acc=0.9783 | tpr=0.9416 | fpr=0.0210 | 8806.7 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.12519 | acc=0.9783 | tpr=0.9419 | fpr=0.0210 | 8744.0 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.12434 | acc=0.9784 | tpr=0.9391 | fpr=0.0209 | 15646.2 samples/s | 61.1 steps/s
Avg test loss: 0.12409, Avg test acc: 0.97845, Avg tpr: 0.93899, Avg fpr: 0.02084, total FA: 2893

server round 5/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=6001 Epoch=11.7] | Loss=0.07433 | Reg=0.00241 | acc=0.9688 | L2-Norm=15.520 | L2-Norm(final)=3.584 | 4014.5 samples/s | 62.7 steps/s
[Step=6050 Epoch=11.8] | Loss=0.06423 | Reg=0.00246 | acc=0.9531 | L2-Norm=15.681 | L2-Norm(final)=3.654 | 5107.5 samples/s | 79.8 steps/s
[Step=6100 Epoch=11.9] | Loss=0.06333 | Reg=0.00250 | acc=0.9531 | L2-Norm=15.811 | L2-Norm(final)=3.703 | 5620.4 samples/s | 87.8 steps/s
[Step=6150 Epoch=12.0] | Loss=0.05940 | Reg=0.00253 | acc=0.9219 | L2-Norm=15.917 | L2-Norm(final)=3.741 | 5671.2 samples/s | 88.6 steps/s
[Step=6200 Epoch=12.1] | Loss=0.05870 | Reg=0.00257 | acc=0.9688 | L2-Norm=16.015 | L2-Norm(final)=3.771 | 5656.6 samples/s | 88.4 steps/s
[Step=6250 Epoch=12.2] | Loss=0.05872 | Reg=0.00260 | acc=0.9688 | L2-Norm=16.107 | L2-Norm(final)=3.797 | 5693.5 samples/s | 89.0 steps/s
[Step=6300 Epoch=12.3] | Loss=0.05812 | Reg=0.00262 | acc=0.8906 | L2-Norm=16.191 | L2-Norm(final)=3.821 | 5623.5 samples/s | 87.9 steps/s
[Step=6350 Epoch=12.4] | Loss=0.05778 | Reg=0.00265 | acc=0.9688 | L2-Norm=16.267 | L2-Norm(final)=3.843 | 5797.2 samples/s | 90.6 steps/s
[Step=6400 Epoch=12.5] | Loss=0.05724 | Reg=0.00267 | acc=0.9219 | L2-Norm=16.338 | L2-Norm(final)=3.865 | 5567.9 samples/s | 87.0 steps/s
[Step=6450 Epoch=12.6] | Loss=0.05618 | Reg=0.00269 | acc=0.9531 | L2-Norm=16.405 | L2-Norm(final)=3.887 | 5780.0 samples/s | 90.3 steps/s
[Step=6500 Epoch=12.7] | Loss=0.05605 | Reg=0.00271 | acc=0.9531 | L2-Norm=16.467 | L2-Norm(final)=3.909 | 7086.9 samples/s | 110.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=12.7] | Loss=0.03480 | Reg=0.00291 | acc=0.9688 | L2-Norm=17.069 | L2-Norm(final)=4.119 | 3802.1 samples/s | 59.4 steps/s
[Step=6550 Epoch=12.8] | Loss=0.06089 | Reg=0.00293 | acc=0.9688 | L2-Norm=17.111 | L2-Norm(final)=4.114 | 4940.3 samples/s | 77.2 steps/s
[Step=6600 Epoch=12.9] | Loss=0.06883 | Reg=0.00294 | acc=0.9688 | L2-Norm=17.153 | L2-Norm(final)=4.087 | 5010.8 samples/s | 78.3 steps/s
[Step=6650 Epoch=13.0] | Loss=0.06825 | Reg=0.00296 | acc=0.9531 | L2-Norm=17.202 | L2-Norm(final)=4.066 | 4986.8 samples/s | 77.9 steps/s
[Step=6700 Epoch=13.1] | Loss=0.06639 | Reg=0.00298 | acc=0.9688 | L2-Norm=17.248 | L2-Norm(final)=4.056 | 5010.3 samples/s | 78.3 steps/s
[Step=6750 Epoch=13.2] | Loss=0.06495 | Reg=0.00299 | acc=0.9844 | L2-Norm=17.292 | L2-Norm(final)=4.044 | 5040.5 samples/s | 78.8 steps/s
[Step=6800 Epoch=13.3] | Loss=0.06300 | Reg=0.00300 | acc=0.9219 | L2-Norm=17.331 | L2-Norm(final)=4.037 | 5085.2 samples/s | 79.5 steps/s
[Step=6850 Epoch=13.4] | Loss=0.06210 | Reg=0.00302 | acc=0.9375 | L2-Norm=17.367 | L2-Norm(final)=4.029 | 5148.1 samples/s | 80.4 steps/s
[Step=6900 Epoch=13.5] | Loss=0.06154 | Reg=0.00303 | acc=0.9844 | L2-Norm=17.403 | L2-Norm(final)=4.020 | 5036.7 samples/s | 78.7 steps/s
[Step=6950 Epoch=13.6] | Loss=0.06137 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.439 | L2-Norm(final)=4.012 | 5023.5 samples/s | 78.5 steps/s
[Step=7000 Epoch=13.7] | Loss=0.06045 | Reg=0.00305 | acc=0.9219 | L2-Norm=17.474 | L2-Norm(final)=4.006 | 6237.6 samples/s | 97.5 steps/s
[Step=7050 Epoch=13.8] | Loss=0.05858 | Reg=0.00307 | acc=0.9688 | L2-Norm=17.507 | L2-Norm(final)=4.000 | 1930.8 samples/s | 30.2 steps/s
[Step=7100 Epoch=13.9] | Loss=0.05726 | Reg=0.00308 | acc=0.9219 | L2-Norm=17.538 | L2-Norm(final)=3.995 | 5073.6 samples/s | 79.3 steps/s
[Step=7150 Epoch=14.0] | Loss=0.05557 | Reg=0.00309 | acc=0.9844 | L2-Norm=17.568 | L2-Norm(final)=3.991 | 5059.8 samples/s | 79.1 steps/s
[Step=7200 Epoch=14.1] | Loss=0.05438 | Reg=0.00310 | acc=0.9531 | L2-Norm=17.596 | L2-Norm(final)=3.987 | 5046.2 samples/s | 78.8 steps/s
[Step=7250 Epoch=14.2] | Loss=0.05314 | Reg=0.00311 | acc=0.9375 | L2-Norm=17.621 | L2-Norm(final)=3.984 | 5027.6 samples/s | 78.6 steps/s
[Step=7300 Epoch=14.3] | Loss=0.05215 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.644 | L2-Norm(final)=3.981 | 5082.4 samples/s | 79.4 steps/s
[Step=7350 Epoch=14.4] | Loss=0.05127 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.665 | L2-Norm(final)=3.979 | 4980.3 samples/s | 77.8 steps/s
[Step=7400 Epoch=14.5] | Loss=0.05040 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.686 | L2-Norm(final)=3.977 | 5000.6 samples/s | 78.1 steps/s
[Step=7450 Epoch=14.6] | Loss=0.04973 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.705 | L2-Norm(final)=3.975 | 5066.5 samples/s | 79.2 steps/s
[Step=7500 Epoch=14.7] | Loss=0.04903 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.724 | L2-Norm(final)=3.973 | 5485.3 samples/s | 85.7 steps/s
[Step=7550 Epoch=14.8] | Loss=0.04844 | Reg=0.00315 | acc=0.9844 | L2-Norm=17.742 | L2-Norm(final)=3.970 | 2002.2 samples/s | 31.3 steps/s
[Step=7600 Epoch=14.9] | Loss=0.04745 | Reg=0.00315 | acc=0.9844 | L2-Norm=17.759 | L2-Norm(final)=3.969 | 5055.4 samples/s | 79.0 steps/s
[Step=7650 Epoch=15.0] | Loss=0.04686 | Reg=0.00316 | acc=0.9844 | L2-Norm=17.776 | L2-Norm(final)=3.967 | 5075.8 samples/s | 79.3 steps/s
[Step=7700 Epoch=15.1] | Loss=0.04643 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.794 | L2-Norm(final)=3.965 | 5020.9 samples/s | 78.5 steps/s
[Step=7750 Epoch=15.2] | Loss=0.04598 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.813 | L2-Norm(final)=3.963 | 5088.5 samples/s | 79.5 steps/s
[Step=7800 Epoch=15.2] | Loss=0.04538 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.831 | L2-Norm(final)=3.961 | 5074.0 samples/s | 79.3 steps/s
[Step=7850 Epoch=15.3] | Loss=0.04485 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.850 | L2-Norm(final)=3.960 | 5003.6 samples/s | 78.2 steps/s
[Step=7900 Epoch=15.4] | Loss=0.04467 | Reg=0.00319 | acc=0.9688 | L2-Norm=17.868 | L2-Norm(final)=3.958 | 5140.1 samples/s | 80.3 steps/s
[Step=7950 Epoch=15.5] | Loss=0.04421 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.887 | L2-Norm(final)=3.956 | 5008.2 samples/s | 78.3 steps/s
[Step=8000 Epoch=15.6] | Loss=0.04362 | Reg=0.00321 | acc=0.9531 | L2-Norm=17.904 | L2-Norm(final)=3.954 | 5012.7 samples/s | 78.3 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step8000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=2001 Epoch= 7.7] | Loss=0.13967 | Reg=0.00241 | acc=0.8594 | L2-Norm=15.520 | L2-Norm(final)=3.189 | 3677.0 samples/s | 57.5 steps/s
[Step=2050 Epoch= 7.9] | Loss=0.03714 | Reg=0.00256 | acc=0.9688 | L2-Norm=15.989 | L2-Norm(final)=3.227 | 5157.0 samples/s | 80.6 steps/s
[Step=2100 Epoch= 8.0] | Loss=0.02639 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.243 | L2-Norm(final)=3.281 | 5395.0 samples/s | 84.3 steps/s
[Step=2150 Epoch= 8.2] | Loss=0.02420 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.410 | L2-Norm(final)=3.324 | 5234.6 samples/s | 81.8 steps/s
[Step=2200 Epoch= 8.4] | Loss=0.02120 | Reg=0.00274 | acc=0.9844 | L2-Norm=16.555 | L2-Norm(final)=3.360 | 5370.3 samples/s | 83.9 steps/s
[Step=2250 Epoch= 8.6] | Loss=0.01917 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.671 | L2-Norm(final)=3.398 | 6934.9 samples/s | 108.4 steps/s
[Step=2300 Epoch= 8.8] | Loss=0.01776 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.781 | L2-Norm(final)=3.436 | 1959.8 samples/s | 30.6 steps/s
[Step=2350 Epoch= 9.0] | Loss=0.01639 | Reg=0.00285 | acc=0.9844 | L2-Norm=16.877 | L2-Norm(final)=3.475 | 5143.8 samples/s | 80.4 steps/s
[Step=2400 Epoch= 9.2] | Loss=0.01508 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.958 | L2-Norm(final)=3.514 | 5335.6 samples/s | 83.4 steps/s
[Step=2450 Epoch= 9.4] | Loss=0.01446 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.035 | L2-Norm(final)=3.554 | 5352.9 samples/s | 83.6 steps/s
[Step=2500 Epoch= 9.6] | Loss=0.01359 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.112 | L2-Norm(final)=3.592 | 6020.5 samples/s | 94.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch= 9.6] | Loss=0.00196 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.828 | L2-Norm(final)=3.960 | 3781.3 samples/s | 59.1 steps/s
[Step=2550 Epoch= 9.8] | Loss=0.05652 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.961 | L2-Norm(final)=3.885 | 4639.3 samples/s | 72.5 steps/s
[Step=2600 Epoch=10.0] | Loss=0.03647 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.054 | L2-Norm(final)=3.831 | 4757.7 samples/s | 74.3 steps/s
[Step=2650 Epoch=10.2] | Loss=0.02638 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.070 | L2-Norm(final)=3.817 | 4766.5 samples/s | 74.5 steps/s
[Step=2700 Epoch=10.3] | Loss=0.02046 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.061 | L2-Norm(final)=3.817 | 4771.4 samples/s | 74.6 steps/s
[Step=2750 Epoch=10.5] | Loss=0.01680 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.043 | L2-Norm(final)=3.820 | 6056.2 samples/s | 94.6 steps/s
[Step=2800 Epoch=10.7] | Loss=0.01407 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.018 | L2-Norm(final)=3.825 | 1873.0 samples/s | 29.3 steps/s
[Step=2850 Epoch=10.9] | Loss=0.01208 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.989 | L2-Norm(final)=3.830 | 4794.4 samples/s | 74.9 steps/s
[Step=2900 Epoch=11.1] | Loss=0.01058 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.956 | L2-Norm(final)=3.834 | 4846.7 samples/s | 75.7 steps/s
[Step=2950 Epoch=11.3] | Loss=0.00941 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.920 | L2-Norm(final)=3.838 | 4743.2 samples/s | 74.1 steps/s
[Step=3000 Epoch=11.5] | Loss=0.00848 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.883 | L2-Norm(final)=3.843 | 5284.5 samples/s | 82.6 steps/s
[Step=3050 Epoch=11.7] | Loss=0.00771 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.845 | L2-Norm(final)=3.846 | 1962.3 samples/s | 30.7 steps/s
[Step=3100 Epoch=11.9] | Loss=0.00707 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.805 | L2-Norm(final)=3.850 | 4775.2 samples/s | 74.6 steps/s
[Step=3150 Epoch=12.1] | Loss=0.00653 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.765 | L2-Norm(final)=3.854 | 4828.1 samples/s | 75.4 steps/s
[Step=3200 Epoch=12.3] | Loss=0.00606 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.724 | L2-Norm(final)=3.857 | 4688.6 samples/s | 73.3 steps/s
[Step=3250 Epoch=12.5] | Loss=0.00566 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.682 | L2-Norm(final)=3.860 | 4814.9 samples/s | 75.2 steps/s
[Step=3300 Epoch=12.6] | Loss=0.00531 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.640 | L2-Norm(final)=3.863 | 2030.4 samples/s | 31.7 steps/s
[Step=3350 Epoch=12.8] | Loss=0.00500 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.598 | L2-Norm(final)=3.865 | 4887.6 samples/s | 76.4 steps/s
[Step=3400 Epoch=13.0] | Loss=0.00472 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.555 | L2-Norm(final)=3.868 | 4844.3 samples/s | 75.7 steps/s
[Step=3450 Epoch=13.2] | Loss=0.00447 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.512 | L2-Norm(final)=3.871 | 4666.8 samples/s | 72.9 steps/s
[Step=3500 Epoch=13.4] | Loss=0.00425 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.469 | L2-Norm(final)=3.873 | 4780.7 samples/s | 74.7 steps/s
[Step=3550 Epoch=13.6] | Loss=0.00405 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.426 | L2-Norm(final)=3.876 | 2037.9 samples/s | 31.8 steps/s
[Step=3600 Epoch=13.8] | Loss=0.00386 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.383 | L2-Norm(final)=3.878 | 4803.9 samples/s | 75.1 steps/s
[Step=3650 Epoch=14.0] | Loss=0.00370 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.340 | L2-Norm(final)=3.880 | 4766.5 samples/s | 74.5 steps/s
[Step=3700 Epoch=14.2] | Loss=0.00354 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.296 | L2-Norm(final)=3.883 | 4808.8 samples/s | 75.1 steps/s
[Step=3750 Epoch=14.4] | Loss=0.00340 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.253 | L2-Norm(final)=3.885 | 4742.2 samples/s | 74.1 steps/s
[Step=3800 Epoch=14.6] | Loss=0.00327 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.209 | L2-Norm(final)=3.887 | 6618.6 samples/s | 103.4 steps/s
[Step=3850 Epoch=14.8] | Loss=0.00315 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.166 | L2-Norm(final)=3.889 | 1825.8 samples/s | 28.5 steps/s
[Step=3900 Epoch=14.9] | Loss=0.00304 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.122 | L2-Norm(final)=3.891 | 4763.4 samples/s | 74.4 steps/s
[Step=3950 Epoch=15.1] | Loss=0.00293 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.079 | L2-Norm(final)=3.893 | 4837.5 samples/s | 75.6 steps/s
[Step=4000 Epoch=15.3] | Loss=0.00284 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.035 | L2-Norm(final)=3.895 | 4785.4 samples/s | 74.8 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06939 | acc=0.9541 | tpr=0.9577 | fpr=0.0538 | 4479.3 samples/s | 17.5 steps/s
Avg test loss: 0.06939, Avg test acc: 0.95396, Avg tpr: 0.95914, Avg fpr: 0.05743, total FA: 448

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07317 | acc=0.9547 | tpr=0.9651 | fpr=0.0679 | 4499.1 samples/s | 17.6 steps/s
Avg test loss: 0.07716, Avg test acc: 0.95248, Avg tpr: 0.96450, Avg fpr: 0.07396, total FA: 577

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.33424 | acc=0.3146 | tpr=0.0112 | fpr=0.0265 | 4422.1 samples/s | 17.3 steps/s
Avg test loss: 4.34088, Avg test acc: 0.31212, Avg tpr: 0.01148, Avg fpr: 0.02666, total FA: 208

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.74828 | acc=0.3146 | tpr=0.0080 | fpr=0.0196 | 4463.6 samples/s | 17.4 steps/s
Avg test loss: 4.76162, Avg test acc: 0.31144, Avg tpr: 0.00769, Avg fpr: 0.02051, total FA: 160

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.41742 | acc=0.0950 | tpr=0.7832 | fpr=0.9174 | 4450.9 samples/s | 17.4 steps/s
[Step= 100] | Loss=4.39982 | acc=0.0971 | tpr=0.7569 | fpr=0.9152 | 9079.0 samples/s | 35.5 steps/s
[Step= 150] | Loss=4.40174 | acc=0.0963 | tpr=0.7695 | fpr=0.9161 | 8705.7 samples/s | 34.0 steps/s
[Step= 200] | Loss=4.40632 | acc=0.0961 | tpr=0.7760 | fpr=0.9163 | 8607.4 samples/s | 33.6 steps/s
[Step= 250] | Loss=4.40870 | acc=0.0958 | tpr=0.7790 | fpr=0.9166 | 8901.3 samples/s | 34.8 steps/s
[Step= 300] | Loss=4.40981 | acc=0.0958 | tpr=0.7825 | fpr=0.9167 | 8885.3 samples/s | 34.7 steps/s
[Step= 350] | Loss=4.41128 | acc=0.0957 | tpr=0.7815 | fpr=0.9167 | 8910.6 samples/s | 34.8 steps/s
[Step= 400] | Loss=4.41114 | acc=0.0958 | tpr=0.7877 | fpr=0.9168 | 8766.2 samples/s | 34.2 steps/s
[Step= 450] | Loss=4.41580 | acc=0.0959 | tpr=0.7882 | fpr=0.9167 | 8781.0 samples/s | 34.3 steps/s
[Step= 500] | Loss=4.41668 | acc=0.0956 | tpr=0.7890 | fpr=0.9169 | 8594.4 samples/s | 33.6 steps/s
[Step= 550] | Loss=4.41740 | acc=0.0958 | tpr=0.7923 | fpr=0.9169 | 15820.3 samples/s | 61.8 steps/s
Avg test loss: 4.41863, Avg test acc: 0.09570, Avg tpr: 0.79239, Avg fpr: 0.91696, total FA: 127318

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.72376 | acc=0.1082 | tpr=0.8142 | fpr=0.9045 | 4465.6 samples/s | 17.4 steps/s
[Step= 100] | Loss=4.69532 | acc=0.1079 | tpr=0.7974 | fpr=0.9049 | 8771.2 samples/s | 34.3 steps/s
[Step= 150] | Loss=4.69669 | acc=0.1064 | tpr=0.8084 | fpr=0.9065 | 8793.7 samples/s | 34.4 steps/s
[Step= 200] | Loss=4.69674 | acc=0.1063 | tpr=0.8066 | fpr=0.9065 | 8692.5 samples/s | 34.0 steps/s
[Step= 250] | Loss=4.69626 | acc=0.1062 | tpr=0.8096 | fpr=0.9066 | 8861.4 samples/s | 34.6 steps/s
[Step= 300] | Loss=4.69431 | acc=0.1064 | tpr=0.8087 | fpr=0.9064 | 9342.7 samples/s | 36.5 steps/s
[Step= 350] | Loss=4.69460 | acc=0.1063 | tpr=0.8096 | fpr=0.9064 | 8357.5 samples/s | 32.6 steps/s
[Step= 400] | Loss=4.68950 | acc=0.1066 | tpr=0.8118 | fpr=0.9062 | 8646.6 samples/s | 33.8 steps/s
[Step= 450] | Loss=4.69395 | acc=0.1063 | tpr=0.8106 | fpr=0.9065 | 9044.4 samples/s | 35.3 steps/s
[Step= 500] | Loss=4.69472 | acc=0.1064 | tpr=0.8097 | fpr=0.9063 | 8478.6 samples/s | 33.1 steps/s
[Step= 550] | Loss=4.69444 | acc=0.1062 | tpr=0.8106 | fpr=0.9066 | 16318.4 samples/s | 63.7 steps/s
Avg test loss: 4.69527, Avg test acc: 0.10615, Avg tpr: 0.81141, Avg fpr: 0.90667, total FA: 125889

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11799 | acc=0.9796 | tpr=0.9292 | fpr=0.0195 | 4491.4 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.12022 | acc=0.9791 | tpr=0.9446 | fpr=0.0202 | 8697.6 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.12625 | acc=0.9783 | tpr=0.9481 | fpr=0.0211 | 9196.4 samples/s | 35.9 steps/s
[Step= 200] | Loss=0.12670 | acc=0.9787 | tpr=0.9508 | fpr=0.0208 | 8445.5 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.12474 | acc=0.9789 | tpr=0.9493 | fpr=0.0205 | 9032.6 samples/s | 35.3 steps/s
[Step= 300] | Loss=0.12630 | acc=0.9787 | tpr=0.9469 | fpr=0.0207 | 8973.0 samples/s | 35.1 steps/s
[Step= 350] | Loss=0.12769 | acc=0.9782 | tpr=0.9455 | fpr=0.0212 | 8651.4 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.12869 | acc=0.9779 | tpr=0.9415 | fpr=0.0214 | 8927.0 samples/s | 34.9 steps/s
[Step= 450] | Loss=0.13168 | acc=0.9777 | tpr=0.9372 | fpr=0.0216 | 8340.1 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.13117 | acc=0.9777 | tpr=0.9383 | fpr=0.0216 | 9052.9 samples/s | 35.4 steps/s
[Step= 550] | Loss=0.13025 | acc=0.9779 | tpr=0.9367 | fpr=0.0214 | 15451.9 samples/s | 60.4 steps/s
Avg test loss: 0.12998, Avg test acc: 0.97787, Avg tpr: 0.93700, Avg fpr: 0.02138, total FA: 2969

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10932 | acc=0.9805 | tpr=0.9204 | fpr=0.0184 | 4435.9 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.11455 | acc=0.9798 | tpr=0.9382 | fpr=0.0194 | 8679.9 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.12044 | acc=0.9790 | tpr=0.9366 | fpr=0.0202 | 8932.6 samples/s | 34.9 steps/s
[Step= 200] | Loss=0.12137 | acc=0.9794 | tpr=0.9443 | fpr=0.0200 | 8717.7 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.11871 | acc=0.9794 | tpr=0.9432 | fpr=0.0199 | 9143.3 samples/s | 35.7 steps/s
[Step= 300] | Loss=0.12096 | acc=0.9789 | tpr=0.9404 | fpr=0.0204 | 8717.6 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.12198 | acc=0.9789 | tpr=0.9436 | fpr=0.0204 | 8652.2 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.12272 | acc=0.9787 | tpr=0.9426 | fpr=0.0207 | 8584.4 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.12546 | acc=0.9783 | tpr=0.9416 | fpr=0.0210 | 9277.3 samples/s | 36.2 steps/s
[Step= 500] | Loss=0.12519 | acc=0.9783 | tpr=0.9419 | fpr=0.0210 | 8436.3 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.12434 | acc=0.9784 | tpr=0.9391 | fpr=0.0209 | 16121.5 samples/s | 63.0 steps/s
Avg test loss: 0.12409, Avg test acc: 0.97845, Avg tpr: 0.93899, Avg fpr: 0.02084, total FA: 2893

server round 6/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=4001 Epoch=15.3] | Loss=0.08905 | Reg=0.00245 | acc=0.9062 | L2-Norm=15.667 | L2-Norm(final)=3.953 | 3873.9 samples/s | 60.5 steps/s
[Step=4050 Epoch=15.5] | Loss=0.02220 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.917 | L2-Norm(final)=3.988 | 4907.1 samples/s | 76.7 steps/s
[Step=4100 Epoch=15.7] | Loss=0.01876 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.059 | L2-Norm(final)=4.030 | 5348.2 samples/s | 83.6 steps/s
[Step=4150 Epoch=15.9] | Loss=0.01617 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.170 | L2-Norm(final)=4.071 | 5411.2 samples/s | 84.6 steps/s
[Step=4200 Epoch=16.1] | Loss=0.01413 | Reg=0.00265 | acc=0.9844 | L2-Norm=16.273 | L2-Norm(final)=4.115 | 5366.6 samples/s | 83.9 steps/s
[Step=4250 Epoch=16.3] | Loss=0.01277 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.363 | L2-Norm(final)=4.161 | 6866.1 samples/s | 107.3 steps/s
[Step=4300 Epoch=16.5] | Loss=0.01174 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.430 | L2-Norm(final)=4.204 | 1928.3 samples/s | 30.1 steps/s
[Step=4350 Epoch=16.7] | Loss=0.01079 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.490 | L2-Norm(final)=4.247 | 5376.3 samples/s | 84.0 steps/s
[Step=4400 Epoch=16.9] | Loss=0.00988 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.543 | L2-Norm(final)=4.290 | 5446.4 samples/s | 85.1 steps/s
[Step=4450 Epoch=17.1] | Loss=0.00929 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.592 | L2-Norm(final)=4.333 | 5219.2 samples/s | 81.6 steps/s
[Step=4500 Epoch=17.2] | Loss=0.00888 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.637 | L2-Norm(final)=4.375 | 5904.8 samples/s | 92.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=17.2] | Loss=0.00075 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.076 | L2-Norm(final)=4.783 | 3780.7 samples/s | 59.1 steps/s
[Step=4550 Epoch=17.4] | Loss=0.02853 | Reg=0.00294 | acc=0.9531 | L2-Norm=17.150 | L2-Norm(final)=4.782 | 4624.5 samples/s | 72.3 steps/s
[Step=4600 Epoch=17.6] | Loss=0.02483 | Reg=0.00301 | acc=0.9844 | L2-Norm=17.353 | L2-Norm(final)=4.695 | 4854.6 samples/s | 75.9 steps/s
[Step=4650 Epoch=17.8] | Loss=0.01917 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.445 | L2-Norm(final)=4.664 | 4791.9 samples/s | 74.9 steps/s
[Step=4700 Epoch=18.0] | Loss=0.01603 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.483 | L2-Norm(final)=4.650 | 4736.5 samples/s | 74.0 steps/s
[Step=4750 Epoch=18.2] | Loss=0.01311 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.493 | L2-Norm(final)=4.645 | 6071.8 samples/s | 94.9 steps/s
[Step=4800 Epoch=18.4] | Loss=0.01098 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.486 | L2-Norm(final)=4.645 | 1861.4 samples/s | 29.1 steps/s
[Step=4850 Epoch=18.6] | Loss=0.00943 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.468 | L2-Norm(final)=4.646 | 4750.3 samples/s | 74.2 steps/s
[Step=4900 Epoch=18.8] | Loss=0.00826 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.442 | L2-Norm(final)=4.647 | 4827.8 samples/s | 75.4 steps/s
[Step=4950 Epoch=19.0] | Loss=0.00735 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.410 | L2-Norm(final)=4.648 | 4728.2 samples/s | 73.9 steps/s
[Step=5000 Epoch=19.2] | Loss=0.00662 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.376 | L2-Norm(final)=4.650 | 5316.0 samples/s | 83.1 steps/s
[Step=5050 Epoch=19.3] | Loss=0.00602 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.339 | L2-Norm(final)=4.652 | 1959.8 samples/s | 30.6 steps/s
[Step=5100 Epoch=19.5] | Loss=0.00552 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.301 | L2-Norm(final)=4.653 | 4699.9 samples/s | 73.4 steps/s
[Step=5150 Epoch=19.7] | Loss=0.00510 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.261 | L2-Norm(final)=4.655 | 4819.0 samples/s | 75.3 steps/s
[Step=5200 Epoch=19.9] | Loss=0.00474 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.220 | L2-Norm(final)=4.657 | 4773.9 samples/s | 74.6 steps/s
[Step=5250 Epoch=20.1] | Loss=0.00442 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.179 | L2-Norm(final)=4.658 | 4883.3 samples/s | 76.3 steps/s
[Step=5300 Epoch=20.3] | Loss=0.00415 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.137 | L2-Norm(final)=4.660 | 2010.5 samples/s | 31.4 steps/s
[Step=5350 Epoch=20.5] | Loss=0.00391 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.094 | L2-Norm(final)=4.661 | 4865.2 samples/s | 76.0 steps/s
[Step=5400 Epoch=20.7] | Loss=0.00369 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.051 | L2-Norm(final)=4.662 | 4686.7 samples/s | 73.2 steps/s
[Step=5450 Epoch=20.9] | Loss=0.00350 | Reg=0.00289 | acc=1.0000 | L2-Norm=17.008 | L2-Norm(final)=4.664 | 4752.7 samples/s | 74.3 steps/s
[Step=5500 Epoch=21.1] | Loss=0.00332 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.965 | L2-Norm(final)=4.665 | 4836.5 samples/s | 75.6 steps/s
[Step=5550 Epoch=21.3] | Loss=0.00316 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.921 | L2-Norm(final)=4.666 | 2031.9 samples/s | 31.7 steps/s
[Step=5600 Epoch=21.5] | Loss=0.00302 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.878 | L2-Norm(final)=4.667 | 4650.0 samples/s | 72.7 steps/s
[Step=5650 Epoch=21.6] | Loss=0.00289 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.834 | L2-Norm(final)=4.669 | 4826.0 samples/s | 75.4 steps/s
[Step=5700 Epoch=21.8] | Loss=0.00277 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.790 | L2-Norm(final)=4.670 | 4703.9 samples/s | 73.5 steps/s
[Step=5750 Epoch=22.0] | Loss=0.00266 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.746 | L2-Norm(final)=4.671 | 4767.0 samples/s | 74.5 steps/s
[Step=5800 Epoch=22.2] | Loss=0.00256 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.702 | L2-Norm(final)=4.672 | 6560.9 samples/s | 102.5 steps/s
[Step=5850 Epoch=22.4] | Loss=0.00246 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.659 | L2-Norm(final)=4.674 | 1828.4 samples/s | 28.6 steps/s
[Step=5900 Epoch=22.6] | Loss=0.00238 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.615 | L2-Norm(final)=4.675 | 4722.3 samples/s | 73.8 steps/s
[Step=5950 Epoch=22.8] | Loss=0.00230 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.571 | L2-Norm(final)=4.676 | 4773.0 samples/s | 74.6 steps/s
[Step=6000 Epoch=23.0] | Loss=0.00222 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.527 | L2-Norm(final)=4.678 | 4648.5 samples/s | 72.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step6000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=6001 Epoch=23.1] | Loss=0.05704 | Reg=0.00245 | acc=0.9219 | L2-Norm=15.667 | L2-Norm(final)=4.190 | 4039.3 samples/s | 63.1 steps/s
[Step=6050 Epoch=23.3] | Loss=0.01803 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.872 | L2-Norm(final)=4.208 | 4802.9 samples/s | 75.0 steps/s
[Step=6100 Epoch=23.5] | Loss=0.01502 | Reg=0.00256 | acc=0.9844 | L2-Norm=15.991 | L2-Norm(final)=4.240 | 5226.4 samples/s | 81.7 steps/s
[Step=6150 Epoch=23.7] | Loss=0.01190 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.095 | L2-Norm(final)=4.266 | 5337.2 samples/s | 83.4 steps/s
[Step=6200 Epoch=23.9] | Loss=0.01046 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.164 | L2-Norm(final)=4.296 | 5426.8 samples/s | 84.8 steps/s
[Step=6250 Epoch=24.1] | Loss=0.00947 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.224 | L2-Norm(final)=4.324 | 6980.6 samples/s | 109.1 steps/s
[Step=6300 Epoch=24.3] | Loss=0.00864 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.275 | L2-Norm(final)=4.352 | 1898.5 samples/s | 29.7 steps/s
[Step=6350 Epoch=24.4] | Loss=0.00792 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.320 | L2-Norm(final)=4.379 | 5318.1 samples/s | 83.1 steps/s
[Step=6400 Epoch=24.6] | Loss=0.00728 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.360 | L2-Norm(final)=4.407 | 5337.2 samples/s | 83.4 steps/s
[Step=6450 Epoch=24.8] | Loss=0.00689 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.398 | L2-Norm(final)=4.435 | 5342.7 samples/s | 83.5 steps/s
[Step=6500 Epoch=25.0] | Loss=0.00650 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.433 | L2-Norm(final)=4.461 | 6186.4 samples/s | 96.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=25.0] | Loss=0.00069 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.758 | L2-Norm(final)=4.715 | 3717.7 samples/s | 58.1 steps/s
[Step=6550 Epoch=25.2] | Loss=0.02572 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.792 | L2-Norm(final)=4.713 | 4706.5 samples/s | 73.5 steps/s
[Step=6600 Epoch=25.4] | Loss=0.02255 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.903 | L2-Norm(final)=4.640 | 4782.9 samples/s | 74.7 steps/s
[Step=6650 Epoch=25.6] | Loss=0.01770 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.951 | L2-Norm(final)=4.613 | 4881.0 samples/s | 76.3 steps/s
[Step=6700 Epoch=25.8] | Loss=0.01423 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.966 | L2-Norm(final)=4.603 | 4749.8 samples/s | 74.2 steps/s
[Step=6750 Epoch=26.0] | Loss=0.01236 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.965 | L2-Norm(final)=4.597 | 6123.0 samples/s | 95.7 steps/s
[Step=6800 Epoch=26.2] | Loss=0.01034 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.955 | L2-Norm(final)=4.595 | 1858.6 samples/s | 29.0 steps/s
[Step=6850 Epoch=26.4] | Loss=0.00889 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.939 | L2-Norm(final)=4.595 | 4722.8 samples/s | 73.8 steps/s
[Step=6900 Epoch=26.6] | Loss=0.00779 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.917 | L2-Norm(final)=4.596 | 4945.5 samples/s | 77.3 steps/s
[Step=6950 Epoch=26.8] | Loss=0.00698 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.892 | L2-Norm(final)=4.597 | 4632.9 samples/s | 72.4 steps/s
[Step=7000 Epoch=26.9] | Loss=0.00633 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.865 | L2-Norm(final)=4.599 | 5467.6 samples/s | 85.4 steps/s
[Step=7050 Epoch=27.1] | Loss=0.00576 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.838 | L2-Norm(final)=4.601 | 1953.8 samples/s | 30.5 steps/s
[Step=7100 Epoch=27.3] | Loss=0.00528 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.808 | L2-Norm(final)=4.603 | 4772.5 samples/s | 74.6 steps/s
[Step=7150 Epoch=27.5] | Loss=0.00488 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.778 | L2-Norm(final)=4.605 | 4751.1 samples/s | 74.2 steps/s
[Step=7200 Epoch=27.7] | Loss=0.00453 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.746 | L2-Norm(final)=4.607 | 4794.8 samples/s | 74.9 steps/s
[Step=7250 Epoch=27.9] | Loss=0.00423 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.714 | L2-Norm(final)=4.609 | 4899.6 samples/s | 76.6 steps/s
[Step=7300 Epoch=28.1] | Loss=0.00397 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.680 | L2-Norm(final)=4.611 | 2003.6 samples/s | 31.3 steps/s
[Step=7350 Epoch=28.3] | Loss=0.00374 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.646 | L2-Norm(final)=4.613 | 4875.8 samples/s | 76.2 steps/s
[Step=7400 Epoch=28.5] | Loss=0.00353 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.612 | L2-Norm(final)=4.614 | 4731.3 samples/s | 73.9 steps/s
[Step=7450 Epoch=28.7] | Loss=0.00334 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.577 | L2-Norm(final)=4.615 | 4763.3 samples/s | 74.4 steps/s
[Step=7500 Epoch=28.9] | Loss=0.00318 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.542 | L2-Norm(final)=4.617 | 4811.9 samples/s | 75.2 steps/s
[Step=7550 Epoch=29.1] | Loss=0.00303 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.507 | L2-Norm(final)=4.618 | 2033.3 samples/s | 31.8 steps/s
[Step=7600 Epoch=29.3] | Loss=0.00289 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.471 | L2-Norm(final)=4.619 | 4861.4 samples/s | 76.0 steps/s
[Step=7650 Epoch=29.4] | Loss=0.00276 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.435 | L2-Norm(final)=4.621 | 4788.0 samples/s | 74.8 steps/s
[Step=7700 Epoch=29.6] | Loss=0.00265 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.399 | L2-Norm(final)=4.622 | 4752.8 samples/s | 74.3 steps/s
[Step=7750 Epoch=29.8] | Loss=0.00254 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.362 | L2-Norm(final)=4.623 | 4723.3 samples/s | 73.8 steps/s
[Step=7800 Epoch=30.0] | Loss=0.00245 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.326 | L2-Norm(final)=4.624 | 6910.7 samples/s | 108.0 steps/s
[Step=7850 Epoch=30.2] | Loss=0.00236 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.289 | L2-Norm(final)=4.625 | 1793.5 samples/s | 28.0 steps/s
[Step=7900 Epoch=30.4] | Loss=0.00227 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.253 | L2-Norm(final)=4.626 | 4762.1 samples/s | 74.4 steps/s
[Step=7950 Epoch=30.6] | Loss=0.00219 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.216 | L2-Norm(final)=4.627 | 4845.0 samples/s | 75.7 steps/s
[Step=8000 Epoch=30.8] | Loss=0.00212 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.179 | L2-Norm(final)=4.628 | 4859.0 samples/s | 75.9 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06939 | acc=0.9541 | tpr=0.9577 | fpr=0.0538 | 4454.6 samples/s | 17.4 steps/s
Avg test loss: 0.06939, Avg test acc: 0.95396, Avg tpr: 0.95914, Avg fpr: 0.05743, total FA: 448

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.07317 | acc=0.9547 | tpr=0.9651 | fpr=0.0679 | 4399.2 samples/s | 17.2 steps/s
Avg test loss: 0.07716, Avg test acc: 0.95248, Avg tpr: 0.96450, Avg fpr: 0.07396, total FA: 577

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.72736 | acc=0.3095 | tpr=0.0106 | fpr=0.0414 | 4530.7 samples/s | 17.7 steps/s
Avg test loss: 4.73940, Avg test acc: 0.30864, Avg tpr: 0.01102, Avg fpr: 0.03679, total FA: 287

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.81850 | acc=0.3137 | tpr=0.0098 | fpr=0.0265 | 4505.2 samples/s | 17.6 steps/s
Avg test loss: 4.83787, Avg test acc: 0.31180, Avg tpr: 0.01172, Avg fpr: 0.02820, total FA: 220

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.41742 | acc=0.0950 | tpr=0.7832 | fpr=0.9174 | 4481.5 samples/s | 17.5 steps/s
[Step= 100] | Loss=4.39982 | acc=0.0971 | tpr=0.7569 | fpr=0.9152 | 8704.2 samples/s | 34.0 steps/s
[Step= 150] | Loss=4.40174 | acc=0.0963 | tpr=0.7695 | fpr=0.9161 | 8649.4 samples/s | 33.8 steps/s
[Step= 200] | Loss=4.40632 | acc=0.0961 | tpr=0.7760 | fpr=0.9163 | 8947.6 samples/s | 35.0 steps/s
[Step= 250] | Loss=4.40870 | acc=0.0958 | tpr=0.7790 | fpr=0.9166 | 9202.7 samples/s | 35.9 steps/s
[Step= 300] | Loss=4.40981 | acc=0.0958 | tpr=0.7825 | fpr=0.9167 | 8597.7 samples/s | 33.6 steps/s
[Step= 350] | Loss=4.41128 | acc=0.0957 | tpr=0.7815 | fpr=0.9167 | 8931.6 samples/s | 34.9 steps/s
[Step= 400] | Loss=4.41114 | acc=0.0958 | tpr=0.7877 | fpr=0.9168 | 8647.3 samples/s | 33.8 steps/s
[Step= 450] | Loss=4.41580 | acc=0.0959 | tpr=0.7882 | fpr=0.9167 | 8728.9 samples/s | 34.1 steps/s
[Step= 500] | Loss=4.41668 | acc=0.0956 | tpr=0.7890 | fpr=0.9169 | 8914.3 samples/s | 34.8 steps/s
[Step= 550] | Loss=4.41740 | acc=0.0958 | tpr=0.7923 | fpr=0.9169 | 15935.8 samples/s | 62.2 steps/s
Avg test loss: 4.41863, Avg test acc: 0.09570, Avg tpr: 0.79239, Avg fpr: 0.91696, total FA: 127318

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.72376 | acc=0.1082 | tpr=0.8142 | fpr=0.9045 | 4398.8 samples/s | 17.2 steps/s
[Step= 100] | Loss=4.69532 | acc=0.1079 | tpr=0.7974 | fpr=0.9049 | 9289.7 samples/s | 36.3 steps/s
[Step= 150] | Loss=4.69669 | acc=0.1064 | tpr=0.8084 | fpr=0.9065 | 8309.9 samples/s | 32.5 steps/s
[Step= 200] | Loss=4.69674 | acc=0.1063 | tpr=0.8066 | fpr=0.9065 | 9127.0 samples/s | 35.7 steps/s
[Step= 250] | Loss=4.69626 | acc=0.1062 | tpr=0.8096 | fpr=0.9066 | 8565.9 samples/s | 33.5 steps/s
[Step= 300] | Loss=4.69431 | acc=0.1064 | tpr=0.8087 | fpr=0.9064 | 8909.8 samples/s | 34.8 steps/s
[Step= 350] | Loss=4.69460 | acc=0.1063 | tpr=0.8096 | fpr=0.9064 | 8595.0 samples/s | 33.6 steps/s
[Step= 400] | Loss=4.68950 | acc=0.1066 | tpr=0.8118 | fpr=0.9062 | 8839.6 samples/s | 34.5 steps/s
[Step= 450] | Loss=4.69395 | acc=0.1063 | tpr=0.8106 | fpr=0.9065 | 8894.6 samples/s | 34.7 steps/s
[Step= 500] | Loss=4.69472 | acc=0.1064 | tpr=0.8097 | fpr=0.9063 | 8633.3 samples/s | 33.7 steps/s
[Step= 550] | Loss=4.69444 | acc=0.1062 | tpr=0.8106 | fpr=0.9066 | 16313.2 samples/s | 63.7 steps/s
Avg test loss: 4.69527, Avg test acc: 0.10615, Avg tpr: 0.81141, Avg fpr: 0.90667, total FA: 125889

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12517 | acc=0.9815 | tpr=0.9336 | fpr=0.0177 | 4446.3 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.13264 | acc=0.9807 | tpr=0.9467 | fpr=0.0187 | 8708.3 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.13887 | acc=0.9801 | tpr=0.9452 | fpr=0.0193 | 8916.6 samples/s | 34.8 steps/s
[Step= 200] | Loss=0.14044 | acc=0.9802 | tpr=0.9486 | fpr=0.0193 | 8791.5 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.13716 | acc=0.9804 | tpr=0.9467 | fpr=0.0190 | 8754.7 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.13900 | acc=0.9801 | tpr=0.9455 | fpr=0.0193 | 9069.4 samples/s | 35.4 steps/s
[Step= 350] | Loss=0.14042 | acc=0.9797 | tpr=0.9455 | fpr=0.0197 | 8829.5 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.14168 | acc=0.9795 | tpr=0.9420 | fpr=0.0198 | 8564.1 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.14427 | acc=0.9793 | tpr=0.9421 | fpr=0.0201 | 8804.6 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.14335 | acc=0.9794 | tpr=0.9432 | fpr=0.0200 | 8900.5 samples/s | 34.8 steps/s
[Step= 550] | Loss=0.14234 | acc=0.9794 | tpr=0.9415 | fpr=0.0199 | 15192.4 samples/s | 59.3 steps/s
Avg test loss: 0.14207, Avg test acc: 0.97944, Avg tpr: 0.94097, Avg fpr: 0.01986, total FA: 2757

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11697 | acc=0.9798 | tpr=0.9159 | fpr=0.0190 | 4414.2 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.12006 | acc=0.9788 | tpr=0.9147 | fpr=0.0200 | 8943.2 samples/s | 34.9 steps/s
[Step= 150] | Loss=0.12494 | acc=0.9783 | tpr=0.9294 | fpr=0.0208 | 8669.2 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.12545 | acc=0.9784 | tpr=0.9344 | fpr=0.0208 | 9190.6 samples/s | 35.9 steps/s
[Step= 250] | Loss=0.12336 | acc=0.9787 | tpr=0.9354 | fpr=0.0205 | 8147.4 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.12586 | acc=0.9785 | tpr=0.9324 | fpr=0.0207 | 7802.5 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.12724 | acc=0.9782 | tpr=0.9349 | fpr=0.0210 | 8643.2 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.12840 | acc=0.9781 | tpr=0.9333 | fpr=0.0211 | 8717.3 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.13083 | acc=0.9778 | tpr=0.9323 | fpr=0.0214 | 8718.0 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.13007 | acc=0.9779 | tpr=0.9330 | fpr=0.0213 | 9061.9 samples/s | 35.4 steps/s
[Step= 550] | Loss=0.12929 | acc=0.9780 | tpr=0.9316 | fpr=0.0212 | 15231.1 samples/s | 59.5 steps/s
Avg test loss: 0.12904, Avg test acc: 0.97801, Avg tpr: 0.93146, Avg fpr: 0.02115, total FA: 2936

server round 7/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=8001 Epoch=15.6] | Loss=0.18032 | Reg=0.00240 | acc=0.8281 | L2-Norm=15.484 | L2-Norm(final)=3.893 | 3931.9 samples/s | 61.4 steps/s
[Step=8050 Epoch=15.7] | Loss=0.09830 | Reg=0.00245 | acc=0.8438 | L2-Norm=15.661 | L2-Norm(final)=3.934 | 5353.3 samples/s | 83.6 steps/s
[Step=8100 Epoch=15.8] | Loss=0.08731 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.812 | L2-Norm(final)=3.993 | 5593.5 samples/s | 87.4 steps/s
[Step=8150 Epoch=15.9] | Loss=0.08156 | Reg=0.00253 | acc=0.9531 | L2-Norm=15.919 | L2-Norm(final)=4.039 | 5707.3 samples/s | 89.2 steps/s
[Step=8200 Epoch=16.0] | Loss=0.07903 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.016 | L2-Norm(final)=4.083 | 5587.0 samples/s | 87.3 steps/s
[Step=8250 Epoch=16.1] | Loss=0.07678 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.102 | L2-Norm(final)=4.120 | 5710.3 samples/s | 89.2 steps/s
[Step=8300 Epoch=16.2] | Loss=0.07499 | Reg=0.00262 | acc=0.9688 | L2-Norm=16.184 | L2-Norm(final)=4.159 | 5679.7 samples/s | 88.7 steps/s
[Step=8350 Epoch=16.3] | Loss=0.07334 | Reg=0.00265 | acc=0.9531 | L2-Norm=16.266 | L2-Norm(final)=4.196 | 5604.1 samples/s | 87.6 steps/s
[Step=8400 Epoch=16.4] | Loss=0.07328 | Reg=0.00267 | acc=0.9375 | L2-Norm=16.346 | L2-Norm(final)=4.231 | 5713.6 samples/s | 89.3 steps/s
[Step=8450 Epoch=16.5] | Loss=0.07228 | Reg=0.00270 | acc=0.9844 | L2-Norm=16.423 | L2-Norm(final)=4.262 | 5709.0 samples/s | 89.2 steps/s
[Step=8500 Epoch=16.6] | Loss=0.07179 | Reg=0.00272 | acc=0.9531 | L2-Norm=16.495 | L2-Norm(final)=4.293 | 7065.0 samples/s | 110.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=16.6] | Loss=0.05112 | Reg=0.00296 | acc=0.9688 | L2-Norm=17.193 | L2-Norm(final)=4.597 | 4060.2 samples/s | 63.4 steps/s
[Step=8550 Epoch=16.7] | Loss=0.06254 | Reg=0.00298 | acc=0.9688 | L2-Norm=17.260 | L2-Norm(final)=4.610 | 4584.8 samples/s | 71.6 steps/s
[Step=8600 Epoch=16.8] | Loss=0.06718 | Reg=0.00301 | acc=0.9062 | L2-Norm=17.335 | L2-Norm(final)=4.586 | 5031.6 samples/s | 78.6 steps/s
[Step=8650 Epoch=16.9] | Loss=0.06343 | Reg=0.00303 | acc=0.9688 | L2-Norm=17.399 | L2-Norm(final)=4.565 | 5025.2 samples/s | 78.5 steps/s
[Step=8700 Epoch=17.0] | Loss=0.06051 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.444 | L2-Norm(final)=4.551 | 5058.3 samples/s | 79.0 steps/s
[Step=8750 Epoch=17.1] | Loss=0.06118 | Reg=0.00306 | acc=0.9375 | L2-Norm=17.483 | L2-Norm(final)=4.539 | 5032.8 samples/s | 78.6 steps/s
[Step=8800 Epoch=17.2] | Loss=0.05889 | Reg=0.00307 | acc=0.9531 | L2-Norm=17.516 | L2-Norm(final)=4.529 | 5140.7 samples/s | 80.3 steps/s
[Step=8850 Epoch=17.3] | Loss=0.05772 | Reg=0.00308 | acc=0.9844 | L2-Norm=17.544 | L2-Norm(final)=4.521 | 4927.1 samples/s | 77.0 steps/s
[Step=8900 Epoch=17.4] | Loss=0.05642 | Reg=0.00309 | acc=0.9375 | L2-Norm=17.569 | L2-Norm(final)=4.516 | 5003.2 samples/s | 78.2 steps/s
[Step=8950 Epoch=17.5] | Loss=0.05544 | Reg=0.00310 | acc=0.9375 | L2-Norm=17.595 | L2-Norm(final)=4.510 | 5083.0 samples/s | 79.4 steps/s
[Step=9000 Epoch=17.6] | Loss=0.05396 | Reg=0.00311 | acc=0.9375 | L2-Norm=17.620 | L2-Norm(final)=4.506 | 6179.5 samples/s | 96.6 steps/s
[Step=9050 Epoch=17.7] | Loss=0.05216 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.645 | L2-Norm(final)=4.502 | 1939.7 samples/s | 30.3 steps/s
[Step=9100 Epoch=17.8] | Loss=0.05092 | Reg=0.00312 | acc=0.9375 | L2-Norm=17.670 | L2-Norm(final)=4.498 | 4988.6 samples/s | 77.9 steps/s
[Step=9150 Epoch=17.9] | Loss=0.04983 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.696 | L2-Norm(final)=4.493 | 5061.9 samples/s | 79.1 steps/s
[Step=9200 Epoch=18.0] | Loss=0.04855 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.721 | L2-Norm(final)=4.490 | 5129.8 samples/s | 80.2 steps/s
[Step=9250 Epoch=18.1] | Loss=0.04774 | Reg=0.00315 | acc=0.9688 | L2-Norm=17.743 | L2-Norm(final)=4.487 | 4965.6 samples/s | 77.6 steps/s
[Step=9300 Epoch=18.2] | Loss=0.04721 | Reg=0.00316 | acc=0.9531 | L2-Norm=17.765 | L2-Norm(final)=4.484 | 5046.7 samples/s | 78.9 steps/s
[Step=9350 Epoch=18.3] | Loss=0.04648 | Reg=0.00316 | acc=0.9375 | L2-Norm=17.788 | L2-Norm(final)=4.481 | 5055.2 samples/s | 79.0 steps/s
[Step=9400 Epoch=18.4] | Loss=0.04562 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.810 | L2-Norm(final)=4.479 | 5070.5 samples/s | 79.2 steps/s
[Step=9450 Epoch=18.5] | Loss=0.04486 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.832 | L2-Norm(final)=4.477 | 5095.4 samples/s | 79.6 steps/s
[Step=9500 Epoch=18.6] | Loss=0.04444 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.853 | L2-Norm(final)=4.474 | 5470.5 samples/s | 85.5 steps/s
[Step=9550 Epoch=18.7] | Loss=0.04371 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.873 | L2-Norm(final)=4.472 | 2018.3 samples/s | 31.5 steps/s
[Step=9600 Epoch=18.8] | Loss=0.04294 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.893 | L2-Norm(final)=4.469 | 4943.8 samples/s | 77.2 steps/s
[Step=9650 Epoch=18.9] | Loss=0.04226 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.912 | L2-Norm(final)=4.467 | 5049.5 samples/s | 78.9 steps/s
[Step=9700 Epoch=19.0] | Loss=0.04154 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.931 | L2-Norm(final)=4.465 | 5018.7 samples/s | 78.4 steps/s
[Step=9750 Epoch=19.1] | Loss=0.04095 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.949 | L2-Norm(final)=4.463 | 5027.6 samples/s | 78.6 steps/s
[Step=9800 Epoch=19.2] | Loss=0.04064 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.966 | L2-Norm(final)=4.461 | 5056.6 samples/s | 79.0 steps/s
[Step=9850 Epoch=19.3] | Loss=0.04031 | Reg=0.00324 | acc=0.9844 | L2-Norm=17.983 | L2-Norm(final)=4.459 | 5079.2 samples/s | 79.4 steps/s
[Step=9900 Epoch=19.4] | Loss=0.03988 | Reg=0.00324 | acc=0.9688 | L2-Norm=18.000 | L2-Norm(final)=4.456 | 5087.6 samples/s | 79.5 steps/s
[Step=9950 Epoch=19.5] | Loss=0.03959 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.016 | L2-Norm(final)=4.454 | 5024.8 samples/s | 78.5 steps/s
[Step=10000 Epoch=19.5] | Loss=0.03918 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.032 | L2-Norm(final)=4.452 | 5054.8 samples/s | 79.0 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step10000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=6001 Epoch=23.0] | Loss=0.07428 | Reg=0.00240 | acc=0.9219 | L2-Norm=15.484 | L2-Norm(final)=4.722 | 3614.7 samples/s | 56.5 steps/s
[Step=6050 Epoch=23.2] | Loss=0.02514 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.928 | L2-Norm(final)=4.722 | 5297.0 samples/s | 82.8 steps/s
[Step=6100 Epoch=23.4] | Loss=0.01753 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.132 | L2-Norm(final)=4.739 | 5444.4 samples/s | 85.1 steps/s
[Step=6150 Epoch=23.6] | Loss=0.01460 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.247 | L2-Norm(final)=4.769 | 5224.2 samples/s | 81.6 steps/s
[Step=6200 Epoch=23.8] | Loss=0.01251 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.334 | L2-Norm(final)=4.805 | 5296.2 samples/s | 82.8 steps/s
[Step=6250 Epoch=23.9] | Loss=0.01070 | Reg=0.00269 | acc=0.9844 | L2-Norm=16.398 | L2-Norm(final)=4.841 | 6958.9 samples/s | 108.7 steps/s
[Step=6300 Epoch=24.1] | Loss=0.00965 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.448 | L2-Norm(final)=4.877 | 1911.5 samples/s | 29.9 steps/s
[Step=6350 Epoch=24.3] | Loss=0.00859 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.491 | L2-Norm(final)=4.914 | 5337.0 samples/s | 83.4 steps/s
[Step=6400 Epoch=24.5] | Loss=0.00774 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.522 | L2-Norm(final)=4.952 | 5370.3 samples/s | 83.9 steps/s
[Step=6450 Epoch=24.7] | Loss=0.00733 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.547 | L2-Norm(final)=4.988 | 5353.8 samples/s | 83.7 steps/s
[Step=6500 Epoch=24.9] | Loss=0.00677 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.569 | L2-Norm(final)=5.022 | 6001.5 samples/s | 93.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=24.9] | Loss=0.00065 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.741 | L2-Norm(final)=5.359 | 3659.5 samples/s | 57.2 steps/s
[Step=6550 Epoch=25.1] | Loss=0.04147 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.919 | L2-Norm(final)=5.265 | 4829.1 samples/s | 75.5 steps/s
[Step=6600 Epoch=25.3] | Loss=0.02937 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.143 | L2-Norm(final)=5.168 | 4759.9 samples/s | 74.4 steps/s
[Step=6650 Epoch=25.5] | Loss=0.02159 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.227 | L2-Norm(final)=5.144 | 4900.9 samples/s | 76.6 steps/s
[Step=6700 Epoch=25.7] | Loss=0.01682 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.258 | L2-Norm(final)=5.138 | 4705.2 samples/s | 73.5 steps/s
[Step=6750 Epoch=25.9] | Loss=0.01369 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.261 | L2-Norm(final)=5.141 | 6046.4 samples/s | 94.5 steps/s
[Step=6800 Epoch=26.1] | Loss=0.01151 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.253 | L2-Norm(final)=5.146 | 1873.8 samples/s | 29.3 steps/s
[Step=6850 Epoch=26.2] | Loss=0.00988 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.235 | L2-Norm(final)=5.151 | 4866.8 samples/s | 76.0 steps/s
[Step=6900 Epoch=26.4] | Loss=0.00870 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.211 | L2-Norm(final)=5.157 | 4669.1 samples/s | 73.0 steps/s
[Step=6950 Epoch=26.6] | Loss=0.00784 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.183 | L2-Norm(final)=5.161 | 4808.7 samples/s | 75.1 steps/s
[Step=7000 Epoch=26.8] | Loss=0.00724 | Reg=0.00294 | acc=0.9844 | L2-Norm=17.155 | L2-Norm(final)=5.166 | 5295.2 samples/s | 82.7 steps/s
[Step=7050 Epoch=27.0] | Loss=0.00664 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.128 | L2-Norm(final)=5.170 | 1962.0 samples/s | 30.7 steps/s
[Step=7100 Epoch=27.2] | Loss=0.00609 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.098 | L2-Norm(final)=5.175 | 4818.8 samples/s | 75.3 steps/s
[Step=7150 Epoch=27.4] | Loss=0.00563 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.066 | L2-Norm(final)=5.179 | 4790.8 samples/s | 74.9 steps/s
[Step=7200 Epoch=27.6] | Loss=0.00523 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.032 | L2-Norm(final)=5.183 | 4787.9 samples/s | 74.8 steps/s
[Step=7250 Epoch=27.8] | Loss=0.00488 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.996 | L2-Norm(final)=5.187 | 4808.1 samples/s | 75.1 steps/s
[Step=7300 Epoch=28.0] | Loss=0.00458 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.960 | L2-Norm(final)=5.190 | 2031.6 samples/s | 31.7 steps/s
[Step=7350 Epoch=28.2] | Loss=0.00431 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.922 | L2-Norm(final)=5.194 | 4807.3 samples/s | 75.1 steps/s
[Step=7400 Epoch=28.4] | Loss=0.00407 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.883 | L2-Norm(final)=5.197 | 4820.6 samples/s | 75.3 steps/s
[Step=7450 Epoch=28.5] | Loss=0.00386 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.844 | L2-Norm(final)=5.200 | 4811.6 samples/s | 75.2 steps/s
[Step=7500 Epoch=28.7] | Loss=0.00367 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.804 | L2-Norm(final)=5.202 | 4777.6 samples/s | 74.6 steps/s
[Step=7550 Epoch=28.9] | Loss=0.00349 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.764 | L2-Norm(final)=5.205 | 2043.5 samples/s | 31.9 steps/s
[Step=7600 Epoch=29.1] | Loss=0.00333 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.723 | L2-Norm(final)=5.207 | 4747.1 samples/s | 74.2 steps/s
[Step=7650 Epoch=29.3] | Loss=0.00319 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.682 | L2-Norm(final)=5.209 | 4787.0 samples/s | 74.8 steps/s
[Step=7700 Epoch=29.5] | Loss=0.00306 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.640 | L2-Norm(final)=5.212 | 4836.0 samples/s | 75.6 steps/s
[Step=7750 Epoch=29.7] | Loss=0.00294 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.599 | L2-Norm(final)=5.214 | 4782.9 samples/s | 74.7 steps/s
[Step=7800 Epoch=29.9] | Loss=0.00282 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.557 | L2-Norm(final)=5.216 | 6594.3 samples/s | 103.0 steps/s
[Step=7850 Epoch=30.1] | Loss=0.00272 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.515 | L2-Norm(final)=5.218 | 1828.1 samples/s | 28.6 steps/s
[Step=7900 Epoch=30.3] | Loss=0.00262 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.473 | L2-Norm(final)=5.220 | 4820.3 samples/s | 75.3 steps/s
[Step=7950 Epoch=30.5] | Loss=0.00253 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.431 | L2-Norm(final)=5.222 | 4721.6 samples/s | 73.8 steps/s
[Step=8000 Epoch=30.7] | Loss=0.00245 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.389 | L2-Norm(final)=5.224 | 4840.9 samples/s | 75.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06939 | acc=0.9541 | tpr=0.9577 | fpr=0.0538 | 4425.2 samples/s | 17.3 steps/s
Avg test loss: 0.06939, Avg test acc: 0.95396, Avg tpr: 0.95914, Avg fpr: 0.05743, total FA: 448

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06436 | acc=0.9620 | tpr=0.9739 | fpr=0.0637 | 4525.0 samples/s | 17.7 steps/s
Avg test loss: 0.06876, Avg test acc: 0.95993, Avg tpr: 0.97249, Avg fpr: 0.06768, total FA: 528

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.68025 | acc=0.3145 | tpr=0.0033 | fpr=0.0097 | 4496.0 samples/s | 17.6 steps/s
Avg test loss: 4.67906, Avg test acc: 0.31172, Avg tpr: 0.00344, Avg fpr: 0.01026, total FA: 80

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.81850 | acc=0.3137 | tpr=0.0098 | fpr=0.0265 | 4441.0 samples/s | 17.3 steps/s
Avg test loss: 4.83787, Avg test acc: 0.31180, Avg tpr: 0.01172, Avg fpr: 0.02820, total FA: 220

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.41742 | acc=0.0950 | tpr=0.7832 | fpr=0.9174 | 4471.7 samples/s | 17.5 steps/s
[Step= 100] | Loss=4.39982 | acc=0.0971 | tpr=0.7569 | fpr=0.9152 | 8884.0 samples/s | 34.7 steps/s
[Step= 150] | Loss=4.40174 | acc=0.0963 | tpr=0.7695 | fpr=0.9161 | 8506.8 samples/s | 33.2 steps/s
[Step= 200] | Loss=4.40632 | acc=0.0961 | tpr=0.7760 | fpr=0.9163 | 8913.9 samples/s | 34.8 steps/s
[Step= 250] | Loss=4.40870 | acc=0.0958 | tpr=0.7790 | fpr=0.9166 | 8552.6 samples/s | 33.4 steps/s
[Step= 300] | Loss=4.40981 | acc=0.0958 | tpr=0.7825 | fpr=0.9167 | 9069.6 samples/s | 35.4 steps/s
[Step= 350] | Loss=4.41128 | acc=0.0957 | tpr=0.7815 | fpr=0.9167 | 9185.8 samples/s | 35.9 steps/s
[Step= 400] | Loss=4.41114 | acc=0.0958 | tpr=0.7877 | fpr=0.9168 | 8442.8 samples/s | 33.0 steps/s
[Step= 450] | Loss=4.41580 | acc=0.0959 | tpr=0.7882 | fpr=0.9167 | 8663.3 samples/s | 33.8 steps/s
[Step= 500] | Loss=4.41668 | acc=0.0956 | tpr=0.7890 | fpr=0.9169 | 8912.3 samples/s | 34.8 steps/s
[Step= 550] | Loss=4.41740 | acc=0.0958 | tpr=0.7923 | fpr=0.9169 | 15289.6 samples/s | 59.7 steps/s
Avg test loss: 4.41863, Avg test acc: 0.09570, Avg tpr: 0.79239, Avg fpr: 0.91696, total FA: 127318

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.30797 | acc=0.1203 | tpr=0.8451 | fpr=0.8927 | 4459.2 samples/s | 17.4 steps/s
[Step= 100] | Loss=4.29799 | acc=0.1209 | tpr=0.8145 | fpr=0.8920 | 8868.2 samples/s | 34.6 steps/s
[Step= 150] | Loss=4.29632 | acc=0.1205 | tpr=0.8098 | fpr=0.8922 | 8824.6 samples/s | 34.5 steps/s
[Step= 200] | Loss=4.29556 | acc=0.1203 | tpr=0.8164 | fpr=0.8924 | 8839.8 samples/s | 34.5 steps/s
[Step= 250] | Loss=4.29782 | acc=0.1210 | tpr=0.8183 | fpr=0.8917 | 8828.1 samples/s | 34.5 steps/s
[Step= 300] | Loss=4.29437 | acc=0.1210 | tpr=0.8160 | fpr=0.8917 | 9024.1 samples/s | 35.3 steps/s
[Step= 350] | Loss=4.29049 | acc=0.1206 | tpr=0.8203 | fpr=0.8921 | 8525.9 samples/s | 33.3 steps/s
[Step= 400] | Loss=4.28938 | acc=0.1213 | tpr=0.8277 | fpr=0.8915 | 8876.6 samples/s | 34.7 steps/s
[Step= 450] | Loss=4.29582 | acc=0.1208 | tpr=0.8242 | fpr=0.8920 | 8915.8 samples/s | 34.8 steps/s
[Step= 500] | Loss=4.29939 | acc=0.1206 | tpr=0.8256 | fpr=0.8921 | 8732.6 samples/s | 34.1 steps/s
[Step= 550] | Loss=4.30115 | acc=0.1204 | tpr=0.8241 | fpr=0.8924 | 15181.4 samples/s | 59.3 steps/s
Avg test loss: 4.30174, Avg test acc: 0.12032, Avg tpr: 0.82448, Avg fpr: 0.89248, total FA: 123919

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12409 | acc=0.9809 | tpr=0.9204 | fpr=0.0181 | 4448.6 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.13063 | acc=0.9804 | tpr=0.9275 | fpr=0.0187 | 9153.9 samples/s | 35.8 steps/s
[Step= 150] | Loss=0.13588 | acc=0.9792 | tpr=0.9294 | fpr=0.0199 | 8470.4 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.13675 | acc=0.9794 | tpr=0.9377 | fpr=0.0199 | 9115.5 samples/s | 35.6 steps/s
[Step= 250] | Loss=0.13344 | acc=0.9798 | tpr=0.9362 | fpr=0.0195 | 8590.5 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.13600 | acc=0.9794 | tpr=0.9338 | fpr=0.0198 | 8912.3 samples/s | 34.8 steps/s
[Step= 350] | Loss=0.13718 | acc=0.9793 | tpr=0.9374 | fpr=0.0199 | 8756.7 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.13837 | acc=0.9791 | tpr=0.9322 | fpr=0.0200 | 8675.8 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.14161 | acc=0.9788 | tpr=0.9294 | fpr=0.0203 | 8981.1 samples/s | 35.1 steps/s
[Step= 500] | Loss=0.14068 | acc=0.9789 | tpr=0.9313 | fpr=0.0202 | 8919.6 samples/s | 34.8 steps/s
[Step= 550] | Loss=0.14005 | acc=0.9790 | tpr=0.9296 | fpr=0.0201 | 15155.9 samples/s | 59.2 steps/s
Avg test loss: 0.13984, Avg test acc: 0.97906, Avg tpr: 0.92948, Avg fpr: 0.02004, total FA: 2783

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11697 | acc=0.9798 | tpr=0.9159 | fpr=0.0190 | 4451.0 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.12006 | acc=0.9788 | tpr=0.9147 | fpr=0.0200 | 8807.2 samples/s | 34.4 steps/s
[Step= 150] | Loss=0.12494 | acc=0.9783 | tpr=0.9294 | fpr=0.0208 | 8853.8 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.12545 | acc=0.9784 | tpr=0.9344 | fpr=0.0208 | 8941.8 samples/s | 34.9 steps/s
[Step= 250] | Loss=0.12336 | acc=0.9787 | tpr=0.9354 | fpr=0.0205 | 8604.2 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.12586 | acc=0.9785 | tpr=0.9324 | fpr=0.0207 | 9277.4 samples/s | 36.2 steps/s
[Step= 350] | Loss=0.12724 | acc=0.9782 | tpr=0.9349 | fpr=0.0210 | 8269.2 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.12840 | acc=0.9781 | tpr=0.9333 | fpr=0.0211 | 8803.8 samples/s | 34.4 steps/s
[Step= 450] | Loss=0.13083 | acc=0.9778 | tpr=0.9323 | fpr=0.0214 | 9199.3 samples/s | 35.9 steps/s
[Step= 500] | Loss=0.13007 | acc=0.9779 | tpr=0.9330 | fpr=0.0213 | 8511.2 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.12929 | acc=0.9780 | tpr=0.9316 | fpr=0.0212 | 15431.1 samples/s | 60.3 steps/s
Avg test loss: 0.12904, Avg test acc: 0.97801, Avg tpr: 0.93146, Avg fpr: 0.02115, total FA: 2936

server round 8/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=8001 Epoch=30.7] | Loss=0.07046 | Reg=0.00237 | acc=0.9219 | L2-Norm=15.379 | L2-Norm(final)=5.295 | 3881.8 samples/s | 60.7 steps/s
[Step=8050 Epoch=30.8] | Loss=0.01881 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.701 | L2-Norm(final)=5.292 | 5161.0 samples/s | 80.6 steps/s
[Step=8100 Epoch=31.0] | Loss=0.01502 | Reg=0.00251 | acc=0.9844 | L2-Norm=15.857 | L2-Norm(final)=5.305 | 5264.0 samples/s | 82.3 steps/s
[Step=8150 Epoch=31.2] | Loss=0.01224 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.970 | L2-Norm(final)=5.342 | 5419.4 samples/s | 84.7 steps/s
[Step=8200 Epoch=31.4] | Loss=0.01056 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.063 | L2-Norm(final)=5.389 | 5255.5 samples/s | 82.1 steps/s
[Step=8250 Epoch=31.6] | Loss=0.00916 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.143 | L2-Norm(final)=5.436 | 7006.9 samples/s | 109.5 steps/s
[Step=8300 Epoch=31.8] | Loss=0.00810 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.202 | L2-Norm(final)=5.480 | 1916.1 samples/s | 29.9 steps/s
[Step=8350 Epoch=32.0] | Loss=0.00736 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.248 | L2-Norm(final)=5.525 | 5299.2 samples/s | 82.8 steps/s
[Step=8400 Epoch=32.2] | Loss=0.00671 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.284 | L2-Norm(final)=5.568 | 5387.4 samples/s | 84.2 steps/s
[Step=8450 Epoch=32.4] | Loss=0.00626 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.314 | L2-Norm(final)=5.609 | 5352.1 samples/s | 83.6 steps/s
[Step=8500 Epoch=32.6] | Loss=0.00580 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.341 | L2-Norm(final)=5.649 | 5950.7 samples/s | 93.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=32.6] | Loss=0.00085 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.574 | L2-Norm(final)=6.043 | 3927.3 samples/s | 61.4 steps/s
[Step=8550 Epoch=32.8] | Loss=0.01607 | Reg=0.00275 | acc=0.9688 | L2-Norm=16.593 | L2-Norm(final)=6.058 | 4385.7 samples/s | 68.5 steps/s
[Step=8600 Epoch=33.0] | Loss=0.01752 | Reg=0.00283 | acc=0.9844 | L2-Norm=16.818 | L2-Norm(final)=5.991 | 4777.1 samples/s | 74.6 steps/s
[Step=8650 Epoch=33.1] | Loss=0.01478 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.940 | L2-Norm(final)=5.955 | 4870.1 samples/s | 76.1 steps/s
[Step=8700 Epoch=33.3] | Loss=0.01239 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.999 | L2-Norm(final)=5.942 | 4762.2 samples/s | 74.4 steps/s
[Step=8750 Epoch=33.5] | Loss=0.01106 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.035 | L2-Norm(final)=5.936 | 6000.8 samples/s | 93.8 steps/s
[Step=8800 Epoch=33.7] | Loss=0.00939 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.051 | L2-Norm(final)=5.934 | 1873.1 samples/s | 29.3 steps/s
[Step=8850 Epoch=33.9] | Loss=0.00813 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.051 | L2-Norm(final)=5.934 | 4763.4 samples/s | 74.4 steps/s
[Step=8900 Epoch=34.1] | Loss=0.00718 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.039 | L2-Norm(final)=5.935 | 4773.9 samples/s | 74.6 steps/s
[Step=8950 Epoch=34.3] | Loss=0.00643 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.019 | L2-Norm(final)=5.938 | 4819.9 samples/s | 75.3 steps/s
[Step=9000 Epoch=34.5] | Loss=0.00579 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.995 | L2-Norm(final)=5.940 | 5306.1 samples/s | 82.9 steps/s
[Step=9050 Epoch=34.7] | Loss=0.00527 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.966 | L2-Norm(final)=5.943 | 1942.6 samples/s | 30.4 steps/s
[Step=9100 Epoch=34.9] | Loss=0.00483 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.933 | L2-Norm(final)=5.946 | 4806.9 samples/s | 75.1 steps/s
[Step=9150 Epoch=35.1] | Loss=0.00446 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.898 | L2-Norm(final)=5.948 | 4824.1 samples/s | 75.4 steps/s
[Step=9200 Epoch=35.3] | Loss=0.00415 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.862 | L2-Norm(final)=5.950 | 4786.4 samples/s | 74.8 steps/s
[Step=9250 Epoch=35.4] | Loss=0.00387 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.823 | L2-Norm(final)=5.952 | 4798.3 samples/s | 75.0 steps/s
[Step=9300 Epoch=35.6] | Loss=0.00363 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.784 | L2-Norm(final)=5.954 | 2031.1 samples/s | 31.7 steps/s
[Step=9350 Epoch=35.8] | Loss=0.00342 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.744 | L2-Norm(final)=5.956 | 4906.9 samples/s | 76.7 steps/s
[Step=9400 Epoch=36.0] | Loss=0.00323 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.703 | L2-Norm(final)=5.958 | 4755.8 samples/s | 74.3 steps/s
[Step=9450 Epoch=36.2] | Loss=0.00306 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.661 | L2-Norm(final)=5.959 | 4800.3 samples/s | 75.0 steps/s
[Step=9500 Epoch=36.4] | Loss=0.00290 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.619 | L2-Norm(final)=5.961 | 4848.8 samples/s | 75.8 steps/s
[Step=9550 Epoch=36.6] | Loss=0.00277 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.577 | L2-Norm(final)=5.962 | 2020.4 samples/s | 31.6 steps/s
[Step=9600 Epoch=36.8] | Loss=0.00264 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.534 | L2-Norm(final)=5.963 | 4806.3 samples/s | 75.1 steps/s
[Step=9650 Epoch=37.0] | Loss=0.00253 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.492 | L2-Norm(final)=5.965 | 4796.9 samples/s | 75.0 steps/s
[Step=9700 Epoch=37.2] | Loss=0.00242 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.448 | L2-Norm(final)=5.966 | 4778.5 samples/s | 74.7 steps/s
[Step=9750 Epoch=37.4] | Loss=0.00233 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.405 | L2-Norm(final)=5.967 | 4816.4 samples/s | 75.3 steps/s
[Step=9800 Epoch=37.6] | Loss=0.00224 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.362 | L2-Norm(final)=5.968 | 6472.7 samples/s | 101.1 steps/s
[Step=9850 Epoch=37.7] | Loss=0.00215 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.319 | L2-Norm(final)=5.970 | 1831.8 samples/s | 28.6 steps/s
[Step=9900 Epoch=37.9] | Loss=0.00208 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.275 | L2-Norm(final)=5.971 | 4717.3 samples/s | 73.7 steps/s
[Step=9950 Epoch=38.1] | Loss=0.00201 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.232 | L2-Norm(final)=5.972 | 4758.0 samples/s | 74.3 steps/s
[Step=10000 Epoch=38.3] | Loss=0.00194 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.188 | L2-Norm(final)=5.973 | 4837.5 samples/s | 75.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step10000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=8001 Epoch=30.8] | Loss=0.04953 | Reg=0.00237 | acc=0.9531 | L2-Norm=15.379 | L2-Norm(final)=4.657 | 3717.9 samples/s | 58.1 steps/s
[Step=8050 Epoch=31.0] | Loss=0.01385 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.624 | L2-Norm(final)=4.695 | 5177.0 samples/s | 80.9 steps/s
[Step=8100 Epoch=31.2] | Loss=0.01056 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.754 | L2-Norm(final)=4.737 | 5436.4 samples/s | 84.9 steps/s
[Step=8150 Epoch=31.4] | Loss=0.00888 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.850 | L2-Norm(final)=4.770 | 5272.8 samples/s | 82.4 steps/s
[Step=8200 Epoch=31.6] | Loss=0.00759 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.912 | L2-Norm(final)=4.803 | 5369.6 samples/s | 83.9 steps/s
[Step=8250 Epoch=31.8] | Loss=0.00664 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.960 | L2-Norm(final)=4.838 | 6993.9 samples/s | 109.3 steps/s
[Step=8300 Epoch=31.9] | Loss=0.00576 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.997 | L2-Norm(final)=4.872 | 1924.7 samples/s | 30.1 steps/s
[Step=8350 Epoch=32.1] | Loss=0.00518 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.024 | L2-Norm(final)=4.905 | 5237.7 samples/s | 81.8 steps/s
[Step=8400 Epoch=32.3] | Loss=0.00474 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.045 | L2-Norm(final)=4.936 | 5281.9 samples/s | 82.5 steps/s
[Step=8450 Epoch=32.5] | Loss=0.00449 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.062 | L2-Norm(final)=4.967 | 5325.9 samples/s | 83.2 steps/s
[Step=8500 Epoch=32.7] | Loss=0.00420 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.075 | L2-Norm(final)=4.996 | 6167.6 samples/s | 96.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=32.7] | Loss=0.00043 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.185 | L2-Norm(final)=5.286 | 4027.9 samples/s | 62.9 steps/s
[Step=8550 Epoch=32.9] | Loss=0.02151 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.294 | L2-Norm(final)=5.271 | 4353.5 samples/s | 68.0 steps/s
[Step=8600 Epoch=33.1] | Loss=0.02062 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.514 | L2-Norm(final)=5.185 | 4775.0 samples/s | 74.6 steps/s
[Step=8650 Epoch=33.3] | Loss=0.01631 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.599 | L2-Norm(final)=5.150 | 4823.5 samples/s | 75.4 steps/s
[Step=8700 Epoch=33.5] | Loss=0.01326 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.634 | L2-Norm(final)=5.138 | 4799.9 samples/s | 75.0 steps/s
[Step=8750 Epoch=33.7] | Loss=0.01124 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.645 | L2-Norm(final)=5.135 | 6177.1 samples/s | 96.5 steps/s
[Step=8800 Epoch=33.9] | Loss=0.00944 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.642 | L2-Norm(final)=5.136 | 1866.3 samples/s | 29.2 steps/s
[Step=8850 Epoch=34.1] | Loss=0.00813 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.628 | L2-Norm(final)=5.138 | 4789.3 samples/s | 74.8 steps/s
[Step=8900 Epoch=34.3] | Loss=0.00713 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.608 | L2-Norm(final)=5.142 | 4791.6 samples/s | 74.9 steps/s
[Step=8950 Epoch=34.5] | Loss=0.00634 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.583 | L2-Norm(final)=5.145 | 4785.0 samples/s | 74.8 steps/s
[Step=9000 Epoch=34.6] | Loss=0.00571 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.555 | L2-Norm(final)=5.148 | 5385.3 samples/s | 84.1 steps/s
[Step=9050 Epoch=34.8] | Loss=0.00520 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.524 | L2-Norm(final)=5.151 | 1944.9 samples/s | 30.4 steps/s
[Step=9100 Epoch=35.0] | Loss=0.00477 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.491 | L2-Norm(final)=5.154 | 4817.1 samples/s | 75.3 steps/s
[Step=9150 Epoch=35.2] | Loss=0.00440 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.457 | L2-Norm(final)=5.156 | 4715.1 samples/s | 73.7 steps/s
[Step=9200 Epoch=35.4] | Loss=0.00409 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.421 | L2-Norm(final)=5.158 | 4784.3 samples/s | 74.8 steps/s
[Step=9250 Epoch=35.6] | Loss=0.00382 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.385 | L2-Norm(final)=5.161 | 4899.3 samples/s | 76.6 steps/s
[Step=9300 Epoch=35.8] | Loss=0.00358 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.348 | L2-Norm(final)=5.162 | 2005.1 samples/s | 31.3 steps/s
[Step=9350 Epoch=36.0] | Loss=0.00337 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.311 | L2-Norm(final)=5.164 | 4849.5 samples/s | 75.8 steps/s
[Step=9400 Epoch=36.2] | Loss=0.00318 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.273 | L2-Norm(final)=5.166 | 4741.1 samples/s | 74.1 steps/s
[Step=9450 Epoch=36.4] | Loss=0.00302 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.234 | L2-Norm(final)=5.168 | 4806.3 samples/s | 75.1 steps/s
[Step=9500 Epoch=36.6] | Loss=0.00287 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.196 | L2-Norm(final)=5.169 | 4763.4 samples/s | 74.4 steps/s
[Step=9550 Epoch=36.8] | Loss=0.00273 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.157 | L2-Norm(final)=5.171 | 2027.4 samples/s | 31.7 steps/s
[Step=9600 Epoch=37.0] | Loss=0.00261 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.118 | L2-Norm(final)=5.172 | 4862.8 samples/s | 76.0 steps/s
[Step=9650 Epoch=37.1] | Loss=0.00249 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.079 | L2-Norm(final)=5.174 | 4779.0 samples/s | 74.7 steps/s
[Step=9700 Epoch=37.3] | Loss=0.00239 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.040 | L2-Norm(final)=5.175 | 4773.3 samples/s | 74.6 steps/s
[Step=9750 Epoch=37.5] | Loss=0.00229 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.000 | L2-Norm(final)=5.176 | 4755.3 samples/s | 74.3 steps/s
[Step=9800 Epoch=37.7] | Loss=0.00221 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.961 | L2-Norm(final)=5.178 | 7111.1 samples/s | 111.1 steps/s
[Step=9850 Epoch=37.9] | Loss=0.00212 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.922 | L2-Norm(final)=5.179 | 1790.5 samples/s | 28.0 steps/s
[Step=9900 Epoch=38.1] | Loss=0.00205 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.882 | L2-Norm(final)=5.180 | 4792.1 samples/s | 74.9 steps/s
[Step=9950 Epoch=38.3] | Loss=0.00198 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.842 | L2-Norm(final)=5.181 | 4806.1 samples/s | 75.1 steps/s
[Step=10000 Epoch=38.5] | Loss=0.00191 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.803 | L2-Norm(final)=5.182 | 4713.8 samples/s | 73.7 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step10000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06939 | acc=0.9541 | tpr=0.9577 | fpr=0.0538 | 4561.8 samples/s | 17.8 steps/s
Avg test loss: 0.06939, Avg test acc: 0.95396, Avg tpr: 0.95914, Avg fpr: 0.05743, total FA: 448

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06436 | acc=0.9620 | tpr=0.9739 | fpr=0.0637 | 4605.7 samples/s | 18.0 steps/s
Avg test loss: 0.06876, Avg test acc: 0.95993, Avg tpr: 0.97249, Avg fpr: 0.06768, total FA: 528

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.24733 | acc=0.3120 | tpr=0.0070 | fpr=0.0258 | 4430.9 samples/s | 17.3 steps/s
Avg test loss: 5.26812, Avg test acc: 0.31052, Avg tpr: 0.00769, Avg fpr: 0.02346, total FA: 183

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.59993 | acc=0.3112 | tpr=0.0094 | fpr=0.0334 | 4448.0 samples/s | 17.4 steps/s
Avg test loss: 5.61078, Avg test acc: 0.30952, Avg tpr: 0.01020, Avg fpr: 0.03218, total FA: 251

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.41742 | acc=0.0950 | tpr=0.7832 | fpr=0.9174 | 4472.5 samples/s | 17.5 steps/s
[Step= 100] | Loss=4.39982 | acc=0.0971 | tpr=0.7569 | fpr=0.9152 | 8886.0 samples/s | 34.7 steps/s
[Step= 150] | Loss=4.40174 | acc=0.0963 | tpr=0.7695 | fpr=0.9161 | 8862.5 samples/s | 34.6 steps/s
[Step= 200] | Loss=4.40632 | acc=0.0961 | tpr=0.7760 | fpr=0.9163 | 8826.1 samples/s | 34.5 steps/s
[Step= 250] | Loss=4.40870 | acc=0.0958 | tpr=0.7790 | fpr=0.9166 | 8560.7 samples/s | 33.4 steps/s
[Step= 300] | Loss=4.40981 | acc=0.0958 | tpr=0.7825 | fpr=0.9167 | 9071.0 samples/s | 35.4 steps/s
[Step= 350] | Loss=4.41128 | acc=0.0957 | tpr=0.7815 | fpr=0.9167 | 8918.9 samples/s | 34.8 steps/s
[Step= 400] | Loss=4.41114 | acc=0.0958 | tpr=0.7877 | fpr=0.9168 | 8691.0 samples/s | 33.9 steps/s
[Step= 450] | Loss=4.41580 | acc=0.0959 | tpr=0.7882 | fpr=0.9167 | 8514.2 samples/s | 33.3 steps/s
[Step= 500] | Loss=4.41668 | acc=0.0956 | tpr=0.7890 | fpr=0.9169 | 8668.8 samples/s | 33.9 steps/s
[Step= 550] | Loss=4.41740 | acc=0.0958 | tpr=0.7923 | fpr=0.9169 | 16575.4 samples/s | 64.7 steps/s
Avg test loss: 4.41863, Avg test acc: 0.09570, Avg tpr: 0.79239, Avg fpr: 0.91696, total FA: 127318

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.30797 | acc=0.1203 | tpr=0.8451 | fpr=0.8927 | 4463.7 samples/s | 17.4 steps/s
[Step= 100] | Loss=4.29799 | acc=0.1209 | tpr=0.8145 | fpr=0.8920 | 8725.9 samples/s | 34.1 steps/s
[Step= 150] | Loss=4.29632 | acc=0.1205 | tpr=0.8098 | fpr=0.8922 | 8722.8 samples/s | 34.1 steps/s
[Step= 200] | Loss=4.29556 | acc=0.1203 | tpr=0.8164 | fpr=0.8924 | 8748.1 samples/s | 34.2 steps/s
[Step= 250] | Loss=4.29782 | acc=0.1210 | tpr=0.8183 | fpr=0.8917 | 9318.8 samples/s | 36.4 steps/s
[Step= 300] | Loss=4.29437 | acc=0.1210 | tpr=0.8160 | fpr=0.8917 | 8691.3 samples/s | 34.0 steps/s
[Step= 350] | Loss=4.29049 | acc=0.1206 | tpr=0.8203 | fpr=0.8921 | 8535.4 samples/s | 33.3 steps/s
[Step= 400] | Loss=4.28938 | acc=0.1213 | tpr=0.8277 | fpr=0.8915 | 9281.2 samples/s | 36.3 steps/s
[Step= 450] | Loss=4.29582 | acc=0.1208 | tpr=0.8242 | fpr=0.8920 | 8492.0 samples/s | 33.2 steps/s
[Step= 500] | Loss=4.29939 | acc=0.1206 | tpr=0.8256 | fpr=0.8921 | 8519.3 samples/s | 33.3 steps/s
[Step= 550] | Loss=4.30115 | acc=0.1204 | tpr=0.8241 | fpr=0.8924 | 15909.7 samples/s | 62.1 steps/s
Avg test loss: 4.30174, Avg test acc: 0.12032, Avg tpr: 0.82448, Avg fpr: 0.89248, total FA: 123919

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10716 | acc=0.9825 | tpr=0.9248 | fpr=0.0165 | 4491.7 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.11156 | acc=0.9813 | tpr=0.9382 | fpr=0.0179 | 8466.3 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.11482 | acc=0.9803 | tpr=0.9424 | fpr=0.0190 | 9117.6 samples/s | 35.6 steps/s
[Step= 200] | Loss=0.11631 | acc=0.9803 | tpr=0.9410 | fpr=0.0190 | 8598.7 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.11487 | acc=0.9805 | tpr=0.9389 | fpr=0.0187 | 8584.0 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.11688 | acc=0.9804 | tpr=0.9389 | fpr=0.0189 | 8870.7 samples/s | 34.7 steps/s
[Step= 350] | Loss=0.11834 | acc=0.9800 | tpr=0.9374 | fpr=0.0192 | 9038.3 samples/s | 35.3 steps/s
[Step= 400] | Loss=0.11962 | acc=0.9798 | tpr=0.9338 | fpr=0.0194 | 8479.6 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.12284 | acc=0.9794 | tpr=0.9314 | fpr=0.0198 | 8872.0 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.12193 | acc=0.9795 | tpr=0.9330 | fpr=0.0197 | 9202.6 samples/s | 35.9 steps/s
[Step= 550] | Loss=0.12151 | acc=0.9796 | tpr=0.9316 | fpr=0.0196 | 14583.3 samples/s | 57.0 steps/s
Avg test loss: 0.12129, Avg test acc: 0.97959, Avg tpr: 0.93185, Avg fpr: 0.01954, total FA: 2713

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10896 | acc=0.9826 | tpr=0.9159 | fpr=0.0162 | 4437.3 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.11349 | acc=0.9811 | tpr=0.9360 | fpr=0.0180 | 8635.1 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.11882 | acc=0.9801 | tpr=0.9395 | fpr=0.0191 | 9433.2 samples/s | 36.8 steps/s
[Step= 200] | Loss=0.11955 | acc=0.9799 | tpr=0.9464 | fpr=0.0195 | 8347.1 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.11711 | acc=0.9800 | tpr=0.9476 | fpr=0.0194 | 9028.0 samples/s | 35.3 steps/s
[Step= 300] | Loss=0.11871 | acc=0.9797 | tpr=0.9455 | fpr=0.0197 | 8735.1 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.12022 | acc=0.9794 | tpr=0.9480 | fpr=0.0201 | 8957.1 samples/s | 35.0 steps/s
[Step= 400] | Loss=0.12102 | acc=0.9792 | tpr=0.9437 | fpr=0.0202 | 8890.9 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.12333 | acc=0.9788 | tpr=0.9411 | fpr=0.0205 | 8599.5 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.12293 | acc=0.9789 | tpr=0.9405 | fpr=0.0204 | 8544.9 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.12210 | acc=0.9789 | tpr=0.9375 | fpr=0.0203 | 15936.0 samples/s | 62.2 steps/s
Avg test loss: 0.12183, Avg test acc: 0.97894, Avg tpr: 0.93740, Avg fpr: 0.02031, total FA: 2820

server round 9/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=6001 Epoch=11.7] | Loss=0.12395 | Reg=0.00229 | acc=0.9219 | L2-Norm=15.146 | L2-Norm(final)=3.742 | 3817.3 samples/s | 59.6 steps/s
[Step=6050 Epoch=11.8] | Loss=0.08667 | Reg=0.00235 | acc=0.9062 | L2-Norm=15.321 | L2-Norm(final)=3.834 | 5166.4 samples/s | 80.7 steps/s
[Step=6100 Epoch=11.9] | Loss=0.08510 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.488 | L2-Norm(final)=3.902 | 5620.4 samples/s | 87.8 steps/s
[Step=6150 Epoch=12.0] | Loss=0.07953 | Reg=0.00244 | acc=0.9219 | L2-Norm=15.630 | L2-Norm(final)=3.963 | 5733.1 samples/s | 89.6 steps/s
[Step=6200 Epoch=12.1] | Loss=0.07893 | Reg=0.00248 | acc=0.9062 | L2-Norm=15.758 | L2-Norm(final)=4.016 | 5706.9 samples/s | 89.2 steps/s
[Step=6250 Epoch=12.2] | Loss=0.07641 | Reg=0.00252 | acc=0.9688 | L2-Norm=15.872 | L2-Norm(final)=4.060 | 5581.6 samples/s | 87.2 steps/s
[Step=6300 Epoch=12.3] | Loss=0.07569 | Reg=0.00256 | acc=0.9219 | L2-Norm=15.981 | L2-Norm(final)=4.102 | 5597.1 samples/s | 87.5 steps/s
[Step=6350 Epoch=12.4] | Loss=0.07448 | Reg=0.00259 | acc=0.9688 | L2-Norm=16.078 | L2-Norm(final)=4.140 | 5627.3 samples/s | 87.9 steps/s
[Step=6400 Epoch=12.5] | Loss=0.07319 | Reg=0.00262 | acc=0.9531 | L2-Norm=16.168 | L2-Norm(final)=4.176 | 5655.4 samples/s | 88.4 steps/s
[Step=6450 Epoch=12.6] | Loss=0.07239 | Reg=0.00264 | acc=0.9375 | L2-Norm=16.253 | L2-Norm(final)=4.212 | 5778.4 samples/s | 90.3 steps/s
[Step=6500 Epoch=12.7] | Loss=0.07212 | Reg=0.00267 | acc=0.9531 | L2-Norm=16.337 | L2-Norm(final)=4.247 | 7085.2 samples/s | 110.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=12.7] | Loss=0.09816 | Reg=0.00294 | acc=0.9375 | L2-Norm=17.148 | L2-Norm(final)=4.584 | 3732.8 samples/s | 58.3 steps/s
[Step=6550 Epoch=12.8] | Loss=0.06390 | Reg=0.00296 | acc=0.9219 | L2-Norm=17.217 | L2-Norm(final)=4.589 | 5126.5 samples/s | 80.1 steps/s
[Step=6600 Epoch=12.9] | Loss=0.06072 | Reg=0.00298 | acc=0.9531 | L2-Norm=17.276 | L2-Norm(final)=4.574 | 4957.0 samples/s | 77.5 steps/s
[Step=6650 Epoch=13.0] | Loss=0.06225 | Reg=0.00300 | acc=0.9531 | L2-Norm=17.330 | L2-Norm(final)=4.551 | 5042.5 samples/s | 78.8 steps/s
[Step=6700 Epoch=13.1] | Loss=0.05870 | Reg=0.00302 | acc=0.9688 | L2-Norm=17.377 | L2-Norm(final)=4.535 | 5025.5 samples/s | 78.5 steps/s
[Step=6750 Epoch=13.2] | Loss=0.05658 | Reg=0.00303 | acc=0.9844 | L2-Norm=17.413 | L2-Norm(final)=4.526 | 5048.5 samples/s | 78.9 steps/s
[Step=6800 Epoch=13.3] | Loss=0.05541 | Reg=0.00304 | acc=0.9688 | L2-Norm=17.442 | L2-Norm(final)=4.517 | 5083.6 samples/s | 79.4 steps/s
[Step=6850 Epoch=13.4] | Loss=0.05370 | Reg=0.00305 | acc=0.9531 | L2-Norm=17.469 | L2-Norm(final)=4.509 | 5039.3 samples/s | 78.7 steps/s
[Step=6900 Epoch=13.5] | Loss=0.05378 | Reg=0.00306 | acc=0.9219 | L2-Norm=17.497 | L2-Norm(final)=4.502 | 5145.5 samples/s | 80.4 steps/s
[Step=6950 Epoch=13.6] | Loss=0.05236 | Reg=0.00307 | acc=0.9844 | L2-Norm=17.526 | L2-Norm(final)=4.496 | 5063.4 samples/s | 79.1 steps/s
[Step=7000 Epoch=13.7] | Loss=0.05118 | Reg=0.00308 | acc=0.9531 | L2-Norm=17.553 | L2-Norm(final)=4.491 | 6026.4 samples/s | 94.2 steps/s
[Step=7050 Epoch=13.8] | Loss=0.04927 | Reg=0.00309 | acc=0.9688 | L2-Norm=17.577 | L2-Norm(final)=4.486 | 1906.2 samples/s | 29.8 steps/s
[Step=7100 Epoch=13.8] | Loss=0.04714 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.600 | L2-Norm(final)=4.484 | 5023.9 samples/s | 78.5 steps/s
[Step=7150 Epoch=13.9] | Loss=0.04603 | Reg=0.00311 | acc=0.9688 | L2-Norm=17.621 | L2-Norm(final)=4.482 | 5024.2 samples/s | 78.5 steps/s
[Step=7200 Epoch=14.0] | Loss=0.04475 | Reg=0.00311 | acc=0.9688 | L2-Norm=17.640 | L2-Norm(final)=4.480 | 5070.2 samples/s | 79.2 steps/s
[Step=7250 Epoch=14.1] | Loss=0.04399 | Reg=0.00312 | acc=0.9531 | L2-Norm=17.658 | L2-Norm(final)=4.478 | 5056.1 samples/s | 79.0 steps/s
[Step=7300 Epoch=14.2] | Loss=0.04353 | Reg=0.00312 | acc=0.9375 | L2-Norm=17.676 | L2-Norm(final)=4.476 | 5092.0 samples/s | 79.6 steps/s
[Step=7350 Epoch=14.3] | Loss=0.04256 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.694 | L2-Norm(final)=4.474 | 4991.4 samples/s | 78.0 steps/s
[Step=7400 Epoch=14.4] | Loss=0.04192 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.711 | L2-Norm(final)=4.472 | 5063.6 samples/s | 79.1 steps/s
[Step=7450 Epoch=14.5] | Loss=0.04151 | Reg=0.00314 | acc=0.9219 | L2-Norm=17.727 | L2-Norm(final)=4.469 | 5059.3 samples/s | 79.1 steps/s
[Step=7500 Epoch=14.6] | Loss=0.04107 | Reg=0.00315 | acc=0.9688 | L2-Norm=17.743 | L2-Norm(final)=4.466 | 5377.0 samples/s | 84.0 steps/s
[Step=7550 Epoch=14.7] | Loss=0.04044 | Reg=0.00315 | acc=0.9688 | L2-Norm=17.758 | L2-Norm(final)=4.464 | 1948.9 samples/s | 30.5 steps/s
[Step=7600 Epoch=14.8] | Loss=0.03957 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.772 | L2-Norm(final)=4.461 | 5008.7 samples/s | 78.3 steps/s
[Step=7650 Epoch=14.9] | Loss=0.03878 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.787 | L2-Norm(final)=4.460 | 5078.9 samples/s | 79.4 steps/s
[Step=7700 Epoch=15.0] | Loss=0.03826 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.801 | L2-Norm(final)=4.459 | 5003.9 samples/s | 78.2 steps/s
[Step=7750 Epoch=15.1] | Loss=0.03767 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.815 | L2-Norm(final)=4.458 | 5062.5 samples/s | 79.1 steps/s
[Step=7800 Epoch=15.2] | Loss=0.03716 | Reg=0.00318 | acc=0.9688 | L2-Norm=17.829 | L2-Norm(final)=4.457 | 5021.2 samples/s | 78.5 steps/s
[Step=7850 Epoch=15.3] | Loss=0.03666 | Reg=0.00318 | acc=0.9688 | L2-Norm=17.844 | L2-Norm(final)=4.456 | 5070.9 samples/s | 79.2 steps/s
[Step=7900 Epoch=15.4] | Loss=0.03651 | Reg=0.00319 | acc=0.9688 | L2-Norm=17.858 | L2-Norm(final)=4.455 | 5021.2 samples/s | 78.5 steps/s
[Step=7950 Epoch=15.5] | Loss=0.03627 | Reg=0.00320 | acc=0.9531 | L2-Norm=17.873 | L2-Norm(final)=4.454 | 5099.8 samples/s | 79.7 steps/s
[Step=8000 Epoch=15.6] | Loss=0.03593 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.887 | L2-Norm(final)=4.453 | 5028.2 samples/s | 78.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step8000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=10001 Epoch=38.5] | Loss=0.08225 | Reg=0.00229 | acc=0.9219 | L2-Norm=15.146 | L2-Norm(final)=5.213 | 3795.0 samples/s | 59.3 steps/s
[Step=10050 Epoch=38.7] | Loss=0.01372 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.607 | L2-Norm(final)=5.221 | 5083.7 samples/s | 79.4 steps/s
[Step=10100 Epoch=38.9] | Loss=0.01003 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.792 | L2-Norm(final)=5.257 | 5363.2 samples/s | 83.8 steps/s
[Step=10150 Epoch=39.1] | Loss=0.00756 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.894 | L2-Norm(final)=5.283 | 5409.5 samples/s | 84.5 steps/s
[Step=10200 Epoch=39.3] | Loss=0.00690 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.939 | L2-Norm(final)=5.307 | 5325.3 samples/s | 83.2 steps/s
[Step=10250 Epoch=39.5] | Loss=0.00587 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.966 | L2-Norm(final)=5.331 | 7057.6 samples/s | 110.3 steps/s
[Step=10300 Epoch=39.6] | Loss=0.00521 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.980 | L2-Norm(final)=5.357 | 1917.0 samples/s | 30.0 steps/s
[Step=10350 Epoch=39.8] | Loss=0.00462 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.990 | L2-Norm(final)=5.386 | 5369.0 samples/s | 83.9 steps/s
[Step=10400 Epoch=40.0] | Loss=0.00423 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.993 | L2-Norm(final)=5.414 | 5292.7 samples/s | 82.7 steps/s
[Step=10450 Epoch=40.2] | Loss=0.00392 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.990 | L2-Norm(final)=5.442 | 5322.4 samples/s | 83.2 steps/s
[Step=10500 Epoch=40.4] | Loss=0.00362 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.984 | L2-Norm(final)=5.469 | 6187.8 samples/s | 96.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=40.4] | Loss=0.00033 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.900 | L2-Norm(final)=5.728 | 3794.0 samples/s | 59.3 steps/s
[Step=10550 Epoch=40.6] | Loss=0.01717 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.919 | L2-Norm(final)=5.724 | 4580.4 samples/s | 71.6 steps/s
[Step=10600 Epoch=40.8] | Loss=0.02496 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.185 | L2-Norm(final)=5.586 | 4865.9 samples/s | 76.0 steps/s
[Step=10650 Epoch=41.0] | Loss=0.01953 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.339 | L2-Norm(final)=5.518 | 4732.2 samples/s | 73.9 steps/s
[Step=10700 Epoch=41.2] | Loss=0.01657 | Reg=0.00269 | acc=0.9844 | L2-Norm=16.412 | L2-Norm(final)=5.486 | 4801.8 samples/s | 75.0 steps/s
[Step=10750 Epoch=41.4] | Loss=0.01362 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.446 | L2-Norm(final)=5.468 | 6143.0 samples/s | 96.0 steps/s
[Step=10800 Epoch=41.6] | Loss=0.01162 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.458 | L2-Norm(final)=5.460 | 1892.1 samples/s | 29.6 steps/s
[Step=10850 Epoch=41.8] | Loss=0.00998 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.455 | L2-Norm(final)=5.457 | 4665.1 samples/s | 72.9 steps/s
[Step=10900 Epoch=42.0] | Loss=0.00881 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.443 | L2-Norm(final)=5.456 | 4750.1 samples/s | 74.2 steps/s
[Step=10950 Epoch=42.2] | Loss=0.00787 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.425 | L2-Norm(final)=5.457 | 4698.6 samples/s | 73.4 steps/s
[Step=11000 Epoch=42.3] | Loss=0.00710 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.402 | L2-Norm(final)=5.459 | 5436.9 samples/s | 85.0 steps/s
[Step=11050 Epoch=42.5] | Loss=0.00646 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.377 | L2-Norm(final)=5.461 | 1933.6 samples/s | 30.2 steps/s
[Step=11100 Epoch=42.7] | Loss=0.00592 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.349 | L2-Norm(final)=5.464 | 4741.1 samples/s | 74.1 steps/s
[Step=11150 Epoch=42.9] | Loss=0.00547 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.318 | L2-Norm(final)=5.466 | 4793.3 samples/s | 74.9 steps/s
[Step=11200 Epoch=43.1] | Loss=0.00508 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.285 | L2-Norm(final)=5.468 | 4720.0 samples/s | 73.8 steps/s
[Step=11250 Epoch=43.3] | Loss=0.00474 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.252 | L2-Norm(final)=5.470 | 4870.4 samples/s | 76.1 steps/s
[Step=11300 Epoch=43.5] | Loss=0.00445 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.217 | L2-Norm(final)=5.472 | 2043.2 samples/s | 31.9 steps/s
[Step=11350 Epoch=43.7] | Loss=0.00419 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.182 | L2-Norm(final)=5.475 | 4740.0 samples/s | 74.1 steps/s
[Step=11400 Epoch=43.9] | Loss=0.00395 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.145 | L2-Norm(final)=5.477 | 4852.2 samples/s | 75.8 steps/s
[Step=11450 Epoch=44.1] | Loss=0.00375 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.109 | L2-Norm(final)=5.479 | 4761.0 samples/s | 74.4 steps/s
[Step=11500 Epoch=44.3] | Loss=0.00356 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.071 | L2-Norm(final)=5.481 | 4735.1 samples/s | 74.0 steps/s
[Step=11550 Epoch=44.5] | Loss=0.00339 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.034 | L2-Norm(final)=5.482 | 2008.4 samples/s | 31.4 steps/s
[Step=11600 Epoch=44.7] | Loss=0.00324 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.996 | L2-Norm(final)=5.484 | 4835.9 samples/s | 75.6 steps/s
[Step=11650 Epoch=44.8] | Loss=0.00310 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.958 | L2-Norm(final)=5.486 | 4756.0 samples/s | 74.3 steps/s
[Step=11700 Epoch=45.0] | Loss=0.00297 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.920 | L2-Norm(final)=5.488 | 4816.7 samples/s | 75.3 steps/s
[Step=11750 Epoch=45.2] | Loss=0.00285 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.882 | L2-Norm(final)=5.489 | 4808.1 samples/s | 75.1 steps/s
[Step=11800 Epoch=45.4] | Loss=0.00274 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.844 | L2-Norm(final)=5.491 | 6995.2 samples/s | 109.3 steps/s
[Step=11850 Epoch=45.6] | Loss=0.00264 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.805 | L2-Norm(final)=5.492 | 1794.4 samples/s | 28.0 steps/s
[Step=11900 Epoch=45.8] | Loss=0.00255 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.767 | L2-Norm(final)=5.494 | 4756.0 samples/s | 74.3 steps/s
[Step=11950 Epoch=46.0] | Loss=0.00246 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.728 | L2-Norm(final)=5.496 | 4748.2 samples/s | 74.2 steps/s
[Step=12000 Epoch=46.2] | Loss=0.00238 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.690 | L2-Norm(final)=5.497 | 4782.2 samples/s | 74.7 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06421 | acc=0.9563 | tpr=0.9577 | fpr=0.0468 | 4489.3 samples/s | 17.5 steps/s
Avg test loss: 0.06761, Avg test acc: 0.95484, Avg tpr: 0.95623, Avg fpr: 0.04820, total FA: 376

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06436 | acc=0.9620 | tpr=0.9739 | fpr=0.0637 | 4500.4 samples/s | 17.6 steps/s
Avg test loss: 0.06876, Avg test acc: 0.95993, Avg tpr: 0.97249, Avg fpr: 0.06768, total FA: 528

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.24733 | acc=0.3120 | tpr=0.0070 | fpr=0.0258 | 4437.8 samples/s | 17.3 steps/s
Avg test loss: 5.26812, Avg test acc: 0.31052, Avg tpr: 0.00769, Avg fpr: 0.02346, total FA: 183

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.16972 | acc=0.3063 | tpr=0.0121 | fpr=0.0548 | 4464.2 samples/s | 17.4 steps/s
Avg test loss: 5.16985, Avg test acc: 0.30495, Avg tpr: 0.01288, Avg fpr: 0.05269, total FA: 411

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.38818 | acc=0.1328 | tpr=0.6416 | fpr=0.8763 | 4435.6 samples/s | 17.3 steps/s
[Step= 100] | Loss=4.36194 | acc=0.1339 | tpr=0.6183 | fpr=0.8751 | 9159.7 samples/s | 35.8 steps/s
[Step= 150] | Loss=4.36019 | acc=0.1334 | tpr=0.6369 | fpr=0.8759 | 8552.8 samples/s | 33.4 steps/s
[Step= 200] | Loss=4.35995 | acc=0.1330 | tpr=0.6317 | fpr=0.8761 | 8694.9 samples/s | 34.0 steps/s
[Step= 250] | Loss=4.36252 | acc=0.1327 | tpr=0.6314 | fpr=0.8764 | 8903.7 samples/s | 34.8 steps/s
[Step= 300] | Loss=4.36139 | acc=0.1331 | tpr=0.6342 | fpr=0.8761 | 8713.1 samples/s | 34.0 steps/s
[Step= 350] | Loss=4.35589 | acc=0.1326 | tpr=0.6337 | fpr=0.8765 | 8827.1 samples/s | 34.5 steps/s
[Step= 400] | Loss=4.35751 | acc=0.1330 | tpr=0.6368 | fpr=0.8762 | 8878.3 samples/s | 34.7 steps/s
[Step= 450] | Loss=4.36397 | acc=0.1328 | tpr=0.6324 | fpr=0.8762 | 8492.1 samples/s | 33.2 steps/s
[Step= 500] | Loss=4.36719 | acc=0.1329 | tpr=0.6322 | fpr=0.8761 | 9417.6 samples/s | 36.8 steps/s
[Step= 550] | Loss=4.36915 | acc=0.1328 | tpr=0.6367 | fpr=0.8763 | 14831.3 samples/s | 57.9 steps/s
Avg test loss: 4.36999, Avg test acc: 0.13271, Avg tpr: 0.63788, Avg fpr: 0.87648, total FA: 121697

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.30797 | acc=0.1203 | tpr=0.8451 | fpr=0.8927 | 4488.5 samples/s | 17.5 steps/s
[Step= 100] | Loss=4.29799 | acc=0.1209 | tpr=0.8145 | fpr=0.8920 | 8603.0 samples/s | 33.6 steps/s
[Step= 150] | Loss=4.29632 | acc=0.1205 | tpr=0.8098 | fpr=0.8922 | 8880.8 samples/s | 34.7 steps/s
[Step= 200] | Loss=4.29556 | acc=0.1203 | tpr=0.8164 | fpr=0.8924 | 8809.7 samples/s | 34.4 steps/s
[Step= 250] | Loss=4.29782 | acc=0.1210 | tpr=0.8183 | fpr=0.8917 | 8966.7 samples/s | 35.0 steps/s
[Step= 300] | Loss=4.29437 | acc=0.1210 | tpr=0.8160 | fpr=0.8917 | 8768.4 samples/s | 34.3 steps/s
[Step= 350] | Loss=4.29049 | acc=0.1206 | tpr=0.8203 | fpr=0.8921 | 8760.3 samples/s | 34.2 steps/s
[Step= 400] | Loss=4.28938 | acc=0.1213 | tpr=0.8277 | fpr=0.8915 | 8958.9 samples/s | 35.0 steps/s
[Step= 450] | Loss=4.29582 | acc=0.1208 | tpr=0.8242 | fpr=0.8920 | 8684.3 samples/s | 33.9 steps/s
[Step= 500] | Loss=4.29939 | acc=0.1206 | tpr=0.8256 | fpr=0.8921 | 9154.1 samples/s | 35.8 steps/s
[Step= 550] | Loss=4.30115 | acc=0.1204 | tpr=0.8241 | fpr=0.8924 | 15187.7 samples/s | 59.3 steps/s
Avg test loss: 4.30174, Avg test acc: 0.12032, Avg tpr: 0.82448, Avg fpr: 0.89248, total FA: 123919

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10716 | acc=0.9825 | tpr=0.9248 | fpr=0.0165 | 4490.5 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.11156 | acc=0.9813 | tpr=0.9382 | fpr=0.0179 | 8733.1 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.11482 | acc=0.9803 | tpr=0.9424 | fpr=0.0190 | 8623.2 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.11631 | acc=0.9803 | tpr=0.9410 | fpr=0.0190 | 8731.4 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.11487 | acc=0.9805 | tpr=0.9389 | fpr=0.0187 | 8962.3 samples/s | 35.0 steps/s
[Step= 300] | Loss=0.11688 | acc=0.9804 | tpr=0.9389 | fpr=0.0189 | 8953.5 samples/s | 35.0 steps/s
[Step= 350] | Loss=0.11834 | acc=0.9800 | tpr=0.9374 | fpr=0.0192 | 8721.5 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.11962 | acc=0.9798 | tpr=0.9338 | fpr=0.0194 | 8520.8 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.12284 | acc=0.9794 | tpr=0.9314 | fpr=0.0198 | 9832.4 samples/s | 38.4 steps/s
[Step= 500] | Loss=0.12193 | acc=0.9795 | tpr=0.9330 | fpr=0.0197 | 8028.8 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.12151 | acc=0.9796 | tpr=0.9316 | fpr=0.0196 | 15757.2 samples/s | 61.6 steps/s
Avg test loss: 0.12129, Avg test acc: 0.97959, Avg tpr: 0.93185, Avg fpr: 0.01954, total FA: 2713

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11416 | acc=0.9809 | tpr=0.9159 | fpr=0.0179 | 4520.9 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.11964 | acc=0.9807 | tpr=0.9318 | fpr=0.0183 | 8440.5 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.12403 | acc=0.9799 | tpr=0.9395 | fpr=0.0194 | 8858.7 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.12539 | acc=0.9797 | tpr=0.9454 | fpr=0.0197 | 8783.0 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.12306 | acc=0.9799 | tpr=0.9415 | fpr=0.0194 | 8834.5 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.12581 | acc=0.9795 | tpr=0.9367 | fpr=0.0198 | 8711.4 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.12706 | acc=0.9792 | tpr=0.9405 | fpr=0.0201 | 8880.2 samples/s | 34.7 steps/s
[Step= 400] | Loss=0.12755 | acc=0.9791 | tpr=0.9382 | fpr=0.0201 | 9190.2 samples/s | 35.9 steps/s
[Step= 450] | Loss=0.12976 | acc=0.9789 | tpr=0.9377 | fpr=0.0204 | 8660.8 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.12898 | acc=0.9790 | tpr=0.9383 | fpr=0.0203 | 8742.5 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.12812 | acc=0.9790 | tpr=0.9379 | fpr=0.0202 | 15587.5 samples/s | 60.9 steps/s
Avg test loss: 0.12779, Avg test acc: 0.97903, Avg tpr: 0.93819, Avg fpr: 0.02022, total FA: 2808

server round 10/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=10001 Epoch=19.6] | Loss=0.15184 | Reg=0.00229 | acc=0.9062 | L2-Norm=15.117 | L2-Norm(final)=4.391 | 3899.2 samples/s | 60.9 steps/s
[Step=10050 Epoch=19.6] | Loss=0.08110 | Reg=0.00230 | acc=0.9531 | L2-Norm=15.174 | L2-Norm(final)=4.441 | 5478.3 samples/s | 85.6 steps/s
[Step=10100 Epoch=19.7] | Loss=0.07972 | Reg=0.00232 | acc=0.9062 | L2-Norm=15.246 | L2-Norm(final)=4.486 | 5693.9 samples/s | 89.0 steps/s
[Step=10150 Epoch=19.8] | Loss=0.07662 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.311 | L2-Norm(final)=4.520 | 5643.4 samples/s | 88.2 steps/s
[Step=10200 Epoch=19.9] | Loss=0.07438 | Reg=0.00236 | acc=0.9375 | L2-Norm=15.371 | L2-Norm(final)=4.555 | 5723.1 samples/s | 89.4 steps/s
[Step=10250 Epoch=20.0] | Loss=0.07393 | Reg=0.00238 | acc=0.9375 | L2-Norm=15.428 | L2-Norm(final)=4.586 | 5652.2 samples/s | 88.3 steps/s
[Step=10300 Epoch=20.1] | Loss=0.07283 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.483 | L2-Norm(final)=4.613 | 5679.4 samples/s | 88.7 steps/s
[Step=10350 Epoch=20.2] | Loss=0.07251 | Reg=0.00241 | acc=0.9531 | L2-Norm=15.534 | L2-Norm(final)=4.638 | 5797.5 samples/s | 90.6 steps/s
[Step=10400 Epoch=20.3] | Loss=0.07192 | Reg=0.00243 | acc=0.9219 | L2-Norm=15.582 | L2-Norm(final)=4.664 | 5614.0 samples/s | 87.7 steps/s
[Step=10450 Epoch=20.4] | Loss=0.07077 | Reg=0.00244 | acc=0.9219 | L2-Norm=15.628 | L2-Norm(final)=4.689 | 5803.7 samples/s | 90.7 steps/s
[Step=10500 Epoch=20.5] | Loss=0.06955 | Reg=0.00246 | acc=0.9375 | L2-Norm=15.674 | L2-Norm(final)=4.714 | 7129.1 samples/s | 111.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=20.5] | Loss=0.03617 | Reg=0.00260 | acc=0.9688 | L2-Norm=16.140 | L2-Norm(final)=4.969 | 3781.1 samples/s | 59.1 steps/s
[Step=10550 Epoch=20.6] | Loss=0.05680 | Reg=0.00262 | acc=0.9531 | L2-Norm=16.182 | L2-Norm(final)=4.985 | 4953.6 samples/s | 77.4 steps/s
[Step=10600 Epoch=20.7] | Loss=0.05205 | Reg=0.00263 | acc=0.9531 | L2-Norm=16.204 | L2-Norm(final)=4.981 | 5033.7 samples/s | 78.7 steps/s
[Step=10650 Epoch=20.8] | Loss=0.04833 | Reg=0.00263 | acc=0.9688 | L2-Norm=16.218 | L2-Norm(final)=4.976 | 5079.2 samples/s | 79.4 steps/s
[Step=10700 Epoch=20.9] | Loss=0.04479 | Reg=0.00263 | acc=0.9844 | L2-Norm=16.230 | L2-Norm(final)=4.973 | 5046.3 samples/s | 78.8 steps/s
[Step=10750 Epoch=21.0] | Loss=0.04281 | Reg=0.00264 | acc=0.9219 | L2-Norm=16.242 | L2-Norm(final)=4.972 | 5008.7 samples/s | 78.3 steps/s
[Step=10800 Epoch=21.1] | Loss=0.04055 | Reg=0.00264 | acc=0.9844 | L2-Norm=16.254 | L2-Norm(final)=4.971 | 5071.9 samples/s | 79.2 steps/s
[Step=10850 Epoch=21.2] | Loss=0.03858 | Reg=0.00265 | acc=0.9688 | L2-Norm=16.264 | L2-Norm(final)=4.971 | 5023.3 samples/s | 78.5 steps/s
[Step=10900 Epoch=21.3] | Loss=0.03721 | Reg=0.00265 | acc=0.9844 | L2-Norm=16.273 | L2-Norm(final)=4.971 | 5029.0 samples/s | 78.6 steps/s
[Step=10950 Epoch=21.4] | Loss=0.03682 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.281 | L2-Norm(final)=4.972 | 5088.3 samples/s | 79.5 steps/s
[Step=11000 Epoch=21.5] | Loss=0.03600 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.289 | L2-Norm(final)=4.971 | 6192.2 samples/s | 96.8 steps/s
[Step=11050 Epoch=21.6] | Loss=0.03436 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.297 | L2-Norm(final)=4.972 | 1922.0 samples/s | 30.0 steps/s
[Step=11100 Epoch=21.7] | Loss=0.03293 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.304 | L2-Norm(final)=4.973 | 5018.3 samples/s | 78.4 steps/s
[Step=11150 Epoch=21.8] | Loss=0.03167 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.311 | L2-Norm(final)=4.975 | 5009.5 samples/s | 78.3 steps/s
[Step=11200 Epoch=21.9] | Loss=0.03095 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.317 | L2-Norm(final)=4.976 | 5030.4 samples/s | 78.6 steps/s
[Step=11250 Epoch=22.0] | Loss=0.03035 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.323 | L2-Norm(final)=4.977 | 5081.4 samples/s | 79.4 steps/s
[Step=11300 Epoch=22.1] | Loss=0.02975 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.328 | L2-Norm(final)=4.978 | 5003.6 samples/s | 78.2 steps/s
[Step=11350 Epoch=22.2] | Loss=0.02928 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.333 | L2-Norm(final)=4.979 | 5039.4 samples/s | 78.7 steps/s
[Step=11400 Epoch=22.3] | Loss=0.02875 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.339 | L2-Norm(final)=4.980 | 5053.5 samples/s | 79.0 steps/s
[Step=11450 Epoch=22.4] | Loss=0.02832 | Reg=0.00267 | acc=0.9688 | L2-Norm=16.344 | L2-Norm(final)=4.982 | 5038.7 samples/s | 78.7 steps/s
[Step=11500 Epoch=22.5] | Loss=0.02806 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.348 | L2-Norm(final)=4.982 | 5480.9 samples/s | 85.6 steps/s
[Step=11550 Epoch=22.6] | Loss=0.02762 | Reg=0.00267 | acc=0.9688 | L2-Norm=16.352 | L2-Norm(final)=4.983 | 2011.9 samples/s | 31.4 steps/s
[Step=11600 Epoch=22.7] | Loss=0.02708 | Reg=0.00268 | acc=0.9688 | L2-Norm=16.357 | L2-Norm(final)=4.985 | 5067.4 samples/s | 79.2 steps/s
[Step=11650 Epoch=22.8] | Loss=0.02668 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.361 | L2-Norm(final)=4.986 | 5010.7 samples/s | 78.3 steps/s
[Step=11700 Epoch=22.9] | Loss=0.02619 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.365 | L2-Norm(final)=4.987 | 5051.8 samples/s | 78.9 steps/s
[Step=11750 Epoch=23.0] | Loss=0.02568 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.369 | L2-Norm(final)=4.989 | 5100.3 samples/s | 79.7 steps/s
[Step=11800 Epoch=23.1] | Loss=0.02511 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.373 | L2-Norm(final)=4.991 | 5025.8 samples/s | 78.5 steps/s
[Step=11850 Epoch=23.2] | Loss=0.02483 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.377 | L2-Norm(final)=4.993 | 5107.2 samples/s | 79.8 steps/s
[Step=11900 Epoch=23.3] | Loss=0.02453 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.380 | L2-Norm(final)=4.994 | 5098.5 samples/s | 79.7 steps/s
[Step=11950 Epoch=23.4] | Loss=0.02423 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.384 | L2-Norm(final)=4.996 | 4992.5 samples/s | 78.0 steps/s
[Step=12000 Epoch=23.5] | Loss=0.02394 | Reg=0.00269 | acc=0.9844 | L2-Norm=16.388 | L2-Norm(final)=4.997 | 5005.2 samples/s | 78.2 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step12000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=12001 Epoch=46.2] | Loss=0.03330 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.117 | L2-Norm(final)=5.541 | 3729.4 samples/s | 58.3 steps/s
[Step=12050 Epoch=46.4] | Loss=0.00848 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.192 | L2-Norm(final)=5.565 | 5240.7 samples/s | 81.9 steps/s
[Step=12100 Epoch=46.6] | Loss=0.00703 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.224 | L2-Norm(final)=5.601 | 5340.6 samples/s | 83.4 steps/s
[Step=12150 Epoch=46.8] | Loss=0.00515 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.249 | L2-Norm(final)=5.635 | 5356.0 samples/s | 83.7 steps/s
[Step=12200 Epoch=47.0] | Loss=0.00521 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.266 | L2-Norm(final)=5.664 | 5344.7 samples/s | 83.5 steps/s
[Step=12250 Epoch=47.2] | Loss=0.00469 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.288 | L2-Norm(final)=5.690 | 7059.7 samples/s | 110.3 steps/s
[Step=12300 Epoch=47.3] | Loss=0.00415 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.307 | L2-Norm(final)=5.714 | 1917.8 samples/s | 30.0 steps/s
[Step=12350 Epoch=47.5] | Loss=0.00382 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.319 | L2-Norm(final)=5.738 | 5430.7 samples/s | 84.9 steps/s
[Step=12400 Epoch=47.7] | Loss=0.00355 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.330 | L2-Norm(final)=5.761 | 5417.0 samples/s | 84.6 steps/s
[Step=12450 Epoch=47.9] | Loss=0.00329 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.337 | L2-Norm(final)=5.783 | 5127.2 samples/s | 80.1 steps/s
[Step=12500 Epoch=48.1] | Loss=0.00316 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.342 | L2-Norm(final)=5.804 | 6216.3 samples/s | 97.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=48.1] | Loss=0.00349 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.389 | L2-Norm(final)=6.015 | 3880.6 samples/s | 60.6 steps/s
[Step=12550 Epoch=48.3] | Loss=0.00274 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.391 | L2-Norm(final)=6.033 | 4517.5 samples/s | 70.6 steps/s
[Step=12600 Epoch=48.5] | Loss=0.00353 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.419 | L2-Norm(final)=6.038 | 4798.7 samples/s | 75.0 steps/s
[Step=12650 Epoch=48.7] | Loss=0.00390 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.443 | L2-Norm(final)=6.038 | 4794.2 samples/s | 74.9 steps/s
[Step=12700 Epoch=48.9] | Loss=0.00355 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.456 | L2-Norm(final)=6.040 | 4752.4 samples/s | 74.3 steps/s
[Step=12750 Epoch=49.1] | Loss=0.00350 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.464 | L2-Norm(final)=6.040 | 6163.5 samples/s | 96.3 steps/s
[Step=12800 Epoch=49.3] | Loss=0.00300 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.469 | L2-Norm(final)=6.040 | 1863.5 samples/s | 29.1 steps/s
[Step=12850 Epoch=49.5] | Loss=0.00261 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.467 | L2-Norm(final)=6.041 | 4756.4 samples/s | 74.3 steps/s
[Step=12900 Epoch=49.7] | Loss=0.00230 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.459 | L2-Norm(final)=6.043 | 4758.2 samples/s | 74.3 steps/s
[Step=12950 Epoch=49.8] | Loss=0.00205 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.447 | L2-Norm(final)=6.045 | 4798.4 samples/s | 75.0 steps/s
[Step=13000 Epoch=50.0] | Loss=0.00192 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.432 | L2-Norm(final)=6.047 | 5397.9 samples/s | 84.3 steps/s
[Step=13050 Epoch=50.2] | Loss=0.00174 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.415 | L2-Norm(final)=6.048 | 1944.5 samples/s | 30.4 steps/s
[Step=13100 Epoch=50.4] | Loss=0.00160 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.396 | L2-Norm(final)=6.049 | 4802.1 samples/s | 75.0 steps/s
[Step=13150 Epoch=50.6] | Loss=0.00148 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.376 | L2-Norm(final)=6.051 | 4784.3 samples/s | 74.8 steps/s
[Step=13200 Epoch=50.8] | Loss=0.00137 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.356 | L2-Norm(final)=6.052 | 4813.3 samples/s | 75.2 steps/s
[Step=13250 Epoch=51.0] | Loss=0.00128 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.334 | L2-Norm(final)=6.053 | 4851.7 samples/s | 75.8 steps/s
[Step=13300 Epoch=51.2] | Loss=0.00120 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.313 | L2-Norm(final)=6.055 | 2018.4 samples/s | 31.5 steps/s
[Step=13350 Epoch=51.4] | Loss=0.00113 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.290 | L2-Norm(final)=6.056 | 4857.7 samples/s | 75.9 steps/s
[Step=13400 Epoch=51.6] | Loss=0.00107 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.267 | L2-Norm(final)=6.057 | 4714.8 samples/s | 73.7 steps/s
[Step=13450 Epoch=51.8] | Loss=0.00102 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.244 | L2-Norm(final)=6.058 | 4769.4 samples/s | 74.5 steps/s
[Step=13500 Epoch=52.0] | Loss=0.00097 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.221 | L2-Norm(final)=6.059 | 4795.4 samples/s | 74.9 steps/s
[Step=13550 Epoch=52.2] | Loss=0.00092 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.197 | L2-Norm(final)=6.060 | 2044.4 samples/s | 31.9 steps/s
[Step=13600 Epoch=52.4] | Loss=0.00088 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.173 | L2-Norm(final)=6.061 | 4773.3 samples/s | 74.6 steps/s
[Step=13650 Epoch=52.5] | Loss=0.00084 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.149 | L2-Norm(final)=6.061 | 4840.0 samples/s | 75.6 steps/s
[Step=13700 Epoch=52.7] | Loss=0.00081 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.125 | L2-Norm(final)=6.062 | 4698.7 samples/s | 73.4 steps/s
[Step=13750 Epoch=52.9] | Loss=0.00077 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.100 | L2-Norm(final)=6.063 | 4786.4 samples/s | 74.8 steps/s
[Step=13800 Epoch=53.1] | Loss=0.00074 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.075 | L2-Norm(final)=6.064 | 6908.2 samples/s | 107.9 steps/s
[Step=13850 Epoch=53.3] | Loss=0.00072 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.051 | L2-Norm(final)=6.065 | 1785.3 samples/s | 27.9 steps/s
[Step=13900 Epoch=53.5] | Loss=0.00069 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.026 | L2-Norm(final)=6.065 | 4841.7 samples/s | 75.7 steps/s
[Step=13950 Epoch=53.7] | Loss=0.00067 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.001 | L2-Norm(final)=6.066 | 4721.8 samples/s | 73.8 steps/s
[Step=14000 Epoch=53.9] | Loss=0.00065 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.976 | L2-Norm(final)=6.067 | 4797.9 samples/s | 75.0 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step14000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06421 | acc=0.9563 | tpr=0.9577 | fpr=0.0468 | 4519.8 samples/s | 17.7 steps/s
Avg test loss: 0.06761, Avg test acc: 0.95484, Avg tpr: 0.95623, Avg fpr: 0.04820, total FA: 376

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06226 | acc=0.9652 | tpr=0.9712 | fpr=0.0481 | 4508.3 samples/s | 17.6 steps/s
Avg test loss: 0.07002, Avg test acc: 0.96302, Avg tpr: 0.96876, Avg fpr: 0.04961, total FA: 387

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.24733 | acc=0.3120 | tpr=0.0070 | fpr=0.0258 | 4544.4 samples/s | 17.8 steps/s
Avg test loss: 5.26812, Avg test acc: 0.31052, Avg tpr: 0.00769, Avg fpr: 0.02346, total FA: 183

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.62303 | acc=0.3043 | tpr=0.0254 | fpr=0.0902 | 4410.6 samples/s | 17.2 steps/s
Avg test loss: 5.61505, Avg test acc: 0.30467, Avg tpr: 0.02745, Avg fpr: 0.08563, total FA: 668

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.38818 | acc=0.1328 | tpr=0.6416 | fpr=0.8763 | 4538.0 samples/s | 17.7 steps/s
[Step= 100] | Loss=4.36194 | acc=0.1339 | tpr=0.6183 | fpr=0.8751 | 8551.6 samples/s | 33.4 steps/s
[Step= 150] | Loss=4.36019 | acc=0.1334 | tpr=0.6369 | fpr=0.8759 | 8551.0 samples/s | 33.4 steps/s
[Step= 200] | Loss=4.35995 | acc=0.1330 | tpr=0.6317 | fpr=0.8761 | 9084.0 samples/s | 35.5 steps/s
[Step= 250] | Loss=4.36252 | acc=0.1327 | tpr=0.6314 | fpr=0.8764 | 8543.2 samples/s | 33.4 steps/s
[Step= 300] | Loss=4.36139 | acc=0.1331 | tpr=0.6342 | fpr=0.8761 | 8766.2 samples/s | 34.2 steps/s
[Step= 350] | Loss=4.35589 | acc=0.1326 | tpr=0.6337 | fpr=0.8765 | 9046.6 samples/s | 35.3 steps/s
[Step= 400] | Loss=4.35751 | acc=0.1330 | tpr=0.6368 | fpr=0.8762 | 8740.0 samples/s | 34.1 steps/s
[Step= 450] | Loss=4.36397 | acc=0.1328 | tpr=0.6324 | fpr=0.8762 | 5422.3 samples/s | 21.2 steps/s
[Step= 500] | Loss=4.36719 | acc=0.1329 | tpr=0.6322 | fpr=0.8761 | 8810.6 samples/s | 34.4 steps/s
[Step= 550] | Loss=4.36915 | acc=0.1328 | tpr=0.6367 | fpr=0.8763 | 16003.9 samples/s | 62.5 steps/s
Avg test loss: 4.36999, Avg test acc: 0.13271, Avg tpr: 0.63788, Avg fpr: 0.87648, total FA: 121697

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.17297 | acc=0.1114 | tpr=0.7168 | fpr=0.8995 | 4434.4 samples/s | 17.3 steps/s
[Step= 100] | Loss=5.14932 | acc=0.1130 | tpr=0.6972 | fpr=0.8979 | 9055.0 samples/s | 35.4 steps/s
[Step= 150] | Loss=5.17080 | acc=0.1117 | tpr=0.6902 | fpr=0.8989 | 8637.8 samples/s | 33.7 steps/s
[Step= 200] | Loss=5.16342 | acc=0.1112 | tpr=0.6929 | fpr=0.8994 | 8998.6 samples/s | 35.2 steps/s
[Step= 250] | Loss=5.16523 | acc=0.1110 | tpr=0.6873 | fpr=0.8995 | 8703.3 samples/s | 34.0 steps/s
[Step= 300] | Loss=5.16628 | acc=0.1109 | tpr=0.6873 | fpr=0.8996 | 8768.3 samples/s | 34.3 steps/s
[Step= 350] | Loss=5.16382 | acc=0.1110 | tpr=0.6838 | fpr=0.8994 | 8773.8 samples/s | 34.3 steps/s
[Step= 400] | Loss=5.16082 | acc=0.1113 | tpr=0.6893 | fpr=0.8992 | 8867.4 samples/s | 34.6 steps/s
[Step= 450] | Loss=5.16951 | acc=0.1110 | tpr=0.6831 | fpr=0.8994 | 5780.6 samples/s | 22.6 steps/s
[Step= 500] | Loss=5.17350 | acc=0.1110 | tpr=0.6846 | fpr=0.8994 | 9008.3 samples/s | 35.2 steps/s
[Step= 550] | Loss=5.17642 | acc=0.1111 | tpr=0.6856 | fpr=0.8993 | 16030.7 samples/s | 62.6 steps/s
Avg test loss: 5.17722, Avg test acc: 0.11101, Avg tpr: 0.68700, Avg fpr: 0.89947, total FA: 124889

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10716 | acc=0.9825 | tpr=0.9248 | fpr=0.0165 | 4508.9 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.11156 | acc=0.9813 | tpr=0.9382 | fpr=0.0179 | 8547.9 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.11482 | acc=0.9803 | tpr=0.9424 | fpr=0.0190 | 9229.3 samples/s | 36.1 steps/s
[Step= 200] | Loss=0.11631 | acc=0.9803 | tpr=0.9410 | fpr=0.0190 | 8382.2 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.11487 | acc=0.9805 | tpr=0.9389 | fpr=0.0187 | 8890.6 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.11688 | acc=0.9804 | tpr=0.9389 | fpr=0.0189 | 8654.1 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.11834 | acc=0.9800 | tpr=0.9374 | fpr=0.0192 | 9328.3 samples/s | 36.4 steps/s
[Step= 400] | Loss=0.11962 | acc=0.9798 | tpr=0.9338 | fpr=0.0194 | 8325.1 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.12284 | acc=0.9794 | tpr=0.9314 | fpr=0.0198 | 6505.2 samples/s | 25.4 steps/s
[Step= 500] | Loss=0.12193 | acc=0.9795 | tpr=0.9330 | fpr=0.0197 | 8617.2 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.12151 | acc=0.9796 | tpr=0.9316 | fpr=0.0196 | 16182.7 samples/s | 63.2 steps/s
Avg test loss: 0.12129, Avg test acc: 0.97959, Avg tpr: 0.93185, Avg fpr: 0.01954, total FA: 2713

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11112 | acc=0.9810 | tpr=0.9336 | fpr=0.0181 | 4553.4 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.11645 | acc=0.9800 | tpr=0.9382 | fpr=0.0192 | 8447.1 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.12020 | acc=0.9794 | tpr=0.9438 | fpr=0.0200 | 8777.5 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.12033 | acc=0.9794 | tpr=0.9475 | fpr=0.0200 | 8649.8 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.11875 | acc=0.9795 | tpr=0.9424 | fpr=0.0198 | 8970.0 samples/s | 35.0 steps/s
[Step= 300] | Loss=0.12101 | acc=0.9793 | tpr=0.9404 | fpr=0.0200 | 8791.2 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.12161 | acc=0.9792 | tpr=0.9449 | fpr=0.0202 | 9172.4 samples/s | 35.8 steps/s
[Step= 400] | Loss=0.12245 | acc=0.9789 | tpr=0.9437 | fpr=0.0204 | 8806.4 samples/s | 34.4 steps/s
[Step= 450] | Loss=0.12482 | acc=0.9786 | tpr=0.9416 | fpr=0.0208 | 8451.1 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.12392 | acc=0.9787 | tpr=0.9419 | fpr=0.0206 | 9382.0 samples/s | 36.6 steps/s
[Step= 550] | Loss=0.12302 | acc=0.9787 | tpr=0.9403 | fpr=0.0206 | 14580.4 samples/s | 57.0 steps/s
Avg test loss: 0.12270, Avg test acc: 0.97877, Avg tpr: 0.94057, Avg fpr: 0.02054, total FA: 2852

server round 11/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=12001 Epoch=23.5] | Loss=0.06821 | Reg=0.00224 | acc=0.9375 | L2-Norm=14.961 | L2-Norm(final)=5.041 | 3723.7 samples/s | 58.2 steps/s
[Step=12050 Epoch=23.6] | Loss=0.06424 | Reg=0.00226 | acc=0.9375 | L2-Norm=15.017 | L2-Norm(final)=5.052 | 5697.9 samples/s | 89.0 steps/s
[Step=12100 Epoch=23.7] | Loss=0.05963 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.067 | L2-Norm(final)=5.074 | 5623.5 samples/s | 87.9 steps/s
[Step=12150 Epoch=23.8] | Loss=0.05830 | Reg=0.00229 | acc=0.9531 | L2-Norm=15.119 | L2-Norm(final)=5.098 | 5666.0 samples/s | 88.5 steps/s
[Step=12200 Epoch=23.9] | Loss=0.05668 | Reg=0.00230 | acc=0.9531 | L2-Norm=15.169 | L2-Norm(final)=5.123 | 5618.4 samples/s | 87.8 steps/s
[Step=12250 Epoch=23.9] | Loss=0.05528 | Reg=0.00232 | acc=0.9375 | L2-Norm=15.216 | L2-Norm(final)=5.147 | 5719.5 samples/s | 89.4 steps/s
[Step=12300 Epoch=24.0] | Loss=0.05478 | Reg=0.00233 | acc=0.9375 | L2-Norm=15.262 | L2-Norm(final)=5.170 | 5630.3 samples/s | 88.0 steps/s
[Step=12350 Epoch=24.1] | Loss=0.05391 | Reg=0.00234 | acc=0.9531 | L2-Norm=15.305 | L2-Norm(final)=5.191 | 5669.5 samples/s | 88.6 steps/s
[Step=12400 Epoch=24.2] | Loss=0.05290 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.346 | L2-Norm(final)=5.212 | 5673.6 samples/s | 88.7 steps/s
[Step=12450 Epoch=24.3] | Loss=0.05217 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.385 | L2-Norm(final)=5.232 | 5685.3 samples/s | 88.8 steps/s
[Step=12500 Epoch=24.4] | Loss=0.05124 | Reg=0.00238 | acc=0.9531 | L2-Norm=15.422 | L2-Norm(final)=5.252 | 7266.4 samples/s | 113.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=24.4] | Loss=0.06476 | Reg=0.00249 | acc=0.9531 | L2-Norm=15.788 | L2-Norm(final)=5.455 | 3805.7 samples/s | 59.5 steps/s
[Step=12550 Epoch=24.5] | Loss=0.04985 | Reg=0.00250 | acc=0.9531 | L2-Norm=15.825 | L2-Norm(final)=5.466 | 4995.0 samples/s | 78.0 steps/s
[Step=12600 Epoch=24.6] | Loss=0.04481 | Reg=0.00252 | acc=0.9531 | L2-Norm=15.866 | L2-Norm(final)=5.456 | 5067.2 samples/s | 79.2 steps/s
[Step=12650 Epoch=24.7] | Loss=0.04272 | Reg=0.00252 | acc=0.9688 | L2-Norm=15.889 | L2-Norm(final)=5.451 | 5061.1 samples/s | 79.1 steps/s
[Step=12700 Epoch=24.8] | Loss=0.04021 | Reg=0.00253 | acc=0.9531 | L2-Norm=15.907 | L2-Norm(final)=5.448 | 4988.2 samples/s | 77.9 steps/s
[Step=12750 Epoch=24.9] | Loss=0.03892 | Reg=0.00254 | acc=0.9688 | L2-Norm=15.923 | L2-Norm(final)=5.446 | 4946.4 samples/s | 77.3 steps/s
[Step=12800 Epoch=25.0] | Loss=0.03824 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.938 | L2-Norm(final)=5.446 | 5055.9 samples/s | 79.0 steps/s
[Step=12850 Epoch=25.1] | Loss=0.03737 | Reg=0.00254 | acc=0.9688 | L2-Norm=15.952 | L2-Norm(final)=5.444 | 5054.9 samples/s | 79.0 steps/s
[Step=12900 Epoch=25.2] | Loss=0.03629 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.966 | L2-Norm(final)=5.443 | 5069.5 samples/s | 79.2 steps/s
[Step=12950 Epoch=25.3] | Loss=0.03606 | Reg=0.00255 | acc=0.9844 | L2-Norm=15.979 | L2-Norm(final)=5.442 | 5082.8 samples/s | 79.4 steps/s
[Step=13000 Epoch=25.4] | Loss=0.03523 | Reg=0.00256 | acc=0.9688 | L2-Norm=15.989 | L2-Norm(final)=5.440 | 6191.6 samples/s | 96.7 steps/s
[Step=13050 Epoch=25.5] | Loss=0.03391 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.000 | L2-Norm(final)=5.440 | 1945.2 samples/s | 30.4 steps/s
[Step=13100 Epoch=25.6] | Loss=0.03273 | Reg=0.00256 | acc=0.9688 | L2-Norm=16.010 | L2-Norm(final)=5.441 | 5061.4 samples/s | 79.1 steps/s
[Step=13150 Epoch=25.7] | Loss=0.03162 | Reg=0.00257 | acc=0.9688 | L2-Norm=16.019 | L2-Norm(final)=5.442 | 4962.4 samples/s | 77.5 steps/s
[Step=13200 Epoch=25.8] | Loss=0.03091 | Reg=0.00257 | acc=0.9688 | L2-Norm=16.028 | L2-Norm(final)=5.443 | 5069.3 samples/s | 79.2 steps/s
[Step=13250 Epoch=25.9] | Loss=0.02992 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.036 | L2-Norm(final)=5.444 | 5032.0 samples/s | 78.6 steps/s
[Step=13300 Epoch=26.0] | Loss=0.02927 | Reg=0.00257 | acc=0.9219 | L2-Norm=16.044 | L2-Norm(final)=5.446 | 5051.7 samples/s | 78.9 steps/s
[Step=13350 Epoch=26.1] | Loss=0.02878 | Reg=0.00258 | acc=0.9688 | L2-Norm=16.052 | L2-Norm(final)=5.447 | 5067.8 samples/s | 79.2 steps/s
[Step=13400 Epoch=26.2] | Loss=0.02816 | Reg=0.00258 | acc=0.9688 | L2-Norm=16.059 | L2-Norm(final)=5.448 | 5071.9 samples/s | 79.2 steps/s
[Step=13450 Epoch=26.3] | Loss=0.02765 | Reg=0.00258 | acc=0.9688 | L2-Norm=16.066 | L2-Norm(final)=5.450 | 5054.3 samples/s | 79.0 steps/s
[Step=13500 Epoch=26.4] | Loss=0.02721 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.072 | L2-Norm(final)=5.451 | 5498.2 samples/s | 85.9 steps/s
[Step=13550 Epoch=26.5] | Loss=0.02688 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.079 | L2-Norm(final)=5.453 | 2007.1 samples/s | 31.4 steps/s
[Step=13600 Epoch=26.6] | Loss=0.02632 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.085 | L2-Norm(final)=5.454 | 5055.3 samples/s | 79.0 steps/s
[Step=13650 Epoch=26.7] | Loss=0.02571 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.090 | L2-Norm(final)=5.456 | 5033.8 samples/s | 78.7 steps/s
[Step=13700 Epoch=26.8] | Loss=0.02529 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.096 | L2-Norm(final)=5.457 | 4981.0 samples/s | 77.8 steps/s
[Step=13750 Epoch=26.9] | Loss=0.02482 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.101 | L2-Norm(final)=5.459 | 5080.9 samples/s | 79.4 steps/s
[Step=13800 Epoch=27.0] | Loss=0.02468 | Reg=0.00259 | acc=0.9688 | L2-Norm=16.106 | L2-Norm(final)=5.461 | 5096.3 samples/s | 79.6 steps/s
[Step=13850 Epoch=27.1] | Loss=0.02420 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.111 | L2-Norm(final)=5.463 | 5020.1 samples/s | 78.4 steps/s
[Step=13900 Epoch=27.2] | Loss=0.02389 | Reg=0.00260 | acc=0.9844 | L2-Norm=16.116 | L2-Norm(final)=5.465 | 5014.8 samples/s | 78.4 steps/s
[Step=13950 Epoch=27.3] | Loss=0.02361 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.121 | L2-Norm(final)=5.467 | 5081.3 samples/s | 79.4 steps/s
[Step=14000 Epoch=27.4] | Loss=0.02338 | Reg=0.00260 | acc=0.9844 | L2-Norm=16.126 | L2-Norm(final)=5.469 | 5015.4 samples/s | 78.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step14000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=10001 Epoch=38.3] | Loss=0.01514 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.961 | L2-Norm(final)=6.005 | 4036.3 samples/s | 63.1 steps/s
[Step=10050 Epoch=38.5] | Loss=0.00866 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.026 | L2-Norm(final)=6.016 | 4833.2 samples/s | 75.5 steps/s
[Step=10100 Epoch=38.7] | Loss=0.00761 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.057 | L2-Norm(final)=6.028 | 5123.4 samples/s | 80.1 steps/s
[Step=10150 Epoch=38.9] | Loss=0.00586 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.072 | L2-Norm(final)=6.039 | 5450.3 samples/s | 85.2 steps/s
[Step=10200 Epoch=39.1] | Loss=0.00486 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.081 | L2-Norm(final)=6.056 | 5157.0 samples/s | 80.6 steps/s
[Step=10250 Epoch=39.3] | Loss=0.00459 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.092 | L2-Norm(final)=6.073 | 7013.1 samples/s | 109.6 steps/s
[Step=10300 Epoch=39.5] | Loss=0.00426 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.103 | L2-Norm(final)=6.090 | 1916.8 samples/s | 30.0 steps/s
[Step=10350 Epoch=39.7] | Loss=0.00376 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.113 | L2-Norm(final)=6.107 | 5308.8 samples/s | 82.9 steps/s
[Step=10400 Epoch=39.8] | Loss=0.00340 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.118 | L2-Norm(final)=6.123 | 5368.6 samples/s | 83.9 steps/s
[Step=10450 Epoch=40.0] | Loss=0.00313 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.122 | L2-Norm(final)=6.140 | 5260.9 samples/s | 82.2 steps/s
[Step=10500 Epoch=40.2] | Loss=0.00292 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.124 | L2-Norm(final)=6.156 | 5964.1 samples/s | 93.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=40.2] | Loss=0.00062 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.144 | L2-Norm(final)=6.318 | 3797.6 samples/s | 59.3 steps/s
[Step=10550 Epoch=40.4] | Loss=0.00092 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.139 | L2-Norm(final)=6.330 | 4565.5 samples/s | 71.3 steps/s
[Step=10600 Epoch=40.6] | Loss=0.00200 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.146 | L2-Norm(final)=6.340 | 4837.2 samples/s | 75.6 steps/s
[Step=10650 Epoch=40.8] | Loss=0.00219 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.173 | L2-Norm(final)=6.345 | 4800.5 samples/s | 75.0 steps/s
[Step=10700 Epoch=41.0] | Loss=0.00196 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.192 | L2-Norm(final)=6.351 | 4751.1 samples/s | 74.2 steps/s
[Step=10750 Epoch=41.2] | Loss=0.00191 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.202 | L2-Norm(final)=6.357 | 5980.8 samples/s | 93.5 steps/s
[Step=10800 Epoch=41.4] | Loss=0.00181 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.211 | L2-Norm(final)=6.361 | 1878.8 samples/s | 29.4 steps/s
[Step=10850 Epoch=41.6] | Loss=0.00157 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.214 | L2-Norm(final)=6.365 | 4742.4 samples/s | 74.1 steps/s
[Step=10900 Epoch=41.8] | Loss=0.00138 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.211 | L2-Norm(final)=6.369 | 4832.9 samples/s | 75.5 steps/s
[Step=10950 Epoch=42.0] | Loss=0.00126 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.204 | L2-Norm(final)=6.373 | 4770.7 samples/s | 74.5 steps/s
[Step=11000 Epoch=42.1] | Loss=0.00113 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.195 | L2-Norm(final)=6.376 | 5226.6 samples/s | 81.7 steps/s
[Step=11050 Epoch=42.3] | Loss=0.00103 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.184 | L2-Norm(final)=6.379 | 1945.2 samples/s | 30.4 steps/s
[Step=11100 Epoch=42.5] | Loss=0.00095 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.171 | L2-Norm(final)=6.382 | 4777.4 samples/s | 74.6 steps/s
[Step=11150 Epoch=42.7] | Loss=0.00088 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.156 | L2-Norm(final)=6.384 | 4777.4 samples/s | 74.6 steps/s
[Step=11200 Epoch=42.9] | Loss=0.00081 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.141 | L2-Norm(final)=6.386 | 4782.3 samples/s | 74.7 steps/s
[Step=11250 Epoch=43.1] | Loss=0.00076 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.125 | L2-Norm(final)=6.388 | 4793.6 samples/s | 74.9 steps/s
[Step=11300 Epoch=43.3] | Loss=0.00071 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.108 | L2-Norm(final)=6.390 | 2003.5 samples/s | 31.3 steps/s
[Step=11350 Epoch=43.5] | Loss=0.00067 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.090 | L2-Norm(final)=6.391 | 4859.6 samples/s | 75.9 steps/s
[Step=11400 Epoch=43.7] | Loss=0.00063 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.072 | L2-Norm(final)=6.393 | 4835.7 samples/s | 75.6 steps/s
[Step=11450 Epoch=43.9] | Loss=0.00060 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.053 | L2-Norm(final)=6.394 | 4736.4 samples/s | 74.0 steps/s
[Step=11500 Epoch=44.1] | Loss=0.00057 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.034 | L2-Norm(final)=6.395 | 4821.6 samples/s | 75.3 steps/s
[Step=11550 Epoch=44.3] | Loss=0.00055 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.015 | L2-Norm(final)=6.396 | 2040.9 samples/s | 31.9 steps/s
[Step=11600 Epoch=44.4] | Loss=0.00052 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.995 | L2-Norm(final)=6.397 | 4832.7 samples/s | 75.5 steps/s
[Step=11650 Epoch=44.6] | Loss=0.00050 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.975 | L2-Norm(final)=6.398 | 4739.0 samples/s | 74.0 steps/s
[Step=11700 Epoch=44.8] | Loss=0.00048 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.955 | L2-Norm(final)=6.399 | 4796.1 samples/s | 74.9 steps/s
[Step=11750 Epoch=45.0] | Loss=0.00046 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.934 | L2-Norm(final)=6.400 | 4804.0 samples/s | 75.1 steps/s
[Step=11800 Epoch=45.2] | Loss=0.00044 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.913 | L2-Norm(final)=6.401 | 6558.6 samples/s | 102.5 steps/s
[Step=11850 Epoch=45.4] | Loss=0.00043 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.892 | L2-Norm(final)=6.402 | 1811.9 samples/s | 28.3 steps/s
[Step=11900 Epoch=45.6] | Loss=0.00041 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.871 | L2-Norm(final)=6.403 | 4783.0 samples/s | 74.7 steps/s
[Step=11950 Epoch=45.8] | Loss=0.00040 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.850 | L2-Norm(final)=6.404 | 4855.2 samples/s | 75.9 steps/s
[Step=12000 Epoch=46.0] | Loss=0.00038 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.828 | L2-Norm(final)=6.404 | 4678.6 samples/s | 73.1 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06421 | acc=0.9563 | tpr=0.9577 | fpr=0.0468 | 4497.8 samples/s | 17.6 steps/s
Avg test loss: 0.06761, Avg test acc: 0.95484, Avg tpr: 0.95623, Avg fpr: 0.04820, total FA: 376

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05897 | acc=0.9630 | tpr=0.9647 | fpr=0.0406 | 4420.1 samples/s | 17.3 steps/s
Avg test loss: 0.06357, Avg test acc: 0.96214, Avg tpr: 0.96491, Avg fpr: 0.04397, total FA: 343

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.10166 | acc=0.3144 | tpr=0.0136 | fpr=0.0325 | 4593.6 samples/s | 17.9 steps/s
Avg test loss: 5.12368, Avg test acc: 0.31208, Avg tpr: 0.01358, Avg fpr: 0.03141, total FA: 245

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.62303 | acc=0.3043 | tpr=0.0254 | fpr=0.0902 | 4478.2 samples/s | 17.5 steps/s
Avg test loss: 5.61505, Avg test acc: 0.30467, Avg tpr: 0.02745, Avg fpr: 0.08563, total FA: 668

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.38818 | acc=0.1328 | tpr=0.6416 | fpr=0.8763 | 4448.1 samples/s | 17.4 steps/s
[Step= 100] | Loss=4.36194 | acc=0.1339 | tpr=0.6183 | fpr=0.8751 | 9254.0 samples/s | 36.1 steps/s
[Step= 150] | Loss=4.36019 | acc=0.1334 | tpr=0.6369 | fpr=0.8759 | 4955.6 samples/s | 19.4 steps/s
[Step= 200] | Loss=4.35995 | acc=0.1330 | tpr=0.6317 | fpr=0.8761 | 8757.8 samples/s | 34.2 steps/s
[Step= 250] | Loss=4.36252 | acc=0.1327 | tpr=0.6314 | fpr=0.8764 | 8942.1 samples/s | 34.9 steps/s
[Step= 300] | Loss=4.36139 | acc=0.1331 | tpr=0.6342 | fpr=0.8761 | 8914.8 samples/s | 34.8 steps/s
[Step= 350] | Loss=4.35589 | acc=0.1326 | tpr=0.6337 | fpr=0.8765 | 8548.1 samples/s | 33.4 steps/s
[Step= 400] | Loss=4.35751 | acc=0.1330 | tpr=0.6368 | fpr=0.8762 | 8884.7 samples/s | 34.7 steps/s
[Step= 450] | Loss=4.36397 | acc=0.1328 | tpr=0.6324 | fpr=0.8762 | 8643.0 samples/s | 33.8 steps/s
[Step= 500] | Loss=4.36719 | acc=0.1329 | tpr=0.6322 | fpr=0.8761 | 8590.3 samples/s | 33.6 steps/s
[Step= 550] | Loss=4.36915 | acc=0.1328 | tpr=0.6367 | fpr=0.8763 | 16185.3 samples/s | 63.2 steps/s
Avg test loss: 4.36999, Avg test acc: 0.13271, Avg tpr: 0.63788, Avg fpr: 0.87648, total FA: 121697

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.17189 | acc=0.1248 | tpr=0.6460 | fpr=0.8845 | 4606.7 samples/s | 18.0 steps/s
[Step= 100] | Loss=5.14788 | acc=0.1254 | tpr=0.6098 | fpr=0.8836 | 5380.7 samples/s | 21.0 steps/s
[Step= 150] | Loss=5.16798 | acc=0.1232 | tpr=0.5994 | fpr=0.8856 | 7890.3 samples/s | 30.8 steps/s
[Step= 200] | Loss=5.16442 | acc=0.1220 | tpr=0.5934 | fpr=0.8866 | 8275.6 samples/s | 32.3 steps/s
[Step= 250] | Loss=5.16455 | acc=0.1219 | tpr=0.5948 | fpr=0.8867 | 9280.2 samples/s | 36.3 steps/s
[Step= 300] | Loss=5.16518 | acc=0.1225 | tpr=0.5920 | fpr=0.8860 | 8250.9 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.16132 | acc=0.1227 | tpr=0.5917 | fpr=0.8858 | 8828.8 samples/s | 34.5 steps/s
[Step= 400] | Loss=5.16017 | acc=0.1229 | tpr=0.5979 | fpr=0.8857 | 8929.2 samples/s | 34.9 steps/s
[Step= 450] | Loss=5.16757 | acc=0.1224 | tpr=0.5949 | fpr=0.8862 | 8623.3 samples/s | 33.7 steps/s
[Step= 500] | Loss=5.17226 | acc=0.1224 | tpr=0.5947 | fpr=0.8861 | 8936.2 samples/s | 34.9 steps/s
[Step= 550] | Loss=5.17663 | acc=0.1224 | tpr=0.5969 | fpr=0.8862 | 15938.9 samples/s | 62.3 steps/s
Avg test loss: 5.17832, Avg test acc: 0.12233, Avg tpr: 0.59826, Avg fpr: 0.88632, total FA: 123064

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11961 | acc=0.9811 | tpr=0.9027 | fpr=0.0175 | 4494.8 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.12444 | acc=0.9805 | tpr=0.9168 | fpr=0.0183 | 4968.7 samples/s | 19.4 steps/s
[Step= 150] | Loss=0.12897 | acc=0.9801 | tpr=0.9265 | fpr=0.0190 | 8866.5 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.13058 | acc=0.9800 | tpr=0.9246 | fpr=0.0190 | 8632.1 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.12836 | acc=0.9803 | tpr=0.9240 | fpr=0.0186 | 8899.0 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.13079 | acc=0.9800 | tpr=0.9236 | fpr=0.0190 | 8768.3 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.13226 | acc=0.9797 | tpr=0.9261 | fpr=0.0194 | 9082.1 samples/s | 35.5 steps/s
[Step= 400] | Loss=0.13318 | acc=0.9795 | tpr=0.9245 | fpr=0.0195 | 8422.0 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.13644 | acc=0.9791 | tpr=0.9231 | fpr=0.0198 | 8634.4 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.13543 | acc=0.9794 | tpr=0.9242 | fpr=0.0197 | 8832.5 samples/s | 34.5 steps/s
[Step= 550] | Loss=0.13490 | acc=0.9794 | tpr=0.9224 | fpr=0.0196 | 15642.2 samples/s | 61.1 steps/s
Avg test loss: 0.13467, Avg test acc: 0.97939, Avg tpr: 0.92235, Avg fpr: 0.01957, total FA: 2717

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11112 | acc=0.9810 | tpr=0.9336 | fpr=0.0181 | 4411.9 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.11645 | acc=0.9800 | tpr=0.9382 | fpr=0.0192 | 5131.4 samples/s | 20.0 steps/s
[Step= 150] | Loss=0.12020 | acc=0.9794 | tpr=0.9438 | fpr=0.0200 | 8749.1 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.12033 | acc=0.9794 | tpr=0.9475 | fpr=0.0200 | 8757.7 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.11875 | acc=0.9795 | tpr=0.9424 | fpr=0.0198 | 9266.7 samples/s | 36.2 steps/s
[Step= 300] | Loss=0.12101 | acc=0.9793 | tpr=0.9404 | fpr=0.0200 | 8844.4 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.12161 | acc=0.9792 | tpr=0.9449 | fpr=0.0202 | 8288.5 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.12245 | acc=0.9789 | tpr=0.9437 | fpr=0.0204 | 8941.7 samples/s | 34.9 steps/s
[Step= 450] | Loss=0.12482 | acc=0.9786 | tpr=0.9416 | fpr=0.0208 | 8859.6 samples/s | 34.6 steps/s
[Step= 500] | Loss=0.12392 | acc=0.9787 | tpr=0.9419 | fpr=0.0206 | 8712.9 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.12302 | acc=0.9787 | tpr=0.9403 | fpr=0.0206 | 15122.0 samples/s | 59.1 steps/s
Avg test loss: 0.12270, Avg test acc: 0.97877, Avg tpr: 0.94057, Avg fpr: 0.02054, total FA: 2852

server round 12/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=8001 Epoch=15.6] | Loss=0.04387 | Reg=0.00224 | acc=0.9688 | L2-Norm=14.965 | L2-Norm(final)=4.414 | 3503.5 samples/s | 54.7 steps/s
[Step=8050 Epoch=15.7] | Loss=0.04101 | Reg=0.00225 | acc=0.9375 | L2-Norm=15.004 | L2-Norm(final)=4.440 | 5523.2 samples/s | 86.3 steps/s
[Step=8100 Epoch=15.8] | Loss=0.03737 | Reg=0.00226 | acc=0.9531 | L2-Norm=15.043 | L2-Norm(final)=4.461 | 5508.0 samples/s | 86.1 steps/s
[Step=8150 Epoch=15.9] | Loss=0.03451 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.077 | L2-Norm(final)=4.480 | 5692.4 samples/s | 88.9 steps/s
[Step=8200 Epoch=16.0] | Loss=0.03350 | Reg=0.00228 | acc=0.9688 | L2-Norm=15.110 | L2-Norm(final)=4.499 | 5660.6 samples/s | 88.4 steps/s
[Step=8250 Epoch=16.1] | Loss=0.03285 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.142 | L2-Norm(final)=4.516 | 5659.4 samples/s | 88.4 steps/s
[Step=8300 Epoch=16.2] | Loss=0.03215 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.171 | L2-Norm(final)=4.532 | 5673.4 samples/s | 88.6 steps/s
[Step=8350 Epoch=16.3] | Loss=0.03166 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.199 | L2-Norm(final)=4.547 | 5640.3 samples/s | 88.1 steps/s
[Step=8400 Epoch=16.4] | Loss=0.03138 | Reg=0.00232 | acc=0.9688 | L2-Norm=15.226 | L2-Norm(final)=4.561 | 5804.4 samples/s | 90.7 steps/s
[Step=8450 Epoch=16.5] | Loss=0.03110 | Reg=0.00233 | acc=0.9375 | L2-Norm=15.251 | L2-Norm(final)=4.575 | 5639.6 samples/s | 88.1 steps/s
[Step=8500 Epoch=16.6] | Loss=0.03057 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.276 | L2-Norm(final)=4.588 | 7084.5 samples/s | 110.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=8501 Epoch=16.6] | Loss=0.03443 | Reg=0.00241 | acc=0.9688 | L2-Norm=15.522 | L2-Norm(final)=4.719 | 3573.0 samples/s | 55.8 steps/s
[Step=8550 Epoch=16.7] | Loss=0.02465 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.545 | L2-Norm(final)=4.731 | 4856.7 samples/s | 75.9 steps/s
[Step=8600 Epoch=16.8] | Loss=0.02801 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.562 | L2-Norm(final)=4.733 | 5084.7 samples/s | 79.4 steps/s
[Step=8650 Epoch=16.9] | Loss=0.02768 | Reg=0.00243 | acc=0.9375 | L2-Norm=15.580 | L2-Norm(final)=4.735 | 4985.9 samples/s | 77.9 steps/s
[Step=8700 Epoch=17.0] | Loss=0.02907 | Reg=0.00243 | acc=0.9531 | L2-Norm=15.595 | L2-Norm(final)=4.732 | 5066.9 samples/s | 79.2 steps/s
[Step=8750 Epoch=17.1] | Loss=0.02980 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.612 | L2-Norm(final)=4.728 | 5101.0 samples/s | 79.7 steps/s
[Step=8800 Epoch=17.2] | Loss=0.02856 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.627 | L2-Norm(final)=4.726 | 5007.2 samples/s | 78.2 steps/s
[Step=8850 Epoch=17.3] | Loss=0.02867 | Reg=0.00245 | acc=0.9531 | L2-Norm=15.641 | L2-Norm(final)=4.727 | 5036.6 samples/s | 78.7 steps/s
[Step=8900 Epoch=17.4] | Loss=0.02816 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.655 | L2-Norm(final)=4.726 | 5103.0 samples/s | 79.7 steps/s
[Step=8950 Epoch=17.5] | Loss=0.02800 | Reg=0.00245 | acc=0.9531 | L2-Norm=15.668 | L2-Norm(final)=4.726 | 5036.0 samples/s | 78.7 steps/s
[Step=9000 Epoch=17.6] | Loss=0.02721 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.680 | L2-Norm(final)=4.725 | 6141.9 samples/s | 96.0 steps/s
[Step=9050 Epoch=17.7] | Loss=0.02654 | Reg=0.00246 | acc=0.9688 | L2-Norm=15.691 | L2-Norm(final)=4.725 | 1909.1 samples/s | 29.8 steps/s
[Step=9100 Epoch=17.7] | Loss=0.02565 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.701 | L2-Norm(final)=4.725 | 5045.4 samples/s | 78.8 steps/s
[Step=9150 Epoch=17.8] | Loss=0.02493 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.709 | L2-Norm(final)=4.726 | 5024.2 samples/s | 78.5 steps/s
[Step=9200 Epoch=17.9] | Loss=0.02467 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.718 | L2-Norm(final)=4.725 | 5024.8 samples/s | 78.5 steps/s
[Step=9250 Epoch=18.0] | Loss=0.02426 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.726 | L2-Norm(final)=4.726 | 5030.1 samples/s | 78.6 steps/s
[Step=9300 Epoch=18.1] | Loss=0.02375 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.734 | L2-Norm(final)=4.726 | 5057.6 samples/s | 79.0 steps/s
[Step=9350 Epoch=18.2] | Loss=0.02340 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.742 | L2-Norm(final)=4.728 | 4953.9 samples/s | 77.4 steps/s
[Step=9400 Epoch=18.3] | Loss=0.02309 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.750 | L2-Norm(final)=4.729 | 5053.6 samples/s | 79.0 steps/s
[Step=9450 Epoch=18.4] | Loss=0.02295 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.758 | L2-Norm(final)=4.730 | 5031.8 samples/s | 78.6 steps/s
[Step=9500 Epoch=18.5] | Loss=0.02273 | Reg=0.00249 | acc=0.9844 | L2-Norm=15.766 | L2-Norm(final)=4.731 | 5387.4 samples/s | 84.2 steps/s
[Step=9550 Epoch=18.6] | Loss=0.02232 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.773 | L2-Norm(final)=4.732 | 1979.2 samples/s | 30.9 steps/s
[Step=9600 Epoch=18.7] | Loss=0.02192 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.781 | L2-Norm(final)=4.733 | 5072.4 samples/s | 79.3 steps/s
[Step=9650 Epoch=18.8] | Loss=0.02170 | Reg=0.00249 | acc=0.9688 | L2-Norm=15.788 | L2-Norm(final)=4.735 | 5027.0 samples/s | 78.5 steps/s
[Step=9700 Epoch=18.9] | Loss=0.02130 | Reg=0.00249 | acc=0.9844 | L2-Norm=15.795 | L2-Norm(final)=4.736 | 5038.4 samples/s | 78.7 steps/s
[Step=9750 Epoch=19.0] | Loss=0.02109 | Reg=0.00250 | acc=0.9688 | L2-Norm=15.801 | L2-Norm(final)=4.737 | 5084.6 samples/s | 79.4 steps/s
[Step=9800 Epoch=19.1] | Loss=0.02087 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.808 | L2-Norm(final)=4.739 | 5029.5 samples/s | 78.6 steps/s
[Step=9850 Epoch=19.2] | Loss=0.02075 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.814 | L2-Norm(final)=4.740 | 5010.9 samples/s | 78.3 steps/s
[Step=9900 Epoch=19.3] | Loss=0.02048 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.820 | L2-Norm(final)=4.741 | 5076.7 samples/s | 79.3 steps/s
[Step=9950 Epoch=19.4] | Loss=0.02028 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.826 | L2-Norm(final)=4.742 | 5066.1 samples/s | 79.2 steps/s
[Step=10000 Epoch=19.5] | Loss=0.02019 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.832 | L2-Norm(final)=4.744 | 5047.7 samples/s | 78.9 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step10000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=12001 Epoch=46.0] | Loss=0.03415 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.965 | L2-Norm(final)=6.426 | 3682.6 samples/s | 57.5 steps/s
[Step=12050 Epoch=46.2] | Loss=0.00445 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.015 | L2-Norm(final)=6.447 | 2239.5 samples/s | 35.0 steps/s
[Step=12100 Epoch=46.4] | Loss=0.00348 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.071 | L2-Norm(final)=6.484 | 4753.6 samples/s | 74.3 steps/s
[Step=12150 Epoch=46.6] | Loss=0.00270 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.104 | L2-Norm(final)=6.517 | 5317.0 samples/s | 83.1 steps/s
[Step=12200 Epoch=46.7] | Loss=0.00264 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.124 | L2-Norm(final)=6.546 | 5100.1 samples/s | 79.7 steps/s
[Step=12250 Epoch=46.9] | Loss=0.00255 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.150 | L2-Norm(final)=6.567 | 6495.6 samples/s | 101.5 steps/s
[Step=12300 Epoch=47.1] | Loss=0.00224 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.174 | L2-Norm(final)=6.586 | 1908.5 samples/s | 29.8 steps/s
[Step=12350 Epoch=47.3] | Loss=0.00197 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.187 | L2-Norm(final)=6.602 | 5200.8 samples/s | 81.3 steps/s
[Step=12400 Epoch=47.5] | Loss=0.00177 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.192 | L2-Norm(final)=6.617 | 5371.9 samples/s | 83.9 steps/s
[Step=12450 Epoch=47.7] | Loss=0.00160 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.193 | L2-Norm(final)=6.632 | 5323.3 samples/s | 83.2 steps/s
[Step=12500 Epoch=47.9] | Loss=0.00150 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.191 | L2-Norm(final)=6.646 | 5970.9 samples/s | 93.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=47.9] | Loss=0.00063 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.174 | L2-Norm(final)=6.786 | 3837.5 samples/s | 60.0 steps/s
[Step=12550 Epoch=48.1] | Loss=0.00023 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.154 | L2-Norm(final)=6.795 | 4576.7 samples/s | 71.5 steps/s
[Step=12600 Epoch=48.3] | Loss=0.00024 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.131 | L2-Norm(final)=6.803 | 4750.7 samples/s | 74.2 steps/s
[Step=12650 Epoch=48.5] | Loss=0.00064 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.117 | L2-Norm(final)=6.811 | 4778.4 samples/s | 74.7 steps/s
[Step=12700 Epoch=48.7] | Loss=0.00224 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.143 | L2-Norm(final)=6.815 | 4779.7 samples/s | 74.7 steps/s
[Step=12750 Epoch=48.9] | Loss=0.00447 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.194 | L2-Norm(final)=6.808 | 6049.6 samples/s | 94.5 steps/s
[Step=12800 Epoch=49.0] | Loss=0.00436 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.243 | L2-Norm(final)=6.797 | 1879.1 samples/s | 29.4 steps/s
[Step=12850 Epoch=49.2] | Loss=0.00380 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.276 | L2-Norm(final)=6.789 | 4794.1 samples/s | 74.9 steps/s
[Step=12900 Epoch=49.4] | Loss=0.00339 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.297 | L2-Norm(final)=6.784 | 4742.0 samples/s | 74.1 steps/s
[Step=12950 Epoch=49.6] | Loss=0.00302 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.310 | L2-Norm(final)=6.781 | 4749.6 samples/s | 74.2 steps/s
[Step=13000 Epoch=49.8] | Loss=0.00285 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.316 | L2-Norm(final)=6.779 | 5339.7 samples/s | 83.4 steps/s
[Step=13050 Epoch=50.0] | Loss=0.00259 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.318 | L2-Norm(final)=6.777 | 1979.0 samples/s | 30.9 steps/s
[Step=13100 Epoch=50.2] | Loss=0.00238 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.316 | L2-Norm(final)=6.776 | 4796.2 samples/s | 74.9 steps/s
[Step=13150 Epoch=50.4] | Loss=0.00220 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.312 | L2-Norm(final)=6.775 | 4703.1 samples/s | 73.5 steps/s
[Step=13200 Epoch=50.6] | Loss=0.00204 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.306 | L2-Norm(final)=6.774 | 4821.0 samples/s | 75.3 steps/s
[Step=13250 Epoch=50.8] | Loss=0.00191 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.298 | L2-Norm(final)=6.774 | 4744.4 samples/s | 74.1 steps/s
[Step=13300 Epoch=51.0] | Loss=0.00179 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.288 | L2-Norm(final)=6.774 | 2043.5 samples/s | 31.9 steps/s
[Step=13350 Epoch=51.2] | Loss=0.00169 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.278 | L2-Norm(final)=6.774 | 4841.2 samples/s | 75.6 steps/s
[Step=13400 Epoch=51.3] | Loss=0.00159 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.266 | L2-Norm(final)=6.774 | 4800.3 samples/s | 75.0 steps/s
[Step=13450 Epoch=51.5] | Loss=0.00151 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.254 | L2-Norm(final)=6.774 | 4758.4 samples/s | 74.3 steps/s
[Step=13500 Epoch=51.7] | Loss=0.00144 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.241 | L2-Norm(final)=6.774 | 4795.0 samples/s | 74.9 steps/s
[Step=13550 Epoch=51.9] | Loss=0.00137 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.227 | L2-Norm(final)=6.774 | 2057.0 samples/s | 32.1 steps/s
[Step=13600 Epoch=52.1] | Loss=0.00131 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.213 | L2-Norm(final)=6.774 | 4730.5 samples/s | 73.9 steps/s
[Step=13650 Epoch=52.3] | Loss=0.00125 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.199 | L2-Norm(final)=6.775 | 4857.5 samples/s | 75.9 steps/s
[Step=13700 Epoch=52.5] | Loss=0.00120 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.183 | L2-Norm(final)=6.775 | 4737.6 samples/s | 74.0 steps/s
[Step=13750 Epoch=52.7] | Loss=0.00115 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.168 | L2-Norm(final)=6.775 | 4714.4 samples/s | 73.7 steps/s
[Step=13800 Epoch=52.9] | Loss=0.00111 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.152 | L2-Norm(final)=6.776 | 6458.9 samples/s | 100.9 steps/s
[Step=13850 Epoch=53.1] | Loss=0.00107 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.136 | L2-Norm(final)=6.776 | 1826.0 samples/s | 28.5 steps/s
[Step=13900 Epoch=53.3] | Loss=0.00103 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.120 | L2-Norm(final)=6.777 | 4859.2 samples/s | 75.9 steps/s
[Step=13950 Epoch=53.5] | Loss=0.00099 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.103 | L2-Norm(final)=6.777 | 4751.8 samples/s | 74.2 steps/s
[Step=14000 Epoch=53.6] | Loss=0.00096 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.086 | L2-Norm(final)=6.778 | 4761.3 samples/s | 74.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step14000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05839 | acc=0.9657 | tpr=0.9755 | fpr=0.0555 | 4435.1 samples/s | 17.3 steps/s
Avg test loss: 0.05947, Avg test acc: 0.96494, Avg tpr: 0.97517, Avg fpr: 0.05756, total FA: 449

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05897 | acc=0.9630 | tpr=0.9647 | fpr=0.0406 | 4414.7 samples/s | 17.2 steps/s
Avg test loss: 0.06357, Avg test acc: 0.96214, Avg tpr: 0.96491, Avg fpr: 0.04397, total FA: 343

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.66157 | acc=0.3134 | tpr=0.0403 | fpr=0.0937 | 4464.4 samples/s | 17.4 steps/s
Avg test loss: 4.66487, Avg test acc: 0.31224, Avg tpr: 0.04121, Avg fpr: 0.09165, total FA: 715

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.62303 | acc=0.3043 | tpr=0.0254 | fpr=0.0902 | 4448.6 samples/s | 17.4 steps/s
Avg test loss: 5.61505, Avg test acc: 0.30467, Avg tpr: 0.02745, Avg fpr: 0.08563, total FA: 668

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.89196 | acc=0.1070 | tpr=0.7124 | fpr=0.9038 | 4472.5 samples/s | 17.5 steps/s
[Step= 100] | Loss=4.86698 | acc=0.1058 | tpr=0.6738 | fpr=0.9048 | 8811.1 samples/s | 34.4 steps/s
[Step= 150] | Loss=4.87303 | acc=0.1058 | tpr=0.6844 | fpr=0.9049 | 9362.3 samples/s | 36.6 steps/s
[Step= 200] | Loss=4.87156 | acc=0.1064 | tpr=0.6863 | fpr=0.9041 | 8554.8 samples/s | 33.4 steps/s
[Step= 250] | Loss=4.87195 | acc=0.1068 | tpr=0.6865 | fpr=0.9038 | 8596.5 samples/s | 33.6 steps/s
[Step= 300] | Loss=4.87013 | acc=0.1068 | tpr=0.6909 | fpr=0.9038 | 8979.9 samples/s | 35.1 steps/s
[Step= 350] | Loss=4.86863 | acc=0.1064 | tpr=0.6863 | fpr=0.9041 | 8647.2 samples/s | 33.8 steps/s
[Step= 400] | Loss=4.86606 | acc=0.1069 | tpr=0.6898 | fpr=0.9037 | 8884.9 samples/s | 34.7 steps/s
[Step= 450] | Loss=4.87222 | acc=0.1066 | tpr=0.6835 | fpr=0.9039 | 8809.9 samples/s | 34.4 steps/s
[Step= 500] | Loss=4.87547 | acc=0.1068 | tpr=0.6872 | fpr=0.9037 | 8870.7 samples/s | 34.7 steps/s
[Step= 550] | Loss=4.87842 | acc=0.1069 | tpr=0.6876 | fpr=0.9036 | 15585.9 samples/s | 60.9 steps/s
Avg test loss: 4.87952, Avg test acc: 0.10685, Avg tpr: 0.68859, Avg fpr: 0.90373, total FA: 125481

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.17189 | acc=0.1248 | tpr=0.6460 | fpr=0.8845 | 4431.5 samples/s | 17.3 steps/s
[Step= 100] | Loss=5.14788 | acc=0.1254 | tpr=0.6098 | fpr=0.8836 | 9060.3 samples/s | 35.4 steps/s
[Step= 150] | Loss=5.16798 | acc=0.1232 | tpr=0.5994 | fpr=0.8856 | 8764.3 samples/s | 34.2 steps/s
[Step= 200] | Loss=5.16442 | acc=0.1220 | tpr=0.5934 | fpr=0.8866 | 8976.6 samples/s | 35.1 steps/s
[Step= 250] | Loss=5.16455 | acc=0.1219 | tpr=0.5948 | fpr=0.8867 | 8812.5 samples/s | 34.4 steps/s
[Step= 300] | Loss=5.16518 | acc=0.1225 | tpr=0.5920 | fpr=0.8860 | 8971.9 samples/s | 35.0 steps/s
[Step= 350] | Loss=5.16132 | acc=0.1227 | tpr=0.5917 | fpr=0.8858 | 9206.6 samples/s | 36.0 steps/s
[Step= 400] | Loss=5.16017 | acc=0.1229 | tpr=0.5979 | fpr=0.8857 | 8293.9 samples/s | 32.4 steps/s
[Step= 450] | Loss=5.16757 | acc=0.1224 | tpr=0.5949 | fpr=0.8862 | 9169.3 samples/s | 35.8 steps/s
[Step= 500] | Loss=5.17226 | acc=0.1224 | tpr=0.5947 | fpr=0.8861 | 8727.3 samples/s | 34.1 steps/s
[Step= 550] | Loss=5.17663 | acc=0.1224 | tpr=0.5969 | fpr=0.8862 | 15051.8 samples/s | 58.8 steps/s
Avg test loss: 5.17832, Avg test acc: 0.12233, Avg tpr: 0.59826, Avg fpr: 0.88632, total FA: 123064

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.14234 | acc=0.9792 | tpr=0.9336 | fpr=0.0200 | 4468.8 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.14604 | acc=0.9789 | tpr=0.9382 | fpr=0.0203 | 8893.5 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.15060 | acc=0.9784 | tpr=0.9452 | fpr=0.0210 | 8767.9 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.15330 | acc=0.9785 | tpr=0.9443 | fpr=0.0209 | 8707.2 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.15081 | acc=0.9787 | tpr=0.9432 | fpr=0.0207 | 8618.4 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.15309 | acc=0.9784 | tpr=0.9411 | fpr=0.0209 | 8921.4 samples/s | 34.8 steps/s
[Step= 350] | Loss=0.15409 | acc=0.9781 | tpr=0.9430 | fpr=0.0212 | 8952.4 samples/s | 35.0 steps/s
[Step= 400] | Loss=0.15519 | acc=0.9780 | tpr=0.9398 | fpr=0.0213 | 8667.7 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.15874 | acc=0.9775 | tpr=0.9357 | fpr=0.0217 | 8930.3 samples/s | 34.9 steps/s
[Step= 500] | Loss=0.15732 | acc=0.9777 | tpr=0.9361 | fpr=0.0216 | 8533.1 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.15663 | acc=0.9777 | tpr=0.9343 | fpr=0.0215 | 15921.0 samples/s | 62.2 steps/s
Avg test loss: 0.15626, Avg test acc: 0.97773, Avg tpr: 0.93463, Avg fpr: 0.02149, total FA: 2984

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11112 | acc=0.9810 | tpr=0.9336 | fpr=0.0181 | 4447.7 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.11645 | acc=0.9800 | tpr=0.9382 | fpr=0.0192 | 9453.9 samples/s | 36.9 steps/s
[Step= 150] | Loss=0.12020 | acc=0.9794 | tpr=0.9438 | fpr=0.0200 | 8132.4 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.12033 | acc=0.9794 | tpr=0.9475 | fpr=0.0200 | 8790.0 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.11875 | acc=0.9795 | tpr=0.9424 | fpr=0.0198 | 9572.8 samples/s | 37.4 steps/s
[Step= 300] | Loss=0.12101 | acc=0.9793 | tpr=0.9404 | fpr=0.0200 | 8319.1 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.12161 | acc=0.9792 | tpr=0.9449 | fpr=0.0202 | 8913.1 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.12245 | acc=0.9789 | tpr=0.9437 | fpr=0.0204 | 8304.9 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.12482 | acc=0.9786 | tpr=0.9416 | fpr=0.0208 | 9437.3 samples/s | 36.9 steps/s
[Step= 500] | Loss=0.12392 | acc=0.9787 | tpr=0.9419 | fpr=0.0206 | 8520.0 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.12302 | acc=0.9787 | tpr=0.9403 | fpr=0.0206 | 15168.3 samples/s | 59.3 steps/s
Avg test loss: 0.12270, Avg test acc: 0.97877, Avg tpr: 0.94057, Avg fpr: 0.02054, total FA: 2852

server round 13/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=14001 Epoch=27.4] | Loss=0.00722 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.647 | L2-Norm(final)=5.529 | 3790.5 samples/s | 59.2 steps/s
[Step=14050 Epoch=27.5] | Loss=0.03998 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.690 | L2-Norm(final)=5.547 | 5608.7 samples/s | 87.6 steps/s
[Step=14100 Epoch=27.6] | Loss=0.03696 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.741 | L2-Norm(final)=5.577 | 5577.4 samples/s | 87.1 steps/s
[Step=14150 Epoch=27.7] | Loss=0.03453 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.788 | L2-Norm(final)=5.600 | 5664.5 samples/s | 88.5 steps/s
[Step=14200 Epoch=27.8] | Loss=0.03471 | Reg=0.00220 | acc=0.9688 | L2-Norm=14.829 | L2-Norm(final)=5.622 | 5625.7 samples/s | 87.9 steps/s
[Step=14250 Epoch=27.9] | Loss=0.03485 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.866 | L2-Norm(final)=5.640 | 5751.5 samples/s | 89.9 steps/s
[Step=14300 Epoch=28.0] | Loss=0.03469 | Reg=0.00222 | acc=0.9375 | L2-Norm=14.901 | L2-Norm(final)=5.655 | 5717.4 samples/s | 89.3 steps/s
[Step=14350 Epoch=28.1] | Loss=0.03396 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.935 | L2-Norm(final)=5.672 | 5624.1 samples/s | 87.9 steps/s
[Step=14400 Epoch=28.2] | Loss=0.03405 | Reg=0.00224 | acc=0.9531 | L2-Norm=14.970 | L2-Norm(final)=5.689 | 5670.4 samples/s | 88.6 steps/s
[Step=14450 Epoch=28.2] | Loss=0.03364 | Reg=0.00225 | acc=0.9844 | L2-Norm=15.004 | L2-Norm(final)=5.705 | 5682.2 samples/s | 88.8 steps/s
[Step=14500 Epoch=28.3] | Loss=0.03311 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.037 | L2-Norm(final)=5.723 | 7132.0 samples/s | 111.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=28.3] | Loss=0.04072 | Reg=0.00236 | acc=0.9531 | L2-Norm=15.365 | L2-Norm(final)=5.901 | 3872.5 samples/s | 60.5 steps/s
[Step=14550 Epoch=28.4] | Loss=0.02750 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.403 | L2-Norm(final)=5.915 | 4947.0 samples/s | 77.3 steps/s
[Step=14600 Epoch=28.5] | Loss=0.03020 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.429 | L2-Norm(final)=5.911 | 4993.2 samples/s | 78.0 steps/s
[Step=14650 Epoch=28.6] | Loss=0.02979 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.452 | L2-Norm(final)=5.903 | 5089.3 samples/s | 79.5 steps/s
[Step=14700 Epoch=28.7] | Loss=0.02943 | Reg=0.00239 | acc=0.9688 | L2-Norm=15.475 | L2-Norm(final)=5.899 | 5078.1 samples/s | 79.3 steps/s
[Step=14750 Epoch=28.8] | Loss=0.02917 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.495 | L2-Norm(final)=5.895 | 5034.7 samples/s | 78.7 steps/s
[Step=14800 Epoch=28.9] | Loss=0.02955 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.512 | L2-Norm(final)=5.892 | 5000.3 samples/s | 78.1 steps/s
[Step=14850 Epoch=29.0] | Loss=0.02971 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.528 | L2-Norm(final)=5.889 | 5016.6 samples/s | 78.4 steps/s
[Step=14900 Epoch=29.1] | Loss=0.02870 | Reg=0.00242 | acc=0.9375 | L2-Norm=15.542 | L2-Norm(final)=5.887 | 5016.4 samples/s | 78.4 steps/s
[Step=14950 Epoch=29.2] | Loss=0.02832 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.555 | L2-Norm(final)=5.885 | 5079.7 samples/s | 79.4 steps/s
[Step=15000 Epoch=29.3] | Loss=0.02799 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.566 | L2-Norm(final)=5.884 | 6240.3 samples/s | 97.5 steps/s
[Step=15050 Epoch=29.4] | Loss=0.02728 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.578 | L2-Norm(final)=5.883 | 1929.8 samples/s | 30.2 steps/s
[Step=15100 Epoch=29.5] | Loss=0.02647 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.590 | L2-Norm(final)=5.884 | 5060.0 samples/s | 79.1 steps/s
[Step=15150 Epoch=29.6] | Loss=0.02574 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.600 | L2-Norm(final)=5.884 | 5029.0 samples/s | 78.6 steps/s
[Step=15200 Epoch=29.7] | Loss=0.02517 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.610 | L2-Norm(final)=5.885 | 5053.1 samples/s | 79.0 steps/s
[Step=15250 Epoch=29.8] | Loss=0.02467 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.620 | L2-Norm(final)=5.886 | 5014.9 samples/s | 78.4 steps/s
[Step=15300 Epoch=29.9] | Loss=0.02420 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.628 | L2-Norm(final)=5.886 | 5104.5 samples/s | 79.8 steps/s
[Step=15350 Epoch=30.0] | Loss=0.02381 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.636 | L2-Norm(final)=5.886 | 5021.7 samples/s | 78.5 steps/s
[Step=15400 Epoch=30.1] | Loss=0.02345 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.644 | L2-Norm(final)=5.887 | 5001.9 samples/s | 78.2 steps/s
[Step=15450 Epoch=30.2] | Loss=0.02299 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.652 | L2-Norm(final)=5.888 | 5051.7 samples/s | 78.9 steps/s
[Step=15500 Epoch=30.3] | Loss=0.02273 | Reg=0.00245 | acc=0.9688 | L2-Norm=15.659 | L2-Norm(final)=5.889 | 5472.3 samples/s | 85.5 steps/s
[Step=15550 Epoch=30.4] | Loss=0.02224 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.667 | L2-Norm(final)=5.890 | 2024.0 samples/s | 31.6 steps/s
[Step=15600 Epoch=30.5] | Loss=0.02180 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.674 | L2-Norm(final)=5.891 | 5132.3 samples/s | 80.2 steps/s
[Step=15650 Epoch=30.6] | Loss=0.02153 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.681 | L2-Norm(final)=5.892 | 5065.0 samples/s | 79.1 steps/s
[Step=15700 Epoch=30.7] | Loss=0.02121 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.687 | L2-Norm(final)=5.893 | 4970.8 samples/s | 77.7 steps/s
[Step=15750 Epoch=30.8] | Loss=0.02107 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.694 | L2-Norm(final)=5.895 | 5023.1 samples/s | 78.5 steps/s
[Step=15800 Epoch=30.9] | Loss=0.02072 | Reg=0.00247 | acc=0.9688 | L2-Norm=15.700 | L2-Norm(final)=5.896 | 5041.4 samples/s | 78.8 steps/s
[Step=15850 Epoch=31.0] | Loss=0.02055 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.707 | L2-Norm(final)=5.898 | 5075.3 samples/s | 79.3 steps/s
[Step=15900 Epoch=31.1] | Loss=0.02031 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.713 | L2-Norm(final)=5.899 | 5068.7 samples/s | 79.2 steps/s
[Step=15950 Epoch=31.2] | Loss=0.02012 | Reg=0.00247 | acc=0.9688 | L2-Norm=15.720 | L2-Norm(final)=5.901 | 5110.4 samples/s | 79.8 steps/s
[Step=16000 Epoch=31.3] | Loss=0.01992 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.726 | L2-Norm(final)=5.903 | 4994.6 samples/s | 78.0 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step16000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=14001 Epoch=53.6] | Loss=0.00052 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.647 | L2-Norm(final)=6.792 | 4008.3 samples/s | 62.6 steps/s
[Step=14050 Epoch=53.8] | Loss=0.00459 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.714 | L2-Norm(final)=6.790 | 4742.6 samples/s | 74.1 steps/s
[Step=14100 Epoch=54.0] | Loss=0.00269 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.729 | L2-Norm(final)=6.807 | 5313.8 samples/s | 83.0 steps/s
[Step=14150 Epoch=54.2] | Loss=0.00207 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.730 | L2-Norm(final)=6.827 | 5219.6 samples/s | 81.6 steps/s
[Step=14200 Epoch=54.4] | Loss=0.00163 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.731 | L2-Norm(final)=6.845 | 5453.1 samples/s | 85.2 steps/s
[Step=14250 Epoch=54.6] | Loss=0.00143 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.726 | L2-Norm(final)=6.860 | 6842.4 samples/s | 106.9 steps/s
[Step=14300 Epoch=54.8] | Loss=0.00124 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.719 | L2-Norm(final)=6.875 | 1942.1 samples/s | 30.3 steps/s
[Step=14350 Epoch=55.0] | Loss=0.00112 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.712 | L2-Norm(final)=6.889 | 5324.9 samples/s | 83.2 steps/s
[Step=14400 Epoch=55.2] | Loss=0.00100 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.704 | L2-Norm(final)=6.902 | 5327.2 samples/s | 83.2 steps/s
[Step=14450 Epoch=55.4] | Loss=0.00094 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.694 | L2-Norm(final)=6.915 | 5379.4 samples/s | 84.1 steps/s
[Step=14500 Epoch=55.6] | Loss=0.00086 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.685 | L2-Norm(final)=6.926 | 6054.4 samples/s | 94.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=55.6] | Loss=0.00011 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.584 | L2-Norm(final)=7.042 | 3663.8 samples/s | 57.2 steps/s
[Step=14550 Epoch=55.8] | Loss=0.00011 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.566 | L2-Norm(final)=7.051 | 4906.0 samples/s | 76.7 steps/s
[Step=14600 Epoch=55.9] | Loss=0.00009 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.543 | L2-Norm(final)=7.057 | 4772.6 samples/s | 74.6 steps/s
[Step=14650 Epoch=56.1] | Loss=0.00008 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.519 | L2-Norm(final)=7.062 | 4844.3 samples/s | 75.7 steps/s
[Step=14700 Epoch=56.3] | Loss=0.00009 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.496 | L2-Norm(final)=7.067 | 4727.5 samples/s | 73.9 steps/s
[Step=14750 Epoch=56.5] | Loss=0.00008 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.473 | L2-Norm(final)=7.072 | 6089.6 samples/s | 95.1 steps/s
[Step=14800 Epoch=56.7] | Loss=0.00007 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.449 | L2-Norm(final)=7.076 | 1865.8 samples/s | 29.2 steps/s
[Step=14850 Epoch=56.9] | Loss=0.00006 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.424 | L2-Norm(final)=7.079 | 4821.4 samples/s | 75.3 steps/s
[Step=14900 Epoch=57.1] | Loss=0.00005 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.398 | L2-Norm(final)=7.082 | 4772.4 samples/s | 74.6 steps/s
[Step=14950 Epoch=57.3] | Loss=0.00005 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.373 | L2-Norm(final)=7.084 | 4828.0 samples/s | 75.4 steps/s
[Step=15000 Epoch=57.5] | Loss=0.00005 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.347 | L2-Norm(final)=7.086 | 5249.5 samples/s | 82.0 steps/s
[Step=15050 Epoch=57.7] | Loss=0.00004 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.320 | L2-Norm(final)=7.088 | 1964.0 samples/s | 30.7 steps/s
[Step=15100 Epoch=57.9] | Loss=0.00004 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.294 | L2-Norm(final)=7.090 | 4755.8 samples/s | 74.3 steps/s
[Step=15150 Epoch=58.0] | Loss=0.00004 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.268 | L2-Norm(final)=7.092 | 4818.3 samples/s | 75.3 steps/s
[Step=15200 Epoch=58.2] | Loss=0.00003 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.242 | L2-Norm(final)=7.093 | 4823.6 samples/s | 75.4 steps/s
[Step=15250 Epoch=58.4] | Loss=0.00003 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.215 | L2-Norm(final)=7.095 | 4780.2 samples/s | 74.7 steps/s
[Step=15300 Epoch=58.6] | Loss=0.00003 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.188 | L2-Norm(final)=7.096 | 2004.9 samples/s | 31.3 steps/s
[Step=15350 Epoch=58.8] | Loss=0.00003 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.162 | L2-Norm(final)=7.097 | 4902.1 samples/s | 76.6 steps/s
[Step=15400 Epoch=59.0] | Loss=0.00003 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.135 | L2-Norm(final)=7.099 | 4647.9 samples/s | 72.6 steps/s
[Step=15450 Epoch=59.2] | Loss=0.00003 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.109 | L2-Norm(final)=7.100 | 4793.5 samples/s | 74.9 steps/s
[Step=15500 Epoch=59.4] | Loss=0.00003 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.082 | L2-Norm(final)=7.101 | 4761.5 samples/s | 74.4 steps/s
[Step=15550 Epoch=59.6] | Loss=0.00003 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.055 | L2-Norm(final)=7.102 | 2043.4 samples/s | 31.9 steps/s
[Step=15600 Epoch=59.8] | Loss=0.00002 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.028 | L2-Norm(final)=7.104 | 4775.4 samples/s | 74.6 steps/s
[Step=15650 Epoch=60.0] | Loss=0.00002 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.001 | L2-Norm(final)=7.105 | 4795.4 samples/s | 74.9 steps/s
[Step=15700 Epoch=60.2] | Loss=0.00002 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.975 | L2-Norm(final)=7.106 | 4759.9 samples/s | 74.4 steps/s
[Step=15750 Epoch=60.3] | Loss=0.00002 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.948 | L2-Norm(final)=7.107 | 4834.3 samples/s | 75.5 steps/s
[Step=15800 Epoch=60.5] | Loss=0.00002 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.921 | L2-Norm(final)=7.108 | 6460.4 samples/s | 100.9 steps/s
[Step=15850 Epoch=60.7] | Loss=0.00002 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.894 | L2-Norm(final)=7.109 | 1826.0 samples/s | 28.5 steps/s
[Step=15900 Epoch=60.9] | Loss=0.00002 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.867 | L2-Norm(final)=7.110 | 4743.5 samples/s | 74.1 steps/s
[Step=15950 Epoch=61.1] | Loss=0.00002 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.840 | L2-Norm(final)=7.111 | 4798.7 samples/s | 75.0 steps/s
[Step=16000 Epoch=61.3] | Loss=0.00002 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.813 | L2-Norm(final)=7.112 | 4820.1 samples/s | 75.3 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05839 | acc=0.9657 | tpr=0.9755 | fpr=0.0555 | 4462.1 samples/s | 17.4 steps/s
Avg test loss: 0.05947, Avg test acc: 0.96494, Avg tpr: 0.97517, Avg fpr: 0.05756, total FA: 449

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06093 | acc=0.9669 | tpr=0.9702 | fpr=0.0404 | 4467.4 samples/s | 17.5 steps/s
Avg test loss: 0.06700, Avg test acc: 0.96434, Avg tpr: 0.96812, Avg fpr: 0.04397, total FA: 343

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.79530 | acc=0.3127 | tpr=0.0439 | fpr=0.1038 | 4516.2 samples/s | 17.6 steps/s
Avg test loss: 4.80133, Avg test acc: 0.31261, Avg tpr: 0.04628, Avg fpr: 0.10165, total FA: 793

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.62303 | acc=0.3043 | tpr=0.0254 | fpr=0.0902 | 4446.6 samples/s | 17.4 steps/s
Avg test loss: 5.61505, Avg test acc: 0.30467, Avg tpr: 0.02745, Avg fpr: 0.08563, total FA: 668

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.89196 | acc=0.1070 | tpr=0.7124 | fpr=0.9038 | 4584.0 samples/s | 17.9 steps/s
[Step= 100] | Loss=4.86698 | acc=0.1058 | tpr=0.6738 | fpr=0.9048 | 8380.3 samples/s | 32.7 steps/s
[Step= 150] | Loss=4.87303 | acc=0.1058 | tpr=0.6844 | fpr=0.9049 | 8857.5 samples/s | 34.6 steps/s
[Step= 200] | Loss=4.87156 | acc=0.1064 | tpr=0.6863 | fpr=0.9041 | 8613.0 samples/s | 33.6 steps/s
[Step= 250] | Loss=4.87195 | acc=0.1068 | tpr=0.6865 | fpr=0.9038 | 8827.5 samples/s | 34.5 steps/s
[Step= 300] | Loss=4.87013 | acc=0.1068 | tpr=0.6909 | fpr=0.9038 | 8800.2 samples/s | 34.4 steps/s
[Step= 350] | Loss=4.86863 | acc=0.1064 | tpr=0.6863 | fpr=0.9041 | 9044.1 samples/s | 35.3 steps/s
[Step= 400] | Loss=4.86606 | acc=0.1069 | tpr=0.6898 | fpr=0.9037 | 8737.1 samples/s | 34.1 steps/s
[Step= 450] | Loss=4.87222 | acc=0.1066 | tpr=0.6835 | fpr=0.9039 | 8724.0 samples/s | 34.1 steps/s
[Step= 500] | Loss=4.87547 | acc=0.1068 | tpr=0.6872 | fpr=0.9037 | 8747.2 samples/s | 34.2 steps/s
[Step= 550] | Loss=4.87842 | acc=0.1069 | tpr=0.6876 | fpr=0.9036 | 16084.9 samples/s | 62.8 steps/s
Avg test loss: 4.87952, Avg test acc: 0.10685, Avg tpr: 0.68859, Avg fpr: 0.90373, total FA: 125481

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.68244 | acc=0.1352 | tpr=0.5442 | fpr=0.8722 | 4459.1 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.65529 | acc=0.1356 | tpr=0.5522 | fpr=0.8722 | 8919.0 samples/s | 34.8 steps/s
[Step= 150] | Loss=5.67567 | acc=0.1337 | tpr=0.5303 | fpr=0.8736 | 8880.2 samples/s | 34.7 steps/s
[Step= 200] | Loss=5.66964 | acc=0.1334 | tpr=0.5191 | fpr=0.8736 | 8597.8 samples/s | 33.6 steps/s
[Step= 250] | Loss=5.67131 | acc=0.1334 | tpr=0.5170 | fpr=0.8736 | 8764.5 samples/s | 34.2 steps/s
[Step= 300] | Loss=5.66801 | acc=0.1334 | tpr=0.5207 | fpr=0.8737 | 9424.3 samples/s | 36.8 steps/s
[Step= 350] | Loss=5.66304 | acc=0.1332 | tpr=0.5166 | fpr=0.8738 | 8283.2 samples/s | 32.4 steps/s
[Step= 400] | Loss=5.66339 | acc=0.1334 | tpr=0.5191 | fpr=0.8736 | 9024.4 samples/s | 35.3 steps/s
[Step= 450] | Loss=5.67411 | acc=0.1332 | tpr=0.5161 | fpr=0.8738 | 8826.0 samples/s | 34.5 steps/s
[Step= 500] | Loss=5.67993 | acc=0.1330 | tpr=0.5145 | fpr=0.8739 | 8580.9 samples/s | 33.5 steps/s
[Step= 550] | Loss=5.68491 | acc=0.1330 | tpr=0.5165 | fpr=0.8740 | 15962.9 samples/s | 62.4 steps/s
Avg test loss: 5.68638, Avg test acc: 0.13285, Avg tpr: 0.51823, Avg fpr: 0.87416, total FA: 121375

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13059 | acc=0.9809 | tpr=0.9381 | fpr=0.0183 | 4435.5 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.13775 | acc=0.9804 | tpr=0.9488 | fpr=0.0191 | 8858.9 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.14310 | acc=0.9791 | tpr=0.9496 | fpr=0.0204 | 8671.4 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.14394 | acc=0.9792 | tpr=0.9541 | fpr=0.0203 | 8756.6 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.14217 | acc=0.9793 | tpr=0.9511 | fpr=0.0202 | 8896.8 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.14475 | acc=0.9791 | tpr=0.9484 | fpr=0.0203 | 8825.3 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.14576 | acc=0.9789 | tpr=0.9487 | fpr=0.0206 | 8784.0 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.14636 | acc=0.9788 | tpr=0.9464 | fpr=0.0207 | 8869.7 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.14929 | acc=0.9784 | tpr=0.9445 | fpr=0.0210 | 8734.4 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.14836 | acc=0.9785 | tpr=0.9441 | fpr=0.0209 | 8560.7 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.14754 | acc=0.9784 | tpr=0.9407 | fpr=0.0209 | 16268.5 samples/s | 63.5 steps/s
Avg test loss: 0.14715, Avg test acc: 0.97845, Avg tpr: 0.94097, Avg fpr: 0.02087, total FA: 2898

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11112 | acc=0.9810 | tpr=0.9336 | fpr=0.0181 | 4493.6 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.11645 | acc=0.9800 | tpr=0.9382 | fpr=0.0192 | 8581.9 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.12020 | acc=0.9794 | tpr=0.9438 | fpr=0.0200 | 8845.1 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.12033 | acc=0.9794 | tpr=0.9475 | fpr=0.0200 | 9026.9 samples/s | 35.3 steps/s
[Step= 250] | Loss=0.11875 | acc=0.9795 | tpr=0.9424 | fpr=0.0198 | 9340.7 samples/s | 36.5 steps/s
[Step= 300] | Loss=0.12101 | acc=0.9793 | tpr=0.9404 | fpr=0.0200 | 8247.4 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.12161 | acc=0.9792 | tpr=0.9449 | fpr=0.0202 | 8920.3 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.12245 | acc=0.9789 | tpr=0.9437 | fpr=0.0204 | 8840.6 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.12482 | acc=0.9786 | tpr=0.9416 | fpr=0.0208 | 8873.9 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.12392 | acc=0.9787 | tpr=0.9419 | fpr=0.0206 | 8556.7 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.12302 | acc=0.9787 | tpr=0.9403 | fpr=0.0206 | 15747.4 samples/s | 61.5 steps/s
Avg test loss: 0.12270, Avg test acc: 0.97877, Avg tpr: 0.94057, Avg fpr: 0.02054, total FA: 2852

server round 14/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=10001 Epoch=19.5] | Loss=0.03902 | Reg=0.00204 | acc=0.9531 | L2-Norm=14.271 | L2-Norm(final)=4.781 | 3539.7 samples/s | 55.3 steps/s
[Step=10050 Epoch=19.6] | Loss=0.02752 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.315 | L2-Norm(final)=4.805 | 5734.2 samples/s | 89.6 steps/s
[Step=10100 Epoch=19.7] | Loss=0.02808 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.366 | L2-Norm(final)=4.830 | 5656.3 samples/s | 88.4 steps/s
[Step=10150 Epoch=19.8] | Loss=0.02666 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.412 | L2-Norm(final)=4.855 | 5662.4 samples/s | 88.5 steps/s
[Step=10200 Epoch=19.9] | Loss=0.02601 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.452 | L2-Norm(final)=4.878 | 5702.6 samples/s | 89.1 steps/s
[Step=10250 Epoch=20.0] | Loss=0.02609 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.491 | L2-Norm(final)=4.899 | 5586.8 samples/s | 87.3 steps/s
[Step=10300 Epoch=20.1] | Loss=0.02609 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.526 | L2-Norm(final)=4.915 | 5668.4 samples/s | 88.6 steps/s
[Step=10350 Epoch=20.2] | Loss=0.02594 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.557 | L2-Norm(final)=4.931 | 5695.5 samples/s | 89.0 steps/s
[Step=10400 Epoch=20.3] | Loss=0.02520 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.586 | L2-Norm(final)=4.948 | 5652.0 samples/s | 88.3 steps/s
[Step=10450 Epoch=20.4] | Loss=0.02495 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.615 | L2-Norm(final)=4.965 | 5656.5 samples/s | 88.4 steps/s
[Step=10500 Epoch=20.5] | Loss=0.02464 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.644 | L2-Norm(final)=4.983 | 7106.8 samples/s | 111.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=20.5] | Loss=0.00785 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.924 | L2-Norm(final)=5.147 | 3533.7 samples/s | 55.2 steps/s
[Step=10550 Epoch=20.6] | Loss=0.02374 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.954 | L2-Norm(final)=5.153 | 5027.4 samples/s | 78.6 steps/s
[Step=10600 Epoch=20.7] | Loss=0.02759 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.979 | L2-Norm(final)=5.154 | 5076.8 samples/s | 79.3 steps/s
[Step=10650 Epoch=20.8] | Loss=0.02588 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.004 | L2-Norm(final)=5.151 | 4992.4 samples/s | 78.0 steps/s
[Step=10700 Epoch=20.9] | Loss=0.02802 | Reg=0.00226 | acc=0.9375 | L2-Norm=15.025 | L2-Norm(final)=5.150 | 5035.2 samples/s | 78.7 steps/s
[Step=10750 Epoch=21.0] | Loss=0.02763 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.044 | L2-Norm(final)=5.149 | 5036.1 samples/s | 78.7 steps/s
[Step=10800 Epoch=21.1] | Loss=0.02756 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.064 | L2-Norm(final)=5.148 | 5042.4 samples/s | 78.8 steps/s
[Step=10850 Epoch=21.2] | Loss=0.02737 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.083 | L2-Norm(final)=5.148 | 5060.6 samples/s | 79.1 steps/s
[Step=10900 Epoch=21.3] | Loss=0.02744 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.101 | L2-Norm(final)=5.147 | 5035.6 samples/s | 78.7 steps/s
[Step=10950 Epoch=21.4] | Loss=0.02687 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.118 | L2-Norm(final)=5.147 | 5008.8 samples/s | 78.3 steps/s
[Step=11000 Epoch=21.5] | Loss=0.02649 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.134 | L2-Norm(final)=5.147 | 6188.8 samples/s | 96.7 steps/s
[Step=11050 Epoch=21.6] | Loss=0.02599 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.150 | L2-Norm(final)=5.147 | 1868.4 samples/s | 29.2 steps/s
[Step=11100 Epoch=21.6] | Loss=0.02509 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.164 | L2-Norm(final)=5.147 | 5020.9 samples/s | 78.5 steps/s
[Step=11150 Epoch=21.7] | Loss=0.02440 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.177 | L2-Norm(final)=5.148 | 5018.3 samples/s | 78.4 steps/s
[Step=11200 Epoch=21.8] | Loss=0.02379 | Reg=0.00231 | acc=0.9688 | L2-Norm=15.189 | L2-Norm(final)=5.149 | 5009.2 samples/s | 78.3 steps/s
[Step=11250 Epoch=21.9] | Loss=0.02341 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.200 | L2-Norm(final)=5.151 | 5034.4 samples/s | 78.7 steps/s
[Step=11300 Epoch=22.0] | Loss=0.02357 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.212 | L2-Norm(final)=5.151 | 5027.2 samples/s | 78.5 steps/s
[Step=11350 Epoch=22.1] | Loss=0.02320 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.223 | L2-Norm(final)=5.152 | 5046.7 samples/s | 78.9 steps/s
[Step=11400 Epoch=22.2] | Loss=0.02285 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.234 | L2-Norm(final)=5.153 | 5064.4 samples/s | 79.1 steps/s
[Step=11450 Epoch=22.3] | Loss=0.02230 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.244 | L2-Norm(final)=5.154 | 5073.4 samples/s | 79.3 steps/s
[Step=11500 Epoch=22.4] | Loss=0.02220 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.254 | L2-Norm(final)=5.155 | 5315.3 samples/s | 83.1 steps/s
[Step=11550 Epoch=22.5] | Loss=0.02179 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.264 | L2-Norm(final)=5.156 | 1927.6 samples/s | 30.1 steps/s
[Step=11600 Epoch=22.6] | Loss=0.02136 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.273 | L2-Norm(final)=5.158 | 5065.5 samples/s | 79.1 steps/s
[Step=11650 Epoch=22.7] | Loss=0.02106 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.283 | L2-Norm(final)=5.160 | 5026.5 samples/s | 78.5 steps/s
[Step=11700 Epoch=22.8] | Loss=0.02071 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.292 | L2-Norm(final)=5.162 | 5056.8 samples/s | 79.0 steps/s
[Step=11750 Epoch=22.9] | Loss=0.02054 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.301 | L2-Norm(final)=5.164 | 5009.2 samples/s | 78.3 steps/s
[Step=11800 Epoch=23.0] | Loss=0.02034 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.310 | L2-Norm(final)=5.166 | 4961.9 samples/s | 77.5 steps/s
[Step=11850 Epoch=23.1] | Loss=0.02014 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.319 | L2-Norm(final)=5.168 | 5065.8 samples/s | 79.2 steps/s
[Step=11900 Epoch=23.2] | Loss=0.01987 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.327 | L2-Norm(final)=5.169 | 5083.5 samples/s | 79.4 steps/s
[Step=11950 Epoch=23.3] | Loss=0.01965 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.336 | L2-Norm(final)=5.171 | 5039.6 samples/s | 78.7 steps/s
[Step=12000 Epoch=23.4] | Loss=0.01945 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.344 | L2-Norm(final)=5.173 | 5033.0 samples/s | 78.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step12000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=14001 Epoch=53.9] | Loss=0.00232 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.271 | L2-Norm(final)=6.089 | 3933.4 samples/s | 61.5 steps/s
[Step=14050 Epoch=54.1] | Loss=0.00362 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.341 | L2-Norm(final)=6.096 | 4865.3 samples/s | 76.0 steps/s
[Step=14100 Epoch=54.3] | Loss=0.00293 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.433 | L2-Norm(final)=6.102 | 5349.3 samples/s | 83.6 steps/s
[Step=14150 Epoch=54.5] | Loss=0.00225 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.487 | L2-Norm(final)=6.107 | 5381.7 samples/s | 84.1 steps/s
[Step=14200 Epoch=54.7] | Loss=0.00180 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.512 | L2-Norm(final)=6.114 | 5369.5 samples/s | 83.9 steps/s
[Step=14250 Epoch=54.9] | Loss=0.00160 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.523 | L2-Norm(final)=6.122 | 7008.6 samples/s | 109.5 steps/s
[Step=14300 Epoch=55.0] | Loss=0.00137 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.528 | L2-Norm(final)=6.131 | 1949.9 samples/s | 30.5 steps/s
[Step=14350 Epoch=55.2] | Loss=0.00119 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.527 | L2-Norm(final)=6.139 | 5200.9 samples/s | 81.3 steps/s
[Step=14400 Epoch=55.4] | Loss=0.00106 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.522 | L2-Norm(final)=6.146 | 5341.4 samples/s | 83.5 steps/s
[Step=14450 Epoch=55.6] | Loss=0.00096 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.515 | L2-Norm(final)=6.153 | 5356.4 samples/s | 83.7 steps/s
[Step=14500 Epoch=55.8] | Loss=0.00087 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.507 | L2-Norm(final)=6.160 | 6129.5 samples/s | 95.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=55.8] | Loss=0.00001 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.414 | L2-Norm(final)=6.228 | 3824.9 samples/s | 59.8 steps/s
[Step=14550 Epoch=56.0] | Loss=0.00006 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.394 | L2-Norm(final)=6.233 | 4525.8 samples/s | 70.7 steps/s
[Step=14600 Epoch=56.2] | Loss=0.00008 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.370 | L2-Norm(final)=6.237 | 4835.4 samples/s | 75.6 steps/s
[Step=14650 Epoch=56.4] | Loss=0.00007 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.346 | L2-Norm(final)=6.241 | 4791.9 samples/s | 74.9 steps/s
[Step=14700 Epoch=56.6] | Loss=0.00006 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.322 | L2-Norm(final)=6.244 | 4749.5 samples/s | 74.2 steps/s
[Step=14750 Epoch=56.8] | Loss=0.00005 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.297 | L2-Norm(final)=6.247 | 6166.9 samples/s | 96.4 steps/s
[Step=14800 Epoch=57.0] | Loss=0.00004 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.271 | L2-Norm(final)=6.249 | 1864.5 samples/s | 29.1 steps/s
[Step=14850 Epoch=57.2] | Loss=0.00004 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.246 | L2-Norm(final)=6.250 | 4888.1 samples/s | 76.4 steps/s
[Step=14900 Epoch=57.4] | Loss=0.00003 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.220 | L2-Norm(final)=6.252 | 4721.6 samples/s | 73.8 steps/s
[Step=14950 Epoch=57.5] | Loss=0.00003 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.194 | L2-Norm(final)=6.253 | 4791.9 samples/s | 74.9 steps/s
[Step=15000 Epoch=57.7] | Loss=0.00003 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.167 | L2-Norm(final)=6.254 | 5444.9 samples/s | 85.1 steps/s
[Step=15050 Epoch=57.9] | Loss=0.00003 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.141 | L2-Norm(final)=6.255 | 1933.1 samples/s | 30.2 steps/s
[Step=15100 Epoch=58.1] | Loss=0.00002 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.115 | L2-Norm(final)=6.256 | 4875.3 samples/s | 76.2 steps/s
[Step=15150 Epoch=58.3] | Loss=0.00002 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.089 | L2-Norm(final)=6.257 | 4736.1 samples/s | 74.0 steps/s
[Step=15200 Epoch=58.5] | Loss=0.00002 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.062 | L2-Norm(final)=6.258 | 4765.0 samples/s | 74.5 steps/s
[Step=15250 Epoch=58.7] | Loss=0.00002 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.036 | L2-Norm(final)=6.259 | 4859.0 samples/s | 75.9 steps/s
[Step=15300 Epoch=58.9] | Loss=0.00002 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.009 | L2-Norm(final)=6.259 | 2014.9 samples/s | 31.5 steps/s
[Step=15350 Epoch=59.1] | Loss=0.00002 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.983 | L2-Norm(final)=6.260 | 4918.1 samples/s | 76.8 steps/s
[Step=15400 Epoch=59.3] | Loss=0.00002 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.956 | L2-Norm(final)=6.261 | 4805.2 samples/s | 75.1 steps/s
[Step=15450 Epoch=59.5] | Loss=0.00002 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.929 | L2-Norm(final)=6.262 | 4725.0 samples/s | 73.8 steps/s
[Step=15500 Epoch=59.7] | Loss=0.00002 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.903 | L2-Norm(final)=6.262 | 4853.1 samples/s | 75.8 steps/s
[Step=15550 Epoch=59.9] | Loss=0.00002 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.876 | L2-Norm(final)=6.263 | 2037.1 samples/s | 31.8 steps/s
[Step=15600 Epoch=60.1] | Loss=0.00002 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.849 | L2-Norm(final)=6.264 | 4720.9 samples/s | 73.8 steps/s
[Step=15650 Epoch=60.2] | Loss=0.00001 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.822 | L2-Norm(final)=6.264 | 4780.1 samples/s | 74.7 steps/s
[Step=15700 Epoch=60.4] | Loss=0.00001 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.795 | L2-Norm(final)=6.265 | 4786.8 samples/s | 74.8 steps/s
[Step=15750 Epoch=60.6] | Loss=0.00001 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.769 | L2-Norm(final)=6.266 | 4782.9 samples/s | 74.7 steps/s
[Step=15800 Epoch=60.8] | Loss=0.00001 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.742 | L2-Norm(final)=6.266 | 7040.0 samples/s | 110.0 steps/s
[Step=15850 Epoch=61.0] | Loss=0.00001 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.715 | L2-Norm(final)=6.267 | 1786.1 samples/s | 27.9 steps/s
[Step=15900 Epoch=61.2] | Loss=0.00001 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.687 | L2-Norm(final)=6.268 | 4828.9 samples/s | 75.5 steps/s
[Step=15950 Epoch=61.4] | Loss=0.00001 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.660 | L2-Norm(final)=6.268 | 4837.9 samples/s | 75.6 steps/s
[Step=16000 Epoch=61.6] | Loss=0.00001 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.633 | L2-Norm(final)=6.269 | 4750.7 samples/s | 74.2 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06294 | acc=0.9659 | tpr=0.9730 | fpr=0.0493 | 4365.0 samples/s | 17.1 steps/s
Avg test loss: 0.06535, Avg test acc: 0.96510, Avg tpr: 0.97237, Avg fpr: 0.05089, total FA: 397

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06093 | acc=0.9669 | tpr=0.9702 | fpr=0.0404 | 4532.4 samples/s | 17.7 steps/s
Avg test loss: 0.06700, Avg test acc: 0.96434, Avg tpr: 0.96812, Avg fpr: 0.04397, total FA: 343

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.79530 | acc=0.3127 | tpr=0.0439 | fpr=0.1038 | 4453.7 samples/s | 17.4 steps/s
Avg test loss: 4.80133, Avg test acc: 0.31261, Avg tpr: 0.04628, Avg fpr: 0.10165, total FA: 793

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.59867 | acc=0.3074 | tpr=0.0469 | fpr=0.1269 | 4518.1 samples/s | 17.6 steps/s
Avg test loss: 5.59561, Avg test acc: 0.30800, Avg tpr: 0.04867, Avg fpr: 0.12165, total FA: 949

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.60632 | acc=0.0881 | tpr=0.6858 | fpr=0.9226 | 4462.3 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.58504 | acc=0.0891 | tpr=0.6461 | fpr=0.9213 | 9446.5 samples/s | 36.9 steps/s
[Step= 150] | Loss=5.59306 | acc=0.0887 | tpr=0.6427 | fpr=0.9215 | 8314.6 samples/s | 32.5 steps/s
[Step= 200] | Loss=5.58921 | acc=0.0887 | tpr=0.6426 | fpr=0.9214 | 9203.8 samples/s | 36.0 steps/s
[Step= 250] | Loss=5.58555 | acc=0.0889 | tpr=0.6472 | fpr=0.9213 | 9200.2 samples/s | 35.9 steps/s
[Step= 300] | Loss=5.58057 | acc=0.0898 | tpr=0.6545 | fpr=0.9205 | 8248.2 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.58067 | acc=0.0896 | tpr=0.6506 | fpr=0.9206 | 8806.8 samples/s | 34.4 steps/s
[Step= 400] | Loss=5.57898 | acc=0.0899 | tpr=0.6493 | fpr=0.9203 | 8429.2 samples/s | 32.9 steps/s
[Step= 450] | Loss=5.58521 | acc=0.0900 | tpr=0.6436 | fpr=0.9201 | 8856.6 samples/s | 34.6 steps/s
[Step= 500] | Loss=5.58879 | acc=0.0898 | tpr=0.6471 | fpr=0.9203 | 8982.9 samples/s | 35.1 steps/s
[Step= 550] | Loss=5.59112 | acc=0.0900 | tpr=0.6518 | fpr=0.9202 | 15398.2 samples/s | 60.1 steps/s
Avg test loss: 5.59196, Avg test acc: 0.08996, Avg tpr: 0.65254, Avg fpr: 0.92027, total FA: 127777

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.68244 | acc=0.1352 | tpr=0.5442 | fpr=0.8722 | 4549.4 samples/s | 17.8 steps/s
[Step= 100] | Loss=5.65529 | acc=0.1356 | tpr=0.5522 | fpr=0.8722 | 8379.5 samples/s | 32.7 steps/s
[Step= 150] | Loss=5.67567 | acc=0.1337 | tpr=0.5303 | fpr=0.8736 | 8679.6 samples/s | 33.9 steps/s
[Step= 200] | Loss=5.66964 | acc=0.1334 | tpr=0.5191 | fpr=0.8736 | 9020.6 samples/s | 35.2 steps/s
[Step= 250] | Loss=5.67131 | acc=0.1334 | tpr=0.5170 | fpr=0.8736 | 8745.5 samples/s | 34.2 steps/s
[Step= 300] | Loss=5.66801 | acc=0.1334 | tpr=0.5207 | fpr=0.8737 | 8770.8 samples/s | 34.3 steps/s
[Step= 350] | Loss=5.66304 | acc=0.1332 | tpr=0.5166 | fpr=0.8738 | 9016.9 samples/s | 35.2 steps/s
[Step= 400] | Loss=5.66339 | acc=0.1334 | tpr=0.5191 | fpr=0.8736 | 8775.7 samples/s | 34.3 steps/s
[Step= 450] | Loss=5.67411 | acc=0.1332 | tpr=0.5161 | fpr=0.8738 | 8727.9 samples/s | 34.1 steps/s
[Step= 500] | Loss=5.67993 | acc=0.1330 | tpr=0.5145 | fpr=0.8739 | 8659.2 samples/s | 33.8 steps/s
[Step= 550] | Loss=5.68491 | acc=0.1330 | tpr=0.5165 | fpr=0.8740 | 15879.6 samples/s | 62.0 steps/s
Avg test loss: 5.68638, Avg test acc: 0.13285, Avg tpr: 0.51823, Avg fpr: 0.87416, total FA: 121375

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13059 | acc=0.9809 | tpr=0.9381 | fpr=0.0183 | 4471.4 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.13775 | acc=0.9804 | tpr=0.9488 | fpr=0.0191 | 8658.9 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.14310 | acc=0.9791 | tpr=0.9496 | fpr=0.0204 | 9084.4 samples/s | 35.5 steps/s
[Step= 200] | Loss=0.14394 | acc=0.9792 | tpr=0.9541 | fpr=0.0203 | 8847.7 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.14217 | acc=0.9793 | tpr=0.9511 | fpr=0.0202 | 8374.9 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.14475 | acc=0.9791 | tpr=0.9484 | fpr=0.0203 | 8964.9 samples/s | 35.0 steps/s
[Step= 350] | Loss=0.14576 | acc=0.9789 | tpr=0.9487 | fpr=0.0206 | 8509.4 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.14636 | acc=0.9788 | tpr=0.9464 | fpr=0.0207 | 8865.3 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.14929 | acc=0.9784 | tpr=0.9445 | fpr=0.0210 | 8702.5 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.14836 | acc=0.9785 | tpr=0.9441 | fpr=0.0209 | 8824.9 samples/s | 34.5 steps/s
[Step= 550] | Loss=0.14754 | acc=0.9784 | tpr=0.9407 | fpr=0.0209 | 15822.1 samples/s | 61.8 steps/s
Avg test loss: 0.14715, Avg test acc: 0.97845, Avg tpr: 0.94097, Avg fpr: 0.02087, total FA: 2898

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12206 | acc=0.9802 | tpr=0.9071 | fpr=0.0185 | 4450.8 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.13140 | acc=0.9789 | tpr=0.9254 | fpr=0.0201 | 8813.2 samples/s | 34.4 steps/s
[Step= 150] | Loss=0.13614 | acc=0.9777 | tpr=0.9337 | fpr=0.0215 | 8901.5 samples/s | 34.8 steps/s
[Step= 200] | Loss=0.13550 | acc=0.9781 | tpr=0.9421 | fpr=0.0212 | 9064.2 samples/s | 35.4 steps/s
[Step= 250] | Loss=0.13323 | acc=0.9785 | tpr=0.9424 | fpr=0.0208 | 8437.8 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.13554 | acc=0.9784 | tpr=0.9404 | fpr=0.0209 | 8831.8 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.13633 | acc=0.9784 | tpr=0.9418 | fpr=0.0210 | 9235.9 samples/s | 36.1 steps/s
[Step= 400] | Loss=0.13689 | acc=0.9783 | tpr=0.9409 | fpr=0.0210 | 8382.7 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.13939 | acc=0.9780 | tpr=0.9382 | fpr=0.0213 | 8824.1 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.13878 | acc=0.9780 | tpr=0.9379 | fpr=0.0213 | 8874.6 samples/s | 34.7 steps/s
[Step= 550] | Loss=0.13785 | acc=0.9780 | tpr=0.9367 | fpr=0.0212 | 15860.7 samples/s | 62.0 steps/s
Avg test loss: 0.13742, Avg test acc: 0.97807, Avg tpr: 0.93700, Avg fpr: 0.02118, total FA: 2941

server round 15/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=16001 Epoch=31.3] | Loss=0.05755 | Reg=0.00193 | acc=0.9531 | L2-Norm=13.895 | L2-Norm(final)=5.958 | 4015.8 samples/s | 62.7 steps/s
[Step=16050 Epoch=31.4] | Loss=0.02159 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.928 | L2-Norm(final)=5.959 | 5141.5 samples/s | 80.3 steps/s
[Step=16100 Epoch=31.5] | Loss=0.02015 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.964 | L2-Norm(final)=5.967 | 5680.6 samples/s | 88.8 steps/s
[Step=16150 Epoch=31.6] | Loss=0.01872 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.991 | L2-Norm(final)=5.974 | 5636.1 samples/s | 88.1 steps/s
[Step=16200 Epoch=31.7] | Loss=0.01836 | Reg=0.00196 | acc=0.9688 | L2-Norm=14.017 | L2-Norm(final)=5.985 | 5757.3 samples/s | 90.0 steps/s
[Step=16250 Epoch=31.8] | Loss=0.01813 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.043 | L2-Norm(final)=5.996 | 5631.5 samples/s | 88.0 steps/s
[Step=16300 Epoch=31.9] | Loss=0.01770 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.067 | L2-Norm(final)=6.007 | 5699.3 samples/s | 89.1 steps/s
[Step=16350 Epoch=32.0] | Loss=0.01767 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.091 | L2-Norm(final)=6.017 | 5650.1 samples/s | 88.3 steps/s
[Step=16400 Epoch=32.1] | Loss=0.01730 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.115 | L2-Norm(final)=6.027 | 5690.5 samples/s | 88.9 steps/s
[Step=16450 Epoch=32.2] | Loss=0.01742 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.138 | L2-Norm(final)=6.036 | 5628.6 samples/s | 87.9 steps/s
[Step=16500 Epoch=32.3] | Loss=0.01738 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.159 | L2-Norm(final)=6.044 | 7138.0 samples/s | 111.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=32.3] | Loss=0.03247 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.367 | L2-Norm(final)=6.130 | 3989.3 samples/s | 62.3 steps/s
[Step=16550 Epoch=32.4] | Loss=0.01404 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.389 | L2-Norm(final)=6.141 | 4427.0 samples/s | 69.2 steps/s
[Step=16600 Epoch=32.5] | Loss=0.01998 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.412 | L2-Norm(final)=6.139 | 5004.8 samples/s | 78.2 steps/s
[Step=16650 Epoch=32.6] | Loss=0.02219 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.440 | L2-Norm(final)=6.132 | 4955.8 samples/s | 77.4 steps/s
[Step=16700 Epoch=32.6] | Loss=0.02378 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.468 | L2-Norm(final)=6.126 | 5014.5 samples/s | 78.4 steps/s
[Step=16750 Epoch=32.7] | Loss=0.02365 | Reg=0.00210 | acc=0.9531 | L2-Norm=14.496 | L2-Norm(final)=6.124 | 4996.8 samples/s | 78.1 steps/s
[Step=16800 Epoch=32.8] | Loss=0.02330 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.522 | L2-Norm(final)=6.124 | 4793.1 samples/s | 74.9 steps/s
[Step=16850 Epoch=32.9] | Loss=0.02324 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.546 | L2-Norm(final)=6.124 | 4996.8 samples/s | 78.1 steps/s
[Step=16900 Epoch=33.0] | Loss=0.02369 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.567 | L2-Norm(final)=6.124 | 5066.9 samples/s | 79.2 steps/s
[Step=16950 Epoch=33.1] | Loss=0.02355 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.587 | L2-Norm(final)=6.123 | 4895.5 samples/s | 76.5 steps/s
[Step=17000 Epoch=33.2] | Loss=0.02354 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.605 | L2-Norm(final)=6.122 | 6224.6 samples/s | 97.3 steps/s
[Step=17050 Epoch=33.3] | Loss=0.02325 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.622 | L2-Norm(final)=6.123 | 1915.2 samples/s | 29.9 steps/s
[Step=17100 Epoch=33.4] | Loss=0.02263 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.638 | L2-Norm(final)=6.123 | 5102.3 samples/s | 79.7 steps/s
[Step=17150 Epoch=33.5] | Loss=0.02225 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.654 | L2-Norm(final)=6.124 | 5051.0 samples/s | 78.9 steps/s
[Step=17200 Epoch=33.6] | Loss=0.02189 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.668 | L2-Norm(final)=6.125 | 5032.7 samples/s | 78.6 steps/s
[Step=17250 Epoch=33.7] | Loss=0.02155 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.681 | L2-Norm(final)=6.126 | 4978.9 samples/s | 77.8 steps/s
[Step=17300 Epoch=33.8] | Loss=0.02157 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.695 | L2-Norm(final)=6.127 | 5099.6 samples/s | 79.7 steps/s
[Step=17350 Epoch=33.9] | Loss=0.02108 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.707 | L2-Norm(final)=6.128 | 4999.1 samples/s | 78.1 steps/s
[Step=17400 Epoch=34.0] | Loss=0.02105 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.720 | L2-Norm(final)=6.129 | 5009.7 samples/s | 78.3 steps/s
[Step=17450 Epoch=34.1] | Loss=0.02072 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.732 | L2-Norm(final)=6.130 | 5059.8 samples/s | 79.1 steps/s
[Step=17500 Epoch=34.2] | Loss=0.02042 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.744 | L2-Norm(final)=6.131 | 5489.6 samples/s | 85.8 steps/s
[Step=17550 Epoch=34.3] | Loss=0.02002 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.756 | L2-Norm(final)=6.133 | 2030.4 samples/s | 31.7 steps/s
[Step=17600 Epoch=34.4] | Loss=0.01972 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.767 | L2-Norm(final)=6.135 | 4961.3 samples/s | 77.5 steps/s
[Step=17650 Epoch=34.5] | Loss=0.01957 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.778 | L2-Norm(final)=6.137 | 5010.3 samples/s | 78.3 steps/s
[Step=17700 Epoch=34.6] | Loss=0.01929 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.788 | L2-Norm(final)=6.138 | 5037.1 samples/s | 78.7 steps/s
[Step=17750 Epoch=34.7] | Loss=0.01909 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.799 | L2-Norm(final)=6.140 | 5038.7 samples/s | 78.7 steps/s
[Step=17800 Epoch=34.8] | Loss=0.01892 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.809 | L2-Norm(final)=6.142 | 5096.1 samples/s | 79.6 steps/s
[Step=17850 Epoch=34.9] | Loss=0.01873 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.819 | L2-Norm(final)=6.144 | 5003.6 samples/s | 78.2 steps/s
[Step=17900 Epoch=35.0] | Loss=0.01864 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.830 | L2-Norm(final)=6.145 | 5091.6 samples/s | 79.6 steps/s
[Step=17950 Epoch=35.1] | Loss=0.01848 | Reg=0.00220 | acc=0.9688 | L2-Norm=14.840 | L2-Norm(final)=6.147 | 5049.4 samples/s | 78.9 steps/s
[Step=18000 Epoch=35.2] | Loss=0.01840 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.851 | L2-Norm(final)=6.149 | 5052.8 samples/s | 78.9 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step18000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=16001 Epoch=61.3] | Loss=0.01040 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.895 | L2-Norm(final)=7.142 | 3789.4 samples/s | 59.2 steps/s
[Step=16050 Epoch=61.5] | Loss=0.00551 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.060 | L2-Norm(final)=7.143 | 5283.7 samples/s | 82.6 steps/s
[Step=16100 Epoch=61.7] | Loss=0.00408 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.212 | L2-Norm(final)=7.154 | 5268.1 samples/s | 82.3 steps/s
[Step=16150 Epoch=61.9] | Loss=0.00338 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.288 | L2-Norm(final)=7.168 | 5339.1 samples/s | 83.4 steps/s
[Step=16200 Epoch=62.1] | Loss=0.00311 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.337 | L2-Norm(final)=7.182 | 5309.0 samples/s | 83.0 steps/s
[Step=16250 Epoch=62.3] | Loss=0.00282 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.376 | L2-Norm(final)=7.194 | 6995.2 samples/s | 109.3 steps/s
[Step=16300 Epoch=62.5] | Loss=0.00241 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.407 | L2-Norm(final)=7.206 | 1909.9 samples/s | 29.8 steps/s
[Step=16350 Epoch=62.6] | Loss=0.00212 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.426 | L2-Norm(final)=7.217 | 5392.4 samples/s | 84.3 steps/s
[Step=16400 Epoch=62.8] | Loss=0.00189 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.439 | L2-Norm(final)=7.227 | 5257.5 samples/s | 82.1 steps/s
[Step=16450 Epoch=63.0] | Loss=0.00170 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.446 | L2-Norm(final)=7.236 | 5454.0 samples/s | 85.2 steps/s
[Step=16500 Epoch=63.2] | Loss=0.00154 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.450 | L2-Norm(final)=7.245 | 5912.2 samples/s | 92.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=63.2] | Loss=0.00005 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.474 | L2-Norm(final)=7.328 | 3984.2 samples/s | 62.3 steps/s
[Step=16550 Epoch=63.4] | Loss=0.00006 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.451 | L2-Norm(final)=7.332 | 4529.9 samples/s | 70.8 steps/s
[Step=16600 Epoch=63.6] | Loss=0.00104 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.429 | L2-Norm(final)=7.335 | 4755.5 samples/s | 74.3 steps/s
[Step=16650 Epoch=63.8] | Loss=0.00685 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.478 | L2-Norm(final)=7.308 | 4760.3 samples/s | 74.4 steps/s
[Step=16700 Epoch=64.0] | Loss=0.00744 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.537 | L2-Norm(final)=7.281 | 4778.8 samples/s | 74.7 steps/s
[Step=16750 Epoch=64.2] | Loss=0.00617 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.575 | L2-Norm(final)=7.262 | 6085.0 samples/s | 95.1 steps/s
[Step=16800 Epoch=64.4] | Loss=0.00525 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.598 | L2-Norm(final)=7.251 | 1859.2 samples/s | 29.0 steps/s
[Step=16850 Epoch=64.6] | Loss=0.00453 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.613 | L2-Norm(final)=7.245 | 4844.3 samples/s | 75.7 steps/s
[Step=16900 Epoch=64.8] | Loss=0.00400 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.620 | L2-Norm(final)=7.242 | 4780.8 samples/s | 74.7 steps/s
[Step=16950 Epoch=64.9] | Loss=0.00361 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.623 | L2-Norm(final)=7.239 | 4737.8 samples/s | 74.0 steps/s
[Step=17000 Epoch=65.1] | Loss=0.00326 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.622 | L2-Norm(final)=7.238 | 5293.2 samples/s | 82.7 steps/s
[Step=17050 Epoch=65.3] | Loss=0.00301 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.620 | L2-Norm(final)=7.238 | 1961.1 samples/s | 30.6 steps/s
[Step=17100 Epoch=65.5] | Loss=0.00276 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.616 | L2-Norm(final)=7.238 | 4716.3 samples/s | 73.7 steps/s
[Step=17150 Epoch=65.7] | Loss=0.00255 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.611 | L2-Norm(final)=7.238 | 4818.3 samples/s | 75.3 steps/s
[Step=17200 Epoch=65.9] | Loss=0.00237 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.604 | L2-Norm(final)=7.238 | 4772.8 samples/s | 74.6 steps/s
[Step=17250 Epoch=66.1] | Loss=0.00221 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.596 | L2-Norm(final)=7.238 | 4788.7 samples/s | 74.8 steps/s
[Step=17300 Epoch=66.3] | Loss=0.00208 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.587 | L2-Norm(final)=7.239 | 2018.7 samples/s | 31.5 steps/s
[Step=17350 Epoch=66.5] | Loss=0.00195 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.578 | L2-Norm(final)=7.239 | 4973.7 samples/s | 77.7 steps/s
[Step=17400 Epoch=66.7] | Loss=0.00185 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.567 | L2-Norm(final)=7.240 | 4712.7 samples/s | 73.6 steps/s
[Step=17450 Epoch=66.9] | Loss=0.00175 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.557 | L2-Norm(final)=7.240 | 4782.4 samples/s | 74.7 steps/s
[Step=17500 Epoch=67.1] | Loss=0.00166 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.545 | L2-Norm(final)=7.241 | 4745.5 samples/s | 74.1 steps/s
[Step=17550 Epoch=67.2] | Loss=0.00158 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.533 | L2-Norm(final)=7.241 | 2039.5 samples/s | 31.9 steps/s
[Step=17600 Epoch=67.4] | Loss=0.00151 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.521 | L2-Norm(final)=7.242 | 4715.3 samples/s | 73.7 steps/s
[Step=17650 Epoch=67.6] | Loss=0.00145 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.508 | L2-Norm(final)=7.242 | 4909.8 samples/s | 76.7 steps/s
[Step=17700 Epoch=67.8] | Loss=0.00139 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.496 | L2-Norm(final)=7.243 | 4697.8 samples/s | 73.4 steps/s
[Step=17750 Epoch=68.0] | Loss=0.00133 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.482 | L2-Norm(final)=7.243 | 4815.6 samples/s | 75.2 steps/s
[Step=17800 Epoch=68.2] | Loss=0.00128 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.469 | L2-Norm(final)=7.244 | 6578.7 samples/s | 102.8 steps/s
[Step=17850 Epoch=68.4] | Loss=0.00123 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.455 | L2-Norm(final)=7.244 | 1838.5 samples/s | 28.7 steps/s
[Step=17900 Epoch=68.6] | Loss=0.00119 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.441 | L2-Norm(final)=7.245 | 4718.4 samples/s | 73.7 steps/s
[Step=17950 Epoch=68.8] | Loss=0.00115 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.427 | L2-Norm(final)=7.245 | 4766.1 samples/s | 74.5 steps/s
[Step=18000 Epoch=69.0] | Loss=0.00111 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.412 | L2-Norm(final)=7.246 | 4915.3 samples/s | 76.8 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step18000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06294 | acc=0.9659 | tpr=0.9730 | fpr=0.0493 | 4389.0 samples/s | 17.1 steps/s
Avg test loss: 0.06535, Avg test acc: 0.96510, Avg tpr: 0.97237, Avg fpr: 0.05089, total FA: 397

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06271 | acc=0.9670 | tpr=0.9779 | fpr=0.0565 | 4505.2 samples/s | 17.6 steps/s
Avg test loss: 0.06886, Avg test acc: 0.96558, Avg tpr: 0.97645, Avg fpr: 0.05833, total FA: 455

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.68437 | acc=0.3189 | tpr=0.0277 | fpr=0.0488 | 4522.5 samples/s | 17.7 steps/s
Avg test loss: 4.70237, Avg test acc: 0.31605, Avg tpr: 0.02763, Avg fpr: 0.04961, total FA: 387

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.59867 | acc=0.3074 | tpr=0.0469 | fpr=0.1269 | 4495.6 samples/s | 17.6 steps/s
Avg test loss: 5.59561, Avg test acc: 0.30800, Avg tpr: 0.04867, Avg fpr: 0.12165, total FA: 949

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.60632 | acc=0.0881 | tpr=0.6858 | fpr=0.9226 | 4444.6 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.58504 | acc=0.0891 | tpr=0.6461 | fpr=0.9213 | 8891.0 samples/s | 34.7 steps/s
[Step= 150] | Loss=5.59306 | acc=0.0887 | tpr=0.6427 | fpr=0.9215 | 9023.0 samples/s | 35.2 steps/s
[Step= 200] | Loss=5.58921 | acc=0.0887 | tpr=0.6426 | fpr=0.9214 | 8710.7 samples/s | 34.0 steps/s
[Step= 250] | Loss=5.58555 | acc=0.0889 | tpr=0.6472 | fpr=0.9213 | 8697.9 samples/s | 34.0 steps/s
[Step= 300] | Loss=5.58057 | acc=0.0898 | tpr=0.6545 | fpr=0.9205 | 8859.7 samples/s | 34.6 steps/s
[Step= 350] | Loss=5.58067 | acc=0.0896 | tpr=0.6506 | fpr=0.9206 | 8678.8 samples/s | 33.9 steps/s
[Step= 400] | Loss=5.57898 | acc=0.0899 | tpr=0.6493 | fpr=0.9203 | 8828.2 samples/s | 34.5 steps/s
[Step= 450] | Loss=5.58521 | acc=0.0900 | tpr=0.6436 | fpr=0.9201 | 8972.4 samples/s | 35.0 steps/s
[Step= 500] | Loss=5.58879 | acc=0.0898 | tpr=0.6471 | fpr=0.9203 | 8834.4 samples/s | 34.5 steps/s
[Step= 550] | Loss=5.59112 | acc=0.0900 | tpr=0.6518 | fpr=0.9202 | 15893.4 samples/s | 62.1 steps/s
Avg test loss: 5.59196, Avg test acc: 0.08996, Avg tpr: 0.65254, Avg fpr: 0.92027, total FA: 127777

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.12505 | acc=0.1116 | tpr=0.6726 | fpr=0.8985 | 4436.8 samples/s | 17.3 steps/s
[Step= 100] | Loss=6.09420 | acc=0.1121 | tpr=0.6461 | fpr=0.8978 | 9005.0 samples/s | 35.2 steps/s
[Step= 150] | Loss=6.12264 | acc=0.1118 | tpr=0.6398 | fpr=0.8979 | 8532.3 samples/s | 33.3 steps/s
[Step= 200] | Loss=6.11519 | acc=0.1112 | tpr=0.6404 | fpr=0.8985 | 9346.1 samples/s | 36.5 steps/s
[Step= 250] | Loss=6.11771 | acc=0.1114 | tpr=0.6445 | fpr=0.8984 | 8471.4 samples/s | 33.1 steps/s
[Step= 300] | Loss=6.11408 | acc=0.1116 | tpr=0.6465 | fpr=0.8982 | 8764.0 samples/s | 34.2 steps/s
[Step= 350] | Loss=6.10982 | acc=0.1112 | tpr=0.6412 | fpr=0.8984 | 9026.7 samples/s | 35.3 steps/s
[Step= 400] | Loss=6.11130 | acc=0.1113 | tpr=0.6395 | fpr=0.8983 | 8570.0 samples/s | 33.5 steps/s
[Step= 450] | Loss=6.12145 | acc=0.1109 | tpr=0.6373 | fpr=0.8987 | 8746.5 samples/s | 34.2 steps/s
[Step= 500] | Loss=6.12618 | acc=0.1109 | tpr=0.6392 | fpr=0.8987 | 9124.7 samples/s | 35.6 steps/s
[Step= 550] | Loss=6.13017 | acc=0.1109 | tpr=0.6387 | fpr=0.8987 | 14553.2 samples/s | 56.8 steps/s
Avg test loss: 6.13083, Avg test acc: 0.11080, Avg tpr: 0.63986, Avg fpr: 0.89882, total FA: 124799

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11359 | acc=0.9812 | tpr=0.9381 | fpr=0.0181 | 4537.8 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.11792 | acc=0.9809 | tpr=0.9360 | fpr=0.0183 | 8577.9 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.12224 | acc=0.9803 | tpr=0.9366 | fpr=0.0189 | 8483.3 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.12353 | acc=0.9802 | tpr=0.9410 | fpr=0.0191 | 9088.6 samples/s | 35.5 steps/s
[Step= 250] | Loss=0.12153 | acc=0.9806 | tpr=0.9424 | fpr=0.0187 | 8660.4 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.12349 | acc=0.9803 | tpr=0.9404 | fpr=0.0189 | 8642.1 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.12473 | acc=0.9801 | tpr=0.9405 | fpr=0.0192 | 9339.6 samples/s | 36.5 steps/s
[Step= 400] | Loss=0.12498 | acc=0.9801 | tpr=0.9382 | fpr=0.0192 | 8487.4 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.12757 | acc=0.9798 | tpr=0.9367 | fpr=0.0194 | 8798.8 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.12726 | acc=0.9798 | tpr=0.9374 | fpr=0.0194 | 8549.0 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.12680 | acc=0.9799 | tpr=0.9355 | fpr=0.0193 | 15731.2 samples/s | 61.4 steps/s
Avg test loss: 0.12645, Avg test acc: 0.97990, Avg tpr: 0.93582, Avg fpr: 0.01929, total FA: 2679

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12206 | acc=0.9802 | tpr=0.9071 | fpr=0.0185 | 4508.4 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.13140 | acc=0.9789 | tpr=0.9254 | fpr=0.0201 | 8934.2 samples/s | 34.9 steps/s
[Step= 150] | Loss=0.13614 | acc=0.9777 | tpr=0.9337 | fpr=0.0215 | 8575.9 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.13550 | acc=0.9781 | tpr=0.9421 | fpr=0.0212 | 8743.4 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.13323 | acc=0.9785 | tpr=0.9424 | fpr=0.0208 | 8924.3 samples/s | 34.9 steps/s
[Step= 300] | Loss=0.13554 | acc=0.9784 | tpr=0.9404 | fpr=0.0209 | 8632.2 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.13633 | acc=0.9784 | tpr=0.9418 | fpr=0.0210 | 8807.8 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.13689 | acc=0.9783 | tpr=0.9409 | fpr=0.0210 | 9044.4 samples/s | 35.3 steps/s
[Step= 450] | Loss=0.13939 | acc=0.9780 | tpr=0.9382 | fpr=0.0213 | 8555.6 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.13878 | acc=0.9780 | tpr=0.9379 | fpr=0.0213 | 9011.2 samples/s | 35.2 steps/s
[Step= 550] | Loss=0.13785 | acc=0.9780 | tpr=0.9367 | fpr=0.0212 | 15481.0 samples/s | 60.5 steps/s
Avg test loss: 0.13742, Avg test acc: 0.97807, Avg tpr: 0.93700, Avg fpr: 0.02118, total FA: 2941

server round 16/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=12001 Epoch=23.4] | Loss=0.04535 | Reg=0.00193 | acc=0.9531 | L2-Norm=13.887 | L2-Norm(final)=5.229 | 3873.4 samples/s | 60.5 steps/s
[Step=12050 Epoch=23.5] | Loss=0.02261 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.916 | L2-Norm(final)=5.250 | 4801.3 samples/s | 75.0 steps/s
[Step=12100 Epoch=23.6] | Loss=0.02239 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.955 | L2-Norm(final)=5.268 | 5737.6 samples/s | 89.6 steps/s
[Step=12150 Epoch=23.7] | Loss=0.02085 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.989 | L2-Norm(final)=5.288 | 5625.1 samples/s | 87.9 steps/s
[Step=12200 Epoch=23.8] | Loss=0.02085 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.020 | L2-Norm(final)=5.306 | 5648.8 samples/s | 88.3 steps/s
[Step=12250 Epoch=23.9] | Loss=0.02025 | Reg=0.00197 | acc=0.9375 | L2-Norm=14.050 | L2-Norm(final)=5.322 | 5715.0 samples/s | 89.3 steps/s
[Step=12300 Epoch=24.0] | Loss=0.01981 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.078 | L2-Norm(final)=5.339 | 5735.1 samples/s | 89.6 steps/s
[Step=12350 Epoch=24.1] | Loss=0.01985 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.103 | L2-Norm(final)=5.355 | 5640.7 samples/s | 88.1 steps/s
[Step=12400 Epoch=24.2] | Loss=0.01955 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.127 | L2-Norm(final)=5.369 | 5589.6 samples/s | 87.3 steps/s
[Step=12450 Epoch=24.3] | Loss=0.01936 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.151 | L2-Norm(final)=5.384 | 5722.5 samples/s | 89.4 steps/s
[Step=12500 Epoch=24.4] | Loss=0.01932 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.175 | L2-Norm(final)=5.398 | 7126.8 samples/s | 111.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=24.4] | Loss=0.00785 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.418 | L2-Norm(final)=5.541 | 3673.9 samples/s | 57.4 steps/s
[Step=12550 Epoch=24.5] | Loss=0.01927 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.445 | L2-Norm(final)=5.554 | 5016.4 samples/s | 78.4 steps/s
[Step=12600 Epoch=24.6] | Loss=0.02381 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.481 | L2-Norm(final)=5.551 | 5037.9 samples/s | 78.7 steps/s
[Step=12650 Epoch=24.7] | Loss=0.02323 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.513 | L2-Norm(final)=5.551 | 5088.9 samples/s | 79.5 steps/s
[Step=12700 Epoch=24.8] | Loss=0.02373 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.540 | L2-Norm(final)=5.551 | 4998.7 samples/s | 78.1 steps/s
[Step=12750 Epoch=24.9] | Loss=0.02357 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.565 | L2-Norm(final)=5.553 | 5018.7 samples/s | 78.4 steps/s
[Step=12800 Epoch=25.0] | Loss=0.02447 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.589 | L2-Norm(final)=5.553 | 5088.1 samples/s | 79.5 steps/s
[Step=12850 Epoch=25.1] | Loss=0.02493 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.610 | L2-Norm(final)=5.551 | 5041.1 samples/s | 78.8 steps/s
[Step=12900 Epoch=25.2] | Loss=0.02446 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.630 | L2-Norm(final)=5.551 | 5029.6 samples/s | 78.6 steps/s
[Step=12950 Epoch=25.3] | Loss=0.02466 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.650 | L2-Norm(final)=5.551 | 4931.8 samples/s | 77.1 steps/s
[Step=13000 Epoch=25.4] | Loss=0.02438 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.669 | L2-Norm(final)=5.551 | 6118.9 samples/s | 95.6 steps/s
[Step=13050 Epoch=25.5] | Loss=0.02365 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.687 | L2-Norm(final)=5.553 | 1872.6 samples/s | 29.3 steps/s
[Step=13100 Epoch=25.6] | Loss=0.02281 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.704 | L2-Norm(final)=5.554 | 4987.2 samples/s | 77.9 steps/s
[Step=13150 Epoch=25.6] | Loss=0.02180 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.720 | L2-Norm(final)=5.556 | 5035.8 samples/s | 78.7 steps/s
[Step=13200 Epoch=25.7] | Loss=0.02145 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.734 | L2-Norm(final)=5.558 | 5100.7 samples/s | 79.7 steps/s
[Step=13250 Epoch=25.8] | Loss=0.02101 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.748 | L2-Norm(final)=5.560 | 5055.4 samples/s | 79.0 steps/s
[Step=13300 Epoch=25.9] | Loss=0.02103 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.762 | L2-Norm(final)=5.562 | 5047.6 samples/s | 78.9 steps/s
[Step=13350 Epoch=26.0] | Loss=0.02095 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.775 | L2-Norm(final)=5.563 | 5087.0 samples/s | 79.5 steps/s
[Step=13400 Epoch=26.1] | Loss=0.02075 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.789 | L2-Norm(final)=5.564 | 4985.3 samples/s | 77.9 steps/s
[Step=13450 Epoch=26.2] | Loss=0.02073 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.802 | L2-Norm(final)=5.565 | 5108.7 samples/s | 79.8 steps/s
[Step=13500 Epoch=26.3] | Loss=0.02078 | Reg=0.00220 | acc=0.9688 | L2-Norm=14.815 | L2-Norm(final)=5.566 | 5355.9 samples/s | 83.7 steps/s
[Step=13550 Epoch=26.4] | Loss=0.02053 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.827 | L2-Norm(final)=5.567 | 2003.2 samples/s | 31.3 steps/s
[Step=13600 Epoch=26.5] | Loss=0.02003 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.839 | L2-Norm(final)=5.568 | 5078.8 samples/s | 79.4 steps/s
[Step=13650 Epoch=26.6] | Loss=0.01983 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.850 | L2-Norm(final)=5.570 | 5005.9 samples/s | 78.2 steps/s
[Step=13700 Epoch=26.7] | Loss=0.01954 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.861 | L2-Norm(final)=5.571 | 5041.3 samples/s | 78.8 steps/s
[Step=13750 Epoch=26.8] | Loss=0.01914 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.872 | L2-Norm(final)=5.573 | 5015.5 samples/s | 78.4 steps/s
[Step=13800 Epoch=26.9] | Loss=0.01886 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.882 | L2-Norm(final)=5.575 | 5032.2 samples/s | 78.6 steps/s
[Step=13850 Epoch=27.0] | Loss=0.01873 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.892 | L2-Norm(final)=5.576 | 5130.0 samples/s | 80.2 steps/s
[Step=13900 Epoch=27.1] | Loss=0.01856 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.901 | L2-Norm(final)=5.578 | 4975.7 samples/s | 77.7 steps/s
[Step=13950 Epoch=27.2] | Loss=0.01849 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.910 | L2-Norm(final)=5.579 | 5086.0 samples/s | 79.5 steps/s
[Step=14000 Epoch=27.3] | Loss=0.01842 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.918 | L2-Norm(final)=5.580 | 5054.9 samples/s | 79.0 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step14000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=18001 Epoch=69.0] | Loss=0.00827 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.887 | L2-Norm(final)=7.261 | 3922.2 samples/s | 61.3 steps/s
[Step=18050 Epoch=69.2] | Loss=0.00200 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.931 | L2-Norm(final)=7.282 | 4883.0 samples/s | 76.3 steps/s
[Step=18100 Epoch=69.4] | Loss=0.00186 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.982 | L2-Norm(final)=7.304 | 5331.5 samples/s | 83.3 steps/s
[Step=18150 Epoch=69.5] | Loss=0.00143 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.015 | L2-Norm(final)=7.322 | 5368.8 samples/s | 83.9 steps/s
[Step=18200 Epoch=69.7] | Loss=0.00123 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.033 | L2-Norm(final)=7.338 | 5285.4 samples/s | 82.6 steps/s
[Step=18250 Epoch=69.9] | Loss=0.00105 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.048 | L2-Norm(final)=7.352 | 6921.2 samples/s | 108.1 steps/s
[Step=18300 Epoch=70.1] | Loss=0.00103 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.058 | L2-Norm(final)=7.364 | 1921.8 samples/s | 30.0 steps/s
[Step=18350 Epoch=70.3] | Loss=0.00092 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.066 | L2-Norm(final)=7.375 | 5291.2 samples/s | 82.7 steps/s
[Step=18400 Epoch=70.5] | Loss=0.00082 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.070 | L2-Norm(final)=7.386 | 5323.4 samples/s | 83.2 steps/s
[Step=18450 Epoch=70.7] | Loss=0.00075 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.071 | L2-Norm(final)=7.395 | 5389.2 samples/s | 84.2 steps/s
[Step=18500 Epoch=70.9] | Loss=0.00069 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.070 | L2-Norm(final)=7.404 | 5956.7 samples/s | 93.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=70.9] | Loss=0.00008 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.053 | L2-Norm(final)=7.491 | 3882.9 samples/s | 60.7 steps/s
[Step=18550 Epoch=71.1] | Loss=0.00008 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.036 | L2-Norm(final)=7.496 | 4477.8 samples/s | 70.0 steps/s
[Step=18600 Epoch=71.3] | Loss=0.00008 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.018 | L2-Norm(final)=7.501 | 4760.6 samples/s | 74.4 steps/s
[Step=18650 Epoch=71.5] | Loss=0.00007 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.000 | L2-Norm(final)=7.506 | 4767.6 samples/s | 74.5 steps/s
[Step=18700 Epoch=71.7] | Loss=0.00006 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.982 | L2-Norm(final)=7.510 | 4788.4 samples/s | 74.8 steps/s
[Step=18750 Epoch=71.8] | Loss=0.00005 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.962 | L2-Norm(final)=7.513 | 5972.7 samples/s | 93.3 steps/s
[Step=18800 Epoch=72.0] | Loss=0.00005 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.942 | L2-Norm(final)=7.515 | 1870.6 samples/s | 29.2 steps/s
[Step=18850 Epoch=72.2] | Loss=0.00004 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.921 | L2-Norm(final)=7.517 | 4809.1 samples/s | 75.1 steps/s
[Step=18900 Epoch=72.4] | Loss=0.00004 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.899 | L2-Norm(final)=7.518 | 4765.1 samples/s | 74.5 steps/s
[Step=18950 Epoch=72.6] | Loss=0.00003 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.878 | L2-Norm(final)=7.520 | 4784.0 samples/s | 74.8 steps/s
[Step=19000 Epoch=72.8] | Loss=0.00003 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.856 | L2-Norm(final)=7.521 | 5328.9 samples/s | 83.3 steps/s
[Step=19050 Epoch=73.0] | Loss=0.00003 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.834 | L2-Norm(final)=7.522 | 1954.9 samples/s | 30.5 steps/s
[Step=19100 Epoch=73.2] | Loss=0.00003 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.812 | L2-Norm(final)=7.523 | 4838.2 samples/s | 75.6 steps/s
[Step=19150 Epoch=73.4] | Loss=0.00002 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.790 | L2-Norm(final)=7.524 | 4756.8 samples/s | 74.3 steps/s
[Step=19200 Epoch=73.6] | Loss=0.00002 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.768 | L2-Norm(final)=7.525 | 4797.2 samples/s | 75.0 steps/s
[Step=19250 Epoch=73.8] | Loss=0.00002 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.745 | L2-Norm(final)=7.526 | 4769.7 samples/s | 74.5 steps/s
[Step=19300 Epoch=74.0] | Loss=0.00002 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.723 | L2-Norm(final)=7.527 | 2024.1 samples/s | 31.6 steps/s
[Step=19350 Epoch=74.1] | Loss=0.00002 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.700 | L2-Norm(final)=7.528 | 4917.5 samples/s | 76.8 steps/s
[Step=19400 Epoch=74.3] | Loss=0.00002 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.677 | L2-Norm(final)=7.529 | 4815.0 samples/s | 75.2 steps/s
[Step=19450 Epoch=74.5] | Loss=0.00002 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.655 | L2-Norm(final)=7.529 | 4699.6 samples/s | 73.4 steps/s
[Step=19500 Epoch=74.7] | Loss=0.00002 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.632 | L2-Norm(final)=7.530 | 4814.3 samples/s | 75.2 steps/s
[Step=19550 Epoch=74.9] | Loss=0.00002 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.609 | L2-Norm(final)=7.531 | 2024.5 samples/s | 31.6 steps/s
[Step=19600 Epoch=75.1] | Loss=0.00002 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.586 | L2-Norm(final)=7.532 | 4735.3 samples/s | 74.0 steps/s
[Step=19650 Epoch=75.3] | Loss=0.00002 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.563 | L2-Norm(final)=7.532 | 4852.9 samples/s | 75.8 steps/s
[Step=19700 Epoch=75.5] | Loss=0.00001 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.539 | L2-Norm(final)=7.533 | 4710.2 samples/s | 73.6 steps/s
[Step=19750 Epoch=75.7] | Loss=0.00001 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.516 | L2-Norm(final)=7.534 | 4918.2 samples/s | 76.8 steps/s
[Step=19800 Epoch=75.9] | Loss=0.00001 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=7.534 | 6350.2 samples/s | 99.2 steps/s
[Step=19850 Epoch=76.1] | Loss=0.00001 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.469 | L2-Norm(final)=7.535 | 1831.2 samples/s | 28.6 steps/s
[Step=19900 Epoch=76.2] | Loss=0.00001 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.445 | L2-Norm(final)=7.536 | 4741.6 samples/s | 74.1 steps/s
[Step=19950 Epoch=76.4] | Loss=0.00001 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.421 | L2-Norm(final)=7.536 | 4818.4 samples/s | 75.3 steps/s
[Step=20000 Epoch=76.6] | Loss=0.00001 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.398 | L2-Norm(final)=7.537 | 4800.5 samples/s | 75.0 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06267 | acc=0.9646 | tpr=0.9727 | fpr=0.0530 | 4420.9 samples/s | 17.3 steps/s
Avg test loss: 0.06552, Avg test acc: 0.96338, Avg tpr: 0.97173, Avg fpr: 0.05499, total FA: 429

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06271 | acc=0.9670 | tpr=0.9779 | fpr=0.0565 | 4458.5 samples/s | 17.4 steps/s
Avg test loss: 0.06886, Avg test acc: 0.96558, Avg tpr: 0.97645, Avg fpr: 0.05833, total FA: 455

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.97927 | acc=0.3177 | tpr=0.0533 | fpr=0.1080 | 4435.1 samples/s | 17.3 steps/s
Avg test loss: 4.98782, Avg test acc: 0.31673, Avg tpr: 0.05438, Avg fpr: 0.10627, total FA: 829

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.59867 | acc=0.3074 | tpr=0.0469 | fpr=0.1269 | 4445.4 samples/s | 17.4 steps/s
Avg test loss: 5.59561, Avg test acc: 0.30800, Avg tpr: 0.04867, Avg fpr: 0.12165, total FA: 949

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.46642 | acc=0.1083 | tpr=0.6770 | fpr=0.9019 | 4450.1 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.43712 | acc=0.1086 | tpr=0.6503 | fpr=0.9016 | 8782.9 samples/s | 34.3 steps/s
[Step= 150] | Loss=5.45123 | acc=0.1079 | tpr=0.6427 | fpr=0.9019 | 8837.4 samples/s | 34.5 steps/s
[Step= 200] | Loss=5.44942 | acc=0.1078 | tpr=0.6404 | fpr=0.9019 | 8882.3 samples/s | 34.7 steps/s
[Step= 250] | Loss=5.44671 | acc=0.1081 | tpr=0.6402 | fpr=0.9016 | 8645.8 samples/s | 33.8 steps/s
[Step= 300] | Loss=5.44197 | acc=0.1083 | tpr=0.6429 | fpr=0.9014 | 8858.1 samples/s | 34.6 steps/s
[Step= 350] | Loss=5.44085 | acc=0.1079 | tpr=0.6431 | fpr=0.9018 | 8912.7 samples/s | 34.8 steps/s
[Step= 400] | Loss=5.43950 | acc=0.1083 | tpr=0.6466 | fpr=0.9015 | 8705.5 samples/s | 34.0 steps/s
[Step= 450] | Loss=5.44587 | acc=0.1081 | tpr=0.6407 | fpr=0.9016 | 8493.4 samples/s | 33.2 steps/s
[Step= 500] | Loss=5.44897 | acc=0.1080 | tpr=0.6383 | fpr=0.9015 | 8889.1 samples/s | 34.7 steps/s
[Step= 550] | Loss=5.45195 | acc=0.1080 | tpr=0.6371 | fpr=0.9016 | 15565.4 samples/s | 60.8 steps/s
Avg test loss: 5.45253, Avg test acc: 0.10794, Avg tpr: 0.63867, Avg fpr: 0.90171, total FA: 125200

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.12505 | acc=0.1116 | tpr=0.6726 | fpr=0.8985 | 4531.5 samples/s | 17.7 steps/s
[Step= 100] | Loss=6.09420 | acc=0.1121 | tpr=0.6461 | fpr=0.8978 | 8862.1 samples/s | 34.6 steps/s
[Step= 150] | Loss=6.12264 | acc=0.1118 | tpr=0.6398 | fpr=0.8979 | 8503.9 samples/s | 33.2 steps/s
[Step= 200] | Loss=6.11519 | acc=0.1112 | tpr=0.6404 | fpr=0.8985 | 8669.8 samples/s | 33.9 steps/s
[Step= 250] | Loss=6.11771 | acc=0.1114 | tpr=0.6445 | fpr=0.8984 | 8853.0 samples/s | 34.6 steps/s
[Step= 300] | Loss=6.11408 | acc=0.1116 | tpr=0.6465 | fpr=0.8982 | 9233.8 samples/s | 36.1 steps/s
[Step= 350] | Loss=6.10982 | acc=0.1112 | tpr=0.6412 | fpr=0.8984 | 8332.2 samples/s | 32.5 steps/s
[Step= 400] | Loss=6.11130 | acc=0.1113 | tpr=0.6395 | fpr=0.8983 | 9028.1 samples/s | 35.3 steps/s
[Step= 450] | Loss=6.12145 | acc=0.1109 | tpr=0.6373 | fpr=0.8987 | 8686.0 samples/s | 33.9 steps/s
[Step= 500] | Loss=6.12618 | acc=0.1109 | tpr=0.6392 | fpr=0.8987 | 8977.4 samples/s | 35.1 steps/s
[Step= 550] | Loss=6.13017 | acc=0.1109 | tpr=0.6387 | fpr=0.8987 | 15450.4 samples/s | 60.4 steps/s
Avg test loss: 6.13083, Avg test acc: 0.11080, Avg tpr: 0.63986, Avg fpr: 0.89882, total FA: 124799

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12783 | acc=0.9807 | tpr=0.9336 | fpr=0.0185 | 4459.4 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.13482 | acc=0.9804 | tpr=0.9424 | fpr=0.0189 | 9276.4 samples/s | 36.2 steps/s
[Step= 150] | Loss=0.14074 | acc=0.9794 | tpr=0.9467 | fpr=0.0200 | 8292.8 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.14094 | acc=0.9796 | tpr=0.9497 | fpr=0.0198 | 9019.0 samples/s | 35.2 steps/s
[Step= 250] | Loss=0.13956 | acc=0.9797 | tpr=0.9441 | fpr=0.0197 | 8474.4 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.14176 | acc=0.9795 | tpr=0.9433 | fpr=0.0199 | 9048.4 samples/s | 35.3 steps/s
[Step= 350] | Loss=0.14319 | acc=0.9794 | tpr=0.9443 | fpr=0.0200 | 8633.3 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.14376 | acc=0.9792 | tpr=0.9420 | fpr=0.0202 | 8899.3 samples/s | 34.8 steps/s
[Step= 450] | Loss=0.14665 | acc=0.9787 | tpr=0.9387 | fpr=0.0205 | 8791.5 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.14589 | acc=0.9788 | tpr=0.9396 | fpr=0.0204 | 9616.8 samples/s | 37.6 steps/s
[Step= 550] | Loss=0.14513 | acc=0.9789 | tpr=0.9387 | fpr=0.0204 | 13548.6 samples/s | 52.9 steps/s
Avg test loss: 0.14474, Avg test acc: 0.97891, Avg tpr: 0.93899, Avg fpr: 0.02037, total FA: 2828

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12206 | acc=0.9802 | tpr=0.9071 | fpr=0.0185 | 4541.2 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.13140 | acc=0.9789 | tpr=0.9254 | fpr=0.0201 | 8451.8 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.13614 | acc=0.9777 | tpr=0.9337 | fpr=0.0215 | 8753.1 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.13550 | acc=0.9781 | tpr=0.9421 | fpr=0.0212 | 8554.1 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.13323 | acc=0.9785 | tpr=0.9424 | fpr=0.0208 | 8823.0 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.13554 | acc=0.9784 | tpr=0.9404 | fpr=0.0209 | 9120.0 samples/s | 35.6 steps/s
[Step= 350] | Loss=0.13633 | acc=0.9784 | tpr=0.9418 | fpr=0.0210 | 8630.5 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.13689 | acc=0.9783 | tpr=0.9409 | fpr=0.0210 | 9364.6 samples/s | 36.6 steps/s
[Step= 450] | Loss=0.13939 | acc=0.9780 | tpr=0.9382 | fpr=0.0213 | 8387.6 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.13878 | acc=0.9780 | tpr=0.9379 | fpr=0.0213 | 8570.8 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.13785 | acc=0.9780 | tpr=0.9367 | fpr=0.0212 | 16523.9 samples/s | 64.5 steps/s
Avg test loss: 0.13742, Avg test acc: 0.97807, Avg tpr: 0.93700, Avg fpr: 0.02118, total FA: 2941

server round 17/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=20001 Epoch=76.6] | Loss=0.01963 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.564 | L2-Norm(final)=7.557 | 3914.9 samples/s | 61.2 steps/s
[Step=20050 Epoch=76.8] | Loss=0.00765 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.767 | L2-Norm(final)=7.558 | 4866.6 samples/s | 76.0 steps/s
[Step=20100 Epoch=77.0] | Loss=0.00589 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.899 | L2-Norm(final)=7.564 | 5352.0 samples/s | 83.6 steps/s
[Step=20150 Epoch=77.2] | Loss=0.00500 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.970 | L2-Norm(final)=7.572 | 5317.6 samples/s | 83.1 steps/s
[Step=20200 Epoch=77.4] | Loss=0.00423 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.024 | L2-Norm(final)=7.583 | 5442.9 samples/s | 85.0 steps/s
[Step=20250 Epoch=77.6] | Loss=0.00355 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.063 | L2-Norm(final)=7.596 | 6880.9 samples/s | 107.5 steps/s
[Step=20300 Epoch=77.8] | Loss=0.00313 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.091 | L2-Norm(final)=7.608 | 1930.2 samples/s | 30.2 steps/s
[Step=20350 Epoch=78.0] | Loss=0.00271 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.111 | L2-Norm(final)=7.619 | 5264.2 samples/s | 82.3 steps/s
[Step=20400 Epoch=78.2] | Loss=0.00240 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.123 | L2-Norm(final)=7.628 | 5440.7 samples/s | 85.0 steps/s
[Step=20450 Epoch=78.4] | Loss=0.00214 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.130 | L2-Norm(final)=7.637 | 5325.0 samples/s | 83.2 steps/s
[Step=20500 Epoch=78.5] | Loss=0.00197 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.134 | L2-Norm(final)=7.645 | 5954.2 samples/s | 93.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=78.6] | Loss=0.00010 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.167 | L2-Norm(final)=7.726 | 4001.9 samples/s | 62.5 steps/s
[Step=20550 Epoch=78.7] | Loss=0.00164 | Reg=0.00200 | acc=0.9531 | L2-Norm=14.159 | L2-Norm(final)=7.732 | 4417.5 samples/s | 69.0 steps/s
[Step=20600 Epoch=78.9] | Loss=0.00756 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.255 | L2-Norm(final)=7.717 | 4771.2 samples/s | 74.6 steps/s
[Step=20650 Epoch=79.1] | Loss=0.00662 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.335 | L2-Norm(final)=7.696 | 4781.3 samples/s | 74.7 steps/s
[Step=20700 Epoch=79.3] | Loss=0.00618 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.383 | L2-Norm(final)=7.685 | 4796.6 samples/s | 74.9 steps/s
[Step=20750 Epoch=79.5] | Loss=0.00593 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.418 | L2-Norm(final)=7.676 | 6067.0 samples/s | 94.8 steps/s
[Step=20800 Epoch=79.7] | Loss=0.00504 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.445 | L2-Norm(final)=7.667 | 1869.7 samples/s | 29.2 steps/s
[Step=20850 Epoch=79.9] | Loss=0.00440 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.463 | L2-Norm(final)=7.661 | 4808.3 samples/s | 75.1 steps/s
[Step=20900 Epoch=80.1] | Loss=0.00386 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.474 | L2-Norm(final)=7.657 | 4800.6 samples/s | 75.0 steps/s
[Step=20950 Epoch=80.3] | Loss=0.00349 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.481 | L2-Norm(final)=7.655 | 4811.9 samples/s | 75.2 steps/s
[Step=21000 Epoch=80.5] | Loss=0.00314 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.484 | L2-Norm(final)=7.653 | 5281.7 samples/s | 82.5 steps/s
[Step=21050 Epoch=80.7] | Loss=0.00286 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.484 | L2-Norm(final)=7.651 | 1950.8 samples/s | 30.5 steps/s
[Step=21100 Epoch=80.8] | Loss=0.00263 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.483 | L2-Norm(final)=7.650 | 4861.7 samples/s | 76.0 steps/s
[Step=21150 Epoch=81.0] | Loss=0.00242 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.480 | L2-Norm(final)=7.650 | 4756.9 samples/s | 74.3 steps/s
[Step=21200 Epoch=81.2] | Loss=0.00225 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.476 | L2-Norm(final)=7.649 | 4803.2 samples/s | 75.0 steps/s
[Step=21250 Epoch=81.4] | Loss=0.00210 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.471 | L2-Norm(final)=7.649 | 4802.4 samples/s | 75.0 steps/s
[Step=21300 Epoch=81.6] | Loss=0.00197 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.465 | L2-Norm(final)=7.648 | 2026.1 samples/s | 31.7 steps/s
[Step=21350 Epoch=81.8] | Loss=0.00186 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.458 | L2-Norm(final)=7.648 | 4837.5 samples/s | 75.6 steps/s
[Step=21400 Epoch=82.0] | Loss=0.00175 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.451 | L2-Norm(final)=7.648 | 4882.0 samples/s | 76.3 steps/s
[Step=21450 Epoch=82.2] | Loss=0.00166 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.443 | L2-Norm(final)=7.648 | 4846.8 samples/s | 75.7 steps/s
[Step=21500 Epoch=82.4] | Loss=0.00158 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.435 | L2-Norm(final)=7.648 | 4727.3 samples/s | 73.9 steps/s
[Step=21550 Epoch=82.6] | Loss=0.00151 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.427 | L2-Norm(final)=7.648 | 2032.2 samples/s | 31.8 steps/s
[Step=21600 Epoch=82.8] | Loss=0.00144 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.418 | L2-Norm(final)=7.648 | 4821.8 samples/s | 75.3 steps/s
[Step=21650 Epoch=83.0] | Loss=0.00137 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.409 | L2-Norm(final)=7.648 | 4792.5 samples/s | 74.9 steps/s
[Step=21700 Epoch=83.1] | Loss=0.00132 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.399 | L2-Norm(final)=7.649 | 4761.5 samples/s | 74.4 steps/s
[Step=21750 Epoch=83.3] | Loss=0.00127 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.389 | L2-Norm(final)=7.649 | 4806.9 samples/s | 75.1 steps/s
[Step=21800 Epoch=83.5] | Loss=0.00122 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.379 | L2-Norm(final)=7.649 | 6524.9 samples/s | 102.0 steps/s
[Step=21850 Epoch=83.7] | Loss=0.00117 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.369 | L2-Norm(final)=7.649 | 1809.7 samples/s | 28.3 steps/s
[Step=21900 Epoch=83.9] | Loss=0.00113 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.359 | L2-Norm(final)=7.649 | 4775.6 samples/s | 74.6 steps/s
[Step=21950 Epoch=84.1] | Loss=0.00109 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.348 | L2-Norm(final)=7.650 | 4859.4 samples/s | 75.9 steps/s
[Step=22000 Epoch=84.3] | Loss=0.00106 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.337 | L2-Norm(final)=7.650 | 4823.3 samples/s | 75.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step22000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=16001 Epoch=61.6] | Loss=0.00255 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.564 | L2-Norm(final)=6.289 | 3781.2 samples/s | 59.1 steps/s
[Step=16050 Epoch=61.8] | Loss=0.00918 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.763 | L2-Norm(final)=6.272 | 5260.4 samples/s | 82.2 steps/s
[Step=16100 Epoch=62.0] | Loss=0.00566 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.896 | L2-Norm(final)=6.271 | 5469.5 samples/s | 85.5 steps/s
[Step=16150 Epoch=62.2] | Loss=0.00442 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.959 | L2-Norm(final)=6.280 | 5101.4 samples/s | 79.7 steps/s
[Step=16200 Epoch=62.4] | Loss=0.00383 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.996 | L2-Norm(final)=6.289 | 5372.5 samples/s | 83.9 steps/s
[Step=16250 Epoch=62.6] | Loss=0.00330 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.022 | L2-Norm(final)=6.299 | 7074.2 samples/s | 110.5 steps/s
[Step=16300 Epoch=62.7] | Loss=0.00279 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.042 | L2-Norm(final)=6.309 | 1961.7 samples/s | 30.7 steps/s
[Step=16350 Epoch=62.9] | Loss=0.00242 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.053 | L2-Norm(final)=6.318 | 5294.8 samples/s | 82.7 steps/s
[Step=16400 Epoch=63.1] | Loss=0.00216 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.059 | L2-Norm(final)=6.327 | 5455.4 samples/s | 85.2 steps/s
[Step=16450 Epoch=63.3] | Loss=0.00197 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.063 | L2-Norm(final)=6.336 | 5198.9 samples/s | 81.2 steps/s
[Step=16500 Epoch=63.5] | Loss=0.00181 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.065 | L2-Norm(final)=6.344 | 6091.4 samples/s | 95.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=63.5] | Loss=0.00007 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.082 | L2-Norm(final)=6.432 | 3767.0 samples/s | 58.9 steps/s
[Step=16550 Epoch=63.7] | Loss=0.00725 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.132 | L2-Norm(final)=6.433 | 4598.4 samples/s | 71.8 steps/s
[Step=16600 Epoch=63.9] | Loss=0.01604 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.270 | L2-Norm(final)=6.389 | 4803.8 samples/s | 75.1 steps/s
[Step=16650 Epoch=64.1] | Loss=0.01245 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.364 | L2-Norm(final)=6.353 | 4878.5 samples/s | 76.2 steps/s
[Step=16700 Epoch=64.3] | Loss=0.00970 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.414 | L2-Norm(final)=6.338 | 4707.8 samples/s | 73.6 steps/s
[Step=16750 Epoch=64.5] | Loss=0.00810 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.443 | L2-Norm(final)=6.331 | 6155.9 samples/s | 96.2 steps/s
[Step=16800 Epoch=64.7] | Loss=0.00684 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.461 | L2-Norm(final)=6.328 | 1870.6 samples/s | 29.2 steps/s
[Step=16850 Epoch=64.9] | Loss=0.00598 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.471 | L2-Norm(final)=6.326 | 4755.3 samples/s | 74.3 steps/s
[Step=16900 Epoch=65.1] | Loss=0.00524 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.476 | L2-Norm(final)=6.326 | 4679.2 samples/s | 73.1 steps/s
[Step=16950 Epoch=65.2] | Loss=0.00467 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.477 | L2-Norm(final)=6.326 | 4818.5 samples/s | 75.3 steps/s
[Step=17000 Epoch=65.4] | Loss=0.00421 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.476 | L2-Norm(final)=6.326 | 5376.4 samples/s | 84.0 steps/s
[Step=17050 Epoch=65.6] | Loss=0.00383 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.473 | L2-Norm(final)=6.327 | 1939.2 samples/s | 30.3 steps/s
[Step=17100 Epoch=65.8] | Loss=0.00351 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.468 | L2-Norm(final)=6.327 | 4942.2 samples/s | 77.2 steps/s
[Step=17150 Epoch=66.0] | Loss=0.00324 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.462 | L2-Norm(final)=6.328 | 4744.4 samples/s | 74.1 steps/s
[Step=17200 Epoch=66.2] | Loss=0.00301 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.455 | L2-Norm(final)=6.328 | 4736.2 samples/s | 74.0 steps/s
[Step=17250 Epoch=66.4] | Loss=0.00281 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.447 | L2-Norm(final)=6.329 | 4886.9 samples/s | 76.4 steps/s
[Step=17300 Epoch=66.6] | Loss=0.00264 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.439 | L2-Norm(final)=6.330 | 2018.8 samples/s | 31.5 steps/s
[Step=17350 Epoch=66.8] | Loss=0.00248 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.430 | L2-Norm(final)=6.330 | 4876.6 samples/s | 76.2 steps/s
[Step=17400 Epoch=67.0] | Loss=0.00235 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.421 | L2-Norm(final)=6.331 | 4814.6 samples/s | 75.2 steps/s
[Step=17450 Epoch=67.2] | Loss=0.00222 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.411 | L2-Norm(final)=6.332 | 4830.0 samples/s | 75.5 steps/s
[Step=17500 Epoch=67.4] | Loss=0.00211 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.401 | L2-Norm(final)=6.332 | 4823.8 samples/s | 75.4 steps/s
[Step=17550 Epoch=67.6] | Loss=0.00201 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.391 | L2-Norm(final)=6.333 | 2011.2 samples/s | 31.4 steps/s
[Step=17600 Epoch=67.7] | Loss=0.00192 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.381 | L2-Norm(final)=6.333 | 4924.3 samples/s | 76.9 steps/s
[Step=17650 Epoch=67.9] | Loss=0.00184 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.370 | L2-Norm(final)=6.334 | 4777.1 samples/s | 74.6 steps/s
[Step=17700 Epoch=68.1] | Loss=0.00176 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.359 | L2-Norm(final)=6.334 | 4819.5 samples/s | 75.3 steps/s
[Step=17750 Epoch=68.3] | Loss=0.00169 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.347 | L2-Norm(final)=6.335 | 4815.9 samples/s | 75.2 steps/s
[Step=17800 Epoch=68.5] | Loss=0.00163 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.336 | L2-Norm(final)=6.336 | 6918.4 samples/s | 108.1 steps/s
[Step=17850 Epoch=68.7] | Loss=0.00157 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.324 | L2-Norm(final)=6.336 | 1777.0 samples/s | 27.8 steps/s
[Step=17900 Epoch=68.9] | Loss=0.00151 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.313 | L2-Norm(final)=6.337 | 4806.9 samples/s | 75.1 steps/s
[Step=17950 Epoch=69.1] | Loss=0.00146 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.301 | L2-Norm(final)=6.337 | 4791.7 samples/s | 74.9 steps/s
[Step=18000 Epoch=69.3] | Loss=0.00141 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.289 | L2-Norm(final)=6.338 | 4745.7 samples/s | 74.2 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step18000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06267 | acc=0.9646 | tpr=0.9727 | fpr=0.0530 | 4468.0 samples/s | 17.5 steps/s
Avg test loss: 0.06552, Avg test acc: 0.96338, Avg tpr: 0.97173, Avg fpr: 0.05499, total FA: 429

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06271 | acc=0.9670 | tpr=0.9779 | fpr=0.0565 | 4501.4 samples/s | 17.6 steps/s
Avg test loss: 0.06886, Avg test acc: 0.96558, Avg tpr: 0.97645, Avg fpr: 0.05833, total FA: 455

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.95945 | acc=0.3120 | tpr=0.0148 | fpr=0.0429 | 4483.2 samples/s | 17.5 steps/s
Avg test loss: 4.97084, Avg test acc: 0.31084, Avg tpr: 0.01626, Avg fpr: 0.04128, total FA: 322

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.94423 | acc=0.3028 | tpr=0.0224 | fpr=0.0882 | 4443.3 samples/s | 17.4 steps/s
Avg test loss: 5.95021, Avg test acc: 0.30207, Avg tpr: 0.02261, Avg fpr: 0.08332, total FA: 650

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.46642 | acc=0.1083 | tpr=0.6770 | fpr=0.9019 | 4511.6 samples/s | 17.6 steps/s
[Step= 100] | Loss=5.43712 | acc=0.1086 | tpr=0.6503 | fpr=0.9016 | 8475.5 samples/s | 33.1 steps/s
[Step= 150] | Loss=5.45123 | acc=0.1079 | tpr=0.6427 | fpr=0.9019 | 8809.3 samples/s | 34.4 steps/s
[Step= 200] | Loss=5.44942 | acc=0.1078 | tpr=0.6404 | fpr=0.9019 | 8857.1 samples/s | 34.6 steps/s
[Step= 250] | Loss=5.44671 | acc=0.1081 | tpr=0.6402 | fpr=0.9016 | 9280.9 samples/s | 36.3 steps/s
[Step= 300] | Loss=5.44197 | acc=0.1083 | tpr=0.6429 | fpr=0.9014 | 8259.0 samples/s | 32.3 steps/s
[Step= 350] | Loss=5.44085 | acc=0.1079 | tpr=0.6431 | fpr=0.9018 | 8846.7 samples/s | 34.6 steps/s
[Step= 400] | Loss=5.43950 | acc=0.1083 | tpr=0.6466 | fpr=0.9015 | 8843.6 samples/s | 34.5 steps/s
[Step= 450] | Loss=5.44587 | acc=0.1081 | tpr=0.6407 | fpr=0.9016 | 8864.9 samples/s | 34.6 steps/s
[Step= 500] | Loss=5.44897 | acc=0.1080 | tpr=0.6383 | fpr=0.9015 | 8802.5 samples/s | 34.4 steps/s
[Step= 550] | Loss=5.45195 | acc=0.1080 | tpr=0.6371 | fpr=0.9016 | 15303.3 samples/s | 59.8 steps/s
Avg test loss: 5.45253, Avg test acc: 0.10794, Avg tpr: 0.63867, Avg fpr: 0.90171, total FA: 125200

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.12505 | acc=0.1116 | tpr=0.6726 | fpr=0.8985 | 4542.4 samples/s | 17.7 steps/s
[Step= 100] | Loss=6.09420 | acc=0.1121 | tpr=0.6461 | fpr=0.8978 | 8713.7 samples/s | 34.0 steps/s
[Step= 150] | Loss=6.12264 | acc=0.1118 | tpr=0.6398 | fpr=0.8979 | 8707.0 samples/s | 34.0 steps/s
[Step= 200] | Loss=6.11519 | acc=0.1112 | tpr=0.6404 | fpr=0.8985 | 9207.8 samples/s | 36.0 steps/s
[Step= 250] | Loss=6.11771 | acc=0.1114 | tpr=0.6445 | fpr=0.8984 | 8423.5 samples/s | 32.9 steps/s
[Step= 300] | Loss=6.11408 | acc=0.1116 | tpr=0.6465 | fpr=0.8982 | 8678.1 samples/s | 33.9 steps/s
[Step= 350] | Loss=6.10982 | acc=0.1112 | tpr=0.6412 | fpr=0.8984 | 9486.1 samples/s | 37.1 steps/s
[Step= 400] | Loss=6.11130 | acc=0.1113 | tpr=0.6395 | fpr=0.8983 | 8227.9 samples/s | 32.1 steps/s
[Step= 450] | Loss=6.12145 | acc=0.1109 | tpr=0.6373 | fpr=0.8987 | 8796.2 samples/s | 34.4 steps/s
[Step= 500] | Loss=6.12618 | acc=0.1109 | tpr=0.6392 | fpr=0.8987 | 8929.6 samples/s | 34.9 steps/s
[Step= 550] | Loss=6.13017 | acc=0.1109 | tpr=0.6387 | fpr=0.8987 | 14929.6 samples/s | 58.3 steps/s
Avg test loss: 6.13083, Avg test acc: 0.11080, Avg tpr: 0.63986, Avg fpr: 0.89882, total FA: 124799

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10721 | acc=0.9829 | tpr=0.9425 | fpr=0.0164 | 4471.0 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.11486 | acc=0.9821 | tpr=0.9446 | fpr=0.0172 | 8593.4 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.11951 | acc=0.9812 | tpr=0.9467 | fpr=0.0181 | 8740.0 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.12131 | acc=0.9812 | tpr=0.9464 | fpr=0.0182 | 9009.1 samples/s | 35.2 steps/s
[Step= 250] | Loss=0.11958 | acc=0.9814 | tpr=0.9476 | fpr=0.0180 | 8771.2 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.12073 | acc=0.9810 | tpr=0.9447 | fpr=0.0183 | 8743.1 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.12160 | acc=0.9809 | tpr=0.9461 | fpr=0.0185 | 9369.2 samples/s | 36.6 steps/s
[Step= 400] | Loss=0.12244 | acc=0.9807 | tpr=0.9431 | fpr=0.0187 | 8240.2 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.12531 | acc=0.9803 | tpr=0.9406 | fpr=0.0190 | 9071.4 samples/s | 35.4 steps/s
[Step= 500] | Loss=0.12484 | acc=0.9804 | tpr=0.9414 | fpr=0.0189 | 8652.6 samples/s | 33.8 steps/s
[Step= 550] | Loss=0.12412 | acc=0.9805 | tpr=0.9403 | fpr=0.0187 | 15999.5 samples/s | 62.5 steps/s
Avg test loss: 0.12386, Avg test acc: 0.98055, Avg tpr: 0.94057, Avg fpr: 0.01872, total FA: 2599

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12071 | acc=0.9784 | tpr=0.9248 | fpr=0.0206 | 4485.7 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.12748 | acc=0.9785 | tpr=0.9424 | fpr=0.0209 | 8936.9 samples/s | 34.9 steps/s
[Step= 150] | Loss=0.13201 | acc=0.9776 | tpr=0.9452 | fpr=0.0219 | 8582.2 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.13301 | acc=0.9776 | tpr=0.9486 | fpr=0.0219 | 8974.0 samples/s | 35.1 steps/s
[Step= 250] | Loss=0.13091 | acc=0.9779 | tpr=0.9476 | fpr=0.0216 | 8589.5 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.13312 | acc=0.9777 | tpr=0.9433 | fpr=0.0217 | 8885.0 samples/s | 34.7 steps/s
[Step= 350] | Loss=0.13462 | acc=0.9776 | tpr=0.9474 | fpr=0.0219 | 8877.6 samples/s | 34.7 steps/s
[Step= 400] | Loss=0.13533 | acc=0.9774 | tpr=0.9464 | fpr=0.0220 | 8685.9 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.13763 | acc=0.9771 | tpr=0.9440 | fpr=0.0223 | 9068.0 samples/s | 35.4 steps/s
[Step= 500] | Loss=0.13645 | acc=0.9773 | tpr=0.9436 | fpr=0.0221 | 8666.9 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.13570 | acc=0.9773 | tpr=0.9411 | fpr=0.0220 | 15711.4 samples/s | 61.4 steps/s
Avg test loss: 0.13538, Avg test acc: 0.97732, Avg tpr: 0.94097, Avg fpr: 0.02202, total FA: 3057

server round 18/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=22001 Epoch=84.3] | Loss=0.00119 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.004 | L2-Norm(final)=7.658 | 4010.9 samples/s | 62.7 steps/s
[Step=22050 Epoch=84.5] | Loss=0.00209 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.015 | L2-Norm(final)=7.665 | 4727.7 samples/s | 73.9 steps/s
[Step=22100 Epoch=84.7] | Loss=0.00167 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.027 | L2-Norm(final)=7.674 | 5444.7 samples/s | 85.1 steps/s
[Step=22150 Epoch=84.9] | Loss=0.00136 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.032 | L2-Norm(final)=7.687 | 5255.1 samples/s | 82.1 steps/s
[Step=22200 Epoch=85.1] | Loss=0.00109 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.033 | L2-Norm(final)=7.699 | 5442.5 samples/s | 85.0 steps/s
[Step=22250 Epoch=85.3] | Loss=0.00096 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.030 | L2-Norm(final)=7.710 | 6927.1 samples/s | 108.2 steps/s
[Step=22300 Epoch=85.4] | Loss=0.00083 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.027 | L2-Norm(final)=7.719 | 1919.1 samples/s | 30.0 steps/s
[Step=22350 Epoch=85.6] | Loss=0.00075 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.022 | L2-Norm(final)=7.727 | 5363.1 samples/s | 83.8 steps/s
[Step=22400 Epoch=85.8] | Loss=0.00068 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.017 | L2-Norm(final)=7.736 | 5327.9 samples/s | 83.2 steps/s
[Step=22450 Epoch=86.0] | Loss=0.00061 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.011 | L2-Norm(final)=7.744 | 5348.0 samples/s | 83.6 steps/s
[Step=22500 Epoch=86.2] | Loss=0.00056 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.004 | L2-Norm(final)=7.752 | 6014.3 samples/s | 94.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=86.2] | Loss=0.00005 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.939 | L2-Norm(final)=7.829 | 3855.9 samples/s | 60.2 steps/s
[Step=22550 Epoch=86.4] | Loss=0.00007 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.927 | L2-Norm(final)=7.834 | 4644.0 samples/s | 72.6 steps/s
[Step=22600 Epoch=86.6] | Loss=0.00007 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.913 | L2-Norm(final)=7.840 | 4721.0 samples/s | 73.8 steps/s
[Step=22650 Epoch=86.8] | Loss=0.00006 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.898 | L2-Norm(final)=7.845 | 4882.3 samples/s | 76.3 steps/s
[Step=22700 Epoch=87.0] | Loss=0.00005 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.883 | L2-Norm(final)=7.849 | 4769.8 samples/s | 74.5 steps/s
[Step=22750 Epoch=87.2] | Loss=0.00006 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.867 | L2-Norm(final)=7.852 | 6049.8 samples/s | 94.5 steps/s
[Step=22800 Epoch=87.4] | Loss=0.00005 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.852 | L2-Norm(final)=7.856 | 1864.3 samples/s | 29.1 steps/s
[Step=22850 Epoch=87.6] | Loss=0.00004 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.836 | L2-Norm(final)=7.859 | 4768.5 samples/s | 74.5 steps/s
[Step=22900 Epoch=87.7] | Loss=0.00004 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.820 | L2-Norm(final)=7.861 | 4805.8 samples/s | 75.1 steps/s
[Step=22950 Epoch=87.9] | Loss=0.00004 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=7.864 | 4782.6 samples/s | 74.7 steps/s
[Step=23000 Epoch=88.1] | Loss=0.00003 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.786 | L2-Norm(final)=7.866 | 5278.9 samples/s | 82.5 steps/s
[Step=23050 Epoch=88.3] | Loss=0.00003 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.769 | L2-Norm(final)=7.867 | 1966.6 samples/s | 30.7 steps/s
[Step=23100 Epoch=88.5] | Loss=0.00003 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.752 | L2-Norm(final)=7.869 | 4659.2 samples/s | 72.8 steps/s
[Step=23150 Epoch=88.7] | Loss=0.00003 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.734 | L2-Norm(final)=7.871 | 4773.2 samples/s | 74.6 steps/s
[Step=23200 Epoch=88.9] | Loss=0.00003 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.717 | L2-Norm(final)=7.872 | 4797.7 samples/s | 75.0 steps/s
[Step=23250 Epoch=89.1] | Loss=0.00002 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.699 | L2-Norm(final)=7.874 | 4785.9 samples/s | 74.8 steps/s
[Step=23300 Epoch=89.3] | Loss=0.00002 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.681 | L2-Norm(final)=7.875 | 2010.8 samples/s | 31.4 steps/s
[Step=23350 Epoch=89.5] | Loss=0.00002 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.663 | L2-Norm(final)=7.876 | 4931.1 samples/s | 77.0 steps/s
[Step=23400 Epoch=89.7] | Loss=0.00002 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.645 | L2-Norm(final)=7.878 | 4791.0 samples/s | 74.9 steps/s
[Step=23450 Epoch=89.9] | Loss=0.00002 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.626 | L2-Norm(final)=7.879 | 4800.4 samples/s | 75.0 steps/s
[Step=23500 Epoch=90.0] | Loss=0.00002 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.608 | L2-Norm(final)=7.880 | 4759.7 samples/s | 74.4 steps/s
[Step=23550 Epoch=90.2] | Loss=0.00002 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.590 | L2-Norm(final)=7.881 | 2046.2 samples/s | 32.0 steps/s
[Step=23600 Epoch=90.4] | Loss=0.00002 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.571 | L2-Norm(final)=7.883 | 4774.3 samples/s | 74.6 steps/s
[Step=23650 Epoch=90.6] | Loss=0.00002 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.552 | L2-Norm(final)=7.884 | 4813.2 samples/s | 75.2 steps/s
[Step=23700 Epoch=90.8] | Loss=0.00002 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.533 | L2-Norm(final)=7.885 | 4754.0 samples/s | 74.3 steps/s
[Step=23750 Epoch=91.0] | Loss=0.00002 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.514 | L2-Norm(final)=7.886 | 4783.5 samples/s | 74.7 steps/s
[Step=23800 Epoch=91.2] | Loss=0.00002 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.495 | L2-Norm(final)=7.887 | 6495.0 samples/s | 101.5 steps/s
[Step=23850 Epoch=91.4] | Loss=0.00002 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.476 | L2-Norm(final)=7.888 | 1833.4 samples/s | 28.6 steps/s
[Step=23900 Epoch=91.6] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.457 | L2-Norm(final)=7.890 | 4735.3 samples/s | 74.0 steps/s
[Step=23950 Epoch=91.8] | Loss=0.00001 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.437 | L2-Norm(final)=7.891 | 4833.3 samples/s | 75.5 steps/s
[Step=24000 Epoch=92.0] | Loss=0.00001 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.418 | L2-Norm(final)=7.892 | 4770.0 samples/s | 74.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step24000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=18001 Epoch=69.3] | Loss=0.02140 | Reg=0.00196 | acc=0.9688 | L2-Norm=14.004 | L2-Norm(final)=6.354 | 3801.3 samples/s | 59.4 steps/s
[Step=18050 Epoch=69.5] | Loss=0.00238 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.058 | L2-Norm(final)=6.365 | 5081.9 samples/s | 79.4 steps/s
[Step=18100 Epoch=69.7] | Loss=0.00176 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.081 | L2-Norm(final)=6.386 | 5294.0 samples/s | 82.7 steps/s
[Step=18150 Epoch=69.9] | Loss=0.00137 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.095 | L2-Norm(final)=6.407 | 5381.3 samples/s | 84.1 steps/s
[Step=18200 Epoch=70.1] | Loss=0.00114 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.103 | L2-Norm(final)=6.423 | 5352.2 samples/s | 83.6 steps/s
[Step=18250 Epoch=70.3] | Loss=0.00097 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.106 | L2-Norm(final)=6.438 | 6988.5 samples/s | 109.2 steps/s
[Step=18300 Epoch=70.4] | Loss=0.00085 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.107 | L2-Norm(final)=6.452 | 1912.8 samples/s | 29.9 steps/s
[Step=18350 Epoch=70.6] | Loss=0.00075 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.104 | L2-Norm(final)=6.464 | 5398.8 samples/s | 84.4 steps/s
[Step=18400 Epoch=70.8] | Loss=0.00068 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.099 | L2-Norm(final)=6.476 | 5303.7 samples/s | 82.9 steps/s
[Step=18450 Epoch=71.0] | Loss=0.00061 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=6.486 | 5265.8 samples/s | 82.3 steps/s
[Step=18500 Epoch=71.2] | Loss=0.00057 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.086 | L2-Norm(final)=6.497 | 6189.4 samples/s | 96.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=71.2] | Loss=0.00019 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.017 | L2-Norm(final)=6.598 | 3660.5 samples/s | 57.2 steps/s
[Step=18550 Epoch=71.4] | Loss=0.00007 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.004 | L2-Norm(final)=6.605 | 4780.7 samples/s | 74.7 steps/s
[Step=18600 Epoch=71.6] | Loss=0.00006 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.986 | L2-Norm(final)=6.610 | 4818.1 samples/s | 75.3 steps/s
[Step=18650 Epoch=71.8] | Loss=0.00006 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.967 | L2-Norm(final)=6.614 | 4785.0 samples/s | 74.8 steps/s
[Step=18700 Epoch=72.0] | Loss=0.00005 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.947 | L2-Norm(final)=6.618 | 4813.3 samples/s | 75.2 steps/s
[Step=18750 Epoch=72.2] | Loss=0.00005 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.928 | L2-Norm(final)=6.622 | 6056.4 samples/s | 94.6 steps/s
[Step=18800 Epoch=72.4] | Loss=0.00004 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.909 | L2-Norm(final)=6.626 | 1866.4 samples/s | 29.2 steps/s
[Step=18850 Epoch=72.6] | Loss=0.00004 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.890 | L2-Norm(final)=6.629 | 4732.0 samples/s | 73.9 steps/s
[Step=18900 Epoch=72.8] | Loss=0.00004 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.870 | L2-Norm(final)=6.631 | 4703.6 samples/s | 73.5 steps/s
[Step=18950 Epoch=72.9] | Loss=0.00003 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.850 | L2-Norm(final)=6.634 | 4720.0 samples/s | 73.7 steps/s
[Step=19000 Epoch=73.1] | Loss=0.00003 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.830 | L2-Norm(final)=6.636 | 5405.5 samples/s | 84.5 steps/s
[Step=19050 Epoch=73.3] | Loss=0.00003 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.810 | L2-Norm(final)=6.638 | 1937.0 samples/s | 30.3 steps/s
[Step=19100 Epoch=73.5] | Loss=0.00003 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.790 | L2-Norm(final)=6.639 | 4826.1 samples/s | 75.4 steps/s
[Step=19150 Epoch=73.7] | Loss=0.00002 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.770 | L2-Norm(final)=6.641 | 4798.5 samples/s | 75.0 steps/s
[Step=19200 Epoch=73.9] | Loss=0.00002 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.749 | L2-Norm(final)=6.643 | 4895.3 samples/s | 76.5 steps/s
[Step=19250 Epoch=74.1] | Loss=0.00002 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.729 | L2-Norm(final)=6.644 | 4795.4 samples/s | 74.9 steps/s
[Step=19300 Epoch=74.3] | Loss=0.00002 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.709 | L2-Norm(final)=6.646 | 2037.4 samples/s | 31.8 steps/s
[Step=19350 Epoch=74.5] | Loss=0.00002 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.689 | L2-Norm(final)=6.647 | 4702.5 samples/s | 73.5 steps/s
[Step=19400 Epoch=74.7] | Loss=0.00002 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.668 | L2-Norm(final)=6.649 | 4825.7 samples/s | 75.4 steps/s
[Step=19450 Epoch=74.9] | Loss=0.00002 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.648 | L2-Norm(final)=6.650 | 4747.8 samples/s | 74.2 steps/s
[Step=19500 Epoch=75.1] | Loss=0.00002 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.627 | L2-Norm(final)=6.651 | 4819.5 samples/s | 75.3 steps/s
[Step=19550 Epoch=75.3] | Loss=0.00002 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.607 | L2-Norm(final)=6.653 | 2023.3 samples/s | 31.6 steps/s
[Step=19600 Epoch=75.4] | Loss=0.00002 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.587 | L2-Norm(final)=6.654 | 4859.0 samples/s | 75.9 steps/s
[Step=19650 Epoch=75.6] | Loss=0.00002 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.566 | L2-Norm(final)=6.655 | 4705.2 samples/s | 73.5 steps/s
[Step=19700 Epoch=75.8] | Loss=0.00002 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.545 | L2-Norm(final)=6.657 | 4827.1 samples/s | 75.4 steps/s
[Step=19750 Epoch=76.0] | Loss=0.00002 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=6.658 | 4696.3 samples/s | 73.4 steps/s
[Step=19800 Epoch=76.2] | Loss=0.00002 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.504 | L2-Norm(final)=6.659 | 7088.7 samples/s | 110.8 steps/s
[Step=19850 Epoch=76.4] | Loss=0.00002 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.484 | L2-Norm(final)=6.660 | 1795.3 samples/s | 28.1 steps/s
[Step=19900 Epoch=76.6] | Loss=0.00001 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.463 | L2-Norm(final)=6.662 | 4750.8 samples/s | 74.2 steps/s
[Step=19950 Epoch=76.8] | Loss=0.00001 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.442 | L2-Norm(final)=6.663 | 4775.3 samples/s | 74.6 steps/s
[Step=20000 Epoch=77.0] | Loss=0.00001 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.421 | L2-Norm(final)=6.664 | 4813.9 samples/s | 75.2 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06267 | acc=0.9646 | tpr=0.9727 | fpr=0.0530 | 4432.2 samples/s | 17.3 steps/s
Avg test loss: 0.06552, Avg test acc: 0.96338, Avg tpr: 0.97173, Avg fpr: 0.05499, total FA: 429

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06271 | acc=0.9670 | tpr=0.9779 | fpr=0.0565 | 4569.7 samples/s | 17.9 steps/s
Avg test loss: 0.06886, Avg test acc: 0.96558, Avg tpr: 0.97645, Avg fpr: 0.05833, total FA: 455

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.91069 | acc=0.3119 | tpr=0.0349 | fpr=0.0867 | 4470.0 samples/s | 17.5 steps/s
Avg test loss: 4.91736, Avg test acc: 0.31044, Avg tpr: 0.03532, Avg fpr: 0.08448, total FA: 659

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.18709 | acc=0.3109 | tpr=0.0390 | fpr=0.0986 | 4477.2 samples/s | 17.5 steps/s
Avg test loss: 5.18479, Avg test acc: 0.31064, Avg tpr: 0.04010, Avg fpr: 0.09435, total FA: 736

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.46642 | acc=0.1083 | tpr=0.6770 | fpr=0.9019 | 4464.4 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.43712 | acc=0.1086 | tpr=0.6503 | fpr=0.9016 | 9078.1 samples/s | 35.5 steps/s
[Step= 150] | Loss=5.45123 | acc=0.1079 | tpr=0.6427 | fpr=0.9019 | 8771.9 samples/s | 34.3 steps/s
[Step= 200] | Loss=5.44942 | acc=0.1078 | tpr=0.6404 | fpr=0.9019 | 8604.8 samples/s | 33.6 steps/s
[Step= 250] | Loss=5.44671 | acc=0.1081 | tpr=0.6402 | fpr=0.9016 | 8894.6 samples/s | 34.7 steps/s
[Step= 300] | Loss=5.44197 | acc=0.1083 | tpr=0.6429 | fpr=0.9014 | 8663.0 samples/s | 33.8 steps/s
[Step= 350] | Loss=5.44085 | acc=0.1079 | tpr=0.6431 | fpr=0.9018 | 8681.5 samples/s | 33.9 steps/s
[Step= 400] | Loss=5.43950 | acc=0.1083 | tpr=0.6466 | fpr=0.9015 | 9443.2 samples/s | 36.9 steps/s
[Step= 450] | Loss=5.44587 | acc=0.1081 | tpr=0.6407 | fpr=0.9016 | 8120.7 samples/s | 31.7 steps/s
[Step= 500] | Loss=5.44897 | acc=0.1080 | tpr=0.6383 | fpr=0.9015 | 8987.7 samples/s | 35.1 steps/s
[Step= 550] | Loss=5.45195 | acc=0.1080 | tpr=0.6371 | fpr=0.9016 | 15303.7 samples/s | 59.8 steps/s
Avg test loss: 5.45253, Avg test acc: 0.10794, Avg tpr: 0.63867, Avg fpr: 0.90171, total FA: 125200

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.12505 | acc=0.1116 | tpr=0.6726 | fpr=0.8985 | 4477.2 samples/s | 17.5 steps/s
[Step= 100] | Loss=6.09420 | acc=0.1121 | tpr=0.6461 | fpr=0.8978 | 8688.8 samples/s | 33.9 steps/s
[Step= 150] | Loss=6.12264 | acc=0.1118 | tpr=0.6398 | fpr=0.8979 | 8674.8 samples/s | 33.9 steps/s
[Step= 200] | Loss=6.11519 | acc=0.1112 | tpr=0.6404 | fpr=0.8985 | 8886.5 samples/s | 34.7 steps/s
[Step= 250] | Loss=6.11771 | acc=0.1114 | tpr=0.6445 | fpr=0.8984 | 8803.0 samples/s | 34.4 steps/s
[Step= 300] | Loss=6.11408 | acc=0.1116 | tpr=0.6465 | fpr=0.8982 | 8639.1 samples/s | 33.7 steps/s
[Step= 350] | Loss=6.10982 | acc=0.1112 | tpr=0.6412 | fpr=0.8984 | 9102.0 samples/s | 35.6 steps/s
[Step= 400] | Loss=6.11130 | acc=0.1113 | tpr=0.6395 | fpr=0.8983 | 8530.7 samples/s | 33.3 steps/s
[Step= 450] | Loss=6.12145 | acc=0.1109 | tpr=0.6373 | fpr=0.8987 | 9070.0 samples/s | 35.4 steps/s
[Step= 500] | Loss=6.12618 | acc=0.1109 | tpr=0.6392 | fpr=0.8987 | 8826.7 samples/s | 34.5 steps/s
[Step= 550] | Loss=6.13017 | acc=0.1109 | tpr=0.6387 | fpr=0.8987 | 14970.0 samples/s | 58.5 steps/s
Avg test loss: 6.13083, Avg test acc: 0.11080, Avg tpr: 0.63986, Avg fpr: 0.89882, total FA: 124799

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12957 | acc=0.9805 | tpr=0.9381 | fpr=0.0187 | 4450.4 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.13752 | acc=0.9798 | tpr=0.9467 | fpr=0.0196 | 8777.1 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.14337 | acc=0.9788 | tpr=0.9467 | fpr=0.0206 | 8852.2 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.14376 | acc=0.9789 | tpr=0.9475 | fpr=0.0205 | 8906.9 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.14180 | acc=0.9790 | tpr=0.9459 | fpr=0.0204 | 8997.6 samples/s | 35.1 steps/s
[Step= 300] | Loss=0.14385 | acc=0.9788 | tpr=0.9447 | fpr=0.0206 | 8662.4 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.14521 | acc=0.9786 | tpr=0.9480 | fpr=0.0209 | 8984.8 samples/s | 35.1 steps/s
[Step= 400] | Loss=0.14612 | acc=0.9785 | tpr=0.9469 | fpr=0.0210 | 8485.3 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.14922 | acc=0.9781 | tpr=0.9455 | fpr=0.0213 | 9144.9 samples/s | 35.7 steps/s
[Step= 500] | Loss=0.14841 | acc=0.9783 | tpr=0.9471 | fpr=0.0211 | 8782.4 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.14779 | acc=0.9783 | tpr=0.9439 | fpr=0.0211 | 15298.7 samples/s | 59.8 steps/s
Avg test loss: 0.14742, Avg test acc: 0.97831, Avg tpr: 0.94414, Avg fpr: 0.02107, total FA: 2926

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12598 | acc=0.9790 | tpr=0.9425 | fpr=0.0204 | 4548.9 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.13453 | acc=0.9786 | tpr=0.9467 | fpr=0.0209 | 8765.6 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.14006 | acc=0.9774 | tpr=0.9496 | fpr=0.0220 | 8691.9 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.13991 | acc=0.9776 | tpr=0.9530 | fpr=0.0219 | 8793.5 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.13792 | acc=0.9778 | tpr=0.9528 | fpr=0.0217 | 8987.2 samples/s | 35.1 steps/s
[Step= 300] | Loss=0.13993 | acc=0.9777 | tpr=0.9498 | fpr=0.0218 | 8968.8 samples/s | 35.0 steps/s
[Step= 350] | Loss=0.14117 | acc=0.9775 | tpr=0.9524 | fpr=0.0220 | 8332.9 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.14211 | acc=0.9773 | tpr=0.9519 | fpr=0.0222 | 9170.6 samples/s | 35.8 steps/s
[Step= 450] | Loss=0.14516 | acc=0.9769 | tpr=0.9494 | fpr=0.0226 | 8764.9 samples/s | 34.2 steps/s
[Step= 500] | Loss=0.14451 | acc=0.9770 | tpr=0.9498 | fpr=0.0225 | 8759.2 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.14377 | acc=0.9770 | tpr=0.9467 | fpr=0.0224 | 15534.8 samples/s | 60.7 steps/s
Avg test loss: 0.14339, Avg test acc: 0.97703, Avg tpr: 0.94691, Avg fpr: 0.02242, total FA: 3113

server round 19/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=14001 Epoch=27.3] | Loss=0.02850 | Reg=0.00186 | acc=0.9531 | L2-Norm=13.654 | L2-Norm(final)=5.614 | 3743.7 samples/s | 58.5 steps/s
[Step=14050 Epoch=27.4] | Loss=0.01964 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.687 | L2-Norm(final)=5.621 | 5168.2 samples/s | 80.8 steps/s
[Step=14100 Epoch=27.5] | Loss=0.01883 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.716 | L2-Norm(final)=5.634 | 5651.7 samples/s | 88.3 steps/s
[Step=14150 Epoch=27.6] | Loss=0.01825 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.739 | L2-Norm(final)=5.646 | 5634.1 samples/s | 88.0 steps/s
[Step=14200 Epoch=27.7] | Loss=0.01793 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.762 | L2-Norm(final)=5.659 | 5729.4 samples/s | 89.5 steps/s
[Step=14250 Epoch=27.8] | Loss=0.01779 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.784 | L2-Norm(final)=5.669 | 5734.5 samples/s | 89.6 steps/s
[Step=14300 Epoch=27.9] | Loss=0.01751 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.806 | L2-Norm(final)=5.679 | 5591.4 samples/s | 87.4 steps/s
[Step=14350 Epoch=28.0] | Loss=0.01699 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.827 | L2-Norm(final)=5.690 | 5684.1 samples/s | 88.8 steps/s
[Step=14400 Epoch=28.1] | Loss=0.01670 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.848 | L2-Norm(final)=5.701 | 5713.9 samples/s | 89.3 steps/s
[Step=14450 Epoch=28.2] | Loss=0.01647 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.869 | L2-Norm(final)=5.713 | 5709.3 samples/s | 89.2 steps/s
[Step=14500 Epoch=28.3] | Loss=0.01629 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.888 | L2-Norm(final)=5.725 | 7114.7 samples/s | 111.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=28.3] | Loss=0.01998 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.075 | L2-Norm(final)=5.839 | 3619.5 samples/s | 56.6 steps/s
[Step=14550 Epoch=28.4] | Loss=0.01311 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.095 | L2-Norm(final)=5.850 | 5018.6 samples/s | 78.4 steps/s
[Step=14600 Epoch=28.5] | Loss=0.01662 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.118 | L2-Norm(final)=5.854 | 5009.7 samples/s | 78.3 steps/s
[Step=14650 Epoch=28.6] | Loss=0.01729 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.144 | L2-Norm(final)=5.854 | 5086.2 samples/s | 79.5 steps/s
[Step=14700 Epoch=28.7] | Loss=0.01985 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.169 | L2-Norm(final)=5.852 | 5105.6 samples/s | 79.8 steps/s
[Step=14750 Epoch=28.8] | Loss=0.02169 | Reg=0.00202 | acc=0.9375 | L2-Norm=14.196 | L2-Norm(final)=5.849 | 4979.9 samples/s | 77.8 steps/s
[Step=14800 Epoch=28.9] | Loss=0.02174 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.223 | L2-Norm(final)=5.845 | 5031.8 samples/s | 78.6 steps/s
[Step=14850 Epoch=29.0] | Loss=0.02212 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.249 | L2-Norm(final)=5.843 | 5107.9 samples/s | 79.8 steps/s
[Step=14900 Epoch=29.1] | Loss=0.02238 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.273 | L2-Norm(final)=5.840 | 5044.4 samples/s | 78.8 steps/s
[Step=14950 Epoch=29.2] | Loss=0.02266 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.296 | L2-Norm(final)=5.838 | 5113.7 samples/s | 79.9 steps/s
[Step=15000 Epoch=29.3] | Loss=0.02246 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.318 | L2-Norm(final)=5.838 | 6120.3 samples/s | 95.6 steps/s
[Step=15050 Epoch=29.4] | Loss=0.02171 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.338 | L2-Norm(final)=5.839 | 1901.5 samples/s | 29.7 steps/s
[Step=15100 Epoch=29.5] | Loss=0.02098 | Reg=0.00206 | acc=0.9531 | L2-Norm=14.357 | L2-Norm(final)=5.841 | 5100.0 samples/s | 79.7 steps/s
[Step=15150 Epoch=29.5] | Loss=0.02069 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.374 | L2-Norm(final)=5.842 | 4973.8 samples/s | 77.7 steps/s
[Step=15200 Epoch=29.6] | Loss=0.02048 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.390 | L2-Norm(final)=5.844 | 5022.0 samples/s | 78.5 steps/s
[Step=15250 Epoch=29.7] | Loss=0.02011 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.405 | L2-Norm(final)=5.845 | 5078.7 samples/s | 79.4 steps/s
[Step=15300 Epoch=29.8] | Loss=0.01958 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.420 | L2-Norm(final)=5.847 | 5101.4 samples/s | 79.7 steps/s
[Step=15350 Epoch=29.9] | Loss=0.01932 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.434 | L2-Norm(final)=5.849 | 5068.2 samples/s | 79.2 steps/s
[Step=15400 Epoch=30.0] | Loss=0.01936 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.447 | L2-Norm(final)=5.850 | 4984.4 samples/s | 77.9 steps/s
[Step=15450 Epoch=30.1] | Loss=0.01928 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.459 | L2-Norm(final)=5.851 | 5049.4 samples/s | 78.9 steps/s
[Step=15500 Epoch=30.2] | Loss=0.01906 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.471 | L2-Norm(final)=5.853 | 5341.7 samples/s | 83.5 steps/s
[Step=15550 Epoch=30.3] | Loss=0.01879 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.483 | L2-Norm(final)=5.854 | 1939.5 samples/s | 30.3 steps/s
[Step=15600 Epoch=30.4] | Loss=0.01860 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.494 | L2-Norm(final)=5.856 | 5040.4 samples/s | 78.8 steps/s
[Step=15650 Epoch=30.5] | Loss=0.01829 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.505 | L2-Norm(final)=5.857 | 5033.8 samples/s | 78.7 steps/s
[Step=15700 Epoch=30.6] | Loss=0.01802 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.516 | L2-Norm(final)=5.859 | 4959.6 samples/s | 77.5 steps/s
[Step=15750 Epoch=30.7] | Loss=0.01783 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.525 | L2-Norm(final)=5.860 | 5024.1 samples/s | 78.5 steps/s
[Step=15800 Epoch=30.8] | Loss=0.01772 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.535 | L2-Norm(final)=5.862 | 5103.7 samples/s | 79.7 steps/s
[Step=15850 Epoch=30.9] | Loss=0.01757 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.544 | L2-Norm(final)=5.863 | 5040.4 samples/s | 78.8 steps/s
[Step=15900 Epoch=31.0] | Loss=0.01744 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.554 | L2-Norm(final)=5.864 | 5047.3 samples/s | 78.9 steps/s
[Step=15950 Epoch=31.1] | Loss=0.01731 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.563 | L2-Norm(final)=5.865 | 5046.9 samples/s | 78.9 steps/s
[Step=16000 Epoch=31.2] | Loss=0.01719 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.572 | L2-Norm(final)=5.866 | 5033.6 samples/s | 78.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step16000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=24001 Epoch=92.0] | Loss=0.00045 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.654 | L2-Norm(final)=7.929 | 3789.8 samples/s | 59.2 steps/s
[Step=24050 Epoch=92.2] | Loss=0.00456 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.720 | L2-Norm(final)=7.955 | 5019.6 samples/s | 78.4 steps/s
[Step=24100 Epoch=92.3] | Loss=0.00416 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.879 | L2-Norm(final)=7.958 | 5334.4 samples/s | 83.4 steps/s
[Step=24150 Epoch=92.5] | Loss=0.00322 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.968 | L2-Norm(final)=7.968 | 5342.9 samples/s | 83.5 steps/s
[Step=24200 Epoch=92.7] | Loss=0.00266 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.022 | L2-Norm(final)=7.980 | 5343.5 samples/s | 83.5 steps/s
[Step=24250 Epoch=92.9] | Loss=0.00221 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.056 | L2-Norm(final)=7.989 | 6888.5 samples/s | 107.6 steps/s
[Step=24300 Epoch=93.1] | Loss=0.00187 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.077 | L2-Norm(final)=7.999 | 1946.5 samples/s | 30.4 steps/s
[Step=24350 Epoch=93.3] | Loss=0.00162 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.088 | L2-Norm(final)=8.007 | 5259.8 samples/s | 82.2 steps/s
[Step=24400 Epoch=93.5] | Loss=0.00143 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.094 | L2-Norm(final)=8.015 | 5350.5 samples/s | 83.6 steps/s
[Step=24450 Epoch=93.7] | Loss=0.00129 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.096 | L2-Norm(final)=8.022 | 5348.4 samples/s | 83.6 steps/s
[Step=24500 Epoch=93.9] | Loss=0.00117 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.095 | L2-Norm(final)=8.028 | 5918.4 samples/s | 92.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=93.9] | Loss=0.00002 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.079 | L2-Norm(final)=8.094 | 3738.7 samples/s | 58.4 steps/s
[Step=24550 Epoch=94.1] | Loss=0.00006 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.062 | L2-Norm(final)=8.098 | 4677.6 samples/s | 73.1 steps/s
[Step=24600 Epoch=94.3] | Loss=0.00204 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.049 | L2-Norm(final)=8.101 | 4746.4 samples/s | 74.2 steps/s
[Step=24650 Epoch=94.5] | Loss=0.00727 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.138 | L2-Norm(final)=8.080 | 4862.2 samples/s | 76.0 steps/s
[Step=24700 Epoch=94.6] | Loss=0.00743 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.230 | L2-Norm(final)=8.056 | 4755.1 samples/s | 74.3 steps/s
[Step=24750 Epoch=94.8] | Loss=0.00648 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.289 | L2-Norm(final)=8.041 | 6019.0 samples/s | 94.0 steps/s
[Step=24800 Epoch=95.0] | Loss=0.00559 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.327 | L2-Norm(final)=8.032 | 1871.6 samples/s | 29.2 steps/s
[Step=24850 Epoch=95.2] | Loss=0.00481 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.352 | L2-Norm(final)=8.027 | 4752.9 samples/s | 74.3 steps/s
[Step=24900 Epoch=95.4] | Loss=0.00423 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.367 | L2-Norm(final)=8.023 | 4771.9 samples/s | 74.6 steps/s
[Step=24950 Epoch=95.6] | Loss=0.00377 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.377 | L2-Norm(final)=8.020 | 4787.6 samples/s | 74.8 steps/s
[Step=25000 Epoch=95.8] | Loss=0.00341 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.383 | L2-Norm(final)=8.018 | 5299.3 samples/s | 82.8 steps/s
[Step=25050 Epoch=96.0] | Loss=0.00310 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.386 | L2-Norm(final)=8.017 | 1971.0 samples/s | 30.8 steps/s
[Step=25100 Epoch=96.2] | Loss=0.00284 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.386 | L2-Norm(final)=8.016 | 4807.8 samples/s | 75.1 steps/s
[Step=25150 Epoch=96.4] | Loss=0.00262 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.384 | L2-Norm(final)=8.015 | 4751.2 samples/s | 74.2 steps/s
[Step=25200 Epoch=96.6] | Loss=0.00244 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.382 | L2-Norm(final)=8.015 | 4828.6 samples/s | 75.4 steps/s
[Step=25250 Epoch=96.7] | Loss=0.00228 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.377 | L2-Norm(final)=8.014 | 4875.2 samples/s | 76.2 steps/s
[Step=25300 Epoch=96.9] | Loss=0.00213 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.372 | L2-Norm(final)=8.014 | 2011.2 samples/s | 31.4 steps/s
[Step=25350 Epoch=97.1] | Loss=0.00201 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.366 | L2-Norm(final)=8.014 | 4826.8 samples/s | 75.4 steps/s
[Step=25400 Epoch=97.3] | Loss=0.00190 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.360 | L2-Norm(final)=8.014 | 4785.0 samples/s | 74.8 steps/s
[Step=25450 Epoch=97.5] | Loss=0.00180 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.352 | L2-Norm(final)=8.014 | 4819.8 samples/s | 75.3 steps/s
[Step=25500 Epoch=97.7] | Loss=0.00171 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.345 | L2-Norm(final)=8.014 | 4799.7 samples/s | 75.0 steps/s
[Step=25550 Epoch=97.9] | Loss=0.00163 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.336 | L2-Norm(final)=8.014 | 2046.4 samples/s | 32.0 steps/s
[Step=25600 Epoch=98.1] | Loss=0.00155 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.328 | L2-Norm(final)=8.014 | 4838.7 samples/s | 75.6 steps/s
[Step=25650 Epoch=98.3] | Loss=0.00149 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.319 | L2-Norm(final)=8.014 | 4675.6 samples/s | 73.1 steps/s
[Step=25700 Epoch=98.5] | Loss=0.00143 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.310 | L2-Norm(final)=8.014 | 4774.2 samples/s | 74.6 steps/s
[Step=25750 Epoch=98.7] | Loss=0.00137 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.300 | L2-Norm(final)=8.014 | 4749.0 samples/s | 74.2 steps/s
[Step=25800 Epoch=98.9] | Loss=0.00132 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.290 | L2-Norm(final)=8.014 | 6404.9 samples/s | 100.1 steps/s
[Step=25850 Epoch=99.0] | Loss=0.00127 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.280 | L2-Norm(final)=8.015 | 1819.0 samples/s | 28.4 steps/s
[Step=25900 Epoch=99.2] | Loss=0.00122 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.270 | L2-Norm(final)=8.015 | 4838.3 samples/s | 75.6 steps/s
[Step=25950 Epoch=99.4] | Loss=0.00118 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.259 | L2-Norm(final)=8.015 | 4776.4 samples/s | 74.6 steps/s
[Step=26000 Epoch=99.6] | Loss=0.00114 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.248 | L2-Norm(final)=8.016 | 4897.8 samples/s | 76.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step26000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06407 | acc=0.9659 | tpr=0.9719 | fpr=0.0471 | 4457.3 samples/s | 17.4 steps/s
Avg test loss: 0.06507, Avg test acc: 0.96514, Avg tpr: 0.97086, Avg fpr: 0.04743, total FA: 370

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06271 | acc=0.9670 | tpr=0.9779 | fpr=0.0565 | 4411.7 samples/s | 17.2 steps/s
Avg test loss: 0.06886, Avg test acc: 0.96558, Avg tpr: 0.97645, Avg fpr: 0.05833, total FA: 455

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.27908 | acc=0.3152 | tpr=0.0164 | fpr=0.0359 | 4499.0 samples/s | 17.6 steps/s
Avg test loss: 5.29860, Avg test acc: 0.31385, Avg tpr: 0.01766, Avg fpr: 0.03474, total FA: 271

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.18709 | acc=0.3109 | tpr=0.0390 | fpr=0.0986 | 4435.3 samples/s | 17.3 steps/s
Avg test loss: 5.18479, Avg test acc: 0.31064, Avg tpr: 0.04010, Avg fpr: 0.09435, total FA: 736

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.14914 | acc=0.1165 | tpr=0.6327 | fpr=0.8928 | 4440.2 samples/s | 17.3 steps/s
[Step= 100] | Loss=5.12178 | acc=0.1158 | tpr=0.6077 | fpr=0.8934 | 9050.2 samples/s | 35.4 steps/s
[Step= 150] | Loss=5.12773 | acc=0.1151 | tpr=0.5850 | fpr=0.8936 | 8680.8 samples/s | 33.9 steps/s
[Step= 200] | Loss=5.12293 | acc=0.1149 | tpr=0.5825 | fpr=0.8936 | 8844.0 samples/s | 34.5 steps/s
[Step= 250] | Loss=5.12169 | acc=0.1157 | tpr=0.5895 | fpr=0.8930 | 8920.5 samples/s | 34.8 steps/s
[Step= 300] | Loss=5.11902 | acc=0.1161 | tpr=0.6015 | fpr=0.8928 | 8580.8 samples/s | 33.5 steps/s
[Step= 350] | Loss=5.11606 | acc=0.1155 | tpr=0.5992 | fpr=0.8932 | 8967.7 samples/s | 35.0 steps/s
[Step= 400] | Loss=5.11125 | acc=0.1160 | tpr=0.5985 | fpr=0.8928 | 8564.0 samples/s | 33.5 steps/s
[Step= 450] | Loss=5.11811 | acc=0.1160 | tpr=0.5949 | fpr=0.8927 | 8909.2 samples/s | 34.8 steps/s
[Step= 500] | Loss=5.12306 | acc=0.1160 | tpr=0.5943 | fpr=0.8927 | 9087.9 samples/s | 35.5 steps/s
[Step= 550] | Loss=5.12629 | acc=0.1159 | tpr=0.5937 | fpr=0.8928 | 15293.4 samples/s | 59.7 steps/s
Avg test loss: 5.12786, Avg test acc: 0.11589, Avg tpr: 0.59509, Avg fpr: 0.89283, total FA: 123967

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.12505 | acc=0.1116 | tpr=0.6726 | fpr=0.8985 | 4496.5 samples/s | 17.6 steps/s
[Step= 100] | Loss=6.09420 | acc=0.1121 | tpr=0.6461 | fpr=0.8978 | 8576.2 samples/s | 33.5 steps/s
[Step= 150] | Loss=6.12264 | acc=0.1118 | tpr=0.6398 | fpr=0.8979 | 9253.7 samples/s | 36.1 steps/s
[Step= 200] | Loss=6.11519 | acc=0.1112 | tpr=0.6404 | fpr=0.8985 | 8584.4 samples/s | 33.5 steps/s
[Step= 250] | Loss=6.11771 | acc=0.1114 | tpr=0.6445 | fpr=0.8984 | 8844.7 samples/s | 34.5 steps/s
[Step= 300] | Loss=6.11408 | acc=0.1116 | tpr=0.6465 | fpr=0.8982 | 8669.6 samples/s | 33.9 steps/s
[Step= 350] | Loss=6.10982 | acc=0.1112 | tpr=0.6412 | fpr=0.8984 | 8808.1 samples/s | 34.4 steps/s
[Step= 400] | Loss=6.11130 | acc=0.1113 | tpr=0.6395 | fpr=0.8983 | 8891.3 samples/s | 34.7 steps/s
[Step= 450] | Loss=6.12145 | acc=0.1109 | tpr=0.6373 | fpr=0.8987 | 8662.4 samples/s | 33.8 steps/s
[Step= 500] | Loss=6.12618 | acc=0.1109 | tpr=0.6392 | fpr=0.8987 | 8917.9 samples/s | 34.8 steps/s
[Step= 550] | Loss=6.13017 | acc=0.1109 | tpr=0.6387 | fpr=0.8987 | 15572.8 samples/s | 60.8 steps/s
Avg test loss: 6.13083, Avg test acc: 0.11080, Avg tpr: 0.63986, Avg fpr: 0.89882, total FA: 124799

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11130 | acc=0.9816 | tpr=0.9292 | fpr=0.0174 | 4474.2 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.11876 | acc=0.9807 | tpr=0.9403 | fpr=0.0186 | 8615.3 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.12406 | acc=0.9800 | tpr=0.9438 | fpr=0.0194 | 8734.0 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.12627 | acc=0.9801 | tpr=0.9410 | fpr=0.0192 | 8978.2 samples/s | 35.1 steps/s
[Step= 250] | Loss=0.12450 | acc=0.9803 | tpr=0.9415 | fpr=0.0190 | 9005.7 samples/s | 35.2 steps/s
[Step= 300] | Loss=0.12676 | acc=0.9799 | tpr=0.9425 | fpr=0.0194 | 8680.7 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.12770 | acc=0.9797 | tpr=0.9430 | fpr=0.0196 | 9040.7 samples/s | 35.3 steps/s
[Step= 400] | Loss=0.12928 | acc=0.9794 | tpr=0.9398 | fpr=0.0199 | 8363.0 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.13200 | acc=0.9791 | tpr=0.9382 | fpr=0.0202 | 8625.3 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.13119 | acc=0.9792 | tpr=0.9388 | fpr=0.0200 | 9078.9 samples/s | 35.5 steps/s
[Step= 550] | Loss=0.13046 | acc=0.9794 | tpr=0.9371 | fpr=0.0199 | 15053.4 samples/s | 58.8 steps/s
Avg test loss: 0.13013, Avg test acc: 0.97940, Avg tpr: 0.93740, Avg fpr: 0.01983, total FA: 2754

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12598 | acc=0.9790 | tpr=0.9425 | fpr=0.0204 | 4471.0 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.13453 | acc=0.9786 | tpr=0.9467 | fpr=0.0209 | 8663.3 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.14006 | acc=0.9774 | tpr=0.9496 | fpr=0.0220 | 8661.1 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.13991 | acc=0.9776 | tpr=0.9530 | fpr=0.0219 | 8757.5 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.13792 | acc=0.9778 | tpr=0.9528 | fpr=0.0217 | 8746.7 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.13993 | acc=0.9777 | tpr=0.9498 | fpr=0.0218 | 8795.6 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.14117 | acc=0.9775 | tpr=0.9524 | fpr=0.0220 | 8702.5 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.14211 | acc=0.9773 | tpr=0.9519 | fpr=0.0222 | 9382.3 samples/s | 36.6 steps/s
[Step= 450] | Loss=0.14516 | acc=0.9769 | tpr=0.9494 | fpr=0.0226 | 8261.1 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.14451 | acc=0.9770 | tpr=0.9498 | fpr=0.0225 | 8770.8 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.14377 | acc=0.9770 | tpr=0.9467 | fpr=0.0224 | 16421.8 samples/s | 64.1 steps/s
Avg test loss: 0.14339, Avg test acc: 0.97703, Avg tpr: 0.94691, Avg fpr: 0.02242, total FA: 3113

server round 20/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=16001 Epoch=31.2] | Loss=0.01004 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.727 | L2-Norm(final)=5.901 | 3725.8 samples/s | 58.2 steps/s
[Step=16050 Epoch=31.3] | Loss=0.02486 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.739 | L2-Norm(final)=5.909 | 5527.1 samples/s | 86.4 steps/s
[Step=16100 Epoch=31.4] | Loss=0.02310 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.753 | L2-Norm(final)=5.918 | 5633.3 samples/s | 88.0 steps/s
[Step=16150 Epoch=31.5] | Loss=0.02315 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.765 | L2-Norm(final)=5.929 | 5575.8 samples/s | 87.1 steps/s
[Step=16200 Epoch=31.6] | Loss=0.02304 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.777 | L2-Norm(final)=5.938 | 5666.1 samples/s | 88.5 steps/s
[Step=16250 Epoch=31.7] | Loss=0.02260 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.788 | L2-Norm(final)=5.948 | 5719.3 samples/s | 89.4 steps/s
[Step=16300 Epoch=31.8] | Loss=0.02247 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.800 | L2-Norm(final)=5.958 | 5581.0 samples/s | 87.2 steps/s
[Step=16350 Epoch=31.9] | Loss=0.02210 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.811 | L2-Norm(final)=5.969 | 5738.3 samples/s | 89.7 steps/s
[Step=16400 Epoch=32.0] | Loss=0.02129 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.822 | L2-Norm(final)=5.980 | 5626.9 samples/s | 87.9 steps/s
[Step=16450 Epoch=32.1] | Loss=0.02101 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.833 | L2-Norm(final)=5.992 | 5677.7 samples/s | 88.7 steps/s
[Step=16500 Epoch=32.2] | Loss=0.02071 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.844 | L2-Norm(final)=6.003 | 7135.8 samples/s | 111.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=16501 Epoch=32.2] | Loss=0.04348 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.957 | L2-Norm(final)=6.112 | 3459.0 samples/s | 54.0 steps/s
[Step=16550 Epoch=32.3] | Loss=0.01901 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.969 | L2-Norm(final)=6.121 | 4982.2 samples/s | 77.8 steps/s
[Step=16600 Epoch=32.4] | Loss=0.01705 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.979 | L2-Norm(final)=6.124 | 5119.9 samples/s | 80.0 steps/s
[Step=16650 Epoch=32.5] | Loss=0.01641 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.987 | L2-Norm(final)=6.128 | 4989.8 samples/s | 78.0 steps/s
[Step=16700 Epoch=32.6] | Loss=0.01629 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.995 | L2-Norm(final)=6.131 | 5022.1 samples/s | 78.5 steps/s
[Step=16750 Epoch=32.7] | Loss=0.01532 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.001 | L2-Norm(final)=6.133 | 5017.4 samples/s | 78.4 steps/s
[Step=16800 Epoch=32.8] | Loss=0.01531 | Reg=0.00196 | acc=0.9688 | L2-Norm=14.007 | L2-Norm(final)=6.136 | 5051.1 samples/s | 78.9 steps/s
[Step=16850 Epoch=32.9] | Loss=0.01520 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.012 | L2-Norm(final)=6.138 | 5115.1 samples/s | 79.9 steps/s
[Step=16900 Epoch=33.0] | Loss=0.01536 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.017 | L2-Norm(final)=6.140 | 5013.3 samples/s | 78.3 steps/s
[Step=16950 Epoch=33.1] | Loss=0.01521 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.022 | L2-Norm(final)=6.141 | 5037.5 samples/s | 78.7 steps/s
[Step=17000 Epoch=33.2] | Loss=0.01533 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.027 | L2-Norm(final)=6.143 | 6176.5 samples/s | 96.5 steps/s
[Step=17050 Epoch=33.3] | Loss=0.01492 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.032 | L2-Norm(final)=6.145 | 1848.7 samples/s | 28.9 steps/s
[Step=17100 Epoch=33.4] | Loss=0.01461 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.036 | L2-Norm(final)=6.147 | 5074.1 samples/s | 79.3 steps/s
[Step=17150 Epoch=33.4] | Loss=0.01430 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.041 | L2-Norm(final)=6.150 | 5042.4 samples/s | 78.8 steps/s
[Step=17200 Epoch=33.5] | Loss=0.01390 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.045 | L2-Norm(final)=6.152 | 4995.4 samples/s | 78.1 steps/s
[Step=17250 Epoch=33.6] | Loss=0.01368 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.049 | L2-Norm(final)=6.155 | 4964.4 samples/s | 77.6 steps/s
[Step=17300 Epoch=33.7] | Loss=0.01346 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.053 | L2-Norm(final)=6.158 | 5063.2 samples/s | 79.1 steps/s
[Step=17350 Epoch=33.8] | Loss=0.01323 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.056 | L2-Norm(final)=6.160 | 4971.5 samples/s | 77.7 steps/s
[Step=17400 Epoch=33.9] | Loss=0.01311 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.060 | L2-Norm(final)=6.162 | 5066.6 samples/s | 79.2 steps/s
[Step=17450 Epoch=34.0] | Loss=0.01285 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.063 | L2-Norm(final)=6.165 | 5043.8 samples/s | 78.8 steps/s
[Step=17500 Epoch=34.1] | Loss=0.01269 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.066 | L2-Norm(final)=6.167 | 5361.0 samples/s | 83.8 steps/s
[Step=17550 Epoch=34.2] | Loss=0.01244 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.069 | L2-Norm(final)=6.170 | 1960.1 samples/s | 30.6 steps/s
[Step=17600 Epoch=34.3] | Loss=0.01227 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.073 | L2-Norm(final)=6.172 | 5045.1 samples/s | 78.8 steps/s
[Step=17650 Epoch=34.4] | Loss=0.01215 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.076 | L2-Norm(final)=6.175 | 5078.3 samples/s | 79.3 steps/s
[Step=17700 Epoch=34.5] | Loss=0.01206 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.079 | L2-Norm(final)=6.177 | 5013.5 samples/s | 78.3 steps/s
[Step=17750 Epoch=34.6] | Loss=0.01190 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.082 | L2-Norm(final)=6.179 | 5045.9 samples/s | 78.8 steps/s
[Step=17800 Epoch=34.7] | Loss=0.01182 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.085 | L2-Norm(final)=6.182 | 5036.9 samples/s | 78.7 steps/s
[Step=17850 Epoch=34.8] | Loss=0.01168 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.087 | L2-Norm(final)=6.184 | 5060.3 samples/s | 79.1 steps/s
[Step=17900 Epoch=34.9] | Loss=0.01158 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.090 | L2-Norm(final)=6.186 | 5074.4 samples/s | 79.3 steps/s
[Step=17950 Epoch=35.0] | Loss=0.01150 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=6.188 | 5098.0 samples/s | 79.7 steps/s
[Step=18000 Epoch=35.1] | Loss=0.01148 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.095 | L2-Norm(final)=6.190 | 5016.2 samples/s | 78.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step18000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=26001 Epoch=99.6] | Loss=0.00159 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.727 | L2-Norm(final)=8.027 | 3852.1 samples/s | 60.2 steps/s
[Step=26050 Epoch=99.8] | Loss=0.00070 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.724 | L2-Norm(final)=8.038 | 5101.8 samples/s | 79.7 steps/s
[Step=26100 Epoch=100.0] | Loss=0.00062 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.724 | L2-Norm(final)=8.048 | 5372.4 samples/s | 83.9 steps/s
[Step=26150 Epoch=100.2] | Loss=0.00059 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.725 | L2-Norm(final)=8.056 | 5360.4 samples/s | 83.8 steps/s
[Step=26200 Epoch=100.4] | Loss=0.00054 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.725 | L2-Norm(final)=8.063 | 5315.6 samples/s | 83.1 steps/s
[Step=26250 Epoch=100.6] | Loss=0.00049 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.726 | L2-Norm(final)=8.071 | 6914.3 samples/s | 108.0 steps/s
[Step=26300 Epoch=100.8] | Loss=0.00044 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.725 | L2-Norm(final)=8.078 | 1944.6 samples/s | 30.4 steps/s
[Step=26350 Epoch=101.0] | Loss=0.00039 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.724 | L2-Norm(final)=8.085 | 5254.6 samples/s | 82.1 steps/s
[Step=26400 Epoch=101.2] | Loss=0.00036 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.722 | L2-Norm(final)=8.090 | 5309.5 samples/s | 83.0 steps/s
[Step=26450 Epoch=101.3] | Loss=0.00034 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.719 | L2-Norm(final)=8.096 | 5395.0 samples/s | 84.3 steps/s
[Step=26500 Epoch=101.5] | Loss=0.00032 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.717 | L2-Norm(final)=8.101 | 5953.2 samples/s | 93.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=101.5] | Loss=0.00005 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.692 | L2-Norm(final)=8.156 | 3646.8 samples/s | 57.0 steps/s
[Step=26550 Epoch=101.7] | Loss=0.00011 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.686 | L2-Norm(final)=8.160 | 4756.2 samples/s | 74.3 steps/s
[Step=26600 Epoch=101.9] | Loss=0.00010 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.680 | L2-Norm(final)=8.165 | 4841.1 samples/s | 75.6 steps/s
[Step=26650 Epoch=102.1] | Loss=0.00008 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.673 | L2-Norm(final)=8.169 | 4737.7 samples/s | 74.0 steps/s
[Step=26700 Epoch=102.3] | Loss=0.00007 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.665 | L2-Norm(final)=8.172 | 4839.8 samples/s | 75.6 steps/s
[Step=26750 Epoch=102.5] | Loss=0.00006 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.657 | L2-Norm(final)=8.175 | 5924.9 samples/s | 92.6 steps/s
[Step=26800 Epoch=102.7] | Loss=0.00005 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.648 | L2-Norm(final)=8.177 | 1884.2 samples/s | 29.4 steps/s
[Step=26850 Epoch=102.9] | Loss=0.00005 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.639 | L2-Norm(final)=8.179 | 4762.9 samples/s | 74.4 steps/s
[Step=26900 Epoch=103.1] | Loss=0.00004 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.631 | L2-Norm(final)=8.181 | 4806.0 samples/s | 75.1 steps/s
[Step=26950 Epoch=103.3] | Loss=0.00004 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.621 | L2-Norm(final)=8.183 | 4807.1 samples/s | 75.1 steps/s
[Step=27000 Epoch=103.5] | Loss=0.00004 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.612 | L2-Norm(final)=8.184 | 5327.3 samples/s | 83.2 steps/s
[Step=27050 Epoch=103.6] | Loss=0.00004 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.603 | L2-Norm(final)=8.186 | 1938.5 samples/s | 30.3 steps/s
[Step=27100 Epoch=103.8] | Loss=0.00003 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.594 | L2-Norm(final)=8.187 | 4808.5 samples/s | 75.1 steps/s
[Step=27150 Epoch=104.0] | Loss=0.00003 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.584 | L2-Norm(final)=8.189 | 4826.5 samples/s | 75.4 steps/s
[Step=27200 Epoch=104.2] | Loss=0.00003 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.574 | L2-Norm(final)=8.190 | 4794.5 samples/s | 74.9 steps/s
[Step=27250 Epoch=104.4] | Loss=0.00003 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.565 | L2-Norm(final)=8.191 | 4720.1 samples/s | 73.8 steps/s
[Step=27300 Epoch=104.6] | Loss=0.00003 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.555 | L2-Norm(final)=8.193 | 2028.2 samples/s | 31.7 steps/s
[Step=27350 Epoch=104.8] | Loss=0.00003 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.545 | L2-Norm(final)=8.194 | 4816.9 samples/s | 75.3 steps/s
[Step=27400 Epoch=105.0] | Loss=0.00003 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.535 | L2-Norm(final)=8.195 | 4797.3 samples/s | 75.0 steps/s
[Step=27450 Epoch=105.2] | Loss=0.00003 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=8.196 | 4832.8 samples/s | 75.5 steps/s
[Step=27500 Epoch=105.4] | Loss=0.00002 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.514 | L2-Norm(final)=8.197 | 4733.3 samples/s | 74.0 steps/s
[Step=27550 Epoch=105.6] | Loss=0.00002 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.504 | L2-Norm(final)=8.199 | 2022.0 samples/s | 31.6 steps/s
[Step=27600 Epoch=105.8] | Loss=0.00002 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.494 | L2-Norm(final)=8.200 | 4998.7 samples/s | 78.1 steps/s
[Step=27650 Epoch=105.9] | Loss=0.00002 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.483 | L2-Norm(final)=8.201 | 4754.4 samples/s | 74.3 steps/s
[Step=27700 Epoch=106.1] | Loss=0.00002 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.472 | L2-Norm(final)=8.202 | 4734.1 samples/s | 74.0 steps/s
[Step=27750 Epoch=106.3] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.462 | L2-Norm(final)=8.203 | 4737.8 samples/s | 74.0 steps/s
[Step=27800 Epoch=106.5] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.451 | L2-Norm(final)=8.204 | 6499.0 samples/s | 101.5 steps/s
[Step=27850 Epoch=106.7] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.440 | L2-Norm(final)=8.205 | 1830.2 samples/s | 28.6 steps/s
[Step=27900 Epoch=106.9] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.429 | L2-Norm(final)=8.206 | 4875.8 samples/s | 76.2 steps/s
[Step=27950 Epoch=107.1] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.418 | L2-Norm(final)=8.207 | 4695.2 samples/s | 73.4 steps/s
[Step=28000 Epoch=107.3] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.406 | L2-Norm(final)=8.208 | 4831.1 samples/s | 75.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05757 | acc=0.9695 | tpr=0.9755 | fpr=0.0434 | 4435.8 samples/s | 17.3 steps/s
Avg test loss: 0.05982, Avg test acc: 0.96843, Avg tpr: 0.97406, Avg fpr: 0.04397, total FA: 343

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06271 | acc=0.9670 | tpr=0.9779 | fpr=0.0565 | 4430.4 samples/s | 17.3 steps/s
Avg test loss: 0.06886, Avg test acc: 0.96558, Avg tpr: 0.97645, Avg fpr: 0.05833, total FA: 455

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.74335 | acc=0.3236 | tpr=0.0438 | fpr=0.0689 | 4450.9 samples/s | 17.4 steps/s
Avg test loss: 4.74725, Avg test acc: 0.32058, Avg tpr: 0.04348, Avg fpr: 0.06999, total FA: 546

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.18709 | acc=0.3109 | tpr=0.0390 | fpr=0.0986 | 4470.5 samples/s | 17.5 steps/s
Avg test loss: 5.18479, Avg test acc: 0.31064, Avg tpr: 0.04010, Avg fpr: 0.09435, total FA: 736

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.19349 | acc=0.1255 | tpr=0.5752 | fpr=0.8826 | 4394.9 samples/s | 17.2 steps/s
[Step= 100] | Loss=5.17107 | acc=0.1248 | tpr=0.5501 | fpr=0.8832 | 9234.2 samples/s | 36.1 steps/s
[Step= 150] | Loss=5.17675 | acc=0.1238 | tpr=0.5403 | fpr=0.8838 | 8412.1 samples/s | 32.9 steps/s
[Step= 200] | Loss=5.17087 | acc=0.1242 | tpr=0.5344 | fpr=0.8833 | 8851.0 samples/s | 34.6 steps/s
[Step= 250] | Loss=5.16823 | acc=0.1246 | tpr=0.5441 | fpr=0.8830 | 8685.2 samples/s | 33.9 steps/s
[Step= 300] | Loss=5.16463 | acc=0.1251 | tpr=0.5505 | fpr=0.8827 | 9021.8 samples/s | 35.2 steps/s
[Step= 350] | Loss=5.16165 | acc=0.1247 | tpr=0.5510 | fpr=0.8830 | 8983.2 samples/s | 35.1 steps/s
[Step= 400] | Loss=5.15911 | acc=0.1252 | tpr=0.5536 | fpr=0.8826 | 8638.4 samples/s | 33.7 steps/s
[Step= 450] | Loss=5.16736 | acc=0.1247 | tpr=0.5487 | fpr=0.8830 | 8603.1 samples/s | 33.6 steps/s
[Step= 500] | Loss=5.17220 | acc=0.1244 | tpr=0.5476 | fpr=0.8833 | 9101.6 samples/s | 35.6 steps/s
[Step= 550] | Loss=5.17611 | acc=0.1244 | tpr=0.5464 | fpr=0.8833 | 15322.9 samples/s | 59.9 steps/s
Avg test loss: 5.17719, Avg test acc: 0.12427, Avg tpr: 0.54715, Avg fpr: 0.88342, total FA: 122661

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.12505 | acc=0.1116 | tpr=0.6726 | fpr=0.8985 | 4438.0 samples/s | 17.3 steps/s
[Step= 100] | Loss=6.09420 | acc=0.1121 | tpr=0.6461 | fpr=0.8978 | 8830.2 samples/s | 34.5 steps/s
[Step= 150] | Loss=6.12264 | acc=0.1118 | tpr=0.6398 | fpr=0.8979 | 8839.1 samples/s | 34.5 steps/s
[Step= 200] | Loss=6.11519 | acc=0.1112 | tpr=0.6404 | fpr=0.8985 | 9483.1 samples/s | 37.0 steps/s
[Step= 250] | Loss=6.11771 | acc=0.1114 | tpr=0.6445 | fpr=0.8984 | 8408.4 samples/s | 32.8 steps/s
[Step= 300] | Loss=6.11408 | acc=0.1116 | tpr=0.6465 | fpr=0.8982 | 9008.8 samples/s | 35.2 steps/s
[Step= 350] | Loss=6.10982 | acc=0.1112 | tpr=0.6412 | fpr=0.8984 | 8360.8 samples/s | 32.7 steps/s
[Step= 400] | Loss=6.11130 | acc=0.1113 | tpr=0.6395 | fpr=0.8983 | 8894.7 samples/s | 34.7 steps/s
[Step= 450] | Loss=6.12145 | acc=0.1109 | tpr=0.6373 | fpr=0.8987 | 9178.8 samples/s | 35.9 steps/s
[Step= 500] | Loss=6.12618 | acc=0.1109 | tpr=0.6392 | fpr=0.8987 | 8632.2 samples/s | 33.7 steps/s
[Step= 550] | Loss=6.13017 | acc=0.1109 | tpr=0.6387 | fpr=0.8987 | 15839.0 samples/s | 61.9 steps/s
Avg test loss: 6.13083, Avg test acc: 0.11080, Avg tpr: 0.63986, Avg fpr: 0.89882, total FA: 124799

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12718 | acc=0.9807 | tpr=0.9513 | fpr=0.0188 | 4538.0 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.13528 | acc=0.9798 | tpr=0.9510 | fpr=0.0197 | 8331.8 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.14110 | acc=0.9786 | tpr=0.9539 | fpr=0.0209 | 8816.3 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.14080 | acc=0.9790 | tpr=0.9530 | fpr=0.0206 | 8722.7 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.13887 | acc=0.9792 | tpr=0.9493 | fpr=0.0203 | 9271.9 samples/s | 36.2 steps/s
[Step= 300] | Loss=0.14112 | acc=0.9789 | tpr=0.9469 | fpr=0.0205 | 8619.1 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.14228 | acc=0.9787 | tpr=0.9474 | fpr=0.0207 | 8700.4 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.14329 | acc=0.9785 | tpr=0.9447 | fpr=0.0209 | 8540.9 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.14628 | acc=0.9782 | tpr=0.9426 | fpr=0.0211 | 9000.0 samples/s | 35.2 steps/s
[Step= 500] | Loss=0.14579 | acc=0.9784 | tpr=0.9436 | fpr=0.0210 | 8504.8 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.14517 | acc=0.9784 | tpr=0.9407 | fpr=0.0209 | 15933.2 samples/s | 62.2 steps/s
Avg test loss: 0.14474, Avg test acc: 0.97841, Avg tpr: 0.94097, Avg fpr: 0.02091, total FA: 2903

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12598 | acc=0.9790 | tpr=0.9425 | fpr=0.0204 | 4435.6 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.13453 | acc=0.9786 | tpr=0.9467 | fpr=0.0209 | 8874.4 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.14006 | acc=0.9774 | tpr=0.9496 | fpr=0.0220 | 8926.5 samples/s | 34.9 steps/s
[Step= 200] | Loss=0.13991 | acc=0.9776 | tpr=0.9530 | fpr=0.0219 | 8815.2 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.13792 | acc=0.9778 | tpr=0.9528 | fpr=0.0217 | 8655.4 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.13993 | acc=0.9777 | tpr=0.9498 | fpr=0.0218 | 8877.0 samples/s | 34.7 steps/s
[Step= 350] | Loss=0.14117 | acc=0.9775 | tpr=0.9524 | fpr=0.0220 | 8777.4 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.14211 | acc=0.9773 | tpr=0.9519 | fpr=0.0222 | 8746.6 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.14516 | acc=0.9769 | tpr=0.9494 | fpr=0.0226 | 9180.6 samples/s | 35.9 steps/s
[Step= 500] | Loss=0.14451 | acc=0.9770 | tpr=0.9498 | fpr=0.0225 | 8433.3 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.14377 | acc=0.9770 | tpr=0.9467 | fpr=0.0224 | 15875.3 samples/s | 62.0 steps/s
Avg test loss: 0.14339, Avg test acc: 0.97703, Avg tpr: 0.94691, Avg fpr: 0.02242, total FA: 3113

server round 21/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=28001 Epoch=107.3] | Loss=0.00029 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.555 | L2-Norm(final)=8.237 | 3755.6 samples/s | 58.7 steps/s
[Step=28050 Epoch=107.5] | Loss=0.00225 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.573 | L2-Norm(final)=8.246 | 5226.1 samples/s | 81.7 steps/s
[Step=28100 Epoch=107.7] | Loss=0.00153 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.597 | L2-Norm(final)=8.261 | 5412.7 samples/s | 84.6 steps/s
[Step=28150 Epoch=107.9] | Loss=0.00147 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.616 | L2-Norm(final)=8.271 | 5300.2 samples/s | 82.8 steps/s
[Step=28200 Epoch=108.1] | Loss=0.00121 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.631 | L2-Norm(final)=8.280 | 5281.1 samples/s | 82.5 steps/s
[Step=28250 Epoch=108.2] | Loss=0.00101 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.640 | L2-Norm(final)=8.288 | 6966.6 samples/s | 108.9 steps/s
[Step=28300 Epoch=108.4] | Loss=0.00095 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.646 | L2-Norm(final)=8.295 | 1927.3 samples/s | 30.1 steps/s
[Step=28350 Epoch=108.6] | Loss=0.00083 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.651 | L2-Norm(final)=8.302 | 5396.7 samples/s | 84.3 steps/s
[Step=28400 Epoch=108.8] | Loss=0.00075 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.653 | L2-Norm(final)=8.308 | 5265.9 samples/s | 82.3 steps/s
[Step=28450 Epoch=109.0] | Loss=0.00067 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.654 | L2-Norm(final)=8.313 | 5466.4 samples/s | 85.4 steps/s
[Step=28500 Epoch=109.2] | Loss=0.00062 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.654 | L2-Norm(final)=8.318 | 5859.5 samples/s | 91.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=109.2] | Loss=0.00002 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.647 | L2-Norm(final)=8.367 | 3914.6 samples/s | 61.2 steps/s
[Step=28550 Epoch=109.4] | Loss=0.00007 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.638 | L2-Norm(final)=8.370 | 4442.5 samples/s | 69.4 steps/s
[Step=28600 Epoch=109.6] | Loss=0.00009 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.628 | L2-Norm(final)=8.374 | 4804.4 samples/s | 75.1 steps/s
[Step=28650 Epoch=109.8] | Loss=0.00007 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=8.377 | 4826.2 samples/s | 75.4 steps/s
[Step=28700 Epoch=110.0] | Loss=0.00006 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.607 | L2-Norm(final)=8.379 | 4734.0 samples/s | 74.0 steps/s
[Step=28750 Epoch=110.2] | Loss=0.00005 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.596 | L2-Norm(final)=8.381 | 6078.6 samples/s | 95.0 steps/s
[Step=28800 Epoch=110.4] | Loss=0.00005 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.584 | L2-Norm(final)=8.383 | 1862.2 samples/s | 29.1 steps/s
[Step=28850 Epoch=110.5] | Loss=0.00004 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.571 | L2-Norm(final)=8.384 | 4787.8 samples/s | 74.8 steps/s
[Step=28900 Epoch=110.7] | Loss=0.00004 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.559 | L2-Norm(final)=8.385 | 4808.5 samples/s | 75.1 steps/s
[Step=28950 Epoch=110.9] | Loss=0.00003 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.546 | L2-Norm(final)=8.386 | 4790.2 samples/s | 74.8 steps/s
[Step=29000 Epoch=111.1] | Loss=0.00003 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.533 | L2-Norm(final)=8.387 | 5349.8 samples/s | 83.6 steps/s
[Step=29050 Epoch=111.3] | Loss=0.00003 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.519 | L2-Norm(final)=8.387 | 1971.8 samples/s | 30.8 steps/s
[Step=29100 Epoch=111.5] | Loss=0.00003 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.506 | L2-Norm(final)=8.388 | 4691.3 samples/s | 73.3 steps/s
[Step=29150 Epoch=111.7] | Loss=0.00002 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=8.389 | 4815.1 samples/s | 75.2 steps/s
[Step=29200 Epoch=111.9] | Loss=0.00002 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=8.389 | 4751.4 samples/s | 74.2 steps/s
[Step=29250 Epoch=112.1] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.464 | L2-Norm(final)=8.390 | 4736.4 samples/s | 74.0 steps/s
[Step=29300 Epoch=112.3] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.450 | L2-Norm(final)=8.390 | 2030.6 samples/s | 31.7 steps/s
[Step=29350 Epoch=112.5] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.436 | L2-Norm(final)=8.391 | 4804.9 samples/s | 75.1 steps/s
[Step=29400 Epoch=112.7] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.422 | L2-Norm(final)=8.391 | 4822.3 samples/s | 75.3 steps/s
[Step=29450 Epoch=112.8] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.407 | L2-Norm(final)=8.392 | 4838.0 samples/s | 75.6 steps/s
[Step=29500 Epoch=113.0] | Loss=0.00002 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.392 | L2-Norm(final)=8.392 | 4731.2 samples/s | 73.9 steps/s
[Step=29550 Epoch=113.2] | Loss=0.00002 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.378 | L2-Norm(final)=8.392 | 2038.3 samples/s | 31.8 steps/s
[Step=29600 Epoch=113.4] | Loss=0.00002 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=8.393 | 4738.6 samples/s | 74.0 steps/s
[Step=29650 Epoch=113.6] | Loss=0.00001 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=8.393 | 4793.6 samples/s | 74.9 steps/s
[Step=29700 Epoch=113.8] | Loss=0.00001 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.332 | L2-Norm(final)=8.394 | 4807.7 samples/s | 75.1 steps/s
[Step=29750 Epoch=114.0] | Loss=0.00001 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.317 | L2-Norm(final)=8.394 | 4854.7 samples/s | 75.9 steps/s
[Step=29800 Epoch=114.2] | Loss=0.00001 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.301 | L2-Norm(final)=8.394 | 6448.1 samples/s | 100.8 steps/s
[Step=29850 Epoch=114.4] | Loss=0.00001 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.285 | L2-Norm(final)=8.395 | 1844.9 samples/s | 28.8 steps/s
[Step=29900 Epoch=114.6] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.270 | L2-Norm(final)=8.395 | 4673.3 samples/s | 73.0 steps/s
[Step=29950 Epoch=114.8] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.253 | L2-Norm(final)=8.395 | 4779.8 samples/s | 74.7 steps/s
[Step=30000 Epoch=114.9] | Loss=0.00001 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.237 | L2-Norm(final)=8.396 | 4799.2 samples/s | 75.0 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step30000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=20001 Epoch=77.0] | Loss=0.00059 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.555 | L2-Norm(final)=6.701 | 3937.0 samples/s | 61.5 steps/s
[Step=20050 Epoch=77.2] | Loss=0.00401 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.597 | L2-Norm(final)=6.698 | 4770.4 samples/s | 74.5 steps/s
[Step=20100 Epoch=77.4] | Loss=0.00303 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.630 | L2-Norm(final)=6.696 | 5205.8 samples/s | 81.3 steps/s
[Step=20150 Epoch=77.6] | Loss=0.00237 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.651 | L2-Norm(final)=6.701 | 5383.7 samples/s | 84.1 steps/s
[Step=20200 Epoch=77.8] | Loss=0.00188 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.663 | L2-Norm(final)=6.707 | 5403.3 samples/s | 84.4 steps/s
[Step=20250 Epoch=78.0] | Loss=0.00157 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.670 | L2-Norm(final)=6.713 | 6893.0 samples/s | 107.7 steps/s
[Step=20300 Epoch=78.1] | Loss=0.00136 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.674 | L2-Norm(final)=6.719 | 1911.3 samples/s | 29.9 steps/s
[Step=20350 Epoch=78.3] | Loss=0.00119 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.676 | L2-Norm(final)=6.725 | 5225.4 samples/s | 81.6 steps/s
[Step=20400 Epoch=78.5] | Loss=0.00107 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.677 | L2-Norm(final)=6.731 | 5356.3 samples/s | 83.7 steps/s
[Step=20450 Epoch=78.7] | Loss=0.00097 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.677 | L2-Norm(final)=6.736 | 5400.1 samples/s | 84.4 steps/s
[Step=20500 Epoch=78.9] | Loss=0.00089 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.676 | L2-Norm(final)=6.742 | 5954.1 samples/s | 93.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=78.9] | Loss=0.00003 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.667 | L2-Norm(final)=6.794 | 3812.1 samples/s | 59.6 steps/s
[Step=20550 Epoch=79.1] | Loss=0.00011 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.658 | L2-Norm(final)=6.798 | 4554.0 samples/s | 71.2 steps/s
[Step=20600 Epoch=79.3] | Loss=0.00010 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.648 | L2-Norm(final)=6.802 | 4796.0 samples/s | 74.9 steps/s
[Step=20650 Epoch=79.5] | Loss=0.00009 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.637 | L2-Norm(final)=6.804 | 4762.5 samples/s | 74.4 steps/s
[Step=20700 Epoch=79.7] | Loss=0.00007 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.626 | L2-Norm(final)=6.807 | 4782.9 samples/s | 74.7 steps/s
[Step=20750 Epoch=79.9] | Loss=0.00006 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.614 | L2-Norm(final)=6.808 | 6106.6 samples/s | 95.4 steps/s
[Step=20800 Epoch=80.1] | Loss=0.00005 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.602 | L2-Norm(final)=6.810 | 1859.7 samples/s | 29.1 steps/s
[Step=20850 Epoch=80.3] | Loss=0.00005 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.590 | L2-Norm(final)=6.811 | 4752.9 samples/s | 74.3 steps/s
[Step=20900 Epoch=80.5] | Loss=0.00004 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.577 | L2-Norm(final)=6.812 | 4828.9 samples/s | 75.5 steps/s
[Step=20950 Epoch=80.6] | Loss=0.00004 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.564 | L2-Norm(final)=6.813 | 4812.8 samples/s | 75.2 steps/s
[Step=21000 Epoch=80.8] | Loss=0.00003 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.551 | L2-Norm(final)=6.814 | 5401.9 samples/s | 84.4 steps/s
[Step=21050 Epoch=81.0] | Loss=0.00003 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.537 | L2-Norm(final)=6.814 | 1935.1 samples/s | 30.2 steps/s
[Step=21100 Epoch=81.2] | Loss=0.00003 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.524 | L2-Norm(final)=6.815 | 4809.2 samples/s | 75.1 steps/s
[Step=21150 Epoch=81.4] | Loss=0.00003 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.510 | L2-Norm(final)=6.816 | 4762.9 samples/s | 74.4 steps/s
[Step=21200 Epoch=81.6] | Loss=0.00003 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.496 | L2-Norm(final)=6.816 | 4760.5 samples/s | 74.4 steps/s
[Step=21250 Epoch=81.8] | Loss=0.00002 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.482 | L2-Norm(final)=6.817 | 4862.1 samples/s | 76.0 steps/s
[Step=21300 Epoch=82.0] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.468 | L2-Norm(final)=6.817 | 2022.5 samples/s | 31.6 steps/s
[Step=21350 Epoch=82.2] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.454 | L2-Norm(final)=6.818 | 4868.5 samples/s | 76.1 steps/s
[Step=21400 Epoch=82.4] | Loss=0.00002 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.439 | L2-Norm(final)=6.818 | 4768.4 samples/s | 74.5 steps/s
[Step=21450 Epoch=82.6] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.425 | L2-Norm(final)=6.819 | 4770.1 samples/s | 74.5 steps/s
[Step=21500 Epoch=82.8] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.410 | L2-Norm(final)=6.819 | 4790.7 samples/s | 74.9 steps/s
[Step=21550 Epoch=83.0] | Loss=0.00002 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.395 | L2-Norm(final)=6.820 | 2040.9 samples/s | 31.9 steps/s
[Step=21600 Epoch=83.1] | Loss=0.00002 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=6.820 | 4809.7 samples/s | 75.2 steps/s
[Step=21650 Epoch=83.3] | Loss=0.00002 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.365 | L2-Norm(final)=6.820 | 4708.9 samples/s | 73.6 steps/s
[Step=21700 Epoch=83.5] | Loss=0.00002 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=6.821 | 4876.6 samples/s | 76.2 steps/s
[Step=21750 Epoch=83.7] | Loss=0.00002 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.335 | L2-Norm(final)=6.821 | 4729.9 samples/s | 73.9 steps/s
[Step=21800 Epoch=83.9] | Loss=0.00002 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.319 | L2-Norm(final)=6.822 | 7072.2 samples/s | 110.5 steps/s
[Step=21850 Epoch=84.1] | Loss=0.00002 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.303 | L2-Norm(final)=6.822 | 1786.6 samples/s | 27.9 steps/s
[Step=21900 Epoch=84.3] | Loss=0.00001 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.288 | L2-Norm(final)=6.822 | 4797.4 samples/s | 75.0 steps/s
[Step=21950 Epoch=84.5] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.272 | L2-Norm(final)=6.823 | 4729.7 samples/s | 73.9 steps/s
[Step=22000 Epoch=84.7] | Loss=0.00001 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.256 | L2-Norm(final)=6.823 | 4812.1 samples/s | 75.2 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step22000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05757 | acc=0.9695 | tpr=0.9755 | fpr=0.0434 | 4447.5 samples/s | 17.4 steps/s
Avg test loss: 0.05982, Avg test acc: 0.96843, Avg tpr: 0.97406, Avg fpr: 0.04397, total FA: 343

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06271 | acc=0.9670 | tpr=0.9779 | fpr=0.0565 | 4505.4 samples/s | 17.6 steps/s
Avg test loss: 0.06886, Avg test acc: 0.96558, Avg tpr: 0.97645, Avg fpr: 0.05833, total FA: 455

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.23188 | acc=0.3198 | tpr=0.0430 | fpr=0.0793 | 4486.8 samples/s | 17.5 steps/s
Avg test loss: 5.23735, Avg test acc: 0.31878, Avg tpr: 0.04424, Avg fpr: 0.07743, total FA: 604

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.38011 | acc=0.3132 | tpr=0.0483 | fpr=0.1115 | 4442.4 samples/s | 17.4 steps/s
Avg test loss: 5.37917, Avg test acc: 0.31261, Avg tpr: 0.04954, Avg fpr: 0.10883, total FA: 849

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.19349 | acc=0.1255 | tpr=0.5752 | fpr=0.8826 | 4461.6 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.17107 | acc=0.1248 | tpr=0.5501 | fpr=0.8832 | 8873.7 samples/s | 34.7 steps/s
[Step= 150] | Loss=5.17675 | acc=0.1238 | tpr=0.5403 | fpr=0.8838 | 8712.0 samples/s | 34.0 steps/s
[Step= 200] | Loss=5.17087 | acc=0.1242 | tpr=0.5344 | fpr=0.8833 | 8922.9 samples/s | 34.9 steps/s
[Step= 250] | Loss=5.16823 | acc=0.1246 | tpr=0.5441 | fpr=0.8830 | 9095.6 samples/s | 35.5 steps/s
[Step= 300] | Loss=5.16463 | acc=0.1251 | tpr=0.5505 | fpr=0.8827 | 8756.4 samples/s | 34.2 steps/s
[Step= 350] | Loss=5.16165 | acc=0.1247 | tpr=0.5510 | fpr=0.8830 | 8637.6 samples/s | 33.7 steps/s
[Step= 400] | Loss=5.15911 | acc=0.1252 | tpr=0.5536 | fpr=0.8826 | 8686.8 samples/s | 33.9 steps/s
[Step= 450] | Loss=5.16736 | acc=0.1247 | tpr=0.5487 | fpr=0.8830 | 8634.6 samples/s | 33.7 steps/s
[Step= 500] | Loss=5.17220 | acc=0.1244 | tpr=0.5476 | fpr=0.8833 | 8897.3 samples/s | 34.8 steps/s
[Step= 550] | Loss=5.17611 | acc=0.1244 | tpr=0.5464 | fpr=0.8833 | 15968.0 samples/s | 62.4 steps/s
Avg test loss: 5.17719, Avg test acc: 0.12427, Avg tpr: 0.54715, Avg fpr: 0.88342, total FA: 122661

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.12505 | acc=0.1116 | tpr=0.6726 | fpr=0.8985 | 4483.4 samples/s | 17.5 steps/s
[Step= 100] | Loss=6.09420 | acc=0.1121 | tpr=0.6461 | fpr=0.8978 | 9127.5 samples/s | 35.7 steps/s
[Step= 150] | Loss=6.12264 | acc=0.1118 | tpr=0.6398 | fpr=0.8979 | 8867.7 samples/s | 34.6 steps/s
[Step= 200] | Loss=6.11519 | acc=0.1112 | tpr=0.6404 | fpr=0.8985 | 8529.5 samples/s | 33.3 steps/s
[Step= 250] | Loss=6.11771 | acc=0.1114 | tpr=0.6445 | fpr=0.8984 | 8825.2 samples/s | 34.5 steps/s
[Step= 300] | Loss=6.11408 | acc=0.1116 | tpr=0.6465 | fpr=0.8982 | 8979.4 samples/s | 35.1 steps/s
[Step= 350] | Loss=6.10982 | acc=0.1112 | tpr=0.6412 | fpr=0.8984 | 8490.6 samples/s | 33.2 steps/s
[Step= 400] | Loss=6.11130 | acc=0.1113 | tpr=0.6395 | fpr=0.8983 | 8983.6 samples/s | 35.1 steps/s
[Step= 450] | Loss=6.12145 | acc=0.1109 | tpr=0.6373 | fpr=0.8987 | 8565.4 samples/s | 33.5 steps/s
[Step= 500] | Loss=6.12618 | acc=0.1109 | tpr=0.6392 | fpr=0.8987 | 8971.3 samples/s | 35.0 steps/s
[Step= 550] | Loss=6.13017 | acc=0.1109 | tpr=0.6387 | fpr=0.8987 | 15211.1 samples/s | 59.4 steps/s
Avg test loss: 6.13083, Avg test acc: 0.11080, Avg tpr: 0.63986, Avg fpr: 0.89882, total FA: 124799

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13334 | acc=0.9818 | tpr=0.9469 | fpr=0.0176 | 4488.7 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.14089 | acc=0.9808 | tpr=0.9531 | fpr=0.0187 | 8740.2 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.14710 | acc=0.9796 | tpr=0.9539 | fpr=0.0200 | 8879.9 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.14723 | acc=0.9797 | tpr=0.9519 | fpr=0.0198 | 8862.8 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.14534 | acc=0.9795 | tpr=0.9476 | fpr=0.0199 | 8865.3 samples/s | 34.6 steps/s
[Step= 300] | Loss=0.14766 | acc=0.9794 | tpr=0.9462 | fpr=0.0200 | 8862.2 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.14893 | acc=0.9792 | tpr=0.9474 | fpr=0.0202 | 8488.1 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.14990 | acc=0.9789 | tpr=0.9437 | fpr=0.0204 | 8984.5 samples/s | 35.1 steps/s
[Step= 450] | Loss=0.15306 | acc=0.9786 | tpr=0.9406 | fpr=0.0208 | 8729.6 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.15235 | acc=0.9787 | tpr=0.9405 | fpr=0.0206 | 9026.6 samples/s | 35.3 steps/s
[Step= 550] | Loss=0.15170 | acc=0.9787 | tpr=0.9387 | fpr=0.0205 | 15578.7 samples/s | 60.9 steps/s
Avg test loss: 0.15126, Avg test acc: 0.97875, Avg tpr: 0.93899, Avg fpr: 0.02053, total FA: 2850

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13745 | acc=0.9788 | tpr=0.9425 | fpr=0.0205 | 4518.5 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.14600 | acc=0.9781 | tpr=0.9467 | fpr=0.0213 | 8482.7 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.15050 | acc=0.9771 | tpr=0.9510 | fpr=0.0224 | 8782.7 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.14968 | acc=0.9773 | tpr=0.9530 | fpr=0.0222 | 8863.4 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.14749 | acc=0.9775 | tpr=0.9493 | fpr=0.0220 | 8963.3 samples/s | 35.0 steps/s
[Step= 300] | Loss=0.14998 | acc=0.9773 | tpr=0.9476 | fpr=0.0222 | 8961.4 samples/s | 35.0 steps/s
[Step= 350] | Loss=0.15095 | acc=0.9773 | tpr=0.9499 | fpr=0.0222 | 8504.3 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.15176 | acc=0.9771 | tpr=0.9497 | fpr=0.0224 | 8622.7 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.15498 | acc=0.9768 | tpr=0.9469 | fpr=0.0227 | 9329.8 samples/s | 36.4 steps/s
[Step= 500] | Loss=0.15441 | acc=0.9768 | tpr=0.9471 | fpr=0.0227 | 8411.5 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.15351 | acc=0.9768 | tpr=0.9443 | fpr=0.0226 | 15798.3 samples/s | 61.7 steps/s
Avg test loss: 0.15305, Avg test acc: 0.97683, Avg tpr: 0.94453, Avg fpr: 0.02259, total FA: 3136

server round 22/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=18001 Epoch=35.2] | Loss=0.02147 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.483 | L2-Norm(final)=6.196 | 3837.4 samples/s | 60.0 steps/s
[Step=18050 Epoch=35.3] | Loss=0.01404 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.488 | L2-Norm(final)=6.199 | 5539.6 samples/s | 86.6 steps/s
[Step=18100 Epoch=35.4] | Loss=0.01356 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.496 | L2-Norm(final)=6.202 | 5496.3 samples/s | 85.9 steps/s
[Step=18150 Epoch=35.5] | Loss=0.01247 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.505 | L2-Norm(final)=6.207 | 5772.0 samples/s | 90.2 steps/s
[Step=18200 Epoch=35.6] | Loss=0.01230 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.512 | L2-Norm(final)=6.213 | 5640.9 samples/s | 88.1 steps/s
[Step=18250 Epoch=35.7] | Loss=0.01209 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.519 | L2-Norm(final)=6.219 | 5648.8 samples/s | 88.3 steps/s
[Step=18300 Epoch=35.8] | Loss=0.01195 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=6.224 | 5628.2 samples/s | 87.9 steps/s
[Step=18350 Epoch=35.9] | Loss=0.01164 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.532 | L2-Norm(final)=6.230 | 5644.8 samples/s | 88.2 steps/s
[Step=18400 Epoch=36.0] | Loss=0.01161 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.537 | L2-Norm(final)=6.236 | 5757.2 samples/s | 90.0 steps/s
[Step=18450 Epoch=36.1] | Loss=0.01146 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.543 | L2-Norm(final)=6.242 | 5717.5 samples/s | 89.3 steps/s
[Step=18500 Epoch=36.2] | Loss=0.01147 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.549 | L2-Norm(final)=6.247 | 7104.3 samples/s | 111.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=36.2] | Loss=0.00913 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.607 | L2-Norm(final)=6.297 | 3985.0 samples/s | 62.3 steps/s
[Step=18550 Epoch=36.3] | Loss=0.01063 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.614 | L2-Norm(final)=6.303 | 4875.2 samples/s | 76.2 steps/s
[Step=18600 Epoch=36.4] | Loss=0.01153 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.622 | L2-Norm(final)=6.308 | 5074.9 samples/s | 79.3 steps/s
[Step=18650 Epoch=36.5] | Loss=0.01178 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.630 | L2-Norm(final)=6.312 | 5001.3 samples/s | 78.1 steps/s
[Step=18700 Epoch=36.6] | Loss=0.01179 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.638 | L2-Norm(final)=6.315 | 5067.8 samples/s | 79.2 steps/s
[Step=18750 Epoch=36.7] | Loss=0.01229 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.645 | L2-Norm(final)=6.319 | 4951.5 samples/s | 77.4 steps/s
[Step=18800 Epoch=36.8] | Loss=0.01199 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.652 | L2-Norm(final)=6.321 | 5063.9 samples/s | 79.1 steps/s
[Step=18850 Epoch=36.9] | Loss=0.01205 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.658 | L2-Norm(final)=6.323 | 5050.7 samples/s | 78.9 steps/s
[Step=18900 Epoch=36.9] | Loss=0.01188 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.665 | L2-Norm(final)=6.326 | 5046.0 samples/s | 78.8 steps/s
[Step=18950 Epoch=37.0] | Loss=0.01186 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.671 | L2-Norm(final)=6.329 | 5043.3 samples/s | 78.8 steps/s
[Step=19000 Epoch=37.1] | Loss=0.01172 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.676 | L2-Norm(final)=6.331 | 6256.4 samples/s | 97.8 steps/s
[Step=19050 Epoch=37.2] | Loss=0.01141 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.682 | L2-Norm(final)=6.334 | 1914.2 samples/s | 29.9 steps/s
[Step=19100 Epoch=37.3] | Loss=0.01111 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.688 | L2-Norm(final)=6.337 | 4986.1 samples/s | 77.9 steps/s
[Step=19150 Epoch=37.4] | Loss=0.01083 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.693 | L2-Norm(final)=6.340 | 5137.2 samples/s | 80.3 steps/s
[Step=19200 Epoch=37.5] | Loss=0.01084 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.698 | L2-Norm(final)=6.344 | 5009.2 samples/s | 78.3 steps/s
[Step=19250 Epoch=37.6] | Loss=0.01074 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.703 | L2-Norm(final)=6.347 | 4997.4 samples/s | 78.1 steps/s
[Step=19300 Epoch=37.7] | Loss=0.01057 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.708 | L2-Norm(final)=6.350 | 5108.1 samples/s | 79.8 steps/s
[Step=19350 Epoch=37.8] | Loss=0.01040 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.713 | L2-Norm(final)=6.353 | 5013.5 samples/s | 78.3 steps/s
[Step=19400 Epoch=37.9] | Loss=0.01047 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.717 | L2-Norm(final)=6.355 | 5085.3 samples/s | 79.5 steps/s
[Step=19450 Epoch=38.0] | Loss=0.01054 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.722 | L2-Norm(final)=6.358 | 4996.0 samples/s | 78.1 steps/s
[Step=19500 Epoch=38.1] | Loss=0.01046 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.726 | L2-Norm(final)=6.361 | 5358.2 samples/s | 83.7 steps/s
[Step=19550 Epoch=38.2] | Loss=0.01040 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.731 | L2-Norm(final)=6.363 | 2009.1 samples/s | 31.4 steps/s
[Step=19600 Epoch=38.3] | Loss=0.01027 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.735 | L2-Norm(final)=6.366 | 5017.4 samples/s | 78.4 steps/s
[Step=19650 Epoch=38.4] | Loss=0.01025 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.739 | L2-Norm(final)=6.368 | 5040.4 samples/s | 78.8 steps/s
[Step=19700 Epoch=38.5] | Loss=0.01015 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.743 | L2-Norm(final)=6.370 | 5104.8 samples/s | 79.8 steps/s
[Step=19750 Epoch=38.6] | Loss=0.01004 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.746 | L2-Norm(final)=6.372 | 5009.9 samples/s | 78.3 steps/s
[Step=19800 Epoch=38.7] | Loss=0.01002 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.750 | L2-Norm(final)=6.375 | 5035.1 samples/s | 78.7 steps/s
[Step=19850 Epoch=38.8] | Loss=0.00988 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.754 | L2-Norm(final)=6.377 | 5095.4 samples/s | 79.6 steps/s
[Step=19900 Epoch=38.9] | Loss=0.01002 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.757 | L2-Norm(final)=6.379 | 5039.1 samples/s | 78.7 steps/s
[Step=19950 Epoch=39.0] | Loss=0.00994 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.761 | L2-Norm(final)=6.381 | 5037.3 samples/s | 78.7 steps/s
[Step=20000 Epoch=39.1] | Loss=0.00990 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.764 | L2-Norm(final)=6.383 | 5064.8 samples/s | 79.1 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step20000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=30001 Epoch=115.0] | Loss=0.00006 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.483 | L2-Norm(final)=8.407 | 3840.6 samples/s | 60.0 steps/s
[Step=30050 Epoch=115.1] | Loss=0.00218 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.500 | L2-Norm(final)=8.417 | 5003.3 samples/s | 78.2 steps/s
[Step=30100 Epoch=115.3] | Loss=0.00253 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.547 | L2-Norm(final)=8.422 | 5328.1 samples/s | 83.3 steps/s
[Step=30150 Epoch=115.5] | Loss=0.00203 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.581 | L2-Norm(final)=8.427 | 5319.9 samples/s | 83.1 steps/s
[Step=30200 Epoch=115.7] | Loss=0.00170 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.598 | L2-Norm(final)=8.433 | 5415.3 samples/s | 84.6 steps/s
[Step=30250 Epoch=115.9] | Loss=0.00146 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.609 | L2-Norm(final)=8.439 | 6825.0 samples/s | 106.6 steps/s
[Step=30300 Epoch=116.1] | Loss=0.00126 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=8.446 | 1932.9 samples/s | 30.2 steps/s
[Step=30350 Epoch=116.3] | Loss=0.00109 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=8.452 | 5266.1 samples/s | 82.3 steps/s
[Step=30400 Epoch=116.5] | Loss=0.00096 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.620 | L2-Norm(final)=8.457 | 5308.1 samples/s | 82.9 steps/s
[Step=30450 Epoch=116.7] | Loss=0.00087 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.620 | L2-Norm(final)=8.461 | 5369.1 samples/s | 83.9 steps/s
[Step=30500 Epoch=116.9] | Loss=0.00079 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.619 | L2-Norm(final)=8.465 | 5918.3 samples/s | 92.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=30501 Epoch=116.9] | Loss=0.00010 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.605 | L2-Norm(final)=8.505 | 3791.5 samples/s | 59.2 steps/s
[Step=30550 Epoch=117.1] | Loss=0.00337 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.614 | L2-Norm(final)=8.508 | 4555.5 samples/s | 71.2 steps/s
[Step=30600 Epoch=117.2] | Loss=0.00880 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.662 | L2-Norm(final)=8.504 | 4790.8 samples/s | 74.9 steps/s
[Step=30650 Epoch=117.4] | Loss=0.00648 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.690 | L2-Norm(final)=8.494 | 4831.1 samples/s | 75.5 steps/s
[Step=30700 Epoch=117.6] | Loss=0.00509 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.705 | L2-Norm(final)=8.490 | 4758.4 samples/s | 74.4 steps/s
[Step=30750 Epoch=117.8] | Loss=0.00416 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.713 | L2-Norm(final)=8.488 | 5988.4 samples/s | 93.6 steps/s
[Step=30800 Epoch=118.0] | Loss=0.00350 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.717 | L2-Norm(final)=8.488 | 1889.2 samples/s | 29.5 steps/s
[Step=30850 Epoch=118.2] | Loss=0.00301 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.719 | L2-Norm(final)=8.487 | 4731.8 samples/s | 73.9 steps/s
[Step=30900 Epoch=118.4] | Loss=0.00264 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.719 | L2-Norm(final)=8.487 | 4801.9 samples/s | 75.0 steps/s
[Step=30950 Epoch=118.6] | Loss=0.00236 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.719 | L2-Norm(final)=8.487 | 4772.0 samples/s | 74.6 steps/s
[Step=31000 Epoch=118.8] | Loss=0.00212 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.718 | L2-Norm(final)=8.487 | 5254.5 samples/s | 82.1 steps/s
[Step=31050 Epoch=119.0] | Loss=0.00193 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.716 | L2-Norm(final)=8.488 | 1964.3 samples/s | 30.7 steps/s
[Step=31100 Epoch=119.2] | Loss=0.00178 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=8.488 | 4749.6 samples/s | 74.2 steps/s
[Step=31150 Epoch=119.4] | Loss=0.00164 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.712 | L2-Norm(final)=8.488 | 4795.1 samples/s | 74.9 steps/s
[Step=31200 Epoch=119.5] | Loss=0.00153 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.709 | L2-Norm(final)=8.489 | 4835.1 samples/s | 75.5 steps/s
[Step=31250 Epoch=119.7] | Loss=0.00142 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.707 | L2-Norm(final)=8.489 | 4759.5 samples/s | 74.4 steps/s
[Step=31300 Epoch=119.9] | Loss=0.00134 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.704 | L2-Norm(final)=8.489 | 2018.5 samples/s | 31.5 steps/s
[Step=31350 Epoch=120.1] | Loss=0.00126 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.701 | L2-Norm(final)=8.490 | 4831.8 samples/s | 75.5 steps/s
[Step=31400 Epoch=120.3] | Loss=0.00119 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.697 | L2-Norm(final)=8.490 | 4787.5 samples/s | 74.8 steps/s
[Step=31450 Epoch=120.5] | Loss=0.00113 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.694 | L2-Norm(final)=8.491 | 4757.4 samples/s | 74.3 steps/s
[Step=31500 Epoch=120.7] | Loss=0.00107 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.690 | L2-Norm(final)=8.491 | 4748.1 samples/s | 74.2 steps/s
[Step=31550 Epoch=120.9] | Loss=0.00102 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.687 | L2-Norm(final)=8.491 | 2045.2 samples/s | 32.0 steps/s
[Step=31600 Epoch=121.1] | Loss=0.00098 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.683 | L2-Norm(final)=8.492 | 4741.3 samples/s | 74.1 steps/s
[Step=31650 Epoch=121.3] | Loss=0.00093 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.679 | L2-Norm(final)=8.492 | 4782.7 samples/s | 74.7 steps/s
[Step=31700 Epoch=121.5] | Loss=0.00090 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.675 | L2-Norm(final)=8.492 | 4821.2 samples/s | 75.3 steps/s
[Step=31750 Epoch=121.7] | Loss=0.00086 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.671 | L2-Norm(final)=8.493 | 4838.6 samples/s | 75.6 steps/s
[Step=31800 Epoch=121.8] | Loss=0.00083 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.667 | L2-Norm(final)=8.493 | 6407.9 samples/s | 100.1 steps/s
[Step=31850 Epoch=122.0] | Loss=0.00080 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.663 | L2-Norm(final)=8.494 | 1813.0 samples/s | 28.3 steps/s
[Step=31900 Epoch=122.2] | Loss=0.00077 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.658 | L2-Norm(final)=8.494 | 4797.9 samples/s | 75.0 steps/s
[Step=31950 Epoch=122.4] | Loss=0.00074 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.654 | L2-Norm(final)=8.494 | 4825.6 samples/s | 75.4 steps/s
[Step=32000 Epoch=122.6] | Loss=0.00072 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.649 | L2-Norm(final)=8.495 | 4858.6 samples/s | 75.9 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05757 | acc=0.9695 | tpr=0.9755 | fpr=0.0434 | 4417.4 samples/s | 17.3 steps/s
Avg test loss: 0.05982, Avg test acc: 0.96843, Avg tpr: 0.97406, Avg fpr: 0.04397, total FA: 343

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06009 | acc=0.9709 | tpr=0.9793 | fpr=0.0473 | 4468.0 samples/s | 17.5 steps/s
Avg test loss: 0.06692, Avg test acc: 0.96899, Avg tpr: 0.97814, Avg fpr: 0.05115, total FA: 399

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.86214 | acc=0.3225 | tpr=0.0388 | fpr=0.0614 | 4470.4 samples/s | 17.5 steps/s
Avg test loss: 4.86798, Avg test acc: 0.32070, Avg tpr: 0.04028, Avg fpr: 0.06256, total FA: 488

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.38011 | acc=0.3132 | tpr=0.0483 | fpr=0.1115 | 4463.4 samples/s | 17.4 steps/s
Avg test loss: 5.37917, Avg test acc: 0.31261, Avg tpr: 0.04954, Avg fpr: 0.10883, total FA: 849

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.19349 | acc=0.1255 | tpr=0.5752 | fpr=0.8826 | 4554.8 samples/s | 17.8 steps/s
[Step= 100] | Loss=5.17107 | acc=0.1248 | tpr=0.5501 | fpr=0.8832 | 8407.1 samples/s | 32.8 steps/s
[Step= 150] | Loss=5.17675 | acc=0.1238 | tpr=0.5403 | fpr=0.8838 | 8807.2 samples/s | 34.4 steps/s
[Step= 200] | Loss=5.17087 | acc=0.1242 | tpr=0.5344 | fpr=0.8833 | 8901.0 samples/s | 34.8 steps/s
[Step= 250] | Loss=5.16823 | acc=0.1246 | tpr=0.5441 | fpr=0.8830 | 8899.6 samples/s | 34.8 steps/s
[Step= 300] | Loss=5.16463 | acc=0.1251 | tpr=0.5505 | fpr=0.8827 | 8414.1 samples/s | 32.9 steps/s
[Step= 350] | Loss=5.16165 | acc=0.1247 | tpr=0.5510 | fpr=0.8830 | 9008.4 samples/s | 35.2 steps/s
[Step= 400] | Loss=5.15911 | acc=0.1252 | tpr=0.5536 | fpr=0.8826 | 8720.3 samples/s | 34.1 steps/s
[Step= 450] | Loss=5.16736 | acc=0.1247 | tpr=0.5487 | fpr=0.8830 | 8683.8 samples/s | 33.9 steps/s
[Step= 500] | Loss=5.17220 | acc=0.1244 | tpr=0.5476 | fpr=0.8833 | 8676.3 samples/s | 33.9 steps/s
[Step= 550] | Loss=5.17611 | acc=0.1244 | tpr=0.5464 | fpr=0.8833 | 16203.2 samples/s | 63.3 steps/s
Avg test loss: 5.17719, Avg test acc: 0.12427, Avg tpr: 0.54715, Avg fpr: 0.88342, total FA: 122661

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.00774 | acc=0.1176 | tpr=0.7434 | fpr=0.8937 | 4438.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=5.98841 | acc=0.1166 | tpr=0.7100 | fpr=0.8945 | 9070.5 samples/s | 35.4 steps/s
[Step= 150] | Loss=6.00788 | acc=0.1163 | tpr=0.6988 | fpr=0.8944 | 9065.6 samples/s | 35.4 steps/s
[Step= 200] | Loss=5.99986 | acc=0.1159 | tpr=0.6984 | fpr=0.8947 | 8498.1 samples/s | 33.2 steps/s
[Step= 250] | Loss=5.99861 | acc=0.1165 | tpr=0.7031 | fpr=0.8942 | 8901.0 samples/s | 34.8 steps/s
[Step= 300] | Loss=5.99720 | acc=0.1169 | tpr=0.7040 | fpr=0.8938 | 9171.1 samples/s | 35.8 steps/s
[Step= 350] | Loss=5.99252 | acc=0.1167 | tpr=0.6988 | fpr=0.8938 | 8335.4 samples/s | 32.6 steps/s
[Step= 400] | Loss=5.99141 | acc=0.1172 | tpr=0.7002 | fpr=0.8934 | 8871.4 samples/s | 34.7 steps/s
[Step= 450] | Loss=6.00300 | acc=0.1168 | tpr=0.6952 | fpr=0.8937 | 8810.7 samples/s | 34.4 steps/s
[Step= 500] | Loss=6.00722 | acc=0.1167 | tpr=0.6965 | fpr=0.8937 | 8775.8 samples/s | 34.3 steps/s
[Step= 550] | Loss=6.01068 | acc=0.1167 | tpr=0.6956 | fpr=0.8938 | 16236.9 samples/s | 63.4 steps/s
Avg test loss: 6.01145, Avg test acc: 0.11666, Avg tpr: 0.69651, Avg fpr: 0.89388, total FA: 124114

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12472 | acc=0.9804 | tpr=0.8938 | fpr=0.0181 | 4431.2 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.12919 | acc=0.9803 | tpr=0.9211 | fpr=0.0186 | 9004.5 samples/s | 35.2 steps/s
[Step= 150] | Loss=0.13416 | acc=0.9796 | tpr=0.9308 | fpr=0.0195 | 9011.2 samples/s | 35.2 steps/s
[Step= 200] | Loss=0.13511 | acc=0.9797 | tpr=0.9311 | fpr=0.0194 | 8243.5 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.13343 | acc=0.9796 | tpr=0.9284 | fpr=0.0195 | 8813.8 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.13643 | acc=0.9794 | tpr=0.9280 | fpr=0.0197 | 8854.9 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.13801 | acc=0.9791 | tpr=0.9292 | fpr=0.0200 | 8680.6 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.13863 | acc=0.9790 | tpr=0.9283 | fpr=0.0201 | 9133.7 samples/s | 35.7 steps/s
[Step= 450] | Loss=0.14163 | acc=0.9786 | tpr=0.9265 | fpr=0.0205 | 8740.1 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.14095 | acc=0.9787 | tpr=0.9264 | fpr=0.0204 | 8477.4 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.14042 | acc=0.9787 | tpr=0.9252 | fpr=0.0204 | 15944.5 samples/s | 62.3 steps/s
Avg test loss: 0.14006, Avg test acc: 0.97868, Avg tpr: 0.92552, Avg fpr: 0.02035, total FA: 2826

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13745 | acc=0.9788 | tpr=0.9425 | fpr=0.0205 | 4484.6 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.14600 | acc=0.9781 | tpr=0.9467 | fpr=0.0213 | 8648.8 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.15050 | acc=0.9771 | tpr=0.9510 | fpr=0.0224 | 8672.5 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.14968 | acc=0.9773 | tpr=0.9530 | fpr=0.0222 | 8905.5 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.14749 | acc=0.9775 | tpr=0.9493 | fpr=0.0220 | 8658.2 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.14998 | acc=0.9773 | tpr=0.9476 | fpr=0.0222 | 8825.8 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.15095 | acc=0.9773 | tpr=0.9499 | fpr=0.0222 | 9079.7 samples/s | 35.5 steps/s
[Step= 400] | Loss=0.15176 | acc=0.9771 | tpr=0.9497 | fpr=0.0224 | 8561.7 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.15498 | acc=0.9768 | tpr=0.9469 | fpr=0.0227 | 9213.9 samples/s | 36.0 steps/s
[Step= 500] | Loss=0.15441 | acc=0.9768 | tpr=0.9471 | fpr=0.0227 | 8333.6 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.15351 | acc=0.9768 | tpr=0.9443 | fpr=0.0226 | 16509.6 samples/s | 64.5 steps/s
Avg test loss: 0.15305, Avg test acc: 0.97683, Avg tpr: 0.94453, Avg fpr: 0.02259, total FA: 3136

server round 23/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=18001 Epoch=35.1] | Loss=0.07931 | Reg=0.00180 | acc=0.9531 | L2-Norm=13.404 | L2-Norm(final)=6.245 | 3732.9 samples/s | 58.3 steps/s
[Step=18050 Epoch=35.2] | Loss=0.01636 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.412 | L2-Norm(final)=6.247 | 5221.2 samples/s | 81.6 steps/s
[Step=18100 Epoch=35.3] | Loss=0.01466 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.424 | L2-Norm(final)=6.249 | 5551.6 samples/s | 86.7 steps/s
[Step=18150 Epoch=35.4] | Loss=0.01403 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.434 | L2-Norm(final)=6.255 | 5717.5 samples/s | 89.3 steps/s
[Step=18200 Epoch=35.5] | Loss=0.01391 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.444 | L2-Norm(final)=6.263 | 5541.5 samples/s | 86.6 steps/s
[Step=18250 Epoch=35.6] | Loss=0.01379 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.453 | L2-Norm(final)=6.270 | 5701.0 samples/s | 89.1 steps/s
[Step=18300 Epoch=35.7] | Loss=0.01362 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.462 | L2-Norm(final)=6.278 | 5580.5 samples/s | 87.2 steps/s
[Step=18350 Epoch=35.8] | Loss=0.01312 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.470 | L2-Norm(final)=6.285 | 5720.9 samples/s | 89.4 steps/s
[Step=18400 Epoch=35.9] | Loss=0.01318 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=6.292 | 5709.6 samples/s | 89.2 steps/s
[Step=18450 Epoch=36.0] | Loss=0.01275 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.486 | L2-Norm(final)=6.299 | 5555.2 samples/s | 86.8 steps/s
[Step=18500 Epoch=36.1] | Loss=0.01245 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.495 | L2-Norm(final)=6.306 | 7148.9 samples/s | 111.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=36.1] | Loss=0.00516 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.576 | L2-Norm(final)=6.380 | 3521.5 samples/s | 55.0 steps/s
[Step=18550 Epoch=36.2] | Loss=0.01184 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.590 | L2-Norm(final)=6.387 | 4967.3 samples/s | 77.6 steps/s
[Step=18600 Epoch=36.3] | Loss=0.01463 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.600 | L2-Norm(final)=6.388 | 5111.0 samples/s | 79.9 steps/s
[Step=18650 Epoch=36.4] | Loss=0.01521 | Reg=0.00185 | acc=0.9531 | L2-Norm=13.609 | L2-Norm(final)=6.388 | 5090.6 samples/s | 79.5 steps/s
[Step=18700 Epoch=36.5] | Loss=0.01532 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.619 | L2-Norm(final)=6.388 | 4974.0 samples/s | 77.7 steps/s
[Step=18750 Epoch=36.6] | Loss=0.01542 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.628 | L2-Norm(final)=6.389 | 5016.9 samples/s | 78.4 steps/s
[Step=18800 Epoch=36.7] | Loss=0.01514 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.638 | L2-Norm(final)=6.390 | 5076.7 samples/s | 79.3 steps/s
[Step=18850 Epoch=36.8] | Loss=0.01479 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.646 | L2-Norm(final)=6.392 | 5000.5 samples/s | 78.1 steps/s
[Step=18900 Epoch=36.9] | Loss=0.01477 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.654 | L2-Norm(final)=6.395 | 5148.9 samples/s | 80.5 steps/s
[Step=18950 Epoch=37.0] | Loss=0.01462 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.661 | L2-Norm(final)=6.398 | 5027.9 samples/s | 78.6 steps/s
[Step=19000 Epoch=37.1] | Loss=0.01445 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.668 | L2-Norm(final)=6.400 | 6145.7 samples/s | 96.0 steps/s
[Step=19050 Epoch=37.2] | Loss=0.01426 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.675 | L2-Norm(final)=6.403 | 1855.2 samples/s | 29.0 steps/s
[Step=19100 Epoch=37.3] | Loss=0.01370 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.682 | L2-Norm(final)=6.405 | 4998.0 samples/s | 78.1 steps/s
[Step=19150 Epoch=37.3] | Loss=0.01326 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.688 | L2-Norm(final)=6.408 | 5023.1 samples/s | 78.5 steps/s
[Step=19200 Epoch=37.4] | Loss=0.01306 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.693 | L2-Norm(final)=6.411 | 5052.5 samples/s | 78.9 steps/s
[Step=19250 Epoch=37.5] | Loss=0.01266 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.698 | L2-Norm(final)=6.413 | 5071.7 samples/s | 79.2 steps/s
[Step=19300 Epoch=37.6] | Loss=0.01240 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.703 | L2-Norm(final)=6.416 | 5042.4 samples/s | 78.8 steps/s
[Step=19350 Epoch=37.7] | Loss=0.01239 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.707 | L2-Norm(final)=6.418 | 5035.8 samples/s | 78.7 steps/s
[Step=19400 Epoch=37.8] | Loss=0.01242 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.712 | L2-Norm(final)=6.420 | 5077.3 samples/s | 79.3 steps/s
[Step=19450 Epoch=37.9] | Loss=0.01228 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.716 | L2-Norm(final)=6.422 | 5094.6 samples/s | 79.6 steps/s
[Step=19500 Epoch=38.0] | Loss=0.01222 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.721 | L2-Norm(final)=6.424 | 5313.4 samples/s | 83.0 steps/s
[Step=19550 Epoch=38.1] | Loss=0.01214 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.725 | L2-Norm(final)=6.426 | 1932.4 samples/s | 30.2 steps/s
[Step=19600 Epoch=38.2] | Loss=0.01194 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.729 | L2-Norm(final)=6.427 | 5020.4 samples/s | 78.4 steps/s
[Step=19650 Epoch=38.3] | Loss=0.01179 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.733 | L2-Norm(final)=6.429 | 4852.3 samples/s | 75.8 steps/s
[Step=19700 Epoch=38.4] | Loss=0.01161 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.737 | L2-Norm(final)=6.432 | 4934.7 samples/s | 77.1 steps/s
[Step=19750 Epoch=38.5] | Loss=0.01153 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.741 | L2-Norm(final)=6.434 | 5037.6 samples/s | 78.7 steps/s
[Step=19800 Epoch=38.6] | Loss=0.01143 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.744 | L2-Norm(final)=6.436 | 5034.0 samples/s | 78.7 steps/s
[Step=19850 Epoch=38.7] | Loss=0.01128 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.748 | L2-Norm(final)=6.438 | 4836.9 samples/s | 75.6 steps/s
[Step=19900 Epoch=38.8] | Loss=0.01117 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.751 | L2-Norm(final)=6.440 | 5047.5 samples/s | 78.9 steps/s
[Step=19950 Epoch=38.9] | Loss=0.01108 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.755 | L2-Norm(final)=6.442 | 5045.1 samples/s | 78.8 steps/s
[Step=20000 Epoch=39.0] | Loss=0.01100 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.758 | L2-Norm(final)=6.444 | 5091.4 samples/s | 79.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step20000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=20001 Epoch=39.1] | Loss=0.03574 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.404 | L2-Norm(final)=6.449 | 3719.9 samples/s | 58.1 steps/s
[Step=20050 Epoch=39.2] | Loss=0.01263 | Reg=0.00180 | acc=0.9375 | L2-Norm=13.411 | L2-Norm(final)=6.455 | 5838.0 samples/s | 91.2 steps/s
[Step=20100 Epoch=39.3] | Loss=0.01133 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.422 | L2-Norm(final)=6.461 | 5574.2 samples/s | 87.1 steps/s
[Step=20150 Epoch=39.4] | Loss=0.01238 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.432 | L2-Norm(final)=6.469 | 5727.1 samples/s | 89.5 steps/s
[Step=20200 Epoch=39.5] | Loss=0.01305 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.441 | L2-Norm(final)=6.475 | 5566.0 samples/s | 87.0 steps/s
[Step=20250 Epoch=39.6] | Loss=0.01250 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.451 | L2-Norm(final)=6.481 | 5688.8 samples/s | 88.9 steps/s
[Step=20300 Epoch=39.7] | Loss=0.01233 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.460 | L2-Norm(final)=6.489 | 5618.3 samples/s | 87.8 steps/s
[Step=20350 Epoch=39.8] | Loss=0.01202 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.469 | L2-Norm(final)=6.496 | 5668.6 samples/s | 88.6 steps/s
[Step=20400 Epoch=39.9] | Loss=0.01195 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=6.504 | 5684.9 samples/s | 88.8 steps/s
[Step=20450 Epoch=40.0] | Loss=0.01187 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=6.511 | 5767.5 samples/s | 90.1 steps/s
[Step=20500 Epoch=40.1] | Loss=0.01178 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.493 | L2-Norm(final)=6.518 | 7113.1 samples/s | 111.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=40.1] | Loss=0.00624 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.573 | L2-Norm(final)=6.590 | 3751.7 samples/s | 58.6 steps/s
[Step=20550 Epoch=40.2] | Loss=0.00979 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.584 | L2-Norm(final)=6.599 | 4993.3 samples/s | 78.0 steps/s
[Step=20600 Epoch=40.3] | Loss=0.01132 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.597 | L2-Norm(final)=6.603 | 4991.4 samples/s | 78.0 steps/s
[Step=20650 Epoch=40.4] | Loss=0.01276 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.609 | L2-Norm(final)=6.605 | 5029.5 samples/s | 78.6 steps/s
[Step=20700 Epoch=40.5] | Loss=0.01297 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.619 | L2-Norm(final)=6.607 | 5032.7 samples/s | 78.6 steps/s
[Step=20750 Epoch=40.6] | Loss=0.01275 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.628 | L2-Norm(final)=6.610 | 5067.9 samples/s | 79.2 steps/s
[Step=20800 Epoch=40.7] | Loss=0.01282 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.637 | L2-Norm(final)=6.613 | 5078.5 samples/s | 79.4 steps/s
[Step=20850 Epoch=40.8] | Loss=0.01298 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.646 | L2-Norm(final)=6.615 | 5113.5 samples/s | 79.9 steps/s
[Step=20900 Epoch=40.9] | Loss=0.01350 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.653 | L2-Norm(final)=6.617 | 4996.3 samples/s | 78.1 steps/s
[Step=20950 Epoch=41.0] | Loss=0.01346 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.660 | L2-Norm(final)=6.618 | 5094.3 samples/s | 79.6 steps/s
[Step=21000 Epoch=41.1] | Loss=0.01327 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.667 | L2-Norm(final)=6.620 | 6138.3 samples/s | 95.9 steps/s
[Step=21050 Epoch=41.2] | Loss=0.01284 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.674 | L2-Norm(final)=6.623 | 1929.9 samples/s | 30.2 steps/s
[Step=21100 Epoch=41.2] | Loss=0.01242 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.680 | L2-Norm(final)=6.625 | 5054.1 samples/s | 79.0 steps/s
[Step=21150 Epoch=41.3] | Loss=0.01215 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.686 | L2-Norm(final)=6.628 | 4970.5 samples/s | 77.7 steps/s
[Step=21200 Epoch=41.4] | Loss=0.01188 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.691 | L2-Norm(final)=6.631 | 5085.7 samples/s | 79.5 steps/s
[Step=21250 Epoch=41.5] | Loss=0.01210 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.696 | L2-Norm(final)=6.633 | 4987.9 samples/s | 77.9 steps/s
[Step=21300 Epoch=41.6] | Loss=0.01186 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.701 | L2-Norm(final)=6.635 | 5125.3 samples/s | 80.1 steps/s
[Step=21350 Epoch=41.7] | Loss=0.01175 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.705 | L2-Norm(final)=6.637 | 5035.2 samples/s | 78.7 steps/s
[Step=21400 Epoch=41.8] | Loss=0.01159 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.710 | L2-Norm(final)=6.640 | 5068.0 samples/s | 79.2 steps/s
[Step=21450 Epoch=41.9] | Loss=0.01154 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=6.642 | 5099.5 samples/s | 79.7 steps/s
[Step=21500 Epoch=42.0] | Loss=0.01137 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.719 | L2-Norm(final)=6.644 | 5432.0 samples/s | 84.9 steps/s
[Step=21550 Epoch=42.1] | Loss=0.01124 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.723 | L2-Norm(final)=6.646 | 2009.7 samples/s | 31.4 steps/s
[Step=21600 Epoch=42.2] | Loss=0.01114 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.727 | L2-Norm(final)=6.648 | 5064.0 samples/s | 79.1 steps/s
[Step=21650 Epoch=42.3] | Loss=0.01101 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.731 | L2-Norm(final)=6.651 | 5083.6 samples/s | 79.4 steps/s
[Step=21700 Epoch=42.4] | Loss=0.01086 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.735 | L2-Norm(final)=6.653 | 4998.2 samples/s | 78.1 steps/s
[Step=21750 Epoch=42.5] | Loss=0.01074 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.739 | L2-Norm(final)=6.655 | 4999.5 samples/s | 78.1 steps/s
[Step=21800 Epoch=42.6] | Loss=0.01059 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.742 | L2-Norm(final)=6.658 | 4997.8 samples/s | 78.1 steps/s
[Step=21850 Epoch=42.7] | Loss=0.01057 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.746 | L2-Norm(final)=6.660 | 5045.5 samples/s | 78.8 steps/s
[Step=21900 Epoch=42.8] | Loss=0.01048 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.750 | L2-Norm(final)=6.662 | 5061.5 samples/s | 79.1 steps/s
[Step=21950 Epoch=42.9] | Loss=0.01042 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.753 | L2-Norm(final)=6.664 | 5022.0 samples/s | 78.5 steps/s
[Step=22000 Epoch=43.0] | Loss=0.01031 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.757 | L2-Norm(final)=6.666 | 5060.0 samples/s | 79.1 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step22000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07043 | acc=0.9676 | tpr=0.9851 | fpr=0.0704 | 4435.4 samples/s | 17.3 steps/s
Avg test loss: 0.07253, Avg test acc: 0.96686, Avg tpr: 0.98333, Avg fpr: 0.06935, total FA: 541

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06250 | acc=0.9694 | tpr=0.9774 | fpr=0.0481 | 4467.0 samples/s | 17.4 steps/s
Avg test loss: 0.07070, Avg test acc: 0.96771, Avg tpr: 0.97639, Avg fpr: 0.05140, total FA: 401

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.86214 | acc=0.3225 | tpr=0.0388 | fpr=0.0614 | 4439.8 samples/s | 17.3 steps/s
Avg test loss: 4.86798, Avg test acc: 0.32070, Avg tpr: 0.04028, Avg fpr: 0.06256, total FA: 488

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.38011 | acc=0.3132 | tpr=0.0483 | fpr=0.1115 | 4489.1 samples/s | 17.5 steps/s
Avg test loss: 5.37917, Avg test acc: 0.31261, Avg tpr: 0.04954, Avg fpr: 0.10883, total FA: 849

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.42727 | acc=0.0966 | tpr=0.6947 | fpr=0.9142 | 4511.7 samples/s | 17.6 steps/s
[Step= 100] | Loss=6.40479 | acc=0.0955 | tpr=0.6610 | fpr=0.9150 | 8828.8 samples/s | 34.5 steps/s
[Step= 150] | Loss=6.41328 | acc=0.0946 | tpr=0.6527 | fpr=0.9157 | 8581.6 samples/s | 33.5 steps/s
[Step= 200] | Loss=6.40873 | acc=0.0944 | tpr=0.6623 | fpr=0.9159 | 8859.6 samples/s | 34.6 steps/s
[Step= 250] | Loss=6.40546 | acc=0.0947 | tpr=0.6690 | fpr=0.9157 | 8950.7 samples/s | 35.0 steps/s
[Step= 300] | Loss=6.40327 | acc=0.0951 | tpr=0.6735 | fpr=0.9154 | 8675.1 samples/s | 33.9 steps/s
[Step= 350] | Loss=6.39964 | acc=0.0950 | tpr=0.6700 | fpr=0.9155 | 8649.8 samples/s | 33.8 steps/s
[Step= 400] | Loss=6.39792 | acc=0.0953 | tpr=0.6734 | fpr=0.9152 | 8792.8 samples/s | 34.3 steps/s
[Step= 450] | Loss=6.40727 | acc=0.0948 | tpr=0.6650 | fpr=0.9156 | 8816.7 samples/s | 34.4 steps/s
[Step= 500] | Loss=6.41116 | acc=0.0947 | tpr=0.6678 | fpr=0.9157 | 8845.7 samples/s | 34.6 steps/s
[Step= 550] | Loss=6.41517 | acc=0.0947 | tpr=0.6673 | fpr=0.9157 | 15538.7 samples/s | 60.7 steps/s
Avg test loss: 6.41631, Avg test acc: 0.09464, Avg tpr: 0.66799, Avg fpr: 0.91579, total FA: 127155

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.99925 | acc=0.1239 | tpr=0.6283 | fpr=0.8852 | 4532.7 samples/s | 17.7 steps/s
[Step= 100] | Loss=5.98333 | acc=0.1234 | tpr=0.6205 | fpr=0.8859 | 8423.3 samples/s | 32.9 steps/s
[Step= 150] | Loss=6.00249 | acc=0.1222 | tpr=0.6081 | fpr=0.8867 | 9049.6 samples/s | 35.3 steps/s
[Step= 200] | Loss=5.99474 | acc=0.1212 | tpr=0.6033 | fpr=0.8876 | 9046.3 samples/s | 35.3 steps/s
[Step= 250] | Loss=5.99380 | acc=0.1218 | tpr=0.6105 | fpr=0.8871 | 8435.2 samples/s | 33.0 steps/s
[Step= 300] | Loss=5.99378 | acc=0.1222 | tpr=0.6131 | fpr=0.8867 | 9189.5 samples/s | 35.9 steps/s
[Step= 350] | Loss=5.99046 | acc=0.1221 | tpr=0.6086 | fpr=0.8867 | 8789.2 samples/s | 34.3 steps/s
[Step= 400] | Loss=5.98931 | acc=0.1225 | tpr=0.6132 | fpr=0.8864 | 8595.4 samples/s | 33.6 steps/s
[Step= 450] | Loss=5.99962 | acc=0.1221 | tpr=0.6105 | fpr=0.8867 | 8660.4 samples/s | 33.8 steps/s
[Step= 500] | Loss=6.00436 | acc=0.1220 | tpr=0.6097 | fpr=0.8868 | 9426.8 samples/s | 36.8 steps/s
[Step= 550] | Loss=6.00814 | acc=0.1220 | tpr=0.6112 | fpr=0.8869 | 14592.7 samples/s | 57.0 steps/s
Avg test loss: 6.00922, Avg test acc: 0.12194, Avg tpr: 0.61212, Avg fpr: 0.88697, total FA: 123154

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12472 | acc=0.9804 | tpr=0.8938 | fpr=0.0181 | 4421.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.12919 | acc=0.9803 | tpr=0.9211 | fpr=0.0186 | 8953.8 samples/s | 35.0 steps/s
[Step= 150] | Loss=0.13416 | acc=0.9796 | tpr=0.9308 | fpr=0.0195 | 8741.9 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.13511 | acc=0.9797 | tpr=0.9311 | fpr=0.0194 | 8899.2 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.13343 | acc=0.9796 | tpr=0.9284 | fpr=0.0195 | 8735.4 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.13643 | acc=0.9794 | tpr=0.9280 | fpr=0.0197 | 9199.9 samples/s | 35.9 steps/s
[Step= 350] | Loss=0.13801 | acc=0.9791 | tpr=0.9292 | fpr=0.0200 | 8616.1 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.13863 | acc=0.9790 | tpr=0.9283 | fpr=0.0201 | 8682.4 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.14163 | acc=0.9786 | tpr=0.9265 | fpr=0.0205 | 8818.6 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.14095 | acc=0.9787 | tpr=0.9264 | fpr=0.0204 | 8924.8 samples/s | 34.9 steps/s
[Step= 550] | Loss=0.14042 | acc=0.9787 | tpr=0.9252 | fpr=0.0204 | 15147.7 samples/s | 59.2 steps/s
Avg test loss: 0.14006, Avg test acc: 0.97868, Avg tpr: 0.92552, Avg fpr: 0.02035, total FA: 2826

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13745 | acc=0.9788 | tpr=0.9425 | fpr=0.0205 | 4495.1 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.14600 | acc=0.9781 | tpr=0.9467 | fpr=0.0213 | 8769.7 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.15050 | acc=0.9771 | tpr=0.9510 | fpr=0.0224 | 8641.4 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.14968 | acc=0.9773 | tpr=0.9530 | fpr=0.0222 | 8694.4 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.14749 | acc=0.9775 | tpr=0.9493 | fpr=0.0220 | 9020.0 samples/s | 35.2 steps/s
[Step= 300] | Loss=0.14998 | acc=0.9773 | tpr=0.9476 | fpr=0.0222 | 8819.6 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.15095 | acc=0.9773 | tpr=0.9499 | fpr=0.0222 | 8801.2 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.15176 | acc=0.9771 | tpr=0.9497 | fpr=0.0224 | 8700.7 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.15498 | acc=0.9768 | tpr=0.9469 | fpr=0.0227 | 8984.9 samples/s | 35.1 steps/s
[Step= 500] | Loss=0.15441 | acc=0.9768 | tpr=0.9471 | fpr=0.0227 | 8621.2 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.15351 | acc=0.9768 | tpr=0.9443 | fpr=0.0226 | 15814.1 samples/s | 61.8 steps/s
Avg test loss: 0.15305, Avg test acc: 0.97683, Avg tpr: 0.94453, Avg fpr: 0.02259, total FA: 3136

server round 24/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=20001 Epoch=39.0] | Loss=0.01192 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.335 | L2-Norm(final)=6.504 | 3505.7 samples/s | 54.8 steps/s
[Step=20050 Epoch=39.1] | Loss=0.01044 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.343 | L2-Norm(final)=6.510 | 5582.1 samples/s | 87.2 steps/s
[Step=20100 Epoch=39.2] | Loss=0.01365 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=6.513 | 5724.7 samples/s | 89.4 steps/s
[Step=20150 Epoch=39.3] | Loss=0.01300 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.364 | L2-Norm(final)=6.519 | 5597.6 samples/s | 87.5 steps/s
[Step=20200 Epoch=39.4] | Loss=0.01327 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=6.525 | 5584.0 samples/s | 87.2 steps/s
[Step=20250 Epoch=39.5] | Loss=0.01295 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.382 | L2-Norm(final)=6.531 | 5814.7 samples/s | 90.9 steps/s
[Step=20300 Epoch=39.6] | Loss=0.01279 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.390 | L2-Norm(final)=6.537 | 5591.9 samples/s | 87.4 steps/s
[Step=20350 Epoch=39.7] | Loss=0.01225 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.398 | L2-Norm(final)=6.543 | 5642.8 samples/s | 88.2 steps/s
[Step=20400 Epoch=39.8] | Loss=0.01217 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.405 | L2-Norm(final)=6.550 | 5655.5 samples/s | 88.4 steps/s
[Step=20450 Epoch=39.9] | Loss=0.01180 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.413 | L2-Norm(final)=6.555 | 5766.9 samples/s | 90.1 steps/s
[Step=20500 Epoch=40.0] | Loss=0.01185 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.420 | L2-Norm(final)=6.561 | 7043.5 samples/s | 110.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=40.0] | Loss=0.00308 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.494 | L2-Norm(final)=6.620 | 3576.3 samples/s | 55.9 steps/s
[Step=20550 Epoch=40.1] | Loss=0.00977 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.503 | L2-Norm(final)=6.628 | 4942.0 samples/s | 77.2 steps/s
[Step=20600 Epoch=40.2] | Loss=0.01185 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.512 | L2-Norm(final)=6.634 | 5053.2 samples/s | 79.0 steps/s
[Step=20650 Epoch=40.3] | Loss=0.01272 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.520 | L2-Norm(final)=6.635 | 5029.4 samples/s | 78.6 steps/s
[Step=20700 Epoch=40.4] | Loss=0.01351 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.528 | L2-Norm(final)=6.636 | 5043.8 samples/s | 78.8 steps/s
[Step=20750 Epoch=40.5] | Loss=0.01371 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.534 | L2-Norm(final)=6.636 | 5095.9 samples/s | 79.6 steps/s
[Step=20800 Epoch=40.6] | Loss=0.01362 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.541 | L2-Norm(final)=6.637 | 5006.0 samples/s | 78.2 steps/s
[Step=20850 Epoch=40.7] | Loss=0.01365 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.548 | L2-Norm(final)=6.640 | 5068.8 samples/s | 79.2 steps/s
[Step=20900 Epoch=40.8] | Loss=0.01358 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.555 | L2-Norm(final)=6.642 | 5098.5 samples/s | 79.7 steps/s
[Step=20950 Epoch=40.9] | Loss=0.01329 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.561 | L2-Norm(final)=6.644 | 5041.5 samples/s | 78.8 steps/s
[Step=21000 Epoch=41.0] | Loss=0.01346 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.567 | L2-Norm(final)=6.647 | 6006.9 samples/s | 93.9 steps/s
[Step=21050 Epoch=41.1] | Loss=0.01321 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.573 | L2-Norm(final)=6.649 | 1868.2 samples/s | 29.2 steps/s
[Step=21100 Epoch=41.2] | Loss=0.01302 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.579 | L2-Norm(final)=6.651 | 4974.2 samples/s | 77.7 steps/s
[Step=21150 Epoch=41.3] | Loss=0.01266 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.585 | L2-Norm(final)=6.654 | 5029.5 samples/s | 78.6 steps/s
[Step=21200 Epoch=41.3] | Loss=0.01271 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.590 | L2-Norm(final)=6.656 | 5050.0 samples/s | 78.9 steps/s
[Step=21250 Epoch=41.4] | Loss=0.01257 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.595 | L2-Norm(final)=6.658 | 5091.7 samples/s | 79.6 steps/s
[Step=21300 Epoch=41.5] | Loss=0.01240 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.600 | L2-Norm(final)=6.660 | 5066.9 samples/s | 79.2 steps/s
[Step=21350 Epoch=41.6] | Loss=0.01236 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.605 | L2-Norm(final)=6.662 | 5050.1 samples/s | 78.9 steps/s
[Step=21400 Epoch=41.7] | Loss=0.01227 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.609 | L2-Norm(final)=6.663 | 5038.3 samples/s | 78.7 steps/s
[Step=21450 Epoch=41.8] | Loss=0.01197 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.613 | L2-Norm(final)=6.665 | 5037.7 samples/s | 78.7 steps/s
[Step=21500 Epoch=41.9] | Loss=0.01186 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.617 | L2-Norm(final)=6.666 | 5376.6 samples/s | 84.0 steps/s
[Step=21550 Epoch=42.0] | Loss=0.01174 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.621 | L2-Norm(final)=6.668 | 1981.4 samples/s | 31.0 steps/s
[Step=21600 Epoch=42.1] | Loss=0.01161 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.625 | L2-Norm(final)=6.670 | 5119.0 samples/s | 80.0 steps/s
[Step=21650 Epoch=42.2] | Loss=0.01150 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.629 | L2-Norm(final)=6.672 | 4990.0 samples/s | 78.0 steps/s
[Step=21700 Epoch=42.3] | Loss=0.01144 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.632 | L2-Norm(final)=6.674 | 5023.4 samples/s | 78.5 steps/s
[Step=21750 Epoch=42.4] | Loss=0.01125 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.636 | L2-Norm(final)=6.676 | 5115.9 samples/s | 79.9 steps/s
[Step=21800 Epoch=42.5] | Loss=0.01107 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.639 | L2-Norm(final)=6.677 | 5025.2 samples/s | 78.5 steps/s
[Step=21850 Epoch=42.6] | Loss=0.01094 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.643 | L2-Norm(final)=6.679 | 5064.0 samples/s | 79.1 steps/s
[Step=21900 Epoch=42.7] | Loss=0.01087 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.646 | L2-Norm(final)=6.681 | 5079.4 samples/s | 79.4 steps/s
[Step=21950 Epoch=42.8] | Loss=0.01082 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.649 | L2-Norm(final)=6.683 | 5011.5 samples/s | 78.3 steps/s
[Step=22000 Epoch=42.9] | Loss=0.01067 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.652 | L2-Norm(final)=6.685 | 5062.2 samples/s | 79.1 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step22000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=22001 Epoch=43.0] | Loss=0.00355 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.335 | L2-Norm(final)=6.732 | 3775.6 samples/s | 59.0 steps/s
[Step=22050 Epoch=43.1] | Loss=0.01339 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.346 | L2-Norm(final)=6.734 | 5504.1 samples/s | 86.0 steps/s
[Step=22100 Epoch=43.2] | Loss=0.01136 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=6.738 | 5676.9 samples/s | 88.7 steps/s
[Step=22150 Epoch=43.3] | Loss=0.01182 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.366 | L2-Norm(final)=6.746 | 5739.0 samples/s | 89.7 steps/s
[Step=22200 Epoch=43.4] | Loss=0.01145 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=6.754 | 5575.3 samples/s | 87.1 steps/s
[Step=22250 Epoch=43.5] | Loss=0.01107 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.384 | L2-Norm(final)=6.761 | 5762.2 samples/s | 90.0 steps/s
[Step=22300 Epoch=43.6] | Loss=0.01113 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.392 | L2-Norm(final)=6.769 | 5595.8 samples/s | 87.4 steps/s
[Step=22350 Epoch=43.7] | Loss=0.01114 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.400 | L2-Norm(final)=6.776 | 5621.4 samples/s | 87.8 steps/s
[Step=22400 Epoch=43.8] | Loss=0.01097 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.408 | L2-Norm(final)=6.783 | 5696.1 samples/s | 89.0 steps/s
[Step=22450 Epoch=43.9] | Loss=0.01100 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.416 | L2-Norm(final)=6.789 | 5643.7 samples/s | 88.2 steps/s
[Step=22500 Epoch=44.0] | Loss=0.01125 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.424 | L2-Norm(final)=6.796 | 7235.7 samples/s | 113.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=44.0] | Loss=0.00053 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.498 | L2-Norm(final)=6.853 | 3925.2 samples/s | 61.3 steps/s
[Step=22550 Epoch=44.1] | Loss=0.00990 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.509 | L2-Norm(final)=6.860 | 4771.5 samples/s | 74.6 steps/s
[Step=22600 Epoch=44.2] | Loss=0.01281 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.521 | L2-Norm(final)=6.863 | 4994.0 samples/s | 78.0 steps/s
[Step=22650 Epoch=44.3] | Loss=0.01274 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.532 | L2-Norm(final)=6.863 | 5008.4 samples/s | 78.3 steps/s
[Step=22700 Epoch=44.4] | Loss=0.01245 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.541 | L2-Norm(final)=6.864 | 5069.4 samples/s | 79.2 steps/s
[Step=22750 Epoch=44.5] | Loss=0.01240 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.550 | L2-Norm(final)=6.866 | 5033.7 samples/s | 78.7 steps/s
[Step=22800 Epoch=44.6] | Loss=0.01272 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.558 | L2-Norm(final)=6.868 | 5042.5 samples/s | 78.8 steps/s
[Step=22850 Epoch=44.7] | Loss=0.01297 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.566 | L2-Norm(final)=6.870 | 5077.2 samples/s | 79.3 steps/s
[Step=22900 Epoch=44.8] | Loss=0.01315 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.574 | L2-Norm(final)=6.871 | 5084.8 samples/s | 79.5 steps/s
[Step=22950 Epoch=44.9] | Loss=0.01302 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.581 | L2-Norm(final)=6.873 | 5098.5 samples/s | 79.7 steps/s
[Step=23000 Epoch=45.0] | Loss=0.01308 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.588 | L2-Norm(final)=6.874 | 6083.5 samples/s | 95.1 steps/s
[Step=23050 Epoch=45.1] | Loss=0.01275 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.594 | L2-Norm(final)=6.876 | 1925.4 samples/s | 30.1 steps/s
[Step=23100 Epoch=45.2] | Loss=0.01244 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.600 | L2-Norm(final)=6.878 | 5062.2 samples/s | 79.1 steps/s
[Step=23150 Epoch=45.3] | Loss=0.01210 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.606 | L2-Norm(final)=6.880 | 4980.4 samples/s | 77.8 steps/s
[Step=23200 Epoch=45.4] | Loss=0.01199 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.612 | L2-Norm(final)=6.882 | 5044.9 samples/s | 78.8 steps/s
[Step=23250 Epoch=45.5] | Loss=0.01182 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.617 | L2-Norm(final)=6.884 | 5052.5 samples/s | 78.9 steps/s
[Step=23300 Epoch=45.6] | Loss=0.01179 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.622 | L2-Norm(final)=6.886 | 5034.9 samples/s | 78.7 steps/s
[Step=23350 Epoch=45.6] | Loss=0.01166 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.627 | L2-Norm(final)=6.888 | 5050.0 samples/s | 78.9 steps/s
[Step=23400 Epoch=45.7] | Loss=0.01149 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.631 | L2-Norm(final)=6.890 | 5128.0 samples/s | 80.1 steps/s
[Step=23450 Epoch=45.8] | Loss=0.01126 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.636 | L2-Norm(final)=6.892 | 5040.6 samples/s | 78.8 steps/s
[Step=23500 Epoch=45.9] | Loss=0.01125 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.640 | L2-Norm(final)=6.894 | 5453.2 samples/s | 85.2 steps/s
[Step=23550 Epoch=46.0] | Loss=0.01108 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.644 | L2-Norm(final)=6.896 | 2016.8 samples/s | 31.5 steps/s
[Step=23600 Epoch=46.1] | Loss=0.01098 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.648 | L2-Norm(final)=6.898 | 5134.9 samples/s | 80.2 steps/s
[Step=23650 Epoch=46.2] | Loss=0.01091 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.652 | L2-Norm(final)=6.900 | 4986.7 samples/s | 77.9 steps/s
[Step=23700 Epoch=46.3] | Loss=0.01070 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.656 | L2-Norm(final)=6.902 | 4978.5 samples/s | 77.8 steps/s
[Step=23750 Epoch=46.4] | Loss=0.01064 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.659 | L2-Norm(final)=6.904 | 5020.3 samples/s | 78.4 steps/s
[Step=23800 Epoch=46.5] | Loss=0.01050 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.663 | L2-Norm(final)=6.905 | 5070.4 samples/s | 79.2 steps/s
[Step=23850 Epoch=46.6] | Loss=0.01044 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.666 | L2-Norm(final)=6.907 | 5074.6 samples/s | 79.3 steps/s
[Step=23900 Epoch=46.7] | Loss=0.01041 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.670 | L2-Norm(final)=6.909 | 5100.0 samples/s | 79.7 steps/s
[Step=23950 Epoch=46.8] | Loss=0.01033 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.673 | L2-Norm(final)=6.911 | 4983.4 samples/s | 77.9 steps/s
[Step=24000 Epoch=46.9] | Loss=0.01026 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.676 | L2-Norm(final)=6.913 | 5058.3 samples/s | 79.0 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06780 | acc=0.9691 | tpr=0.9790 | fpr=0.0523 | 4432.7 samples/s | 17.3 steps/s
Avg test loss: 0.07065, Avg test acc: 0.96859, Avg tpr: 0.97820, Avg fpr: 0.05256, total FA: 410

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06201 | acc=0.9685 | tpr=0.9774 | fpr=0.0508 | 4459.9 samples/s | 17.4 steps/s
Avg test loss: 0.06941, Avg test acc: 0.96666, Avg tpr: 0.97639, Avg fpr: 0.05474, total FA: 427

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.86214 | acc=0.3225 | tpr=0.0388 | fpr=0.0614 | 4435.6 samples/s | 17.3 steps/s
Avg test loss: 4.86798, Avg test acc: 0.32070, Avg tpr: 0.04028, Avg fpr: 0.06256, total FA: 488

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.38011 | acc=0.3132 | tpr=0.0483 | fpr=0.1115 | 4462.9 samples/s | 17.4 steps/s
Avg test loss: 5.37917, Avg test acc: 0.31261, Avg tpr: 0.04954, Avg fpr: 0.10883, total FA: 849

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.50928 | acc=0.1021 | tpr=0.6106 | fpr=0.9070 | 4542.4 samples/s | 17.7 steps/s
[Step= 100] | Loss=6.48668 | acc=0.1014 | tpr=0.6077 | fpr=0.9080 | 8670.3 samples/s | 33.9 steps/s
[Step= 150] | Loss=6.49679 | acc=0.1004 | tpr=0.5965 | fpr=0.9087 | 8622.7 samples/s | 33.7 steps/s
[Step= 200] | Loss=6.48914 | acc=0.1003 | tpr=0.5945 | fpr=0.9087 | 8887.5 samples/s | 34.7 steps/s
[Step= 250] | Loss=6.48682 | acc=0.1005 | tpr=0.6052 | fpr=0.9087 | 8604.3 samples/s | 33.6 steps/s
[Step= 300] | Loss=6.48451 | acc=0.1013 | tpr=0.6124 | fpr=0.9080 | 8876.1 samples/s | 34.7 steps/s
[Step= 350] | Loss=6.48035 | acc=0.1012 | tpr=0.6099 | fpr=0.9080 | 8704.1 samples/s | 34.0 steps/s
[Step= 400] | Loss=6.47838 | acc=0.1015 | tpr=0.6127 | fpr=0.9078 | 8749.2 samples/s | 34.2 steps/s
[Step= 450] | Loss=6.48792 | acc=0.1012 | tpr=0.6027 | fpr=0.9079 | 8850.6 samples/s | 34.6 steps/s
[Step= 500] | Loss=6.49156 | acc=0.1013 | tpr=0.6044 | fpr=0.9078 | 8842.4 samples/s | 34.5 steps/s
[Step= 550] | Loss=6.49521 | acc=0.1013 | tpr=0.6045 | fpr=0.9079 | 15739.1 samples/s | 61.5 steps/s
Avg test loss: 6.49653, Avg test acc: 0.10122, Avg tpr: 0.60539, Avg fpr: 0.90794, total FA: 126066

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.75772 | acc=0.1210 | tpr=0.6814 | fpr=0.8891 | 4459.4 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.74290 | acc=0.1209 | tpr=0.6887 | fpr=0.8897 | 8693.9 samples/s | 34.0 steps/s
[Step= 150] | Loss=5.76327 | acc=0.1208 | tpr=0.6844 | fpr=0.8896 | 8853.4 samples/s | 34.6 steps/s
[Step= 200] | Loss=5.75677 | acc=0.1198 | tpr=0.6765 | fpr=0.8903 | 8849.6 samples/s | 34.6 steps/s
[Step= 250] | Loss=5.75743 | acc=0.1204 | tpr=0.6803 | fpr=0.8898 | 8918.4 samples/s | 34.8 steps/s
[Step= 300] | Loss=5.75757 | acc=0.1205 | tpr=0.6822 | fpr=0.8897 | 8770.1 samples/s | 34.3 steps/s
[Step= 350] | Loss=5.75456 | acc=0.1202 | tpr=0.6769 | fpr=0.8899 | 8785.9 samples/s | 34.3 steps/s
[Step= 400] | Loss=5.75279 | acc=0.1206 | tpr=0.6800 | fpr=0.8896 | 9035.7 samples/s | 35.3 steps/s
[Step= 450] | Loss=5.76246 | acc=0.1204 | tpr=0.6738 | fpr=0.8896 | 8562.4 samples/s | 33.4 steps/s
[Step= 500] | Loss=5.76681 | acc=0.1202 | tpr=0.6762 | fpr=0.8898 | 8877.3 samples/s | 34.7 steps/s
[Step= 550] | Loss=5.77170 | acc=0.1203 | tpr=0.6753 | fpr=0.8898 | 15930.9 samples/s | 62.2 steps/s
Avg test loss: 5.77243, Avg test acc: 0.12020, Avg tpr: 0.67591, Avg fpr: 0.88990, total FA: 123561

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12472 | acc=0.9804 | tpr=0.8938 | fpr=0.0181 | 4469.0 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.12919 | acc=0.9803 | tpr=0.9211 | fpr=0.0186 | 8623.4 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.13416 | acc=0.9796 | tpr=0.9308 | fpr=0.0195 | 8798.4 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.13511 | acc=0.9797 | tpr=0.9311 | fpr=0.0194 | 9254.8 samples/s | 36.2 steps/s
[Step= 250] | Loss=0.13343 | acc=0.9796 | tpr=0.9284 | fpr=0.0195 | 8321.6 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.13643 | acc=0.9794 | tpr=0.9280 | fpr=0.0197 | 8849.7 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.13801 | acc=0.9791 | tpr=0.9292 | fpr=0.0200 | 8960.2 samples/s | 35.0 steps/s
[Step= 400] | Loss=0.13863 | acc=0.9790 | tpr=0.9283 | fpr=0.0201 | 8781.6 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.14163 | acc=0.9786 | tpr=0.9265 | fpr=0.0205 | 8586.1 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.14095 | acc=0.9787 | tpr=0.9264 | fpr=0.0204 | 8743.8 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.14042 | acc=0.9787 | tpr=0.9252 | fpr=0.0204 | 16065.9 samples/s | 62.8 steps/s
Avg test loss: 0.14006, Avg test acc: 0.97868, Avg tpr: 0.92552, Avg fpr: 0.02035, total FA: 2826

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13745 | acc=0.9788 | tpr=0.9425 | fpr=0.0205 | 4565.8 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.14600 | acc=0.9781 | tpr=0.9467 | fpr=0.0213 | 8420.7 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.15050 | acc=0.9771 | tpr=0.9510 | fpr=0.0224 | 8871.1 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.14968 | acc=0.9773 | tpr=0.9530 | fpr=0.0222 | 8814.1 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.14749 | acc=0.9775 | tpr=0.9493 | fpr=0.0220 | 8544.5 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.14998 | acc=0.9773 | tpr=0.9476 | fpr=0.0222 | 8862.3 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.15095 | acc=0.9773 | tpr=0.9499 | fpr=0.0222 | 8730.4 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.15176 | acc=0.9771 | tpr=0.9497 | fpr=0.0224 | 8854.6 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.15498 | acc=0.9768 | tpr=0.9469 | fpr=0.0227 | 8897.9 samples/s | 34.8 steps/s
[Step= 500] | Loss=0.15441 | acc=0.9768 | tpr=0.9471 | fpr=0.0227 | 8617.4 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.15351 | acc=0.9768 | tpr=0.9443 | fpr=0.0226 | 16489.6 samples/s | 64.4 steps/s
Avg test loss: 0.15305, Avg test acc: 0.97683, Avg tpr: 0.94453, Avg fpr: 0.02259, total FA: 3136

server round 25/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=32001 Epoch=122.6] | Loss=0.00001 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=8.505 | 3941.1 samples/s | 61.6 steps/s
[Step=32050 Epoch=122.8] | Loss=0.00028 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.288 | L2-Norm(final)=8.513 | 4939.2 samples/s | 77.2 steps/s
[Step=32100 Epoch=123.0] | Loss=0.00032 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.287 | L2-Norm(final)=8.516 | 5308.5 samples/s | 82.9 steps/s
[Step=32150 Epoch=123.2] | Loss=0.00028 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.287 | L2-Norm(final)=8.517 | 5441.8 samples/s | 85.0 steps/s
[Step=32200 Epoch=123.4] | Loss=0.00025 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.286 | L2-Norm(final)=8.521 | 5252.5 samples/s | 82.1 steps/s
[Step=32250 Epoch=123.6] | Loss=0.00022 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.285 | L2-Norm(final)=8.524 | 6919.4 samples/s | 108.1 steps/s
[Step=32300 Epoch=123.8] | Loss=0.00019 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.283 | L2-Norm(final)=8.527 | 1935.6 samples/s | 30.2 steps/s
[Step=32350 Epoch=124.0] | Loss=0.00017 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.281 | L2-Norm(final)=8.530 | 5201.9 samples/s | 81.3 steps/s
[Step=32400 Epoch=124.1] | Loss=0.00016 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.278 | L2-Norm(final)=8.532 | 5264.3 samples/s | 82.3 steps/s
[Step=32450 Epoch=124.3] | Loss=0.00015 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.275 | L2-Norm(final)=8.535 | 5359.9 samples/s | 83.7 steps/s
[Step=32500 Epoch=124.5] | Loss=0.00014 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.272 | L2-Norm(final)=8.538 | 5972.3 samples/s | 93.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=32501 Epoch=124.5] | Loss=0.00005 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.240 | L2-Norm(final)=8.563 | 3786.4 samples/s | 59.2 steps/s
[Step=32550 Epoch=124.7] | Loss=0.00004 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.235 | L2-Norm(final)=8.565 | 4606.9 samples/s | 72.0 steps/s
[Step=32600 Epoch=124.9] | Loss=0.00004 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.230 | L2-Norm(final)=8.566 | 4774.6 samples/s | 74.6 steps/s
[Step=32650 Epoch=125.1] | Loss=0.00004 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.224 | L2-Norm(final)=8.569 | 4805.7 samples/s | 75.1 steps/s
[Step=32700 Epoch=125.3] | Loss=0.00004 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.218 | L2-Norm(final)=8.571 | 4710.6 samples/s | 73.6 steps/s
[Step=32750 Epoch=125.5] | Loss=0.00003 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.211 | L2-Norm(final)=8.572 | 5897.4 samples/s | 92.1 steps/s
[Step=32800 Epoch=125.7] | Loss=0.00003 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.205 | L2-Norm(final)=8.574 | 1880.6 samples/s | 29.4 steps/s
[Step=32850 Epoch=125.9] | Loss=0.00003 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.198 | L2-Norm(final)=8.575 | 4731.5 samples/s | 73.9 steps/s
[Step=32900 Epoch=126.1] | Loss=0.00003 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.192 | L2-Norm(final)=8.576 | 4814.6 samples/s | 75.2 steps/s
[Step=32950 Epoch=126.3] | Loss=0.00002 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.185 | L2-Norm(final)=8.577 | 4708.2 samples/s | 73.6 steps/s
[Step=33000 Epoch=126.4] | Loss=0.00002 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.178 | L2-Norm(final)=8.578 | 5309.2 samples/s | 83.0 steps/s
[Step=33050 Epoch=126.6] | Loss=0.00002 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.170 | L2-Norm(final)=8.579 | 1960.2 samples/s | 30.6 steps/s
[Step=33100 Epoch=126.8] | Loss=0.00002 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.163 | L2-Norm(final)=8.580 | 4761.3 samples/s | 74.4 steps/s
[Step=33150 Epoch=127.0] | Loss=0.00002 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.156 | L2-Norm(final)=8.581 | 4841.1 samples/s | 75.6 steps/s
[Step=33200 Epoch=127.2] | Loss=0.00002 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.149 | L2-Norm(final)=8.582 | 4770.6 samples/s | 74.5 steps/s
[Step=33250 Epoch=127.4] | Loss=0.00002 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.141 | L2-Norm(final)=8.583 | 4792.7 samples/s | 74.9 steps/s
[Step=33300 Epoch=127.6] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.134 | L2-Norm(final)=8.584 | 2031.0 samples/s | 31.7 steps/s
[Step=33350 Epoch=127.8] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.126 | L2-Norm(final)=8.585 | 4835.5 samples/s | 75.6 steps/s
[Step=33400 Epoch=128.0] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.118 | L2-Norm(final)=8.586 | 4826.0 samples/s | 75.4 steps/s
[Step=33450 Epoch=128.2] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.110 | L2-Norm(final)=8.586 | 4795.0 samples/s | 74.9 steps/s
[Step=33500 Epoch=128.4] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.102 | L2-Norm(final)=8.587 | 4765.4 samples/s | 74.5 steps/s
[Step=33550 Epoch=128.6] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.094 | L2-Norm(final)=8.588 | 2032.7 samples/s | 31.8 steps/s
[Step=33600 Epoch=128.7] | Loss=0.00001 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.086 | L2-Norm(final)=8.589 | 4785.8 samples/s | 74.8 steps/s
[Step=33650 Epoch=128.9] | Loss=0.00001 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.078 | L2-Norm(final)=8.590 | 4744.4 samples/s | 74.1 steps/s
[Step=33700 Epoch=129.1] | Loss=0.00001 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.070 | L2-Norm(final)=8.590 | 4825.4 samples/s | 75.4 steps/s
[Step=33750 Epoch=129.3] | Loss=0.00001 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.061 | L2-Norm(final)=8.591 | 4748.0 samples/s | 74.2 steps/s
[Step=33800 Epoch=129.5] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.053 | L2-Norm(final)=8.592 | 6551.1 samples/s | 102.4 steps/s
[Step=33850 Epoch=129.7] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.044 | L2-Norm(final)=8.593 | 1838.9 samples/s | 28.7 steps/s
[Step=33900 Epoch=129.9] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.035 | L2-Norm(final)=8.593 | 4711.8 samples/s | 73.6 steps/s
[Step=33950 Epoch=130.1] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.027 | L2-Norm(final)=8.594 | 4798.6 samples/s | 75.0 steps/s
[Step=34000 Epoch=130.3] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.018 | L2-Norm(final)=8.595 | 4795.6 samples/s | 74.9 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step34000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=22001 Epoch=84.7] | Loss=0.00008 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=6.834 | 4012.9 samples/s | 62.7 steps/s
[Step=22050 Epoch=84.9] | Loss=0.00094 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.301 | L2-Norm(final)=6.838 | 4663.8 samples/s | 72.9 steps/s
[Step=22100 Epoch=85.1] | Loss=0.00078 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.313 | L2-Norm(final)=6.849 | 5330.8 samples/s | 83.3 steps/s
[Step=22150 Epoch=85.3] | Loss=0.00102 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.332 | L2-Norm(final)=6.860 | 5287.8 samples/s | 82.6 steps/s
[Step=22200 Epoch=85.5] | Loss=0.00085 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=6.871 | 5333.2 samples/s | 83.3 steps/s
[Step=22250 Epoch=85.6] | Loss=0.00072 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.365 | L2-Norm(final)=6.881 | 7057.8 samples/s | 110.3 steps/s
[Step=22300 Epoch=85.8] | Loss=0.00062 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.372 | L2-Norm(final)=6.888 | 1928.5 samples/s | 30.1 steps/s
[Step=22350 Epoch=86.0] | Loss=0.00054 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=6.895 | 5341.2 samples/s | 83.5 steps/s
[Step=22400 Epoch=86.2] | Loss=0.00049 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.377 | L2-Norm(final)=6.900 | 5320.9 samples/s | 83.1 steps/s
[Step=22450 Epoch=86.4] | Loss=0.00044 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.376 | L2-Norm(final)=6.906 | 5419.1 samples/s | 84.7 steps/s
[Step=22500 Epoch=86.6] | Loss=0.00041 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=6.911 | 5899.8 samples/s | 92.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=86.6] | Loss=0.00004 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=6.959 | 3838.1 samples/s | 60.0 steps/s
[Step=22550 Epoch=86.8] | Loss=0.00009 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.346 | L2-Norm(final)=6.962 | 4555.5 samples/s | 71.2 steps/s
[Step=22600 Epoch=87.0] | Loss=0.00223 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.353 | L2-Norm(final)=6.962 | 4806.8 samples/s | 75.1 steps/s
[Step=22650 Epoch=87.2] | Loss=0.00454 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.388 | L2-Norm(final)=6.950 | 4782.9 samples/s | 74.7 steps/s
[Step=22700 Epoch=87.4] | Loss=0.00386 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.423 | L2-Norm(final)=6.940 | 4774.2 samples/s | 74.6 steps/s
[Step=22750 Epoch=87.6] | Loss=0.00322 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.446 | L2-Norm(final)=6.935 | 6121.9 samples/s | 95.7 steps/s
[Step=22800 Epoch=87.8] | Loss=0.00269 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.460 | L2-Norm(final)=6.933 | 1845.2 samples/s | 28.8 steps/s
[Step=22850 Epoch=88.0] | Loss=0.00232 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.469 | L2-Norm(final)=6.932 | 4791.3 samples/s | 74.9 steps/s
[Step=22900 Epoch=88.2] | Loss=0.00203 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.474 | L2-Norm(final)=6.931 | 4863.3 samples/s | 76.0 steps/s
[Step=22950 Epoch=88.3] | Loss=0.00181 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.477 | L2-Norm(final)=6.931 | 4729.9 samples/s | 73.9 steps/s
[Step=23000 Epoch=88.5] | Loss=0.00163 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=6.931 | 5416.0 samples/s | 84.6 steps/s
[Step=23050 Epoch=88.7] | Loss=0.00149 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=6.930 | 1927.8 samples/s | 30.1 steps/s
[Step=23100 Epoch=88.9] | Loss=0.00136 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=6.931 | 4776.1 samples/s | 74.6 steps/s
[Step=23150 Epoch=89.1] | Loss=0.00126 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.477 | L2-Norm(final)=6.931 | 4828.9 samples/s | 75.5 steps/s
[Step=23200 Epoch=89.3] | Loss=0.00117 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.474 | L2-Norm(final)=6.931 | 4709.3 samples/s | 73.6 steps/s
[Step=23250 Epoch=89.5] | Loss=0.00109 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.472 | L2-Norm(final)=6.931 | 4838.7 samples/s | 75.6 steps/s
[Step=23300 Epoch=89.7] | Loss=0.00103 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.469 | L2-Norm(final)=6.931 | 2010.2 samples/s | 31.4 steps/s
[Step=23350 Epoch=89.9] | Loss=0.00097 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.466 | L2-Norm(final)=6.931 | 4860.2 samples/s | 75.9 steps/s
[Step=23400 Epoch=90.1] | Loss=0.00091 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.462 | L2-Norm(final)=6.932 | 4802.8 samples/s | 75.0 steps/s
[Step=23450 Epoch=90.3] | Loss=0.00087 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.458 | L2-Norm(final)=6.932 | 4847.3 samples/s | 75.7 steps/s
[Step=23500 Epoch=90.5] | Loss=0.00082 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.454 | L2-Norm(final)=6.932 | 4700.0 samples/s | 73.4 steps/s
[Step=23550 Epoch=90.7] | Loss=0.00078 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.450 | L2-Norm(final)=6.932 | 2009.9 samples/s | 31.4 steps/s
[Step=23600 Epoch=90.8] | Loss=0.00075 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.445 | L2-Norm(final)=6.933 | 4789.4 samples/s | 74.8 steps/s
[Step=23650 Epoch=91.0] | Loss=0.00072 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.440 | L2-Norm(final)=6.933 | 4737.4 samples/s | 74.0 steps/s
[Step=23700 Epoch=91.2] | Loss=0.00069 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.435 | L2-Norm(final)=6.933 | 4781.3 samples/s | 74.7 steps/s
[Step=23750 Epoch=91.4] | Loss=0.00066 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.430 | L2-Norm(final)=6.934 | 4757.6 samples/s | 74.3 steps/s
[Step=23800 Epoch=91.6] | Loss=0.00063 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.425 | L2-Norm(final)=6.934 | 7031.0 samples/s | 109.9 steps/s
[Step=23850 Epoch=91.8] | Loss=0.00061 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.420 | L2-Norm(final)=6.934 | 1781.3 samples/s | 27.8 steps/s
[Step=23900 Epoch=92.0] | Loss=0.00059 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.415 | L2-Norm(final)=6.935 | 4801.0 samples/s | 75.0 steps/s
[Step=23950 Epoch=92.2] | Loss=0.00057 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.409 | L2-Norm(final)=6.935 | 4782.2 samples/s | 74.7 steps/s
[Step=24000 Epoch=92.4] | Loss=0.00055 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.403 | L2-Norm(final)=6.935 | 4803.9 samples/s | 75.1 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06780 | acc=0.9691 | tpr=0.9790 | fpr=0.0523 | 4428.2 samples/s | 17.3 steps/s
Avg test loss: 0.07065, Avg test acc: 0.96859, Avg tpr: 0.97820, Avg fpr: 0.05256, total FA: 410

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06201 | acc=0.9685 | tpr=0.9774 | fpr=0.0508 | 4515.1 samples/s | 17.6 steps/s
Avg test loss: 0.06941, Avg test acc: 0.96666, Avg tpr: 0.97639, Avg fpr: 0.05474, total FA: 427

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.04154 | acc=0.3214 | tpr=0.0450 | fpr=0.0783 | 4646.2 samples/s | 18.1 steps/s
Avg test loss: 5.04317, Avg test acc: 0.31938, Avg tpr: 0.04645, Avg fpr: 0.08037, total FA: 627

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.96630 | acc=0.3087 | tpr=0.0258 | fpr=0.0771 | 4532.9 samples/s | 17.7 steps/s
Avg test loss: 5.98819, Avg test acc: 0.30680, Avg tpr: 0.02693, Avg fpr: 0.07768, total FA: 606

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.50928 | acc=0.1021 | tpr=0.6106 | fpr=0.9070 | 4462.1 samples/s | 17.4 steps/s
[Step= 100] | Loss=6.48668 | acc=0.1014 | tpr=0.6077 | fpr=0.9080 | 8621.2 samples/s | 33.7 steps/s
[Step= 150] | Loss=6.49679 | acc=0.1004 | tpr=0.5965 | fpr=0.9087 | 8847.6 samples/s | 34.6 steps/s
[Step= 200] | Loss=6.48914 | acc=0.1003 | tpr=0.5945 | fpr=0.9087 | 8966.8 samples/s | 35.0 steps/s
[Step= 250] | Loss=6.48682 | acc=0.1005 | tpr=0.6052 | fpr=0.9087 | 8639.5 samples/s | 33.7 steps/s
[Step= 300] | Loss=6.48451 | acc=0.1013 | tpr=0.6124 | fpr=0.9080 | 9589.7 samples/s | 37.5 steps/s
[Step= 350] | Loss=6.48035 | acc=0.1012 | tpr=0.6099 | fpr=0.9080 | 8130.6 samples/s | 31.8 steps/s
[Step= 400] | Loss=6.47838 | acc=0.1015 | tpr=0.6127 | fpr=0.9078 | 9196.3 samples/s | 35.9 steps/s
[Step= 450] | Loss=6.48792 | acc=0.1012 | tpr=0.6027 | fpr=0.9079 | 8491.5 samples/s | 33.2 steps/s
[Step= 500] | Loss=6.49156 | acc=0.1013 | tpr=0.6044 | fpr=0.9078 | 8794.6 samples/s | 34.4 steps/s
[Step= 550] | Loss=6.49521 | acc=0.1013 | tpr=0.6045 | fpr=0.9079 | 16226.5 samples/s | 63.4 steps/s
Avg test loss: 6.49653, Avg test acc: 0.10122, Avg tpr: 0.60539, Avg fpr: 0.90794, total FA: 126066

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.75772 | acc=0.1210 | tpr=0.6814 | fpr=0.8891 | 4427.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=5.74290 | acc=0.1209 | tpr=0.6887 | fpr=0.8897 | 8948.9 samples/s | 35.0 steps/s
[Step= 150] | Loss=5.76327 | acc=0.1208 | tpr=0.6844 | fpr=0.8896 | 9049.2 samples/s | 35.3 steps/s
[Step= 200] | Loss=5.75677 | acc=0.1198 | tpr=0.6765 | fpr=0.8903 | 8771.4 samples/s | 34.3 steps/s
[Step= 250] | Loss=5.75743 | acc=0.1204 | tpr=0.6803 | fpr=0.8898 | 8676.3 samples/s | 33.9 steps/s
[Step= 300] | Loss=5.75757 | acc=0.1205 | tpr=0.6822 | fpr=0.8897 | 8576.1 samples/s | 33.5 steps/s
[Step= 350] | Loss=5.75456 | acc=0.1202 | tpr=0.6769 | fpr=0.8899 | 8955.0 samples/s | 35.0 steps/s
[Step= 400] | Loss=5.75279 | acc=0.1206 | tpr=0.6800 | fpr=0.8896 | 9030.4 samples/s | 35.3 steps/s
[Step= 450] | Loss=5.76246 | acc=0.1204 | tpr=0.6738 | fpr=0.8896 | 8471.5 samples/s | 33.1 steps/s
[Step= 500] | Loss=5.76681 | acc=0.1202 | tpr=0.6762 | fpr=0.8898 | 9024.7 samples/s | 35.3 steps/s
[Step= 550] | Loss=5.77170 | acc=0.1203 | tpr=0.6753 | fpr=0.8898 | 15621.1 samples/s | 61.0 steps/s
Avg test loss: 5.77243, Avg test acc: 0.12020, Avg tpr: 0.67591, Avg fpr: 0.88990, total FA: 123561

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12736 | acc=0.9810 | tpr=0.9381 | fpr=0.0182 | 4467.0 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.13431 | acc=0.9803 | tpr=0.9467 | fpr=0.0191 | 8912.0 samples/s | 34.8 steps/s
[Step= 150] | Loss=0.13938 | acc=0.9792 | tpr=0.9481 | fpr=0.0202 | 8552.2 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.13969 | acc=0.9795 | tpr=0.9497 | fpr=0.0200 | 9128.2 samples/s | 35.7 steps/s
[Step= 250] | Loss=0.13780 | acc=0.9795 | tpr=0.9459 | fpr=0.0199 | 8683.2 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.14073 | acc=0.9793 | tpr=0.9447 | fpr=0.0201 | 8868.9 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.14191 | acc=0.9791 | tpr=0.9443 | fpr=0.0203 | 8711.0 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.14268 | acc=0.9789 | tpr=0.9431 | fpr=0.0204 | 8883.8 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.14581 | acc=0.9786 | tpr=0.9416 | fpr=0.0208 | 8526.2 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.14505 | acc=0.9786 | tpr=0.9432 | fpr=0.0208 | 8917.9 samples/s | 34.8 steps/s
[Step= 550] | Loss=0.14437 | acc=0.9786 | tpr=0.9403 | fpr=0.0207 | 15454.7 samples/s | 60.4 steps/s
Avg test loss: 0.14392, Avg test acc: 0.97859, Avg tpr: 0.94057, Avg fpr: 0.02072, total FA: 2877

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14728 | acc=0.9783 | tpr=0.9248 | fpr=0.0208 | 4434.2 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.15920 | acc=0.9769 | tpr=0.9382 | fpr=0.0224 | 8955.0 samples/s | 35.0 steps/s
[Step= 150] | Loss=0.16371 | acc=0.9762 | tpr=0.9409 | fpr=0.0231 | 8852.6 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.16360 | acc=0.9764 | tpr=0.9443 | fpr=0.0230 | 8859.8 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.16063 | acc=0.9766 | tpr=0.9450 | fpr=0.0228 | 8528.4 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.16398 | acc=0.9761 | tpr=0.9447 | fpr=0.0233 | 8672.7 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.16559 | acc=0.9760 | tpr=0.9480 | fpr=0.0235 | 8864.4 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.16642 | acc=0.9758 | tpr=0.9475 | fpr=0.0237 | 8865.0 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.16990 | acc=0.9754 | tpr=0.9450 | fpr=0.0240 | 8655.8 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.16915 | acc=0.9756 | tpr=0.9454 | fpr=0.0239 | 8879.1 samples/s | 34.7 steps/s
[Step= 550] | Loss=0.16829 | acc=0.9756 | tpr=0.9419 | fpr=0.0238 | 15555.8 samples/s | 60.8 steps/s
Avg test loss: 0.16782, Avg test acc: 0.97559, Avg tpr: 0.94176, Avg fpr: 0.02380, total FA: 3304

server round 26/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=24001 Epoch=46.9] | Loss=0.01119 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.230 | L2-Norm(final)=6.971 | 3837.5 samples/s | 60.0 steps/s
[Step=24050 Epoch=47.0] | Loss=0.01324 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.239 | L2-Norm(final)=6.972 | 5435.6 samples/s | 84.9 steps/s
[Step=24100 Epoch=47.1] | Loss=0.00976 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.249 | L2-Norm(final)=6.979 | 5708.0 samples/s | 89.2 steps/s
[Step=24150 Epoch=47.2] | Loss=0.00953 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.257 | L2-Norm(final)=6.988 | 5659.9 samples/s | 88.4 steps/s
[Step=24200 Epoch=47.3] | Loss=0.00983 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.266 | L2-Norm(final)=6.996 | 5640.9 samples/s | 88.1 steps/s
[Step=24250 Epoch=47.4] | Loss=0.00970 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.274 | L2-Norm(final)=7.004 | 5650.3 samples/s | 88.3 steps/s
[Step=24300 Epoch=47.5] | Loss=0.01015 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.282 | L2-Norm(final)=7.011 | 5648.9 samples/s | 88.3 steps/s
[Step=24350 Epoch=47.6] | Loss=0.01069 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.291 | L2-Norm(final)=7.018 | 5662.2 samples/s | 88.5 steps/s
[Step=24400 Epoch=47.7] | Loss=0.01051 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.300 | L2-Norm(final)=7.025 | 5757.2 samples/s | 90.0 steps/s
[Step=24450 Epoch=47.8] | Loss=0.01050 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.308 | L2-Norm(final)=7.033 | 5734.5 samples/s | 89.6 steps/s
[Step=24500 Epoch=47.9] | Loss=0.01044 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.316 | L2-Norm(final)=7.040 | 7096.2 samples/s | 110.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=47.9] | Loss=0.00432 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.397 | L2-Norm(final)=7.112 | 3820.2 samples/s | 59.7 steps/s
[Step=24550 Epoch=48.0] | Loss=0.01122 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.406 | L2-Norm(final)=7.121 | 4965.5 samples/s | 77.6 steps/s
[Step=24600 Epoch=48.1] | Loss=0.01140 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.417 | L2-Norm(final)=7.124 | 5035.5 samples/s | 78.7 steps/s
[Step=24650 Epoch=48.2] | Loss=0.01219 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.425 | L2-Norm(final)=7.125 | 4998.1 samples/s | 78.1 steps/s
[Step=24700 Epoch=48.3] | Loss=0.01182 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.431 | L2-Norm(final)=7.125 | 5047.1 samples/s | 78.9 steps/s
[Step=24750 Epoch=48.4] | Loss=0.01202 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.438 | L2-Norm(final)=7.127 | 5008.9 samples/s | 78.3 steps/s
[Step=24800 Epoch=48.5] | Loss=0.01201 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.445 | L2-Norm(final)=7.129 | 5073.9 samples/s | 79.3 steps/s
[Step=24850 Epoch=48.6] | Loss=0.01188 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=7.130 | 5109.2 samples/s | 79.8 steps/s
[Step=24900 Epoch=48.7] | Loss=0.01239 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.459 | L2-Norm(final)=7.131 | 4962.5 samples/s | 77.5 steps/s
[Step=24950 Epoch=48.8] | Loss=0.01225 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.465 | L2-Norm(final)=7.132 | 5082.1 samples/s | 79.4 steps/s
[Step=25000 Epoch=48.9] | Loss=0.01229 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.472 | L2-Norm(final)=7.133 | 6237.0 samples/s | 97.5 steps/s
[Step=25050 Epoch=49.0] | Loss=0.01247 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=7.135 | 1932.8 samples/s | 30.2 steps/s
[Step=25100 Epoch=49.1] | Loss=0.01196 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.486 | L2-Norm(final)=7.136 | 5027.3 samples/s | 78.6 steps/s
[Step=25150 Epoch=49.2] | Loss=0.01171 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.492 | L2-Norm(final)=7.138 | 5044.2 samples/s | 78.8 steps/s
[Step=25200 Epoch=49.3] | Loss=0.01154 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.497 | L2-Norm(final)=7.140 | 5007.1 samples/s | 78.2 steps/s
[Step=25250 Epoch=49.4] | Loss=0.01144 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.503 | L2-Norm(final)=7.141 | 5044.0 samples/s | 78.8 steps/s
[Step=25300 Epoch=49.5] | Loss=0.01117 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.508 | L2-Norm(final)=7.143 | 5118.9 samples/s | 80.0 steps/s
[Step=25350 Epoch=49.6] | Loss=0.01103 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.512 | L2-Norm(final)=7.144 | 5084.6 samples/s | 79.4 steps/s
[Step=25400 Epoch=49.7] | Loss=0.01103 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.516 | L2-Norm(final)=7.146 | 5018.2 samples/s | 78.4 steps/s
[Step=25450 Epoch=49.8] | Loss=0.01105 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.521 | L2-Norm(final)=7.147 | 5007.1 samples/s | 78.2 steps/s
[Step=25500 Epoch=49.9] | Loss=0.01103 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.525 | L2-Norm(final)=7.148 | 5517.4 samples/s | 86.2 steps/s
[Step=25550 Epoch=49.9] | Loss=0.01089 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.529 | L2-Norm(final)=7.150 | 2010.9 samples/s | 31.4 steps/s
[Step=25600 Epoch=50.0] | Loss=0.01072 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.533 | L2-Norm(final)=7.152 | 5045.6 samples/s | 78.8 steps/s
[Step=25650 Epoch=50.1] | Loss=0.01058 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.537 | L2-Norm(final)=7.154 | 5051.5 samples/s | 78.9 steps/s
[Step=25700 Epoch=50.2] | Loss=0.01052 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.541 | L2-Norm(final)=7.155 | 4992.9 samples/s | 78.0 steps/s
[Step=25750 Epoch=50.3] | Loss=0.01041 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.545 | L2-Norm(final)=7.157 | 5068.2 samples/s | 79.2 steps/s
[Step=25800 Epoch=50.4] | Loss=0.01031 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.548 | L2-Norm(final)=7.159 | 5114.1 samples/s | 79.9 steps/s
[Step=25850 Epoch=50.5] | Loss=0.01022 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.551 | L2-Norm(final)=7.160 | 5011.9 samples/s | 78.3 steps/s
[Step=25900 Epoch=50.6] | Loss=0.01008 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.555 | L2-Norm(final)=7.162 | 5044.2 samples/s | 78.8 steps/s
[Step=25950 Epoch=50.7] | Loss=0.01004 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.558 | L2-Norm(final)=7.164 | 5104.4 samples/s | 79.8 steps/s
[Step=26000 Epoch=50.8] | Loss=0.01000 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.561 | L2-Norm(final)=7.165 | 5039.3 samples/s | 78.7 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step26000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=24001 Epoch=92.4] | Loss=0.00017 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.230 | L2-Norm(final)=6.944 | 3892.4 samples/s | 60.8 steps/s
[Step=24050 Epoch=92.6] | Loss=0.00081 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.231 | L2-Norm(final)=6.947 | 5259.1 samples/s | 82.2 steps/s
[Step=24100 Epoch=92.8] | Loss=0.00057 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.238 | L2-Norm(final)=6.952 | 5339.9 samples/s | 83.4 steps/s
[Step=24150 Epoch=93.0] | Loss=0.00044 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.240 | L2-Norm(final)=6.958 | 5333.3 samples/s | 83.3 steps/s
[Step=24200 Epoch=93.2] | Loss=0.00037 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.239 | L2-Norm(final)=6.963 | 5387.6 samples/s | 84.2 steps/s
[Step=24250 Epoch=93.3] | Loss=0.00034 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.238 | L2-Norm(final)=6.968 | 7019.1 samples/s | 109.7 steps/s
[Step=24300 Epoch=93.5] | Loss=0.00030 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.237 | L2-Norm(final)=6.973 | 1922.2 samples/s | 30.0 steps/s
[Step=24350 Epoch=93.7] | Loss=0.00027 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.236 | L2-Norm(final)=6.978 | 5226.2 samples/s | 81.7 steps/s
[Step=24400 Epoch=93.9] | Loss=0.00024 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.233 | L2-Norm(final)=6.983 | 5338.3 samples/s | 83.4 steps/s
[Step=24450 Epoch=94.1] | Loss=0.00022 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.230 | L2-Norm(final)=6.987 | 5377.6 samples/s | 84.0 steps/s
[Step=24500 Epoch=94.3] | Loss=0.00021 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.227 | L2-Norm(final)=6.991 | 6141.7 samples/s | 96.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=94.3] | Loss=0.00006 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.193 | L2-Norm(final)=7.030 | 3794.8 samples/s | 59.3 steps/s
[Step=24550 Epoch=94.5] | Loss=0.00004 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.186 | L2-Norm(final)=7.033 | 4603.8 samples/s | 71.9 steps/s
[Step=24600 Epoch=94.7] | Loss=0.00005 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.179 | L2-Norm(final)=7.037 | 4745.1 samples/s | 74.1 steps/s
[Step=24650 Epoch=94.9] | Loss=0.00004 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.171 | L2-Norm(final)=7.040 | 4822.1 samples/s | 75.3 steps/s
[Step=24700 Epoch=95.1] | Loss=0.00004 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.163 | L2-Norm(final)=7.042 | 4760.5 samples/s | 74.4 steps/s
[Step=24750 Epoch=95.3] | Loss=0.00004 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.155 | L2-Norm(final)=7.045 | 6030.2 samples/s | 94.2 steps/s
[Step=24800 Epoch=95.5] | Loss=0.00003 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.146 | L2-Norm(final)=7.047 | 1863.4 samples/s | 29.1 steps/s
[Step=24850 Epoch=95.7] | Loss=0.00003 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.138 | L2-Norm(final)=7.049 | 4776.5 samples/s | 74.6 steps/s
[Step=24900 Epoch=95.8] | Loss=0.00003 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.129 | L2-Norm(final)=7.050 | 4758.7 samples/s | 74.4 steps/s
[Step=24950 Epoch=96.0] | Loss=0.00003 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.119 | L2-Norm(final)=7.052 | 4758.0 samples/s | 74.3 steps/s
[Step=25000 Epoch=96.2] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.110 | L2-Norm(final)=7.053 | 5492.8 samples/s | 85.8 steps/s
[Step=25050 Epoch=96.4] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.101 | L2-Norm(final)=7.055 | 1932.7 samples/s | 30.2 steps/s
[Step=25100 Epoch=96.6] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.091 | L2-Norm(final)=7.056 | 4828.1 samples/s | 75.4 steps/s
[Step=25150 Epoch=96.8] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.081 | L2-Norm(final)=7.057 | 4838.7 samples/s | 75.6 steps/s
[Step=25200 Epoch=97.0] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.072 | L2-Norm(final)=7.059 | 4706.5 samples/s | 73.5 steps/s
[Step=25250 Epoch=97.2] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.062 | L2-Norm(final)=7.060 | 4826.3 samples/s | 75.4 steps/s
[Step=25300 Epoch=97.4] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.052 | L2-Norm(final)=7.061 | 2012.4 samples/s | 31.4 steps/s
[Step=25350 Epoch=97.6] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.042 | L2-Norm(final)=7.062 | 4869.3 samples/s | 76.1 steps/s
[Step=25400 Epoch=97.8] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.032 | L2-Norm(final)=7.063 | 4835.1 samples/s | 75.5 steps/s
[Step=25450 Epoch=98.0] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.021 | L2-Norm(final)=7.064 | 4708.0 samples/s | 73.6 steps/s
[Step=25500 Epoch=98.2] | Loss=0.00002 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.011 | L2-Norm(final)=7.065 | 4805.9 samples/s | 75.1 steps/s
[Step=25550 Epoch=98.4] | Loss=0.00002 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.000 | L2-Norm(final)=7.066 | 2043.9 samples/s | 31.9 steps/s
[Step=25600 Epoch=98.5] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.990 | L2-Norm(final)=7.067 | 4736.7 samples/s | 74.0 steps/s
[Step=25650 Epoch=98.7] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.979 | L2-Norm(final)=7.068 | 4794.6 samples/s | 74.9 steps/s
[Step=25700 Epoch=98.9] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.968 | L2-Norm(final)=7.069 | 4731.7 samples/s | 73.9 steps/s
[Step=25750 Epoch=99.1] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.957 | L2-Norm(final)=7.070 | 4854.9 samples/s | 75.9 steps/s
[Step=25800 Epoch=99.3] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.946 | L2-Norm(final)=7.071 | 6907.5 samples/s | 107.9 steps/s
[Step=25850 Epoch=99.5] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.935 | L2-Norm(final)=7.072 | 1800.7 samples/s | 28.1 steps/s
[Step=25900 Epoch=99.7] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.924 | L2-Norm(final)=7.073 | 4766.9 samples/s | 74.5 steps/s
[Step=25950 Epoch=99.9] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.913 | L2-Norm(final)=7.074 | 4822.2 samples/s | 75.3 steps/s
[Step=26000 Epoch=100.1] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=7.075 | 4718.3 samples/s | 73.7 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step26000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06780 | acc=0.9691 | tpr=0.9790 | fpr=0.0523 | 4458.7 samples/s | 17.4 steps/s
Avg test loss: 0.07065, Avg test acc: 0.96859, Avg tpr: 0.97820, Avg fpr: 0.05256, total FA: 410

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05700 | acc=0.9703 | tpr=0.9773 | fpr=0.0448 | 4450.7 samples/s | 17.4 steps/s
Avg test loss: 0.06425, Avg test acc: 0.96899, Avg tpr: 0.97628, Avg fpr: 0.04705, total FA: 367

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.04154 | acc=0.3214 | tpr=0.0450 | fpr=0.0783 | 4401.2 samples/s | 17.2 steps/s
Avg test loss: 5.04317, Avg test acc: 0.31938, Avg tpr: 0.04645, Avg fpr: 0.08037, total FA: 627

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.24969 | acc=0.3151 | tpr=0.0486 | fpr=0.1063 | 4457.1 samples/s | 17.4 steps/s
Avg test loss: 5.24975, Avg test acc: 0.31301, Avg tpr: 0.04931, Avg fpr: 0.10704, total FA: 835

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.50928 | acc=0.1021 | tpr=0.6106 | fpr=0.9070 | 4483.2 samples/s | 17.5 steps/s
[Step= 100] | Loss=6.48668 | acc=0.1014 | tpr=0.6077 | fpr=0.9080 | 9140.2 samples/s | 35.7 steps/s
[Step= 150] | Loss=6.49679 | acc=0.1004 | tpr=0.5965 | fpr=0.9087 | 8936.6 samples/s | 34.9 steps/s
[Step= 200] | Loss=6.48914 | acc=0.1003 | tpr=0.5945 | fpr=0.9087 | 8659.6 samples/s | 33.8 steps/s
[Step= 250] | Loss=6.48682 | acc=0.1005 | tpr=0.6052 | fpr=0.9087 | 8575.9 samples/s | 33.5 steps/s
[Step= 300] | Loss=6.48451 | acc=0.1013 | tpr=0.6124 | fpr=0.9080 | 8836.4 samples/s | 34.5 steps/s
[Step= 350] | Loss=6.48035 | acc=0.1012 | tpr=0.6099 | fpr=0.9080 | 8964.0 samples/s | 35.0 steps/s
[Step= 400] | Loss=6.47838 | acc=0.1015 | tpr=0.6127 | fpr=0.9078 | 8735.4 samples/s | 34.1 steps/s
[Step= 450] | Loss=6.48792 | acc=0.1012 | tpr=0.6027 | fpr=0.9079 | 8973.0 samples/s | 35.1 steps/s
[Step= 500] | Loss=6.49156 | acc=0.1013 | tpr=0.6044 | fpr=0.9078 | 8392.6 samples/s | 32.8 steps/s
[Step= 550] | Loss=6.49521 | acc=0.1013 | tpr=0.6045 | fpr=0.9079 | 15584.2 samples/s | 60.9 steps/s
Avg test loss: 6.49653, Avg test acc: 0.10122, Avg tpr: 0.60539, Avg fpr: 0.90794, total FA: 126066

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.24701 | acc=0.1126 | tpr=0.6150 | fpr=0.8965 | 4415.1 samples/s | 17.2 steps/s
[Step= 100] | Loss=6.22543 | acc=0.1122 | tpr=0.6013 | fpr=0.8969 | 8944.7 samples/s | 34.9 steps/s
[Step= 150] | Loss=6.24313 | acc=0.1127 | tpr=0.6081 | fpr=0.8964 | 8606.4 samples/s | 33.6 steps/s
[Step= 200] | Loss=6.23847 | acc=0.1112 | tpr=0.5967 | fpr=0.8977 | 8810.5 samples/s | 34.4 steps/s
[Step= 250] | Loss=6.23751 | acc=0.1117 | tpr=0.5983 | fpr=0.8972 | 9143.1 samples/s | 35.7 steps/s
[Step= 300] | Loss=6.23774 | acc=0.1120 | tpr=0.6007 | fpr=0.8969 | 8605.5 samples/s | 33.6 steps/s
[Step= 350] | Loss=6.23380 | acc=0.1118 | tpr=0.5949 | fpr=0.8969 | 9210.2 samples/s | 36.0 steps/s
[Step= 400] | Loss=6.23210 | acc=0.1120 | tpr=0.5985 | fpr=0.8969 | 8433.8 samples/s | 32.9 steps/s
[Step= 450] | Loss=6.24123 | acc=0.1116 | tpr=0.5954 | fpr=0.8972 | 8795.2 samples/s | 34.4 steps/s
[Step= 500] | Loss=6.24390 | acc=0.1116 | tpr=0.5965 | fpr=0.8971 | 8554.0 samples/s | 33.4 steps/s
[Step= 550] | Loss=6.24846 | acc=0.1116 | tpr=0.5973 | fpr=0.8972 | 16146.1 samples/s | 63.1 steps/s
Avg test loss: 6.24933, Avg test acc: 0.11154, Avg tpr: 0.59826, Avg fpr: 0.89730, total FA: 124589

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12736 | acc=0.9810 | tpr=0.9381 | fpr=0.0182 | 4543.9 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.13431 | acc=0.9803 | tpr=0.9467 | fpr=0.0191 | 8451.8 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.13938 | acc=0.9792 | tpr=0.9481 | fpr=0.0202 | 9122.5 samples/s | 35.6 steps/s
[Step= 200] | Loss=0.13969 | acc=0.9795 | tpr=0.9497 | fpr=0.0200 | 9226.7 samples/s | 36.0 steps/s
[Step= 250] | Loss=0.13780 | acc=0.9795 | tpr=0.9459 | fpr=0.0199 | 8353.9 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.14073 | acc=0.9793 | tpr=0.9447 | fpr=0.0201 | 8723.7 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.14191 | acc=0.9791 | tpr=0.9443 | fpr=0.0203 | 9029.1 samples/s | 35.3 steps/s
[Step= 400] | Loss=0.14268 | acc=0.9789 | tpr=0.9431 | fpr=0.0204 | 8712.7 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.14581 | acc=0.9786 | tpr=0.9416 | fpr=0.0208 | 8899.7 samples/s | 34.8 steps/s
[Step= 500] | Loss=0.14505 | acc=0.9786 | tpr=0.9432 | fpr=0.0208 | 8882.7 samples/s | 34.7 steps/s
[Step= 550] | Loss=0.14437 | acc=0.9786 | tpr=0.9403 | fpr=0.0207 | 9916.0 samples/s | 38.7 steps/s
Avg test loss: 0.14392, Avg test acc: 0.97859, Avg tpr: 0.94057, Avg fpr: 0.02072, total FA: 2877

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13211 | acc=0.9799 | tpr=0.9425 | fpr=0.0194 | 4482.4 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.14080 | acc=0.9790 | tpr=0.9552 | fpr=0.0205 | 8738.1 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.14486 | acc=0.9778 | tpr=0.9568 | fpr=0.0219 | 8814.9 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.14501 | acc=0.9777 | tpr=0.9574 | fpr=0.0219 | 8526.5 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.14290 | acc=0.9779 | tpr=0.9546 | fpr=0.0217 | 8672.9 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.14580 | acc=0.9776 | tpr=0.9542 | fpr=0.0220 | 8749.9 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.14702 | acc=0.9775 | tpr=0.9562 | fpr=0.0221 | 8973.0 samples/s | 35.1 steps/s
[Step= 400] | Loss=0.14782 | acc=0.9773 | tpr=0.9551 | fpr=0.0223 | 8661.8 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.15101 | acc=0.9769 | tpr=0.9528 | fpr=0.0227 | 9004.4 samples/s | 35.2 steps/s
[Step= 500] | Loss=0.15039 | acc=0.9769 | tpr=0.9529 | fpr=0.0226 | 8608.3 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.14983 | acc=0.9769 | tpr=0.9499 | fpr=0.0226 | 7888.5 samples/s | 30.8 steps/s
Avg test loss: 0.14937, Avg test acc: 0.97693, Avg tpr: 0.95008, Avg fpr: 0.02259, total FA: 3136

server round 27/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=26001 Epoch=50.8] | Loss=0.03764 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.071 | L2-Norm(final)=7.208 | 4022.8 samples/s | 62.9 steps/s
[Step=26050 Epoch=50.9] | Loss=0.01141 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.082 | L2-Norm(final)=7.211 | 5168.0 samples/s | 80.7 steps/s
[Step=26100 Epoch=51.0] | Loss=0.01096 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.091 | L2-Norm(final)=7.213 | 5624.9 samples/s | 87.9 steps/s
[Step=26150 Epoch=51.1] | Loss=0.01006 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.099 | L2-Norm(final)=7.216 | 5628.0 samples/s | 87.9 steps/s
[Step=26200 Epoch=51.2] | Loss=0.00931 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.107 | L2-Norm(final)=7.221 | 5597.3 samples/s | 87.5 steps/s
[Step=26250 Epoch=51.3] | Loss=0.00933 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.114 | L2-Norm(final)=7.227 | 5767.5 samples/s | 90.1 steps/s
[Step=26300 Epoch=51.4] | Loss=0.00925 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.122 | L2-Norm(final)=7.232 | 5694.3 samples/s | 89.0 steps/s
[Step=26350 Epoch=51.5] | Loss=0.00895 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.129 | L2-Norm(final)=7.238 | 5568.2 samples/s | 87.0 steps/s
[Step=26400 Epoch=51.6] | Loss=0.00903 | Reg=0.00173 | acc=0.9688 | L2-Norm=13.136 | L2-Norm(final)=7.243 | 5597.2 samples/s | 87.5 steps/s
[Step=26450 Epoch=51.7] | Loss=0.00908 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.143 | L2-Norm(final)=7.248 | 5657.1 samples/s | 88.4 steps/s
[Step=26500 Epoch=51.8] | Loss=0.00881 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.149 | L2-Norm(final)=7.253 | 7236.2 samples/s | 113.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=51.8] | Loss=0.00293 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.209 | L2-Norm(final)=7.302 | 3819.7 samples/s | 59.7 steps/s
[Step=26550 Epoch=51.9] | Loss=0.00833 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.216 | L2-Norm(final)=7.307 | 4966.2 samples/s | 77.6 steps/s
[Step=26600 Epoch=52.0] | Loss=0.01313 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.228 | L2-Norm(final)=7.308 | 5036.5 samples/s | 78.7 steps/s
[Step=26650 Epoch=52.1] | Loss=0.01237 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.239 | L2-Norm(final)=7.307 | 5042.2 samples/s | 78.8 steps/s
[Step=26700 Epoch=52.2] | Loss=0.01218 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.247 | L2-Norm(final)=7.309 | 5062.0 samples/s | 79.1 steps/s
[Step=26750 Epoch=52.3] | Loss=0.01247 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.256 | L2-Norm(final)=7.309 | 5070.7 samples/s | 79.2 steps/s
[Step=26800 Epoch=52.4] | Loss=0.01235 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.265 | L2-Norm(final)=7.310 | 4938.9 samples/s | 77.2 steps/s
[Step=26850 Epoch=52.5] | Loss=0.01193 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.272 | L2-Norm(final)=7.311 | 5076.8 samples/s | 79.3 steps/s
[Step=26900 Epoch=52.6] | Loss=0.01194 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.280 | L2-Norm(final)=7.313 | 5070.6 samples/s | 79.2 steps/s
[Step=26950 Epoch=52.7] | Loss=0.01170 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.286 | L2-Norm(final)=7.315 | 5045.7 samples/s | 78.8 steps/s
[Step=27000 Epoch=52.8] | Loss=0.01166 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.292 | L2-Norm(final)=7.317 | 6192.9 samples/s | 96.8 steps/s
[Step=27050 Epoch=52.9] | Loss=0.01146 | Reg=0.00177 | acc=0.9531 | L2-Norm=13.298 | L2-Norm(final)=7.319 | 1921.0 samples/s | 30.0 steps/s
[Step=27100 Epoch=53.0] | Loss=0.01134 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.304 | L2-Norm(final)=7.321 | 4989.6 samples/s | 78.0 steps/s
[Step=27150 Epoch=53.1] | Loss=0.01115 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.310 | L2-Norm(final)=7.324 | 4992.2 samples/s | 78.0 steps/s
[Step=27200 Epoch=53.2] | Loss=0.01092 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.316 | L2-Norm(final)=7.326 | 5071.9 samples/s | 79.2 steps/s
[Step=27250 Epoch=53.3] | Loss=0.01086 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.321 | L2-Norm(final)=7.328 | 5055.4 samples/s | 79.0 steps/s
[Step=27300 Epoch=53.4] | Loss=0.01085 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.326 | L2-Norm(final)=7.330 | 5078.1 samples/s | 79.3 steps/s
[Step=27350 Epoch=53.5] | Loss=0.01066 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.330 | L2-Norm(final)=7.332 | 5029.0 samples/s | 78.6 steps/s
[Step=27400 Epoch=53.6] | Loss=0.01050 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.335 | L2-Norm(final)=7.334 | 5072.3 samples/s | 79.3 steps/s
[Step=27450 Epoch=53.7] | Loss=0.01046 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.339 | L2-Norm(final)=7.336 | 5048.1 samples/s | 78.9 steps/s
[Step=27500 Epoch=53.8] | Loss=0.01035 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.343 | L2-Norm(final)=7.337 | 5443.2 samples/s | 85.1 steps/s
[Step=27550 Epoch=53.9] | Loss=0.01024 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.347 | L2-Norm(final)=7.339 | 2027.3 samples/s | 31.7 steps/s
[Step=27600 Epoch=54.0] | Loss=0.01023 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=7.341 | 5038.8 samples/s | 78.7 steps/s
[Step=27650 Epoch=54.1] | Loss=0.01012 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.355 | L2-Norm(final)=7.342 | 5019.0 samples/s | 78.4 steps/s
[Step=27700 Epoch=54.2] | Loss=0.00999 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=7.344 | 5096.5 samples/s | 79.6 steps/s
[Step=27750 Epoch=54.3] | Loss=0.00998 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=7.345 | 4988.9 samples/s | 78.0 steps/s
[Step=27800 Epoch=54.3] | Loss=0.00995 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.366 | L2-Norm(final)=7.347 | 5059.7 samples/s | 79.1 steps/s
[Step=27850 Epoch=54.4] | Loss=0.00987 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=7.348 | 5025.9 samples/s | 78.5 steps/s
[Step=27900 Epoch=54.5] | Loss=0.00974 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=7.350 | 5067.1 samples/s | 79.2 steps/s
[Step=27950 Epoch=54.6] | Loss=0.00961 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.376 | L2-Norm(final)=7.352 | 5148.1 samples/s | 80.4 steps/s
[Step=28000 Epoch=54.7] | Loss=0.00953 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=7.353 | 4972.4 samples/s | 77.7 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step28000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=26001 Epoch=100.1] | Loss=0.00059 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.071 | L2-Norm(final)=7.105 | 3882.4 samples/s | 60.7 steps/s
[Step=26050 Epoch=100.3] | Loss=0.00119 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.107 | L2-Norm(final)=7.115 | 5033.1 samples/s | 78.6 steps/s
[Step=26100 Epoch=100.5] | Loss=0.00078 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.142 | L2-Norm(final)=7.126 | 5363.5 samples/s | 83.8 steps/s
[Step=26150 Epoch=100.7] | Loss=0.00066 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.156 | L2-Norm(final)=7.136 | 5237.5 samples/s | 81.8 steps/s
[Step=26200 Epoch=100.9] | Loss=0.00056 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.167 | L2-Norm(final)=7.144 | 5326.6 samples/s | 83.2 steps/s
[Step=26250 Epoch=101.0] | Loss=0.00050 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.174 | L2-Norm(final)=7.152 | 7057.8 samples/s | 110.3 steps/s
[Step=26300 Epoch=101.2] | Loss=0.00043 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.178 | L2-Norm(final)=7.159 | 1897.4 samples/s | 29.6 steps/s
[Step=26350 Epoch=101.4] | Loss=0.00038 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.180 | L2-Norm(final)=7.165 | 5323.7 samples/s | 83.2 steps/s
[Step=26400 Epoch=101.6] | Loss=0.00034 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.179 | L2-Norm(final)=7.170 | 5369.7 samples/s | 83.9 steps/s
[Step=26450 Epoch=101.8] | Loss=0.00031 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.177 | L2-Norm(final)=7.175 | 5139.9 samples/s | 80.3 steps/s
[Step=26500 Epoch=102.0] | Loss=0.00028 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.174 | L2-Norm(final)=7.179 | 6207.2 samples/s | 97.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=102.0] | Loss=0.00001 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.141 | L2-Norm(final)=7.220 | 3964.5 samples/s | 61.9 steps/s
[Step=26550 Epoch=102.2] | Loss=0.00003 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.130 | L2-Norm(final)=7.222 | 4614.6 samples/s | 72.1 steps/s
[Step=26600 Epoch=102.4] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.116 | L2-Norm(final)=7.224 | 4793.5 samples/s | 74.9 steps/s
[Step=26650 Epoch=102.6] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.103 | L2-Norm(final)=7.226 | 4787.5 samples/s | 74.8 steps/s
[Step=26700 Epoch=102.8] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.089 | L2-Norm(final)=7.227 | 4842.4 samples/s | 75.7 steps/s
[Step=26750 Epoch=103.0] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.074 | L2-Norm(final)=7.229 | 5972.4 samples/s | 93.3 steps/s
[Step=26800 Epoch=103.2] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.060 | L2-Norm(final)=7.230 | 1863.7 samples/s | 29.1 steps/s
[Step=26850 Epoch=103.4] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.045 | L2-Norm(final)=7.231 | 4702.9 samples/s | 73.5 steps/s
[Step=26900 Epoch=103.5] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.030 | L2-Norm(final)=7.232 | 4794.3 samples/s | 74.9 steps/s
[Step=26950 Epoch=103.7] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.015 | L2-Norm(final)=7.233 | 4782.5 samples/s | 74.7 steps/s
[Step=27000 Epoch=103.9] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.000 | L2-Norm(final)=7.234 | 5438.1 samples/s | 85.0 steps/s
[Step=27050 Epoch=104.1] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.984 | L2-Norm(final)=7.234 | 1926.4 samples/s | 30.1 steps/s
[Step=27100 Epoch=104.3] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.968 | L2-Norm(final)=7.235 | 4801.8 samples/s | 75.0 steps/s
[Step=27150 Epoch=104.5] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.952 | L2-Norm(final)=7.236 | 4836.2 samples/s | 75.6 steps/s
[Step=27200 Epoch=104.7] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.936 | L2-Norm(final)=7.236 | 4826.6 samples/s | 75.4 steps/s
[Step=27250 Epoch=104.9] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.920 | L2-Norm(final)=7.237 | 4821.2 samples/s | 75.3 steps/s
[Step=27300 Epoch=105.1] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.904 | L2-Norm(final)=7.238 | 2017.8 samples/s | 31.5 steps/s
[Step=27350 Epoch=105.3] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.888 | L2-Norm(final)=7.238 | 4862.2 samples/s | 76.0 steps/s
[Step=27400 Epoch=105.5] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.871 | L2-Norm(final)=7.239 | 4792.2 samples/s | 74.9 steps/s
[Step=27450 Epoch=105.7] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.855 | L2-Norm(final)=7.239 | 4821.9 samples/s | 75.3 steps/s
[Step=27500 Epoch=105.9] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.838 | L2-Norm(final)=7.240 | 4725.3 samples/s | 73.8 steps/s
[Step=27550 Epoch=106.1] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.821 | L2-Norm(final)=7.241 | 2043.2 samples/s | 31.9 steps/s
[Step=27600 Epoch=106.2] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.804 | L2-Norm(final)=7.241 | 4819.1 samples/s | 75.3 steps/s
[Step=27650 Epoch=106.4] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.786 | L2-Norm(final)=7.242 | 4743.9 samples/s | 74.1 steps/s
[Step=27700 Epoch=106.6] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.769 | L2-Norm(final)=7.242 | 4839.7 samples/s | 75.6 steps/s
[Step=27750 Epoch=106.8] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.752 | L2-Norm(final)=7.243 | 4759.5 samples/s | 74.4 steps/s
[Step=27800 Epoch=107.0] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.734 | L2-Norm(final)=7.243 | 6964.8 samples/s | 108.8 steps/s
[Step=27850 Epoch=107.2] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.716 | L2-Norm(final)=7.244 | 1798.3 samples/s | 28.1 steps/s
[Step=27900 Epoch=107.4] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.698 | L2-Norm(final)=7.245 | 4862.9 samples/s | 76.0 steps/s
[Step=27950 Epoch=107.6] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.680 | L2-Norm(final)=7.245 | 4684.0 samples/s | 73.2 steps/s
[Step=28000 Epoch=107.8] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.662 | L2-Norm(final)=7.246 | 4768.0 samples/s | 74.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06780 | acc=0.9691 | tpr=0.9790 | fpr=0.0523 | 4425.2 samples/s | 17.3 steps/s
Avg test loss: 0.07065, Avg test acc: 0.96859, Avg tpr: 0.97820, Avg fpr: 0.05256, total FA: 410

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06175 | acc=0.9698 | tpr=0.9752 | fpr=0.0421 | 4456.4 samples/s | 17.4 steps/s
Avg test loss: 0.06832, Avg test acc: 0.96791, Avg tpr: 0.97366, Avg fpr: 0.04474, total FA: 349

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.04154 | acc=0.3214 | tpr=0.0450 | fpr=0.0783 | 4473.0 samples/s | 17.5 steps/s
Avg test loss: 5.04317, Avg test acc: 0.31938, Avg tpr: 0.04645, Avg fpr: 0.08037, total FA: 627

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.64773 | acc=0.3115 | tpr=0.0501 | fpr=0.1209 | 4478.6 samples/s | 17.5 steps/s
Avg test loss: 5.64402, Avg test acc: 0.31020, Avg tpr: 0.05077, Avg fpr: 0.11922, total FA: 930

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.50928 | acc=0.1021 | tpr=0.6106 | fpr=0.9070 | 4454.3 samples/s | 17.4 steps/s
[Step= 100] | Loss=6.48668 | acc=0.1014 | tpr=0.6077 | fpr=0.9080 | 8809.7 samples/s | 34.4 steps/s
[Step= 150] | Loss=6.49679 | acc=0.1004 | tpr=0.5965 | fpr=0.9087 | 8755.0 samples/s | 34.2 steps/s
[Step= 200] | Loss=6.48914 | acc=0.1003 | tpr=0.5945 | fpr=0.9087 | 8851.7 samples/s | 34.6 steps/s
[Step= 250] | Loss=6.48682 | acc=0.1005 | tpr=0.6052 | fpr=0.9087 | 5074.1 samples/s | 19.8 steps/s
[Step= 300] | Loss=6.48451 | acc=0.1013 | tpr=0.6124 | fpr=0.9080 | 9335.1 samples/s | 36.5 steps/s
[Step= 350] | Loss=6.48035 | acc=0.1012 | tpr=0.6099 | fpr=0.9080 | 8072.2 samples/s | 31.5 steps/s
[Step= 400] | Loss=6.47838 | acc=0.1015 | tpr=0.6127 | fpr=0.9078 | 9160.7 samples/s | 35.8 steps/s
[Step= 450] | Loss=6.48792 | acc=0.1012 | tpr=0.6027 | fpr=0.9079 | 8629.3 samples/s | 33.7 steps/s
[Step= 500] | Loss=6.49156 | acc=0.1013 | tpr=0.6044 | fpr=0.9078 | 8687.3 samples/s | 33.9 steps/s
[Step= 550] | Loss=6.49521 | acc=0.1013 | tpr=0.6045 | fpr=0.9079 | 15241.8 samples/s | 59.5 steps/s
Avg test loss: 6.49653, Avg test acc: 0.10122, Avg tpr: 0.60539, Avg fpr: 0.90794, total FA: 126066

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.98806 | acc=0.1276 | tpr=0.6195 | fpr=0.8813 | 4446.2 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.96462 | acc=0.1263 | tpr=0.5928 | fpr=0.8824 | 8984.9 samples/s | 35.1 steps/s
[Step= 150] | Loss=5.98199 | acc=0.1254 | tpr=0.5951 | fpr=0.8832 | 8778.8 samples/s | 34.3 steps/s
[Step= 200] | Loss=5.97304 | acc=0.1245 | tpr=0.5869 | fpr=0.8839 | 8509.5 samples/s | 33.2 steps/s
[Step= 250] | Loss=5.97336 | acc=0.1248 | tpr=0.5939 | fpr=0.8837 | 5114.4 samples/s | 20.0 steps/s
[Step= 300] | Loss=5.97589 | acc=0.1253 | tpr=0.5971 | fpr=0.8833 | 8805.4 samples/s | 34.4 steps/s
[Step= 350] | Loss=5.97320 | acc=0.1252 | tpr=0.5942 | fpr=0.8833 | 9029.2 samples/s | 35.3 steps/s
[Step= 400] | Loss=5.97251 | acc=0.1256 | tpr=0.5990 | fpr=0.8830 | 8556.2 samples/s | 33.4 steps/s
[Step= 450] | Loss=5.98240 | acc=0.1255 | tpr=0.5954 | fpr=0.8830 | 8505.4 samples/s | 33.2 steps/s
[Step= 500] | Loss=5.98639 | acc=0.1256 | tpr=0.5969 | fpr=0.8830 | 8587.0 samples/s | 33.5 steps/s
[Step= 550] | Loss=5.99095 | acc=0.1254 | tpr=0.5937 | fpr=0.8831 | 16371.7 samples/s | 64.0 steps/s
Avg test loss: 5.99186, Avg test acc: 0.12539, Avg tpr: 0.59469, Avg fpr: 0.88314, total FA: 122622

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12736 | acc=0.9810 | tpr=0.9381 | fpr=0.0182 | 4559.0 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.13431 | acc=0.9803 | tpr=0.9467 | fpr=0.0191 | 8611.0 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.13938 | acc=0.9792 | tpr=0.9481 | fpr=0.0202 | 8396.7 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.13969 | acc=0.9795 | tpr=0.9497 | fpr=0.0200 | 9294.4 samples/s | 36.3 steps/s
[Step= 250] | Loss=0.13780 | acc=0.9795 | tpr=0.9459 | fpr=0.0199 | 5436.5 samples/s | 21.2 steps/s
[Step= 300] | Loss=0.14073 | acc=0.9793 | tpr=0.9447 | fpr=0.0201 | 8770.8 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.14191 | acc=0.9791 | tpr=0.9443 | fpr=0.0203 | 8820.6 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.14268 | acc=0.9789 | tpr=0.9431 | fpr=0.0204 | 8196.1 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.14581 | acc=0.9786 | tpr=0.9416 | fpr=0.0208 | 8290.7 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.14505 | acc=0.9786 | tpr=0.9432 | fpr=0.0208 | 8474.1 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.14437 | acc=0.9786 | tpr=0.9403 | fpr=0.0207 | 15896.1 samples/s | 62.1 steps/s
Avg test loss: 0.14392, Avg test acc: 0.97859, Avg tpr: 0.94057, Avg fpr: 0.02072, total FA: 2877

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13554 | acc=0.9797 | tpr=0.9381 | fpr=0.0196 | 4475.5 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.14470 | acc=0.9784 | tpr=0.9510 | fpr=0.0210 | 9045.1 samples/s | 35.3 steps/s
[Step= 150] | Loss=0.14870 | acc=0.9776 | tpr=0.9510 | fpr=0.0219 | 8904.2 samples/s | 34.8 steps/s
[Step= 200] | Loss=0.14901 | acc=0.9777 | tpr=0.9508 | fpr=0.0219 | 5015.8 samples/s | 19.6 steps/s
[Step= 250] | Loss=0.14683 | acc=0.9778 | tpr=0.9476 | fpr=0.0216 | 8248.3 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.14959 | acc=0.9775 | tpr=0.9462 | fpr=0.0220 | 8977.5 samples/s | 35.1 steps/s
[Step= 350] | Loss=0.15061 | acc=0.9774 | tpr=0.9487 | fpr=0.0221 | 8670.6 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.15141 | acc=0.9773 | tpr=0.9486 | fpr=0.0222 | 8719.4 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.15477 | acc=0.9769 | tpr=0.9464 | fpr=0.0225 | 9204.5 samples/s | 36.0 steps/s
[Step= 500] | Loss=0.15422 | acc=0.9770 | tpr=0.9476 | fpr=0.0225 | 8239.7 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.15373 | acc=0.9769 | tpr=0.9443 | fpr=0.0225 | 16251.0 samples/s | 63.5 steps/s
Avg test loss: 0.15324, Avg test acc: 0.97696, Avg tpr: 0.94453, Avg fpr: 0.02245, total FA: 3117

server round 28/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=22001 Epoch=42.9] | Loss=0.01249 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.905 | L2-Norm(final)=6.744 | 3686.1 samples/s | 57.6 steps/s
[Step=22050 Epoch=43.0] | Loss=0.01313 | Reg=0.00167 | acc=0.9688 | L2-Norm=12.911 | L2-Norm(final)=6.747 | 5489.2 samples/s | 85.8 steps/s
[Step=22100 Epoch=43.1] | Loss=0.01161 | Reg=0.00167 | acc=0.9688 | L2-Norm=12.920 | L2-Norm(final)=6.752 | 5524.9 samples/s | 86.3 steps/s
[Step=22150 Epoch=43.2] | Loss=0.01092 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.928 | L2-Norm(final)=6.758 | 5661.7 samples/s | 88.5 steps/s
[Step=22200 Epoch=43.3] | Loss=0.01052 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.938 | L2-Norm(final)=6.765 | 5708.6 samples/s | 89.2 steps/s
[Step=22250 Epoch=43.4] | Loss=0.00985 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.947 | L2-Norm(final)=6.771 | 5605.0 samples/s | 87.6 steps/s
[Step=22300 Epoch=43.5] | Loss=0.00971 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.955 | L2-Norm(final)=6.777 | 5679.2 samples/s | 88.7 steps/s
[Step=22350 Epoch=43.6] | Loss=0.00945 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.962 | L2-Norm(final)=6.783 | 5617.8 samples/s | 87.8 steps/s
[Step=22400 Epoch=43.7] | Loss=0.00931 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.969 | L2-Norm(final)=6.788 | 5754.9 samples/s | 89.9 steps/s
[Step=22450 Epoch=43.8] | Loss=0.00919 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.976 | L2-Norm(final)=6.794 | 5752.4 samples/s | 89.9 steps/s
[Step=22500 Epoch=43.9] | Loss=0.00921 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.983 | L2-Norm(final)=6.801 | 6946.7 samples/s | 108.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=43.9] | Loss=0.00214 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.052 | L2-Norm(final)=6.860 | 3570.9 samples/s | 55.8 steps/s
[Step=22550 Epoch=44.0] | Loss=0.00940 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.060 | L2-Norm(final)=6.865 | 4893.7 samples/s | 76.5 steps/s
[Step=22600 Epoch=44.1] | Loss=0.01073 | Reg=0.00171 | acc=0.9688 | L2-Norm=13.070 | L2-Norm(final)=6.868 | 5011.1 samples/s | 78.3 steps/s
[Step=22650 Epoch=44.2] | Loss=0.01164 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.081 | L2-Norm(final)=6.870 | 4977.3 samples/s | 77.8 steps/s
[Step=22700 Epoch=44.3] | Loss=0.01217 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.092 | L2-Norm(final)=6.872 | 5018.8 samples/s | 78.4 steps/s
[Step=22750 Epoch=44.4] | Loss=0.01267 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.101 | L2-Norm(final)=6.872 | 5027.2 samples/s | 78.6 steps/s
[Step=22800 Epoch=44.5] | Loss=0.01230 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.109 | L2-Norm(final)=6.873 | 5084.4 samples/s | 79.4 steps/s
[Step=22850 Epoch=44.6] | Loss=0.01264 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.117 | L2-Norm(final)=6.874 | 4983.7 samples/s | 77.9 steps/s
[Step=22900 Epoch=44.7] | Loss=0.01287 | Reg=0.00172 | acc=0.9688 | L2-Norm=13.123 | L2-Norm(final)=6.875 | 4961.1 samples/s | 77.5 steps/s
[Step=22950 Epoch=44.8] | Loss=0.01275 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.130 | L2-Norm(final)=6.876 | 5072.2 samples/s | 79.3 steps/s
[Step=23000 Epoch=44.9] | Loss=0.01275 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.137 | L2-Norm(final)=6.878 | 6193.5 samples/s | 96.8 steps/s
[Step=23050 Epoch=45.0] | Loss=0.01254 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.143 | L2-Norm(final)=6.880 | 1852.1 samples/s | 28.9 steps/s
[Step=23100 Epoch=45.1] | Loss=0.01228 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.150 | L2-Norm(final)=6.882 | 5039.5 samples/s | 78.7 steps/s
[Step=23150 Epoch=45.2] | Loss=0.01193 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.156 | L2-Norm(final)=6.885 | 4999.7 samples/s | 78.1 steps/s
[Step=23200 Epoch=45.2] | Loss=0.01181 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.162 | L2-Norm(final)=6.887 | 5072.0 samples/s | 79.3 steps/s
[Step=23250 Epoch=45.3] | Loss=0.01160 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.167 | L2-Norm(final)=6.890 | 5019.8 samples/s | 78.4 steps/s
[Step=23300 Epoch=45.4] | Loss=0.01165 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.173 | L2-Norm(final)=6.892 | 5084.5 samples/s | 79.4 steps/s
[Step=23350 Epoch=45.5] | Loss=0.01152 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.178 | L2-Norm(final)=6.894 | 5018.1 samples/s | 78.4 steps/s
[Step=23400 Epoch=45.6] | Loss=0.01126 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.183 | L2-Norm(final)=6.896 | 5103.3 samples/s | 79.7 steps/s
[Step=23450 Epoch=45.7] | Loss=0.01120 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.188 | L2-Norm(final)=6.898 | 5005.2 samples/s | 78.2 steps/s
[Step=23500 Epoch=45.8] | Loss=0.01119 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.193 | L2-Norm(final)=6.900 | 5348.9 samples/s | 83.6 steps/s
[Step=23550 Epoch=45.9] | Loss=0.01111 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.198 | L2-Norm(final)=6.903 | 1953.7 samples/s | 30.5 steps/s
[Step=23600 Epoch=46.0] | Loss=0.01100 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.203 | L2-Norm(final)=6.904 | 5064.3 samples/s | 79.1 steps/s
[Step=23650 Epoch=46.1] | Loss=0.01082 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.207 | L2-Norm(final)=6.907 | 5002.5 samples/s | 78.2 steps/s
[Step=23700 Epoch=46.2] | Loss=0.01071 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.212 | L2-Norm(final)=6.909 | 5074.6 samples/s | 79.3 steps/s
[Step=23750 Epoch=46.3] | Loss=0.01070 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.216 | L2-Norm(final)=6.911 | 5025.0 samples/s | 78.5 steps/s
[Step=23800 Epoch=46.4] | Loss=0.01060 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.221 | L2-Norm(final)=6.913 | 5082.7 samples/s | 79.4 steps/s
[Step=23850 Epoch=46.5] | Loss=0.01052 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.225 | L2-Norm(final)=6.915 | 4981.8 samples/s | 77.8 steps/s
[Step=23900 Epoch=46.6] | Loss=0.01041 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.229 | L2-Norm(final)=6.917 | 5166.5 samples/s | 80.7 steps/s
[Step=23950 Epoch=46.7] | Loss=0.01035 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.234 | L2-Norm(final)=6.919 | 4986.0 samples/s | 77.9 steps/s
[Step=24000 Epoch=46.8] | Loss=0.01025 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.238 | L2-Norm(final)=6.921 | 5020.1 samples/s | 78.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step24000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=34001 Epoch=130.3] | Loss=0.00016 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=8.617 | 3837.8 samples/s | 60.0 steps/s
[Step=34050 Epoch=130.5] | Loss=0.00036 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.911 | L2-Norm(final)=8.628 | 5105.6 samples/s | 79.8 steps/s
[Step=34100 Epoch=130.7] | Loss=0.00048 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.923 | L2-Norm(final)=8.636 | 5384.5 samples/s | 84.1 steps/s
[Step=34150 Epoch=130.9] | Loss=0.00044 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.936 | L2-Norm(final)=8.645 | 5252.4 samples/s | 82.1 steps/s
[Step=34200 Epoch=131.0] | Loss=0.00045 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.944 | L2-Norm(final)=8.653 | 5256.6 samples/s | 82.1 steps/s
[Step=34250 Epoch=131.2] | Loss=0.00040 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.951 | L2-Norm(final)=8.660 | 6982.9 samples/s | 109.1 steps/s
[Step=34300 Epoch=131.4] | Loss=0.00036 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.956 | L2-Norm(final)=8.667 | 1920.1 samples/s | 30.0 steps/s
[Step=34350 Epoch=131.6] | Loss=0.00031 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.960 | L2-Norm(final)=8.673 | 5350.4 samples/s | 83.6 steps/s
[Step=34400 Epoch=131.8] | Loss=0.00028 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=8.678 | 5340.1 samples/s | 83.4 steps/s
[Step=34450 Epoch=132.0] | Loss=0.00026 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=8.683 | 5349.2 samples/s | 83.6 steps/s
[Step=34500 Epoch=132.2] | Loss=0.00024 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=8.688 | 6007.1 samples/s | 93.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=34501 Epoch=132.2] | Loss=0.00003 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.949 | L2-Norm(final)=8.730 | 3690.7 samples/s | 57.7 steps/s
[Step=34550 Epoch=132.4] | Loss=0.00003 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.940 | L2-Norm(final)=8.733 | 4840.8 samples/s | 75.6 steps/s
[Step=34600 Epoch=132.6] | Loss=0.00003 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.929 | L2-Norm(final)=8.734 | 4771.2 samples/s | 74.6 steps/s
[Step=34650 Epoch=132.8] | Loss=0.00003 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.918 | L2-Norm(final)=8.736 | 4800.0 samples/s | 75.0 steps/s
[Step=34700 Epoch=133.0] | Loss=0.00002 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.907 | L2-Norm(final)=8.738 | 4780.3 samples/s | 74.7 steps/s
[Step=34750 Epoch=133.1] | Loss=0.00002 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.896 | L2-Norm(final)=8.739 | 6055.4 samples/s | 94.6 steps/s
[Step=34800 Epoch=133.3] | Loss=0.00002 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.884 | L2-Norm(final)=8.741 | 1856.9 samples/s | 29.0 steps/s
[Step=34850 Epoch=133.5] | Loss=0.00002 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.872 | L2-Norm(final)=8.742 | 4773.5 samples/s | 74.6 steps/s
[Step=34900 Epoch=133.7] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.860 | L2-Norm(final)=8.742 | 4773.2 samples/s | 74.6 steps/s
[Step=34950 Epoch=133.9] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.847 | L2-Norm(final)=8.743 | 4852.3 samples/s | 75.8 steps/s
[Step=35000 Epoch=134.1] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.835 | L2-Norm(final)=8.744 | 5215.1 samples/s | 81.5 steps/s
[Step=35050 Epoch=134.3] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.822 | L2-Norm(final)=8.745 | 1966.0 samples/s | 30.7 steps/s
[Step=35100 Epoch=134.5] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.809 | L2-Norm(final)=8.745 | 4708.2 samples/s | 73.6 steps/s
[Step=35150 Epoch=134.7] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.796 | L2-Norm(final)=8.746 | 4800.7 samples/s | 75.0 steps/s
[Step=35200 Epoch=134.9] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.783 | L2-Norm(final)=8.747 | 4786.5 samples/s | 74.8 steps/s
[Step=35250 Epoch=135.1] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.770 | L2-Norm(final)=8.747 | 4776.8 samples/s | 74.6 steps/s
[Step=35300 Epoch=135.3] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.757 | L2-Norm(final)=8.748 | 2023.8 samples/s | 31.6 steps/s
[Step=35350 Epoch=135.4] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.743 | L2-Norm(final)=8.748 | 4925.8 samples/s | 77.0 steps/s
[Step=35400 Epoch=135.6] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.729 | L2-Norm(final)=8.749 | 4734.7 samples/s | 74.0 steps/s
[Step=35450 Epoch=135.8] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.716 | L2-Norm(final)=8.750 | 4774.5 samples/s | 74.6 steps/s
[Step=35500 Epoch=136.0] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.702 | L2-Norm(final)=8.750 | 4804.6 samples/s | 75.1 steps/s
[Step=35550 Epoch=136.2] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.688 | L2-Norm(final)=8.751 | 2032.9 samples/s | 31.8 steps/s
[Step=35600 Epoch=136.4] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.674 | L2-Norm(final)=8.751 | 4783.8 samples/s | 74.7 steps/s
[Step=35650 Epoch=136.6] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.659 | L2-Norm(final)=8.752 | 4754.2 samples/s | 74.3 steps/s
[Step=35700 Epoch=136.8] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.645 | L2-Norm(final)=8.752 | 4806.1 samples/s | 75.1 steps/s
[Step=35750 Epoch=137.0] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.630 | L2-Norm(final)=8.753 | 4792.1 samples/s | 74.9 steps/s
[Step=35800 Epoch=137.2] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.616 | L2-Norm(final)=8.753 | 6578.5 samples/s | 102.8 steps/s
[Step=35850 Epoch=137.4] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.601 | L2-Norm(final)=8.754 | 1829.4 samples/s | 28.6 steps/s
[Step=35900 Epoch=137.6] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.586 | L2-Norm(final)=8.754 | 4808.2 samples/s | 75.1 steps/s
[Step=35950 Epoch=137.7] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.571 | L2-Norm(final)=8.755 | 4792.1 samples/s | 74.9 steps/s
[Step=36000 Epoch=137.9] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.555 | L2-Norm(final)=8.755 | 4690.0 samples/s | 73.3 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06913 | acc=0.9675 | tpr=0.9775 | fpr=0.0543 | 3282.4 samples/s | 12.8 steps/s
Avg test loss: 0.07033, Avg test acc: 0.96670, Avg tpr: 0.97645, Avg fpr: 0.05474, total FA: 427

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06175 | acc=0.9698 | tpr=0.9752 | fpr=0.0421 | 4489.8 samples/s | 17.5 steps/s
Avg test loss: 0.06832, Avg test acc: 0.96791, Avg tpr: 0.97366, Avg fpr: 0.04474, total FA: 349

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.46984 | acc=0.3141 | tpr=0.0408 | fpr=0.0924 | 4474.8 samples/s | 17.5 steps/s
Avg test loss: 5.46883, Avg test acc: 0.31389, Avg tpr: 0.04237, Avg fpr: 0.08896, total FA: 694

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.64773 | acc=0.3115 | tpr=0.0501 | fpr=0.1209 | 4482.2 samples/s | 17.5 steps/s
Avg test loss: 5.64402, Avg test acc: 0.31020, Avg tpr: 0.05077, Avg fpr: 0.11922, total FA: 930

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.38416 | acc=0.1037 | tpr=0.5885 | fpr=0.9050 | 4531.1 samples/s | 17.7 steps/s
[Step= 100] | Loss=6.35736 | acc=0.1045 | tpr=0.5800 | fpr=0.9043 | 8925.4 samples/s | 34.9 steps/s
[Step= 150] | Loss=6.36466 | acc=0.1040 | tpr=0.5677 | fpr=0.9046 | 8496.6 samples/s | 33.2 steps/s
[Step= 200] | Loss=6.35787 | acc=0.1036 | tpr=0.5628 | fpr=0.9048 | 8910.2 samples/s | 34.8 steps/s
[Step= 250] | Loss=6.35831 | acc=0.1040 | tpr=0.5738 | fpr=0.9046 | 8557.3 samples/s | 33.4 steps/s
[Step= 300] | Loss=6.35468 | acc=0.1046 | tpr=0.5818 | fpr=0.9041 | 9307.1 samples/s | 36.4 steps/s
[Step= 350] | Loss=6.35180 | acc=0.1044 | tpr=0.5811 | fpr=0.9043 | 8671.5 samples/s | 33.9 steps/s
[Step= 400] | Loss=6.34951 | acc=0.1045 | tpr=0.5821 | fpr=0.9042 | 8891.9 samples/s | 34.7 steps/s
[Step= 450] | Loss=6.35812 | acc=0.1041 | tpr=0.5750 | fpr=0.9045 | 8575.0 samples/s | 33.5 steps/s
[Step= 500] | Loss=6.36158 | acc=0.1043 | tpr=0.5775 | fpr=0.9043 | 8598.8 samples/s | 33.6 steps/s
[Step= 550] | Loss=6.36583 | acc=0.1043 | tpr=0.5794 | fpr=0.9043 | 15678.9 samples/s | 61.2 steps/s
Avg test loss: 6.36722, Avg test acc: 0.10424, Avg tpr: 0.58043, Avg fpr: 0.90442, total FA: 125577

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.98806 | acc=0.1276 | tpr=0.6195 | fpr=0.8813 | 4500.9 samples/s | 17.6 steps/s
[Step= 100] | Loss=5.96462 | acc=0.1263 | tpr=0.5928 | fpr=0.8824 | 8647.5 samples/s | 33.8 steps/s
[Step= 150] | Loss=5.98199 | acc=0.1254 | tpr=0.5951 | fpr=0.8832 | 9266.0 samples/s | 36.2 steps/s
[Step= 200] | Loss=5.97304 | acc=0.1245 | tpr=0.5869 | fpr=0.8839 | 8646.7 samples/s | 33.8 steps/s
[Step= 250] | Loss=5.97336 | acc=0.1248 | tpr=0.5939 | fpr=0.8837 | 9076.4 samples/s | 35.5 steps/s
[Step= 300] | Loss=5.97589 | acc=0.1253 | tpr=0.5971 | fpr=0.8833 | 8527.3 samples/s | 33.3 steps/s
[Step= 350] | Loss=5.97320 | acc=0.1252 | tpr=0.5942 | fpr=0.8833 | 9008.2 samples/s | 35.2 steps/s
[Step= 400] | Loss=5.97251 | acc=0.1256 | tpr=0.5990 | fpr=0.8830 | 8774.3 samples/s | 34.3 steps/s
[Step= 450] | Loss=5.98240 | acc=0.1255 | tpr=0.5954 | fpr=0.8830 | 8881.6 samples/s | 34.7 steps/s
[Step= 500] | Loss=5.98639 | acc=0.1256 | tpr=0.5969 | fpr=0.8830 | 8541.8 samples/s | 33.4 steps/s
[Step= 550] | Loss=5.99095 | acc=0.1254 | tpr=0.5937 | fpr=0.8831 | 16323.5 samples/s | 63.8 steps/s
Avg test loss: 5.99186, Avg test acc: 0.12539, Avg tpr: 0.59469, Avg fpr: 0.88314, total FA: 122622

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13122 | acc=0.9820 | tpr=0.9381 | fpr=0.0173 | 4527.2 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.13819 | acc=0.9809 | tpr=0.9488 | fpr=0.0185 | 8508.4 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.14343 | acc=0.9798 | tpr=0.9496 | fpr=0.0196 | 8933.2 samples/s | 34.9 steps/s
[Step= 200] | Loss=0.14393 | acc=0.9799 | tpr=0.9508 | fpr=0.0195 | 8699.1 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.14182 | acc=0.9800 | tpr=0.9476 | fpr=0.0194 | 9022.5 samples/s | 35.2 steps/s
[Step= 300] | Loss=0.14462 | acc=0.9797 | tpr=0.9455 | fpr=0.0197 | 8617.1 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.14565 | acc=0.9796 | tpr=0.9474 | fpr=0.0198 | 8817.8 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.14634 | acc=0.9793 | tpr=0.9453 | fpr=0.0201 | 9038.7 samples/s | 35.3 steps/s
[Step= 450] | Loss=0.14967 | acc=0.9789 | tpr=0.9421 | fpr=0.0205 | 8985.9 samples/s | 35.1 steps/s
[Step= 500] | Loss=0.14875 | acc=0.9789 | tpr=0.9436 | fpr=0.0204 | 8524.9 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.14812 | acc=0.9789 | tpr=0.9403 | fpr=0.0204 | 15548.5 samples/s | 60.7 steps/s
Avg test loss: 0.14766, Avg test acc: 0.97894, Avg tpr: 0.94057, Avg fpr: 0.02037, total FA: 2828

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13554 | acc=0.9797 | tpr=0.9381 | fpr=0.0196 | 4471.5 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.14470 | acc=0.9784 | tpr=0.9510 | fpr=0.0210 | 9048.3 samples/s | 35.3 steps/s
[Step= 150] | Loss=0.14870 | acc=0.9776 | tpr=0.9510 | fpr=0.0219 | 8746.3 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.14901 | acc=0.9777 | tpr=0.9508 | fpr=0.0219 | 8690.1 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.14683 | acc=0.9778 | tpr=0.9476 | fpr=0.0216 | 8875.0 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.14959 | acc=0.9775 | tpr=0.9462 | fpr=0.0220 | 8839.3 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.15061 | acc=0.9774 | tpr=0.9487 | fpr=0.0221 | 8658.3 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.15141 | acc=0.9773 | tpr=0.9486 | fpr=0.0222 | 8917.7 samples/s | 34.8 steps/s
[Step= 450] | Loss=0.15477 | acc=0.9769 | tpr=0.9464 | fpr=0.0225 | 8916.6 samples/s | 34.8 steps/s
[Step= 500] | Loss=0.15422 | acc=0.9770 | tpr=0.9476 | fpr=0.0225 | 8574.5 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.15373 | acc=0.9769 | tpr=0.9443 | fpr=0.0225 | 16278.1 samples/s | 63.6 steps/s
Avg test loss: 0.15324, Avg test acc: 0.97696, Avg tpr: 0.94453, Avg fpr: 0.02245, total FA: 3117

server round 29/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=28001 Epoch=54.7] | Loss=0.01025 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.640 | L2-Norm(final)=7.401 | 3765.1 samples/s | 58.8 steps/s
[Step=28050 Epoch=54.8] | Loss=0.01081 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.649 | L2-Norm(final)=7.402 | 5740.0 samples/s | 89.7 steps/s
[Step=28100 Epoch=54.9] | Loss=0.00961 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.657 | L2-Norm(final)=7.407 | 5646.5 samples/s | 88.2 steps/s
[Step=28150 Epoch=55.0] | Loss=0.00923 | Reg=0.00160 | acc=0.9688 | L2-Norm=12.664 | L2-Norm(final)=7.411 | 5575.6 samples/s | 87.1 steps/s
[Step=28200 Epoch=55.1] | Loss=0.00906 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.671 | L2-Norm(final)=7.415 | 5649.5 samples/s | 88.3 steps/s
[Step=28250 Epoch=55.2] | Loss=0.00874 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.677 | L2-Norm(final)=7.420 | 5682.6 samples/s | 88.8 steps/s
[Step=28300 Epoch=55.3] | Loss=0.00859 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.684 | L2-Norm(final)=7.425 | 5700.3 samples/s | 89.1 steps/s
[Step=28350 Epoch=55.4] | Loss=0.00867 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.691 | L2-Norm(final)=7.430 | 5573.7 samples/s | 87.1 steps/s
[Step=28400 Epoch=55.5] | Loss=0.00869 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.698 | L2-Norm(final)=7.434 | 5677.4 samples/s | 88.7 steps/s
[Step=28450 Epoch=55.6] | Loss=0.00847 | Reg=0.00161 | acc=0.9688 | L2-Norm=12.705 | L2-Norm(final)=7.439 | 5715.9 samples/s | 89.3 steps/s
[Step=28500 Epoch=55.7] | Loss=0.00830 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.711 | L2-Norm(final)=7.444 | 7217.1 samples/s | 112.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=55.7] | Loss=0.00433 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.775 | L2-Norm(final)=7.493 | 3898.7 samples/s | 60.9 steps/s
[Step=28550 Epoch=55.8] | Loss=0.00793 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.781 | L2-Norm(final)=7.498 | 4995.9 samples/s | 78.1 steps/s
[Step=28600 Epoch=55.9] | Loss=0.01154 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.789 | L2-Norm(final)=7.500 | 4993.7 samples/s | 78.0 steps/s
[Step=28650 Epoch=56.0] | Loss=0.01284 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.802 | L2-Norm(final)=7.498 | 5017.3 samples/s | 78.4 steps/s
[Step=28700 Epoch=56.1] | Loss=0.01130 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.814 | L2-Norm(final)=7.500 | 5066.4 samples/s | 79.2 steps/s
[Step=28750 Epoch=56.2] | Loss=0.01114 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.825 | L2-Norm(final)=7.505 | 5053.6 samples/s | 79.0 steps/s
[Step=28800 Epoch=56.3] | Loss=0.01164 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.835 | L2-Norm(final)=7.508 | 5083.0 samples/s | 79.4 steps/s
[Step=28850 Epoch=56.4] | Loss=0.01177 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.845 | L2-Norm(final)=7.511 | 5050.1 samples/s | 78.9 steps/s
[Step=28900 Epoch=56.5] | Loss=0.01179 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.854 | L2-Norm(final)=7.513 | 5088.6 samples/s | 79.5 steps/s
[Step=28950 Epoch=56.6] | Loss=0.01159 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.862 | L2-Norm(final)=7.517 | 5116.9 samples/s | 80.0 steps/s
[Step=29000 Epoch=56.7] | Loss=0.01180 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.871 | L2-Norm(final)=7.519 | 6176.1 samples/s | 96.5 steps/s
[Step=29050 Epoch=56.8] | Loss=0.01182 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.879 | L2-Norm(final)=7.521 | 1925.9 samples/s | 30.1 steps/s
[Step=29100 Epoch=56.9] | Loss=0.01180 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.887 | L2-Norm(final)=7.523 | 5008.8 samples/s | 78.3 steps/s
[Step=29150 Epoch=57.0] | Loss=0.01180 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.894 | L2-Norm(final)=7.524 | 5035.2 samples/s | 78.7 steps/s
[Step=29200 Epoch=57.1] | Loss=0.01157 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=7.526 | 5058.1 samples/s | 79.0 steps/s
[Step=29250 Epoch=57.2] | Loss=0.01137 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.907 | L2-Norm(final)=7.528 | 5105.3 samples/s | 79.8 steps/s
[Step=29300 Epoch=57.3] | Loss=0.01117 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.914 | L2-Norm(final)=7.530 | 5026.9 samples/s | 78.5 steps/s
[Step=29350 Epoch=57.4] | Loss=0.01121 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.920 | L2-Norm(final)=7.532 | 5065.2 samples/s | 79.1 steps/s
[Step=29400 Epoch=57.5] | Loss=0.01123 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.926 | L2-Norm(final)=7.533 | 5128.4 samples/s | 80.1 steps/s
[Step=29450 Epoch=57.6] | Loss=0.01113 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.932 | L2-Norm(final)=7.535 | 4980.3 samples/s | 77.8 steps/s
[Step=29500 Epoch=57.7] | Loss=0.01106 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.937 | L2-Norm(final)=7.537 | 5489.1 samples/s | 85.8 steps/s
[Step=29550 Epoch=57.8] | Loss=0.01081 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.943 | L2-Norm(final)=7.538 | 2000.6 samples/s | 31.3 steps/s
[Step=29600 Epoch=57.9] | Loss=0.01077 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.948 | L2-Norm(final)=7.540 | 5007.9 samples/s | 78.2 steps/s
[Step=29650 Epoch=58.0] | Loss=0.01066 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.953 | L2-Norm(final)=7.542 | 5037.6 samples/s | 78.7 steps/s
[Step=29700 Epoch=58.1] | Loss=0.01058 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.958 | L2-Norm(final)=7.543 | 5058.5 samples/s | 79.0 steps/s
[Step=29750 Epoch=58.2] | Loss=0.01043 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.963 | L2-Norm(final)=7.545 | 4949.3 samples/s | 77.3 steps/s
[Step=29800 Epoch=58.3] | Loss=0.01031 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.967 | L2-Norm(final)=7.546 | 5051.1 samples/s | 78.9 steps/s
[Step=29850 Epoch=58.4] | Loss=0.01026 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.972 | L2-Norm(final)=7.548 | 5014.5 samples/s | 78.4 steps/s
[Step=29900 Epoch=58.5] | Loss=0.01010 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.976 | L2-Norm(final)=7.550 | 5025.5 samples/s | 78.5 steps/s
[Step=29950 Epoch=58.6] | Loss=0.01000 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.981 | L2-Norm(final)=7.551 | 5064.6 samples/s | 79.1 steps/s
[Step=30000 Epoch=58.6] | Loss=0.00990 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.985 | L2-Norm(final)=7.553 | 5028.2 samples/s | 78.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step30000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=28001 Epoch=107.8] | Loss=0.00098 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.640 | L2-Norm(final)=7.264 | 3798.1 samples/s | 59.3 steps/s
[Step=28050 Epoch=108.0] | Loss=0.00041 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.648 | L2-Norm(final)=7.283 | 5108.2 samples/s | 79.8 steps/s
[Step=28100 Epoch=108.2] | Loss=0.00040 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.664 | L2-Norm(final)=7.304 | 5334.8 samples/s | 83.4 steps/s
[Step=28150 Epoch=108.4] | Loss=0.00032 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.678 | L2-Norm(final)=7.320 | 5362.3 samples/s | 83.8 steps/s
[Step=28200 Epoch=108.6] | Loss=0.00032 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.689 | L2-Norm(final)=7.335 | 5291.3 samples/s | 82.7 steps/s
[Step=28250 Epoch=108.7] | Loss=0.00035 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.699 | L2-Norm(final)=7.346 | 7109.4 samples/s | 111.1 steps/s
[Step=28300 Epoch=108.9] | Loss=0.00031 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.712 | L2-Norm(final)=7.355 | 1919.0 samples/s | 30.0 steps/s
[Step=28350 Epoch=109.1] | Loss=0.00027 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.720 | L2-Norm(final)=7.363 | 5362.0 samples/s | 83.8 steps/s
[Step=28400 Epoch=109.3] | Loss=0.00024 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.724 | L2-Norm(final)=7.370 | 5318.6 samples/s | 83.1 steps/s
[Step=28450 Epoch=109.5] | Loss=0.00022 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.726 | L2-Norm(final)=7.376 | 5406.5 samples/s | 84.5 steps/s
[Step=28500 Epoch=109.7] | Loss=0.00020 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.726 | L2-Norm(final)=7.382 | 6081.1 samples/s | 95.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=109.7] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.717 | L2-Norm(final)=7.436 | 3988.4 samples/s | 62.3 steps/s
[Step=28550 Epoch=109.9] | Loss=0.00002 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.699 | L2-Norm(final)=7.438 | 4651.3 samples/s | 72.7 steps/s
[Step=28600 Epoch=110.1] | Loss=0.00002 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.677 | L2-Norm(final)=7.440 | 4737.8 samples/s | 74.0 steps/s
[Step=28650 Epoch=110.3] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.654 | L2-Norm(final)=7.441 | 4834.2 samples/s | 75.5 steps/s
[Step=28700 Epoch=110.5] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.630 | L2-Norm(final)=7.443 | 4733.1 samples/s | 74.0 steps/s
[Step=28750 Epoch=110.7] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.607 | L2-Norm(final)=7.444 | 6107.1 samples/s | 95.4 steps/s
[Step=28800 Epoch=110.9] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.583 | L2-Norm(final)=7.445 | 1867.6 samples/s | 29.2 steps/s
[Step=28850 Epoch=111.1] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.559 | L2-Norm(final)=7.446 | 4758.6 samples/s | 74.4 steps/s
[Step=28900 Epoch=111.2] | Loss=0.00001 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.534 | L2-Norm(final)=7.446 | 4814.3 samples/s | 75.2 steps/s
[Step=28950 Epoch=111.4] | Loss=0.00001 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.509 | L2-Norm(final)=7.447 | 4761.1 samples/s | 74.4 steps/s
[Step=29000 Epoch=111.6] | Loss=0.00001 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=7.448 | 5348.7 samples/s | 83.6 steps/s
[Step=29050 Epoch=111.8] | Loss=0.00001 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.459 | L2-Norm(final)=7.448 | 1910.0 samples/s | 29.8 steps/s
[Step=29100 Epoch=112.0] | Loss=0.00001 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.433 | L2-Norm(final)=7.449 | 4767.0 samples/s | 74.5 steps/s
[Step=29150 Epoch=112.2] | Loss=0.00001 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.408 | L2-Norm(final)=7.449 | 4801.9 samples/s | 75.0 steps/s
[Step=29200 Epoch=112.4] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.382 | L2-Norm(final)=7.450 | 4771.9 samples/s | 74.6 steps/s
[Step=29250 Epoch=112.6] | Loss=0.00000 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.356 | L2-Norm(final)=7.450 | 4905.1 samples/s | 76.6 steps/s
[Step=29300 Epoch=112.8] | Loss=0.00000 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.330 | L2-Norm(final)=7.450 | 1999.9 samples/s | 31.2 steps/s
[Step=29350 Epoch=113.0] | Loss=0.00000 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=7.451 | 4812.1 samples/s | 75.2 steps/s
[Step=29400 Epoch=113.2] | Loss=0.00000 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.277 | L2-Norm(final)=7.451 | 4763.3 samples/s | 74.4 steps/s
[Step=29450 Epoch=113.4] | Loss=0.00000 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.250 | L2-Norm(final)=7.452 | 4776.2 samples/s | 74.6 steps/s
[Step=29500 Epoch=113.6] | Loss=0.00000 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.224 | L2-Norm(final)=7.452 | 4799.6 samples/s | 75.0 steps/s
[Step=29550 Epoch=113.7] | Loss=0.00000 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.197 | L2-Norm(final)=7.453 | 2020.2 samples/s | 31.6 steps/s
[Step=29600 Epoch=113.9] | Loss=0.00000 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=7.453 | 4809.5 samples/s | 75.1 steps/s
[Step=29650 Epoch=114.1] | Loss=0.00000 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=7.454 | 4848.2 samples/s | 75.8 steps/s
[Step=29700 Epoch=114.3] | Loss=0.00000 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.115 | L2-Norm(final)=7.454 | 4769.6 samples/s | 74.5 steps/s
[Step=29750 Epoch=114.5] | Loss=0.00000 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.087 | L2-Norm(final)=7.454 | 4861.4 samples/s | 76.0 steps/s
[Step=29800 Epoch=114.7] | Loss=0.00000 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.059 | L2-Norm(final)=7.455 | 6844.6 samples/s | 106.9 steps/s
[Step=29850 Epoch=114.9] | Loss=0.00000 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.031 | L2-Norm(final)=7.455 | 1793.5 samples/s | 28.0 steps/s
[Step=29900 Epoch=115.1] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.003 | L2-Norm(final)=7.456 | 4870.3 samples/s | 76.1 steps/s
[Step=29950 Epoch=115.3] | Loss=0.00000 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.975 | L2-Norm(final)=7.456 | 4699.7 samples/s | 73.4 steps/s
[Step=30000 Epoch=115.5] | Loss=0.00000 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.946 | L2-Norm(final)=7.457 | 4777.3 samples/s | 74.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step30000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06913 | acc=0.9675 | tpr=0.9775 | fpr=0.0543 | 4516.2 samples/s | 17.6 steps/s
Avg test loss: 0.07033, Avg test acc: 0.96670, Avg tpr: 0.97645, Avg fpr: 0.05474, total FA: 427

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06482 | acc=0.9680 | tpr=0.9686 | fpr=0.0334 | 4530.2 samples/s | 17.7 steps/s
Avg test loss: 0.07107, Avg test acc: 0.96606, Avg tpr: 0.96759, Avg fpr: 0.03730, total FA: 291

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.46984 | acc=0.3141 | tpr=0.0408 | fpr=0.0924 | 4477.9 samples/s | 17.5 steps/s
Avg test loss: 5.46883, Avg test acc: 0.31389, Avg tpr: 0.04237, Avg fpr: 0.08896, total FA: 694

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.73820 | acc=0.3055 | tpr=0.0458 | fpr=0.1303 | 4474.3 samples/s | 17.5 steps/s
Avg test loss: 5.73605, Avg test acc: 0.30443, Avg tpr: 0.04634, Avg fpr: 0.12793, total FA: 998

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.38416 | acc=0.1037 | tpr=0.5885 | fpr=0.9050 | 4459.3 samples/s | 17.4 steps/s
[Step= 100] | Loss=6.35736 | acc=0.1045 | tpr=0.5800 | fpr=0.9043 | 8752.7 samples/s | 34.2 steps/s
[Step= 150] | Loss=6.36466 | acc=0.1040 | tpr=0.5677 | fpr=0.9046 | 9275.3 samples/s | 36.2 steps/s
[Step= 200] | Loss=6.35787 | acc=0.1036 | tpr=0.5628 | fpr=0.9048 | 8693.0 samples/s | 34.0 steps/s
[Step= 250] | Loss=6.35831 | acc=0.1040 | tpr=0.5738 | fpr=0.9046 | 8624.3 samples/s | 33.7 steps/s
[Step= 300] | Loss=6.35468 | acc=0.1046 | tpr=0.5818 | fpr=0.9041 | 9200.3 samples/s | 35.9 steps/s
[Step= 350] | Loss=6.35180 | acc=0.1044 | tpr=0.5811 | fpr=0.9043 | 8517.1 samples/s | 33.3 steps/s
[Step= 400] | Loss=6.34951 | acc=0.1045 | tpr=0.5821 | fpr=0.9042 | 8552.3 samples/s | 33.4 steps/s
[Step= 450] | Loss=6.35812 | acc=0.1041 | tpr=0.5750 | fpr=0.9045 | 8923.1 samples/s | 34.9 steps/s
[Step= 500] | Loss=6.36158 | acc=0.1043 | tpr=0.5775 | fpr=0.9043 | 8867.7 samples/s | 34.6 steps/s
[Step= 550] | Loss=6.36583 | acc=0.1043 | tpr=0.5794 | fpr=0.9043 | 15229.2 samples/s | 59.5 steps/s
Avg test loss: 6.36722, Avg test acc: 0.10424, Avg tpr: 0.58043, Avg fpr: 0.90442, total FA: 125577

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.20679 | acc=0.1520 | tpr=0.5044 | fpr=0.8543 | 4441.2 samples/s | 17.3 steps/s
[Step= 100] | Loss=5.18765 | acc=0.1522 | tpr=0.5075 | fpr=0.8544 | 8961.4 samples/s | 35.0 steps/s
[Step= 150] | Loss=5.20527 | acc=0.1515 | tpr=0.4957 | fpr=0.8548 | 8740.9 samples/s | 34.1 steps/s
[Step= 200] | Loss=5.19760 | acc=0.1505 | tpr=0.4885 | fpr=0.8557 | 8908.0 samples/s | 34.8 steps/s
[Step= 250] | Loss=5.19576 | acc=0.1511 | tpr=0.4987 | fpr=0.8552 | 8987.3 samples/s | 35.1 steps/s
[Step= 300] | Loss=5.19766 | acc=0.1515 | tpr=0.5018 | fpr=0.8549 | 8833.8 samples/s | 34.5 steps/s
[Step= 350] | Loss=5.19453 | acc=0.1514 | tpr=0.5009 | fpr=0.8549 | 8419.0 samples/s | 32.9 steps/s
[Step= 400] | Loss=5.19293 | acc=0.1517 | tpr=0.5049 | fpr=0.8548 | 8710.0 samples/s | 34.0 steps/s
[Step= 450] | Loss=5.20153 | acc=0.1514 | tpr=0.5010 | fpr=0.8550 | 8680.7 samples/s | 33.9 steps/s
[Step= 500] | Loss=5.20467 | acc=0.1512 | tpr=0.4982 | fpr=0.8550 | 8737.5 samples/s | 34.1 steps/s
[Step= 550] | Loss=5.20876 | acc=0.1512 | tpr=0.4986 | fpr=0.8551 | 16303.8 samples/s | 63.7 steps/s
Avg test loss: 5.20931, Avg test acc: 0.15113, Avg tpr: 0.49960, Avg fpr: 0.85520, total FA: 118743

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13122 | acc=0.9820 | tpr=0.9381 | fpr=0.0173 | 4607.9 samples/s | 18.0 steps/s
[Step= 100] | Loss=0.13819 | acc=0.9809 | tpr=0.9488 | fpr=0.0185 | 8300.8 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.14343 | acc=0.9798 | tpr=0.9496 | fpr=0.0196 | 9367.9 samples/s | 36.6 steps/s
[Step= 200] | Loss=0.14393 | acc=0.9799 | tpr=0.9508 | fpr=0.0195 | 8339.8 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.14182 | acc=0.9800 | tpr=0.9476 | fpr=0.0194 | 8771.2 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.14462 | acc=0.9797 | tpr=0.9455 | fpr=0.0197 | 8660.3 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.14565 | acc=0.9796 | tpr=0.9474 | fpr=0.0198 | 8765.4 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.14634 | acc=0.9793 | tpr=0.9453 | fpr=0.0201 | 8722.0 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.14967 | acc=0.9789 | tpr=0.9421 | fpr=0.0205 | 8878.6 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.14875 | acc=0.9789 | tpr=0.9436 | fpr=0.0204 | 9122.2 samples/s | 35.6 steps/s
[Step= 550] | Loss=0.14812 | acc=0.9789 | tpr=0.9403 | fpr=0.0204 | 14589.7 samples/s | 57.0 steps/s
Avg test loss: 0.14766, Avg test acc: 0.97894, Avg tpr: 0.94057, Avg fpr: 0.02037, total FA: 2828

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.15001 | acc=0.9779 | tpr=0.9469 | fpr=0.0216 | 4427.9 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.15787 | acc=0.9770 | tpr=0.9574 | fpr=0.0226 | 8780.8 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.16283 | acc=0.9761 | tpr=0.9611 | fpr=0.0236 | 8883.5 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.16305 | acc=0.9761 | tpr=0.9596 | fpr=0.0236 | 8936.7 samples/s | 34.9 steps/s
[Step= 250] | Loss=0.16036 | acc=0.9762 | tpr=0.9546 | fpr=0.0235 | 8700.8 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.16294 | acc=0.9760 | tpr=0.9542 | fpr=0.0236 | 9031.4 samples/s | 35.3 steps/s
[Step= 350] | Loss=0.16420 | acc=0.9759 | tpr=0.9562 | fpr=0.0238 | 8609.2 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.16498 | acc=0.9757 | tpr=0.9557 | fpr=0.0239 | 8986.2 samples/s | 35.1 steps/s
[Step= 450] | Loss=0.16854 | acc=0.9754 | tpr=0.9542 | fpr=0.0242 | 8609.6 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.16805 | acc=0.9754 | tpr=0.9559 | fpr=0.0242 | 8976.0 samples/s | 35.1 steps/s
[Step= 550] | Loss=0.16738 | acc=0.9754 | tpr=0.9534 | fpr=0.0242 | 15193.6 samples/s | 59.4 steps/s
Avg test loss: 0.16691, Avg test acc: 0.97543, Avg tpr: 0.95365, Avg fpr: 0.02417, total FA: 3356

server round 30/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=36001 Epoch=137.9] | Loss=0.00072 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.278 | L2-Norm(final)=8.772 | 3980.0 samples/s | 62.2 steps/s
[Step=36050 Epoch=138.1] | Loss=0.00052 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.278 | L2-Norm(final)=8.778 | 4821.7 samples/s | 75.3 steps/s
[Step=36100 Epoch=138.3] | Loss=0.00043 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=8.785 | 5401.9 samples/s | 84.4 steps/s
[Step=36150 Epoch=138.5] | Loss=0.00033 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.286 | L2-Norm(final)=8.791 | 5261.5 samples/s | 82.2 steps/s
[Step=36200 Epoch=138.7] | Loss=0.00028 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=8.796 | 5332.0 samples/s | 83.3 steps/s
[Step=36250 Epoch=138.9] | Loss=0.00027 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=8.802 | 7019.7 samples/s | 109.7 steps/s
[Step=36300 Epoch=139.1] | Loss=0.00024 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=8.807 | 1938.4 samples/s | 30.3 steps/s
[Step=36350 Epoch=139.3] | Loss=0.00022 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=8.812 | 5313.2 samples/s | 83.0 steps/s
[Step=36400 Epoch=139.5] | Loss=0.00020 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=8.817 | 5323.6 samples/s | 83.2 steps/s
[Step=36450 Epoch=139.7] | Loss=0.00018 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=8.821 | 5401.0 samples/s | 84.4 steps/s
[Step=36500 Epoch=139.9] | Loss=0.00017 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=8.824 | 5923.2 samples/s | 92.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=139.9] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=8.861 | 3774.6 samples/s | 59.0 steps/s
[Step=36550 Epoch=140.0] | Loss=0.00004 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=8.863 | 4568.8 samples/s | 71.4 steps/s
[Step=36600 Epoch=140.2] | Loss=0.00003 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.253 | L2-Norm(final)=8.865 | 4765.6 samples/s | 74.5 steps/s
[Step=36650 Epoch=140.4] | Loss=0.00003 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=8.867 | 4842.4 samples/s | 75.7 steps/s
[Step=36700 Epoch=140.6] | Loss=0.00002 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.235 | L2-Norm(final)=8.868 | 4784.1 samples/s | 74.8 steps/s
[Step=36750 Epoch=140.8] | Loss=0.00002 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.225 | L2-Norm(final)=8.869 | 6031.5 samples/s | 94.2 steps/s
[Step=36800 Epoch=141.0] | Loss=0.00002 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.215 | L2-Norm(final)=8.870 | 1859.3 samples/s | 29.1 steps/s
[Step=36850 Epoch=141.2] | Loss=0.00002 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.205 | L2-Norm(final)=8.871 | 4769.0 samples/s | 74.5 steps/s
[Step=36900 Epoch=141.4] | Loss=0.00002 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.195 | L2-Norm(final)=8.872 | 4736.3 samples/s | 74.0 steps/s
[Step=36950 Epoch=141.6] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.184 | L2-Norm(final)=8.873 | 4822.4 samples/s | 75.3 steps/s
[Step=37000 Epoch=141.8] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=8.873 | 5306.2 samples/s | 82.9 steps/s
[Step=37050 Epoch=142.0] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=8.874 | 1950.4 samples/s | 30.5 steps/s
[Step=37100 Epoch=142.2] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=8.875 | 4820.4 samples/s | 75.3 steps/s
[Step=37150 Epoch=142.3] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=8.875 | 4838.8 samples/s | 75.6 steps/s
[Step=37200 Epoch=142.5] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.129 | L2-Norm(final)=8.876 | 4710.1 samples/s | 73.6 steps/s
[Step=37250 Epoch=142.7] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.118 | L2-Norm(final)=8.876 | 4788.5 samples/s | 74.8 steps/s
[Step=37300 Epoch=142.9] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.106 | L2-Norm(final)=8.877 | 2021.2 samples/s | 31.6 steps/s
[Step=37350 Epoch=143.1] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.094 | L2-Norm(final)=8.877 | 4877.7 samples/s | 76.2 steps/s
[Step=37400 Epoch=143.3] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.082 | L2-Norm(final)=8.878 | 4770.7 samples/s | 74.5 steps/s
[Step=37450 Epoch=143.5] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=8.878 | 4815.0 samples/s | 75.2 steps/s
[Step=37500 Epoch=143.7] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.058 | L2-Norm(final)=8.878 | 4721.7 samples/s | 73.8 steps/s
[Step=37550 Epoch=143.9] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.046 | L2-Norm(final)=8.879 | 2023.5 samples/s | 31.6 steps/s
[Step=37600 Epoch=144.1] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.033 | L2-Norm(final)=8.879 | 4777.7 samples/s | 74.7 steps/s
[Step=37650 Epoch=144.3] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.021 | L2-Norm(final)=8.880 | 4858.9 samples/s | 75.9 steps/s
[Step=37700 Epoch=144.5] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.008 | L2-Norm(final)=8.880 | 4778.2 samples/s | 74.7 steps/s
[Step=37750 Epoch=144.6] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.995 | L2-Norm(final)=8.881 | 4676.8 samples/s | 73.1 steps/s
[Step=37800 Epoch=144.8] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.982 | L2-Norm(final)=8.881 | 6544.4 samples/s | 102.3 steps/s
[Step=37850 Epoch=145.0] | Loss=0.00001 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.968 | L2-Norm(final)=8.881 | 1833.2 samples/s | 28.6 steps/s
[Step=37900 Epoch=145.2] | Loss=0.00001 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.955 | L2-Norm(final)=8.882 | 4876.5 samples/s | 76.2 steps/s
[Step=37950 Epoch=145.4] | Loss=0.00001 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.941 | L2-Norm(final)=8.882 | 4746.2 samples/s | 74.2 steps/s
[Step=38000 Epoch=145.6] | Loss=0.00001 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.927 | L2-Norm(final)=8.883 | 4803.2 samples/s | 75.0 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step38000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=30001 Epoch=115.5] | Loss=0.00123 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.278 | L2-Norm(final)=7.472 | 3812.6 samples/s | 59.6 steps/s
[Step=30050 Epoch=115.7] | Loss=0.00038 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.275 | L2-Norm(final)=7.481 | 5143.1 samples/s | 80.4 steps/s
[Step=30100 Epoch=115.9] | Loss=0.00027 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.281 | L2-Norm(final)=7.493 | 5326.3 samples/s | 83.2 steps/s
[Step=30150 Epoch=116.1] | Loss=0.00024 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=7.501 | 5274.5 samples/s | 82.4 steps/s
[Step=30200 Epoch=116.3] | Loss=0.00022 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.284 | L2-Norm(final)=7.509 | 5395.7 samples/s | 84.3 steps/s
[Step=30250 Epoch=116.4] | Loss=0.00020 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=7.517 | 7023.0 samples/s | 109.7 steps/s
[Step=30300 Epoch=116.6] | Loss=0.00018 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.284 | L2-Norm(final)=7.524 | 1924.6 samples/s | 30.1 steps/s
[Step=30350 Epoch=116.8] | Loss=0.00016 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.283 | L2-Norm(final)=7.530 | 5403.4 samples/s | 84.4 steps/s
[Step=30400 Epoch=117.0] | Loss=0.00015 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.281 | L2-Norm(final)=7.535 | 5330.1 samples/s | 83.3 steps/s
[Step=30450 Epoch=117.2] | Loss=0.00014 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.279 | L2-Norm(final)=7.541 | 5335.3 samples/s | 83.4 steps/s
[Step=30500 Epoch=117.4] | Loss=0.00013 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.276 | L2-Norm(final)=7.545 | 6174.5 samples/s | 96.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=117.4] | Loss=0.00004 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.248 | L2-Norm(final)=7.593 | 3801.4 samples/s | 59.4 steps/s
[Step=30550 Epoch=117.6] | Loss=0.00003 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.233 | L2-Norm(final)=7.596 | 4542.8 samples/s | 71.0 steps/s
[Step=30600 Epoch=117.8] | Loss=0.00002 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=7.598 | 4862.1 samples/s | 76.0 steps/s
[Step=30650 Epoch=118.0] | Loss=0.00002 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.189 | L2-Norm(final)=7.600 | 4843.0 samples/s | 75.7 steps/s
[Step=30700 Epoch=118.2] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=7.601 | 4820.4 samples/s | 75.3 steps/s
[Step=30750 Epoch=118.4] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=7.602 | 6048.4 samples/s | 94.5 steps/s
[Step=30800 Epoch=118.6] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.120 | L2-Norm(final)=7.603 | 1858.0 samples/s | 29.0 steps/s
[Step=30850 Epoch=118.8] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.097 | L2-Norm(final)=7.603 | 4812.1 samples/s | 75.2 steps/s
[Step=30900 Epoch=118.9] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=7.604 | 4711.0 samples/s | 73.6 steps/s
[Step=30950 Epoch=119.1] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.049 | L2-Norm(final)=7.605 | 4839.1 samples/s | 75.6 steps/s
[Step=31000 Epoch=119.3] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.025 | L2-Norm(final)=7.605 | 5410.0 samples/s | 84.5 steps/s
[Step=31050 Epoch=119.5] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.000 | L2-Norm(final)=7.606 | 1939.9 samples/s | 30.3 steps/s
[Step=31100 Epoch=119.7] | Loss=0.00001 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.976 | L2-Norm(final)=7.606 | 4699.0 samples/s | 73.4 steps/s
[Step=31150 Epoch=119.9] | Loss=0.00001 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.951 | L2-Norm(final)=7.607 | 4774.3 samples/s | 74.6 steps/s
[Step=31200 Epoch=120.1] | Loss=0.00001 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.926 | L2-Norm(final)=7.607 | 4837.6 samples/s | 75.6 steps/s
[Step=31250 Epoch=120.3] | Loss=0.00001 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.900 | L2-Norm(final)=7.607 | 4845.2 samples/s | 75.7 steps/s
[Step=31300 Epoch=120.5] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.875 | L2-Norm(final)=7.608 | 2016.7 samples/s | 31.5 steps/s
[Step=31350 Epoch=120.7] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.849 | L2-Norm(final)=7.608 | 4924.5 samples/s | 76.9 steps/s
[Step=31400 Epoch=120.9] | Loss=0.00000 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.823 | L2-Norm(final)=7.609 | 4728.7 samples/s | 73.9 steps/s
[Step=31450 Epoch=121.1] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.797 | L2-Norm(final)=7.609 | 4822.3 samples/s | 75.3 steps/s
[Step=31500 Epoch=121.3] | Loss=0.00000 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.771 | L2-Norm(final)=7.609 | 4797.5 samples/s | 75.0 steps/s
[Step=31550 Epoch=121.4] | Loss=0.00000 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.744 | L2-Norm(final)=7.610 | 2019.0 samples/s | 31.5 steps/s
[Step=31600 Epoch=121.6] | Loss=0.00000 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.718 | L2-Norm(final)=7.610 | 4859.3 samples/s | 75.9 steps/s
[Step=31650 Epoch=121.8] | Loss=0.00000 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.691 | L2-Norm(final)=7.611 | 4698.2 samples/s | 73.4 steps/s
[Step=31700 Epoch=122.0] | Loss=0.00000 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.663 | L2-Norm(final)=7.611 | 4888.1 samples/s | 76.4 steps/s
[Step=31750 Epoch=122.2] | Loss=0.00000 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.636 | L2-Norm(final)=7.611 | 4709.0 samples/s | 73.6 steps/s
[Step=31800 Epoch=122.4] | Loss=0.00000 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.608 | L2-Norm(final)=7.612 | 7043.1 samples/s | 110.0 steps/s
[Step=31850 Epoch=122.6] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.581 | L2-Norm(final)=7.612 | 1800.4 samples/s | 28.1 steps/s
[Step=31900 Epoch=122.8] | Loss=0.00000 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.553 | L2-Norm(final)=7.613 | 4810.0 samples/s | 75.2 steps/s
[Step=31950 Epoch=123.0] | Loss=0.00000 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.525 | L2-Norm(final)=7.613 | 4817.9 samples/s | 75.3 steps/s
[Step=32000 Epoch=123.2] | Loss=0.00000 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.496 | L2-Norm(final)=7.614 | 4846.7 samples/s | 75.7 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06913 | acc=0.9675 | tpr=0.9775 | fpr=0.0543 | 4440.5 samples/s | 17.3 steps/s
Avg test loss: 0.07033, Avg test acc: 0.96670, Avg tpr: 0.97645, Avg fpr: 0.05474, total FA: 427

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06482 | acc=0.9680 | tpr=0.9686 | fpr=0.0334 | 4470.5 samples/s | 17.5 steps/s
Avg test loss: 0.07107, Avg test acc: 0.96606, Avg tpr: 0.96759, Avg fpr: 0.03730, total FA: 291

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.30725 | acc=0.3178 | tpr=0.0430 | fpr=0.0855 | 4424.5 samples/s | 17.3 steps/s
Avg test loss: 5.30671, Avg test acc: 0.31657, Avg tpr: 0.04430, Avg fpr: 0.08460, total FA: 660

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.60034 | acc=0.3088 | tpr=0.0448 | fpr=0.1179 | 4397.3 samples/s | 17.2 steps/s
Avg test loss: 5.59697, Avg test acc: 0.30780, Avg tpr: 0.04564, Avg fpr: 0.11563, total FA: 902

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=6.38416 | acc=0.1037 | tpr=0.5885 | fpr=0.9050 | 4491.8 samples/s | 17.5 steps/s
[Step= 100] | Loss=6.35736 | acc=0.1045 | tpr=0.5800 | fpr=0.9043 | 8467.8 samples/s | 33.1 steps/s
[Step= 150] | Loss=6.36466 | acc=0.1040 | tpr=0.5677 | fpr=0.9046 | 8892.4 samples/s | 34.7 steps/s
[Step= 200] | Loss=6.35787 | acc=0.1036 | tpr=0.5628 | fpr=0.9048 | 8922.0 samples/s | 34.9 steps/s
[Step= 250] | Loss=6.35831 | acc=0.1040 | tpr=0.5738 | fpr=0.9046 | 8556.4 samples/s | 33.4 steps/s
[Step= 300] | Loss=6.35468 | acc=0.1046 | tpr=0.5818 | fpr=0.9041 | 8851.8 samples/s | 34.6 steps/s
[Step= 350] | Loss=6.35180 | acc=0.1044 | tpr=0.5811 | fpr=0.9043 | 8785.6 samples/s | 34.3 steps/s
[Step= 400] | Loss=6.34951 | acc=0.1045 | tpr=0.5821 | fpr=0.9042 | 8989.7 samples/s | 35.1 steps/s
[Step= 450] | Loss=6.35812 | acc=0.1041 | tpr=0.5750 | fpr=0.9045 | 8752.1 samples/s | 34.2 steps/s
[Step= 500] | Loss=6.36158 | acc=0.1043 | tpr=0.5775 | fpr=0.9043 | 8507.4 samples/s | 33.2 steps/s
[Step= 550] | Loss=6.36583 | acc=0.1043 | tpr=0.5794 | fpr=0.9043 | 16212.4 samples/s | 63.3 steps/s
Avg test loss: 6.36722, Avg test acc: 0.10424, Avg tpr: 0.58043, Avg fpr: 0.90442, total FA: 125577

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.20679 | acc=0.1520 | tpr=0.5044 | fpr=0.8543 | 4477.5 samples/s | 17.5 steps/s
[Step= 100] | Loss=5.18765 | acc=0.1522 | tpr=0.5075 | fpr=0.8544 | 8879.3 samples/s | 34.7 steps/s
[Step= 150] | Loss=5.20527 | acc=0.1515 | tpr=0.4957 | fpr=0.8548 | 8729.7 samples/s | 34.1 steps/s
[Step= 200] | Loss=5.19760 | acc=0.1505 | tpr=0.4885 | fpr=0.8557 | 8539.3 samples/s | 33.4 steps/s
[Step= 250] | Loss=5.19576 | acc=0.1511 | tpr=0.4987 | fpr=0.8552 | 8817.2 samples/s | 34.4 steps/s
[Step= 300] | Loss=5.19766 | acc=0.1515 | tpr=0.5018 | fpr=0.8549 | 9030.2 samples/s | 35.3 steps/s
[Step= 350] | Loss=5.19453 | acc=0.1514 | tpr=0.5009 | fpr=0.8549 | 8611.2 samples/s | 33.6 steps/s
[Step= 400] | Loss=5.19293 | acc=0.1517 | tpr=0.5049 | fpr=0.8548 | 9403.6 samples/s | 36.7 steps/s
[Step= 450] | Loss=5.20153 | acc=0.1514 | tpr=0.5010 | fpr=0.8550 | 8252.1 samples/s | 32.2 steps/s
[Step= 500] | Loss=5.20467 | acc=0.1512 | tpr=0.4982 | fpr=0.8550 | 8828.8 samples/s | 34.5 steps/s
[Step= 550] | Loss=5.20876 | acc=0.1512 | tpr=0.4986 | fpr=0.8551 | 15883.5 samples/s | 62.0 steps/s
Avg test loss: 5.20931, Avg test acc: 0.15113, Avg tpr: 0.49960, Avg fpr: 0.85520, total FA: 118743

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13515 | acc=0.9813 | tpr=0.9336 | fpr=0.0178 | 4470.2 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.14199 | acc=0.9804 | tpr=0.9488 | fpr=0.0190 | 8637.0 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.14738 | acc=0.9792 | tpr=0.9496 | fpr=0.0202 | 8620.5 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.14771 | acc=0.9793 | tpr=0.9508 | fpr=0.0202 | 8808.9 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.14540 | acc=0.9793 | tpr=0.9467 | fpr=0.0201 | 8686.0 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.14821 | acc=0.9791 | tpr=0.9469 | fpr=0.0203 | 8858.8 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.14927 | acc=0.9790 | tpr=0.9487 | fpr=0.0205 | 8757.0 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.14980 | acc=0.9787 | tpr=0.9475 | fpr=0.0208 | 8940.9 samples/s | 34.9 steps/s
[Step= 450] | Loss=0.15325 | acc=0.9782 | tpr=0.9440 | fpr=0.0211 | 8784.8 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.15237 | acc=0.9784 | tpr=0.9458 | fpr=0.0211 | 8563.1 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.15170 | acc=0.9784 | tpr=0.9431 | fpr=0.0210 | 16260.5 samples/s | 63.5 steps/s
Avg test loss: 0.15125, Avg test acc: 0.97837, Avg tpr: 0.94334, Avg fpr: 0.02099, total FA: 2915

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14839 | acc=0.9778 | tpr=0.9469 | fpr=0.0216 | 4437.4 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.15502 | acc=0.9773 | tpr=0.9574 | fpr=0.0223 | 8845.6 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.16024 | acc=0.9763 | tpr=0.9611 | fpr=0.0234 | 8994.3 samples/s | 35.1 steps/s
[Step= 200] | Loss=0.16068 | acc=0.9763 | tpr=0.9596 | fpr=0.0234 | 8650.5 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.15811 | acc=0.9763 | tpr=0.9555 | fpr=0.0233 | 9017.0 samples/s | 35.2 steps/s
[Step= 300] | Loss=0.16068 | acc=0.9762 | tpr=0.9549 | fpr=0.0234 | 8762.6 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.16200 | acc=0.9760 | tpr=0.9568 | fpr=0.0236 | 8873.3 samples/s | 34.7 steps/s
[Step= 400] | Loss=0.16275 | acc=0.9758 | tpr=0.9562 | fpr=0.0238 | 9515.2 samples/s | 37.2 steps/s
[Step= 450] | Loss=0.16624 | acc=0.9755 | tpr=0.9547 | fpr=0.0241 | 8207.7 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.16582 | acc=0.9755 | tpr=0.9564 | fpr=0.0242 | 8727.9 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.16519 | acc=0.9755 | tpr=0.9546 | fpr=0.0241 | 16095.2 samples/s | 62.9 steps/s
Avg test loss: 0.16475, Avg test acc: 0.97551, Avg tpr: 0.95483, Avg fpr: 0.02411, total FA: 3348

server round 31/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=24001 Epoch=46.8] | Loss=0.00821 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.036 | L2-Norm(final)=6.983 | 3703.0 samples/s | 57.9 steps/s
[Step=24050 Epoch=46.9] | Loss=0.00817 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.040 | L2-Norm(final)=6.985 | 5294.7 samples/s | 82.7 steps/s
[Step=24100 Epoch=47.0] | Loss=0.00985 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.044 | L2-Norm(final)=6.989 | 5735.5 samples/s | 89.6 steps/s
[Step=24150 Epoch=47.1] | Loss=0.00986 | Reg=0.00145 | acc=0.9688 | L2-Norm=12.048 | L2-Norm(final)=6.993 | 5731.7 samples/s | 89.6 steps/s
[Step=24200 Epoch=47.2] | Loss=0.01038 | Reg=0.00145 | acc=0.9688 | L2-Norm=12.052 | L2-Norm(final)=6.997 | 5525.1 samples/s | 86.3 steps/s
[Step=24250 Epoch=47.3] | Loss=0.01006 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.055 | L2-Norm(final)=7.001 | 5701.3 samples/s | 89.1 steps/s
[Step=24300 Epoch=47.4] | Loss=0.00974 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.059 | L2-Norm(final)=7.005 | 5688.3 samples/s | 88.9 steps/s
[Step=24350 Epoch=47.5] | Loss=0.00988 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.062 | L2-Norm(final)=7.009 | 5731.6 samples/s | 89.6 steps/s
[Step=24400 Epoch=47.6] | Loss=0.00997 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.066 | L2-Norm(final)=7.013 | 5694.6 samples/s | 89.0 steps/s
[Step=24450 Epoch=47.7] | Loss=0.00989 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=7.017 | 5651.9 samples/s | 88.3 steps/s
[Step=24500 Epoch=47.8] | Loss=0.00977 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=7.021 | 7176.2 samples/s | 112.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=24501 Epoch=47.8] | Loss=0.00727 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.108 | L2-Norm(final)=7.063 | 3714.7 samples/s | 58.0 steps/s
[Step=24550 Epoch=47.9] | Loss=0.00757 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.113 | L2-Norm(final)=7.068 | 4673.1 samples/s | 73.0 steps/s
[Step=24600 Epoch=48.0] | Loss=0.00902 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.119 | L2-Norm(final)=7.074 | 5065.3 samples/s | 79.1 steps/s
[Step=24650 Epoch=48.1] | Loss=0.00930 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.125 | L2-Norm(final)=7.078 | 5012.5 samples/s | 78.3 steps/s
[Step=24700 Epoch=48.2] | Loss=0.00884 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.130 | L2-Norm(final)=7.081 | 5086.1 samples/s | 79.5 steps/s
[Step=24750 Epoch=48.3] | Loss=0.00888 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=7.085 | 5074.3 samples/s | 79.3 steps/s
[Step=24800 Epoch=48.4] | Loss=0.00901 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=7.088 | 4983.9 samples/s | 77.9 steps/s
[Step=24850 Epoch=48.5] | Loss=0.00924 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=7.091 | 5054.7 samples/s | 79.0 steps/s
[Step=24900 Epoch=48.6] | Loss=0.00924 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.148 | L2-Norm(final)=7.095 | 5060.9 samples/s | 79.1 steps/s
[Step=24950 Epoch=48.7] | Loss=0.00902 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.152 | L2-Norm(final)=7.098 | 5057.1 samples/s | 79.0 steps/s
[Step=25000 Epoch=48.8] | Loss=0.00911 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.156 | L2-Norm(final)=7.102 | 6173.0 samples/s | 96.5 steps/s
[Step=25050 Epoch=48.9] | Loss=0.00899 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.160 | L2-Norm(final)=7.105 | 1846.4 samples/s | 28.9 steps/s
[Step=25100 Epoch=49.0] | Loss=0.00874 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=7.108 | 4998.1 samples/s | 78.1 steps/s
[Step=25150 Epoch=49.1] | Loss=0.00855 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.168 | L2-Norm(final)=7.112 | 5029.9 samples/s | 78.6 steps/s
[Step=25200 Epoch=49.1] | Loss=0.00843 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.172 | L2-Norm(final)=7.115 | 5062.8 samples/s | 79.1 steps/s
[Step=25250 Epoch=49.2] | Loss=0.00840 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.175 | L2-Norm(final)=7.118 | 5051.8 samples/s | 78.9 steps/s
[Step=25300 Epoch=49.3] | Loss=0.00830 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.178 | L2-Norm(final)=7.121 | 5017.1 samples/s | 78.4 steps/s
[Step=25350 Epoch=49.4] | Loss=0.00827 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.182 | L2-Norm(final)=7.124 | 5081.2 samples/s | 79.4 steps/s
[Step=25400 Epoch=49.5] | Loss=0.00822 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.185 | L2-Norm(final)=7.127 | 5065.6 samples/s | 79.2 steps/s
[Step=25450 Epoch=49.6] | Loss=0.00819 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.188 | L2-Norm(final)=7.130 | 5065.7 samples/s | 79.2 steps/s
[Step=25500 Epoch=49.7] | Loss=0.00807 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.191 | L2-Norm(final)=7.133 | 5328.0 samples/s | 83.2 steps/s
[Step=25550 Epoch=49.8] | Loss=0.00796 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.194 | L2-Norm(final)=7.136 | 1959.5 samples/s | 30.6 steps/s
[Step=25600 Epoch=49.9] | Loss=0.00788 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.197 | L2-Norm(final)=7.139 | 5029.7 samples/s | 78.6 steps/s
[Step=25650 Epoch=50.0] | Loss=0.00770 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.199 | L2-Norm(final)=7.142 | 5040.9 samples/s | 78.8 steps/s
[Step=25700 Epoch=50.1] | Loss=0.00762 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.202 | L2-Norm(final)=7.145 | 5071.0 samples/s | 79.2 steps/s
[Step=25750 Epoch=50.2] | Loss=0.00763 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.205 | L2-Norm(final)=7.147 | 5097.5 samples/s | 79.6 steps/s
[Step=25800 Epoch=50.3] | Loss=0.00759 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.208 | L2-Norm(final)=7.150 | 5033.1 samples/s | 78.6 steps/s
[Step=25850 Epoch=50.4] | Loss=0.00750 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.210 | L2-Norm(final)=7.153 | 5035.1 samples/s | 78.7 steps/s
[Step=25900 Epoch=50.5] | Loss=0.00752 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.213 | L2-Norm(final)=7.156 | 5107.4 samples/s | 79.8 steps/s
[Step=25950 Epoch=50.6] | Loss=0.00745 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.216 | L2-Norm(final)=7.159 | 5020.0 samples/s | 78.4 steps/s
[Step=26000 Epoch=50.7] | Loss=0.00745 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.219 | L2-Norm(final)=7.161 | 5059.3 samples/s | 79.1 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step26000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=32001 Epoch=123.2] | Loss=0.00011 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.036 | L2-Norm(final)=7.627 | 4061.7 samples/s | 63.5 steps/s
[Step=32050 Epoch=123.4] | Loss=0.00043 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.031 | L2-Norm(final)=7.643 | 5036.7 samples/s | 78.7 steps/s
[Step=32100 Epoch=123.6] | Loss=0.00030 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.041 | L2-Norm(final)=7.657 | 5363.7 samples/s | 83.8 steps/s
[Step=32150 Epoch=123.8] | Loss=0.00025 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.045 | L2-Norm(final)=7.668 | 5233.4 samples/s | 81.8 steps/s
[Step=32200 Epoch=124.0] | Loss=0.00020 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.046 | L2-Norm(final)=7.677 | 5332.5 samples/s | 83.3 steps/s
[Step=32250 Epoch=124.1] | Loss=0.00018 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.044 | L2-Norm(final)=7.685 | 7134.2 samples/s | 111.5 steps/s
[Step=32300 Epoch=124.3] | Loss=0.00016 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.043 | L2-Norm(final)=7.692 | 1932.7 samples/s | 30.2 steps/s
[Step=32350 Epoch=124.5] | Loss=0.00015 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.040 | L2-Norm(final)=7.698 | 5254.3 samples/s | 82.1 steps/s
[Step=32400 Epoch=124.7] | Loss=0.00013 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.037 | L2-Norm(final)=7.703 | 5335.5 samples/s | 83.4 steps/s
[Step=32450 Epoch=124.9] | Loss=0.00012 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.034 | L2-Norm(final)=7.708 | 5283.1 samples/s | 82.5 steps/s
[Step=32500 Epoch=125.1] | Loss=0.00011 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.030 | L2-Norm(final)=7.713 | 6187.2 samples/s | 96.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=125.1] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.990 | L2-Norm(final)=7.760 | 3555.6 samples/s | 55.6 steps/s
[Step=32550 Epoch=125.3] | Loss=0.00014 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.968 | L2-Norm(final)=7.763 | 4938.1 samples/s | 77.2 steps/s
[Step=32600 Epoch=125.5] | Loss=0.00356 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.970 | L2-Norm(final)=7.764 | 4853.0 samples/s | 75.8 steps/s
[Step=32650 Epoch=125.7] | Loss=0.00306 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.979 | L2-Norm(final)=7.760 | 4745.9 samples/s | 74.2 steps/s
[Step=32700 Epoch=125.9] | Loss=0.00232 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.985 | L2-Norm(final)=7.757 | 4754.2 samples/s | 74.3 steps/s
[Step=32750 Epoch=126.1] | Loss=0.00187 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.988 | L2-Norm(final)=7.756 | 6138.0 samples/s | 95.9 steps/s
[Step=32800 Epoch=126.3] | Loss=0.00156 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.990 | L2-Norm(final)=7.755 | 1850.8 samples/s | 28.9 steps/s
[Step=32850 Epoch=126.5] | Loss=0.00135 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.990 | L2-Norm(final)=7.754 | 4749.4 samples/s | 74.2 steps/s
[Step=32900 Epoch=126.6] | Loss=0.00118 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.990 | L2-Norm(final)=7.754 | 4805.9 samples/s | 75.1 steps/s
[Step=32950 Epoch=126.8] | Loss=0.00105 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.990 | L2-Norm(final)=7.754 | 4505.4 samples/s | 70.4 steps/s
[Step=33000 Epoch=127.0] | Loss=0.00095 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.990 | L2-Norm(final)=7.754 | 5428.0 samples/s | 84.8 steps/s
[Step=33050 Epoch=127.2] | Loss=0.00087 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.989 | L2-Norm(final)=7.754 | 1917.7 samples/s | 30.0 steps/s
[Step=33100 Epoch=127.4] | Loss=0.00080 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.988 | L2-Norm(final)=7.754 | 3931.3 samples/s | 61.4 steps/s
[Step=33150 Epoch=127.6] | Loss=0.00074 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.987 | L2-Norm(final)=7.754 | 3946.2 samples/s | 61.7 steps/s
[Step=33200 Epoch=127.8] | Loss=0.00069 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.986 | L2-Norm(final)=7.754 | 3960.7 samples/s | 61.9 steps/s
[Step=33250 Epoch=128.0] | Loss=0.00064 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.985 | L2-Norm(final)=7.754 | 4033.7 samples/s | 63.0 steps/s
[Step=33300 Epoch=128.2] | Loss=0.00060 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.983 | L2-Norm(final)=7.754 | 1924.1 samples/s | 30.1 steps/s
[Step=33350 Epoch=128.4] | Loss=0.00057 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.982 | L2-Norm(final)=7.754 | 4818.1 samples/s | 75.3 steps/s
[Step=33400 Epoch=128.6] | Loss=0.00054 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.980 | L2-Norm(final)=7.754 | 4681.1 samples/s | 73.1 steps/s
[Step=33450 Epoch=128.8] | Loss=0.00051 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.979 | L2-Norm(final)=7.754 | 4772.1 samples/s | 74.6 steps/s
[Step=33500 Epoch=129.0] | Loss=0.00048 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.977 | L2-Norm(final)=7.754 | 4785.0 samples/s | 74.8 steps/s
[Step=33550 Epoch=129.1] | Loss=0.00046 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.975 | L2-Norm(final)=7.755 | 2028.7 samples/s | 31.7 steps/s
[Step=33600 Epoch=129.3] | Loss=0.00044 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.974 | L2-Norm(final)=7.755 | 4785.4 samples/s | 74.8 steps/s
[Step=33650 Epoch=129.5] | Loss=0.00042 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=7.755 | 4765.5 samples/s | 74.5 steps/s
[Step=33700 Epoch=129.7] | Loss=0.00041 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.970 | L2-Norm(final)=7.755 | 4764.3 samples/s | 74.4 steps/s
[Step=33750 Epoch=129.9] | Loss=0.00039 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.968 | L2-Norm(final)=7.755 | 4832.6 samples/s | 75.5 steps/s
[Step=33800 Epoch=130.1] | Loss=0.00038 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.966 | L2-Norm(final)=7.755 | 6889.7 samples/s | 107.7 steps/s
[Step=33850 Epoch=130.3] | Loss=0.00036 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.965 | L2-Norm(final)=7.756 | 1793.9 samples/s | 28.0 steps/s
[Step=33900 Epoch=130.5] | Loss=0.00035 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.963 | L2-Norm(final)=7.756 | 4732.4 samples/s | 73.9 steps/s
[Step=33950 Epoch=130.7] | Loss=0.00034 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.961 | L2-Norm(final)=7.756 | 4858.4 samples/s | 75.9 steps/s
[Step=34000 Epoch=130.9] | Loss=0.00033 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.958 | L2-Norm(final)=7.756 | 4735.9 samples/s | 74.0 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step34000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06076 | acc=0.9695 | tpr=0.9772 | fpr=0.0471 | 4511.9 samples/s | 17.6 steps/s
Avg test loss: 0.06373, Avg test acc: 0.96919, Avg tpr: 0.97651, Avg fpr: 0.04692, total FA: 366

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06482 | acc=0.9680 | tpr=0.9686 | fpr=0.0334 | 4434.8 samples/s | 17.3 steps/s
Avg test loss: 0.07107, Avg test acc: 0.96606, Avg tpr: 0.96759, Avg fpr: 0.03730, total FA: 291

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.30725 | acc=0.3178 | tpr=0.0430 | fpr=0.0855 | 4564.5 samples/s | 17.8 steps/s
Avg test loss: 5.30671, Avg test acc: 0.31657, Avg tpr: 0.04430, Avg fpr: 0.08460, total FA: 660

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.44555 | acc=0.3113 | tpr=0.0395 | fpr=0.0986 | 4439.8 samples/s | 17.3 steps/s
Avg test loss: 5.44837, Avg test acc: 0.30980, Avg tpr: 0.03928, Avg fpr: 0.09524, total FA: 743

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.79678 | acc=0.1192 | tpr=0.5796 | fpr=0.8891 | 4522.3 samples/s | 17.7 steps/s
[Step= 100] | Loss=5.77618 | acc=0.1196 | tpr=0.5714 | fpr=0.8888 | 8655.1 samples/s | 33.8 steps/s
[Step= 150] | Loss=5.78852 | acc=0.1193 | tpr=0.5677 | fpr=0.8890 | 8600.1 samples/s | 33.6 steps/s
[Step= 200] | Loss=5.78029 | acc=0.1186 | tpr=0.5639 | fpr=0.8895 | 9024.7 samples/s | 35.3 steps/s
[Step= 250] | Loss=5.78180 | acc=0.1190 | tpr=0.5764 | fpr=0.8893 | 9075.6 samples/s | 35.5 steps/s
[Step= 300] | Loss=5.78111 | acc=0.1192 | tpr=0.5840 | fpr=0.8893 | 8605.3 samples/s | 33.6 steps/s
[Step= 350] | Loss=5.77889 | acc=0.1190 | tpr=0.5867 | fpr=0.8895 | 8868.2 samples/s | 34.6 steps/s
[Step= 400] | Loss=5.77804 | acc=0.1190 | tpr=0.5886 | fpr=0.8896 | 8645.0 samples/s | 33.8 steps/s
[Step= 450] | Loss=5.78727 | acc=0.1186 | tpr=0.5837 | fpr=0.8898 | 8922.7 samples/s | 34.9 steps/s
[Step= 500] | Loss=5.79121 | acc=0.1187 | tpr=0.5872 | fpr=0.8898 | 8898.7 samples/s | 34.8 steps/s
[Step= 550] | Loss=5.79545 | acc=0.1189 | tpr=0.5877 | fpr=0.8896 | 14542.7 samples/s | 56.8 steps/s
Avg test loss: 5.79626, Avg test acc: 0.11884, Avg tpr: 0.58835, Avg fpr: 0.88970, total FA: 123533

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.20679 | acc=0.1520 | tpr=0.5044 | fpr=0.8543 | 4479.9 samples/s | 17.5 steps/s
[Step= 100] | Loss=5.18765 | acc=0.1522 | tpr=0.5075 | fpr=0.8544 | 8763.0 samples/s | 34.2 steps/s
[Step= 150] | Loss=5.20527 | acc=0.1515 | tpr=0.4957 | fpr=0.8548 | 8650.4 samples/s | 33.8 steps/s
[Step= 200] | Loss=5.19760 | acc=0.1505 | tpr=0.4885 | fpr=0.8557 | 8936.8 samples/s | 34.9 steps/s
[Step= 250] | Loss=5.19576 | acc=0.1511 | tpr=0.4987 | fpr=0.8552 | 8822.7 samples/s | 34.5 steps/s
[Step= 300] | Loss=5.19766 | acc=0.1515 | tpr=0.5018 | fpr=0.8549 | 9115.3 samples/s | 35.6 steps/s
[Step= 350] | Loss=5.19453 | acc=0.1514 | tpr=0.5009 | fpr=0.8549 | 8311.9 samples/s | 32.5 steps/s
[Step= 400] | Loss=5.19293 | acc=0.1517 | tpr=0.5049 | fpr=0.8548 | 8977.7 samples/s | 35.1 steps/s
[Step= 450] | Loss=5.20153 | acc=0.1514 | tpr=0.5010 | fpr=0.8550 | 8687.9 samples/s | 33.9 steps/s
[Step= 500] | Loss=5.20467 | acc=0.1512 | tpr=0.4982 | fpr=0.8550 | 9080.1 samples/s | 35.5 steps/s
[Step= 550] | Loss=5.20876 | acc=0.1512 | tpr=0.4986 | fpr=0.8551 | 14295.3 samples/s | 55.8 steps/s
Avg test loss: 5.20931, Avg test acc: 0.15113, Avg tpr: 0.49960, Avg fpr: 0.85520, total FA: 118743

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13515 | acc=0.9813 | tpr=0.9336 | fpr=0.0178 | 4468.9 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.14199 | acc=0.9804 | tpr=0.9488 | fpr=0.0190 | 8688.0 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.14738 | acc=0.9792 | tpr=0.9496 | fpr=0.0202 | 9197.5 samples/s | 35.9 steps/s
[Step= 200] | Loss=0.14771 | acc=0.9793 | tpr=0.9508 | fpr=0.0202 | 8445.5 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.14540 | acc=0.9793 | tpr=0.9467 | fpr=0.0201 | 8872.2 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.14821 | acc=0.9791 | tpr=0.9469 | fpr=0.0203 | 8777.1 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.14927 | acc=0.9790 | tpr=0.9487 | fpr=0.0205 | 8725.5 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.14980 | acc=0.9787 | tpr=0.9475 | fpr=0.0208 | 9242.5 samples/s | 36.1 steps/s
[Step= 450] | Loss=0.15325 | acc=0.9782 | tpr=0.9440 | fpr=0.0211 | 8442.4 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.15237 | acc=0.9784 | tpr=0.9458 | fpr=0.0211 | 8915.4 samples/s | 34.8 steps/s
[Step= 550] | Loss=0.15170 | acc=0.9784 | tpr=0.9431 | fpr=0.0210 | 15360.3 samples/s | 60.0 steps/s
Avg test loss: 0.15125, Avg test acc: 0.97837, Avg tpr: 0.94334, Avg fpr: 0.02099, total FA: 2915

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12324 | acc=0.9800 | tpr=0.9381 | fpr=0.0192 | 4449.5 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.12903 | acc=0.9796 | tpr=0.9488 | fpr=0.0198 | 8812.0 samples/s | 34.4 steps/s
[Step= 150] | Loss=0.13407 | acc=0.9785 | tpr=0.9452 | fpr=0.0209 | 8627.5 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.13400 | acc=0.9784 | tpr=0.9464 | fpr=0.0210 | 8833.5 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.13213 | acc=0.9787 | tpr=0.9432 | fpr=0.0207 | 9125.3 samples/s | 35.6 steps/s
[Step= 300] | Loss=0.13351 | acc=0.9786 | tpr=0.9418 | fpr=0.0207 | 8688.1 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.13441 | acc=0.9784 | tpr=0.9449 | fpr=0.0210 | 9400.6 samples/s | 36.7 steps/s
[Step= 400] | Loss=0.13469 | acc=0.9784 | tpr=0.9453 | fpr=0.0210 | 8111.1 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.13749 | acc=0.9782 | tpr=0.9445 | fpr=0.0212 | 8870.3 samples/s | 34.6 steps/s
[Step= 500] | Loss=0.13671 | acc=0.9783 | tpr=0.9458 | fpr=0.0211 | 8673.9 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.13626 | acc=0.9782 | tpr=0.9419 | fpr=0.0211 | 16080.2 samples/s | 62.8 steps/s
Avg test loss: 0.13586, Avg test acc: 0.97824, Avg tpr: 0.94216, Avg fpr: 0.02110, total FA: 2930

server round 32/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=30001 Epoch=58.7] | Loss=0.00591 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.119 | L2-Norm(final)=7.602 | 3900.6 samples/s | 60.9 steps/s
[Step=30050 Epoch=58.7] | Loss=0.00744 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.123 | L2-Norm(final)=7.604 | 5377.3 samples/s | 84.0 steps/s
[Step=30100 Epoch=58.8] | Loss=0.00794 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.126 | L2-Norm(final)=7.608 | 5785.7 samples/s | 90.4 steps/s
[Step=30150 Epoch=58.9] | Loss=0.00858 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.130 | L2-Norm(final)=7.611 | 5484.9 samples/s | 85.7 steps/s
[Step=30200 Epoch=59.0] | Loss=0.00890 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=7.614 | 5674.5 samples/s | 88.7 steps/s
[Step=30250 Epoch=59.1] | Loss=0.00871 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.136 | L2-Norm(final)=7.617 | 5752.0 samples/s | 89.9 steps/s
[Step=30300 Epoch=59.2] | Loss=0.00871 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.140 | L2-Norm(final)=7.621 | 5605.1 samples/s | 87.6 steps/s
[Step=30350 Epoch=59.3] | Loss=0.00854 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=7.625 | 5713.9 samples/s | 89.3 steps/s
[Step=30400 Epoch=59.4] | Loss=0.00832 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.147 | L2-Norm(final)=7.629 | 5651.3 samples/s | 88.3 steps/s
[Step=30450 Epoch=59.5] | Loss=0.00817 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.150 | L2-Norm(final)=7.633 | 5631.2 samples/s | 88.0 steps/s
[Step=30500 Epoch=59.6] | Loss=0.00795 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.153 | L2-Norm(final)=7.637 | 7163.0 samples/s | 111.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=59.6] | Loss=0.00206 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.186 | L2-Norm(final)=7.678 | 4085.4 samples/s | 63.8 steps/s
[Step=30550 Epoch=59.7] | Loss=0.00569 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.191 | L2-Norm(final)=7.683 | 4642.6 samples/s | 72.5 steps/s
[Step=30600 Epoch=59.8] | Loss=0.00686 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.196 | L2-Norm(final)=7.687 | 5002.7 samples/s | 78.2 steps/s
[Step=30650 Epoch=59.9] | Loss=0.00728 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.202 | L2-Norm(final)=7.691 | 5022.0 samples/s | 78.5 steps/s
[Step=30700 Epoch=60.0] | Loss=0.00753 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.207 | L2-Norm(final)=7.694 | 4985.9 samples/s | 77.9 steps/s
[Step=30750 Epoch=60.1] | Loss=0.00753 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=7.697 | 5001.5 samples/s | 78.1 steps/s
[Step=30800 Epoch=60.2] | Loss=0.00740 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.215 | L2-Norm(final)=7.700 | 5107.6 samples/s | 79.8 steps/s
[Step=30850 Epoch=60.3] | Loss=0.00762 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=7.703 | 5010.2 samples/s | 78.3 steps/s
[Step=30900 Epoch=60.4] | Loss=0.00795 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=7.705 | 4984.1 samples/s | 77.9 steps/s
[Step=30950 Epoch=60.5] | Loss=0.00787 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.226 | L2-Norm(final)=7.707 | 5066.0 samples/s | 79.2 steps/s
[Step=31000 Epoch=60.6] | Loss=0.00786 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.230 | L2-Norm(final)=7.709 | 6190.3 samples/s | 96.7 steps/s
[Step=31050 Epoch=60.7] | Loss=0.00756 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.233 | L2-Norm(final)=7.712 | 1930.8 samples/s | 30.2 steps/s
[Step=31100 Epoch=60.8] | Loss=0.00742 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=7.714 | 5010.5 samples/s | 78.3 steps/s
[Step=31150 Epoch=60.9] | Loss=0.00735 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.239 | L2-Norm(final)=7.717 | 5067.5 samples/s | 79.2 steps/s
[Step=31200 Epoch=61.0] | Loss=0.00731 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.242 | L2-Norm(final)=7.719 | 4989.6 samples/s | 78.0 steps/s
[Step=31250 Epoch=61.1] | Loss=0.00728 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.245 | L2-Norm(final)=7.721 | 5064.0 samples/s | 79.1 steps/s
[Step=31300 Epoch=61.2] | Loss=0.00715 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.248 | L2-Norm(final)=7.724 | 5022.8 samples/s | 78.5 steps/s
[Step=31350 Epoch=61.3] | Loss=0.00708 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.251 | L2-Norm(final)=7.726 | 5078.3 samples/s | 79.3 steps/s
[Step=31400 Epoch=61.4] | Loss=0.00697 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.254 | L2-Norm(final)=7.729 | 5011.4 samples/s | 78.3 steps/s
[Step=31450 Epoch=61.5] | Loss=0.00696 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.256 | L2-Norm(final)=7.731 | 4978.2 samples/s | 77.8 steps/s
[Step=31500 Epoch=61.6] | Loss=0.00699 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.259 | L2-Norm(final)=7.733 | 5368.8 samples/s | 83.9 steps/s
[Step=31550 Epoch=61.7] | Loss=0.00687 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.261 | L2-Norm(final)=7.735 | 2009.6 samples/s | 31.4 steps/s
[Step=31600 Epoch=61.8] | Loss=0.00677 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.263 | L2-Norm(final)=7.737 | 5077.2 samples/s | 79.3 steps/s
[Step=31650 Epoch=61.9] | Loss=0.00674 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.266 | L2-Norm(final)=7.739 | 4988.9 samples/s | 78.0 steps/s
[Step=31700 Epoch=62.0] | Loss=0.00666 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.268 | L2-Norm(final)=7.742 | 4998.6 samples/s | 78.1 steps/s
[Step=31750 Epoch=62.1] | Loss=0.00660 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.270 | L2-Norm(final)=7.744 | 5112.9 samples/s | 79.9 steps/s
[Step=31800 Epoch=62.2] | Loss=0.00656 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.272 | L2-Norm(final)=7.746 | 4959.9 samples/s | 77.5 steps/s
[Step=31850 Epoch=62.3] | Loss=0.00645 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.274 | L2-Norm(final)=7.748 | 5064.1 samples/s | 79.1 steps/s
[Step=31900 Epoch=62.4] | Loss=0.00650 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.276 | L2-Norm(final)=7.750 | 5053.2 samples/s | 79.0 steps/s
[Step=31950 Epoch=62.5] | Loss=0.00649 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.278 | L2-Norm(final)=7.752 | 5093.6 samples/s | 79.6 steps/s
[Step=32000 Epoch=62.6] | Loss=0.00646 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.280 | L2-Norm(final)=7.754 | 5020.8 samples/s | 78.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step32000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=34001 Epoch=130.9] | Loss=0.00010 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.119 | L2-Norm(final)=7.762 | 3840.0 samples/s | 60.0 steps/s
[Step=34050 Epoch=131.1] | Loss=0.00025 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.118 | L2-Norm(final)=7.762 | 5035.5 samples/s | 78.7 steps/s
[Step=34100 Epoch=131.3] | Loss=0.00023 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.119 | L2-Norm(final)=7.765 | 5348.8 samples/s | 83.6 steps/s
[Step=34150 Epoch=131.5] | Loss=0.00021 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.120 | L2-Norm(final)=7.767 | 5326.6 samples/s | 83.2 steps/s
[Step=34200 Epoch=131.6] | Loss=0.00020 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.120 | L2-Norm(final)=7.769 | 5309.6 samples/s | 83.0 steps/s
[Step=34250 Epoch=131.8] | Loss=0.00019 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.121 | L2-Norm(final)=7.771 | 7103.0 samples/s | 111.0 steps/s
[Step=34300 Epoch=132.0] | Loss=0.00017 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=7.773 | 1935.3 samples/s | 30.2 steps/s
[Step=34350 Epoch=132.2] | Loss=0.00016 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=7.775 | 5384.1 samples/s | 84.1 steps/s
[Step=34400 Epoch=132.4] | Loss=0.00015 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=7.777 | 5247.1 samples/s | 82.0 steps/s
[Step=34450 Epoch=132.6] | Loss=0.00014 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.121 | L2-Norm(final)=7.778 | 5348.5 samples/s | 83.6 steps/s
[Step=34500 Epoch=132.8] | Loss=0.00013 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.120 | L2-Norm(final)=7.780 | 6157.2 samples/s | 96.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=132.8] | Loss=0.00005 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.113 | L2-Norm(final)=7.798 | 4004.8 samples/s | 62.6 steps/s
[Step=34550 Epoch=133.0] | Loss=0.00005 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.111 | L2-Norm(final)=7.800 | 4299.0 samples/s | 67.2 steps/s
[Step=34600 Epoch=133.2] | Loss=0.00004 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.108 | L2-Norm(final)=7.801 | 4770.6 samples/s | 74.5 steps/s
[Step=34650 Epoch=133.4] | Loss=0.00005 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.105 | L2-Norm(final)=7.803 | 4780.9 samples/s | 74.7 steps/s
[Step=34700 Epoch=133.6] | Loss=0.00004 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.103 | L2-Norm(final)=7.805 | 4817.5 samples/s | 75.3 steps/s
[Step=34750 Epoch=133.8] | Loss=0.00004 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.100 | L2-Norm(final)=7.806 | 5995.2 samples/s | 93.7 steps/s
[Step=34800 Epoch=134.0] | Loss=0.00004 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.096 | L2-Norm(final)=7.808 | 1853.5 samples/s | 29.0 steps/s
[Step=34850 Epoch=134.2] | Loss=0.00003 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.093 | L2-Norm(final)=7.809 | 4863.9 samples/s | 76.0 steps/s
[Step=34900 Epoch=134.3] | Loss=0.00003 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.090 | L2-Norm(final)=7.810 | 4691.0 samples/s | 73.3 steps/s
[Step=34950 Epoch=134.5] | Loss=0.00003 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.086 | L2-Norm(final)=7.811 | 4754.9 samples/s | 74.3 steps/s
[Step=35000 Epoch=134.7] | Loss=0.00003 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.082 | L2-Norm(final)=7.812 | 5436.1 samples/s | 84.9 steps/s
[Step=35050 Epoch=134.9] | Loss=0.00003 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.078 | L2-Norm(final)=7.813 | 1923.7 samples/s | 30.1 steps/s
[Step=35100 Epoch=135.1] | Loss=0.00002 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.075 | L2-Norm(final)=7.814 | 4774.1 samples/s | 74.6 steps/s
[Step=35150 Epoch=135.3] | Loss=0.00002 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.071 | L2-Norm(final)=7.815 | 4926.2 samples/s | 77.0 steps/s
[Step=35200 Epoch=135.5] | Loss=0.00002 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.067 | L2-Norm(final)=7.816 | 4669.9 samples/s | 73.0 steps/s
[Step=35250 Epoch=135.7] | Loss=0.00002 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.062 | L2-Norm(final)=7.817 | 4891.3 samples/s | 76.4 steps/s
[Step=35300 Epoch=135.9] | Loss=0.00002 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.058 | L2-Norm(final)=7.818 | 2027.6 samples/s | 31.7 steps/s
[Step=35350 Epoch=136.1] | Loss=0.00002 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.054 | L2-Norm(final)=7.819 | 4889.8 samples/s | 76.4 steps/s
[Step=35400 Epoch=136.3] | Loss=0.00002 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.050 | L2-Norm(final)=7.820 | 4662.4 samples/s | 72.9 steps/s
[Step=35450 Epoch=136.5] | Loss=0.00002 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.045 | L2-Norm(final)=7.820 | 4838.1 samples/s | 75.6 steps/s
[Step=35500 Epoch=136.7] | Loss=0.00002 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.041 | L2-Norm(final)=7.821 | 4777.5 samples/s | 74.6 steps/s
[Step=35550 Epoch=136.8] | Loss=0.00002 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.036 | L2-Norm(final)=7.822 | 2013.4 samples/s | 31.5 steps/s
[Step=35600 Epoch=137.0] | Loss=0.00002 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.031 | L2-Norm(final)=7.823 | 4881.5 samples/s | 76.3 steps/s
[Step=35650 Epoch=137.2] | Loss=0.00002 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.027 | L2-Norm(final)=7.824 | 4826.0 samples/s | 75.4 steps/s
[Step=35700 Epoch=137.4] | Loss=0.00002 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.022 | L2-Norm(final)=7.824 | 4765.5 samples/s | 74.5 steps/s
[Step=35750 Epoch=137.6] | Loss=0.00002 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.017 | L2-Norm(final)=7.825 | 4778.5 samples/s | 74.7 steps/s
[Step=35800 Epoch=137.8] | Loss=0.00002 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.012 | L2-Norm(final)=7.826 | 7021.7 samples/s | 109.7 steps/s
[Step=35850 Epoch=138.0] | Loss=0.00002 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.007 | L2-Norm(final)=7.826 | 1795.8 samples/s | 28.1 steps/s
[Step=35900 Epoch=138.2] | Loss=0.00002 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.002 | L2-Norm(final)=7.827 | 4764.9 samples/s | 74.5 steps/s
[Step=35950 Epoch=138.4] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.997 | L2-Norm(final)=7.828 | 4807.5 samples/s | 75.1 steps/s
[Step=36000 Epoch=138.6] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.992 | L2-Norm(final)=7.829 | 4730.9 samples/s | 73.9 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06076 | acc=0.9695 | tpr=0.9772 | fpr=0.0471 | 4434.5 samples/s | 17.3 steps/s
Avg test loss: 0.06373, Avg test acc: 0.96919, Avg tpr: 0.97651, Avg fpr: 0.04692, total FA: 366

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06204 | acc=0.9701 | tpr=0.9756 | fpr=0.0419 | 4618.8 samples/s | 18.0 steps/s
Avg test loss: 0.06801, Avg test acc: 0.96899, Avg tpr: 0.97488, Avg fpr: 0.04397, total FA: 343

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.30725 | acc=0.3178 | tpr=0.0430 | fpr=0.0855 | 4482.2 samples/s | 17.5 steps/s
Avg test loss: 5.30671, Avg test acc: 0.31657, Avg tpr: 0.04430, Avg fpr: 0.08460, total FA: 660

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.15258 | acc=0.3143 | tpr=0.0479 | fpr=0.1073 | 4474.5 samples/s | 17.5 steps/s
Avg test loss: 5.14603, Avg test acc: 0.31373, Avg tpr: 0.04960, Avg fpr: 0.10537, total FA: 822

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.79678 | acc=0.1192 | tpr=0.5796 | fpr=0.8891 | 4485.8 samples/s | 17.5 steps/s
[Step= 100] | Loss=5.77618 | acc=0.1196 | tpr=0.5714 | fpr=0.8888 | 8580.0 samples/s | 33.5 steps/s
[Step= 150] | Loss=5.78852 | acc=0.1193 | tpr=0.5677 | fpr=0.8890 | 9327.1 samples/s | 36.4 steps/s
[Step= 200] | Loss=5.78029 | acc=0.1186 | tpr=0.5639 | fpr=0.8895 | 8603.4 samples/s | 33.6 steps/s
[Step= 250] | Loss=5.78180 | acc=0.1190 | tpr=0.5764 | fpr=0.8893 | 8681.0 samples/s | 33.9 steps/s
[Step= 300] | Loss=5.78111 | acc=0.1192 | tpr=0.5840 | fpr=0.8893 | 8956.4 samples/s | 35.0 steps/s
[Step= 350] | Loss=5.77889 | acc=0.1190 | tpr=0.5867 | fpr=0.8895 | 8826.3 samples/s | 34.5 steps/s
[Step= 400] | Loss=5.77804 | acc=0.1190 | tpr=0.5886 | fpr=0.8896 | 8617.7 samples/s | 33.7 steps/s
[Step= 450] | Loss=5.78727 | acc=0.1186 | tpr=0.5837 | fpr=0.8898 | 9065.0 samples/s | 35.4 steps/s
[Step= 500] | Loss=5.79121 | acc=0.1187 | tpr=0.5872 | fpr=0.8898 | 8553.3 samples/s | 33.4 steps/s
[Step= 550] | Loss=5.79545 | acc=0.1189 | tpr=0.5877 | fpr=0.8896 | 16392.7 samples/s | 64.0 steps/s
Avg test loss: 5.79626, Avg test acc: 0.11884, Avg tpr: 0.58835, Avg fpr: 0.88970, total FA: 123533

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.88384 | acc=0.1289 | tpr=0.6593 | fpr=0.8806 | 4449.4 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.86401 | acc=0.1282 | tpr=0.6269 | fpr=0.8811 | 8756.3 samples/s | 34.2 steps/s
[Step= 150] | Loss=5.88197 | acc=0.1273 | tpr=0.6225 | fpr=0.8818 | 8863.1 samples/s | 34.6 steps/s
[Step= 200] | Loss=5.87659 | acc=0.1257 | tpr=0.6131 | fpr=0.8832 | 8841.3 samples/s | 34.5 steps/s
[Step= 250] | Loss=5.87803 | acc=0.1260 | tpr=0.6140 | fpr=0.8829 | 9219.1 samples/s | 36.0 steps/s
[Step= 300] | Loss=5.87920 | acc=0.1262 | tpr=0.6182 | fpr=0.8828 | 8473.0 samples/s | 33.1 steps/s
[Step= 350] | Loss=5.87431 | acc=0.1260 | tpr=0.6155 | fpr=0.8829 | 8888.3 samples/s | 34.7 steps/s
[Step= 400] | Loss=5.87327 | acc=0.1261 | tpr=0.6209 | fpr=0.8829 | 8973.0 samples/s | 35.1 steps/s
[Step= 450] | Loss=5.88307 | acc=0.1256 | tpr=0.6134 | fpr=0.8833 | 8985.3 samples/s | 35.1 steps/s
[Step= 500] | Loss=5.88614 | acc=0.1256 | tpr=0.6181 | fpr=0.8832 | 8731.4 samples/s | 34.1 steps/s
[Step= 550] | Loss=5.89083 | acc=0.1256 | tpr=0.6144 | fpr=0.8832 | 14607.6 samples/s | 57.1 steps/s
Avg test loss: 5.89173, Avg test acc: 0.12557, Avg tpr: 0.61529, Avg fpr: 0.88333, total FA: 122649

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13515 | acc=0.9813 | tpr=0.9336 | fpr=0.0178 | 4532.9 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.14199 | acc=0.9804 | tpr=0.9488 | fpr=0.0190 | 8316.0 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.14738 | acc=0.9792 | tpr=0.9496 | fpr=0.0202 | 9098.0 samples/s | 35.5 steps/s
[Step= 200] | Loss=0.14771 | acc=0.9793 | tpr=0.9508 | fpr=0.0202 | 8641.5 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.14540 | acc=0.9793 | tpr=0.9467 | fpr=0.0201 | 8849.0 samples/s | 34.6 steps/s
[Step= 300] | Loss=0.14821 | acc=0.9791 | tpr=0.9469 | fpr=0.0203 | 8895.2 samples/s | 34.7 steps/s
[Step= 350] | Loss=0.14927 | acc=0.9790 | tpr=0.9487 | fpr=0.0205 | 9177.9 samples/s | 35.9 steps/s
[Step= 400] | Loss=0.14980 | acc=0.9787 | tpr=0.9475 | fpr=0.0208 | 8501.4 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.15325 | acc=0.9782 | tpr=0.9440 | fpr=0.0211 | 8681.8 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.15237 | acc=0.9784 | tpr=0.9458 | fpr=0.0211 | 8716.8 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.15170 | acc=0.9784 | tpr=0.9431 | fpr=0.0210 | 16001.9 samples/s | 62.5 steps/s
Avg test loss: 0.15125, Avg test acc: 0.97837, Avg tpr: 0.94334, Avg fpr: 0.02099, total FA: 2915

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12960 | acc=0.9796 | tpr=0.9336 | fpr=0.0196 | 4479.7 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.13646 | acc=0.9789 | tpr=0.9510 | fpr=0.0206 | 8870.6 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.14122 | acc=0.9776 | tpr=0.9510 | fpr=0.0219 | 8830.3 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.14127 | acc=0.9776 | tpr=0.9508 | fpr=0.0219 | 8640.6 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.13947 | acc=0.9776 | tpr=0.9467 | fpr=0.0218 | 8885.9 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.14199 | acc=0.9773 | tpr=0.9462 | fpr=0.0221 | 8652.4 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.14292 | acc=0.9772 | tpr=0.9493 | fpr=0.0223 | 8920.6 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.14352 | acc=0.9771 | tpr=0.9491 | fpr=0.0224 | 8924.0 samples/s | 34.9 steps/s
[Step= 450] | Loss=0.14678 | acc=0.9767 | tpr=0.9474 | fpr=0.0228 | 8713.1 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.14615 | acc=0.9767 | tpr=0.9493 | fpr=0.0228 | 8935.5 samples/s | 34.9 steps/s
[Step= 550] | Loss=0.14566 | acc=0.9767 | tpr=0.9479 | fpr=0.0228 | 15731.1 samples/s | 61.4 steps/s
Avg test loss: 0.14521, Avg test acc: 0.97669, Avg tpr: 0.94810, Avg fpr: 0.02279, total FA: 3165

server round 33/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=32001 Epoch=62.6] | Loss=0.01182 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.947 | L2-Norm(final)=7.814 | 3876.0 samples/s | 60.6 steps/s
[Step=32050 Epoch=62.7] | Loss=0.00943 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.951 | L2-Norm(final)=7.818 | 5402.7 samples/s | 84.4 steps/s
[Step=32100 Epoch=62.8] | Loss=0.00868 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.956 | L2-Norm(final)=7.820 | 5623.8 samples/s | 87.9 steps/s
[Step=32150 Epoch=62.9] | Loss=0.00907 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.960 | L2-Norm(final)=7.823 | 5680.1 samples/s | 88.8 steps/s
[Step=32200 Epoch=63.0] | Loss=0.00842 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.964 | L2-Norm(final)=7.826 | 5592.5 samples/s | 87.4 steps/s
[Step=32250 Epoch=63.0] | Loss=0.00805 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.967 | L2-Norm(final)=7.829 | 5755.2 samples/s | 89.9 steps/s
[Step=32300 Epoch=63.1] | Loss=0.00800 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.971 | L2-Norm(final)=7.833 | 5647.9 samples/s | 88.2 steps/s
[Step=32350 Epoch=63.2] | Loss=0.00782 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.974 | L2-Norm(final)=7.836 | 5713.0 samples/s | 89.3 steps/s
[Step=32400 Epoch=63.3] | Loss=0.00773 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.977 | L2-Norm(final)=7.839 | 5708.7 samples/s | 89.2 steps/s
[Step=32450 Epoch=63.4] | Loss=0.00766 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.981 | L2-Norm(final)=7.843 | 5716.2 samples/s | 89.3 steps/s
[Step=32500 Epoch=63.5] | Loss=0.00744 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.984 | L2-Norm(final)=7.846 | 7110.5 samples/s | 111.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=63.5] | Loss=0.00033 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.019 | L2-Norm(final)=7.886 | 3839.3 samples/s | 60.0 steps/s
[Step=32550 Epoch=63.6] | Loss=0.00675 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.023 | L2-Norm(final)=7.891 | 4927.0 samples/s | 77.0 steps/s
[Step=32600 Epoch=63.7] | Loss=0.00774 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.030 | L2-Norm(final)=7.894 | 4976.4 samples/s | 77.8 steps/s
[Step=32650 Epoch=63.8] | Loss=0.00828 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.035 | L2-Norm(final)=7.897 | 5011.1 samples/s | 78.3 steps/s
[Step=32700 Epoch=63.9] | Loss=0.00850 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.040 | L2-Norm(final)=7.899 | 5066.3 samples/s | 79.2 steps/s
[Step=32750 Epoch=64.0] | Loss=0.00860 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.045 | L2-Norm(final)=7.901 | 4991.1 samples/s | 78.0 steps/s
[Step=32800 Epoch=64.1] | Loss=0.00853 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.050 | L2-Norm(final)=7.903 | 5053.9 samples/s | 79.0 steps/s
[Step=32850 Epoch=64.2] | Loss=0.00866 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.055 | L2-Norm(final)=7.906 | 5067.8 samples/s | 79.2 steps/s
[Step=32900 Epoch=64.3] | Loss=0.00847 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.059 | L2-Norm(final)=7.908 | 5089.9 samples/s | 79.5 steps/s
[Step=32950 Epoch=64.4] | Loss=0.00871 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.062 | L2-Norm(final)=7.910 | 5008.6 samples/s | 78.3 steps/s
[Step=33000 Epoch=64.5] | Loss=0.00871 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.066 | L2-Norm(final)=7.912 | 6265.0 samples/s | 97.9 steps/s
[Step=33050 Epoch=64.6] | Loss=0.00859 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=7.914 | 1929.0 samples/s | 30.1 steps/s
[Step=33100 Epoch=64.7] | Loss=0.00851 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=7.916 | 5019.3 samples/s | 78.4 steps/s
[Step=33150 Epoch=64.8] | Loss=0.00828 | Reg=0.00146 | acc=0.9688 | L2-Norm=12.077 | L2-Norm(final)=7.919 | 5044.3 samples/s | 78.8 steps/s
[Step=33200 Epoch=64.9] | Loss=0.00816 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.080 | L2-Norm(final)=7.921 | 5041.3 samples/s | 78.8 steps/s
[Step=33250 Epoch=65.0] | Loss=0.00800 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.084 | L2-Norm(final)=7.924 | 5039.6 samples/s | 78.7 steps/s
[Step=33300 Epoch=65.1] | Loss=0.00787 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.087 | L2-Norm(final)=7.926 | 5105.0 samples/s | 79.8 steps/s
[Step=33350 Epoch=65.2] | Loss=0.00770 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.090 | L2-Norm(final)=7.929 | 5033.1 samples/s | 78.6 steps/s
[Step=33400 Epoch=65.3] | Loss=0.00767 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.093 | L2-Norm(final)=7.931 | 5136.2 samples/s | 80.3 steps/s
[Step=33450 Epoch=65.4] | Loss=0.00760 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.095 | L2-Norm(final)=7.933 | 5034.0 samples/s | 78.7 steps/s
[Step=33500 Epoch=65.5] | Loss=0.00757 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.098 | L2-Norm(final)=7.935 | 5420.9 samples/s | 84.7 steps/s
[Step=33550 Epoch=65.6] | Loss=0.00749 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.100 | L2-Norm(final)=7.937 | 2026.8 samples/s | 31.7 steps/s
[Step=33600 Epoch=65.7] | Loss=0.00734 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.103 | L2-Norm(final)=7.939 | 4971.7 samples/s | 77.7 steps/s
[Step=33650 Epoch=65.8] | Loss=0.00726 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.105 | L2-Norm(final)=7.941 | 5080.8 samples/s | 79.4 steps/s
[Step=33700 Epoch=65.9] | Loss=0.00715 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.108 | L2-Norm(final)=7.943 | 4908.0 samples/s | 76.7 steps/s
[Step=33750 Epoch=66.0] | Loss=0.00706 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.110 | L2-Norm(final)=7.945 | 5017.8 samples/s | 78.4 steps/s
[Step=33800 Epoch=66.1] | Loss=0.00704 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.112 | L2-Norm(final)=7.947 | 5110.0 samples/s | 79.8 steps/s
[Step=33850 Epoch=66.2] | Loss=0.00703 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.115 | L2-Norm(final)=7.949 | 4992.0 samples/s | 78.0 steps/s
[Step=33900 Epoch=66.3] | Loss=0.00694 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.117 | L2-Norm(final)=7.951 | 5055.2 samples/s | 79.0 steps/s
[Step=33950 Epoch=66.4] | Loss=0.00690 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.119 | L2-Norm(final)=7.953 | 5059.0 samples/s | 79.0 steps/s
[Step=34000 Epoch=66.5] | Loss=0.00691 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.121 | L2-Norm(final)=7.955 | 5088.3 samples/s | 79.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step34000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=36001 Epoch=138.6] | Loss=0.00046 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.947 | L2-Norm(final)=7.851 | 3723.9 samples/s | 58.2 steps/s
[Step=36050 Epoch=138.8] | Loss=0.00034 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.949 | L2-Norm(final)=7.855 | 5312.3 samples/s | 83.0 steps/s
[Step=36100 Epoch=139.0] | Loss=0.00031 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.958 | L2-Norm(final)=7.858 | 5266.2 samples/s | 82.3 steps/s
[Step=36150 Epoch=139.2] | Loss=0.00025 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.963 | L2-Norm(final)=7.861 | 5270.5 samples/s | 82.4 steps/s
[Step=36200 Epoch=139.3] | Loss=0.00021 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.965 | L2-Norm(final)=7.864 | 5334.1 samples/s | 83.3 steps/s
[Step=36250 Epoch=139.5] | Loss=0.00018 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.965 | L2-Norm(final)=7.867 | 7066.0 samples/s | 110.4 steps/s
[Step=36300 Epoch=139.7] | Loss=0.00016 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.964 | L2-Norm(final)=7.870 | 1920.9 samples/s | 30.0 steps/s
[Step=36350 Epoch=139.9] | Loss=0.00015 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.963 | L2-Norm(final)=7.873 | 5282.9 samples/s | 82.5 steps/s
[Step=36400 Epoch=140.1] | Loss=0.00014 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.961 | L2-Norm(final)=7.875 | 5327.0 samples/s | 83.2 steps/s
[Step=36450 Epoch=140.3] | Loss=0.00013 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.959 | L2-Norm(final)=7.878 | 5426.2 samples/s | 84.8 steps/s
[Step=36500 Epoch=140.5] | Loss=0.00012 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.957 | L2-Norm(final)=7.880 | 6077.7 samples/s | 95.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=140.5] | Loss=0.00010 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.935 | L2-Norm(final)=7.903 | 3971.3 samples/s | 62.1 steps/s
[Step=36550 Epoch=140.7] | Loss=0.00003 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.930 | L2-Norm(final)=7.904 | 4441.0 samples/s | 69.4 steps/s
[Step=36600 Epoch=140.9] | Loss=0.00003 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.924 | L2-Norm(final)=7.906 | 4825.4 samples/s | 75.4 steps/s
[Step=36650 Epoch=141.1] | Loss=0.00003 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.918 | L2-Norm(final)=7.907 | 4771.5 samples/s | 74.6 steps/s
[Step=36700 Epoch=141.3] | Loss=0.00003 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.912 | L2-Norm(final)=7.909 | 4870.4 samples/s | 76.1 steps/s
[Step=36750 Epoch=141.5] | Loss=0.00002 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.905 | L2-Norm(final)=7.910 | 6034.0 samples/s | 94.3 steps/s
[Step=36800 Epoch=141.7] | Loss=0.00002 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=7.911 | 1866.7 samples/s | 29.2 steps/s
[Step=36850 Epoch=141.9] | Loss=0.00002 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.891 | L2-Norm(final)=7.912 | 4749.2 samples/s | 74.2 steps/s
[Step=36900 Epoch=142.0] | Loss=0.00002 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.884 | L2-Norm(final)=7.913 | 4785.4 samples/s | 74.8 steps/s
[Step=36950 Epoch=142.2] | Loss=0.00002 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.876 | L2-Norm(final)=7.914 | 4756.6 samples/s | 74.3 steps/s
[Step=37000 Epoch=142.4] | Loss=0.00002 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.869 | L2-Norm(final)=7.914 | 5418.8 samples/s | 84.7 steps/s
[Step=37050 Epoch=142.6] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.861 | L2-Norm(final)=7.915 | 1946.8 samples/s | 30.4 steps/s
[Step=37100 Epoch=142.8] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.853 | L2-Norm(final)=7.916 | 4851.6 samples/s | 75.8 steps/s
[Step=37150 Epoch=143.0] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.845 | L2-Norm(final)=7.916 | 4704.2 samples/s | 73.5 steps/s
[Step=37200 Epoch=143.2] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.837 | L2-Norm(final)=7.917 | 4788.2 samples/s | 74.8 steps/s
[Step=37250 Epoch=143.4] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.829 | L2-Norm(final)=7.918 | 4895.1 samples/s | 76.5 steps/s
[Step=37300 Epoch=143.6] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.821 | L2-Norm(final)=7.918 | 2014.1 samples/s | 31.5 steps/s
[Step=37350 Epoch=143.8] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.812 | L2-Norm(final)=7.919 | 4844.1 samples/s | 75.7 steps/s
[Step=37400 Epoch=144.0] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.804 | L2-Norm(final)=7.919 | 4828.6 samples/s | 75.4 steps/s
[Step=37450 Epoch=144.2] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.795 | L2-Norm(final)=7.920 | 4771.8 samples/s | 74.6 steps/s
[Step=37500 Epoch=144.4] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.786 | L2-Norm(final)=7.921 | 4744.6 samples/s | 74.1 steps/s
[Step=37550 Epoch=144.5] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.778 | L2-Norm(final)=7.921 | 2042.6 samples/s | 31.9 steps/s
[Step=37600 Epoch=144.7] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.769 | L2-Norm(final)=7.922 | 4734.1 samples/s | 74.0 steps/s
[Step=37650 Epoch=144.9] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.760 | L2-Norm(final)=7.922 | 4756.2 samples/s | 74.3 steps/s
[Step=37700 Epoch=145.1] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.750 | L2-Norm(final)=7.923 | 4795.6 samples/s | 74.9 steps/s
[Step=37750 Epoch=145.3] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.741 | L2-Norm(final)=7.923 | 4758.7 samples/s | 74.4 steps/s
[Step=37800 Epoch=145.5] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.732 | L2-Norm(final)=7.924 | 7007.1 samples/s | 109.5 steps/s
[Step=37850 Epoch=145.7] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.722 | L2-Norm(final)=7.925 | 1793.0 samples/s | 28.0 steps/s
[Step=37900 Epoch=145.9] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.713 | L2-Norm(final)=7.925 | 4801.8 samples/s | 75.0 steps/s
[Step=37950 Epoch=146.1] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.703 | L2-Norm(final)=7.926 | 4758.6 samples/s | 74.4 steps/s
[Step=38000 Epoch=146.3] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.693 | L2-Norm(final)=7.926 | 4812.6 samples/s | 75.2 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step38000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06076 | acc=0.9695 | tpr=0.9772 | fpr=0.0471 | 4458.2 samples/s | 17.4 steps/s
Avg test loss: 0.06373, Avg test acc: 0.96919, Avg tpr: 0.97651, Avg fpr: 0.04692, total FA: 366

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06429 | acc=0.9718 | tpr=0.9821 | fpr=0.0505 | 4490.4 samples/s | 17.5 steps/s
Avg test loss: 0.07058, Avg test acc: 0.97035, Avg tpr: 0.98129, Avg fpr: 0.05371, total FA: 419

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.30725 | acc=0.3178 | tpr=0.0430 | fpr=0.0855 | 4478.3 samples/s | 17.5 steps/s
Avg test loss: 5.30671, Avg test acc: 0.31657, Avg tpr: 0.04430, Avg fpr: 0.08460, total FA: 660

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.35234 | acc=0.3127 | tpr=0.0477 | fpr=0.1120 | 4444.8 samples/s | 17.4 steps/s
Avg test loss: 5.34505, Avg test acc: 0.31200, Avg tpr: 0.04902, Avg fpr: 0.10960, total FA: 855

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.79678 | acc=0.1192 | tpr=0.5796 | fpr=0.8891 | 4415.8 samples/s | 17.2 steps/s
[Step= 100] | Loss=5.77618 | acc=0.1196 | tpr=0.5714 | fpr=0.8888 | 8885.0 samples/s | 34.7 steps/s
[Step= 150] | Loss=5.78852 | acc=0.1193 | tpr=0.5677 | fpr=0.8890 | 8747.5 samples/s | 34.2 steps/s
[Step= 200] | Loss=5.78029 | acc=0.1186 | tpr=0.5639 | fpr=0.8895 | 8860.9 samples/s | 34.6 steps/s
[Step= 250] | Loss=5.78180 | acc=0.1190 | tpr=0.5764 | fpr=0.8893 | 8849.5 samples/s | 34.6 steps/s
[Step= 300] | Loss=5.78111 | acc=0.1192 | tpr=0.5840 | fpr=0.8893 | 8663.2 samples/s | 33.8 steps/s
[Step= 350] | Loss=5.77889 | acc=0.1190 | tpr=0.5867 | fpr=0.8895 | 8812.9 samples/s | 34.4 steps/s
[Step= 400] | Loss=5.77804 | acc=0.1190 | tpr=0.5886 | fpr=0.8896 | 8753.1 samples/s | 34.2 steps/s
[Step= 450] | Loss=5.78727 | acc=0.1186 | tpr=0.5837 | fpr=0.8898 | 9191.1 samples/s | 35.9 steps/s
[Step= 500] | Loss=5.79121 | acc=0.1187 | tpr=0.5872 | fpr=0.8898 | 8397.1 samples/s | 32.8 steps/s
[Step= 550] | Loss=5.79545 | acc=0.1189 | tpr=0.5877 | fpr=0.8896 | 15742.9 samples/s | 61.5 steps/s
Avg test loss: 5.79626, Avg test acc: 0.11884, Avg tpr: 0.58835, Avg fpr: 0.88970, total FA: 123533

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.79180 | acc=0.1101 | tpr=0.6637 | fpr=0.8999 | 4461.8 samples/s | 17.4 steps/s
[Step= 100] | Loss=6.76456 | acc=0.1107 | tpr=0.6610 | fpr=0.8996 | 8613.3 samples/s | 33.6 steps/s
[Step= 150] | Loss=6.78288 | acc=0.1102 | tpr=0.6614 | fpr=0.8999 | 8904.7 samples/s | 34.8 steps/s
[Step= 200] | Loss=6.77713 | acc=0.1092 | tpr=0.6525 | fpr=0.9007 | 8713.8 samples/s | 34.0 steps/s
[Step= 250] | Loss=6.77893 | acc=0.1095 | tpr=0.6568 | fpr=0.9005 | 8963.0 samples/s | 35.0 steps/s
[Step= 300] | Loss=6.77876 | acc=0.1099 | tpr=0.6589 | fpr=0.9001 | 8622.1 samples/s | 33.7 steps/s
[Step= 350] | Loss=6.77514 | acc=0.1095 | tpr=0.6512 | fpr=0.9003 | 8905.7 samples/s | 34.8 steps/s
[Step= 400] | Loss=6.77397 | acc=0.1096 | tpr=0.6565 | fpr=0.9003 | 8810.8 samples/s | 34.4 steps/s
[Step= 450] | Loss=6.78387 | acc=0.1092 | tpr=0.6529 | fpr=0.9007 | 8620.3 samples/s | 33.7 steps/s
[Step= 500] | Loss=6.78727 | acc=0.1092 | tpr=0.6551 | fpr=0.9006 | 9387.3 samples/s | 36.7 steps/s
[Step= 550] | Loss=6.79140 | acc=0.1092 | tpr=0.6518 | fpr=0.9006 | 14149.8 samples/s | 55.3 steps/s
Avg test loss: 6.79236, Avg test acc: 0.10914, Avg tpr: 0.65293, Avg fpr: 0.90074, total FA: 125066

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.13515 | acc=0.9813 | tpr=0.9336 | fpr=0.0178 | 4469.2 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.14199 | acc=0.9804 | tpr=0.9488 | fpr=0.0190 | 8759.5 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.14738 | acc=0.9792 | tpr=0.9496 | fpr=0.0202 | 8717.9 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.14771 | acc=0.9793 | tpr=0.9508 | fpr=0.0202 | 8929.1 samples/s | 34.9 steps/s
[Step= 250] | Loss=0.14540 | acc=0.9793 | tpr=0.9467 | fpr=0.0201 | 8817.9 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.14821 | acc=0.9791 | tpr=0.9469 | fpr=0.0203 | 8986.5 samples/s | 35.1 steps/s
[Step= 350] | Loss=0.14927 | acc=0.9790 | tpr=0.9487 | fpr=0.0205 | 8718.0 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.14980 | acc=0.9787 | tpr=0.9475 | fpr=0.0208 | 8859.1 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.15325 | acc=0.9782 | tpr=0.9440 | fpr=0.0211 | 8615.4 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.15237 | acc=0.9784 | tpr=0.9458 | fpr=0.0211 | 9030.1 samples/s | 35.3 steps/s
[Step= 550] | Loss=0.15170 | acc=0.9784 | tpr=0.9431 | fpr=0.0210 | 15384.8 samples/s | 60.1 steps/s
Avg test loss: 0.15125, Avg test acc: 0.97837, Avg tpr: 0.94334, Avg fpr: 0.02099, total FA: 2915

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13850 | acc=0.9788 | tpr=0.9381 | fpr=0.0205 | 4427.2 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.14542 | acc=0.9783 | tpr=0.9574 | fpr=0.0213 | 8804.4 samples/s | 34.4 steps/s
[Step= 150] | Loss=0.15030 | acc=0.9769 | tpr=0.9568 | fpr=0.0227 | 8869.9 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.15055 | acc=0.9771 | tpr=0.9563 | fpr=0.0226 | 8693.1 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.14842 | acc=0.9771 | tpr=0.9520 | fpr=0.0225 | 8650.0 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.15114 | acc=0.9768 | tpr=0.9505 | fpr=0.0227 | 8903.5 samples/s | 34.8 steps/s
[Step= 350] | Loss=0.15220 | acc=0.9767 | tpr=0.9530 | fpr=0.0229 | 9097.4 samples/s | 35.5 steps/s
[Step= 400] | Loss=0.15290 | acc=0.9765 | tpr=0.9530 | fpr=0.0230 | 8517.8 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.15635 | acc=0.9762 | tpr=0.9508 | fpr=0.0233 | 8622.4 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.15577 | acc=0.9762 | tpr=0.9529 | fpr=0.0234 | 9246.3 samples/s | 36.1 steps/s
[Step= 550] | Loss=0.15521 | acc=0.9762 | tpr=0.9511 | fpr=0.0233 | 15173.3 samples/s | 59.3 steps/s
Avg test loss: 0.15475, Avg test acc: 0.97625, Avg tpr: 0.95127, Avg fpr: 0.02330, total FA: 3235

server round 34/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=26001 Epoch=50.7] | Loss=0.02189 | Reg=0.00139 | acc=0.9688 | L2-Norm=11.795 | L2-Norm(final)=7.241 | 3635.1 samples/s | 56.8 steps/s
[Step=26050 Epoch=50.8] | Loss=0.01005 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.799 | L2-Norm(final)=7.244 | 5293.6 samples/s | 82.7 steps/s
[Step=26100 Epoch=50.9] | Loss=0.00887 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.804 | L2-Norm(final)=7.248 | 5655.3 samples/s | 88.4 steps/s
[Step=26150 Epoch=51.0] | Loss=0.00924 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.808 | L2-Norm(final)=7.251 | 5730.9 samples/s | 89.5 steps/s
[Step=26200 Epoch=51.1] | Loss=0.00895 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.813 | L2-Norm(final)=7.255 | 5562.1 samples/s | 86.9 steps/s
[Step=26250 Epoch=51.2] | Loss=0.00908 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.818 | L2-Norm(final)=7.259 | 5676.5 samples/s | 88.7 steps/s
[Step=26300 Epoch=51.3] | Loss=0.00866 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.822 | L2-Norm(final)=7.264 | 5660.8 samples/s | 88.4 steps/s
[Step=26350 Epoch=51.4] | Loss=0.00863 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.826 | L2-Norm(final)=7.268 | 5643.4 samples/s | 88.2 steps/s
[Step=26400 Epoch=51.5] | Loss=0.00874 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.830 | L2-Norm(final)=7.273 | 5723.3 samples/s | 89.4 steps/s
[Step=26450 Epoch=51.6] | Loss=0.00852 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.834 | L2-Norm(final)=7.277 | 5659.7 samples/s | 88.4 steps/s
[Step=26500 Epoch=51.7] | Loss=0.00845 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.837 | L2-Norm(final)=7.282 | 7107.8 samples/s | 111.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=26501 Epoch=51.7] | Loss=0.00382 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.874 | L2-Norm(final)=7.329 | 3998.4 samples/s | 62.5 steps/s
[Step=26550 Epoch=51.8] | Loss=0.00675 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.879 | L2-Norm(final)=7.336 | 4462.5 samples/s | 69.7 steps/s
[Step=26600 Epoch=51.9] | Loss=0.00906 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.886 | L2-Norm(final)=7.338 | 5031.2 samples/s | 78.6 steps/s
[Step=26650 Epoch=52.0] | Loss=0.00875 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.891 | L2-Norm(final)=7.341 | 4971.6 samples/s | 77.7 steps/s
[Step=26700 Epoch=52.1] | Loss=0.00898 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.896 | L2-Norm(final)=7.344 | 5022.0 samples/s | 78.5 steps/s
[Step=26750 Epoch=52.2] | Loss=0.00910 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.901 | L2-Norm(final)=7.347 | 5109.5 samples/s | 79.8 steps/s
[Step=26800 Epoch=52.3] | Loss=0.00930 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.906 | L2-Norm(final)=7.350 | 5088.8 samples/s | 79.5 steps/s
[Step=26850 Epoch=52.4] | Loss=0.00909 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.911 | L2-Norm(final)=7.353 | 5009.2 samples/s | 78.3 steps/s
[Step=26900 Epoch=52.5] | Loss=0.00921 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.915 | L2-Norm(final)=7.356 | 5027.4 samples/s | 78.6 steps/s
[Step=26950 Epoch=52.6] | Loss=0.00927 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.920 | L2-Norm(final)=7.358 | 5145.3 samples/s | 80.4 steps/s
[Step=27000 Epoch=52.7] | Loss=0.00922 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.924 | L2-Norm(final)=7.361 | 6050.9 samples/s | 94.5 steps/s
[Step=27050 Epoch=52.8] | Loss=0.00901 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.928 | L2-Norm(final)=7.364 | 1847.7 samples/s | 28.9 steps/s
[Step=27100 Epoch=52.9] | Loss=0.00874 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.932 | L2-Norm(final)=7.367 | 5006.9 samples/s | 78.2 steps/s
[Step=27150 Epoch=53.0] | Loss=0.00848 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.936 | L2-Norm(final)=7.370 | 5004.8 samples/s | 78.2 steps/s
[Step=27200 Epoch=53.1] | Loss=0.00841 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.940 | L2-Norm(final)=7.373 | 5043.2 samples/s | 78.8 steps/s
[Step=27250 Epoch=53.1] | Loss=0.00840 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.943 | L2-Norm(final)=7.377 | 5088.2 samples/s | 79.5 steps/s
[Step=27300 Epoch=53.2] | Loss=0.00831 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.947 | L2-Norm(final)=7.379 | 4928.9 samples/s | 77.0 steps/s
[Step=27350 Epoch=53.3] | Loss=0.00814 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.950 | L2-Norm(final)=7.382 | 5015.6 samples/s | 78.4 steps/s
[Step=27400 Epoch=53.4] | Loss=0.00819 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.953 | L2-Norm(final)=7.385 | 5083.1 samples/s | 79.4 steps/s
[Step=27450 Epoch=53.5] | Loss=0.00824 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.956 | L2-Norm(final)=7.388 | 5011.8 samples/s | 78.3 steps/s
[Step=27500 Epoch=53.6] | Loss=0.00814 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.959 | L2-Norm(final)=7.390 | 5386.2 samples/s | 84.2 steps/s
[Step=27550 Epoch=53.7] | Loss=0.00808 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.962 | L2-Norm(final)=7.393 | 1982.1 samples/s | 31.0 steps/s
[Step=27600 Epoch=53.8] | Loss=0.00799 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.965 | L2-Norm(final)=7.395 | 5192.6 samples/s | 81.1 steps/s
[Step=27650 Epoch=53.9] | Loss=0.00790 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.968 | L2-Norm(final)=7.398 | 4979.1 samples/s | 77.8 steps/s
[Step=27700 Epoch=54.0] | Loss=0.00783 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.971 | L2-Norm(final)=7.401 | 5060.0 samples/s | 79.1 steps/s
[Step=27750 Epoch=54.1] | Loss=0.00786 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=7.403 | 5030.2 samples/s | 78.6 steps/s
[Step=27800 Epoch=54.2] | Loss=0.00782 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.976 | L2-Norm(final)=7.405 | 5025.6 samples/s | 78.5 steps/s
[Step=27850 Epoch=54.3] | Loss=0.00770 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.978 | L2-Norm(final)=7.408 | 5031.0 samples/s | 78.6 steps/s
[Step=27900 Epoch=54.4] | Loss=0.00765 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.981 | L2-Norm(final)=7.410 | 5039.5 samples/s | 78.7 steps/s
[Step=27950 Epoch=54.5] | Loss=0.00763 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.984 | L2-Norm(final)=7.413 | 5015.8 samples/s | 78.4 steps/s
[Step=28000 Epoch=54.6] | Loss=0.00757 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.986 | L2-Norm(final)=7.415 | 4994.5 samples/s | 78.0 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step28000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=38001 Epoch=145.6] | Loss=0.00062 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.795 | L2-Norm(final)=8.896 | 4001.1 samples/s | 62.5 steps/s
[Step=38050 Epoch=145.8] | Loss=0.00062 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.802 | L2-Norm(final)=8.898 | 4741.4 samples/s | 74.1 steps/s
[Step=38100 Epoch=146.0] | Loss=0.00037 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.810 | L2-Norm(final)=8.903 | 5341.4 samples/s | 83.5 steps/s
[Step=38150 Epoch=146.2] | Loss=0.00027 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.811 | L2-Norm(final)=8.908 | 5349.3 samples/s | 83.6 steps/s
[Step=38200 Epoch=146.4] | Loss=0.00023 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.811 | L2-Norm(final)=8.912 | 5403.1 samples/s | 84.4 steps/s
[Step=38250 Epoch=146.6] | Loss=0.00020 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.810 | L2-Norm(final)=8.916 | 6769.2 samples/s | 105.8 steps/s
[Step=38300 Epoch=146.8] | Loss=0.00017 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.808 | L2-Norm(final)=8.920 | 1942.8 samples/s | 30.4 steps/s
[Step=38350 Epoch=146.9] | Loss=0.00016 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.806 | L2-Norm(final)=8.924 | 5302.5 samples/s | 82.9 steps/s
[Step=38400 Epoch=147.1] | Loss=0.00014 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.804 | L2-Norm(final)=8.928 | 5302.7 samples/s | 82.9 steps/s
[Step=38450 Epoch=147.3] | Loss=0.00013 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.802 | L2-Norm(final)=8.931 | 5321.9 samples/s | 83.2 steps/s
[Step=38500 Epoch=147.5] | Loss=0.00012 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.799 | L2-Norm(final)=8.934 | 6037.2 samples/s | 94.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=147.5] | Loss=0.00004 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.771 | L2-Norm(final)=8.964 | 3564.5 samples/s | 55.7 steps/s
[Step=38550 Epoch=147.7] | Loss=0.00004 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.761 | L2-Norm(final)=8.967 | 5012.4 samples/s | 78.3 steps/s
[Step=38600 Epoch=147.9] | Loss=0.00003 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.747 | L2-Norm(final)=8.970 | 4792.6 samples/s | 74.9 steps/s
[Step=38650 Epoch=148.1] | Loss=0.00002 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.732 | L2-Norm(final)=8.971 | 4769.1 samples/s | 74.5 steps/s
[Step=38700 Epoch=148.3] | Loss=0.00002 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.716 | L2-Norm(final)=8.973 | 4835.3 samples/s | 75.6 steps/s
[Step=38750 Epoch=148.5] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.700 | L2-Norm(final)=8.973 | 6038.4 samples/s | 94.3 steps/s
[Step=38800 Epoch=148.7] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=8.974 | 1865.8 samples/s | 29.2 steps/s
[Step=38850 Epoch=148.9] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.666 | L2-Norm(final)=8.975 | 4821.5 samples/s | 75.3 steps/s
[Step=38900 Epoch=149.1] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.649 | L2-Norm(final)=8.975 | 4817.8 samples/s | 75.3 steps/s
[Step=38950 Epoch=149.2] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.631 | L2-Norm(final)=8.976 | 4669.2 samples/s | 73.0 steps/s
[Step=39000 Epoch=149.4] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.613 | L2-Norm(final)=8.976 | 5316.6 samples/s | 83.1 steps/s
[Step=39050 Epoch=149.6] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.595 | L2-Norm(final)=8.977 | 1952.1 samples/s | 30.5 steps/s
[Step=39100 Epoch=149.8] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.576 | L2-Norm(final)=8.977 | 4828.7 samples/s | 75.4 steps/s
[Step=39150 Epoch=150.0] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.558 | L2-Norm(final)=8.977 | 4791.9 samples/s | 74.9 steps/s
[Step=39200 Epoch=150.2] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.539 | L2-Norm(final)=8.978 | 4749.2 samples/s | 74.2 steps/s
[Step=39250 Epoch=150.4] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.520 | L2-Norm(final)=8.978 | 4779.9 samples/s | 74.7 steps/s
[Step=39300 Epoch=150.6] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.501 | L2-Norm(final)=8.979 | 2029.5 samples/s | 31.7 steps/s
[Step=39350 Epoch=150.8] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.482 | L2-Norm(final)=8.979 | 4875.3 samples/s | 76.2 steps/s
[Step=39400 Epoch=151.0] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.462 | L2-Norm(final)=8.979 | 4853.3 samples/s | 75.8 steps/s
[Step=39450 Epoch=151.2] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.442 | L2-Norm(final)=8.980 | 4725.3 samples/s | 73.8 steps/s
[Step=39500 Epoch=151.4] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.422 | L2-Norm(final)=8.980 | 4815.6 samples/s | 75.2 steps/s
[Step=39550 Epoch=151.5] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.402 | L2-Norm(final)=8.980 | 2027.4 samples/s | 31.7 steps/s
[Step=39600 Epoch=151.7] | Loss=0.00000 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.382 | L2-Norm(final)=8.981 | 4744.5 samples/s | 74.1 steps/s
[Step=39650 Epoch=151.9] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.361 | L2-Norm(final)=8.981 | 4717.8 samples/s | 73.7 steps/s
[Step=39700 Epoch=152.1] | Loss=0.00000 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=8.981 | 4930.6 samples/s | 77.0 steps/s
[Step=39750 Epoch=152.3] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.319 | L2-Norm(final)=8.982 | 4693.5 samples/s | 73.3 steps/s
[Step=39800 Epoch=152.5] | Loss=0.00000 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.298 | L2-Norm(final)=8.982 | 6366.5 samples/s | 99.5 steps/s
[Step=39850 Epoch=152.7] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.277 | L2-Norm(final)=8.982 | 1827.2 samples/s | 28.5 steps/s
[Step=39900 Epoch=152.9] | Loss=0.00000 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.255 | L2-Norm(final)=8.983 | 4811.9 samples/s | 75.2 steps/s
[Step=39950 Epoch=153.1] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.233 | L2-Norm(final)=8.983 | 4764.9 samples/s | 74.5 steps/s
[Step=40000 Epoch=153.3] | Loss=0.00000 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.211 | L2-Norm(final)=8.984 | 4741.1 samples/s | 74.1 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06060 | acc=0.9691 | tpr=0.9749 | fpr=0.0434 | 4446.9 samples/s | 17.4 steps/s
Avg test loss: 0.06453, Avg test acc: 0.96823, Avg tpr: 0.97331, Avg fpr: 0.04294, total FA: 335

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06429 | acc=0.9718 | tpr=0.9821 | fpr=0.0505 | 4444.9 samples/s | 17.4 steps/s
Avg test loss: 0.07058, Avg test acc: 0.97035, Avg tpr: 0.98129, Avg fpr: 0.05371, total FA: 419

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.31066 | acc=0.3176 | tpr=0.0334 | fpr=0.0654 | 4442.8 samples/s | 17.4 steps/s
Avg test loss: 5.31477, Avg test acc: 0.31633, Avg tpr: 0.03439, Avg fpr: 0.06358, total FA: 496

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.35234 | acc=0.3127 | tpr=0.0477 | fpr=0.1120 | 4559.8 samples/s | 17.8 steps/s
Avg test loss: 5.34505, Avg test acc: 0.31200, Avg tpr: 0.04902, Avg fpr: 0.10960, total FA: 855

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.40052 | acc=0.1373 | tpr=0.5398 | fpr=0.8699 | 4511.5 samples/s | 17.6 steps/s
[Step= 100] | Loss=5.37958 | acc=0.1371 | tpr=0.5160 | fpr=0.8699 | 8976.0 samples/s | 35.1 steps/s
[Step= 150] | Loss=5.38914 | acc=0.1371 | tpr=0.5130 | fpr=0.8698 | 8313.1 samples/s | 32.5 steps/s
[Step= 200] | Loss=5.38110 | acc=0.1361 | tpr=0.5038 | fpr=0.8706 | 9177.9 samples/s | 35.9 steps/s
[Step= 250] | Loss=5.38252 | acc=0.1361 | tpr=0.5118 | fpr=0.8708 | 8450.6 samples/s | 33.0 steps/s
[Step= 300] | Loss=5.38073 | acc=0.1364 | tpr=0.5215 | fpr=0.8706 | 9069.2 samples/s | 35.4 steps/s
[Step= 350] | Loss=5.37789 | acc=0.1363 | tpr=0.5235 | fpr=0.8708 | 8944.7 samples/s | 34.9 steps/s
[Step= 400] | Loss=5.37640 | acc=0.1363 | tpr=0.5252 | fpr=0.8708 | 8694.2 samples/s | 34.0 steps/s
[Step= 450] | Loss=5.38582 | acc=0.1363 | tpr=0.5195 | fpr=0.8707 | 8320.3 samples/s | 32.5 steps/s
[Step= 500] | Loss=5.38916 | acc=0.1364 | tpr=0.5229 | fpr=0.8705 | 8983.0 samples/s | 35.1 steps/s
[Step= 550] | Loss=5.39370 | acc=0.1365 | tpr=0.5233 | fpr=0.8705 | 15086.0 samples/s | 58.9 steps/s
Avg test loss: 5.39470, Avg test acc: 0.13641, Avg tpr: 0.52417, Avg fpr: 0.87064, total FA: 120887

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.79180 | acc=0.1101 | tpr=0.6637 | fpr=0.8999 | 4470.5 samples/s | 17.5 steps/s
[Step= 100] | Loss=6.76456 | acc=0.1107 | tpr=0.6610 | fpr=0.8996 | 8862.2 samples/s | 34.6 steps/s
[Step= 150] | Loss=6.78288 | acc=0.1102 | tpr=0.6614 | fpr=0.8999 | 8630.1 samples/s | 33.7 steps/s
[Step= 200] | Loss=6.77713 | acc=0.1092 | tpr=0.6525 | fpr=0.9007 | 8708.0 samples/s | 34.0 steps/s
[Step= 250] | Loss=6.77893 | acc=0.1095 | tpr=0.6568 | fpr=0.9005 | 9134.7 samples/s | 35.7 steps/s
[Step= 300] | Loss=6.77876 | acc=0.1099 | tpr=0.6589 | fpr=0.9001 | 8530.8 samples/s | 33.3 steps/s
[Step= 350] | Loss=6.77514 | acc=0.1095 | tpr=0.6512 | fpr=0.9003 | 8933.8 samples/s | 34.9 steps/s
[Step= 400] | Loss=6.77397 | acc=0.1096 | tpr=0.6565 | fpr=0.9003 | 8792.8 samples/s | 34.3 steps/s
[Step= 450] | Loss=6.78387 | acc=0.1092 | tpr=0.6529 | fpr=0.9007 | 8498.6 samples/s | 33.2 steps/s
[Step= 500] | Loss=6.78727 | acc=0.1092 | tpr=0.6551 | fpr=0.9006 | 9446.4 samples/s | 36.9 steps/s
[Step= 550] | Loss=6.79140 | acc=0.1092 | tpr=0.6518 | fpr=0.9006 | 14067.5 samples/s | 55.0 steps/s
Avg test loss: 6.79236, Avg test acc: 0.10914, Avg tpr: 0.65293, Avg fpr: 0.90074, total FA: 125066

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12670 | acc=0.9821 | tpr=0.9381 | fpr=0.0171 | 4679.8 samples/s | 18.3 steps/s
[Step= 100] | Loss=0.13307 | acc=0.9812 | tpr=0.9510 | fpr=0.0182 | 8257.5 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.13784 | acc=0.9801 | tpr=0.9481 | fpr=0.0193 | 8495.0 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.13838 | acc=0.9804 | tpr=0.9486 | fpr=0.0190 | 8711.0 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.13586 | acc=0.9805 | tpr=0.9441 | fpr=0.0188 | 8879.3 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.13823 | acc=0.9803 | tpr=0.9433 | fpr=0.0190 | 9100.0 samples/s | 35.5 steps/s
[Step= 350] | Loss=0.13921 | acc=0.9802 | tpr=0.9461 | fpr=0.0192 | 8435.1 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.13966 | acc=0.9800 | tpr=0.9458 | fpr=0.0194 | 8895.1 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.14300 | acc=0.9796 | tpr=0.9426 | fpr=0.0197 | 8784.9 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.14222 | acc=0.9797 | tpr=0.9441 | fpr=0.0197 | 8583.3 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.14165 | acc=0.9796 | tpr=0.9411 | fpr=0.0197 | 16271.6 samples/s | 63.6 steps/s
Avg test loss: 0.14126, Avg test acc: 0.97965, Avg tpr: 0.94136, Avg fpr: 0.01965, total FA: 2729

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13850 | acc=0.9788 | tpr=0.9381 | fpr=0.0205 | 4558.6 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.14542 | acc=0.9783 | tpr=0.9574 | fpr=0.0213 | 8453.8 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.15030 | acc=0.9769 | tpr=0.9568 | fpr=0.0227 | 8777.4 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.15055 | acc=0.9771 | tpr=0.9563 | fpr=0.0226 | 8860.2 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.14842 | acc=0.9771 | tpr=0.9520 | fpr=0.0225 | 8910.6 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.15114 | acc=0.9768 | tpr=0.9505 | fpr=0.0227 | 8936.6 samples/s | 34.9 steps/s
[Step= 350] | Loss=0.15220 | acc=0.9767 | tpr=0.9530 | fpr=0.0229 | 8558.2 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.15290 | acc=0.9765 | tpr=0.9530 | fpr=0.0230 | 9080.7 samples/s | 35.5 steps/s
[Step= 450] | Loss=0.15635 | acc=0.9762 | tpr=0.9508 | fpr=0.0233 | 8719.0 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.15577 | acc=0.9762 | tpr=0.9529 | fpr=0.0234 | 8671.7 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.15521 | acc=0.9762 | tpr=0.9511 | fpr=0.0233 | 15819.3 samples/s | 61.8 steps/s
Avg test loss: 0.15475, Avg test acc: 0.97625, Avg tpr: 0.95127, Avg fpr: 0.02330, total FA: 3235

server round 35/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=40001 Epoch=153.3] | Loss=0.00004 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=8.996 | 3689.9 samples/s | 57.7 steps/s
[Step=40050 Epoch=153.5] | Loss=0.00026 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.486 | L2-Norm(final)=8.999 | 5232.6 samples/s | 81.8 steps/s
[Step=40100 Epoch=153.6] | Loss=0.00017 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.485 | L2-Norm(final)=9.004 | 5273.0 samples/s | 82.4 steps/s
[Step=40150 Epoch=153.8] | Loss=0.00015 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.484 | L2-Norm(final)=9.010 | 5343.7 samples/s | 83.5 steps/s
[Step=40200 Epoch=154.0] | Loss=0.00012 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.483 | L2-Norm(final)=9.017 | 5409.3 samples/s | 84.5 steps/s
[Step=40250 Epoch=154.2] | Loss=0.00011 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.481 | L2-Norm(final)=9.023 | 6840.1 samples/s | 106.9 steps/s
[Step=40300 Epoch=154.4] | Loss=0.00009 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.478 | L2-Norm(final)=9.028 | 1929.1 samples/s | 30.1 steps/s
[Step=40350 Epoch=154.6] | Loss=0.00008 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.474 | L2-Norm(final)=9.032 | 5349.8 samples/s | 83.6 steps/s
[Step=40400 Epoch=154.8] | Loss=0.00008 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.470 | L2-Norm(final)=9.036 | 5389.3 samples/s | 84.2 steps/s
[Step=40450 Epoch=155.0] | Loss=0.00007 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.465 | L2-Norm(final)=9.040 | 5302.6 samples/s | 82.9 steps/s
[Step=40500 Epoch=155.2] | Loss=0.00006 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.460 | L2-Norm(final)=9.044 | 5960.5 samples/s | 93.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=40501 Epoch=155.2] | Loss=0.00008 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.410 | L2-Norm(final)=9.078 | 3698.8 samples/s | 57.8 steps/s
[Step=40550 Epoch=155.4] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.386 | L2-Norm(final)=9.080 | 4878.3 samples/s | 76.2 steps/s
[Step=40600 Epoch=155.6] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.354 | L2-Norm(final)=9.082 | 4748.3 samples/s | 74.2 steps/s
[Step=40650 Epoch=155.8] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.321 | L2-Norm(final)=9.083 | 4796.3 samples/s | 74.9 steps/s
[Step=40700 Epoch=155.9] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=9.084 | 4870.6 samples/s | 76.1 steps/s
[Step=40750 Epoch=156.1] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.252 | L2-Norm(final)=9.085 | 5896.5 samples/s | 92.1 steps/s
[Step=40800 Epoch=156.3] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.217 | L2-Norm(final)=9.086 | 1856.1 samples/s | 29.0 steps/s
[Step=40850 Epoch=156.5] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.182 | L2-Norm(final)=9.086 | 4822.7 samples/s | 75.4 steps/s
[Step=40900 Epoch=156.7] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.147 | L2-Norm(final)=9.087 | 4798.0 samples/s | 75.0 steps/s
[Step=40950 Epoch=156.9] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.111 | L2-Norm(final)=9.088 | 4753.9 samples/s | 74.3 steps/s
[Step=41000 Epoch=157.1] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.075 | L2-Norm(final)=9.088 | 5305.1 samples/s | 82.9 steps/s
[Step=41050 Epoch=157.3] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.039 | L2-Norm(final)=9.089 | 1966.1 samples/s | 30.7 steps/s
[Step=41100 Epoch=157.5] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.003 | L2-Norm(final)=9.089 | 4705.3 samples/s | 73.5 steps/s
[Step=41150 Epoch=157.7] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.966 | L2-Norm(final)=9.090 | 4759.8 samples/s | 74.4 steps/s
[Step=41200 Epoch=157.9] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.930 | L2-Norm(final)=9.090 | 4854.3 samples/s | 75.8 steps/s
[Step=41250 Epoch=158.1] | Loss=0.00000 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.893 | L2-Norm(final)=9.091 | 4704.7 samples/s | 73.5 steps/s
[Step=41300 Epoch=158.2] | Loss=0.00000 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.856 | L2-Norm(final)=9.091 | 2013.4 samples/s | 31.5 steps/s
[Step=41350 Epoch=158.4] | Loss=0.00000 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.819 | L2-Norm(final)=9.092 | 4851.9 samples/s | 75.8 steps/s
[Step=41400 Epoch=158.6] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.782 | L2-Norm(final)=9.093 | 4792.7 samples/s | 74.9 steps/s
[Step=41450 Epoch=158.8] | Loss=0.00000 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.744 | L2-Norm(final)=9.093 | 4803.4 samples/s | 75.1 steps/s
[Step=41500 Epoch=159.0] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.707 | L2-Norm(final)=9.094 | 4836.1 samples/s | 75.6 steps/s
[Step=41550 Epoch=159.2] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.669 | L2-Norm(final)=9.094 | 2025.7 samples/s | 31.7 steps/s
[Step=41600 Epoch=159.4] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.631 | L2-Norm(final)=9.095 | 4785.6 samples/s | 74.8 steps/s
[Step=41650 Epoch=159.6] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.593 | L2-Norm(final)=9.096 | 4818.7 samples/s | 75.3 steps/s
[Step=41700 Epoch=159.8] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.555 | L2-Norm(final)=9.096 | 4754.4 samples/s | 74.3 steps/s
[Step=41750 Epoch=160.0] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.517 | L2-Norm(final)=9.097 | 4859.5 samples/s | 75.9 steps/s
[Step=41800 Epoch=160.2] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.479 | L2-Norm(final)=9.098 | 6400.8 samples/s | 100.0 steps/s
[Step=41850 Epoch=160.4] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.441 | L2-Norm(final)=9.098 | 1833.0 samples/s | 28.6 steps/s
[Step=41900 Epoch=160.5] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.403 | L2-Norm(final)=9.099 | 4693.3 samples/s | 73.3 steps/s
[Step=41950 Epoch=160.7] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.364 | L2-Norm(final)=9.100 | 4769.0 samples/s | 74.5 steps/s
[Step=42000 Epoch=160.9] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.326 | L2-Norm(final)=9.101 | 4790.8 samples/s | 74.9 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step42000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=38001 Epoch=146.3] | Loss=0.00024 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=7.943 | 3684.5 samples/s | 57.6 steps/s
[Step=38050 Epoch=146.5] | Loss=0.00018 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=7.950 | 5250.2 samples/s | 82.0 steps/s
[Step=38100 Epoch=146.7] | Loss=0.00014 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=7.958 | 5399.9 samples/s | 84.4 steps/s
[Step=38150 Epoch=146.9] | Loss=0.00013 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.493 | L2-Norm(final)=7.965 | 5346.1 samples/s | 83.5 steps/s
[Step=38200 Epoch=147.0] | Loss=0.00011 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.493 | L2-Norm(final)=7.971 | 5274.7 samples/s | 82.4 steps/s
[Step=38250 Epoch=147.2] | Loss=0.00011 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.492 | L2-Norm(final)=7.977 | 7165.0 samples/s | 112.0 steps/s
[Step=38300 Epoch=147.4] | Loss=0.00010 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=7.983 | 1940.8 samples/s | 30.3 steps/s
[Step=38350 Epoch=147.6] | Loss=0.00009 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=7.989 | 5208.8 samples/s | 81.4 steps/s
[Step=38400 Epoch=147.8] | Loss=0.00008 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.487 | L2-Norm(final)=7.993 | 5315.9 samples/s | 83.1 steps/s
[Step=38450 Epoch=148.0] | Loss=0.00007 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.483 | L2-Norm(final)=7.997 | 5395.5 samples/s | 84.3 steps/s
[Step=38500 Epoch=148.2] | Loss=0.00007 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.479 | L2-Norm(final)=8.001 | 6032.5 samples/s | 94.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=148.2] | Loss=0.00002 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.439 | L2-Norm(final)=8.042 | 3822.5 samples/s | 59.7 steps/s
[Step=38550 Epoch=148.4] | Loss=0.00002 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.429 | L2-Norm(final)=8.044 | 4575.3 samples/s | 71.5 steps/s
[Step=38600 Epoch=148.6] | Loss=0.00002 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.417 | L2-Norm(final)=8.047 | 4760.7 samples/s | 74.4 steps/s
[Step=38650 Epoch=148.8] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.404 | L2-Norm(final)=8.049 | 4783.9 samples/s | 74.7 steps/s
[Step=38700 Epoch=149.0] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.391 | L2-Norm(final)=8.050 | 4733.5 samples/s | 74.0 steps/s
[Step=38750 Epoch=149.2] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.377 | L2-Norm(final)=8.052 | 6161.0 samples/s | 96.3 steps/s
[Step=38800 Epoch=149.4] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=8.054 | 1870.2 samples/s | 29.2 steps/s
[Step=38850 Epoch=149.5] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.349 | L2-Norm(final)=8.055 | 4740.5 samples/s | 74.1 steps/s
[Step=38900 Epoch=149.7] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.335 | L2-Norm(final)=8.056 | 4781.6 samples/s | 74.7 steps/s
[Step=38950 Epoch=149.9] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.320 | L2-Norm(final)=8.057 | 4783.7 samples/s | 74.7 steps/s
[Step=39000 Epoch=150.1] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.306 | L2-Norm(final)=8.058 | 5418.7 samples/s | 84.7 steps/s
[Step=39050 Epoch=150.3] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.290 | L2-Norm(final)=8.059 | 1938.1 samples/s | 30.3 steps/s
[Step=39100 Epoch=150.5] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.275 | L2-Norm(final)=8.060 | 4778.4 samples/s | 74.7 steps/s
[Step=39150 Epoch=150.7] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=8.061 | 4738.8 samples/s | 74.0 steps/s
[Step=39200 Epoch=150.9] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.244 | L2-Norm(final)=8.061 | 4804.7 samples/s | 75.1 steps/s
[Step=39250 Epoch=151.1] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.229 | L2-Norm(final)=8.062 | 4910.7 samples/s | 76.7 steps/s
[Step=39300 Epoch=151.3] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.213 | L2-Norm(final)=8.063 | 2012.0 samples/s | 31.4 steps/s
[Step=39350 Epoch=151.5] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.197 | L2-Norm(final)=8.064 | 4835.0 samples/s | 75.5 steps/s
[Step=39400 Epoch=151.7] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.180 | L2-Norm(final)=8.065 | 4763.1 samples/s | 74.4 steps/s
[Step=39450 Epoch=151.9] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.164 | L2-Norm(final)=8.065 | 4820.5 samples/s | 75.3 steps/s
[Step=39500 Epoch=152.1] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.148 | L2-Norm(final)=8.066 | 4761.5 samples/s | 74.4 steps/s
[Step=39550 Epoch=152.2] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.131 | L2-Norm(final)=8.067 | 2034.1 samples/s | 31.8 steps/s
[Step=39600 Epoch=152.4] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.114 | L2-Norm(final)=8.068 | 4848.3 samples/s | 75.8 steps/s
[Step=39650 Epoch=152.6] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.097 | L2-Norm(final)=8.069 | 4748.3 samples/s | 74.2 steps/s
[Step=39700 Epoch=152.8] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.080 | L2-Norm(final)=8.069 | 4700.7 samples/s | 73.4 steps/s
[Step=39750 Epoch=153.0] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.063 | L2-Norm(final)=8.070 | 4809.9 samples/s | 75.2 steps/s
[Step=39800 Epoch=153.2] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.045 | L2-Norm(final)=8.071 | 7016.7 samples/s | 109.6 steps/s
[Step=39850 Epoch=153.4] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.028 | L2-Norm(final)=8.072 | 1787.8 samples/s | 27.9 steps/s
[Step=39900 Epoch=153.6] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.010 | L2-Norm(final)=8.073 | 4857.9 samples/s | 75.9 steps/s
[Step=39950 Epoch=153.8] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.992 | L2-Norm(final)=8.073 | 4762.6 samples/s | 74.4 steps/s
[Step=40000 Epoch=154.0] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.974 | L2-Norm(final)=8.074 | 4752.8 samples/s | 74.3 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06060 | acc=0.9691 | tpr=0.9749 | fpr=0.0434 | 4445.7 samples/s | 17.4 steps/s
Avg test loss: 0.06453, Avg test acc: 0.96823, Avg tpr: 0.97331, Avg fpr: 0.04294, total FA: 335

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06429 | acc=0.9718 | tpr=0.9821 | fpr=0.0505 | 4413.7 samples/s | 17.2 steps/s
Avg test loss: 0.07058, Avg test acc: 0.97035, Avg tpr: 0.98129, Avg fpr: 0.05371, total FA: 419

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.25131 | acc=0.3136 | tpr=0.0282 | fpr=0.0667 | 4443.2 samples/s | 17.4 steps/s
Avg test loss: 5.25903, Avg test acc: 0.31220, Avg tpr: 0.02885, Avg fpr: 0.06461, total FA: 504

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.38759 | acc=0.3078 | tpr=0.0446 | fpr=0.1207 | 4420.7 samples/s | 17.3 steps/s
Avg test loss: 5.38328, Avg test acc: 0.30784, Avg tpr: 0.04587, Avg fpr: 0.11601, total FA: 905

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.40052 | acc=0.1373 | tpr=0.5398 | fpr=0.8699 | 4481.6 samples/s | 17.5 steps/s
[Step= 100] | Loss=5.37958 | acc=0.1371 | tpr=0.5160 | fpr=0.8699 | 8972.4 samples/s | 35.0 steps/s
[Step= 150] | Loss=5.38914 | acc=0.1371 | tpr=0.5130 | fpr=0.8698 | 8728.5 samples/s | 34.1 steps/s
[Step= 200] | Loss=5.38110 | acc=0.1361 | tpr=0.5038 | fpr=0.8706 | 8492.5 samples/s | 33.2 steps/s
[Step= 250] | Loss=5.38252 | acc=0.1361 | tpr=0.5118 | fpr=0.8708 | 8798.9 samples/s | 34.4 steps/s
[Step= 300] | Loss=5.38073 | acc=0.1364 | tpr=0.5215 | fpr=0.8706 | 8892.7 samples/s | 34.7 steps/s
[Step= 350] | Loss=5.37789 | acc=0.1363 | tpr=0.5235 | fpr=0.8708 | 8769.1 samples/s | 34.3 steps/s
[Step= 400] | Loss=5.37640 | acc=0.1363 | tpr=0.5252 | fpr=0.8708 | 8870.5 samples/s | 34.7 steps/s
[Step= 450] | Loss=5.38582 | acc=0.1363 | tpr=0.5195 | fpr=0.8707 | 8692.2 samples/s | 34.0 steps/s
[Step= 500] | Loss=5.38916 | acc=0.1364 | tpr=0.5229 | fpr=0.8705 | 9105.2 samples/s | 35.6 steps/s
[Step= 550] | Loss=5.39370 | acc=0.1365 | tpr=0.5233 | fpr=0.8705 | 14654.4 samples/s | 57.2 steps/s
Avg test loss: 5.39470, Avg test acc: 0.13641, Avg tpr: 0.52417, Avg fpr: 0.87064, total FA: 120887

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.79180 | acc=0.1101 | tpr=0.6637 | fpr=0.8999 | 4495.1 samples/s | 17.6 steps/s
[Step= 100] | Loss=6.76456 | acc=0.1107 | tpr=0.6610 | fpr=0.8996 | 8736.6 samples/s | 34.1 steps/s
[Step= 150] | Loss=6.78288 | acc=0.1102 | tpr=0.6614 | fpr=0.8999 | 8698.4 samples/s | 34.0 steps/s
[Step= 200] | Loss=6.77713 | acc=0.1092 | tpr=0.6525 | fpr=0.9007 | 8809.1 samples/s | 34.4 steps/s
[Step= 250] | Loss=6.77893 | acc=0.1095 | tpr=0.6568 | fpr=0.9005 | 8764.1 samples/s | 34.2 steps/s
[Step= 300] | Loss=6.77876 | acc=0.1099 | tpr=0.6589 | fpr=0.9001 | 8822.6 samples/s | 34.5 steps/s
[Step= 350] | Loss=6.77514 | acc=0.1095 | tpr=0.6512 | fpr=0.9003 | 8681.5 samples/s | 33.9 steps/s
[Step= 400] | Loss=6.77397 | acc=0.1096 | tpr=0.6565 | fpr=0.9003 | 8958.5 samples/s | 35.0 steps/s
[Step= 450] | Loss=6.78387 | acc=0.1092 | tpr=0.6529 | fpr=0.9007 | 8811.9 samples/s | 34.4 steps/s
[Step= 500] | Loss=6.78727 | acc=0.1092 | tpr=0.6551 | fpr=0.9006 | 8623.1 samples/s | 33.7 steps/s
[Step= 550] | Loss=6.79140 | acc=0.1092 | tpr=0.6518 | fpr=0.9006 | 16084.3 samples/s | 62.8 steps/s
Avg test loss: 6.79236, Avg test acc: 0.10914, Avg tpr: 0.65293, Avg fpr: 0.90074, total FA: 125066

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11218 | acc=0.9826 | tpr=0.9292 | fpr=0.0165 | 4495.7 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.11706 | acc=0.9818 | tpr=0.9382 | fpr=0.0173 | 8594.3 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.12093 | acc=0.9811 | tpr=0.9380 | fpr=0.0181 | 8679.9 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.12120 | acc=0.9814 | tpr=0.9421 | fpr=0.0179 | 8994.9 samples/s | 35.1 steps/s
[Step= 250] | Loss=0.11894 | acc=0.9817 | tpr=0.9389 | fpr=0.0175 | 8593.0 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.12072 | acc=0.9814 | tpr=0.9389 | fpr=0.0178 | 9353.0 samples/s | 36.5 steps/s
[Step= 350] | Loss=0.12174 | acc=0.9812 | tpr=0.9430 | fpr=0.0181 | 8430.5 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.12201 | acc=0.9811 | tpr=0.9426 | fpr=0.0182 | 8704.5 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.12510 | acc=0.9807 | tpr=0.9391 | fpr=0.0185 | 9050.2 samples/s | 35.4 steps/s
[Step= 500] | Loss=0.12465 | acc=0.9808 | tpr=0.9414 | fpr=0.0185 | 8656.3 samples/s | 33.8 steps/s
[Step= 550] | Loss=0.12417 | acc=0.9808 | tpr=0.9403 | fpr=0.0184 | 15756.6 samples/s | 61.5 steps/s
Avg test loss: 0.12386, Avg test acc: 0.98084, Avg tpr: 0.94057, Avg fpr: 0.01843, total FA: 2559

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14090 | acc=0.9786 | tpr=0.9469 | fpr=0.0208 | 4487.6 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.14757 | acc=0.9779 | tpr=0.9574 | fpr=0.0217 | 8781.6 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.15248 | acc=0.9768 | tpr=0.9582 | fpr=0.0229 | 9152.3 samples/s | 35.8 steps/s
[Step= 200] | Loss=0.15293 | acc=0.9769 | tpr=0.9574 | fpr=0.0228 | 9000.3 samples/s | 35.2 steps/s
[Step= 250] | Loss=0.15040 | acc=0.9770 | tpr=0.9546 | fpr=0.0226 | 8440.0 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.15299 | acc=0.9768 | tpr=0.9535 | fpr=0.0228 | 8847.1 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.15426 | acc=0.9765 | tpr=0.9549 | fpr=0.0231 | 9062.7 samples/s | 35.4 steps/s
[Step= 400] | Loss=0.15507 | acc=0.9763 | tpr=0.9551 | fpr=0.0233 | 8576.9 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.15850 | acc=0.9760 | tpr=0.9537 | fpr=0.0236 | 9542.6 samples/s | 37.3 steps/s
[Step= 500] | Loss=0.15809 | acc=0.9760 | tpr=0.9559 | fpr=0.0236 | 8328.2 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.15751 | acc=0.9760 | tpr=0.9534 | fpr=0.0236 | 15458.3 samples/s | 60.4 steps/s
Avg test loss: 0.15708, Avg test acc: 0.97602, Avg tpr: 0.95365, Avg fpr: 0.02357, total FA: 3273

server round 36/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=34001 Epoch=66.5] | Loss=0.00230 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.874 | L2-Norm(final)=8.011 | 3944.8 samples/s | 61.6 steps/s
[Step=34050 Epoch=66.6] | Loss=0.01072 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.879 | L2-Norm(final)=8.015 | 5280.0 samples/s | 82.5 steps/s
[Step=34100 Epoch=66.7] | Loss=0.01131 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.886 | L2-Norm(final)=8.019 | 5614.7 samples/s | 87.7 steps/s
[Step=34150 Epoch=66.8] | Loss=0.01128 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.893 | L2-Norm(final)=8.024 | 5687.7 samples/s | 88.9 steps/s
[Step=34200 Epoch=66.9] | Loss=0.01137 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.900 | L2-Norm(final)=8.029 | 5685.8 samples/s | 88.8 steps/s
[Step=34250 Epoch=67.0] | Loss=0.01154 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.905 | L2-Norm(final)=8.034 | 5646.5 samples/s | 88.2 steps/s
[Step=34300 Epoch=67.1] | Loss=0.01141 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.911 | L2-Norm(final)=8.039 | 5733.2 samples/s | 89.6 steps/s
[Step=34350 Epoch=67.2] | Loss=0.01129 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.917 | L2-Norm(final)=8.044 | 5620.1 samples/s | 87.8 steps/s
[Step=34400 Epoch=67.3] | Loss=0.01098 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=8.050 | 5667.0 samples/s | 88.5 steps/s
[Step=34450 Epoch=67.3] | Loss=0.01086 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.928 | L2-Norm(final)=8.056 | 5714.1 samples/s | 89.3 steps/s
[Step=34500 Epoch=67.4] | Loss=0.01056 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=8.062 | 7242.2 samples/s | 113.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=67.4] | Loss=0.00075 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.986 | L2-Norm(final)=8.121 | 3691.0 samples/s | 57.7 steps/s
[Step=34550 Epoch=67.5] | Loss=0.01000 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.993 | L2-Norm(final)=8.127 | 5088.2 samples/s | 79.5 steps/s
[Step=34600 Epoch=67.6] | Loss=0.01059 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.002 | L2-Norm(final)=8.132 | 5087.1 samples/s | 79.5 steps/s
[Step=34650 Epoch=67.7] | Loss=0.01038 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.011 | L2-Norm(final)=8.136 | 4974.3 samples/s | 77.7 steps/s
[Step=34700 Epoch=67.8] | Loss=0.01014 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.018 | L2-Norm(final)=8.141 | 5081.9 samples/s | 79.4 steps/s
[Step=34750 Epoch=67.9] | Loss=0.01020 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.025 | L2-Norm(final)=8.145 | 5048.7 samples/s | 78.9 steps/s
[Step=34800 Epoch=68.0] | Loss=0.01005 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.032 | L2-Norm(final)=8.150 | 4918.7 samples/s | 76.9 steps/s
[Step=34850 Epoch=68.1] | Loss=0.01034 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.039 | L2-Norm(final)=8.154 | 5117.3 samples/s | 80.0 steps/s
[Step=34900 Epoch=68.2] | Loss=0.01028 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.045 | L2-Norm(final)=8.159 | 5001.1 samples/s | 78.1 steps/s
[Step=34950 Epoch=68.3] | Loss=0.01035 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.051 | L2-Norm(final)=8.163 | 5066.3 samples/s | 79.2 steps/s
[Step=35000 Epoch=68.4] | Loss=0.01021 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.057 | L2-Norm(final)=8.166 | 6259.1 samples/s | 97.8 steps/s
[Step=35050 Epoch=68.5] | Loss=0.01000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.062 | L2-Norm(final)=8.170 | 1937.0 samples/s | 30.3 steps/s
[Step=35100 Epoch=68.6] | Loss=0.00972 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.068 | L2-Norm(final)=8.174 | 4998.0 samples/s | 78.1 steps/s
[Step=35150 Epoch=68.7] | Loss=0.00960 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.073 | L2-Norm(final)=8.178 | 4973.5 samples/s | 77.7 steps/s
[Step=35200 Epoch=68.8] | Loss=0.00941 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.078 | L2-Norm(final)=8.182 | 5049.0 samples/s | 78.9 steps/s
[Step=35250 Epoch=68.9] | Loss=0.00930 | Reg=0.00123 | acc=0.9688 | L2-Norm=11.083 | L2-Norm(final)=8.186 | 5064.3 samples/s | 79.1 steps/s
[Step=35300 Epoch=69.0] | Loss=0.00928 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.087 | L2-Norm(final)=8.190 | 5045.0 samples/s | 78.8 steps/s
[Step=35350 Epoch=69.1] | Loss=0.00916 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.091 | L2-Norm(final)=8.193 | 5024.7 samples/s | 78.5 steps/s
[Step=35400 Epoch=69.2] | Loss=0.00900 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.095 | L2-Norm(final)=8.197 | 5080.5 samples/s | 79.4 steps/s
[Step=35450 Epoch=69.3] | Loss=0.00889 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.099 | L2-Norm(final)=8.200 | 5019.5 samples/s | 78.4 steps/s
[Step=35500 Epoch=69.4] | Loss=0.00882 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.103 | L2-Norm(final)=8.203 | 5370.1 samples/s | 83.9 steps/s
[Step=35550 Epoch=69.5] | Loss=0.00864 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.107 | L2-Norm(final)=8.207 | 2014.6 samples/s | 31.5 steps/s
[Step=35600 Epoch=69.6] | Loss=0.00860 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.111 | L2-Norm(final)=8.210 | 5023.1 samples/s | 78.5 steps/s
[Step=35650 Epoch=69.7] | Loss=0.00843 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.115 | L2-Norm(final)=8.214 | 5044.0 samples/s | 78.8 steps/s
[Step=35700 Epoch=69.8] | Loss=0.00828 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.118 | L2-Norm(final)=8.217 | 5104.3 samples/s | 79.8 steps/s
[Step=35750 Epoch=69.9] | Loss=0.00828 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.122 | L2-Norm(final)=8.220 | 4956.4 samples/s | 77.4 steps/s
[Step=35800 Epoch=70.0] | Loss=0.00819 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.125 | L2-Norm(final)=8.224 | 5035.7 samples/s | 78.7 steps/s
[Step=35850 Epoch=70.1] | Loss=0.00810 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.129 | L2-Norm(final)=8.227 | 5067.7 samples/s | 79.2 steps/s
[Step=35900 Epoch=70.2] | Loss=0.00807 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.132 | L2-Norm(final)=8.230 | 5026.8 samples/s | 78.5 steps/s
[Step=35950 Epoch=70.3] | Loss=0.00801 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.136 | L2-Norm(final)=8.233 | 5033.6 samples/s | 78.6 steps/s
[Step=36000 Epoch=70.4] | Loss=0.00796 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.139 | L2-Norm(final)=8.236 | 5093.9 samples/s | 79.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step36000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=42001 Epoch=160.9] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.874 | L2-Norm(final)=9.125 | 3892.9 samples/s | 60.8 steps/s
[Step=42050 Epoch=161.1] | Loss=0.00014 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.862 | L2-Norm(final)=9.137 | 4928.1 samples/s | 77.0 steps/s
[Step=42100 Epoch=161.3] | Loss=0.00013 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.868 | L2-Norm(final)=9.149 | 5361.7 samples/s | 83.8 steps/s
[Step=42150 Epoch=161.5] | Loss=0.00010 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.869 | L2-Norm(final)=9.157 | 5295.3 samples/s | 82.7 steps/s
[Step=42200 Epoch=161.7] | Loss=0.00008 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.867 | L2-Norm(final)=9.163 | 5303.6 samples/s | 82.9 steps/s
[Step=42250 Epoch=161.9] | Loss=0.00008 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.864 | L2-Norm(final)=9.170 | 7003.9 samples/s | 109.4 steps/s
[Step=42300 Epoch=162.1] | Loss=0.00007 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.860 | L2-Norm(final)=9.175 | 1922.4 samples/s | 30.0 steps/s
[Step=42350 Epoch=162.3] | Loss=0.00006 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.855 | L2-Norm(final)=9.181 | 5331.7 samples/s | 83.3 steps/s
[Step=42400 Epoch=162.5] | Loss=0.00005 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.850 | L2-Norm(final)=9.185 | 5489.7 samples/s | 85.8 steps/s
[Step=42450 Epoch=162.7] | Loss=0.00005 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.845 | L2-Norm(final)=9.189 | 5227.8 samples/s | 81.7 steps/s
[Step=42500 Epoch=162.8] | Loss=0.00005 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.839 | L2-Norm(final)=9.193 | 6068.3 samples/s | 94.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=42501 Epoch=162.8] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.778 | L2-Norm(final)=9.231 | 3926.0 samples/s | 61.3 steps/s
[Step=42550 Epoch=163.0] | Loss=0.00117 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.762 | L2-Norm(final)=9.234 | 4433.8 samples/s | 69.3 steps/s
[Step=42600 Epoch=163.2] | Loss=0.00107 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.778 | L2-Norm(final)=9.232 | 4758.3 samples/s | 74.3 steps/s
[Step=42650 Epoch=163.4] | Loss=0.00079 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.791 | L2-Norm(final)=9.230 | 4829.2 samples/s | 75.5 steps/s
[Step=42700 Epoch=163.6] | Loss=0.00061 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.798 | L2-Norm(final)=9.229 | 4832.4 samples/s | 75.5 steps/s
[Step=42750 Epoch=163.8] | Loss=0.00049 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.801 | L2-Norm(final)=9.230 | 5991.2 samples/s | 93.6 steps/s
[Step=42800 Epoch=164.0] | Loss=0.00042 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.803 | L2-Norm(final)=9.230 | 1863.4 samples/s | 29.1 steps/s
[Step=42850 Epoch=164.2] | Loss=0.00036 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.803 | L2-Norm(final)=9.231 | 4818.8 samples/s | 75.3 steps/s
[Step=42900 Epoch=164.4] | Loss=0.00032 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.803 | L2-Norm(final)=9.232 | 4754.5 samples/s | 74.3 steps/s
[Step=42950 Epoch=164.6] | Loss=0.00029 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.802 | L2-Norm(final)=9.232 | 4818.2 samples/s | 75.3 steps/s
[Step=43000 Epoch=164.8] | Loss=0.00026 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.801 | L2-Norm(final)=9.233 | 5268.8 samples/s | 82.3 steps/s
[Step=43050 Epoch=165.0] | Loss=0.00024 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.800 | L2-Norm(final)=9.234 | 1966.7 samples/s | 30.7 steps/s
[Step=43100 Epoch=165.1] | Loss=0.00022 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.798 | L2-Norm(final)=9.234 | 4745.1 samples/s | 74.1 steps/s
[Step=43150 Epoch=165.3] | Loss=0.00020 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.796 | L2-Norm(final)=9.235 | 4747.5 samples/s | 74.2 steps/s
[Step=43200 Epoch=165.5] | Loss=0.00019 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.794 | L2-Norm(final)=9.235 | 4739.9 samples/s | 74.1 steps/s
[Step=43250 Epoch=165.7] | Loss=0.00017 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.792 | L2-Norm(final)=9.236 | 4795.6 samples/s | 74.9 steps/s
[Step=43300 Epoch=165.9] | Loss=0.00016 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.790 | L2-Norm(final)=9.236 | 2009.0 samples/s | 31.4 steps/s
[Step=43350 Epoch=166.1] | Loss=0.00016 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.788 | L2-Norm(final)=9.237 | 4898.6 samples/s | 76.5 steps/s
[Step=43400 Epoch=166.3] | Loss=0.00015 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.786 | L2-Norm(final)=9.237 | 4775.5 samples/s | 74.6 steps/s
[Step=43450 Epoch=166.5] | Loss=0.00014 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.783 | L2-Norm(final)=9.238 | 4854.2 samples/s | 75.8 steps/s
[Step=43500 Epoch=166.7] | Loss=0.00013 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.781 | L2-Norm(final)=9.238 | 4683.6 samples/s | 73.2 steps/s
[Step=43550 Epoch=166.9] | Loss=0.00013 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.778 | L2-Norm(final)=9.238 | 2048.3 samples/s | 32.0 steps/s
[Step=43600 Epoch=167.1] | Loss=0.00012 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.775 | L2-Norm(final)=9.239 | 4823.8 samples/s | 75.4 steps/s
[Step=43650 Epoch=167.3] | Loss=0.00012 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=9.239 | 4686.4 samples/s | 73.2 steps/s
[Step=43700 Epoch=167.4] | Loss=0.00011 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.770 | L2-Norm(final)=9.240 | 4796.2 samples/s | 74.9 steps/s
[Step=43750 Epoch=167.6] | Loss=0.00011 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.767 | L2-Norm(final)=9.240 | 4815.0 samples/s | 75.2 steps/s
[Step=43800 Epoch=167.8] | Loss=0.00010 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.764 | L2-Norm(final)=9.240 | 6568.0 samples/s | 102.6 steps/s
[Step=43850 Epoch=168.0] | Loss=0.00010 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.761 | L2-Norm(final)=9.241 | 1820.8 samples/s | 28.5 steps/s
[Step=43900 Epoch=168.2] | Loss=0.00010 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.758 | L2-Norm(final)=9.241 | 4778.7 samples/s | 74.7 steps/s
[Step=43950 Epoch=168.4] | Loss=0.00009 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.754 | L2-Norm(final)=9.241 | 4866.3 samples/s | 76.0 steps/s
[Step=44000 Epoch=168.6] | Loss=0.00009 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.751 | L2-Norm(final)=9.242 | 4764.2 samples/s | 74.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step44000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06060 | acc=0.9691 | tpr=0.9749 | fpr=0.0434 | 4467.1 samples/s | 17.4 steps/s
Avg test loss: 0.06453, Avg test acc: 0.96823, Avg tpr: 0.97331, Avg fpr: 0.04294, total FA: 335

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06181 | acc=0.9713 | tpr=0.9823 | fpr=0.0525 | 4527.8 samples/s | 17.7 steps/s
Avg test loss: 0.06823, Avg test acc: 0.97007, Avg tpr: 0.98187, Avg fpr: 0.05589, total FA: 436

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.94257 | acc=0.3064 | tpr=0.0420 | fpr=0.1194 | 4460.4 samples/s | 17.4 steps/s
Avg test loss: 4.94396, Avg test acc: 0.30467, Avg tpr: 0.04232, Avg fpr: 0.11832, total FA: 923

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.38759 | acc=0.3078 | tpr=0.0446 | fpr=0.1207 | 4475.3 samples/s | 17.5 steps/s
Avg test loss: 5.38328, Avg test acc: 0.30784, Avg tpr: 0.04587, Avg fpr: 0.11601, total FA: 905

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.40052 | acc=0.1373 | tpr=0.5398 | fpr=0.8699 | 4462.4 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.37958 | acc=0.1371 | tpr=0.5160 | fpr=0.8699 | 8499.8 samples/s | 33.2 steps/s
[Step= 150] | Loss=5.38914 | acc=0.1371 | tpr=0.5130 | fpr=0.8698 | 9106.2 samples/s | 35.6 steps/s
[Step= 200] | Loss=5.38110 | acc=0.1361 | tpr=0.5038 | fpr=0.8706 | 8632.8 samples/s | 33.7 steps/s
[Step= 250] | Loss=5.38252 | acc=0.1361 | tpr=0.5118 | fpr=0.8708 | 8896.0 samples/s | 34.7 steps/s
[Step= 300] | Loss=5.38073 | acc=0.1364 | tpr=0.5215 | fpr=0.8706 | 8761.3 samples/s | 34.2 steps/s
[Step= 350] | Loss=5.37789 | acc=0.1363 | tpr=0.5235 | fpr=0.8708 | 8826.1 samples/s | 34.5 steps/s
[Step= 400] | Loss=5.37640 | acc=0.1363 | tpr=0.5252 | fpr=0.8708 | 8622.2 samples/s | 33.7 steps/s
[Step= 450] | Loss=5.38582 | acc=0.1363 | tpr=0.5195 | fpr=0.8707 | 9230.4 samples/s | 36.1 steps/s
[Step= 500] | Loss=5.38916 | acc=0.1364 | tpr=0.5229 | fpr=0.8705 | 8457.5 samples/s | 33.0 steps/s
[Step= 550] | Loss=5.39370 | acc=0.1365 | tpr=0.5233 | fpr=0.8705 | 15768.4 samples/s | 61.6 steps/s
Avg test loss: 5.39470, Avg test acc: 0.13641, Avg tpr: 0.52417, Avg fpr: 0.87064, total FA: 120887

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.30144 | acc=0.1059 | tpr=0.6726 | fpr=0.9043 | 4432.3 samples/s | 17.3 steps/s
[Step= 100] | Loss=6.27938 | acc=0.1067 | tpr=0.6567 | fpr=0.9036 | 8755.7 samples/s | 34.2 steps/s
[Step= 150] | Loss=6.29451 | acc=0.1059 | tpr=0.6513 | fpr=0.9041 | 8784.6 samples/s | 34.3 steps/s
[Step= 200] | Loss=6.29031 | acc=0.1048 | tpr=0.6372 | fpr=0.9049 | 8919.7 samples/s | 34.8 steps/s
[Step= 250] | Loss=6.29277 | acc=0.1048 | tpr=0.6358 | fpr=0.9049 | 8729.8 samples/s | 34.1 steps/s
[Step= 300] | Loss=6.29249 | acc=0.1050 | tpr=0.6415 | fpr=0.9048 | 8794.0 samples/s | 34.4 steps/s
[Step= 350] | Loss=6.28812 | acc=0.1045 | tpr=0.6399 | fpr=0.9052 | 8872.6 samples/s | 34.7 steps/s
[Step= 400] | Loss=6.28696 | acc=0.1048 | tpr=0.6482 | fpr=0.9050 | 8675.8 samples/s | 33.9 steps/s
[Step= 450] | Loss=6.29523 | acc=0.1044 | tpr=0.6417 | fpr=0.9053 | 9111.6 samples/s | 35.6 steps/s
[Step= 500] | Loss=6.29862 | acc=0.1047 | tpr=0.6445 | fpr=0.9050 | 8963.4 samples/s | 35.0 steps/s
[Step= 550] | Loss=6.30279 | acc=0.1047 | tpr=0.6423 | fpr=0.9051 | 14904.2 samples/s | 58.2 steps/s
Avg test loss: 6.30360, Avg test acc: 0.10462, Avg tpr: 0.64303, Avg fpr: 0.90517, total FA: 125681

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11205 | acc=0.9824 | tpr=0.9425 | fpr=0.0169 | 4546.6 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.11855 | acc=0.9816 | tpr=0.9552 | fpr=0.0179 | 8481.1 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.12275 | acc=0.9806 | tpr=0.9539 | fpr=0.0189 | 8625.2 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.12323 | acc=0.9808 | tpr=0.9563 | fpr=0.0188 | 8990.4 samples/s | 35.1 steps/s
[Step= 250] | Loss=0.12125 | acc=0.9810 | tpr=0.9502 | fpr=0.0184 | 8641.6 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.12309 | acc=0.9808 | tpr=0.9491 | fpr=0.0186 | 8803.2 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.12441 | acc=0.9806 | tpr=0.9505 | fpr=0.0188 | 8601.2 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.12469 | acc=0.9805 | tpr=0.9491 | fpr=0.0190 | 8868.5 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.12769 | acc=0.9800 | tpr=0.9455 | fpr=0.0194 | 8806.4 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.12687 | acc=0.9801 | tpr=0.9471 | fpr=0.0193 | 8784.5 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.12620 | acc=0.9802 | tpr=0.9443 | fpr=0.0192 | 16358.3 samples/s | 63.9 steps/s
Avg test loss: 0.12584, Avg test acc: 0.98017, Avg tpr: 0.94453, Avg fpr: 0.01918, total FA: 2663

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.14090 | acc=0.9786 | tpr=0.9469 | fpr=0.0208 | 4402.0 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.14757 | acc=0.9779 | tpr=0.9574 | fpr=0.0217 | 8858.2 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.15248 | acc=0.9768 | tpr=0.9582 | fpr=0.0229 | 9180.0 samples/s | 35.9 steps/s
[Step= 200] | Loss=0.15293 | acc=0.9769 | tpr=0.9574 | fpr=0.0228 | 8407.5 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.15040 | acc=0.9770 | tpr=0.9546 | fpr=0.0226 | 9544.2 samples/s | 37.3 steps/s
[Step= 300] | Loss=0.15299 | acc=0.9768 | tpr=0.9535 | fpr=0.0228 | 8265.4 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.15426 | acc=0.9765 | tpr=0.9549 | fpr=0.0231 | 8747.1 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.15507 | acc=0.9763 | tpr=0.9551 | fpr=0.0233 | 8929.5 samples/s | 34.9 steps/s
[Step= 450] | Loss=0.15850 | acc=0.9760 | tpr=0.9537 | fpr=0.0236 | 9205.5 samples/s | 36.0 steps/s
[Step= 500] | Loss=0.15809 | acc=0.9760 | tpr=0.9559 | fpr=0.0236 | 8277.4 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.15751 | acc=0.9760 | tpr=0.9534 | fpr=0.0236 | 16146.5 samples/s | 63.1 steps/s
Avg test loss: 0.15708, Avg test acc: 0.97602, Avg tpr: 0.95365, Avg fpr: 0.02357, total FA: 3273

server round 37/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=44001 Epoch=168.6] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.024 | L2-Norm(final)=9.253 | 3803.1 samples/s | 59.4 steps/s
[Step=44050 Epoch=168.8] | Loss=0.00014 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.025 | L2-Norm(final)=9.260 | 5268.7 samples/s | 82.3 steps/s
[Step=44100 Epoch=169.0] | Loss=0.00010 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.026 | L2-Norm(final)=9.264 | 5456.7 samples/s | 85.3 steps/s
[Step=44150 Epoch=169.2] | Loss=0.00011 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.027 | L2-Norm(final)=9.268 | 5168.8 samples/s | 80.8 steps/s
[Step=44200 Epoch=169.4] | Loss=0.00009 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.027 | L2-Norm(final)=9.271 | 5352.8 samples/s | 83.6 steps/s
[Step=44250 Epoch=169.6] | Loss=0.00008 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.027 | L2-Norm(final)=9.274 | 6971.8 samples/s | 108.9 steps/s
[Step=44300 Epoch=169.7] | Loss=0.00008 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.026 | L2-Norm(final)=9.276 | 1889.6 samples/s | 29.5 steps/s
[Step=44350 Epoch=169.9] | Loss=0.00007 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.024 | L2-Norm(final)=9.279 | 5334.0 samples/s | 83.3 steps/s
[Step=44400 Epoch=170.1] | Loss=0.00006 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.023 | L2-Norm(final)=9.281 | 5343.7 samples/s | 83.5 steps/s
[Step=44450 Epoch=170.3] | Loss=0.00006 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.021 | L2-Norm(final)=9.283 | 5409.7 samples/s | 84.5 steps/s
[Step=44500 Epoch=170.5] | Loss=0.00005 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.019 | L2-Norm(final)=9.285 | 5973.8 samples/s | 93.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=44501 Epoch=170.5] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.998 | L2-Norm(final)=9.305 | 3883.0 samples/s | 60.7 steps/s
[Step=44550 Epoch=170.7] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.994 | L2-Norm(final)=9.307 | 4464.8 samples/s | 69.8 steps/s
[Step=44600 Epoch=170.9] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.990 | L2-Norm(final)=9.308 | 4818.0 samples/s | 75.3 steps/s
[Step=44650 Epoch=171.1] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.985 | L2-Norm(final)=9.310 | 4831.6 samples/s | 75.5 steps/s
[Step=44700 Epoch=171.3] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.980 | L2-Norm(final)=9.311 | 4712.9 samples/s | 73.6 steps/s
[Step=44750 Epoch=171.5] | Loss=0.00002 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.975 | L2-Norm(final)=9.313 | 6082.8 samples/s | 95.0 steps/s
[Step=44800 Epoch=171.7] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.969 | L2-Norm(final)=9.314 | 1855.5 samples/s | 29.0 steps/s
[Step=44850 Epoch=171.8] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.964 | L2-Norm(final)=9.315 | 4767.4 samples/s | 74.5 steps/s
[Step=44900 Epoch=172.0] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.959 | L2-Norm(final)=9.316 | 4706.0 samples/s | 73.5 steps/s
[Step=44950 Epoch=172.2] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.953 | L2-Norm(final)=9.318 | 4810.3 samples/s | 75.2 steps/s
[Step=45000 Epoch=172.4] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.947 | L2-Norm(final)=9.319 | 5276.2 samples/s | 82.4 steps/s
[Step=45050 Epoch=172.6] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.941 | L2-Norm(final)=9.320 | 1937.2 samples/s | 30.3 steps/s
[Step=45100 Epoch=172.8] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.935 | L2-Norm(final)=9.321 | 4732.9 samples/s | 74.0 steps/s
[Step=45150 Epoch=173.0] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.929 | L2-Norm(final)=9.321 | 4819.1 samples/s | 75.3 steps/s
[Step=45200 Epoch=173.2] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.923 | L2-Norm(final)=9.322 | 4747.0 samples/s | 74.2 steps/s
[Step=45250 Epoch=173.4] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.917 | L2-Norm(final)=9.323 | 4861.7 samples/s | 76.0 steps/s
[Step=45300 Epoch=173.6] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.910 | L2-Norm(final)=9.324 | 2003.8 samples/s | 31.3 steps/s
[Step=45350 Epoch=173.8] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.904 | L2-Norm(final)=9.325 | 4886.9 samples/s | 76.4 steps/s
[Step=45400 Epoch=174.0] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.898 | L2-Norm(final)=9.326 | 4804.2 samples/s | 75.1 steps/s
[Step=45450 Epoch=174.1] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.891 | L2-Norm(final)=9.327 | 4780.3 samples/s | 74.7 steps/s
[Step=45500 Epoch=174.3] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.884 | L2-Norm(final)=9.327 | 4754.0 samples/s | 74.3 steps/s
[Step=45550 Epoch=174.5] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.878 | L2-Norm(final)=9.328 | 2036.9 samples/s | 31.8 steps/s
[Step=45600 Epoch=174.7] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.871 | L2-Norm(final)=9.329 | 4774.5 samples/s | 74.6 steps/s
[Step=45650 Epoch=174.9] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.864 | L2-Norm(final)=9.330 | 4778.6 samples/s | 74.7 steps/s
[Step=45700 Epoch=175.1] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=9.331 | 4816.9 samples/s | 75.3 steps/s
[Step=45750 Epoch=175.3] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.850 | L2-Norm(final)=9.331 | 4760.5 samples/s | 74.4 steps/s
[Step=45800 Epoch=175.5] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.842 | L2-Norm(final)=9.332 | 6502.6 samples/s | 101.6 steps/s
[Step=45850 Epoch=175.7] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.835 | L2-Norm(final)=9.333 | 1822.4 samples/s | 28.5 steps/s
[Step=45900 Epoch=175.9] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.828 | L2-Norm(final)=9.334 | 4774.3 samples/s | 74.6 steps/s
[Step=45950 Epoch=176.1] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.820 | L2-Norm(final)=9.335 | 4805.5 samples/s | 75.1 steps/s
[Step=46000 Epoch=176.3] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.813 | L2-Norm(final)=9.335 | 4877.0 samples/s | 76.2 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step46000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=40001 Epoch=154.0] | Loss=0.00029 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.024 | L2-Norm(final)=8.101 | 3711.7 samples/s | 58.0 steps/s
[Step=40050 Epoch=154.2] | Loss=0.00010 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.019 | L2-Norm(final)=8.112 | 5305.9 samples/s | 82.9 steps/s
[Step=40100 Epoch=154.4] | Loss=0.00014 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.023 | L2-Norm(final)=8.127 | 5289.5 samples/s | 82.6 steps/s
[Step=40150 Epoch=154.6] | Loss=0.00011 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.028 | L2-Norm(final)=8.139 | 5343.7 samples/s | 83.5 steps/s
[Step=40200 Epoch=154.7] | Loss=0.00009 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.028 | L2-Norm(final)=8.147 | 5337.1 samples/s | 83.4 steps/s
[Step=40250 Epoch=154.9] | Loss=0.00009 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.027 | L2-Norm(final)=8.155 | 7006.3 samples/s | 109.5 steps/s
[Step=40300 Epoch=155.1] | Loss=0.00008 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.025 | L2-Norm(final)=8.163 | 1913.3 samples/s | 29.9 steps/s
[Step=40350 Epoch=155.3] | Loss=0.00007 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.022 | L2-Norm(final)=8.169 | 5308.3 samples/s | 82.9 steps/s
[Step=40400 Epoch=155.5] | Loss=0.00006 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.018 | L2-Norm(final)=8.175 | 5424.0 samples/s | 84.8 steps/s
[Step=40450 Epoch=155.7] | Loss=0.00006 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.013 | L2-Norm(final)=8.180 | 5298.1 samples/s | 82.8 steps/s
[Step=40500 Epoch=155.9] | Loss=0.00006 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.008 | L2-Norm(final)=8.185 | 6163.2 samples/s | 96.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=40501 Epoch=155.9] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=8.233 | 3895.4 samples/s | 60.9 steps/s
[Step=40550 Epoch=156.1] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.938 | L2-Norm(final)=8.237 | 4577.8 samples/s | 71.5 steps/s
[Step=40600 Epoch=156.3] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.915 | L2-Norm(final)=8.239 | 4749.4 samples/s | 74.2 steps/s
[Step=40650 Epoch=156.5] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.891 | L2-Norm(final)=8.241 | 4810.1 samples/s | 75.2 steps/s
[Step=40700 Epoch=156.7] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.867 | L2-Norm(final)=8.242 | 4733.8 samples/s | 74.0 steps/s
[Step=40750 Epoch=156.9] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.843 | L2-Norm(final)=8.244 | 6044.8 samples/s | 94.5 steps/s
[Step=40800 Epoch=157.1] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.818 | L2-Norm(final)=8.246 | 1868.4 samples/s | 29.2 steps/s
[Step=40850 Epoch=157.2] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.793 | L2-Norm(final)=8.247 | 4744.3 samples/s | 74.1 steps/s
[Step=40900 Epoch=157.4] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.768 | L2-Norm(final)=8.248 | 4817.1 samples/s | 75.3 steps/s
[Step=40950 Epoch=157.6] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.742 | L2-Norm(final)=8.249 | 4835.4 samples/s | 75.6 steps/s
[Step=41000 Epoch=157.8] | Loss=0.00000 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.716 | L2-Norm(final)=8.250 | 5409.3 samples/s | 84.5 steps/s
[Step=41050 Epoch=158.0] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.690 | L2-Norm(final)=8.250 | 1947.1 samples/s | 30.4 steps/s
[Step=41100 Epoch=158.2] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.664 | L2-Norm(final)=8.251 | 4798.5 samples/s | 75.0 steps/s
[Step=41150 Epoch=158.4] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.637 | L2-Norm(final)=8.252 | 4825.1 samples/s | 75.4 steps/s
[Step=41200 Epoch=158.6] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.610 | L2-Norm(final)=8.253 | 4700.4 samples/s | 73.4 steps/s
[Step=41250 Epoch=158.8] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.583 | L2-Norm(final)=8.254 | 4891.4 samples/s | 76.4 steps/s
[Step=41300 Epoch=159.0] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.556 | L2-Norm(final)=8.255 | 2009.0 samples/s | 31.4 steps/s
[Step=41350 Epoch=159.2] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.529 | L2-Norm(final)=8.255 | 4845.9 samples/s | 75.7 steps/s
[Step=41400 Epoch=159.4] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.502 | L2-Norm(final)=8.256 | 4797.3 samples/s | 75.0 steps/s
[Step=41450 Epoch=159.6] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.474 | L2-Norm(final)=8.257 | 4787.5 samples/s | 74.8 steps/s
[Step=41500 Epoch=159.7] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.446 | L2-Norm(final)=8.258 | 4836.5 samples/s | 75.6 steps/s
[Step=41550 Epoch=159.9] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.418 | L2-Norm(final)=8.259 | 2040.4 samples/s | 31.9 steps/s
[Step=41600 Epoch=160.1] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.390 | L2-Norm(final)=8.260 | 4818.2 samples/s | 75.3 steps/s
[Step=41650 Epoch=160.3] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.362 | L2-Norm(final)=8.261 | 4837.4 samples/s | 75.6 steps/s
[Step=41700 Epoch=160.5] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.334 | L2-Norm(final)=8.262 | 4701.9 samples/s | 73.5 steps/s
[Step=41750 Epoch=160.7] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.306 | L2-Norm(final)=8.263 | 4869.7 samples/s | 76.1 steps/s
[Step=41800 Epoch=160.9] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.277 | L2-Norm(final)=8.264 | 6956.6 samples/s | 108.7 steps/s
[Step=41850 Epoch=161.1] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.248 | L2-Norm(final)=8.265 | 1782.2 samples/s | 27.8 steps/s
[Step=41900 Epoch=161.3] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.219 | L2-Norm(final)=8.266 | 4776.7 samples/s | 74.6 steps/s
[Step=41950 Epoch=161.5] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.191 | L2-Norm(final)=8.267 | 4788.7 samples/s | 74.8 steps/s
[Step=42000 Epoch=161.7] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.161 | L2-Norm(final)=8.268 | 4872.8 samples/s | 76.1 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step42000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06060 | acc=0.9691 | tpr=0.9749 | fpr=0.0434 | 4462.8 samples/s | 17.4 steps/s
Avg test loss: 0.06453, Avg test acc: 0.96823, Avg tpr: 0.97331, Avg fpr: 0.04294, total FA: 335

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06181 | acc=0.9713 | tpr=0.9823 | fpr=0.0525 | 4468.3 samples/s | 17.5 steps/s
Avg test loss: 0.06823, Avg test acc: 0.97007, Avg tpr: 0.98187, Avg fpr: 0.05589, total FA: 436

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.01747 | acc=0.3152 | tpr=0.0427 | fpr=0.0932 | 4490.4 samples/s | 17.5 steps/s
Avg test loss: 5.01460, Avg test acc: 0.31529, Avg tpr: 0.04529, Avg fpr: 0.09089, total FA: 709

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.35417 | acc=0.3062 | tpr=0.0388 | fpr=0.1132 | 4431.0 samples/s | 17.3 steps/s
Avg test loss: 5.34973, Avg test acc: 0.30543, Avg tpr: 0.03946, Avg fpr: 0.10960, total FA: 855

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.40052 | acc=0.1373 | tpr=0.5398 | fpr=0.8699 | 4577.7 samples/s | 17.9 steps/s
[Step= 100] | Loss=5.37958 | acc=0.1371 | tpr=0.5160 | fpr=0.8699 | 8326.0 samples/s | 32.5 steps/s
[Step= 150] | Loss=5.38914 | acc=0.1371 | tpr=0.5130 | fpr=0.8698 | 8721.2 samples/s | 34.1 steps/s
[Step= 200] | Loss=5.38110 | acc=0.1361 | tpr=0.5038 | fpr=0.8706 | 8782.3 samples/s | 34.3 steps/s
[Step= 250] | Loss=5.38252 | acc=0.1361 | tpr=0.5118 | fpr=0.8708 | 8789.6 samples/s | 34.3 steps/s
[Step= 300] | Loss=5.38073 | acc=0.1364 | tpr=0.5215 | fpr=0.8706 | 9150.3 samples/s | 35.7 steps/s
[Step= 350] | Loss=5.37789 | acc=0.1363 | tpr=0.5235 | fpr=0.8708 | 8483.2 samples/s | 33.1 steps/s
[Step= 400] | Loss=5.37640 | acc=0.1363 | tpr=0.5252 | fpr=0.8708 | 8671.5 samples/s | 33.9 steps/s
[Step= 450] | Loss=5.38582 | acc=0.1363 | tpr=0.5195 | fpr=0.8707 | 8973.0 samples/s | 35.1 steps/s
[Step= 500] | Loss=5.38916 | acc=0.1364 | tpr=0.5229 | fpr=0.8705 | 8921.0 samples/s | 34.8 steps/s
[Step= 550] | Loss=5.39370 | acc=0.1365 | tpr=0.5233 | fpr=0.8705 | 14948.4 samples/s | 58.4 steps/s
Avg test loss: 5.39470, Avg test acc: 0.13641, Avg tpr: 0.52417, Avg fpr: 0.87064, total FA: 120887

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.30144 | acc=0.1059 | tpr=0.6726 | fpr=0.9043 | 4486.2 samples/s | 17.5 steps/s
[Step= 100] | Loss=6.27938 | acc=0.1067 | tpr=0.6567 | fpr=0.9036 | 8786.6 samples/s | 34.3 steps/s
[Step= 150] | Loss=6.29451 | acc=0.1059 | tpr=0.6513 | fpr=0.9041 | 8593.6 samples/s | 33.6 steps/s
[Step= 200] | Loss=6.29031 | acc=0.1048 | tpr=0.6372 | fpr=0.9049 | 8969.6 samples/s | 35.0 steps/s
[Step= 250] | Loss=6.29277 | acc=0.1048 | tpr=0.6358 | fpr=0.9049 | 8741.5 samples/s | 34.1 steps/s
[Step= 300] | Loss=6.29249 | acc=0.1050 | tpr=0.6415 | fpr=0.9048 | 8789.4 samples/s | 34.3 steps/s
[Step= 350] | Loss=6.28812 | acc=0.1045 | tpr=0.6399 | fpr=0.9052 | 9081.6 samples/s | 35.5 steps/s
[Step= 400] | Loss=6.28696 | acc=0.1048 | tpr=0.6482 | fpr=0.9050 | 8544.0 samples/s | 33.4 steps/s
[Step= 450] | Loss=6.29523 | acc=0.1044 | tpr=0.6417 | fpr=0.9053 | 8907.9 samples/s | 34.8 steps/s
[Step= 500] | Loss=6.29862 | acc=0.1047 | tpr=0.6445 | fpr=0.9050 | 8603.3 samples/s | 33.6 steps/s
[Step= 550] | Loss=6.30279 | acc=0.1047 | tpr=0.6423 | fpr=0.9051 | 16202.9 samples/s | 63.3 steps/s
Avg test loss: 6.30360, Avg test acc: 0.10462, Avg tpr: 0.64303, Avg fpr: 0.90517, total FA: 125681

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12429 | acc=0.9809 | tpr=0.9381 | fpr=0.0184 | 4448.6 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.13167 | acc=0.9798 | tpr=0.9531 | fpr=0.0197 | 9086.8 samples/s | 35.5 steps/s
[Step= 150] | Loss=0.13611 | acc=0.9788 | tpr=0.9510 | fpr=0.0207 | 9110.0 samples/s | 35.6 steps/s
[Step= 200] | Loss=0.13615 | acc=0.9791 | tpr=0.9519 | fpr=0.0204 | 8193.4 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.13402 | acc=0.9792 | tpr=0.9467 | fpr=0.0202 | 8900.1 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.13646 | acc=0.9790 | tpr=0.9469 | fpr=0.0204 | 8684.4 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.13743 | acc=0.9789 | tpr=0.9499 | fpr=0.0206 | 8665.4 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.13796 | acc=0.9786 | tpr=0.9486 | fpr=0.0208 | 9221.4 samples/s | 36.0 steps/s
[Step= 450] | Loss=0.14122 | acc=0.9782 | tpr=0.9460 | fpr=0.0212 | 8696.2 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.14045 | acc=0.9784 | tpr=0.9480 | fpr=0.0211 | 8698.2 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.13985 | acc=0.9784 | tpr=0.9467 | fpr=0.0210 | 15188.7 samples/s | 59.3 steps/s
Avg test loss: 0.13946, Avg test acc: 0.97841, Avg tpr: 0.94691, Avg fpr: 0.02102, total FA: 2918

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13542 | acc=0.9783 | tpr=0.9469 | fpr=0.0212 | 4455.0 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.14100 | acc=0.9777 | tpr=0.9616 | fpr=0.0220 | 9019.2 samples/s | 35.2 steps/s
[Step= 150] | Loss=0.14585 | acc=0.9768 | tpr=0.9597 | fpr=0.0229 | 8808.6 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.14591 | acc=0.9771 | tpr=0.9607 | fpr=0.0226 | 8447.9 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.14321 | acc=0.9772 | tpr=0.9590 | fpr=0.0224 | 8748.6 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.14554 | acc=0.9770 | tpr=0.9585 | fpr=0.0226 | 8773.3 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.14694 | acc=0.9768 | tpr=0.9593 | fpr=0.0229 | 8904.7 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.14765 | acc=0.9765 | tpr=0.9584 | fpr=0.0231 | 8773.8 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.15091 | acc=0.9763 | tpr=0.9572 | fpr=0.0234 | 8734.5 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.15064 | acc=0.9763 | tpr=0.9586 | fpr=0.0234 | 9008.3 samples/s | 35.2 steps/s
[Step= 550] | Loss=0.14997 | acc=0.9764 | tpr=0.9570 | fpr=0.0233 | 15609.9 samples/s | 61.0 steps/s
Avg test loss: 0.14959, Avg test acc: 0.97641, Avg tpr: 0.95721, Avg fpr: 0.02324, total FA: 3227

server round 38/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=46001 Epoch=176.3] | Loss=0.00015 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.712 | L2-Norm(final)=9.359 | 4142.4 samples/s | 64.7 steps/s
[Step=46050 Epoch=176.4] | Loss=0.00138 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.721 | L2-Norm(final)=9.359 | 4608.5 samples/s | 72.0 steps/s
[Step=46100 Epoch=176.6] | Loss=0.00079 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.741 | L2-Norm(final)=9.360 | 5375.0 samples/s | 84.0 steps/s
[Step=46150 Epoch=176.8] | Loss=0.00061 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.749 | L2-Norm(final)=9.363 | 5288.2 samples/s | 82.6 steps/s
[Step=46200 Epoch=177.0] | Loss=0.00048 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.753 | L2-Norm(final)=9.366 | 5423.0 samples/s | 84.7 steps/s
[Step=46250 Epoch=177.2] | Loss=0.00040 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.756 | L2-Norm(final)=9.368 | 6802.9 samples/s | 106.3 steps/s
[Step=46300 Epoch=177.4] | Loss=0.00034 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.757 | L2-Norm(final)=9.371 | 1961.8 samples/s | 30.7 steps/s
[Step=46350 Epoch=177.6] | Loss=0.00030 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.758 | L2-Norm(final)=9.373 | 5304.2 samples/s | 82.9 steps/s
[Step=46400 Epoch=177.8] | Loss=0.00027 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.758 | L2-Norm(final)=9.375 | 5355.0 samples/s | 83.7 steps/s
[Step=46450 Epoch=178.0] | Loss=0.00025 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.758 | L2-Norm(final)=9.376 | 5367.4 samples/s | 83.9 steps/s
[Step=46500 Epoch=178.2] | Loss=0.00022 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.758 | L2-Norm(final)=9.378 | 5951.3 samples/s | 93.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=46501 Epoch=178.2] | Loss=0.00006 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.755 | L2-Norm(final)=9.396 | 3754.1 samples/s | 58.7 steps/s
[Step=46550 Epoch=178.4] | Loss=0.00005 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.751 | L2-Norm(final)=9.398 | 4619.3 samples/s | 72.2 steps/s
[Step=46600 Epoch=178.6] | Loss=0.00003 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.746 | L2-Norm(final)=9.399 | 4818.2 samples/s | 75.3 steps/s
[Step=46650 Epoch=178.7] | Loss=0.00003 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.740 | L2-Norm(final)=9.400 | 4757.3 samples/s | 74.3 steps/s
[Step=46700 Epoch=178.9] | Loss=0.00002 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.734 | L2-Norm(final)=9.401 | 4826.8 samples/s | 75.4 steps/s
[Step=46750 Epoch=179.1] | Loss=0.00002 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.727 | L2-Norm(final)=9.402 | 6015.4 samples/s | 94.0 steps/s
[Step=46800 Epoch=179.3] | Loss=0.00002 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.721 | L2-Norm(final)=9.402 | 1857.7 samples/s | 29.0 steps/s
[Step=46850 Epoch=179.5] | Loss=0.00002 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.714 | L2-Norm(final)=9.403 | 4808.8 samples/s | 75.1 steps/s
[Step=46900 Epoch=179.7] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.706 | L2-Norm(final)=9.403 | 4815.8 samples/s | 75.2 steps/s
[Step=46950 Epoch=179.9] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.699 | L2-Norm(final)=9.404 | 4719.9 samples/s | 73.7 steps/s
[Step=47000 Epoch=180.1] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.691 | L2-Norm(final)=9.404 | 5285.5 samples/s | 82.6 steps/s
[Step=47050 Epoch=180.3] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.684 | L2-Norm(final)=9.404 | 1972.7 samples/s | 30.8 steps/s
[Step=47100 Epoch=180.5] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.676 | L2-Norm(final)=9.405 | 4682.3 samples/s | 73.2 steps/s
[Step=47150 Epoch=180.7] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.668 | L2-Norm(final)=9.405 | 4820.2 samples/s | 75.3 steps/s
[Step=47200 Epoch=180.9] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.660 | L2-Norm(final)=9.405 | 4769.7 samples/s | 74.5 steps/s
[Step=47250 Epoch=181.0] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.651 | L2-Norm(final)=9.406 | 4782.8 samples/s | 74.7 steps/s
[Step=47300 Epoch=181.2] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.643 | L2-Norm(final)=9.406 | 2007.2 samples/s | 31.4 steps/s
[Step=47350 Epoch=181.4] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.634 | L2-Norm(final)=9.406 | 4792.5 samples/s | 74.9 steps/s
[Step=47400 Epoch=181.6] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=9.407 | 4812.0 samples/s | 75.2 steps/s
[Step=47450 Epoch=181.8] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.617 | L2-Norm(final)=9.407 | 4823.3 samples/s | 75.4 steps/s
[Step=47500 Epoch=182.0] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.608 | L2-Norm(final)=9.407 | 4750.6 samples/s | 74.2 steps/s
[Step=47550 Epoch=182.2] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.599 | L2-Norm(final)=9.408 | 2034.3 samples/s | 31.8 steps/s
[Step=47600 Epoch=182.4] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.590 | L2-Norm(final)=9.408 | 4773.3 samples/s | 74.6 steps/s
[Step=47650 Epoch=182.6] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.581 | L2-Norm(final)=9.408 | 4771.8 samples/s | 74.6 steps/s
[Step=47700 Epoch=182.8] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.571 | L2-Norm(final)=9.408 | 4788.6 samples/s | 74.8 steps/s
[Step=47750 Epoch=183.0] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.562 | L2-Norm(final)=9.409 | 4748.2 samples/s | 74.2 steps/s
[Step=47800 Epoch=183.2] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.552 | L2-Norm(final)=9.409 | 6562.7 samples/s | 102.5 steps/s
[Step=47850 Epoch=183.3] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.542 | L2-Norm(final)=9.409 | 1835.0 samples/s | 28.7 steps/s
[Step=47900 Epoch=183.5] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.532 | L2-Norm(final)=9.410 | 4766.1 samples/s | 74.5 steps/s
[Step=47950 Epoch=183.7] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.522 | L2-Norm(final)=9.410 | 4786.3 samples/s | 74.8 steps/s
[Step=48000 Epoch=183.9] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.512 | L2-Norm(final)=9.410 | 4745.3 samples/s | 74.1 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step48000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=42001 Epoch=161.7] | Loss=0.00009 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.712 | L2-Norm(final)=8.301 | 3861.3 samples/s | 60.3 steps/s
[Step=42050 Epoch=161.9] | Loss=0.00036 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.717 | L2-Norm(final)=8.313 | 4948.2 samples/s | 77.3 steps/s
[Step=42100 Epoch=162.1] | Loss=0.00021 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.732 | L2-Norm(final)=8.323 | 5410.0 samples/s | 84.5 steps/s
[Step=42150 Epoch=162.3] | Loss=0.00017 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.738 | L2-Norm(final)=8.330 | 5305.7 samples/s | 82.9 steps/s
[Step=42200 Epoch=162.4] | Loss=0.00014 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.740 | L2-Norm(final)=8.335 | 5314.0 samples/s | 83.0 steps/s
[Step=42250 Epoch=162.6] | Loss=0.00013 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.740 | L2-Norm(final)=8.340 | 7121.8 samples/s | 111.3 steps/s
[Step=42300 Epoch=162.8] | Loss=0.00011 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.739 | L2-Norm(final)=8.345 | 1906.1 samples/s | 29.8 steps/s
[Step=42350 Epoch=163.0] | Loss=0.00010 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.738 | L2-Norm(final)=8.349 | 5455.9 samples/s | 85.2 steps/s
[Step=42400 Epoch=163.2] | Loss=0.00009 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.736 | L2-Norm(final)=8.353 | 5331.0 samples/s | 83.3 steps/s
[Step=42450 Epoch=163.4] | Loss=0.00008 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.733 | L2-Norm(final)=8.356 | 5205.7 samples/s | 81.3 steps/s
[Step=42500 Epoch=163.6] | Loss=0.00008 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.731 | L2-Norm(final)=8.360 | 6197.9 samples/s | 96.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=42501 Epoch=163.6] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.701 | L2-Norm(final)=8.392 | 3619.0 samples/s | 56.5 steps/s
[Step=42550 Epoch=163.8] | Loss=0.00179 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.693 | L2-Norm(final)=8.395 | 4878.9 samples/s | 76.2 steps/s
[Step=42600 Epoch=164.0] | Loss=0.00144 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=8.394 | 4785.2 samples/s | 74.8 steps/s
[Step=42650 Epoch=164.2] | Loss=0.00098 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.713 | L2-Norm(final)=8.393 | 4808.6 samples/s | 75.1 steps/s
[Step=42700 Epoch=164.4] | Loss=0.00076 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.717 | L2-Norm(final)=8.393 | 4742.6 samples/s | 74.1 steps/s
[Step=42750 Epoch=164.6] | Loss=0.00062 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.719 | L2-Norm(final)=8.394 | 6169.0 samples/s | 96.4 steps/s
[Step=42800 Epoch=164.8] | Loss=0.00052 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.719 | L2-Norm(final)=8.394 | 1874.0 samples/s | 29.3 steps/s
[Step=42850 Epoch=164.9] | Loss=0.00044 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.719 | L2-Norm(final)=8.395 | 4800.4 samples/s | 75.0 steps/s
[Step=42900 Epoch=165.1] | Loss=0.00039 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.719 | L2-Norm(final)=8.395 | 4800.1 samples/s | 75.0 steps/s
[Step=42950 Epoch=165.3] | Loss=0.00035 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.718 | L2-Norm(final)=8.396 | 4764.6 samples/s | 74.4 steps/s
[Step=43000 Epoch=165.5] | Loss=0.00031 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.717 | L2-Norm(final)=8.396 | 5389.5 samples/s | 84.2 steps/s
[Step=43050 Epoch=165.7] | Loss=0.00029 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.715 | L2-Norm(final)=8.396 | 1946.2 samples/s | 30.4 steps/s
[Step=43100 Epoch=165.9] | Loss=0.00026 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.714 | L2-Norm(final)=8.397 | 4793.0 samples/s | 74.9 steps/s
[Step=43150 Epoch=166.1] | Loss=0.00024 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.712 | L2-Norm(final)=8.397 | 4715.4 samples/s | 73.7 steps/s
[Step=43200 Epoch=166.3] | Loss=0.00023 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.710 | L2-Norm(final)=8.398 | 4789.7 samples/s | 74.8 steps/s
[Step=43250 Epoch=166.5] | Loss=0.00021 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.709 | L2-Norm(final)=8.398 | 4883.5 samples/s | 76.3 steps/s
[Step=43300 Epoch=166.7] | Loss=0.00020 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.707 | L2-Norm(final)=8.398 | 2006.6 samples/s | 31.4 steps/s
[Step=43350 Epoch=166.9] | Loss=0.00019 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=8.399 | 4866.4 samples/s | 76.0 steps/s
[Step=43400 Epoch=167.1] | Loss=0.00018 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.703 | L2-Norm(final)=8.399 | 4783.4 samples/s | 74.7 steps/s
[Step=43450 Epoch=167.3] | Loss=0.00017 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.701 | L2-Norm(final)=8.399 | 4831.3 samples/s | 75.5 steps/s
[Step=43500 Epoch=167.4] | Loss=0.00016 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.698 | L2-Norm(final)=8.399 | 4778.4 samples/s | 74.7 steps/s
[Step=43550 Epoch=167.6] | Loss=0.00015 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.696 | L2-Norm(final)=8.400 | 2041.9 samples/s | 31.9 steps/s
[Step=43600 Epoch=167.8] | Loss=0.00015 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.694 | L2-Norm(final)=8.400 | 4810.5 samples/s | 75.2 steps/s
[Step=43650 Epoch=168.0] | Loss=0.00014 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.692 | L2-Norm(final)=8.400 | 4756.4 samples/s | 74.3 steps/s
[Step=43700 Epoch=168.2] | Loss=0.00013 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.689 | L2-Norm(final)=8.401 | 4801.4 samples/s | 75.0 steps/s
[Step=43750 Epoch=168.4] | Loss=0.00013 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.687 | L2-Norm(final)=8.401 | 4791.8 samples/s | 74.9 steps/s
[Step=43800 Epoch=168.6] | Loss=0.00012 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.684 | L2-Norm(final)=8.401 | 6905.3 samples/s | 107.9 steps/s
[Step=43850 Epoch=168.8] | Loss=0.00012 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.682 | L2-Norm(final)=8.401 | 1787.0 samples/s | 27.9 steps/s
[Step=43900 Epoch=169.0] | Loss=0.00012 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.679 | L2-Norm(final)=8.402 | 4847.1 samples/s | 75.7 steps/s
[Step=43950 Epoch=169.2] | Loss=0.00011 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.677 | L2-Norm(final)=8.402 | 4693.5 samples/s | 73.3 steps/s
[Step=44000 Epoch=169.4] | Loss=0.00011 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.674 | L2-Norm(final)=8.402 | 4830.4 samples/s | 75.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step44000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06060 | acc=0.9691 | tpr=0.9749 | fpr=0.0434 | 4526.4 samples/s | 17.7 steps/s
Avg test loss: 0.06453, Avg test acc: 0.96823, Avg tpr: 0.97331, Avg fpr: 0.04294, total FA: 335

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06181 | acc=0.9713 | tpr=0.9823 | fpr=0.0525 | 4483.6 samples/s | 17.5 steps/s
Avg test loss: 0.06823, Avg test acc: 0.97007, Avg tpr: 0.98187, Avg fpr: 0.05589, total FA: 436

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.16122 | acc=0.3180 | tpr=0.0391 | fpr=0.0766 | 4469.4 samples/s | 17.5 steps/s
Avg test loss: 5.16243, Avg test acc: 0.31673, Avg tpr: 0.04010, Avg fpr: 0.07486, total FA: 584

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.74627 | acc=0.3115 | tpr=0.0456 | fpr=0.1112 | 4496.1 samples/s | 17.6 steps/s
Avg test loss: 5.74718, Avg test acc: 0.31068, Avg tpr: 0.04616, Avg fpr: 0.10755, total FA: 839

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.40052 | acc=0.1373 | tpr=0.5398 | fpr=0.8699 | 4504.7 samples/s | 17.6 steps/s
[Step= 100] | Loss=5.37958 | acc=0.1371 | tpr=0.5160 | fpr=0.8699 | 8651.7 samples/s | 33.8 steps/s
[Step= 150] | Loss=5.38914 | acc=0.1371 | tpr=0.5130 | fpr=0.8698 | 8868.7 samples/s | 34.6 steps/s
[Step= 200] | Loss=5.38110 | acc=0.1361 | tpr=0.5038 | fpr=0.8706 | 8866.4 samples/s | 34.6 steps/s
[Step= 250] | Loss=5.38252 | acc=0.1361 | tpr=0.5118 | fpr=0.8708 | 8597.1 samples/s | 33.6 steps/s
[Step= 300] | Loss=5.38073 | acc=0.1364 | tpr=0.5215 | fpr=0.8706 | 8737.2 samples/s | 34.1 steps/s
[Step= 350] | Loss=5.37789 | acc=0.1363 | tpr=0.5235 | fpr=0.8708 | 8728.7 samples/s | 34.1 steps/s
[Step= 400] | Loss=5.37640 | acc=0.1363 | tpr=0.5252 | fpr=0.8708 | 8710.6 samples/s | 34.0 steps/s
[Step= 450] | Loss=5.38582 | acc=0.1363 | tpr=0.5195 | fpr=0.8707 | 8739.6 samples/s | 34.1 steps/s
[Step= 500] | Loss=5.38916 | acc=0.1364 | tpr=0.5229 | fpr=0.8705 | 9004.7 samples/s | 35.2 steps/s
[Step= 550] | Loss=5.39370 | acc=0.1365 | tpr=0.5233 | fpr=0.8705 | 15371.8 samples/s | 60.0 steps/s
Avg test loss: 5.39470, Avg test acc: 0.13641, Avg tpr: 0.52417, Avg fpr: 0.87064, total FA: 120887

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.30144 | acc=0.1059 | tpr=0.6726 | fpr=0.9043 | 4480.3 samples/s | 17.5 steps/s
[Step= 100] | Loss=6.27938 | acc=0.1067 | tpr=0.6567 | fpr=0.9036 | 8698.5 samples/s | 34.0 steps/s
[Step= 150] | Loss=6.29451 | acc=0.1059 | tpr=0.6513 | fpr=0.9041 | 8806.6 samples/s | 34.4 steps/s
[Step= 200] | Loss=6.29031 | acc=0.1048 | tpr=0.6372 | fpr=0.9049 | 8843.1 samples/s | 34.5 steps/s
[Step= 250] | Loss=6.29277 | acc=0.1048 | tpr=0.6358 | fpr=0.9049 | 9062.8 samples/s | 35.4 steps/s
[Step= 300] | Loss=6.29249 | acc=0.1050 | tpr=0.6415 | fpr=0.9048 | 8911.7 samples/s | 34.8 steps/s
[Step= 350] | Loss=6.28812 | acc=0.1045 | tpr=0.6399 | fpr=0.9052 | 8499.7 samples/s | 33.2 steps/s
[Step= 400] | Loss=6.28696 | acc=0.1048 | tpr=0.6482 | fpr=0.9050 | 8890.4 samples/s | 34.7 steps/s
[Step= 450] | Loss=6.29523 | acc=0.1044 | tpr=0.6417 | fpr=0.9053 | 8519.1 samples/s | 33.3 steps/s
[Step= 500] | Loss=6.29862 | acc=0.1047 | tpr=0.6445 | fpr=0.9050 | 9023.6 samples/s | 35.2 steps/s
[Step= 550] | Loss=6.30279 | acc=0.1047 | tpr=0.6423 | fpr=0.9051 | 15650.9 samples/s | 61.1 steps/s
Avg test loss: 6.30360, Avg test acc: 0.10462, Avg tpr: 0.64303, Avg fpr: 0.90517, total FA: 125681

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12229 | acc=0.9808 | tpr=0.9336 | fpr=0.0184 | 4460.5 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.12875 | acc=0.9799 | tpr=0.9488 | fpr=0.0195 | 9124.8 samples/s | 35.6 steps/s
[Step= 150] | Loss=0.13330 | acc=0.9792 | tpr=0.9510 | fpr=0.0203 | 8826.9 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.13336 | acc=0.9796 | tpr=0.9519 | fpr=0.0199 | 8784.3 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.13113 | acc=0.9798 | tpr=0.9467 | fpr=0.0196 | 8569.1 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.13339 | acc=0.9796 | tpr=0.9462 | fpr=0.0197 | 8826.1 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.13444 | acc=0.9795 | tpr=0.9487 | fpr=0.0199 | 8792.5 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.13490 | acc=0.9793 | tpr=0.9475 | fpr=0.0202 | 9300.0 samples/s | 36.3 steps/s
[Step= 450] | Loss=0.13808 | acc=0.9789 | tpr=0.9450 | fpr=0.0204 | 8306.5 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.13742 | acc=0.9791 | tpr=0.9467 | fpr=0.0204 | 8778.2 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.13684 | acc=0.9791 | tpr=0.9451 | fpr=0.0203 | 15784.1 samples/s | 61.7 steps/s
Avg test loss: 0.13649, Avg test acc: 0.97913, Avg tpr: 0.94532, Avg fpr: 0.02026, total FA: 2813

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13315 | acc=0.9799 | tpr=0.9469 | fpr=0.0195 | 4479.1 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.13820 | acc=0.9793 | tpr=0.9659 | fpr=0.0205 | 8529.5 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.14269 | acc=0.9782 | tpr=0.9625 | fpr=0.0216 | 8742.2 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.14329 | acc=0.9784 | tpr=0.9617 | fpr=0.0213 | 8929.4 samples/s | 34.9 steps/s
[Step= 250] | Loss=0.14112 | acc=0.9785 | tpr=0.9572 | fpr=0.0211 | 8722.1 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.14366 | acc=0.9782 | tpr=0.9571 | fpr=0.0214 | 8763.8 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.14510 | acc=0.9781 | tpr=0.9580 | fpr=0.0216 | 8793.7 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.14563 | acc=0.9779 | tpr=0.9579 | fpr=0.0218 | 9246.2 samples/s | 36.1 steps/s
[Step= 450] | Loss=0.14878 | acc=0.9776 | tpr=0.9562 | fpr=0.0221 | 8519.5 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.14844 | acc=0.9775 | tpr=0.9564 | fpr=0.0221 | 8850.2 samples/s | 34.6 steps/s
[Step= 550] | Loss=0.14779 | acc=0.9776 | tpr=0.9562 | fpr=0.0220 | 15003.9 samples/s | 58.6 steps/s
Avg test loss: 0.14739, Avg test acc: 0.97764, Avg tpr: 0.95602, Avg fpr: 0.02197, total FA: 3050

server round 39/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=28001 Epoch=54.6] | Loss=0.00583 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.958 | L2-Norm(final)=7.484 | 3828.9 samples/s | 59.8 steps/s
[Step=28050 Epoch=54.7] | Loss=0.01268 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.965 | L2-Norm(final)=7.488 | 5253.6 samples/s | 82.1 steps/s
[Step=28100 Epoch=54.8] | Loss=0.01254 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.971 | L2-Norm(final)=7.492 | 5622.1 samples/s | 87.8 steps/s
[Step=28150 Epoch=54.9] | Loss=0.01204 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.976 | L2-Norm(final)=7.497 | 5547.5 samples/s | 86.7 steps/s
[Step=28200 Epoch=55.0] | Loss=0.01125 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.981 | L2-Norm(final)=7.503 | 5654.1 samples/s | 88.3 steps/s
[Step=28250 Epoch=55.1] | Loss=0.01084 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.986 | L2-Norm(final)=7.509 | 5833.0 samples/s | 91.1 steps/s
[Step=28300 Epoch=55.2] | Loss=0.01115 | Reg=0.00121 | acc=0.9844 | L2-Norm=10.992 | L2-Norm(final)=7.515 | 5520.1 samples/s | 86.3 steps/s
[Step=28350 Epoch=55.3] | Loss=0.01110 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.997 | L2-Norm(final)=7.521 | 5662.7 samples/s | 88.5 steps/s
[Step=28400 Epoch=55.4] | Loss=0.01079 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.002 | L2-Norm(final)=7.527 | 5693.8 samples/s | 89.0 steps/s
[Step=28450 Epoch=55.5] | Loss=0.01047 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.007 | L2-Norm(final)=7.533 | 5668.9 samples/s | 88.6 steps/s
[Step=28500 Epoch=55.6] | Loss=0.01021 | Reg=0.00121 | acc=0.9844 | L2-Norm=11.012 | L2-Norm(final)=7.538 | 7155.1 samples/s | 111.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=28501 Epoch=55.6] | Loss=0.00325 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.059 | L2-Norm(final)=7.600 | 3466.0 samples/s | 54.2 steps/s
[Step=28550 Epoch=55.7] | Loss=0.01027 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.066 | L2-Norm(final)=7.606 | 5012.4 samples/s | 78.3 steps/s
[Step=28600 Epoch=55.8] | Loss=0.01018 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.075 | L2-Norm(final)=7.611 | 5026.8 samples/s | 78.5 steps/s
[Step=28650 Epoch=55.9] | Loss=0.01025 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.083 | L2-Norm(final)=7.616 | 5016.7 samples/s | 78.4 steps/s
[Step=28700 Epoch=56.0] | Loss=0.01058 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.089 | L2-Norm(final)=7.620 | 5043.9 samples/s | 78.8 steps/s
[Step=28750 Epoch=56.1] | Loss=0.01021 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.096 | L2-Norm(final)=7.624 | 5052.4 samples/s | 78.9 steps/s
[Step=28800 Epoch=56.2] | Loss=0.01092 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.102 | L2-Norm(final)=7.627 | 5137.7 samples/s | 80.3 steps/s
[Step=28850 Epoch=56.3] | Loss=0.01082 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.108 | L2-Norm(final)=7.631 | 4968.7 samples/s | 77.6 steps/s
[Step=28900 Epoch=56.4] | Loss=0.01062 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.114 | L2-Norm(final)=7.635 | 4962.8 samples/s | 77.5 steps/s
[Step=28950 Epoch=56.5] | Loss=0.01052 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.119 | L2-Norm(final)=7.639 | 5033.0 samples/s | 78.6 steps/s
[Step=29000 Epoch=56.6] | Loss=0.01048 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.125 | L2-Norm(final)=7.643 | 6172.3 samples/s | 96.4 steps/s
[Step=29050 Epoch=56.7] | Loss=0.01002 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.130 | L2-Norm(final)=7.647 | 1866.6 samples/s | 29.2 steps/s
[Step=29100 Epoch=56.8] | Loss=0.00981 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.136 | L2-Norm(final)=7.652 | 5063.0 samples/s | 79.1 steps/s
[Step=29150 Epoch=56.9] | Loss=0.00963 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.140 | L2-Norm(final)=7.656 | 5029.2 samples/s | 78.6 steps/s
[Step=29200 Epoch=57.0] | Loss=0.00943 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.145 | L2-Norm(final)=7.660 | 5021.1 samples/s | 78.5 steps/s
[Step=29250 Epoch=57.0] | Loss=0.00932 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.149 | L2-Norm(final)=7.664 | 5067.9 samples/s | 79.2 steps/s
[Step=29300 Epoch=57.1] | Loss=0.00929 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.154 | L2-Norm(final)=7.668 | 5010.5 samples/s | 78.3 steps/s
[Step=29350 Epoch=57.2] | Loss=0.00908 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.158 | L2-Norm(final)=7.672 | 5028.7 samples/s | 78.6 steps/s
[Step=29400 Epoch=57.3] | Loss=0.00899 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.162 | L2-Norm(final)=7.676 | 5075.4 samples/s | 79.3 steps/s
[Step=29450 Epoch=57.4] | Loss=0.00896 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.166 | L2-Norm(final)=7.680 | 5058.3 samples/s | 79.0 steps/s
[Step=29500 Epoch=57.5] | Loss=0.00893 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.170 | L2-Norm(final)=7.683 | 5341.3 samples/s | 83.5 steps/s
[Step=29550 Epoch=57.6] | Loss=0.00885 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.174 | L2-Norm(final)=7.686 | 1952.3 samples/s | 30.5 steps/s
[Step=29600 Epoch=57.7] | Loss=0.00874 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.178 | L2-Norm(final)=7.690 | 5080.5 samples/s | 79.4 steps/s
[Step=29650 Epoch=57.8] | Loss=0.00862 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.182 | L2-Norm(final)=7.693 | 4993.0 samples/s | 78.0 steps/s
[Step=29700 Epoch=57.9] | Loss=0.00850 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.186 | L2-Norm(final)=7.696 | 5093.3 samples/s | 79.6 steps/s
[Step=29750 Epoch=58.0] | Loss=0.00843 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.189 | L2-Norm(final)=7.700 | 5003.7 samples/s | 78.2 steps/s
[Step=29800 Epoch=58.1] | Loss=0.00835 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.193 | L2-Norm(final)=7.703 | 5119.6 samples/s | 80.0 steps/s
[Step=29850 Epoch=58.2] | Loss=0.00834 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.196 | L2-Norm(final)=7.706 | 5040.1 samples/s | 78.8 steps/s
[Step=29900 Epoch=58.3] | Loss=0.00834 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.200 | L2-Norm(final)=7.709 | 5097.8 samples/s | 79.7 steps/s
[Step=29950 Epoch=58.4] | Loss=0.00820 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.203 | L2-Norm(final)=7.713 | 5029.0 samples/s | 78.6 steps/s
[Step=30000 Epoch=58.5] | Loss=0.00818 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.207 | L2-Norm(final)=7.716 | 5069.4 samples/s | 79.2 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step30000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=44001 Epoch=169.4] | Loss=0.00051 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.958 | L2-Norm(final)=8.410 | 3622.6 samples/s | 56.6 steps/s
[Step=44050 Epoch=169.6] | Loss=0.00012 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.958 | L2-Norm(final)=8.413 | 5399.7 samples/s | 84.4 steps/s
[Step=44100 Epoch=169.8] | Loss=0.00010 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=8.416 | 5407.3 samples/s | 84.5 steps/s
[Step=44150 Epoch=170.0] | Loss=0.00008 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.956 | L2-Norm(final)=8.419 | 5245.6 samples/s | 82.0 steps/s
[Step=44200 Epoch=170.1] | Loss=0.00008 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=8.421 | 5309.3 samples/s | 83.0 steps/s
[Step=44250 Epoch=170.3] | Loss=0.00009 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.954 | L2-Norm(final)=8.425 | 7085.6 samples/s | 110.7 steps/s
[Step=44300 Epoch=170.5] | Loss=0.00008 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.954 | L2-Norm(final)=8.428 | 1928.5 samples/s | 30.1 steps/s
[Step=44350 Epoch=170.7] | Loss=0.00008 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.954 | L2-Norm(final)=8.431 | 5386.1 samples/s | 84.2 steps/s
[Step=44400 Epoch=170.9] | Loss=0.00007 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.953 | L2-Norm(final)=8.434 | 5235.0 samples/s | 81.8 steps/s
[Step=44450 Epoch=171.1] | Loss=0.00007 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.952 | L2-Norm(final)=8.437 | 5375.8 samples/s | 84.0 steps/s
[Step=44500 Epoch=171.3] | Loss=0.00006 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.951 | L2-Norm(final)=8.440 | 6147.0 samples/s | 96.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=44501 Epoch=171.3] | Loss=0.00003 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.936 | L2-Norm(final)=8.464 | 3796.8 samples/s | 59.3 steps/s
[Step=44550 Epoch=171.5] | Loss=0.00003 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=8.467 | 4648.4 samples/s | 72.6 steps/s
[Step=44600 Epoch=171.7] | Loss=0.00003 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.929 | L2-Norm(final)=8.468 | 4783.3 samples/s | 74.7 steps/s
[Step=44650 Epoch=171.9] | Loss=0.00002 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.925 | L2-Norm(final)=8.470 | 4774.1 samples/s | 74.6 steps/s
[Step=44700 Epoch=172.1] | Loss=0.00002 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.920 | L2-Norm(final)=8.471 | 4842.4 samples/s | 75.7 steps/s
[Step=44750 Epoch=172.3] | Loss=0.00002 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.916 | L2-Norm(final)=8.472 | 6119.2 samples/s | 95.6 steps/s
[Step=44800 Epoch=172.5] | Loss=0.00002 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.911 | L2-Norm(final)=8.474 | 1857.0 samples/s | 29.0 steps/s
[Step=44850 Epoch=172.6] | Loss=0.00002 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.906 | L2-Norm(final)=8.475 | 4796.9 samples/s | 75.0 steps/s
[Step=44900 Epoch=172.8] | Loss=0.00002 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.902 | L2-Norm(final)=8.476 | 4776.8 samples/s | 74.6 steps/s
[Step=44950 Epoch=173.0] | Loss=0.00002 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.896 | L2-Norm(final)=8.477 | 4718.0 samples/s | 73.7 steps/s
[Step=45000 Epoch=173.2] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.891 | L2-Norm(final)=8.478 | 5445.8 samples/s | 85.1 steps/s
[Step=45050 Epoch=173.4] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.886 | L2-Norm(final)=8.479 | 1943.3 samples/s | 30.4 steps/s
[Step=45100 Epoch=173.6] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.881 | L2-Norm(final)=8.479 | 4764.6 samples/s | 74.4 steps/s
[Step=45150 Epoch=173.8] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.875 | L2-Norm(final)=8.480 | 4826.2 samples/s | 75.4 steps/s
[Step=45200 Epoch=174.0] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.870 | L2-Norm(final)=8.481 | 4802.3 samples/s | 75.0 steps/s
[Step=45250 Epoch=174.2] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.864 | L2-Norm(final)=8.482 | 4882.7 samples/s | 76.3 steps/s
[Step=45300 Epoch=174.4] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.858 | L2-Norm(final)=8.483 | 2005.7 samples/s | 31.3 steps/s
[Step=45350 Epoch=174.6] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.853 | L2-Norm(final)=8.483 | 4894.8 samples/s | 76.5 steps/s
[Step=45400 Epoch=174.8] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.847 | L2-Norm(final)=8.484 | 4782.9 samples/s | 74.7 steps/s
[Step=45450 Epoch=175.0] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=8.485 | 4799.2 samples/s | 75.0 steps/s
[Step=45500 Epoch=175.1] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.835 | L2-Norm(final)=8.486 | 4811.4 samples/s | 75.2 steps/s
[Step=45550 Epoch=175.3] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.829 | L2-Norm(final)=8.486 | 2013.2 samples/s | 31.5 steps/s
[Step=45600 Epoch=175.5] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.823 | L2-Norm(final)=8.487 | 4866.8 samples/s | 76.0 steps/s
[Step=45650 Epoch=175.7] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.816 | L2-Norm(final)=8.488 | 4870.2 samples/s | 76.1 steps/s
[Step=45700 Epoch=175.9] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.810 | L2-Norm(final)=8.489 | 4673.3 samples/s | 73.0 steps/s
[Step=45750 Epoch=176.1] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.804 | L2-Norm(final)=8.489 | 4072.3 samples/s | 63.6 steps/s
[Step=45800 Epoch=176.3] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.797 | L2-Norm(final)=8.490 | 5971.8 samples/s | 93.3 steps/s
[Step=45850 Epoch=176.5] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.791 | L2-Norm(final)=8.491 | 1739.5 samples/s | 27.2 steps/s
[Step=45900 Epoch=176.7] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.784 | L2-Norm(final)=8.491 | 4709.9 samples/s | 73.6 steps/s
[Step=45950 Epoch=176.9] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.777 | L2-Norm(final)=8.492 | 4696.8 samples/s | 73.4 steps/s
[Step=46000 Epoch=177.1] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.770 | L2-Norm(final)=8.493 | 4722.2 samples/s | 73.8 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step46000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06016 | acc=0.9697 | tpr=0.9793 | fpr=0.0513 | 4429.5 samples/s | 17.3 steps/s
Avg test loss: 0.06284, Avg test acc: 0.96867, Avg tpr: 0.97826, Avg fpr: 0.05243, total FA: 409

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06181 | acc=0.9713 | tpr=0.9823 | fpr=0.0525 | 4547.4 samples/s | 17.8 steps/s
Avg test loss: 0.06823, Avg test acc: 0.97007, Avg tpr: 0.98187, Avg fpr: 0.05589, total FA: 436

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.16122 | acc=0.3180 | tpr=0.0391 | fpr=0.0766 | 4573.9 samples/s | 17.9 steps/s
Avg test loss: 5.16243, Avg test acc: 0.31673, Avg tpr: 0.04010, Avg fpr: 0.07486, total FA: 584

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.28649 | acc=0.3137 | tpr=0.0442 | fpr=0.1008 | 4418.3 samples/s | 17.3 steps/s
Avg test loss: 5.28099, Avg test acc: 0.31289, Avg tpr: 0.04505, Avg fpr: 0.09806, total FA: 765

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.70143 | acc=0.1148 | tpr=0.6283 | fpr=0.8945 | 4479.6 samples/s | 17.5 steps/s
[Step= 100] | Loss=5.67666 | acc=0.1151 | tpr=0.6098 | fpr=0.8942 | 8660.6 samples/s | 33.8 steps/s
[Step= 150] | Loss=5.68489 | acc=0.1140 | tpr=0.6037 | fpr=0.8950 | 8895.7 samples/s | 34.7 steps/s
[Step= 200] | Loss=5.67826 | acc=0.1128 | tpr=0.5989 | fpr=0.8961 | 8617.7 samples/s | 33.7 steps/s
[Step= 250] | Loss=5.68110 | acc=0.1131 | tpr=0.6096 | fpr=0.8960 | 8997.7 samples/s | 35.1 steps/s
[Step= 300] | Loss=5.67928 | acc=0.1134 | tpr=0.6116 | fpr=0.8957 | 8822.0 samples/s | 34.5 steps/s
[Step= 350] | Loss=5.67620 | acc=0.1129 | tpr=0.6093 | fpr=0.8961 | 8670.1 samples/s | 33.9 steps/s
[Step= 400] | Loss=5.67456 | acc=0.1130 | tpr=0.6100 | fpr=0.8960 | 8911.5 samples/s | 34.8 steps/s
[Step= 450] | Loss=5.68375 | acc=0.1126 | tpr=0.6061 | fpr=0.8963 | 8788.0 samples/s | 34.3 steps/s
[Step= 500] | Loss=5.68758 | acc=0.1126 | tpr=0.6093 | fpr=0.8963 | 8793.3 samples/s | 34.3 steps/s
[Step= 550] | Loss=5.69186 | acc=0.1128 | tpr=0.6112 | fpr=0.8963 | 15318.0 samples/s | 59.8 steps/s
Avg test loss: 5.69270, Avg test acc: 0.11275, Avg tpr: 0.61212, Avg fpr: 0.89633, total FA: 124454

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.30144 | acc=0.1059 | tpr=0.6726 | fpr=0.9043 | 4422.2 samples/s | 17.3 steps/s
[Step= 100] | Loss=6.27938 | acc=0.1067 | tpr=0.6567 | fpr=0.9036 | 8734.0 samples/s | 34.1 steps/s
[Step= 150] | Loss=6.29451 | acc=0.1059 | tpr=0.6513 | fpr=0.9041 | 8989.1 samples/s | 35.1 steps/s
[Step= 200] | Loss=6.29031 | acc=0.1048 | tpr=0.6372 | fpr=0.9049 | 8823.6 samples/s | 34.5 steps/s
[Step= 250] | Loss=6.29277 | acc=0.1048 | tpr=0.6358 | fpr=0.9049 | 8640.2 samples/s | 33.8 steps/s
[Step= 300] | Loss=6.29249 | acc=0.1050 | tpr=0.6415 | fpr=0.9048 | 8921.2 samples/s | 34.8 steps/s
[Step= 350] | Loss=6.28812 | acc=0.1045 | tpr=0.6399 | fpr=0.9052 | 8614.8 samples/s | 33.7 steps/s
[Step= 400] | Loss=6.28696 | acc=0.1048 | tpr=0.6482 | fpr=0.9050 | 8778.9 samples/s | 34.3 steps/s
[Step= 450] | Loss=6.29523 | acc=0.1044 | tpr=0.6417 | fpr=0.9053 | 8697.1 samples/s | 34.0 steps/s
[Step= 500] | Loss=6.29862 | acc=0.1047 | tpr=0.6445 | fpr=0.9050 | 8952.6 samples/s | 35.0 steps/s
[Step= 550] | Loss=6.30279 | acc=0.1047 | tpr=0.6423 | fpr=0.9051 | 15651.8 samples/s | 61.1 steps/s
Avg test loss: 6.30360, Avg test acc: 0.10462, Avg tpr: 0.64303, Avg fpr: 0.90517, total FA: 125681

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12229 | acc=0.9808 | tpr=0.9336 | fpr=0.0184 | 4415.8 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.12875 | acc=0.9799 | tpr=0.9488 | fpr=0.0195 | 8887.2 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.13330 | acc=0.9792 | tpr=0.9510 | fpr=0.0203 | 8910.8 samples/s | 34.8 steps/s
[Step= 200] | Loss=0.13336 | acc=0.9796 | tpr=0.9519 | fpr=0.0199 | 8771.3 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.13113 | acc=0.9798 | tpr=0.9467 | fpr=0.0196 | 8978.9 samples/s | 35.1 steps/s
[Step= 300] | Loss=0.13339 | acc=0.9796 | tpr=0.9462 | fpr=0.0197 | 8817.2 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.13444 | acc=0.9795 | tpr=0.9487 | fpr=0.0199 | 8671.5 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.13490 | acc=0.9793 | tpr=0.9475 | fpr=0.0202 | 8905.8 samples/s | 34.8 steps/s
[Step= 450] | Loss=0.13808 | acc=0.9789 | tpr=0.9450 | fpr=0.0204 | 8782.2 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.13742 | acc=0.9791 | tpr=0.9467 | fpr=0.0204 | 9325.5 samples/s | 36.4 steps/s
[Step= 550] | Loss=0.13684 | acc=0.9791 | tpr=0.9451 | fpr=0.0203 | 14422.5 samples/s | 56.3 steps/s
Avg test loss: 0.13649, Avg test acc: 0.97913, Avg tpr: 0.94532, Avg fpr: 0.02026, total FA: 2813

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13306 | acc=0.9791 | tpr=0.9425 | fpr=0.0203 | 4492.7 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.13968 | acc=0.9786 | tpr=0.9574 | fpr=0.0210 | 8589.3 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.14408 | acc=0.9775 | tpr=0.9568 | fpr=0.0221 | 8884.1 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.14420 | acc=0.9777 | tpr=0.9563 | fpr=0.0219 | 8692.6 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.14186 | acc=0.9779 | tpr=0.9528 | fpr=0.0217 | 8893.4 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.14439 | acc=0.9776 | tpr=0.9520 | fpr=0.0219 | 8990.9 samples/s | 35.1 steps/s
[Step= 350] | Loss=0.14546 | acc=0.9774 | tpr=0.9543 | fpr=0.0222 | 8421.9 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.14621 | acc=0.9772 | tpr=0.9535 | fpr=0.0224 | 8672.1 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.14947 | acc=0.9769 | tpr=0.9518 | fpr=0.0226 | 9034.0 samples/s | 35.3 steps/s
[Step= 500] | Loss=0.14899 | acc=0.9770 | tpr=0.9537 | fpr=0.0226 | 8660.6 samples/s | 33.8 steps/s
[Step= 550] | Loss=0.14843 | acc=0.9770 | tpr=0.9526 | fpr=0.0226 | 15976.8 samples/s | 62.4 steps/s
Avg test loss: 0.14803, Avg test acc: 0.97702, Avg tpr: 0.95285, Avg fpr: 0.02254, total FA: 3130

server round 40/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=30001 Epoch=58.5] | Loss=0.00158 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.778 | L2-Norm(final)=7.808 | 3782.6 samples/s | 59.1 steps/s
[Step=30050 Epoch=58.6] | Loss=0.01065 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.780 | L2-Norm(final)=7.808 | 5316.7 samples/s | 83.1 steps/s
[Step=30100 Epoch=58.7] | Loss=0.01002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.782 | L2-Norm(final)=7.810 | 5632.6 samples/s | 88.0 steps/s
[Step=30150 Epoch=58.8] | Loss=0.01008 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.785 | L2-Norm(final)=7.813 | 5603.9 samples/s | 87.6 steps/s
[Step=30200 Epoch=58.9] | Loss=0.00992 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.787 | L2-Norm(final)=7.816 | 5789.9 samples/s | 90.5 steps/s
[Step=30250 Epoch=59.0] | Loss=0.00970 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.789 | L2-Norm(final)=7.818 | 5606.0 samples/s | 87.6 steps/s
[Step=30300 Epoch=59.1] | Loss=0.00946 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.791 | L2-Norm(final)=7.821 | 5784.1 samples/s | 90.4 steps/s
[Step=30350 Epoch=59.2] | Loss=0.00964 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.794 | L2-Norm(final)=7.824 | 5541.1 samples/s | 86.6 steps/s
[Step=30400 Epoch=59.3] | Loss=0.00929 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.796 | L2-Norm(final)=7.827 | 5674.0 samples/s | 88.7 steps/s
[Step=30450 Epoch=59.4] | Loss=0.00953 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.798 | L2-Norm(final)=7.830 | 5608.0 samples/s | 87.6 steps/s
[Step=30500 Epoch=59.5] | Loss=0.00937 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.800 | L2-Norm(final)=7.833 | 6998.1 samples/s | 109.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=30501 Epoch=59.5] | Loss=0.01265 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.821 | L2-Norm(final)=7.864 | 3631.0 samples/s | 56.7 steps/s
[Step=30550 Epoch=59.6] | Loss=0.00939 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.824 | L2-Norm(final)=7.866 | 4945.5 samples/s | 77.3 steps/s
[Step=30600 Epoch=59.7] | Loss=0.00925 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.826 | L2-Norm(final)=7.869 | 5027.5 samples/s | 78.6 steps/s
[Step=30650 Epoch=59.8] | Loss=0.00920 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.830 | L2-Norm(final)=7.872 | 5081.3 samples/s | 79.4 steps/s
[Step=30700 Epoch=59.9] | Loss=0.00914 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.833 | L2-Norm(final)=7.875 | 4994.7 samples/s | 78.0 steps/s
[Step=30750 Epoch=60.0] | Loss=0.00912 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.836 | L2-Norm(final)=7.878 | 5062.2 samples/s | 79.1 steps/s
[Step=30800 Epoch=60.1] | Loss=0.00892 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.839 | L2-Norm(final)=7.881 | 5083.7 samples/s | 79.4 steps/s
[Step=30850 Epoch=60.2] | Loss=0.00856 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.843 | L2-Norm(final)=7.884 | 5012.0 samples/s | 78.3 steps/s
[Step=30900 Epoch=60.3] | Loss=0.00845 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.846 | L2-Norm(final)=7.887 | 5049.6 samples/s | 78.9 steps/s
[Step=30950 Epoch=60.4] | Loss=0.00842 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.849 | L2-Norm(final)=7.890 | 5091.6 samples/s | 79.6 steps/s
[Step=31000 Epoch=60.5] | Loss=0.00838 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.852 | L2-Norm(final)=7.893 | 6123.8 samples/s | 95.7 steps/s
[Step=31050 Epoch=60.6] | Loss=0.00829 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.855 | L2-Norm(final)=7.896 | 1868.1 samples/s | 29.2 steps/s
[Step=31100 Epoch=60.7] | Loss=0.00808 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=7.899 | 4951.9 samples/s | 77.4 steps/s
[Step=31150 Epoch=60.8] | Loss=0.00788 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.860 | L2-Norm(final)=7.902 | 5023.4 samples/s | 78.5 steps/s
[Step=31200 Epoch=60.9] | Loss=0.00770 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.863 | L2-Norm(final)=7.905 | 5003.7 samples/s | 78.2 steps/s
[Step=31250 Epoch=60.9] | Loss=0.00757 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.866 | L2-Norm(final)=7.908 | 5132.8 samples/s | 80.2 steps/s
[Step=31300 Epoch=61.0] | Loss=0.00748 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.868 | L2-Norm(final)=7.911 | 5019.4 samples/s | 78.4 steps/s
[Step=31350 Epoch=61.1] | Loss=0.00743 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.871 | L2-Norm(final)=7.914 | 5065.8 samples/s | 79.2 steps/s
[Step=31400 Epoch=61.2] | Loss=0.00733 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.873 | L2-Norm(final)=7.916 | 5053.3 samples/s | 79.0 steps/s
[Step=31450 Epoch=61.3] | Loss=0.00736 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.876 | L2-Norm(final)=7.919 | 5096.4 samples/s | 79.6 steps/s
[Step=31500 Epoch=61.4] | Loss=0.00736 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.878 | L2-Norm(final)=7.922 | 5321.1 samples/s | 83.1 steps/s
[Step=31550 Epoch=61.5] | Loss=0.00727 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=7.924 | 1973.1 samples/s | 30.8 steps/s
[Step=31600 Epoch=61.6] | Loss=0.00723 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.882 | L2-Norm(final)=7.927 | 5048.1 samples/s | 78.9 steps/s
[Step=31650 Epoch=61.7] | Loss=0.00714 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.885 | L2-Norm(final)=7.929 | 5057.7 samples/s | 79.0 steps/s
[Step=31700 Epoch=61.8] | Loss=0.00699 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.887 | L2-Norm(final)=7.932 | 4979.9 samples/s | 77.8 steps/s
[Step=31750 Epoch=61.9] | Loss=0.00696 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.889 | L2-Norm(final)=7.934 | 5067.9 samples/s | 79.2 steps/s
[Step=31800 Epoch=62.0] | Loss=0.00691 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.891 | L2-Norm(final)=7.937 | 5042.0 samples/s | 78.8 steps/s
[Step=31850 Epoch=62.1] | Loss=0.00686 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.893 | L2-Norm(final)=7.939 | 5014.1 samples/s | 78.3 steps/s
[Step=31900 Epoch=62.2] | Loss=0.00681 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.896 | L2-Norm(final)=7.942 | 5060.3 samples/s | 79.1 steps/s
[Step=31950 Epoch=62.3] | Loss=0.00678 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.898 | L2-Norm(final)=7.944 | 5087.5 samples/s | 79.5 steps/s
[Step=32000 Epoch=62.4] | Loss=0.00677 | Reg=0.00119 | acc=0.9531 | L2-Norm=10.900 | L2-Norm(final)=7.946 | 5036.8 samples/s | 78.7 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step32000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=36001 Epoch=70.4] | Loss=0.04066 | Reg=0.00116 | acc=0.9688 | L2-Norm=10.778 | L2-Norm(final)=8.328 | 3754.0 samples/s | 58.7 steps/s
[Step=36050 Epoch=70.5] | Loss=0.01014 | Reg=0.00116 | acc=0.9688 | L2-Norm=10.780 | L2-Norm(final)=8.329 | 5663.2 samples/s | 88.5 steps/s
[Step=36100 Epoch=70.6] | Loss=0.01029 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.782 | L2-Norm(final)=8.331 | 5671.9 samples/s | 88.6 steps/s
[Step=36150 Epoch=70.7] | Loss=0.00922 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.785 | L2-Norm(final)=8.333 | 5699.0 samples/s | 89.0 steps/s
[Step=36200 Epoch=70.8] | Loss=0.00897 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.787 | L2-Norm(final)=8.336 | 5598.7 samples/s | 87.5 steps/s
[Step=36250 Epoch=70.9] | Loss=0.00863 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.789 | L2-Norm(final)=8.339 | 5657.1 samples/s | 88.4 steps/s
[Step=36300 Epoch=71.0] | Loss=0.00861 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.791 | L2-Norm(final)=8.341 | 5707.1 samples/s | 89.2 steps/s
[Step=36350 Epoch=71.1] | Loss=0.00850 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.793 | L2-Norm(final)=8.344 | 5633.6 samples/s | 88.0 steps/s
[Step=36400 Epoch=71.2] | Loss=0.00845 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.795 | L2-Norm(final)=8.346 | 5712.7 samples/s | 89.3 steps/s
[Step=36450 Epoch=71.3] | Loss=0.00842 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.797 | L2-Norm(final)=8.349 | 5644.5 samples/s | 88.2 steps/s
[Step=36500 Epoch=71.4] | Loss=0.00849 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.799 | L2-Norm(final)=8.352 | 7197.1 samples/s | 112.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=36501 Epoch=71.4] | Loss=0.00414 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.818 | L2-Norm(final)=8.379 | 3899.2 samples/s | 60.9 steps/s
[Step=36550 Epoch=71.5] | Loss=0.00778 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.821 | L2-Norm(final)=8.382 | 4757.3 samples/s | 74.3 steps/s
[Step=36600 Epoch=71.6] | Loss=0.00838 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.825 | L2-Norm(final)=8.385 | 5074.6 samples/s | 79.3 steps/s
[Step=36650 Epoch=71.6] | Loss=0.00784 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.828 | L2-Norm(final)=8.387 | 5108.0 samples/s | 79.8 steps/s
[Step=36700 Epoch=71.7] | Loss=0.00752 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.831 | L2-Norm(final)=8.390 | 4961.8 samples/s | 77.5 steps/s
[Step=36750 Epoch=71.8] | Loss=0.00763 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.834 | L2-Norm(final)=8.393 | 5011.6 samples/s | 78.3 steps/s
[Step=36800 Epoch=71.9] | Loss=0.00769 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.837 | L2-Norm(final)=8.396 | 5103.9 samples/s | 79.7 steps/s
[Step=36850 Epoch=72.0] | Loss=0.00765 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.839 | L2-Norm(final)=8.398 | 5023.0 samples/s | 78.5 steps/s
[Step=36900 Epoch=72.1] | Loss=0.00780 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.842 | L2-Norm(final)=8.401 | 5027.9 samples/s | 78.6 steps/s
[Step=36950 Epoch=72.2] | Loss=0.00761 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.845 | L2-Norm(final)=8.403 | 5053.8 samples/s | 79.0 steps/s
[Step=37000 Epoch=72.3] | Loss=0.00757 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.847 | L2-Norm(final)=8.406 | 6283.6 samples/s | 98.2 steps/s
[Step=37050 Epoch=72.4] | Loss=0.00731 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.850 | L2-Norm(final)=8.408 | 1937.1 samples/s | 30.3 steps/s
[Step=37100 Epoch=72.5] | Loss=0.00705 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.852 | L2-Norm(final)=8.411 | 5048.6 samples/s | 78.9 steps/s
[Step=37150 Epoch=72.6] | Loss=0.00702 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.855 | L2-Norm(final)=8.413 | 5041.0 samples/s | 78.8 steps/s
[Step=37200 Epoch=72.7] | Loss=0.00694 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.857 | L2-Norm(final)=8.416 | 5010.0 samples/s | 78.3 steps/s
[Step=37250 Epoch=72.8] | Loss=0.00684 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.859 | L2-Norm(final)=8.418 | 5068.0 samples/s | 79.2 steps/s
[Step=37300 Epoch=72.9] | Loss=0.00673 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.861 | L2-Norm(final)=8.421 | 5054.1 samples/s | 79.0 steps/s
[Step=37350 Epoch=73.0] | Loss=0.00667 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.864 | L2-Norm(final)=8.423 | 5055.9 samples/s | 79.0 steps/s
[Step=37400 Epoch=73.1] | Loss=0.00674 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.866 | L2-Norm(final)=8.426 | 5080.1 samples/s | 79.4 steps/s
[Step=37450 Epoch=73.2] | Loss=0.00675 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.868 | L2-Norm(final)=8.428 | 5053.4 samples/s | 79.0 steps/s
[Step=37500 Epoch=73.3] | Loss=0.00667 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.870 | L2-Norm(final)=8.430 | 5511.0 samples/s | 86.1 steps/s
[Step=37550 Epoch=73.4] | Loss=0.00661 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.872 | L2-Norm(final)=8.433 | 2021.8 samples/s | 31.6 steps/s
[Step=37600 Epoch=73.5] | Loss=0.00652 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.874 | L2-Norm(final)=8.435 | 5001.3 samples/s | 78.1 steps/s
[Step=37650 Epoch=73.6] | Loss=0.00644 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.876 | L2-Norm(final)=8.437 | 5103.2 samples/s | 79.7 steps/s
[Step=37700 Epoch=73.7] | Loss=0.00636 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.878 | L2-Norm(final)=8.440 | 4949.6 samples/s | 77.3 steps/s
[Step=37750 Epoch=73.8] | Loss=0.00632 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=8.442 | 5019.6 samples/s | 78.4 steps/s
[Step=37800 Epoch=73.9] | Loss=0.00631 | Reg=0.00118 | acc=0.9688 | L2-Norm=10.882 | L2-Norm(final)=8.444 | 5116.1 samples/s | 79.9 steps/s
[Step=37850 Epoch=74.0] | Loss=0.00625 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.884 | L2-Norm(final)=8.446 | 5028.3 samples/s | 78.6 steps/s
[Step=37900 Epoch=74.1] | Loss=0.00621 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.886 | L2-Norm(final)=8.449 | 4999.1 samples/s | 78.1 steps/s
[Step=37950 Epoch=74.2] | Loss=0.00613 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.888 | L2-Norm(final)=8.451 | 5027.3 samples/s | 78.6 steps/s
[Step=38000 Epoch=74.3] | Loss=0.00610 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.890 | L2-Norm(final)=8.453 | 5086.9 samples/s | 79.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step38000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06274 | acc=0.9700 | tpr=0.9824 | fpr=0.0570 | 4433.8 samples/s | 17.3 steps/s
Avg test loss: 0.06603, Avg test acc: 0.96931, Avg tpr: 0.98164, Avg fpr: 0.05781, total FA: 451

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06214 | acc=0.9709 | tpr=0.9823 | fpr=0.0538 | 4459.3 samples/s | 17.4 steps/s
Avg test loss: 0.06780, Avg test acc: 0.97027, Avg tpr: 0.98211, Avg fpr: 0.05576, total FA: 435

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.16122 | acc=0.3180 | tpr=0.0391 | fpr=0.0766 | 4430.5 samples/s | 17.3 steps/s
Avg test loss: 5.16243, Avg test acc: 0.31673, Avg tpr: 0.04010, Avg fpr: 0.07486, total FA: 584

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.28649 | acc=0.3137 | tpr=0.0442 | fpr=0.1008 | 4521.5 samples/s | 17.7 steps/s
Avg test loss: 5.28099, Avg test acc: 0.31289, Avg tpr: 0.04505, Avg fpr: 0.09806, total FA: 765

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.89398 | acc=0.1109 | tpr=0.6593 | fpr=0.8989 | 4479.0 samples/s | 17.5 steps/s
[Step= 100] | Loss=5.87032 | acc=0.1112 | tpr=0.6482 | fpr=0.8988 | 8909.6 samples/s | 34.8 steps/s
[Step= 150] | Loss=5.88208 | acc=0.1100 | tpr=0.6441 | fpr=0.8999 | 8693.7 samples/s | 34.0 steps/s
[Step= 200] | Loss=5.87495 | acc=0.1089 | tpr=0.6339 | fpr=0.9007 | 8741.1 samples/s | 34.1 steps/s
[Step= 250] | Loss=5.87740 | acc=0.1090 | tpr=0.6410 | fpr=0.9007 | 8794.9 samples/s | 34.4 steps/s
[Step= 300] | Loss=5.87652 | acc=0.1090 | tpr=0.6473 | fpr=0.9008 | 9048.7 samples/s | 35.3 steps/s
[Step= 350] | Loss=5.87322 | acc=0.1086 | tpr=0.6462 | fpr=0.9011 | 8431.6 samples/s | 32.9 steps/s
[Step= 400] | Loss=5.87250 | acc=0.1089 | tpr=0.6499 | fpr=0.9009 | 8844.9 samples/s | 34.6 steps/s
[Step= 450] | Loss=5.88175 | acc=0.1086 | tpr=0.6456 | fpr=0.9011 | 8936.8 samples/s | 34.9 steps/s
[Step= 500] | Loss=5.88533 | acc=0.1086 | tpr=0.6480 | fpr=0.9011 | 8516.9 samples/s | 33.3 steps/s
[Step= 550] | Loss=5.88984 | acc=0.1088 | tpr=0.6462 | fpr=0.9009 | 16148.4 samples/s | 63.1 steps/s
Avg test loss: 5.89066, Avg test acc: 0.10878, Avg tpr: 0.64699, Avg fpr: 0.90100, total FA: 125102

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.20126 | acc=0.1108 | tpr=0.6681 | fpr=0.8992 | 4457.9 samples/s | 17.4 steps/s
[Step= 100] | Loss=6.18017 | acc=0.1109 | tpr=0.6482 | fpr=0.8992 | 8876.5 samples/s | 34.7 steps/s
[Step= 150] | Loss=6.19332 | acc=0.1101 | tpr=0.6484 | fpr=0.8998 | 8664.3 samples/s | 33.8 steps/s
[Step= 200] | Loss=6.18741 | acc=0.1090 | tpr=0.6415 | fpr=0.9007 | 8809.0 samples/s | 34.4 steps/s
[Step= 250] | Loss=6.18947 | acc=0.1094 | tpr=0.6445 | fpr=0.9004 | 8827.4 samples/s | 34.5 steps/s
[Step= 300] | Loss=6.18910 | acc=0.1099 | tpr=0.6524 | fpr=0.8999 | 8789.0 samples/s | 34.3 steps/s
[Step= 350] | Loss=6.18495 | acc=0.1093 | tpr=0.6518 | fpr=0.9005 | 8675.5 samples/s | 33.9 steps/s
[Step= 400] | Loss=6.18344 | acc=0.1096 | tpr=0.6586 | fpr=0.9003 | 9675.9 samples/s | 37.8 steps/s
[Step= 450] | Loss=6.19187 | acc=0.1092 | tpr=0.6548 | fpr=0.9007 | 8093.8 samples/s | 31.6 steps/s
[Step= 500] | Loss=6.19549 | acc=0.1094 | tpr=0.6595 | fpr=0.9005 | 8994.2 samples/s | 35.1 steps/s
[Step= 550] | Loss=6.19933 | acc=0.1096 | tpr=0.6582 | fpr=0.9004 | 15597.0 samples/s | 60.9 steps/s
Avg test loss: 6.20010, Avg test acc: 0.10951, Avg tpr: 0.65887, Avg fpr: 0.90048, total FA: 125030

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12229 | acc=0.9808 | tpr=0.9336 | fpr=0.0184 | 4450.6 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.12875 | acc=0.9799 | tpr=0.9488 | fpr=0.0195 | 8909.3 samples/s | 34.8 steps/s
[Step= 150] | Loss=0.13330 | acc=0.9792 | tpr=0.9510 | fpr=0.0203 | 8837.5 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.13336 | acc=0.9796 | tpr=0.9519 | fpr=0.0199 | 8631.7 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.13113 | acc=0.9798 | tpr=0.9467 | fpr=0.0196 | 8907.6 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.13339 | acc=0.9796 | tpr=0.9462 | fpr=0.0197 | 8684.7 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.13444 | acc=0.9795 | tpr=0.9487 | fpr=0.0199 | 9381.2 samples/s | 36.6 steps/s
[Step= 400] | Loss=0.13490 | acc=0.9793 | tpr=0.9475 | fpr=0.0202 | 8478.7 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.13808 | acc=0.9789 | tpr=0.9450 | fpr=0.0204 | 8516.0 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.13742 | acc=0.9791 | tpr=0.9467 | fpr=0.0204 | 8730.1 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.13684 | acc=0.9791 | tpr=0.9451 | fpr=0.0203 | 16816.3 samples/s | 65.7 steps/s
Avg test loss: 0.13649, Avg test acc: 0.97913, Avg tpr: 0.94532, Avg fpr: 0.02026, total FA: 2813

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13306 | acc=0.9791 | tpr=0.9425 | fpr=0.0203 | 4415.4 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.13968 | acc=0.9786 | tpr=0.9574 | fpr=0.0210 | 9132.5 samples/s | 35.7 steps/s
[Step= 150] | Loss=0.14408 | acc=0.9775 | tpr=0.9568 | fpr=0.0221 | 8655.0 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.14420 | acc=0.9777 | tpr=0.9563 | fpr=0.0219 | 8672.0 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.14186 | acc=0.9779 | tpr=0.9528 | fpr=0.0217 | 8887.9 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.14439 | acc=0.9776 | tpr=0.9520 | fpr=0.0219 | 9119.5 samples/s | 35.6 steps/s
[Step= 350] | Loss=0.14546 | acc=0.9774 | tpr=0.9543 | fpr=0.0222 | 8798.4 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.14621 | acc=0.9772 | tpr=0.9535 | fpr=0.0224 | 8756.3 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.14947 | acc=0.9769 | tpr=0.9518 | fpr=0.0226 | 8862.1 samples/s | 34.6 steps/s
[Step= 500] | Loss=0.14899 | acc=0.9770 | tpr=0.9537 | fpr=0.0226 | 8596.2 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.14843 | acc=0.9770 | tpr=0.9526 | fpr=0.0226 | 15806.1 samples/s | 61.7 steps/s
Avg test loss: 0.14803, Avg test acc: 0.97702, Avg tpr: 0.95285, Avg fpr: 0.02254, total FA: 3130

server round 41/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=48001 Epoch=183.9] | Loss=0.00015 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.638 | L2-Norm(final)=9.420 | 3813.1 samples/s | 59.6 steps/s
[Step=48050 Epoch=184.1] | Loss=0.00011 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.636 | L2-Norm(final)=9.423 | 5071.3 samples/s | 79.2 steps/s
[Step=48100 Epoch=184.3] | Loss=0.00007 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.635 | L2-Norm(final)=9.426 | 5334.6 samples/s | 83.4 steps/s
[Step=48150 Epoch=184.5] | Loss=0.00006 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.634 | L2-Norm(final)=9.427 | 5296.3 samples/s | 82.8 steps/s
[Step=48200 Epoch=184.7] | Loss=0.00006 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.633 | L2-Norm(final)=9.429 | 5453.6 samples/s | 85.2 steps/s
[Step=48250 Epoch=184.9] | Loss=0.00005 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.631 | L2-Norm(final)=9.431 | 6840.0 samples/s | 106.9 steps/s
[Step=48300 Epoch=185.1] | Loss=0.00005 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.630 | L2-Norm(final)=9.432 | 1932.8 samples/s | 30.2 steps/s
[Step=48350 Epoch=185.3] | Loss=0.00004 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=9.434 | 5344.9 samples/s | 83.5 steps/s
[Step=48400 Epoch=185.5] | Loss=0.00004 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.628 | L2-Norm(final)=9.435 | 5334.2 samples/s | 83.3 steps/s
[Step=48450 Epoch=185.6] | Loss=0.00004 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=9.437 | 5324.5 samples/s | 83.2 steps/s
[Step=48500 Epoch=185.8] | Loss=0.00004 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.625 | L2-Norm(final)=9.438 | 6053.7 samples/s | 94.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=48501 Epoch=185.8] | Loss=0.00002 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.610 | L2-Norm(final)=9.453 | 3865.7 samples/s | 60.4 steps/s
[Step=48550 Epoch=186.0] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.605 | L2-Norm(final)=9.454 | 4520.0 samples/s | 70.6 steps/s
[Step=48600 Epoch=186.2] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.598 | L2-Norm(final)=9.455 | 4767.3 samples/s | 74.5 steps/s
[Step=48650 Epoch=186.4] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.590 | L2-Norm(final)=9.456 | 4837.7 samples/s | 75.6 steps/s
[Step=48700 Epoch=186.6] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.582 | L2-Norm(final)=9.457 | 4845.9 samples/s | 75.7 steps/s
[Step=48750 Epoch=186.8] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.574 | L2-Norm(final)=9.458 | 5973.1 samples/s | 93.3 steps/s
[Step=48800 Epoch=187.0] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.565 | L2-Norm(final)=9.459 | 1863.6 samples/s | 29.1 steps/s
[Step=48850 Epoch=187.2] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.557 | L2-Norm(final)=9.459 | 4851.4 samples/s | 75.8 steps/s
[Step=48900 Epoch=187.4] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.548 | L2-Norm(final)=9.460 | 4653.6 samples/s | 72.7 steps/s
[Step=48950 Epoch=187.6] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.539 | L2-Norm(final)=9.460 | 4828.0 samples/s | 75.4 steps/s
[Step=49000 Epoch=187.8] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.530 | L2-Norm(final)=9.461 | 5303.9 samples/s | 82.9 steps/s
[Step=49050 Epoch=187.9] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.521 | L2-Norm(final)=9.461 | 1943.7 samples/s | 30.4 steps/s
[Step=49100 Epoch=188.1] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.511 | L2-Norm(final)=9.462 | 4864.7 samples/s | 76.0 steps/s
[Step=49150 Epoch=188.3] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.502 | L2-Norm(final)=9.462 | 4854.0 samples/s | 75.8 steps/s
[Step=49200 Epoch=188.5] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.492 | L2-Norm(final)=9.462 | 4713.8 samples/s | 73.7 steps/s
[Step=49250 Epoch=188.7] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.482 | L2-Norm(final)=9.463 | 4842.8 samples/s | 75.7 steps/s
[Step=49300 Epoch=188.9] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=9.463 | 1998.6 samples/s | 31.2 steps/s
[Step=49350 Epoch=189.1] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.462 | L2-Norm(final)=9.464 | 4837.6 samples/s | 75.6 steps/s
[Step=49400 Epoch=189.3] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.452 | L2-Norm(final)=9.464 | 4801.7 samples/s | 75.0 steps/s
[Step=49450 Epoch=189.5] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.441 | L2-Norm(final)=9.464 | 4755.8 samples/s | 74.3 steps/s
[Step=49500 Epoch=189.7] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.431 | L2-Norm(final)=9.465 | 4792.2 samples/s | 74.9 steps/s
[Step=49550 Epoch=189.9] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.420 | L2-Norm(final)=9.465 | 2043.1 samples/s | 31.9 steps/s
[Step=49600 Epoch=190.0] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.409 | L2-Norm(final)=9.465 | 4741.8 samples/s | 74.1 steps/s
[Step=49650 Epoch=190.2] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=9.466 | 4828.8 samples/s | 75.4 steps/s
[Step=49700 Epoch=190.4] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.387 | L2-Norm(final)=9.466 | 4813.3 samples/s | 75.2 steps/s
[Step=49750 Epoch=190.6] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.375 | L2-Norm(final)=9.466 | 4770.9 samples/s | 74.5 steps/s
[Step=49800 Epoch=190.8] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.364 | L2-Norm(final)=9.467 | 6496.8 samples/s | 101.5 steps/s
[Step=49850 Epoch=191.0] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.352 | L2-Norm(final)=9.467 | 1837.8 samples/s | 28.7 steps/s
[Step=49900 Epoch=191.2] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.341 | L2-Norm(final)=9.468 | 4820.9 samples/s | 75.3 steps/s
[Step=49950 Epoch=191.4] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.329 | L2-Norm(final)=9.468 | 4747.6 samples/s | 74.2 steps/s
[Step=50000 Epoch=191.6] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.317 | L2-Norm(final)=9.468 | 4704.4 samples/s | 73.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step50000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=46001 Epoch=177.1] | Loss=0.00002 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.638 | L2-Norm(final)=8.514 | 3589.8 samples/s | 56.1 steps/s
[Step=46050 Epoch=177.3] | Loss=0.00014 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.637 | L2-Norm(final)=8.518 | 5349.4 samples/s | 83.6 steps/s
[Step=46100 Epoch=177.5] | Loss=0.00009 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.638 | L2-Norm(final)=8.520 | 5320.0 samples/s | 83.1 steps/s
[Step=46150 Epoch=177.6] | Loss=0.00008 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.637 | L2-Norm(final)=8.523 | 5305.3 samples/s | 82.9 steps/s
[Step=46200 Epoch=177.8] | Loss=0.00007 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.636 | L2-Norm(final)=8.525 | 5307.7 samples/s | 82.9 steps/s
[Step=46250 Epoch=178.0] | Loss=0.00007 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.635 | L2-Norm(final)=8.528 | 7047.7 samples/s | 110.1 steps/s
[Step=46300 Epoch=178.2] | Loss=0.00006 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.634 | L2-Norm(final)=8.530 | 1929.2 samples/s | 30.1 steps/s
[Step=46350 Epoch=178.4] | Loss=0.00006 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.632 | L2-Norm(final)=8.533 | 5271.4 samples/s | 82.4 steps/s
[Step=46400 Epoch=178.6] | Loss=0.00006 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.631 | L2-Norm(final)=8.535 | 5315.7 samples/s | 83.1 steps/s
[Step=46450 Epoch=178.8] | Loss=0.00005 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.629 | L2-Norm(final)=8.537 | 5508.1 samples/s | 86.1 steps/s
[Step=46500 Epoch=179.0] | Loss=0.00005 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.628 | L2-Norm(final)=8.539 | 5937.7 samples/s | 92.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=179.0] | Loss=0.00005 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.610 | L2-Norm(final)=8.560 | 3729.3 samples/s | 58.3 steps/s
[Step=46550 Epoch=179.2] | Loss=0.00003 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.607 | L2-Norm(final)=8.562 | 4733.6 samples/s | 74.0 steps/s
[Step=46600 Epoch=179.4] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.603 | L2-Norm(final)=8.564 | 4820.3 samples/s | 75.3 steps/s
[Step=46650 Epoch=179.6] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.598 | L2-Norm(final)=8.566 | 4709.2 samples/s | 73.6 steps/s
[Step=46700 Epoch=179.8] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.594 | L2-Norm(final)=8.567 | 4720.3 samples/s | 73.8 steps/s
[Step=46750 Epoch=180.0] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.589 | L2-Norm(final)=8.569 | 6161.7 samples/s | 96.3 steps/s
[Step=46800 Epoch=180.2] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.584 | L2-Norm(final)=8.570 | 1873.8 samples/s | 29.3 steps/s
[Step=46850 Epoch=180.3] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.579 | L2-Norm(final)=8.571 | 4713.7 samples/s | 73.7 steps/s
[Step=46900 Epoch=180.5] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.574 | L2-Norm(final)=8.572 | 4774.8 samples/s | 74.6 steps/s
[Step=46950 Epoch=180.7] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.569 | L2-Norm(final)=8.573 | 4792.9 samples/s | 74.9 steps/s
[Step=47000 Epoch=180.9] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.563 | L2-Norm(final)=8.574 | 5424.6 samples/s | 84.8 steps/s
[Step=47050 Epoch=181.1] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.558 | L2-Norm(final)=8.575 | 1945.4 samples/s | 30.4 steps/s
[Step=47100 Epoch=181.3] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.552 | L2-Norm(final)=8.576 | 4798.9 samples/s | 75.0 steps/s
[Step=47150 Epoch=181.5] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.546 | L2-Norm(final)=8.577 | 4829.5 samples/s | 75.5 steps/s
[Step=47200 Epoch=181.7] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.541 | L2-Norm(final)=8.578 | 4698.8 samples/s | 73.4 steps/s
[Step=47250 Epoch=181.9] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.535 | L2-Norm(final)=8.579 | 4859.6 samples/s | 75.9 steps/s
[Step=47300 Epoch=182.1] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.528 | L2-Norm(final)=8.579 | 2013.1 samples/s | 31.5 steps/s
[Step=47350 Epoch=182.3] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.522 | L2-Norm(final)=8.580 | 4842.0 samples/s | 75.7 steps/s
[Step=47400 Epoch=182.5] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.516 | L2-Norm(final)=8.581 | 4863.7 samples/s | 76.0 steps/s
[Step=47450 Epoch=182.7] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.510 | L2-Norm(final)=8.582 | 4722.4 samples/s | 73.8 steps/s
[Step=47500 Epoch=182.8] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.503 | L2-Norm(final)=8.582 | 4745.3 samples/s | 74.1 steps/s
[Step=47550 Epoch=183.0] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.497 | L2-Norm(final)=8.583 | 2045.1 samples/s | 32.0 steps/s
[Step=47600 Epoch=183.2] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.490 | L2-Norm(final)=8.584 | 4817.4 samples/s | 75.3 steps/s
[Step=47650 Epoch=183.4] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.483 | L2-Norm(final)=8.585 | 4808.4 samples/s | 75.1 steps/s
[Step=47700 Epoch=183.6] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.477 | L2-Norm(final)=8.585 | 4757.5 samples/s | 74.3 steps/s
[Step=47750 Epoch=183.8] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=8.586 | 4776.0 samples/s | 74.6 steps/s
[Step=47800 Epoch=184.0] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.463 | L2-Norm(final)=8.587 | 7059.3 samples/s | 110.3 steps/s
[Step=47850 Epoch=184.2] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.456 | L2-Norm(final)=8.588 | 1794.0 samples/s | 28.0 steps/s
[Step=47900 Epoch=184.4] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.449 | L2-Norm(final)=8.588 | 4763.5 samples/s | 74.4 steps/s
[Step=47950 Epoch=184.6] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.441 | L2-Norm(final)=8.589 | 4807.5 samples/s | 75.1 steps/s
[Step=48000 Epoch=184.8] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.434 | L2-Norm(final)=8.590 | 4815.1 samples/s | 75.2 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step48000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06274 | acc=0.9700 | tpr=0.9824 | fpr=0.0570 | 4445.7 samples/s | 17.4 steps/s
Avg test loss: 0.06603, Avg test acc: 0.96931, Avg tpr: 0.98164, Avg fpr: 0.05781, total FA: 451

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06214 | acc=0.9709 | tpr=0.9823 | fpr=0.0538 | 4481.1 samples/s | 17.5 steps/s
Avg test loss: 0.06780, Avg test acc: 0.97027, Avg tpr: 0.98211, Avg fpr: 0.05576, total FA: 435

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.05441 | acc=0.3210 | tpr=0.0427 | fpr=0.0746 | 4565.1 samples/s | 17.8 steps/s
Avg test loss: 5.05479, Avg test acc: 0.32022, Avg tpr: 0.04424, Avg fpr: 0.07281, total FA: 568

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.33232 | acc=0.3141 | tpr=0.0429 | fpr=0.0969 | 4517.0 samples/s | 17.6 steps/s
Avg test loss: 5.32781, Avg test acc: 0.31293, Avg tpr: 0.04342, Avg fpr: 0.09435, total FA: 736

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.89398 | acc=0.1109 | tpr=0.6593 | fpr=0.8989 | 4481.6 samples/s | 17.5 steps/s
[Step= 100] | Loss=5.87032 | acc=0.1112 | tpr=0.6482 | fpr=0.8988 | 8912.3 samples/s | 34.8 steps/s
[Step= 150] | Loss=5.88208 | acc=0.1100 | tpr=0.6441 | fpr=0.8999 | 8423.8 samples/s | 32.9 steps/s
[Step= 200] | Loss=5.87495 | acc=0.1089 | tpr=0.6339 | fpr=0.9007 | 9261.7 samples/s | 36.2 steps/s
[Step= 250] | Loss=5.87740 | acc=0.1090 | tpr=0.6410 | fpr=0.9007 | 8584.2 samples/s | 33.5 steps/s
[Step= 300] | Loss=5.87652 | acc=0.1090 | tpr=0.6473 | fpr=0.9008 | 9171.0 samples/s | 35.8 steps/s
[Step= 350] | Loss=5.87322 | acc=0.1086 | tpr=0.6462 | fpr=0.9011 | 8420.2 samples/s | 32.9 steps/s
[Step= 400] | Loss=5.87250 | acc=0.1089 | tpr=0.6499 | fpr=0.9009 | 8616.5 samples/s | 33.7 steps/s
[Step= 450] | Loss=5.88175 | acc=0.1086 | tpr=0.6456 | fpr=0.9011 | 9214.4 samples/s | 36.0 steps/s
[Step= 500] | Loss=5.88533 | acc=0.1086 | tpr=0.6480 | fpr=0.9011 | 8392.4 samples/s | 32.8 steps/s
[Step= 550] | Loss=5.88984 | acc=0.1088 | tpr=0.6462 | fpr=0.9009 | 16215.7 samples/s | 63.3 steps/s
Avg test loss: 5.89066, Avg test acc: 0.10878, Avg tpr: 0.64699, Avg fpr: 0.90100, total FA: 125102

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.20126 | acc=0.1108 | tpr=0.6681 | fpr=0.8992 | 4514.6 samples/s | 17.6 steps/s
[Step= 100] | Loss=6.18017 | acc=0.1109 | tpr=0.6482 | fpr=0.8992 | 8677.8 samples/s | 33.9 steps/s
[Step= 150] | Loss=6.19332 | acc=0.1101 | tpr=0.6484 | fpr=0.8998 | 8998.8 samples/s | 35.2 steps/s
[Step= 200] | Loss=6.18741 | acc=0.1090 | tpr=0.6415 | fpr=0.9007 | 8714.9 samples/s | 34.0 steps/s
[Step= 250] | Loss=6.18947 | acc=0.1094 | tpr=0.6445 | fpr=0.9004 | 8457.9 samples/s | 33.0 steps/s
[Step= 300] | Loss=6.18910 | acc=0.1099 | tpr=0.6524 | fpr=0.8999 | 9088.7 samples/s | 35.5 steps/s
[Step= 350] | Loss=6.18495 | acc=0.1093 | tpr=0.6518 | fpr=0.9005 | 8670.7 samples/s | 33.9 steps/s
[Step= 400] | Loss=6.18344 | acc=0.1096 | tpr=0.6586 | fpr=0.9003 | 8924.3 samples/s | 34.9 steps/s
[Step= 450] | Loss=6.19187 | acc=0.1092 | tpr=0.6548 | fpr=0.9007 | 8734.2 samples/s | 34.1 steps/s
[Step= 500] | Loss=6.19549 | acc=0.1094 | tpr=0.6595 | fpr=0.9005 | 8920.2 samples/s | 34.8 steps/s
[Step= 550] | Loss=6.19933 | acc=0.1096 | tpr=0.6582 | fpr=0.9004 | 15792.8 samples/s | 61.7 steps/s
Avg test loss: 6.20010, Avg test acc: 0.10951, Avg tpr: 0.65887, Avg fpr: 0.90048, total FA: 125030

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12631 | acc=0.9806 | tpr=0.9425 | fpr=0.0187 | 4444.4 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.13240 | acc=0.9799 | tpr=0.9552 | fpr=0.0196 | 8843.5 samples/s | 34.5 steps/s
[Step= 150] | Loss=0.13674 | acc=0.9792 | tpr=0.9597 | fpr=0.0205 | 8715.7 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.13687 | acc=0.9794 | tpr=0.9585 | fpr=0.0202 | 8830.2 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.13441 | acc=0.9796 | tpr=0.9546 | fpr=0.0200 | 8924.4 samples/s | 34.9 steps/s
[Step= 300] | Loss=0.13663 | acc=0.9794 | tpr=0.9527 | fpr=0.0202 | 9349.8 samples/s | 36.5 steps/s
[Step= 350] | Loss=0.13773 | acc=0.9791 | tpr=0.9549 | fpr=0.0205 | 8094.8 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.13819 | acc=0.9788 | tpr=0.9546 | fpr=0.0207 | 8877.5 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.14145 | acc=0.9784 | tpr=0.9503 | fpr=0.0210 | 8724.4 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.14084 | acc=0.9786 | tpr=0.9520 | fpr=0.0210 | 9643.9 samples/s | 37.7 steps/s
[Step= 550] | Loss=0.14030 | acc=0.9786 | tpr=0.9503 | fpr=0.0208 | 14007.7 samples/s | 54.7 steps/s
Avg test loss: 0.13994, Avg test acc: 0.97865, Avg tpr: 0.95048, Avg fpr: 0.02084, total FA: 2893

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13434 | acc=0.9794 | tpr=0.9558 | fpr=0.0202 | 4422.3 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.14086 | acc=0.9787 | tpr=0.9638 | fpr=0.0210 | 8852.7 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.14546 | acc=0.9777 | tpr=0.9625 | fpr=0.0220 | 8966.3 samples/s | 35.0 steps/s
[Step= 200] | Loss=0.14548 | acc=0.9779 | tpr=0.9607 | fpr=0.0218 | 8659.6 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.14291 | acc=0.9780 | tpr=0.9563 | fpr=0.0216 | 8776.8 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.14538 | acc=0.9778 | tpr=0.9549 | fpr=0.0218 | 8844.7 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.14653 | acc=0.9776 | tpr=0.9568 | fpr=0.0221 | 8807.1 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.14732 | acc=0.9773 | tpr=0.9562 | fpr=0.0223 | 8617.3 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.15062 | acc=0.9770 | tpr=0.9542 | fpr=0.0226 | 8852.5 samples/s | 34.6 steps/s
[Step= 500] | Loss=0.15020 | acc=0.9770 | tpr=0.9555 | fpr=0.0226 | 8804.8 samples/s | 34.4 steps/s
[Step= 550] | Loss=0.14967 | acc=0.9771 | tpr=0.9542 | fpr=0.0225 | 15654.1 samples/s | 61.1 steps/s
Avg test loss: 0.14927, Avg test acc: 0.97707, Avg tpr: 0.95444, Avg fpr: 0.02251, total FA: 3126

server round 42/50

clients selected: [2 3]

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=50001 Epoch=191.6] | Loss=0.00003 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.489 | L2-Norm(final)=9.479 | 3849.7 samples/s | 60.2 steps/s
[Step=50050 Epoch=191.8] | Loss=0.00009 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.485 | L2-Norm(final)=9.485 | 5075.0 samples/s | 79.3 steps/s
[Step=50100 Epoch=192.0] | Loss=0.00006 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.483 | L2-Norm(final)=9.489 | 5276.2 samples/s | 82.4 steps/s
[Step=50150 Epoch=192.2] | Loss=0.00005 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.480 | L2-Norm(final)=9.492 | 5300.3 samples/s | 82.8 steps/s
[Step=50200 Epoch=192.3] | Loss=0.00005 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.477 | L2-Norm(final)=9.495 | 5326.0 samples/s | 83.2 steps/s
[Step=50250 Epoch=192.5] | Loss=0.00004 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.475 | L2-Norm(final)=9.498 | 6835.5 samples/s | 106.8 steps/s
[Step=50300 Epoch=192.7] | Loss=0.00004 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=9.501 | 1927.3 samples/s | 30.1 steps/s
[Step=50350 Epoch=192.9] | Loss=0.00004 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.469 | L2-Norm(final)=9.504 | 5328.0 samples/s | 83.2 steps/s
[Step=50400 Epoch=193.1] | Loss=0.00003 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.465 | L2-Norm(final)=9.506 | 5365.5 samples/s | 83.8 steps/s
[Step=50450 Epoch=193.3] | Loss=0.00003 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.462 | L2-Norm(final)=9.509 | 5315.2 samples/s | 83.1 steps/s
[Step=50500 Epoch=193.5] | Loss=0.00003 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.459 | L2-Norm(final)=9.511 | 6019.1 samples/s | 94.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=50501 Epoch=193.5] | Loss=0.00002 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.424 | L2-Norm(final)=9.536 | 3866.7 samples/s | 60.4 steps/s
[Step=50550 Epoch=193.7] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.411 | L2-Norm(final)=9.538 | 4525.3 samples/s | 70.7 steps/s
[Step=50600 Epoch=193.9] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.395 | L2-Norm(final)=9.540 | 4803.6 samples/s | 75.1 steps/s
[Step=50650 Epoch=194.1] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.378 | L2-Norm(final)=9.542 | 4901.5 samples/s | 76.6 steps/s
[Step=50700 Epoch=194.3] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.360 | L2-Norm(final)=9.543 | 4689.4 samples/s | 73.3 steps/s
[Step=50750 Epoch=194.5] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.342 | L2-Norm(final)=9.544 | 6087.5 samples/s | 95.1 steps/s
[Step=50800 Epoch=194.6] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.323 | L2-Norm(final)=9.545 | 1859.3 samples/s | 29.1 steps/s
[Step=50850 Epoch=194.8] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.304 | L2-Norm(final)=9.546 | 4808.3 samples/s | 75.1 steps/s
[Step=50900 Epoch=195.0] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.285 | L2-Norm(final)=9.546 | 4766.4 samples/s | 74.5 steps/s
[Step=50950 Epoch=195.2] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.266 | L2-Norm(final)=9.547 | 4805.5 samples/s | 75.1 steps/s
[Step=51000 Epoch=195.4] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.246 | L2-Norm(final)=9.548 | 5296.0 samples/s | 82.7 steps/s
[Step=51050 Epoch=195.6] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.226 | L2-Norm(final)=9.548 | 1946.1 samples/s | 30.4 steps/s
[Step=51100 Epoch=195.8] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.206 | L2-Norm(final)=9.549 | 4903.9 samples/s | 76.6 steps/s
[Step=51150 Epoch=196.0] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.186 | L2-Norm(final)=9.550 | 4711.5 samples/s | 73.6 steps/s
[Step=51200 Epoch=196.2] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.165 | L2-Norm(final)=9.550 | 4803.7 samples/s | 75.1 steps/s
[Step=51250 Epoch=196.4] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.144 | L2-Norm(final)=9.551 | 4823.6 samples/s | 75.4 steps/s
[Step=51300 Epoch=196.6] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.124 | L2-Norm(final)=9.551 | 2024.4 samples/s | 31.6 steps/s
[Step=51350 Epoch=196.8] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.103 | L2-Norm(final)=9.552 | 4847.3 samples/s | 75.7 steps/s
[Step=51400 Epoch=196.9] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.081 | L2-Norm(final)=9.553 | 4777.3 samples/s | 74.6 steps/s
[Step=51450 Epoch=197.1] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.060 | L2-Norm(final)=9.553 | 4760.3 samples/s | 74.4 steps/s
[Step=51500 Epoch=197.3] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.038 | L2-Norm(final)=9.554 | 4789.9 samples/s | 74.8 steps/s
[Step=51550 Epoch=197.5] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=9.555 | 2014.5 samples/s | 31.5 steps/s
[Step=51600 Epoch=197.7] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.995 | L2-Norm(final)=9.555 | 4776.1 samples/s | 74.6 steps/s
[Step=51650 Epoch=197.9] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.972 | L2-Norm(final)=9.556 | 4835.6 samples/s | 75.6 steps/s
[Step=51700 Epoch=198.1] | Loss=0.00000 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.950 | L2-Norm(final)=9.556 | 4752.4 samples/s | 74.3 steps/s
[Step=51750 Epoch=198.3] | Loss=0.00000 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.927 | L2-Norm(final)=9.557 | 4791.0 samples/s | 74.9 steps/s
[Step=51800 Epoch=198.5] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=9.558 | 6556.9 samples/s | 102.5 steps/s
[Step=51850 Epoch=198.7] | Loss=0.00000 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.882 | L2-Norm(final)=9.559 | 1822.0 samples/s | 28.5 steps/s
[Step=51900 Epoch=198.9] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.859 | L2-Norm(final)=9.559 | 4798.9 samples/s | 75.0 steps/s
[Step=51950 Epoch=199.1] | Loss=0.00000 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.836 | L2-Norm(final)=9.560 | 4775.1 samples/s | 74.6 steps/s
[Step=52000 Epoch=199.2] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.812 | L2-Norm(final)=9.561 | 4772.0 samples/s | 74.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step52000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=48001 Epoch=184.8] | Loss=0.00004 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.489 | L2-Norm(final)=8.612 | 3804.5 samples/s | 59.4 steps/s
[Step=48050 Epoch=185.0] | Loss=0.00009 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=8.617 | 5080.6 samples/s | 79.4 steps/s
[Step=48100 Epoch=185.2] | Loss=0.00008 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.486 | L2-Norm(final)=8.624 | 5285.2 samples/s | 82.6 steps/s
[Step=48150 Epoch=185.3] | Loss=0.00007 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.485 | L2-Norm(final)=8.630 | 5281.5 samples/s | 82.5 steps/s
[Step=48200 Epoch=185.5] | Loss=0.00006 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.483 | L2-Norm(final)=8.635 | 5335.0 samples/s | 83.4 steps/s
[Step=48250 Epoch=185.7] | Loss=0.00005 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.480 | L2-Norm(final)=8.639 | 7172.3 samples/s | 112.1 steps/s
[Step=48300 Epoch=185.9] | Loss=0.00005 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.477 | L2-Norm(final)=8.643 | 1915.2 samples/s | 29.9 steps/s
[Step=48350 Epoch=186.1] | Loss=0.00004 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.473 | L2-Norm(final)=8.646 | 5309.8 samples/s | 83.0 steps/s
[Step=48400 Epoch=186.3] | Loss=0.00004 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.469 | L2-Norm(final)=8.650 | 5332.3 samples/s | 83.3 steps/s
[Step=48450 Epoch=186.5] | Loss=0.00004 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.466 | L2-Norm(final)=8.653 | 5363.2 samples/s | 83.8 steps/s
[Step=48500 Epoch=186.7] | Loss=0.00004 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.462 | L2-Norm(final)=8.657 | 6213.3 samples/s | 97.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=48501 Epoch=186.7] | Loss=0.00004 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.422 | L2-Norm(final)=8.689 | 3671.2 samples/s | 57.4 steps/s
[Step=48550 Epoch=186.9] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.414 | L2-Norm(final)=8.691 | 4831.1 samples/s | 75.5 steps/s
[Step=48600 Epoch=187.1] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.405 | L2-Norm(final)=8.694 | 4701.2 samples/s | 73.5 steps/s
[Step=48650 Epoch=187.3] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.396 | L2-Norm(final)=8.696 | 4750.5 samples/s | 74.2 steps/s
[Step=48700 Epoch=187.5] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.386 | L2-Norm(final)=8.699 | 4766.1 samples/s | 74.5 steps/s
[Step=48750 Epoch=187.7] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.376 | L2-Norm(final)=8.701 | 6111.0 samples/s | 95.5 steps/s
[Step=48800 Epoch=187.9] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.365 | L2-Norm(final)=8.702 | 1883.6 samples/s | 29.4 steps/s
[Step=48850 Epoch=188.0] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.355 | L2-Norm(final)=8.704 | 4697.3 samples/s | 73.4 steps/s
[Step=48900 Epoch=188.2] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.343 | L2-Norm(final)=8.705 | 4787.6 samples/s | 74.8 steps/s
[Step=48950 Epoch=188.4] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.332 | L2-Norm(final)=8.706 | 4804.8 samples/s | 75.1 steps/s
[Step=49000 Epoch=188.6] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.321 | L2-Norm(final)=8.707 | 5385.5 samples/s | 84.1 steps/s
[Step=49050 Epoch=188.8] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.309 | L2-Norm(final)=8.708 | 1937.6 samples/s | 30.3 steps/s
[Step=49100 Epoch=189.0] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.297 | L2-Norm(final)=8.709 | 4784.0 samples/s | 74.8 steps/s
[Step=49150 Epoch=189.2] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.285 | L2-Norm(final)=8.711 | 4774.4 samples/s | 74.6 steps/s
[Step=49200 Epoch=189.4] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.273 | L2-Norm(final)=8.712 | 4791.5 samples/s | 74.9 steps/s
[Step=49250 Epoch=189.6] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.261 | L2-Norm(final)=8.713 | 4861.4 samples/s | 76.0 steps/s
[Step=49300 Epoch=189.8] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.248 | L2-Norm(final)=8.714 | 1991.5 samples/s | 31.1 steps/s
[Step=49350 Epoch=190.0] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.236 | L2-Norm(final)=8.715 | 4875.2 samples/s | 76.2 steps/s
[Step=49400 Epoch=190.2] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.223 | L2-Norm(final)=8.716 | 4801.7 samples/s | 75.0 steps/s
[Step=49450 Epoch=190.4] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.210 | L2-Norm(final)=8.717 | 4800.4 samples/s | 75.0 steps/s
[Step=49500 Epoch=190.5] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.198 | L2-Norm(final)=8.718 | 4803.2 samples/s | 75.1 steps/s
[Step=49550 Epoch=190.7] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.185 | L2-Norm(final)=8.719 | 2054.0 samples/s | 32.1 steps/s
[Step=49600 Epoch=190.9] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.171 | L2-Norm(final)=8.720 | 4696.5 samples/s | 73.4 steps/s
[Step=49650 Epoch=191.1] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.158 | L2-Norm(final)=8.721 | 4832.0 samples/s | 75.5 steps/s
[Step=49700 Epoch=191.3] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.145 | L2-Norm(final)=8.722 | 4765.1 samples/s | 74.5 steps/s
[Step=49750 Epoch=191.5] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.131 | L2-Norm(final)=8.723 | 4819.0 samples/s | 75.3 steps/s
[Step=49800 Epoch=191.7] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.118 | L2-Norm(final)=8.724 | 6936.6 samples/s | 108.4 steps/s
[Step=49850 Epoch=191.9] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.104 | L2-Norm(final)=8.725 | 1790.5 samples/s | 28.0 steps/s
[Step=49900 Epoch=192.1] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.090 | L2-Norm(final)=8.726 | 4787.5 samples/s | 74.8 steps/s
[Step=49950 Epoch=192.3] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.076 | L2-Norm(final)=8.727 | 4801.2 samples/s | 75.0 steps/s
[Step=50000 Epoch=192.5] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.062 | L2-Norm(final)=8.728 | 4751.1 samples/s | 74.2 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step50000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06274 | acc=0.9700 | tpr=0.9824 | fpr=0.0570 | 4432.1 samples/s | 17.3 steps/s
Avg test loss: 0.06603, Avg test acc: 0.96931, Avg tpr: 0.98164, Avg fpr: 0.05781, total FA: 451

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.06214 | acc=0.9709 | tpr=0.9823 | fpr=0.0538 | 4508.2 samples/s | 17.6 steps/s
Avg test loss: 0.06780, Avg test acc: 0.97027, Avg tpr: 0.98211, Avg fpr: 0.05576, total FA: 435

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.95679 | acc=0.3175 | tpr=0.0388 | fpr=0.0773 | 4441.8 samples/s | 17.4 steps/s
Avg test loss: 4.96006, Avg test acc: 0.31645, Avg tpr: 0.03981, Avg fpr: 0.07512, total FA: 586

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.35605 | acc=0.3103 | tpr=0.0411 | fpr=0.1051 | 4550.7 samples/s | 17.8 steps/s
Avg test loss: 5.35278, Avg test acc: 0.30840, Avg tpr: 0.04144, Avg fpr: 0.10447, total FA: 815

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.89398 | acc=0.1109 | tpr=0.6593 | fpr=0.8989 | 4450.9 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.87032 | acc=0.1112 | tpr=0.6482 | fpr=0.8988 | 8936.0 samples/s | 34.9 steps/s
[Step= 150] | Loss=5.88208 | acc=0.1100 | tpr=0.6441 | fpr=0.8999 | 8799.0 samples/s | 34.4 steps/s
[Step= 200] | Loss=5.87495 | acc=0.1089 | tpr=0.6339 | fpr=0.9007 | 8564.4 samples/s | 33.5 steps/s
[Step= 250] | Loss=5.87740 | acc=0.1090 | tpr=0.6410 | fpr=0.9007 | 8953.0 samples/s | 35.0 steps/s
[Step= 300] | Loss=5.87652 | acc=0.1090 | tpr=0.6473 | fpr=0.9008 | 8798.3 samples/s | 34.4 steps/s
[Step= 350] | Loss=5.87322 | acc=0.1086 | tpr=0.6462 | fpr=0.9011 | 9013.1 samples/s | 35.2 steps/s
[Step= 400] | Loss=5.87250 | acc=0.1089 | tpr=0.6499 | fpr=0.9009 | 8725.6 samples/s | 34.1 steps/s
[Step= 450] | Loss=5.88175 | acc=0.1086 | tpr=0.6456 | fpr=0.9011 | 8662.6 samples/s | 33.8 steps/s
[Step= 500] | Loss=5.88533 | acc=0.1086 | tpr=0.6480 | fpr=0.9011 | 7115.4 samples/s | 27.8 steps/s
[Step= 550] | Loss=5.88984 | acc=0.1088 | tpr=0.6462 | fpr=0.9009 | 9362.1 samples/s | 36.6 steps/s
Avg test loss: 5.89066, Avg test acc: 0.10878, Avg tpr: 0.64699, Avg fpr: 0.90100, total FA: 125102

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.20126 | acc=0.1108 | tpr=0.6681 | fpr=0.8992 | 4521.0 samples/s | 17.7 steps/s
[Step= 100] | Loss=6.18017 | acc=0.1109 | tpr=0.6482 | fpr=0.8992 | 8405.7 samples/s | 32.8 steps/s
[Step= 150] | Loss=6.19332 | acc=0.1101 | tpr=0.6484 | fpr=0.8998 | 9019.0 samples/s | 35.2 steps/s
[Step= 200] | Loss=6.18741 | acc=0.1090 | tpr=0.6415 | fpr=0.9007 | 8628.7 samples/s | 33.7 steps/s
[Step= 250] | Loss=6.18947 | acc=0.1094 | tpr=0.6445 | fpr=0.9004 | 8885.2 samples/s | 34.7 steps/s
[Step= 300] | Loss=6.18910 | acc=0.1099 | tpr=0.6524 | fpr=0.8999 | 9178.9 samples/s | 35.9 steps/s
[Step= 350] | Loss=6.18495 | acc=0.1093 | tpr=0.6518 | fpr=0.9005 | 8443.0 samples/s | 33.0 steps/s
[Step= 400] | Loss=6.18344 | acc=0.1096 | tpr=0.6586 | fpr=0.9003 | 8667.4 samples/s | 33.9 steps/s
[Step= 450] | Loss=6.19187 | acc=0.1092 | tpr=0.6548 | fpr=0.9007 | 9114.7 samples/s | 35.6 steps/s
[Step= 500] | Loss=6.19549 | acc=0.1094 | tpr=0.6595 | fpr=0.9005 | 5982.9 samples/s | 23.4 steps/s
[Step= 550] | Loss=6.19933 | acc=0.1096 | tpr=0.6582 | fpr=0.9004 | 15651.4 samples/s | 61.1 steps/s
Avg test loss: 6.20010, Avg test acc: 0.10951, Avg tpr: 0.65887, Avg fpr: 0.90048, total FA: 125030

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12103 | acc=0.9809 | tpr=0.9381 | fpr=0.0184 | 4466.1 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.12621 | acc=0.9802 | tpr=0.9510 | fpr=0.0193 | 8700.7 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.13005 | acc=0.9793 | tpr=0.9510 | fpr=0.0202 | 8951.0 samples/s | 35.0 steps/s
[Step= 200] | Loss=0.13022 | acc=0.9796 | tpr=0.9530 | fpr=0.0200 | 8968.5 samples/s | 35.0 steps/s
[Step= 250] | Loss=0.12770 | acc=0.9798 | tpr=0.9502 | fpr=0.0197 | 9582.0 samples/s | 37.4 steps/s
[Step= 300] | Loss=0.12968 | acc=0.9795 | tpr=0.9484 | fpr=0.0200 | 8167.4 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.13089 | acc=0.9793 | tpr=0.9512 | fpr=0.0202 | 8550.8 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.13126 | acc=0.9792 | tpr=0.9513 | fpr=0.0203 | 8970.6 samples/s | 35.0 steps/s
[Step= 450] | Loss=0.13439 | acc=0.9788 | tpr=0.9494 | fpr=0.0207 | 8904.8 samples/s | 34.8 steps/s
[Step= 500] | Loss=0.13388 | acc=0.9789 | tpr=0.9511 | fpr=0.0206 | 6263.3 samples/s | 24.5 steps/s
[Step= 550] | Loss=0.13339 | acc=0.9790 | tpr=0.9499 | fpr=0.0204 | 15678.2 samples/s | 61.2 steps/s
Avg test loss: 0.13306, Avg test acc: 0.97904, Avg tpr: 0.95008, Avg fpr: 0.02043, total FA: 2837

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13490 | acc=0.9790 | tpr=0.9513 | fpr=0.0205 | 4440.4 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.14097 | acc=0.9784 | tpr=0.9616 | fpr=0.0213 | 8809.7 samples/s | 34.4 steps/s
[Step= 150] | Loss=0.14563 | acc=0.9773 | tpr=0.9611 | fpr=0.0224 | 8755.0 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.14557 | acc=0.9775 | tpr=0.9596 | fpr=0.0222 | 9204.3 samples/s | 36.0 steps/s
[Step= 250] | Loss=0.14293 | acc=0.9776 | tpr=0.9581 | fpr=0.0220 | 8317.3 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.14523 | acc=0.9773 | tpr=0.9571 | fpr=0.0223 | 8960.6 samples/s | 35.0 steps/s
[Step= 350] | Loss=0.14654 | acc=0.9770 | tpr=0.9580 | fpr=0.0226 | 9057.3 samples/s | 35.4 steps/s
[Step= 400] | Loss=0.14737 | acc=0.9768 | tpr=0.9573 | fpr=0.0228 | 8862.9 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.15063 | acc=0.9766 | tpr=0.9557 | fpr=0.0231 | 8837.5 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.15032 | acc=0.9766 | tpr=0.9568 | fpr=0.0231 | 6511.4 samples/s | 25.4 steps/s
[Step= 550] | Loss=0.14980 | acc=0.9766 | tpr=0.9562 | fpr=0.0230 | 15792.3 samples/s | 61.7 steps/s
Avg test loss: 0.14941, Avg test acc: 0.97664, Avg tpr: 0.95642, Avg fpr: 0.02299, total FA: 3192

server round 43/50

clients selected: [1 3]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=38001 Epoch=74.3] | Loss=0.01304 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.115 | L2-Norm(final)=8.518 | 3845.9 samples/s | 60.1 steps/s
[Step=38050 Epoch=74.4] | Loss=0.01089 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.118 | L2-Norm(final)=8.521 | 5424.3 samples/s | 84.8 steps/s
[Step=38100 Epoch=74.5] | Loss=0.01179 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.122 | L2-Norm(final)=8.526 | 5645.7 samples/s | 88.2 steps/s
[Step=38150 Epoch=74.6] | Loss=0.01178 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.125 | L2-Norm(final)=8.529 | 5695.7 samples/s | 89.0 steps/s
[Step=38200 Epoch=74.7] | Loss=0.01122 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.128 | L2-Norm(final)=8.533 | 5670.4 samples/s | 88.6 steps/s
[Step=38250 Epoch=74.8] | Loss=0.01125 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.131 | L2-Norm(final)=8.537 | 5768.4 samples/s | 90.1 steps/s
[Step=38300 Epoch=74.9] | Loss=0.01135 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.134 | L2-Norm(final)=8.540 | 5557.4 samples/s | 86.8 steps/s
[Step=38350 Epoch=75.0] | Loss=0.01113 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.137 | L2-Norm(final)=8.544 | 5677.3 samples/s | 88.7 steps/s
[Step=38400 Epoch=75.1] | Loss=0.01104 | Reg=0.00103 | acc=0.9688 | L2-Norm=10.140 | L2-Norm(final)=8.547 | 5772.2 samples/s | 90.2 steps/s
[Step=38450 Epoch=75.2] | Loss=0.01086 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.143 | L2-Norm(final)=8.551 | 5635.3 samples/s | 88.1 steps/s
[Step=38500 Epoch=75.3] | Loss=0.01055 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.146 | L2-Norm(final)=8.555 | 7259.2 samples/s | 113.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=38501 Epoch=75.3] | Loss=0.03202 | Reg=0.00104 | acc=0.9688 | L2-Norm=10.176 | L2-Norm(final)=8.592 | 4097.3 samples/s | 64.0 steps/s
[Step=38550 Epoch=75.4] | Loss=0.01118 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.182 | L2-Norm(final)=8.596 | 4474.0 samples/s | 69.9 steps/s
[Step=38600 Epoch=75.5] | Loss=0.01079 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.187 | L2-Norm(final)=8.599 | 5031.9 samples/s | 78.6 steps/s
[Step=38650 Epoch=75.6] | Loss=0.01027 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.191 | L2-Norm(final)=8.603 | 5086.5 samples/s | 79.5 steps/s
[Step=38700 Epoch=75.7] | Loss=0.01040 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.195 | L2-Norm(final)=8.606 | 5068.2 samples/s | 79.2 steps/s
[Step=38750 Epoch=75.8] | Loss=0.01003 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.200 | L2-Norm(final)=8.609 | 4964.3 samples/s | 77.6 steps/s
[Step=38800 Epoch=75.9] | Loss=0.00940 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.204 | L2-Norm(final)=8.613 | 5067.5 samples/s | 79.2 steps/s
[Step=38850 Epoch=76.0] | Loss=0.00934 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.208 | L2-Norm(final)=8.616 | 5055.7 samples/s | 79.0 steps/s
[Step=38900 Epoch=76.0] | Loss=0.00920 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.211 | L2-Norm(final)=8.619 | 5070.9 samples/s | 79.2 steps/s
[Step=38950 Epoch=76.1] | Loss=0.00940 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.215 | L2-Norm(final)=8.622 | 5069.4 samples/s | 79.2 steps/s
[Step=39000 Epoch=76.2] | Loss=0.00915 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.218 | L2-Norm(final)=8.625 | 6204.5 samples/s | 96.9 steps/s
[Step=39050 Epoch=76.3] | Loss=0.00895 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.221 | L2-Norm(final)=8.628 | 1925.0 samples/s | 30.1 steps/s
[Step=39100 Epoch=76.4] | Loss=0.00886 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.224 | L2-Norm(final)=8.631 | 5113.5 samples/s | 79.9 steps/s
[Step=39150 Epoch=76.5] | Loss=0.00866 | Reg=0.00105 | acc=0.9688 | L2-Norm=10.227 | L2-Norm(final)=8.634 | 4986.2 samples/s | 77.9 steps/s
[Step=39200 Epoch=76.6] | Loss=0.00845 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.230 | L2-Norm(final)=8.637 | 5024.0 samples/s | 78.5 steps/s
[Step=39250 Epoch=76.7] | Loss=0.00848 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.233 | L2-Norm(final)=8.639 | 5036.3 samples/s | 78.7 steps/s
[Step=39300 Epoch=76.8] | Loss=0.00830 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.236 | L2-Norm(final)=8.642 | 5078.9 samples/s | 79.4 steps/s
[Step=39350 Epoch=76.9] | Loss=0.00818 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.239 | L2-Norm(final)=8.645 | 5043.1 samples/s | 78.8 steps/s
[Step=39400 Epoch=77.0] | Loss=0.00808 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.242 | L2-Norm(final)=8.648 | 5001.5 samples/s | 78.1 steps/s
[Step=39450 Epoch=77.1] | Loss=0.00795 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.245 | L2-Norm(final)=8.651 | 5091.8 samples/s | 79.6 steps/s
[Step=39500 Epoch=77.2] | Loss=0.00788 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.247 | L2-Norm(final)=8.654 | 5438.2 samples/s | 85.0 steps/s
[Step=39550 Epoch=77.3] | Loss=0.00788 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.250 | L2-Norm(final)=8.656 | 2017.7 samples/s | 31.5 steps/s
[Step=39600 Epoch=77.4] | Loss=0.00774 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.253 | L2-Norm(final)=8.659 | 5048.9 samples/s | 78.9 steps/s
[Step=39650 Epoch=77.5] | Loss=0.00766 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.256 | L2-Norm(final)=8.662 | 5136.7 samples/s | 80.3 steps/s
[Step=39700 Epoch=77.6] | Loss=0.00756 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.258 | L2-Norm(final)=8.665 | 5013.1 samples/s | 78.3 steps/s
[Step=39750 Epoch=77.7] | Loss=0.00750 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.261 | L2-Norm(final)=8.667 | 4995.9 samples/s | 78.1 steps/s
[Step=39800 Epoch=77.8] | Loss=0.00746 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.263 | L2-Norm(final)=8.670 | 5049.8 samples/s | 78.9 steps/s
[Step=39850 Epoch=77.9] | Loss=0.00744 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.266 | L2-Norm(final)=8.673 | 5131.1 samples/s | 80.2 steps/s
[Step=39900 Epoch=78.0] | Loss=0.00734 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.268 | L2-Norm(final)=8.675 | 5015.8 samples/s | 78.4 steps/s
[Step=39950 Epoch=78.1] | Loss=0.00726 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.271 | L2-Norm(final)=8.678 | 5097.8 samples/s | 79.7 steps/s
[Step=40000 Epoch=78.2] | Loss=0.00725 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.273 | L2-Norm(final)=8.681 | 5015.0 samples/s | 78.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step40000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=50001 Epoch=192.5] | Loss=0.00048 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.115 | L2-Norm(final)=8.761 | 3915.2 samples/s | 61.2 steps/s
[Step=50050 Epoch=192.7] | Loss=0.00011 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.115 | L2-Norm(final)=8.769 | 4839.0 samples/s | 75.6 steps/s
[Step=50100 Epoch=192.9] | Loss=0.00007 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.113 | L2-Norm(final)=8.775 | 5387.6 samples/s | 84.2 steps/s
[Step=50150 Epoch=193.0] | Loss=0.00007 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.111 | L2-Norm(final)=8.782 | 5278.8 samples/s | 82.5 steps/s
[Step=50200 Epoch=193.2] | Loss=0.00006 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.109 | L2-Norm(final)=8.789 | 5291.3 samples/s | 82.7 steps/s
[Step=50250 Epoch=193.4] | Loss=0.00006 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.106 | L2-Norm(final)=8.795 | 7171.4 samples/s | 112.1 steps/s
[Step=50300 Epoch=193.6] | Loss=0.00005 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.104 | L2-Norm(final)=8.800 | 1924.7 samples/s | 30.1 steps/s
[Step=50350 Epoch=193.8] | Loss=0.00005 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.100 | L2-Norm(final)=8.804 | 5273.7 samples/s | 82.4 steps/s
[Step=50400 Epoch=194.0] | Loss=0.00004 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.097 | L2-Norm(final)=8.809 | 5323.8 samples/s | 83.2 steps/s
[Step=50450 Epoch=194.2] | Loss=0.00004 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.093 | L2-Norm(final)=8.812 | 5455.5 samples/s | 85.2 steps/s
[Step=50500 Epoch=194.4] | Loss=0.00004 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.090 | L2-Norm(final)=8.816 | 6062.4 samples/s | 94.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=50501 Epoch=194.4] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.051 | L2-Norm(final)=8.853 | 3909.2 samples/s | 61.1 steps/s
[Step=50550 Epoch=194.6] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.038 | L2-Norm(final)=8.855 | 4512.3 samples/s | 70.5 steps/s
[Step=50600 Epoch=194.8] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.023 | L2-Norm(final)=8.857 | 4795.0 samples/s | 74.9 steps/s
[Step=50650 Epoch=195.0] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.007 | L2-Norm(final)=8.859 | 4800.0 samples/s | 75.0 steps/s
[Step=50700 Epoch=195.2] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.990 | L2-Norm(final)=8.861 | 4711.8 samples/s | 73.6 steps/s
[Step=50750 Epoch=195.4] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.975 | L2-Norm(final)=8.863 | 6166.6 samples/s | 96.4 steps/s
[Step=50800 Epoch=195.5] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.962 | L2-Norm(final)=8.865 | 1855.9 samples/s | 29.0 steps/s
[Step=50850 Epoch=195.7] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.948 | L2-Norm(final)=8.867 | 4744.3 samples/s | 74.1 steps/s
[Step=50900 Epoch=195.9] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.935 | L2-Norm(final)=8.868 | 4807.7 samples/s | 75.1 steps/s
[Step=50950 Epoch=196.1] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.921 | L2-Norm(final)=8.870 | 4788.9 samples/s | 74.8 steps/s
[Step=51000 Epoch=196.3] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.907 | L2-Norm(final)=8.871 | 5473.2 samples/s | 85.5 steps/s
[Step=51050 Epoch=196.5] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.893 | L2-Norm(final)=8.872 | 1944.3 samples/s | 30.4 steps/s
[Step=51100 Epoch=196.7] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.879 | L2-Norm(final)=8.873 | 4756.7 samples/s | 74.3 steps/s
[Step=51150 Epoch=196.9] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.864 | L2-Norm(final)=8.874 | 4811.1 samples/s | 75.2 steps/s
[Step=51200 Epoch=197.1] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.850 | L2-Norm(final)=8.875 | 4745.7 samples/s | 74.2 steps/s
[Step=51250 Epoch=197.3] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.835 | L2-Norm(final)=8.876 | 4846.9 samples/s | 75.7 steps/s
[Step=51300 Epoch=197.5] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.821 | L2-Norm(final)=8.877 | 2021.4 samples/s | 31.6 steps/s
[Step=51350 Epoch=197.7] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=8.878 | 4771.3 samples/s | 74.6 steps/s
[Step=51400 Epoch=197.9] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.791 | L2-Norm(final)=8.878 | 4794.6 samples/s | 74.9 steps/s
[Step=51450 Epoch=198.1] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.775 | L2-Norm(final)=8.879 | 4743.3 samples/s | 74.1 steps/s
[Step=51500 Epoch=198.2] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.760 | L2-Norm(final)=8.880 | 4780.6 samples/s | 74.7 steps/s
[Step=51550 Epoch=198.4] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.745 | L2-Norm(final)=8.881 | 2040.6 samples/s | 31.9 steps/s
[Step=51600 Epoch=198.6] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.729 | L2-Norm(final)=8.882 | 4742.6 samples/s | 74.1 steps/s
[Step=51650 Epoch=198.8] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.713 | L2-Norm(final)=8.883 | 4853.5 samples/s | 75.8 steps/s
[Step=51700 Epoch=199.0] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.698 | L2-Norm(final)=8.883 | 4721.3 samples/s | 73.8 steps/s
[Step=51750 Epoch=199.2] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.682 | L2-Norm(final)=8.884 | 4816.5 samples/s | 75.3 steps/s
[Step=51800 Epoch=199.4] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.665 | L2-Norm(final)=8.885 | 6961.8 samples/s | 108.8 steps/s
[Step=51850 Epoch=199.6] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.649 | L2-Norm(final)=8.886 | 1787.2 samples/s | 27.9 steps/s
[Step=51900 Epoch=199.8] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.633 | L2-Norm(final)=8.887 | 4798.8 samples/s | 75.0 steps/s
[Step=51950 Epoch=200.0] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.616 | L2-Norm(final)=8.888 | 4834.2 samples/s | 75.5 steps/s
[Step=52000 Epoch=200.2] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.600 | L2-Norm(final)=8.889 | 4731.1 samples/s | 73.9 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step52000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06274 | acc=0.9700 | tpr=0.9824 | fpr=0.0570 | 4421.6 samples/s | 17.3 steps/s
Avg test loss: 0.06603, Avg test acc: 0.96931, Avg tpr: 0.98164, Avg fpr: 0.05781, total FA: 451

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05832 | acc=0.9704 | tpr=0.9813 | fpr=0.0533 | 4466.6 samples/s | 17.4 steps/s
Avg test loss: 0.06382, Avg test acc: 0.96963, Avg tpr: 0.98117, Avg fpr: 0.05576, total FA: 435

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.95679 | acc=0.3175 | tpr=0.0388 | fpr=0.0773 | 4527.2 samples/s | 17.7 steps/s
Avg test loss: 4.96006, Avg test acc: 0.31645, Avg tpr: 0.03981, Avg fpr: 0.07512, total FA: 586

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.36105 | acc=0.3068 | tpr=0.0365 | fpr=0.1063 | 4469.9 samples/s | 17.5 steps/s
Avg test loss: 5.35931, Avg test acc: 0.30551, Avg tpr: 0.03713, Avg fpr: 0.10422, total FA: 813

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.89398 | acc=0.1109 | tpr=0.6593 | fpr=0.8989 | 4420.9 samples/s | 17.3 steps/s
[Step= 100] | Loss=5.87032 | acc=0.1112 | tpr=0.6482 | fpr=0.8988 | 9050.3 samples/s | 35.4 steps/s
[Step= 150] | Loss=5.88208 | acc=0.1100 | tpr=0.6441 | fpr=0.8999 | 8702.7 samples/s | 34.0 steps/s
[Step= 200] | Loss=5.87495 | acc=0.1089 | tpr=0.6339 | fpr=0.9007 | 5306.2 samples/s | 20.7 steps/s
[Step= 250] | Loss=5.87740 | acc=0.1090 | tpr=0.6410 | fpr=0.9007 | 8294.8 samples/s | 32.4 steps/s
[Step= 300] | Loss=5.87652 | acc=0.1090 | tpr=0.6473 | fpr=0.9008 | 8912.8 samples/s | 34.8 steps/s
[Step= 350] | Loss=5.87322 | acc=0.1086 | tpr=0.6462 | fpr=0.9011 | 8643.6 samples/s | 33.8 steps/s
[Step= 400] | Loss=5.87250 | acc=0.1089 | tpr=0.6499 | fpr=0.9009 | 8793.3 samples/s | 34.3 steps/s
[Step= 450] | Loss=5.88175 | acc=0.1086 | tpr=0.6456 | fpr=0.9011 | 8627.1 samples/s | 33.7 steps/s
[Step= 500] | Loss=5.88533 | acc=0.1086 | tpr=0.6480 | fpr=0.9011 | 8942.9 samples/s | 34.9 steps/s
[Step= 550] | Loss=5.88984 | acc=0.1088 | tpr=0.6462 | fpr=0.9009 | 15105.2 samples/s | 59.0 steps/s
Avg test loss: 5.89066, Avg test acc: 0.10878, Avg tpr: 0.64699, Avg fpr: 0.90100, total FA: 125102

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.69436 | acc=0.1168 | tpr=0.6858 | fpr=0.8934 | 4444.3 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.67338 | acc=0.1170 | tpr=0.6631 | fpr=0.8932 | 9290.3 samples/s | 36.3 steps/s
[Step= 150] | Loss=5.68586 | acc=0.1160 | tpr=0.6657 | fpr=0.8941 | 8546.8 samples/s | 33.4 steps/s
[Step= 200] | Loss=5.68019 | acc=0.1150 | tpr=0.6612 | fpr=0.8950 | 5058.0 samples/s | 19.8 steps/s
[Step= 250] | Loss=5.68242 | acc=0.1153 | tpr=0.6629 | fpr=0.8947 | 8711.4 samples/s | 34.0 steps/s
[Step= 300] | Loss=5.68163 | acc=0.1153 | tpr=0.6640 | fpr=0.8947 | 8694.3 samples/s | 34.0 steps/s
[Step= 350] | Loss=5.67807 | acc=0.1147 | tpr=0.6625 | fpr=0.8952 | 8802.2 samples/s | 34.4 steps/s
[Step= 400] | Loss=5.67708 | acc=0.1152 | tpr=0.6696 | fpr=0.8949 | 9297.0 samples/s | 36.3 steps/s
[Step= 450] | Loss=5.68493 | acc=0.1147 | tpr=0.6660 | fpr=0.8953 | 8262.1 samples/s | 32.3 steps/s
[Step= 500] | Loss=5.68880 | acc=0.1150 | tpr=0.6722 | fpr=0.8951 | 8514.5 samples/s | 33.3 steps/s
[Step= 550] | Loss=5.69278 | acc=0.1149 | tpr=0.6685 | fpr=0.8952 | 16333.0 samples/s | 63.8 steps/s
Avg test loss: 5.69362, Avg test acc: 0.11480, Avg tpr: 0.66918, Avg fpr: 0.89527, total FA: 124307

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.12103 | acc=0.9809 | tpr=0.9381 | fpr=0.0184 | 4552.2 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.12621 | acc=0.9802 | tpr=0.9510 | fpr=0.0193 | 8290.0 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.13005 | acc=0.9793 | tpr=0.9510 | fpr=0.0202 | 5474.6 samples/s | 21.4 steps/s
[Step= 200] | Loss=0.13022 | acc=0.9796 | tpr=0.9530 | fpr=0.0200 | 7761.7 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.12770 | acc=0.9798 | tpr=0.9502 | fpr=0.0197 | 8864.7 samples/s | 34.6 steps/s
[Step= 300] | Loss=0.12968 | acc=0.9795 | tpr=0.9484 | fpr=0.0200 | 8922.7 samples/s | 34.9 steps/s
[Step= 350] | Loss=0.13089 | acc=0.9793 | tpr=0.9512 | fpr=0.0202 | 9423.4 samples/s | 36.8 steps/s
[Step= 400] | Loss=0.13126 | acc=0.9792 | tpr=0.9513 | fpr=0.0203 | 8106.1 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.13439 | acc=0.9788 | tpr=0.9494 | fpr=0.0207 | 9098.8 samples/s | 35.5 steps/s
[Step= 500] | Loss=0.13388 | acc=0.9789 | tpr=0.9511 | fpr=0.0206 | 8404.6 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.13339 | acc=0.9790 | tpr=0.9499 | fpr=0.0204 | 15437.7 samples/s | 60.3 steps/s
Avg test loss: 0.13306, Avg test acc: 0.97904, Avg tpr: 0.95008, Avg fpr: 0.02043, total FA: 2837

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13049 | acc=0.9791 | tpr=0.9425 | fpr=0.0202 | 4443.6 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.13577 | acc=0.9786 | tpr=0.9574 | fpr=0.0210 | 8906.1 samples/s | 34.8 steps/s
[Step= 150] | Loss=0.14038 | acc=0.9777 | tpr=0.9582 | fpr=0.0220 | 5170.8 samples/s | 20.2 steps/s
[Step= 200] | Loss=0.14029 | acc=0.9779 | tpr=0.9574 | fpr=0.0218 | 9091.2 samples/s | 35.5 steps/s
[Step= 250] | Loss=0.13765 | acc=0.9781 | tpr=0.9563 | fpr=0.0215 | 8383.8 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.13981 | acc=0.9778 | tpr=0.9556 | fpr=0.0218 | 8644.4 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.14130 | acc=0.9776 | tpr=0.9568 | fpr=0.0220 | 9100.1 samples/s | 35.5 steps/s
[Step= 400] | Loss=0.14208 | acc=0.9774 | tpr=0.9568 | fpr=0.0223 | 8272.0 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.14517 | acc=0.9771 | tpr=0.9552 | fpr=0.0225 | 9205.6 samples/s | 36.0 steps/s
[Step= 500] | Loss=0.14501 | acc=0.9771 | tpr=0.9568 | fpr=0.0226 | 8433.3 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.14451 | acc=0.9771 | tpr=0.9546 | fpr=0.0225 | 15911.4 samples/s | 62.2 steps/s
Avg test loss: 0.14414, Avg test acc: 0.97712, Avg tpr: 0.95483, Avg fpr: 0.02247, total FA: 3120

server round 44/50

clients selected: [0 2]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=32001 Epoch=62.4] | Loss=0.01585 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.829 | L2-Norm(final)=8.018 | 3424.8 samples/s | 53.5 steps/s
[Step=32050 Epoch=62.5] | Loss=0.01692 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.833 | L2-Norm(final)=8.020 | 5748.6 samples/s | 89.8 steps/s
[Step=32100 Epoch=62.6] | Loss=0.01733 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.837 | L2-Norm(final)=8.024 | 5635.7 samples/s | 88.1 steps/s
[Step=32150 Epoch=62.7] | Loss=0.01573 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=8.028 | 5609.4 samples/s | 87.6 steps/s
[Step=32200 Epoch=62.8] | Loss=0.01467 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.846 | L2-Norm(final)=8.033 | 5652.2 samples/s | 88.3 steps/s
[Step=32250 Epoch=62.9] | Loss=0.01492 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.849 | L2-Norm(final)=8.037 | 5640.1 samples/s | 88.1 steps/s
[Step=32300 Epoch=63.0] | Loss=0.01504 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.853 | L2-Norm(final)=8.042 | 5711.9 samples/s | 89.2 steps/s
[Step=32350 Epoch=63.1] | Loss=0.01478 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.856 | L2-Norm(final)=8.046 | 5676.4 samples/s | 88.7 steps/s
[Step=32400 Epoch=63.2] | Loss=0.01444 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.860 | L2-Norm(final)=8.050 | 5668.2 samples/s | 88.6 steps/s
[Step=32450 Epoch=63.3] | Loss=0.01415 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.863 | L2-Norm(final)=8.054 | 5704.3 samples/s | 89.1 steps/s
[Step=32500 Epoch=63.4] | Loss=0.01405 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.866 | L2-Norm(final)=8.058 | 7113.5 samples/s | 111.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=32501 Epoch=63.4] | Loss=0.00768 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.898 | L2-Norm(final)=8.099 | 3472.7 samples/s | 54.3 steps/s
[Step=32550 Epoch=63.5] | Loss=0.01446 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.903 | L2-Norm(final)=8.103 | 4902.4 samples/s | 76.6 steps/s
[Step=32600 Epoch=63.6] | Loss=0.01405 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.910 | L2-Norm(final)=8.107 | 4980.9 samples/s | 77.8 steps/s
[Step=32650 Epoch=63.7] | Loss=0.01290 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.916 | L2-Norm(final)=8.111 | 5030.1 samples/s | 78.6 steps/s
[Step=32700 Epoch=63.8] | Loss=0.01286 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.922 | L2-Norm(final)=8.115 | 5037.0 samples/s | 78.7 steps/s
[Step=32750 Epoch=63.9] | Loss=0.01241 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.927 | L2-Norm(final)=8.119 | 5048.8 samples/s | 78.9 steps/s
[Step=32800 Epoch=64.0] | Loss=0.01281 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.932 | L2-Norm(final)=8.123 | 5039.3 samples/s | 78.7 steps/s
[Step=32850 Epoch=64.1] | Loss=0.01233 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.937 | L2-Norm(final)=8.127 | 5054.9 samples/s | 79.0 steps/s
[Step=32900 Epoch=64.2] | Loss=0.01214 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.941 | L2-Norm(final)=8.131 | 5045.7 samples/s | 78.8 steps/s
[Step=32950 Epoch=64.3] | Loss=0.01188 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.946 | L2-Norm(final)=8.134 | 5132.6 samples/s | 80.2 steps/s
[Step=33000 Epoch=64.4] | Loss=0.01166 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.950 | L2-Norm(final)=8.138 | 6087.9 samples/s | 95.1 steps/s
[Step=33050 Epoch=64.5] | Loss=0.01146 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.954 | L2-Norm(final)=8.142 | 1878.1 samples/s | 29.3 steps/s
[Step=33100 Epoch=64.6] | Loss=0.01112 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.958 | L2-Norm(final)=8.145 | 4967.2 samples/s | 77.6 steps/s
[Step=33150 Epoch=64.7] | Loss=0.01077 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.962 | L2-Norm(final)=8.149 | 5041.3 samples/s | 78.8 steps/s
[Step=33200 Epoch=64.8] | Loss=0.01065 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.966 | L2-Norm(final)=8.153 | 5043.9 samples/s | 78.8 steps/s
[Step=33250 Epoch=64.9] | Loss=0.01049 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.969 | L2-Norm(final)=8.156 | 5023.3 samples/s | 78.5 steps/s
[Step=33300 Epoch=64.9] | Loss=0.01028 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.973 | L2-Norm(final)=8.160 | 5093.2 samples/s | 79.6 steps/s
[Step=33350 Epoch=65.0] | Loss=0.01019 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.977 | L2-Norm(final)=8.163 | 5013.4 samples/s | 78.3 steps/s
[Step=33400 Epoch=65.1] | Loss=0.01004 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.980 | L2-Norm(final)=8.166 | 5083.6 samples/s | 79.4 steps/s
[Step=33450 Epoch=65.2] | Loss=0.00995 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.984 | L2-Norm(final)=8.170 | 5020.5 samples/s | 78.4 steps/s
[Step=33500 Epoch=65.3] | Loss=0.00977 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.987 | L2-Norm(final)=8.173 | 5327.4 samples/s | 83.2 steps/s
[Step=33550 Epoch=65.4] | Loss=0.00967 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.990 | L2-Norm(final)=8.176 | 1981.4 samples/s | 31.0 steps/s
[Step=33600 Epoch=65.5] | Loss=0.00956 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.994 | L2-Norm(final)=8.180 | 5095.5 samples/s | 79.6 steps/s
[Step=33650 Epoch=65.6] | Loss=0.00951 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.997 | L2-Norm(final)=8.183 | 5024.0 samples/s | 78.5 steps/s
[Step=33700 Epoch=65.7] | Loss=0.00938 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.000 | L2-Norm(final)=8.186 | 5079.1 samples/s | 79.4 steps/s
[Step=33750 Epoch=65.8] | Loss=0.00924 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.004 | L2-Norm(final)=8.189 | 5024.1 samples/s | 78.5 steps/s
[Step=33800 Epoch=65.9] | Loss=0.00914 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.007 | L2-Norm(final)=8.193 | 5029.1 samples/s | 78.6 steps/s
[Step=33850 Epoch=66.0] | Loss=0.00904 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.010 | L2-Norm(final)=8.196 | 5060.5 samples/s | 79.1 steps/s
[Step=33900 Epoch=66.1] | Loss=0.00893 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.013 | L2-Norm(final)=8.199 | 5153.5 samples/s | 80.5 steps/s
[Step=33950 Epoch=66.2] | Loss=0.00888 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.016 | L2-Norm(final)=8.202 | 4948.7 samples/s | 77.3 steps/s
[Step=34000 Epoch=66.3] | Loss=0.00878 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.019 | L2-Norm(final)=8.205 | 5086.2 samples/s | 79.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step34000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=52001 Epoch=199.2] | Loss=0.00027 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.829 | L2-Norm(final)=9.584 | 3809.7 samples/s | 59.5 steps/s
[Step=52050 Epoch=199.4] | Loss=0.00021 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.821 | L2-Norm(final)=9.587 | 5179.8 samples/s | 80.9 steps/s
[Step=52100 Epoch=199.6] | Loss=0.00013 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.822 | L2-Norm(final)=9.590 | 5362.5 samples/s | 83.8 steps/s
[Step=52150 Epoch=199.8] | Loss=0.00010 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.822 | L2-Norm(final)=9.592 | 5318.6 samples/s | 83.1 steps/s
[Step=52200 Epoch=200.0] | Loss=0.00008 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.821 | L2-Norm(final)=9.595 | 5291.3 samples/s | 82.7 steps/s
[Step=52250 Epoch=200.2] | Loss=0.00007 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.819 | L2-Norm(final)=9.598 | 7033.3 samples/s | 109.9 steps/s
[Step=52300 Epoch=200.4] | Loss=0.00006 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.817 | L2-Norm(final)=9.601 | 1942.9 samples/s | 30.4 steps/s
[Step=52350 Epoch=200.6] | Loss=0.00006 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.815 | L2-Norm(final)=9.603 | 5283.7 samples/s | 82.6 steps/s
[Step=52400 Epoch=200.8] | Loss=0.00005 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=9.606 | 5290.9 samples/s | 82.7 steps/s
[Step=52450 Epoch=201.0] | Loss=0.00005 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.811 | L2-Norm(final)=9.608 | 5309.0 samples/s | 83.0 steps/s
[Step=52500 Epoch=201.2] | Loss=0.00005 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.809 | L2-Norm(final)=9.610 | 5996.7 samples/s | 93.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=52501 Epoch=201.2] | Loss=0.00000 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.784 | L2-Norm(final)=9.633 | 3940.8 samples/s | 61.6 steps/s
[Step=52550 Epoch=201.4] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.766 | L2-Norm(final)=9.635 | 4406.2 samples/s | 68.8 steps/s
[Step=52600 Epoch=201.5] | Loss=0.00015 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.756 | L2-Norm(final)=9.638 | 4769.2 samples/s | 74.5 steps/s
[Step=52650 Epoch=201.7] | Loss=0.00014 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.755 | L2-Norm(final)=9.641 | 4819.0 samples/s | 75.3 steps/s
[Step=52700 Epoch=201.9] | Loss=0.00011 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.755 | L2-Norm(final)=9.643 | 4806.7 samples/s | 75.1 steps/s
[Step=52750 Epoch=202.1] | Loss=0.00009 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.754 | L2-Norm(final)=9.645 | 5954.2 samples/s | 93.0 steps/s
[Step=52800 Epoch=202.3] | Loss=0.00008 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.752 | L2-Norm(final)=9.646 | 1886.6 samples/s | 29.5 steps/s
[Step=52850 Epoch=202.5] | Loss=0.00007 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=9.647 | 4738.9 samples/s | 74.0 steps/s
[Step=52900 Epoch=202.7] | Loss=0.00006 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.748 | L2-Norm(final)=9.647 | 4795.4 samples/s | 74.9 steps/s
[Step=52950 Epoch=202.9] | Loss=0.00005 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.746 | L2-Norm(final)=9.648 | 4803.8 samples/s | 75.1 steps/s
[Step=53000 Epoch=203.1] | Loss=0.00005 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.743 | L2-Norm(final)=9.648 | 5284.1 samples/s | 82.6 steps/s
[Step=53050 Epoch=203.3] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.741 | L2-Norm(final)=9.649 | 1971.8 samples/s | 30.8 steps/s
[Step=53100 Epoch=203.5] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.738 | L2-Norm(final)=9.649 | 4704.1 samples/s | 73.5 steps/s
[Step=53150 Epoch=203.7] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.735 | L2-Norm(final)=9.650 | 4790.0 samples/s | 74.8 steps/s
[Step=53200 Epoch=203.8] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.733 | L2-Norm(final)=9.650 | 4874.9 samples/s | 76.2 steps/s
[Step=53250 Epoch=204.0] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.730 | L2-Norm(final)=9.651 | 4688.4 samples/s | 73.3 steps/s
[Step=53300 Epoch=204.2] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.727 | L2-Norm(final)=9.651 | 2024.7 samples/s | 31.6 steps/s
[Step=53350 Epoch=204.4] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.724 | L2-Norm(final)=9.651 | 4870.8 samples/s | 76.1 steps/s
[Step=53400 Epoch=204.6] | Loss=0.00003 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.721 | L2-Norm(final)=9.652 | 4783.6 samples/s | 74.7 steps/s
[Step=53450 Epoch=204.8] | Loss=0.00003 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.717 | L2-Norm(final)=9.652 | 4803.0 samples/s | 75.0 steps/s
[Step=53500 Epoch=205.0] | Loss=0.00003 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.714 | L2-Norm(final)=9.652 | 4833.9 samples/s | 75.5 steps/s
[Step=53550 Epoch=205.2] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.711 | L2-Norm(final)=9.652 | 2022.0 samples/s | 31.6 steps/s
[Step=53600 Epoch=205.4] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.708 | L2-Norm(final)=9.653 | 4763.9 samples/s | 74.4 steps/s
[Step=53650 Epoch=205.6] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.704 | L2-Norm(final)=9.653 | 4817.9 samples/s | 75.3 steps/s
[Step=53700 Epoch=205.8] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.701 | L2-Norm(final)=9.653 | 4828.5 samples/s | 75.4 steps/s
[Step=53750 Epoch=206.0] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.697 | L2-Norm(final)=9.654 | 4832.7 samples/s | 75.5 steps/s
[Step=53800 Epoch=206.1] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.694 | L2-Norm(final)=9.654 | 6427.3 samples/s | 100.4 steps/s
[Step=53850 Epoch=206.3] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.690 | L2-Norm(final)=9.654 | 1827.4 samples/s | 28.6 steps/s
[Step=53900 Epoch=206.5] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.686 | L2-Norm(final)=9.655 | 4744.5 samples/s | 74.1 steps/s
[Step=53950 Epoch=206.7] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.683 | L2-Norm(final)=9.655 | 4798.8 samples/s | 75.0 steps/s
[Step=54000 Epoch=206.9] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.679 | L2-Norm(final)=9.655 | 4767.9 samples/s | 74.5 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step54000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05674 | acc=0.9695 | tpr=0.9779 | fpr=0.0486 | 4437.9 samples/s | 17.3 steps/s
Avg test loss: 0.06012, Avg test acc: 0.96907, Avg tpr: 0.97674, Avg fpr: 0.04781, total FA: 373

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05832 | acc=0.9704 | tpr=0.9813 | fpr=0.0533 | 4492.3 samples/s | 17.5 steps/s
Avg test loss: 0.06382, Avg test acc: 0.96963, Avg tpr: 0.98117, Avg fpr: 0.05576, total FA: 435

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.17174 | acc=0.3159 | tpr=0.0300 | fpr=0.0632 | 4437.6 samples/s | 17.3 steps/s
Avg test loss: 5.17600, Avg test acc: 0.31509, Avg tpr: 0.03048, Avg fpr: 0.05897, total FA: 460

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.36105 | acc=0.3068 | tpr=0.0365 | fpr=0.1063 | 4562.9 samples/s | 17.8 steps/s
Avg test loss: 5.35931, Avg test acc: 0.30551, Avg tpr: 0.03713, Avg fpr: 0.10422, total FA: 813

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.00045 | acc=0.1217 | tpr=0.6062 | fpr=0.8870 | 3604.6 samples/s | 14.1 steps/s
[Step= 100] | Loss=4.98135 | acc=0.1212 | tpr=0.5778 | fpr=0.8873 | 7376.2 samples/s | 28.8 steps/s
[Step= 150] | Loss=4.98947 | acc=0.1194 | tpr=0.5720 | fpr=0.8889 | 8145.1 samples/s | 31.8 steps/s
[Step= 200] | Loss=4.98224 | acc=0.1183 | tpr=0.5650 | fpr=0.8898 | 9486.7 samples/s | 37.1 steps/s
[Step= 250] | Loss=4.98462 | acc=0.1183 | tpr=0.5703 | fpr=0.8900 | 8320.8 samples/s | 32.5 steps/s
[Step= 300] | Loss=4.98286 | acc=0.1182 | tpr=0.5745 | fpr=0.8901 | 8918.7 samples/s | 34.8 steps/s
[Step= 350] | Loss=4.97890 | acc=0.1178 | tpr=0.5736 | fpr=0.8905 | 8605.6 samples/s | 33.6 steps/s
[Step= 400] | Loss=4.97789 | acc=0.1179 | tpr=0.5760 | fpr=0.8904 | 8675.2 samples/s | 33.9 steps/s
[Step= 450] | Loss=4.98599 | acc=0.1178 | tpr=0.5711 | fpr=0.8904 | 8687.0 samples/s | 33.9 steps/s
[Step= 500] | Loss=4.98968 | acc=0.1179 | tpr=0.5758 | fpr=0.8904 | 8727.4 samples/s | 34.1 steps/s
[Step= 550] | Loss=4.99349 | acc=0.1180 | tpr=0.5758 | fpr=0.8903 | 16461.7 samples/s | 64.3 steps/s
Avg test loss: 4.99429, Avg test acc: 0.11798, Avg tpr: 0.57686, Avg fpr: 0.89036, total FA: 123625

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.69436 | acc=0.1168 | tpr=0.6858 | fpr=0.8934 | 3229.3 samples/s | 12.6 steps/s
[Step= 100] | Loss=5.67338 | acc=0.1170 | tpr=0.6631 | fpr=0.8932 | 8871.9 samples/s | 34.7 steps/s
[Step= 150] | Loss=5.68586 | acc=0.1160 | tpr=0.6657 | fpr=0.8941 | 8759.3 samples/s | 34.2 steps/s
[Step= 200] | Loss=5.68019 | acc=0.1150 | tpr=0.6612 | fpr=0.8950 | 8821.7 samples/s | 34.5 steps/s
[Step= 250] | Loss=5.68242 | acc=0.1153 | tpr=0.6629 | fpr=0.8947 | 8699.1 samples/s | 34.0 steps/s
[Step= 300] | Loss=5.68163 | acc=0.1153 | tpr=0.6640 | fpr=0.8947 | 8844.1 samples/s | 34.5 steps/s
[Step= 350] | Loss=5.67807 | acc=0.1147 | tpr=0.6625 | fpr=0.8952 | 8687.1 samples/s | 33.9 steps/s
[Step= 400] | Loss=5.67708 | acc=0.1152 | tpr=0.6696 | fpr=0.8949 | 9342.5 samples/s | 36.5 steps/s
[Step= 450] | Loss=5.68493 | acc=0.1147 | tpr=0.6660 | fpr=0.8953 | 8392.1 samples/s | 32.8 steps/s
[Step= 500] | Loss=5.68880 | acc=0.1150 | tpr=0.6722 | fpr=0.8951 | 8525.3 samples/s | 33.3 steps/s
[Step= 550] | Loss=5.69278 | acc=0.1149 | tpr=0.6685 | fpr=0.8952 | 15626.2 samples/s | 61.0 steps/s
Avg test loss: 5.69362, Avg test acc: 0.11480, Avg tpr: 0.66918, Avg fpr: 0.89527, total FA: 124307

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11784 | acc=0.9820 | tpr=0.9336 | fpr=0.0172 | 3239.3 samples/s | 12.7 steps/s
[Step= 100] | Loss=0.12342 | acc=0.9812 | tpr=0.9446 | fpr=0.0181 | 8881.0 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.12801 | acc=0.9802 | tpr=0.9481 | fpr=0.0192 | 8563.6 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.12852 | acc=0.9805 | tpr=0.9497 | fpr=0.0189 | 8809.5 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.12607 | acc=0.9807 | tpr=0.9476 | fpr=0.0187 | 8992.4 samples/s | 35.1 steps/s
[Step= 300] | Loss=0.12836 | acc=0.9804 | tpr=0.9469 | fpr=0.0190 | 8575.8 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.12967 | acc=0.9802 | tpr=0.9499 | fpr=0.0192 | 8653.6 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.13011 | acc=0.9800 | tpr=0.9497 | fpr=0.0194 | 8812.2 samples/s | 34.4 steps/s
[Step= 450] | Loss=0.13315 | acc=0.9797 | tpr=0.9469 | fpr=0.0197 | 8834.2 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.13260 | acc=0.9797 | tpr=0.9480 | fpr=0.0197 | 8718.2 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.13209 | acc=0.9798 | tpr=0.9459 | fpr=0.0196 | 15565.1 samples/s | 60.8 steps/s
Avg test loss: 0.13176, Avg test acc: 0.97981, Avg tpr: 0.94612, Avg fpr: 0.01958, total FA: 2718

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13049 | acc=0.9791 | tpr=0.9425 | fpr=0.0202 | 3253.9 samples/s | 12.7 steps/s
[Step= 100] | Loss=0.13577 | acc=0.9786 | tpr=0.9574 | fpr=0.0210 | 8554.9 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.14038 | acc=0.9777 | tpr=0.9582 | fpr=0.0220 | 9002.7 samples/s | 35.2 steps/s
[Step= 200] | Loss=0.14029 | acc=0.9779 | tpr=0.9574 | fpr=0.0218 | 8646.2 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.13765 | acc=0.9781 | tpr=0.9563 | fpr=0.0215 | 8927.1 samples/s | 34.9 steps/s
[Step= 300] | Loss=0.13981 | acc=0.9778 | tpr=0.9556 | fpr=0.0218 | 9240.2 samples/s | 36.1 steps/s
[Step= 350] | Loss=0.14130 | acc=0.9776 | tpr=0.9568 | fpr=0.0220 | 8444.6 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.14208 | acc=0.9774 | tpr=0.9568 | fpr=0.0223 | 8644.0 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.14517 | acc=0.9771 | tpr=0.9552 | fpr=0.0225 | 8965.1 samples/s | 35.0 steps/s
[Step= 500] | Loss=0.14501 | acc=0.9771 | tpr=0.9568 | fpr=0.0226 | 8716.9 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.14451 | acc=0.9771 | tpr=0.9546 | fpr=0.0225 | 16074.3 samples/s | 62.8 steps/s
Avg test loss: 0.14414, Avg test acc: 0.97712, Avg tpr: 0.95483, Avg fpr: 0.02247, total FA: 3120

server round 45/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=34001 Epoch=66.3] | Loss=0.01230 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.738 | L2-Norm(final)=8.298 | 3199.2 samples/s | 50.0 steps/s
[Step=34050 Epoch=66.4] | Loss=0.01538 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.742 | L2-Norm(final)=8.301 | 2424.7 samples/s | 37.9 steps/s
[Step=34100 Epoch=66.5] | Loss=0.01434 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.745 | L2-Norm(final)=8.304 | 5125.3 samples/s | 80.1 steps/s
[Step=34150 Epoch=66.6] | Loss=0.01326 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.748 | L2-Norm(final)=8.308 | 5635.8 samples/s | 88.1 steps/s
[Step=34200 Epoch=66.7] | Loss=0.01351 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.751 | L2-Norm(final)=8.312 | 5481.8 samples/s | 85.7 steps/s
[Step=34250 Epoch=66.8] | Loss=0.01348 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.754 | L2-Norm(final)=8.315 | 5179.3 samples/s | 80.9 steps/s
[Step=34300 Epoch=66.9] | Loss=0.01353 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.758 | L2-Norm(final)=8.319 | 5707.3 samples/s | 89.2 steps/s
[Step=34350 Epoch=67.0] | Loss=0.01333 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.761 | L2-Norm(final)=8.322 | 5157.7 samples/s | 80.6 steps/s
[Step=34400 Epoch=67.1] | Loss=0.01312 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.764 | L2-Norm(final)=8.326 | 5582.3 samples/s | 87.2 steps/s
[Step=34450 Epoch=67.2] | Loss=0.01299 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.768 | L2-Norm(final)=8.330 | 5676.0 samples/s | 88.7 steps/s
[Step=34500 Epoch=67.3] | Loss=0.01289 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.771 | L2-Norm(final)=8.333 | 6108.2 samples/s | 95.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=34501 Epoch=67.3] | Loss=0.00828 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.802 | L2-Norm(final)=8.369 | 3434.9 samples/s | 53.7 steps/s
[Step=34550 Epoch=67.4] | Loss=0.01233 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.807 | L2-Norm(final)=8.373 | 4947.7 samples/s | 77.3 steps/s
[Step=34600 Epoch=67.5] | Loss=0.01078 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=8.377 | 5000.1 samples/s | 78.1 steps/s
[Step=34650 Epoch=67.6] | Loss=0.01154 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.818 | L2-Norm(final)=8.381 | 5145.9 samples/s | 80.4 steps/s
[Step=34700 Epoch=67.7] | Loss=0.01194 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.823 | L2-Norm(final)=8.385 | 5003.1 samples/s | 78.2 steps/s
[Step=34750 Epoch=67.8] | Loss=0.01147 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.827 | L2-Norm(final)=8.388 | 5046.3 samples/s | 78.8 steps/s
[Step=34800 Epoch=67.9] | Loss=0.01113 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.832 | L2-Norm(final)=8.392 | 5050.7 samples/s | 78.9 steps/s
[Step=34850 Epoch=68.0] | Loss=0.01121 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.836 | L2-Norm(final)=8.396 | 5081.9 samples/s | 79.4 steps/s
[Step=34900 Epoch=68.1] | Loss=0.01105 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.841 | L2-Norm(final)=8.399 | 5031.6 samples/s | 78.6 steps/s
[Step=34950 Epoch=68.2] | Loss=0.01074 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=8.403 | 5127.1 samples/s | 80.1 steps/s
[Step=35000 Epoch=68.3] | Loss=0.01066 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.849 | L2-Norm(final)=8.406 | 6180.8 samples/s | 96.6 steps/s
[Step=35050 Epoch=68.4] | Loss=0.01051 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.853 | L2-Norm(final)=8.410 | 1896.3 samples/s | 29.6 steps/s
[Step=35100 Epoch=68.5] | Loss=0.01015 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.857 | L2-Norm(final)=8.413 | 5056.9 samples/s | 79.0 steps/s
[Step=35150 Epoch=68.6] | Loss=0.01003 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.861 | L2-Norm(final)=8.417 | 4994.0 samples/s | 78.0 steps/s
[Step=35200 Epoch=68.7] | Loss=0.00977 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.864 | L2-Norm(final)=8.420 | 5068.3 samples/s | 79.2 steps/s
[Step=35250 Epoch=68.8] | Loss=0.00955 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.868 | L2-Norm(final)=8.423 | 5014.2 samples/s | 78.3 steps/s
[Step=35300 Epoch=68.8] | Loss=0.00952 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.871 | L2-Norm(final)=8.426 | 5114.6 samples/s | 79.9 steps/s
[Step=35350 Epoch=68.9] | Loss=0.00940 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=8.429 | 5009.1 samples/s | 78.3 steps/s
[Step=35400 Epoch=69.0] | Loss=0.00933 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.878 | L2-Norm(final)=8.433 | 5046.5 samples/s | 78.9 steps/s
[Step=35450 Epoch=69.1] | Loss=0.00925 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.881 | L2-Norm(final)=8.436 | 4983.2 samples/s | 77.9 steps/s
[Step=35500 Epoch=69.2] | Loss=0.00926 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.884 | L2-Norm(final)=8.439 | 5390.4 samples/s | 84.2 steps/s
[Step=35550 Epoch=69.3] | Loss=0.00914 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.888 | L2-Norm(final)=8.442 | 1971.7 samples/s | 30.8 steps/s
[Step=35600 Epoch=69.4] | Loss=0.00907 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.891 | L2-Norm(final)=8.445 | 5152.2 samples/s | 80.5 steps/s
[Step=35650 Epoch=69.5] | Loss=0.00890 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.894 | L2-Norm(final)=8.448 | 5016.7 samples/s | 78.4 steps/s
[Step=35700 Epoch=69.6] | Loss=0.00875 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.897 | L2-Norm(final)=8.451 | 4997.8 samples/s | 78.1 steps/s
[Step=35750 Epoch=69.7] | Loss=0.00866 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=8.453 | 5033.7 samples/s | 78.7 steps/s
[Step=35800 Epoch=69.8] | Loss=0.00868 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.903 | L2-Norm(final)=8.456 | 5031.7 samples/s | 78.6 steps/s
[Step=35850 Epoch=69.9] | Loss=0.00857 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.906 | L2-Norm(final)=8.459 | 5075.3 samples/s | 79.3 steps/s
[Step=35900 Epoch=70.0] | Loss=0.00850 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.909 | L2-Norm(final)=8.462 | 4967.3 samples/s | 77.6 steps/s
[Step=35950 Epoch=70.1] | Loss=0.00842 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.911 | L2-Norm(final)=8.465 | 5091.5 samples/s | 79.6 steps/s
[Step=36000 Epoch=70.2] | Loss=0.00835 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.914 | L2-Norm(final)=8.467 | 5073.3 samples/s | 79.3 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step36000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=40001 Epoch=78.2] | Loss=0.00843 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.738 | L2-Norm(final)=8.757 | 3881.8 samples/s | 60.7 steps/s
[Step=40050 Epoch=78.3] | Loss=0.01404 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.742 | L2-Norm(final)=8.760 | 5477.4 samples/s | 85.6 steps/s
[Step=40100 Epoch=78.4] | Loss=0.01210 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.746 | L2-Norm(final)=8.764 | 5686.9 samples/s | 88.9 steps/s
[Step=40150 Epoch=78.5] | Loss=0.01197 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=8.768 | 5698.0 samples/s | 89.0 steps/s
[Step=40200 Epoch=78.6] | Loss=0.01178 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.753 | L2-Norm(final)=8.772 | 5546.6 samples/s | 86.7 steps/s
[Step=40250 Epoch=78.7] | Loss=0.01163 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.757 | L2-Norm(final)=8.776 | 5791.0 samples/s | 90.5 steps/s
[Step=40300 Epoch=78.8] | Loss=0.01153 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.760 | L2-Norm(final)=8.780 | 5605.6 samples/s | 87.6 steps/s
[Step=40350 Epoch=78.9] | Loss=0.01140 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.764 | L2-Norm(final)=8.784 | 5676.8 samples/s | 88.7 steps/s
[Step=40400 Epoch=79.0] | Loss=0.01128 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=8.788 | 5665.4 samples/s | 88.5 steps/s
[Step=40450 Epoch=79.1] | Loss=0.01123 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.770 | L2-Norm(final)=8.792 | 5702.6 samples/s | 89.1 steps/s
[Step=40500 Epoch=79.2] | Loss=0.01103 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.773 | L2-Norm(final)=8.796 | 7157.0 samples/s | 111.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=40501 Epoch=79.2] | Loss=0.01870 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.803 | L2-Norm(final)=8.837 | 3835.2 samples/s | 59.9 steps/s
[Step=40550 Epoch=79.3] | Loss=0.00889 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.809 | L2-Norm(final)=8.842 | 4820.7 samples/s | 75.3 steps/s
[Step=40600 Epoch=79.4] | Loss=0.00913 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.814 | L2-Norm(final)=8.846 | 5105.1 samples/s | 79.8 steps/s
[Step=40650 Epoch=79.5] | Loss=0.00905 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.819 | L2-Norm(final)=8.850 | 5003.8 samples/s | 78.2 steps/s
[Step=40700 Epoch=79.6] | Loss=0.00955 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.824 | L2-Norm(final)=8.855 | 5058.8 samples/s | 79.0 steps/s
[Step=40750 Epoch=79.7] | Loss=0.00987 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.828 | L2-Norm(final)=8.858 | 5050.2 samples/s | 78.9 steps/s
[Step=40800 Epoch=79.8] | Loss=0.00998 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.832 | L2-Norm(final)=8.862 | 5170.5 samples/s | 80.8 steps/s
[Step=40850 Epoch=79.9] | Loss=0.00989 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.836 | L2-Norm(final)=8.865 | 4977.8 samples/s | 77.8 steps/s
[Step=40900 Epoch=80.0] | Loss=0.00991 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=8.868 | 5050.1 samples/s | 78.9 steps/s
[Step=40950 Epoch=80.1] | Loss=0.01005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.844 | L2-Norm(final)=8.871 | 5104.9 samples/s | 79.8 steps/s
[Step=41000 Epoch=80.2] | Loss=0.01001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.847 | L2-Norm(final)=8.874 | 6141.6 samples/s | 96.0 steps/s
[Step=41050 Epoch=80.3] | Loss=0.00975 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.851 | L2-Norm(final)=8.877 | 1931.9 samples/s | 30.2 steps/s
[Step=41100 Epoch=80.3] | Loss=0.00949 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.854 | L2-Norm(final)=8.879 | 5081.0 samples/s | 79.4 steps/s
[Step=41150 Epoch=80.4] | Loss=0.00926 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.858 | L2-Norm(final)=8.883 | 4964.8 samples/s | 77.6 steps/s
[Step=41200 Epoch=80.5] | Loss=0.00907 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.861 | L2-Norm(final)=8.885 | 4973.2 samples/s | 77.7 steps/s
[Step=41250 Epoch=80.6] | Loss=0.00902 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.865 | L2-Norm(final)=8.888 | 5016.3 samples/s | 78.4 steps/s
[Step=41300 Epoch=80.7] | Loss=0.00893 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.868 | L2-Norm(final)=8.891 | 5020.9 samples/s | 78.5 steps/s
[Step=41350 Epoch=80.8] | Loss=0.00885 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.871 | L2-Norm(final)=8.894 | 5141.5 samples/s | 80.3 steps/s
[Step=41400 Epoch=80.9] | Loss=0.00869 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=8.897 | 5062.6 samples/s | 79.1 steps/s
[Step=41450 Epoch=81.0] | Loss=0.00862 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.877 | L2-Norm(final)=8.900 | 5009.3 samples/s | 78.3 steps/s
[Step=41500 Epoch=81.1] | Loss=0.00852 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.880 | L2-Norm(final)=8.903 | 5475.8 samples/s | 85.6 steps/s
[Step=41550 Epoch=81.2] | Loss=0.00839 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.883 | L2-Norm(final)=8.906 | 2026.3 samples/s | 31.7 steps/s
[Step=41600 Epoch=81.3] | Loss=0.00825 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.886 | L2-Norm(final)=8.909 | 4960.9 samples/s | 77.5 steps/s
[Step=41650 Epoch=81.4] | Loss=0.00806 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.889 | L2-Norm(final)=8.911 | 5040.0 samples/s | 78.7 steps/s
[Step=41700 Epoch=81.5] | Loss=0.00794 | Reg=0.00098 | acc=0.9531 | L2-Norm=9.892 | L2-Norm(final)=8.914 | 5113.4 samples/s | 79.9 steps/s
[Step=41750 Epoch=81.6] | Loss=0.00783 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.895 | L2-Norm(final)=8.917 | 5012.7 samples/s | 78.3 steps/s
[Step=41800 Epoch=81.7] | Loss=0.00777 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.898 | L2-Norm(final)=8.920 | 5003.9 samples/s | 78.2 steps/s
[Step=41850 Epoch=81.8] | Loss=0.00778 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=8.923 | 5093.9 samples/s | 79.6 steps/s
[Step=41900 Epoch=81.9] | Loss=0.00775 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.903 | L2-Norm(final)=8.926 | 5027.9 samples/s | 78.6 steps/s
[Step=41950 Epoch=82.0] | Loss=0.00771 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.906 | L2-Norm(final)=8.928 | 5070.4 samples/s | 79.2 steps/s
[Step=42000 Epoch=82.1] | Loss=0.00769 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.909 | L2-Norm(final)=8.931 | 5044.7 samples/s | 78.8 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step42000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05615 | acc=0.9703 | tpr=0.9793 | fpr=0.0493 | 4441.6 samples/s | 17.3 steps/s
Avg test loss: 0.05976, Avg test acc: 0.96935, Avg tpr: 0.97849, Avg fpr: 0.05076, total FA: 396

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05773 | acc=0.9696 | tpr=0.9798 | fpr=0.0525 | 4483.0 samples/s | 17.5 steps/s
Avg test loss: 0.06311, Avg test acc: 0.96875, Avg tpr: 0.97948, Avg fpr: 0.05486, total FA: 428

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.17174 | acc=0.3159 | tpr=0.0300 | fpr=0.0632 | 4438.1 samples/s | 17.3 steps/s
Avg test loss: 5.17600, Avg test acc: 0.31509, Avg tpr: 0.03048, Avg fpr: 0.05897, total FA: 460

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.36105 | acc=0.3068 | tpr=0.0365 | fpr=0.1063 | 4415.4 samples/s | 17.2 steps/s
Avg test loss: 5.35931, Avg test acc: 0.30551, Avg tpr: 0.03713, Avg fpr: 0.10422, total FA: 813

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.19304 | acc=0.1173 | tpr=0.6416 | fpr=0.8921 | 4507.6 samples/s | 17.6 steps/s
[Step= 100] | Loss=5.17258 | acc=0.1169 | tpr=0.6119 | fpr=0.8923 | 8623.7 samples/s | 33.7 steps/s
[Step= 150] | Loss=5.18144 | acc=0.1154 | tpr=0.6081 | fpr=0.8937 | 8972.4 samples/s | 35.0 steps/s
[Step= 200] | Loss=5.17364 | acc=0.1142 | tpr=0.6011 | fpr=0.8946 | 8564.7 samples/s | 33.5 steps/s
[Step= 250] | Loss=5.17582 | acc=0.1143 | tpr=0.6044 | fpr=0.8947 | 8653.5 samples/s | 33.8 steps/s
[Step= 300] | Loss=5.17405 | acc=0.1141 | tpr=0.6087 | fpr=0.8950 | 8918.9 samples/s | 34.8 steps/s
[Step= 350] | Loss=5.17018 | acc=0.1136 | tpr=0.6074 | fpr=0.8953 | 9420.6 samples/s | 36.8 steps/s
[Step= 400] | Loss=5.16935 | acc=0.1138 | tpr=0.6116 | fpr=0.8952 | 8391.2 samples/s | 32.8 steps/s
[Step= 450] | Loss=5.17761 | acc=0.1135 | tpr=0.6071 | fpr=0.8954 | 8595.5 samples/s | 33.6 steps/s
[Step= 500] | Loss=5.18082 | acc=0.1136 | tpr=0.6115 | fpr=0.8954 | 8772.1 samples/s | 34.3 steps/s
[Step= 550] | Loss=5.18428 | acc=0.1138 | tpr=0.6108 | fpr=0.8952 | 15790.1 samples/s | 61.7 steps/s
Avg test loss: 5.18510, Avg test acc: 0.11378, Avg tpr: 0.61173, Avg fpr: 0.89527, total FA: 124307

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.47751 | acc=0.1184 | tpr=0.6814 | fpr=0.8917 | 4436.8 samples/s | 17.3 steps/s
[Step= 100] | Loss=5.45461 | acc=0.1182 | tpr=0.6588 | fpr=0.8919 | 9137.9 samples/s | 35.7 steps/s
[Step= 150] | Loss=5.46645 | acc=0.1167 | tpr=0.6686 | fpr=0.8935 | 8362.9 samples/s | 32.7 steps/s
[Step= 200] | Loss=5.46109 | acc=0.1155 | tpr=0.6634 | fpr=0.8945 | 8848.3 samples/s | 34.6 steps/s
[Step= 250] | Loss=5.46271 | acc=0.1160 | tpr=0.6655 | fpr=0.8940 | 9010.0 samples/s | 35.2 steps/s
[Step= 300] | Loss=5.46199 | acc=0.1158 | tpr=0.6691 | fpr=0.8943 | 8585.1 samples/s | 33.5 steps/s
[Step= 350] | Loss=5.45868 | acc=0.1152 | tpr=0.6669 | fpr=0.8949 | 9026.7 samples/s | 35.3 steps/s
[Step= 400] | Loss=5.45741 | acc=0.1154 | tpr=0.6740 | fpr=0.8947 | 8974.2 samples/s | 35.1 steps/s
[Step= 450] | Loss=5.46489 | acc=0.1149 | tpr=0.6689 | fpr=0.8951 | 8675.2 samples/s | 33.9 steps/s
[Step= 500] | Loss=5.46878 | acc=0.1151 | tpr=0.6740 | fpr=0.8950 | 9237.5 samples/s | 36.1 steps/s
[Step= 550] | Loss=5.47296 | acc=0.1151 | tpr=0.6705 | fpr=0.8950 | 14026.3 samples/s | 54.8 steps/s
Avg test loss: 5.47371, Avg test acc: 0.11503, Avg tpr: 0.67116, Avg fpr: 0.89508, total FA: 124280

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11784 | acc=0.9820 | tpr=0.9336 | fpr=0.0172 | 4427.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.12342 | acc=0.9812 | tpr=0.9446 | fpr=0.0181 | 8847.5 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.12801 | acc=0.9802 | tpr=0.9481 | fpr=0.0192 | 8921.8 samples/s | 34.9 steps/s
[Step= 200] | Loss=0.12852 | acc=0.9805 | tpr=0.9497 | fpr=0.0189 | 8760.6 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.12607 | acc=0.9807 | tpr=0.9476 | fpr=0.0187 | 8739.5 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.12836 | acc=0.9804 | tpr=0.9469 | fpr=0.0190 | 8887.3 samples/s | 34.7 steps/s
[Step= 350] | Loss=0.12967 | acc=0.9802 | tpr=0.9499 | fpr=0.0192 | 8783.1 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.13011 | acc=0.9800 | tpr=0.9497 | fpr=0.0194 | 8941.2 samples/s | 34.9 steps/s
[Step= 450] | Loss=0.13315 | acc=0.9797 | tpr=0.9469 | fpr=0.0197 | 8476.5 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.13260 | acc=0.9797 | tpr=0.9480 | fpr=0.0197 | 9162.4 samples/s | 35.8 steps/s
[Step= 550] | Loss=0.13209 | acc=0.9798 | tpr=0.9459 | fpr=0.0196 | 14753.8 samples/s | 57.6 steps/s
Avg test loss: 0.13176, Avg test acc: 0.97981, Avg tpr: 0.94612, Avg fpr: 0.01958, total FA: 2718

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.13049 | acc=0.9791 | tpr=0.9425 | fpr=0.0202 | 4420.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.13577 | acc=0.9786 | tpr=0.9574 | fpr=0.0210 | 9035.9 samples/s | 35.3 steps/s
[Step= 150] | Loss=0.14038 | acc=0.9777 | tpr=0.9582 | fpr=0.0220 | 9107.0 samples/s | 35.6 steps/s
[Step= 200] | Loss=0.14029 | acc=0.9779 | tpr=0.9574 | fpr=0.0218 | 8305.2 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.13765 | acc=0.9781 | tpr=0.9563 | fpr=0.0215 | 9071.7 samples/s | 35.4 steps/s
[Step= 300] | Loss=0.13981 | acc=0.9778 | tpr=0.9556 | fpr=0.0218 | 8406.7 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.14130 | acc=0.9776 | tpr=0.9568 | fpr=0.0220 | 8812.3 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.14208 | acc=0.9774 | tpr=0.9568 | fpr=0.0223 | 8850.1 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.14517 | acc=0.9771 | tpr=0.9552 | fpr=0.0225 | 9018.1 samples/s | 35.2 steps/s
[Step= 500] | Loss=0.14501 | acc=0.9771 | tpr=0.9568 | fpr=0.0226 | 9293.0 samples/s | 36.3 steps/s
[Step= 550] | Loss=0.14451 | acc=0.9771 | tpr=0.9546 | fpr=0.0225 | 14704.0 samples/s | 57.4 steps/s
Avg test loss: 0.14414, Avg test acc: 0.97712, Avg tpr: 0.95483, Avg fpr: 0.02247, total FA: 3120

server round 46/50

clients selected: [0 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=36001 Epoch=70.2] | Loss=0.01022 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.624 | L2-Norm(final)=8.550 | 3434.0 samples/s | 53.7 steps/s
[Step=36050 Epoch=70.3] | Loss=0.01272 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.627 | L2-Norm(final)=8.553 | 5524.2 samples/s | 86.3 steps/s
[Step=36100 Epoch=70.4] | Loss=0.01313 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.631 | L2-Norm(final)=8.557 | 5694.0 samples/s | 89.0 steps/s
[Step=36150 Epoch=70.5] | Loss=0.01330 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.634 | L2-Norm(final)=8.561 | 5606.2 samples/s | 87.6 steps/s
[Step=36200 Epoch=70.6] | Loss=0.01320 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.638 | L2-Norm(final)=8.565 | 5659.4 samples/s | 88.4 steps/s
[Step=36250 Epoch=70.7] | Loss=0.01301 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.642 | L2-Norm(final)=8.569 | 5709.8 samples/s | 89.2 steps/s
[Step=36300 Epoch=70.8] | Loss=0.01288 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.645 | L2-Norm(final)=8.573 | 5582.3 samples/s | 87.2 steps/s
[Step=36350 Epoch=70.9] | Loss=0.01279 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.649 | L2-Norm(final)=8.577 | 5636.1 samples/s | 88.1 steps/s
[Step=36400 Epoch=71.0] | Loss=0.01289 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.652 | L2-Norm(final)=8.581 | 5703.5 samples/s | 89.1 steps/s
[Step=36450 Epoch=71.1] | Loss=0.01273 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.655 | L2-Norm(final)=8.585 | 5591.7 samples/s | 87.4 steps/s
[Step=36500 Epoch=71.2] | Loss=0.01272 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.658 | L2-Norm(final)=8.588 | 7135.5 samples/s | 111.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=36501 Epoch=71.2] | Loss=0.00245 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.689 | L2-Norm(final)=8.627 | 3655.5 samples/s | 57.1 steps/s
[Step=36550 Epoch=71.3] | Loss=0.01307 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.694 | L2-Norm(final)=8.631 | 4969.1 samples/s | 77.6 steps/s
[Step=36600 Epoch=71.4] | Loss=0.01369 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.700 | L2-Norm(final)=8.634 | 5057.5 samples/s | 79.0 steps/s
[Step=36650 Epoch=71.5] | Loss=0.01283 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.705 | L2-Norm(final)=8.637 | 5058.4 samples/s | 79.0 steps/s
[Step=36700 Epoch=71.6] | Loss=0.01232 | Reg=0.00094 | acc=0.9688 | L2-Norm=9.709 | L2-Norm(final)=8.640 | 4994.3 samples/s | 78.0 steps/s
[Step=36750 Epoch=71.7] | Loss=0.01203 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.713 | L2-Norm(final)=8.644 | 5020.4 samples/s | 78.4 steps/s
[Step=36800 Epoch=71.8] | Loss=0.01213 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.718 | L2-Norm(final)=8.647 | 5106.2 samples/s | 79.8 steps/s
[Step=36850 Epoch=71.9] | Loss=0.01185 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.722 | L2-Norm(final)=8.650 | 4994.2 samples/s | 78.0 steps/s
[Step=36900 Epoch=72.0] | Loss=0.01166 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.726 | L2-Norm(final)=8.654 | 5138.3 samples/s | 80.3 steps/s
[Step=36950 Epoch=72.1] | Loss=0.01137 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.730 | L2-Norm(final)=8.657 | 4997.3 samples/s | 78.1 steps/s
[Step=37000 Epoch=72.2] | Loss=0.01119 | Reg=0.00095 | acc=0.9531 | L2-Norm=9.735 | L2-Norm(final)=8.660 | 6140.1 samples/s | 95.9 steps/s
[Step=37050 Epoch=72.3] | Loss=0.01083 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.739 | L2-Norm(final)=8.664 | 1895.8 samples/s | 29.6 steps/s
[Step=37100 Epoch=72.4] | Loss=0.01056 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.742 | L2-Norm(final)=8.667 | 5008.8 samples/s | 78.3 steps/s
[Step=37150 Epoch=72.5] | Loss=0.01020 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.746 | L2-Norm(final)=8.670 | 5072.4 samples/s | 79.3 steps/s
[Step=37200 Epoch=72.6] | Loss=0.01002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.749 | L2-Norm(final)=8.673 | 5030.4 samples/s | 78.6 steps/s
[Step=37250 Epoch=72.7] | Loss=0.00986 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.753 | L2-Norm(final)=8.676 | 5019.9 samples/s | 78.4 steps/s
[Step=37300 Epoch=72.7] | Loss=0.00967 | Reg=0.00095 | acc=0.9531 | L2-Norm=9.756 | L2-Norm(final)=8.680 | 5072.6 samples/s | 79.3 steps/s
[Step=37350 Epoch=72.8] | Loss=0.00960 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.760 | L2-Norm(final)=8.683 | 5054.7 samples/s | 79.0 steps/s
[Step=37400 Epoch=72.9] | Loss=0.00962 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.763 | L2-Norm(final)=8.686 | 5090.1 samples/s | 79.5 steps/s
[Step=37450 Epoch=73.0] | Loss=0.00952 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.766 | L2-Norm(final)=8.689 | 5055.4 samples/s | 79.0 steps/s
[Step=37500 Epoch=73.1] | Loss=0.00943 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.769 | L2-Norm(final)=8.692 | 5349.7 samples/s | 83.6 steps/s
[Step=37550 Epoch=73.2] | Loss=0.00931 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.772 | L2-Norm(final)=8.695 | 1967.7 samples/s | 30.7 steps/s
[Step=37600 Epoch=73.3] | Loss=0.00917 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.776 | L2-Norm(final)=8.698 | 4990.4 samples/s | 78.0 steps/s
[Step=37650 Epoch=73.4] | Loss=0.00901 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.779 | L2-Norm(final)=8.700 | 5045.5 samples/s | 78.8 steps/s
[Step=37700 Epoch=73.5] | Loss=0.00894 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.782 | L2-Norm(final)=8.703 | 5033.6 samples/s | 78.7 steps/s
[Step=37750 Epoch=73.6] | Loss=0.00884 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.785 | L2-Norm(final)=8.706 | 5074.3 samples/s | 79.3 steps/s
[Step=37800 Epoch=73.7] | Loss=0.00877 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.788 | L2-Norm(final)=8.709 | 5030.7 samples/s | 78.6 steps/s
[Step=37850 Epoch=73.8] | Loss=0.00871 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.791 | L2-Norm(final)=8.712 | 5062.2 samples/s | 79.1 steps/s
[Step=37900 Epoch=73.9] | Loss=0.00860 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.793 | L2-Norm(final)=8.715 | 5052.4 samples/s | 78.9 steps/s
[Step=37950 Epoch=74.0] | Loss=0.00857 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.796 | L2-Norm(final)=8.717 | 5049.4 samples/s | 78.9 steps/s
[Step=38000 Epoch=74.1] | Loss=0.00853 | Reg=0.00096 | acc=0.9688 | L2-Norm=9.799 | L2-Norm(final)=8.720 | 5041.5 samples/s | 78.8 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step38000.h5

Train client 3: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=52001 Epoch=200.2] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.624 | L2-Norm(final)=8.919 | 3950.0 samples/s | 61.7 steps/s
[Step=52050 Epoch=200.4] | Loss=0.00007 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.617 | L2-Norm(final)=8.925 | 4946.5 samples/s | 77.3 steps/s
[Step=52100 Epoch=200.6] | Loss=0.00012 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.619 | L2-Norm(final)=8.934 | 5338.8 samples/s | 83.4 steps/s
[Step=52150 Epoch=200.7] | Loss=0.00009 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.623 | L2-Norm(final)=8.938 | 5415.6 samples/s | 84.6 steps/s
[Step=52200 Epoch=200.9] | Loss=0.00007 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.624 | L2-Norm(final)=8.942 | 5356.5 samples/s | 83.7 steps/s
[Step=52250 Epoch=201.1] | Loss=0.00006 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.623 | L2-Norm(final)=8.945 | 6989.9 samples/s | 109.2 steps/s
[Step=52300 Epoch=201.3] | Loss=0.00006 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.622 | L2-Norm(final)=8.947 | 1912.2 samples/s | 29.9 steps/s
[Step=52350 Epoch=201.5] | Loss=0.00005 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.621 | L2-Norm(final)=8.950 | 5347.9 samples/s | 83.6 steps/s
[Step=52400 Epoch=201.7] | Loss=0.00005 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.619 | L2-Norm(final)=8.952 | 5391.1 samples/s | 84.2 steps/s
[Step=52450 Epoch=201.9] | Loss=0.00004 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.617 | L2-Norm(final)=8.953 | 5425.1 samples/s | 84.8 steps/s
[Step=52500 Epoch=202.1] | Loss=0.00004 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.615 | L2-Norm(final)=8.955 | 6089.9 samples/s | 95.2 steps/s
All layers training...
LR=0.00006, len=1
[Step=52501 Epoch=202.1] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.592 | L2-Norm(final)=8.974 | 3909.5 samples/s | 61.1 steps/s
[Step=52550 Epoch=202.3] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.580 | L2-Norm(final)=8.976 | 4461.2 samples/s | 69.7 steps/s
[Step=52600 Epoch=202.5] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.564 | L2-Norm(final)=8.977 | 4789.7 samples/s | 74.8 steps/s
[Step=52650 Epoch=202.7] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.548 | L2-Norm(final)=8.978 | 4801.3 samples/s | 75.0 steps/s
[Step=52700 Epoch=202.9] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.530 | L2-Norm(final)=8.979 | 4810.0 samples/s | 75.2 steps/s
[Step=52750 Epoch=203.1] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.513 | L2-Norm(final)=8.979 | 6158.3 samples/s | 96.2 steps/s
[Step=52800 Epoch=203.2] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.495 | L2-Norm(final)=8.980 | 1867.9 samples/s | 29.2 steps/s
[Step=52850 Epoch=203.4] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.477 | L2-Norm(final)=8.981 | 4779.4 samples/s | 74.7 steps/s
[Step=52900 Epoch=203.6] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.459 | L2-Norm(final)=8.981 | 4752.0 samples/s | 74.2 steps/s
[Step=52950 Epoch=203.8] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.440 | L2-Norm(final)=8.982 | 4773.8 samples/s | 74.6 steps/s
[Step=53000 Epoch=204.0] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.422 | L2-Norm(final)=8.982 | 5403.0 samples/s | 84.4 steps/s
[Step=53050 Epoch=204.2] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.403 | L2-Norm(final)=8.983 | 1952.3 samples/s | 30.5 steps/s
[Step=53100 Epoch=204.4] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.383 | L2-Norm(final)=8.983 | 4802.7 samples/s | 75.0 steps/s
[Step=53150 Epoch=204.6] | Loss=0.00000 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.364 | L2-Norm(final)=8.984 | 4692.8 samples/s | 73.3 steps/s
[Step=53200 Epoch=204.8] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.344 | L2-Norm(final)=8.984 | 4802.2 samples/s | 75.0 steps/s
[Step=53250 Epoch=205.0] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.325 | L2-Norm(final)=8.985 | 4893.6 samples/s | 76.5 steps/s
[Step=53300 Epoch=205.2] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.305 | L2-Norm(final)=8.985 | 2016.8 samples/s | 31.5 steps/s
[Step=53350 Epoch=205.4] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.285 | L2-Norm(final)=8.985 | 4761.4 samples/s | 74.4 steps/s
[Step=53400 Epoch=205.6] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.265 | L2-Norm(final)=8.986 | 4793.6 samples/s | 74.9 steps/s
[Step=53450 Epoch=205.8] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.245 | L2-Norm(final)=8.986 | 4754.8 samples/s | 74.3 steps/s
[Step=53500 Epoch=205.9] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.224 | L2-Norm(final)=8.987 | 4791.9 samples/s | 74.9 steps/s
[Step=53550 Epoch=206.1] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.204 | L2-Norm(final)=8.987 | 2020.1 samples/s | 31.6 steps/s
[Step=53600 Epoch=206.3] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.183 | L2-Norm(final)=8.988 | 4848.7 samples/s | 75.8 steps/s
[Step=53650 Epoch=206.5] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.162 | L2-Norm(final)=8.988 | 4827.1 samples/s | 75.4 steps/s
[Step=53700 Epoch=206.7] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.141 | L2-Norm(final)=8.989 | 4699.5 samples/s | 73.4 steps/s
[Step=53750 Epoch=206.9] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.120 | L2-Norm(final)=8.989 | 4811.9 samples/s | 75.2 steps/s
[Step=53800 Epoch=207.1] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.099 | L2-Norm(final)=8.990 | 6999.3 samples/s | 109.4 steps/s
[Step=53850 Epoch=207.3] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.078 | L2-Norm(final)=8.990 | 1798.9 samples/s | 28.1 steps/s
[Step=53900 Epoch=207.5] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.057 | L2-Norm(final)=8.991 | 4766.2 samples/s | 74.5 steps/s
[Step=53950 Epoch=207.7] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.036 | L2-Norm(final)=8.991 | 4877.2 samples/s | 76.2 steps/s
[Step=54000 Epoch=207.9] | Loss=0.00000 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.014 | L2-Norm(final)=8.992 | 4684.5 samples/s | 73.2 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_1/client_state-step54000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05651 | acc=0.9700 | tpr=0.9799 | fpr=0.0515 | 4438.9 samples/s | 17.3 steps/s
Avg test loss: 0.06005, Avg test acc: 0.96939, Avg tpr: 0.97913, Avg fpr: 0.05204, total FA: 406

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05773 | acc=0.9696 | tpr=0.9798 | fpr=0.0525 | 4420.0 samples/s | 17.3 steps/s
Avg test loss: 0.06311, Avg test acc: 0.96875, Avg tpr: 0.97948, Avg fpr: 0.05486, total FA: 428

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.17174 | acc=0.3159 | tpr=0.0300 | fpr=0.0632 | 4455.5 samples/s | 17.4 steps/s
Avg test loss: 5.17600, Avg test acc: 0.31509, Avg tpr: 0.03048, Avg fpr: 0.05897, total FA: 460

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.28093 | acc=0.3083 | tpr=0.0323 | fpr=0.0924 | 4498.9 samples/s | 17.6 steps/s
Avg test loss: 5.28080, Avg test acc: 0.30736, Avg tpr: 0.03281, Avg fpr: 0.08883, total FA: 693

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.26875 | acc=0.1143 | tpr=0.6416 | fpr=0.8952 | 4475.0 samples/s | 17.5 steps/s
[Step= 100] | Loss=5.24793 | acc=0.1142 | tpr=0.6119 | fpr=0.8951 | 8553.9 samples/s | 33.4 steps/s
[Step= 150] | Loss=5.25640 | acc=0.1127 | tpr=0.6052 | fpr=0.8964 | 8948.7 samples/s | 35.0 steps/s
[Step= 200] | Loss=5.24868 | acc=0.1114 | tpr=0.5978 | fpr=0.8974 | 8725.5 samples/s | 34.1 steps/s
[Step= 250] | Loss=5.25152 | acc=0.1114 | tpr=0.5991 | fpr=0.8975 | 8616.2 samples/s | 33.7 steps/s
[Step= 300] | Loss=5.24927 | acc=0.1114 | tpr=0.6095 | fpr=0.8976 | 8941.0 samples/s | 34.9 steps/s
[Step= 350] | Loss=5.24568 | acc=0.1110 | tpr=0.6055 | fpr=0.8980 | 9200.5 samples/s | 35.9 steps/s
[Step= 400] | Loss=5.24431 | acc=0.1112 | tpr=0.6100 | fpr=0.8979 | 8462.7 samples/s | 33.1 steps/s
[Step= 450] | Loss=5.25262 | acc=0.1108 | tpr=0.6061 | fpr=0.8982 | 8987.0 samples/s | 35.1 steps/s
[Step= 500] | Loss=5.25611 | acc=0.1110 | tpr=0.6097 | fpr=0.8980 | 8670.1 samples/s | 33.9 steps/s
[Step= 550] | Loss=5.25984 | acc=0.1112 | tpr=0.6096 | fpr=0.8978 | 15917.1 samples/s | 62.2 steps/s
Avg test loss: 5.26064, Avg test acc: 0.11119, Avg tpr: 0.61054, Avg fpr: 0.89789, total FA: 124670

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.47751 | acc=0.1184 | tpr=0.6814 | fpr=0.8917 | 4428.5 samples/s | 17.3 steps/s
[Step= 100] | Loss=5.45461 | acc=0.1182 | tpr=0.6588 | fpr=0.8919 | 8851.5 samples/s | 34.6 steps/s
[Step= 150] | Loss=5.46645 | acc=0.1167 | tpr=0.6686 | fpr=0.8935 | 8585.9 samples/s | 33.5 steps/s
[Step= 200] | Loss=5.46109 | acc=0.1155 | tpr=0.6634 | fpr=0.8945 | 9130.1 samples/s | 35.7 steps/s
[Step= 250] | Loss=5.46271 | acc=0.1160 | tpr=0.6655 | fpr=0.8940 | 8577.2 samples/s | 33.5 steps/s
[Step= 300] | Loss=5.46199 | acc=0.1158 | tpr=0.6691 | fpr=0.8943 | 8557.0 samples/s | 33.4 steps/s
[Step= 350] | Loss=5.45868 | acc=0.1152 | tpr=0.6669 | fpr=0.8949 | 8939.7 samples/s | 34.9 steps/s
[Step= 400] | Loss=5.45741 | acc=0.1154 | tpr=0.6740 | fpr=0.8947 | 8613.5 samples/s | 33.6 steps/s
[Step= 450] | Loss=5.46489 | acc=0.1149 | tpr=0.6689 | fpr=0.8951 | 8803.0 samples/s | 34.4 steps/s
[Step= 500] | Loss=5.46878 | acc=0.1151 | tpr=0.6740 | fpr=0.8950 | 8765.2 samples/s | 34.2 steps/s
[Step= 550] | Loss=5.47296 | acc=0.1151 | tpr=0.6705 | fpr=0.8950 | 15876.7 samples/s | 62.0 steps/s
Avg test loss: 5.47371, Avg test acc: 0.11503, Avg tpr: 0.67116, Avg fpr: 0.89508, total FA: 124280

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11784 | acc=0.9820 | tpr=0.9336 | fpr=0.0172 | 4522.2 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.12342 | acc=0.9812 | tpr=0.9446 | fpr=0.0181 | 8482.0 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.12801 | acc=0.9802 | tpr=0.9481 | fpr=0.0192 | 9008.0 samples/s | 35.2 steps/s
[Step= 200] | Loss=0.12852 | acc=0.9805 | tpr=0.9497 | fpr=0.0189 | 8503.1 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.12607 | acc=0.9807 | tpr=0.9476 | fpr=0.0187 | 8776.5 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.12836 | acc=0.9804 | tpr=0.9469 | fpr=0.0190 | 9005.4 samples/s | 35.2 steps/s
[Step= 350] | Loss=0.12967 | acc=0.9802 | tpr=0.9499 | fpr=0.0192 | 8711.5 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.13011 | acc=0.9800 | tpr=0.9497 | fpr=0.0194 | 8768.3 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.13315 | acc=0.9797 | tpr=0.9469 | fpr=0.0197 | 8819.4 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.13260 | acc=0.9797 | tpr=0.9480 | fpr=0.0197 | 9087.6 samples/s | 35.5 steps/s
[Step= 550] | Loss=0.13209 | acc=0.9798 | tpr=0.9459 | fpr=0.0196 | 14494.7 samples/s | 56.6 steps/s
Avg test loss: 0.13176, Avg test acc: 0.97981, Avg tpr: 0.94612, Avg fpr: 0.01958, total FA: 2718

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12251 | acc=0.9795 | tpr=0.9469 | fpr=0.0200 | 4441.3 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.12671 | acc=0.9791 | tpr=0.9574 | fpr=0.0205 | 8902.7 samples/s | 34.8 steps/s
[Step= 150] | Loss=0.13097 | acc=0.9781 | tpr=0.9597 | fpr=0.0216 | 8801.3 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.13112 | acc=0.9783 | tpr=0.9607 | fpr=0.0214 | 8775.9 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.12855 | acc=0.9786 | tpr=0.9598 | fpr=0.0211 | 8838.5 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.13053 | acc=0.9783 | tpr=0.9607 | fpr=0.0214 | 8663.2 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.13191 | acc=0.9779 | tpr=0.9612 | fpr=0.0218 | 8926.5 samples/s | 34.9 steps/s
[Step= 400] | Loss=0.13250 | acc=0.9776 | tpr=0.9606 | fpr=0.0220 | 8828.9 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.13533 | acc=0.9774 | tpr=0.9596 | fpr=0.0223 | 8832.3 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.13530 | acc=0.9774 | tpr=0.9612 | fpr=0.0223 | 8515.1 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.13472 | acc=0.9774 | tpr=0.9598 | fpr=0.0222 | 16458.2 samples/s | 64.3 steps/s
Avg test loss: 0.13439, Avg test acc: 0.97746, Avg tpr: 0.95998, Avg fpr: 0.02222, total FA: 3085

server round 47/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=38001 Epoch=74.1] | Loss=0.00680 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.409 | L2-Norm(final)=8.802 | 3572.3 samples/s | 55.8 steps/s
[Step=38050 Epoch=74.2] | Loss=0.01751 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.413 | L2-Norm(final)=8.804 | 5339.6 samples/s | 83.4 steps/s
[Step=38100 Epoch=74.3] | Loss=0.01715 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.417 | L2-Norm(final)=8.807 | 5617.6 samples/s | 87.8 steps/s
[Step=38150 Epoch=74.4] | Loss=0.01667 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.421 | L2-Norm(final)=8.811 | 5643.7 samples/s | 88.2 steps/s
[Step=38200 Epoch=74.5] | Loss=0.01608 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.424 | L2-Norm(final)=8.815 | 5626.8 samples/s | 87.9 steps/s
[Step=38250 Epoch=74.6] | Loss=0.01575 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.428 | L2-Norm(final)=8.818 | 5675.4 samples/s | 88.7 steps/s
[Step=38300 Epoch=74.7] | Loss=0.01539 | Reg=0.00089 | acc=0.9688 | L2-Norm=9.431 | L2-Norm(final)=8.822 | 5646.6 samples/s | 88.2 steps/s
[Step=38350 Epoch=74.8] | Loss=0.01496 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.435 | L2-Norm(final)=8.826 | 5667.4 samples/s | 88.6 steps/s
[Step=38400 Epoch=74.9] | Loss=0.01483 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.438 | L2-Norm(final)=8.830 | 5725.6 samples/s | 89.5 steps/s
[Step=38450 Epoch=75.0] | Loss=0.01447 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.441 | L2-Norm(final)=8.833 | 5568.6 samples/s | 87.0 steps/s
[Step=38500 Epoch=75.1] | Loss=0.01441 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.444 | L2-Norm(final)=8.837 | 7132.2 samples/s | 111.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=38501 Epoch=75.1] | Loss=0.01196 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.475 | L2-Norm(final)=8.874 | 4008.6 samples/s | 62.6 steps/s
[Step=38550 Epoch=75.2] | Loss=0.01398 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.480 | L2-Norm(final)=8.878 | 4482.9 samples/s | 70.0 steps/s
[Step=38600 Epoch=75.3] | Loss=0.01427 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.486 | L2-Norm(final)=8.882 | 4975.3 samples/s | 77.7 steps/s
[Step=38650 Epoch=75.4] | Loss=0.01358 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.491 | L2-Norm(final)=8.885 | 4955.6 samples/s | 77.4 steps/s
[Step=38700 Epoch=75.5] | Loss=0.01343 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.496 | L2-Norm(final)=8.889 | 5075.8 samples/s | 79.3 steps/s
[Step=38750 Epoch=75.6] | Loss=0.01310 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.501 | L2-Norm(final)=8.892 | 5014.4 samples/s | 78.4 steps/s
[Step=38800 Epoch=75.7] | Loss=0.01299 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.505 | L2-Norm(final)=8.896 | 5121.3 samples/s | 80.0 steps/s
[Step=38850 Epoch=75.8] | Loss=0.01263 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.510 | L2-Norm(final)=8.899 | 5048.6 samples/s | 78.9 steps/s
[Step=38900 Epoch=75.9] | Loss=0.01239 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.514 | L2-Norm(final)=8.902 | 4993.0 samples/s | 78.0 steps/s
[Step=38950 Epoch=76.0] | Loss=0.01221 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.518 | L2-Norm(final)=8.906 | 5122.2 samples/s | 80.0 steps/s
[Step=39000 Epoch=76.1] | Loss=0.01200 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.522 | L2-Norm(final)=8.909 | 6061.5 samples/s | 94.7 steps/s
[Step=39050 Epoch=76.2] | Loss=0.01155 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.526 | L2-Norm(final)=8.912 | 1862.0 samples/s | 29.1 steps/s
[Step=39100 Epoch=76.3] | Loss=0.01126 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.530 | L2-Norm(final)=8.916 | 5016.8 samples/s | 78.4 steps/s
[Step=39150 Epoch=76.4] | Loss=0.01118 | Reg=0.00091 | acc=0.9688 | L2-Norm=9.534 | L2-Norm(final)=8.919 | 5008.6 samples/s | 78.3 steps/s
[Step=39200 Epoch=76.5] | Loss=0.01095 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.538 | L2-Norm(final)=8.922 | 5041.2 samples/s | 78.8 steps/s
[Step=39250 Epoch=76.6] | Loss=0.01084 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.541 | L2-Norm(final)=8.925 | 5028.6 samples/s | 78.6 steps/s
[Step=39300 Epoch=76.7] | Loss=0.01063 | Reg=0.00091 | acc=0.9688 | L2-Norm=9.545 | L2-Norm(final)=8.929 | 5016.1 samples/s | 78.4 steps/s
[Step=39350 Epoch=76.7] | Loss=0.01043 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.549 | L2-Norm(final)=8.932 | 5097.6 samples/s | 79.6 steps/s
[Step=39400 Epoch=76.8] | Loss=0.01020 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.552 | L2-Norm(final)=8.935 | 5030.3 samples/s | 78.6 steps/s
[Step=39450 Epoch=76.9] | Loss=0.01008 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.555 | L2-Norm(final)=8.938 | 5078.5 samples/s | 79.4 steps/s
[Step=39500 Epoch=77.0] | Loss=0.01000 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.559 | L2-Norm(final)=8.941 | 5352.6 samples/s | 83.6 steps/s
[Step=39550 Epoch=77.1] | Loss=0.00995 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.562 | L2-Norm(final)=8.944 | 1984.6 samples/s | 31.0 steps/s
[Step=39600 Epoch=77.2] | Loss=0.00977 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.566 | L2-Norm(final)=8.947 | 5143.9 samples/s | 80.4 steps/s
[Step=39650 Epoch=77.3] | Loss=0.00966 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.569 | L2-Norm(final)=8.950 | 4980.9 samples/s | 77.8 steps/s
[Step=39700 Epoch=77.4] | Loss=0.00964 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.572 | L2-Norm(final)=8.953 | 5071.0 samples/s | 79.2 steps/s
[Step=39750 Epoch=77.5] | Loss=0.00955 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.575 | L2-Norm(final)=8.956 | 5030.3 samples/s | 78.6 steps/s
[Step=39800 Epoch=77.6] | Loss=0.00942 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.578 | L2-Norm(final)=8.959 | 5099.4 samples/s | 79.7 steps/s
[Step=39850 Epoch=77.7] | Loss=0.00930 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.581 | L2-Norm(final)=8.962 | 4966.7 samples/s | 77.6 steps/s
[Step=39900 Epoch=77.8] | Loss=0.00914 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.584 | L2-Norm(final)=8.965 | 5048.8 samples/s | 78.9 steps/s
[Step=39950 Epoch=77.9] | Loss=0.00905 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.587 | L2-Norm(final)=8.968 | 5092.0 samples/s | 79.6 steps/s
[Step=40000 Epoch=78.0] | Loss=0.00897 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.590 | L2-Norm(final)=8.971 | 4947.5 samples/s | 77.3 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step40000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=42001 Epoch=82.1] | Loss=0.00924 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.409 | L2-Norm(final)=9.010 | 3801.3 samples/s | 59.4 steps/s
[Step=42050 Epoch=82.2] | Loss=0.01252 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.414 | L2-Norm(final)=9.014 | 5517.6 samples/s | 86.2 steps/s
[Step=42100 Epoch=82.3] | Loss=0.01320 | Reg=0.00089 | acc=0.9531 | L2-Norm=9.418 | L2-Norm(final)=9.019 | 5616.6 samples/s | 87.8 steps/s
[Step=42150 Epoch=82.4] | Loss=0.01315 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.422 | L2-Norm(final)=9.023 | 5838.2 samples/s | 91.2 steps/s
[Step=42200 Epoch=82.5] | Loss=0.01289 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.426 | L2-Norm(final)=9.027 | 5611.2 samples/s | 87.7 steps/s
[Step=42250 Epoch=82.6] | Loss=0.01246 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.430 | L2-Norm(final)=9.031 | 5616.9 samples/s | 87.8 steps/s
[Step=42300 Epoch=82.7] | Loss=0.01276 | Reg=0.00089 | acc=0.9688 | L2-Norm=9.434 | L2-Norm(final)=9.035 | 5605.0 samples/s | 87.6 steps/s
[Step=42350 Epoch=82.8] | Loss=0.01248 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.437 | L2-Norm(final)=9.040 | 5675.3 samples/s | 88.7 steps/s
[Step=42400 Epoch=82.9] | Loss=0.01237 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.441 | L2-Norm(final)=9.044 | 5734.7 samples/s | 89.6 steps/s
[Step=42450 Epoch=83.0] | Loss=0.01239 | Reg=0.00089 | acc=0.9688 | L2-Norm=9.444 | L2-Norm(final)=9.048 | 5581.0 samples/s | 87.2 steps/s
[Step=42500 Epoch=83.1] | Loss=0.01233 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.448 | L2-Norm(final)=9.052 | 7224.4 samples/s | 112.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=83.1] | Loss=0.01074 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.482 | L2-Norm(final)=9.092 | 3807.7 samples/s | 59.5 steps/s
[Step=42550 Epoch=83.2] | Loss=0.01124 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.487 | L2-Norm(final)=9.096 | 4981.5 samples/s | 77.8 steps/s
[Step=42600 Epoch=83.3] | Loss=0.01391 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.492 | L2-Norm(final)=9.099 | 5030.4 samples/s | 78.6 steps/s
[Step=42650 Epoch=83.4] | Loss=0.01301 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.498 | L2-Norm(final)=9.102 | 5009.3 samples/s | 78.3 steps/s
[Step=42700 Epoch=83.5] | Loss=0.01208 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.502 | L2-Norm(final)=9.105 | 4939.3 samples/s | 77.2 steps/s
[Step=42750 Epoch=83.6] | Loss=0.01179 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.507 | L2-Norm(final)=9.109 | 5045.3 samples/s | 78.8 steps/s
[Step=42800 Epoch=83.7] | Loss=0.01175 | Reg=0.00090 | acc=0.9688 | L2-Norm=9.511 | L2-Norm(final)=9.112 | 5104.2 samples/s | 79.8 steps/s
[Step=42850 Epoch=83.8] | Loss=0.01139 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.515 | L2-Norm(final)=9.115 | 4985.8 samples/s | 77.9 steps/s
[Step=42900 Epoch=83.9] | Loss=0.01110 | Reg=0.00091 | acc=0.9688 | L2-Norm=9.519 | L2-Norm(final)=9.119 | 5093.5 samples/s | 79.6 steps/s
[Step=42950 Epoch=84.0] | Loss=0.01093 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.524 | L2-Norm(final)=9.122 | 5062.8 samples/s | 79.1 steps/s
[Step=43000 Epoch=84.1] | Loss=0.01069 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.528 | L2-Norm(final)=9.126 | 6214.2 samples/s | 97.1 steps/s
[Step=43050 Epoch=84.2] | Loss=0.01064 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.532 | L2-Norm(final)=9.129 | 1928.1 samples/s | 30.1 steps/s
[Step=43100 Epoch=84.3] | Loss=0.01033 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=9.132 | 5086.6 samples/s | 79.5 steps/s
[Step=43150 Epoch=84.4] | Loss=0.01008 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=9.136 | 4953.0 samples/s | 77.4 steps/s
[Step=43200 Epoch=84.5] | Loss=0.00987 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.543 | L2-Norm(final)=9.139 | 5048.6 samples/s | 78.9 steps/s
[Step=43250 Epoch=84.6] | Loss=0.00977 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.547 | L2-Norm(final)=9.142 | 5094.8 samples/s | 79.6 steps/s
[Step=43300 Epoch=84.7] | Loss=0.00971 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.550 | L2-Norm(final)=9.145 | 4973.7 samples/s | 77.7 steps/s
[Step=43350 Epoch=84.7] | Loss=0.00964 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.554 | L2-Norm(final)=9.148 | 5069.9 samples/s | 79.2 steps/s
[Step=43400 Epoch=84.8] | Loss=0.00944 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.557 | L2-Norm(final)=9.151 | 4981.4 samples/s | 77.8 steps/s
[Step=43450 Epoch=84.9] | Loss=0.00930 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.560 | L2-Norm(final)=9.154 | 5031.9 samples/s | 78.6 steps/s
[Step=43500 Epoch=85.0] | Loss=0.00923 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.564 | L2-Norm(final)=9.157 | 5520.1 samples/s | 86.3 steps/s
[Step=43550 Epoch=85.1] | Loss=0.00906 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.567 | L2-Norm(final)=9.160 | 2007.3 samples/s | 31.4 steps/s
[Step=43600 Epoch=85.2] | Loss=0.00893 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.570 | L2-Norm(final)=9.163 | 5079.2 samples/s | 79.4 steps/s
[Step=43650 Epoch=85.3] | Loss=0.00880 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.573 | L2-Norm(final)=9.166 | 5052.1 samples/s | 78.9 steps/s
[Step=43700 Epoch=85.4] | Loss=0.00868 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=9.169 | 5097.4 samples/s | 79.6 steps/s
[Step=43750 Epoch=85.5] | Loss=0.00862 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.579 | L2-Norm(final)=9.172 | 4960.6 samples/s | 77.5 steps/s
[Step=43800 Epoch=85.6] | Loss=0.00849 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.582 | L2-Norm(final)=9.175 | 5060.8 samples/s | 79.1 steps/s
[Step=43850 Epoch=85.7] | Loss=0.00839 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.585 | L2-Norm(final)=9.177 | 5102.2 samples/s | 79.7 steps/s
[Step=43900 Epoch=85.8] | Loss=0.00837 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.588 | L2-Norm(final)=9.180 | 5026.2 samples/s | 78.5 steps/s
[Step=43950 Epoch=85.9] | Loss=0.00832 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.591 | L2-Norm(final)=9.183 | 5122.8 samples/s | 80.0 steps/s
[Step=44000 Epoch=86.0] | Loss=0.00828 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.594 | L2-Norm(final)=9.186 | 5050.0 samples/s | 78.9 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step44000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05626 | acc=0.9700 | tpr=0.9791 | fpr=0.0498 | 4430.2 samples/s | 17.3 steps/s
Avg test loss: 0.05985, Avg test acc: 0.96871, Avg tpr: 0.97762, Avg fpr: 0.05089, total FA: 397

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05941 | acc=0.9686 | tpr=0.9792 | fpr=0.0545 | 4500.6 samples/s | 17.6 steps/s
Avg test loss: 0.06408, Avg test acc: 0.96799, Avg tpr: 0.97896, Avg fpr: 0.05615, total FA: 438

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.17174 | acc=0.3159 | tpr=0.0300 | fpr=0.0632 | 4500.6 samples/s | 17.6 steps/s
Avg test loss: 5.17600, Avg test acc: 0.31509, Avg tpr: 0.03048, Avg fpr: 0.05897, total FA: 460

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.28093 | acc=0.3083 | tpr=0.0323 | fpr=0.0924 | 4596.4 samples/s | 18.0 steps/s
Avg test loss: 5.28080, Avg test acc: 0.30736, Avg tpr: 0.03281, Avg fpr: 0.08883, total FA: 693

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.98810 | acc=0.1252 | tpr=0.6372 | fpr=0.8840 | 4488.2 samples/s | 17.5 steps/s
[Step= 100] | Loss=4.96798 | acc=0.1252 | tpr=0.5970 | fpr=0.8836 | 8238.5 samples/s | 32.2 steps/s
[Step= 150] | Loss=4.97556 | acc=0.1230 | tpr=0.5922 | fpr=0.8857 | 8654.1 samples/s | 33.8 steps/s
[Step= 200] | Loss=4.96686 | acc=0.1217 | tpr=0.5825 | fpr=0.8867 | 8610.4 samples/s | 33.6 steps/s
[Step= 250] | Loss=4.96877 | acc=0.1218 | tpr=0.5860 | fpr=0.8867 | 8852.9 samples/s | 34.6 steps/s
[Step= 300] | Loss=4.96643 | acc=0.1214 | tpr=0.5913 | fpr=0.8872 | 8870.5 samples/s | 34.7 steps/s
[Step= 350] | Loss=4.96292 | acc=0.1206 | tpr=0.5880 | fpr=0.8878 | 8692.1 samples/s | 34.0 steps/s
[Step= 400] | Loss=4.96172 | acc=0.1208 | tpr=0.5941 | fpr=0.8878 | 8686.8 samples/s | 33.9 steps/s
[Step= 450] | Loss=4.96992 | acc=0.1206 | tpr=0.5906 | fpr=0.8879 | 8670.2 samples/s | 33.9 steps/s
[Step= 500] | Loss=4.97324 | acc=0.1208 | tpr=0.5947 | fpr=0.8878 | 8874.1 samples/s | 34.7 steps/s
[Step= 550] | Loss=4.97700 | acc=0.1209 | tpr=0.5945 | fpr=0.8877 | 16052.7 samples/s | 62.7 steps/s
Avg test loss: 4.97774, Avg test acc: 0.12088, Avg tpr: 0.59548, Avg fpr: 0.88775, total FA: 123262

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.48271 | acc=0.1120 | tpr=0.6991 | fpr=0.8985 | 4466.0 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.45906 | acc=0.1127 | tpr=0.6759 | fpr=0.8979 | 8975.1 samples/s | 35.1 steps/s
[Step= 150] | Loss=5.47184 | acc=0.1113 | tpr=0.6787 | fpr=0.8991 | 8667.4 samples/s | 33.9 steps/s
[Step= 200] | Loss=5.46615 | acc=0.1101 | tpr=0.6765 | fpr=0.9002 | 9312.0 samples/s | 36.4 steps/s
[Step= 250] | Loss=5.46800 | acc=0.1104 | tpr=0.6777 | fpr=0.9000 | 8440.3 samples/s | 33.0 steps/s
[Step= 300] | Loss=5.46718 | acc=0.1103 | tpr=0.6807 | fpr=0.9001 | 8650.0 samples/s | 33.8 steps/s
[Step= 350] | Loss=5.46425 | acc=0.1094 | tpr=0.6781 | fpr=0.9009 | 8820.9 samples/s | 34.5 steps/s
[Step= 400] | Loss=5.46246 | acc=0.1099 | tpr=0.6865 | fpr=0.9006 | 8669.4 samples/s | 33.9 steps/s
[Step= 450] | Loss=5.46990 | acc=0.1094 | tpr=0.6821 | fpr=0.9010 | 8752.7 samples/s | 34.2 steps/s
[Step= 500] | Loss=5.47433 | acc=0.1095 | tpr=0.6846 | fpr=0.9008 | 8765.2 samples/s | 34.2 steps/s
[Step= 550] | Loss=5.47813 | acc=0.1095 | tpr=0.6805 | fpr=0.9009 | 15701.7 samples/s | 61.3 steps/s
Avg test loss: 5.47886, Avg test acc: 0.10940, Avg tpr: 0.68146, Avg fpr: 0.90100, total FA: 125102

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11784 | acc=0.9820 | tpr=0.9336 | fpr=0.0172 | 4474.6 samples/s | 17.5 steps/s
[Step= 100] | Loss=0.12342 | acc=0.9812 | tpr=0.9446 | fpr=0.0181 | 8786.2 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.12801 | acc=0.9802 | tpr=0.9481 | fpr=0.0192 | 8826.8 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.12852 | acc=0.9805 | tpr=0.9497 | fpr=0.0189 | 9016.3 samples/s | 35.2 steps/s
[Step= 250] | Loss=0.12607 | acc=0.9807 | tpr=0.9476 | fpr=0.0187 | 8703.9 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.12836 | acc=0.9804 | tpr=0.9469 | fpr=0.0190 | 8792.8 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.12967 | acc=0.9802 | tpr=0.9499 | fpr=0.0192 | 8912.0 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.13011 | acc=0.9800 | tpr=0.9497 | fpr=0.0194 | 8765.7 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.13315 | acc=0.9797 | tpr=0.9469 | fpr=0.0197 | 8626.7 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.13260 | acc=0.9797 | tpr=0.9480 | fpr=0.0197 | 9226.1 samples/s | 36.0 steps/s
[Step= 550] | Loss=0.13209 | acc=0.9798 | tpr=0.9459 | fpr=0.0196 | 14659.5 samples/s | 57.3 steps/s
Avg test loss: 0.13176, Avg test acc: 0.97981, Avg tpr: 0.94612, Avg fpr: 0.01958, total FA: 2718

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12251 | acc=0.9795 | tpr=0.9469 | fpr=0.0200 | 4441.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.12671 | acc=0.9791 | tpr=0.9574 | fpr=0.0205 | 8866.5 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.13097 | acc=0.9781 | tpr=0.9597 | fpr=0.0216 | 8889.1 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.13112 | acc=0.9783 | tpr=0.9607 | fpr=0.0214 | 8745.9 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.12855 | acc=0.9786 | tpr=0.9598 | fpr=0.0211 | 8920.1 samples/s | 34.8 steps/s
[Step= 300] | Loss=0.13053 | acc=0.9783 | tpr=0.9607 | fpr=0.0214 | 8575.3 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.13191 | acc=0.9779 | tpr=0.9612 | fpr=0.0218 | 9049.2 samples/s | 35.3 steps/s
[Step= 400] | Loss=0.13250 | acc=0.9776 | tpr=0.9606 | fpr=0.0220 | 9003.8 samples/s | 35.2 steps/s
[Step= 450] | Loss=0.13533 | acc=0.9774 | tpr=0.9596 | fpr=0.0223 | 8722.5 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.13530 | acc=0.9774 | tpr=0.9612 | fpr=0.0223 | 8453.9 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.13472 | acc=0.9774 | tpr=0.9598 | fpr=0.0222 | 16145.4 samples/s | 63.1 steps/s
Avg test loss: 0.13439, Avg test acc: 0.97746, Avg tpr: 0.95998, Avg fpr: 0.02222, total FA: 3085

server round 48/50

clients selected: [1 2]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=44001 Epoch=86.0] | Loss=0.01042 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.281 | L2-Norm(final)=9.267 | 3960.2 samples/s | 61.9 steps/s
[Step=44050 Epoch=86.1] | Loss=0.01411 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.286 | L2-Norm(final)=9.270 | 5353.9 samples/s | 83.7 steps/s
[Step=44100 Epoch=86.2] | Loss=0.01458 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.290 | L2-Norm(final)=9.274 | 5610.1 samples/s | 87.7 steps/s
[Step=44150 Epoch=86.3] | Loss=0.01440 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.294 | L2-Norm(final)=9.278 | 5752.0 samples/s | 89.9 steps/s
[Step=44200 Epoch=86.4] | Loss=0.01445 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.298 | L2-Norm(final)=9.282 | 5587.9 samples/s | 87.3 steps/s
[Step=44250 Epoch=86.5] | Loss=0.01394 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.302 | L2-Norm(final)=9.286 | 5609.0 samples/s | 87.6 steps/s
[Step=44300 Epoch=86.6] | Loss=0.01341 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.306 | L2-Norm(final)=9.290 | 5690.2 samples/s | 88.9 steps/s
[Step=44350 Epoch=86.7] | Loss=0.01320 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.309 | L2-Norm(final)=9.293 | 5694.6 samples/s | 89.0 steps/s
[Step=44400 Epoch=86.8] | Loss=0.01334 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.313 | L2-Norm(final)=9.297 | 5642.9 samples/s | 88.2 steps/s
[Step=44450 Epoch=86.9] | Loss=0.01311 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.316 | L2-Norm(final)=9.301 | 5813.4 samples/s | 90.8 steps/s
[Step=44500 Epoch=87.0] | Loss=0.01299 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.320 | L2-Norm(final)=9.304 | 7085.7 samples/s | 110.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=87.0] | Loss=0.01192 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.352 | L2-Norm(final)=9.339 | 3819.9 samples/s | 59.7 steps/s
[Step=44550 Epoch=87.1] | Loss=0.01151 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.357 | L2-Norm(final)=9.342 | 5067.5 samples/s | 79.2 steps/s
[Step=44600 Epoch=87.2] | Loss=0.01235 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.362 | L2-Norm(final)=9.345 | 5017.8 samples/s | 78.4 steps/s
[Step=44650 Epoch=87.3] | Loss=0.01284 | Reg=0.00088 | acc=0.9688 | L2-Norm=9.367 | L2-Norm(final)=9.349 | 5007.8 samples/s | 78.2 steps/s
[Step=44700 Epoch=87.4] | Loss=0.01240 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.371 | L2-Norm(final)=9.352 | 5057.0 samples/s | 79.0 steps/s
[Step=44750 Epoch=87.5] | Loss=0.01256 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.375 | L2-Norm(final)=9.355 | 5025.0 samples/s | 78.5 steps/s
[Step=44800 Epoch=87.6] | Loss=0.01252 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.380 | L2-Norm(final)=9.358 | 5044.9 samples/s | 78.8 steps/s
[Step=44850 Epoch=87.7] | Loss=0.01240 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.384 | L2-Norm(final)=9.361 | 5031.0 samples/s | 78.6 steps/s
[Step=44900 Epoch=87.8] | Loss=0.01205 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.388 | L2-Norm(final)=9.364 | 5079.9 samples/s | 79.4 steps/s
[Step=44950 Epoch=87.9] | Loss=0.01192 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.392 | L2-Norm(final)=9.367 | 5026.9 samples/s | 78.5 steps/s
[Step=45000 Epoch=88.0] | Loss=0.01154 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.396 | L2-Norm(final)=9.370 | 6277.0 samples/s | 98.1 steps/s
[Step=45050 Epoch=88.1] | Loss=0.01101 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.400 | L2-Norm(final)=9.373 | 1939.2 samples/s | 30.3 steps/s
[Step=45100 Epoch=88.2] | Loss=0.01073 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.404 | L2-Norm(final)=9.376 | 5035.3 samples/s | 78.7 steps/s
[Step=45150 Epoch=88.3] | Loss=0.01060 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.407 | L2-Norm(final)=9.379 | 4923.9 samples/s | 76.9 steps/s
[Step=45200 Epoch=88.4] | Loss=0.01044 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.411 | L2-Norm(final)=9.382 | 4983.8 samples/s | 77.9 steps/s
[Step=45250 Epoch=88.5] | Loss=0.01022 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.414 | L2-Norm(final)=9.385 | 5049.5 samples/s | 78.9 steps/s
[Step=45300 Epoch=88.6] | Loss=0.01005 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.418 | L2-Norm(final)=9.388 | 5094.4 samples/s | 79.6 steps/s
[Step=45350 Epoch=88.7] | Loss=0.00991 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.421 | L2-Norm(final)=9.391 | 5024.7 samples/s | 78.5 steps/s
[Step=45400 Epoch=88.8] | Loss=0.00978 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.425 | L2-Norm(final)=9.394 | 5056.0 samples/s | 79.0 steps/s
[Step=45450 Epoch=88.9] | Loss=0.00968 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.428 | L2-Norm(final)=9.397 | 5089.0 samples/s | 79.5 steps/s
[Step=45500 Epoch=89.0] | Loss=0.00954 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.431 | L2-Norm(final)=9.400 | 5450.3 samples/s | 85.2 steps/s
[Step=45550 Epoch=89.0] | Loss=0.00945 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.434 | L2-Norm(final)=9.403 | 1998.4 samples/s | 31.2 steps/s
[Step=45600 Epoch=89.1] | Loss=0.00929 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.438 | L2-Norm(final)=9.406 | 5137.5 samples/s | 80.3 steps/s
[Step=45650 Epoch=89.2] | Loss=0.00911 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.441 | L2-Norm(final)=9.409 | 5002.6 samples/s | 78.2 steps/s
[Step=45700 Epoch=89.3] | Loss=0.00904 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.444 | L2-Norm(final)=9.412 | 5007.3 samples/s | 78.2 steps/s
[Step=45750 Epoch=89.4] | Loss=0.00900 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.447 | L2-Norm(final)=9.414 | 5066.0 samples/s | 79.2 steps/s
[Step=45800 Epoch=89.5] | Loss=0.00888 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.450 | L2-Norm(final)=9.417 | 5062.0 samples/s | 79.1 steps/s
[Step=45850 Epoch=89.6] | Loss=0.00882 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.453 | L2-Norm(final)=9.420 | 5025.4 samples/s | 78.5 steps/s
[Step=45900 Epoch=89.7] | Loss=0.00879 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.456 | L2-Norm(final)=9.422 | 5017.9 samples/s | 78.4 steps/s
[Step=45950 Epoch=89.8] | Loss=0.00870 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.458 | L2-Norm(final)=9.425 | 5036.5 samples/s | 78.7 steps/s
[Step=46000 Epoch=89.9] | Loss=0.00865 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.461 | L2-Norm(final)=9.428 | 5028.0 samples/s | 78.6 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step46000.h5

Train client 2: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=54001 Epoch=206.9] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.281 | L2-Norm(final)=9.664 | 3747.5 samples/s | 58.6 steps/s
[Step=54050 Epoch=207.1] | Loss=0.00027 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.281 | L2-Norm(final)=9.665 | 5267.4 samples/s | 82.3 steps/s
[Step=54100 Epoch=207.3] | Loss=0.00017 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.282 | L2-Norm(final)=9.667 | 5410.8 samples/s | 84.5 steps/s
[Step=54150 Epoch=207.5] | Loss=0.00013 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.282 | L2-Norm(final)=9.670 | 5249.7 samples/s | 82.0 steps/s
[Step=54200 Epoch=207.7] | Loss=0.00011 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.282 | L2-Norm(final)=9.672 | 5391.9 samples/s | 84.2 steps/s
[Step=54250 Epoch=207.9] | Loss=0.00010 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.281 | L2-Norm(final)=9.675 | 6894.6 samples/s | 107.7 steps/s
[Step=54300 Epoch=208.1] | Loss=0.00009 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.281 | L2-Norm(final)=9.677 | 1940.8 samples/s | 30.3 steps/s
[Step=54350 Epoch=208.3] | Loss=0.00008 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.280 | L2-Norm(final)=9.679 | 5257.1 samples/s | 82.1 steps/s
[Step=54400 Epoch=208.4] | Loss=0.00008 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.280 | L2-Norm(final)=9.681 | 5380.2 samples/s | 84.1 steps/s
[Step=54450 Epoch=208.6] | Loss=0.00007 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.279 | L2-Norm(final)=9.683 | 5295.1 samples/s | 82.7 steps/s
[Step=54500 Epoch=208.8] | Loss=0.00007 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.278 | L2-Norm(final)=9.685 | 5928.7 samples/s | 92.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=54501 Epoch=208.8] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.268 | L2-Norm(final)=9.704 | 3704.5 samples/s | 57.9 steps/s
[Step=54550 Epoch=209.0] | Loss=0.00003 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.265 | L2-Norm(final)=9.706 | 4690.9 samples/s | 73.3 steps/s
[Step=54600 Epoch=209.2] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.262 | L2-Norm(final)=9.708 | 4789.4 samples/s | 74.8 steps/s
[Step=54650 Epoch=209.4] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.259 | L2-Norm(final)=9.709 | 4744.3 samples/s | 74.1 steps/s
[Step=54700 Epoch=209.6] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.255 | L2-Norm(final)=9.711 | 4784.4 samples/s | 74.8 steps/s
[Step=54750 Epoch=209.8] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.251 | L2-Norm(final)=9.712 | 6039.8 samples/s | 94.4 steps/s
[Step=54800 Epoch=210.0] | Loss=0.00002 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.247 | L2-Norm(final)=9.713 | 1875.6 samples/s | 29.3 steps/s
[Step=54850 Epoch=210.2] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.242 | L2-Norm(final)=9.714 | 4744.0 samples/s | 74.1 steps/s
[Step=54900 Epoch=210.4] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.238 | L2-Norm(final)=9.715 | 4770.8 samples/s | 74.5 steps/s
[Step=54950 Epoch=210.5] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.233 | L2-Norm(final)=9.716 | 4755.7 samples/s | 74.3 steps/s
[Step=55000 Epoch=210.7] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.228 | L2-Norm(final)=9.716 | 5270.5 samples/s | 82.4 steps/s
[Step=55050 Epoch=210.9] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.223 | L2-Norm(final)=9.717 | 1954.5 samples/s | 30.5 steps/s
[Step=55100 Epoch=211.1] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.218 | L2-Norm(final)=9.718 | 4658.3 samples/s | 72.8 steps/s
[Step=55150 Epoch=211.3] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.213 | L2-Norm(final)=9.719 | 4787.7 samples/s | 74.8 steps/s
[Step=55200 Epoch=211.5] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.207 | L2-Norm(final)=9.719 | 4806.8 samples/s | 75.1 steps/s
[Step=55250 Epoch=211.7] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.202 | L2-Norm(final)=9.720 | 4835.7 samples/s | 75.6 steps/s
[Step=55300 Epoch=211.9] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.196 | L2-Norm(final)=9.721 | 2012.1 samples/s | 31.4 steps/s
[Step=55350 Epoch=212.1] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.191 | L2-Norm(final)=9.721 | 4860.1 samples/s | 75.9 steps/s
[Step=55400 Epoch=212.3] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.185 | L2-Norm(final)=9.722 | 4822.7 samples/s | 75.4 steps/s
[Step=55450 Epoch=212.5] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.179 | L2-Norm(final)=9.723 | 4803.9 samples/s | 75.1 steps/s
[Step=55500 Epoch=212.7] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.173 | L2-Norm(final)=9.723 | 4722.4 samples/s | 73.8 steps/s
[Step=55550 Epoch=212.8] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.167 | L2-Norm(final)=9.724 | 2047.6 samples/s | 32.0 steps/s
[Step=55600 Epoch=213.0] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.161 | L2-Norm(final)=9.725 | 4712.0 samples/s | 73.6 steps/s
[Step=55650 Epoch=213.2] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.155 | L2-Norm(final)=9.725 | 4772.5 samples/s | 74.6 steps/s
[Step=55700 Epoch=213.4] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.149 | L2-Norm(final)=9.726 | 4775.6 samples/s | 74.6 steps/s
[Step=55750 Epoch=213.6] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.142 | L2-Norm(final)=9.726 | 4750.0 samples/s | 74.2 steps/s
[Step=55800 Epoch=213.8] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.136 | L2-Norm(final)=9.727 | 6534.3 samples/s | 102.1 steps/s
[Step=55850 Epoch=214.0] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.129 | L2-Norm(final)=9.728 | 1836.9 samples/s | 28.7 steps/s
[Step=55900 Epoch=214.2] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.123 | L2-Norm(final)=9.728 | 4795.3 samples/s | 74.9 steps/s
[Step=55950 Epoch=214.4] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.116 | L2-Norm(final)=9.729 | 4754.2 samples/s | 74.3 steps/s
[Step=56000 Epoch=214.6] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.109 | L2-Norm(final)=9.729 | 4743.1 samples/s | 74.1 steps/s
Client model saved at models/model-a2i2_sr0.5/client_iccad2012_0/client_state-step56000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05626 | acc=0.9700 | tpr=0.9791 | fpr=0.0498 | 4430.6 samples/s | 17.3 steps/s
Avg test loss: 0.05985, Avg test acc: 0.96871, Avg tpr: 0.97762, Avg fpr: 0.05089, total FA: 397

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05741 | acc=0.9695 | tpr=0.9782 | fpr=0.0493 | 4464.5 samples/s | 17.4 steps/s
Avg test loss: 0.06281, Avg test acc: 0.96887, Avg tpr: 0.97826, Avg fpr: 0.05179, total FA: 404

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.85785 | acc=0.3166 | tpr=0.0387 | fpr=0.0798 | 4444.1 samples/s | 17.4 steps/s
Avg test loss: 4.85793, Avg test acc: 0.31661, Avg tpr: 0.04068, Avg fpr: 0.07653, total FA: 597

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.28093 | acc=0.3083 | tpr=0.0323 | fpr=0.0924 | 4422.8 samples/s | 17.3 steps/s
Avg test loss: 5.28080, Avg test acc: 0.30736, Avg tpr: 0.03281, Avg fpr: 0.08883, total FA: 693

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.98810 | acc=0.1252 | tpr=0.6372 | fpr=0.8840 | 4452.9 samples/s | 17.4 steps/s
[Step= 100] | Loss=4.96798 | acc=0.1252 | tpr=0.5970 | fpr=0.8836 | 8950.0 samples/s | 35.0 steps/s
[Step= 150] | Loss=4.97556 | acc=0.1230 | tpr=0.5922 | fpr=0.8857 | 8769.3 samples/s | 34.3 steps/s
[Step= 200] | Loss=4.96686 | acc=0.1217 | tpr=0.5825 | fpr=0.8867 | 8979.9 samples/s | 35.1 steps/s
[Step= 250] | Loss=4.96877 | acc=0.1218 | tpr=0.5860 | fpr=0.8867 | 8512.1 samples/s | 33.3 steps/s
[Step= 300] | Loss=4.96643 | acc=0.1214 | tpr=0.5913 | fpr=0.8872 | 9114.1 samples/s | 35.6 steps/s
[Step= 350] | Loss=4.96292 | acc=0.1206 | tpr=0.5880 | fpr=0.8878 | 8560.8 samples/s | 33.4 steps/s
[Step= 400] | Loss=4.96172 | acc=0.1208 | tpr=0.5941 | fpr=0.8878 | 8623.4 samples/s | 33.7 steps/s
[Step= 450] | Loss=4.96992 | acc=0.1206 | tpr=0.5906 | fpr=0.8879 | 8568.1 samples/s | 33.5 steps/s
[Step= 500] | Loss=4.97324 | acc=0.1208 | tpr=0.5947 | fpr=0.8878 | 9062.2 samples/s | 35.4 steps/s
[Step= 550] | Loss=4.97700 | acc=0.1209 | tpr=0.5945 | fpr=0.8877 | 15114.1 samples/s | 59.0 steps/s
Avg test loss: 4.97774, Avg test acc: 0.12088, Avg tpr: 0.59548, Avg fpr: 0.88775, total FA: 123262

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.24985 | acc=0.1224 | tpr=0.6814 | fpr=0.8876 | 4502.9 samples/s | 17.6 steps/s
[Step= 100] | Loss=5.22790 | acc=0.1225 | tpr=0.6397 | fpr=0.8872 | 8537.0 samples/s | 33.3 steps/s
[Step= 150] | Loss=5.23963 | acc=0.1208 | tpr=0.6484 | fpr=0.8890 | 8597.3 samples/s | 33.6 steps/s
[Step= 200] | Loss=5.23371 | acc=0.1193 | tpr=0.6383 | fpr=0.8901 | 9466.2 samples/s | 37.0 steps/s
[Step= 250] | Loss=5.23526 | acc=0.1197 | tpr=0.6376 | fpr=0.8897 | 8189.3 samples/s | 32.0 steps/s
[Step= 300] | Loss=5.23371 | acc=0.1195 | tpr=0.6415 | fpr=0.8900 | 9138.7 samples/s | 35.7 steps/s
[Step= 350] | Loss=5.23070 | acc=0.1188 | tpr=0.6381 | fpr=0.8906 | 8487.6 samples/s | 33.2 steps/s
[Step= 400] | Loss=5.22915 | acc=0.1195 | tpr=0.6482 | fpr=0.8902 | 9213.2 samples/s | 36.0 steps/s
[Step= 450] | Loss=5.23638 | acc=0.1190 | tpr=0.6456 | fpr=0.8905 | 8744.8 samples/s | 34.2 steps/s
[Step= 500] | Loss=5.24071 | acc=0.1192 | tpr=0.6498 | fpr=0.8904 | 8589.3 samples/s | 33.6 steps/s
[Step= 550] | Loss=5.24467 | acc=0.1192 | tpr=0.6462 | fpr=0.8904 | 15520.3 samples/s | 60.6 steps/s
Avg test loss: 5.24538, Avg test acc: 0.11909, Avg tpr: 0.64739, Avg fpr: 0.89051, total FA: 123646

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11937 | acc=0.9808 | tpr=0.9469 | fpr=0.0186 | 4422.5 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.12507 | acc=0.9802 | tpr=0.9574 | fpr=0.0194 | 9279.7 samples/s | 36.2 steps/s
[Step= 150] | Loss=0.12932 | acc=0.9793 | tpr=0.9568 | fpr=0.0203 | 8465.5 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.12959 | acc=0.9795 | tpr=0.9585 | fpr=0.0201 | 8873.5 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.12705 | acc=0.9797 | tpr=0.9572 | fpr=0.0199 | 8728.9 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.12907 | acc=0.9794 | tpr=0.9556 | fpr=0.0202 | 8887.0 samples/s | 34.7 steps/s
[Step= 350] | Loss=0.13050 | acc=0.9791 | tpr=0.9574 | fpr=0.0205 | 8746.3 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.13093 | acc=0.9789 | tpr=0.9573 | fpr=0.0207 | 8829.9 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.13392 | acc=0.9786 | tpr=0.9552 | fpr=0.0210 | 8839.4 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.13349 | acc=0.9787 | tpr=0.9564 | fpr=0.0209 | 8745.7 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.13303 | acc=0.9788 | tpr=0.9546 | fpr=0.0208 | 15957.1 samples/s | 62.3 steps/s
Avg test loss: 0.13271, Avg test acc: 0.97877, Avg tpr: 0.95483, Avg fpr: 0.02079, total FA: 2887

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12251 | acc=0.9795 | tpr=0.9469 | fpr=0.0200 | 4434.4 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.12671 | acc=0.9791 | tpr=0.9574 | fpr=0.0205 | 9068.5 samples/s | 35.4 steps/s
[Step= 150] | Loss=0.13097 | acc=0.9781 | tpr=0.9597 | fpr=0.0216 | 8792.8 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.13112 | acc=0.9783 | tpr=0.9607 | fpr=0.0214 | 8614.6 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.12855 | acc=0.9786 | tpr=0.9598 | fpr=0.0211 | 8752.9 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.13053 | acc=0.9783 | tpr=0.9607 | fpr=0.0214 | 9225.5 samples/s | 36.0 steps/s
[Step= 350] | Loss=0.13191 | acc=0.9779 | tpr=0.9612 | fpr=0.0218 | 8376.6 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.13250 | acc=0.9776 | tpr=0.9606 | fpr=0.0220 | 8762.8 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.13533 | acc=0.9774 | tpr=0.9596 | fpr=0.0223 | 9128.8 samples/s | 35.7 steps/s
[Step= 500] | Loss=0.13530 | acc=0.9774 | tpr=0.9612 | fpr=0.0223 | 8611.3 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.13472 | acc=0.9774 | tpr=0.9598 | fpr=0.0222 | 15576.9 samples/s | 60.8 steps/s
Avg test loss: 0.13439, Avg test acc: 0.97746, Avg tpr: 0.95998, Avg fpr: 0.02222, total FA: 3085

server round 49/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=40001 Epoch=78.0] | Loss=0.03031 | Reg=0.00083 | acc=0.9688 | L2-Norm=9.086 | L2-Norm(final)=9.056 | 4144.3 samples/s | 64.8 steps/s
[Step=40050 Epoch=78.1] | Loss=0.01719 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.090 | L2-Norm(final)=9.060 | 4826.3 samples/s | 75.4 steps/s
[Step=40100 Epoch=78.2] | Loss=0.01624 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.094 | L2-Norm(final)=9.063 | 5725.5 samples/s | 89.5 steps/s
[Step=40150 Epoch=78.3] | Loss=0.01609 | Reg=0.00083 | acc=0.9688 | L2-Norm=9.098 | L2-Norm(final)=9.066 | 5750.8 samples/s | 89.9 steps/s
[Step=40200 Epoch=78.4] | Loss=0.01603 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.101 | L2-Norm(final)=9.070 | 5529.6 samples/s | 86.4 steps/s
[Step=40250 Epoch=78.5] | Loss=0.01585 | Reg=0.00083 | acc=0.9375 | L2-Norm=9.105 | L2-Norm(final)=9.074 | 5682.2 samples/s | 88.8 steps/s
[Step=40300 Epoch=78.6] | Loss=0.01574 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.109 | L2-Norm(final)=9.078 | 5720.7 samples/s | 89.4 steps/s
[Step=40350 Epoch=78.7] | Loss=0.01538 | Reg=0.00083 | acc=0.9844 | L2-Norm=9.112 | L2-Norm(final)=9.082 | 5560.6 samples/s | 86.9 steps/s
[Step=40400 Epoch=78.8] | Loss=0.01544 | Reg=0.00083 | acc=0.9688 | L2-Norm=9.116 | L2-Norm(final)=9.086 | 5652.8 samples/s | 88.3 steps/s
[Step=40450 Epoch=78.9] | Loss=0.01540 | Reg=0.00083 | acc=0.9531 | L2-Norm=9.119 | L2-Norm(final)=9.090 | 5758.1 samples/s | 90.0 steps/s
[Step=40500 Epoch=79.0] | Loss=0.01545 | Reg=0.00083 | acc=0.9844 | L2-Norm=9.123 | L2-Norm(final)=9.093 | 7028.0 samples/s | 109.8 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_0/client_state-step40500.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=46001 Epoch=89.9] | Loss=0.01878 | Reg=0.00083 | acc=0.9844 | L2-Norm=9.086 | L2-Norm(final)=9.504 | 3768.8 samples/s | 58.9 steps/s
[Step=46050 Epoch=90.0] | Loss=0.01748 | Reg=0.00083 | acc=0.9844 | L2-Norm=9.090 | L2-Norm(final)=9.507 | 5629.1 samples/s | 88.0 steps/s
[Step=46100 Epoch=90.1] | Loss=0.01597 | Reg=0.00083 | acc=0.9688 | L2-Norm=9.094 | L2-Norm(final)=9.510 | 5590.5 samples/s | 87.4 steps/s
[Step=46150 Epoch=90.2] | Loss=0.01514 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.099 | L2-Norm(final)=9.514 | 5651.5 samples/s | 88.3 steps/s
[Step=46200 Epoch=90.3] | Loss=0.01462 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.103 | L2-Norm(final)=9.518 | 5669.6 samples/s | 88.6 steps/s
[Step=46250 Epoch=90.4] | Loss=0.01430 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.107 | L2-Norm(final)=9.522 | 5772.5 samples/s | 90.2 steps/s
[Step=46300 Epoch=90.5] | Loss=0.01412 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.110 | L2-Norm(final)=9.526 | 5492.1 samples/s | 85.8 steps/s
[Step=46350 Epoch=90.6] | Loss=0.01409 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.113 | L2-Norm(final)=9.529 | 5729.8 samples/s | 89.5 steps/s
[Step=46400 Epoch=90.7] | Loss=0.01395 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.117 | L2-Norm(final)=9.533 | 5602.4 samples/s | 87.5 steps/s
[Step=46450 Epoch=90.8] | Loss=0.01375 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.120 | L2-Norm(final)=9.536 | 5787.4 samples/s | 90.4 steps/s
[Step=46500 Epoch=90.9] | Loss=0.01357 | Reg=0.00083 | acc=0.9844 | L2-Norm=9.123 | L2-Norm(final)=9.540 | 7130.6 samples/s | 111.4 steps/s
Client model saved at models/model-a2i2_sr0.5/client_asml1_1/client_state-step46500.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.05290 | acc=0.9673 | tpr=0.9723 | fpr=0.0434 | 4525.0 samples/s | 17.7 steps/s
Avg test loss: 0.05631, Avg test acc: 0.96610, Avg tpr: 0.97167, Avg fpr: 0.04615, total FA: 360

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.05482 | acc=0.9673 | tpr=0.9730 | fpr=0.0451 | 4438.5 samples/s | 17.3 steps/s
Avg test loss: 0.05869, Avg test acc: 0.96662, Avg tpr: 0.97278, Avg fpr: 0.04692, total FA: 366

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.85785 | acc=0.3166 | tpr=0.0387 | fpr=0.0798 | 4501.4 samples/s | 17.6 steps/s
Avg test loss: 4.85793, Avg test acc: 0.31661, Avg tpr: 0.04068, Avg fpr: 0.07653, total FA: 597

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.28093 | acc=0.3083 | tpr=0.0323 | fpr=0.0924 | 4531.4 samples/s | 17.7 steps/s
Avg test loss: 5.28080, Avg test acc: 0.30736, Avg tpr: 0.03281, Avg fpr: 0.08883, total FA: 693

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.07694 | acc=0.1322 | tpr=0.6726 | fpr=0.8775 | 4441.5 samples/s | 17.3 steps/s
[Step= 100] | Loss=4.05959 | acc=0.1318 | tpr=0.6162 | fpr=0.8773 | 8853.9 samples/s | 34.6 steps/s
[Step= 150] | Loss=4.06602 | acc=0.1299 | tpr=0.6110 | fpr=0.8789 | 8961.9 samples/s | 35.0 steps/s
[Step= 200] | Loss=4.05885 | acc=0.1288 | tpr=0.6109 | fpr=0.8800 | 8736.4 samples/s | 34.1 steps/s
[Step= 250] | Loss=4.06031 | acc=0.1289 | tpr=0.6175 | fpr=0.8800 | 8706.1 samples/s | 34.0 steps/s
[Step= 300] | Loss=4.05866 | acc=0.1289 | tpr=0.6262 | fpr=0.8802 | 8883.4 samples/s | 34.7 steps/s
[Step= 350] | Loss=4.05533 | acc=0.1283 | tpr=0.6262 | fpr=0.8808 | 8831.7 samples/s | 34.5 steps/s
[Step= 400] | Loss=4.05417 | acc=0.1286 | tpr=0.6318 | fpr=0.8806 | 8705.4 samples/s | 34.0 steps/s
[Step= 450] | Loss=4.06044 | acc=0.1282 | tpr=0.6261 | fpr=0.8808 | 8747.9 samples/s | 34.2 steps/s
[Step= 500] | Loss=4.06359 | acc=0.1283 | tpr=0.6278 | fpr=0.8807 | 8915.0 samples/s | 34.8 steps/s
[Step= 550] | Loss=4.06688 | acc=0.1283 | tpr=0.6287 | fpr=0.8808 | 15617.7 samples/s | 61.0 steps/s
Avg test loss: 4.06754, Avg test acc: 0.12821, Avg tpr: 0.62956, Avg fpr: 0.88090, total FA: 122311

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.39672 | acc=0.1291 | tpr=0.6637 | fpr=0.8805 | 4468.3 samples/s | 17.5 steps/s
[Step= 100] | Loss=4.37790 | acc=0.1295 | tpr=0.6205 | fpr=0.8797 | 8871.4 samples/s | 34.7 steps/s
[Step= 150] | Loss=4.38612 | acc=0.1273 | tpr=0.6254 | fpr=0.8819 | 8651.5 samples/s | 33.8 steps/s
[Step= 200] | Loss=4.37932 | acc=0.1265 | tpr=0.6208 | fpr=0.8825 | 9243.1 samples/s | 36.1 steps/s
[Step= 250] | Loss=4.38047 | acc=0.1271 | tpr=0.6262 | fpr=0.8820 | 8819.8 samples/s | 34.5 steps/s
[Step= 300] | Loss=4.37866 | acc=0.1268 | tpr=0.6298 | fpr=0.8824 | 8342.6 samples/s | 32.6 steps/s
[Step= 350] | Loss=4.37519 | acc=0.1262 | tpr=0.6268 | fpr=0.8829 | 9095.2 samples/s | 35.5 steps/s
[Step= 400] | Loss=4.37421 | acc=0.1266 | tpr=0.6357 | fpr=0.8826 | 8560.2 samples/s | 33.4 steps/s
[Step= 450] | Loss=4.38036 | acc=0.1261 | tpr=0.6319 | fpr=0.8831 | 8735.1 samples/s | 34.1 steps/s
[Step= 500] | Loss=4.38388 | acc=0.1263 | tpr=0.6352 | fpr=0.8829 | 8869.0 samples/s | 34.6 steps/s
[Step= 550] | Loss=4.38739 | acc=0.1264 | tpr=0.6351 | fpr=0.8828 | 16078.5 samples/s | 62.8 steps/s
Avg test loss: 4.38800, Avg test acc: 0.12635, Avg tpr: 0.63590, Avg fpr: 0.88292, total FA: 122591

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.11937 | acc=0.9808 | tpr=0.9469 | fpr=0.0186 | 4622.0 samples/s | 18.1 steps/s
[Step= 100] | Loss=0.12507 | acc=0.9802 | tpr=0.9574 | fpr=0.0194 | 8328.0 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.12932 | acc=0.9793 | tpr=0.9568 | fpr=0.0203 | 8747.9 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.12959 | acc=0.9795 | tpr=0.9585 | fpr=0.0201 | 8800.9 samples/s | 34.4 steps/s
[Step= 250] | Loss=0.12705 | acc=0.9797 | tpr=0.9572 | fpr=0.0199 | 8688.1 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.12907 | acc=0.9794 | tpr=0.9556 | fpr=0.0202 | 8790.6 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.13050 | acc=0.9791 | tpr=0.9574 | fpr=0.0205 | 8830.7 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.13093 | acc=0.9789 | tpr=0.9573 | fpr=0.0207 | 8837.2 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.13392 | acc=0.9786 | tpr=0.9552 | fpr=0.0210 | 8847.3 samples/s | 34.6 steps/s
[Step= 500] | Loss=0.13349 | acc=0.9787 | tpr=0.9564 | fpr=0.0209 | 8771.7 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.13303 | acc=0.9788 | tpr=0.9546 | fpr=0.0208 | 14994.1 samples/s | 58.6 steps/s
Avg test loss: 0.13271, Avg test acc: 0.97877, Avg tpr: 0.95483, Avg fpr: 0.02079, total FA: 2887

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12251 | acc=0.9795 | tpr=0.9469 | fpr=0.0200 | 4451.0 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.12671 | acc=0.9791 | tpr=0.9574 | fpr=0.0205 | 8735.3 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.13097 | acc=0.9781 | tpr=0.9597 | fpr=0.0216 | 8688.7 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.13112 | acc=0.9783 | tpr=0.9607 | fpr=0.0214 | 8758.1 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.12855 | acc=0.9786 | tpr=0.9598 | fpr=0.0211 | 9023.5 samples/s | 35.2 steps/s
[Step= 300] | Loss=0.13053 | acc=0.9783 | tpr=0.9607 | fpr=0.0214 | 8541.3 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.13191 | acc=0.9779 | tpr=0.9612 | fpr=0.0218 | 9268.2 samples/s | 36.2 steps/s
[Step= 400] | Loss=0.13250 | acc=0.9776 | tpr=0.9606 | fpr=0.0220 | 8383.9 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.13533 | acc=0.9774 | tpr=0.9596 | fpr=0.0223 | 8796.3 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.13530 | acc=0.9774 | tpr=0.9612 | fpr=0.0223 | 8703.6 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.13472 | acc=0.9774 | tpr=0.9598 | fpr=0.0222 | 15763.4 samples/s | 61.6 steps/s
Avg test loss: 0.13439, Avg test acc: 0.97746, Avg tpr: 0.95998, Avg fpr: 0.02222, total FA: 3085
