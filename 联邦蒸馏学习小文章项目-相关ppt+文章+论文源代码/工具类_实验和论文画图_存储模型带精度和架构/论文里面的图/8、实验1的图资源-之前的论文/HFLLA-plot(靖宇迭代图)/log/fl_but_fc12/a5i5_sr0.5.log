#clients of iccad2012: 5
#clients of asml1: 5
select ratio: 0.5
Total num clients: 10
client model path: ['models/model-a5i5_sr0.5/client_asml1_0', 'models/model-a5i5_sr0.5/client_asml1_1', 'models/model-a5i5_sr0.5/client_asml1_2', 'models/model-a5i5_sr0.5/client_asml1_3', 'models/model-a5i5_sr0.5/client_asml1_4', 'models/model-a5i5_sr0.5/client_iccad2012_0', 'models/model-a5i5_sr0.5/client_iccad2012_1', 'models/model-a5i5_sr0.5/client_iccad2012_2', 'models/model-a5i5_sr0.5/client_iccad2012_3', 'models/model-a5i5_sr0.5/client_iccad2012_4']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13125, 144, 32)
Using transform option: train
#pos = 6841, #neg = 6284
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13116, 144, 32)
Using transform option: train
#pos = 6850, #neg = 6266
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13135, 144, 32)
Using transform option: train
#pos = 6831, #neg = 6304
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13124, 144, 32)
Using transform option: train
#pos = 6842, #neg = 6282
Allocated dataset with size (9984, 144, 32)
Resampled dataset to size (13051, 144, 32)
Using transform option: train
#pos = 6917, #neg = 6134
loading data into the main memory...
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6754, 144, 32)
Using transform option: train
#pos = 3332, #neg = 3422
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6728, 144, 32)
Using transform option: train
#pos = 3304, #neg = 3424
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6702, 144, 32)
Using transform option: train
#pos = 3276, #neg = 3426
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6792, 144, 32)
Using transform option: train
#pos = 3393, #neg = 3399
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6715, 144, 32)
Using transform option: train
#pos = 3290, #neg = 3425
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [1 5 7 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.41869 | Reg=0.00355 | acc=0.3594 | L2-Norm=18.836 | L2-Norm(final)=2.104 | 2831.3 samples/s | 44.2 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.34108 | Reg=0.00336 | acc=0.6875 | L2-Norm=18.337 | L2-Norm(final)=2.082 | 6174.0 samples/s | 96.5 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.32684 | Reg=0.00328 | acc=0.6406 | L2-Norm=18.099 | L2-Norm(final)=2.079 | 5884.0 samples/s | 91.9 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.31702 | Reg=0.00323 | acc=0.7188 | L2-Norm=17.959 | L2-Norm(final)=2.086 | 5915.6 samples/s | 92.4 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.31097 | Reg=0.00320 | acc=0.6875 | L2-Norm=17.880 | L2-Norm(final)=2.099 | 8769.9 samples/s | 137.0 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.30406 | Reg=0.00318 | acc=0.7344 | L2-Norm=17.837 | L2-Norm(final)=2.113 | 2034.3 samples/s | 31.8 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.29970 | Reg=0.00318 | acc=0.6562 | L2-Norm=17.820 | L2-Norm(final)=2.131 | 5707.7 samples/s | 89.2 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.29666 | Reg=0.00318 | acc=0.6719 | L2-Norm=17.817 | L2-Norm(final)=2.147 | 5939.4 samples/s | 92.8 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.29311 | Reg=0.00318 | acc=0.6406 | L2-Norm=17.822 | L2-Norm(final)=2.164 | 7932.2 samples/s | 123.9 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.28994 | Reg=0.00318 | acc=0.7031 | L2-Norm=17.836 | L2-Norm(final)=2.181 | 2017.4 samples/s | 31.5 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.28656 | Reg=0.00319 | acc=0.7344 | L2-Norm=17.858 | L2-Norm(final)=2.199 | 5917.9 samples/s | 92.5 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.4] | Loss=0.23395 | Reg=0.00328 | acc=0.7656 | L2-Norm=18.104 | L2-Norm(final)=2.380 | 3830.7 samples/s | 59.9 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.24223 | Reg=0.00328 | acc=0.7812 | L2-Norm=18.113 | L2-Norm(final)=2.387 | 4851.4 samples/s | 75.8 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.21378 | Reg=0.00329 | acc=0.9375 | L2-Norm=18.150 | L2-Norm(final)=2.398 | 4960.6 samples/s | 77.5 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.19423 | Reg=0.00331 | acc=0.9219 | L2-Norm=18.181 | L2-Norm(final)=2.410 | 4978.5 samples/s | 77.8 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.18060 | Reg=0.00332 | acc=0.8750 | L2-Norm=18.210 | L2-Norm(final)=2.422 | 6674.8 samples/s | 104.3 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.16428 | Reg=0.00333 | acc=0.8594 | L2-Norm=18.239 | L2-Norm(final)=2.433 | 1887.3 samples/s | 29.5 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.15305 | Reg=0.00334 | acc=0.8594 | L2-Norm=18.271 | L2-Norm(final)=2.445 | 4927.5 samples/s | 77.0 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.14440 | Reg=0.00335 | acc=0.9219 | L2-Norm=18.298 | L2-Norm(final)=2.456 | 4992.1 samples/s | 78.0 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.13751 | Reg=0.00336 | acc=0.9219 | L2-Norm=18.322 | L2-Norm(final)=2.466 | 6170.4 samples/s | 96.4 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.12858 | Reg=0.00337 | acc=0.9375 | L2-Norm=18.348 | L2-Norm(final)=2.475 | 1903.4 samples/s | 29.7 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.12066 | Reg=0.00338 | acc=0.9531 | L2-Norm=18.373 | L2-Norm(final)=2.485 | 4961.9 samples/s | 77.5 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.11488 | Reg=0.00338 | acc=0.9062 | L2-Norm=18.396 | L2-Norm(final)=2.495 | 4982.6 samples/s | 77.9 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.10989 | Reg=0.00339 | acc=0.9219 | L2-Norm=18.417 | L2-Norm(final)=2.504 | 5860.7 samples/s | 91.6 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.10481 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.436 | L2-Norm(final)=2.513 | 1955.1 samples/s | 30.5 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.09975 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.453 | L2-Norm(final)=2.521 | 4912.5 samples/s | 76.8 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.09580 | Reg=0.00341 | acc=0.9219 | L2-Norm=18.468 | L2-Norm(final)=2.530 | 5000.7 samples/s | 78.1 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.09234 | Reg=0.00342 | acc=0.9688 | L2-Norm=18.483 | L2-Norm(final)=2.538 | 5471.1 samples/s | 85.5 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.08931 | Reg=0.00342 | acc=0.9844 | L2-Norm=18.497 | L2-Norm(final)=2.546 | 1962.0 samples/s | 30.7 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.08612 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.510 | L2-Norm(final)=2.553 | 4906.1 samples/s | 76.7 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.08338 | Reg=0.00343 | acc=0.9375 | L2-Norm=18.521 | L2-Norm(final)=2.560 | 5063.1 samples/s | 79.1 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.08076 | Reg=0.00343 | acc=0.9844 | L2-Norm=18.532 | L2-Norm(final)=2.566 | 5268.6 samples/s | 82.3 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.07819 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.542 | L2-Norm(final)=2.572 | 2020.5 samples/s | 31.6 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.07556 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.552 | L2-Norm(final)=2.578 | 4983.4 samples/s | 77.9 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.07365 | Reg=0.00345 | acc=0.9688 | L2-Norm=18.561 | L2-Norm(final)=2.584 | 4924.5 samples/s | 76.9 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.07215 | Reg=0.00345 | acc=0.9531 | L2-Norm=18.570 | L2-Norm(final)=2.589 | 5036.1 samples/s | 78.7 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.07034 | Reg=0.00345 | acc=0.9844 | L2-Norm=18.580 | L2-Norm(final)=2.593 | 2063.7 samples/s | 32.2 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.06850 | Reg=0.00346 | acc=0.9531 | L2-Norm=18.590 | L2-Norm(final)=2.598 | 4993.6 samples/s | 78.0 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.06701 | Reg=0.00346 | acc=0.9688 | L2-Norm=18.598 | L2-Norm(final)=2.602 | 4931.1 samples/s | 77.0 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.06561 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.606 | L2-Norm(final)=2.606 | 4914.1 samples/s | 76.8 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.06427 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.613 | L2-Norm(final)=2.610 | 2071.9 samples/s | 32.4 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.06291 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.620 | L2-Norm(final)=2.613 | 4985.6 samples/s | 77.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step2000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.32288 | Reg=0.00355 | acc=0.5000 | L2-Norm=18.836 | L2-Norm(final)=2.104 | 3911.5 samples/s | 61.1 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.24981 | Reg=0.00339 | acc=0.8750 | L2-Norm=18.406 | L2-Norm(final)=2.109 | 5150.1 samples/s | 80.5 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.19654 | Reg=0.00335 | acc=0.9375 | L2-Norm=18.301 | L2-Norm(final)=2.164 | 8177.0 samples/s | 127.8 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.16938 | Reg=0.00334 | acc=0.9219 | L2-Norm=18.282 | L2-Norm(final)=2.218 | 1908.6 samples/s | 29.8 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.14974 | Reg=0.00335 | acc=0.9375 | L2-Norm=18.290 | L2-Norm(final)=2.263 | 7399.0 samples/s | 115.6 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.13538 | Reg=0.00335 | acc=0.9375 | L2-Norm=18.304 | L2-Norm(final)=2.303 | 2000.1 samples/s | 31.3 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.12513 | Reg=0.00336 | acc=0.8906 | L2-Norm=18.321 | L2-Norm(final)=2.340 | 6673.2 samples/s | 104.3 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.11724 | Reg=0.00336 | acc=0.9844 | L2-Norm=18.342 | L2-Norm(final)=2.373 | 2021.2 samples/s | 31.6 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.11050 | Reg=0.00337 | acc=0.9688 | L2-Norm=18.366 | L2-Norm(final)=2.405 | 6115.3 samples/s | 95.6 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.10451 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.391 | L2-Norm(final)=2.435 | 2056.7 samples/s | 32.1 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.09902 | Reg=0.00339 | acc=0.9688 | L2-Norm=18.419 | L2-Norm(final)=2.465 | 5843.3 samples/s | 91.3 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.7] | Loss=0.03456 | Reg=0.00349 | acc=0.9844 | L2-Norm=18.688 | L2-Norm(final)=2.761 | 3864.4 samples/s | 60.4 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.04269 | Reg=0.00348 | acc=0.9844 | L2-Norm=18.653 | L2-Norm(final)=2.774 | 4540.3 samples/s | 70.9 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.02886 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.640 | L2-Norm(final)=2.787 | 6358.4 samples/s | 99.3 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01976 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.621 | L2-Norm(final)=2.798 | 1820.2 samples/s | 28.4 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.01501 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.593 | L2-Norm(final)=2.806 | 5891.3 samples/s | 92.1 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01208 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.561 | L2-Norm(final)=2.812 | 1859.6 samples/s | 29.1 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01010 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.526 | L2-Norm(final)=2.816 | 5414.8 samples/s | 84.6 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.00868 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.489 | L2-Norm(final)=2.820 | 1893.9 samples/s | 29.6 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.00761 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.450 | L2-Norm(final)=2.823 | 5190.5 samples/s | 81.1 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.00677 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.411 | L2-Norm(final)=2.825 | 1960.3 samples/s | 30.6 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.00610 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.372 | L2-Norm(final)=2.827 | 4813.7 samples/s | 75.2 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.00556 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.332 | L2-Norm(final)=2.829 | 1987.1 samples/s | 31.0 steps/s
[Step=1100 Epoch=10.4] | Loss=0.00510 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.292 | L2-Norm(final)=2.831 | 4796.7 samples/s | 74.9 steps/s
[Step=1150 Epoch=10.9] | Loss=0.00471 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.253 | L2-Norm(final)=2.833 | 2011.9 samples/s | 31.4 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00438 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.213 | L2-Norm(final)=2.834 | 4921.2 samples/s | 76.9 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00409 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.174 | L2-Norm(final)=2.836 | 2008.8 samples/s | 31.4 steps/s
[Step=1300 Epoch=12.3] | Loss=0.00384 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.135 | L2-Norm(final)=2.837 | 4745.9 samples/s | 74.2 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00361 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.096 | L2-Norm(final)=2.838 | 2054.5 samples/s | 32.1 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00341 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.057 | L2-Norm(final)=2.840 | 4446.6 samples/s | 69.5 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00324 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.019 | L2-Norm(final)=2.841 | 6544.2 samples/s | 102.3 steps/s
[Step=1500 Epoch=14.2] | Loss=0.00308 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.981 | L2-Norm(final)=2.842 | 1807.7 samples/s | 28.2 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00293 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.943 | L2-Norm(final)=2.844 | 5986.5 samples/s | 93.5 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00280 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.905 | L2-Norm(final)=2.845 | 1835.0 samples/s | 28.7 steps/s
[Step=1650 Epoch=15.6] | Loss=0.00268 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.867 | L2-Norm(final)=2.846 | 5660.1 samples/s | 88.4 steps/s
[Step=1700 Epoch=16.1] | Loss=0.00257 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.830 | L2-Norm(final)=2.847 | 1894.1 samples/s | 29.6 steps/s
[Step=1750 Epoch=16.6] | Loss=0.00247 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.792 | L2-Norm(final)=2.848 | 5272.5 samples/s | 82.4 steps/s
[Step=1800 Epoch=17.1] | Loss=0.00237 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.755 | L2-Norm(final)=2.849 | 1933.2 samples/s | 30.2 steps/s
[Step=1850 Epoch=17.5] | Loss=0.00228 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.719 | L2-Norm(final)=2.851 | 4941.2 samples/s | 77.2 steps/s
[Step=1900 Epoch=18.0] | Loss=0.00220 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.682 | L2-Norm(final)=2.852 | 1978.2 samples/s | 30.9 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00213 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.645 | L2-Norm(final)=2.853 | 4793.3 samples/s | 74.9 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00206 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.609 | L2-Norm(final)=2.854 | 2001.0 samples/s | 31.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_0/client_state-step2000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34402 | Reg=0.00355 | acc=0.4375 | L2-Norm=18.836 | L2-Norm(final)=2.103 | 3799.6 samples/s | 59.4 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.21802 | Reg=0.00342 | acc=0.9375 | L2-Norm=18.482 | L2-Norm(final)=2.144 | 5341.6 samples/s | 83.5 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.17114 | Reg=0.00338 | acc=0.9062 | L2-Norm=18.388 | L2-Norm(final)=2.205 | 8403.8 samples/s | 131.3 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.14758 | Reg=0.00337 | acc=0.9531 | L2-Norm=18.369 | L2-Norm(final)=2.260 | 1922.7 samples/s | 30.0 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.13221 | Reg=0.00338 | acc=0.9531 | L2-Norm=18.383 | L2-Norm(final)=2.307 | 7324.1 samples/s | 114.4 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.11881 | Reg=0.00339 | acc=0.9531 | L2-Norm=18.411 | L2-Norm(final)=2.349 | 1952.0 samples/s | 30.5 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.11036 | Reg=0.00340 | acc=0.9531 | L2-Norm=18.442 | L2-Norm(final)=2.389 | 7051.6 samples/s | 110.2 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.10265 | Reg=0.00341 | acc=0.9219 | L2-Norm=18.479 | L2-Norm(final)=2.428 | 1942.7 samples/s | 30.4 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.09709 | Reg=0.00343 | acc=0.9688 | L2-Norm=18.518 | L2-Norm(final)=2.467 | 5835.4 samples/s | 91.2 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.09181 | Reg=0.00344 | acc=0.9844 | L2-Norm=18.560 | L2-Norm(final)=2.503 | 2042.3 samples/s | 31.9 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.08763 | Reg=0.00346 | acc=0.9531 | L2-Norm=18.602 | L2-Norm(final)=2.539 | 5999.7 samples/s | 93.7 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.8] | Loss=0.09283 | Reg=0.00362 | acc=0.9375 | L2-Norm=19.037 | L2-Norm(final)=2.894 | 3861.4 samples/s | 60.3 steps/s
[Step= 550 Epoch= 5.3] | Loss=0.08209 | Reg=0.00363 | acc=1.0000 | L2-Norm=19.059 | L2-Norm(final)=2.878 | 4428.5 samples/s | 69.2 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.04863 | Reg=0.00364 | acc=1.0000 | L2-Norm=19.074 | L2-Norm(final)=2.893 | 6371.4 samples/s | 99.6 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.03374 | Reg=0.00363 | acc=1.0000 | L2-Norm=19.061 | L2-Norm(final)=2.906 | 1822.2 samples/s | 28.5 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.02574 | Reg=0.00362 | acc=1.0000 | L2-Norm=19.036 | L2-Norm(final)=2.917 | 6023.4 samples/s | 94.1 steps/s
[Step= 750 Epoch= 7.2] | Loss=0.02072 | Reg=0.00361 | acc=1.0000 | L2-Norm=19.008 | L2-Norm(final)=2.925 | 1839.8 samples/s | 28.7 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01732 | Reg=0.00360 | acc=1.0000 | L2-Norm=18.975 | L2-Norm(final)=2.931 | 5672.5 samples/s | 88.6 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.01488 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.939 | L2-Norm(final)=2.936 | 1878.9 samples/s | 29.4 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.01304 | Reg=0.00357 | acc=1.0000 | L2-Norm=18.901 | L2-Norm(final)=2.941 | 5260.5 samples/s | 82.2 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.01161 | Reg=0.00356 | acc=1.0000 | L2-Norm=18.862 | L2-Norm(final)=2.945 | 1902.0 samples/s | 29.7 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01046 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.822 | L2-Norm(final)=2.950 | 5000.4 samples/s | 78.1 steps/s
[Step=1050 Epoch=10.0] | Loss=0.00952 | Reg=0.00353 | acc=1.0000 | L2-Norm=18.781 | L2-Norm(final)=2.954 | 1935.8 samples/s | 30.2 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00873 | Reg=0.00351 | acc=1.0000 | L2-Norm=18.740 | L2-Norm(final)=2.959 | 4872.5 samples/s | 76.1 steps/s
[Step=1150 Epoch=11.0] | Loss=0.00806 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.699 | L2-Norm(final)=2.963 | 1970.6 samples/s | 30.8 steps/s
[Step=1200 Epoch=11.5] | Loss=0.00749 | Reg=0.00348 | acc=1.0000 | L2-Norm=18.658 | L2-Norm(final)=2.967 | 4763.1 samples/s | 74.4 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00700 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.616 | L2-Norm(final)=2.972 | 2006.9 samples/s | 31.4 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00656 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.574 | L2-Norm(final)=2.976 | 4781.4 samples/s | 74.7 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00618 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.532 | L2-Norm(final)=2.980 | 1967.6 samples/s | 30.7 steps/s
[Step=1400 Epoch=13.4] | Loss=0.00584 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.490 | L2-Norm(final)=2.985 | 4764.0 samples/s | 74.4 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00553 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.448 | L2-Norm(final)=2.989 | 2011.6 samples/s | 31.4 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00526 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.406 | L2-Norm(final)=2.993 | 4700.6 samples/s | 73.4 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00501 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.365 | L2-Norm(final)=2.997 | 6952.3 samples/s | 108.6 steps/s
[Step=1600 Epoch=15.3] | Loss=0.00478 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.323 | L2-Norm(final)=3.001 | 1755.9 samples/s | 27.4 steps/s
[Step=1650 Epoch=15.8] | Loss=0.00458 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.281 | L2-Norm(final)=3.006 | 6409.9 samples/s | 100.2 steps/s
[Step=1700 Epoch=16.2] | Loss=0.00439 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.240 | L2-Norm(final)=3.010 | 1801.6 samples/s | 28.2 steps/s
[Step=1750 Epoch=16.7] | Loss=0.00421 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.198 | L2-Norm(final)=3.014 | 6010.9 samples/s | 93.9 steps/s
[Step=1800 Epoch=17.2] | Loss=0.00405 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.157 | L2-Norm(final)=3.018 | 1837.7 samples/s | 28.7 steps/s
[Step=1850 Epoch=17.7] | Loss=0.00390 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.116 | L2-Norm(final)=3.022 | 5696.4 samples/s | 89.0 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00376 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.075 | L2-Norm(final)=3.026 | 1844.3 samples/s | 28.8 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00364 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.035 | L2-Norm(final)=3.031 | 5375.8 samples/s | 84.0 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00352 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.994 | L2-Norm(final)=3.035 | 1898.8 samples/s | 29.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step2000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.31339 | Reg=0.00355 | acc=0.5156 | L2-Norm=18.836 | L2-Norm(final)=2.104 | 3931.3 samples/s | 61.4 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.22467 | Reg=0.00338 | acc=0.8750 | L2-Norm=18.385 | L2-Norm(final)=2.129 | 4905.7 samples/s | 76.7 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.18678 | Reg=0.00333 | acc=0.9531 | L2-Norm=18.244 | L2-Norm(final)=2.185 | 8114.9 samples/s | 126.8 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.16024 | Reg=0.00331 | acc=0.9219 | L2-Norm=18.206 | L2-Norm(final)=2.241 | 1900.8 samples/s | 29.7 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.14263 | Reg=0.00331 | acc=0.9375 | L2-Norm=18.204 | L2-Norm(final)=2.296 | 7033.9 samples/s | 109.9 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.12984 | Reg=0.00332 | acc=0.9375 | L2-Norm=18.218 | L2-Norm(final)=2.346 | 1977.2 samples/s | 30.9 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.11970 | Reg=0.00333 | acc=0.9688 | L2-Norm=18.241 | L2-Norm(final)=2.391 | 6544.9 samples/s | 102.3 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.11355 | Reg=0.00334 | acc=0.9531 | L2-Norm=18.269 | L2-Norm(final)=2.434 | 2017.0 samples/s | 31.5 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.10632 | Reg=0.00335 | acc=0.9844 | L2-Norm=18.303 | L2-Norm(final)=2.473 | 5896.9 samples/s | 92.1 steps/s
[Step= 450 Epoch= 4.2] | Loss=0.09998 | Reg=0.00336 | acc=0.9531 | L2-Norm=18.339 | L2-Norm(final)=2.511 | 2103.4 samples/s | 32.9 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.09530 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.373 | L2-Norm(final)=2.549 | 5595.9 samples/s | 87.4 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.7] | Loss=0.03979 | Reg=0.00350 | acc=0.9844 | L2-Norm=18.702 | L2-Norm(final)=2.920 | 3961.8 samples/s | 61.9 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.07843 | Reg=0.00349 | acc=0.9844 | L2-Norm=18.676 | L2-Norm(final)=2.911 | 4364.7 samples/s | 68.2 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.04591 | Reg=0.00349 | acc=0.9844 | L2-Norm=18.687 | L2-Norm(final)=2.922 | 6335.2 samples/s | 99.0 steps/s
[Step= 650 Epoch= 6.1] | Loss=0.03151 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.691 | L2-Norm(final)=2.934 | 1792.6 samples/s | 28.0 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.02401 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.681 | L2-Norm(final)=2.944 | 5703.7 samples/s | 89.1 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01940 | Reg=0.00348 | acc=1.0000 | L2-Norm=18.666 | L2-Norm(final)=2.951 | 1827.0 samples/s | 28.5 steps/s
[Step= 800 Epoch= 7.5] | Loss=0.01623 | Reg=0.00348 | acc=1.0000 | L2-Norm=18.646 | L2-Norm(final)=2.958 | 5289.9 samples/s | 82.7 steps/s
[Step= 850 Epoch= 8.0] | Loss=0.01395 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.623 | L2-Norm(final)=2.963 | 1952.8 samples/s | 30.5 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.01222 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.596 | L2-Norm(final)=2.967 | 4848.6 samples/s | 75.8 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.01088 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.568 | L2-Norm(final)=2.971 | 1951.3 samples/s | 30.5 steps/s
[Step=1000 Epoch= 9.4] | Loss=0.00981 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.538 | L2-Norm(final)=2.975 | 4778.1 samples/s | 74.7 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.00893 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.507 | L2-Norm(final)=2.978 | 1990.0 samples/s | 31.1 steps/s
[Step=1100 Epoch=10.4] | Loss=0.00819 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.475 | L2-Norm(final)=2.981 | 4792.8 samples/s | 74.9 steps/s
[Step=1150 Epoch=10.8] | Loss=0.00757 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.443 | L2-Norm(final)=2.984 | 1998.1 samples/s | 31.2 steps/s
[Step=1200 Epoch=11.3] | Loss=0.00703 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.410 | L2-Norm(final)=2.987 | 4780.8 samples/s | 74.7 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00657 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.376 | L2-Norm(final)=2.990 | 2083.3 samples/s | 32.6 steps/s
[Step=1300 Epoch=12.2] | Loss=0.00616 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.342 | L2-Norm(final)=2.993 | 4545.2 samples/s | 71.0 steps/s
[Step=1350 Epoch=12.7] | Loss=0.00580 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.308 | L2-Norm(final)=2.996 | 6332.7 samples/s | 98.9 steps/s
[Step=1400 Epoch=13.2] | Loss=0.00548 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.274 | L2-Norm(final)=2.999 | 1821.3 samples/s | 28.5 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00520 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.239 | L2-Norm(final)=3.002 | 5753.2 samples/s | 89.9 steps/s
[Step=1500 Epoch=14.1] | Loss=0.00494 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.205 | L2-Norm(final)=3.005 | 1863.1 samples/s | 29.1 steps/s
[Step=1550 Epoch=14.6] | Loss=0.00470 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.170 | L2-Norm(final)=3.008 | 5396.1 samples/s | 84.3 steps/s
[Step=1600 Epoch=15.1] | Loss=0.00449 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.135 | L2-Norm(final)=3.011 | 1897.7 samples/s | 29.7 steps/s
[Step=1650 Epoch=15.5] | Loss=0.00430 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.100 | L2-Norm(final)=3.014 | 5025.8 samples/s | 78.5 steps/s
[Step=1700 Epoch=16.0] | Loss=0.00412 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.066 | L2-Norm(final)=3.017 | 1931.3 samples/s | 30.2 steps/s
[Step=1750 Epoch=16.5] | Loss=0.00396 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.031 | L2-Norm(final)=3.020 | 4739.1 samples/s | 74.0 steps/s
[Step=1800 Epoch=17.0] | Loss=0.00381 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.996 | L2-Norm(final)=3.023 | 1989.6 samples/s | 31.1 steps/s
[Step=1850 Epoch=17.4] | Loss=0.00367 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.961 | L2-Norm(final)=3.026 | 4781.9 samples/s | 74.7 steps/s
[Step=1900 Epoch=17.9] | Loss=0.00354 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.927 | L2-Norm(final)=3.029 | 2026.3 samples/s | 31.7 steps/s
[Step=1950 Epoch=18.4] | Loss=0.00342 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.892 | L2-Norm(final)=3.032 | 4680.2 samples/s | 73.1 steps/s
[Step=2000 Epoch=18.8] | Loss=0.00330 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.857 | L2-Norm(final)=3.035 | 2074.1 samples/s | 32.4 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step2000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.36333 | Reg=0.00355 | acc=0.4062 | L2-Norm=18.836 | L2-Norm(final)=2.104 | 3856.3 samples/s | 60.3 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.23773 | Reg=0.00337 | acc=0.8281 | L2-Norm=18.367 | L2-Norm(final)=2.123 | 5170.7 samples/s | 80.8 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.19123 | Reg=0.00333 | acc=0.9375 | L2-Norm=18.244 | L2-Norm(final)=2.181 | 8037.1 samples/s | 125.6 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.16459 | Reg=0.00332 | acc=0.8750 | L2-Norm=18.212 | L2-Norm(final)=2.235 | 1855.1 samples/s | 29.0 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.14594 | Reg=0.00332 | acc=0.9375 | L2-Norm=18.215 | L2-Norm(final)=2.283 | 7524.3 samples/s | 117.6 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.13367 | Reg=0.00333 | acc=0.9688 | L2-Norm=18.241 | L2-Norm(final)=2.328 | 1942.6 samples/s | 30.4 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.12260 | Reg=0.00334 | acc=0.9688 | L2-Norm=18.278 | L2-Norm(final)=2.368 | 6692.0 samples/s | 104.6 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.11366 | Reg=0.00336 | acc=0.9688 | L2-Norm=18.321 | L2-Norm(final)=2.408 | 2003.8 samples/s | 31.3 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.10831 | Reg=0.00338 | acc=0.9531 | L2-Norm=18.370 | L2-Norm(final)=2.447 | 6475.5 samples/s | 101.2 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.10235 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.427 | L2-Norm(final)=2.482 | 1957.3 samples/s | 30.6 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.09703 | Reg=0.00342 | acc=0.9531 | L2-Norm=18.485 | L2-Norm(final)=2.517 | 6136.7 samples/s | 95.9 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.8] | Loss=0.05326 | Reg=0.00363 | acc=0.9688 | L2-Norm=19.055 | L2-Norm(final)=2.866 | 3829.5 samples/s | 59.8 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.09129 | Reg=0.00362 | acc=1.0000 | L2-Norm=19.031 | L2-Norm(final)=2.845 | 4442.9 samples/s | 69.4 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.05337 | Reg=0.00363 | acc=1.0000 | L2-Norm=19.063 | L2-Norm(final)=2.859 | 6437.8 samples/s | 100.6 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.03650 | Reg=0.00364 | acc=1.0000 | L2-Norm=19.077 | L2-Norm(final)=2.872 | 1785.1 samples/s | 27.9 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.02799 | Reg=0.00364 | acc=1.0000 | L2-Norm=19.077 | L2-Norm(final)=2.881 | 5943.3 samples/s | 92.9 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.02253 | Reg=0.00364 | acc=1.0000 | L2-Norm=19.067 | L2-Norm(final)=2.889 | 1862.6 samples/s | 29.1 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01884 | Reg=0.00363 | acc=1.0000 | L2-Norm=19.050 | L2-Norm(final)=2.896 | 5449.7 samples/s | 85.2 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.01618 | Reg=0.00362 | acc=1.0000 | L2-Norm=19.027 | L2-Norm(final)=2.901 | 1897.3 samples/s | 29.6 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.01419 | Reg=0.00361 | acc=1.0000 | L2-Norm=19.000 | L2-Norm(final)=2.906 | 5231.0 samples/s | 81.7 steps/s
[Step= 950 Epoch= 9.1] | Loss=0.01263 | Reg=0.00360 | acc=1.0000 | L2-Norm=18.970 | L2-Norm(final)=2.909 | 1915.8 samples/s | 29.9 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01138 | Reg=0.00359 | acc=1.0000 | L2-Norm=18.939 | L2-Norm(final)=2.913 | 4934.5 samples/s | 77.1 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01036 | Reg=0.00357 | acc=1.0000 | L2-Norm=18.907 | L2-Norm(final)=2.916 | 1948.5 samples/s | 30.4 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00951 | Reg=0.00356 | acc=1.0000 | L2-Norm=18.873 | L2-Norm(final)=2.919 | 4763.8 samples/s | 74.4 steps/s
[Step=1150 Epoch=11.0] | Loss=0.00878 | Reg=0.00355 | acc=1.0000 | L2-Norm=18.839 | L2-Norm(final)=2.922 | 1966.8 samples/s | 30.7 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00816 | Reg=0.00354 | acc=1.0000 | L2-Norm=18.805 | L2-Norm(final)=2.925 | 4757.3 samples/s | 74.3 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00762 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.770 | L2-Norm(final)=2.928 | 1986.5 samples/s | 31.0 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00715 | Reg=0.00351 | acc=1.0000 | L2-Norm=18.734 | L2-Norm(final)=2.931 | 4735.6 samples/s | 74.0 steps/s
[Step=1350 Epoch=12.9] | Loss=0.00673 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.698 | L2-Norm(final)=2.934 | 1994.1 samples/s | 31.2 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00636 | Reg=0.00348 | acc=1.0000 | L2-Norm=18.662 | L2-Norm(final)=2.937 | 4795.5 samples/s | 74.9 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00603 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.626 | L2-Norm(final)=2.940 | 2004.6 samples/s | 31.3 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00573 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.589 | L2-Norm(final)=2.943 | 4584.8 samples/s | 71.6 steps/s
[Step=1550 Epoch=14.8] | Loss=0.00546 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.552 | L2-Norm(final)=2.946 | 6853.1 samples/s | 107.1 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00521 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.515 | L2-Norm(final)=2.949 | 1762.0 samples/s | 27.5 steps/s
[Step=1650 Epoch=15.7] | Loss=0.00499 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.479 | L2-Norm(final)=2.952 | 6478.0 samples/s | 101.2 steps/s
[Step=1700 Epoch=16.2] | Loss=0.00478 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.442 | L2-Norm(final)=2.955 | 1798.6 samples/s | 28.1 steps/s
[Step=1750 Epoch=16.7] | Loss=0.00459 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.404 | L2-Norm(final)=2.958 | 6023.1 samples/s | 94.1 steps/s
[Step=1800 Epoch=17.2] | Loss=0.00442 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.367 | L2-Norm(final)=2.962 | 1836.3 samples/s | 28.7 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00425 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.330 | L2-Norm(final)=2.965 | 5705.9 samples/s | 89.2 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00410 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.293 | L2-Norm(final)=2.968 | 1866.5 samples/s | 29.2 steps/s
[Step=1950 Epoch=18.6] | Loss=0.00396 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.256 | L2-Norm(final)=2.971 | 5271.1 samples/s | 82.4 steps/s
[Step=2000 Epoch=19.1] | Loss=0.00383 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.219 | L2-Norm(final)=2.974 | 1901.5 samples/s | 29.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step2000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.32229 | acc=0.6802 | tpr=0.9925 | fpr=0.9980 | 4325.5 samples/s | 16.9 steps/s
Avg test loss: 0.32090, Avg test acc: 0.68343, Avg tpr: 0.99318, Avg fpr: 0.99782, total FA: 7784

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14260 | acc=0.9234 | tpr=0.9514 | fpr=0.1373 | 4538.0 samples/s | 17.7 steps/s
Avg test loss: 0.14509, Avg test acc: 0.92143, Avg tpr: 0.94778, Avg fpr: 0.13652, total FA: 1065

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.32229 | acc=0.6802 | tpr=0.9925 | fpr=0.9980 | 4346.0 samples/s | 17.0 steps/s
Avg test loss: 0.32090, Avg test acc: 0.68343, Avg tpr: 0.99318, Avg fpr: 0.99782, total FA: 7784

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.32229 | acc=0.6802 | tpr=0.9925 | fpr=0.9980 | 4386.4 samples/s | 17.1 steps/s
Avg test loss: 0.32090, Avg test acc: 0.68343, Avg tpr: 0.99318, Avg fpr: 0.99782, total FA: 7784

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.32229 | acc=0.6802 | tpr=0.9925 | fpr=0.9980 | 4367.7 samples/s | 17.1 steps/s
Avg test loss: 0.32090, Avg test acc: 0.68343, Avg tpr: 0.99318, Avg fpr: 0.99782, total FA: 7784

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=3.87613 | acc=0.3195 | tpr=0.0175 | fpr=0.0245 | 4395.2 samples/s | 17.2 steps/s
Avg test loss: 3.87277, Avg test acc: 0.31781, Avg tpr: 0.01818, Avg fpr: 0.02320, total FA: 181

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=0.32229 | acc=0.6802 | tpr=0.9925 | fpr=0.9980 | 4404.1 samples/s | 17.2 steps/s
Avg test loss: 0.32090, Avg test acc: 0.68343, Avg tpr: 0.99318, Avg fpr: 0.99782, total FA: 7784

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=3.57548 | acc=0.3184 | tpr=0.0139 | fpr=0.0203 | 4400.0 samples/s | 17.2 steps/s
Avg test loss: 3.57365, Avg test acc: 0.31633, Avg tpr: 0.01463, Avg fpr: 0.02013, total FA: 157

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=3.82744 | acc=0.3181 | tpr=0.0110 | fpr=0.0149 | 4381.5 samples/s | 17.1 steps/s
Avg test loss: 3.82343, Avg test acc: 0.31601, Avg tpr: 0.01107, Avg fpr: 0.01333, total FA: 104

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=3.83227 | acc=0.3166 | tpr=0.0116 | fpr=0.0211 | 4394.0 samples/s | 17.2 steps/s
Avg test loss: 3.82612, Avg test acc: 0.31509, Avg tpr: 0.01241, Avg fpr: 0.01923, total FA: 150

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=0.49347 | acc=0.0224 | tpr=1.0000 | fpr=0.9951 | 4337.3 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.49431 | acc=0.0224 | tpr=1.0000 | fpr=0.9958 | 8766.9 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.49466 | acc=0.0221 | tpr=1.0000 | fpr=0.9959 | 8589.4 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.49447 | acc=0.0218 | tpr=1.0000 | fpr=0.9960 | 8859.1 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.49484 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8457.4 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.49501 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8706.5 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.49495 | acc=0.0215 | tpr=1.0000 | fpr=0.9962 | 8989.6 samples/s | 35.1 steps/s
[Step= 400] | Loss=0.49496 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8454.9 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.49497 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 8476.5 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.49508 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 8625.5 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.49497 | acc=0.0215 | tpr=1.0000 | fpr=0.9963 | 15498.6 samples/s | 60.5 steps/s
Avg test loss: 0.49495, Avg test acc: 0.02145, Avg tpr: 1.00000, Avg fpr: 0.99633, total FA: 138339

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.37064 | acc=0.0994 | tpr=0.8097 | fpr=0.9134 | 4363.2 samples/s | 17.0 steps/s
[Step= 100] | Loss=3.36727 | acc=0.0989 | tpr=0.7910 | fpr=0.9140 | 8791.5 samples/s | 34.3 steps/s
[Step= 150] | Loss=3.37333 | acc=0.1004 | tpr=0.7954 | fpr=0.9123 | 8538.6 samples/s | 33.4 steps/s
[Step= 200] | Loss=3.37404 | acc=0.0996 | tpr=0.7989 | fpr=0.9131 | 9061.1 samples/s | 35.4 steps/s
[Step= 250] | Loss=3.37244 | acc=0.0999 | tpr=0.7886 | fpr=0.9127 | 8194.8 samples/s | 32.0 steps/s
[Step= 300] | Loss=3.37520 | acc=0.1000 | tpr=0.7913 | fpr=0.9126 | 8747.5 samples/s | 34.2 steps/s
[Step= 350] | Loss=3.37119 | acc=0.1003 | tpr=0.7884 | fpr=0.9122 | 8430.5 samples/s | 32.9 steps/s
[Step= 400] | Loss=3.37106 | acc=0.0998 | tpr=0.7877 | fpr=0.9127 | 9173.1 samples/s | 35.8 steps/s
[Step= 450] | Loss=3.37611 | acc=0.0995 | tpr=0.7936 | fpr=0.9131 | 8306.0 samples/s | 32.4 steps/s
[Step= 500] | Loss=3.38057 | acc=0.0991 | tpr=0.7921 | fpr=0.9134 | 8412.9 samples/s | 32.9 steps/s
[Step= 550] | Loss=3.37906 | acc=0.0994 | tpr=0.7967 | fpr=0.9133 | 15552.8 samples/s | 60.8 steps/s
Avg test loss: 3.37963, Avg test acc: 0.09931, Avg tpr: 0.79675, Avg fpr: 0.91337, total FA: 126819

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=0.49347 | acc=0.0224 | tpr=1.0000 | fpr=0.9951 | 4459.8 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.49431 | acc=0.0224 | tpr=1.0000 | fpr=0.9958 | 8451.6 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.49466 | acc=0.0221 | tpr=1.0000 | fpr=0.9959 | 8277.4 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.49447 | acc=0.0218 | tpr=1.0000 | fpr=0.9960 | 8906.6 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.49484 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8237.6 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.49501 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8913.4 samples/s | 34.8 steps/s
[Step= 350] | Loss=0.49495 | acc=0.0215 | tpr=1.0000 | fpr=0.9962 | 8398.7 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.49496 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8527.1 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.49497 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 8658.6 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.49508 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 8956.6 samples/s | 35.0 steps/s
[Step= 550] | Loss=0.49497 | acc=0.0215 | tpr=1.0000 | fpr=0.9963 | 14526.8 samples/s | 56.7 steps/s
Avg test loss: 0.49495, Avg test acc: 0.02145, Avg tpr: 1.00000, Avg fpr: 0.99633, total FA: 138339

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=0.49347 | acc=0.0224 | tpr=1.0000 | fpr=0.9951 | 4407.5 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.49431 | acc=0.0224 | tpr=1.0000 | fpr=0.9958 | 9142.6 samples/s | 35.7 steps/s
[Step= 150] | Loss=0.49466 | acc=0.0221 | tpr=1.0000 | fpr=0.9959 | 7977.2 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.49447 | acc=0.0218 | tpr=1.0000 | fpr=0.9960 | 8938.1 samples/s | 34.9 steps/s
[Step= 250] | Loss=0.49484 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8404.9 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.49501 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8561.3 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.49495 | acc=0.0215 | tpr=1.0000 | fpr=0.9962 | 8717.6 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.49496 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8618.1 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.49497 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 8684.7 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.49508 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 8679.3 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.49497 | acc=0.0215 | tpr=1.0000 | fpr=0.9963 | 15014.3 samples/s | 58.6 steps/s
Avg test loss: 0.49495, Avg test acc: 0.02145, Avg tpr: 1.00000, Avg fpr: 0.99633, total FA: 138339

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=0.49347 | acc=0.0224 | tpr=1.0000 | fpr=0.9951 | 4353.7 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.49431 | acc=0.0224 | tpr=1.0000 | fpr=0.9958 | 8625.3 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.49466 | acc=0.0221 | tpr=1.0000 | fpr=0.9959 | 8663.3 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.49447 | acc=0.0218 | tpr=1.0000 | fpr=0.9960 | 8771.3 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.49484 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8513.3 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.49501 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8679.3 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.49495 | acc=0.0215 | tpr=1.0000 | fpr=0.9962 | 8742.7 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.49496 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8569.5 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.49497 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 9595.3 samples/s | 37.5 steps/s
[Step= 500] | Loss=0.49508 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 7876.2 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.49497 | acc=0.0215 | tpr=1.0000 | fpr=0.9963 | 15271.3 samples/s | 59.7 steps/s
Avg test loss: 0.49495, Avg test acc: 0.02145, Avg tpr: 1.00000, Avg fpr: 0.99633, total FA: 138339

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.05105 | acc=0.9795 | tpr=0.8053 | fpr=0.0173 | 4322.4 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.04880 | acc=0.9795 | tpr=0.8124 | fpr=0.0173 | 8812.6 samples/s | 34.4 steps/s
[Step= 150] | Loss=0.04998 | acc=0.9793 | tpr=0.8112 | fpr=0.0176 | 8462.4 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.05094 | acc=0.9792 | tpr=0.8219 | fpr=0.0179 | 8775.3 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.05087 | acc=0.9793 | tpr=0.8183 | fpr=0.0178 | 8718.6 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.05156 | acc=0.9790 | tpr=0.8145 | fpr=0.0180 | 8562.4 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.05108 | acc=0.9791 | tpr=0.8178 | fpr=0.0180 | 8473.6 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.05154 | acc=0.9789 | tpr=0.8129 | fpr=0.0181 | 8520.9 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.05234 | acc=0.9787 | tpr=0.8116 | fpr=0.0183 | 8990.9 samples/s | 35.1 steps/s
[Step= 500] | Loss=0.05192 | acc=0.9789 | tpr=0.8145 | fpr=0.0182 | 8390.0 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.05123 | acc=0.9790 | tpr=0.8158 | fpr=0.0181 | 15810.5 samples/s | 61.8 steps/s
Avg test loss: 0.05119, Avg test acc: 0.97894, Avg tpr: 0.81498, Avg fpr: 0.01808, total FA: 2510

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.49347 | acc=0.0224 | tpr=1.0000 | fpr=0.9951 | 4345.9 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.49431 | acc=0.0224 | tpr=1.0000 | fpr=0.9958 | 8980.0 samples/s | 35.1 steps/s
[Step= 150] | Loss=0.49466 | acc=0.0221 | tpr=1.0000 | fpr=0.9959 | 8278.8 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.49447 | acc=0.0218 | tpr=1.0000 | fpr=0.9960 | 8703.7 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.49484 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8520.4 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.49501 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8531.7 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.49495 | acc=0.0215 | tpr=1.0000 | fpr=0.9962 | 9010.8 samples/s | 35.2 steps/s
[Step= 400] | Loss=0.49496 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8346.5 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.49497 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 8707.8 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.49508 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 8454.6 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.49497 | acc=0.0215 | tpr=1.0000 | fpr=0.9963 | 15546.6 samples/s | 60.7 steps/s
Avg test loss: 0.49495, Avg test acc: 0.02145, Avg tpr: 1.00000, Avg fpr: 0.99633, total FA: 138339

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.04549 | acc=0.9822 | tpr=0.7965 | fpr=0.0145 | 4342.6 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.04626 | acc=0.9811 | tpr=0.7996 | fpr=0.0155 | 8624.3 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.04700 | acc=0.9805 | tpr=0.8026 | fpr=0.0162 | 9098.4 samples/s | 35.5 steps/s
[Step= 200] | Loss=0.04802 | acc=0.9804 | tpr=0.8131 | fpr=0.0165 | 8206.6 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.04846 | acc=0.9799 | tpr=0.8157 | fpr=0.0171 | 9204.3 samples/s | 36.0 steps/s
[Step= 300] | Loss=0.04918 | acc=0.9798 | tpr=0.8095 | fpr=0.0171 | 8318.2 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.04876 | acc=0.9798 | tpr=0.8121 | fpr=0.0172 | 8632.9 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.04917 | acc=0.9796 | tpr=0.8124 | fpr=0.0174 | 8592.0 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.04989 | acc=0.9795 | tpr=0.8165 | fpr=0.0176 | 9004.5 samples/s | 35.2 steps/s
[Step= 500] | Loss=0.04951 | acc=0.9796 | tpr=0.8198 | fpr=0.0175 | 8149.9 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.04909 | acc=0.9796 | tpr=0.8185 | fpr=0.0174 | 15870.9 samples/s | 62.0 steps/s
Avg test loss: 0.04909, Avg test acc: 0.97964, Avg tpr: 0.81815, Avg fpr: 0.01743, total FA: 2420

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.05746 | acc=0.9784 | tpr=0.8053 | fpr=0.0185 | 4378.3 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.05790 | acc=0.9776 | tpr=0.8060 | fpr=0.0192 | 8694.9 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.05895 | acc=0.9771 | tpr=0.8127 | fpr=0.0199 | 8458.4 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.06064 | acc=0.9764 | tpr=0.8120 | fpr=0.0206 | 8505.1 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.06082 | acc=0.9767 | tpr=0.8009 | fpr=0.0201 | 8663.7 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.06164 | acc=0.9764 | tpr=0.7971 | fpr=0.0204 | 8736.6 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.06118 | acc=0.9762 | tpr=0.8059 | fpr=0.0207 | 8809.8 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.06170 | acc=0.9760 | tpr=0.8020 | fpr=0.0208 | 8739.2 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.06270 | acc=0.9756 | tpr=0.8023 | fpr=0.0212 | 8334.9 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.06219 | acc=0.9759 | tpr=0.8066 | fpr=0.0211 | 9029.0 samples/s | 35.3 steps/s
[Step= 550] | Loss=0.06162 | acc=0.9761 | tpr=0.8086 | fpr=0.0208 | 14107.8 samples/s | 55.1 steps/s
Avg test loss: 0.06149, Avg test acc: 0.97611, Avg tpr: 0.80784, Avg fpr: 0.02084, total FA: 2893

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.06004 | acc=0.9784 | tpr=0.8009 | fpr=0.0185 | 4367.5 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.05947 | acc=0.9780 | tpr=0.8124 | fpr=0.0189 | 8443.0 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.06023 | acc=0.9770 | tpr=0.8141 | fpr=0.0200 | 9166.3 samples/s | 35.8 steps/s
[Step= 200] | Loss=0.06128 | acc=0.9771 | tpr=0.8197 | fpr=0.0200 | 8450.7 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.06088 | acc=0.9772 | tpr=0.8131 | fpr=0.0198 | 8742.5 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.06211 | acc=0.9769 | tpr=0.8080 | fpr=0.0200 | 8456.6 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.06231 | acc=0.9768 | tpr=0.8109 | fpr=0.0202 | 8336.4 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.06297 | acc=0.9765 | tpr=0.8025 | fpr=0.0204 | 8728.7 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.06410 | acc=0.9763 | tpr=0.8033 | fpr=0.0206 | 8771.0 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.06354 | acc=0.9764 | tpr=0.8048 | fpr=0.0205 | 8464.5 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.06294 | acc=0.9766 | tpr=0.8062 | fpr=0.0203 | 15557.6 samples/s | 60.8 steps/s
Avg test loss: 0.06281, Avg test acc: 0.97657, Avg tpr: 0.80547, Avg fpr: 0.02032, total FA: 2822

server round 1/50

clients selected: [0 1 4 6 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.36529 | Reg=0.00277 | acc=0.4375 | L2-Norm=16.632 | L2-Norm(final)=2.102 | 3994.1 samples/s | 62.4 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.32121 | Reg=0.00274 | acc=0.7031 | L2-Norm=16.547 | L2-Norm(final)=2.083 | 5369.6 samples/s | 83.9 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.30332 | Reg=0.00273 | acc=0.7656 | L2-Norm=16.536 | L2-Norm(final)=2.092 | 5972.4 samples/s | 93.3 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.29137 | Reg=0.00274 | acc=0.7969 | L2-Norm=16.557 | L2-Norm(final)=2.112 | 5955.3 samples/s | 93.1 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.28563 | Reg=0.00275 | acc=0.7812 | L2-Norm=16.594 | L2-Norm(final)=2.133 | 8463.7 samples/s | 132.2 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.27883 | Reg=0.00277 | acc=0.7500 | L2-Norm=16.641 | L2-Norm(final)=2.154 | 1949.8 samples/s | 30.5 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.27220 | Reg=0.00279 | acc=0.7344 | L2-Norm=16.690 | L2-Norm(final)=2.178 | 5994.5 samples/s | 93.7 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.26680 | Reg=0.00280 | acc=0.8125 | L2-Norm=16.741 | L2-Norm(final)=2.203 | 5840.4 samples/s | 91.3 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.26301 | Reg=0.00282 | acc=0.7344 | L2-Norm=16.790 | L2-Norm(final)=2.227 | 7818.2 samples/s | 122.2 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.26208 | Reg=0.00284 | acc=0.7344 | L2-Norm=16.840 | L2-Norm(final)=2.248 | 2044.5 samples/s | 31.9 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.25838 | Reg=0.00285 | acc=0.8438 | L2-Norm=16.891 | L2-Norm(final)=2.268 | 5695.2 samples/s | 89.0 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.4] | Loss=0.22545 | Reg=0.00303 | acc=0.7500 | L2-Norm=17.410 | L2-Norm(final)=2.475 | 4053.7 samples/s | 63.3 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.20565 | Reg=0.00305 | acc=0.9062 | L2-Norm=17.454 | L2-Norm(final)=2.488 | 4586.2 samples/s | 71.7 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.18587 | Reg=0.00305 | acc=0.9062 | L2-Norm=17.478 | L2-Norm(final)=2.496 | 4941.3 samples/s | 77.2 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.17120 | Reg=0.00306 | acc=0.8906 | L2-Norm=17.499 | L2-Norm(final)=2.507 | 4940.0 samples/s | 77.2 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.16037 | Reg=0.00307 | acc=0.8750 | L2-Norm=17.520 | L2-Norm(final)=2.517 | 6606.6 samples/s | 103.2 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.14478 | Reg=0.00308 | acc=0.9375 | L2-Norm=17.545 | L2-Norm(final)=2.528 | 1878.3 samples/s | 29.3 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.13529 | Reg=0.00309 | acc=0.9688 | L2-Norm=17.572 | L2-Norm(final)=2.540 | 4993.2 samples/s | 78.0 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.12717 | Reg=0.00310 | acc=0.9062 | L2-Norm=17.600 | L2-Norm(final)=2.551 | 4849.2 samples/s | 75.8 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.12048 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.630 | L2-Norm(final)=2.562 | 6154.3 samples/s | 96.2 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.11406 | Reg=0.00312 | acc=0.9688 | L2-Norm=17.661 | L2-Norm(final)=2.573 | 1916.6 samples/s | 29.9 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.10720 | Reg=0.00313 | acc=0.9531 | L2-Norm=17.693 | L2-Norm(final)=2.584 | 4968.2 samples/s | 77.6 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.10266 | Reg=0.00314 | acc=0.9531 | L2-Norm=17.723 | L2-Norm(final)=2.596 | 4942.0 samples/s | 77.2 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.09840 | Reg=0.00315 | acc=0.9688 | L2-Norm=17.751 | L2-Norm(final)=2.606 | 5646.8 samples/s | 88.2 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.09406 | Reg=0.00316 | acc=0.9375 | L2-Norm=17.776 | L2-Norm(final)=2.615 | 1960.2 samples/s | 30.6 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.08961 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.800 | L2-Norm(final)=2.625 | 4971.1 samples/s | 77.7 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.08631 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.823 | L2-Norm(final)=2.635 | 4905.6 samples/s | 76.6 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.08319 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.846 | L2-Norm(final)=2.644 | 5388.7 samples/s | 84.2 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.08089 | Reg=0.00319 | acc=0.9688 | L2-Norm=17.868 | L2-Norm(final)=2.653 | 2000.3 samples/s | 31.3 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.07839 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.891 | L2-Norm(final)=2.661 | 4843.9 samples/s | 75.7 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.07644 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.913 | L2-Norm(final)=2.669 | 4799.1 samples/s | 75.0 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.07452 | Reg=0.00322 | acc=0.9375 | L2-Norm=17.933 | L2-Norm(final)=2.677 | 4980.2 samples/s | 77.8 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.07277 | Reg=0.00322 | acc=0.9688 | L2-Norm=17.954 | L2-Norm(final)=2.683 | 2022.0 samples/s | 31.6 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.07051 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.974 | L2-Norm(final)=2.690 | 5005.7 samples/s | 78.2 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.06887 | Reg=0.00324 | acc=0.9375 | L2-Norm=17.993 | L2-Norm(final)=2.697 | 4942.7 samples/s | 77.2 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.06727 | Reg=0.00324 | acc=0.9531 | L2-Norm=18.011 | L2-Norm(final)=2.703 | 4936.4 samples/s | 77.1 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.06584 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.027 | L2-Norm(final)=2.708 | 2064.8 samples/s | 32.3 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.06396 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.044 | L2-Norm(final)=2.713 | 5059.0 samples/s | 79.0 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.06240 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.059 | L2-Norm(final)=2.718 | 4940.3 samples/s | 77.2 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.06101 | Reg=0.00327 | acc=0.9688 | L2-Norm=18.073 | L2-Norm(final)=2.723 | 4943.9 samples/s | 77.2 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.05975 | Reg=0.00327 | acc=0.9688 | L2-Norm=18.086 | L2-Norm(final)=2.728 | 2067.1 samples/s | 32.3 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.05855 | Reg=0.00328 | acc=0.9844 | L2-Norm=18.099 | L2-Norm(final)=2.732 | 4921.9 samples/s | 76.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step2000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=2001 Epoch= 9.8] | Loss=0.35480 | Reg=0.00277 | acc=0.5781 | L2-Norm=16.632 | L2-Norm(final)=2.713 | 4032.1 samples/s | 63.0 steps/s
[Step=2050 Epoch=10.0] | Loss=0.28785 | Reg=0.00281 | acc=0.8125 | L2-Norm=16.764 | L2-Norm(final)=2.685 | 5098.3 samples/s | 79.7 steps/s
[Step=2100 Epoch=10.2] | Loss=0.27059 | Reg=0.00283 | acc=0.7812 | L2-Norm=16.827 | L2-Norm(final)=2.694 | 5562.6 samples/s | 86.9 steps/s
[Step=2150 Epoch=10.5] | Loss=0.26582 | Reg=0.00285 | acc=0.6875 | L2-Norm=16.869 | L2-Norm(final)=2.699 | 5642.7 samples/s | 88.2 steps/s
[Step=2200 Epoch=10.7] | Loss=0.25763 | Reg=0.00286 | acc=0.7812 | L2-Norm=16.908 | L2-Norm(final)=2.702 | 7653.2 samples/s | 119.6 steps/s
[Step=2250 Epoch=11.0] | Loss=0.25219 | Reg=0.00287 | acc=0.7812 | L2-Norm=16.944 | L2-Norm(final)=2.708 | 1962.7 samples/s | 30.7 steps/s
[Step=2300 Epoch=11.2] | Loss=0.24618 | Reg=0.00288 | acc=0.8281 | L2-Norm=16.978 | L2-Norm(final)=2.716 | 5425.7 samples/s | 84.8 steps/s
[Step=2350 Epoch=11.5] | Loss=0.24103 | Reg=0.00289 | acc=0.7812 | L2-Norm=17.011 | L2-Norm(final)=2.728 | 5590.5 samples/s | 87.4 steps/s
[Step=2400 Epoch=11.7] | Loss=0.23643 | Reg=0.00291 | acc=0.8594 | L2-Norm=17.046 | L2-Norm(final)=2.742 | 7181.9 samples/s | 112.2 steps/s
[Step=2450 Epoch=12.0] | Loss=0.23258 | Reg=0.00292 | acc=0.8281 | L2-Norm=17.082 | L2-Norm(final)=2.758 | 1956.8 samples/s | 30.6 steps/s
[Step=2500 Epoch=12.2] | Loss=0.22957 | Reg=0.00293 | acc=0.8125 | L2-Norm=17.120 | L2-Norm(final)=2.775 | 5375.6 samples/s | 84.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.2] | Loss=0.15736 | Reg=0.00307 | acc=0.8750 | L2-Norm=17.514 | L2-Norm(final)=2.949 | 4063.3 samples/s | 63.5 steps/s
[Step=2550 Epoch=12.4] | Loss=0.18570 | Reg=0.00308 | acc=0.7344 | L2-Norm=17.557 | L2-Norm(final)=2.958 | 4632.4 samples/s | 72.4 steps/s
[Step=2600 Epoch=12.7] | Loss=0.17106 | Reg=0.00309 | acc=0.9219 | L2-Norm=17.579 | L2-Norm(final)=2.959 | 4877.4 samples/s | 76.2 steps/s
[Step=2650 Epoch=12.9] | Loss=0.15749 | Reg=0.00310 | acc=0.8594 | L2-Norm=17.601 | L2-Norm(final)=2.964 | 5042.0 samples/s | 78.8 steps/s
[Step=2700 Epoch=13.2] | Loss=0.14419 | Reg=0.00310 | acc=0.9062 | L2-Norm=17.621 | L2-Norm(final)=2.969 | 6501.3 samples/s | 101.6 steps/s
[Step=2750 Epoch=13.4] | Loss=0.13113 | Reg=0.00311 | acc=0.9375 | L2-Norm=17.641 | L2-Norm(final)=2.975 | 1884.4 samples/s | 29.4 steps/s
[Step=2800 Epoch=13.7] | Loss=0.12181 | Reg=0.00312 | acc=0.9219 | L2-Norm=17.663 | L2-Norm(final)=2.980 | 4873.6 samples/s | 76.2 steps/s
[Step=2850 Epoch=13.9] | Loss=0.11396 | Reg=0.00313 | acc=0.9375 | L2-Norm=17.685 | L2-Norm(final)=2.985 | 4969.9 samples/s | 77.7 steps/s
[Step=2900 Epoch=14.2] | Loss=0.10740 | Reg=0.00314 | acc=0.9531 | L2-Norm=17.707 | L2-Norm(final)=2.990 | 6208.4 samples/s | 97.0 steps/s
[Step=2950 Epoch=14.4] | Loss=0.09996 | Reg=0.00314 | acc=0.9375 | L2-Norm=17.727 | L2-Norm(final)=2.996 | 1919.5 samples/s | 30.0 steps/s
[Step=3000 Epoch=14.6] | Loss=0.09376 | Reg=0.00315 | acc=0.9531 | L2-Norm=17.745 | L2-Norm(final)=3.002 | 4780.5 samples/s | 74.7 steps/s
[Step=3050 Epoch=14.9] | Loss=0.08925 | Reg=0.00315 | acc=0.9531 | L2-Norm=17.762 | L2-Norm(final)=3.008 | 4780.3 samples/s | 74.7 steps/s
[Step=3100 Epoch=15.1] | Loss=0.08588 | Reg=0.00316 | acc=0.9375 | L2-Norm=17.777 | L2-Norm(final)=3.014 | 5820.0 samples/s | 90.9 steps/s
[Step=3150 Epoch=15.4] | Loss=0.08241 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.790 | L2-Norm(final)=3.018 | 1957.6 samples/s | 30.6 steps/s
[Step=3200 Epoch=15.6] | Loss=0.07918 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.804 | L2-Norm(final)=3.023 | 4912.0 samples/s | 76.8 steps/s
[Step=3250 Epoch=15.9] | Loss=0.07608 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.817 | L2-Norm(final)=3.028 | 4861.4 samples/s | 76.0 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07331 | Reg=0.00318 | acc=0.9375 | L2-Norm=17.829 | L2-Norm(final)=3.032 | 5547.7 samples/s | 86.7 steps/s
[Step=3350 Epoch=16.3] | Loss=0.07163 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.842 | L2-Norm(final)=3.036 | 1997.6 samples/s | 31.2 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06933 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.855 | L2-Norm(final)=3.040 | 4885.7 samples/s | 76.3 steps/s
[Step=3450 Epoch=16.8] | Loss=0.06674 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.868 | L2-Norm(final)=3.044 | 4937.4 samples/s | 77.1 steps/s
[Step=3500 Epoch=17.1] | Loss=0.06504 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.880 | L2-Norm(final)=3.048 | 5308.9 samples/s | 83.0 steps/s
[Step=3550 Epoch=17.3] | Loss=0.06302 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.891 | L2-Norm(final)=3.052 | 2003.3 samples/s | 31.3 steps/s
[Step=3600 Epoch=17.6] | Loss=0.06115 | Reg=0.00320 | acc=0.9531 | L2-Norm=17.901 | L2-Norm(final)=3.056 | 4950.8 samples/s | 77.4 steps/s
[Step=3650 Epoch=17.8] | Loss=0.05956 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.911 | L2-Norm(final)=3.059 | 4948.2 samples/s | 77.3 steps/s
[Step=3700 Epoch=18.1] | Loss=0.05786 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.920 | L2-Norm(final)=3.062 | 4967.1 samples/s | 77.6 steps/s
[Step=3750 Epoch=18.3] | Loss=0.05622 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.928 | L2-Norm(final)=3.066 | 2040.1 samples/s | 31.9 steps/s
[Step=3800 Epoch=18.5] | Loss=0.05476 | Reg=0.00322 | acc=0.9688 | L2-Norm=17.935 | L2-Norm(final)=3.069 | 4994.3 samples/s | 78.0 steps/s
[Step=3850 Epoch=18.8] | Loss=0.05362 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.942 | L2-Norm(final)=3.072 | 5003.3 samples/s | 78.2 steps/s
[Step=3900 Epoch=19.0] | Loss=0.05266 | Reg=0.00322 | acc=0.9688 | L2-Norm=17.948 | L2-Norm(final)=3.075 | 4909.1 samples/s | 76.7 steps/s
[Step=3950 Epoch=19.3] | Loss=0.05144 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.954 | L2-Norm(final)=3.078 | 2055.3 samples/s | 32.1 steps/s
[Step=4000 Epoch=19.5] | Loss=0.05041 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.959 | L2-Norm(final)=3.080 | 5052.0 samples/s | 78.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step4000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.39547 | Reg=0.00277 | acc=0.3594 | L2-Norm=16.632 | L2-Norm(final)=2.104 | 4275.5 samples/s | 66.8 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.32437 | Reg=0.00274 | acc=0.7812 | L2-Norm=16.556 | L2-Norm(final)=2.090 | 5003.8 samples/s | 78.2 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.30978 | Reg=0.00274 | acc=0.6406 | L2-Norm=16.554 | L2-Norm(final)=2.091 | 5901.7 samples/s | 92.2 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.29789 | Reg=0.00275 | acc=0.6562 | L2-Norm=16.572 | L2-Norm(final)=2.101 | 5966.8 samples/s | 93.2 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.28989 | Reg=0.00276 | acc=0.7344 | L2-Norm=16.602 | L2-Norm(final)=2.117 | 8583.8 samples/s | 134.1 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.28168 | Reg=0.00277 | acc=0.8281 | L2-Norm=16.636 | L2-Norm(final)=2.137 | 1944.2 samples/s | 30.4 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.27513 | Reg=0.00278 | acc=0.7188 | L2-Norm=16.674 | L2-Norm(final)=2.157 | 5927.1 samples/s | 92.6 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.27097 | Reg=0.00280 | acc=0.7656 | L2-Norm=16.718 | L2-Norm(final)=2.178 | 5931.3 samples/s | 92.7 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.26737 | Reg=0.00281 | acc=0.7500 | L2-Norm=16.762 | L2-Norm(final)=2.199 | 8121.0 samples/s | 126.9 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.26298 | Reg=0.00282 | acc=0.6719 | L2-Norm=16.804 | L2-Norm(final)=2.220 | 2017.0 samples/s | 31.5 steps/s
[Step= 500 Epoch= 2.5] | Loss=0.25900 | Reg=0.00284 | acc=0.7812 | L2-Norm=16.845 | L2-Norm(final)=2.243 | 5991.2 samples/s | 93.6 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.5] | Loss=0.20365 | Reg=0.00298 | acc=0.8125 | L2-Norm=17.269 | L2-Norm(final)=2.470 | 3749.7 samples/s | 58.6 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.20951 | Reg=0.00299 | acc=0.8750 | L2-Norm=17.291 | L2-Norm(final)=2.479 | 4948.5 samples/s | 77.3 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.18827 | Reg=0.00300 | acc=0.8750 | L2-Norm=17.318 | L2-Norm(final)=2.490 | 4939.2 samples/s | 77.2 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.17648 | Reg=0.00301 | acc=0.8750 | L2-Norm=17.339 | L2-Norm(final)=2.498 | 4956.1 samples/s | 77.4 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.16227 | Reg=0.00301 | acc=0.9219 | L2-Norm=17.354 | L2-Norm(final)=2.505 | 6746.1 samples/s | 105.4 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.14665 | Reg=0.00302 | acc=0.9531 | L2-Norm=17.375 | L2-Norm(final)=2.515 | 1861.7 samples/s | 29.1 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.13787 | Reg=0.00303 | acc=0.9219 | L2-Norm=17.400 | L2-Norm(final)=2.526 | 4894.1 samples/s | 76.5 steps/s
[Step= 850 Epoch= 4.2] | Loss=0.12915 | Reg=0.00304 | acc=0.9375 | L2-Norm=17.426 | L2-Norm(final)=2.536 | 4861.7 samples/s | 76.0 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.12313 | Reg=0.00305 | acc=0.9531 | L2-Norm=17.450 | L2-Norm(final)=2.546 | 6413.3 samples/s | 100.2 steps/s
[Step= 950 Epoch= 4.7] | Loss=0.11489 | Reg=0.00305 | acc=0.9531 | L2-Norm=17.474 | L2-Norm(final)=2.556 | 1872.5 samples/s | 29.3 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.10824 | Reg=0.00306 | acc=0.9531 | L2-Norm=17.497 | L2-Norm(final)=2.566 | 4919.9 samples/s | 76.9 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.10301 | Reg=0.00307 | acc=0.9531 | L2-Norm=17.520 | L2-Norm(final)=2.576 | 4919.3 samples/s | 76.9 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.09848 | Reg=0.00308 | acc=0.9375 | L2-Norm=17.541 | L2-Norm(final)=2.586 | 6145.1 samples/s | 96.0 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.09405 | Reg=0.00308 | acc=0.9531 | L2-Norm=17.562 | L2-Norm(final)=2.595 | 1911.8 samples/s | 29.9 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.08976 | Reg=0.00309 | acc=0.9688 | L2-Norm=17.582 | L2-Norm(final)=2.604 | 4965.5 samples/s | 77.6 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.08604 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.601 | L2-Norm(final)=2.613 | 4884.0 samples/s | 76.3 steps/s
[Step=1300 Epoch= 6.4] | Loss=0.08330 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.619 | L2-Norm(final)=2.621 | 5868.0 samples/s | 91.7 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.08020 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.637 | L2-Norm(final)=2.629 | 1947.5 samples/s | 30.4 steps/s
[Step=1400 Epoch= 6.9] | Loss=0.07802 | Reg=0.00312 | acc=0.9844 | L2-Norm=17.653 | L2-Norm(final)=2.636 | 4812.2 samples/s | 75.2 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.07545 | Reg=0.00312 | acc=0.9844 | L2-Norm=17.669 | L2-Norm(final)=2.642 | 4957.2 samples/s | 77.5 steps/s
[Step=1500 Epoch= 7.4] | Loss=0.07321 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.685 | L2-Norm(final)=2.649 | 5507.6 samples/s | 86.1 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.07091 | Reg=0.00313 | acc=0.9062 | L2-Norm=17.701 | L2-Norm(final)=2.656 | 1963.8 samples/s | 30.7 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.06888 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.716 | L2-Norm(final)=2.662 | 5010.1 samples/s | 78.3 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.06722 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.730 | L2-Norm(final)=2.668 | 4884.6 samples/s | 76.3 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.06552 | Reg=0.00315 | acc=0.9688 | L2-Norm=17.744 | L2-Norm(final)=2.673 | 5327.4 samples/s | 83.2 steps/s
[Step=1750 Epoch= 8.6] | Loss=0.06408 | Reg=0.00315 | acc=0.9688 | L2-Norm=17.758 | L2-Norm(final)=2.679 | 2013.4 samples/s | 31.5 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.06251 | Reg=0.00316 | acc=0.9844 | L2-Norm=17.772 | L2-Norm(final)=2.684 | 4985.8 samples/s | 77.9 steps/s
[Step=1850 Epoch= 9.1] | Loss=0.06110 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.785 | L2-Norm(final)=2.689 | 4878.9 samples/s | 76.2 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.05965 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.797 | L2-Norm(final)=2.694 | 5053.4 samples/s | 79.0 steps/s
[Step=1950 Epoch= 9.6] | Loss=0.05851 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.809 | L2-Norm(final)=2.698 | 1999.4 samples/s | 31.2 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.05719 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.820 | L2-Norm(final)=2.702 | 4964.8 samples/s | 77.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step2000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.18024 | Reg=0.00277 | acc=0.8438 | L2-Norm=16.632 | L2-Norm(final)=2.106 | 3858.0 samples/s | 60.3 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.12835 | Reg=0.00277 | acc=0.9531 | L2-Norm=16.640 | L2-Norm(final)=2.157 | 5166.2 samples/s | 80.7 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.10328 | Reg=0.00279 | acc=0.9219 | L2-Norm=16.714 | L2-Norm(final)=2.212 | 8344.4 samples/s | 130.4 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.08990 | Reg=0.00282 | acc=0.9844 | L2-Norm=16.802 | L2-Norm(final)=2.255 | 1914.3 samples/s | 29.9 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.08156 | Reg=0.00285 | acc=0.9688 | L2-Norm=16.879 | L2-Norm(final)=2.292 | 7109.5 samples/s | 111.1 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.07555 | Reg=0.00287 | acc=0.9688 | L2-Norm=16.953 | L2-Norm(final)=2.327 | 1958.5 samples/s | 30.6 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.06991 | Reg=0.00290 | acc=0.9688 | L2-Norm=17.024 | L2-Norm(final)=2.359 | 6760.7 samples/s | 105.6 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.06507 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.092 | L2-Norm(final)=2.391 | 2043.7 samples/s | 31.9 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.06101 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.157 | L2-Norm(final)=2.423 | 6181.0 samples/s | 96.6 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.05810 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.222 | L2-Norm(final)=2.454 | 2041.7 samples/s | 31.9 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.05544 | Reg=0.00299 | acc=0.9688 | L2-Norm=17.290 | L2-Norm(final)=2.484 | 5777.3 samples/s | 90.3 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 4.8] | Loss=0.00797 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.002 | L2-Norm(final)=2.779 | 3810.5 samples/s | 59.5 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.06633 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.044 | L2-Norm(final)=2.758 | 4540.1 samples/s | 70.9 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.03776 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.072 | L2-Norm(final)=2.766 | 6444.3 samples/s | 100.7 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.02571 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.084 | L2-Norm(final)=2.776 | 1809.6 samples/s | 28.3 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.01961 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.082 | L2-Norm(final)=2.783 | 5905.6 samples/s | 92.3 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01582 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.073 | L2-Norm(final)=2.789 | 1844.1 samples/s | 28.8 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01321 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.058 | L2-Norm(final)=2.794 | 5456.2 samples/s | 85.3 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.01135 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.038 | L2-Norm(final)=2.798 | 1903.3 samples/s | 29.7 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.00994 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.016 | L2-Norm(final)=2.802 | 5149.6 samples/s | 80.5 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.00885 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.991 | L2-Norm(final)=2.805 | 1937.1 samples/s | 30.3 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.00797 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.965 | L2-Norm(final)=2.807 | 4865.0 samples/s | 76.0 steps/s
[Step=1050 Epoch=10.0] | Loss=0.00725 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.938 | L2-Norm(final)=2.810 | 1987.1 samples/s | 31.0 steps/s
[Step=1100 Epoch=10.5] | Loss=0.00665 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.910 | L2-Norm(final)=2.812 | 4781.0 samples/s | 74.7 steps/s
[Step=1150 Epoch=10.9] | Loss=0.00615 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.881 | L2-Norm(final)=2.815 | 1989.7 samples/s | 31.1 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00571 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.852 | L2-Norm(final)=2.817 | 4744.9 samples/s | 74.1 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00533 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.822 | L2-Norm(final)=2.820 | 2004.6 samples/s | 31.3 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00500 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.792 | L2-Norm(final)=2.822 | 4651.4 samples/s | 72.7 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00471 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.762 | L2-Norm(final)=2.825 | 2044.2 samples/s | 31.9 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00445 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.731 | L2-Norm(final)=2.827 | 4588.6 samples/s | 71.7 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00422 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.700 | L2-Norm(final)=2.830 | 6543.7 samples/s | 102.2 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00401 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.669 | L2-Norm(final)=2.832 | 1789.0 samples/s | 28.0 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00382 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.638 | L2-Norm(final)=2.835 | 6102.6 samples/s | 95.4 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00365 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.606 | L2-Norm(final)=2.837 | 1854.4 samples/s | 29.0 steps/s
[Step=1650 Epoch=15.7] | Loss=0.00349 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.574 | L2-Norm(final)=2.840 | 5549.3 samples/s | 86.7 steps/s
[Step=1700 Epoch=16.2] | Loss=0.00334 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.543 | L2-Norm(final)=2.842 | 1883.4 samples/s | 29.4 steps/s
[Step=1750 Epoch=16.6] | Loss=0.00321 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.511 | L2-Norm(final)=2.845 | 5251.8 samples/s | 82.1 steps/s
[Step=1800 Epoch=17.1] | Loss=0.00309 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.478 | L2-Norm(final)=2.847 | 1940.0 samples/s | 30.3 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00298 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.446 | L2-Norm(final)=2.850 | 4809.9 samples/s | 75.2 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00287 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.414 | L2-Norm(final)=2.852 | 1961.9 samples/s | 30.7 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00277 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.382 | L2-Norm(final)=2.855 | 4822.2 samples/s | 75.3 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00268 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.349 | L2-Norm(final)=2.857 | 1979.4 samples/s | 30.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step2000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=2001 Epoch=18.9] | Loss=0.10367 | Reg=0.00277 | acc=0.9531 | L2-Norm=16.632 | L2-Norm(final)=3.123 | 3880.7 samples/s | 60.6 steps/s
[Step=2050 Epoch=19.3] | Loss=0.07767 | Reg=0.00286 | acc=0.9531 | L2-Norm=16.920 | L2-Norm(final)=3.173 | 5018.2 samples/s | 78.4 steps/s
[Step=2100 Epoch=19.8] | Loss=0.06267 | Reg=0.00294 | acc=0.9844 | L2-Norm=17.138 | L2-Norm(final)=3.214 | 7398.8 samples/s | 115.6 steps/s
[Step=2150 Epoch=20.3] | Loss=0.05459 | Reg=0.00299 | acc=0.9844 | L2-Norm=17.286 | L2-Norm(final)=3.247 | 1844.9 samples/s | 28.8 steps/s
[Step=2200 Epoch=20.7] | Loss=0.04793 | Reg=0.00303 | acc=0.9844 | L2-Norm=17.405 | L2-Norm(final)=3.279 | 6390.7 samples/s | 99.9 steps/s
[Step=2250 Epoch=21.2] | Loss=0.04546 | Reg=0.00307 | acc=0.9688 | L2-Norm=17.511 | L2-Norm(final)=3.307 | 1934.5 samples/s | 30.2 steps/s
[Step=2300 Epoch=21.7] | Loss=0.04167 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.604 | L2-Norm(final)=3.334 | 6019.7 samples/s | 94.1 steps/s
[Step=2350 Epoch=22.1] | Loss=0.03870 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.680 | L2-Norm(final)=3.362 | 1985.5 samples/s | 31.0 steps/s
[Step=2400 Epoch=22.6] | Loss=0.03591 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.748 | L2-Norm(final)=3.390 | 5423.5 samples/s | 84.7 steps/s
[Step=2450 Epoch=23.1] | Loss=0.03390 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.813 | L2-Norm(final)=3.419 | 2052.8 samples/s | 32.1 steps/s
[Step=2500 Epoch=23.6] | Loss=0.03195 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.873 | L2-Norm(final)=3.447 | 5373.4 samples/s | 84.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.6] | Loss=0.00385 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.433 | L2-Norm(final)=3.726 | 3871.9 samples/s | 60.5 steps/s
[Step=2550 Epoch=24.0] | Loss=0.11313 | Reg=0.00344 | acc=0.9844 | L2-Norm=18.551 | L2-Norm(final)=3.648 | 4456.2 samples/s | 69.6 steps/s
[Step=2600 Epoch=24.5] | Loss=0.06097 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.638 | L2-Norm(final)=3.655 | 6157.8 samples/s | 96.2 steps/s
[Step=2650 Epoch=25.0] | Loss=0.04190 | Reg=0.00348 | acc=1.0000 | L2-Norm=18.667 | L2-Norm(final)=3.664 | 1801.0 samples/s | 28.1 steps/s
[Step=2700 Epoch=25.4] | Loss=0.03162 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.673 | L2-Norm(final)=3.671 | 5763.1 samples/s | 90.0 steps/s
[Step=2750 Epoch=25.9] | Loss=0.02535 | Reg=0.00348 | acc=1.0000 | L2-Norm=18.665 | L2-Norm(final)=3.677 | 1860.4 samples/s | 29.1 steps/s
[Step=2800 Epoch=26.4] | Loss=0.02116 | Reg=0.00348 | acc=1.0000 | L2-Norm=18.650 | L2-Norm(final)=3.682 | 5325.2 samples/s | 83.2 steps/s
[Step=2850 Epoch=26.9] | Loss=0.01815 | Reg=0.00347 | acc=1.0000 | L2-Norm=18.630 | L2-Norm(final)=3.686 | 1934.2 samples/s | 30.2 steps/s
[Step=2900 Epoch=27.3] | Loss=0.01590 | Reg=0.00346 | acc=1.0000 | L2-Norm=18.607 | L2-Norm(final)=3.689 | 4836.4 samples/s | 75.6 steps/s
[Step=2950 Epoch=27.8] | Loss=0.01414 | Reg=0.00345 | acc=1.0000 | L2-Norm=18.581 | L2-Norm(final)=3.692 | 1978.3 samples/s | 30.9 steps/s
[Step=3000 Epoch=28.3] | Loss=0.01274 | Reg=0.00344 | acc=1.0000 | L2-Norm=18.555 | L2-Norm(final)=3.694 | 4607.5 samples/s | 72.0 steps/s
[Step=3050 Epoch=28.7] | Loss=0.01158 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.527 | L2-Norm(final)=3.696 | 1977.7 samples/s | 30.9 steps/s
[Step=3100 Epoch=29.2] | Loss=0.01062 | Reg=0.00342 | acc=1.0000 | L2-Norm=18.499 | L2-Norm(final)=3.698 | 4754.8 samples/s | 74.3 steps/s
[Step=3150 Epoch=29.7] | Loss=0.00981 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.470 | L2-Norm(final)=3.701 | 2027.0 samples/s | 31.7 steps/s
[Step=3200 Epoch=30.2] | Loss=0.00911 | Reg=0.00340 | acc=1.0000 | L2-Norm=18.441 | L2-Norm(final)=3.703 | 4737.6 samples/s | 74.0 steps/s
[Step=3250 Epoch=30.6] | Loss=0.00851 | Reg=0.00339 | acc=1.0000 | L2-Norm=18.412 | L2-Norm(final)=3.705 | 2041.5 samples/s | 31.9 steps/s
[Step=3300 Epoch=31.1] | Loss=0.00798 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.383 | L2-Norm(final)=3.707 | 4496.5 samples/s | 70.3 steps/s
[Step=3350 Epoch=31.6] | Loss=0.00751 | Reg=0.00337 | acc=1.0000 | L2-Norm=18.353 | L2-Norm(final)=3.710 | 6421.4 samples/s | 100.3 steps/s
[Step=3400 Epoch=32.0] | Loss=0.00710 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.324 | L2-Norm(final)=3.712 | 1808.0 samples/s | 28.3 steps/s
[Step=3450 Epoch=32.5] | Loss=0.00673 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.294 | L2-Norm(final)=3.715 | 5654.3 samples/s | 88.3 steps/s
[Step=3500 Epoch=33.0] | Loss=0.00639 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.264 | L2-Norm(final)=3.718 | 1836.7 samples/s | 28.7 steps/s
[Step=3550 Epoch=33.5] | Loss=0.00609 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.235 | L2-Norm(final)=3.721 | 5299.5 samples/s | 82.8 steps/s
[Step=3600 Epoch=33.9] | Loss=0.00581 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.205 | L2-Norm(final)=3.724 | 1918.8 samples/s | 30.0 steps/s
[Step=3650 Epoch=34.4] | Loss=0.00556 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.176 | L2-Norm(final)=3.727 | 4893.5 samples/s | 76.5 steps/s
[Step=3700 Epoch=34.9] | Loss=0.00533 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.146 | L2-Norm(final)=3.730 | 1967.4 samples/s | 30.7 steps/s
[Step=3750 Epoch=35.3] | Loss=0.00512 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.116 | L2-Norm(final)=3.733 | 4690.9 samples/s | 73.3 steps/s
[Step=3800 Epoch=35.8] | Loss=0.00492 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.087 | L2-Norm(final)=3.736 | 1981.1 samples/s | 31.0 steps/s
[Step=3850 Epoch=36.3] | Loss=0.00474 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.057 | L2-Norm(final)=3.740 | 4864.8 samples/s | 76.0 steps/s
[Step=3900 Epoch=36.7] | Loss=0.00457 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.028 | L2-Norm(final)=3.743 | 1984.6 samples/s | 31.0 steps/s
[Step=3950 Epoch=37.2] | Loss=0.00442 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.998 | L2-Norm(final)=3.746 | 4664.4 samples/s | 72.9 steps/s
[Step=4000 Epoch=37.7] | Loss=0.00427 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.969 | L2-Norm(final)=3.750 | 2046.7 samples/s | 32.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.13509 | acc=0.9234 | tpr=0.9346 | fpr=0.1011 | 4360.3 samples/s | 17.0 steps/s
Avg test loss: 0.14152, Avg test acc: 0.92067, Avg tpr: 0.93379, Avg fpr: 0.10819, total FA: 844

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.15187 | acc=0.9181 | tpr=0.9221 | fpr=0.0904 | 4332.9 samples/s | 16.9 steps/s
Avg test loss: 0.15467, Avg test acc: 0.91682, Avg tpr: 0.91957, Avg fpr: 0.08922, total FA: 696

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.32229 | acc=0.6802 | tpr=0.9925 | fpr=0.9980 | 4466.2 samples/s | 17.4 steps/s
Avg test loss: 0.32090, Avg test acc: 0.68343, Avg tpr: 0.99318, Avg fpr: 0.99782, total FA: 7784

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.32229 | acc=0.6802 | tpr=0.9925 | fpr=0.9980 | 4351.0 samples/s | 17.0 steps/s
Avg test loss: 0.32090, Avg test acc: 0.68343, Avg tpr: 0.99318, Avg fpr: 0.99782, total FA: 7784

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.16218 | acc=0.9246 | tpr=0.9404 | fpr=0.1098 | 4423.0 samples/s | 17.3 steps/s
Avg test loss: 0.16532, Avg test acc: 0.92275, Avg tpr: 0.93833, Avg fpr: 0.11152, total FA: 870

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=3.87613 | acc=0.3195 | tpr=0.0175 | fpr=0.0245 | 4360.0 samples/s | 17.0 steps/s
Avg test loss: 3.87277, Avg test acc: 0.31781, Avg tpr: 0.01818, Avg fpr: 0.02320, total FA: 181

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.10863 | acc=0.3143 | tpr=0.0056 | fpr=0.0154 | 4421.7 samples/s | 17.3 steps/s
Avg test loss: 4.10629, Avg test acc: 0.31148, Avg tpr: 0.00583, Avg fpr: 0.01628, total FA: 127

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=3.57548 | acc=0.3184 | tpr=0.0139 | fpr=0.0203 | 4369.0 samples/s | 17.1 steps/s
Avg test loss: 3.57365, Avg test acc: 0.31633, Avg tpr: 0.01463, Avg fpr: 0.02013, total FA: 157

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=3.87061 | acc=0.3154 | tpr=0.0029 | fpr=0.0059 | 4354.0 samples/s | 17.0 steps/s
Avg test loss: 3.89015, Avg test acc: 0.31200, Avg tpr: 0.00245, Avg fpr: 0.00718, total FA: 56

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=3.83227 | acc=0.3166 | tpr=0.0116 | fpr=0.0211 | 4368.8 samples/s | 17.1 steps/s
Avg test loss: 3.82612, Avg test acc: 0.31509, Avg tpr: 0.01241, Avg fpr: 0.01923, total FA: 150

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.19522 | acc=0.1469 | tpr=0.7743 | fpr=0.8644 | 4332.4 samples/s | 16.9 steps/s
[Step= 100] | Loss=3.17849 | acc=0.1477 | tpr=0.7441 | fpr=0.8634 | 8677.9 samples/s | 33.9 steps/s
[Step= 150] | Loss=3.17991 | acc=0.1482 | tpr=0.7378 | fpr=0.8626 | 8596.5 samples/s | 33.6 steps/s
[Step= 200] | Loss=3.17803 | acc=0.1484 | tpr=0.7421 | fpr=0.8624 | 8531.1 samples/s | 33.3 steps/s
[Step= 250] | Loss=3.17907 | acc=0.1486 | tpr=0.7354 | fpr=0.8621 | 8849.1 samples/s | 34.6 steps/s
[Step= 300] | Loss=3.17981 | acc=0.1492 | tpr=0.7396 | fpr=0.8616 | 8420.1 samples/s | 32.9 steps/s
[Step= 350] | Loss=3.17064 | acc=0.1498 | tpr=0.7495 | fpr=0.8611 | 8576.4 samples/s | 33.5 steps/s
[Step= 400] | Loss=3.17007 | acc=0.1496 | tpr=0.7516 | fpr=0.8614 | 8797.0 samples/s | 34.4 steps/s
[Step= 450] | Loss=3.16804 | acc=0.1496 | tpr=0.7541 | fpr=0.8613 | 8616.8 samples/s | 33.7 steps/s
[Step= 500] | Loss=3.16960 | acc=0.1494 | tpr=0.7573 | fpr=0.8616 | 8146.3 samples/s | 31.8 steps/s
[Step= 550] | Loss=3.16795 | acc=0.1495 | tpr=0.7577 | fpr=0.8615 | 15586.3 samples/s | 60.9 steps/s
Avg test loss: 3.16876, Avg test acc: 0.14934, Avg tpr: 0.75713, Avg fpr: 0.86170, total FA: 119646

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.07981 | acc=0.1602 | tpr=0.6814 | fpr=0.8491 | 4393.2 samples/s | 17.2 steps/s
[Step= 100] | Loss=3.05535 | acc=0.1604 | tpr=0.6183 | fpr=0.8482 | 8644.7 samples/s | 33.8 steps/s
[Step= 150] | Loss=3.06122 | acc=0.1590 | tpr=0.6268 | fpr=0.8497 | 8404.6 samples/s | 32.8 steps/s
[Step= 200] | Loss=3.06001 | acc=0.1593 | tpr=0.6230 | fpr=0.8491 | 8693.6 samples/s | 34.0 steps/s
[Step= 250] | Loss=3.06186 | acc=0.1601 | tpr=0.6288 | fpr=0.8484 | 8545.4 samples/s | 33.4 steps/s
[Step= 300] | Loss=3.06471 | acc=0.1595 | tpr=0.6378 | fpr=0.8493 | 9021.1 samples/s | 35.2 steps/s
[Step= 350] | Loss=3.05924 | acc=0.1598 | tpr=0.6312 | fpr=0.8488 | 8239.8 samples/s | 32.2 steps/s
[Step= 400] | Loss=3.05754 | acc=0.1596 | tpr=0.6220 | fpr=0.8488 | 8566.3 samples/s | 33.5 steps/s
[Step= 450] | Loss=3.05994 | acc=0.1600 | tpr=0.6237 | fpr=0.8485 | 8501.4 samples/s | 33.2 steps/s
[Step= 500] | Loss=3.06254 | acc=0.1595 | tpr=0.6220 | fpr=0.8488 | 9049.7 samples/s | 35.4 steps/s
[Step= 550] | Loss=3.06225 | acc=0.1595 | tpr=0.6279 | fpr=0.8490 | 14609.2 samples/s | 57.1 steps/s
Avg test loss: 3.06339, Avg test acc: 0.15937, Avg tpr: 0.62758, Avg fpr: 0.84914, total FA: 117902

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=0.49347 | acc=0.0224 | tpr=1.0000 | fpr=0.9951 | 4356.9 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.49431 | acc=0.0224 | tpr=1.0000 | fpr=0.9958 | 8948.7 samples/s | 35.0 steps/s
[Step= 150] | Loss=0.49466 | acc=0.0221 | tpr=1.0000 | fpr=0.9959 | 8329.4 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.49447 | acc=0.0218 | tpr=1.0000 | fpr=0.9960 | 8658.9 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.49484 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8502.9 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.49501 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8716.4 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.49495 | acc=0.0215 | tpr=1.0000 | fpr=0.9962 | 8891.0 samples/s | 34.7 steps/s
[Step= 400] | Loss=0.49496 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8374.7 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.49497 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 8574.5 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.49508 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 8392.9 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.49497 | acc=0.0215 | tpr=1.0000 | fpr=0.9963 | 15839.0 samples/s | 61.9 steps/s
Avg test loss: 0.49495, Avg test acc: 0.02145, Avg tpr: 1.00000, Avg fpr: 0.99633, total FA: 138339

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=0.49347 | acc=0.0224 | tpr=1.0000 | fpr=0.9951 | 4389.8 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.49431 | acc=0.0224 | tpr=1.0000 | fpr=0.9958 | 8562.3 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.49466 | acc=0.0221 | tpr=1.0000 | fpr=0.9959 | 8597.7 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.49447 | acc=0.0218 | tpr=1.0000 | fpr=0.9960 | 8495.8 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.49484 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8432.0 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.49501 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8813.6 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.49495 | acc=0.0215 | tpr=1.0000 | fpr=0.9962 | 8657.7 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.49496 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8770.8 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.49497 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 8445.1 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.49508 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 8691.1 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.49497 | acc=0.0215 | tpr=1.0000 | fpr=0.9963 | 15454.8 samples/s | 60.4 steps/s
Avg test loss: 0.49495, Avg test acc: 0.02145, Avg tpr: 1.00000, Avg fpr: 0.99633, total FA: 138339

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.11563 | acc=0.1366 | tpr=0.7965 | fpr=0.8753 | 4401.6 samples/s | 17.2 steps/s
[Step= 100] | Loss=4.10578 | acc=0.1363 | tpr=0.7249 | fpr=0.8747 | 8501.5 samples/s | 33.2 steps/s
[Step= 150] | Loss=4.11244 | acc=0.1359 | tpr=0.7248 | fpr=0.8749 | 8489.0 samples/s | 33.2 steps/s
[Step= 200] | Loss=4.11806 | acc=0.1364 | tpr=0.7202 | fpr=0.8743 | 8678.6 samples/s | 33.9 steps/s
[Step= 250] | Loss=4.12849 | acc=0.1354 | tpr=0.7284 | fpr=0.8754 | 8502.1 samples/s | 33.2 steps/s
[Step= 300] | Loss=4.13239 | acc=0.1352 | tpr=0.7309 | fpr=0.8757 | 8377.6 samples/s | 32.7 steps/s
[Step= 350] | Loss=4.12689 | acc=0.1355 | tpr=0.7282 | fpr=0.8752 | 8559.1 samples/s | 33.4 steps/s
[Step= 400] | Loss=4.12740 | acc=0.1356 | tpr=0.7281 | fpr=0.8752 | 8719.9 samples/s | 34.1 steps/s
[Step= 450] | Loss=4.12583 | acc=0.1357 | tpr=0.7308 | fpr=0.8751 | 8424.3 samples/s | 32.9 steps/s
[Step= 500] | Loss=4.12537 | acc=0.1356 | tpr=0.7282 | fpr=0.8751 | 8567.5 samples/s | 33.5 steps/s
[Step= 550] | Loss=4.12766 | acc=0.1354 | tpr=0.7274 | fpr=0.8754 | 15401.8 samples/s | 60.2 steps/s
Avg test loss: 4.12812, Avg test acc: 0.13537, Avg tpr: 0.72781, Avg fpr: 0.87540, total FA: 121547

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.05105 | acc=0.9795 | tpr=0.8053 | fpr=0.0173 | 4365.6 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.04880 | acc=0.9795 | tpr=0.8124 | fpr=0.0173 | 8744.7 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.04998 | acc=0.9793 | tpr=0.8112 | fpr=0.0176 | 8410.9 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.05094 | acc=0.9792 | tpr=0.8219 | fpr=0.0179 | 8762.3 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.05087 | acc=0.9793 | tpr=0.8183 | fpr=0.0178 | 8644.6 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.05156 | acc=0.9790 | tpr=0.8145 | fpr=0.0180 | 8212.0 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.05108 | acc=0.9791 | tpr=0.8178 | fpr=0.0180 | 8813.3 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.05154 | acc=0.9789 | tpr=0.8129 | fpr=0.0181 | 8504.7 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.05234 | acc=0.9787 | tpr=0.8116 | fpr=0.0183 | 8406.8 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.05192 | acc=0.9789 | tpr=0.8145 | fpr=0.0182 | 8556.9 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.05123 | acc=0.9790 | tpr=0.8158 | fpr=0.0181 | 9892.4 samples/s | 38.6 steps/s
Avg test loss: 0.05119, Avg test acc: 0.97894, Avg tpr: 0.81498, Avg fpr: 0.01808, total FA: 2510

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.05995 | acc=0.9817 | tpr=0.8097 | fpr=0.0152 | 4382.4 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.05793 | acc=0.9807 | tpr=0.8081 | fpr=0.0160 | 8555.0 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.05799 | acc=0.9803 | tpr=0.8098 | fpr=0.0165 | 8543.5 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.05981 | acc=0.9799 | tpr=0.8197 | fpr=0.0171 | 9240.1 samples/s | 36.1 steps/s
[Step= 250] | Loss=0.05909 | acc=0.9803 | tpr=0.8218 | fpr=0.0168 | 8322.3 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.06003 | acc=0.9800 | tpr=0.8218 | fpr=0.0171 | 8603.9 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.06022 | acc=0.9799 | tpr=0.8247 | fpr=0.0173 | 8490.3 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.06107 | acc=0.9798 | tpr=0.8184 | fpr=0.0173 | 8487.8 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.06193 | acc=0.9795 | tpr=0.8155 | fpr=0.0175 | 8875.9 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.06156 | acc=0.9797 | tpr=0.8203 | fpr=0.0174 | 6957.8 samples/s | 27.2 steps/s
[Step= 550] | Loss=0.06084 | acc=0.9799 | tpr=0.8201 | fpr=0.0172 | 10008.9 samples/s | 39.1 steps/s
Avg test loss: 0.06082, Avg test acc: 0.97984, Avg tpr: 0.82013, Avg fpr: 0.01726, total FA: 2396

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.04549 | acc=0.9822 | tpr=0.7965 | fpr=0.0145 | 4369.9 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.04626 | acc=0.9811 | tpr=0.7996 | fpr=0.0155 | 9008.4 samples/s | 35.2 steps/s
[Step= 150] | Loss=0.04700 | acc=0.9805 | tpr=0.8026 | fpr=0.0162 | 8528.0 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.04802 | acc=0.9804 | tpr=0.8131 | fpr=0.0165 | 8448.6 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.04846 | acc=0.9799 | tpr=0.8157 | fpr=0.0171 | 8302.9 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.04918 | acc=0.9798 | tpr=0.8095 | fpr=0.0171 | 8813.4 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.04876 | acc=0.9798 | tpr=0.8121 | fpr=0.0172 | 8581.7 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.04917 | acc=0.9796 | tpr=0.8124 | fpr=0.0174 | 8471.7 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.04989 | acc=0.9795 | tpr=0.8165 | fpr=0.0176 | 8549.5 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.04951 | acc=0.9796 | tpr=0.8198 | fpr=0.0175 | 5988.6 samples/s | 23.4 steps/s
[Step= 550] | Loss=0.04909 | acc=0.9796 | tpr=0.8185 | fpr=0.0174 | 15094.2 samples/s | 59.0 steps/s
Avg test loss: 0.04909, Avg test acc: 0.97964, Avg tpr: 0.81815, Avg fpr: 0.01743, total FA: 2420

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.06523 | acc=0.9823 | tpr=0.8451 | fpr=0.0153 | 4441.7 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.06659 | acc=0.9823 | tpr=0.8699 | fpr=0.0156 | 8814.3 samples/s | 34.4 steps/s
[Step= 150] | Loss=0.06746 | acc=0.9816 | tpr=0.8775 | fpr=0.0164 | 8667.0 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.06773 | acc=0.9816 | tpr=0.8798 | fpr=0.0166 | 8165.5 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.06656 | acc=0.9818 | tpr=0.8760 | fpr=0.0163 | 8452.3 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.06784 | acc=0.9814 | tpr=0.8698 | fpr=0.0166 | 8978.5 samples/s | 35.1 steps/s
[Step= 350] | Loss=0.06780 | acc=0.9813 | tpr=0.8710 | fpr=0.0167 | 8634.8 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.06843 | acc=0.9811 | tpr=0.8660 | fpr=0.0168 | 8490.1 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.06975 | acc=0.9808 | tpr=0.8642 | fpr=0.0171 | 9285.2 samples/s | 36.3 steps/s
[Step= 500] | Loss=0.06955 | acc=0.9809 | tpr=0.8665 | fpr=0.0171 | 5935.0 samples/s | 23.2 steps/s
[Step= 550] | Loss=0.06873 | acc=0.9811 | tpr=0.8679 | fpr=0.0169 | 15810.8 samples/s | 61.8 steps/s
Avg test loss: 0.06851, Avg test acc: 0.98109, Avg tpr: 0.86767, Avg fpr: 0.01685, total FA: 2340

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.06004 | acc=0.9784 | tpr=0.8009 | fpr=0.0185 | 4350.1 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.05947 | acc=0.9780 | tpr=0.8124 | fpr=0.0189 | 8556.2 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.06023 | acc=0.9770 | tpr=0.8141 | fpr=0.0200 | 9186.7 samples/s | 35.9 steps/s
[Step= 200] | Loss=0.06128 | acc=0.9771 | tpr=0.8197 | fpr=0.0200 | 8048.9 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.06088 | acc=0.9772 | tpr=0.8131 | fpr=0.0198 | 9112.1 samples/s | 35.6 steps/s
[Step= 300] | Loss=0.06211 | acc=0.9769 | tpr=0.8080 | fpr=0.0200 | 8065.5 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.06231 | acc=0.9768 | tpr=0.8109 | fpr=0.0202 | 8700.5 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.06297 | acc=0.9765 | tpr=0.8025 | fpr=0.0204 | 8419.8 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.06410 | acc=0.9763 | tpr=0.8033 | fpr=0.0206 | 8169.5 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.06354 | acc=0.9764 | tpr=0.8048 | fpr=0.0205 | 6838.9 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.06294 | acc=0.9766 | tpr=0.8062 | fpr=0.0203 | 15213.9 samples/s | 59.4 steps/s
Avg test loss: 0.06281, Avg test acc: 0.97657, Avg tpr: 0.80547, Avg fpr: 0.02032, total FA: 2822

server round 2/50

clients selected: [0 1 2 6 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=2001 Epoch= 9.8] | Loss=0.29264 | Reg=0.00246 | acc=0.6562 | L2-Norm=15.692 | L2-Norm(final)=2.860 | 3960.8 samples/s | 61.9 steps/s
[Step=2050 Epoch=10.0] | Loss=0.23775 | Reg=0.00256 | acc=0.7969 | L2-Norm=15.993 | L2-Norm(final)=2.877 | 5188.8 samples/s | 81.1 steps/s
[Step=2100 Epoch=10.2] | Loss=0.21574 | Reg=0.00262 | acc=0.8125 | L2-Norm=16.185 | L2-Norm(final)=2.905 | 5557.7 samples/s | 86.8 steps/s
[Step=2150 Epoch=10.5] | Loss=0.20426 | Reg=0.00266 | acc=0.7656 | L2-Norm=16.305 | L2-Norm(final)=2.933 | 5564.7 samples/s | 86.9 steps/s
[Step=2200 Epoch=10.7] | Loss=0.19593 | Reg=0.00269 | acc=0.8906 | L2-Norm=16.397 | L2-Norm(final)=2.957 | 7692.9 samples/s | 120.2 steps/s
[Step=2250 Epoch=11.0] | Loss=0.19253 | Reg=0.00271 | acc=0.8438 | L2-Norm=16.473 | L2-Norm(final)=2.982 | 1914.4 samples/s | 29.9 steps/s
[Step=2300 Epoch=11.2] | Loss=0.18759 | Reg=0.00274 | acc=0.8438 | L2-Norm=16.545 | L2-Norm(final)=3.005 | 5615.0 samples/s | 87.7 steps/s
[Step=2350 Epoch=11.5] | Loss=0.18293 | Reg=0.00276 | acc=0.9062 | L2-Norm=16.612 | L2-Norm(final)=3.028 | 5534.3 samples/s | 86.5 steps/s
[Step=2400 Epoch=11.7] | Loss=0.17820 | Reg=0.00278 | acc=0.8594 | L2-Norm=16.672 | L2-Norm(final)=3.053 | 6973.8 samples/s | 109.0 steps/s
[Step=2450 Epoch=11.9] | Loss=0.17473 | Reg=0.00280 | acc=0.8750 | L2-Norm=16.728 | L2-Norm(final)=3.079 | 1981.7 samples/s | 31.0 steps/s
[Step=2500 Epoch=12.2] | Loss=0.17234 | Reg=0.00282 | acc=0.8750 | L2-Norm=16.786 | L2-Norm(final)=3.106 | 5552.8 samples/s | 86.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.2] | Loss=0.15566 | Reg=0.00301 | acc=0.8438 | L2-Norm=17.352 | L2-Norm(final)=3.368 | 3990.3 samples/s | 62.3 steps/s
[Step=2550 Epoch=12.4] | Loss=0.16990 | Reg=0.00303 | acc=0.9062 | L2-Norm=17.397 | L2-Norm(final)=3.363 | 4620.1 samples/s | 72.2 steps/s
[Step=2600 Epoch=12.7] | Loss=0.14612 | Reg=0.00304 | acc=0.8750 | L2-Norm=17.435 | L2-Norm(final)=3.362 | 4941.1 samples/s | 77.2 steps/s
[Step=2650 Epoch=12.9] | Loss=0.13159 | Reg=0.00305 | acc=0.9219 | L2-Norm=17.468 | L2-Norm(final)=3.364 | 4845.6 samples/s | 75.7 steps/s
[Step=2700 Epoch=13.2] | Loss=0.12247 | Reg=0.00306 | acc=0.9062 | L2-Norm=17.495 | L2-Norm(final)=3.369 | 6522.9 samples/s | 101.9 steps/s
[Step=2750 Epoch=13.4] | Loss=0.10926 | Reg=0.00307 | acc=0.9375 | L2-Norm=17.519 | L2-Norm(final)=3.374 | 1726.0 samples/s | 27.0 steps/s
[Step=2800 Epoch=13.7] | Loss=0.10071 | Reg=0.00308 | acc=0.9531 | L2-Norm=17.539 | L2-Norm(final)=3.379 | 4515.9 samples/s | 70.6 steps/s
[Step=2850 Epoch=13.9] | Loss=0.09580 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.560 | L2-Norm(final)=3.384 | 4954.5 samples/s | 77.4 steps/s
[Step=2900 Epoch=14.1] | Loss=0.09073 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.580 | L2-Norm(final)=3.388 | 5999.9 samples/s | 93.7 steps/s
[Step=2950 Epoch=14.4] | Loss=0.08561 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.601 | L2-Norm(final)=3.392 | 1842.7 samples/s | 28.8 steps/s
[Step=3000 Epoch=14.6] | Loss=0.08077 | Reg=0.00311 | acc=0.9688 | L2-Norm=17.621 | L2-Norm(final)=3.397 | 4968.5 samples/s | 77.6 steps/s
[Step=3050 Epoch=14.9] | Loss=0.07718 | Reg=0.00311 | acc=0.9531 | L2-Norm=17.642 | L2-Norm(final)=3.402 | 4903.9 samples/s | 76.6 steps/s
[Step=3100 Epoch=15.1] | Loss=0.07357 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.661 | L2-Norm(final)=3.407 | 5760.2 samples/s | 90.0 steps/s
[Step=3150 Epoch=15.4] | Loss=0.07095 | Reg=0.00313 | acc=0.9375 | L2-Norm=17.678 | L2-Norm(final)=3.412 | 1955.7 samples/s | 30.6 steps/s
[Step=3200 Epoch=15.6] | Loss=0.06856 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.696 | L2-Norm(final)=3.416 | 4952.3 samples/s | 77.4 steps/s
[Step=3250 Epoch=15.8] | Loss=0.06583 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.712 | L2-Norm(final)=3.420 | 4885.4 samples/s | 76.3 steps/s
[Step=3300 Epoch=16.1] | Loss=0.06360 | Reg=0.00314 | acc=0.9688 | L2-Norm=17.727 | L2-Norm(final)=3.425 | 5389.4 samples/s | 84.2 steps/s
[Step=3350 Epoch=16.3] | Loss=0.06147 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.743 | L2-Norm(final)=3.429 | 2001.3 samples/s | 31.3 steps/s
[Step=3400 Epoch=16.6] | Loss=0.05937 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.757 | L2-Norm(final)=3.433 | 4949.8 samples/s | 77.3 steps/s
[Step=3450 Epoch=16.8] | Loss=0.05798 | Reg=0.00316 | acc=0.9531 | L2-Norm=17.771 | L2-Norm(final)=3.436 | 4926.6 samples/s | 77.0 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05661 | Reg=0.00316 | acc=0.9688 | L2-Norm=17.785 | L2-Norm(final)=3.439 | 5079.5 samples/s | 79.4 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05512 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.799 | L2-Norm(final)=3.442 | 2038.6 samples/s | 31.9 steps/s
[Step=3600 Epoch=17.6] | Loss=0.05342 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.814 | L2-Norm(final)=3.446 | 5000.1 samples/s | 78.1 steps/s
[Step=3650 Epoch=17.8] | Loss=0.05210 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.827 | L2-Norm(final)=3.450 | 4893.1 samples/s | 76.5 steps/s
[Step=3700 Epoch=18.0] | Loss=0.05114 | Reg=0.00318 | acc=0.9375 | L2-Norm=17.839 | L2-Norm(final)=3.453 | 4951.4 samples/s | 77.4 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04989 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.850 | L2-Norm(final)=3.455 | 2060.3 samples/s | 32.2 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04862 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.861 | L2-Norm(final)=3.458 | 4937.2 samples/s | 77.1 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04750 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.871 | L2-Norm(final)=3.460 | 4899.1 samples/s | 76.5 steps/s
[Step=3900 Epoch=19.0] | Loss=0.04652 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.880 | L2-Norm(final)=3.463 | 4919.2 samples/s | 76.9 steps/s
[Step=3950 Epoch=19.3] | Loss=0.04571 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.889 | L2-Norm(final)=3.465 | 2059.1 samples/s | 32.2 steps/s
[Step=4000 Epoch=19.5] | Loss=0.04473 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.898 | L2-Norm(final)=3.467 | 5020.7 samples/s | 78.4 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step4000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.25685 | Reg=0.00246 | acc=0.7031 | L2-Norm=15.692 | L2-Norm(final)=3.152 | 4013.0 samples/s | 62.7 steps/s
[Step=4050 Epoch=19.8] | Loss=0.21547 | Reg=0.00258 | acc=0.8594 | L2-Norm=16.045 | L2-Norm(final)=3.180 | 5483.3 samples/s | 85.7 steps/s
[Step=4100 Epoch=20.0] | Loss=0.19807 | Reg=0.00265 | acc=0.7656 | L2-Norm=16.268 | L2-Norm(final)=3.197 | 5473.1 samples/s | 85.5 steps/s
[Step=4150 Epoch=20.3] | Loss=0.18549 | Reg=0.00269 | acc=0.9375 | L2-Norm=16.402 | L2-Norm(final)=3.218 | 5497.0 samples/s | 85.9 steps/s
[Step=4200 Epoch=20.5] | Loss=0.18216 | Reg=0.00272 | acc=0.8125 | L2-Norm=16.499 | L2-Norm(final)=3.237 | 7841.4 samples/s | 122.5 steps/s
[Step=4250 Epoch=20.7] | Loss=0.17844 | Reg=0.00275 | acc=0.8594 | L2-Norm=16.587 | L2-Norm(final)=3.254 | 1903.4 samples/s | 29.7 steps/s
[Step=4300 Epoch=21.0] | Loss=0.17374 | Reg=0.00278 | acc=0.8438 | L2-Norm=16.673 | L2-Norm(final)=3.271 | 5556.7 samples/s | 86.8 steps/s
[Step=4350 Epoch=21.2] | Loss=0.17115 | Reg=0.00281 | acc=0.8281 | L2-Norm=16.752 | L2-Norm(final)=3.288 | 5543.3 samples/s | 86.6 steps/s
[Step=4400 Epoch=21.5] | Loss=0.16908 | Reg=0.00283 | acc=0.9062 | L2-Norm=16.824 | L2-Norm(final)=3.305 | 7327.3 samples/s | 114.5 steps/s
[Step=4450 Epoch=21.7] | Loss=0.16606 | Reg=0.00286 | acc=0.8750 | L2-Norm=16.892 | L2-Norm(final)=3.323 | 1988.8 samples/s | 31.1 steps/s
[Step=4500 Epoch=22.0] | Loss=0.16315 | Reg=0.00288 | acc=0.8906 | L2-Norm=16.958 | L2-Norm(final)=3.342 | 5533.7 samples/s | 86.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=22.0] | Loss=0.12143 | Reg=0.00310 | acc=0.8906 | L2-Norm=17.601 | L2-Norm(final)=3.540 | 3983.3 samples/s | 62.2 steps/s
[Step=4550 Epoch=22.2] | Loss=0.16532 | Reg=0.00311 | acc=0.8750 | L2-Norm=17.645 | L2-Norm(final)=3.539 | 4689.0 samples/s | 73.3 steps/s
[Step=4600 Epoch=22.4] | Loss=0.14967 | Reg=0.00313 | acc=0.8750 | L2-Norm=17.687 | L2-Norm(final)=3.533 | 4946.7 samples/s | 77.3 steps/s
[Step=4650 Epoch=22.7] | Loss=0.13451 | Reg=0.00314 | acc=0.9219 | L2-Norm=17.718 | L2-Norm(final)=3.531 | 4999.3 samples/s | 78.1 steps/s
[Step=4700 Epoch=22.9] | Loss=0.12499 | Reg=0.00315 | acc=0.9531 | L2-Norm=17.743 | L2-Norm(final)=3.532 | 6518.9 samples/s | 101.9 steps/s
[Step=4750 Epoch=23.2] | Loss=0.11285 | Reg=0.00316 | acc=0.9219 | L2-Norm=17.763 | L2-Norm(final)=3.533 | 1859.1 samples/s | 29.0 steps/s
[Step=4800 Epoch=23.4] | Loss=0.10265 | Reg=0.00316 | acc=0.9688 | L2-Norm=17.782 | L2-Norm(final)=3.537 | 4931.1 samples/s | 77.0 steps/s
[Step=4850 Epoch=23.7] | Loss=0.09664 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.799 | L2-Norm(final)=3.540 | 4931.6 samples/s | 77.1 steps/s
[Step=4900 Epoch=23.9] | Loss=0.09175 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.812 | L2-Norm(final)=3.543 | 6172.2 samples/s | 96.4 steps/s
[Step=4950 Epoch=24.2] | Loss=0.08617 | Reg=0.00318 | acc=0.9531 | L2-Norm=17.827 | L2-Norm(final)=3.546 | 1907.1 samples/s | 29.8 steps/s
[Step=5000 Epoch=24.4] | Loss=0.08115 | Reg=0.00318 | acc=0.9688 | L2-Norm=17.843 | L2-Norm(final)=3.550 | 4911.9 samples/s | 76.7 steps/s
[Step=5050 Epoch=24.6] | Loss=0.07717 | Reg=0.00319 | acc=0.9531 | L2-Norm=17.858 | L2-Norm(final)=3.554 | 4914.3 samples/s | 76.8 steps/s
[Step=5100 Epoch=24.9] | Loss=0.07491 | Reg=0.00319 | acc=0.9531 | L2-Norm=17.873 | L2-Norm(final)=3.557 | 5883.5 samples/s | 91.9 steps/s
[Step=5150 Epoch=25.1] | Loss=0.07141 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.886 | L2-Norm(final)=3.559 | 1929.0 samples/s | 30.1 steps/s
[Step=5200 Epoch=25.4] | Loss=0.06798 | Reg=0.00320 | acc=0.9531 | L2-Norm=17.898 | L2-Norm(final)=3.562 | 4967.2 samples/s | 77.6 steps/s
[Step=5250 Epoch=25.6] | Loss=0.06579 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.911 | L2-Norm(final)=3.565 | 4886.4 samples/s | 76.4 steps/s
[Step=5300 Epoch=25.9] | Loss=0.06417 | Reg=0.00321 | acc=0.9688 | L2-Norm=17.923 | L2-Norm(final)=3.567 | 5591.7 samples/s | 87.4 steps/s
[Step=5350 Epoch=26.1] | Loss=0.06221 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.936 | L2-Norm(final)=3.569 | 1977.1 samples/s | 30.9 steps/s
[Step=5400 Epoch=26.3] | Loss=0.06037 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.948 | L2-Norm(final)=3.571 | 4926.5 samples/s | 77.0 steps/s
[Step=5450 Epoch=26.6] | Loss=0.05862 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.960 | L2-Norm(final)=3.573 | 4940.7 samples/s | 77.2 steps/s
[Step=5500 Epoch=26.8] | Loss=0.05688 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.972 | L2-Norm(final)=3.576 | 5239.2 samples/s | 81.9 steps/s
[Step=5550 Epoch=27.1] | Loss=0.05508 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.983 | L2-Norm(final)=3.578 | 1988.5 samples/s | 31.1 steps/s
[Step=5600 Epoch=27.3] | Loss=0.05337 | Reg=0.00324 | acc=0.9688 | L2-Norm=17.992 | L2-Norm(final)=3.580 | 5007.3 samples/s | 78.2 steps/s
[Step=5650 Epoch=27.6] | Loss=0.05191 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.001 | L2-Norm(final)=3.582 | 4952.8 samples/s | 77.4 steps/s
[Step=5700 Epoch=27.8] | Loss=0.05073 | Reg=0.00324 | acc=0.9844 | L2-Norm=18.007 | L2-Norm(final)=3.584 | 5023.0 samples/s | 78.5 steps/s
[Step=5750 Epoch=28.1] | Loss=0.04962 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.014 | L2-Norm(final)=3.586 | 2040.7 samples/s | 31.9 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04841 | Reg=0.00325 | acc=0.9688 | L2-Norm=18.021 | L2-Norm(final)=3.588 | 5075.7 samples/s | 79.3 steps/s
[Step=5850 Epoch=28.5] | Loss=0.04728 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.026 | L2-Norm(final)=3.589 | 4945.2 samples/s | 77.3 steps/s
[Step=5900 Epoch=28.8] | Loss=0.04632 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.032 | L2-Norm(final)=3.591 | 5025.1 samples/s | 78.5 steps/s
[Step=5950 Epoch=29.0] | Loss=0.04544 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.037 | L2-Norm(final)=3.592 | 2040.8 samples/s | 31.9 steps/s
[Step=6000 Epoch=29.3] | Loss=0.04437 | Reg=0.00326 | acc=0.9688 | L2-Norm=18.042 | L2-Norm(final)=3.594 | 5027.4 samples/s | 78.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step6000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.36642 | Reg=0.00246 | acc=0.5312 | L2-Norm=15.692 | L2-Norm(final)=2.103 | 4061.0 samples/s | 63.5 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.27082 | Reg=0.00250 | acc=0.8281 | L2-Norm=15.796 | L2-Norm(final)=2.119 | 5440.5 samples/s | 85.0 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.24460 | Reg=0.00254 | acc=0.8125 | L2-Norm=15.931 | L2-Norm(final)=2.169 | 5910.2 samples/s | 92.3 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.22919 | Reg=0.00258 | acc=0.8594 | L2-Norm=16.052 | L2-Norm(final)=2.214 | 5916.4 samples/s | 92.4 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.21909 | Reg=0.00261 | acc=0.8594 | L2-Norm=16.151 | L2-Norm(final)=2.254 | 8557.5 samples/s | 133.7 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.21230 | Reg=0.00264 | acc=0.8594 | L2-Norm=16.233 | L2-Norm(final)=2.292 | 1983.3 samples/s | 31.0 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.20860 | Reg=0.00266 | acc=0.7969 | L2-Norm=16.304 | L2-Norm(final)=2.326 | 5828.2 samples/s | 91.1 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.20474 | Reg=0.00268 | acc=0.8594 | L2-Norm=16.370 | L2-Norm(final)=2.356 | 5919.3 samples/s | 92.5 steps/s
[Step= 400 Epoch= 1.9] | Loss=0.20210 | Reg=0.00270 | acc=0.8594 | L2-Norm=16.437 | L2-Norm(final)=2.384 | 7834.2 samples/s | 122.4 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.19926 | Reg=0.00273 | acc=0.8281 | L2-Norm=16.507 | L2-Norm(final)=2.409 | 2018.4 samples/s | 31.5 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.19590 | Reg=0.00275 | acc=0.8438 | L2-Norm=16.568 | L2-Norm(final)=2.435 | 5991.7 samples/s | 93.6 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.4] | Loss=0.10284 | Reg=0.00294 | acc=0.9375 | L2-Norm=17.143 | L2-Norm(final)=2.698 | 3798.1 samples/s | 59.3 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.17723 | Reg=0.00295 | acc=0.8438 | L2-Norm=17.167 | L2-Norm(final)=2.693 | 4944.8 samples/s | 77.3 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.15790 | Reg=0.00295 | acc=0.9062 | L2-Norm=17.187 | L2-Norm(final)=2.697 | 4981.1 samples/s | 77.8 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.14310 | Reg=0.00296 | acc=0.9375 | L2-Norm=17.214 | L2-Norm(final)=2.704 | 4861.6 samples/s | 76.0 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.13344 | Reg=0.00297 | acc=0.8906 | L2-Norm=17.238 | L2-Norm(final)=2.712 | 6606.1 samples/s | 103.2 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.12166 | Reg=0.00298 | acc=0.9531 | L2-Norm=17.257 | L2-Norm(final)=2.721 | 1863.3 samples/s | 29.1 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.11255 | Reg=0.00299 | acc=0.9062 | L2-Norm=17.280 | L2-Norm(final)=2.733 | 4795.3 samples/s | 74.9 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.10559 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.304 | L2-Norm(final)=2.743 | 4789.9 samples/s | 74.8 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.10033 | Reg=0.00300 | acc=0.9375 | L2-Norm=17.328 | L2-Norm(final)=2.754 | 6169.3 samples/s | 96.4 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.09622 | Reg=0.00301 | acc=0.9688 | L2-Norm=17.353 | L2-Norm(final)=2.763 | 1922.1 samples/s | 30.0 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.09131 | Reg=0.00302 | acc=0.9688 | L2-Norm=17.380 | L2-Norm(final)=2.773 | 4959.7 samples/s | 77.5 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.08685 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.403 | L2-Norm(final)=2.782 | 4940.2 samples/s | 77.2 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.08337 | Reg=0.00304 | acc=0.9844 | L2-Norm=17.424 | L2-Norm(final)=2.791 | 5686.2 samples/s | 88.8 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.08003 | Reg=0.00304 | acc=0.9844 | L2-Norm=17.443 | L2-Norm(final)=2.799 | 1342.2 samples/s | 21.0 steps/s
[Step=1200 Epoch= 5.8] | Loss=0.07642 | Reg=0.00305 | acc=0.9844 | L2-Norm=17.462 | L2-Norm(final)=2.808 | 4527.3 samples/s | 70.7 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.07391 | Reg=0.00306 | acc=0.9844 | L2-Norm=17.480 | L2-Norm(final)=2.815 | 4886.0 samples/s | 76.3 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.07153 | Reg=0.00306 | acc=0.9844 | L2-Norm=17.497 | L2-Norm(final)=2.823 | 5375.0 samples/s | 84.0 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.06910 | Reg=0.00307 | acc=0.9688 | L2-Norm=17.515 | L2-Norm(final)=2.830 | 1985.7 samples/s | 31.0 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.06688 | Reg=0.00307 | acc=0.9688 | L2-Norm=17.532 | L2-Norm(final)=2.837 | 5041.9 samples/s | 78.8 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.06534 | Reg=0.00308 | acc=0.9688 | L2-Norm=17.550 | L2-Norm(final)=2.844 | 4887.0 samples/s | 76.4 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.06358 | Reg=0.00309 | acc=0.9531 | L2-Norm=17.567 | L2-Norm(final)=2.850 | 5047.5 samples/s | 78.9 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.06188 | Reg=0.00309 | acc=0.9844 | L2-Norm=17.584 | L2-Norm(final)=2.855 | 2050.1 samples/s | 32.0 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.05996 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.599 | L2-Norm(final)=2.861 | 5000.1 samples/s | 78.1 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.05840 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.614 | L2-Norm(final)=2.866 | 4929.9 samples/s | 77.0 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.05722 | Reg=0.00311 | acc=0.9688 | L2-Norm=17.627 | L2-Norm(final)=2.871 | 4925.0 samples/s | 77.0 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.05608 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.640 | L2-Norm(final)=2.875 | 2061.3 samples/s | 32.2 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.05480 | Reg=0.00312 | acc=0.9688 | L2-Norm=17.652 | L2-Norm(final)=2.880 | 5132.0 samples/s | 80.2 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.05371 | Reg=0.00312 | acc=0.9844 | L2-Norm=17.665 | L2-Norm(final)=2.884 | 4893.4 samples/s | 76.5 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.05290 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.677 | L2-Norm(final)=2.888 | 4956.8 samples/s | 77.4 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.05196 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.690 | L2-Norm(final)=2.893 | 2081.3 samples/s | 32.5 steps/s
[Step=2000 Epoch= 9.7] | Loss=0.05092 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.703 | L2-Norm(final)=2.897 | 4901.5 samples/s | 76.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step2000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=2001 Epoch=19.0] | Loss=0.05723 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.692 | L2-Norm(final)=2.933 | 4012.6 samples/s | 62.7 steps/s
[Step=2050 Epoch=19.5] | Loss=0.05508 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.025 | L2-Norm(final)=2.987 | 4785.3 samples/s | 74.8 steps/s
[Step=2100 Epoch=20.0] | Loss=0.04188 | Reg=0.00265 | acc=0.9844 | L2-Norm=16.265 | L2-Norm(final)=3.051 | 7442.3 samples/s | 116.3 steps/s
[Step=2150 Epoch=20.5] | Loss=0.03373 | Reg=0.00270 | acc=0.9688 | L2-Norm=16.430 | L2-Norm(final)=3.108 | 1863.0 samples/s | 29.1 steps/s
[Step=2200 Epoch=20.9] | Loss=0.02940 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.556 | L2-Norm(final)=3.159 | 6919.7 samples/s | 108.1 steps/s
[Step=2250 Epoch=21.4] | Loss=0.02595 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.656 | L2-Norm(final)=3.205 | 1887.6 samples/s | 29.5 steps/s
[Step=2300 Epoch=21.9] | Loss=0.02421 | Reg=0.00281 | acc=0.9844 | L2-Norm=16.746 | L2-Norm(final)=3.246 | 6231.5 samples/s | 97.4 steps/s
[Step=2350 Epoch=22.4] | Loss=0.02200 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.831 | L2-Norm(final)=3.284 | 1978.4 samples/s | 30.9 steps/s
[Step=2400 Epoch=22.8] | Loss=0.02024 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.907 | L2-Norm(final)=3.321 | 5829.6 samples/s | 91.1 steps/s
[Step=2450 Epoch=23.3] | Loss=0.01891 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.975 | L2-Norm(final)=3.356 | 2034.9 samples/s | 31.8 steps/s
[Step=2500 Epoch=23.8] | Loss=0.01776 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.039 | L2-Norm(final)=3.390 | 5484.4 samples/s | 85.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.8] | Loss=0.00322 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.658 | L2-Norm(final)=3.720 | 3936.9 samples/s | 61.5 steps/s
[Step=2550 Epoch=24.3] | Loss=0.09431 | Reg=0.00316 | acc=0.9844 | L2-Norm=17.763 | L2-Norm(final)=3.631 | 4390.4 samples/s | 68.6 steps/s
[Step=2600 Epoch=24.7] | Loss=0.05206 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.870 | L2-Norm(final)=3.593 | 6369.6 samples/s | 99.5 steps/s
[Step=2650 Epoch=25.2] | Loss=0.03504 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.905 | L2-Norm(final)=3.587 | 1819.5 samples/s | 28.4 steps/s
[Step=2700 Epoch=25.7] | Loss=0.02638 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.912 | L2-Norm(final)=3.587 | 5943.4 samples/s | 92.9 steps/s
[Step=2750 Epoch=26.2] | Loss=0.02115 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.905 | L2-Norm(final)=3.588 | 1860.1 samples/s | 29.1 steps/s
[Step=2800 Epoch=26.6] | Loss=0.01764 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.891 | L2-Norm(final)=3.589 | 5326.1 samples/s | 83.2 steps/s
[Step=2850 Epoch=27.1] | Loss=0.01513 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.872 | L2-Norm(final)=3.590 | 1907.8 samples/s | 29.8 steps/s
[Step=2900 Epoch=27.6] | Loss=0.01325 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.851 | L2-Norm(final)=3.592 | 5086.9 samples/s | 79.5 steps/s
[Step=2950 Epoch=28.1] | Loss=0.01178 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.827 | L2-Norm(final)=3.593 | 1955.6 samples/s | 30.6 steps/s
[Step=3000 Epoch=28.5] | Loss=0.01061 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.802 | L2-Norm(final)=3.594 | 4727.0 samples/s | 73.9 steps/s
[Step=3050 Epoch=29.0] | Loss=0.00965 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.776 | L2-Norm(final)=3.595 | 2007.5 samples/s | 31.4 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00885 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.749 | L2-Norm(final)=3.596 | 4718.1 samples/s | 73.7 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00817 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.722 | L2-Norm(final)=3.597 | 1988.5 samples/s | 31.1 steps/s
[Step=3200 Epoch=30.4] | Loss=0.00759 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.694 | L2-Norm(final)=3.598 | 4783.1 samples/s | 74.7 steps/s
[Step=3250 Epoch=30.9] | Loss=0.00708 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.666 | L2-Norm(final)=3.599 | 1995.8 samples/s | 31.2 steps/s
[Step=3300 Epoch=31.4] | Loss=0.00664 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.638 | L2-Norm(final)=3.599 | 4755.9 samples/s | 74.3 steps/s
[Step=3350 Epoch=31.9] | Loss=0.00625 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.610 | L2-Norm(final)=3.600 | 2064.1 samples/s | 32.3 steps/s
[Step=3400 Epoch=32.3] | Loss=0.00591 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.581 | L2-Norm(final)=3.601 | 4539.5 samples/s | 70.9 steps/s
[Step=3450 Epoch=32.8] | Loss=0.00560 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.553 | L2-Norm(final)=3.602 | 6433.0 samples/s | 100.5 steps/s
[Step=3500 Epoch=33.3] | Loss=0.00532 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.524 | L2-Norm(final)=3.603 | 1779.9 samples/s | 27.8 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00507 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.495 | L2-Norm(final)=3.603 | 6176.3 samples/s | 96.5 steps/s
[Step=3600 Epoch=34.2] | Loss=0.00484 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.467 | L2-Norm(final)=3.604 | 1813.5 samples/s | 28.3 steps/s
[Step=3650 Epoch=34.7] | Loss=0.00463 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.438 | L2-Norm(final)=3.605 | 5552.6 samples/s | 86.8 steps/s
[Step=3700 Epoch=35.2] | Loss=0.00444 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.409 | L2-Norm(final)=3.605 | 1901.7 samples/s | 29.7 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00426 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.380 | L2-Norm(final)=3.606 | 5169.7 samples/s | 80.8 steps/s
[Step=3800 Epoch=36.1] | Loss=0.00410 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.350 | L2-Norm(final)=3.607 | 1914.3 samples/s | 29.9 steps/s
[Step=3850 Epoch=36.6] | Loss=0.00394 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.321 | L2-Norm(final)=3.607 | 4942.7 samples/s | 77.2 steps/s
[Step=3900 Epoch=37.1] | Loss=0.00380 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.292 | L2-Norm(final)=3.608 | 1963.8 samples/s | 30.7 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00367 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.263 | L2-Norm(final)=3.608 | 4760.8 samples/s | 74.4 steps/s
[Step=4000 Epoch=38.0] | Loss=0.00355 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.233 | L2-Norm(final)=3.609 | 1971.2 samples/s | 30.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step4000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=2001 Epoch=19.1] | Loss=0.06629 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.692 | L2-Norm(final)=3.162 | 3775.7 samples/s | 59.0 steps/s
[Step=2050 Epoch=19.6] | Loss=0.05106 | Reg=0.00260 | acc=0.9688 | L2-Norm=16.120 | L2-Norm(final)=3.203 | 5031.9 samples/s | 78.6 steps/s
[Step=2100 Epoch=20.1] | Loss=0.04099 | Reg=0.00269 | acc=0.9688 | L2-Norm=16.406 | L2-Norm(final)=3.238 | 7580.1 samples/s | 118.4 steps/s
[Step=2150 Epoch=20.5] | Loss=0.03330 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.564 | L2-Norm(final)=3.270 | 1858.6 samples/s | 29.0 steps/s
[Step=2200 Epoch=21.0] | Loss=0.02865 | Reg=0.00278 | acc=0.9844 | L2-Norm=16.670 | L2-Norm(final)=3.303 | 6910.4 samples/s | 108.0 steps/s
[Step=2250 Epoch=21.5] | Loss=0.02574 | Reg=0.00281 | acc=0.9531 | L2-Norm=16.749 | L2-Norm(final)=3.336 | 1911.3 samples/s | 29.9 steps/s
[Step=2300 Epoch=22.0] | Loss=0.02351 | Reg=0.00283 | acc=0.9844 | L2-Norm=16.819 | L2-Norm(final)=3.368 | 6400.0 samples/s | 100.0 steps/s
[Step=2350 Epoch=22.4] | Loss=0.02140 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.876 | L2-Norm(final)=3.398 | 1947.0 samples/s | 30.4 steps/s
[Step=2400 Epoch=22.9] | Loss=0.02004 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.927 | L2-Norm(final)=3.428 | 5980.1 samples/s | 93.4 steps/s
[Step=2450 Epoch=23.4] | Loss=0.01862 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.970 | L2-Norm(final)=3.457 | 1982.1 samples/s | 31.0 steps/s
[Step=2500 Epoch=23.9] | Loss=0.01751 | Reg=0.00289 | acc=1.0000 | L2-Norm=17.007 | L2-Norm(final)=3.485 | 5711.6 samples/s | 89.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.9] | Loss=0.00566 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.355 | L2-Norm(final)=3.763 | 4014.5 samples/s | 62.7 steps/s
[Step=2550 Epoch=24.4] | Loss=0.06599 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.468 | L2-Norm(final)=3.693 | 4201.7 samples/s | 65.7 steps/s
[Step=2600 Epoch=24.8] | Loss=0.03597 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.544 | L2-Norm(final)=3.694 | 6465.5 samples/s | 101.0 steps/s
[Step=2650 Epoch=25.3] | Loss=0.02421 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.557 | L2-Norm(final)=3.700 | 1804.6 samples/s | 28.2 steps/s
[Step=2700 Epoch=25.8] | Loss=0.01852 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.546 | L2-Norm(final)=3.705 | 6015.3 samples/s | 94.0 steps/s
[Step=2750 Epoch=26.3] | Loss=0.01488 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.527 | L2-Norm(final)=3.709 | 1842.1 samples/s | 28.8 steps/s
[Step=2800 Epoch=26.7] | Loss=0.01242 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.504 | L2-Norm(final)=3.713 | 5601.6 samples/s | 87.5 steps/s
[Step=2850 Epoch=27.2] | Loss=0.01065 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.478 | L2-Norm(final)=3.716 | 1879.5 samples/s | 29.4 steps/s
[Step=2900 Epoch=27.7] | Loss=0.00933 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.450 | L2-Norm(final)=3.719 | 5376.4 samples/s | 84.0 steps/s
[Step=2950 Epoch=28.2] | Loss=0.00830 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.421 | L2-Norm(final)=3.721 | 1900.6 samples/s | 29.7 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00747 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.391 | L2-Norm(final)=3.723 | 5042.8 samples/s | 78.8 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00680 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.361 | L2-Norm(final)=3.724 | 1952.7 samples/s | 30.5 steps/s
[Step=3100 Epoch=29.6] | Loss=0.00623 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.330 | L2-Norm(final)=3.726 | 4792.9 samples/s | 74.9 steps/s
[Step=3150 Epoch=30.1] | Loss=0.00576 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.298 | L2-Norm(final)=3.727 | 1981.5 samples/s | 31.0 steps/s
[Step=3200 Epoch=30.6] | Loss=0.00535 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.267 | L2-Norm(final)=3.729 | 4712.6 samples/s | 73.6 steps/s
[Step=3250 Epoch=31.0] | Loss=0.00499 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.235 | L2-Norm(final)=3.730 | 2000.2 samples/s | 31.3 steps/s
[Step=3300 Epoch=31.5] | Loss=0.00468 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.204 | L2-Norm(final)=3.731 | 4734.0 samples/s | 74.0 steps/s
[Step=3350 Epoch=32.0] | Loss=0.00441 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.172 | L2-Norm(final)=3.732 | 2001.3 samples/s | 31.3 steps/s
[Step=3400 Epoch=32.5] | Loss=0.00416 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.140 | L2-Norm(final)=3.733 | 4779.2 samples/s | 74.7 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00395 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.108 | L2-Norm(final)=3.734 | 2018.9 samples/s | 31.5 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00375 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.076 | L2-Norm(final)=3.735 | 4667.3 samples/s | 72.9 steps/s
[Step=3550 Epoch=33.9] | Loss=0.00357 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.044 | L2-Norm(final)=3.736 | 6938.6 samples/s | 108.4 steps/s
[Step=3600 Epoch=34.4] | Loss=0.00341 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.013 | L2-Norm(final)=3.737 | 1768.0 samples/s | 27.6 steps/s
[Step=3650 Epoch=34.9] | Loss=0.00326 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.981 | L2-Norm(final)=3.737 | 6353.3 samples/s | 99.3 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00313 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.949 | L2-Norm(final)=3.738 | 1785.6 samples/s | 27.9 steps/s
[Step=3750 Epoch=35.8] | Loss=0.00300 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.917 | L2-Norm(final)=3.739 | 6071.1 samples/s | 94.9 steps/s
[Step=3800 Epoch=36.3] | Loss=0.00289 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.885 | L2-Norm(final)=3.740 | 1815.5 samples/s | 28.4 steps/s
[Step=3850 Epoch=36.8] | Loss=0.00278 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.854 | L2-Norm(final)=3.740 | 5640.4 samples/s | 88.1 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00268 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.822 | L2-Norm(final)=3.741 | 1884.8 samples/s | 29.5 steps/s
[Step=3950 Epoch=37.7] | Loss=0.00259 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.790 | L2-Norm(final)=3.742 | 5342.4 samples/s | 83.5 steps/s
[Step=4000 Epoch=38.2] | Loss=0.00250 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.759 | L2-Norm(final)=3.742 | 1888.7 samples/s | 29.5 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.14942 | acc=0.9208 | tpr=0.9143 | fpr=0.0652 | 4455.3 samples/s | 17.4 steps/s
Avg test loss: 0.15422, Avg test acc: 0.91842, Avg tpr: 0.91292, Avg fpr: 0.06948, total FA: 542

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.16070 | acc=0.9192 | tpr=0.9248 | fpr=0.0929 | 4370.9 samples/s | 17.1 steps/s
Avg test loss: 0.16209, Avg test acc: 0.91975, Avg tpr: 0.92487, Avg fpr: 0.09153, total FA: 714

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.13535 | acc=0.9315 | tpr=0.9530 | fpr=0.1152 | 4436.0 samples/s | 17.3 steps/s
Avg test loss: 0.13404, Avg test acc: 0.93068, Avg tpr: 0.95145, Avg fpr: 0.11499, total FA: 897

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.32229 | acc=0.6802 | tpr=0.9925 | fpr=0.9980 | 4395.4 samples/s | 17.2 steps/s
Avg test loss: 0.32090, Avg test acc: 0.68343, Avg tpr: 0.99318, Avg fpr: 0.99782, total FA: 7784

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.16218 | acc=0.9246 | tpr=0.9404 | fpr=0.1098 | 4362.4 samples/s | 17.0 steps/s
Avg test loss: 0.16532, Avg test acc: 0.92275, Avg tpr: 0.93833, Avg fpr: 0.11152, total FA: 870

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=3.87613 | acc=0.3195 | tpr=0.0175 | fpr=0.0245 | 4372.5 samples/s | 17.1 steps/s
Avg test loss: 3.87277, Avg test acc: 0.31781, Avg tpr: 0.01818, Avg fpr: 0.02320, total FA: 181

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.17366 | acc=0.3134 | tpr=0.0049 | fpr=0.0166 | 4383.7 samples/s | 17.1 steps/s
Avg test loss: 4.17380, Avg test acc: 0.31108, Avg tpr: 0.00495, Avg fpr: 0.01564, total FA: 122

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.14305 | acc=0.3156 | tpr=0.0023 | fpr=0.0040 | 4349.8 samples/s | 17.0 steps/s
Avg test loss: 4.15187, Avg test acc: 0.31297, Avg tpr: 0.00221, Avg fpr: 0.00359, total FA: 28

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=3.87061 | acc=0.3154 | tpr=0.0029 | fpr=0.0059 | 4404.2 samples/s | 17.2 steps/s
Avg test loss: 3.89015, Avg test acc: 0.31200, Avg tpr: 0.00245, Avg fpr: 0.00718, total FA: 56

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=3.83227 | acc=0.3166 | tpr=0.0116 | fpr=0.0211 | 4366.6 samples/s | 17.1 steps/s
Avg test loss: 3.82612, Avg test acc: 0.31509, Avg tpr: 0.01241, Avg fpr: 0.01923, total FA: 150

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.87972 | acc=0.1511 | tpr=0.7434 | fpr=0.8596 | 4404.9 samples/s | 17.2 steps/s
[Step= 100] | Loss=3.85795 | acc=0.1523 | tpr=0.7207 | fpr=0.8583 | 8704.4 samples/s | 34.0 steps/s
[Step= 150] | Loss=3.86674 | acc=0.1509 | tpr=0.7205 | fpr=0.8596 | 8336.7 samples/s | 32.6 steps/s
[Step= 200] | Loss=3.86237 | acc=0.1510 | tpr=0.7191 | fpr=0.8593 | 9130.9 samples/s | 35.7 steps/s
[Step= 250] | Loss=3.86595 | acc=0.1507 | tpr=0.7144 | fpr=0.8596 | 8325.5 samples/s | 32.5 steps/s
[Step= 300] | Loss=3.86696 | acc=0.1501 | tpr=0.7062 | fpr=0.8601 | 8740.9 samples/s | 34.1 steps/s
[Step= 350] | Loss=3.85673 | acc=0.1503 | tpr=0.7026 | fpr=0.8598 | 8481.0 samples/s | 33.1 steps/s
[Step= 400] | Loss=3.85644 | acc=0.1506 | tpr=0.7068 | fpr=0.8595 | 8753.1 samples/s | 34.2 steps/s
[Step= 450] | Loss=3.85579 | acc=0.1507 | tpr=0.7074 | fpr=0.8594 | 8691.2 samples/s | 34.0 steps/s
[Step= 500] | Loss=3.85628 | acc=0.1507 | tpr=0.7066 | fpr=0.8593 | 8717.2 samples/s | 34.1 steps/s
[Step= 550] | Loss=3.85806 | acc=0.1506 | tpr=0.7083 | fpr=0.8595 | 15695.7 samples/s | 61.3 steps/s
Avg test loss: 3.85865, Avg test acc: 0.15050, Avg tpr: 0.70761, Avg fpr: 0.85963, total FA: 119358

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=3.55246 | acc=0.1727 | tpr=0.6195 | fpr=0.8353 | 4450.6 samples/s | 17.4 steps/s
[Step= 100] | Loss=3.52616 | acc=0.1737 | tpr=0.5394 | fpr=0.8331 | 8217.7 samples/s | 32.1 steps/s
[Step= 150] | Loss=3.52102 | acc=0.1743 | tpr=0.5432 | fpr=0.8325 | 8871.2 samples/s | 34.7 steps/s
[Step= 200] | Loss=3.52060 | acc=0.1738 | tpr=0.5388 | fpr=0.8328 | 8325.1 samples/s | 32.5 steps/s
[Step= 250] | Loss=3.51581 | acc=0.1741 | tpr=0.5415 | fpr=0.8326 | 8801.7 samples/s | 34.4 steps/s
[Step= 300] | Loss=3.51462 | acc=0.1735 | tpr=0.5411 | fpr=0.8332 | 8585.2 samples/s | 33.5 steps/s
[Step= 350] | Loss=3.51150 | acc=0.1743 | tpr=0.5416 | fpr=0.8324 | 8454.0 samples/s | 33.0 steps/s
[Step= 400] | Loss=3.50909 | acc=0.1743 | tpr=0.5399 | fpr=0.8323 | 8960.0 samples/s | 35.0 steps/s
[Step= 450] | Loss=3.51136 | acc=0.1745 | tpr=0.5458 | fpr=0.8323 | 8241.0 samples/s | 32.2 steps/s
[Step= 500] | Loss=3.51405 | acc=0.1741 | tpr=0.5480 | fpr=0.8327 | 8709.8 samples/s | 34.0 steps/s
[Step= 550] | Loss=3.51317 | acc=0.1739 | tpr=0.5491 | fpr=0.8329 | 14984.4 samples/s | 58.5 steps/s
Avg test loss: 3.51445, Avg test acc: 0.17379, Avg tpr: 0.54873, Avg fpr: 0.83303, total FA: 115664

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.31651 | acc=0.0988 | tpr=0.8673 | fpr=0.9150 | 4405.2 samples/s | 17.2 steps/s
[Step= 100] | Loss=4.29181 | acc=0.1002 | tpr=0.8422 | fpr=0.9137 | 8460.7 samples/s | 33.0 steps/s
[Step= 150] | Loss=4.29845 | acc=0.1005 | tpr=0.8429 | fpr=0.9131 | 8601.4 samples/s | 33.6 steps/s
[Step= 200] | Loss=4.29692 | acc=0.1002 | tpr=0.8514 | fpr=0.9135 | 8620.3 samples/s | 33.7 steps/s
[Step= 250] | Loss=4.30620 | acc=0.1002 | tpr=0.8533 | fpr=0.9135 | 9121.4 samples/s | 35.6 steps/s
[Step= 300] | Loss=4.31214 | acc=0.0996 | tpr=0.8553 | fpr=0.9142 | 8333.6 samples/s | 32.6 steps/s
[Step= 350] | Loss=4.30743 | acc=0.0990 | tpr=0.8572 | fpr=0.9147 | 8496.4 samples/s | 33.2 steps/s
[Step= 400] | Loss=4.30742 | acc=0.0988 | tpr=0.8556 | fpr=0.9149 | 9075.4 samples/s | 35.5 steps/s
[Step= 450] | Loss=4.31059 | acc=0.0989 | tpr=0.8593 | fpr=0.9150 | 8383.6 samples/s | 32.7 steps/s
[Step= 500] | Loss=4.31086 | acc=0.0987 | tpr=0.8608 | fpr=0.9150 | 8512.8 samples/s | 33.3 steps/s
[Step= 550] | Loss=4.31192 | acc=0.0986 | tpr=0.8631 | fpr=0.9153 | 14952.0 samples/s | 58.4 steps/s
Avg test loss: 4.31232, Avg test acc: 0.09856, Avg tpr: 0.86371, Avg fpr: 0.91535, total FA: 127094

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=0.49347 | acc=0.0224 | tpr=1.0000 | fpr=0.9951 | 4512.8 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.49431 | acc=0.0224 | tpr=1.0000 | fpr=0.9958 | 8576.9 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.49466 | acc=0.0221 | tpr=1.0000 | fpr=0.9959 | 8216.8 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.49447 | acc=0.0218 | tpr=1.0000 | fpr=0.9960 | 8391.7 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.49484 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 9465.0 samples/s | 37.0 steps/s
[Step= 300] | Loss=0.49501 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8040.9 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.49495 | acc=0.0215 | tpr=1.0000 | fpr=0.9962 | 8692.7 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.49496 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8426.2 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.49497 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 9032.6 samples/s | 35.3 steps/s
[Step= 500] | Loss=0.49508 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 8390.8 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.49497 | acc=0.0215 | tpr=1.0000 | fpr=0.9963 | 15477.8 samples/s | 60.5 steps/s
Avg test loss: 0.49495, Avg test acc: 0.02145, Avg tpr: 1.00000, Avg fpr: 0.99633, total FA: 138339

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.11563 | acc=0.1366 | tpr=0.7965 | fpr=0.8753 | 4332.0 samples/s | 16.9 steps/s
[Step= 100] | Loss=4.10578 | acc=0.1363 | tpr=0.7249 | fpr=0.8747 | 8706.2 samples/s | 34.0 steps/s
[Step= 150] | Loss=4.11244 | acc=0.1359 | tpr=0.7248 | fpr=0.8749 | 8734.5 samples/s | 34.1 steps/s
[Step= 200] | Loss=4.11806 | acc=0.1364 | tpr=0.7202 | fpr=0.8743 | 8770.0 samples/s | 34.3 steps/s
[Step= 250] | Loss=4.12849 | acc=0.1354 | tpr=0.7284 | fpr=0.8754 | 8839.9 samples/s | 34.5 steps/s
[Step= 300] | Loss=4.13239 | acc=0.1352 | tpr=0.7309 | fpr=0.8757 | 8400.8 samples/s | 32.8 steps/s
[Step= 350] | Loss=4.12689 | acc=0.1355 | tpr=0.7282 | fpr=0.8752 | 8656.3 samples/s | 33.8 steps/s
[Step= 400] | Loss=4.12740 | acc=0.1356 | tpr=0.7281 | fpr=0.8752 | 8248.3 samples/s | 32.2 steps/s
[Step= 450] | Loss=4.12583 | acc=0.1357 | tpr=0.7308 | fpr=0.8751 | 9036.9 samples/s | 35.3 steps/s
[Step= 500] | Loss=4.12537 | acc=0.1356 | tpr=0.7282 | fpr=0.8751 | 8269.9 samples/s | 32.3 steps/s
[Step= 550] | Loss=4.12766 | acc=0.1354 | tpr=0.7274 | fpr=0.8754 | 15613.6 samples/s | 61.0 steps/s
Avg test loss: 4.12812, Avg test acc: 0.13537, Avg tpr: 0.72781, Avg fpr: 0.87540, total FA: 121547

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.05105 | acc=0.9795 | tpr=0.8053 | fpr=0.0173 | 4412.0 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.04880 | acc=0.9795 | tpr=0.8124 | fpr=0.0173 | 8567.4 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.04998 | acc=0.9793 | tpr=0.8112 | fpr=0.0176 | 8738.2 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.05094 | acc=0.9792 | tpr=0.8219 | fpr=0.0179 | 8751.0 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.05087 | acc=0.9793 | tpr=0.8183 | fpr=0.0178 | 8630.6 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.05156 | acc=0.9790 | tpr=0.8145 | fpr=0.0180 | 8428.7 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.05108 | acc=0.9791 | tpr=0.8178 | fpr=0.0180 | 8801.3 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.05154 | acc=0.9789 | tpr=0.8129 | fpr=0.0181 | 8662.4 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.05234 | acc=0.9787 | tpr=0.8116 | fpr=0.0183 | 8509.1 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.05192 | acc=0.9789 | tpr=0.8145 | fpr=0.0182 | 9449.3 samples/s | 36.9 steps/s
[Step= 550] | Loss=0.05123 | acc=0.9790 | tpr=0.8158 | fpr=0.0181 | 13744.1 samples/s | 53.7 steps/s
Avg test loss: 0.05119, Avg test acc: 0.97894, Avg tpr: 0.81498, Avg fpr: 0.01808, total FA: 2510

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09371 | acc=0.9826 | tpr=0.8363 | fpr=0.0148 | 4350.4 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.09485 | acc=0.9817 | tpr=0.8550 | fpr=0.0160 | 8819.5 samples/s | 34.5 steps/s
[Step= 150] | Loss=0.09662 | acc=0.9813 | tpr=0.8530 | fpr=0.0163 | 8576.8 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.10078 | acc=0.9810 | tpr=0.8525 | fpr=0.0167 | 9089.2 samples/s | 35.5 steps/s
[Step= 250] | Loss=0.09922 | acc=0.9812 | tpr=0.8498 | fpr=0.0164 | 8213.1 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.10045 | acc=0.9808 | tpr=0.8473 | fpr=0.0168 | 8736.1 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.10160 | acc=0.9806 | tpr=0.8491 | fpr=0.0170 | 8728.8 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.10267 | acc=0.9803 | tpr=0.8408 | fpr=0.0171 | 8531.5 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.10417 | acc=0.9801 | tpr=0.8369 | fpr=0.0173 | 8942.9 samples/s | 34.9 steps/s
[Step= 500] | Loss=0.10409 | acc=0.9802 | tpr=0.8414 | fpr=0.0173 | 8260.0 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.10306 | acc=0.9803 | tpr=0.8436 | fpr=0.0172 | 15557.3 samples/s | 60.8 steps/s
Avg test loss: 0.10282, Avg test acc: 0.98036, Avg tpr: 0.84390, Avg fpr: 0.01716, total FA: 2383

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.08503 | acc=0.9807 | tpr=0.8805 | fpr=0.0175 | 4493.8 samples/s | 17.6 steps/s
[Step= 100] | Loss=0.08605 | acc=0.9806 | tpr=0.9041 | fpr=0.0179 | 8142.0 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.08944 | acc=0.9798 | tpr=0.9020 | fpr=0.0187 | 8521.9 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.09052 | acc=0.9796 | tpr=0.8951 | fpr=0.0189 | 8561.1 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.08877 | acc=0.9798 | tpr=0.8900 | fpr=0.0186 | 8739.9 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.09050 | acc=0.9795 | tpr=0.8880 | fpr=0.0188 | 8661.6 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.09156 | acc=0.9793 | tpr=0.8892 | fpr=0.0190 | 8588.8 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.09281 | acc=0.9792 | tpr=0.8873 | fpr=0.0192 | 8741.8 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.09467 | acc=0.9790 | tpr=0.8875 | fpr=0.0194 | 8629.3 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.09394 | acc=0.9791 | tpr=0.8899 | fpr=0.0193 | 8935.7 samples/s | 34.9 steps/s
[Step= 550] | Loss=0.09324 | acc=0.9791 | tpr=0.8906 | fpr=0.0193 | 14133.3 samples/s | 55.2 steps/s
Avg test loss: 0.09307, Avg test acc: 0.97915, Avg tpr: 0.89105, Avg fpr: 0.01924, total FA: 2672

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.06523 | acc=0.9823 | tpr=0.8451 | fpr=0.0153 | 4350.5 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.06659 | acc=0.9823 | tpr=0.8699 | fpr=0.0156 | 8545.7 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.06746 | acc=0.9816 | tpr=0.8775 | fpr=0.0164 | 8825.8 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.06773 | acc=0.9816 | tpr=0.8798 | fpr=0.0166 | 8627.9 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.06656 | acc=0.9818 | tpr=0.8760 | fpr=0.0163 | 8447.2 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.06784 | acc=0.9814 | tpr=0.8698 | fpr=0.0166 | 8593.0 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.06780 | acc=0.9813 | tpr=0.8710 | fpr=0.0167 | 8792.7 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.06843 | acc=0.9811 | tpr=0.8660 | fpr=0.0168 | 8303.3 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.06975 | acc=0.9808 | tpr=0.8642 | fpr=0.0171 | 8798.5 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.06955 | acc=0.9809 | tpr=0.8665 | fpr=0.0171 | 8678.0 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.06873 | acc=0.9811 | tpr=0.8679 | fpr=0.0169 | 14340.1 samples/s | 56.0 steps/s
Avg test loss: 0.06851, Avg test acc: 0.98109, Avg tpr: 0.86767, Avg fpr: 0.01685, total FA: 2340

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.06004 | acc=0.9784 | tpr=0.8009 | fpr=0.0185 | 4360.4 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.05947 | acc=0.9780 | tpr=0.8124 | fpr=0.0189 | 8558.8 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.06023 | acc=0.9770 | tpr=0.8141 | fpr=0.0200 | 8946.2 samples/s | 34.9 steps/s
[Step= 200] | Loss=0.06128 | acc=0.9771 | tpr=0.8197 | fpr=0.0200 | 8209.2 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.06088 | acc=0.9772 | tpr=0.8131 | fpr=0.0198 | 8791.6 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.06211 | acc=0.9769 | tpr=0.8080 | fpr=0.0200 | 8643.2 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.06231 | acc=0.9768 | tpr=0.8109 | fpr=0.0202 | 8569.6 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.06297 | acc=0.9765 | tpr=0.8025 | fpr=0.0204 | 8428.1 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.06410 | acc=0.9763 | tpr=0.8033 | fpr=0.0206 | 8585.0 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.06354 | acc=0.9764 | tpr=0.8048 | fpr=0.0205 | 8647.7 samples/s | 33.8 steps/s
[Step= 550] | Loss=0.06294 | acc=0.9766 | tpr=0.8062 | fpr=0.0203 | 15919.3 samples/s | 62.2 steps/s
Avg test loss: 0.06281, Avg test acc: 0.97657, Avg tpr: 0.80547, Avg fpr: 0.02032, total FA: 2822

server round 3/50

clients selected: [1 2 4 6 7]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=6001 Epoch=29.3] | Loss=0.23743 | Reg=0.00234 | acc=0.7656 | L2-Norm=15.302 | L2-Norm(final)=3.639 | 3977.3 samples/s | 62.1 steps/s
[Step=6050 Epoch=29.5] | Loss=0.16682 | Reg=0.00244 | acc=0.9062 | L2-Norm=15.619 | L2-Norm(final)=3.711 | 5185.9 samples/s | 81.0 steps/s
[Step=6100 Epoch=29.8] | Loss=0.15209 | Reg=0.00250 | acc=0.9219 | L2-Norm=15.816 | L2-Norm(final)=3.758 | 5492.0 samples/s | 85.8 steps/s
[Step=6150 Epoch=30.0] | Loss=0.14495 | Reg=0.00255 | acc=0.9375 | L2-Norm=15.953 | L2-Norm(final)=3.802 | 5586.0 samples/s | 87.3 steps/s
[Step=6200 Epoch=30.3] | Loss=0.14329 | Reg=0.00258 | acc=0.8750 | L2-Norm=16.066 | L2-Norm(final)=3.835 | 7681.1 samples/s | 120.0 steps/s
[Step=6250 Epoch=30.5] | Loss=0.13897 | Reg=0.00261 | acc=0.7812 | L2-Norm=16.166 | L2-Norm(final)=3.865 | 1927.7 samples/s | 30.1 steps/s
[Step=6300 Epoch=30.7] | Loss=0.13664 | Reg=0.00265 | acc=0.7969 | L2-Norm=16.260 | L2-Norm(final)=3.895 | 5560.2 samples/s | 86.9 steps/s
[Step=6350 Epoch=31.0] | Loss=0.13429 | Reg=0.00267 | acc=0.8594 | L2-Norm=16.342 | L2-Norm(final)=3.922 | 5564.0 samples/s | 86.9 steps/s
[Step=6400 Epoch=31.2] | Loss=0.13303 | Reg=0.00270 | acc=0.8281 | L2-Norm=16.417 | L2-Norm(final)=3.947 | 7168.3 samples/s | 112.0 steps/s
[Step=6450 Epoch=31.5] | Loss=0.13148 | Reg=0.00272 | acc=0.9219 | L2-Norm=16.493 | L2-Norm(final)=3.971 | 1962.7 samples/s | 30.7 steps/s
[Step=6500 Epoch=31.7] | Loss=0.12926 | Reg=0.00275 | acc=0.8906 | L2-Norm=16.571 | L2-Norm(final)=3.996 | 5436.2 samples/s | 84.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=31.7] | Loss=0.08050 | Reg=0.00300 | acc=0.9531 | L2-Norm=17.333 | L2-Norm(final)=4.251 | 3963.8 samples/s | 61.9 steps/s
[Step=6550 Epoch=32.0] | Loss=0.13488 | Reg=0.00302 | acc=0.9219 | L2-Norm=17.385 | L2-Norm(final)=4.241 | 4827.4 samples/s | 75.4 steps/s
[Step=6600 Epoch=32.2] | Loss=0.12662 | Reg=0.00303 | acc=0.9531 | L2-Norm=17.417 | L2-Norm(final)=4.222 | 4897.9 samples/s | 76.5 steps/s
[Step=6650 Epoch=32.4] | Loss=0.11871 | Reg=0.00304 | acc=0.8750 | L2-Norm=17.439 | L2-Norm(final)=4.212 | 4974.5 samples/s | 77.7 steps/s
[Step=6700 Epoch=32.7] | Loss=0.11172 | Reg=0.00305 | acc=0.9688 | L2-Norm=17.456 | L2-Norm(final)=4.205 | 6602.0 samples/s | 103.2 steps/s
[Step=6750 Epoch=32.9] | Loss=0.10064 | Reg=0.00305 | acc=0.9688 | L2-Norm=17.475 | L2-Norm(final)=4.202 | 1860.3 samples/s | 29.1 steps/s
[Step=6800 Epoch=33.2] | Loss=0.09440 | Reg=0.00306 | acc=0.9531 | L2-Norm=17.494 | L2-Norm(final)=4.202 | 4940.3 samples/s | 77.2 steps/s
[Step=6850 Epoch=33.4] | Loss=0.08751 | Reg=0.00307 | acc=0.9844 | L2-Norm=17.511 | L2-Norm(final)=4.203 | 4922.2 samples/s | 76.9 steps/s
[Step=6900 Epoch=33.7] | Loss=0.08332 | Reg=0.00307 | acc=0.9844 | L2-Norm=17.530 | L2-Norm(final)=4.205 | 6265.2 samples/s | 97.9 steps/s
[Step=6950 Epoch=33.9] | Loss=0.07833 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.547 | L2-Norm(final)=4.206 | 1904.6 samples/s | 29.8 steps/s
[Step=7000 Epoch=34.2] | Loss=0.07369 | Reg=0.00308 | acc=0.9688 | L2-Norm=17.563 | L2-Norm(final)=4.209 | 4745.8 samples/s | 74.2 steps/s
[Step=7050 Epoch=34.4] | Loss=0.06977 | Reg=0.00309 | acc=0.9375 | L2-Norm=17.579 | L2-Norm(final)=4.213 | 4864.3 samples/s | 76.0 steps/s
[Step=7100 Epoch=34.6] | Loss=0.06799 | Reg=0.00310 | acc=0.9531 | L2-Norm=17.596 | L2-Norm(final)=4.215 | 5849.2 samples/s | 91.4 steps/s
[Step=7150 Epoch=34.9] | Loss=0.06529 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.611 | L2-Norm(final)=4.217 | 1892.3 samples/s | 29.6 steps/s
[Step=7200 Epoch=35.1] | Loss=0.06256 | Reg=0.00311 | acc=0.9531 | L2-Norm=17.625 | L2-Norm(final)=4.219 | 4926.2 samples/s | 77.0 steps/s
[Step=7250 Epoch=35.4] | Loss=0.06008 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.638 | L2-Norm(final)=4.222 | 4845.8 samples/s | 75.7 steps/s
[Step=7300 Epoch=35.6] | Loss=0.05798 | Reg=0.00312 | acc=0.9531 | L2-Norm=17.649 | L2-Norm(final)=4.224 | 5381.7 samples/s | 84.1 steps/s
[Step=7350 Epoch=35.9] | Loss=0.05587 | Reg=0.00312 | acc=0.9844 | L2-Norm=17.661 | L2-Norm(final)=4.227 | 1959.2 samples/s | 30.6 steps/s
[Step=7400 Epoch=36.1] | Loss=0.05472 | Reg=0.00312 | acc=0.9844 | L2-Norm=17.673 | L2-Norm(final)=4.229 | 4960.8 samples/s | 77.5 steps/s
[Step=7450 Epoch=36.4] | Loss=0.05335 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.685 | L2-Norm(final)=4.230 | 4833.9 samples/s | 75.5 steps/s
[Step=7500 Epoch=36.6] | Loss=0.05196 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.697 | L2-Norm(final)=4.231 | 5103.1 samples/s | 79.7 steps/s
[Step=7550 Epoch=36.8] | Loss=0.05045 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.708 | L2-Norm(final)=4.232 | 2009.6 samples/s | 31.4 steps/s
[Step=7600 Epoch=37.1] | Loss=0.04913 | Reg=0.00314 | acc=0.9688 | L2-Norm=17.719 | L2-Norm(final)=4.234 | 4856.6 samples/s | 75.9 steps/s
[Step=7650 Epoch=37.3] | Loss=0.04807 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.728 | L2-Norm(final)=4.235 | 4832.1 samples/s | 75.5 steps/s
[Step=7700 Epoch=37.6] | Loss=0.04697 | Reg=0.00315 | acc=0.9688 | L2-Norm=17.737 | L2-Norm(final)=4.236 | 5013.6 samples/s | 78.3 steps/s
[Step=7750 Epoch=37.8] | Loss=0.04592 | Reg=0.00315 | acc=0.9531 | L2-Norm=17.746 | L2-Norm(final)=4.237 | 2055.8 samples/s | 32.1 steps/s
[Step=7800 Epoch=38.1] | Loss=0.04496 | Reg=0.00315 | acc=0.9844 | L2-Norm=17.756 | L2-Norm(final)=4.238 | 4917.1 samples/s | 76.8 steps/s
[Step=7850 Epoch=38.3] | Loss=0.04400 | Reg=0.00316 | acc=0.9844 | L2-Norm=17.766 | L2-Norm(final)=4.239 | 4938.0 samples/s | 77.2 steps/s
[Step=7900 Epoch=38.5] | Loss=0.04331 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.775 | L2-Norm(final)=4.240 | 4949.7 samples/s | 77.3 steps/s
[Step=7950 Epoch=38.8] | Loss=0.04249 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.785 | L2-Norm(final)=4.242 | 2053.9 samples/s | 32.1 steps/s
[Step=8000 Epoch=39.0] | Loss=0.04165 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.794 | L2-Norm(final)=4.243 | 4981.3 samples/s | 77.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step8000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=2001 Epoch= 9.7] | Loss=0.27337 | Reg=0.00234 | acc=0.6875 | L2-Norm=15.302 | L2-Norm(final)=3.009 | 4078.8 samples/s | 63.7 steps/s
[Step=2050 Epoch=10.0] | Loss=0.19174 | Reg=0.00248 | acc=0.8906 | L2-Norm=15.753 | L2-Norm(final)=3.066 | 5040.8 samples/s | 78.8 steps/s
[Step=2100 Epoch=10.2] | Loss=0.17880 | Reg=0.00257 | acc=0.9219 | L2-Norm=16.015 | L2-Norm(final)=3.114 | 5514.2 samples/s | 86.2 steps/s
[Step=2150 Epoch=10.5] | Loss=0.17045 | Reg=0.00263 | acc=0.8281 | L2-Norm=16.199 | L2-Norm(final)=3.152 | 5531.6 samples/s | 86.4 steps/s
[Step=2200 Epoch=10.7] | Loss=0.16495 | Reg=0.00267 | acc=0.8281 | L2-Norm=16.344 | L2-Norm(final)=3.181 | 7659.8 samples/s | 119.7 steps/s
[Step=2250 Epoch=11.0] | Loss=0.15907 | Reg=0.00271 | acc=0.8594 | L2-Norm=16.468 | L2-Norm(final)=3.209 | 1891.0 samples/s | 29.5 steps/s
[Step=2300 Epoch=11.2] | Loss=0.15568 | Reg=0.00275 | acc=0.8281 | L2-Norm=16.575 | L2-Norm(final)=3.236 | 5333.5 samples/s | 83.3 steps/s
[Step=2350 Epoch=11.5] | Loss=0.15273 | Reg=0.00278 | acc=0.8750 | L2-Norm=16.672 | L2-Norm(final)=3.264 | 5347.5 samples/s | 83.6 steps/s
[Step=2400 Epoch=11.7] | Loss=0.15045 | Reg=0.00281 | acc=0.8750 | L2-Norm=16.760 | L2-Norm(final)=3.291 | 7123.0 samples/s | 111.3 steps/s
[Step=2450 Epoch=11.9] | Loss=0.14737 | Reg=0.00284 | acc=0.8906 | L2-Norm=16.842 | L2-Norm(final)=3.319 | 1966.7 samples/s | 30.7 steps/s
[Step=2500 Epoch=12.2] | Loss=0.14502 | Reg=0.00287 | acc=0.8594 | L2-Norm=16.923 | L2-Norm(final)=3.349 | 5541.6 samples/s | 86.6 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.2] | Loss=0.13712 | Reg=0.00314 | acc=0.8594 | L2-Norm=17.707 | L2-Norm(final)=3.643 | 3730.5 samples/s | 58.3 steps/s
[Step=2550 Epoch=12.4] | Loss=0.13145 | Reg=0.00315 | acc=0.8750 | L2-Norm=17.751 | L2-Norm(final)=3.642 | 4979.6 samples/s | 77.8 steps/s
[Step=2600 Epoch=12.7] | Loss=0.12741 | Reg=0.00316 | acc=0.8594 | L2-Norm=17.773 | L2-Norm(final)=3.624 | 5043.4 samples/s | 78.8 steps/s
[Step=2650 Epoch=12.9] | Loss=0.11787 | Reg=0.00317 | acc=0.9219 | L2-Norm=17.791 | L2-Norm(final)=3.617 | 4810.6 samples/s | 75.2 steps/s
[Step=2700 Epoch=13.2] | Loss=0.11184 | Reg=0.00317 | acc=0.8906 | L2-Norm=17.810 | L2-Norm(final)=3.612 | 6395.2 samples/s | 99.9 steps/s
[Step=2750 Epoch=13.4] | Loss=0.10038 | Reg=0.00318 | acc=0.9219 | L2-Norm=17.829 | L2-Norm(final)=3.610 | 1846.3 samples/s | 28.8 steps/s
[Step=2800 Epoch=13.6] | Loss=0.09291 | Reg=0.00319 | acc=0.9688 | L2-Norm=17.852 | L2-Norm(final)=3.612 | 4900.5 samples/s | 76.6 steps/s
[Step=2850 Epoch=13.9] | Loss=0.08760 | Reg=0.00319 | acc=0.9531 | L2-Norm=17.874 | L2-Norm(final)=3.615 | 5007.6 samples/s | 78.2 steps/s
[Step=2900 Epoch=14.1] | Loss=0.08374 | Reg=0.00320 | acc=0.9375 | L2-Norm=17.894 | L2-Norm(final)=3.617 | 5877.3 samples/s | 91.8 steps/s
[Step=2950 Epoch=14.4] | Loss=0.07900 | Reg=0.00321 | acc=0.9688 | L2-Norm=17.916 | L2-Norm(final)=3.619 | 1913.6 samples/s | 29.9 steps/s
[Step=3000 Epoch=14.6] | Loss=0.07413 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.934 | L2-Norm(final)=3.624 | 4846.6 samples/s | 75.7 steps/s
[Step=3050 Epoch=14.9] | Loss=0.07119 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.951 | L2-Norm(final)=3.628 | 4831.8 samples/s | 75.5 steps/s
[Step=3100 Epoch=15.1] | Loss=0.06964 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.968 | L2-Norm(final)=3.632 | 5600.6 samples/s | 87.5 steps/s
[Step=3150 Epoch=15.3] | Loss=0.06668 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.986 | L2-Norm(final)=3.635 | 1922.1 samples/s | 30.0 steps/s
[Step=3200 Epoch=15.6] | Loss=0.06401 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.004 | L2-Norm(final)=3.639 | 4930.4 samples/s | 77.0 steps/s
[Step=3250 Epoch=15.8] | Loss=0.06171 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.020 | L2-Norm(final)=3.643 | 4946.9 samples/s | 77.3 steps/s
[Step=3300 Epoch=16.1] | Loss=0.06035 | Reg=0.00325 | acc=0.8906 | L2-Norm=18.036 | L2-Norm(final)=3.647 | 5350.4 samples/s | 83.6 steps/s
[Step=3350 Epoch=16.3] | Loss=0.05825 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.051 | L2-Norm(final)=3.650 | 1981.9 samples/s | 31.0 steps/s
[Step=3400 Epoch=16.6] | Loss=0.05645 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.066 | L2-Norm(final)=3.654 | 4990.3 samples/s | 78.0 steps/s
[Step=3450 Epoch=16.8] | Loss=0.05485 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.079 | L2-Norm(final)=3.657 | 4895.0 samples/s | 76.5 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05333 | Reg=0.00327 | acc=0.9844 | L2-Norm=18.091 | L2-Norm(final)=3.660 | 5056.8 samples/s | 79.0 steps/s
[Step=3550 Epoch=17.3] | Loss=0.05193 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.102 | L2-Norm(final)=3.663 | 2006.0 samples/s | 31.3 steps/s
[Step=3600 Epoch=17.5] | Loss=0.05054 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.113 | L2-Norm(final)=3.665 | 4963.0 samples/s | 77.5 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04928 | Reg=0.00328 | acc=0.9844 | L2-Norm=18.123 | L2-Norm(final)=3.668 | 4898.8 samples/s | 76.5 steps/s
[Step=3700 Epoch=18.0] | Loss=0.04794 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.134 | L2-Norm(final)=3.671 | 4860.9 samples/s | 76.0 steps/s
[Step=3750 Epoch=18.3] | Loss=0.04701 | Reg=0.00329 | acc=0.9688 | L2-Norm=18.143 | L2-Norm(final)=3.673 | 2027.2 samples/s | 31.7 steps/s
[Step=3800 Epoch=18.5] | Loss=0.04588 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.151 | L2-Norm(final)=3.676 | 4840.7 samples/s | 75.6 steps/s
[Step=3850 Epoch=18.8] | Loss=0.04491 | Reg=0.00330 | acc=0.9688 | L2-Norm=18.159 | L2-Norm(final)=3.678 | 4980.4 samples/s | 77.8 steps/s
[Step=3900 Epoch=19.0] | Loss=0.04418 | Reg=0.00330 | acc=0.9844 | L2-Norm=18.167 | L2-Norm(final)=3.681 | 5013.3 samples/s | 78.3 steps/s
[Step=3950 Epoch=19.2] | Loss=0.04335 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.176 | L2-Norm(final)=3.683 | 2067.1 samples/s | 32.3 steps/s
[Step=4000 Epoch=19.5] | Loss=0.04265 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.185 | L2-Norm(final)=3.685 | 4914.2 samples/s | 76.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step4000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=2001 Epoch= 9.8] | Loss=0.27690 | Reg=0.00234 | acc=0.7031 | L2-Norm=15.302 | L2-Norm(final)=2.831 | 4006.8 samples/s | 62.6 steps/s
[Step=2050 Epoch=10.1] | Loss=0.17349 | Reg=0.00251 | acc=0.8438 | L2-Norm=15.834 | L2-Norm(final)=2.922 | 5379.0 samples/s | 84.0 steps/s
[Step=2100 Epoch=10.3] | Loss=0.15844 | Reg=0.00260 | acc=0.9219 | L2-Norm=16.134 | L2-Norm(final)=2.981 | 5518.9 samples/s | 86.2 steps/s
[Step=2150 Epoch=10.5] | Loss=0.15378 | Reg=0.00266 | acc=0.9375 | L2-Norm=16.306 | L2-Norm(final)=3.023 | 5656.3 samples/s | 88.4 steps/s
[Step=2200 Epoch=10.8] | Loss=0.14730 | Reg=0.00270 | acc=0.8906 | L2-Norm=16.440 | L2-Norm(final)=3.061 | 7658.6 samples/s | 119.7 steps/s
[Step=2250 Epoch=11.0] | Loss=0.14361 | Reg=0.00274 | acc=0.8594 | L2-Norm=16.555 | L2-Norm(final)=3.095 | 1894.5 samples/s | 29.6 steps/s
[Step=2300 Epoch=11.3] | Loss=0.13915 | Reg=0.00278 | acc=0.9219 | L2-Norm=16.660 | L2-Norm(final)=3.128 | 5623.9 samples/s | 87.9 steps/s
[Step=2350 Epoch=11.5] | Loss=0.13716 | Reg=0.00281 | acc=0.8906 | L2-Norm=16.757 | L2-Norm(final)=3.162 | 5473.4 samples/s | 85.5 steps/s
[Step=2400 Epoch=11.8] | Loss=0.13592 | Reg=0.00284 | acc=0.8906 | L2-Norm=16.846 | L2-Norm(final)=3.192 | 7400.7 samples/s | 115.6 steps/s
[Step=2450 Epoch=12.0] | Loss=0.13359 | Reg=0.00287 | acc=0.8750 | L2-Norm=16.930 | L2-Norm(final)=3.220 | 1904.9 samples/s | 29.8 steps/s
[Step=2500 Epoch=12.3] | Loss=0.13150 | Reg=0.00290 | acc=0.9219 | L2-Norm=17.009 | L2-Norm(final)=3.248 | 5314.3 samples/s | 83.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.3] | Loss=0.08293 | Reg=0.00316 | acc=0.9062 | L2-Norm=17.771 | L2-Norm(final)=3.523 | 3856.7 samples/s | 60.3 steps/s
[Step=2550 Epoch=12.5] | Loss=0.13865 | Reg=0.00317 | acc=0.9219 | L2-Norm=17.807 | L2-Norm(final)=3.510 | 4838.6 samples/s | 75.6 steps/s
[Step=2600 Epoch=12.7] | Loss=0.12331 | Reg=0.00317 | acc=0.9219 | L2-Norm=17.816 | L2-Norm(final)=3.500 | 4954.2 samples/s | 77.4 steps/s
[Step=2650 Epoch=13.0] | Loss=0.11280 | Reg=0.00318 | acc=0.9375 | L2-Norm=17.824 | L2-Norm(final)=3.493 | 4954.3 samples/s | 77.4 steps/s
[Step=2700 Epoch=13.2] | Loss=0.10707 | Reg=0.00318 | acc=0.9062 | L2-Norm=17.829 | L2-Norm(final)=3.488 | 6715.4 samples/s | 104.9 steps/s
[Step=2750 Epoch=13.5] | Loss=0.09558 | Reg=0.00318 | acc=0.9688 | L2-Norm=17.839 | L2-Norm(final)=3.487 | 1854.3 samples/s | 29.0 steps/s
[Step=2800 Epoch=13.7] | Loss=0.08726 | Reg=0.00319 | acc=0.9531 | L2-Norm=17.851 | L2-Norm(final)=3.490 | 4873.1 samples/s | 76.1 steps/s
[Step=2850 Epoch=14.0] | Loss=0.08287 | Reg=0.00319 | acc=0.9688 | L2-Norm=17.861 | L2-Norm(final)=3.493 | 4826.4 samples/s | 75.4 steps/s
[Step=2900 Epoch=14.2] | Loss=0.07891 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.873 | L2-Norm(final)=3.495 | 6305.5 samples/s | 98.5 steps/s
[Step=2950 Epoch=14.5] | Loss=0.07361 | Reg=0.00320 | acc=0.9531 | L2-Norm=17.886 | L2-Norm(final)=3.498 | 1869.4 samples/s | 29.2 steps/s
[Step=3000 Epoch=14.7] | Loss=0.06934 | Reg=0.00320 | acc=0.9531 | L2-Norm=17.898 | L2-Norm(final)=3.503 | 4958.8 samples/s | 77.5 steps/s
[Step=3050 Epoch=15.0] | Loss=0.06664 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.909 | L2-Norm(final)=3.506 | 4952.1 samples/s | 77.4 steps/s
[Step=3100 Epoch=15.2] | Loss=0.06414 | Reg=0.00321 | acc=0.9375 | L2-Norm=17.920 | L2-Norm(final)=3.509 | 6032.9 samples/s | 94.3 steps/s
[Step=3150 Epoch=15.4] | Loss=0.06151 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.933 | L2-Norm(final)=3.512 | 1912.8 samples/s | 29.9 steps/s
[Step=3200 Epoch=15.7] | Loss=0.05949 | Reg=0.00322 | acc=0.9531 | L2-Norm=17.945 | L2-Norm(final)=3.514 | 4921.2 samples/s | 76.9 steps/s
[Step=3250 Epoch=15.9] | Loss=0.05725 | Reg=0.00322 | acc=0.9688 | L2-Norm=17.957 | L2-Norm(final)=3.517 | 5004.7 samples/s | 78.2 steps/s
[Step=3300 Epoch=16.2] | Loss=0.05529 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.967 | L2-Norm(final)=3.520 | 5736.2 samples/s | 89.6 steps/s
[Step=3350 Epoch=16.4] | Loss=0.05332 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.977 | L2-Norm(final)=3.523 | 1953.2 samples/s | 30.5 steps/s
[Step=3400 Epoch=16.7] | Loss=0.05125 | Reg=0.00324 | acc=0.9688 | L2-Norm=17.987 | L2-Norm(final)=3.526 | 4932.7 samples/s | 77.1 steps/s
[Step=3450 Epoch=16.9] | Loss=0.04947 | Reg=0.00324 | acc=0.9375 | L2-Norm=17.996 | L2-Norm(final)=3.530 | 4858.3 samples/s | 75.9 steps/s
[Step=3500 Epoch=17.2] | Loss=0.04825 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.005 | L2-Norm(final)=3.534 | 5589.9 samples/s | 87.3 steps/s
[Step=3550 Epoch=17.4] | Loss=0.04678 | Reg=0.00324 | acc=0.9375 | L2-Norm=18.012 | L2-Norm(final)=3.537 | 1976.4 samples/s | 30.9 steps/s
[Step=3600 Epoch=17.7] | Loss=0.04523 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.019 | L2-Norm(final)=3.539 | 4879.9 samples/s | 76.2 steps/s
[Step=3650 Epoch=17.9] | Loss=0.04419 | Reg=0.00325 | acc=0.9531 | L2-Norm=18.025 | L2-Norm(final)=3.542 | 4994.7 samples/s | 78.0 steps/s
[Step=3700 Epoch=18.1] | Loss=0.04346 | Reg=0.00325 | acc=0.9688 | L2-Norm=18.032 | L2-Norm(final)=3.545 | 5258.1 samples/s | 82.2 steps/s
[Step=3750 Epoch=18.4] | Loss=0.04265 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.039 | L2-Norm(final)=3.547 | 2019.7 samples/s | 31.6 steps/s
[Step=3800 Epoch=18.6] | Loss=0.04184 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.045 | L2-Norm(final)=3.549 | 4846.8 samples/s | 75.7 steps/s
[Step=3850 Epoch=18.9] | Loss=0.04092 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.051 | L2-Norm(final)=3.551 | 4917.1 samples/s | 76.8 steps/s
[Step=3900 Epoch=19.1] | Loss=0.04067 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.058 | L2-Norm(final)=3.553 | 5137.1 samples/s | 80.3 steps/s
[Step=3950 Epoch=19.4] | Loss=0.03993 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.067 | L2-Norm(final)=3.555 | 2033.4 samples/s | 31.8 steps/s
[Step=4000 Epoch=19.6] | Loss=0.03922 | Reg=0.00327 | acc=0.9844 | L2-Norm=18.076 | L2-Norm(final)=3.556 | 4977.9 samples/s | 77.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step4000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=4001 Epoch=38.1] | Loss=0.10003 | Reg=0.00234 | acc=0.9062 | L2-Norm=15.302 | L2-Norm(final)=3.628 | 3789.4 samples/s | 59.2 steps/s
[Step=4050 Epoch=38.5] | Loss=0.03910 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.673 | L2-Norm(final)=3.703 | 4942.5 samples/s | 77.2 steps/s
[Step=4100 Epoch=39.0] | Loss=0.03051 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.951 | L2-Norm(final)=3.770 | 7478.5 samples/s | 116.9 steps/s
[Step=4150 Epoch=39.5] | Loss=0.02753 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.150 | L2-Norm(final)=3.815 | 1862.0 samples/s | 29.1 steps/s
[Step=4200 Epoch=40.0] | Loss=0.02290 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.306 | L2-Norm(final)=3.859 | 6727.2 samples/s | 105.1 steps/s
[Step=4250 Epoch=40.4] | Loss=0.02010 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.421 | L2-Norm(final)=3.903 | 1881.2 samples/s | 29.4 steps/s
[Step=4300 Epoch=40.9] | Loss=0.01772 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.511 | L2-Norm(final)=3.945 | 6295.1 samples/s | 98.4 steps/s
[Step=4350 Epoch=41.4] | Loss=0.01611 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.590 | L2-Norm(final)=3.985 | 1954.8 samples/s | 30.5 steps/s
[Step=4400 Epoch=41.9] | Loss=0.01482 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.659 | L2-Norm(final)=4.023 | 5849.6 samples/s | 91.4 steps/s
[Step=4450 Epoch=42.3] | Loss=0.01355 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.715 | L2-Norm(final)=4.060 | 1961.6 samples/s | 30.7 steps/s
[Step=4500 Epoch=42.8] | Loss=0.01247 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.763 | L2-Norm(final)=4.095 | 5410.6 samples/s | 84.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=42.8] | Loss=0.00215 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.196 | L2-Norm(final)=4.444 | 3790.4 samples/s | 59.2 steps/s
[Step=4550 Epoch=43.3] | Loss=0.04293 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.303 | L2-Norm(final)=4.407 | 4456.4 samples/s | 69.6 steps/s
[Step=4600 Epoch=43.8] | Loss=0.02644 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.410 | L2-Norm(final)=4.372 | 6248.4 samples/s | 97.6 steps/s
[Step=4650 Epoch=44.2] | Loss=0.01809 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.432 | L2-Norm(final)=4.366 | 1810.2 samples/s | 28.3 steps/s
[Step=4700 Epoch=44.7] | Loss=0.01373 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.427 | L2-Norm(final)=4.366 | 5830.1 samples/s | 91.1 steps/s
[Step=4750 Epoch=45.2] | Loss=0.01102 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.408 | L2-Norm(final)=4.368 | 1833.4 samples/s | 28.6 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00920 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.384 | L2-Norm(final)=4.371 | 5542.2 samples/s | 86.6 steps/s
[Step=4850 Epoch=46.1] | Loss=0.00790 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.356 | L2-Norm(final)=4.373 | 1883.6 samples/s | 29.4 steps/s
[Step=4900 Epoch=46.6] | Loss=0.00692 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.325 | L2-Norm(final)=4.375 | 5095.9 samples/s | 79.6 steps/s
[Step=4950 Epoch=47.1] | Loss=0.00616 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.293 | L2-Norm(final)=4.377 | 1929.2 samples/s | 30.1 steps/s
[Step=5000 Epoch=47.6] | Loss=0.00555 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.261 | L2-Norm(final)=4.379 | 4866.1 samples/s | 76.0 steps/s
[Step=5050 Epoch=48.0] | Loss=0.00505 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.227 | L2-Norm(final)=4.381 | 1975.0 samples/s | 30.9 steps/s
[Step=5100 Epoch=48.5] | Loss=0.00463 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.193 | L2-Norm(final)=4.383 | 4794.3 samples/s | 74.9 steps/s
[Step=5150 Epoch=49.0] | Loss=0.00428 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.159 | L2-Norm(final)=4.384 | 1988.2 samples/s | 31.1 steps/s
[Step=5200 Epoch=49.5] | Loss=0.00397 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.125 | L2-Norm(final)=4.386 | 4805.5 samples/s | 75.1 steps/s
[Step=5250 Epoch=49.9] | Loss=0.00371 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.090 | L2-Norm(final)=4.387 | 2009.8 samples/s | 31.4 steps/s
[Step=5300 Epoch=50.4] | Loss=0.00348 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.056 | L2-Norm(final)=4.389 | 4798.5 samples/s | 75.0 steps/s
[Step=5350 Epoch=50.9] | Loss=0.00328 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.021 | L2-Norm(final)=4.390 | 2025.9 samples/s | 31.7 steps/s
[Step=5400 Epoch=51.4] | Loss=0.00310 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.986 | L2-Norm(final)=4.391 | 4550.4 samples/s | 71.1 steps/s
[Step=5450 Epoch=51.8] | Loss=0.00294 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.952 | L2-Norm(final)=4.393 | 6385.8 samples/s | 99.8 steps/s
[Step=5500 Epoch=52.3] | Loss=0.00279 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.917 | L2-Norm(final)=4.394 | 1774.0 samples/s | 27.7 steps/s
[Step=5550 Epoch=52.8] | Loss=0.00266 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.882 | L2-Norm(final)=4.395 | 6083.1 samples/s | 95.0 steps/s
[Step=5600 Epoch=53.3] | Loss=0.00254 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.847 | L2-Norm(final)=4.396 | 1821.4 samples/s | 28.5 steps/s
[Step=5650 Epoch=53.7] | Loss=0.00243 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.813 | L2-Norm(final)=4.397 | 5532.1 samples/s | 86.4 steps/s
[Step=5700 Epoch=54.2] | Loss=0.00233 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.778 | L2-Norm(final)=4.398 | 1847.3 samples/s | 28.9 steps/s
[Step=5750 Epoch=54.7] | Loss=0.00224 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.743 | L2-Norm(final)=4.400 | 5223.9 samples/s | 81.6 steps/s
[Step=5800 Epoch=55.2] | Loss=0.00215 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.708 | L2-Norm(final)=4.401 | 1919.9 samples/s | 30.0 steps/s
[Step=5850 Epoch=55.6] | Loss=0.00207 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.673 | L2-Norm(final)=4.402 | 4929.2 samples/s | 77.0 steps/s
[Step=5900 Epoch=56.1] | Loss=0.00200 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.639 | L2-Norm(final)=4.403 | 1958.5 samples/s | 30.6 steps/s
[Step=5950 Epoch=56.6] | Loss=0.00193 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.604 | L2-Norm(final)=4.404 | 4769.9 samples/s | 74.5 steps/s
[Step=6000 Epoch=57.1] | Loss=0.00187 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.569 | L2-Norm(final)=4.405 | 2003.6 samples/s | 31.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step6000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=4001 Epoch=38.2] | Loss=0.06455 | Reg=0.00234 | acc=0.9531 | L2-Norm=15.302 | L2-Norm(final)=3.762 | 3862.2 samples/s | 60.3 steps/s
[Step=4050 Epoch=38.7] | Loss=0.03300 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.686 | L2-Norm(final)=3.834 | 4962.8 samples/s | 77.5 steps/s
[Step=4100 Epoch=39.2] | Loss=0.02550 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.925 | L2-Norm(final)=3.894 | 7542.3 samples/s | 117.8 steps/s
[Step=4150 Epoch=39.6] | Loss=0.01991 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.076 | L2-Norm(final)=3.943 | 1866.8 samples/s | 29.2 steps/s
[Step=4200 Epoch=40.1] | Loss=0.01712 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.181 | L2-Norm(final)=3.991 | 6803.7 samples/s | 106.3 steps/s
[Step=4250 Epoch=40.6] | Loss=0.01539 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.266 | L2-Norm(final)=4.034 | 1921.6 samples/s | 30.0 steps/s
[Step=4300 Epoch=41.1] | Loss=0.01379 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.334 | L2-Norm(final)=4.075 | 6499.0 samples/s | 101.5 steps/s
[Step=4350 Epoch=41.5] | Loss=0.01245 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.386 | L2-Norm(final)=4.112 | 1927.6 samples/s | 30.1 steps/s
[Step=4400 Epoch=42.0] | Loss=0.01146 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.425 | L2-Norm(final)=4.148 | 6087.3 samples/s | 95.1 steps/s
[Step=4450 Epoch=42.5] | Loss=0.01047 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.460 | L2-Norm(final)=4.183 | 2005.7 samples/s | 31.3 steps/s
[Step=4500 Epoch=43.0] | Loss=0.00977 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.489 | L2-Norm(final)=4.217 | 5704.3 samples/s | 89.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=43.0] | Loss=0.00264 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.761 | L2-Norm(final)=4.547 | 3756.4 samples/s | 58.7 steps/s
[Step=4550 Epoch=43.4] | Loss=0.05287 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.876 | L2-Norm(final)=4.491 | 4536.3 samples/s | 70.9 steps/s
[Step=4600 Epoch=43.9] | Loss=0.03017 | Reg=0.00289 | acc=0.9844 | L2-Norm=17.002 | L2-Norm(final)=4.444 | 6337.1 samples/s | 99.0 steps/s
[Step=4650 Epoch=44.4] | Loss=0.02039 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.032 | L2-Norm(final)=4.435 | 1801.4 samples/s | 28.1 steps/s
[Step=4700 Epoch=44.9] | Loss=0.01535 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.031 | L2-Norm(final)=4.433 | 5961.4 samples/s | 93.1 steps/s
[Step=4750 Epoch=45.4] | Loss=0.01229 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.016 | L2-Norm(final)=4.432 | 1841.7 samples/s | 28.8 steps/s
[Step=4800 Epoch=45.8] | Loss=0.01025 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.995 | L2-Norm(final)=4.432 | 5704.5 samples/s | 89.1 steps/s
[Step=4850 Epoch=46.3] | Loss=0.00880 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.969 | L2-Norm(final)=4.433 | 1879.6 samples/s | 29.4 steps/s
[Step=4900 Epoch=46.8] | Loss=0.00770 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.941 | L2-Norm(final)=4.433 | 5104.0 samples/s | 79.7 steps/s
[Step=4950 Epoch=47.3] | Loss=0.00685 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.912 | L2-Norm(final)=4.434 | 1905.2 samples/s | 29.8 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00617 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.882 | L2-Norm(final)=4.434 | 5041.2 samples/s | 78.8 steps/s
[Step=5050 Epoch=48.2] | Loss=0.00561 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.852 | L2-Norm(final)=4.435 | 1938.6 samples/s | 30.3 steps/s
[Step=5100 Epoch=48.7] | Loss=0.00514 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.820 | L2-Norm(final)=4.436 | 4818.9 samples/s | 75.3 steps/s
[Step=5150 Epoch=49.2] | Loss=0.00475 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.789 | L2-Norm(final)=4.436 | 1997.3 samples/s | 31.2 steps/s
[Step=5200 Epoch=49.7] | Loss=0.00441 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.757 | L2-Norm(final)=4.437 | 4703.8 samples/s | 73.5 steps/s
[Step=5250 Epoch=50.1] | Loss=0.00412 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.725 | L2-Norm(final)=4.437 | 1975.1 samples/s | 30.9 steps/s
[Step=5300 Epoch=50.6] | Loss=0.00386 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.693 | L2-Norm(final)=4.438 | 4718.6 samples/s | 73.7 steps/s
[Step=5350 Epoch=51.1] | Loss=0.00364 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.661 | L2-Norm(final)=4.439 | 1994.0 samples/s | 31.2 steps/s
[Step=5400 Epoch=51.6] | Loss=0.00344 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.629 | L2-Norm(final)=4.439 | 4702.4 samples/s | 73.5 steps/s
[Step=5450 Epoch=52.0] | Loss=0.00326 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.597 | L2-Norm(final)=4.440 | 2022.1 samples/s | 31.6 steps/s
[Step=5500 Epoch=52.5] | Loss=0.00309 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.565 | L2-Norm(final)=4.441 | 4684.3 samples/s | 73.2 steps/s
[Step=5550 Epoch=53.0] | Loss=0.00295 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.533 | L2-Norm(final)=4.441 | 6953.9 samples/s | 108.7 steps/s
[Step=5600 Epoch=53.5] | Loss=0.00281 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.501 | L2-Norm(final)=4.442 | 1724.9 samples/s | 27.0 steps/s
[Step=5650 Epoch=54.0] | Loss=0.00269 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.469 | L2-Norm(final)=4.443 | 6498.4 samples/s | 101.5 steps/s
[Step=5700 Epoch=54.4] | Loss=0.00258 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.437 | L2-Norm(final)=4.444 | 1794.9 samples/s | 28.0 steps/s
[Step=5750 Epoch=54.9] | Loss=0.00248 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.404 | L2-Norm(final)=4.444 | 6077.0 samples/s | 95.0 steps/s
[Step=5800 Epoch=55.4] | Loss=0.00238 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.372 | L2-Norm(final)=4.445 | 1839.3 samples/s | 28.7 steps/s
[Step=5850 Epoch=55.9] | Loss=0.00229 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.340 | L2-Norm(final)=4.446 | 5669.8 samples/s | 88.6 steps/s
[Step=5900 Epoch=56.3] | Loss=0.00221 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.308 | L2-Norm(final)=4.447 | 1856.1 samples/s | 29.0 steps/s
[Step=5950 Epoch=56.8] | Loss=0.00214 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.276 | L2-Norm(final)=4.448 | 5340.2 samples/s | 83.4 steps/s
[Step=6000 Epoch=57.3] | Loss=0.00207 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.243 | L2-Norm(final)=4.449 | 1935.4 samples/s | 30.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step6000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.14942 | acc=0.9208 | tpr=0.9143 | fpr=0.0652 | 4313.3 samples/s | 16.8 steps/s
Avg test loss: 0.15422, Avg test acc: 0.91842, Avg tpr: 0.91292, Avg fpr: 0.06948, total FA: 542

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.16580 | acc=0.9286 | tpr=0.9500 | fpr=0.1179 | 4341.5 samples/s | 17.0 steps/s
Avg test loss: 0.16815, Avg test acc: 0.92776, Avg tpr: 0.94918, Avg fpr: 0.11934, total FA: 931

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.13645 | acc=0.9291 | tpr=0.9547 | fpr=0.1266 | 4407.1 samples/s | 17.2 steps/s
Avg test loss: 0.14233, Avg test acc: 0.92736, Avg tpr: 0.95331, Avg fpr: 0.12973, total FA: 1012

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.32229 | acc=0.6802 | tpr=0.9925 | fpr=0.9980 | 4332.6 samples/s | 16.9 steps/s
Avg test loss: 0.32090, Avg test acc: 0.68343, Avg tpr: 0.99318, Avg fpr: 0.99782, total FA: 7784

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.15870 | acc=0.9330 | tpr=0.9520 | fpr=0.1083 | 4342.9 samples/s | 17.0 steps/s
Avg test loss: 0.16215, Avg test acc: 0.93124, Avg tpr: 0.94993, Avg fpr: 0.10986, total FA: 857

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=3.87613 | acc=0.3195 | tpr=0.0175 | fpr=0.0245 | 4392.2 samples/s | 17.2 steps/s
Avg test loss: 3.87277, Avg test acc: 0.31781, Avg tpr: 0.01818, Avg fpr: 0.02320, total FA: 181

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=3.74634 | acc=0.3137 | tpr=0.0026 | fpr=0.0109 | 4425.7 samples/s | 17.3 steps/s
Avg test loss: 3.75324, Avg test acc: 0.31080, Avg tpr: 0.00239, Avg fpr: 0.01090, total FA: 85

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.01307 | acc=0.3155 | tpr=0.0113 | fpr=0.0240 | 4374.7 samples/s | 17.1 steps/s
Avg test loss: 4.02969, Avg test acc: 0.31244, Avg tpr: 0.01096, Avg fpr: 0.02448, total FA: 191

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=3.87061 | acc=0.3154 | tpr=0.0029 | fpr=0.0059 | 4424.0 samples/s | 17.3 steps/s
Avg test loss: 3.89015, Avg test acc: 0.31200, Avg tpr: 0.00245, Avg fpr: 0.00718, total FA: 56

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=3.83227 | acc=0.3166 | tpr=0.0116 | fpr=0.0211 | 4316.4 samples/s | 16.9 steps/s
Avg test loss: 3.82612, Avg test acc: 0.31509, Avg tpr: 0.01241, Avg fpr: 0.01923, total FA: 150

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.87972 | acc=0.1511 | tpr=0.7434 | fpr=0.8596 | 4420.2 samples/s | 17.3 steps/s
[Step= 100] | Loss=3.85795 | acc=0.1523 | tpr=0.7207 | fpr=0.8583 | 8473.1 samples/s | 33.1 steps/s
[Step= 150] | Loss=3.86674 | acc=0.1509 | tpr=0.7205 | fpr=0.8596 | 9048.6 samples/s | 35.3 steps/s
[Step= 200] | Loss=3.86237 | acc=0.1510 | tpr=0.7191 | fpr=0.8593 | 8283.3 samples/s | 32.4 steps/s
[Step= 250] | Loss=3.86595 | acc=0.1507 | tpr=0.7144 | fpr=0.8596 | 9081.2 samples/s | 35.5 steps/s
[Step= 300] | Loss=3.86696 | acc=0.1501 | tpr=0.7062 | fpr=0.8601 | 8122.9 samples/s | 31.7 steps/s
[Step= 350] | Loss=3.85673 | acc=0.1503 | tpr=0.7026 | fpr=0.8598 | 8597.2 samples/s | 33.6 steps/s
[Step= 400] | Loss=3.85644 | acc=0.1506 | tpr=0.7068 | fpr=0.8595 | 8549.0 samples/s | 33.4 steps/s
[Step= 450] | Loss=3.85579 | acc=0.1507 | tpr=0.7074 | fpr=0.8594 | 8831.5 samples/s | 34.5 steps/s
[Step= 500] | Loss=3.85628 | acc=0.1507 | tpr=0.7066 | fpr=0.8593 | 8626.3 samples/s | 33.7 steps/s
[Step= 550] | Loss=3.85806 | acc=0.1506 | tpr=0.7083 | fpr=0.8595 | 15197.3 samples/s | 59.4 steps/s
Avg test loss: 3.85865, Avg test acc: 0.15050, Avg tpr: 0.70761, Avg fpr: 0.85963, total FA: 119358

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.35632 | acc=0.0898 | tpr=0.7566 | fpr=0.9221 | 4386.1 samples/s | 17.1 steps/s
[Step= 100] | Loss=5.37064 | acc=0.0889 | tpr=0.7058 | fpr=0.9226 | 8565.1 samples/s | 33.5 steps/s
[Step= 150] | Loss=5.38478 | acc=0.0893 | tpr=0.7118 | fpr=0.9221 | 8739.7 samples/s | 34.1 steps/s
[Step= 200] | Loss=5.38845 | acc=0.0901 | tpr=0.7137 | fpr=0.9212 | 8406.7 samples/s | 32.8 steps/s
[Step= 250] | Loss=5.38072 | acc=0.0905 | tpr=0.7153 | fpr=0.9208 | 8783.0 samples/s | 34.3 steps/s
[Step= 300] | Loss=5.38425 | acc=0.0909 | tpr=0.7164 | fpr=0.9205 | 8344.6 samples/s | 32.6 steps/s
[Step= 350] | Loss=5.38003 | acc=0.0909 | tpr=0.7132 | fpr=0.9204 | 8704.7 samples/s | 34.0 steps/s
[Step= 400] | Loss=5.38028 | acc=0.0909 | tpr=0.7095 | fpr=0.9204 | 8705.9 samples/s | 34.0 steps/s
[Step= 450] | Loss=5.38592 | acc=0.0909 | tpr=0.7137 | fpr=0.9204 | 8397.0 samples/s | 32.8 steps/s
[Step= 500] | Loss=5.38739 | acc=0.0907 | tpr=0.7137 | fpr=0.9206 | 9473.9 samples/s | 37.0 steps/s
[Step= 550] | Loss=5.38458 | acc=0.0909 | tpr=0.7127 | fpr=0.9204 | 13508.3 samples/s | 52.8 steps/s
Avg test loss: 5.38643, Avg test acc: 0.09085, Avg tpr: 0.71197, Avg fpr: 0.92044, total FA: 127801

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.01502 | acc=0.1042 | tpr=0.8053 | fpr=0.9084 | 4357.0 samples/s | 17.0 steps/s
[Step= 100] | Loss=4.02088 | acc=0.1019 | tpr=0.7932 | fpr=0.9110 | 8566.3 samples/s | 33.5 steps/s
[Step= 150] | Loss=4.02722 | acc=0.1023 | tpr=0.7925 | fpr=0.9104 | 8588.8 samples/s | 33.6 steps/s
[Step= 200] | Loss=4.03117 | acc=0.1023 | tpr=0.7781 | fpr=0.9100 | 8787.2 samples/s | 34.3 steps/s
[Step= 250] | Loss=4.03252 | acc=0.1023 | tpr=0.7747 | fpr=0.9099 | 8568.4 samples/s | 33.5 steps/s
[Step= 300] | Loss=4.03528 | acc=0.1015 | tpr=0.7745 | fpr=0.9108 | 8575.1 samples/s | 33.5 steps/s
[Step= 350] | Loss=4.03151 | acc=0.1011 | tpr=0.7727 | fpr=0.9111 | 8716.2 samples/s | 34.0 steps/s
[Step= 400] | Loss=4.02879 | acc=0.1017 | tpr=0.7702 | fpr=0.9105 | 8380.7 samples/s | 32.7 steps/s
[Step= 450] | Loss=4.03137 | acc=0.1016 | tpr=0.7722 | fpr=0.9106 | 8695.8 samples/s | 34.0 steps/s
[Step= 500] | Loss=4.03281 | acc=0.1014 | tpr=0.7727 | fpr=0.9108 | 8679.4 samples/s | 33.9 steps/s
[Step= 550] | Loss=4.03572 | acc=0.1014 | tpr=0.7764 | fpr=0.9109 | 15487.3 samples/s | 60.5 steps/s
Avg test loss: 4.03664, Avg test acc: 0.10131, Avg tpr: 0.77536, Avg fpr: 0.91095, total FA: 126483

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=0.49347 | acc=0.0224 | tpr=1.0000 | fpr=0.9951 | 4389.8 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.49431 | acc=0.0224 | tpr=1.0000 | fpr=0.9958 | 8456.1 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.49466 | acc=0.0221 | tpr=1.0000 | fpr=0.9959 | 8685.6 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.49447 | acc=0.0218 | tpr=1.0000 | fpr=0.9960 | 8549.5 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.49484 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8783.5 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.49501 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8955.7 samples/s | 35.0 steps/s
[Step= 350] | Loss=0.49495 | acc=0.0215 | tpr=1.0000 | fpr=0.9962 | 8270.8 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.49496 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8542.7 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.49497 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 8552.8 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.49508 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 8615.2 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.49497 | acc=0.0215 | tpr=1.0000 | fpr=0.9963 | 15350.0 samples/s | 60.0 steps/s
Avg test loss: 0.49495, Avg test acc: 0.02145, Avg tpr: 1.00000, Avg fpr: 0.99633, total FA: 138339

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.16092 | acc=0.1114 | tpr=0.6593 | fpr=0.8984 | 4368.4 samples/s | 17.1 steps/s
[Step= 100] | Loss=5.12981 | acc=0.1119 | tpr=0.5970 | fpr=0.8972 | 8767.6 samples/s | 34.2 steps/s
[Step= 150] | Loss=5.13348 | acc=0.1116 | tpr=0.5965 | fpr=0.8973 | 8386.0 samples/s | 32.8 steps/s
[Step= 200] | Loss=5.11942 | acc=0.1128 | tpr=0.6066 | fpr=0.8962 | 8940.8 samples/s | 34.9 steps/s
[Step= 250] | Loss=5.12177 | acc=0.1131 | tpr=0.6131 | fpr=0.8960 | 8674.2 samples/s | 33.9 steps/s
[Step= 300] | Loss=5.11989 | acc=0.1130 | tpr=0.6196 | fpr=0.8962 | 8367.0 samples/s | 32.7 steps/s
[Step= 350] | Loss=5.11416 | acc=0.1133 | tpr=0.6187 | fpr=0.8959 | 8505.9 samples/s | 33.2 steps/s
[Step= 400] | Loss=5.11011 | acc=0.1135 | tpr=0.6160 | fpr=0.8956 | 8753.3 samples/s | 34.2 steps/s
[Step= 450] | Loss=5.11024 | acc=0.1132 | tpr=0.6154 | fpr=0.8959 | 8547.7 samples/s | 33.4 steps/s
[Step= 500] | Loss=5.11129 | acc=0.1132 | tpr=0.6106 | fpr=0.8958 | 8541.3 samples/s | 33.4 steps/s
[Step= 550] | Loss=5.11038 | acc=0.1134 | tpr=0.6168 | fpr=0.8958 | 15735.1 samples/s | 61.5 steps/s
Avg test loss: 5.11029, Avg test acc: 0.11327, Avg tpr: 0.61688, Avg fpr: 0.89589, total FA: 124392

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.05105 | acc=0.9795 | tpr=0.8053 | fpr=0.0173 | 4347.2 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.04880 | acc=0.9795 | tpr=0.8124 | fpr=0.0173 | 8655.3 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.04998 | acc=0.9793 | tpr=0.8112 | fpr=0.0176 | 8648.7 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.05094 | acc=0.9792 | tpr=0.8219 | fpr=0.0179 | 9167.8 samples/s | 35.8 steps/s
[Step= 250] | Loss=0.05087 | acc=0.9793 | tpr=0.8183 | fpr=0.0178 | 7816.5 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.05156 | acc=0.9790 | tpr=0.8145 | fpr=0.0180 | 8671.3 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.05108 | acc=0.9791 | tpr=0.8178 | fpr=0.0180 | 8673.8 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.05154 | acc=0.9789 | tpr=0.8129 | fpr=0.0181 | 8581.3 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.05234 | acc=0.9787 | tpr=0.8116 | fpr=0.0183 | 8595.4 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.05192 | acc=0.9789 | tpr=0.8145 | fpr=0.0182 | 8541.6 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.05123 | acc=0.9790 | tpr=0.8158 | fpr=0.0181 | 16109.3 samples/s | 62.9 steps/s
Avg test loss: 0.05119, Avg test acc: 0.97894, Avg tpr: 0.81498, Avg fpr: 0.01808, total FA: 2510

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.08623 | acc=0.9820 | tpr=0.8496 | fpr=0.0157 | 4380.2 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.09151 | acc=0.9819 | tpr=0.8657 | fpr=0.0160 | 9051.9 samples/s | 35.4 steps/s
[Step= 150] | Loss=0.09240 | acc=0.9815 | tpr=0.8718 | fpr=0.0165 | 7742.9 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.09408 | acc=0.9812 | tpr=0.8721 | fpr=0.0168 | 8631.9 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.09257 | acc=0.9816 | tpr=0.8716 | fpr=0.0164 | 8773.7 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.09386 | acc=0.9815 | tpr=0.8727 | fpr=0.0165 | 8369.8 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.09502 | acc=0.9814 | tpr=0.8729 | fpr=0.0167 | 8718.8 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.09638 | acc=0.9812 | tpr=0.8643 | fpr=0.0167 | 8634.3 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.09734 | acc=0.9811 | tpr=0.8661 | fpr=0.0168 | 8573.3 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.09720 | acc=0.9811 | tpr=0.8661 | fpr=0.0169 | 8384.3 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.09671 | acc=0.9811 | tpr=0.8647 | fpr=0.0168 | 15673.6 samples/s | 61.2 steps/s
Avg test loss: 0.09650, Avg test acc: 0.98113, Avg tpr: 0.86529, Avg fpr: 0.01676, total FA: 2327

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.09216 | acc=0.9791 | tpr=0.8717 | fpr=0.0190 | 4361.7 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.09498 | acc=0.9789 | tpr=0.8870 | fpr=0.0194 | 8754.9 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.09606 | acc=0.9778 | tpr=0.8934 | fpr=0.0206 | 8411.9 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.09801 | acc=0.9778 | tpr=0.8951 | fpr=0.0207 | 8536.7 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.09688 | acc=0.9779 | tpr=0.8952 | fpr=0.0206 | 8661.4 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.09902 | acc=0.9776 | tpr=0.8895 | fpr=0.0208 | 8699.5 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.09948 | acc=0.9776 | tpr=0.8898 | fpr=0.0209 | 8425.9 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.10019 | acc=0.9773 | tpr=0.8846 | fpr=0.0210 | 8714.7 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.10235 | acc=0.9770 | tpr=0.8846 | fpr=0.0213 | 8537.0 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.10159 | acc=0.9772 | tpr=0.8899 | fpr=0.0212 | 8357.8 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.10102 | acc=0.9773 | tpr=0.8898 | fpr=0.0211 | 15966.1 samples/s | 62.4 steps/s
Avg test loss: 0.10093, Avg test acc: 0.97726, Avg tpr: 0.88986, Avg fpr: 0.02115, total FA: 2937

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.06523 | acc=0.9823 | tpr=0.8451 | fpr=0.0153 | 4428.4 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.06659 | acc=0.9823 | tpr=0.8699 | fpr=0.0156 | 8255.9 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.06746 | acc=0.9816 | tpr=0.8775 | fpr=0.0164 | 8795.2 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.06773 | acc=0.9816 | tpr=0.8798 | fpr=0.0166 | 8456.1 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.06656 | acc=0.9818 | tpr=0.8760 | fpr=0.0163 | 8438.8 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.06784 | acc=0.9814 | tpr=0.8698 | fpr=0.0166 | 8666.4 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.06780 | acc=0.9813 | tpr=0.8710 | fpr=0.0167 | 8856.1 samples/s | 34.6 steps/s
[Step= 400] | Loss=0.06843 | acc=0.9811 | tpr=0.8660 | fpr=0.0168 | 8572.8 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.06975 | acc=0.9808 | tpr=0.8642 | fpr=0.0171 | 8577.3 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.06955 | acc=0.9809 | tpr=0.8665 | fpr=0.0171 | 8707.7 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.06873 | acc=0.9811 | tpr=0.8679 | fpr=0.0169 | 14911.7 samples/s | 58.2 steps/s
Avg test loss: 0.06851, Avg test acc: 0.98109, Avg tpr: 0.86767, Avg fpr: 0.01685, total FA: 2340

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.06004 | acc=0.9784 | tpr=0.8009 | fpr=0.0185 | 4352.1 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.05947 | acc=0.9780 | tpr=0.8124 | fpr=0.0189 | 8598.1 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.06023 | acc=0.9770 | tpr=0.8141 | fpr=0.0200 | 9074.8 samples/s | 35.4 steps/s
[Step= 200] | Loss=0.06128 | acc=0.9771 | tpr=0.8197 | fpr=0.0200 | 8378.2 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.06088 | acc=0.9772 | tpr=0.8131 | fpr=0.0198 | 8508.5 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.06211 | acc=0.9769 | tpr=0.8080 | fpr=0.0200 | 8967.1 samples/s | 35.0 steps/s
[Step= 350] | Loss=0.06231 | acc=0.9768 | tpr=0.8109 | fpr=0.0202 | 8388.9 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.06297 | acc=0.9765 | tpr=0.8025 | fpr=0.0204 | 8445.8 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.06410 | acc=0.9763 | tpr=0.8033 | fpr=0.0206 | 8543.1 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.06354 | acc=0.9764 | tpr=0.8048 | fpr=0.0205 | 8471.2 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.06294 | acc=0.9766 | tpr=0.8062 | fpr=0.0203 | 15770.3 samples/s | 61.6 steps/s
Avg test loss: 0.06281, Avg test acc: 0.97657, Avg tpr: 0.80547, Avg fpr: 0.02032, total FA: 2822

server round 4/50

clients selected: [0 1 2 4 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.24324 | Reg=0.00228 | acc=0.7188 | L2-Norm=15.115 | L2-Norm(final)=3.541 | 3928.1 samples/s | 61.4 steps/s
[Step=4050 Epoch=19.7] | Loss=0.14827 | Reg=0.00249 | acc=0.9531 | L2-Norm=15.778 | L2-Norm(final)=3.648 | 5388.5 samples/s | 84.2 steps/s
[Step=4100 Epoch=20.0] | Loss=0.13514 | Reg=0.00262 | acc=0.8125 | L2-Norm=16.175 | L2-Norm(final)=3.712 | 5453.0 samples/s | 85.2 steps/s
[Step=4150 Epoch=20.2] | Loss=0.13190 | Reg=0.00271 | acc=0.9219 | L2-Norm=16.438 | L2-Norm(final)=3.760 | 5402.1 samples/s | 84.4 steps/s
[Step=4200 Epoch=20.5] | Loss=0.13036 | Reg=0.00278 | acc=0.8906 | L2-Norm=16.649 | L2-Norm(final)=3.798 | 7862.9 samples/s | 122.9 steps/s
[Step=4250 Epoch=20.7] | Loss=0.12676 | Reg=0.00284 | acc=0.9219 | L2-Norm=16.831 | L2-Norm(final)=3.833 | 1936.6 samples/s | 30.3 steps/s
[Step=4300 Epoch=21.0] | Loss=0.12368 | Reg=0.00289 | acc=0.9219 | L2-Norm=16.991 | L2-Norm(final)=3.866 | 5523.0 samples/s | 86.3 steps/s
[Step=4350 Epoch=21.2] | Loss=0.12148 | Reg=0.00294 | acc=0.9688 | L2-Norm=17.130 | L2-Norm(final)=3.897 | 5393.2 samples/s | 84.3 steps/s
[Step=4400 Epoch=21.5] | Loss=0.12033 | Reg=0.00298 | acc=0.8750 | L2-Norm=17.252 | L2-Norm(final)=3.926 | 7127.0 samples/s | 111.4 steps/s
[Step=4450 Epoch=21.7] | Loss=0.11822 | Reg=0.00302 | acc=0.8906 | L2-Norm=17.363 | L2-Norm(final)=3.954 | 1944.2 samples/s | 30.4 steps/s
[Step=4500 Epoch=21.9] | Loss=0.11658 | Reg=0.00306 | acc=0.9062 | L2-Norm=17.469 | L2-Norm(final)=3.984 | 5457.0 samples/s | 85.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=21.9] | Loss=0.09952 | Reg=0.00343 | acc=0.9219 | L2-Norm=18.509 | L2-Norm(final)=4.284 | 3985.7 samples/s | 62.3 steps/s
[Step=4550 Epoch=22.2] | Loss=0.11247 | Reg=0.00344 | acc=0.8906 | L2-Norm=18.553 | L2-Norm(final)=4.273 | 4821.7 samples/s | 75.3 steps/s
[Step=4600 Epoch=22.4] | Loss=0.10793 | Reg=0.00345 | acc=0.9688 | L2-Norm=18.575 | L2-Norm(final)=4.253 | 4954.6 samples/s | 77.4 steps/s
[Step=4650 Epoch=22.7] | Loss=0.10257 | Reg=0.00345 | acc=0.9062 | L2-Norm=18.584 | L2-Norm(final)=4.240 | 4946.8 samples/s | 77.3 steps/s
[Step=4700 Epoch=22.9] | Loss=0.09929 | Reg=0.00346 | acc=0.9062 | L2-Norm=18.595 | L2-Norm(final)=4.232 | 6572.4 samples/s | 102.7 steps/s
[Step=4750 Epoch=23.2] | Loss=0.09678 | Reg=0.00346 | acc=0.9688 | L2-Norm=18.614 | L2-Norm(final)=4.221 | 1874.8 samples/s | 29.3 steps/s
[Step=4800 Epoch=23.4] | Loss=0.09108 | Reg=0.00347 | acc=0.9844 | L2-Norm=18.635 | L2-Norm(final)=4.215 | 4937.4 samples/s | 77.1 steps/s
[Step=4850 Epoch=23.6] | Loss=0.08531 | Reg=0.00348 | acc=0.9531 | L2-Norm=18.653 | L2-Norm(final)=4.212 | 4935.1 samples/s | 77.1 steps/s
[Step=4900 Epoch=23.9] | Loss=0.08183 | Reg=0.00349 | acc=0.9688 | L2-Norm=18.670 | L2-Norm(final)=4.208 | 6164.8 samples/s | 96.3 steps/s
[Step=4950 Epoch=24.1] | Loss=0.07607 | Reg=0.00349 | acc=0.9688 | L2-Norm=18.681 | L2-Norm(final)=4.206 | 1922.5 samples/s | 30.0 steps/s
[Step=5000 Epoch=24.4] | Loss=0.07179 | Reg=0.00349 | acc=0.9688 | L2-Norm=18.692 | L2-Norm(final)=4.206 | 4947.2 samples/s | 77.3 steps/s
[Step=5050 Epoch=24.6] | Loss=0.06862 | Reg=0.00350 | acc=0.9531 | L2-Norm=18.701 | L2-Norm(final)=4.206 | 4971.1 samples/s | 77.7 steps/s
[Step=5100 Epoch=24.9] | Loss=0.06566 | Reg=0.00350 | acc=0.9844 | L2-Norm=18.709 | L2-Norm(final)=4.206 | 5593.5 samples/s | 87.4 steps/s
[Step=5150 Epoch=25.1] | Loss=0.06278 | Reg=0.00350 | acc=1.0000 | L2-Norm=18.718 | L2-Norm(final)=4.206 | 1918.0 samples/s | 30.0 steps/s
[Step=5200 Epoch=25.4] | Loss=0.06046 | Reg=0.00351 | acc=0.9844 | L2-Norm=18.725 | L2-Norm(final)=4.208 | 4916.4 samples/s | 76.8 steps/s
[Step=5250 Epoch=25.6] | Loss=0.05877 | Reg=0.00351 | acc=0.9688 | L2-Norm=18.733 | L2-Norm(final)=4.208 | 4910.3 samples/s | 76.7 steps/s
[Step=5300 Epoch=25.8] | Loss=0.05695 | Reg=0.00351 | acc=1.0000 | L2-Norm=18.742 | L2-Norm(final)=4.209 | 5381.1 samples/s | 84.1 steps/s
[Step=5350 Epoch=26.1] | Loss=0.05481 | Reg=0.00352 | acc=0.9844 | L2-Norm=18.749 | L2-Norm(final)=4.210 | 1999.6 samples/s | 31.2 steps/s
[Step=5400 Epoch=26.3] | Loss=0.05289 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.754 | L2-Norm(final)=4.211 | 5082.7 samples/s | 79.4 steps/s
[Step=5450 Epoch=26.6] | Loss=0.05119 | Reg=0.00352 | acc=0.9844 | L2-Norm=18.758 | L2-Norm(final)=4.212 | 4891.5 samples/s | 76.4 steps/s
[Step=5500 Epoch=26.8] | Loss=0.04987 | Reg=0.00352 | acc=0.9688 | L2-Norm=18.761 | L2-Norm(final)=4.212 | 5032.3 samples/s | 78.6 steps/s
[Step=5550 Epoch=27.1] | Loss=0.04845 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.762 | L2-Norm(final)=4.213 | 2051.7 samples/s | 32.1 steps/s
[Step=5600 Epoch=27.3] | Loss=0.04699 | Reg=0.00352 | acc=0.9844 | L2-Norm=18.763 | L2-Norm(final)=4.214 | 4840.6 samples/s | 75.6 steps/s
[Step=5650 Epoch=27.6] | Loss=0.04567 | Reg=0.00352 | acc=0.9844 | L2-Norm=18.762 | L2-Norm(final)=4.215 | 4931.8 samples/s | 77.1 steps/s
[Step=5700 Epoch=27.8] | Loss=0.04451 | Reg=0.00352 | acc=0.9688 | L2-Norm=18.762 | L2-Norm(final)=4.216 | 5011.9 samples/s | 78.3 steps/s
[Step=5750 Epoch=28.0] | Loss=0.04360 | Reg=0.00352 | acc=0.9688 | L2-Norm=18.760 | L2-Norm(final)=4.217 | 2044.7 samples/s | 31.9 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04246 | Reg=0.00352 | acc=0.9844 | L2-Norm=18.759 | L2-Norm(final)=4.218 | 5049.7 samples/s | 78.9 steps/s
[Step=5850 Epoch=28.5] | Loss=0.04141 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.758 | L2-Norm(final)=4.219 | 4953.2 samples/s | 77.4 steps/s
[Step=5900 Epoch=28.8] | Loss=0.04057 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.757 | L2-Norm(final)=4.220 | 4868.7 samples/s | 76.1 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03980 | Reg=0.00352 | acc=1.0000 | L2-Norm=18.756 | L2-Norm(final)=4.221 | 2060.2 samples/s | 32.2 steps/s
[Step=6000 Epoch=29.3] | Loss=0.03898 | Reg=0.00352 | acc=0.9844 | L2-Norm=18.755 | L2-Norm(final)=4.222 | 4861.2 samples/s | 76.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step6000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=8001 Epoch=39.0] | Loss=0.17208 | Reg=0.00228 | acc=0.8594 | L2-Norm=15.115 | L2-Norm(final)=4.269 | 3856.3 samples/s | 60.3 steps/s
[Step=8050 Epoch=39.3] | Loss=0.13180 | Reg=0.00237 | acc=0.8438 | L2-Norm=15.383 | L2-Norm(final)=4.354 | 5432.7 samples/s | 84.9 steps/s
[Step=8100 Epoch=39.5] | Loss=0.12654 | Reg=0.00243 | acc=0.8281 | L2-Norm=15.597 | L2-Norm(final)=4.415 | 5513.8 samples/s | 86.2 steps/s
[Step=8150 Epoch=39.8] | Loss=0.12320 | Reg=0.00248 | acc=0.9375 | L2-Norm=15.751 | L2-Norm(final)=4.454 | 5626.7 samples/s | 87.9 steps/s
[Step=8200 Epoch=40.0] | Loss=0.12252 | Reg=0.00252 | acc=0.9219 | L2-Norm=15.875 | L2-Norm(final)=4.490 | 7649.0 samples/s | 119.5 steps/s
[Step=8250 Epoch=40.3] | Loss=0.11933 | Reg=0.00256 | acc=0.9531 | L2-Norm=15.989 | L2-Norm(final)=4.522 | 1906.6 samples/s | 29.8 steps/s
[Step=8300 Epoch=40.5] | Loss=0.11632 | Reg=0.00259 | acc=0.9375 | L2-Norm=16.098 | L2-Norm(final)=4.555 | 5395.0 samples/s | 84.3 steps/s
[Step=8350 Epoch=40.7] | Loss=0.11497 | Reg=0.00263 | acc=0.9219 | L2-Norm=16.204 | L2-Norm(final)=4.588 | 5470.0 samples/s | 85.5 steps/s
[Step=8400 Epoch=41.0] | Loss=0.11425 | Reg=0.00266 | acc=0.9219 | L2-Norm=16.301 | L2-Norm(final)=4.618 | 7072.6 samples/s | 110.5 steps/s
[Step=8450 Epoch=41.2] | Loss=0.11205 | Reg=0.00269 | acc=0.9219 | L2-Norm=16.390 | L2-Norm(final)=4.646 | 1932.6 samples/s | 30.2 steps/s
[Step=8500 Epoch=41.5] | Loss=0.11031 | Reg=0.00272 | acc=0.9531 | L2-Norm=16.478 | L2-Norm(final)=4.678 | 5520.5 samples/s | 86.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=41.5] | Loss=0.06472 | Reg=0.00301 | acc=0.9688 | L2-Norm=17.354 | L2-Norm(final)=4.994 | 3903.1 samples/s | 61.0 steps/s
[Step=8550 Epoch=41.7] | Loss=0.12351 | Reg=0.00303 | acc=0.8594 | L2-Norm=17.403 | L2-Norm(final)=4.982 | 4854.6 samples/s | 75.9 steps/s
[Step=8600 Epoch=42.0] | Loss=0.11594 | Reg=0.00305 | acc=0.9219 | L2-Norm=17.459 | L2-Norm(final)=4.957 | 4886.9 samples/s | 76.4 steps/s
[Step=8650 Epoch=42.2] | Loss=0.10660 | Reg=0.00306 | acc=0.9219 | L2-Norm=17.501 | L2-Norm(final)=4.944 | 4972.9 samples/s | 77.7 steps/s
[Step=8700 Epoch=42.5] | Loss=0.09888 | Reg=0.00307 | acc=0.9219 | L2-Norm=17.530 | L2-Norm(final)=4.935 | 6447.6 samples/s | 100.7 steps/s
[Step=8750 Epoch=42.7] | Loss=0.08913 | Reg=0.00308 | acc=0.9688 | L2-Norm=17.560 | L2-Norm(final)=4.931 | 1860.8 samples/s | 29.1 steps/s
[Step=8800 Epoch=42.9] | Loss=0.08223 | Reg=0.00309 | acc=0.9531 | L2-Norm=17.589 | L2-Norm(final)=4.932 | 4912.1 samples/s | 76.8 steps/s
[Step=8850 Epoch=43.2] | Loss=0.07742 | Reg=0.00310 | acc=0.9531 | L2-Norm=17.615 | L2-Norm(final)=4.933 | 4829.8 samples/s | 75.5 steps/s
[Step=8900 Epoch=43.4] | Loss=0.07392 | Reg=0.00311 | acc=0.9531 | L2-Norm=17.640 | L2-Norm(final)=4.934 | 6152.5 samples/s | 96.1 steps/s
[Step=8950 Epoch=43.7] | Loss=0.06996 | Reg=0.00312 | acc=0.9844 | L2-Norm=17.665 | L2-Norm(final)=4.934 | 1884.0 samples/s | 29.4 steps/s
[Step=9000 Epoch=43.9] | Loss=0.06560 | Reg=0.00313 | acc=0.9375 | L2-Norm=17.687 | L2-Norm(final)=4.937 | 4929.4 samples/s | 77.0 steps/s
[Step=9050 Epoch=44.2] | Loss=0.06268 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.708 | L2-Norm(final)=4.939 | 4907.5 samples/s | 76.7 steps/s
[Step=9100 Epoch=44.4] | Loss=0.06041 | Reg=0.00314 | acc=0.9688 | L2-Norm=17.727 | L2-Norm(final)=4.941 | 5889.3 samples/s | 92.0 steps/s
[Step=9150 Epoch=44.6] | Loss=0.05762 | Reg=0.00315 | acc=0.9688 | L2-Norm=17.745 | L2-Norm(final)=4.942 | 1922.3 samples/s | 30.0 steps/s
[Step=9200 Epoch=44.9] | Loss=0.05541 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.762 | L2-Norm(final)=4.944 | 4828.4 samples/s | 75.4 steps/s
[Step=9250 Epoch=45.1] | Loss=0.05332 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.779 | L2-Norm(final)=4.946 | 4836.4 samples/s | 75.6 steps/s
[Step=9300 Epoch=45.4] | Loss=0.05182 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.796 | L2-Norm(final)=4.948 | 5550.4 samples/s | 86.7 steps/s
[Step=9350 Epoch=45.6] | Loss=0.05003 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.811 | L2-Norm(final)=4.949 | 1960.5 samples/s | 30.6 steps/s
[Step=9400 Epoch=45.9] | Loss=0.04826 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.824 | L2-Norm(final)=4.951 | 4891.7 samples/s | 76.4 steps/s
[Step=9450 Epoch=46.1] | Loss=0.04677 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.836 | L2-Norm(final)=4.953 | 4971.1 samples/s | 77.7 steps/s
[Step=9500 Epoch=46.4] | Loss=0.04558 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.847 | L2-Norm(final)=4.955 | 5213.2 samples/s | 81.5 steps/s
[Step=9550 Epoch=46.6] | Loss=0.04447 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.858 | L2-Norm(final)=4.957 | 2018.6 samples/s | 31.5 steps/s
[Step=9600 Epoch=46.8] | Loss=0.04327 | Reg=0.00319 | acc=0.9688 | L2-Norm=17.868 | L2-Norm(final)=4.959 | 4789.6 samples/s | 74.8 steps/s
[Step=9650 Epoch=47.1] | Loss=0.04245 | Reg=0.00320 | acc=0.9375 | L2-Norm=17.878 | L2-Norm(final)=4.960 | 4877.6 samples/s | 76.2 steps/s
[Step=9700 Epoch=47.3] | Loss=0.04168 | Reg=0.00320 | acc=0.9688 | L2-Norm=17.889 | L2-Norm(final)=4.961 | 4937.8 samples/s | 77.2 steps/s
[Step=9750 Epoch=47.6] | Loss=0.04087 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.900 | L2-Norm(final)=4.962 | 2040.6 samples/s | 31.9 steps/s
[Step=9800 Epoch=47.8] | Loss=0.03973 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.910 | L2-Norm(final)=4.962 | 5014.1 samples/s | 78.3 steps/s
[Step=9850 Epoch=48.1] | Loss=0.03875 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.920 | L2-Norm(final)=4.964 | 4913.0 samples/s | 76.8 steps/s
[Step=9900 Epoch=48.3] | Loss=0.03794 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.928 | L2-Norm(final)=4.965 | 4851.0 samples/s | 75.8 steps/s
[Step=9950 Epoch=48.6] | Loss=0.03717 | Reg=0.00322 | acc=0.9688 | L2-Norm=17.936 | L2-Norm(final)=4.967 | 2037.2 samples/s | 31.8 steps/s
[Step=10000 Epoch=48.8] | Loss=0.03644 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.944 | L2-Norm(final)=4.968 | 5062.3 samples/s | 79.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step10000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.20346 | Reg=0.00228 | acc=0.8438 | L2-Norm=15.115 | L2-Norm(final)=3.749 | 3934.1 samples/s | 61.5 steps/s
[Step=4050 Epoch=19.7] | Loss=0.15082 | Reg=0.00239 | acc=0.8906 | L2-Norm=15.466 | L2-Norm(final)=3.844 | 5282.7 samples/s | 82.5 steps/s
[Step=4100 Epoch=20.0] | Loss=0.14288 | Reg=0.00247 | acc=0.9062 | L2-Norm=15.720 | L2-Norm(final)=3.912 | 5537.5 samples/s | 86.5 steps/s
[Step=4150 Epoch=20.2] | Loss=0.13763 | Reg=0.00253 | acc=0.8906 | L2-Norm=15.895 | L2-Norm(final)=3.961 | 5491.3 samples/s | 85.8 steps/s
[Step=4200 Epoch=20.5] | Loss=0.13502 | Reg=0.00257 | acc=0.9219 | L2-Norm=16.040 | L2-Norm(final)=3.998 | 7894.8 samples/s | 123.4 steps/s
[Step=4250 Epoch=20.7] | Loss=0.13167 | Reg=0.00261 | acc=0.8594 | L2-Norm=16.158 | L2-Norm(final)=4.030 | 1951.8 samples/s | 30.5 steps/s
[Step=4300 Epoch=21.0] | Loss=0.12931 | Reg=0.00265 | acc=0.8906 | L2-Norm=16.268 | L2-Norm(final)=4.062 | 5508.1 samples/s | 86.1 steps/s
[Step=4350 Epoch=21.2] | Loss=0.12650 | Reg=0.00268 | acc=0.8438 | L2-Norm=16.370 | L2-Norm(final)=4.095 | 5472.3 samples/s | 85.5 steps/s
[Step=4400 Epoch=21.4] | Loss=0.12464 | Reg=0.00272 | acc=0.8750 | L2-Norm=16.470 | L2-Norm(final)=4.129 | 7130.0 samples/s | 111.4 steps/s
[Step=4450 Epoch=21.7] | Loss=0.12339 | Reg=0.00275 | acc=0.9531 | L2-Norm=16.564 | L2-Norm(final)=4.162 | 1986.5 samples/s | 31.0 steps/s
[Step=4500 Epoch=21.9] | Loss=0.12180 | Reg=0.00278 | acc=0.9531 | L2-Norm=16.657 | L2-Norm(final)=4.196 | 5530.0 samples/s | 86.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=21.9] | Loss=0.11098 | Reg=0.00309 | acc=0.9219 | L2-Norm=17.577 | L2-Norm(final)=4.537 | 4146.8 samples/s | 64.8 steps/s
[Step=4550 Epoch=22.2] | Loss=0.13982 | Reg=0.00312 | acc=0.8594 | L2-Norm=17.651 | L2-Norm(final)=4.521 | 4370.0 samples/s | 68.3 steps/s
[Step=4600 Epoch=22.4] | Loss=0.12625 | Reg=0.00313 | acc=0.9219 | L2-Norm=17.698 | L2-Norm(final)=4.495 | 4859.3 samples/s | 75.9 steps/s
[Step=4650 Epoch=22.7] | Loss=0.11471 | Reg=0.00314 | acc=0.9531 | L2-Norm=17.720 | L2-Norm(final)=4.486 | 4969.2 samples/s | 77.6 steps/s
[Step=4700 Epoch=22.9] | Loss=0.10546 | Reg=0.00315 | acc=0.9062 | L2-Norm=17.737 | L2-Norm(final)=4.483 | 6558.6 samples/s | 102.5 steps/s
[Step=4750 Epoch=23.1] | Loss=0.09558 | Reg=0.00315 | acc=0.9688 | L2-Norm=17.754 | L2-Norm(final)=4.481 | 1873.0 samples/s | 29.3 steps/s
[Step=4800 Epoch=23.4] | Loss=0.08795 | Reg=0.00316 | acc=0.9688 | L2-Norm=17.775 | L2-Norm(final)=4.483 | 4919.4 samples/s | 76.9 steps/s
[Step=4850 Epoch=23.6] | Loss=0.08242 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.796 | L2-Norm(final)=4.486 | 4923.6 samples/s | 76.9 steps/s
[Step=4900 Epoch=23.9] | Loss=0.07860 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.815 | L2-Norm(final)=4.487 | 6055.3 samples/s | 94.6 steps/s
[Step=4950 Epoch=24.1] | Loss=0.07355 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.834 | L2-Norm(final)=4.490 | 1896.7 samples/s | 29.6 steps/s
[Step=5000 Epoch=24.4] | Loss=0.06961 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.851 | L2-Norm(final)=4.493 | 4864.3 samples/s | 76.0 steps/s
[Step=5050 Epoch=24.6] | Loss=0.06647 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.866 | L2-Norm(final)=4.495 | 4860.0 samples/s | 75.9 steps/s
[Step=5100 Epoch=24.8] | Loss=0.06391 | Reg=0.00320 | acc=0.9688 | L2-Norm=17.880 | L2-Norm(final)=4.496 | 5750.8 samples/s | 89.9 steps/s
[Step=5150 Epoch=25.1] | Loss=0.06099 | Reg=0.00320 | acc=0.9688 | L2-Norm=17.893 | L2-Norm(final)=4.498 | 1959.6 samples/s | 30.6 steps/s
[Step=5200 Epoch=25.3] | Loss=0.05882 | Reg=0.00321 | acc=0.9688 | L2-Norm=17.907 | L2-Norm(final)=4.500 | 5012.1 samples/s | 78.3 steps/s
[Step=5250 Epoch=25.6] | Loss=0.05649 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.919 | L2-Norm(final)=4.502 | 4846.8 samples/s | 75.7 steps/s
[Step=5300 Epoch=25.8] | Loss=0.05492 | Reg=0.00321 | acc=0.9531 | L2-Norm=17.930 | L2-Norm(final)=4.504 | 5344.5 samples/s | 83.5 steps/s
[Step=5350 Epoch=26.1] | Loss=0.05288 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.940 | L2-Norm(final)=4.505 | 1958.4 samples/s | 30.6 steps/s
[Step=5400 Epoch=26.3] | Loss=0.05093 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.950 | L2-Norm(final)=4.508 | 4898.6 samples/s | 76.5 steps/s
[Step=5450 Epoch=26.6] | Loss=0.04944 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.958 | L2-Norm(final)=4.510 | 4889.1 samples/s | 76.4 steps/s
[Step=5500 Epoch=26.8] | Loss=0.04839 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.965 | L2-Norm(final)=4.511 | 5033.8 samples/s | 78.7 steps/s
[Step=5550 Epoch=27.0] | Loss=0.04715 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.972 | L2-Norm(final)=4.512 | 2017.8 samples/s | 31.5 steps/s
[Step=5600 Epoch=27.3] | Loss=0.04573 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.980 | L2-Norm(final)=4.514 | 4990.7 samples/s | 78.0 steps/s
[Step=5650 Epoch=27.5] | Loss=0.04456 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.987 | L2-Norm(final)=4.516 | 5025.5 samples/s | 78.5 steps/s
[Step=5700 Epoch=27.8] | Loss=0.04367 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.995 | L2-Norm(final)=4.518 | 4823.2 samples/s | 75.4 steps/s
[Step=5750 Epoch=28.0] | Loss=0.04344 | Reg=0.00324 | acc=0.9375 | L2-Norm=18.003 | L2-Norm(final)=4.520 | 2046.6 samples/s | 32.0 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04297 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.013 | L2-Norm(final)=4.520 | 5063.2 samples/s | 79.1 steps/s
[Step=5850 Epoch=28.5] | Loss=0.04234 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.025 | L2-Norm(final)=4.521 | 4880.7 samples/s | 76.3 steps/s
[Step=5900 Epoch=28.7] | Loss=0.04166 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.036 | L2-Norm(final)=4.521 | 4962.7 samples/s | 77.5 steps/s
[Step=5950 Epoch=29.0] | Loss=0.04102 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.046 | L2-Norm(final)=4.521 | 2075.8 samples/s | 32.4 steps/s
[Step=6000 Epoch=29.2] | Loss=0.03999 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.056 | L2-Norm(final)=4.522 | 4932.7 samples/s | 77.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step6000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=4001 Epoch=19.6] | Loss=0.20221 | Reg=0.00228 | acc=0.8594 | L2-Norm=15.115 | L2-Norm(final)=3.607 | 4076.5 samples/s | 63.7 steps/s
[Step=4050 Epoch=19.9] | Loss=0.15103 | Reg=0.00238 | acc=0.8750 | L2-Norm=15.435 | L2-Norm(final)=3.690 | 5164.6 samples/s | 80.7 steps/s
[Step=4100 Epoch=20.1] | Loss=0.14359 | Reg=0.00246 | acc=0.9062 | L2-Norm=15.695 | L2-Norm(final)=3.747 | 5522.4 samples/s | 86.3 steps/s
[Step=4150 Epoch=20.4] | Loss=0.13988 | Reg=0.00252 | acc=0.8906 | L2-Norm=15.873 | L2-Norm(final)=3.794 | 5526.4 samples/s | 86.4 steps/s
[Step=4200 Epoch=20.6] | Loss=0.13439 | Reg=0.00257 | acc=0.9531 | L2-Norm=16.033 | L2-Norm(final)=3.837 | 7894.9 samples/s | 123.4 steps/s
[Step=4250 Epoch=20.8] | Loss=0.12975 | Reg=0.00262 | acc=0.9062 | L2-Norm=16.172 | L2-Norm(final)=3.879 | 1916.1 samples/s | 29.9 steps/s
[Step=4300 Epoch=21.1] | Loss=0.12784 | Reg=0.00266 | acc=0.9531 | L2-Norm=16.299 | L2-Norm(final)=3.917 | 5675.1 samples/s | 88.7 steps/s
[Step=4350 Epoch=21.3] | Loss=0.12511 | Reg=0.00270 | acc=0.8906 | L2-Norm=16.415 | L2-Norm(final)=3.952 | 5388.0 samples/s | 84.2 steps/s
[Step=4400 Epoch=21.6] | Loss=0.12322 | Reg=0.00273 | acc=0.8906 | L2-Norm=16.526 | L2-Norm(final)=3.988 | 7467.0 samples/s | 116.7 steps/s
[Step=4450 Epoch=21.8] | Loss=0.12025 | Reg=0.00277 | acc=0.9531 | L2-Norm=16.634 | L2-Norm(final)=4.023 | 1957.6 samples/s | 30.6 steps/s
[Step=4500 Epoch=22.1] | Loss=0.11926 | Reg=0.00281 | acc=0.9531 | L2-Norm=16.741 | L2-Norm(final)=4.058 | 5434.4 samples/s | 84.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=22.1] | Loss=0.08045 | Reg=0.00316 | acc=0.9375 | L2-Norm=17.778 | L2-Norm(final)=4.400 | 3866.9 samples/s | 60.4 steps/s
[Step=4550 Epoch=22.3] | Loss=0.11178 | Reg=0.00317 | acc=0.8750 | L2-Norm=17.815 | L2-Norm(final)=4.396 | 4695.1 samples/s | 73.4 steps/s
[Step=4600 Epoch=22.6] | Loss=0.11112 | Reg=0.00319 | acc=0.9531 | L2-Norm=17.856 | L2-Norm(final)=4.376 | 4731.4 samples/s | 73.9 steps/s
[Step=4650 Epoch=22.8] | Loss=0.10434 | Reg=0.00320 | acc=0.9531 | L2-Norm=17.893 | L2-Norm(final)=4.367 | 4775.2 samples/s | 74.6 steps/s
[Step=4700 Epoch=23.0] | Loss=0.09719 | Reg=0.00321 | acc=0.9688 | L2-Norm=17.922 | L2-Norm(final)=4.362 | 6641.2 samples/s | 103.8 steps/s
[Step=4750 Epoch=23.3] | Loss=0.08819 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.953 | L2-Norm(final)=4.361 | 1857.4 samples/s | 29.0 steps/s
[Step=4800 Epoch=23.5] | Loss=0.08226 | Reg=0.00323 | acc=0.9375 | L2-Norm=17.979 | L2-Norm(final)=4.361 | 4971.0 samples/s | 77.7 steps/s
[Step=4850 Epoch=23.8] | Loss=0.07835 | Reg=0.00324 | acc=0.9688 | L2-Norm=18.003 | L2-Norm(final)=4.360 | 4928.2 samples/s | 77.0 steps/s
[Step=4900 Epoch=24.0] | Loss=0.07396 | Reg=0.00325 | acc=0.9531 | L2-Norm=18.027 | L2-Norm(final)=4.359 | 6417.5 samples/s | 100.3 steps/s
[Step=4950 Epoch=24.3] | Loss=0.06884 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.050 | L2-Norm(final)=4.362 | 1889.2 samples/s | 29.5 steps/s
[Step=5000 Epoch=24.5] | Loss=0.06529 | Reg=0.00327 | acc=0.9531 | L2-Norm=18.071 | L2-Norm(final)=4.364 | 4884.5 samples/s | 76.3 steps/s
[Step=5050 Epoch=24.8] | Loss=0.06194 | Reg=0.00327 | acc=0.9844 | L2-Norm=18.090 | L2-Norm(final)=4.366 | 4881.2 samples/s | 76.3 steps/s
[Step=5100 Epoch=25.0] | Loss=0.05930 | Reg=0.00328 | acc=0.9062 | L2-Norm=18.108 | L2-Norm(final)=4.369 | 6062.8 samples/s | 94.7 steps/s
[Step=5150 Epoch=25.3] | Loss=0.05682 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.124 | L2-Norm(final)=4.371 | 1909.7 samples/s | 29.8 steps/s
[Step=5200 Epoch=25.5] | Loss=0.05444 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.139 | L2-Norm(final)=4.372 | 4969.3 samples/s | 77.6 steps/s
[Step=5250 Epoch=25.7] | Loss=0.05257 | Reg=0.00330 | acc=0.9844 | L2-Norm=18.153 | L2-Norm(final)=4.374 | 4859.5 samples/s | 75.9 steps/s
[Step=5300 Epoch=26.0] | Loss=0.05108 | Reg=0.00330 | acc=0.9375 | L2-Norm=18.167 | L2-Norm(final)=4.375 | 5700.5 samples/s | 89.1 steps/s
[Step=5350 Epoch=26.2] | Loss=0.04948 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.179 | L2-Norm(final)=4.376 | 1904.7 samples/s | 29.8 steps/s
[Step=5400 Epoch=26.5] | Loss=0.04754 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.190 | L2-Norm(final)=4.377 | 4917.0 samples/s | 76.8 steps/s
[Step=5450 Epoch=26.7] | Loss=0.04598 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.199 | L2-Norm(final)=4.379 | 4986.5 samples/s | 77.9 steps/s
[Step=5500 Epoch=27.0] | Loss=0.04465 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.206 | L2-Norm(final)=4.380 | 5472.8 samples/s | 85.5 steps/s
[Step=5550 Epoch=27.2] | Loss=0.04327 | Reg=0.00332 | acc=0.9844 | L2-Norm=18.214 | L2-Norm(final)=4.381 | 1973.0 samples/s | 30.8 steps/s
[Step=5600 Epoch=27.5] | Loss=0.04230 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.220 | L2-Norm(final)=4.383 | 4901.4 samples/s | 76.6 steps/s
[Step=5650 Epoch=27.7] | Loss=0.04130 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.228 | L2-Norm(final)=4.384 | 4921.3 samples/s | 76.9 steps/s
[Step=5700 Epoch=28.0] | Loss=0.04026 | Reg=0.00333 | acc=0.9844 | L2-Norm=18.236 | L2-Norm(final)=4.386 | 5269.8 samples/s | 82.3 steps/s
[Step=5750 Epoch=28.2] | Loss=0.03966 | Reg=0.00333 | acc=0.9844 | L2-Norm=18.243 | L2-Norm(final)=4.388 | 1997.5 samples/s | 31.2 steps/s
[Step=5800 Epoch=28.4] | Loss=0.03882 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.251 | L2-Norm(final)=4.389 | 4976.1 samples/s | 77.8 steps/s
[Step=5850 Epoch=28.7] | Loss=0.03794 | Reg=0.00333 | acc=0.9844 | L2-Norm=18.258 | L2-Norm(final)=4.391 | 4887.7 samples/s | 76.4 steps/s
[Step=5900 Epoch=28.9] | Loss=0.03730 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.265 | L2-Norm(final)=4.392 | 5122.2 samples/s | 80.0 steps/s
[Step=5950 Epoch=29.2] | Loss=0.03643 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.272 | L2-Norm(final)=4.393 | 2017.0 samples/s | 31.5 steps/s
[Step=6000 Epoch=29.4] | Loss=0.03572 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.280 | L2-Norm(final)=4.395 | 4995.9 samples/s | 78.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step6000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=6001 Epoch=57.3] | Loss=0.08837 | Reg=0.00228 | acc=0.9375 | L2-Norm=15.115 | L2-Norm(final)=4.483 | 3974.0 samples/s | 62.1 steps/s
[Step=6050 Epoch=57.8] | Loss=0.02254 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.399 | L2-Norm(final)=4.543 | 4618.3 samples/s | 72.2 steps/s
[Step=6100 Epoch=58.3] | Loss=0.01557 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.620 | L2-Norm(final)=4.604 | 7488.3 samples/s | 117.0 steps/s
[Step=6150 Epoch=58.7] | Loss=0.01241 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.753 | L2-Norm(final)=4.658 | 1861.9 samples/s | 29.1 steps/s
[Step=6200 Epoch=59.2] | Loss=0.01012 | Reg=0.00251 | acc=0.9844 | L2-Norm=15.838 | L2-Norm(final)=4.706 | 6857.0 samples/s | 107.1 steps/s
[Step=6250 Epoch=59.7] | Loss=0.00916 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.907 | L2-Norm(final)=4.749 | 1886.7 samples/s | 29.5 steps/s
[Step=6300 Epoch=60.2] | Loss=0.00840 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.962 | L2-Norm(final)=4.788 | 6522.6 samples/s | 101.9 steps/s
[Step=6350 Epoch=60.6] | Loss=0.00757 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.013 | L2-Norm(final)=4.825 | 1907.4 samples/s | 29.8 steps/s
[Step=6400 Epoch=61.1] | Loss=0.00690 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.056 | L2-Norm(final)=4.861 | 5964.6 samples/s | 93.2 steps/s
[Step=6450 Epoch=61.6] | Loss=0.00644 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.090 | L2-Norm(final)=4.895 | 1972.6 samples/s | 30.8 steps/s
[Step=6500 Epoch=62.1] | Loss=0.00599 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.124 | L2-Norm(final)=4.928 | 5613.7 samples/s | 87.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=62.1] | Loss=0.00208 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.431 | L2-Norm(final)=5.247 | 4096.2 samples/s | 64.0 steps/s
[Step=6550 Epoch=62.5] | Loss=0.03640 | Reg=0.00272 | acc=0.9844 | L2-Norm=16.498 | L2-Norm(final)=5.219 | 4172.8 samples/s | 65.2 steps/s
[Step=6600 Epoch=63.0] | Loss=0.02134 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.688 | L2-Norm(final)=5.152 | 6378.9 samples/s | 99.7 steps/s
[Step=6650 Epoch=63.5] | Loss=0.01447 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.751 | L2-Norm(final)=5.136 | 1800.5 samples/s | 28.1 steps/s
[Step=6700 Epoch=64.0] | Loss=0.01117 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.768 | L2-Norm(final)=5.130 | 6039.8 samples/s | 94.4 steps/s
[Step=6750 Epoch=64.5] | Loss=0.00896 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.762 | L2-Norm(final)=5.128 | 1836.3 samples/s | 28.7 steps/s
[Step=6800 Epoch=64.9] | Loss=0.00748 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.743 | L2-Norm(final)=5.127 | 5694.8 samples/s | 89.0 steps/s
[Step=6850 Epoch=65.4] | Loss=0.00641 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.716 | L2-Norm(final)=5.127 | 1879.8 samples/s | 29.4 steps/s
[Step=6900 Epoch=65.9] | Loss=0.00561 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.684 | L2-Norm(final)=5.127 | 5290.1 samples/s | 82.7 steps/s
[Step=6950 Epoch=66.4] | Loss=0.00499 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.649 | L2-Norm(final)=5.127 | 1921.1 samples/s | 30.0 steps/s
[Step=7000 Epoch=66.8] | Loss=0.00449 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.612 | L2-Norm(final)=5.128 | 4976.8 samples/s | 77.8 steps/s
[Step=7050 Epoch=67.3] | Loss=0.00409 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.574 | L2-Norm(final)=5.128 | 1941.4 samples/s | 30.3 steps/s
[Step=7100 Epoch=67.8] | Loss=0.00375 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.535 | L2-Norm(final)=5.128 | 4822.3 samples/s | 75.3 steps/s
[Step=7150 Epoch=68.3] | Loss=0.00346 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.495 | L2-Norm(final)=5.129 | 1969.6 samples/s | 30.8 steps/s
[Step=7200 Epoch=68.8] | Loss=0.00321 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.455 | L2-Norm(final)=5.129 | 4768.4 samples/s | 74.5 steps/s
[Step=7250 Epoch=69.2] | Loss=0.00300 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.415 | L2-Norm(final)=5.130 | 1999.8 samples/s | 31.2 steps/s
[Step=7300 Epoch=69.7] | Loss=0.00281 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.374 | L2-Norm(final)=5.130 | 4733.1 samples/s | 74.0 steps/s
[Step=7350 Epoch=70.2] | Loss=0.00265 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.333 | L2-Norm(final)=5.131 | 1966.6 samples/s | 30.7 steps/s
[Step=7400 Epoch=70.7] | Loss=0.00250 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.293 | L2-Norm(final)=5.131 | 4827.5 samples/s | 75.4 steps/s
[Step=7450 Epoch=71.1] | Loss=0.00237 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.252 | L2-Norm(final)=5.132 | 1967.7 samples/s | 30.7 steps/s
[Step=7500 Epoch=71.6] | Loss=0.00225 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.211 | L2-Norm(final)=5.132 | 4823.0 samples/s | 75.4 steps/s
[Step=7550 Epoch=72.1] | Loss=0.00215 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.170 | L2-Norm(final)=5.133 | 6864.4 samples/s | 107.3 steps/s
[Step=7600 Epoch=72.6] | Loss=0.00205 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.130 | L2-Norm(final)=5.133 | 1760.0 samples/s | 27.5 steps/s
[Step=7650 Epoch=73.1] | Loss=0.00196 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.089 | L2-Norm(final)=5.134 | 6355.7 samples/s | 99.3 steps/s
[Step=7700 Epoch=73.5] | Loss=0.00188 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.048 | L2-Norm(final)=5.134 | 1797.2 samples/s | 28.1 steps/s
[Step=7750 Epoch=74.0] | Loss=0.00180 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.008 | L2-Norm(final)=5.135 | 6004.4 samples/s | 93.8 steps/s
[Step=7800 Epoch=74.5] | Loss=0.00173 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.967 | L2-Norm(final)=5.135 | 1832.5 samples/s | 28.6 steps/s
[Step=7850 Epoch=75.0] | Loss=0.00167 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.927 | L2-Norm(final)=5.136 | 5672.1 samples/s | 88.6 steps/s
[Step=7900 Epoch=75.4] | Loss=0.00161 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.887 | L2-Norm(final)=5.136 | 1873.0 samples/s | 29.3 steps/s
[Step=7950 Epoch=75.9] | Loss=0.00156 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.847 | L2-Norm(final)=5.137 | 5289.7 samples/s | 82.7 steps/s
[Step=8000 Epoch=76.4] | Loss=0.00150 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.807 | L2-Norm(final)=5.137 | 1906.9 samples/s | 29.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.16736 | acc=0.9153 | tpr=0.9064 | fpr=0.0654 | 4359.0 samples/s | 17.0 steps/s
Avg test loss: 0.17340, Avg test acc: 0.91197, Avg tpr: 0.90272, Avg fpr: 0.06768, total FA: 528

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14336 | acc=0.9342 | tpr=0.9465 | fpr=0.0924 | 4337.5 samples/s | 16.9 steps/s
Avg test loss: 0.14551, Avg test acc: 0.93225, Avg tpr: 0.94434, Avg fpr: 0.09435, total FA: 736

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.14415 | acc=0.9384 | tpr=0.9547 | fpr=0.0969 | 4424.1 samples/s | 17.3 steps/s
Avg test loss: 0.14380, Avg test acc: 0.93557, Avg tpr: 0.95162, Avg fpr: 0.09973, total FA: 778

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.32229 | acc=0.6802 | tpr=0.9925 | fpr=0.9980 | 4390.7 samples/s | 17.2 steps/s
Avg test loss: 0.32090, Avg test acc: 0.68343, Avg tpr: 0.99318, Avg fpr: 0.99782, total FA: 7784

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.13900 | acc=0.9348 | tpr=0.9516 | fpr=0.1016 | 4382.3 samples/s | 17.1 steps/s
Avg test loss: 0.14734, Avg test acc: 0.93361, Avg tpr: 0.95040, Avg fpr: 0.10332, total FA: 806

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=3.87613 | acc=0.3195 | tpr=0.0175 | fpr=0.0245 | 4330.3 samples/s | 16.9 steps/s
Avg test loss: 3.87277, Avg test acc: 0.31781, Avg tpr: 0.01818, Avg fpr: 0.02320, total FA: 181

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=3.74634 | acc=0.3137 | tpr=0.0026 | fpr=0.0109 | 4361.8 samples/s | 17.0 steps/s
Avg test loss: 3.75324, Avg test acc: 0.31080, Avg tpr: 0.00239, Avg fpr: 0.01090, total FA: 85

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.00413 | acc=0.3162 | tpr=0.0042 | fpr=0.0062 | 4451.9 samples/s | 17.4 steps/s
Avg test loss: 4.01594, Avg test acc: 0.31325, Avg tpr: 0.00420, Avg fpr: 0.00705, total FA: 55

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=3.87061 | acc=0.3154 | tpr=0.0029 | fpr=0.0059 | 4390.8 samples/s | 17.2 steps/s
Avg test loss: 3.89015, Avg test acc: 0.31200, Avg tpr: 0.00245, Avg fpr: 0.00718, total FA: 56

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=3.83227 | acc=0.3166 | tpr=0.0116 | fpr=0.0211 | 4438.3 samples/s | 17.3 steps/s
Avg test loss: 3.82612, Avg test acc: 0.31509, Avg tpr: 0.01241, Avg fpr: 0.01923, total FA: 150

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.00309 | acc=0.1911 | tpr=0.6018 | fpr=0.8163 | 4353.1 samples/s | 17.0 steps/s
[Step= 100] | Loss=3.97508 | acc=0.1900 | tpr=0.5714 | fpr=0.8172 | 8530.5 samples/s | 33.3 steps/s
[Step= 150] | Loss=3.98238 | acc=0.1894 | tpr=0.5692 | fpr=0.8176 | 8536.1 samples/s | 33.3 steps/s
[Step= 200] | Loss=3.98688 | acc=0.1892 | tpr=0.5683 | fpr=0.8177 | 8672.7 samples/s | 33.9 steps/s
[Step= 250] | Loss=3.98694 | acc=0.1894 | tpr=0.5755 | fpr=0.8176 | 8583.3 samples/s | 33.5 steps/s
[Step= 300] | Loss=3.98914 | acc=0.1900 | tpr=0.5745 | fpr=0.8170 | 8648.2 samples/s | 33.8 steps/s
[Step= 350] | Loss=3.98412 | acc=0.1903 | tpr=0.5717 | fpr=0.8167 | 8582.3 samples/s | 33.5 steps/s
[Step= 400] | Loss=3.98099 | acc=0.1908 | tpr=0.5728 | fpr=0.8161 | 8640.0 samples/s | 33.8 steps/s
[Step= 450] | Loss=3.98359 | acc=0.1908 | tpr=0.5725 | fpr=0.8161 | 8592.6 samples/s | 33.6 steps/s
[Step= 500] | Loss=3.97931 | acc=0.1911 | tpr=0.5771 | fpr=0.8158 | 8440.2 samples/s | 33.0 steps/s
[Step= 550] | Loss=3.98199 | acc=0.1904 | tpr=0.5786 | fpr=0.8167 | 15501.1 samples/s | 60.6 steps/s
Avg test loss: 3.98268, Avg test acc: 0.19017, Avg tpr: 0.57845, Avg fpr: 0.81689, total FA: 113423

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.59328 | acc=0.1343 | tpr=0.6372 | fpr=0.8747 | 4330.4 samples/s | 16.9 steps/s
[Step= 100] | Loss=4.59073 | acc=0.1336 | tpr=0.5800 | fpr=0.8747 | 8780.5 samples/s | 34.3 steps/s
[Step= 150] | Loss=4.59037 | acc=0.1333 | tpr=0.5836 | fpr=0.8750 | 8434.0 samples/s | 32.9 steps/s
[Step= 200] | Loss=4.58266 | acc=0.1339 | tpr=0.5770 | fpr=0.8742 | 8505.6 samples/s | 33.2 steps/s
[Step= 250] | Loss=4.58415 | acc=0.1335 | tpr=0.5721 | fpr=0.8744 | 8847.0 samples/s | 34.6 steps/s
[Step= 300] | Loss=4.58795 | acc=0.1333 | tpr=0.5709 | fpr=0.8746 | 8151.4 samples/s | 31.8 steps/s
[Step= 350] | Loss=4.58289 | acc=0.1335 | tpr=0.5711 | fpr=0.8745 | 8611.7 samples/s | 33.6 steps/s
[Step= 400] | Loss=4.58091 | acc=0.1336 | tpr=0.5711 | fpr=0.8743 | 8536.3 samples/s | 33.3 steps/s
[Step= 450] | Loss=4.58705 | acc=0.1335 | tpr=0.5740 | fpr=0.8745 | 8531.7 samples/s | 33.3 steps/s
[Step= 500] | Loss=4.58848 | acc=0.1329 | tpr=0.5700 | fpr=0.8750 | 8663.7 samples/s | 33.8 steps/s
[Step= 550] | Loss=4.59118 | acc=0.1329 | tpr=0.5667 | fpr=0.8750 | 15089.5 samples/s | 58.9 steps/s
Avg test loss: 4.59271, Avg test acc: 0.13278, Avg tpr: 0.56656, Avg fpr: 0.87510, total FA: 121506

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.17056 | acc=0.1210 | tpr=0.5929 | fpr=0.8875 | 4385.9 samples/s | 17.1 steps/s
[Step= 100] | Loss=5.16136 | acc=0.1190 | tpr=0.5565 | fpr=0.8892 | 8753.2 samples/s | 34.2 steps/s
[Step= 150] | Loss=5.16800 | acc=0.1195 | tpr=0.5461 | fpr=0.8883 | 8451.4 samples/s | 33.0 steps/s
[Step= 200] | Loss=5.15796 | acc=0.1191 | tpr=0.5464 | fpr=0.8887 | 8557.6 samples/s | 33.4 steps/s
[Step= 250] | Loss=5.15879 | acc=0.1192 | tpr=0.5415 | fpr=0.8885 | 8514.2 samples/s | 33.3 steps/s
[Step= 300] | Loss=5.16048 | acc=0.1194 | tpr=0.5433 | fpr=0.8883 | 8858.7 samples/s | 34.6 steps/s
[Step= 350] | Loss=5.15503 | acc=0.1197 | tpr=0.5416 | fpr=0.8880 | 8394.5 samples/s | 32.8 steps/s
[Step= 400] | Loss=5.15514 | acc=0.1198 | tpr=0.5416 | fpr=0.8879 | 8401.5 samples/s | 32.8 steps/s
[Step= 450] | Loss=5.15321 | acc=0.1202 | tpr=0.5424 | fpr=0.8875 | 9137.1 samples/s | 35.7 steps/s
[Step= 500] | Loss=5.15828 | acc=0.1198 | tpr=0.5370 | fpr=0.8878 | 8214.3 samples/s | 32.1 steps/s
[Step= 550] | Loss=5.15720 | acc=0.1198 | tpr=0.5384 | fpr=0.8878 | 15591.6 samples/s | 60.9 steps/s
Avg test loss: 5.15806, Avg test acc: 0.11968, Avg tpr: 0.53883, Avg fpr: 0.88794, total FA: 123288

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=0.49347 | acc=0.0224 | tpr=1.0000 | fpr=0.9951 | 4331.4 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.49431 | acc=0.0224 | tpr=1.0000 | fpr=0.9958 | 8884.9 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.49466 | acc=0.0221 | tpr=1.0000 | fpr=0.9959 | 8189.7 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.49447 | acc=0.0218 | tpr=1.0000 | fpr=0.9960 | 8879.4 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.49484 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8633.6 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.49501 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8509.3 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.49495 | acc=0.0215 | tpr=1.0000 | fpr=0.9962 | 8964.6 samples/s | 35.0 steps/s
[Step= 400] | Loss=0.49496 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8357.8 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.49497 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 8402.3 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.49508 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 8536.3 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.49497 | acc=0.0215 | tpr=1.0000 | fpr=0.9963 | 15286.9 samples/s | 59.7 steps/s
Avg test loss: 0.49495, Avg test acc: 0.02145, Avg tpr: 1.00000, Avg fpr: 0.99633, total FA: 138339

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.40482 | acc=0.1411 | tpr=0.7168 | fpr=0.8693 | 4363.9 samples/s | 17.0 steps/s
[Step= 100] | Loss=4.38271 | acc=0.1402 | tpr=0.6567 | fpr=0.8694 | 8687.6 samples/s | 33.9 steps/s
[Step= 150] | Loss=4.38317 | acc=0.1410 | tpr=0.6657 | fpr=0.8687 | 8741.1 samples/s | 34.1 steps/s
[Step= 200] | Loss=4.37176 | acc=0.1413 | tpr=0.6568 | fpr=0.8680 | 8435.4 samples/s | 33.0 steps/s
[Step= 250] | Loss=4.38041 | acc=0.1406 | tpr=0.6533 | fpr=0.8688 | 8546.0 samples/s | 33.4 steps/s
[Step= 300] | Loss=4.38354 | acc=0.1406 | tpr=0.6589 | fpr=0.8689 | 8579.9 samples/s | 33.5 steps/s
[Step= 350] | Loss=4.37537 | acc=0.1402 | tpr=0.6500 | fpr=0.8690 | 9090.9 samples/s | 35.5 steps/s
[Step= 400] | Loss=4.37298 | acc=0.1407 | tpr=0.6532 | fpr=0.8686 | 8266.0 samples/s | 32.3 steps/s
[Step= 450] | Loss=4.37220 | acc=0.1409 | tpr=0.6607 | fpr=0.8686 | 8697.0 samples/s | 34.0 steps/s
[Step= 500] | Loss=4.37215 | acc=0.1408 | tpr=0.6608 | fpr=0.8686 | 8559.9 samples/s | 33.4 steps/s
[Step= 550] | Loss=4.37524 | acc=0.1404 | tpr=0.6606 | fpr=0.8690 | 15415.5 samples/s | 60.2 steps/s
Avg test loss: 4.37679, Avg test acc: 0.14035, Avg tpr: 0.65967, Avg fpr: 0.86909, total FA: 120671

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.05105 | acc=0.9795 | tpr=0.8053 | fpr=0.0173 | 4405.5 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.04880 | acc=0.9795 | tpr=0.8124 | fpr=0.0173 | 8278.6 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.04998 | acc=0.9793 | tpr=0.8112 | fpr=0.0176 | 9188.4 samples/s | 35.9 steps/s
[Step= 200] | Loss=0.05094 | acc=0.9792 | tpr=0.8219 | fpr=0.0179 | 8224.3 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.05087 | acc=0.9793 | tpr=0.8183 | fpr=0.0178 | 8485.6 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.05156 | acc=0.9790 | tpr=0.8145 | fpr=0.0180 | 8554.9 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.05108 | acc=0.9791 | tpr=0.8178 | fpr=0.0180 | 8772.2 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.05154 | acc=0.9789 | tpr=0.8129 | fpr=0.0181 | 8616.0 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.05234 | acc=0.9787 | tpr=0.8116 | fpr=0.0183 | 8516.1 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.05192 | acc=0.9789 | tpr=0.8145 | fpr=0.0182 | 8612.9 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.05123 | acc=0.9790 | tpr=0.8158 | fpr=0.0181 | 15652.5 samples/s | 61.1 steps/s
Avg test loss: 0.05119, Avg test acc: 0.97894, Avg tpr: 0.81498, Avg fpr: 0.01808, total FA: 2510

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.08623 | acc=0.9820 | tpr=0.8496 | fpr=0.0157 | 4408.5 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.09151 | acc=0.9819 | tpr=0.8657 | fpr=0.0160 | 8605.8 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.09240 | acc=0.9815 | tpr=0.8718 | fpr=0.0165 | 8400.1 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.09408 | acc=0.9812 | tpr=0.8721 | fpr=0.0168 | 8710.6 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.09257 | acc=0.9816 | tpr=0.8716 | fpr=0.0164 | 8686.1 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.09386 | acc=0.9815 | tpr=0.8727 | fpr=0.0165 | 8722.1 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.09502 | acc=0.9814 | tpr=0.8729 | fpr=0.0167 | 8461.5 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.09638 | acc=0.9812 | tpr=0.8643 | fpr=0.0167 | 8699.7 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.09734 | acc=0.9811 | tpr=0.8661 | fpr=0.0168 | 8808.2 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.09720 | acc=0.9811 | tpr=0.8661 | fpr=0.0169 | 8339.1 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.09671 | acc=0.9811 | tpr=0.8647 | fpr=0.0168 | 15256.9 samples/s | 59.6 steps/s
Avg test loss: 0.09650, Avg test acc: 0.98113, Avg tpr: 0.86529, Avg fpr: 0.01676, total FA: 2327

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.09985 | acc=0.9800 | tpr=0.8982 | fpr=0.0185 | 4339.7 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.10088 | acc=0.9791 | tpr=0.9019 | fpr=0.0195 | 8945.0 samples/s | 34.9 steps/s
[Step= 150] | Loss=0.10410 | acc=0.9782 | tpr=0.9006 | fpr=0.0203 | 8399.4 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.10458 | acc=0.9783 | tpr=0.9005 | fpr=0.0203 | 8493.1 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.10354 | acc=0.9784 | tpr=0.8969 | fpr=0.0201 | 8533.8 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.10527 | acc=0.9779 | tpr=0.8924 | fpr=0.0205 | 8891.8 samples/s | 34.7 steps/s
[Step= 350] | Loss=0.10614 | acc=0.9777 | tpr=0.8917 | fpr=0.0207 | 8496.5 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.10723 | acc=0.9775 | tpr=0.8884 | fpr=0.0209 | 8459.7 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.10859 | acc=0.9773 | tpr=0.8875 | fpr=0.0211 | 8751.8 samples/s | 34.2 steps/s
[Step= 500] | Loss=0.10770 | acc=0.9773 | tpr=0.8912 | fpr=0.0211 | 8430.3 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.10650 | acc=0.9776 | tpr=0.8914 | fpr=0.0209 | 15926.5 samples/s | 62.2 steps/s
Avg test loss: 0.10629, Avg test acc: 0.97758, Avg tpr: 0.89184, Avg fpr: 0.02086, total FA: 2896

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.06523 | acc=0.9823 | tpr=0.8451 | fpr=0.0153 | 4349.7 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.06659 | acc=0.9823 | tpr=0.8699 | fpr=0.0156 | 8751.2 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.06746 | acc=0.9816 | tpr=0.8775 | fpr=0.0164 | 8659.0 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.06773 | acc=0.9816 | tpr=0.8798 | fpr=0.0166 | 8568.4 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.06656 | acc=0.9818 | tpr=0.8760 | fpr=0.0163 | 8697.1 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.06784 | acc=0.9814 | tpr=0.8698 | fpr=0.0166 | 8554.1 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.06780 | acc=0.9813 | tpr=0.8710 | fpr=0.0167 | 8386.2 samples/s | 32.8 steps/s
[Step= 400] | Loss=0.06843 | acc=0.9811 | tpr=0.8660 | fpr=0.0168 | 9012.3 samples/s | 35.2 steps/s
[Step= 450] | Loss=0.06975 | acc=0.9808 | tpr=0.8642 | fpr=0.0171 | 8387.7 samples/s | 32.8 steps/s
[Step= 500] | Loss=0.06955 | acc=0.9809 | tpr=0.8665 | fpr=0.0171 | 8403.8 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.06873 | acc=0.9811 | tpr=0.8679 | fpr=0.0169 | 14811.1 samples/s | 57.9 steps/s
Avg test loss: 0.06851, Avg test acc: 0.98109, Avg tpr: 0.86767, Avg fpr: 0.01685, total FA: 2340

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.06004 | acc=0.9784 | tpr=0.8009 | fpr=0.0185 | 4042.9 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.05947 | acc=0.9780 | tpr=0.8124 | fpr=0.0189 | 8298.1 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.06023 | acc=0.9770 | tpr=0.8141 | fpr=0.0200 | 8482.0 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.06128 | acc=0.9771 | tpr=0.8197 | fpr=0.0200 | 8262.5 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.06088 | acc=0.9772 | tpr=0.8131 | fpr=0.0198 | 8514.1 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.06211 | acc=0.9769 | tpr=0.8080 | fpr=0.0200 | 8429.8 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.06231 | acc=0.9768 | tpr=0.8109 | fpr=0.0202 | 8578.9 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.06297 | acc=0.9765 | tpr=0.8025 | fpr=0.0204 | 8888.0 samples/s | 34.7 steps/s
[Step= 450] | Loss=0.06410 | acc=0.9763 | tpr=0.8033 | fpr=0.0206 | 8573.9 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.06354 | acc=0.9764 | tpr=0.8048 | fpr=0.0205 | 8426.4 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.06294 | acc=0.9766 | tpr=0.8062 | fpr=0.0203 | 15527.2 samples/s | 60.7 steps/s
Avg test loss: 0.06281, Avg test acc: 0.97657, Avg tpr: 0.80547, Avg fpr: 0.02032, total FA: 2822

server round 5/50

clients selected: [0 1 4 6 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=6001 Epoch=29.3] | Loss=0.17847 | Reg=0.00225 | acc=0.8906 | L2-Norm=15.009 | L2-Norm(final)=4.261 | 3803.6 samples/s | 59.4 steps/s
[Step=6050 Epoch=29.5] | Loss=0.12759 | Reg=0.00233 | acc=0.8594 | L2-Norm=15.275 | L2-Norm(final)=4.356 | 5382.9 samples/s | 84.1 steps/s
[Step=6100 Epoch=29.7] | Loss=0.12588 | Reg=0.00240 | acc=0.8594 | L2-Norm=15.494 | L2-Norm(final)=4.404 | 5527.8 samples/s | 86.4 steps/s
[Step=6150 Epoch=30.0] | Loss=0.11950 | Reg=0.00245 | acc=0.8750 | L2-Norm=15.648 | L2-Norm(final)=4.442 | 5581.6 samples/s | 87.2 steps/s
[Step=6200 Epoch=30.2] | Loss=0.11720 | Reg=0.00249 | acc=0.9219 | L2-Norm=15.779 | L2-Norm(final)=4.479 | 7714.3 samples/s | 120.5 steps/s
[Step=6250 Epoch=30.5] | Loss=0.11563 | Reg=0.00253 | acc=0.9688 | L2-Norm=15.911 | L2-Norm(final)=4.510 | 1899.8 samples/s | 29.7 steps/s
[Step=6300 Epoch=30.7] | Loss=0.11254 | Reg=0.00257 | acc=0.9688 | L2-Norm=16.034 | L2-Norm(final)=4.541 | 5470.3 samples/s | 85.5 steps/s
[Step=6350 Epoch=31.0] | Loss=0.11051 | Reg=0.00261 | acc=0.9844 | L2-Norm=16.145 | L2-Norm(final)=4.571 | 5412.4 samples/s | 84.6 steps/s
[Step=6400 Epoch=31.2] | Loss=0.10833 | Reg=0.00264 | acc=0.9688 | L2-Norm=16.246 | L2-Norm(final)=4.602 | 6987.2 samples/s | 109.2 steps/s
[Step=6450 Epoch=31.5] | Loss=0.10698 | Reg=0.00267 | acc=0.9375 | L2-Norm=16.340 | L2-Norm(final)=4.633 | 1963.6 samples/s | 30.7 steps/s
[Step=6500 Epoch=31.7] | Loss=0.10589 | Reg=0.00270 | acc=0.9375 | L2-Norm=16.435 | L2-Norm(final)=4.665 | 5513.4 samples/s | 86.1 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=31.7] | Loss=0.09090 | Reg=0.00302 | acc=0.8906 | L2-Norm=17.388 | L2-Norm(final)=4.988 | 4022.2 samples/s | 62.8 steps/s
[Step=6550 Epoch=31.9] | Loss=0.12420 | Reg=0.00305 | acc=0.9688 | L2-Norm=17.462 | L2-Norm(final)=4.972 | 4560.9 samples/s | 71.3 steps/s
[Step=6600 Epoch=32.2] | Loss=0.11206 | Reg=0.00307 | acc=0.9844 | L2-Norm=17.522 | L2-Norm(final)=4.955 | 4866.8 samples/s | 76.0 steps/s
[Step=6650 Epoch=32.4] | Loss=0.10490 | Reg=0.00309 | acc=0.9219 | L2-Norm=17.567 | L2-Norm(final)=4.950 | 4881.5 samples/s | 76.3 steps/s
[Step=6700 Epoch=32.7] | Loss=0.09685 | Reg=0.00310 | acc=0.9531 | L2-Norm=17.606 | L2-Norm(final)=4.945 | 6437.2 samples/s | 100.6 steps/s
[Step=6750 Epoch=32.9] | Loss=0.08957 | Reg=0.00311 | acc=0.9688 | L2-Norm=17.642 | L2-Norm(final)=4.942 | 1862.4 samples/s | 29.1 steps/s
[Step=6800 Epoch=33.2] | Loss=0.08409 | Reg=0.00313 | acc=0.9219 | L2-Norm=17.679 | L2-Norm(final)=4.938 | 4982.5 samples/s | 77.9 steps/s
[Step=6850 Epoch=33.4] | Loss=0.07884 | Reg=0.00314 | acc=0.9688 | L2-Norm=17.712 | L2-Norm(final)=4.937 | 4944.2 samples/s | 77.3 steps/s
[Step=6900 Epoch=33.6] | Loss=0.07470 | Reg=0.00315 | acc=0.9844 | L2-Norm=17.739 | L2-Norm(final)=4.935 | 5961.6 samples/s | 93.2 steps/s
[Step=6950 Epoch=33.9] | Loss=0.07100 | Reg=0.00316 | acc=0.9688 | L2-Norm=17.765 | L2-Norm(final)=4.935 | 1891.1 samples/s | 29.5 steps/s
[Step=7000 Epoch=34.1] | Loss=0.06691 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.790 | L2-Norm(final)=4.936 | 4819.4 samples/s | 75.3 steps/s
[Step=7050 Epoch=34.4] | Loss=0.06326 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.811 | L2-Norm(final)=4.937 | 4912.5 samples/s | 76.8 steps/s
[Step=7100 Epoch=34.6] | Loss=0.06096 | Reg=0.00318 | acc=0.9375 | L2-Norm=17.830 | L2-Norm(final)=4.939 | 5734.5 samples/s | 89.6 steps/s
[Step=7150 Epoch=34.9] | Loss=0.05815 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.849 | L2-Norm(final)=4.940 | 1932.9 samples/s | 30.2 steps/s
[Step=7200 Epoch=35.1] | Loss=0.05557 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.865 | L2-Norm(final)=4.941 | 4964.9 samples/s | 77.6 steps/s
[Step=7250 Epoch=35.4] | Loss=0.05352 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.879 | L2-Norm(final)=4.942 | 4963.6 samples/s | 77.6 steps/s
[Step=7300 Epoch=35.6] | Loss=0.05220 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.894 | L2-Norm(final)=4.943 | 5328.7 samples/s | 83.3 steps/s
[Step=7350 Epoch=35.8] | Loss=0.05115 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.909 | L2-Norm(final)=4.944 | 1962.7 samples/s | 30.7 steps/s
[Step=7400 Epoch=36.1] | Loss=0.04966 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.925 | L2-Norm(final)=4.944 | 4998.4 samples/s | 78.1 steps/s
[Step=7450 Epoch=36.3] | Loss=0.04809 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.939 | L2-Norm(final)=4.945 | 4921.0 samples/s | 76.9 steps/s
[Step=7500 Epoch=36.6] | Loss=0.04709 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.952 | L2-Norm(final)=4.945 | 5030.3 samples/s | 78.6 steps/s
[Step=7550 Epoch=36.8] | Loss=0.04591 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.965 | L2-Norm(final)=4.944 | 2019.9 samples/s | 31.6 steps/s
[Step=7600 Epoch=37.1] | Loss=0.04446 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.977 | L2-Norm(final)=4.945 | 4980.9 samples/s | 77.8 steps/s
[Step=7650 Epoch=37.3] | Loss=0.04336 | Reg=0.00324 | acc=0.9844 | L2-Norm=17.987 | L2-Norm(final)=4.946 | 4847.3 samples/s | 75.7 steps/s
[Step=7700 Epoch=37.5] | Loss=0.04234 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.997 | L2-Norm(final)=4.946 | 4872.2 samples/s | 76.1 steps/s
[Step=7750 Epoch=37.8] | Loss=0.04147 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.006 | L2-Norm(final)=4.947 | 2023.2 samples/s | 31.6 steps/s
[Step=7800 Epoch=38.0] | Loss=0.04040 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.015 | L2-Norm(final)=4.947 | 4927.0 samples/s | 77.0 steps/s
[Step=7850 Epoch=38.3] | Loss=0.03935 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.023 | L2-Norm(final)=4.948 | 4843.2 samples/s | 75.7 steps/s
[Step=7900 Epoch=38.5] | Loss=0.03841 | Reg=0.00325 | acc=0.9531 | L2-Norm=18.030 | L2-Norm(final)=4.950 | 4760.0 samples/s | 74.4 steps/s
[Step=7950 Epoch=38.8] | Loss=0.03772 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.036 | L2-Norm(final)=4.951 | 2081.5 samples/s | 32.5 steps/s
[Step=8000 Epoch=39.0] | Loss=0.03700 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.043 | L2-Norm(final)=4.952 | 4819.9 samples/s | 75.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step8000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=10001 Epoch=48.8] | Loss=0.13363 | Reg=0.00225 | acc=0.9062 | L2-Norm=15.009 | L2-Norm(final)=4.999 | 3912.2 samples/s | 61.1 steps/s
[Step=10050 Epoch=49.0] | Loss=0.12541 | Reg=0.00232 | acc=0.9219 | L2-Norm=15.228 | L2-Norm(final)=5.087 | 5259.7 samples/s | 82.2 steps/s
[Step=10100 Epoch=49.3] | Loss=0.12573 | Reg=0.00238 | acc=0.9062 | L2-Norm=15.437 | L2-Norm(final)=5.122 | 5436.7 samples/s | 84.9 steps/s
[Step=10150 Epoch=49.5] | Loss=0.11831 | Reg=0.00243 | acc=0.9219 | L2-Norm=15.599 | L2-Norm(final)=5.154 | 5556.7 samples/s | 86.8 steps/s
[Step=10200 Epoch=49.8] | Loss=0.11433 | Reg=0.00247 | acc=0.9531 | L2-Norm=15.721 | L2-Norm(final)=5.185 | 7640.7 samples/s | 119.4 steps/s
[Step=10250 Epoch=50.0] | Loss=0.10961 | Reg=0.00251 | acc=0.9375 | L2-Norm=15.825 | L2-Norm(final)=5.217 | 1932.6 samples/s | 30.2 steps/s
[Step=10300 Epoch=50.3] | Loss=0.10711 | Reg=0.00254 | acc=0.9062 | L2-Norm=15.923 | L2-Norm(final)=5.250 | 5587.8 samples/s | 87.3 steps/s
[Step=10350 Epoch=50.5] | Loss=0.10504 | Reg=0.00257 | acc=0.8906 | L2-Norm=16.016 | L2-Norm(final)=5.284 | 5542.6 samples/s | 86.6 steps/s
[Step=10400 Epoch=50.7] | Loss=0.10515 | Reg=0.00260 | acc=0.9531 | L2-Norm=16.109 | L2-Norm(final)=5.314 | 7053.0 samples/s | 110.2 steps/s
[Step=10450 Epoch=51.0] | Loss=0.10319 | Reg=0.00263 | acc=0.9062 | L2-Norm=16.203 | L2-Norm(final)=5.345 | 1918.1 samples/s | 30.0 steps/s
[Step=10500 Epoch=51.2] | Loss=0.10107 | Reg=0.00266 | acc=0.9219 | L2-Norm=16.295 | L2-Norm(final)=5.379 | 5515.3 samples/s | 86.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=51.2] | Loss=0.10545 | Reg=0.00296 | acc=0.9531 | L2-Norm=17.213 | L2-Norm(final)=5.730 | 4303.4 samples/s | 67.2 steps/s
[Step=10550 Epoch=51.5] | Loss=0.12313 | Reg=0.00299 | acc=0.8594 | L2-Norm=17.293 | L2-Norm(final)=5.720 | 4178.6 samples/s | 65.3 steps/s
[Step=10600 Epoch=51.7] | Loss=0.11012 | Reg=0.00301 | acc=0.9531 | L2-Norm=17.348 | L2-Norm(final)=5.697 | 4817.2 samples/s | 75.3 steps/s
[Step=10650 Epoch=52.0] | Loss=0.10369 | Reg=0.00303 | acc=0.9375 | L2-Norm=17.394 | L2-Norm(final)=5.685 | 4796.8 samples/s | 75.0 steps/s
[Step=10700 Epoch=52.2] | Loss=0.09872 | Reg=0.00304 | acc=0.9375 | L2-Norm=17.429 | L2-Norm(final)=5.675 | 6557.1 samples/s | 102.5 steps/s
[Step=10750 Epoch=52.5] | Loss=0.08857 | Reg=0.00305 | acc=0.9844 | L2-Norm=17.460 | L2-Norm(final)=5.671 | 1863.8 samples/s | 29.1 steps/s
[Step=10800 Epoch=52.7] | Loss=0.08185 | Reg=0.00306 | acc=0.9688 | L2-Norm=17.486 | L2-Norm(final)=5.670 | 4882.4 samples/s | 76.3 steps/s
[Step=10850 Epoch=52.9] | Loss=0.07652 | Reg=0.00307 | acc=0.9688 | L2-Norm=17.514 | L2-Norm(final)=5.672 | 4906.0 samples/s | 76.7 steps/s
[Step=10900 Epoch=53.2] | Loss=0.07300 | Reg=0.00308 | acc=0.9688 | L2-Norm=17.541 | L2-Norm(final)=5.675 | 6198.3 samples/s | 96.8 steps/s
[Step=10950 Epoch=53.4] | Loss=0.06851 | Reg=0.00309 | acc=0.9688 | L2-Norm=17.567 | L2-Norm(final)=5.677 | 1889.8 samples/s | 29.5 steps/s
[Step=11000 Epoch=53.7] | Loss=0.06514 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.592 | L2-Norm(final)=5.679 | 4958.0 samples/s | 77.5 steps/s
[Step=11050 Epoch=53.9] | Loss=0.06269 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.616 | L2-Norm(final)=5.682 | 4923.1 samples/s | 76.9 steps/s
[Step=11100 Epoch=54.2] | Loss=0.06087 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.641 | L2-Norm(final)=5.684 | 5806.0 samples/s | 90.7 steps/s
[Step=11150 Epoch=54.4] | Loss=0.05848 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.665 | L2-Norm(final)=5.685 | 1916.4 samples/s | 29.9 steps/s
[Step=11200 Epoch=54.7] | Loss=0.05564 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.688 | L2-Norm(final)=5.688 | 4948.4 samples/s | 77.3 steps/s
[Step=11250 Epoch=54.9] | Loss=0.05379 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.708 | L2-Norm(final)=5.692 | 4926.4 samples/s | 77.0 steps/s
[Step=11300 Epoch=55.1] | Loss=0.05208 | Reg=0.00314 | acc=0.9688 | L2-Norm=17.727 | L2-Norm(final)=5.694 | 5385.9 samples/s | 84.2 steps/s
[Step=11350 Epoch=55.4] | Loss=0.05033 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.745 | L2-Norm(final)=5.696 | 1968.2 samples/s | 30.8 steps/s
[Step=11400 Epoch=55.6] | Loss=0.04884 | Reg=0.00316 | acc=0.9688 | L2-Norm=17.762 | L2-Norm(final)=5.698 | 4925.0 samples/s | 77.0 steps/s
[Step=11450 Epoch=55.9] | Loss=0.04739 | Reg=0.00316 | acc=0.9688 | L2-Norm=17.778 | L2-Norm(final)=5.700 | 4907.5 samples/s | 76.7 steps/s
[Step=11500 Epoch=56.1] | Loss=0.04595 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.793 | L2-Norm(final)=5.702 | 5315.3 samples/s | 83.1 steps/s
[Step=11550 Epoch=56.4] | Loss=0.04484 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.808 | L2-Norm(final)=5.704 | 1969.2 samples/s | 30.8 steps/s
[Step=11600 Epoch=56.6] | Loss=0.04345 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.821 | L2-Norm(final)=5.706 | 4939.6 samples/s | 77.2 steps/s
[Step=11650 Epoch=56.8] | Loss=0.04243 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.833 | L2-Norm(final)=5.708 | 4803.3 samples/s | 75.1 steps/s
[Step=11700 Epoch=57.1] | Loss=0.04146 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.845 | L2-Norm(final)=5.710 | 4909.1 samples/s | 76.7 steps/s
[Step=11750 Epoch=57.3] | Loss=0.04055 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.857 | L2-Norm(final)=5.712 | 2032.0 samples/s | 31.7 steps/s
[Step=11800 Epoch=57.6] | Loss=0.03955 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.869 | L2-Norm(final)=5.714 | 4965.1 samples/s | 77.6 steps/s
[Step=11850 Epoch=57.8] | Loss=0.03854 | Reg=0.00320 | acc=0.9688 | L2-Norm=17.880 | L2-Norm(final)=5.715 | 4989.0 samples/s | 78.0 steps/s
[Step=11900 Epoch=58.1] | Loss=0.03767 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.889 | L2-Norm(final)=5.717 | 4781.8 samples/s | 74.7 steps/s
[Step=11950 Epoch=58.3] | Loss=0.03712 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.898 | L2-Norm(final)=5.718 | 2025.4 samples/s | 31.6 steps/s
[Step=12000 Epoch=58.6] | Loss=0.03624 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.906 | L2-Norm(final)=5.719 | 5013.1 samples/s | 78.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step12000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=6001 Epoch=29.4] | Loss=0.14956 | Reg=0.00225 | acc=0.9062 | L2-Norm=15.009 | L2-Norm(final)=4.433 | 3969.3 samples/s | 62.0 steps/s
[Step=6050 Epoch=29.7] | Loss=0.12918 | Reg=0.00232 | acc=0.8906 | L2-Norm=15.223 | L2-Norm(final)=4.539 | 5047.0 samples/s | 78.9 steps/s
[Step=6100 Epoch=29.9] | Loss=0.12235 | Reg=0.00238 | acc=0.9531 | L2-Norm=15.440 | L2-Norm(final)=4.589 | 5593.7 samples/s | 87.4 steps/s
[Step=6150 Epoch=30.2] | Loss=0.11523 | Reg=0.00244 | acc=0.9062 | L2-Norm=15.603 | L2-Norm(final)=4.634 | 5554.2 samples/s | 86.8 steps/s
[Step=6200 Epoch=30.4] | Loss=0.11319 | Reg=0.00248 | acc=0.8750 | L2-Norm=15.731 | L2-Norm(final)=4.668 | 7806.0 samples/s | 122.0 steps/s
[Step=6250 Epoch=30.6] | Loss=0.10877 | Reg=0.00251 | acc=0.9219 | L2-Norm=15.850 | L2-Norm(final)=4.703 | 1870.3 samples/s | 29.2 steps/s
[Step=6300 Epoch=30.9] | Loss=0.10677 | Reg=0.00255 | acc=0.8594 | L2-Norm=15.964 | L2-Norm(final)=4.740 | 5581.7 samples/s | 87.2 steps/s
[Step=6350 Epoch=31.1] | Loss=0.10673 | Reg=0.00259 | acc=0.9219 | L2-Norm=16.075 | L2-Norm(final)=4.773 | 5534.9 samples/s | 86.5 steps/s
[Step=6400 Epoch=31.4] | Loss=0.10439 | Reg=0.00262 | acc=0.9219 | L2-Norm=16.182 | L2-Norm(final)=4.804 | 7381.3 samples/s | 115.3 steps/s
[Step=6450 Epoch=31.6] | Loss=0.10227 | Reg=0.00266 | acc=0.9375 | L2-Norm=16.286 | L2-Norm(final)=4.836 | 1917.0 samples/s | 30.0 steps/s
[Step=6500 Epoch=31.9] | Loss=0.10047 | Reg=0.00269 | acc=0.9688 | L2-Norm=16.389 | L2-Norm(final)=4.869 | 5461.2 samples/s | 85.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=31.9] | Loss=0.09823 | Reg=0.00302 | acc=0.9062 | L2-Norm=17.390 | L2-Norm(final)=5.213 | 4007.3 samples/s | 62.6 steps/s
[Step=6550 Epoch=32.1] | Loss=0.11444 | Reg=0.00305 | acc=0.9062 | L2-Norm=17.473 | L2-Norm(final)=5.204 | 4868.7 samples/s | 76.1 steps/s
[Step=6600 Epoch=32.4] | Loss=0.10880 | Reg=0.00307 | acc=0.9375 | L2-Norm=17.525 | L2-Norm(final)=5.178 | 4878.2 samples/s | 76.2 steps/s
[Step=6650 Epoch=32.6] | Loss=0.10260 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.566 | L2-Norm(final)=5.169 | 4890.5 samples/s | 76.4 steps/s
[Step=6700 Epoch=32.9] | Loss=0.09641 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.597 | L2-Norm(final)=5.160 | 6735.5 samples/s | 105.2 steps/s
[Step=6750 Epoch=33.1] | Loss=0.08576 | Reg=0.00311 | acc=0.9688 | L2-Norm=17.629 | L2-Norm(final)=5.159 | 1826.6 samples/s | 28.5 steps/s
[Step=6800 Epoch=33.3] | Loss=0.07908 | Reg=0.00312 | acc=0.9844 | L2-Norm=17.659 | L2-Norm(final)=5.160 | 4806.5 samples/s | 75.1 steps/s
[Step=6850 Epoch=33.6] | Loss=0.07504 | Reg=0.00313 | acc=0.9375 | L2-Norm=17.686 | L2-Norm(final)=5.160 | 4854.9 samples/s | 75.9 steps/s
[Step=6900 Epoch=33.8] | Loss=0.07154 | Reg=0.00314 | acc=0.9531 | L2-Norm=17.711 | L2-Norm(final)=5.160 | 6127.4 samples/s | 95.7 steps/s
[Step=6950 Epoch=34.1] | Loss=0.06686 | Reg=0.00315 | acc=0.9688 | L2-Norm=17.736 | L2-Norm(final)=5.160 | 1864.3 samples/s | 29.1 steps/s
[Step=7000 Epoch=34.3] | Loss=0.06319 | Reg=0.00315 | acc=0.9375 | L2-Norm=17.759 | L2-Norm(final)=5.163 | 4926.5 samples/s | 77.0 steps/s
[Step=7050 Epoch=34.6] | Loss=0.06067 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.779 | L2-Norm(final)=5.164 | 4869.0 samples/s | 76.1 steps/s
[Step=7100 Epoch=34.8] | Loss=0.05843 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.798 | L2-Norm(final)=5.165 | 6039.4 samples/s | 94.4 steps/s
[Step=7150 Epoch=35.1] | Loss=0.05550 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.815 | L2-Norm(final)=5.166 | 1902.3 samples/s | 29.7 steps/s
[Step=7200 Epoch=35.3] | Loss=0.05333 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.832 | L2-Norm(final)=5.168 | 4849.2 samples/s | 75.8 steps/s
[Step=7250 Epoch=35.6] | Loss=0.05142 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.849 | L2-Norm(final)=5.170 | 4797.0 samples/s | 75.0 steps/s
[Step=7300 Epoch=35.8] | Loss=0.04968 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.865 | L2-Norm(final)=5.172 | 5704.0 samples/s | 89.1 steps/s
[Step=7350 Epoch=36.0] | Loss=0.04845 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.881 | L2-Norm(final)=5.174 | 1921.1 samples/s | 30.0 steps/s
[Step=7400 Epoch=36.3] | Loss=0.04682 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.896 | L2-Norm(final)=5.175 | 4802.9 samples/s | 75.0 steps/s
[Step=7450 Epoch=36.5] | Loss=0.04547 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.911 | L2-Norm(final)=5.177 | 4752.2 samples/s | 74.3 steps/s
[Step=7500 Epoch=36.8] | Loss=0.04444 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.926 | L2-Norm(final)=5.179 | 5440.0 samples/s | 85.0 steps/s
[Step=7550 Epoch=37.0] | Loss=0.04328 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.942 | L2-Norm(final)=5.180 | 1928.1 samples/s | 30.1 steps/s
[Step=7600 Epoch=37.3] | Loss=0.04197 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.955 | L2-Norm(final)=5.181 | 4853.7 samples/s | 75.8 steps/s
[Step=7650 Epoch=37.5] | Loss=0.04094 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.967 | L2-Norm(final)=5.183 | 4961.2 samples/s | 77.5 steps/s
[Step=7700 Epoch=37.8] | Loss=0.04001 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.979 | L2-Norm(final)=5.184 | 5179.6 samples/s | 80.9 steps/s
[Step=7750 Epoch=38.0] | Loss=0.03925 | Reg=0.00324 | acc=0.9688 | L2-Norm=17.991 | L2-Norm(final)=5.185 | 1978.5 samples/s | 30.9 steps/s
[Step=7800 Epoch=38.2] | Loss=0.03841 | Reg=0.00324 | acc=0.9844 | L2-Norm=18.003 | L2-Norm(final)=5.186 | 4942.5 samples/s | 77.2 steps/s
[Step=7850 Epoch=38.5] | Loss=0.03765 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.015 | L2-Norm(final)=5.187 | 4953.1 samples/s | 77.4 steps/s
[Step=7900 Epoch=38.7] | Loss=0.03706 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.027 | L2-Norm(final)=5.188 | 5048.2 samples/s | 78.9 steps/s
[Step=7950 Epoch=39.0] | Loss=0.03654 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.039 | L2-Norm(final)=5.189 | 2023.0 samples/s | 31.6 steps/s
[Step=8000 Epoch=39.2] | Loss=0.03571 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.051 | L2-Norm(final)=5.190 | 4892.6 samples/s | 76.4 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step8000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=6001 Epoch=57.1] | Loss=0.03878 | Reg=0.00225 | acc=0.9844 | L2-Norm=15.009 | L2-Norm(final)=4.434 | 3981.7 samples/s | 62.2 steps/s
[Step=6050 Epoch=57.6] | Loss=0.02420 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.327 | L2-Norm(final)=4.509 | 4818.4 samples/s | 75.3 steps/s
[Step=6100 Epoch=58.0] | Loss=0.01676 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.621 | L2-Norm(final)=4.585 | 7273.7 samples/s | 113.7 steps/s
[Step=6150 Epoch=58.5] | Loss=0.01291 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.791 | L2-Norm(final)=4.652 | 1850.6 samples/s | 28.9 steps/s
[Step=6200 Epoch=59.0] | Loss=0.01060 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.907 | L2-Norm(final)=4.710 | 6843.1 samples/s | 106.9 steps/s
[Step=6250 Epoch=59.5] | Loss=0.00919 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.997 | L2-Norm(final)=4.760 | 1884.4 samples/s | 29.4 steps/s
[Step=6300 Epoch=59.9] | Loss=0.00807 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.063 | L2-Norm(final)=4.806 | 6295.8 samples/s | 98.4 steps/s
[Step=6350 Epoch=60.4] | Loss=0.00722 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.115 | L2-Norm(final)=4.849 | 1990.2 samples/s | 31.1 steps/s
[Step=6400 Epoch=60.9] | Loss=0.00653 | Reg=0.00261 | acc=0.9844 | L2-Norm=16.153 | L2-Norm(final)=4.889 | 5543.8 samples/s | 86.6 steps/s
[Step=6450 Epoch=61.4] | Loss=0.00598 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.183 | L2-Norm(final)=4.927 | 1990.2 samples/s | 31.1 steps/s
[Step=6500 Epoch=61.8] | Loss=0.00550 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.205 | L2-Norm(final)=4.963 | 5438.2 samples/s | 85.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=61.8] | Loss=0.00078 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.389 | L2-Norm(final)=5.323 | 4018.1 samples/s | 62.8 steps/s
[Step=6550 Epoch=62.3] | Loss=0.04310 | Reg=0.00273 | acc=0.9531 | L2-Norm=16.511 | L2-Norm(final)=5.279 | 4585.6 samples/s | 71.7 steps/s
[Step=6600 Epoch=62.8] | Loss=0.03078 | Reg=0.00280 | acc=0.9844 | L2-Norm=16.718 | L2-Norm(final)=5.196 | 6453.4 samples/s | 100.8 steps/s
[Step=6650 Epoch=63.3] | Loss=0.02151 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.791 | L2-Norm(final)=5.178 | 1806.1 samples/s | 28.2 steps/s
[Step=6700 Epoch=63.7] | Loss=0.01625 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.812 | L2-Norm(final)=5.174 | 5870.1 samples/s | 91.7 steps/s
[Step=6750 Epoch=64.2] | Loss=0.01303 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.807 | L2-Norm(final)=5.173 | 1848.4 samples/s | 28.9 steps/s
[Step=6800 Epoch=64.7] | Loss=0.01087 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.789 | L2-Norm(final)=5.174 | 5325.8 samples/s | 83.2 steps/s
[Step=6850 Epoch=65.2] | Loss=0.00933 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.764 | L2-Norm(final)=5.175 | 1845.0 samples/s | 28.8 steps/s
[Step=6900 Epoch=65.6] | Loss=0.00817 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.734 | L2-Norm(final)=5.177 | 5076.9 samples/s | 79.3 steps/s
[Step=6950 Epoch=66.1] | Loss=0.00727 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.701 | L2-Norm(final)=5.178 | 1928.1 samples/s | 30.1 steps/s
[Step=7000 Epoch=66.6] | Loss=0.00654 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.667 | L2-Norm(final)=5.180 | 4687.9 samples/s | 73.2 steps/s
[Step=7050 Epoch=67.1] | Loss=0.00595 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.631 | L2-Norm(final)=5.181 | 1968.8 samples/s | 30.8 steps/s
[Step=7100 Epoch=67.5] | Loss=0.00546 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.594 | L2-Norm(final)=5.182 | 4732.9 samples/s | 74.0 steps/s
[Step=7150 Epoch=68.0] | Loss=0.00504 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.557 | L2-Norm(final)=5.184 | 1983.7 samples/s | 31.0 steps/s
[Step=7200 Epoch=68.5] | Loss=0.00468 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.519 | L2-Norm(final)=5.185 | 4681.2 samples/s | 73.1 steps/s
[Step=7250 Epoch=69.0] | Loss=0.00437 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.481 | L2-Norm(final)=5.187 | 2009.4 samples/s | 31.4 steps/s
[Step=7300 Epoch=69.4] | Loss=0.00410 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.443 | L2-Norm(final)=5.188 | 4631.0 samples/s | 72.4 steps/s
[Step=7350 Epoch=69.9] | Loss=0.00386 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.405 | L2-Norm(final)=5.189 | 2034.9 samples/s | 31.8 steps/s
[Step=7400 Epoch=70.4] | Loss=0.00365 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.366 | L2-Norm(final)=5.190 | 4620.6 samples/s | 72.2 steps/s
[Step=7450 Epoch=70.9] | Loss=0.00345 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.328 | L2-Norm(final)=5.192 | 6605.3 samples/s | 103.2 steps/s
[Step=7500 Epoch=71.3] | Loss=0.00328 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.290 | L2-Norm(final)=5.193 | 1791.7 samples/s | 28.0 steps/s
[Step=7550 Epoch=71.8] | Loss=0.00313 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.251 | L2-Norm(final)=5.194 | 5915.0 samples/s | 92.4 steps/s
[Step=7600 Epoch=72.3] | Loss=0.00299 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.213 | L2-Norm(final)=5.195 | 1821.0 samples/s | 28.5 steps/s
[Step=7650 Epoch=72.8] | Loss=0.00286 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.175 | L2-Norm(final)=5.196 | 5450.8 samples/s | 85.2 steps/s
[Step=7700 Epoch=73.2] | Loss=0.00274 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.136 | L2-Norm(final)=5.197 | 1850.0 samples/s | 28.9 steps/s
[Step=7750 Epoch=73.7] | Loss=0.00263 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.098 | L2-Norm(final)=5.198 | 5092.2 samples/s | 79.6 steps/s
[Step=7800 Epoch=74.2] | Loss=0.00253 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.060 | L2-Norm(final)=5.200 | 1922.5 samples/s | 30.0 steps/s
[Step=7850 Epoch=74.7] | Loss=0.00243 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.022 | L2-Norm(final)=5.201 | 4895.9 samples/s | 76.5 steps/s
[Step=7900 Epoch=75.1] | Loss=0.00235 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.984 | L2-Norm(final)=5.202 | 1973.3 samples/s | 30.8 steps/s
[Step=7950 Epoch=75.6] | Loss=0.00227 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.946 | L2-Norm(final)=5.203 | 4771.1 samples/s | 74.5 steps/s
[Step=8000 Epoch=76.1] | Loss=0.00219 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.908 | L2-Norm(final)=5.204 | 1984.7 samples/s | 31.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step8000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=4001 Epoch=37.7] | Loss=0.07423 | Reg=0.00225 | acc=0.9531 | L2-Norm=15.009 | L2-Norm(final)=3.858 | 3999.6 samples/s | 62.5 steps/s
[Step=4050 Epoch=38.2] | Loss=0.03461 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.303 | L2-Norm(final)=3.915 | 4680.9 samples/s | 73.1 steps/s
[Step=4100 Epoch=38.6] | Loss=0.02732 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.580 | L2-Norm(final)=3.983 | 7252.6 samples/s | 113.3 steps/s
[Step=4150 Epoch=39.1] | Loss=0.02161 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.777 | L2-Norm(final)=4.042 | 1859.8 samples/s | 29.1 steps/s
[Step=4200 Epoch=39.6] | Loss=0.01897 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.935 | L2-Norm(final)=4.100 | 6472.9 samples/s | 101.1 steps/s
[Step=4250 Epoch=40.0] | Loss=0.01683 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.074 | L2-Norm(final)=4.153 | 1926.8 samples/s | 30.1 steps/s
[Step=4300 Epoch=40.5] | Loss=0.01510 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.190 | L2-Norm(final)=4.203 | 6068.0 samples/s | 94.8 steps/s
[Step=4350 Epoch=41.0] | Loss=0.01359 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.289 | L2-Norm(final)=4.251 | 1948.7 samples/s | 30.4 steps/s
[Step=4400 Epoch=41.5] | Loss=0.01241 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.374 | L2-Norm(final)=4.296 | 5553.0 samples/s | 86.8 steps/s
[Step=4450 Epoch=41.9] | Loss=0.01148 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.448 | L2-Norm(final)=4.339 | 2047.8 samples/s | 32.0 steps/s
[Step=4500 Epoch=42.4] | Loss=0.01075 | Reg=0.00273 | acc=0.9844 | L2-Norm=16.514 | L2-Norm(final)=4.381 | 5374.9 samples/s | 84.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=42.4] | Loss=0.00203 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.122 | L2-Norm(final)=4.787 | 3733.1 samples/s | 58.3 steps/s
[Step=4550 Epoch=42.9] | Loss=0.01366 | Reg=0.00295 | acc=0.9688 | L2-Norm=17.162 | L2-Norm(final)=4.803 | 4487.5 samples/s | 70.1 steps/s
[Step=4600 Epoch=43.3] | Loss=0.01755 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.264 | L2-Norm(final)=4.774 | 6360.9 samples/s | 99.4 steps/s
[Step=4650 Epoch=43.8] | Loss=0.01229 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.319 | L2-Norm(final)=4.762 | 1791.7 samples/s | 28.0 steps/s
[Step=4700 Epoch=44.3] | Loss=0.00933 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.330 | L2-Norm(final)=4.760 | 5534.2 samples/s | 86.5 steps/s
[Step=4750 Epoch=44.8] | Loss=0.00750 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.321 | L2-Norm(final)=4.761 | 1834.0 samples/s | 28.7 steps/s
[Step=4800 Epoch=45.2] | Loss=0.00626 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.303 | L2-Norm(final)=4.762 | 5146.6 samples/s | 80.4 steps/s
[Step=4850 Epoch=45.7] | Loss=0.00537 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.278 | L2-Norm(final)=4.763 | 1890.6 samples/s | 29.5 steps/s
[Step=4900 Epoch=46.2] | Loss=0.00470 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.250 | L2-Norm(final)=4.764 | 4950.0 samples/s | 77.3 steps/s
[Step=4950 Epoch=46.6] | Loss=0.00418 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.219 | L2-Norm(final)=4.765 | 1987.3 samples/s | 31.1 steps/s
[Step=5000 Epoch=47.1] | Loss=0.00377 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.187 | L2-Norm(final)=4.766 | 4549.1 samples/s | 71.1 steps/s
[Step=5050 Epoch=47.6] | Loss=0.00343 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.154 | L2-Norm(final)=4.767 | 1992.6 samples/s | 31.1 steps/s
[Step=5100 Epoch=48.1] | Loss=0.00314 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.120 | L2-Norm(final)=4.768 | 4726.3 samples/s | 73.8 steps/s
[Step=5150 Epoch=48.5] | Loss=0.00290 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.085 | L2-Norm(final)=4.769 | 2003.2 samples/s | 31.3 steps/s
[Step=5200 Epoch=49.0] | Loss=0.00270 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.050 | L2-Norm(final)=4.770 | 4535.4 samples/s | 70.9 steps/s
[Step=5250 Epoch=49.5] | Loss=0.00252 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.015 | L2-Norm(final)=4.772 | 2140.8 samples/s | 33.4 steps/s
[Step=5300 Epoch=49.9] | Loss=0.00236 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.980 | L2-Norm(final)=4.773 | 4272.1 samples/s | 66.8 steps/s
[Step=5350 Epoch=50.4] | Loss=0.00223 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.944 | L2-Norm(final)=4.774 | 6255.3 samples/s | 97.7 steps/s
[Step=5400 Epoch=50.9] | Loss=0.00210 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.908 | L2-Norm(final)=4.775 | 1778.6 samples/s | 27.8 steps/s
[Step=5450 Epoch=51.4] | Loss=0.00199 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.872 | L2-Norm(final)=4.776 | 5867.1 samples/s | 91.7 steps/s
[Step=5500 Epoch=51.8] | Loss=0.00189 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.836 | L2-Norm(final)=4.777 | 1856.1 samples/s | 29.0 steps/s
[Step=5550 Epoch=52.3] | Loss=0.00180 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.800 | L2-Norm(final)=4.779 | 5311.8 samples/s | 83.0 steps/s
[Step=5600 Epoch=52.8] | Loss=0.00172 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.764 | L2-Norm(final)=4.780 | 1892.5 samples/s | 29.6 steps/s
[Step=5650 Epoch=53.2] | Loss=0.00165 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.729 | L2-Norm(final)=4.781 | 5016.3 samples/s | 78.4 steps/s
[Step=5700 Epoch=53.7] | Loss=0.00158 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.693 | L2-Norm(final)=4.783 | 1959.4 samples/s | 30.6 steps/s
[Step=5750 Epoch=54.2] | Loss=0.00152 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.656 | L2-Norm(final)=4.784 | 4802.5 samples/s | 75.0 steps/s
[Step=5800 Epoch=54.7] | Loss=0.00146 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.620 | L2-Norm(final)=4.786 | 1989.5 samples/s | 31.1 steps/s
[Step=5850 Epoch=55.1] | Loss=0.00141 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.584 | L2-Norm(final)=4.787 | 4716.1 samples/s | 73.7 steps/s
[Step=5900 Epoch=55.6] | Loss=0.00136 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.549 | L2-Norm(final)=4.789 | 1971.7 samples/s | 30.8 steps/s
[Step=5950 Epoch=56.1] | Loss=0.00131 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.513 | L2-Norm(final)=4.791 | 4679.5 samples/s | 73.1 steps/s
[Step=6000 Epoch=56.5] | Loss=0.00127 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.477 | L2-Norm(final)=4.793 | 1999.4 samples/s | 31.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step6000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.13441 | acc=0.9273 | tpr=0.9334 | fpr=0.0860 | 4313.1 samples/s | 16.8 steps/s
Avg test loss: 0.13704, Avg test acc: 0.92680, Avg tpr: 0.93408, Avg fpr: 0.08922, total FA: 696

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14531 | acc=0.9354 | tpr=0.9612 | fpr=0.1207 | 4386.8 samples/s | 17.1 steps/s
Avg test loss: 0.14730, Avg test acc: 0.93481, Avg tpr: 0.96130, Avg fpr: 0.12345, total FA: 963

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.14415 | acc=0.9384 | tpr=0.9547 | fpr=0.0969 | 4433.2 samples/s | 17.3 steps/s
Avg test loss: 0.14380, Avg test acc: 0.93557, Avg tpr: 0.95162, Avg fpr: 0.09973, total FA: 778

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.32229 | acc=0.6802 | tpr=0.9925 | fpr=0.9980 | 4345.2 samples/s | 17.0 steps/s
Avg test loss: 0.32090, Avg test acc: 0.68343, Avg tpr: 0.99318, Avg fpr: 0.99782, total FA: 7784

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.13912 | acc=0.9402 | tpr=0.9604 | fpr=0.1038 | 4317.5 samples/s | 16.9 steps/s
Avg test loss: 0.14619, Avg test acc: 0.93665, Avg tpr: 0.95681, Avg fpr: 0.10768, total FA: 840

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=3.87613 | acc=0.3195 | tpr=0.0175 | fpr=0.0245 | 4491.4 samples/s | 17.5 steps/s
Avg test loss: 3.87277, Avg test acc: 0.31781, Avg tpr: 0.01818, Avg fpr: 0.02320, total FA: 181

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=3.88634 | acc=0.3151 | tpr=0.0019 | fpr=0.0050 | 4375.9 samples/s | 17.1 steps/s
Avg test loss: 3.89320, Avg test acc: 0.31273, Avg tpr: 0.00216, Avg fpr: 0.00423, total FA: 33

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.00413 | acc=0.3162 | tpr=0.0042 | fpr=0.0062 | 4346.5 samples/s | 17.0 steps/s
Avg test loss: 4.01594, Avg test acc: 0.31325, Avg tpr: 0.00420, Avg fpr: 0.00705, total FA: 55

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=3.95108 | acc=0.3153 | tpr=0.0015 | fpr=0.0032 | 4345.4 samples/s | 17.0 steps/s
Avg test loss: 3.96789, Avg test acc: 0.31289, Avg tpr: 0.00169, Avg fpr: 0.00269, total FA: 21

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=3.83227 | acc=0.3166 | tpr=0.0116 | fpr=0.0211 | 4337.4 samples/s | 16.9 steps/s
Avg test loss: 3.82612, Avg test acc: 0.31509, Avg tpr: 0.01241, Avg fpr: 0.01923, total FA: 150

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.53435 | acc=0.1654 | tpr=0.7124 | fpr=0.8444 | 4362.8 samples/s | 17.0 steps/s
[Step= 100] | Loss=3.50980 | acc=0.1673 | tpr=0.6588 | fpr=0.8418 | 8727.9 samples/s | 34.1 steps/s
[Step= 150] | Loss=3.50734 | acc=0.1663 | tpr=0.6484 | fpr=0.8426 | 8571.4 samples/s | 33.5 steps/s
[Step= 200] | Loss=3.50299 | acc=0.1655 | tpr=0.6470 | fpr=0.8432 | 8064.5 samples/s | 31.5 steps/s
[Step= 250] | Loss=3.51334 | acc=0.1648 | tpr=0.6384 | fpr=0.8438 | 8414.1 samples/s | 32.9 steps/s
[Step= 300] | Loss=3.51167 | acc=0.1646 | tpr=0.6371 | fpr=0.8440 | 8684.0 samples/s | 33.9 steps/s
[Step= 350] | Loss=3.50763 | acc=0.1648 | tpr=0.6312 | fpr=0.8437 | 7356.4 samples/s | 28.7 steps/s
[Step= 400] | Loss=3.50423 | acc=0.1651 | tpr=0.6286 | fpr=0.8433 | 5972.9 samples/s | 23.3 steps/s
[Step= 450] | Loss=3.50173 | acc=0.1654 | tpr=0.6339 | fpr=0.8431 | 8057.6 samples/s | 31.5 steps/s
[Step= 500] | Loss=3.50009 | acc=0.1653 | tpr=0.6322 | fpr=0.8432 | 8648.5 samples/s | 33.8 steps/s
[Step= 550] | Loss=3.50417 | acc=0.1649 | tpr=0.6327 | fpr=0.8437 | 15133.4 samples/s | 59.1 steps/s
Avg test loss: 3.50493, Avg test acc: 0.16471, Avg tpr: 0.63193, Avg fpr: 0.84378, total FA: 117157

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.47559 | acc=0.0979 | tpr=0.7035 | fpr=0.9130 | 4389.0 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.46220 | acc=0.0995 | tpr=0.6802 | fpr=0.9113 | 8352.1 samples/s | 32.6 steps/s
[Step= 150] | Loss=4.46728 | acc=0.0993 | tpr=0.6844 | fpr=0.9115 | 8264.6 samples/s | 32.3 steps/s
[Step= 200] | Loss=4.45838 | acc=0.0991 | tpr=0.6754 | fpr=0.9114 | 7100.8 samples/s | 27.7 steps/s
[Step= 250] | Loss=4.45515 | acc=0.0995 | tpr=0.6716 | fpr=0.9109 | 8425.8 samples/s | 32.9 steps/s
[Step= 300] | Loss=4.45302 | acc=0.0995 | tpr=0.6771 | fpr=0.9111 | 8624.4 samples/s | 33.7 steps/s
[Step= 350] | Loss=4.44490 | acc=0.1000 | tpr=0.6706 | fpr=0.9104 | 5873.0 samples/s | 22.9 steps/s
[Step= 400] | Loss=4.44760 | acc=0.0997 | tpr=0.6707 | fpr=0.9106 | 8992.8 samples/s | 35.1 steps/s
[Step= 450] | Loss=4.45526 | acc=0.0993 | tpr=0.6704 | fpr=0.9110 | 8658.3 samples/s | 33.8 steps/s
[Step= 500] | Loss=4.45670 | acc=0.0990 | tpr=0.6674 | fpr=0.9113 | 8268.1 samples/s | 32.3 steps/s
[Step= 550] | Loss=4.45998 | acc=0.0987 | tpr=0.6641 | fpr=0.9116 | 14711.3 samples/s | 57.5 steps/s
Avg test loss: 4.46119, Avg test acc: 0.09863, Avg tpr: 0.66323, Avg fpr: 0.91163, total FA: 126578

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.17056 | acc=0.1210 | tpr=0.5929 | fpr=0.8875 | 4369.4 samples/s | 17.1 steps/s
[Step= 100] | Loss=5.16136 | acc=0.1190 | tpr=0.5565 | fpr=0.8892 | 8383.3 samples/s | 32.7 steps/s
[Step= 150] | Loss=5.16800 | acc=0.1195 | tpr=0.5461 | fpr=0.8883 | 7141.5 samples/s | 27.9 steps/s
[Step= 200] | Loss=5.15796 | acc=0.1191 | tpr=0.5464 | fpr=0.8887 | 8410.7 samples/s | 32.9 steps/s
[Step= 250] | Loss=5.15879 | acc=0.1192 | tpr=0.5415 | fpr=0.8885 | 8870.9 samples/s | 34.7 steps/s
[Step= 300] | Loss=5.16048 | acc=0.1194 | tpr=0.5433 | fpr=0.8883 | 8629.7 samples/s | 33.7 steps/s
[Step= 350] | Loss=5.15503 | acc=0.1197 | tpr=0.5416 | fpr=0.8880 | 5725.8 samples/s | 22.4 steps/s
[Step= 400] | Loss=5.15514 | acc=0.1198 | tpr=0.5416 | fpr=0.8879 | 8430.8 samples/s | 32.9 steps/s
[Step= 450] | Loss=5.15321 | acc=0.1202 | tpr=0.5424 | fpr=0.8875 | 8576.4 samples/s | 33.5 steps/s
[Step= 500] | Loss=5.15828 | acc=0.1198 | tpr=0.5370 | fpr=0.8878 | 8581.9 samples/s | 33.5 steps/s
[Step= 550] | Loss=5.15720 | acc=0.1198 | tpr=0.5384 | fpr=0.8878 | 15575.8 samples/s | 60.8 steps/s
Avg test loss: 5.15806, Avg test acc: 0.11968, Avg tpr: 0.53883, Avg fpr: 0.88794, total FA: 123288

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=0.49347 | acc=0.0224 | tpr=1.0000 | fpr=0.9951 | 4378.6 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.49431 | acc=0.0224 | tpr=1.0000 | fpr=0.9958 | 8644.8 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.49466 | acc=0.0221 | tpr=1.0000 | fpr=0.9959 | 7571.2 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.49447 | acc=0.0218 | tpr=1.0000 | fpr=0.9960 | 8319.6 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.49484 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8821.3 samples/s | 34.5 steps/s
[Step= 300] | Loss=0.49501 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 7736.7 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.49495 | acc=0.0215 | tpr=1.0000 | fpr=0.9962 | 5796.1 samples/s | 22.6 steps/s
[Step= 400] | Loss=0.49496 | acc=0.0216 | tpr=1.0000 | fpr=0.9962 | 8649.3 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.49497 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 8500.8 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.49508 | acc=0.0214 | tpr=1.0000 | fpr=0.9963 | 8330.1 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.49497 | acc=0.0215 | tpr=1.0000 | fpr=0.9963 | 15719.3 samples/s | 61.4 steps/s
Avg test loss: 0.49495, Avg test acc: 0.02145, Avg tpr: 1.00000, Avg fpr: 0.99633, total FA: 138339

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.06837 | acc=0.1248 | tpr=0.8142 | fpr=0.8876 | 4357.8 samples/s | 17.0 steps/s
[Step= 100] | Loss=5.03964 | acc=0.1234 | tpr=0.7569 | fpr=0.8884 | 8409.5 samples/s | 32.8 steps/s
[Step= 150] | Loss=5.05808 | acc=0.1226 | tpr=0.7522 | fpr=0.8890 | 7938.2 samples/s | 31.0 steps/s
[Step= 200] | Loss=5.04998 | acc=0.1221 | tpr=0.7344 | fpr=0.8890 | 8997.3 samples/s | 35.1 steps/s
[Step= 250] | Loss=5.05487 | acc=0.1219 | tpr=0.7328 | fpr=0.8893 | 8328.8 samples/s | 32.5 steps/s
[Step= 300] | Loss=5.05600 | acc=0.1215 | tpr=0.7367 | fpr=0.8897 | 5262.2 samples/s | 20.6 steps/s
[Step= 350] | Loss=5.05248 | acc=0.1211 | tpr=0.7370 | fpr=0.8901 | 8345.3 samples/s | 32.6 steps/s
[Step= 400] | Loss=5.05473 | acc=0.1211 | tpr=0.7374 | fpr=0.8901 | 8860.1 samples/s | 34.6 steps/s
[Step= 450] | Loss=5.05283 | acc=0.1213 | tpr=0.7439 | fpr=0.8900 | 8519.0 samples/s | 33.3 steps/s
[Step= 500] | Loss=5.05468 | acc=0.1213 | tpr=0.7419 | fpr=0.8899 | 8327.0 samples/s | 32.5 steps/s
[Step= 550] | Loss=5.05584 | acc=0.1210 | tpr=0.7449 | fpr=0.8903 | 15647.9 samples/s | 61.1 steps/s
Avg test loss: 5.05646, Avg test acc: 0.12091, Avg tpr: 0.74485, Avg fpr: 0.89043, total FA: 123635

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.05105 | acc=0.9795 | tpr=0.8053 | fpr=0.0173 | 4331.6 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.04880 | acc=0.9795 | tpr=0.8124 | fpr=0.0173 | 6866.0 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.04998 | acc=0.9793 | tpr=0.8112 | fpr=0.0176 | 8391.2 samples/s | 32.8 steps/s
[Step= 200] | Loss=0.05094 | acc=0.9792 | tpr=0.8219 | fpr=0.0179 | 8702.3 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.05087 | acc=0.9793 | tpr=0.8183 | fpr=0.0178 | 8457.8 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.05156 | acc=0.9790 | tpr=0.8145 | fpr=0.0180 | 6079.7 samples/s | 23.7 steps/s
[Step= 350] | Loss=0.05108 | acc=0.9791 | tpr=0.8178 | fpr=0.0180 | 8416.0 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.05154 | acc=0.9789 | tpr=0.8129 | fpr=0.0181 | 8360.8 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.05234 | acc=0.9787 | tpr=0.8116 | fpr=0.0183 | 8628.3 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.05192 | acc=0.9789 | tpr=0.8145 | fpr=0.0182 | 8378.3 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.05123 | acc=0.9790 | tpr=0.8158 | fpr=0.0181 | 15358.9 samples/s | 60.0 steps/s
Avg test loss: 0.05119, Avg test acc: 0.97894, Avg tpr: 0.81498, Avg fpr: 0.01808, total FA: 2510

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.09558 | acc=0.9819 | tpr=0.8274 | fpr=0.0153 | 4356.1 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.10004 | acc=0.9807 | tpr=0.8337 | fpr=0.0165 | 7349.5 samples/s | 28.7 steps/s
[Step= 150] | Loss=0.10377 | acc=0.9803 | tpr=0.8444 | fpr=0.0172 | 8509.7 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.10744 | acc=0.9803 | tpr=0.8459 | fpr=0.0172 | 8577.9 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.10515 | acc=0.9805 | tpr=0.8454 | fpr=0.0170 | 7962.0 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.10712 | acc=0.9801 | tpr=0.8451 | fpr=0.0174 | 5955.4 samples/s | 23.3 steps/s
[Step= 350] | Loss=0.10762 | acc=0.9801 | tpr=0.8516 | fpr=0.0176 | 8657.0 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.10839 | acc=0.9798 | tpr=0.8474 | fpr=0.0178 | 8450.0 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.11080 | acc=0.9795 | tpr=0.8457 | fpr=0.0181 | 9160.3 samples/s | 35.8 steps/s
[Step= 500] | Loss=0.11034 | acc=0.9796 | tpr=0.8471 | fpr=0.0180 | 7962.2 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.10967 | acc=0.9797 | tpr=0.8476 | fpr=0.0179 | 15922.6 samples/s | 62.2 steps/s
Avg test loss: 0.10944, Avg test acc: 0.97975, Avg tpr: 0.84746, Avg fpr: 0.01785, total FA: 2478

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.09985 | acc=0.9800 | tpr=0.8982 | fpr=0.0185 | 4335.6 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.10088 | acc=0.9791 | tpr=0.9019 | fpr=0.0195 | 7453.3 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.10410 | acc=0.9782 | tpr=0.9006 | fpr=0.0203 | 8867.7 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.10458 | acc=0.9783 | tpr=0.9005 | fpr=0.0203 | 8435.4 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.10354 | acc=0.9784 | tpr=0.8969 | fpr=0.0201 | 5388.5 samples/s | 21.0 steps/s
[Step= 300] | Loss=0.10527 | acc=0.9779 | tpr=0.8924 | fpr=0.0205 | 8714.9 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.10614 | acc=0.9777 | tpr=0.8917 | fpr=0.0207 | 8379.9 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.10723 | acc=0.9775 | tpr=0.8884 | fpr=0.0209 | 8858.0 samples/s | 34.6 steps/s
[Step= 450] | Loss=0.10859 | acc=0.9773 | tpr=0.8875 | fpr=0.0211 | 8355.1 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.10770 | acc=0.9773 | tpr=0.8912 | fpr=0.0211 | 8485.0 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.10650 | acc=0.9776 | tpr=0.8914 | fpr=0.0209 | 15396.9 samples/s | 60.1 steps/s
Avg test loss: 0.10629, Avg test acc: 0.97758, Avg tpr: 0.89184, Avg fpr: 0.02086, total FA: 2896

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11254 | acc=0.9815 | tpr=0.8717 | fpr=0.0165 | 4197.9 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.11803 | acc=0.9805 | tpr=0.8678 | fpr=0.0173 | 8472.1 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.12264 | acc=0.9793 | tpr=0.8660 | fpr=0.0186 | 8607.7 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.12464 | acc=0.9794 | tpr=0.8754 | fpr=0.0187 | 8712.9 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.12196 | acc=0.9797 | tpr=0.8777 | fpr=0.0184 | 5243.0 samples/s | 20.5 steps/s
[Step= 300] | Loss=0.12528 | acc=0.9792 | tpr=0.8749 | fpr=0.0189 | 8626.3 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.12608 | acc=0.9790 | tpr=0.8817 | fpr=0.0192 | 8594.2 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.12719 | acc=0.9788 | tpr=0.8769 | fpr=0.0193 | 9128.1 samples/s | 35.7 steps/s
[Step= 450] | Loss=0.12986 | acc=0.9784 | tpr=0.8744 | fpr=0.0197 | 8035.0 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.12890 | acc=0.9785 | tpr=0.8758 | fpr=0.0197 | 8584.7 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.12792 | acc=0.9787 | tpr=0.8758 | fpr=0.0195 | 16120.2 samples/s | 63.0 steps/s
Avg test loss: 0.12761, Avg test acc: 0.97870, Avg tpr: 0.87599, Avg fpr: 0.01943, total FA: 2698

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.06004 | acc=0.9784 | tpr=0.8009 | fpr=0.0185 | 4425.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.05947 | acc=0.9780 | tpr=0.8124 | fpr=0.0189 | 8576.4 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.06023 | acc=0.9770 | tpr=0.8141 | fpr=0.0200 | 8351.8 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.06128 | acc=0.9771 | tpr=0.8197 | fpr=0.0200 | 8588.7 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.06088 | acc=0.9772 | tpr=0.8131 | fpr=0.0198 | 5036.1 samples/s | 19.7 steps/s
[Step= 300] | Loss=0.06211 | acc=0.9769 | tpr=0.8080 | fpr=0.0200 | 8651.2 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.06231 | acc=0.9768 | tpr=0.8109 | fpr=0.0202 | 8577.0 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.06297 | acc=0.9765 | tpr=0.8025 | fpr=0.0204 | 8657.4 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.06410 | acc=0.9763 | tpr=0.8033 | fpr=0.0206 | 8509.9 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.06354 | acc=0.9764 | tpr=0.8048 | fpr=0.0205 | 8581.5 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.06294 | acc=0.9766 | tpr=0.8062 | fpr=0.0203 | 14948.6 samples/s | 58.4 steps/s
Avg test loss: 0.06281, Avg test acc: 0.97657, Avg tpr: 0.80547, Avg fpr: 0.02032, total FA: 2822

server round 6/50

clients selected: [0 2 3 5 6]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=8001 Epoch=39.0] | Loss=0.05896 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.790 | L2-Norm(final)=4.980 | 3857.5 samples/s | 60.3 steps/s
[Step=8050 Epoch=39.3] | Loss=0.11272 | Reg=0.00225 | acc=0.8906 | L2-Norm=14.984 | L2-Norm(final)=5.053 | 5301.3 samples/s | 82.8 steps/s
[Step=8100 Epoch=39.5] | Loss=0.11015 | Reg=0.00230 | acc=0.9375 | L2-Norm=15.177 | L2-Norm(final)=5.112 | 5428.9 samples/s | 84.8 steps/s
[Step=8150 Epoch=39.7] | Loss=0.10597 | Reg=0.00235 | acc=0.8438 | L2-Norm=15.339 | L2-Norm(final)=5.160 | 5523.8 samples/s | 86.3 steps/s
[Step=8200 Epoch=40.0] | Loss=0.10130 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.477 | L2-Norm(final)=5.204 | 7767.3 samples/s | 121.4 steps/s
[Step=8250 Epoch=40.2] | Loss=0.09839 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.604 | L2-Norm(final)=5.247 | 1930.7 samples/s | 30.2 steps/s
[Step=8300 Epoch=40.5] | Loss=0.09533 | Reg=0.00248 | acc=0.9375 | L2-Norm=15.731 | L2-Norm(final)=5.290 | 5454.3 samples/s | 85.2 steps/s
[Step=8350 Epoch=40.7] | Loss=0.09351 | Reg=0.00251 | acc=0.9531 | L2-Norm=15.848 | L2-Norm(final)=5.336 | 5553.1 samples/s | 86.8 steps/s
[Step=8400 Epoch=41.0] | Loss=0.09087 | Reg=0.00255 | acc=0.9219 | L2-Norm=15.962 | L2-Norm(final)=5.382 | 7050.8 samples/s | 110.2 steps/s
[Step=8450 Epoch=41.2] | Loss=0.08860 | Reg=0.00259 | acc=0.9688 | L2-Norm=16.072 | L2-Norm(final)=5.429 | 1974.7 samples/s | 30.9 steps/s
[Step=8500 Epoch=41.4] | Loss=0.08739 | Reg=0.00262 | acc=0.9531 | L2-Norm=16.180 | L2-Norm(final)=5.475 | 5498.1 samples/s | 85.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=41.5] | Loss=0.05827 | Reg=0.00298 | acc=0.9688 | L2-Norm=17.256 | L2-Norm(final)=5.929 | 3951.1 samples/s | 61.7 steps/s
[Step=8550 Epoch=41.7] | Loss=0.11014 | Reg=0.00302 | acc=0.9531 | L2-Norm=17.369 | L2-Norm(final)=5.920 | 4463.1 samples/s | 69.7 steps/s
[Step=8600 Epoch=41.9] | Loss=0.10318 | Reg=0.00305 | acc=0.9219 | L2-Norm=17.451 | L2-Norm(final)=5.896 | 4822.8 samples/s | 75.4 steps/s
[Step=8650 Epoch=42.2] | Loss=0.09599 | Reg=0.00307 | acc=0.9219 | L2-Norm=17.507 | L2-Norm(final)=5.877 | 4760.8 samples/s | 74.4 steps/s
[Step=8700 Epoch=42.4] | Loss=0.09079 | Reg=0.00308 | acc=0.9531 | L2-Norm=17.554 | L2-Norm(final)=5.866 | 6448.4 samples/s | 100.8 steps/s
[Step=8750 Epoch=42.7] | Loss=0.08143 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.598 | L2-Norm(final)=5.861 | 1856.9 samples/s | 29.0 steps/s
[Step=8800 Epoch=42.9] | Loss=0.07526 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.638 | L2-Norm(final)=5.860 | 4792.2 samples/s | 74.9 steps/s
[Step=8850 Epoch=43.2] | Loss=0.07157 | Reg=0.00312 | acc=0.9688 | L2-Norm=17.671 | L2-Norm(final)=5.855 | 4814.0 samples/s | 75.2 steps/s
[Step=8900 Epoch=43.4] | Loss=0.06829 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.699 | L2-Norm(final)=5.852 | 6073.8 samples/s | 94.9 steps/s
[Step=8950 Epoch=43.6] | Loss=0.06404 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.725 | L2-Norm(final)=5.850 | 1877.6 samples/s | 29.3 steps/s
[Step=9000 Epoch=43.9] | Loss=0.06078 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.749 | L2-Norm(final)=5.849 | 4824.1 samples/s | 75.4 steps/s
[Step=9050 Epoch=44.1] | Loss=0.05766 | Reg=0.00316 | acc=0.9844 | L2-Norm=17.772 | L2-Norm(final)=5.848 | 4815.3 samples/s | 75.2 steps/s
[Step=9100 Epoch=44.4] | Loss=0.05548 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.794 | L2-Norm(final)=5.849 | 5681.9 samples/s | 88.8 steps/s
[Step=9150 Epoch=44.6] | Loss=0.05326 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.815 | L2-Norm(final)=5.850 | 1945.4 samples/s | 30.4 steps/s
[Step=9200 Epoch=44.9] | Loss=0.05126 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.836 | L2-Norm(final)=5.851 | 4847.1 samples/s | 75.7 steps/s
[Step=9250 Epoch=45.1] | Loss=0.04953 | Reg=0.00319 | acc=0.9688 | L2-Norm=17.856 | L2-Norm(final)=5.853 | 4792.2 samples/s | 74.9 steps/s
[Step=9300 Epoch=45.3] | Loss=0.04832 | Reg=0.00320 | acc=0.9688 | L2-Norm=17.875 | L2-Norm(final)=5.854 | 5362.0 samples/s | 83.8 steps/s
[Step=9350 Epoch=45.6] | Loss=0.04640 | Reg=0.00320 | acc=0.9688 | L2-Norm=17.893 | L2-Norm(final)=5.855 | 1986.6 samples/s | 31.0 steps/s
[Step=9400 Epoch=45.8] | Loss=0.04481 | Reg=0.00321 | acc=0.9688 | L2-Norm=17.909 | L2-Norm(final)=5.858 | 4953.1 samples/s | 77.4 steps/s
[Step=9450 Epoch=46.1] | Loss=0.04367 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.924 | L2-Norm(final)=5.859 | 4918.2 samples/s | 76.8 steps/s
[Step=9500 Epoch=46.3] | Loss=0.04248 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.938 | L2-Norm(final)=5.860 | 4882.0 samples/s | 76.3 steps/s
[Step=9550 Epoch=46.6] | Loss=0.04137 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.953 | L2-Norm(final)=5.861 | 2034.3 samples/s | 31.8 steps/s
[Step=9600 Epoch=46.8] | Loss=0.04016 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.967 | L2-Norm(final)=5.862 | 4975.3 samples/s | 77.7 steps/s
[Step=9650 Epoch=47.1] | Loss=0.03922 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.980 | L2-Norm(final)=5.863 | 4974.4 samples/s | 77.7 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03855 | Reg=0.00324 | acc=0.9844 | L2-Norm=17.993 | L2-Norm(final)=5.864 | 4873.2 samples/s | 76.1 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03783 | Reg=0.00324 | acc=0.9844 | L2-Norm=18.006 | L2-Norm(final)=5.865 | 2057.6 samples/s | 32.2 steps/s
[Step=9800 Epoch=47.8] | Loss=0.03686 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.018 | L2-Norm(final)=5.865 | 5081.6 samples/s | 79.4 steps/s
[Step=9850 Epoch=48.0] | Loss=0.03623 | Reg=0.00325 | acc=0.9531 | L2-Norm=18.031 | L2-Norm(final)=5.866 | 4856.8 samples/s | 75.9 steps/s
[Step=9900 Epoch=48.3] | Loss=0.03553 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.043 | L2-Norm(final)=5.867 | 5028.2 samples/s | 78.6 steps/s
[Step=9950 Epoch=48.5] | Loss=0.03490 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.056 | L2-Norm(final)=5.867 | 2056.4 samples/s | 32.1 steps/s
[Step=10000 Epoch=48.8] | Loss=0.03424 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.068 | L2-Norm(final)=5.868 | 4932.1 samples/s | 77.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step10000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=6001 Epoch=29.2] | Loss=0.13437 | Reg=0.00219 | acc=0.8594 | L2-Norm=14.790 | L2-Norm(final)=4.542 | 4046.9 samples/s | 63.2 steps/s
[Step=6050 Epoch=29.5] | Loss=0.11720 | Reg=0.00227 | acc=0.9219 | L2-Norm=15.072 | L2-Norm(final)=4.636 | 5030.8 samples/s | 78.6 steps/s
[Step=6100 Epoch=29.7] | Loss=0.10754 | Reg=0.00235 | acc=0.8594 | L2-Norm=15.312 | L2-Norm(final)=4.706 | 5520.9 samples/s | 86.3 steps/s
[Step=6150 Epoch=30.0] | Loss=0.10448 | Reg=0.00240 | acc=0.9062 | L2-Norm=15.495 | L2-Norm(final)=4.761 | 5484.0 samples/s | 85.7 steps/s
[Step=6200 Epoch=30.2] | Loss=0.10099 | Reg=0.00245 | acc=0.9375 | L2-Norm=15.651 | L2-Norm(final)=4.810 | 7818.2 samples/s | 122.2 steps/s
[Step=6250 Epoch=30.5] | Loss=0.09696 | Reg=0.00250 | acc=0.9531 | L2-Norm=15.789 | L2-Norm(final)=4.853 | 1911.9 samples/s | 29.9 steps/s
[Step=6300 Epoch=30.7] | Loss=0.09564 | Reg=0.00254 | acc=0.9375 | L2-Norm=15.914 | L2-Norm(final)=4.892 | 5409.7 samples/s | 84.5 steps/s
[Step=6350 Epoch=30.9] | Loss=0.09442 | Reg=0.00257 | acc=0.9219 | L2-Norm=16.033 | L2-Norm(final)=4.929 | 5516.3 samples/s | 86.2 steps/s
[Step=6400 Epoch=31.2] | Loss=0.09402 | Reg=0.00261 | acc=0.9219 | L2-Norm=16.144 | L2-Norm(final)=4.964 | 7139.4 samples/s | 111.6 steps/s
[Step=6450 Epoch=31.4] | Loss=0.09176 | Reg=0.00264 | acc=0.9062 | L2-Norm=16.251 | L2-Norm(final)=4.999 | 1303.9 samples/s | 20.4 steps/s
[Step=6500 Epoch=31.7] | Loss=0.09018 | Reg=0.00268 | acc=0.9688 | L2-Norm=16.352 | L2-Norm(final)=5.036 | 5485.0 samples/s | 85.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=31.7] | Loss=0.09420 | Reg=0.00301 | acc=0.9062 | L2-Norm=17.353 | L2-Norm(final)=5.424 | 4152.9 samples/s | 64.9 steps/s
[Step=6550 Epoch=31.9] | Loss=0.10961 | Reg=0.00305 | acc=0.9375 | L2-Norm=17.461 | L2-Norm(final)=5.425 | 4618.6 samples/s | 72.2 steps/s
[Step=6600 Epoch=32.2] | Loss=0.10111 | Reg=0.00307 | acc=0.9375 | L2-Norm=17.526 | L2-Norm(final)=5.401 | 4938.4 samples/s | 77.2 steps/s
[Step=6650 Epoch=32.4] | Loss=0.09791 | Reg=0.00308 | acc=0.9531 | L2-Norm=17.559 | L2-Norm(final)=5.382 | 4925.1 samples/s | 77.0 steps/s
[Step=6700 Epoch=32.6] | Loss=0.09286 | Reg=0.00309 | acc=0.9219 | L2-Norm=17.587 | L2-Norm(final)=5.370 | 6552.6 samples/s | 102.4 steps/s
[Step=6750 Epoch=32.9] | Loss=0.08423 | Reg=0.00310 | acc=0.9531 | L2-Norm=17.616 | L2-Norm(final)=5.363 | 1888.0 samples/s | 29.5 steps/s
[Step=6800 Epoch=33.1] | Loss=0.07798 | Reg=0.00311 | acc=0.9688 | L2-Norm=17.640 | L2-Norm(final)=5.361 | 4769.0 samples/s | 74.5 steps/s
[Step=6850 Epoch=33.4] | Loss=0.07307 | Reg=0.00312 | acc=0.9844 | L2-Norm=17.663 | L2-Norm(final)=5.359 | 4830.3 samples/s | 75.5 steps/s
[Step=6900 Epoch=33.6] | Loss=0.06968 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.685 | L2-Norm(final)=5.359 | 6006.9 samples/s | 93.9 steps/s
[Step=6950 Epoch=33.9] | Loss=0.06713 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.710 | L2-Norm(final)=5.358 | 1926.3 samples/s | 30.1 steps/s
[Step=7000 Epoch=34.1] | Loss=0.06399 | Reg=0.00315 | acc=0.9688 | L2-Norm=17.735 | L2-Norm(final)=5.357 | 4868.8 samples/s | 76.1 steps/s
[Step=7050 Epoch=34.4] | Loss=0.06072 | Reg=0.00315 | acc=0.9844 | L2-Norm=17.757 | L2-Norm(final)=5.358 | 4842.9 samples/s | 75.7 steps/s
[Step=7100 Epoch=34.6] | Loss=0.05914 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.778 | L2-Norm(final)=5.358 | 5707.7 samples/s | 89.2 steps/s
[Step=7150 Epoch=34.8] | Loss=0.05658 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.800 | L2-Norm(final)=5.358 | 1970.7 samples/s | 30.8 steps/s
[Step=7200 Epoch=35.1] | Loss=0.05429 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.820 | L2-Norm(final)=5.359 | 4972.9 samples/s | 77.7 steps/s
[Step=7250 Epoch=35.3] | Loss=0.05207 | Reg=0.00318 | acc=0.9844 | L2-Norm=17.840 | L2-Norm(final)=5.360 | 4905.2 samples/s | 76.6 steps/s
[Step=7300 Epoch=35.6] | Loss=0.05051 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.857 | L2-Norm(final)=5.361 | 5260.7 samples/s | 82.2 steps/s
[Step=7350 Epoch=35.8] | Loss=0.04864 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.872 | L2-Norm(final)=5.362 | 1998.9 samples/s | 31.2 steps/s
[Step=7400 Epoch=36.1] | Loss=0.04692 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.886 | L2-Norm(final)=5.364 | 4883.5 samples/s | 76.3 steps/s
[Step=7450 Epoch=36.3] | Loss=0.04551 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.899 | L2-Norm(final)=5.365 | 4964.3 samples/s | 77.6 steps/s
[Step=7500 Epoch=36.5] | Loss=0.04424 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.911 | L2-Norm(final)=5.367 | 4973.7 samples/s | 77.7 steps/s
[Step=7550 Epoch=36.8] | Loss=0.04331 | Reg=0.00321 | acc=0.9688 | L2-Norm=17.924 | L2-Norm(final)=5.368 | 2070.8 samples/s | 32.4 steps/s
[Step=7600 Epoch=37.0] | Loss=0.04226 | Reg=0.00322 | acc=0.9531 | L2-Norm=17.936 | L2-Norm(final)=5.369 | 4895.3 samples/s | 76.5 steps/s
[Step=7650 Epoch=37.3] | Loss=0.04132 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.949 | L2-Norm(final)=5.370 | 4879.4 samples/s | 76.2 steps/s
[Step=7700 Epoch=37.5] | Loss=0.04040 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.962 | L2-Norm(final)=5.371 | 4803.4 samples/s | 75.1 steps/s
[Step=7750 Epoch=37.8] | Loss=0.03963 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.975 | L2-Norm(final)=5.372 | 2053.1 samples/s | 32.1 steps/s
[Step=7800 Epoch=38.0] | Loss=0.03874 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.988 | L2-Norm(final)=5.374 | 4825.1 samples/s | 75.4 steps/s
[Step=7850 Epoch=38.2] | Loss=0.03775 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.999 | L2-Norm(final)=5.375 | 4793.8 samples/s | 74.9 steps/s
[Step=7900 Epoch=38.5] | Loss=0.03704 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.009 | L2-Norm(final)=5.376 | 4858.3 samples/s | 75.9 steps/s
[Step=7950 Epoch=38.7] | Loss=0.03644 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.020 | L2-Norm(final)=5.377 | 2063.8 samples/s | 32.2 steps/s
[Step=8000 Epoch=39.0] | Loss=0.03563 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.030 | L2-Norm(final)=5.378 | 4961.2 samples/s | 77.5 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step8000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.37076 | Reg=0.00219 | acc=0.5156 | L2-Norm=14.790 | L2-Norm(final)=2.103 | 4156.5 samples/s | 64.9 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.22009 | Reg=0.00228 | acc=0.9062 | L2-Norm=15.108 | L2-Norm(final)=2.189 | 5204.3 samples/s | 81.3 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.18152 | Reg=0.00239 | acc=0.8906 | L2-Norm=15.452 | L2-Norm(final)=2.308 | 5895.6 samples/s | 92.1 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.16400 | Reg=0.00247 | acc=0.9688 | L2-Norm=15.698 | L2-Norm(final)=2.386 | 5916.9 samples/s | 92.5 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.15414 | Reg=0.00253 | acc=0.9531 | L2-Norm=15.907 | L2-Norm(final)=2.445 | 8538.5 samples/s | 133.4 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.14698 | Reg=0.00259 | acc=0.8438 | L2-Norm=16.081 | L2-Norm(final)=2.495 | 1968.9 samples/s | 30.8 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.14133 | Reg=0.00264 | acc=0.9688 | L2-Norm=16.234 | L2-Norm(final)=2.542 | 5973.9 samples/s | 93.3 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.13759 | Reg=0.00269 | acc=0.9531 | L2-Norm=16.375 | L2-Norm(final)=2.585 | 5935.7 samples/s | 92.7 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.13406 | Reg=0.00273 | acc=0.9375 | L2-Norm=16.507 | L2-Norm(final)=2.626 | 7694.3 samples/s | 120.2 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.13177 | Reg=0.00277 | acc=0.8281 | L2-Norm=16.631 | L2-Norm(final)=2.663 | 2001.2 samples/s | 31.3 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.12865 | Reg=0.00281 | acc=0.9688 | L2-Norm=16.750 | L2-Norm(final)=2.701 | 5812.3 samples/s | 90.8 steps/s
All layers training...
LR=0.00100, len=1
[Step= 501 Epoch= 2.4] | Loss=0.10028 | Reg=0.00322 | acc=0.9375 | L2-Norm=17.937 | L2-Norm(final)=3.085 | 3743.6 samples/s | 58.5 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.10803 | Reg=0.00324 | acc=0.9062 | L2-Norm=17.996 | L2-Norm(final)=3.096 | 4800.1 samples/s | 75.0 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.10328 | Reg=0.00324 | acc=0.8438 | L2-Norm=18.000 | L2-Norm(final)=3.086 | 4876.4 samples/s | 76.2 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.09530 | Reg=0.00324 | acc=0.9062 | L2-Norm=17.994 | L2-Norm(final)=3.080 | 4930.6 samples/s | 77.0 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.08780 | Reg=0.00324 | acc=0.9844 | L2-Norm=17.995 | L2-Norm(final)=3.080 | 6608.4 samples/s | 103.3 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.07712 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.010 | L2-Norm(final)=3.088 | 1884.0 samples/s | 29.4 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.07127 | Reg=0.00325 | acc=0.9375 | L2-Norm=18.027 | L2-Norm(final)=3.100 | 4889.0 samples/s | 76.4 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.06838 | Reg=0.00326 | acc=0.9531 | L2-Norm=18.042 | L2-Norm(final)=3.109 | 4896.4 samples/s | 76.5 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.06566 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.054 | L2-Norm(final)=3.115 | 5940.9 samples/s | 92.8 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.06280 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.068 | L2-Norm(final)=3.121 | 1902.1 samples/s | 29.7 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.06063 | Reg=0.00327 | acc=0.9844 | L2-Norm=18.087 | L2-Norm(final)=3.128 | 4905.6 samples/s | 76.7 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.05869 | Reg=0.00328 | acc=0.9844 | L2-Norm=18.106 | L2-Norm(final)=3.134 | 4928.6 samples/s | 77.0 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.05669 | Reg=0.00328 | acc=0.9688 | L2-Norm=18.123 | L2-Norm(final)=3.139 | 5709.6 samples/s | 89.2 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.05395 | Reg=0.00329 | acc=0.9219 | L2-Norm=18.139 | L2-Norm(final)=3.143 | 1952.4 samples/s | 30.5 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.05175 | Reg=0.00330 | acc=0.9844 | L2-Norm=18.152 | L2-Norm(final)=3.148 | 4930.1 samples/s | 77.0 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.05020 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.164 | L2-Norm(final)=3.153 | 4950.3 samples/s | 77.3 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.04870 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.175 | L2-Norm(final)=3.158 | 5380.4 samples/s | 84.1 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.04688 | Reg=0.00331 | acc=0.9688 | L2-Norm=18.185 | L2-Norm(final)=3.163 | 2000.4 samples/s | 31.3 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.04546 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.196 | L2-Norm(final)=3.168 | 4900.5 samples/s | 76.6 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.04407 | Reg=0.00332 | acc=0.9844 | L2-Norm=18.209 | L2-Norm(final)=3.174 | 4875.9 samples/s | 76.2 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.04328 | Reg=0.00332 | acc=0.9531 | L2-Norm=18.221 | L2-Norm(final)=3.178 | 4877.6 samples/s | 76.2 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.04249 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.231 | L2-Norm(final)=3.182 | 2032.0 samples/s | 31.8 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.04164 | Reg=0.00333 | acc=0.9531 | L2-Norm=18.243 | L2-Norm(final)=3.186 | 4850.1 samples/s | 75.8 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.04072 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.256 | L2-Norm(final)=3.191 | 4906.5 samples/s | 76.7 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.03999 | Reg=0.00334 | acc=0.9844 | L2-Norm=18.267 | L2-Norm(final)=3.194 | 4850.2 samples/s | 75.8 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.03928 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.278 | L2-Norm(final)=3.198 | 2039.5 samples/s | 31.9 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.03848 | Reg=0.00335 | acc=0.9844 | L2-Norm=18.289 | L2-Norm(final)=3.201 | 4975.1 samples/s | 77.7 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.03798 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.299 | L2-Norm(final)=3.204 | 4833.8 samples/s | 75.5 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.03727 | Reg=0.00335 | acc=0.9688 | L2-Norm=18.308 | L2-Norm(final)=3.206 | 4760.5 samples/s | 74.4 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.03655 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.317 | L2-Norm(final)=3.209 | 2062.8 samples/s | 32.2 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.03588 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.326 | L2-Norm(final)=3.212 | 4884.0 samples/s | 76.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step2000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=2001 Epoch=19.0] | Loss=0.09344 | Reg=0.00219 | acc=0.9531 | L2-Norm=14.790 | L2-Norm(final)=2.888 | 3896.6 samples/s | 60.9 steps/s
[Step=2050 Epoch=19.4] | Loss=0.04079 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.470 | L2-Norm(final)=3.000 | 4614.4 samples/s | 72.1 steps/s
[Step=2100 Epoch=19.9] | Loss=0.03107 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.901 | L2-Norm(final)=3.081 | 7473.1 samples/s | 116.8 steps/s
[Step=2150 Epoch=20.4] | Loss=0.02629 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.199 | L2-Norm(final)=3.152 | 1823.8 samples/s | 28.5 steps/s
[Step=2200 Epoch=20.8] | Loss=0.02243 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.420 | L2-Norm(final)=3.213 | 6628.9 samples/s | 103.6 steps/s
[Step=2250 Epoch=21.3] | Loss=0.01987 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.592 | L2-Norm(final)=3.268 | 1890.4 samples/s | 29.5 steps/s
[Step=2300 Epoch=21.8] | Loss=0.01773 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.734 | L2-Norm(final)=3.319 | 6288.4 samples/s | 98.3 steps/s
[Step=2350 Epoch=22.3] | Loss=0.01633 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.852 | L2-Norm(final)=3.365 | 1949.9 samples/s | 30.5 steps/s
[Step=2400 Epoch=22.7] | Loss=0.01511 | Reg=0.00288 | acc=0.9844 | L2-Norm=16.957 | L2-Norm(final)=3.410 | 5618.2 samples/s | 87.8 steps/s
[Step=2450 Epoch=23.2] | Loss=0.01398 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.050 | L2-Norm(final)=3.451 | 2019.3 samples/s | 31.6 steps/s
[Step=2500 Epoch=23.7] | Loss=0.01325 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.130 | L2-Norm(final)=3.491 | 5396.2 samples/s | 84.3 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.7] | Loss=0.00334 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.922 | L2-Norm(final)=3.885 | 4014.3 samples/s | 62.7 steps/s
[Step=2550 Epoch=24.2] | Loss=0.03213 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.032 | L2-Norm(final)=3.876 | 4166.6 samples/s | 65.1 steps/s
[Step=2600 Epoch=24.6] | Loss=0.02130 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.102 | L2-Norm(final)=3.845 | 6261.1 samples/s | 97.8 steps/s
[Step=2650 Epoch=25.1] | Loss=0.01548 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.112 | L2-Norm(final)=3.834 | 1769.4 samples/s | 27.6 steps/s
[Step=2700 Epoch=25.6] | Loss=0.01179 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.094 | L2-Norm(final)=3.831 | 5843.7 samples/s | 91.3 steps/s
[Step=2750 Epoch=26.1] | Loss=0.00945 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.062 | L2-Norm(final)=3.832 | 1853.0 samples/s | 29.0 steps/s
[Step=2800 Epoch=26.5] | Loss=0.00789 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.024 | L2-Norm(final)=3.832 | 5479.1 samples/s | 85.6 steps/s
[Step=2850 Epoch=27.0] | Loss=0.00677 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.982 | L2-Norm(final)=3.833 | 1869.5 samples/s | 29.2 steps/s
[Step=2900 Epoch=27.5] | Loss=0.00593 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.938 | L2-Norm(final)=3.834 | 4980.1 samples/s | 77.8 steps/s
[Step=2950 Epoch=28.0] | Loss=0.00527 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.892 | L2-Norm(final)=3.835 | 1933.0 samples/s | 30.2 steps/s
[Step=3000 Epoch=28.4] | Loss=0.00475 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.846 | L2-Norm(final)=3.836 | 4853.8 samples/s | 75.8 steps/s
[Step=3050 Epoch=28.9] | Loss=0.00432 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.800 | L2-Norm(final)=3.837 | 1987.3 samples/s | 31.1 steps/s
[Step=3100 Epoch=29.4] | Loss=0.00396 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.753 | L2-Norm(final)=3.838 | 4748.9 samples/s | 74.2 steps/s
[Step=3150 Epoch=29.8] | Loss=0.00366 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.707 | L2-Norm(final)=3.840 | 1982.0 samples/s | 31.0 steps/s
[Step=3200 Epoch=30.3] | Loss=0.00340 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.660 | L2-Norm(final)=3.842 | 4795.0 samples/s | 74.9 steps/s
[Step=3250 Epoch=30.8] | Loss=0.00317 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.614 | L2-Norm(final)=3.844 | 2013.8 samples/s | 31.5 steps/s
[Step=3300 Epoch=31.3] | Loss=0.00298 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.567 | L2-Norm(final)=3.846 | 4694.4 samples/s | 73.4 steps/s
[Step=3350 Epoch=31.7] | Loss=0.00280 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.521 | L2-Norm(final)=3.849 | 2033.3 samples/s | 31.8 steps/s
[Step=3400 Epoch=32.2] | Loss=0.00265 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.475 | L2-Norm(final)=3.851 | 4429.0 samples/s | 69.2 steps/s
[Step=3450 Epoch=32.7] | Loss=0.00251 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.429 | L2-Norm(final)=3.854 | 6557.8 samples/s | 102.5 steps/s
[Step=3500 Epoch=33.2] | Loss=0.00238 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.384 | L2-Norm(final)=3.857 | 1799.5 samples/s | 28.1 steps/s
[Step=3550 Epoch=33.6] | Loss=0.00227 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.339 | L2-Norm(final)=3.860 | 6050.6 samples/s | 94.5 steps/s
[Step=3600 Epoch=34.1] | Loss=0.00217 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.294 | L2-Norm(final)=3.864 | 1832.7 samples/s | 28.6 steps/s
[Step=3650 Epoch=34.6] | Loss=0.00208 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.249 | L2-Norm(final)=3.867 | 5558.4 samples/s | 86.8 steps/s
[Step=3700 Epoch=35.1] | Loss=0.00199 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.204 | L2-Norm(final)=3.871 | 1862.3 samples/s | 29.1 steps/s
[Step=3750 Epoch=35.5] | Loss=0.00191 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.160 | L2-Norm(final)=3.874 | 5262.0 samples/s | 82.2 steps/s
[Step=3800 Epoch=36.0] | Loss=0.00184 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.116 | L2-Norm(final)=3.878 | 1933.7 samples/s | 30.2 steps/s
[Step=3850 Epoch=36.5] | Loss=0.00177 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.072 | L2-Norm(final)=3.882 | 4809.9 samples/s | 75.2 steps/s
[Step=3900 Epoch=37.0] | Loss=0.00171 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.028 | L2-Norm(final)=3.886 | 1954.3 samples/s | 30.5 steps/s
[Step=3950 Epoch=37.4] | Loss=0.00165 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.984 | L2-Norm(final)=3.890 | 4715.0 samples/s | 73.7 steps/s
[Step=4000 Epoch=37.9] | Loss=0.00159 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.941 | L2-Norm(final)=3.894 | 1981.5 samples/s | 31.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_0/client_state-step4000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=8001 Epoch=76.1] | Loss=0.04675 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.790 | L2-Norm(final)=5.233 | 3865.6 samples/s | 60.4 steps/s
[Step=8050 Epoch=76.6] | Loss=0.02757 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.211 | L2-Norm(final)=5.261 | 5156.6 samples/s | 80.6 steps/s
[Step=8100 Epoch=77.1] | Loss=0.01792 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.493 | L2-Norm(final)=5.310 | 7396.9 samples/s | 115.6 steps/s
[Step=8150 Epoch=77.5] | Loss=0.01372 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.650 | L2-Norm(final)=5.360 | 1837.9 samples/s | 28.7 steps/s
[Step=8200 Epoch=78.0] | Loss=0.01088 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.736 | L2-Norm(final)=5.405 | 6669.9 samples/s | 104.2 steps/s
[Step=8250 Epoch=78.5] | Loss=0.00910 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.783 | L2-Norm(final)=5.446 | 1908.8 samples/s | 29.8 steps/s
[Step=8300 Epoch=79.0] | Loss=0.00781 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.814 | L2-Norm(final)=5.486 | 6314.1 samples/s | 98.7 steps/s
[Step=8350 Epoch=79.4] | Loss=0.00685 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.833 | L2-Norm(final)=5.524 | 1945.9 samples/s | 30.4 steps/s
[Step=8400 Epoch=79.9] | Loss=0.00611 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.842 | L2-Norm(final)=5.558 | 5760.8 samples/s | 90.0 steps/s
[Step=8450 Epoch=80.4] | Loss=0.00552 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.844 | L2-Norm(final)=5.591 | 2023.1 samples/s | 31.6 steps/s
[Step=8500 Epoch=80.9] | Loss=0.00502 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.841 | L2-Norm(final)=5.623 | 5391.7 samples/s | 84.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=80.9] | Loss=0.00086 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.784 | L2-Norm(final)=5.924 | 4040.8 samples/s | 63.1 steps/s
[Step=8550 Epoch=81.3] | Loss=0.00035 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.751 | L2-Norm(final)=5.939 | 4120.4 samples/s | 64.4 steps/s
[Step=8600 Epoch=81.8] | Loss=0.02266 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.731 | L2-Norm(final)=5.937 | 6262.2 samples/s | 97.8 steps/s
[Step=8650 Epoch=82.3] | Loss=0.02242 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.937 | L2-Norm(final)=5.864 | 1796.4 samples/s | 28.1 steps/s
[Step=8700 Epoch=82.8] | Loss=0.01831 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.058 | L2-Norm(final)=5.827 | 5913.9 samples/s | 92.4 steps/s
[Step=8750 Epoch=83.2] | Loss=0.01502 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.125 | L2-Norm(final)=5.811 | 1849.6 samples/s | 28.9 steps/s
[Step=8800 Epoch=83.7] | Loss=0.01256 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.162 | L2-Norm(final)=5.803 | 5330.5 samples/s | 83.3 steps/s
[Step=8850 Epoch=84.2] | Loss=0.01079 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.180 | L2-Norm(final)=5.799 | 1877.5 samples/s | 29.3 steps/s
[Step=8900 Epoch=84.7] | Loss=0.00946 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.187 | L2-Norm(final)=5.796 | 5013.1 samples/s | 78.3 steps/s
[Step=8950 Epoch=85.1] | Loss=0.00842 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.187 | L2-Norm(final)=5.795 | 1927.8 samples/s | 30.1 steps/s
[Step=9000 Epoch=85.6] | Loss=0.00758 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.180 | L2-Norm(final)=5.795 | 4856.6 samples/s | 75.9 steps/s
[Step=9050 Epoch=86.1] | Loss=0.00690 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.170 | L2-Norm(final)=5.795 | 1958.1 samples/s | 30.6 steps/s
[Step=9100 Epoch=86.6] | Loss=0.00633 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.157 | L2-Norm(final)=5.795 | 4741.4 samples/s | 74.1 steps/s
[Step=9150 Epoch=87.0] | Loss=0.00585 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.141 | L2-Norm(final)=5.795 | 1985.0 samples/s | 31.0 steps/s
[Step=9200 Epoch=87.5] | Loss=0.00543 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.124 | L2-Norm(final)=5.796 | 4748.6 samples/s | 74.2 steps/s
[Step=9250 Epoch=88.0] | Loss=0.00507 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.105 | L2-Norm(final)=5.797 | 1991.2 samples/s | 31.1 steps/s
[Step=9300 Epoch=88.5] | Loss=0.00476 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.085 | L2-Norm(final)=5.798 | 4714.2 samples/s | 73.7 steps/s
[Step=9350 Epoch=88.9] | Loss=0.00448 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.064 | L2-Norm(final)=5.799 | 2035.5 samples/s | 31.8 steps/s
[Step=9400 Epoch=89.4] | Loss=0.00423 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.042 | L2-Norm(final)=5.800 | 4529.6 samples/s | 70.8 steps/s
[Step=9450 Epoch=89.9] | Loss=0.00401 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.020 | L2-Norm(final)=5.801 | 6595.3 samples/s | 103.1 steps/s
[Step=9500 Epoch=90.4] | Loss=0.00381 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.997 | L2-Norm(final)=5.802 | 1778.3 samples/s | 27.8 steps/s
[Step=9550 Epoch=90.8] | Loss=0.00363 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.973 | L2-Norm(final)=5.803 | 6030.1 samples/s | 94.2 steps/s
[Step=9600 Epoch=91.3] | Loss=0.00347 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.949 | L2-Norm(final)=5.804 | 1824.9 samples/s | 28.5 steps/s
[Step=9650 Epoch=91.8] | Loss=0.00332 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.924 | L2-Norm(final)=5.805 | 5568.8 samples/s | 87.0 steps/s
[Step=9700 Epoch=92.3] | Loss=0.00318 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.900 | L2-Norm(final)=5.806 | 1865.5 samples/s | 29.1 steps/s
[Step=9750 Epoch=92.7] | Loss=0.00306 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.874 | L2-Norm(final)=5.807 | 5232.9 samples/s | 81.8 steps/s
[Step=9800 Epoch=93.2] | Loss=0.00294 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.849 | L2-Norm(final)=5.809 | 1909.8 samples/s | 29.8 steps/s
[Step=9850 Epoch=93.7] | Loss=0.00283 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.823 | L2-Norm(final)=5.810 | 4945.5 samples/s | 77.3 steps/s
[Step=9900 Epoch=94.2] | Loss=0.00273 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.797 | L2-Norm(final)=5.811 | 1935.8 samples/s | 30.2 steps/s
[Step=9950 Epoch=94.6] | Loss=0.00264 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.771 | L2-Norm(final)=5.812 | 4789.8 samples/s | 74.8 steps/s
[Step=10000 Epoch=95.1] | Loss=0.00255 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.744 | L2-Norm(final)=5.813 | 2005.8 samples/s | 31.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step10000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.15645 | acc=0.9356 | tpr=0.9566 | fpr=0.1100 | 4426.8 samples/s | 17.3 steps/s
Avg test loss: 0.15898, Avg test acc: 0.93413, Avg tpr: 0.95704, Avg fpr: 0.11627, total FA: 907

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14531 | acc=0.9354 | tpr=0.9612 | fpr=0.1207 | 4390.8 samples/s | 17.2 steps/s
Avg test loss: 0.14730, Avg test acc: 0.93481, Avg tpr: 0.96130, Avg fpr: 0.12345, total FA: 963

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.14359 | acc=0.9292 | tpr=0.9319 | fpr=0.0766 | 4362.2 samples/s | 17.0 steps/s
Avg test loss: 0.14751, Avg test acc: 0.92780, Avg tpr: 0.92936, Avg fpr: 0.07563, total FA: 590

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.12355 | acc=0.9319 | tpr=0.9516 | fpr=0.1110 | 4369.4 samples/s | 17.1 steps/s
Avg test loss: 0.12837, Avg test acc: 0.93140, Avg tpr: 0.95174, Avg fpr: 0.11332, total FA: 884

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.13912 | acc=0.9402 | tpr=0.9604 | fpr=0.1038 | 4400.3 samples/s | 17.2 steps/s
Avg test loss: 0.14619, Avg test acc: 0.93665, Avg tpr: 0.95681, Avg fpr: 0.10768, total FA: 840

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.23145 | acc=0.3180 | tpr=0.0079 | fpr=0.0087 | 4372.7 samples/s | 17.1 steps/s
Avg test loss: 4.24032, Avg test acc: 0.31481, Avg tpr: 0.00746, Avg fpr: 0.00923, total FA: 72

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=3.71728 | acc=0.3154 | tpr=0.0037 | fpr=0.0077 | 4359.8 samples/s | 17.0 steps/s
Avg test loss: 3.72727, Avg test acc: 0.31232, Avg tpr: 0.00356, Avg fpr: 0.00859, total FA: 67

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.00413 | acc=0.3162 | tpr=0.0042 | fpr=0.0062 | 4365.8 samples/s | 17.1 steps/s
Avg test loss: 4.01594, Avg test acc: 0.31325, Avg tpr: 0.00420, Avg fpr: 0.00705, total FA: 55

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=3.95108 | acc=0.3153 | tpr=0.0015 | fpr=0.0032 | 4357.3 samples/s | 17.0 steps/s
Avg test loss: 3.96789, Avg test acc: 0.31289, Avg tpr: 0.00169, Avg fpr: 0.00269, total FA: 21

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=3.83227 | acc=0.3166 | tpr=0.0116 | fpr=0.0211 | 4344.3 samples/s | 17.0 steps/s
Avg test loss: 3.82612, Avg test acc: 0.31509, Avg tpr: 0.01241, Avg fpr: 0.01923, total FA: 150

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.97631 | acc=0.1177 | tpr=0.7743 | fpr=0.8941 | 4384.1 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.96445 | acc=0.1205 | tpr=0.7420 | fpr=0.8911 | 8574.4 samples/s | 33.5 steps/s
[Step= 150] | Loss=4.95292 | acc=0.1209 | tpr=0.7536 | fpr=0.8907 | 8923.1 samples/s | 34.9 steps/s
[Step= 200] | Loss=4.94641 | acc=0.1212 | tpr=0.7530 | fpr=0.8903 | 8066.9 samples/s | 31.5 steps/s
[Step= 250] | Loss=4.94866 | acc=0.1207 | tpr=0.7371 | fpr=0.8906 | 8743.9 samples/s | 34.2 steps/s
[Step= 300] | Loss=4.95252 | acc=0.1204 | tpr=0.7367 | fpr=0.8908 | 8478.6 samples/s | 33.1 steps/s
[Step= 350] | Loss=4.94750 | acc=0.1206 | tpr=0.7332 | fpr=0.8905 | 8690.2 samples/s | 33.9 steps/s
[Step= 400] | Loss=4.94689 | acc=0.1210 | tpr=0.7380 | fpr=0.8902 | 8874.9 samples/s | 34.7 steps/s
[Step= 450] | Loss=4.94500 | acc=0.1212 | tpr=0.7390 | fpr=0.8900 | 8384.5 samples/s | 32.8 steps/s
[Step= 500] | Loss=4.94819 | acc=0.1214 | tpr=0.7392 | fpr=0.8898 | 8331.2 samples/s | 32.5 steps/s
[Step= 550] | Loss=4.95079 | acc=0.1211 | tpr=0.7398 | fpr=0.8902 | 15945.6 samples/s | 62.3 steps/s
Avg test loss: 4.95291, Avg test acc: 0.12096, Avg tpr: 0.73891, Avg fpr: 0.89028, total FA: 123613

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.47559 | acc=0.0979 | tpr=0.7035 | fpr=0.9130 | 4363.6 samples/s | 17.0 steps/s
[Step= 100] | Loss=4.46220 | acc=0.0995 | tpr=0.6802 | fpr=0.9113 | 8639.3 samples/s | 33.7 steps/s
[Step= 150] | Loss=4.46728 | acc=0.0993 | tpr=0.6844 | fpr=0.9115 | 8548.0 samples/s | 33.4 steps/s
[Step= 200] | Loss=4.45838 | acc=0.0991 | tpr=0.6754 | fpr=0.9114 | 8791.7 samples/s | 34.3 steps/s
[Step= 250] | Loss=4.45515 | acc=0.0995 | tpr=0.6716 | fpr=0.9109 | 8283.9 samples/s | 32.4 steps/s
[Step= 300] | Loss=4.45302 | acc=0.0995 | tpr=0.6771 | fpr=0.9111 | 8732.2 samples/s | 34.1 steps/s
[Step= 350] | Loss=4.44490 | acc=0.1000 | tpr=0.6706 | fpr=0.9104 | 8312.1 samples/s | 32.5 steps/s
[Step= 400] | Loss=4.44760 | acc=0.0997 | tpr=0.6707 | fpr=0.9106 | 8746.1 samples/s | 34.2 steps/s
[Step= 450] | Loss=4.45526 | acc=0.0993 | tpr=0.6704 | fpr=0.9110 | 8407.2 samples/s | 32.8 steps/s
[Step= 500] | Loss=4.45670 | acc=0.0990 | tpr=0.6674 | fpr=0.9113 | 8842.5 samples/s | 34.5 steps/s
[Step= 550] | Loss=4.45998 | acc=0.0987 | tpr=0.6641 | fpr=0.9116 | 15119.6 samples/s | 59.1 steps/s
Avg test loss: 4.46119, Avg test acc: 0.09863, Avg tpr: 0.66323, Avg fpr: 0.91163, total FA: 126578

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=3.45124 | acc=0.1839 | tpr=0.5531 | fpr=0.8227 | 4349.2 samples/s | 17.0 steps/s
[Step= 100] | Loss=3.42844 | acc=0.1854 | tpr=0.5373 | fpr=0.8212 | 8591.4 samples/s | 33.6 steps/s
[Step= 150] | Loss=3.42275 | acc=0.1852 | tpr=0.5533 | fpr=0.8216 | 8974.7 samples/s | 35.1 steps/s
[Step= 200] | Loss=3.41981 | acc=0.1829 | tpr=0.5268 | fpr=0.8233 | 8486.3 samples/s | 33.1 steps/s
[Step= 250] | Loss=3.41531 | acc=0.1822 | tpr=0.5153 | fpr=0.8239 | 8669.2 samples/s | 33.9 steps/s
[Step= 300] | Loss=3.42067 | acc=0.1815 | tpr=0.5215 | fpr=0.8247 | 8541.7 samples/s | 33.4 steps/s
[Step= 350] | Loss=3.41753 | acc=0.1816 | tpr=0.5235 | fpr=0.8246 | 8719.7 samples/s | 34.1 steps/s
[Step= 400] | Loss=3.41570 | acc=0.1815 | tpr=0.5191 | fpr=0.8247 | 8544.4 samples/s | 33.4 steps/s
[Step= 450] | Loss=3.41768 | acc=0.1816 | tpr=0.5204 | fpr=0.8246 | 8505.8 samples/s | 33.2 steps/s
[Step= 500] | Loss=3.41904 | acc=0.1819 | tpr=0.5167 | fpr=0.8242 | 8410.0 samples/s | 32.9 steps/s
[Step= 550] | Loss=3.42167 | acc=0.1816 | tpr=0.5197 | fpr=0.8246 | 15644.7 samples/s | 61.1 steps/s
Avg test loss: 3.42293, Avg test acc: 0.18149, Avg tpr: 0.52021, Avg fpr: 0.82467, total FA: 114504

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=3.28247 | acc=0.1533 | tpr=0.7522 | fpr=0.8575 | 4429.1 samples/s | 17.3 steps/s
[Step= 100] | Loss=3.26485 | acc=0.1521 | tpr=0.7228 | fpr=0.8586 | 8390.7 samples/s | 32.8 steps/s
[Step= 150] | Loss=3.26398 | acc=0.1532 | tpr=0.7219 | fpr=0.8573 | 8715.9 samples/s | 34.0 steps/s
[Step= 200] | Loss=3.26645 | acc=0.1526 | tpr=0.7137 | fpr=0.8576 | 8325.0 samples/s | 32.5 steps/s
[Step= 250] | Loss=3.26385 | acc=0.1527 | tpr=0.7135 | fpr=0.8575 | 8585.6 samples/s | 33.5 steps/s
[Step= 300] | Loss=3.26523 | acc=0.1521 | tpr=0.7156 | fpr=0.8582 | 8598.2 samples/s | 33.6 steps/s
[Step= 350] | Loss=3.26071 | acc=0.1527 | tpr=0.7151 | fpr=0.8575 | 8551.2 samples/s | 33.4 steps/s
[Step= 400] | Loss=3.26039 | acc=0.1523 | tpr=0.7123 | fpr=0.8579 | 8609.3 samples/s | 33.6 steps/s
[Step= 450] | Loss=3.26115 | acc=0.1525 | tpr=0.7167 | fpr=0.8577 | 8647.2 samples/s | 33.8 steps/s
[Step= 500] | Loss=3.26273 | acc=0.1525 | tpr=0.7181 | fpr=0.8577 | 8479.2 samples/s | 33.1 steps/s
[Step= 550] | Loss=3.26124 | acc=0.1525 | tpr=0.7135 | fpr=0.8577 | 15741.9 samples/s | 61.5 steps/s
Avg test loss: 3.26254, Avg test acc: 0.15234, Avg tpr: 0.71355, Avg fpr: 0.85787, total FA: 119113

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.06837 | acc=0.1248 | tpr=0.8142 | fpr=0.8876 | 4346.6 samples/s | 17.0 steps/s
[Step= 100] | Loss=5.03964 | acc=0.1234 | tpr=0.7569 | fpr=0.8884 | 8541.9 samples/s | 33.4 steps/s
[Step= 150] | Loss=5.05808 | acc=0.1226 | tpr=0.7522 | fpr=0.8890 | 9243.3 samples/s | 36.1 steps/s
[Step= 200] | Loss=5.04998 | acc=0.1221 | tpr=0.7344 | fpr=0.8890 | 8266.8 samples/s | 32.3 steps/s
[Step= 250] | Loss=5.05487 | acc=0.1219 | tpr=0.7328 | fpr=0.8893 | 8818.0 samples/s | 34.4 steps/s
[Step= 300] | Loss=5.05600 | acc=0.1215 | tpr=0.7367 | fpr=0.8897 | 8125.4 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.05248 | acc=0.1211 | tpr=0.7370 | fpr=0.8901 | 8445.8 samples/s | 33.0 steps/s
[Step= 400] | Loss=5.05473 | acc=0.1211 | tpr=0.7374 | fpr=0.8901 | 8735.7 samples/s | 34.1 steps/s
[Step= 450] | Loss=5.05283 | acc=0.1213 | tpr=0.7439 | fpr=0.8900 | 8403.0 samples/s | 32.8 steps/s
[Step= 500] | Loss=5.05468 | acc=0.1213 | tpr=0.7419 | fpr=0.8899 | 8694.9 samples/s | 34.0 steps/s
[Step= 550] | Loss=5.05584 | acc=0.1210 | tpr=0.7449 | fpr=0.8903 | 15448.8 samples/s | 60.3 steps/s
Avg test loss: 5.05646, Avg test acc: 0.12091, Avg tpr: 0.74485, Avg fpr: 0.89043, total FA: 123635

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10025 | acc=0.9799 | tpr=0.8717 | fpr=0.0181 | 4333.4 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.10363 | acc=0.9801 | tpr=0.9041 | fpr=0.0185 | 8763.5 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.10715 | acc=0.9793 | tpr=0.9049 | fpr=0.0193 | 8443.5 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.10929 | acc=0.9794 | tpr=0.9115 | fpr=0.0193 | 8880.9 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.10773 | acc=0.9793 | tpr=0.9100 | fpr=0.0195 | 8422.1 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.10909 | acc=0.9792 | tpr=0.9098 | fpr=0.0196 | 8543.9 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.10910 | acc=0.9790 | tpr=0.9105 | fpr=0.0197 | 8689.6 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.11047 | acc=0.9788 | tpr=0.9026 | fpr=0.0198 | 8805.1 samples/s | 34.4 steps/s
[Step= 450] | Loss=0.11261 | acc=0.9785 | tpr=0.9031 | fpr=0.0201 | 8576.2 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.11181 | acc=0.9787 | tpr=0.9031 | fpr=0.0200 | 8697.1 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.11072 | acc=0.9788 | tpr=0.9053 | fpr=0.0198 | 15632.0 samples/s | 61.1 steps/s
Avg test loss: 0.11057, Avg test acc: 0.97885, Avg tpr: 0.90491, Avg fpr: 0.01981, total FA: 2750

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10646 | acc=0.9807 | tpr=0.8230 | fpr=0.0165 | 4430.2 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.11254 | acc=0.9801 | tpr=0.8593 | fpr=0.0176 | 8519.5 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.11519 | acc=0.9792 | tpr=0.8646 | fpr=0.0186 | 8499.3 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.11893 | acc=0.9792 | tpr=0.8689 | fpr=0.0188 | 8305.0 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.11704 | acc=0.9794 | tpr=0.8707 | fpr=0.0186 | 8502.4 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.11922 | acc=0.9789 | tpr=0.8698 | fpr=0.0191 | 8809.3 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.11913 | acc=0.9789 | tpr=0.8779 | fpr=0.0193 | 8490.3 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.12087 | acc=0.9786 | tpr=0.8682 | fpr=0.0194 | 8478.4 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.12349 | acc=0.9784 | tpr=0.8695 | fpr=0.0196 | 8810.8 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.12305 | acc=0.9785 | tpr=0.8705 | fpr=0.0196 | 8468.8 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.12216 | acc=0.9786 | tpr=0.8703 | fpr=0.0194 | 15283.7 samples/s | 59.7 steps/s
Avg test loss: 0.12191, Avg test acc: 0.97860, Avg tpr: 0.87005, Avg fpr: 0.01942, total FA: 2697

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.09985 | acc=0.9800 | tpr=0.8982 | fpr=0.0185 | 4338.3 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.10088 | acc=0.9791 | tpr=0.9019 | fpr=0.0195 | 8853.8 samples/s | 34.6 steps/s
[Step= 150] | Loss=0.10410 | acc=0.9782 | tpr=0.9006 | fpr=0.0203 | 8410.1 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.10458 | acc=0.9783 | tpr=0.9005 | fpr=0.0203 | 8579.3 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.10354 | acc=0.9784 | tpr=0.8969 | fpr=0.0201 | 8502.8 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.10527 | acc=0.9779 | tpr=0.8924 | fpr=0.0205 | 8784.8 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.10614 | acc=0.9777 | tpr=0.8917 | fpr=0.0207 | 8734.1 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.10723 | acc=0.9775 | tpr=0.8884 | fpr=0.0209 | 8235.7 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.10859 | acc=0.9773 | tpr=0.8875 | fpr=0.0211 | 8544.6 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.10770 | acc=0.9773 | tpr=0.8912 | fpr=0.0211 | 8428.2 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.10650 | acc=0.9776 | tpr=0.8914 | fpr=0.0209 | 15829.5 samples/s | 61.8 steps/s
Avg test loss: 0.10629, Avg test acc: 0.97758, Avg tpr: 0.89184, Avg fpr: 0.02086, total FA: 2896

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11254 | acc=0.9815 | tpr=0.8717 | fpr=0.0165 | 4325.7 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.11803 | acc=0.9805 | tpr=0.8678 | fpr=0.0173 | 9052.1 samples/s | 35.4 steps/s
[Step= 150] | Loss=0.12264 | acc=0.9793 | tpr=0.8660 | fpr=0.0186 | 8260.9 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.12464 | acc=0.9794 | tpr=0.8754 | fpr=0.0187 | 8764.6 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.12196 | acc=0.9797 | tpr=0.8777 | fpr=0.0184 | 8721.7 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.12528 | acc=0.9792 | tpr=0.8749 | fpr=0.0189 | 8530.2 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.12608 | acc=0.9790 | tpr=0.8817 | fpr=0.0192 | 8513.4 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.12719 | acc=0.9788 | tpr=0.8769 | fpr=0.0193 | 8788.5 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.12986 | acc=0.9784 | tpr=0.8744 | fpr=0.0197 | 8364.5 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.12890 | acc=0.9785 | tpr=0.8758 | fpr=0.0197 | 8590.7 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.12792 | acc=0.9787 | tpr=0.8758 | fpr=0.0195 | 16332.7 samples/s | 63.8 steps/s
Avg test loss: 0.12761, Avg test acc: 0.97870, Avg tpr: 0.87599, Avg fpr: 0.01943, total FA: 2698

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.06004 | acc=0.9784 | tpr=0.8009 | fpr=0.0185 | 4351.7 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.05947 | acc=0.9780 | tpr=0.8124 | fpr=0.0189 | 8454.6 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.06023 | acc=0.9770 | tpr=0.8141 | fpr=0.0200 | 8556.6 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.06128 | acc=0.9771 | tpr=0.8197 | fpr=0.0200 | 8753.8 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.06088 | acc=0.9772 | tpr=0.8131 | fpr=0.0198 | 8574.8 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.06211 | acc=0.9769 | tpr=0.8080 | fpr=0.0200 | 8490.9 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.06231 | acc=0.9768 | tpr=0.8109 | fpr=0.0202 | 8911.2 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.06297 | acc=0.9765 | tpr=0.8025 | fpr=0.0204 | 8487.2 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.06410 | acc=0.9763 | tpr=0.8033 | fpr=0.0206 | 8543.5 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.06354 | acc=0.9764 | tpr=0.8048 | fpr=0.0205 | 8532.0 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.06294 | acc=0.9766 | tpr=0.8062 | fpr=0.0203 | 14994.8 samples/s | 58.6 steps/s
Avg test loss: 0.06281, Avg test acc: 0.97657, Avg tpr: 0.80547, Avg fpr: 0.02032, total FA: 2822

server round 7/50

clients selected: [2 3 4 8 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=8001 Epoch=39.0] | Loss=0.10276 | Reg=0.00218 | acc=0.9062 | L2-Norm=14.756 | L2-Norm(final)=5.421 | 3887.4 samples/s | 60.7 steps/s
[Step=8050 Epoch=39.2] | Loss=0.08801 | Reg=0.00222 | acc=0.9531 | L2-Norm=14.915 | L2-Norm(final)=5.500 | 5280.0 samples/s | 82.5 steps/s
[Step=8100 Epoch=39.5] | Loss=0.08988 | Reg=0.00227 | acc=0.9062 | L2-Norm=15.080 | L2-Norm(final)=5.563 | 5430.8 samples/s | 84.9 steps/s
[Step=8150 Epoch=39.7] | Loss=0.08999 | Reg=0.00231 | acc=0.8594 | L2-Norm=15.204 | L2-Norm(final)=5.602 | 5563.4 samples/s | 86.9 steps/s
[Step=8200 Epoch=40.0] | Loss=0.09014 | Reg=0.00235 | acc=0.9062 | L2-Norm=15.319 | L2-Norm(final)=5.633 | 7738.2 samples/s | 120.9 steps/s
[Step=8250 Epoch=40.2] | Loss=0.08788 | Reg=0.00238 | acc=0.9688 | L2-Norm=15.429 | L2-Norm(final)=5.667 | 1924.4 samples/s | 30.1 steps/s
[Step=8300 Epoch=40.4] | Loss=0.08580 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.533 | L2-Norm(final)=5.702 | 5461.7 samples/s | 85.3 steps/s
[Step=8350 Epoch=40.7] | Loss=0.08514 | Reg=0.00245 | acc=0.9688 | L2-Norm=15.632 | L2-Norm(final)=5.737 | 5627.7 samples/s | 87.9 steps/s
[Step=8400 Epoch=40.9] | Loss=0.08343 | Reg=0.00248 | acc=0.9688 | L2-Norm=15.734 | L2-Norm(final)=5.774 | 7002.9 samples/s | 109.4 steps/s
[Step=8450 Epoch=41.2] | Loss=0.08178 | Reg=0.00251 | acc=0.9375 | L2-Norm=15.837 | L2-Norm(final)=5.812 | 1960.5 samples/s | 30.6 steps/s
[Step=8500 Epoch=41.4] | Loss=0.08009 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.939 | L2-Norm(final)=5.852 | 5426.2 samples/s | 84.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=41.4] | Loss=0.02882 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.950 | L2-Norm(final)=6.265 | 4007.7 samples/s | 62.6 steps/s
[Step=8550 Epoch=41.7] | Loss=0.09159 | Reg=0.00290 | acc=0.8906 | L2-Norm=17.037 | L2-Norm(final)=6.248 | 4595.5 samples/s | 71.8 steps/s
[Step=8600 Epoch=41.9] | Loss=0.09135 | Reg=0.00293 | acc=0.9219 | L2-Norm=17.119 | L2-Norm(final)=6.200 | 4988.9 samples/s | 78.0 steps/s
[Step=8650 Epoch=42.1] | Loss=0.08621 | Reg=0.00295 | acc=0.9531 | L2-Norm=17.188 | L2-Norm(final)=6.178 | 4850.2 samples/s | 75.8 steps/s
[Step=8700 Epoch=42.4] | Loss=0.08335 | Reg=0.00297 | acc=0.9375 | L2-Norm=17.240 | L2-Norm(final)=6.162 | 6593.6 samples/s | 103.0 steps/s
[Step=8750 Epoch=42.6] | Loss=0.07400 | Reg=0.00299 | acc=0.9844 | L2-Norm=17.285 | L2-Norm(final)=6.155 | 1863.6 samples/s | 29.1 steps/s
[Step=8800 Epoch=42.9] | Loss=0.06864 | Reg=0.00300 | acc=0.9375 | L2-Norm=17.321 | L2-Norm(final)=6.151 | 4870.0 samples/s | 76.1 steps/s
[Step=8850 Epoch=43.1] | Loss=0.06608 | Reg=0.00301 | acc=0.9688 | L2-Norm=17.355 | L2-Norm(final)=6.147 | 4803.2 samples/s | 75.1 steps/s
[Step=8900 Epoch=43.4] | Loss=0.06306 | Reg=0.00302 | acc=0.9844 | L2-Norm=17.386 | L2-Norm(final)=6.144 | 6031.3 samples/s | 94.2 steps/s
[Step=8950 Epoch=43.6] | Loss=0.05957 | Reg=0.00303 | acc=0.9219 | L2-Norm=17.415 | L2-Norm(final)=6.143 | 1894.4 samples/s | 29.6 steps/s
[Step=9000 Epoch=43.9] | Loss=0.05611 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.441 | L2-Norm(final)=6.143 | 4823.5 samples/s | 75.4 steps/s
[Step=9050 Epoch=44.1] | Loss=0.05370 | Reg=0.00305 | acc=0.9844 | L2-Norm=17.464 | L2-Norm(final)=6.144 | 4950.4 samples/s | 77.3 steps/s
[Step=9100 Epoch=44.3] | Loss=0.05138 | Reg=0.00306 | acc=0.9844 | L2-Norm=17.485 | L2-Norm(final)=6.143 | 5717.5 samples/s | 89.3 steps/s
[Step=9150 Epoch=44.6] | Loss=0.04957 | Reg=0.00306 | acc=0.9844 | L2-Norm=17.504 | L2-Norm(final)=6.143 | 1930.5 samples/s | 30.2 steps/s
[Step=9200 Epoch=44.8] | Loss=0.04759 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.524 | L2-Norm(final)=6.144 | 4900.2 samples/s | 76.6 steps/s
[Step=9250 Epoch=45.1] | Loss=0.04561 | Reg=0.00308 | acc=0.9844 | L2-Norm=17.541 | L2-Norm(final)=6.144 | 4854.4 samples/s | 75.9 steps/s
[Step=9300 Epoch=45.3] | Loss=0.04430 | Reg=0.00308 | acc=0.9375 | L2-Norm=17.558 | L2-Norm(final)=6.145 | 5314.0 samples/s | 83.0 steps/s
[Step=9350 Epoch=45.6] | Loss=0.04306 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.575 | L2-Norm(final)=6.146 | 1966.3 samples/s | 30.7 steps/s
[Step=9400 Epoch=45.8] | Loss=0.04156 | Reg=0.00310 | acc=0.9844 | L2-Norm=17.591 | L2-Norm(final)=6.146 | 4953.7 samples/s | 77.4 steps/s
[Step=9450 Epoch=46.0] | Loss=0.04043 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.607 | L2-Norm(final)=6.147 | 4811.8 samples/s | 75.2 steps/s
[Step=9500 Epoch=46.3] | Loss=0.03937 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.621 | L2-Norm(final)=6.149 | 5027.7 samples/s | 78.6 steps/s
[Step=9550 Epoch=46.5] | Loss=0.03852 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.634 | L2-Norm(final)=6.149 | 1989.9 samples/s | 31.1 steps/s
[Step=9600 Epoch=46.8] | Loss=0.03781 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.647 | L2-Norm(final)=6.149 | 4992.6 samples/s | 78.0 steps/s
[Step=9650 Epoch=47.0] | Loss=0.03687 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.660 | L2-Norm(final)=6.150 | 4927.7 samples/s | 77.0 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03615 | Reg=0.00312 | acc=0.9688 | L2-Norm=17.672 | L2-Norm(final)=6.150 | 4917.3 samples/s | 76.8 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03533 | Reg=0.00313 | acc=0.9688 | L2-Norm=17.684 | L2-Norm(final)=6.150 | 2032.4 samples/s | 31.8 steps/s
[Step=9800 Epoch=47.8] | Loss=0.03452 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.697 | L2-Norm(final)=6.151 | 4968.1 samples/s | 77.6 steps/s
[Step=9850 Epoch=48.0] | Loss=0.03372 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.710 | L2-Norm(final)=6.152 | 4848.2 samples/s | 75.8 steps/s
[Step=9900 Epoch=48.2] | Loss=0.03309 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.722 | L2-Norm(final)=6.152 | 4858.2 samples/s | 75.9 steps/s
[Step=9950 Epoch=48.5] | Loss=0.03241 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.733 | L2-Norm(final)=6.153 | 2064.4 samples/s | 32.3 steps/s
[Step=10000 Epoch=48.7] | Loss=0.03176 | Reg=0.00315 | acc=0.9531 | L2-Norm=17.743 | L2-Norm(final)=6.154 | 4905.5 samples/s | 76.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step10000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=2001 Epoch= 9.8] | Loss=0.28108 | Reg=0.00218 | acc=0.7188 | L2-Norm=14.756 | L2-Norm(final)=3.290 | 3997.7 samples/s | 62.5 steps/s
[Step=2050 Epoch=10.0] | Loss=0.12855 | Reg=0.00239 | acc=0.8906 | L2-Norm=15.438 | L2-Norm(final)=3.432 | 4901.7 samples/s | 76.6 steps/s
[Step=2100 Epoch=10.2] | Loss=0.11505 | Reg=0.00253 | acc=0.8906 | L2-Norm=15.899 | L2-Norm(final)=3.536 | 5455.4 samples/s | 85.2 steps/s
[Step=2150 Epoch=10.5] | Loss=0.11069 | Reg=0.00263 | acc=0.8906 | L2-Norm=16.202 | L2-Norm(final)=3.600 | 5447.0 samples/s | 85.1 steps/s
[Step=2200 Epoch=10.7] | Loss=0.10650 | Reg=0.00271 | acc=0.9531 | L2-Norm=16.452 | L2-Norm(final)=3.654 | 7300.9 samples/s | 114.1 steps/s
[Step=2250 Epoch=11.0] | Loss=0.10209 | Reg=0.00278 | acc=0.8750 | L2-Norm=16.663 | L2-Norm(final)=3.703 | 1909.7 samples/s | 29.8 steps/s
[Step=2300 Epoch=11.2] | Loss=0.09988 | Reg=0.00285 | acc=0.9062 | L2-Norm=16.852 | L2-Norm(final)=3.755 | 5506.8 samples/s | 86.0 steps/s
[Step=2350 Epoch=11.5] | Loss=0.09838 | Reg=0.00290 | acc=0.9375 | L2-Norm=17.018 | L2-Norm(final)=3.803 | 5382.0 samples/s | 84.1 steps/s
[Step=2400 Epoch=11.7] | Loss=0.09595 | Reg=0.00296 | acc=0.9688 | L2-Norm=17.171 | L2-Norm(final)=3.848 | 7119.3 samples/s | 111.2 steps/s
[Step=2450 Epoch=11.9] | Loss=0.09397 | Reg=0.00301 | acc=0.9844 | L2-Norm=17.316 | L2-Norm(final)=3.893 | 1995.6 samples/s | 31.2 steps/s
[Step=2500 Epoch=12.2] | Loss=0.09240 | Reg=0.00306 | acc=0.9375 | L2-Norm=17.452 | L2-Norm(final)=3.938 | 5501.5 samples/s | 86.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=12.2] | Loss=0.05460 | Reg=0.00352 | acc=0.9688 | L2-Norm=18.758 | L2-Norm(final)=4.384 | 4186.1 samples/s | 65.4 steps/s
[Step=2550 Epoch=12.4] | Loss=0.09518 | Reg=0.00354 | acc=0.9531 | L2-Norm=18.807 | L2-Norm(final)=4.380 | 4210.1 samples/s | 65.8 steps/s
[Step=2600 Epoch=12.7] | Loss=0.09653 | Reg=0.00354 | acc=0.9219 | L2-Norm=18.826 | L2-Norm(final)=4.341 | 4855.1 samples/s | 75.9 steps/s
[Step=2650 Epoch=12.9] | Loss=0.09108 | Reg=0.00355 | acc=0.9375 | L2-Norm=18.845 | L2-Norm(final)=4.318 | 4796.5 samples/s | 74.9 steps/s
[Step=2700 Epoch=13.2] | Loss=0.08633 | Reg=0.00356 | acc=0.9375 | L2-Norm=18.864 | L2-Norm(final)=4.306 | 6661.8 samples/s | 104.1 steps/s
[Step=2750 Epoch=13.4] | Loss=0.07687 | Reg=0.00357 | acc=0.9844 | L2-Norm=18.889 | L2-Norm(final)=4.301 | 1847.4 samples/s | 28.9 steps/s
[Step=2800 Epoch=13.7] | Loss=0.06967 | Reg=0.00358 | acc=0.9844 | L2-Norm=18.915 | L2-Norm(final)=4.304 | 4825.3 samples/s | 75.4 steps/s
[Step=2850 Epoch=13.9] | Loss=0.06574 | Reg=0.00359 | acc=0.9688 | L2-Norm=18.938 | L2-Norm(final)=4.307 | 4869.2 samples/s | 76.1 steps/s
[Step=2900 Epoch=14.1] | Loss=0.06232 | Reg=0.00359 | acc=0.9844 | L2-Norm=18.958 | L2-Norm(final)=4.309 | 6060.4 samples/s | 94.7 steps/s
[Step=2950 Epoch=14.4] | Loss=0.05901 | Reg=0.00360 | acc=0.9844 | L2-Norm=18.976 | L2-Norm(final)=4.311 | 1903.4 samples/s | 29.7 steps/s
[Step=3000 Epoch=14.6] | Loss=0.05580 | Reg=0.00361 | acc=0.9844 | L2-Norm=18.992 | L2-Norm(final)=4.313 | 4892.9 samples/s | 76.5 steps/s
[Step=3050 Epoch=14.9] | Loss=0.05328 | Reg=0.00361 | acc=0.9844 | L2-Norm=19.004 | L2-Norm(final)=4.316 | 4972.2 samples/s | 77.7 steps/s
[Step=3100 Epoch=15.1] | Loss=0.05175 | Reg=0.00362 | acc=0.9844 | L2-Norm=19.017 | L2-Norm(final)=4.316 | 5567.2 samples/s | 87.0 steps/s
[Step=3150 Epoch=15.4] | Loss=0.04949 | Reg=0.00362 | acc=1.0000 | L2-Norm=19.030 | L2-Norm(final)=4.317 | 1932.2 samples/s | 30.2 steps/s
[Step=3200 Epoch=15.6] | Loss=0.04745 | Reg=0.00363 | acc=1.0000 | L2-Norm=19.043 | L2-Norm(final)=4.318 | 4758.4 samples/s | 74.4 steps/s
[Step=3250 Epoch=15.8] | Loss=0.04660 | Reg=0.00363 | acc=1.0000 | L2-Norm=19.054 | L2-Norm(final)=4.318 | 4809.7 samples/s | 75.2 steps/s
[Step=3300 Epoch=16.1] | Loss=0.04531 | Reg=0.00364 | acc=1.0000 | L2-Norm=19.066 | L2-Norm(final)=4.318 | 5279.1 samples/s | 82.5 steps/s
[Step=3350 Epoch=16.3] | Loss=0.04351 | Reg=0.00364 | acc=0.9844 | L2-Norm=19.077 | L2-Norm(final)=4.320 | 1961.0 samples/s | 30.6 steps/s
[Step=3400 Epoch=16.6] | Loss=0.04204 | Reg=0.00364 | acc=0.9688 | L2-Norm=19.088 | L2-Norm(final)=4.322 | 4965.6 samples/s | 77.6 steps/s
[Step=3450 Epoch=16.8] | Loss=0.04072 | Reg=0.00365 | acc=1.0000 | L2-Norm=19.097 | L2-Norm(final)=4.324 | 4802.9 samples/s | 75.0 steps/s
[Step=3500 Epoch=17.1] | Loss=0.04002 | Reg=0.00365 | acc=0.9531 | L2-Norm=19.104 | L2-Norm(final)=4.325 | 5069.9 samples/s | 79.2 steps/s
[Step=3550 Epoch=17.3] | Loss=0.03896 | Reg=0.00365 | acc=0.9688 | L2-Norm=19.112 | L2-Norm(final)=4.326 | 2031.8 samples/s | 31.7 steps/s
[Step=3600 Epoch=17.6] | Loss=0.03771 | Reg=0.00365 | acc=1.0000 | L2-Norm=19.117 | L2-Norm(final)=4.326 | 4808.1 samples/s | 75.1 steps/s
[Step=3650 Epoch=17.8] | Loss=0.03660 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.122 | L2-Norm(final)=4.327 | 4783.4 samples/s | 74.7 steps/s
[Step=3700 Epoch=18.0] | Loss=0.03563 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.126 | L2-Norm(final)=4.329 | 4816.5 samples/s | 75.3 steps/s
[Step=3750 Epoch=18.3] | Loss=0.03496 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.129 | L2-Norm(final)=4.331 | 2031.1 samples/s | 31.7 steps/s
[Step=3800 Epoch=18.5] | Loss=0.03422 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.132 | L2-Norm(final)=4.332 | 4962.4 samples/s | 77.5 steps/s
[Step=3850 Epoch=18.8] | Loss=0.03350 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.134 | L2-Norm(final)=4.333 | 4956.0 samples/s | 77.4 steps/s
[Step=3900 Epoch=19.0] | Loss=0.03269 | Reg=0.00366 | acc=0.9688 | L2-Norm=19.136 | L2-Norm(final)=4.335 | 4880.5 samples/s | 76.3 steps/s
[Step=3950 Epoch=19.3] | Loss=0.03214 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.137 | L2-Norm(final)=4.337 | 2075.1 samples/s | 32.4 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03153 | Reg=0.00366 | acc=1.0000 | L2-Norm=19.139 | L2-Norm(final)=4.338 | 4902.8 samples/s | 76.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step4000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=8001 Epoch=39.2] | Loss=0.10202 | Reg=0.00218 | acc=0.9219 | L2-Norm=14.756 | L2-Norm(final)=5.224 | 4042.5 samples/s | 63.2 steps/s
[Step=8050 Epoch=39.5] | Loss=0.09370 | Reg=0.00223 | acc=0.9531 | L2-Norm=14.916 | L2-Norm(final)=5.296 | 5029.4 samples/s | 78.6 steps/s
[Step=8100 Epoch=39.7] | Loss=0.09164 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.073 | L2-Norm(final)=5.357 | 5454.0 samples/s | 85.2 steps/s
[Step=8150 Epoch=40.0] | Loss=0.08927 | Reg=0.00231 | acc=0.9219 | L2-Norm=15.201 | L2-Norm(final)=5.403 | 5556.6 samples/s | 86.8 steps/s
[Step=8200 Epoch=40.2] | Loss=0.08646 | Reg=0.00235 | acc=0.9375 | L2-Norm=15.324 | L2-Norm(final)=5.449 | 7871.5 samples/s | 123.0 steps/s
[Step=8250 Epoch=40.5] | Loss=0.08400 | Reg=0.00238 | acc=0.9219 | L2-Norm=15.437 | L2-Norm(final)=5.491 | 1916.1 samples/s | 29.9 steps/s
[Step=8300 Epoch=40.7] | Loss=0.08335 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.546 | L2-Norm(final)=5.530 | 5490.6 samples/s | 85.8 steps/s
[Step=8350 Epoch=40.9] | Loss=0.08180 | Reg=0.00245 | acc=0.9219 | L2-Norm=15.658 | L2-Norm(final)=5.567 | 5472.2 samples/s | 85.5 steps/s
[Step=8400 Epoch=41.2] | Loss=0.08074 | Reg=0.00249 | acc=0.8906 | L2-Norm=15.766 | L2-Norm(final)=5.603 | 7413.2 samples/s | 115.8 steps/s
[Step=8450 Epoch=41.4] | Loss=0.08015 | Reg=0.00252 | acc=0.9688 | L2-Norm=15.869 | L2-Norm(final)=5.637 | 1944.8 samples/s | 30.4 steps/s
[Step=8500 Epoch=41.7] | Loss=0.07872 | Reg=0.00255 | acc=0.9531 | L2-Norm=15.970 | L2-Norm(final)=5.672 | 5546.6 samples/s | 86.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=41.7] | Loss=0.04668 | Reg=0.00288 | acc=0.9688 | L2-Norm=16.983 | L2-Norm(final)=6.034 | 3775.0 samples/s | 59.0 steps/s
[Step=8550 Epoch=41.9] | Loss=0.09548 | Reg=0.00291 | acc=0.8750 | L2-Norm=17.067 | L2-Norm(final)=6.019 | 4917.1 samples/s | 76.8 steps/s
[Step=8600 Epoch=42.2] | Loss=0.08851 | Reg=0.00294 | acc=0.8906 | L2-Norm=17.143 | L2-Norm(final)=5.984 | 4953.3 samples/s | 77.4 steps/s
[Step=8650 Epoch=42.4] | Loss=0.08338 | Reg=0.00296 | acc=0.9531 | L2-Norm=17.196 | L2-Norm(final)=5.961 | 4924.5 samples/s | 76.9 steps/s
[Step=8700 Epoch=42.7] | Loss=0.07783 | Reg=0.00297 | acc=0.9688 | L2-Norm=17.241 | L2-Norm(final)=5.948 | 6604.7 samples/s | 103.2 steps/s
[Step=8750 Epoch=42.9] | Loss=0.06953 | Reg=0.00299 | acc=0.9375 | L2-Norm=17.280 | L2-Norm(final)=5.940 | 1852.9 samples/s | 29.0 steps/s
[Step=8800 Epoch=43.2] | Loss=0.06405 | Reg=0.00300 | acc=0.9844 | L2-Norm=17.314 | L2-Norm(final)=5.936 | 4890.9 samples/s | 76.4 steps/s
[Step=8850 Epoch=43.4] | Loss=0.06055 | Reg=0.00301 | acc=0.9688 | L2-Norm=17.348 | L2-Norm(final)=5.934 | 4951.3 samples/s | 77.4 steps/s
[Step=8900 Epoch=43.6] | Loss=0.05704 | Reg=0.00302 | acc=0.9688 | L2-Norm=17.380 | L2-Norm(final)=5.934 | 6154.6 samples/s | 96.2 steps/s
[Step=8950 Epoch=43.9] | Loss=0.05331 | Reg=0.00303 | acc=0.9844 | L2-Norm=17.407 | L2-Norm(final)=5.935 | 1847.3 samples/s | 28.9 steps/s
[Step=9000 Epoch=44.1] | Loss=0.05068 | Reg=0.00304 | acc=0.9844 | L2-Norm=17.432 | L2-Norm(final)=5.937 | 4806.5 samples/s | 75.1 steps/s
[Step=9050 Epoch=44.4] | Loss=0.04839 | Reg=0.00305 | acc=0.9844 | L2-Norm=17.456 | L2-Norm(final)=5.938 | 4838.1 samples/s | 75.6 steps/s
[Step=9100 Epoch=44.6] | Loss=0.04694 | Reg=0.00306 | acc=0.9688 | L2-Norm=17.480 | L2-Norm(final)=5.939 | 5877.5 samples/s | 91.8 steps/s
[Step=9150 Epoch=44.9] | Loss=0.04512 | Reg=0.00306 | acc=0.9375 | L2-Norm=17.504 | L2-Norm(final)=5.940 | 1896.9 samples/s | 29.6 steps/s
[Step=9200 Epoch=45.1] | Loss=0.04364 | Reg=0.00307 | acc=0.9844 | L2-Norm=17.528 | L2-Norm(final)=5.942 | 4759.8 samples/s | 74.4 steps/s
[Step=9250 Epoch=45.4] | Loss=0.04246 | Reg=0.00308 | acc=0.9844 | L2-Norm=17.551 | L2-Norm(final)=5.942 | 4869.1 samples/s | 76.1 steps/s
[Step=9300 Epoch=45.6] | Loss=0.04115 | Reg=0.00309 | acc=0.9844 | L2-Norm=17.573 | L2-Norm(final)=5.943 | 5544.7 samples/s | 86.6 steps/s
[Step=9350 Epoch=45.9] | Loss=0.03993 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.594 | L2-Norm(final)=5.944 | 1934.6 samples/s | 30.2 steps/s
[Step=9400 Epoch=46.1] | Loss=0.03869 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.612 | L2-Norm(final)=5.944 | 4873.8 samples/s | 76.2 steps/s
[Step=9450 Epoch=46.3] | Loss=0.03775 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.630 | L2-Norm(final)=5.945 | 4804.1 samples/s | 75.1 steps/s
[Step=9500 Epoch=46.6] | Loss=0.03672 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.646 | L2-Norm(final)=5.945 | 5584.5 samples/s | 87.3 steps/s
[Step=9550 Epoch=46.8] | Loss=0.03580 | Reg=0.00312 | acc=0.9844 | L2-Norm=17.662 | L2-Norm(final)=5.945 | 1950.1 samples/s | 30.5 steps/s
[Step=9600 Epoch=47.1] | Loss=0.03468 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.677 | L2-Norm(final)=5.946 | 4926.1 samples/s | 77.0 steps/s
[Step=9650 Epoch=47.3] | Loss=0.03371 | Reg=0.00313 | acc=0.9844 | L2-Norm=17.691 | L2-Norm(final)=5.947 | 4989.5 samples/s | 78.0 steps/s
[Step=9700 Epoch=47.6] | Loss=0.03303 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.702 | L2-Norm(final)=5.948 | 5274.3 samples/s | 82.4 steps/s
[Step=9750 Epoch=47.8] | Loss=0.03232 | Reg=0.00314 | acc=0.9844 | L2-Norm=17.715 | L2-Norm(final)=5.949 | 1978.2 samples/s | 30.9 steps/s
[Step=9800 Epoch=48.1] | Loss=0.03168 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.727 | L2-Norm(final)=5.950 | 4892.3 samples/s | 76.4 steps/s
[Step=9850 Epoch=48.3] | Loss=0.03109 | Reg=0.00315 | acc=0.9688 | L2-Norm=17.739 | L2-Norm(final)=5.951 | 4831.0 samples/s | 75.5 steps/s
[Step=9900 Epoch=48.5] | Loss=0.03063 | Reg=0.00315 | acc=0.9844 | L2-Norm=17.752 | L2-Norm(final)=5.952 | 4983.8 samples/s | 77.9 steps/s
[Step=9950 Epoch=48.8] | Loss=0.03012 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.765 | L2-Norm(final)=5.952 | 1978.3 samples/s | 30.9 steps/s
[Step=10000 Epoch=49.0] | Loss=0.02949 | Reg=0.00316 | acc=0.9844 | L2-Norm=17.778 | L2-Norm(final)=5.953 | 4828.3 samples/s | 75.4 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step10000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=6001 Epoch=56.5] | Loss=0.06528 | Reg=0.00218 | acc=0.9062 | L2-Norm=14.756 | L2-Norm(final)=4.853 | 3781.5 samples/s | 59.1 steps/s
[Step=6050 Epoch=57.0] | Loss=0.02022 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.991 | L2-Norm(final)=4.906 | 4946.4 samples/s | 77.3 steps/s
[Step=6100 Epoch=57.5] | Loss=0.01485 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.157 | L2-Norm(final)=4.964 | 7129.9 samples/s | 111.4 steps/s
[Step=6150 Epoch=58.0] | Loss=0.01154 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.264 | L2-Norm(final)=5.020 | 1840.0 samples/s | 28.8 steps/s
[Step=6200 Epoch=58.4] | Loss=0.00972 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.338 | L2-Norm(final)=5.069 | 6657.6 samples/s | 104.0 steps/s
[Step=6250 Epoch=58.9] | Loss=0.00848 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.390 | L2-Norm(final)=5.114 | 1921.0 samples/s | 30.0 steps/s
[Step=6300 Epoch=59.4] | Loss=0.00748 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.432 | L2-Norm(final)=5.156 | 5918.0 samples/s | 92.5 steps/s
[Step=6350 Epoch=59.8] | Loss=0.00677 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.471 | L2-Norm(final)=5.196 | 2048.1 samples/s | 32.0 steps/s
[Step=6400 Epoch=60.3] | Loss=0.00614 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.504 | L2-Norm(final)=5.234 | 5415.2 samples/s | 84.6 steps/s
[Step=6450 Epoch=60.8] | Loss=0.00562 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.531 | L2-Norm(final)=5.271 | 2031.3 samples/s | 31.7 steps/s
[Step=6500 Epoch=61.2] | Loss=0.00524 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.553 | L2-Norm(final)=5.306 | 5153.6 samples/s | 80.5 steps/s
All layers training...
LR=0.00100, len=1
[Step=6501 Epoch=61.3] | Loss=0.00104 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.747 | L2-Norm(final)=5.652 | 3744.2 samples/s | 58.5 steps/s
[Step=6550 Epoch=61.7] | Loss=0.04106 | Reg=0.00251 | acc=0.9375 | L2-Norm=15.850 | L2-Norm(final)=5.637 | 4605.8 samples/s | 72.0 steps/s
[Step=6600 Epoch=62.2] | Loss=0.03025 | Reg=0.00260 | acc=0.9844 | L2-Norm=16.120 | L2-Norm(final)=5.535 | 6323.4 samples/s | 98.8 steps/s
[Step=6650 Epoch=62.7] | Loss=0.02074 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.232 | L2-Norm(final)=5.503 | 1807.7 samples/s | 28.2 steps/s
[Step=6700 Epoch=63.1] | Loss=0.01583 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.277 | L2-Norm(final)=5.491 | 5641.0 samples/s | 88.1 steps/s
[Step=6750 Epoch=63.6] | Loss=0.01280 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.297 | L2-Norm(final)=5.488 | 1837.4 samples/s | 28.7 steps/s
[Step=6800 Epoch=64.1] | Loss=0.01068 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.301 | L2-Norm(final)=5.487 | 5240.1 samples/s | 81.9 steps/s
[Step=6850 Epoch=64.5] | Loss=0.00917 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.296 | L2-Norm(final)=5.487 | 1928.7 samples/s | 30.1 steps/s
[Step=6900 Epoch=65.0] | Loss=0.00803 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.284 | L2-Norm(final)=5.488 | 4784.0 samples/s | 74.8 steps/s
[Step=6950 Epoch=65.5] | Loss=0.00714 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.267 | L2-Norm(final)=5.488 | 1944.9 samples/s | 30.4 steps/s
[Step=7000 Epoch=66.0] | Loss=0.00643 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.248 | L2-Norm(final)=5.489 | 4559.0 samples/s | 71.2 steps/s
[Step=7050 Epoch=66.4] | Loss=0.00585 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.227 | L2-Norm(final)=5.490 | 1987.4 samples/s | 31.1 steps/s
[Step=7100 Epoch=66.9] | Loss=0.00536 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.204 | L2-Norm(final)=5.491 | 4767.3 samples/s | 74.5 steps/s
[Step=7150 Epoch=67.4] | Loss=0.00495 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.180 | L2-Norm(final)=5.492 | 1985.0 samples/s | 31.0 steps/s
[Step=7200 Epoch=67.8] | Loss=0.00460 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.155 | L2-Norm(final)=5.493 | 4624.3 samples/s | 72.3 steps/s
[Step=7250 Epoch=68.3] | Loss=0.00430 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.129 | L2-Norm(final)=5.494 | 2042.5 samples/s | 31.9 steps/s
[Step=7300 Epoch=68.8] | Loss=0.00403 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.102 | L2-Norm(final)=5.495 | 4525.4 samples/s | 70.7 steps/s
[Step=7350 Epoch=69.3] | Loss=0.00379 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.075 | L2-Norm(final)=5.496 | 6408.3 samples/s | 100.1 steps/s
[Step=7400 Epoch=69.7] | Loss=0.00358 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.048 | L2-Norm(final)=5.497 | 1811.3 samples/s | 28.3 steps/s
[Step=7450 Epoch=70.2] | Loss=0.00340 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.020 | L2-Norm(final)=5.498 | 5722.6 samples/s | 89.4 steps/s
[Step=7500 Epoch=70.7] | Loss=0.00323 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.992 | L2-Norm(final)=5.499 | 1859.8 samples/s | 29.1 steps/s
[Step=7550 Epoch=71.1] | Loss=0.00307 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.964 | L2-Norm(final)=5.500 | 5295.5 samples/s | 82.7 steps/s
[Step=7600 Epoch=71.6] | Loss=0.00293 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.935 | L2-Norm(final)=5.500 | 1899.2 samples/s | 29.7 steps/s
[Step=7650 Epoch=72.1] | Loss=0.00281 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.906 | L2-Norm(final)=5.501 | 4977.4 samples/s | 77.8 steps/s
[Step=7700 Epoch=72.6] | Loss=0.00269 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.877 | L2-Norm(final)=5.502 | 1936.3 samples/s | 30.3 steps/s
[Step=7750 Epoch=73.0] | Loss=0.00258 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.848 | L2-Norm(final)=5.503 | 4618.1 samples/s | 72.2 steps/s
[Step=7800 Epoch=73.5] | Loss=0.00249 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.819 | L2-Norm(final)=5.504 | 1990.6 samples/s | 31.1 steps/s
[Step=7850 Epoch=74.0] | Loss=0.00239 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.790 | L2-Norm(final)=5.505 | 4736.6 samples/s | 74.0 steps/s
[Step=7900 Epoch=74.4] | Loss=0.00231 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.760 | L2-Norm(final)=5.506 | 1981.5 samples/s | 31.0 steps/s
[Step=7950 Epoch=74.9] | Loss=0.00223 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.730 | L2-Norm(final)=5.507 | 4799.4 samples/s | 75.0 steps/s
[Step=8000 Epoch=75.4] | Loss=0.00216 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.701 | L2-Norm(final)=5.507 | 2003.6 samples/s | 31.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step8000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=2001 Epoch=19.1] | Loss=0.09596 | Reg=0.00218 | acc=0.9062 | L2-Norm=14.756 | L2-Norm(final)=3.066 | 3691.5 samples/s | 57.7 steps/s
[Step=2050 Epoch=19.5] | Loss=0.04190 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.263 | L2-Norm(final)=3.141 | 5166.6 samples/s | 80.7 steps/s
[Step=2100 Epoch=20.0] | Loss=0.03199 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.676 | L2-Norm(final)=3.230 | 7404.2 samples/s | 115.7 steps/s
[Step=2150 Epoch=20.5] | Loss=0.02558 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.025 | L2-Norm(final)=3.324 | 1850.7 samples/s | 28.9 steps/s
[Step=2200 Epoch=21.0] | Loss=0.02183 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.301 | L2-Norm(final)=3.406 | 6682.1 samples/s | 104.4 steps/s
[Step=2250 Epoch=21.4] | Loss=0.01896 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.531 | L2-Norm(final)=3.483 | 1902.6 samples/s | 29.7 steps/s
[Step=2300 Epoch=21.9] | Loss=0.01661 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.725 | L2-Norm(final)=3.554 | 6275.0 samples/s | 98.0 steps/s
[Step=2350 Epoch=22.4] | Loss=0.01495 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.882 | L2-Norm(final)=3.617 | 1922.9 samples/s | 30.0 steps/s
[Step=2400 Epoch=22.9] | Loss=0.01367 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.017 | L2-Norm(final)=3.675 | 6037.9 samples/s | 94.3 steps/s
[Step=2450 Epoch=23.4] | Loss=0.01246 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.135 | L2-Norm(final)=3.730 | 1993.0 samples/s | 31.1 steps/s
[Step=2500 Epoch=23.8] | Loss=0.01154 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.233 | L2-Norm(final)=3.781 | 5647.9 samples/s | 88.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=2501 Epoch=23.8] | Loss=0.00093 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.156 | L2-Norm(final)=4.277 | 3735.0 samples/s | 58.4 steps/s
[Step=2550 Epoch=24.3] | Loss=0.03907 | Reg=0.00333 | acc=0.9688 | L2-Norm=18.237 | L2-Norm(final)=4.245 | 4723.5 samples/s | 73.8 steps/s
[Step=2600 Epoch=24.8] | Loss=0.02511 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.263 | L2-Norm(final)=4.205 | 6371.7 samples/s | 99.6 steps/s
[Step=2650 Epoch=25.3] | Loss=0.01713 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.239 | L2-Norm(final)=4.190 | 1788.8 samples/s | 27.9 steps/s
[Step=2700 Epoch=25.7] | Loss=0.01301 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.203 | L2-Norm(final)=4.186 | 5998.7 samples/s | 93.7 steps/s
[Step=2750 Epoch=26.2] | Loss=0.01047 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.163 | L2-Norm(final)=4.186 | 1837.3 samples/s | 28.7 steps/s
[Step=2800 Epoch=26.7] | Loss=0.00874 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.120 | L2-Norm(final)=4.187 | 5629.3 samples/s | 88.0 steps/s
[Step=2850 Epoch=27.2] | Loss=0.00751 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.075 | L2-Norm(final)=4.188 | 1865.9 samples/s | 29.2 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00658 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.029 | L2-Norm(final)=4.190 | 5231.6 samples/s | 81.7 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00585 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.982 | L2-Norm(final)=4.192 | 1887.0 samples/s | 29.5 steps/s
[Step=3000 Epoch=28.6] | Loss=0.00527 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.935 | L2-Norm(final)=4.193 | 4992.6 samples/s | 78.0 steps/s
[Step=3050 Epoch=29.1] | Loss=0.00480 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.887 | L2-Norm(final)=4.195 | 1929.5 samples/s | 30.1 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00440 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.840 | L2-Norm(final)=4.198 | 4806.0 samples/s | 75.1 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00407 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.793 | L2-Norm(final)=4.202 | 1998.2 samples/s | 31.2 steps/s
[Step=3200 Epoch=30.5] | Loss=0.00378 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.746 | L2-Norm(final)=4.208 | 4656.4 samples/s | 72.8 steps/s
[Step=3250 Epoch=31.0] | Loss=0.00353 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.700 | L2-Norm(final)=4.215 | 2006.5 samples/s | 31.4 steps/s
[Step=3300 Epoch=31.5] | Loss=0.00331 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.653 | L2-Norm(final)=4.224 | 4650.5 samples/s | 72.7 steps/s
[Step=3350 Epoch=31.9] | Loss=0.00312 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.607 | L2-Norm(final)=4.234 | 1998.7 samples/s | 31.2 steps/s
[Step=3400 Epoch=32.4] | Loss=0.00295 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.561 | L2-Norm(final)=4.245 | 4679.9 samples/s | 73.1 steps/s
[Step=3450 Epoch=32.9] | Loss=0.00279 | Reg=0.00307 | acc=1.0000 | L2-Norm=17.515 | L2-Norm(final)=4.256 | 1977.5 samples/s | 30.9 steps/s
[Step=3500 Epoch=33.4] | Loss=0.00265 | Reg=0.00305 | acc=1.0000 | L2-Norm=17.469 | L2-Norm(final)=4.268 | 4615.0 samples/s | 72.1 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00253 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.424 | L2-Norm(final)=4.280 | 6609.0 samples/s | 103.3 steps/s
[Step=3600 Epoch=34.3] | Loss=0.00241 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.378 | L2-Norm(final)=4.292 | 1740.9 samples/s | 27.2 steps/s
[Step=3650 Epoch=34.8] | Loss=0.00231 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.333 | L2-Norm(final)=4.305 | 6275.6 samples/s | 98.1 steps/s
[Step=3700 Epoch=35.3] | Loss=0.00221 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.288 | L2-Norm(final)=4.317 | 1791.2 samples/s | 28.0 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00213 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.243 | L2-Norm(final)=4.330 | 6021.4 samples/s | 94.1 steps/s
[Step=3800 Epoch=36.2] | Loss=0.00204 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.198 | L2-Norm(final)=4.343 | 1834.9 samples/s | 28.7 steps/s
[Step=3850 Epoch=36.7] | Loss=0.00197 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.153 | L2-Norm(final)=4.356 | 5645.5 samples/s | 88.2 steps/s
[Step=3900 Epoch=37.2] | Loss=0.00190 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.109 | L2-Norm(final)=4.369 | 1860.7 samples/s | 29.1 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00183 | Reg=0.00292 | acc=1.0000 | L2-Norm=17.064 | L2-Norm(final)=4.381 | 5316.2 samples/s | 83.1 steps/s
[Step=4000 Epoch=38.1] | Loss=0.00177 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.020 | L2-Norm(final)=4.394 | 1916.8 samples/s | 29.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.15645 | acc=0.9356 | tpr=0.9566 | fpr=0.1100 | 4345.7 samples/s | 17.0 steps/s
Avg test loss: 0.15898, Avg test acc: 0.93413, Avg tpr: 0.95704, Avg fpr: 0.11627, total FA: 907

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.14531 | acc=0.9354 | tpr=0.9612 | fpr=0.1207 | 4329.7 samples/s | 16.9 steps/s
Avg test loss: 0.14730, Avg test acc: 0.93481, Avg tpr: 0.96130, Avg fpr: 0.12345, total FA: 963

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.13835 | acc=0.9390 | tpr=0.9487 | fpr=0.0820 | 4351.3 samples/s | 17.0 steps/s
Avg test loss: 0.13954, Avg test acc: 0.93778, Avg tpr: 0.94743, Avg fpr: 0.08345, total FA: 651

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.11903 | acc=0.9424 | tpr=0.9605 | fpr=0.0969 | 4372.7 samples/s | 17.1 steps/s
Avg test loss: 0.12376, Avg test acc: 0.94138, Avg tpr: 0.95967, Avg fpr: 0.09883, total FA: 771

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.14830 | acc=0.9283 | tpr=0.9245 | fpr=0.0634 | 4388.8 samples/s | 17.1 steps/s
Avg test loss: 0.15332, Avg test acc: 0.92812, Avg tpr: 0.92446, Avg fpr: 0.06384, total FA: 498

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.23145 | acc=0.3180 | tpr=0.0079 | fpr=0.0087 | 4386.6 samples/s | 17.1 steps/s
Avg test loss: 4.24032, Avg test acc: 0.31481, Avg tpr: 0.00746, Avg fpr: 0.00923, total FA: 72

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=3.71728 | acc=0.3154 | tpr=0.0037 | fpr=0.0077 | 4334.8 samples/s | 16.9 steps/s
Avg test loss: 3.72727, Avg test acc: 0.31232, Avg tpr: 0.00356, Avg fpr: 0.00859, total FA: 67

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.00413 | acc=0.3162 | tpr=0.0042 | fpr=0.0062 | 4340.2 samples/s | 17.0 steps/s
Avg test loss: 4.01594, Avg test acc: 0.31325, Avg tpr: 0.00420, Avg fpr: 0.00705, total FA: 55

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.18108 | acc=0.3145 | tpr=0.0034 | fpr=0.0102 | 4263.2 samples/s | 16.7 steps/s
Avg test loss: 4.19214, Avg test acc: 0.31108, Avg tpr: 0.00286, Avg fpr: 0.01102, total FA: 86

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=3.67570 | acc=0.3145 | tpr=0.0007 | fpr=0.0042 | 4195.8 samples/s | 16.4 steps/s
Avg test loss: 3.67947, Avg test acc: 0.31176, Avg tpr: 0.00064, Avg fpr: 0.00397, total FA: 31

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.97631 | acc=0.1177 | tpr=0.7743 | fpr=0.8941 | 4385.9 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.96445 | acc=0.1205 | tpr=0.7420 | fpr=0.8911 | 8501.9 samples/s | 33.2 steps/s
[Step= 150] | Loss=4.95292 | acc=0.1209 | tpr=0.7536 | fpr=0.8907 | 8533.0 samples/s | 33.3 steps/s
[Step= 200] | Loss=4.94641 | acc=0.1212 | tpr=0.7530 | fpr=0.8903 | 8459.0 samples/s | 33.0 steps/s
[Step= 250] | Loss=4.94866 | acc=0.1207 | tpr=0.7371 | fpr=0.8906 | 8652.9 samples/s | 33.8 steps/s
[Step= 300] | Loss=4.95252 | acc=0.1204 | tpr=0.7367 | fpr=0.8908 | 8750.0 samples/s | 34.2 steps/s
[Step= 350] | Loss=4.94750 | acc=0.1206 | tpr=0.7332 | fpr=0.8905 | 8410.4 samples/s | 32.9 steps/s
[Step= 400] | Loss=4.94689 | acc=0.1210 | tpr=0.7380 | fpr=0.8902 | 8424.0 samples/s | 32.9 steps/s
[Step= 450] | Loss=4.94500 | acc=0.1212 | tpr=0.7390 | fpr=0.8900 | 8670.7 samples/s | 33.9 steps/s
[Step= 500] | Loss=4.94819 | acc=0.1214 | tpr=0.7392 | fpr=0.8898 | 8424.4 samples/s | 32.9 steps/s
[Step= 550] | Loss=4.95079 | acc=0.1211 | tpr=0.7398 | fpr=0.8902 | 15785.7 samples/s | 61.7 steps/s
Avg test loss: 4.95291, Avg test acc: 0.12096, Avg tpr: 0.73891, Avg fpr: 0.89028, total FA: 123613

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.47559 | acc=0.0979 | tpr=0.7035 | fpr=0.9130 | 4360.5 samples/s | 17.0 steps/s
[Step= 100] | Loss=4.46220 | acc=0.0995 | tpr=0.6802 | fpr=0.9113 | 8714.0 samples/s | 34.0 steps/s
[Step= 150] | Loss=4.46728 | acc=0.0993 | tpr=0.6844 | fpr=0.9115 | 8559.1 samples/s | 33.4 steps/s
[Step= 200] | Loss=4.45838 | acc=0.0991 | tpr=0.6754 | fpr=0.9114 | 8514.0 samples/s | 33.3 steps/s
[Step= 250] | Loss=4.45515 | acc=0.0995 | tpr=0.6716 | fpr=0.9109 | 8737.2 samples/s | 34.1 steps/s
[Step= 300] | Loss=4.45302 | acc=0.0995 | tpr=0.6771 | fpr=0.9111 | 8375.3 samples/s | 32.7 steps/s
[Step= 350] | Loss=4.44490 | acc=0.1000 | tpr=0.6706 | fpr=0.9104 | 8514.7 samples/s | 33.3 steps/s
[Step= 400] | Loss=4.44760 | acc=0.0997 | tpr=0.6707 | fpr=0.9106 | 8858.3 samples/s | 34.6 steps/s
[Step= 450] | Loss=4.45526 | acc=0.0993 | tpr=0.6704 | fpr=0.9110 | 8454.0 samples/s | 33.0 steps/s
[Step= 500] | Loss=4.45670 | acc=0.0990 | tpr=0.6674 | fpr=0.9113 | 8354.1 samples/s | 32.6 steps/s
[Step= 550] | Loss=4.45998 | acc=0.0987 | tpr=0.6641 | fpr=0.9116 | 15930.8 samples/s | 62.2 steps/s
Avg test loss: 4.46119, Avg test acc: 0.09863, Avg tpr: 0.66323, Avg fpr: 0.91163, total FA: 126578

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.26188 | acc=0.1247 | tpr=0.5841 | fpr=0.8836 | 4334.4 samples/s | 16.9 steps/s
[Step= 100] | Loss=5.21577 | acc=0.1267 | tpr=0.5714 | fpr=0.8816 | 8854.4 samples/s | 34.6 steps/s
[Step= 150] | Loss=5.22023 | acc=0.1260 | tpr=0.5648 | fpr=0.8821 | 8601.8 samples/s | 33.6 steps/s
[Step= 200] | Loss=5.22515 | acc=0.1254 | tpr=0.5628 | fpr=0.8825 | 8484.7 samples/s | 33.1 steps/s
[Step= 250] | Loss=5.22065 | acc=0.1251 | tpr=0.5598 | fpr=0.8828 | 8666.0 samples/s | 33.9 steps/s
[Step= 300] | Loss=5.22225 | acc=0.1252 | tpr=0.5636 | fpr=0.8828 | 8884.1 samples/s | 34.7 steps/s
[Step= 350] | Loss=5.21898 | acc=0.1253 | tpr=0.5585 | fpr=0.8826 | 8622.6 samples/s | 33.7 steps/s
[Step= 400] | Loss=5.22018 | acc=0.1255 | tpr=0.5531 | fpr=0.8823 | 8417.4 samples/s | 32.9 steps/s
[Step= 450] | Loss=5.22458 | acc=0.1250 | tpr=0.5497 | fpr=0.8827 | 8623.5 samples/s | 33.7 steps/s
[Step= 500] | Loss=5.22689 | acc=0.1248 | tpr=0.5463 | fpr=0.8828 | 8605.0 samples/s | 33.6 steps/s
[Step= 550] | Loss=5.22823 | acc=0.1248 | tpr=0.5527 | fpr=0.8830 | 15017.6 samples/s | 58.7 steps/s
Avg test loss: 5.22910, Avg test acc: 0.12468, Avg tpr: 0.55388, Avg fpr: 0.88312, total FA: 122620

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=3.99300 | acc=0.1280 | tpr=0.7655 | fpr=0.8835 | 4397.3 samples/s | 17.2 steps/s
[Step= 100] | Loss=3.97668 | acc=0.1304 | tpr=0.7548 | fpr=0.8813 | 8331.5 samples/s | 32.5 steps/s
[Step= 150] | Loss=3.98759 | acc=0.1288 | tpr=0.7695 | fpr=0.8830 | 8527.5 samples/s | 33.3 steps/s
[Step= 200] | Loss=3.98543 | acc=0.1281 | tpr=0.7607 | fpr=0.8834 | 8647.7 samples/s | 33.8 steps/s
[Step= 250] | Loss=3.99027 | acc=0.1275 | tpr=0.7616 | fpr=0.8840 | 8584.1 samples/s | 33.5 steps/s
[Step= 300] | Loss=3.99277 | acc=0.1275 | tpr=0.7636 | fpr=0.8841 | 8936.0 samples/s | 34.9 steps/s
[Step= 350] | Loss=3.98835 | acc=0.1281 | tpr=0.7652 | fpr=0.8835 | 8154.1 samples/s | 31.9 steps/s
[Step= 400] | Loss=3.98890 | acc=0.1281 | tpr=0.7631 | fpr=0.8835 | 8776.3 samples/s | 34.3 steps/s
[Step= 450] | Loss=3.99241 | acc=0.1279 | tpr=0.7600 | fpr=0.8836 | 8640.8 samples/s | 33.8 steps/s
[Step= 500] | Loss=3.99412 | acc=0.1277 | tpr=0.7590 | fpr=0.8837 | 8640.5 samples/s | 33.8 steps/s
[Step= 550] | Loss=3.99429 | acc=0.1278 | tpr=0.7612 | fpr=0.8837 | 15537.9 samples/s | 60.7 steps/s
Avg test loss: 3.99632, Avg test acc: 0.12759, Avg tpr: 0.76030, Avg fpr: 0.88392, total FA: 122730

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.64730 | acc=0.1433 | tpr=0.4469 | fpr=0.8622 | 4351.4 samples/s | 17.0 steps/s
[Step= 100] | Loss=4.59636 | acc=0.1451 | tpr=0.4158 | fpr=0.8600 | 8514.6 samples/s | 33.3 steps/s
[Step= 150] | Loss=4.58934 | acc=0.1460 | tpr=0.4280 | fpr=0.8591 | 8621.7 samples/s | 33.7 steps/s
[Step= 200] | Loss=4.58419 | acc=0.1466 | tpr=0.4350 | fpr=0.8586 | 8430.7 samples/s | 32.9 steps/s
[Step= 250] | Loss=4.58360 | acc=0.1466 | tpr=0.4410 | fpr=0.8587 | 8636.3 samples/s | 33.7 steps/s
[Step= 300] | Loss=4.57673 | acc=0.1467 | tpr=0.4415 | fpr=0.8587 | 8726.2 samples/s | 34.1 steps/s
[Step= 350] | Loss=4.57021 | acc=0.1469 | tpr=0.4302 | fpr=0.8582 | 8986.3 samples/s | 35.1 steps/s
[Step= 400] | Loss=4.56740 | acc=0.1470 | tpr=0.4344 | fpr=0.8582 | 8472.3 samples/s | 33.1 steps/s
[Step= 450] | Loss=4.56554 | acc=0.1474 | tpr=0.4357 | fpr=0.8579 | 8260.0 samples/s | 32.3 steps/s
[Step= 500] | Loss=4.56648 | acc=0.1473 | tpr=0.4308 | fpr=0.8578 | 8869.2 samples/s | 34.6 steps/s
[Step= 550] | Loss=4.57085 | acc=0.1468 | tpr=0.4322 | fpr=0.8584 | 14499.5 samples/s | 56.6 steps/s
Avg test loss: 4.57218, Avg test acc: 0.14666, Avg tpr: 0.43225, Avg fpr: 0.85854, total FA: 119206

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10025 | acc=0.9799 | tpr=0.8717 | fpr=0.0181 | 4352.2 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.10363 | acc=0.9801 | tpr=0.9041 | fpr=0.0185 | 8679.7 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.10715 | acc=0.9793 | tpr=0.9049 | fpr=0.0193 | 8558.5 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.10929 | acc=0.9794 | tpr=0.9115 | fpr=0.0193 | 8511.7 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.10773 | acc=0.9793 | tpr=0.9100 | fpr=0.0195 | 8514.8 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.10909 | acc=0.9792 | tpr=0.9098 | fpr=0.0196 | 8666.5 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.10910 | acc=0.9790 | tpr=0.9105 | fpr=0.0197 | 8499.1 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.11047 | acc=0.9788 | tpr=0.9026 | fpr=0.0198 | 8628.7 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.11261 | acc=0.9785 | tpr=0.9031 | fpr=0.0201 | 8487.9 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.11181 | acc=0.9787 | tpr=0.9031 | fpr=0.0200 | 8362.6 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.11072 | acc=0.9788 | tpr=0.9053 | fpr=0.0198 | 15506.3 samples/s | 60.6 steps/s
Avg test loss: 0.11057, Avg test acc: 0.97885, Avg tpr: 0.90491, Avg fpr: 0.01981, total FA: 2750

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10646 | acc=0.9807 | tpr=0.8230 | fpr=0.0165 | 4240.4 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.11254 | acc=0.9801 | tpr=0.8593 | fpr=0.0176 | 8518.0 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.11519 | acc=0.9792 | tpr=0.8646 | fpr=0.0186 | 8961.7 samples/s | 35.0 steps/s
[Step= 200] | Loss=0.11893 | acc=0.9792 | tpr=0.8689 | fpr=0.0188 | 8247.4 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.11704 | acc=0.9794 | tpr=0.8707 | fpr=0.0186 | 8777.6 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.11922 | acc=0.9789 | tpr=0.8698 | fpr=0.0191 | 8325.0 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.11913 | acc=0.9789 | tpr=0.8779 | fpr=0.0193 | 8596.1 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.12087 | acc=0.9786 | tpr=0.8682 | fpr=0.0194 | 8599.0 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.12349 | acc=0.9784 | tpr=0.8695 | fpr=0.0196 | 8811.1 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.12305 | acc=0.9785 | tpr=0.8705 | fpr=0.0196 | 8457.2 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.12216 | acc=0.9786 | tpr=0.8703 | fpr=0.0194 | 15395.0 samples/s | 60.1 steps/s
Avg test loss: 0.12191, Avg test acc: 0.97860, Avg tpr: 0.87005, Avg fpr: 0.01942, total FA: 2697

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.09985 | acc=0.9800 | tpr=0.8982 | fpr=0.0185 | 4405.9 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.10088 | acc=0.9791 | tpr=0.9019 | fpr=0.0195 | 8477.7 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.10410 | acc=0.9782 | tpr=0.9006 | fpr=0.0203 | 8675.0 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.10458 | acc=0.9783 | tpr=0.9005 | fpr=0.0203 | 8639.9 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.10354 | acc=0.9784 | tpr=0.8969 | fpr=0.0201 | 8388.5 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.10527 | acc=0.9779 | tpr=0.8924 | fpr=0.0205 | 8788.3 samples/s | 34.3 steps/s
[Step= 350] | Loss=0.10614 | acc=0.9777 | tpr=0.8917 | fpr=0.0207 | 8298.2 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.10723 | acc=0.9775 | tpr=0.8884 | fpr=0.0209 | 8778.5 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.10859 | acc=0.9773 | tpr=0.8875 | fpr=0.0211 | 8610.7 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.10770 | acc=0.9773 | tpr=0.8912 | fpr=0.0211 | 8774.8 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.10650 | acc=0.9776 | tpr=0.8914 | fpr=0.0209 | 14093.5 samples/s | 55.1 steps/s
Avg test loss: 0.10629, Avg test acc: 0.97758, Avg tpr: 0.89184, Avg fpr: 0.02086, total FA: 2896

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09532 | acc=0.9798 | tpr=0.8584 | fpr=0.0180 | 4333.3 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.09662 | acc=0.9798 | tpr=0.8827 | fpr=0.0184 | 8649.2 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.09976 | acc=0.9790 | tpr=0.8919 | fpr=0.0194 | 8886.4 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.10254 | acc=0.9788 | tpr=0.8973 | fpr=0.0197 | 8788.7 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.10171 | acc=0.9791 | tpr=0.8952 | fpr=0.0193 | 8324.0 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.10330 | acc=0.9789 | tpr=0.8953 | fpr=0.0196 | 8554.6 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.10344 | acc=0.9789 | tpr=0.8979 | fpr=0.0197 | 8916.3 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.10454 | acc=0.9785 | tpr=0.8933 | fpr=0.0199 | 8276.4 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.10702 | acc=0.9782 | tpr=0.8909 | fpr=0.0202 | 8720.8 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.10625 | acc=0.9784 | tpr=0.8930 | fpr=0.0201 | 8732.8 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.10535 | acc=0.9786 | tpr=0.8938 | fpr=0.0199 | 14498.6 samples/s | 56.6 steps/s
Avg test loss: 0.10514, Avg test acc: 0.97856, Avg tpr: 0.89342, Avg fpr: 0.01989, total FA: 2762

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10533 | acc=0.9798 | tpr=0.8628 | fpr=0.0181 | 4421.3 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.10905 | acc=0.9797 | tpr=0.8870 | fpr=0.0185 | 8341.2 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.11226 | acc=0.9790 | tpr=0.8948 | fpr=0.0195 | 8641.9 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.11537 | acc=0.9787 | tpr=0.8929 | fpr=0.0198 | 8883.0 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.11344 | acc=0.9788 | tpr=0.8900 | fpr=0.0196 | 8600.2 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.11565 | acc=0.9784 | tpr=0.8880 | fpr=0.0200 | 8336.4 samples/s | 32.6 steps/s
[Step= 350] | Loss=0.11675 | acc=0.9783 | tpr=0.8898 | fpr=0.0201 | 8752.1 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.11755 | acc=0.9781 | tpr=0.8840 | fpr=0.0202 | 8315.1 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.11958 | acc=0.9779 | tpr=0.8822 | fpr=0.0204 | 8474.9 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.11876 | acc=0.9780 | tpr=0.8833 | fpr=0.0203 | 8701.7 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.11800 | acc=0.9781 | tpr=0.8834 | fpr=0.0202 | 15332.6 samples/s | 59.9 steps/s
Avg test loss: 0.11776, Avg test acc: 0.97809, Avg tpr: 0.88273, Avg fpr: 0.02018, total FA: 2802

server round 8/50

clients selected: [1 2 3 4 7]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=12001 Epoch=58.6] | Loss=0.14983 | Reg=0.00216 | acc=0.8281 | L2-Norm=14.705 | L2-Norm(final)=5.763 | 4125.1 samples/s | 64.5 steps/s
[Step=12050 Epoch=58.8] | Loss=0.09864 | Reg=0.00220 | acc=0.9219 | L2-Norm=14.840 | L2-Norm(final)=5.820 | 4802.9 samples/s | 75.0 steps/s
[Step=12100 Epoch=59.0] | Loss=0.09278 | Reg=0.00224 | acc=0.9531 | L2-Norm=14.978 | L2-Norm(final)=5.873 | 5501.8 samples/s | 86.0 steps/s
[Step=12150 Epoch=59.3] | Loss=0.09075 | Reg=0.00228 | acc=0.8750 | L2-Norm=15.082 | L2-Norm(final)=5.915 | 5565.8 samples/s | 87.0 steps/s
[Step=12200 Epoch=59.5] | Loss=0.08944 | Reg=0.00230 | acc=0.9219 | L2-Norm=15.177 | L2-Norm(final)=5.953 | 7787.5 samples/s | 121.7 steps/s
[Step=12250 Epoch=59.8] | Loss=0.08671 | Reg=0.00233 | acc=0.8906 | L2-Norm=15.269 | L2-Norm(final)=5.992 | 1918.0 samples/s | 30.0 steps/s
[Step=12300 Epoch=60.0] | Loss=0.08429 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.360 | L2-Norm(final)=6.034 | 5506.2 samples/s | 86.0 steps/s
[Step=12350 Epoch=60.3] | Loss=0.08341 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.449 | L2-Norm(final)=6.075 | 5556.4 samples/s | 86.8 steps/s
[Step=12400 Epoch=60.5] | Loss=0.08223 | Reg=0.00242 | acc=0.9531 | L2-Norm=15.537 | L2-Norm(final)=6.114 | 7220.2 samples/s | 112.8 steps/s
[Step=12450 Epoch=60.8] | Loss=0.07987 | Reg=0.00244 | acc=0.9688 | L2-Norm=15.629 | L2-Norm(final)=6.154 | 1955.5 samples/s | 30.6 steps/s
[Step=12500 Epoch=61.0] | Loss=0.07860 | Reg=0.00247 | acc=0.9375 | L2-Norm=15.723 | L2-Norm(final)=6.198 | 5550.7 samples/s | 86.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=61.0] | Loss=0.02670 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.667 | L2-Norm(final)=6.633 | 3988.5 samples/s | 62.3 steps/s
[Step=12550 Epoch=61.2] | Loss=0.08310 | Reg=0.00281 | acc=0.8906 | L2-Norm=16.756 | L2-Norm(final)=6.627 | 4559.7 samples/s | 71.2 steps/s
[Step=12600 Epoch=61.5] | Loss=0.08194 | Reg=0.00283 | acc=0.9062 | L2-Norm=16.824 | L2-Norm(final)=6.591 | 4893.3 samples/s | 76.5 steps/s
[Step=12650 Epoch=61.7] | Loss=0.07848 | Reg=0.00285 | acc=0.9688 | L2-Norm=16.878 | L2-Norm(final)=6.567 | 4866.6 samples/s | 76.0 steps/s
[Step=12700 Epoch=62.0] | Loss=0.07443 | Reg=0.00286 | acc=0.9375 | L2-Norm=16.925 | L2-Norm(final)=6.550 | 6676.0 samples/s | 104.3 steps/s
[Step=12750 Epoch=62.2] | Loss=0.06704 | Reg=0.00288 | acc=0.9844 | L2-Norm=16.972 | L2-Norm(final)=6.538 | 1843.5 samples/s | 28.8 steps/s
[Step=12800 Epoch=62.5] | Loss=0.06232 | Reg=0.00290 | acc=0.9844 | L2-Norm=17.015 | L2-Norm(final)=6.531 | 4939.7 samples/s | 77.2 steps/s
[Step=12850 Epoch=62.7] | Loss=0.05932 | Reg=0.00291 | acc=0.9531 | L2-Norm=17.054 | L2-Norm(final)=6.526 | 4939.4 samples/s | 77.2 steps/s
[Step=12900 Epoch=62.9] | Loss=0.05646 | Reg=0.00292 | acc=0.9844 | L2-Norm=17.087 | L2-Norm(final)=6.520 | 6145.3 samples/s | 96.0 steps/s
[Step=12950 Epoch=63.2] | Loss=0.05313 | Reg=0.00293 | acc=0.9844 | L2-Norm=17.117 | L2-Norm(final)=6.514 | 1894.4 samples/s | 29.6 steps/s
[Step=13000 Epoch=63.4] | Loss=0.04991 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.143 | L2-Norm(final)=6.511 | 5016.9 samples/s | 78.4 steps/s
[Step=13050 Epoch=63.7] | Loss=0.04791 | Reg=0.00295 | acc=0.9688 | L2-Norm=17.166 | L2-Norm(final)=6.508 | 4873.4 samples/s | 76.1 steps/s
[Step=13100 Epoch=63.9] | Loss=0.04619 | Reg=0.00295 | acc=0.9844 | L2-Norm=17.188 | L2-Norm(final)=6.505 | 5811.0 samples/s | 90.8 steps/s
[Step=13150 Epoch=64.2] | Loss=0.04405 | Reg=0.00296 | acc=0.9688 | L2-Norm=17.208 | L2-Norm(final)=6.503 | 1933.1 samples/s | 30.2 steps/s
[Step=13200 Epoch=64.4] | Loss=0.04251 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.224 | L2-Norm(final)=6.500 | 4932.7 samples/s | 77.1 steps/s
[Step=13250 Epoch=64.7] | Loss=0.04116 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.240 | L2-Norm(final)=6.498 | 4948.5 samples/s | 77.3 steps/s
[Step=13300 Epoch=64.9] | Loss=0.04015 | Reg=0.00298 | acc=0.9844 | L2-Norm=17.257 | L2-Norm(final)=6.497 | 5493.3 samples/s | 85.8 steps/s
[Step=13350 Epoch=65.1] | Loss=0.03887 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.274 | L2-Norm(final)=6.496 | 1969.1 samples/s | 30.8 steps/s
[Step=13400 Epoch=65.4] | Loss=0.03775 | Reg=0.00299 | acc=0.9844 | L2-Norm=17.292 | L2-Norm(final)=6.495 | 4951.5 samples/s | 77.4 steps/s
[Step=13450 Epoch=65.6] | Loss=0.03656 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.309 | L2-Norm(final)=6.494 | 4909.5 samples/s | 76.7 steps/s
[Step=13500 Epoch=65.9] | Loss=0.03556 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.324 | L2-Norm(final)=6.493 | 5253.2 samples/s | 82.1 steps/s
[Step=13550 Epoch=66.1] | Loss=0.03465 | Reg=0.00301 | acc=0.9844 | L2-Norm=17.337 | L2-Norm(final)=6.493 | 1990.9 samples/s | 31.1 steps/s
[Step=13600 Epoch=66.4] | Loss=0.03356 | Reg=0.00301 | acc=0.9844 | L2-Norm=17.350 | L2-Norm(final)=6.492 | 4976.9 samples/s | 77.8 steps/s
[Step=13650 Epoch=66.6] | Loss=0.03274 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.360 | L2-Norm(final)=6.492 | 4865.9 samples/s | 76.0 steps/s
[Step=13700 Epoch=66.8] | Loss=0.03191 | Reg=0.00302 | acc=0.9688 | L2-Norm=17.371 | L2-Norm(final)=6.491 | 4898.7 samples/s | 76.5 steps/s
[Step=13750 Epoch=67.1] | Loss=0.03121 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.381 | L2-Norm(final)=6.491 | 2023.8 samples/s | 31.6 steps/s
[Step=13800 Epoch=67.3] | Loss=0.03050 | Reg=0.00303 | acc=1.0000 | L2-Norm=17.392 | L2-Norm(final)=6.491 | 4996.2 samples/s | 78.1 steps/s
[Step=13850 Epoch=67.6] | Loss=0.02993 | Reg=0.00303 | acc=0.9844 | L2-Norm=17.403 | L2-Norm(final)=6.491 | 4939.7 samples/s | 77.2 steps/s
[Step=13900 Epoch=67.8] | Loss=0.02943 | Reg=0.00303 | acc=0.9531 | L2-Norm=17.414 | L2-Norm(final)=6.491 | 4889.6 samples/s | 76.4 steps/s
[Step=13950 Epoch=68.1] | Loss=0.02910 | Reg=0.00304 | acc=0.9844 | L2-Norm=17.425 | L2-Norm(final)=6.490 | 2059.5 samples/s | 32.2 steps/s
[Step=14000 Epoch=68.3] | Loss=0.02865 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.436 | L2-Norm(final)=6.489 | 4989.1 samples/s | 78.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step14000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=10001 Epoch=48.7] | Loss=0.05482 | Reg=0.00216 | acc=0.9531 | L2-Norm=14.705 | L2-Norm(final)=6.172 | 3666.5 samples/s | 57.3 steps/s
[Step=10050 Epoch=49.0] | Loss=0.09151 | Reg=0.00222 | acc=0.9531 | L2-Norm=14.897 | L2-Norm(final)=6.222 | 5540.3 samples/s | 86.6 steps/s
[Step=10100 Epoch=49.2] | Loss=0.08956 | Reg=0.00228 | acc=0.9219 | L2-Norm=15.103 | L2-Norm(final)=6.281 | 5511.8 samples/s | 86.1 steps/s
[Step=10150 Epoch=49.5] | Loss=0.09034 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.268 | L2-Norm(final)=6.326 | 5613.6 samples/s | 87.7 steps/s
[Step=10200 Epoch=49.7] | Loss=0.08901 | Reg=0.00238 | acc=0.9531 | L2-Norm=15.407 | L2-Norm(final)=6.364 | 7627.1 samples/s | 119.2 steps/s
[Step=10250 Epoch=49.9] | Loss=0.08684 | Reg=0.00242 | acc=0.9375 | L2-Norm=15.540 | L2-Norm(final)=6.403 | 1911.7 samples/s | 29.9 steps/s
[Step=10300 Epoch=50.2] | Loss=0.08478 | Reg=0.00246 | acc=0.9375 | L2-Norm=15.674 | L2-Norm(final)=6.447 | 5606.2 samples/s | 87.6 steps/s
[Step=10350 Epoch=50.4] | Loss=0.08331 | Reg=0.00250 | acc=0.9219 | L2-Norm=15.801 | L2-Norm(final)=6.494 | 5619.8 samples/s | 87.8 steps/s
[Step=10400 Epoch=50.7] | Loss=0.08214 | Reg=0.00254 | acc=0.9688 | L2-Norm=15.924 | L2-Norm(final)=6.539 | 6925.4 samples/s | 108.2 steps/s
[Step=10450 Epoch=50.9] | Loss=0.08056 | Reg=0.00258 | acc=0.9531 | L2-Norm=16.047 | L2-Norm(final)=6.585 | 1976.5 samples/s | 30.9 steps/s
[Step=10500 Epoch=51.2] | Loss=0.07919 | Reg=0.00262 | acc=0.9531 | L2-Norm=16.167 | L2-Norm(final)=6.631 | 5531.0 samples/s | 86.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=51.2] | Loss=0.09792 | Reg=0.00302 | acc=0.8750 | L2-Norm=17.370 | L2-Norm(final)=7.105 | 3913.5 samples/s | 61.1 steps/s
[Step=10550 Epoch=51.4] | Loss=0.08461 | Reg=0.00305 | acc=0.9219 | L2-Norm=17.465 | L2-Norm(final)=7.100 | 4769.5 samples/s | 74.5 steps/s
[Step=10600 Epoch=51.6] | Loss=0.09066 | Reg=0.00308 | acc=0.8906 | L2-Norm=17.557 | L2-Norm(final)=7.050 | 4956.4 samples/s | 77.4 steps/s
[Step=10650 Epoch=51.9] | Loss=0.08800 | Reg=0.00311 | acc=0.9062 | L2-Norm=17.622 | L2-Norm(final)=7.015 | 4893.9 samples/s | 76.5 steps/s
[Step=10700 Epoch=52.1] | Loss=0.08286 | Reg=0.00312 | acc=0.9688 | L2-Norm=17.669 | L2-Norm(final)=6.993 | 6577.9 samples/s | 102.8 steps/s
[Step=10750 Epoch=52.4] | Loss=0.07568 | Reg=0.00314 | acc=0.9688 | L2-Norm=17.714 | L2-Norm(final)=6.979 | 1879.8 samples/s | 29.4 steps/s
[Step=10800 Epoch=52.6] | Loss=0.06967 | Reg=0.00315 | acc=0.9688 | L2-Norm=17.757 | L2-Norm(final)=6.974 | 4820.1 samples/s | 75.3 steps/s
[Step=10850 Epoch=52.9] | Loss=0.06561 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.792 | L2-Norm(final)=6.969 | 4943.2 samples/s | 77.2 steps/s
[Step=10900 Epoch=53.1] | Loss=0.06331 | Reg=0.00318 | acc=0.9219 | L2-Norm=17.822 | L2-Norm(final)=6.962 | 6117.7 samples/s | 95.6 steps/s
[Step=10950 Epoch=53.4] | Loss=0.05971 | Reg=0.00319 | acc=0.9688 | L2-Norm=17.849 | L2-Norm(final)=6.956 | 1926.8 samples/s | 30.1 steps/s
[Step=11000 Epoch=53.6] | Loss=0.05611 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.874 | L2-Norm(final)=6.954 | 4905.9 samples/s | 76.7 steps/s
[Step=11050 Epoch=53.8] | Loss=0.05373 | Reg=0.00320 | acc=0.9688 | L2-Norm=17.896 | L2-Norm(final)=6.952 | 4939.5 samples/s | 77.2 steps/s
[Step=11100 Epoch=54.1] | Loss=0.05169 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.918 | L2-Norm(final)=6.951 | 5676.4 samples/s | 88.7 steps/s
[Step=11150 Epoch=54.3] | Loss=0.04940 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.940 | L2-Norm(final)=6.950 | 1966.5 samples/s | 30.7 steps/s
[Step=11200 Epoch=54.6] | Loss=0.04725 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.961 | L2-Norm(final)=6.950 | 4871.1 samples/s | 76.1 steps/s
[Step=11250 Epoch=54.8] | Loss=0.04566 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.980 | L2-Norm(final)=6.950 | 4919.7 samples/s | 76.9 steps/s
[Step=11300 Epoch=55.1] | Loss=0.04453 | Reg=0.00324 | acc=0.9844 | L2-Norm=17.996 | L2-Norm(final)=6.948 | 5395.8 samples/s | 84.3 steps/s
[Step=11350 Epoch=55.3] | Loss=0.04303 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.012 | L2-Norm(final)=6.947 | 1988.5 samples/s | 31.1 steps/s
[Step=11400 Epoch=55.5] | Loss=0.04183 | Reg=0.00325 | acc=0.9844 | L2-Norm=18.027 | L2-Norm(final)=6.946 | 4996.4 samples/s | 78.1 steps/s
[Step=11450 Epoch=55.8] | Loss=0.04050 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.042 | L2-Norm(final)=6.944 | 4907.8 samples/s | 76.7 steps/s
[Step=11500 Epoch=56.0] | Loss=0.03943 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.056 | L2-Norm(final)=6.944 | 5045.9 samples/s | 78.8 steps/s
[Step=11550 Epoch=56.3] | Loss=0.03826 | Reg=0.00327 | acc=0.9844 | L2-Norm=18.069 | L2-Norm(final)=6.943 | 2026.7 samples/s | 31.7 steps/s
[Step=11600 Epoch=56.5] | Loss=0.03726 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.081 | L2-Norm(final)=6.943 | 4986.2 samples/s | 77.9 steps/s
[Step=11650 Epoch=56.8] | Loss=0.03628 | Reg=0.00327 | acc=0.9688 | L2-Norm=18.092 | L2-Norm(final)=6.942 | 4962.8 samples/s | 77.5 steps/s
[Step=11700 Epoch=57.0] | Loss=0.03567 | Reg=0.00328 | acc=0.9844 | L2-Norm=18.103 | L2-Norm(final)=6.942 | 4932.2 samples/s | 77.1 steps/s
[Step=11750 Epoch=57.3] | Loss=0.03480 | Reg=0.00328 | acc=0.9688 | L2-Norm=18.114 | L2-Norm(final)=6.942 | 2030.0 samples/s | 31.7 steps/s
[Step=11800 Epoch=57.5] | Loss=0.03432 | Reg=0.00329 | acc=0.9531 | L2-Norm=18.127 | L2-Norm(final)=6.942 | 5014.0 samples/s | 78.3 steps/s
[Step=11850 Epoch=57.7] | Loss=0.03406 | Reg=0.00329 | acc=0.9688 | L2-Norm=18.142 | L2-Norm(final)=6.941 | 4892.3 samples/s | 76.4 steps/s
[Step=11900 Epoch=58.0] | Loss=0.03375 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.159 | L2-Norm(final)=6.940 | 4868.7 samples/s | 76.1 steps/s
[Step=11950 Epoch=58.2] | Loss=0.03321 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.178 | L2-Norm(final)=6.938 | 2052.0 samples/s | 32.1 steps/s
[Step=12000 Epoch=58.5] | Loss=0.03286 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.196 | L2-Norm(final)=6.937 | 4903.2 samples/s | 76.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step12000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.12092 | Reg=0.00216 | acc=0.9375 | L2-Norm=14.705 | L2-Norm(final)=4.357 | 3840.3 samples/s | 60.0 steps/s
[Step=4050 Epoch=19.8] | Loss=0.10829 | Reg=0.00226 | acc=0.8594 | L2-Norm=15.044 | L2-Norm(final)=4.494 | 5473.5 samples/s | 85.5 steps/s
[Step=4100 Epoch=20.0] | Loss=0.10117 | Reg=0.00236 | acc=0.9531 | L2-Norm=15.369 | L2-Norm(final)=4.580 | 5440.6 samples/s | 85.0 steps/s
[Step=4150 Epoch=20.2] | Loss=0.09779 | Reg=0.00245 | acc=0.9219 | L2-Norm=15.635 | L2-Norm(final)=4.654 | 5563.2 samples/s | 86.9 steps/s
[Step=4200 Epoch=20.5] | Loss=0.09722 | Reg=0.00252 | acc=0.9688 | L2-Norm=15.856 | L2-Norm(final)=4.716 | 7654.4 samples/s | 119.6 steps/s
[Step=4250 Epoch=20.7] | Loss=0.09276 | Reg=0.00259 | acc=0.9688 | L2-Norm=16.069 | L2-Norm(final)=4.774 | 1934.6 samples/s | 30.2 steps/s
[Step=4300 Epoch=21.0] | Loss=0.09062 | Reg=0.00265 | acc=0.9375 | L2-Norm=16.273 | L2-Norm(final)=4.833 | 5528.0 samples/s | 86.4 steps/s
[Step=4350 Epoch=21.2] | Loss=0.08889 | Reg=0.00272 | acc=0.9375 | L2-Norm=16.466 | L2-Norm(final)=4.891 | 5549.1 samples/s | 86.7 steps/s
[Step=4400 Epoch=21.5] | Loss=0.08798 | Reg=0.00278 | acc=0.9531 | L2-Norm=16.637 | L2-Norm(final)=4.945 | 7141.0 samples/s | 111.6 steps/s
[Step=4450 Epoch=21.7] | Loss=0.08753 | Reg=0.00283 | acc=0.9531 | L2-Norm=16.802 | L2-Norm(final)=4.995 | 1984.4 samples/s | 31.0 steps/s
[Step=4500 Epoch=21.9] | Loss=0.08531 | Reg=0.00289 | acc=1.0000 | L2-Norm=16.967 | L2-Norm(final)=5.045 | 5530.0 samples/s | 86.4 steps/s
All layers training...
LR=0.00100, len=1
[Step=4501 Epoch=21.9] | Loss=0.09022 | Reg=0.00345 | acc=0.9375 | L2-Norm=18.561 | L2-Norm(final)=5.556 | 3891.9 samples/s | 60.8 steps/s
[Step=4550 Epoch=22.2] | Loss=0.08888 | Reg=0.00348 | acc=0.9375 | L2-Norm=18.650 | L2-Norm(final)=5.564 | 4747.7 samples/s | 74.2 steps/s
[Step=4600 Epoch=22.4] | Loss=0.08658 | Reg=0.00351 | acc=0.9531 | L2-Norm=18.729 | L2-Norm(final)=5.540 | 4893.9 samples/s | 76.5 steps/s
[Step=4650 Epoch=22.7] | Loss=0.08502 | Reg=0.00353 | acc=0.9062 | L2-Norm=18.786 | L2-Norm(final)=5.509 | 4949.0 samples/s | 77.3 steps/s
[Step=4700 Epoch=22.9] | Loss=0.08063 | Reg=0.00355 | acc=0.9688 | L2-Norm=18.833 | L2-Norm(final)=5.486 | 6658.7 samples/s | 104.0 steps/s
[Step=4750 Epoch=23.2] | Loss=0.07290 | Reg=0.00356 | acc=0.9688 | L2-Norm=18.874 | L2-Norm(final)=5.473 | 1867.7 samples/s | 29.2 steps/s
[Step=4800 Epoch=23.4] | Loss=0.06754 | Reg=0.00358 | acc=0.9375 | L2-Norm=18.911 | L2-Norm(final)=5.466 | 4940.0 samples/s | 77.2 steps/s
[Step=4850 Epoch=23.7] | Loss=0.06504 | Reg=0.00359 | acc=0.9531 | L2-Norm=18.943 | L2-Norm(final)=5.460 | 4925.6 samples/s | 77.0 steps/s
[Step=4900 Epoch=23.9] | Loss=0.06207 | Reg=0.00360 | acc=0.9375 | L2-Norm=18.973 | L2-Norm(final)=5.455 | 6145.0 samples/s | 96.0 steps/s
[Step=4950 Epoch=24.1] | Loss=0.06021 | Reg=0.00361 | acc=0.9688 | L2-Norm=19.007 | L2-Norm(final)=5.450 | 1911.3 samples/s | 29.9 steps/s
[Step=5000 Epoch=24.4] | Loss=0.05807 | Reg=0.00363 | acc=0.9844 | L2-Norm=19.041 | L2-Norm(final)=5.444 | 4834.7 samples/s | 75.5 steps/s
[Step=5050 Epoch=24.6] | Loss=0.05646 | Reg=0.00364 | acc=0.9375 | L2-Norm=19.069 | L2-Norm(final)=5.439 | 4840.5 samples/s | 75.6 steps/s
[Step=5100 Epoch=24.9] | Loss=0.05433 | Reg=0.00365 | acc=0.9844 | L2-Norm=19.095 | L2-Norm(final)=5.435 | 5701.0 samples/s | 89.1 steps/s
[Step=5150 Epoch=25.1] | Loss=0.05154 | Reg=0.00366 | acc=0.9844 | L2-Norm=19.118 | L2-Norm(final)=5.433 | 1959.6 samples/s | 30.6 steps/s
[Step=5200 Epoch=25.4] | Loss=0.04938 | Reg=0.00366 | acc=0.9844 | L2-Norm=19.139 | L2-Norm(final)=5.433 | 4910.5 samples/s | 76.7 steps/s
[Step=5250 Epoch=25.6] | Loss=0.04693 | Reg=0.00367 | acc=0.9844 | L2-Norm=19.156 | L2-Norm(final)=5.434 | 4914.3 samples/s | 76.8 steps/s
[Step=5300 Epoch=25.8] | Loss=0.04537 | Reg=0.00368 | acc=1.0000 | L2-Norm=19.170 | L2-Norm(final)=5.436 | 5395.3 samples/s | 84.3 steps/s
[Step=5350 Epoch=26.1] | Loss=0.04378 | Reg=0.00368 | acc=1.0000 | L2-Norm=19.183 | L2-Norm(final)=5.436 | 1994.4 samples/s | 31.2 steps/s
[Step=5400 Epoch=26.3] | Loss=0.04182 | Reg=0.00368 | acc=0.9844 | L2-Norm=19.194 | L2-Norm(final)=5.438 | 4973.1 samples/s | 77.7 steps/s
[Step=5450 Epoch=26.6] | Loss=0.04053 | Reg=0.00369 | acc=0.9844 | L2-Norm=19.203 | L2-Norm(final)=5.440 | 4958.8 samples/s | 77.5 steps/s
[Step=5500 Epoch=26.8] | Loss=0.03939 | Reg=0.00369 | acc=0.9688 | L2-Norm=19.211 | L2-Norm(final)=5.442 | 5042.0 samples/s | 78.8 steps/s
[Step=5550 Epoch=27.1] | Loss=0.03842 | Reg=0.00369 | acc=0.9844 | L2-Norm=19.217 | L2-Norm(final)=5.443 | 2017.1 samples/s | 31.5 steps/s
[Step=5600 Epoch=27.3] | Loss=0.03739 | Reg=0.00370 | acc=0.9844 | L2-Norm=19.224 | L2-Norm(final)=5.445 | 4996.6 samples/s | 78.1 steps/s
[Step=5650 Epoch=27.6] | Loss=0.03649 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.229 | L2-Norm(final)=5.447 | 4926.0 samples/s | 77.0 steps/s
[Step=5700 Epoch=27.8] | Loss=0.03566 | Reg=0.00370 | acc=1.0000 | L2-Norm=19.235 | L2-Norm(final)=5.448 | 5001.0 samples/s | 78.1 steps/s
[Step=5750 Epoch=28.0] | Loss=0.03497 | Reg=0.00370 | acc=0.9531 | L2-Norm=19.242 | L2-Norm(final)=5.449 | 2046.6 samples/s | 32.0 steps/s
[Step=5800 Epoch=28.3] | Loss=0.03403 | Reg=0.00371 | acc=0.9844 | L2-Norm=19.249 | L2-Norm(final)=5.451 | 5023.8 samples/s | 78.5 steps/s
[Step=5850 Epoch=28.5] | Loss=0.03338 | Reg=0.00371 | acc=1.0000 | L2-Norm=19.256 | L2-Norm(final)=5.453 | 4889.4 samples/s | 76.4 steps/s
[Step=5900 Epoch=28.8] | Loss=0.03286 | Reg=0.00371 | acc=0.9688 | L2-Norm=19.264 | L2-Norm(final)=5.455 | 4924.7 samples/s | 76.9 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03238 | Reg=0.00372 | acc=1.0000 | L2-Norm=19.273 | L2-Norm(final)=5.456 | 2060.2 samples/s | 32.2 steps/s
[Step=6000 Epoch=29.3] | Loss=0.03177 | Reg=0.00372 | acc=1.0000 | L2-Norm=19.283 | L2-Norm(final)=5.457 | 5035.3 samples/s | 78.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step6000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=10001 Epoch=49.0] | Loss=0.11297 | Reg=0.00216 | acc=0.8750 | L2-Norm=14.705 | L2-Norm(final)=5.966 | 3877.4 samples/s | 60.6 steps/s
[Step=10050 Epoch=49.3] | Loss=0.09639 | Reg=0.00221 | acc=0.9062 | L2-Norm=14.860 | L2-Norm(final)=6.005 | 5413.8 samples/s | 84.6 steps/s
[Step=10100 Epoch=49.5] | Loss=0.08922 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.034 | L2-Norm(final)=6.056 | 5485.6 samples/s | 85.7 steps/s
[Step=10150 Epoch=49.8] | Loss=0.08702 | Reg=0.00231 | acc=0.9375 | L2-Norm=15.186 | L2-Norm(final)=6.105 | 5484.7 samples/s | 85.7 steps/s
[Step=10200 Epoch=50.0] | Loss=0.08466 | Reg=0.00235 | acc=0.9531 | L2-Norm=15.317 | L2-Norm(final)=6.146 | 7906.7 samples/s | 123.5 steps/s
[Step=10250 Epoch=50.3] | Loss=0.08124 | Reg=0.00239 | acc=0.9375 | L2-Norm=15.444 | L2-Norm(final)=6.187 | 1938.0 samples/s | 30.3 steps/s
[Step=10300 Epoch=50.5] | Loss=0.08006 | Reg=0.00243 | acc=0.9375 | L2-Norm=15.568 | L2-Norm(final)=6.230 | 5540.7 samples/s | 86.6 steps/s
[Step=10350 Epoch=50.8] | Loss=0.07913 | Reg=0.00246 | acc=0.9219 | L2-Norm=15.689 | L2-Norm(final)=6.269 | 5495.5 samples/s | 85.9 steps/s
[Step=10400 Epoch=51.0] | Loss=0.07838 | Reg=0.00250 | acc=0.9219 | L2-Norm=15.808 | L2-Norm(final)=6.310 | 7452.1 samples/s | 116.4 steps/s
[Step=10450 Epoch=51.2] | Loss=0.07621 | Reg=0.00254 | acc=0.9531 | L2-Norm=15.929 | L2-Norm(final)=6.351 | 1924.6 samples/s | 30.1 steps/s
[Step=10500 Epoch=51.5] | Loss=0.07564 | Reg=0.00258 | acc=0.9375 | L2-Norm=16.052 | L2-Norm(final)=6.393 | 5440.5 samples/s | 85.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=51.5] | Loss=0.04102 | Reg=0.00298 | acc=0.9688 | L2-Norm=17.263 | L2-Norm(final)=6.813 | 4005.5 samples/s | 62.6 steps/s
[Step=10550 Epoch=51.7] | Loss=0.08710 | Reg=0.00301 | acc=0.8438 | L2-Norm=17.349 | L2-Norm(final)=6.801 | 4601.9 samples/s | 71.9 steps/s
[Step=10600 Epoch=52.0] | Loss=0.08435 | Reg=0.00304 | acc=0.9531 | L2-Norm=17.431 | L2-Norm(final)=6.759 | 4894.5 samples/s | 76.5 steps/s
[Step=10650 Epoch=52.2] | Loss=0.08293 | Reg=0.00306 | acc=0.9531 | L2-Norm=17.494 | L2-Norm(final)=6.726 | 4961.2 samples/s | 77.5 steps/s
[Step=10700 Epoch=52.5] | Loss=0.07633 | Reg=0.00308 | acc=0.9375 | L2-Norm=17.545 | L2-Norm(final)=6.707 | 6699.3 samples/s | 104.7 steps/s
[Step=10750 Epoch=52.7] | Loss=0.06819 | Reg=0.00309 | acc=0.9219 | L2-Norm=17.589 | L2-Norm(final)=6.700 | 1842.9 samples/s | 28.8 steps/s
[Step=10800 Epoch=53.0] | Loss=0.06431 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.632 | L2-Norm(final)=6.696 | 4964.8 samples/s | 77.6 steps/s
[Step=10850 Epoch=53.2] | Loss=0.06082 | Reg=0.00312 | acc=0.9688 | L2-Norm=17.672 | L2-Norm(final)=6.690 | 4868.3 samples/s | 76.1 steps/s
[Step=10900 Epoch=53.5] | Loss=0.05899 | Reg=0.00314 | acc=0.9688 | L2-Norm=17.707 | L2-Norm(final)=6.683 | 6396.6 samples/s | 99.9 steps/s
[Step=10950 Epoch=53.7] | Loss=0.05509 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.741 | L2-Norm(final)=6.677 | 1891.5 samples/s | 29.6 steps/s
[Step=11000 Epoch=53.9] | Loss=0.05193 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.770 | L2-Norm(final)=6.675 | 4911.9 samples/s | 76.7 steps/s
[Step=11050 Epoch=54.2] | Loss=0.04923 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.794 | L2-Norm(final)=6.673 | 4922.2 samples/s | 76.9 steps/s
[Step=11100 Epoch=54.4] | Loss=0.04741 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.816 | L2-Norm(final)=6.671 | 6097.4 samples/s | 95.3 steps/s
[Step=11150 Epoch=54.7] | Loss=0.04528 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.836 | L2-Norm(final)=6.670 | 1896.9 samples/s | 29.6 steps/s
[Step=11200 Epoch=54.9] | Loss=0.04338 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.853 | L2-Norm(final)=6.670 | 4938.2 samples/s | 77.2 steps/s
[Step=11250 Epoch=55.2] | Loss=0.04155 | Reg=0.00319 | acc=0.9844 | L2-Norm=17.867 | L2-Norm(final)=6.670 | 4915.2 samples/s | 76.8 steps/s
[Step=11300 Epoch=55.4] | Loss=0.04018 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.881 | L2-Norm(final)=6.671 | 5821.1 samples/s | 91.0 steps/s
[Step=11350 Epoch=55.7] | Loss=0.03856 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.893 | L2-Norm(final)=6.671 | 1940.9 samples/s | 30.3 steps/s
[Step=11400 Epoch=55.9] | Loss=0.03697 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.903 | L2-Norm(final)=6.673 | 4963.0 samples/s | 77.5 steps/s
[Step=11450 Epoch=56.1] | Loss=0.03584 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.911 | L2-Norm(final)=6.674 | 4906.6 samples/s | 76.7 steps/s
[Step=11500 Epoch=56.4] | Loss=0.03484 | Reg=0.00321 | acc=0.9844 | L2-Norm=17.919 | L2-Norm(final)=6.674 | 5553.8 samples/s | 86.8 steps/s
[Step=11550 Epoch=56.6] | Loss=0.03381 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.925 | L2-Norm(final)=6.675 | 1966.2 samples/s | 30.7 steps/s
[Step=11600 Epoch=56.9] | Loss=0.03259 | Reg=0.00322 | acc=0.9688 | L2-Norm=17.931 | L2-Norm(final)=6.676 | 4948.3 samples/s | 77.3 steps/s
[Step=11650 Epoch=57.1] | Loss=0.03179 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.934 | L2-Norm(final)=6.677 | 4937.4 samples/s | 77.1 steps/s
[Step=11700 Epoch=57.4] | Loss=0.03094 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.938 | L2-Norm(final)=6.678 | 5335.3 samples/s | 83.4 steps/s
[Step=11750 Epoch=57.6] | Loss=0.03019 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.942 | L2-Norm(final)=6.680 | 2001.5 samples/s | 31.3 steps/s
[Step=11800 Epoch=57.9] | Loss=0.02954 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.946 | L2-Norm(final)=6.681 | 4913.4 samples/s | 76.8 steps/s
[Step=11850 Epoch=58.1] | Loss=0.02919 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.952 | L2-Norm(final)=6.681 | 4884.4 samples/s | 76.3 steps/s
[Step=11900 Epoch=58.4] | Loss=0.02864 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.958 | L2-Norm(final)=6.683 | 5069.7 samples/s | 79.2 steps/s
[Step=11950 Epoch=58.6] | Loss=0.02841 | Reg=0.00323 | acc=0.9844 | L2-Norm=17.965 | L2-Norm(final)=6.683 | 2010.4 samples/s | 31.4 steps/s
[Step=12000 Epoch=58.8] | Loss=0.02805 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.974 | L2-Norm(final)=6.684 | 4998.7 samples/s | 78.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step12000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=8001 Epoch=76.4] | Loss=0.07137 | Reg=0.00216 | acc=0.9219 | L2-Norm=14.705 | L2-Norm(final)=5.151 | 3700.2 samples/s | 57.8 steps/s
[Step=8050 Epoch=76.9] | Loss=0.02110 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.033 | L2-Norm(final)=5.144 | 5156.6 samples/s | 80.6 steps/s
[Step=8100 Epoch=77.4] | Loss=0.01385 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.199 | L2-Norm(final)=5.190 | 7516.0 samples/s | 117.4 steps/s
[Step=8150 Epoch=77.8] | Loss=0.01019 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.299 | L2-Norm(final)=5.243 | 1847.5 samples/s | 28.9 steps/s
[Step=8200 Epoch=78.3] | Loss=0.00838 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.355 | L2-Norm(final)=5.294 | 6964.5 samples/s | 108.8 steps/s
[Step=8250 Epoch=78.8] | Loss=0.00711 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.392 | L2-Norm(final)=5.341 | 1882.1 samples/s | 29.4 steps/s
[Step=8300 Epoch=79.3] | Loss=0.00616 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.416 | L2-Norm(final)=5.385 | 6244.9 samples/s | 97.6 steps/s
[Step=8350 Epoch=79.7] | Loss=0.00545 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.428 | L2-Norm(final)=5.425 | 1912.1 samples/s | 29.9 steps/s
[Step=8400 Epoch=80.2] | Loss=0.00488 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.435 | L2-Norm(final)=5.464 | 6046.3 samples/s | 94.5 steps/s
[Step=8450 Epoch=80.7] | Loss=0.00443 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.435 | L2-Norm(final)=5.500 | 1977.7 samples/s | 30.9 steps/s
[Step=8500 Epoch=81.2] | Loss=0.00405 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.431 | L2-Norm(final)=5.534 | 5675.0 samples/s | 88.7 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=81.2] | Loss=0.00032 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.373 | L2-Norm(final)=5.865 | 4003.1 samples/s | 62.5 steps/s
[Step=8550 Epoch=81.6] | Loss=0.00030 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.329 | L2-Norm(final)=5.884 | 4226.1 samples/s | 66.0 steps/s
[Step=8600 Epoch=82.1] | Loss=0.00310 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.284 | L2-Norm(final)=5.893 | 6365.7 samples/s | 99.5 steps/s
[Step=8650 Epoch=82.6] | Loss=0.01929 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.467 | L2-Norm(final)=5.818 | 1792.8 samples/s | 28.0 steps/s
[Step=8700 Epoch=83.1] | Loss=0.01537 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.639 | L2-Norm(final)=5.746 | 6093.6 samples/s | 95.2 steps/s
[Step=8750 Epoch=83.6] | Loss=0.01248 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.729 | L2-Norm(final)=5.709 | 1806.2 samples/s | 28.2 steps/s
[Step=8800 Epoch=84.0] | Loss=0.01043 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.777 | L2-Norm(final)=5.686 | 5616.9 samples/s | 87.8 steps/s
[Step=8850 Epoch=84.5] | Loss=0.00895 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.799 | L2-Norm(final)=5.670 | 1870.6 samples/s | 29.2 steps/s
[Step=8900 Epoch=85.0] | Loss=0.00784 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.806 | L2-Norm(final)=5.659 | 5378.8 samples/s | 84.0 steps/s
[Step=8950 Epoch=85.5] | Loss=0.00697 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.802 | L2-Norm(final)=5.651 | 1905.4 samples/s | 29.8 steps/s
[Step=9000 Epoch=85.9] | Loss=0.00628 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.791 | L2-Norm(final)=5.646 | 5060.8 samples/s | 79.1 steps/s
[Step=9050 Epoch=86.4] | Loss=0.00571 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.775 | L2-Norm(final)=5.641 | 1937.9 samples/s | 30.3 steps/s
[Step=9100 Epoch=86.9] | Loss=0.00524 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.755 | L2-Norm(final)=5.638 | 4808.5 samples/s | 75.1 steps/s
[Step=9150 Epoch=87.4] | Loss=0.00484 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.732 | L2-Norm(final)=5.635 | 1981.5 samples/s | 31.0 steps/s
[Step=9200 Epoch=87.9] | Loss=0.00449 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.708 | L2-Norm(final)=5.633 | 4752.6 samples/s | 74.3 steps/s
[Step=9250 Epoch=88.3] | Loss=0.00419 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.681 | L2-Norm(final)=5.631 | 1965.7 samples/s | 30.7 steps/s
[Step=9300 Epoch=88.8] | Loss=0.00393 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.653 | L2-Norm(final)=5.630 | 4693.5 samples/s | 73.3 steps/s
[Step=9350 Epoch=89.3] | Loss=0.00370 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.625 | L2-Norm(final)=5.629 | 1989.3 samples/s | 31.1 steps/s
[Step=9400 Epoch=89.8] | Loss=0.00350 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.595 | L2-Norm(final)=5.628 | 4706.2 samples/s | 73.5 steps/s
[Step=9450 Epoch=90.2] | Loss=0.00332 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.565 | L2-Norm(final)=5.627 | 2034.1 samples/s | 31.8 steps/s
[Step=9500 Epoch=90.7] | Loss=0.00315 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.534 | L2-Norm(final)=5.627 | 4567.7 samples/s | 71.4 steps/s
[Step=9550 Epoch=91.2] | Loss=0.00300 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.502 | L2-Norm(final)=5.626 | 6954.9 samples/s | 108.7 steps/s
[Step=9600 Epoch=91.7] | Loss=0.00286 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.470 | L2-Norm(final)=5.626 | 1752.5 samples/s | 27.4 steps/s
[Step=9650 Epoch=92.2] | Loss=0.00274 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.438 | L2-Norm(final)=5.626 | 6324.9 samples/s | 98.8 steps/s
[Step=9700 Epoch=92.6] | Loss=0.00263 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.406 | L2-Norm(final)=5.626 | 1811.5 samples/s | 28.3 steps/s
[Step=9750 Epoch=93.1] | Loss=0.00252 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.373 | L2-Norm(final)=5.626 | 5916.1 samples/s | 92.4 steps/s
[Step=9800 Epoch=93.6] | Loss=0.00243 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.341 | L2-Norm(final)=5.626 | 1827.2 samples/s | 28.5 steps/s
[Step=9850 Epoch=94.1] | Loss=0.00234 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.308 | L2-Norm(final)=5.626 | 5590.9 samples/s | 87.4 steps/s
[Step=9900 Epoch=94.5] | Loss=0.00225 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.275 | L2-Norm(final)=5.627 | 1869.4 samples/s | 29.2 steps/s
[Step=9950 Epoch=95.0] | Loss=0.00218 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.241 | L2-Norm(final)=5.627 | 5298.6 samples/s | 82.8 steps/s
[Step=10000 Epoch=95.5] | Loss=0.00210 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.208 | L2-Norm(final)=5.627 | 1883.4 samples/s | 29.4 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step10000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.15645 | acc=0.9356 | tpr=0.9566 | fpr=0.1100 | 4429.8 samples/s | 17.3 steps/s
Avg test loss: 0.15898, Avg test acc: 0.93413, Avg tpr: 0.95704, Avg fpr: 0.11627, total FA: 907

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.12791 | acc=0.9343 | tpr=0.9411 | fpr=0.0805 | 4410.5 samples/s | 17.2 steps/s
Avg test loss: 0.13201, Avg test acc: 0.93281, Avg tpr: 0.93863, Avg fpr: 0.07999, total FA: 624

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11926 | acc=0.9363 | tpr=0.9481 | fpr=0.0892 | 4377.3 samples/s | 17.1 steps/s
Avg test loss: 0.12147, Avg test acc: 0.93565, Avg tpr: 0.94620, Avg fpr: 0.08755, total FA: 683

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.13963 | acc=0.9348 | tpr=0.9359 | fpr=0.0674 | 4364.7 samples/s | 17.0 steps/s
Avg test loss: 0.14651, Avg test acc: 0.93181, Avg tpr: 0.93227, Avg fpr: 0.06922, total FA: 540

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.15210 | acc=0.9385 | tpr=0.9598 | fpr=0.1078 | 4340.1 samples/s | 17.0 steps/s
Avg test loss: 0.15102, Avg test acc: 0.93770, Avg tpr: 0.95978, Avg fpr: 0.11088, total FA: 865

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.23145 | acc=0.3180 | tpr=0.0079 | fpr=0.0087 | 4416.6 samples/s | 17.3 steps/s
Avg test loss: 4.24032, Avg test acc: 0.31481, Avg tpr: 0.00746, Avg fpr: 0.00923, total FA: 72

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=3.71728 | acc=0.3154 | tpr=0.0037 | fpr=0.0077 | 4341.4 samples/s | 17.0 steps/s
Avg test loss: 3.72727, Avg test acc: 0.31232, Avg tpr: 0.00356, Avg fpr: 0.00859, total FA: 67

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.08035 | acc=0.3084 | tpr=0.0035 | fpr=0.0297 | 4359.6 samples/s | 17.0 steps/s
Avg test loss: 4.09144, Avg test acc: 0.30639, Avg tpr: 0.00408, Avg fpr: 0.02871, total FA: 224

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.18108 | acc=0.3145 | tpr=0.0034 | fpr=0.0102 | 4427.1 samples/s | 17.3 steps/s
Avg test loss: 4.19214, Avg test acc: 0.31108, Avg tpr: 0.00286, Avg fpr: 0.01102, total FA: 86

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=3.67570 | acc=0.3145 | tpr=0.0007 | fpr=0.0042 | 4443.9 samples/s | 17.4 steps/s
Avg test loss: 3.67947, Avg test acc: 0.31176, Avg tpr: 0.00064, Avg fpr: 0.00397, total FA: 31

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.97631 | acc=0.1177 | tpr=0.7743 | fpr=0.8941 | 4338.0 samples/s | 16.9 steps/s
[Step= 100] | Loss=4.96445 | acc=0.1205 | tpr=0.7420 | fpr=0.8911 | 8637.7 samples/s | 33.7 steps/s
[Step= 150] | Loss=4.95292 | acc=0.1209 | tpr=0.7536 | fpr=0.8907 | 8451.8 samples/s | 33.0 steps/s
[Step= 200] | Loss=4.94641 | acc=0.1212 | tpr=0.7530 | fpr=0.8903 | 8558.7 samples/s | 33.4 steps/s
[Step= 250] | Loss=4.94866 | acc=0.1207 | tpr=0.7371 | fpr=0.8906 | 8789.6 samples/s | 34.3 steps/s
[Step= 300] | Loss=4.95252 | acc=0.1204 | tpr=0.7367 | fpr=0.8908 | 8470.7 samples/s | 33.1 steps/s
[Step= 350] | Loss=4.94750 | acc=0.1206 | tpr=0.7332 | fpr=0.8905 | 8637.6 samples/s | 33.7 steps/s
[Step= 400] | Loss=4.94689 | acc=0.1210 | tpr=0.7380 | fpr=0.8902 | 8733.9 samples/s | 34.1 steps/s
[Step= 450] | Loss=4.94500 | acc=0.1212 | tpr=0.7390 | fpr=0.8900 | 8445.5 samples/s | 33.0 steps/s
[Step= 500] | Loss=4.94819 | acc=0.1214 | tpr=0.7392 | fpr=0.8898 | 8728.9 samples/s | 34.1 steps/s
[Step= 550] | Loss=4.95079 | acc=0.1211 | tpr=0.7398 | fpr=0.8902 | 15417.4 samples/s | 60.2 steps/s
Avg test loss: 4.95291, Avg test acc: 0.12096, Avg tpr: 0.73891, Avg fpr: 0.89028, total FA: 123613

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.23327 | acc=0.1421 | tpr=0.6372 | fpr=0.8668 | 4505.7 samples/s | 17.6 steps/s
[Step= 100] | Loss=4.19937 | acc=0.1438 | tpr=0.6055 | fpr=0.8648 | 8182.3 samples/s | 32.0 steps/s
[Step= 150] | Loss=4.20190 | acc=0.1430 | tpr=0.6037 | fpr=0.8655 | 9452.0 samples/s | 36.9 steps/s
[Step= 200] | Loss=4.20389 | acc=0.1429 | tpr=0.5978 | fpr=0.8653 | 7912.3 samples/s | 30.9 steps/s
[Step= 250] | Loss=4.20033 | acc=0.1431 | tpr=0.6148 | fpr=0.8655 | 8543.1 samples/s | 33.4 steps/s
[Step= 300] | Loss=4.19767 | acc=0.1437 | tpr=0.6182 | fpr=0.8649 | 8772.8 samples/s | 34.3 steps/s
[Step= 350] | Loss=4.19379 | acc=0.1433 | tpr=0.6093 | fpr=0.8651 | 8406.4 samples/s | 32.8 steps/s
[Step= 400] | Loss=4.19732 | acc=0.1436 | tpr=0.6089 | fpr=0.8649 | 8508.3 samples/s | 33.2 steps/s
[Step= 450] | Loss=4.19973 | acc=0.1438 | tpr=0.6100 | fpr=0.8647 | 8623.2 samples/s | 33.7 steps/s
[Step= 500] | Loss=4.20013 | acc=0.1430 | tpr=0.6062 | fpr=0.8654 | 8484.4 samples/s | 33.1 steps/s
[Step= 550] | Loss=4.20178 | acc=0.1433 | tpr=0.6112 | fpr=0.8652 | 16183.3 samples/s | 63.2 steps/s
Avg test loss: 4.20190, Avg test acc: 0.14322, Avg tpr: 0.61054, Avg fpr: 0.86528, total FA: 120142

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.02217 | acc=0.1228 | tpr=0.7035 | fpr=0.8876 | 4463.5 samples/s | 17.4 steps/s
[Step= 100] | Loss=3.98805 | acc=0.1246 | tpr=0.6716 | fpr=0.8856 | 8330.4 samples/s | 32.5 steps/s
[Step= 150] | Loss=3.98179 | acc=0.1249 | tpr=0.6556 | fpr=0.8848 | 9142.2 samples/s | 35.7 steps/s
[Step= 200] | Loss=3.98576 | acc=0.1246 | tpr=0.6579 | fpr=0.8851 | 8139.9 samples/s | 31.8 steps/s
[Step= 250] | Loss=3.98641 | acc=0.1245 | tpr=0.6664 | fpr=0.8853 | 8918.2 samples/s | 34.8 steps/s
[Step= 300] | Loss=3.98643 | acc=0.1241 | tpr=0.6655 | fpr=0.8857 | 8194.6 samples/s | 32.0 steps/s
[Step= 350] | Loss=3.98657 | acc=0.1235 | tpr=0.6637 | fpr=0.8863 | 9006.5 samples/s | 35.2 steps/s
[Step= 400] | Loss=3.98416 | acc=0.1241 | tpr=0.6603 | fpr=0.8857 | 8186.0 samples/s | 32.0 steps/s
[Step= 450] | Loss=3.98475 | acc=0.1239 | tpr=0.6602 | fpr=0.8859 | 8550.9 samples/s | 33.4 steps/s
[Step= 500] | Loss=3.98353 | acc=0.1239 | tpr=0.6608 | fpr=0.8858 | 8664.6 samples/s | 33.8 steps/s
[Step= 550] | Loss=3.98667 | acc=0.1237 | tpr=0.6634 | fpr=0.8861 | 15263.5 samples/s | 59.6 steps/s
Avg test loss: 3.98767, Avg test acc: 0.12372, Avg tpr: 0.66363, Avg fpr: 0.88609, total FA: 123032

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.28787 | acc=0.1722 | tpr=0.5664 | fpr=0.8349 | 4465.9 samples/s | 17.4 steps/s
[Step= 100] | Loss=4.26021 | acc=0.1717 | tpr=0.5565 | fpr=0.8355 | 8033.5 samples/s | 31.4 steps/s
[Step= 150] | Loss=4.25884 | acc=0.1714 | tpr=0.5576 | fpr=0.8357 | 8831.3 samples/s | 34.5 steps/s
[Step= 200] | Loss=4.25417 | acc=0.1710 | tpr=0.5486 | fpr=0.8358 | 8417.9 samples/s | 32.9 steps/s
[Step= 250] | Loss=4.25814 | acc=0.1718 | tpr=0.5502 | fpr=0.8351 | 8534.5 samples/s | 33.3 steps/s
[Step= 300] | Loss=4.25706 | acc=0.1714 | tpr=0.5571 | fpr=0.8357 | 8434.6 samples/s | 32.9 steps/s
[Step= 350] | Loss=4.25467 | acc=0.1714 | tpr=0.5554 | fpr=0.8356 | 8911.7 samples/s | 34.8 steps/s
[Step= 400] | Loss=4.25780 | acc=0.1711 | tpr=0.5438 | fpr=0.8357 | 8480.3 samples/s | 33.1 steps/s
[Step= 450] | Loss=4.26166 | acc=0.1713 | tpr=0.5463 | fpr=0.8355 | 8620.7 samples/s | 33.7 steps/s
[Step= 500] | Loss=4.26241 | acc=0.1707 | tpr=0.5414 | fpr=0.8360 | 8553.3 samples/s | 33.4 steps/s
[Step= 550] | Loss=4.26358 | acc=0.1706 | tpr=0.5404 | fpr=0.8362 | 15751.0 samples/s | 61.5 steps/s
Avg test loss: 4.26415, Avg test acc: 0.17052, Avg tpr: 0.54081, Avg fpr: 0.83621, total FA: 116106

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.98893 | acc=0.1237 | tpr=0.7522 | fpr=0.8876 | 4385.1 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.93743 | acc=0.1243 | tpr=0.7036 | fpr=0.8865 | 8507.3 samples/s | 33.2 steps/s
[Step= 150] | Loss=4.94057 | acc=0.1233 | tpr=0.6974 | fpr=0.8873 | 8634.9 samples/s | 33.7 steps/s
[Step= 200] | Loss=4.93447 | acc=0.1233 | tpr=0.6951 | fpr=0.8871 | 8587.3 samples/s | 33.5 steps/s
[Step= 250] | Loss=4.93517 | acc=0.1235 | tpr=0.6969 | fpr=0.8870 | 8480.1 samples/s | 33.1 steps/s
[Step= 300] | Loss=4.93548 | acc=0.1237 | tpr=0.7011 | fpr=0.8869 | 8797.3 samples/s | 34.4 steps/s
[Step= 350] | Loss=4.93095 | acc=0.1234 | tpr=0.6869 | fpr=0.8869 | 8402.0 samples/s | 32.8 steps/s
[Step= 400] | Loss=4.93243 | acc=0.1237 | tpr=0.6816 | fpr=0.8865 | 8581.5 samples/s | 33.5 steps/s
[Step= 450] | Loss=4.93704 | acc=0.1234 | tpr=0.6743 | fpr=0.8866 | 8582.6 samples/s | 33.5 steps/s
[Step= 500] | Loss=4.93828 | acc=0.1231 | tpr=0.6687 | fpr=0.8868 | 8643.8 samples/s | 33.8 steps/s
[Step= 550] | Loss=4.94231 | acc=0.1230 | tpr=0.6713 | fpr=0.8870 | 15563.4 samples/s | 60.8 steps/s
Avg test loss: 4.94505, Avg test acc: 0.12288, Avg tpr: 0.67155, Avg fpr: 0.88709, total FA: 123171

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10025 | acc=0.9799 | tpr=0.8717 | fpr=0.0181 | 4356.1 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.10363 | acc=0.9801 | tpr=0.9041 | fpr=0.0185 | 8763.2 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.10715 | acc=0.9793 | tpr=0.9049 | fpr=0.0193 | 8837.0 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.10929 | acc=0.9794 | tpr=0.9115 | fpr=0.0193 | 8418.6 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.10773 | acc=0.9793 | tpr=0.9100 | fpr=0.0195 | 8856.3 samples/s | 34.6 steps/s
[Step= 300] | Loss=0.10909 | acc=0.9792 | tpr=0.9098 | fpr=0.0196 | 8195.1 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.10910 | acc=0.9790 | tpr=0.9105 | fpr=0.0197 | 8982.2 samples/s | 35.1 steps/s
[Step= 400] | Loss=0.11047 | acc=0.9788 | tpr=0.9026 | fpr=0.0198 | 8410.9 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.11261 | acc=0.9785 | tpr=0.9031 | fpr=0.0201 | 8484.9 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.11181 | acc=0.9787 | tpr=0.9031 | fpr=0.0200 | 8483.6 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.11072 | acc=0.9788 | tpr=0.9053 | fpr=0.0198 | 16239.1 samples/s | 63.4 steps/s
Avg test loss: 0.11057, Avg test acc: 0.97885, Avg tpr: 0.90491, Avg fpr: 0.01981, total FA: 2750

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10646 | acc=0.9807 | tpr=0.8230 | fpr=0.0165 | 4546.5 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.11254 | acc=0.9801 | tpr=0.8593 | fpr=0.0176 | 8078.2 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.11519 | acc=0.9792 | tpr=0.8646 | fpr=0.0186 | 8454.8 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.11893 | acc=0.9792 | tpr=0.8689 | fpr=0.0188 | 8536.2 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.11704 | acc=0.9794 | tpr=0.8707 | fpr=0.0186 | 9030.8 samples/s | 35.3 steps/s
[Step= 300] | Loss=0.11922 | acc=0.9789 | tpr=0.8698 | fpr=0.0191 | 8693.7 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.11913 | acc=0.9789 | tpr=0.8779 | fpr=0.0193 | 8221.0 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.12087 | acc=0.9786 | tpr=0.8682 | fpr=0.0194 | 8733.8 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.12349 | acc=0.9784 | tpr=0.8695 | fpr=0.0196 | 8559.7 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.12305 | acc=0.9785 | tpr=0.8705 | fpr=0.0196 | 9335.7 samples/s | 36.5 steps/s
[Step= 550] | Loss=0.12216 | acc=0.9786 | tpr=0.8703 | fpr=0.0194 | 13059.7 samples/s | 51.0 steps/s
Avg test loss: 0.12191, Avg test acc: 0.97860, Avg tpr: 0.87005, Avg fpr: 0.01942, total FA: 2697

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.09795 | acc=0.9781 | tpr=0.9071 | fpr=0.0206 | 4351.8 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.09977 | acc=0.9784 | tpr=0.9147 | fpr=0.0204 | 8498.9 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.10250 | acc=0.9776 | tpr=0.9107 | fpr=0.0212 | 8781.8 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.10425 | acc=0.9775 | tpr=0.9169 | fpr=0.0214 | 8389.3 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.10321 | acc=0.9774 | tpr=0.9170 | fpr=0.0215 | 8569.1 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.10533 | acc=0.9771 | tpr=0.9135 | fpr=0.0217 | 8817.9 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.10598 | acc=0.9769 | tpr=0.9136 | fpr=0.0219 | 8585.3 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.10730 | acc=0.9768 | tpr=0.9114 | fpr=0.0220 | 8475.8 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.10918 | acc=0.9766 | tpr=0.9104 | fpr=0.0222 | 8671.4 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.10914 | acc=0.9767 | tpr=0.9132 | fpr=0.0222 | 8399.9 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.10837 | acc=0.9768 | tpr=0.9133 | fpr=0.0221 | 15299.8 samples/s | 59.8 steps/s
Avg test loss: 0.10814, Avg test acc: 0.97678, Avg tpr: 0.91323, Avg fpr: 0.02207, total FA: 3064

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09532 | acc=0.9798 | tpr=0.8584 | fpr=0.0180 | 4454.1 samples/s | 17.4 steps/s
[Step= 100] | Loss=0.09662 | acc=0.9798 | tpr=0.8827 | fpr=0.0184 | 8086.9 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.09976 | acc=0.9790 | tpr=0.8919 | fpr=0.0194 | 8663.8 samples/s | 33.8 steps/s
[Step= 200] | Loss=0.10254 | acc=0.9788 | tpr=0.8973 | fpr=0.0197 | 8627.7 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.10171 | acc=0.9791 | tpr=0.8952 | fpr=0.0193 | 8640.7 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.10330 | acc=0.9789 | tpr=0.8953 | fpr=0.0196 | 8694.3 samples/s | 34.0 steps/s
[Step= 350] | Loss=0.10344 | acc=0.9789 | tpr=0.8979 | fpr=0.0197 | 8294.2 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.10454 | acc=0.9785 | tpr=0.8933 | fpr=0.0199 | 8676.2 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.10702 | acc=0.9782 | tpr=0.8909 | fpr=0.0202 | 8681.2 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.10625 | acc=0.9784 | tpr=0.8930 | fpr=0.0201 | 8752.7 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.10535 | acc=0.9786 | tpr=0.8938 | fpr=0.0199 | 15202.5 samples/s | 59.4 steps/s
Avg test loss: 0.10514, Avg test acc: 0.97856, Avg tpr: 0.89342, Avg fpr: 0.01989, total FA: 2762

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10533 | acc=0.9798 | tpr=0.8628 | fpr=0.0181 | 4350.2 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.10905 | acc=0.9797 | tpr=0.8870 | fpr=0.0185 | 8570.1 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.11226 | acc=0.9790 | tpr=0.8948 | fpr=0.0195 | 8472.5 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.11537 | acc=0.9787 | tpr=0.8929 | fpr=0.0198 | 8976.4 samples/s | 35.1 steps/s
[Step= 250] | Loss=0.11344 | acc=0.9788 | tpr=0.8900 | fpr=0.0196 | 8693.2 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.11565 | acc=0.9784 | tpr=0.8880 | fpr=0.0200 | 8419.9 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.11675 | acc=0.9783 | tpr=0.8898 | fpr=0.0201 | 8497.6 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.11755 | acc=0.9781 | tpr=0.8840 | fpr=0.0202 | 8673.8 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.11958 | acc=0.9779 | tpr=0.8822 | fpr=0.0204 | 8355.5 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.11876 | acc=0.9780 | tpr=0.8833 | fpr=0.0203 | 8516.2 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.11800 | acc=0.9781 | tpr=0.8834 | fpr=0.0202 | 15683.3 samples/s | 61.3 steps/s
Avg test loss: 0.11776, Avg test acc: 0.97809, Avg tpr: 0.88273, Avg fpr: 0.02018, total FA: 2802

server round 9/50

clients selected: [0 2 4 6 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=10001 Epoch=48.8] | Loss=0.08739 | Reg=0.00215 | acc=0.9375 | L2-Norm=14.666 | L2-Norm(final)=5.869 | 3796.4 samples/s | 59.3 steps/s
[Step=10050 Epoch=49.0] | Loss=0.09606 | Reg=0.00221 | acc=0.8906 | L2-Norm=14.861 | L2-Norm(final)=5.930 | 5423.2 samples/s | 84.7 steps/s
[Step=10100 Epoch=49.2] | Loss=0.09266 | Reg=0.00226 | acc=0.9062 | L2-Norm=15.037 | L2-Norm(final)=5.986 | 5560.7 samples/s | 86.9 steps/s
[Step=10150 Epoch=49.5] | Loss=0.09036 | Reg=0.00230 | acc=0.9531 | L2-Norm=15.175 | L2-Norm(final)=6.031 | 5484.8 samples/s | 85.7 steps/s
[Step=10200 Epoch=49.7] | Loss=0.08798 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.309 | L2-Norm(final)=6.075 | 7735.3 samples/s | 120.9 steps/s
[Step=10250 Epoch=50.0] | Loss=0.08509 | Reg=0.00239 | acc=0.9375 | L2-Norm=15.442 | L2-Norm(final)=6.120 | 1929.8 samples/s | 30.2 steps/s
[Step=10300 Epoch=50.2] | Loss=0.08320 | Reg=0.00243 | acc=0.9375 | L2-Norm=15.576 | L2-Norm(final)=6.168 | 5619.7 samples/s | 87.8 steps/s
[Step=10350 Epoch=50.5] | Loss=0.08137 | Reg=0.00247 | acc=0.8906 | L2-Norm=15.707 | L2-Norm(final)=6.216 | 5442.6 samples/s | 85.0 steps/s
[Step=10400 Epoch=50.7] | Loss=0.08027 | Reg=0.00251 | acc=0.9531 | L2-Norm=15.831 | L2-Norm(final)=6.259 | 7117.4 samples/s | 111.2 steps/s
[Step=10450 Epoch=51.0] | Loss=0.07967 | Reg=0.00255 | acc=0.9531 | L2-Norm=15.949 | L2-Norm(final)=6.300 | 1947.8 samples/s | 30.4 steps/s
[Step=10500 Epoch=51.2] | Loss=0.07817 | Reg=0.00259 | acc=0.9531 | L2-Norm=16.065 | L2-Norm(final)=6.343 | 5634.8 samples/s | 88.0 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=51.2] | Loss=0.08864 | Reg=0.00297 | acc=0.9688 | L2-Norm=17.246 | L2-Norm(final)=6.786 | 3787.2 samples/s | 59.2 steps/s
[Step=10550 Epoch=51.4] | Loss=0.08128 | Reg=0.00300 | acc=0.9219 | L2-Norm=17.319 | L2-Norm(final)=6.782 | 4729.8 samples/s | 73.9 steps/s
[Step=10600 Epoch=51.7] | Loss=0.07837 | Reg=0.00303 | acc=0.9688 | L2-Norm=17.396 | L2-Norm(final)=6.747 | 4852.5 samples/s | 75.8 steps/s
[Step=10650 Epoch=51.9] | Loss=0.07407 | Reg=0.00305 | acc=0.9688 | L2-Norm=17.451 | L2-Norm(final)=6.726 | 4927.9 samples/s | 77.0 steps/s
[Step=10700 Epoch=52.2] | Loss=0.07049 | Reg=0.00306 | acc=0.9219 | L2-Norm=17.494 | L2-Norm(final)=6.713 | 6646.3 samples/s | 103.8 steps/s
[Step=10750 Epoch=52.4] | Loss=0.06447 | Reg=0.00307 | acc=0.9688 | L2-Norm=17.526 | L2-Norm(final)=6.703 | 1856.0 samples/s | 29.0 steps/s
[Step=10800 Epoch=52.7] | Loss=0.05974 | Reg=0.00308 | acc=0.9375 | L2-Norm=17.552 | L2-Norm(final)=6.698 | 4894.4 samples/s | 76.5 steps/s
[Step=10850 Epoch=52.9] | Loss=0.05586 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.572 | L2-Norm(final)=6.693 | 4906.6 samples/s | 76.7 steps/s
[Step=10900 Epoch=53.2] | Loss=0.05316 | Reg=0.00309 | acc=0.9844 | L2-Norm=17.591 | L2-Norm(final)=6.691 | 6044.4 samples/s | 94.4 steps/s
[Step=10950 Epoch=53.4] | Loss=0.05009 | Reg=0.00310 | acc=0.9688 | L2-Norm=17.608 | L2-Norm(final)=6.689 | 1904.6 samples/s | 29.8 steps/s
[Step=11000 Epoch=53.6] | Loss=0.04754 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.623 | L2-Norm(final)=6.689 | 4913.5 samples/s | 76.8 steps/s
[Step=11050 Epoch=53.9] | Loss=0.04602 | Reg=0.00311 | acc=0.9844 | L2-Norm=17.639 | L2-Norm(final)=6.687 | 4994.0 samples/s | 78.0 steps/s
[Step=11100 Epoch=54.1] | Loss=0.04403 | Reg=0.00312 | acc=0.9688 | L2-Norm=17.654 | L2-Norm(final)=6.686 | 5635.5 samples/s | 88.1 steps/s
[Step=11150 Epoch=54.4] | Loss=0.04359 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.673 | L2-Norm(final)=6.685 | 1950.1 samples/s | 30.5 steps/s
[Step=11200 Epoch=54.6] | Loss=0.04321 | Reg=0.00313 | acc=0.9688 | L2-Norm=17.698 | L2-Norm(final)=6.682 | 4964.7 samples/s | 77.6 steps/s
[Step=11250 Epoch=54.9] | Loss=0.04226 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.722 | L2-Norm(final)=6.679 | 4906.5 samples/s | 76.7 steps/s
[Step=11300 Epoch=55.1] | Loss=0.04084 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.744 | L2-Norm(final)=6.677 | 5361.7 samples/s | 83.8 steps/s
[Step=11350 Epoch=55.3] | Loss=0.04274 | Reg=0.00316 | acc=0.9375 | L2-Norm=17.768 | L2-Norm(final)=6.672 | 2004.6 samples/s | 31.3 steps/s
[Step=11400 Epoch=55.6] | Loss=0.04331 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.805 | L2-Norm(final)=6.662 | 4927.6 samples/s | 77.0 steps/s
[Step=11450 Epoch=55.8] | Loss=0.04279 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.840 | L2-Norm(final)=6.653 | 4916.4 samples/s | 76.8 steps/s
[Step=11500 Epoch=56.1] | Loss=0.04234 | Reg=0.00320 | acc=0.9844 | L2-Norm=17.874 | L2-Norm(final)=6.645 | 5052.3 samples/s | 78.9 steps/s
[Step=11550 Epoch=56.3] | Loss=0.04157 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.905 | L2-Norm(final)=6.637 | 2020.9 samples/s | 31.6 steps/s
[Step=11600 Epoch=56.6] | Loss=0.04049 | Reg=0.00322 | acc=0.9531 | L2-Norm=17.934 | L2-Norm(final)=6.631 | 5012.6 samples/s | 78.3 steps/s
[Step=11650 Epoch=56.8] | Loss=0.03958 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.960 | L2-Norm(final)=6.625 | 4900.4 samples/s | 76.6 steps/s
[Step=11700 Epoch=57.1] | Loss=0.03855 | Reg=0.00324 | acc=1.0000 | L2-Norm=17.983 | L2-Norm(final)=6.619 | 4772.9 samples/s | 74.6 steps/s
[Step=11750 Epoch=57.3] | Loss=0.03760 | Reg=0.00324 | acc=0.9844 | L2-Norm=18.005 | L2-Norm(final)=6.615 | 2047.2 samples/s | 32.0 steps/s
[Step=11800 Epoch=57.5] | Loss=0.03658 | Reg=0.00325 | acc=0.9688 | L2-Norm=18.024 | L2-Norm(final)=6.611 | 4965.1 samples/s | 77.6 steps/s
[Step=11850 Epoch=57.8] | Loss=0.03568 | Reg=0.00326 | acc=0.9688 | L2-Norm=18.041 | L2-Norm(final)=6.607 | 4945.4 samples/s | 77.3 steps/s
[Step=11900 Epoch=58.0] | Loss=0.03492 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.056 | L2-Norm(final)=6.604 | 4924.7 samples/s | 76.9 steps/s
[Step=11950 Epoch=58.3] | Loss=0.03403 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.069 | L2-Norm(final)=6.601 | 2061.6 samples/s | 32.2 steps/s
[Step=12000 Epoch=58.5] | Loss=0.03317 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.081 | L2-Norm(final)=6.598 | 4798.5 samples/s | 75.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step12000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=12001 Epoch=58.5] | Loss=0.14778 | Reg=0.00215 | acc=0.8438 | L2-Norm=14.666 | L2-Norm(final)=6.879 | 3920.4 samples/s | 61.3 steps/s
[Step=12050 Epoch=58.7] | Loss=0.10462 | Reg=0.00220 | acc=0.9062 | L2-Norm=14.844 | L2-Norm(final)=6.912 | 5273.8 samples/s | 82.4 steps/s
[Step=12100 Epoch=59.0] | Loss=0.09820 | Reg=0.00226 | acc=0.9531 | L2-Norm=15.024 | L2-Norm(final)=6.966 | 5427.2 samples/s | 84.8 steps/s
[Step=12150 Epoch=59.2] | Loss=0.09345 | Reg=0.00230 | acc=0.9375 | L2-Norm=15.173 | L2-Norm(final)=7.020 | 5400.9 samples/s | 84.4 steps/s
[Step=12200 Epoch=59.4] | Loss=0.09130 | Reg=0.00234 | acc=0.9062 | L2-Norm=15.306 | L2-Norm(final)=7.073 | 7536.7 samples/s | 117.8 steps/s
[Step=12250 Epoch=59.7] | Loss=0.08937 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.438 | L2-Norm(final)=7.116 | 1941.8 samples/s | 30.3 steps/s
[Step=12300 Epoch=59.9] | Loss=0.08709 | Reg=0.00243 | acc=0.9375 | L2-Norm=15.574 | L2-Norm(final)=7.169 | 5502.8 samples/s | 86.0 steps/s
[Step=12350 Epoch=60.2] | Loss=0.08584 | Reg=0.00247 | acc=0.9062 | L2-Norm=15.710 | L2-Norm(final)=7.224 | 5491.6 samples/s | 85.8 steps/s
[Step=12400 Epoch=60.4] | Loss=0.08463 | Reg=0.00251 | acc=0.9375 | L2-Norm=15.839 | L2-Norm(final)=7.277 | 7154.2 samples/s | 111.8 steps/s
[Step=12450 Epoch=60.7] | Loss=0.08318 | Reg=0.00255 | acc=0.9375 | L2-Norm=15.965 | L2-Norm(final)=7.327 | 1976.7 samples/s | 30.9 steps/s
[Step=12500 Epoch=60.9] | Loss=0.08170 | Reg=0.00259 | acc=0.9688 | L2-Norm=16.089 | L2-Norm(final)=7.380 | 5617.0 samples/s | 87.8 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=60.9] | Loss=0.08277 | Reg=0.00301 | acc=0.9219 | L2-Norm=17.337 | L2-Norm(final)=7.911 | 3958.3 samples/s | 61.8 steps/s
[Step=12550 Epoch=61.1] | Loss=0.08329 | Reg=0.00304 | acc=0.8906 | L2-Norm=17.441 | L2-Norm(final)=7.928 | 4678.5 samples/s | 73.1 steps/s
[Step=12600 Epoch=61.4] | Loss=0.08660 | Reg=0.00309 | acc=0.8750 | L2-Norm=17.570 | L2-Norm(final)=7.869 | 4861.1 samples/s | 76.0 steps/s
[Step=12650 Epoch=61.6] | Loss=0.08068 | Reg=0.00312 | acc=0.9375 | L2-Norm=17.670 | L2-Norm(final)=7.837 | 4786.9 samples/s | 74.8 steps/s
[Step=12700 Epoch=61.9] | Loss=0.07343 | Reg=0.00315 | acc=0.9844 | L2-Norm=17.741 | L2-Norm(final)=7.823 | 6429.6 samples/s | 100.5 steps/s
[Step=12750 Epoch=62.1] | Loss=0.06617 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.797 | L2-Norm(final)=7.815 | 1883.5 samples/s | 29.4 steps/s
[Step=12800 Epoch=62.4] | Loss=0.06201 | Reg=0.00318 | acc=0.9688 | L2-Norm=17.841 | L2-Norm(final)=7.809 | 4964.9 samples/s | 77.6 steps/s
[Step=12850 Epoch=62.6] | Loss=0.05837 | Reg=0.00320 | acc=0.9531 | L2-Norm=17.879 | L2-Norm(final)=7.805 | 4917.8 samples/s | 76.8 steps/s
[Step=12900 Epoch=62.9] | Loss=0.05544 | Reg=0.00321 | acc=0.9688 | L2-Norm=17.911 | L2-Norm(final)=7.802 | 6029.9 samples/s | 94.2 steps/s
[Step=12950 Epoch=63.1] | Loss=0.05259 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.943 | L2-Norm(final)=7.799 | 1911.6 samples/s | 29.9 steps/s
[Step=13000 Epoch=63.3] | Loss=0.04983 | Reg=0.00323 | acc=0.9688 | L2-Norm=17.973 | L2-Norm(final)=7.798 | 4877.8 samples/s | 76.2 steps/s
[Step=13050 Epoch=63.6] | Loss=0.04787 | Reg=0.00324 | acc=0.9844 | L2-Norm=18.001 | L2-Norm(final)=7.798 | 4919.6 samples/s | 76.9 steps/s
[Step=13100 Epoch=63.8] | Loss=0.04686 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.027 | L2-Norm(final)=7.795 | 5703.6 samples/s | 89.1 steps/s
[Step=13150 Epoch=64.1] | Loss=0.04503 | Reg=0.00326 | acc=1.0000 | L2-Norm=18.052 | L2-Norm(final)=7.792 | 1947.6 samples/s | 30.4 steps/s
[Step=13200 Epoch=64.3] | Loss=0.04362 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.075 | L2-Norm(final)=7.790 | 4880.7 samples/s | 76.3 steps/s
[Step=13250 Epoch=64.6] | Loss=0.04200 | Reg=0.00328 | acc=0.9531 | L2-Norm=18.096 | L2-Norm(final)=7.788 | 4841.6 samples/s | 75.7 steps/s
[Step=13300 Epoch=64.8] | Loss=0.04050 | Reg=0.00328 | acc=0.9688 | L2-Norm=18.114 | L2-Norm(final)=7.786 | 5341.3 samples/s | 83.5 steps/s
[Step=13350 Epoch=65.0] | Loss=0.03921 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.132 | L2-Norm(final)=7.785 | 1966.1 samples/s | 30.7 steps/s
[Step=13400 Epoch=65.3] | Loss=0.03783 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.147 | L2-Norm(final)=7.785 | 4971.8 samples/s | 77.7 steps/s
[Step=13450 Epoch=65.5] | Loss=0.03677 | Reg=0.00330 | acc=0.9531 | L2-Norm=18.162 | L2-Norm(final)=7.784 | 4922.8 samples/s | 76.9 steps/s
[Step=13500 Epoch=65.8] | Loss=0.03621 | Reg=0.00330 | acc=0.9844 | L2-Norm=18.176 | L2-Norm(final)=7.783 | 5051.1 samples/s | 78.9 steps/s
[Step=13550 Epoch=66.0] | Loss=0.03558 | Reg=0.00331 | acc=0.9688 | L2-Norm=18.191 | L2-Norm(final)=7.782 | 2035.5 samples/s | 31.8 steps/s
[Step=13600 Epoch=66.3] | Loss=0.03469 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.206 | L2-Norm(final)=7.781 | 4998.7 samples/s | 78.1 steps/s
[Step=13650 Epoch=66.5] | Loss=0.03398 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.221 | L2-Norm(final)=7.781 | 4913.6 samples/s | 76.8 steps/s
[Step=13700 Epoch=66.8] | Loss=0.03314 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.235 | L2-Norm(final)=7.781 | 4915.6 samples/s | 76.8 steps/s
[Step=13750 Epoch=67.0] | Loss=0.03240 | Reg=0.00333 | acc=0.9844 | L2-Norm=18.248 | L2-Norm(final)=7.781 | 2071.1 samples/s | 32.4 steps/s
[Step=13800 Epoch=67.2] | Loss=0.03172 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.261 | L2-Norm(final)=7.781 | 4930.2 samples/s | 77.0 steps/s
[Step=13850 Epoch=67.5] | Loss=0.03124 | Reg=0.00334 | acc=0.9531 | L2-Norm=18.274 | L2-Norm(final)=7.781 | 4874.7 samples/s | 76.2 steps/s
[Step=13900 Epoch=67.7] | Loss=0.03068 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.289 | L2-Norm(final)=7.780 | 4963.4 samples/s | 77.6 steps/s
[Step=13950 Epoch=68.0] | Loss=0.03033 | Reg=0.00335 | acc=1.0000 | L2-Norm=18.303 | L2-Norm(final)=7.779 | 2043.9 samples/s | 31.9 steps/s
[Step=14000 Epoch=68.2] | Loss=0.02977 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.317 | L2-Norm(final)=7.779 | 4929.9 samples/s | 77.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step14000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=12001 Epoch=58.9] | Loss=0.11980 | Reg=0.00215 | acc=0.8594 | L2-Norm=14.666 | L2-Norm(final)=6.708 | 3788.9 samples/s | 59.2 steps/s
[Step=12050 Epoch=59.1] | Loss=0.08952 | Reg=0.00220 | acc=0.9375 | L2-Norm=14.822 | L2-Norm(final)=6.763 | 5587.2 samples/s | 87.3 steps/s
[Step=12100 Epoch=59.3] | Loss=0.08622 | Reg=0.00226 | acc=0.9062 | L2-Norm=15.036 | L2-Norm(final)=6.828 | 5519.4 samples/s | 86.2 steps/s
[Step=12150 Epoch=59.6] | Loss=0.08279 | Reg=0.00231 | acc=0.9219 | L2-Norm=15.210 | L2-Norm(final)=6.874 | 5526.8 samples/s | 86.4 steps/s
[Step=12200 Epoch=59.8] | Loss=0.08093 | Reg=0.00236 | acc=0.9375 | L2-Norm=15.359 | L2-Norm(final)=6.915 | 7930.6 samples/s | 123.9 steps/s
[Step=12250 Epoch=60.1] | Loss=0.07794 | Reg=0.00240 | acc=0.9531 | L2-Norm=15.498 | L2-Norm(final)=6.960 | 1905.1 samples/s | 29.8 steps/s
[Step=12300 Epoch=60.3] | Loss=0.07550 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.634 | L2-Norm(final)=7.009 | 5464.2 samples/s | 85.4 steps/s
[Step=12350 Epoch=60.6] | Loss=0.07449 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.768 | L2-Norm(final)=7.061 | 5523.2 samples/s | 86.3 steps/s
[Step=12400 Epoch=60.8] | Loss=0.07357 | Reg=0.00253 | acc=0.9688 | L2-Norm=15.897 | L2-Norm(final)=7.110 | 7413.0 samples/s | 115.8 steps/s
[Step=12450 Epoch=61.1] | Loss=0.07173 | Reg=0.00257 | acc=0.9219 | L2-Norm=16.021 | L2-Norm(final)=7.158 | 1951.0 samples/s | 30.5 steps/s
[Step=12500 Epoch=61.3] | Loss=0.07018 | Reg=0.00261 | acc=0.9844 | L2-Norm=16.146 | L2-Norm(final)=7.209 | 5559.5 samples/s | 86.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=12501 Epoch=61.3] | Loss=0.06008 | Reg=0.00303 | acc=0.9219 | L2-Norm=17.415 | L2-Norm(final)=7.736 | 3850.2 samples/s | 60.2 steps/s
[Step=12550 Epoch=61.5] | Loss=0.08983 | Reg=0.00308 | acc=0.9375 | L2-Norm=17.542 | L2-Norm(final)=7.722 | 4882.0 samples/s | 76.3 steps/s
[Step=12600 Epoch=61.8] | Loss=0.08505 | Reg=0.00312 | acc=0.9688 | L2-Norm=17.668 | L2-Norm(final)=7.671 | 4851.0 samples/s | 75.8 steps/s
[Step=12650 Epoch=62.0] | Loss=0.07846 | Reg=0.00315 | acc=0.9688 | L2-Norm=17.752 | L2-Norm(final)=7.648 | 4922.1 samples/s | 76.9 steps/s
[Step=12700 Epoch=62.3] | Loss=0.07223 | Reg=0.00317 | acc=0.9062 | L2-Norm=17.813 | L2-Norm(final)=7.632 | 6752.4 samples/s | 105.5 steps/s
[Step=12750 Epoch=62.5] | Loss=0.06635 | Reg=0.00319 | acc=0.9688 | L2-Norm=17.865 | L2-Norm(final)=7.622 | 1853.5 samples/s | 29.0 steps/s
[Step=12800 Epoch=62.8] | Loss=0.06148 | Reg=0.00321 | acc=1.0000 | L2-Norm=17.909 | L2-Norm(final)=7.615 | 4926.5 samples/s | 77.0 steps/s
[Step=12850 Epoch=63.0] | Loss=0.05832 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.948 | L2-Norm(final)=7.611 | 4801.2 samples/s | 75.0 steps/s
[Step=12900 Epoch=63.3] | Loss=0.05537 | Reg=0.00323 | acc=0.9375 | L2-Norm=17.985 | L2-Norm(final)=7.606 | 6265.1 samples/s | 97.9 steps/s
[Step=12950 Epoch=63.5] | Loss=0.05212 | Reg=0.00325 | acc=0.9688 | L2-Norm=18.020 | L2-Norm(final)=7.602 | 1870.0 samples/s | 29.2 steps/s
[Step=13000 Epoch=63.7] | Loss=0.04927 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.048 | L2-Norm(final)=7.599 | 4883.7 samples/s | 76.3 steps/s
[Step=13050 Epoch=64.0] | Loss=0.04689 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.074 | L2-Norm(final)=7.597 | 4928.3 samples/s | 77.0 steps/s
[Step=13100 Epoch=64.2] | Loss=0.04504 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.096 | L2-Norm(final)=7.595 | 6044.1 samples/s | 94.4 steps/s
[Step=13150 Epoch=64.5] | Loss=0.04270 | Reg=0.00328 | acc=0.9844 | L2-Norm=18.114 | L2-Norm(final)=7.593 | 1895.3 samples/s | 29.6 steps/s
[Step=13200 Epoch=64.7] | Loss=0.04083 | Reg=0.00329 | acc=1.0000 | L2-Norm=18.130 | L2-Norm(final)=7.593 | 4944.9 samples/s | 77.3 steps/s
[Step=13250 Epoch=65.0] | Loss=0.03933 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.144 | L2-Norm(final)=7.592 | 4906.4 samples/s | 76.7 steps/s
[Step=13300 Epoch=65.2] | Loss=0.03809 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.156 | L2-Norm(final)=7.591 | 5838.2 samples/s | 91.2 steps/s
[Step=13350 Epoch=65.5] | Loss=0.03663 | Reg=0.00330 | acc=0.9531 | L2-Norm=18.168 | L2-Norm(final)=7.590 | 1917.6 samples/s | 30.0 steps/s
[Step=13400 Epoch=65.7] | Loss=0.03535 | Reg=0.00330 | acc=0.9844 | L2-Norm=18.178 | L2-Norm(final)=7.590 | 4879.7 samples/s | 76.2 steps/s
[Step=13450 Epoch=66.0] | Loss=0.03420 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.186 | L2-Norm(final)=7.590 | 4863.8 samples/s | 76.0 steps/s
[Step=13500 Epoch=66.2] | Loss=0.03324 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.193 | L2-Norm(final)=7.590 | 5513.8 samples/s | 86.2 steps/s
[Step=13550 Epoch=66.4] | Loss=0.03207 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.199 | L2-Norm(final)=7.591 | 1971.7 samples/s | 30.8 steps/s
[Step=13600 Epoch=66.7] | Loss=0.03113 | Reg=0.00331 | acc=0.9844 | L2-Norm=18.204 | L2-Norm(final)=7.592 | 4952.0 samples/s | 77.4 steps/s
[Step=13650 Epoch=66.9] | Loss=0.03034 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.208 | L2-Norm(final)=7.592 | 4966.7 samples/s | 77.6 steps/s
[Step=13700 Epoch=67.2] | Loss=0.02946 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.211 | L2-Norm(final)=7.592 | 5227.8 samples/s | 81.7 steps/s
[Step=13750 Epoch=67.4] | Loss=0.02850 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.213 | L2-Norm(final)=7.593 | 1985.6 samples/s | 31.0 steps/s
[Step=13800 Epoch=67.7] | Loss=0.02767 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.216 | L2-Norm(final)=7.595 | 5002.9 samples/s | 78.2 steps/s
[Step=13850 Epoch=67.9] | Loss=0.02715 | Reg=0.00332 | acc=1.0000 | L2-Norm=18.218 | L2-Norm(final)=7.596 | 4991.6 samples/s | 78.0 steps/s
[Step=13900 Epoch=68.2] | Loss=0.02706 | Reg=0.00332 | acc=0.9688 | L2-Norm=18.223 | L2-Norm(final)=7.596 | 5096.4 samples/s | 79.6 steps/s
[Step=13950 Epoch=68.4] | Loss=0.02673 | Reg=0.00332 | acc=0.9844 | L2-Norm=18.229 | L2-Norm(final)=7.596 | 1988.0 samples/s | 31.1 steps/s
[Step=14000 Epoch=68.7] | Loss=0.02643 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.237 | L2-Norm(final)=7.595 | 4990.2 samples/s | 78.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step14000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=10001 Epoch=95.1] | Loss=0.04161 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.666 | L2-Norm(final)=5.846 | 3704.1 samples/s | 57.9 steps/s
[Step=10050 Epoch=95.6] | Loss=0.02302 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.896 | L2-Norm(final)=5.844 | 5030.1 samples/s | 78.6 steps/s
[Step=10100 Epoch=96.1] | Loss=0.01657 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.062 | L2-Norm(final)=5.900 | 7469.9 samples/s | 116.7 steps/s
[Step=10150 Epoch=96.6] | Loss=0.01261 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.169 | L2-Norm(final)=5.960 | 1850.9 samples/s | 28.9 steps/s
[Step=10200 Epoch=97.0] | Loss=0.01043 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.250 | L2-Norm(final)=6.018 | 6736.6 samples/s | 105.3 steps/s
[Step=10250 Epoch=97.5] | Loss=0.00886 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.305 | L2-Norm(final)=6.071 | 1909.9 samples/s | 29.8 steps/s
[Step=10300 Epoch=98.0] | Loss=0.00768 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.343 | L2-Norm(final)=6.120 | 6170.1 samples/s | 96.4 steps/s
[Step=10350 Epoch=98.5] | Loss=0.00679 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.375 | L2-Norm(final)=6.168 | 1931.9 samples/s | 30.2 steps/s
[Step=10400 Epoch=98.9] | Loss=0.00616 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.401 | L2-Norm(final)=6.214 | 5749.0 samples/s | 89.8 steps/s
[Step=10450 Epoch=99.4] | Loss=0.00559 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.421 | L2-Norm(final)=6.257 | 1978.6 samples/s | 30.9 steps/s
[Step=10500 Epoch=99.9] | Loss=0.00515 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.436 | L2-Norm(final)=6.297 | 5433.2 samples/s | 84.9 steps/s
All layers training...
LR=0.00100, len=1
[Step=10501 Epoch=99.9] | Loss=0.00138 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.560 | L2-Norm(final)=6.694 | 3900.0 samples/s | 60.9 steps/s
[Step=10550 Epoch=100.4] | Loss=0.00575 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.583 | L2-Norm(final)=6.715 | 4390.5 samples/s | 68.6 steps/s
[Step=10600 Epoch=100.8] | Loss=0.01322 | Reg=0.00249 | acc=0.9844 | L2-Norm=15.765 | L2-Norm(final)=6.670 | 6295.7 samples/s | 98.4 steps/s
[Step=10650 Epoch=101.3] | Loss=0.00966 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.893 | L2-Norm(final)=6.643 | 1810.9 samples/s | 28.3 steps/s
[Step=10700 Epoch=101.8] | Loss=0.00781 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.944 | L2-Norm(final)=6.634 | 5841.2 samples/s | 91.3 steps/s
[Step=10750 Epoch=102.3] | Loss=0.00631 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.965 | L2-Norm(final)=6.632 | 1834.8 samples/s | 28.7 steps/s
[Step=10800 Epoch=102.7] | Loss=0.00527 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.964 | L2-Norm(final)=6.632 | 5461.1 samples/s | 85.3 steps/s
[Step=10850 Epoch=103.2] | Loss=0.00452 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.952 | L2-Norm(final)=6.632 | 1915.5 samples/s | 29.9 steps/s
[Step=10900 Epoch=103.7] | Loss=0.00396 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.931 | L2-Norm(final)=6.633 | 4964.7 samples/s | 77.6 steps/s
[Step=10950 Epoch=104.2] | Loss=0.00352 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.907 | L2-Norm(final)=6.634 | 1933.0 samples/s | 30.2 steps/s
[Step=11000 Epoch=104.6] | Loss=0.00317 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.879 | L2-Norm(final)=6.635 | 4853.5 samples/s | 75.8 steps/s
[Step=11050 Epoch=105.1] | Loss=0.00288 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.848 | L2-Norm(final)=6.636 | 1997.5 samples/s | 31.2 steps/s
[Step=11100 Epoch=105.6] | Loss=0.00264 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.816 | L2-Norm(final)=6.637 | 4752.4 samples/s | 74.3 steps/s
[Step=11150 Epoch=106.1] | Loss=0.00244 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.783 | L2-Norm(final)=6.639 | 1998.5 samples/s | 31.2 steps/s
[Step=11200 Epoch=106.5] | Loss=0.00227 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.749 | L2-Norm(final)=6.640 | 4768.5 samples/s | 74.5 steps/s
[Step=11250 Epoch=107.0] | Loss=0.00212 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.715 | L2-Norm(final)=6.641 | 1996.5 samples/s | 31.2 steps/s
[Step=11300 Epoch=107.5] | Loss=0.00199 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.680 | L2-Norm(final)=6.643 | 4602.6 samples/s | 71.9 steps/s
[Step=11350 Epoch=108.0] | Loss=0.00187 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.645 | L2-Norm(final)=6.644 | 2035.9 samples/s | 31.8 steps/s
[Step=11400 Epoch=108.4] | Loss=0.00177 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.609 | L2-Norm(final)=6.646 | 4375.4 samples/s | 68.4 steps/s
[Step=11450 Epoch=108.9] | Loss=0.00167 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.573 | L2-Norm(final)=6.647 | 6482.9 samples/s | 101.3 steps/s
[Step=11500 Epoch=109.4] | Loss=0.00159 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.537 | L2-Norm(final)=6.649 | 1794.2 samples/s | 28.0 steps/s
[Step=11550 Epoch=109.9] | Loss=0.00151 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.501 | L2-Norm(final)=6.651 | 6017.0 samples/s | 94.0 steps/s
[Step=11600 Epoch=110.3] | Loss=0.00145 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.465 | L2-Norm(final)=6.653 | 1833.2 samples/s | 28.6 steps/s
[Step=11650 Epoch=110.8] | Loss=0.00138 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.428 | L2-Norm(final)=6.655 | 5600.0 samples/s | 87.5 steps/s
[Step=11700 Epoch=111.3] | Loss=0.00133 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.392 | L2-Norm(final)=6.658 | 1882.0 samples/s | 29.4 steps/s
[Step=11750 Epoch=111.8] | Loss=0.00127 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.356 | L2-Norm(final)=6.660 | 5247.6 samples/s | 82.0 steps/s
[Step=11800 Epoch=112.2] | Loss=0.00122 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.319 | L2-Norm(final)=6.662 | 1877.6 samples/s | 29.3 steps/s
[Step=11850 Epoch=112.7] | Loss=0.00118 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.283 | L2-Norm(final)=6.665 | 4934.0 samples/s | 77.1 steps/s
[Step=11900 Epoch=113.2] | Loss=0.00114 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.247 | L2-Norm(final)=6.668 | 1968.2 samples/s | 30.8 steps/s
[Step=11950 Epoch=113.7] | Loss=0.00110 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.210 | L2-Norm(final)=6.671 | 4747.9 samples/s | 74.2 steps/s
[Step=12000 Epoch=114.1] | Loss=0.00106 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.174 | L2-Norm(final)=6.673 | 1977.3 samples/s | 30.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step12000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00100, len=1
[Step=8001 Epoch=75.4] | Loss=0.04151 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.666 | L2-Norm(final)=5.536 | 3855.4 samples/s | 60.2 steps/s
[Step=8050 Epoch=75.9] | Loss=0.02253 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.929 | L2-Norm(final)=5.532 | 4850.0 samples/s | 75.8 steps/s
[Step=8100 Epoch=76.3] | Loss=0.01512 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.060 | L2-Norm(final)=5.572 | 7359.6 samples/s | 115.0 steps/s
[Step=8150 Epoch=76.8] | Loss=0.01131 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.131 | L2-Norm(final)=5.619 | 1861.7 samples/s | 29.1 steps/s
[Step=8200 Epoch=77.3] | Loss=0.00980 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.169 | L2-Norm(final)=5.663 | 6533.6 samples/s | 102.1 steps/s
[Step=8250 Epoch=77.7] | Loss=0.00870 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.202 | L2-Norm(final)=5.705 | 1890.9 samples/s | 29.5 steps/s
[Step=8300 Epoch=78.2] | Loss=0.00762 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.229 | L2-Norm(final)=5.747 | 5947.5 samples/s | 92.9 steps/s
[Step=8350 Epoch=78.7] | Loss=0.00712 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.253 | L2-Norm(final)=5.787 | 1958.2 samples/s | 30.6 steps/s
[Step=8400 Epoch=79.2] | Loss=0.00642 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.274 | L2-Norm(final)=5.826 | 5567.9 samples/s | 87.0 steps/s
[Step=8450 Epoch=79.6] | Loss=0.00592 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.288 | L2-Norm(final)=5.863 | 2021.9 samples/s | 31.6 steps/s
[Step=8500 Epoch=80.1] | Loss=0.00551 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.300 | L2-Norm(final)=5.899 | 5258.5 samples/s | 82.2 steps/s
All layers training...
LR=0.00100, len=1
[Step=8501 Epoch=80.1] | Loss=0.00270 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.421 | L2-Norm(final)=6.259 | 3951.3 samples/s | 61.7 steps/s
[Step=8550 Epoch=80.6] | Loss=0.01320 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.518 | L2-Norm(final)=6.260 | 4265.0 samples/s | 66.6 steps/s
[Step=8600 Epoch=81.0] | Loss=0.01641 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.695 | L2-Norm(final)=6.227 | 6295.0 samples/s | 98.4 steps/s
[Step=8650 Epoch=81.5] | Loss=0.01181 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.817 | L2-Norm(final)=6.207 | 1799.8 samples/s | 28.1 steps/s
[Step=8700 Epoch=82.0] | Loss=0.00909 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.870 | L2-Norm(final)=6.201 | 5722.6 samples/s | 89.4 steps/s
[Step=8750 Epoch=82.4] | Loss=0.00747 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.889 | L2-Norm(final)=6.199 | 1837.2 samples/s | 28.7 steps/s
[Step=8800 Epoch=82.9] | Loss=0.00623 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.889 | L2-Norm(final)=6.200 | 5287.3 samples/s | 82.6 steps/s
[Step=8850 Epoch=83.4] | Loss=0.00536 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.877 | L2-Norm(final)=6.201 | 1909.6 samples/s | 29.8 steps/s
[Step=8900 Epoch=83.9] | Loss=0.00470 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.857 | L2-Norm(final)=6.202 | 4912.4 samples/s | 76.8 steps/s
[Step=8950 Epoch=84.3] | Loss=0.00418 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.833 | L2-Norm(final)=6.203 | 1958.9 samples/s | 30.6 steps/s
[Step=9000 Epoch=84.8] | Loss=0.00376 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.805 | L2-Norm(final)=6.204 | 4720.3 samples/s | 73.8 steps/s
[Step=9050 Epoch=85.3] | Loss=0.00342 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.774 | L2-Norm(final)=6.206 | 1997.9 samples/s | 31.2 steps/s
[Step=9100 Epoch=85.7] | Loss=0.00314 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.742 | L2-Norm(final)=6.207 | 4736.1 samples/s | 74.0 steps/s
[Step=9150 Epoch=86.2] | Loss=0.00290 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.708 | L2-Norm(final)=6.208 | 2009.5 samples/s | 31.4 steps/s
[Step=9200 Epoch=86.7] | Loss=0.00269 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.674 | L2-Norm(final)=6.209 | 4675.4 samples/s | 73.1 steps/s
[Step=9250 Epoch=87.2] | Loss=0.00251 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.638 | L2-Norm(final)=6.211 | 2097.5 samples/s | 32.8 steps/s
[Step=9300 Epoch=87.6] | Loss=0.00236 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.603 | L2-Norm(final)=6.212 | 4406.8 samples/s | 68.9 steps/s
[Step=9350 Epoch=88.1] | Loss=0.00222 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.567 | L2-Norm(final)=6.213 | 6503.7 samples/s | 101.6 steps/s
[Step=9400 Epoch=88.6] | Loss=0.00210 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.530 | L2-Norm(final)=6.214 | 1810.2 samples/s | 28.3 steps/s
[Step=9450 Epoch=89.0] | Loss=0.00199 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.493 | L2-Norm(final)=6.215 | 5825.1 samples/s | 91.0 steps/s
[Step=9500 Epoch=89.5] | Loss=0.00189 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.456 | L2-Norm(final)=6.216 | 1837.0 samples/s | 28.7 steps/s
[Step=9550 Epoch=90.0] | Loss=0.00180 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.419 | L2-Norm(final)=6.217 | 5332.6 samples/s | 83.3 steps/s
[Step=9600 Epoch=90.5] | Loss=0.00172 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.382 | L2-Norm(final)=6.218 | 1904.6 samples/s | 29.8 steps/s
[Step=9650 Epoch=90.9] | Loss=0.00164 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.345 | L2-Norm(final)=6.219 | 4996.5 samples/s | 78.1 steps/s
[Step=9700 Epoch=91.4] | Loss=0.00157 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.308 | L2-Norm(final)=6.220 | 1984.1 samples/s | 31.0 steps/s
[Step=9750 Epoch=91.9] | Loss=0.00151 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.270 | L2-Norm(final)=6.221 | 4608.5 samples/s | 72.0 steps/s
[Step=9800 Epoch=92.3] | Loss=0.00145 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.233 | L2-Norm(final)=6.222 | 1999.7 samples/s | 31.2 steps/s
[Step=9850 Epoch=92.8] | Loss=0.00140 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.196 | L2-Norm(final)=6.223 | 4719.6 samples/s | 73.7 steps/s
[Step=9900 Epoch=93.3] | Loss=0.00135 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.158 | L2-Norm(final)=6.224 | 1994.2 samples/s | 31.2 steps/s
[Step=9950 Epoch=93.8] | Loss=0.00130 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.121 | L2-Norm(final)=6.225 | 4663.9 samples/s | 72.9 steps/s
[Step=10000 Epoch=94.2] | Loss=0.00126 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.083 | L2-Norm(final)=6.226 | 2025.8 samples/s | 31.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step10000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11842 | acc=0.9445 | tpr=0.9615 | fpr=0.0924 | 4294.3 samples/s | 16.8 steps/s
Avg test loss: 0.12554, Avg test acc: 0.94266, Avg tpr: 0.96124, Avg fpr: 0.09819, total FA: 766

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.12791 | acc=0.9343 | tpr=0.9411 | fpr=0.0805 | 4439.6 samples/s | 17.3 steps/s
Avg test loss: 0.13201, Avg test acc: 0.93281, Avg tpr: 0.93863, Avg fpr: 0.07999, total FA: 624

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.12886 | acc=0.9347 | tpr=0.9352 | fpr=0.0664 | 4344.3 samples/s | 17.0 steps/s
Avg test loss: 0.13578, Avg test acc: 0.93421, Avg tpr: 0.93484, Avg fpr: 0.06717, total FA: 524

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.13963 | acc=0.9348 | tpr=0.9359 | fpr=0.0674 | 4363.8 samples/s | 17.0 steps/s
Avg test loss: 0.14651, Avg test acc: 0.93181, Avg tpr: 0.93227, Avg fpr: 0.06922, total FA: 540

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.14019 | acc=0.9391 | tpr=0.9677 | fpr=0.1231 | 4406.3 samples/s | 17.2 steps/s
Avg test loss: 0.14487, Avg test acc: 0.93697, Avg tpr: 0.96538, Avg fpr: 0.12550, total FA: 979

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.23145 | acc=0.3180 | tpr=0.0079 | fpr=0.0087 | 4429.8 samples/s | 17.3 steps/s
Avg test loss: 4.24032, Avg test acc: 0.31481, Avg tpr: 0.00746, Avg fpr: 0.00923, total FA: 72

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.22583 | acc=0.3117 | tpr=0.0021 | fpr=0.0159 | 4338.7 samples/s | 16.9 steps/s
Avg test loss: 4.23372, Avg test acc: 0.30960, Avg tpr: 0.00204, Avg fpr: 0.01397, total FA: 109

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.08035 | acc=0.3084 | tpr=0.0035 | fpr=0.0297 | 4407.7 samples/s | 17.2 steps/s
Avg test loss: 4.09144, Avg test acc: 0.30639, Avg tpr: 0.00408, Avg fpr: 0.02871, total FA: 224

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.12600 | acc=0.3109 | tpr=0.0019 | fpr=0.0183 | 4368.2 samples/s | 17.1 steps/s
Avg test loss: 4.12681, Avg test acc: 0.30784, Avg tpr: 0.00192, Avg fpr: 0.01936, total FA: 151

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=3.67570 | acc=0.3145 | tpr=0.0007 | fpr=0.0042 | 4358.2 samples/s | 17.0 steps/s
Avg test loss: 3.67947, Avg test acc: 0.31176, Avg tpr: 0.00064, Avg fpr: 0.00397, total FA: 31

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.65533 | acc=0.1220 | tpr=0.6593 | fpr=0.8877 | 4355.7 samples/s | 17.0 steps/s
[Step= 100] | Loss=4.64680 | acc=0.1226 | tpr=0.6354 | fpr=0.8870 | 8828.2 samples/s | 34.5 steps/s
[Step= 150] | Loss=4.63969 | acc=0.1215 | tpr=0.6268 | fpr=0.8878 | 6289.0 samples/s | 24.6 steps/s
[Step= 200] | Loss=4.64519 | acc=0.1214 | tpr=0.6142 | fpr=0.8876 | 8432.3 samples/s | 32.9 steps/s
[Step= 250] | Loss=4.65159 | acc=0.1213 | tpr=0.6210 | fpr=0.8878 | 8962.8 samples/s | 35.0 steps/s
[Step= 300] | Loss=4.64951 | acc=0.1213 | tpr=0.6255 | fpr=0.8879 | 7666.3 samples/s | 29.9 steps/s
[Step= 350] | Loss=4.64796 | acc=0.1212 | tpr=0.6174 | fpr=0.8878 | 6700.2 samples/s | 26.2 steps/s
[Step= 400] | Loss=4.64952 | acc=0.1217 | tpr=0.6220 | fpr=0.8874 | 8623.3 samples/s | 33.7 steps/s
[Step= 450] | Loss=4.65376 | acc=0.1217 | tpr=0.6159 | fpr=0.8872 | 8587.6 samples/s | 33.5 steps/s
[Step= 500] | Loss=4.65787 | acc=0.1213 | tpr=0.6115 | fpr=0.8875 | 8721.8 samples/s | 34.1 steps/s
[Step= 550] | Loss=4.66105 | acc=0.1209 | tpr=0.6120 | fpr=0.8880 | 15059.8 samples/s | 58.8 steps/s
Avg test loss: 4.66153, Avg test acc: 0.12089, Avg tpr: 0.61173, Avg fpr: 0.88803, total FA: 123301

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.23327 | acc=0.1421 | tpr=0.6372 | fpr=0.8668 | 4369.6 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.19937 | acc=0.1438 | tpr=0.6055 | fpr=0.8648 | 5920.0 samples/s | 23.1 steps/s
[Step= 150] | Loss=4.20190 | acc=0.1430 | tpr=0.6037 | fpr=0.8655 | 8138.4 samples/s | 31.8 steps/s
[Step= 200] | Loss=4.20389 | acc=0.1429 | tpr=0.5978 | fpr=0.8653 | 8342.3 samples/s | 32.6 steps/s
[Step= 250] | Loss=4.20033 | acc=0.1431 | tpr=0.6148 | fpr=0.8655 | 8531.8 samples/s | 33.3 steps/s
[Step= 300] | Loss=4.19767 | acc=0.1437 | tpr=0.6182 | fpr=0.8649 | 7318.6 samples/s | 28.6 steps/s
[Step= 350] | Loss=4.19379 | acc=0.1433 | tpr=0.6093 | fpr=0.8651 | 8547.8 samples/s | 33.4 steps/s
[Step= 400] | Loss=4.19732 | acc=0.1436 | tpr=0.6089 | fpr=0.8649 | 8740.5 samples/s | 34.1 steps/s
[Step= 450] | Loss=4.19973 | acc=0.1438 | tpr=0.6100 | fpr=0.8647 | 8657.3 samples/s | 33.8 steps/s
[Step= 500] | Loss=4.20013 | acc=0.1430 | tpr=0.6062 | fpr=0.8654 | 8387.7 samples/s | 32.8 steps/s
[Step= 550] | Loss=4.20178 | acc=0.1433 | tpr=0.6112 | fpr=0.8652 | 15068.8 samples/s | 58.9 steps/s
Avg test loss: 4.20190, Avg test acc: 0.14322, Avg tpr: 0.61054, Avg fpr: 0.86528, total FA: 120142

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.09614 | acc=0.1595 | tpr=0.5885 | fpr=0.8483 | 4345.5 samples/s | 17.0 steps/s
[Step= 100] | Loss=5.05713 | acc=0.1579 | tpr=0.5394 | fpr=0.8493 | 5758.5 samples/s | 22.5 steps/s
[Step= 150] | Loss=5.06413 | acc=0.1565 | tpr=0.5418 | fpr=0.8506 | 8588.7 samples/s | 33.5 steps/s
[Step= 200] | Loss=5.07115 | acc=0.1553 | tpr=0.5322 | fpr=0.8516 | 8545.5 samples/s | 33.4 steps/s
[Step= 250] | Loss=5.07430 | acc=0.1556 | tpr=0.5310 | fpr=0.8512 | 8621.7 samples/s | 33.7 steps/s
[Step= 300] | Loss=5.07199 | acc=0.1554 | tpr=0.5331 | fpr=0.8515 | 7066.7 samples/s | 27.6 steps/s
[Step= 350] | Loss=5.06654 | acc=0.1553 | tpr=0.5235 | fpr=0.8514 | 8656.3 samples/s | 33.8 steps/s
[Step= 400] | Loss=5.06549 | acc=0.1553 | tpr=0.5181 | fpr=0.8513 | 8585.4 samples/s | 33.5 steps/s
[Step= 450] | Loss=5.06748 | acc=0.1551 | tpr=0.5093 | fpr=0.8513 | 8498.8 samples/s | 33.2 steps/s
[Step= 500] | Loss=5.06750 | acc=0.1550 | tpr=0.5044 | fpr=0.8513 | 8556.4 samples/s | 33.4 steps/s
[Step= 550] | Loss=5.07116 | acc=0.1546 | tpr=0.5038 | fpr=0.8518 | 15198.8 samples/s | 59.4 steps/s
Avg test loss: 5.07278, Avg test acc: 0.15448, Avg tpr: 0.50436, Avg fpr: 0.85188, total FA: 118282

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.28787 | acc=0.1722 | tpr=0.5664 | fpr=0.8349 | 4386.6 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.26021 | acc=0.1717 | tpr=0.5565 | fpr=0.8355 | 5950.9 samples/s | 23.2 steps/s
[Step= 150] | Loss=4.25884 | acc=0.1714 | tpr=0.5576 | fpr=0.8357 | 8564.7 samples/s | 33.5 steps/s
[Step= 200] | Loss=4.25417 | acc=0.1710 | tpr=0.5486 | fpr=0.8358 | 8691.4 samples/s | 34.0 steps/s
[Step= 250] | Loss=4.25814 | acc=0.1718 | tpr=0.5502 | fpr=0.8351 | 8283.7 samples/s | 32.4 steps/s
[Step= 300] | Loss=4.25706 | acc=0.1714 | tpr=0.5571 | fpr=0.8357 | 6610.6 samples/s | 25.8 steps/s
[Step= 350] | Loss=4.25467 | acc=0.1714 | tpr=0.5554 | fpr=0.8356 | 8761.8 samples/s | 34.2 steps/s
[Step= 400] | Loss=4.25780 | acc=0.1711 | tpr=0.5438 | fpr=0.8357 | 8575.2 samples/s | 33.5 steps/s
[Step= 450] | Loss=4.26166 | acc=0.1713 | tpr=0.5463 | fpr=0.8355 | 8427.4 samples/s | 32.9 steps/s
[Step= 500] | Loss=4.26241 | acc=0.1707 | tpr=0.5414 | fpr=0.8360 | 8608.0 samples/s | 33.6 steps/s
[Step= 550] | Loss=4.26358 | acc=0.1706 | tpr=0.5404 | fpr=0.8362 | 14734.5 samples/s | 57.6 steps/s
Avg test loss: 4.26415, Avg test acc: 0.17052, Avg tpr: 0.54081, Avg fpr: 0.83621, total FA: 116106

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.57272 | acc=0.1052 | tpr=0.7478 | fpr=0.9064 | 4228.7 samples/s | 16.5 steps/s
[Step= 100] | Loss=5.55778 | acc=0.1057 | tpr=0.7207 | fpr=0.9058 | 6737.7 samples/s | 26.3 steps/s
[Step= 150] | Loss=5.56514 | acc=0.1049 | tpr=0.7233 | fpr=0.9065 | 8434.2 samples/s | 32.9 steps/s
[Step= 200] | Loss=5.55862 | acc=0.1043 | tpr=0.7301 | fpr=0.9071 | 8929.9 samples/s | 34.9 steps/s
[Step= 250] | Loss=5.56061 | acc=0.1045 | tpr=0.7214 | fpr=0.9067 | 6207.9 samples/s | 24.2 steps/s
[Step= 300] | Loss=5.55757 | acc=0.1042 | tpr=0.7193 | fpr=0.9070 | 8442.1 samples/s | 33.0 steps/s
[Step= 350] | Loss=5.55149 | acc=0.1040 | tpr=0.7188 | fpr=0.9072 | 8684.9 samples/s | 33.9 steps/s
[Step= 400] | Loss=5.54968 | acc=0.1041 | tpr=0.7205 | fpr=0.9071 | 8629.5 samples/s | 33.7 steps/s
[Step= 450] | Loss=5.55022 | acc=0.1041 | tpr=0.7079 | fpr=0.9069 | 8525.4 samples/s | 33.3 steps/s
[Step= 500] | Loss=5.55120 | acc=0.1039 | tpr=0.7044 | fpr=0.9070 | 8230.5 samples/s | 32.2 steps/s
[Step= 550] | Loss=5.55420 | acc=0.1037 | tpr=0.7079 | fpr=0.9073 | 16286.8 samples/s | 63.6 steps/s
Avg test loss: 5.55495, Avg test acc: 0.10361, Avg tpr: 0.70840, Avg fpr: 0.90738, total FA: 125988

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10025 | acc=0.9799 | tpr=0.8717 | fpr=0.0181 | 3503.7 samples/s | 13.7 steps/s
[Step= 100] | Loss=0.10363 | acc=0.9801 | tpr=0.9041 | fpr=0.0185 | 9161.6 samples/s | 35.8 steps/s
[Step= 150] | Loss=0.10715 | acc=0.9793 | tpr=0.9049 | fpr=0.0193 | 8455.5 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.10929 | acc=0.9794 | tpr=0.9115 | fpr=0.0193 | 8110.8 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.10773 | acc=0.9793 | tpr=0.9100 | fpr=0.0195 | 7084.8 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.10909 | acc=0.9792 | tpr=0.9098 | fpr=0.0196 | 8677.1 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.10910 | acc=0.9790 | tpr=0.9105 | fpr=0.0197 | 8658.1 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.11047 | acc=0.9788 | tpr=0.9026 | fpr=0.0198 | 8073.1 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.11261 | acc=0.9785 | tpr=0.9031 | fpr=0.0201 | 8748.2 samples/s | 34.2 steps/s
[Step= 500] | Loss=0.11181 | acc=0.9787 | tpr=0.9031 | fpr=0.0200 | 8537.5 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.11072 | acc=0.9788 | tpr=0.9053 | fpr=0.0198 | 15064.7 samples/s | 58.8 steps/s
Avg test loss: 0.11057, Avg test acc: 0.97885, Avg tpr: 0.90491, Avg fpr: 0.01981, total FA: 2750

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10875 | acc=0.9818 | tpr=0.8717 | fpr=0.0162 | 4121.1 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.11622 | acc=0.9814 | tpr=0.8891 | fpr=0.0169 | 8600.2 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.11950 | acc=0.9808 | tpr=0.8948 | fpr=0.0176 | 8570.9 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.12145 | acc=0.9808 | tpr=0.8929 | fpr=0.0176 | 8437.1 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.12075 | acc=0.9808 | tpr=0.8891 | fpr=0.0175 | 5481.0 samples/s | 21.4 steps/s
[Step= 300] | Loss=0.12256 | acc=0.9806 | tpr=0.8887 | fpr=0.0177 | 8605.7 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.12296 | acc=0.9804 | tpr=0.8917 | fpr=0.0180 | 8587.1 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.12472 | acc=0.9801 | tpr=0.8862 | fpr=0.0182 | 8657.3 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.12810 | acc=0.9798 | tpr=0.8851 | fpr=0.0184 | 8985.3 samples/s | 35.1 steps/s
[Step= 500] | Loss=0.12742 | acc=0.9799 | tpr=0.8872 | fpr=0.0184 | 8020.5 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.12690 | acc=0.9800 | tpr=0.8862 | fpr=0.0183 | 15901.5 samples/s | 62.1 steps/s
Avg test loss: 0.12673, Avg test acc: 0.97999, Avg tpr: 0.88550, Avg fpr: 0.01829, total FA: 2540

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.09795 | acc=0.9781 | tpr=0.9071 | fpr=0.0206 | 4347.3 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.09977 | acc=0.9784 | tpr=0.9147 | fpr=0.0204 | 8509.1 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.10250 | acc=0.9776 | tpr=0.9107 | fpr=0.0212 | 8609.2 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.10425 | acc=0.9775 | tpr=0.9169 | fpr=0.0214 | 5065.1 samples/s | 19.8 steps/s
[Step= 250] | Loss=0.10321 | acc=0.9774 | tpr=0.9170 | fpr=0.0215 | 8677.4 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.10533 | acc=0.9771 | tpr=0.9135 | fpr=0.0217 | 8209.3 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.10598 | acc=0.9769 | tpr=0.9136 | fpr=0.0219 | 8531.5 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.10730 | acc=0.9768 | tpr=0.9114 | fpr=0.0220 | 8424.9 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.10918 | acc=0.9766 | tpr=0.9104 | fpr=0.0222 | 8762.2 samples/s | 34.2 steps/s
[Step= 500] | Loss=0.10914 | acc=0.9767 | tpr=0.9132 | fpr=0.0222 | 8337.8 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.10837 | acc=0.9768 | tpr=0.9133 | fpr=0.0221 | 15258.5 samples/s | 59.6 steps/s
Avg test loss: 0.10814, Avg test acc: 0.97678, Avg tpr: 0.91323, Avg fpr: 0.02207, total FA: 3064

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09002 | acc=0.9823 | tpr=0.8805 | fpr=0.0159 | 4330.7 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.09197 | acc=0.9818 | tpr=0.8891 | fpr=0.0164 | 8880.6 samples/s | 34.7 steps/s
[Step= 150] | Loss=0.09458 | acc=0.9812 | tpr=0.8948 | fpr=0.0172 | 8567.3 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.09612 | acc=0.9811 | tpr=0.8973 | fpr=0.0174 | 4998.0 samples/s | 19.5 steps/s
[Step= 250] | Loss=0.09520 | acc=0.9813 | tpr=0.8934 | fpr=0.0171 | 8281.1 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.09702 | acc=0.9810 | tpr=0.8931 | fpr=0.0174 | 8640.9 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.09685 | acc=0.9810 | tpr=0.8973 | fpr=0.0175 | 8556.3 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.09824 | acc=0.9808 | tpr=0.8917 | fpr=0.0176 | 8787.4 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.10016 | acc=0.9805 | tpr=0.8900 | fpr=0.0179 | 8731.7 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.09961 | acc=0.9806 | tpr=0.8916 | fpr=0.0178 | 8413.5 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.09873 | acc=0.9807 | tpr=0.8898 | fpr=0.0177 | 14593.6 samples/s | 57.0 steps/s
Avg test loss: 0.09860, Avg test acc: 0.98070, Avg tpr: 0.88906, Avg fpr: 0.01764, total FA: 2449

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10533 | acc=0.9798 | tpr=0.8628 | fpr=0.0181 | 4329.3 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.10905 | acc=0.9797 | tpr=0.8870 | fpr=0.0185 | 8550.9 samples/s | 33.4 steps/s
[Step= 150] | Loss=0.11226 | acc=0.9790 | tpr=0.8948 | fpr=0.0195 | 8904.1 samples/s | 34.8 steps/s
[Step= 200] | Loss=0.11537 | acc=0.9787 | tpr=0.8929 | fpr=0.0198 | 4904.9 samples/s | 19.2 steps/s
[Step= 250] | Loss=0.11344 | acc=0.9788 | tpr=0.8900 | fpr=0.0196 | 8514.0 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.11565 | acc=0.9784 | tpr=0.8880 | fpr=0.0200 | 8636.0 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.11675 | acc=0.9783 | tpr=0.8898 | fpr=0.0201 | 8587.3 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.11755 | acc=0.9781 | tpr=0.8840 | fpr=0.0202 | 8571.0 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.11958 | acc=0.9779 | tpr=0.8822 | fpr=0.0204 | 8714.1 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.11876 | acc=0.9780 | tpr=0.8833 | fpr=0.0203 | 8341.6 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.11800 | acc=0.9781 | tpr=0.8834 | fpr=0.0202 | 15505.4 samples/s | 60.6 steps/s
Avg test loss: 0.11776, Avg test acc: 0.97809, Avg tpr: 0.88273, Avg fpr: 0.02018, total FA: 2802

server round 10/50

clients selected: [0 2 5 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=12001 Epoch=58.5] | Loss=0.09014 | Reg=0.00212 | acc=0.9531 | L2-Norm=14.573 | L2-Norm(final)=6.528 | 4082.9 samples/s | 63.8 steps/s
[Step=12050 Epoch=58.8] | Loss=0.07727 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.627 | L2-Norm(final)=6.538 | 4978.5 samples/s | 77.8 steps/s
[Step=12100 Epoch=59.0] | Loss=0.07417 | Reg=0.00216 | acc=0.9219 | L2-Norm=14.697 | L2-Norm(final)=6.564 | 5576.3 samples/s | 87.1 steps/s
[Step=12150 Epoch=59.2] | Loss=0.07164 | Reg=0.00218 | acc=0.9375 | L2-Norm=14.763 | L2-Norm(final)=6.594 | 5462.1 samples/s | 85.3 steps/s
[Step=12200 Epoch=59.5] | Loss=0.07198 | Reg=0.00220 | acc=0.9531 | L2-Norm=14.825 | L2-Norm(final)=6.622 | 7786.7 samples/s | 121.7 steps/s
[Step=12250 Epoch=59.7] | Loss=0.06868 | Reg=0.00222 | acc=0.9375 | L2-Norm=14.884 | L2-Norm(final)=6.646 | 1932.3 samples/s | 30.2 steps/s
[Step=12300 Epoch=60.0] | Loss=0.06781 | Reg=0.00223 | acc=0.9375 | L2-Norm=14.942 | L2-Norm(final)=6.675 | 5572.6 samples/s | 87.1 steps/s
[Step=12350 Epoch=60.2] | Loss=0.06697 | Reg=0.00225 | acc=0.9531 | L2-Norm=14.998 | L2-Norm(final)=6.702 | 5279.7 samples/s | 82.5 steps/s
[Step=12400 Epoch=60.5] | Loss=0.06623 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.054 | L2-Norm(final)=6.728 | 7040.5 samples/s | 110.0 steps/s
[Step=12450 Epoch=60.7] | Loss=0.06511 | Reg=0.00228 | acc=0.9688 | L2-Norm=15.109 | L2-Norm(final)=6.754 | 1964.8 samples/s | 30.7 steps/s
[Step=12500 Epoch=61.0] | Loss=0.06427 | Reg=0.00230 | acc=0.9219 | L2-Norm=15.164 | L2-Norm(final)=6.781 | 5487.0 samples/s | 85.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=61.0] | Loss=0.02787 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.709 | L2-Norm(final)=7.061 | 4010.8 samples/s | 62.7 steps/s
[Step=12550 Epoch=61.2] | Loss=0.05386 | Reg=0.00248 | acc=0.9531 | L2-Norm=15.753 | L2-Norm(final)=7.083 | 4516.9 samples/s | 70.6 steps/s
[Step=12600 Epoch=61.4] | Loss=0.04919 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.782 | L2-Norm(final)=7.084 | 4904.5 samples/s | 76.6 steps/s
[Step=12650 Epoch=61.7] | Loss=0.04600 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.805 | L2-Norm(final)=7.083 | 5036.3 samples/s | 78.7 steps/s
[Step=12700 Epoch=61.9] | Loss=0.04336 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.825 | L2-Norm(final)=7.082 | 6492.5 samples/s | 101.4 steps/s
[Step=12750 Epoch=62.2] | Loss=0.03891 | Reg=0.00251 | acc=0.9375 | L2-Norm=15.843 | L2-Norm(final)=7.084 | 1841.3 samples/s | 28.8 steps/s
[Step=12800 Epoch=62.4] | Loss=0.03545 | Reg=0.00251 | acc=0.9844 | L2-Norm=15.857 | L2-Norm(final)=7.088 | 4901.9 samples/s | 76.6 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03263 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.869 | L2-Norm(final)=7.092 | 4915.5 samples/s | 76.8 steps/s
[Step=12900 Epoch=62.9] | Loss=0.03101 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.880 | L2-Norm(final)=7.098 | 6115.9 samples/s | 95.6 steps/s
[Step=12950 Epoch=63.1] | Loss=0.02863 | Reg=0.00253 | acc=0.9688 | L2-Norm=15.891 | L2-Norm(final)=7.102 | 1896.3 samples/s | 29.6 steps/s
[Step=13000 Epoch=63.4] | Loss=0.02663 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.900 | L2-Norm(final)=7.108 | 4924.6 samples/s | 76.9 steps/s
[Step=13050 Epoch=63.6] | Loss=0.02517 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.907 | L2-Norm(final)=7.113 | 4754.4 samples/s | 74.3 steps/s
[Step=13100 Epoch=63.9] | Loss=0.02434 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.913 | L2-Norm(final)=7.118 | 5575.5 samples/s | 87.1 steps/s
[Step=13150 Epoch=64.1] | Loss=0.02330 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.919 | L2-Norm(final)=7.121 | 1964.9 samples/s | 30.7 steps/s
[Step=13200 Epoch=64.4] | Loss=0.02253 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.923 | L2-Norm(final)=7.125 | 4850.6 samples/s | 75.8 steps/s
[Step=13250 Epoch=64.6] | Loss=0.02154 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.927 | L2-Norm(final)=7.129 | 4802.5 samples/s | 75.0 steps/s
[Step=13300 Epoch=64.9] | Loss=0.02087 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.931 | L2-Norm(final)=7.133 | 5347.5 samples/s | 83.6 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01998 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.933 | L2-Norm(final)=7.136 | 1981.8 samples/s | 31.0 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01932 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.936 | L2-Norm(final)=7.140 | 4864.9 samples/s | 76.0 steps/s
[Step=13450 Epoch=65.6] | Loss=0.01859 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.938 | L2-Norm(final)=7.144 | 4842.1 samples/s | 75.7 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01814 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.939 | L2-Norm(final)=7.148 | 4925.2 samples/s | 77.0 steps/s
[Step=13550 Epoch=66.1] | Loss=0.01756 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.940 | L2-Norm(final)=7.151 | 2011.2 samples/s | 31.4 steps/s
[Step=13600 Epoch=66.3] | Loss=0.01708 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.941 | L2-Norm(final)=7.155 | 5022.5 samples/s | 78.5 steps/s
[Step=13650 Epoch=66.6] | Loss=0.01652 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.940 | L2-Norm(final)=7.158 | 4979.1 samples/s | 77.8 steps/s
[Step=13700 Epoch=66.8] | Loss=0.01618 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.940 | L2-Norm(final)=7.161 | 4825.3 samples/s | 75.4 steps/s
[Step=13750 Epoch=67.0] | Loss=0.01577 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.939 | L2-Norm(final)=7.164 | 2058.6 samples/s | 32.2 steps/s
[Step=13800 Epoch=67.3] | Loss=0.01539 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.938 | L2-Norm(final)=7.167 | 4895.6 samples/s | 76.5 steps/s
[Step=13850 Epoch=67.5] | Loss=0.01502 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.937 | L2-Norm(final)=7.170 | 4822.4 samples/s | 75.3 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01468 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.935 | L2-Norm(final)=7.173 | 4904.3 samples/s | 76.6 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01446 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.934 | L2-Norm(final)=7.176 | 1406.5 samples/s | 22.0 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01432 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.934 | L2-Norm(final)=7.179 | 4633.5 samples/s | 72.4 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step14000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=14001 Epoch=68.2] | Loss=0.07101 | Reg=0.00212 | acc=0.9219 | L2-Norm=14.573 | L2-Norm(final)=7.762 | 4049.4 samples/s | 63.3 steps/s
[Step=14050 Epoch=68.5] | Loss=0.07845 | Reg=0.00214 | acc=0.9375 | L2-Norm=14.632 | L2-Norm(final)=7.760 | 5308.1 samples/s | 82.9 steps/s
[Step=14100 Epoch=68.7] | Loss=0.07367 | Reg=0.00216 | acc=0.9219 | L2-Norm=14.705 | L2-Norm(final)=7.790 | 5439.4 samples/s | 85.0 steps/s
[Step=14150 Epoch=68.9] | Loss=0.07345 | Reg=0.00218 | acc=0.9531 | L2-Norm=14.769 | L2-Norm(final)=7.816 | 5577.2 samples/s | 87.1 steps/s
[Step=14200 Epoch=69.2] | Loss=0.07286 | Reg=0.00220 | acc=0.9375 | L2-Norm=14.829 | L2-Norm(final)=7.842 | 7614.6 samples/s | 119.0 steps/s
[Step=14250 Epoch=69.4] | Loss=0.07095 | Reg=0.00222 | acc=0.9531 | L2-Norm=14.889 | L2-Norm(final)=7.867 | 1922.0 samples/s | 30.0 steps/s
[Step=14300 Epoch=69.7] | Loss=0.06810 | Reg=0.00224 | acc=0.9219 | L2-Norm=14.949 | L2-Norm(final)=7.894 | 5561.0 samples/s | 86.9 steps/s
[Step=14350 Epoch=69.9] | Loss=0.06752 | Reg=0.00225 | acc=0.9531 | L2-Norm=15.007 | L2-Norm(final)=7.923 | 5517.1 samples/s | 86.2 steps/s
[Step=14400 Epoch=70.2] | Loss=0.06724 | Reg=0.00227 | acc=0.9375 | L2-Norm=15.063 | L2-Norm(final)=7.950 | 7049.1 samples/s | 110.1 steps/s
[Step=14450 Epoch=70.4] | Loss=0.06591 | Reg=0.00229 | acc=0.9219 | L2-Norm=15.120 | L2-Norm(final)=7.978 | 1982.6 samples/s | 31.0 steps/s
[Step=14500 Epoch=70.7] | Loss=0.06512 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.178 | L2-Norm(final)=8.008 | 5604.7 samples/s | 87.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=70.7] | Loss=0.06920 | Reg=0.00248 | acc=0.9375 | L2-Norm=15.754 | L2-Norm(final)=8.313 | 4047.8 samples/s | 63.2 steps/s
[Step=14550 Epoch=70.9] | Loss=0.04652 | Reg=0.00250 | acc=0.9688 | L2-Norm=15.800 | L2-Norm(final)=8.344 | 4650.6 samples/s | 72.7 steps/s
[Step=14600 Epoch=71.1] | Loss=0.04760 | Reg=0.00250 | acc=0.9531 | L2-Norm=15.827 | L2-Norm(final)=8.346 | 4864.9 samples/s | 76.0 steps/s
[Step=14650 Epoch=71.4] | Loss=0.04783 | Reg=0.00251 | acc=0.9844 | L2-Norm=15.851 | L2-Norm(final)=8.339 | 4881.8 samples/s | 76.3 steps/s
[Step=14700 Epoch=71.6] | Loss=0.04501 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.871 | L2-Norm(final)=8.336 | 6596.3 samples/s | 103.1 steps/s
[Step=14750 Epoch=71.9] | Loss=0.03994 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.889 | L2-Norm(final)=8.339 | 1862.3 samples/s | 29.1 steps/s
[Step=14800 Epoch=72.1] | Loss=0.03622 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.905 | L2-Norm(final)=8.343 | 4874.7 samples/s | 76.2 steps/s
[Step=14850 Epoch=72.4] | Loss=0.03363 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.919 | L2-Norm(final)=8.349 | 4887.4 samples/s | 76.4 steps/s
[Step=14900 Epoch=72.6] | Loss=0.03130 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.931 | L2-Norm(final)=8.355 | 6008.9 samples/s | 93.9 steps/s
[Step=14950 Epoch=72.8] | Loss=0.02914 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.942 | L2-Norm(final)=8.360 | 1909.8 samples/s | 29.8 steps/s
[Step=15000 Epoch=73.1] | Loss=0.02727 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.952 | L2-Norm(final)=8.366 | 4885.5 samples/s | 76.3 steps/s
[Step=15050 Epoch=73.3] | Loss=0.02611 | Reg=0.00255 | acc=0.9844 | L2-Norm=15.962 | L2-Norm(final)=8.371 | 4897.5 samples/s | 76.5 steps/s
[Step=15100 Epoch=73.6] | Loss=0.02509 | Reg=0.00255 | acc=0.9688 | L2-Norm=15.971 | L2-Norm(final)=8.375 | 5706.0 samples/s | 89.2 steps/s
[Step=15150 Epoch=73.8] | Loss=0.02416 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.979 | L2-Norm(final)=8.378 | 1940.9 samples/s | 30.3 steps/s
[Step=15200 Epoch=74.1] | Loss=0.02301 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.986 | L2-Norm(final)=8.382 | 4742.8 samples/s | 74.1 steps/s
[Step=15250 Epoch=74.3] | Loss=0.02199 | Reg=0.00256 | acc=0.9844 | L2-Norm=15.993 | L2-Norm(final)=8.385 | 4813.4 samples/s | 75.2 steps/s
[Step=15300 Epoch=74.5] | Loss=0.02118 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.998 | L2-Norm(final)=8.389 | 5254.1 samples/s | 82.1 steps/s
[Step=15350 Epoch=74.8] | Loss=0.02043 | Reg=0.00256 | acc=0.9844 | L2-Norm=16.003 | L2-Norm(final)=8.393 | 2003.8 samples/s | 31.3 steps/s
[Step=15400 Epoch=75.0] | Loss=0.01977 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.007 | L2-Norm(final)=8.397 | 4858.6 samples/s | 75.9 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01908 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.011 | L2-Norm(final)=8.400 | 4818.2 samples/s | 75.3 steps/s
[Step=15500 Epoch=75.5] | Loss=0.01850 | Reg=0.00256 | acc=0.9688 | L2-Norm=16.013 | L2-Norm(final)=8.403 | 4927.5 samples/s | 77.0 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01802 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.015 | L2-Norm(final)=8.406 | 2019.0 samples/s | 31.5 steps/s
[Step=15600 Epoch=76.0] | Loss=0.01752 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.017 | L2-Norm(final)=8.409 | 4933.4 samples/s | 77.1 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01705 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.018 | L2-Norm(final)=8.412 | 4888.1 samples/s | 76.4 steps/s
[Step=15700 Epoch=76.5] | Loss=0.01658 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.018 | L2-Norm(final)=8.415 | 4846.2 samples/s | 75.7 steps/s
[Step=15750 Epoch=76.7] | Loss=0.01613 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.018 | L2-Norm(final)=8.417 | 2026.5 samples/s | 31.7 steps/s
[Step=15800 Epoch=77.0] | Loss=0.01565 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.018 | L2-Norm(final)=8.420 | 4970.3 samples/s | 77.7 steps/s
[Step=15850 Epoch=77.2] | Loss=0.01526 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.018 | L2-Norm(final)=8.423 | 4914.2 samples/s | 76.8 steps/s
[Step=15900 Epoch=77.5] | Loss=0.01493 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.017 | L2-Norm(final)=8.426 | 4934.5 samples/s | 77.1 steps/s
[Step=15950 Epoch=77.7] | Loss=0.01466 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.016 | L2-Norm(final)=8.429 | 2084.6 samples/s | 32.6 steps/s
[Step=16000 Epoch=78.0] | Loss=0.01433 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.015 | L2-Norm(final)=8.431 | 4817.2 samples/s | 75.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step16000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=4001 Epoch=37.9] | Loss=0.07239 | Reg=0.00212 | acc=0.9062 | L2-Norm=14.573 | L2-Norm(final)=4.018 | 3755.9 samples/s | 58.7 steps/s
[Step=4050 Epoch=38.4] | Loss=0.02475 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.758 | L2-Norm(final)=4.055 | 4795.2 samples/s | 74.9 steps/s
[Step=4100 Epoch=38.9] | Loss=0.01706 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.867 | L2-Norm(final)=4.095 | 7427.2 samples/s | 116.1 steps/s
[Step=4150 Epoch=39.3] | Loss=0.01388 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.944 | L2-Norm(final)=4.132 | 1869.9 samples/s | 29.2 steps/s
[Step=4200 Epoch=39.8] | Loss=0.01202 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.007 | L2-Norm(final)=4.166 | 6810.3 samples/s | 106.4 steps/s
[Step=4250 Epoch=40.3] | Loss=0.01043 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.060 | L2-Norm(final)=4.198 | 1897.5 samples/s | 29.6 steps/s
[Step=4300 Epoch=40.7] | Loss=0.00956 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.106 | L2-Norm(final)=4.226 | 5984.0 samples/s | 93.5 steps/s
[Step=4350 Epoch=41.2] | Loss=0.00878 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.147 | L2-Norm(final)=4.253 | 1933.8 samples/s | 30.2 steps/s
[Step=4400 Epoch=41.7] | Loss=0.00828 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.183 | L2-Norm(final)=4.279 | 5759.1 samples/s | 90.0 steps/s
[Step=4450 Epoch=42.2] | Loss=0.00762 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.218 | L2-Norm(final)=4.304 | 1986.1 samples/s | 31.0 steps/s
[Step=4500 Epoch=42.6] | Loss=0.00721 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.249 | L2-Norm(final)=4.328 | 5410.9 samples/s | 84.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=4501 Epoch=42.7] | Loss=0.00239 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.554 | L2-Norm(final)=4.570 | 3867.3 samples/s | 60.4 steps/s
[Step=4550 Epoch=43.1] | Loss=0.00370 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.570 | L2-Norm(final)=4.586 | 4327.5 samples/s | 67.6 steps/s
[Step=4600 Epoch=43.6] | Loss=0.00275 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.575 | L2-Norm(final)=4.595 | 6240.6 samples/s | 97.5 steps/s
[Step=4650 Epoch=44.1] | Loss=0.00205 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.573 | L2-Norm(final)=4.603 | 1801.5 samples/s | 28.1 steps/s
[Step=4700 Epoch=44.5] | Loss=0.00156 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.558 | L2-Norm(final)=4.608 | 5815.9 samples/s | 90.9 steps/s
[Step=4750 Epoch=45.0] | Loss=0.00126 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.538 | L2-Norm(final)=4.612 | 1848.1 samples/s | 28.9 steps/s
[Step=4800 Epoch=45.5] | Loss=0.00105 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.515 | L2-Norm(final)=4.615 | 5483.8 samples/s | 85.7 steps/s
[Step=4850 Epoch=46.0] | Loss=0.00091 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.490 | L2-Norm(final)=4.618 | 1877.2 samples/s | 29.3 steps/s
[Step=4900 Epoch=46.4] | Loss=0.00080 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.464 | L2-Norm(final)=4.620 | 5082.5 samples/s | 79.4 steps/s
[Step=4950 Epoch=46.9] | Loss=0.00071 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.438 | L2-Norm(final)=4.621 | 1918.7 samples/s | 30.0 steps/s
[Step=5000 Epoch=47.4] | Loss=0.00064 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.411 | L2-Norm(final)=4.623 | 4812.5 samples/s | 75.2 steps/s
[Step=5050 Epoch=47.9] | Loss=0.00058 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.385 | L2-Norm(final)=4.624 | 1971.5 samples/s | 30.8 steps/s
[Step=5100 Epoch=48.3] | Loss=0.00054 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.358 | L2-Norm(final)=4.626 | 4629.6 samples/s | 72.3 steps/s
[Step=5150 Epoch=48.8] | Loss=0.00050 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.331 | L2-Norm(final)=4.627 | 1992.1 samples/s | 31.1 steps/s
[Step=5200 Epoch=49.3] | Loss=0.00046 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.304 | L2-Norm(final)=4.628 | 4819.9 samples/s | 75.3 steps/s
[Step=5250 Epoch=49.7] | Loss=0.00043 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.277 | L2-Norm(final)=4.629 | 2004.2 samples/s | 31.3 steps/s
[Step=5300 Epoch=50.2] | Loss=0.00041 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.250 | L2-Norm(final)=4.630 | 4622.8 samples/s | 72.2 steps/s
[Step=5350 Epoch=50.7] | Loss=0.00038 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.223 | L2-Norm(final)=4.631 | 2038.6 samples/s | 31.9 steps/s
[Step=5400 Epoch=51.2] | Loss=0.00036 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.196 | L2-Norm(final)=4.632 | 4402.7 samples/s | 68.8 steps/s
[Step=5450 Epoch=51.6] | Loss=0.00034 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.169 | L2-Norm(final)=4.633 | 6370.9 samples/s | 99.5 steps/s
[Step=5500 Epoch=52.1] | Loss=0.00033 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.142 | L2-Norm(final)=4.634 | 1771.4 samples/s | 27.7 steps/s
[Step=5550 Epoch=52.6] | Loss=0.00031 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.115 | L2-Norm(final)=4.634 | 6012.9 samples/s | 94.0 steps/s
[Step=5600 Epoch=53.1] | Loss=0.00030 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.088 | L2-Norm(final)=4.635 | 1837.2 samples/s | 28.7 steps/s
[Step=5650 Epoch=53.5] | Loss=0.00029 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.061 | L2-Norm(final)=4.636 | 5622.4 samples/s | 87.9 steps/s
[Step=5700 Epoch=54.0] | Loss=0.00027 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.034 | L2-Norm(final)=4.637 | 1883.7 samples/s | 29.4 steps/s
[Step=5750 Epoch=54.5] | Loss=0.00026 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.007 | L2-Norm(final)=4.637 | 5197.3 samples/s | 81.2 steps/s
[Step=5800 Epoch=55.0] | Loss=0.00025 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.980 | L2-Norm(final)=4.638 | 1909.7 samples/s | 29.8 steps/s
[Step=5850 Epoch=55.4] | Loss=0.00025 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.953 | L2-Norm(final)=4.639 | 4925.4 samples/s | 77.0 steps/s
[Step=5900 Epoch=55.9] | Loss=0.00024 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.927 | L2-Norm(final)=4.640 | 1952.0 samples/s | 30.5 steps/s
[Step=5950 Epoch=56.4] | Loss=0.00023 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.900 | L2-Norm(final)=4.640 | 4864.5 samples/s | 76.0 steps/s
[Step=6000 Epoch=56.9] | Loss=0.00022 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.873 | L2-Norm(final)=4.641 | 1942.5 samples/s | 30.4 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_0/client_state-step6000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=10001 Epoch=95.5] | Loss=0.04622 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.573 | L2-Norm(final)=5.634 | 3958.5 samples/s | 61.9 steps/s
[Step=10050 Epoch=96.0] | Loss=0.01584 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.758 | L2-Norm(final)=5.621 | 5077.2 samples/s | 79.3 steps/s
[Step=10100 Epoch=96.4] | Loss=0.01134 | Reg=0.00220 | acc=0.9688 | L2-Norm=14.842 | L2-Norm(final)=5.657 | 7458.2 samples/s | 116.5 steps/s
[Step=10150 Epoch=96.9] | Loss=0.00861 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.914 | L2-Norm(final)=5.695 | 1823.8 samples/s | 28.5 steps/s
[Step=10200 Epoch=97.4] | Loss=0.00693 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.962 | L2-Norm(final)=5.731 | 7010.6 samples/s | 109.5 steps/s
[Step=10250 Epoch=97.9] | Loss=0.00591 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.997 | L2-Norm(final)=5.764 | 1860.1 samples/s | 29.1 steps/s
[Step=10300 Epoch=98.4] | Loss=0.00516 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.024 | L2-Norm(final)=5.795 | 6374.5 samples/s | 99.6 steps/s
[Step=10350 Epoch=98.8] | Loss=0.00455 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.044 | L2-Norm(final)=5.824 | 1884.6 samples/s | 29.4 steps/s
[Step=10400 Epoch=99.3] | Loss=0.00410 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.060 | L2-Norm(final)=5.852 | 6086.4 samples/s | 95.1 steps/s
[Step=10450 Epoch=99.8] | Loss=0.00373 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.070 | L2-Norm(final)=5.878 | 1956.5 samples/s | 30.6 steps/s
[Step=10500 Epoch=100.3] | Loss=0.00342 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.077 | L2-Norm(final)=5.902 | 5688.8 samples/s | 88.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=100.3] | Loss=0.00075 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.124 | L2-Norm(final)=6.139 | 3547.3 samples/s | 55.4 steps/s
[Step=10550 Epoch=100.7] | Loss=0.00046 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.107 | L2-Norm(final)=6.153 | 4862.9 samples/s | 76.0 steps/s
[Step=10600 Epoch=101.2] | Loss=0.00032 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.083 | L2-Norm(final)=6.164 | 6481.2 samples/s | 101.3 steps/s
[Step=10650 Epoch=101.7] | Loss=0.00023 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.051 | L2-Norm(final)=6.171 | 1797.9 samples/s | 28.1 steps/s
[Step=10700 Epoch=102.2] | Loss=0.00018 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.016 | L2-Norm(final)=6.176 | 5987.5 samples/s | 93.6 steps/s
[Step=10750 Epoch=102.7] | Loss=0.00015 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.979 | L2-Norm(final)=6.179 | 1817.5 samples/s | 28.4 steps/s
[Step=10800 Epoch=103.1] | Loss=0.00013 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.943 | L2-Norm(final)=6.182 | 5517.4 samples/s | 86.2 steps/s
[Step=10850 Epoch=103.6] | Loss=0.00011 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.906 | L2-Norm(final)=6.185 | 1855.8 samples/s | 29.0 steps/s
[Step=10900 Epoch=104.1] | Loss=0.00010 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.869 | L2-Norm(final)=6.187 | 5287.9 samples/s | 82.6 steps/s
[Step=10950 Epoch=104.6] | Loss=0.00009 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.833 | L2-Norm(final)=6.189 | 1909.6 samples/s | 29.8 steps/s
[Step=11000 Epoch=105.0] | Loss=0.00008 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.796 | L2-Norm(final)=6.191 | 5033.2 samples/s | 78.6 steps/s
[Step=11050 Epoch=105.5] | Loss=0.00008 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.760 | L2-Norm(final)=6.193 | 1922.2 samples/s | 30.0 steps/s
[Step=11100 Epoch=106.0] | Loss=0.00007 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.724 | L2-Norm(final)=6.195 | 4801.4 samples/s | 75.0 steps/s
[Step=11150 Epoch=106.5] | Loss=0.00007 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.688 | L2-Norm(final)=6.196 | 1940.9 samples/s | 30.3 steps/s
[Step=11200 Epoch=107.0] | Loss=0.00006 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.653 | L2-Norm(final)=6.198 | 4796.6 samples/s | 74.9 steps/s
[Step=11250 Epoch=107.4] | Loss=0.00006 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.617 | L2-Norm(final)=6.199 | 1987.0 samples/s | 31.0 steps/s
[Step=11300 Epoch=107.9] | Loss=0.00006 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.582 | L2-Norm(final)=6.201 | 4628.3 samples/s | 72.3 steps/s
[Step=11350 Epoch=108.4] | Loss=0.00006 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.547 | L2-Norm(final)=6.202 | 1958.9 samples/s | 30.6 steps/s
[Step=11400 Epoch=108.9] | Loss=0.00005 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.513 | L2-Norm(final)=6.203 | 4742.2 samples/s | 74.1 steps/s
[Step=11450 Epoch=109.3] | Loss=0.00005 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.478 | L2-Norm(final)=6.205 | 1998.0 samples/s | 31.2 steps/s
[Step=11500 Epoch=109.8] | Loss=0.00005 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.443 | L2-Norm(final)=6.206 | 4638.3 samples/s | 72.5 steps/s
[Step=11550 Epoch=110.3] | Loss=0.00005 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.409 | L2-Norm(final)=6.207 | 6902.1 samples/s | 107.8 steps/s
[Step=11600 Epoch=110.8] | Loss=0.00005 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.375 | L2-Norm(final)=6.209 | 1756.0 samples/s | 27.4 steps/s
[Step=11650 Epoch=111.3] | Loss=0.00004 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.341 | L2-Norm(final)=6.210 | 6360.5 samples/s | 99.4 steps/s
[Step=11700 Epoch=111.7] | Loss=0.00004 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.307 | L2-Norm(final)=6.211 | 1800.7 samples/s | 28.1 steps/s
[Step=11750 Epoch=112.2] | Loss=0.00004 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.273 | L2-Norm(final)=6.212 | 5983.0 samples/s | 93.5 steps/s
[Step=11800 Epoch=112.7] | Loss=0.00004 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.240 | L2-Norm(final)=6.214 | 1808.0 samples/s | 28.2 steps/s
[Step=11850 Epoch=113.2] | Loss=0.00004 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.206 | L2-Norm(final)=6.215 | 5626.0 samples/s | 87.9 steps/s
[Step=11900 Epoch=113.6] | Loss=0.00004 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.173 | L2-Norm(final)=6.216 | 1861.3 samples/s | 29.1 steps/s
[Step=11950 Epoch=114.1] | Loss=0.00004 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.139 | L2-Norm(final)=6.217 | 5327.3 samples/s | 83.2 steps/s
[Step=12000 Epoch=114.6] | Loss=0.00004 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.106 | L2-Norm(final)=6.218 | 1879.6 samples/s | 29.4 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step12000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=10001 Epoch=94.2] | Loss=0.02375 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.573 | L2-Norm(final)=6.254 | 3854.3 samples/s | 60.2 steps/s
[Step=10050 Epoch=94.7] | Loss=0.01592 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.692 | L2-Norm(final)=6.241 | 4652.1 samples/s | 72.7 steps/s
[Step=10100 Epoch=95.2] | Loss=0.01005 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.729 | L2-Norm(final)=6.275 | 7223.0 samples/s | 112.9 steps/s
[Step=10150 Epoch=95.6] | Loss=0.00748 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.747 | L2-Norm(final)=6.310 | 1876.2 samples/s | 29.3 steps/s
[Step=10200 Epoch=96.1] | Loss=0.00662 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.758 | L2-Norm(final)=6.343 | 6562.6 samples/s | 102.5 steps/s
[Step=10250 Epoch=96.6] | Loss=0.00560 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.769 | L2-Norm(final)=6.376 | 1912.9 samples/s | 29.9 steps/s
[Step=10300 Epoch=97.1] | Loss=0.00502 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.776 | L2-Norm(final)=6.406 | 5976.2 samples/s | 93.4 steps/s
[Step=10350 Epoch=97.5] | Loss=0.00447 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.782 | L2-Norm(final)=6.436 | 1959.2 samples/s | 30.6 steps/s
[Step=10400 Epoch=98.0] | Loss=0.00407 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.785 | L2-Norm(final)=6.464 | 5519.5 samples/s | 86.2 steps/s
[Step=10450 Epoch=98.5] | Loss=0.00370 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.788 | L2-Norm(final)=6.491 | 2009.0 samples/s | 31.4 steps/s
[Step=10500 Epoch=98.9] | Loss=0.00343 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.788 | L2-Norm(final)=6.517 | 5249.6 samples/s | 82.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=98.9] | Loss=0.00034 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.790 | L2-Norm(final)=6.776 | 3986.6 samples/s | 62.3 steps/s
[Step=10550 Epoch=99.4] | Loss=0.00042 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.779 | L2-Norm(final)=6.794 | 4322.7 samples/s | 67.5 steps/s
[Step=10600 Epoch=99.9] | Loss=0.00045 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.759 | L2-Norm(final)=6.807 | 6264.7 samples/s | 97.9 steps/s
[Step=10650 Epoch=100.4] | Loss=0.00034 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.739 | L2-Norm(final)=6.819 | 1818.4 samples/s | 28.4 steps/s
[Step=10700 Epoch=100.8] | Loss=0.00026 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.713 | L2-Norm(final)=6.826 | 5738.9 samples/s | 89.7 steps/s
[Step=10750 Epoch=101.3] | Loss=0.00022 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.684 | L2-Norm(final)=6.831 | 1867.3 samples/s | 29.2 steps/s
[Step=10800 Epoch=101.8] | Loss=0.00018 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.653 | L2-Norm(final)=6.835 | 5252.9 samples/s | 82.1 steps/s
[Step=10850 Epoch=102.2] | Loss=0.00016 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.621 | L2-Norm(final)=6.839 | 1877.0 samples/s | 29.3 steps/s
[Step=10900 Epoch=102.7] | Loss=0.00014 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.589 | L2-Norm(final)=6.842 | 4876.6 samples/s | 76.2 steps/s
[Step=10950 Epoch=103.2] | Loss=0.00013 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.557 | L2-Norm(final)=6.844 | 1965.4 samples/s | 30.7 steps/s
[Step=11000 Epoch=103.7] | Loss=0.00012 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.524 | L2-Norm(final)=6.846 | 4742.0 samples/s | 74.1 steps/s
[Step=11050 Epoch=104.1] | Loss=0.00011 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.491 | L2-Norm(final)=6.848 | 1998.6 samples/s | 31.2 steps/s
[Step=11100 Epoch=104.6] | Loss=0.00010 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.459 | L2-Norm(final)=6.850 | 4708.1 samples/s | 73.6 steps/s
[Step=11150 Epoch=105.1] | Loss=0.00009 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.426 | L2-Norm(final)=6.852 | 2012.0 samples/s | 31.4 steps/s
[Step=11200 Epoch=105.5] | Loss=0.00009 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.393 | L2-Norm(final)=6.854 | 4669.8 samples/s | 73.0 steps/s
[Step=11250 Epoch=106.0] | Loss=0.00008 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.360 | L2-Norm(final)=6.855 | 2000.1 samples/s | 31.3 steps/s
[Step=11300 Epoch=106.5] | Loss=0.00008 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.327 | L2-Norm(final)=6.857 | 4381.8 samples/s | 68.5 steps/s
[Step=11350 Epoch=106.9] | Loss=0.00007 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.295 | L2-Norm(final)=6.858 | 6284.7 samples/s | 98.2 steps/s
[Step=11400 Epoch=107.4] | Loss=0.00007 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.262 | L2-Norm(final)=6.859 | 1796.3 samples/s | 28.1 steps/s
[Step=11450 Epoch=107.9] | Loss=0.00007 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.229 | L2-Norm(final)=6.861 | 5840.7 samples/s | 91.3 steps/s
[Step=11500 Epoch=108.4] | Loss=0.00006 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.196 | L2-Norm(final)=6.862 | 1848.8 samples/s | 28.9 steps/s
[Step=11550 Epoch=108.8] | Loss=0.00006 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.163 | L2-Norm(final)=6.863 | 5346.2 samples/s | 83.5 steps/s
[Step=11600 Epoch=109.3] | Loss=0.00006 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.131 | L2-Norm(final)=6.865 | 1916.5 samples/s | 29.9 steps/s
[Step=11650 Epoch=109.8] | Loss=0.00006 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.098 | L2-Norm(final)=6.866 | 4792.6 samples/s | 74.9 steps/s
[Step=11700 Epoch=110.2] | Loss=0.00005 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.065 | L2-Norm(final)=6.867 | 1981.5 samples/s | 31.0 steps/s
[Step=11750 Epoch=110.7] | Loss=0.00005 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.032 | L2-Norm(final)=6.868 | 4582.3 samples/s | 71.6 steps/s
[Step=11800 Epoch=111.2] | Loss=0.00005 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.000 | L2-Norm(final)=6.870 | 1975.6 samples/s | 30.9 steps/s
[Step=11850 Epoch=111.7] | Loss=0.00005 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.967 | L2-Norm(final)=6.871 | 4662.0 samples/s | 72.8 steps/s
[Step=11900 Epoch=112.1] | Loss=0.00005 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.934 | L2-Norm(final)=6.872 | 1965.1 samples/s | 30.7 steps/s
[Step=11950 Epoch=112.6] | Loss=0.00005 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.901 | L2-Norm(final)=6.873 | 4704.8 samples/s | 73.5 steps/s
[Step=12000 Epoch=113.1] | Loss=0.00005 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.869 | L2-Norm(final)=6.874 | 2060.8 samples/s | 32.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10993 | acc=0.9478 | tpr=0.9521 | fpr=0.0614 | 4293.9 samples/s | 16.8 steps/s
Avg test loss: 0.11817, Avg test acc: 0.94555, Avg tpr: 0.95017, Avg fpr: 0.06461, total FA: 504

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.12791 | acc=0.9343 | tpr=0.9411 | fpr=0.0805 | 4419.2 samples/s | 17.3 steps/s
Avg test loss: 0.13201, Avg test acc: 0.93281, Avg tpr: 0.93863, Avg fpr: 0.07999, total FA: 624

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11441 | acc=0.9481 | tpr=0.9573 | fpr=0.0719 | 4422.6 samples/s | 17.3 steps/s
Avg test loss: 0.11832, Avg test acc: 0.94787, Avg tpr: 0.95728, Avg fpr: 0.07281, total FA: 568

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.13963 | acc=0.9348 | tpr=0.9359 | fpr=0.0674 | 4322.1 samples/s | 16.9 steps/s
Avg test loss: 0.14651, Avg test acc: 0.93181, Avg tpr: 0.93227, Avg fpr: 0.06922, total FA: 540

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.14019 | acc=0.9391 | tpr=0.9677 | fpr=0.1231 | 4422.4 samples/s | 17.3 steps/s
Avg test loss: 0.14487, Avg test acc: 0.93697, Avg tpr: 0.96538, Avg fpr: 0.12550, total FA: 979

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.01786 | acc=0.2978 | tpr=0.0035 | fpr=0.0632 | 4348.0 samples/s | 17.0 steps/s
Avg test loss: 4.02052, Avg test acc: 0.29634, Avg tpr: 0.00507, Avg fpr: 0.06307, total FA: 492

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.22583 | acc=0.3117 | tpr=0.0021 | fpr=0.0159 | 4310.4 samples/s | 16.8 steps/s
Avg test loss: 4.23372, Avg test acc: 0.30960, Avg tpr: 0.00204, Avg fpr: 0.01397, total FA: 109

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.11046 | acc=0.2988 | tpr=0.0065 | fpr=0.0667 | 4368.1 samples/s | 17.1 steps/s
Avg test loss: 4.10810, Avg test acc: 0.29842, Avg tpr: 0.00857, Avg fpr: 0.06409, total FA: 500

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.14320 | acc=0.3026 | tpr=0.0026 | fpr=0.0461 | 4404.3 samples/s | 17.2 steps/s
Avg test loss: 4.14816, Avg test acc: 0.30143, Avg tpr: 0.00373, Avg fpr: 0.04384, total FA: 342

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=3.67570 | acc=0.3145 | tpr=0.0007 | fpr=0.0042 | 4331.0 samples/s | 16.9 steps/s
Avg test loss: 3.67947, Avg test acc: 0.31176, Avg tpr: 0.00064, Avg fpr: 0.00397, total FA: 31

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.88494 | acc=0.1416 | tpr=0.6814 | fpr=0.8681 | 4371.0 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.85880 | acc=0.1420 | tpr=0.6780 | fpr=0.8681 | 8397.4 samples/s | 32.8 steps/s
[Step= 150] | Loss=4.85924 | acc=0.1412 | tpr=0.6772 | fpr=0.8687 | 8651.6 samples/s | 33.8 steps/s
[Step= 200] | Loss=4.86364 | acc=0.1411 | tpr=0.6765 | fpr=0.8687 | 8527.7 samples/s | 33.3 steps/s
[Step= 250] | Loss=4.86518 | acc=0.1414 | tpr=0.6716 | fpr=0.8682 | 8413.8 samples/s | 32.9 steps/s
[Step= 300] | Loss=4.86727 | acc=0.1417 | tpr=0.6771 | fpr=0.8680 | 9084.6 samples/s | 35.5 steps/s
[Step= 350] | Loss=4.86471 | acc=0.1412 | tpr=0.6681 | fpr=0.8683 | 8256.7 samples/s | 32.3 steps/s
[Step= 400] | Loss=4.86503 | acc=0.1416 | tpr=0.6658 | fpr=0.8679 | 8574.8 samples/s | 33.5 steps/s
[Step= 450] | Loss=4.86669 | acc=0.1419 | tpr=0.6621 | fpr=0.8675 | 8613.2 samples/s | 33.6 steps/s
[Step= 500] | Loss=4.86816 | acc=0.1415 | tpr=0.6573 | fpr=0.8678 | 8455.3 samples/s | 33.0 steps/s
[Step= 550] | Loss=4.86998 | acc=0.1414 | tpr=0.6586 | fpr=0.8680 | 15907.6 samples/s | 62.1 steps/s
Avg test loss: 4.87124, Avg test acc: 0.14134, Avg tpr: 0.65887, Avg fpr: 0.86807, total FA: 120530

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.23327 | acc=0.1421 | tpr=0.6372 | fpr=0.8668 | 4424.2 samples/s | 17.3 steps/s
[Step= 100] | Loss=4.19937 | acc=0.1438 | tpr=0.6055 | fpr=0.8648 | 8509.0 samples/s | 33.2 steps/s
[Step= 150] | Loss=4.20190 | acc=0.1430 | tpr=0.6037 | fpr=0.8655 | 8568.8 samples/s | 33.5 steps/s
[Step= 200] | Loss=4.20389 | acc=0.1429 | tpr=0.5978 | fpr=0.8653 | 8397.0 samples/s | 32.8 steps/s
[Step= 250] | Loss=4.20033 | acc=0.1431 | tpr=0.6148 | fpr=0.8655 | 8701.9 samples/s | 34.0 steps/s
[Step= 300] | Loss=4.19767 | acc=0.1437 | tpr=0.6182 | fpr=0.8649 | 8672.4 samples/s | 33.9 steps/s
[Step= 350] | Loss=4.19379 | acc=0.1433 | tpr=0.6093 | fpr=0.8651 | 8525.0 samples/s | 33.3 steps/s
[Step= 400] | Loss=4.19732 | acc=0.1436 | tpr=0.6089 | fpr=0.8649 | 8858.4 samples/s | 34.6 steps/s
[Step= 450] | Loss=4.19973 | acc=0.1438 | tpr=0.6100 | fpr=0.8647 | 8261.1 samples/s | 32.3 steps/s
[Step= 500] | Loss=4.20013 | acc=0.1430 | tpr=0.6062 | fpr=0.8654 | 8552.2 samples/s | 33.4 steps/s
[Step= 550] | Loss=4.20178 | acc=0.1433 | tpr=0.6112 | fpr=0.8652 | 15085.0 samples/s | 58.9 steps/s
Avg test loss: 4.20190, Avg test acc: 0.14322, Avg tpr: 0.61054, Avg fpr: 0.86528, total FA: 120142

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.46772 | acc=0.1205 | tpr=0.6327 | fpr=0.8887 | 4436.5 samples/s | 17.3 steps/s
[Step= 100] | Loss=5.42079 | acc=0.1235 | tpr=0.6098 | fpr=0.8856 | 8424.7 samples/s | 32.9 steps/s
[Step= 150] | Loss=5.42028 | acc=0.1226 | tpr=0.6297 | fpr=0.8867 | 8297.8 samples/s | 32.4 steps/s
[Step= 200] | Loss=5.42411 | acc=0.1216 | tpr=0.6339 | fpr=0.8877 | 8718.0 samples/s | 34.1 steps/s
[Step= 250] | Loss=5.42340 | acc=0.1217 | tpr=0.6384 | fpr=0.8877 | 8551.8 samples/s | 33.4 steps/s
[Step= 300] | Loss=5.42742 | acc=0.1217 | tpr=0.6422 | fpr=0.8878 | 8690.9 samples/s | 33.9 steps/s
[Step= 350] | Loss=5.42376 | acc=0.1213 | tpr=0.6343 | fpr=0.8880 | 8512.2 samples/s | 33.3 steps/s
[Step= 400] | Loss=5.42466 | acc=0.1215 | tpr=0.6280 | fpr=0.8878 | 8564.8 samples/s | 33.5 steps/s
[Step= 450] | Loss=5.42949 | acc=0.1210 | tpr=0.6193 | fpr=0.8880 | 8949.3 samples/s | 35.0 steps/s
[Step= 500] | Loss=5.42931 | acc=0.1211 | tpr=0.6185 | fpr=0.8879 | 8617.8 samples/s | 33.7 steps/s
[Step= 550] | Loss=5.43046 | acc=0.1209 | tpr=0.6224 | fpr=0.8883 | 13882.7 samples/s | 54.2 steps/s
Avg test loss: 5.43273, Avg test acc: 0.12079, Avg tpr: 0.62322, Avg fpr: 0.88834, total FA: 123344

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.28787 | acc=0.1722 | tpr=0.5664 | fpr=0.8349 | 4337.3 samples/s | 16.9 steps/s
[Step= 100] | Loss=4.26021 | acc=0.1717 | tpr=0.5565 | fpr=0.8355 | 8410.5 samples/s | 32.9 steps/s
[Step= 150] | Loss=4.25884 | acc=0.1714 | tpr=0.5576 | fpr=0.8357 | 9519.2 samples/s | 37.2 steps/s
[Step= 200] | Loss=4.25417 | acc=0.1710 | tpr=0.5486 | fpr=0.8358 | 7855.1 samples/s | 30.7 steps/s
[Step= 250] | Loss=4.25814 | acc=0.1718 | tpr=0.5502 | fpr=0.8351 | 8835.0 samples/s | 34.5 steps/s
[Step= 300] | Loss=4.25706 | acc=0.1714 | tpr=0.5571 | fpr=0.8357 | 8302.3 samples/s | 32.4 steps/s
[Step= 350] | Loss=4.25467 | acc=0.1714 | tpr=0.5554 | fpr=0.8356 | 8772.1 samples/s | 34.3 steps/s
[Step= 400] | Loss=4.25780 | acc=0.1711 | tpr=0.5438 | fpr=0.8357 | 8452.4 samples/s | 33.0 steps/s
[Step= 450] | Loss=4.26166 | acc=0.1713 | tpr=0.5463 | fpr=0.8355 | 8688.6 samples/s | 33.9 steps/s
[Step= 500] | Loss=4.26241 | acc=0.1707 | tpr=0.5414 | fpr=0.8360 | 8396.0 samples/s | 32.8 steps/s
[Step= 550] | Loss=4.26358 | acc=0.1706 | tpr=0.5404 | fpr=0.8362 | 16071.7 samples/s | 62.8 steps/s
Avg test loss: 4.26415, Avg test acc: 0.17052, Avg tpr: 0.54081, Avg fpr: 0.83621, total FA: 116106

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.57272 | acc=0.1052 | tpr=0.7478 | fpr=0.9064 | 4347.4 samples/s | 17.0 steps/s
[Step= 100] | Loss=5.55778 | acc=0.1057 | tpr=0.7207 | fpr=0.9058 | 9313.5 samples/s | 36.4 steps/s
[Step= 150] | Loss=5.56514 | acc=0.1049 | tpr=0.7233 | fpr=0.9065 | 8073.1 samples/s | 31.5 steps/s
[Step= 200] | Loss=5.55862 | acc=0.1043 | tpr=0.7301 | fpr=0.9071 | 8755.6 samples/s | 34.2 steps/s
[Step= 250] | Loss=5.56061 | acc=0.1045 | tpr=0.7214 | fpr=0.9067 | 8859.6 samples/s | 34.6 steps/s
[Step= 300] | Loss=5.55757 | acc=0.1042 | tpr=0.7193 | fpr=0.9070 | 7996.9 samples/s | 31.2 steps/s
[Step= 350] | Loss=5.55149 | acc=0.1040 | tpr=0.7188 | fpr=0.9072 | 8605.0 samples/s | 33.6 steps/s
[Step= 400] | Loss=5.54968 | acc=0.1041 | tpr=0.7205 | fpr=0.9071 | 9367.9 samples/s | 36.6 steps/s
[Step= 450] | Loss=5.55022 | acc=0.1041 | tpr=0.7079 | fpr=0.9069 | 8061.7 samples/s | 31.5 steps/s
[Step= 500] | Loss=5.55120 | acc=0.1039 | tpr=0.7044 | fpr=0.9070 | 9054.6 samples/s | 35.4 steps/s
[Step= 550] | Loss=5.55420 | acc=0.1037 | tpr=0.7079 | fpr=0.9073 | 14386.9 samples/s | 56.2 steps/s
Avg test loss: 5.55495, Avg test acc: 0.10361, Avg tpr: 0.70840, Avg fpr: 0.90738, total FA: 125988

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09634 | acc=0.9802 | tpr=0.9071 | fpr=0.0185 | 4354.8 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.09999 | acc=0.9799 | tpr=0.9190 | fpr=0.0190 | 8675.3 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.10421 | acc=0.9790 | tpr=0.9207 | fpr=0.0199 | 8785.5 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.10658 | acc=0.9791 | tpr=0.9268 | fpr=0.0200 | 8600.1 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.10599 | acc=0.9790 | tpr=0.9223 | fpr=0.0199 | 8320.7 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.10729 | acc=0.9789 | tpr=0.9222 | fpr=0.0201 | 8940.6 samples/s | 34.9 steps/s
[Step= 350] | Loss=0.10754 | acc=0.9786 | tpr=0.9224 | fpr=0.0204 | 8571.1 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.10922 | acc=0.9784 | tpr=0.9174 | fpr=0.0205 | 8639.3 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.11171 | acc=0.9780 | tpr=0.9177 | fpr=0.0209 | 8941.7 samples/s | 34.9 steps/s
[Step= 500] | Loss=0.11124 | acc=0.9781 | tpr=0.9194 | fpr=0.0209 | 8197.8 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.11032 | acc=0.9783 | tpr=0.9200 | fpr=0.0207 | 15667.8 samples/s | 61.2 steps/s
Avg test loss: 0.11014, Avg test acc: 0.97828, Avg tpr: 0.91957, Avg fpr: 0.02066, total FA: 2868

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10875 | acc=0.9818 | tpr=0.8717 | fpr=0.0162 | 4365.7 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.11622 | acc=0.9814 | tpr=0.8891 | fpr=0.0169 | 9121.3 samples/s | 35.6 steps/s
[Step= 150] | Loss=0.11950 | acc=0.9808 | tpr=0.8948 | fpr=0.0176 | 8080.4 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.12145 | acc=0.9808 | tpr=0.8929 | fpr=0.0176 | 8657.0 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.12075 | acc=0.9808 | tpr=0.8891 | fpr=0.0175 | 8585.4 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.12256 | acc=0.9806 | tpr=0.8887 | fpr=0.0177 | 8864.4 samples/s | 34.6 steps/s
[Step= 350] | Loss=0.12296 | acc=0.9804 | tpr=0.8917 | fpr=0.0180 | 8375.4 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.12472 | acc=0.9801 | tpr=0.8862 | fpr=0.0182 | 8475.3 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.12810 | acc=0.9798 | tpr=0.8851 | fpr=0.0184 | 8627.9 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.12742 | acc=0.9799 | tpr=0.8872 | fpr=0.0184 | 8446.4 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.12690 | acc=0.9800 | tpr=0.8862 | fpr=0.0183 | 15570.5 samples/s | 60.8 steps/s
Avg test loss: 0.12673, Avg test acc: 0.97999, Avg tpr: 0.88550, Avg fpr: 0.01829, total FA: 2540

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10167 | acc=0.9803 | tpr=0.9381 | fpr=0.0189 | 4370.7 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.10588 | acc=0.9796 | tpr=0.9339 | fpr=0.0195 | 8928.6 samples/s | 34.9 steps/s
[Step= 150] | Loss=0.10878 | acc=0.9786 | tpr=0.9337 | fpr=0.0205 | 8304.1 samples/s | 32.4 steps/s
[Step= 200] | Loss=0.11143 | acc=0.9784 | tpr=0.9355 | fpr=0.0208 | 8666.4 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.11075 | acc=0.9783 | tpr=0.9345 | fpr=0.0209 | 8699.3 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.11213 | acc=0.9781 | tpr=0.9360 | fpr=0.0211 | 8593.0 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.11230 | acc=0.9779 | tpr=0.9361 | fpr=0.0213 | 8413.5 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.11380 | acc=0.9777 | tpr=0.9333 | fpr=0.0215 | 8732.1 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.11650 | acc=0.9774 | tpr=0.9314 | fpr=0.0218 | 8592.3 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.11610 | acc=0.9774 | tpr=0.9330 | fpr=0.0218 | 8841.4 samples/s | 34.5 steps/s
[Step= 550] | Loss=0.11506 | acc=0.9776 | tpr=0.9343 | fpr=0.0216 | 14422.3 samples/s | 56.3 steps/s
Avg test loss: 0.11490, Avg test acc: 0.97759, Avg tpr: 0.93384, Avg fpr: 0.02161, total FA: 3001

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10929 | acc=0.9807 | tpr=0.8982 | fpr=0.0178 | 4332.1 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.11420 | acc=0.9802 | tpr=0.9211 | fpr=0.0187 | 8618.8 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.11818 | acc=0.9794 | tpr=0.9236 | fpr=0.0196 | 8607.1 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.12178 | acc=0.9792 | tpr=0.9301 | fpr=0.0199 | 8675.6 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.12031 | acc=0.9792 | tpr=0.9275 | fpr=0.0198 | 8607.2 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.12205 | acc=0.9790 | tpr=0.9302 | fpr=0.0201 | 8514.0 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.12190 | acc=0.9789 | tpr=0.9311 | fpr=0.0202 | 8536.9 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.12317 | acc=0.9787 | tpr=0.9256 | fpr=0.0203 | 8567.1 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.12612 | acc=0.9783 | tpr=0.9241 | fpr=0.0207 | 8567.7 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.12538 | acc=0.9783 | tpr=0.9256 | fpr=0.0207 | 8497.4 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.12440 | acc=0.9785 | tpr=0.9264 | fpr=0.0206 | 15908.2 samples/s | 62.1 steps/s
Avg test loss: 0.12418, Avg test acc: 0.97848, Avg tpr: 0.92552, Avg fpr: 0.02055, total FA: 2854

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10533 | acc=0.9798 | tpr=0.8628 | fpr=0.0181 | 4346.4 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.10905 | acc=0.9797 | tpr=0.8870 | fpr=0.0185 | 8386.1 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.11226 | acc=0.9790 | tpr=0.8948 | fpr=0.0195 | 8928.3 samples/s | 34.9 steps/s
[Step= 200] | Loss=0.11537 | acc=0.9787 | tpr=0.8929 | fpr=0.0198 | 8951.2 samples/s | 35.0 steps/s
[Step= 250] | Loss=0.11344 | acc=0.9788 | tpr=0.8900 | fpr=0.0196 | 8705.9 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.11565 | acc=0.9784 | tpr=0.8880 | fpr=0.0200 | 7914.9 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.11675 | acc=0.9783 | tpr=0.8898 | fpr=0.0201 | 8597.4 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.11755 | acc=0.9781 | tpr=0.8840 | fpr=0.0202 | 8690.8 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.11958 | acc=0.9779 | tpr=0.8822 | fpr=0.0204 | 8652.3 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.11876 | acc=0.9780 | tpr=0.8833 | fpr=0.0203 | 8726.5 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.11800 | acc=0.9781 | tpr=0.8834 | fpr=0.0202 | 14814.9 samples/s | 57.9 steps/s
Avg test loss: 0.11776, Avg test acc: 0.97809, Avg tpr: 0.88273, Avg fpr: 0.02018, total FA: 2802

server round 11/50

clients selected: [1 2 4 5 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=14001 Epoch=68.3] | Loss=0.07911 | Reg=0.00206 | acc=0.9219 | L2-Norm=14.360 | L2-Norm(final)=6.469 | 3992.7 samples/s | 62.4 steps/s
[Step=14050 Epoch=68.6] | Loss=0.06319 | Reg=0.00207 | acc=0.9062 | L2-Norm=14.404 | L2-Norm(final)=6.460 | 5134.9 samples/s | 80.2 steps/s
[Step=14100 Epoch=68.8] | Loss=0.05866 | Reg=0.00209 | acc=0.9531 | L2-Norm=14.445 | L2-Norm(final)=6.466 | 5586.5 samples/s | 87.3 steps/s
[Step=14150 Epoch=69.0] | Loss=0.05572 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.484 | L2-Norm(final)=6.478 | 5455.2 samples/s | 85.2 steps/s
[Step=14200 Epoch=69.3] | Loss=0.05231 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.523 | L2-Norm(final)=6.496 | 7784.6 samples/s | 121.6 steps/s
[Step=14250 Epoch=69.5] | Loss=0.05123 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.564 | L2-Norm(final)=6.516 | 1902.8 samples/s | 29.7 steps/s
[Step=14300 Epoch=69.8] | Loss=0.05063 | Reg=0.00213 | acc=0.9688 | L2-Norm=14.607 | L2-Norm(final)=6.536 | 5562.5 samples/s | 86.9 steps/s
[Step=14350 Epoch=70.0] | Loss=0.04963 | Reg=0.00215 | acc=0.9062 | L2-Norm=14.650 | L2-Norm(final)=6.556 | 5610.6 samples/s | 87.7 steps/s
[Step=14400 Epoch=70.3] | Loss=0.04860 | Reg=0.00216 | acc=0.9531 | L2-Norm=14.692 | L2-Norm(final)=6.577 | 7073.7 samples/s | 110.5 steps/s
[Step=14450 Epoch=70.5] | Loss=0.04727 | Reg=0.00217 | acc=0.9688 | L2-Norm=14.736 | L2-Norm(final)=6.599 | 1926.3 samples/s | 30.1 steps/s
[Step=14500 Epoch=70.8] | Loss=0.04653 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.781 | L2-Norm(final)=6.622 | 5487.1 samples/s | 85.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=70.8] | Loss=0.04085 | Reg=0.00232 | acc=0.9688 | L2-Norm=15.244 | L2-Norm(final)=6.858 | 3784.7 samples/s | 59.1 steps/s
[Step=14550 Epoch=71.0] | Loss=0.03771 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.289 | L2-Norm(final)=6.882 | 4784.3 samples/s | 74.8 steps/s
[Step=14600 Epoch=71.2] | Loss=0.04004 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.317 | L2-Norm(final)=6.881 | 4828.3 samples/s | 75.4 steps/s
[Step=14650 Epoch=71.5] | Loss=0.03922 | Reg=0.00235 | acc=0.9688 | L2-Norm=15.341 | L2-Norm(final)=6.879 | 4783.3 samples/s | 74.7 steps/s
[Step=14700 Epoch=71.7] | Loss=0.03949 | Reg=0.00236 | acc=0.9219 | L2-Norm=15.361 | L2-Norm(final)=6.878 | 6436.2 samples/s | 100.6 steps/s
[Step=14750 Epoch=72.0] | Loss=0.03602 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.376 | L2-Norm(final)=6.877 | 1842.3 samples/s | 28.8 steps/s
[Step=14800 Epoch=72.2] | Loss=0.03243 | Reg=0.00237 | acc=0.9688 | L2-Norm=15.390 | L2-Norm(final)=6.881 | 4848.6 samples/s | 75.8 steps/s
[Step=14850 Epoch=72.5] | Loss=0.02996 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.404 | L2-Norm(final)=6.886 | 4808.7 samples/s | 75.1 steps/s
[Step=14900 Epoch=72.7] | Loss=0.02855 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.417 | L2-Norm(final)=6.891 | 6186.4 samples/s | 96.7 steps/s
[Step=14950 Epoch=72.9] | Loss=0.02697 | Reg=0.00238 | acc=0.9688 | L2-Norm=15.428 | L2-Norm(final)=6.894 | 1891.9 samples/s | 29.6 steps/s
[Step=15000 Epoch=73.2] | Loss=0.02506 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.437 | L2-Norm(final)=6.897 | 5009.4 samples/s | 78.3 steps/s
[Step=15050 Epoch=73.4] | Loss=0.02400 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.444 | L2-Norm(final)=6.901 | 4944.6 samples/s | 77.3 steps/s
[Step=15100 Epoch=73.7] | Loss=0.02281 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.451 | L2-Norm(final)=6.904 | 5656.3 samples/s | 88.4 steps/s
[Step=15150 Epoch=73.9] | Loss=0.02162 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.457 | L2-Norm(final)=6.908 | 1918.5 samples/s | 30.0 steps/s
[Step=15200 Epoch=74.2] | Loss=0.02059 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.462 | L2-Norm(final)=6.912 | 4888.1 samples/s | 76.4 steps/s
[Step=15250 Epoch=74.4] | Loss=0.01984 | Reg=0.00239 | acc=0.9688 | L2-Norm=15.466 | L2-Norm(final)=6.916 | 4879.5 samples/s | 76.2 steps/s
[Step=15300 Epoch=74.7] | Loss=0.01914 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.469 | L2-Norm(final)=6.920 | 5386.0 samples/s | 84.2 steps/s
[Step=15350 Epoch=74.9] | Loss=0.01848 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.471 | L2-Norm(final)=6.924 | 1956.5 samples/s | 30.6 steps/s
[Step=15400 Epoch=75.1] | Loss=0.01774 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.473 | L2-Norm(final)=6.927 | 4866.0 samples/s | 76.0 steps/s
[Step=15450 Epoch=75.4] | Loss=0.01717 | Reg=0.00239 | acc=0.9688 | L2-Norm=15.475 | L2-Norm(final)=6.931 | 4939.4 samples/s | 77.2 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01664 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.475 | L2-Norm(final)=6.934 | 5219.4 samples/s | 81.6 steps/s
[Step=15550 Epoch=75.9] | Loss=0.01614 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.476 | L2-Norm(final)=6.937 | 2001.6 samples/s | 31.3 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01574 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.476 | L2-Norm(final)=6.940 | 4941.9 samples/s | 77.2 steps/s
[Step=15650 Epoch=76.4] | Loss=0.01530 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.476 | L2-Norm(final)=6.943 | 4770.1 samples/s | 74.5 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01499 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.476 | L2-Norm(final)=6.946 | 4871.1 samples/s | 76.1 steps/s
[Step=15750 Epoch=76.9] | Loss=0.01455 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.475 | L2-Norm(final)=6.948 | 2038.9 samples/s | 31.9 steps/s
[Step=15800 Epoch=77.1] | Loss=0.01414 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.474 | L2-Norm(final)=6.951 | 4866.1 samples/s | 76.0 steps/s
[Step=15850 Epoch=77.3] | Loss=0.01377 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.472 | L2-Norm(final)=6.954 | 4938.2 samples/s | 77.2 steps/s
[Step=15900 Epoch=77.6] | Loss=0.01347 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.471 | L2-Norm(final)=6.957 | 4991.5 samples/s | 78.0 steps/s
[Step=15950 Epoch=77.8] | Loss=0.01324 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.469 | L2-Norm(final)=6.960 | 2003.7 samples/s | 31.3 steps/s
[Step=16000 Epoch=78.1] | Loss=0.01292 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.468 | L2-Norm(final)=6.962 | 4988.0 samples/s | 77.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step16000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=16001 Epoch=78.0] | Loss=0.03246 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.360 | L2-Norm(final)=8.515 | 4200.0 samples/s | 65.6 steps/s
[Step=16050 Epoch=78.2] | Loss=0.05958 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.416 | L2-Norm(final)=8.496 | 4870.9 samples/s | 76.1 steps/s
[Step=16100 Epoch=78.4] | Loss=0.05267 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.490 | L2-Norm(final)=8.491 | 5605.4 samples/s | 87.6 steps/s
[Step=16150 Epoch=78.7] | Loss=0.05249 | Reg=0.00212 | acc=0.9375 | L2-Norm=14.553 | L2-Norm(final)=8.502 | 5484.3 samples/s | 85.7 steps/s
[Step=16200 Epoch=78.9] | Loss=0.05194 | Reg=0.00213 | acc=0.9219 | L2-Norm=14.607 | L2-Norm(final)=8.509 | 7593.5 samples/s | 118.6 steps/s
[Step=16250 Epoch=79.2] | Loss=0.04953 | Reg=0.00215 | acc=0.9688 | L2-Norm=14.661 | L2-Norm(final)=8.521 | 1914.2 samples/s | 29.9 steps/s
[Step=16300 Epoch=79.4] | Loss=0.04790 | Reg=0.00217 | acc=0.9688 | L2-Norm=14.716 | L2-Norm(final)=8.541 | 5457.1 samples/s | 85.3 steps/s
[Step=16350 Epoch=79.7] | Loss=0.04642 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.770 | L2-Norm(final)=8.563 | 5491.2 samples/s | 85.8 steps/s
[Step=16400 Epoch=79.9] | Loss=0.04563 | Reg=0.00220 | acc=0.9688 | L2-Norm=14.824 | L2-Norm(final)=8.589 | 7094.7 samples/s | 110.9 steps/s
[Step=16450 Epoch=80.2] | Loss=0.04420 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.878 | L2-Norm(final)=8.617 | 1967.5 samples/s | 30.7 steps/s
[Step=16500 Epoch=80.4] | Loss=0.04322 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.932 | L2-Norm(final)=8.646 | 5416.5 samples/s | 84.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=80.4] | Loss=0.01801 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.478 | L2-Norm(final)=8.956 | 4118.3 samples/s | 64.3 steps/s
[Step=16550 Epoch=80.6] | Loss=0.04066 | Reg=0.00241 | acc=0.9219 | L2-Norm=15.540 | L2-Norm(final)=8.986 | 4718.1 samples/s | 73.7 steps/s
[Step=16600 Epoch=80.9] | Loss=0.04664 | Reg=0.00243 | acc=0.9531 | L2-Norm=15.597 | L2-Norm(final)=8.988 | 4881.0 samples/s | 76.3 steps/s
[Step=16650 Epoch=81.1] | Loss=0.04643 | Reg=0.00245 | acc=0.9531 | L2-Norm=15.642 | L2-Norm(final)=8.983 | 4926.6 samples/s | 77.0 steps/s
[Step=16700 Epoch=81.4] | Loss=0.04492 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.681 | L2-Norm(final)=8.980 | 6502.7 samples/s | 101.6 steps/s
[Step=16750 Epoch=81.6] | Loss=0.04071 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.716 | L2-Norm(final)=8.981 | 1807.6 samples/s | 28.2 steps/s
[Step=16800 Epoch=81.9] | Loss=0.03651 | Reg=0.00248 | acc=0.9688 | L2-Norm=15.744 | L2-Norm(final)=8.984 | 4960.9 samples/s | 77.5 steps/s
[Step=16850 Epoch=82.1] | Loss=0.03373 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.766 | L2-Norm(final)=8.989 | 4852.5 samples/s | 75.8 steps/s
[Step=16900 Epoch=82.3] | Loss=0.03206 | Reg=0.00249 | acc=0.9688 | L2-Norm=15.786 | L2-Norm(final)=8.993 | 6033.9 samples/s | 94.3 steps/s
[Step=16950 Epoch=82.6] | Loss=0.03002 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.805 | L2-Norm(final)=8.998 | 1900.0 samples/s | 29.7 steps/s
[Step=17000 Epoch=82.8] | Loss=0.02832 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.821 | L2-Norm(final)=9.002 | 4939.3 samples/s | 77.2 steps/s
[Step=17050 Epoch=83.1] | Loss=0.02675 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.835 | L2-Norm(final)=9.006 | 4948.4 samples/s | 77.3 steps/s
[Step=17100 Epoch=83.3] | Loss=0.02561 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.847 | L2-Norm(final)=9.011 | 5700.7 samples/s | 89.1 steps/s
[Step=17150 Epoch=83.6] | Loss=0.02467 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.859 | L2-Norm(final)=9.014 | 1946.7 samples/s | 30.4 steps/s
[Step=17200 Epoch=83.8] | Loss=0.02363 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.869 | L2-Norm(final)=9.017 | 5019.4 samples/s | 78.4 steps/s
[Step=17250 Epoch=84.1] | Loss=0.02279 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.877 | L2-Norm(final)=9.020 | 4838.0 samples/s | 75.6 steps/s
[Step=17300 Epoch=84.3] | Loss=0.02179 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.884 | L2-Norm(final)=9.023 | 5356.5 samples/s | 83.7 steps/s
[Step=17350 Epoch=84.5] | Loss=0.02107 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.891 | L2-Norm(final)=9.026 | 1963.4 samples/s | 30.7 steps/s
[Step=17400 Epoch=84.8] | Loss=0.02025 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.897 | L2-Norm(final)=9.029 | 4918.5 samples/s | 76.9 steps/s
[Step=17450 Epoch=85.0] | Loss=0.01961 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.902 | L2-Norm(final)=9.032 | 4836.0 samples/s | 75.6 steps/s
[Step=17500 Epoch=85.3] | Loss=0.01908 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.906 | L2-Norm(final)=9.035 | 4902.3 samples/s | 76.6 steps/s
[Step=17550 Epoch=85.5] | Loss=0.01851 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.911 | L2-Norm(final)=9.038 | 2017.6 samples/s | 31.5 steps/s
[Step=17600 Epoch=85.8] | Loss=0.01795 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.915 | L2-Norm(final)=9.040 | 4953.6 samples/s | 77.4 steps/s
[Step=17650 Epoch=86.0] | Loss=0.01748 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.918 | L2-Norm(final)=9.043 | 4722.6 samples/s | 73.8 steps/s
[Step=17700 Epoch=86.2] | Loss=0.01690 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.920 | L2-Norm(final)=9.046 | 4871.6 samples/s | 76.1 steps/s
[Step=17750 Epoch=86.5] | Loss=0.01668 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.923 | L2-Norm(final)=9.048 | 2042.2 samples/s | 31.9 steps/s
[Step=17800 Epoch=86.7] | Loss=0.01621 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.925 | L2-Norm(final)=9.051 | 4906.3 samples/s | 76.7 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01584 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.927 | L2-Norm(final)=9.053 | 5028.7 samples/s | 78.6 steps/s
[Step=17900 Epoch=87.2] | Loss=0.01556 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.929 | L2-Norm(final)=9.056 | 4850.9 samples/s | 75.8 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01528 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.930 | L2-Norm(final)=9.058 | 2046.1 samples/s | 32.0 steps/s
[Step=18000 Epoch=87.7] | Loss=0.01518 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.932 | L2-Norm(final)=9.061 | 4828.5 samples/s | 75.4 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step18000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=14001 Epoch=68.7] | Loss=0.02350 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.360 | L2-Norm(final)=7.576 | 3746.3 samples/s | 58.5 steps/s
[Step=14050 Epoch=68.9] | Loss=0.04575 | Reg=0.00208 | acc=0.9375 | L2-Norm=14.411 | L2-Norm(final)=7.577 | 5485.8 samples/s | 85.7 steps/s
[Step=14100 Epoch=69.1] | Loss=0.04745 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.461 | L2-Norm(final)=7.573 | 5566.8 samples/s | 87.0 steps/s
[Step=14150 Epoch=69.4] | Loss=0.04620 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.506 | L2-Norm(final)=7.575 | 5472.4 samples/s | 85.5 steps/s
[Step=14200 Epoch=69.6] | Loss=0.04569 | Reg=0.00212 | acc=0.9531 | L2-Norm=14.547 | L2-Norm(final)=7.584 | 7852.5 samples/s | 122.7 steps/s
[Step=14250 Epoch=69.9] | Loss=0.04394 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.592 | L2-Norm(final)=7.598 | 1919.6 samples/s | 30.0 steps/s
[Step=14300 Epoch=70.1] | Loss=0.04247 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.640 | L2-Norm(final)=7.617 | 5630.0 samples/s | 88.0 steps/s
[Step=14350 Epoch=70.4] | Loss=0.04166 | Reg=0.00216 | acc=0.9531 | L2-Norm=14.687 | L2-Norm(final)=7.638 | 5401.2 samples/s | 84.4 steps/s
[Step=14400 Epoch=70.6] | Loss=0.04102 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.734 | L2-Norm(final)=7.658 | 7288.6 samples/s | 113.9 steps/s
[Step=14450 Epoch=70.9] | Loss=0.04038 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.779 | L2-Norm(final)=7.679 | 1939.3 samples/s | 30.3 steps/s
[Step=14500 Epoch=71.1] | Loss=0.03999 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.825 | L2-Norm(final)=7.702 | 5508.0 samples/s | 86.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=71.1] | Loss=0.01587 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.290 | L2-Norm(final)=7.942 | 3953.3 samples/s | 61.8 steps/s
[Step=14550 Epoch=71.4] | Loss=0.03725 | Reg=0.00235 | acc=0.9531 | L2-Norm=15.338 | L2-Norm(final)=7.961 | 4523.4 samples/s | 70.7 steps/s
[Step=14600 Epoch=71.6] | Loss=0.03895 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.379 | L2-Norm(final)=7.963 | 4859.2 samples/s | 75.9 steps/s
[Step=14650 Epoch=71.8] | Loss=0.03956 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.413 | L2-Norm(final)=7.959 | 4740.2 samples/s | 74.1 steps/s
[Step=14700 Epoch=72.1] | Loss=0.03832 | Reg=0.00239 | acc=0.9375 | L2-Norm=15.443 | L2-Norm(final)=7.957 | 6542.6 samples/s | 102.2 steps/s
[Step=14750 Epoch=72.3] | Loss=0.03403 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.468 | L2-Norm(final)=7.955 | 1821.3 samples/s | 28.5 steps/s
[Step=14800 Epoch=72.6] | Loss=0.03091 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.487 | L2-Norm(final)=7.957 | 4916.7 samples/s | 76.8 steps/s
[Step=14850 Epoch=72.8] | Loss=0.02894 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.502 | L2-Norm(final)=7.960 | 4940.3 samples/s | 77.2 steps/s
[Step=14900 Epoch=73.1] | Loss=0.02729 | Reg=0.00241 | acc=0.9219 | L2-Norm=15.515 | L2-Norm(final)=7.964 | 6324.3 samples/s | 98.8 steps/s
[Step=14950 Epoch=73.3] | Loss=0.02544 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.529 | L2-Norm(final)=7.967 | 1861.3 samples/s | 29.1 steps/s
[Step=15000 Epoch=73.6] | Loss=0.02413 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.540 | L2-Norm(final)=7.970 | 4901.1 samples/s | 76.6 steps/s
[Step=15050 Epoch=73.8] | Loss=0.02281 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.550 | L2-Norm(final)=7.973 | 4845.6 samples/s | 75.7 steps/s
[Step=15100 Epoch=74.0] | Loss=0.02204 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.558 | L2-Norm(final)=7.976 | 6013.0 samples/s | 94.0 steps/s
[Step=15150 Epoch=74.3] | Loss=0.02106 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.565 | L2-Norm(final)=7.979 | 1905.3 samples/s | 29.8 steps/s
[Step=15200 Epoch=74.5] | Loss=0.02008 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.571 | L2-Norm(final)=7.982 | 4925.1 samples/s | 77.0 steps/s
[Step=15250 Epoch=74.8] | Loss=0.01921 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.576 | L2-Norm(final)=7.985 | 4900.5 samples/s | 76.6 steps/s
[Step=15300 Epoch=75.0] | Loss=0.01852 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.580 | L2-Norm(final)=7.988 | 5705.2 samples/s | 89.1 steps/s
[Step=15350 Epoch=75.3] | Loss=0.01783 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.584 | L2-Norm(final)=7.991 | 1931.5 samples/s | 30.2 steps/s
[Step=15400 Epoch=75.5] | Loss=0.01726 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.588 | L2-Norm(final)=7.994 | 4941.7 samples/s | 77.2 steps/s
[Step=15450 Epoch=75.8] | Loss=0.01672 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.590 | L2-Norm(final)=7.997 | 4909.6 samples/s | 76.7 steps/s
[Step=15500 Epoch=76.0] | Loss=0.01621 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.593 | L2-Norm(final)=8.000 | 5556.2 samples/s | 86.8 steps/s
[Step=15550 Epoch=76.3] | Loss=0.01572 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.595 | L2-Norm(final)=8.003 | 1970.9 samples/s | 30.8 steps/s
[Step=15600 Epoch=76.5] | Loss=0.01522 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.596 | L2-Norm(final)=8.006 | 4925.5 samples/s | 77.0 steps/s
[Step=15650 Epoch=76.7] | Loss=0.01483 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.597 | L2-Norm(final)=8.009 | 4907.9 samples/s | 76.7 steps/s
[Step=15700 Epoch=77.0] | Loss=0.01440 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.598 | L2-Norm(final)=8.012 | 5281.1 samples/s | 82.5 steps/s
[Step=15750 Epoch=77.2] | Loss=0.01409 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.598 | L2-Norm(final)=8.014 | 2010.5 samples/s | 31.4 steps/s
[Step=15800 Epoch=77.5] | Loss=0.01377 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.598 | L2-Norm(final)=8.016 | 4862.3 samples/s | 76.0 steps/s
[Step=15850 Epoch=77.7] | Loss=0.01346 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.598 | L2-Norm(final)=8.019 | 4688.6 samples/s | 73.3 steps/s
[Step=15900 Epoch=78.0] | Loss=0.01313 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.598 | L2-Norm(final)=8.021 | 5001.9 samples/s | 78.2 steps/s
[Step=15950 Epoch=78.2] | Loss=0.01283 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.597 | L2-Norm(final)=8.023 | 2005.4 samples/s | 31.3 steps/s
[Step=16000 Epoch=78.5] | Loss=0.01260 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.596 | L2-Norm(final)=8.026 | 4992.3 samples/s | 78.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step16000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=6001 Epoch=56.9] | Loss=0.01404 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.360 | L2-Norm(final)=4.663 | 3776.2 samples/s | 59.0 steps/s
[Step=6050 Epoch=57.3] | Loss=0.01273 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.568 | L2-Norm(final)=4.693 | 5159.4 samples/s | 80.6 steps/s
[Step=6100 Epoch=57.8] | Loss=0.00943 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.676 | L2-Norm(final)=4.735 | 7309.5 samples/s | 114.2 steps/s
[Step=6150 Epoch=58.3] | Loss=0.00713 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.744 | L2-Norm(final)=4.773 | 1841.8 samples/s | 28.8 steps/s
[Step=6200 Epoch=58.8] | Loss=0.00588 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.792 | L2-Norm(final)=4.808 | 6819.8 samples/s | 106.6 steps/s
[Step=6250 Epoch=59.2] | Loss=0.00499 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.827 | L2-Norm(final)=4.839 | 1901.6 samples/s | 29.7 steps/s
[Step=6300 Epoch=59.7] | Loss=0.00437 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.853 | L2-Norm(final)=4.869 | 6169.2 samples/s | 96.4 steps/s
[Step=6350 Epoch=60.2] | Loss=0.00387 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.874 | L2-Norm(final)=4.896 | 1929.0 samples/s | 30.1 steps/s
[Step=6400 Epoch=60.6] | Loss=0.00350 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.890 | L2-Norm(final)=4.922 | 5804.7 samples/s | 90.7 steps/s
[Step=6450 Epoch=61.1] | Loss=0.00320 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.901 | L2-Norm(final)=4.946 | 1979.5 samples/s | 30.9 steps/s
[Step=6500 Epoch=61.6] | Loss=0.00294 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.910 | L2-Norm(final)=4.969 | 5361.7 samples/s | 83.8 steps/s
All layers training...
LR=0.00050, len=1
[Step=6501 Epoch=61.6] | Loss=0.00022 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.982 | L2-Norm(final)=5.193 | 3722.7 samples/s | 58.2 steps/s
[Step=6550 Epoch=62.1] | Loss=0.00042 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.963 | L2-Norm(final)=5.207 | 4598.8 samples/s | 71.9 steps/s
[Step=6600 Epoch=62.5] | Loss=0.00356 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.958 | L2-Norm(final)=5.214 | 6168.0 samples/s | 96.4 steps/s
[Step=6650 Epoch=63.0] | Loss=0.00679 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.006 | L2-Norm(final)=5.199 | 1812.6 samples/s | 28.3 steps/s
[Step=6700 Epoch=63.5] | Loss=0.00616 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.057 | L2-Norm(final)=5.180 | 5806.8 samples/s | 90.7 steps/s
[Step=6750 Epoch=64.0] | Loss=0.00505 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.083 | L2-Norm(final)=5.170 | 1846.0 samples/s | 28.8 steps/s
[Step=6800 Epoch=64.4] | Loss=0.00422 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.095 | L2-Norm(final)=5.164 | 5417.9 samples/s | 84.7 steps/s
[Step=6850 Epoch=64.9] | Loss=0.00362 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.096 | L2-Norm(final)=5.160 | 1882.2 samples/s | 29.4 steps/s
[Step=6900 Epoch=65.4] | Loss=0.00317 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.091 | L2-Norm(final)=5.157 | 4912.1 samples/s | 76.8 steps/s
[Step=6950 Epoch=65.9] | Loss=0.00282 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.081 | L2-Norm(final)=5.156 | 1919.4 samples/s | 30.0 steps/s
[Step=7000 Epoch=66.3] | Loss=0.00254 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.069 | L2-Norm(final)=5.154 | 4806.8 samples/s | 75.1 steps/s
[Step=7050 Epoch=66.8] | Loss=0.00231 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.055 | L2-Norm(final)=5.153 | 1977.3 samples/s | 30.9 steps/s
[Step=7100 Epoch=67.3] | Loss=0.00212 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.040 | L2-Norm(final)=5.153 | 4777.7 samples/s | 74.7 steps/s
[Step=7150 Epoch=67.8] | Loss=0.00196 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.023 | L2-Norm(final)=5.152 | 1966.5 samples/s | 30.7 steps/s
[Step=7200 Epoch=68.2] | Loss=0.00182 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.005 | L2-Norm(final)=5.152 | 4624.9 samples/s | 72.3 steps/s
[Step=7250 Epoch=68.7] | Loss=0.00170 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.986 | L2-Norm(final)=5.151 | 1983.2 samples/s | 31.0 steps/s
[Step=7300 Epoch=69.2] | Loss=0.00159 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.967 | L2-Norm(final)=5.151 | 4681.4 samples/s | 73.1 steps/s
[Step=7350 Epoch=69.6] | Loss=0.00150 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.947 | L2-Norm(final)=5.151 | 1993.8 samples/s | 31.2 steps/s
[Step=7400 Epoch=70.1] | Loss=0.00142 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.927 | L2-Norm(final)=5.151 | 4672.7 samples/s | 73.0 steps/s
[Step=7450 Epoch=70.6] | Loss=0.00134 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.906 | L2-Norm(final)=5.151 | 6353.5 samples/s | 99.3 steps/s
[Step=7500 Epoch=71.1] | Loss=0.00128 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.885 | L2-Norm(final)=5.152 | 1778.2 samples/s | 27.8 steps/s
[Step=7550 Epoch=71.5] | Loss=0.00122 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.863 | L2-Norm(final)=5.152 | 5935.2 samples/s | 92.7 steps/s
[Step=7600 Epoch=72.0] | Loss=0.00116 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.842 | L2-Norm(final)=5.152 | 1825.7 samples/s | 28.5 steps/s
[Step=7650 Epoch=72.5] | Loss=0.00111 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.820 | L2-Norm(final)=5.152 | 5549.3 samples/s | 86.7 steps/s
[Step=7700 Epoch=73.0] | Loss=0.00107 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.798 | L2-Norm(final)=5.153 | 1880.7 samples/s | 29.4 steps/s
[Step=7750 Epoch=73.4] | Loss=0.00102 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.776 | L2-Norm(final)=5.153 | 5233.2 samples/s | 81.8 steps/s
[Step=7800 Epoch=73.9] | Loss=0.00098 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.753 | L2-Norm(final)=5.153 | 1897.8 samples/s | 29.7 steps/s
[Step=7850 Epoch=74.4] | Loss=0.00095 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.730 | L2-Norm(final)=5.154 | 4827.1 samples/s | 75.4 steps/s
[Step=7900 Epoch=74.9] | Loss=0.00091 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.708 | L2-Norm(final)=5.154 | 1957.4 samples/s | 30.6 steps/s
[Step=7950 Epoch=75.3] | Loss=0.00088 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.685 | L2-Norm(final)=5.154 | 4753.3 samples/s | 74.3 steps/s
[Step=8000 Epoch=75.8] | Loss=0.00085 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.662 | L2-Norm(final)=5.155 | 1975.2 samples/s | 30.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_0/client_state-step8000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=4001 Epoch=38.1] | Loss=0.05541 | Reg=0.00206 | acc=0.9531 | L2-Norm=14.360 | L2-Norm(final)=4.783 | 4021.2 samples/s | 62.8 steps/s
[Step=4050 Epoch=38.6] | Loss=0.01610 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.522 | L2-Norm(final)=4.843 | 4639.6 samples/s | 72.5 steps/s
[Step=4100 Epoch=39.1] | Loss=0.01256 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.647 | L2-Norm(final)=4.892 | 7482.1 samples/s | 116.9 steps/s
[Step=4150 Epoch=39.6] | Loss=0.01001 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.740 | L2-Norm(final)=4.933 | 1818.5 samples/s | 28.4 steps/s
[Step=4200 Epoch=40.0] | Loss=0.00858 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.813 | L2-Norm(final)=4.970 | 6917.5 samples/s | 108.1 steps/s
[Step=4250 Epoch=40.5] | Loss=0.00740 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.876 | L2-Norm(final)=5.004 | 1882.2 samples/s | 29.4 steps/s
[Step=4300 Epoch=41.0] | Loss=0.00660 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.928 | L2-Norm(final)=5.035 | 6421.8 samples/s | 100.3 steps/s
[Step=4350 Epoch=41.5] | Loss=0.00599 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.973 | L2-Norm(final)=5.065 | 1925.1 samples/s | 30.1 steps/s
[Step=4400 Epoch=41.9] | Loss=0.00546 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.012 | L2-Norm(final)=5.092 | 5976.8 samples/s | 93.4 steps/s
[Step=4450 Epoch=42.4] | Loss=0.00505 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.046 | L2-Norm(final)=5.119 | 1963.9 samples/s | 30.7 steps/s
[Step=4500 Epoch=42.9] | Loss=0.00468 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.077 | L2-Norm(final)=5.144 | 5731.1 samples/s | 89.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=4501 Epoch=42.9] | Loss=0.00072 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.371 | L2-Norm(final)=5.395 | 3800.1 samples/s | 59.4 steps/s
[Step=4550 Epoch=43.4] | Loss=0.00158 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.375 | L2-Norm(final)=5.411 | 4352.6 samples/s | 68.0 steps/s
[Step=4600 Epoch=43.8] | Loss=0.00444 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.392 | L2-Norm(final)=5.416 | 6393.3 samples/s | 99.9 steps/s
[Step=4650 Epoch=44.3] | Loss=0.00367 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.417 | L2-Norm(final)=5.420 | 1796.9 samples/s | 28.1 steps/s
[Step=4700 Epoch=44.8] | Loss=0.00281 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.421 | L2-Norm(final)=5.423 | 5996.0 samples/s | 93.7 steps/s
[Step=4750 Epoch=45.3] | Loss=0.00227 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.413 | L2-Norm(final)=5.427 | 1814.7 samples/s | 28.4 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00190 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.399 | L2-Norm(final)=5.429 | 5672.4 samples/s | 88.6 steps/s
[Step=4850 Epoch=46.2] | Loss=0.00163 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.382 | L2-Norm(final)=5.432 | 1868.1 samples/s | 29.2 steps/s
[Step=4900 Epoch=46.7] | Loss=0.00143 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.362 | L2-Norm(final)=5.434 | 5184.3 samples/s | 81.0 steps/s
[Step=4950 Epoch=47.2] | Loss=0.00128 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.341 | L2-Norm(final)=5.435 | 1895.7 samples/s | 29.6 steps/s
[Step=5000 Epoch=47.7] | Loss=0.00115 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.319 | L2-Norm(final)=5.437 | 4983.0 samples/s | 77.9 steps/s
[Step=5050 Epoch=48.1] | Loss=0.00105 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.297 | L2-Norm(final)=5.438 | 1919.9 samples/s | 30.0 steps/s
[Step=5100 Epoch=48.6] | Loss=0.00096 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.274 | L2-Norm(final)=5.440 | 4713.1 samples/s | 73.6 steps/s
[Step=5150 Epoch=49.1] | Loss=0.00089 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.250 | L2-Norm(final)=5.441 | 1974.5 samples/s | 30.9 steps/s
[Step=5200 Epoch=49.6] | Loss=0.00083 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.227 | L2-Norm(final)=5.442 | 4712.0 samples/s | 73.6 steps/s
[Step=5250 Epoch=50.0] | Loss=0.00078 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.203 | L2-Norm(final)=5.443 | 1984.8 samples/s | 31.0 steps/s
[Step=5300 Epoch=50.5] | Loss=0.00073 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.179 | L2-Norm(final)=5.444 | 4643.0 samples/s | 72.5 steps/s
[Step=5350 Epoch=51.0] | Loss=0.00069 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.155 | L2-Norm(final)=5.446 | 1991.6 samples/s | 31.1 steps/s
[Step=5400 Epoch=51.5] | Loss=0.00065 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.131 | L2-Norm(final)=5.447 | 4659.5 samples/s | 72.8 steps/s
[Step=5450 Epoch=51.9] | Loss=0.00062 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.107 | L2-Norm(final)=5.448 | 1983.3 samples/s | 31.0 steps/s
[Step=5500 Epoch=52.4] | Loss=0.00059 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.083 | L2-Norm(final)=5.449 | 4660.5 samples/s | 72.8 steps/s
[Step=5550 Epoch=52.9] | Loss=0.00056 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.058 | L2-Norm(final)=5.450 | 6867.3 samples/s | 107.3 steps/s
[Step=5600 Epoch=53.4] | Loss=0.00053 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.034 | L2-Norm(final)=5.450 | 1724.1 samples/s | 26.9 steps/s
[Step=5650 Epoch=53.8] | Loss=0.00051 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.010 | L2-Norm(final)=5.451 | 6420.4 samples/s | 100.3 steps/s
[Step=5700 Epoch=54.3] | Loss=0.00049 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.985 | L2-Norm(final)=5.452 | 1781.6 samples/s | 27.8 steps/s
[Step=5750 Epoch=54.8] | Loss=0.00047 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.961 | L2-Norm(final)=5.453 | 6001.6 samples/s | 93.8 steps/s
[Step=5800 Epoch=55.3] | Loss=0.00045 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.936 | L2-Norm(final)=5.454 | 1827.0 samples/s | 28.5 steps/s
[Step=5850 Epoch=55.8] | Loss=0.00044 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.912 | L2-Norm(final)=5.455 | 5487.7 samples/s | 85.7 steps/s
[Step=5900 Epoch=56.2] | Loss=0.00042 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.887 | L2-Norm(final)=5.456 | 1859.7 samples/s | 29.1 steps/s
[Step=5950 Epoch=56.7] | Loss=0.00041 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.863 | L2-Norm(final)=5.457 | 5333.4 samples/s | 83.3 steps/s
[Step=6000 Epoch=57.2] | Loss=0.00040 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.838 | L2-Norm(final)=5.458 | 1885.0 samples/s | 29.5 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step6000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10993 | acc=0.9478 | tpr=0.9521 | fpr=0.0614 | 4429.8 samples/s | 17.3 steps/s
Avg test loss: 0.11817, Avg test acc: 0.94555, Avg tpr: 0.95017, Avg fpr: 0.06461, total FA: 504

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10790 | acc=0.9513 | tpr=0.9626 | fpr=0.0731 | 4429.6 samples/s | 17.3 steps/s
Avg test loss: 0.11095, Avg test acc: 0.95116, Avg tpr: 0.96363, Avg fpr: 0.07627, total FA: 595

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11160 | acc=0.9495 | tpr=0.9716 | fpr=0.0984 | 4369.1 samples/s | 17.1 steps/s
Avg test loss: 0.11819, Avg test acc: 0.94727, Avg tpr: 0.96835, Avg fpr: 0.09909, total FA: 773

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.13963 | acc=0.9348 | tpr=0.9359 | fpr=0.0674 | 4330.8 samples/s | 16.9 steps/s
Avg test loss: 0.14651, Avg test acc: 0.93181, Avg tpr: 0.93227, Avg fpr: 0.06922, total FA: 540

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10352 | acc=0.9525 | tpr=0.9676 | fpr=0.0803 | 4351.5 samples/s | 17.0 steps/s
Avg test loss: 0.10937, Avg test acc: 0.95124, Avg tpr: 0.96649, Avg fpr: 0.08230, total FA: 642

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.14314 | acc=0.3084 | tpr=0.0027 | fpr=0.0278 | 4383.7 samples/s | 17.1 steps/s
Avg test loss: 4.16161, Avg test acc: 0.30523, Avg tpr: 0.00321, Avg fpr: 0.03051, total FA: 238

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.22583 | acc=0.3117 | tpr=0.0021 | fpr=0.0159 | 4403.8 samples/s | 17.2 steps/s
Avg test loss: 4.23372, Avg test acc: 0.30960, Avg tpr: 0.00204, Avg fpr: 0.01397, total FA: 109

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.11046 | acc=0.2988 | tpr=0.0065 | fpr=0.0667 | 4331.5 samples/s | 16.9 steps/s
Avg test loss: 4.10810, Avg test acc: 0.29842, Avg tpr: 0.00857, Avg fpr: 0.06409, total FA: 500

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.14320 | acc=0.3026 | tpr=0.0026 | fpr=0.0461 | 4403.6 samples/s | 17.2 steps/s
Avg test loss: 4.14816, Avg test acc: 0.30143, Avg tpr: 0.00373, Avg fpr: 0.04384, total FA: 342

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=3.95088 | acc=0.3115 | tpr=0.0017 | fpr=0.0159 | 4371.5 samples/s | 17.1 steps/s
Avg test loss: 3.96660, Avg test acc: 0.30900, Avg tpr: 0.00198, Avg fpr: 0.01577, total FA: 123

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.88494 | acc=0.1416 | tpr=0.6814 | fpr=0.8681 | 4312.8 samples/s | 16.8 steps/s
[Step= 100] | Loss=4.85880 | acc=0.1420 | tpr=0.6780 | fpr=0.8681 | 8835.9 samples/s | 34.5 steps/s
[Step= 150] | Loss=4.85924 | acc=0.1412 | tpr=0.6772 | fpr=0.8687 | 8336.4 samples/s | 32.6 steps/s
[Step= 200] | Loss=4.86364 | acc=0.1411 | tpr=0.6765 | fpr=0.8687 | 8714.5 samples/s | 34.0 steps/s
[Step= 250] | Loss=4.86518 | acc=0.1414 | tpr=0.6716 | fpr=0.8682 | 8674.5 samples/s | 33.9 steps/s
[Step= 300] | Loss=4.86727 | acc=0.1417 | tpr=0.6771 | fpr=0.8680 | 8456.2 samples/s | 33.0 steps/s
[Step= 350] | Loss=4.86471 | acc=0.1412 | tpr=0.6681 | fpr=0.8683 | 8423.7 samples/s | 32.9 steps/s
[Step= 400] | Loss=4.86503 | acc=0.1416 | tpr=0.6658 | fpr=0.8679 | 8742.5 samples/s | 34.2 steps/s
[Step= 450] | Loss=4.86669 | acc=0.1419 | tpr=0.6621 | fpr=0.8675 | 8781.7 samples/s | 34.3 steps/s
[Step= 500] | Loss=4.86816 | acc=0.1415 | tpr=0.6573 | fpr=0.8678 | 8173.0 samples/s | 31.9 steps/s
[Step= 550] | Loss=4.86998 | acc=0.1414 | tpr=0.6586 | fpr=0.8680 | 15334.6 samples/s | 59.9 steps/s
Avg test loss: 4.87124, Avg test acc: 0.14134, Avg tpr: 0.65887, Avg fpr: 0.86807, total FA: 120530

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.37983 | acc=0.1358 | tpr=0.7655 | fpr=0.8755 | 4434.9 samples/s | 17.3 steps/s
[Step= 100] | Loss=4.32965 | acc=0.1386 | tpr=0.6951 | fpr=0.8718 | 8354.5 samples/s | 32.6 steps/s
[Step= 150] | Loss=4.33139 | acc=0.1366 | tpr=0.6801 | fpr=0.8734 | 9141.0 samples/s | 35.7 steps/s
[Step= 200] | Loss=4.32833 | acc=0.1365 | tpr=0.6656 | fpr=0.8731 | 8027.8 samples/s | 31.4 steps/s
[Step= 250] | Loss=4.32832 | acc=0.1365 | tpr=0.6672 | fpr=0.8732 | 8669.0 samples/s | 33.9 steps/s
[Step= 300] | Loss=4.33138 | acc=0.1359 | tpr=0.6735 | fpr=0.8739 | 8669.8 samples/s | 33.9 steps/s
[Step= 350] | Loss=4.32919 | acc=0.1361 | tpr=0.6700 | fpr=0.8736 | 8465.6 samples/s | 33.1 steps/s
[Step= 400] | Loss=4.32900 | acc=0.1358 | tpr=0.6718 | fpr=0.8740 | 8600.3 samples/s | 33.6 steps/s
[Step= 450] | Loss=4.33517 | acc=0.1355 | tpr=0.6670 | fpr=0.8742 | 8521.0 samples/s | 33.3 steps/s
[Step= 500] | Loss=4.33741 | acc=0.1349 | tpr=0.6634 | fpr=0.8746 | 8637.6 samples/s | 33.7 steps/s
[Step= 550] | Loss=4.33907 | acc=0.1345 | tpr=0.6665 | fpr=0.8752 | 15231.4 samples/s | 59.5 steps/s
Avg test loss: 4.34017, Avg test acc: 0.13440, Avg tpr: 0.66719, Avg fpr: 0.87529, total FA: 121532

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.90099 | acc=0.0963 | tpr=0.8142 | fpr=0.9166 | 4341.8 samples/s | 17.0 steps/s
[Step= 100] | Loss=5.86143 | acc=0.0997 | tpr=0.8060 | fpr=0.9135 | 8655.3 samples/s | 33.8 steps/s
[Step= 150] | Loss=5.86781 | acc=0.0995 | tpr=0.8184 | fpr=0.9137 | 8933.3 samples/s | 34.9 steps/s
[Step= 200] | Loss=5.86611 | acc=0.0992 | tpr=0.8186 | fpr=0.9139 | 8736.8 samples/s | 34.1 steps/s
[Step= 250] | Loss=5.86720 | acc=0.0996 | tpr=0.8175 | fpr=0.9135 | 8188.3 samples/s | 32.0 steps/s
[Step= 300] | Loss=5.86908 | acc=0.0993 | tpr=0.8218 | fpr=0.9139 | 8489.7 samples/s | 33.2 steps/s
[Step= 350] | Loss=5.86617 | acc=0.0991 | tpr=0.8140 | fpr=0.9139 | 8640.2 samples/s | 33.8 steps/s
[Step= 400] | Loss=5.86770 | acc=0.0993 | tpr=0.8156 | fpr=0.9137 | 8708.9 samples/s | 34.0 steps/s
[Step= 450] | Loss=5.87133 | acc=0.0990 | tpr=0.8116 | fpr=0.9139 | 8594.9 samples/s | 33.6 steps/s
[Step= 500] | Loss=5.87527 | acc=0.0992 | tpr=0.8150 | fpr=0.9137 | 8399.0 samples/s | 32.8 steps/s
[Step= 550] | Loss=5.87746 | acc=0.0993 | tpr=0.8213 | fpr=0.9139 | 16041.6 samples/s | 62.7 steps/s
Avg test loss: 5.87897, Avg test acc: 0.09921, Avg tpr: 0.82132, Avg fpr: 0.91391, total FA: 126895

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.28787 | acc=0.1722 | tpr=0.5664 | fpr=0.8349 | 4386.1 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.26021 | acc=0.1717 | tpr=0.5565 | fpr=0.8355 | 8590.2 samples/s | 33.6 steps/s
[Step= 150] | Loss=4.25884 | acc=0.1714 | tpr=0.5576 | fpr=0.8357 | 8481.4 samples/s | 33.1 steps/s
[Step= 200] | Loss=4.25417 | acc=0.1710 | tpr=0.5486 | fpr=0.8358 | 8759.2 samples/s | 34.2 steps/s
[Step= 250] | Loss=4.25814 | acc=0.1718 | tpr=0.5502 | fpr=0.8351 | 8392.7 samples/s | 32.8 steps/s
[Step= 300] | Loss=4.25706 | acc=0.1714 | tpr=0.5571 | fpr=0.8357 | 8793.1 samples/s | 34.3 steps/s
[Step= 350] | Loss=4.25467 | acc=0.1714 | tpr=0.5554 | fpr=0.8356 | 8574.3 samples/s | 33.5 steps/s
[Step= 400] | Loss=4.25780 | acc=0.1711 | tpr=0.5438 | fpr=0.8357 | 8488.5 samples/s | 33.2 steps/s
[Step= 450] | Loss=4.26166 | acc=0.1713 | tpr=0.5463 | fpr=0.8355 | 8623.6 samples/s | 33.7 steps/s
[Step= 500] | Loss=4.26241 | acc=0.1707 | tpr=0.5414 | fpr=0.8360 | 8440.8 samples/s | 33.0 steps/s
[Step= 550] | Loss=4.26358 | acc=0.1706 | tpr=0.5404 | fpr=0.8362 | 15473.0 samples/s | 60.4 steps/s
Avg test loss: 4.26415, Avg test acc: 0.17052, Avg tpr: 0.54081, Avg fpr: 0.83621, total FA: 116106

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.95550 | acc=0.1203 | tpr=0.7522 | fpr=0.8910 | 4336.2 samples/s | 16.9 steps/s
[Step= 100] | Loss=4.92144 | acc=0.1220 | tpr=0.7122 | fpr=0.8891 | 8499.8 samples/s | 33.2 steps/s
[Step= 150] | Loss=4.92463 | acc=0.1209 | tpr=0.7176 | fpr=0.8901 | 8885.2 samples/s | 34.7 steps/s
[Step= 200] | Loss=4.92012 | acc=0.1213 | tpr=0.7158 | fpr=0.8895 | 8603.8 samples/s | 33.6 steps/s
[Step= 250] | Loss=4.91908 | acc=0.1207 | tpr=0.7179 | fpr=0.8902 | 8390.1 samples/s | 32.8 steps/s
[Step= 300] | Loss=4.91851 | acc=0.1206 | tpr=0.7200 | fpr=0.8903 | 8656.7 samples/s | 33.8 steps/s
[Step= 350] | Loss=4.91826 | acc=0.1208 | tpr=0.7170 | fpr=0.8900 | 8781.9 samples/s | 34.3 steps/s
[Step= 400] | Loss=4.91668 | acc=0.1212 | tpr=0.7210 | fpr=0.8897 | 8571.1 samples/s | 33.5 steps/s
[Step= 450] | Loss=4.91856 | acc=0.1210 | tpr=0.7123 | fpr=0.8898 | 8572.3 samples/s | 33.5 steps/s
[Step= 500] | Loss=4.92143 | acc=0.1208 | tpr=0.7106 | fpr=0.8898 | 8418.0 samples/s | 32.9 steps/s
[Step= 550] | Loss=4.92277 | acc=0.1206 | tpr=0.7135 | fpr=0.8902 | 15750.8 samples/s | 61.5 steps/s
Avg test loss: 4.92511, Avg test acc: 0.12050, Avg tpr: 0.71395, Avg fpr: 0.89029, total FA: 123615

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09306 | acc=0.9815 | tpr=0.8982 | fpr=0.0170 | 4349.3 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.09512 | acc=0.9811 | tpr=0.9211 | fpr=0.0178 | 8653.1 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.09822 | acc=0.9803 | tpr=0.9222 | fpr=0.0186 | 8795.6 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.10022 | acc=0.9801 | tpr=0.9180 | fpr=0.0188 | 8533.5 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.09931 | acc=0.9802 | tpr=0.9188 | fpr=0.0187 | 8817.8 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.10048 | acc=0.9800 | tpr=0.9200 | fpr=0.0189 | 8314.8 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.10120 | acc=0.9797 | tpr=0.9186 | fpr=0.0192 | 8775.2 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.10190 | acc=0.9796 | tpr=0.9141 | fpr=0.0193 | 8487.6 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.10450 | acc=0.9792 | tpr=0.9133 | fpr=0.0196 | 8513.1 samples/s | 33.3 steps/s
[Step= 500] | Loss=0.10387 | acc=0.9793 | tpr=0.9145 | fpr=0.0195 | 8540.6 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.10309 | acc=0.9794 | tpr=0.9152 | fpr=0.0194 | 15713.7 samples/s | 61.4 steps/s
Avg test loss: 0.10301, Avg test acc: 0.97943, Avg tpr: 0.91521, Avg fpr: 0.01940, total FA: 2694

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10875 | acc=0.9818 | tpr=0.8717 | fpr=0.0162 | 4314.9 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.11622 | acc=0.9814 | tpr=0.8891 | fpr=0.0169 | 8687.2 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.11950 | acc=0.9808 | tpr=0.8948 | fpr=0.0176 | 8608.7 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.12145 | acc=0.9808 | tpr=0.8929 | fpr=0.0176 | 8413.0 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.12075 | acc=0.9808 | tpr=0.8891 | fpr=0.0175 | 8740.1 samples/s | 34.1 steps/s
[Step= 300] | Loss=0.12256 | acc=0.9806 | tpr=0.8887 | fpr=0.0177 | 8491.1 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.12296 | acc=0.9804 | tpr=0.8917 | fpr=0.0180 | 8751.0 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.12472 | acc=0.9801 | tpr=0.8862 | fpr=0.0182 | 8333.0 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.12810 | acc=0.9798 | tpr=0.8851 | fpr=0.0184 | 8825.4 samples/s | 34.5 steps/s
[Step= 500] | Loss=0.12742 | acc=0.9799 | tpr=0.8872 | fpr=0.0184 | 8405.5 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.12690 | acc=0.9800 | tpr=0.8862 | fpr=0.0183 | 15543.5 samples/s | 60.7 steps/s
Avg test loss: 0.12673, Avg test acc: 0.97999, Avg tpr: 0.88550, Avg fpr: 0.01829, total FA: 2540

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10167 | acc=0.9803 | tpr=0.9381 | fpr=0.0189 | 4363.8 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.10588 | acc=0.9796 | tpr=0.9339 | fpr=0.0195 | 8464.3 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.10878 | acc=0.9786 | tpr=0.9337 | fpr=0.0205 | 8497.3 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.11143 | acc=0.9784 | tpr=0.9355 | fpr=0.0208 | 8500.2 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.11075 | acc=0.9783 | tpr=0.9345 | fpr=0.0209 | 8757.3 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.11213 | acc=0.9781 | tpr=0.9360 | fpr=0.0211 | 8592.3 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.11230 | acc=0.9779 | tpr=0.9361 | fpr=0.0213 | 8573.0 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.11380 | acc=0.9777 | tpr=0.9333 | fpr=0.0215 | 8584.7 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.11650 | acc=0.9774 | tpr=0.9314 | fpr=0.0218 | 8668.4 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.11610 | acc=0.9774 | tpr=0.9330 | fpr=0.0218 | 8617.5 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.11506 | acc=0.9776 | tpr=0.9343 | fpr=0.0216 | 15663.5 samples/s | 61.2 steps/s
Avg test loss: 0.11490, Avg test acc: 0.97759, Avg tpr: 0.93384, Avg fpr: 0.02161, total FA: 3001

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10929 | acc=0.9807 | tpr=0.8982 | fpr=0.0178 | 4341.0 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.11420 | acc=0.9802 | tpr=0.9211 | fpr=0.0187 | 8789.3 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.11818 | acc=0.9794 | tpr=0.9236 | fpr=0.0196 | 8604.9 samples/s | 33.6 steps/s
[Step= 200] | Loss=0.12178 | acc=0.9792 | tpr=0.9301 | fpr=0.0199 | 8393.5 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.12031 | acc=0.9792 | tpr=0.9275 | fpr=0.0198 | 8502.3 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.12205 | acc=0.9790 | tpr=0.9302 | fpr=0.0201 | 8980.3 samples/s | 35.1 steps/s
[Step= 350] | Loss=0.12190 | acc=0.9789 | tpr=0.9311 | fpr=0.0202 | 8440.1 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.12317 | acc=0.9787 | tpr=0.9256 | fpr=0.0203 | 8629.7 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.12612 | acc=0.9783 | tpr=0.9241 | fpr=0.0207 | 8456.5 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.12538 | acc=0.9783 | tpr=0.9256 | fpr=0.0207 | 8765.1 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.12440 | acc=0.9785 | tpr=0.9264 | fpr=0.0206 | 14399.8 samples/s | 56.2 steps/s
Avg test loss: 0.12418, Avg test acc: 0.97848, Avg tpr: 0.92552, Avg fpr: 0.02055, total FA: 2854

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10046 | acc=0.9791 | tpr=0.8761 | fpr=0.0191 | 4367.8 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.10477 | acc=0.9791 | tpr=0.8977 | fpr=0.0193 | 8625.1 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.10863 | acc=0.9784 | tpr=0.9049 | fpr=0.0202 | 8426.4 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.11133 | acc=0.9782 | tpr=0.9060 | fpr=0.0205 | 8720.5 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.11042 | acc=0.9781 | tpr=0.9074 | fpr=0.0207 | 8695.7 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.11237 | acc=0.9777 | tpr=0.9047 | fpr=0.0209 | 8826.0 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.11263 | acc=0.9776 | tpr=0.9048 | fpr=0.0211 | 8064.7 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.11379 | acc=0.9775 | tpr=0.9021 | fpr=0.0211 | 8974.3 samples/s | 35.1 steps/s
[Step= 450] | Loss=0.11626 | acc=0.9772 | tpr=0.9012 | fpr=0.0215 | 8305.1 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.11573 | acc=0.9773 | tpr=0.9022 | fpr=0.0213 | 8475.1 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.11509 | acc=0.9774 | tpr=0.9005 | fpr=0.0212 | 15683.2 samples/s | 61.3 steps/s
Avg test loss: 0.11485, Avg test acc: 0.97741, Avg tpr: 0.89976, Avg fpr: 0.02118, total FA: 2941

server round 12/50

clients selected: [0 1 3 7 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=14001 Epoch=68.3] | Loss=0.01863 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.035 | L2-Norm(final)=7.270 | 3702.4 samples/s | 57.8 steps/s
[Step=14050 Epoch=68.5] | Loss=0.04927 | Reg=0.00199 | acc=0.9531 | L2-Norm=14.099 | L2-Norm(final)=7.254 | 5465.6 samples/s | 85.4 steps/s
[Step=14100 Epoch=68.8] | Loss=0.04916 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.177 | L2-Norm(final)=7.253 | 5616.8 samples/s | 87.8 steps/s
[Step=14150 Epoch=69.0] | Loss=0.04594 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.240 | L2-Norm(final)=7.263 | 5439.7 samples/s | 85.0 steps/s
[Step=14200 Epoch=69.2] | Loss=0.04579 | Reg=0.00204 | acc=0.9688 | L2-Norm=14.291 | L2-Norm(final)=7.276 | 7827.1 samples/s | 122.3 steps/s
[Step=14250 Epoch=69.5] | Loss=0.04416 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.336 | L2-Norm(final)=7.285 | 1902.6 samples/s | 29.7 steps/s
[Step=14300 Epoch=69.7] | Loss=0.04245 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.381 | L2-Norm(final)=7.299 | 5574.7 samples/s | 87.1 steps/s
[Step=14350 Epoch=70.0] | Loss=0.04084 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.428 | L2-Norm(final)=7.318 | 5590.7 samples/s | 87.4 steps/s
[Step=14400 Epoch=70.2] | Loss=0.04014 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.476 | L2-Norm(final)=7.341 | 6918.7 samples/s | 108.1 steps/s
[Step=14450 Epoch=70.5] | Loss=0.03903 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.525 | L2-Norm(final)=7.364 | 1961.4 samples/s | 30.6 steps/s
[Step=14500 Epoch=70.7] | Loss=0.03816 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.573 | L2-Norm(final)=7.390 | 5599.2 samples/s | 87.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=70.7] | Loss=0.02766 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.063 | L2-Norm(final)=7.652 | 3914.4 samples/s | 61.2 steps/s
[Step=14550 Epoch=70.9] | Loss=0.03633 | Reg=0.00229 | acc=0.9062 | L2-Norm=15.119 | L2-Norm(final)=7.672 | 4559.2 samples/s | 71.2 steps/s
[Step=14600 Epoch=71.2] | Loss=0.04085 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.173 | L2-Norm(final)=7.673 | 4797.1 samples/s | 75.0 steps/s
[Step=14650 Epoch=71.4] | Loss=0.04435 | Reg=0.00232 | acc=0.9531 | L2-Norm=15.223 | L2-Norm(final)=7.664 | 4742.9 samples/s | 74.1 steps/s
[Step=14700 Epoch=71.7] | Loss=0.04249 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.263 | L2-Norm(final)=7.655 | 6494.3 samples/s | 101.5 steps/s
[Step=14750 Epoch=71.9] | Loss=0.03873 | Reg=0.00234 | acc=0.9844 | L2-Norm=15.296 | L2-Norm(final)=7.652 | 1858.8 samples/s | 29.0 steps/s
[Step=14800 Epoch=72.2] | Loss=0.03503 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.323 | L2-Norm(final)=7.654 | 4796.8 samples/s | 75.0 steps/s
[Step=14850 Epoch=72.4] | Loss=0.03324 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.345 | L2-Norm(final)=7.655 | 4851.8 samples/s | 75.8 steps/s
[Step=14900 Epoch=72.7] | Loss=0.03098 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.366 | L2-Norm(final)=7.659 | 5917.1 samples/s | 92.5 steps/s
[Step=14950 Epoch=72.9] | Loss=0.02897 | Reg=0.00237 | acc=0.9688 | L2-Norm=15.385 | L2-Norm(final)=7.663 | 1904.9 samples/s | 29.8 steps/s
[Step=15000 Epoch=73.1] | Loss=0.02717 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.400 | L2-Norm(final)=7.667 | 4778.2 samples/s | 74.7 steps/s
[Step=15050 Epoch=73.4] | Loss=0.02561 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.413 | L2-Norm(final)=7.672 | 4764.9 samples/s | 74.5 steps/s
[Step=15100 Epoch=73.6] | Loss=0.02456 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.425 | L2-Norm(final)=7.676 | 5594.4 samples/s | 87.4 steps/s
[Step=15150 Epoch=73.9] | Loss=0.02361 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.435 | L2-Norm(final)=7.679 | 1916.8 samples/s | 30.0 steps/s
[Step=15200 Epoch=74.1] | Loss=0.02258 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.444 | L2-Norm(final)=7.683 | 4754.5 samples/s | 74.3 steps/s
[Step=15250 Epoch=74.4] | Loss=0.02159 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.452 | L2-Norm(final)=7.686 | 4860.1 samples/s | 75.9 steps/s
[Step=15300 Epoch=74.6] | Loss=0.02089 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.458 | L2-Norm(final)=7.689 | 5198.0 samples/s | 81.2 steps/s
[Step=15350 Epoch=74.8] | Loss=0.01998 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.464 | L2-Norm(final)=7.692 | 1990.3 samples/s | 31.1 steps/s
[Step=15400 Epoch=75.1] | Loss=0.01933 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.470 | L2-Norm(final)=7.696 | 5002.1 samples/s | 78.2 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01867 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.474 | L2-Norm(final)=7.699 | 4873.0 samples/s | 76.1 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01803 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.479 | L2-Norm(final)=7.702 | 4964.6 samples/s | 77.6 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01756 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.482 | L2-Norm(final)=7.706 | 2005.4 samples/s | 31.3 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01701 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.485 | L2-Norm(final)=7.709 | 4924.5 samples/s | 76.9 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01651 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.488 | L2-Norm(final)=7.712 | 4816.2 samples/s | 75.3 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01609 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.490 | L2-Norm(final)=7.715 | 4873.6 samples/s | 76.2 steps/s
[Step=15750 Epoch=76.8] | Loss=0.01569 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.492 | L2-Norm(final)=7.718 | 2027.6 samples/s | 31.7 steps/s
[Step=15800 Epoch=77.0] | Loss=0.01526 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.493 | L2-Norm(final)=7.720 | 4974.6 samples/s | 77.7 steps/s
[Step=15850 Epoch=77.3] | Loss=0.01485 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.494 | L2-Norm(final)=7.723 | 4933.6 samples/s | 77.1 steps/s
[Step=15900 Epoch=77.5] | Loss=0.01448 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.494 | L2-Norm(final)=7.726 | 4950.1 samples/s | 77.3 steps/s
[Step=15950 Epoch=77.8] | Loss=0.01427 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.494 | L2-Norm(final)=7.729 | 2043.7 samples/s | 31.9 steps/s
[Step=16000 Epoch=78.0] | Loss=0.01398 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.494 | L2-Norm(final)=7.731 | 4956.0 samples/s | 77.4 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step16000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=16001 Epoch=78.1] | Loss=0.10610 | Reg=0.00197 | acc=0.9062 | L2-Norm=14.035 | L2-Norm(final)=7.043 | 3854.6 samples/s | 60.2 steps/s
[Step=16050 Epoch=78.3] | Loss=0.05613 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.083 | L2-Norm(final)=7.019 | 5349.8 samples/s | 83.6 steps/s
[Step=16100 Epoch=78.6] | Loss=0.04808 | Reg=0.00200 | acc=0.9531 | L2-Norm=14.152 | L2-Norm(final)=7.027 | 5402.3 samples/s | 84.4 steps/s
[Step=16150 Epoch=78.8] | Loss=0.04515 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.211 | L2-Norm(final)=7.045 | 5491.5 samples/s | 85.8 steps/s
[Step=16200 Epoch=79.0] | Loss=0.04373 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.265 | L2-Norm(final)=7.067 | 7547.4 samples/s | 117.9 steps/s
[Step=16250 Epoch=79.3] | Loss=0.04247 | Reg=0.00205 | acc=0.9688 | L2-Norm=14.316 | L2-Norm(final)=7.087 | 1917.6 samples/s | 30.0 steps/s
[Step=16300 Epoch=79.5] | Loss=0.04100 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.371 | L2-Norm(final)=7.109 | 5479.8 samples/s | 85.6 steps/s
[Step=16350 Epoch=79.8] | Loss=0.04014 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.424 | L2-Norm(final)=7.133 | 5589.2 samples/s | 87.3 steps/s
[Step=16400 Epoch=80.0] | Loss=0.03952 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.475 | L2-Norm(final)=7.157 | 7106.6 samples/s | 111.0 steps/s
[Step=16450 Epoch=80.3] | Loss=0.03834 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.525 | L2-Norm(final)=7.182 | 1928.0 samples/s | 30.1 steps/s
[Step=16500 Epoch=80.5] | Loss=0.03750 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.576 | L2-Norm(final)=7.209 | 5470.4 samples/s | 85.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=80.5] | Loss=0.01122 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.093 | L2-Norm(final)=7.485 | 3979.9 samples/s | 62.2 steps/s
[Step=16550 Epoch=80.8] | Loss=0.04099 | Reg=0.00230 | acc=0.9688 | L2-Norm=15.149 | L2-Norm(final)=7.505 | 4506.7 samples/s | 70.4 steps/s
[Step=16600 Epoch=81.0] | Loss=0.04925 | Reg=0.00231 | acc=0.9688 | L2-Norm=15.190 | L2-Norm(final)=7.490 | 4779.7 samples/s | 74.7 steps/s
[Step=16650 Epoch=81.2] | Loss=0.04757 | Reg=0.00232 | acc=0.9688 | L2-Norm=15.226 | L2-Norm(final)=7.476 | 4763.7 samples/s | 74.4 steps/s
[Step=16700 Epoch=81.5] | Loss=0.04494 | Reg=0.00233 | acc=0.9531 | L2-Norm=15.260 | L2-Norm(final)=7.468 | 6500.4 samples/s | 101.6 steps/s
[Step=16750 Epoch=81.7] | Loss=0.03999 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.289 | L2-Norm(final)=7.465 | 1843.6 samples/s | 28.8 steps/s
[Step=16800 Epoch=82.0] | Loss=0.03600 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.312 | L2-Norm(final)=7.466 | 4807.6 samples/s | 75.1 steps/s
[Step=16850 Epoch=82.2] | Loss=0.03401 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.331 | L2-Norm(final)=7.468 | 4849.2 samples/s | 75.8 steps/s
[Step=16900 Epoch=82.5] | Loss=0.03178 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.349 | L2-Norm(final)=7.471 | 6088.0 samples/s | 95.1 steps/s
[Step=16950 Epoch=82.7] | Loss=0.02954 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.366 | L2-Norm(final)=7.474 | 1901.4 samples/s | 29.7 steps/s
[Step=17000 Epoch=83.0] | Loss=0.02796 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.380 | L2-Norm(final)=7.477 | 4933.5 samples/s | 77.1 steps/s
[Step=17050 Epoch=83.2] | Loss=0.02637 | Reg=0.00237 | acc=0.9688 | L2-Norm=15.393 | L2-Norm(final)=7.481 | 4872.2 samples/s | 76.1 steps/s
[Step=17100 Epoch=83.4] | Loss=0.02526 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.404 | L2-Norm(final)=7.484 | 5756.9 samples/s | 90.0 steps/s
[Step=17150 Epoch=83.7] | Loss=0.02419 | Reg=0.00238 | acc=0.9688 | L2-Norm=15.413 | L2-Norm(final)=7.487 | 1916.7 samples/s | 29.9 steps/s
[Step=17200 Epoch=83.9] | Loss=0.02308 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.422 | L2-Norm(final)=7.490 | 4786.4 samples/s | 74.8 steps/s
[Step=17250 Epoch=84.2] | Loss=0.02206 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.429 | L2-Norm(final)=7.493 | 4901.7 samples/s | 76.6 steps/s
[Step=17300 Epoch=84.4] | Loss=0.02125 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.435 | L2-Norm(final)=7.496 | 5453.7 samples/s | 85.2 steps/s
[Step=17350 Epoch=84.7] | Loss=0.02054 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.440 | L2-Norm(final)=7.499 | 1953.4 samples/s | 30.5 steps/s
[Step=17400 Epoch=84.9] | Loss=0.01975 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.446 | L2-Norm(final)=7.502 | 4898.2 samples/s | 76.5 steps/s
[Step=17450 Epoch=85.1] | Loss=0.01909 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.450 | L2-Norm(final)=7.505 | 4859.0 samples/s | 75.9 steps/s
[Step=17500 Epoch=85.4] | Loss=0.01837 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.453 | L2-Norm(final)=7.508 | 5280.6 samples/s | 82.5 steps/s
[Step=17550 Epoch=85.6] | Loss=0.01780 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.456 | L2-Norm(final)=7.511 | 1995.9 samples/s | 31.2 steps/s
[Step=17600 Epoch=85.9] | Loss=0.01725 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.459 | L2-Norm(final)=7.514 | 4826.8 samples/s | 75.4 steps/s
[Step=17650 Epoch=86.1] | Loss=0.01690 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.461 | L2-Norm(final)=7.517 | 4885.3 samples/s | 76.3 steps/s
[Step=17700 Epoch=86.4] | Loss=0.01638 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.462 | L2-Norm(final)=7.520 | 4933.9 samples/s | 77.1 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01589 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.463 | L2-Norm(final)=7.523 | 2020.3 samples/s | 31.6 steps/s
[Step=17800 Epoch=86.9] | Loss=0.01548 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.464 | L2-Norm(final)=7.526 | 4869.4 samples/s | 76.1 steps/s
[Step=17850 Epoch=87.1] | Loss=0.01510 | Reg=0.00239 | acc=0.9688 | L2-Norm=15.465 | L2-Norm(final)=7.529 | 4825.2 samples/s | 75.4 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01472 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.464 | L2-Norm(final)=7.531 | 4828.4 samples/s | 75.4 steps/s
[Step=17950 Epoch=87.6] | Loss=0.01439 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.464 | L2-Norm(final)=7.534 | 2047.2 samples/s | 32.0 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01405 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.464 | L2-Norm(final)=7.537 | 4973.7 samples/s | 77.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step18000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=6001 Epoch=29.3] | Loss=0.09436 | Reg=0.00197 | acc=0.8906 | L2-Norm=14.035 | L2-Norm(final)=5.491 | 4012.9 samples/s | 62.7 steps/s
[Step=6050 Epoch=29.5] | Loss=0.05074 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.092 | L2-Norm(final)=5.511 | 5167.5 samples/s | 80.7 steps/s
[Step=6100 Epoch=29.7] | Loss=0.05009 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.163 | L2-Norm(final)=5.535 | 5385.5 samples/s | 84.1 steps/s
[Step=6150 Epoch=30.0] | Loss=0.05023 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.229 | L2-Norm(final)=5.556 | 5501.3 samples/s | 86.0 steps/s
[Step=6200 Epoch=30.2] | Loss=0.04869 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.291 | L2-Norm(final)=5.576 | 7735.9 samples/s | 120.9 steps/s
[Step=6250 Epoch=30.5] | Loss=0.04678 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.349 | L2-Norm(final)=5.598 | 1943.1 samples/s | 30.4 steps/s
[Step=6300 Epoch=30.7] | Loss=0.04593 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.407 | L2-Norm(final)=5.623 | 5489.7 samples/s | 85.8 steps/s
[Step=6350 Epoch=31.0] | Loss=0.04546 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.464 | L2-Norm(final)=5.648 | 5265.5 samples/s | 82.3 steps/s
[Step=6400 Epoch=31.2] | Loss=0.04468 | Reg=0.00211 | acc=0.9531 | L2-Norm=14.521 | L2-Norm(final)=5.671 | 6979.6 samples/s | 109.1 steps/s
[Step=6450 Epoch=31.5] | Loss=0.04360 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.577 | L2-Norm(final)=5.697 | 1980.1 samples/s | 30.9 steps/s
[Step=6500 Epoch=31.7] | Loss=0.04287 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.632 | L2-Norm(final)=5.723 | 5503.8 samples/s | 86.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=6501 Epoch=31.7] | Loss=0.07378 | Reg=0.00230 | acc=0.9219 | L2-Norm=15.175 | L2-Norm(final)=5.984 | 3831.4 samples/s | 59.9 steps/s
[Step=6550 Epoch=31.9] | Loss=0.04318 | Reg=0.00232 | acc=0.9688 | L2-Norm=15.226 | L2-Norm(final)=6.003 | 4810.0 samples/s | 75.2 steps/s
[Step=6600 Epoch=32.2] | Loss=0.03890 | Reg=0.00233 | acc=0.9531 | L2-Norm=15.267 | L2-Norm(final)=6.010 | 4822.6 samples/s | 75.4 steps/s
[Step=6650 Epoch=32.4] | Loss=0.03697 | Reg=0.00234 | acc=0.9688 | L2-Norm=15.301 | L2-Norm(final)=6.016 | 4817.8 samples/s | 75.3 steps/s
[Step=6700 Epoch=32.7] | Loss=0.03620 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.326 | L2-Norm(final)=6.019 | 6453.3 samples/s | 100.8 steps/s
[Step=6750 Epoch=32.9] | Loss=0.03163 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.352 | L2-Norm(final)=6.026 | 1866.1 samples/s | 29.2 steps/s
[Step=6800 Epoch=33.2] | Loss=0.02911 | Reg=0.00236 | acc=0.9688 | L2-Norm=15.377 | L2-Norm(final)=6.037 | 4955.2 samples/s | 77.4 steps/s
[Step=6850 Epoch=33.4] | Loss=0.02691 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.400 | L2-Norm(final)=6.046 | 4887.2 samples/s | 76.4 steps/s
[Step=6900 Epoch=33.6] | Loss=0.02529 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.419 | L2-Norm(final)=6.056 | 6070.3 samples/s | 94.8 steps/s
[Step=6950 Epoch=33.9] | Loss=0.02488 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.436 | L2-Norm(final)=6.062 | 1912.5 samples/s | 29.9 steps/s
[Step=7000 Epoch=34.1] | Loss=0.02355 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.453 | L2-Norm(final)=6.068 | 4905.3 samples/s | 76.6 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02234 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.469 | L2-Norm(final)=6.075 | 4962.4 samples/s | 77.5 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02147 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.483 | L2-Norm(final)=6.082 | 5676.9 samples/s | 88.7 steps/s
[Step=7150 Epoch=34.9] | Loss=0.02056 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.496 | L2-Norm(final)=6.088 | 1965.5 samples/s | 30.7 steps/s
[Step=7200 Epoch=35.1] | Loss=0.01977 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.508 | L2-Norm(final)=6.094 | 4881.9 samples/s | 76.3 steps/s
[Step=7250 Epoch=35.4] | Loss=0.01910 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.518 | L2-Norm(final)=6.100 | 4909.0 samples/s | 76.7 steps/s
[Step=7300 Epoch=35.6] | Loss=0.01839 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.528 | L2-Norm(final)=6.105 | 5167.1 samples/s | 80.7 steps/s
[Step=7350 Epoch=35.8] | Loss=0.01762 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.537 | L2-Norm(final)=6.110 | 1999.3 samples/s | 31.2 steps/s
[Step=7400 Epoch=36.1] | Loss=0.01708 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.545 | L2-Norm(final)=6.115 | 4822.4 samples/s | 75.3 steps/s
[Step=7450 Epoch=36.3] | Loss=0.01656 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.552 | L2-Norm(final)=6.120 | 4843.9 samples/s | 75.7 steps/s
[Step=7500 Epoch=36.6] | Loss=0.01616 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.559 | L2-Norm(final)=6.125 | 4902.9 samples/s | 76.6 steps/s
[Step=7550 Epoch=36.8] | Loss=0.01582 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.564 | L2-Norm(final)=6.129 | 2030.5 samples/s | 31.7 steps/s
[Step=7600 Epoch=37.1] | Loss=0.01537 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.569 | L2-Norm(final)=6.134 | 4859.0 samples/s | 75.9 steps/s
[Step=7650 Epoch=37.3] | Loss=0.01500 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.573 | L2-Norm(final)=6.138 | 4694.4 samples/s | 73.3 steps/s
[Step=7700 Epoch=37.5] | Loss=0.01464 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.577 | L2-Norm(final)=6.142 | 4849.2 samples/s | 75.8 steps/s
[Step=7750 Epoch=37.8] | Loss=0.01422 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.581 | L2-Norm(final)=6.146 | 2014.6 samples/s | 31.5 steps/s
[Step=7800 Epoch=38.0] | Loss=0.01391 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.584 | L2-Norm(final)=6.150 | 4977.0 samples/s | 77.8 steps/s
[Step=7850 Epoch=38.3] | Loss=0.01363 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.587 | L2-Norm(final)=6.154 | 4921.8 samples/s | 76.9 steps/s
[Step=7900 Epoch=38.5] | Loss=0.01334 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.590 | L2-Norm(final)=6.158 | 4805.9 samples/s | 75.1 steps/s
[Step=7950 Epoch=38.8] | Loss=0.01303 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.592 | L2-Norm(final)=6.162 | 2047.2 samples/s | 32.0 steps/s
[Step=8000 Epoch=39.0] | Loss=0.01276 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.594 | L2-Norm(final)=6.166 | 4939.1 samples/s | 77.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step8000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=12001 Epoch=114.6] | Loss=0.01143 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.035 | L2-Norm(final)=6.253 | 3719.6 samples/s | 58.1 steps/s
[Step=12050 Epoch=115.1] | Loss=0.00993 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.241 | L2-Norm(final)=6.223 | 5155.2 samples/s | 80.5 steps/s
[Step=12100 Epoch=115.5] | Loss=0.00697 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.379 | L2-Norm(final)=6.247 | 7249.0 samples/s | 113.3 steps/s
[Step=12150 Epoch=116.0] | Loss=0.00500 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.449 | L2-Norm(final)=6.274 | 1865.3 samples/s | 29.1 steps/s
[Step=12200 Epoch=116.5] | Loss=0.00400 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.482 | L2-Norm(final)=6.299 | 6884.2 samples/s | 107.6 steps/s
[Step=12250 Epoch=117.0] | Loss=0.00329 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.497 | L2-Norm(final)=6.322 | 1925.3 samples/s | 30.1 steps/s
[Step=12300 Epoch=117.5] | Loss=0.00281 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.501 | L2-Norm(final)=6.343 | 6197.4 samples/s | 96.8 steps/s
[Step=12350 Epoch=117.9] | Loss=0.00244 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.498 | L2-Norm(final)=6.363 | 1905.2 samples/s | 29.8 steps/s
[Step=12400 Epoch=118.4] | Loss=0.00217 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.491 | L2-Norm(final)=6.381 | 6071.2 samples/s | 94.9 steps/s
[Step=12450 Epoch=118.9] | Loss=0.00195 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.480 | L2-Norm(final)=6.398 | 1965.5 samples/s | 30.7 steps/s
[Step=12500 Epoch=119.4] | Loss=0.00178 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.467 | L2-Norm(final)=6.415 | 5695.1 samples/s | 89.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=119.4] | Loss=0.00019 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.332 | L2-Norm(final)=6.580 | 3804.5 samples/s | 59.4 steps/s
[Step=12550 Epoch=119.8] | Loss=0.00017 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.305 | L2-Norm(final)=6.592 | 4450.2 samples/s | 69.5 steps/s
[Step=12600 Epoch=120.3] | Loss=0.00307 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.322 | L2-Norm(final)=6.596 | 6440.7 samples/s | 100.6 steps/s
[Step=12650 Epoch=120.8] | Loss=0.00416 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.409 | L2-Norm(final)=6.582 | 1773.4 samples/s | 27.7 steps/s
[Step=12700 Epoch=121.3] | Loss=0.00342 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.468 | L2-Norm(final)=6.573 | 6112.3 samples/s | 95.5 steps/s
[Step=12750 Epoch=121.8] | Loss=0.00274 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.495 | L2-Norm(final)=6.570 | 1825.3 samples/s | 28.5 steps/s
[Step=12800 Epoch=122.2] | Loss=0.00229 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.505 | L2-Norm(final)=6.568 | 5608.9 samples/s | 87.6 steps/s
[Step=12850 Epoch=122.7] | Loss=0.00196 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.504 | L2-Norm(final)=6.567 | 1878.9 samples/s | 29.4 steps/s
[Step=12900 Epoch=123.2] | Loss=0.00172 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.496 | L2-Norm(final)=6.566 | 5329.6 samples/s | 83.3 steps/s
[Step=12950 Epoch=123.7] | Loss=0.00153 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.485 | L2-Norm(final)=6.566 | 1873.8 samples/s | 29.3 steps/s
[Step=13000 Epoch=124.1] | Loss=0.00138 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.470 | L2-Norm(final)=6.565 | 5064.7 samples/s | 79.1 steps/s
[Step=13050 Epoch=124.6] | Loss=0.00125 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.454 | L2-Norm(final)=6.565 | 1912.5 samples/s | 29.9 steps/s
[Step=13100 Epoch=125.1] | Loss=0.00115 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.436 | L2-Norm(final)=6.565 | 4632.0 samples/s | 72.4 steps/s
[Step=13150 Epoch=125.6] | Loss=0.00106 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.417 | L2-Norm(final)=6.566 | 1981.5 samples/s | 31.0 steps/s
[Step=13200 Epoch=126.1] | Loss=0.00099 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.397 | L2-Norm(final)=6.566 | 4720.9 samples/s | 73.8 steps/s
[Step=13250 Epoch=126.5] | Loss=0.00092 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.377 | L2-Norm(final)=6.566 | 1966.1 samples/s | 30.7 steps/s
[Step=13300 Epoch=127.0] | Loss=0.00086 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.356 | L2-Norm(final)=6.566 | 4765.3 samples/s | 74.5 steps/s
[Step=13350 Epoch=127.5] | Loss=0.00081 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.334 | L2-Norm(final)=6.567 | 1966.4 samples/s | 30.7 steps/s
[Step=13400 Epoch=128.0] | Loss=0.00077 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.312 | L2-Norm(final)=6.567 | 4728.8 samples/s | 73.9 steps/s
[Step=13450 Epoch=128.4] | Loss=0.00073 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.290 | L2-Norm(final)=6.567 | 1988.6 samples/s | 31.1 steps/s
[Step=13500 Epoch=128.9] | Loss=0.00069 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.267 | L2-Norm(final)=6.568 | 4736.9 samples/s | 74.0 steps/s
[Step=13550 Epoch=129.4] | Loss=0.00066 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.245 | L2-Norm(final)=6.568 | 6776.5 samples/s | 105.9 steps/s
[Step=13600 Epoch=129.9] | Loss=0.00063 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.222 | L2-Norm(final)=6.568 | 1751.2 samples/s | 27.4 steps/s
[Step=13650 Epoch=130.3] | Loss=0.00060 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.199 | L2-Norm(final)=6.569 | 6475.9 samples/s | 101.2 steps/s
[Step=13700 Epoch=130.8] | Loss=0.00058 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.176 | L2-Norm(final)=6.569 | 1756.8 samples/s | 27.4 steps/s
[Step=13750 Epoch=131.3] | Loss=0.00055 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.152 | L2-Norm(final)=6.570 | 5966.3 samples/s | 93.2 steps/s
[Step=13800 Epoch=131.8] | Loss=0.00053 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.129 | L2-Norm(final)=6.570 | 1816.9 samples/s | 28.4 steps/s
[Step=13850 Epoch=132.3] | Loss=0.00051 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.105 | L2-Norm(final)=6.570 | 5635.0 samples/s | 88.0 steps/s
[Step=13900 Epoch=132.7] | Loss=0.00050 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.082 | L2-Norm(final)=6.571 | 1854.2 samples/s | 29.0 steps/s
[Step=13950 Epoch=133.2] | Loss=0.00048 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.058 | L2-Norm(final)=6.571 | 5341.1 samples/s | 83.5 steps/s
[Step=14000 Epoch=133.7] | Loss=0.00046 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.034 | L2-Norm(final)=6.572 | 1889.8 samples/s | 29.5 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step14000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=6001 Epoch=57.2] | Loss=0.02079 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.035 | L2-Norm(final)=5.484 | 3834.2 samples/s | 59.9 steps/s
[Step=6050 Epoch=57.7] | Loss=0.01064 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.184 | L2-Norm(final)=5.531 | 4816.9 samples/s | 75.3 steps/s
[Step=6100 Epoch=58.1] | Loss=0.00690 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.329 | L2-Norm(final)=5.583 | 7553.1 samples/s | 118.0 steps/s
[Step=6150 Epoch=58.6] | Loss=0.00526 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.409 | L2-Norm(final)=5.623 | 1837.2 samples/s | 28.7 steps/s
[Step=6200 Epoch=59.1] | Loss=0.00433 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.460 | L2-Norm(final)=5.657 | 6870.7 samples/s | 107.4 steps/s
[Step=6250 Epoch=59.6] | Loss=0.00366 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.497 | L2-Norm(final)=5.687 | 1903.9 samples/s | 29.7 steps/s
[Step=6300 Epoch=60.0] | Loss=0.00317 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.524 | L2-Norm(final)=5.714 | 6466.7 samples/s | 101.0 steps/s
[Step=6350 Epoch=60.5] | Loss=0.00282 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.544 | L2-Norm(final)=5.739 | 1887.5 samples/s | 29.5 steps/s
[Step=6400 Epoch=61.0] | Loss=0.00253 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.558 | L2-Norm(final)=5.761 | 6027.8 samples/s | 94.2 steps/s
[Step=6450 Epoch=61.5] | Loss=0.00230 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.567 | L2-Norm(final)=5.782 | 1934.4 samples/s | 30.2 steps/s
[Step=6500 Epoch=62.0] | Loss=0.00212 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.572 | L2-Norm(final)=5.802 | 5697.5 samples/s | 89.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=6501 Epoch=62.0] | Loss=0.00013 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.615 | L2-Norm(final)=5.994 | 3789.4 samples/s | 59.2 steps/s
[Step=6550 Epoch=62.4] | Loss=0.00027 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.598 | L2-Norm(final)=6.006 | 4569.6 samples/s | 71.4 steps/s
[Step=6600 Epoch=62.9] | Loss=0.00019 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.574 | L2-Norm(final)=6.014 | 6374.0 samples/s | 99.6 steps/s
[Step=6650 Epoch=63.4] | Loss=0.00014 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.544 | L2-Norm(final)=6.019 | 1780.4 samples/s | 27.8 steps/s
[Step=6700 Epoch=63.9] | Loss=0.00011 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.512 | L2-Norm(final)=6.022 | 5920.7 samples/s | 92.5 steps/s
[Step=6750 Epoch=64.3] | Loss=0.00009 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.479 | L2-Norm(final)=6.024 | 1809.7 samples/s | 28.3 steps/s
[Step=6800 Epoch=64.8] | Loss=0.00008 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.445 | L2-Norm(final)=6.027 | 5468.9 samples/s | 85.5 steps/s
[Step=6850 Epoch=65.3] | Loss=0.00007 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.411 | L2-Norm(final)=6.028 | 1877.4 samples/s | 29.3 steps/s
[Step=6900 Epoch=65.8] | Loss=0.00006 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.377 | L2-Norm(final)=6.030 | 5230.4 samples/s | 81.7 steps/s
[Step=6950 Epoch=66.2] | Loss=0.00006 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.343 | L2-Norm(final)=6.032 | 1903.2 samples/s | 29.7 steps/s
[Step=7000 Epoch=66.7] | Loss=0.00005 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.309 | L2-Norm(final)=6.033 | 4941.9 samples/s | 77.2 steps/s
[Step=7050 Epoch=67.2] | Loss=0.00005 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.275 | L2-Norm(final)=6.034 | 1916.6 samples/s | 29.9 steps/s
[Step=7100 Epoch=67.7] | Loss=0.00005 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.241 | L2-Norm(final)=6.036 | 4805.6 samples/s | 75.1 steps/s
[Step=7150 Epoch=68.1] | Loss=0.00004 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.207 | L2-Norm(final)=6.037 | 1967.5 samples/s | 30.7 steps/s
[Step=7200 Epoch=68.6] | Loss=0.00004 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.173 | L2-Norm(final)=6.038 | 4733.2 samples/s | 74.0 steps/s
[Step=7250 Epoch=69.1] | Loss=0.00004 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.140 | L2-Norm(final)=6.039 | 2003.9 samples/s | 31.3 steps/s
[Step=7300 Epoch=69.6] | Loss=0.00004 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.106 | L2-Norm(final)=6.040 | 4683.9 samples/s | 73.2 steps/s
[Step=7350 Epoch=70.1] | Loss=0.00004 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.072 | L2-Norm(final)=6.041 | 1990.3 samples/s | 31.1 steps/s
[Step=7400 Epoch=70.5] | Loss=0.00003 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.039 | L2-Norm(final)=6.042 | 4566.3 samples/s | 71.3 steps/s
[Step=7450 Epoch=71.0] | Loss=0.00003 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.005 | L2-Norm(final)=6.043 | 1961.1 samples/s | 30.6 steps/s
[Step=7500 Epoch=71.5] | Loss=0.00003 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.971 | L2-Norm(final)=6.044 | 4669.6 samples/s | 73.0 steps/s
[Step=7550 Epoch=72.0] | Loss=0.00003 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.938 | L2-Norm(final)=6.046 | 6738.8 samples/s | 105.3 steps/s
[Step=7600 Epoch=72.4] | Loss=0.00003 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.904 | L2-Norm(final)=6.047 | 1742.9 samples/s | 27.2 steps/s
[Step=7650 Epoch=72.9] | Loss=0.00003 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.871 | L2-Norm(final)=6.048 | 6468.7 samples/s | 101.1 steps/s
[Step=7700 Epoch=73.4] | Loss=0.00003 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.838 | L2-Norm(final)=6.049 | 1799.5 samples/s | 28.1 steps/s
[Step=7750 Epoch=73.9] | Loss=0.00003 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.804 | L2-Norm(final)=6.050 | 5964.4 samples/s | 93.2 steps/s
[Step=7800 Epoch=74.3] | Loss=0.00003 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.771 | L2-Norm(final)=6.051 | 1836.6 samples/s | 28.7 steps/s
[Step=7850 Epoch=74.8] | Loss=0.00003 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.737 | L2-Norm(final)=6.052 | 5510.5 samples/s | 86.1 steps/s
[Step=7900 Epoch=75.3] | Loss=0.00003 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.704 | L2-Norm(final)=6.053 | 1848.4 samples/s | 28.9 steps/s
[Step=7950 Epoch=75.8] | Loss=0.00003 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.671 | L2-Norm(final)=6.054 | 5216.4 samples/s | 81.5 steps/s
[Step=8000 Epoch=76.2] | Loss=0.00002 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.637 | L2-Norm(final)=6.055 | 1894.5 samples/s | 29.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10251 | acc=0.9546 | tpr=0.9673 | fpr=0.0728 | 4329.9 samples/s | 16.9 steps/s
Avg test loss: 0.10786, Avg test acc: 0.95272, Avg tpr: 0.96602, Avg fpr: 0.07653, total FA: 597

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10512 | acc=0.9510 | tpr=0.9685 | fpr=0.0870 | 4325.2 samples/s | 16.9 steps/s
Avg test loss: 0.11137, Avg test acc: 0.95168, Avg tpr: 0.96911, Avg fpr: 0.08666, total FA: 676

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11160 | acc=0.9495 | tpr=0.9716 | fpr=0.0984 | 4426.4 samples/s | 17.3 steps/s
Avg test loss: 0.11819, Avg test acc: 0.94727, Avg tpr: 0.96835, Avg fpr: 0.09909, total FA: 773

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10848 | acc=0.9538 | tpr=0.9741 | fpr=0.0902 | 4361.8 samples/s | 17.0 steps/s
Avg test loss: 0.11150, Avg test acc: 0.95196, Avg tpr: 0.97278, Avg fpr: 0.09383, total FA: 732

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10352 | acc=0.9525 | tpr=0.9676 | fpr=0.0803 | 4331.9 samples/s | 16.9 steps/s
Avg test loss: 0.10937, Avg test acc: 0.95124, Avg tpr: 0.96649, Avg fpr: 0.08230, total FA: 642

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.14314 | acc=0.3084 | tpr=0.0027 | fpr=0.0278 | 4356.7 samples/s | 17.0 steps/s
Avg test loss: 4.16161, Avg test acc: 0.30523, Avg tpr: 0.00321, Avg fpr: 0.03051, total FA: 238

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.22583 | acc=0.3117 | tpr=0.0021 | fpr=0.0159 | 4381.0 samples/s | 17.1 steps/s
Avg test loss: 4.23372, Avg test acc: 0.30960, Avg tpr: 0.00204, Avg fpr: 0.01397, total FA: 109

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.56552 | acc=0.2934 | tpr=0.0063 | fpr=0.0830 | 4402.3 samples/s | 17.2 steps/s
Avg test loss: 4.57402, Avg test acc: 0.29181, Avg tpr: 0.00653, Avg fpr: 0.08076, total FA: 630

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.14320 | acc=0.3026 | tpr=0.0026 | fpr=0.0461 | 4412.7 samples/s | 17.2 steps/s
Avg test loss: 4.14816, Avg test acc: 0.30143, Avg tpr: 0.00373, Avg fpr: 0.04384, total FA: 342

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.08418 | acc=0.3089 | tpr=0.0034 | fpr=0.0278 | 4509.7 samples/s | 17.6 steps/s
Avg test loss: 4.09202, Avg test acc: 0.30607, Avg tpr: 0.00408, Avg fpr: 0.02974, total FA: 232

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.07291 | acc=0.1197 | tpr=0.7699 | fpr=0.8920 | 4339.9 samples/s | 17.0 steps/s
[Step= 100] | Loss=5.04212 | acc=0.1214 | tpr=0.7441 | fpr=0.8903 | 8806.4 samples/s | 34.4 steps/s
[Step= 150] | Loss=5.05036 | acc=0.1209 | tpr=0.7406 | fpr=0.8905 | 8405.2 samples/s | 32.8 steps/s
[Step= 200] | Loss=5.04955 | acc=0.1202 | tpr=0.7454 | fpr=0.8911 | 8695.6 samples/s | 34.0 steps/s
[Step= 250] | Loss=5.04877 | acc=0.1207 | tpr=0.7485 | fpr=0.8907 | 8555.0 samples/s | 33.4 steps/s
[Step= 300] | Loss=5.04514 | acc=0.1208 | tpr=0.7469 | fpr=0.8906 | 8661.2 samples/s | 33.8 steps/s
[Step= 350] | Loss=5.04174 | acc=0.1209 | tpr=0.7401 | fpr=0.8904 | 8457.5 samples/s | 33.0 steps/s
[Step= 400] | Loss=5.04119 | acc=0.1214 | tpr=0.7380 | fpr=0.8898 | 8446.3 samples/s | 33.0 steps/s
[Step= 450] | Loss=5.04313 | acc=0.1213 | tpr=0.7313 | fpr=0.8898 | 8695.9 samples/s | 34.0 steps/s
[Step= 500] | Loss=5.04342 | acc=0.1210 | tpr=0.7269 | fpr=0.8899 | 8674.5 samples/s | 33.9 steps/s
[Step= 550] | Loss=5.04488 | acc=0.1210 | tpr=0.7298 | fpr=0.8901 | 14787.2 samples/s | 57.8 steps/s
Avg test loss: 5.04608, Avg test acc: 0.12087, Avg tpr: 0.73019, Avg fpr: 0.89021, total FA: 123604

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.68556 | acc=0.1218 | tpr=0.6858 | fpr=0.8883 | 4374.9 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.64935 | acc=0.1245 | tpr=0.6098 | fpr=0.8846 | 8659.5 samples/s | 33.8 steps/s
[Step= 150] | Loss=4.65421 | acc=0.1229 | tpr=0.6124 | fpr=0.8861 | 8460.6 samples/s | 33.0 steps/s
[Step= 200] | Loss=4.65874 | acc=0.1224 | tpr=0.6011 | fpr=0.8863 | 8782.8 samples/s | 34.3 steps/s
[Step= 250] | Loss=4.65828 | acc=0.1222 | tpr=0.6000 | fpr=0.8865 | 8392.3 samples/s | 32.8 steps/s
[Step= 300] | Loss=4.66026 | acc=0.1222 | tpr=0.6095 | fpr=0.8867 | 8719.7 samples/s | 34.1 steps/s
[Step= 350] | Loss=4.65854 | acc=0.1219 | tpr=0.6005 | fpr=0.8868 | 8680.4 samples/s | 33.9 steps/s
[Step= 400] | Loss=4.65811 | acc=0.1221 | tpr=0.6034 | fpr=0.8867 | 8473.0 samples/s | 33.1 steps/s
[Step= 450] | Loss=4.66216 | acc=0.1222 | tpr=0.6008 | fpr=0.8865 | 8581.5 samples/s | 33.5 steps/s
[Step= 500] | Loss=4.66520 | acc=0.1219 | tpr=0.5991 | fpr=0.8867 | 9040.4 samples/s | 35.3 steps/s
[Step= 550] | Loss=4.66747 | acc=0.1214 | tpr=0.5997 | fpr=0.8873 | 14221.4 samples/s | 55.6 steps/s
Avg test loss: 4.66939, Avg test acc: 0.12130, Avg tpr: 0.59984, Avg fpr: 0.88739, total FA: 123213

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.90099 | acc=0.0963 | tpr=0.8142 | fpr=0.9166 | 4322.4 samples/s | 16.9 steps/s
[Step= 100] | Loss=5.86143 | acc=0.0997 | tpr=0.8060 | fpr=0.9135 | 8710.8 samples/s | 34.0 steps/s
[Step= 150] | Loss=5.86781 | acc=0.0995 | tpr=0.8184 | fpr=0.9137 | 8541.4 samples/s | 33.4 steps/s
[Step= 200] | Loss=5.86611 | acc=0.0992 | tpr=0.8186 | fpr=0.9139 | 8497.7 samples/s | 33.2 steps/s
[Step= 250] | Loss=5.86720 | acc=0.0996 | tpr=0.8175 | fpr=0.9135 | 8576.1 samples/s | 33.5 steps/s
[Step= 300] | Loss=5.86908 | acc=0.0993 | tpr=0.8218 | fpr=0.9139 | 8794.7 samples/s | 34.4 steps/s
[Step= 350] | Loss=5.86617 | acc=0.0991 | tpr=0.8140 | fpr=0.9139 | 8458.4 samples/s | 33.0 steps/s
[Step= 400] | Loss=5.86770 | acc=0.0993 | tpr=0.8156 | fpr=0.9137 | 8804.5 samples/s | 34.4 steps/s
[Step= 450] | Loss=5.87133 | acc=0.0990 | tpr=0.8116 | fpr=0.9139 | 8591.4 samples/s | 33.6 steps/s
[Step= 500] | Loss=5.87527 | acc=0.0992 | tpr=0.8150 | fpr=0.9137 | 8258.6 samples/s | 32.3 steps/s
[Step= 550] | Loss=5.87746 | acc=0.0993 | tpr=0.8213 | fpr=0.9139 | 15617.7 samples/s | 61.0 steps/s
Avg test loss: 5.87897, Avg test acc: 0.09921, Avg tpr: 0.82132, Avg fpr: 0.91391, total FA: 126895

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.18652 | acc=0.1279 | tpr=0.8186 | fpr=0.8845 | 4428.4 samples/s | 17.3 steps/s
[Step= 100] | Loss=5.15305 | acc=0.1290 | tpr=0.7569 | fpr=0.8827 | 8342.1 samples/s | 32.6 steps/s
[Step= 150] | Loss=5.15380 | acc=0.1273 | tpr=0.7651 | fpr=0.8845 | 8492.1 samples/s | 33.2 steps/s
[Step= 200] | Loss=5.15039 | acc=0.1269 | tpr=0.7661 | fpr=0.8847 | 8663.9 samples/s | 33.8 steps/s
[Step= 250] | Loss=5.15411 | acc=0.1271 | tpr=0.7616 | fpr=0.8845 | 8591.6 samples/s | 33.6 steps/s
[Step= 300] | Loss=5.15294 | acc=0.1266 | tpr=0.7615 | fpr=0.8850 | 8379.7 samples/s | 32.7 steps/s
[Step= 350] | Loss=5.15011 | acc=0.1271 | tpr=0.7621 | fpr=0.8845 | 8569.2 samples/s | 33.5 steps/s
[Step= 400] | Loss=5.15351 | acc=0.1268 | tpr=0.7593 | fpr=0.8847 | 8852.0 samples/s | 34.6 steps/s
[Step= 450] | Loss=5.15579 | acc=0.1271 | tpr=0.7517 | fpr=0.8843 | 8294.7 samples/s | 32.4 steps/s
[Step= 500] | Loss=5.15669 | acc=0.1270 | tpr=0.7511 | fpr=0.8843 | 8399.9 samples/s | 32.8 steps/s
[Step= 550] | Loss=5.15561 | acc=0.1266 | tpr=0.7533 | fpr=0.8848 | 15723.2 samples/s | 61.4 steps/s
Avg test loss: 5.15685, Avg test acc: 0.12650, Avg tpr: 0.75317, Avg fpr: 0.88490, total FA: 122866

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.95550 | acc=0.1203 | tpr=0.7522 | fpr=0.8910 | 4356.9 samples/s | 17.0 steps/s
[Step= 100] | Loss=4.92144 | acc=0.1220 | tpr=0.7122 | fpr=0.8891 | 8704.0 samples/s | 34.0 steps/s
[Step= 150] | Loss=4.92463 | acc=0.1209 | tpr=0.7176 | fpr=0.8901 | 8456.8 samples/s | 33.0 steps/s
[Step= 200] | Loss=4.92012 | acc=0.1213 | tpr=0.7158 | fpr=0.8895 | 8813.9 samples/s | 34.4 steps/s
[Step= 250] | Loss=4.91908 | acc=0.1207 | tpr=0.7179 | fpr=0.8902 | 8675.7 samples/s | 33.9 steps/s
[Step= 300] | Loss=4.91851 | acc=0.1206 | tpr=0.7200 | fpr=0.8903 | 8413.0 samples/s | 32.9 steps/s
[Step= 350] | Loss=4.91826 | acc=0.1208 | tpr=0.7170 | fpr=0.8900 | 8719.5 samples/s | 34.1 steps/s
[Step= 400] | Loss=4.91668 | acc=0.1212 | tpr=0.7210 | fpr=0.8897 | 8431.2 samples/s | 32.9 steps/s
[Step= 450] | Loss=4.91856 | acc=0.1210 | tpr=0.7123 | fpr=0.8898 | 8658.9 samples/s | 33.8 steps/s
[Step= 500] | Loss=4.92143 | acc=0.1208 | tpr=0.7106 | fpr=0.8898 | 8654.7 samples/s | 33.8 steps/s
[Step= 550] | Loss=4.92277 | acc=0.1206 | tpr=0.7135 | fpr=0.8902 | 15174.7 samples/s | 59.3 steps/s
Avg test loss: 4.92511, Avg test acc: 0.12050, Avg tpr: 0.71395, Avg fpr: 0.89029, total FA: 123615

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09306 | acc=0.9815 | tpr=0.8982 | fpr=0.0170 | 4340.1 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.09512 | acc=0.9811 | tpr=0.9211 | fpr=0.0178 | 8525.7 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.09822 | acc=0.9803 | tpr=0.9222 | fpr=0.0186 | 8631.0 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.10022 | acc=0.9801 | tpr=0.9180 | fpr=0.0188 | 8598.8 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.09931 | acc=0.9802 | tpr=0.9188 | fpr=0.0187 | 8683.8 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.10048 | acc=0.9800 | tpr=0.9200 | fpr=0.0189 | 8631.0 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.10120 | acc=0.9797 | tpr=0.9186 | fpr=0.0192 | 9200.6 samples/s | 35.9 steps/s
[Step= 400] | Loss=0.10190 | acc=0.9796 | tpr=0.9141 | fpr=0.0193 | 8066.8 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.10450 | acc=0.9792 | tpr=0.9133 | fpr=0.0196 | 8675.2 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.10387 | acc=0.9793 | tpr=0.9145 | fpr=0.0195 | 8681.2 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.10309 | acc=0.9794 | tpr=0.9152 | fpr=0.0194 | 15089.1 samples/s | 58.9 steps/s
Avg test loss: 0.10301, Avg test acc: 0.97943, Avg tpr: 0.91521, Avg fpr: 0.01940, total FA: 2694

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10875 | acc=0.9818 | tpr=0.8717 | fpr=0.0162 | 4366.4 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.11622 | acc=0.9814 | tpr=0.8891 | fpr=0.0169 | 8635.0 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.11950 | acc=0.9808 | tpr=0.8948 | fpr=0.0176 | 8825.0 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.12145 | acc=0.9808 | tpr=0.8929 | fpr=0.0176 | 8494.8 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.12075 | acc=0.9808 | tpr=0.8891 | fpr=0.0175 | 8501.7 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.12256 | acc=0.9806 | tpr=0.8887 | fpr=0.0177 | 8554.0 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.12296 | acc=0.9804 | tpr=0.8917 | fpr=0.0180 | 9092.5 samples/s | 35.5 steps/s
[Step= 400] | Loss=0.12472 | acc=0.9801 | tpr=0.8862 | fpr=0.0182 | 8215.2 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.12810 | acc=0.9798 | tpr=0.8851 | fpr=0.0184 | 8688.3 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.12742 | acc=0.9799 | tpr=0.8872 | fpr=0.0184 | 8345.9 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.12690 | acc=0.9800 | tpr=0.8862 | fpr=0.0183 | 15753.3 samples/s | 61.5 steps/s
Avg test loss: 0.12673, Avg test acc: 0.97999, Avg tpr: 0.88550, Avg fpr: 0.01829, total FA: 2540

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.12609 | acc=0.9799 | tpr=0.9115 | fpr=0.0188 | 4344.4 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.13347 | acc=0.9795 | tpr=0.9296 | fpr=0.0196 | 8685.7 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.13808 | acc=0.9791 | tpr=0.9294 | fpr=0.0200 | 8738.5 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.14041 | acc=0.9790 | tpr=0.9311 | fpr=0.0201 | 8357.2 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.13858 | acc=0.9790 | tpr=0.9275 | fpr=0.0201 | 8569.8 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.14145 | acc=0.9785 | tpr=0.9258 | fpr=0.0206 | 8486.5 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.14256 | acc=0.9782 | tpr=0.9267 | fpr=0.0209 | 9084.2 samples/s | 35.5 steps/s
[Step= 400] | Loss=0.14440 | acc=0.9780 | tpr=0.9240 | fpr=0.0210 | 8302.9 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.14757 | acc=0.9776 | tpr=0.9211 | fpr=0.0214 | 8760.0 samples/s | 34.2 steps/s
[Step= 500] | Loss=0.14710 | acc=0.9776 | tpr=0.9238 | fpr=0.0214 | 8442.1 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.14593 | acc=0.9778 | tpr=0.9236 | fpr=0.0212 | 15620.7 samples/s | 61.0 steps/s
Avg test loss: 0.14567, Avg test acc: 0.97779, Avg tpr: 0.92274, Avg fpr: 0.02121, total FA: 2945

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10929 | acc=0.9807 | tpr=0.8982 | fpr=0.0178 | 4393.6 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.11420 | acc=0.9802 | tpr=0.9211 | fpr=0.0187 | 8510.0 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.11818 | acc=0.9794 | tpr=0.9236 | fpr=0.0196 | 8430.8 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.12178 | acc=0.9792 | tpr=0.9301 | fpr=0.0199 | 8628.0 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.12031 | acc=0.9792 | tpr=0.9275 | fpr=0.0198 | 8655.7 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.12205 | acc=0.9790 | tpr=0.9302 | fpr=0.0201 | 8624.3 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.12190 | acc=0.9789 | tpr=0.9311 | fpr=0.0202 | 8518.2 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.12317 | acc=0.9787 | tpr=0.9256 | fpr=0.0203 | 8745.6 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.12612 | acc=0.9783 | tpr=0.9241 | fpr=0.0207 | 8704.2 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.12538 | acc=0.9783 | tpr=0.9256 | fpr=0.0207 | 8440.4 samples/s | 33.0 steps/s
[Step= 550] | Loss=0.12440 | acc=0.9785 | tpr=0.9264 | fpr=0.0206 | 15127.7 samples/s | 59.1 steps/s
Avg test loss: 0.12418, Avg test acc: 0.97848, Avg tpr: 0.92552, Avg fpr: 0.02055, total FA: 2854

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10891 | acc=0.9793 | tpr=0.9159 | fpr=0.0196 | 4357.7 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.11244 | acc=0.9795 | tpr=0.9318 | fpr=0.0197 | 8604.8 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.11667 | acc=0.9783 | tpr=0.9323 | fpr=0.0208 | 8617.0 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.11992 | acc=0.9781 | tpr=0.9366 | fpr=0.0212 | 8602.4 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.11867 | acc=0.9783 | tpr=0.9371 | fpr=0.0210 | 8590.6 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.12064 | acc=0.9780 | tpr=0.9375 | fpr=0.0213 | 8801.9 samples/s | 34.4 steps/s
[Step= 350] | Loss=0.12028 | acc=0.9780 | tpr=0.9355 | fpr=0.0213 | 8549.8 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.12155 | acc=0.9778 | tpr=0.9283 | fpr=0.0213 | 8451.0 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.12414 | acc=0.9775 | tpr=0.9275 | fpr=0.0216 | 9170.6 samples/s | 35.8 steps/s
[Step= 500] | Loss=0.12347 | acc=0.9775 | tpr=0.9282 | fpr=0.0216 | 8158.9 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.12267 | acc=0.9776 | tpr=0.9256 | fpr=0.0215 | 15248.3 samples/s | 59.6 steps/s
Avg test loss: 0.12244, Avg test acc: 0.97760, Avg tpr: 0.92552, Avg fpr: 0.02146, total FA: 2979

server round 13/50

clients selected: [1 2 4 7 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=18001 Epoch=87.8] | Loss=0.01697 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.614 | L2-Norm(final)=7.620 | 3813.2 samples/s | 59.6 steps/s
[Step=18050 Epoch=88.1] | Loss=0.04614 | Reg=0.00187 | acc=0.9375 | L2-Norm=13.674 | L2-Norm(final)=7.618 | 5437.4 samples/s | 85.0 steps/s
[Step=18100 Epoch=88.3] | Loss=0.04331 | Reg=0.00189 | acc=0.9531 | L2-Norm=13.750 | L2-Norm(final)=7.627 | 5491.2 samples/s | 85.8 steps/s
[Step=18150 Epoch=88.6] | Loss=0.04228 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.821 | L2-Norm(final)=7.645 | 5477.4 samples/s | 85.6 steps/s
[Step=18200 Epoch=88.8] | Loss=0.04007 | Reg=0.00193 | acc=0.9531 | L2-Norm=13.886 | L2-Norm(final)=7.668 | 7668.7 samples/s | 119.8 steps/s
[Step=18250 Epoch=89.1] | Loss=0.03820 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.946 | L2-Norm(final)=7.689 | 1922.0 samples/s | 30.0 steps/s
[Step=18300 Epoch=89.3] | Loss=0.03640 | Reg=0.00196 | acc=0.9531 | L2-Norm=14.004 | L2-Norm(final)=7.715 | 5544.6 samples/s | 86.6 steps/s
[Step=18350 Epoch=89.5] | Loss=0.03566 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.061 | L2-Norm(final)=7.745 | 5534.6 samples/s | 86.5 steps/s
[Step=18400 Epoch=89.8] | Loss=0.03557 | Reg=0.00199 | acc=0.9531 | L2-Norm=14.120 | L2-Norm(final)=7.773 | 7244.8 samples/s | 113.2 steps/s
[Step=18450 Epoch=90.0] | Loss=0.03430 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.178 | L2-Norm(final)=7.802 | 1945.5 samples/s | 30.4 steps/s
[Step=18500 Epoch=90.3] | Loss=0.03382 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.234 | L2-Norm(final)=7.831 | 5499.9 samples/s | 85.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=90.3] | Loss=0.03885 | Reg=0.00219 | acc=0.9531 | L2-Norm=14.801 | L2-Norm(final)=8.117 | 3946.6 samples/s | 61.7 steps/s
[Step=18550 Epoch=90.5] | Loss=0.04146 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.850 | L2-Norm(final)=8.134 | 4633.3 samples/s | 72.4 steps/s
[Step=18600 Epoch=90.8] | Loss=0.04552 | Reg=0.00222 | acc=0.9531 | L2-Norm=14.907 | L2-Norm(final)=8.120 | 4818.1 samples/s | 75.3 steps/s
[Step=18650 Epoch=91.0] | Loss=0.04337 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.956 | L2-Norm(final)=8.113 | 4862.4 samples/s | 76.0 steps/s
[Step=18700 Epoch=91.2] | Loss=0.04193 | Reg=0.00225 | acc=0.9062 | L2-Norm=14.996 | L2-Norm(final)=8.110 | 6385.3 samples/s | 99.8 steps/s
[Step=18750 Epoch=91.5] | Loss=0.03689 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.029 | L2-Norm(final)=8.108 | 1843.9 samples/s | 28.8 steps/s
[Step=18800 Epoch=91.7] | Loss=0.03400 | Reg=0.00227 | acc=0.9688 | L2-Norm=15.057 | L2-Norm(final)=8.110 | 4993.1 samples/s | 78.0 steps/s
[Step=18850 Epoch=92.0] | Loss=0.03160 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.081 | L2-Norm(final)=8.113 | 4790.0 samples/s | 74.8 steps/s
[Step=18900 Epoch=92.2] | Loss=0.03006 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.102 | L2-Norm(final)=8.115 | 6104.6 samples/s | 95.4 steps/s
[Step=18950 Epoch=92.5] | Loss=0.02856 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.121 | L2-Norm(final)=8.117 | 1890.2 samples/s | 29.5 steps/s
[Step=19000 Epoch=92.7] | Loss=0.02718 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.138 | L2-Norm(final)=8.119 | 4939.5 samples/s | 77.2 steps/s
[Step=19050 Epoch=93.0] | Loss=0.02590 | Reg=0.00230 | acc=0.9688 | L2-Norm=15.153 | L2-Norm(final)=8.121 | 4898.9 samples/s | 76.5 steps/s
[Step=19100 Epoch=93.2] | Loss=0.02482 | Reg=0.00230 | acc=0.9688 | L2-Norm=15.166 | L2-Norm(final)=8.123 | 5883.4 samples/s | 91.9 steps/s
[Step=19150 Epoch=93.4] | Loss=0.02360 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.177 | L2-Norm(final)=8.125 | 1905.7 samples/s | 29.8 steps/s
[Step=19200 Epoch=93.7] | Loss=0.02226 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.187 | L2-Norm(final)=8.127 | 4909.8 samples/s | 76.7 steps/s
[Step=19250 Epoch=93.9] | Loss=0.02137 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.195 | L2-Norm(final)=8.130 | 4919.7 samples/s | 76.9 steps/s
[Step=19300 Epoch=94.2] | Loss=0.02059 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.202 | L2-Norm(final)=8.132 | 5569.3 samples/s | 87.0 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01980 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.208 | L2-Norm(final)=8.135 | 1952.1 samples/s | 30.5 steps/s
[Step=19400 Epoch=94.7] | Loss=0.01902 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.213 | L2-Norm(final)=8.137 | 4959.3 samples/s | 77.5 steps/s
[Step=19450 Epoch=94.9] | Loss=0.01832 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.217 | L2-Norm(final)=8.140 | 4838.2 samples/s | 75.6 steps/s
[Step=19500 Epoch=95.2] | Loss=0.01785 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.221 | L2-Norm(final)=8.142 | 5161.1 samples/s | 80.6 steps/s
[Step=19550 Epoch=95.4] | Loss=0.01723 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.224 | L2-Norm(final)=8.144 | 1981.7 samples/s | 31.0 steps/s
[Step=19600 Epoch=95.6] | Loss=0.01655 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.227 | L2-Norm(final)=8.146 | 5043.0 samples/s | 78.8 steps/s
[Step=19650 Epoch=95.9] | Loss=0.01603 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.228 | L2-Norm(final)=8.149 | 4941.9 samples/s | 77.2 steps/s
[Step=19700 Epoch=96.1] | Loss=0.01567 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.230 | L2-Norm(final)=8.152 | 4939.4 samples/s | 77.2 steps/s
[Step=19750 Epoch=96.4] | Loss=0.01527 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.230 | L2-Norm(final)=8.154 | 1998.9 samples/s | 31.2 steps/s
[Step=19800 Epoch=96.6] | Loss=0.01491 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.231 | L2-Norm(final)=8.156 | 5000.5 samples/s | 78.1 steps/s
[Step=19850 Epoch=96.9] | Loss=0.01452 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.231 | L2-Norm(final)=8.158 | 4859.1 samples/s | 75.9 steps/s
[Step=19900 Epoch=97.1] | Loss=0.01424 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.231 | L2-Norm(final)=8.160 | 4776.5 samples/s | 74.6 steps/s
[Step=19950 Epoch=97.3] | Loss=0.01398 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.230 | L2-Norm(final)=8.162 | 2015.0 samples/s | 31.5 steps/s
[Step=20000 Epoch=97.6] | Loss=0.01370 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.230 | L2-Norm(final)=8.164 | 5058.8 samples/s | 79.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step20000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=18001 Epoch=87.7] | Loss=0.03148 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.614 | L2-Norm(final)=9.127 | 4001.3 samples/s | 62.5 steps/s
[Step=18050 Epoch=87.9] | Loss=0.04591 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.670 | L2-Norm(final)=9.103 | 5167.9 samples/s | 80.7 steps/s
[Step=18100 Epoch=88.2] | Loss=0.04196 | Reg=0.00189 | acc=0.9531 | L2-Norm=13.738 | L2-Norm(final)=9.110 | 5478.1 samples/s | 85.6 steps/s
[Step=18150 Epoch=88.4] | Loss=0.04055 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=9.125 | 5532.8 samples/s | 86.4 steps/s
[Step=18200 Epoch=88.7] | Loss=0.03866 | Reg=0.00192 | acc=0.9375 | L2-Norm=13.867 | L2-Norm(final)=9.144 | 7790.5 samples/s | 121.7 steps/s
[Step=18250 Epoch=88.9] | Loss=0.03666 | Reg=0.00194 | acc=0.9531 | L2-Norm=13.929 | L2-Norm(final)=9.167 | 1914.3 samples/s | 29.9 steps/s
[Step=18300 Epoch=89.2] | Loss=0.03531 | Reg=0.00196 | acc=0.9688 | L2-Norm=13.989 | L2-Norm(final)=9.193 | 5503.7 samples/s | 86.0 steps/s
[Step=18350 Epoch=89.4] | Loss=0.03376 | Reg=0.00197 | acc=0.9531 | L2-Norm=14.047 | L2-Norm(final)=9.221 | 5504.7 samples/s | 86.0 steps/s
[Step=18400 Epoch=89.7] | Loss=0.03304 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.102 | L2-Norm(final)=9.251 | 7099.8 samples/s | 110.9 steps/s
[Step=18450 Epoch=89.9] | Loss=0.03229 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.157 | L2-Norm(final)=9.282 | 1953.7 samples/s | 30.5 steps/s
[Step=18500 Epoch=90.1] | Loss=0.03128 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.212 | L2-Norm(final)=9.315 | 5560.2 samples/s | 86.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=90.1] | Loss=0.01290 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.745 | L2-Norm(final)=9.651 | 3710.0 samples/s | 58.0 steps/s
[Step=18550 Epoch=90.4] | Loss=0.04078 | Reg=0.00219 | acc=0.9531 | L2-Norm=14.813 | L2-Norm(final)=9.666 | 4972.3 samples/s | 77.7 steps/s
[Step=18600 Epoch=90.6] | Loss=0.04388 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.879 | L2-Norm(final)=9.662 | 4885.5 samples/s | 76.3 steps/s
[Step=18650 Epoch=90.9] | Loss=0.04352 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.930 | L2-Norm(final)=9.657 | 4851.9 samples/s | 75.8 steps/s
[Step=18700 Epoch=91.1] | Loss=0.04157 | Reg=0.00224 | acc=0.9688 | L2-Norm=14.974 | L2-Norm(final)=9.652 | 6595.0 samples/s | 103.0 steps/s
[Step=18750 Epoch=91.4] | Loss=0.03778 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.011 | L2-Norm(final)=9.650 | 1854.5 samples/s | 29.0 steps/s
[Step=18800 Epoch=91.6] | Loss=0.03607 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.043 | L2-Norm(final)=9.650 | 4905.2 samples/s | 76.6 steps/s
[Step=18850 Epoch=91.8] | Loss=0.03385 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.070 | L2-Norm(final)=9.649 | 4889.3 samples/s | 76.4 steps/s
[Step=18900 Epoch=92.1] | Loss=0.03212 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.093 | L2-Norm(final)=9.650 | 6024.3 samples/s | 94.1 steps/s
[Step=18950 Epoch=92.3] | Loss=0.02972 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.114 | L2-Norm(final)=9.651 | 1924.1 samples/s | 30.1 steps/s
[Step=19000 Epoch=92.6] | Loss=0.02787 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.131 | L2-Norm(final)=9.654 | 4880.6 samples/s | 76.3 steps/s
[Step=19050 Epoch=92.8] | Loss=0.02644 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.147 | L2-Norm(final)=9.657 | 4968.5 samples/s | 77.6 steps/s
[Step=19100 Epoch=93.1] | Loss=0.02532 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.160 | L2-Norm(final)=9.661 | 5648.3 samples/s | 88.3 steps/s
[Step=19150 Epoch=93.3] | Loss=0.02435 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.172 | L2-Norm(final)=9.663 | 1945.9 samples/s | 30.4 steps/s
[Step=19200 Epoch=93.6] | Loss=0.02308 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.182 | L2-Norm(final)=9.666 | 4911.3 samples/s | 76.7 steps/s
[Step=19250 Epoch=93.8] | Loss=0.02203 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.191 | L2-Norm(final)=9.669 | 4890.7 samples/s | 76.4 steps/s
[Step=19300 Epoch=94.0] | Loss=0.02141 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.199 | L2-Norm(final)=9.672 | 5343.2 samples/s | 83.5 steps/s
[Step=19350 Epoch=94.3] | Loss=0.02054 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.206 | L2-Norm(final)=9.675 | 1983.2 samples/s | 31.0 steps/s
[Step=19400 Epoch=94.5] | Loss=0.01982 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.214 | L2-Norm(final)=9.678 | 4908.5 samples/s | 76.7 steps/s
[Step=19450 Epoch=94.8] | Loss=0.01920 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.220 | L2-Norm(final)=9.681 | 4977.8 samples/s | 77.8 steps/s
[Step=19500 Epoch=95.0] | Loss=0.01870 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.225 | L2-Norm(final)=9.683 | 4989.5 samples/s | 78.0 steps/s
[Step=19550 Epoch=95.3] | Loss=0.01830 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.231 | L2-Norm(final)=9.686 | 1990.2 samples/s | 31.1 steps/s
[Step=19600 Epoch=95.5] | Loss=0.01779 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.235 | L2-Norm(final)=9.688 | 4829.4 samples/s | 75.5 steps/s
[Step=19650 Epoch=95.7] | Loss=0.01739 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.239 | L2-Norm(final)=9.690 | 4818.1 samples/s | 75.3 steps/s
[Step=19700 Epoch=96.0] | Loss=0.01706 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.243 | L2-Norm(final)=9.692 | 4828.0 samples/s | 75.4 steps/s
[Step=19750 Epoch=96.2] | Loss=0.01677 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.247 | L2-Norm(final)=9.694 | 2022.0 samples/s | 31.6 steps/s
[Step=19800 Epoch=96.5] | Loss=0.01640 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.251 | L2-Norm(final)=9.695 | 5007.4 samples/s | 78.2 steps/s
[Step=19850 Epoch=96.7] | Loss=0.01599 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.255 | L2-Norm(final)=9.698 | 4952.6 samples/s | 77.4 steps/s
[Step=19900 Epoch=97.0] | Loss=0.01570 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.258 | L2-Norm(final)=9.700 | 4895.7 samples/s | 76.5 steps/s
[Step=19950 Epoch=97.2] | Loss=0.01536 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.262 | L2-Norm(final)=9.702 | 2017.4 samples/s | 31.5 steps/s
[Step=20000 Epoch=97.4] | Loss=0.01506 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.265 | L2-Norm(final)=9.704 | 5048.8 samples/s | 78.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step20000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=16001 Epoch=78.5] | Loss=0.01904 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.614 | L2-Norm(final)=8.095 | 3887.7 samples/s | 60.7 steps/s
[Step=16050 Epoch=78.7] | Loss=0.04138 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.679 | L2-Norm(final)=8.089 | 5326.0 samples/s | 83.2 steps/s
[Step=16100 Epoch=79.0] | Loss=0.03943 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.747 | L2-Norm(final)=8.098 | 5566.3 samples/s | 87.0 steps/s
[Step=16150 Epoch=79.2] | Loss=0.03938 | Reg=0.00191 | acc=0.9531 | L2-Norm=13.808 | L2-Norm(final)=8.110 | 5540.9 samples/s | 86.6 steps/s
[Step=16200 Epoch=79.4] | Loss=0.03823 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.867 | L2-Norm(final)=8.124 | 7867.9 samples/s | 122.9 steps/s
[Step=16250 Epoch=79.7] | Loss=0.03607 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.925 | L2-Norm(final)=8.143 | 1910.5 samples/s | 29.9 steps/s
[Step=16300 Epoch=79.9] | Loss=0.03530 | Reg=0.00196 | acc=0.9688 | L2-Norm=13.981 | L2-Norm(final)=8.164 | 5583.0 samples/s | 87.2 steps/s
[Step=16350 Epoch=80.2] | Loss=0.03391 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.035 | L2-Norm(final)=8.187 | 5467.9 samples/s | 85.4 steps/s
[Step=16400 Epoch=80.4] | Loss=0.03345 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.089 | L2-Norm(final)=8.211 | 7458.7 samples/s | 116.5 steps/s
[Step=16450 Epoch=80.7] | Loss=0.03210 | Reg=0.00200 | acc=0.9688 | L2-Norm=14.142 | L2-Norm(final)=8.237 | 1982.4 samples/s | 31.0 steps/s
[Step=16500 Epoch=80.9] | Loss=0.03126 | Reg=0.00202 | acc=0.9531 | L2-Norm=14.194 | L2-Norm(final)=8.264 | 5313.4 samples/s | 83.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=80.9] | Loss=0.01689 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.715 | L2-Norm(final)=8.541 | 4251.6 samples/s | 66.4 steps/s
[Step=16550 Epoch=81.2] | Loss=0.04425 | Reg=0.00218 | acc=0.9219 | L2-Norm=14.772 | L2-Norm(final)=8.552 | 4397.6 samples/s | 68.7 steps/s
[Step=16600 Epoch=81.4] | Loss=0.04262 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.837 | L2-Norm(final)=8.530 | 4978.6 samples/s | 77.8 steps/s
[Step=16650 Epoch=81.6] | Loss=0.04377 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.887 | L2-Norm(final)=8.519 | 4842.8 samples/s | 75.7 steps/s
[Step=16700 Epoch=81.9] | Loss=0.04297 | Reg=0.00223 | acc=0.9375 | L2-Norm=14.932 | L2-Norm(final)=8.509 | 6754.3 samples/s | 105.5 steps/s
[Step=16750 Epoch=82.1] | Loss=0.03863 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.969 | L2-Norm(final)=8.504 | 1868.6 samples/s | 29.2 steps/s
[Step=16800 Epoch=82.4] | Loss=0.03549 | Reg=0.00225 | acc=0.9375 | L2-Norm=14.997 | L2-Norm(final)=8.503 | 4823.1 samples/s | 75.4 steps/s
[Step=16850 Epoch=82.6] | Loss=0.03265 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.022 | L2-Norm(final)=8.503 | 4885.9 samples/s | 76.3 steps/s
[Step=16900 Epoch=82.9] | Loss=0.03029 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.042 | L2-Norm(final)=8.504 | 6468.3 samples/s | 101.1 steps/s
[Step=16950 Epoch=83.1] | Loss=0.02792 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.059 | L2-Norm(final)=8.507 | 1880.4 samples/s | 29.4 steps/s
[Step=17000 Epoch=83.4] | Loss=0.02626 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.075 | L2-Norm(final)=8.509 | 4870.5 samples/s | 76.1 steps/s
[Step=17050 Epoch=83.6] | Loss=0.02483 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.088 | L2-Norm(final)=8.512 | 4859.8 samples/s | 75.9 steps/s
[Step=17100 Epoch=83.9] | Loss=0.02390 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.099 | L2-Norm(final)=8.514 | 5920.6 samples/s | 92.5 steps/s
[Step=17150 Epoch=84.1] | Loss=0.02297 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.109 | L2-Norm(final)=8.516 | 1884.4 samples/s | 29.4 steps/s
[Step=17200 Epoch=84.3] | Loss=0.02186 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.118 | L2-Norm(final)=8.517 | 4938.2 samples/s | 77.2 steps/s
[Step=17250 Epoch=84.6] | Loss=0.02097 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.126 | L2-Norm(final)=8.519 | 4898.4 samples/s | 76.5 steps/s
[Step=17300 Epoch=84.8] | Loss=0.02026 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.132 | L2-Norm(final)=8.521 | 5824.8 samples/s | 91.0 steps/s
[Step=17350 Epoch=85.1] | Loss=0.01940 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.139 | L2-Norm(final)=8.523 | 1939.9 samples/s | 30.3 steps/s
[Step=17400 Epoch=85.3] | Loss=0.01862 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.144 | L2-Norm(final)=8.526 | 4913.3 samples/s | 76.8 steps/s
[Step=17450 Epoch=85.6] | Loss=0.01809 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.149 | L2-Norm(final)=8.527 | 4724.8 samples/s | 73.8 steps/s
[Step=17500 Epoch=85.8] | Loss=0.01749 | Reg=0.00230 | acc=0.9688 | L2-Norm=15.153 | L2-Norm(final)=8.529 | 5442.7 samples/s | 85.0 steps/s
[Step=17550 Epoch=86.1] | Loss=0.01704 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.157 | L2-Norm(final)=8.531 | 1956.5 samples/s | 30.6 steps/s
[Step=17600 Epoch=86.3] | Loss=0.01651 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.160 | L2-Norm(final)=8.532 | 4837.2 samples/s | 75.6 steps/s
[Step=17650 Epoch=86.6] | Loss=0.01603 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.163 | L2-Norm(final)=8.534 | 4860.2 samples/s | 75.9 steps/s
[Step=17700 Epoch=86.8] | Loss=0.01557 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.165 | L2-Norm(final)=8.536 | 5180.3 samples/s | 80.9 steps/s
[Step=17750 Epoch=87.0] | Loss=0.01509 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.167 | L2-Norm(final)=8.537 | 1978.6 samples/s | 30.9 steps/s
[Step=17800 Epoch=87.3] | Loss=0.01463 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.168 | L2-Norm(final)=8.539 | 4962.3 samples/s | 77.5 steps/s
[Step=17850 Epoch=87.5] | Loss=0.01425 | Reg=0.00230 | acc=0.9688 | L2-Norm=15.169 | L2-Norm(final)=8.541 | 4919.0 samples/s | 76.9 steps/s
[Step=17900 Epoch=87.8] | Loss=0.01392 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.169 | L2-Norm(final)=8.543 | 5035.9 samples/s | 78.7 steps/s
[Step=17950 Epoch=88.0] | Loss=0.01368 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.169 | L2-Norm(final)=8.545 | 2001.8 samples/s | 31.3 steps/s
[Step=18000 Epoch=88.3] | Loss=0.01337 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.169 | L2-Norm(final)=8.546 | 4912.0 samples/s | 76.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step18000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=14001 Epoch=133.7] | Loss=0.05716 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.614 | L2-Norm(final)=6.580 | 3835.4 samples/s | 59.9 steps/s
[Step=14050 Epoch=134.2] | Loss=0.00748 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.812 | L2-Norm(final)=6.535 | 5356.5 samples/s | 83.7 steps/s
[Step=14100 Epoch=134.6] | Loss=0.00475 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.885 | L2-Norm(final)=6.553 | 7205.1 samples/s | 112.6 steps/s
[Step=14150 Epoch=135.1] | Loss=0.00345 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.915 | L2-Norm(final)=6.576 | 1862.3 samples/s | 29.1 steps/s
[Step=14200 Epoch=135.6] | Loss=0.00274 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.926 | L2-Norm(final)=6.596 | 7011.6 samples/s | 109.6 steps/s
[Step=14250 Epoch=136.1] | Loss=0.00224 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.926 | L2-Norm(final)=6.613 | 1906.3 samples/s | 29.8 steps/s
[Step=14300 Epoch=136.6] | Loss=0.00191 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.921 | L2-Norm(final)=6.628 | 6270.0 samples/s | 98.0 steps/s
[Step=14350 Epoch=137.0] | Loss=0.00167 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.912 | L2-Norm(final)=6.643 | 1939.0 samples/s | 30.3 steps/s
[Step=14400 Epoch=137.5] | Loss=0.00148 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.902 | L2-Norm(final)=6.656 | 5913.9 samples/s | 92.4 steps/s
[Step=14450 Epoch=138.0] | Loss=0.00133 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.889 | L2-Norm(final)=6.669 | 1968.6 samples/s | 30.8 steps/s
[Step=14500 Epoch=138.5] | Loss=0.00122 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.875 | L2-Norm(final)=6.681 | 5586.4 samples/s | 87.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=138.5] | Loss=0.00010 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.732 | L2-Norm(final)=6.798 | 3980.7 samples/s | 62.2 steps/s
[Step=14550 Epoch=138.9] | Loss=0.00010 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.709 | L2-Norm(final)=6.806 | 4243.9 samples/s | 66.3 steps/s
[Step=14600 Epoch=139.4] | Loss=0.00007 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.680 | L2-Norm(final)=6.811 | 6299.0 samples/s | 98.4 steps/s
[Step=14650 Epoch=139.9] | Loss=0.00005 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.650 | L2-Norm(final)=6.815 | 1810.4 samples/s | 28.3 steps/s
[Step=14700 Epoch=140.4] | Loss=0.00004 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.620 | L2-Norm(final)=6.818 | 5994.9 samples/s | 93.7 steps/s
[Step=14750 Epoch=140.9] | Loss=0.00004 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.588 | L2-Norm(final)=6.821 | 1822.5 samples/s | 28.5 steps/s
[Step=14800 Epoch=141.3] | Loss=0.00003 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.557 | L2-Norm(final)=6.823 | 5645.3 samples/s | 88.2 steps/s
[Step=14850 Epoch=141.8] | Loss=0.00003 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.526 | L2-Norm(final)=6.824 | 1876.2 samples/s | 29.3 steps/s
[Step=14900 Epoch=142.3] | Loss=0.00003 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.494 | L2-Norm(final)=6.826 | 5265.3 samples/s | 82.3 steps/s
[Step=14950 Epoch=142.8] | Loss=0.00003 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.463 | L2-Norm(final)=6.827 | 1905.5 samples/s | 29.8 steps/s
[Step=15000 Epoch=143.2] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.432 | L2-Norm(final)=6.829 | 4962.3 samples/s | 77.5 steps/s
[Step=15050 Epoch=143.7] | Loss=0.00002 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.401 | L2-Norm(final)=6.830 | 1942.2 samples/s | 30.3 steps/s
[Step=15100 Epoch=144.2] | Loss=0.00002 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.369 | L2-Norm(final)=6.832 | 4590.0 samples/s | 71.7 steps/s
[Step=15150 Epoch=144.7] | Loss=0.00002 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.338 | L2-Norm(final)=6.833 | 1993.7 samples/s | 31.2 steps/s
[Step=15200 Epoch=145.2] | Loss=0.00002 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.307 | L2-Norm(final)=6.834 | 4765.7 samples/s | 74.5 steps/s
[Step=15250 Epoch=145.6] | Loss=0.00002 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.276 | L2-Norm(final)=6.835 | 1987.6 samples/s | 31.1 steps/s
[Step=15300 Epoch=146.1] | Loss=0.00002 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.245 | L2-Norm(final)=6.836 | 4721.3 samples/s | 73.8 steps/s
[Step=15350 Epoch=146.6] | Loss=0.00002 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.214 | L2-Norm(final)=6.837 | 1999.8 samples/s | 31.2 steps/s
[Step=15400 Epoch=147.1] | Loss=0.00002 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.183 | L2-Norm(final)=6.839 | 4717.9 samples/s | 73.7 steps/s
[Step=15450 Epoch=147.5] | Loss=0.00002 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.153 | L2-Norm(final)=6.840 | 2016.1 samples/s | 31.5 steps/s
[Step=15500 Epoch=148.0] | Loss=0.00001 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.122 | L2-Norm(final)=6.841 | 4639.6 samples/s | 72.5 steps/s
[Step=15550 Epoch=148.5] | Loss=0.00001 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.091 | L2-Norm(final)=6.842 | 6920.7 samples/s | 108.1 steps/s
[Step=15600 Epoch=149.0] | Loss=0.00001 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.060 | L2-Norm(final)=6.843 | 1739.3 samples/s | 27.2 steps/s
[Step=15650 Epoch=149.4] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.030 | L2-Norm(final)=6.844 | 6418.0 samples/s | 100.3 steps/s
[Step=15700 Epoch=149.9] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.999 | L2-Norm(final)=6.845 | 1795.0 samples/s | 28.0 steps/s
[Step=15750 Epoch=150.4] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.968 | L2-Norm(final)=6.846 | 6031.2 samples/s | 94.2 steps/s
[Step=15800 Epoch=150.9] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.938 | L2-Norm(final)=6.847 | 1834.6 samples/s | 28.7 steps/s
[Step=15850 Epoch=151.4] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.907 | L2-Norm(final)=6.848 | 5626.4 samples/s | 87.9 steps/s
[Step=15900 Epoch=151.8] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.876 | L2-Norm(final)=6.849 | 1865.5 samples/s | 29.1 steps/s
[Step=15950 Epoch=152.3] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.846 | L2-Norm(final)=6.850 | 5150.6 samples/s | 80.5 steps/s
[Step=16000 Epoch=152.8] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.815 | L2-Norm(final)=6.851 | 1892.2 samples/s | 29.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step16000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=8001 Epoch=76.3] | Loss=0.05730 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.614 | L2-Norm(final)=6.084 | 3893.0 samples/s | 60.8 steps/s
[Step=8050 Epoch=76.7] | Loss=0.00959 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.857 | L2-Norm(final)=6.133 | 4948.3 samples/s | 77.3 steps/s
[Step=8100 Epoch=77.2] | Loss=0.00670 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.028 | L2-Norm(final)=6.178 | 7188.5 samples/s | 112.3 steps/s
[Step=8150 Epoch=77.7] | Loss=0.00479 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.124 | L2-Norm(final)=6.219 | 1864.6 samples/s | 29.1 steps/s
[Step=8200 Epoch=78.2] | Loss=0.00375 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.172 | L2-Norm(final)=6.253 | 6706.6 samples/s | 104.8 steps/s
[Step=8250 Epoch=78.6] | Loss=0.00310 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.196 | L2-Norm(final)=6.282 | 1851.7 samples/s | 28.9 steps/s
[Step=8300 Epoch=79.1] | Loss=0.00264 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.208 | L2-Norm(final)=6.308 | 6425.3 samples/s | 100.4 steps/s
[Step=8350 Epoch=79.6] | Loss=0.00232 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.212 | L2-Norm(final)=6.331 | 1969.4 samples/s | 30.8 steps/s
[Step=8400 Epoch=80.1] | Loss=0.00207 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.211 | L2-Norm(final)=6.353 | 5929.2 samples/s | 92.6 steps/s
[Step=8450 Epoch=80.5] | Loss=0.00187 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.206 | L2-Norm(final)=6.373 | 1938.9 samples/s | 30.3 steps/s
[Step=8500 Epoch=81.0] | Loss=0.00170 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.199 | L2-Norm(final)=6.391 | 5652.2 samples/s | 88.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=8501 Epoch=81.0] | Loss=0.00016 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.107 | L2-Norm(final)=6.574 | 3696.4 samples/s | 57.8 steps/s
[Step=8550 Epoch=81.5] | Loss=0.00035 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.076 | L2-Norm(final)=6.583 | 4494.1 samples/s | 70.2 steps/s
[Step=8600 Epoch=82.0] | Loss=0.01046 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.136 | L2-Norm(final)=6.539 | 6343.1 samples/s | 99.1 steps/s
[Step=8650 Epoch=82.4] | Loss=0.00798 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.207 | L2-Norm(final)=6.508 | 1773.0 samples/s | 27.7 steps/s
[Step=8700 Epoch=82.9] | Loss=0.00610 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.245 | L2-Norm(final)=6.497 | 5982.8 samples/s | 93.5 steps/s
[Step=8750 Epoch=83.4] | Loss=0.00491 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.261 | L2-Norm(final)=6.492 | 1819.1 samples/s | 28.4 steps/s
[Step=8800 Epoch=83.9] | Loss=0.00410 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.264 | L2-Norm(final)=6.490 | 5577.1 samples/s | 87.1 steps/s
[Step=8850 Epoch=84.3] | Loss=0.00352 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.259 | L2-Norm(final)=6.489 | 1853.1 samples/s | 29.0 steps/s
[Step=8900 Epoch=84.8] | Loss=0.00308 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.248 | L2-Norm(final)=6.489 | 5309.1 samples/s | 83.0 steps/s
[Step=8950 Epoch=85.3] | Loss=0.00274 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.235 | L2-Norm(final)=6.489 | 1899.5 samples/s | 29.7 steps/s
[Step=9000 Epoch=85.8] | Loss=0.00247 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.219 | L2-Norm(final)=6.490 | 5002.6 samples/s | 78.2 steps/s
[Step=9050 Epoch=86.3] | Loss=0.00225 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.202 | L2-Norm(final)=6.490 | 1922.1 samples/s | 30.0 steps/s
[Step=9100 Epoch=86.7] | Loss=0.00206 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.183 | L2-Norm(final)=6.491 | 4786.9 samples/s | 74.8 steps/s
[Step=9150 Epoch=87.2] | Loss=0.00190 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.163 | L2-Norm(final)=6.491 | 1980.2 samples/s | 30.9 steps/s
[Step=9200 Epoch=87.7] | Loss=0.00177 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.142 | L2-Norm(final)=6.492 | 4747.6 samples/s | 74.2 steps/s
[Step=9250 Epoch=88.2] | Loss=0.00165 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=6.493 | 1971.5 samples/s | 30.8 steps/s
[Step=9300 Epoch=88.6] | Loss=0.00155 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.099 | L2-Norm(final)=6.494 | 4774.7 samples/s | 74.6 steps/s
[Step=9350 Epoch=89.1] | Loss=0.00146 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.077 | L2-Norm(final)=6.494 | 2016.7 samples/s | 31.5 steps/s
[Step=9400 Epoch=89.6] | Loss=0.00138 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.055 | L2-Norm(final)=6.495 | 4554.1 samples/s | 71.2 steps/s
[Step=9450 Epoch=90.1] | Loss=0.00131 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.032 | L2-Norm(final)=6.496 | 2018.2 samples/s | 31.5 steps/s
[Step=9500 Epoch=90.5] | Loss=0.00124 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.009 | L2-Norm(final)=6.497 | 4564.3 samples/s | 71.3 steps/s
[Step=9550 Epoch=91.0] | Loss=0.00118 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.985 | L2-Norm(final)=6.498 | 6879.8 samples/s | 107.5 steps/s
[Step=9600 Epoch=91.5] | Loss=0.00113 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.962 | L2-Norm(final)=6.499 | 1769.2 samples/s | 27.6 steps/s
[Step=9650 Epoch=92.0] | Loss=0.00108 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.938 | L2-Norm(final)=6.500 | 6434.9 samples/s | 100.5 steps/s
[Step=9700 Epoch=92.4] | Loss=0.00104 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.915 | L2-Norm(final)=6.501 | 1801.5 samples/s | 28.1 steps/s
[Step=9750 Epoch=92.9] | Loss=0.00100 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.891 | L2-Norm(final)=6.502 | 5909.7 samples/s | 92.3 steps/s
[Step=9800 Epoch=93.4] | Loss=0.00096 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.867 | L2-Norm(final)=6.503 | 1369.6 samples/s | 21.4 steps/s
[Step=9850 Epoch=93.9] | Loss=0.00092 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.842 | L2-Norm(final)=6.504 | 4848.5 samples/s | 75.8 steps/s
[Step=9900 Epoch=94.4] | Loss=0.00089 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.818 | L2-Norm(final)=6.505 | 1843.4 samples/s | 28.8 steps/s
[Step=9950 Epoch=94.8] | Loss=0.00086 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.794 | L2-Norm(final)=6.506 | 5300.4 samples/s | 82.8 steps/s
[Step=10000 Epoch=95.3] | Loss=0.00083 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.769 | L2-Norm(final)=6.507 | 1902.4 samples/s | 29.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step10000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10251 | acc=0.9546 | tpr=0.9673 | fpr=0.0728 | 4371.0 samples/s | 17.1 steps/s
Avg test loss: 0.10786, Avg test acc: 0.95272, Avg tpr: 0.96602, Avg fpr: 0.07653, total FA: 597

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.12302 | acc=0.9508 | tpr=0.9724 | fpr=0.0961 | 4417.7 samples/s | 17.3 steps/s
Avg test loss: 0.12831, Avg test acc: 0.94972, Avg tpr: 0.97191, Avg fpr: 0.09909, total FA: 773

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.12133 | acc=0.9488 | tpr=0.9554 | fpr=0.0654 | 4344.4 samples/s | 17.0 steps/s
Avg test loss: 0.12787, Avg test acc: 0.94727, Avg tpr: 0.95355, Avg fpr: 0.06653, total FA: 519

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10848 | acc=0.9538 | tpr=0.9741 | fpr=0.0902 | 4348.8 samples/s | 17.0 steps/s
Avg test loss: 0.11150, Avg test acc: 0.95196, Avg tpr: 0.97278, Avg fpr: 0.09383, total FA: 732

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10714 | acc=0.9544 | tpr=0.9704 | fpr=0.0805 | 4448.1 samples/s | 17.4 steps/s
Avg test loss: 0.11307, Avg test acc: 0.95304, Avg tpr: 0.96905, Avg fpr: 0.08217, total FA: 641

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.14314 | acc=0.3084 | tpr=0.0027 | fpr=0.0278 | 4391.6 samples/s | 17.2 steps/s
Avg test loss: 4.16161, Avg test acc: 0.30523, Avg tpr: 0.00321, Avg fpr: 0.03051, total FA: 238

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.22583 | acc=0.3117 | tpr=0.0021 | fpr=0.0159 | 4357.0 samples/s | 17.0 steps/s
Avg test loss: 4.23372, Avg test acc: 0.30960, Avg tpr: 0.00204, Avg fpr: 0.01397, total FA: 109

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.55531 | acc=0.2905 | tpr=0.0072 | fpr=0.0942 | 4358.9 samples/s | 17.0 steps/s
Avg test loss: 4.55816, Avg test acc: 0.28981, Avg tpr: 0.00886, Avg fpr: 0.09230, total FA: 720

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.14320 | acc=0.3026 | tpr=0.0026 | fpr=0.0461 | 4316.8 samples/s | 16.9 steps/s
Avg test loss: 4.14816, Avg test acc: 0.30143, Avg tpr: 0.00373, Avg fpr: 0.04384, total FA: 342

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.00143 | acc=0.3140 | tpr=0.0016 | fpr=0.0077 | 4393.9 samples/s | 17.2 steps/s
Avg test loss: 4.01965, Avg test acc: 0.31108, Avg tpr: 0.00146, Avg fpr: 0.00795, total FA: 62

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.07291 | acc=0.1197 | tpr=0.7699 | fpr=0.8920 | 4319.4 samples/s | 16.9 steps/s
[Step= 100] | Loss=5.04212 | acc=0.1214 | tpr=0.7441 | fpr=0.8903 | 9100.2 samples/s | 35.5 steps/s
[Step= 150] | Loss=5.05036 | acc=0.1209 | tpr=0.7406 | fpr=0.8905 | 8020.4 samples/s | 31.3 steps/s
[Step= 200] | Loss=5.04955 | acc=0.1202 | tpr=0.7454 | fpr=0.8911 | 9754.0 samples/s | 38.1 steps/s
[Step= 250] | Loss=5.04877 | acc=0.1207 | tpr=0.7485 | fpr=0.8907 | 7687.3 samples/s | 30.0 steps/s
[Step= 300] | Loss=5.04514 | acc=0.1208 | tpr=0.7469 | fpr=0.8906 | 8249.6 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.04174 | acc=0.1209 | tpr=0.7401 | fpr=0.8904 | 7425.0 samples/s | 29.0 steps/s
[Step= 400] | Loss=5.04119 | acc=0.1214 | tpr=0.7380 | fpr=0.8898 | 8249.9 samples/s | 32.2 steps/s
[Step= 450] | Loss=5.04313 | acc=0.1213 | tpr=0.7313 | fpr=0.8898 | 8643.4 samples/s | 33.8 steps/s
[Step= 500] | Loss=5.04342 | acc=0.1210 | tpr=0.7269 | fpr=0.8899 | 8738.4 samples/s | 34.1 steps/s
[Step= 550] | Loss=5.04488 | acc=0.1210 | tpr=0.7298 | fpr=0.8901 | 14529.3 samples/s | 56.8 steps/s
Avg test loss: 5.04608, Avg test acc: 0.12087, Avg tpr: 0.73019, Avg fpr: 0.89021, total FA: 123604

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=6.09791 | acc=0.1071 | tpr=0.8230 | fpr=0.9058 | 4319.4 samples/s | 16.9 steps/s
[Step= 100] | Loss=6.04445 | acc=0.1095 | tpr=0.7761 | fpr=0.9029 | 8791.0 samples/s | 34.3 steps/s
[Step= 150] | Loss=6.05266 | acc=0.1071 | tpr=0.7680 | fpr=0.9051 | 8554.8 samples/s | 33.4 steps/s
[Step= 200] | Loss=6.04764 | acc=0.1063 | tpr=0.7596 | fpr=0.9056 | 8415.9 samples/s | 32.9 steps/s
[Step= 250] | Loss=6.04478 | acc=0.1071 | tpr=0.7590 | fpr=0.9047 | 8584.6 samples/s | 33.5 steps/s
[Step= 300] | Loss=6.04423 | acc=0.1067 | tpr=0.7644 | fpr=0.9053 | 8603.5 samples/s | 33.6 steps/s
[Step= 350] | Loss=6.04074 | acc=0.1073 | tpr=0.7608 | fpr=0.9046 | 9306.7 samples/s | 36.4 steps/s
[Step= 400] | Loss=6.03978 | acc=0.1074 | tpr=0.7604 | fpr=0.9044 | 8092.5 samples/s | 31.6 steps/s
[Step= 450] | Loss=6.04486 | acc=0.1073 | tpr=0.7561 | fpr=0.9044 | 8649.6 samples/s | 33.8 steps/s
[Step= 500] | Loss=6.05147 | acc=0.1068 | tpr=0.7533 | fpr=0.9048 | 8734.3 samples/s | 34.1 steps/s
[Step= 550] | Loss=6.05172 | acc=0.1067 | tpr=0.7565 | fpr=0.9051 | 14907.5 samples/s | 58.2 steps/s
Avg test loss: 6.05344, Avg test acc: 0.10663, Avg tpr: 0.75634, Avg fpr: 0.90518, total FA: 125683

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.62295 | acc=0.1277 | tpr=0.6062 | fpr=0.8809 | 4398.0 samples/s | 17.2 steps/s
[Step= 100] | Loss=5.60079 | acc=0.1291 | tpr=0.5714 | fpr=0.8792 | 8561.6 samples/s | 33.4 steps/s
[Step= 150] | Loss=5.61163 | acc=0.1278 | tpr=0.5951 | fpr=0.8808 | 8777.7 samples/s | 34.3 steps/s
[Step= 200] | Loss=5.61479 | acc=0.1268 | tpr=0.5858 | fpr=0.8815 | 8611.5 samples/s | 33.6 steps/s
[Step= 250] | Loss=5.61571 | acc=0.1263 | tpr=0.5834 | fpr=0.8820 | 8594.2 samples/s | 33.6 steps/s
[Step= 300] | Loss=5.61482 | acc=0.1260 | tpr=0.5876 | fpr=0.8825 | 8464.3 samples/s | 33.1 steps/s
[Step= 350] | Loss=5.61362 | acc=0.1257 | tpr=0.5811 | fpr=0.8826 | 8717.0 samples/s | 34.1 steps/s
[Step= 400] | Loss=5.61750 | acc=0.1257 | tpr=0.5744 | fpr=0.8824 | 8469.1 samples/s | 33.1 steps/s
[Step= 450] | Loss=5.62098 | acc=0.1253 | tpr=0.5696 | fpr=0.8827 | 8768.3 samples/s | 34.3 steps/s
[Step= 500] | Loss=5.61897 | acc=0.1256 | tpr=0.5687 | fpr=0.8824 | 8520.9 samples/s | 33.3 steps/s
[Step= 550] | Loss=5.62149 | acc=0.1257 | tpr=0.5746 | fpr=0.8825 | 14709.4 samples/s | 57.5 steps/s
Avg test loss: 5.62409, Avg test acc: 0.12560, Avg tpr: 0.57488, Avg fpr: 0.88256, total FA: 122542

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.18652 | acc=0.1279 | tpr=0.8186 | fpr=0.8845 | 4251.1 samples/s | 16.6 steps/s
[Step= 100] | Loss=5.15305 | acc=0.1290 | tpr=0.7569 | fpr=0.8827 | 8668.7 samples/s | 33.9 steps/s
[Step= 150] | Loss=5.15380 | acc=0.1273 | tpr=0.7651 | fpr=0.8845 | 8249.8 samples/s | 32.2 steps/s
[Step= 200] | Loss=5.15039 | acc=0.1269 | tpr=0.7661 | fpr=0.8847 | 8506.5 samples/s | 33.2 steps/s
[Step= 250] | Loss=5.15411 | acc=0.1271 | tpr=0.7616 | fpr=0.8845 | 8831.6 samples/s | 34.5 steps/s
[Step= 300] | Loss=5.15294 | acc=0.1266 | tpr=0.7615 | fpr=0.8850 | 8346.2 samples/s | 32.6 steps/s
[Step= 350] | Loss=5.15011 | acc=0.1271 | tpr=0.7621 | fpr=0.8845 | 8389.2 samples/s | 32.8 steps/s
[Step= 400] | Loss=5.15351 | acc=0.1268 | tpr=0.7593 | fpr=0.8847 | 8490.3 samples/s | 33.2 steps/s
[Step= 450] | Loss=5.15579 | acc=0.1271 | tpr=0.7517 | fpr=0.8843 | 8452.7 samples/s | 33.0 steps/s
[Step= 500] | Loss=5.15669 | acc=0.1270 | tpr=0.7511 | fpr=0.8843 | 8729.9 samples/s | 34.1 steps/s
[Step= 550] | Loss=5.15561 | acc=0.1266 | tpr=0.7533 | fpr=0.8848 | 15081.4 samples/s | 58.9 steps/s
Avg test loss: 5.15685, Avg test acc: 0.12650, Avg tpr: 0.75317, Avg fpr: 0.88490, total FA: 122866

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.54766 | acc=0.1163 | tpr=0.7212 | fpr=0.8945 | 4327.2 samples/s | 16.9 steps/s
[Step= 100] | Loss=5.51394 | acc=0.1184 | tpr=0.6844 | fpr=0.8922 | 8370.6 samples/s | 32.7 steps/s
[Step= 150] | Loss=5.51936 | acc=0.1168 | tpr=0.6859 | fpr=0.8937 | 8593.5 samples/s | 33.6 steps/s
[Step= 200] | Loss=5.52162 | acc=0.1166 | tpr=0.6754 | fpr=0.8936 | 8641.1 samples/s | 33.8 steps/s
[Step= 250] | Loss=5.52470 | acc=0.1161 | tpr=0.6734 | fpr=0.8940 | 8684.8 samples/s | 33.9 steps/s
[Step= 300] | Loss=5.52446 | acc=0.1163 | tpr=0.6742 | fpr=0.8938 | 8381.4 samples/s | 32.7 steps/s
[Step= 350] | Loss=5.51876 | acc=0.1163 | tpr=0.6669 | fpr=0.8937 | 7947.4 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.51791 | acc=0.1166 | tpr=0.6603 | fpr=0.8932 | 8429.7 samples/s | 32.9 steps/s
[Step= 450] | Loss=5.51935 | acc=0.1165 | tpr=0.6490 | fpr=0.8931 | 8394.0 samples/s | 32.8 steps/s
[Step= 500] | Loss=5.51913 | acc=0.1161 | tpr=0.6467 | fpr=0.8935 | 8321.2 samples/s | 32.5 steps/s
[Step= 550] | Loss=5.52183 | acc=0.1161 | tpr=0.6494 | fpr=0.8936 | 14699.8 samples/s | 57.4 steps/s
Avg test loss: 5.52414, Avg test acc: 0.11605, Avg tpr: 0.64976, Avg fpr: 0.89365, total FA: 124082

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09306 | acc=0.9815 | tpr=0.8982 | fpr=0.0170 | 4297.6 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.09512 | acc=0.9811 | tpr=0.9211 | fpr=0.0178 | 8129.6 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.09822 | acc=0.9803 | tpr=0.9222 | fpr=0.0186 | 8319.1 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.10022 | acc=0.9801 | tpr=0.9180 | fpr=0.0188 | 8534.8 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.09931 | acc=0.9802 | tpr=0.9188 | fpr=0.0187 | 8375.0 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.10048 | acc=0.9800 | tpr=0.9200 | fpr=0.0189 | 8586.0 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.10120 | acc=0.9797 | tpr=0.9186 | fpr=0.0192 | 8727.6 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.10190 | acc=0.9796 | tpr=0.9141 | fpr=0.0193 | 8538.2 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.10450 | acc=0.9792 | tpr=0.9133 | fpr=0.0196 | 8575.1 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.10387 | acc=0.9793 | tpr=0.9145 | fpr=0.0195 | 8709.7 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.10309 | acc=0.9794 | tpr=0.9152 | fpr=0.0194 | 14992.1 samples/s | 58.6 steps/s
Avg test loss: 0.10301, Avg test acc: 0.97943, Avg tpr: 0.91521, Avg fpr: 0.01940, total FA: 2694

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10875 | acc=0.9818 | tpr=0.8717 | fpr=0.0162 | 4327.8 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.11622 | acc=0.9814 | tpr=0.8891 | fpr=0.0169 | 8596.4 samples/s | 33.6 steps/s
[Step= 150] | Loss=0.11950 | acc=0.9808 | tpr=0.8948 | fpr=0.0176 | 8519.7 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.12145 | acc=0.9808 | tpr=0.8929 | fpr=0.0176 | 8606.0 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.12075 | acc=0.9808 | tpr=0.8891 | fpr=0.0175 | 8792.3 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.12256 | acc=0.9806 | tpr=0.8887 | fpr=0.0177 | 8399.4 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.12296 | acc=0.9804 | tpr=0.8917 | fpr=0.0180 | 8590.1 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.12472 | acc=0.9801 | tpr=0.8862 | fpr=0.0182 | 8595.5 samples/s | 33.6 steps/s
[Step= 450] | Loss=0.12810 | acc=0.9798 | tpr=0.8851 | fpr=0.0184 | 9037.7 samples/s | 35.3 steps/s
[Step= 500] | Loss=0.12742 | acc=0.9799 | tpr=0.8872 | fpr=0.0184 | 8788.0 samples/s | 34.3 steps/s
[Step= 550] | Loss=0.12690 | acc=0.9800 | tpr=0.8862 | fpr=0.0183 | 14019.1 samples/s | 54.8 steps/s
Avg test loss: 0.12673, Avg test acc: 0.97999, Avg tpr: 0.88550, Avg fpr: 0.01829, total FA: 2540

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10934 | acc=0.9803 | tpr=0.9425 | fpr=0.0190 | 4369.5 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.11284 | acc=0.9798 | tpr=0.9574 | fpr=0.0197 | 8352.4 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.11704 | acc=0.9788 | tpr=0.9539 | fpr=0.0208 | 8631.3 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.11987 | acc=0.9785 | tpr=0.9541 | fpr=0.0211 | 8638.7 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.11888 | acc=0.9785 | tpr=0.9520 | fpr=0.0211 | 8659.2 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.12068 | acc=0.9781 | tpr=0.9498 | fpr=0.0214 | 8827.8 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.12051 | acc=0.9780 | tpr=0.9493 | fpr=0.0215 | 8578.9 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.12204 | acc=0.9777 | tpr=0.9437 | fpr=0.0216 | 8405.8 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.12481 | acc=0.9774 | tpr=0.9426 | fpr=0.0219 | 8506.3 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.12429 | acc=0.9774 | tpr=0.9441 | fpr=0.0220 | 8417.5 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.12307 | acc=0.9777 | tpr=0.9439 | fpr=0.0217 | 15674.6 samples/s | 61.2 steps/s
Avg test loss: 0.12291, Avg test acc: 0.97773, Avg tpr: 0.94374, Avg fpr: 0.02165, total FA: 3006

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10929 | acc=0.9807 | tpr=0.8982 | fpr=0.0178 | 4200.0 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.11420 | acc=0.9802 | tpr=0.9211 | fpr=0.0187 | 8408.0 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.11818 | acc=0.9794 | tpr=0.9236 | fpr=0.0196 | 8678.0 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.12178 | acc=0.9792 | tpr=0.9301 | fpr=0.0199 | 8521.4 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.12031 | acc=0.9792 | tpr=0.9275 | fpr=0.0198 | 8622.0 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.12205 | acc=0.9790 | tpr=0.9302 | fpr=0.0201 | 8599.8 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.12190 | acc=0.9789 | tpr=0.9311 | fpr=0.0202 | 8456.9 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.12317 | acc=0.9787 | tpr=0.9256 | fpr=0.0203 | 8549.7 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.12612 | acc=0.9783 | tpr=0.9241 | fpr=0.0207 | 8491.0 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.12538 | acc=0.9783 | tpr=0.9256 | fpr=0.0207 | 8723.9 samples/s | 34.1 steps/s
[Step= 550] | Loss=0.12440 | acc=0.9785 | tpr=0.9264 | fpr=0.0206 | 15163.3 samples/s | 59.2 steps/s
Avg test loss: 0.12418, Avg test acc: 0.97848, Avg tpr: 0.92552, Avg fpr: 0.02055, total FA: 2854

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.10710 | acc=0.9832 | tpr=0.8805 | fpr=0.0150 | 4399.1 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.11292 | acc=0.9823 | tpr=0.8998 | fpr=0.0162 | 8387.9 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.11541 | acc=0.9815 | tpr=0.9006 | fpr=0.0170 | 8468.2 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.11833 | acc=0.9813 | tpr=0.9016 | fpr=0.0173 | 8330.4 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.11779 | acc=0.9813 | tpr=0.8969 | fpr=0.0172 | 8805.7 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.12011 | acc=0.9809 | tpr=0.8916 | fpr=0.0175 | 8729.5 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.12021 | acc=0.9807 | tpr=0.8929 | fpr=0.0177 | 8325.4 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.12122 | acc=0.9804 | tpr=0.8862 | fpr=0.0179 | 8706.0 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.12340 | acc=0.9801 | tpr=0.8870 | fpr=0.0182 | 8583.1 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.12310 | acc=0.9802 | tpr=0.8885 | fpr=0.0182 | 8751.2 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.12236 | acc=0.9803 | tpr=0.8866 | fpr=0.0180 | 15033.7 samples/s | 58.7 steps/s
Avg test loss: 0.12209, Avg test acc: 0.98026, Avg tpr: 0.88590, Avg fpr: 0.01803, total FA: 2503

server round 14/50

clients selected: [1 2 4 6 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=20001 Epoch=97.6] | Loss=0.04326 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.390 | L2-Norm(final)=8.224 | 3803.3 samples/s | 59.4 steps/s
[Step=20050 Epoch=97.8] | Loss=0.04432 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.452 | L2-Norm(final)=8.224 | 5452.1 samples/s | 85.2 steps/s
[Step=20100 Epoch=98.1] | Loss=0.04236 | Reg=0.00183 | acc=0.9531 | L2-Norm=13.529 | L2-Norm(final)=8.238 | 5531.9 samples/s | 86.4 steps/s
[Step=20150 Epoch=98.3] | Loss=0.03987 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.603 | L2-Norm(final)=8.259 | 5507.4 samples/s | 86.1 steps/s
[Step=20200 Epoch=98.6] | Loss=0.03826 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.670 | L2-Norm(final)=8.282 | 7767.3 samples/s | 121.4 steps/s
[Step=20250 Epoch=98.8] | Loss=0.03703 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.731 | L2-Norm(final)=8.304 | 1928.9 samples/s | 30.1 steps/s
[Step=20300 Epoch=99.1] | Loss=0.03524 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.790 | L2-Norm(final)=8.328 | 5540.2 samples/s | 86.6 steps/s
[Step=20350 Epoch=99.3] | Loss=0.03384 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.849 | L2-Norm(final)=8.356 | 5519.2 samples/s | 86.2 steps/s
[Step=20400 Epoch=99.5] | Loss=0.03324 | Reg=0.00193 | acc=0.9219 | L2-Norm=13.906 | L2-Norm(final)=8.387 | 7172.5 samples/s | 112.1 steps/s
[Step=20450 Epoch=99.8] | Loss=0.03229 | Reg=0.00195 | acc=0.9688 | L2-Norm=13.962 | L2-Norm(final)=8.417 | 1946.0 samples/s | 30.4 steps/s
[Step=20500 Epoch=100.0] | Loss=0.03144 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.017 | L2-Norm(final)=8.448 | 5439.5 samples/s | 85.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=100.0] | Loss=0.01329 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.571 | L2-Norm(final)=8.769 | 3760.5 samples/s | 58.8 steps/s
[Step=20550 Epoch=100.3] | Loss=0.02933 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.628 | L2-Norm(final)=8.792 | 4958.0 samples/s | 77.5 steps/s
[Step=20600 Epoch=100.5] | Loss=0.04142 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.691 | L2-Norm(final)=8.778 | 4893.0 samples/s | 76.5 steps/s
[Step=20650 Epoch=100.8] | Loss=0.04370 | Reg=0.00217 | acc=0.9375 | L2-Norm=14.743 | L2-Norm(final)=8.761 | 4920.2 samples/s | 76.9 steps/s
[Step=20700 Epoch=101.0] | Loss=0.04283 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.784 | L2-Norm(final)=8.749 | 6632.5 samples/s | 103.6 steps/s
[Step=20750 Epoch=101.3] | Loss=0.03889 | Reg=0.00220 | acc=0.9688 | L2-Norm=14.821 | L2-Norm(final)=8.745 | 1855.7 samples/s | 29.0 steps/s
[Step=20800 Epoch=101.5] | Loss=0.03548 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.852 | L2-Norm(final)=8.745 | 4957.4 samples/s | 77.5 steps/s
[Step=20850 Epoch=101.7] | Loss=0.03311 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.876 | L2-Norm(final)=8.747 | 4842.3 samples/s | 75.7 steps/s
[Step=20900 Epoch=102.0] | Loss=0.03106 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.896 | L2-Norm(final)=8.749 | 6174.7 samples/s | 96.5 steps/s
[Step=20950 Epoch=102.2] | Loss=0.02885 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.915 | L2-Norm(final)=8.752 | 1880.1 samples/s | 29.4 steps/s
[Step=21000 Epoch=102.5] | Loss=0.02695 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.931 | L2-Norm(final)=8.756 | 4973.5 samples/s | 77.7 steps/s
[Step=21050 Epoch=102.7] | Loss=0.02565 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.944 | L2-Norm(final)=8.759 | 4871.9 samples/s | 76.1 steps/s
[Step=21100 Epoch=103.0] | Loss=0.02461 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.955 | L2-Norm(final)=8.762 | 5899.2 samples/s | 92.2 steps/s
[Step=21150 Epoch=103.2] | Loss=0.02314 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.966 | L2-Norm(final)=8.765 | 1937.9 samples/s | 30.3 steps/s
[Step=21200 Epoch=103.4] | Loss=0.02208 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.975 | L2-Norm(final)=8.768 | 4931.3 samples/s | 77.1 steps/s
[Step=21250 Epoch=103.7] | Loss=0.02123 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.982 | L2-Norm(final)=8.771 | 4880.6 samples/s | 76.3 steps/s
[Step=21300 Epoch=103.9] | Loss=0.02044 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.988 | L2-Norm(final)=8.774 | 5564.6 samples/s | 86.9 steps/s
[Step=21350 Epoch=104.2] | Loss=0.01952 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.994 | L2-Norm(final)=8.776 | 1968.4 samples/s | 30.8 steps/s
[Step=21400 Epoch=104.4] | Loss=0.01873 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.998 | L2-Norm(final)=8.779 | 4790.3 samples/s | 74.8 steps/s
[Step=21450 Epoch=104.7] | Loss=0.01804 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.002 | L2-Norm(final)=8.782 | 4837.9 samples/s | 75.6 steps/s
[Step=21500 Epoch=104.9] | Loss=0.01745 | Reg=0.00225 | acc=0.9844 | L2-Norm=15.005 | L2-Norm(final)=8.785 | 5134.2 samples/s | 80.2 steps/s
[Step=21550 Epoch=105.2] | Loss=0.01680 | Reg=0.00225 | acc=0.9844 | L2-Norm=15.007 | L2-Norm(final)=8.788 | 1994.2 samples/s | 31.2 steps/s
[Step=21600 Epoch=105.4] | Loss=0.01627 | Reg=0.00225 | acc=0.9844 | L2-Norm=15.010 | L2-Norm(final)=8.791 | 4975.3 samples/s | 77.7 steps/s
[Step=21650 Epoch=105.6] | Loss=0.01585 | Reg=0.00225 | acc=0.9844 | L2-Norm=15.011 | L2-Norm(final)=8.793 | 4920.2 samples/s | 76.9 steps/s
[Step=21700 Epoch=105.9] | Loss=0.01544 | Reg=0.00225 | acc=0.9844 | L2-Norm=15.013 | L2-Norm(final)=8.796 | 4985.1 samples/s | 77.9 steps/s
[Step=21750 Epoch=106.1] | Loss=0.01514 | Reg=0.00225 | acc=0.9844 | L2-Norm=15.014 | L2-Norm(final)=8.798 | 2035.7 samples/s | 31.8 steps/s
[Step=21800 Epoch=106.4] | Loss=0.01481 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.015 | L2-Norm(final)=8.801 | 4981.1 samples/s | 77.8 steps/s
[Step=21850 Epoch=106.6] | Loss=0.01442 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.016 | L2-Norm(final)=8.803 | 4965.2 samples/s | 77.6 steps/s
[Step=21900 Epoch=106.9] | Loss=0.01413 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.016 | L2-Norm(final)=8.805 | 4910.5 samples/s | 76.7 steps/s
[Step=21950 Epoch=107.1] | Loss=0.01384 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.017 | L2-Norm(final)=8.807 | 1943.3 samples/s | 30.4 steps/s
[Step=22000 Epoch=107.3] | Loss=0.01361 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.017 | L2-Norm(final)=8.810 | 4725.4 samples/s | 73.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step22000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=20001 Epoch=97.5] | Loss=0.07381 | Reg=0.00179 | acc=0.9531 | L2-Norm=13.390 | L2-Norm(final)=9.776 | 4053.0 samples/s | 63.3 steps/s
[Step=20050 Epoch=97.7] | Loss=0.04651 | Reg=0.00181 | acc=0.9375 | L2-Norm=13.469 | L2-Norm(final)=9.763 | 5106.6 samples/s | 79.8 steps/s
[Step=20100 Epoch=97.9] | Loss=0.04160 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.555 | L2-Norm(final)=9.767 | 5381.8 samples/s | 84.1 steps/s
[Step=20150 Epoch=98.2] | Loss=0.03880 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.621 | L2-Norm(final)=9.785 | 5512.1 samples/s | 86.1 steps/s
[Step=20200 Epoch=98.4] | Loss=0.03893 | Reg=0.00187 | acc=0.9688 | L2-Norm=13.680 | L2-Norm(final)=9.805 | 7745.3 samples/s | 121.0 steps/s
[Step=20250 Epoch=98.7] | Loss=0.03687 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.738 | L2-Norm(final)=9.825 | 1911.4 samples/s | 29.9 steps/s
[Step=20300 Epoch=98.9] | Loss=0.03539 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.795 | L2-Norm(final)=9.851 | 5508.6 samples/s | 86.1 steps/s
[Step=20350 Epoch=99.2] | Loss=0.03382 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.849 | L2-Norm(final)=9.881 | 5508.0 samples/s | 86.1 steps/s
[Step=20400 Epoch=99.4] | Loss=0.03291 | Reg=0.00193 | acc=0.9219 | L2-Norm=13.903 | L2-Norm(final)=9.914 | 7103.1 samples/s | 111.0 steps/s
[Step=20450 Epoch=99.6] | Loss=0.03142 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.955 | L2-Norm(final)=9.947 | 1969.7 samples/s | 30.8 steps/s
[Step=20500 Epoch=99.9] | Loss=0.03013 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.006 | L2-Norm(final)=9.982 | 5511.0 samples/s | 86.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=99.9] | Loss=0.01245 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.518 | L2-Norm(final)=10.341 | 3873.0 samples/s | 60.5 steps/s
[Step=20550 Epoch=100.1] | Loss=0.03096 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.563 | L2-Norm(final)=10.367 | 4667.4 samples/s | 72.9 steps/s
[Step=20600 Epoch=100.4] | Loss=0.03854 | Reg=0.00214 | acc=0.9531 | L2-Norm=14.620 | L2-Norm(final)=10.364 | 4916.8 samples/s | 76.8 steps/s
[Step=20650 Epoch=100.6] | Loss=0.04133 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.672 | L2-Norm(final)=10.358 | 4868.6 samples/s | 76.1 steps/s
[Step=20700 Epoch=100.9] | Loss=0.03993 | Reg=0.00217 | acc=0.9688 | L2-Norm=14.717 | L2-Norm(final)=10.353 | 6640.5 samples/s | 103.8 steps/s
[Step=20750 Epoch=101.1] | Loss=0.03535 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.755 | L2-Norm(final)=10.350 | 1867.3 samples/s | 29.2 steps/s
[Step=20800 Epoch=101.3] | Loss=0.03251 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.786 | L2-Norm(final)=10.350 | 4931.9 samples/s | 77.1 steps/s
[Step=20850 Epoch=101.6] | Loss=0.03048 | Reg=0.00219 | acc=0.9375 | L2-Norm=14.812 | L2-Norm(final)=10.354 | 4911.6 samples/s | 76.7 steps/s
[Step=20900 Epoch=101.8] | Loss=0.02883 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.836 | L2-Norm(final)=10.357 | 6089.9 samples/s | 95.2 steps/s
[Step=20950 Epoch=102.1] | Loss=0.02732 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.856 | L2-Norm(final)=10.358 | 1901.7 samples/s | 29.7 steps/s
[Step=21000 Epoch=102.3] | Loss=0.02551 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.874 | L2-Norm(final)=10.361 | 4977.6 samples/s | 77.8 steps/s
[Step=21050 Epoch=102.6] | Loss=0.02441 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.890 | L2-Norm(final)=10.364 | 4861.7 samples/s | 76.0 steps/s
[Step=21100 Epoch=102.8] | Loss=0.02349 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.904 | L2-Norm(final)=10.366 | 5736.7 samples/s | 89.6 steps/s
[Step=21150 Epoch=103.1] | Loss=0.02233 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.916 | L2-Norm(final)=10.368 | 1940.2 samples/s | 30.3 steps/s
[Step=21200 Epoch=103.3] | Loss=0.02144 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.927 | L2-Norm(final)=10.370 | 4970.6 samples/s | 77.7 steps/s
[Step=21250 Epoch=103.5] | Loss=0.02058 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.937 | L2-Norm(final)=10.373 | 4985.5 samples/s | 77.9 steps/s
[Step=21300 Epoch=103.8] | Loss=0.01997 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.946 | L2-Norm(final)=10.375 | 5305.8 samples/s | 82.9 steps/s
[Step=21350 Epoch=104.0] | Loss=0.01917 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.955 | L2-Norm(final)=10.378 | 1951.2 samples/s | 30.5 steps/s
[Step=21400 Epoch=104.3] | Loss=0.01838 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.963 | L2-Norm(final)=10.380 | 4567.0 samples/s | 71.4 steps/s
[Step=21450 Epoch=104.5] | Loss=0.01777 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.970 | L2-Norm(final)=10.383 | 4629.1 samples/s | 72.3 steps/s
[Step=21500 Epoch=104.8] | Loss=0.01723 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.976 | L2-Norm(final)=10.386 | 4853.8 samples/s | 75.8 steps/s
[Step=21550 Epoch=105.0] | Loss=0.01683 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.981 | L2-Norm(final)=10.389 | 2008.7 samples/s | 31.4 steps/s
[Step=21600 Epoch=105.2] | Loss=0.01630 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.986 | L2-Norm(final)=10.392 | 4997.1 samples/s | 78.1 steps/s
[Step=21650 Epoch=105.5] | Loss=0.01594 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.990 | L2-Norm(final)=10.394 | 4614.2 samples/s | 72.1 steps/s
[Step=21700 Epoch=105.7] | Loss=0.01549 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.993 | L2-Norm(final)=10.396 | 4724.2 samples/s | 73.8 steps/s
[Step=21750 Epoch=106.0] | Loss=0.01511 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.996 | L2-Norm(final)=10.398 | 2058.4 samples/s | 32.2 steps/s
[Step=21800 Epoch=106.2] | Loss=0.01465 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.998 | L2-Norm(final)=10.400 | 4998.6 samples/s | 78.1 steps/s
[Step=21850 Epoch=106.5] | Loss=0.01431 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.000 | L2-Norm(final)=10.402 | 4904.8 samples/s | 76.6 steps/s
[Step=21900 Epoch=106.7] | Loss=0.01397 | Reg=0.00225 | acc=0.9688 | L2-Norm=15.002 | L2-Norm(final)=10.404 | 4870.4 samples/s | 76.1 steps/s
[Step=21950 Epoch=107.0] | Loss=0.01370 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.004 | L2-Norm(final)=10.407 | 1888.8 samples/s | 29.5 steps/s
[Step=22000 Epoch=107.2] | Loss=0.01339 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.005 | L2-Norm(final)=10.408 | 4138.8 samples/s | 64.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step22000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=18001 Epoch=88.3] | Loss=0.02874 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.390 | L2-Norm(final)=8.591 | 3609.0 samples/s | 56.4 steps/s
[Step=18050 Epoch=88.5] | Loss=0.03927 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.453 | L2-Norm(final)=8.592 | 4362.5 samples/s | 68.2 steps/s
[Step=18100 Epoch=88.8] | Loss=0.03774 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.537 | L2-Norm(final)=8.607 | 4622.1 samples/s | 72.2 steps/s
[Step=18150 Epoch=89.0] | Loss=0.03666 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.610 | L2-Norm(final)=8.622 | 4635.9 samples/s | 72.4 steps/s
[Step=18200 Epoch=89.2] | Loss=0.03630 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.671 | L2-Norm(final)=8.636 | 6810.7 samples/s | 106.4 steps/s
[Step=18250 Epoch=89.5] | Loss=0.03426 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.727 | L2-Norm(final)=8.654 | 1935.2 samples/s | 30.2 steps/s
[Step=18300 Epoch=89.7] | Loss=0.03224 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.783 | L2-Norm(final)=8.678 | 5510.6 samples/s | 86.1 steps/s
[Step=18350 Epoch=90.0] | Loss=0.03128 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.837 | L2-Norm(final)=8.704 | 5519.0 samples/s | 86.2 steps/s
[Step=18400 Epoch=90.2] | Loss=0.03119 | Reg=0.00193 | acc=0.9375 | L2-Norm=13.889 | L2-Norm(final)=8.731 | 7214.2 samples/s | 112.7 steps/s
[Step=18450 Epoch=90.5] | Loss=0.03011 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.943 | L2-Norm(final)=8.757 | 1743.2 samples/s | 27.2 steps/s
[Step=18500 Epoch=90.7] | Loss=0.02925 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.996 | L2-Norm(final)=8.787 | 4671.4 samples/s | 73.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=90.7] | Loss=0.01183 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.517 | L2-Norm(final)=9.088 | 3549.7 samples/s | 55.5 steps/s
[Step=18550 Epoch=91.0] | Loss=0.03654 | Reg=0.00212 | acc=0.9375 | L2-Norm=14.569 | L2-Norm(final)=9.106 | 4055.7 samples/s | 63.4 steps/s
[Step=18600 Epoch=91.2] | Loss=0.04497 | Reg=0.00214 | acc=0.9375 | L2-Norm=14.628 | L2-Norm(final)=9.087 | 4285.7 samples/s | 67.0 steps/s
[Step=18650 Epoch=91.5] | Loss=0.04393 | Reg=0.00215 | acc=0.9375 | L2-Norm=14.675 | L2-Norm(final)=9.071 | 4591.4 samples/s | 71.7 steps/s
[Step=18700 Epoch=91.7] | Loss=0.04214 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.710 | L2-Norm(final)=9.058 | 6343.5 samples/s | 99.1 steps/s
[Step=18750 Epoch=91.9] | Loss=0.03723 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.738 | L2-Norm(final)=9.052 | 1786.8 samples/s | 27.9 steps/s
[Step=18800 Epoch=92.2] | Loss=0.03368 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.762 | L2-Norm(final)=9.051 | 4958.5 samples/s | 77.5 steps/s
[Step=18850 Epoch=92.4] | Loss=0.03099 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.781 | L2-Norm(final)=9.052 | 4788.5 samples/s | 74.8 steps/s
[Step=18900 Epoch=92.7] | Loss=0.02877 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.798 | L2-Norm(final)=9.054 | 6193.4 samples/s | 96.8 steps/s
[Step=18950 Epoch=92.9] | Loss=0.02704 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.813 | L2-Norm(final)=9.056 | 1829.6 samples/s | 28.6 steps/s
[Step=19000 Epoch=93.2] | Loss=0.02545 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.827 | L2-Norm(final)=9.059 | 4854.7 samples/s | 75.9 steps/s
[Step=19050 Epoch=93.4] | Loss=0.02398 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.841 | L2-Norm(final)=9.061 | 4882.1 samples/s | 76.3 steps/s
[Step=19100 Epoch=93.7] | Loss=0.02302 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.852 | L2-Norm(final)=9.064 | 5987.0 samples/s | 93.5 steps/s
[Step=19150 Epoch=93.9] | Loss=0.02199 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.862 | L2-Norm(final)=9.066 | 1913.5 samples/s | 29.9 steps/s
[Step=19200 Epoch=94.2] | Loss=0.02072 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.871 | L2-Norm(final)=9.068 | 4938.6 samples/s | 77.2 steps/s
[Step=19250 Epoch=94.4] | Loss=0.02004 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.879 | L2-Norm(final)=9.071 | 4939.0 samples/s | 77.2 steps/s
[Step=19300 Epoch=94.6] | Loss=0.01929 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.885 | L2-Norm(final)=9.073 | 5737.6 samples/s | 89.7 steps/s
[Step=19350 Epoch=94.9] | Loss=0.01887 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.891 | L2-Norm(final)=9.075 | 1932.3 samples/s | 30.2 steps/s
[Step=19400 Epoch=95.1] | Loss=0.01812 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.896 | L2-Norm(final)=9.077 | 4988.2 samples/s | 77.9 steps/s
[Step=19450 Epoch=95.4] | Loss=0.01738 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.901 | L2-Norm(final)=9.080 | 4903.2 samples/s | 76.6 steps/s
[Step=19500 Epoch=95.6] | Loss=0.01674 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.905 | L2-Norm(final)=9.083 | 5490.3 samples/s | 85.8 steps/s
[Step=19550 Epoch=95.9] | Loss=0.01620 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.909 | L2-Norm(final)=9.085 | 1989.8 samples/s | 31.1 steps/s
[Step=19600 Epoch=96.1] | Loss=0.01575 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.913 | L2-Norm(final)=9.088 | 4806.0 samples/s | 75.1 steps/s
[Step=19650 Epoch=96.4] | Loss=0.01528 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.916 | L2-Norm(final)=9.091 | 4972.0 samples/s | 77.7 steps/s
[Step=19700 Epoch=96.6] | Loss=0.01486 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.919 | L2-Norm(final)=9.094 | 5291.9 samples/s | 82.7 steps/s
[Step=19750 Epoch=96.9] | Loss=0.01448 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.921 | L2-Norm(final)=9.096 | 1799.6 samples/s | 28.1 steps/s
[Step=19800 Epoch=97.1] | Loss=0.01410 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.923 | L2-Norm(final)=9.099 | 4218.6 samples/s | 65.9 steps/s
[Step=19850 Epoch=97.3] | Loss=0.01371 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.925 | L2-Norm(final)=9.101 | 4213.7 samples/s | 65.8 steps/s
[Step=19900 Epoch=97.6] | Loss=0.01342 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.926 | L2-Norm(final)=9.104 | 4341.3 samples/s | 67.8 steps/s
[Step=19950 Epoch=97.8] | Loss=0.01308 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.927 | L2-Norm(final)=9.106 | 1974.5 samples/s | 30.9 steps/s
[Step=20000 Epoch=98.1] | Loss=0.01279 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.927 | L2-Norm(final)=9.108 | 4951.7 samples/s | 77.4 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step20000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=12001 Epoch=114.2] | Loss=0.00028 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.390 | L2-Norm(final)=6.763 | 3702.7 samples/s | 57.9 steps/s
[Step=12050 Epoch=114.6] | Loss=0.00580 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.484 | L2-Norm(final)=6.767 | 5113.8 samples/s | 79.9 steps/s
[Step=12100 Epoch=115.1] | Loss=0.00361 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.545 | L2-Norm(final)=6.782 | 7573.9 samples/s | 118.3 steps/s
[Step=12150 Epoch=115.6] | Loss=0.00259 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.570 | L2-Norm(final)=6.798 | 1860.9 samples/s | 29.1 steps/s
[Step=12200 Epoch=116.1] | Loss=0.00206 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.579 | L2-Norm(final)=6.813 | 6844.6 samples/s | 106.9 steps/s
[Step=12250 Epoch=116.5] | Loss=0.00170 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.581 | L2-Norm(final)=6.828 | 1903.1 samples/s | 29.7 steps/s
[Step=12300 Epoch=117.0] | Loss=0.00146 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.580 | L2-Norm(final)=6.841 | 6140.1 samples/s | 95.9 steps/s
[Step=12350 Epoch=117.5] | Loss=0.00128 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.575 | L2-Norm(final)=6.853 | 1973.9 samples/s | 30.8 steps/s
[Step=12400 Epoch=118.0] | Loss=0.00114 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.569 | L2-Norm(final)=6.865 | 5697.2 samples/s | 89.0 steps/s
[Step=12450 Epoch=118.4] | Loss=0.00104 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.562 | L2-Norm(final)=6.875 | 2027.2 samples/s | 31.7 steps/s
[Step=12500 Epoch=118.9] | Loss=0.00095 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.554 | L2-Norm(final)=6.885 | 5246.7 samples/s | 82.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=118.9] | Loss=0.00010 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.471 | L2-Norm(final)=6.984 | 4072.3 samples/s | 63.6 steps/s
[Step=12550 Epoch=119.4] | Loss=0.00011 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.458 | L2-Norm(final)=6.992 | 4145.8 samples/s | 64.8 steps/s
[Step=12600 Epoch=119.9] | Loss=0.00010 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.441 | L2-Norm(final)=6.998 | 6034.4 samples/s | 94.3 steps/s
[Step=12650 Epoch=120.3] | Loss=0.00008 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.422 | L2-Norm(final)=7.002 | 1784.9 samples/s | 27.9 steps/s
[Step=12700 Epoch=120.8] | Loss=0.00007 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=7.006 | 5870.8 samples/s | 91.7 steps/s
[Step=12750 Epoch=121.3] | Loss=0.00006 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.382 | L2-Norm(final)=7.009 | 1666.5 samples/s | 26.0 steps/s
[Step=12800 Epoch=121.8] | Loss=0.00005 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=7.012 | 4738.9 samples/s | 74.0 steps/s
[Step=12850 Epoch=122.2] | Loss=0.00005 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=7.014 | 1701.8 samples/s | 26.6 steps/s
[Step=12900 Epoch=122.7] | Loss=0.00004 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.319 | L2-Norm(final)=7.016 | 4461.4 samples/s | 69.7 steps/s
[Step=12950 Epoch=123.2] | Loss=0.00004 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.297 | L2-Norm(final)=7.018 | 1780.4 samples/s | 27.8 steps/s
[Step=13000 Epoch=123.7] | Loss=0.00004 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.276 | L2-Norm(final)=7.020 | 4854.2 samples/s | 75.8 steps/s
[Step=13050 Epoch=124.1] | Loss=0.00004 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.254 | L2-Norm(final)=7.022 | 1967.5 samples/s | 30.7 steps/s
[Step=13100 Epoch=124.6] | Loss=0.00003 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.233 | L2-Norm(final)=7.023 | 4715.0 samples/s | 73.7 steps/s
[Step=13150 Epoch=125.1] | Loss=0.00003 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.211 | L2-Norm(final)=7.025 | 1973.7 samples/s | 30.8 steps/s
[Step=13200 Epoch=125.6] | Loss=0.00003 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.189 | L2-Norm(final)=7.027 | 4844.0 samples/s | 75.7 steps/s
[Step=13250 Epoch=126.0] | Loss=0.00003 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.167 | L2-Norm(final)=7.028 | 2008.3 samples/s | 31.4 steps/s
[Step=13300 Epoch=126.5] | Loss=0.00003 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.146 | L2-Norm(final)=7.030 | 4696.0 samples/s | 73.4 steps/s
[Step=13350 Epoch=127.0] | Loss=0.00003 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.124 | L2-Norm(final)=7.031 | 2033.7 samples/s | 31.8 steps/s
[Step=13400 Epoch=127.5] | Loss=0.00003 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.102 | L2-Norm(final)=7.033 | 4411.3 samples/s | 68.9 steps/s
[Step=13450 Epoch=127.9] | Loss=0.00003 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.080 | L2-Norm(final)=7.034 | 6592.2 samples/s | 103.0 steps/s
[Step=13500 Epoch=128.4] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.057 | L2-Norm(final)=7.035 | 1790.6 samples/s | 28.0 steps/s
[Step=13550 Epoch=128.9] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.035 | L2-Norm(final)=7.037 | 5951.8 samples/s | 93.0 steps/s
[Step=13600 Epoch=129.4] | Loss=0.00002 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.013 | L2-Norm(final)=7.038 | 1813.8 samples/s | 28.3 steps/s
[Step=13650 Epoch=129.8] | Loss=0.00002 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.991 | L2-Norm(final)=7.039 | 5505.5 samples/s | 86.0 steps/s
[Step=13700 Epoch=130.3] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.968 | L2-Norm(final)=7.041 | 1836.2 samples/s | 28.7 steps/s
[Step=13750 Epoch=130.8] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.946 | L2-Norm(final)=7.042 | 4972.5 samples/s | 77.7 steps/s
[Step=13800 Epoch=131.3] | Loss=0.00002 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.924 | L2-Norm(final)=7.043 | 1836.1 samples/s | 28.7 steps/s
[Step=13850 Epoch=131.7] | Loss=0.00002 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=7.045 | 4669.6 samples/s | 73.0 steps/s
[Step=13900 Epoch=132.2] | Loss=0.00002 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.878 | L2-Norm(final)=7.046 | 1884.5 samples/s | 29.4 steps/s
[Step=13950 Epoch=132.7] | Loss=0.00002 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.856 | L2-Norm(final)=7.047 | 4685.5 samples/s | 73.2 steps/s
[Step=14000 Epoch=133.2] | Loss=0.00002 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.833 | L2-Norm(final)=7.049 | 1856.9 samples/s | 29.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step14000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=10001 Epoch=95.3] | Loss=0.01503 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.390 | L2-Norm(final)=6.536 | 3656.1 samples/s | 57.1 steps/s
[Step=10050 Epoch=95.8] | Loss=0.00805 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.568 | L2-Norm(final)=6.567 | 4409.8 samples/s | 68.9 steps/s
[Step=10100 Epoch=96.3] | Loss=0.00498 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.686 | L2-Norm(final)=6.614 | 6930.3 samples/s | 108.3 steps/s
[Step=10150 Epoch=96.7] | Loss=0.00353 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.744 | L2-Norm(final)=6.651 | 1714.0 samples/s | 26.8 steps/s
[Step=10200 Epoch=97.2] | Loss=0.00290 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.767 | L2-Norm(final)=6.680 | 6555.5 samples/s | 102.4 steps/s
[Step=10250 Epoch=97.7] | Loss=0.00242 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.780 | L2-Norm(final)=6.703 | 1782.0 samples/s | 27.8 steps/s
[Step=10300 Epoch=98.2] | Loss=0.00206 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.784 | L2-Norm(final)=6.725 | 5890.7 samples/s | 92.0 steps/s
[Step=10350 Epoch=98.6] | Loss=0.00180 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.781 | L2-Norm(final)=6.745 | 1808.2 samples/s | 28.3 steps/s
[Step=10400 Epoch=99.1] | Loss=0.00161 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.775 | L2-Norm(final)=6.763 | 5622.0 samples/s | 87.8 steps/s
[Step=10450 Epoch=99.6] | Loss=0.00145 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.766 | L2-Norm(final)=6.781 | 1825.7 samples/s | 28.5 steps/s
[Step=10500 Epoch=100.1] | Loss=0.00133 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.755 | L2-Norm(final)=6.797 | 5273.1 samples/s | 82.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=100.1] | Loss=0.00009 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.637 | L2-Norm(final)=6.958 | 3862.9 samples/s | 60.4 steps/s
[Step=10550 Epoch=100.6] | Loss=0.00013 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.612 | L2-Norm(final)=6.969 | 4133.4 samples/s | 64.6 steps/s
[Step=10600 Epoch=101.0] | Loss=0.00010 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.580 | L2-Norm(final)=6.977 | 6181.9 samples/s | 96.6 steps/s
[Step=10650 Epoch=101.5] | Loss=0.00008 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.546 | L2-Norm(final)=6.983 | 1665.8 samples/s | 26.0 steps/s
[Step=10700 Epoch=102.0] | Loss=0.00006 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.510 | L2-Norm(final)=6.987 | 5542.9 samples/s | 86.6 steps/s
[Step=10750 Epoch=102.5] | Loss=0.00005 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.474 | L2-Norm(final)=6.990 | 1712.7 samples/s | 26.8 steps/s
[Step=10800 Epoch=102.9] | Loss=0.00005 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.438 | L2-Norm(final)=6.993 | 5058.9 samples/s | 79.0 steps/s
[Step=10850 Epoch=103.4] | Loss=0.00004 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.401 | L2-Norm(final)=6.995 | 1771.0 samples/s | 27.7 steps/s
[Step=10900 Epoch=103.9] | Loss=0.00004 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.365 | L2-Norm(final)=6.998 | 5071.7 samples/s | 79.2 steps/s
[Step=10950 Epoch=104.4] | Loss=0.00003 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.329 | L2-Norm(final)=7.000 | 1780.2 samples/s | 27.8 steps/s
[Step=11000 Epoch=104.8] | Loss=0.00003 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.293 | L2-Norm(final)=7.002 | 4739.6 samples/s | 74.1 steps/s
[Step=11050 Epoch=105.3] | Loss=0.00003 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.257 | L2-Norm(final)=7.003 | 1811.0 samples/s | 28.3 steps/s
[Step=11100 Epoch=105.8] | Loss=0.00003 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.222 | L2-Norm(final)=7.005 | 4460.6 samples/s | 69.7 steps/s
[Step=11150 Epoch=106.3] | Loss=0.00003 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.186 | L2-Norm(final)=7.007 | 1860.3 samples/s | 29.1 steps/s
[Step=11200 Epoch=106.7] | Loss=0.00003 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.151 | L2-Norm(final)=7.009 | 4435.9 samples/s | 69.3 steps/s
[Step=11250 Epoch=107.2] | Loss=0.00002 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.116 | L2-Norm(final)=7.010 | 1906.1 samples/s | 29.8 steps/s
[Step=11300 Epoch=107.7] | Loss=0.00002 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.081 | L2-Norm(final)=7.012 | 4470.1 samples/s | 69.8 steps/s
[Step=11350 Epoch=108.2] | Loss=0.00002 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.046 | L2-Norm(final)=7.013 | 1865.5 samples/s | 29.1 steps/s
[Step=11400 Epoch=108.7] | Loss=0.00002 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.012 | L2-Norm(final)=7.015 | 4386.4 samples/s | 68.5 steps/s
[Step=11450 Epoch=109.1] | Loss=0.00002 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.977 | L2-Norm(final)=7.016 | 1891.8 samples/s | 29.6 steps/s
[Step=11500 Epoch=109.6] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.943 | L2-Norm(final)=7.018 | 4277.7 samples/s | 66.8 steps/s
[Step=11550 Epoch=110.1] | Loss=0.00002 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.909 | L2-Norm(final)=7.019 | 6451.5 samples/s | 100.8 steps/s
[Step=11600 Epoch=110.6] | Loss=0.00002 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.875 | L2-Norm(final)=7.021 | 1637.9 samples/s | 25.6 steps/s
[Step=11650 Epoch=111.0] | Loss=0.00002 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.841 | L2-Norm(final)=7.022 | 5983.9 samples/s | 93.5 steps/s
[Step=11700 Epoch=111.5] | Loss=0.00002 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.807 | L2-Norm(final)=7.024 | 1709.2 samples/s | 26.7 steps/s
[Step=11750 Epoch=112.0] | Loss=0.00002 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=7.025 | 5642.4 samples/s | 88.2 steps/s
[Step=11800 Epoch=112.5] | Loss=0.00002 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.740 | L2-Norm(final)=7.027 | 1748.5 samples/s | 27.3 steps/s
[Step=11850 Epoch=112.9] | Loss=0.00002 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.706 | L2-Norm(final)=7.028 | 5232.6 samples/s | 81.8 steps/s
[Step=11900 Epoch=113.4] | Loss=0.00002 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=7.030 | 1784.2 samples/s | 27.9 steps/s
[Step=11950 Epoch=113.9] | Loss=0.00002 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.640 | L2-Norm(final)=7.031 | 4933.2 samples/s | 77.1 steps/s
[Step=12000 Epoch=114.4] | Loss=0.00002 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.606 | L2-Norm(final)=7.033 | 1788.2 samples/s | 27.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10251 | acc=0.9546 | tpr=0.9673 | fpr=0.0728 | 4121.5 samples/s | 16.1 steps/s
Avg test loss: 0.10786, Avg test acc: 0.95272, Avg tpr: 0.96602, Avg fpr: 0.07653, total FA: 597

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10064 | acc=0.9508 | tpr=0.9637 | fpr=0.0773 | 4203.1 samples/s | 16.4 steps/s
Avg test loss: 0.10345, Avg test acc: 0.95136, Avg tpr: 0.96380, Avg fpr: 0.07602, total FA: 593

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.12421 | acc=0.9524 | tpr=0.9744 | fpr=0.0954 | 4023.9 samples/s | 15.7 steps/s
Avg test loss: 0.12624, Avg test acc: 0.95056, Avg tpr: 0.97284, Avg fpr: 0.09845, total FA: 768

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.10848 | acc=0.9538 | tpr=0.9741 | fpr=0.0902 | 4118.2 samples/s | 16.1 steps/s
Avg test loss: 0.11150, Avg test acc: 0.95196, Avg tpr: 0.97278, Avg fpr: 0.09383, total FA: 732

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.11550 | acc=0.9513 | tpr=0.9557 | fpr=0.0582 | 4060.5 samples/s | 15.9 steps/s
Avg test loss: 0.12163, Avg test acc: 0.94964, Avg tpr: 0.95360, Avg fpr: 0.05909, total FA: 461

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.14314 | acc=0.3084 | tpr=0.0027 | fpr=0.0278 | 4077.4 samples/s | 15.9 steps/s
Avg test loss: 4.16161, Avg test acc: 0.30523, Avg tpr: 0.00321, Avg fpr: 0.03051, total FA: 238

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.07915 | acc=0.3102 | tpr=0.0074 | fpr=0.0325 | 3986.0 samples/s | 15.6 steps/s
Avg test loss: 4.08340, Avg test acc: 0.30872, Avg tpr: 0.00863, Avg fpr: 0.03128, total FA: 244

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.55531 | acc=0.2905 | tpr=0.0072 | fpr=0.0942 | 4190.5 samples/s | 16.4 steps/s
Avg test loss: 4.55816, Avg test acc: 0.28981, Avg tpr: 0.00886, Avg fpr: 0.09230, total FA: 720

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.14320 | acc=0.3026 | tpr=0.0026 | fpr=0.0461 | 4156.0 samples/s | 16.2 steps/s
Avg test loss: 4.14816, Avg test acc: 0.30143, Avg tpr: 0.00373, Avg fpr: 0.04384, total FA: 342

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.21935 | acc=0.3079 | tpr=0.0033 | fpr=0.0307 | 4122.2 samples/s | 16.1 steps/s
Avg test loss: 4.22880, Avg test acc: 0.30599, Avg tpr: 0.00420, Avg fpr: 0.03025, total FA: 236

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.07291 | acc=0.1197 | tpr=0.7699 | fpr=0.8920 | 4095.0 samples/s | 16.0 steps/s
[Step= 100] | Loss=5.04212 | acc=0.1214 | tpr=0.7441 | fpr=0.8903 | 7777.9 samples/s | 30.4 steps/s
[Step= 150] | Loss=5.05036 | acc=0.1209 | tpr=0.7406 | fpr=0.8905 | 7996.4 samples/s | 31.2 steps/s
[Step= 200] | Loss=5.04955 | acc=0.1202 | tpr=0.7454 | fpr=0.8911 | 7781.9 samples/s | 30.4 steps/s
[Step= 250] | Loss=5.04877 | acc=0.1207 | tpr=0.7485 | fpr=0.8907 | 7683.1 samples/s | 30.0 steps/s
[Step= 300] | Loss=5.04514 | acc=0.1208 | tpr=0.7469 | fpr=0.8906 | 8377.0 samples/s | 32.7 steps/s
[Step= 350] | Loss=5.04174 | acc=0.1209 | tpr=0.7401 | fpr=0.8904 | 7977.7 samples/s | 31.2 steps/s
[Step= 400] | Loss=5.04119 | acc=0.1214 | tpr=0.7380 | fpr=0.8898 | 7873.8 samples/s | 30.8 steps/s
[Step= 450] | Loss=5.04313 | acc=0.1213 | tpr=0.7313 | fpr=0.8898 | 8177.0 samples/s | 31.9 steps/s
[Step= 500] | Loss=5.04342 | acc=0.1210 | tpr=0.7269 | fpr=0.8899 | 7897.6 samples/s | 30.8 steps/s
[Step= 550] | Loss=5.04488 | acc=0.1210 | tpr=0.7298 | fpr=0.8901 | 14719.8 samples/s | 57.5 steps/s
Avg test loss: 5.04608, Avg test acc: 0.12087, Avg tpr: 0.73019, Avg fpr: 0.89021, total FA: 123604

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.65537 | acc=0.1213 | tpr=0.7345 | fpr=0.8897 | 4075.2 samples/s | 15.9 steps/s
[Step= 100] | Loss=4.60726 | acc=0.1233 | tpr=0.7015 | fpr=0.8875 | 8134.3 samples/s | 31.8 steps/s
[Step= 150] | Loss=4.61689 | acc=0.1203 | tpr=0.6916 | fpr=0.8902 | 8254.9 samples/s | 32.2 steps/s
[Step= 200] | Loss=4.62002 | acc=0.1201 | tpr=0.6809 | fpr=0.8901 | 7928.0 samples/s | 31.0 steps/s
[Step= 250] | Loss=4.61841 | acc=0.1213 | tpr=0.6769 | fpr=0.8888 | 8041.8 samples/s | 31.4 steps/s
[Step= 300] | Loss=4.61994 | acc=0.1213 | tpr=0.6793 | fpr=0.8889 | 8096.0 samples/s | 31.6 steps/s
[Step= 350] | Loss=4.61340 | acc=0.1213 | tpr=0.6738 | fpr=0.8887 | 8035.6 samples/s | 31.4 steps/s
[Step= 400] | Loss=4.61296 | acc=0.1217 | tpr=0.6718 | fpr=0.8883 | 8087.7 samples/s | 31.6 steps/s
[Step= 450] | Loss=4.61442 | acc=0.1215 | tpr=0.6665 | fpr=0.8884 | 8008.4 samples/s | 31.3 steps/s
[Step= 500] | Loss=4.61579 | acc=0.1214 | tpr=0.6648 | fpr=0.8885 | 7788.4 samples/s | 30.4 steps/s
[Step= 550] | Loss=4.61847 | acc=0.1211 | tpr=0.6626 | fpr=0.8887 | 14924.9 samples/s | 58.3 steps/s
Avg test loss: 4.61958, Avg test acc: 0.12103, Avg tpr: 0.66244, Avg fpr: 0.88881, total FA: 123410

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.58497 | acc=0.1023 | tpr=0.7699 | fpr=0.9097 | 4183.9 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.53744 | acc=0.1027 | tpr=0.7441 | fpr=0.9093 | 7898.4 samples/s | 30.9 steps/s
[Step= 150] | Loss=6.54636 | acc=0.1014 | tpr=0.7464 | fpr=0.9104 | 7759.8 samples/s | 30.3 steps/s
[Step= 200] | Loss=6.54294 | acc=0.1007 | tpr=0.7464 | fpr=0.9110 | 7783.7 samples/s | 30.4 steps/s
[Step= 250] | Loss=6.54231 | acc=0.1005 | tpr=0.7450 | fpr=0.9112 | 8082.6 samples/s | 31.6 steps/s
[Step= 300] | Loss=6.53956 | acc=0.1005 | tpr=0.7520 | fpr=0.9114 | 7398.4 samples/s | 28.9 steps/s
[Step= 350] | Loss=6.53982 | acc=0.0996 | tpr=0.7401 | fpr=0.9120 | 8051.6 samples/s | 31.5 steps/s
[Step= 400] | Loss=6.54442 | acc=0.1001 | tpr=0.7363 | fpr=0.9115 | 8441.8 samples/s | 33.0 steps/s
[Step= 450] | Loss=6.54773 | acc=0.1000 | tpr=0.7337 | fpr=0.9115 | 7395.9 samples/s | 28.9 steps/s
[Step= 500] | Loss=6.54885 | acc=0.0999 | tpr=0.7291 | fpr=0.9115 | 7803.1 samples/s | 30.5 steps/s
[Step= 550] | Loss=6.55137 | acc=0.0997 | tpr=0.7326 | fpr=0.9118 | 14027.7 samples/s | 54.8 steps/s
Avg test loss: 6.55367, Avg test acc: 0.09966, Avg tpr: 0.73217, Avg fpr: 0.91184, total FA: 126607

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.18652 | acc=0.1279 | tpr=0.8186 | fpr=0.8845 | 3969.1 samples/s | 15.5 steps/s
[Step= 100] | Loss=5.15305 | acc=0.1290 | tpr=0.7569 | fpr=0.8827 | 8299.1 samples/s | 32.4 steps/s
[Step= 150] | Loss=5.15380 | acc=0.1273 | tpr=0.7651 | fpr=0.8845 | 8012.6 samples/s | 31.3 steps/s
[Step= 200] | Loss=5.15039 | acc=0.1269 | tpr=0.7661 | fpr=0.8847 | 7874.1 samples/s | 30.8 steps/s
[Step= 250] | Loss=5.15411 | acc=0.1271 | tpr=0.7616 | fpr=0.8845 | 8125.4 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.15294 | acc=0.1266 | tpr=0.7615 | fpr=0.8850 | 7833.4 samples/s | 30.6 steps/s
[Step= 350] | Loss=5.15011 | acc=0.1271 | tpr=0.7621 | fpr=0.8845 | 8483.2 samples/s | 33.1 steps/s
[Step= 400] | Loss=5.15351 | acc=0.1268 | tpr=0.7593 | fpr=0.8847 | 8400.4 samples/s | 32.8 steps/s
[Step= 450] | Loss=5.15579 | acc=0.1271 | tpr=0.7517 | fpr=0.8843 | 7639.8 samples/s | 29.8 steps/s
[Step= 500] | Loss=5.15669 | acc=0.1270 | tpr=0.7511 | fpr=0.8843 | 8166.7 samples/s | 31.9 steps/s
[Step= 550] | Loss=5.15561 | acc=0.1266 | tpr=0.7533 | fpr=0.8848 | 13298.1 samples/s | 51.9 steps/s
Avg test loss: 5.15685, Avg test acc: 0.12650, Avg tpr: 0.75317, Avg fpr: 0.88490, total FA: 122866

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.27178 | acc=0.1366 | tpr=0.6416 | fpr=0.8725 | 4081.7 samples/s | 15.9 steps/s
[Step= 100] | Loss=5.25333 | acc=0.1410 | tpr=0.6013 | fpr=0.8676 | 8072.6 samples/s | 31.5 steps/s
[Step= 150] | Loss=5.25413 | acc=0.1412 | tpr=0.6081 | fpr=0.8673 | 8047.9 samples/s | 31.4 steps/s
[Step= 200] | Loss=5.25316 | acc=0.1404 | tpr=0.6022 | fpr=0.8680 | 7763.9 samples/s | 30.3 steps/s
[Step= 250] | Loss=5.25718 | acc=0.1398 | tpr=0.5983 | fpr=0.8686 | 8400.2 samples/s | 32.8 steps/s
[Step= 300] | Loss=5.25392 | acc=0.1400 | tpr=0.6036 | fpr=0.8685 | 7967.2 samples/s | 31.1 steps/s
[Step= 350] | Loss=5.24872 | acc=0.1399 | tpr=0.6024 | fpr=0.8685 | 8630.1 samples/s | 33.7 steps/s
[Step= 400] | Loss=5.24673 | acc=0.1400 | tpr=0.5919 | fpr=0.8682 | 7796.5 samples/s | 30.5 steps/s
[Step= 450] | Loss=5.25084 | acc=0.1396 | tpr=0.5818 | fpr=0.8684 | 8050.7 samples/s | 31.4 steps/s
[Step= 500] | Loss=5.25193 | acc=0.1396 | tpr=0.5789 | fpr=0.8683 | 8111.9 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.25237 | acc=0.1393 | tpr=0.5770 | fpr=0.8686 | 14738.2 samples/s | 57.6 steps/s
Avg test loss: 5.25419, Avg test acc: 0.13921, Avg tpr: 0.57726, Avg fpr: 0.86876, total FA: 120625

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09306 | acc=0.9815 | tpr=0.8982 | fpr=0.0170 | 4089.1 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.09512 | acc=0.9811 | tpr=0.9211 | fpr=0.0178 | 7777.0 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.09822 | acc=0.9803 | tpr=0.9222 | fpr=0.0186 | 7557.9 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.10022 | acc=0.9801 | tpr=0.9180 | fpr=0.0188 | 8066.9 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.09931 | acc=0.9802 | tpr=0.9188 | fpr=0.0187 | 8251.8 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.10048 | acc=0.9800 | tpr=0.9200 | fpr=0.0189 | 7882.4 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.10120 | acc=0.9797 | tpr=0.9186 | fpr=0.0192 | 8082.1 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.10190 | acc=0.9796 | tpr=0.9141 | fpr=0.0193 | 7895.0 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.10450 | acc=0.9792 | tpr=0.9133 | fpr=0.0196 | 7858.5 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.10387 | acc=0.9793 | tpr=0.9145 | fpr=0.0195 | 7915.1 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.10309 | acc=0.9794 | tpr=0.9152 | fpr=0.0194 | 14435.8 samples/s | 56.4 steps/s
Avg test loss: 0.10301, Avg test acc: 0.97943, Avg tpr: 0.91521, Avg fpr: 0.01940, total FA: 2694

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10318 | acc=0.9814 | tpr=0.8938 | fpr=0.0170 | 4138.2 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.10654 | acc=0.9809 | tpr=0.9104 | fpr=0.0177 | 8108.4 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.11019 | acc=0.9804 | tpr=0.9121 | fpr=0.0184 | 7890.6 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.11238 | acc=0.9803 | tpr=0.9126 | fpr=0.0185 | 8028.9 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.11131 | acc=0.9803 | tpr=0.9144 | fpr=0.0185 | 7987.0 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.11290 | acc=0.9801 | tpr=0.9164 | fpr=0.0187 | 8171.0 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.11241 | acc=0.9801 | tpr=0.9198 | fpr=0.0188 | 7806.8 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.11397 | acc=0.9799 | tpr=0.9158 | fpr=0.0190 | 7733.8 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.11672 | acc=0.9796 | tpr=0.9143 | fpr=0.0192 | 7831.8 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.11620 | acc=0.9796 | tpr=0.9163 | fpr=0.0192 | 7866.2 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.11533 | acc=0.9797 | tpr=0.9140 | fpr=0.0191 | 14521.8 samples/s | 56.7 steps/s
Avg test loss: 0.11514, Avg test acc: 0.97974, Avg tpr: 0.91323, Avg fpr: 0.01905, total FA: 2645

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10934 | acc=0.9803 | tpr=0.9425 | fpr=0.0190 | 4132.3 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.11284 | acc=0.9798 | tpr=0.9574 | fpr=0.0197 | 7670.2 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.11704 | acc=0.9788 | tpr=0.9539 | fpr=0.0208 | 7950.6 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.11987 | acc=0.9785 | tpr=0.9541 | fpr=0.0211 | 7759.4 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.11888 | acc=0.9785 | tpr=0.9520 | fpr=0.0211 | 7787.6 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.12068 | acc=0.9781 | tpr=0.9498 | fpr=0.0214 | 7963.3 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.12051 | acc=0.9780 | tpr=0.9493 | fpr=0.0215 | 7903.5 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.12204 | acc=0.9777 | tpr=0.9437 | fpr=0.0216 | 7991.1 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.12481 | acc=0.9774 | tpr=0.9426 | fpr=0.0219 | 8214.9 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.12429 | acc=0.9774 | tpr=0.9441 | fpr=0.0220 | 7814.8 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.12307 | acc=0.9777 | tpr=0.9439 | fpr=0.0217 | 14728.0 samples/s | 57.5 steps/s
Avg test loss: 0.12291, Avg test acc: 0.97773, Avg tpr: 0.94374, Avg fpr: 0.02165, total FA: 3006

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10929 | acc=0.9807 | tpr=0.8982 | fpr=0.0178 | 4047.9 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.11420 | acc=0.9802 | tpr=0.9211 | fpr=0.0187 | 8217.5 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.11818 | acc=0.9794 | tpr=0.9236 | fpr=0.0196 | 8215.4 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.12178 | acc=0.9792 | tpr=0.9301 | fpr=0.0199 | 7945.9 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.12031 | acc=0.9792 | tpr=0.9275 | fpr=0.0198 | 8129.8 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.12205 | acc=0.9790 | tpr=0.9302 | fpr=0.0201 | 8092.5 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.12190 | acc=0.9789 | tpr=0.9311 | fpr=0.0202 | 7770.1 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.12317 | acc=0.9787 | tpr=0.9256 | fpr=0.0203 | 8219.5 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.12612 | acc=0.9783 | tpr=0.9241 | fpr=0.0207 | 8319.3 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.12538 | acc=0.9783 | tpr=0.9256 | fpr=0.0207 | 7413.8 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.12440 | acc=0.9785 | tpr=0.9264 | fpr=0.0206 | 14691.8 samples/s | 57.4 steps/s
Avg test loss: 0.12418, Avg test acc: 0.97848, Avg tpr: 0.92552, Avg fpr: 0.02055, total FA: 2854

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.11619 | acc=0.9800 | tpr=0.9159 | fpr=0.0188 | 4258.1 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.11940 | acc=0.9800 | tpr=0.9382 | fpr=0.0192 | 7837.0 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.12414 | acc=0.9790 | tpr=0.9395 | fpr=0.0203 | 7993.0 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.12741 | acc=0.9786 | tpr=0.9421 | fpr=0.0208 | 8115.2 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.12643 | acc=0.9787 | tpr=0.9406 | fpr=0.0206 | 8138.8 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.12840 | acc=0.9784 | tpr=0.9404 | fpr=0.0209 | 8324.5 samples/s | 32.5 steps/s
[Step= 350] | Loss=0.12801 | acc=0.9782 | tpr=0.9405 | fpr=0.0211 | 7616.5 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.12946 | acc=0.9781 | tpr=0.9354 | fpr=0.0212 | 8232.7 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.13224 | acc=0.9777 | tpr=0.9352 | fpr=0.0215 | 8249.5 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.13170 | acc=0.9778 | tpr=0.9361 | fpr=0.0215 | 7827.9 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.13069 | acc=0.9779 | tpr=0.9347 | fpr=0.0213 | 14530.0 samples/s | 56.8 steps/s
Avg test loss: 0.13048, Avg test acc: 0.97787, Avg tpr: 0.93463, Avg fpr: 0.02134, total FA: 2963

server round 15/50

clients selected: [3 4 5 7 9]

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.02636 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.116 | L2-Norm(final)=6.277 | 3554.9 samples/s | 55.5 steps/s
[Step=8050 Epoch=39.3] | Loss=0.04072 | Reg=0.00173 | acc=0.9531 | L2-Norm=13.172 | L2-Norm(final)=6.284 | 5154.0 samples/s | 80.5 steps/s
[Step=8100 Epoch=39.5] | Loss=0.03932 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.247 | L2-Norm(final)=6.306 | 4985.6 samples/s | 77.9 steps/s
[Step=8150 Epoch=39.7] | Loss=0.03936 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.319 | L2-Norm(final)=6.319 | 5080.3 samples/s | 79.4 steps/s
[Step=8200 Epoch=40.0] | Loss=0.03833 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.390 | L2-Norm(final)=6.340 | 7230.8 samples/s | 113.0 steps/s
[Step=8250 Epoch=40.2] | Loss=0.03690 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.458 | L2-Norm(final)=6.362 | 1765.6 samples/s | 27.6 steps/s
[Step=8300 Epoch=40.5] | Loss=0.03558 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.523 | L2-Norm(final)=6.386 | 5127.5 samples/s | 80.1 steps/s
[Step=8350 Epoch=40.7] | Loss=0.03421 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.587 | L2-Norm(final)=6.413 | 5147.9 samples/s | 80.4 steps/s
[Step=8400 Epoch=41.0] | Loss=0.03352 | Reg=0.00186 | acc=0.9375 | L2-Norm=13.647 | L2-Norm(final)=6.440 | 6639.9 samples/s | 103.7 steps/s
[Step=8450 Epoch=41.2] | Loss=0.03284 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.707 | L2-Norm(final)=6.468 | 1822.3 samples/s | 28.5 steps/s
[Step=8500 Epoch=41.5] | Loss=0.03190 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.766 | L2-Norm(final)=6.498 | 5206.6 samples/s | 81.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=8501 Epoch=41.5] | Loss=0.04436 | Reg=0.00206 | acc=0.9531 | L2-Norm=14.358 | L2-Norm(final)=6.802 | 3774.9 samples/s | 59.0 steps/s
[Step=8550 Epoch=41.7] | Loss=0.03243 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.411 | L2-Norm(final)=6.821 | 4365.0 samples/s | 68.2 steps/s
[Step=8600 Epoch=41.9] | Loss=0.03838 | Reg=0.00209 | acc=0.9375 | L2-Norm=14.465 | L2-Norm(final)=6.826 | 4561.2 samples/s | 71.3 steps/s
[Step=8650 Epoch=42.2] | Loss=0.03979 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.518 | L2-Norm(final)=6.818 | 4532.5 samples/s | 70.8 steps/s
[Step=8700 Epoch=42.4] | Loss=0.03897 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.561 | L2-Norm(final)=6.816 | 6159.6 samples/s | 96.2 steps/s
[Step=8750 Epoch=42.7] | Loss=0.03458 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.599 | L2-Norm(final)=6.817 | 1777.8 samples/s | 27.8 steps/s
[Step=8800 Epoch=42.9] | Loss=0.03142 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.631 | L2-Norm(final)=6.823 | 4658.7 samples/s | 72.8 steps/s
[Step=8850 Epoch=43.2] | Loss=0.02981 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.659 | L2-Norm(final)=6.828 | 4555.1 samples/s | 71.2 steps/s
[Step=8900 Epoch=43.4] | Loss=0.02801 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.684 | L2-Norm(final)=6.832 | 5734.7 samples/s | 89.6 steps/s
[Step=8950 Epoch=43.6] | Loss=0.02604 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.705 | L2-Norm(final)=6.837 | 1772.3 samples/s | 27.7 steps/s
[Step=9000 Epoch=43.9] | Loss=0.02467 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.724 | L2-Norm(final)=6.842 | 4397.6 samples/s | 68.7 steps/s
[Step=9050 Epoch=44.1] | Loss=0.02335 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.740 | L2-Norm(final)=6.847 | 4510.9 samples/s | 70.5 steps/s
[Step=9100 Epoch=44.4] | Loss=0.02220 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.754 | L2-Norm(final)=6.852 | 5338.2 samples/s | 83.4 steps/s
[Step=9150 Epoch=44.6] | Loss=0.02097 | Reg=0.00218 | acc=0.9688 | L2-Norm=14.767 | L2-Norm(final)=6.858 | 1814.9 samples/s | 28.4 steps/s
[Step=9200 Epoch=44.9] | Loss=0.02012 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.779 | L2-Norm(final)=6.864 | 4527.4 samples/s | 70.7 steps/s
[Step=9250 Epoch=45.1] | Loss=0.01956 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.790 | L2-Norm(final)=6.869 | 4590.2 samples/s | 71.7 steps/s
[Step=9300 Epoch=45.4] | Loss=0.01900 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.801 | L2-Norm(final)=6.873 | 5093.9 samples/s | 79.6 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01837 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.811 | L2-Norm(final)=6.878 | 1863.9 samples/s | 29.1 steps/s
[Step=9400 Epoch=45.8] | Loss=0.01822 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.822 | L2-Norm(final)=6.882 | 4686.4 samples/s | 73.2 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01783 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.831 | L2-Norm(final)=6.885 | 4727.2 samples/s | 73.9 steps/s
[Step=9500 Epoch=46.3] | Loss=0.01735 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.841 | L2-Norm(final)=6.888 | 4660.0 samples/s | 72.8 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01685 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.850 | L2-Norm(final)=6.892 | 1896.0 samples/s | 29.6 steps/s
[Step=9600 Epoch=46.8] | Loss=0.01629 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.859 | L2-Norm(final)=6.897 | 4492.5 samples/s | 70.2 steps/s
[Step=9650 Epoch=47.1] | Loss=0.01604 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.867 | L2-Norm(final)=6.901 | 4484.5 samples/s | 70.1 steps/s
[Step=9700 Epoch=47.3] | Loss=0.01570 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.874 | L2-Norm(final)=6.904 | 4539.4 samples/s | 70.9 steps/s
[Step=9750 Epoch=47.5] | Loss=0.01534 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.882 | L2-Norm(final)=6.907 | 1928.1 samples/s | 30.1 steps/s
[Step=9800 Epoch=47.8] | Loss=0.01491 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.889 | L2-Norm(final)=6.911 | 4572.2 samples/s | 71.4 steps/s
[Step=9850 Epoch=48.0] | Loss=0.01462 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.895 | L2-Norm(final)=6.914 | 4613.3 samples/s | 72.1 steps/s
[Step=9900 Epoch=48.3] | Loss=0.01431 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.900 | L2-Norm(final)=6.917 | 4594.3 samples/s | 71.8 steps/s
[Step=9950 Epoch=48.5] | Loss=0.01390 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.905 | L2-Norm(final)=6.921 | 1908.3 samples/s | 29.8 steps/s
[Step=10000 Epoch=48.8] | Loss=0.01350 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.910 | L2-Norm(final)=6.924 | 4663.3 samples/s | 72.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step10000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=20001 Epoch=98.1] | Loss=0.02367 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.116 | L2-Norm(final)=9.178 | 3711.2 samples/s | 58.0 steps/s
[Step=20050 Epoch=98.3] | Loss=0.03025 | Reg=0.00173 | acc=0.9688 | L2-Norm=13.168 | L2-Norm(final)=9.160 | 5005.7 samples/s | 78.2 steps/s
[Step=20100 Epoch=98.6] | Loss=0.03099 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.227 | L2-Norm(final)=9.155 | 5218.1 samples/s | 81.5 steps/s
[Step=20150 Epoch=98.8] | Loss=0.02990 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.288 | L2-Norm(final)=9.163 | 5216.2 samples/s | 81.5 steps/s
[Step=20200 Epoch=99.1] | Loss=0.02845 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.345 | L2-Norm(final)=9.172 | 7694.9 samples/s | 120.2 steps/s
[Step=20250 Epoch=99.3] | Loss=0.02665 | Reg=0.00180 | acc=0.9531 | L2-Norm=13.398 | L2-Norm(final)=9.185 | 1781.0 samples/s | 27.8 steps/s
[Step=20300 Epoch=99.5] | Loss=0.02564 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.451 | L2-Norm(final)=9.203 | 5110.8 samples/s | 79.9 steps/s
[Step=20350 Epoch=99.8] | Loss=0.02466 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.503 | L2-Norm(final)=9.222 | 5093.8 samples/s | 79.6 steps/s
[Step=20400 Epoch=100.0] | Loss=0.02407 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.555 | L2-Norm(final)=9.243 | 6978.0 samples/s | 109.0 steps/s
[Step=20450 Epoch=100.3] | Loss=0.02303 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.604 | L2-Norm(final)=9.266 | 1802.1 samples/s | 28.2 steps/s
[Step=20500 Epoch=100.5] | Loss=0.02217 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.653 | L2-Norm(final)=9.290 | 5068.9 samples/s | 79.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=100.5] | Loss=0.01723 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.137 | L2-Norm(final)=9.537 | 3583.8 samples/s | 56.0 steps/s
[Step=20550 Epoch=100.8] | Loss=0.03502 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.201 | L2-Norm(final)=9.548 | 4502.5 samples/s | 70.4 steps/s
[Step=20600 Epoch=101.0] | Loss=0.03788 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.265 | L2-Norm(final)=9.532 | 4588.0 samples/s | 71.7 steps/s
[Step=20650 Epoch=101.3] | Loss=0.03967 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.315 | L2-Norm(final)=9.516 | 4641.2 samples/s | 72.5 steps/s
[Step=20700 Epoch=101.5] | Loss=0.03928 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.360 | L2-Norm(final)=9.506 | 6102.5 samples/s | 95.4 steps/s
[Step=20750 Epoch=101.8] | Loss=0.03530 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.399 | L2-Norm(final)=9.499 | 1762.8 samples/s | 27.5 steps/s
[Step=20800 Epoch=102.0] | Loss=0.03169 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.429 | L2-Norm(final)=9.497 | 4587.9 samples/s | 71.7 steps/s
[Step=20850 Epoch=102.2] | Loss=0.02964 | Reg=0.00209 | acc=0.9531 | L2-Norm=14.455 | L2-Norm(final)=9.498 | 4614.9 samples/s | 72.1 steps/s
[Step=20900 Epoch=102.5] | Loss=0.02795 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.478 | L2-Norm(final)=9.500 | 5921.8 samples/s | 92.5 steps/s
[Step=20950 Epoch=102.7] | Loss=0.02581 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.500 | L2-Norm(final)=9.504 | 1810.3 samples/s | 28.3 steps/s
[Step=21000 Epoch=103.0] | Loss=0.02421 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.518 | L2-Norm(final)=9.507 | 4616.7 samples/s | 72.1 steps/s
[Step=21050 Epoch=103.2] | Loss=0.02289 | Reg=0.00211 | acc=0.9688 | L2-Norm=14.534 | L2-Norm(final)=9.510 | 4670.5 samples/s | 73.0 steps/s
[Step=21100 Epoch=103.5] | Loss=0.02212 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.548 | L2-Norm(final)=9.513 | 5575.8 samples/s | 87.1 steps/s
[Step=21150 Epoch=103.7] | Loss=0.02109 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.561 | L2-Norm(final)=9.516 | 1763.2 samples/s | 27.5 steps/s
[Step=21200 Epoch=104.0] | Loss=0.02004 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.572 | L2-Norm(final)=9.518 | 4618.9 samples/s | 72.2 steps/s
[Step=21250 Epoch=104.2] | Loss=0.01906 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.582 | L2-Norm(final)=9.521 | 4528.4 samples/s | 70.8 steps/s
[Step=21300 Epoch=104.5] | Loss=0.01835 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.591 | L2-Norm(final)=9.523 | 5464.4 samples/s | 85.4 steps/s
[Step=21350 Epoch=104.7] | Loss=0.01757 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.599 | L2-Norm(final)=9.525 | 1863.1 samples/s | 29.1 steps/s
[Step=21400 Epoch=104.9] | Loss=0.01690 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.606 | L2-Norm(final)=9.528 | 4668.9 samples/s | 73.0 steps/s
[Step=21450 Epoch=105.2] | Loss=0.01658 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.612 | L2-Norm(final)=9.530 | 4669.7 samples/s | 73.0 steps/s
[Step=21500 Epoch=105.4] | Loss=0.01602 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.616 | L2-Norm(final)=9.531 | 5236.4 samples/s | 81.8 steps/s
[Step=21550 Epoch=105.7] | Loss=0.01547 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.621 | L2-Norm(final)=9.533 | 1837.4 samples/s | 28.7 steps/s
[Step=21600 Epoch=105.9] | Loss=0.01511 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.625 | L2-Norm(final)=9.535 | 4614.7 samples/s | 72.1 steps/s
[Step=21650 Epoch=106.2] | Loss=0.01462 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.628 | L2-Norm(final)=9.537 | 4587.6 samples/s | 71.7 steps/s
[Step=21700 Epoch=106.4] | Loss=0.01420 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.631 | L2-Norm(final)=9.538 | 4851.8 samples/s | 75.8 steps/s
[Step=21750 Epoch=106.7] | Loss=0.01388 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.633 | L2-Norm(final)=9.540 | 1843.4 samples/s | 28.8 steps/s
[Step=21800 Epoch=106.9] | Loss=0.01349 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.635 | L2-Norm(final)=9.541 | 4621.5 samples/s | 72.2 steps/s
[Step=21850 Epoch=107.1] | Loss=0.01310 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.637 | L2-Norm(final)=9.543 | 4592.0 samples/s | 71.8 steps/s
[Step=21900 Epoch=107.4] | Loss=0.01284 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.638 | L2-Norm(final)=9.545 | 4758.7 samples/s | 74.4 steps/s
[Step=21950 Epoch=107.6] | Loss=0.01254 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.640 | L2-Norm(final)=9.547 | 1877.1 samples/s | 29.3 steps/s
[Step=22000 Epoch=107.9] | Loss=0.01226 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.640 | L2-Norm(final)=9.549 | 4638.2 samples/s | 72.5 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step22000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=8001 Epoch=75.8] | Loss=0.01703 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.116 | L2-Norm(final)=5.166 | 3709.6 samples/s | 58.0 steps/s
[Step=8050 Epoch=76.3] | Loss=0.00369 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.205 | L2-Norm(final)=5.190 | 4336.4 samples/s | 67.8 steps/s
[Step=8100 Epoch=76.8] | Loss=0.00269 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.251 | L2-Norm(final)=5.222 | 7246.0 samples/s | 113.2 steps/s
[Step=8150 Epoch=77.2] | Loss=0.00204 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.280 | L2-Norm(final)=5.248 | 1732.7 samples/s | 27.1 steps/s
[Step=8200 Epoch=77.7] | Loss=0.00163 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.295 | L2-Norm(final)=5.270 | 6364.5 samples/s | 99.4 steps/s
[Step=8250 Epoch=78.2] | Loss=0.00138 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.301 | L2-Norm(final)=5.289 | 1789.9 samples/s | 28.0 steps/s
[Step=8300 Epoch=78.6] | Loss=0.00119 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.303 | L2-Norm(final)=5.307 | 5856.5 samples/s | 91.5 steps/s
[Step=8350 Epoch=79.1] | Loss=0.00105 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.301 | L2-Norm(final)=5.322 | 1863.2 samples/s | 29.1 steps/s
[Step=8400 Epoch=79.6] | Loss=0.00095 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.297 | L2-Norm(final)=5.336 | 5387.5 samples/s | 84.2 steps/s
[Step=8450 Epoch=80.1] | Loss=0.00087 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.291 | L2-Norm(final)=5.350 | 1909.9 samples/s | 29.8 steps/s
[Step=8500 Epoch=80.5] | Loss=0.00080 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=5.363 | 5018.9 samples/s | 78.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=8501 Epoch=80.6] | Loss=0.00012 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.205 | L2-Norm(final)=5.489 | 3512.8 samples/s | 54.9 steps/s
[Step=8550 Epoch=81.0] | Loss=0.00012 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.190 | L2-Norm(final)=5.498 | 4212.6 samples/s | 65.8 steps/s
[Step=8600 Epoch=81.5] | Loss=0.00010 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.168 | L2-Norm(final)=5.504 | 5498.7 samples/s | 85.9 steps/s
[Step=8650 Epoch=82.0] | Loss=0.00008 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.144 | L2-Norm(final)=5.509 | 1699.6 samples/s | 26.6 steps/s
[Step=8700 Epoch=82.4] | Loss=0.00006 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.119 | L2-Norm(final)=5.513 | 5312.6 samples/s | 83.0 steps/s
[Step=8750 Epoch=82.9] | Loss=0.00006 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.093 | L2-Norm(final)=5.516 | 1756.6 samples/s | 27.4 steps/s
[Step=8800 Epoch=83.4] | Loss=0.00005 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.067 | L2-Norm(final)=5.518 | 5074.5 samples/s | 79.3 steps/s
[Step=8850 Epoch=83.9] | Loss=0.00004 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.041 | L2-Norm(final)=5.521 | 1775.7 samples/s | 27.7 steps/s
[Step=8900 Epoch=84.3] | Loss=0.00004 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.014 | L2-Norm(final)=5.523 | 4643.9 samples/s | 72.6 steps/s
[Step=8950 Epoch=84.8] | Loss=0.00004 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.988 | L2-Norm(final)=5.525 | 1802.9 samples/s | 28.2 steps/s
[Step=9000 Epoch=85.3] | Loss=0.00004 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=5.527 | 4573.7 samples/s | 71.5 steps/s
[Step=9050 Epoch=85.8] | Loss=0.00003 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.935 | L2-Norm(final)=5.529 | 1889.7 samples/s | 29.5 steps/s
[Step=9100 Epoch=86.2] | Loss=0.00003 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.908 | L2-Norm(final)=5.530 | 4523.2 samples/s | 70.7 steps/s
[Step=9150 Epoch=86.7] | Loss=0.00003 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.881 | L2-Norm(final)=5.532 | 1876.8 samples/s | 29.3 steps/s
[Step=9200 Epoch=87.2] | Loss=0.00003 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.855 | L2-Norm(final)=5.534 | 4422.3 samples/s | 69.1 steps/s
[Step=9250 Epoch=87.7] | Loss=0.00003 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.828 | L2-Norm(final)=5.535 | 1868.9 samples/s | 29.2 steps/s
[Step=9300 Epoch=88.1] | Loss=0.00003 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.802 | L2-Norm(final)=5.537 | 4388.6 samples/s | 68.6 steps/s
[Step=9350 Epoch=88.6] | Loss=0.00002 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.775 | L2-Norm(final)=5.538 | 1910.1 samples/s | 29.8 steps/s
[Step=9400 Epoch=89.1] | Loss=0.00002 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.749 | L2-Norm(final)=5.540 | 4422.8 samples/s | 69.1 steps/s
[Step=9450 Epoch=89.5] | Loss=0.00002 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.722 | L2-Norm(final)=5.541 | 5982.7 samples/s | 93.5 steps/s
[Step=9500 Epoch=90.0] | Loss=0.00002 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.695 | L2-Norm(final)=5.542 | 1672.2 samples/s | 26.1 steps/s
[Step=9550 Epoch=90.5] | Loss=0.00002 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.669 | L2-Norm(final)=5.544 | 5752.7 samples/s | 89.9 steps/s
[Step=9600 Epoch=91.0] | Loss=0.00002 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.642 | L2-Norm(final)=5.545 | 1709.7 samples/s | 26.7 steps/s
[Step=9650 Epoch=91.4] | Loss=0.00002 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.616 | L2-Norm(final)=5.547 | 5198.7 samples/s | 81.2 steps/s
[Step=9700 Epoch=91.9] | Loss=0.00002 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.589 | L2-Norm(final)=5.548 | 1763.7 samples/s | 27.6 steps/s
[Step=9750 Epoch=92.4] | Loss=0.00002 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.563 | L2-Norm(final)=5.549 | 4861.9 samples/s | 76.0 steps/s
[Step=9800 Epoch=92.9] | Loss=0.00002 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=5.551 | 1792.8 samples/s | 28.0 steps/s
[Step=9850 Epoch=93.3] | Loss=0.00002 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.510 | L2-Norm(final)=5.552 | 4325.8 samples/s | 67.6 steps/s
[Step=9900 Epoch=93.8] | Loss=0.00002 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=5.553 | 1877.9 samples/s | 29.3 steps/s
[Step=9950 Epoch=94.3] | Loss=0.00002 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.457 | L2-Norm(final)=5.555 | 4324.3 samples/s | 67.6 steps/s
[Step=10000 Epoch=94.8] | Loss=0.00002 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=5.556 | 1888.5 samples/s | 29.5 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_0/client_state-step10000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=16001 Epoch=152.8] | Loss=0.01025 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.116 | L2-Norm(final)=6.881 | 3718.9 samples/s | 58.1 steps/s
[Step=16050 Epoch=153.3] | Loss=0.00871 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.369 | L2-Norm(final)=6.833 | 4523.6 samples/s | 70.7 steps/s
[Step=16100 Epoch=153.7] | Loss=0.00513 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.514 | L2-Norm(final)=6.856 | 6743.2 samples/s | 105.4 steps/s
[Step=16150 Epoch=154.2] | Loss=0.00366 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.577 | L2-Norm(final)=6.879 | 1710.6 samples/s | 26.7 steps/s
[Step=16200 Epoch=154.7] | Loss=0.00282 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.603 | L2-Norm(final)=6.899 | 6541.1 samples/s | 102.2 steps/s
[Step=16250 Epoch=155.2] | Loss=0.00233 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.613 | L2-Norm(final)=6.917 | 1713.8 samples/s | 26.8 steps/s
[Step=16300 Epoch=155.7] | Loss=0.00196 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.614 | L2-Norm(final)=6.933 | 5844.3 samples/s | 91.3 steps/s
[Step=16350 Epoch=156.1] | Loss=0.00170 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.609 | L2-Norm(final)=6.947 | 1831.8 samples/s | 28.6 steps/s
[Step=16400 Epoch=156.6] | Loss=0.00150 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.599 | L2-Norm(final)=6.960 | 5525.8 samples/s | 86.3 steps/s
[Step=16450 Epoch=157.1] | Loss=0.00135 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.586 | L2-Norm(final)=6.972 | 1847.1 samples/s | 28.9 steps/s
[Step=16500 Epoch=157.6] | Loss=0.00122 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.572 | L2-Norm(final)=6.983 | 5355.0 samples/s | 83.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=157.6] | Loss=0.00009 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.425 | L2-Norm(final)=7.096 | 3770.8 samples/s | 58.9 steps/s
[Step=16550 Epoch=158.0] | Loss=0.00004 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.394 | L2-Norm(final)=7.101 | 4025.5 samples/s | 62.9 steps/s
[Step=16600 Epoch=158.5] | Loss=0.00004 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.355 | L2-Norm(final)=7.105 | 5986.5 samples/s | 93.5 steps/s
[Step=16650 Epoch=159.0] | Loss=0.00003 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.317 | L2-Norm(final)=7.109 | 1742.9 samples/s | 27.2 steps/s
[Step=16700 Epoch=159.5] | Loss=0.00002 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.277 | L2-Norm(final)=7.111 | 5489.4 samples/s | 85.8 steps/s
[Step=16750 Epoch=160.0] | Loss=0.00002 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.237 | L2-Norm(final)=7.112 | 1735.3 samples/s | 27.1 steps/s
[Step=16800 Epoch=160.4] | Loss=0.00002 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.196 | L2-Norm(final)=7.113 | 5105.9 samples/s | 79.8 steps/s
[Step=16850 Epoch=160.9] | Loss=0.00001 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.156 | L2-Norm(final)=7.114 | 1753.7 samples/s | 27.4 steps/s
[Step=16900 Epoch=161.4] | Loss=0.00001 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.116 | L2-Norm(final)=7.115 | 4952.8 samples/s | 77.4 steps/s
[Step=16950 Epoch=161.9] | Loss=0.00001 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.075 | L2-Norm(final)=7.116 | 1808.8 samples/s | 28.3 steps/s
[Step=17000 Epoch=162.3] | Loss=0.00001 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.035 | L2-Norm(final)=7.116 | 4748.0 samples/s | 74.2 steps/s
[Step=17050 Epoch=162.8] | Loss=0.00001 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.995 | L2-Norm(final)=7.117 | 1797.3 samples/s | 28.1 steps/s
[Step=17100 Epoch=163.3] | Loss=0.00001 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.954 | L2-Norm(final)=7.118 | 4510.4 samples/s | 70.5 steps/s
[Step=17150 Epoch=163.8] | Loss=0.00001 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.914 | L2-Norm(final)=7.118 | 1858.0 samples/s | 29.0 steps/s
[Step=17200 Epoch=164.2] | Loss=0.00001 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.874 | L2-Norm(final)=7.119 | 4408.9 samples/s | 68.9 steps/s
[Step=17250 Epoch=164.7] | Loss=0.00001 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.834 | L2-Norm(final)=7.119 | 1832.4 samples/s | 28.6 steps/s
[Step=17300 Epoch=165.2] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.794 | L2-Norm(final)=7.120 | 4410.2 samples/s | 68.9 steps/s
[Step=17350 Epoch=165.7] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.754 | L2-Norm(final)=7.120 | 1847.3 samples/s | 28.9 steps/s
[Step=17400 Epoch=166.2] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.714 | L2-Norm(final)=7.121 | 4185.5 samples/s | 65.4 steps/s
[Step=17450 Epoch=166.6] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.674 | L2-Norm(final)=7.122 | 1850.3 samples/s | 28.9 steps/s
[Step=17500 Epoch=167.1] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.635 | L2-Norm(final)=7.122 | 4646.0 samples/s | 72.6 steps/s
[Step=17550 Epoch=167.6] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.595 | L2-Norm(final)=7.123 | 6380.1 samples/s | 99.7 steps/s
[Step=17600 Epoch=168.1] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.555 | L2-Norm(final)=7.123 | 1651.4 samples/s | 25.8 steps/s
[Step=17650 Epoch=168.5] | Loss=0.00001 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.515 | L2-Norm(final)=7.124 | 5919.6 samples/s | 92.5 steps/s
[Step=17700 Epoch=169.0] | Loss=0.00001 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=7.124 | 1689.4 samples/s | 26.4 steps/s
[Step=17750 Epoch=169.5] | Loss=0.00001 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.435 | L2-Norm(final)=7.125 | 5474.5 samples/s | 85.5 steps/s
[Step=17800 Epoch=170.0] | Loss=0.00001 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.395 | L2-Norm(final)=7.125 | 1702.8 samples/s | 26.6 steps/s
[Step=17850 Epoch=170.5] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.356 | L2-Norm(final)=7.126 | 5274.1 samples/s | 82.4 steps/s
[Step=17900 Epoch=170.9] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.316 | L2-Norm(final)=7.127 | 1734.8 samples/s | 27.1 steps/s
[Step=17950 Epoch=171.4] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.276 | L2-Norm(final)=7.127 | 4903.9 samples/s | 76.6 steps/s
[Step=18000 Epoch=171.9] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=7.128 | 1804.8 samples/s | 28.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step18000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=12001 Epoch=114.4] | Loss=0.02550 | Reg=0.00172 | acc=0.9688 | L2-Norm=13.116 | L2-Norm(final)=7.077 | 3735.6 samples/s | 58.4 steps/s
[Step=12050 Epoch=114.8] | Loss=0.01136 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.411 | L2-Norm(final)=7.094 | 4648.1 samples/s | 72.6 steps/s
[Step=12100 Epoch=115.3] | Loss=0.00763 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.631 | L2-Norm(final)=7.099 | 7005.8 samples/s | 109.5 steps/s
[Step=12150 Epoch=115.8] | Loss=0.00529 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.730 | L2-Norm(final)=7.115 | 1765.2 samples/s | 27.6 steps/s
[Step=12200 Epoch=116.3] | Loss=0.00409 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.775 | L2-Norm(final)=7.132 | 6474.6 samples/s | 101.2 steps/s
[Step=12250 Epoch=116.8] | Loss=0.00331 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.796 | L2-Norm(final)=7.148 | 1775.9 samples/s | 27.7 steps/s
[Step=12300 Epoch=117.2] | Loss=0.00282 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.804 | L2-Norm(final)=7.163 | 6217.0 samples/s | 97.1 steps/s
[Step=12350 Epoch=117.7] | Loss=0.00245 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.805 | L2-Norm(final)=7.177 | 1816.3 samples/s | 28.4 steps/s
[Step=12400 Epoch=118.2] | Loss=0.00217 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.801 | L2-Norm(final)=7.191 | 5516.6 samples/s | 86.2 steps/s
[Step=12450 Epoch=118.7] | Loss=0.00194 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.794 | L2-Norm(final)=7.204 | 1876.8 samples/s | 29.3 steps/s
[Step=12500 Epoch=119.1] | Loss=0.00176 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.784 | L2-Norm(final)=7.216 | 5381.9 samples/s | 84.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=119.1] | Loss=0.00007 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.678 | L2-Norm(final)=7.332 | 3704.0 samples/s | 57.9 steps/s
[Step=12550 Epoch=119.6] | Loss=0.00111 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.655 | L2-Norm(final)=7.341 | 3968.3 samples/s | 62.0 steps/s
[Step=12600 Epoch=120.1] | Loss=0.01355 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.790 | L2-Norm(final)=7.311 | 5976.1 samples/s | 93.4 steps/s
[Step=12650 Epoch=120.6] | Loss=0.01056 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.914 | L2-Norm(final)=7.268 | 1700.9 samples/s | 26.6 steps/s
[Step=12700 Epoch=121.0] | Loss=0.00829 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.977 | L2-Norm(final)=7.245 | 5529.5 samples/s | 86.4 steps/s
[Step=12750 Epoch=121.5] | Loss=0.00666 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.010 | L2-Norm(final)=7.234 | 1668.3 samples/s | 26.1 steps/s
[Step=12800 Epoch=122.0] | Loss=0.00556 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.028 | L2-Norm(final)=7.227 | 5177.6 samples/s | 80.9 steps/s
[Step=12850 Epoch=122.5] | Loss=0.00478 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.035 | L2-Norm(final)=7.223 | 1675.5 samples/s | 26.2 steps/s
[Step=12900 Epoch=122.9] | Loss=0.00418 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.037 | L2-Norm(final)=7.220 | 4819.7 samples/s | 75.3 steps/s
[Step=12950 Epoch=123.4] | Loss=0.00372 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.034 | L2-Norm(final)=7.218 | 1764.8 samples/s | 27.6 steps/s
[Step=13000 Epoch=123.9] | Loss=0.00335 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.029 | L2-Norm(final)=7.217 | 4694.2 samples/s | 73.3 steps/s
[Step=13050 Epoch=124.4] | Loss=0.00305 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.022 | L2-Norm(final)=7.216 | 1823.3 samples/s | 28.5 steps/s
[Step=13100 Epoch=124.9] | Loss=0.00280 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.013 | L2-Norm(final)=7.215 | 4566.8 samples/s | 71.4 steps/s
[Step=13150 Epoch=125.3] | Loss=0.00259 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.004 | L2-Norm(final)=7.215 | 1847.5 samples/s | 28.9 steps/s
[Step=13200 Epoch=125.8] | Loss=0.00240 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.993 | L2-Norm(final)=7.215 | 4381.6 samples/s | 68.5 steps/s
[Step=13250 Epoch=126.3] | Loss=0.00224 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.981 | L2-Norm(final)=7.215 | 1878.3 samples/s | 29.3 steps/s
[Step=13300 Epoch=126.8] | Loss=0.00210 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.969 | L2-Norm(final)=7.215 | 4322.1 samples/s | 67.5 steps/s
[Step=13350 Epoch=127.2] | Loss=0.00198 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.956 | L2-Norm(final)=7.216 | 1865.1 samples/s | 29.1 steps/s
[Step=13400 Epoch=127.7] | Loss=0.00187 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.943 | L2-Norm(final)=7.216 | 4416.8 samples/s | 69.0 steps/s
[Step=13450 Epoch=128.2] | Loss=0.00177 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.929 | L2-Norm(final)=7.216 | 1924.8 samples/s | 30.1 steps/s
[Step=13500 Epoch=128.7] | Loss=0.00169 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.915 | L2-Norm(final)=7.217 | 4201.8 samples/s | 65.7 steps/s
[Step=13550 Epoch=129.1] | Loss=0.00161 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.901 | L2-Norm(final)=7.217 | 6278.2 samples/s | 98.1 steps/s
[Step=13600 Epoch=129.6] | Loss=0.00153 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.886 | L2-Norm(final)=7.218 | 1649.0 samples/s | 25.8 steps/s
[Step=13650 Epoch=130.1] | Loss=0.00147 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.871 | L2-Norm(final)=7.218 | 5829.4 samples/s | 91.1 steps/s
[Step=13700 Epoch=130.6] | Loss=0.00141 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.856 | L2-Norm(final)=7.219 | 1659.3 samples/s | 25.9 steps/s
[Step=13750 Epoch=131.0] | Loss=0.00135 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.841 | L2-Norm(final)=7.219 | 5560.1 samples/s | 86.9 steps/s
[Step=13800 Epoch=131.5] | Loss=0.00130 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.825 | L2-Norm(final)=7.220 | 1713.9 samples/s | 26.8 steps/s
[Step=13850 Epoch=132.0] | Loss=0.00125 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.810 | L2-Norm(final)=7.221 | 5279.8 samples/s | 82.5 steps/s
[Step=13900 Epoch=132.5] | Loss=0.00121 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.794 | L2-Norm(final)=7.221 | 1770.8 samples/s | 27.7 steps/s
[Step=13950 Epoch=133.0] | Loss=0.00117 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.778 | L2-Norm(final)=7.222 | 5023.8 samples/s | 78.5 steps/s
[Step=14000 Epoch=133.4] | Loss=0.00113 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=7.223 | 1816.5 samples/s | 28.4 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step14000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10251 | acc=0.9546 | tpr=0.9673 | fpr=0.0728 | 4116.3 samples/s | 16.1 steps/s
Avg test loss: 0.10786, Avg test acc: 0.95272, Avg tpr: 0.96602, Avg fpr: 0.07653, total FA: 597

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10064 | acc=0.9508 | tpr=0.9637 | fpr=0.0773 | 4149.0 samples/s | 16.2 steps/s
Avg test loss: 0.10345, Avg test acc: 0.95136, Avg tpr: 0.96380, Avg fpr: 0.07602, total FA: 593

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.12421 | acc=0.9524 | tpr=0.9744 | fpr=0.0954 | 4089.3 samples/s | 16.0 steps/s
Avg test loss: 0.12624, Avg test acc: 0.95056, Avg tpr: 0.97284, Avg fpr: 0.09845, total FA: 768

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.11217 | acc=0.9520 | tpr=0.9671 | fpr=0.0808 | 4124.9 samples/s | 16.1 steps/s
Avg test loss: 0.11704, Avg test acc: 0.95172, Avg tpr: 0.96742, Avg fpr: 0.08281, total FA: 646

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10354 | acc=0.9549 | tpr=0.9629 | fpr=0.0624 | 4093.8 samples/s | 16.0 steps/s
Avg test loss: 0.10802, Avg test acc: 0.95280, Avg tpr: 0.96025, Avg fpr: 0.06358, total FA: 496

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.52270 | acc=0.2786 | tpr=0.0048 | fpr=0.1269 | 3950.1 samples/s | 15.4 steps/s
Avg test loss: 4.54036, Avg test acc: 0.27691, Avg tpr: 0.00635, Avg fpr: 0.12806, total FA: 999

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.07915 | acc=0.3102 | tpr=0.0074 | fpr=0.0325 | 3889.1 samples/s | 15.2 steps/s
Avg test loss: 4.08340, Avg test acc: 0.30872, Avg tpr: 0.00863, Avg fpr: 0.03128, total FA: 244

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.97427 | acc=0.2917 | tpr=0.0059 | fpr=0.0877 | 4219.3 samples/s | 16.5 steps/s
Avg test loss: 4.98202, Avg test acc: 0.29153, Avg tpr: 0.00833, Avg fpr: 0.08563, total FA: 668

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.14320 | acc=0.3026 | tpr=0.0026 | fpr=0.0461 | 4070.8 samples/s | 15.9 steps/s
Avg test loss: 4.14816, Avg test acc: 0.30143, Avg tpr: 0.00373, Avg fpr: 0.04384, total FA: 342

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.03733 | acc=0.3116 | tpr=0.0021 | fpr=0.0161 | 3983.6 samples/s | 15.6 steps/s
Avg test loss: 4.04498, Avg test acc: 0.30844, Avg tpr: 0.00221, Avg fpr: 0.01807, total FA: 141

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.07291 | acc=0.1197 | tpr=0.7699 | fpr=0.8920 | 4053.8 samples/s | 15.8 steps/s
[Step= 100] | Loss=5.04212 | acc=0.1214 | tpr=0.7441 | fpr=0.8903 | 8200.0 samples/s | 32.0 steps/s
[Step= 150] | Loss=5.05036 | acc=0.1209 | tpr=0.7406 | fpr=0.8905 | 7436.7 samples/s | 29.0 steps/s
[Step= 200] | Loss=5.04955 | acc=0.1202 | tpr=0.7454 | fpr=0.8911 | 8424.1 samples/s | 32.9 steps/s
[Step= 250] | Loss=5.04877 | acc=0.1207 | tpr=0.7485 | fpr=0.8907 | 7865.8 samples/s | 30.7 steps/s
[Step= 300] | Loss=5.04514 | acc=0.1208 | tpr=0.7469 | fpr=0.8906 | 7839.5 samples/s | 30.6 steps/s
[Step= 350] | Loss=5.04174 | acc=0.1209 | tpr=0.7401 | fpr=0.8904 | 8155.9 samples/s | 31.9 steps/s
[Step= 400] | Loss=5.04119 | acc=0.1214 | tpr=0.7380 | fpr=0.8898 | 7949.9 samples/s | 31.1 steps/s
[Step= 450] | Loss=5.04313 | acc=0.1213 | tpr=0.7313 | fpr=0.8898 | 7990.8 samples/s | 31.2 steps/s
[Step= 500] | Loss=5.04342 | acc=0.1210 | tpr=0.7269 | fpr=0.8899 | 7696.1 samples/s | 30.1 steps/s
[Step= 550] | Loss=5.04488 | acc=0.1210 | tpr=0.7298 | fpr=0.8901 | 14796.3 samples/s | 57.8 steps/s
Avg test loss: 5.04608, Avg test acc: 0.12087, Avg tpr: 0.73019, Avg fpr: 0.89021, total FA: 123604

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.65537 | acc=0.1213 | tpr=0.7345 | fpr=0.8897 | 4036.2 samples/s | 15.8 steps/s
[Step= 100] | Loss=4.60726 | acc=0.1233 | tpr=0.7015 | fpr=0.8875 | 8338.5 samples/s | 32.6 steps/s
[Step= 150] | Loss=4.61689 | acc=0.1203 | tpr=0.6916 | fpr=0.8902 | 7700.1 samples/s | 30.1 steps/s
[Step= 200] | Loss=4.62002 | acc=0.1201 | tpr=0.6809 | fpr=0.8901 | 7459.6 samples/s | 29.1 steps/s
[Step= 250] | Loss=4.61841 | acc=0.1213 | tpr=0.6769 | fpr=0.8888 | 7336.3 samples/s | 28.7 steps/s
[Step= 300] | Loss=4.61994 | acc=0.1213 | tpr=0.6793 | fpr=0.8889 | 7718.1 samples/s | 30.1 steps/s
[Step= 350] | Loss=4.61340 | acc=0.1213 | tpr=0.6738 | fpr=0.8887 | 8129.6 samples/s | 31.8 steps/s
[Step= 400] | Loss=4.61296 | acc=0.1217 | tpr=0.6718 | fpr=0.8883 | 7933.0 samples/s | 31.0 steps/s
[Step= 450] | Loss=4.61442 | acc=0.1215 | tpr=0.6665 | fpr=0.8884 | 8156.2 samples/s | 31.9 steps/s
[Step= 500] | Loss=4.61579 | acc=0.1214 | tpr=0.6648 | fpr=0.8885 | 7883.4 samples/s | 30.8 steps/s
[Step= 550] | Loss=4.61847 | acc=0.1211 | tpr=0.6626 | fpr=0.8887 | 14119.8 samples/s | 55.2 steps/s
Avg test loss: 4.61958, Avg test acc: 0.12103, Avg tpr: 0.66244, Avg fpr: 0.88881, total FA: 123410

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.58497 | acc=0.1023 | tpr=0.7699 | fpr=0.9097 | 4049.5 samples/s | 15.8 steps/s
[Step= 100] | Loss=6.53744 | acc=0.1027 | tpr=0.7441 | fpr=0.9093 | 7894.3 samples/s | 30.8 steps/s
[Step= 150] | Loss=6.54636 | acc=0.1014 | tpr=0.7464 | fpr=0.9104 | 7962.5 samples/s | 31.1 steps/s
[Step= 200] | Loss=6.54294 | acc=0.1007 | tpr=0.7464 | fpr=0.9110 | 7999.3 samples/s | 31.2 steps/s
[Step= 250] | Loss=6.54231 | acc=0.1005 | tpr=0.7450 | fpr=0.9112 | 7489.6 samples/s | 29.3 steps/s
[Step= 300] | Loss=6.53956 | acc=0.1005 | tpr=0.7520 | fpr=0.9114 | 7634.8 samples/s | 29.8 steps/s
[Step= 350] | Loss=6.53982 | acc=0.0996 | tpr=0.7401 | fpr=0.9120 | 8070.1 samples/s | 31.5 steps/s
[Step= 400] | Loss=6.54442 | acc=0.1001 | tpr=0.7363 | fpr=0.9115 | 7910.6 samples/s | 30.9 steps/s
[Step= 450] | Loss=6.54773 | acc=0.1000 | tpr=0.7337 | fpr=0.9115 | 7885.5 samples/s | 30.8 steps/s
[Step= 500] | Loss=6.54885 | acc=0.0999 | tpr=0.7291 | fpr=0.9115 | 7911.3 samples/s | 30.9 steps/s
[Step= 550] | Loss=6.55137 | acc=0.0997 | tpr=0.7326 | fpr=0.9118 | 12754.9 samples/s | 49.8 steps/s
Avg test loss: 6.55367, Avg test acc: 0.09966, Avg tpr: 0.73217, Avg fpr: 0.91184, total FA: 126607

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.47617 | acc=0.1345 | tpr=0.6327 | fpr=0.8744 | 4040.0 samples/s | 15.8 steps/s
[Step= 100] | Loss=5.43066 | acc=0.1341 | tpr=0.5757 | fpr=0.8742 | 8075.3 samples/s | 31.5 steps/s
[Step= 150] | Loss=5.43258 | acc=0.1326 | tpr=0.5793 | fpr=0.8756 | 8501.8 samples/s | 33.2 steps/s
[Step= 200] | Loss=5.42705 | acc=0.1326 | tpr=0.5716 | fpr=0.8754 | 7811.0 samples/s | 30.5 steps/s
[Step= 250] | Loss=5.42868 | acc=0.1325 | tpr=0.5729 | fpr=0.8755 | 7992.3 samples/s | 31.2 steps/s
[Step= 300] | Loss=5.42697 | acc=0.1325 | tpr=0.5789 | fpr=0.8756 | 7283.9 samples/s | 28.5 steps/s
[Step= 350] | Loss=5.42079 | acc=0.1322 | tpr=0.5717 | fpr=0.8757 | 8501.2 samples/s | 33.2 steps/s
[Step= 400] | Loss=5.42387 | acc=0.1319 | tpr=0.5656 | fpr=0.8759 | 7933.6 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.42568 | acc=0.1317 | tpr=0.5672 | fpr=0.8762 | 8055.8 samples/s | 31.5 steps/s
[Step= 500] | Loss=5.42605 | acc=0.1316 | tpr=0.5674 | fpr=0.8763 | 8195.0 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.42797 | acc=0.1311 | tpr=0.5682 | fpr=0.8768 | 13651.9 samples/s | 53.3 steps/s
Avg test loss: 5.42961, Avg test acc: 0.13106, Avg tpr: 0.56854, Avg fpr: 0.87689, total FA: 121755

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.42687 | acc=0.1281 | tpr=0.6549 | fpr=0.8813 | 3920.9 samples/s | 15.3 steps/s
[Step= 100] | Loss=5.39812 | acc=0.1296 | tpr=0.5864 | fpr=0.8789 | 8032.5 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.40573 | acc=0.1289 | tpr=0.5922 | fpr=0.8796 | 7967.0 samples/s | 31.1 steps/s
[Step= 200] | Loss=5.39972 | acc=0.1289 | tpr=0.5934 | fpr=0.8796 | 8173.9 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.40174 | acc=0.1289 | tpr=0.5948 | fpr=0.8796 | 8128.9 samples/s | 31.8 steps/s
[Step= 300] | Loss=5.39593 | acc=0.1289 | tpr=0.5935 | fpr=0.8796 | 7358.9 samples/s | 28.7 steps/s
[Step= 350] | Loss=5.38975 | acc=0.1289 | tpr=0.5867 | fpr=0.8794 | 7482.2 samples/s | 29.2 steps/s
[Step= 400] | Loss=5.39419 | acc=0.1290 | tpr=0.5804 | fpr=0.8792 | 7816.9 samples/s | 30.5 steps/s
[Step= 450] | Loss=5.39530 | acc=0.1292 | tpr=0.5755 | fpr=0.8789 | 8230.2 samples/s | 32.1 steps/s
[Step= 500] | Loss=5.39605 | acc=0.1292 | tpr=0.5709 | fpr=0.8788 | 8403.5 samples/s | 32.8 steps/s
[Step= 550] | Loss=5.39776 | acc=0.1291 | tpr=0.5706 | fpr=0.8789 | 14558.6 samples/s | 56.9 steps/s
Avg test loss: 5.40026, Avg test acc: 0.12907, Avg tpr: 0.57092, Avg fpr: 0.87896, total FA: 122042

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10100 | acc=0.9802 | tpr=0.9248 | fpr=0.0188 | 3993.6 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.10354 | acc=0.9796 | tpr=0.9403 | fpr=0.0196 | 7889.8 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.10749 | acc=0.9787 | tpr=0.9424 | fpr=0.0207 | 8181.9 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.10975 | acc=0.9785 | tpr=0.9443 | fpr=0.0208 | 8051.4 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.10887 | acc=0.9786 | tpr=0.9389 | fpr=0.0207 | 7703.9 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.11042 | acc=0.9783 | tpr=0.9382 | fpr=0.0210 | 7967.0 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.11033 | acc=0.9782 | tpr=0.9374 | fpr=0.0210 | 7961.7 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.11176 | acc=0.9781 | tpr=0.9327 | fpr=0.0210 | 7710.6 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.11444 | acc=0.9779 | tpr=0.9323 | fpr=0.0213 | 7973.7 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.11396 | acc=0.9779 | tpr=0.9344 | fpr=0.0213 | 7638.8 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.11290 | acc=0.9781 | tpr=0.9335 | fpr=0.0211 | 14961.7 samples/s | 58.4 steps/s
Avg test loss: 0.11278, Avg test acc: 0.97814, Avg tpr: 0.93304, Avg fpr: 0.02104, total FA: 2922

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10318 | acc=0.9814 | tpr=0.8938 | fpr=0.0170 | 3877.5 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.10654 | acc=0.9809 | tpr=0.9104 | fpr=0.0177 | 8168.4 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.11019 | acc=0.9804 | tpr=0.9121 | fpr=0.0184 | 7950.6 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.11238 | acc=0.9803 | tpr=0.9126 | fpr=0.0185 | 8010.1 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.11131 | acc=0.9803 | tpr=0.9144 | fpr=0.0185 | 8159.9 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.11290 | acc=0.9801 | tpr=0.9164 | fpr=0.0187 | 7901.0 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.11241 | acc=0.9801 | tpr=0.9198 | fpr=0.0188 | 7508.6 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.11397 | acc=0.9799 | tpr=0.9158 | fpr=0.0190 | 8119.8 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.11672 | acc=0.9796 | tpr=0.9143 | fpr=0.0192 | 7879.3 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.11620 | acc=0.9796 | tpr=0.9163 | fpr=0.0192 | 7952.8 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.11533 | acc=0.9797 | tpr=0.9140 | fpr=0.0191 | 14644.4 samples/s | 57.2 steps/s
Avg test loss: 0.11514, Avg test acc: 0.97974, Avg tpr: 0.91323, Avg fpr: 0.01905, total FA: 2645

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10857 | acc=0.9805 | tpr=0.9336 | fpr=0.0187 | 4128.0 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.11238 | acc=0.9802 | tpr=0.9488 | fpr=0.0192 | 8000.2 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.11672 | acc=0.9791 | tpr=0.9452 | fpr=0.0202 | 8048.3 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.11976 | acc=0.9790 | tpr=0.9486 | fpr=0.0204 | 7895.6 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.11854 | acc=0.9790 | tpr=0.9476 | fpr=0.0205 | 7790.4 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.12052 | acc=0.9786 | tpr=0.9469 | fpr=0.0209 | 8131.8 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.12027 | acc=0.9784 | tpr=0.9461 | fpr=0.0210 | 7642.6 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.12163 | acc=0.9783 | tpr=0.9420 | fpr=0.0210 | 7389.5 samples/s | 28.9 steps/s
[Step= 450] | Loss=0.12437 | acc=0.9780 | tpr=0.9411 | fpr=0.0213 | 7945.1 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.12384 | acc=0.9780 | tpr=0.9432 | fpr=0.0213 | 7901.5 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.12264 | acc=0.9782 | tpr=0.9431 | fpr=0.0211 | 14147.8 samples/s | 55.3 steps/s
Avg test loss: 0.12251, Avg test acc: 0.97825, Avg tpr: 0.94295, Avg fpr: 0.02111, total FA: 2931

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10929 | acc=0.9807 | tpr=0.8982 | fpr=0.0178 | 4192.0 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.11420 | acc=0.9802 | tpr=0.9211 | fpr=0.0187 | 7113.3 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.11818 | acc=0.9794 | tpr=0.9236 | fpr=0.0196 | 8043.9 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.12178 | acc=0.9792 | tpr=0.9301 | fpr=0.0199 | 7661.4 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.12031 | acc=0.9792 | tpr=0.9275 | fpr=0.0198 | 7856.8 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.12205 | acc=0.9790 | tpr=0.9302 | fpr=0.0201 | 8082.0 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.12190 | acc=0.9789 | tpr=0.9311 | fpr=0.0202 | 8127.9 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.12317 | acc=0.9787 | tpr=0.9256 | fpr=0.0203 | 7897.6 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.12612 | acc=0.9783 | tpr=0.9241 | fpr=0.0207 | 7996.6 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.12538 | acc=0.9783 | tpr=0.9256 | fpr=0.0207 | 8067.1 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.12440 | acc=0.9785 | tpr=0.9264 | fpr=0.0206 | 14531.7 samples/s | 56.8 steps/s
Avg test loss: 0.12418, Avg test acc: 0.97848, Avg tpr: 0.92552, Avg fpr: 0.02055, total FA: 2854

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12300 | acc=0.9796 | tpr=0.8850 | fpr=0.0187 | 4069.1 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.12665 | acc=0.9794 | tpr=0.9041 | fpr=0.0192 | 7799.2 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.13068 | acc=0.9786 | tpr=0.9164 | fpr=0.0203 | 7846.4 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.13410 | acc=0.9783 | tpr=0.9202 | fpr=0.0206 | 8116.4 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.13268 | acc=0.9784 | tpr=0.9179 | fpr=0.0205 | 7926.4 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.13639 | acc=0.9779 | tpr=0.9156 | fpr=0.0210 | 8435.8 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.13694 | acc=0.9778 | tpr=0.9173 | fpr=0.0211 | 8019.4 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.13856 | acc=0.9776 | tpr=0.9114 | fpr=0.0212 | 7988.3 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.14133 | acc=0.9773 | tpr=0.9104 | fpr=0.0215 | 7941.5 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.14099 | acc=0.9772 | tpr=0.9093 | fpr=0.0215 | 7847.9 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.13984 | acc=0.9774 | tpr=0.9081 | fpr=0.0214 | 13948.5 samples/s | 54.5 steps/s
Avg test loss: 0.13961, Avg test acc: 0.97737, Avg tpr: 0.90769, Avg fpr: 0.02136, total FA: 2966

server round 16/50

clients selected: [1 2 4 6 8]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=22001 Epoch=107.4] | Loss=0.04984 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.860 | L2-Norm(final)=8.874 | 3882.7 samples/s | 60.7 steps/s
[Step=22050 Epoch=107.6] | Loss=0.03204 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.931 | L2-Norm(final)=8.859 | 4810.6 samples/s | 75.2 steps/s
[Step=22100 Epoch=107.8] | Loss=0.02910 | Reg=0.00169 | acc=0.9844 | L2-Norm=13.001 | L2-Norm(final)=8.856 | 5163.9 samples/s | 80.7 steps/s
[Step=22150 Epoch=108.1] | Loss=0.03062 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.058 | L2-Norm(final)=8.862 | 5160.0 samples/s | 80.6 steps/s
[Step=22200 Epoch=108.3] | Loss=0.02935 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.110 | L2-Norm(final)=8.873 | 7331.1 samples/s | 114.5 steps/s
[Step=22250 Epoch=108.6] | Loss=0.02757 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.160 | L2-Norm(final)=8.888 | 1792.1 samples/s | 28.0 steps/s
[Step=22300 Epoch=108.8] | Loss=0.02633 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.208 | L2-Norm(final)=8.907 | 5069.7 samples/s | 79.2 steps/s
[Step=22350 Epoch=109.1] | Loss=0.02541 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.254 | L2-Norm(final)=8.929 | 5025.7 samples/s | 78.5 steps/s
[Step=22400 Epoch=109.3] | Loss=0.02447 | Reg=0.00177 | acc=0.9531 | L2-Norm=13.300 | L2-Norm(final)=8.951 | 6703.8 samples/s | 104.7 steps/s
[Step=22450 Epoch=109.5] | Loss=0.02337 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=8.973 | 1804.5 samples/s | 28.2 steps/s
[Step=22500 Epoch=109.8] | Loss=0.02286 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.387 | L2-Norm(final)=8.997 | 5308.6 samples/s | 82.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=109.8] | Loss=0.00798 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.817 | L2-Norm(final)=9.241 | 3593.1 samples/s | 56.1 steps/s
[Step=22550 Epoch=110.0] | Loss=0.02310 | Reg=0.00192 | acc=0.9688 | L2-Norm=13.874 | L2-Norm(final)=9.260 | 4416.2 samples/s | 69.0 steps/s
[Step=22600 Epoch=110.3] | Loss=0.03217 | Reg=0.00194 | acc=0.9219 | L2-Norm=13.931 | L2-Norm(final)=9.258 | 4593.7 samples/s | 71.8 steps/s
[Step=22650 Epoch=110.5] | Loss=0.03714 | Reg=0.00195 | acc=0.9531 | L2-Norm=13.981 | L2-Norm(final)=9.244 | 4419.5 samples/s | 69.1 steps/s
[Step=22700 Epoch=110.8] | Loss=0.03635 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.026 | L2-Norm(final)=9.234 | 6327.6 samples/s | 98.9 steps/s
[Step=22750 Epoch=111.0] | Loss=0.03342 | Reg=0.00198 | acc=0.9531 | L2-Norm=14.065 | L2-Norm(final)=9.227 | 1767.2 samples/s | 27.6 steps/s
[Step=22800 Epoch=111.3] | Loss=0.03123 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.098 | L2-Norm(final)=9.225 | 4633.1 samples/s | 72.4 steps/s
[Step=22850 Epoch=111.5] | Loss=0.02898 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.127 | L2-Norm(final)=9.225 | 4451.5 samples/s | 69.6 steps/s
[Step=22900 Epoch=111.7] | Loss=0.02776 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.153 | L2-Norm(final)=9.226 | 5960.0 samples/s | 93.1 steps/s
[Step=22950 Epoch=112.0] | Loss=0.02591 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.176 | L2-Norm(final)=9.227 | 1771.0 samples/s | 27.7 steps/s
[Step=23000 Epoch=112.2] | Loss=0.02450 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.195 | L2-Norm(final)=9.229 | 4572.4 samples/s | 71.4 steps/s
[Step=23050 Epoch=112.5] | Loss=0.02369 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.212 | L2-Norm(final)=9.231 | 4546.6 samples/s | 71.0 steps/s
[Step=23100 Epoch=112.7] | Loss=0.02252 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.227 | L2-Norm(final)=9.232 | 5461.8 samples/s | 85.3 steps/s
[Step=23150 Epoch=113.0] | Loss=0.02130 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.241 | L2-Norm(final)=9.234 | 1845.5 samples/s | 28.8 steps/s
[Step=23200 Epoch=113.2] | Loss=0.02043 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.253 | L2-Norm(final)=9.236 | 4578.0 samples/s | 71.5 steps/s
[Step=23250 Epoch=113.4] | Loss=0.01972 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.263 | L2-Norm(final)=9.238 | 4637.9 samples/s | 72.5 steps/s
[Step=23300 Epoch=113.7] | Loss=0.01920 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.273 | L2-Norm(final)=9.239 | 5008.6 samples/s | 78.3 steps/s
[Step=23350 Epoch=113.9] | Loss=0.01835 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.282 | L2-Norm(final)=9.241 | 1830.1 samples/s | 28.6 steps/s
[Step=23400 Epoch=114.2] | Loss=0.01767 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.290 | L2-Norm(final)=9.243 | 4474.4 samples/s | 69.9 steps/s
[Step=23450 Epoch=114.4] | Loss=0.01705 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.297 | L2-Norm(final)=9.245 | 4604.9 samples/s | 72.0 steps/s
[Step=23500 Epoch=114.7] | Loss=0.01652 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.303 | L2-Norm(final)=9.248 | 4897.3 samples/s | 76.5 steps/s
[Step=23550 Epoch=114.9] | Loss=0.01615 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.308 | L2-Norm(final)=9.250 | 1853.0 samples/s | 29.0 steps/s
[Step=23600 Epoch=115.2] | Loss=0.01563 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.313 | L2-Norm(final)=9.252 | 4680.7 samples/s | 73.1 steps/s
[Step=23650 Epoch=115.4] | Loss=0.01514 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.318 | L2-Norm(final)=9.254 | 4533.3 samples/s | 70.8 steps/s
[Step=23700 Epoch=115.6] | Loss=0.01470 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.322 | L2-Norm(final)=9.256 | 4646.6 samples/s | 72.6 steps/s
[Step=23750 Epoch=115.9] | Loss=0.01426 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.325 | L2-Norm(final)=9.258 | 1889.7 samples/s | 29.5 steps/s
[Step=23800 Epoch=116.1] | Loss=0.01396 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.328 | L2-Norm(final)=9.261 | 4214.8 samples/s | 65.9 steps/s
[Step=23850 Epoch=116.4] | Loss=0.01360 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.331 | L2-Norm(final)=9.263 | 4457.6 samples/s | 69.6 steps/s
[Step=23900 Epoch=116.6] | Loss=0.01334 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.334 | L2-Norm(final)=9.265 | 4439.4 samples/s | 69.4 steps/s
[Step=23950 Epoch=116.9] | Loss=0.01299 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.336 | L2-Norm(final)=9.267 | 1893.3 samples/s | 29.6 steps/s
[Step=24000 Epoch=117.1] | Loss=0.01275 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.338 | L2-Norm(final)=9.269 | 4617.8 samples/s | 72.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step24000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=22001 Epoch=107.2] | Loss=0.00589 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.860 | L2-Norm(final)=10.465 | 3657.1 samples/s | 57.1 steps/s
[Step=22050 Epoch=107.4] | Loss=0.03453 | Reg=0.00167 | acc=0.9688 | L2-Norm=12.933 | L2-Norm(final)=10.438 | 4975.1 samples/s | 77.7 steps/s
[Step=22100 Epoch=107.7] | Loss=0.03228 | Reg=0.00169 | acc=0.9531 | L2-Norm=13.009 | L2-Norm(final)=10.438 | 5214.6 samples/s | 81.5 steps/s
[Step=22150 Epoch=107.9] | Loss=0.03094 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.070 | L2-Norm(final)=10.442 | 5250.6 samples/s | 82.0 steps/s
[Step=22200 Epoch=108.2] | Loss=0.02903 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.128 | L2-Norm(final)=10.452 | 7141.3 samples/s | 111.6 steps/s
[Step=22250 Epoch=108.4] | Loss=0.02686 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.181 | L2-Norm(final)=10.468 | 1842.3 samples/s | 28.8 steps/s
[Step=22300 Epoch=108.7] | Loss=0.02538 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.229 | L2-Norm(final)=10.487 | 5524.4 samples/s | 86.3 steps/s
[Step=22350 Epoch=108.9] | Loss=0.02459 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.275 | L2-Norm(final)=10.506 | 5212.1 samples/s | 81.4 steps/s
[Step=22400 Epoch=109.1] | Loss=0.02433 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.321 | L2-Norm(final)=10.526 | 6742.6 samples/s | 105.4 steps/s
[Step=22450 Epoch=109.4] | Loss=0.02323 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=10.546 | 1811.5 samples/s | 28.3 steps/s
[Step=22500 Epoch=109.6] | Loss=0.02248 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.412 | L2-Norm(final)=10.567 | 4938.4 samples/s | 77.2 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=109.6] | Loss=0.01736 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.848 | L2-Norm(final)=10.793 | 3731.4 samples/s | 58.3 steps/s
[Step=22550 Epoch=109.9] | Loss=0.02404 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.884 | L2-Norm(final)=10.810 | 4271.3 samples/s | 66.7 steps/s
[Step=22600 Epoch=110.1] | Loss=0.03667 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.941 | L2-Norm(final)=10.798 | 4463.8 samples/s | 69.7 steps/s
[Step=22650 Epoch=110.4] | Loss=0.03717 | Reg=0.00196 | acc=0.9688 | L2-Norm=14.002 | L2-Norm(final)=10.789 | 4553.2 samples/s | 71.1 steps/s
[Step=22700 Epoch=110.6] | Loss=0.03553 | Reg=0.00197 | acc=0.9531 | L2-Norm=14.053 | L2-Norm(final)=10.784 | 6120.6 samples/s | 95.6 steps/s
[Step=22750 Epoch=110.8] | Loss=0.03236 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.095 | L2-Norm(final)=10.784 | 1771.3 samples/s | 27.7 steps/s
[Step=22800 Epoch=111.1] | Loss=0.03012 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.131 | L2-Norm(final)=10.785 | 4630.6 samples/s | 72.4 steps/s
[Step=22850 Epoch=111.3] | Loss=0.02929 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.161 | L2-Norm(final)=10.786 | 4514.0 samples/s | 70.5 steps/s
[Step=22900 Epoch=111.6] | Loss=0.02831 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.188 | L2-Norm(final)=10.785 | 5649.3 samples/s | 88.3 steps/s
[Step=22950 Epoch=111.8] | Loss=0.02799 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.214 | L2-Norm(final)=10.783 | 1767.1 samples/s | 27.6 steps/s
[Step=23000 Epoch=112.1] | Loss=0.02679 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.240 | L2-Norm(final)=10.783 | 4578.2 samples/s | 71.5 steps/s
[Step=23050 Epoch=112.3] | Loss=0.02538 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.263 | L2-Norm(final)=10.784 | 4601.7 samples/s | 71.9 steps/s
[Step=23100 Epoch=112.6] | Loss=0.02415 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.285 | L2-Norm(final)=10.786 | 5325.5 samples/s | 83.2 steps/s
[Step=23150 Epoch=112.8] | Loss=0.02319 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.303 | L2-Norm(final)=10.787 | 1812.0 samples/s | 28.3 steps/s
[Step=23200 Epoch=113.0] | Loss=0.02233 | Reg=0.00205 | acc=0.9688 | L2-Norm=14.320 | L2-Norm(final)=10.789 | 4584.4 samples/s | 71.6 steps/s
[Step=23250 Epoch=113.3] | Loss=0.02137 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.335 | L2-Norm(final)=10.791 | 4547.0 samples/s | 71.0 steps/s
[Step=23300 Epoch=113.5] | Loss=0.02053 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.348 | L2-Norm(final)=10.794 | 5060.1 samples/s | 79.1 steps/s
[Step=23350 Epoch=113.8] | Loss=0.01991 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.360 | L2-Norm(final)=10.796 | 1862.5 samples/s | 29.1 steps/s
[Step=23400 Epoch=114.0] | Loss=0.01927 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.371 | L2-Norm(final)=10.798 | 4646.4 samples/s | 72.6 steps/s
[Step=23450 Epoch=114.3] | Loss=0.01852 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.382 | L2-Norm(final)=10.799 | 4693.9 samples/s | 73.3 steps/s
[Step=23500 Epoch=114.5] | Loss=0.01800 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.392 | L2-Norm(final)=10.801 | 4767.4 samples/s | 74.5 steps/s
[Step=23550 Epoch=114.7] | Loss=0.01747 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.400 | L2-Norm(final)=10.803 | 1923.1 samples/s | 30.0 steps/s
[Step=23600 Epoch=115.0] | Loss=0.01689 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.408 | L2-Norm(final)=10.805 | 4628.5 samples/s | 72.3 steps/s
[Step=23650 Epoch=115.2] | Loss=0.01635 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.415 | L2-Norm(final)=10.807 | 4578.8 samples/s | 71.5 steps/s
[Step=23700 Epoch=115.5] | Loss=0.01595 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.421 | L2-Norm(final)=10.809 | 4568.0 samples/s | 71.4 steps/s
[Step=23750 Epoch=115.7] | Loss=0.01560 | Reg=0.00208 | acc=0.9688 | L2-Norm=14.427 | L2-Norm(final)=10.811 | 1982.4 samples/s | 31.0 steps/s
[Step=23800 Epoch=116.0] | Loss=0.01524 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.433 | L2-Norm(final)=10.813 | 4474.9 samples/s | 69.9 steps/s
[Step=23850 Epoch=116.2] | Loss=0.01489 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.438 | L2-Norm(final)=10.815 | 4573.6 samples/s | 71.5 steps/s
[Step=23900 Epoch=116.5] | Loss=0.01455 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.442 | L2-Norm(final)=10.816 | 4805.8 samples/s | 75.1 steps/s
[Step=23950 Epoch=116.7] | Loss=0.01419 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.446 | L2-Norm(final)=10.818 | 1952.1 samples/s | 30.5 steps/s
[Step=24000 Epoch=116.9] | Loss=0.01385 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.450 | L2-Norm(final)=10.820 | 4399.9 samples/s | 68.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step24000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=22001 Epoch=107.9] | Loss=0.02343 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.860 | L2-Norm(final)=9.599 | 3732.9 samples/s | 58.3 steps/s
[Step=22050 Epoch=108.1] | Loss=0.02730 | Reg=0.00167 | acc=0.9688 | L2-Norm=12.915 | L2-Norm(final)=9.585 | 4947.6 samples/s | 77.3 steps/s
[Step=22100 Epoch=108.4] | Loss=0.02987 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.980 | L2-Norm(final)=9.576 | 5268.2 samples/s | 82.3 steps/s
[Step=22150 Epoch=108.6] | Loss=0.02836 | Reg=0.00170 | acc=0.9688 | L2-Norm=13.037 | L2-Norm(final)=9.580 | 5039.9 samples/s | 78.7 steps/s
[Step=22200 Epoch=108.9] | Loss=0.02772 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.091 | L2-Norm(final)=9.588 | 7274.3 samples/s | 113.7 steps/s
[Step=22250 Epoch=109.1] | Loss=0.02575 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.142 | L2-Norm(final)=9.600 | 1781.6 samples/s | 27.8 steps/s
[Step=22300 Epoch=109.4] | Loss=0.02496 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.191 | L2-Norm(final)=9.618 | 5207.1 samples/s | 81.4 steps/s
[Step=22350 Epoch=109.6] | Loss=0.02379 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.240 | L2-Norm(final)=9.639 | 5079.5 samples/s | 79.4 steps/s
[Step=22400 Epoch=109.8] | Loss=0.02302 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=9.660 | 6972.6 samples/s | 108.9 steps/s
[Step=22450 Epoch=110.1] | Loss=0.02195 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.328 | L2-Norm(final)=9.682 | 1772.7 samples/s | 27.7 steps/s
[Step=22500 Epoch=110.3] | Loss=0.02107 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.371 | L2-Norm(final)=9.706 | 4867.1 samples/s | 76.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=22501 Epoch=110.3] | Loss=0.01247 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.788 | L2-Norm(final)=9.951 | 3508.8 samples/s | 54.8 steps/s
[Step=22550 Epoch=110.6] | Loss=0.02315 | Reg=0.00191 | acc=0.9531 | L2-Norm=13.829 | L2-Norm(final)=9.974 | 4279.9 samples/s | 66.9 steps/s
[Step=22600 Epoch=110.8] | Loss=0.03493 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.878 | L2-Norm(final)=9.962 | 4494.4 samples/s | 70.2 steps/s
[Step=22650 Epoch=111.1] | Loss=0.03752 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.932 | L2-Norm(final)=9.947 | 4280.2 samples/s | 66.9 steps/s
[Step=22700 Epoch=111.3] | Loss=0.03711 | Reg=0.00196 | acc=0.9531 | L2-Norm=13.983 | L2-Norm(final)=9.934 | 6156.4 samples/s | 96.2 steps/s
[Step=22750 Epoch=111.6] | Loss=0.03385 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.025 | L2-Norm(final)=9.926 | 1691.0 samples/s | 26.4 steps/s
[Step=22800 Epoch=111.8] | Loss=0.03134 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.061 | L2-Norm(final)=9.924 | 4455.6 samples/s | 69.6 steps/s
[Step=22850 Epoch=112.1] | Loss=0.02923 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.090 | L2-Norm(final)=9.924 | 4581.0 samples/s | 71.6 steps/s
[Step=22900 Epoch=112.3] | Loss=0.02771 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.116 | L2-Norm(final)=9.924 | 6237.5 samples/s | 97.5 steps/s
[Step=22950 Epoch=112.5] | Loss=0.02586 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.139 | L2-Norm(final)=9.925 | 1696.5 samples/s | 26.5 steps/s
[Step=23000 Epoch=112.8] | Loss=0.02446 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.159 | L2-Norm(final)=9.926 | 4511.4 samples/s | 70.5 steps/s
[Step=23050 Epoch=113.0] | Loss=0.02335 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.176 | L2-Norm(final)=9.927 | 4576.1 samples/s | 71.5 steps/s
[Step=23100 Epoch=113.3] | Loss=0.02244 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.191 | L2-Norm(final)=9.928 | 5633.2 samples/s | 88.0 steps/s
[Step=23150 Epoch=113.5] | Loss=0.02126 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.204 | L2-Norm(final)=9.929 | 1777.0 samples/s | 27.8 steps/s
[Step=23200 Epoch=113.8] | Loss=0.02018 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.216 | L2-Norm(final)=9.931 | 4614.7 samples/s | 72.1 steps/s
[Step=23250 Epoch=114.0] | Loss=0.01958 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.227 | L2-Norm(final)=9.933 | 4629.4 samples/s | 72.3 steps/s
[Step=23300 Epoch=114.3] | Loss=0.01892 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.237 | L2-Norm(final)=9.935 | 5353.8 samples/s | 83.7 steps/s
[Step=23350 Epoch=114.5] | Loss=0.01799 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.245 | L2-Norm(final)=9.937 | 1806.6 samples/s | 28.2 steps/s
[Step=23400 Epoch=114.7] | Loss=0.01734 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.253 | L2-Norm(final)=9.939 | 4443.0 samples/s | 69.4 steps/s
[Step=23450 Epoch=115.0] | Loss=0.01683 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.261 | L2-Norm(final)=9.941 | 4482.4 samples/s | 70.0 steps/s
[Step=23500 Epoch=115.2] | Loss=0.01632 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.267 | L2-Norm(final)=9.943 | 5070.5 samples/s | 79.2 steps/s
[Step=23550 Epoch=115.5] | Loss=0.01589 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.273 | L2-Norm(final)=9.945 | 1879.3 samples/s | 29.4 steps/s
[Step=23600 Epoch=115.7] | Loss=0.01538 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.279 | L2-Norm(final)=9.947 | 4648.3 samples/s | 72.6 steps/s
[Step=23650 Epoch=116.0] | Loss=0.01502 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.284 | L2-Norm(final)=9.949 | 4605.9 samples/s | 72.0 steps/s
[Step=23700 Epoch=116.2] | Loss=0.01464 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.289 | L2-Norm(final)=9.951 | 5008.1 samples/s | 78.3 steps/s
[Step=23750 Epoch=116.5] | Loss=0.01428 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.294 | L2-Norm(final)=9.953 | 1860.4 samples/s | 29.1 steps/s
[Step=23800 Epoch=116.7] | Loss=0.01392 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.298 | L2-Norm(final)=9.954 | 4622.9 samples/s | 72.2 steps/s
[Step=23850 Epoch=117.0] | Loss=0.01362 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.301 | L2-Norm(final)=9.956 | 4650.7 samples/s | 72.7 steps/s
[Step=23900 Epoch=117.2] | Loss=0.01326 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.304 | L2-Norm(final)=9.958 | 4616.5 samples/s | 72.1 steps/s
[Step=23950 Epoch=117.4] | Loss=0.01300 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.307 | L2-Norm(final)=9.959 | 1843.2 samples/s | 28.8 steps/s
[Step=24000 Epoch=117.7] | Loss=0.01271 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.309 | L2-Norm(final)=9.961 | 4883.9 samples/s | 76.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step24000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=14001 Epoch=133.2] | Loss=0.01363 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.860 | L2-Norm(final)=7.086 | 3495.3 samples/s | 54.6 steps/s
[Step=14050 Epoch=133.7] | Loss=0.00554 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.004 | L2-Norm(final)=7.104 | 4803.6 samples/s | 75.1 steps/s
[Step=14100 Epoch=134.1] | Loss=0.00374 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.139 | L2-Norm(final)=7.132 | 6819.0 samples/s | 106.5 steps/s
[Step=14150 Epoch=134.6] | Loss=0.00268 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.205 | L2-Norm(final)=7.154 | 1719.0 samples/s | 26.9 steps/s
[Step=14200 Epoch=135.1] | Loss=0.00212 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.236 | L2-Norm(final)=7.174 | 5881.1 samples/s | 91.9 steps/s
[Step=14250 Epoch=135.6] | Loss=0.00173 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.250 | L2-Norm(final)=7.191 | 1757.8 samples/s | 27.5 steps/s
[Step=14300 Epoch=136.0] | Loss=0.00146 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.254 | L2-Norm(final)=7.206 | 5734.3 samples/s | 89.6 steps/s
[Step=14350 Epoch=136.5] | Loss=0.00127 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.252 | L2-Norm(final)=7.220 | 1842.8 samples/s | 28.8 steps/s
[Step=14400 Epoch=137.0] | Loss=0.00112 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.245 | L2-Norm(final)=7.232 | 5369.1 samples/s | 83.9 steps/s
[Step=14450 Epoch=137.5] | Loss=0.00102 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.236 | L2-Norm(final)=7.244 | 1850.8 samples/s | 28.9 steps/s
[Step=14500 Epoch=137.9] | Loss=0.00092 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.225 | L2-Norm(final)=7.255 | 5175.2 samples/s | 80.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=137.9] | Loss=0.00007 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.111 | L2-Norm(final)=7.362 | 3714.8 samples/s | 58.0 steps/s
[Step=14550 Epoch=138.4] | Loss=0.00005 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.088 | L2-Norm(final)=7.369 | 4075.1 samples/s | 63.7 steps/s
[Step=14600 Epoch=138.9] | Loss=0.00005 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.059 | L2-Norm(final)=7.374 | 5834.2 samples/s | 91.2 steps/s
[Step=14650 Epoch=139.4] | Loss=0.00004 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.028 | L2-Norm(final)=7.377 | 1692.3 samples/s | 26.4 steps/s
[Step=14700 Epoch=139.8] | Loss=0.00003 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.997 | L2-Norm(final)=7.379 | 5152.3 samples/s | 80.5 steps/s
[Step=14750 Epoch=140.3] | Loss=0.00002 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.965 | L2-Norm(final)=7.381 | 1674.9 samples/s | 26.2 steps/s
[Step=14800 Epoch=140.8] | Loss=0.00002 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.933 | L2-Norm(final)=7.383 | 4736.2 samples/s | 74.0 steps/s
[Step=14850 Epoch=141.3] | Loss=0.00002 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=7.384 | 1700.9 samples/s | 26.6 steps/s
[Step=14900 Epoch=141.7] | Loss=0.00002 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.868 | L2-Norm(final)=7.385 | 4706.9 samples/s | 73.5 steps/s
[Step=14950 Epoch=142.2] | Loss=0.00002 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.836 | L2-Norm(final)=7.386 | 1849.5 samples/s | 28.9 steps/s
[Step=15000 Epoch=142.7] | Loss=0.00001 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.804 | L2-Norm(final)=7.388 | 4408.4 samples/s | 68.9 steps/s
[Step=15050 Epoch=143.2] | Loss=0.00001 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.772 | L2-Norm(final)=7.389 | 1851.2 samples/s | 28.9 steps/s
[Step=15100 Epoch=143.6] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.739 | L2-Norm(final)=7.390 | 4396.8 samples/s | 68.7 steps/s
[Step=15150 Epoch=144.1] | Loss=0.00001 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.707 | L2-Norm(final)=7.391 | 1913.1 samples/s | 29.9 steps/s
[Step=15200 Epoch=144.6] | Loss=0.00001 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=7.391 | 4348.2 samples/s | 67.9 steps/s
[Step=15250 Epoch=145.1] | Loss=0.00001 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.643 | L2-Norm(final)=7.392 | 1825.8 samples/s | 28.5 steps/s
[Step=15300 Epoch=145.5] | Loss=0.00001 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.611 | L2-Norm(final)=7.393 | 4260.6 samples/s | 66.6 steps/s
[Step=15350 Epoch=146.0] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.579 | L2-Norm(final)=7.394 | 1886.5 samples/s | 29.5 steps/s
[Step=15400 Epoch=146.5] | Loss=0.00001 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.547 | L2-Norm(final)=7.395 | 4313.3 samples/s | 67.4 steps/s
[Step=15450 Epoch=147.0] | Loss=0.00001 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.515 | L2-Norm(final)=7.396 | 6166.4 samples/s | 96.3 steps/s
[Step=15500 Epoch=147.4] | Loss=0.00001 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=7.397 | 1673.3 samples/s | 26.1 steps/s
[Step=15550 Epoch=147.9] | Loss=0.00001 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.451 | L2-Norm(final)=7.398 | 5586.7 samples/s | 87.3 steps/s
[Step=15600 Epoch=148.4] | Loss=0.00001 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=7.399 | 1701.5 samples/s | 26.6 steps/s
[Step=15650 Epoch=148.9] | Loss=0.00001 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.387 | L2-Norm(final)=7.400 | 4995.6 samples/s | 78.1 steps/s
[Step=15700 Epoch=149.3] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.355 | L2-Norm(final)=7.401 | 1742.0 samples/s | 27.2 steps/s
[Step=15750 Epoch=149.8] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.323 | L2-Norm(final)=7.401 | 5020.0 samples/s | 78.4 steps/s
[Step=15800 Epoch=150.3] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=7.402 | 1777.4 samples/s | 27.8 steps/s
[Step=15850 Epoch=150.8] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=7.403 | 4768.6 samples/s | 74.5 steps/s
[Step=15900 Epoch=151.2] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.227 | L2-Norm(final)=7.404 | 1944.7 samples/s | 30.4 steps/s
[Step=15950 Epoch=151.7] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.195 | L2-Norm(final)=7.405 | 4408.8 samples/s | 68.9 steps/s
[Step=16000 Epoch=152.2] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=7.406 | 1863.9 samples/s | 29.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step16000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=12001 Epoch=113.1] | Loss=0.00604 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.860 | L2-Norm(final)=6.909 | 3933.7 samples/s | 61.5 steps/s
[Step=12050 Epoch=113.5] | Loss=0.00635 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.019 | L2-Norm(final)=6.922 | 4034.6 samples/s | 63.0 steps/s
[Step=12100 Epoch=114.0] | Loss=0.00471 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.145 | L2-Norm(final)=6.947 | 6770.6 samples/s | 105.8 steps/s
[Step=12150 Epoch=114.5] | Loss=0.00338 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.214 | L2-Norm(final)=6.973 | 1707.0 samples/s | 26.7 steps/s
[Step=12200 Epoch=115.0] | Loss=0.00260 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.246 | L2-Norm(final)=6.996 | 6069.9 samples/s | 94.8 steps/s
[Step=12250 Epoch=115.4] | Loss=0.00214 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.258 | L2-Norm(final)=7.017 | 1822.4 samples/s | 28.5 steps/s
[Step=12300 Epoch=115.9] | Loss=0.00182 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.261 | L2-Norm(final)=7.035 | 5528.6 samples/s | 86.4 steps/s
[Step=12350 Epoch=116.4] | Loss=0.00159 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.257 | L2-Norm(final)=7.051 | 1867.3 samples/s | 29.2 steps/s
[Step=12400 Epoch=116.8] | Loss=0.00141 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.251 | L2-Norm(final)=7.066 | 5262.2 samples/s | 82.2 steps/s
[Step=12450 Epoch=117.3] | Loss=0.00127 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=7.080 | 1897.3 samples/s | 29.6 steps/s
[Step=12500 Epoch=117.8] | Loss=0.00116 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.230 | L2-Norm(final)=7.094 | 5092.4 samples/s | 79.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=12501 Epoch=117.8] | Loss=0.00005 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.115 | L2-Norm(final)=7.224 | 3766.0 samples/s | 58.8 steps/s
[Step=12550 Epoch=118.3] | Loss=0.00247 | Reg=0.00171 | acc=0.9219 | L2-Norm=13.094 | L2-Norm(final)=7.234 | 4190.4 samples/s | 65.5 steps/s
[Step=12600 Epoch=118.7] | Loss=0.01097 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.244 | L2-Norm(final)=7.200 | 5757.3 samples/s | 90.0 steps/s
[Step=12650 Epoch=119.2] | Loss=0.00817 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=7.172 | 1699.0 samples/s | 26.5 steps/s
[Step=12700 Epoch=119.7] | Loss=0.00620 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.419 | L2-Norm(final)=7.162 | 5400.3 samples/s | 84.4 steps/s
[Step=12750 Epoch=120.1] | Loss=0.00508 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.447 | L2-Norm(final)=7.158 | 1763.3 samples/s | 27.6 steps/s
[Step=12800 Epoch=120.6] | Loss=0.00424 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.461 | L2-Norm(final)=7.156 | 4907.8 samples/s | 76.7 steps/s
[Step=12850 Epoch=121.1] | Loss=0.00364 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.465 | L2-Norm(final)=7.155 | 1744.0 samples/s | 27.2 steps/s
[Step=12900 Epoch=121.6] | Loss=0.00319 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.465 | L2-Norm(final)=7.155 | 4461.2 samples/s | 69.7 steps/s
[Step=12950 Epoch=122.0] | Loss=0.00284 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.461 | L2-Norm(final)=7.155 | 1836.0 samples/s | 28.7 steps/s
[Step=13000 Epoch=122.5] | Loss=0.00256 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.454 | L2-Norm(final)=7.155 | 4417.2 samples/s | 69.0 steps/s
[Step=13050 Epoch=123.0] | Loss=0.00233 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.445 | L2-Norm(final)=7.156 | 1912.4 samples/s | 29.9 steps/s
[Step=13100 Epoch=123.4] | Loss=0.00213 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.435 | L2-Norm(final)=7.156 | 4490.6 samples/s | 70.2 steps/s
[Step=13150 Epoch=123.9] | Loss=0.00197 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.424 | L2-Norm(final)=7.157 | 1883.5 samples/s | 29.4 steps/s
[Step=13200 Epoch=124.4] | Loss=0.00183 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.413 | L2-Norm(final)=7.157 | 4332.0 samples/s | 67.7 steps/s
[Step=13250 Epoch=124.9] | Loss=0.00171 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.400 | L2-Norm(final)=7.158 | 1984.6 samples/s | 31.0 steps/s
[Step=13300 Epoch=125.3] | Loss=0.00160 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=7.159 | 3991.3 samples/s | 62.4 steps/s
[Step=13350 Epoch=125.8] | Loss=0.00151 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.374 | L2-Norm(final)=7.160 | 5870.6 samples/s | 91.7 steps/s
[Step=13400 Epoch=126.3] | Loss=0.00143 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=7.160 | 1710.6 samples/s | 26.7 steps/s
[Step=13450 Epoch=126.7] | Loss=0.00135 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=7.161 | 5346.1 samples/s | 83.5 steps/s
[Step=13500 Epoch=127.2] | Loss=0.00129 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.331 | L2-Norm(final)=7.162 | 1726.2 samples/s | 27.0 steps/s
[Step=13550 Epoch=127.7] | Loss=0.00123 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.316 | L2-Norm(final)=7.163 | 4984.2 samples/s | 77.9 steps/s
[Step=13600 Epoch=128.2] | Loss=0.00117 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.301 | L2-Norm(final)=7.164 | 1774.0 samples/s | 27.7 steps/s
[Step=13650 Epoch=128.6] | Loss=0.00112 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.286 | L2-Norm(final)=7.165 | 4630.8 samples/s | 72.4 steps/s
[Step=13700 Epoch=129.1] | Loss=0.00107 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.271 | L2-Norm(final)=7.166 | 1769.3 samples/s | 27.6 steps/s
[Step=13750 Epoch=129.6] | Loss=0.00103 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.255 | L2-Norm(final)=7.167 | 4181.8 samples/s | 65.3 steps/s
[Step=13800 Epoch=130.0] | Loss=0.00099 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.240 | L2-Norm(final)=7.168 | 1822.7 samples/s | 28.5 steps/s
[Step=13850 Epoch=130.5] | Loss=0.00096 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.224 | L2-Norm(final)=7.169 | 4398.3 samples/s | 68.7 steps/s
[Step=13900 Epoch=131.0] | Loss=0.00092 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.208 | L2-Norm(final)=7.170 | 1886.2 samples/s | 29.5 steps/s
[Step=13950 Epoch=131.4] | Loss=0.00089 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.192 | L2-Norm(final)=7.171 | 4328.1 samples/s | 67.6 steps/s
[Step=14000 Epoch=131.9] | Loss=0.00086 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.176 | L2-Norm(final)=7.172 | 1897.0 samples/s | 29.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step14000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10251 | acc=0.9546 | tpr=0.9673 | fpr=0.0728 | 3968.3 samples/s | 15.5 steps/s
Avg test loss: 0.10786, Avg test acc: 0.95272, Avg tpr: 0.96602, Avg fpr: 0.07653, total FA: 597

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10996 | acc=0.9518 | tpr=0.9701 | fpr=0.0880 | 4191.2 samples/s | 16.4 steps/s
Avg test loss: 0.10979, Avg test acc: 0.95292, Avg tpr: 0.97150, Avg fpr: 0.08794, total FA: 686

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11837 | acc=0.9511 | tpr=0.9617 | fpr=0.0719 | 4033.2 samples/s | 15.8 steps/s
Avg test loss: 0.12259, Avg test acc: 0.95024, Avg tpr: 0.96077, Avg fpr: 0.07294, total FA: 569

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.11217 | acc=0.9520 | tpr=0.9671 | fpr=0.0808 | 4070.5 samples/s | 15.9 steps/s
Avg test loss: 0.11704, Avg test acc: 0.95172, Avg tpr: 0.96742, Avg fpr: 0.08281, total FA: 646

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10942 | acc=0.9537 | tpr=0.9623 | fpr=0.0649 | 4061.4 samples/s | 15.9 steps/s
Avg test loss: 0.11253, Avg test acc: 0.95248, Avg tpr: 0.96037, Avg fpr: 0.06486, total FA: 506

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.52270 | acc=0.2786 | tpr=0.0048 | fpr=0.1269 | 3827.3 samples/s | 15.0 steps/s
Avg test loss: 4.54036, Avg test acc: 0.27691, Avg tpr: 0.00635, Avg fpr: 0.12806, total FA: 999

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.43353 | acc=0.3096 | tpr=0.0064 | fpr=0.0320 | 4070.8 samples/s | 15.9 steps/s
Avg test loss: 4.44155, Avg test acc: 0.30836, Avg tpr: 0.00810, Avg fpr: 0.03128, total FA: 244

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.97427 | acc=0.2917 | tpr=0.0059 | fpr=0.0877 | 4049.6 samples/s | 15.8 steps/s
Avg test loss: 4.98202, Avg test acc: 0.29153, Avg tpr: 0.00833, Avg fpr: 0.08563, total FA: 668

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.30822 | acc=0.3016 | tpr=0.0075 | fpr=0.0600 | 4118.0 samples/s | 16.1 steps/s
Avg test loss: 4.31846, Avg test acc: 0.29858, Avg tpr: 0.00723, Avg fpr: 0.06063, total FA: 473

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.03733 | acc=0.3116 | tpr=0.0021 | fpr=0.0161 | 4019.7 samples/s | 15.7 steps/s
Avg test loss: 4.04498, Avg test acc: 0.30844, Avg tpr: 0.00221, Avg fpr: 0.01807, total FA: 141

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.07291 | acc=0.1197 | tpr=0.7699 | fpr=0.8920 | 3947.4 samples/s | 15.4 steps/s
[Step= 100] | Loss=5.04212 | acc=0.1214 | tpr=0.7441 | fpr=0.8903 | 7967.4 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.05036 | acc=0.1209 | tpr=0.7406 | fpr=0.8905 | 8145.8 samples/s | 31.8 steps/s
[Step= 200] | Loss=5.04955 | acc=0.1202 | tpr=0.7454 | fpr=0.8911 | 8112.6 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.04877 | acc=0.1207 | tpr=0.7485 | fpr=0.8907 | 7548.6 samples/s | 29.5 steps/s
[Step= 300] | Loss=5.04514 | acc=0.1208 | tpr=0.7469 | fpr=0.8906 | 7771.6 samples/s | 30.4 steps/s
[Step= 350] | Loss=5.04174 | acc=0.1209 | tpr=0.7401 | fpr=0.8904 | 8199.5 samples/s | 32.0 steps/s
[Step= 400] | Loss=5.04119 | acc=0.1214 | tpr=0.7380 | fpr=0.8898 | 8015.0 samples/s | 31.3 steps/s
[Step= 450] | Loss=5.04313 | acc=0.1213 | tpr=0.7313 | fpr=0.8898 | 7986.9 samples/s | 31.2 steps/s
[Step= 500] | Loss=5.04342 | acc=0.1210 | tpr=0.7269 | fpr=0.8899 | 7992.8 samples/s | 31.2 steps/s
[Step= 550] | Loss=5.04488 | acc=0.1210 | tpr=0.7298 | fpr=0.8901 | 15093.2 samples/s | 59.0 steps/s
Avg test loss: 5.04608, Avg test acc: 0.12087, Avg tpr: 0.73019, Avg fpr: 0.89021, total FA: 123604

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.26424 | acc=0.1088 | tpr=0.7832 | fpr=0.9033 | 4123.3 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.20769 | acc=0.1111 | tpr=0.7655 | fpr=0.9012 | 8108.9 samples/s | 31.7 steps/s
[Step= 150] | Loss=5.21440 | acc=0.1103 | tpr=0.7594 | fpr=0.9017 | 7790.9 samples/s | 30.4 steps/s
[Step= 200] | Loss=5.21089 | acc=0.1090 | tpr=0.7410 | fpr=0.9025 | 8108.8 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.20903 | acc=0.1097 | tpr=0.7450 | fpr=0.9018 | 8173.8 samples/s | 31.9 steps/s
[Step= 300] | Loss=5.21090 | acc=0.1094 | tpr=0.7505 | fpr=0.9023 | 7814.5 samples/s | 30.5 steps/s
[Step= 350] | Loss=5.20775 | acc=0.1093 | tpr=0.7383 | fpr=0.9021 | 7689.7 samples/s | 30.0 steps/s
[Step= 400] | Loss=5.20864 | acc=0.1094 | tpr=0.7363 | fpr=0.9020 | 8023.0 samples/s | 31.3 steps/s
[Step= 450] | Loss=5.21157 | acc=0.1092 | tpr=0.7317 | fpr=0.9021 | 8169.9 samples/s | 31.9 steps/s
[Step= 500] | Loss=5.21589 | acc=0.1090 | tpr=0.7295 | fpr=0.9022 | 7931.2 samples/s | 31.0 steps/s
[Step= 550] | Loss=5.21633 | acc=0.1089 | tpr=0.7318 | fpr=0.9024 | 14516.8 samples/s | 56.7 steps/s
Avg test loss: 5.21801, Avg test acc: 0.10881, Avg tpr: 0.73177, Avg fpr: 0.90251, total FA: 125312

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.91914 | acc=0.1199 | tpr=0.7566 | fpr=0.8915 | 4009.0 samples/s | 15.7 steps/s
[Step= 100] | Loss=5.86133 | acc=0.1212 | tpr=0.7100 | fpr=0.8898 | 7908.3 samples/s | 30.9 steps/s
[Step= 150] | Loss=5.87301 | acc=0.1189 | tpr=0.7233 | fpr=0.8922 | 8073.1 samples/s | 31.5 steps/s
[Step= 200] | Loss=5.86978 | acc=0.1182 | tpr=0.7213 | fpr=0.8927 | 7946.6 samples/s | 31.0 steps/s
[Step= 250] | Loss=5.86819 | acc=0.1185 | tpr=0.7197 | fpr=0.8925 | 8104.4 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.86543 | acc=0.1187 | tpr=0.7251 | fpr=0.8923 | 8063.7 samples/s | 31.5 steps/s
[Step= 350] | Loss=5.86175 | acc=0.1183 | tpr=0.7176 | fpr=0.8925 | 7879.9 samples/s | 30.8 steps/s
[Step= 400] | Loss=5.86256 | acc=0.1190 | tpr=0.7188 | fpr=0.8919 | 7673.5 samples/s | 30.0 steps/s
[Step= 450] | Loss=5.86393 | acc=0.1188 | tpr=0.7162 | fpr=0.8921 | 7816.8 samples/s | 30.5 steps/s
[Step= 500] | Loss=5.86209 | acc=0.1190 | tpr=0.7159 | fpr=0.8918 | 8192.3 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.86252 | acc=0.1190 | tpr=0.7195 | fpr=0.8919 | 14332.3 samples/s | 56.0 steps/s
Avg test loss: 5.86403, Avg test acc: 0.11889, Avg tpr: 0.71870, Avg fpr: 0.89201, total FA: 123854

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.47617 | acc=0.1345 | tpr=0.6327 | fpr=0.8744 | 4181.8 samples/s | 16.3 steps/s
[Step= 100] | Loss=5.43066 | acc=0.1341 | tpr=0.5757 | fpr=0.8742 | 7520.0 samples/s | 29.4 steps/s
[Step= 150] | Loss=5.43258 | acc=0.1326 | tpr=0.5793 | fpr=0.8756 | 7933.2 samples/s | 31.0 steps/s
[Step= 200] | Loss=5.42705 | acc=0.1326 | tpr=0.5716 | fpr=0.8754 | 7808.7 samples/s | 30.5 steps/s
[Step= 250] | Loss=5.42868 | acc=0.1325 | tpr=0.5729 | fpr=0.8755 | 8120.5 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.42697 | acc=0.1325 | tpr=0.5789 | fpr=0.8756 | 7915.4 samples/s | 30.9 steps/s
[Step= 350] | Loss=5.42079 | acc=0.1322 | tpr=0.5717 | fpr=0.8757 | 8286.1 samples/s | 32.4 steps/s
[Step= 400] | Loss=5.42387 | acc=0.1319 | tpr=0.5656 | fpr=0.8759 | 7719.3 samples/s | 30.2 steps/s
[Step= 450] | Loss=5.42568 | acc=0.1317 | tpr=0.5672 | fpr=0.8762 | 8116.9 samples/s | 31.7 steps/s
[Step= 500] | Loss=5.42605 | acc=0.1316 | tpr=0.5674 | fpr=0.8763 | 8043.8 samples/s | 31.4 steps/s
[Step= 550] | Loss=5.42797 | acc=0.1311 | tpr=0.5682 | fpr=0.8768 | 14334.5 samples/s | 56.0 steps/s
Avg test loss: 5.42961, Avg test acc: 0.13106, Avg tpr: 0.56854, Avg fpr: 0.87689, total FA: 121755

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.27535 | acc=0.1324 | tpr=0.6681 | fpr=0.8772 | 4220.6 samples/s | 16.5 steps/s
[Step= 100] | Loss=5.24378 | acc=0.1346 | tpr=0.6055 | fpr=0.8741 | 7947.7 samples/s | 31.0 steps/s
[Step= 150] | Loss=5.24542 | acc=0.1330 | tpr=0.5951 | fpr=0.8755 | 7472.4 samples/s | 29.2 steps/s
[Step= 200] | Loss=5.24380 | acc=0.1336 | tpr=0.5956 | fpr=0.8748 | 8118.9 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.24280 | acc=0.1337 | tpr=0.5921 | fpr=0.8747 | 7575.5 samples/s | 29.6 steps/s
[Step= 300] | Loss=5.23710 | acc=0.1335 | tpr=0.5985 | fpr=0.8750 | 8052.7 samples/s | 31.5 steps/s
[Step= 350] | Loss=5.23281 | acc=0.1332 | tpr=0.5892 | fpr=0.8751 | 7838.4 samples/s | 30.6 steps/s
[Step= 400] | Loss=5.23475 | acc=0.1335 | tpr=0.5832 | fpr=0.8746 | 8102.8 samples/s | 31.7 steps/s
[Step= 450] | Loss=5.23702 | acc=0.1333 | tpr=0.5730 | fpr=0.8746 | 8015.9 samples/s | 31.3 steps/s
[Step= 500] | Loss=5.23872 | acc=0.1331 | tpr=0.5665 | fpr=0.8747 | 6853.8 samples/s | 26.8 steps/s
[Step= 550] | Loss=5.24078 | acc=0.1327 | tpr=0.5651 | fpr=0.8752 | 13893.3 samples/s | 54.3 steps/s
Avg test loss: 5.24223, Avg test acc: 0.13259, Avg tpr: 0.56537, Avg fpr: 0.87527, total FA: 121530

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10100 | acc=0.9802 | tpr=0.9248 | fpr=0.0188 | 4106.9 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.10354 | acc=0.9796 | tpr=0.9403 | fpr=0.0196 | 7741.9 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.10749 | acc=0.9787 | tpr=0.9424 | fpr=0.0207 | 7840.6 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.10975 | acc=0.9785 | tpr=0.9443 | fpr=0.0208 | 8144.9 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.10887 | acc=0.9786 | tpr=0.9389 | fpr=0.0207 | 8476.7 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.11042 | acc=0.9783 | tpr=0.9382 | fpr=0.0210 | 7979.4 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.11033 | acc=0.9782 | tpr=0.9374 | fpr=0.0210 | 8015.7 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.11176 | acc=0.9781 | tpr=0.9327 | fpr=0.0210 | 7962.2 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.11444 | acc=0.9779 | tpr=0.9323 | fpr=0.0213 | 7759.0 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.11396 | acc=0.9779 | tpr=0.9344 | fpr=0.0213 | 7393.6 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.11290 | acc=0.9781 | tpr=0.9335 | fpr=0.0211 | 14258.2 samples/s | 55.7 steps/s
Avg test loss: 0.11278, Avg test acc: 0.97814, Avg tpr: 0.93304, Avg fpr: 0.02104, total FA: 2922

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10801 | acc=0.9821 | tpr=0.8850 | fpr=0.0161 | 4075.0 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.11220 | acc=0.9816 | tpr=0.8998 | fpr=0.0169 | 8141.4 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.11568 | acc=0.9807 | tpr=0.9006 | fpr=0.0178 | 8009.8 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.11818 | acc=0.9805 | tpr=0.9027 | fpr=0.0180 | 8017.3 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.11691 | acc=0.9806 | tpr=0.9066 | fpr=0.0181 | 8298.2 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.11892 | acc=0.9803 | tpr=0.9076 | fpr=0.0184 | 8252.2 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.11848 | acc=0.9802 | tpr=0.9117 | fpr=0.0185 | 7629.2 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.12002 | acc=0.9800 | tpr=0.9065 | fpr=0.0187 | 8774.7 samples/s | 34.3 steps/s
[Step= 450] | Loss=0.12282 | acc=0.9797 | tpr=0.9046 | fpr=0.0189 | 7570.4 samples/s | 29.6 steps/s
[Step= 500] | Loss=0.12226 | acc=0.9797 | tpr=0.9070 | fpr=0.0190 | 7825.7 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.12140 | acc=0.9799 | tpr=0.9065 | fpr=0.0188 | 14406.6 samples/s | 56.3 steps/s
Avg test loss: 0.12124, Avg test acc: 0.97988, Avg tpr: 0.90610, Avg fpr: 0.01878, total FA: 2607

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10857 | acc=0.9805 | tpr=0.9336 | fpr=0.0187 | 4126.9 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.11238 | acc=0.9802 | tpr=0.9488 | fpr=0.0192 | 8166.7 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.11672 | acc=0.9791 | tpr=0.9452 | fpr=0.0202 | 7568.4 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.11976 | acc=0.9790 | tpr=0.9486 | fpr=0.0204 | 7840.4 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.11854 | acc=0.9790 | tpr=0.9476 | fpr=0.0205 | 7833.0 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.12052 | acc=0.9786 | tpr=0.9469 | fpr=0.0209 | 7836.6 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.12027 | acc=0.9784 | tpr=0.9461 | fpr=0.0210 | 8030.2 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.12163 | acc=0.9783 | tpr=0.9420 | fpr=0.0210 | 7721.6 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.12437 | acc=0.9780 | tpr=0.9411 | fpr=0.0213 | 7940.5 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.12384 | acc=0.9780 | tpr=0.9432 | fpr=0.0213 | 7259.6 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.12264 | acc=0.9782 | tpr=0.9431 | fpr=0.0211 | 14539.1 samples/s | 56.8 steps/s
Avg test loss: 0.12251, Avg test acc: 0.97825, Avg tpr: 0.94295, Avg fpr: 0.02111, total FA: 2931

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11903 | acc=0.9814 | tpr=0.8850 | fpr=0.0169 | 4062.3 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.12482 | acc=0.9805 | tpr=0.9062 | fpr=0.0181 | 8181.4 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.12873 | acc=0.9795 | tpr=0.9063 | fpr=0.0191 | 7764.8 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.13019 | acc=0.9791 | tpr=0.9060 | fpr=0.0195 | 7742.4 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.12824 | acc=0.9791 | tpr=0.9022 | fpr=0.0195 | 7654.8 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.13001 | acc=0.9790 | tpr=0.8996 | fpr=0.0196 | 7634.3 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.13041 | acc=0.9789 | tpr=0.9048 | fpr=0.0198 | 8059.5 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.13180 | acc=0.9787 | tpr=0.8982 | fpr=0.0198 | 8363.6 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.13449 | acc=0.9784 | tpr=0.8958 | fpr=0.0201 | 7211.0 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.13443 | acc=0.9784 | tpr=0.8978 | fpr=0.0201 | 7775.6 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.13328 | acc=0.9786 | tpr=0.8961 | fpr=0.0200 | 14962.4 samples/s | 58.4 steps/s
Avg test loss: 0.13310, Avg test acc: 0.97856, Avg tpr: 0.89540, Avg fpr: 0.01993, total FA: 2767

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12300 | acc=0.9796 | tpr=0.8850 | fpr=0.0187 | 4056.9 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.12665 | acc=0.9794 | tpr=0.9041 | fpr=0.0192 | 8201.8 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.13068 | acc=0.9786 | tpr=0.9164 | fpr=0.0203 | 8244.9 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.13410 | acc=0.9783 | tpr=0.9202 | fpr=0.0206 | 7844.5 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.13268 | acc=0.9784 | tpr=0.9179 | fpr=0.0205 | 7997.2 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.13639 | acc=0.9779 | tpr=0.9156 | fpr=0.0210 | 8234.3 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.13694 | acc=0.9778 | tpr=0.9173 | fpr=0.0211 | 8517.5 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.13856 | acc=0.9776 | tpr=0.9114 | fpr=0.0212 | 8359.2 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.14133 | acc=0.9773 | tpr=0.9104 | fpr=0.0215 | 7717.6 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.14099 | acc=0.9772 | tpr=0.9093 | fpr=0.0215 | 7912.3 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.13984 | acc=0.9774 | tpr=0.9081 | fpr=0.0214 | 14933.7 samples/s | 58.3 steps/s
Avg test loss: 0.13961, Avg test acc: 0.97737, Avg tpr: 0.90769, Avg fpr: 0.02136, total FA: 2966

server round 17/50

clients selected: [2 3 4 6 7]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=24001 Epoch=116.9] | Loss=0.01790 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.591 | L2-Norm(final)=10.880 | 3737.2 samples/s | 58.4 steps/s
[Step=24050 Epoch=117.2] | Loss=0.03244 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.641 | L2-Norm(final)=10.857 | 4809.2 samples/s | 75.1 steps/s
[Step=24100 Epoch=117.4] | Loss=0.03154 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.709 | L2-Norm(final)=10.854 | 5231.1 samples/s | 81.7 steps/s
[Step=24150 Epoch=117.7] | Loss=0.02916 | Reg=0.00163 | acc=0.9688 | L2-Norm=12.771 | L2-Norm(final)=10.864 | 5094.2 samples/s | 79.6 steps/s
[Step=24200 Epoch=117.9] | Loss=0.02807 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.825 | L2-Norm(final)=10.880 | 7274.9 samples/s | 113.7 steps/s
[Step=24250 Epoch=118.2] | Loss=0.02660 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.877 | L2-Norm(final)=10.896 | 1790.5 samples/s | 28.0 steps/s
[Step=24300 Epoch=118.4] | Loss=0.02493 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.926 | L2-Norm(final)=10.917 | 5132.2 samples/s | 80.2 steps/s
[Step=24350 Epoch=118.6] | Loss=0.02384 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.972 | L2-Norm(final)=10.939 | 5062.7 samples/s | 79.1 steps/s
[Step=24400 Epoch=118.9] | Loss=0.02311 | Reg=0.00169 | acc=0.9688 | L2-Norm=13.014 | L2-Norm(final)=10.961 | 6391.5 samples/s | 99.9 steps/s
[Step=24450 Epoch=119.1] | Loss=0.02214 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.056 | L2-Norm(final)=10.985 | 1843.8 samples/s | 28.8 steps/s
[Step=24500 Epoch=119.4] | Loss=0.02146 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.098 | L2-Norm(final)=11.009 | 5022.9 samples/s | 78.5 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=119.4] | Loss=0.01546 | Reg=0.00183 | acc=0.9688 | L2-Norm=13.510 | L2-Norm(final)=11.261 | 3537.0 samples/s | 55.3 steps/s
[Step=24550 Epoch=119.6] | Loss=0.02525 | Reg=0.00183 | acc=0.9219 | L2-Norm=13.545 | L2-Norm(final)=11.275 | 4631.8 samples/s | 72.4 steps/s
[Step=24600 Epoch=119.9] | Loss=0.03162 | Reg=0.00185 | acc=0.9688 | L2-Norm=13.600 | L2-Norm(final)=11.265 | 4600.9 samples/s | 71.9 steps/s
[Step=24650 Epoch=120.1] | Loss=0.03447 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.651 | L2-Norm(final)=11.254 | 4523.7 samples/s | 70.7 steps/s
[Step=24700 Epoch=120.4] | Loss=0.03498 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.696 | L2-Norm(final)=11.244 | 6106.2 samples/s | 95.4 steps/s
[Step=24750 Epoch=120.6] | Loss=0.03404 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.739 | L2-Norm(final)=11.238 | 1767.8 samples/s | 27.6 steps/s
[Step=24800 Epoch=120.8] | Loss=0.03182 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.776 | L2-Norm(final)=11.232 | 4646.4 samples/s | 72.6 steps/s
[Step=24850 Epoch=121.1] | Loss=0.03011 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.809 | L2-Norm(final)=11.229 | 4615.6 samples/s | 72.1 steps/s
[Step=24900 Epoch=121.3] | Loss=0.02848 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.839 | L2-Norm(final)=11.228 | 5624.6 samples/s | 87.9 steps/s
[Step=24950 Epoch=121.6] | Loss=0.02675 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.865 | L2-Norm(final)=11.229 | 1795.4 samples/s | 28.1 steps/s
[Step=25000 Epoch=121.8] | Loss=0.02548 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.888 | L2-Norm(final)=11.230 | 4594.3 samples/s | 71.8 steps/s
[Step=25050 Epoch=122.1] | Loss=0.02415 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.909 | L2-Norm(final)=11.231 | 4624.3 samples/s | 72.3 steps/s
[Step=25100 Epoch=122.3] | Loss=0.02326 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.927 | L2-Norm(final)=11.232 | 5365.6 samples/s | 83.8 steps/s
[Step=25150 Epoch=122.5] | Loss=0.02195 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.944 | L2-Norm(final)=11.234 | 1821.3 samples/s | 28.5 steps/s
[Step=25200 Epoch=122.8] | Loss=0.02085 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.959 | L2-Norm(final)=11.237 | 4589.8 samples/s | 71.7 steps/s
[Step=25250 Epoch=123.0] | Loss=0.02007 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.972 | L2-Norm(final)=11.239 | 4635.9 samples/s | 72.4 steps/s
[Step=25300 Epoch=123.3] | Loss=0.01939 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.983 | L2-Norm(final)=11.241 | 4963.8 samples/s | 77.6 steps/s
[Step=25350 Epoch=123.5] | Loss=0.01879 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.994 | L2-Norm(final)=11.243 | 1836.8 samples/s | 28.7 steps/s
[Step=25400 Epoch=123.8] | Loss=0.01810 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.004 | L2-Norm(final)=11.245 | 4659.3 samples/s | 72.8 steps/s
[Step=25450 Epoch=124.0] | Loss=0.01768 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.013 | L2-Norm(final)=11.247 | 4562.7 samples/s | 71.3 steps/s
[Step=25500 Epoch=124.2] | Loss=0.01719 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.021 | L2-Norm(final)=11.249 | 4851.0 samples/s | 75.8 steps/s
[Step=25550 Epoch=124.5] | Loss=0.01682 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.029 | L2-Norm(final)=11.251 | 1931.2 samples/s | 30.2 steps/s
[Step=25600 Epoch=124.7] | Loss=0.01631 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.038 | L2-Norm(final)=11.252 | 4440.5 samples/s | 69.4 steps/s
[Step=25650 Epoch=125.0] | Loss=0.01590 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.045 | L2-Norm(final)=11.254 | 4592.6 samples/s | 71.8 steps/s
[Step=25700 Epoch=125.2] | Loss=0.01556 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.052 | L2-Norm(final)=11.256 | 4627.5 samples/s | 72.3 steps/s
[Step=25750 Epoch=125.5] | Loss=0.01515 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.059 | L2-Norm(final)=11.258 | 1938.6 samples/s | 30.3 steps/s
[Step=25800 Epoch=125.7] | Loss=0.01470 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.065 | L2-Norm(final)=11.261 | 4693.0 samples/s | 73.3 steps/s
[Step=25850 Epoch=126.0] | Loss=0.01439 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.071 | L2-Norm(final)=11.263 | 4534.6 samples/s | 70.9 steps/s
[Step=25900 Epoch=126.2] | Loss=0.01407 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.077 | L2-Norm(final)=11.265 | 4639.0 samples/s | 72.5 steps/s
[Step=25950 Epoch=126.4] | Loss=0.01380 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.082 | L2-Norm(final)=11.267 | 1955.4 samples/s | 30.6 steps/s
[Step=26000 Epoch=126.7] | Loss=0.01346 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.087 | L2-Norm(final)=11.270 | 4645.5 samples/s | 72.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step26000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=10001 Epoch=48.8] | Loss=0.06786 | Reg=0.00159 | acc=0.9375 | L2-Norm=12.591 | L2-Norm(final)=7.039 | 3714.2 samples/s | 58.0 steps/s
[Step=10050 Epoch=49.0] | Loss=0.03995 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.661 | L2-Norm(final)=7.039 | 4850.1 samples/s | 75.8 steps/s
[Step=10100 Epoch=49.3] | Loss=0.03680 | Reg=0.00162 | acc=0.9531 | L2-Norm=12.741 | L2-Norm(final)=7.052 | 5084.9 samples/s | 79.5 steps/s
[Step=10150 Epoch=49.5] | Loss=0.03539 | Reg=0.00164 | acc=0.9688 | L2-Norm=12.808 | L2-Norm(final)=7.068 | 4985.3 samples/s | 77.9 steps/s
[Step=10200 Epoch=49.7] | Loss=0.03349 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.868 | L2-Norm(final)=7.084 | 7016.9 samples/s | 109.6 steps/s
[Step=10250 Epoch=50.0] | Loss=0.03195 | Reg=0.00167 | acc=0.9688 | L2-Norm=12.926 | L2-Norm(final)=7.105 | 1808.8 samples/s | 28.3 steps/s
[Step=10300 Epoch=50.2] | Loss=0.03009 | Reg=0.00169 | acc=0.9688 | L2-Norm=12.982 | L2-Norm(final)=7.129 | 5127.8 samples/s | 80.1 steps/s
[Step=10350 Epoch=50.5] | Loss=0.02938 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.035 | L2-Norm(final)=7.153 | 5139.3 samples/s | 80.3 steps/s
[Step=10400 Epoch=50.7] | Loss=0.02820 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.088 | L2-Norm(final)=7.178 | 6643.6 samples/s | 103.8 steps/s
[Step=10450 Epoch=51.0] | Loss=0.02735 | Reg=0.00173 | acc=0.9688 | L2-Norm=13.141 | L2-Norm(final)=7.205 | 1833.5 samples/s | 28.6 steps/s
[Step=10500 Epoch=51.2] | Loss=0.02667 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.194 | L2-Norm(final)=7.234 | 5186.4 samples/s | 81.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=10501 Epoch=51.2] | Loss=0.00650 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.726 | L2-Norm(final)=7.533 | 3612.6 samples/s | 56.4 steps/s
[Step=10550 Epoch=51.4] | Loss=0.02673 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.783 | L2-Norm(final)=7.556 | 4588.3 samples/s | 71.7 steps/s
[Step=10600 Epoch=51.7] | Loss=0.03267 | Reg=0.00191 | acc=0.9375 | L2-Norm=13.838 | L2-Norm(final)=7.558 | 4556.4 samples/s | 71.2 steps/s
[Step=10650 Epoch=51.9] | Loss=0.03518 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.885 | L2-Norm(final)=7.550 | 4589.9 samples/s | 71.7 steps/s
[Step=10700 Epoch=52.2] | Loss=0.03488 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.930 | L2-Norm(final)=7.547 | 6085.7 samples/s | 95.1 steps/s
[Step=10750 Epoch=52.4] | Loss=0.03166 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.969 | L2-Norm(final)=7.548 | 1771.8 samples/s | 27.7 steps/s
[Step=10800 Epoch=52.7] | Loss=0.02908 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.003 | L2-Norm(final)=7.552 | 4552.1 samples/s | 71.1 steps/s
[Step=10850 Epoch=52.9] | Loss=0.02690 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.032 | L2-Norm(final)=7.557 | 4656.9 samples/s | 72.8 steps/s
[Step=10900 Epoch=53.2] | Loss=0.02557 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.059 | L2-Norm(final)=7.563 | 5631.5 samples/s | 88.0 steps/s
[Step=10950 Epoch=53.4] | Loss=0.02440 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.082 | L2-Norm(final)=7.568 | 1783.6 samples/s | 27.9 steps/s
[Step=11000 Epoch=53.6] | Loss=0.02302 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.104 | L2-Norm(final)=7.572 | 4685.0 samples/s | 73.2 steps/s
[Step=11050 Epoch=53.9] | Loss=0.02197 | Reg=0.00199 | acc=0.9688 | L2-Norm=14.123 | L2-Norm(final)=7.577 | 4567.8 samples/s | 71.4 steps/s
[Step=11100 Epoch=54.1] | Loss=0.02089 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.140 | L2-Norm(final)=7.581 | 5471.0 samples/s | 85.5 steps/s
[Step=11150 Epoch=54.4] | Loss=0.01984 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.156 | L2-Norm(final)=7.585 | 1827.7 samples/s | 28.6 steps/s
[Step=11200 Epoch=54.6] | Loss=0.01876 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.169 | L2-Norm(final)=7.590 | 4489.5 samples/s | 70.1 steps/s
[Step=11250 Epoch=54.9] | Loss=0.01809 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.181 | L2-Norm(final)=7.594 | 4538.1 samples/s | 70.9 steps/s
[Step=11300 Epoch=55.1] | Loss=0.01767 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.191 | L2-Norm(final)=7.598 | 5026.5 samples/s | 78.5 steps/s
[Step=11350 Epoch=55.3] | Loss=0.01779 | Reg=0.00202 | acc=0.9688 | L2-Norm=14.201 | L2-Norm(final)=7.600 | 1850.1 samples/s | 28.9 steps/s
[Step=11400 Epoch=55.6] | Loss=0.01774 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.215 | L2-Norm(final)=7.602 | 4620.1 samples/s | 72.2 steps/s
[Step=11450 Epoch=55.8] | Loss=0.01748 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.230 | L2-Norm(final)=7.604 | 4700.8 samples/s | 73.5 steps/s
[Step=11500 Epoch=56.1] | Loss=0.01720 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.245 | L2-Norm(final)=7.607 | 4686.6 samples/s | 73.2 steps/s
[Step=11550 Epoch=56.3] | Loss=0.01672 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.259 | L2-Norm(final)=7.610 | 1913.9 samples/s | 29.9 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01621 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.274 | L2-Norm(final)=7.613 | 4737.0 samples/s | 74.0 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01582 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.287 | L2-Norm(final)=7.617 | 4628.3 samples/s | 72.3 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01549 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.300 | L2-Norm(final)=7.620 | 4635.6 samples/s | 72.4 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01521 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.311 | L2-Norm(final)=7.623 | 1911.3 samples/s | 29.9 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01479 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.323 | L2-Norm(final)=7.626 | 4693.0 samples/s | 73.3 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01447 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.333 | L2-Norm(final)=7.629 | 4653.4 samples/s | 72.7 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01414 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.342 | L2-Norm(final)=7.632 | 4566.4 samples/s | 71.4 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01380 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.351 | L2-Norm(final)=7.635 | 1958.1 samples/s | 30.6 steps/s
[Step=12000 Epoch=58.5] | Loss=0.01343 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.359 | L2-Norm(final)=7.638 | 4710.3 samples/s | 73.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step12000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=24001 Epoch=117.7] | Loss=0.06086 | Reg=0.00159 | acc=0.9531 | L2-Norm=12.591 | L2-Norm(final)=10.015 | 3658.0 samples/s | 57.2 steps/s
[Step=24050 Epoch=117.9] | Loss=0.03745 | Reg=0.00160 | acc=0.9688 | L2-Norm=12.652 | L2-Norm(final)=9.984 | 4960.2 samples/s | 77.5 steps/s
[Step=24100 Epoch=118.2] | Loss=0.03181 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.720 | L2-Norm(final)=9.978 | 5170.2 samples/s | 80.8 steps/s
[Step=24150 Epoch=118.4] | Loss=0.02878 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.776 | L2-Norm(final)=9.988 | 5187.2 samples/s | 81.1 steps/s
[Step=24200 Epoch=118.7] | Loss=0.02734 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.829 | L2-Norm(final)=10.000 | 7593.5 samples/s | 118.6 steps/s
[Step=24250 Epoch=118.9] | Loss=0.02508 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.882 | L2-Norm(final)=10.015 | 1795.4 samples/s | 28.1 steps/s
[Step=24300 Epoch=119.2] | Loss=0.02380 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.930 | L2-Norm(final)=10.033 | 5007.2 samples/s | 78.2 steps/s
[Step=24350 Epoch=119.4] | Loss=0.02269 | Reg=0.00168 | acc=0.9531 | L2-Norm=12.976 | L2-Norm(final)=10.054 | 5218.5 samples/s | 81.5 steps/s
[Step=24400 Epoch=119.7] | Loss=0.02221 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.021 | L2-Norm(final)=10.075 | 6792.2 samples/s | 106.1 steps/s
[Step=24450 Epoch=119.9] | Loss=0.02142 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.065 | L2-Norm(final)=10.097 | 1832.3 samples/s | 28.6 steps/s
[Step=24500 Epoch=120.1] | Loss=0.02047 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.108 | L2-Norm(final)=10.121 | 5447.1 samples/s | 85.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=120.1] | Loss=0.01051 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.536 | L2-Norm(final)=10.369 | 3595.4 samples/s | 56.2 steps/s
[Step=24550 Epoch=120.4] | Loss=0.02237 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.589 | L2-Norm(final)=10.386 | 4606.1 samples/s | 72.0 steps/s
[Step=24600 Epoch=120.6] | Loss=0.03432 | Reg=0.00186 | acc=0.9688 | L2-Norm=13.639 | L2-Norm(final)=10.378 | 4537.6 samples/s | 70.9 steps/s
[Step=24650 Epoch=120.9] | Loss=0.03412 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.692 | L2-Norm(final)=10.368 | 4672.7 samples/s | 73.0 steps/s
[Step=24700 Epoch=121.1] | Loss=0.03582 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.742 | L2-Norm(final)=10.361 | 6248.4 samples/s | 97.6 steps/s
[Step=24750 Epoch=121.4] | Loss=0.03238 | Reg=0.00190 | acc=0.9688 | L2-Norm=13.787 | L2-Norm(final)=10.356 | 1718.7 samples/s | 26.9 steps/s
[Step=24800 Epoch=121.6] | Loss=0.02996 | Reg=0.00191 | acc=0.9688 | L2-Norm=13.823 | L2-Norm(final)=10.355 | 4406.8 samples/s | 68.9 steps/s
[Step=24850 Epoch=121.9] | Loss=0.02868 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.854 | L2-Norm(final)=10.354 | 4655.7 samples/s | 72.7 steps/s
[Step=24900 Epoch=122.1] | Loss=0.02681 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.881 | L2-Norm(final)=10.354 | 5961.7 samples/s | 93.2 steps/s
[Step=24950 Epoch=122.4] | Loss=0.02490 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.904 | L2-Norm(final)=10.355 | 1791.3 samples/s | 28.0 steps/s
[Step=25000 Epoch=122.6] | Loss=0.02354 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.924 | L2-Norm(final)=10.357 | 4750.8 samples/s | 74.2 steps/s
[Step=25050 Epoch=122.8] | Loss=0.02268 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.941 | L2-Norm(final)=10.359 | 4491.6 samples/s | 70.2 steps/s
[Step=25100 Epoch=123.1] | Loss=0.02170 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.956 | L2-Norm(final)=10.359 | 5609.6 samples/s | 87.7 steps/s
[Step=25150 Epoch=123.3] | Loss=0.02046 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.971 | L2-Norm(final)=10.361 | 1800.5 samples/s | 28.1 steps/s
[Step=25200 Epoch=123.6] | Loss=0.01954 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.983 | L2-Norm(final)=10.364 | 4571.8 samples/s | 71.4 steps/s
[Step=25250 Epoch=123.8] | Loss=0.01872 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.995 | L2-Norm(final)=10.366 | 4590.1 samples/s | 71.7 steps/s
[Step=25300 Epoch=124.1] | Loss=0.01786 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.005 | L2-Norm(final)=10.369 | 5329.5 samples/s | 83.3 steps/s
[Step=25350 Epoch=124.3] | Loss=0.01704 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.015 | L2-Norm(final)=10.371 | 1828.5 samples/s | 28.6 steps/s
[Step=25400 Epoch=124.6] | Loss=0.01638 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.023 | L2-Norm(final)=10.374 | 4649.2 samples/s | 72.6 steps/s
[Step=25450 Epoch=124.8] | Loss=0.01580 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.030 | L2-Norm(final)=10.377 | 4637.7 samples/s | 72.5 steps/s
[Step=25500 Epoch=125.0] | Loss=0.01537 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.037 | L2-Norm(final)=10.379 | 5234.1 samples/s | 81.8 steps/s
[Step=25550 Epoch=125.3] | Loss=0.01491 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.043 | L2-Norm(final)=10.382 | 1835.9 samples/s | 28.7 steps/s
[Step=25600 Epoch=125.5] | Loss=0.01455 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.049 | L2-Norm(final)=10.384 | 4718.0 samples/s | 73.7 steps/s
[Step=25650 Epoch=125.8] | Loss=0.01416 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.054 | L2-Norm(final)=10.386 | 4658.7 samples/s | 72.8 steps/s
[Step=25700 Epoch=126.0] | Loss=0.01375 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.059 | L2-Norm(final)=10.388 | 4991.6 samples/s | 78.0 steps/s
[Step=25750 Epoch=126.3] | Loss=0.01336 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.063 | L2-Norm(final)=10.390 | 1832.6 samples/s | 28.6 steps/s
[Step=25800 Epoch=126.5] | Loss=0.01304 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.067 | L2-Norm(final)=10.393 | 4658.0 samples/s | 72.8 steps/s
[Step=25850 Epoch=126.8] | Loss=0.01276 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.070 | L2-Norm(final)=10.394 | 4485.7 samples/s | 70.1 steps/s
[Step=25900 Epoch=127.0] | Loss=0.01254 | Reg=0.00198 | acc=0.9688 | L2-Norm=14.073 | L2-Norm(final)=10.396 | 4653.8 samples/s | 72.7 steps/s
[Step=25950 Epoch=127.3] | Loss=0.01228 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.076 | L2-Norm(final)=10.398 | 1866.2 samples/s | 29.2 steps/s
[Step=26000 Epoch=127.5] | Loss=0.01205 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.079 | L2-Norm(final)=10.399 | 4738.7 samples/s | 74.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step26000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=16001 Epoch=152.2] | Loss=0.06764 | Reg=0.00159 | acc=0.9531 | L2-Norm=12.591 | L2-Norm(final)=7.432 | 3595.3 samples/s | 56.2 steps/s
[Step=16050 Epoch=152.7] | Loss=0.00896 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.861 | L2-Norm(final)=7.409 | 4538.2 samples/s | 70.9 steps/s
[Step=16100 Epoch=153.2] | Loss=0.00542 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.978 | L2-Norm(final)=7.421 | 7324.8 samples/s | 114.5 steps/s
[Step=16150 Epoch=153.6] | Loss=0.00384 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.027 | L2-Norm(final)=7.442 | 1719.4 samples/s | 26.9 steps/s
[Step=16200 Epoch=154.1] | Loss=0.00303 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.054 | L2-Norm(final)=7.464 | 6422.0 samples/s | 100.3 steps/s
[Step=16250 Epoch=154.6] | Loss=0.00247 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.070 | L2-Norm(final)=7.483 | 1771.5 samples/s | 27.7 steps/s
[Step=16300 Epoch=155.1] | Loss=0.00208 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.074 | L2-Norm(final)=7.500 | 5267.6 samples/s | 82.3 steps/s
[Step=16350 Epoch=155.5] | Loss=0.00180 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.072 | L2-Norm(final)=7.515 | 1855.1 samples/s | 29.0 steps/s
[Step=16400 Epoch=156.0] | Loss=0.00159 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.066 | L2-Norm(final)=7.528 | 5504.6 samples/s | 86.0 steps/s
[Step=16450 Epoch=156.5] | Loss=0.00143 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.058 | L2-Norm(final)=7.541 | 1234.4 samples/s | 19.3 steps/s
[Step=16500 Epoch=157.0] | Loss=0.00129 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.047 | L2-Norm(final)=7.552 | 4778.8 samples/s | 74.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=157.0] | Loss=0.00004 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.934 | L2-Norm(final)=7.665 | 3613.7 samples/s | 56.5 steps/s
[Step=16550 Epoch=157.4] | Loss=0.00006 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.906 | L2-Norm(final)=7.672 | 4137.9 samples/s | 64.7 steps/s
[Step=16600 Epoch=157.9] | Loss=0.00188 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.883 | L2-Norm(final)=7.677 | 5923.4 samples/s | 92.6 steps/s
[Step=16650 Epoch=158.4] | Loss=0.00599 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.995 | L2-Norm(final)=7.656 | 1716.5 samples/s | 26.8 steps/s
[Step=16700 Epoch=158.9] | Loss=0.00609 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.108 | L2-Norm(final)=7.626 | 5778.0 samples/s | 90.3 steps/s
[Step=16750 Epoch=159.3] | Loss=0.00519 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.186 | L2-Norm(final)=7.607 | 1730.1 samples/s | 27.0 steps/s
[Step=16800 Epoch=159.8] | Loss=0.00434 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.237 | L2-Norm(final)=7.596 | 5045.8 samples/s | 78.8 steps/s
[Step=16850 Epoch=160.3] | Loss=0.00372 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.270 | L2-Norm(final)=7.588 | 1829.7 samples/s | 28.6 steps/s
[Step=16900 Epoch=160.8] | Loss=0.00326 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.291 | L2-Norm(final)=7.583 | 4756.3 samples/s | 74.3 steps/s
[Step=16950 Epoch=161.2] | Loss=0.00290 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.303 | L2-Norm(final)=7.579 | 1803.9 samples/s | 28.2 steps/s
[Step=17000 Epoch=161.7] | Loss=0.00261 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.310 | L2-Norm(final)=7.575 | 4504.8 samples/s | 70.4 steps/s
[Step=17050 Epoch=162.2] | Loss=0.00237 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.313 | L2-Norm(final)=7.573 | 1794.8 samples/s | 28.0 steps/s
[Step=17100 Epoch=162.7] | Loss=0.00218 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.313 | L2-Norm(final)=7.571 | 4380.2 samples/s | 68.4 steps/s
[Step=17150 Epoch=163.1] | Loss=0.00201 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=7.569 | 1851.6 samples/s | 28.9 steps/s
[Step=17200 Epoch=163.6] | Loss=0.00187 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.307 | L2-Norm(final)=7.568 | 4442.7 samples/s | 69.4 steps/s
[Step=17250 Epoch=164.1] | Loss=0.00174 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.301 | L2-Norm(final)=7.567 | 1914.1 samples/s | 29.9 steps/s
[Step=17300 Epoch=164.6] | Loss=0.00163 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.294 | L2-Norm(final)=7.566 | 4478.9 samples/s | 70.0 steps/s
[Step=17350 Epoch=165.0] | Loss=0.00154 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.286 | L2-Norm(final)=7.565 | 1933.6 samples/s | 30.2 steps/s
[Step=17400 Epoch=165.5] | Loss=0.00145 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.277 | L2-Norm(final)=7.565 | 4316.1 samples/s | 67.4 steps/s
[Step=17450 Epoch=166.0] | Loss=0.00138 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.268 | L2-Norm(final)=7.564 | 6015.1 samples/s | 94.0 steps/s
[Step=17500 Epoch=166.5] | Loss=0.00131 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.258 | L2-Norm(final)=7.564 | 1642.1 samples/s | 25.7 steps/s
[Step=17550 Epoch=166.9] | Loss=0.00125 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.247 | L2-Norm(final)=7.564 | 5494.1 samples/s | 85.8 steps/s
[Step=17600 Epoch=167.4] | Loss=0.00119 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.236 | L2-Norm(final)=7.563 | 1734.0 samples/s | 27.1 steps/s
[Step=17650 Epoch=167.9] | Loss=0.00114 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.225 | L2-Norm(final)=7.563 | 5228.8 samples/s | 81.7 steps/s
[Step=17700 Epoch=168.4] | Loss=0.00109 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.213 | L2-Norm(final)=7.563 | 1772.9 samples/s | 27.7 steps/s
[Step=17750 Epoch=168.8] | Loss=0.00105 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.201 | L2-Norm(final)=7.563 | 4965.7 samples/s | 77.6 steps/s
[Step=17800 Epoch=169.3] | Loss=0.00101 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.188 | L2-Norm(final)=7.563 | 1788.9 samples/s | 28.0 steps/s
[Step=17850 Epoch=169.8] | Loss=0.00097 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.176 | L2-Norm(final)=7.563 | 4488.8 samples/s | 70.1 steps/s
[Step=17900 Epoch=170.3] | Loss=0.00094 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.163 | L2-Norm(final)=7.563 | 1861.4 samples/s | 29.1 steps/s
[Step=17950 Epoch=170.7] | Loss=0.00090 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.150 | L2-Norm(final)=7.563 | 4438.8 samples/s | 69.4 steps/s
[Step=18000 Epoch=171.2] | Loss=0.00087 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.136 | L2-Norm(final)=7.563 | 1888.2 samples/s | 29.5 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step18000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=18001 Epoch=171.9] | Loss=0.00629 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.591 | L2-Norm(final)=7.145 | 3627.2 samples/s | 56.7 steps/s
[Step=18050 Epoch=172.4] | Loss=0.01227 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.975 | L2-Norm(final)=7.096 | 4650.2 samples/s | 72.7 steps/s
[Step=18100 Epoch=172.8] | Loss=0.00701 | Reg=0.00172 | acc=0.9844 | L2-Norm=13.127 | L2-Norm(final)=7.108 | 7091.3 samples/s | 110.8 steps/s
[Step=18150 Epoch=173.3] | Loss=0.00481 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.180 | L2-Norm(final)=7.124 | 1758.4 samples/s | 27.5 steps/s
[Step=18200 Epoch=173.8] | Loss=0.00369 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.199 | L2-Norm(final)=7.139 | 6364.9 samples/s | 99.5 steps/s
[Step=18250 Epoch=174.3] | Loss=0.00300 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.206 | L2-Norm(final)=7.153 | 1762.8 samples/s | 27.5 steps/s
[Step=18300 Epoch=174.8] | Loss=0.00253 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.206 | L2-Norm(final)=7.166 | 5527.7 samples/s | 86.4 steps/s
[Step=18350 Epoch=175.2] | Loss=0.00220 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.201 | L2-Norm(final)=7.178 | 1778.7 samples/s | 27.8 steps/s
[Step=18400 Epoch=175.7] | Loss=0.00194 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.194 | L2-Norm(final)=7.190 | 5464.7 samples/s | 85.4 steps/s
[Step=18450 Epoch=176.2] | Loss=0.00174 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.185 | L2-Norm(final)=7.200 | 1850.6 samples/s | 28.9 steps/s
[Step=18500 Epoch=176.7] | Loss=0.00157 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.174 | L2-Norm(final)=7.211 | 5317.8 samples/s | 83.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=176.7] | Loss=0.00015 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.064 | L2-Norm(final)=7.312 | 3596.8 samples/s | 56.2 steps/s
[Step=18550 Epoch=177.1] | Loss=0.00977 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.092 | L2-Norm(final)=7.303 | 4463.5 samples/s | 69.7 steps/s
[Step=18600 Epoch=177.6] | Loss=0.00882 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=7.261 | 5829.9 samples/s | 91.1 steps/s
[Step=18650 Epoch=178.1] | Loss=0.00649 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.340 | L2-Norm(final)=7.239 | 1661.8 samples/s | 26.0 steps/s
[Step=18700 Epoch=178.6] | Loss=0.00500 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.388 | L2-Norm(final)=7.229 | 5334.0 samples/s | 83.3 steps/s
[Step=18750 Epoch=179.1] | Loss=0.00401 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.411 | L2-Norm(final)=7.226 | 1686.7 samples/s | 26.4 steps/s
[Step=18800 Epoch=179.5] | Loss=0.00335 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.421 | L2-Norm(final)=7.224 | 5249.2 samples/s | 82.0 steps/s
[Step=18850 Epoch=180.0] | Loss=0.00287 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.423 | L2-Norm(final)=7.223 | 1708.1 samples/s | 26.7 steps/s
[Step=18900 Epoch=180.5] | Loss=0.00251 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.420 | L2-Norm(final)=7.223 | 4924.3 samples/s | 76.9 steps/s
[Step=18950 Epoch=181.0] | Loss=0.00223 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.414 | L2-Norm(final)=7.222 | 1749.5 samples/s | 27.3 steps/s
[Step=19000 Epoch=181.4] | Loss=0.00201 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.406 | L2-Norm(final)=7.222 | 4587.2 samples/s | 71.7 steps/s
[Step=19050 Epoch=181.9] | Loss=0.00183 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.396 | L2-Norm(final)=7.222 | 1826.9 samples/s | 28.5 steps/s
[Step=19100 Epoch=182.4] | Loss=0.00168 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.384 | L2-Norm(final)=7.222 | 4445.7 samples/s | 69.5 steps/s
[Step=19150 Epoch=182.9] | Loss=0.00155 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.372 | L2-Norm(final)=7.222 | 1832.9 samples/s | 28.6 steps/s
[Step=19200 Epoch=183.3] | Loss=0.00144 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.359 | L2-Norm(final)=7.223 | 4232.0 samples/s | 66.1 steps/s
[Step=19250 Epoch=183.8] | Loss=0.00134 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=7.223 | 1851.1 samples/s | 28.9 steps/s
[Step=19300 Epoch=184.3] | Loss=0.00126 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.331 | L2-Norm(final)=7.223 | 4415.3 samples/s | 69.0 steps/s
[Step=19350 Epoch=184.8] | Loss=0.00119 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.316 | L2-Norm(final)=7.223 | 1895.8 samples/s | 29.6 steps/s
[Step=19400 Epoch=185.3] | Loss=0.00112 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.301 | L2-Norm(final)=7.223 | 4449.3 samples/s | 69.5 steps/s
[Step=19450 Epoch=185.7] | Loss=0.00106 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.285 | L2-Norm(final)=7.224 | 1921.5 samples/s | 30.0 steps/s
[Step=19500 Epoch=186.2] | Loss=0.00101 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.270 | L2-Norm(final)=7.224 | 4208.5 samples/s | 65.8 steps/s
[Step=19550 Epoch=186.7] | Loss=0.00096 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.254 | L2-Norm(final)=7.224 | 6179.6 samples/s | 96.6 steps/s
[Step=19600 Epoch=187.2] | Loss=0.00092 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.238 | L2-Norm(final)=7.225 | 1661.6 samples/s | 26.0 steps/s
[Step=19650 Epoch=187.6] | Loss=0.00088 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.222 | L2-Norm(final)=7.225 | 5932.6 samples/s | 92.7 steps/s
[Step=19700 Epoch=188.1] | Loss=0.00084 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.205 | L2-Norm(final)=7.225 | 1699.5 samples/s | 26.6 steps/s
[Step=19750 Epoch=188.6] | Loss=0.00081 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.189 | L2-Norm(final)=7.226 | 5561.2 samples/s | 86.9 steps/s
[Step=19800 Epoch=189.1] | Loss=0.00078 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.172 | L2-Norm(final)=7.226 | 1692.2 samples/s | 26.4 steps/s
[Step=19850 Epoch=189.6] | Loss=0.00075 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.155 | L2-Norm(final)=7.226 | 5334.0 samples/s | 83.3 steps/s
[Step=19900 Epoch=190.0] | Loss=0.00072 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.138 | L2-Norm(final)=7.227 | 1742.2 samples/s | 27.2 steps/s
[Step=19950 Epoch=190.5] | Loss=0.00070 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.121 | L2-Norm(final)=7.227 | 4767.6 samples/s | 74.5 steps/s
[Step=20000 Epoch=191.0] | Loss=0.00067 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=7.228 | 1790.4 samples/s | 28.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.10251 | acc=0.9546 | tpr=0.9673 | fpr=0.0728 | 4093.6 samples/s | 16.0 steps/s
Avg test loss: 0.10786, Avg test acc: 0.95272, Avg tpr: 0.96602, Avg fpr: 0.07653, total FA: 597

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10996 | acc=0.9518 | tpr=0.9701 | fpr=0.0880 | 4084.6 samples/s | 16.0 steps/s
Avg test loss: 0.10979, Avg test acc: 0.95292, Avg tpr: 0.97150, Avg fpr: 0.08794, total FA: 686

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11099 | acc=0.9528 | tpr=0.9596 | fpr=0.0619 | 3787.1 samples/s | 14.8 steps/s
Avg test loss: 0.11841, Avg test acc: 0.95104, Avg tpr: 0.95693, Avg fpr: 0.06192, total FA: 483

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.12420 | acc=0.9541 | tpr=0.9744 | fpr=0.0902 | 4061.0 samples/s | 15.9 steps/s
Avg test loss: 0.12746, Avg test acc: 0.95344, Avg tpr: 0.97366, Avg fpr: 0.09101, total FA: 710

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10654 | acc=0.9534 | tpr=0.9630 | fpr=0.0676 | 3981.0 samples/s | 15.6 steps/s
Avg test loss: 0.11088, Avg test acc: 0.95228, Avg tpr: 0.96241, Avg fpr: 0.06999, total FA: 546

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.52270 | acc=0.2786 | tpr=0.0048 | fpr=0.1269 | 4296.8 samples/s | 16.8 steps/s
Avg test loss: 4.54036, Avg test acc: 0.27691, Avg tpr: 0.00635, Avg fpr: 0.12806, total FA: 999

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.47802 | acc=0.3063 | tpr=0.0032 | fpr=0.0354 | 4061.9 samples/s | 15.9 steps/s
Avg test loss: 4.49532, Avg test acc: 0.30483, Avg tpr: 0.00455, Avg fpr: 0.03474, total FA: 271

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.67599 | acc=0.3101 | tpr=0.0033 | fpr=0.0238 | 4100.1 samples/s | 16.0 steps/s
Avg test loss: 4.68563, Avg test acc: 0.30748, Avg tpr: 0.00391, Avg fpr: 0.02487, total FA: 194

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.30822 | acc=0.3016 | tpr=0.0075 | fpr=0.0600 | 4148.7 samples/s | 16.2 steps/s
Avg test loss: 4.31846, Avg test acc: 0.29858, Avg tpr: 0.00723, Avg fpr: 0.06063, total FA: 473

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.03733 | acc=0.3116 | tpr=0.0021 | fpr=0.0161 | 4000.2 samples/s | 15.6 steps/s
Avg test loss: 4.04498, Avg test acc: 0.30844, Avg tpr: 0.00221, Avg fpr: 0.01807, total FA: 141

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.07291 | acc=0.1197 | tpr=0.7699 | fpr=0.8920 | 4102.2 samples/s | 16.0 steps/s
[Step= 100] | Loss=5.04212 | acc=0.1214 | tpr=0.7441 | fpr=0.8903 | 8256.5 samples/s | 32.3 steps/s
[Step= 150] | Loss=5.05036 | acc=0.1209 | tpr=0.7406 | fpr=0.8905 | 7810.5 samples/s | 30.5 steps/s
[Step= 200] | Loss=5.04955 | acc=0.1202 | tpr=0.7454 | fpr=0.8911 | 8347.8 samples/s | 32.6 steps/s
[Step= 250] | Loss=5.04877 | acc=0.1207 | tpr=0.7485 | fpr=0.8907 | 7478.2 samples/s | 29.2 steps/s
[Step= 300] | Loss=5.04514 | acc=0.1208 | tpr=0.7469 | fpr=0.8906 | 8223.3 samples/s | 32.1 steps/s
[Step= 350] | Loss=5.04174 | acc=0.1209 | tpr=0.7401 | fpr=0.8904 | 7870.1 samples/s | 30.7 steps/s
[Step= 400] | Loss=5.04119 | acc=0.1214 | tpr=0.7380 | fpr=0.8898 | 8141.8 samples/s | 31.8 steps/s
[Step= 450] | Loss=5.04313 | acc=0.1213 | tpr=0.7313 | fpr=0.8898 | 8326.6 samples/s | 32.5 steps/s
[Step= 500] | Loss=5.04342 | acc=0.1210 | tpr=0.7269 | fpr=0.8899 | 7321.4 samples/s | 28.6 steps/s
[Step= 550] | Loss=5.04488 | acc=0.1210 | tpr=0.7298 | fpr=0.8901 | 14537.4 samples/s | 56.8 steps/s
Avg test loss: 5.04608, Avg test acc: 0.12087, Avg tpr: 0.73019, Avg fpr: 0.89021, total FA: 123604

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.26424 | acc=0.1088 | tpr=0.7832 | fpr=0.9033 | 4125.3 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.20769 | acc=0.1111 | tpr=0.7655 | fpr=0.9012 | 8188.1 samples/s | 32.0 steps/s
[Step= 150] | Loss=5.21440 | acc=0.1103 | tpr=0.7594 | fpr=0.9017 | 8135.7 samples/s | 31.8 steps/s
[Step= 200] | Loss=5.21089 | acc=0.1090 | tpr=0.7410 | fpr=0.9025 | 7753.8 samples/s | 30.3 steps/s
[Step= 250] | Loss=5.20903 | acc=0.1097 | tpr=0.7450 | fpr=0.9018 | 8326.3 samples/s | 32.5 steps/s
[Step= 300] | Loss=5.21090 | acc=0.1094 | tpr=0.7505 | fpr=0.9023 | 8239.8 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.20775 | acc=0.1093 | tpr=0.7383 | fpr=0.9021 | 7642.5 samples/s | 29.9 steps/s
[Step= 400] | Loss=5.20864 | acc=0.1094 | tpr=0.7363 | fpr=0.9020 | 8293.3 samples/s | 32.4 steps/s
[Step= 450] | Loss=5.21157 | acc=0.1092 | tpr=0.7317 | fpr=0.9021 | 7675.2 samples/s | 30.0 steps/s
[Step= 500] | Loss=5.21589 | acc=0.1090 | tpr=0.7295 | fpr=0.9022 | 8203.5 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.21633 | acc=0.1089 | tpr=0.7318 | fpr=0.9024 | 14326.7 samples/s | 56.0 steps/s
Avg test loss: 5.21801, Avg test acc: 0.10881, Avg tpr: 0.73177, Avg fpr: 0.90251, total FA: 125312

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.14776 | acc=0.1248 | tpr=0.6460 | fpr=0.8846 | 4133.8 samples/s | 16.1 steps/s
[Step= 100] | Loss=6.10154 | acc=0.1262 | tpr=0.6034 | fpr=0.8827 | 8212.2 samples/s | 32.1 steps/s
[Step= 150] | Loss=6.11920 | acc=0.1242 | tpr=0.6153 | fpr=0.8848 | 8184.3 samples/s | 32.0 steps/s
[Step= 200] | Loss=6.11919 | acc=0.1237 | tpr=0.6208 | fpr=0.8854 | 8138.6 samples/s | 31.8 steps/s
[Step= 250] | Loss=6.12245 | acc=0.1233 | tpr=0.6157 | fpr=0.8856 | 8074.8 samples/s | 31.5 steps/s
[Step= 300] | Loss=6.12204 | acc=0.1234 | tpr=0.6145 | fpr=0.8856 | 7933.2 samples/s | 31.0 steps/s
[Step= 350] | Loss=6.11866 | acc=0.1231 | tpr=0.6099 | fpr=0.8858 | 7942.8 samples/s | 31.0 steps/s
[Step= 400] | Loss=6.12116 | acc=0.1233 | tpr=0.6018 | fpr=0.8854 | 8218.7 samples/s | 32.1 steps/s
[Step= 450] | Loss=6.12255 | acc=0.1229 | tpr=0.5974 | fpr=0.8857 | 8055.1 samples/s | 31.5 steps/s
[Step= 500] | Loss=6.12258 | acc=0.1229 | tpr=0.5916 | fpr=0.8856 | 7975.7 samples/s | 31.2 steps/s
[Step= 550] | Loss=6.12254 | acc=0.1227 | tpr=0.5965 | fpr=0.8859 | 14368.6 samples/s | 56.1 steps/s
Avg test loss: 6.12411, Avg test acc: 0.12263, Avg tpr: 0.59628, Avg fpr: 0.88598, total FA: 123017

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.89480 | acc=0.1225 | tpr=0.6814 | fpr=0.8875 | 4144.6 samples/s | 16.2 steps/s
[Step= 100] | Loss=5.84119 | acc=0.1224 | tpr=0.6418 | fpr=0.8873 | 7955.9 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.85543 | acc=0.1204 | tpr=0.6556 | fpr=0.8895 | 8155.9 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.85217 | acc=0.1198 | tpr=0.6568 | fpr=0.8899 | 8072.2 samples/s | 31.5 steps/s
[Step= 250] | Loss=5.85249 | acc=0.1204 | tpr=0.6585 | fpr=0.8894 | 8466.1 samples/s | 33.1 steps/s
[Step= 300] | Loss=5.84769 | acc=0.1205 | tpr=0.6538 | fpr=0.8892 | 7958.0 samples/s | 31.1 steps/s
[Step= 350] | Loss=5.84290 | acc=0.1205 | tpr=0.6493 | fpr=0.8891 | 8238.3 samples/s | 32.2 steps/s
[Step= 400] | Loss=5.84429 | acc=0.1208 | tpr=0.6515 | fpr=0.8888 | 8047.5 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.85015 | acc=0.1208 | tpr=0.6480 | fpr=0.8887 | 8239.3 samples/s | 32.2 steps/s
[Step= 500] | Loss=5.85379 | acc=0.1205 | tpr=0.6441 | fpr=0.8889 | 8073.6 samples/s | 31.5 steps/s
[Step= 550] | Loss=5.85408 | acc=0.1204 | tpr=0.6442 | fpr=0.8891 | 14335.8 samples/s | 56.0 steps/s
Avg test loss: 5.85577, Avg test acc: 0.12034, Avg tpr: 0.64422, Avg fpr: 0.88918, total FA: 123461

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.00482 | acc=0.1340 | tpr=0.6858 | fpr=0.8759 | 4133.9 samples/s | 16.1 steps/s
[Step= 100] | Loss=4.95277 | acc=0.1383 | tpr=0.5991 | fpr=0.8703 | 8037.6 samples/s | 31.4 steps/s
[Step= 150] | Loss=4.95787 | acc=0.1355 | tpr=0.5821 | fpr=0.8727 | 8452.7 samples/s | 33.0 steps/s
[Step= 200] | Loss=4.95991 | acc=0.1351 | tpr=0.5760 | fpr=0.8729 | 7932.1 samples/s | 31.0 steps/s
[Step= 250] | Loss=4.95656 | acc=0.1359 | tpr=0.5703 | fpr=0.8720 | 7976.5 samples/s | 31.2 steps/s
[Step= 300] | Loss=4.95309 | acc=0.1358 | tpr=0.5731 | fpr=0.8722 | 8095.1 samples/s | 31.6 steps/s
[Step= 350] | Loss=4.94745 | acc=0.1353 | tpr=0.5667 | fpr=0.8725 | 7868.0 samples/s | 30.7 steps/s
[Step= 400] | Loss=4.95082 | acc=0.1355 | tpr=0.5635 | fpr=0.8723 | 8142.1 samples/s | 31.8 steps/s
[Step= 450] | Loss=4.95288 | acc=0.1351 | tpr=0.5584 | fpr=0.8726 | 8181.0 samples/s | 32.0 steps/s
[Step= 500] | Loss=4.95401 | acc=0.1349 | tpr=0.5551 | fpr=0.8727 | 8268.0 samples/s | 32.3 steps/s
[Step= 550] | Loss=4.95468 | acc=0.1349 | tpr=0.5539 | fpr=0.8727 | 13981.4 samples/s | 54.6 steps/s
Avg test loss: 4.95754, Avg test acc: 0.13489, Avg tpr: 0.55428, Avg fpr: 0.87274, total FA: 121178

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10100 | acc=0.9802 | tpr=0.9248 | fpr=0.0188 | 4069.7 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.10354 | acc=0.9796 | tpr=0.9403 | fpr=0.0196 | 7661.3 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.10749 | acc=0.9787 | tpr=0.9424 | fpr=0.0207 | 7400.9 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.10975 | acc=0.9785 | tpr=0.9443 | fpr=0.0208 | 7685.2 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.10887 | acc=0.9786 | tpr=0.9389 | fpr=0.0207 | 7989.0 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.11042 | acc=0.9783 | tpr=0.9382 | fpr=0.0210 | 7912.6 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.11033 | acc=0.9782 | tpr=0.9374 | fpr=0.0210 | 8219.7 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.11176 | acc=0.9781 | tpr=0.9327 | fpr=0.0210 | 7709.4 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.11444 | acc=0.9779 | tpr=0.9323 | fpr=0.0213 | 7675.4 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.11396 | acc=0.9779 | tpr=0.9344 | fpr=0.0213 | 7869.3 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.11290 | acc=0.9781 | tpr=0.9335 | fpr=0.0211 | 14231.5 samples/s | 55.6 steps/s
Avg test loss: 0.11278, Avg test acc: 0.97814, Avg tpr: 0.93304, Avg fpr: 0.02104, total FA: 2922

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.18736 | acc=0.9809 | tpr=0.8628 | fpr=0.0170 | 4035.1 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.20205 | acc=0.9802 | tpr=0.8870 | fpr=0.0181 | 7926.1 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.20795 | acc=0.9795 | tpr=0.8919 | fpr=0.0189 | 7937.7 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.21119 | acc=0.9792 | tpr=0.8940 | fpr=0.0193 | 8018.6 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.20896 | acc=0.9792 | tpr=0.8952 | fpr=0.0193 | 8177.5 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.21234 | acc=0.9789 | tpr=0.8916 | fpr=0.0195 | 8618.8 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.21443 | acc=0.9785 | tpr=0.8967 | fpr=0.0200 | 7619.6 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.21543 | acc=0.9784 | tpr=0.8928 | fpr=0.0201 | 8017.2 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.22002 | acc=0.9780 | tpr=0.8890 | fpr=0.0204 | 7768.8 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.21853 | acc=0.9781 | tpr=0.8925 | fpr=0.0204 | 7667.5 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.21692 | acc=0.9783 | tpr=0.8902 | fpr=0.0201 | 14880.8 samples/s | 58.1 steps/s
Avg test loss: 0.21647, Avg test acc: 0.97826, Avg tpr: 0.88946, Avg fpr: 0.02013, total FA: 2795

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.14167 | acc=0.9737 | tpr=0.9248 | fpr=0.0254 | 4139.1 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.14785 | acc=0.9730 | tpr=0.9382 | fpr=0.0264 | 7867.9 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.15410 | acc=0.9716 | tpr=0.9308 | fpr=0.0277 | 8255.6 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.15676 | acc=0.9714 | tpr=0.9268 | fpr=0.0278 | 7372.2 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.15642 | acc=0.9713 | tpr=0.9266 | fpr=0.0278 | 7854.8 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.15910 | acc=0.9710 | tpr=0.9236 | fpr=0.0282 | 8031.9 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.15923 | acc=0.9709 | tpr=0.9230 | fpr=0.0282 | 7814.5 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.16106 | acc=0.9707 | tpr=0.9185 | fpr=0.0283 | 8089.1 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.16331 | acc=0.9706 | tpr=0.9163 | fpr=0.0285 | 7654.3 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.16308 | acc=0.9705 | tpr=0.9181 | fpr=0.0285 | 7304.5 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.16185 | acc=0.9707 | tpr=0.9192 | fpr=0.0284 | 14117.7 samples/s | 55.1 steps/s
Avg test loss: 0.16147, Avg test acc: 0.97071, Avg tpr: 0.91918, Avg fpr: 0.02835, total FA: 3937

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11903 | acc=0.9814 | tpr=0.8850 | fpr=0.0169 | 4062.0 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.12482 | acc=0.9805 | tpr=0.9062 | fpr=0.0181 | 7839.7 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.12873 | acc=0.9795 | tpr=0.9063 | fpr=0.0191 | 8170.5 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.13019 | acc=0.9791 | tpr=0.9060 | fpr=0.0195 | 7829.1 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.12824 | acc=0.9791 | tpr=0.9022 | fpr=0.0195 | 7772.4 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.13001 | acc=0.9790 | tpr=0.8996 | fpr=0.0196 | 7890.4 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.13041 | acc=0.9789 | tpr=0.9048 | fpr=0.0198 | 7590.8 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.13180 | acc=0.9787 | tpr=0.8982 | fpr=0.0198 | 7996.6 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.13449 | acc=0.9784 | tpr=0.8958 | fpr=0.0201 | 7348.9 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.13443 | acc=0.9784 | tpr=0.8978 | fpr=0.0201 | 8053.1 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.13328 | acc=0.9786 | tpr=0.8961 | fpr=0.0200 | 13248.4 samples/s | 51.8 steps/s
Avg test loss: 0.13310, Avg test acc: 0.97856, Avg tpr: 0.89540, Avg fpr: 0.01993, total FA: 2767

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12300 | acc=0.9796 | tpr=0.8850 | fpr=0.0187 | 3987.9 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.12665 | acc=0.9794 | tpr=0.9041 | fpr=0.0192 | 8370.3 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.13068 | acc=0.9786 | tpr=0.9164 | fpr=0.0203 | 7818.9 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.13410 | acc=0.9783 | tpr=0.9202 | fpr=0.0206 | 8314.9 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.13268 | acc=0.9784 | tpr=0.9179 | fpr=0.0205 | 7518.4 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.13639 | acc=0.9779 | tpr=0.9156 | fpr=0.0210 | 8151.0 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.13694 | acc=0.9778 | tpr=0.9173 | fpr=0.0211 | 8331.4 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.13856 | acc=0.9776 | tpr=0.9114 | fpr=0.0212 | 7732.5 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.14133 | acc=0.9773 | tpr=0.9104 | fpr=0.0215 | 7760.3 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.14099 | acc=0.9772 | tpr=0.9093 | fpr=0.0215 | 7745.0 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.13984 | acc=0.9774 | tpr=0.9081 | fpr=0.0214 | 15200.4 samples/s | 59.4 steps/s
Avg test loss: 0.13961, Avg test acc: 0.97737, Avg tpr: 0.90769, Avg fpr: 0.02136, total FA: 2966

server round 18/50

clients selected: [0 1 6 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=16001 Epoch=78.0] | Loss=0.01258 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.716 | L2-Norm(final)=7.805 | 3720.7 samples/s | 58.1 steps/s
[Step=16050 Epoch=78.3] | Loss=0.03835 | Reg=0.00164 | acc=0.9688 | L2-Norm=12.790 | L2-Norm(final)=7.806 | 4931.3 samples/s | 77.1 steps/s
[Step=16100 Epoch=78.5] | Loss=0.03603 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.878 | L2-Norm(final)=7.828 | 5110.1 samples/s | 79.8 steps/s
[Step=16150 Epoch=78.8] | Loss=0.03490 | Reg=0.00168 | acc=0.9531 | L2-Norm=12.955 | L2-Norm(final)=7.851 | 5255.6 samples/s | 82.1 steps/s
[Step=16200 Epoch=79.0] | Loss=0.03339 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.020 | L2-Norm(final)=7.872 | 7137.7 samples/s | 111.5 steps/s
[Step=16250 Epoch=79.2] | Loss=0.03146 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.078 | L2-Norm(final)=7.896 | 1793.8 samples/s | 28.0 steps/s
[Step=16300 Epoch=79.5] | Loss=0.03088 | Reg=0.00173 | acc=0.9688 | L2-Norm=13.135 | L2-Norm(final)=7.922 | 5126.5 samples/s | 80.1 steps/s
[Step=16350 Epoch=79.7] | Loss=0.02946 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.193 | L2-Norm(final)=7.948 | 5314.1 samples/s | 83.0 steps/s
[Step=16400 Epoch=80.0] | Loss=0.02890 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.249 | L2-Norm(final)=7.976 | 6409.3 samples/s | 100.1 steps/s
[Step=16450 Epoch=80.2] | Loss=0.02801 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.303 | L2-Norm(final)=8.003 | 1842.3 samples/s | 28.8 steps/s
[Step=16500 Epoch=80.5] | Loss=0.02736 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.355 | L2-Norm(final)=8.032 | 5166.5 samples/s | 80.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=80.5] | Loss=0.01521 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.872 | L2-Norm(final)=8.325 | 3564.2 samples/s | 55.7 steps/s
[Step=16550 Epoch=80.7] | Loss=0.02670 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.925 | L2-Norm(final)=8.344 | 4812.2 samples/s | 75.2 steps/s
[Step=16600 Epoch=80.9] | Loss=0.03735 | Reg=0.00196 | acc=0.9375 | L2-Norm=13.990 | L2-Norm(final)=8.337 | 4600.7 samples/s | 71.9 steps/s
[Step=16650 Epoch=81.2] | Loss=0.04000 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.051 | L2-Norm(final)=8.329 | 4617.9 samples/s | 72.2 steps/s
[Step=16700 Epoch=81.4] | Loss=0.03928 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.105 | L2-Norm(final)=8.321 | 6042.9 samples/s | 94.4 steps/s
[Step=16750 Epoch=81.7] | Loss=0.03512 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.147 | L2-Norm(final)=8.318 | 1742.8 samples/s | 27.2 steps/s
[Step=16800 Epoch=81.9] | Loss=0.03244 | Reg=0.00201 | acc=0.9375 | L2-Norm=14.180 | L2-Norm(final)=8.319 | 4722.6 samples/s | 73.8 steps/s
[Step=16850 Epoch=82.2] | Loss=0.02997 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.207 | L2-Norm(final)=8.321 | 4664.2 samples/s | 72.9 steps/s
[Step=16900 Epoch=82.4] | Loss=0.02792 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.230 | L2-Norm(final)=8.324 | 5655.1 samples/s | 88.4 steps/s
[Step=16950 Epoch=82.7] | Loss=0.02639 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.251 | L2-Norm(final)=8.327 | 1775.8 samples/s | 27.7 steps/s
[Step=17000 Epoch=82.9] | Loss=0.02491 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.270 | L2-Norm(final)=8.331 | 4571.9 samples/s | 71.4 steps/s
[Step=17050 Epoch=83.1] | Loss=0.02371 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.288 | L2-Norm(final)=8.335 | 4660.6 samples/s | 72.8 steps/s
[Step=17100 Epoch=83.4] | Loss=0.02256 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.303 | L2-Norm(final)=8.338 | 5336.9 samples/s | 83.4 steps/s
[Step=17150 Epoch=83.6] | Loss=0.02150 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.317 | L2-Norm(final)=8.341 | 1842.2 samples/s | 28.8 steps/s
[Step=17200 Epoch=83.9] | Loss=0.02039 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.329 | L2-Norm(final)=8.344 | 4624.7 samples/s | 72.3 steps/s
[Step=17250 Epoch=84.1] | Loss=0.01978 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.340 | L2-Norm(final)=8.347 | 4727.1 samples/s | 73.9 steps/s
[Step=17300 Epoch=84.4] | Loss=0.01907 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.350 | L2-Norm(final)=8.349 | 4826.7 samples/s | 75.4 steps/s
[Step=17350 Epoch=84.6] | Loss=0.01849 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.360 | L2-Norm(final)=8.351 | 1896.8 samples/s | 29.6 steps/s
[Step=17400 Epoch=84.8] | Loss=0.01785 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.369 | L2-Norm(final)=8.354 | 4599.5 samples/s | 71.9 steps/s
[Step=17450 Epoch=85.1] | Loss=0.01727 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.376 | L2-Norm(final)=8.356 | 4539.8 samples/s | 70.9 steps/s
[Step=17500 Epoch=85.3] | Loss=0.01670 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.383 | L2-Norm(final)=8.358 | 4659.2 samples/s | 72.8 steps/s
[Step=17550 Epoch=85.6] | Loss=0.01622 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.390 | L2-Norm(final)=8.361 | 1895.7 samples/s | 29.6 steps/s
[Step=17600 Epoch=85.8] | Loss=0.01570 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.396 | L2-Norm(final)=8.364 | 4614.4 samples/s | 72.1 steps/s
[Step=17650 Epoch=86.1] | Loss=0.01528 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.401 | L2-Norm(final)=8.366 | 4458.9 samples/s | 69.7 steps/s
[Step=17700 Epoch=86.3] | Loss=0.01491 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.406 | L2-Norm(final)=8.368 | 4549.6 samples/s | 71.1 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01446 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.410 | L2-Norm(final)=8.370 | 1910.3 samples/s | 29.8 steps/s
[Step=17800 Epoch=86.8] | Loss=0.01409 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.414 | L2-Norm(final)=8.373 | 4769.4 samples/s | 74.5 steps/s
[Step=17850 Epoch=87.0] | Loss=0.01370 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.417 | L2-Norm(final)=8.375 | 4567.3 samples/s | 71.4 steps/s
[Step=17900 Epoch=87.3] | Loss=0.01344 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.420 | L2-Norm(final)=8.377 | 4569.8 samples/s | 71.4 steps/s
[Step=17950 Epoch=87.5] | Loss=0.01316 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.423 | L2-Norm(final)=8.379 | 1915.0 samples/s | 29.9 steps/s
[Step=18000 Epoch=87.8] | Loss=0.01289 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.426 | L2-Norm(final)=8.381 | 4600.4 samples/s | 71.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step18000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=24001 Epoch=117.1] | Loss=0.03009 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.716 | L2-Norm(final)=9.325 | 3864.3 samples/s | 60.4 steps/s
[Step=24050 Epoch=117.4] | Loss=0.04144 | Reg=0.00163 | acc=0.9531 | L2-Norm=12.767 | L2-Norm(final)=9.314 | 4772.2 samples/s | 74.6 steps/s
[Step=24100 Epoch=117.6] | Loss=0.03455 | Reg=0.00165 | acc=0.9688 | L2-Norm=12.844 | L2-Norm(final)=9.315 | 5182.9 samples/s | 81.0 steps/s
[Step=24150 Epoch=117.8] | Loss=0.03218 | Reg=0.00167 | acc=0.9688 | L2-Norm=12.909 | L2-Norm(final)=9.332 | 5136.9 samples/s | 80.3 steps/s
[Step=24200 Epoch=118.1] | Loss=0.03123 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.973 | L2-Norm(final)=9.351 | 7226.3 samples/s | 112.9 steps/s
[Step=24250 Epoch=118.3] | Loss=0.02945 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.032 | L2-Norm(final)=9.374 | 1792.9 samples/s | 28.0 steps/s
[Step=24300 Epoch=118.6] | Loss=0.02795 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.087 | L2-Norm(final)=9.398 | 5240.8 samples/s | 81.9 steps/s
[Step=24350 Epoch=118.8] | Loss=0.02688 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.137 | L2-Norm(final)=9.425 | 5233.8 samples/s | 81.8 steps/s
[Step=24400 Epoch=119.1] | Loss=0.02609 | Reg=0.00174 | acc=0.9531 | L2-Norm=13.187 | L2-Norm(final)=9.455 | 6539.5 samples/s | 102.2 steps/s
[Step=24450 Epoch=119.3] | Loss=0.02495 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.235 | L2-Norm(final)=9.485 | 1826.4 samples/s | 28.5 steps/s
[Step=24500 Epoch=119.5] | Loss=0.02406 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.282 | L2-Norm(final)=9.515 | 5161.7 samples/s | 80.7 steps/s
All layers training...
LR=0.00050, len=1
[Step=24501 Epoch=119.6] | Loss=0.01013 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.746 | L2-Norm(final)=9.824 | 3879.5 samples/s | 60.6 steps/s
[Step=24550 Epoch=119.8] | Loss=0.02466 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.796 | L2-Norm(final)=9.833 | 4340.7 samples/s | 67.8 steps/s
[Step=24600 Epoch=120.0] | Loss=0.03570 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.849 | L2-Norm(final)=9.821 | 4720.3 samples/s | 73.8 steps/s
[Step=24650 Epoch=120.3] | Loss=0.03651 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.906 | L2-Norm(final)=9.806 | 4620.1 samples/s | 72.2 steps/s
[Step=24700 Epoch=120.5] | Loss=0.03567 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.953 | L2-Norm(final)=9.796 | 6236.3 samples/s | 97.4 steps/s
[Step=24750 Epoch=120.8] | Loss=0.03253 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.994 | L2-Norm(final)=9.791 | 1761.9 samples/s | 27.5 steps/s
[Step=24800 Epoch=121.0] | Loss=0.02980 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.027 | L2-Norm(final)=9.791 | 4556.0 samples/s | 71.2 steps/s
[Step=24850 Epoch=121.3] | Loss=0.02766 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.054 | L2-Norm(final)=9.792 | 4552.4 samples/s | 71.1 steps/s
[Step=24900 Epoch=121.5] | Loss=0.02633 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.078 | L2-Norm(final)=9.792 | 5642.1 samples/s | 88.2 steps/s
[Step=24950 Epoch=121.7] | Loss=0.02470 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.099 | L2-Norm(final)=9.793 | 1792.0 samples/s | 28.0 steps/s
[Step=25000 Epoch=122.0] | Loss=0.02321 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.117 | L2-Norm(final)=9.795 | 4490.8 samples/s | 70.2 steps/s
[Step=25050 Epoch=122.2] | Loss=0.02180 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.132 | L2-Norm(final)=9.797 | 4619.0 samples/s | 72.2 steps/s
[Step=25100 Epoch=122.5] | Loss=0.02070 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.146 | L2-Norm(final)=9.801 | 5485.4 samples/s | 85.7 steps/s
[Step=25150 Epoch=122.7] | Loss=0.02000 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.159 | L2-Norm(final)=9.803 | 1783.4 samples/s | 27.9 steps/s
[Step=25200 Epoch=123.0] | Loss=0.01905 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.170 | L2-Norm(final)=9.806 | 4681.6 samples/s | 73.1 steps/s
[Step=25250 Epoch=123.2] | Loss=0.01838 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.180 | L2-Norm(final)=9.808 | 4584.2 samples/s | 71.6 steps/s
[Step=25300 Epoch=123.5] | Loss=0.01812 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.189 | L2-Norm(final)=9.810 | 5272.9 samples/s | 82.4 steps/s
[Step=25350 Epoch=123.7] | Loss=0.01744 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.197 | L2-Norm(final)=9.811 | 1843.4 samples/s | 28.8 steps/s
[Step=25400 Epoch=123.9] | Loss=0.01669 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.205 | L2-Norm(final)=9.812 | 4605.3 samples/s | 72.0 steps/s
[Step=25450 Epoch=124.2] | Loss=0.01617 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.211 | L2-Norm(final)=9.814 | 4634.4 samples/s | 72.4 steps/s
[Step=25500 Epoch=124.4] | Loss=0.01562 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.217 | L2-Norm(final)=9.816 | 4935.0 samples/s | 77.1 steps/s
[Step=25550 Epoch=124.7] | Loss=0.01528 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.223 | L2-Norm(final)=9.817 | 1872.9 samples/s | 29.3 steps/s
[Step=25600 Epoch=124.9] | Loss=0.01477 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.229 | L2-Norm(final)=9.819 | 4755.4 samples/s | 74.3 steps/s
[Step=25650 Epoch=125.2] | Loss=0.01455 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.234 | L2-Norm(final)=9.820 | 4638.1 samples/s | 72.5 steps/s
[Step=25700 Epoch=125.4] | Loss=0.01420 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.239 | L2-Norm(final)=9.822 | 4726.8 samples/s | 73.9 steps/s
[Step=25750 Epoch=125.6] | Loss=0.01384 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.244 | L2-Norm(final)=9.823 | 1914.7 samples/s | 29.9 steps/s
[Step=25800 Epoch=125.9] | Loss=0.01354 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.248 | L2-Norm(final)=9.825 | 4752.4 samples/s | 74.3 steps/s
[Step=25850 Epoch=126.1] | Loss=0.01334 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.252 | L2-Norm(final)=9.826 | 4764.3 samples/s | 74.4 steps/s
[Step=25900 Epoch=126.4] | Loss=0.01314 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.256 | L2-Norm(final)=9.827 | 4575.3 samples/s | 71.5 steps/s
[Step=25950 Epoch=126.6] | Loss=0.01278 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.260 | L2-Norm(final)=9.828 | 1923.4 samples/s | 30.1 steps/s
[Step=26000 Epoch=126.9] | Loss=0.01254 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.263 | L2-Norm(final)=9.829 | 4585.7 samples/s | 71.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step26000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=18001 Epoch=171.2] | Loss=0.00931 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.716 | L2-Norm(final)=7.564 | 3783.8 samples/s | 59.1 steps/s
[Step=18050 Epoch=171.7] | Loss=0.00523 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.791 | L2-Norm(final)=7.585 | 4324.5 samples/s | 67.6 steps/s
[Step=18100 Epoch=172.2] | Loss=0.00336 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.888 | L2-Norm(final)=7.598 | 6926.0 samples/s | 108.2 steps/s
[Step=18150 Epoch=172.7] | Loss=0.00241 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.931 | L2-Norm(final)=7.612 | 1760.8 samples/s | 27.5 steps/s
[Step=18200 Epoch=173.1] | Loss=0.00186 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.950 | L2-Norm(final)=7.624 | 6457.6 samples/s | 100.9 steps/s
[Step=18250 Epoch=173.6] | Loss=0.00152 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.956 | L2-Norm(final)=7.635 | 1867.3 samples/s | 29.2 steps/s
[Step=18300 Epoch=174.1] | Loss=0.00128 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.955 | L2-Norm(final)=7.645 | 5685.3 samples/s | 88.8 steps/s
[Step=18350 Epoch=174.6] | Loss=0.00111 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.949 | L2-Norm(final)=7.654 | 1871.6 samples/s | 29.2 steps/s
[Step=18400 Epoch=175.0] | Loss=0.00098 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.941 | L2-Norm(final)=7.662 | 5137.8 samples/s | 80.3 steps/s
[Step=18450 Epoch=175.5] | Loss=0.00088 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.932 | L2-Norm(final)=7.670 | 1876.7 samples/s | 29.3 steps/s
[Step=18500 Epoch=176.0] | Loss=0.00080 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.922 | L2-Norm(final)=7.677 | 5073.2 samples/s | 79.3 steps/s
All layers training...
LR=0.00050, len=1
[Step=18501 Epoch=176.0] | Loss=0.00003 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.814 | L2-Norm(final)=7.749 | 3527.3 samples/s | 55.1 steps/s
[Step=18550 Epoch=176.5] | Loss=0.00006 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.796 | L2-Norm(final)=7.754 | 4407.8 samples/s | 68.9 steps/s
[Step=18600 Epoch=176.9] | Loss=0.00005 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.777 | L2-Norm(final)=7.759 | 5916.1 samples/s | 92.4 steps/s
[Step=18650 Epoch=177.4] | Loss=0.00004 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.756 | L2-Norm(final)=7.763 | 1688.8 samples/s | 26.4 steps/s
[Step=18700 Epoch=177.9] | Loss=0.00004 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.736 | L2-Norm(final)=7.765 | 5426.0 samples/s | 84.8 steps/s
[Step=18750 Epoch=178.4] | Loss=0.00003 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.714 | L2-Norm(final)=7.768 | 1769.5 samples/s | 27.6 steps/s
[Step=18800 Epoch=178.8] | Loss=0.00003 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.693 | L2-Norm(final)=7.770 | 4974.4 samples/s | 77.7 steps/s
[Step=18850 Epoch=179.3] | Loss=0.00003 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.672 | L2-Norm(final)=7.772 | 1773.5 samples/s | 27.7 steps/s
[Step=18900 Epoch=179.8] | Loss=0.00002 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.651 | L2-Norm(final)=7.774 | 4794.8 samples/s | 74.9 steps/s
[Step=18950 Epoch=180.3] | Loss=0.00002 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.629 | L2-Norm(final)=7.775 | 1785.1 samples/s | 27.9 steps/s
[Step=19000 Epoch=180.7] | Loss=0.00002 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.608 | L2-Norm(final)=7.777 | 4536.3 samples/s | 70.9 steps/s
[Step=19050 Epoch=181.2] | Loss=0.00002 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.586 | L2-Norm(final)=7.779 | 1831.2 samples/s | 28.6 steps/s
[Step=19100 Epoch=181.7] | Loss=0.00002 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.565 | L2-Norm(final)=7.780 | 4458.9 samples/s | 69.7 steps/s
[Step=19150 Epoch=182.2] | Loss=0.00002 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.544 | L2-Norm(final)=7.782 | 1914.6 samples/s | 29.9 steps/s
[Step=19200 Epoch=182.6] | Loss=0.00002 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.522 | L2-Norm(final)=7.783 | 4430.8 samples/s | 69.2 steps/s
[Step=19250 Epoch=183.1] | Loss=0.00002 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.501 | L2-Norm(final)=7.785 | 1877.4 samples/s | 29.3 steps/s
[Step=19300 Epoch=183.6] | Loss=0.00002 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.480 | L2-Norm(final)=7.786 | 4298.8 samples/s | 67.2 steps/s
[Step=19350 Epoch=184.1] | Loss=0.00002 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.458 | L2-Norm(final)=7.787 | 1911.6 samples/s | 29.9 steps/s
[Step=19400 Epoch=184.5] | Loss=0.00001 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.437 | L2-Norm(final)=7.789 | 4489.7 samples/s | 70.2 steps/s
[Step=19450 Epoch=185.0] | Loss=0.00001 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=7.790 | 5909.0 samples/s | 92.3 steps/s
[Step=19500 Epoch=185.5] | Loss=0.00001 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.394 | L2-Norm(final)=7.791 | 1723.9 samples/s | 26.9 steps/s
[Step=19550 Epoch=186.0] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=7.793 | 5690.8 samples/s | 88.9 steps/s
[Step=19600 Epoch=186.4] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.352 | L2-Norm(final)=7.794 | 1725.3 samples/s | 27.0 steps/s
[Step=19650 Epoch=186.9] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.330 | L2-Norm(final)=7.795 | 5238.8 samples/s | 81.9 steps/s
[Step=19700 Epoch=187.4] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.309 | L2-Norm(final)=7.796 | 1751.4 samples/s | 27.4 steps/s
[Step=19750 Epoch=187.9] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=7.798 | 4627.7 samples/s | 72.3 steps/s
[Step=19800 Epoch=188.3] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.266 | L2-Norm(final)=7.799 | 1752.7 samples/s | 27.4 steps/s
[Step=19850 Epoch=188.8] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=7.800 | 4444.0 samples/s | 69.4 steps/s
[Step=19900 Epoch=189.3] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=7.802 | 1854.7 samples/s | 29.0 steps/s
[Step=19950 Epoch=189.8] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.201 | L2-Norm(final)=7.803 | 4356.4 samples/s | 68.1 steps/s
[Step=20000 Epoch=190.2] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.180 | L2-Norm(final)=7.804 | 1861.0 samples/s | 29.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step20000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=14001 Epoch=131.9] | Loss=0.00015 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.716 | L2-Norm(final)=7.206 | 3760.8 samples/s | 58.8 steps/s
[Step=14050 Epoch=132.4] | Loss=0.00444 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.805 | L2-Norm(final)=7.214 | 4430.3 samples/s | 69.2 steps/s
[Step=14100 Epoch=132.9] | Loss=0.00281 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.861 | L2-Norm(final)=7.238 | 6731.9 samples/s | 105.2 steps/s
[Step=14150 Epoch=133.3] | Loss=0.00204 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.885 | L2-Norm(final)=7.260 | 1779.6 samples/s | 27.8 steps/s
[Step=14200 Epoch=133.8] | Loss=0.00159 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.893 | L2-Norm(final)=7.279 | 6281.4 samples/s | 98.1 steps/s
[Step=14250 Epoch=134.3] | Loss=0.00132 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.893 | L2-Norm(final)=7.296 | 1788.8 samples/s | 28.0 steps/s
[Step=14300 Epoch=134.7] | Loss=0.00114 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.889 | L2-Norm(final)=7.311 | 5433.8 samples/s | 84.9 steps/s
[Step=14350 Epoch=135.2] | Loss=0.00099 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.883 | L2-Norm(final)=7.324 | 1872.2 samples/s | 29.3 steps/s
[Step=14400 Epoch=135.7] | Loss=0.00088 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.875 | L2-Norm(final)=7.336 | 5105.9 samples/s | 79.8 steps/s
[Step=14450 Epoch=136.2] | Loss=0.00080 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.865 | L2-Norm(final)=7.348 | 1901.0 samples/s | 29.7 steps/s
[Step=14500 Epoch=136.6] | Loss=0.00073 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.855 | L2-Norm(final)=7.359 | 5143.8 samples/s | 80.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=136.6] | Loss=0.00016 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.753 | L2-Norm(final)=7.465 | 3769.5 samples/s | 58.9 steps/s
[Step=14550 Epoch=137.1] | Loss=0.00008 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.737 | L2-Norm(final)=7.473 | 4079.4 samples/s | 63.7 steps/s
[Step=14600 Epoch=137.6] | Loss=0.00007 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.717 | L2-Norm(final)=7.479 | 5818.8 samples/s | 90.9 steps/s
[Step=14650 Epoch=138.0] | Loss=0.00006 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.696 | L2-Norm(final)=7.484 | 1710.1 samples/s | 26.7 steps/s
[Step=14700 Epoch=138.5] | Loss=0.00005 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.674 | L2-Norm(final)=7.487 | 5392.9 samples/s | 84.3 steps/s
[Step=14750 Epoch=139.0] | Loss=0.00004 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.652 | L2-Norm(final)=7.490 | 1739.7 samples/s | 27.2 steps/s
[Step=14800 Epoch=139.5] | Loss=0.00004 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.629 | L2-Norm(final)=7.492 | 4769.0 samples/s | 74.5 steps/s
[Step=14850 Epoch=139.9] | Loss=0.00003 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.606 | L2-Norm(final)=7.494 | 1824.4 samples/s | 28.5 steps/s
[Step=14900 Epoch=140.4] | Loss=0.00003 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.582 | L2-Norm(final)=7.496 | 4590.6 samples/s | 71.7 steps/s
[Step=14950 Epoch=140.9] | Loss=0.00003 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.559 | L2-Norm(final)=7.498 | 1783.7 samples/s | 27.9 steps/s
[Step=15000 Epoch=141.3] | Loss=0.00003 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=7.500 | 4249.1 samples/s | 66.4 steps/s
[Step=15050 Epoch=141.8] | Loss=0.00002 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.513 | L2-Norm(final)=7.501 | 1852.0 samples/s | 28.9 steps/s
[Step=15100 Epoch=142.3] | Loss=0.00002 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.490 | L2-Norm(final)=7.503 | 4414.9 samples/s | 69.0 steps/s
[Step=15150 Epoch=142.8] | Loss=0.00002 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.466 | L2-Norm(final)=7.504 | 1861.1 samples/s | 29.1 steps/s
[Step=15200 Epoch=143.2] | Loss=0.00002 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.443 | L2-Norm(final)=7.506 | 4451.8 samples/s | 69.6 steps/s
[Step=15250 Epoch=143.7] | Loss=0.00002 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.420 | L2-Norm(final)=7.507 | 1963.5 samples/s | 30.7 steps/s
[Step=15300 Epoch=144.2] | Loss=0.00002 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.397 | L2-Norm(final)=7.509 | 4022.5 samples/s | 62.9 steps/s
[Step=15350 Epoch=144.6] | Loss=0.00002 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.374 | L2-Norm(final)=7.510 | 6222.9 samples/s | 97.2 steps/s
[Step=15400 Epoch=145.1] | Loss=0.00002 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.351 | L2-Norm(final)=7.511 | 1720.0 samples/s | 26.9 steps/s
[Step=15450 Epoch=145.6] | Loss=0.00002 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.327 | L2-Norm(final)=7.513 | 5376.5 samples/s | 84.0 steps/s
[Step=15500 Epoch=146.1] | Loss=0.00002 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=7.514 | 1756.6 samples/s | 27.4 steps/s
[Step=15550 Epoch=146.5] | Loss=0.00002 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.281 | L2-Norm(final)=7.515 | 5015.9 samples/s | 78.4 steps/s
[Step=15600 Epoch=147.0] | Loss=0.00002 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=7.516 | 1796.7 samples/s | 28.1 steps/s
[Step=15650 Epoch=147.5] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.235 | L2-Norm(final)=7.518 | 4532.6 samples/s | 70.8 steps/s
[Step=15700 Epoch=147.9] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.212 | L2-Norm(final)=7.519 | 1860.3 samples/s | 29.1 steps/s
[Step=15750 Epoch=148.4] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.188 | L2-Norm(final)=7.520 | 4357.7 samples/s | 68.1 steps/s
[Step=15800 Epoch=148.9] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=7.521 | 1875.3 samples/s | 29.3 steps/s
[Step=15850 Epoch=149.4] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=7.523 | 4395.7 samples/s | 68.7 steps/s
[Step=15900 Epoch=149.8] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.119 | L2-Norm(final)=7.524 | 1899.7 samples/s | 29.7 steps/s
[Step=15950 Epoch=150.3] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.095 | L2-Norm(final)=7.525 | 4475.1 samples/s | 69.9 steps/s
[Step=16000 Epoch=150.8] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.072 | L2-Norm(final)=7.526 | 1961.4 samples/s | 30.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step16000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=14001 Epoch=133.4] | Loss=0.00379 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.716 | L2-Norm(final)=7.243 | 3635.0 samples/s | 56.8 steps/s
[Step=14050 Epoch=133.9] | Loss=0.00555 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.805 | L2-Norm(final)=7.257 | 4677.5 samples/s | 73.1 steps/s
[Step=14100 Epoch=134.4] | Loss=0.00360 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.861 | L2-Norm(final)=7.286 | 6971.4 samples/s | 108.9 steps/s
[Step=14150 Epoch=134.9] | Loss=0.00267 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=7.313 | 1741.5 samples/s | 27.2 steps/s
[Step=14200 Epoch=135.3] | Loss=0.00210 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.921 | L2-Norm(final)=7.336 | 6343.7 samples/s | 99.1 steps/s
[Step=14250 Epoch=135.8] | Loss=0.00173 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.932 | L2-Norm(final)=7.356 | 1766.0 samples/s | 27.6 steps/s
[Step=14300 Epoch=136.3] | Loss=0.00148 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.935 | L2-Norm(final)=7.373 | 5997.3 samples/s | 93.7 steps/s
[Step=14350 Epoch=136.8] | Loss=0.00130 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.936 | L2-Norm(final)=7.388 | 1824.5 samples/s | 28.5 steps/s
[Step=14400 Epoch=137.2] | Loss=0.00116 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.934 | L2-Norm(final)=7.403 | 5461.4 samples/s | 85.3 steps/s
[Step=14450 Epoch=137.7] | Loss=0.00105 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.930 | L2-Norm(final)=7.416 | 1833.0 samples/s | 28.6 steps/s
[Step=14500 Epoch=138.2] | Loss=0.00096 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.925 | L2-Norm(final)=7.429 | 5286.7 samples/s | 82.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=14501 Epoch=138.2] | Loss=0.00010 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.869 | L2-Norm(final)=7.554 | 3603.5 samples/s | 56.3 steps/s
[Step=14550 Epoch=138.7] | Loss=0.00013 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.856 | L2-Norm(final)=7.563 | 4348.2 samples/s | 67.9 steps/s
[Step=14600 Epoch=139.2] | Loss=0.00009 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.840 | L2-Norm(final)=7.570 | 5942.0 samples/s | 92.8 steps/s
[Step=14650 Epoch=139.6] | Loss=0.00007 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.821 | L2-Norm(final)=7.575 | 1666.1 samples/s | 26.0 steps/s
[Step=14700 Epoch=140.1] | Loss=0.00006 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.801 | L2-Norm(final)=7.578 | 5598.4 samples/s | 87.5 steps/s
[Step=14750 Epoch=140.6] | Loss=0.00005 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=7.582 | 1711.3 samples/s | 26.7 steps/s
[Step=14800 Epoch=141.1] | Loss=0.00005 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.759 | L2-Norm(final)=7.584 | 5336.3 samples/s | 83.4 steps/s
[Step=14850 Epoch=141.5] | Loss=0.00004 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.738 | L2-Norm(final)=7.587 | 1777.4 samples/s | 27.8 steps/s
[Step=14900 Epoch=142.0] | Loss=0.00004 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.717 | L2-Norm(final)=7.589 | 5199.3 samples/s | 81.2 steps/s
[Step=14950 Epoch=142.5] | Loss=0.00004 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.696 | L2-Norm(final)=7.591 | 1848.8 samples/s | 28.9 steps/s
[Step=15000 Epoch=143.0] | Loss=0.00003 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=7.593 | 4543.6 samples/s | 71.0 steps/s
[Step=15050 Epoch=143.4] | Loss=0.00003 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.654 | L2-Norm(final)=7.595 | 1833.5 samples/s | 28.6 steps/s
[Step=15100 Epoch=143.9] | Loss=0.00003 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.632 | L2-Norm(final)=7.597 | 4474.1 samples/s | 69.9 steps/s
[Step=15150 Epoch=144.4] | Loss=0.00003 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.611 | L2-Norm(final)=7.599 | 1839.5 samples/s | 28.7 steps/s
[Step=15200 Epoch=144.9] | Loss=0.00003 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.590 | L2-Norm(final)=7.600 | 4387.0 samples/s | 68.5 steps/s
[Step=15250 Epoch=145.3] | Loss=0.00003 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.568 | L2-Norm(final)=7.602 | 1886.7 samples/s | 29.5 steps/s
[Step=15300 Epoch=145.8] | Loss=0.00002 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.547 | L2-Norm(final)=7.604 | 4580.2 samples/s | 71.6 steps/s
[Step=15350 Epoch=146.3] | Loss=0.00002 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.525 | L2-Norm(final)=7.605 | 1870.2 samples/s | 29.2 steps/s
[Step=15400 Epoch=146.8] | Loss=0.00002 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.504 | L2-Norm(final)=7.607 | 4324.0 samples/s | 67.6 steps/s
[Step=15450 Epoch=147.3] | Loss=0.00002 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=7.608 | 1837.4 samples/s | 28.7 steps/s
[Step=15500 Epoch=147.7] | Loss=0.00002 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.461 | L2-Norm(final)=7.610 | 4332.2 samples/s | 67.7 steps/s
[Step=15550 Epoch=148.2] | Loss=0.00002 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=7.611 | 6369.7 samples/s | 99.5 steps/s
[Step=15600 Epoch=148.7] | Loss=0.00002 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.417 | L2-Norm(final)=7.613 | 1668.2 samples/s | 26.1 steps/s
[Step=15650 Epoch=149.2] | Loss=0.00002 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.396 | L2-Norm(final)=7.614 | 6002.7 samples/s | 93.8 steps/s
[Step=15700 Epoch=149.6] | Loss=0.00002 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.374 | L2-Norm(final)=7.615 | 1726.8 samples/s | 27.0 steps/s
[Step=15750 Epoch=150.1] | Loss=0.00002 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.352 | L2-Norm(final)=7.617 | 5619.4 samples/s | 87.8 steps/s
[Step=15800 Epoch=150.6] | Loss=0.00002 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.331 | L2-Norm(final)=7.618 | 1727.2 samples/s | 27.0 steps/s
[Step=15850 Epoch=151.1] | Loss=0.00002 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.309 | L2-Norm(final)=7.620 | 5219.2 samples/s | 81.6 steps/s
[Step=15900 Epoch=151.5] | Loss=0.00002 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=7.621 | 1771.9 samples/s | 27.7 steps/s
[Step=15950 Epoch=152.0] | Loss=0.00002 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.265 | L2-Norm(final)=7.622 | 5044.6 samples/s | 78.8 steps/s
[Step=16000 Epoch=152.5] | Loss=0.00002 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=7.624 | 1810.7 samples/s | 28.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11028 | acc=0.9548 | tpr=0.9703 | fpr=0.0790 | 4123.9 samples/s | 16.1 steps/s
Avg test loss: 0.11329, Avg test acc: 0.95256, Avg tpr: 0.96888, Avg fpr: 0.08332, total FA: 650

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.11403 | acc=0.9512 | tpr=0.9755 | fpr=0.1016 | 4039.4 samples/s | 15.8 steps/s
Avg test loss: 0.11633, Avg test acc: 0.95140, Avg tpr: 0.97622, Avg fpr: 0.10319, total FA: 805

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11099 | acc=0.9528 | tpr=0.9596 | fpr=0.0619 | 3936.5 samples/s | 15.4 steps/s
Avg test loss: 0.11841, Avg test acc: 0.95104, Avg tpr: 0.95693, Avg fpr: 0.06192, total FA: 483

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.12420 | acc=0.9541 | tpr=0.9744 | fpr=0.0902 | 4052.1 samples/s | 15.8 steps/s
Avg test loss: 0.12746, Avg test acc: 0.95344, Avg tpr: 0.97366, Avg fpr: 0.09101, total FA: 710

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10654 | acc=0.9534 | tpr=0.9630 | fpr=0.0676 | 4132.7 samples/s | 16.1 steps/s
Avg test loss: 0.11088, Avg test acc: 0.95228, Avg tpr: 0.96241, Avg fpr: 0.06999, total FA: 546

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.52270 | acc=0.2786 | tpr=0.0048 | fpr=0.1269 | 4133.7 samples/s | 16.1 steps/s
Avg test loss: 4.54036, Avg test acc: 0.27691, Avg tpr: 0.00635, Avg fpr: 0.12806, total FA: 999

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.24579 | acc=0.3105 | tpr=0.0102 | fpr=0.0372 | 4054.5 samples/s | 15.8 steps/s
Avg test loss: 4.25702, Avg test acc: 0.30836, Avg tpr: 0.01067, Avg fpr: 0.03692, total FA: 288

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.67599 | acc=0.3101 | tpr=0.0033 | fpr=0.0238 | 4063.9 samples/s | 15.9 steps/s
Avg test loss: 4.68563, Avg test acc: 0.30748, Avg tpr: 0.00391, Avg fpr: 0.02487, total FA: 194

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.60151 | acc=0.2958 | tpr=0.0067 | fpr=0.0766 | 4184.9 samples/s | 16.3 steps/s
Avg test loss: 4.60843, Avg test acc: 0.29417, Avg tpr: 0.00769, Avg fpr: 0.07576, total FA: 591

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.40084 | acc=0.3047 | tpr=0.0029 | fpr=0.0399 | 3871.4 samples/s | 15.1 steps/s
Avg test loss: 4.41168, Avg test acc: 0.30215, Avg tpr: 0.00408, Avg fpr: 0.04230, total FA: 330

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.34561 | acc=0.1074 | tpr=0.7566 | fpr=0.9042 | 4143.4 samples/s | 16.2 steps/s
[Step= 100] | Loss=5.31624 | acc=0.1106 | tpr=0.7015 | fpr=0.9004 | 7730.0 samples/s | 30.2 steps/s
[Step= 150] | Loss=5.32847 | acc=0.1090 | tpr=0.6931 | fpr=0.9017 | 7338.2 samples/s | 28.7 steps/s
[Step= 200] | Loss=5.32742 | acc=0.1085 | tpr=0.6852 | fpr=0.9020 | 7528.9 samples/s | 29.4 steps/s
[Step= 250] | Loss=5.32730 | acc=0.1088 | tpr=0.6873 | fpr=0.9017 | 7867.3 samples/s | 30.7 steps/s
[Step= 300] | Loss=5.32222 | acc=0.1086 | tpr=0.6953 | fpr=0.9021 | 7794.6 samples/s | 30.4 steps/s
[Step= 350] | Loss=5.31844 | acc=0.1085 | tpr=0.6888 | fpr=0.9020 | 7796.1 samples/s | 30.5 steps/s
[Step= 400] | Loss=5.32165 | acc=0.1093 | tpr=0.6860 | fpr=0.9011 | 7578.3 samples/s | 29.6 steps/s
[Step= 450] | Loss=5.32201 | acc=0.1088 | tpr=0.6831 | fpr=0.9016 | 7589.2 samples/s | 29.6 steps/s
[Step= 500] | Loss=5.32370 | acc=0.1088 | tpr=0.6775 | fpr=0.9015 | 7596.6 samples/s | 29.7 steps/s
[Step= 550] | Loss=5.32538 | acc=0.1084 | tpr=0.6809 | fpr=0.9020 | 14761.2 samples/s | 57.7 steps/s
Avg test loss: 5.32713, Avg test acc: 0.10829, Avg tpr: 0.68067, Avg fpr: 0.90212, total FA: 125257

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.34475 | acc=0.1108 | tpr=0.8584 | fpr=0.9027 | 4114.3 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.29240 | acc=0.1146 | tpr=0.8401 | fpr=0.8989 | 8045.6 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.31056 | acc=0.1126 | tpr=0.8386 | fpr=0.9008 | 8530.9 samples/s | 33.3 steps/s
[Step= 200] | Loss=5.30974 | acc=0.1120 | tpr=0.8295 | fpr=0.9011 | 7842.0 samples/s | 30.6 steps/s
[Step= 250] | Loss=5.31453 | acc=0.1119 | tpr=0.8236 | fpr=0.9011 | 7908.8 samples/s | 30.9 steps/s
[Step= 300] | Loss=5.31783 | acc=0.1115 | tpr=0.8269 | fpr=0.9016 | 8134.8 samples/s | 31.8 steps/s
[Step= 350] | Loss=5.30993 | acc=0.1114 | tpr=0.8272 | fpr=0.9016 | 8170.7 samples/s | 31.9 steps/s
[Step= 400] | Loss=5.30996 | acc=0.1112 | tpr=0.8260 | fpr=0.9018 | 8093.1 samples/s | 31.6 steps/s
[Step= 450] | Loss=5.31264 | acc=0.1114 | tpr=0.8213 | fpr=0.9014 | 8261.8 samples/s | 32.3 steps/s
[Step= 500] | Loss=5.31714 | acc=0.1110 | tpr=0.8194 | fpr=0.9018 | 7845.6 samples/s | 30.6 steps/s
[Step= 550] | Loss=5.31750 | acc=0.1108 | tpr=0.8197 | fpr=0.9021 | 14549.3 samples/s | 56.8 steps/s
Avg test loss: 5.31869, Avg test acc: 0.11074, Avg tpr: 0.82013, Avg fpr: 0.90216, total FA: 125263

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.14776 | acc=0.1248 | tpr=0.6460 | fpr=0.8846 | 4233.0 samples/s | 16.5 steps/s
[Step= 100] | Loss=6.10154 | acc=0.1262 | tpr=0.6034 | fpr=0.8827 | 7809.0 samples/s | 30.5 steps/s
[Step= 150] | Loss=6.11920 | acc=0.1242 | tpr=0.6153 | fpr=0.8848 | 8126.1 samples/s | 31.7 steps/s
[Step= 200] | Loss=6.11919 | acc=0.1237 | tpr=0.6208 | fpr=0.8854 | 7789.7 samples/s | 30.4 steps/s
[Step= 250] | Loss=6.12245 | acc=0.1233 | tpr=0.6157 | fpr=0.8856 | 7996.8 samples/s | 31.2 steps/s
[Step= 300] | Loss=6.12204 | acc=0.1234 | tpr=0.6145 | fpr=0.8856 | 7914.1 samples/s | 30.9 steps/s
[Step= 350] | Loss=6.11866 | acc=0.1231 | tpr=0.6099 | fpr=0.8858 | 7988.0 samples/s | 31.2 steps/s
[Step= 400] | Loss=6.12116 | acc=0.1233 | tpr=0.6018 | fpr=0.8854 | 8004.8 samples/s | 31.3 steps/s
[Step= 450] | Loss=6.12255 | acc=0.1229 | tpr=0.5974 | fpr=0.8857 | 8167.7 samples/s | 31.9 steps/s
[Step= 500] | Loss=6.12258 | acc=0.1229 | tpr=0.5916 | fpr=0.8856 | 8232.4 samples/s | 32.2 steps/s
[Step= 550] | Loss=6.12254 | acc=0.1227 | tpr=0.5965 | fpr=0.8859 | 14217.1 samples/s | 55.5 steps/s
Avg test loss: 6.12411, Avg test acc: 0.12263, Avg tpr: 0.59628, Avg fpr: 0.88598, total FA: 123017

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.89480 | acc=0.1225 | tpr=0.6814 | fpr=0.8875 | 4126.0 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.84119 | acc=0.1224 | tpr=0.6418 | fpr=0.8873 | 8017.5 samples/s | 31.3 steps/s
[Step= 150] | Loss=5.85543 | acc=0.1204 | tpr=0.6556 | fpr=0.8895 | 8275.3 samples/s | 32.3 steps/s
[Step= 200] | Loss=5.85217 | acc=0.1198 | tpr=0.6568 | fpr=0.8899 | 7719.5 samples/s | 30.2 steps/s
[Step= 250] | Loss=5.85249 | acc=0.1204 | tpr=0.6585 | fpr=0.8894 | 7845.7 samples/s | 30.6 steps/s
[Step= 300] | Loss=5.84769 | acc=0.1205 | tpr=0.6538 | fpr=0.8892 | 8066.6 samples/s | 31.5 steps/s
[Step= 350] | Loss=5.84290 | acc=0.1205 | tpr=0.6493 | fpr=0.8891 | 8158.5 samples/s | 31.9 steps/s
[Step= 400] | Loss=5.84429 | acc=0.1208 | tpr=0.6515 | fpr=0.8888 | 7943.0 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.85015 | acc=0.1208 | tpr=0.6480 | fpr=0.8887 | 7987.6 samples/s | 31.2 steps/s
[Step= 500] | Loss=5.85379 | acc=0.1205 | tpr=0.6441 | fpr=0.8889 | 7499.6 samples/s | 29.3 steps/s
[Step= 550] | Loss=5.85408 | acc=0.1204 | tpr=0.6442 | fpr=0.8891 | 13977.2 samples/s | 54.6 steps/s
Avg test loss: 5.85577, Avg test acc: 0.12034, Avg tpr: 0.64422, Avg fpr: 0.88918, total FA: 123461

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.00482 | acc=0.1340 | tpr=0.6858 | fpr=0.8759 | 4065.1 samples/s | 15.9 steps/s
[Step= 100] | Loss=4.95277 | acc=0.1383 | tpr=0.5991 | fpr=0.8703 | 7839.9 samples/s | 30.6 steps/s
[Step= 150] | Loss=4.95787 | acc=0.1355 | tpr=0.5821 | fpr=0.8727 | 7818.1 samples/s | 30.5 steps/s
[Step= 200] | Loss=4.95991 | acc=0.1351 | tpr=0.5760 | fpr=0.8729 | 7737.8 samples/s | 30.2 steps/s
[Step= 250] | Loss=4.95656 | acc=0.1359 | tpr=0.5703 | fpr=0.8720 | 7761.0 samples/s | 30.3 steps/s
[Step= 300] | Loss=4.95309 | acc=0.1358 | tpr=0.5731 | fpr=0.8722 | 8224.5 samples/s | 32.1 steps/s
[Step= 350] | Loss=4.94745 | acc=0.1353 | tpr=0.5667 | fpr=0.8725 | 8084.4 samples/s | 31.6 steps/s
[Step= 400] | Loss=4.95082 | acc=0.1355 | tpr=0.5635 | fpr=0.8723 | 8199.7 samples/s | 32.0 steps/s
[Step= 450] | Loss=4.95288 | acc=0.1351 | tpr=0.5584 | fpr=0.8726 | 8167.9 samples/s | 31.9 steps/s
[Step= 500] | Loss=4.95401 | acc=0.1349 | tpr=0.5551 | fpr=0.8727 | 7544.3 samples/s | 29.5 steps/s
[Step= 550] | Loss=4.95468 | acc=0.1349 | tpr=0.5539 | fpr=0.8727 | 13983.7 samples/s | 54.6 steps/s
Avg test loss: 4.95754, Avg test acc: 0.13489, Avg tpr: 0.55428, Avg fpr: 0.87274, total FA: 121178

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10100 | acc=0.9802 | tpr=0.9248 | fpr=0.0188 | 3866.7 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.10354 | acc=0.9796 | tpr=0.9403 | fpr=0.0196 | 8241.6 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.10749 | acc=0.9787 | tpr=0.9424 | fpr=0.0207 | 7771.4 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.10975 | acc=0.9785 | tpr=0.9443 | fpr=0.0208 | 8355.9 samples/s | 32.6 steps/s
[Step= 250] | Loss=0.10887 | acc=0.9786 | tpr=0.9389 | fpr=0.0207 | 8095.8 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.11042 | acc=0.9783 | tpr=0.9382 | fpr=0.0210 | 8129.3 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.11033 | acc=0.9782 | tpr=0.9374 | fpr=0.0210 | 8598.2 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.11176 | acc=0.9781 | tpr=0.9327 | fpr=0.0210 | 7736.3 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.11444 | acc=0.9779 | tpr=0.9323 | fpr=0.0213 | 8222.9 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.11396 | acc=0.9779 | tpr=0.9344 | fpr=0.0213 | 7795.7 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.11290 | acc=0.9781 | tpr=0.9335 | fpr=0.0211 | 15113.1 samples/s | 59.0 steps/s
Avg test loss: 0.11278, Avg test acc: 0.97814, Avg tpr: 0.93304, Avg fpr: 0.02104, total FA: 2922

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11903 | acc=0.9816 | tpr=0.9071 | fpr=0.0171 | 3801.6 samples/s | 14.8 steps/s
[Step= 100] | Loss=0.12396 | acc=0.9813 | tpr=0.9211 | fpr=0.0175 | 7502.7 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.12839 | acc=0.9805 | tpr=0.9164 | fpr=0.0183 | 7546.5 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.13029 | acc=0.9804 | tpr=0.9191 | fpr=0.0185 | 7660.1 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.12885 | acc=0.9803 | tpr=0.9188 | fpr=0.0186 | 8157.4 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.13096 | acc=0.9798 | tpr=0.9200 | fpr=0.0191 | 7892.6 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.13079 | acc=0.9796 | tpr=0.9230 | fpr=0.0194 | 8031.5 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.13243 | acc=0.9793 | tpr=0.9174 | fpr=0.0196 | 7978.3 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.13538 | acc=0.9789 | tpr=0.9148 | fpr=0.0199 | 7912.1 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.13480 | acc=0.9789 | tpr=0.9163 | fpr=0.0200 | 8288.2 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.13372 | acc=0.9790 | tpr=0.9160 | fpr=0.0199 | 14228.5 samples/s | 55.6 steps/s
Avg test loss: 0.13350, Avg test acc: 0.97898, Avg tpr: 0.91482, Avg fpr: 0.01985, total FA: 2756

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.14167 | acc=0.9737 | tpr=0.9248 | fpr=0.0254 | 4021.1 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.14785 | acc=0.9730 | tpr=0.9382 | fpr=0.0264 | 7685.6 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.15410 | acc=0.9716 | tpr=0.9308 | fpr=0.0277 | 7795.8 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.15676 | acc=0.9714 | tpr=0.9268 | fpr=0.0278 | 7347.9 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.15642 | acc=0.9713 | tpr=0.9266 | fpr=0.0278 | 8184.7 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.15910 | acc=0.9710 | tpr=0.9236 | fpr=0.0282 | 8107.5 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.15923 | acc=0.9709 | tpr=0.9230 | fpr=0.0282 | 8578.2 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.16106 | acc=0.9707 | tpr=0.9185 | fpr=0.0283 | 7793.3 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.16331 | acc=0.9706 | tpr=0.9163 | fpr=0.0285 | 7841.4 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.16308 | acc=0.9705 | tpr=0.9181 | fpr=0.0285 | 8002.1 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.16185 | acc=0.9707 | tpr=0.9192 | fpr=0.0284 | 14107.3 samples/s | 55.1 steps/s
Avg test loss: 0.16147, Avg test acc: 0.97071, Avg tpr: 0.91918, Avg fpr: 0.02835, total FA: 3937

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11835 | acc=0.9800 | tpr=0.9292 | fpr=0.0191 | 4040.0 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.12381 | acc=0.9798 | tpr=0.9446 | fpr=0.0195 | 7634.8 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.12846 | acc=0.9789 | tpr=0.9409 | fpr=0.0204 | 8052.2 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.13075 | acc=0.9788 | tpr=0.9475 | fpr=0.0206 | 7935.8 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.12950 | acc=0.9788 | tpr=0.9441 | fpr=0.0206 | 7619.3 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.13150 | acc=0.9785 | tpr=0.9433 | fpr=0.0208 | 8590.2 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.13145 | acc=0.9784 | tpr=0.9443 | fpr=0.0210 | 7799.6 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.13279 | acc=0.9783 | tpr=0.9409 | fpr=0.0210 | 7756.8 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.13573 | acc=0.9780 | tpr=0.9382 | fpr=0.0213 | 8062.0 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.13526 | acc=0.9780 | tpr=0.9405 | fpr=0.0213 | 8004.9 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.13410 | acc=0.9782 | tpr=0.9415 | fpr=0.0211 | 15047.0 samples/s | 58.8 steps/s
Avg test loss: 0.13389, Avg test acc: 0.97823, Avg tpr: 0.94057, Avg fpr: 0.02108, total FA: 2927

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.11866 | acc=0.9802 | tpr=0.9248 | fpr=0.0188 | 4032.9 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.12338 | acc=0.9796 | tpr=0.9424 | fpr=0.0197 | 8025.8 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.12779 | acc=0.9785 | tpr=0.9424 | fpr=0.0208 | 8002.5 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.13058 | acc=0.9783 | tpr=0.9443 | fpr=0.0211 | 7929.1 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.12945 | acc=0.9782 | tpr=0.9397 | fpr=0.0211 | 7986.5 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.13173 | acc=0.9779 | tpr=0.9396 | fpr=0.0214 | 8065.5 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.13165 | acc=0.9778 | tpr=0.9380 | fpr=0.0215 | 8054.2 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.13340 | acc=0.9776 | tpr=0.9333 | fpr=0.0216 | 8039.1 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.13619 | acc=0.9773 | tpr=0.9323 | fpr=0.0219 | 7834.3 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.13568 | acc=0.9772 | tpr=0.9317 | fpr=0.0219 | 7824.7 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.13467 | acc=0.9774 | tpr=0.9312 | fpr=0.0218 | 14253.0 samples/s | 55.7 steps/s
Avg test loss: 0.13444, Avg test acc: 0.97739, Avg tpr: 0.93106, Avg fpr: 0.02176, total FA: 3022

server round 19/50

clients selected: [1 6 7 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=26001 Epoch=126.9] | Loss=0.01575 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.364 | L2-Norm(final)=9.867 | 3767.9 samples/s | 58.9 steps/s
[Step=26050 Epoch=127.1] | Loss=0.02807 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.415 | L2-Norm(final)=9.844 | 4869.2 samples/s | 76.1 steps/s
[Step=26100 Epoch=127.4] | Loss=0.02625 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.476 | L2-Norm(final)=9.843 | 5151.8 samples/s | 80.5 steps/s
[Step=26150 Epoch=127.6] | Loss=0.02473 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.533 | L2-Norm(final)=9.854 | 5006.9 samples/s | 78.2 steps/s
[Step=26200 Epoch=127.8] | Loss=0.02359 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.583 | L2-Norm(final)=9.866 | 7215.5 samples/s | 112.7 steps/s
[Step=26250 Epoch=128.1] | Loss=0.02217 | Reg=0.00160 | acc=0.9688 | L2-Norm=12.630 | L2-Norm(final)=9.881 | 1797.8 samples/s | 28.1 steps/s
[Step=26300 Epoch=128.3] | Loss=0.02092 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.676 | L2-Norm(final)=9.901 | 5245.3 samples/s | 82.0 steps/s
[Step=26350 Epoch=128.6] | Loss=0.02008 | Reg=0.00162 | acc=0.9688 | L2-Norm=12.722 | L2-Norm(final)=9.922 | 5148.8 samples/s | 80.5 steps/s
[Step=26400 Epoch=128.8] | Loss=0.01924 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.765 | L2-Norm(final)=9.944 | 6036.3 samples/s | 94.3 steps/s
[Step=26450 Epoch=129.1] | Loss=0.01839 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.807 | L2-Norm(final)=9.967 | 1834.3 samples/s | 28.7 steps/s
[Step=26500 Epoch=129.3] | Loss=0.01751 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.847 | L2-Norm(final)=9.992 | 4649.5 samples/s | 72.6 steps/s
All layers training...
LR=0.00050, len=1
[Step=26501 Epoch=129.3] | Loss=0.01614 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.236 | L2-Norm(final)=10.238 | 3438.8 samples/s | 53.7 steps/s
[Step=26550 Epoch=129.6] | Loss=0.02118 | Reg=0.00176 | acc=0.9531 | L2-Norm=13.280 | L2-Norm(final)=10.259 | 4054.7 samples/s | 63.4 steps/s
[Step=26600 Epoch=129.8] | Loss=0.03377 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.356 | L2-Norm(final)=10.246 | 4083.6 samples/s | 63.8 steps/s
[Step=26650 Epoch=130.0] | Loss=0.03836 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.428 | L2-Norm(final)=10.229 | 4204.3 samples/s | 65.7 steps/s
[Step=26700 Epoch=130.3] | Loss=0.03698 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.484 | L2-Norm(final)=10.217 | 5609.6 samples/s | 87.6 steps/s
[Step=26750 Epoch=130.5] | Loss=0.03255 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.528 | L2-Norm(final)=10.212 | 1639.8 samples/s | 25.6 steps/s
[Step=26800 Epoch=130.8] | Loss=0.02996 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.563 | L2-Norm(final)=10.211 | 4095.6 samples/s | 64.0 steps/s
[Step=26850 Epoch=131.0] | Loss=0.02770 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.594 | L2-Norm(final)=10.213 | 4477.9 samples/s | 70.0 steps/s
[Step=26900 Epoch=131.3] | Loss=0.02616 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.620 | L2-Norm(final)=10.214 | 6086.9 samples/s | 95.1 steps/s
[Step=26950 Epoch=131.5] | Loss=0.02440 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.643 | L2-Norm(final)=10.215 | 1848.1 samples/s | 28.9 steps/s
[Step=27000 Epoch=131.7] | Loss=0.02298 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.663 | L2-Norm(final)=10.216 | 4569.4 samples/s | 71.4 steps/s
[Step=27050 Epoch=132.0] | Loss=0.02217 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.681 | L2-Norm(final)=10.218 | 4604.2 samples/s | 71.9 steps/s
[Step=27100 Epoch=132.2] | Loss=0.02109 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.697 | L2-Norm(final)=10.219 | 5352.6 samples/s | 83.6 steps/s
[Step=27150 Epoch=132.5] | Loss=0.02042 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.711 | L2-Norm(final)=10.221 | 1785.6 samples/s | 27.9 steps/s
[Step=27200 Epoch=132.7] | Loss=0.01951 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.724 | L2-Norm(final)=10.222 | 4617.5 samples/s | 72.1 steps/s
[Step=27250 Epoch=133.0] | Loss=0.01870 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.736 | L2-Norm(final)=10.224 | 4572.2 samples/s | 71.4 steps/s
[Step=27300 Epoch=133.2] | Loss=0.01811 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.747 | L2-Norm(final)=10.225 | 5058.2 samples/s | 79.0 steps/s
[Step=27350 Epoch=133.5] | Loss=0.01764 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.756 | L2-Norm(final)=10.227 | 1823.8 samples/s | 28.5 steps/s
[Step=27400 Epoch=133.7] | Loss=0.01699 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.765 | L2-Norm(final)=10.227 | 4585.4 samples/s | 71.6 steps/s
[Step=27450 Epoch=133.9] | Loss=0.01648 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.773 | L2-Norm(final)=10.229 | 4613.3 samples/s | 72.1 steps/s
[Step=27500 Epoch=134.2] | Loss=0.01587 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.780 | L2-Norm(final)=10.230 | 4836.0 samples/s | 75.6 steps/s
[Step=27550 Epoch=134.4] | Loss=0.01530 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.786 | L2-Norm(final)=10.232 | 1870.2 samples/s | 29.2 steps/s
[Step=27600 Epoch=134.7] | Loss=0.01477 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.792 | L2-Norm(final)=10.234 | 4682.1 samples/s | 73.2 steps/s
[Step=27650 Epoch=134.9] | Loss=0.01441 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.798 | L2-Norm(final)=10.236 | 4597.1 samples/s | 71.8 steps/s
[Step=27700 Epoch=135.2] | Loss=0.01408 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=10.238 | 4570.1 samples/s | 71.4 steps/s
[Step=27750 Epoch=135.4] | Loss=0.01368 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.807 | L2-Norm(final)=10.239 | 1909.0 samples/s | 29.8 steps/s
[Step=27800 Epoch=135.7] | Loss=0.01330 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.812 | L2-Norm(final)=10.241 | 4779.0 samples/s | 74.7 steps/s
[Step=27850 Epoch=135.9] | Loss=0.01297 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.816 | L2-Norm(final)=10.243 | 4494.9 samples/s | 70.2 steps/s
[Step=27900 Epoch=136.1] | Loss=0.01262 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.820 | L2-Norm(final)=10.245 | 4612.2 samples/s | 72.1 steps/s
[Step=27950 Epoch=136.4] | Loss=0.01239 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.823 | L2-Norm(final)=10.247 | 1916.2 samples/s | 29.9 steps/s
[Step=28000 Epoch=136.6] | Loss=0.01211 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.826 | L2-Norm(final)=10.249 | 4755.9 samples/s | 74.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step28000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=20001 Epoch=190.3] | Loss=0.00311 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.364 | L2-Norm(final)=7.843 | 3590.6 samples/s | 56.1 steps/s
[Step=20050 Epoch=190.7] | Loss=0.00661 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.565 | L2-Norm(final)=7.828 | 4826.1 samples/s | 75.4 steps/s
[Step=20100 Epoch=191.2] | Loss=0.00387 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.689 | L2-Norm(final)=7.845 | 6780.2 samples/s | 105.9 steps/s
[Step=20150 Epoch=191.7] | Loss=0.00264 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.739 | L2-Norm(final)=7.866 | 1741.5 samples/s | 27.2 steps/s
[Step=20200 Epoch=192.2] | Loss=0.00205 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.757 | L2-Norm(final)=7.883 | 6278.5 samples/s | 98.1 steps/s
[Step=20250 Epoch=192.6] | Loss=0.00166 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.764 | L2-Norm(final)=7.898 | 1788.1 samples/s | 27.9 steps/s
[Step=20300 Epoch=193.1] | Loss=0.00140 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.763 | L2-Norm(final)=7.911 | 5612.9 samples/s | 87.7 steps/s
[Step=20350 Epoch=193.6] | Loss=0.00122 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.757 | L2-Norm(final)=7.923 | 1839.3 samples/s | 28.7 steps/s
[Step=20400 Epoch=194.1] | Loss=0.00107 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.749 | L2-Norm(final)=7.934 | 5378.9 samples/s | 84.0 steps/s
[Step=20450 Epoch=194.5] | Loss=0.00096 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.740 | L2-Norm(final)=7.944 | 1841.0 samples/s | 28.8 steps/s
[Step=20500 Epoch=195.0] | Loss=0.00087 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.729 | L2-Norm(final)=7.954 | 4985.6 samples/s | 77.9 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=195.0] | Loss=0.00015 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.616 | L2-Norm(final)=8.048 | 3673.8 samples/s | 57.4 steps/s
[Step=20550 Epoch=195.5] | Loss=0.00004 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.592 | L2-Norm(final)=8.054 | 4040.2 samples/s | 63.1 steps/s
[Step=20600 Epoch=196.0] | Loss=0.00004 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.563 | L2-Norm(final)=8.058 | 5932.4 samples/s | 92.7 steps/s
[Step=20650 Epoch=196.4] | Loss=0.00003 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.534 | L2-Norm(final)=8.062 | 1654.7 samples/s | 25.9 steps/s
[Step=20700 Epoch=196.9] | Loss=0.00002 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.503 | L2-Norm(final)=8.064 | 5198.5 samples/s | 81.2 steps/s
[Step=20750 Epoch=197.4] | Loss=0.00002 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.472 | L2-Norm(final)=8.065 | 1742.2 samples/s | 27.2 steps/s
[Step=20800 Epoch=197.9] | Loss=0.00002 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.440 | L2-Norm(final)=8.067 | 5253.3 samples/s | 82.1 steps/s
[Step=20850 Epoch=198.3] | Loss=0.00001 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.409 | L2-Norm(final)=8.068 | 1807.0 samples/s | 28.2 steps/s
[Step=20900 Epoch=198.8] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.378 | L2-Norm(final)=8.069 | 4815.1 samples/s | 75.2 steps/s
[Step=20950 Epoch=199.3] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.347 | L2-Norm(final)=8.070 | 1828.8 samples/s | 28.6 steps/s
[Step=21000 Epoch=199.8] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.316 | L2-Norm(final)=8.071 | 4540.9 samples/s | 71.0 steps/s
[Step=21050 Epoch=200.2] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.285 | L2-Norm(final)=8.072 | 1868.1 samples/s | 29.2 steps/s
[Step=21100 Epoch=200.7] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.254 | L2-Norm(final)=8.073 | 4382.8 samples/s | 68.5 steps/s
[Step=21150 Epoch=201.2] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=8.074 | 1870.9 samples/s | 29.2 steps/s
[Step=21200 Epoch=201.7] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.192 | L2-Norm(final)=8.075 | 4394.3 samples/s | 68.7 steps/s
[Step=21250 Epoch=202.1] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=8.076 | 1888.9 samples/s | 29.5 steps/s
[Step=21300 Epoch=202.6] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.131 | L2-Norm(final)=8.077 | 4527.0 samples/s | 70.7 steps/s
[Step=21350 Epoch=203.1] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.100 | L2-Norm(final)=8.078 | 1923.5 samples/s | 30.1 steps/s
[Step=21400 Epoch=203.6] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=8.078 | 4340.4 samples/s | 67.8 steps/s
[Step=21450 Epoch=204.0] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.039 | L2-Norm(final)=8.079 | 6535.7 samples/s | 102.1 steps/s
[Step=21500 Epoch=204.5] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.009 | L2-Norm(final)=8.080 | 1659.1 samples/s | 25.9 steps/s
[Step=21550 Epoch=205.0] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.978 | L2-Norm(final)=8.081 | 5376.7 samples/s | 84.0 steps/s
[Step=21600 Epoch=205.5] | Loss=0.00001 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.948 | L2-Norm(final)=8.082 | 1692.9 samples/s | 26.5 steps/s
[Step=21650 Epoch=205.9] | Loss=0.00001 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.917 | L2-Norm(final)=8.083 | 5290.9 samples/s | 82.7 steps/s
[Step=21700 Epoch=206.4] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.887 | L2-Norm(final)=8.084 | 1766.1 samples/s | 27.6 steps/s
[Step=21750 Epoch=206.9] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.856 | L2-Norm(final)=8.084 | 4963.9 samples/s | 77.6 steps/s
[Step=21800 Epoch=207.4] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=8.085 | 1780.4 samples/s | 27.8 steps/s
[Step=21850 Epoch=207.8] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.795 | L2-Norm(final)=8.086 | 4658.4 samples/s | 72.8 steps/s
[Step=21900 Epoch=208.3] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.764 | L2-Norm(final)=8.087 | 1854.6 samples/s | 29.0 steps/s
[Step=21950 Epoch=208.8] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.734 | L2-Norm(final)=8.088 | 4491.1 samples/s | 70.2 steps/s
[Step=22000 Epoch=209.3] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.703 | L2-Norm(final)=8.089 | 1825.9 samples/s | 28.5 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step22000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=20001 Epoch=191.0] | Loss=0.00339 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.364 | L2-Norm(final)=7.239 | 3870.5 samples/s | 60.5 steps/s
[Step=20050 Epoch=191.5] | Loss=0.00323 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=7.240 | 4131.4 samples/s | 64.6 steps/s
[Step=20100 Epoch=191.9] | Loss=0.00221 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.563 | L2-Norm(final)=7.260 | 6561.8 samples/s | 102.5 steps/s
[Step=20150 Epoch=192.4] | Loss=0.00152 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.595 | L2-Norm(final)=7.276 | 1713.6 samples/s | 26.8 steps/s
[Step=20200 Epoch=192.9] | Loss=0.00117 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.603 | L2-Norm(final)=7.288 | 5985.6 samples/s | 93.5 steps/s
[Step=20250 Epoch=193.4] | Loss=0.00095 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.601 | L2-Norm(final)=7.298 | 1762.8 samples/s | 27.5 steps/s
[Step=20300 Epoch=193.9] | Loss=0.00080 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.596 | L2-Norm(final)=7.306 | 5626.9 samples/s | 87.9 steps/s
[Step=20350 Epoch=194.3] | Loss=0.00070 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.587 | L2-Norm(final)=7.314 | 1756.0 samples/s | 27.4 steps/s
[Step=20400 Epoch=194.8] | Loss=0.00062 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.578 | L2-Norm(final)=7.321 | 5867.9 samples/s | 91.7 steps/s
[Step=20450 Epoch=195.3] | Loss=0.00056 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.567 | L2-Norm(final)=7.328 | 1844.6 samples/s | 28.8 steps/s
[Step=20500 Epoch=195.8] | Loss=0.00050 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.555 | L2-Norm(final)=7.334 | 5062.5 samples/s | 79.1 steps/s
All layers training...
LR=0.00050, len=1
[Step=20501 Epoch=195.8] | Loss=0.00002 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.438 | L2-Norm(final)=7.396 | 3747.6 samples/s | 58.6 steps/s
[Step=20550 Epoch=196.2] | Loss=0.00004 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.420 | L2-Norm(final)=7.400 | 4057.1 samples/s | 63.4 steps/s
[Step=20600 Epoch=196.7] | Loss=0.00003 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.400 | L2-Norm(final)=7.404 | 5855.7 samples/s | 91.5 steps/s
[Step=20650 Epoch=197.2] | Loss=0.00003 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.379 | L2-Norm(final)=7.407 | 1700.9 samples/s | 26.6 steps/s
[Step=20700 Epoch=197.7] | Loss=0.00002 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.358 | L2-Norm(final)=7.409 | 5645.4 samples/s | 88.2 steps/s
[Step=20750 Epoch=198.1] | Loss=0.00002 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.336 | L2-Norm(final)=7.411 | 1727.1 samples/s | 27.0 steps/s
[Step=20800 Epoch=198.6] | Loss=0.00002 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.314 | L2-Norm(final)=7.413 | 5154.2 samples/s | 80.5 steps/s
[Step=20850 Epoch=199.1] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=7.414 | 1762.6 samples/s | 27.5 steps/s
[Step=20900 Epoch=199.6] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.270 | L2-Norm(final)=7.415 | 4808.8 samples/s | 75.1 steps/s
[Step=20950 Epoch=200.1] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.248 | L2-Norm(final)=7.416 | 1770.8 samples/s | 27.7 steps/s
[Step=21000 Epoch=200.5] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.226 | L2-Norm(final)=7.418 | 4699.9 samples/s | 73.4 steps/s
[Step=21050 Epoch=201.0] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.204 | L2-Norm(final)=7.419 | 1818.4 samples/s | 28.4 steps/s
[Step=21100 Epoch=201.5] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.182 | L2-Norm(final)=7.420 | 4542.4 samples/s | 71.0 steps/s
[Step=21150 Epoch=202.0] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=7.421 | 1802.5 samples/s | 28.2 steps/s
[Step=21200 Epoch=202.4] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=7.422 | 4286.8 samples/s | 67.0 steps/s
[Step=21250 Epoch=202.9] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.115 | L2-Norm(final)=7.423 | 1820.2 samples/s | 28.4 steps/s
[Step=21300 Epoch=203.4] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.093 | L2-Norm(final)=7.424 | 4274.9 samples/s | 66.8 steps/s
[Step=21350 Epoch=203.9] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.071 | L2-Norm(final)=7.425 | 1844.8 samples/s | 28.8 steps/s
[Step=21400 Epoch=204.4] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.049 | L2-Norm(final)=7.426 | 4383.4 samples/s | 68.5 steps/s
[Step=21450 Epoch=204.8] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.026 | L2-Norm(final)=7.426 | 1859.2 samples/s | 29.1 steps/s
[Step=21500 Epoch=205.3] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.004 | L2-Norm(final)=7.427 | 4175.1 samples/s | 65.2 steps/s
[Step=21550 Epoch=205.8] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.982 | L2-Norm(final)=7.428 | 6268.4 samples/s | 97.9 steps/s
[Step=21600 Epoch=206.3] | Loss=0.00001 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.959 | L2-Norm(final)=7.429 | 1636.8 samples/s | 25.6 steps/s
[Step=21650 Epoch=206.7] | Loss=0.00001 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.937 | L2-Norm(final)=7.430 | 5905.3 samples/s | 92.3 steps/s
[Step=21700 Epoch=207.2] | Loss=0.00001 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.914 | L2-Norm(final)=7.431 | 1702.5 samples/s | 26.6 steps/s
[Step=21750 Epoch=207.7] | Loss=0.00001 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.892 | L2-Norm(final)=7.432 | 5607.1 samples/s | 87.6 steps/s
[Step=21800 Epoch=208.2] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.869 | L2-Norm(final)=7.433 | 1716.4 samples/s | 26.8 steps/s
[Step=21850 Epoch=208.7] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.847 | L2-Norm(final)=7.434 | 5131.9 samples/s | 80.2 steps/s
[Step=21900 Epoch=209.1] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=7.434 | 1758.5 samples/s | 27.5 steps/s
[Step=21950 Epoch=209.6] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.801 | L2-Norm(final)=7.435 | 4854.4 samples/s | 75.8 steps/s
[Step=22000 Epoch=210.1] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.778 | L2-Norm(final)=7.436 | 1773.0 samples/s | 27.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step22000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=16001 Epoch=150.8] | Loss=0.00191 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.364 | L2-Norm(final)=7.565 | 3871.2 samples/s | 60.5 steps/s
[Step=16050 Epoch=151.2] | Loss=0.00881 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.682 | L2-Norm(final)=7.555 | 4176.2 samples/s | 65.3 steps/s
[Step=16100 Epoch=151.7] | Loss=0.00523 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.823 | L2-Norm(final)=7.561 | 6915.5 samples/s | 108.1 steps/s
[Step=16150 Epoch=152.2] | Loss=0.00369 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.884 | L2-Norm(final)=7.576 | 1679.7 samples/s | 26.2 steps/s
[Step=16200 Epoch=152.7] | Loss=0.00285 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.909 | L2-Norm(final)=7.588 | 6126.9 samples/s | 95.7 steps/s
[Step=16250 Epoch=153.1] | Loss=0.00232 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.920 | L2-Norm(final)=7.599 | 1750.8 samples/s | 27.4 steps/s
[Step=16300 Epoch=153.6] | Loss=0.00196 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.922 | L2-Norm(final)=7.609 | 5342.1 samples/s | 83.5 steps/s
[Step=16350 Epoch=154.1] | Loss=0.00169 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.919 | L2-Norm(final)=7.617 | 1820.4 samples/s | 28.4 steps/s
[Step=16400 Epoch=154.5] | Loss=0.00150 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.913 | L2-Norm(final)=7.625 | 5094.3 samples/s | 79.6 steps/s
[Step=16450 Epoch=155.0] | Loss=0.00134 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=7.632 | 1887.8 samples/s | 29.5 steps/s
[Step=16500 Epoch=155.5] | Loss=0.00122 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.895 | L2-Norm(final)=7.639 | 4926.6 samples/s | 77.0 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=155.5] | Loss=0.00005 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.795 | L2-Norm(final)=7.707 | 3666.1 samples/s | 57.3 steps/s
[Step=16550 Epoch=155.9] | Loss=0.00012 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.777 | L2-Norm(final)=7.713 | 4053.2 samples/s | 63.3 steps/s
[Step=16600 Epoch=156.4] | Loss=0.00009 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.754 | L2-Norm(final)=7.718 | 5836.1 samples/s | 91.2 steps/s
[Step=16650 Epoch=156.9] | Loss=0.00007 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.730 | L2-Norm(final)=7.722 | 1694.5 samples/s | 26.5 steps/s
[Step=16700 Epoch=157.4] | Loss=0.00005 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.703 | L2-Norm(final)=7.725 | 5345.5 samples/s | 83.5 steps/s
[Step=16750 Epoch=157.8] | Loss=0.00004 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=7.726 | 1736.1 samples/s | 27.1 steps/s
[Step=16800 Epoch=158.3] | Loss=0.00004 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.646 | L2-Norm(final)=7.728 | 5015.1 samples/s | 78.4 steps/s
[Step=16850 Epoch=158.8] | Loss=0.00003 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.617 | L2-Norm(final)=7.729 | 1834.6 samples/s | 28.7 steps/s
[Step=16900 Epoch=159.2] | Loss=0.00003 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.588 | L2-Norm(final)=7.730 | 4449.0 samples/s | 69.5 steps/s
[Step=16950 Epoch=159.7] | Loss=0.00002 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.558 | L2-Norm(final)=7.730 | 1840.5 samples/s | 28.8 steps/s
[Step=17000 Epoch=160.2] | Loss=0.00002 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=7.731 | 4457.4 samples/s | 69.6 steps/s
[Step=17050 Epoch=160.7] | Loss=0.00002 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=7.731 | 1901.5 samples/s | 29.7 steps/s
[Step=17100 Epoch=161.1] | Loss=0.00002 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.468 | L2-Norm(final)=7.732 | 4347.1 samples/s | 67.9 steps/s
[Step=17150 Epoch=161.6] | Loss=0.00002 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.438 | L2-Norm(final)=7.732 | 1903.6 samples/s | 29.7 steps/s
[Step=17200 Epoch=162.1] | Loss=0.00002 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.408 | L2-Norm(final)=7.733 | 4400.3 samples/s | 68.8 steps/s
[Step=17250 Epoch=162.5] | Loss=0.00002 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.378 | L2-Norm(final)=7.733 | 1978.1 samples/s | 30.9 steps/s
[Step=17300 Epoch=163.0] | Loss=0.00001 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.348 | L2-Norm(final)=7.734 | 3800.4 samples/s | 59.4 steps/s
[Step=17350 Epoch=163.5] | Loss=0.00001 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.317 | L2-Norm(final)=7.734 | 5994.8 samples/s | 93.7 steps/s
[Step=17400 Epoch=164.0] | Loss=0.00001 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=7.735 | 1693.4 samples/s | 26.5 steps/s
[Step=17450 Epoch=164.4] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=7.735 | 5491.7 samples/s | 85.8 steps/s
[Step=17500 Epoch=164.9] | Loss=0.00001 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.226 | L2-Norm(final)=7.735 | 1717.0 samples/s | 26.8 steps/s
[Step=17550 Epoch=165.4] | Loss=0.00001 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.196 | L2-Norm(final)=7.736 | 4927.6 samples/s | 77.0 steps/s
[Step=17600 Epoch=165.8] | Loss=0.00001 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=7.736 | 1783.7 samples/s | 27.9 steps/s
[Step=17650 Epoch=166.3] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=7.736 | 4673.0 samples/s | 73.0 steps/s
[Step=17700 Epoch=166.8] | Loss=0.00001 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.104 | L2-Norm(final)=7.737 | 1833.5 samples/s | 28.6 steps/s
[Step=17750 Epoch=167.3] | Loss=0.00001 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=7.737 | 4378.0 samples/s | 68.4 steps/s
[Step=17800 Epoch=167.7] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.042 | L2-Norm(final)=7.738 | 1867.7 samples/s | 29.2 steps/s
[Step=17850 Epoch=168.2] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.011 | L2-Norm(final)=7.738 | 4496.2 samples/s | 70.3 steps/s
[Step=17900 Epoch=168.7] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.980 | L2-Norm(final)=7.738 | 1876.5 samples/s | 29.3 steps/s
[Step=17950 Epoch=169.1] | Loss=0.00001 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.949 | L2-Norm(final)=7.739 | 4325.2 samples/s | 67.6 steps/s
[Step=18000 Epoch=169.6] | Loss=0.00001 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.918 | L2-Norm(final)=7.739 | 1901.7 samples/s | 29.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step18000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00050, len=1
[Step=16001 Epoch=152.5] | Loss=0.05522 | Reg=0.00153 | acc=0.9531 | L2-Norm=12.364 | L2-Norm(final)=7.662 | 3601.2 samples/s | 56.3 steps/s
[Step=16050 Epoch=153.0] | Loss=0.00683 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.646 | L2-Norm(final)=7.650 | 4676.8 samples/s | 73.1 steps/s
[Step=16100 Epoch=153.4] | Loss=0.00452 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.776 | L2-Norm(final)=7.676 | 6986.3 samples/s | 109.2 steps/s
[Step=16150 Epoch=153.9] | Loss=0.00316 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.836 | L2-Norm(final)=7.699 | 1809.2 samples/s | 28.3 steps/s
[Step=16200 Epoch=154.4] | Loss=0.00242 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.864 | L2-Norm(final)=7.716 | 6555.4 samples/s | 102.4 steps/s
[Step=16250 Epoch=154.9] | Loss=0.00196 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.874 | L2-Norm(final)=7.731 | 1781.0 samples/s | 27.8 steps/s
[Step=16300 Epoch=155.4] | Loss=0.00167 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.875 | L2-Norm(final)=7.743 | 6057.3 samples/s | 94.6 steps/s
[Step=16350 Epoch=155.8] | Loss=0.00144 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.872 | L2-Norm(final)=7.755 | 1842.6 samples/s | 28.8 steps/s
[Step=16400 Epoch=156.3] | Loss=0.00128 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.866 | L2-Norm(final)=7.765 | 5479.2 samples/s | 85.6 steps/s
[Step=16450 Epoch=156.8] | Loss=0.00115 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.857 | L2-Norm(final)=7.775 | 1775.3 samples/s | 27.7 steps/s
[Step=16500 Epoch=157.3] | Loss=0.00104 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.847 | L2-Norm(final)=7.785 | 5273.9 samples/s | 82.4 steps/s
All layers training...
LR=0.00050, len=1
[Step=16501 Epoch=157.3] | Loss=0.00011 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.742 | L2-Norm(final)=7.873 | 3797.8 samples/s | 59.3 steps/s
[Step=16550 Epoch=157.7] | Loss=0.00021 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.724 | L2-Norm(final)=7.880 | 4020.7 samples/s | 62.8 steps/s
[Step=16600 Epoch=158.2] | Loss=0.00859 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.782 | L2-Norm(final)=7.877 | 5998.6 samples/s | 93.7 steps/s
[Step=16650 Epoch=158.7] | Loss=0.00826 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.937 | L2-Norm(final)=7.840 | 1703.5 samples/s | 26.6 steps/s
[Step=16700 Epoch=159.2] | Loss=0.00665 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.025 | L2-Norm(final)=7.821 | 5705.4 samples/s | 89.1 steps/s
[Step=16750 Epoch=159.6] | Loss=0.00548 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.075 | L2-Norm(final)=7.810 | 1695.9 samples/s | 26.5 steps/s
[Step=16800 Epoch=160.1] | Loss=0.00458 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.105 | L2-Norm(final)=7.804 | 5237.4 samples/s | 81.8 steps/s
[Step=16850 Epoch=160.6] | Loss=0.00393 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.123 | L2-Norm(final)=7.801 | 1761.8 samples/s | 27.5 steps/s
[Step=16900 Epoch=161.1] | Loss=0.00344 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.132 | L2-Norm(final)=7.798 | 4901.9 samples/s | 76.6 steps/s
[Step=16950 Epoch=161.5] | Loss=0.00306 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.137 | L2-Norm(final)=7.797 | 1756.0 samples/s | 27.4 steps/s
[Step=17000 Epoch=162.0] | Loss=0.00276 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.137 | L2-Norm(final)=7.796 | 4616.5 samples/s | 72.1 steps/s
[Step=17050 Epoch=162.5] | Loss=0.00251 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.135 | L2-Norm(final)=7.795 | 1801.2 samples/s | 28.1 steps/s
[Step=17100 Epoch=163.0] | Loss=0.00230 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.131 | L2-Norm(final)=7.795 | 4208.1 samples/s | 65.8 steps/s
[Step=17150 Epoch=163.5] | Loss=0.00213 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.125 | L2-Norm(final)=7.794 | 1871.1 samples/s | 29.2 steps/s
[Step=17200 Epoch=163.9] | Loss=0.00198 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.118 | L2-Norm(final)=7.794 | 4397.4 samples/s | 68.7 steps/s
[Step=17250 Epoch=164.4] | Loss=0.00184 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.109 | L2-Norm(final)=7.794 | 1839.7 samples/s | 28.7 steps/s
[Step=17300 Epoch=164.9] | Loss=0.00173 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.100 | L2-Norm(final)=7.795 | 4462.0 samples/s | 69.7 steps/s
[Step=17350 Epoch=165.4] | Loss=0.00163 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.091 | L2-Norm(final)=7.795 | 1891.2 samples/s | 29.5 steps/s
[Step=17400 Epoch=165.8] | Loss=0.00154 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.080 | L2-Norm(final)=7.795 | 4481.8 samples/s | 70.0 steps/s
[Step=17450 Epoch=166.3] | Loss=0.00146 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.070 | L2-Norm(final)=7.795 | 1876.3 samples/s | 29.3 steps/s
[Step=17500 Epoch=166.8] | Loss=0.00139 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.058 | L2-Norm(final)=7.796 | 4510.1 samples/s | 70.5 steps/s
[Step=17550 Epoch=167.3] | Loss=0.00132 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.047 | L2-Norm(final)=7.796 | 6378.4 samples/s | 99.7 steps/s
[Step=17600 Epoch=167.7] | Loss=0.00126 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.035 | L2-Norm(final)=7.796 | 1667.6 samples/s | 26.1 steps/s
[Step=17650 Epoch=168.2] | Loss=0.00121 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.023 | L2-Norm(final)=7.797 | 5815.9 samples/s | 90.9 steps/s
[Step=17700 Epoch=168.7] | Loss=0.00116 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.010 | L2-Norm(final)=7.797 | 1704.6 samples/s | 26.6 steps/s
[Step=17750 Epoch=169.2] | Loss=0.00111 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.997 | L2-Norm(final)=7.798 | 5647.8 samples/s | 88.2 steps/s
[Step=17800 Epoch=169.7] | Loss=0.00107 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.985 | L2-Norm(final)=7.798 | 1738.6 samples/s | 27.2 steps/s
[Step=17850 Epoch=170.1] | Loss=0.00103 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.971 | L2-Norm(final)=7.798 | 5270.6 samples/s | 82.4 steps/s
[Step=17900 Epoch=170.6] | Loss=0.00099 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.958 | L2-Norm(final)=7.799 | 1746.8 samples/s | 27.3 steps/s
[Step=17950 Epoch=171.1] | Loss=0.00096 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.945 | L2-Norm(final)=7.799 | 5081.7 samples/s | 79.4 steps/s
[Step=18000 Epoch=171.6] | Loss=0.00093 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.931 | L2-Norm(final)=7.800 | 1805.2 samples/s | 28.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step18000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.11028 | acc=0.9548 | tpr=0.9703 | fpr=0.0790 | 4170.2 samples/s | 16.3 steps/s
Avg test loss: 0.11329, Avg test acc: 0.95256, Avg tpr: 0.96888, Avg fpr: 0.08332, total FA: 650

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.10444 | acc=0.9557 | tpr=0.9715 | fpr=0.0785 | 4114.9 samples/s | 16.1 steps/s
Avg test loss: 0.11036, Avg test acc: 0.95404, Avg tpr: 0.97127, Avg fpr: 0.08384, total FA: 654

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11099 | acc=0.9528 | tpr=0.9596 | fpr=0.0619 | 4000.3 samples/s | 15.6 steps/s
Avg test loss: 0.11841, Avg test acc: 0.95104, Avg tpr: 0.95693, Avg fpr: 0.06192, total FA: 483

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.12420 | acc=0.9541 | tpr=0.9744 | fpr=0.0902 | 4112.0 samples/s | 16.1 steps/s
Avg test loss: 0.12746, Avg test acc: 0.95344, Avg tpr: 0.97366, Avg fpr: 0.09101, total FA: 710

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10654 | acc=0.9534 | tpr=0.9630 | fpr=0.0676 | 4104.0 samples/s | 16.0 steps/s
Avg test loss: 0.11088, Avg test acc: 0.95228, Avg tpr: 0.96241, Avg fpr: 0.06999, total FA: 546

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.52270 | acc=0.2786 | tpr=0.0048 | fpr=0.1269 | 4174.4 samples/s | 16.3 steps/s
Avg test loss: 4.54036, Avg test acc: 0.27691, Avg tpr: 0.00635, Avg fpr: 0.12806, total FA: 999

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.64540 | acc=0.3099 | tpr=0.0078 | fpr=0.0339 | 4156.8 samples/s | 16.2 steps/s
Avg test loss: 4.65759, Avg test acc: 0.30744, Avg tpr: 0.00839, Avg fpr: 0.03487, total FA: 272

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.77352 | acc=0.2845 | tpr=0.0084 | fpr=0.1162 | 4138.0 samples/s | 16.2 steps/s
Avg test loss: 4.78437, Avg test acc: 0.28436, Avg tpr: 0.01037, Avg fpr: 0.11306, total FA: 882

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.01390 | acc=0.2974 | tpr=0.0071 | fpr=0.0721 | 4070.5 samples/s | 15.9 steps/s
Avg test loss: 5.02218, Avg test acc: 0.29598, Avg tpr: 0.00775, Avg fpr: 0.07012, total FA: 547

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.43961 | acc=0.3132 | tpr=0.0017 | fpr=0.0104 | 4065.7 samples/s | 15.9 steps/s
Avg test loss: 4.44392, Avg test acc: 0.31140, Avg tpr: 0.00204, Avg fpr: 0.00820, total FA: 64

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.34561 | acc=0.1074 | tpr=0.7566 | fpr=0.9042 | 4095.8 samples/s | 16.0 steps/s
[Step= 100] | Loss=5.31624 | acc=0.1106 | tpr=0.7015 | fpr=0.9004 | 8212.9 samples/s | 32.1 steps/s
[Step= 150] | Loss=5.32847 | acc=0.1090 | tpr=0.6931 | fpr=0.9017 | 7786.7 samples/s | 30.4 steps/s
[Step= 200] | Loss=5.32742 | acc=0.1085 | tpr=0.6852 | fpr=0.9020 | 8222.6 samples/s | 32.1 steps/s
[Step= 250] | Loss=5.32730 | acc=0.1088 | tpr=0.6873 | fpr=0.9017 | 7734.5 samples/s | 30.2 steps/s
[Step= 300] | Loss=5.32222 | acc=0.1086 | tpr=0.6953 | fpr=0.9021 | 7901.0 samples/s | 30.9 steps/s
[Step= 350] | Loss=5.31844 | acc=0.1085 | tpr=0.6888 | fpr=0.9020 | 8359.0 samples/s | 32.7 steps/s
[Step= 400] | Loss=5.32165 | acc=0.1093 | tpr=0.6860 | fpr=0.9011 | 7740.2 samples/s | 30.2 steps/s
[Step= 450] | Loss=5.32201 | acc=0.1088 | tpr=0.6831 | fpr=0.9016 | 8177.1 samples/s | 31.9 steps/s
[Step= 500] | Loss=5.32370 | acc=0.1088 | tpr=0.6775 | fpr=0.9015 | 8100.3 samples/s | 31.6 steps/s
[Step= 550] | Loss=5.32538 | acc=0.1084 | tpr=0.6809 | fpr=0.9020 | 15210.3 samples/s | 59.4 steps/s
Avg test loss: 5.32713, Avg test acc: 0.10829, Avg tpr: 0.68067, Avg fpr: 0.90212, total FA: 125257

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.66983 | acc=0.1146 | tpr=0.6770 | fpr=0.8955 | 3965.7 samples/s | 15.5 steps/s
[Step= 100] | Loss=5.61911 | acc=0.1159 | tpr=0.6205 | fpr=0.8936 | 8005.7 samples/s | 31.3 steps/s
[Step= 150] | Loss=5.63197 | acc=0.1143 | tpr=0.6124 | fpr=0.8948 | 8040.5 samples/s | 31.4 steps/s
[Step= 200] | Loss=5.62629 | acc=0.1143 | tpr=0.6186 | fpr=0.8949 | 8181.9 samples/s | 32.0 steps/s
[Step= 250] | Loss=5.62342 | acc=0.1144 | tpr=0.6166 | fpr=0.8948 | 8114.9 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.62544 | acc=0.1142 | tpr=0.6218 | fpr=0.8951 | 7673.1 samples/s | 30.0 steps/s
[Step= 350] | Loss=5.61948 | acc=0.1137 | tpr=0.6137 | fpr=0.8954 | 8431.7 samples/s | 32.9 steps/s
[Step= 400] | Loss=5.62034 | acc=0.1143 | tpr=0.6132 | fpr=0.8947 | 8309.3 samples/s | 32.5 steps/s
[Step= 450] | Loss=5.62431 | acc=0.1145 | tpr=0.6144 | fpr=0.8946 | 8178.8 samples/s | 31.9 steps/s
[Step= 500] | Loss=5.62830 | acc=0.1142 | tpr=0.6132 | fpr=0.8948 | 7965.1 samples/s | 31.1 steps/s
[Step= 550] | Loss=5.62853 | acc=0.1141 | tpr=0.6200 | fpr=0.8951 | 14435.3 samples/s | 56.4 steps/s
Avg test loss: 5.62952, Avg test acc: 0.11408, Avg tpr: 0.62084, Avg fpr: 0.89513, total FA: 124287

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.14776 | acc=0.1248 | tpr=0.6460 | fpr=0.8846 | 4036.0 samples/s | 15.8 steps/s
[Step= 100] | Loss=6.10154 | acc=0.1262 | tpr=0.6034 | fpr=0.8827 | 8210.9 samples/s | 32.1 steps/s
[Step= 150] | Loss=6.11920 | acc=0.1242 | tpr=0.6153 | fpr=0.8848 | 8437.0 samples/s | 33.0 steps/s
[Step= 200] | Loss=6.11919 | acc=0.1237 | tpr=0.6208 | fpr=0.8854 | 8281.0 samples/s | 32.3 steps/s
[Step= 250] | Loss=6.12245 | acc=0.1233 | tpr=0.6157 | fpr=0.8856 | 7969.4 samples/s | 31.1 steps/s
[Step= 300] | Loss=6.12204 | acc=0.1234 | tpr=0.6145 | fpr=0.8856 | 7758.3 samples/s | 30.3 steps/s
[Step= 350] | Loss=6.11866 | acc=0.1231 | tpr=0.6099 | fpr=0.8858 | 7894.4 samples/s | 30.8 steps/s
[Step= 400] | Loss=6.12116 | acc=0.1233 | tpr=0.6018 | fpr=0.8854 | 8181.0 samples/s | 32.0 steps/s
[Step= 450] | Loss=6.12255 | acc=0.1229 | tpr=0.5974 | fpr=0.8857 | 7854.1 samples/s | 30.7 steps/s
[Step= 500] | Loss=6.12258 | acc=0.1229 | tpr=0.5916 | fpr=0.8856 | 7772.2 samples/s | 30.4 steps/s
[Step= 550] | Loss=6.12254 | acc=0.1227 | tpr=0.5965 | fpr=0.8859 | 14773.8 samples/s | 57.7 steps/s
Avg test loss: 6.12411, Avg test acc: 0.12263, Avg tpr: 0.59628, Avg fpr: 0.88598, total FA: 123017

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.89480 | acc=0.1225 | tpr=0.6814 | fpr=0.8875 | 4070.6 samples/s | 15.9 steps/s
[Step= 100] | Loss=5.84119 | acc=0.1224 | tpr=0.6418 | fpr=0.8873 | 7920.6 samples/s | 30.9 steps/s
[Step= 150] | Loss=5.85543 | acc=0.1204 | tpr=0.6556 | fpr=0.8895 | 8203.6 samples/s | 32.0 steps/s
[Step= 200] | Loss=5.85217 | acc=0.1198 | tpr=0.6568 | fpr=0.8899 | 8166.1 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.85249 | acc=0.1204 | tpr=0.6585 | fpr=0.8894 | 7826.6 samples/s | 30.6 steps/s
[Step= 300] | Loss=5.84769 | acc=0.1205 | tpr=0.6538 | fpr=0.8892 | 7906.5 samples/s | 30.9 steps/s
[Step= 350] | Loss=5.84290 | acc=0.1205 | tpr=0.6493 | fpr=0.8891 | 8086.1 samples/s | 31.6 steps/s
[Step= 400] | Loss=5.84429 | acc=0.1208 | tpr=0.6515 | fpr=0.8888 | 7920.2 samples/s | 30.9 steps/s
[Step= 450] | Loss=5.85015 | acc=0.1208 | tpr=0.6480 | fpr=0.8887 | 8386.6 samples/s | 32.8 steps/s
[Step= 500] | Loss=5.85379 | acc=0.1205 | tpr=0.6441 | fpr=0.8889 | 8176.6 samples/s | 31.9 steps/s
[Step= 550] | Loss=5.85408 | acc=0.1204 | tpr=0.6442 | fpr=0.8891 | 13909.7 samples/s | 54.3 steps/s
Avg test loss: 5.85577, Avg test acc: 0.12034, Avg tpr: 0.64422, Avg fpr: 0.88918, total FA: 123461

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.00482 | acc=0.1340 | tpr=0.6858 | fpr=0.8759 | 4177.0 samples/s | 16.3 steps/s
[Step= 100] | Loss=4.95277 | acc=0.1383 | tpr=0.5991 | fpr=0.8703 | 8172.9 samples/s | 31.9 steps/s
[Step= 150] | Loss=4.95787 | acc=0.1355 | tpr=0.5821 | fpr=0.8727 | 7312.1 samples/s | 28.6 steps/s
[Step= 200] | Loss=4.95991 | acc=0.1351 | tpr=0.5760 | fpr=0.8729 | 7982.9 samples/s | 31.2 steps/s
[Step= 250] | Loss=4.95656 | acc=0.1359 | tpr=0.5703 | fpr=0.8720 | 7953.7 samples/s | 31.1 steps/s
[Step= 300] | Loss=4.95309 | acc=0.1358 | tpr=0.5731 | fpr=0.8722 | 7895.8 samples/s | 30.8 steps/s
[Step= 350] | Loss=4.94745 | acc=0.1353 | tpr=0.5667 | fpr=0.8725 | 8151.9 samples/s | 31.8 steps/s
[Step= 400] | Loss=4.95082 | acc=0.1355 | tpr=0.5635 | fpr=0.8723 | 8086.6 samples/s | 31.6 steps/s
[Step= 450] | Loss=4.95288 | acc=0.1351 | tpr=0.5584 | fpr=0.8726 | 7700.4 samples/s | 30.1 steps/s
[Step= 500] | Loss=4.95401 | acc=0.1349 | tpr=0.5551 | fpr=0.8727 | 8381.4 samples/s | 32.7 steps/s
[Step= 550] | Loss=4.95468 | acc=0.1349 | tpr=0.5539 | fpr=0.8727 | 13268.5 samples/s | 51.8 steps/s
Avg test loss: 4.95754, Avg test acc: 0.13489, Avg tpr: 0.55428, Avg fpr: 0.87274, total FA: 121178

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10100 | acc=0.9802 | tpr=0.9248 | fpr=0.0188 | 4206.3 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.10354 | acc=0.9796 | tpr=0.9403 | fpr=0.0196 | 8003.3 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.10749 | acc=0.9787 | tpr=0.9424 | fpr=0.0207 | 8064.6 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.10975 | acc=0.9785 | tpr=0.9443 | fpr=0.0208 | 7955.3 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.10887 | acc=0.9786 | tpr=0.9389 | fpr=0.0207 | 8193.5 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.11042 | acc=0.9783 | tpr=0.9382 | fpr=0.0210 | 8069.8 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.11033 | acc=0.9782 | tpr=0.9374 | fpr=0.0210 | 8219.6 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.11176 | acc=0.9781 | tpr=0.9327 | fpr=0.0210 | 8199.8 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.11444 | acc=0.9779 | tpr=0.9323 | fpr=0.0213 | 7452.1 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.11396 | acc=0.9779 | tpr=0.9344 | fpr=0.0213 | 8142.8 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.11290 | acc=0.9781 | tpr=0.9335 | fpr=0.0211 | 14587.7 samples/s | 57.0 steps/s
Avg test loss: 0.11278, Avg test acc: 0.97814, Avg tpr: 0.93304, Avg fpr: 0.02104, total FA: 2922

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11720 | acc=0.9818 | tpr=0.8982 | fpr=0.0167 | 4101.1 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.12236 | acc=0.9812 | tpr=0.9083 | fpr=0.0175 | 8124.0 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.12679 | acc=0.9804 | tpr=0.9035 | fpr=0.0182 | 8132.8 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.12864 | acc=0.9804 | tpr=0.9071 | fpr=0.0183 | 7906.0 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.12721 | acc=0.9802 | tpr=0.9074 | fpr=0.0184 | 7716.9 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.12932 | acc=0.9798 | tpr=0.9069 | fpr=0.0189 | 7935.6 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.12914 | acc=0.9796 | tpr=0.9098 | fpr=0.0192 | 7886.6 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.13079 | acc=0.9793 | tpr=0.9048 | fpr=0.0194 | 8171.7 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.13382 | acc=0.9789 | tpr=0.9036 | fpr=0.0197 | 7792.6 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.13318 | acc=0.9789 | tpr=0.9070 | fpr=0.0198 | 7566.1 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.13214 | acc=0.9791 | tpr=0.9077 | fpr=0.0196 | 14297.1 samples/s | 55.8 steps/s
Avg test loss: 0.13191, Avg test acc: 0.97912, Avg tpr: 0.90729, Avg fpr: 0.01958, total FA: 2718

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11311 | acc=0.9788 | tpr=0.9336 | fpr=0.0204 | 4096.7 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.11733 | acc=0.9785 | tpr=0.9552 | fpr=0.0210 | 8474.6 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.12171 | acc=0.9775 | tpr=0.9553 | fpr=0.0221 | 7868.1 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.12432 | acc=0.9775 | tpr=0.9563 | fpr=0.0222 | 8015.8 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.12317 | acc=0.9776 | tpr=0.9537 | fpr=0.0220 | 7897.6 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.12526 | acc=0.9772 | tpr=0.9535 | fpr=0.0224 | 8219.3 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.12506 | acc=0.9771 | tpr=0.9530 | fpr=0.0225 | 7983.0 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.12659 | acc=0.9769 | tpr=0.9486 | fpr=0.0226 | 8043.9 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.12941 | acc=0.9766 | tpr=0.9469 | fpr=0.0228 | 7935.7 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.12903 | acc=0.9766 | tpr=0.9480 | fpr=0.0229 | 7961.9 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.12763 | acc=0.9769 | tpr=0.9491 | fpr=0.0226 | 14237.7 samples/s | 55.6 steps/s
Avg test loss: 0.12747, Avg test acc: 0.97691, Avg tpr: 0.94889, Avg fpr: 0.02258, total FA: 3135

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11895 | acc=0.9814 | tpr=0.9159 | fpr=0.0174 | 4059.7 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.12446 | acc=0.9808 | tpr=0.9403 | fpr=0.0185 | 8276.3 samples/s | 32.3 steps/s
[Step= 150] | Loss=0.12987 | acc=0.9798 | tpr=0.9366 | fpr=0.0194 | 7988.5 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.13213 | acc=0.9796 | tpr=0.9399 | fpr=0.0197 | 7802.4 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.13068 | acc=0.9795 | tpr=0.9397 | fpr=0.0197 | 8201.7 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.13284 | acc=0.9791 | tpr=0.9375 | fpr=0.0201 | 8113.0 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.13266 | acc=0.9790 | tpr=0.9405 | fpr=0.0203 | 7766.0 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.13408 | acc=0.9788 | tpr=0.9354 | fpr=0.0204 | 8093.3 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.13708 | acc=0.9785 | tpr=0.9314 | fpr=0.0207 | 7843.1 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.13664 | acc=0.9785 | tpr=0.9322 | fpr=0.0207 | 7803.9 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.13562 | acc=0.9787 | tpr=0.9327 | fpr=0.0205 | 14556.9 samples/s | 56.9 steps/s
Avg test loss: 0.13543, Avg test acc: 0.97864, Avg tpr: 0.93225, Avg fpr: 0.02052, total FA: 2849

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.11393 | acc=0.9821 | tpr=0.8761 | fpr=0.0160 | 4089.8 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.11810 | acc=0.9817 | tpr=0.9041 | fpr=0.0169 | 7984.1 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.12218 | acc=0.9807 | tpr=0.9150 | fpr=0.0181 | 8085.4 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.12509 | acc=0.9804 | tpr=0.9115 | fpr=0.0183 | 8048.1 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.12380 | acc=0.9804 | tpr=0.9066 | fpr=0.0182 | 8270.6 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.12615 | acc=0.9802 | tpr=0.9033 | fpr=0.0184 | 7572.6 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.12714 | acc=0.9800 | tpr=0.9029 | fpr=0.0186 | 7777.3 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.12811 | acc=0.9797 | tpr=0.8982 | fpr=0.0188 | 8180.1 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.13108 | acc=0.9795 | tpr=0.8992 | fpr=0.0191 | 7906.1 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.13058 | acc=0.9795 | tpr=0.8996 | fpr=0.0191 | 8388.8 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.12986 | acc=0.9796 | tpr=0.8981 | fpr=0.0190 | 14308.8 samples/s | 55.9 steps/s
Avg test loss: 0.12956, Avg test acc: 0.97956, Avg tpr: 0.89739, Avg fpr: 0.01894, total FA: 2630

server round 20/50

clients selected: [0 1 5 6 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=18001 Epoch=87.8] | Loss=0.02518 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.141 | L2-Norm(final)=8.446 | 3835.3 samples/s | 59.9 steps/s
[Step=18050 Epoch=88.0] | Loss=0.02649 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.163 | L2-Norm(final)=8.444 | 4610.3 samples/s | 72.0 steps/s
[Step=18100 Epoch=88.3] | Loss=0.02846 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.188 | L2-Norm(final)=8.445 | 5168.8 samples/s | 80.8 steps/s
[Step=18150 Epoch=88.5] | Loss=0.02644 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.211 | L2-Norm(final)=8.450 | 5248.8 samples/s | 82.0 steps/s
[Step=18200 Epoch=88.7] | Loss=0.02593 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.234 | L2-Norm(final)=8.457 | 7822.3 samples/s | 122.2 steps/s
[Step=18250 Epoch=89.0] | Loss=0.02451 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.257 | L2-Norm(final)=8.467 | 1797.0 samples/s | 28.1 steps/s
[Step=18300 Epoch=89.2] | Loss=0.02353 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.279 | L2-Norm(final)=8.479 | 5166.2 samples/s | 80.7 steps/s
[Step=18350 Epoch=89.5] | Loss=0.02333 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.302 | L2-Norm(final)=8.491 | 5268.6 samples/s | 82.3 steps/s
[Step=18400 Epoch=89.7] | Loss=0.02292 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.325 | L2-Norm(final)=8.504 | 6373.9 samples/s | 99.6 steps/s
[Step=18450 Epoch=90.0] | Loss=0.02191 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.346 | L2-Norm(final)=8.517 | 1873.3 samples/s | 29.3 steps/s
[Step=18500 Epoch=90.2] | Loss=0.02138 | Reg=0.00153 | acc=0.9688 | L2-Norm=12.367 | L2-Norm(final)=8.532 | 5201.3 samples/s | 81.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=90.2] | Loss=0.03073 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.581 | L2-Norm(final)=8.679 | 3944.0 samples/s | 61.6 steps/s
[Step=18550 Epoch=90.5] | Loss=0.01687 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.599 | L2-Norm(final)=8.695 | 4127.2 samples/s | 64.5 steps/s
[Step=18600 Epoch=90.7] | Loss=0.01763 | Reg=0.00159 | acc=0.9688 | L2-Norm=12.620 | L2-Norm(final)=8.704 | 4589.1 samples/s | 71.7 steps/s
[Step=18650 Epoch=90.9] | Loss=0.01730 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.640 | L2-Norm(final)=8.713 | 4468.8 samples/s | 69.8 steps/s
[Step=18700 Epoch=91.2] | Loss=0.01814 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.657 | L2-Norm(final)=8.719 | 6304.0 samples/s | 98.5 steps/s
[Step=18750 Epoch=91.4] | Loss=0.01662 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.672 | L2-Norm(final)=8.724 | 1761.7 samples/s | 27.5 steps/s
[Step=18800 Epoch=91.7] | Loss=0.01494 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.684 | L2-Norm(final)=8.730 | 4545.1 samples/s | 71.0 steps/s
[Step=18850 Epoch=91.9] | Loss=0.01439 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.695 | L2-Norm(final)=8.736 | 4560.5 samples/s | 71.3 steps/s
[Step=18900 Epoch=92.2] | Loss=0.01380 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.704 | L2-Norm(final)=8.742 | 5586.0 samples/s | 87.3 steps/s
[Step=18950 Epoch=92.4] | Loss=0.01300 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.713 | L2-Norm(final)=8.747 | 1798.4 samples/s | 28.1 steps/s
[Step=19000 Epoch=92.6] | Loss=0.01246 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.720 | L2-Norm(final)=8.752 | 4683.6 samples/s | 73.2 steps/s
[Step=19050 Epoch=92.9] | Loss=0.01194 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.727 | L2-Norm(final)=8.757 | 4582.1 samples/s | 71.6 steps/s
[Step=19100 Epoch=93.1] | Loss=0.01155 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.734 | L2-Norm(final)=8.762 | 5292.8 samples/s | 82.7 steps/s
[Step=19150 Epoch=93.4] | Loss=0.01106 | Reg=0.00162 | acc=0.9531 | L2-Norm=12.740 | L2-Norm(final)=8.767 | 1781.0 samples/s | 27.8 steps/s
[Step=19200 Epoch=93.6] | Loss=0.01044 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.746 | L2-Norm(final)=8.772 | 4477.9 samples/s | 70.0 steps/s
[Step=19250 Epoch=93.9] | Loss=0.01004 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.752 | L2-Norm(final)=8.776 | 4550.5 samples/s | 71.1 steps/s
[Step=19300 Epoch=94.1] | Loss=0.00987 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.757 | L2-Norm(final)=8.781 | 4945.6 samples/s | 77.3 steps/s
[Step=19350 Epoch=94.4] | Loss=0.00955 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.762 | L2-Norm(final)=8.785 | 1878.1 samples/s | 29.3 steps/s
[Step=19400 Epoch=94.6] | Loss=0.00926 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.766 | L2-Norm(final)=8.789 | 4545.8 samples/s | 71.0 steps/s
[Step=19450 Epoch=94.8] | Loss=0.00897 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.770 | L2-Norm(final)=8.793 | 4405.7 samples/s | 68.8 steps/s
[Step=19500 Epoch=95.1] | Loss=0.00878 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.774 | L2-Norm(final)=8.796 | 4593.0 samples/s | 71.8 steps/s
[Step=19550 Epoch=95.3] | Loss=0.00852 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.778 | L2-Norm(final)=8.800 | 1887.1 samples/s | 29.5 steps/s
[Step=19600 Epoch=95.6] | Loss=0.00828 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.781 | L2-Norm(final)=8.803 | 4553.3 samples/s | 71.1 steps/s
[Step=19650 Epoch=95.8] | Loss=0.00813 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.784 | L2-Norm(final)=8.807 | 4644.7 samples/s | 72.6 steps/s
[Step=19700 Epoch=96.1] | Loss=0.00800 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=8.810 | 4643.3 samples/s | 72.6 steps/s
[Step=19750 Epoch=96.3] | Loss=0.00789 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.790 | L2-Norm(final)=8.813 | 1933.7 samples/s | 30.2 steps/s
[Step=19800 Epoch=96.5] | Loss=0.00779 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.793 | L2-Norm(final)=8.816 | 4630.1 samples/s | 72.3 steps/s
[Step=19850 Epoch=96.8] | Loss=0.00760 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.795 | L2-Norm(final)=8.818 | 4629.8 samples/s | 72.3 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00747 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.798 | L2-Norm(final)=8.821 | 4629.9 samples/s | 72.3 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00733 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.800 | L2-Norm(final)=8.824 | 1948.8 samples/s | 30.4 steps/s
[Step=20000 Epoch=97.5] | Loss=0.00715 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.802 | L2-Norm(final)=8.827 | 4656.5 samples/s | 72.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step20000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=28001 Epoch=136.6] | Loss=0.02404 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.141 | L2-Norm(final)=10.304 | 3841.9 samples/s | 60.0 steps/s
[Step=28050 Epoch=136.9] | Loss=0.02871 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=10.294 | 4775.3 samples/s | 74.6 steps/s
[Step=28100 Epoch=137.1] | Loss=0.02566 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.175 | L2-Norm(final)=10.289 | 5188.5 samples/s | 81.1 steps/s
[Step=28150 Epoch=137.4] | Loss=0.02404 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.194 | L2-Norm(final)=10.291 | 5501.8 samples/s | 86.0 steps/s
[Step=28200 Epoch=137.6] | Loss=0.02391 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.213 | L2-Norm(final)=10.296 | 6871.7 samples/s | 107.4 steps/s
[Step=28250 Epoch=137.8] | Loss=0.02212 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.233 | L2-Norm(final)=10.303 | 1827.8 samples/s | 28.6 steps/s
[Step=28300 Epoch=138.1] | Loss=0.02078 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.252 | L2-Norm(final)=10.313 | 5265.5 samples/s | 82.3 steps/s
[Step=28350 Epoch=138.3] | Loss=0.02029 | Reg=0.00151 | acc=0.9844 | L2-Norm=12.271 | L2-Norm(final)=10.324 | 5165.4 samples/s | 80.7 steps/s
[Step=28400 Epoch=138.6] | Loss=0.01976 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=10.336 | 6841.7 samples/s | 106.9 steps/s
[Step=28450 Epoch=138.8] | Loss=0.01892 | Reg=0.00151 | acc=0.9688 | L2-Norm=12.306 | L2-Norm(final)=10.348 | 1858.5 samples/s | 29.0 steps/s
[Step=28500 Epoch=139.1] | Loss=0.01853 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.324 | L2-Norm(final)=10.362 | 5188.6 samples/s | 81.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=139.1] | Loss=0.03032 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.508 | L2-Norm(final)=10.503 | 3826.1 samples/s | 59.8 steps/s
[Step=28550 Epoch=139.3] | Loss=0.01243 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.529 | L2-Norm(final)=10.521 | 4537.7 samples/s | 70.9 steps/s
[Step=28600 Epoch=139.6] | Loss=0.01558 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=10.533 | 4558.5 samples/s | 71.2 steps/s
[Step=28650 Epoch=139.8] | Loss=0.01795 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.569 | L2-Norm(final)=10.539 | 4562.4 samples/s | 71.3 steps/s
[Step=28700 Epoch=140.0] | Loss=0.01752 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.585 | L2-Norm(final)=10.542 | 5882.7 samples/s | 91.9 steps/s
[Step=28750 Epoch=140.3] | Loss=0.01554 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.600 | L2-Norm(final)=10.545 | 1770.5 samples/s | 27.7 steps/s
[Step=28800 Epoch=140.5] | Loss=0.01435 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.612 | L2-Norm(final)=10.550 | 4628.4 samples/s | 72.3 steps/s
[Step=28850 Epoch=140.8] | Loss=0.01344 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.623 | L2-Norm(final)=10.555 | 4593.1 samples/s | 71.8 steps/s
[Step=28900 Epoch=141.0] | Loss=0.01298 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.632 | L2-Norm(final)=10.559 | 5810.9 samples/s | 90.8 steps/s
[Step=28950 Epoch=141.3] | Loss=0.01231 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.640 | L2-Norm(final)=10.563 | 1762.0 samples/s | 27.5 steps/s
[Step=29000 Epoch=141.5] | Loss=0.01147 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.647 | L2-Norm(final)=10.568 | 4598.3 samples/s | 71.8 steps/s
[Step=29050 Epoch=141.8] | Loss=0.01110 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.654 | L2-Norm(final)=10.572 | 4645.8 samples/s | 72.6 steps/s
[Step=29100 Epoch=142.0] | Loss=0.01073 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.660 | L2-Norm(final)=10.576 | 5597.9 samples/s | 87.5 steps/s
[Step=29150 Epoch=142.2] | Loss=0.01031 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.666 | L2-Norm(final)=10.579 | 1826.6 samples/s | 28.5 steps/s
[Step=29200 Epoch=142.5] | Loss=0.01002 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.671 | L2-Norm(final)=10.582 | 4651.7 samples/s | 72.7 steps/s
[Step=29250 Epoch=142.7] | Loss=0.00971 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.675 | L2-Norm(final)=10.585 | 4607.6 samples/s | 72.0 steps/s
[Step=29300 Epoch=143.0] | Loss=0.00947 | Reg=0.00161 | acc=0.9688 | L2-Norm=12.680 | L2-Norm(final)=10.588 | 4903.0 samples/s | 76.6 steps/s
[Step=29350 Epoch=143.2] | Loss=0.00913 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.684 | L2-Norm(final)=10.591 | 1833.3 samples/s | 28.6 steps/s
[Step=29400 Epoch=143.5] | Loss=0.00886 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.688 | L2-Norm(final)=10.594 | 4744.7 samples/s | 74.1 steps/s
[Step=29450 Epoch=143.7] | Loss=0.00854 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.691 | L2-Norm(final)=10.597 | 4527.8 samples/s | 70.7 steps/s
[Step=29500 Epoch=143.9] | Loss=0.00830 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.695 | L2-Norm(final)=10.600 | 4915.0 samples/s | 76.8 steps/s
[Step=29550 Epoch=144.2] | Loss=0.00806 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.698 | L2-Norm(final)=10.603 | 1918.5 samples/s | 30.0 steps/s
[Step=29600 Epoch=144.4] | Loss=0.00794 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.701 | L2-Norm(final)=10.606 | 4662.1 samples/s | 72.8 steps/s
[Step=29650 Epoch=144.7] | Loss=0.00782 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.704 | L2-Norm(final)=10.608 | 4638.0 samples/s | 72.5 steps/s
[Step=29700 Epoch=144.9] | Loss=0.00764 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.707 | L2-Norm(final)=10.611 | 4609.6 samples/s | 72.0 steps/s
[Step=29750 Epoch=145.2] | Loss=0.00746 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.709 | L2-Norm(final)=10.613 | 1889.8 samples/s | 29.5 steps/s
[Step=29800 Epoch=145.4] | Loss=0.00726 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.711 | L2-Norm(final)=10.616 | 4600.8 samples/s | 71.9 steps/s
[Step=29850 Epoch=145.7] | Loss=0.00709 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.714 | L2-Norm(final)=10.618 | 4595.5 samples/s | 71.8 steps/s
[Step=29900 Epoch=145.9] | Loss=0.00695 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.716 | L2-Norm(final)=10.620 | 4555.0 samples/s | 71.2 steps/s
[Step=29950 Epoch=146.1] | Loss=0.00681 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.718 | L2-Norm(final)=10.623 | 1940.9 samples/s | 30.3 steps/s
[Step=30000 Epoch=146.4] | Loss=0.00673 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.720 | L2-Norm(final)=10.625 | 4570.4 samples/s | 71.4 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step30000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=10001 Epoch=94.8] | Loss=0.00185 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=5.597 | 3664.6 samples/s | 57.3 steps/s
[Step=10050 Epoch=95.2] | Loss=0.00442 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.206 | L2-Norm(final)=5.622 | 4443.5 samples/s | 69.4 steps/s
[Step=10100 Epoch=95.7] | Loss=0.00289 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.254 | L2-Norm(final)=5.654 | 6912.9 samples/s | 108.0 steps/s
[Step=10150 Epoch=96.2] | Loss=0.00213 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.279 | L2-Norm(final)=5.679 | 1756.6 samples/s | 27.4 steps/s
[Step=10200 Epoch=96.7] | Loss=0.00172 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.293 | L2-Norm(final)=5.700 | 6209.0 samples/s | 97.0 steps/s
[Step=10250 Epoch=97.1] | Loss=0.00145 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=5.719 | 1805.3 samples/s | 28.2 steps/s
[Step=10300 Epoch=97.6] | Loss=0.00128 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.309 | L2-Norm(final)=5.736 | 5620.5 samples/s | 87.8 steps/s
[Step=10350 Epoch=98.1] | Loss=0.00113 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.313 | L2-Norm(final)=5.752 | 1839.1 samples/s | 28.7 steps/s
[Step=10400 Epoch=98.5] | Loss=0.00102 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=5.766 | 5474.2 samples/s | 85.5 steps/s
[Step=10450 Epoch=99.0] | Loss=0.00094 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.316 | L2-Norm(final)=5.780 | 1903.6 samples/s | 29.7 steps/s
[Step=10500 Epoch=99.5] | Loss=0.00086 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.316 | L2-Norm(final)=5.793 | 5020.9 samples/s | 78.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=10501 Epoch=99.5] | Loss=0.00008 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.312 | L2-Norm(final)=5.918 | 3549.5 samples/s | 55.5 steps/s
[Step=10550 Epoch=100.0] | Loss=0.00021 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.305 | L2-Norm(final)=5.928 | 4228.0 samples/s | 66.1 steps/s
[Step=10600 Epoch=100.4] | Loss=0.00013 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=5.935 | 6010.1 samples/s | 93.9 steps/s
[Step=10650 Epoch=100.9] | Loss=0.00010 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.279 | L2-Norm(final)=5.939 | 1712.0 samples/s | 26.8 steps/s
[Step=10700 Epoch=101.4] | Loss=0.00008 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=5.942 | 5439.7 samples/s | 85.0 steps/s
[Step=10750 Epoch=101.9] | Loss=0.00006 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.245 | L2-Norm(final)=5.945 | 1740.7 samples/s | 27.2 steps/s
[Step=10800 Epoch=102.3] | Loss=0.00005 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.226 | L2-Norm(final)=5.946 | 4881.8 samples/s | 76.3 steps/s
[Step=10850 Epoch=102.8] | Loss=0.00005 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.208 | L2-Norm(final)=5.948 | 1766.6 samples/s | 27.6 steps/s
[Step=10900 Epoch=103.3] | Loss=0.00004 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.189 | L2-Norm(final)=5.949 | 4742.5 samples/s | 74.1 steps/s
[Step=10950 Epoch=103.8] | Loss=0.00004 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.171 | L2-Norm(final)=5.950 | 1780.4 samples/s | 27.8 steps/s
[Step=11000 Epoch=104.2] | Loss=0.00004 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=5.951 | 4593.2 samples/s | 71.8 steps/s
[Step=11050 Epoch=104.7] | Loss=0.00003 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=5.952 | 1862.4 samples/s | 29.1 steps/s
[Step=11100 Epoch=105.2] | Loss=0.00003 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.113 | L2-Norm(final)=5.953 | 4363.0 samples/s | 68.2 steps/s
[Step=11150 Epoch=105.7] | Loss=0.00003 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.094 | L2-Norm(final)=5.954 | 1867.9 samples/s | 29.2 steps/s
[Step=11200 Epoch=106.1] | Loss=0.00003 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.075 | L2-Norm(final)=5.955 | 4482.5 samples/s | 70.0 steps/s
[Step=11250 Epoch=106.6] | Loss=0.00003 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.055 | L2-Norm(final)=5.956 | 1880.8 samples/s | 29.4 steps/s
[Step=11300 Epoch=107.1] | Loss=0.00002 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.036 | L2-Norm(final)=5.957 | 4336.7 samples/s | 67.8 steps/s
[Step=11350 Epoch=107.6] | Loss=0.00002 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.016 | L2-Norm(final)=5.958 | 1974.0 samples/s | 30.8 steps/s
[Step=11400 Epoch=108.0] | Loss=0.00002 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.997 | L2-Norm(final)=5.959 | 3842.6 samples/s | 60.0 steps/s
[Step=11450 Epoch=108.5] | Loss=0.00002 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.977 | L2-Norm(final)=5.960 | 6048.9 samples/s | 94.5 steps/s
[Step=11500 Epoch=109.0] | Loss=0.00002 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.957 | L2-Norm(final)=5.960 | 1674.8 samples/s | 26.2 steps/s
[Step=11550 Epoch=109.4] | Loss=0.00002 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.937 | L2-Norm(final)=5.961 | 5520.1 samples/s | 86.3 steps/s
[Step=11600 Epoch=109.9] | Loss=0.00002 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.917 | L2-Norm(final)=5.962 | 1725.8 samples/s | 27.0 steps/s
[Step=11650 Epoch=110.4] | Loss=0.00002 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.897 | L2-Norm(final)=5.963 | 5143.9 samples/s | 80.4 steps/s
[Step=11700 Epoch=110.9] | Loss=0.00002 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.877 | L2-Norm(final)=5.963 | 1745.1 samples/s | 27.3 steps/s
[Step=11750 Epoch=111.3] | Loss=0.00002 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.857 | L2-Norm(final)=5.964 | 4940.5 samples/s | 77.2 steps/s
[Step=11800 Epoch=111.8] | Loss=0.00002 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.837 | L2-Norm(final)=5.965 | 1811.3 samples/s | 28.3 steps/s
[Step=11850 Epoch=112.3] | Loss=0.00002 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.816 | L2-Norm(final)=5.966 | 4608.3 samples/s | 72.0 steps/s
[Step=11900 Epoch=112.8] | Loss=0.00002 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.796 | L2-Norm(final)=5.966 | 1860.2 samples/s | 29.1 steps/s
[Step=11950 Epoch=113.2] | Loss=0.00002 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.775 | L2-Norm(final)=5.967 | 4333.2 samples/s | 67.7 steps/s
[Step=12000 Epoch=113.7] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.755 | L2-Norm(final)=5.968 | 1858.6 samples/s | 29.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_0/client_state-step12000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=22001 Epoch=209.3] | Loss=0.01620 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.141 | L2-Norm(final)=8.116 | 3942.3 samples/s | 61.6 steps/s
[Step=22050 Epoch=209.8] | Loss=0.00817 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.238 | L2-Norm(final)=8.113 | 4520.6 samples/s | 70.6 steps/s
[Step=22100 Epoch=210.2] | Loss=0.00508 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=8.119 | 7185.9 samples/s | 112.3 steps/s
[Step=22150 Epoch=210.7] | Loss=0.00354 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.314 | L2-Norm(final)=8.130 | 1774.1 samples/s | 27.7 steps/s
[Step=22200 Epoch=211.2] | Loss=0.00274 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.326 | L2-Norm(final)=8.140 | 6385.1 samples/s | 99.8 steps/s
[Step=22250 Epoch=211.7] | Loss=0.00224 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.333 | L2-Norm(final)=8.149 | 1823.9 samples/s | 28.5 steps/s
[Step=22300 Epoch=212.1] | Loss=0.00190 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.336 | L2-Norm(final)=8.158 | 5624.9 samples/s | 87.9 steps/s
[Step=22350 Epoch=212.6] | Loss=0.00165 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.337 | L2-Norm(final)=8.166 | 1826.4 samples/s | 28.5 steps/s
[Step=22400 Epoch=213.1] | Loss=0.00147 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.337 | L2-Norm(final)=8.175 | 5357.7 samples/s | 83.7 steps/s
[Step=22450 Epoch=213.6] | Loss=0.00132 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.336 | L2-Norm(final)=8.182 | 1923.4 samples/s | 30.1 steps/s
[Step=22500 Epoch=214.0] | Loss=0.00120 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.335 | L2-Norm(final)=8.190 | 5206.6 samples/s | 81.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=214.0] | Loss=0.00016 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=8.264 | 3499.5 samples/s | 54.7 steps/s
[Step=22550 Epoch=214.5] | Loss=0.00012 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=8.270 | 4284.3 samples/s | 66.9 steps/s
[Step=22600 Epoch=215.0] | Loss=0.00013 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=8.276 | 5910.9 samples/s | 92.4 steps/s
[Step=22650 Epoch=215.5] | Loss=0.00010 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.284 | L2-Norm(final)=8.280 | 1720.0 samples/s | 26.9 steps/s
[Step=22700 Epoch=215.9] | Loss=0.00008 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.270 | L2-Norm(final)=8.283 | 5608.8 samples/s | 87.6 steps/s
[Step=22750 Epoch=216.4] | Loss=0.00007 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.255 | L2-Norm(final)=8.285 | 1713.8 samples/s | 26.8 steps/s
[Step=22800 Epoch=216.9] | Loss=0.00006 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.237 | L2-Norm(final)=8.286 | 5080.3 samples/s | 79.4 steps/s
[Step=22850 Epoch=217.4] | Loss=0.00005 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=8.287 | 1832.5 samples/s | 28.6 steps/s
[Step=22900 Epoch=217.8] | Loss=0.00004 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.200 | L2-Norm(final)=8.288 | 4793.0 samples/s | 74.9 steps/s
[Step=22950 Epoch=218.3] | Loss=0.00004 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.181 | L2-Norm(final)=8.289 | 1818.6 samples/s | 28.4 steps/s
[Step=23000 Epoch=218.8] | Loss=0.00003 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.162 | L2-Norm(final)=8.289 | 4509.0 samples/s | 70.5 steps/s
[Step=23050 Epoch=219.3] | Loss=0.00003 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=8.290 | 1859.9 samples/s | 29.1 steps/s
[Step=23100 Epoch=219.7] | Loss=0.00003 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.122 | L2-Norm(final)=8.291 | 4400.1 samples/s | 68.8 steps/s
[Step=23150 Epoch=220.2] | Loss=0.00003 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.101 | L2-Norm(final)=8.291 | 1888.1 samples/s | 29.5 steps/s
[Step=23200 Epoch=220.7] | Loss=0.00003 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.081 | L2-Norm(final)=8.291 | 4405.2 samples/s | 68.8 steps/s
[Step=23250 Epoch=221.2] | Loss=0.00002 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.060 | L2-Norm(final)=8.292 | 1885.0 samples/s | 29.5 steps/s
[Step=23300 Epoch=221.6] | Loss=0.00002 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.040 | L2-Norm(final)=8.292 | 4319.3 samples/s | 67.5 steps/s
[Step=23350 Epoch=222.1] | Loss=0.00002 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.019 | L2-Norm(final)=8.293 | 1892.3 samples/s | 29.6 steps/s
[Step=23400 Epoch=222.6] | Loss=0.00002 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.998 | L2-Norm(final)=8.293 | 4331.6 samples/s | 67.7 steps/s
[Step=23450 Epoch=223.1] | Loss=0.00002 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.976 | L2-Norm(final)=8.293 | 5981.5 samples/s | 93.5 steps/s
[Step=23500 Epoch=223.5] | Loss=0.00002 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.955 | L2-Norm(final)=8.294 | 1715.0 samples/s | 26.8 steps/s
[Step=23550 Epoch=224.0] | Loss=0.00002 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.934 | L2-Norm(final)=8.294 | 5726.4 samples/s | 89.5 steps/s
[Step=23600 Epoch=224.5] | Loss=0.00002 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.912 | L2-Norm(final)=8.295 | 1725.1 samples/s | 27.0 steps/s
[Step=23650 Epoch=225.0] | Loss=0.00002 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.890 | L2-Norm(final)=8.295 | 5060.0 samples/s | 79.1 steps/s
[Step=23700 Epoch=225.4] | Loss=0.00002 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.868 | L2-Norm(final)=8.295 | 1755.2 samples/s | 27.4 steps/s
[Step=23750 Epoch=225.9] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.846 | L2-Norm(final)=8.296 | 4896.9 samples/s | 76.5 steps/s
[Step=23800 Epoch=226.4] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.824 | L2-Norm(final)=8.296 | 1797.0 samples/s | 28.1 steps/s
[Step=23850 Epoch=226.9] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.801 | L2-Norm(final)=8.296 | 4584.3 samples/s | 71.6 steps/s
[Step=23900 Epoch=227.3] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.779 | L2-Norm(final)=8.297 | 1841.9 samples/s | 28.8 steps/s
[Step=23950 Epoch=227.8] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.756 | L2-Norm(final)=8.297 | 4359.5 samples/s | 68.1 steps/s
[Step=24000 Epoch=228.3] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.733 | L2-Norm(final)=8.297 | 1843.0 samples/s | 28.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step24000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=22001 Epoch=210.1] | Loss=0.00097 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=7.463 | 3611.1 samples/s | 56.4 steps/s
[Step=22050 Epoch=210.6] | Loss=0.00432 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.198 | L2-Norm(final)=7.452 | 4767.8 samples/s | 74.5 steps/s
[Step=22100 Epoch=211.0] | Loss=0.00287 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.233 | L2-Norm(final)=7.473 | 6810.9 samples/s | 106.4 steps/s
[Step=22150 Epoch=211.5] | Loss=0.00203 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.254 | L2-Norm(final)=7.492 | 1704.9 samples/s | 26.6 steps/s
[Step=22200 Epoch=212.0] | Loss=0.00158 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.263 | L2-Norm(final)=7.507 | 6527.4 samples/s | 102.0 steps/s
[Step=22250 Epoch=212.5] | Loss=0.00130 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.267 | L2-Norm(final)=7.520 | 1762.8 samples/s | 27.5 steps/s
[Step=22300 Epoch=213.0] | Loss=0.00111 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=7.531 | 5948.4 samples/s | 92.9 steps/s
[Step=22350 Epoch=213.4] | Loss=0.00096 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.267 | L2-Norm(final)=7.541 | 1875.5 samples/s | 29.3 steps/s
[Step=22400 Epoch=213.9] | Loss=0.00086 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.265 | L2-Norm(final)=7.551 | 5413.4 samples/s | 84.6 steps/s
[Step=22450 Epoch=214.4] | Loss=0.00077 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.262 | L2-Norm(final)=7.559 | 1856.2 samples/s | 29.0 steps/s
[Step=22500 Epoch=214.9] | Loss=0.00071 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.258 | L2-Norm(final)=7.567 | 5280.5 samples/s | 82.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=214.9] | Loss=0.00009 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.218 | L2-Norm(final)=7.646 | 3800.7 samples/s | 59.4 steps/s
[Step=22550 Epoch=215.3] | Loss=0.00006 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.206 | L2-Norm(final)=7.651 | 4054.6 samples/s | 63.4 steps/s
[Step=22600 Epoch=215.8] | Loss=0.00005 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.191 | L2-Norm(final)=7.655 | 6051.8 samples/s | 94.6 steps/s
[Step=22650 Epoch=216.3] | Loss=0.00004 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=7.657 | 1678.8 samples/s | 26.2 steps/s
[Step=22700 Epoch=216.8] | Loss=0.00003 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=7.659 | 5741.7 samples/s | 89.7 steps/s
[Step=22750 Epoch=217.2] | Loss=0.00002 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=7.660 | 1728.3 samples/s | 27.0 steps/s
[Step=22800 Epoch=217.7] | Loss=0.00002 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.125 | L2-Norm(final)=7.662 | 5260.4 samples/s | 82.2 steps/s
[Step=22850 Epoch=218.2] | Loss=0.00002 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.107 | L2-Norm(final)=7.663 | 1713.8 samples/s | 26.8 steps/s
[Step=22900 Epoch=218.7] | Loss=0.00002 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.090 | L2-Norm(final)=7.664 | 4725.4 samples/s | 73.8 steps/s
[Step=22950 Epoch=219.2] | Loss=0.00002 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.072 | L2-Norm(final)=7.664 | 1784.0 samples/s | 27.9 steps/s
[Step=23000 Epoch=219.6] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.054 | L2-Norm(final)=7.665 | 4957.5 samples/s | 77.5 steps/s
[Step=23050 Epoch=220.1] | Loss=0.00001 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.036 | L2-Norm(final)=7.666 | 1826.1 samples/s | 28.5 steps/s
[Step=23100 Epoch=220.6] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.018 | L2-Norm(final)=7.666 | 4493.0 samples/s | 70.2 steps/s
[Step=23150 Epoch=221.1] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.999 | L2-Norm(final)=7.667 | 1870.5 samples/s | 29.2 steps/s
[Step=23200 Epoch=221.5] | Loss=0.00001 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.981 | L2-Norm(final)=7.668 | 4323.8 samples/s | 67.6 steps/s
[Step=23250 Epoch=222.0] | Loss=0.00001 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.962 | L2-Norm(final)=7.668 | 1855.1 samples/s | 29.0 steps/s
[Step=23300 Epoch=222.5] | Loss=0.00001 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.944 | L2-Norm(final)=7.669 | 4462.9 samples/s | 69.7 steps/s
[Step=23350 Epoch=223.0] | Loss=0.00001 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.925 | L2-Norm(final)=7.669 | 1873.5 samples/s | 29.3 steps/s
[Step=23400 Epoch=223.5] | Loss=0.00001 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.906 | L2-Norm(final)=7.670 | 4424.1 samples/s | 69.1 steps/s
[Step=23450 Epoch=223.9] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.887 | L2-Norm(final)=7.671 | 1870.3 samples/s | 29.2 steps/s
[Step=23500 Epoch=224.4] | Loss=0.00001 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.868 | L2-Norm(final)=7.671 | 4566.6 samples/s | 71.4 steps/s
[Step=23550 Epoch=224.9] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.849 | L2-Norm(final)=7.672 | 6634.5 samples/s | 103.7 steps/s
[Step=23600 Epoch=225.4] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.829 | L2-Norm(final)=7.672 | 1655.9 samples/s | 25.9 steps/s
[Step=23650 Epoch=225.8] | Loss=0.00001 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.810 | L2-Norm(final)=7.673 | 6057.0 samples/s | 94.6 steps/s
[Step=23700 Epoch=226.3] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.790 | L2-Norm(final)=7.673 | 1678.8 samples/s | 26.2 steps/s
[Step=23750 Epoch=226.8] | Loss=0.00001 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.771 | L2-Norm(final)=7.674 | 5609.0 samples/s | 87.6 steps/s
[Step=23800 Epoch=227.3] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.751 | L2-Norm(final)=7.674 | 1182.2 samples/s | 18.5 steps/s
[Step=23850 Epoch=227.8] | Loss=0.00001 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.731 | L2-Norm(final)=7.675 | 4663.2 samples/s | 72.9 steps/s
[Step=23900 Epoch=228.2] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.711 | L2-Norm(final)=7.675 | 1743.6 samples/s | 27.2 steps/s
[Step=23950 Epoch=228.7] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.690 | L2-Norm(final)=7.676 | 5005.7 samples/s | 78.2 steps/s
[Step=24000 Epoch=229.2] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.670 | L2-Norm(final)=7.676 | 1763.9 samples/s | 27.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09472 | acc=0.9609 | tpr=0.9706 | fpr=0.0600 | 4143.1 samples/s | 16.2 steps/s
Avg test loss: 0.09685, Avg test acc: 0.96013, Avg tpr: 0.97022, Avg fpr: 0.06204, total FA: 484

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09404 | acc=0.9591 | tpr=0.9671 | fpr=0.0585 | 4139.1 samples/s | 16.2 steps/s
Avg test loss: 0.09888, Avg test acc: 0.95869, Avg tpr: 0.96771, Avg fpr: 0.06115, total FA: 477

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11099 | acc=0.9528 | tpr=0.9596 | fpr=0.0619 | 4181.9 samples/s | 16.3 steps/s
Avg test loss: 0.11841, Avg test acc: 0.95104, Avg tpr: 0.95693, Avg fpr: 0.06192, total FA: 483

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.12420 | acc=0.9541 | tpr=0.9744 | fpr=0.0902 | 4059.2 samples/s | 15.9 steps/s
Avg test loss: 0.12746, Avg test acc: 0.95344, Avg tpr: 0.97366, Avg fpr: 0.09101, total FA: 710

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10654 | acc=0.9534 | tpr=0.9630 | fpr=0.0676 | 4219.7 samples/s | 16.5 steps/s
Avg test loss: 0.11088, Avg test acc: 0.95228, Avg tpr: 0.96241, Avg fpr: 0.06999, total FA: 546

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.87354 | acc=0.2713 | tpr=0.0045 | fpr=0.1492 | 4067.2 samples/s | 15.9 steps/s
Avg test loss: 4.89520, Avg test acc: 0.27009, Avg tpr: 0.00548, Avg fpr: 0.14793, total FA: 1154

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.67404 | acc=0.3115 | tpr=0.0042 | fpr=0.0213 | 4114.3 samples/s | 16.1 steps/s
Avg test loss: 4.68164, Avg test acc: 0.30888, Avg tpr: 0.00455, Avg fpr: 0.02179, total FA: 170

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.97957 | acc=0.2943 | tpr=0.0083 | fpr=0.0847 | 4056.4 samples/s | 15.8 steps/s
Avg test loss: 4.98805, Avg test acc: 0.29353, Avg tpr: 0.00991, Avg fpr: 0.08268, total FA: 645

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.01390 | acc=0.2974 | tpr=0.0071 | fpr=0.0721 | 4110.6 samples/s | 16.1 steps/s
Avg test loss: 5.02218, Avg test acc: 0.29598, Avg tpr: 0.00775, Avg fpr: 0.07012, total FA: 547

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.43961 | acc=0.3132 | tpr=0.0017 | fpr=0.0104 | 4089.5 samples/s | 16.0 steps/s
Avg test loss: 4.44392, Avg test acc: 0.31140, Avg tpr: 0.00204, Avg fpr: 0.00820, total FA: 64

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.36524 | acc=0.1259 | tpr=0.7434 | fpr=0.8852 | 4086.6 samples/s | 16.0 steps/s
[Step= 100] | Loss=5.31131 | acc=0.1279 | tpr=0.7228 | fpr=0.8833 | 8551.0 samples/s | 33.4 steps/s
[Step= 150] | Loss=5.31766 | acc=0.1264 | tpr=0.7219 | fpr=0.8846 | 7826.5 samples/s | 30.6 steps/s
[Step= 200] | Loss=5.31555 | acc=0.1260 | tpr=0.7169 | fpr=0.8848 | 7867.3 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.31711 | acc=0.1265 | tpr=0.7188 | fpr=0.8843 | 8116.2 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.31546 | acc=0.1264 | tpr=0.7207 | fpr=0.8844 | 8145.3 samples/s | 31.8 steps/s
[Step= 350] | Loss=5.31253 | acc=0.1263 | tpr=0.7151 | fpr=0.8844 | 7842.2 samples/s | 30.6 steps/s
[Step= 400] | Loss=5.31587 | acc=0.1269 | tpr=0.7090 | fpr=0.8836 | 8014.7 samples/s | 31.3 steps/s
[Step= 450] | Loss=5.31811 | acc=0.1266 | tpr=0.7050 | fpr=0.8839 | 8053.5 samples/s | 31.5 steps/s
[Step= 500] | Loss=5.31898 | acc=0.1265 | tpr=0.7018 | fpr=0.8839 | 7851.1 samples/s | 30.7 steps/s
[Step= 550] | Loss=5.31973 | acc=0.1262 | tpr=0.7051 | fpr=0.8843 | 14886.3 samples/s | 58.1 steps/s
Avg test loss: 5.32166, Avg test acc: 0.12618, Avg tpr: 0.70523, Avg fpr: 0.88435, total FA: 122790

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.53986 | acc=0.1509 | tpr=0.7345 | fpr=0.8596 | 4090.8 samples/s | 16.0 steps/s
[Step= 100] | Loss=4.48285 | acc=0.1523 | tpr=0.6652 | fpr=0.8573 | 7840.3 samples/s | 30.6 steps/s
[Step= 150] | Loss=4.49252 | acc=0.1509 | tpr=0.6657 | fpr=0.8586 | 7698.2 samples/s | 30.1 steps/s
[Step= 200] | Loss=4.49272 | acc=0.1507 | tpr=0.6568 | fpr=0.8585 | 7806.7 samples/s | 30.5 steps/s
[Step= 250] | Loss=4.49062 | acc=0.1514 | tpr=0.6603 | fpr=0.8579 | 8397.1 samples/s | 32.8 steps/s
[Step= 300] | Loss=4.48882 | acc=0.1517 | tpr=0.6705 | fpr=0.8578 | 8115.5 samples/s | 31.7 steps/s
[Step= 350] | Loss=4.48548 | acc=0.1515 | tpr=0.6606 | fpr=0.8578 | 8041.3 samples/s | 31.4 steps/s
[Step= 400] | Loss=4.48679 | acc=0.1518 | tpr=0.6554 | fpr=0.8574 | 8441.7 samples/s | 33.0 steps/s
[Step= 450] | Loss=4.49208 | acc=0.1519 | tpr=0.6490 | fpr=0.8571 | 8402.1 samples/s | 32.8 steps/s
[Step= 500] | Loss=4.49726 | acc=0.1516 | tpr=0.6454 | fpr=0.8574 | 7444.7 samples/s | 29.1 steps/s
[Step= 550] | Loss=4.49706 | acc=0.1514 | tpr=0.6462 | fpr=0.8576 | 14903.5 samples/s | 58.2 steps/s
Avg test loss: 4.49861, Avg test acc: 0.15137, Avg tpr: 0.64620, Avg fpr: 0.85762, total FA: 119079

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.14776 | acc=0.1248 | tpr=0.6460 | fpr=0.8846 | 4084.2 samples/s | 16.0 steps/s
[Step= 100] | Loss=6.10154 | acc=0.1262 | tpr=0.6034 | fpr=0.8827 | 8145.7 samples/s | 31.8 steps/s
[Step= 150] | Loss=6.11920 | acc=0.1242 | tpr=0.6153 | fpr=0.8848 | 7821.2 samples/s | 30.6 steps/s
[Step= 200] | Loss=6.11919 | acc=0.1237 | tpr=0.6208 | fpr=0.8854 | 8108.7 samples/s | 31.7 steps/s
[Step= 250] | Loss=6.12245 | acc=0.1233 | tpr=0.6157 | fpr=0.8856 | 8218.2 samples/s | 32.1 steps/s
[Step= 300] | Loss=6.12204 | acc=0.1234 | tpr=0.6145 | fpr=0.8856 | 7870.0 samples/s | 30.7 steps/s
[Step= 350] | Loss=6.11866 | acc=0.1231 | tpr=0.6099 | fpr=0.8858 | 7990.2 samples/s | 31.2 steps/s
[Step= 400] | Loss=6.12116 | acc=0.1233 | tpr=0.6018 | fpr=0.8854 | 8008.3 samples/s | 31.3 steps/s
[Step= 450] | Loss=6.12255 | acc=0.1229 | tpr=0.5974 | fpr=0.8857 | 7858.4 samples/s | 30.7 steps/s
[Step= 500] | Loss=6.12258 | acc=0.1229 | tpr=0.5916 | fpr=0.8856 | 8002.7 samples/s | 31.3 steps/s
[Step= 550] | Loss=6.12254 | acc=0.1227 | tpr=0.5965 | fpr=0.8859 | 14289.5 samples/s | 55.8 steps/s
Avg test loss: 6.12411, Avg test acc: 0.12263, Avg tpr: 0.59628, Avg fpr: 0.88598, total FA: 123017

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.89480 | acc=0.1225 | tpr=0.6814 | fpr=0.8875 | 4071.0 samples/s | 15.9 steps/s
[Step= 100] | Loss=5.84119 | acc=0.1224 | tpr=0.6418 | fpr=0.8873 | 8137.1 samples/s | 31.8 steps/s
[Step= 150] | Loss=5.85543 | acc=0.1204 | tpr=0.6556 | fpr=0.8895 | 8197.9 samples/s | 32.0 steps/s
[Step= 200] | Loss=5.85217 | acc=0.1198 | tpr=0.6568 | fpr=0.8899 | 8478.1 samples/s | 33.1 steps/s
[Step= 250] | Loss=5.85249 | acc=0.1204 | tpr=0.6585 | fpr=0.8894 | 7774.8 samples/s | 30.4 steps/s
[Step= 300] | Loss=5.84769 | acc=0.1205 | tpr=0.6538 | fpr=0.8892 | 7958.3 samples/s | 31.1 steps/s
[Step= 350] | Loss=5.84290 | acc=0.1205 | tpr=0.6493 | fpr=0.8891 | 7454.7 samples/s | 29.1 steps/s
[Step= 400] | Loss=5.84429 | acc=0.1208 | tpr=0.6515 | fpr=0.8888 | 7501.0 samples/s | 29.3 steps/s
[Step= 450] | Loss=5.85015 | acc=0.1208 | tpr=0.6480 | fpr=0.8887 | 8120.5 samples/s | 31.7 steps/s
[Step= 500] | Loss=5.85379 | acc=0.1205 | tpr=0.6441 | fpr=0.8889 | 7732.3 samples/s | 30.2 steps/s
[Step= 550] | Loss=5.85408 | acc=0.1204 | tpr=0.6442 | fpr=0.8891 | 13901.2 samples/s | 54.3 steps/s
Avg test loss: 5.85577, Avg test acc: 0.12034, Avg tpr: 0.64422, Avg fpr: 0.88918, total FA: 123461

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.00482 | acc=0.1340 | tpr=0.6858 | fpr=0.8759 | 4119.4 samples/s | 16.1 steps/s
[Step= 100] | Loss=4.95277 | acc=0.1383 | tpr=0.5991 | fpr=0.8703 | 7330.1 samples/s | 28.6 steps/s
[Step= 150] | Loss=4.95787 | acc=0.1355 | tpr=0.5821 | fpr=0.8727 | 8178.7 samples/s | 31.9 steps/s
[Step= 200] | Loss=4.95991 | acc=0.1351 | tpr=0.5760 | fpr=0.8729 | 7707.6 samples/s | 30.1 steps/s
[Step= 250] | Loss=4.95656 | acc=0.1359 | tpr=0.5703 | fpr=0.8720 | 8011.0 samples/s | 31.3 steps/s
[Step= 300] | Loss=4.95309 | acc=0.1358 | tpr=0.5731 | fpr=0.8722 | 8021.5 samples/s | 31.3 steps/s
[Step= 350] | Loss=4.94745 | acc=0.1353 | tpr=0.5667 | fpr=0.8725 | 8311.9 samples/s | 32.5 steps/s
[Step= 400] | Loss=4.95082 | acc=0.1355 | tpr=0.5635 | fpr=0.8723 | 7395.1 samples/s | 28.9 steps/s
[Step= 450] | Loss=4.95288 | acc=0.1351 | tpr=0.5584 | fpr=0.8726 | 7766.3 samples/s | 30.3 steps/s
[Step= 500] | Loss=4.95401 | acc=0.1349 | tpr=0.5551 | fpr=0.8727 | 7965.7 samples/s | 31.1 steps/s
[Step= 550] | Loss=4.95468 | acc=0.1349 | tpr=0.5539 | fpr=0.8727 | 12980.0 samples/s | 50.7 steps/s
Avg test loss: 4.95754, Avg test acc: 0.13489, Avg tpr: 0.55428, Avg fpr: 0.87274, total FA: 121178

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10777 | acc=0.9796 | tpr=0.9336 | fpr=0.0196 | 4172.8 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.11143 | acc=0.9791 | tpr=0.9488 | fpr=0.0203 | 7726.7 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.11563 | acc=0.9782 | tpr=0.9467 | fpr=0.0212 | 8101.0 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.11745 | acc=0.9784 | tpr=0.9486 | fpr=0.0211 | 7797.8 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.11685 | acc=0.9784 | tpr=0.9441 | fpr=0.0210 | 7803.2 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.11880 | acc=0.9780 | tpr=0.9433 | fpr=0.0214 | 7726.5 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.11865 | acc=0.9779 | tpr=0.9430 | fpr=0.0215 | 8327.9 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.12024 | acc=0.9777 | tpr=0.9387 | fpr=0.0216 | 7999.0 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.12310 | acc=0.9774 | tpr=0.9382 | fpr=0.0219 | 7497.1 samples/s | 29.3 steps/s
[Step= 500] | Loss=0.12268 | acc=0.9774 | tpr=0.9392 | fpr=0.0219 | 7818.8 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.12158 | acc=0.9776 | tpr=0.9395 | fpr=0.0217 | 14818.5 samples/s | 57.9 steps/s
Avg test loss: 0.12142, Avg test acc: 0.97761, Avg tpr: 0.93978, Avg fpr: 0.02170, total FA: 3013

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11565 | acc=0.9817 | tpr=0.8850 | fpr=0.0165 | 4053.9 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.12022 | acc=0.9816 | tpr=0.8998 | fpr=0.0169 | 8142.5 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.12504 | acc=0.9805 | tpr=0.8963 | fpr=0.0180 | 7823.4 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.12689 | acc=0.9805 | tpr=0.9005 | fpr=0.0180 | 7675.9 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.12520 | acc=0.9806 | tpr=0.9004 | fpr=0.0179 | 8254.0 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.12741 | acc=0.9802 | tpr=0.9018 | fpr=0.0183 | 7879.6 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.12730 | acc=0.9801 | tpr=0.9036 | fpr=0.0185 | 8073.0 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.12915 | acc=0.9798 | tpr=0.8966 | fpr=0.0187 | 7801.1 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.13218 | acc=0.9795 | tpr=0.8948 | fpr=0.0189 | 7350.4 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.13167 | acc=0.9796 | tpr=0.8987 | fpr=0.0189 | 7433.9 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.13074 | acc=0.9797 | tpr=0.8981 | fpr=0.0188 | 14762.5 samples/s | 57.7 steps/s
Avg test loss: 0.13052, Avg test acc: 0.97971, Avg tpr: 0.89739, Avg fpr: 0.01879, total FA: 2609

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11032 | acc=0.9796 | tpr=0.9292 | fpr=0.0195 | 4165.6 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.11420 | acc=0.9793 | tpr=0.9510 | fpr=0.0202 | 7782.7 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.11886 | acc=0.9783 | tpr=0.9539 | fpr=0.0212 | 7696.7 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.12145 | acc=0.9782 | tpr=0.9563 | fpr=0.0214 | 7100.4 samples/s | 27.7 steps/s
[Step= 250] | Loss=0.12052 | acc=0.9782 | tpr=0.9537 | fpr=0.0214 | 7776.5 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.12255 | acc=0.9777 | tpr=0.9549 | fpr=0.0219 | 8173.9 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.12241 | acc=0.9776 | tpr=0.9555 | fpr=0.0220 | 7744.2 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.12377 | acc=0.9775 | tpr=0.9519 | fpr=0.0220 | 8159.7 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.12661 | acc=0.9772 | tpr=0.9508 | fpr=0.0223 | 7722.9 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.12616 | acc=0.9772 | tpr=0.9511 | fpr=0.0224 | 7944.5 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.12482 | acc=0.9774 | tpr=0.9515 | fpr=0.0221 | 14703.1 samples/s | 57.4 steps/s
Avg test loss: 0.12464, Avg test acc: 0.97741, Avg tpr: 0.95087, Avg fpr: 0.02210, total FA: 3069

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11895 | acc=0.9814 | tpr=0.9159 | fpr=0.0174 | 4137.4 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.12446 | acc=0.9808 | tpr=0.9403 | fpr=0.0185 | 8283.9 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.12987 | acc=0.9798 | tpr=0.9366 | fpr=0.0194 | 8084.9 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.13213 | acc=0.9796 | tpr=0.9399 | fpr=0.0197 | 7042.8 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.13068 | acc=0.9795 | tpr=0.9397 | fpr=0.0197 | 7950.7 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.13284 | acc=0.9791 | tpr=0.9375 | fpr=0.0201 | 7806.4 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.13266 | acc=0.9790 | tpr=0.9405 | fpr=0.0203 | 8070.2 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.13408 | acc=0.9788 | tpr=0.9354 | fpr=0.0204 | 8374.3 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.13708 | acc=0.9785 | tpr=0.9314 | fpr=0.0207 | 7773.7 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.13664 | acc=0.9785 | tpr=0.9322 | fpr=0.0207 | 7939.7 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.13562 | acc=0.9787 | tpr=0.9327 | fpr=0.0205 | 14421.1 samples/s | 56.3 steps/s
Avg test loss: 0.13543, Avg test acc: 0.97864, Avg tpr: 0.93225, Avg fpr: 0.02052, total FA: 2849

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.11393 | acc=0.9821 | tpr=0.8761 | fpr=0.0160 | 4112.2 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.11810 | acc=0.9817 | tpr=0.9041 | fpr=0.0169 | 8114.2 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.12218 | acc=0.9807 | tpr=0.9150 | fpr=0.0181 | 8148.0 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.12509 | acc=0.9804 | tpr=0.9115 | fpr=0.0183 | 7654.3 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.12380 | acc=0.9804 | tpr=0.9066 | fpr=0.0182 | 8116.3 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.12615 | acc=0.9802 | tpr=0.9033 | fpr=0.0184 | 8053.5 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.12714 | acc=0.9800 | tpr=0.9029 | fpr=0.0186 | 8109.9 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.12811 | acc=0.9797 | tpr=0.8982 | fpr=0.0188 | 8323.2 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.13108 | acc=0.9795 | tpr=0.8992 | fpr=0.0191 | 7953.1 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.13058 | acc=0.9795 | tpr=0.8996 | fpr=0.0191 | 7726.1 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.12986 | acc=0.9796 | tpr=0.8981 | fpr=0.0190 | 14422.7 samples/s | 56.3 steps/s
Avg test loss: 0.12956, Avg test acc: 0.97956, Avg tpr: 0.89739, Avg fpr: 0.01894, total FA: 2630

server round 21/50

clients selected: [0 3 4 6 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=20001 Epoch=97.5] | Loss=0.01060 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.989 | L2-Norm(final)=8.911 | 3756.2 samples/s | 58.7 steps/s
[Step=20050 Epoch=97.8] | Loss=0.03026 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.009 | L2-Norm(final)=8.905 | 4851.0 samples/s | 75.8 steps/s
[Step=20100 Epoch=98.0] | Loss=0.02714 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.038 | L2-Norm(final)=8.904 | 5056.5 samples/s | 79.0 steps/s
[Step=20150 Epoch=98.3] | Loss=0.02764 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.066 | L2-Norm(final)=8.909 | 5159.9 samples/s | 80.6 steps/s
[Step=20200 Epoch=98.5] | Loss=0.02704 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.091 | L2-Norm(final)=8.916 | 7230.3 samples/s | 113.0 steps/s
[Step=20250 Epoch=98.7] | Loss=0.02605 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.115 | L2-Norm(final)=8.924 | 1807.9 samples/s | 28.2 steps/s
[Step=20300 Epoch=99.0] | Loss=0.02447 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.139 | L2-Norm(final)=8.934 | 5258.0 samples/s | 82.2 steps/s
[Step=20350 Epoch=99.2] | Loss=0.02354 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=8.947 | 5167.1 samples/s | 80.7 steps/s
[Step=20400 Epoch=99.5] | Loss=0.02315 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.186 | L2-Norm(final)=8.961 | 6601.4 samples/s | 103.1 steps/s
[Step=20450 Epoch=99.7] | Loss=0.02217 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.207 | L2-Norm(final)=8.975 | 1848.4 samples/s | 28.9 steps/s
[Step=20500 Epoch=100.0] | Loss=0.02147 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.229 | L2-Norm(final)=8.990 | 5196.5 samples/s | 81.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=100.0] | Loss=0.00915 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.446 | L2-Norm(final)=9.146 | 3625.3 samples/s | 56.6 steps/s
[Step=20550 Epoch=100.2] | Loss=0.01861 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.476 | L2-Norm(final)=9.162 | 4655.8 samples/s | 72.7 steps/s
[Step=20600 Epoch=100.4] | Loss=0.02152 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.503 | L2-Norm(final)=9.170 | 4748.6 samples/s | 74.2 steps/s
[Step=20650 Epoch=100.7] | Loss=0.02185 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.527 | L2-Norm(final)=9.174 | 4578.5 samples/s | 71.5 steps/s
[Step=20700 Epoch=100.9] | Loss=0.02206 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.548 | L2-Norm(final)=9.179 | 6222.8 samples/s | 97.2 steps/s
[Step=20750 Epoch=101.2] | Loss=0.02173 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.566 | L2-Norm(final)=9.182 | 1746.3 samples/s | 27.3 steps/s
[Step=20800 Epoch=101.4] | Loss=0.01988 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.581 | L2-Norm(final)=9.185 | 4604.8 samples/s | 71.9 steps/s
[Step=20850 Epoch=101.7] | Loss=0.01886 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.595 | L2-Norm(final)=9.189 | 4560.9 samples/s | 71.3 steps/s
[Step=20900 Epoch=101.9] | Loss=0.01766 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.607 | L2-Norm(final)=9.193 | 5719.5 samples/s | 89.4 steps/s
[Step=20950 Epoch=102.2] | Loss=0.01658 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.617 | L2-Norm(final)=9.198 | 1773.4 samples/s | 27.7 steps/s
[Step=21000 Epoch=102.4] | Loss=0.01556 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.626 | L2-Norm(final)=9.202 | 4626.8 samples/s | 72.3 steps/s
[Step=21050 Epoch=102.6] | Loss=0.01467 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.634 | L2-Norm(final)=9.207 | 4707.7 samples/s | 73.6 steps/s
[Step=21100 Epoch=102.9] | Loss=0.01392 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.642 | L2-Norm(final)=9.211 | 5340.9 samples/s | 83.5 steps/s
[Step=21150 Epoch=103.1] | Loss=0.01330 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.648 | L2-Norm(final)=9.215 | 1813.4 samples/s | 28.3 steps/s
[Step=21200 Epoch=103.4] | Loss=0.01266 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.654 | L2-Norm(final)=9.219 | 4525.4 samples/s | 70.7 steps/s
[Step=21250 Epoch=103.6] | Loss=0.01211 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.659 | L2-Norm(final)=9.223 | 4643.9 samples/s | 72.6 steps/s
[Step=21300 Epoch=103.9] | Loss=0.01172 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.664 | L2-Norm(final)=9.227 | 5156.0 samples/s | 80.6 steps/s
[Step=21350 Epoch=104.1] | Loss=0.01126 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.669 | L2-Norm(final)=9.231 | 1894.6 samples/s | 29.6 steps/s
[Step=21400 Epoch=104.4] | Loss=0.01087 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=9.234 | 4631.3 samples/s | 72.4 steps/s
[Step=21450 Epoch=104.6] | Loss=0.01052 | Reg=0.00161 | acc=0.9688 | L2-Norm=12.677 | L2-Norm(final)=9.238 | 4548.2 samples/s | 71.1 steps/s
[Step=21500 Epoch=104.8] | Loss=0.01026 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.680 | L2-Norm(final)=9.241 | 4712.2 samples/s | 73.6 steps/s
[Step=21550 Epoch=105.1] | Loss=0.00996 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.684 | L2-Norm(final)=9.245 | 1906.6 samples/s | 29.8 steps/s
[Step=21600 Epoch=105.3] | Loss=0.00965 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=9.248 | 4574.1 samples/s | 71.5 steps/s
[Step=21650 Epoch=105.6] | Loss=0.00943 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.690 | L2-Norm(final)=9.251 | 4583.7 samples/s | 71.6 steps/s
[Step=21700 Epoch=105.8] | Loss=0.00921 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.693 | L2-Norm(final)=9.254 | 4510.1 samples/s | 70.5 steps/s
[Step=21750 Epoch=106.1] | Loss=0.00895 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.696 | L2-Norm(final)=9.257 | 1928.4 samples/s | 30.1 steps/s
[Step=21800 Epoch=106.3] | Loss=0.00870 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.698 | L2-Norm(final)=9.260 | 4681.0 samples/s | 73.1 steps/s
[Step=21850 Epoch=106.5] | Loss=0.00853 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.701 | L2-Norm(final)=9.264 | 4576.2 samples/s | 71.5 steps/s
[Step=21900 Epoch=106.8] | Loss=0.00837 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.703 | L2-Norm(final)=9.267 | 4584.7 samples/s | 71.6 steps/s
[Step=21950 Epoch=107.0] | Loss=0.00820 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.705 | L2-Norm(final)=9.270 | 1959.2 samples/s | 30.6 steps/s
[Step=22000 Epoch=107.3] | Loss=0.00803 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.707 | L2-Norm(final)=9.272 | 4747.1 samples/s | 74.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step22000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=12001 Epoch=58.5] | Loss=0.05393 | Reg=0.00144 | acc=0.9219 | L2-Norm=11.989 | L2-Norm(final)=7.735 | 3771.3 samples/s | 58.9 steps/s
[Step=12050 Epoch=58.8] | Loss=0.02834 | Reg=0.00144 | acc=0.9688 | L2-Norm=12.011 | L2-Norm(final)=7.735 | 4824.2 samples/s | 75.4 steps/s
[Step=12100 Epoch=59.0] | Loss=0.02777 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.034 | L2-Norm(final)=7.741 | 5208.7 samples/s | 81.4 steps/s
[Step=12150 Epoch=59.3] | Loss=0.02655 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.057 | L2-Norm(final)=7.751 | 5178.7 samples/s | 80.9 steps/s
[Step=12200 Epoch=59.5] | Loss=0.02667 | Reg=0.00146 | acc=0.9531 | L2-Norm=12.082 | L2-Norm(final)=7.761 | 7089.9 samples/s | 110.8 steps/s
[Step=12250 Epoch=59.7] | Loss=0.02504 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.106 | L2-Norm(final)=7.772 | 1800.0 samples/s | 28.1 steps/s
[Step=12300 Epoch=60.0] | Loss=0.02403 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.130 | L2-Norm(final)=7.785 | 5193.1 samples/s | 81.1 steps/s
[Step=12350 Epoch=60.2] | Loss=0.02369 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.153 | L2-Norm(final)=7.799 | 5200.9 samples/s | 81.3 steps/s
[Step=12400 Epoch=60.5] | Loss=0.02290 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.175 | L2-Norm(final)=7.813 | 6941.6 samples/s | 108.5 steps/s
[Step=12450 Epoch=60.7] | Loss=0.02293 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.198 | L2-Norm(final)=7.827 | 1924.7 samples/s | 30.1 steps/s
[Step=12500 Epoch=61.0] | Loss=0.02239 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.222 | L2-Norm(final)=7.842 | 5155.0 samples/s | 80.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=12501 Epoch=61.0] | Loss=0.00246 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=7.986 | 3741.8 samples/s | 58.5 steps/s
[Step=12550 Epoch=61.2] | Loss=0.01557 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.474 | L2-Norm(final)=8.001 | 4130.3 samples/s | 64.5 steps/s
[Step=12600 Epoch=61.4] | Loss=0.01537 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=8.016 | 4466.3 samples/s | 69.8 steps/s
[Step=12650 Epoch=61.7] | Loss=0.01653 | Reg=0.00157 | acc=0.9531 | L2-Norm=12.513 | L2-Norm(final)=8.027 | 4393.0 samples/s | 68.6 steps/s
[Step=12700 Epoch=61.9] | Loss=0.01633 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=8.036 | 5820.7 samples/s | 90.9 steps/s
[Step=12750 Epoch=62.2] | Loss=0.01522 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.545 | L2-Norm(final)=8.043 | 1691.7 samples/s | 26.4 steps/s
[Step=12800 Epoch=62.4] | Loss=0.01373 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.558 | L2-Norm(final)=8.051 | 4293.1 samples/s | 67.1 steps/s
[Step=12850 Epoch=62.7] | Loss=0.01282 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.570 | L2-Norm(final)=8.058 | 4404.4 samples/s | 68.8 steps/s
[Step=12900 Epoch=62.9] | Loss=0.01240 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.580 | L2-Norm(final)=8.065 | 5595.8 samples/s | 87.4 steps/s
[Step=12950 Epoch=63.2] | Loss=0.01179 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.590 | L2-Norm(final)=8.071 | 1759.4 samples/s | 27.5 steps/s
[Step=13000 Epoch=63.4] | Loss=0.01124 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.599 | L2-Norm(final)=8.077 | 4465.5 samples/s | 69.8 steps/s
[Step=13050 Epoch=63.6] | Loss=0.01076 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.606 | L2-Norm(final)=8.083 | 4475.1 samples/s | 69.9 steps/s
[Step=13100 Epoch=63.9] | Loss=0.01025 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.614 | L2-Norm(final)=8.088 | 5169.2 samples/s | 80.8 steps/s
[Step=13150 Epoch=64.1] | Loss=0.00973 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.621 | L2-Norm(final)=8.093 | 1845.4 samples/s | 28.8 steps/s
[Step=13200 Epoch=64.4] | Loss=0.00939 | Reg=0.00159 | acc=0.9688 | L2-Norm=12.627 | L2-Norm(final)=8.099 | 4576.8 samples/s | 71.5 steps/s
[Step=13250 Epoch=64.6] | Loss=0.00898 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.633 | L2-Norm(final)=8.104 | 4534.4 samples/s | 70.9 steps/s
[Step=13300 Epoch=64.9] | Loss=0.00881 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.639 | L2-Norm(final)=8.109 | 5086.1 samples/s | 79.5 steps/s
[Step=13350 Epoch=65.1] | Loss=0.00840 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.645 | L2-Norm(final)=8.113 | 1903.1 samples/s | 29.7 steps/s
[Step=13400 Epoch=65.3] | Loss=0.00821 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.650 | L2-Norm(final)=8.118 | 4547.4 samples/s | 71.1 steps/s
[Step=13450 Epoch=65.6] | Loss=0.00800 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.655 | L2-Norm(final)=8.123 | 4557.9 samples/s | 71.2 steps/s
[Step=13500 Epoch=65.8] | Loss=0.00781 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.660 | L2-Norm(final)=8.127 | 4645.7 samples/s | 72.6 steps/s
[Step=13550 Epoch=66.1] | Loss=0.00760 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.664 | L2-Norm(final)=8.131 | 1915.9 samples/s | 29.9 steps/s
[Step=13600 Epoch=66.3] | Loss=0.00736 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.668 | L2-Norm(final)=8.135 | 4679.8 samples/s | 73.1 steps/s
[Step=13650 Epoch=66.6] | Loss=0.00730 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.672 | L2-Norm(final)=8.139 | 4493.6 samples/s | 70.2 steps/s
[Step=13700 Epoch=66.8] | Loss=0.00709 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.676 | L2-Norm(final)=8.143 | 4549.3 samples/s | 71.1 steps/s
[Step=13750 Epoch=67.1] | Loss=0.00702 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.679 | L2-Norm(final)=8.146 | 1928.2 samples/s | 30.1 steps/s
[Step=13800 Epoch=67.3] | Loss=0.00693 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.683 | L2-Norm(final)=8.150 | 4762.9 samples/s | 74.4 steps/s
[Step=13850 Epoch=67.5] | Loss=0.00682 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.686 | L2-Norm(final)=8.153 | 4633.1 samples/s | 72.4 steps/s
[Step=13900 Epoch=67.8] | Loss=0.00669 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.689 | L2-Norm(final)=8.157 | 4568.0 samples/s | 71.4 steps/s
[Step=13950 Epoch=68.0] | Loss=0.00656 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.692 | L2-Norm(final)=8.160 | 1941.6 samples/s | 30.3 steps/s
[Step=14000 Epoch=68.3] | Loss=0.00639 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.695 | L2-Norm(final)=8.163 | 4627.6 samples/s | 72.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step14000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=26001 Epoch=127.5] | Loss=0.01730 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.989 | L2-Norm(final)=10.447 | 4049.0 samples/s | 63.3 steps/s
[Step=26050 Epoch=127.7] | Loss=0.02779 | Reg=0.00144 | acc=0.9531 | L2-Norm=12.004 | L2-Norm(final)=10.442 | 4606.1 samples/s | 72.0 steps/s
[Step=26100 Epoch=128.0] | Loss=0.02504 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.031 | L2-Norm(final)=10.432 | 4899.0 samples/s | 76.5 steps/s
[Step=26150 Epoch=128.2] | Loss=0.02306 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.052 | L2-Norm(final)=10.432 | 4922.0 samples/s | 76.9 steps/s
[Step=26200 Epoch=128.5] | Loss=0.02243 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.071 | L2-Norm(final)=10.436 | 7415.7 samples/s | 115.9 steps/s
[Step=26250 Epoch=128.7] | Loss=0.02103 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.090 | L2-Norm(final)=10.442 | 1788.3 samples/s | 27.9 steps/s
[Step=26300 Epoch=129.0] | Loss=0.01979 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.108 | L2-Norm(final)=10.450 | 5226.0 samples/s | 81.7 steps/s
[Step=26350 Epoch=129.2] | Loss=0.01878 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.126 | L2-Norm(final)=10.460 | 5125.6 samples/s | 80.1 steps/s
[Step=26400 Epoch=129.5] | Loss=0.01857 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.143 | L2-Norm(final)=10.470 | 7255.4 samples/s | 113.4 steps/s
[Step=26450 Epoch=129.7] | Loss=0.01790 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=10.482 | 1828.3 samples/s | 28.6 steps/s
[Step=26500 Epoch=130.0] | Loss=0.01718 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.176 | L2-Norm(final)=10.494 | 5131.2 samples/s | 80.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=130.0] | Loss=0.01143 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.343 | L2-Norm(final)=10.619 | 3575.8 samples/s | 55.9 steps/s
[Step=26550 Epoch=130.2] | Loss=0.01225 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.359 | L2-Norm(final)=10.633 | 4561.1 samples/s | 71.3 steps/s
[Step=26600 Epoch=130.4] | Loss=0.01472 | Reg=0.00153 | acc=0.9531 | L2-Norm=12.377 | L2-Norm(final)=10.642 | 4649.6 samples/s | 72.7 steps/s
[Step=26650 Epoch=130.7] | Loss=0.01564 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.393 | L2-Norm(final)=10.649 | 4303.5 samples/s | 67.2 steps/s
[Step=26700 Epoch=130.9] | Loss=0.01503 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.407 | L2-Norm(final)=10.653 | 6284.7 samples/s | 98.2 steps/s
[Step=26750 Epoch=131.2] | Loss=0.01345 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.420 | L2-Norm(final)=10.658 | 1727.7 samples/s | 27.0 steps/s
[Step=26800 Epoch=131.4] | Loss=0.01250 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.431 | L2-Norm(final)=10.664 | 4558.9 samples/s | 71.2 steps/s
[Step=26850 Epoch=131.7] | Loss=0.01208 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.441 | L2-Norm(final)=10.668 | 4586.7 samples/s | 71.7 steps/s
[Step=26900 Epoch=131.9] | Loss=0.01166 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.449 | L2-Norm(final)=10.672 | 5910.6 samples/s | 92.4 steps/s
[Step=26950 Epoch=132.2] | Loss=0.01111 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.457 | L2-Norm(final)=10.676 | 1757.4 samples/s | 27.5 steps/s
[Step=27000 Epoch=132.4] | Loss=0.01060 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.465 | L2-Norm(final)=10.679 | 4519.6 samples/s | 70.6 steps/s
[Step=27050 Epoch=132.6] | Loss=0.00999 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.471 | L2-Norm(final)=10.683 | 4598.9 samples/s | 71.9 steps/s
[Step=27100 Epoch=132.9] | Loss=0.00978 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.477 | L2-Norm(final)=10.687 | 5625.4 samples/s | 87.9 steps/s
[Step=27150 Epoch=133.1] | Loss=0.00941 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=10.691 | 1780.5 samples/s | 27.8 steps/s
[Step=27200 Epoch=133.4] | Loss=0.00906 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.489 | L2-Norm(final)=10.694 | 4390.6 samples/s | 68.6 steps/s
[Step=27250 Epoch=133.6] | Loss=0.00873 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.494 | L2-Norm(final)=10.697 | 4528.8 samples/s | 70.8 steps/s
[Step=27300 Epoch=133.9] | Loss=0.00848 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=10.701 | 5312.2 samples/s | 83.0 steps/s
[Step=27350 Epoch=134.1] | Loss=0.00831 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.503 | L2-Norm(final)=10.704 | 1826.2 samples/s | 28.5 steps/s
[Step=27400 Epoch=134.4] | Loss=0.00802 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.506 | L2-Norm(final)=10.706 | 4489.5 samples/s | 70.1 steps/s
[Step=27450 Epoch=134.6] | Loss=0.00778 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.510 | L2-Norm(final)=10.709 | 4528.5 samples/s | 70.8 steps/s
[Step=27500 Epoch=134.9] | Loss=0.00759 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.513 | L2-Norm(final)=10.712 | 5191.7 samples/s | 81.1 steps/s
[Step=27550 Epoch=135.1] | Loss=0.00740 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.516 | L2-Norm(final)=10.715 | 1814.9 samples/s | 28.4 steps/s
[Step=27600 Epoch=135.3] | Loss=0.00717 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.519 | L2-Norm(final)=10.717 | 4607.6 samples/s | 72.0 steps/s
[Step=27650 Epoch=135.6] | Loss=0.00699 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.522 | L2-Norm(final)=10.720 | 4602.9 samples/s | 71.9 steps/s
[Step=27700 Epoch=135.8] | Loss=0.00686 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.525 | L2-Norm(final)=10.723 | 4698.4 samples/s | 73.4 steps/s
[Step=27750 Epoch=136.1] | Loss=0.00672 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.527 | L2-Norm(final)=10.726 | 1833.8 samples/s | 28.7 steps/s
[Step=27800 Epoch=136.3] | Loss=0.00653 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=10.728 | 4424.1 samples/s | 69.1 steps/s
[Step=27850 Epoch=136.6] | Loss=0.00644 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.532 | L2-Norm(final)=10.731 | 4345.6 samples/s | 67.9 steps/s
[Step=27900 Epoch=136.8] | Loss=0.00634 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.535 | L2-Norm(final)=10.733 | 4479.4 samples/s | 70.0 steps/s
[Step=27950 Epoch=137.1] | Loss=0.00630 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=10.736 | 1833.8 samples/s | 28.7 steps/s
[Step=28000 Epoch=137.3] | Loss=0.00618 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.539 | L2-Norm(final)=10.738 | 4612.4 samples/s | 72.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step28000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=24001 Epoch=228.3] | Loss=0.00562 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.989 | L2-Norm(final)=8.308 | 3618.6 samples/s | 56.5 steps/s
[Step=24050 Epoch=228.8] | Loss=0.00426 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.052 | L2-Norm(final)=8.320 | 4181.9 samples/s | 65.3 steps/s
[Step=24100 Epoch=229.3] | Loss=0.00259 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.104 | L2-Norm(final)=8.335 | 6324.7 samples/s | 98.8 steps/s
[Step=24150 Epoch=229.7] | Loss=0.00183 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.127 | L2-Norm(final)=8.350 | 1665.3 samples/s | 26.0 steps/s
[Step=24200 Epoch=230.2] | Loss=0.00141 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=8.363 | 5968.7 samples/s | 93.3 steps/s
[Step=24250 Epoch=230.7] | Loss=0.00116 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=8.373 | 1802.4 samples/s | 28.2 steps/s
[Step=24300 Epoch=231.2] | Loss=0.00098 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=8.382 | 5493.1 samples/s | 85.8 steps/s
[Step=24350 Epoch=231.6] | Loss=0.00086 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=8.391 | 1833.0 samples/s | 28.6 steps/s
[Step=24400 Epoch=232.1] | Loss=0.00077 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=8.399 | 5308.3 samples/s | 82.9 steps/s
[Step=24450 Epoch=232.6] | Loss=0.00069 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=8.407 | 1878.4 samples/s | 29.3 steps/s
[Step=24500 Epoch=233.1] | Loss=0.00063 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.133 | L2-Norm(final)=8.414 | 5093.1 samples/s | 79.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=233.1] | Loss=0.00004 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.097 | L2-Norm(final)=8.485 | 3643.1 samples/s | 56.9 steps/s
[Step=24550 Epoch=233.5] | Loss=0.00016 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.087 | L2-Norm(final)=8.491 | 4015.5 samples/s | 62.7 steps/s
[Step=24600 Epoch=234.0] | Loss=0.00184 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.090 | L2-Norm(final)=8.497 | 5525.6 samples/s | 86.3 steps/s
[Step=24650 Epoch=234.5] | Loss=0.00141 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.123 | L2-Norm(final)=8.493 | 1605.5 samples/s | 25.1 steps/s
[Step=24700 Epoch=235.0] | Loss=0.00137 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.143 | L2-Norm(final)=8.492 | 5264.9 samples/s | 82.3 steps/s
[Step=24750 Epoch=235.4] | Loss=0.00113 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.156 | L2-Norm(final)=8.492 | 1739.9 samples/s | 27.2 steps/s
[Step=24800 Epoch=235.9] | Loss=0.00094 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=8.493 | 5067.8 samples/s | 79.2 steps/s
[Step=24850 Epoch=236.4] | Loss=0.00081 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=8.493 | 1811.6 samples/s | 28.3 steps/s
[Step=24900 Epoch=236.9] | Loss=0.00071 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.166 | L2-Norm(final)=8.494 | 4856.8 samples/s | 75.9 steps/s
[Step=24950 Epoch=237.3] | Loss=0.00063 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.164 | L2-Norm(final)=8.494 | 1791.1 samples/s | 28.0 steps/s
[Step=25000 Epoch=237.8] | Loss=0.00057 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.161 | L2-Norm(final)=8.495 | 4503.6 samples/s | 70.4 steps/s
[Step=25050 Epoch=238.3] | Loss=0.00052 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.157 | L2-Norm(final)=8.495 | 1859.3 samples/s | 29.1 steps/s
[Step=25100 Epoch=238.8] | Loss=0.00048 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.152 | L2-Norm(final)=8.496 | 4208.0 samples/s | 65.8 steps/s
[Step=25150 Epoch=239.2] | Loss=0.00044 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.146 | L2-Norm(final)=8.496 | 1882.5 samples/s | 29.4 steps/s
[Step=25200 Epoch=239.7] | Loss=0.00041 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.141 | L2-Norm(final)=8.497 | 4341.7 samples/s | 67.8 steps/s
[Step=25250 Epoch=240.2] | Loss=0.00038 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.134 | L2-Norm(final)=8.497 | 1900.7 samples/s | 29.7 steps/s
[Step=25300 Epoch=240.7] | Loss=0.00036 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.128 | L2-Norm(final)=8.497 | 4268.7 samples/s | 66.7 steps/s
[Step=25350 Epoch=241.1] | Loss=0.00034 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.121 | L2-Norm(final)=8.498 | 1951.3 samples/s | 30.5 steps/s
[Step=25400 Epoch=241.6] | Loss=0.00032 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.114 | L2-Norm(final)=8.498 | 4158.2 samples/s | 65.0 steps/s
[Step=25450 Epoch=242.1] | Loss=0.00030 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.106 | L2-Norm(final)=8.499 | 5927.2 samples/s | 92.6 steps/s
[Step=25500 Epoch=242.6] | Loss=0.00029 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.099 | L2-Norm(final)=8.499 | 1643.7 samples/s | 25.7 steps/s
[Step=25550 Epoch=243.0] | Loss=0.00027 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.091 | L2-Norm(final)=8.499 | 5544.0 samples/s | 86.6 steps/s
[Step=25600 Epoch=243.5] | Loss=0.00026 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.083 | L2-Norm(final)=8.500 | 1728.0 samples/s | 27.0 steps/s
[Step=25650 Epoch=244.0] | Loss=0.00025 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.075 | L2-Norm(final)=8.500 | 5123.8 samples/s | 80.1 steps/s
[Step=25700 Epoch=244.5] | Loss=0.00024 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.067 | L2-Norm(final)=8.501 | 1780.2 samples/s | 27.8 steps/s
[Step=25750 Epoch=244.9] | Loss=0.00023 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.059 | L2-Norm(final)=8.501 | 4743.2 samples/s | 74.1 steps/s
[Step=25800 Epoch=245.4] | Loss=0.00022 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.050 | L2-Norm(final)=8.501 | 1752.2 samples/s | 27.4 steps/s
[Step=25850 Epoch=245.9] | Loss=0.00021 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.042 | L2-Norm(final)=8.502 | 4505.7 samples/s | 70.4 steps/s
[Step=25900 Epoch=246.4] | Loss=0.00021 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.033 | L2-Norm(final)=8.502 | 1851.9 samples/s | 28.9 steps/s
[Step=25950 Epoch=246.8] | Loss=0.00020 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.024 | L2-Norm(final)=8.503 | 4394.9 samples/s | 68.7 steps/s
[Step=26000 Epoch=247.3] | Loss=0.00019 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.015 | L2-Norm(final)=8.503 | 1849.3 samples/s | 28.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step26000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=18001 Epoch=171.6] | Loss=0.00724 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.989 | L2-Norm(final)=7.815 | 3884.0 samples/s | 60.7 steps/s
[Step=18050 Epoch=172.0] | Loss=0.00222 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.013 | L2-Norm(final)=7.831 | 4396.1 samples/s | 68.7 steps/s
[Step=18100 Epoch=172.5] | Loss=0.00175 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.038 | L2-Norm(final)=7.849 | 7508.2 samples/s | 117.3 steps/s
[Step=18150 Epoch=173.0] | Loss=0.00126 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.057 | L2-Norm(final)=7.865 | 1749.1 samples/s | 27.3 steps/s
[Step=18200 Epoch=173.5] | Loss=0.00101 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.066 | L2-Norm(final)=7.877 | 6076.6 samples/s | 94.9 steps/s
[Step=18250 Epoch=173.9] | Loss=0.00085 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.071 | L2-Norm(final)=7.887 | 1697.5 samples/s | 26.5 steps/s
[Step=18300 Epoch=174.4] | Loss=0.00074 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=7.896 | 5593.9 samples/s | 87.4 steps/s
[Step=18350 Epoch=174.9] | Loss=0.00066 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.074 | L2-Norm(final)=7.905 | 1722.0 samples/s | 26.9 steps/s
[Step=18400 Epoch=175.4] | Loss=0.00059 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.073 | L2-Norm(final)=7.913 | 5304.1 samples/s | 82.9 steps/s
[Step=18450 Epoch=175.8] | Loss=0.00054 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.072 | L2-Norm(final)=7.920 | 1834.6 samples/s | 28.7 steps/s
[Step=18500 Epoch=176.3] | Loss=0.00049 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=7.927 | 5296.6 samples/s | 82.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=176.3] | Loss=0.00009 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.046 | L2-Norm(final)=7.995 | 3582.1 samples/s | 56.0 steps/s
[Step=18550 Epoch=176.8] | Loss=0.00009 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.040 | L2-Norm(final)=8.001 | 4130.6 samples/s | 64.5 steps/s
[Step=18600 Epoch=177.3] | Loss=0.00008 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.033 | L2-Norm(final)=8.005 | 5982.4 samples/s | 93.5 steps/s
[Step=18650 Epoch=177.8] | Loss=0.00006 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.024 | L2-Norm(final)=8.009 | 1647.7 samples/s | 25.7 steps/s
[Step=18700 Epoch=178.2] | Loss=0.00005 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.014 | L2-Norm(final)=8.012 | 5512.0 samples/s | 86.1 steps/s
[Step=18750 Epoch=178.7] | Loss=0.00005 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.004 | L2-Norm(final)=8.014 | 1622.4 samples/s | 25.3 steps/s
[Step=18800 Epoch=179.2] | Loss=0.00004 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.994 | L2-Norm(final)=8.017 | 4750.0 samples/s | 74.2 steps/s
[Step=18850 Epoch=179.7] | Loss=0.00004 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.984 | L2-Norm(final)=8.019 | 1743.6 samples/s | 27.2 steps/s
[Step=18900 Epoch=180.1] | Loss=0.00004 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.973 | L2-Norm(final)=8.021 | 4958.6 samples/s | 77.5 steps/s
[Step=18950 Epoch=180.6] | Loss=0.00004 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.962 | L2-Norm(final)=8.023 | 1794.2 samples/s | 28.0 steps/s
[Step=19000 Epoch=181.1] | Loss=0.00003 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.951 | L2-Norm(final)=8.024 | 4591.7 samples/s | 71.7 steps/s
[Step=19050 Epoch=181.6] | Loss=0.00003 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.941 | L2-Norm(final)=8.026 | 1768.8 samples/s | 27.6 steps/s
[Step=19100 Epoch=182.0] | Loss=0.00003 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.929 | L2-Norm(final)=8.028 | 4275.6 samples/s | 66.8 steps/s
[Step=19150 Epoch=182.5] | Loss=0.00003 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.918 | L2-Norm(final)=8.029 | 1828.8 samples/s | 28.6 steps/s
[Step=19200 Epoch=183.0] | Loss=0.00003 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.907 | L2-Norm(final)=8.031 | 4159.6 samples/s | 65.0 steps/s
[Step=19250 Epoch=183.5] | Loss=0.00003 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.896 | L2-Norm(final)=8.032 | 1810.7 samples/s | 28.3 steps/s
[Step=19300 Epoch=183.9] | Loss=0.00003 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.884 | L2-Norm(final)=8.034 | 4533.9 samples/s | 70.8 steps/s
[Step=19350 Epoch=184.4] | Loss=0.00002 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.873 | L2-Norm(final)=8.035 | 1860.2 samples/s | 29.1 steps/s
[Step=19400 Epoch=184.9] | Loss=0.00002 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.861 | L2-Norm(final)=8.036 | 4307.3 samples/s | 67.3 steps/s
[Step=19450 Epoch=185.4] | Loss=0.00002 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.850 | L2-Norm(final)=8.038 | 1795.1 samples/s | 28.0 steps/s
[Step=19500 Epoch=185.9] | Loss=0.00002 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.838 | L2-Norm(final)=8.039 | 4096.4 samples/s | 64.0 steps/s
[Step=19550 Epoch=186.3] | Loss=0.00002 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.826 | L2-Norm(final)=8.040 | 6077.1 samples/s | 95.0 steps/s
[Step=19600 Epoch=186.8] | Loss=0.00002 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.814 | L2-Norm(final)=8.042 | 1695.2 samples/s | 26.5 steps/s
[Step=19650 Epoch=187.3] | Loss=0.00002 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.802 | L2-Norm(final)=8.043 | 5852.3 samples/s | 91.4 steps/s
[Step=19700 Epoch=187.8] | Loss=0.00002 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.790 | L2-Norm(final)=8.044 | 1699.7 samples/s | 26.6 steps/s
[Step=19750 Epoch=188.2] | Loss=0.00002 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.778 | L2-Norm(final)=8.045 | 5576.9 samples/s | 87.1 steps/s
[Step=19800 Epoch=188.7] | Loss=0.00002 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.766 | L2-Norm(final)=8.046 | 1724.3 samples/s | 26.9 steps/s
[Step=19850 Epoch=189.2] | Loss=0.00002 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.754 | L2-Norm(final)=8.048 | 5156.2 samples/s | 80.6 steps/s
[Step=19900 Epoch=189.7] | Loss=0.00002 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.741 | L2-Norm(final)=8.049 | 1676.2 samples/s | 26.2 steps/s
[Step=19950 Epoch=190.1] | Loss=0.00002 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.729 | L2-Norm(final)=8.050 | 5033.1 samples/s | 78.6 steps/s
[Step=20000 Epoch=190.6] | Loss=0.00002 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.716 | L2-Norm(final)=8.051 | 1749.0 samples/s | 27.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09453 | acc=0.9595 | tpr=0.9676 | fpr=0.0580 | 3916.7 samples/s | 15.3 steps/s
Avg test loss: 0.09893, Avg test acc: 0.95813, Avg tpr: 0.96654, Avg fpr: 0.06038, total FA: 471

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09404 | acc=0.9591 | tpr=0.9671 | fpr=0.0585 | 3940.0 samples/s | 15.4 steps/s
Avg test loss: 0.09888, Avg test acc: 0.95869, Avg tpr: 0.96771, Avg fpr: 0.06115, total FA: 477

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11099 | acc=0.9528 | tpr=0.9596 | fpr=0.0619 | 4146.5 samples/s | 16.2 steps/s
Avg test loss: 0.11841, Avg test acc: 0.95104, Avg tpr: 0.95693, Avg fpr: 0.06192, total FA: 483

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09255 | acc=0.9597 | tpr=0.9715 | fpr=0.0659 | 3991.1 samples/s | 15.6 steps/s
Avg test loss: 0.09644, Avg test acc: 0.95913, Avg tpr: 0.97185, Avg fpr: 0.06884, total FA: 537

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08924 | acc=0.9613 | tpr=0.9694 | fpr=0.0565 | 3967.7 samples/s | 15.5 steps/s
Avg test loss: 0.09564, Avg test acc: 0.96033, Avg tpr: 0.96870, Avg fpr: 0.05807, total FA: 453

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.87354 | acc=0.2713 | tpr=0.0045 | fpr=0.1492 | 4119.4 samples/s | 16.1 steps/s
Avg test loss: 4.89520, Avg test acc: 0.27009, Avg tpr: 0.00548, Avg fpr: 0.14793, total FA: 1154

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.71777 | acc=0.3050 | tpr=0.0038 | fpr=0.0409 | 4018.6 samples/s | 15.7 steps/s
Avg test loss: 4.72211, Avg test acc: 0.30395, Avg tpr: 0.00495, Avg fpr: 0.03846, total FA: 300

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.97957 | acc=0.2943 | tpr=0.0083 | fpr=0.0847 | 4224.8 samples/s | 16.5 steps/s
Avg test loss: 4.98805, Avg test acc: 0.29353, Avg tpr: 0.00991, Avg fpr: 0.08268, total FA: 645

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.01390 | acc=0.2974 | tpr=0.0071 | fpr=0.0721 | 3710.8 samples/s | 14.5 steps/s
Avg test loss: 5.02218, Avg test acc: 0.29598, Avg tpr: 0.00775, Avg fpr: 0.07012, total FA: 547

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.62683 | acc=0.3083 | tpr=0.0027 | fpr=0.0282 | 4141.1 samples/s | 16.2 steps/s
Avg test loss: 4.63380, Avg test acc: 0.30615, Avg tpr: 0.00431, Avg fpr: 0.03000, total FA: 234

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.20033 | acc=0.1381 | tpr=0.7699 | fpr=0.8732 | 3881.8 samples/s | 15.2 steps/s
[Step= 100] | Loss=5.14577 | acc=0.1401 | tpr=0.7463 | fpr=0.8712 | 6631.8 samples/s | 25.9 steps/s
[Step= 150] | Loss=5.14693 | acc=0.1385 | tpr=0.7550 | fpr=0.8729 | 7034.8 samples/s | 27.5 steps/s
[Step= 200] | Loss=5.14395 | acc=0.1381 | tpr=0.7486 | fpr=0.8730 | 7111.0 samples/s | 27.8 steps/s
[Step= 250] | Loss=5.14602 | acc=0.1389 | tpr=0.7555 | fpr=0.8724 | 7812.0 samples/s | 30.5 steps/s
[Step= 300] | Loss=5.14243 | acc=0.1390 | tpr=0.7578 | fpr=0.8723 | 8023.5 samples/s | 31.3 steps/s
[Step= 350] | Loss=5.13891 | acc=0.1386 | tpr=0.7570 | fpr=0.8726 | 7910.7 samples/s | 30.9 steps/s
[Step= 400] | Loss=5.14152 | acc=0.1388 | tpr=0.7511 | fpr=0.8724 | 7905.3 samples/s | 30.9 steps/s
[Step= 450] | Loss=5.14341 | acc=0.1385 | tpr=0.7468 | fpr=0.8725 | 7218.7 samples/s | 28.2 steps/s
[Step= 500] | Loss=5.14551 | acc=0.1382 | tpr=0.7449 | fpr=0.8728 | 7310.9 samples/s | 28.6 steps/s
[Step= 550] | Loss=5.14502 | acc=0.1378 | tpr=0.7481 | fpr=0.8733 | 14204.7 samples/s | 55.5 steps/s
Avg test loss: 5.14677, Avg test acc: 0.13778, Avg tpr: 0.74802, Avg fpr: 0.87331, total FA: 121258

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.53986 | acc=0.1509 | tpr=0.7345 | fpr=0.8596 | 3899.4 samples/s | 15.2 steps/s
[Step= 100] | Loss=4.48285 | acc=0.1523 | tpr=0.6652 | fpr=0.8573 | 7848.9 samples/s | 30.7 steps/s
[Step= 150] | Loss=4.49252 | acc=0.1509 | tpr=0.6657 | fpr=0.8586 | 8329.8 samples/s | 32.5 steps/s
[Step= 200] | Loss=4.49272 | acc=0.1507 | tpr=0.6568 | fpr=0.8585 | 8022.2 samples/s | 31.3 steps/s
[Step= 250] | Loss=4.49062 | acc=0.1514 | tpr=0.6603 | fpr=0.8579 | 7734.8 samples/s | 30.2 steps/s
[Step= 300] | Loss=4.48882 | acc=0.1517 | tpr=0.6705 | fpr=0.8578 | 7525.8 samples/s | 29.4 steps/s
[Step= 350] | Loss=4.48548 | acc=0.1515 | tpr=0.6606 | fpr=0.8578 | 8470.2 samples/s | 33.1 steps/s
[Step= 400] | Loss=4.48679 | acc=0.1518 | tpr=0.6554 | fpr=0.8574 | 6988.9 samples/s | 27.3 steps/s
[Step= 450] | Loss=4.49208 | acc=0.1519 | tpr=0.6490 | fpr=0.8571 | 7120.7 samples/s | 27.8 steps/s
[Step= 500] | Loss=4.49726 | acc=0.1516 | tpr=0.6454 | fpr=0.8574 | 6889.5 samples/s | 26.9 steps/s
[Step= 550] | Loss=4.49706 | acc=0.1514 | tpr=0.6462 | fpr=0.8576 | 13042.3 samples/s | 50.9 steps/s
Avg test loss: 4.49861, Avg test acc: 0.15137, Avg tpr: 0.64620, Avg fpr: 0.85762, total FA: 119079

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.14776 | acc=0.1248 | tpr=0.6460 | fpr=0.8846 | 4134.3 samples/s | 16.1 steps/s
[Step= 100] | Loss=6.10154 | acc=0.1262 | tpr=0.6034 | fpr=0.8827 | 7868.4 samples/s | 30.7 steps/s
[Step= 150] | Loss=6.11920 | acc=0.1242 | tpr=0.6153 | fpr=0.8848 | 8023.7 samples/s | 31.3 steps/s
[Step= 200] | Loss=6.11919 | acc=0.1237 | tpr=0.6208 | fpr=0.8854 | 7470.3 samples/s | 29.2 steps/s
[Step= 250] | Loss=6.12245 | acc=0.1233 | tpr=0.6157 | fpr=0.8856 | 6993.1 samples/s | 27.3 steps/s
[Step= 300] | Loss=6.12204 | acc=0.1234 | tpr=0.6145 | fpr=0.8856 | 8258.2 samples/s | 32.3 steps/s
[Step= 350] | Loss=6.11866 | acc=0.1231 | tpr=0.6099 | fpr=0.8858 | 7322.3 samples/s | 28.6 steps/s
[Step= 400] | Loss=6.12116 | acc=0.1233 | tpr=0.6018 | fpr=0.8854 | 6795.6 samples/s | 26.5 steps/s
[Step= 450] | Loss=6.12255 | acc=0.1229 | tpr=0.5974 | fpr=0.8857 | 7304.2 samples/s | 28.5 steps/s
[Step= 500] | Loss=6.12258 | acc=0.1229 | tpr=0.5916 | fpr=0.8856 | 8243.5 samples/s | 32.2 steps/s
[Step= 550] | Loss=6.12254 | acc=0.1227 | tpr=0.5965 | fpr=0.8859 | 14013.6 samples/s | 54.7 steps/s
Avg test loss: 6.12411, Avg test acc: 0.12263, Avg tpr: 0.59628, Avg fpr: 0.88598, total FA: 123017

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.02379 | acc=0.1384 | tpr=0.7389 | fpr=0.8724 | 4120.4 samples/s | 16.1 steps/s
[Step= 100] | Loss=4.97369 | acc=0.1406 | tpr=0.6951 | fpr=0.8697 | 7946.7 samples/s | 31.0 steps/s
[Step= 150] | Loss=4.97668 | acc=0.1377 | tpr=0.6974 | fpr=0.8726 | 7962.2 samples/s | 31.1 steps/s
[Step= 200] | Loss=4.97222 | acc=0.1369 | tpr=0.6940 | fpr=0.8733 | 7884.8 samples/s | 30.8 steps/s
[Step= 250] | Loss=4.97412 | acc=0.1375 | tpr=0.6969 | fpr=0.8727 | 7944.4 samples/s | 31.0 steps/s
[Step= 300] | Loss=4.97252 | acc=0.1370 | tpr=0.6960 | fpr=0.8732 | 8078.3 samples/s | 31.6 steps/s
[Step= 350] | Loss=4.96827 | acc=0.1370 | tpr=0.6900 | fpr=0.8730 | 7990.2 samples/s | 31.2 steps/s
[Step= 400] | Loss=4.97119 | acc=0.1369 | tpr=0.6865 | fpr=0.8731 | 7963.2 samples/s | 31.1 steps/s
[Step= 450] | Loss=4.97628 | acc=0.1364 | tpr=0.6806 | fpr=0.8735 | 7970.2 samples/s | 31.1 steps/s
[Step= 500] | Loss=4.98048 | acc=0.1362 | tpr=0.6793 | fpr=0.8736 | 7950.5 samples/s | 31.1 steps/s
[Step= 550] | Loss=4.97960 | acc=0.1359 | tpr=0.6785 | fpr=0.8739 | 14292.0 samples/s | 55.8 steps/s
Avg test loss: 4.98118, Avg test acc: 0.13584, Avg tpr: 0.67829, Avg fpr: 0.87402, total FA: 121356

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.91679 | acc=0.1457 | tpr=0.7080 | fpr=0.8644 | 4093.6 samples/s | 16.0 steps/s
[Step= 100] | Loss=4.87379 | acc=0.1482 | tpr=0.6738 | fpr=0.8616 | 8107.7 samples/s | 31.7 steps/s
[Step= 150] | Loss=4.88212 | acc=0.1462 | tpr=0.6671 | fpr=0.8634 | 8168.3 samples/s | 31.9 steps/s
[Step= 200] | Loss=4.88114 | acc=0.1460 | tpr=0.6568 | fpr=0.8633 | 7975.5 samples/s | 31.2 steps/s
[Step= 250] | Loss=4.88510 | acc=0.1462 | tpr=0.6524 | fpr=0.8630 | 8137.2 samples/s | 31.8 steps/s
[Step= 300] | Loss=4.88092 | acc=0.1461 | tpr=0.6545 | fpr=0.8632 | 8265.9 samples/s | 32.3 steps/s
[Step= 350] | Loss=4.87564 | acc=0.1453 | tpr=0.6506 | fpr=0.8638 | 8403.1 samples/s | 32.8 steps/s
[Step= 400] | Loss=4.87925 | acc=0.1455 | tpr=0.6493 | fpr=0.8637 | 7044.8 samples/s | 27.5 steps/s
[Step= 450] | Loss=4.88054 | acc=0.1451 | tpr=0.6461 | fpr=0.8640 | 8344.3 samples/s | 32.6 steps/s
[Step= 500] | Loss=4.88283 | acc=0.1447 | tpr=0.6410 | fpr=0.8643 | 7611.7 samples/s | 29.7 steps/s
[Step= 550] | Loss=4.88388 | acc=0.1446 | tpr=0.6427 | fpr=0.8645 | 13992.6 samples/s | 54.7 steps/s
Avg test loss: 4.88600, Avg test acc: 0.14450, Avg tpr: 0.64263, Avg fpr: 0.86456, total FA: 120042

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10777 | acc=0.9796 | tpr=0.9336 | fpr=0.0196 | 4042.8 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.11143 | acc=0.9791 | tpr=0.9488 | fpr=0.0203 | 8119.0 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.11563 | acc=0.9782 | tpr=0.9467 | fpr=0.0212 | 8158.8 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.11745 | acc=0.9784 | tpr=0.9486 | fpr=0.0211 | 8272.8 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.11685 | acc=0.9784 | tpr=0.9441 | fpr=0.0210 | 8332.6 samples/s | 32.5 steps/s
[Step= 300] | Loss=0.11880 | acc=0.9780 | tpr=0.9433 | fpr=0.0214 | 7772.8 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.11865 | acc=0.9779 | tpr=0.9430 | fpr=0.0215 | 8344.1 samples/s | 32.6 steps/s
[Step= 400] | Loss=0.12024 | acc=0.9777 | tpr=0.9387 | fpr=0.0216 | 7635.1 samples/s | 29.8 steps/s
[Step= 450] | Loss=0.12310 | acc=0.9774 | tpr=0.9382 | fpr=0.0219 | 6897.6 samples/s | 26.9 steps/s
[Step= 500] | Loss=0.12268 | acc=0.9774 | tpr=0.9392 | fpr=0.0219 | 7674.9 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.12158 | acc=0.9776 | tpr=0.9395 | fpr=0.0217 | 14071.6 samples/s | 55.0 steps/s
Avg test loss: 0.12142, Avg test acc: 0.97761, Avg tpr: 0.93978, Avg fpr: 0.02170, total FA: 3013

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10274 | acc=0.9827 | tpr=0.8805 | fpr=0.0154 | 4155.3 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.10500 | acc=0.9825 | tpr=0.8998 | fpr=0.0159 | 8233.7 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.10623 | acc=0.9820 | tpr=0.9035 | fpr=0.0165 | 8060.0 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.10853 | acc=0.9816 | tpr=0.9093 | fpr=0.0171 | 7891.1 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.10819 | acc=0.9816 | tpr=0.9057 | fpr=0.0170 | 8301.9 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.10989 | acc=0.9812 | tpr=0.9040 | fpr=0.0174 | 7861.9 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.11000 | acc=0.9810 | tpr=0.9036 | fpr=0.0176 | 8278.4 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.11122 | acc=0.9808 | tpr=0.9004 | fpr=0.0177 | 7872.2 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.11410 | acc=0.9805 | tpr=0.9002 | fpr=0.0181 | 8141.7 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.11375 | acc=0.9804 | tpr=0.9022 | fpr=0.0182 | 7977.3 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.11300 | acc=0.9805 | tpr=0.9021 | fpr=0.0180 | 14672.9 samples/s | 57.3 steps/s
Avg test loss: 0.11282, Avg test acc: 0.98051, Avg tpr: 0.90095, Avg fpr: 0.01804, total FA: 2505

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11032 | acc=0.9796 | tpr=0.9292 | fpr=0.0195 | 4224.8 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.11420 | acc=0.9793 | tpr=0.9510 | fpr=0.0202 | 7881.9 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.11886 | acc=0.9783 | tpr=0.9539 | fpr=0.0212 | 8317.3 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.12145 | acc=0.9782 | tpr=0.9563 | fpr=0.0214 | 8066.8 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.12052 | acc=0.9782 | tpr=0.9537 | fpr=0.0214 | 7656.9 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.12255 | acc=0.9777 | tpr=0.9549 | fpr=0.0219 | 8271.0 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.12241 | acc=0.9776 | tpr=0.9555 | fpr=0.0220 | 8455.0 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.12377 | acc=0.9775 | tpr=0.9519 | fpr=0.0220 | 7506.3 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.12661 | acc=0.9772 | tpr=0.9508 | fpr=0.0223 | 8083.3 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.12616 | acc=0.9772 | tpr=0.9511 | fpr=0.0224 | 7802.9 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.12482 | acc=0.9774 | tpr=0.9515 | fpr=0.0221 | 14562.1 samples/s | 56.9 steps/s
Avg test loss: 0.12464, Avg test acc: 0.97741, Avg tpr: 0.95087, Avg fpr: 0.02210, total FA: 3069

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11895 | acc=0.9814 | tpr=0.9159 | fpr=0.0174 | 4098.6 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.12446 | acc=0.9808 | tpr=0.9403 | fpr=0.0185 | 8169.5 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.12987 | acc=0.9798 | tpr=0.9366 | fpr=0.0194 | 8375.3 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.13213 | acc=0.9796 | tpr=0.9399 | fpr=0.0197 | 8135.0 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.13068 | acc=0.9795 | tpr=0.9397 | fpr=0.0197 | 8285.0 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.13284 | acc=0.9791 | tpr=0.9375 | fpr=0.0201 | 8004.9 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.13266 | acc=0.9790 | tpr=0.9405 | fpr=0.0203 | 8147.2 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.13408 | acc=0.9788 | tpr=0.9354 | fpr=0.0204 | 7917.9 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.13708 | acc=0.9785 | tpr=0.9314 | fpr=0.0207 | 7964.4 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.13664 | acc=0.9785 | tpr=0.9322 | fpr=0.0207 | 8673.9 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.13562 | acc=0.9787 | tpr=0.9327 | fpr=0.0205 | 13600.0 samples/s | 53.1 steps/s
Avg test loss: 0.13543, Avg test acc: 0.97864, Avg tpr: 0.93225, Avg fpr: 0.02052, total FA: 2849

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.11815 | acc=0.9797 | tpr=0.9248 | fpr=0.0193 | 4070.6 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.12330 | acc=0.9791 | tpr=0.9467 | fpr=0.0203 | 7738.5 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.12812 | acc=0.9781 | tpr=0.9481 | fpr=0.0213 | 8259.2 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.13064 | acc=0.9778 | tpr=0.9508 | fpr=0.0217 | 8383.1 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.12955 | acc=0.9779 | tpr=0.9476 | fpr=0.0216 | 8107.4 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.13193 | acc=0.9775 | tpr=0.9462 | fpr=0.0220 | 7992.3 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.13185 | acc=0.9773 | tpr=0.9449 | fpr=0.0221 | 8444.9 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.13355 | acc=0.9772 | tpr=0.9382 | fpr=0.0221 | 7875.1 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.13643 | acc=0.9768 | tpr=0.9387 | fpr=0.0225 | 8036.6 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.13583 | acc=0.9768 | tpr=0.9392 | fpr=0.0225 | 7927.0 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.13485 | acc=0.9770 | tpr=0.9383 | fpr=0.0223 | 14837.0 samples/s | 58.0 steps/s
Avg test loss: 0.13461, Avg test acc: 0.97703, Avg tpr: 0.93859, Avg fpr: 0.02228, total FA: 3093

server round 22/50

clients selected: [1 3 4 7 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=30001 Epoch=146.4] | Loss=0.01279 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.768 | L2-Norm(final)=10.693 | 3954.3 samples/s | 61.8 steps/s
[Step=30050 Epoch=146.6] | Loss=0.02408 | Reg=0.00139 | acc=0.9688 | L2-Norm=11.790 | L2-Norm(final)=10.679 | 4659.7 samples/s | 72.8 steps/s
[Step=30100 Epoch=146.9] | Loss=0.02288 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.813 | L2-Norm(final)=10.676 | 5144.3 samples/s | 80.4 steps/s
[Step=30150 Epoch=147.1] | Loss=0.02267 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.834 | L2-Norm(final)=10.677 | 5132.2 samples/s | 80.2 steps/s
[Step=30200 Epoch=147.4] | Loss=0.02216 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.855 | L2-Norm(final)=10.679 | 7297.2 samples/s | 114.0 steps/s
[Step=30250 Epoch=147.6] | Loss=0.02096 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.877 | L2-Norm(final)=10.685 | 1808.3 samples/s | 28.3 steps/s
[Step=30300 Epoch=147.8] | Loss=0.01964 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.899 | L2-Norm(final)=10.693 | 5200.4 samples/s | 81.3 steps/s
[Step=30350 Epoch=148.1] | Loss=0.01876 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.918 | L2-Norm(final)=10.703 | 5244.0 samples/s | 81.9 steps/s
[Step=30400 Epoch=148.3] | Loss=0.01794 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.937 | L2-Norm(final)=10.715 | 6673.4 samples/s | 104.3 steps/s
[Step=30450 Epoch=148.6] | Loss=0.01720 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.954 | L2-Norm(final)=10.726 | 1827.6 samples/s | 28.6 steps/s
[Step=30500 Epoch=148.8] | Loss=0.01661 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.972 | L2-Norm(final)=10.739 | 5153.7 samples/s | 80.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=30501 Epoch=148.8] | Loss=0.00738 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.149 | L2-Norm(final)=10.871 | 3656.6 samples/s | 57.1 steps/s
[Step=30550 Epoch=149.1] | Loss=0.01856 | Reg=0.00148 | acc=0.9531 | L2-Norm=12.172 | L2-Norm(final)=10.882 | 4425.3 samples/s | 69.1 steps/s
[Step=30600 Epoch=149.3] | Loss=0.02074 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.196 | L2-Norm(final)=10.884 | 4683.7 samples/s | 73.2 steps/s
[Step=30650 Epoch=149.6] | Loss=0.02097 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.218 | L2-Norm(final)=10.885 | 4515.1 samples/s | 70.5 steps/s
[Step=30700 Epoch=149.8] | Loss=0.02040 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.236 | L2-Norm(final)=10.887 | 6153.0 samples/s | 96.1 steps/s
[Step=30750 Epoch=150.0] | Loss=0.01821 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.252 | L2-Norm(final)=10.891 | 1747.6 samples/s | 27.3 steps/s
[Step=30800 Epoch=150.3] | Loss=0.01639 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.265 | L2-Norm(final)=10.895 | 4609.2 samples/s | 72.0 steps/s
[Step=30850 Epoch=150.5] | Loss=0.01595 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.276 | L2-Norm(final)=10.899 | 4599.8 samples/s | 71.9 steps/s
[Step=30900 Epoch=150.8] | Loss=0.01478 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.286 | L2-Norm(final)=10.903 | 5793.5 samples/s | 90.5 steps/s
[Step=30950 Epoch=151.0] | Loss=0.01392 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.295 | L2-Norm(final)=10.907 | 1772.4 samples/s | 27.7 steps/s
[Step=31000 Epoch=151.3] | Loss=0.01312 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.303 | L2-Norm(final)=10.910 | 4631.8 samples/s | 72.4 steps/s
[Step=31050 Epoch=151.5] | Loss=0.01255 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.310 | L2-Norm(final)=10.914 | 4546.2 samples/s | 71.0 steps/s
[Step=31100 Epoch=151.8] | Loss=0.01212 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.316 | L2-Norm(final)=10.917 | 5463.5 samples/s | 85.4 steps/s
[Step=31150 Epoch=152.0] | Loss=0.01150 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.322 | L2-Norm(final)=10.920 | 1754.2 samples/s | 27.4 steps/s
[Step=31200 Epoch=152.2] | Loss=0.01100 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.327 | L2-Norm(final)=10.924 | 4609.9 samples/s | 72.0 steps/s
[Step=31250 Epoch=152.5] | Loss=0.01064 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.332 | L2-Norm(final)=10.927 | 4616.2 samples/s | 72.1 steps/s
[Step=31300 Epoch=152.7] | Loss=0.01031 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.336 | L2-Norm(final)=10.929 | 5156.7 samples/s | 80.6 steps/s
[Step=31350 Epoch=153.0] | Loss=0.00990 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.341 | L2-Norm(final)=10.932 | 1821.2 samples/s | 28.5 steps/s
[Step=31400 Epoch=153.2] | Loss=0.00961 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.345 | L2-Norm(final)=10.935 | 4609.5 samples/s | 72.0 steps/s
[Step=31450 Epoch=153.5] | Loss=0.00931 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.348 | L2-Norm(final)=10.938 | 4595.0 samples/s | 71.8 steps/s
[Step=31500 Epoch=153.7] | Loss=0.00901 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.352 | L2-Norm(final)=10.941 | 4870.5 samples/s | 76.1 steps/s
[Step=31550 Epoch=153.9] | Loss=0.00877 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.355 | L2-Norm(final)=10.943 | 1862.0 samples/s | 29.1 steps/s
[Step=31600 Epoch=154.2] | Loss=0.00851 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.359 | L2-Norm(final)=10.946 | 4600.8 samples/s | 71.9 steps/s
[Step=31650 Epoch=154.4] | Loss=0.00837 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.362 | L2-Norm(final)=10.949 | 4560.1 samples/s | 71.3 steps/s
[Step=31700 Epoch=154.7] | Loss=0.00816 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.365 | L2-Norm(final)=10.952 | 4706.5 samples/s | 73.5 steps/s
[Step=31750 Epoch=154.9] | Loss=0.00798 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.368 | L2-Norm(final)=10.954 | 1906.4 samples/s | 29.8 steps/s
[Step=31800 Epoch=155.2] | Loss=0.00779 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=10.957 | 4826.5 samples/s | 75.4 steps/s
[Step=31850 Epoch=155.4] | Loss=0.00760 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.373 | L2-Norm(final)=10.959 | 4663.8 samples/s | 72.9 steps/s
[Step=31900 Epoch=155.7] | Loss=0.00747 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.376 | L2-Norm(final)=10.961 | 4735.8 samples/s | 74.0 steps/s
[Step=31950 Epoch=155.9] | Loss=0.00731 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.378 | L2-Norm(final)=10.964 | 1896.4 samples/s | 29.6 steps/s
[Step=32000 Epoch=156.1] | Loss=0.00713 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.380 | L2-Norm(final)=10.966 | 4782.7 samples/s | 74.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step32000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=14001 Epoch=68.3] | Loss=0.01573 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.768 | L2-Norm(final)=8.262 | 3936.4 samples/s | 61.5 steps/s
[Step=14050 Epoch=68.5] | Loss=0.02980 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.792 | L2-Norm(final)=8.254 | 4613.8 samples/s | 72.1 steps/s
[Step=14100 Epoch=68.8] | Loss=0.02767 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.819 | L2-Norm(final)=8.254 | 5169.4 samples/s | 80.8 steps/s
[Step=14150 Epoch=69.0] | Loss=0.02676 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.845 | L2-Norm(final)=8.261 | 5281.0 samples/s | 82.5 steps/s
[Step=14200 Epoch=69.2] | Loss=0.02566 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.870 | L2-Norm(final)=8.267 | 7130.2 samples/s | 111.4 steps/s
[Step=14250 Epoch=69.5] | Loss=0.02364 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.893 | L2-Norm(final)=8.277 | 1797.6 samples/s | 28.1 steps/s
[Step=14300 Epoch=69.7] | Loss=0.02275 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.916 | L2-Norm(final)=8.288 | 5181.0 samples/s | 81.0 steps/s
[Step=14350 Epoch=70.0] | Loss=0.02204 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.938 | L2-Norm(final)=8.302 | 5192.4 samples/s | 81.1 steps/s
[Step=14400 Epoch=70.2] | Loss=0.02146 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.959 | L2-Norm(final)=8.316 | 6619.5 samples/s | 103.4 steps/s
[Step=14450 Epoch=70.5] | Loss=0.02091 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.980 | L2-Norm(final)=8.330 | 1843.4 samples/s | 28.8 steps/s
[Step=14500 Epoch=70.7] | Loss=0.02015 | Reg=0.00144 | acc=0.9844 | L2-Norm=12.000 | L2-Norm(final)=8.344 | 5160.9 samples/s | 80.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=14501 Epoch=70.7] | Loss=0.00829 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.201 | L2-Norm(final)=8.493 | 3864.4 samples/s | 60.4 steps/s
[Step=14550 Epoch=71.0] | Loss=0.01768 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.234 | L2-Norm(final)=8.505 | 4200.5 samples/s | 65.6 steps/s
[Step=14600 Epoch=71.2] | Loss=0.02088 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.264 | L2-Norm(final)=8.513 | 4615.8 samples/s | 72.1 steps/s
[Step=14650 Epoch=71.4] | Loss=0.02109 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.288 | L2-Norm(final)=8.518 | 4583.9 samples/s | 71.6 steps/s
[Step=14700 Epoch=71.7] | Loss=0.02109 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.309 | L2-Norm(final)=8.524 | 6228.6 samples/s | 97.3 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01871 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.328 | L2-Norm(final)=8.531 | 1760.6 samples/s | 27.5 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01722 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.345 | L2-Norm(final)=8.537 | 4695.1 samples/s | 73.4 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01569 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.361 | L2-Norm(final)=8.545 | 4578.7 samples/s | 71.5 steps/s
[Step=14900 Epoch=72.7] | Loss=0.01479 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.374 | L2-Norm(final)=8.552 | 6042.2 samples/s | 94.4 steps/s
[Step=14950 Epoch=72.9] | Loss=0.01427 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.385 | L2-Norm(final)=8.558 | 1807.6 samples/s | 28.2 steps/s
[Step=15000 Epoch=73.1] | Loss=0.01345 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.395 | L2-Norm(final)=8.563 | 4572.6 samples/s | 71.4 steps/s
[Step=15050 Epoch=73.4] | Loss=0.01280 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.404 | L2-Norm(final)=8.568 | 4515.9 samples/s | 70.6 steps/s
[Step=15100 Epoch=73.6] | Loss=0.01207 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.412 | L2-Norm(final)=8.574 | 5401.5 samples/s | 84.4 steps/s
[Step=15150 Epoch=73.9] | Loss=0.01149 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.420 | L2-Norm(final)=8.579 | 1825.0 samples/s | 28.5 steps/s
[Step=15200 Epoch=74.1] | Loss=0.01103 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.427 | L2-Norm(final)=8.584 | 4731.6 samples/s | 73.9 steps/s
[Step=15250 Epoch=74.4] | Loss=0.01061 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.434 | L2-Norm(final)=8.589 | 4709.5 samples/s | 73.6 steps/s
[Step=15300 Epoch=74.6] | Loss=0.01022 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.440 | L2-Norm(final)=8.594 | 4671.3 samples/s | 73.0 steps/s
[Step=15350 Epoch=74.9] | Loss=0.01006 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.446 | L2-Norm(final)=8.598 | 1847.4 samples/s | 28.9 steps/s
[Step=15400 Epoch=75.1] | Loss=0.00974 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.451 | L2-Norm(final)=8.602 | 4462.1 samples/s | 69.7 steps/s
[Step=15450 Epoch=75.3] | Loss=0.00942 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.456 | L2-Norm(final)=8.605 | 4413.0 samples/s | 69.0 steps/s
[Step=15500 Epoch=75.6] | Loss=0.00919 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.461 | L2-Norm(final)=8.609 | 4683.1 samples/s | 73.2 steps/s
[Step=15550 Epoch=75.8] | Loss=0.00884 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.466 | L2-Norm(final)=8.613 | 1923.3 samples/s | 30.1 steps/s
[Step=15600 Epoch=76.1] | Loss=0.00855 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.470 | L2-Norm(final)=8.617 | 4787.8 samples/s | 74.8 steps/s
[Step=15650 Epoch=76.3] | Loss=0.00836 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.474 | L2-Norm(final)=8.620 | 4577.6 samples/s | 71.5 steps/s
[Step=15700 Epoch=76.6] | Loss=0.00818 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=8.624 | 4670.8 samples/s | 73.0 steps/s
[Step=15750 Epoch=76.8] | Loss=0.00805 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=8.627 | 1949.2 samples/s | 30.5 steps/s
[Step=15800 Epoch=77.0] | Loss=0.00788 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.485 | L2-Norm(final)=8.630 | 4755.8 samples/s | 74.3 steps/s
[Step=15850 Epoch=77.3] | Loss=0.00772 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.488 | L2-Norm(final)=8.634 | 4565.0 samples/s | 71.3 steps/s
[Step=15900 Epoch=77.5] | Loss=0.00755 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.492 | L2-Norm(final)=8.637 | 4546.6 samples/s | 71.0 steps/s
[Step=15950 Epoch=77.8] | Loss=0.00740 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=8.640 | 1922.5 samples/s | 30.0 steps/s
[Step=16000 Epoch=78.0] | Loss=0.00724 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.497 | L2-Norm(final)=8.643 | 4618.5 samples/s | 72.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step16000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=28001 Epoch=137.3] | Loss=0.00813 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.768 | L2-Norm(final)=10.810 | 3881.6 samples/s | 60.7 steps/s
[Step=28050 Epoch=137.6] | Loss=0.02735 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.792 | L2-Norm(final)=10.788 | 4919.2 samples/s | 76.9 steps/s
[Step=28100 Epoch=137.8] | Loss=0.02515 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.818 | L2-Norm(final)=10.779 | 5149.7 samples/s | 80.5 steps/s
[Step=28150 Epoch=138.0] | Loss=0.02290 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.840 | L2-Norm(final)=10.777 | 5161.8 samples/s | 80.7 steps/s
[Step=28200 Epoch=138.3] | Loss=0.02142 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.861 | L2-Norm(final)=10.782 | 7301.2 samples/s | 114.1 steps/s
[Step=28250 Epoch=138.5] | Loss=0.01971 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.880 | L2-Norm(final)=10.788 | 1806.3 samples/s | 28.2 steps/s
[Step=28300 Epoch=138.8] | Loss=0.01820 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=10.798 | 5150.0 samples/s | 80.5 steps/s
[Step=28350 Epoch=139.0] | Loss=0.01759 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.916 | L2-Norm(final)=10.809 | 5235.9 samples/s | 81.8 steps/s
[Step=28400 Epoch=139.3] | Loss=0.01709 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.933 | L2-Norm(final)=10.820 | 6952.6 samples/s | 108.6 steps/s
[Step=28450 Epoch=139.5] | Loss=0.01650 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.950 | L2-Norm(final)=10.831 | 1790.4 samples/s | 28.0 steps/s
[Step=28500 Epoch=139.8] | Loss=0.01592 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.966 | L2-Norm(final)=10.843 | 5134.3 samples/s | 80.2 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=139.8] | Loss=0.00825 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.129 | L2-Norm(final)=10.967 | 3561.1 samples/s | 55.6 steps/s
[Step=28550 Epoch=140.0] | Loss=0.01048 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.144 | L2-Norm(final)=10.980 | 4610.0 samples/s | 72.0 steps/s
[Step=28600 Epoch=140.2] | Loss=0.01623 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.163 | L2-Norm(final)=10.987 | 4666.0 samples/s | 72.9 steps/s
[Step=28650 Epoch=140.5] | Loss=0.01676 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.184 | L2-Norm(final)=10.990 | 4630.6 samples/s | 72.4 steps/s
[Step=28700 Epoch=140.7] | Loss=0.01691 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.203 | L2-Norm(final)=10.995 | 6098.2 samples/s | 95.3 steps/s
[Step=28750 Epoch=141.0] | Loss=0.01566 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.219 | L2-Norm(final)=10.999 | 1747.7 samples/s | 27.3 steps/s
[Step=28800 Epoch=141.2] | Loss=0.01475 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.232 | L2-Norm(final)=11.003 | 4564.5 samples/s | 71.3 steps/s
[Step=28850 Epoch=141.5] | Loss=0.01354 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.244 | L2-Norm(final)=11.007 | 4721.6 samples/s | 73.8 steps/s
[Step=28900 Epoch=141.7] | Loss=0.01286 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.254 | L2-Norm(final)=11.012 | 6082.6 samples/s | 95.0 steps/s
[Step=28950 Epoch=142.0] | Loss=0.01227 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.263 | L2-Norm(final)=11.016 | 1771.0 samples/s | 27.7 steps/s
[Step=29000 Epoch=142.2] | Loss=0.01171 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.271 | L2-Norm(final)=11.020 | 4529.9 samples/s | 70.8 steps/s
[Step=29050 Epoch=142.5] | Loss=0.01129 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.279 | L2-Norm(final)=11.024 | 4589.9 samples/s | 71.7 steps/s
[Step=29100 Epoch=142.7] | Loss=0.01065 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.286 | L2-Norm(final)=11.028 | 5624.5 samples/s | 87.9 steps/s
[Step=29150 Epoch=142.9] | Loss=0.01009 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.292 | L2-Norm(final)=11.032 | 1805.4 samples/s | 28.2 steps/s
[Step=29200 Epoch=143.2] | Loss=0.00970 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=11.036 | 4553.0 samples/s | 71.1 steps/s
[Step=29250 Epoch=143.4] | Loss=0.00929 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.302 | L2-Norm(final)=11.040 | 4693.7 samples/s | 73.3 steps/s
[Step=29300 Epoch=143.7] | Loss=0.00906 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.307 | L2-Norm(final)=11.043 | 5609.7 samples/s | 87.7 steps/s
[Step=29350 Epoch=143.9] | Loss=0.00880 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.311 | L2-Norm(final)=11.046 | 1823.8 samples/s | 28.5 steps/s
[Step=29400 Epoch=144.2] | Loss=0.00862 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.315 | L2-Norm(final)=11.049 | 4620.2 samples/s | 72.2 steps/s
[Step=29450 Epoch=144.4] | Loss=0.00838 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.318 | L2-Norm(final)=11.052 | 4551.1 samples/s | 71.1 steps/s
[Step=29500 Epoch=144.7] | Loss=0.00816 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.322 | L2-Norm(final)=11.055 | 5136.6 samples/s | 80.3 steps/s
[Step=29550 Epoch=144.9] | Loss=0.00794 | Reg=0.00152 | acc=0.9844 | L2-Norm=12.325 | L2-Norm(final)=11.058 | 1811.1 samples/s | 28.3 steps/s
[Step=29600 Epoch=145.2] | Loss=0.00773 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.328 | L2-Norm(final)=11.060 | 4607.9 samples/s | 72.0 steps/s
[Step=29650 Epoch=145.4] | Loss=0.00753 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.331 | L2-Norm(final)=11.063 | 4612.8 samples/s | 72.1 steps/s
[Step=29700 Epoch=145.6] | Loss=0.00742 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.333 | L2-Norm(final)=11.066 | 4960.8 samples/s | 77.5 steps/s
[Step=29750 Epoch=145.9] | Loss=0.00726 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.336 | L2-Norm(final)=11.068 | 1860.6 samples/s | 29.1 steps/s
[Step=29800 Epoch=146.1] | Loss=0.00709 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.339 | L2-Norm(final)=11.071 | 4694.7 samples/s | 73.4 steps/s
[Step=29850 Epoch=146.4] | Loss=0.00699 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.341 | L2-Norm(final)=11.073 | 4586.5 samples/s | 71.7 steps/s
[Step=29900 Epoch=146.6] | Loss=0.00689 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.344 | L2-Norm(final)=11.075 | 4696.7 samples/s | 73.4 steps/s
[Step=29950 Epoch=146.9] | Loss=0.00670 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.346 | L2-Norm(final)=11.077 | 1846.2 samples/s | 28.8 steps/s
[Step=30000 Epoch=147.1] | Loss=0.00653 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.348 | L2-Norm(final)=11.080 | 4393.7 samples/s | 68.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step30000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=24001 Epoch=229.2] | Loss=0.01526 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.768 | L2-Norm(final)=7.689 | 3541.3 samples/s | 55.3 steps/s
[Step=24050 Epoch=229.7] | Loss=0.00242 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.833 | L2-Norm(final)=7.697 | 4341.9 samples/s | 67.8 steps/s
[Step=24100 Epoch=230.1] | Loss=0.00232 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.884 | L2-Norm(final)=7.714 | 7021.9 samples/s | 109.7 steps/s
[Step=24150 Epoch=230.6] | Loss=0.00163 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.911 | L2-Norm(final)=7.726 | 1736.5 samples/s | 27.1 steps/s
[Step=24200 Epoch=231.1] | Loss=0.00125 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.924 | L2-Norm(final)=7.736 | 6761.3 samples/s | 105.6 steps/s
[Step=24250 Epoch=231.6] | Loss=0.00102 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.928 | L2-Norm(final)=7.743 | 1804.2 samples/s | 28.2 steps/s
[Step=24300 Epoch=232.1] | Loss=0.00086 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.929 | L2-Norm(final)=7.750 | 6075.1 samples/s | 94.9 steps/s
[Step=24350 Epoch=232.5] | Loss=0.00075 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.927 | L2-Norm(final)=7.756 | 1789.3 samples/s | 28.0 steps/s
[Step=24400 Epoch=233.0] | Loss=0.00066 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.924 | L2-Norm(final)=7.761 | 5332.0 samples/s | 83.3 steps/s
[Step=24450 Epoch=233.5] | Loss=0.00060 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.921 | L2-Norm(final)=7.766 | 1857.8 samples/s | 29.0 steps/s
[Step=24500 Epoch=234.0] | Loss=0.00054 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.916 | L2-Norm(final)=7.771 | 5057.4 samples/s | 79.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=234.0] | Loss=0.00007 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.871 | L2-Norm(final)=7.819 | 3726.1 samples/s | 58.2 steps/s
[Step=24550 Epoch=234.4] | Loss=0.00007 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.855 | L2-Norm(final)=7.822 | 4396.8 samples/s | 68.7 steps/s
[Step=24600 Epoch=234.9] | Loss=0.00491 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.863 | L2-Norm(final)=7.820 | 5774.6 samples/s | 90.2 steps/s
[Step=24650 Epoch=235.4] | Loss=0.00355 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.899 | L2-Norm(final)=7.805 | 1684.7 samples/s | 26.3 steps/s
[Step=24700 Epoch=235.9] | Loss=0.00274 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.917 | L2-Norm(final)=7.798 | 5776.1 samples/s | 90.3 steps/s
[Step=24750 Epoch=236.3] | Loss=0.00220 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.926 | L2-Norm(final)=7.795 | 1742.8 samples/s | 27.2 steps/s
[Step=24800 Epoch=236.8] | Loss=0.00183 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.930 | L2-Norm(final)=7.793 | 5219.5 samples/s | 81.6 steps/s
[Step=24850 Epoch=237.3] | Loss=0.00157 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.930 | L2-Norm(final)=7.792 | 1769.7 samples/s | 27.7 steps/s
[Step=24900 Epoch=237.8] | Loss=0.00138 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.929 | L2-Norm(final)=7.792 | 4863.5 samples/s | 76.0 steps/s
[Step=24950 Epoch=238.3] | Loss=0.00123 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.927 | L2-Norm(final)=7.791 | 1774.0 samples/s | 27.7 steps/s
[Step=25000 Epoch=238.7] | Loss=0.00111 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.923 | L2-Norm(final)=7.791 | 4851.1 samples/s | 75.8 steps/s
[Step=25050 Epoch=239.2] | Loss=0.00101 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.919 | L2-Norm(final)=7.791 | 1832.9 samples/s | 28.6 steps/s
[Step=25100 Epoch=239.7] | Loss=0.00092 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.914 | L2-Norm(final)=7.791 | 4538.1 samples/s | 70.9 steps/s
[Step=25150 Epoch=240.2] | Loss=0.00085 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.909 | L2-Norm(final)=7.791 | 1803.4 samples/s | 28.2 steps/s
[Step=25200 Epoch=240.6] | Loss=0.00079 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.904 | L2-Norm(final)=7.791 | 4227.8 samples/s | 66.1 steps/s
[Step=25250 Epoch=241.1] | Loss=0.00074 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.898 | L2-Norm(final)=7.791 | 1805.8 samples/s | 28.2 steps/s
[Step=25300 Epoch=241.6] | Loss=0.00069 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.892 | L2-Norm(final)=7.791 | 4111.4 samples/s | 64.2 steps/s
[Step=25350 Epoch=242.1] | Loss=0.00065 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.886 | L2-Norm(final)=7.791 | 1858.1 samples/s | 29.0 steps/s
[Step=25400 Epoch=242.6] | Loss=0.00062 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.880 | L2-Norm(final)=7.792 | 4397.7 samples/s | 68.7 steps/s
[Step=25450 Epoch=243.0] | Loss=0.00058 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.873 | L2-Norm(final)=7.792 | 1881.5 samples/s | 29.4 steps/s
[Step=25500 Epoch=243.5] | Loss=0.00056 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.867 | L2-Norm(final)=7.792 | 4370.3 samples/s | 68.3 steps/s
[Step=25550 Epoch=244.0] | Loss=0.00053 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.860 | L2-Norm(final)=7.792 | 6515.4 samples/s | 101.8 steps/s
[Step=25600 Epoch=244.5] | Loss=0.00051 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.853 | L2-Norm(final)=7.792 | 1637.0 samples/s | 25.6 steps/s
[Step=25650 Epoch=244.9] | Loss=0.00048 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.846 | L2-Norm(final)=7.793 | 6026.4 samples/s | 94.2 steps/s
[Step=25700 Epoch=245.4] | Loss=0.00046 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.839 | L2-Norm(final)=7.793 | 1690.1 samples/s | 26.4 steps/s
[Step=25750 Epoch=245.9] | Loss=0.00045 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.832 | L2-Norm(final)=7.793 | 5568.5 samples/s | 87.0 steps/s
[Step=25800 Epoch=246.4] | Loss=0.00043 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.825 | L2-Norm(final)=7.794 | 1736.0 samples/s | 27.1 steps/s
[Step=25850 Epoch=246.9] | Loss=0.00041 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.817 | L2-Norm(final)=7.794 | 5379.4 samples/s | 84.1 steps/s
[Step=25900 Epoch=247.3] | Loss=0.00040 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.810 | L2-Norm(final)=7.794 | 1745.2 samples/s | 27.3 steps/s
[Step=25950 Epoch=247.8] | Loss=0.00038 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.802 | L2-Norm(final)=7.795 | 4948.9 samples/s | 77.3 steps/s
[Step=26000 Epoch=248.3] | Loss=0.00037 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.794 | L2-Norm(final)=7.795 | 1778.2 samples/s | 27.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step26000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=20001 Epoch=190.6] | Loss=0.00234 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.768 | L2-Norm(final)=8.086 | 3705.0 samples/s | 57.9 steps/s
[Step=20050 Epoch=191.1] | Loss=0.00336 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.825 | L2-Norm(final)=8.093 | 4575.5 samples/s | 71.5 steps/s
[Step=20100 Epoch=191.6] | Loss=0.00237 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.883 | L2-Norm(final)=8.111 | 7201.6 samples/s | 112.5 steps/s
[Step=20150 Epoch=192.0] | Loss=0.00165 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.909 | L2-Norm(final)=8.126 | 1745.9 samples/s | 27.3 steps/s
[Step=20200 Epoch=192.5] | Loss=0.00129 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.920 | L2-Norm(final)=8.138 | 6486.8 samples/s | 101.4 steps/s
[Step=20250 Epoch=193.0] | Loss=0.00106 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.925 | L2-Norm(final)=8.148 | 1786.1 samples/s | 27.9 steps/s
[Step=20300 Epoch=193.5] | Loss=0.00090 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.927 | L2-Norm(final)=8.157 | 5884.3 samples/s | 91.9 steps/s
[Step=20350 Epoch=194.0] | Loss=0.00078 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.926 | L2-Norm(final)=8.165 | 1804.1 samples/s | 28.2 steps/s
[Step=20400 Epoch=194.4] | Loss=0.00070 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.924 | L2-Norm(final)=8.172 | 5468.1 samples/s | 85.4 steps/s
[Step=20450 Epoch=194.9] | Loss=0.00063 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.921 | L2-Norm(final)=8.178 | 1824.8 samples/s | 28.5 steps/s
[Step=20500 Epoch=195.4] | Loss=0.00057 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.918 | L2-Norm(final)=8.185 | 4999.7 samples/s | 78.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=195.4] | Loss=0.00004 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.879 | L2-Norm(final)=8.248 | 3551.7 samples/s | 55.5 steps/s
[Step=20550 Epoch=195.9] | Loss=0.00005 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.868 | L2-Norm(final)=8.251 | 4032.8 samples/s | 63.0 steps/s
[Step=20600 Epoch=196.3] | Loss=0.00004 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.856 | L2-Norm(final)=8.255 | 5967.3 samples/s | 93.2 steps/s
[Step=20650 Epoch=196.8] | Loss=0.00003 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.842 | L2-Norm(final)=8.258 | 1734.9 samples/s | 27.1 steps/s
[Step=20700 Epoch=197.3] | Loss=0.00003 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.828 | L2-Norm(final)=8.260 | 5603.9 samples/s | 87.6 steps/s
[Step=20750 Epoch=197.8] | Loss=0.00002 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.814 | L2-Norm(final)=8.261 | 1722.0 samples/s | 26.9 steps/s
[Step=20800 Epoch=198.2] | Loss=0.00002 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.799 | L2-Norm(final)=8.263 | 5178.5 samples/s | 80.9 steps/s
[Step=20850 Epoch=198.7] | Loss=0.00002 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.784 | L2-Norm(final)=8.264 | 1776.4 samples/s | 27.8 steps/s
[Step=20900 Epoch=199.2] | Loss=0.00002 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.769 | L2-Norm(final)=8.265 | 4980.9 samples/s | 77.8 steps/s
[Step=20950 Epoch=199.7] | Loss=0.00002 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.753 | L2-Norm(final)=8.266 | 1792.8 samples/s | 28.0 steps/s
[Step=21000 Epoch=200.1] | Loss=0.00002 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.738 | L2-Norm(final)=8.267 | 4743.0 samples/s | 74.1 steps/s
[Step=21050 Epoch=200.6] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.722 | L2-Norm(final)=8.268 | 1818.9 samples/s | 28.4 steps/s
[Step=21100 Epoch=201.1] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.706 | L2-Norm(final)=8.269 | 4430.9 samples/s | 69.2 steps/s
[Step=21150 Epoch=201.6] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.690 | L2-Norm(final)=8.270 | 1880.0 samples/s | 29.4 steps/s
[Step=21200 Epoch=202.1] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.674 | L2-Norm(final)=8.271 | 4517.3 samples/s | 70.6 steps/s
[Step=21250 Epoch=202.5] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.658 | L2-Norm(final)=8.272 | 1872.7 samples/s | 29.3 steps/s
[Step=21300 Epoch=203.0] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.642 | L2-Norm(final)=8.272 | 4461.6 samples/s | 69.7 steps/s
[Step=21350 Epoch=203.5] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.625 | L2-Norm(final)=8.273 | 1887.5 samples/s | 29.5 steps/s
[Step=21400 Epoch=204.0] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.609 | L2-Norm(final)=8.274 | 4350.2 samples/s | 68.0 steps/s
[Step=21450 Epoch=204.4] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.592 | L2-Norm(final)=8.275 | 1921.7 samples/s | 30.0 steps/s
[Step=21500 Epoch=204.9] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.576 | L2-Norm(final)=8.275 | 4346.4 samples/s | 67.9 steps/s
[Step=21550 Epoch=205.4] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.559 | L2-Norm(final)=8.276 | 6458.2 samples/s | 100.9 steps/s
[Step=21600 Epoch=205.9] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.542 | L2-Norm(final)=8.277 | 1627.8 samples/s | 25.4 steps/s
[Step=21650 Epoch=206.3] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.525 | L2-Norm(final)=8.278 | 6063.8 samples/s | 94.7 steps/s
[Step=21700 Epoch=206.8] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.508 | L2-Norm(final)=8.278 | 1691.7 samples/s | 26.4 steps/s
[Step=21750 Epoch=207.3] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=8.279 | 5671.3 samples/s | 88.6 steps/s
[Step=21800 Epoch=207.8] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.474 | L2-Norm(final)=8.280 | 1714.5 samples/s | 26.8 steps/s
[Step=21850 Epoch=208.3] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.456 | L2-Norm(final)=8.280 | 5352.7 samples/s | 83.6 steps/s
[Step=21900 Epoch=208.7] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.439 | L2-Norm(final)=8.281 | 1756.3 samples/s | 27.4 steps/s
[Step=21950 Epoch=209.2] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.421 | L2-Norm(final)=8.282 | 4979.2 samples/s | 77.8 steps/s
[Step=22000 Epoch=209.7] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.403 | L2-Norm(final)=8.283 | 1794.8 samples/s | 28.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step22000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09453 | acc=0.9595 | tpr=0.9676 | fpr=0.0580 | 4156.1 samples/s | 16.2 steps/s
Avg test loss: 0.09893, Avg test acc: 0.95813, Avg tpr: 0.96654, Avg fpr: 0.06038, total FA: 471

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09803 | acc=0.9599 | tpr=0.9771 | fpr=0.0773 | 4099.8 samples/s | 16.0 steps/s
Avg test loss: 0.10409, Avg test acc: 0.95869, Avg tpr: 0.97587, Avg fpr: 0.07909, total FA: 617

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11099 | acc=0.9528 | tpr=0.9596 | fpr=0.0619 | 4081.3 samples/s | 15.9 steps/s
Avg test loss: 0.11841, Avg test acc: 0.95104, Avg tpr: 0.95693, Avg fpr: 0.06192, total FA: 483

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09496 | acc=0.9600 | tpr=0.9757 | fpr=0.0741 | 4161.0 samples/s | 16.3 steps/s
Avg test loss: 0.09900, Avg test acc: 0.95929, Avg tpr: 0.97587, Avg fpr: 0.07717, total FA: 602

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10177 | acc=0.9606 | tpr=0.9742 | fpr=0.0689 | 4260.1 samples/s | 16.6 steps/s
Avg test loss: 0.10719, Avg test acc: 0.95905, Avg tpr: 0.97266, Avg fpr: 0.07089, total FA: 553

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.87354 | acc=0.2713 | tpr=0.0045 | fpr=0.1492 | 4110.6 samples/s | 16.1 steps/s
Avg test loss: 4.89520, Avg test acc: 0.27009, Avg tpr: 0.00548, Avg fpr: 0.14793, total FA: 1154

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.71777 | acc=0.3050 | tpr=0.0038 | fpr=0.0409 | 4093.6 samples/s | 16.0 steps/s
Avg test loss: 4.72211, Avg test acc: 0.30395, Avg tpr: 0.00495, Avg fpr: 0.03846, total FA: 300

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.92081 | acc=0.2895 | tpr=0.0092 | fpr=0.1018 | 4100.2 samples/s | 16.0 steps/s
Avg test loss: 4.92894, Avg test acc: 0.28937, Avg tpr: 0.01061, Avg fpr: 0.09755, total FA: 761

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.01390 | acc=0.2974 | tpr=0.0071 | fpr=0.0721 | 4116.8 samples/s | 16.1 steps/s
Avg test loss: 5.02218, Avg test acc: 0.29598, Avg tpr: 0.00775, Avg fpr: 0.07012, total FA: 547

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.05640 | acc=0.3092 | tpr=0.0021 | fpr=0.0238 | 4063.0 samples/s | 15.9 steps/s
Avg test loss: 5.06338, Avg test acc: 0.30656, Avg tpr: 0.00280, Avg fpr: 0.02538, total FA: 198

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.20033 | acc=0.1381 | tpr=0.7699 | fpr=0.8732 | 4036.9 samples/s | 15.8 steps/s
[Step= 100] | Loss=5.14577 | acc=0.1401 | tpr=0.7463 | fpr=0.8712 | 7938.7 samples/s | 31.0 steps/s
[Step= 150] | Loss=5.14693 | acc=0.1385 | tpr=0.7550 | fpr=0.8729 | 8342.1 samples/s | 32.6 steps/s
[Step= 200] | Loss=5.14395 | acc=0.1381 | tpr=0.7486 | fpr=0.8730 | 7784.2 samples/s | 30.4 steps/s
[Step= 250] | Loss=5.14602 | acc=0.1389 | tpr=0.7555 | fpr=0.8724 | 7885.3 samples/s | 30.8 steps/s
[Step= 300] | Loss=5.14243 | acc=0.1390 | tpr=0.7578 | fpr=0.8723 | 7818.7 samples/s | 30.5 steps/s
[Step= 350] | Loss=5.13891 | acc=0.1386 | tpr=0.7570 | fpr=0.8726 | 8054.3 samples/s | 31.5 steps/s
[Step= 400] | Loss=5.14152 | acc=0.1388 | tpr=0.7511 | fpr=0.8724 | 8342.6 samples/s | 32.6 steps/s
[Step= 450] | Loss=5.14341 | acc=0.1385 | tpr=0.7468 | fpr=0.8725 | 7899.9 samples/s | 30.9 steps/s
[Step= 500] | Loss=5.14551 | acc=0.1382 | tpr=0.7449 | fpr=0.8728 | 7898.2 samples/s | 30.9 steps/s
[Step= 550] | Loss=5.14502 | acc=0.1378 | tpr=0.7481 | fpr=0.8733 | 14188.6 samples/s | 55.4 steps/s
Avg test loss: 5.14677, Avg test acc: 0.13778, Avg tpr: 0.74802, Avg fpr: 0.87331, total FA: 121258

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.18943 | acc=0.1221 | tpr=0.8274 | fpr=0.8906 | 4189.9 samples/s | 16.4 steps/s
[Step= 100] | Loss=5.12968 | acc=0.1229 | tpr=0.7953 | fpr=0.8897 | 7819.9 samples/s | 30.5 steps/s
[Step= 150] | Loss=5.13950 | acc=0.1207 | tpr=0.7968 | fpr=0.8918 | 8121.0 samples/s | 31.7 steps/s
[Step= 200] | Loss=5.13922 | acc=0.1202 | tpr=0.7858 | fpr=0.8919 | 8086.6 samples/s | 31.6 steps/s
[Step= 250] | Loss=5.13831 | acc=0.1209 | tpr=0.7878 | fpr=0.8913 | 8095.5 samples/s | 31.6 steps/s
[Step= 300] | Loss=5.13784 | acc=0.1205 | tpr=0.7927 | fpr=0.8918 | 7903.8 samples/s | 30.9 steps/s
[Step= 350] | Loss=5.13119 | acc=0.1202 | tpr=0.7840 | fpr=0.8919 | 8144.0 samples/s | 31.8 steps/s
[Step= 400] | Loss=5.13002 | acc=0.1204 | tpr=0.7795 | fpr=0.8916 | 8142.1 samples/s | 31.8 steps/s
[Step= 450] | Loss=5.13625 | acc=0.1204 | tpr=0.7765 | fpr=0.8915 | 7988.7 samples/s | 31.2 steps/s
[Step= 500] | Loss=5.14156 | acc=0.1199 | tpr=0.7744 | fpr=0.8919 | 8206.6 samples/s | 32.1 steps/s
[Step= 550] | Loss=5.14106 | acc=0.1202 | tpr=0.7760 | fpr=0.8918 | 15171.8 samples/s | 59.3 steps/s
Avg test loss: 5.14254, Avg test acc: 0.12009, Avg tpr: 0.77575, Avg fpr: 0.89183, total FA: 123829

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.14776 | acc=0.1248 | tpr=0.6460 | fpr=0.8846 | 4046.2 samples/s | 15.8 steps/s
[Step= 100] | Loss=6.10154 | acc=0.1262 | tpr=0.6034 | fpr=0.8827 | 8166.1 samples/s | 31.9 steps/s
[Step= 150] | Loss=6.11920 | acc=0.1242 | tpr=0.6153 | fpr=0.8848 | 7760.6 samples/s | 30.3 steps/s
[Step= 200] | Loss=6.11919 | acc=0.1237 | tpr=0.6208 | fpr=0.8854 | 8067.4 samples/s | 31.5 steps/s
[Step= 250] | Loss=6.12245 | acc=0.1233 | tpr=0.6157 | fpr=0.8856 | 8089.5 samples/s | 31.6 steps/s
[Step= 300] | Loss=6.12204 | acc=0.1234 | tpr=0.6145 | fpr=0.8856 | 8384.9 samples/s | 32.8 steps/s
[Step= 350] | Loss=6.11866 | acc=0.1231 | tpr=0.6099 | fpr=0.8858 | 7654.3 samples/s | 29.9 steps/s
[Step= 400] | Loss=6.12116 | acc=0.1233 | tpr=0.6018 | fpr=0.8854 | 7986.8 samples/s | 31.2 steps/s
[Step= 450] | Loss=6.12255 | acc=0.1229 | tpr=0.5974 | fpr=0.8857 | 8179.7 samples/s | 32.0 steps/s
[Step= 500] | Loss=6.12258 | acc=0.1229 | tpr=0.5916 | fpr=0.8856 | 7905.9 samples/s | 30.9 steps/s
[Step= 550] | Loss=6.12254 | acc=0.1227 | tpr=0.5965 | fpr=0.8859 | 14391.4 samples/s | 56.2 steps/s
Avg test loss: 6.12411, Avg test acc: 0.12263, Avg tpr: 0.59628, Avg fpr: 0.88598, total FA: 123017

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.07918 | acc=0.1260 | tpr=0.7345 | fpr=0.8849 | 4115.7 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.03279 | acc=0.1273 | tpr=0.6994 | fpr=0.8834 | 8155.9 samples/s | 31.9 steps/s
[Step= 150] | Loss=5.03913 | acc=0.1248 | tpr=0.7075 | fpr=0.8860 | 8176.4 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.03081 | acc=0.1242 | tpr=0.7016 | fpr=0.8863 | 8155.5 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.03289 | acc=0.1244 | tpr=0.7048 | fpr=0.8862 | 8246.5 samples/s | 32.2 steps/s
[Step= 300] | Loss=5.03128 | acc=0.1243 | tpr=0.7062 | fpr=0.8863 | 8154.1 samples/s | 31.9 steps/s
[Step= 350] | Loss=5.02782 | acc=0.1240 | tpr=0.7038 | fpr=0.8865 | 8001.7 samples/s | 31.3 steps/s
[Step= 400] | Loss=5.03191 | acc=0.1242 | tpr=0.7035 | fpr=0.8863 | 7863.5 samples/s | 30.7 steps/s
[Step= 450] | Loss=5.03409 | acc=0.1240 | tpr=0.6996 | fpr=0.8864 | 8210.4 samples/s | 32.1 steps/s
[Step= 500] | Loss=5.03786 | acc=0.1239 | tpr=0.6991 | fpr=0.8865 | 8198.0 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.03727 | acc=0.1235 | tpr=0.6972 | fpr=0.8870 | 13633.2 samples/s | 53.3 steps/s
Avg test loss: 5.03866, Avg test acc: 0.12338, Avg tpr: 0.69691, Avg fpr: 0.88704, total FA: 123164

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.68582 | acc=0.1280 | tpr=0.7655 | fpr=0.8835 | 4092.7 samples/s | 16.0 steps/s
[Step= 100] | Loss=5.63505 | acc=0.1285 | tpr=0.7335 | fpr=0.8828 | 7615.9 samples/s | 29.7 steps/s
[Step= 150] | Loss=5.64204 | acc=0.1258 | tpr=0.7349 | fpr=0.8854 | 7783.0 samples/s | 30.4 steps/s
[Step= 200] | Loss=5.64104 | acc=0.1252 | tpr=0.7301 | fpr=0.8859 | 7857.5 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.64290 | acc=0.1256 | tpr=0.7319 | fpr=0.8855 | 7987.4 samples/s | 31.2 steps/s
[Step= 300] | Loss=5.63784 | acc=0.1253 | tpr=0.7338 | fpr=0.8858 | 7739.8 samples/s | 30.2 steps/s
[Step= 350] | Loss=5.63532 | acc=0.1248 | tpr=0.7364 | fpr=0.8863 | 7297.5 samples/s | 28.5 steps/s
[Step= 400] | Loss=5.63682 | acc=0.1249 | tpr=0.7325 | fpr=0.8862 | 8011.3 samples/s | 31.3 steps/s
[Step= 450] | Loss=5.63905 | acc=0.1245 | tpr=0.7288 | fpr=0.8864 | 8211.4 samples/s | 32.1 steps/s
[Step= 500] | Loss=5.64042 | acc=0.1243 | tpr=0.7264 | fpr=0.8866 | 7890.4 samples/s | 30.8 steps/s
[Step= 550] | Loss=5.64138 | acc=0.1240 | tpr=0.7270 | fpr=0.8869 | 13830.9 samples/s | 54.0 steps/s
Avg test loss: 5.64332, Avg test acc: 0.12399, Avg tpr: 0.72662, Avg fpr: 0.88696, total FA: 123153

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10777 | acc=0.9796 | tpr=0.9336 | fpr=0.0196 | 4085.1 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.11143 | acc=0.9791 | tpr=0.9488 | fpr=0.0203 | 7931.3 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.11563 | acc=0.9782 | tpr=0.9467 | fpr=0.0212 | 8076.9 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.11745 | acc=0.9784 | tpr=0.9486 | fpr=0.0211 | 7864.7 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.11685 | acc=0.9784 | tpr=0.9441 | fpr=0.0210 | 7993.1 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.11880 | acc=0.9780 | tpr=0.9433 | fpr=0.0214 | 7968.1 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.11865 | acc=0.9779 | tpr=0.9430 | fpr=0.0215 | 8412.0 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.12024 | acc=0.9777 | tpr=0.9387 | fpr=0.0216 | 8340.8 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.12310 | acc=0.9774 | tpr=0.9382 | fpr=0.0219 | 7688.1 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.12268 | acc=0.9774 | tpr=0.9392 | fpr=0.0219 | 8205.1 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.12158 | acc=0.9776 | tpr=0.9395 | fpr=0.0217 | 14256.7 samples/s | 55.7 steps/s
Avg test loss: 0.12142, Avg test acc: 0.97761, Avg tpr: 0.93978, Avg fpr: 0.02170, total FA: 3013

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10274 | acc=0.9827 | tpr=0.8805 | fpr=0.0154 | 4130.3 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.10500 | acc=0.9825 | tpr=0.8998 | fpr=0.0159 | 7966.1 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.10623 | acc=0.9820 | tpr=0.9035 | fpr=0.0165 | 8138.5 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.10853 | acc=0.9816 | tpr=0.9093 | fpr=0.0171 | 7515.9 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.10819 | acc=0.9816 | tpr=0.9057 | fpr=0.0170 | 8197.3 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.10989 | acc=0.9812 | tpr=0.9040 | fpr=0.0174 | 8195.9 samples/s | 32.0 steps/s
[Step= 350] | Loss=0.11000 | acc=0.9810 | tpr=0.9036 | fpr=0.0176 | 8139.5 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.11122 | acc=0.9808 | tpr=0.9004 | fpr=0.0177 | 7998.6 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.11410 | acc=0.9805 | tpr=0.9002 | fpr=0.0181 | 8177.4 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.11375 | acc=0.9804 | tpr=0.9022 | fpr=0.0182 | 7374.5 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.11300 | acc=0.9805 | tpr=0.9021 | fpr=0.0180 | 14881.5 samples/s | 58.1 steps/s
Avg test loss: 0.11282, Avg test acc: 0.98051, Avg tpr: 0.90095, Avg fpr: 0.01804, total FA: 2505

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.12018 | acc=0.9790 | tpr=0.9159 | fpr=0.0199 | 4117.6 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.12347 | acc=0.9787 | tpr=0.9339 | fpr=0.0205 | 7901.2 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.12701 | acc=0.9778 | tpr=0.9323 | fpr=0.0214 | 8085.7 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.12945 | acc=0.9777 | tpr=0.9333 | fpr=0.0215 | 7805.4 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.12908 | acc=0.9776 | tpr=0.9354 | fpr=0.0216 | 7747.9 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.13176 | acc=0.9773 | tpr=0.9360 | fpr=0.0219 | 7889.6 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.13234 | acc=0.9771 | tpr=0.9355 | fpr=0.0221 | 8069.8 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.13417 | acc=0.9768 | tpr=0.9316 | fpr=0.0223 | 8134.0 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.13713 | acc=0.9766 | tpr=0.9328 | fpr=0.0226 | 8237.0 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.13636 | acc=0.9767 | tpr=0.9352 | fpr=0.0226 | 7697.9 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.13501 | acc=0.9768 | tpr=0.9347 | fpr=0.0224 | 14099.6 samples/s | 55.1 steps/s
Avg test loss: 0.13485, Avg test acc: 0.97683, Avg tpr: 0.93423, Avg fpr: 0.02240, total FA: 3110

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11895 | acc=0.9814 | tpr=0.9159 | fpr=0.0174 | 4146.2 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.12446 | acc=0.9808 | tpr=0.9403 | fpr=0.0185 | 8319.3 samples/s | 32.5 steps/s
[Step= 150] | Loss=0.12987 | acc=0.9798 | tpr=0.9366 | fpr=0.0194 | 7948.1 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.13213 | acc=0.9796 | tpr=0.9399 | fpr=0.0197 | 8247.1 samples/s | 32.2 steps/s
[Step= 250] | Loss=0.13068 | acc=0.9795 | tpr=0.9397 | fpr=0.0197 | 7881.0 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.13284 | acc=0.9791 | tpr=0.9375 | fpr=0.0201 | 8104.9 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.13266 | acc=0.9790 | tpr=0.9405 | fpr=0.0203 | 7973.9 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.13408 | acc=0.9788 | tpr=0.9354 | fpr=0.0204 | 8073.3 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.13708 | acc=0.9785 | tpr=0.9314 | fpr=0.0207 | 7862.2 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.13664 | acc=0.9785 | tpr=0.9322 | fpr=0.0207 | 8185.6 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.13562 | acc=0.9787 | tpr=0.9327 | fpr=0.0205 | 15155.6 samples/s | 59.2 steps/s
Avg test loss: 0.13543, Avg test acc: 0.97864, Avg tpr: 0.93225, Avg fpr: 0.02052, total FA: 2849

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12803 | acc=0.9798 | tpr=0.9204 | fpr=0.0191 | 4139.8 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.13347 | acc=0.9792 | tpr=0.9424 | fpr=0.0201 | 8172.5 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.13841 | acc=0.9783 | tpr=0.9438 | fpr=0.0211 | 7848.7 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.14125 | acc=0.9781 | tpr=0.9464 | fpr=0.0213 | 7981.0 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.13995 | acc=0.9781 | tpr=0.9424 | fpr=0.0212 | 8218.5 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.14272 | acc=0.9776 | tpr=0.9425 | fpr=0.0218 | 7560.8 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.14287 | acc=0.9775 | tpr=0.9424 | fpr=0.0219 | 8163.9 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.14470 | acc=0.9773 | tpr=0.9354 | fpr=0.0220 | 8236.6 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.14783 | acc=0.9769 | tpr=0.9357 | fpr=0.0224 | 8163.5 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.14725 | acc=0.9769 | tpr=0.9366 | fpr=0.0223 | 7969.2 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.14630 | acc=0.9771 | tpr=0.9351 | fpr=0.0222 | 14712.5 samples/s | 57.5 steps/s
Avg test loss: 0.14605, Avg test acc: 0.97707, Avg tpr: 0.93542, Avg fpr: 0.02218, total FA: 3079

server round 23/50

clients selected: [1 3 5 7 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=32001 Epoch=156.2] | Loss=0.03757 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.691 | L2-Norm(final)=11.040 | 3735.0 samples/s | 58.4 steps/s
[Step=32050 Epoch=156.4] | Loss=0.02249 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.709 | L2-Norm(final)=11.033 | 4595.4 samples/s | 71.8 steps/s
[Step=32100 Epoch=156.6] | Loss=0.02003 | Reg=0.00138 | acc=0.9688 | L2-Norm=11.733 | L2-Norm(final)=11.032 | 4864.6 samples/s | 76.0 steps/s
[Step=32150 Epoch=156.9] | Loss=0.02047 | Reg=0.00138 | acc=0.9688 | L2-Norm=11.754 | L2-Norm(final)=11.034 | 5066.7 samples/s | 79.2 steps/s
[Step=32200 Epoch=157.1] | Loss=0.02091 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.776 | L2-Norm(final)=11.038 | 7241.0 samples/s | 113.1 steps/s
[Step=32250 Epoch=157.4] | Loss=0.01968 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.797 | L2-Norm(final)=11.044 | 1804.1 samples/s | 28.2 steps/s
[Step=32300 Epoch=157.6] | Loss=0.01826 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.817 | L2-Norm(final)=11.053 | 5209.9 samples/s | 81.4 steps/s
[Step=32350 Epoch=157.9] | Loss=0.01753 | Reg=0.00140 | acc=0.9688 | L2-Norm=11.836 | L2-Norm(final)=11.064 | 5339.2 samples/s | 83.4 steps/s
[Step=32400 Epoch=158.1] | Loss=0.01719 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.854 | L2-Norm(final)=11.075 | 6708.3 samples/s | 104.8 steps/s
[Step=32450 Epoch=158.3] | Loss=0.01655 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.872 | L2-Norm(final)=11.087 | 1795.8 samples/s | 28.1 steps/s
[Step=32500 Epoch=158.6] | Loss=0.01602 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.890 | L2-Norm(final)=11.100 | 5220.3 samples/s | 81.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=32501 Epoch=158.6] | Loss=0.00272 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.069 | L2-Norm(final)=11.231 | 3721.6 samples/s | 58.2 steps/s
[Step=32550 Epoch=158.8] | Loss=0.01584 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.092 | L2-Norm(final)=11.248 | 4374.8 samples/s | 68.4 steps/s
[Step=32600 Epoch=159.1] | Loss=0.01832 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.117 | L2-Norm(final)=11.252 | 4511.3 samples/s | 70.5 steps/s
[Step=32650 Epoch=159.3] | Loss=0.02034 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.140 | L2-Norm(final)=11.254 | 4627.0 samples/s | 72.3 steps/s
[Step=32700 Epoch=159.6] | Loss=0.01963 | Reg=0.00148 | acc=0.9688 | L2-Norm=12.160 | L2-Norm(final)=11.256 | 6291.8 samples/s | 98.3 steps/s
[Step=32750 Epoch=159.8] | Loss=0.01812 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=11.261 | 1749.8 samples/s | 27.3 steps/s
[Step=32800 Epoch=160.0] | Loss=0.01649 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.192 | L2-Norm(final)=11.264 | 4630.0 samples/s | 72.3 steps/s
[Step=32850 Epoch=160.3] | Loss=0.01542 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.204 | L2-Norm(final)=11.269 | 4575.0 samples/s | 71.5 steps/s
[Step=32900 Epoch=160.5] | Loss=0.01468 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.214 | L2-Norm(final)=11.272 | 5966.8 samples/s | 93.2 steps/s
[Step=32950 Epoch=160.8] | Loss=0.01378 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.223 | L2-Norm(final)=11.276 | 1785.0 samples/s | 27.9 steps/s
[Step=33000 Epoch=161.0] | Loss=0.01299 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.231 | L2-Norm(final)=11.280 | 4540.3 samples/s | 70.9 steps/s
[Step=33050 Epoch=161.3] | Loss=0.01214 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.238 | L2-Norm(final)=11.284 | 4620.5 samples/s | 72.2 steps/s
[Step=33100 Epoch=161.5] | Loss=0.01183 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.244 | L2-Norm(final)=11.287 | 5627.2 samples/s | 87.9 steps/s
[Step=33150 Epoch=161.8] | Loss=0.01120 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.249 | L2-Norm(final)=11.290 | 1860.4 samples/s | 29.1 steps/s
[Step=33200 Epoch=162.0] | Loss=0.01074 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.254 | L2-Norm(final)=11.293 | 4609.3 samples/s | 72.0 steps/s
[Step=33250 Epoch=162.2] | Loss=0.01026 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.259 | L2-Norm(final)=11.296 | 4617.6 samples/s | 72.2 steps/s
[Step=33300 Epoch=162.5] | Loss=0.01002 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.264 | L2-Norm(final)=11.298 | 5129.3 samples/s | 80.1 steps/s
[Step=33350 Epoch=162.7] | Loss=0.00967 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.268 | L2-Norm(final)=11.301 | 1860.3 samples/s | 29.1 steps/s
[Step=33400 Epoch=163.0] | Loss=0.00928 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.272 | L2-Norm(final)=11.304 | 4546.2 samples/s | 71.0 steps/s
[Step=33450 Epoch=163.2] | Loss=0.00899 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.276 | L2-Norm(final)=11.306 | 4691.2 samples/s | 73.3 steps/s
[Step=33500 Epoch=163.5] | Loss=0.00884 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.279 | L2-Norm(final)=11.309 | 4922.3 samples/s | 76.9 steps/s
[Step=33550 Epoch=163.7] | Loss=0.00859 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.282 | L2-Norm(final)=11.311 | 1917.7 samples/s | 30.0 steps/s
[Step=33600 Epoch=164.0] | Loss=0.00837 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.286 | L2-Norm(final)=11.313 | 4604.6 samples/s | 71.9 steps/s
[Step=33650 Epoch=164.2] | Loss=0.00814 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.289 | L2-Norm(final)=11.316 | 4610.4 samples/s | 72.0 steps/s
[Step=33700 Epoch=164.4] | Loss=0.00798 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.291 | L2-Norm(final)=11.318 | 4416.4 samples/s | 69.0 steps/s
[Step=33750 Epoch=164.7] | Loss=0.00779 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.294 | L2-Norm(final)=11.321 | 1932.9 samples/s | 30.2 steps/s
[Step=33800 Epoch=164.9] | Loss=0.00773 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.297 | L2-Norm(final)=11.323 | 4680.6 samples/s | 73.1 steps/s
[Step=33850 Epoch=165.2] | Loss=0.00750 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.299 | L2-Norm(final)=11.325 | 4520.0 samples/s | 70.6 steps/s
[Step=33900 Epoch=165.4] | Loss=0.00740 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.301 | L2-Norm(final)=11.327 | 4662.7 samples/s | 72.9 steps/s
[Step=33950 Epoch=165.7] | Loss=0.00724 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.304 | L2-Norm(final)=11.329 | 1898.6 samples/s | 29.7 steps/s
[Step=34000 Epoch=165.9] | Loss=0.00713 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.306 | L2-Norm(final)=11.331 | 4805.4 samples/s | 75.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step34000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=16001 Epoch=78.0] | Loss=0.01379 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.691 | L2-Norm(final)=8.736 | 3808.6 samples/s | 59.5 steps/s
[Step=16050 Epoch=78.3] | Loss=0.02618 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.708 | L2-Norm(final)=8.727 | 4689.2 samples/s | 73.3 steps/s
[Step=16100 Epoch=78.5] | Loss=0.02722 | Reg=0.00138 | acc=0.9688 | L2-Norm=11.737 | L2-Norm(final)=8.729 | 5131.5 samples/s | 80.2 steps/s
[Step=16150 Epoch=78.8] | Loss=0.02599 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.763 | L2-Norm(final)=8.732 | 5158.6 samples/s | 80.6 steps/s
[Step=16200 Epoch=79.0] | Loss=0.02451 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.788 | L2-Norm(final)=8.741 | 7298.8 samples/s | 114.0 steps/s
[Step=16250 Epoch=79.2] | Loss=0.02355 | Reg=0.00140 | acc=0.9375 | L2-Norm=11.812 | L2-Norm(final)=8.753 | 1776.1 samples/s | 27.8 steps/s
[Step=16300 Epoch=79.5] | Loss=0.02279 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.835 | L2-Norm(final)=8.766 | 4853.9 samples/s | 75.8 steps/s
[Step=16350 Epoch=79.7] | Loss=0.02183 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.857 | L2-Norm(final)=8.780 | 5096.0 samples/s | 79.6 steps/s
[Step=16400 Epoch=80.0] | Loss=0.02122 | Reg=0.00141 | acc=0.9688 | L2-Norm=11.880 | L2-Norm(final)=8.796 | 6698.3 samples/s | 104.7 steps/s
[Step=16450 Epoch=80.2] | Loss=0.02052 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.901 | L2-Norm(final)=8.811 | 1847.1 samples/s | 28.9 steps/s
[Step=16500 Epoch=80.5] | Loss=0.01992 | Reg=0.00142 | acc=0.9688 | L2-Norm=11.921 | L2-Norm(final)=8.826 | 5235.0 samples/s | 81.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=16501 Epoch=80.5] | Loss=0.00720 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.126 | L2-Norm(final)=8.980 | 3640.5 samples/s | 56.9 steps/s
[Step=16550 Epoch=80.7] | Loss=0.01866 | Reg=0.00148 | acc=0.9375 | L2-Norm=12.149 | L2-Norm(final)=8.996 | 4500.4 samples/s | 70.3 steps/s
[Step=16600 Epoch=81.0] | Loss=0.01919 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=9.004 | 4579.2 samples/s | 71.6 steps/s
[Step=16650 Epoch=81.2] | Loss=0.01892 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.204 | L2-Norm(final)=9.012 | 4625.7 samples/s | 72.3 steps/s
[Step=16700 Epoch=81.4] | Loss=0.01909 | Reg=0.00149 | acc=0.9688 | L2-Norm=12.225 | L2-Norm(final)=9.020 | 6240.4 samples/s | 97.5 steps/s
[Step=16750 Epoch=81.7] | Loss=0.01676 | Reg=0.00150 | acc=1.0000 | L2-Norm=12.245 | L2-Norm(final)=9.027 | 1757.5 samples/s | 27.5 steps/s
[Step=16800 Epoch=81.9] | Loss=0.01599 | Reg=0.00150 | acc=0.9844 | L2-Norm=12.261 | L2-Norm(final)=9.034 | 4577.6 samples/s | 71.5 steps/s
[Step=16850 Epoch=82.2] | Loss=0.01522 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.275 | L2-Norm(final)=9.039 | 4708.1 samples/s | 73.6 steps/s
[Step=16900 Epoch=82.4] | Loss=0.01413 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.287 | L2-Norm(final)=9.045 | 5853.2 samples/s | 91.5 steps/s
[Step=16950 Epoch=82.7] | Loss=0.01313 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.298 | L2-Norm(final)=9.051 | 1792.5 samples/s | 28.0 steps/s
[Step=17000 Epoch=82.9] | Loss=0.01241 | Reg=0.00151 | acc=1.0000 | L2-Norm=12.307 | L2-Norm(final)=9.057 | 4619.9 samples/s | 72.2 steps/s
[Step=17050 Epoch=83.1] | Loss=0.01192 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.316 | L2-Norm(final)=9.062 | 4665.0 samples/s | 72.9 steps/s
[Step=17100 Epoch=83.4] | Loss=0.01131 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.324 | L2-Norm(final)=9.068 | 5368.1 samples/s | 83.9 steps/s
[Step=17150 Epoch=83.6] | Loss=0.01066 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.331 | L2-Norm(final)=9.073 | 1848.8 samples/s | 28.9 steps/s
[Step=17200 Epoch=83.9] | Loss=0.01040 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.338 | L2-Norm(final)=9.078 | 4644.2 samples/s | 72.6 steps/s
[Step=17250 Epoch=84.1] | Loss=0.01008 | Reg=0.00152 | acc=1.0000 | L2-Norm=12.344 | L2-Norm(final)=9.082 | 4258.9 samples/s | 66.5 steps/s
[Step=17300 Epoch=84.4] | Loss=0.00971 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.350 | L2-Norm(final)=9.086 | 4757.7 samples/s | 74.3 steps/s
[Step=17350 Epoch=84.6] | Loss=0.00931 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.356 | L2-Norm(final)=9.090 | 1876.0 samples/s | 29.3 steps/s
[Step=17400 Epoch=84.9] | Loss=0.00913 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.361 | L2-Norm(final)=9.094 | 4571.5 samples/s | 71.4 steps/s
[Step=17450 Epoch=85.1] | Loss=0.00899 | Reg=0.00153 | acc=0.9844 | L2-Norm=12.366 | L2-Norm(final)=9.097 | 4585.5 samples/s | 71.6 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00870 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.371 | L2-Norm(final)=9.100 | 4674.5 samples/s | 73.0 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00845 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.375 | L2-Norm(final)=9.104 | 1888.6 samples/s | 29.5 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00822 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.380 | L2-Norm(final)=9.107 | 4658.0 samples/s | 72.8 steps/s
[Step=17650 Epoch=86.1] | Loss=0.00797 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.384 | L2-Norm(final)=9.111 | 4534.1 samples/s | 70.8 steps/s
[Step=17700 Epoch=86.3] | Loss=0.00783 | Reg=0.00153 | acc=1.0000 | L2-Norm=12.388 | L2-Norm(final)=9.114 | 4831.5 samples/s | 75.5 steps/s
[Step=17750 Epoch=86.6] | Loss=0.00767 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.392 | L2-Norm(final)=9.117 | 1913.6 samples/s | 29.9 steps/s
[Step=17800 Epoch=86.8] | Loss=0.00748 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.395 | L2-Norm(final)=9.120 | 4316.7 samples/s | 67.4 steps/s
[Step=17850 Epoch=87.0] | Loss=0.00736 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.399 | L2-Norm(final)=9.123 | 4615.8 samples/s | 72.1 steps/s
[Step=17900 Epoch=87.3] | Loss=0.00720 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.402 | L2-Norm(final)=9.126 | 4775.9 samples/s | 74.6 steps/s
[Step=17950 Epoch=87.5] | Loss=0.00702 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.405 | L2-Norm(final)=9.129 | 1952.3 samples/s | 30.5 steps/s
[Step=18000 Epoch=87.8] | Loss=0.00689 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.408 | L2-Norm(final)=9.131 | 4542.6 samples/s | 71.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step18000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=12001 Epoch=113.7] | Loss=0.00596 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.691 | L2-Norm(final)=5.990 | 3626.4 samples/s | 56.7 steps/s
[Step=12050 Epoch=114.2] | Loss=0.00421 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.792 | L2-Norm(final)=6.003 | 4311.7 samples/s | 67.4 steps/s
[Step=12100 Epoch=114.7] | Loss=0.00244 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.838 | L2-Norm(final)=6.024 | 6884.9 samples/s | 107.6 steps/s
[Step=12150 Epoch=115.1] | Loss=0.00175 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.856 | L2-Norm(final)=6.045 | 1711.4 samples/s | 26.7 steps/s
[Step=12200 Epoch=115.6] | Loss=0.00136 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.864 | L2-Norm(final)=6.061 | 6454.0 samples/s | 100.8 steps/s
[Step=12250 Epoch=116.1] | Loss=0.00112 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.865 | L2-Norm(final)=6.075 | 1739.4 samples/s | 27.2 steps/s
[Step=12300 Epoch=116.6] | Loss=0.00096 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.865 | L2-Norm(final)=6.088 | 5733.9 samples/s | 89.6 steps/s
[Step=12350 Epoch=117.0] | Loss=0.00085 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.863 | L2-Norm(final)=6.099 | 1807.6 samples/s | 28.2 steps/s
[Step=12400 Epoch=117.5] | Loss=0.00076 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.860 | L2-Norm(final)=6.111 | 5393.7 samples/s | 84.3 steps/s
[Step=12450 Epoch=118.0] | Loss=0.00069 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.857 | L2-Norm(final)=6.121 | 1875.0 samples/s | 29.3 steps/s
[Step=12500 Epoch=118.4] | Loss=0.00063 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.852 | L2-Norm(final)=6.131 | 4772.0 samples/s | 74.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=12501 Epoch=118.5] | Loss=0.00003 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.805 | L2-Norm(final)=6.229 | 3780.1 samples/s | 59.1 steps/s
[Step=12550 Epoch=118.9] | Loss=0.00016 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.794 | L2-Norm(final)=6.238 | 3905.7 samples/s | 61.0 steps/s
[Step=12600 Epoch=119.4] | Loss=0.00012 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=6.245 | 5926.6 samples/s | 92.6 steps/s
[Step=12650 Epoch=119.9] | Loss=0.00009 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.770 | L2-Norm(final)=6.250 | 1660.2 samples/s | 25.9 steps/s
[Step=12700 Epoch=120.3] | Loss=0.00007 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.753 | L2-Norm(final)=6.254 | 5546.9 samples/s | 86.7 steps/s
[Step=12750 Epoch=120.8] | Loss=0.00006 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.734 | L2-Norm(final)=6.256 | 1720.6 samples/s | 26.9 steps/s
[Step=12800 Epoch=121.3] | Loss=0.00005 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.714 | L2-Norm(final)=6.258 | 5095.2 samples/s | 79.6 steps/s
[Step=12850 Epoch=121.8] | Loss=0.00004 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.693 | L2-Norm(final)=6.259 | 1806.8 samples/s | 28.2 steps/s
[Step=12900 Epoch=122.2] | Loss=0.00004 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.672 | L2-Norm(final)=6.260 | 4851.8 samples/s | 75.8 steps/s
[Step=12950 Epoch=122.7] | Loss=0.00003 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.651 | L2-Norm(final)=6.261 | 1817.0 samples/s | 28.4 steps/s
[Step=13000 Epoch=123.2] | Loss=0.00003 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.629 | L2-Norm(final)=6.262 | 4296.9 samples/s | 67.1 steps/s
[Step=13050 Epoch=123.7] | Loss=0.00003 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.607 | L2-Norm(final)=6.263 | 1825.9 samples/s | 28.5 steps/s
[Step=13100 Epoch=124.1] | Loss=0.00003 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.585 | L2-Norm(final)=6.264 | 4434.8 samples/s | 69.3 steps/s
[Step=13150 Epoch=124.6] | Loss=0.00002 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.563 | L2-Norm(final)=6.264 | 1836.1 samples/s | 28.7 steps/s
[Step=13200 Epoch=125.1] | Loss=0.00002 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.540 | L2-Norm(final)=6.265 | 4377.7 samples/s | 68.4 steps/s
[Step=13250 Epoch=125.6] | Loss=0.00002 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.518 | L2-Norm(final)=6.265 | 1890.9 samples/s | 29.5 steps/s
[Step=13300 Epoch=126.0] | Loss=0.00002 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.495 | L2-Norm(final)=6.266 | 4412.6 samples/s | 68.9 steps/s
[Step=13350 Epoch=126.5] | Loss=0.00002 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.472 | L2-Norm(final)=6.267 | 1943.7 samples/s | 30.4 steps/s
[Step=13400 Epoch=127.0] | Loss=0.00002 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.449 | L2-Norm(final)=6.267 | 4226.1 samples/s | 66.0 steps/s
[Step=13450 Epoch=127.5] | Loss=0.00002 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.426 | L2-Norm(final)=6.268 | 6078.4 samples/s | 95.0 steps/s
[Step=13500 Epoch=127.9] | Loss=0.00002 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.403 | L2-Norm(final)=6.268 | 1715.8 samples/s | 26.8 steps/s
[Step=13550 Epoch=128.4] | Loss=0.00002 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.379 | L2-Norm(final)=6.269 | 5603.6 samples/s | 87.6 steps/s
[Step=13600 Epoch=128.9] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.356 | L2-Norm(final)=6.269 | 1752.5 samples/s | 27.4 steps/s
[Step=13650 Epoch=129.3] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.332 | L2-Norm(final)=6.270 | 5132.7 samples/s | 80.2 steps/s
[Step=13700 Epoch=129.8] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.308 | L2-Norm(final)=6.270 | 1753.5 samples/s | 27.4 steps/s
[Step=13750 Epoch=130.3] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.284 | L2-Norm(final)=6.270 | 4926.2 samples/s | 77.0 steps/s
[Step=13800 Epoch=130.8] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.260 | L2-Norm(final)=6.271 | 1843.4 samples/s | 28.8 steps/s
[Step=13850 Epoch=131.2] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.235 | L2-Norm(final)=6.271 | 4605.0 samples/s | 72.0 steps/s
[Step=13900 Epoch=131.7] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.211 | L2-Norm(final)=6.272 | 1864.7 samples/s | 29.1 steps/s
[Step=13950 Epoch=132.2] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.186 | L2-Norm(final)=6.272 | 4515.5 samples/s | 70.6 steps/s
[Step=14000 Epoch=132.7] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.162 | L2-Norm(final)=6.273 | 1868.1 samples/s | 29.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_0/client_state-step14000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=26001 Epoch=248.3] | Loss=0.00067 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.691 | L2-Norm(final)=7.804 | 3715.2 samples/s | 58.0 steps/s
[Step=26050 Epoch=248.8] | Loss=0.00241 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.728 | L2-Norm(final)=7.808 | 4681.4 samples/s | 73.1 steps/s
[Step=26100 Epoch=249.2] | Loss=0.00141 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.749 | L2-Norm(final)=7.818 | 6906.0 samples/s | 107.9 steps/s
[Step=26150 Epoch=249.7] | Loss=0.00106 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.756 | L2-Norm(final)=7.828 | 1720.7 samples/s | 26.9 steps/s
[Step=26200 Epoch=250.2] | Loss=0.00082 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.758 | L2-Norm(final)=7.837 | 6780.0 samples/s | 105.9 steps/s
[Step=26250 Epoch=250.7] | Loss=0.00067 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.757 | L2-Norm(final)=7.844 | 1784.0 samples/s | 27.9 steps/s
[Step=26300 Epoch=251.1] | Loss=0.00057 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.754 | L2-Norm(final)=7.850 | 5883.5 samples/s | 91.9 steps/s
[Step=26350 Epoch=251.6] | Loss=0.00050 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.751 | L2-Norm(final)=7.856 | 1834.9 samples/s | 28.7 steps/s
[Step=26400 Epoch=252.1] | Loss=0.00045 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.747 | L2-Norm(final)=7.861 | 5711.8 samples/s | 89.2 steps/s
[Step=26450 Epoch=252.6] | Loss=0.00040 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.743 | L2-Norm(final)=7.866 | 1848.6 samples/s | 28.9 steps/s
[Step=26500 Epoch=253.1] | Loss=0.00037 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.739 | L2-Norm(final)=7.871 | 5328.2 samples/s | 83.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=253.1] | Loss=0.00003 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.694 | L2-Norm(final)=7.920 | 3595.2 samples/s | 56.2 steps/s
[Step=26550 Epoch=253.5] | Loss=0.00004 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.686 | L2-Norm(final)=7.923 | 4280.3 samples/s | 66.9 steps/s
[Step=26600 Epoch=254.0] | Loss=0.00004 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.676 | L2-Norm(final)=7.926 | 5927.0 samples/s | 92.6 steps/s
[Step=26650 Epoch=254.5] | Loss=0.00003 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.666 | L2-Norm(final)=7.929 | 1674.3 samples/s | 26.2 steps/s
[Step=26700 Epoch=255.0] | Loss=0.00003 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.656 | L2-Norm(final)=7.931 | 5651.9 samples/s | 88.3 steps/s
[Step=26750 Epoch=255.4] | Loss=0.00002 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.646 | L2-Norm(final)=7.933 | 1686.0 samples/s | 26.3 steps/s
[Step=26800 Epoch=255.9] | Loss=0.00002 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.635 | L2-Norm(final)=7.935 | 5414.7 samples/s | 84.6 steps/s
[Step=26850 Epoch=256.4] | Loss=0.00002 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.625 | L2-Norm(final)=7.936 | 1743.0 samples/s | 27.2 steps/s
[Step=26900 Epoch=256.9] | Loss=0.00002 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.614 | L2-Norm(final)=7.937 | 4941.8 samples/s | 77.2 steps/s
[Step=26950 Epoch=257.4] | Loss=0.00002 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.603 | L2-Norm(final)=7.939 | 1779.8 samples/s | 27.8 steps/s
[Step=27000 Epoch=257.8] | Loss=0.00002 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.592 | L2-Norm(final)=7.940 | 4747.9 samples/s | 74.2 steps/s
[Step=27050 Epoch=258.3] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.580 | L2-Norm(final)=7.941 | 1828.2 samples/s | 28.6 steps/s
[Step=27100 Epoch=258.8] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.569 | L2-Norm(final)=7.942 | 4408.6 samples/s | 68.9 steps/s
[Step=27150 Epoch=259.3] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.558 | L2-Norm(final)=7.943 | 1857.6 samples/s | 29.0 steps/s
[Step=27200 Epoch=259.7] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.546 | L2-Norm(final)=7.943 | 4311.1 samples/s | 67.4 steps/s
[Step=27250 Epoch=260.2] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.535 | L2-Norm(final)=7.944 | 1858.8 samples/s | 29.0 steps/s
[Step=27300 Epoch=260.7] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.523 | L2-Norm(final)=7.945 | 4475.6 samples/s | 69.9 steps/s
[Step=27350 Epoch=261.2] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.511 | L2-Norm(final)=7.946 | 1872.9 samples/s | 29.3 steps/s
[Step=27400 Epoch=261.7] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.499 | L2-Norm(final)=7.947 | 4403.0 samples/s | 68.8 steps/s
[Step=27450 Epoch=262.1] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.487 | L2-Norm(final)=7.948 | 1913.6 samples/s | 29.9 steps/s
[Step=27500 Epoch=262.6] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.475 | L2-Norm(final)=7.949 | 4364.3 samples/s | 68.2 steps/s
[Step=27550 Epoch=263.1] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.463 | L2-Norm(final)=7.949 | 6428.7 samples/s | 100.4 steps/s
[Step=27600 Epoch=263.6] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.451 | L2-Norm(final)=7.950 | 1644.1 samples/s | 25.7 steps/s
[Step=27650 Epoch=264.0] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.439 | L2-Norm(final)=7.951 | 6044.2 samples/s | 94.4 steps/s
[Step=27700 Epoch=264.5] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.427 | L2-Norm(final)=7.952 | 1695.6 samples/s | 26.5 steps/s
[Step=27750 Epoch=265.0] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.414 | L2-Norm(final)=7.952 | 5822.4 samples/s | 91.0 steps/s
[Step=27800 Epoch=265.5] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.402 | L2-Norm(final)=7.953 | 1739.0 samples/s | 27.2 steps/s
[Step=27850 Epoch=266.0] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.389 | L2-Norm(final)=7.954 | 5277.5 samples/s | 82.5 steps/s
[Step=27900 Epoch=266.4] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.376 | L2-Norm(final)=7.955 | 1766.0 samples/s | 27.6 steps/s
[Step=27950 Epoch=266.9] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.363 | L2-Norm(final)=7.955 | 4822.8 samples/s | 75.4 steps/s
[Step=28000 Epoch=267.4] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.350 | L2-Norm(final)=7.956 | 1789.3 samples/s | 28.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step28000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=22001 Epoch=209.7] | Loss=0.00019 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.691 | L2-Norm(final)=8.304 | 3708.8 samples/s | 58.0 steps/s
[Step=22050 Epoch=210.2] | Loss=0.00301 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.763 | L2-Norm(final)=8.317 | 4639.5 samples/s | 72.5 steps/s
[Step=22100 Epoch=210.6] | Loss=0.00233 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.812 | L2-Norm(final)=8.337 | 7153.5 samples/s | 111.8 steps/s
[Step=22150 Epoch=211.1] | Loss=0.00168 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.847 | L2-Norm(final)=8.354 | 1756.9 samples/s | 27.5 steps/s
[Step=22200 Epoch=211.6] | Loss=0.00129 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.864 | L2-Norm(final)=8.366 | 6470.1 samples/s | 101.1 steps/s
[Step=22250 Epoch=212.1] | Loss=0.00105 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.873 | L2-Norm(final)=8.376 | 1824.2 samples/s | 28.5 steps/s
[Step=22300 Epoch=212.5] | Loss=0.00089 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.876 | L2-Norm(final)=8.384 | 5998.1 samples/s | 93.7 steps/s
[Step=22350 Epoch=213.0] | Loss=0.00078 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.877 | L2-Norm(final)=8.392 | 1792.2 samples/s | 28.0 steps/s
[Step=22400 Epoch=213.5] | Loss=0.00069 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.876 | L2-Norm(final)=8.398 | 5304.4 samples/s | 82.9 steps/s
[Step=22450 Epoch=214.0] | Loss=0.00062 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.874 | L2-Norm(final)=8.404 | 1861.3 samples/s | 29.1 steps/s
[Step=22500 Epoch=214.4] | Loss=0.00056 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.870 | L2-Norm(final)=8.410 | 5189.8 samples/s | 81.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=214.5] | Loss=0.00003 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.834 | L2-Norm(final)=8.465 | 3544.3 samples/s | 55.4 steps/s
[Step=22550 Epoch=214.9] | Loss=0.00004 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.818 | L2-Norm(final)=8.469 | 4427.6 samples/s | 69.2 steps/s
[Step=22600 Epoch=215.4] | Loss=0.00003 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.799 | L2-Norm(final)=8.471 | 6179.1 samples/s | 96.5 steps/s
[Step=22650 Epoch=215.9] | Loss=0.00002 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.778 | L2-Norm(final)=8.473 | 1687.7 samples/s | 26.4 steps/s
[Step=22700 Epoch=216.4] | Loss=0.00002 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.757 | L2-Norm(final)=8.474 | 5742.3 samples/s | 89.7 steps/s
[Step=22750 Epoch=216.8] | Loss=0.00002 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.734 | L2-Norm(final)=8.475 | 1724.7 samples/s | 26.9 steps/s
[Step=22800 Epoch=217.3] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.711 | L2-Norm(final)=8.476 | 5349.1 samples/s | 83.6 steps/s
[Step=22850 Epoch=217.8] | Loss=0.00001 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.688 | L2-Norm(final)=8.477 | 1816.9 samples/s | 28.4 steps/s
[Step=22900 Epoch=218.3] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.665 | L2-Norm(final)=8.477 | 5007.6 samples/s | 78.2 steps/s
[Step=22950 Epoch=218.7] | Loss=0.00001 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.641 | L2-Norm(final)=8.478 | 1794.1 samples/s | 28.0 steps/s
[Step=23000 Epoch=219.2] | Loss=0.00001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.618 | L2-Norm(final)=8.478 | 4856.9 samples/s | 75.9 steps/s
[Step=23050 Epoch=219.7] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.594 | L2-Norm(final)=8.479 | 1855.9 samples/s | 29.0 steps/s
[Step=23100 Epoch=220.2] | Loss=0.00001 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.570 | L2-Norm(final)=8.479 | 4434.2 samples/s | 69.3 steps/s
[Step=23150 Epoch=220.6] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.546 | L2-Norm(final)=8.479 | 1869.3 samples/s | 29.2 steps/s
[Step=23200 Epoch=221.1] | Loss=0.00001 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.522 | L2-Norm(final)=8.480 | 4444.5 samples/s | 69.4 steps/s
[Step=23250 Epoch=221.6] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.497 | L2-Norm(final)=8.480 | 1852.6 samples/s | 28.9 steps/s
[Step=23300 Epoch=222.1] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.473 | L2-Norm(final)=8.481 | 4505.8 samples/s | 70.4 steps/s
[Step=23350 Epoch=222.5] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.448 | L2-Norm(final)=8.481 | 1868.2 samples/s | 29.2 steps/s
[Step=23400 Epoch=223.0] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=8.481 | 4406.7 samples/s | 68.9 steps/s
[Step=23450 Epoch=223.5] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.399 | L2-Norm(final)=8.482 | 1850.5 samples/s | 28.9 steps/s
[Step=23500 Epoch=224.0] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.374 | L2-Norm(final)=8.482 | 4471.0 samples/s | 69.9 steps/s
[Step=23550 Epoch=224.5] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.349 | L2-Norm(final)=8.483 | 6293.1 samples/s | 98.3 steps/s
[Step=23600 Epoch=224.9] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.323 | L2-Norm(final)=8.483 | 1675.7 samples/s | 26.2 steps/s
[Step=23650 Epoch=225.4] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.298 | L2-Norm(final)=8.483 | 6081.7 samples/s | 95.0 steps/s
[Step=23700 Epoch=225.9] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.272 | L2-Norm(final)=8.484 | 1685.5 samples/s | 26.3 steps/s
[Step=23750 Epoch=226.4] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.247 | L2-Norm(final)=8.484 | 5530.3 samples/s | 86.4 steps/s
[Step=23800 Epoch=226.8] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.221 | L2-Norm(final)=8.485 | 1705.4 samples/s | 26.6 steps/s
[Step=23850 Epoch=227.3] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.195 | L2-Norm(final)=8.485 | 5234.1 samples/s | 81.8 steps/s
[Step=23900 Epoch=227.8] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.169 | L2-Norm(final)=8.486 | 1755.3 samples/s | 27.4 steps/s
[Step=23950 Epoch=228.3] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.143 | L2-Norm(final)=8.486 | 5030.9 samples/s | 78.6 steps/s
[Step=24000 Epoch=228.7] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.116 | L2-Norm(final)=8.486 | 1823.4 samples/s | 28.5 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09453 | acc=0.9595 | tpr=0.9676 | fpr=0.0580 | 4090.9 samples/s | 16.0 steps/s
Avg test loss: 0.09893, Avg test acc: 0.95813, Avg tpr: 0.96654, Avg fpr: 0.06038, total FA: 471

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09252 | acc=0.9594 | tpr=0.9742 | fpr=0.0728 | 4056.1 samples/s | 15.8 steps/s
Avg test loss: 0.09752, Avg test acc: 0.95909, Avg tpr: 0.97377, Avg fpr: 0.07320, total FA: 571

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11099 | acc=0.9528 | tpr=0.9596 | fpr=0.0619 | 4180.9 samples/s | 16.3 steps/s
Avg test loss: 0.11841, Avg test acc: 0.95104, Avg tpr: 0.95693, Avg fpr: 0.06192, total FA: 483

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09012 | acc=0.9601 | tpr=0.9719 | fpr=0.0657 | 4071.5 samples/s | 15.9 steps/s
Avg test loss: 0.09445, Avg test acc: 0.96001, Avg tpr: 0.97191, Avg fpr: 0.06615, total FA: 516

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10177 | acc=0.9606 | tpr=0.9742 | fpr=0.0689 | 4086.3 samples/s | 16.0 steps/s
Avg test loss: 0.10719, Avg test acc: 0.95905, Avg tpr: 0.97266, Avg fpr: 0.07089, total FA: 553

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.21628 | acc=0.2839 | tpr=0.0037 | fpr=0.1075 | 4006.7 samples/s | 15.7 steps/s
Avg test loss: 5.23325, Avg test acc: 0.28139, Avg tpr: 0.00455, Avg fpr: 0.10973, total FA: 856

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.71777 | acc=0.3050 | tpr=0.0038 | fpr=0.0409 | 4118.8 samples/s | 16.1 steps/s
Avg test loss: 4.72211, Avg test acc: 0.30395, Avg tpr: 0.00495, Avg fpr: 0.03846, total FA: 300

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.01157 | acc=0.2942 | tpr=0.0082 | fpr=0.0847 | 3926.0 samples/s | 15.3 steps/s
Avg test loss: 5.02197, Avg test acc: 0.29333, Avg tpr: 0.00956, Avg fpr: 0.08255, total FA: 644

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.01390 | acc=0.2974 | tpr=0.0071 | fpr=0.0721 | 4172.3 samples/s | 16.3 steps/s
Avg test loss: 5.02218, Avg test acc: 0.29598, Avg tpr: 0.00775, Avg fpr: 0.07012, total FA: 547

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.00159 | acc=0.3106 | tpr=0.0025 | fpr=0.0203 | 4135.5 samples/s | 16.2 steps/s
Avg test loss: 5.01046, Avg test acc: 0.30760, Avg tpr: 0.00291, Avg fpr: 0.02230, total FA: 174

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.20033 | acc=0.1381 | tpr=0.7699 | fpr=0.8732 | 4109.3 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.14577 | acc=0.1401 | tpr=0.7463 | fpr=0.8712 | 8015.4 samples/s | 31.3 steps/s
[Step= 150] | Loss=5.14693 | acc=0.1385 | tpr=0.7550 | fpr=0.8729 | 8209.2 samples/s | 32.1 steps/s
[Step= 200] | Loss=5.14395 | acc=0.1381 | tpr=0.7486 | fpr=0.8730 | 8081.3 samples/s | 31.6 steps/s
[Step= 250] | Loss=5.14602 | acc=0.1389 | tpr=0.7555 | fpr=0.8724 | 7782.2 samples/s | 30.4 steps/s
[Step= 300] | Loss=5.14243 | acc=0.1390 | tpr=0.7578 | fpr=0.8723 | 8035.0 samples/s | 31.4 steps/s
[Step= 350] | Loss=5.13891 | acc=0.1386 | tpr=0.7570 | fpr=0.8726 | 8105.9 samples/s | 31.7 steps/s
[Step= 400] | Loss=5.14152 | acc=0.1388 | tpr=0.7511 | fpr=0.8724 | 8131.8 samples/s | 31.8 steps/s
[Step= 450] | Loss=5.14341 | acc=0.1385 | tpr=0.7468 | fpr=0.8725 | 7972.1 samples/s | 31.1 steps/s
[Step= 500] | Loss=5.14551 | acc=0.1382 | tpr=0.7449 | fpr=0.8728 | 7825.0 samples/s | 30.6 steps/s
[Step= 550] | Loss=5.14502 | acc=0.1378 | tpr=0.7481 | fpr=0.8733 | 14907.7 samples/s | 58.2 steps/s
Avg test loss: 5.14677, Avg test acc: 0.13778, Avg tpr: 0.74802, Avg fpr: 0.87331, total FA: 121258

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.85811 | acc=0.1286 | tpr=0.7920 | fpr=0.8833 | 4154.6 samples/s | 16.2 steps/s
[Step= 100] | Loss=4.80342 | acc=0.1306 | tpr=0.7612 | fpr=0.8811 | 7736.1 samples/s | 30.2 steps/s
[Step= 150] | Loss=4.81098 | acc=0.1284 | tpr=0.7507 | fpr=0.8831 | 7975.2 samples/s | 31.2 steps/s
[Step= 200] | Loss=4.80811 | acc=0.1280 | tpr=0.7366 | fpr=0.8831 | 8202.7 samples/s | 32.0 steps/s
[Step= 250] | Loss=4.80801 | acc=0.1280 | tpr=0.7336 | fpr=0.8830 | 7830.2 samples/s | 30.6 steps/s
[Step= 300] | Loss=4.80763 | acc=0.1274 | tpr=0.7360 | fpr=0.8836 | 7754.4 samples/s | 30.3 steps/s
[Step= 350] | Loss=4.80297 | acc=0.1269 | tpr=0.7314 | fpr=0.8841 | 7987.1 samples/s | 31.2 steps/s
[Step= 400] | Loss=4.80360 | acc=0.1272 | tpr=0.7314 | fpr=0.8838 | 8403.8 samples/s | 32.8 steps/s
[Step= 450] | Loss=4.80847 | acc=0.1272 | tpr=0.7259 | fpr=0.8836 | 7935.8 samples/s | 31.0 steps/s
[Step= 500] | Loss=4.81384 | acc=0.1268 | tpr=0.7216 | fpr=0.8839 | 8068.0 samples/s | 31.5 steps/s
[Step= 550] | Loss=4.81394 | acc=0.1268 | tpr=0.7226 | fpr=0.8840 | 14458.6 samples/s | 56.5 steps/s
Avg test loss: 4.81498, Avg test acc: 0.12675, Avg tpr: 0.72266, Avg fpr: 0.88408, total FA: 122753

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.14776 | acc=0.1248 | tpr=0.6460 | fpr=0.8846 | 3898.6 samples/s | 15.2 steps/s
[Step= 100] | Loss=6.10154 | acc=0.1262 | tpr=0.6034 | fpr=0.8827 | 7979.6 samples/s | 31.2 steps/s
[Step= 150] | Loss=6.11920 | acc=0.1242 | tpr=0.6153 | fpr=0.8848 | 8189.8 samples/s | 32.0 steps/s
[Step= 200] | Loss=6.11919 | acc=0.1237 | tpr=0.6208 | fpr=0.8854 | 8114.6 samples/s | 31.7 steps/s
[Step= 250] | Loss=6.12245 | acc=0.1233 | tpr=0.6157 | fpr=0.8856 | 8181.5 samples/s | 32.0 steps/s
[Step= 300] | Loss=6.12204 | acc=0.1234 | tpr=0.6145 | fpr=0.8856 | 7630.1 samples/s | 29.8 steps/s
[Step= 350] | Loss=6.11866 | acc=0.1231 | tpr=0.6099 | fpr=0.8858 | 8375.4 samples/s | 32.7 steps/s
[Step= 400] | Loss=6.12116 | acc=0.1233 | tpr=0.6018 | fpr=0.8854 | 8423.6 samples/s | 32.9 steps/s
[Step= 450] | Loss=6.12255 | acc=0.1229 | tpr=0.5974 | fpr=0.8857 | 8018.0 samples/s | 31.3 steps/s
[Step= 500] | Loss=6.12258 | acc=0.1229 | tpr=0.5916 | fpr=0.8856 | 8104.1 samples/s | 31.7 steps/s
[Step= 550] | Loss=6.12254 | acc=0.1227 | tpr=0.5965 | fpr=0.8859 | 14211.6 samples/s | 55.5 steps/s
Avg test loss: 6.12411, Avg test acc: 0.12263, Avg tpr: 0.59628, Avg fpr: 0.88598, total FA: 123017

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.67480 | acc=0.1359 | tpr=0.7124 | fpr=0.8744 | 3875.2 samples/s | 15.1 steps/s
[Step= 100] | Loss=4.63247 | acc=0.1366 | tpr=0.6780 | fpr=0.8735 | 8756.8 samples/s | 34.2 steps/s
[Step= 150] | Loss=4.62961 | acc=0.1352 | tpr=0.6729 | fpr=0.8747 | 7598.2 samples/s | 29.7 steps/s
[Step= 200] | Loss=4.62379 | acc=0.1342 | tpr=0.6667 | fpr=0.8755 | 7770.5 samples/s | 30.4 steps/s
[Step= 250] | Loss=4.62465 | acc=0.1345 | tpr=0.6716 | fpr=0.8753 | 8196.5 samples/s | 32.0 steps/s
[Step= 300] | Loss=4.62236 | acc=0.1340 | tpr=0.6749 | fpr=0.8758 | 8172.4 samples/s | 31.9 steps/s
[Step= 350] | Loss=4.61840 | acc=0.1339 | tpr=0.6694 | fpr=0.8759 | 7981.1 samples/s | 31.2 steps/s
[Step= 400] | Loss=4.62152 | acc=0.1338 | tpr=0.6658 | fpr=0.8759 | 8138.6 samples/s | 31.8 steps/s
[Step= 450] | Loss=4.62547 | acc=0.1337 | tpr=0.6607 | fpr=0.8759 | 8232.1 samples/s | 32.2 steps/s
[Step= 500] | Loss=4.62834 | acc=0.1335 | tpr=0.6626 | fpr=0.8761 | 8017.6 samples/s | 31.3 steps/s
[Step= 550] | Loss=4.62830 | acc=0.1333 | tpr=0.6598 | fpr=0.8763 | 13711.8 samples/s | 53.6 steps/s
Avg test loss: 4.62971, Avg test acc: 0.13324, Avg tpr: 0.65967, Avg fpr: 0.87633, total FA: 121677

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.68582 | acc=0.1280 | tpr=0.7655 | fpr=0.8835 | 4011.3 samples/s | 15.7 steps/s
[Step= 100] | Loss=5.63505 | acc=0.1285 | tpr=0.7335 | fpr=0.8828 | 7247.9 samples/s | 28.3 steps/s
[Step= 150] | Loss=5.64204 | acc=0.1258 | tpr=0.7349 | fpr=0.8854 | 8079.6 samples/s | 31.6 steps/s
[Step= 200] | Loss=5.64104 | acc=0.1252 | tpr=0.7301 | fpr=0.8859 | 8102.6 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.64290 | acc=0.1256 | tpr=0.7319 | fpr=0.8855 | 8242.5 samples/s | 32.2 steps/s
[Step= 300] | Loss=5.63784 | acc=0.1253 | tpr=0.7338 | fpr=0.8858 | 7921.5 samples/s | 30.9 steps/s
[Step= 350] | Loss=5.63532 | acc=0.1248 | tpr=0.7364 | fpr=0.8863 | 8127.7 samples/s | 31.7 steps/s
[Step= 400] | Loss=5.63682 | acc=0.1249 | tpr=0.7325 | fpr=0.8862 | 7914.8 samples/s | 30.9 steps/s
[Step= 450] | Loss=5.63905 | acc=0.1245 | tpr=0.7288 | fpr=0.8864 | 8218.3 samples/s | 32.1 steps/s
[Step= 500] | Loss=5.64042 | acc=0.1243 | tpr=0.7264 | fpr=0.8866 | 8193.7 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.64138 | acc=0.1240 | tpr=0.7270 | fpr=0.8869 | 14903.0 samples/s | 58.2 steps/s
Avg test loss: 5.64332, Avg test acc: 0.12399, Avg tpr: 0.72662, Avg fpr: 0.88696, total FA: 123153

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10814 | acc=0.9805 | tpr=0.9159 | fpr=0.0183 | 4204.9 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.11173 | acc=0.9804 | tpr=0.9403 | fpr=0.0189 | 7642.4 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.11610 | acc=0.9792 | tpr=0.9424 | fpr=0.0201 | 7829.9 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.11801 | acc=0.9791 | tpr=0.9421 | fpr=0.0202 | 8128.9 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.11733 | acc=0.9790 | tpr=0.9380 | fpr=0.0203 | 8116.6 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.11959 | acc=0.9787 | tpr=0.9353 | fpr=0.0205 | 7755.6 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.11941 | acc=0.9787 | tpr=0.9355 | fpr=0.0205 | 8250.1 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.12092 | acc=0.9784 | tpr=0.9311 | fpr=0.0207 | 8165.1 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.12375 | acc=0.9781 | tpr=0.9318 | fpr=0.0210 | 7359.7 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.12328 | acc=0.9782 | tpr=0.9335 | fpr=0.0210 | 8132.3 samples/s | 31.8 steps/s
[Step= 550] | Loss=0.12212 | acc=0.9784 | tpr=0.9339 | fpr=0.0208 | 15179.7 samples/s | 59.3 steps/s
Avg test loss: 0.12193, Avg test acc: 0.97843, Avg tpr: 0.93423, Avg fpr: 0.02077, total FA: 2884

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10274 | acc=0.9827 | tpr=0.8805 | fpr=0.0154 | 4129.5 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.10500 | acc=0.9825 | tpr=0.8998 | fpr=0.0159 | 7940.9 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.10623 | acc=0.9820 | tpr=0.9035 | fpr=0.0165 | 8669.3 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.10853 | acc=0.9816 | tpr=0.9093 | fpr=0.0171 | 7770.3 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.10819 | acc=0.9816 | tpr=0.9057 | fpr=0.0170 | 7960.5 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.10989 | acc=0.9812 | tpr=0.9040 | fpr=0.0174 | 8267.6 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.11000 | acc=0.9810 | tpr=0.9036 | fpr=0.0176 | 8153.9 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.11122 | acc=0.9808 | tpr=0.9004 | fpr=0.0177 | 8033.3 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.11410 | acc=0.9805 | tpr=0.9002 | fpr=0.0181 | 7738.8 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.11375 | acc=0.9804 | tpr=0.9022 | fpr=0.0182 | 7782.4 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.11300 | acc=0.9805 | tpr=0.9021 | fpr=0.0180 | 14001.3 samples/s | 54.7 steps/s
Avg test loss: 0.11282, Avg test acc: 0.98051, Avg tpr: 0.90095, Avg fpr: 0.01804, total FA: 2505

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11607 | acc=0.9791 | tpr=0.9381 | fpr=0.0202 | 4081.0 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.11997 | acc=0.9782 | tpr=0.9552 | fpr=0.0213 | 7962.3 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.12438 | acc=0.9773 | tpr=0.9553 | fpr=0.0223 | 8099.2 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.12679 | acc=0.9771 | tpr=0.9574 | fpr=0.0225 | 8468.4 samples/s | 33.1 steps/s
[Step= 250] | Loss=0.12567 | acc=0.9772 | tpr=0.9546 | fpr=0.0224 | 7954.1 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.12797 | acc=0.9768 | tpr=0.9571 | fpr=0.0229 | 8075.4 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.12786 | acc=0.9767 | tpr=0.9574 | fpr=0.0230 | 8128.0 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.12940 | acc=0.9765 | tpr=0.9540 | fpr=0.0231 | 8067.7 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.13249 | acc=0.9761 | tpr=0.9528 | fpr=0.0234 | 8028.0 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.13209 | acc=0.9762 | tpr=0.9542 | fpr=0.0234 | 8008.9 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.13070 | acc=0.9764 | tpr=0.9538 | fpr=0.0232 | 14705.4 samples/s | 57.4 steps/s
Avg test loss: 0.13054, Avg test acc: 0.97645, Avg tpr: 0.95404, Avg fpr: 0.02315, total FA: 3214

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11895 | acc=0.9814 | tpr=0.9159 | fpr=0.0174 | 4130.1 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.12446 | acc=0.9808 | tpr=0.9403 | fpr=0.0185 | 7855.1 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.12987 | acc=0.9798 | tpr=0.9366 | fpr=0.0194 | 8020.6 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.13213 | acc=0.9796 | tpr=0.9399 | fpr=0.0197 | 8434.4 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.13068 | acc=0.9795 | tpr=0.9397 | fpr=0.0197 | 7129.2 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.13284 | acc=0.9791 | tpr=0.9375 | fpr=0.0201 | 7527.2 samples/s | 29.4 steps/s
[Step= 350] | Loss=0.13266 | acc=0.9790 | tpr=0.9405 | fpr=0.0203 | 7994.9 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.13408 | acc=0.9788 | tpr=0.9354 | fpr=0.0204 | 7974.2 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.13708 | acc=0.9785 | tpr=0.9314 | fpr=0.0207 | 7935.9 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.13664 | acc=0.9785 | tpr=0.9322 | fpr=0.0207 | 8237.4 samples/s | 32.2 steps/s
[Step= 550] | Loss=0.13562 | acc=0.9787 | tpr=0.9327 | fpr=0.0205 | 12604.9 samples/s | 49.2 steps/s
Avg test loss: 0.13543, Avg test acc: 0.97864, Avg tpr: 0.93225, Avg fpr: 0.02052, total FA: 2849

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.13106 | acc=0.9793 | tpr=0.9204 | fpr=0.0196 | 4072.3 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.13614 | acc=0.9793 | tpr=0.9424 | fpr=0.0200 | 8218.7 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.14088 | acc=0.9783 | tpr=0.9438 | fpr=0.0211 | 8099.3 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.14353 | acc=0.9781 | tpr=0.9464 | fpr=0.0213 | 8307.6 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.14209 | acc=0.9782 | tpr=0.9441 | fpr=0.0212 | 8443.2 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.14485 | acc=0.9778 | tpr=0.9447 | fpr=0.0216 | 7577.8 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.14517 | acc=0.9776 | tpr=0.9449 | fpr=0.0218 | 8050.4 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.14691 | acc=0.9774 | tpr=0.9387 | fpr=0.0219 | 8327.4 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.15010 | acc=0.9770 | tpr=0.9391 | fpr=0.0223 | 7968.5 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.14953 | acc=0.9770 | tpr=0.9396 | fpr=0.0223 | 8008.1 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.14857 | acc=0.9772 | tpr=0.9387 | fpr=0.0221 | 14212.7 samples/s | 55.5 steps/s
Avg test loss: 0.14832, Avg test acc: 0.97719, Avg tpr: 0.93859, Avg fpr: 0.02211, total FA: 3070

server round 24/50

clients selected: [3 6 7 8 9]

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=18001 Epoch=87.8] | Loss=0.00397 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=9.216 | 3616.9 samples/s | 56.5 steps/s
[Step=18050 Epoch=88.0] | Loss=0.02678 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.522 | L2-Norm(final)=9.203 | 4487.7 samples/s | 70.1 steps/s
[Step=18100 Epoch=88.3] | Loss=0.02490 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.547 | L2-Norm(final)=9.203 | 5038.8 samples/s | 78.7 steps/s
[Step=18150 Epoch=88.5] | Loss=0.02509 | Reg=0.00134 | acc=0.9531 | L2-Norm=11.570 | L2-Norm(final)=9.209 | 5175.1 samples/s | 80.9 steps/s
[Step=18200 Epoch=88.8] | Loss=0.02385 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.594 | L2-Norm(final)=9.216 | 7335.2 samples/s | 114.6 steps/s
[Step=18250 Epoch=89.0] | Loss=0.02218 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.617 | L2-Norm(final)=9.228 | 1837.7 samples/s | 28.7 steps/s
[Step=18300 Epoch=89.2] | Loss=0.02121 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.640 | L2-Norm(final)=9.241 | 5161.0 samples/s | 80.6 steps/s
[Step=18350 Epoch=89.5] | Loss=0.02093 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.662 | L2-Norm(final)=9.256 | 5425.5 samples/s | 84.8 steps/s
[Step=18400 Epoch=89.7] | Loss=0.02013 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.683 | L2-Norm(final)=9.270 | 6785.5 samples/s | 106.0 steps/s
[Step=18450 Epoch=90.0] | Loss=0.01927 | Reg=0.00137 | acc=0.9688 | L2-Norm=11.704 | L2-Norm(final)=9.284 | 1824.6 samples/s | 28.5 steps/s
[Step=18500 Epoch=90.2] | Loss=0.01887 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.724 | L2-Norm(final)=9.298 | 5147.8 samples/s | 80.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=90.2] | Loss=0.00186 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.924 | L2-Norm(final)=9.449 | 3568.5 samples/s | 55.8 steps/s
[Step=18550 Epoch=90.5] | Loss=0.01672 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.947 | L2-Norm(final)=9.462 | 4602.4 samples/s | 71.9 steps/s
[Step=18600 Epoch=90.7] | Loss=0.01929 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.975 | L2-Norm(final)=9.473 | 4551.6 samples/s | 71.1 steps/s
[Step=18650 Epoch=90.9] | Loss=0.01978 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.000 | L2-Norm(final)=9.480 | 4545.2 samples/s | 71.0 steps/s
[Step=18700 Epoch=91.2] | Loss=0.01932 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.021 | L2-Norm(final)=9.485 | 6145.4 samples/s | 96.0 steps/s
[Step=18750 Epoch=91.4] | Loss=0.01715 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.040 | L2-Norm(final)=9.490 | 1754.4 samples/s | 27.4 steps/s
[Step=18800 Epoch=91.7] | Loss=0.01575 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.056 | L2-Norm(final)=9.498 | 4580.4 samples/s | 71.6 steps/s
[Step=18850 Epoch=91.9] | Loss=0.01436 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=9.504 | 4659.0 samples/s | 72.8 steps/s
[Step=18900 Epoch=92.2] | Loss=0.01371 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.082 | L2-Norm(final)=9.510 | 5782.6 samples/s | 90.4 steps/s
[Step=18950 Epoch=92.4] | Loss=0.01295 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.092 | L2-Norm(final)=9.516 | 1842.9 samples/s | 28.8 steps/s
[Step=19000 Epoch=92.7] | Loss=0.01222 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.102 | L2-Norm(final)=9.522 | 4685.7 samples/s | 73.2 steps/s
[Step=19050 Epoch=92.9] | Loss=0.01162 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.111 | L2-Norm(final)=9.527 | 4610.6 samples/s | 72.0 steps/s
[Step=19100 Epoch=93.1] | Loss=0.01121 | Reg=0.00147 | acc=0.9688 | L2-Norm=12.118 | L2-Norm(final)=9.532 | 5364.0 samples/s | 83.8 steps/s
[Step=19150 Epoch=93.4] | Loss=0.01076 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.125 | L2-Norm(final)=9.537 | 1853.1 samples/s | 29.0 steps/s
[Step=19200 Epoch=93.6] | Loss=0.01027 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.132 | L2-Norm(final)=9.541 | 4641.5 samples/s | 72.5 steps/s
[Step=19250 Epoch=93.9] | Loss=0.00983 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.138 | L2-Norm(final)=9.546 | 4625.4 samples/s | 72.3 steps/s
[Step=19300 Epoch=94.1] | Loss=0.00945 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.144 | L2-Norm(final)=9.550 | 4928.6 samples/s | 77.0 steps/s
[Step=19350 Epoch=94.4] | Loss=0.00921 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.150 | L2-Norm(final)=9.555 | 1887.6 samples/s | 29.5 steps/s
[Step=19400 Epoch=94.6] | Loss=0.00895 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=9.559 | 4681.1 samples/s | 73.1 steps/s
[Step=19450 Epoch=94.8] | Loss=0.00870 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.160 | L2-Norm(final)=9.562 | 4597.0 samples/s | 71.8 steps/s
[Step=19500 Epoch=95.1] | Loss=0.00848 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.165 | L2-Norm(final)=9.566 | 4745.2 samples/s | 74.1 steps/s
[Step=19550 Epoch=95.3] | Loss=0.00824 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.169 | L2-Norm(final)=9.570 | 1904.8 samples/s | 29.8 steps/s
[Step=19600 Epoch=95.6] | Loss=0.00803 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.174 | L2-Norm(final)=9.574 | 4681.0 samples/s | 73.1 steps/s
[Step=19650 Epoch=95.8] | Loss=0.00781 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.178 | L2-Norm(final)=9.577 | 4648.9 samples/s | 72.6 steps/s
[Step=19700 Epoch=96.1] | Loss=0.00766 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.182 | L2-Norm(final)=9.581 | 4604.5 samples/s | 71.9 steps/s
[Step=19750 Epoch=96.3] | Loss=0.00751 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.185 | L2-Norm(final)=9.584 | 1950.0 samples/s | 30.5 steps/s
[Step=19800 Epoch=96.6] | Loss=0.00736 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.188 | L2-Norm(final)=9.587 | 4752.2 samples/s | 74.3 steps/s
[Step=19850 Epoch=96.8] | Loss=0.00725 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.191 | L2-Norm(final)=9.590 | 4536.2 samples/s | 70.9 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00707 | Reg=0.00149 | acc=0.9844 | L2-Norm=12.194 | L2-Norm(final)=9.593 | 4406.4 samples/s | 68.9 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00692 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.197 | L2-Norm(final)=9.596 | 1962.5 samples/s | 30.7 steps/s
[Step=20000 Epoch=97.5] | Loss=0.00676 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.200 | L2-Norm(final)=9.599 | 4617.5 samples/s | 72.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step20000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=26001 Epoch=247.3] | Loss=0.00057 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=8.514 | 3639.1 samples/s | 56.9 steps/s
[Step=26050 Epoch=247.8] | Loss=0.00620 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.574 | L2-Norm(final)=8.508 | 4565.2 samples/s | 71.3 steps/s
[Step=26100 Epoch=248.3] | Loss=0.00331 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.623 | L2-Norm(final)=8.508 | 7105.2 samples/s | 111.0 steps/s
[Step=26150 Epoch=248.8] | Loss=0.00227 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.641 | L2-Norm(final)=8.514 | 1762.2 samples/s | 27.5 steps/s
[Step=26200 Epoch=249.2] | Loss=0.00176 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.649 | L2-Norm(final)=8.519 | 6350.6 samples/s | 99.2 steps/s
[Step=26250 Epoch=249.7] | Loss=0.00144 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.653 | L2-Norm(final)=8.525 | 1777.4 samples/s | 27.8 steps/s
[Step=26300 Epoch=250.2] | Loss=0.00122 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=8.530 | 5841.5 samples/s | 91.3 steps/s
[Step=26350 Epoch=250.7] | Loss=0.00106 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=8.536 | 1839.4 samples/s | 28.7 steps/s
[Step=26400 Epoch=251.1] | Loss=0.00094 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=8.540 | 5413.7 samples/s | 84.6 steps/s
[Step=26450 Epoch=251.6] | Loss=0.00084 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=8.545 | 1882.5 samples/s | 29.4 steps/s
[Step=26500 Epoch=252.1] | Loss=0.00077 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.653 | L2-Norm(final)=8.549 | 5057.7 samples/s | 79.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=252.1] | Loss=0.00003 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.635 | L2-Norm(final)=8.592 | 3518.1 samples/s | 55.0 steps/s
[Step=26550 Epoch=252.6] | Loss=0.00005 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.629 | L2-Norm(final)=8.595 | 4298.7 samples/s | 67.2 steps/s
[Step=26600 Epoch=253.0] | Loss=0.00005 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.622 | L2-Norm(final)=8.598 | 6261.6 samples/s | 97.8 steps/s
[Step=26650 Epoch=253.5] | Loss=0.00004 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.614 | L2-Norm(final)=8.600 | 1693.1 samples/s | 26.5 steps/s
[Step=26700 Epoch=254.0] | Loss=0.00003 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.606 | L2-Norm(final)=8.601 | 5419.1 samples/s | 84.7 steps/s
[Step=26750 Epoch=254.5] | Loss=0.00003 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.597 | L2-Norm(final)=8.603 | 1724.7 samples/s | 26.9 steps/s
[Step=26800 Epoch=254.9] | Loss=0.00003 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.588 | L2-Norm(final)=8.604 | 5005.0 samples/s | 78.2 steps/s
[Step=26850 Epoch=255.4] | Loss=0.00002 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.578 | L2-Norm(final)=8.605 | 1775.3 samples/s | 27.7 steps/s
[Step=26900 Epoch=255.9] | Loss=0.00002 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.569 | L2-Norm(final)=8.606 | 5171.0 samples/s | 80.8 steps/s
[Step=26950 Epoch=256.4] | Loss=0.00002 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.559 | L2-Norm(final)=8.607 | 1828.7 samples/s | 28.6 steps/s
[Step=27000 Epoch=256.8] | Loss=0.00002 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.549 | L2-Norm(final)=8.608 | 4531.3 samples/s | 70.8 steps/s
[Step=27050 Epoch=257.3] | Loss=0.00002 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.539 | L2-Norm(final)=8.608 | 1877.6 samples/s | 29.3 steps/s
[Step=27100 Epoch=257.8] | Loss=0.00002 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.529 | L2-Norm(final)=8.609 | 4441.7 samples/s | 69.4 steps/s
[Step=27150 Epoch=258.3] | Loss=0.00002 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.519 | L2-Norm(final)=8.610 | 1888.4 samples/s | 29.5 steps/s
[Step=27200 Epoch=258.7] | Loss=0.00002 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.509 | L2-Norm(final)=8.611 | 4465.9 samples/s | 69.8 steps/s
[Step=27250 Epoch=259.2] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.498 | L2-Norm(final)=8.611 | 1863.7 samples/s | 29.1 steps/s
[Step=27300 Epoch=259.7] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.488 | L2-Norm(final)=8.612 | 4337.4 samples/s | 67.8 steps/s
[Step=27350 Epoch=260.2] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.477 | L2-Norm(final)=8.613 | 1907.2 samples/s | 29.8 steps/s
[Step=27400 Epoch=260.6] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.466 | L2-Norm(final)=8.613 | 4119.8 samples/s | 64.4 steps/s
[Step=27450 Epoch=261.1] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.455 | L2-Norm(final)=8.614 | 6160.5 samples/s | 96.3 steps/s
[Step=27500 Epoch=261.6] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.444 | L2-Norm(final)=8.615 | 1681.3 samples/s | 26.3 steps/s
[Step=27550 Epoch=262.1] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.433 | L2-Norm(final)=8.615 | 5766.6 samples/s | 90.1 steps/s
[Step=27600 Epoch=262.5] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.422 | L2-Norm(final)=8.616 | 1741.4 samples/s | 27.2 steps/s
[Step=27650 Epoch=263.0] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.410 | L2-Norm(final)=8.617 | 5081.1 samples/s | 79.4 steps/s
[Step=27700 Epoch=263.5] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.399 | L2-Norm(final)=8.617 | 1774.9 samples/s | 27.7 steps/s
[Step=27750 Epoch=264.0] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.387 | L2-Norm(final)=8.618 | 4846.8 samples/s | 75.7 steps/s
[Step=27800 Epoch=264.4] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.376 | L2-Norm(final)=8.618 | 1802.0 samples/s | 28.2 steps/s
[Step=27850 Epoch=264.9] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.364 | L2-Norm(final)=8.619 | 4708.4 samples/s | 73.6 steps/s
[Step=27900 Epoch=265.4] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=8.620 | 1837.0 samples/s | 28.7 steps/s
[Step=27950 Epoch=265.9] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.340 | L2-Norm(final)=8.620 | 4450.1 samples/s | 69.5 steps/s
[Step=28000 Epoch=266.3] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.327 | L2-Norm(final)=8.621 | 1870.8 samples/s | 29.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step28000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=28001 Epoch=267.4] | Loss=0.00009 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.503 | L2-Norm(final)=7.978 | 3864.2 samples/s | 60.4 steps/s
[Step=28050 Epoch=267.9] | Loss=0.00345 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.585 | L2-Norm(final)=7.968 | 4368.3 samples/s | 68.3 steps/s
[Step=28100 Epoch=268.3] | Loss=0.00227 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.628 | L2-Norm(final)=7.978 | 7096.1 samples/s | 110.9 steps/s
[Step=28150 Epoch=268.8] | Loss=0.00158 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.644 | L2-Norm(final)=7.986 | 1687.0 samples/s | 26.4 steps/s
[Step=28200 Epoch=269.3] | Loss=0.00125 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.650 | L2-Norm(final)=7.993 | 6413.5 samples/s | 100.2 steps/s
[Step=28250 Epoch=269.8] | Loss=0.00102 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.653 | L2-Norm(final)=7.999 | 1780.5 samples/s | 27.8 steps/s
[Step=28300 Epoch=270.2] | Loss=0.00086 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=8.005 | 6009.5 samples/s | 93.9 steps/s
[Step=28350 Epoch=270.7] | Loss=0.00075 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.652 | L2-Norm(final)=8.010 | 1786.4 samples/s | 27.9 steps/s
[Step=28400 Epoch=271.2] | Loss=0.00066 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.650 | L2-Norm(final)=8.015 | 5620.3 samples/s | 87.8 steps/s
[Step=28450 Epoch=271.7] | Loss=0.00060 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.647 | L2-Norm(final)=8.020 | 1829.3 samples/s | 28.6 steps/s
[Step=28500 Epoch=272.2] | Loss=0.00054 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.643 | L2-Norm(final)=8.024 | 5321.4 samples/s | 83.1 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=272.2] | Loss=0.00003 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.605 | L2-Norm(final)=8.066 | 3652.4 samples/s | 57.1 steps/s
[Step=28550 Epoch=272.6] | Loss=0.00005 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.595 | L2-Norm(final)=8.070 | 4238.0 samples/s | 66.2 steps/s
[Step=28600 Epoch=273.1] | Loss=0.00004 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.582 | L2-Norm(final)=8.072 | 5940.1 samples/s | 92.8 steps/s
[Step=28650 Epoch=273.6] | Loss=0.00003 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.568 | L2-Norm(final)=8.074 | 1710.8 samples/s | 26.7 steps/s
[Step=28700 Epoch=274.1] | Loss=0.00002 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.553 | L2-Norm(final)=8.075 | 5732.1 samples/s | 89.6 steps/s
[Step=28750 Epoch=274.5] | Loss=0.00002 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.538 | L2-Norm(final)=8.076 | 1737.9 samples/s | 27.2 steps/s
[Step=28800 Epoch=275.0] | Loss=0.00002 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.522 | L2-Norm(final)=8.076 | 5204.8 samples/s | 81.3 steps/s
[Step=28850 Epoch=275.5] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.507 | L2-Norm(final)=8.077 | 1761.9 samples/s | 27.5 steps/s
[Step=28900 Epoch=276.0] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=8.077 | 5060.7 samples/s | 79.1 steps/s
[Step=28950 Epoch=276.5] | Loss=0.00001 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.476 | L2-Norm(final)=8.078 | 1792.2 samples/s | 28.0 steps/s
[Step=29000 Epoch=276.9] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.460 | L2-Norm(final)=8.078 | 4669.0 samples/s | 73.0 steps/s
[Step=29050 Epoch=277.4] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.444 | L2-Norm(final)=8.079 | 1820.4 samples/s | 28.4 steps/s
[Step=29100 Epoch=277.9] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.427 | L2-Norm(final)=8.079 | 4480.3 samples/s | 70.0 steps/s
[Step=29150 Epoch=278.4] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.411 | L2-Norm(final)=8.079 | 1884.3 samples/s | 29.4 steps/s
[Step=29200 Epoch=278.8] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.395 | L2-Norm(final)=8.080 | 4438.2 samples/s | 69.3 steps/s
[Step=29250 Epoch=279.3] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.378 | L2-Norm(final)=8.080 | 1887.2 samples/s | 29.5 steps/s
[Step=29300 Epoch=279.8] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.361 | L2-Norm(final)=8.081 | 4478.1 samples/s | 70.0 steps/s
[Step=29350 Epoch=280.3] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.345 | L2-Norm(final)=8.081 | 1899.1 samples/s | 29.7 steps/s
[Step=29400 Epoch=280.8] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.328 | L2-Norm(final)=8.081 | 4465.7 samples/s | 69.8 steps/s
[Step=29450 Epoch=281.2] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.311 | L2-Norm(final)=8.082 | 1868.5 samples/s | 29.2 steps/s
[Step=29500 Epoch=281.7] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.293 | L2-Norm(final)=8.082 | 4377.3 samples/s | 68.4 steps/s
[Step=29550 Epoch=282.2] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.276 | L2-Norm(final)=8.082 | 6466.8 samples/s | 101.0 steps/s
[Step=29600 Epoch=282.7] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.258 | L2-Norm(final)=8.082 | 1648.4 samples/s | 25.8 steps/s
[Step=29650 Epoch=283.1] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.241 | L2-Norm(final)=8.083 | 5554.7 samples/s | 86.8 steps/s
[Step=29700 Epoch=283.6] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.223 | L2-Norm(final)=8.083 | 1688.3 samples/s | 26.4 steps/s
[Step=29750 Epoch=284.1] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.205 | L2-Norm(final)=8.083 | 5690.4 samples/s | 88.9 steps/s
[Step=29800 Epoch=284.6] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.187 | L2-Norm(final)=8.084 | 1700.5 samples/s | 26.6 steps/s
[Step=29850 Epoch=285.0] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.169 | L2-Norm(final)=8.084 | 5360.7 samples/s | 83.8 steps/s
[Step=29900 Epoch=285.5] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.150 | L2-Norm(final)=8.084 | 1201.4 samples/s | 18.8 steps/s
[Step=29950 Epoch=286.0] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.132 | L2-Norm(final)=8.085 | 5041.3 samples/s | 78.8 steps/s
[Step=30000 Epoch=286.5] | Loss=0.00000 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.113 | L2-Norm(final)=8.085 | 1805.9 samples/s | 28.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step30000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=18001 Epoch=169.6] | Loss=0.02964 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.503 | L2-Norm(final)=7.749 | 3746.3 samples/s | 58.5 steps/s
[Step=18050 Epoch=170.1] | Loss=0.00286 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.545 | L2-Norm(final)=7.752 | 4553.2 samples/s | 71.1 steps/s
[Step=18100 Epoch=170.6] | Loss=0.00210 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.579 | L2-Norm(final)=7.766 | 6897.1 samples/s | 107.8 steps/s
[Step=18150 Epoch=171.0] | Loss=0.00151 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.604 | L2-Norm(final)=7.780 | 1792.4 samples/s | 28.0 steps/s
[Step=18200 Epoch=171.5] | Loss=0.00117 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.616 | L2-Norm(final)=7.792 | 6089.5 samples/s | 95.1 steps/s
[Step=18250 Epoch=172.0] | Loss=0.00099 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.621 | L2-Norm(final)=7.802 | 1805.3 samples/s | 28.2 steps/s
[Step=18300 Epoch=172.4] | Loss=0.00084 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.624 | L2-Norm(final)=7.810 | 5678.8 samples/s | 88.7 steps/s
[Step=18350 Epoch=172.9] | Loss=0.00074 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.624 | L2-Norm(final)=7.818 | 1916.0 samples/s | 29.9 steps/s
[Step=18400 Epoch=173.4] | Loss=0.00066 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.623 | L2-Norm(final)=7.825 | 5047.5 samples/s | 78.9 steps/s
[Step=18450 Epoch=173.9] | Loss=0.00059 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.621 | L2-Norm(final)=7.831 | 1926.2 samples/s | 30.1 steps/s
[Step=18500 Epoch=174.3] | Loss=0.00054 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.618 | L2-Norm(final)=7.837 | 4948.1 samples/s | 77.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=174.3] | Loss=0.00005 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.585 | L2-Norm(final)=7.896 | 3682.7 samples/s | 57.5 steps/s
[Step=18550 Epoch=174.8] | Loss=0.00004 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.571 | L2-Norm(final)=7.899 | 4141.6 samples/s | 64.7 steps/s
[Step=18600 Epoch=175.3] | Loss=0.00060 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.562 | L2-Norm(final)=7.902 | 6014.1 samples/s | 94.0 steps/s
[Step=18650 Epoch=175.7] | Loss=0.00230 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=7.903 | 1690.9 samples/s | 26.4 steps/s
[Step=18700 Epoch=176.2] | Loss=0.00193 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.646 | L2-Norm(final)=7.901 | 5339.6 samples/s | 83.4 steps/s
[Step=18750 Epoch=176.7] | Loss=0.00156 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.675 | L2-Norm(final)=7.900 | 1792.9 samples/s | 28.0 steps/s
[Step=18800 Epoch=177.1] | Loss=0.00131 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.692 | L2-Norm(final)=7.901 | 4954.1 samples/s | 77.4 steps/s
[Step=18850 Epoch=177.6] | Loss=0.00112 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.702 | L2-Norm(final)=7.901 | 1802.8 samples/s | 28.2 steps/s
[Step=18900 Epoch=178.1] | Loss=0.00098 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.708 | L2-Norm(final)=7.901 | 4282.3 samples/s | 66.9 steps/s
[Step=18950 Epoch=178.6] | Loss=0.00088 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.712 | L2-Norm(final)=7.902 | 1810.1 samples/s | 28.3 steps/s
[Step=19000 Epoch=179.0] | Loss=0.00079 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.713 | L2-Norm(final)=7.902 | 3926.4 samples/s | 61.4 steps/s
[Step=19050 Epoch=179.5] | Loss=0.00072 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.712 | L2-Norm(final)=7.903 | 1790.6 samples/s | 28.0 steps/s
[Step=19100 Epoch=180.0] | Loss=0.00066 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.711 | L2-Norm(final)=7.903 | 4098.7 samples/s | 64.0 steps/s
[Step=19150 Epoch=180.4] | Loss=0.00061 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.709 | L2-Norm(final)=7.904 | 1789.6 samples/s | 28.0 steps/s
[Step=19200 Epoch=180.9] | Loss=0.00057 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.705 | L2-Norm(final)=7.904 | 3946.8 samples/s | 61.7 steps/s
[Step=19250 Epoch=181.4] | Loss=0.00053 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.702 | L2-Norm(final)=7.905 | 1923.8 samples/s | 30.1 steps/s
[Step=19300 Epoch=181.9] | Loss=0.00050 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.698 | L2-Norm(final)=7.905 | 4047.0 samples/s | 63.2 steps/s
[Step=19350 Epoch=182.3] | Loss=0.00047 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.693 | L2-Norm(final)=7.905 | 5853.7 samples/s | 91.5 steps/s
[Step=19400 Epoch=182.8] | Loss=0.00044 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.688 | L2-Norm(final)=7.906 | 1680.7 samples/s | 26.3 steps/s
[Step=19450 Epoch=183.3] | Loss=0.00042 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=7.906 | 5467.0 samples/s | 85.4 steps/s
[Step=19500 Epoch=183.7] | Loss=0.00040 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.677 | L2-Norm(final)=7.907 | 1685.6 samples/s | 26.3 steps/s
[Step=19550 Epoch=184.2] | Loss=0.00038 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.672 | L2-Norm(final)=7.907 | 4895.7 samples/s | 76.5 steps/s
[Step=19600 Epoch=184.7] | Loss=0.00036 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.666 | L2-Norm(final)=7.907 | 1790.8 samples/s | 28.0 steps/s
[Step=19650 Epoch=185.2] | Loss=0.00035 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.659 | L2-Norm(final)=7.908 | 4670.5 samples/s | 73.0 steps/s
[Step=19700 Epoch=185.6] | Loss=0.00033 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.653 | L2-Norm(final)=7.908 | 1867.3 samples/s | 29.2 steps/s
[Step=19750 Epoch=186.1] | Loss=0.00032 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.646 | L2-Norm(final)=7.909 | 4444.7 samples/s | 69.4 steps/s
[Step=19800 Epoch=186.6] | Loss=0.00031 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.640 | L2-Norm(final)=7.909 | 1883.3 samples/s | 29.4 steps/s
[Step=19850 Epoch=187.0] | Loss=0.00030 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.633 | L2-Norm(final)=7.909 | 4395.8 samples/s | 68.7 steps/s
[Step=19900 Epoch=187.5] | Loss=0.00029 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.626 | L2-Norm(final)=7.910 | 1865.5 samples/s | 29.1 steps/s
[Step=19950 Epoch=188.0] | Loss=0.00028 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.619 | L2-Norm(final)=7.910 | 4391.8 samples/s | 68.6 steps/s
[Step=20000 Epoch=188.5] | Loss=0.00027 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.611 | L2-Norm(final)=7.910 | 1914.6 samples/s | 29.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step20000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=24001 Epoch=228.8] | Loss=0.00686 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.503 | L2-Norm(final)=8.499 | 3718.2 samples/s | 58.1 steps/s
[Step=24050 Epoch=229.2] | Loss=0.00361 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.587 | L2-Norm(final)=8.520 | 4475.3 samples/s | 69.9 steps/s
[Step=24100 Epoch=229.7] | Loss=0.00206 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.657 | L2-Norm(final)=8.545 | 6874.2 samples/s | 107.4 steps/s
[Step=24150 Epoch=230.2] | Loss=0.00150 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.687 | L2-Norm(final)=8.562 | 1711.8 samples/s | 26.7 steps/s
[Step=24200 Epoch=230.6] | Loss=0.00115 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.701 | L2-Norm(final)=8.574 | 6425.0 samples/s | 100.4 steps/s
[Step=24250 Epoch=231.1] | Loss=0.00093 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.706 | L2-Norm(final)=8.583 | 1717.0 samples/s | 26.8 steps/s
[Step=24300 Epoch=231.6] | Loss=0.00079 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.708 | L2-Norm(final)=8.591 | 5832.4 samples/s | 91.1 steps/s
[Step=24350 Epoch=232.1] | Loss=0.00069 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.707 | L2-Norm(final)=8.599 | 1756.2 samples/s | 27.4 steps/s
[Step=24400 Epoch=232.6] | Loss=0.00061 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.704 | L2-Norm(final)=8.605 | 5348.1 samples/s | 83.6 steps/s
[Step=24450 Epoch=233.0] | Loss=0.00055 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.700 | L2-Norm(final)=8.611 | 1881.9 samples/s | 29.4 steps/s
[Step=24500 Epoch=233.5] | Loss=0.00050 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.696 | L2-Norm(final)=8.617 | 5290.8 samples/s | 82.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=233.5] | Loss=0.00002 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.647 | L2-Norm(final)=8.671 | 3741.2 samples/s | 58.5 steps/s
[Step=24550 Epoch=234.0] | Loss=0.00004 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=8.674 | 4106.3 samples/s | 64.2 steps/s
[Step=24600 Epoch=234.5] | Loss=0.00004 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.594 | L2-Norm(final)=8.677 | 6205.7 samples/s | 97.0 steps/s
[Step=24650 Epoch=234.9] | Loss=0.00186 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=8.675 | 1679.0 samples/s | 26.2 steps/s
[Step=24700 Epoch=235.4] | Loss=0.00158 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.628 | L2-Norm(final)=8.671 | 5581.5 samples/s | 87.2 steps/s
[Step=24750 Epoch=235.9] | Loss=0.00127 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.646 | L2-Norm(final)=8.670 | 1750.0 samples/s | 27.3 steps/s
[Step=24800 Epoch=236.4] | Loss=0.00106 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.656 | L2-Norm(final)=8.669 | 5178.4 samples/s | 80.9 steps/s
[Step=24850 Epoch=236.8] | Loss=0.00091 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.661 | L2-Norm(final)=8.669 | 1763.7 samples/s | 27.6 steps/s
[Step=24900 Epoch=237.3] | Loss=0.00080 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.663 | L2-Norm(final)=8.669 | 4973.9 samples/s | 77.7 steps/s
[Step=24950 Epoch=237.8] | Loss=0.00071 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.663 | L2-Norm(final)=8.669 | 1794.2 samples/s | 28.0 steps/s
[Step=25000 Epoch=238.3] | Loss=0.00064 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.662 | L2-Norm(final)=8.669 | 4690.3 samples/s | 73.3 steps/s
[Step=25050 Epoch=238.7] | Loss=0.00058 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.659 | L2-Norm(final)=8.669 | 1834.8 samples/s | 28.7 steps/s
[Step=25100 Epoch=239.2] | Loss=0.00053 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.656 | L2-Norm(final)=8.669 | 4295.4 samples/s | 67.1 steps/s
[Step=25150 Epoch=239.7] | Loss=0.00049 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.652 | L2-Norm(final)=8.669 | 1808.6 samples/s | 28.3 steps/s
[Step=25200 Epoch=240.2] | Loss=0.00046 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.648 | L2-Norm(final)=8.670 | 4375.7 samples/s | 68.4 steps/s
[Step=25250 Epoch=240.7] | Loss=0.00043 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.643 | L2-Norm(final)=8.670 | 1863.5 samples/s | 29.1 steps/s
[Step=25300 Epoch=241.1] | Loss=0.00040 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.638 | L2-Norm(final)=8.670 | 4375.7 samples/s | 68.4 steps/s
[Step=25350 Epoch=241.6] | Loss=0.00038 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.632 | L2-Norm(final)=8.670 | 1885.1 samples/s | 29.5 steps/s
[Step=25400 Epoch=242.1] | Loss=0.00036 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.626 | L2-Norm(final)=8.670 | 4362.6 samples/s | 68.2 steps/s
[Step=25450 Epoch=242.6] | Loss=0.00034 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=8.671 | 1881.6 samples/s | 29.4 steps/s
[Step=25500 Epoch=243.0] | Loss=0.00032 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.614 | L2-Norm(final)=8.671 | 4108.9 samples/s | 64.2 steps/s
[Step=25550 Epoch=243.5] | Loss=0.00031 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.608 | L2-Norm(final)=8.671 | 6143.6 samples/s | 96.0 steps/s
[Step=25600 Epoch=244.0] | Loss=0.00029 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=8.671 | 1658.3 samples/s | 25.9 steps/s
[Step=25650 Epoch=244.5] | Loss=0.00028 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.594 | L2-Norm(final)=8.672 | 5907.9 samples/s | 92.3 steps/s
[Step=25700 Epoch=244.9] | Loss=0.00027 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.587 | L2-Norm(final)=8.672 | 1677.9 samples/s | 26.2 steps/s
[Step=25750 Epoch=245.4] | Loss=0.00026 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.580 | L2-Norm(final)=8.672 | 5721.4 samples/s | 89.4 steps/s
[Step=25800 Epoch=245.9] | Loss=0.00025 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.573 | L2-Norm(final)=8.672 | 1732.7 samples/s | 27.1 steps/s
[Step=25850 Epoch=246.4] | Loss=0.00024 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.566 | L2-Norm(final)=8.673 | 5307.0 samples/s | 82.9 steps/s
[Step=25900 Epoch=246.9] | Loss=0.00023 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.558 | L2-Norm(final)=8.673 | 1774.6 samples/s | 27.7 steps/s
[Step=25950 Epoch=247.3] | Loss=0.00022 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.551 | L2-Norm(final)=8.673 | 5006.5 samples/s | 78.2 steps/s
[Step=26000 Epoch=247.8] | Loss=0.00022 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.543 | L2-Norm(final)=8.673 | 1800.2 samples/s | 28.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step26000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09453 | acc=0.9595 | tpr=0.9676 | fpr=0.0580 | 4109.6 samples/s | 16.1 steps/s
Avg test loss: 0.09893, Avg test acc: 0.95813, Avg tpr: 0.96654, Avg fpr: 0.06038, total FA: 471

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09252 | acc=0.9594 | tpr=0.9742 | fpr=0.0728 | 4033.7 samples/s | 15.8 steps/s
Avg test loss: 0.09752, Avg test acc: 0.95909, Avg tpr: 0.97377, Avg fpr: 0.07320, total FA: 571

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.11099 | acc=0.9528 | tpr=0.9596 | fpr=0.0619 | 4118.2 samples/s | 16.1 steps/s
Avg test loss: 0.11841, Avg test acc: 0.95104, Avg tpr: 0.95693, Avg fpr: 0.06192, total FA: 483

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08842 | acc=0.9590 | tpr=0.9684 | fpr=0.0614 | 4075.1 samples/s | 15.9 steps/s
Avg test loss: 0.09359, Avg test acc: 0.95877, Avg tpr: 0.96992, Avg fpr: 0.06576, total FA: 513

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10177 | acc=0.9606 | tpr=0.9742 | fpr=0.0689 | 4070.8 samples/s | 15.9 steps/s
Avg test loss: 0.10719, Avg test acc: 0.95905, Avg tpr: 0.97266, Avg fpr: 0.07089, total FA: 553

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.21628 | acc=0.2839 | tpr=0.0037 | fpr=0.1075 | 4131.5 samples/s | 16.1 steps/s
Avg test loss: 5.23325, Avg test acc: 0.28139, Avg tpr: 0.00455, Avg fpr: 0.10973, total FA: 856

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.64981 | acc=0.3106 | tpr=0.0074 | fpr=0.0310 | 3970.9 samples/s | 15.5 steps/s
Avg test loss: 4.66086, Avg test acc: 0.30856, Avg tpr: 0.00874, Avg fpr: 0.03205, total FA: 250

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.12189 | acc=0.2948 | tpr=0.0076 | fpr=0.0815 | 4108.8 samples/s | 16.0 steps/s
Avg test loss: 5.13500, Avg test acc: 0.29353, Avg tpr: 0.00892, Avg fpr: 0.08050, total FA: 628

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.78471 | acc=0.2955 | tpr=0.0091 | fpr=0.0825 | 4143.2 samples/s | 16.2 steps/s
Avg test loss: 4.79149, Avg test acc: 0.29457, Avg tpr: 0.01107, Avg fpr: 0.08191, total FA: 639

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.32609 | acc=0.3113 | tpr=0.0011 | fpr=0.0151 | 4141.6 samples/s | 16.2 steps/s
Avg test loss: 5.33004, Avg test acc: 0.30880, Avg tpr: 0.00187, Avg fpr: 0.01615, total FA: 126

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.20033 | acc=0.1381 | tpr=0.7699 | fpr=0.8732 | 4139.3 samples/s | 16.2 steps/s
[Step= 100] | Loss=5.14577 | acc=0.1401 | tpr=0.7463 | fpr=0.8712 | 8305.8 samples/s | 32.4 steps/s
[Step= 150] | Loss=5.14693 | acc=0.1385 | tpr=0.7550 | fpr=0.8729 | 7766.9 samples/s | 30.3 steps/s
[Step= 200] | Loss=5.14395 | acc=0.1381 | tpr=0.7486 | fpr=0.8730 | 7784.6 samples/s | 30.4 steps/s
[Step= 250] | Loss=5.14602 | acc=0.1389 | tpr=0.7555 | fpr=0.8724 | 7873.4 samples/s | 30.8 steps/s
[Step= 300] | Loss=5.14243 | acc=0.1390 | tpr=0.7578 | fpr=0.8723 | 8189.5 samples/s | 32.0 steps/s
[Step= 350] | Loss=5.13891 | acc=0.1386 | tpr=0.7570 | fpr=0.8726 | 8288.0 samples/s | 32.4 steps/s
[Step= 400] | Loss=5.14152 | acc=0.1388 | tpr=0.7511 | fpr=0.8724 | 8198.1 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.14341 | acc=0.1385 | tpr=0.7468 | fpr=0.8725 | 7766.4 samples/s | 30.3 steps/s
[Step= 500] | Loss=5.14551 | acc=0.1382 | tpr=0.7449 | fpr=0.8728 | 8050.8 samples/s | 31.4 steps/s
[Step= 550] | Loss=5.14502 | acc=0.1378 | tpr=0.7481 | fpr=0.8733 | 14115.3 samples/s | 55.1 steps/s
Avg test loss: 5.14677, Avg test acc: 0.13778, Avg tpr: 0.74802, Avg fpr: 0.87331, total FA: 121258

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.85811 | acc=0.1286 | tpr=0.7920 | fpr=0.8833 | 4079.3 samples/s | 15.9 steps/s
[Step= 100] | Loss=4.80342 | acc=0.1306 | tpr=0.7612 | fpr=0.8811 | 8145.8 samples/s | 31.8 steps/s
[Step= 150] | Loss=4.81098 | acc=0.1284 | tpr=0.7507 | fpr=0.8831 | 8070.7 samples/s | 31.5 steps/s
[Step= 200] | Loss=4.80811 | acc=0.1280 | tpr=0.7366 | fpr=0.8831 | 7510.2 samples/s | 29.3 steps/s
[Step= 250] | Loss=4.80801 | acc=0.1280 | tpr=0.7336 | fpr=0.8830 | 8390.3 samples/s | 32.8 steps/s
[Step= 300] | Loss=4.80763 | acc=0.1274 | tpr=0.7360 | fpr=0.8836 | 7931.6 samples/s | 31.0 steps/s
[Step= 350] | Loss=4.80297 | acc=0.1269 | tpr=0.7314 | fpr=0.8841 | 8093.7 samples/s | 31.6 steps/s
[Step= 400] | Loss=4.80360 | acc=0.1272 | tpr=0.7314 | fpr=0.8838 | 8297.4 samples/s | 32.4 steps/s
[Step= 450] | Loss=4.80847 | acc=0.1272 | tpr=0.7259 | fpr=0.8836 | 7620.5 samples/s | 29.8 steps/s
[Step= 500] | Loss=4.81384 | acc=0.1268 | tpr=0.7216 | fpr=0.8839 | 7887.4 samples/s | 30.8 steps/s
[Step= 550] | Loss=4.81394 | acc=0.1268 | tpr=0.7226 | fpr=0.8840 | 13143.5 samples/s | 51.3 steps/s
Avg test loss: 4.81498, Avg test acc: 0.12675, Avg tpr: 0.72266, Avg fpr: 0.88408, total FA: 122753

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.14776 | acc=0.1248 | tpr=0.6460 | fpr=0.8846 | 4044.4 samples/s | 15.8 steps/s
[Step= 100] | Loss=6.10154 | acc=0.1262 | tpr=0.6034 | fpr=0.8827 | 7748.1 samples/s | 30.3 steps/s
[Step= 150] | Loss=6.11920 | acc=0.1242 | tpr=0.6153 | fpr=0.8848 | 8271.8 samples/s | 32.3 steps/s
[Step= 200] | Loss=6.11919 | acc=0.1237 | tpr=0.6208 | fpr=0.8854 | 7833.1 samples/s | 30.6 steps/s
[Step= 250] | Loss=6.12245 | acc=0.1233 | tpr=0.6157 | fpr=0.8856 | 8197.9 samples/s | 32.0 steps/s
[Step= 300] | Loss=6.12204 | acc=0.1234 | tpr=0.6145 | fpr=0.8856 | 7380.0 samples/s | 28.8 steps/s
[Step= 350] | Loss=6.11866 | acc=0.1231 | tpr=0.6099 | fpr=0.8858 | 8702.2 samples/s | 34.0 steps/s
[Step= 400] | Loss=6.12116 | acc=0.1233 | tpr=0.6018 | fpr=0.8854 | 7649.9 samples/s | 29.9 steps/s
[Step= 450] | Loss=6.12255 | acc=0.1229 | tpr=0.5974 | fpr=0.8857 | 8104.4 samples/s | 31.7 steps/s
[Step= 500] | Loss=6.12258 | acc=0.1229 | tpr=0.5916 | fpr=0.8856 | 7916.2 samples/s | 30.9 steps/s
[Step= 550] | Loss=6.12254 | acc=0.1227 | tpr=0.5965 | fpr=0.8859 | 13743.7 samples/s | 53.7 steps/s
Avg test loss: 6.12411, Avg test acc: 0.12263, Avg tpr: 0.59628, Avg fpr: 0.88598, total FA: 123017

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.80496 | acc=0.1308 | tpr=0.7301 | fpr=0.8800 | 4003.2 samples/s | 15.6 steps/s
[Step= 100] | Loss=4.75565 | acc=0.1327 | tpr=0.6759 | fpr=0.8774 | 8312.9 samples/s | 32.5 steps/s
[Step= 150] | Loss=4.75866 | acc=0.1315 | tpr=0.6888 | fpr=0.8788 | 8181.9 samples/s | 32.0 steps/s
[Step= 200] | Loss=4.75165 | acc=0.1312 | tpr=0.6907 | fpr=0.8790 | 7637.9 samples/s | 29.8 steps/s
[Step= 250] | Loss=4.75190 | acc=0.1316 | tpr=0.7004 | fpr=0.8787 | 7880.5 samples/s | 30.8 steps/s
[Step= 300] | Loss=4.74971 | acc=0.1313 | tpr=0.7018 | fpr=0.8791 | 7863.2 samples/s | 30.7 steps/s
[Step= 350] | Loss=4.74514 | acc=0.1312 | tpr=0.6951 | fpr=0.8790 | 8023.4 samples/s | 31.3 steps/s
[Step= 400] | Loss=4.74788 | acc=0.1312 | tpr=0.6915 | fpr=0.8790 | 7928.8 samples/s | 31.0 steps/s
[Step= 450] | Loss=4.75264 | acc=0.1308 | tpr=0.6855 | fpr=0.8793 | 8068.0 samples/s | 31.5 steps/s
[Step= 500] | Loss=4.75700 | acc=0.1304 | tpr=0.6872 | fpr=0.8796 | 7918.6 samples/s | 30.9 steps/s
[Step= 550] | Loss=4.75626 | acc=0.1301 | tpr=0.6860 | fpr=0.8800 | 14163.8 samples/s | 55.3 steps/s
Avg test loss: 4.75762, Avg test acc: 0.13000, Avg tpr: 0.68582, Avg fpr: 0.88010, total FA: 122200

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.68582 | acc=0.1280 | tpr=0.7655 | fpr=0.8835 | 4106.2 samples/s | 16.0 steps/s
[Step= 100] | Loss=5.63505 | acc=0.1285 | tpr=0.7335 | fpr=0.8828 | 7973.5 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.64204 | acc=0.1258 | tpr=0.7349 | fpr=0.8854 | 8138.1 samples/s | 31.8 steps/s
[Step= 200] | Loss=5.64104 | acc=0.1252 | tpr=0.7301 | fpr=0.8859 | 7912.1 samples/s | 30.9 steps/s
[Step= 250] | Loss=5.64290 | acc=0.1256 | tpr=0.7319 | fpr=0.8855 | 7969.9 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.63784 | acc=0.1253 | tpr=0.7338 | fpr=0.8858 | 8079.9 samples/s | 31.6 steps/s
[Step= 350] | Loss=5.63532 | acc=0.1248 | tpr=0.7364 | fpr=0.8863 | 7708.3 samples/s | 30.1 steps/s
[Step= 400] | Loss=5.63682 | acc=0.1249 | tpr=0.7325 | fpr=0.8862 | 7982.9 samples/s | 31.2 steps/s
[Step= 450] | Loss=5.63905 | acc=0.1245 | tpr=0.7288 | fpr=0.8864 | 8009.9 samples/s | 31.3 steps/s
[Step= 500] | Loss=5.64042 | acc=0.1243 | tpr=0.7264 | fpr=0.8866 | 7862.5 samples/s | 30.7 steps/s
[Step= 550] | Loss=5.64138 | acc=0.1240 | tpr=0.7270 | fpr=0.8869 | 14371.8 samples/s | 56.1 steps/s
Avg test loss: 5.64332, Avg test acc: 0.12399, Avg tpr: 0.72662, Avg fpr: 0.88696, total FA: 123153

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10814 | acc=0.9805 | tpr=0.9159 | fpr=0.0183 | 4060.7 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.11173 | acc=0.9804 | tpr=0.9403 | fpr=0.0189 | 8181.2 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.11610 | acc=0.9792 | tpr=0.9424 | fpr=0.0201 | 7934.4 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.11801 | acc=0.9791 | tpr=0.9421 | fpr=0.0202 | 8197.7 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.11733 | acc=0.9790 | tpr=0.9380 | fpr=0.0203 | 8044.4 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.11959 | acc=0.9787 | tpr=0.9353 | fpr=0.0205 | 7913.7 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.11941 | acc=0.9787 | tpr=0.9355 | fpr=0.0205 | 7864.9 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.12092 | acc=0.9784 | tpr=0.9311 | fpr=0.0207 | 7444.1 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.12375 | acc=0.9781 | tpr=0.9318 | fpr=0.0210 | 7796.5 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.12328 | acc=0.9782 | tpr=0.9335 | fpr=0.0210 | 7950.3 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.12212 | acc=0.9784 | tpr=0.9339 | fpr=0.0208 | 14734.5 samples/s | 57.6 steps/s
Avg test loss: 0.12193, Avg test acc: 0.97843, Avg tpr: 0.93423, Avg fpr: 0.02077, total FA: 2884

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11473 | acc=0.9808 | tpr=0.9071 | fpr=0.0179 | 3994.4 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.11839 | acc=0.9803 | tpr=0.9147 | fpr=0.0185 | 7926.3 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.12319 | acc=0.9794 | tpr=0.9150 | fpr=0.0194 | 7937.9 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.12486 | acc=0.9795 | tpr=0.9202 | fpr=0.0194 | 7877.6 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.12344 | acc=0.9796 | tpr=0.9179 | fpr=0.0193 | 8491.1 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.12562 | acc=0.9790 | tpr=0.9156 | fpr=0.0198 | 7982.1 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.12561 | acc=0.9790 | tpr=0.9198 | fpr=0.0199 | 7993.5 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.12712 | acc=0.9788 | tpr=0.9152 | fpr=0.0201 | 7746.2 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.13028 | acc=0.9785 | tpr=0.9138 | fpr=0.0203 | 7576.2 samples/s | 29.6 steps/s
[Step= 500] | Loss=0.12966 | acc=0.9786 | tpr=0.9176 | fpr=0.0203 | 7727.6 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.12858 | acc=0.9787 | tpr=0.9180 | fpr=0.0202 | 14754.5 samples/s | 57.6 steps/s
Avg test loss: 0.12839, Avg test acc: 0.97873, Avg tpr: 0.91719, Avg fpr: 0.02015, total FA: 2798

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11349 | acc=0.9790 | tpr=0.9336 | fpr=0.0202 | 4052.2 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.11761 | acc=0.9787 | tpr=0.9531 | fpr=0.0209 | 7581.2 samples/s | 29.6 steps/s
[Step= 150] | Loss=0.12190 | acc=0.9780 | tpr=0.9524 | fpr=0.0216 | 8024.6 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.12437 | acc=0.9778 | tpr=0.9552 | fpr=0.0218 | 7975.4 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.12331 | acc=0.9778 | tpr=0.9537 | fpr=0.0218 | 8337.3 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.12549 | acc=0.9774 | tpr=0.9542 | fpr=0.0222 | 7934.5 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.12543 | acc=0.9773 | tpr=0.9549 | fpr=0.0223 | 7870.1 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.12688 | acc=0.9771 | tpr=0.9519 | fpr=0.0224 | 8240.8 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.12985 | acc=0.9768 | tpr=0.9513 | fpr=0.0227 | 8026.5 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.12944 | acc=0.9769 | tpr=0.9529 | fpr=0.0227 | 7860.8 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.12812 | acc=0.9771 | tpr=0.9534 | fpr=0.0225 | 14858.7 samples/s | 58.0 steps/s
Avg test loss: 0.12796, Avg test acc: 0.97707, Avg tpr: 0.95325, Avg fpr: 0.02250, total FA: 3124

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09986 | acc=0.9820 | tpr=0.9071 | fpr=0.0166 | 4053.1 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.10418 | acc=0.9817 | tpr=0.9296 | fpr=0.0173 | 8144.1 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.10879 | acc=0.9810 | tpr=0.9251 | fpr=0.0179 | 7686.8 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.11047 | acc=0.9809 | tpr=0.9301 | fpr=0.0182 | 8123.7 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.10971 | acc=0.9805 | tpr=0.9266 | fpr=0.0185 | 7990.7 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.11148 | acc=0.9802 | tpr=0.9258 | fpr=0.0189 | 7911.8 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.11139 | acc=0.9800 | tpr=0.9286 | fpr=0.0190 | 8283.3 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.11233 | acc=0.9800 | tpr=0.9245 | fpr=0.0190 | 8154.7 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.11468 | acc=0.9797 | tpr=0.9231 | fpr=0.0193 | 8011.1 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.11436 | acc=0.9797 | tpr=0.9256 | fpr=0.0193 | 8103.6 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.11340 | acc=0.9799 | tpr=0.9252 | fpr=0.0192 | 14617.4 samples/s | 57.1 steps/s
Avg test loss: 0.11324, Avg test acc: 0.97985, Avg tpr: 0.92472, Avg fpr: 0.01915, total FA: 2659

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.11845 | acc=0.9823 | tpr=0.8938 | fpr=0.0161 | 4063.7 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.12293 | acc=0.9812 | tpr=0.9254 | fpr=0.0177 | 8072.5 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.12672 | acc=0.9802 | tpr=0.9308 | fpr=0.0189 | 7971.3 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.13023 | acc=0.9799 | tpr=0.9344 | fpr=0.0193 | 8052.1 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.12873 | acc=0.9797 | tpr=0.9310 | fpr=0.0194 | 7925.4 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.13179 | acc=0.9792 | tpr=0.9265 | fpr=0.0198 | 8228.6 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.13159 | acc=0.9791 | tpr=0.9261 | fpr=0.0199 | 7939.8 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.13328 | acc=0.9789 | tpr=0.9190 | fpr=0.0200 | 8104.8 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.13648 | acc=0.9786 | tpr=0.9177 | fpr=0.0203 | 8272.1 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.13620 | acc=0.9786 | tpr=0.9185 | fpr=0.0203 | 7691.7 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.13547 | acc=0.9787 | tpr=0.9160 | fpr=0.0202 | 14985.3 samples/s | 58.5 steps/s
Avg test loss: 0.13534, Avg test acc: 0.97869, Avg tpr: 0.91561, Avg fpr: 0.02016, total FA: 2799

server round 25/50

clients selected: [0 2 4 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=22001 Epoch=107.3] | Loss=0.03263 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.514 | L2-Norm(final)=9.360 | 3832.7 samples/s | 59.9 steps/s
[Step=22050 Epoch=107.5] | Loss=0.02491 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.530 | L2-Norm(final)=9.350 | 4746.4 samples/s | 74.2 steps/s
[Step=22100 Epoch=107.8] | Loss=0.02329 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.554 | L2-Norm(final)=9.350 | 5213.0 samples/s | 81.5 steps/s
[Step=22150 Epoch=108.0] | Loss=0.02189 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.578 | L2-Norm(final)=9.355 | 5200.7 samples/s | 81.3 steps/s
[Step=22200 Epoch=108.3] | Loss=0.02217 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.602 | L2-Norm(final)=9.361 | 7045.5 samples/s | 110.1 steps/s
[Step=22250 Epoch=108.5] | Loss=0.02093 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.625 | L2-Norm(final)=9.369 | 1806.4 samples/s | 28.2 steps/s
[Step=22300 Epoch=108.7] | Loss=0.01984 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.647 | L2-Norm(final)=9.378 | 5382.6 samples/s | 84.1 steps/s
[Step=22350 Epoch=109.0] | Loss=0.01866 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.667 | L2-Norm(final)=9.390 | 5236.8 samples/s | 81.8 steps/s
[Step=22400 Epoch=109.2] | Loss=0.01836 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.687 | L2-Norm(final)=9.403 | 6733.5 samples/s | 105.2 steps/s
[Step=22450 Epoch=109.5] | Loss=0.01785 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.707 | L2-Norm(final)=9.415 | 1861.1 samples/s | 29.1 steps/s
[Step=22500 Epoch=109.7] | Loss=0.01720 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.727 | L2-Norm(final)=9.429 | 5200.8 samples/s | 81.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=109.7] | Loss=0.00084 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.920 | L2-Norm(final)=9.563 | 3895.2 samples/s | 60.9 steps/s
[Step=22550 Epoch=110.0] | Loss=0.02208 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.940 | L2-Norm(final)=9.573 | 4620.7 samples/s | 72.2 steps/s
[Step=22600 Epoch=110.2] | Loss=0.02136 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.968 | L2-Norm(final)=9.576 | 4662.3 samples/s | 72.8 steps/s
[Step=22650 Epoch=110.4] | Loss=0.02243 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.991 | L2-Norm(final)=9.581 | 4570.8 samples/s | 71.4 steps/s
[Step=22700 Epoch=110.7] | Loss=0.02155 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.013 | L2-Norm(final)=9.585 | 6187.9 samples/s | 96.7 steps/s
[Step=22750 Epoch=110.9] | Loss=0.01919 | Reg=0.00145 | acc=0.9688 | L2-Norm=12.032 | L2-Norm(final)=9.590 | 1736.4 samples/s | 27.1 steps/s
[Step=22800 Epoch=111.2] | Loss=0.01792 | Reg=0.00145 | acc=0.9688 | L2-Norm=12.048 | L2-Norm(final)=9.596 | 4640.6 samples/s | 72.5 steps/s
[Step=22850 Epoch=111.4] | Loss=0.01666 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.062 | L2-Norm(final)=9.602 | 4627.4 samples/s | 72.3 steps/s
[Step=22900 Epoch=111.7] | Loss=0.01584 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.075 | L2-Norm(final)=9.607 | 5630.7 samples/s | 88.0 steps/s
[Step=22950 Epoch=111.9] | Loss=0.01471 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.086 | L2-Norm(final)=9.612 | 1749.3 samples/s | 27.3 steps/s
[Step=23000 Epoch=112.2] | Loss=0.01383 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.096 | L2-Norm(final)=9.618 | 4604.7 samples/s | 71.9 steps/s
[Step=23050 Epoch=112.4] | Loss=0.01337 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.104 | L2-Norm(final)=9.622 | 4584.3 samples/s | 71.6 steps/s
[Step=23100 Epoch=112.6] | Loss=0.01277 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.112 | L2-Norm(final)=9.626 | 5261.3 samples/s | 82.2 steps/s
[Step=23150 Epoch=112.9] | Loss=0.01221 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.120 | L2-Norm(final)=9.630 | 1827.9 samples/s | 28.6 steps/s
[Step=23200 Epoch=113.1] | Loss=0.01171 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.126 | L2-Norm(final)=9.634 | 4545.1 samples/s | 71.0 steps/s
[Step=23250 Epoch=113.4] | Loss=0.01132 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.131 | L2-Norm(final)=9.638 | 4651.0 samples/s | 72.7 steps/s
[Step=23300 Epoch=113.6] | Loss=0.01096 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.137 | L2-Norm(final)=9.641 | 4953.9 samples/s | 77.4 steps/s
[Step=23350 Epoch=113.9] | Loss=0.01064 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.142 | L2-Norm(final)=9.645 | 1881.0 samples/s | 29.4 steps/s
[Step=23400 Epoch=114.1] | Loss=0.01022 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.147 | L2-Norm(final)=9.648 | 4588.4 samples/s | 71.7 steps/s
[Step=23450 Epoch=114.3] | Loss=0.00991 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.151 | L2-Norm(final)=9.652 | 4438.3 samples/s | 69.3 steps/s
[Step=23500 Epoch=114.6] | Loss=0.00958 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.155 | L2-Norm(final)=9.655 | 4606.7 samples/s | 72.0 steps/s
[Step=23550 Epoch=114.8] | Loss=0.00942 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.159 | L2-Norm(final)=9.658 | 1915.5 samples/s | 29.9 steps/s
[Step=23600 Epoch=115.1] | Loss=0.00916 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.163 | L2-Norm(final)=9.661 | 4618.6 samples/s | 72.2 steps/s
[Step=23650 Epoch=115.3] | Loss=0.00886 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.167 | L2-Norm(final)=9.664 | 4561.2 samples/s | 71.3 steps/s
[Step=23700 Epoch=115.6] | Loss=0.00866 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.170 | L2-Norm(final)=9.667 | 4590.3 samples/s | 71.7 steps/s
[Step=23750 Epoch=115.8] | Loss=0.00842 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.173 | L2-Norm(final)=9.670 | 1936.8 samples/s | 30.3 steps/s
[Step=23800 Epoch=116.1] | Loss=0.00825 | Reg=0.00148 | acc=0.9844 | L2-Norm=12.176 | L2-Norm(final)=9.674 | 4706.3 samples/s | 73.5 steps/s
[Step=23850 Epoch=116.3] | Loss=0.00807 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.179 | L2-Norm(final)=9.676 | 4623.6 samples/s | 72.2 steps/s
[Step=23900 Epoch=116.5] | Loss=0.00791 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.181 | L2-Norm(final)=9.679 | 4700.3 samples/s | 73.4 steps/s
[Step=23950 Epoch=116.8] | Loss=0.00781 | Reg=0.00148 | acc=1.0000 | L2-Norm=12.184 | L2-Norm(final)=9.682 | 1911.1 samples/s | 29.9 steps/s
[Step=24000 Epoch=117.0] | Loss=0.00772 | Reg=0.00149 | acc=1.0000 | L2-Norm=12.186 | L2-Norm(final)=9.684 | 4416.3 samples/s | 69.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step24000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=26001 Epoch=126.7] | Loss=0.00638 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.514 | L2-Norm(final)=11.336 | 3479.6 samples/s | 54.4 steps/s
[Step=26050 Epoch=126.9] | Loss=0.01897 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.538 | L2-Norm(final)=11.327 | 4863.4 samples/s | 76.0 steps/s
[Step=26100 Epoch=127.2] | Loss=0.01923 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.565 | L2-Norm(final)=11.328 | 5364.6 samples/s | 83.8 steps/s
[Step=26150 Epoch=127.4] | Loss=0.02038 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.589 | L2-Norm(final)=11.332 | 5187.0 samples/s | 81.0 steps/s
[Step=26200 Epoch=127.7] | Loss=0.01919 | Reg=0.00135 | acc=0.9531 | L2-Norm=11.610 | L2-Norm(final)=11.338 | 7231.2 samples/s | 113.0 steps/s
[Step=26250 Epoch=127.9] | Loss=0.01828 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.630 | L2-Norm(final)=11.344 | 1788.7 samples/s | 27.9 steps/s
[Step=26300 Epoch=128.1] | Loss=0.01723 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.648 | L2-Norm(final)=11.353 | 5233.8 samples/s | 81.8 steps/s
[Step=26350 Epoch=128.4] | Loss=0.01644 | Reg=0.00136 | acc=0.9688 | L2-Norm=11.665 | L2-Norm(final)=11.363 | 5182.2 samples/s | 81.0 steps/s
[Step=26400 Epoch=128.6] | Loss=0.01607 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.681 | L2-Norm(final)=11.374 | 6480.9 samples/s | 101.3 steps/s
[Step=26450 Epoch=128.9] | Loss=0.01542 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.696 | L2-Norm(final)=11.385 | 1820.9 samples/s | 28.5 steps/s
[Step=26500 Epoch=129.1] | Loss=0.01475 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.712 | L2-Norm(final)=11.396 | 5222.4 samples/s | 81.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=129.1] | Loss=0.00193 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.862 | L2-Norm(final)=11.514 | 3672.1 samples/s | 57.4 steps/s
[Step=26550 Epoch=129.4] | Loss=0.01396 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.880 | L2-Norm(final)=11.527 | 4720.8 samples/s | 73.8 steps/s
[Step=26600 Epoch=129.6] | Loss=0.01583 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.897 | L2-Norm(final)=11.531 | 4473.0 samples/s | 69.9 steps/s
[Step=26650 Epoch=129.9] | Loss=0.01422 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.916 | L2-Norm(final)=11.538 | 4638.6 samples/s | 72.5 steps/s
[Step=26700 Epoch=130.1] | Loss=0.01414 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.932 | L2-Norm(final)=11.544 | 6045.8 samples/s | 94.5 steps/s
[Step=26750 Epoch=130.3] | Loss=0.01370 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.947 | L2-Norm(final)=11.551 | 1770.5 samples/s | 27.7 steps/s
[Step=26800 Epoch=130.6] | Loss=0.01285 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.960 | L2-Norm(final)=11.556 | 4534.7 samples/s | 70.9 steps/s
[Step=26850 Epoch=130.8] | Loss=0.01248 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.972 | L2-Norm(final)=11.562 | 4643.0 samples/s | 72.5 steps/s
[Step=26900 Epoch=131.1] | Loss=0.01190 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.982 | L2-Norm(final)=11.567 | 5819.4 samples/s | 90.9 steps/s
[Step=26950 Epoch=131.3] | Loss=0.01137 | Reg=0.00144 | acc=1.0000 | L2-Norm=11.992 | L2-Norm(final)=11.572 | 1810.7 samples/s | 28.3 steps/s
[Step=27000 Epoch=131.6] | Loss=0.01074 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.001 | L2-Norm(final)=11.577 | 4576.7 samples/s | 71.5 steps/s
[Step=27050 Epoch=131.8] | Loss=0.01043 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.010 | L2-Norm(final)=11.583 | 4585.4 samples/s | 71.6 steps/s
[Step=27100 Epoch=132.0] | Loss=0.01038 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.018 | L2-Norm(final)=11.587 | 5313.5 samples/s | 83.0 steps/s
[Step=27150 Epoch=132.3] | Loss=0.01001 | Reg=0.00145 | acc=0.9688 | L2-Norm=12.026 | L2-Norm(final)=11.591 | 1823.1 samples/s | 28.5 steps/s
[Step=27200 Epoch=132.5] | Loss=0.00965 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.033 | L2-Norm(final)=11.595 | 4602.5 samples/s | 71.9 steps/s
[Step=27250 Epoch=132.8] | Loss=0.00933 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.040 | L2-Norm(final)=11.599 | 4678.3 samples/s | 73.1 steps/s
[Step=27300 Epoch=133.0] | Loss=0.00911 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.047 | L2-Norm(final)=11.603 | 5052.0 samples/s | 78.9 steps/s
[Step=27350 Epoch=133.3] | Loss=0.00879 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.053 | L2-Norm(final)=11.607 | 1880.4 samples/s | 29.4 steps/s
[Step=27400 Epoch=133.5] | Loss=0.00847 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.059 | L2-Norm(final)=11.610 | 4611.8 samples/s | 72.1 steps/s
[Step=27450 Epoch=133.7] | Loss=0.00829 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.064 | L2-Norm(final)=11.614 | 4618.8 samples/s | 72.2 steps/s
[Step=27500 Epoch=134.0] | Loss=0.00811 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=11.618 | 4779.8 samples/s | 74.7 steps/s
[Step=27550 Epoch=134.2] | Loss=0.00808 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.075 | L2-Norm(final)=11.621 | 1908.1 samples/s | 29.8 steps/s
[Step=27600 Epoch=134.5] | Loss=0.00800 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.080 | L2-Norm(final)=11.624 | 4690.7 samples/s | 73.3 steps/s
[Step=27650 Epoch=134.7] | Loss=0.00788 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.085 | L2-Norm(final)=11.626 | 4626.5 samples/s | 72.3 steps/s
[Step=27700 Epoch=135.0] | Loss=0.00770 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.089 | L2-Norm(final)=11.629 | 4725.2 samples/s | 73.8 steps/s
[Step=27750 Epoch=135.2] | Loss=0.00758 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.093 | L2-Norm(final)=11.632 | 1850.6 samples/s | 28.9 steps/s
[Step=27800 Epoch=135.5] | Loss=0.00738 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.098 | L2-Norm(final)=11.635 | 4580.9 samples/s | 71.6 steps/s
[Step=27850 Epoch=135.7] | Loss=0.00729 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.102 | L2-Norm(final)=11.637 | 4585.2 samples/s | 71.6 steps/s
[Step=27900 Epoch=135.9] | Loss=0.00712 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.105 | L2-Norm(final)=11.640 | 4751.4 samples/s | 74.2 steps/s
[Step=27950 Epoch=136.2] | Loss=0.00696 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.109 | L2-Norm(final)=11.643 | 1924.5 samples/s | 30.1 steps/s
[Step=28000 Epoch=136.4] | Loss=0.00682 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.112 | L2-Norm(final)=11.645 | 4663.7 samples/s | 72.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step28000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=30001 Epoch=147.1] | Loss=0.01108 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.514 | L2-Norm(final)=11.154 | 3515.6 samples/s | 54.9 steps/s
[Step=30050 Epoch=147.4] | Loss=0.01975 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.532 | L2-Norm(final)=11.148 | 5361.9 samples/s | 83.8 steps/s
[Step=30100 Epoch=147.6] | Loss=0.02087 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.561 | L2-Norm(final)=11.146 | 5045.1 samples/s | 78.8 steps/s
[Step=30150 Epoch=147.9] | Loss=0.01990 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.590 | L2-Norm(final)=11.149 | 5361.0 samples/s | 83.8 steps/s
[Step=30200 Epoch=148.1] | Loss=0.01863 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.613 | L2-Norm(final)=11.154 | 7398.1 samples/s | 115.6 steps/s
[Step=30250 Epoch=148.3] | Loss=0.01706 | Reg=0.00135 | acc=0.9688 | L2-Norm=11.633 | L2-Norm(final)=11.163 | 1810.7 samples/s | 28.3 steps/s
[Step=30300 Epoch=148.6] | Loss=0.01599 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.651 | L2-Norm(final)=11.173 | 5226.9 samples/s | 81.7 steps/s
[Step=30350 Epoch=148.8] | Loss=0.01527 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.669 | L2-Norm(final)=11.185 | 5172.4 samples/s | 80.8 steps/s
[Step=30400 Epoch=149.1] | Loss=0.01507 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.686 | L2-Norm(final)=11.196 | 6861.9 samples/s | 107.2 steps/s
[Step=30450 Epoch=149.3] | Loss=0.01442 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.703 | L2-Norm(final)=11.208 | 1843.0 samples/s | 28.8 steps/s
[Step=30500 Epoch=149.6] | Loss=0.01365 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.720 | L2-Norm(final)=11.221 | 5205.6 samples/s | 81.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=30501 Epoch=149.6] | Loss=0.01552 | Reg=0.00141 | acc=0.9844 | L2-Norm=11.882 | L2-Norm(final)=11.355 | 3785.5 samples/s | 59.1 steps/s
[Step=30550 Epoch=149.8] | Loss=0.01255 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.904 | L2-Norm(final)=11.367 | 4436.4 samples/s | 69.3 steps/s
[Step=30600 Epoch=150.1] | Loss=0.01715 | Reg=0.00142 | acc=0.9844 | L2-Norm=11.928 | L2-Norm(final)=11.373 | 5011.5 samples/s | 78.3 steps/s
[Step=30650 Epoch=150.3] | Loss=0.01904 | Reg=0.00143 | acc=0.9844 | L2-Norm=11.950 | L2-Norm(final)=11.376 | 4841.4 samples/s | 75.6 steps/s
[Step=30700 Epoch=150.5] | Loss=0.01803 | Reg=0.00143 | acc=0.9688 | L2-Norm=11.971 | L2-Norm(final)=11.378 | 6264.3 samples/s | 97.9 steps/s
[Step=30750 Epoch=150.8] | Loss=0.01640 | Reg=0.00144 | acc=0.9844 | L2-Norm=11.988 | L2-Norm(final)=11.382 | 1724.8 samples/s | 26.9 steps/s
[Step=30800 Epoch=151.0] | Loss=0.01482 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.002 | L2-Norm(final)=11.387 | 4617.8 samples/s | 72.2 steps/s
[Step=30850 Epoch=151.3] | Loss=0.01383 | Reg=0.00144 | acc=1.0000 | L2-Norm=12.013 | L2-Norm(final)=11.392 | 4667.0 samples/s | 72.9 steps/s
[Step=30900 Epoch=151.5] | Loss=0.01298 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.023 | L2-Norm(final)=11.396 | 5865.7 samples/s | 91.7 steps/s
[Step=30950 Epoch=151.8] | Loss=0.01221 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.031 | L2-Norm(final)=11.400 | 1758.3 samples/s | 27.5 steps/s
[Step=31000 Epoch=152.0] | Loss=0.01155 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.039 | L2-Norm(final)=11.404 | 4664.5 samples/s | 72.9 steps/s
[Step=31050 Epoch=152.3] | Loss=0.01098 | Reg=0.00145 | acc=1.0000 | L2-Norm=12.047 | L2-Norm(final)=11.408 | 4707.0 samples/s | 73.5 steps/s
[Step=31100 Epoch=152.5] | Loss=0.01047 | Reg=0.00145 | acc=0.9844 | L2-Norm=12.053 | L2-Norm(final)=11.412 | 5789.8 samples/s | 90.5 steps/s
[Step=31150 Epoch=152.8] | Loss=0.00996 | Reg=0.00145 | acc=0.9688 | L2-Norm=12.059 | L2-Norm(final)=11.416 | 1803.0 samples/s | 28.2 steps/s
[Step=31200 Epoch=153.0] | Loss=0.00950 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.065 | L2-Norm(final)=11.419 | 4680.6 samples/s | 73.1 steps/s
[Step=31250 Epoch=153.2] | Loss=0.00918 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.070 | L2-Norm(final)=11.423 | 4711.9 samples/s | 73.6 steps/s
[Step=31300 Epoch=153.5] | Loss=0.00899 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.075 | L2-Norm(final)=11.426 | 5416.7 samples/s | 84.6 steps/s
[Step=31350 Epoch=153.7] | Loss=0.00869 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.079 | L2-Norm(final)=11.428 | 1799.8 samples/s | 28.1 steps/s
[Step=31400 Epoch=154.0] | Loss=0.00843 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.084 | L2-Norm(final)=11.431 | 4597.3 samples/s | 71.8 steps/s
[Step=31450 Epoch=154.2] | Loss=0.00823 | Reg=0.00146 | acc=0.9688 | L2-Norm=12.087 | L2-Norm(final)=11.434 | 4627.1 samples/s | 72.3 steps/s
[Step=31500 Epoch=154.5] | Loss=0.00805 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.091 | L2-Norm(final)=11.436 | 5156.8 samples/s | 80.6 steps/s
[Step=31550 Epoch=154.7] | Loss=0.00782 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.094 | L2-Norm(final)=11.439 | 1850.1 samples/s | 28.9 steps/s
[Step=31600 Epoch=155.0] | Loss=0.00758 | Reg=0.00146 | acc=0.9844 | L2-Norm=12.097 | L2-Norm(final)=11.441 | 4648.4 samples/s | 72.6 steps/s
[Step=31650 Epoch=155.2] | Loss=0.00738 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.100 | L2-Norm(final)=11.443 | 4711.6 samples/s | 73.6 steps/s
[Step=31700 Epoch=155.5] | Loss=0.00725 | Reg=0.00146 | acc=1.0000 | L2-Norm=12.103 | L2-Norm(final)=11.446 | 4931.5 samples/s | 77.1 steps/s
[Step=31750 Epoch=155.7] | Loss=0.00705 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.105 | L2-Norm(final)=11.448 | 1843.3 samples/s | 28.8 steps/s
[Step=31800 Epoch=155.9] | Loss=0.00684 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.107 | L2-Norm(final)=11.450 | 4449.0 samples/s | 69.5 steps/s
[Step=31850 Epoch=156.2] | Loss=0.00669 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.110 | L2-Norm(final)=11.453 | 4704.8 samples/s | 73.5 steps/s
[Step=31900 Epoch=156.4] | Loss=0.00662 | Reg=0.00147 | acc=0.9844 | L2-Norm=12.112 | L2-Norm(final)=11.455 | 4925.0 samples/s | 77.0 steps/s
[Step=31950 Epoch=156.7] | Loss=0.00656 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.113 | L2-Norm(final)=11.457 | 1897.2 samples/s | 29.6 steps/s
[Step=32000 Epoch=156.9] | Loss=0.00641 | Reg=0.00147 | acc=1.0000 | L2-Norm=12.115 | L2-Norm(final)=11.458 | 4851.1 samples/s | 75.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step32000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=20001 Epoch=188.5] | Loss=0.00004 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.514 | L2-Norm(final)=7.921 | 3877.9 samples/s | 60.6 steps/s
[Step=20050 Epoch=188.9] | Loss=0.00301 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.546 | L2-Norm(final)=7.915 | 4572.3 samples/s | 71.4 steps/s
[Step=20100 Epoch=189.4] | Loss=0.00189 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.564 | L2-Norm(final)=7.925 | 6766.7 samples/s | 105.7 steps/s
[Step=20150 Epoch=189.9] | Loss=0.00136 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.575 | L2-Norm(final)=7.935 | 1770.8 samples/s | 27.7 steps/s
[Step=20200 Epoch=190.3] | Loss=0.00105 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.579 | L2-Norm(final)=7.945 | 6060.6 samples/s | 94.7 steps/s
[Step=20250 Epoch=190.8] | Loss=0.00087 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.581 | L2-Norm(final)=7.953 | 1803.9 samples/s | 28.2 steps/s
[Step=20300 Epoch=191.3] | Loss=0.00075 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.580 | L2-Norm(final)=7.960 | 5585.0 samples/s | 87.3 steps/s
[Step=20350 Epoch=191.8] | Loss=0.00065 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.579 | L2-Norm(final)=7.967 | 1882.1 samples/s | 29.4 steps/s
[Step=20400 Epoch=192.2] | Loss=0.00058 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.576 | L2-Norm(final)=7.973 | 5200.2 samples/s | 81.3 steps/s
[Step=20450 Epoch=192.7] | Loss=0.00052 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.574 | L2-Norm(final)=7.979 | 1970.5 samples/s | 30.8 steps/s
[Step=20500 Epoch=193.2] | Loss=0.00048 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.570 | L2-Norm(final)=7.984 | 4736.0 samples/s | 74.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=193.2] | Loss=0.00025 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.535 | L2-Norm(final)=8.038 | 3657.8 samples/s | 57.2 steps/s
[Step=20550 Epoch=193.6] | Loss=0.00006 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.528 | L2-Norm(final)=8.042 | 4208.3 samples/s | 65.8 steps/s
[Step=20600 Epoch=194.1] | Loss=0.00005 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.519 | L2-Norm(final)=8.046 | 5773.1 samples/s | 90.2 steps/s
[Step=20650 Epoch=194.6] | Loss=0.00004 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.510 | L2-Norm(final)=8.049 | 1658.0 samples/s | 25.9 steps/s
[Step=20700 Epoch=195.1] | Loss=0.00004 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.500 | L2-Norm(final)=8.051 | 5266.7 samples/s | 82.3 steps/s
[Step=20750 Epoch=195.5] | Loss=0.00003 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.490 | L2-Norm(final)=8.053 | 1741.4 samples/s | 27.2 steps/s
[Step=20800 Epoch=196.0] | Loss=0.00003 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.479 | L2-Norm(final)=8.054 | 4968.0 samples/s | 77.6 steps/s
[Step=20850 Epoch=196.5] | Loss=0.00003 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.469 | L2-Norm(final)=8.056 | 1794.4 samples/s | 28.0 steps/s
[Step=20900 Epoch=196.9] | Loss=0.00002 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.458 | L2-Norm(final)=8.057 | 4550.6 samples/s | 71.1 steps/s
[Step=20950 Epoch=197.4] | Loss=0.00002 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.447 | L2-Norm(final)=8.058 | 1842.8 samples/s | 28.8 steps/s
[Step=21000 Epoch=197.9] | Loss=0.00002 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.435 | L2-Norm(final)=8.060 | 4647.8 samples/s | 72.6 steps/s
[Step=21050 Epoch=198.4] | Loss=0.00002 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.424 | L2-Norm(final)=8.061 | 1867.2 samples/s | 29.2 steps/s
[Step=21100 Epoch=198.8] | Loss=0.00002 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.413 | L2-Norm(final)=8.062 | 4477.5 samples/s | 70.0 steps/s
[Step=21150 Epoch=199.3] | Loss=0.00002 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.401 | L2-Norm(final)=8.063 | 1870.4 samples/s | 29.2 steps/s
[Step=21200 Epoch=199.8] | Loss=0.00002 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.390 | L2-Norm(final)=8.064 | 4392.8 samples/s | 68.6 steps/s
[Step=21250 Epoch=200.2] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.378 | L2-Norm(final)=8.065 | 1913.0 samples/s | 29.9 steps/s
[Step=21300 Epoch=200.7] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.366 | L2-Norm(final)=8.066 | 4204.4 samples/s | 65.7 steps/s
[Step=21350 Epoch=201.2] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.354 | L2-Norm(final)=8.067 | 5987.3 samples/s | 93.6 steps/s
[Step=21400 Epoch=201.6] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.342 | L2-Norm(final)=8.067 | 1710.0 samples/s | 26.7 steps/s
[Step=21450 Epoch=202.1] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.330 | L2-Norm(final)=8.068 | 5432.2 samples/s | 84.9 steps/s
[Step=21500 Epoch=202.6] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.318 | L2-Norm(final)=8.069 | 1705.2 samples/s | 26.6 steps/s
[Step=21550 Epoch=203.1] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.305 | L2-Norm(final)=8.070 | 5040.3 samples/s | 78.8 steps/s
[Step=21600 Epoch=203.5] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.293 | L2-Norm(final)=8.071 | 1804.5 samples/s | 28.2 steps/s
[Step=21650 Epoch=204.0] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.280 | L2-Norm(final)=8.072 | 4466.4 samples/s | 69.8 steps/s
[Step=21700 Epoch=204.5] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.268 | L2-Norm(final)=8.072 | 1835.1 samples/s | 28.7 steps/s
[Step=21750 Epoch=204.9] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.255 | L2-Norm(final)=8.073 | 4492.4 samples/s | 70.2 steps/s
[Step=21800 Epoch=205.4] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.242 | L2-Norm(final)=8.074 | 1865.3 samples/s | 29.1 steps/s
[Step=21850 Epoch=205.9] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.229 | L2-Norm(final)=8.075 | 4466.2 samples/s | 69.8 steps/s
[Step=21900 Epoch=206.4] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.217 | L2-Norm(final)=8.076 | 1850.2 samples/s | 28.9 steps/s
[Step=21950 Epoch=206.8] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.203 | L2-Norm(final)=8.076 | 4294.6 samples/s | 67.1 steps/s
[Step=22000 Epoch=207.3] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.190 | L2-Norm(final)=8.077 | 1922.7 samples/s | 30.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step22000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=26001 Epoch=247.8] | Loss=0.00261 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.514 | L2-Norm(final)=8.681 | 3714.2 samples/s | 58.0 steps/s
[Step=26050 Epoch=248.3] | Loss=0.00299 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.559 | L2-Norm(final)=8.684 | 4363.3 samples/s | 68.2 steps/s
[Step=26100 Epoch=248.8] | Loss=0.00232 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.588 | L2-Norm(final)=8.694 | 6982.1 samples/s | 109.1 steps/s
[Step=26150 Epoch=249.2] | Loss=0.00166 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.608 | L2-Norm(final)=8.706 | 1745.3 samples/s | 27.3 steps/s
[Step=26200 Epoch=249.7] | Loss=0.00127 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.618 | L2-Norm(final)=8.714 | 6331.4 samples/s | 98.9 steps/s
[Step=26250 Epoch=250.2] | Loss=0.00103 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.622 | L2-Norm(final)=8.721 | 1825.0 samples/s | 28.5 steps/s
[Step=26300 Epoch=250.7] | Loss=0.00088 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.623 | L2-Norm(final)=8.727 | 5961.6 samples/s | 93.2 steps/s
[Step=26350 Epoch=251.1] | Loss=0.00076 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.623 | L2-Norm(final)=8.732 | 1830.8 samples/s | 28.6 steps/s
[Step=26400 Epoch=251.6] | Loss=0.00067 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.621 | L2-Norm(final)=8.737 | 5632.1 samples/s | 88.0 steps/s
[Step=26450 Epoch=252.1] | Loss=0.00061 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.619 | L2-Norm(final)=8.741 | 1853.1 samples/s | 29.0 steps/s
[Step=26500 Epoch=252.6] | Loss=0.00055 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.616 | L2-Norm(final)=8.746 | 5283.1 samples/s | 82.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=252.6] | Loss=0.00003 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.585 | L2-Norm(final)=8.788 | 3588.7 samples/s | 56.1 steps/s
[Step=26550 Epoch=253.0] | Loss=0.00006 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.579 | L2-Norm(final)=8.791 | 4174.8 samples/s | 65.2 steps/s
[Step=26600 Epoch=253.5] | Loss=0.00004 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.570 | L2-Norm(final)=8.794 | 6037.5 samples/s | 94.3 steps/s
[Step=26650 Epoch=254.0] | Loss=0.00003 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.561 | L2-Norm(final)=8.796 | 1672.8 samples/s | 26.1 steps/s
[Step=26700 Epoch=254.5] | Loss=0.00003 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.552 | L2-Norm(final)=8.797 | 5569.4 samples/s | 87.0 steps/s
[Step=26750 Epoch=255.0] | Loss=0.00003 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.542 | L2-Norm(final)=8.799 | 1751.2 samples/s | 27.4 steps/s
[Step=26800 Epoch=255.4] | Loss=0.00002 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.532 | L2-Norm(final)=8.800 | 5332.1 samples/s | 83.3 steps/s
[Step=26850 Epoch=255.9] | Loss=0.00002 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.522 | L2-Norm(final)=8.801 | 1759.9 samples/s | 27.5 steps/s
[Step=26900 Epoch=256.4] | Loss=0.00002 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.512 | L2-Norm(final)=8.802 | 4866.2 samples/s | 76.0 steps/s
[Step=26950 Epoch=256.9] | Loss=0.00002 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.502 | L2-Norm(final)=8.803 | 1788.4 samples/s | 27.9 steps/s
[Step=27000 Epoch=257.3] | Loss=0.00002 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=8.804 | 4652.9 samples/s | 72.7 steps/s
[Step=27050 Epoch=257.8] | Loss=0.00002 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.481 | L2-Norm(final)=8.805 | 1804.6 samples/s | 28.2 steps/s
[Step=27100 Epoch=258.3] | Loss=0.00002 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.470 | L2-Norm(final)=8.806 | 4513.2 samples/s | 70.5 steps/s
[Step=27150 Epoch=258.8] | Loss=0.00002 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.459 | L2-Norm(final)=8.807 | 1876.2 samples/s | 29.3 steps/s
[Step=27200 Epoch=259.2] | Loss=0.00002 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.448 | L2-Norm(final)=8.808 | 4424.3 samples/s | 69.1 steps/s
[Step=27250 Epoch=259.7] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.437 | L2-Norm(final)=8.809 | 1857.1 samples/s | 29.0 steps/s
[Step=27300 Epoch=260.2] | Loss=0.00001 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.426 | L2-Norm(final)=8.810 | 4542.2 samples/s | 71.0 steps/s
[Step=27350 Epoch=260.7] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.415 | L2-Norm(final)=8.811 | 1863.4 samples/s | 29.1 steps/s
[Step=27400 Epoch=261.1] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.403 | L2-Norm(final)=8.811 | 4428.8 samples/s | 69.2 steps/s
[Step=27450 Epoch=261.6] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.392 | L2-Norm(final)=8.812 | 1883.0 samples/s | 29.4 steps/s
[Step=27500 Epoch=262.1] | Loss=0.00001 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=8.813 | 4428.7 samples/s | 69.2 steps/s
[Step=27550 Epoch=262.6] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.369 | L2-Norm(final)=8.814 | 6353.5 samples/s | 99.3 steps/s
[Step=27600 Epoch=263.1] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.357 | L2-Norm(final)=8.814 | 1653.6 samples/s | 25.8 steps/s
[Step=27650 Epoch=263.5] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.345 | L2-Norm(final)=8.815 | 5942.4 samples/s | 92.9 steps/s
[Step=27700 Epoch=264.0] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.333 | L2-Norm(final)=8.816 | 1685.4 samples/s | 26.3 steps/s
[Step=27750 Epoch=264.5] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.321 | L2-Norm(final)=8.817 | 5718.3 samples/s | 89.3 steps/s
[Step=27800 Epoch=265.0] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.309 | L2-Norm(final)=8.817 | 1703.1 samples/s | 26.6 steps/s
[Step=27850 Epoch=265.4] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.296 | L2-Norm(final)=8.818 | 5204.5 samples/s | 81.3 steps/s
[Step=27900 Epoch=265.9] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.284 | L2-Norm(final)=8.819 | 1787.6 samples/s | 27.9 steps/s
[Step=27950 Epoch=266.4] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.271 | L2-Norm(final)=8.819 | 4934.2 samples/s | 77.1 steps/s
[Step=28000 Epoch=266.9] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.259 | L2-Norm(final)=8.820 | 1809.2 samples/s | 28.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09438 | acc=0.9609 | tpr=0.9795 | fpr=0.0795 | 3994.0 samples/s | 15.6 steps/s
Avg test loss: 0.09750, Avg test acc: 0.95921, Avg tpr: 0.97855, Avg fpr: 0.08332, total FA: 650

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09252 | acc=0.9594 | tpr=0.9742 | fpr=0.0728 | 4061.6 samples/s | 15.9 steps/s
Avg test loss: 0.09752, Avg test acc: 0.95909, Avg tpr: 0.97377, Avg fpr: 0.07320, total FA: 571

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09768 | acc=0.9595 | tpr=0.9728 | fpr=0.0696 | 4111.3 samples/s | 16.1 steps/s
Avg test loss: 0.10295, Avg test acc: 0.95889, Avg tpr: 0.97162, Avg fpr: 0.06909, total FA: 539

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08842 | acc=0.9590 | tpr=0.9684 | fpr=0.0614 | 4143.6 samples/s | 16.2 steps/s
Avg test loss: 0.09359, Avg test acc: 0.95877, Avg tpr: 0.96992, Avg fpr: 0.06576, total FA: 513

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.10045 | acc=0.9576 | tpr=0.9612 | fpr=0.0503 | 4050.2 samples/s | 15.8 steps/s
Avg test loss: 0.10665, Avg test acc: 0.95677, Avg tpr: 0.96066, Avg fpr: 0.05179, total FA: 404

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.21628 | acc=0.2839 | tpr=0.0037 | fpr=0.1075 | 4049.5 samples/s | 15.8 steps/s
Avg test loss: 5.23325, Avg test acc: 0.28139, Avg tpr: 0.00455, Avg fpr: 0.10973, total FA: 856

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.64981 | acc=0.3106 | tpr=0.0074 | fpr=0.0310 | 4159.3 samples/s | 16.2 steps/s
Avg test loss: 4.66086, Avg test acc: 0.30856, Avg tpr: 0.00874, Avg fpr: 0.03205, total FA: 250

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.12189 | acc=0.2948 | tpr=0.0076 | fpr=0.0815 | 4099.4 samples/s | 16.0 steps/s
Avg test loss: 5.13500, Avg test acc: 0.29353, Avg tpr: 0.00892, Avg fpr: 0.08050, total FA: 628

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.01746 | acc=0.2998 | tpr=0.0059 | fpr=0.0622 | 4066.2 samples/s | 15.9 steps/s
Avg test loss: 5.02260, Avg test acc: 0.29778, Avg tpr: 0.00699, Avg fpr: 0.06268, total FA: 489

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.89511 | acc=0.3116 | tpr=0.0024 | fpr=0.0171 | 4112.6 samples/s | 16.1 steps/s
Avg test loss: 4.90047, Avg test acc: 0.30916, Avg tpr: 0.00344, Avg fpr: 0.01846, total FA: 144

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.76400 | acc=0.1053 | tpr=0.9115 | fpr=0.9092 | 4115.4 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.71192 | acc=0.1064 | tpr=0.8913 | fpr=0.9082 | 8088.0 samples/s | 31.6 steps/s
[Step= 150] | Loss=5.72043 | acc=0.1038 | tpr=0.8991 | fpr=0.9108 | 8113.0 samples/s | 31.7 steps/s
[Step= 200] | Loss=5.71928 | acc=0.1028 | tpr=0.8962 | fpr=0.9116 | 7862.7 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.72292 | acc=0.1030 | tpr=0.8917 | fpr=0.9113 | 7934.1 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.71878 | acc=0.1028 | tpr=0.8880 | fpr=0.9115 | 8708.2 samples/s | 34.0 steps/s
[Step= 350] | Loss=5.71599 | acc=0.1025 | tpr=0.8817 | fpr=0.9117 | 7968.7 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.71714 | acc=0.1031 | tpr=0.8786 | fpr=0.9110 | 7976.7 samples/s | 31.2 steps/s
[Step= 450] | Loss=5.72063 | acc=0.1027 | tpr=0.8724 | fpr=0.9112 | 7912.1 samples/s | 30.9 steps/s
[Step= 500] | Loss=5.72196 | acc=0.1026 | tpr=0.8736 | fpr=0.9113 | 7663.6 samples/s | 29.9 steps/s
[Step= 550] | Loss=5.72283 | acc=0.1025 | tpr=0.8774 | fpr=0.9116 | 14557.7 samples/s | 56.9 steps/s
Avg test loss: 5.72416, Avg test acc: 0.10241, Avg tpr: 0.87718, Avg fpr: 0.91167, total FA: 126584

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.85811 | acc=0.1286 | tpr=0.7920 | fpr=0.8833 | 4063.5 samples/s | 15.9 steps/s
[Step= 100] | Loss=4.80342 | acc=0.1306 | tpr=0.7612 | fpr=0.8811 | 8112.9 samples/s | 31.7 steps/s
[Step= 150] | Loss=4.81098 | acc=0.1284 | tpr=0.7507 | fpr=0.8831 | 8252.1 samples/s | 32.2 steps/s
[Step= 200] | Loss=4.80811 | acc=0.1280 | tpr=0.7366 | fpr=0.8831 | 8168.3 samples/s | 31.9 steps/s
[Step= 250] | Loss=4.80801 | acc=0.1280 | tpr=0.7336 | fpr=0.8830 | 7949.2 samples/s | 31.1 steps/s
[Step= 300] | Loss=4.80763 | acc=0.1274 | tpr=0.7360 | fpr=0.8836 | 8115.5 samples/s | 31.7 steps/s
[Step= 350] | Loss=4.80297 | acc=0.1269 | tpr=0.7314 | fpr=0.8841 | 8134.6 samples/s | 31.8 steps/s
[Step= 400] | Loss=4.80360 | acc=0.1272 | tpr=0.7314 | fpr=0.8838 | 8272.1 samples/s | 32.3 steps/s
[Step= 450] | Loss=4.80847 | acc=0.1272 | tpr=0.7259 | fpr=0.8836 | 8158.3 samples/s | 31.9 steps/s
[Step= 500] | Loss=4.81384 | acc=0.1268 | tpr=0.7216 | fpr=0.8839 | 8028.5 samples/s | 31.4 steps/s
[Step= 550] | Loss=4.81394 | acc=0.1268 | tpr=0.7226 | fpr=0.8840 | 13407.2 samples/s | 52.4 steps/s
Avg test loss: 4.81498, Avg test acc: 0.12675, Avg tpr: 0.72266, Avg fpr: 0.88408, total FA: 122753

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.17457 | acc=0.1120 | tpr=0.7699 | fpr=0.8999 | 4178.1 samples/s | 16.3 steps/s
[Step= 100] | Loss=6.11646 | acc=0.1143 | tpr=0.7484 | fpr=0.8975 | 7873.2 samples/s | 30.8 steps/s
[Step= 150] | Loss=6.12945 | acc=0.1121 | tpr=0.7608 | fpr=0.8998 | 8349.0 samples/s | 32.6 steps/s
[Step= 200] | Loss=6.13057 | acc=0.1116 | tpr=0.7574 | fpr=0.9001 | 7734.5 samples/s | 30.2 steps/s
[Step= 250] | Loss=6.13295 | acc=0.1120 | tpr=0.7616 | fpr=0.8999 | 8232.3 samples/s | 32.2 steps/s
[Step= 300] | Loss=6.12957 | acc=0.1118 | tpr=0.7629 | fpr=0.9001 | 7490.1 samples/s | 29.3 steps/s
[Step= 350] | Loss=6.12785 | acc=0.1115 | tpr=0.7564 | fpr=0.9002 | 8519.0 samples/s | 33.3 steps/s
[Step= 400] | Loss=6.12920 | acc=0.1120 | tpr=0.7560 | fpr=0.8997 | 8226.6 samples/s | 32.1 steps/s
[Step= 450] | Loss=6.13266 | acc=0.1114 | tpr=0.7537 | fpr=0.9003 | 7787.7 samples/s | 30.4 steps/s
[Step= 500] | Loss=6.13389 | acc=0.1112 | tpr=0.7529 | fpr=0.9004 | 8039.0 samples/s | 31.4 steps/s
[Step= 550] | Loss=6.13255 | acc=0.1111 | tpr=0.7573 | fpr=0.9006 | 13999.8 samples/s | 54.7 steps/s
Avg test loss: 6.13418, Avg test acc: 0.11106, Avg tpr: 0.75674, Avg fpr: 0.90068, total FA: 125057

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.80496 | acc=0.1308 | tpr=0.7301 | fpr=0.8800 | 4062.9 samples/s | 15.9 steps/s
[Step= 100] | Loss=4.75565 | acc=0.1327 | tpr=0.6759 | fpr=0.8774 | 8216.5 samples/s | 32.1 steps/s
[Step= 150] | Loss=4.75866 | acc=0.1315 | tpr=0.6888 | fpr=0.8788 | 8282.2 samples/s | 32.4 steps/s
[Step= 200] | Loss=4.75165 | acc=0.1312 | tpr=0.6907 | fpr=0.8790 | 7955.0 samples/s | 31.1 steps/s
[Step= 250] | Loss=4.75190 | acc=0.1316 | tpr=0.7004 | fpr=0.8787 | 7999.1 samples/s | 31.2 steps/s
[Step= 300] | Loss=4.74971 | acc=0.1313 | tpr=0.7018 | fpr=0.8791 | 7900.3 samples/s | 30.9 steps/s
[Step= 350] | Loss=4.74514 | acc=0.1312 | tpr=0.6951 | fpr=0.8790 | 8041.9 samples/s | 31.4 steps/s
[Step= 400] | Loss=4.74788 | acc=0.1312 | tpr=0.6915 | fpr=0.8790 | 8124.4 samples/s | 31.7 steps/s
[Step= 450] | Loss=4.75264 | acc=0.1308 | tpr=0.6855 | fpr=0.8793 | 7887.9 samples/s | 30.8 steps/s
[Step= 500] | Loss=4.75700 | acc=0.1304 | tpr=0.6872 | fpr=0.8796 | 8175.1 samples/s | 31.9 steps/s
[Step= 550] | Loss=4.75626 | acc=0.1301 | tpr=0.6860 | fpr=0.8800 | 14074.4 samples/s | 55.0 steps/s
Avg test loss: 4.75762, Avg test acc: 0.13000, Avg tpr: 0.68582, Avg fpr: 0.88010, total FA: 122200

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.32485 | acc=0.1453 | tpr=0.6504 | fpr=0.8638 | 4069.9 samples/s | 15.9 steps/s
[Step= 100] | Loss=5.26633 | acc=0.1478 | tpr=0.6098 | fpr=0.8608 | 8221.7 samples/s | 32.1 steps/s
[Step= 150] | Loss=5.25971 | acc=0.1458 | tpr=0.5994 | fpr=0.8626 | 7956.8 samples/s | 31.1 steps/s
[Step= 200] | Loss=5.25486 | acc=0.1456 | tpr=0.5978 | fpr=0.8626 | 8317.9 samples/s | 32.5 steps/s
[Step= 250] | Loss=5.25664 | acc=0.1454 | tpr=0.5974 | fpr=0.8629 | 7897.6 samples/s | 30.8 steps/s
[Step= 300] | Loss=5.24980 | acc=0.1453 | tpr=0.6036 | fpr=0.8630 | 8514.6 samples/s | 33.3 steps/s
[Step= 350] | Loss=5.24667 | acc=0.1449 | tpr=0.5999 | fpr=0.8633 | 7968.2 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.24898 | acc=0.1449 | tpr=0.5963 | fpr=0.8633 | 7985.3 samples/s | 31.2 steps/s
[Step= 450] | Loss=5.25087 | acc=0.1446 | tpr=0.5906 | fpr=0.8635 | 8122.9 samples/s | 31.7 steps/s
[Step= 500] | Loss=5.25124 | acc=0.1446 | tpr=0.5850 | fpr=0.8633 | 7969.8 samples/s | 31.1 steps/s
[Step= 550] | Loss=5.25190 | acc=0.1445 | tpr=0.5850 | fpr=0.8635 | 14963.8 samples/s | 58.5 steps/s
Avg test loss: 5.25359, Avg test acc: 0.14441, Avg tpr: 0.58518, Avg fpr: 0.86360, total FA: 119909

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10814 | acc=0.9805 | tpr=0.9159 | fpr=0.0183 | 4105.6 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.11173 | acc=0.9804 | tpr=0.9403 | fpr=0.0189 | 8033.5 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.11610 | acc=0.9792 | tpr=0.9424 | fpr=0.0201 | 7880.5 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.11801 | acc=0.9791 | tpr=0.9421 | fpr=0.0202 | 8289.7 samples/s | 32.4 steps/s
[Step= 250] | Loss=0.11733 | acc=0.9790 | tpr=0.9380 | fpr=0.0203 | 7898.4 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.11959 | acc=0.9787 | tpr=0.9353 | fpr=0.0205 | 7997.7 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.11941 | acc=0.9787 | tpr=0.9355 | fpr=0.0205 | 7843.2 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.12092 | acc=0.9784 | tpr=0.9311 | fpr=0.0207 | 8072.7 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.12375 | acc=0.9781 | tpr=0.9318 | fpr=0.0210 | 8072.0 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.12328 | acc=0.9782 | tpr=0.9335 | fpr=0.0210 | 7996.6 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.12212 | acc=0.9784 | tpr=0.9339 | fpr=0.0208 | 14001.0 samples/s | 54.7 steps/s
Avg test loss: 0.12193, Avg test acc: 0.97843, Avg tpr: 0.93423, Avg fpr: 0.02077, total FA: 2884

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11473 | acc=0.9808 | tpr=0.9071 | fpr=0.0179 | 4211.7 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.11839 | acc=0.9803 | tpr=0.9147 | fpr=0.0185 | 7803.0 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.12319 | acc=0.9794 | tpr=0.9150 | fpr=0.0194 | 7790.0 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.12486 | acc=0.9795 | tpr=0.9202 | fpr=0.0194 | 8229.4 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.12344 | acc=0.9796 | tpr=0.9179 | fpr=0.0193 | 8166.3 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.12562 | acc=0.9790 | tpr=0.9156 | fpr=0.0198 | 8000.2 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.12561 | acc=0.9790 | tpr=0.9198 | fpr=0.0199 | 8152.8 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.12712 | acc=0.9788 | tpr=0.9152 | fpr=0.0201 | 7949.7 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.13028 | acc=0.9785 | tpr=0.9138 | fpr=0.0203 | 8425.2 samples/s | 32.9 steps/s
[Step= 500] | Loss=0.12966 | acc=0.9786 | tpr=0.9176 | fpr=0.0203 | 7746.5 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.12858 | acc=0.9787 | tpr=0.9180 | fpr=0.0202 | 14513.4 samples/s | 56.7 steps/s
Avg test loss: 0.12839, Avg test acc: 0.97873, Avg tpr: 0.91719, Avg fpr: 0.02015, total FA: 2798

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11349 | acc=0.9790 | tpr=0.9336 | fpr=0.0202 | 4072.0 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.11761 | acc=0.9787 | tpr=0.9531 | fpr=0.0209 | 8087.3 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.12190 | acc=0.9780 | tpr=0.9524 | fpr=0.0216 | 7488.7 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.12437 | acc=0.9778 | tpr=0.9552 | fpr=0.0218 | 8041.9 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.12331 | acc=0.9778 | tpr=0.9537 | fpr=0.0218 | 8107.5 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.12549 | acc=0.9774 | tpr=0.9542 | fpr=0.0222 | 7761.8 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.12543 | acc=0.9773 | tpr=0.9549 | fpr=0.0223 | 8049.5 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.12688 | acc=0.9771 | tpr=0.9519 | fpr=0.0224 | 7726.5 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.12985 | acc=0.9768 | tpr=0.9513 | fpr=0.0227 | 7919.8 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.12944 | acc=0.9769 | tpr=0.9529 | fpr=0.0227 | 7830.4 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.12812 | acc=0.9771 | tpr=0.9534 | fpr=0.0225 | 14631.4 samples/s | 57.2 steps/s
Avg test loss: 0.12796, Avg test acc: 0.97707, Avg tpr: 0.95325, Avg fpr: 0.02250, total FA: 3124

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11840 | acc=0.9811 | tpr=0.9248 | fpr=0.0179 | 4132.3 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.12355 | acc=0.9800 | tpr=0.9446 | fpr=0.0193 | 8075.0 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.12858 | acc=0.9790 | tpr=0.9409 | fpr=0.0203 | 8164.6 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.13072 | acc=0.9789 | tpr=0.9475 | fpr=0.0205 | 7669.6 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.12947 | acc=0.9787 | tpr=0.9424 | fpr=0.0206 | 8351.3 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.13170 | acc=0.9783 | tpr=0.9418 | fpr=0.0210 | 7727.6 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.13160 | acc=0.9784 | tpr=0.9455 | fpr=0.0210 | 8133.7 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.13287 | acc=0.9782 | tpr=0.9415 | fpr=0.0212 | 8126.0 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.13608 | acc=0.9778 | tpr=0.9391 | fpr=0.0215 | 8120.6 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.13565 | acc=0.9778 | tpr=0.9405 | fpr=0.0215 | 8058.4 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.13465 | acc=0.9780 | tpr=0.9407 | fpr=0.0213 | 13892.1 samples/s | 54.3 steps/s
Avg test loss: 0.13449, Avg test acc: 0.97801, Avg tpr: 0.93978, Avg fpr: 0.02130, total FA: 2957

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12635 | acc=0.9791 | tpr=0.9248 | fpr=0.0200 | 4117.9 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.13165 | acc=0.9789 | tpr=0.9446 | fpr=0.0205 | 8072.0 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.13678 | acc=0.9779 | tpr=0.9424 | fpr=0.0214 | 8236.0 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.13941 | acc=0.9777 | tpr=0.9464 | fpr=0.0218 | 7784.1 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.13805 | acc=0.9777 | tpr=0.9450 | fpr=0.0217 | 8442.7 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.14073 | acc=0.9772 | tpr=0.9455 | fpr=0.0222 | 7783.0 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.14090 | acc=0.9771 | tpr=0.9474 | fpr=0.0224 | 7764.1 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.14248 | acc=0.9769 | tpr=0.9426 | fpr=0.0225 | 7950.1 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.14563 | acc=0.9765 | tpr=0.9416 | fpr=0.0229 | 8037.8 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.14508 | acc=0.9765 | tpr=0.9419 | fpr=0.0229 | 8323.7 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.14413 | acc=0.9767 | tpr=0.9407 | fpr=0.0227 | 13642.5 samples/s | 53.3 steps/s
Avg test loss: 0.14390, Avg test acc: 0.97667, Avg tpr: 0.94057, Avg fpr: 0.02267, total FA: 3148

server round 26/50

clients selected: [3 4 5 6 8]

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=20001 Epoch=97.5] | Loss=0.02626 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.235 | L2-Norm(final)=9.687 | 3768.3 samples/s | 58.9 steps/s
[Step=20050 Epoch=97.8] | Loss=0.02670 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.257 | L2-Norm(final)=9.677 | 4927.0 samples/s | 77.0 steps/s
[Step=20100 Epoch=98.0] | Loss=0.02496 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=9.676 | 5119.3 samples/s | 80.0 steps/s
[Step=20150 Epoch=98.3] | Loss=0.02295 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.309 | L2-Norm(final)=9.678 | 5138.5 samples/s | 80.3 steps/s
[Step=20200 Epoch=98.5] | Loss=0.02168 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.332 | L2-Norm(final)=9.686 | 7537.7 samples/s | 117.8 steps/s
[Step=20250 Epoch=98.8] | Loss=0.02042 | Reg=0.00129 | acc=0.9688 | L2-Norm=11.352 | L2-Norm(final)=9.696 | 1786.6 samples/s | 27.9 steps/s
[Step=20300 Epoch=99.0] | Loss=0.01922 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.372 | L2-Norm(final)=9.706 | 5088.5 samples/s | 79.5 steps/s
[Step=20350 Epoch=99.2] | Loss=0.01831 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.391 | L2-Norm(final)=9.718 | 5180.4 samples/s | 80.9 steps/s
[Step=20400 Epoch=99.5] | Loss=0.01771 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.411 | L2-Norm(final)=9.730 | 6564.8 samples/s | 102.6 steps/s
[Step=20450 Epoch=99.7] | Loss=0.01696 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=9.743 | 1818.5 samples/s | 28.4 steps/s
[Step=20500 Epoch=100.0] | Loss=0.01646 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.449 | L2-Norm(final)=9.757 | 5246.7 samples/s | 82.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=20501 Epoch=100.0] | Loss=0.01001 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.636 | L2-Norm(final)=9.894 | 3711.8 samples/s | 58.0 steps/s
[Step=20550 Epoch=100.2] | Loss=0.01423 | Reg=0.00136 | acc=0.9531 | L2-Norm=11.660 | L2-Norm(final)=9.908 | 4143.9 samples/s | 64.7 steps/s
[Step=20600 Epoch=100.5] | Loss=0.01694 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.688 | L2-Norm(final)=9.918 | 4398.8 samples/s | 68.7 steps/s
[Step=20650 Epoch=100.7] | Loss=0.01681 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.715 | L2-Norm(final)=9.926 | 4629.5 samples/s | 72.3 steps/s
[Step=20700 Epoch=100.9] | Loss=0.01743 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.737 | L2-Norm(final)=9.933 | 6109.8 samples/s | 95.5 steps/s
[Step=20750 Epoch=101.2] | Loss=0.01630 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.755 | L2-Norm(final)=9.938 | 1679.9 samples/s | 26.2 steps/s
[Step=20800 Epoch=101.4] | Loss=0.01507 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.771 | L2-Norm(final)=9.943 | 4599.1 samples/s | 71.9 steps/s
[Step=20850 Epoch=101.7] | Loss=0.01393 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.786 | L2-Norm(final)=9.949 | 4591.1 samples/s | 71.7 steps/s
[Step=20900 Epoch=101.9] | Loss=0.01332 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.798 | L2-Norm(final)=9.955 | 5636.8 samples/s | 88.1 steps/s
[Step=20950 Epoch=102.2] | Loss=0.01245 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.810 | L2-Norm(final)=9.960 | 1802.5 samples/s | 28.2 steps/s
[Step=21000 Epoch=102.4] | Loss=0.01173 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.820 | L2-Norm(final)=9.965 | 4633.6 samples/s | 72.4 steps/s
[Step=21050 Epoch=102.7] | Loss=0.01110 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.829 | L2-Norm(final)=9.970 | 4559.9 samples/s | 71.2 steps/s
[Step=21100 Epoch=102.9] | Loss=0.01077 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.837 | L2-Norm(final)=9.975 | 5177.6 samples/s | 80.9 steps/s
[Step=21150 Epoch=103.1] | Loss=0.01106 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.845 | L2-Norm(final)=9.979 | 1792.6 samples/s | 28.0 steps/s
[Step=21200 Epoch=103.4] | Loss=0.01080 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.853 | L2-Norm(final)=9.982 | 4560.5 samples/s | 71.3 steps/s
[Step=21250 Epoch=103.6] | Loss=0.01047 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.861 | L2-Norm(final)=9.986 | 4288.3 samples/s | 67.0 steps/s
[Step=21300 Epoch=103.9] | Loss=0.01005 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.869 | L2-Norm(final)=9.989 | 4624.5 samples/s | 72.3 steps/s
[Step=21350 Epoch=104.1] | Loss=0.00977 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.876 | L2-Norm(final)=9.993 | 1801.8 samples/s | 28.2 steps/s
[Step=21400 Epoch=104.4] | Loss=0.00947 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.883 | L2-Norm(final)=9.997 | 4488.3 samples/s | 70.1 steps/s
[Step=21450 Epoch=104.6] | Loss=0.00922 | Reg=0.00141 | acc=1.0000 | L2-Norm=11.889 | L2-Norm(final)=10.000 | 4560.0 samples/s | 71.2 steps/s
[Step=21500 Epoch=104.8] | Loss=0.00908 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.895 | L2-Norm(final)=10.004 | 4593.3 samples/s | 71.8 steps/s
[Step=21550 Epoch=105.1] | Loss=0.00884 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.901 | L2-Norm(final)=10.006 | 1899.9 samples/s | 29.7 steps/s
[Step=21600 Epoch=105.3] | Loss=0.00860 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.906 | L2-Norm(final)=10.009 | 4608.2 samples/s | 72.0 steps/s
[Step=21650 Epoch=105.6] | Loss=0.00837 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.911 | L2-Norm(final)=10.012 | 4608.8 samples/s | 72.0 steps/s
[Step=21700 Epoch=105.8] | Loss=0.00815 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.915 | L2-Norm(final)=10.015 | 4732.8 samples/s | 74.0 steps/s
[Step=21750 Epoch=106.1] | Loss=0.00799 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.920 | L2-Norm(final)=10.018 | 1960.5 samples/s | 30.6 steps/s
[Step=21800 Epoch=106.3] | Loss=0.00778 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.924 | L2-Norm(final)=10.021 | 4794.5 samples/s | 74.9 steps/s
[Step=21850 Epoch=106.6] | Loss=0.00765 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.928 | L2-Norm(final)=10.024 | 4700.1 samples/s | 73.4 steps/s
[Step=21900 Epoch=106.8] | Loss=0.00752 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.932 | L2-Norm(final)=10.026 | 4628.6 samples/s | 72.3 steps/s
[Step=21950 Epoch=107.0] | Loss=0.00735 | Reg=0.00142 | acc=1.0000 | L2-Norm=11.935 | L2-Norm(final)=10.029 | 1934.6 samples/s | 30.2 steps/s
[Step=22000 Epoch=107.3] | Loss=0.00722 | Reg=0.00143 | acc=1.0000 | L2-Norm=11.939 | L2-Norm(final)=10.032 | 4556.7 samples/s | 71.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step22000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=32001 Epoch=156.9] | Loss=0.00748 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.235 | L2-Norm(final)=11.515 | 3403.8 samples/s | 53.2 steps/s
[Step=32050 Epoch=157.2] | Loss=0.01945 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.261 | L2-Norm(final)=11.502 | 4944.4 samples/s | 77.3 steps/s
[Step=32100 Epoch=157.4] | Loss=0.01912 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.289 | L2-Norm(final)=11.501 | 4958.7 samples/s | 77.5 steps/s
[Step=32150 Epoch=157.7] | Loss=0.01849 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.312 | L2-Norm(final)=11.502 | 4939.9 samples/s | 77.2 steps/s
[Step=32200 Epoch=157.9] | Loss=0.01739 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.331 | L2-Norm(final)=11.506 | 7423.4 samples/s | 116.0 steps/s
[Step=32250 Epoch=158.1] | Loss=0.01577 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.349 | L2-Norm(final)=11.513 | 1788.9 samples/s | 28.0 steps/s
[Step=32300 Epoch=158.4] | Loss=0.01505 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.366 | L2-Norm(final)=11.521 | 5155.0 samples/s | 80.5 steps/s
[Step=32350 Epoch=158.6] | Loss=0.01464 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.383 | L2-Norm(final)=11.530 | 5187.1 samples/s | 81.0 steps/s
[Step=32400 Epoch=158.9] | Loss=0.01410 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.400 | L2-Norm(final)=11.540 | 7055.0 samples/s | 110.2 steps/s
[Step=32450 Epoch=159.1] | Loss=0.01331 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.415 | L2-Norm(final)=11.550 | 1825.4 samples/s | 28.5 steps/s
[Step=32500 Epoch=159.4] | Loss=0.01269 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=11.561 | 5164.2 samples/s | 80.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=32501 Epoch=159.4] | Loss=0.00192 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.579 | L2-Norm(final)=11.674 | 3774.4 samples/s | 59.0 steps/s
[Step=32550 Epoch=159.6] | Loss=0.01167 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.593 | L2-Norm(final)=11.685 | 4161.4 samples/s | 65.0 steps/s
[Step=32600 Epoch=159.9] | Loss=0.01587 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.614 | L2-Norm(final)=11.689 | 4366.8 samples/s | 68.2 steps/s
[Step=32650 Epoch=160.1] | Loss=0.01623 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.635 | L2-Norm(final)=11.691 | 4401.5 samples/s | 68.8 steps/s
[Step=32700 Epoch=160.4] | Loss=0.01568 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.657 | L2-Norm(final)=11.696 | 5986.2 samples/s | 93.5 steps/s
[Step=32750 Epoch=160.6] | Loss=0.01456 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.675 | L2-Norm(final)=11.701 | 1754.4 samples/s | 27.4 steps/s
[Step=32800 Epoch=160.8] | Loss=0.01370 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.690 | L2-Norm(final)=11.706 | 4565.2 samples/s | 71.3 steps/s
[Step=32850 Epoch=161.1] | Loss=0.01278 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.703 | L2-Norm(final)=11.710 | 4517.1 samples/s | 70.6 steps/s
[Step=32900 Epoch=161.3] | Loss=0.01250 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.714 | L2-Norm(final)=11.714 | 5873.5 samples/s | 91.8 steps/s
[Step=32950 Epoch=161.6] | Loss=0.01189 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.725 | L2-Norm(final)=11.718 | 1799.5 samples/s | 28.1 steps/s
[Step=33000 Epoch=161.8] | Loss=0.01125 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.734 | L2-Norm(final)=11.722 | 4423.2 samples/s | 69.1 steps/s
[Step=33050 Epoch=162.1] | Loss=0.01087 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.742 | L2-Norm(final)=11.725 | 4779.8 samples/s | 74.7 steps/s
[Step=33100 Epoch=162.3] | Loss=0.01033 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.749 | L2-Norm(final)=11.728 | 5707.6 samples/s | 89.2 steps/s
[Step=33150 Epoch=162.6] | Loss=0.00985 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.756 | L2-Norm(final)=11.732 | 1774.4 samples/s | 27.7 steps/s
[Step=33200 Epoch=162.8] | Loss=0.00947 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.762 | L2-Norm(final)=11.735 | 4601.8 samples/s | 71.9 steps/s
[Step=33250 Epoch=163.1] | Loss=0.00916 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.767 | L2-Norm(final)=11.738 | 4474.4 samples/s | 69.9 steps/s
[Step=33300 Epoch=163.3] | Loss=0.00889 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.772 | L2-Norm(final)=11.741 | 5527.5 samples/s | 86.4 steps/s
[Step=33350 Epoch=163.5] | Loss=0.00852 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.777 | L2-Norm(final)=11.744 | 1826.5 samples/s | 28.5 steps/s
[Step=33400 Epoch=163.8] | Loss=0.00825 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.782 | L2-Norm(final)=11.747 | 4626.2 samples/s | 72.3 steps/s
[Step=33450 Epoch=164.0] | Loss=0.00802 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.786 | L2-Norm(final)=11.750 | 4584.3 samples/s | 71.6 steps/s
[Step=33500 Epoch=164.3] | Loss=0.00781 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.790 | L2-Norm(final)=11.752 | 5258.1 samples/s | 82.2 steps/s
[Step=33550 Epoch=164.5] | Loss=0.00762 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.793 | L2-Norm(final)=11.755 | 1840.9 samples/s | 28.8 steps/s
[Step=33600 Epoch=164.8] | Loss=0.00741 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.797 | L2-Norm(final)=11.758 | 4594.1 samples/s | 71.8 steps/s
[Step=33650 Epoch=165.0] | Loss=0.00722 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.800 | L2-Norm(final)=11.760 | 4613.3 samples/s | 72.1 steps/s
[Step=33700 Epoch=165.3] | Loss=0.00703 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.803 | L2-Norm(final)=11.763 | 5101.1 samples/s | 79.7 steps/s
[Step=33750 Epoch=165.5] | Loss=0.00695 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.806 | L2-Norm(final)=11.765 | 1851.1 samples/s | 28.9 steps/s
[Step=33800 Epoch=165.7] | Loss=0.00684 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.809 | L2-Norm(final)=11.767 | 4682.6 samples/s | 73.2 steps/s
[Step=33850 Epoch=166.0] | Loss=0.00667 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.811 | L2-Norm(final)=11.769 | 4636.3 samples/s | 72.4 steps/s
[Step=33900 Epoch=166.2] | Loss=0.00655 | Reg=0.00140 | acc=0.9844 | L2-Norm=11.814 | L2-Norm(final)=11.771 | 4712.1 samples/s | 73.6 steps/s
[Step=33950 Epoch=166.5] | Loss=0.00642 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.816 | L2-Norm(final)=11.773 | 1915.5 samples/s | 29.9 steps/s
[Step=34000 Epoch=166.7] | Loss=0.00635 | Reg=0.00140 | acc=1.0000 | L2-Norm=11.818 | L2-Norm(final)=11.776 | 4725.6 samples/s | 73.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step34000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=14001 Epoch=132.7] | Loss=0.02984 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.235 | L2-Norm(final)=6.284 | 3757.9 samples/s | 58.7 steps/s
[Step=14050 Epoch=133.1] | Loss=0.00268 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.311 | L2-Norm(final)=6.292 | 4377.1 samples/s | 68.4 steps/s
[Step=14100 Epoch=133.6] | Loss=0.00157 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=6.321 | 6960.5 samples/s | 108.8 steps/s
[Step=14150 Epoch=134.1] | Loss=0.00110 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.371 | L2-Norm(final)=6.341 | 1667.9 samples/s | 26.1 steps/s
[Step=14200 Epoch=134.6] | Loss=0.00086 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.377 | L2-Norm(final)=6.356 | 6006.1 samples/s | 93.8 steps/s
[Step=14250 Epoch=135.0] | Loss=0.00071 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.377 | L2-Norm(final)=6.369 | 1803.0 samples/s | 28.2 steps/s
[Step=14300 Epoch=135.5] | Loss=0.00061 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.375 | L2-Norm(final)=6.380 | 5808.3 samples/s | 90.8 steps/s
[Step=14350 Epoch=136.0] | Loss=0.00053 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.372 | L2-Norm(final)=6.390 | 1791.9 samples/s | 28.0 steps/s
[Step=14400 Epoch=136.5] | Loss=0.00047 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.368 | L2-Norm(final)=6.399 | 5357.9 samples/s | 83.7 steps/s
[Step=14450 Epoch=136.9] | Loss=0.00043 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.363 | L2-Norm(final)=6.408 | 1881.8 samples/s | 29.4 steps/s
[Step=14500 Epoch=137.4] | Loss=0.00039 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.358 | L2-Norm(final)=6.417 | 4958.8 samples/s | 77.5 steps/s
All layers training...
LR=0.00025, len=1
[Step=14501 Epoch=137.4] | Loss=0.00003 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.302 | L2-Norm(final)=6.499 | 3568.1 samples/s | 55.8 steps/s
[Step=14550 Epoch=137.9] | Loss=0.00006 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.281 | L2-Norm(final)=6.504 | 4185.8 samples/s | 65.4 steps/s
[Step=14600 Epoch=138.3] | Loss=0.00240 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.305 | L2-Norm(final)=6.505 | 5890.3 samples/s | 92.0 steps/s
[Step=14650 Epoch=138.8] | Loss=0.00200 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.346 | L2-Norm(final)=6.504 | 1677.0 samples/s | 26.2 steps/s
[Step=14700 Epoch=139.3] | Loss=0.00164 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.369 | L2-Norm(final)=6.506 | 5327.8 samples/s | 83.2 steps/s
[Step=14750 Epoch=139.8] | Loss=0.00132 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.383 | L2-Norm(final)=6.507 | 1752.3 samples/s | 27.4 steps/s
[Step=14800 Epoch=140.2] | Loss=0.00111 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.390 | L2-Norm(final)=6.508 | 5055.2 samples/s | 79.0 steps/s
[Step=14850 Epoch=140.7] | Loss=0.00095 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.393 | L2-Norm(final)=6.509 | 1789.7 samples/s | 28.0 steps/s
[Step=14900 Epoch=141.2] | Loss=0.00083 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.393 | L2-Norm(final)=6.510 | 4779.3 samples/s | 74.7 steps/s
[Step=14950 Epoch=141.7] | Loss=0.00074 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.392 | L2-Norm(final)=6.511 | 1828.0 samples/s | 28.6 steps/s
[Step=15000 Epoch=142.1] | Loss=0.00067 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.390 | L2-Norm(final)=6.512 | 4459.1 samples/s | 69.7 steps/s
[Step=15050 Epoch=142.6] | Loss=0.00061 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.387 | L2-Norm(final)=6.512 | 1876.4 samples/s | 29.3 steps/s
[Step=15100 Epoch=143.1] | Loss=0.00056 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.383 | L2-Norm(final)=6.513 | 4488.1 samples/s | 70.1 steps/s
[Step=15150 Epoch=143.6] | Loss=0.00051 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.379 | L2-Norm(final)=6.514 | 1848.2 samples/s | 28.9 steps/s
[Step=15200 Epoch=144.0] | Loss=0.00048 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.374 | L2-Norm(final)=6.514 | 4457.6 samples/s | 69.7 steps/s
[Step=15250 Epoch=144.5] | Loss=0.00045 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.369 | L2-Norm(final)=6.515 | 1864.4 samples/s | 29.1 steps/s
[Step=15300 Epoch=145.0] | Loss=0.00042 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.363 | L2-Norm(final)=6.515 | 4314.7 samples/s | 67.4 steps/s
[Step=15350 Epoch=145.5] | Loss=0.00039 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.358 | L2-Norm(final)=6.515 | 1920.6 samples/s | 30.0 steps/s
[Step=15400 Epoch=145.9] | Loss=0.00037 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=6.516 | 4173.0 samples/s | 65.2 steps/s
[Step=15450 Epoch=146.4] | Loss=0.00035 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.345 | L2-Norm(final)=6.516 | 5958.8 samples/s | 93.1 steps/s
[Step=15500 Epoch=146.9] | Loss=0.00034 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.339 | L2-Norm(final)=6.517 | 1647.7 samples/s | 25.7 steps/s
[Step=15550 Epoch=147.3] | Loss=0.00032 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.333 | L2-Norm(final)=6.517 | 5460.2 samples/s | 85.3 steps/s
[Step=15600 Epoch=147.8] | Loss=0.00031 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.326 | L2-Norm(final)=6.518 | 1726.1 samples/s | 27.0 steps/s
[Step=15650 Epoch=148.3] | Loss=0.00029 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.319 | L2-Norm(final)=6.518 | 5242.0 samples/s | 81.9 steps/s
[Step=15700 Epoch=148.8] | Loss=0.00028 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.313 | L2-Norm(final)=6.518 | 1768.0 samples/s | 27.6 steps/s
[Step=15750 Epoch=149.2] | Loss=0.00027 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.306 | L2-Norm(final)=6.519 | 4862.5 samples/s | 76.0 steps/s
[Step=15800 Epoch=149.7] | Loss=0.00026 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.298 | L2-Norm(final)=6.519 | 1806.6 samples/s | 28.2 steps/s
[Step=15850 Epoch=150.2] | Loss=0.00025 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.291 | L2-Norm(final)=6.519 | 4615.0 samples/s | 72.1 steps/s
[Step=15900 Epoch=150.7] | Loss=0.00024 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.284 | L2-Norm(final)=6.520 | 1885.6 samples/s | 29.5 steps/s
[Step=15950 Epoch=151.1] | Loss=0.00023 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.276 | L2-Norm(final)=6.520 | 4320.5 samples/s | 67.5 steps/s
[Step=16000 Epoch=151.6] | Loss=0.00023 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.269 | L2-Norm(final)=6.520 | 1891.4 samples/s | 29.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_0/client_state-step16000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=28001 Epoch=266.4] | Loss=0.02929 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.235 | L2-Norm(final)=8.638 | 3823.6 samples/s | 59.7 steps/s
[Step=28050 Epoch=266.8] | Loss=0.00404 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.313 | L2-Norm(final)=8.638 | 4353.7 samples/s | 68.0 steps/s
[Step=28100 Epoch=267.3] | Loss=0.00309 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.368 | L2-Norm(final)=8.645 | 6946.3 samples/s | 108.5 steps/s
[Step=28150 Epoch=267.8] | Loss=0.00216 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.403 | L2-Norm(final)=8.653 | 1735.1 samples/s | 27.1 steps/s
[Step=28200 Epoch=268.3] | Loss=0.00164 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.420 | L2-Norm(final)=8.659 | 5873.4 samples/s | 91.8 steps/s
[Step=28250 Epoch=268.7] | Loss=0.00136 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.430 | L2-Norm(final)=8.665 | 1825.5 samples/s | 28.5 steps/s
[Step=28300 Epoch=269.2] | Loss=0.00114 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.435 | L2-Norm(final)=8.670 | 5900.1 samples/s | 92.2 steps/s
[Step=28350 Epoch=269.7] | Loss=0.00099 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.438 | L2-Norm(final)=8.674 | 1795.9 samples/s | 28.1 steps/s
[Step=28400 Epoch=270.2] | Loss=0.00087 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.440 | L2-Norm(final)=8.678 | 5278.3 samples/s | 82.5 steps/s
[Step=28450 Epoch=270.6] | Loss=0.00078 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.440 | L2-Norm(final)=8.681 | 1868.9 samples/s | 29.2 steps/s
[Step=28500 Epoch=271.1] | Loss=0.00071 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.439 | L2-Norm(final)=8.685 | 5175.0 samples/s | 80.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=271.1] | Loss=0.00005 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.426 | L2-Norm(final)=8.717 | 3671.8 samples/s | 57.4 steps/s
[Step=28550 Epoch=271.6] | Loss=0.00004 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.416 | L2-Norm(final)=8.719 | 4133.0 samples/s | 64.6 steps/s
[Step=28600 Epoch=272.1] | Loss=0.00003 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.404 | L2-Norm(final)=8.721 | 5787.4 samples/s | 90.4 steps/s
[Step=28650 Epoch=272.5] | Loss=0.00002 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.390 | L2-Norm(final)=8.722 | 1712.2 samples/s | 26.8 steps/s
[Step=28700 Epoch=273.0] | Loss=0.00002 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.376 | L2-Norm(final)=8.723 | 5470.5 samples/s | 85.5 steps/s
[Step=28750 Epoch=273.5] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.362 | L2-Norm(final)=8.723 | 1754.1 samples/s | 27.4 steps/s
[Step=28800 Epoch=274.0] | Loss=0.00001 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.347 | L2-Norm(final)=8.724 | 5116.7 samples/s | 79.9 steps/s
[Step=28850 Epoch=274.4] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.331 | L2-Norm(final)=8.724 | 1771.8 samples/s | 27.7 steps/s
[Step=28900 Epoch=274.9] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.316 | L2-Norm(final)=8.724 | 4820.5 samples/s | 75.3 steps/s
[Step=28950 Epoch=275.4] | Loss=0.00001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.301 | L2-Norm(final)=8.725 | 1848.4 samples/s | 28.9 steps/s
[Step=29000 Epoch=275.9] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.285 | L2-Norm(final)=8.725 | 4358.0 samples/s | 68.1 steps/s
[Step=29050 Epoch=276.3] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.269 | L2-Norm(final)=8.726 | 1856.3 samples/s | 29.0 steps/s
[Step=29100 Epoch=276.8] | Loss=0.00001 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.253 | L2-Norm(final)=8.726 | 4425.8 samples/s | 69.2 steps/s
[Step=29150 Epoch=277.3] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.237 | L2-Norm(final)=8.726 | 1848.4 samples/s | 28.9 steps/s
[Step=29200 Epoch=277.8] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.221 | L2-Norm(final)=8.727 | 4396.3 samples/s | 68.7 steps/s
[Step=29250 Epoch=278.2] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.205 | L2-Norm(final)=8.727 | 1901.9 samples/s | 29.7 steps/s
[Step=29300 Epoch=278.7] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.188 | L2-Norm(final)=8.727 | 4071.2 samples/s | 63.6 steps/s
[Step=29350 Epoch=279.2] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.171 | L2-Norm(final)=8.727 | 1915.4 samples/s | 29.9 steps/s
[Step=29400 Epoch=279.7] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.154 | L2-Norm(final)=8.728 | 4079.1 samples/s | 63.7 steps/s
[Step=29450 Epoch=280.1] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.137 | L2-Norm(final)=8.728 | 6122.9 samples/s | 95.7 steps/s
[Step=29500 Epoch=280.6] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.120 | L2-Norm(final)=8.728 | 1665.8 samples/s | 26.0 steps/s
[Step=29550 Epoch=281.1] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.103 | L2-Norm(final)=8.729 | 5594.9 samples/s | 87.4 steps/s
[Step=29600 Epoch=281.6] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.085 | L2-Norm(final)=8.729 | 1744.1 samples/s | 27.3 steps/s
[Step=29650 Epoch=282.0] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.067 | L2-Norm(final)=8.729 | 5263.3 samples/s | 82.2 steps/s
[Step=29700 Epoch=282.5] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.050 | L2-Norm(final)=8.729 | 1739.5 samples/s | 27.2 steps/s
[Step=29750 Epoch=283.0] | Loss=0.00000 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.032 | L2-Norm(final)=8.730 | 4908.7 samples/s | 76.7 steps/s
[Step=29800 Epoch=283.5] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.013 | L2-Norm(final)=8.730 | 1802.3 samples/s | 28.2 steps/s
[Step=29850 Epoch=283.9] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.995 | L2-Norm(final)=8.730 | 4670.0 samples/s | 73.0 steps/s
[Step=29900 Epoch=284.4] | Loss=0.00000 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.977 | L2-Norm(final)=8.730 | 1841.9 samples/s | 28.8 steps/s
[Step=29950 Epoch=284.9] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.958 | L2-Norm(final)=8.731 | 4480.6 samples/s | 70.0 steps/s
[Step=30000 Epoch=285.4] | Loss=0.00000 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.939 | L2-Norm(final)=8.731 | 1857.6 samples/s | 29.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step30000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=22001 Epoch=207.3] | Loss=0.01454 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.235 | L2-Norm(final)=8.100 | 3833.8 samples/s | 59.9 steps/s
[Step=22050 Epoch=207.8] | Loss=0.00471 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.308 | L2-Norm(final)=8.089 | 4337.6 samples/s | 67.8 steps/s
[Step=22100 Epoch=208.2] | Loss=0.00279 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.362 | L2-Norm(final)=8.096 | 6993.1 samples/s | 109.3 steps/s
[Step=22150 Epoch=208.7] | Loss=0.00194 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.383 | L2-Norm(final)=8.103 | 1777.0 samples/s | 27.8 steps/s
[Step=22200 Epoch=209.2] | Loss=0.00149 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.392 | L2-Norm(final)=8.110 | 5960.8 samples/s | 93.1 steps/s
[Step=22250 Epoch=209.7] | Loss=0.00122 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.395 | L2-Norm(final)=8.116 | 1772.6 samples/s | 27.7 steps/s
[Step=22300 Epoch=210.1] | Loss=0.00103 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.396 | L2-Norm(final)=8.122 | 5516.1 samples/s | 86.2 steps/s
[Step=22350 Epoch=210.6] | Loss=0.00089 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.395 | L2-Norm(final)=8.127 | 1878.7 samples/s | 29.4 steps/s
[Step=22400 Epoch=211.1] | Loss=0.00079 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.393 | L2-Norm(final)=8.131 | 5218.3 samples/s | 81.5 steps/s
[Step=22450 Epoch=211.5] | Loss=0.00071 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.390 | L2-Norm(final)=8.136 | 1923.9 samples/s | 30.1 steps/s
[Step=22500 Epoch=212.0] | Loss=0.00064 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.387 | L2-Norm(final)=8.140 | 4880.4 samples/s | 76.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=212.0] | Loss=0.00005 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.352 | L2-Norm(final)=8.182 | 3460.9 samples/s | 54.1 steps/s
[Step=22550 Epoch=212.5] | Loss=0.00004 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=8.185 | 4533.2 samples/s | 70.8 steps/s
[Step=22600 Epoch=213.0] | Loss=0.00004 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.329 | L2-Norm(final)=8.188 | 5919.5 samples/s | 92.5 steps/s
[Step=22650 Epoch=213.4] | Loss=0.00003 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.316 | L2-Norm(final)=8.189 | 1704.8 samples/s | 26.6 steps/s
[Step=22700 Epoch=213.9] | Loss=0.00002 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.301 | L2-Norm(final)=8.191 | 5263.2 samples/s | 82.2 steps/s
[Step=22750 Epoch=214.4] | Loss=0.00002 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=8.192 | 1687.2 samples/s | 26.4 steps/s
[Step=22800 Epoch=214.8] | Loss=0.00002 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.272 | L2-Norm(final)=8.192 | 4556.0 samples/s | 71.2 steps/s
[Step=22850 Epoch=215.3] | Loss=0.00002 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.256 | L2-Norm(final)=8.193 | 1782.8 samples/s | 27.9 steps/s
[Step=22900 Epoch=215.8] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.241 | L2-Norm(final)=8.194 | 4628.7 samples/s | 72.3 steps/s
[Step=22950 Epoch=216.3] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.225 | L2-Norm(final)=8.194 | 1843.1 samples/s | 28.8 steps/s
[Step=23000 Epoch=216.7] | Loss=0.00001 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.209 | L2-Norm(final)=8.195 | 4466.2 samples/s | 69.8 steps/s
[Step=23050 Epoch=217.2] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.193 | L2-Norm(final)=8.195 | 1891.5 samples/s | 29.6 steps/s
[Step=23100 Epoch=217.7] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.177 | L2-Norm(final)=8.196 | 4563.2 samples/s | 71.3 steps/s
[Step=23150 Epoch=218.1] | Loss=0.00001 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.160 | L2-Norm(final)=8.196 | 1900.8 samples/s | 29.7 steps/s
[Step=23200 Epoch=218.6] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.144 | L2-Norm(final)=8.197 | 4400.2 samples/s | 68.8 steps/s
[Step=23250 Epoch=219.1] | Loss=0.00001 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.127 | L2-Norm(final)=8.197 | 1991.9 samples/s | 31.1 steps/s
[Step=23300 Epoch=219.6] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.111 | L2-Norm(final)=8.198 | 4199.4 samples/s | 65.6 steps/s
[Step=23350 Epoch=220.0] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.094 | L2-Norm(final)=8.198 | 5745.4 samples/s | 89.8 steps/s
[Step=23400 Epoch=220.5] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.077 | L2-Norm(final)=8.199 | 1710.8 samples/s | 26.7 steps/s
[Step=23450 Epoch=221.0] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.060 | L2-Norm(final)=8.199 | 5322.9 samples/s | 83.2 steps/s
[Step=23500 Epoch=221.4] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.042 | L2-Norm(final)=8.199 | 1651.5 samples/s | 25.8 steps/s
[Step=23550 Epoch=221.9] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.025 | L2-Norm(final)=8.200 | 4736.3 samples/s | 74.0 steps/s
[Step=23600 Epoch=222.4] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.007 | L2-Norm(final)=8.200 | 1775.9 samples/s | 27.7 steps/s
[Step=23650 Epoch=222.9] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.989 | L2-Norm(final)=8.201 | 4613.1 samples/s | 72.1 steps/s
[Step=23700 Epoch=223.3] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.971 | L2-Norm(final)=8.201 | 1835.3 samples/s | 28.7 steps/s
[Step=23750 Epoch=223.8] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.953 | L2-Norm(final)=8.201 | 4568.2 samples/s | 71.4 steps/s
[Step=23800 Epoch=224.3] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.935 | L2-Norm(final)=8.202 | 1841.3 samples/s | 28.8 steps/s
[Step=23850 Epoch=224.7] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.917 | L2-Norm(final)=8.202 | 4432.4 samples/s | 69.3 steps/s
[Step=23900 Epoch=225.2] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.899 | L2-Norm(final)=8.203 | 1897.2 samples/s | 29.6 steps/s
[Step=23950 Epoch=225.7] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=8.203 | 4378.0 samples/s | 68.4 steps/s
[Step=24000 Epoch=226.1] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.861 | L2-Norm(final)=8.203 | 1956.6 samples/s | 30.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09438 | acc=0.9609 | tpr=0.9795 | fpr=0.0795 | 4147.6 samples/s | 16.2 steps/s
Avg test loss: 0.09750, Avg test acc: 0.95921, Avg tpr: 0.97855, Avg fpr: 0.08332, total FA: 650

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09252 | acc=0.9594 | tpr=0.9742 | fpr=0.0728 | 4173.6 samples/s | 16.3 steps/s
Avg test loss: 0.09752, Avg test acc: 0.95909, Avg tpr: 0.97377, Avg fpr: 0.07320, total FA: 571

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09768 | acc=0.9595 | tpr=0.9728 | fpr=0.0696 | 4114.9 samples/s | 16.1 steps/s
Avg test loss: 0.10295, Avg test acc: 0.95889, Avg tpr: 0.97162, Avg fpr: 0.06909, total FA: 539

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09689 | acc=0.9593 | tpr=0.9765 | fpr=0.0780 | 4089.9 samples/s | 16.0 steps/s
Avg test loss: 0.09938, Avg test acc: 0.95941, Avg tpr: 0.97651, Avg fpr: 0.07820, total FA: 610

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.09521 | acc=0.9609 | tpr=0.9686 | fpr=0.0560 | 4120.6 samples/s | 16.1 steps/s
Avg test loss: 0.10246, Avg test acc: 0.95849, Avg tpr: 0.96666, Avg fpr: 0.05948, total FA: 464

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.54090 | acc=0.2870 | tpr=0.0041 | fpr=0.0989 | 4151.7 samples/s | 16.2 steps/s
Avg test loss: 5.55423, Avg test acc: 0.28396, Avg tpr: 0.00437, Avg fpr: 0.10114, total FA: 789

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.91304 | acc=0.3082 | tpr=0.0047 | fpr=0.0327 | 4012.9 samples/s | 15.7 steps/s
Avg test loss: 4.91786, Avg test acc: 0.30639, Avg tpr: 0.00670, Avg fpr: 0.03448, total FA: 269

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.12189 | acc=0.2948 | tpr=0.0076 | fpr=0.0815 | 3943.3 samples/s | 15.4 steps/s
Avg test loss: 5.13500, Avg test acc: 0.29353, Avg tpr: 0.00892, Avg fpr: 0.08050, total FA: 628

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.23499 | acc=0.2984 | tpr=0.0055 | fpr=0.0654 | 4087.1 samples/s | 16.0 steps/s
Avg test loss: 5.24287, Avg test acc: 0.29678, Avg tpr: 0.00647, Avg fpr: 0.06474, total FA: 505

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.89511 | acc=0.3116 | tpr=0.0024 | fpr=0.0171 | 4093.8 samples/s | 16.0 steps/s
Avg test loss: 4.90047, Avg test acc: 0.30916, Avg tpr: 0.00344, Avg fpr: 0.01846, total FA: 144

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.76400 | acc=0.1053 | tpr=0.9115 | fpr=0.9092 | 4145.1 samples/s | 16.2 steps/s
[Step= 100] | Loss=5.71192 | acc=0.1064 | tpr=0.8913 | fpr=0.9082 | 7971.7 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.72043 | acc=0.1038 | tpr=0.8991 | fpr=0.9108 | 7504.5 samples/s | 29.3 steps/s
[Step= 200] | Loss=5.71928 | acc=0.1028 | tpr=0.8962 | fpr=0.9116 | 7582.5 samples/s | 29.6 steps/s
[Step= 250] | Loss=5.72292 | acc=0.1030 | tpr=0.8917 | fpr=0.9113 | 7948.7 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.71878 | acc=0.1028 | tpr=0.8880 | fpr=0.9115 | 7662.5 samples/s | 29.9 steps/s
[Step= 350] | Loss=5.71599 | acc=0.1025 | tpr=0.8817 | fpr=0.9117 | 7954.6 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.71714 | acc=0.1031 | tpr=0.8786 | fpr=0.9110 | 8046.1 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.72063 | acc=0.1027 | tpr=0.8724 | fpr=0.9112 | 8082.7 samples/s | 31.6 steps/s
[Step= 500] | Loss=5.72196 | acc=0.1026 | tpr=0.8736 | fpr=0.9113 | 7922.4 samples/s | 30.9 steps/s
[Step= 550] | Loss=5.72283 | acc=0.1025 | tpr=0.8774 | fpr=0.9116 | 14158.3 samples/s | 55.3 steps/s
Avg test loss: 5.72416, Avg test acc: 0.10241, Avg tpr: 0.87718, Avg fpr: 0.91167, total FA: 126584

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.85811 | acc=0.1286 | tpr=0.7920 | fpr=0.8833 | 4222.6 samples/s | 16.5 steps/s
[Step= 100] | Loss=4.80342 | acc=0.1306 | tpr=0.7612 | fpr=0.8811 | 7533.1 samples/s | 29.4 steps/s
[Step= 150] | Loss=4.81098 | acc=0.1284 | tpr=0.7507 | fpr=0.8831 | 7877.6 samples/s | 30.8 steps/s
[Step= 200] | Loss=4.80811 | acc=0.1280 | tpr=0.7366 | fpr=0.8831 | 7738.8 samples/s | 30.2 steps/s
[Step= 250] | Loss=4.80801 | acc=0.1280 | tpr=0.7336 | fpr=0.8830 | 7615.9 samples/s | 29.7 steps/s
[Step= 300] | Loss=4.80763 | acc=0.1274 | tpr=0.7360 | fpr=0.8836 | 7960.0 samples/s | 31.1 steps/s
[Step= 350] | Loss=4.80297 | acc=0.1269 | tpr=0.7314 | fpr=0.8841 | 7823.1 samples/s | 30.6 steps/s
[Step= 400] | Loss=4.80360 | acc=0.1272 | tpr=0.7314 | fpr=0.8838 | 8023.0 samples/s | 31.3 steps/s
[Step= 450] | Loss=4.80847 | acc=0.1272 | tpr=0.7259 | fpr=0.8836 | 7733.9 samples/s | 30.2 steps/s
[Step= 500] | Loss=4.81384 | acc=0.1268 | tpr=0.7216 | fpr=0.8839 | 7065.6 samples/s | 27.6 steps/s
[Step= 550] | Loss=4.81394 | acc=0.1268 | tpr=0.7226 | fpr=0.8840 | 13885.5 samples/s | 54.2 steps/s
Avg test loss: 4.81498, Avg test acc: 0.12675, Avg tpr: 0.72266, Avg fpr: 0.88408, total FA: 122753

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.17457 | acc=0.1120 | tpr=0.7699 | fpr=0.8999 | 4084.6 samples/s | 16.0 steps/s
[Step= 100] | Loss=6.11646 | acc=0.1143 | tpr=0.7484 | fpr=0.8975 | 8043.4 samples/s | 31.4 steps/s
[Step= 150] | Loss=6.12945 | acc=0.1121 | tpr=0.7608 | fpr=0.8998 | 8712.5 samples/s | 34.0 steps/s
[Step= 200] | Loss=6.13057 | acc=0.1116 | tpr=0.7574 | fpr=0.9001 | 7130.0 samples/s | 27.9 steps/s
[Step= 250] | Loss=6.13295 | acc=0.1120 | tpr=0.7616 | fpr=0.8999 | 7979.2 samples/s | 31.2 steps/s
[Step= 300] | Loss=6.12957 | acc=0.1118 | tpr=0.7629 | fpr=0.9001 | 7500.9 samples/s | 29.3 steps/s
[Step= 350] | Loss=6.12785 | acc=0.1115 | tpr=0.7564 | fpr=0.9002 | 7829.6 samples/s | 30.6 steps/s
[Step= 400] | Loss=6.12920 | acc=0.1120 | tpr=0.7560 | fpr=0.8997 | 8252.2 samples/s | 32.2 steps/s
[Step= 450] | Loss=6.13266 | acc=0.1114 | tpr=0.7537 | fpr=0.9003 | 7663.4 samples/s | 29.9 steps/s
[Step= 500] | Loss=6.13389 | acc=0.1112 | tpr=0.7529 | fpr=0.9004 | 7958.5 samples/s | 31.1 steps/s
[Step= 550] | Loss=6.13255 | acc=0.1111 | tpr=0.7573 | fpr=0.9006 | 14346.7 samples/s | 56.0 steps/s
Avg test loss: 6.13418, Avg test acc: 0.11106, Avg tpr: 0.75674, Avg fpr: 0.90068, total FA: 125057

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.53913 | acc=0.1194 | tpr=0.7566 | fpr=0.8921 | 4040.6 samples/s | 15.8 steps/s
[Step= 100] | Loss=5.49155 | acc=0.1204 | tpr=0.7292 | fpr=0.8910 | 8112.2 samples/s | 31.7 steps/s
[Step= 150] | Loss=5.49394 | acc=0.1183 | tpr=0.7262 | fpr=0.8929 | 8027.6 samples/s | 31.4 steps/s
[Step= 200] | Loss=5.48788 | acc=0.1173 | tpr=0.7191 | fpr=0.8936 | 7882.6 samples/s | 30.8 steps/s
[Step= 250] | Loss=5.48810 | acc=0.1174 | tpr=0.7284 | fpr=0.8937 | 7173.6 samples/s | 28.0 steps/s
[Step= 300] | Loss=5.48825 | acc=0.1170 | tpr=0.7316 | fpr=0.8942 | 7742.9 samples/s | 30.2 steps/s
[Step= 350] | Loss=5.48257 | acc=0.1170 | tpr=0.7276 | fpr=0.8941 | 7922.8 samples/s | 30.9 steps/s
[Step= 400] | Loss=5.48479 | acc=0.1168 | tpr=0.7210 | fpr=0.8942 | 7795.7 samples/s | 30.5 steps/s
[Step= 450] | Loss=5.48994 | acc=0.1166 | tpr=0.7181 | fpr=0.8943 | 8093.0 samples/s | 31.6 steps/s
[Step= 500] | Loss=5.49344 | acc=0.1164 | tpr=0.7207 | fpr=0.8945 | 7730.1 samples/s | 30.2 steps/s
[Step= 550] | Loss=5.49296 | acc=0.1163 | tpr=0.7214 | fpr=0.8947 | 13732.9 samples/s | 53.6 steps/s
Avg test loss: 5.49441, Avg test acc: 0.11626, Avg tpr: 0.72108, Avg fpr: 0.89473, total FA: 124232

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.57176 | acc=0.1241 | tpr=0.6106 | fpr=0.8846 | 3848.1 samples/s | 15.0 steps/s
[Step= 100] | Loss=5.51102 | acc=0.1263 | tpr=0.5629 | fpr=0.8818 | 7429.2 samples/s | 29.0 steps/s
[Step= 150] | Loss=5.51292 | acc=0.1252 | tpr=0.5591 | fpr=0.8828 | 7964.0 samples/s | 31.1 steps/s
[Step= 200] | Loss=5.50918 | acc=0.1250 | tpr=0.5607 | fpr=0.8830 | 7908.9 samples/s | 30.9 steps/s
[Step= 250] | Loss=5.51396 | acc=0.1249 | tpr=0.5581 | fpr=0.8830 | 7483.9 samples/s | 29.2 steps/s
[Step= 300] | Loss=5.50873 | acc=0.1245 | tpr=0.5615 | fpr=0.8834 | 7757.5 samples/s | 30.3 steps/s
[Step= 350] | Loss=5.50437 | acc=0.1241 | tpr=0.5548 | fpr=0.8837 | 8192.2 samples/s | 32.0 steps/s
[Step= 400] | Loss=5.50727 | acc=0.1243 | tpr=0.5509 | fpr=0.8834 | 7925.9 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.50866 | acc=0.1240 | tpr=0.5448 | fpr=0.8836 | 8235.2 samples/s | 32.2 steps/s
[Step= 500] | Loss=5.50981 | acc=0.1237 | tpr=0.5388 | fpr=0.8837 | 7930.5 samples/s | 31.0 steps/s
[Step= 550] | Loss=5.51077 | acc=0.1235 | tpr=0.5376 | fpr=0.8840 | 14286.4 samples/s | 55.8 steps/s
Avg test loss: 5.51300, Avg test acc: 0.12345, Avg tpr: 0.53764, Avg fpr: 0.88408, total FA: 122753

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10942 | acc=0.9820 | tpr=0.9248 | fpr=0.0169 | 4021.6 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.11229 | acc=0.9817 | tpr=0.9382 | fpr=0.0175 | 8038.9 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.11732 | acc=0.9803 | tpr=0.9380 | fpr=0.0189 | 8117.1 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.11919 | acc=0.9803 | tpr=0.9388 | fpr=0.0190 | 7998.7 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.11829 | acc=0.9802 | tpr=0.9345 | fpr=0.0189 | 7899.7 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.12064 | acc=0.9799 | tpr=0.9309 | fpr=0.0192 | 7593.9 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.12082 | acc=0.9796 | tpr=0.9305 | fpr=0.0195 | 8411.9 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.12244 | acc=0.9794 | tpr=0.9272 | fpr=0.0196 | 7866.2 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.12531 | acc=0.9791 | tpr=0.9279 | fpr=0.0200 | 8112.7 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.12511 | acc=0.9791 | tpr=0.9291 | fpr=0.0200 | 7882.7 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.12387 | acc=0.9792 | tpr=0.9268 | fpr=0.0199 | 14380.5 samples/s | 56.2 steps/s
Avg test loss: 0.12373, Avg test acc: 0.97920, Avg tpr: 0.92631, Avg fpr: 0.01984, total FA: 2755

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12098 | acc=0.9810 | tpr=0.8938 | fpr=0.0174 | 4111.3 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.12524 | acc=0.9804 | tpr=0.9083 | fpr=0.0182 | 8080.7 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.13038 | acc=0.9795 | tpr=0.9063 | fpr=0.0192 | 8343.4 samples/s | 32.6 steps/s
[Step= 200] | Loss=0.13214 | acc=0.9796 | tpr=0.9148 | fpr=0.0192 | 8174.8 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.13045 | acc=0.9797 | tpr=0.9135 | fpr=0.0191 | 7993.0 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.13274 | acc=0.9792 | tpr=0.9120 | fpr=0.0196 | 8279.5 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.13276 | acc=0.9792 | tpr=0.9167 | fpr=0.0197 | 7788.2 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.13414 | acc=0.9789 | tpr=0.9125 | fpr=0.0198 | 8133.8 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.13748 | acc=0.9787 | tpr=0.9114 | fpr=0.0201 | 8317.4 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.13673 | acc=0.9788 | tpr=0.9150 | fpr=0.0201 | 7575.4 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.13557 | acc=0.9789 | tpr=0.9152 | fpr=0.0199 | 15146.4 samples/s | 59.2 steps/s
Avg test loss: 0.13535, Avg test acc: 0.97895, Avg tpr: 0.91442, Avg fpr: 0.01988, total FA: 2760

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11349 | acc=0.9790 | tpr=0.9336 | fpr=0.0202 | 4050.9 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.11761 | acc=0.9787 | tpr=0.9531 | fpr=0.0209 | 8077.5 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.12190 | acc=0.9780 | tpr=0.9524 | fpr=0.0216 | 8057.5 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.12437 | acc=0.9778 | tpr=0.9552 | fpr=0.0218 | 7799.8 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.12331 | acc=0.9778 | tpr=0.9537 | fpr=0.0218 | 7941.3 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.12549 | acc=0.9774 | tpr=0.9542 | fpr=0.0222 | 7727.5 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.12543 | acc=0.9773 | tpr=0.9549 | fpr=0.0223 | 7360.7 samples/s | 28.8 steps/s
[Step= 400] | Loss=0.12688 | acc=0.9771 | tpr=0.9519 | fpr=0.0224 | 7361.9 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.12985 | acc=0.9768 | tpr=0.9513 | fpr=0.0227 | 7459.6 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.12944 | acc=0.9769 | tpr=0.9529 | fpr=0.0227 | 8258.4 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.12812 | acc=0.9771 | tpr=0.9534 | fpr=0.0225 | 14588.9 samples/s | 57.0 steps/s
Avg test loss: 0.12796, Avg test acc: 0.97707, Avg tpr: 0.95325, Avg fpr: 0.02250, total FA: 3124

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11873 | acc=0.9810 | tpr=0.9204 | fpr=0.0179 | 4104.3 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.12356 | acc=0.9802 | tpr=0.9403 | fpr=0.0191 | 7674.6 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.12842 | acc=0.9795 | tpr=0.9395 | fpr=0.0198 | 8059.0 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.13058 | acc=0.9793 | tpr=0.9443 | fpr=0.0201 | 8433.9 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.12923 | acc=0.9791 | tpr=0.9397 | fpr=0.0202 | 7680.3 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.13139 | acc=0.9787 | tpr=0.9396 | fpr=0.0206 | 8305.9 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.13136 | acc=0.9786 | tpr=0.9424 | fpr=0.0207 | 7929.9 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.13256 | acc=0.9785 | tpr=0.9387 | fpr=0.0208 | 7745.3 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.13584 | acc=0.9781 | tpr=0.9367 | fpr=0.0211 | 7826.5 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.13547 | acc=0.9782 | tpr=0.9388 | fpr=0.0211 | 7584.9 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.13455 | acc=0.9784 | tpr=0.9391 | fpr=0.0209 | 14969.0 samples/s | 58.5 steps/s
Avg test loss: 0.13438, Avg test acc: 0.97834, Avg tpr: 0.93819, Avg fpr: 0.02093, total FA: 2906

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12635 | acc=0.9791 | tpr=0.9248 | fpr=0.0200 | 4059.1 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.13165 | acc=0.9789 | tpr=0.9446 | fpr=0.0205 | 7905.4 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.13678 | acc=0.9779 | tpr=0.9424 | fpr=0.0214 | 7414.9 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.13941 | acc=0.9777 | tpr=0.9464 | fpr=0.0218 | 7566.2 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.13805 | acc=0.9777 | tpr=0.9450 | fpr=0.0217 | 8053.8 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.14073 | acc=0.9772 | tpr=0.9455 | fpr=0.0222 | 8581.4 samples/s | 33.5 steps/s
[Step= 350] | Loss=0.14090 | acc=0.9771 | tpr=0.9474 | fpr=0.0224 | 7704.6 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.14248 | acc=0.9769 | tpr=0.9426 | fpr=0.0225 | 8120.8 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.14563 | acc=0.9765 | tpr=0.9416 | fpr=0.0229 | 7834.9 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.14508 | acc=0.9765 | tpr=0.9419 | fpr=0.0229 | 7385.9 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.14413 | acc=0.9767 | tpr=0.9407 | fpr=0.0227 | 13585.9 samples/s | 53.1 steps/s
Avg test loss: 0.14390, Avg test acc: 0.97667, Avg tpr: 0.94057, Avg fpr: 0.02267, total FA: 3148

server round 27/50

clients selected: [0 1 3 5 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=24001 Epoch=117.0] | Loss=0.02008 | Reg=0.00124 | acc=0.9688 | L2-Norm=11.125 | L2-Norm(final)=9.756 | 3632.9 samples/s | 56.8 steps/s
[Step=24050 Epoch=117.3] | Loss=0.01788 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.143 | L2-Norm(final)=9.752 | 4376.8 samples/s | 68.4 steps/s
[Step=24100 Epoch=117.5] | Loss=0.02258 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.169 | L2-Norm(final)=9.752 | 4943.3 samples/s | 77.2 steps/s
[Step=24150 Epoch=117.8] | Loss=0.02126 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.194 | L2-Norm(final)=9.754 | 4820.9 samples/s | 75.3 steps/s
[Step=24200 Epoch=118.0] | Loss=0.02087 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.216 | L2-Norm(final)=9.758 | 7214.6 samples/s | 112.7 steps/s
[Step=24250 Epoch=118.2] | Loss=0.02004 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.238 | L2-Norm(final)=9.764 | 1763.6 samples/s | 27.6 steps/s
[Step=24300 Epoch=118.5] | Loss=0.01861 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.259 | L2-Norm(final)=9.772 | 4853.3 samples/s | 75.8 steps/s
[Step=24350 Epoch=118.7] | Loss=0.01800 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.279 | L2-Norm(final)=9.781 | 5299.3 samples/s | 82.8 steps/s
[Step=24400 Epoch=119.0] | Loss=0.01768 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.298 | L2-Norm(final)=9.791 | 7085.5 samples/s | 110.7 steps/s
[Step=24450 Epoch=119.2] | Loss=0.01688 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.316 | L2-Norm(final)=9.802 | 1880.9 samples/s | 29.4 steps/s
[Step=24500 Epoch=119.5] | Loss=0.01613 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.334 | L2-Norm(final)=9.813 | 5072.8 samples/s | 79.3 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=119.5] | Loss=0.01902 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.508 | L2-Norm(final)=9.932 | 3698.2 samples/s | 57.8 steps/s
[Step=24550 Epoch=119.7] | Loss=0.01626 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.534 | L2-Norm(final)=9.945 | 4390.3 samples/s | 68.6 steps/s
[Step=24600 Epoch=120.0] | Loss=0.01880 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.561 | L2-Norm(final)=9.952 | 4614.5 samples/s | 72.1 steps/s
[Step=24650 Epoch=120.2] | Loss=0.01923 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.584 | L2-Norm(final)=9.957 | 4545.8 samples/s | 71.0 steps/s
[Step=24700 Epoch=120.4] | Loss=0.01848 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.605 | L2-Norm(final)=9.961 | 6098.1 samples/s | 95.3 steps/s
[Step=24750 Epoch=120.7] | Loss=0.01757 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.623 | L2-Norm(final)=9.966 | 1778.9 samples/s | 27.8 steps/s
[Step=24800 Epoch=120.9] | Loss=0.01617 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.639 | L2-Norm(final)=9.972 | 4451.3 samples/s | 69.6 steps/s
[Step=24850 Epoch=121.2] | Loss=0.01500 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.652 | L2-Norm(final)=9.977 | 4514.3 samples/s | 70.5 steps/s
[Step=24900 Epoch=121.4] | Loss=0.01408 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.665 | L2-Norm(final)=9.983 | 5733.9 samples/s | 89.6 steps/s
[Step=24950 Epoch=121.7] | Loss=0.01340 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.677 | L2-Norm(final)=9.989 | 1820.2 samples/s | 28.4 steps/s
[Step=25000 Epoch=121.9] | Loss=0.01286 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.688 | L2-Norm(final)=9.995 | 4688.1 samples/s | 73.3 steps/s
[Step=25050 Epoch=122.1] | Loss=0.01232 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.698 | L2-Norm(final)=10.000 | 4557.9 samples/s | 71.2 steps/s
[Step=25100 Epoch=122.4] | Loss=0.01195 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.707 | L2-Norm(final)=10.004 | 5382.5 samples/s | 84.1 steps/s
[Step=25150 Epoch=122.6] | Loss=0.01151 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.715 | L2-Norm(final)=10.009 | 1845.6 samples/s | 28.8 steps/s
[Step=25200 Epoch=122.9] | Loss=0.01112 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.723 | L2-Norm(final)=10.013 | 4663.8 samples/s | 72.9 steps/s
[Step=25250 Epoch=123.1] | Loss=0.01091 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.730 | L2-Norm(final)=10.017 | 4643.4 samples/s | 72.6 steps/s
[Step=25300 Epoch=123.4] | Loss=0.01046 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.736 | L2-Norm(final)=10.021 | 5061.7 samples/s | 79.1 steps/s
[Step=25350 Epoch=123.6] | Loss=0.01007 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.742 | L2-Norm(final)=10.024 | 1870.5 samples/s | 29.2 steps/s
[Step=25400 Epoch=123.9] | Loss=0.00979 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.748 | L2-Norm(final)=10.028 | 4689.0 samples/s | 73.3 steps/s
[Step=25450 Epoch=124.1] | Loss=0.00950 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.752 | L2-Norm(final)=10.031 | 4672.6 samples/s | 73.0 steps/s
[Step=25500 Epoch=124.3] | Loss=0.00929 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.757 | L2-Norm(final)=10.034 | 4647.8 samples/s | 72.6 steps/s
[Step=25550 Epoch=124.6] | Loss=0.00905 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.761 | L2-Norm(final)=10.037 | 1904.4 samples/s | 29.8 steps/s
[Step=25600 Epoch=124.8] | Loss=0.00880 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.766 | L2-Norm(final)=10.040 | 4662.2 samples/s | 72.8 steps/s
[Step=25650 Epoch=125.1] | Loss=0.00857 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.770 | L2-Norm(final)=10.043 | 4556.9 samples/s | 71.2 steps/s
[Step=25700 Epoch=125.3] | Loss=0.00841 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.773 | L2-Norm(final)=10.046 | 4644.0 samples/s | 72.6 steps/s
[Step=25750 Epoch=125.6] | Loss=0.00823 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.777 | L2-Norm(final)=10.049 | 1909.9 samples/s | 29.8 steps/s
[Step=25800 Epoch=125.8] | Loss=0.00803 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.780 | L2-Norm(final)=10.052 | 4651.3 samples/s | 72.7 steps/s
[Step=25850 Epoch=126.0] | Loss=0.00796 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.784 | L2-Norm(final)=10.055 | 4431.8 samples/s | 69.2 steps/s
[Step=25900 Epoch=126.3] | Loss=0.00783 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.787 | L2-Norm(final)=10.057 | 4461.7 samples/s | 69.7 steps/s
[Step=25950 Epoch=126.5] | Loss=0.00766 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.790 | L2-Norm(final)=10.060 | 1955.7 samples/s | 30.6 steps/s
[Step=26000 Epoch=126.8] | Loss=0.00750 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.793 | L2-Norm(final)=10.063 | 4786.0 samples/s | 74.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step26000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=34001 Epoch=165.9] | Loss=0.02274 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.125 | L2-Norm(final)=11.389 | 3983.2 samples/s | 62.2 steps/s
[Step=34050 Epoch=166.1] | Loss=0.02388 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.150 | L2-Norm(final)=11.376 | 4555.9 samples/s | 71.2 steps/s
[Step=34100 Epoch=166.4] | Loss=0.02119 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.173 | L2-Norm(final)=11.377 | 5205.1 samples/s | 81.3 steps/s
[Step=34150 Epoch=166.6] | Loss=0.02069 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.193 | L2-Norm(final)=11.380 | 5332.4 samples/s | 83.3 steps/s
[Step=34200 Epoch=166.9] | Loss=0.01945 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.214 | L2-Norm(final)=11.384 | 7276.1 samples/s | 113.7 steps/s
[Step=34250 Epoch=167.1] | Loss=0.01769 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.234 | L2-Norm(final)=11.390 | 1830.9 samples/s | 28.6 steps/s
[Step=34300 Epoch=167.4] | Loss=0.01669 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.253 | L2-Norm(final)=11.398 | 5120.7 samples/s | 80.0 steps/s
[Step=34350 Epoch=167.6] | Loss=0.01586 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.270 | L2-Norm(final)=11.408 | 5177.7 samples/s | 80.9 steps/s
[Step=34400 Epoch=167.9] | Loss=0.01553 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.288 | L2-Norm(final)=11.419 | 6737.5 samples/s | 105.3 steps/s
[Step=34450 Epoch=168.1] | Loss=0.01492 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.305 | L2-Norm(final)=11.429 | 1812.0 samples/s | 28.3 steps/s
[Step=34500 Epoch=168.3] | Loss=0.01426 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.321 | L2-Norm(final)=11.441 | 5171.8 samples/s | 80.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=34501 Epoch=168.3] | Loss=0.00413 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.484 | L2-Norm(final)=11.557 | 3883.3 samples/s | 60.7 steps/s
[Step=34550 Epoch=168.6] | Loss=0.01394 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.501 | L2-Norm(final)=11.566 | 4350.6 samples/s | 68.0 steps/s
[Step=34600 Epoch=168.8] | Loss=0.01578 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.522 | L2-Norm(final)=11.573 | 4554.7 samples/s | 71.2 steps/s
[Step=34650 Epoch=169.1] | Loss=0.01571 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.540 | L2-Norm(final)=11.577 | 4678.4 samples/s | 73.1 steps/s
[Step=34700 Epoch=169.3] | Loss=0.01696 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.559 | L2-Norm(final)=11.579 | 6222.5 samples/s | 97.2 steps/s
[Step=34750 Epoch=169.6] | Loss=0.01577 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.576 | L2-Norm(final)=11.582 | 1766.2 samples/s | 27.6 steps/s
[Step=34800 Epoch=169.8] | Loss=0.01509 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.591 | L2-Norm(final)=11.586 | 4636.6 samples/s | 72.4 steps/s
[Step=34850 Epoch=170.1] | Loss=0.01400 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.603 | L2-Norm(final)=11.590 | 4531.4 samples/s | 70.8 steps/s
[Step=34900 Epoch=170.3] | Loss=0.01354 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.614 | L2-Norm(final)=11.594 | 5497.8 samples/s | 85.9 steps/s
[Step=34950 Epoch=170.5] | Loss=0.01258 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.623 | L2-Norm(final)=11.598 | 1809.6 samples/s | 28.3 steps/s
[Step=35000 Epoch=170.8] | Loss=0.01183 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.632 | L2-Norm(final)=11.602 | 4630.3 samples/s | 72.3 steps/s
[Step=35050 Epoch=171.0] | Loss=0.01146 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.640 | L2-Norm(final)=11.605 | 4587.1 samples/s | 71.7 steps/s
[Step=35100 Epoch=171.3] | Loss=0.01114 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.647 | L2-Norm(final)=11.609 | 5531.4 samples/s | 86.4 steps/s
[Step=35150 Epoch=171.5] | Loss=0.01062 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.654 | L2-Norm(final)=11.612 | 1816.4 samples/s | 28.4 steps/s
[Step=35200 Epoch=171.8] | Loss=0.01009 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.660 | L2-Norm(final)=11.615 | 4599.1 samples/s | 71.9 steps/s
[Step=35250 Epoch=172.0] | Loss=0.00959 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.666 | L2-Norm(final)=11.619 | 4702.8 samples/s | 73.5 steps/s
[Step=35300 Epoch=172.2] | Loss=0.00952 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.671 | L2-Norm(final)=11.623 | 5185.7 samples/s | 81.0 steps/s
[Step=35350 Epoch=172.5] | Loss=0.00920 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.676 | L2-Norm(final)=11.626 | 1840.1 samples/s | 28.8 steps/s
[Step=35400 Epoch=172.7] | Loss=0.00894 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.681 | L2-Norm(final)=11.629 | 4418.5 samples/s | 69.0 steps/s
[Step=35450 Epoch=173.0] | Loss=0.00862 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.685 | L2-Norm(final)=11.632 | 4535.2 samples/s | 70.9 steps/s
[Step=35500 Epoch=173.2] | Loss=0.00839 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.689 | L2-Norm(final)=11.635 | 4871.8 samples/s | 76.1 steps/s
[Step=35550 Epoch=173.5] | Loss=0.00815 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.693 | L2-Norm(final)=11.638 | 1875.4 samples/s | 29.3 steps/s
[Step=35600 Epoch=173.7] | Loss=0.00787 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.697 | L2-Norm(final)=11.641 | 4664.0 samples/s | 72.9 steps/s
[Step=35650 Epoch=174.0] | Loss=0.00764 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.700 | L2-Norm(final)=11.644 | 4685.3 samples/s | 73.2 steps/s
[Step=35700 Epoch=174.2] | Loss=0.00761 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.704 | L2-Norm(final)=11.646 | 4726.9 samples/s | 73.9 steps/s
[Step=35750 Epoch=174.4] | Loss=0.00739 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.707 | L2-Norm(final)=11.649 | 1902.8 samples/s | 29.7 steps/s
[Step=35800 Epoch=174.7] | Loss=0.00727 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.710 | L2-Norm(final)=11.651 | 4588.7 samples/s | 71.7 steps/s
[Step=35850 Epoch=174.9] | Loss=0.00720 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.712 | L2-Norm(final)=11.653 | 4631.8 samples/s | 72.4 steps/s
[Step=35900 Epoch=175.2] | Loss=0.00708 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.715 | L2-Norm(final)=11.656 | 4613.6 samples/s | 72.1 steps/s
[Step=35950 Epoch=175.4] | Loss=0.00695 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.718 | L2-Norm(final)=11.658 | 1903.3 samples/s | 29.7 steps/s
[Step=36000 Epoch=175.7] | Loss=0.00688 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.720 | L2-Norm(final)=11.660 | 4624.6 samples/s | 72.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step36000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=22001 Epoch=107.3] | Loss=0.00125 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.125 | L2-Norm(final)=10.107 | 3719.1 samples/s | 58.1 steps/s
[Step=22050 Epoch=107.5] | Loss=0.02653 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.139 | L2-Norm(final)=10.098 | 4893.5 samples/s | 76.5 steps/s
[Step=22100 Epoch=107.8] | Loss=0.02562 | Reg=0.00125 | acc=0.9688 | L2-Norm=11.165 | L2-Norm(final)=10.094 | 5107.9 samples/s | 79.8 steps/s
[Step=22150 Epoch=108.0] | Loss=0.02284 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.188 | L2-Norm(final)=10.098 | 5296.3 samples/s | 82.8 steps/s
[Step=22200 Epoch=108.3] | Loss=0.02094 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.209 | L2-Norm(final)=10.106 | 7053.9 samples/s | 110.2 steps/s
[Step=22250 Epoch=108.5] | Loss=0.01976 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.229 | L2-Norm(final)=10.116 | 1824.9 samples/s | 28.5 steps/s
[Step=22300 Epoch=108.7] | Loss=0.01870 | Reg=0.00127 | acc=0.9688 | L2-Norm=11.249 | L2-Norm(final)=10.127 | 5298.7 samples/s | 82.8 steps/s
[Step=22350 Epoch=109.0] | Loss=0.01793 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.268 | L2-Norm(final)=10.138 | 5200.7 samples/s | 81.3 steps/s
[Step=22400 Epoch=109.2] | Loss=0.01710 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.286 | L2-Norm(final)=10.151 | 6702.9 samples/s | 104.7 steps/s
[Step=22450 Epoch=109.5] | Loss=0.01650 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.304 | L2-Norm(final)=10.163 | 1840.2 samples/s | 28.8 steps/s
[Step=22500 Epoch=109.7] | Loss=0.01583 | Reg=0.00128 | acc=0.9688 | L2-Norm=11.321 | L2-Norm(final)=10.176 | 4983.3 samples/s | 77.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=22501 Epoch=109.7] | Loss=0.01105 | Reg=0.00132 | acc=0.9844 | L2-Norm=11.492 | L2-Norm(final)=10.307 | 3690.5 samples/s | 57.7 steps/s
[Step=22550 Epoch=110.0] | Loss=0.01512 | Reg=0.00133 | acc=0.9688 | L2-Norm=11.517 | L2-Norm(final)=10.319 | 4541.4 samples/s | 71.0 steps/s
[Step=22600 Epoch=110.2] | Loss=0.01751 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.543 | L2-Norm(final)=10.326 | 4503.4 samples/s | 70.4 steps/s
[Step=22650 Epoch=110.5] | Loss=0.01681 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.567 | L2-Norm(final)=10.332 | 4661.6 samples/s | 72.8 steps/s
[Step=22700 Epoch=110.7] | Loss=0.01646 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.587 | L2-Norm(final)=10.338 | 6190.1 samples/s | 96.7 steps/s
[Step=22750 Epoch=110.9] | Loss=0.01562 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.607 | L2-Norm(final)=10.344 | 1749.0 samples/s | 27.3 steps/s
[Step=22800 Epoch=111.2] | Loss=0.01455 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.626 | L2-Norm(final)=10.351 | 4703.3 samples/s | 73.5 steps/s
[Step=22850 Epoch=111.4] | Loss=0.01378 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.643 | L2-Norm(final)=10.357 | 4600.3 samples/s | 71.9 steps/s
[Step=22900 Epoch=111.7] | Loss=0.01320 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.658 | L2-Norm(final)=10.363 | 5727.3 samples/s | 89.5 steps/s
[Step=22950 Epoch=111.9] | Loss=0.01252 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.671 | L2-Norm(final)=10.368 | 1807.8 samples/s | 28.2 steps/s
[Step=23000 Epoch=112.2] | Loss=0.01188 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.683 | L2-Norm(final)=10.374 | 4380.5 samples/s | 68.4 steps/s
[Step=23050 Epoch=112.4] | Loss=0.01153 | Reg=0.00137 | acc=0.9844 | L2-Norm=11.693 | L2-Norm(final)=10.378 | 4579.2 samples/s | 71.6 steps/s
[Step=23100 Epoch=112.6] | Loss=0.01094 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.702 | L2-Norm(final)=10.383 | 5292.5 samples/s | 82.7 steps/s
[Step=23150 Epoch=112.9] | Loss=0.01055 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.711 | L2-Norm(final)=10.387 | 1839.6 samples/s | 28.7 steps/s
[Step=23200 Epoch=113.1] | Loss=0.01007 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.718 | L2-Norm(final)=10.392 | 4656.2 samples/s | 72.8 steps/s
[Step=23250 Epoch=113.4] | Loss=0.00962 | Reg=0.00137 | acc=1.0000 | L2-Norm=11.725 | L2-Norm(final)=10.396 | 4483.0 samples/s | 70.0 steps/s
[Step=23300 Epoch=113.6] | Loss=0.00929 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.732 | L2-Norm(final)=10.400 | 5001.3 samples/s | 78.1 steps/s
[Step=23350 Epoch=113.9] | Loss=0.00905 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.738 | L2-Norm(final)=10.404 | 1848.0 samples/s | 28.9 steps/s
[Step=23400 Epoch=114.1] | Loss=0.00879 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.744 | L2-Norm(final)=10.408 | 4765.7 samples/s | 74.5 steps/s
[Step=23450 Epoch=114.4] | Loss=0.00856 | Reg=0.00138 | acc=0.9844 | L2-Norm=11.750 | L2-Norm(final)=10.412 | 4815.8 samples/s | 75.2 steps/s
[Step=23500 Epoch=114.6] | Loss=0.00834 | Reg=0.00138 | acc=0.9688 | L2-Norm=11.755 | L2-Norm(final)=10.415 | 4859.9 samples/s | 75.9 steps/s
[Step=23550 Epoch=114.8] | Loss=0.00810 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.760 | L2-Norm(final)=10.418 | 1903.5 samples/s | 29.7 steps/s
[Step=23600 Epoch=115.1] | Loss=0.00789 | Reg=0.00138 | acc=1.0000 | L2-Norm=11.765 | L2-Norm(final)=10.421 | 4672.7 samples/s | 73.0 steps/s
[Step=23650 Epoch=115.3] | Loss=0.00770 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.769 | L2-Norm(final)=10.424 | 4667.7 samples/s | 72.9 steps/s
[Step=23700 Epoch=115.6] | Loss=0.00761 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.774 | L2-Norm(final)=10.427 | 4551.8 samples/s | 71.1 steps/s
[Step=23750 Epoch=115.8] | Loss=0.00743 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.777 | L2-Norm(final)=10.430 | 1955.7 samples/s | 30.6 steps/s
[Step=23800 Epoch=116.1] | Loss=0.00724 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.781 | L2-Norm(final)=10.433 | 4631.4 samples/s | 72.4 steps/s
[Step=23850 Epoch=116.3] | Loss=0.00714 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.785 | L2-Norm(final)=10.435 | 4566.3 samples/s | 71.3 steps/s
[Step=23900 Epoch=116.5] | Loss=0.00700 | Reg=0.00139 | acc=0.9844 | L2-Norm=11.789 | L2-Norm(final)=10.438 | 4746.2 samples/s | 74.2 steps/s
[Step=23950 Epoch=116.8] | Loss=0.00687 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.792 | L2-Norm(final)=10.440 | 1993.2 samples/s | 31.1 steps/s
[Step=24000 Epoch=117.0] | Loss=0.00677 | Reg=0.00139 | acc=1.0000 | L2-Norm=11.795 | L2-Norm(final)=10.443 | 4651.2 samples/s | 72.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step24000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=16001 Epoch=151.6] | Loss=0.00130 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.125 | L2-Norm(final)=6.531 | 3718.3 samples/s | 58.1 steps/s
[Step=16050 Epoch=152.1] | Loss=0.00215 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.159 | L2-Norm(final)=6.530 | 4453.4 samples/s | 69.6 steps/s
[Step=16100 Epoch=152.6] | Loss=0.00128 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.179 | L2-Norm(final)=6.547 | 7125.2 samples/s | 111.3 steps/s
[Step=16150 Epoch=153.0] | Loss=0.00090 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.186 | L2-Norm(final)=6.559 | 1762.4 samples/s | 27.5 steps/s
[Step=16200 Epoch=153.5] | Loss=0.00072 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.188 | L2-Norm(final)=6.570 | 6264.8 samples/s | 97.9 steps/s
[Step=16250 Epoch=154.0] | Loss=0.00060 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.188 | L2-Norm(final)=6.580 | 1803.7 samples/s | 28.2 steps/s
[Step=16300 Epoch=154.5] | Loss=0.00052 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.187 | L2-Norm(final)=6.588 | 5826.8 samples/s | 91.0 steps/s
[Step=16350 Epoch=154.9] | Loss=0.00045 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.185 | L2-Norm(final)=6.596 | 1849.0 samples/s | 28.9 steps/s
[Step=16400 Epoch=155.4] | Loss=0.00041 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.182 | L2-Norm(final)=6.603 | 5315.5 samples/s | 83.1 steps/s
[Step=16450 Epoch=155.9] | Loss=0.00037 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.178 | L2-Norm(final)=6.610 | 1867.3 samples/s | 29.2 steps/s
[Step=16500 Epoch=156.4] | Loss=0.00034 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.175 | L2-Norm(final)=6.617 | 4906.8 samples/s | 76.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=16501 Epoch=156.4] | Loss=0.00006 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.136 | L2-Norm(final)=6.681 | 3570.2 samples/s | 55.8 steps/s
[Step=16550 Epoch=156.8] | Loss=0.00005 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.128 | L2-Norm(final)=6.685 | 4447.7 samples/s | 69.5 steps/s
[Step=16600 Epoch=157.3] | Loss=0.00004 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.119 | L2-Norm(final)=6.689 | 5775.2 samples/s | 90.2 steps/s
[Step=16650 Epoch=157.8] | Loss=0.00004 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.110 | L2-Norm(final)=6.693 | 1674.3 samples/s | 26.2 steps/s
[Step=16700 Epoch=158.2] | Loss=0.00003 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.100 | L2-Norm(final)=6.695 | 5650.9 samples/s | 88.3 steps/s
[Step=16750 Epoch=158.7] | Loss=0.00003 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.090 | L2-Norm(final)=6.697 | 1727.9 samples/s | 27.0 steps/s
[Step=16800 Epoch=159.2] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.079 | L2-Norm(final)=6.699 | 5164.4 samples/s | 80.7 steps/s
[Step=16850 Epoch=159.7] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.068 | L2-Norm(final)=6.701 | 1766.0 samples/s | 27.6 steps/s
[Step=16900 Epoch=160.1] | Loss=0.00002 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.057 | L2-Norm(final)=6.703 | 4438.9 samples/s | 69.4 steps/s
[Step=16950 Epoch=160.6] | Loss=0.00002 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.046 | L2-Norm(final)=6.704 | 1726.9 samples/s | 27.0 steps/s
[Step=17000 Epoch=161.1] | Loss=0.00002 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.035 | L2-Norm(final)=6.706 | 4250.3 samples/s | 66.4 steps/s
[Step=17050 Epoch=161.6] | Loss=0.00002 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.023 | L2-Norm(final)=6.707 | 1847.0 samples/s | 28.9 steps/s
[Step=17100 Epoch=162.0] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.012 | L2-Norm(final)=6.708 | 4409.5 samples/s | 68.9 steps/s
[Step=17150 Epoch=162.5] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.000 | L2-Norm(final)=6.710 | 1853.3 samples/s | 29.0 steps/s
[Step=17200 Epoch=163.0] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.988 | L2-Norm(final)=6.711 | 4427.7 samples/s | 69.2 steps/s
[Step=17250 Epoch=163.5] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.977 | L2-Norm(final)=6.712 | 1851.6 samples/s | 28.9 steps/s
[Step=17300 Epoch=163.9] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.965 | L2-Norm(final)=6.713 | 4188.7 samples/s | 65.4 steps/s
[Step=17350 Epoch=164.4] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.953 | L2-Norm(final)=6.714 | 1904.2 samples/s | 29.8 steps/s
[Step=17400 Epoch=164.9] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.941 | L2-Norm(final)=6.715 | 4055.1 samples/s | 63.4 steps/s
[Step=17450 Epoch=165.4] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.929 | L2-Norm(final)=6.716 | 6288.8 samples/s | 98.3 steps/s
[Step=17500 Epoch=165.8] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.916 | L2-Norm(final)=6.717 | 1674.6 samples/s | 26.2 steps/s
[Step=17550 Epoch=166.3] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.904 | L2-Norm(final)=6.718 | 5609.7 samples/s | 87.7 steps/s
[Step=17600 Epoch=166.8] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.892 | L2-Norm(final)=6.719 | 1727.4 samples/s | 27.0 steps/s
[Step=17650 Epoch=167.2] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.879 | L2-Norm(final)=6.720 | 5218.5 samples/s | 81.5 steps/s
[Step=17700 Epoch=167.7] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.866 | L2-Norm(final)=6.721 | 1702.1 samples/s | 26.6 steps/s
[Step=17750 Epoch=168.2] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.854 | L2-Norm(final)=6.722 | 4858.1 samples/s | 75.9 steps/s
[Step=17800 Epoch=168.7] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.841 | L2-Norm(final)=6.723 | 1752.3 samples/s | 27.4 steps/s
[Step=17850 Epoch=169.1] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.828 | L2-Norm(final)=6.724 | 4674.3 samples/s | 73.0 steps/s
[Step=17900 Epoch=169.6] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.815 | L2-Norm(final)=6.725 | 1855.5 samples/s | 29.0 steps/s
[Step=17950 Epoch=170.1] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.802 | L2-Norm(final)=6.726 | 4424.8 samples/s | 69.1 steps/s
[Step=18000 Epoch=170.6] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.789 | L2-Norm(final)=6.727 | 1894.4 samples/s | 29.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_0/client_state-step18000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=24001 Epoch=226.2] | Loss=0.00003 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.125 | L2-Norm(final)=8.215 | 3564.7 samples/s | 55.7 steps/s
[Step=24050 Epoch=226.6] | Loss=0.00441 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.199 | L2-Norm(final)=8.220 | 4601.1 samples/s | 71.9 steps/s
[Step=24100 Epoch=227.1] | Loss=0.00243 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.255 | L2-Norm(final)=8.226 | 6530.5 samples/s | 102.0 steps/s
[Step=24150 Epoch=227.6] | Loss=0.00166 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.274 | L2-Norm(final)=8.233 | 1692.6 samples/s | 26.4 steps/s
[Step=24200 Epoch=228.0] | Loss=0.00127 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.281 | L2-Norm(final)=8.239 | 5778.1 samples/s | 90.3 steps/s
[Step=24250 Epoch=228.5] | Loss=0.00103 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.283 | L2-Norm(final)=8.243 | 1753.3 samples/s | 27.4 steps/s
[Step=24300 Epoch=229.0] | Loss=0.00087 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.282 | L2-Norm(final)=8.248 | 5565.3 samples/s | 87.0 steps/s
[Step=24350 Epoch=229.4] | Loss=0.00076 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.281 | L2-Norm(final)=8.252 | 1874.5 samples/s | 29.3 steps/s
[Step=24400 Epoch=229.9] | Loss=0.00067 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.278 | L2-Norm(final)=8.255 | 5263.9 samples/s | 82.2 steps/s
[Step=24450 Epoch=230.4] | Loss=0.00060 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.274 | L2-Norm(final)=8.259 | 1868.6 samples/s | 29.2 steps/s
[Step=24500 Epoch=230.9] | Loss=0.00055 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.271 | L2-Norm(final)=8.263 | 4951.5 samples/s | 77.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=230.9] | Loss=0.00002 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.230 | L2-Norm(final)=8.297 | 3741.1 samples/s | 58.5 steps/s
[Step=24550 Epoch=231.3] | Loss=0.00421 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.234 | L2-Norm(final)=8.300 | 4251.8 samples/s | 66.4 steps/s
[Step=24600 Epoch=231.8] | Loss=0.00529 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.302 | L2-Norm(final)=8.288 | 5860.5 samples/s | 91.6 steps/s
[Step=24650 Epoch=232.3] | Loss=0.00428 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=8.279 | 1671.9 samples/s | 26.1 steps/s
[Step=24700 Epoch=232.7] | Loss=0.00325 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.361 | L2-Norm(final)=8.275 | 5308.3 samples/s | 82.9 steps/s
[Step=24750 Epoch=233.2] | Loss=0.00261 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.371 | L2-Norm(final)=8.273 | 1721.9 samples/s | 26.9 steps/s
[Step=24800 Epoch=233.7] | Loss=0.00218 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.376 | L2-Norm(final)=8.273 | 4975.1 samples/s | 77.7 steps/s
[Step=24850 Epoch=234.2] | Loss=0.00187 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.378 | L2-Norm(final)=8.273 | 1829.8 samples/s | 28.6 steps/s
[Step=24900 Epoch=234.6] | Loss=0.00164 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.378 | L2-Norm(final)=8.273 | 4536.2 samples/s | 70.9 steps/s
[Step=24950 Epoch=235.1] | Loss=0.00146 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.377 | L2-Norm(final)=8.273 | 1836.7 samples/s | 28.7 steps/s
[Step=25000 Epoch=235.6] | Loss=0.00132 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.376 | L2-Norm(final)=8.273 | 4437.3 samples/s | 69.3 steps/s
[Step=25050 Epoch=236.0] | Loss=0.00120 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.373 | L2-Norm(final)=8.274 | 1864.6 samples/s | 29.1 steps/s
[Step=25100 Epoch=236.5] | Loss=0.00110 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.370 | L2-Norm(final)=8.274 | 4429.8 samples/s | 69.2 steps/s
[Step=25150 Epoch=237.0] | Loss=0.00102 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.367 | L2-Norm(final)=8.275 | 1911.2 samples/s | 29.9 steps/s
[Step=25200 Epoch=237.5] | Loss=0.00095 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.363 | L2-Norm(final)=8.275 | 4337.4 samples/s | 67.8 steps/s
[Step=25250 Epoch=237.9] | Loss=0.00089 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.359 | L2-Norm(final)=8.276 | 1938.2 samples/s | 30.3 steps/s
[Step=25300 Epoch=238.4] | Loss=0.00083 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=8.277 | 4156.0 samples/s | 64.9 steps/s
[Step=25350 Epoch=238.9] | Loss=0.00078 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.350 | L2-Norm(final)=8.277 | 5559.8 samples/s | 86.9 steps/s
[Step=25400 Epoch=239.3] | Loss=0.00074 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.346 | L2-Norm(final)=8.278 | 1621.3 samples/s | 25.3 steps/s
[Step=25450 Epoch=239.8] | Loss=0.00070 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.341 | L2-Norm(final)=8.278 | 5148.1 samples/s | 80.4 steps/s
[Step=25500 Epoch=240.3] | Loss=0.00067 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.336 | L2-Norm(final)=8.279 | 1719.1 samples/s | 26.9 steps/s
[Step=25550 Epoch=240.8] | Loss=0.00064 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.331 | L2-Norm(final)=8.279 | 4942.7 samples/s | 77.2 steps/s
[Step=25600 Epoch=241.2] | Loss=0.00061 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.326 | L2-Norm(final)=8.280 | 1759.6 samples/s | 27.5 steps/s
[Step=25650 Epoch=241.7] | Loss=0.00058 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.321 | L2-Norm(final)=8.280 | 4637.0 samples/s | 72.5 steps/s
[Step=25700 Epoch=242.2] | Loss=0.00056 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.316 | L2-Norm(final)=8.281 | 1841.4 samples/s | 28.8 steps/s
[Step=25750 Epoch=242.6] | Loss=0.00054 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.310 | L2-Norm(final)=8.282 | 4399.8 samples/s | 68.7 steps/s
[Step=25800 Epoch=243.1] | Loss=0.00052 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.305 | L2-Norm(final)=8.282 | 1873.2 samples/s | 29.3 steps/s
[Step=25850 Epoch=243.6] | Loss=0.00050 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.299 | L2-Norm(final)=8.283 | 4393.4 samples/s | 68.6 steps/s
[Step=25900 Epoch=244.1] | Loss=0.00048 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.293 | L2-Norm(final)=8.283 | 1870.9 samples/s | 29.2 steps/s
[Step=25950 Epoch=244.5] | Loss=0.00046 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.287 | L2-Norm(final)=8.284 | 4424.3 samples/s | 69.1 steps/s
[Step=26000 Epoch=245.0] | Loss=0.00045 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.282 | L2-Norm(final)=8.284 | 1933.6 samples/s | 30.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step26000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09463 | acc=0.9635 | tpr=0.9774 | fpr=0.0667 | 4072.1 samples/s | 15.9 steps/s
Avg test loss: 0.09743, Avg test acc: 0.96170, Avg tpr: 0.97622, Avg fpr: 0.07025, total FA: 548

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09836 | acc=0.9558 | tpr=0.9584 | fpr=0.0498 | 4036.2 samples/s | 15.8 steps/s
Avg test loss: 0.10214, Avg test acc: 0.95597, Avg tpr: 0.95926, Avg fpr: 0.05128, total FA: 400

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09768 | acc=0.9595 | tpr=0.9728 | fpr=0.0696 | 4052.5 samples/s | 15.8 steps/s
Avg test loss: 0.10295, Avg test acc: 0.95889, Avg tpr: 0.97162, Avg fpr: 0.06909, total FA: 539

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09676 | acc=0.9594 | tpr=0.9775 | fpr=0.0800 | 4146.6 samples/s | 16.2 steps/s
Avg test loss: 0.10123, Avg test acc: 0.95921, Avg tpr: 0.97814, Avg fpr: 0.08243, total FA: 643

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.09521 | acc=0.9609 | tpr=0.9686 | fpr=0.0560 | 4120.9 samples/s | 16.1 steps/s
Avg test loss: 0.10246, Avg test acc: 0.95849, Avg tpr: 0.96666, Avg fpr: 0.05948, total FA: 464

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.14565 | acc=0.2779 | tpr=0.0035 | fpr=0.1264 | 3871.0 samples/s | 15.1 steps/s
Avg test loss: 5.16158, Avg test acc: 0.27638, Avg tpr: 0.00455, Avg fpr: 0.12575, total FA: 981

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.91304 | acc=0.3082 | tpr=0.0047 | fpr=0.0327 | 4049.6 samples/s | 15.8 steps/s
Avg test loss: 4.91786, Avg test acc: 0.30639, Avg tpr: 0.00670, Avg fpr: 0.03448, total FA: 269

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.12189 | acc=0.2948 | tpr=0.0076 | fpr=0.0815 | 4088.5 samples/s | 16.0 steps/s
Avg test loss: 5.13500, Avg test acc: 0.29353, Avg tpr: 0.00892, Avg fpr: 0.08050, total FA: 628

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=4.53900 | acc=0.2941 | tpr=0.0089 | fpr=0.0865 | 4115.3 samples/s | 16.1 steps/s
Avg test loss: 4.54795, Avg test acc: 0.29281, Avg tpr: 0.00985, Avg fpr: 0.08486, total FA: 662

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.89511 | acc=0.3116 | tpr=0.0024 | fpr=0.0171 | 4060.1 samples/s | 15.9 steps/s
Avg test loss: 4.90047, Avg test acc: 0.30916, Avg tpr: 0.00344, Avg fpr: 0.01846, total FA: 144

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.80092 | acc=0.1128 | tpr=0.8451 | fpr=0.9003 | 4016.7 samples/s | 15.7 steps/s
[Step= 100] | Loss=5.74651 | acc=0.1141 | tpr=0.8294 | fpr=0.8992 | 8920.6 samples/s | 34.8 steps/s
[Step= 150] | Loss=5.75303 | acc=0.1126 | tpr=0.8285 | fpr=0.9006 | 4578.5 samples/s | 17.9 steps/s
[Step= 200] | Loss=5.75101 | acc=0.1119 | tpr=0.8240 | fpr=0.9011 | 8274.1 samples/s | 32.3 steps/s
[Step= 250] | Loss=5.75754 | acc=0.1122 | tpr=0.8236 | fpr=0.9007 | 7953.3 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.75475 | acc=0.1121 | tpr=0.8233 | fpr=0.9008 | 8126.3 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.75108 | acc=0.1118 | tpr=0.8178 | fpr=0.9010 | 7860.2 samples/s | 30.7 steps/s
[Step= 400] | Loss=5.75319 | acc=0.1121 | tpr=0.8140 | fpr=0.9006 | 8080.1 samples/s | 31.6 steps/s
[Step= 450] | Loss=5.75608 | acc=0.1119 | tpr=0.8111 | fpr=0.9008 | 7909.3 samples/s | 30.9 steps/s
[Step= 500] | Loss=5.75972 | acc=0.1118 | tpr=0.8101 | fpr=0.9008 | 7776.0 samples/s | 30.4 steps/s
[Step= 550] | Loss=5.76012 | acc=0.1117 | tpr=0.8142 | fpr=0.9010 | 15305.2 samples/s | 59.8 steps/s
Avg test loss: 5.76168, Avg test acc: 0.11170, Avg tpr: 0.81418, Avg fpr: 0.90107, total FA: 125112

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.39289 | acc=0.1487 | tpr=0.7345 | fpr=0.8619 | 4111.3 samples/s | 16.1 steps/s
[Step= 100] | Loss=4.34126 | acc=0.1516 | tpr=0.6930 | fpr=0.8585 | 5559.8 samples/s | 21.7 steps/s
[Step= 150] | Loss=4.34730 | acc=0.1499 | tpr=0.6916 | fpr=0.8601 | 6716.7 samples/s | 26.2 steps/s
[Step= 200] | Loss=4.34349 | acc=0.1500 | tpr=0.6896 | fpr=0.8599 | 7746.3 samples/s | 30.3 steps/s
[Step= 250] | Loss=4.34348 | acc=0.1504 | tpr=0.6926 | fpr=0.8595 | 7787.8 samples/s | 30.4 steps/s
[Step= 300] | Loss=4.34321 | acc=0.1498 | tpr=0.6924 | fpr=0.8601 | 7737.7 samples/s | 30.2 steps/s
[Step= 350] | Loss=4.33801 | acc=0.1495 | tpr=0.6894 | fpr=0.8603 | 8537.0 samples/s | 33.3 steps/s
[Step= 400] | Loss=4.33881 | acc=0.1496 | tpr=0.6860 | fpr=0.8601 | 7868.1 samples/s | 30.7 steps/s
[Step= 450] | Loss=4.34487 | acc=0.1498 | tpr=0.6845 | fpr=0.8599 | 7845.1 samples/s | 30.6 steps/s
[Step= 500] | Loss=4.34962 | acc=0.1494 | tpr=0.6806 | fpr=0.8602 | 7858.4 samples/s | 30.7 steps/s
[Step= 550] | Loss=4.34884 | acc=0.1491 | tpr=0.6813 | fpr=0.8606 | 14384.0 samples/s | 56.2 steps/s
Avg test loss: 4.34991, Avg test acc: 0.14906, Avg tpr: 0.68106, Avg fpr: 0.86061, total FA: 119494

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.17457 | acc=0.1120 | tpr=0.7699 | fpr=0.8999 | 3972.5 samples/s | 15.5 steps/s
[Step= 100] | Loss=6.11646 | acc=0.1143 | tpr=0.7484 | fpr=0.8975 | 4768.6 samples/s | 18.6 steps/s
[Step= 150] | Loss=6.12945 | acc=0.1121 | tpr=0.7608 | fpr=0.8998 | 7901.1 samples/s | 30.9 steps/s
[Step= 200] | Loss=6.13057 | acc=0.1116 | tpr=0.7574 | fpr=0.9001 | 7933.5 samples/s | 31.0 steps/s
[Step= 250] | Loss=6.13295 | acc=0.1120 | tpr=0.7616 | fpr=0.8999 | 8325.6 samples/s | 32.5 steps/s
[Step= 300] | Loss=6.12957 | acc=0.1118 | tpr=0.7629 | fpr=0.9001 | 7237.6 samples/s | 28.3 steps/s
[Step= 350] | Loss=6.12785 | acc=0.1115 | tpr=0.7564 | fpr=0.9002 | 8044.0 samples/s | 31.4 steps/s
[Step= 400] | Loss=6.12920 | acc=0.1120 | tpr=0.7560 | fpr=0.8997 | 8239.4 samples/s | 32.2 steps/s
[Step= 450] | Loss=6.13266 | acc=0.1114 | tpr=0.7537 | fpr=0.9003 | 7906.7 samples/s | 30.9 steps/s
[Step= 500] | Loss=6.13389 | acc=0.1112 | tpr=0.7529 | fpr=0.9004 | 7704.5 samples/s | 30.1 steps/s
[Step= 550] | Loss=6.13255 | acc=0.1111 | tpr=0.7573 | fpr=0.9006 | 14493.0 samples/s | 56.6 steps/s
Avg test loss: 6.13418, Avg test acc: 0.11106, Avg tpr: 0.75674, Avg fpr: 0.90068, total FA: 125057

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.58992 | acc=0.1146 | tpr=0.7743 | fpr=0.8972 | 4004.5 samples/s | 15.6 steps/s
[Step= 100] | Loss=5.53734 | acc=0.1154 | tpr=0.7420 | fpr=0.8963 | 4544.1 samples/s | 17.8 steps/s
[Step= 150] | Loss=5.53944 | acc=0.1134 | tpr=0.7392 | fpr=0.8982 | 7820.5 samples/s | 30.5 steps/s
[Step= 200] | Loss=5.53303 | acc=0.1131 | tpr=0.7366 | fpr=0.8982 | 7592.6 samples/s | 29.7 steps/s
[Step= 250] | Loss=5.53662 | acc=0.1132 | tpr=0.7389 | fpr=0.8982 | 8511.0 samples/s | 33.2 steps/s
[Step= 300] | Loss=5.53672 | acc=0.1129 | tpr=0.7389 | fpr=0.8986 | 7241.7 samples/s | 28.3 steps/s
[Step= 350] | Loss=5.52991 | acc=0.1129 | tpr=0.7358 | fpr=0.8984 | 8099.3 samples/s | 31.6 steps/s
[Step= 400] | Loss=5.53309 | acc=0.1129 | tpr=0.7314 | fpr=0.8983 | 7797.1 samples/s | 30.5 steps/s
[Step= 450] | Loss=5.53795 | acc=0.1128 | tpr=0.7249 | fpr=0.8983 | 8266.4 samples/s | 32.3 steps/s
[Step= 500] | Loss=5.54315 | acc=0.1126 | tpr=0.7247 | fpr=0.8985 | 8056.2 samples/s | 31.5 steps/s
[Step= 550] | Loss=5.54172 | acc=0.1124 | tpr=0.7246 | fpr=0.8987 | 13135.7 samples/s | 51.3 steps/s
Avg test loss: 5.54325, Avg test acc: 0.11238, Avg tpr: 0.72425, Avg fpr: 0.89874, total FA: 124788

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.57176 | acc=0.1241 | tpr=0.6106 | fpr=0.8846 | 3232.6 samples/s | 12.6 steps/s
[Step= 100] | Loss=5.51102 | acc=0.1263 | tpr=0.5629 | fpr=0.8818 | 6685.0 samples/s | 26.1 steps/s
[Step= 150] | Loss=5.51292 | acc=0.1252 | tpr=0.5591 | fpr=0.8828 | 8179.8 samples/s | 32.0 steps/s
[Step= 200] | Loss=5.50918 | acc=0.1250 | tpr=0.5607 | fpr=0.8830 | 7907.4 samples/s | 30.9 steps/s
[Step= 250] | Loss=5.51396 | acc=0.1249 | tpr=0.5581 | fpr=0.8830 | 6861.4 samples/s | 26.8 steps/s
[Step= 300] | Loss=5.50873 | acc=0.1245 | tpr=0.5615 | fpr=0.8834 | 7239.5 samples/s | 28.3 steps/s
[Step= 350] | Loss=5.50437 | acc=0.1241 | tpr=0.5548 | fpr=0.8837 | 7808.0 samples/s | 30.5 steps/s
[Step= 400] | Loss=5.50727 | acc=0.1243 | tpr=0.5509 | fpr=0.8834 | 7836.5 samples/s | 30.6 steps/s
[Step= 450] | Loss=5.50866 | acc=0.1240 | tpr=0.5448 | fpr=0.8836 | 7890.5 samples/s | 30.8 steps/s
[Step= 500] | Loss=5.50981 | acc=0.1237 | tpr=0.5388 | fpr=0.8837 | 7474.4 samples/s | 29.2 steps/s
[Step= 550] | Loss=5.51077 | acc=0.1235 | tpr=0.5376 | fpr=0.8840 | 14483.7 samples/s | 56.6 steps/s
Avg test loss: 5.51300, Avg test acc: 0.12345, Avg tpr: 0.53764, Avg fpr: 0.88408, total FA: 122753

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10641 | acc=0.9806 | tpr=0.9248 | fpr=0.0184 | 2966.4 samples/s | 11.6 steps/s
[Step= 100] | Loss=0.11021 | acc=0.9798 | tpr=0.9467 | fpr=0.0196 | 8140.3 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.11488 | acc=0.9786 | tpr=0.9467 | fpr=0.0208 | 8238.0 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.11657 | acc=0.9785 | tpr=0.9497 | fpr=0.0210 | 8006.8 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.11569 | acc=0.9785 | tpr=0.9450 | fpr=0.0209 | 7861.6 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.11773 | acc=0.9782 | tpr=0.9425 | fpr=0.0211 | 8148.5 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.11774 | acc=0.9781 | tpr=0.9424 | fpr=0.0212 | 7731.2 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.11920 | acc=0.9779 | tpr=0.9393 | fpr=0.0214 | 8299.6 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.12194 | acc=0.9776 | tpr=0.9391 | fpr=0.0217 | 7671.7 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.12162 | acc=0.9776 | tpr=0.9405 | fpr=0.0218 | 7995.2 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.12046 | acc=0.9778 | tpr=0.9403 | fpr=0.0215 | 14682.8 samples/s | 57.4 steps/s
Avg test loss: 0.12032, Avg test acc: 0.97780, Avg tpr: 0.94057, Avg fpr: 0.02152, total FA: 2988

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12098 | acc=0.9810 | tpr=0.8938 | fpr=0.0174 | 3097.6 samples/s | 12.1 steps/s
[Step= 100] | Loss=0.12524 | acc=0.9804 | tpr=0.9083 | fpr=0.0182 | 8042.5 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.13038 | acc=0.9795 | tpr=0.9063 | fpr=0.0192 | 8128.3 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.13214 | acc=0.9796 | tpr=0.9148 | fpr=0.0192 | 7772.2 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.13045 | acc=0.9797 | tpr=0.9135 | fpr=0.0191 | 7407.2 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.13274 | acc=0.9792 | tpr=0.9120 | fpr=0.0196 | 7854.9 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.13276 | acc=0.9792 | tpr=0.9167 | fpr=0.0197 | 7871.8 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.13414 | acc=0.9789 | tpr=0.9125 | fpr=0.0198 | 8240.4 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.13748 | acc=0.9787 | tpr=0.9114 | fpr=0.0201 | 7661.3 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.13673 | acc=0.9788 | tpr=0.9150 | fpr=0.0201 | 8078.5 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.13557 | acc=0.9789 | tpr=0.9152 | fpr=0.0199 | 13826.7 samples/s | 54.0 steps/s
Avg test loss: 0.13535, Avg test acc: 0.97895, Avg tpr: 0.91442, Avg fpr: 0.01988, total FA: 2760

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11349 | acc=0.9790 | tpr=0.9336 | fpr=0.0202 | 3084.5 samples/s | 12.0 steps/s
[Step= 100] | Loss=0.11761 | acc=0.9787 | tpr=0.9531 | fpr=0.0209 | 8415.1 samples/s | 32.9 steps/s
[Step= 150] | Loss=0.12190 | acc=0.9780 | tpr=0.9524 | fpr=0.0216 | 8202.1 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.12437 | acc=0.9778 | tpr=0.9552 | fpr=0.0218 | 8118.2 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.12331 | acc=0.9778 | tpr=0.9537 | fpr=0.0218 | 7998.8 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.12549 | acc=0.9774 | tpr=0.9542 | fpr=0.0222 | 8250.6 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.12543 | acc=0.9773 | tpr=0.9549 | fpr=0.0223 | 8244.7 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.12688 | acc=0.9771 | tpr=0.9519 | fpr=0.0224 | 8383.3 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.12985 | acc=0.9768 | tpr=0.9513 | fpr=0.0227 | 7855.8 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.12944 | acc=0.9769 | tpr=0.9529 | fpr=0.0227 | 7807.6 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.12812 | acc=0.9771 | tpr=0.9534 | fpr=0.0225 | 14420.2 samples/s | 56.3 steps/s
Avg test loss: 0.12796, Avg test acc: 0.97707, Avg tpr: 0.95325, Avg fpr: 0.02250, total FA: 3124

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10139 | acc=0.9820 | tpr=0.9292 | fpr=0.0171 | 2993.9 samples/s | 11.7 steps/s
[Step= 100] | Loss=0.10454 | acc=0.9809 | tpr=0.9403 | fpr=0.0184 | 8361.9 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.10861 | acc=0.9799 | tpr=0.9380 | fpr=0.0194 | 7922.8 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.11101 | acc=0.9793 | tpr=0.9464 | fpr=0.0201 | 7964.6 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.11018 | acc=0.9793 | tpr=0.9424 | fpr=0.0200 | 7740.8 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.11223 | acc=0.9789 | tpr=0.9418 | fpr=0.0204 | 8035.2 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.11248 | acc=0.9789 | tpr=0.9443 | fpr=0.0205 | 7983.0 samples/s | 31.2 steps/s
[Step= 400] | Loss=0.11334 | acc=0.9787 | tpr=0.9398 | fpr=0.0206 | 8337.2 samples/s | 32.6 steps/s
[Step= 450] | Loss=0.11607 | acc=0.9784 | tpr=0.9382 | fpr=0.0209 | 8255.6 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.11567 | acc=0.9784 | tpr=0.9388 | fpr=0.0209 | 8055.4 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.11477 | acc=0.9786 | tpr=0.9399 | fpr=0.0207 | 14326.6 samples/s | 56.0 steps/s
Avg test loss: 0.11468, Avg test acc: 0.97860, Avg tpr: 0.93978, Avg fpr: 0.02070, total FA: 2874

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12635 | acc=0.9791 | tpr=0.9248 | fpr=0.0200 | 4073.9 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.13165 | acc=0.9789 | tpr=0.9446 | fpr=0.0205 | 8008.7 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.13678 | acc=0.9779 | tpr=0.9424 | fpr=0.0214 | 8550.9 samples/s | 33.4 steps/s
[Step= 200] | Loss=0.13941 | acc=0.9777 | tpr=0.9464 | fpr=0.0218 | 8086.3 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.13805 | acc=0.9777 | tpr=0.9450 | fpr=0.0217 | 8170.4 samples/s | 31.9 steps/s
[Step= 300] | Loss=0.14073 | acc=0.9772 | tpr=0.9455 | fpr=0.0222 | 7427.1 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.14090 | acc=0.9771 | tpr=0.9474 | fpr=0.0224 | 7924.8 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.14248 | acc=0.9769 | tpr=0.9426 | fpr=0.0225 | 8225.4 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.14563 | acc=0.9765 | tpr=0.9416 | fpr=0.0229 | 8441.3 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.14508 | acc=0.9765 | tpr=0.9419 | fpr=0.0229 | 7459.7 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.14413 | acc=0.9767 | tpr=0.9407 | fpr=0.0227 | 14945.7 samples/s | 58.4 steps/s
Avg test loss: 0.14390, Avg test acc: 0.97667, Avg tpr: 0.94057, Avg fpr: 0.02267, total FA: 3148

server round 28/50

clients selected: [1 3 7 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=36001 Epoch=175.7] | Loss=0.02720 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.040 | L2-Norm(final)=11.716 | 3712.6 samples/s | 58.0 steps/s
[Step=36050 Epoch=175.9] | Loss=0.02576 | Reg=0.00122 | acc=0.9375 | L2-Norm=11.062 | L2-Norm(final)=11.697 | 5017.5 samples/s | 78.4 steps/s
[Step=36100 Epoch=176.2] | Loss=0.02291 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.091 | L2-Norm(final)=11.697 | 5066.2 samples/s | 79.2 steps/s
[Step=36150 Epoch=176.4] | Loss=0.02059 | Reg=0.00124 | acc=0.9688 | L2-Norm=11.114 | L2-Norm(final)=11.702 | 5243.8 samples/s | 81.9 steps/s
[Step=36200 Epoch=176.6] | Loss=0.01802 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.133 | L2-Norm(final)=11.710 | 7306.7 samples/s | 114.2 steps/s
[Step=36250 Epoch=176.9] | Loss=0.01661 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.150 | L2-Norm(final)=11.719 | 1819.0 samples/s | 28.4 steps/s
[Step=36300 Epoch=177.1] | Loss=0.01564 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.166 | L2-Norm(final)=11.729 | 5251.8 samples/s | 82.1 steps/s
[Step=36350 Epoch=177.4] | Loss=0.01525 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.183 | L2-Norm(final)=11.740 | 5201.9 samples/s | 81.3 steps/s
[Step=36400 Epoch=177.6] | Loss=0.01468 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.200 | L2-Norm(final)=11.752 | 6739.5 samples/s | 105.3 steps/s
[Step=36450 Epoch=177.9] | Loss=0.01382 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.217 | L2-Norm(final)=11.763 | 1870.5 samples/s | 29.2 steps/s
[Step=36500 Epoch=178.1] | Loss=0.01342 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.233 | L2-Norm(final)=11.776 | 5431.7 samples/s | 84.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=36501 Epoch=178.1] | Loss=0.00601 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.394 | L2-Norm(final)=11.901 | 3781.9 samples/s | 59.1 steps/s
[Step=36550 Epoch=178.3] | Loss=0.01367 | Reg=0.00130 | acc=0.9844 | L2-Norm=11.410 | L2-Norm(final)=11.911 | 4301.7 samples/s | 67.2 steps/s
[Step=36600 Epoch=178.6] | Loss=0.01941 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.431 | L2-Norm(final)=11.911 | 4618.2 samples/s | 72.2 steps/s
[Step=36650 Epoch=178.8] | Loss=0.01953 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.453 | L2-Norm(final)=11.909 | 4606.6 samples/s | 72.0 steps/s
[Step=36700 Epoch=179.1] | Loss=0.01874 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.473 | L2-Norm(final)=11.911 | 6173.7 samples/s | 96.5 steps/s
[Step=36750 Epoch=179.3] | Loss=0.01655 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.491 | L2-Norm(final)=11.915 | 1735.3 samples/s | 27.1 steps/s
[Step=36800 Epoch=179.6] | Loss=0.01464 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.506 | L2-Norm(final)=11.920 | 4461.2 samples/s | 69.7 steps/s
[Step=36850 Epoch=179.8] | Loss=0.01392 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.519 | L2-Norm(final)=11.925 | 4512.9 samples/s | 70.5 steps/s
[Step=36900 Epoch=180.1] | Loss=0.01325 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.530 | L2-Norm(final)=11.929 | 5746.9 samples/s | 89.8 steps/s
[Step=36950 Epoch=180.3] | Loss=0.01259 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.540 | L2-Norm(final)=11.934 | 1776.7 samples/s | 27.8 steps/s
[Step=37000 Epoch=180.5] | Loss=0.01197 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.549 | L2-Norm(final)=11.937 | 4626.6 samples/s | 72.3 steps/s
[Step=37050 Epoch=180.8] | Loss=0.01144 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.557 | L2-Norm(final)=11.941 | 4675.3 samples/s | 73.1 steps/s
[Step=37100 Epoch=181.0] | Loss=0.01097 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.564 | L2-Norm(final)=11.944 | 5559.0 samples/s | 86.9 steps/s
[Step=37150 Epoch=181.3] | Loss=0.01040 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.570 | L2-Norm(final)=11.947 | 1801.6 samples/s | 28.2 steps/s
[Step=37200 Epoch=181.5] | Loss=0.01007 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.576 | L2-Norm(final)=11.951 | 4738.5 samples/s | 74.0 steps/s
[Step=37250 Epoch=181.8] | Loss=0.00977 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.582 | L2-Norm(final)=11.953 | 4595.2 samples/s | 71.8 steps/s
[Step=37300 Epoch=182.0] | Loss=0.00947 | Reg=0.00134 | acc=0.9688 | L2-Norm=11.587 | L2-Norm(final)=11.956 | 5283.6 samples/s | 82.6 steps/s
[Step=37350 Epoch=182.3] | Loss=0.00917 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.591 | L2-Norm(final)=11.959 | 1847.5 samples/s | 28.9 steps/s
[Step=37400 Epoch=182.5] | Loss=0.00905 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.596 | L2-Norm(final)=11.962 | 4593.9 samples/s | 71.8 steps/s
[Step=37450 Epoch=182.7] | Loss=0.00885 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.601 | L2-Norm(final)=11.964 | 4655.7 samples/s | 72.7 steps/s
[Step=37500 Epoch=183.0] | Loss=0.00857 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.605 | L2-Norm(final)=11.967 | 4926.8 samples/s | 77.0 steps/s
[Step=37550 Epoch=183.2] | Loss=0.00828 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.609 | L2-Norm(final)=11.969 | 1920.2 samples/s | 30.0 steps/s
[Step=37600 Epoch=183.5] | Loss=0.00807 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.613 | L2-Norm(final)=11.972 | 4587.8 samples/s | 71.7 steps/s
[Step=37650 Epoch=183.7] | Loss=0.00791 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.617 | L2-Norm(final)=11.974 | 4738.2 samples/s | 74.0 steps/s
[Step=37700 Epoch=184.0] | Loss=0.00780 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.620 | L2-Norm(final)=11.977 | 4708.2 samples/s | 73.6 steps/s
[Step=37750 Epoch=184.2] | Loss=0.00762 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.624 | L2-Norm(final)=11.979 | 1925.3 samples/s | 30.1 steps/s
[Step=37800 Epoch=184.4] | Loss=0.00740 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.627 | L2-Norm(final)=11.981 | 4722.4 samples/s | 73.8 steps/s
[Step=37850 Epoch=184.7] | Loss=0.00731 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.630 | L2-Norm(final)=11.983 | 4692.0 samples/s | 73.3 steps/s
[Step=37900 Epoch=184.9] | Loss=0.00719 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.633 | L2-Norm(final)=11.985 | 4657.5 samples/s | 72.8 steps/s
[Step=37950 Epoch=185.2] | Loss=0.00706 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.636 | L2-Norm(final)=11.987 | 1900.9 samples/s | 29.7 steps/s
[Step=38000 Epoch=185.4] | Loss=0.00694 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.638 | L2-Norm(final)=11.989 | 4703.1 samples/s | 73.5 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step38000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=24001 Epoch=117.0] | Loss=0.01550 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.040 | L2-Norm(final)=10.517 | 3795.9 samples/s | 59.3 steps/s
[Step=24050 Epoch=117.3] | Loss=0.02303 | Reg=0.00122 | acc=0.9844 | L2-Norm=11.055 | L2-Norm(final)=10.510 | 5037.6 samples/s | 78.7 steps/s
[Step=24100 Epoch=117.5] | Loss=0.02103 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.079 | L2-Norm(final)=10.511 | 5427.7 samples/s | 84.8 steps/s
[Step=24150 Epoch=117.8] | Loss=0.02153 | Reg=0.00123 | acc=0.9844 | L2-Norm=11.103 | L2-Norm(final)=10.518 | 5342.8 samples/s | 83.5 steps/s
[Step=24200 Epoch=118.0] | Loss=0.01982 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.125 | L2-Norm(final)=10.523 | 7228.5 samples/s | 112.9 steps/s
[Step=24250 Epoch=118.3] | Loss=0.01907 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.147 | L2-Norm(final)=10.530 | 1805.4 samples/s | 28.2 steps/s
[Step=24300 Epoch=118.5] | Loss=0.01811 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.168 | L2-Norm(final)=10.539 | 5149.5 samples/s | 80.5 steps/s
[Step=24350 Epoch=118.7] | Loss=0.01722 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.188 | L2-Norm(final)=10.550 | 5125.2 samples/s | 80.1 steps/s
[Step=24400 Epoch=119.0] | Loss=0.01652 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.207 | L2-Norm(final)=10.561 | 6786.6 samples/s | 106.0 steps/s
[Step=24450 Epoch=119.2] | Loss=0.01586 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.225 | L2-Norm(final)=10.573 | 1885.8 samples/s | 29.5 steps/s
[Step=24500 Epoch=119.5] | Loss=0.01522 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.242 | L2-Norm(final)=10.585 | 5170.2 samples/s | 80.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=24501 Epoch=119.5] | Loss=0.00400 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.410 | L2-Norm(final)=10.709 | 3748.6 samples/s | 58.6 steps/s
[Step=24550 Epoch=119.7] | Loss=0.01066 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.430 | L2-Norm(final)=10.723 | 4506.4 samples/s | 70.4 steps/s
[Step=24600 Epoch=120.0] | Loss=0.01514 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.450 | L2-Norm(final)=10.730 | 4611.8 samples/s | 72.1 steps/s
[Step=24650 Epoch=120.2] | Loss=0.01577 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.469 | L2-Norm(final)=10.734 | 4668.1 samples/s | 72.9 steps/s
[Step=24700 Epoch=120.5] | Loss=0.01613 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.489 | L2-Norm(final)=10.738 | 6128.9 samples/s | 95.8 steps/s
[Step=24750 Epoch=120.7] | Loss=0.01476 | Reg=0.00132 | acc=1.0000 | L2-Norm=11.507 | L2-Norm(final)=10.743 | 1767.7 samples/s | 27.6 steps/s
[Step=24800 Epoch=120.9] | Loss=0.01359 | Reg=0.00133 | acc=0.9844 | L2-Norm=11.521 | L2-Norm(final)=10.748 | 4685.5 samples/s | 73.2 steps/s
[Step=24850 Epoch=121.2] | Loss=0.01280 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.533 | L2-Norm(final)=10.753 | 4620.9 samples/s | 72.2 steps/s
[Step=24900 Epoch=121.4] | Loss=0.01233 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.544 | L2-Norm(final)=10.757 | 5701.0 samples/s | 89.1 steps/s
[Step=24950 Epoch=121.7] | Loss=0.01185 | Reg=0.00133 | acc=1.0000 | L2-Norm=11.554 | L2-Norm(final)=10.761 | 1780.1 samples/s | 27.8 steps/s
[Step=25000 Epoch=121.9] | Loss=0.01117 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.563 | L2-Norm(final)=10.766 | 4731.7 samples/s | 73.9 steps/s
[Step=25050 Epoch=122.2] | Loss=0.01056 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.571 | L2-Norm(final)=10.770 | 4615.8 samples/s | 72.1 steps/s
[Step=25100 Epoch=122.4] | Loss=0.01015 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.579 | L2-Norm(final)=10.774 | 5378.0 samples/s | 84.0 steps/s
[Step=25150 Epoch=122.6] | Loss=0.00977 | Reg=0.00134 | acc=0.9844 | L2-Norm=11.586 | L2-Norm(final)=10.778 | 1802.5 samples/s | 28.2 steps/s
[Step=25200 Epoch=122.9] | Loss=0.00942 | Reg=0.00134 | acc=1.0000 | L2-Norm=11.592 | L2-Norm(final)=10.782 | 4579.1 samples/s | 71.5 steps/s
[Step=25250 Epoch=123.1] | Loss=0.00917 | Reg=0.00135 | acc=0.9844 | L2-Norm=11.598 | L2-Norm(final)=10.785 | 4662.7 samples/s | 72.9 steps/s
[Step=25300 Epoch=123.4] | Loss=0.00884 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.604 | L2-Norm(final)=10.788 | 4937.7 samples/s | 77.2 steps/s
[Step=25350 Epoch=123.6] | Loss=0.00851 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.609 | L2-Norm(final)=10.791 | 1884.6 samples/s | 29.4 steps/s
[Step=25400 Epoch=123.9] | Loss=0.00821 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.615 | L2-Norm(final)=10.795 | 4693.0 samples/s | 73.3 steps/s
[Step=25450 Epoch=124.1] | Loss=0.00806 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.619 | L2-Norm(final)=10.798 | 4624.3 samples/s | 72.3 steps/s
[Step=25500 Epoch=124.4] | Loss=0.00787 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.624 | L2-Norm(final)=10.801 | 4954.5 samples/s | 77.4 steps/s
[Step=25550 Epoch=124.6] | Loss=0.00765 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.628 | L2-Norm(final)=10.804 | 1910.2 samples/s | 29.8 steps/s
[Step=25600 Epoch=124.8] | Loss=0.00741 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.633 | L2-Norm(final)=10.807 | 4713.1 samples/s | 73.6 steps/s
[Step=25650 Epoch=125.1] | Loss=0.00724 | Reg=0.00135 | acc=1.0000 | L2-Norm=11.637 | L2-Norm(final)=10.810 | 4603.7 samples/s | 71.9 steps/s
[Step=25700 Epoch=125.3] | Loss=0.00705 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.641 | L2-Norm(final)=10.813 | 4625.4 samples/s | 72.3 steps/s
[Step=25750 Epoch=125.6] | Loss=0.00697 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.645 | L2-Norm(final)=10.816 | 1890.2 samples/s | 29.5 steps/s
[Step=25800 Epoch=125.8] | Loss=0.00684 | Reg=0.00136 | acc=0.9844 | L2-Norm=11.648 | L2-Norm(final)=10.818 | 4663.7 samples/s | 72.9 steps/s
[Step=25850 Epoch=126.1] | Loss=0.00666 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.652 | L2-Norm(final)=10.821 | 4579.5 samples/s | 71.6 steps/s
[Step=25900 Epoch=126.3] | Loss=0.00659 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.655 | L2-Norm(final)=10.824 | 4563.2 samples/s | 71.3 steps/s
[Step=25950 Epoch=126.5] | Loss=0.00650 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.659 | L2-Norm(final)=10.826 | 1926.3 samples/s | 30.1 steps/s
[Step=26000 Epoch=126.8] | Loss=0.00636 | Reg=0.00136 | acc=1.0000 | L2-Norm=11.662 | L2-Norm(final)=10.829 | 4677.6 samples/s | 73.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step26000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=30001 Epoch=286.5] | Loss=0.00109 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.040 | L2-Norm(final)=8.095 | 3821.5 samples/s | 59.7 steps/s
[Step=30050 Epoch=287.0] | Loss=0.00176 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.086 | L2-Norm(final)=8.103 | 4252.0 samples/s | 66.4 steps/s
[Step=30100 Epoch=287.4] | Loss=0.00107 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.126 | L2-Norm(final)=8.118 | 7072.0 samples/s | 110.5 steps/s
[Step=30150 Epoch=287.9] | Loss=0.00077 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.143 | L2-Norm(final)=8.129 | 1729.1 samples/s | 27.0 steps/s
[Step=30200 Epoch=288.4] | Loss=0.00062 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.149 | L2-Norm(final)=8.138 | 6749.8 samples/s | 105.5 steps/s
[Step=30250 Epoch=288.9] | Loss=0.00051 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=8.147 | 1768.6 samples/s | 27.6 steps/s
[Step=30300 Epoch=289.3] | Loss=0.00043 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.151 | L2-Norm(final)=8.154 | 5847.2 samples/s | 91.4 steps/s
[Step=30350 Epoch=289.8] | Loss=0.00038 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.149 | L2-Norm(final)=8.160 | 1811.7 samples/s | 28.3 steps/s
[Step=30400 Epoch=290.3] | Loss=0.00034 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.146 | L2-Norm(final)=8.166 | 5544.8 samples/s | 86.6 steps/s
[Step=30450 Epoch=290.8] | Loss=0.00031 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.142 | L2-Norm(final)=8.172 | 1854.4 samples/s | 29.0 steps/s
[Step=30500 Epoch=291.3] | Loss=0.00028 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.138 | L2-Norm(final)=8.177 | 5226.1 samples/s | 81.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=30501 Epoch=291.3] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.092 | L2-Norm(final)=8.227 | 3603.7 samples/s | 56.3 steps/s
[Step=30550 Epoch=291.7] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.074 | L2-Norm(final)=8.231 | 4158.0 samples/s | 65.0 steps/s
[Step=30600 Epoch=292.2] | Loss=0.00003 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.052 | L2-Norm(final)=8.233 | 5848.2 samples/s | 91.4 steps/s
[Step=30650 Epoch=292.7] | Loss=0.00002 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.031 | L2-Norm(final)=8.235 | 1695.6 samples/s | 26.5 steps/s
[Step=30700 Epoch=293.2] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.007 | L2-Norm(final)=8.237 | 5586.3 samples/s | 87.3 steps/s
[Step=30750 Epoch=293.6] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.983 | L2-Norm(final)=8.238 | 1733.2 samples/s | 27.1 steps/s
[Step=30800 Epoch=294.1] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.958 | L2-Norm(final)=8.239 | 5198.0 samples/s | 81.2 steps/s
[Step=30850 Epoch=294.6] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.932 | L2-Norm(final)=8.239 | 1776.6 samples/s | 27.8 steps/s
[Step=30900 Epoch=295.1] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.906 | L2-Norm(final)=8.240 | 4953.0 samples/s | 77.4 steps/s
[Step=30950 Epoch=295.6] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.880 | L2-Norm(final)=8.240 | 1774.2 samples/s | 27.7 steps/s
[Step=31000 Epoch=296.0] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.853 | L2-Norm(final)=8.241 | 4697.0 samples/s | 73.4 steps/s
[Step=31050 Epoch=296.5] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.826 | L2-Norm(final)=8.241 | 1785.5 samples/s | 27.9 steps/s
[Step=31100 Epoch=297.0] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.800 | L2-Norm(final)=8.241 | 4428.6 samples/s | 69.2 steps/s
[Step=31150 Epoch=297.5] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=8.242 | 1853.8 samples/s | 29.0 steps/s
[Step=31200 Epoch=297.9] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.745 | L2-Norm(final)=8.242 | 4437.3 samples/s | 69.3 steps/s
[Step=31250 Epoch=298.4] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.718 | L2-Norm(final)=8.242 | 1845.6 samples/s | 28.8 steps/s
[Step=31300 Epoch=298.9] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.690 | L2-Norm(final)=8.242 | 4234.5 samples/s | 66.2 steps/s
[Step=31350 Epoch=299.4] | Loss=0.00000 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.662 | L2-Norm(final)=8.243 | 1881.9 samples/s | 29.4 steps/s
[Step=31400 Epoch=299.9] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.635 | L2-Norm(final)=8.243 | 4325.0 samples/s | 67.6 steps/s
[Step=31450 Epoch=300.3] | Loss=0.00000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.606 | L2-Norm(final)=8.243 | 1884.0 samples/s | 29.4 steps/s
[Step=31500 Epoch=300.8] | Loss=0.00000 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.578 | L2-Norm(final)=8.243 | 4332.7 samples/s | 67.7 steps/s
[Step=31550 Epoch=301.3] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.550 | L2-Norm(final)=8.244 | 6414.9 samples/s | 100.2 steps/s
[Step=31600 Epoch=301.8] | Loss=0.00000 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.521 | L2-Norm(final)=8.244 | 1644.7 samples/s | 25.7 steps/s
[Step=31650 Epoch=302.2] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.492 | L2-Norm(final)=8.244 | 5958.7 samples/s | 93.1 steps/s
[Step=31700 Epoch=302.7] | Loss=0.00000 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.464 | L2-Norm(final)=8.244 | 1679.8 samples/s | 26.2 steps/s
[Step=31750 Epoch=303.2] | Loss=0.00000 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.434 | L2-Norm(final)=8.245 | 5537.2 samples/s | 86.5 steps/s
[Step=31800 Epoch=303.7] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.405 | L2-Norm(final)=8.245 | 1699.0 samples/s | 26.5 steps/s
[Step=31850 Epoch=304.1] | Loss=0.00000 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.376 | L2-Norm(final)=8.245 | 5379.0 samples/s | 84.0 steps/s
[Step=31900 Epoch=304.6] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.346 | L2-Norm(final)=8.246 | 1787.5 samples/s | 27.9 steps/s
[Step=31950 Epoch=305.1] | Loss=0.00000 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.316 | L2-Norm(final)=8.246 | 5133.9 samples/s | 80.2 steps/s
[Step=32000 Epoch=305.6] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=8.246 | 1786.0 samples/s | 27.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step32000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=26001 Epoch=245.0] | Loss=0.00051 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.040 | L2-Norm(final)=8.300 | 3789.4 samples/s | 59.2 steps/s
[Step=26050 Epoch=245.5] | Loss=0.00280 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.072 | L2-Norm(final)=8.295 | 4519.5 samples/s | 70.6 steps/s
[Step=26100 Epoch=245.9] | Loss=0.00175 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.097 | L2-Norm(final)=8.301 | 6823.6 samples/s | 106.6 steps/s
[Step=26150 Epoch=246.4] | Loss=0.00124 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.107 | L2-Norm(final)=8.307 | 1771.5 samples/s | 27.7 steps/s
[Step=26200 Epoch=246.9] | Loss=0.00097 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.112 | L2-Norm(final)=8.313 | 6180.8 samples/s | 96.6 steps/s
[Step=26250 Epoch=247.3] | Loss=0.00079 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.114 | L2-Norm(final)=8.318 | 1825.6 samples/s | 28.5 steps/s
[Step=26300 Epoch=247.8] | Loss=0.00068 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.114 | L2-Norm(final)=8.323 | 5505.7 samples/s | 86.0 steps/s
[Step=26350 Epoch=248.3] | Loss=0.00059 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.113 | L2-Norm(final)=8.327 | 1849.9 samples/s | 28.9 steps/s
[Step=26400 Epoch=248.8] | Loss=0.00053 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.112 | L2-Norm(final)=8.331 | 5120.0 samples/s | 80.0 steps/s
[Step=26450 Epoch=249.2] | Loss=0.00048 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.109 | L2-Norm(final)=8.335 | 1923.0 samples/s | 30.0 steps/s
[Step=26500 Epoch=249.7] | Loss=0.00043 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.107 | L2-Norm(final)=8.339 | 4840.9 samples/s | 75.6 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=249.7] | Loss=0.00000 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.080 | L2-Norm(final)=8.376 | 3718.3 samples/s | 58.1 steps/s
[Step=26550 Epoch=250.2] | Loss=0.00004 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.074 | L2-Norm(final)=8.378 | 4277.1 samples/s | 66.8 steps/s
[Step=26600 Epoch=250.6] | Loss=0.00004 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.068 | L2-Norm(final)=8.381 | 6000.0 samples/s | 93.8 steps/s
[Step=26650 Epoch=251.1] | Loss=0.00004 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.062 | L2-Norm(final)=8.384 | 1708.7 samples/s | 26.7 steps/s
[Step=26700 Epoch=251.6] | Loss=0.00003 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.055 | L2-Norm(final)=8.385 | 5333.9 samples/s | 83.3 steps/s
[Step=26750 Epoch=252.1] | Loss=0.00003 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.047 | L2-Norm(final)=8.387 | 1730.2 samples/s | 27.0 steps/s
[Step=26800 Epoch=252.5] | Loss=0.00003 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.040 | L2-Norm(final)=8.388 | 4975.7 samples/s | 77.7 steps/s
[Step=26850 Epoch=253.0] | Loss=0.00002 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.032 | L2-Norm(final)=8.389 | 1827.6 samples/s | 28.6 steps/s
[Step=26900 Epoch=253.5] | Loss=0.00002 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.024 | L2-Norm(final)=8.391 | 4492.1 samples/s | 70.2 steps/s
[Step=26950 Epoch=253.9] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.016 | L2-Norm(final)=8.392 | 1839.6 samples/s | 28.7 steps/s
[Step=27000 Epoch=254.4] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.008 | L2-Norm(final)=8.393 | 4483.1 samples/s | 70.0 steps/s
[Step=27050 Epoch=254.9] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.999 | L2-Norm(final)=8.394 | 1671.2 samples/s | 26.1 steps/s
[Step=27100 Epoch=255.4] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.991 | L2-Norm(final)=8.395 | 3904.6 samples/s | 61.0 steps/s
[Step=27150 Epoch=255.8] | Loss=0.00002 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.983 | L2-Norm(final)=8.396 | 1758.4 samples/s | 27.5 steps/s
[Step=27200 Epoch=256.3] | Loss=0.00002 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.974 | L2-Norm(final)=8.396 | 3934.8 samples/s | 61.5 steps/s
[Step=27250 Epoch=256.8] | Loss=0.00002 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.966 | L2-Norm(final)=8.397 | 2063.7 samples/s | 32.2 steps/s
[Step=27300 Epoch=257.2] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.957 | L2-Norm(final)=8.398 | 3806.3 samples/s | 59.5 steps/s
[Step=27350 Epoch=257.7] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.948 | L2-Norm(final)=8.399 | 5920.7 samples/s | 92.5 steps/s
[Step=27400 Epoch=258.2] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.939 | L2-Norm(final)=8.400 | 1722.8 samples/s | 26.9 steps/s
[Step=27450 Epoch=258.7] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.930 | L2-Norm(final)=8.400 | 5603.4 samples/s | 87.6 steps/s
[Step=27500 Epoch=259.1] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.921 | L2-Norm(final)=8.401 | 1760.8 samples/s | 27.5 steps/s
[Step=27550 Epoch=259.6] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.912 | L2-Norm(final)=8.402 | 5009.2 samples/s | 78.3 steps/s
[Step=27600 Epoch=260.1] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.903 | L2-Norm(final)=8.403 | 1765.6 samples/s | 27.6 steps/s
[Step=27650 Epoch=260.5] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.894 | L2-Norm(final)=8.403 | 4622.4 samples/s | 72.2 steps/s
[Step=27700 Epoch=261.0] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.884 | L2-Norm(final)=8.404 | 1820.5 samples/s | 28.4 steps/s
[Step=27750 Epoch=261.5] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.875 | L2-Norm(final)=8.405 | 4416.7 samples/s | 69.0 steps/s
[Step=27800 Epoch=262.0] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.865 | L2-Norm(final)=8.406 | 1910.0 samples/s | 29.8 steps/s
[Step=27850 Epoch=262.4] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.856 | L2-Norm(final)=8.406 | 4569.0 samples/s | 71.4 steps/s
[Step=27900 Epoch=262.9] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.846 | L2-Norm(final)=8.407 | 1851.8 samples/s | 28.9 steps/s
[Step=27950 Epoch=263.4] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.836 | L2-Norm(final)=8.408 | 4467.9 samples/s | 69.8 steps/s
[Step=28000 Epoch=263.8] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.827 | L2-Norm(final)=8.408 | 1927.1 samples/s | 30.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step28000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=28001 Epoch=266.9] | Loss=0.00012 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.040 | L2-Norm(final)=8.841 | 3428.0 samples/s | 53.6 steps/s
[Step=28050 Epoch=267.3] | Loss=0.00400 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.119 | L2-Norm(final)=8.848 | 5008.4 samples/s | 78.3 steps/s
[Step=28100 Epoch=267.8] | Loss=0.00254 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.170 | L2-Norm(final)=8.862 | 7013.4 samples/s | 109.6 steps/s
[Step=28150 Epoch=268.3] | Loss=0.00176 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.195 | L2-Norm(final)=8.873 | 1737.8 samples/s | 27.2 steps/s
[Step=28200 Epoch=268.8] | Loss=0.00135 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.206 | L2-Norm(final)=8.881 | 6490.3 samples/s | 101.4 steps/s
[Step=28250 Epoch=269.2] | Loss=0.00110 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.211 | L2-Norm(final)=8.888 | 1810.4 samples/s | 28.3 steps/s
[Step=28300 Epoch=269.7] | Loss=0.00093 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.213 | L2-Norm(final)=8.895 | 5913.4 samples/s | 92.4 steps/s
[Step=28350 Epoch=270.2] | Loss=0.00082 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.214 | L2-Norm(final)=8.900 | 1811.5 samples/s | 28.3 steps/s
[Step=28400 Epoch=270.7] | Loss=0.00072 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.213 | L2-Norm(final)=8.905 | 5771.8 samples/s | 90.2 steps/s
[Step=28450 Epoch=271.2] | Loss=0.00065 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.212 | L2-Norm(final)=8.910 | 1869.0 samples/s | 29.2 steps/s
[Step=28500 Epoch=271.6] | Loss=0.00059 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.210 | L2-Norm(final)=8.915 | 5227.1 samples/s | 81.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=271.6] | Loss=0.00010 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.187 | L2-Norm(final)=8.961 | 3562.0 samples/s | 55.7 steps/s
[Step=28550 Epoch=272.1] | Loss=0.00005 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.179 | L2-Norm(final)=8.965 | 4219.9 samples/s | 65.9 steps/s
[Step=28600 Epoch=272.6] | Loss=0.00004 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.168 | L2-Norm(final)=8.967 | 5861.0 samples/s | 91.6 steps/s
[Step=28650 Epoch=273.1] | Loss=0.00003 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=8.969 | 1683.5 samples/s | 26.3 steps/s
[Step=28700 Epoch=273.5] | Loss=0.00002 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.142 | L2-Norm(final)=8.970 | 5503.0 samples/s | 86.0 steps/s
[Step=28750 Epoch=274.0] | Loss=0.00002 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.128 | L2-Norm(final)=8.971 | 1742.0 samples/s | 27.2 steps/s
[Step=28800 Epoch=274.5] | Loss=0.00002 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.114 | L2-Norm(final)=8.972 | 5227.9 samples/s | 81.7 steps/s
[Step=28850 Epoch=275.0] | Loss=0.00002 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.099 | L2-Norm(final)=8.972 | 1740.3 samples/s | 27.2 steps/s
[Step=28900 Epoch=275.4] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.085 | L2-Norm(final)=8.973 | 4903.1 samples/s | 76.6 steps/s
[Step=28950 Epoch=275.9] | Loss=0.00001 | Reg=0.00123 | acc=1.0000 | L2-Norm=11.070 | L2-Norm(final)=8.974 | 1822.6 samples/s | 28.5 steps/s
[Step=29000 Epoch=276.4] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.055 | L2-Norm(final)=8.974 | 4796.5 samples/s | 74.9 steps/s
[Step=29050 Epoch=276.9] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.040 | L2-Norm(final)=8.975 | 1836.4 samples/s | 28.7 steps/s
[Step=29100 Epoch=277.3] | Loss=0.00001 | Reg=0.00122 | acc=1.0000 | L2-Norm=11.025 | L2-Norm(final)=8.975 | 4521.1 samples/s | 70.6 steps/s
[Step=29150 Epoch=277.8] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.009 | L2-Norm(final)=8.976 | 1852.7 samples/s | 28.9 steps/s
[Step=29200 Epoch=278.3] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.994 | L2-Norm(final)=8.976 | 4443.1 samples/s | 69.4 steps/s
[Step=29250 Epoch=278.8] | Loss=0.00001 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.978 | L2-Norm(final)=8.977 | 1889.8 samples/s | 29.5 steps/s
[Step=29300 Epoch=279.3] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.962 | L2-Norm(final)=8.977 | 4403.5 samples/s | 68.8 steps/s
[Step=29350 Epoch=279.7] | Loss=0.00001 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.946 | L2-Norm(final)=8.978 | 1878.5 samples/s | 29.4 steps/s
[Step=29400 Epoch=280.2] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.930 | L2-Norm(final)=8.978 | 4343.9 samples/s | 67.9 steps/s
[Step=29450 Epoch=280.7] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.914 | L2-Norm(final)=8.979 | 1913.7 samples/s | 29.9 steps/s
[Step=29500 Epoch=281.2] | Loss=0.00001 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.897 | L2-Norm(final)=8.979 | 4509.2 samples/s | 70.5 steps/s
[Step=29550 Epoch=281.6] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.881 | L2-Norm(final)=8.979 | 6483.6 samples/s | 101.3 steps/s
[Step=29600 Epoch=282.1] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.864 | L2-Norm(final)=8.980 | 1655.3 samples/s | 25.9 steps/s
[Step=29650 Epoch=282.6] | Loss=0.00001 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.847 | L2-Norm(final)=8.980 | 5955.2 samples/s | 93.0 steps/s
[Step=29700 Epoch=283.1] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.830 | L2-Norm(final)=8.981 | 1690.3 samples/s | 26.4 steps/s
[Step=29750 Epoch=283.5] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.813 | L2-Norm(final)=8.981 | 5522.5 samples/s | 86.3 steps/s
[Step=29800 Epoch=284.0] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.795 | L2-Norm(final)=8.982 | 1699.8 samples/s | 26.6 steps/s
[Step=29850 Epoch=284.5] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.778 | L2-Norm(final)=8.982 | 5182.6 samples/s | 81.0 steps/s
[Step=29900 Epoch=285.0] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.760 | L2-Norm(final)=8.982 | 1828.7 samples/s | 28.6 steps/s
[Step=29950 Epoch=285.5] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.743 | L2-Norm(final)=8.983 | 4879.4 samples/s | 76.2 steps/s
[Step=30000 Epoch=285.9] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.725 | L2-Norm(final)=8.983 | 1780.2 samples/s | 27.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step30000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09463 | acc=0.9635 | tpr=0.9774 | fpr=0.0667 | 4092.7 samples/s | 16.0 steps/s
Avg test loss: 0.09743, Avg test acc: 0.96170, Avg tpr: 0.97622, Avg fpr: 0.07025, total FA: 548

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09845 | acc=0.9610 | tpr=0.9798 | fpr=0.0798 | 4166.1 samples/s | 16.3 steps/s
Avg test loss: 0.10234, Avg test acc: 0.95973, Avg tpr: 0.97803, Avg fpr: 0.08050, total FA: 628

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09768 | acc=0.9595 | tpr=0.9728 | fpr=0.0696 | 4151.0 samples/s | 16.2 steps/s
Avg test loss: 0.10295, Avg test acc: 0.95889, Avg tpr: 0.97162, Avg fpr: 0.06909, total FA: 539

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09676 | acc=0.9596 | tpr=0.9783 | fpr=0.0810 | 4148.7 samples/s | 16.2 steps/s
Avg test loss: 0.10151, Avg test acc: 0.95929, Avg tpr: 0.97814, Avg fpr: 0.08217, total FA: 641

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.09521 | acc=0.9609 | tpr=0.9686 | fpr=0.0560 | 4073.6 samples/s | 15.9 steps/s
Avg test loss: 0.10246, Avg test acc: 0.95849, Avg tpr: 0.96666, Avg fpr: 0.05948, total FA: 464

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.14565 | acc=0.2779 | tpr=0.0035 | fpr=0.1264 | 4164.4 samples/s | 16.3 steps/s
Avg test loss: 5.16158, Avg test acc: 0.27638, Avg tpr: 0.00455, Avg fpr: 0.12575, total FA: 981

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.91304 | acc=0.3082 | tpr=0.0047 | fpr=0.0327 | 4177.2 samples/s | 16.3 steps/s
Avg test loss: 4.91786, Avg test acc: 0.30639, Avg tpr: 0.00670, Avg fpr: 0.03448, total FA: 269

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.24910 | acc=0.2991 | tpr=0.0039 | fpr=0.0600 | 4165.9 samples/s | 16.3 steps/s
Avg test loss: 5.26029, Avg test acc: 0.29718, Avg tpr: 0.00484, Avg fpr: 0.05986, total FA: 467

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.05681 | acc=0.2992 | tpr=0.0070 | fpr=0.0662 | 4116.8 samples/s | 16.1 steps/s
Avg test loss: 5.06455, Avg test acc: 0.29738, Avg tpr: 0.00804, Avg fpr: 0.06627, total FA: 517

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.01211 | acc=0.3117 | tpr=0.0017 | fpr=0.0151 | 4114.9 samples/s | 16.1 steps/s
Avg test loss: 5.02272, Avg test acc: 0.30928, Avg tpr: 0.00239, Avg fpr: 0.01577, total FA: 123

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.80092 | acc=0.1128 | tpr=0.8451 | fpr=0.9003 | 3970.6 samples/s | 15.5 steps/s
[Step= 100] | Loss=5.74651 | acc=0.1141 | tpr=0.8294 | fpr=0.8992 | 7749.1 samples/s | 30.3 steps/s
[Step= 150] | Loss=5.75303 | acc=0.1126 | tpr=0.8285 | fpr=0.9006 | 7905.9 samples/s | 30.9 steps/s
[Step= 200] | Loss=5.75101 | acc=0.1119 | tpr=0.8240 | fpr=0.9011 | 8190.5 samples/s | 32.0 steps/s
[Step= 250] | Loss=5.75754 | acc=0.1122 | tpr=0.8236 | fpr=0.9007 | 8388.3 samples/s | 32.8 steps/s
[Step= 300] | Loss=5.75475 | acc=0.1121 | tpr=0.8233 | fpr=0.9008 | 7560.1 samples/s | 29.5 steps/s
[Step= 350] | Loss=5.75108 | acc=0.1118 | tpr=0.8178 | fpr=0.9010 | 8341.5 samples/s | 32.6 steps/s
[Step= 400] | Loss=5.75319 | acc=0.1121 | tpr=0.8140 | fpr=0.9006 | 7927.0 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.75608 | acc=0.1119 | tpr=0.8111 | fpr=0.9008 | 7957.4 samples/s | 31.1 steps/s
[Step= 500] | Loss=5.75972 | acc=0.1118 | tpr=0.8101 | fpr=0.9008 | 7816.9 samples/s | 30.5 steps/s
[Step= 550] | Loss=5.76012 | acc=0.1117 | tpr=0.8142 | fpr=0.9010 | 14408.4 samples/s | 56.3 steps/s
Avg test loss: 5.76168, Avg test acc: 0.11170, Avg tpr: 0.81418, Avg fpr: 0.90107, total FA: 125112

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.32374 | acc=0.1128 | tpr=0.7832 | fpr=0.8992 | 4156.3 samples/s | 16.2 steps/s
[Step= 100] | Loss=5.27042 | acc=0.1125 | tpr=0.7292 | fpr=0.8990 | 7951.3 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.27539 | acc=0.1100 | tpr=0.7176 | fpr=0.9012 | 8261.6 samples/s | 32.3 steps/s
[Step= 200] | Loss=5.27122 | acc=0.1103 | tpr=0.7104 | fpr=0.9006 | 8342.1 samples/s | 32.6 steps/s
[Step= 250] | Loss=5.27240 | acc=0.1106 | tpr=0.7039 | fpr=0.9002 | 8185.0 samples/s | 32.0 steps/s
[Step= 300] | Loss=5.27221 | acc=0.1102 | tpr=0.7062 | fpr=0.9007 | 7911.9 samples/s | 30.9 steps/s
[Step= 350] | Loss=5.26717 | acc=0.1100 | tpr=0.7019 | fpr=0.9008 | 7923.3 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.26706 | acc=0.1102 | tpr=0.7024 | fpr=0.9005 | 8387.7 samples/s | 32.8 steps/s
[Step= 450] | Loss=5.27177 | acc=0.1103 | tpr=0.7016 | fpr=0.9005 | 7870.0 samples/s | 30.7 steps/s
[Step= 500] | Loss=5.27741 | acc=0.1098 | tpr=0.7013 | fpr=0.9009 | 7675.1 samples/s | 30.0 steps/s
[Step= 550] | Loss=5.27729 | acc=0.1094 | tpr=0.7047 | fpr=0.9014 | 14946.8 samples/s | 58.4 steps/s
Avg test loss: 5.27854, Avg test acc: 0.10942, Avg tpr: 0.70483, Avg fpr: 0.90140, total FA: 125158

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.17457 | acc=0.1120 | tpr=0.7699 | fpr=0.8999 | 4077.6 samples/s | 15.9 steps/s
[Step= 100] | Loss=6.11646 | acc=0.1143 | tpr=0.7484 | fpr=0.8975 | 8135.4 samples/s | 31.8 steps/s
[Step= 150] | Loss=6.12945 | acc=0.1121 | tpr=0.7608 | fpr=0.8998 | 8669.0 samples/s | 33.9 steps/s
[Step= 200] | Loss=6.13057 | acc=0.1116 | tpr=0.7574 | fpr=0.9001 | 7596.8 samples/s | 29.7 steps/s
[Step= 250] | Loss=6.13295 | acc=0.1120 | tpr=0.7616 | fpr=0.8999 | 7909.5 samples/s | 30.9 steps/s
[Step= 300] | Loss=6.12957 | acc=0.1118 | tpr=0.7629 | fpr=0.9001 | 8092.5 samples/s | 31.6 steps/s
[Step= 350] | Loss=6.12785 | acc=0.1115 | tpr=0.7564 | fpr=0.9002 | 8381.1 samples/s | 32.7 steps/s
[Step= 400] | Loss=6.12920 | acc=0.1120 | tpr=0.7560 | fpr=0.8997 | 8056.6 samples/s | 31.5 steps/s
[Step= 450] | Loss=6.13266 | acc=0.1114 | tpr=0.7537 | fpr=0.9003 | 7858.7 samples/s | 30.7 steps/s
[Step= 500] | Loss=6.13389 | acc=0.1112 | tpr=0.7529 | fpr=0.9004 | 7944.5 samples/s | 31.0 steps/s
[Step= 550] | Loss=6.13255 | acc=0.1111 | tpr=0.7573 | fpr=0.9006 | 14696.4 samples/s | 57.4 steps/s
Avg test loss: 6.13418, Avg test acc: 0.11106, Avg tpr: 0.75674, Avg fpr: 0.90068, total FA: 125057

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.64969 | acc=0.1169 | tpr=0.7920 | fpr=0.8953 | 4082.5 samples/s | 15.9 steps/s
[Step= 100] | Loss=5.59837 | acc=0.1176 | tpr=0.7719 | fpr=0.8946 | 8071.7 samples/s | 31.5 steps/s
[Step= 150] | Loss=5.59993 | acc=0.1156 | tpr=0.7781 | fpr=0.8966 | 8095.6 samples/s | 31.6 steps/s
[Step= 200] | Loss=5.59460 | acc=0.1154 | tpr=0.7705 | fpr=0.8965 | 8087.4 samples/s | 31.6 steps/s
[Step= 250] | Loss=5.59432 | acc=0.1161 | tpr=0.7773 | fpr=0.8960 | 8761.2 samples/s | 34.2 steps/s
[Step= 300] | Loss=5.59287 | acc=0.1154 | tpr=0.7753 | fpr=0.8966 | 7699.9 samples/s | 30.1 steps/s
[Step= 350] | Loss=5.58699 | acc=0.1154 | tpr=0.7708 | fpr=0.8965 | 8855.4 samples/s | 34.6 steps/s
[Step= 400] | Loss=5.59153 | acc=0.1153 | tpr=0.7675 | fpr=0.8965 | 8083.0 samples/s | 31.6 steps/s
[Step= 450] | Loss=5.59644 | acc=0.1150 | tpr=0.7629 | fpr=0.8968 | 8263.7 samples/s | 32.3 steps/s
[Step= 500] | Loss=5.60159 | acc=0.1146 | tpr=0.7621 | fpr=0.8971 | 7947.1 samples/s | 31.0 steps/s
[Step= 550] | Loss=5.60079 | acc=0.1144 | tpr=0.7648 | fpr=0.8974 | 14365.0 samples/s | 56.1 steps/s
Avg test loss: 5.60252, Avg test acc: 0.11439, Avg tpr: 0.76426, Avg fpr: 0.89743, total FA: 124606

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.57176 | acc=0.1241 | tpr=0.6106 | fpr=0.8846 | 4119.3 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.51102 | acc=0.1263 | tpr=0.5629 | fpr=0.8818 | 8130.9 samples/s | 31.8 steps/s
[Step= 150] | Loss=5.51292 | acc=0.1252 | tpr=0.5591 | fpr=0.8828 | 8172.2 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.50918 | acc=0.1250 | tpr=0.5607 | fpr=0.8830 | 8249.3 samples/s | 32.2 steps/s
[Step= 250] | Loss=5.51396 | acc=0.1249 | tpr=0.5581 | fpr=0.8830 | 7973.8 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.50873 | acc=0.1245 | tpr=0.5615 | fpr=0.8834 | 8510.4 samples/s | 33.2 steps/s
[Step= 350] | Loss=5.50437 | acc=0.1241 | tpr=0.5548 | fpr=0.8837 | 7933.8 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.50727 | acc=0.1243 | tpr=0.5509 | fpr=0.8834 | 8600.0 samples/s | 33.6 steps/s
[Step= 450] | Loss=5.50866 | acc=0.1240 | tpr=0.5448 | fpr=0.8836 | 7773.4 samples/s | 30.4 steps/s
[Step= 500] | Loss=5.50981 | acc=0.1237 | tpr=0.5388 | fpr=0.8837 | 8107.3 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.51077 | acc=0.1235 | tpr=0.5376 | fpr=0.8840 | 15330.4 samples/s | 59.9 steps/s
Avg test loss: 5.51300, Avg test acc: 0.12345, Avg tpr: 0.53764, Avg fpr: 0.88408, total FA: 122753

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10641 | acc=0.9806 | tpr=0.9248 | fpr=0.0184 | 4125.2 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.11021 | acc=0.9798 | tpr=0.9467 | fpr=0.0196 | 7942.9 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.11488 | acc=0.9786 | tpr=0.9467 | fpr=0.0208 | 8165.9 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.11657 | acc=0.9785 | tpr=0.9497 | fpr=0.0210 | 8004.1 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.11569 | acc=0.9785 | tpr=0.9450 | fpr=0.0209 | 8078.0 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.11773 | acc=0.9782 | tpr=0.9425 | fpr=0.0211 | 8138.4 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.11774 | acc=0.9781 | tpr=0.9424 | fpr=0.0212 | 7892.7 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.11920 | acc=0.9779 | tpr=0.9393 | fpr=0.0214 | 8225.6 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.12194 | acc=0.9776 | tpr=0.9391 | fpr=0.0217 | 8124.9 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.12162 | acc=0.9776 | tpr=0.9405 | fpr=0.0218 | 8041.5 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.12046 | acc=0.9778 | tpr=0.9403 | fpr=0.0215 | 14725.2 samples/s | 57.5 steps/s
Avg test loss: 0.12032, Avg test acc: 0.97780, Avg tpr: 0.94057, Avg fpr: 0.02152, total FA: 2988

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12098 | acc=0.9810 | tpr=0.8938 | fpr=0.0174 | 4069.5 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.12524 | acc=0.9804 | tpr=0.9083 | fpr=0.0182 | 8102.7 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.13038 | acc=0.9795 | tpr=0.9063 | fpr=0.0192 | 8093.0 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.13214 | acc=0.9796 | tpr=0.9148 | fpr=0.0192 | 8016.3 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.13045 | acc=0.9797 | tpr=0.9135 | fpr=0.0191 | 8496.0 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.13274 | acc=0.9792 | tpr=0.9120 | fpr=0.0196 | 7808.4 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.13276 | acc=0.9792 | tpr=0.9167 | fpr=0.0197 | 8073.1 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.13414 | acc=0.9789 | tpr=0.9125 | fpr=0.0198 | 7964.1 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.13748 | acc=0.9787 | tpr=0.9114 | fpr=0.0201 | 7912.5 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.13673 | acc=0.9788 | tpr=0.9150 | fpr=0.0201 | 8109.3 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.13557 | acc=0.9789 | tpr=0.9152 | fpr=0.0199 | 14292.8 samples/s | 55.8 steps/s
Avg test loss: 0.13535, Avg test acc: 0.97895, Avg tpr: 0.91442, Avg fpr: 0.01988, total FA: 2760

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10786 | acc=0.9792 | tpr=0.9381 | fpr=0.0200 | 4115.4 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.11218 | acc=0.9793 | tpr=0.9574 | fpr=0.0203 | 8183.5 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.11644 | acc=0.9783 | tpr=0.9539 | fpr=0.0212 | 8017.5 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.11884 | acc=0.9783 | tpr=0.9563 | fpr=0.0213 | 8137.6 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.11794 | acc=0.9784 | tpr=0.9537 | fpr=0.0212 | 8115.3 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.12011 | acc=0.9779 | tpr=0.9549 | fpr=0.0217 | 7935.7 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.12009 | acc=0.9777 | tpr=0.9549 | fpr=0.0218 | 7876.6 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.12147 | acc=0.9776 | tpr=0.9530 | fpr=0.0219 | 7981.1 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.12440 | acc=0.9774 | tpr=0.9528 | fpr=0.0222 | 8325.7 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.12404 | acc=0.9774 | tpr=0.9537 | fpr=0.0222 | 7755.7 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.12297 | acc=0.9776 | tpr=0.9530 | fpr=0.0220 | 14687.6 samples/s | 57.4 steps/s
Avg test loss: 0.12281, Avg test acc: 0.97761, Avg tpr: 0.95325, Avg fpr: 0.02195, total FA: 3048

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11587 | acc=0.9806 | tpr=0.9159 | fpr=0.0182 | 4101.2 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.12065 | acc=0.9800 | tpr=0.9382 | fpr=0.0192 | 7985.3 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.12541 | acc=0.9789 | tpr=0.9366 | fpr=0.0203 | 8380.8 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.12766 | acc=0.9787 | tpr=0.9454 | fpr=0.0207 | 7897.3 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.12629 | acc=0.9786 | tpr=0.9406 | fpr=0.0207 | 8089.1 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.12832 | acc=0.9784 | tpr=0.9404 | fpr=0.0209 | 8138.9 samples/s | 31.8 steps/s
[Step= 350] | Loss=0.12826 | acc=0.9783 | tpr=0.9436 | fpr=0.0210 | 8209.4 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.12946 | acc=0.9782 | tpr=0.9404 | fpr=0.0211 | 7993.9 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.13259 | acc=0.9778 | tpr=0.9377 | fpr=0.0214 | 8021.6 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.13213 | acc=0.9779 | tpr=0.9396 | fpr=0.0214 | 8065.6 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.13114 | acc=0.9781 | tpr=0.9399 | fpr=0.0212 | 14138.9 samples/s | 55.2 steps/s
Avg test loss: 0.13100, Avg test acc: 0.97810, Avg tpr: 0.93978, Avg fpr: 0.02120, total FA: 2944

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12996 | acc=0.9791 | tpr=0.9204 | fpr=0.0199 | 4138.1 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.13496 | acc=0.9788 | tpr=0.9446 | fpr=0.0205 | 7975.4 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.14017 | acc=0.9779 | tpr=0.9438 | fpr=0.0215 | 7986.1 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.14272 | acc=0.9777 | tpr=0.9475 | fpr=0.0217 | 7826.5 samples/s | 30.6 steps/s
[Step= 250] | Loss=0.14122 | acc=0.9779 | tpr=0.9450 | fpr=0.0215 | 7966.0 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.14395 | acc=0.9775 | tpr=0.9447 | fpr=0.0219 | 8170.9 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.14438 | acc=0.9774 | tpr=0.9474 | fpr=0.0221 | 8686.5 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.14577 | acc=0.9772 | tpr=0.9420 | fpr=0.0222 | 7621.3 samples/s | 29.8 steps/s
[Step= 450] | Loss=0.14903 | acc=0.9768 | tpr=0.9416 | fpr=0.0226 | 8192.6 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.14844 | acc=0.9768 | tpr=0.9414 | fpr=0.0226 | 7737.5 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.14764 | acc=0.9770 | tpr=0.9407 | fpr=0.0224 | 15185.4 samples/s | 59.3 steps/s
Avg test loss: 0.14738, Avg test acc: 0.97698, Avg tpr: 0.94097, Avg fpr: 0.02236, total FA: 3105

server round 29/50

clients selected: [0 3 4 5 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=26001 Epoch=126.8] | Loss=0.02275 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.792 | L2-Norm(final)=10.144 | 3579.3 samples/s | 55.9 steps/s
[Step=26050 Epoch=127.0] | Loss=0.02037 | Reg=0.00117 | acc=0.9531 | L2-Norm=10.812 | L2-Norm(final)=10.132 | 4986.5 samples/s | 77.9 steps/s
[Step=26100 Epoch=127.3] | Loss=0.02071 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.838 | L2-Norm(final)=10.133 | 5189.6 samples/s | 81.1 steps/s
[Step=26150 Epoch=127.5] | Loss=0.02118 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.861 | L2-Norm(final)=10.137 | 5096.0 samples/s | 79.6 steps/s
[Step=26200 Epoch=127.8] | Loss=0.02076 | Reg=0.00118 | acc=0.9688 | L2-Norm=10.882 | L2-Norm(final)=10.140 | 7268.3 samples/s | 113.6 steps/s
[Step=26250 Epoch=128.0] | Loss=0.01911 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.902 | L2-Norm(final)=10.146 | 1826.2 samples/s | 28.5 steps/s
[Step=26300 Epoch=128.2] | Loss=0.01831 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.920 | L2-Norm(final)=10.153 | 5157.4 samples/s | 80.6 steps/s
[Step=26350 Epoch=128.5] | Loss=0.01751 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.938 | L2-Norm(final)=10.162 | 5295.6 samples/s | 82.7 steps/s
[Step=26400 Epoch=128.7] | Loss=0.01705 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.956 | L2-Norm(final)=10.171 | 6559.0 samples/s | 102.5 steps/s
[Step=26450 Epoch=129.0] | Loss=0.01652 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.973 | L2-Norm(final)=10.182 | 1831.0 samples/s | 28.6 steps/s
[Step=26500 Epoch=129.2] | Loss=0.01576 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.989 | L2-Norm(final)=10.193 | 5181.8 samples/s | 81.0 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=129.2] | Loss=0.00355 | Reg=0.00124 | acc=1.0000 | L2-Norm=11.155 | L2-Norm(final)=10.308 | 3771.1 samples/s | 58.9 steps/s
[Step=26550 Epoch=129.5] | Loss=0.01529 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.179 | L2-Norm(final)=10.320 | 4314.5 samples/s | 67.4 steps/s
[Step=26600 Epoch=129.7] | Loss=0.01626 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.204 | L2-Norm(final)=10.329 | 4539.2 samples/s | 70.9 steps/s
[Step=26650 Epoch=130.0] | Loss=0.01733 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.225 | L2-Norm(final)=10.335 | 4530.1 samples/s | 70.8 steps/s
[Step=26700 Epoch=130.2] | Loss=0.01807 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.246 | L2-Norm(final)=10.340 | 6252.2 samples/s | 97.7 steps/s
[Step=26750 Epoch=130.4] | Loss=0.01741 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.265 | L2-Norm(final)=10.345 | 1748.4 samples/s | 27.3 steps/s
[Step=26800 Epoch=130.7] | Loss=0.01605 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.281 | L2-Norm(final)=10.350 | 4560.0 samples/s | 71.3 steps/s
[Step=26850 Epoch=130.9] | Loss=0.01528 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.294 | L2-Norm(final)=10.355 | 4588.8 samples/s | 71.7 steps/s
[Step=26900 Epoch=131.2] | Loss=0.01433 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.306 | L2-Norm(final)=10.360 | 5758.3 samples/s | 90.0 steps/s
[Step=26950 Epoch=131.4] | Loss=0.01346 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.316 | L2-Norm(final)=10.365 | 1822.2 samples/s | 28.5 steps/s
[Step=27000 Epoch=131.7] | Loss=0.01256 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.326 | L2-Norm(final)=10.370 | 4648.3 samples/s | 72.6 steps/s
[Step=27050 Epoch=131.9] | Loss=0.01200 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.334 | L2-Norm(final)=10.375 | 4763.6 samples/s | 74.4 steps/s
[Step=27100 Epoch=132.1] | Loss=0.01166 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.342 | L2-Norm(final)=10.379 | 5440.5 samples/s | 85.0 steps/s
[Step=27150 Epoch=132.4] | Loss=0.01121 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.349 | L2-Norm(final)=10.383 | 1841.5 samples/s | 28.8 steps/s
[Step=27200 Epoch=132.6] | Loss=0.01077 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.355 | L2-Norm(final)=10.387 | 4732.6 samples/s | 73.9 steps/s
[Step=27250 Epoch=132.9] | Loss=0.01042 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.362 | L2-Norm(final)=10.391 | 4628.5 samples/s | 72.3 steps/s
[Step=27300 Epoch=133.1] | Loss=0.01003 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.368 | L2-Norm(final)=10.395 | 5145.6 samples/s | 80.4 steps/s
[Step=27350 Epoch=133.4] | Loss=0.00982 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.373 | L2-Norm(final)=10.399 | 1844.8 samples/s | 28.8 steps/s
[Step=27400 Epoch=133.6] | Loss=0.00962 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.379 | L2-Norm(final)=10.402 | 4585.2 samples/s | 71.6 steps/s
[Step=27450 Epoch=133.9] | Loss=0.00927 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.384 | L2-Norm(final)=10.406 | 4558.6 samples/s | 71.2 steps/s
[Step=27500 Epoch=134.1] | Loss=0.00911 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.388 | L2-Norm(final)=10.409 | 4575.5 samples/s | 71.5 steps/s
[Step=27550 Epoch=134.3] | Loss=0.00901 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.393 | L2-Norm(final)=10.412 | 1916.8 samples/s | 29.9 steps/s
[Step=27600 Epoch=134.6] | Loss=0.00887 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.397 | L2-Norm(final)=10.415 | 4637.2 samples/s | 72.5 steps/s
[Step=27650 Epoch=134.8] | Loss=0.00868 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.402 | L2-Norm(final)=10.417 | 4601.1 samples/s | 71.9 steps/s
[Step=27700 Epoch=135.1] | Loss=0.00856 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.406 | L2-Norm(final)=10.420 | 4723.5 samples/s | 73.8 steps/s
[Step=27750 Epoch=135.3] | Loss=0.00841 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.410 | L2-Norm(final)=10.423 | 1925.3 samples/s | 30.1 steps/s
[Step=27800 Epoch=135.6] | Loss=0.00823 | Reg=0.00130 | acc=0.9688 | L2-Norm=11.414 | L2-Norm(final)=10.425 | 4548.0 samples/s | 71.1 steps/s
[Step=27850 Epoch=135.8] | Loss=0.00811 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.418 | L2-Norm(final)=10.428 | 4831.9 samples/s | 75.5 steps/s
[Step=27900 Epoch=136.0] | Loss=0.00792 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.421 | L2-Norm(final)=10.430 | 4546.0 samples/s | 71.0 steps/s
[Step=27950 Epoch=136.3] | Loss=0.00780 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.424 | L2-Norm(final)=10.433 | 1972.3 samples/s | 30.8 steps/s
[Step=28000 Epoch=136.5] | Loss=0.00769 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.428 | L2-Norm(final)=10.435 | 4657.9 samples/s | 72.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step28000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=26001 Epoch=126.8] | Loss=0.01021 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.792 | L2-Norm(final)=10.908 | 3704.4 samples/s | 57.9 steps/s
[Step=26050 Epoch=127.0] | Loss=0.02673 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.826 | L2-Norm(final)=10.894 | 4930.0 samples/s | 77.0 steps/s
[Step=26100 Epoch=127.3] | Loss=0.02342 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.860 | L2-Norm(final)=10.889 | 5299.3 samples/s | 82.8 steps/s
[Step=26150 Epoch=127.5] | Loss=0.02262 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.884 | L2-Norm(final)=10.890 | 5026.6 samples/s | 78.5 steps/s
[Step=26200 Epoch=127.8] | Loss=0.02129 | Reg=0.00119 | acc=0.9531 | L2-Norm=10.904 | L2-Norm(final)=10.895 | 7158.4 samples/s | 111.8 steps/s
[Step=26250 Epoch=128.0] | Loss=0.01946 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.924 | L2-Norm(final)=10.903 | 1800.6 samples/s | 28.1 steps/s
[Step=26300 Epoch=128.3] | Loss=0.01853 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.942 | L2-Norm(final)=10.913 | 5169.6 samples/s | 80.8 steps/s
[Step=26350 Epoch=128.5] | Loss=0.01771 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.960 | L2-Norm(final)=10.924 | 5225.9 samples/s | 81.7 steps/s
[Step=26400 Epoch=128.7] | Loss=0.01700 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.979 | L2-Norm(final)=10.935 | 6419.1 samples/s | 100.3 steps/s
[Step=26450 Epoch=129.0] | Loss=0.01621 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.996 | L2-Norm(final)=10.946 | 1882.2 samples/s | 29.4 steps/s
[Step=26500 Epoch=129.2] | Loss=0.01555 | Reg=0.00121 | acc=1.0000 | L2-Norm=11.013 | L2-Norm(final)=10.959 | 5143.1 samples/s | 80.4 steps/s
All layers training...
LR=0.00025, len=1
[Step=26501 Epoch=129.2] | Loss=0.00745 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.176 | L2-Norm(final)=11.084 | 3760.1 samples/s | 58.8 steps/s
[Step=26550 Epoch=129.5] | Loss=0.01376 | Reg=0.00125 | acc=1.0000 | L2-Norm=11.196 | L2-Norm(final)=11.097 | 4353.6 samples/s | 68.0 steps/s
[Step=26600 Epoch=129.7] | Loss=0.01592 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.224 | L2-Norm(final)=11.104 | 4702.6 samples/s | 73.5 steps/s
[Step=26650 Epoch=130.0] | Loss=0.01690 | Reg=0.00127 | acc=0.9531 | L2-Norm=11.250 | L2-Norm(final)=11.109 | 4560.8 samples/s | 71.3 steps/s
[Step=26700 Epoch=130.2] | Loss=0.01724 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.273 | L2-Norm(final)=11.114 | 5999.9 samples/s | 93.7 steps/s
[Step=26750 Epoch=130.4] | Loss=0.01627 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.293 | L2-Norm(final)=11.119 | 1746.5 samples/s | 27.3 steps/s
[Step=26800 Epoch=130.7] | Loss=0.01512 | Reg=0.00128 | acc=0.9844 | L2-Norm=11.310 | L2-Norm(final)=11.124 | 4566.7 samples/s | 71.4 steps/s
[Step=26850 Epoch=130.9] | Loss=0.01394 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.325 | L2-Norm(final)=11.130 | 4479.2 samples/s | 70.0 steps/s
[Step=26900 Epoch=131.2] | Loss=0.01308 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.338 | L2-Norm(final)=11.136 | 5726.3 samples/s | 89.5 steps/s
[Step=26950 Epoch=131.4] | Loss=0.01236 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.349 | L2-Norm(final)=11.142 | 1774.2 samples/s | 27.7 steps/s
[Step=27000 Epoch=131.7] | Loss=0.01143 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.359 | L2-Norm(final)=11.147 | 4502.9 samples/s | 70.4 steps/s
[Step=27050 Epoch=131.9] | Loss=0.01101 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.369 | L2-Norm(final)=11.152 | 4559.4 samples/s | 71.2 steps/s
[Step=27100 Epoch=132.2] | Loss=0.01061 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.378 | L2-Norm(final)=11.157 | 5269.5 samples/s | 82.3 steps/s
[Step=27150 Epoch=132.4] | Loss=0.01016 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.385 | L2-Norm(final)=11.162 | 1814.9 samples/s | 28.4 steps/s
[Step=27200 Epoch=132.6] | Loss=0.00976 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.392 | L2-Norm(final)=11.165 | 4647.9 samples/s | 72.6 steps/s
[Step=27250 Epoch=132.9] | Loss=0.00952 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.399 | L2-Norm(final)=11.169 | 4607.4 samples/s | 72.0 steps/s
[Step=27300 Epoch=133.1] | Loss=0.00917 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.405 | L2-Norm(final)=11.173 | 5000.2 samples/s | 78.1 steps/s
[Step=27350 Epoch=133.4] | Loss=0.00892 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.411 | L2-Norm(final)=11.176 | 1854.8 samples/s | 29.0 steps/s
[Step=27400 Epoch=133.6] | Loss=0.00869 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.416 | L2-Norm(final)=11.180 | 4576.8 samples/s | 71.5 steps/s
[Step=27450 Epoch=133.9] | Loss=0.00834 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.421 | L2-Norm(final)=11.183 | 4669.6 samples/s | 73.0 steps/s
[Step=27500 Epoch=134.1] | Loss=0.00809 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.426 | L2-Norm(final)=11.186 | 4740.7 samples/s | 74.1 steps/s
[Step=27550 Epoch=134.3] | Loss=0.00786 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.431 | L2-Norm(final)=11.190 | 1909.9 samples/s | 29.8 steps/s
[Step=27600 Epoch=134.6] | Loss=0.00764 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.435 | L2-Norm(final)=11.193 | 4610.7 samples/s | 72.0 steps/s
[Step=27650 Epoch=134.8] | Loss=0.00750 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.439 | L2-Norm(final)=11.196 | 4603.0 samples/s | 71.9 steps/s
[Step=27700 Epoch=135.1] | Loss=0.00735 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.444 | L2-Norm(final)=11.199 | 4556.2 samples/s | 71.2 steps/s
[Step=27750 Epoch=135.3] | Loss=0.00722 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.447 | L2-Norm(final)=11.202 | 1936.4 samples/s | 30.3 steps/s
[Step=27800 Epoch=135.6] | Loss=0.00711 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.451 | L2-Norm(final)=11.204 | 4558.2 samples/s | 71.2 steps/s
[Step=27850 Epoch=135.8] | Loss=0.00692 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.455 | L2-Norm(final)=11.207 | 4658.4 samples/s | 72.8 steps/s
[Step=27900 Epoch=136.1] | Loss=0.00681 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.458 | L2-Norm(final)=11.209 | 4875.0 samples/s | 76.2 steps/s
[Step=27950 Epoch=136.3] | Loss=0.00668 | Reg=0.00131 | acc=1.0000 | L2-Norm=11.461 | L2-Norm(final)=11.212 | 1962.0 samples/s | 30.7 steps/s
[Step=28000 Epoch=136.5] | Loss=0.00658 | Reg=0.00131 | acc=0.9844 | L2-Norm=11.464 | L2-Norm(final)=11.214 | 4568.8 samples/s | 71.4 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step28000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=34001 Epoch=166.7] | Loss=0.02478 | Reg=0.00116 | acc=0.9531 | L2-Norm=10.792 | L2-Norm(final)=11.831 | 3668.5 samples/s | 57.3 steps/s
[Step=34050 Epoch=167.0] | Loss=0.02053 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.815 | L2-Norm(final)=11.812 | 5210.5 samples/s | 81.4 steps/s
[Step=34100 Epoch=167.2] | Loss=0.01786 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.838 | L2-Norm(final)=11.815 | 5136.5 samples/s | 80.3 steps/s
[Step=34150 Epoch=167.5] | Loss=0.01687 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.860 | L2-Norm(final)=11.823 | 5166.5 samples/s | 80.7 steps/s
[Step=34200 Epoch=167.7] | Loss=0.01750 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.880 | L2-Norm(final)=11.829 | 7167.1 samples/s | 112.0 steps/s
[Step=34250 Epoch=168.0] | Loss=0.01642 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.900 | L2-Norm(final)=11.835 | 1791.2 samples/s | 28.0 steps/s
[Step=34300 Epoch=168.2] | Loss=0.01557 | Reg=0.00119 | acc=0.9844 | L2-Norm=10.919 | L2-Norm(final)=11.843 | 4978.5 samples/s | 77.8 steps/s
[Step=34350 Epoch=168.4] | Loss=0.01497 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.938 | L2-Norm(final)=11.853 | 5071.6 samples/s | 79.2 steps/s
[Step=34400 Epoch=168.7] | Loss=0.01445 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.955 | L2-Norm(final)=11.863 | 6973.1 samples/s | 109.0 steps/s
[Step=34450 Epoch=168.9] | Loss=0.01372 | Reg=0.00120 | acc=0.9844 | L2-Norm=10.971 | L2-Norm(final)=11.874 | 1816.7 samples/s | 28.4 steps/s
[Step=34500 Epoch=169.2] | Loss=0.01312 | Reg=0.00121 | acc=1.0000 | L2-Norm=10.987 | L2-Norm(final)=11.885 | 5240.4 samples/s | 81.9 steps/s
All layers training...
LR=0.00025, len=1
[Step=34501 Epoch=169.2] | Loss=0.01040 | Reg=0.00124 | acc=0.9844 | L2-Norm=11.138 | L2-Norm(final)=12.001 | 3720.9 samples/s | 58.1 steps/s
[Step=34550 Epoch=169.4] | Loss=0.01183 | Reg=0.00124 | acc=0.9688 | L2-Norm=11.157 | L2-Norm(final)=12.014 | 4527.2 samples/s | 70.7 steps/s
[Step=34600 Epoch=169.7] | Loss=0.01727 | Reg=0.00125 | acc=0.9844 | L2-Norm=11.181 | L2-Norm(final)=12.019 | 4495.5 samples/s | 70.2 steps/s
[Step=34650 Epoch=169.9] | Loss=0.01970 | Reg=0.00126 | acc=0.9688 | L2-Norm=11.203 | L2-Norm(final)=12.019 | 4683.0 samples/s | 73.2 steps/s
[Step=34700 Epoch=170.2] | Loss=0.01986 | Reg=0.00126 | acc=0.9844 | L2-Norm=11.224 | L2-Norm(final)=12.019 | 6218.4 samples/s | 97.2 steps/s
[Step=34750 Epoch=170.4] | Loss=0.01786 | Reg=0.00126 | acc=1.0000 | L2-Norm=11.241 | L2-Norm(final)=12.021 | 1731.5 samples/s | 27.1 steps/s
[Step=34800 Epoch=170.7] | Loss=0.01620 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.256 | L2-Norm(final)=12.024 | 4639.9 samples/s | 72.5 steps/s
[Step=34850 Epoch=170.9] | Loss=0.01500 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.268 | L2-Norm(final)=12.028 | 4656.6 samples/s | 72.8 steps/s
[Step=34900 Epoch=171.1] | Loss=0.01423 | Reg=0.00127 | acc=1.0000 | L2-Norm=11.279 | L2-Norm(final)=12.031 | 6186.7 samples/s | 96.7 steps/s
[Step=34950 Epoch=171.4] | Loss=0.01315 | Reg=0.00127 | acc=0.9844 | L2-Norm=11.288 | L2-Norm(final)=12.035 | 1767.6 samples/s | 27.6 steps/s
[Step=35000 Epoch=171.6] | Loss=0.01227 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.297 | L2-Norm(final)=12.039 | 4611.8 samples/s | 72.1 steps/s
[Step=35050 Epoch=171.9] | Loss=0.01184 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.304 | L2-Norm(final)=12.043 | 4654.2 samples/s | 72.7 steps/s
[Step=35100 Epoch=172.1] | Loss=0.01144 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.311 | L2-Norm(final)=12.047 | 5634.7 samples/s | 88.0 steps/s
[Step=35150 Epoch=172.4] | Loss=0.01077 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.317 | L2-Norm(final)=12.050 | 1789.6 samples/s | 28.0 steps/s
[Step=35200 Epoch=172.6] | Loss=0.01024 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.323 | L2-Norm(final)=12.053 | 4645.5 samples/s | 72.6 steps/s
[Step=35250 Epoch=172.9] | Loss=0.01001 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.329 | L2-Norm(final)=12.056 | 4615.0 samples/s | 72.1 steps/s
[Step=35300 Epoch=173.1] | Loss=0.00957 | Reg=0.00128 | acc=1.0000 | L2-Norm=11.333 | L2-Norm(final)=12.059 | 5299.6 samples/s | 82.8 steps/s
[Step=35350 Epoch=173.4] | Loss=0.00927 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.338 | L2-Norm(final)=12.063 | 1804.7 samples/s | 28.2 steps/s
[Step=35400 Epoch=173.6] | Loss=0.00893 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.342 | L2-Norm(final)=12.065 | 4623.6 samples/s | 72.2 steps/s
[Step=35450 Epoch=173.8] | Loss=0.00869 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.346 | L2-Norm(final)=12.068 | 4604.1 samples/s | 71.9 steps/s
[Step=35500 Epoch=174.1] | Loss=0.00846 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.350 | L2-Norm(final)=12.071 | 5041.2 samples/s | 78.8 steps/s
[Step=35550 Epoch=174.3] | Loss=0.00823 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.354 | L2-Norm(final)=12.074 | 1876.2 samples/s | 29.3 steps/s
[Step=35600 Epoch=174.6] | Loss=0.00802 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.358 | L2-Norm(final)=12.077 | 4643.6 samples/s | 72.6 steps/s
[Step=35650 Epoch=174.8] | Loss=0.00785 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.362 | L2-Norm(final)=12.080 | 4691.7 samples/s | 73.3 steps/s
[Step=35700 Epoch=175.1] | Loss=0.00762 | Reg=0.00129 | acc=0.9844 | L2-Norm=11.365 | L2-Norm(final)=12.083 | 5011.6 samples/s | 78.3 steps/s
[Step=35750 Epoch=175.3] | Loss=0.00739 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.368 | L2-Norm(final)=12.085 | 1883.5 samples/s | 29.4 steps/s
[Step=35800 Epoch=175.6] | Loss=0.00724 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.371 | L2-Norm(final)=12.088 | 4958.2 samples/s | 77.5 steps/s
[Step=35850 Epoch=175.8] | Loss=0.00715 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.374 | L2-Norm(final)=12.091 | 4956.2 samples/s | 77.4 steps/s
[Step=35900 Epoch=176.0] | Loss=0.00708 | Reg=0.00129 | acc=1.0000 | L2-Norm=11.377 | L2-Norm(final)=12.093 | 4819.2 samples/s | 75.3 steps/s
[Step=35950 Epoch=176.3] | Loss=0.00704 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.380 | L2-Norm(final)=12.096 | 1838.2 samples/s | 28.7 steps/s
[Step=36000 Epoch=176.5] | Loss=0.00690 | Reg=0.00130 | acc=1.0000 | L2-Norm=11.382 | L2-Norm(final)=12.098 | 4760.7 samples/s | 74.4 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step36000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=18001 Epoch=170.6] | Loss=0.03193 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.792 | L2-Norm(final)=6.753 | 3510.0 samples/s | 54.8 steps/s
[Step=18050 Epoch=171.0] | Loss=0.00347 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.881 | L2-Norm(final)=6.750 | 4776.8 samples/s | 74.6 steps/s
[Step=18100 Epoch=171.5] | Loss=0.00194 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.917 | L2-Norm(final)=6.770 | 6858.0 samples/s | 107.2 steps/s
[Step=18150 Epoch=172.0] | Loss=0.00146 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.933 | L2-Norm(final)=6.786 | 1776.2 samples/s | 27.8 steps/s
[Step=18200 Epoch=172.5] | Loss=0.00114 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.941 | L2-Norm(final)=6.800 | 6288.4 samples/s | 98.3 steps/s
[Step=18250 Epoch=172.9] | Loss=0.00094 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.944 | L2-Norm(final)=6.812 | 1839.7 samples/s | 28.7 steps/s
[Step=18300 Epoch=173.4] | Loss=0.00080 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=6.821 | 5728.6 samples/s | 89.5 steps/s
[Step=18350 Epoch=173.9] | Loss=0.00070 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.944 | L2-Norm(final)=6.830 | 1808.1 samples/s | 28.3 steps/s
[Step=18400 Epoch=174.4] | Loss=0.00062 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.942 | L2-Norm(final)=6.839 | 5447.6 samples/s | 85.1 steps/s
[Step=18450 Epoch=174.8] | Loss=0.00056 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.939 | L2-Norm(final)=6.846 | 1885.6 samples/s | 29.5 steps/s
[Step=18500 Epoch=175.3] | Loss=0.00051 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.936 | L2-Norm(final)=6.853 | 4978.7 samples/s | 77.8 steps/s
All layers training...
LR=0.00025, len=1
[Step=18501 Epoch=175.3] | Loss=0.00002 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.903 | L2-Norm(final)=6.923 | 3584.4 samples/s | 56.0 steps/s
[Step=18550 Epoch=175.8] | Loss=0.00004 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.893 | L2-Norm(final)=6.927 | 4331.2 samples/s | 67.7 steps/s
[Step=18600 Epoch=176.3] | Loss=0.00005 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.881 | L2-Norm(final)=6.931 | 5971.2 samples/s | 93.3 steps/s
[Step=18650 Epoch=176.7] | Loss=0.00004 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.869 | L2-Norm(final)=6.935 | 1685.3 samples/s | 26.3 steps/s
[Step=18700 Epoch=177.2] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.856 | L2-Norm(final)=6.937 | 5320.7 samples/s | 83.1 steps/s
[Step=18750 Epoch=177.7] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.842 | L2-Norm(final)=6.939 | 1717.3 samples/s | 26.8 steps/s
[Step=18800 Epoch=178.1] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.827 | L2-Norm(final)=6.940 | 5204.0 samples/s | 81.3 steps/s
[Step=18850 Epoch=178.6] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.812 | L2-Norm(final)=6.941 | 1763.9 samples/s | 27.6 steps/s
[Step=18900 Epoch=179.1] | Loss=0.00002 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.796 | L2-Norm(final)=6.942 | 4719.6 samples/s | 73.7 steps/s
[Step=18950 Epoch=179.6] | Loss=0.00002 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.781 | L2-Norm(final)=6.943 | 1814.2 samples/s | 28.3 steps/s
[Step=19000 Epoch=180.0] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.765 | L2-Norm(final)=6.944 | 4498.1 samples/s | 70.3 steps/s
[Step=19050 Epoch=180.5] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.749 | L2-Norm(final)=6.945 | 1888.0 samples/s | 29.5 steps/s
[Step=19100 Epoch=181.0] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.733 | L2-Norm(final)=6.945 | 4486.8 samples/s | 70.1 steps/s
[Step=19150 Epoch=181.5] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.716 | L2-Norm(final)=6.946 | 1880.9 samples/s | 29.4 steps/s
[Step=19200 Epoch=181.9] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.700 | L2-Norm(final)=6.947 | 4524.8 samples/s | 70.7 steps/s
[Step=19250 Epoch=182.4] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.683 | L2-Norm(final)=6.947 | 1868.3 samples/s | 29.2 steps/s
[Step=19300 Epoch=182.9] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.667 | L2-Norm(final)=6.948 | 4430.1 samples/s | 69.2 steps/s
[Step=19350 Epoch=183.4] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.650 | L2-Norm(final)=6.948 | 1922.1 samples/s | 30.0 steps/s
[Step=19400 Epoch=183.8] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.633 | L2-Norm(final)=6.949 | 4047.7 samples/s | 63.2 steps/s
[Step=19450 Epoch=184.3] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.616 | L2-Norm(final)=6.950 | 6127.2 samples/s | 95.7 steps/s
[Step=19500 Epoch=184.8] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.598 | L2-Norm(final)=6.950 | 1706.6 samples/s | 26.7 steps/s
[Step=19550 Epoch=185.3] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.581 | L2-Norm(final)=6.951 | 5557.7 samples/s | 86.8 steps/s
[Step=19600 Epoch=185.7] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.563 | L2-Norm(final)=6.951 | 1728.0 samples/s | 27.0 steps/s
[Step=19650 Epoch=186.2] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.546 | L2-Norm(final)=6.952 | 5122.1 samples/s | 80.0 steps/s
[Step=19700 Epoch=186.7] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.528 | L2-Norm(final)=6.952 | 1790.5 samples/s | 28.0 steps/s
[Step=19750 Epoch=187.1] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.510 | L2-Norm(final)=6.953 | 4802.2 samples/s | 75.0 steps/s
[Step=19800 Epoch=187.6] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.492 | L2-Norm(final)=6.953 | 1808.4 samples/s | 28.3 steps/s
[Step=19850 Epoch=188.1] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.473 | L2-Norm(final)=6.954 | 4632.0 samples/s | 72.4 steps/s
[Step=19900 Epoch=188.6] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.455 | L2-Norm(final)=6.954 | 1863.4 samples/s | 29.1 steps/s
[Step=19950 Epoch=189.0] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.436 | L2-Norm(final)=6.955 | 4467.2 samples/s | 69.8 steps/s
[Step=20000 Epoch=189.5] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.418 | L2-Norm(final)=6.955 | 1852.9 samples/s | 29.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_0/client_state-step20000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00025, len=1
[Step=28001 Epoch=263.8] | Loss=0.00033 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.792 | L2-Norm(final)=8.428 | 3712.2 samples/s | 58.0 steps/s
[Step=28050 Epoch=264.3] | Loss=0.00315 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.839 | L2-Norm(final)=8.432 | 4258.3 samples/s | 66.5 steps/s
[Step=28100 Epoch=264.8] | Loss=0.00186 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.903 | L2-Norm(final)=8.443 | 6596.1 samples/s | 103.1 steps/s
[Step=28150 Epoch=265.3] | Loss=0.00128 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.929 | L2-Norm(final)=8.452 | 1761.8 samples/s | 27.5 steps/s
[Step=28200 Epoch=265.7] | Loss=0.00098 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.939 | L2-Norm(final)=8.459 | 6309.4 samples/s | 98.6 steps/s
[Step=28250 Epoch=266.2] | Loss=0.00080 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.944 | L2-Norm(final)=8.466 | 1807.2 samples/s | 28.2 steps/s
[Step=28300 Epoch=266.7] | Loss=0.00068 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=8.471 | 5618.2 samples/s | 87.8 steps/s
[Step=28350 Epoch=267.1] | Loss=0.00059 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.945 | L2-Norm(final)=8.476 | 1894.0 samples/s | 29.6 steps/s
[Step=28400 Epoch=267.6] | Loss=0.00052 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.943 | L2-Norm(final)=8.481 | 5221.8 samples/s | 81.6 steps/s
[Step=28450 Epoch=268.1] | Loss=0.00047 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.940 | L2-Norm(final)=8.485 | 1909.0 samples/s | 29.8 steps/s
[Step=28500 Epoch=268.6] | Loss=0.00043 | Reg=0.00120 | acc=1.0000 | L2-Norm=10.937 | L2-Norm(final)=8.489 | 5037.8 samples/s | 78.7 steps/s
All layers training...
LR=0.00025, len=1
[Step=28501 Epoch=268.6] | Loss=0.00009 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.903 | L2-Norm(final)=8.530 | 3558.9 samples/s | 55.6 steps/s
[Step=28550 Epoch=269.0] | Loss=0.00003 | Reg=0.00119 | acc=1.0000 | L2-Norm=10.895 | L2-Norm(final)=8.533 | 4328.4 samples/s | 67.6 steps/s
[Step=28600 Epoch=269.5] | Loss=0.00003 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.884 | L2-Norm(final)=8.535 | 5732.8 samples/s | 89.6 steps/s
[Step=28650 Epoch=270.0] | Loss=0.00002 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.873 | L2-Norm(final)=8.537 | 1701.7 samples/s | 26.6 steps/s
[Step=28700 Epoch=270.4] | Loss=0.00002 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.861 | L2-Norm(final)=8.538 | 5359.3 samples/s | 83.7 steps/s
[Step=28750 Epoch=270.9] | Loss=0.00002 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.849 | L2-Norm(final)=8.539 | 1753.1 samples/s | 27.4 steps/s
[Step=28800 Epoch=271.4] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.837 | L2-Norm(final)=8.540 | 4990.1 samples/s | 78.0 steps/s
[Step=28850 Epoch=271.8] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.824 | L2-Norm(final)=8.541 | 1789.8 samples/s | 28.0 steps/s
[Step=28900 Epoch=272.3] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.811 | L2-Norm(final)=8.542 | 4631.5 samples/s | 72.4 steps/s
[Step=28950 Epoch=272.8] | Loss=0.00001 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.798 | L2-Norm(final)=8.542 | 1827.3 samples/s | 28.6 steps/s
[Step=29000 Epoch=273.3] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.785 | L2-Norm(final)=8.543 | 4377.5 samples/s | 68.4 steps/s
[Step=29050 Epoch=273.7] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=8.543 | 1828.4 samples/s | 28.6 steps/s
[Step=29100 Epoch=274.2] | Loss=0.00001 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.759 | L2-Norm(final)=8.544 | 4430.4 samples/s | 69.2 steps/s
[Step=29150 Epoch=274.7] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.745 | L2-Norm(final)=8.545 | 1862.2 samples/s | 29.1 steps/s
[Step=29200 Epoch=275.1] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.732 | L2-Norm(final)=8.545 | 4398.5 samples/s | 68.7 steps/s
[Step=29250 Epoch=275.6] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.718 | L2-Norm(final)=8.546 | 1983.1 samples/s | 31.0 steps/s
[Step=29300 Epoch=276.1] | Loss=0.00001 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.704 | L2-Norm(final)=8.546 | 4054.0 samples/s | 63.3 steps/s
[Step=29350 Epoch=276.6] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.690 | L2-Norm(final)=8.547 | 5979.0 samples/s | 93.4 steps/s
[Step=29400 Epoch=277.0] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.676 | L2-Norm(final)=8.547 | 1725.5 samples/s | 27.0 steps/s
[Step=29450 Epoch=277.5] | Loss=0.00001 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.662 | L2-Norm(final)=8.548 | 5522.3 samples/s | 86.3 steps/s
[Step=29500 Epoch=278.0] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.648 | L2-Norm(final)=8.548 | 1763.2 samples/s | 27.5 steps/s
[Step=29550 Epoch=278.4] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.634 | L2-Norm(final)=8.549 | 4848.5 samples/s | 75.8 steps/s
[Step=29600 Epoch=278.9] | Loss=0.00001 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.619 | L2-Norm(final)=8.549 | 1767.8 samples/s | 27.6 steps/s
[Step=29650 Epoch=279.4] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.605 | L2-Norm(final)=8.550 | 4626.9 samples/s | 72.3 steps/s
[Step=29700 Epoch=279.9] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.590 | L2-Norm(final)=8.550 | 1836.1 samples/s | 28.7 steps/s
[Step=29750 Epoch=280.3] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.575 | L2-Norm(final)=8.550 | 4286.2 samples/s | 67.0 steps/s
[Step=29800 Epoch=280.8] | Loss=0.00001 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.560 | L2-Norm(final)=8.551 | 1908.8 samples/s | 29.8 steps/s
[Step=29850 Epoch=281.3] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.545 | L2-Norm(final)=8.551 | 4449.3 samples/s | 69.5 steps/s
[Step=29900 Epoch=281.7] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.530 | L2-Norm(final)=8.552 | 1875.8 samples/s | 29.3 steps/s
[Step=29950 Epoch=282.2] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.514 | L2-Norm(final)=8.552 | 4539.2 samples/s | 70.9 steps/s
[Step=30000 Epoch=282.7] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.499 | L2-Norm(final)=8.553 | 1922.6 samples/s | 30.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step30000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.09318 | acc=0.9613 | tpr=0.9815 | fpr=0.0825 | 4035.3 samples/s | 15.8 steps/s
Avg test loss: 0.09685, Avg test acc: 0.95973, Avg tpr: 0.98036, Avg fpr: 0.08563, total FA: 668

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09845 | acc=0.9610 | tpr=0.9798 | fpr=0.0798 | 4144.9 samples/s | 16.2 steps/s
Avg test loss: 0.10234, Avg test acc: 0.95973, Avg tpr: 0.97803, Avg fpr: 0.08050, total FA: 628

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09768 | acc=0.9595 | tpr=0.9728 | fpr=0.0696 | 4091.6 samples/s | 16.0 steps/s
Avg test loss: 0.10295, Avg test acc: 0.95889, Avg tpr: 0.97162, Avg fpr: 0.06909, total FA: 539

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09518 | acc=0.9583 | tpr=0.9732 | fpr=0.0741 | 4113.1 samples/s | 16.1 steps/s
Avg test loss: 0.09862, Avg test acc: 0.95801, Avg tpr: 0.97296, Avg fpr: 0.07486, total FA: 584

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08957 | acc=0.9624 | tpr=0.9731 | fpr=0.0607 | 4136.3 samples/s | 16.2 steps/s
Avg test loss: 0.09604, Avg test acc: 0.95997, Avg tpr: 0.97068, Avg fpr: 0.06358, total FA: 496

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.25337 | acc=0.2791 | tpr=0.0034 | fpr=0.1222 | 4094.0 samples/s | 16.0 steps/s
Avg test loss: 5.27105, Avg test acc: 0.27747, Avg tpr: 0.00431, Avg fpr: 0.12178, total FA: 950

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.91304 | acc=0.3082 | tpr=0.0047 | fpr=0.0327 | 4117.4 samples/s | 16.1 steps/s
Avg test loss: 4.91786, Avg test acc: 0.30639, Avg tpr: 0.00670, Avg fpr: 0.03448, total FA: 269

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.24910 | acc=0.2991 | tpr=0.0039 | fpr=0.0600 | 4102.7 samples/s | 16.0 steps/s
Avg test loss: 5.26029, Avg test acc: 0.29718, Avg tpr: 0.00484, Avg fpr: 0.05986, total FA: 467

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.26513 | acc=0.2971 | tpr=0.0056 | fpr=0.0699 | 4112.1 samples/s | 16.1 steps/s
Avg test loss: 5.27561, Avg test acc: 0.29486, Avg tpr: 0.00647, Avg fpr: 0.07089, total FA: 553

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.01211 | acc=0.3117 | tpr=0.0017 | fpr=0.0151 | 4169.5 samples/s | 16.3 steps/s
Avg test loss: 5.02272, Avg test acc: 0.30928, Avg tpr: 0.00239, Avg fpr: 0.01577, total FA: 123

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.85109 | acc=0.1024 | tpr=0.8628 | fpr=0.9112 | 4108.9 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.80057 | acc=0.1030 | tpr=0.8465 | fpr=0.9108 | 7968.7 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.80639 | acc=0.1007 | tpr=0.8573 | fpr=0.9132 | 8429.6 samples/s | 32.9 steps/s
[Step= 200] | Loss=5.80480 | acc=0.1005 | tpr=0.8536 | fpr=0.9132 | 7988.2 samples/s | 31.2 steps/s
[Step= 250] | Loss=5.81050 | acc=0.1010 | tpr=0.8515 | fpr=0.9126 | 8388.6 samples/s | 32.8 steps/s
[Step= 300] | Loss=5.80755 | acc=0.1008 | tpr=0.8473 | fpr=0.9128 | 7687.7 samples/s | 30.0 steps/s
[Step= 350] | Loss=5.80522 | acc=0.1007 | tpr=0.8447 | fpr=0.9128 | 8241.5 samples/s | 32.2 steps/s
[Step= 400] | Loss=5.80605 | acc=0.1012 | tpr=0.8419 | fpr=0.9123 | 7881.1 samples/s | 30.8 steps/s
[Step= 450] | Loss=5.80951 | acc=0.1009 | tpr=0.8379 | fpr=0.9125 | 8435.9 samples/s | 33.0 steps/s
[Step= 500] | Loss=5.81339 | acc=0.1005 | tpr=0.8357 | fpr=0.9127 | 8114.2 samples/s | 31.7 steps/s
[Step= 550] | Loss=5.81338 | acc=0.1004 | tpr=0.8388 | fpr=0.9131 | 13969.2 samples/s | 54.6 steps/s
Avg test loss: 5.81529, Avg test acc: 0.10037, Avg tpr: 0.83875, Avg fpr: 0.91306, total FA: 126776

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.32374 | acc=0.1128 | tpr=0.7832 | fpr=0.8992 | 4128.3 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.27042 | acc=0.1125 | tpr=0.7292 | fpr=0.8990 | 7794.9 samples/s | 30.4 steps/s
[Step= 150] | Loss=5.27539 | acc=0.1100 | tpr=0.7176 | fpr=0.9012 | 8081.9 samples/s | 31.6 steps/s
[Step= 200] | Loss=5.27122 | acc=0.1103 | tpr=0.7104 | fpr=0.9006 | 8206.1 samples/s | 32.1 steps/s
[Step= 250] | Loss=5.27240 | acc=0.1106 | tpr=0.7039 | fpr=0.9002 | 7949.8 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.27221 | acc=0.1102 | tpr=0.7062 | fpr=0.9007 | 7995.0 samples/s | 31.2 steps/s
[Step= 350] | Loss=5.26717 | acc=0.1100 | tpr=0.7019 | fpr=0.9008 | 8452.9 samples/s | 33.0 steps/s
[Step= 400] | Loss=5.26706 | acc=0.1102 | tpr=0.7024 | fpr=0.9005 | 7483.7 samples/s | 29.2 steps/s
[Step= 450] | Loss=5.27177 | acc=0.1103 | tpr=0.7016 | fpr=0.9005 | 8521.2 samples/s | 33.3 steps/s
[Step= 500] | Loss=5.27741 | acc=0.1098 | tpr=0.7013 | fpr=0.9009 | 7406.7 samples/s | 28.9 steps/s
[Step= 550] | Loss=5.27729 | acc=0.1094 | tpr=0.7047 | fpr=0.9014 | 15102.1 samples/s | 59.0 steps/s
Avg test loss: 5.27854, Avg test acc: 0.10942, Avg tpr: 0.70483, Avg fpr: 0.90140, total FA: 125158

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.17457 | acc=0.1120 | tpr=0.7699 | fpr=0.8999 | 3784.6 samples/s | 14.8 steps/s
[Step= 100] | Loss=6.11646 | acc=0.1143 | tpr=0.7484 | fpr=0.8975 | 7211.4 samples/s | 28.2 steps/s
[Step= 150] | Loss=6.12945 | acc=0.1121 | tpr=0.7608 | fpr=0.8998 | 7182.2 samples/s | 28.1 steps/s
[Step= 200] | Loss=6.13057 | acc=0.1116 | tpr=0.7574 | fpr=0.9001 | 7958.8 samples/s | 31.1 steps/s
[Step= 250] | Loss=6.13295 | acc=0.1120 | tpr=0.7616 | fpr=0.8999 | 8062.7 samples/s | 31.5 steps/s
[Step= 300] | Loss=6.12957 | acc=0.1118 | tpr=0.7629 | fpr=0.9001 | 8106.5 samples/s | 31.7 steps/s
[Step= 350] | Loss=6.12785 | acc=0.1115 | tpr=0.7564 | fpr=0.9002 | 8140.9 samples/s | 31.8 steps/s
[Step= 400] | Loss=6.12920 | acc=0.1120 | tpr=0.7560 | fpr=0.8997 | 8080.7 samples/s | 31.6 steps/s
[Step= 450] | Loss=6.13266 | acc=0.1114 | tpr=0.7537 | fpr=0.9003 | 8275.6 samples/s | 32.3 steps/s
[Step= 500] | Loss=6.13389 | acc=0.1112 | tpr=0.7529 | fpr=0.9004 | 7717.5 samples/s | 30.1 steps/s
[Step= 550] | Loss=6.13255 | acc=0.1111 | tpr=0.7573 | fpr=0.9006 | 14986.6 samples/s | 58.5 steps/s
Avg test loss: 6.13418, Avg test acc: 0.11106, Avg tpr: 0.75674, Avg fpr: 0.90068, total FA: 125057

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.29962 | acc=0.1258 | tpr=0.7566 | fpr=0.8856 | 4117.1 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.24864 | acc=0.1264 | tpr=0.7164 | fpr=0.8846 | 7935.2 samples/s | 31.0 steps/s
[Step= 150] | Loss=5.24614 | acc=0.1245 | tpr=0.7277 | fpr=0.8866 | 7715.9 samples/s | 30.1 steps/s
[Step= 200] | Loss=5.23848 | acc=0.1240 | tpr=0.7279 | fpr=0.8870 | 7937.5 samples/s | 31.0 steps/s
[Step= 250] | Loss=5.24030 | acc=0.1241 | tpr=0.7319 | fpr=0.8870 | 8469.4 samples/s | 33.1 steps/s
[Step= 300] | Loss=5.23941 | acc=0.1235 | tpr=0.7331 | fpr=0.8876 | 7530.1 samples/s | 29.4 steps/s
[Step= 350] | Loss=5.23402 | acc=0.1232 | tpr=0.7295 | fpr=0.8878 | 8253.7 samples/s | 32.2 steps/s
[Step= 400] | Loss=5.23725 | acc=0.1228 | tpr=0.7303 | fpr=0.8882 | 7941.8 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.24329 | acc=0.1226 | tpr=0.7259 | fpr=0.8883 | 7884.1 samples/s | 30.8 steps/s
[Step= 500] | Loss=5.24807 | acc=0.1226 | tpr=0.7256 | fpr=0.8883 | 8041.5 samples/s | 31.4 steps/s
[Step= 550] | Loss=5.24775 | acc=0.1225 | tpr=0.7254 | fpr=0.8885 | 14686.9 samples/s | 57.4 steps/s
Avg test loss: 5.24922, Avg test acc: 0.12244, Avg tpr: 0.72504, Avg fpr: 0.88851, total FA: 123368

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.03344 | acc=0.1289 | tpr=0.7212 | fpr=0.8817 | 4097.6 samples/s | 16.0 steps/s
[Step= 100] | Loss=4.97749 | acc=0.1314 | tpr=0.6930 | fpr=0.8791 | 8003.0 samples/s | 31.3 steps/s
[Step= 150] | Loss=4.98077 | acc=0.1301 | tpr=0.6988 | fpr=0.8803 | 7963.0 samples/s | 31.1 steps/s
[Step= 200] | Loss=4.97795 | acc=0.1297 | tpr=0.6951 | fpr=0.8806 | 8133.1 samples/s | 31.8 steps/s
[Step= 250] | Loss=4.98409 | acc=0.1297 | tpr=0.6926 | fpr=0.8806 | 7373.2 samples/s | 28.8 steps/s
[Step= 300] | Loss=4.97915 | acc=0.1295 | tpr=0.6953 | fpr=0.8809 | 8134.0 samples/s | 31.8 steps/s
[Step= 350] | Loss=4.97369 | acc=0.1290 | tpr=0.6951 | fpr=0.8813 | 7185.0 samples/s | 28.1 steps/s
[Step= 400] | Loss=4.97577 | acc=0.1291 | tpr=0.6915 | fpr=0.8811 | 7674.2 samples/s | 30.0 steps/s
[Step= 450] | Loss=4.97713 | acc=0.1291 | tpr=0.6835 | fpr=0.8810 | 8177.2 samples/s | 31.9 steps/s
[Step= 500] | Loss=4.97954 | acc=0.1285 | tpr=0.6824 | fpr=0.8815 | 7630.3 samples/s | 29.8 steps/s
[Step= 550] | Loss=4.97856 | acc=0.1285 | tpr=0.6825 | fpr=0.8816 | 14845.0 samples/s | 58.0 steps/s
Avg test loss: 4.98030, Avg test acc: 0.12843, Avg tpr: 0.68225, Avg fpr: 0.88163, total FA: 122413

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10571 | acc=0.9804 | tpr=0.9159 | fpr=0.0185 | 4117.6 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.10999 | acc=0.9800 | tpr=0.9424 | fpr=0.0193 | 8052.0 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.11445 | acc=0.9790 | tpr=0.9452 | fpr=0.0204 | 8363.4 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.11630 | acc=0.9788 | tpr=0.9475 | fpr=0.0206 | 7715.6 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.11564 | acc=0.9788 | tpr=0.9432 | fpr=0.0205 | 7765.9 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.11767 | acc=0.9786 | tpr=0.9411 | fpr=0.0207 | 8001.9 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.11756 | acc=0.9785 | tpr=0.9405 | fpr=0.0208 | 7794.8 samples/s | 30.4 steps/s
[Step= 400] | Loss=0.11891 | acc=0.9784 | tpr=0.9376 | fpr=0.0209 | 8079.7 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.12170 | acc=0.9781 | tpr=0.9377 | fpr=0.0211 | 7885.9 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.12141 | acc=0.9782 | tpr=0.9392 | fpr=0.0211 | 7658.8 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.12037 | acc=0.9784 | tpr=0.9387 | fpr=0.0209 | 14580.9 samples/s | 57.0 steps/s
Avg test loss: 0.12022, Avg test acc: 0.97842, Avg tpr: 0.93899, Avg fpr: 0.02086, total FA: 2897

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.12098 | acc=0.9810 | tpr=0.8938 | fpr=0.0174 | 4196.7 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.12524 | acc=0.9804 | tpr=0.9083 | fpr=0.0182 | 7883.2 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.13038 | acc=0.9795 | tpr=0.9063 | fpr=0.0192 | 8055.1 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.13214 | acc=0.9796 | tpr=0.9148 | fpr=0.0192 | 7955.9 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.13045 | acc=0.9797 | tpr=0.9135 | fpr=0.0191 | 8221.2 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.13274 | acc=0.9792 | tpr=0.9120 | fpr=0.0196 | 7675.0 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.13276 | acc=0.9792 | tpr=0.9167 | fpr=0.0197 | 8025.0 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.13414 | acc=0.9789 | tpr=0.9125 | fpr=0.0198 | 7806.1 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.13748 | acc=0.9787 | tpr=0.9114 | fpr=0.0201 | 8273.2 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.13673 | acc=0.9788 | tpr=0.9150 | fpr=0.0201 | 8157.0 samples/s | 31.9 steps/s
[Step= 550] | Loss=0.13557 | acc=0.9789 | tpr=0.9152 | fpr=0.0199 | 13452.8 samples/s | 52.6 steps/s
Avg test loss: 0.13535, Avg test acc: 0.97895, Avg tpr: 0.91442, Avg fpr: 0.01988, total FA: 2760

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10786 | acc=0.9792 | tpr=0.9381 | fpr=0.0200 | 4070.9 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.11218 | acc=0.9793 | tpr=0.9574 | fpr=0.0203 | 8460.6 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.11644 | acc=0.9783 | tpr=0.9539 | fpr=0.0212 | 7640.5 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.11884 | acc=0.9783 | tpr=0.9563 | fpr=0.0213 | 7732.9 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.11794 | acc=0.9784 | tpr=0.9537 | fpr=0.0212 | 8140.1 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.12011 | acc=0.9779 | tpr=0.9549 | fpr=0.0217 | 7763.6 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.12009 | acc=0.9777 | tpr=0.9549 | fpr=0.0218 | 8081.3 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.12147 | acc=0.9776 | tpr=0.9530 | fpr=0.0219 | 8197.1 samples/s | 32.0 steps/s
[Step= 450] | Loss=0.12440 | acc=0.9774 | tpr=0.9528 | fpr=0.0222 | 7878.6 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.12404 | acc=0.9774 | tpr=0.9537 | fpr=0.0222 | 7561.5 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.12297 | acc=0.9776 | tpr=0.9530 | fpr=0.0220 | 14916.5 samples/s | 58.3 steps/s
Avg test loss: 0.12281, Avg test acc: 0.97761, Avg tpr: 0.95325, Avg fpr: 0.02195, total FA: 3048

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11740 | acc=0.9807 | tpr=0.9159 | fpr=0.0181 | 4137.3 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.12215 | acc=0.9799 | tpr=0.9339 | fpr=0.0192 | 7839.0 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.12692 | acc=0.9791 | tpr=0.9366 | fpr=0.0201 | 8090.7 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.12901 | acc=0.9789 | tpr=0.9443 | fpr=0.0204 | 8309.5 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.12781 | acc=0.9788 | tpr=0.9397 | fpr=0.0205 | 7667.7 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.12979 | acc=0.9786 | tpr=0.9396 | fpr=0.0207 | 8221.0 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.12974 | acc=0.9785 | tpr=0.9430 | fpr=0.0208 | 7557.2 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.13081 | acc=0.9784 | tpr=0.9398 | fpr=0.0209 | 8129.3 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.13394 | acc=0.9780 | tpr=0.9387 | fpr=0.0212 | 7767.3 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.13352 | acc=0.9781 | tpr=0.9410 | fpr=0.0212 | 7940.1 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.13254 | acc=0.9783 | tpr=0.9411 | fpr=0.0210 | 14609.9 samples/s | 57.1 steps/s
Avg test loss: 0.13238, Avg test acc: 0.97830, Avg tpr: 0.94097, Avg fpr: 0.02102, total FA: 2919

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12996 | acc=0.9791 | tpr=0.9204 | fpr=0.0199 | 4050.2 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.13496 | acc=0.9788 | tpr=0.9446 | fpr=0.0205 | 8103.8 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.14017 | acc=0.9779 | tpr=0.9438 | fpr=0.0215 | 7883.8 samples/s | 30.8 steps/s
[Step= 200] | Loss=0.14272 | acc=0.9777 | tpr=0.9475 | fpr=0.0217 | 8139.3 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.14122 | acc=0.9779 | tpr=0.9450 | fpr=0.0215 | 8082.7 samples/s | 31.6 steps/s
[Step= 300] | Loss=0.14395 | acc=0.9775 | tpr=0.9447 | fpr=0.0219 | 7880.0 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.14438 | acc=0.9774 | tpr=0.9474 | fpr=0.0221 | 7891.9 samples/s | 30.8 steps/s
[Step= 400] | Loss=0.14577 | acc=0.9772 | tpr=0.9420 | fpr=0.0222 | 8044.2 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.14903 | acc=0.9768 | tpr=0.9416 | fpr=0.0226 | 7823.8 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.14844 | acc=0.9768 | tpr=0.9414 | fpr=0.0226 | 8048.8 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.14764 | acc=0.9770 | tpr=0.9407 | fpr=0.0224 | 14058.4 samples/s | 54.9 steps/s
Avg test loss: 0.14738, Avg test acc: 0.97698, Avg tpr: 0.94097, Avg fpr: 0.02236, total FA: 3105

server round 30/50

clients selected: [0 1 6 7 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=28001 Epoch=136.5] | Loss=0.01726 | Reg=0.00112 | acc=0.9688 | L2-Norm=10.586 | L2-Norm(final)=10.511 | 3780.3 samples/s | 59.1 steps/s
[Step=28050 Epoch=136.8] | Loss=0.02368 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.590 | L2-Norm(final)=10.506 | 4700.8 samples/s | 73.5 steps/s
[Step=28100 Epoch=137.0] | Loss=0.02079 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.600 | L2-Norm(final)=10.506 | 5155.3 samples/s | 80.6 steps/s
[Step=28150 Epoch=137.3] | Loss=0.01981 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.609 | L2-Norm(final)=10.510 | 5019.8 samples/s | 78.4 steps/s
[Step=28200 Epoch=137.5] | Loss=0.02000 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.616 | L2-Norm(final)=10.512 | 7194.4 samples/s | 112.4 steps/s
[Step=28250 Epoch=137.8] | Loss=0.01968 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.622 | L2-Norm(final)=10.515 | 1812.7 samples/s | 28.3 steps/s
[Step=28300 Epoch=138.0] | Loss=0.01855 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.629 | L2-Norm(final)=10.519 | 5165.5 samples/s | 80.7 steps/s
[Step=28350 Epoch=138.2] | Loss=0.01797 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.636 | L2-Norm(final)=10.524 | 4982.5 samples/s | 77.9 steps/s
[Step=28400 Epoch=138.5] | Loss=0.01762 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.644 | L2-Norm(final)=10.529 | 6506.1 samples/s | 101.7 steps/s
[Step=28450 Epoch=138.7] | Loss=0.01685 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.651 | L2-Norm(final)=10.535 | 1850.1 samples/s | 28.9 steps/s
[Step=28500 Epoch=139.0] | Loss=0.01653 | Reg=0.00114 | acc=0.9844 | L2-Norm=10.658 | L2-Norm(final)=10.541 | 5088.8 samples/s | 79.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=28501 Epoch=139.0] | Loss=0.01485 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.728 | L2-Norm(final)=10.603 | 3686.2 samples/s | 57.6 steps/s
[Step=28550 Epoch=139.2] | Loss=0.01126 | Reg=0.00115 | acc=0.9688 | L2-Norm=10.738 | L2-Norm(final)=10.612 | 4402.9 samples/s | 68.8 steps/s
[Step=28600 Epoch=139.5] | Loss=0.01151 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.749 | L2-Norm(final)=10.620 | 4542.6 samples/s | 71.0 steps/s
[Step=28650 Epoch=139.7] | Loss=0.01267 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.760 | L2-Norm(final)=10.627 | 4578.8 samples/s | 71.5 steps/s
[Step=28700 Epoch=139.9] | Loss=0.01234 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.770 | L2-Norm(final)=10.633 | 5930.0 samples/s | 92.7 steps/s
[Step=28750 Epoch=140.2] | Loss=0.01116 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.779 | L2-Norm(final)=10.639 | 1754.4 samples/s | 27.4 steps/s
[Step=28800 Epoch=140.4] | Loss=0.01018 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.786 | L2-Norm(final)=10.645 | 4700.9 samples/s | 73.5 steps/s
[Step=28850 Epoch=140.7] | Loss=0.00970 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.793 | L2-Norm(final)=10.650 | 4660.9 samples/s | 72.8 steps/s
[Step=28900 Epoch=140.9] | Loss=0.00933 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.799 | L2-Norm(final)=10.655 | 5568.6 samples/s | 87.0 steps/s
[Step=28950 Epoch=141.2] | Loss=0.00884 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.805 | L2-Norm(final)=10.661 | 1749.8 samples/s | 27.3 steps/s
[Step=29000 Epoch=141.4] | Loss=0.00847 | Reg=0.00117 | acc=0.9688 | L2-Norm=10.810 | L2-Norm(final)=10.666 | 4569.7 samples/s | 71.4 steps/s
[Step=29050 Epoch=141.7] | Loss=0.00809 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.816 | L2-Norm(final)=10.670 | 4615.9 samples/s | 72.1 steps/s
[Step=29100 Epoch=141.9] | Loss=0.00775 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.820 | L2-Norm(final)=10.675 | 5287.1 samples/s | 82.6 steps/s
[Step=29150 Epoch=142.1] | Loss=0.00768 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.825 | L2-Norm(final)=10.679 | 1833.9 samples/s | 28.7 steps/s
[Step=29200 Epoch=142.4] | Loss=0.00751 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.830 | L2-Norm(final)=10.683 | 4639.3 samples/s | 72.5 steps/s
[Step=29250 Epoch=142.6] | Loss=0.00721 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.835 | L2-Norm(final)=10.687 | 4792.6 samples/s | 74.9 steps/s
[Step=29300 Epoch=142.9] | Loss=0.00709 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.839 | L2-Norm(final)=10.691 | 5012.8 samples/s | 78.3 steps/s
[Step=29350 Epoch=143.1] | Loss=0.00695 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.843 | L2-Norm(final)=10.695 | 1865.5 samples/s | 29.1 steps/s
[Step=29400 Epoch=143.4] | Loss=0.00680 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.847 | L2-Norm(final)=10.698 | 4539.7 samples/s | 70.9 steps/s
[Step=29450 Epoch=143.6] | Loss=0.00663 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.850 | L2-Norm(final)=10.701 | 4546.4 samples/s | 71.0 steps/s
[Step=29500 Epoch=143.8] | Loss=0.00650 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.854 | L2-Norm(final)=10.705 | 4622.0 samples/s | 72.2 steps/s
[Step=29550 Epoch=144.1] | Loss=0.00628 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.857 | L2-Norm(final)=10.708 | 1894.7 samples/s | 29.6 steps/s
[Step=29600 Epoch=144.3] | Loss=0.00615 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.861 | L2-Norm(final)=10.711 | 4713.1 samples/s | 73.6 steps/s
[Step=29650 Epoch=144.6] | Loss=0.00606 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.864 | L2-Norm(final)=10.714 | 4585.0 samples/s | 71.6 steps/s
[Step=29700 Epoch=144.8] | Loss=0.00594 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.867 | L2-Norm(final)=10.717 | 4486.4 samples/s | 70.1 steps/s
[Step=29750 Epoch=145.1] | Loss=0.00583 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.870 | L2-Norm(final)=10.720 | 1922.9 samples/s | 30.0 steps/s
[Step=29800 Epoch=145.3] | Loss=0.00580 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.873 | L2-Norm(final)=10.723 | 4868.4 samples/s | 76.1 steps/s
[Step=29850 Epoch=145.6] | Loss=0.00568 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.876 | L2-Norm(final)=10.726 | 4526.6 samples/s | 70.7 steps/s
[Step=29900 Epoch=145.8] | Loss=0.00560 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.878 | L2-Norm(final)=10.729 | 4797.9 samples/s | 75.0 steps/s
[Step=29950 Epoch=146.0] | Loss=0.00552 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.881 | L2-Norm(final)=10.732 | 1876.9 samples/s | 29.3 steps/s
[Step=30000 Epoch=146.3] | Loss=0.00546 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.884 | L2-Norm(final)=10.734 | 4776.2 samples/s | 74.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step30000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=38001 Epoch=185.4] | Loss=0.01192 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.586 | L2-Norm(final)=12.053 | 3857.8 samples/s | 60.3 steps/s
[Step=38050 Epoch=185.7] | Loss=0.02178 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.594 | L2-Norm(final)=12.047 | 4628.3 samples/s | 72.3 steps/s
[Step=38100 Epoch=185.9] | Loss=0.02028 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.603 | L2-Norm(final)=12.047 | 5093.0 samples/s | 79.6 steps/s
[Step=38150 Epoch=186.2] | Loss=0.02047 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.611 | L2-Norm(final)=12.048 | 5227.7 samples/s | 81.7 steps/s
[Step=38200 Epoch=186.4] | Loss=0.01883 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.618 | L2-Norm(final)=12.050 | 7108.9 samples/s | 111.1 steps/s
[Step=38250 Epoch=186.6] | Loss=0.01757 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.626 | L2-Norm(final)=12.053 | 1783.3 samples/s | 27.9 steps/s
[Step=38300 Epoch=186.9] | Loss=0.01646 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.633 | L2-Norm(final)=12.058 | 5114.0 samples/s | 79.9 steps/s
[Step=38350 Epoch=187.1] | Loss=0.01599 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.640 | L2-Norm(final)=12.063 | 5294.2 samples/s | 82.7 steps/s
[Step=38400 Epoch=187.4] | Loss=0.01556 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.647 | L2-Norm(final)=12.069 | 6632.9 samples/s | 103.6 steps/s
[Step=38450 Epoch=187.6] | Loss=0.01508 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.655 | L2-Norm(final)=12.075 | 1852.5 samples/s | 28.9 steps/s
[Step=38500 Epoch=187.9] | Loss=0.01446 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.662 | L2-Norm(final)=12.081 | 5262.9 samples/s | 82.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=187.9] | Loss=0.00619 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.734 | L2-Norm(final)=12.146 | 4101.2 samples/s | 64.1 steps/s
[Step=38550 Epoch=188.1] | Loss=0.01029 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.744 | L2-Norm(final)=12.153 | 4131.8 samples/s | 64.6 steps/s
[Step=38600 Epoch=188.4] | Loss=0.01186 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.756 | L2-Norm(final)=12.160 | 4609.7 samples/s | 72.0 steps/s
[Step=38650 Epoch=188.6] | Loss=0.01157 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.766 | L2-Norm(final)=12.165 | 4485.5 samples/s | 70.1 steps/s
[Step=38700 Epoch=188.8] | Loss=0.01130 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.774 | L2-Norm(final)=12.171 | 6128.0 samples/s | 95.7 steps/s
[Step=38750 Epoch=189.1] | Loss=0.01030 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.782 | L2-Norm(final)=12.177 | 1736.1 samples/s | 27.1 steps/s
[Step=38800 Epoch=189.3] | Loss=0.00983 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.789 | L2-Norm(final)=12.182 | 4520.6 samples/s | 70.6 steps/s
[Step=38850 Epoch=189.6] | Loss=0.00929 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.795 | L2-Norm(final)=12.187 | 4685.8 samples/s | 73.2 steps/s
[Step=38900 Epoch=189.8] | Loss=0.00870 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.801 | L2-Norm(final)=12.192 | 5737.3 samples/s | 89.6 steps/s
[Step=38950 Epoch=190.1] | Loss=0.00823 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.806 | L2-Norm(final)=12.197 | 1806.7 samples/s | 28.2 steps/s
[Step=39000 Epoch=190.3] | Loss=0.00801 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.810 | L2-Norm(final)=12.201 | 4660.2 samples/s | 72.8 steps/s
[Step=39050 Epoch=190.5] | Loss=0.00754 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.815 | L2-Norm(final)=12.204 | 4562.8 samples/s | 71.3 steps/s
[Step=39100 Epoch=190.8] | Loss=0.00714 | Reg=0.00117 | acc=0.9844 | L2-Norm=10.819 | L2-Norm(final)=12.208 | 5476.7 samples/s | 85.6 steps/s
[Step=39150 Epoch=191.0] | Loss=0.00687 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.823 | L2-Norm(final)=12.212 | 1828.7 samples/s | 28.6 steps/s
[Step=39200 Epoch=191.3] | Loss=0.00656 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.826 | L2-Norm(final)=12.216 | 4487.1 samples/s | 70.1 steps/s
[Step=39250 Epoch=191.5] | Loss=0.00642 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.830 | L2-Norm(final)=12.219 | 4517.9 samples/s | 70.6 steps/s
[Step=39300 Epoch=191.8] | Loss=0.00640 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.833 | L2-Norm(final)=12.222 | 4928.6 samples/s | 77.0 steps/s
[Step=39350 Epoch=192.0] | Loss=0.00621 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.836 | L2-Norm(final)=12.226 | 1864.2 samples/s | 29.1 steps/s
[Step=39400 Epoch=192.3] | Loss=0.00609 | Reg=0.00117 | acc=1.0000 | L2-Norm=10.840 | L2-Norm(final)=12.229 | 4585.3 samples/s | 71.6 steps/s
[Step=39450 Epoch=192.5] | Loss=0.00595 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.843 | L2-Norm(final)=12.232 | 4551.4 samples/s | 71.1 steps/s
[Step=39500 Epoch=192.7] | Loss=0.00583 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.846 | L2-Norm(final)=12.235 | 4912.7 samples/s | 76.8 steps/s
[Step=39550 Epoch=193.0] | Loss=0.00573 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.849 | L2-Norm(final)=12.238 | 1891.8 samples/s | 29.6 steps/s
[Step=39600 Epoch=193.2] | Loss=0.00562 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.851 | L2-Norm(final)=12.240 | 4615.4 samples/s | 72.1 steps/s
[Step=39650 Epoch=193.5] | Loss=0.00555 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.854 | L2-Norm(final)=12.243 | 4615.4 samples/s | 72.1 steps/s
[Step=39700 Epoch=193.7] | Loss=0.00542 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.856 | L2-Norm(final)=12.246 | 4608.3 samples/s | 72.0 steps/s
[Step=39750 Epoch=194.0] | Loss=0.00531 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.859 | L2-Norm(final)=12.248 | 1871.8 samples/s | 29.2 steps/s
[Step=39800 Epoch=194.2] | Loss=0.00524 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.861 | L2-Norm(final)=12.251 | 4662.8 samples/s | 72.9 steps/s
[Step=39850 Epoch=194.4] | Loss=0.00518 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.864 | L2-Norm(final)=12.253 | 4529.5 samples/s | 70.8 steps/s
[Step=39900 Epoch=194.7] | Loss=0.00509 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.866 | L2-Norm(final)=12.256 | 4413.1 samples/s | 69.0 steps/s
[Step=39950 Epoch=194.9] | Loss=0.00508 | Reg=0.00118 | acc=0.9844 | L2-Norm=10.869 | L2-Norm(final)=12.258 | 1905.7 samples/s | 29.8 steps/s
[Step=40000 Epoch=195.2] | Loss=0.00501 | Reg=0.00118 | acc=1.0000 | L2-Norm=10.871 | L2-Norm(final)=12.261 | 4689.5 samples/s | 73.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step40000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=30001 Epoch=285.4] | Loss=0.00127 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.586 | L2-Norm(final)=8.740 | 3626.1 samples/s | 56.7 steps/s
[Step=30050 Epoch=285.9] | Loss=0.00324 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.609 | L2-Norm(final)=8.749 | 4442.8 samples/s | 69.4 steps/s
[Step=30100 Epoch=286.3] | Loss=0.00216 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.625 | L2-Norm(final)=8.758 | 6893.9 samples/s | 107.7 steps/s
[Step=30150 Epoch=286.8] | Loss=0.00156 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.634 | L2-Norm(final)=8.764 | 1712.6 samples/s | 26.8 steps/s
[Step=30200 Epoch=287.3] | Loss=0.00123 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.640 | L2-Norm(final)=8.771 | 6197.4 samples/s | 96.8 steps/s
[Step=30250 Epoch=287.8] | Loss=0.00103 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.644 | L2-Norm(final)=8.777 | 1781.7 samples/s | 27.8 steps/s
[Step=30300 Epoch=288.2] | Loss=0.00089 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.647 | L2-Norm(final)=8.782 | 5726.8 samples/s | 89.5 steps/s
[Step=30350 Epoch=288.7] | Loss=0.00079 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.649 | L2-Norm(final)=8.787 | 1808.6 samples/s | 28.3 steps/s
[Step=30400 Epoch=289.2] | Loss=0.00071 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.650 | L2-Norm(final)=8.792 | 5354.2 samples/s | 83.7 steps/s
[Step=30450 Epoch=289.7] | Loss=0.00064 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.652 | L2-Norm(final)=8.796 | 1875.4 samples/s | 29.3 steps/s
[Step=30500 Epoch=290.1] | Loss=0.00059 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.653 | L2-Norm(final)=8.801 | 5146.1 samples/s | 80.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=290.1] | Loss=0.00009 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.660 | L2-Norm(final)=8.844 | 3917.4 samples/s | 61.2 steps/s
[Step=30550 Epoch=290.6] | Loss=0.00011 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.659 | L2-Norm(final)=8.847 | 3821.6 samples/s | 59.7 steps/s
[Step=30600 Epoch=291.1] | Loss=0.00009 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.656 | L2-Norm(final)=8.850 | 5909.6 samples/s | 92.3 steps/s
[Step=30650 Epoch=291.6] | Loss=0.00006 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.651 | L2-Norm(final)=8.851 | 1689.2 samples/s | 26.4 steps/s
[Step=30700 Epoch=292.0] | Loss=0.00005 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.644 | L2-Norm(final)=8.852 | 5386.3 samples/s | 84.2 steps/s
[Step=30750 Epoch=292.5] | Loss=0.00004 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.637 | L2-Norm(final)=8.853 | 1732.7 samples/s | 27.1 steps/s
[Step=30800 Epoch=293.0] | Loss=0.00003 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.628 | L2-Norm(final)=8.854 | 5128.4 samples/s | 80.1 steps/s
[Step=30850 Epoch=293.5] | Loss=0.00003 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.619 | L2-Norm(final)=8.854 | 1767.5 samples/s | 27.6 steps/s
[Step=30900 Epoch=293.9] | Loss=0.00003 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.610 | L2-Norm(final)=8.855 | 4761.7 samples/s | 74.4 steps/s
[Step=30950 Epoch=294.4] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.601 | L2-Norm(final)=8.855 | 1815.2 samples/s | 28.4 steps/s
[Step=31000 Epoch=294.9] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.591 | L2-Norm(final)=8.855 | 4469.8 samples/s | 69.8 steps/s
[Step=31050 Epoch=295.4] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.581 | L2-Norm(final)=8.856 | 1860.1 samples/s | 29.1 steps/s
[Step=31100 Epoch=295.8] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.571 | L2-Norm(final)=8.856 | 4267.1 samples/s | 66.7 steps/s
[Step=31150 Epoch=296.3] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.561 | L2-Norm(final)=8.856 | 1872.2 samples/s | 29.3 steps/s
[Step=31200 Epoch=296.8] | Loss=0.00002 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.550 | L2-Norm(final)=8.856 | 4309.1 samples/s | 67.3 steps/s
[Step=31250 Epoch=297.3] | Loss=0.00002 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.540 | L2-Norm(final)=8.857 | 1879.0 samples/s | 29.4 steps/s
[Step=31300 Epoch=297.7] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.529 | L2-Norm(final)=8.857 | 4354.0 samples/s | 68.0 steps/s
[Step=31350 Epoch=298.2] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.518 | L2-Norm(final)=8.857 | 1910.4 samples/s | 29.9 steps/s
[Step=31400 Epoch=298.7] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.507 | L2-Norm(final)=8.857 | 4239.3 samples/s | 66.2 steps/s
[Step=31450 Epoch=299.2] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.496 | L2-Norm(final)=8.857 | 6108.7 samples/s | 95.4 steps/s
[Step=31500 Epoch=299.6] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.484 | L2-Norm(final)=8.858 | 1658.4 samples/s | 25.9 steps/s
[Step=31550 Epoch=300.1] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.473 | L2-Norm(final)=8.858 | 5597.1 samples/s | 87.5 steps/s
[Step=31600 Epoch=300.6] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.461 | L2-Norm(final)=8.858 | 1696.9 samples/s | 26.5 steps/s
[Step=31650 Epoch=301.1] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.449 | L2-Norm(final)=8.858 | 5302.4 samples/s | 82.8 steps/s
[Step=31700 Epoch=301.5] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.437 | L2-Norm(final)=8.858 | 1792.9 samples/s | 28.0 steps/s
[Step=31750 Epoch=302.0] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.425 | L2-Norm(final)=8.859 | 4878.4 samples/s | 76.2 steps/s
[Step=31800 Epoch=302.5] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.412 | L2-Norm(final)=8.859 | 1815.2 samples/s | 28.4 steps/s
[Step=31850 Epoch=303.0] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.400 | L2-Norm(final)=8.859 | 4573.8 samples/s | 71.5 steps/s
[Step=31900 Epoch=303.4] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.387 | L2-Norm(final)=8.859 | 1832.2 samples/s | 28.6 steps/s
[Step=31950 Epoch=303.9] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.374 | L2-Norm(final)=8.859 | 4308.6 samples/s | 67.3 steps/s
[Step=32000 Epoch=304.4] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.361 | L2-Norm(final)=8.860 | 1847.6 samples/s | 28.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step32000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=32001 Epoch=305.6] | Loss=0.02456 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.586 | L2-Norm(final)=8.255 | 3732.6 samples/s | 58.3 steps/s
[Step=32050 Epoch=306.1] | Loss=0.00194 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.606 | L2-Norm(final)=8.257 | 4477.8 samples/s | 70.0 steps/s
[Step=32100 Epoch=306.5] | Loss=0.00111 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.618 | L2-Norm(final)=8.267 | 6724.9 samples/s | 105.1 steps/s
[Step=32150 Epoch=307.0] | Loss=0.00080 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.622 | L2-Norm(final)=8.275 | 1733.0 samples/s | 27.1 steps/s
[Step=32200 Epoch=307.5] | Loss=0.00063 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=8.281 | 6218.2 samples/s | 97.2 steps/s
[Step=32250 Epoch=308.0] | Loss=0.00053 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=8.287 | 1785.7 samples/s | 27.9 steps/s
[Step=32300 Epoch=308.4] | Loss=0.00045 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.624 | L2-Norm(final)=8.293 | 6109.6 samples/s | 95.5 steps/s
[Step=32350 Epoch=308.9] | Loss=0.00040 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.623 | L2-Norm(final)=8.298 | 1840.8 samples/s | 28.8 steps/s
[Step=32400 Epoch=309.4] | Loss=0.00036 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.622 | L2-Norm(final)=8.302 | 5837.1 samples/s | 91.2 steps/s
[Step=32450 Epoch=309.9] | Loss=0.00033 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.620 | L2-Norm(final)=8.307 | 1831.1 samples/s | 28.6 steps/s
[Step=32500 Epoch=310.4] | Loss=0.00030 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.619 | L2-Norm(final)=8.311 | 5347.1 samples/s | 83.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=310.4] | Loss=0.00008 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.601 | L2-Norm(final)=8.353 | 3624.6 samples/s | 56.6 steps/s
[Step=32550 Epoch=310.8] | Loss=0.00005 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.593 | L2-Norm(final)=8.356 | 4158.5 samples/s | 65.0 steps/s
[Step=32600 Epoch=311.3] | Loss=0.00003 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.580 | L2-Norm(final)=8.358 | 5926.5 samples/s | 92.6 steps/s
[Step=32650 Epoch=311.8] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.564 | L2-Norm(final)=8.359 | 1684.8 samples/s | 26.3 steps/s
[Step=32700 Epoch=312.3] | Loss=0.00002 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.547 | L2-Norm(final)=8.360 | 5537.5 samples/s | 86.5 steps/s
[Step=32750 Epoch=312.7] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.529 | L2-Norm(final)=8.360 | 1710.0 samples/s | 26.7 steps/s
[Step=32800 Epoch=313.2] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.511 | L2-Norm(final)=8.360 | 5166.7 samples/s | 80.7 steps/s
[Step=32850 Epoch=313.7] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.492 | L2-Norm(final)=8.361 | 1746.5 samples/s | 27.3 steps/s
[Step=32900 Epoch=314.2] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.473 | L2-Norm(final)=8.361 | 5021.7 samples/s | 78.5 steps/s
[Step=32950 Epoch=314.7] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.454 | L2-Norm(final)=8.361 | 1832.9 samples/s | 28.6 steps/s
[Step=33000 Epoch=315.1] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.435 | L2-Norm(final)=8.361 | 4681.7 samples/s | 73.2 steps/s
[Step=33050 Epoch=315.6] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.415 | L2-Norm(final)=8.362 | 1835.3 samples/s | 28.7 steps/s
[Step=33100 Epoch=316.1] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.395 | L2-Norm(final)=8.362 | 4616.6 samples/s | 72.1 steps/s
[Step=33150 Epoch=316.6] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.375 | L2-Norm(final)=8.362 | 1846.8 samples/s | 28.9 steps/s
[Step=33200 Epoch=317.0] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.355 | L2-Norm(final)=8.362 | 4390.6 samples/s | 68.6 steps/s
[Step=33250 Epoch=317.5] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.334 | L2-Norm(final)=8.362 | 1833.2 samples/s | 28.6 steps/s
[Step=33300 Epoch=318.0] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.314 | L2-Norm(final)=8.363 | 4284.6 samples/s | 66.9 steps/s
[Step=33350 Epoch=318.5] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.293 | L2-Norm(final)=8.363 | 1838.1 samples/s | 28.7 steps/s
[Step=33400 Epoch=318.9] | Loss=0.00000 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.272 | L2-Norm(final)=8.363 | 4384.9 samples/s | 68.5 steps/s
[Step=33450 Epoch=319.4] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.251 | L2-Norm(final)=8.363 | 1890.5 samples/s | 29.5 steps/s
[Step=33500 Epoch=319.9] | Loss=0.00000 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.230 | L2-Norm(final)=8.363 | 4185.7 samples/s | 65.4 steps/s
[Step=33550 Epoch=320.4] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.208 | L2-Norm(final)=8.363 | 6170.0 samples/s | 96.4 steps/s
[Step=33600 Epoch=320.9] | Loss=0.00000 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.186 | L2-Norm(final)=8.364 | 1662.4 samples/s | 26.0 steps/s
[Step=33650 Epoch=321.3] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.164 | L2-Norm(final)=8.364 | 5943.7 samples/s | 92.9 steps/s
[Step=33700 Epoch=321.8] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.142 | L2-Norm(final)=8.364 | 1596.1 samples/s | 24.9 steps/s
[Step=33750 Epoch=322.3] | Loss=0.00000 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.120 | L2-Norm(final)=8.364 | 5261.7 samples/s | 82.2 steps/s
[Step=33800 Epoch=322.8] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.097 | L2-Norm(final)=8.364 | 1703.4 samples/s | 26.6 steps/s
[Step=33850 Epoch=323.2] | Loss=0.00000 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.075 | L2-Norm(final)=8.365 | 5145.8 samples/s | 80.4 steps/s
[Step=33900 Epoch=323.7] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.052 | L2-Norm(final)=8.365 | 1703.7 samples/s | 26.6 steps/s
[Step=33950 Epoch=324.2] | Loss=0.00000 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.029 | L2-Norm(final)=8.365 | 4946.7 samples/s | 77.3 steps/s
[Step=34000 Epoch=324.7] | Loss=0.00000 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.005 | L2-Norm(final)=8.365 | 1759.0 samples/s | 27.5 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step34000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=30001 Epoch=285.9] | Loss=0.01698 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.586 | L2-Norm(final)=8.996 | 3810.8 samples/s | 59.5 steps/s
[Step=30050 Epoch=286.4] | Loss=0.00329 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.606 | L2-Norm(final)=9.003 | 4293.9 samples/s | 67.1 steps/s
[Step=30100 Epoch=286.9] | Loss=0.00222 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.624 | L2-Norm(final)=9.016 | 7044.5 samples/s | 110.1 steps/s
[Step=30150 Epoch=287.4] | Loss=0.00161 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.635 | L2-Norm(final)=9.026 | 1731.2 samples/s | 27.1 steps/s
[Step=30200 Epoch=287.8] | Loss=0.00128 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.643 | L2-Norm(final)=9.035 | 6545.5 samples/s | 102.3 steps/s
[Step=30250 Epoch=288.3] | Loss=0.00108 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.648 | L2-Norm(final)=9.043 | 1809.9 samples/s | 28.3 steps/s
[Step=30300 Epoch=288.8] | Loss=0.00092 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.652 | L2-Norm(final)=9.049 | 6056.7 samples/s | 94.6 steps/s
[Step=30350 Epoch=289.3] | Loss=0.00081 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.654 | L2-Norm(final)=9.055 | 1787.8 samples/s | 27.9 steps/s
[Step=30400 Epoch=289.7] | Loss=0.00073 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.656 | L2-Norm(final)=9.061 | 5631.1 samples/s | 88.0 steps/s
[Step=30450 Epoch=290.2] | Loss=0.00066 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.658 | L2-Norm(final)=9.066 | 1875.5 samples/s | 29.3 steps/s
[Step=30500 Epoch=290.7] | Loss=0.00061 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.658 | L2-Norm(final)=9.071 | 5137.5 samples/s | 80.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=290.7] | Loss=0.00015 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.666 | L2-Norm(final)=9.119 | 3987.6 samples/s | 62.3 steps/s
[Step=30550 Epoch=291.2] | Loss=0.00011 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.664 | L2-Norm(final)=9.123 | 3923.7 samples/s | 61.3 steps/s
[Step=30600 Epoch=291.6] | Loss=0.00008 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.660 | L2-Norm(final)=9.125 | 5723.5 samples/s | 89.4 steps/s
[Step=30650 Epoch=292.1] | Loss=0.00006 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.654 | L2-Norm(final)=9.127 | 1677.1 samples/s | 26.2 steps/s
[Step=30700 Epoch=292.6] | Loss=0.00004 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.646 | L2-Norm(final)=9.128 | 5584.1 samples/s | 87.3 steps/s
[Step=30750 Epoch=293.1] | Loss=0.00004 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.637 | L2-Norm(final)=9.129 | 1717.2 samples/s | 26.8 steps/s
[Step=30800 Epoch=293.6] | Loss=0.00003 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.628 | L2-Norm(final)=9.130 | 5131.7 samples/s | 80.2 steps/s
[Step=30850 Epoch=294.0] | Loss=0.00003 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.619 | L2-Norm(final)=9.130 | 1758.3 samples/s | 27.5 steps/s
[Step=30900 Epoch=294.5] | Loss=0.00002 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.609 | L2-Norm(final)=9.131 | 4920.4 samples/s | 76.9 steps/s
[Step=30950 Epoch=295.0] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.599 | L2-Norm(final)=9.131 | 1754.3 samples/s | 27.4 steps/s
[Step=31000 Epoch=295.5] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.588 | L2-Norm(final)=9.131 | 4646.4 samples/s | 72.6 steps/s
[Step=31050 Epoch=295.9] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.578 | L2-Norm(final)=9.132 | 1834.2 samples/s | 28.7 steps/s
[Step=31100 Epoch=296.4] | Loss=0.00002 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.567 | L2-Norm(final)=9.132 | 4488.8 samples/s | 70.1 steps/s
[Step=31150 Epoch=296.9] | Loss=0.00002 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.556 | L2-Norm(final)=9.132 | 1848.9 samples/s | 28.9 steps/s
[Step=31200 Epoch=297.4] | Loss=0.00002 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.545 | L2-Norm(final)=9.133 | 4442.8 samples/s | 69.4 steps/s
[Step=31250 Epoch=297.8] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.534 | L2-Norm(final)=9.133 | 1798.0 samples/s | 28.1 steps/s
[Step=31300 Epoch=298.3] | Loss=0.00001 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.523 | L2-Norm(final)=9.133 | 4409.7 samples/s | 68.9 steps/s
[Step=31350 Epoch=298.8] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.511 | L2-Norm(final)=9.133 | 1881.0 samples/s | 29.4 steps/s
[Step=31400 Epoch=299.3] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.499 | L2-Norm(final)=9.134 | 4328.5 samples/s | 67.6 steps/s
[Step=31450 Epoch=299.7] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=9.134 | 1870.7 samples/s | 29.2 steps/s
[Step=31500 Epoch=300.2] | Loss=0.00001 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.475 | L2-Norm(final)=9.134 | 4235.6 samples/s | 66.2 steps/s
[Step=31550 Epoch=300.7] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.463 | L2-Norm(final)=9.134 | 6246.9 samples/s | 97.6 steps/s
[Step=31600 Epoch=301.2] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.451 | L2-Norm(final)=9.135 | 1639.4 samples/s | 25.6 steps/s
[Step=31650 Epoch=301.7] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.438 | L2-Norm(final)=9.135 | 5811.9 samples/s | 90.8 steps/s
[Step=31700 Epoch=302.1] | Loss=0.00001 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.426 | L2-Norm(final)=9.135 | 1674.1 samples/s | 26.2 steps/s
[Step=31750 Epoch=302.6] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.413 | L2-Norm(final)=9.135 | 5665.5 samples/s | 88.5 steps/s
[Step=31800 Epoch=303.1] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.400 | L2-Norm(final)=9.136 | 1716.6 samples/s | 26.8 steps/s
[Step=31850 Epoch=303.6] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.387 | L2-Norm(final)=9.136 | 5162.7 samples/s | 80.7 steps/s
[Step=31900 Epoch=304.0] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.373 | L2-Norm(final)=9.136 | 1789.0 samples/s | 28.0 steps/s
[Step=31950 Epoch=304.5] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.360 | L2-Norm(final)=9.136 | 4809.9 samples/s | 75.2 steps/s
[Step=32000 Epoch=305.0] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.346 | L2-Norm(final)=9.136 | 1798.1 samples/s | 28.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08687 | acc=0.9628 | tpr=0.9749 | fpr=0.0634 | 4136.5 samples/s | 16.2 steps/s
Avg test loss: 0.08999, Avg test acc: 0.96158, Avg tpr: 0.97412, Avg fpr: 0.06602, total FA: 515

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09279 | acc=0.9619 | tpr=0.9793 | fpr=0.0761 | 4127.8 samples/s | 16.1 steps/s
Avg test loss: 0.09628, Avg test acc: 0.96117, Avg tpr: 0.97826, Avg fpr: 0.07640, total FA: 596

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.09768 | acc=0.9595 | tpr=0.9728 | fpr=0.0696 | 4116.7 samples/s | 16.1 steps/s
Avg test loss: 0.10295, Avg test acc: 0.95889, Avg tpr: 0.97162, Avg fpr: 0.06909, total FA: 539

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09518 | acc=0.9583 | tpr=0.9732 | fpr=0.0741 | 4028.7 samples/s | 15.7 steps/s
Avg test loss: 0.09862, Avg test acc: 0.95801, Avg tpr: 0.97296, Avg fpr: 0.07486, total FA: 584

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08957 | acc=0.9624 | tpr=0.9731 | fpr=0.0607 | 4094.5 samples/s | 16.0 steps/s
Avg test loss: 0.09604, Avg test acc: 0.95997, Avg tpr: 0.97068, Avg fpr: 0.06358, total FA: 496

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.25337 | acc=0.2791 | tpr=0.0034 | fpr=0.1222 | 4154.7 samples/s | 16.2 steps/s
Avg test loss: 5.27105, Avg test acc: 0.27747, Avg tpr: 0.00431, Avg fpr: 0.12178, total FA: 950

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.81997 | acc=0.3116 | tpr=0.0047 | fpr=0.0218 | 4142.4 samples/s | 16.2 steps/s
Avg test loss: 4.82498, Avg test acc: 0.30940, Avg tpr: 0.00560, Avg fpr: 0.02243, total FA: 175

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.17410 | acc=0.3029 | tpr=0.0033 | fpr=0.0466 | 4113.8 samples/s | 16.1 steps/s
Avg test loss: 5.18536, Avg test acc: 0.30079, Avg tpr: 0.00420, Avg fpr: 0.04692, total FA: 366

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.26513 | acc=0.2971 | tpr=0.0056 | fpr=0.0699 | 4150.8 samples/s | 16.2 steps/s
Avg test loss: 5.27561, Avg test acc: 0.29486, Avg tpr: 0.00647, Avg fpr: 0.07089, total FA: 553

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.09383 | acc=0.3129 | tpr=0.0014 | fpr=0.0107 | 4332.3 samples/s | 16.9 steps/s
Avg test loss: 5.10272, Avg test acc: 0.31080, Avg tpr: 0.00198, Avg fpr: 0.01000, total FA: 78

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.51359 | acc=0.1196 | tpr=0.8761 | fpr=0.8940 | 4145.1 samples/s | 16.2 steps/s
[Step= 100] | Loss=5.46182 | acc=0.1208 | tpr=0.8550 | fpr=0.8929 | 7842.1 samples/s | 30.6 steps/s
[Step= 150] | Loss=5.46512 | acc=0.1191 | tpr=0.8674 | fpr=0.8947 | 8310.3 samples/s | 32.5 steps/s
[Step= 200] | Loss=5.46381 | acc=0.1184 | tpr=0.8667 | fpr=0.8952 | 7844.5 samples/s | 30.6 steps/s
[Step= 250] | Loss=5.46715 | acc=0.1190 | tpr=0.8629 | fpr=0.8946 | 8178.0 samples/s | 31.9 steps/s
[Step= 300] | Loss=5.46444 | acc=0.1183 | tpr=0.8589 | fpr=0.8952 | 7888.2 samples/s | 30.8 steps/s
[Step= 350] | Loss=5.45993 | acc=0.1180 | tpr=0.8560 | fpr=0.8954 | 8107.9 samples/s | 31.7 steps/s
[Step= 400] | Loss=5.46103 | acc=0.1183 | tpr=0.8523 | fpr=0.8950 | 8193.6 samples/s | 32.0 steps/s
[Step= 450] | Loss=5.46488 | acc=0.1180 | tpr=0.8481 | fpr=0.8953 | 7911.6 samples/s | 30.9 steps/s
[Step= 500] | Loss=5.46796 | acc=0.1179 | tpr=0.8493 | fpr=0.8954 | 7945.4 samples/s | 31.0 steps/s
[Step= 550] | Loss=5.46719 | acc=0.1176 | tpr=0.8528 | fpr=0.8957 | 14351.2 samples/s | 56.1 steps/s
Avg test loss: 5.46900, Avg test acc: 0.11757, Avg tpr: 0.85261, Avg fpr: 0.89579, total FA: 124379

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.40888 | acc=0.1181 | tpr=0.8584 | fpr=0.8952 | 4143.4 samples/s | 16.2 steps/s
[Step= 100] | Loss=5.35005 | acc=0.1201 | tpr=0.8294 | fpr=0.8931 | 7681.1 samples/s | 30.0 steps/s
[Step= 150] | Loss=5.35676 | acc=0.1180 | tpr=0.8329 | fpr=0.8952 | 7964.2 samples/s | 31.1 steps/s
[Step= 200] | Loss=5.35648 | acc=0.1181 | tpr=0.8273 | fpr=0.8948 | 8228.2 samples/s | 32.1 steps/s
[Step= 250] | Loss=5.35640 | acc=0.1185 | tpr=0.8253 | fpr=0.8944 | 7818.5 samples/s | 30.5 steps/s
[Step= 300] | Loss=5.35386 | acc=0.1180 | tpr=0.8291 | fpr=0.8949 | 8064.8 samples/s | 31.5 steps/s
[Step= 350] | Loss=5.34966 | acc=0.1175 | tpr=0.8291 | fpr=0.8955 | 8589.2 samples/s | 33.6 steps/s
[Step= 400] | Loss=5.34933 | acc=0.1178 | tpr=0.8249 | fpr=0.8951 | 8048.4 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.35474 | acc=0.1177 | tpr=0.8247 | fpr=0.8951 | 7643.4 samples/s | 29.9 steps/s
[Step= 500] | Loss=5.36135 | acc=0.1173 | tpr=0.8242 | fpr=0.8955 | 7878.7 samples/s | 30.8 steps/s
[Step= 550] | Loss=5.36054 | acc=0.1171 | tpr=0.8245 | fpr=0.8957 | 14906.4 samples/s | 58.2 steps/s
Avg test loss: 5.36153, Avg test acc: 0.11709, Avg tpr: 0.82409, Avg fpr: 0.89576, total FA: 124375

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=6.17457 | acc=0.1120 | tpr=0.7699 | fpr=0.8999 | 4068.2 samples/s | 15.9 steps/s
[Step= 100] | Loss=6.11646 | acc=0.1143 | tpr=0.7484 | fpr=0.8975 | 8254.4 samples/s | 32.2 steps/s
[Step= 150] | Loss=6.12945 | acc=0.1121 | tpr=0.7608 | fpr=0.8998 | 7683.9 samples/s | 30.0 steps/s
[Step= 200] | Loss=6.13057 | acc=0.1116 | tpr=0.7574 | fpr=0.9001 | 8105.1 samples/s | 31.7 steps/s
[Step= 250] | Loss=6.13295 | acc=0.1120 | tpr=0.7616 | fpr=0.8999 | 7942.4 samples/s | 31.0 steps/s
[Step= 300] | Loss=6.12957 | acc=0.1118 | tpr=0.7629 | fpr=0.9001 | 8041.4 samples/s | 31.4 steps/s
[Step= 350] | Loss=6.12785 | acc=0.1115 | tpr=0.7564 | fpr=0.9002 | 7855.6 samples/s | 30.7 steps/s
[Step= 400] | Loss=6.12920 | acc=0.1120 | tpr=0.7560 | fpr=0.8997 | 7758.1 samples/s | 30.3 steps/s
[Step= 450] | Loss=6.13266 | acc=0.1114 | tpr=0.7537 | fpr=0.9003 | 8502.1 samples/s | 33.2 steps/s
[Step= 500] | Loss=6.13389 | acc=0.1112 | tpr=0.7529 | fpr=0.9004 | 7493.1 samples/s | 29.3 steps/s
[Step= 550] | Loss=6.13255 | acc=0.1111 | tpr=0.7573 | fpr=0.9006 | 14243.2 samples/s | 55.6 steps/s
Avg test loss: 6.13418, Avg test acc: 0.11106, Avg tpr: 0.75674, Avg fpr: 0.90068, total FA: 125057

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.29962 | acc=0.1258 | tpr=0.7566 | fpr=0.8856 | 4051.3 samples/s | 15.8 steps/s
[Step= 100] | Loss=5.24864 | acc=0.1264 | tpr=0.7164 | fpr=0.8846 | 7976.0 samples/s | 31.2 steps/s
[Step= 150] | Loss=5.24614 | acc=0.1245 | tpr=0.7277 | fpr=0.8866 | 7911.4 samples/s | 30.9 steps/s
[Step= 200] | Loss=5.23848 | acc=0.1240 | tpr=0.7279 | fpr=0.8870 | 8112.0 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.24030 | acc=0.1241 | tpr=0.7319 | fpr=0.8870 | 7916.6 samples/s | 30.9 steps/s
[Step= 300] | Loss=5.23941 | acc=0.1235 | tpr=0.7331 | fpr=0.8876 | 7859.4 samples/s | 30.7 steps/s
[Step= 350] | Loss=5.23402 | acc=0.1232 | tpr=0.7295 | fpr=0.8878 | 8126.6 samples/s | 31.7 steps/s
[Step= 400] | Loss=5.23725 | acc=0.1228 | tpr=0.7303 | fpr=0.8882 | 7790.7 samples/s | 30.4 steps/s
[Step= 450] | Loss=5.24329 | acc=0.1226 | tpr=0.7259 | fpr=0.8883 | 8331.7 samples/s | 32.5 steps/s
[Step= 500] | Loss=5.24807 | acc=0.1226 | tpr=0.7256 | fpr=0.8883 | 7824.2 samples/s | 30.6 steps/s
[Step= 550] | Loss=5.24775 | acc=0.1225 | tpr=0.7254 | fpr=0.8885 | 14433.3 samples/s | 56.4 steps/s
Avg test loss: 5.24922, Avg test acc: 0.12244, Avg tpr: 0.72504, Avg fpr: 0.88851, total FA: 123368

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.03344 | acc=0.1289 | tpr=0.7212 | fpr=0.8817 | 4157.2 samples/s | 16.2 steps/s
[Step= 100] | Loss=4.97749 | acc=0.1314 | tpr=0.6930 | fpr=0.8791 | 7775.3 samples/s | 30.4 steps/s
[Step= 150] | Loss=4.98077 | acc=0.1301 | tpr=0.6988 | fpr=0.8803 | 8075.5 samples/s | 31.5 steps/s
[Step= 200] | Loss=4.97795 | acc=0.1297 | tpr=0.6951 | fpr=0.8806 | 8120.3 samples/s | 31.7 steps/s
[Step= 250] | Loss=4.98409 | acc=0.1297 | tpr=0.6926 | fpr=0.8806 | 8087.6 samples/s | 31.6 steps/s
[Step= 300] | Loss=4.97915 | acc=0.1295 | tpr=0.6953 | fpr=0.8809 | 8271.3 samples/s | 32.3 steps/s
[Step= 350] | Loss=4.97369 | acc=0.1290 | tpr=0.6951 | fpr=0.8813 | 7892.5 samples/s | 30.8 steps/s
[Step= 400] | Loss=4.97577 | acc=0.1291 | tpr=0.6915 | fpr=0.8811 | 8017.9 samples/s | 31.3 steps/s
[Step= 450] | Loss=4.97713 | acc=0.1291 | tpr=0.6835 | fpr=0.8810 | 8097.0 samples/s | 31.6 steps/s
[Step= 500] | Loss=4.97954 | acc=0.1285 | tpr=0.6824 | fpr=0.8815 | 7702.0 samples/s | 30.1 steps/s
[Step= 550] | Loss=4.97856 | acc=0.1285 | tpr=0.6825 | fpr=0.8816 | 14388.1 samples/s | 56.2 steps/s
Avg test loss: 4.98030, Avg test acc: 0.12843, Avg tpr: 0.68225, Avg fpr: 0.88163, total FA: 122413

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10571 | acc=0.9804 | tpr=0.9159 | fpr=0.0185 | 4151.6 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.10999 | acc=0.9800 | tpr=0.9424 | fpr=0.0193 | 7880.1 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.11445 | acc=0.9790 | tpr=0.9452 | fpr=0.0204 | 8052.2 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.11630 | acc=0.9788 | tpr=0.9475 | fpr=0.0206 | 8068.3 samples/s | 31.5 steps/s
[Step= 250] | Loss=0.11564 | acc=0.9788 | tpr=0.9432 | fpr=0.0205 | 8253.5 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.11767 | acc=0.9786 | tpr=0.9411 | fpr=0.0207 | 7825.1 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.11756 | acc=0.9785 | tpr=0.9405 | fpr=0.0208 | 7899.1 samples/s | 30.9 steps/s
[Step= 400] | Loss=0.11891 | acc=0.9784 | tpr=0.9376 | fpr=0.0209 | 7820.3 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.12170 | acc=0.9781 | tpr=0.9377 | fpr=0.0211 | 7910.7 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.12141 | acc=0.9782 | tpr=0.9392 | fpr=0.0211 | 7873.6 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.12037 | acc=0.9784 | tpr=0.9387 | fpr=0.0209 | 13933.9 samples/s | 54.4 steps/s
Avg test loss: 0.12022, Avg test acc: 0.97842, Avg tpr: 0.93899, Avg fpr: 0.02086, total FA: 2897

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11604 | acc=0.9817 | tpr=0.9027 | fpr=0.0169 | 4185.8 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.12050 | acc=0.9813 | tpr=0.9083 | fpr=0.0173 | 7690.7 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.12589 | acc=0.9802 | tpr=0.9078 | fpr=0.0185 | 7980.2 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.12765 | acc=0.9804 | tpr=0.9148 | fpr=0.0184 | 8179.1 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.12610 | acc=0.9804 | tpr=0.9144 | fpr=0.0184 | 8230.1 samples/s | 32.1 steps/s
[Step= 300] | Loss=0.12830 | acc=0.9800 | tpr=0.9135 | fpr=0.0188 | 7947.0 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.12837 | acc=0.9799 | tpr=0.9173 | fpr=0.0190 | 8093.6 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.12966 | acc=0.9797 | tpr=0.9136 | fpr=0.0191 | 7717.3 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.13293 | acc=0.9793 | tpr=0.9119 | fpr=0.0195 | 8337.2 samples/s | 32.6 steps/s
[Step= 500] | Loss=0.13232 | acc=0.9794 | tpr=0.9154 | fpr=0.0194 | 7857.1 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.13131 | acc=0.9795 | tpr=0.9152 | fpr=0.0193 | 14908.1 samples/s | 58.2 steps/s
Avg test loss: 0.13107, Avg test acc: 0.97954, Avg tpr: 0.91442, Avg fpr: 0.01927, total FA: 2676

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10902 | acc=0.9793 | tpr=0.9381 | fpr=0.0200 | 4344.1 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.11300 | acc=0.9792 | tpr=0.9574 | fpr=0.0204 | 8665.2 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.11713 | acc=0.9783 | tpr=0.9539 | fpr=0.0212 | 8534.1 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.11942 | acc=0.9783 | tpr=0.9563 | fpr=0.0213 | 8158.3 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.11881 | acc=0.9782 | tpr=0.9537 | fpr=0.0214 | 7995.9 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.12118 | acc=0.9777 | tpr=0.9549 | fpr=0.0218 | 7911.2 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.12116 | acc=0.9776 | tpr=0.9549 | fpr=0.0220 | 8091.4 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.12257 | acc=0.9774 | tpr=0.9524 | fpr=0.0221 | 8094.1 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.12544 | acc=0.9771 | tpr=0.9513 | fpr=0.0224 | 7796.8 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.12500 | acc=0.9772 | tpr=0.9533 | fpr=0.0224 | 8522.7 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.12392 | acc=0.9774 | tpr=0.9522 | fpr=0.0222 | 13270.8 samples/s | 51.8 steps/s
Avg test loss: 0.12376, Avg test acc: 0.97741, Avg tpr: 0.95246, Avg fpr: 0.02214, total FA: 3074

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11740 | acc=0.9807 | tpr=0.9159 | fpr=0.0181 | 4112.2 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.12215 | acc=0.9799 | tpr=0.9339 | fpr=0.0192 | 8069.7 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.12692 | acc=0.9791 | tpr=0.9366 | fpr=0.0201 | 7938.3 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.12901 | acc=0.9789 | tpr=0.9443 | fpr=0.0204 | 7730.4 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.12781 | acc=0.9788 | tpr=0.9397 | fpr=0.0205 | 8408.0 samples/s | 32.8 steps/s
[Step= 300] | Loss=0.12979 | acc=0.9786 | tpr=0.9396 | fpr=0.0207 | 7538.1 samples/s | 29.4 steps/s
[Step= 350] | Loss=0.12974 | acc=0.9785 | tpr=0.9430 | fpr=0.0208 | 8106.2 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.13081 | acc=0.9784 | tpr=0.9398 | fpr=0.0209 | 8174.5 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.13394 | acc=0.9780 | tpr=0.9387 | fpr=0.0212 | 7717.9 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.13352 | acc=0.9781 | tpr=0.9410 | fpr=0.0212 | 8113.8 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.13254 | acc=0.9783 | tpr=0.9411 | fpr=0.0210 | 13703.3 samples/s | 53.5 steps/s
Avg test loss: 0.13238, Avg test acc: 0.97830, Avg tpr: 0.94097, Avg fpr: 0.02102, total FA: 2919

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.13008 | acc=0.9796 | tpr=0.9248 | fpr=0.0194 | 4114.5 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.13543 | acc=0.9791 | tpr=0.9488 | fpr=0.0203 | 8021.2 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.14098 | acc=0.9782 | tpr=0.9496 | fpr=0.0213 | 7924.3 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.14335 | acc=0.9781 | tpr=0.9530 | fpr=0.0215 | 8047.4 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.14184 | acc=0.9782 | tpr=0.9485 | fpr=0.0213 | 7778.7 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.14458 | acc=0.9778 | tpr=0.9476 | fpr=0.0217 | 7887.2 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.14525 | acc=0.9775 | tpr=0.9487 | fpr=0.0219 | 8422.2 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.14661 | acc=0.9773 | tpr=0.9437 | fpr=0.0221 | 8008.1 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.15001 | acc=0.9770 | tpr=0.9430 | fpr=0.0224 | 8119.2 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.14946 | acc=0.9770 | tpr=0.9432 | fpr=0.0224 | 7954.2 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.14862 | acc=0.9772 | tpr=0.9415 | fpr=0.0222 | 13444.7 samples/s | 52.5 steps/s
Avg test loss: 0.14836, Avg test acc: 0.97718, Avg tpr: 0.94097, Avg fpr: 0.02216, total FA: 3077

server round 31/50

clients selected: [2 4 6 8 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=28001 Epoch=136.4] | Loss=0.00386 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.434 | L2-Norm(final)=11.724 | 3817.6 samples/s | 59.6 steps/s
[Step=28050 Epoch=136.7] | Loss=0.02618 | Reg=0.00109 | acc=0.9688 | L2-Norm=10.444 | L2-Norm(final)=11.715 | 4568.1 samples/s | 71.4 steps/s
[Step=28100 Epoch=136.9] | Loss=0.02561 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.456 | L2-Norm(final)=11.714 | 5156.5 samples/s | 80.6 steps/s
[Step=28150 Epoch=137.2] | Loss=0.02311 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.467 | L2-Norm(final)=11.715 | 5161.5 samples/s | 80.6 steps/s
[Step=28200 Epoch=137.4] | Loss=0.02155 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.476 | L2-Norm(final)=11.719 | 7088.6 samples/s | 110.8 steps/s
[Step=28250 Epoch=137.6] | Loss=0.01995 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.486 | L2-Norm(final)=11.723 | 1805.8 samples/s | 28.2 steps/s
[Step=28300 Epoch=137.9] | Loss=0.01970 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.494 | L2-Norm(final)=11.728 | 5403.1 samples/s | 84.4 steps/s
[Step=28350 Epoch=138.1] | Loss=0.01871 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.503 | L2-Norm(final)=11.734 | 5161.2 samples/s | 80.6 steps/s
[Step=28400 Epoch=138.4] | Loss=0.01806 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.511 | L2-Norm(final)=11.740 | 6681.6 samples/s | 104.4 steps/s
[Step=28450 Epoch=138.6] | Loss=0.01737 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.519 | L2-Norm(final)=11.747 | 1871.3 samples/s | 29.2 steps/s
[Step=28500 Epoch=138.9] | Loss=0.01684 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.526 | L2-Norm(final)=11.753 | 5045.4 samples/s | 78.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=28501 Epoch=138.9] | Loss=0.00413 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.603 | L2-Norm(final)=11.822 | 3679.6 samples/s | 57.5 steps/s
[Step=28550 Epoch=139.1] | Loss=0.01236 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.612 | L2-Norm(final)=11.829 | 4299.4 samples/s | 67.2 steps/s
[Step=28600 Epoch=139.4] | Loss=0.01331 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.624 | L2-Norm(final)=11.836 | 4571.4 samples/s | 71.4 steps/s
[Step=28650 Epoch=139.6] | Loss=0.01301 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.635 | L2-Norm(final)=11.843 | 4484.0 samples/s | 70.1 steps/s
[Step=28700 Epoch=139.8] | Loss=0.01289 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.646 | L2-Norm(final)=11.850 | 6051.7 samples/s | 94.6 steps/s
[Step=28750 Epoch=140.1] | Loss=0.01174 | Reg=0.00114 | acc=0.9844 | L2-Norm=10.655 | L2-Norm(final)=11.856 | 1720.6 samples/s | 26.9 steps/s
[Step=28800 Epoch=140.3] | Loss=0.01051 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.663 | L2-Norm(final)=11.862 | 4647.3 samples/s | 72.6 steps/s
[Step=28850 Epoch=140.6] | Loss=0.00980 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.670 | L2-Norm(final)=11.868 | 4643.7 samples/s | 72.6 steps/s
[Step=28900 Epoch=140.8] | Loss=0.00947 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.677 | L2-Norm(final)=11.874 | 5767.4 samples/s | 90.1 steps/s
[Step=28950 Epoch=141.1] | Loss=0.00893 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.684 | L2-Norm(final)=11.879 | 1779.4 samples/s | 27.8 steps/s
[Step=29000 Epoch=141.3] | Loss=0.00846 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.690 | L2-Norm(final)=11.884 | 4536.7 samples/s | 70.9 steps/s
[Step=29050 Epoch=141.5] | Loss=0.00812 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.695 | L2-Norm(final)=11.889 | 4531.2 samples/s | 70.8 steps/s
[Step=29100 Epoch=141.8] | Loss=0.00794 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.701 | L2-Norm(final)=11.894 | 5401.4 samples/s | 84.4 steps/s
[Step=29150 Epoch=142.0] | Loss=0.00770 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.706 | L2-Norm(final)=11.899 | 1838.8 samples/s | 28.7 steps/s
[Step=29200 Epoch=142.3] | Loss=0.00755 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.711 | L2-Norm(final)=11.903 | 4652.8 samples/s | 72.7 steps/s
[Step=29250 Epoch=142.5] | Loss=0.00734 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.715 | L2-Norm(final)=11.907 | 4557.6 samples/s | 71.2 steps/s
[Step=29300 Epoch=142.8] | Loss=0.00713 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.720 | L2-Norm(final)=11.911 | 4945.7 samples/s | 77.3 steps/s
[Step=29350 Epoch=143.0] | Loss=0.00703 | Reg=0.00115 | acc=0.9688 | L2-Norm=10.724 | L2-Norm(final)=11.915 | 1847.3 samples/s | 28.9 steps/s
[Step=29400 Epoch=143.3] | Loss=0.00681 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.728 | L2-Norm(final)=11.918 | 4559.5 samples/s | 71.2 steps/s
[Step=29450 Epoch=143.5] | Loss=0.00674 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.732 | L2-Norm(final)=11.922 | 4556.2 samples/s | 71.2 steps/s
[Step=29500 Epoch=143.7] | Loss=0.00657 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.736 | L2-Norm(final)=11.926 | 4644.7 samples/s | 72.6 steps/s
[Step=29550 Epoch=144.0] | Loss=0.00644 | Reg=0.00115 | acc=0.9844 | L2-Norm=10.740 | L2-Norm(final)=11.929 | 1872.8 samples/s | 29.3 steps/s
[Step=29600 Epoch=144.2] | Loss=0.00633 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.744 | L2-Norm(final)=11.933 | 4713.3 samples/s | 73.6 steps/s
[Step=29650 Epoch=144.5] | Loss=0.00617 | Reg=0.00116 | acc=0.9844 | L2-Norm=10.748 | L2-Norm(final)=11.936 | 4652.6 samples/s | 72.7 steps/s
[Step=29700 Epoch=144.7] | Loss=0.00604 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.751 | L2-Norm(final)=11.940 | 4518.7 samples/s | 70.6 steps/s
[Step=29750 Epoch=145.0] | Loss=0.00597 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.755 | L2-Norm(final)=11.943 | 1902.1 samples/s | 29.7 steps/s
[Step=29800 Epoch=145.2] | Loss=0.00582 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.759 | L2-Norm(final)=11.946 | 4523.2 samples/s | 70.7 steps/s
[Step=29850 Epoch=145.4] | Loss=0.00572 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.762 | L2-Norm(final)=11.949 | 4549.0 samples/s | 71.1 steps/s
[Step=29900 Epoch=145.7] | Loss=0.00566 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.765 | L2-Norm(final)=11.952 | 4437.8 samples/s | 69.3 steps/s
[Step=29950 Epoch=145.9] | Loss=0.00559 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.768 | L2-Norm(final)=11.955 | 1963.9 samples/s | 30.7 steps/s
[Step=30000 Epoch=146.2] | Loss=0.00547 | Reg=0.00116 | acc=1.0000 | L2-Norm=10.772 | L2-Norm(final)=11.958 | 4672.0 samples/s | 73.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step30000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=36001 Epoch=176.5] | Loss=0.02653 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.434 | L2-Norm(final)=12.164 | 3813.1 samples/s | 59.6 steps/s
[Step=36050 Epoch=176.8] | Loss=0.01633 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.444 | L2-Norm(final)=12.162 | 4694.7 samples/s | 73.4 steps/s
[Step=36100 Epoch=177.0] | Loss=0.01528 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.455 | L2-Norm(final)=12.161 | 5190.7 samples/s | 81.1 steps/s
[Step=36150 Epoch=177.3] | Loss=0.01613 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.464 | L2-Norm(final)=12.162 | 5211.2 samples/s | 81.4 steps/s
[Step=36200 Epoch=177.5] | Loss=0.01664 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.472 | L2-Norm(final)=12.164 | 7527.6 samples/s | 117.6 steps/s
[Step=36250 Epoch=177.8] | Loss=0.01575 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.480 | L2-Norm(final)=12.167 | 1805.2 samples/s | 28.2 steps/s
[Step=36300 Epoch=178.0] | Loss=0.01539 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.488 | L2-Norm(final)=12.171 | 5068.9 samples/s | 79.2 steps/s
[Step=36350 Epoch=178.3] | Loss=0.01436 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.495 | L2-Norm(final)=12.176 | 5248.5 samples/s | 82.0 steps/s
[Step=36400 Epoch=178.5] | Loss=0.01398 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.502 | L2-Norm(final)=12.181 | 6824.8 samples/s | 106.6 steps/s
[Step=36450 Epoch=178.7] | Loss=0.01352 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.509 | L2-Norm(final)=12.186 | 1849.0 samples/s | 28.9 steps/s
[Step=36500 Epoch=179.0] | Loss=0.01315 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.516 | L2-Norm(final)=12.192 | 5384.9 samples/s | 84.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=179.0] | Loss=0.00608 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.583 | L2-Norm(final)=12.250 | 3666.2 samples/s | 57.3 steps/s
[Step=36550 Epoch=179.2] | Loss=0.00890 | Reg=0.00112 | acc=1.0000 | L2-Norm=10.593 | L2-Norm(final)=12.257 | 4336.3 samples/s | 67.8 steps/s
[Step=36600 Epoch=179.5] | Loss=0.01086 | Reg=0.00112 | acc=0.9844 | L2-Norm=10.603 | L2-Norm(final)=12.264 | 4537.0 samples/s | 70.9 steps/s
[Step=36650 Epoch=179.7] | Loss=0.01115 | Reg=0.00113 | acc=0.9688 | L2-Norm=10.612 | L2-Norm(final)=12.269 | 4488.1 samples/s | 70.1 steps/s
[Step=36700 Epoch=180.0] | Loss=0.01027 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.620 | L2-Norm(final)=12.274 | 6320.5 samples/s | 98.8 steps/s
[Step=36750 Epoch=180.2] | Loss=0.00881 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.628 | L2-Norm(final)=12.280 | 1713.1 samples/s | 26.8 steps/s
[Step=36800 Epoch=180.5] | Loss=0.00843 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.634 | L2-Norm(final)=12.285 | 4654.5 samples/s | 72.7 steps/s
[Step=36850 Epoch=180.7] | Loss=0.00814 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.640 | L2-Norm(final)=12.289 | 4639.7 samples/s | 72.5 steps/s
[Step=36900 Epoch=181.0] | Loss=0.00785 | Reg=0.00113 | acc=0.9844 | L2-Norm=10.645 | L2-Norm(final)=12.294 | 5918.0 samples/s | 92.5 steps/s
[Step=36950 Epoch=181.2] | Loss=0.00742 | Reg=0.00113 | acc=1.0000 | L2-Norm=10.649 | L2-Norm(final)=12.297 | 1743.0 samples/s | 27.2 steps/s
[Step=37000 Epoch=181.4] | Loss=0.00697 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.654 | L2-Norm(final)=12.301 | 4591.6 samples/s | 71.7 steps/s
[Step=37050 Epoch=181.7] | Loss=0.00668 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.658 | L2-Norm(final)=12.305 | 4522.0 samples/s | 70.7 steps/s
[Step=37100 Epoch=181.9] | Loss=0.00658 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.662 | L2-Norm(final)=12.308 | 5542.0 samples/s | 86.6 steps/s
[Step=37150 Epoch=182.2] | Loss=0.00634 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.665 | L2-Norm(final)=12.312 | 1801.1 samples/s | 28.1 steps/s
[Step=37200 Epoch=182.4] | Loss=0.00608 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.669 | L2-Norm(final)=12.315 | 4624.1 samples/s | 72.3 steps/s
[Step=37250 Epoch=182.7] | Loss=0.00585 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.673 | L2-Norm(final)=12.319 | 4574.5 samples/s | 71.5 steps/s
[Step=37300 Epoch=182.9] | Loss=0.00580 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.676 | L2-Norm(final)=12.322 | 5384.2 samples/s | 84.1 steps/s
[Step=37350 Epoch=183.2] | Loss=0.00565 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.679 | L2-Norm(final)=12.325 | 1790.7 samples/s | 28.0 steps/s
[Step=37400 Epoch=183.4] | Loss=0.00548 | Reg=0.00114 | acc=0.9844 | L2-Norm=10.683 | L2-Norm(final)=12.328 | 4649.2 samples/s | 72.6 steps/s
[Step=37450 Epoch=183.6] | Loss=0.00534 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.686 | L2-Norm(final)=12.331 | 4532.0 samples/s | 70.8 steps/s
[Step=37500 Epoch=183.9] | Loss=0.00531 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.689 | L2-Norm(final)=12.334 | 5081.5 samples/s | 79.4 steps/s
[Step=37550 Epoch=184.1] | Loss=0.00518 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.692 | L2-Norm(final)=12.337 | 1820.4 samples/s | 28.4 steps/s
[Step=37600 Epoch=184.4] | Loss=0.00503 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.694 | L2-Norm(final)=12.339 | 4655.3 samples/s | 72.7 steps/s
[Step=37650 Epoch=184.6] | Loss=0.00502 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.697 | L2-Norm(final)=12.342 | 4554.2 samples/s | 71.2 steps/s
[Step=37700 Epoch=184.9] | Loss=0.00495 | Reg=0.00114 | acc=1.0000 | L2-Norm=10.700 | L2-Norm(final)=12.345 | 4924.2 samples/s | 76.9 steps/s
[Step=37750 Epoch=185.1] | Loss=0.00485 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.702 | L2-Norm(final)=12.347 | 1842.7 samples/s | 28.8 steps/s
[Step=37800 Epoch=185.4] | Loss=0.00475 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.705 | L2-Norm(final)=12.350 | 4567.7 samples/s | 71.4 steps/s
[Step=37850 Epoch=185.6] | Loss=0.00465 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.707 | L2-Norm(final)=12.352 | 4590.9 samples/s | 71.7 steps/s
[Step=37900 Epoch=185.9] | Loss=0.00465 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.710 | L2-Norm(final)=12.355 | 4723.7 samples/s | 73.8 steps/s
[Step=37950 Epoch=186.1] | Loss=0.00455 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.712 | L2-Norm(final)=12.357 | 1873.7 samples/s | 29.3 steps/s
[Step=38000 Epoch=186.3] | Loss=0.00447 | Reg=0.00115 | acc=1.0000 | L2-Norm=10.714 | L2-Norm(final)=12.359 | 4695.0 samples/s | 73.4 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step38000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=32001 Epoch=304.4] | Loss=0.00135 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.434 | L2-Norm(final)=8.866 | 3630.4 samples/s | 56.7 steps/s
[Step=32050 Epoch=304.9] | Loss=0.00226 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.450 | L2-Norm(final)=8.874 | 4584.9 samples/s | 71.6 steps/s
[Step=32100 Epoch=305.4] | Loss=0.00144 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.466 | L2-Norm(final)=8.885 | 7211.7 samples/s | 112.7 steps/s
[Step=32150 Epoch=305.8] | Loss=0.00104 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.475 | L2-Norm(final)=8.894 | 1749.5 samples/s | 27.3 steps/s
[Step=32200 Epoch=306.3] | Loss=0.00082 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.480 | L2-Norm(final)=8.901 | 6423.5 samples/s | 100.4 steps/s
[Step=32250 Epoch=306.8] | Loss=0.00069 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.483 | L2-Norm(final)=8.907 | 1777.5 samples/s | 27.8 steps/s
[Step=32300 Epoch=307.3] | Loss=0.00060 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.485 | L2-Norm(final)=8.912 | 6060.9 samples/s | 94.7 steps/s
[Step=32350 Epoch=307.7] | Loss=0.00053 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.486 | L2-Norm(final)=8.917 | 1870.0 samples/s | 29.2 steps/s
[Step=32400 Epoch=308.2] | Loss=0.00048 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=8.922 | 5267.4 samples/s | 82.3 steps/s
[Step=32450 Epoch=308.7] | Loss=0.00044 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.488 | L2-Norm(final)=8.927 | 1909.5 samples/s | 29.8 steps/s
[Step=32500 Epoch=309.2] | Loss=0.00040 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.488 | L2-Norm(final)=8.931 | 4959.9 samples/s | 77.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=309.2] | Loss=0.00004 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.487 | L2-Norm(final)=8.974 | 3460.6 samples/s | 54.1 steps/s
[Step=32550 Epoch=309.6] | Loss=0.00009 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.484 | L2-Norm(final)=8.978 | 4246.0 samples/s | 66.3 steps/s
[Step=32600 Epoch=310.1] | Loss=0.00006 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.480 | L2-Norm(final)=8.980 | 5955.0 samples/s | 93.0 steps/s
[Step=32650 Epoch=310.6] | Loss=0.00005 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=8.982 | 1695.3 samples/s | 26.5 steps/s
[Step=32700 Epoch=311.1] | Loss=0.00004 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.462 | L2-Norm(final)=8.983 | 5376.3 samples/s | 84.0 steps/s
[Step=32750 Epoch=311.5] | Loss=0.00003 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.451 | L2-Norm(final)=8.984 | 1689.7 samples/s | 26.4 steps/s
[Step=32800 Epoch=312.0] | Loss=0.00002 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.439 | L2-Norm(final)=8.984 | 5030.4 samples/s | 78.6 steps/s
[Step=32850 Epoch=312.5] | Loss=0.00002 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.426 | L2-Norm(final)=8.985 | 1756.2 samples/s | 27.4 steps/s
[Step=32900 Epoch=313.0] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.414 | L2-Norm(final)=8.985 | 4788.9 samples/s | 74.8 steps/s
[Step=32950 Epoch=313.4] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.401 | L2-Norm(final)=8.986 | 1809.7 samples/s | 28.3 steps/s
[Step=33000 Epoch=313.9] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.387 | L2-Norm(final)=8.986 | 4654.6 samples/s | 72.7 steps/s
[Step=33050 Epoch=314.4] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.373 | L2-Norm(final)=8.986 | 1865.8 samples/s | 29.2 steps/s
[Step=33100 Epoch=314.9] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.360 | L2-Norm(final)=8.987 | 4432.8 samples/s | 69.3 steps/s
[Step=33150 Epoch=315.3] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.345 | L2-Norm(final)=8.987 | 1877.0 samples/s | 29.3 steps/s
[Step=33200 Epoch=315.8] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.331 | L2-Norm(final)=8.987 | 4468.5 samples/s | 69.8 steps/s
[Step=33250 Epoch=316.3] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.317 | L2-Norm(final)=8.987 | 1855.9 samples/s | 29.0 steps/s
[Step=33300 Epoch=316.8] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.302 | L2-Norm(final)=8.987 | 4411.0 samples/s | 68.9 steps/s
[Step=33350 Epoch=317.2] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=8.988 | 1929.0 samples/s | 30.1 steps/s
[Step=33400 Epoch=317.7] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.272 | L2-Norm(final)=8.988 | 4180.1 samples/s | 65.3 steps/s
[Step=33450 Epoch=318.2] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.256 | L2-Norm(final)=8.988 | 5968.9 samples/s | 93.3 steps/s
[Step=33500 Epoch=318.7] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.241 | L2-Norm(final)=8.988 | 1666.6 samples/s | 26.0 steps/s
[Step=33550 Epoch=319.1] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.225 | L2-Norm(final)=8.988 | 5656.4 samples/s | 88.4 steps/s
[Step=33600 Epoch=319.6] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.209 | L2-Norm(final)=8.989 | 1731.6 samples/s | 27.1 steps/s
[Step=33650 Epoch=320.1] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.193 | L2-Norm(final)=8.989 | 5221.4 samples/s | 81.6 steps/s
[Step=33700 Epoch=320.6] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.177 | L2-Norm(final)=8.989 | 1743.3 samples/s | 27.2 steps/s
[Step=33750 Epoch=321.0] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.161 | L2-Norm(final)=8.989 | 4873.7 samples/s | 76.2 steps/s
[Step=33800 Epoch=321.5] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.144 | L2-Norm(final)=8.989 | 1799.7 samples/s | 28.1 steps/s
[Step=33850 Epoch=322.0] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.127 | L2-Norm(final)=8.989 | 4491.7 samples/s | 70.2 steps/s
[Step=33900 Epoch=322.5] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.110 | L2-Norm(final)=8.990 | 1833.9 samples/s | 28.7 steps/s
[Step=33950 Epoch=322.9] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.093 | L2-Norm(final)=8.990 | 4551.5 samples/s | 71.1 steps/s
[Step=34000 Epoch=323.4] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.075 | L2-Norm(final)=8.990 | 1872.9 samples/s | 29.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step34000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=30001 Epoch=282.7] | Loss=0.00003 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.434 | L2-Norm(final)=8.567 | 3542.7 samples/s | 55.4 steps/s
[Step=30050 Epoch=283.2] | Loss=0.00196 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.445 | L2-Norm(final)=8.572 | 4743.7 samples/s | 74.1 steps/s
[Step=30100 Epoch=283.6] | Loss=0.00133 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.456 | L2-Norm(final)=8.578 | 6655.2 samples/s | 104.0 steps/s
[Step=30150 Epoch=284.1] | Loss=0.00096 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.464 | L2-Norm(final)=8.585 | 1737.5 samples/s | 27.1 steps/s
[Step=30200 Epoch=284.6] | Loss=0.00076 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.467 | L2-Norm(final)=8.591 | 6183.4 samples/s | 96.6 steps/s
[Step=30250 Epoch=285.0] | Loss=0.00064 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.469 | L2-Norm(final)=8.597 | 1827.3 samples/s | 28.6 steps/s
[Step=30300 Epoch=285.5] | Loss=0.00056 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=8.603 | 5543.1 samples/s | 86.6 steps/s
[Step=30350 Epoch=286.0] | Loss=0.00049 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.471 | L2-Norm(final)=8.608 | 1841.5 samples/s | 28.8 steps/s
[Step=30400 Epoch=286.5] | Loss=0.00044 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.471 | L2-Norm(final)=8.613 | 5003.5 samples/s | 78.2 steps/s
[Step=30450 Epoch=286.9] | Loss=0.00040 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.470 | L2-Norm(final)=8.617 | 1902.1 samples/s | 29.7 steps/s
[Step=30500 Epoch=287.4] | Loss=0.00037 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.469 | L2-Norm(final)=8.621 | 4848.6 samples/s | 75.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=287.4] | Loss=0.00013 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.459 | L2-Norm(final)=8.664 | 3820.0 samples/s | 59.7 steps/s
[Step=30550 Epoch=287.9] | Loss=0.00008 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.457 | L2-Norm(final)=8.668 | 3982.6 samples/s | 62.2 steps/s
[Step=30600 Epoch=288.3] | Loss=0.00005 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.450 | L2-Norm(final)=8.670 | 5974.3 samples/s | 93.3 steps/s
[Step=30650 Epoch=288.8] | Loss=0.00004 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.442 | L2-Norm(final)=8.671 | 1694.3 samples/s | 26.5 steps/s
[Step=30700 Epoch=289.3] | Loss=0.00003 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.433 | L2-Norm(final)=8.672 | 5206.4 samples/s | 81.3 steps/s
[Step=30750 Epoch=289.8] | Loss=0.00002 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.423 | L2-Norm(final)=8.673 | 1738.6 samples/s | 27.2 steps/s
[Step=30800 Epoch=290.2] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.413 | L2-Norm(final)=8.673 | 4950.4 samples/s | 77.4 steps/s
[Step=30850 Epoch=290.7] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.403 | L2-Norm(final)=8.674 | 1785.7 samples/s | 27.9 steps/s
[Step=30900 Epoch=291.2] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.392 | L2-Norm(final)=8.674 | 4444.8 samples/s | 69.5 steps/s
[Step=30950 Epoch=291.6] | Loss=0.00002 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.381 | L2-Norm(final)=8.675 | 1828.3 samples/s | 28.6 steps/s
[Step=31000 Epoch=292.1] | Loss=0.00001 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.370 | L2-Norm(final)=8.675 | 4457.3 samples/s | 69.6 steps/s
[Step=31050 Epoch=292.6] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=8.676 | 1862.0 samples/s | 29.1 steps/s
[Step=31100 Epoch=293.1] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.348 | L2-Norm(final)=8.676 | 4451.5 samples/s | 69.6 steps/s
[Step=31150 Epoch=293.5] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.337 | L2-Norm(final)=8.676 | 1899.6 samples/s | 29.7 steps/s
[Step=31200 Epoch=294.0] | Loss=0.00001 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.325 | L2-Norm(final)=8.677 | 4317.4 samples/s | 67.5 steps/s
[Step=31250 Epoch=294.5] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.314 | L2-Norm(final)=8.677 | 1919.2 samples/s | 30.0 steps/s
[Step=31300 Epoch=294.9] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.302 | L2-Norm(final)=8.677 | 4108.2 samples/s | 64.2 steps/s
[Step=31350 Epoch=295.4] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=8.678 | 5869.5 samples/s | 91.7 steps/s
[Step=31400 Epoch=295.9] | Loss=0.00001 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.278 | L2-Norm(final)=8.678 | 1681.1 samples/s | 26.3 steps/s
[Step=31450 Epoch=296.3] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.266 | L2-Norm(final)=8.678 | 5436.2 samples/s | 84.9 steps/s
[Step=31500 Epoch=296.8] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.254 | L2-Norm(final)=8.679 | 1739.1 samples/s | 27.2 steps/s
[Step=31550 Epoch=297.3] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.241 | L2-Norm(final)=8.679 | 5168.1 samples/s | 80.8 steps/s
[Step=31600 Epoch=297.8] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=8.679 | 1808.4 samples/s | 28.3 steps/s
[Step=31650 Epoch=298.2] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.216 | L2-Norm(final)=8.679 | 4569.6 samples/s | 71.4 steps/s
[Step=31700 Epoch=298.7] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.203 | L2-Norm(final)=8.680 | 1832.7 samples/s | 28.6 steps/s
[Step=31750 Epoch=299.2] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.190 | L2-Norm(final)=8.680 | 4426.6 samples/s | 69.2 steps/s
[Step=31800 Epoch=299.6] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.177 | L2-Norm(final)=8.680 | 1844.9 samples/s | 28.8 steps/s
[Step=31850 Epoch=300.1] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.163 | L2-Norm(final)=8.681 | 4424.1 samples/s | 69.1 steps/s
[Step=31900 Epoch=300.6] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.150 | L2-Norm(final)=8.681 | 1867.9 samples/s | 29.2 steps/s
[Step=31950 Epoch=301.1] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.136 | L2-Norm(final)=8.681 | 4446.4 samples/s | 69.5 steps/s
[Step=32000 Epoch=301.5] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.123 | L2-Norm(final)=8.681 | 1761.7 samples/s | 27.5 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step32000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=32001 Epoch=305.0] | Loss=0.00212 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.434 | L2-Norm(final)=9.143 | 3609.8 samples/s | 56.4 steps/s
[Step=32050 Epoch=305.5] | Loss=0.00338 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.457 | L2-Norm(final)=9.147 | 4577.6 samples/s | 71.5 steps/s
[Step=32100 Epoch=305.9] | Loss=0.00249 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.476 | L2-Norm(final)=9.154 | 6914.9 samples/s | 108.0 steps/s
[Step=32150 Epoch=306.4] | Loss=0.00180 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.486 | L2-Norm(final)=9.160 | 1723.9 samples/s | 26.9 steps/s
[Step=32200 Epoch=306.9] | Loss=0.00141 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.492 | L2-Norm(final)=9.165 | 6582.2 samples/s | 102.8 steps/s
[Step=32250 Epoch=307.4] | Loss=0.00117 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.496 | L2-Norm(final)=9.170 | 1803.4 samples/s | 28.2 steps/s
[Step=32300 Epoch=307.8] | Loss=0.00100 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.499 | L2-Norm(final)=9.174 | 5852.3 samples/s | 91.4 steps/s
[Step=32350 Epoch=308.3] | Loss=0.00088 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.501 | L2-Norm(final)=9.178 | 1793.9 samples/s | 28.0 steps/s
[Step=32400 Epoch=308.8] | Loss=0.00079 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.502 | L2-Norm(final)=9.182 | 5665.7 samples/s | 88.5 steps/s
[Step=32450 Epoch=309.3] | Loss=0.00072 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.503 | L2-Norm(final)=9.186 | 1803.5 samples/s | 28.2 steps/s
[Step=32500 Epoch=309.8] | Loss=0.00066 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.503 | L2-Norm(final)=9.189 | 5266.4 samples/s | 82.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=309.8] | Loss=0.00020 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.508 | L2-Norm(final)=9.224 | 3822.9 samples/s | 59.7 steps/s
[Step=32550 Epoch=310.2] | Loss=0.00018 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.504 | L2-Norm(final)=9.226 | 3933.7 samples/s | 61.5 steps/s
[Step=32600 Epoch=310.7] | Loss=0.00029 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.508 | L2-Norm(final)=9.229 | 5982.3 samples/s | 93.5 steps/s
[Step=32650 Epoch=311.2] | Loss=0.00020 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.512 | L2-Norm(final)=9.232 | 1679.8 samples/s | 26.2 steps/s
[Step=32700 Epoch=311.7] | Loss=0.00015 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.511 | L2-Norm(final)=9.233 | 5500.4 samples/s | 85.9 steps/s
[Step=32750 Epoch=312.1] | Loss=0.00012 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.509 | L2-Norm(final)=9.234 | 1695.8 samples/s | 26.5 steps/s
[Step=32800 Epoch=312.6] | Loss=0.00011 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.505 | L2-Norm(final)=9.235 | 5196.5 samples/s | 81.2 steps/s
[Step=32850 Epoch=313.1] | Loss=0.00009 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.501 | L2-Norm(final)=9.236 | 1748.3 samples/s | 27.3 steps/s
[Step=32900 Epoch=313.6] | Loss=0.00008 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.496 | L2-Norm(final)=9.236 | 4988.4 samples/s | 77.9 steps/s
[Step=32950 Epoch=314.0] | Loss=0.00007 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.491 | L2-Norm(final)=9.237 | 1814.4 samples/s | 28.4 steps/s
[Step=33000 Epoch=314.5] | Loss=0.00006 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.486 | L2-Norm(final)=9.237 | 4631.1 samples/s | 72.4 steps/s
[Step=33050 Epoch=315.0] | Loss=0.00006 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.480 | L2-Norm(final)=9.237 | 1806.9 samples/s | 28.2 steps/s
[Step=33100 Epoch=315.5] | Loss=0.00005 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.474 | L2-Norm(final)=9.238 | 4433.9 samples/s | 69.3 steps/s
[Step=33150 Epoch=315.9] | Loss=0.00005 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.468 | L2-Norm(final)=9.238 | 1858.3 samples/s | 29.0 steps/s
[Step=33200 Epoch=316.4] | Loss=0.00005 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.462 | L2-Norm(final)=9.238 | 4393.3 samples/s | 68.6 steps/s
[Step=33250 Epoch=316.9] | Loss=0.00004 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.456 | L2-Norm(final)=9.239 | 1900.1 samples/s | 29.7 steps/s
[Step=33300 Epoch=317.4] | Loss=0.00004 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.450 | L2-Norm(final)=9.239 | 4470.1 samples/s | 69.8 steps/s
[Step=33350 Epoch=317.9] | Loss=0.00004 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.443 | L2-Norm(final)=9.239 | 1858.0 samples/s | 29.0 steps/s
[Step=33400 Epoch=318.3] | Loss=0.00004 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.437 | L2-Norm(final)=9.239 | 4419.6 samples/s | 69.1 steps/s
[Step=33450 Epoch=318.8] | Loss=0.00004 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.430 | L2-Norm(final)=9.239 | 1915.7 samples/s | 29.9 steps/s
[Step=33500 Epoch=319.3] | Loss=0.00003 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.423 | L2-Norm(final)=9.240 | 4193.9 samples/s | 65.5 steps/s
[Step=33550 Epoch=319.8] | Loss=0.00003 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.417 | L2-Norm(final)=9.240 | 6418.5 samples/s | 100.3 steps/s
[Step=33600 Epoch=320.2] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.410 | L2-Norm(final)=9.240 | 1646.3 samples/s | 25.7 steps/s
[Step=33650 Epoch=320.7] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.402 | L2-Norm(final)=9.240 | 5969.6 samples/s | 93.3 steps/s
[Step=33700 Epoch=321.2] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.395 | L2-Norm(final)=9.240 | 1699.0 samples/s | 26.5 steps/s
[Step=33750 Epoch=321.7] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.388 | L2-Norm(final)=9.241 | 5497.9 samples/s | 85.9 steps/s
[Step=33800 Epoch=322.1] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.380 | L2-Norm(final)=9.241 | 1712.4 samples/s | 26.8 steps/s
[Step=33850 Epoch=322.6] | Loss=0.00003 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.373 | L2-Norm(final)=9.241 | 5214.7 samples/s | 81.5 steps/s
[Step=33900 Epoch=323.1] | Loss=0.00002 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.365 | L2-Norm(final)=9.241 | 1755.2 samples/s | 27.4 steps/s
[Step=33950 Epoch=323.6] | Loss=0.00002 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.358 | L2-Norm(final)=9.241 | 4858.6 samples/s | 75.9 steps/s
[Step=34000 Epoch=324.1] | Loss=0.00002 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.350 | L2-Norm(final)=9.242 | 1797.2 samples/s | 28.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step34000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08687 | acc=0.9628 | tpr=0.9749 | fpr=0.0634 | 4080.6 samples/s | 15.9 steps/s
Avg test loss: 0.08999, Avg test acc: 0.96158, Avg tpr: 0.97412, Avg fpr: 0.06602, total FA: 515

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09279 | acc=0.9619 | tpr=0.9793 | fpr=0.0761 | 4077.6 samples/s | 15.9 steps/s
Avg test loss: 0.09628, Avg test acc: 0.96117, Avg tpr: 0.97826, Avg fpr: 0.07640, total FA: 596

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08948 | acc=0.9617 | tpr=0.9714 | fpr=0.0592 | 4158.1 samples/s | 16.2 steps/s
Avg test loss: 0.09412, Avg test acc: 0.95985, Avg tpr: 0.96905, Avg fpr: 0.06038, total FA: 471

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09518 | acc=0.9583 | tpr=0.9732 | fpr=0.0741 | 4086.1 samples/s | 16.0 steps/s
Avg test loss: 0.09862, Avg test acc: 0.95801, Avg tpr: 0.97296, Avg fpr: 0.07486, total FA: 584

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08941 | acc=0.9624 | tpr=0.9759 | fpr=0.0669 | 4055.8 samples/s | 15.8 steps/s
Avg test loss: 0.09605, Avg test acc: 0.96117, Avg tpr: 0.97465, Avg fpr: 0.06845, total FA: 534

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.25337 | acc=0.2791 | tpr=0.0034 | fpr=0.1222 | 4113.2 samples/s | 16.1 steps/s
Avg test loss: 5.27105, Avg test acc: 0.27747, Avg tpr: 0.00431, Avg fpr: 0.12178, total FA: 950

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.81348 | acc=0.3120 | tpr=0.0038 | fpr=0.0188 | 4006.2 samples/s | 15.6 steps/s
Avg test loss: 4.82031, Avg test acc: 0.30960, Avg tpr: 0.00455, Avg fpr: 0.01948, total FA: 152

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.17410 | acc=0.3029 | tpr=0.0033 | fpr=0.0466 | 4029.5 samples/s | 15.7 steps/s
Avg test loss: 5.18536, Avg test acc: 0.30079, Avg tpr: 0.00420, Avg fpr: 0.04692, total FA: 366

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.30064 | acc=0.3022 | tpr=0.0046 | fpr=0.0515 | 4136.8 samples/s | 16.2 steps/s
Avg test loss: 5.31147, Avg test acc: 0.29942, Avg tpr: 0.00548, Avg fpr: 0.05410, total FA: 422

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.16791 | acc=0.3139 | tpr=0.0011 | fpr=0.0069 | 4079.8 samples/s | 15.9 steps/s
Avg test loss: 5.17738, Avg test acc: 0.31108, Avg tpr: 0.00140, Avg fpr: 0.00782, total FA: 61

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.51359 | acc=0.1196 | tpr=0.8761 | fpr=0.8940 | 4068.3 samples/s | 15.9 steps/s
[Step= 100] | Loss=5.46182 | acc=0.1208 | tpr=0.8550 | fpr=0.8929 | 8316.8 samples/s | 32.5 steps/s
[Step= 150] | Loss=5.46512 | acc=0.1191 | tpr=0.8674 | fpr=0.8947 | 8083.2 samples/s | 31.6 steps/s
[Step= 200] | Loss=5.46381 | acc=0.1184 | tpr=0.8667 | fpr=0.8952 | 8043.7 samples/s | 31.4 steps/s
[Step= 250] | Loss=5.46715 | acc=0.1190 | tpr=0.8629 | fpr=0.8946 | 8243.7 samples/s | 32.2 steps/s
[Step= 300] | Loss=5.46444 | acc=0.1183 | tpr=0.8589 | fpr=0.8952 | 8194.2 samples/s | 32.0 steps/s
[Step= 350] | Loss=5.45993 | acc=0.1180 | tpr=0.8560 | fpr=0.8954 | 7905.8 samples/s | 30.9 steps/s
[Step= 400] | Loss=5.46103 | acc=0.1183 | tpr=0.8523 | fpr=0.8950 | 7799.5 samples/s | 30.5 steps/s
[Step= 450] | Loss=5.46488 | acc=0.1180 | tpr=0.8481 | fpr=0.8953 | 8178.9 samples/s | 31.9 steps/s
[Step= 500] | Loss=5.46796 | acc=0.1179 | tpr=0.8493 | fpr=0.8954 | 7914.1 samples/s | 30.9 steps/s
[Step= 550] | Loss=5.46719 | acc=0.1176 | tpr=0.8528 | fpr=0.8957 | 15838.7 samples/s | 61.9 steps/s
Avg test loss: 5.46900, Avg test acc: 0.11757, Avg tpr: 0.85261, Avg fpr: 0.89579, total FA: 124379

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.40888 | acc=0.1181 | tpr=0.8584 | fpr=0.8952 | 4032.1 samples/s | 15.8 steps/s
[Step= 100] | Loss=5.35005 | acc=0.1201 | tpr=0.8294 | fpr=0.8931 | 7897.1 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.35676 | acc=0.1180 | tpr=0.8329 | fpr=0.8952 | 8005.0 samples/s | 31.3 steps/s
[Step= 200] | Loss=5.35648 | acc=0.1181 | tpr=0.8273 | fpr=0.8948 | 8489.3 samples/s | 33.2 steps/s
[Step= 250] | Loss=5.35640 | acc=0.1185 | tpr=0.8253 | fpr=0.8944 | 7755.9 samples/s | 30.3 steps/s
[Step= 300] | Loss=5.35386 | acc=0.1180 | tpr=0.8291 | fpr=0.8949 | 7937.1 samples/s | 31.0 steps/s
[Step= 350] | Loss=5.34966 | acc=0.1175 | tpr=0.8291 | fpr=0.8955 | 8092.9 samples/s | 31.6 steps/s
[Step= 400] | Loss=5.34933 | acc=0.1178 | tpr=0.8249 | fpr=0.8951 | 8003.4 samples/s | 31.3 steps/s
[Step= 450] | Loss=5.35474 | acc=0.1177 | tpr=0.8247 | fpr=0.8951 | 8295.0 samples/s | 32.4 steps/s
[Step= 500] | Loss=5.36135 | acc=0.1173 | tpr=0.8242 | fpr=0.8955 | 7886.4 samples/s | 30.8 steps/s
[Step= 550] | Loss=5.36054 | acc=0.1171 | tpr=0.8245 | fpr=0.8957 | 13858.3 samples/s | 54.1 steps/s
Avg test loss: 5.36153, Avg test acc: 0.11709, Avg tpr: 0.82409, Avg fpr: 0.89576, total FA: 124375

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.92752 | acc=0.1183 | tpr=0.8142 | fpr=0.8942 | 4094.4 samples/s | 16.0 steps/s
[Step= 100] | Loss=5.86972 | acc=0.1215 | tpr=0.8188 | fpr=0.8915 | 8039.1 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.87791 | acc=0.1191 | tpr=0.8343 | fpr=0.8941 | 8246.7 samples/s | 32.2 steps/s
[Step= 200] | Loss=5.88093 | acc=0.1179 | tpr=0.8328 | fpr=0.8951 | 7981.6 samples/s | 31.2 steps/s
[Step= 250] | Loss=5.88102 | acc=0.1185 | tpr=0.8297 | fpr=0.8945 | 8066.9 samples/s | 31.5 steps/s
[Step= 300] | Loss=5.87820 | acc=0.1180 | tpr=0.8276 | fpr=0.8950 | 8381.3 samples/s | 32.7 steps/s
[Step= 350] | Loss=5.87665 | acc=0.1177 | tpr=0.8272 | fpr=0.8952 | 7747.4 samples/s | 30.3 steps/s
[Step= 400] | Loss=5.87865 | acc=0.1182 | tpr=0.8288 | fpr=0.8947 | 7830.1 samples/s | 30.6 steps/s
[Step= 450] | Loss=5.88318 | acc=0.1175 | tpr=0.8223 | fpr=0.8953 | 7997.7 samples/s | 31.2 steps/s
[Step= 500] | Loss=5.88417 | acc=0.1172 | tpr=0.8220 | fpr=0.8955 | 7810.0 samples/s | 30.5 steps/s
[Step= 550] | Loss=5.88317 | acc=0.1171 | tpr=0.8261 | fpr=0.8958 | 14441.6 samples/s | 56.4 steps/s
Avg test loss: 5.88470, Avg test acc: 0.11701, Avg tpr: 0.82567, Avg fpr: 0.89587, total FA: 124390

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.29962 | acc=0.1258 | tpr=0.7566 | fpr=0.8856 | 4020.9 samples/s | 15.7 steps/s
[Step= 100] | Loss=5.24864 | acc=0.1264 | tpr=0.7164 | fpr=0.8846 | 7891.3 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.24614 | acc=0.1245 | tpr=0.7277 | fpr=0.8866 | 8160.0 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.23848 | acc=0.1240 | tpr=0.7279 | fpr=0.8870 | 7964.2 samples/s | 31.1 steps/s
[Step= 250] | Loss=5.24030 | acc=0.1241 | tpr=0.7319 | fpr=0.8870 | 7893.0 samples/s | 30.8 steps/s
[Step= 300] | Loss=5.23941 | acc=0.1235 | tpr=0.7331 | fpr=0.8876 | 7858.8 samples/s | 30.7 steps/s
[Step= 350] | Loss=5.23402 | acc=0.1232 | tpr=0.7295 | fpr=0.8878 | 7843.4 samples/s | 30.6 steps/s
[Step= 400] | Loss=5.23725 | acc=0.1228 | tpr=0.7303 | fpr=0.8882 | 8647.2 samples/s | 33.8 steps/s
[Step= 450] | Loss=5.24329 | acc=0.1226 | tpr=0.7259 | fpr=0.8883 | 7899.6 samples/s | 30.9 steps/s
[Step= 500] | Loss=5.24807 | acc=0.1226 | tpr=0.7256 | fpr=0.8883 | 7937.3 samples/s | 31.0 steps/s
[Step= 550] | Loss=5.24775 | acc=0.1225 | tpr=0.7254 | fpr=0.8885 | 14332.9 samples/s | 56.0 steps/s
Avg test loss: 5.24922, Avg test acc: 0.12244, Avg tpr: 0.72504, Avg fpr: 0.88851, total FA: 123368

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.51279 | acc=0.1246 | tpr=0.7743 | fpr=0.8871 | 4069.0 samples/s | 15.9 steps/s
[Step= 100] | Loss=5.45867 | acc=0.1288 | tpr=0.7655 | fpr=0.8831 | 7687.2 samples/s | 30.0 steps/s
[Step= 150] | Loss=5.46017 | acc=0.1264 | tpr=0.7622 | fpr=0.8853 | 8175.8 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.45851 | acc=0.1257 | tpr=0.7563 | fpr=0.8858 | 7916.2 samples/s | 30.9 steps/s
[Step= 250] | Loss=5.46325 | acc=0.1259 | tpr=0.7537 | fpr=0.8856 | 8073.8 samples/s | 31.5 steps/s
[Step= 300] | Loss=5.45788 | acc=0.1255 | tpr=0.7578 | fpr=0.8860 | 7893.1 samples/s | 30.8 steps/s
[Step= 350] | Loss=5.45329 | acc=0.1249 | tpr=0.7564 | fpr=0.8866 | 7966.4 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.45652 | acc=0.1249 | tpr=0.7549 | fpr=0.8866 | 7750.4 samples/s | 30.3 steps/s
[Step= 450] | Loss=5.45946 | acc=0.1244 | tpr=0.7502 | fpr=0.8870 | 8308.8 samples/s | 32.5 steps/s
[Step= 500] | Loss=5.46248 | acc=0.1241 | tpr=0.7463 | fpr=0.8871 | 7815.2 samples/s | 30.5 steps/s
[Step= 550] | Loss=5.46215 | acc=0.1239 | tpr=0.7469 | fpr=0.8875 | 13981.6 samples/s | 54.6 steps/s
Avg test loss: 5.46436, Avg test acc: 0.12384, Avg tpr: 0.74643, Avg fpr: 0.88748, total FA: 123225

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10571 | acc=0.9804 | tpr=0.9159 | fpr=0.0185 | 4131.5 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.10999 | acc=0.9800 | tpr=0.9424 | fpr=0.0193 | 8216.3 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.11445 | acc=0.9790 | tpr=0.9452 | fpr=0.0204 | 8068.8 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.11630 | acc=0.9788 | tpr=0.9475 | fpr=0.0206 | 7724.1 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.11564 | acc=0.9788 | tpr=0.9432 | fpr=0.0205 | 7863.1 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.11767 | acc=0.9786 | tpr=0.9411 | fpr=0.0207 | 8012.2 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.11756 | acc=0.9785 | tpr=0.9405 | fpr=0.0208 | 8138.2 samples/s | 31.8 steps/s
[Step= 400] | Loss=0.11891 | acc=0.9784 | tpr=0.9376 | fpr=0.0209 | 7705.6 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.12170 | acc=0.9781 | tpr=0.9377 | fpr=0.0211 | 8258.9 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.12141 | acc=0.9782 | tpr=0.9392 | fpr=0.0211 | 7514.3 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.12037 | acc=0.9784 | tpr=0.9387 | fpr=0.0209 | 14233.2 samples/s | 55.6 steps/s
Avg test loss: 0.12022, Avg test acc: 0.97842, Avg tpr: 0.93899, Avg fpr: 0.02086, total FA: 2897

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11268 | acc=0.9814 | tpr=0.8938 | fpr=0.0170 | 4062.8 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.11725 | acc=0.9811 | tpr=0.9104 | fpr=0.0175 | 8027.4 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.12237 | acc=0.9804 | tpr=0.9107 | fpr=0.0183 | 8202.3 samples/s | 32.0 steps/s
[Step= 200] | Loss=0.12420 | acc=0.9806 | tpr=0.9169 | fpr=0.0183 | 7907.8 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.12295 | acc=0.9805 | tpr=0.9153 | fpr=0.0184 | 7910.9 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.12526 | acc=0.9801 | tpr=0.9156 | fpr=0.0187 | 7743.5 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.12571 | acc=0.9799 | tpr=0.9192 | fpr=0.0190 | 7944.5 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.12699 | acc=0.9796 | tpr=0.9158 | fpr=0.0192 | 8271.0 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.13020 | acc=0.9794 | tpr=0.9143 | fpr=0.0194 | 7808.5 samples/s | 30.5 steps/s
[Step= 500] | Loss=0.12961 | acc=0.9795 | tpr=0.9176 | fpr=0.0194 | 7791.3 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.12866 | acc=0.9796 | tpr=0.9176 | fpr=0.0192 | 14066.4 samples/s | 54.9 steps/s
Avg test loss: 0.12844, Avg test acc: 0.97964, Avg tpr: 0.91719, Avg fpr: 0.01922, total FA: 2669

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10902 | acc=0.9793 | tpr=0.9381 | fpr=0.0200 | 4105.9 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.11300 | acc=0.9792 | tpr=0.9574 | fpr=0.0204 | 7840.5 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.11713 | acc=0.9783 | tpr=0.9539 | fpr=0.0212 | 8163.5 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.11942 | acc=0.9783 | tpr=0.9563 | fpr=0.0213 | 8092.0 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.11881 | acc=0.9782 | tpr=0.9537 | fpr=0.0214 | 7930.4 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.12118 | acc=0.9777 | tpr=0.9549 | fpr=0.0218 | 8073.8 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.12116 | acc=0.9776 | tpr=0.9549 | fpr=0.0220 | 7923.3 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.12257 | acc=0.9774 | tpr=0.9524 | fpr=0.0221 | 7979.7 samples/s | 31.2 steps/s
[Step= 450] | Loss=0.12544 | acc=0.9771 | tpr=0.9513 | fpr=0.0224 | 8190.8 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.12500 | acc=0.9772 | tpr=0.9533 | fpr=0.0224 | 7945.4 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.12392 | acc=0.9774 | tpr=0.9522 | fpr=0.0222 | 14478.7 samples/s | 56.6 steps/s
Avg test loss: 0.12376, Avg test acc: 0.97741, Avg tpr: 0.95246, Avg fpr: 0.02214, total FA: 3074

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11524 | acc=0.9808 | tpr=0.9204 | fpr=0.0181 | 4076.8 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.12037 | acc=0.9802 | tpr=0.9382 | fpr=0.0190 | 7841.9 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.12518 | acc=0.9794 | tpr=0.9395 | fpr=0.0198 | 8040.0 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.12751 | acc=0.9793 | tpr=0.9475 | fpr=0.0201 | 8028.5 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.12623 | acc=0.9791 | tpr=0.9432 | fpr=0.0203 | 7952.6 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.12822 | acc=0.9788 | tpr=0.9433 | fpr=0.0205 | 8205.6 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.12822 | acc=0.9787 | tpr=0.9461 | fpr=0.0207 | 8061.8 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.12921 | acc=0.9786 | tpr=0.9420 | fpr=0.0207 | 8090.8 samples/s | 31.6 steps/s
[Step= 450] | Loss=0.13236 | acc=0.9783 | tpr=0.9416 | fpr=0.0210 | 7974.0 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.13199 | acc=0.9784 | tpr=0.9436 | fpr=0.0210 | 7660.5 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.13110 | acc=0.9786 | tpr=0.9435 | fpr=0.0208 | 14634.0 samples/s | 57.2 steps/s
Avg test loss: 0.13093, Avg test acc: 0.97859, Avg tpr: 0.94334, Avg fpr: 0.02077, total FA: 2884

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.13600 | acc=0.9795 | tpr=0.9071 | fpr=0.0192 | 4246.8 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.14029 | acc=0.9792 | tpr=0.9318 | fpr=0.0199 | 7613.8 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.14595 | acc=0.9783 | tpr=0.9337 | fpr=0.0209 | 7949.8 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.14821 | acc=0.9781 | tpr=0.9366 | fpr=0.0212 | 7537.6 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.14678 | acc=0.9781 | tpr=0.9319 | fpr=0.0211 | 7921.5 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.14974 | acc=0.9778 | tpr=0.9324 | fpr=0.0214 | 8261.6 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.15054 | acc=0.9776 | tpr=0.9324 | fpr=0.0216 | 7754.6 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.15196 | acc=0.9773 | tpr=0.9251 | fpr=0.0217 | 8214.5 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.15541 | acc=0.9769 | tpr=0.9245 | fpr=0.0221 | 8009.2 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.15505 | acc=0.9769 | tpr=0.9247 | fpr=0.0221 | 8003.0 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.15419 | acc=0.9770 | tpr=0.9248 | fpr=0.0220 | 14931.5 samples/s | 58.3 steps/s
Avg test loss: 0.15395, Avg test acc: 0.97702, Avg tpr: 0.92433, Avg fpr: 0.02202, total FA: 3058

server round 32/50

clients selected: [1 3 5 6 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=40001 Epoch=195.2] | Loss=0.08744 | Reg=0.00104 | acc=0.9531 | L2-Norm=10.221 | L2-Norm(final)=12.331 | 3811.2 samples/s | 59.6 steps/s
[Step=40050 Epoch=195.4] | Loss=0.03299 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.235 | L2-Norm(final)=12.316 | 4753.6 samples/s | 74.3 steps/s
[Step=40100 Epoch=195.7] | Loss=0.02768 | Reg=0.00105 | acc=0.9688 | L2-Norm=10.244 | L2-Norm(final)=12.311 | 5112.2 samples/s | 79.9 steps/s
[Step=40150 Epoch=195.9] | Loss=0.02406 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.251 | L2-Norm(final)=12.310 | 5089.2 samples/s | 79.5 steps/s
[Step=40200 Epoch=196.2] | Loss=0.02219 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.257 | L2-Norm(final)=12.313 | 7212.1 samples/s | 112.7 steps/s
[Step=40250 Epoch=196.4] | Loss=0.02128 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.264 | L2-Norm(final)=12.316 | 1774.3 samples/s | 27.7 steps/s
[Step=40300 Epoch=196.6] | Loss=0.01979 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.271 | L2-Norm(final)=12.320 | 5112.7 samples/s | 79.9 steps/s
[Step=40350 Epoch=196.9] | Loss=0.01922 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.277 | L2-Norm(final)=12.325 | 5077.8 samples/s | 79.3 steps/s
[Step=40400 Epoch=197.1] | Loss=0.01855 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.284 | L2-Norm(final)=12.330 | 6754.6 samples/s | 105.5 steps/s
[Step=40450 Epoch=197.4] | Loss=0.01790 | Reg=0.00106 | acc=0.9688 | L2-Norm=10.291 | L2-Norm(final)=12.336 | 1813.0 samples/s | 28.3 steps/s
[Step=40500 Epoch=197.6] | Loss=0.01741 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.298 | L2-Norm(final)=12.342 | 5040.9 samples/s | 78.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=40501 Epoch=197.6] | Loss=0.00774 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.364 | L2-Norm(final)=12.399 | 3738.0 samples/s | 58.4 steps/s
[Step=40550 Epoch=197.9] | Loss=0.01338 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.375 | L2-Norm(final)=12.406 | 4280.9 samples/s | 66.9 steps/s
[Step=40600 Epoch=198.1] | Loss=0.01535 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.387 | L2-Norm(final)=12.411 | 4612.1 samples/s | 72.1 steps/s
[Step=40650 Epoch=198.4] | Loss=0.01427 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.397 | L2-Norm(final)=12.417 | 4599.3 samples/s | 71.9 steps/s
[Step=40700 Epoch=198.6] | Loss=0.01368 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.407 | L2-Norm(final)=12.422 | 5893.1 samples/s | 92.1 steps/s
[Step=40750 Epoch=198.8] | Loss=0.01207 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.416 | L2-Norm(final)=12.427 | 1735.6 samples/s | 27.1 steps/s
[Step=40800 Epoch=199.1] | Loss=0.01107 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.423 | L2-Norm(final)=12.432 | 4518.3 samples/s | 70.6 steps/s
[Step=40850 Epoch=199.3] | Loss=0.01038 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.430 | L2-Norm(final)=12.437 | 4475.6 samples/s | 69.9 steps/s
[Step=40900 Epoch=199.6] | Loss=0.01002 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.436 | L2-Norm(final)=12.441 | 5656.4 samples/s | 88.4 steps/s
[Step=40950 Epoch=199.8] | Loss=0.00935 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.441 | L2-Norm(final)=12.445 | 1740.0 samples/s | 27.2 steps/s
[Step=41000 Epoch=200.1] | Loss=0.00877 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.446 | L2-Norm(final)=12.449 | 4594.7 samples/s | 71.8 steps/s
[Step=41050 Epoch=200.3] | Loss=0.00862 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.450 | L2-Norm(final)=12.453 | 4534.4 samples/s | 70.8 steps/s
[Step=41100 Epoch=200.5] | Loss=0.00833 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.454 | L2-Norm(final)=12.456 | 5367.3 samples/s | 83.9 steps/s
[Step=41150 Epoch=200.8] | Loss=0.00799 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.458 | L2-Norm(final)=12.460 | 1807.7 samples/s | 28.2 steps/s
[Step=41200 Epoch=201.0] | Loss=0.00765 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.462 | L2-Norm(final)=12.463 | 4577.1 samples/s | 71.5 steps/s
[Step=41250 Epoch=201.3] | Loss=0.00740 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.466 | L2-Norm(final)=12.467 | 4521.7 samples/s | 70.7 steps/s
[Step=41300 Epoch=201.5] | Loss=0.00719 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.469 | L2-Norm(final)=12.470 | 5081.3 samples/s | 79.4 steps/s
[Step=41350 Epoch=201.8] | Loss=0.00705 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.473 | L2-Norm(final)=12.473 | 1817.2 samples/s | 28.4 steps/s
[Step=41400 Epoch=202.0] | Loss=0.00683 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.476 | L2-Norm(final)=12.476 | 4609.0 samples/s | 72.0 steps/s
[Step=41450 Epoch=202.3] | Loss=0.00664 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.479 | L2-Norm(final)=12.479 | 4528.9 samples/s | 70.8 steps/s
[Step=41500 Epoch=202.5] | Loss=0.00654 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.482 | L2-Norm(final)=12.481 | 4841.4 samples/s | 75.6 steps/s
[Step=41550 Epoch=202.7] | Loss=0.00636 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.485 | L2-Norm(final)=12.484 | 1874.7 samples/s | 29.3 steps/s
[Step=41600 Epoch=203.0] | Loss=0.00622 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.488 | L2-Norm(final)=12.487 | 4634.8 samples/s | 72.4 steps/s
[Step=41650 Epoch=203.2] | Loss=0.00608 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.491 | L2-Norm(final)=12.490 | 4574.9 samples/s | 71.5 steps/s
[Step=41700 Epoch=203.5] | Loss=0.00598 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.494 | L2-Norm(final)=12.492 | 4589.9 samples/s | 71.7 steps/s
[Step=41750 Epoch=203.7] | Loss=0.00582 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.496 | L2-Norm(final)=12.495 | 1892.4 samples/s | 29.6 steps/s
[Step=41800 Epoch=204.0] | Loss=0.00567 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.499 | L2-Norm(final)=12.497 | 4638.7 samples/s | 72.5 steps/s
[Step=41850 Epoch=204.2] | Loss=0.00559 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.501 | L2-Norm(final)=12.500 | 4669.2 samples/s | 73.0 steps/s
[Step=41900 Epoch=204.5] | Loss=0.00552 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.503 | L2-Norm(final)=12.502 | 4644.6 samples/s | 72.6 steps/s
[Step=41950 Epoch=204.7] | Loss=0.00542 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.506 | L2-Norm(final)=12.504 | 1926.9 samples/s | 30.1 steps/s
[Step=42000 Epoch=204.9] | Loss=0.00534 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.508 | L2-Norm(final)=12.507 | 4597.5 samples/s | 71.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step42000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=28001 Epoch=136.5] | Loss=0.02819 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.221 | L2-Norm(final)=11.287 | 3652.3 samples/s | 57.1 steps/s
[Step=28050 Epoch=136.8] | Loss=0.02750 | Reg=0.00105 | acc=0.9688 | L2-Norm=10.227 | L2-Norm(final)=11.280 | 5075.6 samples/s | 79.3 steps/s
[Step=28100 Epoch=137.0] | Loss=0.02370 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.238 | L2-Norm(final)=11.278 | 4981.1 samples/s | 77.8 steps/s
[Step=28150 Epoch=137.3] | Loss=0.02273 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.247 | L2-Norm(final)=11.280 | 5090.3 samples/s | 79.5 steps/s
[Step=28200 Epoch=137.5] | Loss=0.02145 | Reg=0.00105 | acc=0.9688 | L2-Norm=10.256 | L2-Norm(final)=11.283 | 7091.3 samples/s | 110.8 steps/s
[Step=28250 Epoch=137.8] | Loss=0.02038 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.265 | L2-Norm(final)=11.288 | 1831.4 samples/s | 28.6 steps/s
[Step=28300 Epoch=138.0] | Loss=0.01936 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.273 | L2-Norm(final)=11.294 | 5054.4 samples/s | 79.0 steps/s
[Step=28350 Epoch=138.3] | Loss=0.01842 | Reg=0.00106 | acc=0.9688 | L2-Norm=10.282 | L2-Norm(final)=11.300 | 5196.8 samples/s | 81.2 steps/s
[Step=28400 Epoch=138.5] | Loss=0.01789 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=11.306 | 6516.1 samples/s | 101.8 steps/s
[Step=28450 Epoch=138.7] | Loss=0.01723 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.299 | L2-Norm(final)=11.313 | 1835.2 samples/s | 28.7 steps/s
[Step=28500 Epoch=139.0] | Loss=0.01670 | Reg=0.00106 | acc=0.9688 | L2-Norm=10.307 | L2-Norm(final)=11.320 | 5111.7 samples/s | 79.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=28501 Epoch=139.0] | Loss=0.01895 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.392 | L2-Norm(final)=11.391 | 3637.5 samples/s | 56.8 steps/s
[Step=28550 Epoch=139.2] | Loss=0.01302 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.402 | L2-Norm(final)=11.397 | 4416.1 samples/s | 69.0 steps/s
[Step=28600 Epoch=139.5] | Loss=0.01247 | Reg=0.00108 | acc=0.9531 | L2-Norm=10.414 | L2-Norm(final)=11.404 | 4531.0 samples/s | 70.8 steps/s
[Step=28650 Epoch=139.7] | Loss=0.01252 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.426 | L2-Norm(final)=11.411 | 4614.6 samples/s | 72.1 steps/s
[Step=28700 Epoch=140.0] | Loss=0.01231 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.437 | L2-Norm(final)=11.417 | 5992.5 samples/s | 93.6 steps/s
[Step=28750 Epoch=140.2] | Loss=0.01193 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.447 | L2-Norm(final)=11.423 | 1757.7 samples/s | 27.5 steps/s
[Step=28800 Epoch=140.4] | Loss=0.01114 | Reg=0.00109 | acc=0.9844 | L2-Norm=10.457 | L2-Norm(final)=11.429 | 4599.0 samples/s | 71.9 steps/s
[Step=28850 Epoch=140.7] | Loss=0.01057 | Reg=0.00110 | acc=0.9844 | L2-Norm=10.465 | L2-Norm(final)=11.434 | 4679.6 samples/s | 73.1 steps/s
[Step=28900 Epoch=140.9] | Loss=0.01002 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.472 | L2-Norm(final)=11.438 | 5709.9 samples/s | 89.2 steps/s
[Step=28950 Epoch=141.2] | Loss=0.00941 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.479 | L2-Norm(final)=11.443 | 1783.4 samples/s | 27.9 steps/s
[Step=29000 Epoch=141.4] | Loss=0.00875 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.485 | L2-Norm(final)=11.447 | 4544.5 samples/s | 71.0 steps/s
[Step=29050 Epoch=141.7] | Loss=0.00847 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.490 | L2-Norm(final)=11.451 | 4625.1 samples/s | 72.3 steps/s
[Step=29100 Epoch=141.9] | Loss=0.00802 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.496 | L2-Norm(final)=11.455 | 5270.7 samples/s | 82.4 steps/s
[Step=29150 Epoch=142.2] | Loss=0.00765 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.500 | L2-Norm(final)=11.459 | 1825.6 samples/s | 28.5 steps/s
[Step=29200 Epoch=142.4] | Loss=0.00732 | Reg=0.00110 | acc=0.9688 | L2-Norm=10.505 | L2-Norm(final)=11.463 | 4515.7 samples/s | 70.6 steps/s
[Step=29250 Epoch=142.6] | Loss=0.00705 | Reg=0.00110 | acc=1.0000 | L2-Norm=10.509 | L2-Norm(final)=11.467 | 4555.6 samples/s | 71.2 steps/s
[Step=29300 Epoch=142.9] | Loss=0.00697 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.514 | L2-Norm(final)=11.470 | 4943.1 samples/s | 77.2 steps/s
[Step=29350 Epoch=143.1] | Loss=0.00671 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.517 | L2-Norm(final)=11.473 | 1847.8 samples/s | 28.9 steps/s
[Step=29400 Epoch=143.4] | Loss=0.00654 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.521 | L2-Norm(final)=11.477 | 4510.9 samples/s | 70.5 steps/s
[Step=29450 Epoch=143.6] | Loss=0.00636 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.525 | L2-Norm(final)=11.480 | 4595.2 samples/s | 71.8 steps/s
[Step=29500 Epoch=143.9] | Loss=0.00617 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.528 | L2-Norm(final)=11.483 | 4700.4 samples/s | 73.4 steps/s
[Step=29550 Epoch=144.1] | Loss=0.00603 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.532 | L2-Norm(final)=11.486 | 1905.4 samples/s | 29.8 steps/s
[Step=29600 Epoch=144.3] | Loss=0.00586 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.535 | L2-Norm(final)=11.489 | 4477.1 samples/s | 70.0 steps/s
[Step=29650 Epoch=144.6] | Loss=0.00580 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.538 | L2-Norm(final)=11.491 | 4652.7 samples/s | 72.7 steps/s
[Step=29700 Epoch=144.8] | Loss=0.00567 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.541 | L2-Norm(final)=11.494 | 4705.8 samples/s | 73.5 steps/s
[Step=29750 Epoch=145.1] | Loss=0.00551 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.544 | L2-Norm(final)=11.497 | 1905.1 samples/s | 29.8 steps/s
[Step=29800 Epoch=145.3] | Loss=0.00537 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.547 | L2-Norm(final)=11.500 | 4675.8 samples/s | 73.1 steps/s
[Step=29850 Epoch=145.6] | Loss=0.00526 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.550 | L2-Norm(final)=11.503 | 4595.7 samples/s | 71.8 steps/s
[Step=29900 Epoch=145.8] | Loss=0.00520 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.553 | L2-Norm(final)=11.505 | 4646.8 samples/s | 72.6 steps/s
[Step=29950 Epoch=146.1] | Loss=0.00511 | Reg=0.00111 | acc=1.0000 | L2-Norm=10.556 | L2-Norm(final)=11.508 | 1982.3 samples/s | 31.0 steps/s
[Step=30000 Epoch=146.3] | Loss=0.00504 | Reg=0.00111 | acc=0.9844 | L2-Norm=10.558 | L2-Norm(final)=11.510 | 4553.6 samples/s | 71.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step30000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=20001 Epoch=189.5] | Loss=0.02670 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.221 | L2-Norm(final)=6.969 | 3987.4 samples/s | 62.3 steps/s
[Step=20050 Epoch=190.0] | Loss=0.00284 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.255 | L2-Norm(final)=6.967 | 4019.8 samples/s | 62.8 steps/s
[Step=20100 Epoch=190.5] | Loss=0.00172 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.270 | L2-Norm(final)=6.977 | 6944.3 samples/s | 108.5 steps/s
[Step=20150 Epoch=190.9] | Loss=0.00122 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.277 | L2-Norm(final)=6.985 | 1738.7 samples/s | 27.2 steps/s
[Step=20200 Epoch=191.4] | Loss=0.00097 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.281 | L2-Norm(final)=6.992 | 6165.8 samples/s | 96.3 steps/s
[Step=20250 Epoch=191.9] | Loss=0.00081 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.283 | L2-Norm(final)=6.998 | 1798.2 samples/s | 28.1 steps/s
[Step=20300 Epoch=192.4] | Loss=0.00070 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.284 | L2-Norm(final)=7.003 | 5586.4 samples/s | 87.3 steps/s
[Step=20350 Epoch=192.8] | Loss=0.00061 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.285 | L2-Norm(final)=7.009 | 1808.7 samples/s | 28.3 steps/s
[Step=20400 Epoch=193.3] | Loss=0.00055 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.285 | L2-Norm(final)=7.014 | 5346.3 samples/s | 83.5 steps/s
[Step=20450 Epoch=193.8] | Loss=0.00050 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.285 | L2-Norm(final)=7.018 | 1866.6 samples/s | 29.2 steps/s
[Step=20500 Epoch=194.3] | Loss=0.00047 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.284 | L2-Norm(final)=7.023 | 4988.7 samples/s | 77.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=20501 Epoch=194.3] | Loss=0.00002 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.279 | L2-Norm(final)=7.070 | 3636.5 samples/s | 56.8 steps/s
[Step=20550 Epoch=194.7] | Loss=0.00013 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.280 | L2-Norm(final)=7.074 | 4000.3 samples/s | 62.5 steps/s
[Step=20600 Epoch=195.2] | Loss=0.00008 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.277 | L2-Norm(final)=7.077 | 5934.1 samples/s | 92.7 steps/s
[Step=20650 Epoch=195.7] | Loss=0.00006 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.271 | L2-Norm(final)=7.079 | 1693.8 samples/s | 26.5 steps/s
[Step=20700 Epoch=196.2] | Loss=0.00004 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.263 | L2-Norm(final)=7.080 | 5355.1 samples/s | 83.7 steps/s
[Step=20750 Epoch=196.6] | Loss=0.00004 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.254 | L2-Norm(final)=7.081 | 1735.2 samples/s | 27.1 steps/s
[Step=20800 Epoch=197.1] | Loss=0.00003 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.245 | L2-Norm(final)=7.082 | 5063.7 samples/s | 79.1 steps/s
[Step=20850 Epoch=197.6] | Loss=0.00003 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.235 | L2-Norm(final)=7.082 | 1776.2 samples/s | 27.8 steps/s
[Step=20900 Epoch=198.0] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.226 | L2-Norm(final)=7.083 | 4706.0 samples/s | 73.5 steps/s
[Step=20950 Epoch=198.5] | Loss=0.00002 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.216 | L2-Norm(final)=7.083 | 1767.0 samples/s | 27.6 steps/s
[Step=21000 Epoch=199.0] | Loss=0.00002 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.206 | L2-Norm(final)=7.084 | 4523.2 samples/s | 70.7 steps/s
[Step=21050 Epoch=199.5] | Loss=0.00002 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.195 | L2-Norm(final)=7.084 | 1809.0 samples/s | 28.3 steps/s
[Step=21100 Epoch=199.9] | Loss=0.00002 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.185 | L2-Norm(final)=7.084 | 4376.2 samples/s | 68.4 steps/s
[Step=21150 Epoch=200.4] | Loss=0.00002 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.174 | L2-Norm(final)=7.085 | 1863.6 samples/s | 29.1 steps/s
[Step=21200 Epoch=200.9] | Loss=0.00002 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.163 | L2-Norm(final)=7.085 | 4456.6 samples/s | 69.6 steps/s
[Step=21250 Epoch=201.4] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.152 | L2-Norm(final)=7.085 | 1866.0 samples/s | 29.2 steps/s
[Step=21300 Epoch=201.8] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.141 | L2-Norm(final)=7.086 | 4264.7 samples/s | 66.6 steps/s
[Step=21350 Epoch=202.3] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.130 | L2-Norm(final)=7.086 | 1854.4 samples/s | 29.0 steps/s
[Step=21400 Epoch=202.8] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.119 | L2-Norm(final)=7.086 | 4164.3 samples/s | 65.1 steps/s
[Step=21450 Epoch=203.3] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.107 | L2-Norm(final)=7.087 | 6002.6 samples/s | 93.8 steps/s
[Step=21500 Epoch=203.7] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.095 | L2-Norm(final)=7.087 | 1694.9 samples/s | 26.5 steps/s
[Step=21550 Epoch=204.2] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.084 | L2-Norm(final)=7.087 | 5517.0 samples/s | 86.2 steps/s
[Step=21600 Epoch=204.7] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.072 | L2-Norm(final)=7.087 | 1723.9 samples/s | 26.9 steps/s
[Step=21650 Epoch=205.2] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.059 | L2-Norm(final)=7.088 | 5067.7 samples/s | 79.2 steps/s
[Step=21700 Epoch=205.6] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.047 | L2-Norm(final)=7.088 | 1774.0 samples/s | 27.7 steps/s
[Step=21750 Epoch=206.1] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.035 | L2-Norm(final)=7.088 | 4862.7 samples/s | 76.0 steps/s
[Step=21800 Epoch=206.6] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.022 | L2-Norm(final)=7.088 | 1813.4 samples/s | 28.3 steps/s
[Step=21850 Epoch=207.0] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.010 | L2-Norm(final)=7.089 | 4705.1 samples/s | 73.5 steps/s
[Step=21900 Epoch=207.5] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.997 | L2-Norm(final)=7.089 | 1855.9 samples/s | 29.0 steps/s
[Step=21950 Epoch=208.0] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.984 | L2-Norm(final)=7.089 | 4355.4 samples/s | 68.1 steps/s
[Step=22000 Epoch=208.5] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.970 | L2-Norm(final)=7.090 | 1868.3 samples/s | 29.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_0/client_state-step22000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=34001 Epoch=323.4] | Loss=0.00013 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.221 | L2-Norm(final)=8.996 | 3732.1 samples/s | 58.3 steps/s
[Step=34050 Epoch=323.9] | Loss=0.00301 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.246 | L2-Norm(final)=9.001 | 4409.1 samples/s | 68.9 steps/s
[Step=34100 Epoch=324.4] | Loss=0.00179 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.266 | L2-Norm(final)=9.007 | 7094.9 samples/s | 110.9 steps/s
[Step=34150 Epoch=324.9] | Loss=0.00128 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.275 | L2-Norm(final)=9.013 | 1713.2 samples/s | 26.8 steps/s
[Step=34200 Epoch=325.3] | Loss=0.00102 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.279 | L2-Norm(final)=9.017 | 6684.7 samples/s | 104.4 steps/s
[Step=34250 Epoch=325.8] | Loss=0.00085 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.283 | L2-Norm(final)=9.022 | 1770.3 samples/s | 27.7 steps/s
[Step=34300 Epoch=326.3] | Loss=0.00073 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.285 | L2-Norm(final)=9.025 | 5931.8 samples/s | 92.7 steps/s
[Step=34350 Epoch=326.8] | Loss=0.00064 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.286 | L2-Norm(final)=9.029 | 1850.8 samples/s | 28.9 steps/s
[Step=34400 Epoch=327.2] | Loss=0.00058 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=9.033 | 5416.2 samples/s | 84.6 steps/s
[Step=34450 Epoch=327.7] | Loss=0.00052 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.288 | L2-Norm(final)=9.036 | 1882.4 samples/s | 29.4 steps/s
[Step=34500 Epoch=328.2] | Loss=0.00048 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.288 | L2-Norm(final)=9.039 | 5027.5 samples/s | 78.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=328.2] | Loss=0.00002 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.288 | L2-Norm(final)=9.070 | 3729.2 samples/s | 58.3 steps/s
[Step=34550 Epoch=328.7] | Loss=0.00030 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.293 | L2-Norm(final)=9.073 | 4148.0 samples/s | 64.8 steps/s
[Step=34600 Epoch=329.1] | Loss=0.00069 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.303 | L2-Norm(final)=9.077 | 5961.9 samples/s | 93.2 steps/s
[Step=34650 Epoch=329.6] | Loss=0.00048 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.315 | L2-Norm(final)=9.079 | 1700.0 samples/s | 26.6 steps/s
[Step=34700 Epoch=330.1] | Loss=0.00037 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.320 | L2-Norm(final)=9.080 | 5430.3 samples/s | 84.8 steps/s
[Step=34750 Epoch=330.6] | Loss=0.00030 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.321 | L2-Norm(final)=9.081 | 1759.1 samples/s | 27.5 steps/s
[Step=34800 Epoch=331.0] | Loss=0.00025 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.321 | L2-Norm(final)=9.082 | 5069.4 samples/s | 79.2 steps/s
[Step=34850 Epoch=331.5] | Loss=0.00021 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.319 | L2-Norm(final)=9.082 | 1719.0 samples/s | 26.9 steps/s
[Step=34900 Epoch=332.0] | Loss=0.00019 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.317 | L2-Norm(final)=9.083 | 4779.2 samples/s | 74.7 steps/s
[Step=34950 Epoch=332.5] | Loss=0.00017 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.314 | L2-Norm(final)=9.083 | 1788.9 samples/s | 28.0 steps/s
[Step=35000 Epoch=332.9] | Loss=0.00015 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.310 | L2-Norm(final)=9.084 | 4205.1 samples/s | 65.7 steps/s
[Step=35050 Epoch=333.4] | Loss=0.00014 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.307 | L2-Norm(final)=9.084 | 1736.3 samples/s | 27.1 steps/s
[Step=35100 Epoch=333.9] | Loss=0.00013 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.303 | L2-Norm(final)=9.085 | 4040.1 samples/s | 63.1 steps/s
[Step=35150 Epoch=334.4] | Loss=0.00012 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.299 | L2-Norm(final)=9.085 | 1778.1 samples/s | 27.8 steps/s
[Step=35200 Epoch=334.8] | Loss=0.00011 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=9.085 | 4256.8 samples/s | 66.5 steps/s
[Step=35250 Epoch=335.3] | Loss=0.00010 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=9.086 | 1879.6 samples/s | 29.4 steps/s
[Step=35300 Epoch=335.8] | Loss=0.00010 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.286 | L2-Norm(final)=9.086 | 4349.4 samples/s | 68.0 steps/s
[Step=35350 Epoch=336.3] | Loss=0.00009 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.281 | L2-Norm(final)=9.086 | 1926.3 samples/s | 30.1 steps/s
[Step=35400 Epoch=336.7] | Loss=0.00009 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.276 | L2-Norm(final)=9.086 | 3953.6 samples/s | 61.8 steps/s
[Step=35450 Epoch=337.2] | Loss=0.00008 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.272 | L2-Norm(final)=9.087 | 6140.5 samples/s | 95.9 steps/s
[Step=35500 Epoch=337.7] | Loss=0.00008 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.267 | L2-Norm(final)=9.087 | 1672.6 samples/s | 26.1 steps/s
[Step=35550 Epoch=338.2] | Loss=0.00007 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.261 | L2-Norm(final)=9.087 | 5737.2 samples/s | 89.6 steps/s
[Step=35600 Epoch=338.6] | Loss=0.00007 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.256 | L2-Norm(final)=9.087 | 1706.5 samples/s | 26.7 steps/s
[Step=35650 Epoch=339.1] | Loss=0.00007 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.251 | L2-Norm(final)=9.088 | 5332.5 samples/s | 83.3 steps/s
[Step=35700 Epoch=339.6] | Loss=0.00007 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.246 | L2-Norm(final)=9.088 | 1757.8 samples/s | 27.5 steps/s
[Step=35750 Epoch=340.1] | Loss=0.00006 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.240 | L2-Norm(final)=9.088 | 4862.6 samples/s | 76.0 steps/s
[Step=35800 Epoch=340.5] | Loss=0.00006 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.235 | L2-Norm(final)=9.088 | 1779.2 samples/s | 27.8 steps/s
[Step=35850 Epoch=341.0] | Loss=0.00006 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.229 | L2-Norm(final)=9.088 | 4532.4 samples/s | 70.8 steps/s
[Step=35900 Epoch=341.5] | Loss=0.00006 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.223 | L2-Norm(final)=9.089 | 1855.0 samples/s | 29.0 steps/s
[Step=35950 Epoch=342.0] | Loss=0.00005 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.217 | L2-Norm(final)=9.089 | 4298.1 samples/s | 67.2 steps/s
[Step=36000 Epoch=342.4] | Loss=0.00005 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.211 | L2-Norm(final)=9.089 | 1871.9 samples/s | 29.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step36000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=34001 Epoch=324.1] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.221 | L2-Norm(final)=9.247 | 3644.6 samples/s | 56.9 steps/s
[Step=34050 Epoch=324.5] | Loss=0.00397 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.246 | L2-Norm(final)=9.248 | 4443.9 samples/s | 69.4 steps/s
[Step=34100 Epoch=325.0] | Loss=0.00239 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.269 | L2-Norm(final)=9.254 | 6943.7 samples/s | 108.5 steps/s
[Step=34150 Epoch=325.5] | Loss=0.00173 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.280 | L2-Norm(final)=9.261 | 1717.3 samples/s | 26.8 steps/s
[Step=34200 Epoch=326.0] | Loss=0.00135 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.287 | L2-Norm(final)=9.267 | 6460.8 samples/s | 100.9 steps/s
[Step=34250 Epoch=326.4] | Loss=0.00111 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.292 | L2-Norm(final)=9.271 | 1803.6 samples/s | 28.2 steps/s
[Step=34300 Epoch=326.9] | Loss=0.00095 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.294 | L2-Norm(final)=9.275 | 5764.5 samples/s | 90.1 steps/s
[Step=34350 Epoch=327.4] | Loss=0.00084 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.296 | L2-Norm(final)=9.279 | 1813.1 samples/s | 28.3 steps/s
[Step=34400 Epoch=327.9] | Loss=0.00075 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.297 | L2-Norm(final)=9.283 | 5659.0 samples/s | 88.4 steps/s
[Step=34450 Epoch=328.3] | Loss=0.00068 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.298 | L2-Norm(final)=9.286 | 1851.0 samples/s | 28.9 steps/s
[Step=34500 Epoch=328.8] | Loss=0.00062 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.299 | L2-Norm(final)=9.290 | 5224.8 samples/s | 81.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=328.8] | Loss=0.00011 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.304 | L2-Norm(final)=9.322 | 3754.5 samples/s | 58.7 steps/s
[Step=34550 Epoch=329.3] | Loss=0.00006 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.301 | L2-Norm(final)=9.324 | 3956.7 samples/s | 61.8 steps/s
[Step=34600 Epoch=329.8] | Loss=0.00005 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=9.326 | 5854.8 samples/s | 91.5 steps/s
[Step=34650 Epoch=330.2] | Loss=0.00004 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.289 | L2-Norm(final)=9.327 | 1680.6 samples/s | 26.3 steps/s
[Step=34700 Epoch=330.7] | Loss=0.00003 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.282 | L2-Norm(final)=9.328 | 5329.8 samples/s | 83.3 steps/s
[Step=34750 Epoch=331.2] | Loss=0.00003 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.273 | L2-Norm(final)=9.328 | 1735.4 samples/s | 27.1 steps/s
[Step=34800 Epoch=331.7] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.264 | L2-Norm(final)=9.329 | 5329.2 samples/s | 83.3 steps/s
[Step=34850 Epoch=332.2] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.255 | L2-Norm(final)=9.329 | 1770.3 samples/s | 27.7 steps/s
[Step=34900 Epoch=332.6] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.246 | L2-Norm(final)=9.330 | 4879.5 samples/s | 76.2 steps/s
[Step=34950 Epoch=333.1] | Loss=0.00002 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.236 | L2-Norm(final)=9.330 | 1788.9 samples/s | 28.0 steps/s
[Step=35000 Epoch=333.6] | Loss=0.00001 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.227 | L2-Norm(final)=9.330 | 4601.4 samples/s | 71.9 steps/s
[Step=35050 Epoch=334.1] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.217 | L2-Norm(final)=9.330 | 1818.9 samples/s | 28.4 steps/s
[Step=35100 Epoch=334.5] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.206 | L2-Norm(final)=9.331 | 4365.4 samples/s | 68.2 steps/s
[Step=35150 Epoch=335.0] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.196 | L2-Norm(final)=9.331 | 1842.4 samples/s | 28.8 steps/s
[Step=35200 Epoch=335.5] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.186 | L2-Norm(final)=9.331 | 4424.7 samples/s | 69.1 steps/s
[Step=35250 Epoch=336.0] | Loss=0.00001 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.175 | L2-Norm(final)=9.331 | 1853.0 samples/s | 29.0 steps/s
[Step=35300 Epoch=336.4] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.164 | L2-Norm(final)=9.332 | 4431.4 samples/s | 69.2 steps/s
[Step=35350 Epoch=336.9] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.153 | L2-Norm(final)=9.332 | 1885.7 samples/s | 29.5 steps/s
[Step=35400 Epoch=337.4] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.142 | L2-Norm(final)=9.332 | 4369.7 samples/s | 68.3 steps/s
[Step=35450 Epoch=337.9] | Loss=0.00001 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.131 | L2-Norm(final)=9.333 | 1849.8 samples/s | 28.9 steps/s
[Step=35500 Epoch=338.3] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.120 | L2-Norm(final)=9.333 | 4294.5 samples/s | 67.1 steps/s
[Step=35550 Epoch=338.8] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.108 | L2-Norm(final)=9.333 | 6427.8 samples/s | 100.4 steps/s
[Step=35600 Epoch=339.3] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.096 | L2-Norm(final)=9.333 | 1639.8 samples/s | 25.6 steps/s
[Step=35650 Epoch=339.8] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.084 | L2-Norm(final)=9.334 | 5980.7 samples/s | 93.4 steps/s
[Step=35700 Epoch=340.3] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.072 | L2-Norm(final)=9.334 | 1679.0 samples/s | 26.2 steps/s
[Step=35750 Epoch=340.7] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.060 | L2-Norm(final)=9.334 | 5532.0 samples/s | 86.4 steps/s
[Step=35800 Epoch=341.2] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.048 | L2-Norm(final)=9.335 | 1708.2 samples/s | 26.7 steps/s
[Step=35850 Epoch=341.7] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.035 | L2-Norm(final)=9.335 | 5244.5 samples/s | 81.9 steps/s
[Step=35900 Epoch=342.2] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.023 | L2-Norm(final)=9.335 | 1747.0 samples/s | 27.3 steps/s
[Step=35950 Epoch=342.6] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.010 | L2-Norm(final)=9.336 | 4752.3 samples/s | 74.3 steps/s
[Step=36000 Epoch=343.1] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.997 | L2-Norm(final)=9.336 | 1807.5 samples/s | 28.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08687 | acc=0.9628 | tpr=0.9749 | fpr=0.0634 | 4060.4 samples/s | 15.9 steps/s
Avg test loss: 0.08999, Avg test acc: 0.96158, Avg tpr: 0.97412, Avg fpr: 0.06602, total FA: 515

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08962 | acc=0.9620 | tpr=0.9780 | fpr=0.0726 | 4109.0 samples/s | 16.1 steps/s
Avg test loss: 0.09452, Avg test acc: 0.96041, Avg tpr: 0.97715, Avg fpr: 0.07640, total FA: 596

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08948 | acc=0.9617 | tpr=0.9714 | fpr=0.0592 | 4131.3 samples/s | 16.1 steps/s
Avg test loss: 0.09412, Avg test acc: 0.95985, Avg tpr: 0.96905, Avg fpr: 0.06038, total FA: 471

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08420 | acc=0.9621 | tpr=0.9762 | fpr=0.0684 | 4109.5 samples/s | 16.1 steps/s
Avg test loss: 0.08821, Avg test acc: 0.96142, Avg tpr: 0.97570, Avg fpr: 0.06999, total FA: 546

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08941 | acc=0.9624 | tpr=0.9759 | fpr=0.0669 | 4008.5 samples/s | 15.7 steps/s
Avg test loss: 0.09605, Avg test acc: 0.96117, Avg tpr: 0.97465, Avg fpr: 0.06845, total FA: 534

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.23205 | acc=0.2906 | tpr=0.0027 | fpr=0.0842 | 4056.2 samples/s | 15.8 steps/s
Avg test loss: 5.24794, Avg test acc: 0.28840, Avg tpr: 0.00361, Avg fpr: 0.08525, total FA: 665

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.87256 | acc=0.3111 | tpr=0.0045 | fpr=0.0230 | 4069.1 samples/s | 15.9 steps/s
Avg test loss: 4.88381, Avg test acc: 0.30916, Avg tpr: 0.00560, Avg fpr: 0.02320, total FA: 181

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.17410 | acc=0.3029 | tpr=0.0033 | fpr=0.0466 | 4061.4 samples/s | 15.9 steps/s
Avg test loss: 5.18536, Avg test acc: 0.30079, Avg tpr: 0.00420, Avg fpr: 0.04692, total FA: 366

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.30064 | acc=0.3022 | tpr=0.0046 | fpr=0.0515 | 4140.7 samples/s | 16.2 steps/s
Avg test loss: 5.31147, Avg test acc: 0.29942, Avg tpr: 0.00548, Avg fpr: 0.05410, total FA: 422

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.08761 | acc=0.3137 | tpr=0.0017 | fpr=0.0087 | 4194.4 samples/s | 16.4 steps/s
Avg test loss: 5.09724, Avg test acc: 0.31104, Avg tpr: 0.00210, Avg fpr: 0.00949, total FA: 74

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.51359 | acc=0.1196 | tpr=0.8761 | fpr=0.8940 | 4159.2 samples/s | 16.2 steps/s
[Step= 100] | Loss=5.46182 | acc=0.1208 | tpr=0.8550 | fpr=0.8929 | 7890.7 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.46512 | acc=0.1191 | tpr=0.8674 | fpr=0.8947 | 8333.2 samples/s | 32.6 steps/s
[Step= 200] | Loss=5.46381 | acc=0.1184 | tpr=0.8667 | fpr=0.8952 | 7592.3 samples/s | 29.7 steps/s
[Step= 250] | Loss=5.46715 | acc=0.1190 | tpr=0.8629 | fpr=0.8946 | 8027.9 samples/s | 31.4 steps/s
[Step= 300] | Loss=5.46444 | acc=0.1183 | tpr=0.8589 | fpr=0.8952 | 7991.8 samples/s | 31.2 steps/s
[Step= 350] | Loss=5.45993 | acc=0.1180 | tpr=0.8560 | fpr=0.8954 | 8221.4 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.46103 | acc=0.1183 | tpr=0.8523 | fpr=0.8950 | 7890.5 samples/s | 30.8 steps/s
[Step= 450] | Loss=5.46488 | acc=0.1180 | tpr=0.8481 | fpr=0.8953 | 7995.9 samples/s | 31.2 steps/s
[Step= 500] | Loss=5.46796 | acc=0.1179 | tpr=0.8493 | fpr=0.8954 | 7664.7 samples/s | 29.9 steps/s
[Step= 550] | Loss=5.46719 | acc=0.1176 | tpr=0.8528 | fpr=0.8957 | 14623.6 samples/s | 57.1 steps/s
Avg test loss: 5.46900, Avg test acc: 0.11757, Avg tpr: 0.85261, Avg fpr: 0.89579, total FA: 124379

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.45705 | acc=0.1152 | tpr=0.8673 | fpr=0.8984 | 4126.3 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.40373 | acc=0.1171 | tpr=0.8507 | fpr=0.8966 | 7934.4 samples/s | 31.0 steps/s
[Step= 150] | Loss=5.40661 | acc=0.1150 | tpr=0.8631 | fpr=0.8988 | 7925.9 samples/s | 31.0 steps/s
[Step= 200] | Loss=5.40633 | acc=0.1148 | tpr=0.8568 | fpr=0.8987 | 8265.4 samples/s | 32.3 steps/s
[Step= 250] | Loss=5.40598 | acc=0.1155 | tpr=0.8524 | fpr=0.8979 | 8093.3 samples/s | 31.6 steps/s
[Step= 300] | Loss=5.40374 | acc=0.1149 | tpr=0.8516 | fpr=0.8985 | 7905.2 samples/s | 30.9 steps/s
[Step= 350] | Loss=5.39839 | acc=0.1144 | tpr=0.8485 | fpr=0.8989 | 7508.4 samples/s | 29.3 steps/s
[Step= 400] | Loss=5.39874 | acc=0.1145 | tpr=0.8452 | fpr=0.8988 | 8314.2 samples/s | 32.5 steps/s
[Step= 450] | Loss=5.40368 | acc=0.1141 | tpr=0.8418 | fpr=0.8991 | 8163.5 samples/s | 31.9 steps/s
[Step= 500] | Loss=5.40969 | acc=0.1139 | tpr=0.8436 | fpr=0.8993 | 7581.7 samples/s | 29.6 steps/s
[Step= 550] | Loss=5.40825 | acc=0.1138 | tpr=0.8456 | fpr=0.8995 | 14285.6 samples/s | 55.8 steps/s
Avg test loss: 5.40942, Avg test acc: 0.11379, Avg tpr: 0.84509, Avg fpr: 0.89950, total FA: 124894

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.92752 | acc=0.1183 | tpr=0.8142 | fpr=0.8942 | 4113.0 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.86972 | acc=0.1215 | tpr=0.8188 | fpr=0.8915 | 7743.0 samples/s | 30.2 steps/s
[Step= 150] | Loss=5.87791 | acc=0.1191 | tpr=0.8343 | fpr=0.8941 | 7871.3 samples/s | 30.7 steps/s
[Step= 200] | Loss=5.88093 | acc=0.1179 | tpr=0.8328 | fpr=0.8951 | 8149.4 samples/s | 31.8 steps/s
[Step= 250] | Loss=5.88102 | acc=0.1185 | tpr=0.8297 | fpr=0.8945 | 7901.7 samples/s | 30.9 steps/s
[Step= 300] | Loss=5.87820 | acc=0.1180 | tpr=0.8276 | fpr=0.8950 | 8105.4 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.87665 | acc=0.1177 | tpr=0.8272 | fpr=0.8952 | 8010.9 samples/s | 31.3 steps/s
[Step= 400] | Loss=5.87865 | acc=0.1182 | tpr=0.8288 | fpr=0.8947 | 7812.0 samples/s | 30.5 steps/s
[Step= 450] | Loss=5.88318 | acc=0.1175 | tpr=0.8223 | fpr=0.8953 | 8184.8 samples/s | 32.0 steps/s
[Step= 500] | Loss=5.88417 | acc=0.1172 | tpr=0.8220 | fpr=0.8955 | 7910.0 samples/s | 30.9 steps/s
[Step= 550] | Loss=5.88317 | acc=0.1171 | tpr=0.8261 | fpr=0.8958 | 14211.0 samples/s | 55.5 steps/s
Avg test loss: 5.88470, Avg test acc: 0.11701, Avg tpr: 0.82567, Avg fpr: 0.89587, total FA: 124390

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.18261 | acc=0.1268 | tpr=0.8009 | fpr=0.8853 | 4033.6 samples/s | 15.8 steps/s
[Step= 100] | Loss=5.13090 | acc=0.1290 | tpr=0.7825 | fpr=0.8832 | 7958.3 samples/s | 31.1 steps/s
[Step= 150] | Loss=5.13122 | acc=0.1274 | tpr=0.8069 | fpr=0.8851 | 7937.8 samples/s | 31.0 steps/s
[Step= 200] | Loss=5.12686 | acc=0.1274 | tpr=0.8055 | fpr=0.8850 | 8023.2 samples/s | 31.3 steps/s
[Step= 250] | Loss=5.12945 | acc=0.1278 | tpr=0.8087 | fpr=0.8846 | 8122.0 samples/s | 31.7 steps/s
[Step= 300] | Loss=5.12698 | acc=0.1268 | tpr=0.8044 | fpr=0.8855 | 8112.1 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.12193 | acc=0.1266 | tpr=0.8028 | fpr=0.8857 | 7888.1 samples/s | 30.8 steps/s
[Step= 400] | Loss=5.12470 | acc=0.1264 | tpr=0.7998 | fpr=0.8858 | 7848.5 samples/s | 30.7 steps/s
[Step= 450] | Loss=5.13069 | acc=0.1261 | tpr=0.7941 | fpr=0.8860 | 7743.3 samples/s | 30.2 steps/s
[Step= 500] | Loss=5.13456 | acc=0.1260 | tpr=0.7974 | fpr=0.8861 | 8284.2 samples/s | 32.4 steps/s
[Step= 550] | Loss=5.13272 | acc=0.1259 | tpr=0.8010 | fpr=0.8864 | 13653.6 samples/s | 53.3 steps/s
Avg test loss: 5.13423, Avg test acc: 0.12583, Avg tpr: 0.80032, Avg fpr: 0.88643, total FA: 123079

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.51279 | acc=0.1246 | tpr=0.7743 | fpr=0.8871 | 4158.5 samples/s | 16.2 steps/s
[Step= 100] | Loss=5.45867 | acc=0.1288 | tpr=0.7655 | fpr=0.8831 | 7812.1 samples/s | 30.5 steps/s
[Step= 150] | Loss=5.46017 | acc=0.1264 | tpr=0.7622 | fpr=0.8853 | 8114.5 samples/s | 31.7 steps/s
[Step= 200] | Loss=5.45851 | acc=0.1257 | tpr=0.7563 | fpr=0.8858 | 8084.8 samples/s | 31.6 steps/s
[Step= 250] | Loss=5.46325 | acc=0.1259 | tpr=0.7537 | fpr=0.8856 | 7872.7 samples/s | 30.8 steps/s
[Step= 300] | Loss=5.45788 | acc=0.1255 | tpr=0.7578 | fpr=0.8860 | 7976.9 samples/s | 31.2 steps/s
[Step= 350] | Loss=5.45329 | acc=0.1249 | tpr=0.7564 | fpr=0.8866 | 7691.0 samples/s | 30.0 steps/s
[Step= 400] | Loss=5.45652 | acc=0.1249 | tpr=0.7549 | fpr=0.8866 | 8315.5 samples/s | 32.5 steps/s
[Step= 450] | Loss=5.45946 | acc=0.1244 | tpr=0.7502 | fpr=0.8870 | 7702.7 samples/s | 30.1 steps/s
[Step= 500] | Loss=5.46248 | acc=0.1241 | tpr=0.7463 | fpr=0.8871 | 8049.9 samples/s | 31.4 steps/s
[Step= 550] | Loss=5.46215 | acc=0.1239 | tpr=0.7469 | fpr=0.8875 | 14736.4 samples/s | 57.6 steps/s
Avg test loss: 5.46436, Avg test acc: 0.12384, Avg tpr: 0.74643, Avg fpr: 0.88748, total FA: 123225

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10724 | acc=0.9805 | tpr=0.9292 | fpr=0.0185 | 4110.5 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.11120 | acc=0.9798 | tpr=0.9467 | fpr=0.0195 | 7697.9 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.11572 | acc=0.9789 | tpr=0.9481 | fpr=0.0206 | 7572.6 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.11788 | acc=0.9788 | tpr=0.9508 | fpr=0.0206 | 7993.9 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.11730 | acc=0.9787 | tpr=0.9441 | fpr=0.0207 | 8412.7 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.11947 | acc=0.9785 | tpr=0.9425 | fpr=0.0209 | 7595.7 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.11932 | acc=0.9784 | tpr=0.9418 | fpr=0.0210 | 8013.0 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.12067 | acc=0.9782 | tpr=0.9382 | fpr=0.0210 | 8131.4 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.12341 | acc=0.9780 | tpr=0.9377 | fpr=0.0213 | 8171.8 samples/s | 31.9 steps/s
[Step= 500] | Loss=0.12310 | acc=0.9780 | tpr=0.9396 | fpr=0.0213 | 7788.7 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.12206 | acc=0.9782 | tpr=0.9395 | fpr=0.0211 | 14109.4 samples/s | 55.1 steps/s
Avg test loss: 0.12190, Avg test acc: 0.97826, Avg tpr: 0.93978, Avg fpr: 0.02104, total FA: 2922

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10905 | acc=0.9820 | tpr=0.8894 | fpr=0.0163 | 4067.1 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.11305 | acc=0.9821 | tpr=0.9104 | fpr=0.0166 | 7952.9 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.11763 | acc=0.9810 | tpr=0.9063 | fpr=0.0176 | 8479.4 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.11895 | acc=0.9811 | tpr=0.9115 | fpr=0.0177 | 8395.3 samples/s | 32.8 steps/s
[Step= 250] | Loss=0.11824 | acc=0.9811 | tpr=0.9083 | fpr=0.0176 | 7941.4 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.12012 | acc=0.9807 | tpr=0.9084 | fpr=0.0180 | 7994.9 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.12041 | acc=0.9805 | tpr=0.9117 | fpr=0.0183 | 8180.1 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.12164 | acc=0.9804 | tpr=0.9075 | fpr=0.0183 | 7730.9 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.12459 | acc=0.9801 | tpr=0.9080 | fpr=0.0186 | 7725.6 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.12414 | acc=0.9802 | tpr=0.9106 | fpr=0.0185 | 8112.9 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.12326 | acc=0.9804 | tpr=0.9101 | fpr=0.0183 | 14772.7 samples/s | 57.7 steps/s
Avg test loss: 0.12300, Avg test acc: 0.98039, Avg tpr: 0.90967, Avg fpr: 0.01833, total FA: 2545

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10902 | acc=0.9793 | tpr=0.9381 | fpr=0.0200 | 4015.9 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.11300 | acc=0.9792 | tpr=0.9574 | fpr=0.0204 | 8100.7 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.11713 | acc=0.9783 | tpr=0.9539 | fpr=0.0212 | 8124.3 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.11942 | acc=0.9783 | tpr=0.9563 | fpr=0.0213 | 8178.1 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.11881 | acc=0.9782 | tpr=0.9537 | fpr=0.0214 | 8041.7 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.12118 | acc=0.9777 | tpr=0.9549 | fpr=0.0218 | 8067.7 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.12116 | acc=0.9776 | tpr=0.9549 | fpr=0.0220 | 8156.1 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.12257 | acc=0.9774 | tpr=0.9524 | fpr=0.0221 | 7575.4 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.12544 | acc=0.9771 | tpr=0.9513 | fpr=0.0224 | 7857.8 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.12500 | acc=0.9772 | tpr=0.9533 | fpr=0.0224 | 8076.6 samples/s | 31.5 steps/s
[Step= 550] | Loss=0.12392 | acc=0.9774 | tpr=0.9522 | fpr=0.0222 | 13959.1 samples/s | 54.5 steps/s
Avg test loss: 0.12376, Avg test acc: 0.97741, Avg tpr: 0.95246, Avg fpr: 0.02214, total FA: 3074

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11524 | acc=0.9808 | tpr=0.9204 | fpr=0.0181 | 4112.4 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.12037 | acc=0.9802 | tpr=0.9382 | fpr=0.0190 | 7929.7 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.12518 | acc=0.9794 | tpr=0.9395 | fpr=0.0198 | 8154.9 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.12751 | acc=0.9793 | tpr=0.9475 | fpr=0.0201 | 7808.8 samples/s | 30.5 steps/s
[Step= 250] | Loss=0.12623 | acc=0.9791 | tpr=0.9432 | fpr=0.0203 | 8241.0 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.12822 | acc=0.9788 | tpr=0.9433 | fpr=0.0205 | 7750.9 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.12822 | acc=0.9787 | tpr=0.9461 | fpr=0.0207 | 8241.5 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.12921 | acc=0.9786 | tpr=0.9420 | fpr=0.0207 | 7889.1 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.13236 | acc=0.9783 | tpr=0.9416 | fpr=0.0210 | 7990.6 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.13199 | acc=0.9784 | tpr=0.9436 | fpr=0.0210 | 7500.3 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.13110 | acc=0.9786 | tpr=0.9435 | fpr=0.0208 | 14095.4 samples/s | 55.1 steps/s
Avg test loss: 0.13093, Avg test acc: 0.97859, Avg tpr: 0.94334, Avg fpr: 0.02077, total FA: 2884

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12488 | acc=0.9804 | tpr=0.9204 | fpr=0.0185 | 3958.8 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.12984 | acc=0.9803 | tpr=0.9446 | fpr=0.0190 | 7755.4 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.13552 | acc=0.9789 | tpr=0.9452 | fpr=0.0205 | 7913.5 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.13807 | acc=0.9787 | tpr=0.9497 | fpr=0.0208 | 8078.2 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.13665 | acc=0.9787 | tpr=0.9459 | fpr=0.0207 | 7819.9 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.13936 | acc=0.9783 | tpr=0.9469 | fpr=0.0211 | 8092.1 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.13994 | acc=0.9780 | tpr=0.9487 | fpr=0.0214 | 7826.3 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.14121 | acc=0.9778 | tpr=0.9447 | fpr=0.0216 | 7852.9 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.14438 | acc=0.9775 | tpr=0.9440 | fpr=0.0219 | 7864.7 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.14386 | acc=0.9775 | tpr=0.9441 | fpr=0.0219 | 8102.7 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.14297 | acc=0.9777 | tpr=0.9427 | fpr=0.0217 | 14341.0 samples/s | 56.0 steps/s
Avg test loss: 0.14273, Avg test acc: 0.97772, Avg tpr: 0.94295, Avg fpr: 0.02165, total FA: 3006

server round 33/50

clients selected: [2 3 4 5 7]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=30001 Epoch=146.2] | Loss=0.02401 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.086 | L2-Norm(final)=12.049 | 3731.7 samples/s | 58.3 steps/s
[Step=30050 Epoch=146.4] | Loss=0.02854 | Reg=0.00102 | acc=0.9688 | L2-Norm=10.099 | L2-Norm(final)=12.041 | 4819.8 samples/s | 75.3 steps/s
[Step=30100 Epoch=146.7] | Loss=0.02689 | Reg=0.00102 | acc=0.9688 | L2-Norm=10.110 | L2-Norm(final)=12.039 | 5223.2 samples/s | 81.6 steps/s
[Step=30150 Epoch=146.9] | Loss=0.02411 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.120 | L2-Norm(final)=12.039 | 5124.6 samples/s | 80.1 steps/s
[Step=30200 Epoch=147.1] | Loss=0.02321 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.128 | L2-Norm(final)=12.042 | 7175.0 samples/s | 112.1 steps/s
[Step=30250 Epoch=147.4] | Loss=0.02197 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.136 | L2-Norm(final)=12.045 | 1778.4 samples/s | 27.8 steps/s
[Step=30300 Epoch=147.6] | Loss=0.02093 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.144 | L2-Norm(final)=12.049 | 5239.2 samples/s | 81.9 steps/s
[Step=30350 Epoch=147.9] | Loss=0.02027 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.151 | L2-Norm(final)=12.055 | 5271.3 samples/s | 82.4 steps/s
[Step=30400 Epoch=148.1] | Loss=0.01961 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.159 | L2-Norm(final)=12.060 | 6428.7 samples/s | 100.4 steps/s
[Step=30450 Epoch=148.4] | Loss=0.01916 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.167 | L2-Norm(final)=12.066 | 1807.1 samples/s | 28.2 steps/s
[Step=30500 Epoch=148.6] | Loss=0.01838 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.174 | L2-Norm(final)=12.072 | 5114.7 samples/s | 79.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=148.6] | Loss=0.01007 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.250 | L2-Norm(final)=12.136 | 3957.5 samples/s | 61.8 steps/s
[Step=30550 Epoch=148.9] | Loss=0.01642 | Reg=0.00105 | acc=0.9688 | L2-Norm=10.262 | L2-Norm(final)=12.143 | 4043.3 samples/s | 63.2 steps/s
[Step=30600 Epoch=149.1] | Loss=0.01667 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.277 | L2-Norm(final)=12.151 | 4594.7 samples/s | 71.8 steps/s
[Step=30650 Epoch=149.3] | Loss=0.01516 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.290 | L2-Norm(final)=12.158 | 4638.8 samples/s | 72.5 steps/s
[Step=30700 Epoch=149.6] | Loss=0.01474 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.300 | L2-Norm(final)=12.164 | 6279.8 samples/s | 98.1 steps/s
[Step=30750 Epoch=149.8] | Loss=0.01362 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.309 | L2-Norm(final)=12.170 | 1744.0 samples/s | 27.3 steps/s
[Step=30800 Epoch=150.1] | Loss=0.01273 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.318 | L2-Norm(final)=12.176 | 4578.0 samples/s | 71.5 steps/s
[Step=30850 Epoch=150.3] | Loss=0.01181 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.326 | L2-Norm(final)=12.182 | 4666.5 samples/s | 72.9 steps/s
[Step=30900 Epoch=150.6] | Loss=0.01110 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.333 | L2-Norm(final)=12.187 | 5746.7 samples/s | 89.8 steps/s
[Step=30950 Epoch=150.8] | Loss=0.01044 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.339 | L2-Norm(final)=12.192 | 1795.2 samples/s | 28.1 steps/s
[Step=31000 Epoch=151.0] | Loss=0.00981 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.345 | L2-Norm(final)=12.197 | 4611.3 samples/s | 72.1 steps/s
[Step=31050 Epoch=151.3] | Loss=0.00937 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.351 | L2-Norm(final)=12.202 | 4539.8 samples/s | 70.9 steps/s
[Step=31100 Epoch=151.5] | Loss=0.00911 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.356 | L2-Norm(final)=12.206 | 5067.7 samples/s | 79.2 steps/s
[Step=31150 Epoch=151.8] | Loss=0.00872 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.361 | L2-Norm(final)=12.210 | 1804.9 samples/s | 28.2 steps/s
[Step=31200 Epoch=152.0] | Loss=0.00833 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.366 | L2-Norm(final)=12.214 | 4471.0 samples/s | 69.9 steps/s
[Step=31250 Epoch=152.3] | Loss=0.00807 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.370 | L2-Norm(final)=12.218 | 4518.1 samples/s | 70.6 steps/s
[Step=31300 Epoch=152.5] | Loss=0.00781 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.374 | L2-Norm(final)=12.222 | 4868.4 samples/s | 76.1 steps/s
[Step=31350 Epoch=152.8] | Loss=0.00760 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.378 | L2-Norm(final)=12.226 | 1879.0 samples/s | 29.4 steps/s
[Step=31400 Epoch=153.0] | Loss=0.00739 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.382 | L2-Norm(final)=12.229 | 4660.6 samples/s | 72.8 steps/s
[Step=31450 Epoch=153.2] | Loss=0.00720 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.386 | L2-Norm(final)=12.233 | 4525.6 samples/s | 70.7 steps/s
[Step=31500 Epoch=153.5] | Loss=0.00699 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.390 | L2-Norm(final)=12.236 | 4621.4 samples/s | 72.2 steps/s
[Step=31550 Epoch=153.7] | Loss=0.00683 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.393 | L2-Norm(final)=12.240 | 1908.2 samples/s | 29.8 steps/s
[Step=31600 Epoch=154.0] | Loss=0.00667 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.397 | L2-Norm(final)=12.243 | 4638.3 samples/s | 72.5 steps/s
[Step=31650 Epoch=154.2] | Loss=0.00651 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.400 | L2-Norm(final)=12.246 | 4586.0 samples/s | 71.7 steps/s
[Step=31700 Epoch=154.5] | Loss=0.00637 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.403 | L2-Norm(final)=12.249 | 4595.3 samples/s | 71.8 steps/s
[Step=31750 Epoch=154.7] | Loss=0.00628 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.407 | L2-Norm(final)=12.252 | 1905.9 samples/s | 29.8 steps/s
[Step=31800 Epoch=154.9] | Loss=0.00613 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.410 | L2-Norm(final)=12.255 | 4633.5 samples/s | 72.4 steps/s
[Step=31850 Epoch=155.2] | Loss=0.00594 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.413 | L2-Norm(final)=12.258 | 4539.6 samples/s | 70.9 steps/s
[Step=31900 Epoch=155.4] | Loss=0.00588 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.416 | L2-Norm(final)=12.261 | 4502.6 samples/s | 70.4 steps/s
[Step=31950 Epoch=155.7] | Loss=0.00587 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.419 | L2-Norm(final)=12.264 | 1940.5 samples/s | 30.3 steps/s
[Step=32000 Epoch=155.9] | Loss=0.00579 | Reg=0.00109 | acc=1.0000 | L2-Norm=10.422 | L2-Norm(final)=12.267 | 4518.6 samples/s | 70.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step32000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=30001 Epoch=146.3] | Loss=0.01535 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.086 | L2-Norm(final)=11.587 | 3674.7 samples/s | 57.4 steps/s
[Step=30050 Epoch=146.5] | Loss=0.02557 | Reg=0.00102 | acc=0.9688 | L2-Norm=10.094 | L2-Norm(final)=11.582 | 5046.6 samples/s | 78.9 steps/s
[Step=30100 Epoch=146.8] | Loss=0.02488 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.103 | L2-Norm(final)=11.580 | 5071.9 samples/s | 79.2 steps/s
[Step=30150 Epoch=147.0] | Loss=0.02298 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.112 | L2-Norm(final)=11.583 | 5097.3 samples/s | 79.6 steps/s
[Step=30200 Epoch=147.3] | Loss=0.02301 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.120 | L2-Norm(final)=11.585 | 7365.9 samples/s | 115.1 steps/s
[Step=30250 Epoch=147.5] | Loss=0.02119 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.128 | L2-Norm(final)=11.588 | 1801.0 samples/s | 28.1 steps/s
[Step=30300 Epoch=147.8] | Loss=0.02046 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.136 | L2-Norm(final)=11.593 | 5025.2 samples/s | 78.5 steps/s
[Step=30350 Epoch=148.0] | Loss=0.01968 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.144 | L2-Norm(final)=11.598 | 5181.4 samples/s | 81.0 steps/s
[Step=30400 Epoch=148.2] | Loss=0.01892 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.152 | L2-Norm(final)=11.604 | 6706.5 samples/s | 104.8 steps/s
[Step=30450 Epoch=148.5] | Loss=0.01818 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.160 | L2-Norm(final)=11.610 | 1867.5 samples/s | 29.2 steps/s
[Step=30500 Epoch=148.7] | Loss=0.01764 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.168 | L2-Norm(final)=11.617 | 5179.1 samples/s | 80.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=148.7] | Loss=0.01310 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.247 | L2-Norm(final)=11.684 | 3812.8 samples/s | 59.6 steps/s
[Step=30550 Epoch=149.0] | Loss=0.01278 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.260 | L2-Norm(final)=11.692 | 4180.4 samples/s | 65.3 steps/s
[Step=30600 Epoch=149.2] | Loss=0.01361 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.274 | L2-Norm(final)=11.699 | 4634.3 samples/s | 72.4 steps/s
[Step=30650 Epoch=149.5] | Loss=0.01396 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.286 | L2-Norm(final)=11.704 | 4677.7 samples/s | 73.1 steps/s
[Step=30700 Epoch=149.7] | Loss=0.01368 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.297 | L2-Norm(final)=11.710 | 6118.7 samples/s | 95.6 steps/s
[Step=30750 Epoch=150.0] | Loss=0.01212 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.306 | L2-Norm(final)=11.715 | 1754.4 samples/s | 27.4 steps/s
[Step=30800 Epoch=150.2] | Loss=0.01097 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.315 | L2-Norm(final)=11.720 | 4604.2 samples/s | 71.9 steps/s
[Step=30850 Epoch=150.4] | Loss=0.01021 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.322 | L2-Norm(final)=11.726 | 4565.7 samples/s | 71.3 steps/s
[Step=30900 Epoch=150.7] | Loss=0.00975 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.329 | L2-Norm(final)=11.731 | 5664.1 samples/s | 88.5 steps/s
[Step=30950 Epoch=150.9] | Loss=0.00930 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.335 | L2-Norm(final)=11.735 | 1797.6 samples/s | 28.1 steps/s
[Step=31000 Epoch=151.2] | Loss=0.00869 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.340 | L2-Norm(final)=11.740 | 4526.4 samples/s | 70.7 steps/s
[Step=31050 Epoch=151.4] | Loss=0.00832 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.345 | L2-Norm(final)=11.744 | 4558.4 samples/s | 71.2 steps/s
[Step=31100 Epoch=151.7] | Loss=0.00792 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.350 | L2-Norm(final)=11.748 | 5253.4 samples/s | 82.1 steps/s
[Step=31150 Epoch=151.9] | Loss=0.00755 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.355 | L2-Norm(final)=11.752 | 1817.9 samples/s | 28.4 steps/s
[Step=31200 Epoch=152.1] | Loss=0.00738 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.359 | L2-Norm(final)=11.756 | 4541.8 samples/s | 71.0 steps/s
[Step=31250 Epoch=152.4] | Loss=0.00716 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.363 | L2-Norm(final)=11.760 | 4548.6 samples/s | 71.1 steps/s
[Step=31300 Epoch=152.6] | Loss=0.00692 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.367 | L2-Norm(final)=11.763 | 4863.9 samples/s | 76.0 steps/s
[Step=31350 Epoch=152.9] | Loss=0.00664 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.371 | L2-Norm(final)=11.767 | 1846.7 samples/s | 28.9 steps/s
[Step=31400 Epoch=153.1] | Loss=0.00638 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.375 | L2-Norm(final)=11.770 | 4621.0 samples/s | 72.2 steps/s
[Step=31450 Epoch=153.4] | Loss=0.00628 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.379 | L2-Norm(final)=11.774 | 4541.9 samples/s | 71.0 steps/s
[Step=31500 Epoch=153.6] | Loss=0.00620 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.382 | L2-Norm(final)=11.777 | 4671.9 samples/s | 73.0 steps/s
[Step=31550 Epoch=153.9] | Loss=0.00604 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.385 | L2-Norm(final)=11.780 | 1951.8 samples/s | 30.5 steps/s
[Step=31600 Epoch=154.1] | Loss=0.00588 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.389 | L2-Norm(final)=11.784 | 4776.8 samples/s | 74.6 steps/s
[Step=31650 Epoch=154.3] | Loss=0.00569 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.392 | L2-Norm(final)=11.787 | 4504.0 samples/s | 70.4 steps/s
[Step=31700 Epoch=154.6] | Loss=0.00556 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.395 | L2-Norm(final)=11.790 | 4695.0 samples/s | 73.4 steps/s
[Step=31750 Epoch=154.8] | Loss=0.00549 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.398 | L2-Norm(final)=11.793 | 1910.3 samples/s | 29.8 steps/s
[Step=31800 Epoch=155.1] | Loss=0.00540 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.401 | L2-Norm(final)=11.796 | 4692.1 samples/s | 73.3 steps/s
[Step=31850 Epoch=155.3] | Loss=0.00526 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.404 | L2-Norm(final)=11.799 | 4594.6 samples/s | 71.8 steps/s
[Step=31900 Epoch=155.6] | Loss=0.00520 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.407 | L2-Norm(final)=11.802 | 4639.0 samples/s | 72.5 steps/s
[Step=31950 Epoch=155.8] | Loss=0.00515 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.410 | L2-Norm(final)=11.804 | 1919.3 samples/s | 30.0 steps/s
[Step=32000 Epoch=156.0] | Loss=0.00506 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.413 | L2-Norm(final)=11.807 | 4514.3 samples/s | 70.5 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step32000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=38001 Epoch=186.4] | Loss=0.04979 | Reg=0.00102 | acc=0.9688 | L2-Norm=10.086 | L2-Norm(final)=12.432 | 3748.7 samples/s | 58.6 steps/s
[Step=38050 Epoch=186.6] | Loss=0.01844 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.097 | L2-Norm(final)=12.428 | 4854.7 samples/s | 75.9 steps/s
[Step=38100 Epoch=186.8] | Loss=0.01984 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.108 | L2-Norm(final)=12.427 | 5103.9 samples/s | 79.7 steps/s
[Step=38150 Epoch=187.1] | Loss=0.01840 | Reg=0.00102 | acc=0.9531 | L2-Norm=10.117 | L2-Norm(final)=12.428 | 5027.9 samples/s | 78.6 steps/s
[Step=38200 Epoch=187.3] | Loss=0.01791 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.125 | L2-Norm(final)=12.430 | 7209.2 samples/s | 112.6 steps/s
[Step=38250 Epoch=187.6] | Loss=0.01708 | Reg=0.00103 | acc=0.9688 | L2-Norm=10.134 | L2-Norm(final)=12.433 | 1787.4 samples/s | 27.9 steps/s
[Step=38300 Epoch=187.8] | Loss=0.01622 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.141 | L2-Norm(final)=12.437 | 4996.9 samples/s | 78.1 steps/s
[Step=38350 Epoch=188.1] | Loss=0.01544 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.149 | L2-Norm(final)=12.442 | 5169.4 samples/s | 80.8 steps/s
[Step=38400 Epoch=188.3] | Loss=0.01525 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.156 | L2-Norm(final)=12.447 | 6754.8 samples/s | 105.5 steps/s
[Step=38450 Epoch=188.6] | Loss=0.01461 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.163 | L2-Norm(final)=12.453 | 1807.9 samples/s | 28.2 steps/s
[Step=38500 Epoch=188.8] | Loss=0.01420 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.170 | L2-Norm(final)=12.458 | 4521.0 samples/s | 70.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=188.8] | Loss=0.00548 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.240 | L2-Norm(final)=12.518 | 3750.2 samples/s | 58.6 steps/s
[Step=38550 Epoch=189.0] | Loss=0.01030 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.251 | L2-Norm(final)=12.524 | 3985.5 samples/s | 62.3 steps/s
[Step=38600 Epoch=189.3] | Loss=0.01224 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.262 | L2-Norm(final)=12.529 | 4653.3 samples/s | 72.7 steps/s
[Step=38650 Epoch=189.5] | Loss=0.01307 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.272 | L2-Norm(final)=12.534 | 4560.5 samples/s | 71.3 steps/s
[Step=38700 Epoch=189.8] | Loss=0.01233 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.282 | L2-Norm(final)=12.539 | 6228.7 samples/s | 97.3 steps/s
[Step=38750 Epoch=190.0] | Loss=0.01127 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.290 | L2-Norm(final)=12.543 | 1736.3 samples/s | 27.1 steps/s
[Step=38800 Epoch=190.3] | Loss=0.01022 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.297 | L2-Norm(final)=12.548 | 4516.5 samples/s | 70.6 steps/s
[Step=38850 Epoch=190.5] | Loss=0.00977 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.304 | L2-Norm(final)=12.552 | 4544.7 samples/s | 71.0 steps/s
[Step=38900 Epoch=190.8] | Loss=0.00923 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.310 | L2-Norm(final)=12.556 | 5810.9 samples/s | 90.8 steps/s
[Step=38950 Epoch=191.0] | Loss=0.00870 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.315 | L2-Norm(final)=12.560 | 1752.7 samples/s | 27.4 steps/s
[Step=39000 Epoch=191.2] | Loss=0.00825 | Reg=0.00107 | acc=0.9688 | L2-Norm=10.320 | L2-Norm(final)=12.564 | 4605.5 samples/s | 72.0 steps/s
[Step=39050 Epoch=191.5] | Loss=0.00798 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.325 | L2-Norm(final)=12.567 | 4646.0 samples/s | 72.6 steps/s
[Step=39100 Epoch=191.7] | Loss=0.00764 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.329 | L2-Norm(final)=12.571 | 5718.9 samples/s | 89.4 steps/s
[Step=39150 Epoch=192.0] | Loss=0.00733 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.334 | L2-Norm(final)=12.574 | 1795.8 samples/s | 28.1 steps/s
[Step=39200 Epoch=192.2] | Loss=0.00703 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.338 | L2-Norm(final)=12.578 | 4566.8 samples/s | 71.4 steps/s
[Step=39250 Epoch=192.5] | Loss=0.00683 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.342 | L2-Norm(final)=12.581 | 4614.6 samples/s | 72.1 steps/s
[Step=39300 Epoch=192.7] | Loss=0.00664 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.345 | L2-Norm(final)=12.584 | 5388.9 samples/s | 84.2 steps/s
[Step=39350 Epoch=193.0] | Loss=0.00643 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.349 | L2-Norm(final)=12.587 | 1791.7 samples/s | 28.0 steps/s
[Step=39400 Epoch=193.2] | Loss=0.00625 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.353 | L2-Norm(final)=12.591 | 4627.5 samples/s | 72.3 steps/s
[Step=39450 Epoch=193.5] | Loss=0.00611 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.356 | L2-Norm(final)=12.594 | 4516.1 samples/s | 70.6 steps/s
[Step=39500 Epoch=193.7] | Loss=0.00590 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=12.597 | 5079.9 samples/s | 79.4 steps/s
[Step=39550 Epoch=193.9] | Loss=0.00576 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.362 | L2-Norm(final)=12.600 | 1840.4 samples/s | 28.8 steps/s
[Step=39600 Epoch=194.2] | Loss=0.00560 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.365 | L2-Norm(final)=12.602 | 4599.8 samples/s | 71.9 steps/s
[Step=39650 Epoch=194.4] | Loss=0.00546 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.368 | L2-Norm(final)=12.605 | 4658.7 samples/s | 72.8 steps/s
[Step=39700 Epoch=194.7] | Loss=0.00542 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.371 | L2-Norm(final)=12.608 | 4879.7 samples/s | 76.2 steps/s
[Step=39750 Epoch=194.9] | Loss=0.00530 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.373 | L2-Norm(final)=12.611 | 1882.9 samples/s | 29.4 steps/s
[Step=39800 Epoch=195.2] | Loss=0.00518 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.376 | L2-Norm(final)=12.613 | 4733.4 samples/s | 74.0 steps/s
[Step=39850 Epoch=195.4] | Loss=0.00508 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.378 | L2-Norm(final)=12.616 | 4653.8 samples/s | 72.7 steps/s
[Step=39900 Epoch=195.7] | Loss=0.00500 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.381 | L2-Norm(final)=12.618 | 4736.1 samples/s | 74.0 steps/s
[Step=39950 Epoch=195.9] | Loss=0.00492 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.383 | L2-Norm(final)=12.621 | 1887.1 samples/s | 29.5 steps/s
[Step=40000 Epoch=196.2] | Loss=0.00483 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.386 | L2-Norm(final)=12.623 | 4621.9 samples/s | 72.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step40000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=22001 Epoch=208.5] | Loss=0.00030 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.086 | L2-Norm(final)=7.099 | 3835.3 samples/s | 59.9 steps/s
[Step=22050 Epoch=208.9] | Loss=0.00174 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.102 | L2-Norm(final)=7.102 | 4409.3 samples/s | 68.9 steps/s
[Step=22100 Epoch=209.4] | Loss=0.00116 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.119 | L2-Norm(final)=7.112 | 6709.9 samples/s | 104.8 steps/s
[Step=22150 Epoch=209.9] | Loss=0.00084 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.127 | L2-Norm(final)=7.120 | 1765.0 samples/s | 27.6 steps/s
[Step=22200 Epoch=210.4] | Loss=0.00067 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.131 | L2-Norm(final)=7.127 | 6178.4 samples/s | 96.5 steps/s
[Step=22250 Epoch=210.8] | Loss=0.00055 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.133 | L2-Norm(final)=7.132 | 1730.5 samples/s | 27.0 steps/s
[Step=22300 Epoch=211.3] | Loss=0.00048 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.133 | L2-Norm(final)=7.137 | 5711.0 samples/s | 89.2 steps/s
[Step=22350 Epoch=211.8] | Loss=0.00042 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.133 | L2-Norm(final)=7.142 | 1853.0 samples/s | 29.0 steps/s
[Step=22400 Epoch=212.3] | Loss=0.00038 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.133 | L2-Norm(final)=7.147 | 5429.4 samples/s | 84.8 steps/s
[Step=22450 Epoch=212.7] | Loss=0.00035 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.132 | L2-Norm(final)=7.151 | 1872.5 samples/s | 29.3 steps/s
[Step=22500 Epoch=213.2] | Loss=0.00032 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.131 | L2-Norm(final)=7.156 | 5137.8 samples/s | 80.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=22501 Epoch=213.2] | Loss=0.00005 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.121 | L2-Norm(final)=7.198 | 3555.5 samples/s | 55.6 steps/s
[Step=22550 Epoch=213.7] | Loss=0.00006 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.111 | L2-Norm(final)=7.200 | 4310.0 samples/s | 67.3 steps/s
[Step=22600 Epoch=214.2] | Loss=0.00005 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.103 | L2-Norm(final)=7.203 | 6045.3 samples/s | 94.5 steps/s
[Step=22650 Epoch=214.6] | Loss=0.00011 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.098 | L2-Norm(final)=7.206 | 1695.6 samples/s | 26.5 steps/s
[Step=22700 Epoch=215.1] | Loss=0.00008 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.095 | L2-Norm(final)=7.209 | 5458.2 samples/s | 85.3 steps/s
[Step=22750 Epoch=215.6] | Loss=0.00007 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.091 | L2-Norm(final)=7.211 | 1737.3 samples/s | 27.1 steps/s
[Step=22800 Epoch=216.0] | Loss=0.00006 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.085 | L2-Norm(final)=7.213 | 5140.6 samples/s | 80.3 steps/s
[Step=22850 Epoch=216.5] | Loss=0.00005 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.078 | L2-Norm(final)=7.214 | 1774.0 samples/s | 27.7 steps/s
[Step=22900 Epoch=217.0] | Loss=0.00004 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.071 | L2-Norm(final)=7.215 | 4632.1 samples/s | 72.4 steps/s
[Step=22950 Epoch=217.5] | Loss=0.00004 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.063 | L2-Norm(final)=7.216 | 1829.9 samples/s | 28.6 steps/s
[Step=23000 Epoch=217.9] | Loss=0.00004 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.055 | L2-Norm(final)=7.217 | 4467.9 samples/s | 69.8 steps/s
[Step=23050 Epoch=218.4] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.047 | L2-Norm(final)=7.217 | 1886.8 samples/s | 29.5 steps/s
[Step=23100 Epoch=218.9] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.038 | L2-Norm(final)=7.218 | 4339.0 samples/s | 67.8 steps/s
[Step=23150 Epoch=219.4] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.030 | L2-Norm(final)=7.218 | 1862.5 samples/s | 29.1 steps/s
[Step=23200 Epoch=219.8] | Loss=0.00003 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.021 | L2-Norm(final)=7.219 | 4345.8 samples/s | 67.9 steps/s
[Step=23250 Epoch=220.3] | Loss=0.00002 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=7.219 | 1871.9 samples/s | 29.2 steps/s
[Step=23300 Epoch=220.8] | Loss=0.00002 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.003 | L2-Norm(final)=7.220 | 4375.8 samples/s | 68.4 steps/s
[Step=23350 Epoch=221.3] | Loss=0.00002 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.993 | L2-Norm(final)=7.220 | 1895.3 samples/s | 29.6 steps/s
[Step=23400 Epoch=221.7] | Loss=0.00002 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.984 | L2-Norm(final)=7.220 | 4277.2 samples/s | 66.8 steps/s
[Step=23450 Epoch=222.2] | Loss=0.00002 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.974 | L2-Norm(final)=7.221 | 6060.6 samples/s | 94.7 steps/s
[Step=23500 Epoch=222.7] | Loss=0.00002 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.964 | L2-Norm(final)=7.221 | 1710.3 samples/s | 26.7 steps/s
[Step=23550 Epoch=223.2] | Loss=0.00002 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.954 | L2-Norm(final)=7.221 | 5660.9 samples/s | 88.5 steps/s
[Step=23600 Epoch=223.6] | Loss=0.00002 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.944 | L2-Norm(final)=7.222 | 1723.6 samples/s | 26.9 steps/s
[Step=23650 Epoch=224.1] | Loss=0.00002 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.934 | L2-Norm(final)=7.222 | 5233.2 samples/s | 81.8 steps/s
[Step=23700 Epoch=224.6] | Loss=0.00002 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.924 | L2-Norm(final)=7.222 | 1730.2 samples/s | 27.0 steps/s
[Step=23750 Epoch=225.1] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.913 | L2-Norm(final)=7.223 | 4817.6 samples/s | 75.3 steps/s
[Step=23800 Epoch=225.5] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.903 | L2-Norm(final)=7.223 | 1788.9 samples/s | 28.0 steps/s
[Step=23850 Epoch=226.0] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.892 | L2-Norm(final)=7.223 | 4409.6 samples/s | 68.9 steps/s
[Step=23900 Epoch=226.5] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.881 | L2-Norm(final)=7.224 | 1827.0 samples/s | 28.5 steps/s
[Step=23950 Epoch=226.9] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.870 | L2-Norm(final)=7.224 | 4406.3 samples/s | 68.8 steps/s
[Step=24000 Epoch=227.4] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.859 | L2-Norm(final)=7.224 | 1867.3 samples/s | 29.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_0/client_state-step24000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=34001 Epoch=324.7] | Loss=0.02204 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.086 | L2-Norm(final)=8.370 | 3774.2 samples/s | 59.0 steps/s
[Step=34050 Epoch=325.2] | Loss=0.00198 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.105 | L2-Norm(final)=8.363 | 4370.3 samples/s | 68.3 steps/s
[Step=34100 Epoch=325.6] | Loss=0.00118 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.116 | L2-Norm(final)=8.368 | 7015.6 samples/s | 109.6 steps/s
[Step=34150 Epoch=326.1] | Loss=0.00084 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.121 | L2-Norm(final)=8.373 | 1777.8 samples/s | 27.8 steps/s
[Step=34200 Epoch=326.6] | Loss=0.00065 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.122 | L2-Norm(final)=8.377 | 6335.2 samples/s | 99.0 steps/s
[Step=34250 Epoch=327.1] | Loss=0.00053 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.123 | L2-Norm(final)=8.381 | 1755.0 samples/s | 27.4 steps/s
[Step=34300 Epoch=327.5] | Loss=0.00046 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.122 | L2-Norm(final)=8.384 | 5970.1 samples/s | 93.3 steps/s
[Step=34350 Epoch=328.0] | Loss=0.00040 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.121 | L2-Norm(final)=8.387 | 1783.1 samples/s | 27.9 steps/s
[Step=34400 Epoch=328.5] | Loss=0.00036 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.120 | L2-Norm(final)=8.390 | 5538.1 samples/s | 86.5 steps/s
[Step=34450 Epoch=329.0] | Loss=0.00033 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.119 | L2-Norm(final)=8.393 | 1918.2 samples/s | 30.0 steps/s
[Step=34500 Epoch=329.5] | Loss=0.00030 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.117 | L2-Norm(final)=8.396 | 5666.7 samples/s | 88.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=329.5] | Loss=0.00001 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.101 | L2-Norm(final)=8.423 | 3696.7 samples/s | 57.8 steps/s
[Step=34550 Epoch=329.9] | Loss=0.00007 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.095 | L2-Norm(final)=8.426 | 4358.0 samples/s | 68.1 steps/s
[Step=34600 Epoch=330.4] | Loss=0.00015 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.096 | L2-Norm(final)=8.429 | 5933.0 samples/s | 92.7 steps/s
[Step=34650 Epoch=330.9] | Loss=0.00078 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.101 | L2-Norm(final)=8.431 | 1668.9 samples/s | 26.1 steps/s
[Step=34700 Epoch=331.4] | Loss=0.00063 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.109 | L2-Norm(final)=8.433 | 5568.2 samples/s | 87.0 steps/s
[Step=34750 Epoch=331.8] | Loss=0.00051 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.113 | L2-Norm(final)=8.434 | 1718.7 samples/s | 26.9 steps/s
[Step=34800 Epoch=332.3] | Loss=0.00042 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.114 | L2-Norm(final)=8.434 | 5203.7 samples/s | 81.3 steps/s
[Step=34850 Epoch=332.8] | Loss=0.00036 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.115 | L2-Norm(final)=8.435 | 1766.8 samples/s | 27.6 steps/s
[Step=34900 Epoch=333.3] | Loss=0.00032 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.114 | L2-Norm(final)=8.435 | 4927.3 samples/s | 77.0 steps/s
[Step=34950 Epoch=333.8] | Loss=0.00028 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.113 | L2-Norm(final)=8.436 | 1755.9 samples/s | 27.4 steps/s
[Step=35000 Epoch=334.2] | Loss=0.00026 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.111 | L2-Norm(final)=8.436 | 4649.0 samples/s | 72.6 steps/s
[Step=35050 Epoch=334.7] | Loss=0.00023 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.110 | L2-Norm(final)=8.436 | 1812.7 samples/s | 28.3 steps/s
[Step=35100 Epoch=335.2] | Loss=0.00022 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.107 | L2-Norm(final)=8.437 | 4369.9 samples/s | 68.3 steps/s
[Step=35150 Epoch=335.7] | Loss=0.00020 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.105 | L2-Norm(final)=8.437 | 1824.6 samples/s | 28.5 steps/s
[Step=35200 Epoch=336.1] | Loss=0.00019 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.103 | L2-Norm(final)=8.437 | 4481.9 samples/s | 70.0 steps/s
[Step=35250 Epoch=336.6] | Loss=0.00017 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.100 | L2-Norm(final)=8.437 | 1870.6 samples/s | 29.2 steps/s
[Step=35300 Epoch=337.1] | Loss=0.00016 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.097 | L2-Norm(final)=8.438 | 4380.7 samples/s | 68.4 steps/s
[Step=35350 Epoch=337.6] | Loss=0.00015 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.094 | L2-Norm(final)=8.438 | 1869.7 samples/s | 29.2 steps/s
[Step=35400 Epoch=338.0] | Loss=0.00014 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.091 | L2-Norm(final)=8.438 | 4511.2 samples/s | 70.5 steps/s
[Step=35450 Epoch=338.5] | Loss=0.00014 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.088 | L2-Norm(final)=8.438 | 1828.9 samples/s | 28.6 steps/s
[Step=35500 Epoch=339.0] | Loss=0.00013 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.085 | L2-Norm(final)=8.438 | 3981.5 samples/s | 62.2 steps/s
[Step=35550 Epoch=339.5] | Loss=0.00012 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.082 | L2-Norm(final)=8.439 | 5912.6 samples/s | 92.4 steps/s
[Step=35600 Epoch=340.0] | Loss=0.00012 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.079 | L2-Norm(final)=8.439 | 1646.6 samples/s | 25.7 steps/s
[Step=35650 Epoch=340.4] | Loss=0.00011 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.075 | L2-Norm(final)=8.439 | 6039.0 samples/s | 94.4 steps/s
[Step=35700 Epoch=340.9] | Loss=0.00011 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.072 | L2-Norm(final)=8.439 | 1681.7 samples/s | 26.3 steps/s
[Step=35750 Epoch=341.4] | Loss=0.00011 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.068 | L2-Norm(final)=8.439 | 5550.4 samples/s | 86.7 steps/s
[Step=35800 Epoch=341.9] | Loss=0.00010 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.065 | L2-Norm(final)=8.439 | 1724.1 samples/s | 26.9 steps/s
[Step=35850 Epoch=342.3] | Loss=0.00010 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.061 | L2-Norm(final)=8.440 | 5450.5 samples/s | 85.2 steps/s
[Step=35900 Epoch=342.8] | Loss=0.00009 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.058 | L2-Norm(final)=8.440 | 1751.6 samples/s | 27.4 steps/s
[Step=35950 Epoch=343.3] | Loss=0.00009 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.054 | L2-Norm(final)=8.440 | 5057.7 samples/s | 79.0 steps/s
[Step=36000 Epoch=343.8] | Loss=0.00009 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.050 | L2-Norm(final)=8.440 | 1786.5 samples/s | 27.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08687 | acc=0.9628 | tpr=0.9749 | fpr=0.0634 | 4126.7 samples/s | 16.1 steps/s
Avg test loss: 0.08999, Avg test acc: 0.96158, Avg tpr: 0.97412, Avg fpr: 0.06602, total FA: 515

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08962 | acc=0.9620 | tpr=0.9780 | fpr=0.0726 | 4067.7 samples/s | 15.9 steps/s
Avg test loss: 0.09452, Avg test acc: 0.96041, Avg tpr: 0.97715, Avg fpr: 0.07640, total FA: 596

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08715 | acc=0.9605 | tpr=0.9770 | fpr=0.0751 | 4101.5 samples/s | 16.0 steps/s
Avg test loss: 0.09121, Avg test acc: 0.95957, Avg tpr: 0.97535, Avg fpr: 0.07512, total FA: 586

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.09040 | acc=0.9581 | tpr=0.9649 | fpr=0.0565 | 4089.6 samples/s | 16.0 steps/s
Avg test loss: 0.09369, Avg test acc: 0.95841, Avg tpr: 0.96532, Avg fpr: 0.05679, total FA: 443

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.09025 | acc=0.9616 | tpr=0.9673 | fpr=0.0508 | 4035.4 samples/s | 15.8 steps/s
Avg test loss: 0.09688, Avg test acc: 0.95949, Avg tpr: 0.96561, Avg fpr: 0.05397, total FA: 421

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.28510 | acc=0.2981 | tpr=0.0024 | fpr=0.0597 | 4113.0 samples/s | 16.1 steps/s
Avg test loss: 5.29868, Avg test acc: 0.29546, Avg tpr: 0.00303, Avg fpr: 0.06140, total FA: 479

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.87256 | acc=0.3111 | tpr=0.0045 | fpr=0.0230 | 4071.3 samples/s | 15.9 steps/s
Avg test loss: 4.88381, Avg test acc: 0.30916, Avg tpr: 0.00560, Avg fpr: 0.02320, total FA: 181

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.84140 | acc=0.3035 | tpr=0.0094 | fpr=0.0577 | 4080.6 samples/s | 15.9 steps/s
Avg test loss: 4.84805, Avg test acc: 0.30155, Avg tpr: 0.01026, Avg fpr: 0.05781, total FA: 451

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.30064 | acc=0.3022 | tpr=0.0046 | fpr=0.0515 | 4070.8 samples/s | 15.9 steps/s
Avg test loss: 5.31147, Avg test acc: 0.29942, Avg tpr: 0.00548, Avg fpr: 0.05410, total FA: 422

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.08761 | acc=0.3137 | tpr=0.0017 | fpr=0.0087 | 4070.9 samples/s | 15.9 steps/s
Avg test loss: 5.09724, Avg test acc: 0.31104, Avg tpr: 0.00210, Avg fpr: 0.00949, total FA: 74

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.51359 | acc=0.1196 | tpr=0.8761 | fpr=0.8940 | 4062.3 samples/s | 15.9 steps/s
[Step= 100] | Loss=5.46182 | acc=0.1208 | tpr=0.8550 | fpr=0.8929 | 8199.8 samples/s | 32.0 steps/s
[Step= 150] | Loss=5.46512 | acc=0.1191 | tpr=0.8674 | fpr=0.8947 | 7880.4 samples/s | 30.8 steps/s
[Step= 200] | Loss=5.46381 | acc=0.1184 | tpr=0.8667 | fpr=0.8952 | 7849.6 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.46715 | acc=0.1190 | tpr=0.8629 | fpr=0.8946 | 7928.4 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.46444 | acc=0.1183 | tpr=0.8589 | fpr=0.8952 | 8008.7 samples/s | 31.3 steps/s
[Step= 350] | Loss=5.45993 | acc=0.1180 | tpr=0.8560 | fpr=0.8954 | 8289.6 samples/s | 32.4 steps/s
[Step= 400] | Loss=5.46103 | acc=0.1183 | tpr=0.8523 | fpr=0.8950 | 7914.9 samples/s | 30.9 steps/s
[Step= 450] | Loss=5.46488 | acc=0.1180 | tpr=0.8481 | fpr=0.8953 | 8538.4 samples/s | 33.4 steps/s
[Step= 500] | Loss=5.46796 | acc=0.1179 | tpr=0.8493 | fpr=0.8954 | 7626.6 samples/s | 29.8 steps/s
[Step= 550] | Loss=5.46719 | acc=0.1176 | tpr=0.8528 | fpr=0.8957 | 15088.2 samples/s | 58.9 steps/s
Avg test loss: 5.46900, Avg test acc: 0.11757, Avg tpr: 0.85261, Avg fpr: 0.89579, total FA: 124379

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.45705 | acc=0.1152 | tpr=0.8673 | fpr=0.8984 | 4094.7 samples/s | 16.0 steps/s
[Step= 100] | Loss=5.40373 | acc=0.1171 | tpr=0.8507 | fpr=0.8966 | 8109.3 samples/s | 31.7 steps/s
[Step= 150] | Loss=5.40661 | acc=0.1150 | tpr=0.8631 | fpr=0.8988 | 8051.1 samples/s | 31.4 steps/s
[Step= 200] | Loss=5.40633 | acc=0.1148 | tpr=0.8568 | fpr=0.8987 | 7785.0 samples/s | 30.4 steps/s
[Step= 250] | Loss=5.40598 | acc=0.1155 | tpr=0.8524 | fpr=0.8979 | 7974.6 samples/s | 31.2 steps/s
[Step= 300] | Loss=5.40374 | acc=0.1149 | tpr=0.8516 | fpr=0.8985 | 8168.1 samples/s | 31.9 steps/s
[Step= 350] | Loss=5.39839 | acc=0.1144 | tpr=0.8485 | fpr=0.8989 | 8233.4 samples/s | 32.2 steps/s
[Step= 400] | Loss=5.39874 | acc=0.1145 | tpr=0.8452 | fpr=0.8988 | 8064.1 samples/s | 31.5 steps/s
[Step= 450] | Loss=5.40368 | acc=0.1141 | tpr=0.8418 | fpr=0.8991 | 8098.1 samples/s | 31.6 steps/s
[Step= 500] | Loss=5.40969 | acc=0.1139 | tpr=0.8436 | fpr=0.8993 | 8030.7 samples/s | 31.4 steps/s
[Step= 550] | Loss=5.40825 | acc=0.1138 | tpr=0.8456 | fpr=0.8995 | 14430.4 samples/s | 56.4 steps/s
Avg test loss: 5.40942, Avg test acc: 0.11379, Avg tpr: 0.84509, Avg fpr: 0.89950, total FA: 124894

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.75810 | acc=0.1130 | tpr=0.8319 | fpr=0.8999 | 4047.4 samples/s | 15.8 steps/s
[Step= 100] | Loss=5.70706 | acc=0.1158 | tpr=0.8316 | fpr=0.8976 | 8233.1 samples/s | 32.2 steps/s
[Step= 150] | Loss=5.71173 | acc=0.1139 | tpr=0.8458 | fpr=0.8996 | 7761.1 samples/s | 30.3 steps/s
[Step= 200] | Loss=5.71470 | acc=0.1129 | tpr=0.8470 | fpr=0.9004 | 7778.2 samples/s | 30.4 steps/s
[Step= 250] | Loss=5.71447 | acc=0.1134 | tpr=0.8463 | fpr=0.9000 | 7988.7 samples/s | 31.2 steps/s
[Step= 300] | Loss=5.71200 | acc=0.1133 | tpr=0.8495 | fpr=0.9001 | 7816.5 samples/s | 30.5 steps/s
[Step= 350] | Loss=5.71036 | acc=0.1130 | tpr=0.8472 | fpr=0.9003 | 7959.0 samples/s | 31.1 steps/s
[Step= 400] | Loss=5.71227 | acc=0.1132 | tpr=0.8463 | fpr=0.9001 | 8334.4 samples/s | 32.6 steps/s
[Step= 450] | Loss=5.71671 | acc=0.1125 | tpr=0.8418 | fpr=0.9008 | 7419.4 samples/s | 29.0 steps/s
[Step= 500] | Loss=5.71748 | acc=0.1124 | tpr=0.8401 | fpr=0.9007 | 7898.1 samples/s | 30.9 steps/s
[Step= 550] | Loss=5.71649 | acc=0.1124 | tpr=0.8420 | fpr=0.9008 | 13740.2 samples/s | 53.7 steps/s
Avg test loss: 5.71813, Avg test acc: 0.11234, Avg tpr: 0.84152, Avg fpr: 0.90091, total FA: 125090

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.79267 | acc=0.1459 | tpr=0.7434 | fpr=0.8649 | 4158.7 samples/s | 16.2 steps/s
[Step= 100] | Loss=4.74201 | acc=0.1473 | tpr=0.7143 | fpr=0.8633 | 7912.4 samples/s | 30.9 steps/s
[Step= 150] | Loss=4.73996 | acc=0.1460 | tpr=0.7219 | fpr=0.8646 | 7999.3 samples/s | 31.2 steps/s
[Step= 200] | Loss=4.73537 | acc=0.1462 | tpr=0.7246 | fpr=0.8644 | 7977.5 samples/s | 31.2 steps/s
[Step= 250] | Loss=4.73716 | acc=0.1462 | tpr=0.7293 | fpr=0.8644 | 7786.4 samples/s | 30.4 steps/s
[Step= 300] | Loss=4.73346 | acc=0.1455 | tpr=0.7295 | fpr=0.8652 | 8012.1 samples/s | 31.3 steps/s
[Step= 350] | Loss=4.72730 | acc=0.1453 | tpr=0.7295 | fpr=0.8653 | 7850.2 samples/s | 30.7 steps/s
[Step= 400] | Loss=4.73053 | acc=0.1450 | tpr=0.7303 | fpr=0.8657 | 7885.2 samples/s | 30.8 steps/s
[Step= 450] | Loss=4.73603 | acc=0.1446 | tpr=0.7259 | fpr=0.8660 | 8066.4 samples/s | 31.5 steps/s
[Step= 500] | Loss=4.73914 | acc=0.1444 | tpr=0.7251 | fpr=0.8661 | 7735.8 samples/s | 30.2 steps/s
[Step= 550] | Loss=4.73797 | acc=0.1441 | tpr=0.7270 | fpr=0.8665 | 14503.4 samples/s | 56.7 steps/s
Avg test loss: 4.73974, Avg test acc: 0.14407, Avg tpr: 0.72662, Avg fpr: 0.86652, total FA: 120314

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.91952 | acc=0.1412 | tpr=0.7035 | fpr=0.8689 | 4078.8 samples/s | 15.9 steps/s
[Step= 100] | Loss=4.86946 | acc=0.1444 | tpr=0.6780 | fpr=0.8656 | 8127.9 samples/s | 31.7 steps/s
[Step= 150] | Loss=4.86758 | acc=0.1432 | tpr=0.6729 | fpr=0.8666 | 8397.1 samples/s | 32.8 steps/s
[Step= 200] | Loss=4.86480 | acc=0.1425 | tpr=0.6689 | fpr=0.8670 | 7750.4 samples/s | 30.3 steps/s
[Step= 250] | Loss=4.86740 | acc=0.1426 | tpr=0.6672 | fpr=0.8670 | 7867.6 samples/s | 30.7 steps/s
[Step= 300] | Loss=4.86291 | acc=0.1424 | tpr=0.6735 | fpr=0.8673 | 7954.3 samples/s | 31.1 steps/s
[Step= 350] | Loss=4.85774 | acc=0.1417 | tpr=0.6763 | fpr=0.8680 | 8156.6 samples/s | 31.9 steps/s
[Step= 400] | Loss=4.86126 | acc=0.1418 | tpr=0.6756 | fpr=0.8679 | 7812.4 samples/s | 30.5 steps/s
[Step= 450] | Loss=4.86432 | acc=0.1414 | tpr=0.6719 | fpr=0.8683 | 8118.5 samples/s | 31.7 steps/s
[Step= 500] | Loss=4.86612 | acc=0.1411 | tpr=0.6705 | fpr=0.8685 | 7736.4 samples/s | 30.2 steps/s
[Step= 550] | Loss=4.86557 | acc=0.1409 | tpr=0.6713 | fpr=0.8688 | 14246.1 samples/s | 55.6 steps/s
Avg test loss: 4.86778, Avg test acc: 0.14083, Avg tpr: 0.67116, Avg fpr: 0.86881, total FA: 120633

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10230 | acc=0.9804 | tpr=0.9248 | fpr=0.0186 | 4168.6 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.10555 | acc=0.9801 | tpr=0.9446 | fpr=0.0192 | 7620.0 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.10932 | acc=0.9792 | tpr=0.9481 | fpr=0.0202 | 7785.2 samples/s | 30.4 steps/s
[Step= 200] | Loss=0.11158 | acc=0.9792 | tpr=0.9519 | fpr=0.0203 | 7953.4 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.11114 | acc=0.9793 | tpr=0.9467 | fpr=0.0201 | 8370.7 samples/s | 32.7 steps/s
[Step= 300] | Loss=0.11319 | acc=0.9790 | tpr=0.9455 | fpr=0.0204 | 7901.4 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.11306 | acc=0.9789 | tpr=0.9430 | fpr=0.0205 | 7755.1 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.11443 | acc=0.9787 | tpr=0.9393 | fpr=0.0206 | 8006.5 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.11735 | acc=0.9784 | tpr=0.9387 | fpr=0.0209 | 8267.9 samples/s | 32.3 steps/s
[Step= 500] | Loss=0.11714 | acc=0.9784 | tpr=0.9401 | fpr=0.0209 | 7634.9 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.11620 | acc=0.9785 | tpr=0.9399 | fpr=0.0208 | 14610.4 samples/s | 57.1 steps/s
Avg test loss: 0.11602, Avg test acc: 0.97855, Avg tpr: 0.94017, Avg fpr: 0.02076, total FA: 2882

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10905 | acc=0.9820 | tpr=0.8894 | fpr=0.0163 | 4005.2 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.11305 | acc=0.9821 | tpr=0.9104 | fpr=0.0166 | 8288.8 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.11763 | acc=0.9810 | tpr=0.9063 | fpr=0.0176 | 8368.0 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.11895 | acc=0.9811 | tpr=0.9115 | fpr=0.0177 | 7892.0 samples/s | 30.8 steps/s
[Step= 250] | Loss=0.11824 | acc=0.9811 | tpr=0.9083 | fpr=0.0176 | 7887.7 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.12012 | acc=0.9807 | tpr=0.9084 | fpr=0.0180 | 8070.6 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.12041 | acc=0.9805 | tpr=0.9117 | fpr=0.0183 | 7960.2 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.12164 | acc=0.9804 | tpr=0.9075 | fpr=0.0183 | 7902.3 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.12459 | acc=0.9801 | tpr=0.9080 | fpr=0.0186 | 7879.7 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.12414 | acc=0.9802 | tpr=0.9106 | fpr=0.0185 | 7812.9 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.12326 | acc=0.9804 | tpr=0.9101 | fpr=0.0183 | 14480.8 samples/s | 56.6 steps/s
Avg test loss: 0.12300, Avg test acc: 0.98039, Avg tpr: 0.90967, Avg fpr: 0.01833, total FA: 2545

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.12618 | acc=0.9776 | tpr=0.9336 | fpr=0.0216 | 4089.7 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.12979 | acc=0.9781 | tpr=0.9510 | fpr=0.0214 | 7406.3 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.13363 | acc=0.9772 | tpr=0.9481 | fpr=0.0222 | 8090.7 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.13593 | acc=0.9771 | tpr=0.9508 | fpr=0.0225 | 8183.5 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.13554 | acc=0.9768 | tpr=0.9502 | fpr=0.0227 | 8137.5 samples/s | 31.8 steps/s
[Step= 300] | Loss=0.13884 | acc=0.9764 | tpr=0.9476 | fpr=0.0231 | 7875.9 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.13932 | acc=0.9762 | tpr=0.9468 | fpr=0.0232 | 8279.6 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.14107 | acc=0.9761 | tpr=0.9420 | fpr=0.0233 | 7626.3 samples/s | 29.8 steps/s
[Step= 450] | Loss=0.14464 | acc=0.9758 | tpr=0.9421 | fpr=0.0236 | 8009.8 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.14410 | acc=0.9758 | tpr=0.9441 | fpr=0.0236 | 7900.6 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.14285 | acc=0.9761 | tpr=0.9431 | fpr=0.0233 | 14093.6 samples/s | 55.1 steps/s
Avg test loss: 0.14265, Avg test acc: 0.97608, Avg tpr: 0.94334, Avg fpr: 0.02333, total FA: 3239

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11524 | acc=0.9808 | tpr=0.9204 | fpr=0.0181 | 4113.3 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.12037 | acc=0.9802 | tpr=0.9382 | fpr=0.0190 | 8030.8 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.12518 | acc=0.9794 | tpr=0.9395 | fpr=0.0198 | 8246.9 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.12751 | acc=0.9793 | tpr=0.9475 | fpr=0.0201 | 8009.7 samples/s | 31.3 steps/s
[Step= 250] | Loss=0.12623 | acc=0.9791 | tpr=0.9432 | fpr=0.0203 | 8274.4 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.12822 | acc=0.9788 | tpr=0.9433 | fpr=0.0205 | 7957.2 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.12822 | acc=0.9787 | tpr=0.9461 | fpr=0.0207 | 8048.9 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.12921 | acc=0.9786 | tpr=0.9420 | fpr=0.0207 | 8070.4 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.13236 | acc=0.9783 | tpr=0.9416 | fpr=0.0210 | 7908.5 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.13199 | acc=0.9784 | tpr=0.9436 | fpr=0.0210 | 8266.1 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.13110 | acc=0.9786 | tpr=0.9435 | fpr=0.0208 | 13048.8 samples/s | 51.0 steps/s
Avg test loss: 0.13093, Avg test acc: 0.97859, Avg tpr: 0.94334, Avg fpr: 0.02077, total FA: 2884

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12488 | acc=0.9804 | tpr=0.9204 | fpr=0.0185 | 4133.8 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.12984 | acc=0.9803 | tpr=0.9446 | fpr=0.0190 | 8303.2 samples/s | 32.4 steps/s
[Step= 150] | Loss=0.13552 | acc=0.9789 | tpr=0.9452 | fpr=0.0205 | 7617.0 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.13807 | acc=0.9787 | tpr=0.9497 | fpr=0.0208 | 7964.5 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.13665 | acc=0.9787 | tpr=0.9459 | fpr=0.0207 | 8050.3 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.13936 | acc=0.9783 | tpr=0.9469 | fpr=0.0211 | 7971.1 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.13994 | acc=0.9780 | tpr=0.9487 | fpr=0.0214 | 8046.8 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.14121 | acc=0.9778 | tpr=0.9447 | fpr=0.0216 | 8205.2 samples/s | 32.1 steps/s
[Step= 450] | Loss=0.14438 | acc=0.9775 | tpr=0.9440 | fpr=0.0219 | 7730.2 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.14386 | acc=0.9775 | tpr=0.9441 | fpr=0.0219 | 7734.0 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.14297 | acc=0.9777 | tpr=0.9427 | fpr=0.0217 | 14784.4 samples/s | 57.8 steps/s
Avg test loss: 0.14273, Avg test acc: 0.97772, Avg tpr: 0.94295, Avg fpr: 0.02165, total FA: 3006

server round 34/50

clients selected: [1 2 3 5 6]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=42001 Epoch=204.9] | Loss=0.01581 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.063 | L2-Norm(final)=12.577 | 3850.9 samples/s | 60.2 steps/s
[Step=42050 Epoch=205.2] | Loss=0.02530 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.076 | L2-Norm(final)=12.568 | 4534.0 samples/s | 70.8 steps/s
[Step=42100 Epoch=205.4] | Loss=0.02229 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.087 | L2-Norm(final)=12.567 | 5145.3 samples/s | 80.4 steps/s
[Step=42150 Epoch=205.7] | Loss=0.02101 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.095 | L2-Norm(final)=12.566 | 5204.2 samples/s | 81.3 steps/s
[Step=42200 Epoch=205.9] | Loss=0.02099 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.103 | L2-Norm(final)=12.568 | 7177.0 samples/s | 112.1 steps/s
[Step=42250 Epoch=206.2] | Loss=0.01962 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.110 | L2-Norm(final)=12.569 | 1790.8 samples/s | 28.0 steps/s
[Step=42300 Epoch=206.4] | Loss=0.01857 | Reg=0.00102 | acc=0.9688 | L2-Norm=10.117 | L2-Norm(final)=12.572 | 5024.1 samples/s | 78.5 steps/s
[Step=42350 Epoch=206.6] | Loss=0.01794 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.124 | L2-Norm(final)=12.576 | 5173.6 samples/s | 80.8 steps/s
[Step=42400 Epoch=206.9] | Loss=0.01724 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.131 | L2-Norm(final)=12.580 | 6663.6 samples/s | 104.1 steps/s
[Step=42450 Epoch=207.1] | Loss=0.01667 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.137 | L2-Norm(final)=12.585 | 1842.0 samples/s | 28.8 steps/s
[Step=42500 Epoch=207.4] | Loss=0.01612 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.144 | L2-Norm(final)=12.590 | 5037.0 samples/s | 78.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=42501 Epoch=207.4] | Loss=0.01483 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.212 | L2-Norm(final)=12.642 | 3635.9 samples/s | 56.8 steps/s
[Step=42550 Epoch=207.6] | Loss=0.01477 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.223 | L2-Norm(final)=12.649 | 4540.4 samples/s | 70.9 steps/s
[Step=42600 Epoch=207.9] | Loss=0.01613 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.234 | L2-Norm(final)=12.652 | 4586.0 samples/s | 71.7 steps/s
[Step=42650 Epoch=208.1] | Loss=0.01588 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.244 | L2-Norm(final)=12.656 | 4602.0 samples/s | 71.9 steps/s
[Step=42700 Epoch=208.4] | Loss=0.01478 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.253 | L2-Norm(final)=12.660 | 5890.5 samples/s | 92.0 steps/s
[Step=42750 Epoch=208.6] | Loss=0.01303 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.262 | L2-Norm(final)=12.664 | 1757.6 samples/s | 27.5 steps/s
[Step=42800 Epoch=208.8] | Loss=0.01201 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.269 | L2-Norm(final)=12.668 | 4540.9 samples/s | 71.0 steps/s
[Step=42850 Epoch=209.1] | Loss=0.01130 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.275 | L2-Norm(final)=12.673 | 4678.8 samples/s | 73.1 steps/s
[Step=42900 Epoch=209.3] | Loss=0.01058 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.281 | L2-Norm(final)=12.677 | 5824.6 samples/s | 91.0 steps/s
[Step=42950 Epoch=209.6] | Loss=0.00980 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.286 | L2-Norm(final)=12.681 | 1776.2 samples/s | 27.8 steps/s
[Step=43000 Epoch=209.8] | Loss=0.00922 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.291 | L2-Norm(final)=12.684 | 4611.8 samples/s | 72.1 steps/s
[Step=43050 Epoch=210.1] | Loss=0.00877 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.295 | L2-Norm(final)=12.688 | 4579.2 samples/s | 71.5 steps/s
[Step=43100 Epoch=210.3] | Loss=0.00850 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.299 | L2-Norm(final)=12.691 | 5332.9 samples/s | 83.3 steps/s
[Step=43150 Epoch=210.6] | Loss=0.00815 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.303 | L2-Norm(final)=12.694 | 1824.5 samples/s | 28.5 steps/s
[Step=43200 Epoch=210.8] | Loss=0.00796 | Reg=0.00106 | acc=0.9844 | L2-Norm=10.307 | L2-Norm(final)=12.697 | 4602.9 samples/s | 71.9 steps/s
[Step=43250 Epoch=211.0] | Loss=0.00760 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.310 | L2-Norm(final)=12.700 | 4605.2 samples/s | 72.0 steps/s
[Step=43300 Epoch=211.3] | Loss=0.00737 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.314 | L2-Norm(final)=12.703 | 5185.3 samples/s | 81.0 steps/s
[Step=43350 Epoch=211.5] | Loss=0.00707 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.317 | L2-Norm(final)=12.706 | 1838.6 samples/s | 28.7 steps/s
[Step=43400 Epoch=211.8] | Loss=0.00688 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.320 | L2-Norm(final)=12.709 | 4685.8 samples/s | 73.2 steps/s
[Step=43450 Epoch=212.0] | Loss=0.00671 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.323 | L2-Norm(final)=12.712 | 4628.5 samples/s | 72.3 steps/s
[Step=43500 Epoch=212.3] | Loss=0.00659 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.326 | L2-Norm(final)=12.715 | 4937.0 samples/s | 77.1 steps/s
[Step=43550 Epoch=212.5] | Loss=0.00638 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.328 | L2-Norm(final)=12.717 | 1866.3 samples/s | 29.2 steps/s
[Step=43600 Epoch=212.7] | Loss=0.00631 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.331 | L2-Norm(final)=12.720 | 4522.1 samples/s | 70.7 steps/s
[Step=43650 Epoch=213.0] | Loss=0.00615 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.334 | L2-Norm(final)=12.722 | 4542.5 samples/s | 71.0 steps/s
[Step=43700 Epoch=213.2] | Loss=0.00607 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.336 | L2-Norm(final)=12.725 | 4774.5 samples/s | 74.6 steps/s
[Step=43750 Epoch=213.5] | Loss=0.00591 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.338 | L2-Norm(final)=12.727 | 1899.4 samples/s | 29.7 steps/s
[Step=43800 Epoch=213.7] | Loss=0.00574 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.341 | L2-Norm(final)=12.729 | 4689.6 samples/s | 73.3 steps/s
[Step=43850 Epoch=214.0] | Loss=0.00569 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.343 | L2-Norm(final)=12.732 | 4548.8 samples/s | 71.1 steps/s
[Step=43900 Epoch=214.2] | Loss=0.00565 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.345 | L2-Norm(final)=12.734 | 4331.8 samples/s | 67.7 steps/s
[Step=43950 Epoch=214.5] | Loss=0.00554 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.348 | L2-Norm(final)=12.736 | 1893.5 samples/s | 29.6 steps/s
[Step=44000 Epoch=214.7] | Loss=0.00546 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.350 | L2-Norm(final)=12.739 | 4627.0 samples/s | 72.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step44000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=32001 Epoch=155.9] | Loss=0.00048 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.063 | L2-Norm(final)=12.351 | 4116.4 samples/s | 64.3 steps/s
[Step=32050 Epoch=156.2] | Loss=0.02615 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.071 | L2-Norm(final)=12.343 | 4711.4 samples/s | 73.6 steps/s
[Step=32100 Epoch=156.4] | Loss=0.02271 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.080 | L2-Norm(final)=12.342 | 5120.6 samples/s | 80.0 steps/s
[Step=32150 Epoch=156.7] | Loss=0.02233 | Reg=0.00102 | acc=0.9531 | L2-Norm=10.090 | L2-Norm(final)=12.344 | 5394.9 samples/s | 84.3 steps/s
[Step=32200 Epoch=156.9] | Loss=0.02138 | Reg=0.00102 | acc=0.9375 | L2-Norm=10.098 | L2-Norm(final)=12.347 | 7151.3 samples/s | 111.7 steps/s
[Step=32250 Epoch=157.1] | Loss=0.02039 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.106 | L2-Norm(final)=12.351 | 1789.9 samples/s | 28.0 steps/s
[Step=32300 Epoch=157.4] | Loss=0.01930 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.114 | L2-Norm(final)=12.355 | 5109.1 samples/s | 79.8 steps/s
[Step=32350 Epoch=157.6] | Loss=0.01889 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.122 | L2-Norm(final)=12.361 | 5024.4 samples/s | 78.5 steps/s
[Step=32400 Epoch=157.9] | Loss=0.01833 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.130 | L2-Norm(final)=12.367 | 6682.2 samples/s | 104.4 steps/s
[Step=32450 Epoch=158.1] | Loss=0.01753 | Reg=0.00103 | acc=0.9688 | L2-Norm=10.137 | L2-Norm(final)=12.373 | 1822.4 samples/s | 28.5 steps/s
[Step=32500 Epoch=158.4] | Loss=0.01716 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.145 | L2-Norm(final)=12.380 | 5106.6 samples/s | 79.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=158.4] | Loss=0.02565 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.217 | L2-Norm(final)=12.446 | 3707.4 samples/s | 57.9 steps/s
[Step=32550 Epoch=158.6] | Loss=0.01500 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.231 | L2-Norm(final)=12.455 | 4250.8 samples/s | 66.4 steps/s
[Step=32600 Epoch=158.8] | Loss=0.01481 | Reg=0.00105 | acc=0.9688 | L2-Norm=10.244 | L2-Norm(final)=12.462 | 4609.9 samples/s | 72.0 steps/s
[Step=32650 Epoch=159.1] | Loss=0.01486 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.256 | L2-Norm(final)=12.468 | 4610.5 samples/s | 72.0 steps/s
[Step=32700 Epoch=159.3] | Loss=0.01379 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.266 | L2-Norm(final)=12.474 | 6138.8 samples/s | 95.9 steps/s
[Step=32750 Epoch=159.6] | Loss=0.01227 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.275 | L2-Norm(final)=12.480 | 1745.2 samples/s | 27.3 steps/s
[Step=32800 Epoch=159.8] | Loss=0.01157 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.282 | L2-Norm(final)=12.485 | 4597.6 samples/s | 71.8 steps/s
[Step=32850 Epoch=160.1] | Loss=0.01072 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.289 | L2-Norm(final)=12.490 | 4641.5 samples/s | 72.5 steps/s
[Step=32900 Epoch=160.3] | Loss=0.01028 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.296 | L2-Norm(final)=12.494 | 5810.3 samples/s | 90.8 steps/s
[Step=32950 Epoch=160.5] | Loss=0.00957 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.302 | L2-Norm(final)=12.499 | 1783.6 samples/s | 27.9 steps/s
[Step=33000 Epoch=160.8] | Loss=0.00921 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.307 | L2-Norm(final)=12.503 | 4568.8 samples/s | 71.4 steps/s
[Step=33050 Epoch=161.0] | Loss=0.00876 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.312 | L2-Norm(final)=12.507 | 4524.2 samples/s | 70.7 steps/s
[Step=33100 Epoch=161.3] | Loss=0.00844 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.317 | L2-Norm(final)=12.511 | 5201.4 samples/s | 81.3 steps/s
[Step=33150 Epoch=161.5] | Loss=0.00821 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.322 | L2-Norm(final)=12.515 | 1832.8 samples/s | 28.6 steps/s
[Step=33200 Epoch=161.8] | Loss=0.00791 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.326 | L2-Norm(final)=12.519 | 4556.5 samples/s | 71.2 steps/s
[Step=33250 Epoch=162.0] | Loss=0.00769 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.331 | L2-Norm(final)=12.522 | 4703.8 samples/s | 73.5 steps/s
[Step=33300 Epoch=162.3] | Loss=0.00751 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.335 | L2-Norm(final)=12.526 | 5122.2 samples/s | 80.0 steps/s
[Step=33350 Epoch=162.5] | Loss=0.00726 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.338 | L2-Norm(final)=12.529 | 1884.4 samples/s | 29.4 steps/s
[Step=33400 Epoch=162.7] | Loss=0.00707 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.342 | L2-Norm(final)=12.532 | 4542.4 samples/s | 71.0 steps/s
[Step=33450 Epoch=163.0] | Loss=0.00688 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.346 | L2-Norm(final)=12.536 | 4549.1 samples/s | 71.1 steps/s
[Step=33500 Epoch=163.2] | Loss=0.00677 | Reg=0.00107 | acc=0.9844 | L2-Norm=10.349 | L2-Norm(final)=12.539 | 4652.4 samples/s | 72.7 steps/s
[Step=33550 Epoch=163.5] | Loss=0.00663 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.353 | L2-Norm(final)=12.542 | 1893.4 samples/s | 29.6 steps/s
[Step=33600 Epoch=163.7] | Loss=0.00648 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.356 | L2-Norm(final)=12.545 | 4597.5 samples/s | 71.8 steps/s
[Step=33650 Epoch=164.0] | Loss=0.00634 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.359 | L2-Norm(final)=12.548 | 4563.0 samples/s | 71.3 steps/s
[Step=33700 Epoch=164.2] | Loss=0.00620 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.362 | L2-Norm(final)=12.550 | 4555.7 samples/s | 71.2 steps/s
[Step=33750 Epoch=164.4] | Loss=0.00614 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.365 | L2-Norm(final)=12.553 | 1934.2 samples/s | 30.2 steps/s
[Step=33800 Epoch=164.7] | Loss=0.00605 | Reg=0.00108 | acc=0.9844 | L2-Norm=10.369 | L2-Norm(final)=12.556 | 4522.7 samples/s | 70.7 steps/s
[Step=33850 Epoch=164.9] | Loss=0.00594 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.372 | L2-Norm(final)=12.559 | 4653.0 samples/s | 72.7 steps/s
[Step=33900 Epoch=165.2] | Loss=0.00588 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.375 | L2-Norm(final)=12.561 | 4559.6 samples/s | 71.2 steps/s
[Step=33950 Epoch=165.4] | Loss=0.00583 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.378 | L2-Norm(final)=12.564 | 1933.9 samples/s | 30.2 steps/s
[Step=34000 Epoch=165.7] | Loss=0.00577 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.381 | L2-Norm(final)=12.567 | 4519.0 samples/s | 70.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step34000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=32001 Epoch=156.1] | Loss=0.02591 | Reg=0.00101 | acc=0.9688 | L2-Norm=10.063 | L2-Norm(final)=11.887 | 3935.5 samples/s | 61.5 steps/s
[Step=32050 Epoch=156.3] | Loss=0.02614 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.074 | L2-Norm(final)=11.882 | 4421.2 samples/s | 69.1 steps/s
[Step=32100 Epoch=156.5] | Loss=0.02131 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.084 | L2-Norm(final)=11.881 | 5212.1 samples/s | 81.4 steps/s
[Step=32150 Epoch=156.8] | Loss=0.02140 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.093 | L2-Norm(final)=11.884 | 5084.3 samples/s | 79.4 steps/s
[Step=32200 Epoch=157.0] | Loss=0.02120 | Reg=0.00102 | acc=0.9688 | L2-Norm=10.102 | L2-Norm(final)=11.886 | 7191.2 samples/s | 112.4 steps/s
[Step=32250 Epoch=157.3] | Loss=0.02012 | Reg=0.00102 | acc=0.9531 | L2-Norm=10.110 | L2-Norm(final)=11.889 | 1808.4 samples/s | 28.3 steps/s
[Step=32300 Epoch=157.5] | Loss=0.01950 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.118 | L2-Norm(final)=11.894 | 5042.2 samples/s | 78.8 steps/s
[Step=32350 Epoch=157.8] | Loss=0.01862 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.126 | L2-Norm(final)=11.899 | 5107.7 samples/s | 79.8 steps/s
[Step=32400 Epoch=158.0] | Loss=0.01818 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.134 | L2-Norm(final)=11.904 | 6814.0 samples/s | 106.5 steps/s
[Step=32450 Epoch=158.2] | Loss=0.01743 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.142 | L2-Norm(final)=11.909 | 1847.2 samples/s | 28.9 steps/s
[Step=32500 Epoch=158.5] | Loss=0.01679 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.150 | L2-Norm(final)=11.915 | 5061.4 samples/s | 79.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=158.5] | Loss=0.00827 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=11.975 | 3657.8 samples/s | 57.2 steps/s
[Step=32550 Epoch=158.7] | Loss=0.01392 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.239 | L2-Norm(final)=11.981 | 4465.3 samples/s | 69.8 steps/s
[Step=32600 Epoch=159.0] | Loss=0.01409 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.251 | L2-Norm(final)=11.986 | 4556.0 samples/s | 71.2 steps/s
[Step=32650 Epoch=159.2] | Loss=0.01509 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.262 | L2-Norm(final)=11.990 | 4589.6 samples/s | 71.7 steps/s
[Step=32700 Epoch=159.5] | Loss=0.01457 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.272 | L2-Norm(final)=11.994 | 6023.2 samples/s | 94.1 steps/s
[Step=32750 Epoch=159.7] | Loss=0.01270 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.281 | L2-Norm(final)=11.999 | 1744.7 samples/s | 27.3 steps/s
[Step=32800 Epoch=160.0] | Loss=0.01154 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.289 | L2-Norm(final)=12.004 | 4499.6 samples/s | 70.3 steps/s
[Step=32850 Epoch=160.2] | Loss=0.01082 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.296 | L2-Norm(final)=12.009 | 4537.5 samples/s | 70.9 steps/s
[Step=32900 Epoch=160.4] | Loss=0.01020 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.302 | L2-Norm(final)=12.013 | 5612.8 samples/s | 87.7 steps/s
[Step=32950 Epoch=160.7] | Loss=0.00955 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.308 | L2-Norm(final)=12.018 | 1793.8 samples/s | 28.0 steps/s
[Step=33000 Epoch=160.9] | Loss=0.00911 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.314 | L2-Norm(final)=12.023 | 4555.6 samples/s | 71.2 steps/s
[Step=33050 Epoch=161.2] | Loss=0.00847 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.319 | L2-Norm(final)=12.027 | 4556.1 samples/s | 71.2 steps/s
[Step=33100 Epoch=161.4] | Loss=0.00816 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.324 | L2-Norm(final)=12.031 | 5211.3 samples/s | 81.4 steps/s
[Step=33150 Epoch=161.7] | Loss=0.00778 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.329 | L2-Norm(final)=12.035 | 1834.2 samples/s | 28.7 steps/s
[Step=33200 Epoch=161.9] | Loss=0.00754 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.333 | L2-Norm(final)=12.039 | 4689.9 samples/s | 73.3 steps/s
[Step=33250 Epoch=162.1] | Loss=0.00724 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.337 | L2-Norm(final)=12.043 | 4602.6 samples/s | 71.9 steps/s
[Step=33300 Epoch=162.4] | Loss=0.00697 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.341 | L2-Norm(final)=12.047 | 4962.2 samples/s | 77.5 steps/s
[Step=33350 Epoch=162.6] | Loss=0.00682 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.345 | L2-Norm(final)=12.050 | 1877.5 samples/s | 29.3 steps/s
[Step=33400 Epoch=162.9] | Loss=0.00668 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.349 | L2-Norm(final)=12.054 | 4488.6 samples/s | 70.1 steps/s
[Step=33450 Epoch=163.1] | Loss=0.00648 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.353 | L2-Norm(final)=12.057 | 4582.3 samples/s | 71.6 steps/s
[Step=33500 Epoch=163.4] | Loss=0.00628 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.356 | L2-Norm(final)=12.060 | 4777.4 samples/s | 74.6 steps/s
[Step=33550 Epoch=163.6] | Loss=0.00613 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.360 | L2-Norm(final)=12.063 | 1891.3 samples/s | 29.6 steps/s
[Step=33600 Epoch=163.9] | Loss=0.00597 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.363 | L2-Norm(final)=12.066 | 4817.1 samples/s | 75.3 steps/s
[Step=33650 Epoch=164.1] | Loss=0.00584 | Reg=0.00107 | acc=1.0000 | L2-Norm=10.366 | L2-Norm(final)=12.070 | 4528.8 samples/s | 70.8 steps/s
[Step=33700 Epoch=164.3] | Loss=0.00575 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.369 | L2-Norm(final)=12.073 | 4627.3 samples/s | 72.3 steps/s
[Step=33750 Epoch=164.6] | Loss=0.00560 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.372 | L2-Norm(final)=12.076 | 1915.3 samples/s | 29.9 steps/s
[Step=33800 Epoch=164.8] | Loss=0.00546 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.375 | L2-Norm(final)=12.079 | 4658.8 samples/s | 72.8 steps/s
[Step=33850 Epoch=165.1] | Loss=0.00538 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.378 | L2-Norm(final)=12.081 | 4604.3 samples/s | 71.9 steps/s
[Step=33900 Epoch=165.3] | Loss=0.00532 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.381 | L2-Norm(final)=12.084 | 4427.9 samples/s | 69.2 steps/s
[Step=33950 Epoch=165.6] | Loss=0.00521 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.384 | L2-Norm(final)=12.087 | 1988.7 samples/s | 31.1 steps/s
[Step=34000 Epoch=165.8] | Loss=0.00510 | Reg=0.00108 | acc=1.0000 | L2-Norm=10.386 | L2-Norm(final)=12.090 | 4557.9 samples/s | 71.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step34000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=24001 Epoch=227.4] | Loss=0.00081 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.063 | L2-Norm(final)=7.232 | 3810.0 samples/s | 59.5 steps/s
[Step=24050 Epoch=227.9] | Loss=0.00184 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.080 | L2-Norm(final)=7.241 | 4320.9 samples/s | 67.5 steps/s
[Step=24100 Epoch=228.4] | Loss=0.00103 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.098 | L2-Norm(final)=7.249 | 6747.5 samples/s | 105.4 steps/s
[Step=24150 Epoch=228.8] | Loss=0.00077 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.105 | L2-Norm(final)=7.255 | 1739.3 samples/s | 27.2 steps/s
[Step=24200 Epoch=229.3] | Loss=0.00060 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.108 | L2-Norm(final)=7.261 | 6307.3 samples/s | 98.6 steps/s
[Step=24250 Epoch=229.8] | Loss=0.00050 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.110 | L2-Norm(final)=7.266 | 1790.2 samples/s | 28.0 steps/s
[Step=24300 Epoch=230.3] | Loss=0.00042 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.110 | L2-Norm(final)=7.270 | 5856.3 samples/s | 91.5 steps/s
[Step=24350 Epoch=230.7] | Loss=0.00038 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.109 | L2-Norm(final)=7.274 | 1848.5 samples/s | 28.9 steps/s
[Step=24400 Epoch=231.2] | Loss=0.00034 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.108 | L2-Norm(final)=7.278 | 5187.6 samples/s | 81.1 steps/s
[Step=24450 Epoch=231.7] | Loss=0.00031 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.106 | L2-Norm(final)=7.282 | 1855.8 samples/s | 29.0 steps/s
[Step=24500 Epoch=232.2] | Loss=0.00028 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.105 | L2-Norm(final)=7.286 | 4860.0 samples/s | 75.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=24501 Epoch=232.2] | Loss=0.00004 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.086 | L2-Norm(final)=7.322 | 3633.0 samples/s | 56.8 steps/s
[Step=24550 Epoch=232.6] | Loss=0.00004 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.079 | L2-Norm(final)=7.324 | 4144.0 samples/s | 64.8 steps/s
[Step=24600 Epoch=233.1] | Loss=0.00003 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.068 | L2-Norm(final)=7.326 | 5932.2 samples/s | 92.7 steps/s
[Step=24650 Epoch=233.6] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.056 | L2-Norm(final)=7.327 | 1684.0 samples/s | 26.3 steps/s
[Step=24700 Epoch=234.1] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.043 | L2-Norm(final)=7.328 | 5481.5 samples/s | 85.6 steps/s
[Step=24750 Epoch=234.5] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.029 | L2-Norm(final)=7.329 | 1709.1 samples/s | 26.7 steps/s
[Step=24800 Epoch=235.0] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.015 | L2-Norm(final)=7.329 | 5095.9 samples/s | 79.6 steps/s
[Step=24850 Epoch=235.5] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.000 | L2-Norm(final)=7.330 | 1788.2 samples/s | 27.9 steps/s
[Step=24900 Epoch=235.9] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.985 | L2-Norm(final)=7.330 | 4803.8 samples/s | 75.1 steps/s
[Step=24950 Epoch=236.4] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.970 | L2-Norm(final)=7.331 | 1785.1 samples/s | 27.9 steps/s
[Step=25000 Epoch=236.9] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.955 | L2-Norm(final)=7.331 | 4546.7 samples/s | 71.0 steps/s
[Step=25050 Epoch=237.4] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.940 | L2-Norm(final)=7.331 | 1867.8 samples/s | 29.2 steps/s
[Step=25100 Epoch=237.8] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.924 | L2-Norm(final)=7.332 | 4363.9 samples/s | 68.2 steps/s
[Step=25150 Epoch=238.3] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.908 | L2-Norm(final)=7.332 | 1868.2 samples/s | 29.2 steps/s
[Step=25200 Epoch=238.8] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.892 | L2-Norm(final)=7.332 | 4334.6 samples/s | 67.7 steps/s
[Step=25250 Epoch=239.3] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.876 | L2-Norm(final)=7.333 | 1901.6 samples/s | 29.7 steps/s
[Step=25300 Epoch=239.7] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.860 | L2-Norm(final)=7.333 | 4312.1 samples/s | 67.4 steps/s
[Step=25350 Epoch=240.2] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.843 | L2-Norm(final)=7.333 | 1944.7 samples/s | 30.4 steps/s
[Step=25400 Epoch=240.7] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.826 | L2-Norm(final)=7.334 | 4238.9 samples/s | 66.2 steps/s
[Step=25450 Epoch=241.2] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.810 | L2-Norm(final)=7.334 | 6252.3 samples/s | 97.7 steps/s
[Step=25500 Epoch=241.6] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.793 | L2-Norm(final)=7.334 | 1648.6 samples/s | 25.8 steps/s
[Step=25550 Epoch=242.1] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.775 | L2-Norm(final)=7.334 | 5614.7 samples/s | 87.7 steps/s
[Step=25600 Epoch=242.6] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.758 | L2-Norm(final)=7.335 | 1717.6 samples/s | 26.8 steps/s
[Step=25650 Epoch=243.1] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.740 | L2-Norm(final)=7.335 | 5269.6 samples/s | 82.3 steps/s
[Step=25700 Epoch=243.5] | Loss=0.00000 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.723 | L2-Norm(final)=7.335 | 1791.0 samples/s | 28.0 steps/s
[Step=25750 Epoch=244.0] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.705 | L2-Norm(final)=7.336 | 4745.6 samples/s | 74.1 steps/s
[Step=25800 Epoch=244.5] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.686 | L2-Norm(final)=7.336 | 1812.3 samples/s | 28.3 steps/s
[Step=25850 Epoch=245.0] | Loss=0.00000 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=7.336 | 4669.0 samples/s | 73.0 steps/s
[Step=25900 Epoch=245.4] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.650 | L2-Norm(final)=7.336 | 1849.2 samples/s | 28.9 steps/s
[Step=25950 Epoch=245.9] | Loss=0.00000 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.631 | L2-Norm(final)=7.337 | 4505.5 samples/s | 70.4 steps/s
[Step=26000 Epoch=246.4] | Loss=0.00000 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.612 | L2-Norm(final)=7.337 | 1901.4 samples/s | 29.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_0/client_state-step26000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=36001 Epoch=342.5] | Loss=0.02950 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.063 | L2-Norm(final)=9.095 | 3410.2 samples/s | 53.3 steps/s
[Step=36050 Epoch=342.9] | Loss=0.00219 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.082 | L2-Norm(final)=9.096 | 4937.2 samples/s | 77.1 steps/s
[Step=36100 Epoch=343.4] | Loss=0.00129 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.093 | L2-Norm(final)=9.101 | 6961.3 samples/s | 108.8 steps/s
[Step=36150 Epoch=343.9] | Loss=0.00094 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.097 | L2-Norm(final)=9.105 | 1739.6 samples/s | 27.2 steps/s
[Step=36200 Epoch=344.4] | Loss=0.00074 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.100 | L2-Norm(final)=9.109 | 6317.1 samples/s | 98.7 steps/s
[Step=36250 Epoch=344.8] | Loss=0.00061 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.102 | L2-Norm(final)=9.112 | 1812.1 samples/s | 28.3 steps/s
[Step=36300 Epoch=345.3] | Loss=0.00053 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.102 | L2-Norm(final)=9.116 | 5907.3 samples/s | 92.3 steps/s
[Step=36350 Epoch=345.8] | Loss=0.00047 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.103 | L2-Norm(final)=9.119 | 1803.6 samples/s | 28.2 steps/s
[Step=36400 Epoch=346.3] | Loss=0.00042 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.102 | L2-Norm(final)=9.122 | 5436.6 samples/s | 84.9 steps/s
[Step=36450 Epoch=346.7] | Loss=0.00038 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.102 | L2-Norm(final)=9.124 | 1886.8 samples/s | 29.5 steps/s
[Step=36500 Epoch=347.2] | Loss=0.00035 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.102 | L2-Norm(final)=9.127 | 4976.2 samples/s | 77.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=347.2] | Loss=0.00008 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.095 | L2-Norm(final)=9.154 | 3795.0 samples/s | 59.3 steps/s
[Step=36550 Epoch=347.7] | Loss=0.00006 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.092 | L2-Norm(final)=9.156 | 4076.1 samples/s | 63.7 steps/s
[Step=36600 Epoch=348.2] | Loss=0.00004 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.088 | L2-Norm(final)=9.158 | 5889.4 samples/s | 92.0 steps/s
[Step=36650 Epoch=348.6] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.082 | L2-Norm(final)=9.159 | 1703.7 samples/s | 26.6 steps/s
[Step=36700 Epoch=349.1] | Loss=0.00003 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.076 | L2-Norm(final)=9.160 | 5589.2 samples/s | 87.3 steps/s
[Step=36750 Epoch=349.6] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.069 | L2-Norm(final)=9.161 | 1743.6 samples/s | 27.2 steps/s
[Step=36800 Epoch=350.1] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.063 | L2-Norm(final)=9.161 | 5017.8 samples/s | 78.4 steps/s
[Step=36850 Epoch=350.5] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.055 | L2-Norm(final)=9.162 | 1796.2 samples/s | 28.1 steps/s
[Step=36900 Epoch=351.0] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.048 | L2-Norm(final)=9.163 | 4774.3 samples/s | 74.6 steps/s
[Step=36950 Epoch=351.5] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.041 | L2-Norm(final)=9.163 | 1821.0 samples/s | 28.5 steps/s
[Step=37000 Epoch=352.0] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.033 | L2-Norm(final)=9.163 | 4509.8 samples/s | 70.5 steps/s
[Step=37050 Epoch=352.4] | Loss=0.00001 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=9.164 | 1839.9 samples/s | 28.7 steps/s
[Step=37100 Epoch=352.9] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=9.164 | 4433.4 samples/s | 69.3 steps/s
[Step=37150 Epoch=353.4] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.009 | L2-Norm(final)=9.165 | 1871.8 samples/s | 29.2 steps/s
[Step=37200 Epoch=353.9] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.001 | L2-Norm(final)=9.165 | 4515.6 samples/s | 70.6 steps/s
[Step=37250 Epoch=354.3] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.993 | L2-Norm(final)=9.165 | 1907.0 samples/s | 29.8 steps/s
[Step=37300 Epoch=354.8] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.984 | L2-Norm(final)=9.166 | 4414.0 samples/s | 69.0 steps/s
[Step=37350 Epoch=355.3] | Loss=0.00001 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=9.166 | 1912.4 samples/s | 29.9 steps/s
[Step=37400 Epoch=355.8] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.967 | L2-Norm(final)=9.166 | 4297.8 samples/s | 67.2 steps/s
[Step=37450 Epoch=356.2] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.958 | L2-Norm(final)=9.167 | 5831.5 samples/s | 91.1 steps/s
[Step=37500 Epoch=356.7] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.949 | L2-Norm(final)=9.167 | 1690.4 samples/s | 26.4 steps/s
[Step=37550 Epoch=357.2] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.940 | L2-Norm(final)=9.167 | 5547.4 samples/s | 86.7 steps/s
[Step=37600 Epoch=357.7] | Loss=0.00001 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.931 | L2-Norm(final)=9.168 | 1709.4 samples/s | 26.7 steps/s
[Step=37650 Epoch=358.1] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.922 | L2-Norm(final)=9.168 | 5223.9 samples/s | 81.6 steps/s
[Step=37700 Epoch=358.6] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.912 | L2-Norm(final)=9.168 | 1751.4 samples/s | 27.4 steps/s
[Step=37750 Epoch=359.1] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.903 | L2-Norm(final)=9.169 | 4831.4 samples/s | 75.5 steps/s
[Step=37800 Epoch=359.6] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.893 | L2-Norm(final)=9.169 | 1802.9 samples/s | 28.2 steps/s
[Step=37850 Epoch=360.0] | Loss=0.00001 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.883 | L2-Norm(final)=9.169 | 4467.2 samples/s | 69.8 steps/s
[Step=37900 Epoch=360.5] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.873 | L2-Norm(final)=9.170 | 1832.4 samples/s | 28.6 steps/s
[Step=37950 Epoch=361.0] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.863 | L2-Norm(final)=9.170 | 4279.0 samples/s | 66.9 steps/s
[Step=38000 Epoch=361.5] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.853 | L2-Norm(final)=9.170 | 1849.4 samples/s | 28.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step38000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08687 | acc=0.9628 | tpr=0.9749 | fpr=0.0634 | 4127.3 samples/s | 16.1 steps/s
Avg test loss: 0.08999, Avg test acc: 0.96158, Avg tpr: 0.97412, Avg fpr: 0.06602, total FA: 515

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08602 | acc=0.9632 | tpr=0.9732 | fpr=0.0585 | 4095.2 samples/s | 16.0 steps/s
Avg test loss: 0.09085, Avg test acc: 0.96117, Avg tpr: 0.97156, Avg fpr: 0.06166, total FA: 481

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08804 | acc=0.9596 | tpr=0.9723 | fpr=0.0679 | 4135.4 samples/s | 16.2 steps/s
Avg test loss: 0.09309, Avg test acc: 0.95893, Avg tpr: 0.97010, Avg fpr: 0.06563, total FA: 512

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08681 | acc=0.9605 | tpr=0.9722 | fpr=0.0647 | 4136.1 samples/s | 16.2 steps/s
Avg test loss: 0.09128, Avg test acc: 0.96033, Avg tpr: 0.97185, Avg fpr: 0.06499, total FA: 507

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.09025 | acc=0.9616 | tpr=0.9673 | fpr=0.0508 | 4153.6 samples/s | 16.2 steps/s
Avg test loss: 0.09688, Avg test acc: 0.95949, Avg tpr: 0.96561, Avg fpr: 0.05397, total FA: 421

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.20561 | acc=0.2968 | tpr=0.0025 | fpr=0.0642 | 4099.0 samples/s | 16.0 steps/s
Avg test loss: 5.22214, Avg test acc: 0.29369, Avg tpr: 0.00303, Avg fpr: 0.06704, total FA: 523

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.81103 | acc=0.3137 | tpr=0.0040 | fpr=0.0136 | 4061.2 samples/s | 15.9 steps/s
Avg test loss: 4.81787, Avg test acc: 0.31128, Avg tpr: 0.00460, Avg fpr: 0.01423, total FA: 111

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.84140 | acc=0.3035 | tpr=0.0094 | fpr=0.0577 | 4087.1 samples/s | 16.0 steps/s
Avg test loss: 4.84805, Avg test acc: 0.30155, Avg tpr: 0.01026, Avg fpr: 0.05781, total FA: 451

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.30064 | acc=0.3022 | tpr=0.0046 | fpr=0.0515 | 4095.0 samples/s | 16.0 steps/s
Avg test loss: 5.31147, Avg test acc: 0.29942, Avg tpr: 0.00548, Avg fpr: 0.05410, total FA: 422

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.08761 | acc=0.3137 | tpr=0.0017 | fpr=0.0087 | 4068.2 samples/s | 15.9 steps/s
Avg test loss: 5.09724, Avg test acc: 0.31104, Avg tpr: 0.00210, Avg fpr: 0.00949, total FA: 74

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.51359 | acc=0.1196 | tpr=0.8761 | fpr=0.8940 | 4084.0 samples/s | 16.0 steps/s
[Step= 100] | Loss=5.46182 | acc=0.1208 | tpr=0.8550 | fpr=0.8929 | 7657.7 samples/s | 29.9 steps/s
[Step= 150] | Loss=5.46512 | acc=0.1191 | tpr=0.8674 | fpr=0.8947 | 7937.5 samples/s | 31.0 steps/s
[Step= 200] | Loss=5.46381 | acc=0.1184 | tpr=0.8667 | fpr=0.8952 | 8799.3 samples/s | 34.4 steps/s
[Step= 250] | Loss=5.46715 | acc=0.1190 | tpr=0.8629 | fpr=0.8946 | 7873.6 samples/s | 30.8 steps/s
[Step= 300] | Loss=5.46444 | acc=0.1183 | tpr=0.8589 | fpr=0.8952 | 6274.7 samples/s | 24.5 steps/s
[Step= 350] | Loss=5.45993 | acc=0.1180 | tpr=0.8560 | fpr=0.8954 | 7912.2 samples/s | 30.9 steps/s
[Step= 400] | Loss=5.46103 | acc=0.1183 | tpr=0.8523 | fpr=0.8950 | 8011.6 samples/s | 31.3 steps/s
[Step= 450] | Loss=5.46488 | acc=0.1180 | tpr=0.8481 | fpr=0.8953 | 8020.3 samples/s | 31.3 steps/s
[Step= 500] | Loss=5.46796 | acc=0.1179 | tpr=0.8493 | fpr=0.8954 | 5393.0 samples/s | 21.1 steps/s
[Step= 550] | Loss=5.46719 | acc=0.1176 | tpr=0.8528 | fpr=0.8957 | 14889.0 samples/s | 58.2 steps/s
Avg test loss: 5.46900, Avg test acc: 0.11757, Avg tpr: 0.85261, Avg fpr: 0.89579, total FA: 124379

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.89469 | acc=0.1298 | tpr=0.7965 | fpr=0.8821 | 4056.8 samples/s | 15.8 steps/s
[Step= 100] | Loss=4.84044 | acc=0.1332 | tpr=0.7633 | fpr=0.8786 | 7959.5 samples/s | 31.1 steps/s
[Step= 150] | Loss=4.84236 | acc=0.1310 | tpr=0.7637 | fpr=0.8807 | 7841.5 samples/s | 30.6 steps/s
[Step= 200] | Loss=4.84409 | acc=0.1309 | tpr=0.7607 | fpr=0.8806 | 8291.2 samples/s | 32.4 steps/s
[Step= 250] | Loss=4.84343 | acc=0.1319 | tpr=0.7607 | fpr=0.8796 | 8217.0 samples/s | 32.1 steps/s
[Step= 300] | Loss=4.84064 | acc=0.1314 | tpr=0.7607 | fpr=0.8801 | 6750.9 samples/s | 26.4 steps/s
[Step= 350] | Loss=4.83444 | acc=0.1309 | tpr=0.7583 | fpr=0.8805 | 8277.8 samples/s | 32.3 steps/s
[Step= 400] | Loss=4.83570 | acc=0.1310 | tpr=0.7533 | fpr=0.8803 | 7723.7 samples/s | 30.2 steps/s
[Step= 450] | Loss=4.84090 | acc=0.1308 | tpr=0.7488 | fpr=0.8804 | 5583.5 samples/s | 21.8 steps/s
[Step= 500] | Loss=4.84657 | acc=0.1305 | tpr=0.7489 | fpr=0.8806 | 6794.8 samples/s | 26.5 steps/s
[Step= 550] | Loss=4.84498 | acc=0.1304 | tpr=0.7513 | fpr=0.8809 | 14110.6 samples/s | 55.1 steps/s
Avg test loss: 4.84650, Avg test acc: 0.13038, Avg tpr: 0.75079, Avg fpr: 0.88090, total FA: 122311

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.42283 | acc=0.1205 | tpr=0.8097 | fpr=0.8919 | 4059.7 samples/s | 15.9 steps/s
[Step= 100] | Loss=5.36722 | acc=0.1243 | tpr=0.8060 | fpr=0.8885 | 8033.5 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.36963 | acc=0.1217 | tpr=0.8285 | fpr=0.8913 | 8073.8 samples/s | 31.5 steps/s
[Step= 200] | Loss=5.37302 | acc=0.1211 | tpr=0.8317 | fpr=0.8918 | 8127.4 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.37351 | acc=0.1217 | tpr=0.8288 | fpr=0.8911 | 5927.6 samples/s | 23.2 steps/s
[Step= 300] | Loss=5.37089 | acc=0.1217 | tpr=0.8291 | fpr=0.8912 | 7901.7 samples/s | 30.9 steps/s
[Step= 350] | Loss=5.36783 | acc=0.1215 | tpr=0.8278 | fpr=0.8913 | 8142.4 samples/s | 31.8 steps/s
[Step= 400] | Loss=5.37073 | acc=0.1215 | tpr=0.8249 | fpr=0.8913 | 7889.0 samples/s | 30.8 steps/s
[Step= 450] | Loss=5.37465 | acc=0.1207 | tpr=0.8194 | fpr=0.8920 | 5733.4 samples/s | 22.4 steps/s
[Step= 500] | Loss=5.37592 | acc=0.1206 | tpr=0.8189 | fpr=0.8920 | 7968.0 samples/s | 31.1 steps/s
[Step= 550] | Loss=5.37504 | acc=0.1205 | tpr=0.8225 | fpr=0.8923 | 14552.0 samples/s | 56.8 steps/s
Avg test loss: 5.37649, Avg test acc: 0.12041, Avg tpr: 0.82211, Avg fpr: 0.89234, total FA: 123900

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.15742 | acc=0.1370 | tpr=0.7788 | fpr=0.8746 | 4125.1 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.10651 | acc=0.1393 | tpr=0.7463 | fpr=0.8720 | 8051.5 samples/s | 31.5 steps/s
[Step= 150] | Loss=5.10357 | acc=0.1379 | tpr=0.7709 | fpr=0.8737 | 8438.2 samples/s | 33.0 steps/s
[Step= 200] | Loss=5.09914 | acc=0.1378 | tpr=0.7683 | fpr=0.8737 | 7861.3 samples/s | 30.7 steps/s
[Step= 250] | Loss=5.10185 | acc=0.1381 | tpr=0.7677 | fpr=0.8733 | 6359.4 samples/s | 24.8 steps/s
[Step= 300] | Loss=5.09860 | acc=0.1373 | tpr=0.7658 | fpr=0.8742 | 8008.7 samples/s | 31.3 steps/s
[Step= 350] | Loss=5.09320 | acc=0.1369 | tpr=0.7627 | fpr=0.8745 | 8194.8 samples/s | 32.0 steps/s
[Step= 400] | Loss=5.09656 | acc=0.1366 | tpr=0.7615 | fpr=0.8748 | 7803.3 samples/s | 30.5 steps/s
[Step= 450] | Loss=5.10207 | acc=0.1361 | tpr=0.7556 | fpr=0.8751 | 5480.1 samples/s | 21.4 steps/s
[Step= 500] | Loss=5.10568 | acc=0.1360 | tpr=0.7586 | fpr=0.8753 | 8129.4 samples/s | 31.8 steps/s
[Step= 550] | Loss=5.10443 | acc=0.1359 | tpr=0.7628 | fpr=0.8755 | 14753.5 samples/s | 57.6 steps/s
Avg test loss: 5.10633, Avg test acc: 0.13579, Avg tpr: 0.76228, Avg fpr: 0.87560, total FA: 121575

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.91952 | acc=0.1412 | tpr=0.7035 | fpr=0.8689 | 4026.1 samples/s | 15.7 steps/s
[Step= 100] | Loss=4.86946 | acc=0.1444 | tpr=0.6780 | fpr=0.8656 | 8006.8 samples/s | 31.3 steps/s
[Step= 150] | Loss=4.86758 | acc=0.1432 | tpr=0.6729 | fpr=0.8666 | 8000.8 samples/s | 31.3 steps/s
[Step= 200] | Loss=4.86480 | acc=0.1425 | tpr=0.6689 | fpr=0.8670 | 7679.0 samples/s | 30.0 steps/s
[Step= 250] | Loss=4.86740 | acc=0.1426 | tpr=0.6672 | fpr=0.8670 | 8367.0 samples/s | 32.7 steps/s
[Step= 300] | Loss=4.86291 | acc=0.1424 | tpr=0.6735 | fpr=0.8673 | 7879.1 samples/s | 30.8 steps/s
[Step= 350] | Loss=4.85774 | acc=0.1417 | tpr=0.6763 | fpr=0.8680 | 7885.6 samples/s | 30.8 steps/s
[Step= 400] | Loss=4.86126 | acc=0.1418 | tpr=0.6756 | fpr=0.8679 | 6678.0 samples/s | 26.1 steps/s
[Step= 450] | Loss=4.86432 | acc=0.1414 | tpr=0.6719 | fpr=0.8683 | 5336.9 samples/s | 20.8 steps/s
[Step= 500] | Loss=4.86612 | acc=0.1411 | tpr=0.6705 | fpr=0.8685 | 7788.8 samples/s | 30.4 steps/s
[Step= 550] | Loss=4.86557 | acc=0.1409 | tpr=0.6713 | fpr=0.8688 | 14734.5 samples/s | 57.6 steps/s
Avg test loss: 4.86778, Avg test acc: 0.14083, Avg tpr: 0.67116, Avg fpr: 0.86881, total FA: 120633

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10349 | acc=0.9805 | tpr=0.9425 | fpr=0.0188 | 4063.5 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.10753 | acc=0.9800 | tpr=0.9574 | fpr=0.0196 | 8194.4 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.11166 | acc=0.9792 | tpr=0.9568 | fpr=0.0204 | 8178.6 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.11368 | acc=0.9792 | tpr=0.9607 | fpr=0.0205 | 7941.2 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.11324 | acc=0.9792 | tpr=0.9555 | fpr=0.0204 | 8068.7 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.11535 | acc=0.9788 | tpr=0.9527 | fpr=0.0207 | 8112.9 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.11529 | acc=0.9786 | tpr=0.9505 | fpr=0.0209 | 8100.1 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.11649 | acc=0.9785 | tpr=0.9480 | fpr=0.0209 | 4688.4 samples/s | 18.3 steps/s
[Step= 450] | Loss=0.11920 | acc=0.9783 | tpr=0.9469 | fpr=0.0211 | 7820.9 samples/s | 30.6 steps/s
[Step= 500] | Loss=0.11899 | acc=0.9783 | tpr=0.9480 | fpr=0.0211 | 7748.8 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.11801 | acc=0.9785 | tpr=0.9479 | fpr=0.0209 | 15099.1 samples/s | 59.0 steps/s
Avg test loss: 0.11784, Avg test acc: 0.97852, Avg tpr: 0.94810, Avg fpr: 0.02092, total FA: 2905

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11424 | acc=0.9812 | tpr=0.9115 | fpr=0.0176 | 4076.7 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.11835 | acc=0.9810 | tpr=0.9211 | fpr=0.0179 | 8220.8 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.12327 | acc=0.9799 | tpr=0.9193 | fpr=0.0190 | 8116.5 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.12485 | acc=0.9800 | tpr=0.9246 | fpr=0.0190 | 6999.6 samples/s | 27.3 steps/s
[Step= 250] | Loss=0.12380 | acc=0.9799 | tpr=0.9231 | fpr=0.0191 | 8333.2 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.12616 | acc=0.9795 | tpr=0.9229 | fpr=0.0195 | 7996.3 samples/s | 31.2 steps/s
[Step= 350] | Loss=0.12633 | acc=0.9793 | tpr=0.9249 | fpr=0.0197 | 8011.8 samples/s | 31.3 steps/s
[Step= 400] | Loss=0.12762 | acc=0.9792 | tpr=0.9212 | fpr=0.0197 | 5275.5 samples/s | 20.6 steps/s
[Step= 450] | Loss=0.13089 | acc=0.9790 | tpr=0.9202 | fpr=0.0199 | 7928.8 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.13043 | acc=0.9791 | tpr=0.9238 | fpr=0.0199 | 7977.6 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.12956 | acc=0.9792 | tpr=0.9236 | fpr=0.0198 | 15081.7 samples/s | 58.9 steps/s
Avg test loss: 0.12932, Avg test acc: 0.97921, Avg tpr: 0.92314, Avg fpr: 0.01977, total FA: 2745

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.12618 | acc=0.9776 | tpr=0.9336 | fpr=0.0216 | 4012.6 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.12979 | acc=0.9781 | tpr=0.9510 | fpr=0.0214 | 7845.5 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.13363 | acc=0.9772 | tpr=0.9481 | fpr=0.0222 | 7815.4 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.13593 | acc=0.9771 | tpr=0.9508 | fpr=0.0225 | 5823.6 samples/s | 22.7 steps/s
[Step= 250] | Loss=0.13554 | acc=0.9768 | tpr=0.9502 | fpr=0.0227 | 8253.3 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.13884 | acc=0.9764 | tpr=0.9476 | fpr=0.0231 | 7681.4 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.13932 | acc=0.9762 | tpr=0.9468 | fpr=0.0232 | 6920.7 samples/s | 27.0 steps/s
[Step= 400] | Loss=0.14107 | acc=0.9761 | tpr=0.9420 | fpr=0.0233 | 6929.7 samples/s | 27.1 steps/s
[Step= 450] | Loss=0.14464 | acc=0.9758 | tpr=0.9421 | fpr=0.0236 | 8028.8 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.14410 | acc=0.9758 | tpr=0.9441 | fpr=0.0236 | 7979.9 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.14285 | acc=0.9761 | tpr=0.9431 | fpr=0.0233 | 13923.8 samples/s | 54.4 steps/s
Avg test loss: 0.14265, Avg test acc: 0.97608, Avg tpr: 0.94334, Avg fpr: 0.02333, total FA: 3239

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11524 | acc=0.9808 | tpr=0.9204 | fpr=0.0181 | 4146.2 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.12037 | acc=0.9802 | tpr=0.9382 | fpr=0.0190 | 7885.4 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.12518 | acc=0.9794 | tpr=0.9395 | fpr=0.0198 | 7107.1 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.12751 | acc=0.9793 | tpr=0.9475 | fpr=0.0201 | 6947.8 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.12623 | acc=0.9791 | tpr=0.9432 | fpr=0.0203 | 8053.6 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.12822 | acc=0.9788 | tpr=0.9433 | fpr=0.0205 | 7939.9 samples/s | 31.0 steps/s
[Step= 350] | Loss=0.12822 | acc=0.9787 | tpr=0.9461 | fpr=0.0207 | 5678.9 samples/s | 22.2 steps/s
[Step= 400] | Loss=0.12921 | acc=0.9786 | tpr=0.9420 | fpr=0.0207 | 7767.9 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.13236 | acc=0.9783 | tpr=0.9416 | fpr=0.0210 | 7879.2 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.13199 | acc=0.9784 | tpr=0.9436 | fpr=0.0210 | 8113.3 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.13110 | acc=0.9786 | tpr=0.9435 | fpr=0.0208 | 14413.7 samples/s | 56.3 steps/s
Avg test loss: 0.13093, Avg test acc: 0.97859, Avg tpr: 0.94334, Avg fpr: 0.02077, total FA: 2884

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12488 | acc=0.9804 | tpr=0.9204 | fpr=0.0185 | 4046.9 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.12984 | acc=0.9803 | tpr=0.9446 | fpr=0.0190 | 8775.1 samples/s | 34.3 steps/s
[Step= 150] | Loss=0.13552 | acc=0.9789 | tpr=0.9452 | fpr=0.0205 | 6143.6 samples/s | 24.0 steps/s
[Step= 200] | Loss=0.13807 | acc=0.9787 | tpr=0.9497 | fpr=0.0208 | 7965.0 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.13665 | acc=0.9787 | tpr=0.9459 | fpr=0.0207 | 8112.8 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.13936 | acc=0.9783 | tpr=0.9469 | fpr=0.0211 | 7892.2 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.13994 | acc=0.9780 | tpr=0.9487 | fpr=0.0214 | 5448.1 samples/s | 21.3 steps/s
[Step= 400] | Loss=0.14121 | acc=0.9778 | tpr=0.9447 | fpr=0.0216 | 7370.9 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.14438 | acc=0.9775 | tpr=0.9440 | fpr=0.0219 | 8120.4 samples/s | 31.7 steps/s
[Step= 500] | Loss=0.14386 | acc=0.9775 | tpr=0.9441 | fpr=0.0219 | 8310.7 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.14297 | acc=0.9777 | tpr=0.9427 | fpr=0.0217 | 13276.2 samples/s | 51.9 steps/s
Avg test loss: 0.14273, Avg test acc: 0.97772, Avg tpr: 0.94295, Avg fpr: 0.02165, total FA: 3006

server round 35/50

clients selected: [0 1 2 8 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=30001 Epoch=146.3] | Loss=0.03426 | Reg=0.00099 | acc=0.9531 | L2-Norm=9.950 | L2-Norm(final)=10.816 | 3768.3 samples/s | 58.9 steps/s
[Step=30050 Epoch=146.5] | Loss=0.02228 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.957 | L2-Norm(final)=10.812 | 4770.4 samples/s | 74.5 steps/s
[Step=30100 Epoch=146.8] | Loss=0.02241 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.967 | L2-Norm(final)=10.812 | 5354.1 samples/s | 83.7 steps/s
[Step=30150 Epoch=147.0] | Loss=0.02324 | Reg=0.00099 | acc=0.9688 | L2-Norm=9.974 | L2-Norm(final)=10.813 | 5021.0 samples/s | 78.5 steps/s
[Step=30200 Epoch=147.3] | Loss=0.02161 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.981 | L2-Norm(final)=10.815 | 7058.6 samples/s | 110.3 steps/s
[Step=30250 Epoch=147.5] | Loss=0.01994 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.990 | L2-Norm(final)=10.819 | 1773.4 samples/s | 27.7 steps/s
[Step=30300 Epoch=147.7] | Loss=0.01913 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.998 | L2-Norm(final)=10.825 | 5108.1 samples/s | 79.8 steps/s
[Step=30350 Epoch=148.0] | Loss=0.01925 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.006 | L2-Norm(final)=10.830 | 5060.4 samples/s | 79.1 steps/s
[Step=30400 Epoch=148.2] | Loss=0.01887 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.014 | L2-Norm(final)=10.836 | 6656.5 samples/s | 104.0 steps/s
[Step=30450 Epoch=148.5] | Loss=0.01821 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.022 | L2-Norm(final)=10.842 | 1810.9 samples/s | 28.3 steps/s
[Step=30500 Epoch=148.7] | Loss=0.01794 | Reg=0.00101 | acc=0.9688 | L2-Norm=10.030 | L2-Norm(final)=10.848 | 5131.8 samples/s | 80.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=30501 Epoch=148.7] | Loss=0.00318 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.108 | L2-Norm(final)=10.911 | 3674.4 samples/s | 57.4 steps/s
[Step=30550 Epoch=149.0] | Loss=0.01545 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.119 | L2-Norm(final)=10.919 | 4360.5 samples/s | 68.1 steps/s
[Step=30600 Epoch=149.2] | Loss=0.01587 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.132 | L2-Norm(final)=10.926 | 4530.6 samples/s | 70.8 steps/s
[Step=30650 Epoch=149.5] | Loss=0.01533 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.144 | L2-Norm(final)=10.932 | 4586.2 samples/s | 71.7 steps/s
[Step=30700 Epoch=149.7] | Loss=0.01544 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.155 | L2-Norm(final)=10.938 | 5992.8 samples/s | 93.6 steps/s
[Step=30750 Epoch=149.9] | Loss=0.01419 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.165 | L2-Norm(final)=10.944 | 1710.9 samples/s | 26.7 steps/s
[Step=30800 Epoch=150.2] | Loss=0.01295 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.174 | L2-Norm(final)=10.949 | 4635.8 samples/s | 72.4 steps/s
[Step=30850 Epoch=150.4] | Loss=0.01223 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.181 | L2-Norm(final)=10.954 | 4520.0 samples/s | 70.6 steps/s
[Step=30900 Epoch=150.7] | Loss=0.01131 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.188 | L2-Norm(final)=10.960 | 5704.3 samples/s | 89.1 steps/s
[Step=30950 Epoch=150.9] | Loss=0.01077 | Reg=0.00104 | acc=0.9688 | L2-Norm=10.195 | L2-Norm(final)=10.965 | 1785.8 samples/s | 27.9 steps/s
[Step=31000 Epoch=151.2] | Loss=0.01032 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.201 | L2-Norm(final)=10.969 | 4593.6 samples/s | 71.8 steps/s
[Step=31050 Epoch=151.4] | Loss=0.00982 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.207 | L2-Norm(final)=10.974 | 4489.3 samples/s | 70.1 steps/s
[Step=31100 Epoch=151.6] | Loss=0.00940 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.212 | L2-Norm(final)=10.978 | 5175.7 samples/s | 80.9 steps/s
[Step=31150 Epoch=151.9] | Loss=0.00904 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.217 | L2-Norm(final)=10.983 | 1824.9 samples/s | 28.5 steps/s
[Step=31200 Epoch=152.1] | Loss=0.00862 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.222 | L2-Norm(final)=10.987 | 4559.8 samples/s | 71.2 steps/s
[Step=31250 Epoch=152.4] | Loss=0.00835 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.226 | L2-Norm(final)=10.991 | 4540.1 samples/s | 70.9 steps/s
[Step=31300 Epoch=152.6] | Loss=0.00821 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.231 | L2-Norm(final)=10.995 | 4961.3 samples/s | 77.5 steps/s
[Step=31350 Epoch=152.9] | Loss=0.00795 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.235 | L2-Norm(final)=10.998 | 1852.0 samples/s | 28.9 steps/s
[Step=31400 Epoch=153.1] | Loss=0.00770 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.239 | L2-Norm(final)=11.002 | 4600.7 samples/s | 71.9 steps/s
[Step=31450 Epoch=153.4] | Loss=0.00746 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.242 | L2-Norm(final)=11.005 | 4569.0 samples/s | 71.4 steps/s
[Step=31500 Epoch=153.6] | Loss=0.00734 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.246 | L2-Norm(final)=11.009 | 4765.4 samples/s | 74.5 steps/s
[Step=31550 Epoch=153.8] | Loss=0.00716 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.249 | L2-Norm(final)=11.012 | 1873.8 samples/s | 29.3 steps/s
[Step=31600 Epoch=154.1] | Loss=0.00700 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.253 | L2-Norm(final)=11.015 | 4676.9 samples/s | 73.1 steps/s
[Step=31650 Epoch=154.3] | Loss=0.00685 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.256 | L2-Norm(final)=11.019 | 4630.5 samples/s | 72.4 steps/s
[Step=31700 Epoch=154.6] | Loss=0.00673 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.259 | L2-Norm(final)=11.022 | 4462.1 samples/s | 69.7 steps/s
[Step=31750 Epoch=154.8] | Loss=0.00664 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.262 | L2-Norm(final)=11.025 | 1922.2 samples/s | 30.0 steps/s
[Step=31800 Epoch=155.1] | Loss=0.00651 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.266 | L2-Norm(final)=11.028 | 4716.8 samples/s | 73.7 steps/s
[Step=31850 Epoch=155.3] | Loss=0.00639 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.269 | L2-Norm(final)=11.031 | 4649.9 samples/s | 72.7 steps/s
[Step=31900 Epoch=155.6] | Loss=0.00635 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.272 | L2-Norm(final)=11.034 | 4666.0 samples/s | 72.9 steps/s
[Step=31950 Epoch=155.8] | Loss=0.00621 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.275 | L2-Norm(final)=11.037 | 1950.2 samples/s | 30.5 steps/s
[Step=32000 Epoch=156.0] | Loss=0.00612 | Reg=0.00106 | acc=1.0000 | L2-Norm=10.277 | L2-Norm(final)=11.039 | 4599.2 samples/s | 71.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step32000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=44001 Epoch=214.7] | Loss=0.00590 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.950 | L2-Norm(final)=12.806 | 3755.8 samples/s | 58.7 steps/s
[Step=44050 Epoch=214.9] | Loss=0.03059 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.963 | L2-Norm(final)=12.796 | 4826.1 samples/s | 75.4 steps/s
[Step=44100 Epoch=215.2] | Loss=0.02492 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.975 | L2-Norm(final)=12.791 | 5135.1 samples/s | 80.2 steps/s
[Step=44150 Epoch=215.4] | Loss=0.02272 | Reg=0.00100 | acc=0.9688 | L2-Norm=9.985 | L2-Norm(final)=12.791 | 5203.0 samples/s | 81.3 steps/s
[Step=44200 Epoch=215.7] | Loss=0.02130 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.993 | L2-Norm(final)=12.792 | 7269.9 samples/s | 113.6 steps/s
[Step=44250 Epoch=215.9] | Loss=0.02057 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.001 | L2-Norm(final)=12.794 | 1812.8 samples/s | 28.3 steps/s
[Step=44300 Epoch=216.2] | Loss=0.01925 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.009 | L2-Norm(final)=12.798 | 5148.9 samples/s | 80.5 steps/s
[Step=44350 Epoch=216.4] | Loss=0.01847 | Reg=0.00100 | acc=0.9688 | L2-Norm=10.016 | L2-Norm(final)=12.802 | 5112.8 samples/s | 79.9 steps/s
[Step=44400 Epoch=216.7] | Loss=0.01796 | Reg=0.00100 | acc=0.9688 | L2-Norm=10.023 | L2-Norm(final)=12.806 | 6713.9 samples/s | 104.9 steps/s
[Step=44450 Epoch=216.9] | Loss=0.01727 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.030 | L2-Norm(final)=12.810 | 1797.1 samples/s | 28.1 steps/s
[Step=44500 Epoch=217.1] | Loss=0.01673 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.037 | L2-Norm(final)=12.815 | 5160.1 samples/s | 80.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=44501 Epoch=217.1] | Loss=0.00737 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.104 | L2-Norm(final)=12.863 | 3900.0 samples/s | 60.9 steps/s
[Step=44550 Epoch=217.4] | Loss=0.01176 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.116 | L2-Norm(final)=12.869 | 4394.7 samples/s | 68.7 steps/s
[Step=44600 Epoch=217.6] | Loss=0.01322 | Reg=0.00103 | acc=0.9688 | L2-Norm=10.126 | L2-Norm(final)=12.874 | 4655.7 samples/s | 72.7 steps/s
[Step=44650 Epoch=217.9] | Loss=0.01420 | Reg=0.00103 | acc=0.9688 | L2-Norm=10.135 | L2-Norm(final)=12.879 | 4601.6 samples/s | 71.9 steps/s
[Step=44700 Epoch=218.1] | Loss=0.01315 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.143 | L2-Norm(final)=12.883 | 6254.7 samples/s | 97.7 steps/s
[Step=44750 Epoch=218.4] | Loss=0.01201 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.150 | L2-Norm(final)=12.887 | 1764.8 samples/s | 27.6 steps/s
[Step=44800 Epoch=218.6] | Loss=0.01089 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.156 | L2-Norm(final)=12.891 | 4784.3 samples/s | 74.8 steps/s
[Step=44850 Epoch=218.8] | Loss=0.00998 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.162 | L2-Norm(final)=12.895 | 4573.4 samples/s | 71.5 steps/s
[Step=44900 Epoch=219.1] | Loss=0.00967 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.167 | L2-Norm(final)=12.899 | 5754.9 samples/s | 89.9 steps/s
[Step=44950 Epoch=219.3] | Loss=0.00900 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.172 | L2-Norm(final)=12.902 | 1765.7 samples/s | 27.6 steps/s
[Step=45000 Epoch=219.6] | Loss=0.00850 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.176 | L2-Norm(final)=12.906 | 4633.2 samples/s | 72.4 steps/s
[Step=45050 Epoch=219.8] | Loss=0.00808 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.181 | L2-Norm(final)=12.909 | 4487.2 samples/s | 70.1 steps/s
[Step=45100 Epoch=220.1] | Loss=0.00789 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.185 | L2-Norm(final)=12.913 | 5328.9 samples/s | 83.3 steps/s
[Step=45150 Epoch=220.3] | Loss=0.00775 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.189 | L2-Norm(final)=12.916 | 1800.4 samples/s | 28.1 steps/s
[Step=45200 Epoch=220.6] | Loss=0.00741 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.193 | L2-Norm(final)=12.919 | 4459.4 samples/s | 69.7 steps/s
[Step=45250 Epoch=220.8] | Loss=0.00718 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.196 | L2-Norm(final)=12.922 | 4579.3 samples/s | 71.6 steps/s
[Step=45300 Epoch=221.0] | Loss=0.00694 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.200 | L2-Norm(final)=12.925 | 5076.5 samples/s | 79.3 steps/s
[Step=45350 Epoch=221.3] | Loss=0.00670 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.203 | L2-Norm(final)=12.928 | 1834.8 samples/s | 28.7 steps/s
[Step=45400 Epoch=221.5] | Loss=0.00660 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.206 | L2-Norm(final)=12.931 | 4677.2 samples/s | 73.1 steps/s
[Step=45450 Epoch=221.8] | Loss=0.00640 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.209 | L2-Norm(final)=12.933 | 4429.8 samples/s | 69.2 steps/s
[Step=45500 Epoch=222.0] | Loss=0.00622 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.212 | L2-Norm(final)=12.936 | 4851.4 samples/s | 75.8 steps/s
[Step=45550 Epoch=222.3] | Loss=0.00610 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.215 | L2-Norm(final)=12.938 | 1869.3 samples/s | 29.2 steps/s
[Step=45600 Epoch=222.5] | Loss=0.00595 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.218 | L2-Norm(final)=12.941 | 4517.2 samples/s | 70.6 steps/s
[Step=45650 Epoch=222.8] | Loss=0.00588 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.220 | L2-Norm(final)=12.944 | 4510.6 samples/s | 70.5 steps/s
[Step=45700 Epoch=223.0] | Loss=0.00572 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.223 | L2-Norm(final)=12.946 | 4629.3 samples/s | 72.3 steps/s
[Step=45750 Epoch=223.2] | Loss=0.00559 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.225 | L2-Norm(final)=12.948 | 1237.8 samples/s | 19.3 steps/s
[Step=45800 Epoch=223.5] | Loss=0.00553 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=12.951 | 4737.1 samples/s | 74.0 steps/s
[Step=45850 Epoch=223.7] | Loss=0.00544 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.230 | L2-Norm(final)=12.953 | 4190.1 samples/s | 65.5 steps/s
[Step=45900 Epoch=224.0] | Loss=0.00537 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.232 | L2-Norm(final)=12.955 | 4704.6 samples/s | 73.5 steps/s
[Step=45950 Epoch=224.2] | Loss=0.00527 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.235 | L2-Norm(final)=12.957 | 1913.3 samples/s | 29.9 steps/s
[Step=46000 Epoch=224.5] | Loss=0.00515 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.237 | L2-Norm(final)=12.960 | 4579.0 samples/s | 71.5 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step46000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=34001 Epoch=165.7] | Loss=0.02383 | Reg=0.00099 | acc=0.9688 | L2-Norm=9.950 | L2-Norm(final)=12.644 | 3801.1 samples/s | 59.4 steps/s
[Step=34050 Epoch=165.9] | Loss=0.02717 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.956 | L2-Norm(final)=12.637 | 4627.3 samples/s | 72.3 steps/s
[Step=34100 Epoch=166.2] | Loss=0.02455 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.966 | L2-Norm(final)=12.635 | 5337.5 samples/s | 83.4 steps/s
[Step=34150 Epoch=166.4] | Loss=0.02347 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.974 | L2-Norm(final)=12.634 | 5269.6 samples/s | 82.3 steps/s
[Step=34200 Epoch=166.6] | Loss=0.02193 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.982 | L2-Norm(final)=12.636 | 7073.7 samples/s | 110.5 steps/s
[Step=34250 Epoch=166.9] | Loss=0.02072 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.990 | L2-Norm(final)=12.639 | 1796.4 samples/s | 28.1 steps/s
[Step=34300 Epoch=167.1] | Loss=0.01981 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.998 | L2-Norm(final)=12.644 | 5248.7 samples/s | 82.0 steps/s
[Step=34350 Epoch=167.4] | Loss=0.01911 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.005 | L2-Norm(final)=12.649 | 5188.8 samples/s | 81.1 steps/s
[Step=34400 Epoch=167.6] | Loss=0.01876 | Reg=0.00100 | acc=0.9688 | L2-Norm=10.012 | L2-Norm(final)=12.654 | 6716.1 samples/s | 104.9 steps/s
[Step=34450 Epoch=167.9] | Loss=0.01823 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.019 | L2-Norm(final)=12.660 | 1826.2 samples/s | 28.5 steps/s
[Step=34500 Epoch=168.1] | Loss=0.01770 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.026 | L2-Norm(final)=12.665 | 4956.2 samples/s | 77.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=168.1] | Loss=0.02203 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.093 | L2-Norm(final)=12.724 | 3648.9 samples/s | 57.0 steps/s
[Step=34550 Epoch=168.3] | Loss=0.01294 | Reg=0.00102 | acc=0.9688 | L2-Norm=10.104 | L2-Norm(final)=12.731 | 4735.1 samples/s | 74.0 steps/s
[Step=34600 Epoch=168.6] | Loss=0.01361 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.115 | L2-Norm(final)=12.738 | 4577.8 samples/s | 71.5 steps/s
[Step=34650 Epoch=168.8] | Loss=0.01308 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.125 | L2-Norm(final)=12.744 | 4624.9 samples/s | 72.3 steps/s
[Step=34700 Epoch=169.1] | Loss=0.01418 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=12.750 | 6153.4 samples/s | 96.1 steps/s
[Step=34750 Epoch=169.3] | Loss=0.01292 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.145 | L2-Norm(final)=12.756 | 1758.7 samples/s | 27.5 steps/s
[Step=34800 Epoch=169.6] | Loss=0.01186 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.153 | L2-Norm(final)=12.761 | 4543.4 samples/s | 71.0 steps/s
[Step=34850 Epoch=169.8] | Loss=0.01125 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.160 | L2-Norm(final)=12.766 | 4544.6 samples/s | 71.0 steps/s
[Step=34900 Epoch=170.0] | Loss=0.01060 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.167 | L2-Norm(final)=12.771 | 5740.5 samples/s | 89.7 steps/s
[Step=34950 Epoch=170.3] | Loss=0.00989 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.173 | L2-Norm(final)=12.776 | 1786.5 samples/s | 27.9 steps/s
[Step=35000 Epoch=170.5] | Loss=0.00937 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.179 | L2-Norm(final)=12.780 | 4613.2 samples/s | 72.1 steps/s
[Step=35050 Epoch=170.8] | Loss=0.00899 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.185 | L2-Norm(final)=12.784 | 4645.5 samples/s | 72.6 steps/s
[Step=35100 Epoch=171.0] | Loss=0.00865 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.190 | L2-Norm(final)=12.788 | 5320.0 samples/s | 83.1 steps/s
[Step=35150 Epoch=171.3] | Loss=0.00837 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.194 | L2-Norm(final)=12.792 | 1870.5 samples/s | 29.2 steps/s
[Step=35200 Epoch=171.5] | Loss=0.00803 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.199 | L2-Norm(final)=12.796 | 4547.2 samples/s | 71.0 steps/s
[Step=35250 Epoch=171.8] | Loss=0.00781 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.203 | L2-Norm(final)=12.800 | 4534.5 samples/s | 70.9 steps/s
[Step=35300 Epoch=172.0] | Loss=0.00757 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.207 | L2-Norm(final)=12.803 | 4948.2 samples/s | 77.3 steps/s
[Step=35350 Epoch=172.2] | Loss=0.00733 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.211 | L2-Norm(final)=12.806 | 1884.6 samples/s | 29.4 steps/s
[Step=35400 Epoch=172.5] | Loss=0.00712 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.215 | L2-Norm(final)=12.810 | 4595.1 samples/s | 71.8 steps/s
[Step=35450 Epoch=172.7] | Loss=0.00697 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.218 | L2-Norm(final)=12.813 | 4585.8 samples/s | 71.7 steps/s
[Step=35500 Epoch=173.0] | Loss=0.00678 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.222 | L2-Norm(final)=12.816 | 4746.1 samples/s | 74.2 steps/s
[Step=35550 Epoch=173.2] | Loss=0.00653 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.225 | L2-Norm(final)=12.819 | 1924.4 samples/s | 30.1 steps/s
[Step=35600 Epoch=173.5] | Loss=0.00641 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.228 | L2-Norm(final)=12.822 | 4720.9 samples/s | 73.8 steps/s
[Step=35650 Epoch=173.7] | Loss=0.00630 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.232 | L2-Norm(final)=12.825 | 4575.5 samples/s | 71.5 steps/s
[Step=35700 Epoch=173.9] | Loss=0.00619 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.235 | L2-Norm(final)=12.828 | 4704.1 samples/s | 73.5 steps/s
[Step=35750 Epoch=174.2] | Loss=0.00610 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.238 | L2-Norm(final)=12.831 | 1909.2 samples/s | 29.8 steps/s
[Step=35800 Epoch=174.4] | Loss=0.00596 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.241 | L2-Norm(final)=12.833 | 4635.9 samples/s | 72.4 steps/s
[Step=35850 Epoch=174.7] | Loss=0.00586 | Reg=0.00105 | acc=0.9844 | L2-Norm=10.244 | L2-Norm(final)=12.836 | 4481.4 samples/s | 70.0 steps/s
[Step=35900 Epoch=174.9] | Loss=0.00582 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.246 | L2-Norm(final)=12.839 | 4719.2 samples/s | 73.7 steps/s
[Step=35950 Epoch=175.2] | Loss=0.00569 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.249 | L2-Norm(final)=12.842 | 1912.9 samples/s | 29.9 steps/s
[Step=36000 Epoch=175.4] | Loss=0.00563 | Reg=0.00105 | acc=1.0000 | L2-Norm=10.252 | L2-Norm(final)=12.844 | 4493.6 samples/s | 70.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step36000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=32001 Epoch=301.5] | Loss=0.00003 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.950 | L2-Norm(final)=8.691 | 3666.4 samples/s | 57.3 steps/s
[Step=32050 Epoch=302.0] | Loss=0.00258 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.968 | L2-Norm(final)=8.686 | 4392.8 samples/s | 68.6 steps/s
[Step=32100 Epoch=302.5] | Loss=0.00169 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.987 | L2-Norm(final)=8.689 | 6756.3 samples/s | 105.6 steps/s
[Step=32150 Epoch=302.9] | Loss=0.00119 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.997 | L2-Norm(final)=8.695 | 1758.5 samples/s | 27.5 steps/s
[Step=32200 Epoch=303.4] | Loss=0.00092 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.001 | L2-Norm(final)=8.700 | 6014.9 samples/s | 94.0 steps/s
[Step=32250 Epoch=303.9] | Loss=0.00076 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.003 | L2-Norm(final)=8.704 | 1824.5 samples/s | 28.5 steps/s
[Step=32300 Epoch=304.4] | Loss=0.00065 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.004 | L2-Norm(final)=8.707 | 5426.5 samples/s | 84.8 steps/s
[Step=32350 Epoch=304.8] | Loss=0.00057 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.004 | L2-Norm(final)=8.711 | 1889.1 samples/s | 29.5 steps/s
[Step=32400 Epoch=305.3] | Loss=0.00051 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.004 | L2-Norm(final)=8.714 | 5163.3 samples/s | 80.7 steps/s
[Step=32450 Epoch=305.8] | Loss=0.00046 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.004 | L2-Norm(final)=8.717 | 1932.0 samples/s | 30.2 steps/s
[Step=32500 Epoch=306.2] | Loss=0.00042 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.003 | L2-Norm(final)=8.720 | 4749.6 samples/s | 74.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=306.3] | Loss=0.00009 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.995 | L2-Norm(final)=8.749 | 3559.6 samples/s | 55.6 steps/s
[Step=32550 Epoch=306.7] | Loss=0.00175 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.998 | L2-Norm(final)=8.752 | 4291.5 samples/s | 67.1 steps/s
[Step=32600 Epoch=307.2] | Loss=0.00165 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.019 | L2-Norm(final)=8.754 | 5885.5 samples/s | 92.0 steps/s
[Step=32650 Epoch=307.7] | Loss=0.00111 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.031 | L2-Norm(final)=8.756 | 1704.5 samples/s | 26.6 steps/s
[Step=32700 Epoch=308.1] | Loss=0.00084 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.035 | L2-Norm(final)=8.757 | 5353.4 samples/s | 83.6 steps/s
[Step=32750 Epoch=308.6] | Loss=0.00068 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.037 | L2-Norm(final)=8.758 | 1758.3 samples/s | 27.5 steps/s
[Step=32800 Epoch=309.1] | Loss=0.00057 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.038 | L2-Norm(final)=8.759 | 4900.3 samples/s | 76.6 steps/s
[Step=32850 Epoch=309.5] | Loss=0.00049 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.037 | L2-Norm(final)=8.759 | 1780.5 samples/s | 27.8 steps/s
[Step=32900 Epoch=310.0] | Loss=0.00043 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.036 | L2-Norm(final)=8.760 | 4547.7 samples/s | 71.1 steps/s
[Step=32950 Epoch=310.5] | Loss=0.00038 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.035 | L2-Norm(final)=8.761 | 1865.7 samples/s | 29.2 steps/s
[Step=33000 Epoch=311.0] | Loss=0.00035 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.033 | L2-Norm(final)=8.761 | 4416.1 samples/s | 69.0 steps/s
[Step=33050 Epoch=311.4] | Loss=0.00032 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.031 | L2-Norm(final)=8.762 | 1897.5 samples/s | 29.6 steps/s
[Step=33100 Epoch=311.9] | Loss=0.00029 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.029 | L2-Norm(final)=8.762 | 4349.1 samples/s | 68.0 steps/s
[Step=33150 Epoch=312.4] | Loss=0.00027 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.027 | L2-Norm(final)=8.763 | 1896.4 samples/s | 29.6 steps/s
[Step=33200 Epoch=312.8] | Loss=0.00025 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=8.763 | 4449.6 samples/s | 69.5 steps/s
[Step=33250 Epoch=313.3] | Loss=0.00023 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.022 | L2-Norm(final)=8.764 | 2003.8 samples/s | 31.3 steps/s
[Step=33300 Epoch=313.8] | Loss=0.00022 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.020 | L2-Norm(final)=8.764 | 4016.6 samples/s | 62.8 steps/s
[Step=33350 Epoch=314.3] | Loss=0.00021 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.017 | L2-Norm(final)=8.765 | 5961.9 samples/s | 93.2 steps/s
[Step=33400 Epoch=314.7] | Loss=0.00020 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.014 | L2-Norm(final)=8.765 | 1695.8 samples/s | 26.5 steps/s
[Step=33450 Epoch=315.2] | Loss=0.00019 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.012 | L2-Norm(final)=8.765 | 5473.1 samples/s | 85.5 steps/s
[Step=33500 Epoch=315.7] | Loss=0.00018 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.009 | L2-Norm(final)=8.766 | 1710.1 samples/s | 26.7 steps/s
[Step=33550 Epoch=316.1] | Loss=0.00017 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.006 | L2-Norm(final)=8.766 | 5030.4 samples/s | 78.6 steps/s
[Step=33600 Epoch=316.6] | Loss=0.00016 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.003 | L2-Norm(final)=8.767 | 1815.0 samples/s | 28.4 steps/s
[Step=33650 Epoch=317.1] | Loss=0.00016 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.000 | L2-Norm(final)=8.767 | 4616.0 samples/s | 72.1 steps/s
[Step=33700 Epoch=317.6] | Loss=0.00015 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.997 | L2-Norm(final)=8.767 | 1838.8 samples/s | 28.7 steps/s
[Step=33750 Epoch=318.0] | Loss=0.00014 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.994 | L2-Norm(final)=8.768 | 4470.4 samples/s | 69.8 steps/s
[Step=33800 Epoch=318.5] | Loss=0.00014 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.991 | L2-Norm(final)=8.768 | 1869.0 samples/s | 29.2 steps/s
[Step=33850 Epoch=319.0] | Loss=0.00013 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.988 | L2-Norm(final)=8.768 | 4487.2 samples/s | 70.1 steps/s
[Step=33900 Epoch=319.4] | Loss=0.00013 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.984 | L2-Norm(final)=8.769 | 1922.4 samples/s | 30.0 steps/s
[Step=33950 Epoch=319.9] | Loss=0.00012 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.981 | L2-Norm(final)=8.769 | 4259.3 samples/s | 66.6 steps/s
[Step=34000 Epoch=320.4] | Loss=0.00012 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.978 | L2-Norm(final)=8.769 | 1907.0 samples/s | 29.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step34000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=36001 Epoch=343.1] | Loss=0.00378 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.950 | L2-Norm(final)=9.346 | 3771.9 samples/s | 58.9 steps/s
[Step=36050 Epoch=343.6] | Loss=0.00243 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.974 | L2-Norm(final)=9.352 | 4240.9 samples/s | 66.3 steps/s
[Step=36100 Epoch=344.1] | Loss=0.00187 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.994 | L2-Norm(final)=9.362 | 6955.4 samples/s | 108.7 steps/s
[Step=36150 Epoch=344.5] | Loss=0.00139 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.006 | L2-Norm(final)=9.370 | 1735.8 samples/s | 27.1 steps/s
[Step=36200 Epoch=345.0] | Loss=0.00108 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.013 | L2-Norm(final)=9.377 | 6553.8 samples/s | 102.4 steps/s
[Step=36250 Epoch=345.5] | Loss=0.00089 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.018 | L2-Norm(final)=9.382 | 1796.8 samples/s | 28.1 steps/s
[Step=36300 Epoch=346.0] | Loss=0.00076 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.020 | L2-Norm(final)=9.387 | 5803.2 samples/s | 90.7 steps/s
[Step=36350 Epoch=346.4] | Loss=0.00067 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.022 | L2-Norm(final)=9.391 | 1746.9 samples/s | 27.3 steps/s
[Step=36400 Epoch=346.9] | Loss=0.00060 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.023 | L2-Norm(final)=9.395 | 5595.2 samples/s | 87.4 steps/s
[Step=36450 Epoch=347.4] | Loss=0.00054 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.024 | L2-Norm(final)=9.398 | 1846.1 samples/s | 28.8 steps/s
[Step=36500 Epoch=347.9] | Loss=0.00050 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.024 | L2-Norm(final)=9.402 | 5177.0 samples/s | 80.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=347.9] | Loss=0.00002 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.026 | L2-Norm(final)=9.434 | 3523.6 samples/s | 55.1 steps/s
[Step=36550 Epoch=348.4] | Loss=0.00012 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.031 | L2-Norm(final)=9.437 | 4246.5 samples/s | 66.4 steps/s
[Step=36600 Epoch=348.8] | Loss=0.00043 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.033 | L2-Norm(final)=9.439 | 5833.1 samples/s | 91.1 steps/s
[Step=36650 Epoch=349.3] | Loss=0.00086 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.043 | L2-Norm(final)=9.439 | 1647.8 samples/s | 25.7 steps/s
[Step=36700 Epoch=349.8] | Loss=0.00065 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.050 | L2-Norm(final)=9.440 | 5554.7 samples/s | 86.8 steps/s
[Step=36750 Epoch=350.3] | Loss=0.00053 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.054 | L2-Norm(final)=9.440 | 1703.3 samples/s | 26.6 steps/s
[Step=36800 Epoch=350.7] | Loss=0.00044 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.056 | L2-Norm(final)=9.441 | 5325.8 samples/s | 83.2 steps/s
[Step=36850 Epoch=351.2] | Loss=0.00038 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.056 | L2-Norm(final)=9.441 | 1759.5 samples/s | 27.5 steps/s
[Step=36900 Epoch=351.7] | Loss=0.00034 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.056 | L2-Norm(final)=9.442 | 4964.4 samples/s | 77.6 steps/s
[Step=36950 Epoch=352.2] | Loss=0.00030 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.055 | L2-Norm(final)=9.442 | 1795.2 samples/s | 28.0 steps/s
[Step=37000 Epoch=352.6] | Loss=0.00027 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.054 | L2-Norm(final)=9.442 | 4780.1 samples/s | 74.7 steps/s
[Step=37050 Epoch=353.1] | Loss=0.00025 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.053 | L2-Norm(final)=9.443 | 1841.6 samples/s | 28.8 steps/s
[Step=37100 Epoch=353.6] | Loss=0.00023 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.051 | L2-Norm(final)=9.443 | 4424.1 samples/s | 69.1 steps/s
[Step=37150 Epoch=354.1] | Loss=0.00021 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.049 | L2-Norm(final)=9.443 | 1861.7 samples/s | 29.1 steps/s
[Step=37200 Epoch=354.5] | Loss=0.00019 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.047 | L2-Norm(final)=9.444 | 4464.3 samples/s | 69.8 steps/s
[Step=37250 Epoch=355.0] | Loss=0.00018 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.045 | L2-Norm(final)=9.444 | 1865.0 samples/s | 29.1 steps/s
[Step=37300 Epoch=355.5] | Loss=0.00017 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.043 | L2-Norm(final)=9.444 | 4364.7 samples/s | 68.2 steps/s
[Step=37350 Epoch=356.0] | Loss=0.00016 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.041 | L2-Norm(final)=9.444 | 1866.7 samples/s | 29.2 steps/s
[Step=37400 Epoch=356.5] | Loss=0.00015 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.038 | L2-Norm(final)=9.445 | 4403.2 samples/s | 68.8 steps/s
[Step=37450 Epoch=356.9] | Loss=0.00015 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.036 | L2-Norm(final)=9.445 | 1899.8 samples/s | 29.7 steps/s
[Step=37500 Epoch=357.4] | Loss=0.00014 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.033 | L2-Norm(final)=9.445 | 4411.8 samples/s | 68.9 steps/s
[Step=37550 Epoch=357.9] | Loss=0.00013 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.030 | L2-Norm(final)=9.445 | 6398.1 samples/s | 100.0 steps/s
[Step=37600 Epoch=358.4] | Loss=0.00013 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.028 | L2-Norm(final)=9.446 | 1633.5 samples/s | 25.5 steps/s
[Step=37650 Epoch=358.8] | Loss=0.00012 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.025 | L2-Norm(final)=9.446 | 6011.4 samples/s | 93.9 steps/s
[Step=37700 Epoch=359.3] | Loss=0.00012 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.022 | L2-Norm(final)=9.446 | 1676.2 samples/s | 26.2 steps/s
[Step=37750 Epoch=359.8] | Loss=0.00011 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.019 | L2-Norm(final)=9.446 | 5600.6 samples/s | 87.5 steps/s
[Step=37800 Epoch=360.3] | Loss=0.00011 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.016 | L2-Norm(final)=9.446 | 1699.1 samples/s | 26.5 steps/s
[Step=37850 Epoch=360.7] | Loss=0.00010 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.013 | L2-Norm(final)=9.447 | 5224.1 samples/s | 81.6 steps/s
[Step=37900 Epoch=361.2] | Loss=0.00010 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.010 | L2-Norm(final)=9.447 | 1670.4 samples/s | 26.1 steps/s
[Step=37950 Epoch=361.7] | Loss=0.00010 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.007 | L2-Norm(final)=9.447 | 4721.2 samples/s | 73.8 steps/s
[Step=38000 Epoch=362.2] | Loss=0.00009 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.003 | L2-Norm(final)=9.447 | 1735.8 samples/s | 27.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step38000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08114 | acc=0.9627 | tpr=0.9736 | fpr=0.0610 | 3804.9 samples/s | 14.9 steps/s
Avg test loss: 0.08391, Avg test acc: 0.96134, Avg tpr: 0.97255, Avg fpr: 0.06333, total FA: 494

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09051 | acc=0.9621 | tpr=0.9742 | fpr=0.0642 | 4053.4 samples/s | 15.8 steps/s
Avg test loss: 0.09363, Avg test acc: 0.96146, Avg tpr: 0.97331, Avg fpr: 0.06461, total FA: 504

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08841 | acc=0.9600 | tpr=0.9684 | fpr=0.0582 | 4180.2 samples/s | 16.3 steps/s
Avg test loss: 0.09244, Avg test acc: 0.95885, Avg tpr: 0.96660, Avg fpr: 0.05820, total FA: 454

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08681 | acc=0.9605 | tpr=0.9722 | fpr=0.0647 | 4134.3 samples/s | 16.1 steps/s
Avg test loss: 0.09128, Avg test acc: 0.96033, Avg tpr: 0.97185, Avg fpr: 0.06499, total FA: 507

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.09025 | acc=0.9616 | tpr=0.9673 | fpr=0.0508 | 4083.9 samples/s | 16.0 steps/s
Avg test loss: 0.09688, Avg test acc: 0.95949, Avg tpr: 0.96561, Avg fpr: 0.05397, total FA: 421

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.20561 | acc=0.2968 | tpr=0.0025 | fpr=0.0642 | 4082.0 samples/s | 15.9 steps/s
Avg test loss: 5.22214, Avg test acc: 0.29369, Avg tpr: 0.00303, Avg fpr: 0.06704, total FA: 523

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.81103 | acc=0.3137 | tpr=0.0040 | fpr=0.0136 | 4067.8 samples/s | 15.9 steps/s
Avg test loss: 4.81787, Avg test acc: 0.31128, Avg tpr: 0.00460, Avg fpr: 0.01423, total FA: 111

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.84140 | acc=0.3035 | tpr=0.0094 | fpr=0.0577 | 4031.5 samples/s | 15.7 steps/s
Avg test loss: 4.84805, Avg test acc: 0.30155, Avg tpr: 0.01026, Avg fpr: 0.05781, total FA: 451

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.05098 | acc=0.2966 | tpr=0.0054 | fpr=0.0709 | 4100.9 samples/s | 16.0 steps/s
Avg test loss: 5.06193, Avg test acc: 0.29490, Avg tpr: 0.00682, Avg fpr: 0.07153, total FA: 558

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.71685 | acc=0.3140 | tpr=0.0018 | fpr=0.0082 | 4300.1 samples/s | 16.8 steps/s
Avg test loss: 4.72739, Avg test acc: 0.31144, Avg tpr: 0.00192, Avg fpr: 0.00782, total FA: 61

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.16993 | acc=0.1222 | tpr=0.8274 | fpr=0.8905 | 4019.7 samples/s | 15.7 steps/s
[Step= 100] | Loss=5.11997 | acc=0.1242 | tpr=0.8038 | fpr=0.8885 | 7998.1 samples/s | 31.2 steps/s
[Step= 150] | Loss=5.11973 | acc=0.1222 | tpr=0.8199 | fpr=0.8907 | 8250.8 samples/s | 32.2 steps/s
[Step= 200] | Loss=5.11758 | acc=0.1217 | tpr=0.8164 | fpr=0.8910 | 8157.6 samples/s | 31.9 steps/s
[Step= 250] | Loss=5.12090 | acc=0.1228 | tpr=0.8183 | fpr=0.8898 | 7923.2 samples/s | 30.9 steps/s
[Step= 300] | Loss=5.11735 | acc=0.1222 | tpr=0.8131 | fpr=0.8904 | 7976.1 samples/s | 31.2 steps/s
[Step= 350] | Loss=5.11339 | acc=0.1217 | tpr=0.8078 | fpr=0.8907 | 7916.8 samples/s | 30.9 steps/s
[Step= 400] | Loss=5.11559 | acc=0.1220 | tpr=0.8047 | fpr=0.8904 | 7772.7 samples/s | 30.4 steps/s
[Step= 450] | Loss=5.11797 | acc=0.1217 | tpr=0.8014 | fpr=0.8907 | 8099.1 samples/s | 31.6 steps/s
[Step= 500] | Loss=5.12077 | acc=0.1215 | tpr=0.8004 | fpr=0.8907 | 7840.4 samples/s | 30.6 steps/s
[Step= 550] | Loss=5.12012 | acc=0.1214 | tpr=0.8054 | fpr=0.8910 | 13871.5 samples/s | 54.2 steps/s
Avg test loss: 5.12190, Avg test acc: 0.12135, Avg tpr: 0.80507, Avg fpr: 0.89108, total FA: 123725

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.19950 | acc=0.1308 | tpr=0.7655 | fpr=0.8806 | 4085.3 samples/s | 16.0 steps/s
[Step= 100] | Loss=5.14036 | acc=0.1322 | tpr=0.7505 | fpr=0.8793 | 8115.8 samples/s | 31.7 steps/s
[Step= 150] | Loss=5.14068 | acc=0.1296 | tpr=0.7507 | fpr=0.8818 | 7915.8 samples/s | 30.9 steps/s
[Step= 200] | Loss=5.14133 | acc=0.1298 | tpr=0.7508 | fpr=0.8815 | 7839.7 samples/s | 30.6 steps/s
[Step= 250] | Loss=5.14049 | acc=0.1303 | tpr=0.7520 | fpr=0.8810 | 7853.4 samples/s | 30.7 steps/s
[Step= 300] | Loss=5.13690 | acc=0.1299 | tpr=0.7535 | fpr=0.8814 | 8091.3 samples/s | 31.6 steps/s
[Step= 350] | Loss=5.13089 | acc=0.1296 | tpr=0.7489 | fpr=0.8817 | 8085.2 samples/s | 31.6 steps/s
[Step= 400] | Loss=5.13204 | acc=0.1296 | tpr=0.7445 | fpr=0.8816 | 7899.2 samples/s | 30.9 steps/s
[Step= 450] | Loss=5.13729 | acc=0.1294 | tpr=0.7395 | fpr=0.8817 | 8073.6 samples/s | 31.5 steps/s
[Step= 500] | Loss=5.14317 | acc=0.1291 | tpr=0.7410 | fpr=0.8819 | 7823.4 samples/s | 30.6 steps/s
[Step= 550] | Loss=5.14132 | acc=0.1291 | tpr=0.7433 | fpr=0.8821 | 13840.3 samples/s | 54.1 steps/s
Avg test loss: 5.14257, Avg test acc: 0.12902, Avg tpr: 0.74287, Avg fpr: 0.88214, total FA: 122483

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.57668 | acc=0.1262 | tpr=0.7566 | fpr=0.8852 | 3976.5 samples/s | 15.5 steps/s
[Step= 100] | Loss=5.51909 | acc=0.1280 | tpr=0.7484 | fpr=0.8835 | 7632.1 samples/s | 29.8 steps/s
[Step= 150] | Loss=5.52037 | acc=0.1259 | tpr=0.7709 | fpr=0.8860 | 8503.0 samples/s | 33.2 steps/s
[Step= 200] | Loss=5.52113 | acc=0.1250 | tpr=0.7683 | fpr=0.8867 | 7945.1 samples/s | 31.0 steps/s
[Step= 250] | Loss=5.52141 | acc=0.1258 | tpr=0.7686 | fpr=0.8859 | 7996.7 samples/s | 31.2 steps/s
[Step= 300] | Loss=5.51748 | acc=0.1258 | tpr=0.7738 | fpr=0.8861 | 8138.8 samples/s | 31.8 steps/s
[Step= 350] | Loss=5.51466 | acc=0.1255 | tpr=0.7727 | fpr=0.8862 | 8021.2 samples/s | 31.3 steps/s
[Step= 400] | Loss=5.51710 | acc=0.1258 | tpr=0.7735 | fpr=0.8860 | 8071.1 samples/s | 31.5 steps/s
[Step= 450] | Loss=5.52150 | acc=0.1252 | tpr=0.7663 | fpr=0.8864 | 7956.5 samples/s | 31.1 steps/s
[Step= 500] | Loss=5.52296 | acc=0.1252 | tpr=0.7674 | fpr=0.8864 | 8188.0 samples/s | 32.0 steps/s
[Step= 550] | Loss=5.52250 | acc=0.1252 | tpr=0.7728 | fpr=0.8865 | 14897.7 samples/s | 58.2 steps/s
Avg test loss: 5.52404, Avg test acc: 0.12515, Avg tpr: 0.77219, Avg fpr: 0.88662, total FA: 123105

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.15742 | acc=0.1370 | tpr=0.7788 | fpr=0.8746 | 4099.6 samples/s | 16.0 steps/s
[Step= 100] | Loss=5.10651 | acc=0.1393 | tpr=0.7463 | fpr=0.8720 | 8239.6 samples/s | 32.2 steps/s
[Step= 150] | Loss=5.10357 | acc=0.1379 | tpr=0.7709 | fpr=0.8737 | 7588.7 samples/s | 29.6 steps/s
[Step= 200] | Loss=5.09914 | acc=0.1378 | tpr=0.7683 | fpr=0.8737 | 7928.1 samples/s | 31.0 steps/s
[Step= 250] | Loss=5.10185 | acc=0.1381 | tpr=0.7677 | fpr=0.8733 | 8584.4 samples/s | 33.5 steps/s
[Step= 300] | Loss=5.09860 | acc=0.1373 | tpr=0.7658 | fpr=0.8742 | 7539.9 samples/s | 29.5 steps/s
[Step= 350] | Loss=5.09320 | acc=0.1369 | tpr=0.7627 | fpr=0.8745 | 7928.3 samples/s | 31.0 steps/s
[Step= 400] | Loss=5.09656 | acc=0.1366 | tpr=0.7615 | fpr=0.8748 | 8169.4 samples/s | 31.9 steps/s
[Step= 450] | Loss=5.10207 | acc=0.1361 | tpr=0.7556 | fpr=0.8751 | 8195.7 samples/s | 32.0 steps/s
[Step= 500] | Loss=5.10568 | acc=0.1360 | tpr=0.7586 | fpr=0.8753 | 7597.5 samples/s | 29.7 steps/s
[Step= 550] | Loss=5.10443 | acc=0.1359 | tpr=0.7628 | fpr=0.8755 | 14595.1 samples/s | 57.0 steps/s
Avg test loss: 5.10633, Avg test acc: 0.13579, Avg tpr: 0.76228, Avg fpr: 0.87560, total FA: 121575

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=4.91952 | acc=0.1412 | tpr=0.7035 | fpr=0.8689 | 4104.1 samples/s | 16.0 steps/s
[Step= 100] | Loss=4.86946 | acc=0.1444 | tpr=0.6780 | fpr=0.8656 | 7994.4 samples/s | 31.2 steps/s
[Step= 150] | Loss=4.86758 | acc=0.1432 | tpr=0.6729 | fpr=0.8666 | 7900.0 samples/s | 30.9 steps/s
[Step= 200] | Loss=4.86480 | acc=0.1425 | tpr=0.6689 | fpr=0.8670 | 8226.3 samples/s | 32.1 steps/s
[Step= 250] | Loss=4.86740 | acc=0.1426 | tpr=0.6672 | fpr=0.8670 | 8549.2 samples/s | 33.4 steps/s
[Step= 300] | Loss=4.86291 | acc=0.1424 | tpr=0.6735 | fpr=0.8673 | 7616.3 samples/s | 29.8 steps/s
[Step= 350] | Loss=4.85774 | acc=0.1417 | tpr=0.6763 | fpr=0.8680 | 8182.9 samples/s | 32.0 steps/s
[Step= 400] | Loss=4.86126 | acc=0.1418 | tpr=0.6756 | fpr=0.8679 | 8085.6 samples/s | 31.6 steps/s
[Step= 450] | Loss=4.86432 | acc=0.1414 | tpr=0.6719 | fpr=0.8683 | 8005.8 samples/s | 31.3 steps/s
[Step= 500] | Loss=4.86612 | acc=0.1411 | tpr=0.6705 | fpr=0.8685 | 8104.2 samples/s | 31.7 steps/s
[Step= 550] | Loss=4.86557 | acc=0.1409 | tpr=0.6713 | fpr=0.8688 | 14103.6 samples/s | 55.1 steps/s
Avg test loss: 4.86778, Avg test acc: 0.14083, Avg tpr: 0.67116, Avg fpr: 0.86881, total FA: 120633

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10349 | acc=0.9805 | tpr=0.9425 | fpr=0.0188 | 4110.4 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.10753 | acc=0.9800 | tpr=0.9574 | fpr=0.0196 | 7690.8 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.11166 | acc=0.9792 | tpr=0.9568 | fpr=0.0204 | 8368.9 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.11368 | acc=0.9792 | tpr=0.9607 | fpr=0.0205 | 7726.7 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.11324 | acc=0.9792 | tpr=0.9555 | fpr=0.0204 | 7852.7 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.11535 | acc=0.9788 | tpr=0.9527 | fpr=0.0207 | 8085.8 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.11529 | acc=0.9786 | tpr=0.9505 | fpr=0.0209 | 7864.1 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.11649 | acc=0.9785 | tpr=0.9480 | fpr=0.0209 | 8110.8 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.11920 | acc=0.9783 | tpr=0.9469 | fpr=0.0211 | 8136.8 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.11899 | acc=0.9783 | tpr=0.9480 | fpr=0.0211 | 7856.6 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.11801 | acc=0.9785 | tpr=0.9479 | fpr=0.0209 | 14158.5 samples/s | 55.3 steps/s
Avg test loss: 0.11784, Avg test acc: 0.97852, Avg tpr: 0.94810, Avg fpr: 0.02092, total FA: 2905

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11424 | acc=0.9812 | tpr=0.9115 | fpr=0.0176 | 4052.1 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.11835 | acc=0.9810 | tpr=0.9211 | fpr=0.0179 | 8027.9 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.12327 | acc=0.9799 | tpr=0.9193 | fpr=0.0190 | 7865.0 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.12485 | acc=0.9800 | tpr=0.9246 | fpr=0.0190 | 7910.5 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.12380 | acc=0.9799 | tpr=0.9231 | fpr=0.0191 | 7979.3 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.12616 | acc=0.9795 | tpr=0.9229 | fpr=0.0195 | 7784.6 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.12633 | acc=0.9793 | tpr=0.9249 | fpr=0.0197 | 7859.1 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.12762 | acc=0.9792 | tpr=0.9212 | fpr=0.0197 | 7815.2 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.13089 | acc=0.9790 | tpr=0.9202 | fpr=0.0199 | 7987.3 samples/s | 31.2 steps/s
[Step= 500] | Loss=0.13043 | acc=0.9791 | tpr=0.9238 | fpr=0.0199 | 7873.2 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.12956 | acc=0.9792 | tpr=0.9236 | fpr=0.0198 | 14202.4 samples/s | 55.5 steps/s
Avg test loss: 0.12932, Avg test acc: 0.97921, Avg tpr: 0.92314, Avg fpr: 0.01977, total FA: 2745

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.12618 | acc=0.9776 | tpr=0.9336 | fpr=0.0216 | 4051.1 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.12979 | acc=0.9781 | tpr=0.9510 | fpr=0.0214 | 8041.6 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.13363 | acc=0.9772 | tpr=0.9481 | fpr=0.0222 | 8214.4 samples/s | 32.1 steps/s
[Step= 200] | Loss=0.13593 | acc=0.9771 | tpr=0.9508 | fpr=0.0225 | 7909.7 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.13554 | acc=0.9768 | tpr=0.9502 | fpr=0.0227 | 8127.5 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.13884 | acc=0.9764 | tpr=0.9476 | fpr=0.0231 | 8119.5 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.13932 | acc=0.9762 | tpr=0.9468 | fpr=0.0232 | 8047.8 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.14107 | acc=0.9761 | tpr=0.9420 | fpr=0.0233 | 8315.7 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.14464 | acc=0.9758 | tpr=0.9421 | fpr=0.0236 | 7923.9 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.14410 | acc=0.9758 | tpr=0.9441 | fpr=0.0236 | 7620.4 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.14285 | acc=0.9761 | tpr=0.9431 | fpr=0.0233 | 14985.4 samples/s | 58.5 steps/s
Avg test loss: 0.14265, Avg test acc: 0.97608, Avg tpr: 0.94334, Avg fpr: 0.02333, total FA: 3239

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.09745 | acc=0.9816 | tpr=0.9159 | fpr=0.0172 | 4113.9 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.10077 | acc=0.9816 | tpr=0.9360 | fpr=0.0175 | 7931.6 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.10496 | acc=0.9807 | tpr=0.9337 | fpr=0.0185 | 8319.4 samples/s | 32.5 steps/s
[Step= 200] | Loss=0.10666 | acc=0.9808 | tpr=0.9399 | fpr=0.0185 | 8527.1 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.10537 | acc=0.9808 | tpr=0.9406 | fpr=0.0184 | 7984.9 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.10686 | acc=0.9805 | tpr=0.9404 | fpr=0.0187 | 8046.7 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.10678 | acc=0.9805 | tpr=0.9424 | fpr=0.0188 | 7821.2 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.10767 | acc=0.9804 | tpr=0.9393 | fpr=0.0189 | 8466.2 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.11048 | acc=0.9801 | tpr=0.9372 | fpr=0.0192 | 7501.9 samples/s | 29.3 steps/s
[Step= 500] | Loss=0.11015 | acc=0.9801 | tpr=0.9388 | fpr=0.0191 | 7947.2 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.10943 | acc=0.9802 | tpr=0.9383 | fpr=0.0191 | 15191.7 samples/s | 59.3 steps/s
Avg test loss: 0.10927, Avg test acc: 0.98018, Avg tpr: 0.93859, Avg fpr: 0.01906, total FA: 2647

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.11596 | acc=0.9812 | tpr=0.9336 | fpr=0.0180 | 4064.2 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.12072 | acc=0.9805 | tpr=0.9488 | fpr=0.0189 | 8119.9 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.12609 | acc=0.9794 | tpr=0.9438 | fpr=0.0199 | 7676.7 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.12844 | acc=0.9792 | tpr=0.9475 | fpr=0.0202 | 8027.0 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.12695 | acc=0.9791 | tpr=0.9432 | fpr=0.0203 | 7982.7 samples/s | 31.2 steps/s
[Step= 300] | Loss=0.12977 | acc=0.9787 | tpr=0.9425 | fpr=0.0206 | 8159.0 samples/s | 31.9 steps/s
[Step= 350] | Loss=0.13011 | acc=0.9784 | tpr=0.9443 | fpr=0.0210 | 7927.4 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.13127 | acc=0.9782 | tpr=0.9382 | fpr=0.0211 | 7828.2 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.13460 | acc=0.9779 | tpr=0.9382 | fpr=0.0214 | 8087.8 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.13416 | acc=0.9779 | tpr=0.9383 | fpr=0.0214 | 7677.7 samples/s | 30.0 steps/s
[Step= 550] | Loss=0.13343 | acc=0.9781 | tpr=0.9375 | fpr=0.0212 | 14546.1 samples/s | 56.8 steps/s
Avg test loss: 0.13326, Avg test acc: 0.97806, Avg tpr: 0.93740, Avg fpr: 0.02120, total FA: 2944

server round 36/50

clients selected: [2 4 5 8 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=36001 Epoch=175.4] | Loss=0.17103 | Reg=0.00098 | acc=0.9531 | L2-Norm=9.912 | L2-Norm(final)=12.918 | 3568.5 samples/s | 55.8 steps/s
[Step=36050 Epoch=175.7] | Loss=0.02837 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.920 | L2-Norm(final)=12.910 | 5438.8 samples/s | 85.0 steps/s
[Step=36100 Epoch=175.9] | Loss=0.02344 | Reg=0.00099 | acc=0.9688 | L2-Norm=9.930 | L2-Norm(final)=12.909 | 4953.3 samples/s | 77.4 steps/s
[Step=36150 Epoch=176.1] | Loss=0.02146 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.939 | L2-Norm(final)=12.911 | 5107.6 samples/s | 79.8 steps/s
[Step=36200 Epoch=176.4] | Loss=0.02125 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.946 | L2-Norm(final)=12.915 | 7223.6 samples/s | 112.9 steps/s
[Step=36250 Epoch=176.6] | Loss=0.02009 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.954 | L2-Norm(final)=12.918 | 1809.1 samples/s | 28.3 steps/s
[Step=36300 Epoch=176.9] | Loss=0.01885 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.962 | L2-Norm(final)=12.923 | 5242.6 samples/s | 81.9 steps/s
[Step=36350 Epoch=177.1] | Loss=0.01829 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.970 | L2-Norm(final)=12.928 | 5163.8 samples/s | 80.7 steps/s
[Step=36400 Epoch=177.4] | Loss=0.01794 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.977 | L2-Norm(final)=12.934 | 6554.0 samples/s | 102.4 steps/s
[Step=36450 Epoch=177.6] | Loss=0.01753 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.984 | L2-Norm(final)=12.940 | 1841.1 samples/s | 28.8 steps/s
[Step=36500 Epoch=177.8] | Loss=0.01696 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.991 | L2-Norm(final)=12.945 | 5159.4 samples/s | 80.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=177.9] | Loss=0.00574 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.059 | L2-Norm(final)=13.006 | 3919.8 samples/s | 61.2 steps/s
[Step=36550 Epoch=178.1] | Loss=0.01405 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.068 | L2-Norm(final)=13.014 | 4402.9 samples/s | 68.8 steps/s
[Step=36600 Epoch=178.3] | Loss=0.01563 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.080 | L2-Norm(final)=13.020 | 4578.7 samples/s | 71.5 steps/s
[Step=36650 Epoch=178.6] | Loss=0.01430 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.091 | L2-Norm(final)=13.026 | 4535.5 samples/s | 70.9 steps/s
[Step=36700 Epoch=178.8] | Loss=0.01351 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.102 | L2-Norm(final)=13.032 | 6286.5 samples/s | 98.2 steps/s
[Step=36750 Epoch=179.1] | Loss=0.01275 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.111 | L2-Norm(final)=13.037 | 1752.8 samples/s | 27.4 steps/s
[Step=36800 Epoch=179.3] | Loss=0.01161 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.120 | L2-Norm(final)=13.042 | 4598.3 samples/s | 71.8 steps/s
[Step=36850 Epoch=179.6] | Loss=0.01118 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.127 | L2-Norm(final)=13.047 | 4625.1 samples/s | 72.3 steps/s
[Step=36900 Epoch=179.8] | Loss=0.01059 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.134 | L2-Norm(final)=13.052 | 5572.2 samples/s | 87.1 steps/s
[Step=36950 Epoch=180.0] | Loss=0.01002 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.141 | L2-Norm(final)=13.056 | 1768.1 samples/s | 27.6 steps/s
[Step=37000 Epoch=180.3] | Loss=0.00940 | Reg=0.00103 | acc=0.9688 | L2-Norm=10.146 | L2-Norm(final)=13.060 | 4502.9 samples/s | 70.4 steps/s
[Step=37050 Epoch=180.5] | Loss=0.00902 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.152 | L2-Norm(final)=13.064 | 4594.8 samples/s | 71.8 steps/s
[Step=37100 Epoch=180.8] | Loss=0.00870 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.157 | L2-Norm(final)=13.068 | 5176.7 samples/s | 80.9 steps/s
[Step=37150 Epoch=181.0] | Loss=0.00836 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.162 | L2-Norm(final)=13.072 | 1825.5 samples/s | 28.5 steps/s
[Step=37200 Epoch=181.3] | Loss=0.00809 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.166 | L2-Norm(final)=13.075 | 4618.2 samples/s | 72.2 steps/s
[Step=37250 Epoch=181.5] | Loss=0.00785 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.170 | L2-Norm(final)=13.079 | 4486.8 samples/s | 70.1 steps/s
[Step=37300 Epoch=181.7] | Loss=0.00754 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.174 | L2-Norm(final)=13.082 | 5013.4 samples/s | 78.3 steps/s
[Step=37350 Epoch=182.0] | Loss=0.00727 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.178 | L2-Norm(final)=13.085 | 1850.9 samples/s | 28.9 steps/s
[Step=37400 Epoch=182.2] | Loss=0.00708 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.182 | L2-Norm(final)=13.089 | 4615.5 samples/s | 72.1 steps/s
[Step=37450 Epoch=182.5] | Loss=0.00685 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.186 | L2-Norm(final)=13.092 | 4580.1 samples/s | 71.6 steps/s
[Step=37500 Epoch=182.7] | Loss=0.00667 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.189 | L2-Norm(final)=13.095 | 4612.2 samples/s | 72.1 steps/s
[Step=37550 Epoch=183.0] | Loss=0.00655 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.192 | L2-Norm(final)=13.098 | 1869.4 samples/s | 29.2 steps/s
[Step=37600 Epoch=183.2] | Loss=0.00641 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.196 | L2-Norm(final)=13.101 | 4624.5 samples/s | 72.3 steps/s
[Step=37650 Epoch=183.4] | Loss=0.00634 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.199 | L2-Norm(final)=13.103 | 4473.6 samples/s | 69.9 steps/s
[Step=37700 Epoch=183.7] | Loss=0.00624 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.202 | L2-Norm(final)=13.106 | 4658.1 samples/s | 72.8 steps/s
[Step=37750 Epoch=183.9] | Loss=0.00615 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.205 | L2-Norm(final)=13.109 | 1922.2 samples/s | 30.0 steps/s
[Step=37800 Epoch=184.2] | Loss=0.00609 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.208 | L2-Norm(final)=13.111 | 4644.2 samples/s | 72.6 steps/s
[Step=37850 Epoch=184.4] | Loss=0.00599 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.211 | L2-Norm(final)=13.114 | 4529.6 samples/s | 70.8 steps/s
[Step=37900 Epoch=184.7] | Loss=0.00593 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.214 | L2-Norm(final)=13.116 | 4460.7 samples/s | 69.7 steps/s
[Step=37950 Epoch=184.9] | Loss=0.00583 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.216 | L2-Norm(final)=13.118 | 1941.5 samples/s | 30.3 steps/s
[Step=38000 Epoch=185.2] | Loss=0.00571 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.219 | L2-Norm(final)=13.120 | 4731.8 samples/s | 73.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step38000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=40001 Epoch=196.2] | Loss=0.00195 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.912 | L2-Norm(final)=12.696 | 3650.3 samples/s | 57.0 steps/s
[Step=40050 Epoch=196.4] | Loss=0.01772 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.919 | L2-Norm(final)=12.691 | 5259.2 samples/s | 82.2 steps/s
[Step=40100 Epoch=196.6] | Loss=0.01509 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.929 | L2-Norm(final)=12.692 | 5243.5 samples/s | 81.9 steps/s
[Step=40150 Epoch=196.9] | Loss=0.01622 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.939 | L2-Norm(final)=12.695 | 5229.1 samples/s | 81.7 steps/s
[Step=40200 Epoch=197.1] | Loss=0.01642 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.948 | L2-Norm(final)=12.700 | 7396.4 samples/s | 115.6 steps/s
[Step=40250 Epoch=197.4] | Loss=0.01539 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.956 | L2-Norm(final)=12.705 | 1788.9 samples/s | 28.0 steps/s
[Step=40300 Epoch=197.6] | Loss=0.01454 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.964 | L2-Norm(final)=12.710 | 5174.0 samples/s | 80.8 steps/s
[Step=40350 Epoch=197.9] | Loss=0.01385 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.971 | L2-Norm(final)=12.716 | 5177.9 samples/s | 80.9 steps/s
[Step=40400 Epoch=198.1] | Loss=0.01381 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=12.722 | 6767.6 samples/s | 105.7 steps/s
[Step=40450 Epoch=198.4] | Loss=0.01331 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.986 | L2-Norm(final)=12.729 | 1831.1 samples/s | 28.6 steps/s
[Step=40500 Epoch=198.6] | Loss=0.01295 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.993 | L2-Norm(final)=12.735 | 5124.9 samples/s | 80.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=40501 Epoch=198.6] | Loss=0.00832 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=12.801 | 3730.5 samples/s | 58.3 steps/s
[Step=40550 Epoch=198.9] | Loss=0.01206 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.077 | L2-Norm(final)=12.808 | 4373.1 samples/s | 68.3 steps/s
[Step=40600 Epoch=199.1] | Loss=0.01258 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.088 | L2-Norm(final)=12.813 | 4706.7 samples/s | 73.5 steps/s
[Step=40650 Epoch=199.3] | Loss=0.01324 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.099 | L2-Norm(final)=12.818 | 4574.7 samples/s | 71.5 steps/s
[Step=40700 Epoch=199.6] | Loss=0.01304 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.109 | L2-Norm(final)=12.823 | 6304.6 samples/s | 98.5 steps/s
[Step=40750 Epoch=199.8] | Loss=0.01197 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.117 | L2-Norm(final)=12.827 | 1740.7 samples/s | 27.2 steps/s
[Step=40800 Epoch=200.1] | Loss=0.01098 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.125 | L2-Norm(final)=12.831 | 4683.1 samples/s | 73.2 steps/s
[Step=40850 Epoch=200.3] | Loss=0.01020 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.132 | L2-Norm(final)=12.835 | 4550.9 samples/s | 71.1 steps/s
[Step=40900 Epoch=200.6] | Loss=0.00974 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.138 | L2-Norm(final)=12.839 | 5864.7 samples/s | 91.6 steps/s
[Step=40950 Epoch=200.8] | Loss=0.00916 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.144 | L2-Norm(final)=12.843 | 1740.7 samples/s | 27.2 steps/s
[Step=41000 Epoch=201.1] | Loss=0.00869 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.149 | L2-Norm(final)=12.846 | 4588.7 samples/s | 71.7 steps/s
[Step=41050 Epoch=201.3] | Loss=0.00824 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.154 | L2-Norm(final)=12.849 | 4612.2 samples/s | 72.1 steps/s
[Step=41100 Epoch=201.5] | Loss=0.00794 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.158 | L2-Norm(final)=12.853 | 5755.1 samples/s | 89.9 steps/s
[Step=41150 Epoch=201.8] | Loss=0.00759 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.163 | L2-Norm(final)=12.856 | 1777.5 samples/s | 27.8 steps/s
[Step=41200 Epoch=202.0] | Loss=0.00723 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.167 | L2-Norm(final)=12.859 | 4601.3 samples/s | 71.9 steps/s
[Step=41250 Epoch=202.3] | Loss=0.00706 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.171 | L2-Norm(final)=12.863 | 4599.7 samples/s | 71.9 steps/s
[Step=41300 Epoch=202.5] | Loss=0.00682 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.175 | L2-Norm(final)=12.866 | 5439.8 samples/s | 85.0 steps/s
[Step=41350 Epoch=202.8] | Loss=0.00659 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.178 | L2-Norm(final)=12.869 | 1776.5 samples/s | 27.8 steps/s
[Step=41400 Epoch=203.0] | Loss=0.00638 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.181 | L2-Norm(final)=12.872 | 4522.4 samples/s | 70.7 steps/s
[Step=41450 Epoch=203.3] | Loss=0.00624 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.185 | L2-Norm(final)=12.874 | 4586.2 samples/s | 71.7 steps/s
[Step=41500 Epoch=203.5] | Loss=0.00611 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.188 | L2-Norm(final)=12.877 | 5163.5 samples/s | 80.7 steps/s
[Step=41550 Epoch=203.8] | Loss=0.00599 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.191 | L2-Norm(final)=12.880 | 1849.6 samples/s | 28.9 steps/s
[Step=41600 Epoch=204.0] | Loss=0.00584 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.194 | L2-Norm(final)=12.882 | 4526.5 samples/s | 70.7 steps/s
[Step=41650 Epoch=204.2] | Loss=0.00573 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.197 | L2-Norm(final)=12.885 | 4511.4 samples/s | 70.5 steps/s
[Step=41700 Epoch=204.5] | Loss=0.00558 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.199 | L2-Norm(final)=12.888 | 4910.8 samples/s | 76.7 steps/s
[Step=41750 Epoch=204.7] | Loss=0.00549 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.202 | L2-Norm(final)=12.890 | 1824.2 samples/s | 28.5 steps/s
[Step=41800 Epoch=205.0] | Loss=0.00542 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.205 | L2-Norm(final)=12.893 | 4602.5 samples/s | 71.9 steps/s
[Step=41850 Epoch=205.2] | Loss=0.00535 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.207 | L2-Norm(final)=12.895 | 4630.3 samples/s | 72.3 steps/s
[Step=41900 Epoch=205.5] | Loss=0.00525 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.210 | L2-Norm(final)=12.897 | 4687.6 samples/s | 73.2 steps/s
[Step=41950 Epoch=205.7] | Loss=0.00515 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.212 | L2-Norm(final)=12.899 | 1865.2 samples/s | 29.1 steps/s
[Step=42000 Epoch=206.0] | Loss=0.00504 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.215 | L2-Norm(final)=12.902 | 4400.8 samples/s | 68.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step42000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=26001 Epoch=246.4] | Loss=0.00022 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.912 | L2-Norm(final)=7.347 | 3508.4 samples/s | 54.8 steps/s
[Step=26050 Epoch=246.8] | Loss=0.00175 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.921 | L2-Norm(final)=7.345 | 4973.0 samples/s | 77.7 steps/s
[Step=26100 Epoch=247.3] | Loss=0.00111 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.932 | L2-Norm(final)=7.353 | 6689.0 samples/s | 104.5 steps/s
[Step=26150 Epoch=247.8] | Loss=0.00079 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.939 | L2-Norm(final)=7.361 | 1714.7 samples/s | 26.8 steps/s
[Step=26200 Epoch=248.3] | Loss=0.00061 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.941 | L2-Norm(final)=7.367 | 6493.3 samples/s | 101.5 steps/s
[Step=26250 Epoch=248.7] | Loss=0.00055 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.943 | L2-Norm(final)=7.372 | 1781.6 samples/s | 27.8 steps/s
[Step=26300 Epoch=249.2] | Loss=0.00047 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.944 | L2-Norm(final)=7.377 | 5959.2 samples/s | 93.1 steps/s
[Step=26350 Epoch=249.7] | Loss=0.00041 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.944 | L2-Norm(final)=7.381 | 1858.5 samples/s | 29.0 steps/s
[Step=26400 Epoch=250.2] | Loss=0.00037 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.943 | L2-Norm(final)=7.385 | 5256.7 samples/s | 82.1 steps/s
[Step=26450 Epoch=250.6] | Loss=0.00033 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.942 | L2-Norm(final)=7.389 | 1888.0 samples/s | 29.5 steps/s
[Step=26500 Epoch=251.1] | Loss=0.00031 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.941 | L2-Norm(final)=7.393 | 4977.1 samples/s | 77.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=26501 Epoch=251.1] | Loss=0.00005 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.927 | L2-Norm(final)=7.431 | 3608.7 samples/s | 56.4 steps/s
[Step=26550 Epoch=251.6] | Loss=0.00036 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.941 | L2-Norm(final)=7.437 | 4250.5 samples/s | 66.4 steps/s
[Step=26600 Epoch=252.1] | Loss=0.00022 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.949 | L2-Norm(final)=7.443 | 5843.1 samples/s | 91.3 steps/s
[Step=26650 Epoch=252.5] | Loss=0.00015 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.949 | L2-Norm(final)=7.446 | 1681.4 samples/s | 26.3 steps/s
[Step=26700 Epoch=253.0] | Loss=0.00012 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.946 | L2-Norm(final)=7.448 | 5489.5 samples/s | 85.8 steps/s
[Step=26750 Epoch=253.5] | Loss=0.00009 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.941 | L2-Norm(final)=7.449 | 1727.5 samples/s | 27.0 steps/s
[Step=26800 Epoch=254.0] | Loss=0.00008 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.936 | L2-Norm(final)=7.450 | 5066.9 samples/s | 79.2 steps/s
[Step=26850 Epoch=254.4] | Loss=0.00007 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.930 | L2-Norm(final)=7.451 | 1765.1 samples/s | 27.6 steps/s
[Step=26900 Epoch=254.9] | Loss=0.00006 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.924 | L2-Norm(final)=7.452 | 4655.4 samples/s | 72.7 steps/s
[Step=26950 Epoch=255.4] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.917 | L2-Norm(final)=7.453 | 1868.1 samples/s | 29.2 steps/s
[Step=27000 Epoch=255.8] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.911 | L2-Norm(final)=7.453 | 4438.7 samples/s | 69.4 steps/s
[Step=27050 Epoch=256.3] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=7.454 | 1867.7 samples/s | 29.2 steps/s
[Step=27100 Epoch=256.8] | Loss=0.00004 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.897 | L2-Norm(final)=7.454 | 4369.5 samples/s | 68.3 steps/s
[Step=27150 Epoch=257.3] | Loss=0.00004 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=7.455 | 1860.2 samples/s | 29.1 steps/s
[Step=27200 Epoch=257.7] | Loss=0.00004 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.883 | L2-Norm(final)=7.455 | 4496.4 samples/s | 70.3 steps/s
[Step=27250 Epoch=258.2] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=7.456 | 1888.6 samples/s | 29.5 steps/s
[Step=27300 Epoch=258.7] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.868 | L2-Norm(final)=7.456 | 4370.2 samples/s | 68.3 steps/s
[Step=27350 Epoch=259.2] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.860 | L2-Norm(final)=7.456 | 1927.8 samples/s | 30.1 steps/s
[Step=27400 Epoch=259.6] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.852 | L2-Norm(final)=7.457 | 4239.8 samples/s | 66.2 steps/s
[Step=27450 Epoch=260.1] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.845 | L2-Norm(final)=7.457 | 6071.2 samples/s | 94.9 steps/s
[Step=27500 Epoch=260.6] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.837 | L2-Norm(final)=7.458 | 1683.1 samples/s | 26.3 steps/s
[Step=27550 Epoch=261.1] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.829 | L2-Norm(final)=7.458 | 5605.6 samples/s | 87.6 steps/s
[Step=27600 Epoch=261.5] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.821 | L2-Norm(final)=7.458 | 1715.4 samples/s | 26.8 steps/s
[Step=27650 Epoch=262.0] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.813 | L2-Norm(final)=7.459 | 5233.6 samples/s | 81.8 steps/s
[Step=27700 Epoch=262.5] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.804 | L2-Norm(final)=7.459 | 1764.0 samples/s | 27.6 steps/s
[Step=27750 Epoch=263.0] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.796 | L2-Norm(final)=7.459 | 4711.8 samples/s | 73.6 steps/s
[Step=27800 Epoch=263.4] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.787 | L2-Norm(final)=7.460 | 1795.8 samples/s | 28.1 steps/s
[Step=27850 Epoch=263.9] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.779 | L2-Norm(final)=7.460 | 4581.8 samples/s | 71.6 steps/s
[Step=27900 Epoch=264.4] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.770 | L2-Norm(final)=7.460 | 1816.2 samples/s | 28.4 steps/s
[Step=27950 Epoch=264.9] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.761 | L2-Norm(final)=7.461 | 4511.1 samples/s | 70.5 steps/s
[Step=28000 Epoch=265.3] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.752 | L2-Norm(final)=7.461 | 1885.0 samples/s | 29.5 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_0/client_state-step28000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=34001 Epoch=320.4] | Loss=0.00302 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.912 | L2-Norm(final)=8.780 | 3941.6 samples/s | 61.6 steps/s
[Step=34050 Epoch=320.8] | Loss=0.00167 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.924 | L2-Norm(final)=8.778 | 4576.2 samples/s | 71.5 steps/s
[Step=34100 Epoch=321.3] | Loss=0.00098 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.933 | L2-Norm(final)=8.782 | 6575.8 samples/s | 102.7 steps/s
[Step=34150 Epoch=321.8] | Loss=0.00071 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.936 | L2-Norm(final)=8.787 | 1735.8 samples/s | 27.1 steps/s
[Step=34200 Epoch=322.3] | Loss=0.00057 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.938 | L2-Norm(final)=8.791 | 6142.2 samples/s | 96.0 steps/s
[Step=34250 Epoch=322.7] | Loss=0.00047 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.938 | L2-Norm(final)=8.795 | 1804.3 samples/s | 28.2 steps/s
[Step=34300 Epoch=323.2] | Loss=0.00041 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.938 | L2-Norm(final)=8.798 | 5360.3 samples/s | 83.8 steps/s
[Step=34350 Epoch=323.7] | Loss=0.00036 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.937 | L2-Norm(final)=8.802 | 1872.6 samples/s | 29.3 steps/s
[Step=34400 Epoch=324.1] | Loss=0.00033 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.936 | L2-Norm(final)=8.805 | 5053.7 samples/s | 79.0 steps/s
[Step=34450 Epoch=324.6] | Loss=0.00030 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.935 | L2-Norm(final)=8.808 | 1898.2 samples/s | 29.7 steps/s
[Step=34500 Epoch=325.1] | Loss=0.00027 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.934 | L2-Norm(final)=8.811 | 4986.4 samples/s | 77.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=325.1] | Loss=0.00004 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.921 | L2-Norm(final)=8.840 | 3561.8 samples/s | 55.7 steps/s
[Step=34550 Epoch=325.6] | Loss=0.00006 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.918 | L2-Norm(final)=8.842 | 4350.6 samples/s | 68.0 steps/s
[Step=34600 Epoch=326.0] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.915 | L2-Norm(final)=8.845 | 5855.5 samples/s | 91.5 steps/s
[Step=34650 Epoch=326.5] | Loss=0.00004 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.912 | L2-Norm(final)=8.846 | 1751.2 samples/s | 27.4 steps/s
[Step=34700 Epoch=327.0] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.908 | L2-Norm(final)=8.848 | 5474.4 samples/s | 85.5 steps/s
[Step=34750 Epoch=327.4] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.903 | L2-Norm(final)=8.849 | 1752.5 samples/s | 27.4 steps/s
[Step=34800 Epoch=327.9] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=8.850 | 4957.7 samples/s | 77.5 steps/s
[Step=34850 Epoch=328.4] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.894 | L2-Norm(final)=8.851 | 1807.3 samples/s | 28.2 steps/s
[Step=34900 Epoch=328.9] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=8.852 | 4531.2 samples/s | 70.8 steps/s
[Step=34950 Epoch=329.3] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=8.853 | 1817.2 samples/s | 28.4 steps/s
[Step=35000 Epoch=329.8] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.880 | L2-Norm(final)=8.853 | 4276.9 samples/s | 66.8 steps/s
[Step=35050 Epoch=330.3] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.875 | L2-Norm(final)=8.854 | 1840.3 samples/s | 28.8 steps/s
[Step=35100 Epoch=330.7] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.870 | L2-Norm(final)=8.855 | 4540.0 samples/s | 70.9 steps/s
[Step=35150 Epoch=331.2] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.865 | L2-Norm(final)=8.855 | 1861.3 samples/s | 29.1 steps/s
[Step=35200 Epoch=331.7] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.860 | L2-Norm(final)=8.856 | 4397.6 samples/s | 68.7 steps/s
[Step=35250 Epoch=332.2] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.855 | L2-Norm(final)=8.857 | 1945.7 samples/s | 30.4 steps/s
[Step=35300 Epoch=332.6] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.849 | L2-Norm(final)=8.857 | 4275.6 samples/s | 66.8 steps/s
[Step=35350 Epoch=333.1] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.844 | L2-Norm(final)=8.858 | 5976.8 samples/s | 93.4 steps/s
[Step=35400 Epoch=333.6] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.838 | L2-Norm(final)=8.859 | 1698.2 samples/s | 26.5 steps/s
[Step=35450 Epoch=334.0] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.833 | L2-Norm(final)=8.859 | 5447.9 samples/s | 85.1 steps/s
[Step=35500 Epoch=334.5] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.827 | L2-Norm(final)=8.860 | 1758.5 samples/s | 27.5 steps/s
[Step=35550 Epoch=335.0] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.821 | L2-Norm(final)=8.860 | 4903.6 samples/s | 76.6 steps/s
[Step=35600 Epoch=335.5] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.816 | L2-Norm(final)=8.861 | 1794.3 samples/s | 28.0 steps/s
[Step=35650 Epoch=335.9] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.810 | L2-Norm(final)=8.862 | 4566.7 samples/s | 71.4 steps/s
[Step=35700 Epoch=336.4] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.804 | L2-Norm(final)=8.862 | 1822.3 samples/s | 28.5 steps/s
[Step=35750 Epoch=336.9] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.798 | L2-Norm(final)=8.863 | 4632.4 samples/s | 72.4 steps/s
[Step=35800 Epoch=337.3] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.792 | L2-Norm(final)=8.863 | 1859.8 samples/s | 29.1 steps/s
[Step=35850 Epoch=337.8] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.786 | L2-Norm(final)=8.864 | 4443.7 samples/s | 69.4 steps/s
[Step=35900 Epoch=338.3] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.779 | L2-Norm(final)=8.864 | 1900.0 samples/s | 29.7 steps/s
[Step=35950 Epoch=338.8] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.773 | L2-Norm(final)=8.865 | 4333.6 samples/s | 67.7 steps/s
[Step=36000 Epoch=339.2] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=8.865 | 1970.6 samples/s | 30.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step36000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=38001 Epoch=362.2] | Loss=0.00581 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.912 | L2-Norm(final)=9.454 | 3882.1 samples/s | 60.7 steps/s
[Step=38050 Epoch=362.7] | Loss=0.00134 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.923 | L2-Norm(final)=9.463 | 4369.1 samples/s | 68.3 steps/s
[Step=38100 Epoch=363.1] | Loss=0.00093 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.934 | L2-Norm(final)=9.471 | 6947.3 samples/s | 108.6 steps/s
[Step=38150 Epoch=363.6] | Loss=0.00068 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.940 | L2-Norm(final)=9.478 | 1734.1 samples/s | 27.1 steps/s
[Step=38200 Epoch=364.1] | Loss=0.00056 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.943 | L2-Norm(final)=9.483 | 6451.7 samples/s | 100.8 steps/s
[Step=38250 Epoch=364.6] | Loss=0.00047 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.945 | L2-Norm(final)=9.489 | 1730.9 samples/s | 27.0 steps/s
[Step=38300 Epoch=365.0] | Loss=0.00041 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.947 | L2-Norm(final)=9.493 | 5829.5 samples/s | 91.1 steps/s
[Step=38350 Epoch=365.5] | Loss=0.00037 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.948 | L2-Norm(final)=9.498 | 1806.3 samples/s | 28.2 steps/s
[Step=38400 Epoch=366.0] | Loss=0.00033 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.948 | L2-Norm(final)=9.502 | 5550.9 samples/s | 86.7 steps/s
[Step=38450 Epoch=366.5] | Loss=0.00031 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.948 | L2-Norm(final)=9.506 | 1834.5 samples/s | 28.7 steps/s
[Step=38500 Epoch=366.9] | Loss=0.00028 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.948 | L2-Norm(final)=9.510 | 5319.2 samples/s | 83.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=366.9] | Loss=0.00004 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.945 | L2-Norm(final)=9.546 | 3629.5 samples/s | 56.7 steps/s
[Step=38550 Epoch=367.4] | Loss=0.00007 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.944 | L2-Norm(final)=9.550 | 4413.2 samples/s | 69.0 steps/s
[Step=38600 Epoch=367.9] | Loss=0.00006 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.941 | L2-Norm(final)=9.552 | 6080.7 samples/s | 95.0 steps/s
[Step=38650 Epoch=368.4] | Loss=0.00005 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.938 | L2-Norm(final)=9.554 | 1682.0 samples/s | 26.3 steps/s
[Step=38700 Epoch=368.8] | Loss=0.00004 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.935 | L2-Norm(final)=9.555 | 5552.7 samples/s | 86.8 steps/s
[Step=38750 Epoch=369.3] | Loss=0.00003 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.931 | L2-Norm(final)=9.557 | 1707.3 samples/s | 26.7 steps/s
[Step=38800 Epoch=369.8] | Loss=0.00003 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.927 | L2-Norm(final)=9.558 | 5295.9 samples/s | 82.7 steps/s
[Step=38850 Epoch=370.3] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.923 | L2-Norm(final)=9.559 | 1777.3 samples/s | 27.8 steps/s
[Step=38900 Epoch=370.8] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.918 | L2-Norm(final)=9.560 | 4922.5 samples/s | 76.9 steps/s
[Step=38950 Epoch=371.2] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.914 | L2-Norm(final)=9.561 | 1784.2 samples/s | 27.9 steps/s
[Step=39000 Epoch=371.7] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.909 | L2-Norm(final)=9.561 | 4707.5 samples/s | 73.6 steps/s
[Step=39050 Epoch=372.2] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.904 | L2-Norm(final)=9.562 | 1804.4 samples/s | 28.2 steps/s
[Step=39100 Epoch=372.7] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=9.563 | 4509.4 samples/s | 70.5 steps/s
[Step=39150 Epoch=373.1] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.895 | L2-Norm(final)=9.564 | 1822.1 samples/s | 28.5 steps/s
[Step=39200 Epoch=373.6] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=9.564 | 4481.5 samples/s | 70.0 steps/s
[Step=39250 Epoch=374.1] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.884 | L2-Norm(final)=9.565 | 1834.4 samples/s | 28.7 steps/s
[Step=39300 Epoch=374.6] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.879 | L2-Norm(final)=9.566 | 4454.8 samples/s | 69.6 steps/s
[Step=39350 Epoch=375.0] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=9.566 | 1838.5 samples/s | 28.7 steps/s
[Step=39400 Epoch=375.5] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.868 | L2-Norm(final)=9.567 | 4469.1 samples/s | 69.8 steps/s
[Step=39450 Epoch=376.0] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.863 | L2-Norm(final)=9.568 | 1895.2 samples/s | 29.6 steps/s
[Step=39500 Epoch=376.5] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.857 | L2-Norm(final)=9.568 | 4347.5 samples/s | 67.9 steps/s
[Step=39550 Epoch=376.9] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.852 | L2-Norm(final)=9.569 | 6517.6 samples/s | 101.8 steps/s
[Step=39600 Epoch=377.4] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.846 | L2-Norm(final)=9.569 | 1661.4 samples/s | 26.0 steps/s
[Step=39650 Epoch=377.9] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=9.570 | 6156.8 samples/s | 96.2 steps/s
[Step=39700 Epoch=378.4] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.834 | L2-Norm(final)=9.570 | 1689.2 samples/s | 26.4 steps/s
[Step=39750 Epoch=378.9] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.828 | L2-Norm(final)=9.571 | 5756.9 samples/s | 90.0 steps/s
[Step=39800 Epoch=379.3] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.822 | L2-Norm(final)=9.572 | 1740.1 samples/s | 27.2 steps/s
[Step=39850 Epoch=379.8] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.815 | L2-Norm(final)=9.572 | 5326.8 samples/s | 83.2 steps/s
[Step=39900 Epoch=380.3] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.809 | L2-Norm(final)=9.573 | 1737.5 samples/s | 27.1 steps/s
[Step=39950 Epoch=380.8] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.803 | L2-Norm(final)=9.573 | 4919.4 samples/s | 76.9 steps/s
[Step=40000 Epoch=381.2] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.796 | L2-Norm(final)=9.574 | 1782.8 samples/s | 27.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08114 | acc=0.9627 | tpr=0.9736 | fpr=0.0610 | 4114.7 samples/s | 16.1 steps/s
Avg test loss: 0.08391, Avg test acc: 0.96134, Avg tpr: 0.97255, Avg fpr: 0.06333, total FA: 494

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09051 | acc=0.9621 | tpr=0.9742 | fpr=0.0642 | 4061.7 samples/s | 15.9 steps/s
Avg test loss: 0.09363, Avg test acc: 0.96146, Avg tpr: 0.97331, Avg fpr: 0.06461, total FA: 504

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08730 | acc=0.9607 | tpr=0.9724 | fpr=0.0647 | 4144.4 samples/s | 16.2 steps/s
Avg test loss: 0.09255, Avg test acc: 0.95925, Avg tpr: 0.97027, Avg fpr: 0.06499, total FA: 507

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08681 | acc=0.9605 | tpr=0.9722 | fpr=0.0647 | 4081.4 samples/s | 15.9 steps/s
Avg test loss: 0.09128, Avg test acc: 0.96033, Avg tpr: 0.97185, Avg fpr: 0.06499, total FA: 507

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08680 | acc=0.9630 | tpr=0.9715 | fpr=0.0555 | 4152.5 samples/s | 16.2 steps/s
Avg test loss: 0.09361, Avg test acc: 0.96154, Avg tpr: 0.97033, Avg fpr: 0.05781, total FA: 451

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.21816 | acc=0.2950 | tpr=0.0027 | fpr=0.0704 | 4207.4 samples/s | 16.4 steps/s
Avg test loss: 5.23691, Avg test acc: 0.29313, Avg tpr: 0.00356, Avg fpr: 0.06999, total FA: 546

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.81103 | acc=0.3137 | tpr=0.0040 | fpr=0.0136 | 4240.0 samples/s | 16.6 steps/s
Avg test loss: 4.81787, Avg test acc: 0.31128, Avg tpr: 0.00460, Avg fpr: 0.01423, total FA: 111

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.84140 | acc=0.3035 | tpr=0.0094 | fpr=0.0577 | 4231.4 samples/s | 16.5 steps/s
Avg test loss: 4.84805, Avg test acc: 0.30155, Avg tpr: 0.01026, Avg fpr: 0.05781, total FA: 451

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.12616 | acc=0.3030 | tpr=0.0043 | fpr=0.0486 | 4159.7 samples/s | 16.2 steps/s
Avg test loss: 5.13848, Avg test acc: 0.29998, Avg tpr: 0.00507, Avg fpr: 0.05140, total FA: 401

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.94982 | acc=0.3137 | tpr=0.0025 | fpr=0.0107 | 4194.2 samples/s | 16.4 steps/s
Avg test loss: 4.95760, Avg test acc: 0.31088, Avg tpr: 0.00303, Avg fpr: 0.01205, total FA: 94

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.16993 | acc=0.1222 | tpr=0.8274 | fpr=0.8905 | 4108.6 samples/s | 16.0 steps/s
[Step= 100] | Loss=5.11997 | acc=0.1242 | tpr=0.8038 | fpr=0.8885 | 8076.5 samples/s | 31.5 steps/s
[Step= 150] | Loss=5.11973 | acc=0.1222 | tpr=0.8199 | fpr=0.8907 | 8228.4 samples/s | 32.1 steps/s
[Step= 200] | Loss=5.11758 | acc=0.1217 | tpr=0.8164 | fpr=0.8910 | 8071.9 samples/s | 31.5 steps/s
[Step= 250] | Loss=5.12090 | acc=0.1228 | tpr=0.8183 | fpr=0.8898 | 8368.2 samples/s | 32.7 steps/s
[Step= 300] | Loss=5.11735 | acc=0.1222 | tpr=0.8131 | fpr=0.8904 | 8102.2 samples/s | 31.6 steps/s
[Step= 350] | Loss=5.11339 | acc=0.1217 | tpr=0.8078 | fpr=0.8907 | 8008.0 samples/s | 31.3 steps/s
[Step= 400] | Loss=5.11559 | acc=0.1220 | tpr=0.8047 | fpr=0.8904 | 7801.1 samples/s | 30.5 steps/s
[Step= 450] | Loss=5.11797 | acc=0.1217 | tpr=0.8014 | fpr=0.8907 | 8223.0 samples/s | 32.1 steps/s
[Step= 500] | Loss=5.12077 | acc=0.1215 | tpr=0.8004 | fpr=0.8907 | 7738.9 samples/s | 30.2 steps/s
[Step= 550] | Loss=5.12012 | acc=0.1214 | tpr=0.8054 | fpr=0.8910 | 14337.0 samples/s | 56.0 steps/s
Avg test loss: 5.12190, Avg test acc: 0.12135, Avg tpr: 0.80507, Avg fpr: 0.89108, total FA: 123725

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.19950 | acc=0.1308 | tpr=0.7655 | fpr=0.8806 | 4131.5 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.14036 | acc=0.1322 | tpr=0.7505 | fpr=0.8793 | 7937.4 samples/s | 31.0 steps/s
[Step= 150] | Loss=5.14068 | acc=0.1296 | tpr=0.7507 | fpr=0.8818 | 8060.2 samples/s | 31.5 steps/s
[Step= 200] | Loss=5.14133 | acc=0.1298 | tpr=0.7508 | fpr=0.8815 | 8532.5 samples/s | 33.3 steps/s
[Step= 250] | Loss=5.14049 | acc=0.1303 | tpr=0.7520 | fpr=0.8810 | 7982.3 samples/s | 31.2 steps/s
[Step= 300] | Loss=5.13690 | acc=0.1299 | tpr=0.7535 | fpr=0.8814 | 7941.4 samples/s | 31.0 steps/s
[Step= 350] | Loss=5.13089 | acc=0.1296 | tpr=0.7489 | fpr=0.8817 | 8104.1 samples/s | 31.7 steps/s
[Step= 400] | Loss=5.13204 | acc=0.1296 | tpr=0.7445 | fpr=0.8816 | 8314.4 samples/s | 32.5 steps/s
[Step= 450] | Loss=5.13729 | acc=0.1294 | tpr=0.7395 | fpr=0.8817 | 7886.3 samples/s | 30.8 steps/s
[Step= 500] | Loss=5.14317 | acc=0.1291 | tpr=0.7410 | fpr=0.8819 | 7965.6 samples/s | 31.1 steps/s
[Step= 550] | Loss=5.14132 | acc=0.1291 | tpr=0.7433 | fpr=0.8821 | 14469.6 samples/s | 56.5 steps/s
Avg test loss: 5.14257, Avg test acc: 0.12902, Avg tpr: 0.74287, Avg fpr: 0.88214, total FA: 122483

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.70046 | acc=0.1200 | tpr=0.8186 | fpr=0.8926 | 4059.1 samples/s | 15.9 steps/s
[Step= 100] | Loss=5.64790 | acc=0.1228 | tpr=0.8166 | fpr=0.8901 | 8355.2 samples/s | 32.6 steps/s
[Step= 150] | Loss=5.65111 | acc=0.1205 | tpr=0.8329 | fpr=0.8926 | 8024.8 samples/s | 31.3 steps/s
[Step= 200] | Loss=5.65140 | acc=0.1197 | tpr=0.8339 | fpr=0.8933 | 8016.1 samples/s | 31.3 steps/s
[Step= 250] | Loss=5.65175 | acc=0.1200 | tpr=0.8349 | fpr=0.8931 | 7949.6 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.64785 | acc=0.1199 | tpr=0.8385 | fpr=0.8932 | 8111.4 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.64560 | acc=0.1197 | tpr=0.8384 | fpr=0.8933 | 7985.0 samples/s | 31.2 steps/s
[Step= 400] | Loss=5.64839 | acc=0.1198 | tpr=0.8370 | fpr=0.8932 | 8098.3 samples/s | 31.6 steps/s
[Step= 450] | Loss=5.65288 | acc=0.1192 | tpr=0.8335 | fpr=0.8937 | 7978.1 samples/s | 31.2 steps/s
[Step= 500] | Loss=5.65348 | acc=0.1193 | tpr=0.8344 | fpr=0.8936 | 7731.2 samples/s | 30.2 steps/s
[Step= 550] | Loss=5.65280 | acc=0.1190 | tpr=0.8372 | fpr=0.8940 | 14378.1 samples/s | 56.2 steps/s
Avg test loss: 5.65449, Avg test acc: 0.11899, Avg tpr: 0.83677, Avg fpr: 0.89406, total FA: 124138

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.15742 | acc=0.1370 | tpr=0.7788 | fpr=0.8746 | 4080.9 samples/s | 15.9 steps/s
[Step= 100] | Loss=5.10651 | acc=0.1393 | tpr=0.7463 | fpr=0.8720 | 8013.2 samples/s | 31.3 steps/s
[Step= 150] | Loss=5.10357 | acc=0.1379 | tpr=0.7709 | fpr=0.8737 | 8157.2 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.09914 | acc=0.1378 | tpr=0.7683 | fpr=0.8737 | 7971.2 samples/s | 31.1 steps/s
[Step= 250] | Loss=5.10185 | acc=0.1381 | tpr=0.7677 | fpr=0.8733 | 8189.9 samples/s | 32.0 steps/s
[Step= 300] | Loss=5.09860 | acc=0.1373 | tpr=0.7658 | fpr=0.8742 | 8107.5 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.09320 | acc=0.1369 | tpr=0.7627 | fpr=0.8745 | 8227.5 samples/s | 32.1 steps/s
[Step= 400] | Loss=5.09656 | acc=0.1366 | tpr=0.7615 | fpr=0.8748 | 7890.7 samples/s | 30.8 steps/s
[Step= 450] | Loss=5.10207 | acc=0.1361 | tpr=0.7556 | fpr=0.8751 | 7981.9 samples/s | 31.2 steps/s
[Step= 500] | Loss=5.10568 | acc=0.1360 | tpr=0.7586 | fpr=0.8753 | 7414.8 samples/s | 29.0 steps/s
[Step= 550] | Loss=5.10443 | acc=0.1359 | tpr=0.7628 | fpr=0.8755 | 13937.9 samples/s | 54.4 steps/s
Avg test loss: 5.10633, Avg test acc: 0.13579, Avg tpr: 0.76228, Avg fpr: 0.87560, total FA: 121575

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.33196 | acc=0.1277 | tpr=0.7345 | fpr=0.8833 | 4100.5 samples/s | 16.0 steps/s
[Step= 100] | Loss=5.27612 | acc=0.1310 | tpr=0.7058 | fpr=0.8797 | 7895.4 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.27633 | acc=0.1300 | tpr=0.7032 | fpr=0.8806 | 8197.3 samples/s | 32.0 steps/s
[Step= 200] | Loss=5.27529 | acc=0.1295 | tpr=0.6973 | fpr=0.8808 | 7651.2 samples/s | 29.9 steps/s
[Step= 250] | Loss=5.28126 | acc=0.1298 | tpr=0.6987 | fpr=0.8805 | 8307.1 samples/s | 32.4 steps/s
[Step= 300] | Loss=5.27835 | acc=0.1294 | tpr=0.7040 | fpr=0.8810 | 7761.9 samples/s | 30.3 steps/s
[Step= 350] | Loss=5.27408 | acc=0.1289 | tpr=0.7026 | fpr=0.8815 | 8286.4 samples/s | 32.4 steps/s
[Step= 400] | Loss=5.27720 | acc=0.1293 | tpr=0.7013 | fpr=0.8811 | 7797.3 samples/s | 30.5 steps/s
[Step= 450] | Loss=5.27976 | acc=0.1287 | tpr=0.6947 | fpr=0.8815 | 7928.1 samples/s | 31.0 steps/s
[Step= 500] | Loss=5.28184 | acc=0.1285 | tpr=0.6925 | fpr=0.8817 | 8076.2 samples/s | 31.5 steps/s
[Step= 550] | Loss=5.28094 | acc=0.1282 | tpr=0.6916 | fpr=0.8820 | 13465.0 samples/s | 52.6 steps/s
Avg test loss: 5.28316, Avg test acc: 0.12816, Avg tpr: 0.69097, Avg fpr: 0.88207, total FA: 122474

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10762 | acc=0.9812 | tpr=0.9425 | fpr=0.0181 | 4100.5 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.11204 | acc=0.9803 | tpr=0.9552 | fpr=0.0192 | 8163.1 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.11642 | acc=0.9793 | tpr=0.9524 | fpr=0.0202 | 8003.1 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.11869 | acc=0.9793 | tpr=0.9563 | fpr=0.0203 | 8219.3 samples/s | 32.1 steps/s
[Step= 250] | Loss=0.11801 | acc=0.9792 | tpr=0.9493 | fpr=0.0203 | 7817.7 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.12037 | acc=0.9788 | tpr=0.9469 | fpr=0.0206 | 7905.2 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.12031 | acc=0.9786 | tpr=0.9461 | fpr=0.0208 | 8158.6 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.12137 | acc=0.9785 | tpr=0.9426 | fpr=0.0208 | 8319.7 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.12408 | acc=0.9782 | tpr=0.9421 | fpr=0.0211 | 8004.1 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.12384 | acc=0.9783 | tpr=0.9432 | fpr=0.0211 | 7926.9 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.12279 | acc=0.9785 | tpr=0.9431 | fpr=0.0209 | 14049.8 samples/s | 54.9 steps/s
Avg test loss: 0.12261, Avg test acc: 0.97850, Avg tpr: 0.94334, Avg fpr: 0.02086, total FA: 2897

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11424 | acc=0.9812 | tpr=0.9115 | fpr=0.0176 | 4079.1 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.11835 | acc=0.9810 | tpr=0.9211 | fpr=0.0179 | 7905.3 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.12327 | acc=0.9799 | tpr=0.9193 | fpr=0.0190 | 8510.3 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.12485 | acc=0.9800 | tpr=0.9246 | fpr=0.0190 | 7575.9 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.12380 | acc=0.9799 | tpr=0.9231 | fpr=0.0191 | 7966.9 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.12616 | acc=0.9795 | tpr=0.9229 | fpr=0.0195 | 8026.0 samples/s | 31.4 steps/s
[Step= 350] | Loss=0.12633 | acc=0.9793 | tpr=0.9249 | fpr=0.0197 | 7734.8 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.12762 | acc=0.9792 | tpr=0.9212 | fpr=0.0197 | 8160.1 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.13089 | acc=0.9790 | tpr=0.9202 | fpr=0.0199 | 8088.7 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.13043 | acc=0.9791 | tpr=0.9238 | fpr=0.0199 | 7836.6 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.12956 | acc=0.9792 | tpr=0.9236 | fpr=0.0198 | 14148.4 samples/s | 55.3 steps/s
Avg test loss: 0.12932, Avg test acc: 0.97921, Avg tpr: 0.92314, Avg fpr: 0.01977, total FA: 2745

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.12618 | acc=0.9776 | tpr=0.9336 | fpr=0.0216 | 4071.2 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.12979 | acc=0.9781 | tpr=0.9510 | fpr=0.0214 | 7840.0 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.13363 | acc=0.9772 | tpr=0.9481 | fpr=0.0222 | 8098.8 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.13593 | acc=0.9771 | tpr=0.9508 | fpr=0.0225 | 8041.1 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.13554 | acc=0.9768 | tpr=0.9502 | fpr=0.0227 | 8262.5 samples/s | 32.3 steps/s
[Step= 300] | Loss=0.13884 | acc=0.9764 | tpr=0.9476 | fpr=0.0231 | 7726.7 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.13932 | acc=0.9762 | tpr=0.9468 | fpr=0.0232 | 7806.4 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.14107 | acc=0.9761 | tpr=0.9420 | fpr=0.0233 | 8050.4 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.14464 | acc=0.9758 | tpr=0.9421 | fpr=0.0236 | 8093.5 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.14410 | acc=0.9758 | tpr=0.9441 | fpr=0.0236 | 7958.5 samples/s | 31.1 steps/s
[Step= 550] | Loss=0.14285 | acc=0.9761 | tpr=0.9431 | fpr=0.0233 | 14160.9 samples/s | 55.3 steps/s
Avg test loss: 0.14265, Avg test acc: 0.97608, Avg tpr: 0.94334, Avg fpr: 0.02333, total FA: 3239

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11104 | acc=0.9813 | tpr=0.9292 | fpr=0.0177 | 4021.8 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.11572 | acc=0.9803 | tpr=0.9446 | fpr=0.0190 | 8449.5 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.12033 | acc=0.9796 | tpr=0.9467 | fpr=0.0198 | 7511.3 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.12261 | acc=0.9794 | tpr=0.9519 | fpr=0.0201 | 8490.7 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.12141 | acc=0.9792 | tpr=0.9450 | fpr=0.0202 | 7780.9 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.12338 | acc=0.9789 | tpr=0.9455 | fpr=0.0204 | 8214.7 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.12349 | acc=0.9788 | tpr=0.9480 | fpr=0.0207 | 7859.1 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.12446 | acc=0.9787 | tpr=0.9447 | fpr=0.0207 | 7951.8 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.12752 | acc=0.9784 | tpr=0.9445 | fpr=0.0210 | 8317.0 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.12712 | acc=0.9785 | tpr=0.9463 | fpr=0.0210 | 7898.5 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.12625 | acc=0.9787 | tpr=0.9459 | fpr=0.0207 | 14303.8 samples/s | 55.9 steps/s
Avg test loss: 0.12608, Avg test acc: 0.97868, Avg tpr: 0.94612, Avg fpr: 0.02073, total FA: 2878

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12604 | acc=0.9802 | tpr=0.9292 | fpr=0.0188 | 4077.6 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.13084 | acc=0.9799 | tpr=0.9510 | fpr=0.0196 | 7371.0 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.13620 | acc=0.9788 | tpr=0.9481 | fpr=0.0207 | 7524.7 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.13864 | acc=0.9783 | tpr=0.9530 | fpr=0.0212 | 7956.4 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.13739 | acc=0.9784 | tpr=0.9493 | fpr=0.0211 | 8305.2 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.14009 | acc=0.9781 | tpr=0.9498 | fpr=0.0214 | 7772.8 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.14067 | acc=0.9779 | tpr=0.9512 | fpr=0.0216 | 8241.6 samples/s | 32.2 steps/s
[Step= 400] | Loss=0.14190 | acc=0.9777 | tpr=0.9475 | fpr=0.0218 | 7823.9 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.14528 | acc=0.9773 | tpr=0.9469 | fpr=0.0221 | 8095.4 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.14479 | acc=0.9774 | tpr=0.9480 | fpr=0.0221 | 8211.7 samples/s | 32.1 steps/s
[Step= 550] | Loss=0.14394 | acc=0.9775 | tpr=0.9467 | fpr=0.0220 | 13972.6 samples/s | 54.6 steps/s
Avg test loss: 0.14371, Avg test acc: 0.97749, Avg tpr: 0.94691, Avg fpr: 0.02195, total FA: 3048

server round 37/50

clients selected: [0 1 3 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=32001 Epoch=156.0] | Loss=0.00625 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=11.123 | 3622.8 samples/s | 56.6 steps/s
[Step=32050 Epoch=156.3] | Loss=0.02407 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.893 | L2-Norm(final)=11.118 | 4970.8 samples/s | 77.7 steps/s
[Step=32100 Epoch=156.5] | Loss=0.02233 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=11.118 | 5130.0 samples/s | 80.2 steps/s
[Step=32150 Epoch=156.8] | Loss=0.02013 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.909 | L2-Norm(final)=11.120 | 5231.0 samples/s | 81.7 steps/s
[Step=32200 Epoch=157.0] | Loss=0.01971 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.917 | L2-Norm(final)=11.123 | 6833.8 samples/s | 106.8 steps/s
[Step=32250 Epoch=157.3] | Loss=0.01874 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.925 | L2-Norm(final)=11.127 | 1819.9 samples/s | 28.4 steps/s
[Step=32300 Epoch=157.5] | Loss=0.01826 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.933 | L2-Norm(final)=11.133 | 5212.4 samples/s | 81.4 steps/s
[Step=32350 Epoch=157.7] | Loss=0.01786 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.940 | L2-Norm(final)=11.138 | 5084.5 samples/s | 79.4 steps/s
[Step=32400 Epoch=158.0] | Loss=0.01737 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.947 | L2-Norm(final)=11.143 | 6554.6 samples/s | 102.4 steps/s
[Step=32450 Epoch=158.2] | Loss=0.01677 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.954 | L2-Norm(final)=11.149 | 1858.4 samples/s | 29.0 steps/s
[Step=32500 Epoch=158.5] | Loss=0.01640 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.961 | L2-Norm(final)=11.155 | 5084.7 samples/s | 79.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=32501 Epoch=158.5] | Loss=0.01007 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.031 | L2-Norm(final)=11.217 | 3882.8 samples/s | 60.7 steps/s
[Step=32550 Epoch=158.7] | Loss=0.01617 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.043 | L2-Norm(final)=11.224 | 4159.9 samples/s | 65.0 steps/s
[Step=32600 Epoch=159.0] | Loss=0.01564 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.055 | L2-Norm(final)=11.231 | 4549.8 samples/s | 71.1 steps/s
[Step=32650 Epoch=159.2] | Loss=0.01543 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=11.236 | 4651.8 samples/s | 72.7 steps/s
[Step=32700 Epoch=159.5] | Loss=0.01474 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.078 | L2-Norm(final)=11.242 | 6050.8 samples/s | 94.5 steps/s
[Step=32750 Epoch=159.7] | Loss=0.01289 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.087 | L2-Norm(final)=11.248 | 1742.6 samples/s | 27.2 steps/s
[Step=32800 Epoch=159.9] | Loss=0.01155 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.095 | L2-Norm(final)=11.254 | 4615.4 samples/s | 72.1 steps/s
[Step=32850 Epoch=160.2] | Loss=0.01079 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.103 | L2-Norm(final)=11.259 | 4580.7 samples/s | 71.6 steps/s
[Step=32900 Epoch=160.4] | Loss=0.01040 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.109 | L2-Norm(final)=11.264 | 5635.8 samples/s | 88.1 steps/s
[Step=32950 Epoch=160.7] | Loss=0.00992 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.115 | L2-Norm(final)=11.268 | 1764.3 samples/s | 27.6 steps/s
[Step=33000 Epoch=160.9] | Loss=0.00939 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.121 | L2-Norm(final)=11.272 | 4571.3 samples/s | 71.4 steps/s
[Step=33050 Epoch=161.2] | Loss=0.00891 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.126 | L2-Norm(final)=11.277 | 4500.0 samples/s | 70.3 steps/s
[Step=33100 Epoch=161.4] | Loss=0.00863 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.130 | L2-Norm(final)=11.281 | 5330.8 samples/s | 83.3 steps/s
[Step=33150 Epoch=161.6] | Loss=0.00827 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=11.285 | 1802.5 samples/s | 28.2 steps/s
[Step=33200 Epoch=161.9] | Loss=0.00797 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.140 | L2-Norm(final)=11.288 | 4540.6 samples/s | 70.9 steps/s
[Step=33250 Epoch=162.1] | Loss=0.00784 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.144 | L2-Norm(final)=11.292 | 4595.1 samples/s | 71.8 steps/s
[Step=33300 Epoch=162.4] | Loss=0.00762 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.148 | L2-Norm(final)=11.295 | 4853.1 samples/s | 75.8 steps/s
[Step=33350 Epoch=162.6] | Loss=0.00744 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.151 | L2-Norm(final)=11.299 | 1835.0 samples/s | 28.7 steps/s
[Step=33400 Epoch=162.9] | Loss=0.00716 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.155 | L2-Norm(final)=11.302 | 4646.1 samples/s | 72.6 steps/s
[Step=33450 Epoch=163.1] | Loss=0.00703 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.159 | L2-Norm(final)=11.305 | 4725.6 samples/s | 73.8 steps/s
[Step=33500 Epoch=163.4] | Loss=0.00690 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.162 | L2-Norm(final)=11.308 | 4642.9 samples/s | 72.5 steps/s
[Step=33550 Epoch=163.6] | Loss=0.00680 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.165 | L2-Norm(final)=11.311 | 1900.3 samples/s | 29.7 steps/s
[Step=33600 Epoch=163.8] | Loss=0.00663 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.169 | L2-Norm(final)=11.314 | 4763.2 samples/s | 74.4 steps/s
[Step=33650 Epoch=164.1] | Loss=0.00647 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.172 | L2-Norm(final)=11.317 | 4756.5 samples/s | 74.3 steps/s
[Step=33700 Epoch=164.3] | Loss=0.00642 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.175 | L2-Norm(final)=11.319 | 4600.1 samples/s | 71.9 steps/s
[Step=33750 Epoch=164.6] | Loss=0.00637 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.178 | L2-Norm(final)=11.322 | 1944.6 samples/s | 30.4 steps/s
[Step=33800 Epoch=164.8] | Loss=0.00625 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.181 | L2-Norm(final)=11.325 | 4703.8 samples/s | 73.5 steps/s
[Step=33850 Epoch=165.1] | Loss=0.00612 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.183 | L2-Norm(final)=11.327 | 4501.7 samples/s | 70.3 steps/s
[Step=33900 Epoch=165.3] | Loss=0.00605 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.186 | L2-Norm(final)=11.330 | 4656.3 samples/s | 72.8 steps/s
[Step=33950 Epoch=165.5] | Loss=0.00597 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.189 | L2-Norm(final)=11.333 | 1950.1 samples/s | 30.5 steps/s
[Step=34000 Epoch=165.8] | Loss=0.00587 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.192 | L2-Norm(final)=11.335 | 4607.7 samples/s | 72.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step34000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=46001 Epoch=224.5] | Loss=0.01429 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.885 | L2-Norm(final)=13.026 | 3845.7 samples/s | 60.1 steps/s
[Step=46050 Epoch=224.7] | Loss=0.02375 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.892 | L2-Norm(final)=13.016 | 4767.8 samples/s | 74.5 steps/s
[Step=46100 Epoch=224.9] | Loss=0.01884 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.901 | L2-Norm(final)=13.016 | 5138.4 samples/s | 80.3 steps/s
[Step=46150 Epoch=225.2] | Loss=0.01846 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.909 | L2-Norm(final)=13.017 | 5123.7 samples/s | 80.1 steps/s
[Step=46200 Epoch=225.4] | Loss=0.01858 | Reg=0.00098 | acc=0.9688 | L2-Norm=9.917 | L2-Norm(final)=13.019 | 7250.5 samples/s | 113.3 steps/s
[Step=46250 Epoch=225.7] | Loss=0.01733 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.925 | L2-Norm(final)=13.022 | 1785.9 samples/s | 27.9 steps/s
[Step=46300 Epoch=225.9] | Loss=0.01651 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.933 | L2-Norm(final)=13.027 | 5147.0 samples/s | 80.4 steps/s
[Step=46350 Epoch=226.2] | Loss=0.01592 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.941 | L2-Norm(final)=13.031 | 4946.1 samples/s | 77.3 steps/s
[Step=46400 Epoch=226.4] | Loss=0.01556 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.948 | L2-Norm(final)=13.035 | 6658.5 samples/s | 104.0 steps/s
[Step=46450 Epoch=226.7] | Loss=0.01532 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.956 | L2-Norm(final)=13.040 | 1812.0 samples/s | 28.3 steps/s
[Step=46500 Epoch=226.9] | Loss=0.01486 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.964 | L2-Norm(final)=13.045 | 5189.4 samples/s | 81.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=46501 Epoch=226.9] | Loss=0.00864 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.040 | L2-Norm(final)=13.096 | 3542.8 samples/s | 55.4 steps/s
[Step=46550 Epoch=227.1] | Loss=0.01167 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.051 | L2-Norm(final)=13.104 | 4558.5 samples/s | 71.2 steps/s
[Step=46600 Epoch=227.4] | Loss=0.01326 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.063 | L2-Norm(final)=13.110 | 4555.9 samples/s | 71.2 steps/s
[Step=46650 Epoch=227.6] | Loss=0.01310 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.073 | L2-Norm(final)=13.114 | 4569.0 samples/s | 71.4 steps/s
[Step=46700 Epoch=227.9] | Loss=0.01304 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.082 | L2-Norm(final)=13.118 | 6058.1 samples/s | 94.7 steps/s
[Step=46750 Epoch=228.1] | Loss=0.01210 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.090 | L2-Norm(final)=13.121 | 1759.3 samples/s | 27.5 steps/s
[Step=46800 Epoch=228.4] | Loss=0.01127 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.097 | L2-Norm(final)=13.125 | 4558.5 samples/s | 71.2 steps/s
[Step=46850 Epoch=228.6] | Loss=0.01053 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.103 | L2-Norm(final)=13.129 | 4576.6 samples/s | 71.5 steps/s
[Step=46900 Epoch=228.9] | Loss=0.00993 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.109 | L2-Norm(final)=13.132 | 5821.2 samples/s | 91.0 steps/s
[Step=46950 Epoch=229.1] | Loss=0.00939 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.114 | L2-Norm(final)=13.135 | 1764.5 samples/s | 27.6 steps/s
[Step=47000 Epoch=229.3] | Loss=0.00898 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.118 | L2-Norm(final)=13.138 | 4556.7 samples/s | 71.2 steps/s
[Step=47050 Epoch=229.6] | Loss=0.00845 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.123 | L2-Norm(final)=13.141 | 4490.0 samples/s | 70.2 steps/s
[Step=47100 Epoch=229.8] | Loss=0.00805 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.126 | L2-Norm(final)=13.145 | 5302.3 samples/s | 82.8 steps/s
[Step=47150 Epoch=230.1] | Loss=0.00773 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.130 | L2-Norm(final)=13.147 | 1822.9 samples/s | 28.5 steps/s
[Step=47200 Epoch=230.3] | Loss=0.00737 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.134 | L2-Norm(final)=13.150 | 4743.3 samples/s | 74.1 steps/s
[Step=47250 Epoch=230.6] | Loss=0.00711 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.137 | L2-Norm(final)=13.153 | 4693.4 samples/s | 73.3 steps/s
[Step=47300 Epoch=230.8] | Loss=0.00704 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.140 | L2-Norm(final)=13.156 | 5213.1 samples/s | 81.5 steps/s
[Step=47350 Epoch=231.0] | Loss=0.00681 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.143 | L2-Norm(final)=13.158 | 1817.8 samples/s | 28.4 steps/s
[Step=47400 Epoch=231.3] | Loss=0.00658 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.146 | L2-Norm(final)=13.160 | 4469.3 samples/s | 69.8 steps/s
[Step=47450 Epoch=231.5] | Loss=0.00648 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.148 | L2-Norm(final)=13.163 | 4379.8 samples/s | 68.4 steps/s
[Step=47500 Epoch=231.8] | Loss=0.00641 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.151 | L2-Norm(final)=13.165 | 4818.3 samples/s | 75.3 steps/s
[Step=47550 Epoch=232.0] | Loss=0.00619 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.154 | L2-Norm(final)=13.167 | 1918.9 samples/s | 30.0 steps/s
[Step=47600 Epoch=232.3] | Loss=0.00606 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.156 | L2-Norm(final)=13.169 | 4828.4 samples/s | 75.4 steps/s
[Step=47650 Epoch=232.5] | Loss=0.00599 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.158 | L2-Norm(final)=13.171 | 4529.2 samples/s | 70.8 steps/s
[Step=47700 Epoch=232.8] | Loss=0.00588 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.161 | L2-Norm(final)=13.173 | 4710.8 samples/s | 73.6 steps/s
[Step=47750 Epoch=233.0] | Loss=0.00572 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.163 | L2-Norm(final)=13.176 | 1897.6 samples/s | 29.7 steps/s
[Step=47800 Epoch=233.2] | Loss=0.00561 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.166 | L2-Norm(final)=13.178 | 4691.7 samples/s | 73.3 steps/s
[Step=47850 Epoch=233.5] | Loss=0.00556 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.168 | L2-Norm(final)=13.180 | 4578.0 samples/s | 71.5 steps/s
[Step=47900 Epoch=233.7] | Loss=0.00555 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.170 | L2-Norm(final)=13.182 | 4401.5 samples/s | 68.8 steps/s
[Step=47950 Epoch=234.0] | Loss=0.00543 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.172 | L2-Norm(final)=13.184 | 1882.4 samples/s | 29.4 steps/s
[Step=48000 Epoch=234.2] | Loss=0.00535 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.175 | L2-Norm(final)=13.186 | 4648.9 samples/s | 72.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step48000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=34001 Epoch=165.8] | Loss=0.00572 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=12.171 | 3784.0 samples/s | 59.1 steps/s
[Step=34050 Epoch=166.0] | Loss=0.02956 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.893 | L2-Norm(final)=12.165 | 4774.4 samples/s | 74.6 steps/s
[Step=34100 Epoch=166.3] | Loss=0.02475 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.905 | L2-Norm(final)=12.162 | 5137.9 samples/s | 80.3 steps/s
[Step=34150 Epoch=166.5] | Loss=0.02197 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.916 | L2-Norm(final)=12.164 | 5161.6 samples/s | 80.6 steps/s
[Step=34200 Epoch=166.8] | Loss=0.02050 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.925 | L2-Norm(final)=12.168 | 7331.4 samples/s | 114.6 steps/s
[Step=34250 Epoch=167.0] | Loss=0.01945 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.934 | L2-Norm(final)=12.172 | 1842.1 samples/s | 28.8 steps/s
[Step=34300 Epoch=167.3] | Loss=0.01864 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.943 | L2-Norm(final)=12.177 | 5336.6 samples/s | 83.4 steps/s
[Step=34350 Epoch=167.5] | Loss=0.01805 | Reg=0.00099 | acc=0.9688 | L2-Norm=9.951 | L2-Norm(final)=12.182 | 5230.2 samples/s | 81.7 steps/s
[Step=34400 Epoch=167.8] | Loss=0.01766 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.959 | L2-Norm(final)=12.187 | 6649.2 samples/s | 103.9 steps/s
[Step=34450 Epoch=168.0] | Loss=0.01724 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.967 | L2-Norm(final)=12.193 | 1848.7 samples/s | 28.9 steps/s
[Step=34500 Epoch=168.2] | Loss=0.01669 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.975 | L2-Norm(final)=12.199 | 5317.1 samples/s | 83.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=168.2] | Loss=0.01131 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.052 | L2-Norm(final)=12.262 | 4179.6 samples/s | 65.3 steps/s
[Step=34550 Epoch=168.5] | Loss=0.01351 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.065 | L2-Norm(final)=12.270 | 3979.0 samples/s | 62.2 steps/s
[Step=34600 Epoch=168.7] | Loss=0.01376 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.076 | L2-Norm(final)=12.276 | 4693.7 samples/s | 73.3 steps/s
[Step=34650 Epoch=169.0] | Loss=0.01271 | Reg=0.00102 | acc=0.9688 | L2-Norm=10.087 | L2-Norm(final)=12.282 | 4483.7 samples/s | 70.1 steps/s
[Step=34700 Epoch=169.2] | Loss=0.01177 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.097 | L2-Norm(final)=12.288 | 6097.2 samples/s | 95.3 steps/s
[Step=34750 Epoch=169.5] | Loss=0.01061 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.107 | L2-Norm(final)=12.295 | 1752.7 samples/s | 27.4 steps/s
[Step=34800 Epoch=169.7] | Loss=0.00971 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.115 | L2-Norm(final)=12.301 | 4529.5 samples/s | 70.8 steps/s
[Step=34850 Epoch=169.9] | Loss=0.00922 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.122 | L2-Norm(final)=12.306 | 4544.7 samples/s | 71.0 steps/s
[Step=34900 Epoch=170.2] | Loss=0.00875 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.129 | L2-Norm(final)=12.310 | 5758.1 samples/s | 90.0 steps/s
[Step=34950 Epoch=170.4] | Loss=0.00850 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.135 | L2-Norm(final)=12.315 | 1785.0 samples/s | 27.9 steps/s
[Step=35000 Epoch=170.7] | Loss=0.00808 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.141 | L2-Norm(final)=12.319 | 4533.1 samples/s | 70.8 steps/s
[Step=35050 Epoch=170.9] | Loss=0.00767 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.146 | L2-Norm(final)=12.324 | 4637.7 samples/s | 72.5 steps/s
[Step=35100 Epoch=171.2] | Loss=0.00734 | Reg=0.00103 | acc=0.9844 | L2-Norm=10.151 | L2-Norm(final)=12.328 | 5184.1 samples/s | 81.0 steps/s
[Step=35150 Epoch=171.4] | Loss=0.00704 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.156 | L2-Norm(final)=12.331 | 1808.7 samples/s | 28.3 steps/s
[Step=35200 Epoch=171.7] | Loss=0.00678 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.161 | L2-Norm(final)=12.335 | 4619.1 samples/s | 72.2 steps/s
[Step=35250 Epoch=171.9] | Loss=0.00655 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.165 | L2-Norm(final)=12.339 | 4655.2 samples/s | 72.7 steps/s
[Step=35300 Epoch=172.1] | Loss=0.00632 | Reg=0.00103 | acc=1.0000 | L2-Norm=10.169 | L2-Norm(final)=12.343 | 5044.0 samples/s | 78.8 steps/s
[Step=35350 Epoch=172.4] | Loss=0.00613 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.173 | L2-Norm(final)=12.346 | 1860.0 samples/s | 29.1 steps/s
[Step=35400 Epoch=172.6] | Loss=0.00591 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.177 | L2-Norm(final)=12.350 | 4556.9 samples/s | 71.2 steps/s
[Step=35450 Epoch=172.9] | Loss=0.00577 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.181 | L2-Norm(final)=12.353 | 4595.3 samples/s | 71.8 steps/s
[Step=35500 Epoch=173.1] | Loss=0.00567 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.184 | L2-Norm(final)=12.356 | 4654.3 samples/s | 72.7 steps/s
[Step=35550 Epoch=173.4] | Loss=0.00554 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.188 | L2-Norm(final)=12.359 | 1898.6 samples/s | 29.7 steps/s
[Step=35600 Epoch=173.6] | Loss=0.00540 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.191 | L2-Norm(final)=12.362 | 4637.7 samples/s | 72.5 steps/s
[Step=35650 Epoch=173.8] | Loss=0.00532 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.194 | L2-Norm(final)=12.365 | 4650.6 samples/s | 72.7 steps/s
[Step=35700 Epoch=174.1] | Loss=0.00522 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.197 | L2-Norm(final)=12.368 | 4569.8 samples/s | 71.4 steps/s
[Step=35750 Epoch=174.3] | Loss=0.00514 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.200 | L2-Norm(final)=12.371 | 1911.2 samples/s | 29.9 steps/s
[Step=35800 Epoch=174.6] | Loss=0.00502 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.203 | L2-Norm(final)=12.373 | 4699.2 samples/s | 73.4 steps/s
[Step=35850 Epoch=174.8] | Loss=0.00497 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.206 | L2-Norm(final)=12.376 | 4541.6 samples/s | 71.0 steps/s
[Step=35900 Epoch=175.1] | Loss=0.00488 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.209 | L2-Norm(final)=12.379 | 4505.7 samples/s | 70.4 steps/s
[Step=35950 Epoch=175.3] | Loss=0.00480 | Reg=0.00104 | acc=1.0000 | L2-Norm=10.211 | L2-Norm(final)=12.381 | 1923.0 samples/s | 30.0 steps/s
[Step=36000 Epoch=175.6] | Loss=0.00472 | Reg=0.00104 | acc=0.9844 | L2-Norm=10.214 | L2-Norm(final)=12.384 | 4378.5 samples/s | 68.4 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step36000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=36001 Epoch=343.8] | Loss=0.01132 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.885 | L2-Norm(final)=8.444 | 3539.7 samples/s | 55.3 steps/s
[Step=36050 Epoch=344.3] | Loss=0.00141 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.907 | L2-Norm(final)=8.443 | 4760.8 samples/s | 74.4 steps/s
[Step=36100 Epoch=344.7] | Loss=0.00077 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.915 | L2-Norm(final)=8.445 | 6790.9 samples/s | 106.1 steps/s
[Step=36150 Epoch=345.2] | Loss=0.00055 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.917 | L2-Norm(final)=8.448 | 1708.3 samples/s | 26.7 steps/s
[Step=36200 Epoch=345.7] | Loss=0.00043 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.917 | L2-Norm(final)=8.450 | 6441.1 samples/s | 100.6 steps/s
[Step=36250 Epoch=346.2] | Loss=0.00036 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.917 | L2-Norm(final)=8.452 | 1773.7 samples/s | 27.7 steps/s
[Step=36300 Epoch=346.6] | Loss=0.00031 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.916 | L2-Norm(final)=8.454 | 5981.7 samples/s | 93.5 steps/s
[Step=36350 Epoch=347.1] | Loss=0.00027 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.915 | L2-Norm(final)=8.456 | 1829.8 samples/s | 28.6 steps/s
[Step=36400 Epoch=347.6] | Loss=0.00025 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.914 | L2-Norm(final)=8.458 | 5571.2 samples/s | 87.1 steps/s
[Step=36450 Epoch=348.1] | Loss=0.00023 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.912 | L2-Norm(final)=8.460 | 1845.2 samples/s | 28.8 steps/s
[Step=36500 Epoch=348.6] | Loss=0.00021 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.911 | L2-Norm(final)=8.461 | 5278.6 samples/s | 82.5 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=348.6] | Loss=0.00005 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.897 | L2-Norm(final)=8.478 | 3598.1 samples/s | 56.2 steps/s
[Step=36550 Epoch=349.0] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.894 | L2-Norm(final)=8.479 | 4132.1 samples/s | 64.6 steps/s
[Step=36600 Epoch=349.5] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=8.480 | 5826.0 samples/s | 91.0 steps/s
[Step=36650 Epoch=350.0] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.887 | L2-Norm(final)=8.481 | 1679.8 samples/s | 26.2 steps/s
[Step=36700 Epoch=350.5] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.883 | L2-Norm(final)=8.482 | 5549.7 samples/s | 86.7 steps/s
[Step=36750 Epoch=350.9] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.878 | L2-Norm(final)=8.483 | 1700.6 samples/s | 26.6 steps/s
[Step=36800 Epoch=351.4] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.874 | L2-Norm(final)=8.483 | 5233.6 samples/s | 81.8 steps/s
[Step=36850 Epoch=351.9] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.870 | L2-Norm(final)=8.484 | 1727.3 samples/s | 27.0 steps/s
[Step=36900 Epoch=352.4] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.865 | L2-Norm(final)=8.484 | 4914.5 samples/s | 76.8 steps/s
[Step=36950 Epoch=352.8] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.860 | L2-Norm(final)=8.485 | 1780.5 samples/s | 27.8 steps/s
[Step=37000 Epoch=353.3] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.856 | L2-Norm(final)=8.485 | 4663.7 samples/s | 72.9 steps/s
[Step=37050 Epoch=353.8] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.851 | L2-Norm(final)=8.486 | 1817.3 samples/s | 28.4 steps/s
[Step=37100 Epoch=354.3] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.846 | L2-Norm(final)=8.486 | 4508.2 samples/s | 70.4 steps/s
[Step=37150 Epoch=354.8] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.841 | L2-Norm(final)=8.487 | 1847.4 samples/s | 28.9 steps/s
[Step=37200 Epoch=355.2] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.836 | L2-Norm(final)=8.487 | 4524.1 samples/s | 70.7 steps/s
[Step=37250 Epoch=355.7] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.831 | L2-Norm(final)=8.487 | 1843.1 samples/s | 28.8 steps/s
[Step=37300 Epoch=356.2] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.825 | L2-Norm(final)=8.488 | 4471.9 samples/s | 69.9 steps/s
[Step=37350 Epoch=356.7] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.820 | L2-Norm(final)=8.488 | 1871.9 samples/s | 29.2 steps/s
[Step=37400 Epoch=357.1] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.815 | L2-Norm(final)=8.488 | 4350.4 samples/s | 68.0 steps/s
[Step=37450 Epoch=357.6] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.809 | L2-Norm(final)=8.489 | 1878.7 samples/s | 29.4 steps/s
[Step=37500 Epoch=358.1] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.804 | L2-Norm(final)=8.489 | 4351.4 samples/s | 68.0 steps/s
[Step=37550 Epoch=358.6] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.798 | L2-Norm(final)=8.489 | 6292.4 samples/s | 98.3 steps/s
[Step=37600 Epoch=359.1] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.792 | L2-Norm(final)=8.490 | 1658.6 samples/s | 25.9 steps/s
[Step=37650 Epoch=359.5] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.787 | L2-Norm(final)=8.490 | 5881.6 samples/s | 91.9 steps/s
[Step=37700 Epoch=360.0] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.781 | L2-Norm(final)=8.490 | 1605.2 samples/s | 25.1 steps/s
[Step=37750 Epoch=360.5] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.775 | L2-Norm(final)=8.491 | 5399.7 samples/s | 84.4 steps/s
[Step=37800 Epoch=361.0] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.769 | L2-Norm(final)=8.491 | 1697.1 samples/s | 26.5 steps/s
[Step=37850 Epoch=361.4] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.763 | L2-Norm(final)=8.491 | 5330.5 samples/s | 83.3 steps/s
[Step=37900 Epoch=361.9] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.757 | L2-Norm(final)=8.492 | 1740.0 samples/s | 27.2 steps/s
[Step=37950 Epoch=362.4] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=8.492 | 4880.9 samples/s | 76.3 steps/s
[Step=38000 Epoch=362.9] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.744 | L2-Norm(final)=8.492 | 1774.6 samples/s | 27.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step38000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=36001 Epoch=339.2] | Loss=0.00123 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=8.882 | 3469.3 samples/s | 54.2 steps/s
[Step=36050 Epoch=339.7] | Loss=0.00126 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=8.884 | 4510.4 samples/s | 70.5 steps/s
[Step=36100 Epoch=340.2] | Loss=0.00088 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.914 | L2-Norm(final)=8.891 | 6433.8 samples/s | 100.5 steps/s
[Step=36150 Epoch=340.6] | Loss=0.00064 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.921 | L2-Norm(final)=8.897 | 1757.4 samples/s | 27.5 steps/s
[Step=36200 Epoch=341.1] | Loss=0.00051 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.924 | L2-Norm(final)=8.902 | 6114.2 samples/s | 95.5 steps/s
[Step=36250 Epoch=341.6] | Loss=0.00042 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.925 | L2-Norm(final)=8.907 | 1803.5 samples/s | 28.2 steps/s
[Step=36300 Epoch=342.0] | Loss=0.00037 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.925 | L2-Norm(final)=8.911 | 5541.6 samples/s | 86.6 steps/s
[Step=36350 Epoch=342.5] | Loss=0.00032 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.925 | L2-Norm(final)=8.914 | 1844.2 samples/s | 28.8 steps/s
[Step=36400 Epoch=343.0] | Loss=0.00029 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.924 | L2-Norm(final)=8.918 | 5116.5 samples/s | 79.9 steps/s
[Step=36450 Epoch=343.5] | Loss=0.00026 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.923 | L2-Norm(final)=8.921 | 1854.1 samples/s | 29.0 steps/s
[Step=36500 Epoch=343.9] | Loss=0.00024 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.921 | L2-Norm(final)=8.924 | 4974.9 samples/s | 77.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=343.9] | Loss=0.00004 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.905 | L2-Norm(final)=8.955 | 3537.5 samples/s | 55.3 steps/s
[Step=36550 Epoch=344.4] | Loss=0.00004 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.901 | L2-Norm(final)=8.957 | 4122.1 samples/s | 64.4 steps/s
[Step=36600 Epoch=344.9] | Loss=0.00004 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.896 | L2-Norm(final)=8.959 | 5817.4 samples/s | 90.9 steps/s
[Step=36650 Epoch=345.3] | Loss=0.00003 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.890 | L2-Norm(final)=8.960 | 1698.5 samples/s | 26.5 steps/s
[Step=36700 Epoch=345.8] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.883 | L2-Norm(final)=8.961 | 5394.9 samples/s | 84.3 steps/s
[Step=36750 Epoch=346.3] | Loss=0.00002 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.876 | L2-Norm(final)=8.962 | 1718.1 samples/s | 26.8 steps/s
[Step=36800 Epoch=346.8] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.868 | L2-Norm(final)=8.963 | 4821.5 samples/s | 75.3 steps/s
[Step=36850 Epoch=347.2] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.860 | L2-Norm(final)=8.963 | 1755.2 samples/s | 27.4 steps/s
[Step=36900 Epoch=347.7] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.852 | L2-Norm(final)=8.964 | 4323.6 samples/s | 67.6 steps/s
[Step=36950 Epoch=348.2] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.844 | L2-Norm(final)=8.964 | 1817.9 samples/s | 28.4 steps/s
[Step=37000 Epoch=348.6] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.836 | L2-Norm(final)=8.965 | 4259.9 samples/s | 66.6 steps/s
[Step=37050 Epoch=349.1] | Loss=0.00001 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.827 | L2-Norm(final)=8.965 | 1910.2 samples/s | 29.8 steps/s
[Step=37100 Epoch=349.6] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.819 | L2-Norm(final)=8.966 | 4496.2 samples/s | 70.3 steps/s
[Step=37150 Epoch=350.1] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.810 | L2-Norm(final)=8.966 | 1878.4 samples/s | 29.3 steps/s
[Step=37200 Epoch=350.5] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.801 | L2-Norm(final)=8.967 | 4476.4 samples/s | 69.9 steps/s
[Step=37250 Epoch=351.0] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.793 | L2-Norm(final)=8.967 | 1937.9 samples/s | 30.3 steps/s
[Step=37300 Epoch=351.5] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.784 | L2-Norm(final)=8.968 | 3793.5 samples/s | 59.3 steps/s
[Step=37350 Epoch=351.9] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.775 | L2-Norm(final)=8.968 | 5758.5 samples/s | 90.0 steps/s
[Step=37400 Epoch=352.4] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.765 | L2-Norm(final)=8.969 | 1646.4 samples/s | 25.7 steps/s
[Step=37450 Epoch=352.9] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.756 | L2-Norm(final)=8.969 | 5364.7 samples/s | 83.8 steps/s
[Step=37500 Epoch=353.4] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=8.969 | 1748.8 samples/s | 27.3 steps/s
[Step=37550 Epoch=353.8] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.737 | L2-Norm(final)=8.970 | 4921.2 samples/s | 76.9 steps/s
[Step=37600 Epoch=354.3] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.728 | L2-Norm(final)=8.970 | 1747.4 samples/s | 27.3 steps/s
[Step=37650 Epoch=354.8] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.718 | L2-Norm(final)=8.971 | 4579.4 samples/s | 71.6 steps/s
[Step=37700 Epoch=355.2] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.708 | L2-Norm(final)=8.971 | 1838.0 samples/s | 28.7 steps/s
[Step=37750 Epoch=355.7] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.698 | L2-Norm(final)=8.972 | 4018.1 samples/s | 62.8 steps/s
[Step=37800 Epoch=356.2] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.688 | L2-Norm(final)=8.972 | 1883.9 samples/s | 29.4 steps/s
[Step=37850 Epoch=356.7] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.678 | L2-Norm(final)=8.972 | 4490.1 samples/s | 70.2 steps/s
[Step=37900 Epoch=357.1] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=8.973 | 1876.5 samples/s | 29.3 steps/s
[Step=37950 Epoch=357.6] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.657 | L2-Norm(final)=8.973 | 4368.9 samples/s | 68.3 steps/s
[Step=38000 Epoch=358.1] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.647 | L2-Norm(final)=8.974 | 1980.0 samples/s | 30.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step38000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08593 | acc=0.9636 | tpr=0.9759 | fpr=0.0632 | 4081.5 samples/s | 15.9 steps/s
Avg test loss: 0.08865, Avg test acc: 0.96162, Avg tpr: 0.97412, Avg fpr: 0.06589, total FA: 514

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09215 | acc=0.9619 | tpr=0.9808 | fpr=0.0793 | 4154.9 samples/s | 16.2 steps/s
Avg test loss: 0.09601, Avg test acc: 0.95993, Avg tpr: 0.97972, Avg fpr: 0.08358, total FA: 652

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08730 | acc=0.9607 | tpr=0.9724 | fpr=0.0647 | 4156.7 samples/s | 16.2 steps/s
Avg test loss: 0.09255, Avg test acc: 0.95925, Avg tpr: 0.97027, Avg fpr: 0.06499, total FA: 507

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08519 | acc=0.9599 | tpr=0.9679 | fpr=0.0575 | 4019.9 samples/s | 15.7 steps/s
Avg test loss: 0.08947, Avg test acc: 0.95949, Avg tpr: 0.96689, Avg fpr: 0.05679, total FA: 443

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08680 | acc=0.9630 | tpr=0.9715 | fpr=0.0555 | 4066.0 samples/s | 15.9 steps/s
Avg test loss: 0.09361, Avg test acc: 0.96154, Avg tpr: 0.97033, Avg fpr: 0.05781, total FA: 451

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.21816 | acc=0.2950 | tpr=0.0027 | fpr=0.0704 | 4002.6 samples/s | 15.6 steps/s
Avg test loss: 5.23691, Avg test acc: 0.29313, Avg tpr: 0.00356, Avg fpr: 0.06999, total FA: 546

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.81103 | acc=0.3137 | tpr=0.0040 | fpr=0.0136 | 4119.6 samples/s | 16.1 steps/s
Avg test loss: 4.81787, Avg test acc: 0.31128, Avg tpr: 0.00460, Avg fpr: 0.01423, total FA: 111

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.98579 | acc=0.2997 | tpr=0.0068 | fpr=0.0644 | 3980.2 samples/s | 15.5 steps/s
Avg test loss: 4.99558, Avg test acc: 0.29746, Avg tpr: 0.00758, Avg fpr: 0.06499, total FA: 507

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.39094 | acc=0.3023 | tpr=0.0046 | fpr=0.0510 | 4098.0 samples/s | 16.0 steps/s
Avg test loss: 5.40477, Avg test acc: 0.29902, Avg tpr: 0.00513, Avg fpr: 0.05461, total FA: 426

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.94982 | acc=0.3137 | tpr=0.0025 | fpr=0.0107 | 4109.9 samples/s | 16.1 steps/s
Avg test loss: 4.95760, Avg test acc: 0.31088, Avg tpr: 0.00303, Avg fpr: 0.01205, total FA: 94

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.71615 | acc=0.1153 | tpr=0.8628 | fpr=0.8981 | 3912.3 samples/s | 15.3 steps/s
[Step= 100] | Loss=5.66114 | acc=0.1173 | tpr=0.8401 | fpr=0.8962 | 8082.8 samples/s | 31.6 steps/s
[Step= 150] | Loss=5.66330 | acc=0.1157 | tpr=0.8545 | fpr=0.8979 | 8133.1 samples/s | 31.8 steps/s
[Step= 200] | Loss=5.66171 | acc=0.1148 | tpr=0.8481 | fpr=0.8985 | 7585.9 samples/s | 29.6 steps/s
[Step= 250] | Loss=5.66541 | acc=0.1156 | tpr=0.8472 | fpr=0.8977 | 8195.1 samples/s | 32.0 steps/s
[Step= 300] | Loss=5.66085 | acc=0.1150 | tpr=0.8422 | fpr=0.8983 | 7809.5 samples/s | 30.5 steps/s
[Step= 350] | Loss=5.65702 | acc=0.1145 | tpr=0.8384 | fpr=0.8987 | 8141.2 samples/s | 31.8 steps/s
[Step= 400] | Loss=5.65906 | acc=0.1146 | tpr=0.8342 | fpr=0.8985 | 7932.4 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.66139 | acc=0.1142 | tpr=0.8330 | fpr=0.8989 | 8135.9 samples/s | 31.8 steps/s
[Step= 500] | Loss=5.66464 | acc=0.1140 | tpr=0.8344 | fpr=0.8990 | 7823.2 samples/s | 30.6 steps/s
[Step= 550] | Loss=5.66403 | acc=0.1139 | tpr=0.8372 | fpr=0.8993 | 14685.4 samples/s | 57.4 steps/s
Avg test loss: 5.66573, Avg test acc: 0.11386, Avg tpr: 0.83677, Avg fpr: 0.89929, total FA: 124864

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.26291 | acc=0.1188 | tpr=0.8584 | fpr=0.8945 | 3865.3 samples/s | 15.1 steps/s
[Step= 100] | Loss=5.20862 | acc=0.1212 | tpr=0.8571 | fpr=0.8925 | 8035.3 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.21255 | acc=0.1187 | tpr=0.8631 | fpr=0.8950 | 8184.8 samples/s | 32.0 steps/s
[Step= 200] | Loss=5.21321 | acc=0.1187 | tpr=0.8623 | fpr=0.8948 | 8141.6 samples/s | 31.8 steps/s
[Step= 250] | Loss=5.21357 | acc=0.1192 | tpr=0.8603 | fpr=0.8943 | 7936.1 samples/s | 31.0 steps/s
[Step= 300] | Loss=5.21079 | acc=0.1186 | tpr=0.8604 | fpr=0.8949 | 7918.2 samples/s | 30.9 steps/s
[Step= 350] | Loss=5.20551 | acc=0.1179 | tpr=0.8585 | fpr=0.8955 | 8055.5 samples/s | 31.5 steps/s
[Step= 400] | Loss=5.20664 | acc=0.1179 | tpr=0.8534 | fpr=0.8955 | 8072.5 samples/s | 31.5 steps/s
[Step= 450] | Loss=5.21198 | acc=0.1176 | tpr=0.8491 | fpr=0.8956 | 7982.7 samples/s | 31.2 steps/s
[Step= 500] | Loss=5.21806 | acc=0.1173 | tpr=0.8507 | fpr=0.8959 | 8094.3 samples/s | 31.6 steps/s
[Step= 550] | Loss=5.21617 | acc=0.1174 | tpr=0.8528 | fpr=0.8960 | 14465.5 samples/s | 56.5 steps/s
Avg test loss: 5.21734, Avg test acc: 0.11736, Avg tpr: 0.85222, Avg fpr: 0.89600, total FA: 124408

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.70046 | acc=0.1200 | tpr=0.8186 | fpr=0.8926 | 3865.2 samples/s | 15.1 steps/s
[Step= 100] | Loss=5.64790 | acc=0.1228 | tpr=0.8166 | fpr=0.8901 | 7874.3 samples/s | 30.8 steps/s
[Step= 150] | Loss=5.65111 | acc=0.1205 | tpr=0.8329 | fpr=0.8926 | 8180.5 samples/s | 32.0 steps/s
[Step= 200] | Loss=5.65140 | acc=0.1197 | tpr=0.8339 | fpr=0.8933 | 8083.4 samples/s | 31.6 steps/s
[Step= 250] | Loss=5.65175 | acc=0.1200 | tpr=0.8349 | fpr=0.8931 | 8301.9 samples/s | 32.4 steps/s
[Step= 300] | Loss=5.64785 | acc=0.1199 | tpr=0.8385 | fpr=0.8932 | 7997.0 samples/s | 31.2 steps/s
[Step= 350] | Loss=5.64560 | acc=0.1197 | tpr=0.8384 | fpr=0.8933 | 7589.9 samples/s | 29.6 steps/s
[Step= 400] | Loss=5.64839 | acc=0.1198 | tpr=0.8370 | fpr=0.8932 | 7624.6 samples/s | 29.8 steps/s
[Step= 450] | Loss=5.65288 | acc=0.1192 | tpr=0.8335 | fpr=0.8937 | 8245.3 samples/s | 32.2 steps/s
[Step= 500] | Loss=5.65348 | acc=0.1193 | tpr=0.8344 | fpr=0.8936 | 7746.8 samples/s | 30.3 steps/s
[Step= 550] | Loss=5.65280 | acc=0.1190 | tpr=0.8372 | fpr=0.8940 | 13505.1 samples/s | 52.8 steps/s
Avg test loss: 5.65449, Avg test acc: 0.11899, Avg tpr: 0.83677, Avg fpr: 0.89406, total FA: 124138

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.98707 | acc=0.1396 | tpr=0.7522 | fpr=0.8714 | 4060.6 samples/s | 15.9 steps/s
[Step= 100] | Loss=4.93788 | acc=0.1411 | tpr=0.7313 | fpr=0.8699 | 8076.7 samples/s | 31.5 steps/s
[Step= 150] | Loss=4.93377 | acc=0.1405 | tpr=0.7550 | fpr=0.8708 | 8094.3 samples/s | 31.6 steps/s
[Step= 200] | Loss=4.92870 | acc=0.1406 | tpr=0.7563 | fpr=0.8706 | 8453.6 samples/s | 33.0 steps/s
[Step= 250] | Loss=4.93095 | acc=0.1408 | tpr=0.7563 | fpr=0.8704 | 7667.6 samples/s | 30.0 steps/s
[Step= 300] | Loss=4.92835 | acc=0.1403 | tpr=0.7564 | fpr=0.8709 | 8065.2 samples/s | 31.5 steps/s
[Step= 350] | Loss=4.92326 | acc=0.1400 | tpr=0.7552 | fpr=0.8712 | 7696.2 samples/s | 30.1 steps/s
[Step= 400] | Loss=4.92627 | acc=0.1397 | tpr=0.7516 | fpr=0.8714 | 7311.7 samples/s | 28.6 steps/s
[Step= 450] | Loss=4.93144 | acc=0.1392 | tpr=0.7463 | fpr=0.8718 | 8004.0 samples/s | 31.3 steps/s
[Step= 500] | Loss=4.93445 | acc=0.1389 | tpr=0.7458 | fpr=0.8720 | 8008.3 samples/s | 31.3 steps/s
[Step= 550] | Loss=4.93264 | acc=0.1389 | tpr=0.7513 | fpr=0.8722 | 14420.5 samples/s | 56.3 steps/s
Avg test loss: 4.93430, Avg test acc: 0.13886, Avg tpr: 0.75079, Avg fpr: 0.87226, total FA: 121112

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.33196 | acc=0.1277 | tpr=0.7345 | fpr=0.8833 | 4114.4 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.27612 | acc=0.1310 | tpr=0.7058 | fpr=0.8797 | 7934.8 samples/s | 31.0 steps/s
[Step= 150] | Loss=5.27633 | acc=0.1300 | tpr=0.7032 | fpr=0.8806 | 8072.7 samples/s | 31.5 steps/s
[Step= 200] | Loss=5.27529 | acc=0.1295 | tpr=0.6973 | fpr=0.8808 | 8108.3 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.28126 | acc=0.1298 | tpr=0.6987 | fpr=0.8805 | 7802.6 samples/s | 30.5 steps/s
[Step= 300] | Loss=5.27835 | acc=0.1294 | tpr=0.7040 | fpr=0.8810 | 8254.9 samples/s | 32.2 steps/s
[Step= 350] | Loss=5.27408 | acc=0.1289 | tpr=0.7026 | fpr=0.8815 | 7721.6 samples/s | 30.2 steps/s
[Step= 400] | Loss=5.27720 | acc=0.1293 | tpr=0.7013 | fpr=0.8811 | 7659.1 samples/s | 29.9 steps/s
[Step= 450] | Loss=5.27976 | acc=0.1287 | tpr=0.6947 | fpr=0.8815 | 7725.0 samples/s | 30.2 steps/s
[Step= 500] | Loss=5.28184 | acc=0.1285 | tpr=0.6925 | fpr=0.8817 | 7690.1 samples/s | 30.0 steps/s
[Step= 550] | Loss=5.28094 | acc=0.1282 | tpr=0.6916 | fpr=0.8820 | 14736.7 samples/s | 57.6 steps/s
Avg test loss: 5.28316, Avg test acc: 0.12816, Avg tpr: 0.69097, Avg fpr: 0.88207, total FA: 122474

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10762 | acc=0.9812 | tpr=0.9425 | fpr=0.0181 | 4062.9 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.11204 | acc=0.9803 | tpr=0.9552 | fpr=0.0192 | 8034.8 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.11642 | acc=0.9793 | tpr=0.9524 | fpr=0.0202 | 6966.7 samples/s | 27.2 steps/s
[Step= 200] | Loss=0.11869 | acc=0.9793 | tpr=0.9563 | fpr=0.0203 | 8029.8 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.11801 | acc=0.9792 | tpr=0.9493 | fpr=0.0203 | 7742.9 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.12037 | acc=0.9788 | tpr=0.9469 | fpr=0.0206 | 7106.1 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.12031 | acc=0.9786 | tpr=0.9461 | fpr=0.0208 | 7672.2 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.12137 | acc=0.9785 | tpr=0.9426 | fpr=0.0208 | 7140.5 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.12408 | acc=0.9782 | tpr=0.9421 | fpr=0.0211 | 7244.4 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.12384 | acc=0.9783 | tpr=0.9432 | fpr=0.0211 | 7766.1 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.12279 | acc=0.9785 | tpr=0.9431 | fpr=0.0209 | 14927.9 samples/s | 58.3 steps/s
Avg test loss: 0.12261, Avg test acc: 0.97850, Avg tpr: 0.94334, Avg fpr: 0.02086, total FA: 2897

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11424 | acc=0.9812 | tpr=0.9115 | fpr=0.0176 | 4116.7 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.11835 | acc=0.9810 | tpr=0.9211 | fpr=0.0179 | 8071.5 samples/s | 31.5 steps/s
[Step= 150] | Loss=0.12327 | acc=0.9799 | tpr=0.9193 | fpr=0.0190 | 7640.9 samples/s | 29.8 steps/s
[Step= 200] | Loss=0.12485 | acc=0.9800 | tpr=0.9246 | fpr=0.0190 | 7853.7 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.12380 | acc=0.9799 | tpr=0.9231 | fpr=0.0191 | 8492.5 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.12616 | acc=0.9795 | tpr=0.9229 | fpr=0.0195 | 7840.2 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.12633 | acc=0.9793 | tpr=0.9249 | fpr=0.0197 | 8069.1 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.12762 | acc=0.9792 | tpr=0.9212 | fpr=0.0197 | 8374.9 samples/s | 32.7 steps/s
[Step= 450] | Loss=0.13089 | acc=0.9790 | tpr=0.9202 | fpr=0.0199 | 7738.2 samples/s | 30.2 steps/s
[Step= 500] | Loss=0.13043 | acc=0.9791 | tpr=0.9238 | fpr=0.0199 | 7850.0 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.12956 | acc=0.9792 | tpr=0.9236 | fpr=0.0198 | 14826.6 samples/s | 57.9 steps/s
Avg test loss: 0.12932, Avg test acc: 0.97921, Avg tpr: 0.92314, Avg fpr: 0.01977, total FA: 2745

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11198 | acc=0.9791 | tpr=0.9381 | fpr=0.0201 | 4186.4 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.11594 | acc=0.9786 | tpr=0.9574 | fpr=0.0210 | 8501.3 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.12016 | acc=0.9772 | tpr=0.9553 | fpr=0.0224 | 8118.5 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.12206 | acc=0.9774 | tpr=0.9585 | fpr=0.0223 | 8364.0 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.12134 | acc=0.9772 | tpr=0.9546 | fpr=0.0224 | 8064.1 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.12379 | acc=0.9769 | tpr=0.9556 | fpr=0.0227 | 8092.8 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.12379 | acc=0.9768 | tpr=0.9568 | fpr=0.0228 | 8314.1 samples/s | 32.5 steps/s
[Step= 400] | Loss=0.12506 | acc=0.9767 | tpr=0.9546 | fpr=0.0229 | 7798.7 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.12803 | acc=0.9765 | tpr=0.9537 | fpr=0.0231 | 8236.7 samples/s | 32.2 steps/s
[Step= 500] | Loss=0.12776 | acc=0.9765 | tpr=0.9555 | fpr=0.0231 | 7386.6 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.12664 | acc=0.9768 | tpr=0.9554 | fpr=0.0228 | 15065.8 samples/s | 58.9 steps/s
Avg test loss: 0.12649, Avg test acc: 0.97681, Avg tpr: 0.95563, Avg fpr: 0.02280, total FA: 3166

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11241 | acc=0.9814 | tpr=0.9292 | fpr=0.0177 | 4131.8 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.11703 | acc=0.9804 | tpr=0.9446 | fpr=0.0189 | 8030.7 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.12152 | acc=0.9798 | tpr=0.9467 | fpr=0.0196 | 7973.9 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.12378 | acc=0.9797 | tpr=0.9519 | fpr=0.0198 | 7785.2 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.12256 | acc=0.9795 | tpr=0.9450 | fpr=0.0199 | 7657.5 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.12451 | acc=0.9793 | tpr=0.9455 | fpr=0.0201 | 7356.9 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.12463 | acc=0.9790 | tpr=0.9474 | fpr=0.0204 | 7966.4 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.12555 | acc=0.9789 | tpr=0.9442 | fpr=0.0205 | 8231.7 samples/s | 32.2 steps/s
[Step= 450] | Loss=0.12865 | acc=0.9786 | tpr=0.9445 | fpr=0.0208 | 8090.1 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.12823 | acc=0.9787 | tpr=0.9458 | fpr=0.0207 | 7923.7 samples/s | 31.0 steps/s
[Step= 550] | Loss=0.12729 | acc=0.9789 | tpr=0.9451 | fpr=0.0205 | 14276.0 samples/s | 55.8 steps/s
Avg test loss: 0.12710, Avg test acc: 0.97889, Avg tpr: 0.94493, Avg fpr: 0.02049, total FA: 2845

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12604 | acc=0.9802 | tpr=0.9292 | fpr=0.0188 | 4055.1 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.13084 | acc=0.9799 | tpr=0.9510 | fpr=0.0196 | 7986.4 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.13620 | acc=0.9788 | tpr=0.9481 | fpr=0.0207 | 7864.6 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.13864 | acc=0.9783 | tpr=0.9530 | fpr=0.0212 | 8143.6 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.13739 | acc=0.9784 | tpr=0.9493 | fpr=0.0211 | 8295.4 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.14009 | acc=0.9781 | tpr=0.9498 | fpr=0.0214 | 7906.5 samples/s | 30.9 steps/s
[Step= 350] | Loss=0.14067 | acc=0.9779 | tpr=0.9512 | fpr=0.0216 | 8664.5 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.14190 | acc=0.9777 | tpr=0.9475 | fpr=0.0218 | 7694.9 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.14528 | acc=0.9773 | tpr=0.9469 | fpr=0.0221 | 8293.5 samples/s | 32.4 steps/s
[Step= 500] | Loss=0.14479 | acc=0.9774 | tpr=0.9480 | fpr=0.0221 | 7791.3 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.14394 | acc=0.9775 | tpr=0.9467 | fpr=0.0220 | 15490.7 samples/s | 60.5 steps/s
Avg test loss: 0.14371, Avg test acc: 0.97749, Avg tpr: 0.94691, Avg fpr: 0.02195, total FA: 3048

server round 38/50

clients selected: [0 3 4 6 9]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=34001 Epoch=165.8] | Loss=0.05971 | Reg=0.00096 | acc=0.9688 | L2-Norm=9.795 | L2-Norm(final)=11.412 | 3833.9 samples/s | 59.9 steps/s
[Step=34050 Epoch=166.0] | Loss=0.02466 | Reg=0.00096 | acc=0.9531 | L2-Norm=9.805 | L2-Norm(final)=11.406 | 4302.4 samples/s | 67.2 steps/s
[Step=34100 Epoch=166.3] | Loss=0.02131 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.815 | L2-Norm(final)=11.406 | 4958.4 samples/s | 77.5 steps/s
[Step=34150 Epoch=166.5] | Loss=0.02035 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.823 | L2-Norm(final)=11.408 | 4990.6 samples/s | 78.0 steps/s
[Step=34200 Epoch=166.8] | Loss=0.02019 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.830 | L2-Norm(final)=11.410 | 7194.1 samples/s | 112.4 steps/s
[Step=34250 Epoch=167.0] | Loss=0.01921 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.836 | L2-Norm(final)=11.413 | 1773.1 samples/s | 27.7 steps/s
[Step=34300 Epoch=167.3] | Loss=0.01911 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.843 | L2-Norm(final)=11.417 | 4967.8 samples/s | 77.6 steps/s
[Step=34350 Epoch=167.5] | Loss=0.01819 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.850 | L2-Norm(final)=11.421 | 5089.8 samples/s | 79.5 steps/s
[Step=34400 Epoch=167.7] | Loss=0.01762 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.857 | L2-Norm(final)=11.425 | 6516.5 samples/s | 101.8 steps/s
[Step=34450 Epoch=168.0] | Loss=0.01701 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.864 | L2-Norm(final)=11.430 | 1872.2 samples/s | 29.3 steps/s
[Step=34500 Epoch=168.2] | Loss=0.01645 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.870 | L2-Norm(final)=11.435 | 5007.4 samples/s | 78.2 steps/s
All layers training...
LR=0.00013, len=1
[Step=34501 Epoch=168.2] | Loss=0.00753 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.937 | L2-Norm(final)=11.488 | 3734.8 samples/s | 58.4 steps/s
[Step=34550 Epoch=168.5] | Loss=0.01700 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.945 | L2-Norm(final)=11.492 | 4234.3 samples/s | 66.2 steps/s
[Step=34600 Epoch=168.7] | Loss=0.01652 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.956 | L2-Norm(final)=11.496 | 4598.4 samples/s | 71.8 steps/s
[Step=34650 Epoch=169.0] | Loss=0.01580 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.967 | L2-Norm(final)=11.502 | 4593.2 samples/s | 71.8 steps/s
[Step=34700 Epoch=169.2] | Loss=0.01466 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=11.507 | 6051.0 samples/s | 94.5 steps/s
[Step=34750 Epoch=169.4] | Loss=0.01324 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.985 | L2-Norm(final)=11.513 | 1752.0 samples/s | 27.4 steps/s
[Step=34800 Epoch=169.7] | Loss=0.01203 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.992 | L2-Norm(final)=11.518 | 4554.3 samples/s | 71.2 steps/s
[Step=34850 Epoch=169.9] | Loss=0.01127 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.999 | L2-Norm(final)=11.522 | 4564.0 samples/s | 71.3 steps/s
[Step=34900 Epoch=170.2] | Loss=0.01084 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.005 | L2-Norm(final)=11.527 | 5709.3 samples/s | 89.2 steps/s
[Step=34950 Epoch=170.4] | Loss=0.01015 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.011 | L2-Norm(final)=11.531 | 1765.3 samples/s | 27.6 steps/s
[Step=35000 Epoch=170.7] | Loss=0.00962 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.016 | L2-Norm(final)=11.536 | 4525.2 samples/s | 70.7 steps/s
[Step=35050 Epoch=170.9] | Loss=0.00932 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.021 | L2-Norm(final)=11.540 | 4520.7 samples/s | 70.6 steps/s
[Step=35100 Epoch=171.2] | Loss=0.00895 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.026 | L2-Norm(final)=11.543 | 5112.5 samples/s | 79.9 steps/s
[Step=35150 Epoch=171.4] | Loss=0.00863 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.030 | L2-Norm(final)=11.547 | 1836.9 samples/s | 28.7 steps/s
[Step=35200 Epoch=171.6] | Loss=0.00844 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.034 | L2-Norm(final)=11.551 | 4578.6 samples/s | 71.5 steps/s
[Step=35250 Epoch=171.9] | Loss=0.00815 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.039 | L2-Norm(final)=11.554 | 4620.6 samples/s | 72.2 steps/s
[Step=35300 Epoch=172.1] | Loss=0.00785 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.042 | L2-Norm(final)=11.558 | 5066.1 samples/s | 79.2 steps/s
[Step=35350 Epoch=172.4] | Loss=0.00753 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.046 | L2-Norm(final)=11.561 | 1858.4 samples/s | 29.0 steps/s
[Step=35400 Epoch=172.6] | Loss=0.00743 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.050 | L2-Norm(final)=11.564 | 4625.0 samples/s | 72.3 steps/s
[Step=35450 Epoch=172.9] | Loss=0.00720 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.053 | L2-Norm(final)=11.568 | 4668.4 samples/s | 72.9 steps/s
[Step=35500 Epoch=173.1] | Loss=0.00708 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.057 | L2-Norm(final)=11.571 | 4691.3 samples/s | 73.3 steps/s
[Step=35550 Epoch=173.3] | Loss=0.00687 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.060 | L2-Norm(final)=11.574 | 1891.3 samples/s | 29.6 steps/s
[Step=35600 Epoch=173.6] | Loss=0.00677 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.063 | L2-Norm(final)=11.577 | 4473.8 samples/s | 69.9 steps/s
[Step=35650 Epoch=173.8] | Loss=0.00665 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.067 | L2-Norm(final)=11.580 | 4361.9 samples/s | 68.2 steps/s
[Step=35700 Epoch=174.1] | Loss=0.00652 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.070 | L2-Norm(final)=11.582 | 4556.1 samples/s | 71.2 steps/s
[Step=35750 Epoch=174.3] | Loss=0.00639 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.072 | L2-Norm(final)=11.585 | 1926.4 samples/s | 30.1 steps/s
[Step=35800 Epoch=174.6] | Loss=0.00626 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.075 | L2-Norm(final)=11.588 | 4579.4 samples/s | 71.6 steps/s
[Step=35850 Epoch=174.8] | Loss=0.00611 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.078 | L2-Norm(final)=11.591 | 4551.4 samples/s | 71.1 steps/s
[Step=35900 Epoch=175.1] | Loss=0.00604 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.081 | L2-Norm(final)=11.594 | 4521.5 samples/s | 70.6 steps/s
[Step=35950 Epoch=175.3] | Loss=0.00593 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.083 | L2-Norm(final)=11.596 | 1934.9 samples/s | 30.2 steps/s
[Step=36000 Epoch=175.5] | Loss=0.00586 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.086 | L2-Norm(final)=11.599 | 4517.5 samples/s | 70.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step36000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=36001 Epoch=175.6] | Loss=0.03997 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.795 | L2-Norm(final)=12.459 | 3632.4 samples/s | 56.8 steps/s
[Step=36050 Epoch=175.8] | Loss=0.02347 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.800 | L2-Norm(final)=12.450 | 5017.9 samples/s | 78.4 steps/s
[Step=36100 Epoch=176.0] | Loss=0.02050 | Reg=0.00096 | acc=0.9688 | L2-Norm=9.811 | L2-Norm(final)=12.452 | 5100.2 samples/s | 79.7 steps/s
[Step=36150 Epoch=176.3] | Loss=0.02141 | Reg=0.00096 | acc=0.9688 | L2-Norm=9.822 | L2-Norm(final)=12.455 | 5201.4 samples/s | 81.3 steps/s
[Step=36200 Epoch=176.5] | Loss=0.02023 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.832 | L2-Norm(final)=12.458 | 6921.9 samples/s | 108.2 steps/s
[Step=36250 Epoch=176.8] | Loss=0.01929 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=12.461 | 1826.6 samples/s | 28.5 steps/s
[Step=36300 Epoch=177.0] | Loss=0.01840 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.851 | L2-Norm(final)=12.465 | 4998.8 samples/s | 78.1 steps/s
[Step=36350 Epoch=177.3] | Loss=0.01746 | Reg=0.00097 | acc=0.9531 | L2-Norm=9.859 | L2-Norm(final)=12.470 | 5119.5 samples/s | 80.0 steps/s
[Step=36400 Epoch=177.5] | Loss=0.01713 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.868 | L2-Norm(final)=12.475 | 6565.4 samples/s | 102.6 steps/s
[Step=36450 Epoch=177.8] | Loss=0.01659 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.876 | L2-Norm(final)=12.480 | 1853.0 samples/s | 29.0 steps/s
[Step=36500 Epoch=178.0] | Loss=0.01594 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=12.486 | 5046.9 samples/s | 78.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=178.0] | Loss=0.01683 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.967 | L2-Norm(final)=12.546 | 3755.7 samples/s | 58.7 steps/s
[Step=36550 Epoch=178.2] | Loss=0.01428 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=12.552 | 4187.5 samples/s | 65.4 steps/s
[Step=36600 Epoch=178.5] | Loss=0.01434 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.991 | L2-Norm(final)=12.557 | 4553.7 samples/s | 71.2 steps/s
[Step=36650 Epoch=178.7] | Loss=0.01374 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.001 | L2-Norm(final)=12.562 | 4774.1 samples/s | 74.6 steps/s
[Step=36700 Epoch=179.0] | Loss=0.01343 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.011 | L2-Norm(final)=12.566 | 6128.7 samples/s | 95.8 steps/s
[Step=36750 Epoch=179.2] | Loss=0.01193 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.019 | L2-Norm(final)=12.570 | 1742.8 samples/s | 27.2 steps/s
[Step=36800 Epoch=179.5] | Loss=0.01083 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.026 | L2-Norm(final)=12.574 | 4421.2 samples/s | 69.1 steps/s
[Step=36850 Epoch=179.7] | Loss=0.01023 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.033 | L2-Norm(final)=12.579 | 4552.5 samples/s | 71.1 steps/s
[Step=36900 Epoch=179.9] | Loss=0.01004 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.039 | L2-Norm(final)=12.583 | 5689.6 samples/s | 88.9 steps/s
[Step=36950 Epoch=180.2] | Loss=0.00934 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.045 | L2-Norm(final)=12.586 | 1792.8 samples/s | 28.0 steps/s
[Step=37000 Epoch=180.4] | Loss=0.00894 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.051 | L2-Norm(final)=12.590 | 4683.0 samples/s | 73.2 steps/s
[Step=37050 Epoch=180.7] | Loss=0.00853 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.056 | L2-Norm(final)=12.593 | 4654.0 samples/s | 72.7 steps/s
[Step=37100 Epoch=180.9] | Loss=0.00816 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.061 | L2-Norm(final)=12.597 | 5248.1 samples/s | 82.0 steps/s
[Step=37150 Epoch=181.2] | Loss=0.00769 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.065 | L2-Norm(final)=12.601 | 1827.5 samples/s | 28.6 steps/s
[Step=37200 Epoch=181.4] | Loss=0.00732 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.070 | L2-Norm(final)=12.604 | 4573.4 samples/s | 71.5 steps/s
[Step=37250 Epoch=181.7] | Loss=0.00705 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.074 | L2-Norm(final)=12.608 | 4722.5 samples/s | 73.8 steps/s
[Step=37300 Epoch=181.9] | Loss=0.00686 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.078 | L2-Norm(final)=12.611 | 5031.7 samples/s | 78.6 steps/s
[Step=37350 Epoch=182.1] | Loss=0.00664 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.082 | L2-Norm(final)=12.614 | 1879.1 samples/s | 29.4 steps/s
[Step=37400 Epoch=182.4] | Loss=0.00639 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.086 | L2-Norm(final)=12.617 | 4552.2 samples/s | 71.1 steps/s
[Step=37450 Epoch=182.6] | Loss=0.00626 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.089 | L2-Norm(final)=12.620 | 4595.8 samples/s | 71.8 steps/s
[Step=37500 Epoch=182.9] | Loss=0.00612 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.092 | L2-Norm(final)=12.623 | 4771.3 samples/s | 74.6 steps/s
[Step=37550 Epoch=183.1] | Loss=0.00600 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.096 | L2-Norm(final)=12.626 | 1903.2 samples/s | 29.7 steps/s
[Step=37600 Epoch=183.4] | Loss=0.00584 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.099 | L2-Norm(final)=12.629 | 4843.9 samples/s | 75.7 steps/s
[Step=37650 Epoch=183.6] | Loss=0.00570 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.102 | L2-Norm(final)=12.632 | 4621.8 samples/s | 72.2 steps/s
[Step=37700 Epoch=183.8] | Loss=0.00555 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.105 | L2-Norm(final)=12.634 | 4540.3 samples/s | 70.9 steps/s
[Step=37750 Epoch=184.1] | Loss=0.00547 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.108 | L2-Norm(final)=12.637 | 1946.9 samples/s | 30.4 steps/s
[Step=37800 Epoch=184.3] | Loss=0.00540 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.111 | L2-Norm(final)=12.640 | 4643.4 samples/s | 72.6 steps/s
[Step=37850 Epoch=184.6] | Loss=0.00531 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.114 | L2-Norm(final)=12.642 | 4555.3 samples/s | 71.2 steps/s
[Step=37900 Epoch=184.8] | Loss=0.00527 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.116 | L2-Norm(final)=12.645 | 4518.2 samples/s | 70.6 steps/s
[Step=37950 Epoch=185.1] | Loss=0.00515 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.119 | L2-Norm(final)=12.647 | 1942.2 samples/s | 30.3 steps/s
[Step=38000 Epoch=185.3] | Loss=0.00504 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.122 | L2-Norm(final)=12.650 | 4550.5 samples/s | 71.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step38000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=42001 Epoch=206.0] | Loss=0.00578 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.795 | L2-Norm(final)=12.969 | 3759.4 samples/s | 58.7 steps/s
[Step=42050 Epoch=206.2] | Loss=0.01923 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=12.965 | 4970.8 samples/s | 77.7 steps/s
[Step=42100 Epoch=206.5] | Loss=0.01697 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.817 | L2-Norm(final)=12.965 | 5335.8 samples/s | 83.4 steps/s
[Step=42150 Epoch=206.7] | Loss=0.01578 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.825 | L2-Norm(final)=12.968 | 5366.8 samples/s | 83.9 steps/s
[Step=42200 Epoch=206.9] | Loss=0.01569 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.833 | L2-Norm(final)=12.972 | 7295.4 samples/s | 114.0 steps/s
[Step=42250 Epoch=207.2] | Loss=0.01456 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.841 | L2-Norm(final)=12.976 | 1694.6 samples/s | 26.5 steps/s
[Step=42300 Epoch=207.4] | Loss=0.01431 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.848 | L2-Norm(final)=12.980 | 5019.6 samples/s | 78.4 steps/s
[Step=42350 Epoch=207.7] | Loss=0.01397 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.856 | L2-Norm(final)=12.985 | 5078.2 samples/s | 79.3 steps/s
[Step=42400 Epoch=207.9] | Loss=0.01339 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.863 | L2-Norm(final)=12.990 | 6990.5 samples/s | 109.2 steps/s
[Step=42450 Epoch=208.2] | Loss=0.01273 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.870 | L2-Norm(final)=12.995 | 1798.4 samples/s | 28.1 steps/s
[Step=42500 Epoch=208.4] | Loss=0.01245 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.877 | L2-Norm(final)=13.001 | 5251.5 samples/s | 82.1 steps/s
All layers training...
LR=0.00013, len=1
[Step=42501 Epoch=208.4] | Loss=0.00772 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.949 | L2-Norm(final)=13.059 | 3841.5 samples/s | 60.0 steps/s
[Step=42550 Epoch=208.7] | Loss=0.01274 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.960 | L2-Norm(final)=13.065 | 4195.1 samples/s | 65.5 steps/s
[Step=42600 Epoch=208.9] | Loss=0.01250 | Reg=0.00099 | acc=0.9688 | L2-Norm=9.970 | L2-Norm(final)=13.070 | 4580.1 samples/s | 71.6 steps/s
[Step=42650 Epoch=209.1] | Loss=0.01230 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=13.075 | 4569.4 samples/s | 71.4 steps/s
[Step=42700 Epoch=209.4] | Loss=0.01193 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.988 | L2-Norm(final)=13.079 | 6217.3 samples/s | 97.1 steps/s
[Step=42750 Epoch=209.6] | Loss=0.01114 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.996 | L2-Norm(final)=13.083 | 1697.4 samples/s | 26.5 steps/s
[Step=42800 Epoch=209.9] | Loss=0.01038 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.003 | L2-Norm(final)=13.087 | 4405.8 samples/s | 68.8 steps/s
[Step=42850 Epoch=210.1] | Loss=0.00969 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.010 | L2-Norm(final)=13.091 | 4258.4 samples/s | 66.5 steps/s
[Step=42900 Epoch=210.4] | Loss=0.00910 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.016 | L2-Norm(final)=13.094 | 5984.3 samples/s | 93.5 steps/s
[Step=42950 Epoch=210.6] | Loss=0.00847 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.021 | L2-Norm(final)=13.098 | 1773.1 samples/s | 27.7 steps/s
[Step=43000 Epoch=210.9] | Loss=0.00801 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.026 | L2-Norm(final)=13.102 | 4473.5 samples/s | 69.9 steps/s
[Step=43050 Epoch=211.1] | Loss=0.00770 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.031 | L2-Norm(final)=13.105 | 4663.5 samples/s | 72.9 steps/s
[Step=43100 Epoch=211.4] | Loss=0.00737 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.035 | L2-Norm(final)=13.108 | 5721.1 samples/s | 89.4 steps/s
[Step=43150 Epoch=211.6] | Loss=0.00713 | Reg=0.00101 | acc=0.9844 | L2-Norm=10.039 | L2-Norm(final)=13.112 | 1791.7 samples/s | 28.0 steps/s
[Step=43200 Epoch=211.8] | Loss=0.00681 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.043 | L2-Norm(final)=13.115 | 4655.1 samples/s | 72.7 steps/s
[Step=43250 Epoch=212.1] | Loss=0.00659 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.047 | L2-Norm(final)=13.118 | 4560.5 samples/s | 71.3 steps/s
[Step=43300 Epoch=212.3] | Loss=0.00643 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.050 | L2-Norm(final)=13.120 | 5343.8 samples/s | 83.5 steps/s
[Step=43350 Epoch=212.6] | Loss=0.00625 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.053 | L2-Norm(final)=13.123 | 1795.2 samples/s | 28.1 steps/s
[Step=43400 Epoch=212.8] | Loss=0.00608 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.056 | L2-Norm(final)=13.126 | 4567.1 samples/s | 71.4 steps/s
[Step=43450 Epoch=213.1] | Loss=0.00587 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.059 | L2-Norm(final)=13.128 | 4541.7 samples/s | 71.0 steps/s
[Step=43500 Epoch=213.3] | Loss=0.00569 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.062 | L2-Norm(final)=13.131 | 5151.0 samples/s | 80.5 steps/s
[Step=43550 Epoch=213.6] | Loss=0.00562 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.065 | L2-Norm(final)=13.133 | 1866.1 samples/s | 29.2 steps/s
[Step=43600 Epoch=213.8] | Loss=0.00547 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.068 | L2-Norm(final)=13.136 | 4605.4 samples/s | 72.0 steps/s
[Step=43650 Epoch=214.1] | Loss=0.00536 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.071 | L2-Norm(final)=13.138 | 4527.4 samples/s | 70.7 steps/s
[Step=43700 Epoch=214.3] | Loss=0.00531 | Reg=0.00101 | acc=1.0000 | L2-Norm=10.073 | L2-Norm(final)=13.141 | 4983.3 samples/s | 77.9 steps/s
[Step=43750 Epoch=214.5] | Loss=0.00524 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.076 | L2-Norm(final)=13.143 | 1869.4 samples/s | 29.2 steps/s
[Step=43800 Epoch=214.8] | Loss=0.00509 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.078 | L2-Norm(final)=13.145 | 4544.3 samples/s | 71.0 steps/s
[Step=43850 Epoch=215.0] | Loss=0.00501 | Reg=0.00102 | acc=0.9844 | L2-Norm=10.081 | L2-Norm(final)=13.147 | 4359.9 samples/s | 68.1 steps/s
[Step=43900 Epoch=215.3] | Loss=0.00497 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.083 | L2-Norm(final)=13.150 | 4786.5 samples/s | 74.8 steps/s
[Step=43950 Epoch=215.5] | Loss=0.00490 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.085 | L2-Norm(final)=13.152 | 1913.9 samples/s | 29.9 steps/s
[Step=44000 Epoch=215.8] | Loss=0.00480 | Reg=0.00102 | acc=1.0000 | L2-Norm=10.088 | L2-Norm(final)=13.154 | 4613.8 samples/s | 72.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step44000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=38001 Epoch=361.5] | Loss=0.01778 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.795 | L2-Norm(final)=9.179 | 3537.7 samples/s | 55.3 steps/s
[Step=38050 Epoch=362.0] | Loss=0.00289 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.814 | L2-Norm(final)=9.179 | 4684.3 samples/s | 73.2 steps/s
[Step=38100 Epoch=362.4] | Loss=0.00168 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.840 | L2-Norm(final)=9.185 | 6837.1 samples/s | 106.8 steps/s
[Step=38150 Epoch=362.9] | Loss=0.00120 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.851 | L2-Norm(final)=9.191 | 1752.6 samples/s | 27.4 steps/s
[Step=38200 Epoch=363.4] | Loss=0.00093 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.857 | L2-Norm(final)=9.196 | 6384.7 samples/s | 99.8 steps/s
[Step=38250 Epoch=363.9] | Loss=0.00077 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.860 | L2-Norm(final)=9.200 | 1711.8 samples/s | 26.7 steps/s
[Step=38300 Epoch=364.3] | Loss=0.00066 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.862 | L2-Norm(final)=9.204 | 5614.2 samples/s | 87.7 steps/s
[Step=38350 Epoch=364.8] | Loss=0.00058 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.863 | L2-Norm(final)=9.207 | 1830.2 samples/s | 28.6 steps/s
[Step=38400 Epoch=365.3] | Loss=0.00052 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.864 | L2-Norm(final)=9.210 | 5524.9 samples/s | 86.3 steps/s
[Step=38450 Epoch=365.8] | Loss=0.00047 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.864 | L2-Norm(final)=9.213 | 1910.0 samples/s | 29.8 steps/s
[Step=38500 Epoch=366.2] | Loss=0.00043 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.864 | L2-Norm(final)=9.216 | 4906.7 samples/s | 76.7 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=366.2] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.862 | L2-Norm(final)=9.245 | 3714.8 samples/s | 58.0 steps/s
[Step=38550 Epoch=366.7] | Loss=0.00015 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.859 | L2-Norm(final)=9.248 | 4131.7 samples/s | 64.6 steps/s
[Step=38600 Epoch=367.2] | Loss=0.00011 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.861 | L2-Norm(final)=9.251 | 6040.0 samples/s | 94.4 steps/s
[Step=38650 Epoch=367.7] | Loss=0.00008 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.859 | L2-Norm(final)=9.252 | 1685.6 samples/s | 26.3 steps/s
[Step=38700 Epoch=368.1] | Loss=0.00006 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.855 | L2-Norm(final)=9.253 | 5426.9 samples/s | 84.8 steps/s
[Step=38750 Epoch=368.6] | Loss=0.00005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.850 | L2-Norm(final)=9.254 | 1734.8 samples/s | 27.1 steps/s
[Step=38800 Epoch=369.1] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.844 | L2-Norm(final)=9.255 | 5019.2 samples/s | 78.4 steps/s
[Step=38850 Epoch=369.6] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.838 | L2-Norm(final)=9.255 | 1767.6 samples/s | 27.6 steps/s
[Step=38900 Epoch=370.0] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.831 | L2-Norm(final)=9.256 | 4672.5 samples/s | 73.0 steps/s
[Step=38950 Epoch=370.5] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.824 | L2-Norm(final)=9.256 | 1823.8 samples/s | 28.5 steps/s
[Step=39000 Epoch=371.0] | Loss=0.00003 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.817 | L2-Norm(final)=9.257 | 4484.5 samples/s | 70.1 steps/s
[Step=39050 Epoch=371.5] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.809 | L2-Norm(final)=9.257 | 1837.1 samples/s | 28.7 steps/s
[Step=39100 Epoch=371.9] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.802 | L2-Norm(final)=9.257 | 4347.8 samples/s | 67.9 steps/s
[Step=39150 Epoch=372.4] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.794 | L2-Norm(final)=9.257 | 1880.7 samples/s | 29.4 steps/s
[Step=39200 Epoch=372.9] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.786 | L2-Norm(final)=9.258 | 4346.2 samples/s | 67.9 steps/s
[Step=39250 Epoch=373.4] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.778 | L2-Norm(final)=9.258 | 1886.8 samples/s | 29.5 steps/s
[Step=39300 Epoch=373.8] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.770 | L2-Norm(final)=9.258 | 4348.4 samples/s | 67.9 steps/s
[Step=39350 Epoch=374.3] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.761 | L2-Norm(final)=9.258 | 1886.8 samples/s | 29.5 steps/s
[Step=39400 Epoch=374.8] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.753 | L2-Norm(final)=9.259 | 4340.7 samples/s | 67.8 steps/s
[Step=39450 Epoch=375.3] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.745 | L2-Norm(final)=9.259 | 5918.6 samples/s | 92.5 steps/s
[Step=39500 Epoch=375.7] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.736 | L2-Norm(final)=9.259 | 1683.9 samples/s | 26.3 steps/s
[Step=39550 Epoch=376.2] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.727 | L2-Norm(final)=9.259 | 5634.8 samples/s | 88.0 steps/s
[Step=39600 Epoch=376.7] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.718 | L2-Norm(final)=9.260 | 1701.0 samples/s | 26.6 steps/s
[Step=39650 Epoch=377.2] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.709 | L2-Norm(final)=9.260 | 5255.8 samples/s | 82.1 steps/s
[Step=39700 Epoch=377.6] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.700 | L2-Norm(final)=9.260 | 1747.5 samples/s | 27.3 steps/s
[Step=39750 Epoch=378.1] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.691 | L2-Norm(final)=9.260 | 4851.8 samples/s | 75.8 steps/s
[Step=39800 Epoch=378.6] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.681 | L2-Norm(final)=9.260 | 1816.8 samples/s | 28.4 steps/s
[Step=39850 Epoch=379.1] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.671 | L2-Norm(final)=9.261 | 4562.8 samples/s | 71.3 steps/s
[Step=39900 Epoch=379.5] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.662 | L2-Norm(final)=9.261 | 1801.4 samples/s | 28.1 steps/s
[Step=39950 Epoch=380.0] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.652 | L2-Norm(final)=9.261 | 4320.7 samples/s | 67.5 steps/s
[Step=40000 Epoch=380.5] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.642 | L2-Norm(final)=9.261 | 1829.7 samples/s | 28.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step40000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=40001 Epoch=381.2] | Loss=0.00227 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.795 | L2-Norm(final)=9.590 | 3737.0 samples/s | 58.4 steps/s
[Step=40050 Epoch=381.7] | Loss=0.00393 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.830 | L2-Norm(final)=9.587 | 4422.2 samples/s | 69.1 steps/s
[Step=40100 Epoch=382.2] | Loss=0.00228 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.846 | L2-Norm(final)=9.590 | 7012.9 samples/s | 109.6 steps/s
[Step=40150 Epoch=382.7] | Loss=0.00158 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.853 | L2-Norm(final)=9.593 | 1723.0 samples/s | 26.9 steps/s
[Step=40200 Epoch=383.1] | Loss=0.00124 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.856 | L2-Norm(final)=9.596 | 6607.9 samples/s | 103.2 steps/s
[Step=40250 Epoch=383.6] | Loss=0.00102 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.858 | L2-Norm(final)=9.599 | 1748.2 samples/s | 27.3 steps/s
[Step=40300 Epoch=384.1] | Loss=0.00087 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.860 | L2-Norm(final)=9.602 | 5801.5 samples/s | 90.6 steps/s
[Step=40350 Epoch=384.6] | Loss=0.00077 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.861 | L2-Norm(final)=9.605 | 1796.5 samples/s | 28.1 steps/s
[Step=40400 Epoch=385.0] | Loss=0.00068 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.861 | L2-Norm(final)=9.608 | 5706.9 samples/s | 89.2 steps/s
[Step=40450 Epoch=385.5] | Loss=0.00062 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.862 | L2-Norm(final)=9.610 | 1869.9 samples/s | 29.2 steps/s
[Step=40500 Epoch=386.0] | Loss=0.00057 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.862 | L2-Norm(final)=9.613 | 5238.6 samples/s | 81.9 steps/s
All layers training...
LR=0.00013, len=1
[Step=40501 Epoch=386.0] | Loss=0.00018 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.863 | L2-Norm(final)=9.638 | 3580.6 samples/s | 55.9 steps/s
[Step=40550 Epoch=386.5] | Loss=0.00006 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.860 | L2-Norm(final)=9.639 | 4003.7 samples/s | 62.6 steps/s
[Step=40600 Epoch=387.0] | Loss=0.00005 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.857 | L2-Norm(final)=9.640 | 5880.8 samples/s | 91.9 steps/s
[Step=40650 Epoch=387.4] | Loss=0.00004 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.853 | L2-Norm(final)=9.641 | 1681.1 samples/s | 26.3 steps/s
[Step=40700 Epoch=387.9] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.848 | L2-Norm(final)=9.642 | 5560.6 samples/s | 86.9 steps/s
[Step=40750 Epoch=388.4] | Loss=0.00003 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.842 | L2-Norm(final)=9.643 | 1714.3 samples/s | 26.8 steps/s
[Step=40800 Epoch=388.9] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.836 | L2-Norm(final)=9.643 | 5309.7 samples/s | 83.0 steps/s
[Step=40850 Epoch=389.3] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.830 | L2-Norm(final)=9.644 | 1738.7 samples/s | 27.2 steps/s
[Step=40900 Epoch=389.8] | Loss=0.00002 | Reg=0.00097 | acc=1.0000 | L2-Norm=9.824 | L2-Norm(final)=9.644 | 4838.2 samples/s | 75.6 steps/s
[Step=40950 Epoch=390.3] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.818 | L2-Norm(final)=9.644 | 1767.7 samples/s | 27.6 steps/s
[Step=41000 Epoch=390.8] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.811 | L2-Norm(final)=9.645 | 4713.6 samples/s | 73.6 steps/s
[Step=41050 Epoch=391.2] | Loss=0.00002 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.804 | L2-Norm(final)=9.645 | 1843.3 samples/s | 28.8 steps/s
[Step=41100 Epoch=391.7] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.797 | L2-Norm(final)=9.645 | 4415.6 samples/s | 69.0 steps/s
[Step=41150 Epoch=392.2] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.790 | L2-Norm(final)=9.645 | 1832.0 samples/s | 28.6 steps/s
[Step=41200 Epoch=392.7] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.783 | L2-Norm(final)=9.646 | 4583.8 samples/s | 71.6 steps/s
[Step=41250 Epoch=393.1] | Loss=0.00001 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.776 | L2-Norm(final)=9.646 | 1877.8 samples/s | 29.3 steps/s
[Step=41300 Epoch=393.6] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.769 | L2-Norm(final)=9.646 | 4327.8 samples/s | 67.6 steps/s
[Step=41350 Epoch=394.1] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.761 | L2-Norm(final)=9.646 | 1866.1 samples/s | 29.2 steps/s
[Step=41400 Epoch=394.6] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.753 | L2-Norm(final)=9.647 | 4423.9 samples/s | 69.1 steps/s
[Step=41450 Epoch=395.1] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.746 | L2-Norm(final)=9.647 | 1861.6 samples/s | 29.1 steps/s
[Step=41500 Epoch=395.5] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.738 | L2-Norm(final)=9.647 | 4332.4 samples/s | 67.7 steps/s
[Step=41550 Epoch=396.0] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.730 | L2-Norm(final)=9.647 | 6414.6 samples/s | 100.2 steps/s
[Step=41600 Epoch=396.5] | Loss=0.00001 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.722 | L2-Norm(final)=9.647 | 1646.8 samples/s | 25.7 steps/s
[Step=41650 Epoch=397.0] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.713 | L2-Norm(final)=9.648 | 5898.0 samples/s | 92.2 steps/s
[Step=41700 Epoch=397.4] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.705 | L2-Norm(final)=9.648 | 1656.6 samples/s | 25.9 steps/s
[Step=41750 Epoch=397.9] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.696 | L2-Norm(final)=9.648 | 5559.6 samples/s | 86.9 steps/s
[Step=41800 Epoch=398.4] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.688 | L2-Norm(final)=9.648 | 1732.3 samples/s | 27.1 steps/s
[Step=41850 Epoch=398.9] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.679 | L2-Norm(final)=9.648 | 5184.6 samples/s | 81.0 steps/s
[Step=41900 Epoch=399.3] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.670 | L2-Norm(final)=9.649 | 1735.0 samples/s | 27.1 steps/s
[Step=41950 Epoch=399.8] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.661 | L2-Norm(final)=9.649 | 4673.9 samples/s | 73.0 steps/s
[Step=42000 Epoch=400.3] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.652 | L2-Norm(final)=9.649 | 1718.6 samples/s | 26.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step42000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.08073 | acc=0.9640 | tpr=0.9736 | fpr=0.0570 | 4127.5 samples/s | 16.1 steps/s
Avg test loss: 0.08348, Avg test acc: 0.96222, Avg tpr: 0.97191, Avg fpr: 0.05909, total FA: 461

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.09215 | acc=0.9619 | tpr=0.9808 | fpr=0.0793 | 4062.4 samples/s | 15.9 steps/s
Avg test loss: 0.09601, Avg test acc: 0.95993, Avg tpr: 0.97972, Avg fpr: 0.08358, total FA: 652

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08730 | acc=0.9607 | tpr=0.9724 | fpr=0.0647 | 4089.0 samples/s | 16.0 steps/s
Avg test loss: 0.09255, Avg test acc: 0.95925, Avg tpr: 0.97027, Avg fpr: 0.06499, total FA: 507

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08320 | acc=0.9605 | tpr=0.9708 | fpr=0.0617 | 3258.5 samples/s | 12.7 steps/s
Avg test loss: 0.08696, Avg test acc: 0.96049, Avg tpr: 0.97074, Avg fpr: 0.06204, total FA: 484

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08763 | acc=0.9623 | tpr=0.9715 | fpr=0.0577 | 2960.8 samples/s | 11.6 steps/s
Avg test loss: 0.09553, Avg test acc: 0.96049, Avg tpr: 0.97027, Avg fpr: 0.06102, total FA: 476

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.21816 | acc=0.2950 | tpr=0.0027 | fpr=0.0704 | 2942.9 samples/s | 11.5 steps/s
Avg test loss: 5.23691, Avg test acc: 0.29313, Avg tpr: 0.00356, Avg fpr: 0.06999, total FA: 546

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.02254 | acc=0.3140 | tpr=0.0037 | fpr=0.0121 | 2997.2 samples/s | 11.7 steps/s
Avg test loss: 5.03125, Avg test acc: 0.31120, Avg tpr: 0.00408, Avg fpr: 0.01333, total FA: 104

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.98579 | acc=0.2997 | tpr=0.0068 | fpr=0.0644 | 3023.2 samples/s | 11.8 steps/s
Avg test loss: 4.99558, Avg test acc: 0.29746, Avg tpr: 0.00758, Avg fpr: 0.06499, total FA: 507

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.39094 | acc=0.3023 | tpr=0.0046 | fpr=0.0510 | 4129.0 samples/s | 16.1 steps/s
Avg test loss: 5.40477, Avg test acc: 0.29902, Avg tpr: 0.00513, Avg fpr: 0.05461, total FA: 426

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.05652 | acc=0.3134 | tpr=0.0022 | fpr=0.0109 | 4131.9 samples/s | 16.1 steps/s
Avg test loss: 5.06487, Avg test acc: 0.31072, Avg tpr: 0.00280, Avg fpr: 0.01205, total FA: 94

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=5.30217 | acc=0.1244 | tpr=0.8009 | fpr=0.8878 | 4113.7 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.25148 | acc=0.1262 | tpr=0.7719 | fpr=0.8858 | 8365.3 samples/s | 32.7 steps/s
[Step= 150] | Loss=5.25117 | acc=0.1249 | tpr=0.7839 | fpr=0.8872 | 7760.1 samples/s | 30.3 steps/s
[Step= 200] | Loss=5.24918 | acc=0.1246 | tpr=0.7858 | fpr=0.8875 | 8005.5 samples/s | 31.3 steps/s
[Step= 250] | Loss=5.25282 | acc=0.1257 | tpr=0.7886 | fpr=0.8864 | 7573.6 samples/s | 29.6 steps/s
[Step= 300] | Loss=5.24770 | acc=0.1254 | tpr=0.7869 | fpr=0.8867 | 7438.9 samples/s | 29.1 steps/s
[Step= 350] | Loss=5.24418 | acc=0.1247 | tpr=0.7808 | fpr=0.8872 | 7545.1 samples/s | 29.5 steps/s
[Step= 400] | Loss=5.24688 | acc=0.1248 | tpr=0.7763 | fpr=0.8870 | 8044.3 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.24912 | acc=0.1245 | tpr=0.7707 | fpr=0.8872 | 8248.9 samples/s | 32.2 steps/s
[Step= 500] | Loss=5.25196 | acc=0.1245 | tpr=0.7722 | fpr=0.8872 | 7617.2 samples/s | 29.8 steps/s
[Step= 550] | Loss=5.25093 | acc=0.1244 | tpr=0.7768 | fpr=0.8875 | 13717.7 samples/s | 53.6 steps/s
Avg test loss: 5.25280, Avg test acc: 0.12434, Avg tpr: 0.77615, Avg fpr: 0.88751, total FA: 123229

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=5.26291 | acc=0.1188 | tpr=0.8584 | fpr=0.8945 | 3980.3 samples/s | 15.5 steps/s
[Step= 100] | Loss=5.20862 | acc=0.1212 | tpr=0.8571 | fpr=0.8925 | 7914.2 samples/s | 30.9 steps/s
[Step= 150] | Loss=5.21255 | acc=0.1187 | tpr=0.8631 | fpr=0.8950 | 8009.7 samples/s | 31.3 steps/s
[Step= 200] | Loss=5.21321 | acc=0.1187 | tpr=0.8623 | fpr=0.8948 | 8250.4 samples/s | 32.2 steps/s
[Step= 250] | Loss=5.21357 | acc=0.1192 | tpr=0.8603 | fpr=0.8943 | 7922.6 samples/s | 30.9 steps/s
[Step= 300] | Loss=5.21079 | acc=0.1186 | tpr=0.8604 | fpr=0.8949 | 7939.1 samples/s | 31.0 steps/s
[Step= 350] | Loss=5.20551 | acc=0.1179 | tpr=0.8585 | fpr=0.8955 | 7870.7 samples/s | 30.7 steps/s
[Step= 400] | Loss=5.20664 | acc=0.1179 | tpr=0.8534 | fpr=0.8955 | 8229.4 samples/s | 32.1 steps/s
[Step= 450] | Loss=5.21198 | acc=0.1176 | tpr=0.8491 | fpr=0.8956 | 8071.7 samples/s | 31.5 steps/s
[Step= 500] | Loss=5.21806 | acc=0.1173 | tpr=0.8507 | fpr=0.8959 | 7854.2 samples/s | 30.7 steps/s
[Step= 550] | Loss=5.21617 | acc=0.1174 | tpr=0.8528 | fpr=0.8960 | 15050.9 samples/s | 58.8 steps/s
Avg test loss: 5.21734, Avg test acc: 0.11736, Avg tpr: 0.85222, Avg fpr: 0.89600, total FA: 124408

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.70046 | acc=0.1200 | tpr=0.8186 | fpr=0.8926 | 3989.3 samples/s | 15.6 steps/s
[Step= 100] | Loss=5.64790 | acc=0.1228 | tpr=0.8166 | fpr=0.8901 | 7754.8 samples/s | 30.3 steps/s
[Step= 150] | Loss=5.65111 | acc=0.1205 | tpr=0.8329 | fpr=0.8926 | 8264.2 samples/s | 32.3 steps/s
[Step= 200] | Loss=5.65140 | acc=0.1197 | tpr=0.8339 | fpr=0.8933 | 8112.6 samples/s | 31.7 steps/s
[Step= 250] | Loss=5.65175 | acc=0.1200 | tpr=0.8349 | fpr=0.8931 | 8229.2 samples/s | 32.1 steps/s
[Step= 300] | Loss=5.64785 | acc=0.1199 | tpr=0.8385 | fpr=0.8932 | 8065.6 samples/s | 31.5 steps/s
[Step= 350] | Loss=5.64560 | acc=0.1197 | tpr=0.8384 | fpr=0.8933 | 7778.4 samples/s | 30.4 steps/s
[Step= 400] | Loss=5.64839 | acc=0.1198 | tpr=0.8370 | fpr=0.8932 | 7977.4 samples/s | 31.2 steps/s
[Step= 450] | Loss=5.65288 | acc=0.1192 | tpr=0.8335 | fpr=0.8937 | 8236.9 samples/s | 32.2 steps/s
[Step= 500] | Loss=5.65348 | acc=0.1193 | tpr=0.8344 | fpr=0.8936 | 7830.0 samples/s | 30.6 steps/s
[Step= 550] | Loss=5.65280 | acc=0.1190 | tpr=0.8372 | fpr=0.8940 | 13939.7 samples/s | 54.5 steps/s
Avg test loss: 5.65449, Avg test acc: 0.11899, Avg tpr: 0.83677, Avg fpr: 0.89406, total FA: 124138

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.99105 | acc=0.1402 | tpr=0.7345 | fpr=0.8705 | 4042.4 samples/s | 15.8 steps/s
[Step= 100] | Loss=4.94101 | acc=0.1409 | tpr=0.7143 | fpr=0.8698 | 8102.8 samples/s | 31.7 steps/s
[Step= 150] | Loss=4.93536 | acc=0.1399 | tpr=0.7406 | fpr=0.8712 | 8324.8 samples/s | 32.5 steps/s
[Step= 200] | Loss=4.93152 | acc=0.1398 | tpr=0.7410 | fpr=0.8712 | 7539.6 samples/s | 29.5 steps/s
[Step= 250] | Loss=4.93387 | acc=0.1403 | tpr=0.7441 | fpr=0.8707 | 7642.5 samples/s | 29.9 steps/s
[Step= 300] | Loss=4.93029 | acc=0.1395 | tpr=0.7469 | fpr=0.8716 | 8101.7 samples/s | 31.6 steps/s
[Step= 350] | Loss=4.92462 | acc=0.1393 | tpr=0.7451 | fpr=0.8717 | 7857.1 samples/s | 30.7 steps/s
[Step= 400] | Loss=4.92825 | acc=0.1390 | tpr=0.7445 | fpr=0.8720 | 7842.4 samples/s | 30.6 steps/s
[Step= 450] | Loss=4.93359 | acc=0.1385 | tpr=0.7395 | fpr=0.8724 | 8581.5 samples/s | 33.5 steps/s
[Step= 500] | Loss=4.93654 | acc=0.1383 | tpr=0.7414 | fpr=0.8726 | 7278.0 samples/s | 28.4 steps/s
[Step= 550] | Loss=4.93439 | acc=0.1383 | tpr=0.7473 | fpr=0.8727 | 14631.5 samples/s | 57.2 steps/s
Avg test loss: 4.93614, Avg test acc: 0.13827, Avg tpr: 0.74683, Avg fpr: 0.87279, total FA: 121185

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.18044 | acc=0.1291 | tpr=0.6947 | fpr=0.8810 | 4124.2 samples/s | 16.1 steps/s
[Step= 100] | Loss=5.12766 | acc=0.1333 | tpr=0.6823 | fpr=0.8770 | 7090.5 samples/s | 27.7 steps/s
[Step= 150] | Loss=5.12874 | acc=0.1316 | tpr=0.6859 | fpr=0.8786 | 7721.8 samples/s | 30.2 steps/s
[Step= 200] | Loss=5.12729 | acc=0.1311 | tpr=0.6831 | fpr=0.8790 | 7828.2 samples/s | 30.6 steps/s
[Step= 250] | Loss=5.13170 | acc=0.1315 | tpr=0.6821 | fpr=0.8785 | 8317.2 samples/s | 32.5 steps/s
[Step= 300] | Loss=5.12758 | acc=0.1313 | tpr=0.6873 | fpr=0.8788 | 7887.9 samples/s | 30.8 steps/s
[Step= 350] | Loss=5.12372 | acc=0.1306 | tpr=0.6844 | fpr=0.8794 | 7892.9 samples/s | 30.8 steps/s
[Step= 400] | Loss=5.12685 | acc=0.1306 | tpr=0.6838 | fpr=0.8795 | 8044.7 samples/s | 31.4 steps/s
[Step= 450] | Loss=5.13014 | acc=0.1300 | tpr=0.6796 | fpr=0.8800 | 7884.0 samples/s | 30.8 steps/s
[Step= 500] | Loss=5.13231 | acc=0.1297 | tpr=0.6758 | fpr=0.8802 | 7812.2 samples/s | 30.5 steps/s
[Step= 550] | Loss=5.13173 | acc=0.1293 | tpr=0.6749 | fpr=0.8807 | 14563.5 samples/s | 56.9 steps/s
Avg test loss: 5.13408, Avg test acc: 0.12921, Avg tpr: 0.67472, Avg fpr: 0.88070, total FA: 122284

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10762 | acc=0.9812 | tpr=0.9425 | fpr=0.0181 | 4081.3 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.11204 | acc=0.9803 | tpr=0.9552 | fpr=0.0192 | 7604.0 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.11642 | acc=0.9793 | tpr=0.9524 | fpr=0.0202 | 7812.2 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.11869 | acc=0.9793 | tpr=0.9563 | fpr=0.0203 | 8733.5 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.11801 | acc=0.9792 | tpr=0.9493 | fpr=0.0203 | 7747.2 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.12037 | acc=0.9788 | tpr=0.9469 | fpr=0.0206 | 7822.3 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.12031 | acc=0.9786 | tpr=0.9461 | fpr=0.0208 | 8119.7 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.12137 | acc=0.9785 | tpr=0.9426 | fpr=0.0208 | 7659.1 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.12408 | acc=0.9782 | tpr=0.9421 | fpr=0.0211 | 7780.1 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.12384 | acc=0.9783 | tpr=0.9432 | fpr=0.0211 | 7807.2 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.12279 | acc=0.9785 | tpr=0.9431 | fpr=0.0209 | 14900.2 samples/s | 58.2 steps/s
Avg test loss: 0.12261, Avg test acc: 0.97850, Avg tpr: 0.94334, Avg fpr: 0.02086, total FA: 2897

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11362 | acc=0.9816 | tpr=0.9027 | fpr=0.0170 | 4061.3 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.11751 | acc=0.9813 | tpr=0.9083 | fpr=0.0173 | 8198.4 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.12236 | acc=0.9803 | tpr=0.9049 | fpr=0.0184 | 7828.6 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.12398 | acc=0.9805 | tpr=0.9148 | fpr=0.0183 | 6879.0 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.12278 | acc=0.9804 | tpr=0.9162 | fpr=0.0184 | 8049.2 samples/s | 31.4 steps/s
[Step= 300] | Loss=0.12523 | acc=0.9800 | tpr=0.9185 | fpr=0.0189 | 7692.1 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.12525 | acc=0.9798 | tpr=0.9217 | fpr=0.0191 | 8090.0 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.12644 | acc=0.9796 | tpr=0.9179 | fpr=0.0193 | 7959.4 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.12966 | acc=0.9793 | tpr=0.9192 | fpr=0.0196 | 7339.9 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.12909 | acc=0.9795 | tpr=0.9220 | fpr=0.0195 | 8081.7 samples/s | 31.6 steps/s
[Step= 550] | Loss=0.12822 | acc=0.9796 | tpr=0.9216 | fpr=0.0193 | 14669.9 samples/s | 57.3 steps/s
Avg test loss: 0.12796, Avg test acc: 0.97964, Avg tpr: 0.92155, Avg fpr: 0.01931, total FA: 2681

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11198 | acc=0.9791 | tpr=0.9381 | fpr=0.0201 | 4084.4 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.11594 | acc=0.9786 | tpr=0.9574 | fpr=0.0210 | 8112.5 samples/s | 31.7 steps/s
[Step= 150] | Loss=0.12016 | acc=0.9772 | tpr=0.9553 | fpr=0.0224 | 7541.9 samples/s | 29.5 steps/s
[Step= 200] | Loss=0.12206 | acc=0.9774 | tpr=0.9585 | fpr=0.0223 | 7618.1 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.12134 | acc=0.9772 | tpr=0.9546 | fpr=0.0224 | 7833.8 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.12379 | acc=0.9769 | tpr=0.9556 | fpr=0.0227 | 8378.6 samples/s | 32.7 steps/s
[Step= 350] | Loss=0.12379 | acc=0.9768 | tpr=0.9568 | fpr=0.0228 | 7963.3 samples/s | 31.1 steps/s
[Step= 400] | Loss=0.12506 | acc=0.9767 | tpr=0.9546 | fpr=0.0229 | 8293.1 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.12803 | acc=0.9765 | tpr=0.9537 | fpr=0.0231 | 7601.5 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.12776 | acc=0.9765 | tpr=0.9555 | fpr=0.0231 | 7912.0 samples/s | 30.9 steps/s
[Step= 550] | Loss=0.12664 | acc=0.9768 | tpr=0.9554 | fpr=0.0228 | 14628.9 samples/s | 57.1 steps/s
Avg test loss: 0.12649, Avg test acc: 0.97681, Avg tpr: 0.95563, Avg fpr: 0.02280, total FA: 3166

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.11241 | acc=0.9814 | tpr=0.9292 | fpr=0.0177 | 4169.1 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.11703 | acc=0.9804 | tpr=0.9446 | fpr=0.0189 | 8135.8 samples/s | 31.8 steps/s
[Step= 150] | Loss=0.12152 | acc=0.9798 | tpr=0.9467 | fpr=0.0196 | 7977.8 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.12378 | acc=0.9797 | tpr=0.9519 | fpr=0.0198 | 7212.8 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.12256 | acc=0.9795 | tpr=0.9450 | fpr=0.0199 | 7665.7 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.12451 | acc=0.9793 | tpr=0.9455 | fpr=0.0201 | 8236.6 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.12463 | acc=0.9790 | tpr=0.9474 | fpr=0.0204 | 8107.9 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.12555 | acc=0.9789 | tpr=0.9442 | fpr=0.0205 | 7638.7 samples/s | 29.8 steps/s
[Step= 450] | Loss=0.12865 | acc=0.9786 | tpr=0.9445 | fpr=0.0208 | 8468.2 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.12823 | acc=0.9787 | tpr=0.9458 | fpr=0.0207 | 7522.9 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.12729 | acc=0.9789 | tpr=0.9451 | fpr=0.0205 | 13966.0 samples/s | 54.6 steps/s
Avg test loss: 0.12710, Avg test acc: 0.97889, Avg tpr: 0.94493, Avg fpr: 0.02049, total FA: 2845

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12374 | acc=0.9803 | tpr=0.9248 | fpr=0.0187 | 4195.3 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.12858 | acc=0.9800 | tpr=0.9510 | fpr=0.0194 | 7862.0 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.13356 | acc=0.9791 | tpr=0.9524 | fpr=0.0204 | 8143.1 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.13585 | acc=0.9787 | tpr=0.9574 | fpr=0.0209 | 7922.7 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.13462 | acc=0.9788 | tpr=0.9528 | fpr=0.0207 | 7708.6 samples/s | 30.1 steps/s
[Step= 300] | Loss=0.13743 | acc=0.9784 | tpr=0.9542 | fpr=0.0211 | 7727.9 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.13810 | acc=0.9783 | tpr=0.9555 | fpr=0.0213 | 8104.1 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.13922 | acc=0.9781 | tpr=0.9508 | fpr=0.0214 | 7826.6 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.14248 | acc=0.9777 | tpr=0.9494 | fpr=0.0218 | 7917.0 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.14199 | acc=0.9778 | tpr=0.9498 | fpr=0.0217 | 8015.4 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.14118 | acc=0.9779 | tpr=0.9479 | fpr=0.0215 | 13386.8 samples/s | 52.3 steps/s
Avg test loss: 0.14094, Avg test acc: 0.97792, Avg tpr: 0.94770, Avg fpr: 0.02153, total FA: 2989

server round 39/50

clients selected: [0 1 4 7 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=36001 Epoch=175.5] | Loss=0.02393 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.720 | L2-Norm(final)=11.675 | 3879.3 samples/s | 60.6 steps/s
[Step=36050 Epoch=175.8] | Loss=0.02307 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.727 | L2-Norm(final)=11.672 | 4523.8 samples/s | 70.7 steps/s
[Step=36100 Epoch=176.0] | Loss=0.02242 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.735 | L2-Norm(final)=11.670 | 5091.6 samples/s | 79.6 steps/s
[Step=36150 Epoch=176.3] | Loss=0.02058 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.743 | L2-Norm(final)=11.671 | 5221.0 samples/s | 81.6 steps/s
[Step=36200 Epoch=176.5] | Loss=0.01946 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=11.673 | 7442.7 samples/s | 116.3 steps/s
[Step=36250 Epoch=176.8] | Loss=0.01843 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.757 | L2-Norm(final)=11.677 | 1797.8 samples/s | 28.1 steps/s
[Step=36300 Epoch=177.0] | Loss=0.01769 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.764 | L2-Norm(final)=11.681 | 5156.2 samples/s | 80.6 steps/s
[Step=36350 Epoch=177.2] | Loss=0.01743 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.771 | L2-Norm(final)=11.686 | 5276.7 samples/s | 82.4 steps/s
[Step=36400 Epoch=177.5] | Loss=0.01681 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.778 | L2-Norm(final)=11.690 | 6420.3 samples/s | 100.3 steps/s
[Step=36450 Epoch=177.7] | Loss=0.01633 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.784 | L2-Norm(final)=11.695 | 1831.4 samples/s | 28.6 steps/s
[Step=36500 Epoch=178.0] | Loss=0.01596 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.791 | L2-Norm(final)=11.701 | 4594.4 samples/s | 71.8 steps/s
All layers training...
LR=0.00013, len=1
[Step=36501 Epoch=178.0] | Loss=0.01379 | Reg=0.00097 | acc=0.9844 | L2-Norm=9.856 | L2-Norm(final)=11.757 | 3742.2 samples/s | 58.5 steps/s
[Step=36550 Epoch=178.2] | Loss=0.01087 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.866 | L2-Norm(final)=11.764 | 4247.4 samples/s | 66.4 steps/s
[Step=36600 Epoch=178.5] | Loss=0.01516 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.879 | L2-Norm(final)=11.770 | 4610.3 samples/s | 72.0 steps/s
[Step=36650 Epoch=178.7] | Loss=0.01547 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.890 | L2-Norm(final)=11.774 | 4527.0 samples/s | 70.7 steps/s
[Step=36700 Epoch=179.0] | Loss=0.01442 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.900 | L2-Norm(final)=11.778 | 6252.2 samples/s | 97.7 steps/s
[Step=36750 Epoch=179.2] | Loss=0.01307 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.909 | L2-Norm(final)=11.783 | 1737.9 samples/s | 27.2 steps/s
[Step=36800 Epoch=179.4] | Loss=0.01216 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.917 | L2-Norm(final)=11.787 | 4650.5 samples/s | 72.7 steps/s
[Step=36850 Epoch=179.7] | Loss=0.01132 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.924 | L2-Norm(final)=11.792 | 4561.3 samples/s | 71.3 steps/s
[Step=36900 Epoch=179.9] | Loss=0.01070 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.930 | L2-Norm(final)=11.796 | 5652.5 samples/s | 88.3 steps/s
[Step=36950 Epoch=180.2] | Loss=0.01006 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.936 | L2-Norm(final)=11.800 | 1768.5 samples/s | 27.6 steps/s
[Step=37000 Epoch=180.4] | Loss=0.00973 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.942 | L2-Norm(final)=11.804 | 4545.2 samples/s | 71.0 steps/s
[Step=37050 Epoch=180.7] | Loss=0.00930 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.947 | L2-Norm(final)=11.808 | 4507.9 samples/s | 70.4 steps/s
[Step=37100 Epoch=180.9] | Loss=0.00894 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.952 | L2-Norm(final)=11.812 | 5255.2 samples/s | 82.1 steps/s
[Step=37150 Epoch=181.2] | Loss=0.00854 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.956 | L2-Norm(final)=11.815 | 1830.5 samples/s | 28.6 steps/s
[Step=37200 Epoch=181.4] | Loss=0.00817 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.960 | L2-Norm(final)=11.819 | 4559.0 samples/s | 71.2 steps/s
[Step=37250 Epoch=181.6] | Loss=0.00796 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.964 | L2-Norm(final)=11.822 | 4636.4 samples/s | 72.4 steps/s
[Step=37300 Epoch=181.9] | Loss=0.00778 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.968 | L2-Norm(final)=11.825 | 5012.8 samples/s | 78.3 steps/s
[Step=37350 Epoch=182.1] | Loss=0.00756 | Reg=0.00099 | acc=0.9688 | L2-Norm=9.972 | L2-Norm(final)=11.829 | 1873.8 samples/s | 29.3 steps/s
[Step=37400 Epoch=182.4] | Loss=0.00741 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.976 | L2-Norm(final)=11.832 | 4626.8 samples/s | 72.3 steps/s
[Step=37450 Epoch=182.6] | Loss=0.00729 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.979 | L2-Norm(final)=11.835 | 4557.2 samples/s | 71.2 steps/s
[Step=37500 Epoch=182.9] | Loss=0.00713 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.983 | L2-Norm(final)=11.837 | 4694.3 samples/s | 73.3 steps/s
[Step=37550 Epoch=183.1] | Loss=0.00695 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.986 | L2-Norm(final)=11.840 | 1835.3 samples/s | 28.7 steps/s
[Step=37600 Epoch=183.3] | Loss=0.00674 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.990 | L2-Norm(final)=11.843 | 4533.4 samples/s | 70.8 steps/s
[Step=37650 Epoch=183.6] | Loss=0.00663 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.993 | L2-Norm(final)=11.846 | 4445.3 samples/s | 69.5 steps/s
[Step=37700 Epoch=183.8] | Loss=0.00656 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.996 | L2-Norm(final)=11.849 | 4606.6 samples/s | 72.0 steps/s
[Step=37750 Epoch=184.1] | Loss=0.00645 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.999 | L2-Norm(final)=11.851 | 1905.5 samples/s | 29.8 steps/s
[Step=37800 Epoch=184.3] | Loss=0.00632 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.002 | L2-Norm(final)=11.854 | 4567.6 samples/s | 71.4 steps/s
[Step=37850 Epoch=184.6] | Loss=0.00619 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.005 | L2-Norm(final)=11.856 | 4574.2 samples/s | 71.5 steps/s
[Step=37900 Epoch=184.8] | Loss=0.00618 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.008 | L2-Norm(final)=11.859 | 4550.5 samples/s | 71.1 steps/s
[Step=37950 Epoch=185.1] | Loss=0.00615 | Reg=0.00100 | acc=0.9531 | L2-Norm=10.010 | L2-Norm(final)=11.861 | 1920.8 samples/s | 30.0 steps/s
[Step=38000 Epoch=185.3] | Loss=0.00604 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.013 | L2-Norm(final)=11.863 | 4626.7 samples/s | 72.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step38000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=48001 Epoch=234.2] | Loss=0.03122 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.720 | L2-Norm(final)=13.245 | 3684.2 samples/s | 57.6 steps/s
[Step=48050 Epoch=234.5] | Loss=0.02442 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.729 | L2-Norm(final)=13.236 | 5117.3 samples/s | 80.0 steps/s
[Step=48100 Epoch=234.7] | Loss=0.02172 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.740 | L2-Norm(final)=13.235 | 5206.6 samples/s | 81.4 steps/s
[Step=48150 Epoch=234.9] | Loss=0.02068 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.749 | L2-Norm(final)=13.236 | 5251.6 samples/s | 82.1 steps/s
[Step=48200 Epoch=235.2] | Loss=0.01875 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.758 | L2-Norm(final)=13.239 | 7122.1 samples/s | 111.3 steps/s
[Step=48250 Epoch=235.4] | Loss=0.01706 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.766 | L2-Norm(final)=13.242 | 1761.8 samples/s | 27.5 steps/s
[Step=48300 Epoch=235.7] | Loss=0.01651 | Reg=0.00096 | acc=0.9688 | L2-Norm=9.774 | L2-Norm(final)=13.246 | 5205.6 samples/s | 81.3 steps/s
[Step=48350 Epoch=235.9] | Loss=0.01591 | Reg=0.00096 | acc=0.9688 | L2-Norm=9.781 | L2-Norm(final)=13.250 | 5145.3 samples/s | 80.4 steps/s
[Step=48400 Epoch=236.2] | Loss=0.01526 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.788 | L2-Norm(final)=13.254 | 6668.5 samples/s | 104.2 steps/s
[Step=48450 Epoch=236.4] | Loss=0.01464 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.795 | L2-Norm(final)=13.259 | 1842.1 samples/s | 28.8 steps/s
[Step=48500 Epoch=236.7] | Loss=0.01428 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.802 | L2-Norm(final)=13.264 | 5142.0 samples/s | 80.3 steps/s
All layers training...
LR=0.00013, len=1
[Step=48501 Epoch=236.7] | Loss=0.02672 | Reg=0.00097 | acc=0.9688 | L2-Norm=9.873 | L2-Norm(final)=13.316 | 3549.3 samples/s | 55.5 steps/s
[Step=48550 Epoch=236.9] | Loss=0.01501 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.885 | L2-Norm(final)=13.320 | 4577.6 samples/s | 71.5 steps/s
[Step=48600 Epoch=237.1] | Loss=0.01468 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.894 | L2-Norm(final)=13.324 | 4692.1 samples/s | 73.3 steps/s
[Step=48650 Epoch=237.4] | Loss=0.01414 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.903 | L2-Norm(final)=13.327 | 4670.3 samples/s | 73.0 steps/s
[Step=48700 Epoch=237.6] | Loss=0.01349 | Reg=0.00098 | acc=0.9844 | L2-Norm=9.911 | L2-Norm(final)=13.331 | 6256.3 samples/s | 97.8 steps/s
[Step=48750 Epoch=237.9] | Loss=0.01200 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.919 | L2-Norm(final)=13.335 | 1742.6 samples/s | 27.2 steps/s
[Step=48800 Epoch=238.1] | Loss=0.01093 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.925 | L2-Norm(final)=13.339 | 4549.8 samples/s | 71.1 steps/s
[Step=48850 Epoch=238.4] | Loss=0.01032 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.931 | L2-Norm(final)=13.343 | 4522.3 samples/s | 70.7 steps/s
[Step=48900 Epoch=238.6] | Loss=0.00985 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.937 | L2-Norm(final)=13.347 | 5764.6 samples/s | 90.1 steps/s
[Step=48950 Epoch=238.9] | Loss=0.00918 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.942 | L2-Norm(final)=13.351 | 1797.6 samples/s | 28.1 steps/s
[Step=49000 Epoch=239.1] | Loss=0.00861 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.947 | L2-Norm(final)=13.354 | 4579.0 samples/s | 71.5 steps/s
[Step=49050 Epoch=239.3] | Loss=0.00831 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.952 | L2-Norm(final)=13.358 | 4552.4 samples/s | 71.1 steps/s
[Step=49100 Epoch=239.6] | Loss=0.00811 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.956 | L2-Norm(final)=13.361 | 5404.5 samples/s | 84.4 steps/s
[Step=49150 Epoch=239.8] | Loss=0.00768 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.960 | L2-Norm(final)=13.364 | 1786.5 samples/s | 27.9 steps/s
[Step=49200 Epoch=240.1] | Loss=0.00745 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.964 | L2-Norm(final)=13.367 | 4607.2 samples/s | 72.0 steps/s
[Step=49250 Epoch=240.3] | Loss=0.00724 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.967 | L2-Norm(final)=13.370 | 4595.2 samples/s | 71.8 steps/s
[Step=49300 Epoch=240.6] | Loss=0.00700 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.971 | L2-Norm(final)=13.373 | 5185.4 samples/s | 81.0 steps/s
[Step=49350 Epoch=240.8] | Loss=0.00674 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.974 | L2-Norm(final)=13.376 | 1863.0 samples/s | 29.1 steps/s
[Step=49400 Epoch=241.0] | Loss=0.00656 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.978 | L2-Norm(final)=13.379 | 4658.3 samples/s | 72.8 steps/s
[Step=49450 Epoch=241.3] | Loss=0.00639 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.981 | L2-Norm(final)=13.382 | 4619.1 samples/s | 72.2 steps/s
[Step=49500 Epoch=241.5] | Loss=0.00633 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.984 | L2-Norm(final)=13.384 | 4872.3 samples/s | 76.1 steps/s
[Step=49550 Epoch=241.8] | Loss=0.00618 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.987 | L2-Norm(final)=13.386 | 1852.6 samples/s | 28.9 steps/s
[Step=49600 Epoch=242.0] | Loss=0.00602 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.989 | L2-Norm(final)=13.389 | 4268.6 samples/s | 66.7 steps/s
[Step=49650 Epoch=242.3] | Loss=0.00594 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.992 | L2-Norm(final)=13.391 | 4411.8 samples/s | 68.9 steps/s
[Step=49700 Epoch=242.5] | Loss=0.00581 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.995 | L2-Norm(final)=13.393 | 4633.2 samples/s | 72.4 steps/s
[Step=49750 Epoch=242.8] | Loss=0.00575 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.997 | L2-Norm(final)=13.396 | 1907.9 samples/s | 29.8 steps/s
[Step=49800 Epoch=243.0] | Loss=0.00567 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.999 | L2-Norm(final)=13.398 | 4655.3 samples/s | 72.7 steps/s
[Step=49850 Epoch=243.2] | Loss=0.00555 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.002 | L2-Norm(final)=13.400 | 4611.9 samples/s | 72.1 steps/s
[Step=49900 Epoch=243.5] | Loss=0.00548 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.004 | L2-Norm(final)=13.402 | 4507.7 samples/s | 70.4 steps/s
[Step=49950 Epoch=243.7] | Loss=0.00543 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.006 | L2-Norm(final)=13.404 | 1917.2 samples/s | 30.0 steps/s
[Step=50000 Epoch=244.0] | Loss=0.00537 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.008 | L2-Norm(final)=13.406 | 4496.2 samples/s | 70.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step50000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=44001 Epoch=215.8] | Loss=0.04732 | Reg=0.00094 | acc=0.9531 | L2-Norm=9.720 | L2-Norm(final)=13.218 | 3801.6 samples/s | 59.4 steps/s
[Step=44050 Epoch=216.0] | Loss=0.01860 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.727 | L2-Norm(final)=13.214 | 4710.2 samples/s | 73.6 steps/s
[Step=44100 Epoch=216.3] | Loss=0.01646 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.739 | L2-Norm(final)=13.214 | 4683.3 samples/s | 73.2 steps/s
[Step=44150 Epoch=216.5] | Loss=0.01510 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.749 | L2-Norm(final)=13.218 | 5011.9 samples/s | 78.3 steps/s
[Step=44200 Epoch=216.7] | Loss=0.01542 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.757 | L2-Norm(final)=13.221 | 7144.1 samples/s | 111.6 steps/s
[Step=44250 Epoch=217.0] | Loss=0.01466 | Reg=0.00095 | acc=0.9688 | L2-Norm=9.766 | L2-Norm(final)=13.225 | 1758.8 samples/s | 27.5 steps/s
[Step=44300 Epoch=217.2] | Loss=0.01374 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.774 | L2-Norm(final)=13.230 | 5155.1 samples/s | 80.5 steps/s
[Step=44350 Epoch=217.5] | Loss=0.01334 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.782 | L2-Norm(final)=13.235 | 5235.7 samples/s | 81.8 steps/s
[Step=44400 Epoch=217.7] | Loss=0.01313 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.790 | L2-Norm(final)=13.240 | 6745.3 samples/s | 105.4 steps/s
[Step=44450 Epoch=218.0] | Loss=0.01274 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.797 | L2-Norm(final)=13.246 | 1839.3 samples/s | 28.7 steps/s
[Step=44500 Epoch=218.2] | Loss=0.01241 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.804 | L2-Norm(final)=13.251 | 5285.8 samples/s | 82.6 steps/s
All layers training...
LR=0.00013, len=1
[Step=44501 Epoch=218.2] | Loss=0.00100 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.876 | L2-Norm(final)=13.309 | 3929.2 samples/s | 61.4 steps/s
[Step=44550 Epoch=218.5] | Loss=0.01108 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.887 | L2-Norm(final)=13.316 | 4310.2 samples/s | 67.3 steps/s
[Step=44600 Epoch=218.7] | Loss=0.01166 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.899 | L2-Norm(final)=13.321 | 4421.3 samples/s | 69.1 steps/s
[Step=44650 Epoch=219.0] | Loss=0.01269 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.909 | L2-Norm(final)=13.325 | 4587.2 samples/s | 71.7 steps/s
[Step=44700 Epoch=219.2] | Loss=0.01201 | Reg=0.00098 | acc=1.0000 | L2-Norm=9.918 | L2-Norm(final)=13.329 | 6083.6 samples/s | 95.1 steps/s
[Step=44750 Epoch=219.4] | Loss=0.01074 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.926 | L2-Norm(final)=13.333 | 1743.7 samples/s | 27.2 steps/s
[Step=44800 Epoch=219.7] | Loss=0.00997 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.932 | L2-Norm(final)=13.338 | 4635.0 samples/s | 72.4 steps/s
[Step=44850 Epoch=219.9] | Loss=0.00926 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.939 | L2-Norm(final)=13.341 | 4641.9 samples/s | 72.5 steps/s
[Step=44900 Epoch=220.2] | Loss=0.00882 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.944 | L2-Norm(final)=13.345 | 6008.3 samples/s | 93.9 steps/s
[Step=44950 Epoch=220.4] | Loss=0.00838 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.950 | L2-Norm(final)=13.349 | 1764.4 samples/s | 27.6 steps/s
[Step=45000 Epoch=220.7] | Loss=0.00792 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.954 | L2-Norm(final)=13.352 | 4623.8 samples/s | 72.2 steps/s
[Step=45050 Epoch=220.9] | Loss=0.00751 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.959 | L2-Norm(final)=13.356 | 4614.5 samples/s | 72.1 steps/s
[Step=45100 Epoch=221.2] | Loss=0.00724 | Reg=0.00099 | acc=0.9844 | L2-Norm=9.963 | L2-Norm(final)=13.359 | 5753.8 samples/s | 89.9 steps/s
[Step=45150 Epoch=221.4] | Loss=0.00688 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.967 | L2-Norm(final)=13.362 | 1778.6 samples/s | 27.8 steps/s
[Step=45200 Epoch=221.7] | Loss=0.00658 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.971 | L2-Norm(final)=13.365 | 4375.5 samples/s | 68.4 steps/s
[Step=45250 Epoch=221.9] | Loss=0.00629 | Reg=0.00099 | acc=1.0000 | L2-Norm=9.974 | L2-Norm(final)=13.368 | 4251.0 samples/s | 66.4 steps/s
[Step=45300 Epoch=222.1] | Loss=0.00612 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.978 | L2-Norm(final)=13.371 | 5147.1 samples/s | 80.4 steps/s
[Step=45350 Epoch=222.4] | Loss=0.00606 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.981 | L2-Norm(final)=13.374 | 1807.0 samples/s | 28.2 steps/s
[Step=45400 Epoch=222.6] | Loss=0.00585 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.984 | L2-Norm(final)=13.376 | 4524.5 samples/s | 70.7 steps/s
[Step=45450 Epoch=222.9] | Loss=0.00579 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.988 | L2-Norm(final)=13.379 | 4526.8 samples/s | 70.7 steps/s
[Step=45500 Epoch=223.1] | Loss=0.00565 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.991 | L2-Norm(final)=13.381 | 5227.1 samples/s | 81.7 steps/s
[Step=45550 Epoch=223.4] | Loss=0.00550 | Reg=0.00100 | acc=0.9844 | L2-Norm=9.993 | L2-Norm(final)=13.384 | 1845.9 samples/s | 28.8 steps/s
[Step=45600 Epoch=223.6] | Loss=0.00538 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.996 | L2-Norm(final)=13.386 | 4608.8 samples/s | 72.0 steps/s
[Step=45650 Epoch=223.9] | Loss=0.00538 | Reg=0.00100 | acc=1.0000 | L2-Norm=9.999 | L2-Norm(final)=13.389 | 4540.7 samples/s | 70.9 steps/s
[Step=45700 Epoch=224.1] | Loss=0.00527 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.001 | L2-Norm(final)=13.391 | 4983.0 samples/s | 77.9 steps/s
[Step=45750 Epoch=224.4] | Loss=0.00520 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.004 | L2-Norm(final)=13.393 | 1870.0 samples/s | 29.2 steps/s
[Step=45800 Epoch=224.6] | Loss=0.00513 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.006 | L2-Norm(final)=13.395 | 4718.1 samples/s | 73.7 steps/s
[Step=45850 Epoch=224.8] | Loss=0.00500 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.008 | L2-Norm(final)=13.397 | 4634.9 samples/s | 72.4 steps/s
[Step=45900 Epoch=225.1] | Loss=0.00500 | Reg=0.00100 | acc=0.9844 | L2-Norm=10.011 | L2-Norm(final)=13.399 | 4739.1 samples/s | 74.0 steps/s
[Step=45950 Epoch=225.3] | Loss=0.00490 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.013 | L2-Norm(final)=13.401 | 1895.8 samples/s | 29.6 steps/s
[Step=46000 Epoch=225.6] | Loss=0.00483 | Reg=0.00100 | acc=1.0000 | L2-Norm=10.015 | L2-Norm(final)=13.403 | 4595.5 samples/s | 71.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step46000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=38001 Epoch=362.9] | Loss=0.01090 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.720 | L2-Norm(final)=8.500 | 3685.5 samples/s | 57.6 steps/s
[Step=38050 Epoch=363.4] | Loss=0.00236 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.746 | L2-Norm(final)=8.498 | 4531.5 samples/s | 70.8 steps/s
[Step=38100 Epoch=363.8] | Loss=0.00125 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.760 | L2-Norm(final)=8.500 | 6856.9 samples/s | 107.1 steps/s
[Step=38150 Epoch=364.3] | Loss=0.00085 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.764 | L2-Norm(final)=8.503 | 1697.1 samples/s | 26.5 steps/s
[Step=38200 Epoch=364.8] | Loss=0.00066 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.765 | L2-Norm(final)=8.505 | 6108.1 samples/s | 95.4 steps/s
[Step=38250 Epoch=365.3] | Loss=0.00054 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.765 | L2-Norm(final)=8.507 | 1767.1 samples/s | 27.6 steps/s
[Step=38300 Epoch=365.7] | Loss=0.00045 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.765 | L2-Norm(final)=8.509 | 5893.2 samples/s | 92.1 steps/s
[Step=38350 Epoch=366.2] | Loss=0.00040 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.763 | L2-Norm(final)=8.511 | 1849.8 samples/s | 28.9 steps/s
[Step=38400 Epoch=366.7] | Loss=0.00035 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.762 | L2-Norm(final)=8.513 | 5622.6 samples/s | 87.9 steps/s
[Step=38450 Epoch=367.2] | Loss=0.00032 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.761 | L2-Norm(final)=8.515 | 1865.6 samples/s | 29.2 steps/s
[Step=38500 Epoch=367.7] | Loss=0.00029 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.759 | L2-Norm(final)=8.516 | 5502.9 samples/s | 86.0 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=367.7] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.743 | L2-Norm(final)=8.534 | 3649.7 samples/s | 57.0 steps/s
[Step=38550 Epoch=368.1] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.740 | L2-Norm(final)=8.535 | 4334.7 samples/s | 67.7 steps/s
[Step=38600 Epoch=368.6] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.734 | L2-Norm(final)=8.536 | 5941.4 samples/s | 92.8 steps/s
[Step=38650 Epoch=369.1] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.728 | L2-Norm(final)=8.537 | 1662.6 samples/s | 26.0 steps/s
[Step=38700 Epoch=369.6] | Loss=0.00002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.721 | L2-Norm(final)=8.538 | 5646.0 samples/s | 88.2 steps/s
[Step=38750 Epoch=370.0] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.714 | L2-Norm(final)=8.538 | 1741.2 samples/s | 27.2 steps/s
[Step=38800 Epoch=370.5] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.707 | L2-Norm(final)=8.539 | 5359.3 samples/s | 83.7 steps/s
[Step=38850 Epoch=371.0] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.700 | L2-Norm(final)=8.539 | 1760.3 samples/s | 27.5 steps/s
[Step=38900 Epoch=371.5] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.693 | L2-Norm(final)=8.539 | 4973.8 samples/s | 77.7 steps/s
[Step=38950 Epoch=371.9] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.685 | L2-Norm(final)=8.540 | 1727.8 samples/s | 27.0 steps/s
[Step=39000 Epoch=372.4] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.677 | L2-Norm(final)=8.540 | 4574.2 samples/s | 71.5 steps/s
[Step=39050 Epoch=372.9] | Loss=0.00001 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.669 | L2-Norm(final)=8.540 | 1817.5 samples/s | 28.4 steps/s
[Step=39100 Epoch=373.4] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.661 | L2-Norm(final)=8.541 | 4464.0 samples/s | 69.8 steps/s
[Step=39150 Epoch=373.9] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.653 | L2-Norm(final)=8.541 | 1855.5 samples/s | 29.0 steps/s
[Step=39200 Epoch=374.3] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.645 | L2-Norm(final)=8.541 | 4408.5 samples/s | 68.9 steps/s
[Step=39250 Epoch=374.8] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.637 | L2-Norm(final)=8.541 | 1856.5 samples/s | 29.0 steps/s
[Step=39300 Epoch=375.3] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.629 | L2-Norm(final)=8.542 | 4568.5 samples/s | 71.4 steps/s
[Step=39350 Epoch=375.8] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.620 | L2-Norm(final)=8.542 | 1876.3 samples/s | 29.3 steps/s
[Step=39400 Epoch=376.2] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.611 | L2-Norm(final)=8.542 | 4296.0 samples/s | 67.1 steps/s
[Step=39450 Epoch=376.7] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=8.542 | 1819.8 samples/s | 28.4 steps/s
[Step=39500 Epoch=377.2] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.594 | L2-Norm(final)=8.543 | 4214.6 samples/s | 65.9 steps/s
[Step=39550 Epoch=377.7] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.585 | L2-Norm(final)=8.543 | 6386.4 samples/s | 99.8 steps/s
[Step=39600 Epoch=378.2] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=8.543 | 1633.5 samples/s | 25.5 steps/s
[Step=39650 Epoch=378.6] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.566 | L2-Norm(final)=8.543 | 6014.1 samples/s | 94.0 steps/s
[Step=39700 Epoch=379.1] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.557 | L2-Norm(final)=8.544 | 1724.5 samples/s | 26.9 steps/s
[Step=39750 Epoch=379.6] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.548 | L2-Norm(final)=8.544 | 5939.8 samples/s | 92.8 steps/s
[Step=39800 Epoch=380.1] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.538 | L2-Norm(final)=8.544 | 1708.3 samples/s | 26.7 steps/s
[Step=39850 Epoch=380.5] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.528 | L2-Norm(final)=8.544 | 4840.3 samples/s | 75.6 steps/s
[Step=39900 Epoch=381.0] | Loss=0.00000 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.518 | L2-Norm(final)=8.544 | 1706.1 samples/s | 26.7 steps/s
[Step=39950 Epoch=381.5] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.508 | L2-Norm(final)=8.545 | 4742.3 samples/s | 74.1 steps/s
[Step=40000 Epoch=382.0] | Loss=0.00000 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.498 | L2-Norm(final)=8.545 | 1803.8 samples/s | 28.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step40000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00013, len=1
[Step=38001 Epoch=358.1] | Loss=0.00760 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.720 | L2-Norm(final)=8.986 | 3575.1 samples/s | 55.9 steps/s
[Step=38050 Epoch=358.5] | Loss=0.00199 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.748 | L2-Norm(final)=8.982 | 4525.4 samples/s | 70.7 steps/s
[Step=38100 Epoch=359.0] | Loss=0.00114 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.759 | L2-Norm(final)=8.987 | 6850.2 samples/s | 107.0 steps/s
[Step=38150 Epoch=359.5] | Loss=0.00080 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.764 | L2-Norm(final)=8.992 | 1744.7 samples/s | 27.3 steps/s
[Step=38200 Epoch=360.0] | Loss=0.00063 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.766 | L2-Norm(final)=8.996 | 6005.1 samples/s | 93.8 steps/s
[Step=38250 Epoch=360.4] | Loss=0.00052 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=8.999 | 1809.1 samples/s | 28.3 steps/s
[Step=38300 Epoch=360.9] | Loss=0.00045 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=9.002 | 5360.7 samples/s | 83.8 steps/s
[Step=38350 Epoch=361.4] | Loss=0.00040 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=9.005 | 1863.4 samples/s | 29.1 steps/s
[Step=38400 Epoch=361.8] | Loss=0.00036 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.766 | L2-Norm(final)=9.008 | 5091.6 samples/s | 79.6 steps/s
[Step=38450 Epoch=362.3] | Loss=0.00032 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.765 | L2-Norm(final)=9.011 | 1898.0 samples/s | 29.7 steps/s
[Step=38500 Epoch=362.8] | Loss=0.00030 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.764 | L2-Norm(final)=9.014 | 4956.6 samples/s | 77.4 steps/s
All layers training...
LR=0.00013, len=1
[Step=38501 Epoch=362.8] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.752 | L2-Norm(final)=9.039 | 3433.8 samples/s | 53.7 steps/s
[Step=38550 Epoch=363.3] | Loss=0.00007 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.749 | L2-Norm(final)=9.042 | 4390.1 samples/s | 68.6 steps/s
[Step=38600 Epoch=363.7] | Loss=0.00010 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.748 | L2-Norm(final)=9.044 | 5924.4 samples/s | 92.6 steps/s
[Step=38650 Epoch=364.2] | Loss=0.00007 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.750 | L2-Norm(final)=9.047 | 1656.2 samples/s | 25.9 steps/s
[Step=38700 Epoch=364.7] | Loss=0.00006 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.747 | L2-Norm(final)=9.048 | 5353.1 samples/s | 83.6 steps/s
[Step=38750 Epoch=365.1] | Loss=0.00005 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.742 | L2-Norm(final)=9.049 | 1738.9 samples/s | 27.2 steps/s
[Step=38800 Epoch=365.6] | Loss=0.00004 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.736 | L2-Norm(final)=9.050 | 4997.5 samples/s | 78.1 steps/s
[Step=38850 Epoch=366.1] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.730 | L2-Norm(final)=9.050 | 1795.2 samples/s | 28.0 steps/s
[Step=38900 Epoch=366.5] | Loss=0.00003 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.723 | L2-Norm(final)=9.051 | 4543.8 samples/s | 71.0 steps/s
[Step=38950 Epoch=367.0] | Loss=0.00003 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.715 | L2-Norm(final)=9.051 | 1831.3 samples/s | 28.6 steps/s
[Step=39000 Epoch=367.5] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.708 | L2-Norm(final)=9.051 | 4473.8 samples/s | 69.9 steps/s
[Step=39050 Epoch=368.0] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.700 | L2-Norm(final)=9.052 | 1846.0 samples/s | 28.8 steps/s
[Step=39100 Epoch=368.4] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.692 | L2-Norm(final)=9.052 | 4476.9 samples/s | 70.0 steps/s
[Step=39150 Epoch=368.9] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.683 | L2-Norm(final)=9.052 | 1865.3 samples/s | 29.1 steps/s
[Step=39200 Epoch=369.4] | Loss=0.00002 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.675 | L2-Norm(final)=9.053 | 4429.0 samples/s | 69.2 steps/s
[Step=39250 Epoch=369.8] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.666 | L2-Norm(final)=9.053 | 1962.1 samples/s | 30.7 steps/s
[Step=39300 Epoch=370.3] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.657 | L2-Norm(final)=9.053 | 3825.5 samples/s | 59.8 steps/s
[Step=39350 Epoch=370.8] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.649 | L2-Norm(final)=9.053 | 5956.7 samples/s | 93.1 steps/s
[Step=39400 Epoch=371.3] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.639 | L2-Norm(final)=9.053 | 1687.3 samples/s | 26.4 steps/s
[Step=39450 Epoch=371.7] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.630 | L2-Norm(final)=9.054 | 5308.8 samples/s | 83.0 steps/s
[Step=39500 Epoch=372.2] | Loss=0.00001 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.621 | L2-Norm(final)=9.054 | 1709.4 samples/s | 26.7 steps/s
[Step=39550 Epoch=372.7] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.611 | L2-Norm(final)=9.054 | 4875.7 samples/s | 76.2 steps/s
[Step=39600 Epoch=373.1] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.602 | L2-Norm(final)=9.054 | 1772.5 samples/s | 27.7 steps/s
[Step=39650 Epoch=373.6] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.592 | L2-Norm(final)=9.054 | 4637.1 samples/s | 72.5 steps/s
[Step=39700 Epoch=374.1] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.582 | L2-Norm(final)=9.054 | 1835.1 samples/s | 28.7 steps/s
[Step=39750 Epoch=374.6] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.572 | L2-Norm(final)=9.055 | 4396.8 samples/s | 68.7 steps/s
[Step=39800 Epoch=375.0] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.562 | L2-Norm(final)=9.055 | 1858.3 samples/s | 29.0 steps/s
[Step=39850 Epoch=375.5] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.552 | L2-Norm(final)=9.055 | 4465.9 samples/s | 69.8 steps/s
[Step=39900 Epoch=376.0] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.541 | L2-Norm(final)=9.055 | 1861.3 samples/s | 29.1 steps/s
[Step=39950 Epoch=376.4] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.531 | L2-Norm(final)=9.055 | 4338.6 samples/s | 67.8 steps/s
[Step=40000 Epoch=376.9] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.520 | L2-Norm(final)=9.055 | 1902.2 samples/s | 29.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07974 | acc=0.9621 | tpr=0.9682 | fpr=0.0510 | 4126.5 samples/s | 16.1 steps/s
Avg test loss: 0.08311, Avg test acc: 0.96013, Avg tpr: 0.96672, Avg fpr: 0.05435, total FA: 424

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08460 | acc=0.9618 | tpr=0.9732 | fpr=0.0629 | 4369.7 samples/s | 17.1 steps/s
Avg test loss: 0.08895, Avg test acc: 0.96218, Avg tpr: 0.97354, Avg fpr: 0.06281, total FA: 490

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08730 | acc=0.9607 | tpr=0.9724 | fpr=0.0647 | 4086.6 samples/s | 16.0 steps/s
Avg test loss: 0.09255, Avg test acc: 0.95925, Avg tpr: 0.97027, Avg fpr: 0.06499, total FA: 507

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.08320 | acc=0.9605 | tpr=0.9708 | fpr=0.0617 | 4117.1 samples/s | 16.1 steps/s
Avg test loss: 0.08696, Avg test acc: 0.96049, Avg tpr: 0.97074, Avg fpr: 0.06204, total FA: 484

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08419 | acc=0.9631 | tpr=0.9728 | fpr=0.0580 | 4164.8 samples/s | 16.3 steps/s
Avg test loss: 0.09219, Avg test acc: 0.96117, Avg tpr: 0.97132, Avg fpr: 0.06115, total FA: 477

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.21816 | acc=0.2950 | tpr=0.0027 | fpr=0.0704 | 4064.2 samples/s | 15.9 steps/s
Avg test loss: 5.23691, Avg test acc: 0.29313, Avg tpr: 0.00356, Avg fpr: 0.06999, total FA: 546

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.02254 | acc=0.3140 | tpr=0.0037 | fpr=0.0121 | 4083.9 samples/s | 16.0 steps/s
Avg test loss: 5.03125, Avg test acc: 0.31120, Avg tpr: 0.00408, Avg fpr: 0.01333, total FA: 104

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.15683 | acc=0.2988 | tpr=0.0058 | fpr=0.0649 | 4079.5 samples/s | 15.9 steps/s
Avg test loss: 5.16732, Avg test acc: 0.29710, Avg tpr: 0.00676, Avg fpr: 0.06435, total FA: 502

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.35837 | acc=0.3050 | tpr=0.0033 | fpr=0.0399 | 4034.0 samples/s | 15.8 steps/s
Avg test loss: 5.37555, Avg test acc: 0.30259, Avg tpr: 0.00425, Avg fpr: 0.04128, total FA: 322

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=5.05652 | acc=0.3134 | tpr=0.0022 | fpr=0.0109 | 4119.0 samples/s | 16.1 steps/s
Avg test loss: 5.06487, Avg test acc: 0.31072, Avg tpr: 0.00280, Avg fpr: 0.01205, total FA: 94

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.72275 | acc=0.1320 | tpr=0.8230 | fpr=0.8804 | 4154.8 samples/s | 16.2 steps/s
[Step= 100] | Loss=4.67462 | acc=0.1350 | tpr=0.8060 | fpr=0.8776 | 8133.5 samples/s | 31.8 steps/s
[Step= 150] | Loss=4.67551 | acc=0.1338 | tpr=0.8228 | fpr=0.8789 | 8121.5 samples/s | 31.7 steps/s
[Step= 200] | Loss=4.67493 | acc=0.1330 | tpr=0.8208 | fpr=0.8795 | 7983.4 samples/s | 31.2 steps/s
[Step= 250] | Loss=4.67950 | acc=0.1343 | tpr=0.8227 | fpr=0.8782 | 8097.9 samples/s | 31.6 steps/s
[Step= 300] | Loss=4.67459 | acc=0.1342 | tpr=0.8189 | fpr=0.8782 | 8169.2 samples/s | 31.9 steps/s
[Step= 350] | Loss=4.67051 | acc=0.1337 | tpr=0.8153 | fpr=0.8787 | 8194.4 samples/s | 32.0 steps/s
[Step= 400] | Loss=4.67389 | acc=0.1339 | tpr=0.8129 | fpr=0.8784 | 8111.5 samples/s | 31.7 steps/s
[Step= 450] | Loss=4.67614 | acc=0.1337 | tpr=0.8092 | fpr=0.8785 | 7698.1 samples/s | 30.1 steps/s
[Step= 500] | Loss=4.67901 | acc=0.1336 | tpr=0.8093 | fpr=0.8786 | 8086.9 samples/s | 31.6 steps/s
[Step= 550] | Loss=4.67745 | acc=0.1334 | tpr=0.8114 | fpr=0.8790 | 13930.1 samples/s | 54.4 steps/s
Avg test loss: 4.67916, Avg test acc: 0.13328, Avg tpr: 0.81062, Avg fpr: 0.87903, total FA: 122052

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.98266 | acc=0.1357 | tpr=0.7965 | fpr=0.8762 | 4131.9 samples/s | 16.1 steps/s
[Step= 100] | Loss=4.93114 | acc=0.1381 | tpr=0.7804 | fpr=0.8739 | 8296.9 samples/s | 32.4 steps/s
[Step= 150] | Loss=4.93290 | acc=0.1366 | tpr=0.7824 | fpr=0.8753 | 7873.9 samples/s | 30.8 steps/s
[Step= 200] | Loss=4.93346 | acc=0.1365 | tpr=0.7825 | fpr=0.8753 | 8110.5 samples/s | 31.7 steps/s
[Step= 250] | Loss=4.93309 | acc=0.1373 | tpr=0.7799 | fpr=0.8744 | 8353.0 samples/s | 32.6 steps/s
[Step= 300] | Loss=4.92990 | acc=0.1368 | tpr=0.7811 | fpr=0.8750 | 7751.6 samples/s | 30.3 steps/s
[Step= 350] | Loss=4.92459 | acc=0.1364 | tpr=0.7802 | fpr=0.8753 | 7999.5 samples/s | 31.2 steps/s
[Step= 400] | Loss=4.92582 | acc=0.1361 | tpr=0.7735 | fpr=0.8755 | 7880.0 samples/s | 30.8 steps/s
[Step= 450] | Loss=4.93064 | acc=0.1361 | tpr=0.7707 | fpr=0.8755 | 7953.1 samples/s | 31.1 steps/s
[Step= 500] | Loss=4.93583 | acc=0.1357 | tpr=0.7705 | fpr=0.8757 | 7987.5 samples/s | 31.2 steps/s
[Step= 550] | Loss=4.93403 | acc=0.1357 | tpr=0.7728 | fpr=0.8758 | 15292.7 samples/s | 59.7 steps/s
Avg test loss: 4.93554, Avg test acc: 0.13571, Avg tpr: 0.77219, Avg fpr: 0.87586, total FA: 121612

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.70046 | acc=0.1200 | tpr=0.8186 | fpr=0.8926 | 4217.9 samples/s | 16.5 steps/s
[Step= 100] | Loss=5.64790 | acc=0.1228 | tpr=0.8166 | fpr=0.8901 | 7788.8 samples/s | 30.4 steps/s
[Step= 150] | Loss=5.65111 | acc=0.1205 | tpr=0.8329 | fpr=0.8926 | 8191.8 samples/s | 32.0 steps/s
[Step= 200] | Loss=5.65140 | acc=0.1197 | tpr=0.8339 | fpr=0.8933 | 7488.8 samples/s | 29.3 steps/s
[Step= 250] | Loss=5.65175 | acc=0.1200 | tpr=0.8349 | fpr=0.8931 | 7963.9 samples/s | 31.1 steps/s
[Step= 300] | Loss=5.64785 | acc=0.1199 | tpr=0.8385 | fpr=0.8932 | 8127.3 samples/s | 31.7 steps/s
[Step= 350] | Loss=5.64560 | acc=0.1197 | tpr=0.8384 | fpr=0.8933 | 8500.7 samples/s | 33.2 steps/s
[Step= 400] | Loss=5.64839 | acc=0.1198 | tpr=0.8370 | fpr=0.8932 | 7502.4 samples/s | 29.3 steps/s
[Step= 450] | Loss=5.65288 | acc=0.1192 | tpr=0.8335 | fpr=0.8937 | 8325.7 samples/s | 32.5 steps/s
[Step= 500] | Loss=5.65348 | acc=0.1193 | tpr=0.8344 | fpr=0.8936 | 7450.2 samples/s | 29.1 steps/s
[Step= 550] | Loss=5.65280 | acc=0.1190 | tpr=0.8372 | fpr=0.8940 | 14265.3 samples/s | 55.7 steps/s
Avg test loss: 5.65449, Avg test acc: 0.11899, Avg tpr: 0.83677, Avg fpr: 0.89406, total FA: 124138

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.99105 | acc=0.1402 | tpr=0.7345 | fpr=0.8705 | 4139.9 samples/s | 16.2 steps/s
[Step= 100] | Loss=4.94101 | acc=0.1409 | tpr=0.7143 | fpr=0.8698 | 7913.8 samples/s | 30.9 steps/s
[Step= 150] | Loss=4.93536 | acc=0.1399 | tpr=0.7406 | fpr=0.8712 | 8097.7 samples/s | 31.6 steps/s
[Step= 200] | Loss=4.93152 | acc=0.1398 | tpr=0.7410 | fpr=0.8712 | 7789.7 samples/s | 30.4 steps/s
[Step= 250] | Loss=4.93387 | acc=0.1403 | tpr=0.7441 | fpr=0.8707 | 8113.2 samples/s | 31.7 steps/s
[Step= 300] | Loss=4.93029 | acc=0.1395 | tpr=0.7469 | fpr=0.8716 | 8274.9 samples/s | 32.3 steps/s
[Step= 350] | Loss=4.92462 | acc=0.1393 | tpr=0.7451 | fpr=0.8717 | 7783.6 samples/s | 30.4 steps/s
[Step= 400] | Loss=4.92825 | acc=0.1390 | tpr=0.7445 | fpr=0.8720 | 7818.6 samples/s | 30.5 steps/s
[Step= 450] | Loss=4.93359 | acc=0.1385 | tpr=0.7395 | fpr=0.8724 | 8074.5 samples/s | 31.5 steps/s
[Step= 500] | Loss=4.93654 | acc=0.1383 | tpr=0.7414 | fpr=0.8726 | 8080.5 samples/s | 31.6 steps/s
[Step= 550] | Loss=4.93439 | acc=0.1383 | tpr=0.7473 | fpr=0.8727 | 13067.7 samples/s | 51.0 steps/s
Avg test loss: 4.93614, Avg test acc: 0.13827, Avg tpr: 0.74683, Avg fpr: 0.87279, total FA: 121185

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.19363 | acc=0.1291 | tpr=0.7301 | fpr=0.8817 | 4099.6 samples/s | 16.0 steps/s
[Step= 100] | Loss=5.13860 | acc=0.1326 | tpr=0.7058 | fpr=0.8781 | 7903.6 samples/s | 30.9 steps/s
[Step= 150] | Loss=5.14026 | acc=0.1312 | tpr=0.7075 | fpr=0.8794 | 8188.4 samples/s | 32.0 steps/s
[Step= 200] | Loss=5.13738 | acc=0.1306 | tpr=0.7016 | fpr=0.8798 | 8014.2 samples/s | 31.3 steps/s
[Step= 250] | Loss=5.14248 | acc=0.1311 | tpr=0.7013 | fpr=0.8793 | 8207.7 samples/s | 32.1 steps/s
[Step= 300] | Loss=5.13901 | acc=0.1304 | tpr=0.7025 | fpr=0.8800 | 7938.0 samples/s | 31.0 steps/s
[Step= 350] | Loss=5.13480 | acc=0.1297 | tpr=0.6994 | fpr=0.8806 | 7844.9 samples/s | 30.6 steps/s
[Step= 400] | Loss=5.13812 | acc=0.1297 | tpr=0.6975 | fpr=0.8806 | 8058.3 samples/s | 31.5 steps/s
[Step= 450] | Loss=5.14059 | acc=0.1292 | tpr=0.6923 | fpr=0.8810 | 7911.9 samples/s | 30.9 steps/s
[Step= 500] | Loss=5.14313 | acc=0.1290 | tpr=0.6890 | fpr=0.8811 | 7909.2 samples/s | 30.9 steps/s
[Step= 550] | Loss=5.14193 | acc=0.1287 | tpr=0.6884 | fpr=0.8815 | 14348.4 samples/s | 56.0 steps/s
Avg test loss: 5.14407, Avg test acc: 0.12863, Avg tpr: 0.68780, Avg fpr: 0.88154, total FA: 122400

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10762 | acc=0.9812 | tpr=0.9425 | fpr=0.0181 | 4179.9 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.11204 | acc=0.9803 | tpr=0.9552 | fpr=0.0192 | 7677.9 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.11642 | acc=0.9793 | tpr=0.9524 | fpr=0.0202 | 7933.9 samples/s | 31.0 steps/s
[Step= 200] | Loss=0.11869 | acc=0.9793 | tpr=0.9563 | fpr=0.0203 | 7990.2 samples/s | 31.2 steps/s
[Step= 250] | Loss=0.11801 | acc=0.9792 | tpr=0.9493 | fpr=0.0203 | 7809.4 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.12037 | acc=0.9788 | tpr=0.9469 | fpr=0.0206 | 7413.7 samples/s | 29.0 steps/s
[Step= 350] | Loss=0.12031 | acc=0.9786 | tpr=0.9461 | fpr=0.0208 | 7732.8 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.12137 | acc=0.9785 | tpr=0.9426 | fpr=0.0208 | 8138.9 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.12408 | acc=0.9782 | tpr=0.9421 | fpr=0.0211 | 8050.3 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.12384 | acc=0.9783 | tpr=0.9432 | fpr=0.0211 | 8118.5 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.12279 | acc=0.9785 | tpr=0.9431 | fpr=0.0209 | 13698.4 samples/s | 53.5 steps/s
Avg test loss: 0.12261, Avg test acc: 0.97850, Avg tpr: 0.94334, Avg fpr: 0.02086, total FA: 2897

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11362 | acc=0.9816 | tpr=0.9027 | fpr=0.0170 | 3992.5 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.11751 | acc=0.9813 | tpr=0.9083 | fpr=0.0173 | 8035.4 samples/s | 31.4 steps/s
[Step= 150] | Loss=0.12236 | acc=0.9803 | tpr=0.9049 | fpr=0.0184 | 8059.3 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.12398 | acc=0.9805 | tpr=0.9148 | fpr=0.0183 | 8093.6 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.12278 | acc=0.9804 | tpr=0.9162 | fpr=0.0184 | 8118.2 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.12523 | acc=0.9800 | tpr=0.9185 | fpr=0.0189 | 7539.3 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.12525 | acc=0.9798 | tpr=0.9217 | fpr=0.0191 | 7341.8 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.12644 | acc=0.9796 | tpr=0.9179 | fpr=0.0193 | 8178.3 samples/s | 31.9 steps/s
[Step= 450] | Loss=0.12966 | acc=0.9793 | tpr=0.9192 | fpr=0.0196 | 8045.2 samples/s | 31.4 steps/s
[Step= 500] | Loss=0.12909 | acc=0.9795 | tpr=0.9220 | fpr=0.0195 | 8196.3 samples/s | 32.0 steps/s
[Step= 550] | Loss=0.12822 | acc=0.9796 | tpr=0.9216 | fpr=0.0193 | 14014.1 samples/s | 54.7 steps/s
Avg test loss: 0.12796, Avg test acc: 0.97964, Avg tpr: 0.92155, Avg fpr: 0.01931, total FA: 2681

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10589 | acc=0.9802 | tpr=0.9381 | fpr=0.0191 | 3938.5 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.10942 | acc=0.9797 | tpr=0.9552 | fpr=0.0198 | 7897.0 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.11321 | acc=0.9784 | tpr=0.9510 | fpr=0.0211 | 8281.3 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.11515 | acc=0.9785 | tpr=0.9552 | fpr=0.0210 | 7972.0 samples/s | 31.1 steps/s
[Step= 250] | Loss=0.11450 | acc=0.9784 | tpr=0.9520 | fpr=0.0212 | 8242.2 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.11687 | acc=0.9780 | tpr=0.9527 | fpr=0.0216 | 8022.8 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.11684 | acc=0.9779 | tpr=0.9537 | fpr=0.0217 | 8122.4 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.11804 | acc=0.9778 | tpr=0.9524 | fpr=0.0217 | 7697.9 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.12083 | acc=0.9776 | tpr=0.9518 | fpr=0.0219 | 7787.6 samples/s | 30.4 steps/s
[Step= 500] | Loss=0.12049 | acc=0.9776 | tpr=0.9533 | fpr=0.0219 | 7659.5 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.11948 | acc=0.9779 | tpr=0.9530 | fpr=0.0217 | 14549.8 samples/s | 56.8 steps/s
Avg test loss: 0.11932, Avg test acc: 0.97790, Avg tpr: 0.95325, Avg fpr: 0.02166, total FA: 3007

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10795 | acc=0.9816 | tpr=0.9204 | fpr=0.0173 | 4151.8 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.11206 | acc=0.9811 | tpr=0.9360 | fpr=0.0180 | 7668.3 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.11652 | acc=0.9802 | tpr=0.9395 | fpr=0.0191 | 8096.1 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.11876 | acc=0.9803 | tpr=0.9486 | fpr=0.0191 | 8108.4 samples/s | 31.7 steps/s
[Step= 250] | Loss=0.11736 | acc=0.9804 | tpr=0.9432 | fpr=0.0189 | 8117.6 samples/s | 31.7 steps/s
[Step= 300] | Loss=0.11907 | acc=0.9802 | tpr=0.9440 | fpr=0.0192 | 7720.8 samples/s | 30.2 steps/s
[Step= 350] | Loss=0.11927 | acc=0.9801 | tpr=0.9461 | fpr=0.0193 | 8180.1 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.12005 | acc=0.9800 | tpr=0.9447 | fpr=0.0193 | 7916.3 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.12301 | acc=0.9797 | tpr=0.9435 | fpr=0.0196 | 8011.9 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.12269 | acc=0.9797 | tpr=0.9449 | fpr=0.0196 | 7806.0 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.12177 | acc=0.9799 | tpr=0.9443 | fpr=0.0195 | 15350.8 samples/s | 60.0 steps/s
Avg test loss: 0.12160, Avg test acc: 0.97989, Avg tpr: 0.94374, Avg fpr: 0.01945, total FA: 2701

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12374 | acc=0.9803 | tpr=0.9248 | fpr=0.0187 | 4152.8 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.12858 | acc=0.9800 | tpr=0.9510 | fpr=0.0194 | 8178.4 samples/s | 31.9 steps/s
[Step= 150] | Loss=0.13356 | acc=0.9791 | tpr=0.9524 | fpr=0.0204 | 7522.1 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.13585 | acc=0.9787 | tpr=0.9574 | fpr=0.0209 | 8090.8 samples/s | 31.6 steps/s
[Step= 250] | Loss=0.13462 | acc=0.9788 | tpr=0.9528 | fpr=0.0207 | 7868.9 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.13743 | acc=0.9784 | tpr=0.9542 | fpr=0.0211 | 7949.9 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.13810 | acc=0.9783 | tpr=0.9555 | fpr=0.0213 | 7547.8 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.13922 | acc=0.9781 | tpr=0.9508 | fpr=0.0214 | 8119.8 samples/s | 31.7 steps/s
[Step= 450] | Loss=0.14248 | acc=0.9777 | tpr=0.9494 | fpr=0.0218 | 7668.2 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.14199 | acc=0.9778 | tpr=0.9498 | fpr=0.0217 | 7756.1 samples/s | 30.3 steps/s
[Step= 550] | Loss=0.14118 | acc=0.9779 | tpr=0.9479 | fpr=0.0215 | 14993.0 samples/s | 58.6 steps/s
Avg test loss: 0.14094, Avg test acc: 0.97792, Avg tpr: 0.94770, Avg fpr: 0.02153, total FA: 2989

server round 40/50

clients selected: [2 3 7 8 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=38001 Epoch=185.2] | Loss=0.01211 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.639 | L2-Norm(final)=13.190 | 3711.4 samples/s | 58.0 steps/s
[Step=38050 Epoch=185.4] | Loss=0.01715 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.643 | L2-Norm(final)=13.190 | 5051.7 samples/s | 78.9 steps/s
[Step=38100 Epoch=185.6] | Loss=0.01871 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.648 | L2-Norm(final)=13.191 | 5095.9 samples/s | 79.6 steps/s
[Step=38150 Epoch=185.9] | Loss=0.01958 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.652 | L2-Norm(final)=13.191 | 5068.7 samples/s | 79.2 steps/s
[Step=38200 Epoch=186.1] | Loss=0.02019 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.656 | L2-Norm(final)=13.191 | 7514.3 samples/s | 117.4 steps/s
[Step=38250 Epoch=186.4] | Loss=0.01996 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.659 | L2-Norm(final)=13.192 | 1791.9 samples/s | 28.0 steps/s
[Step=38300 Epoch=186.6] | Loss=0.01916 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.663 | L2-Norm(final)=13.194 | 5014.9 samples/s | 78.4 steps/s
[Step=38350 Epoch=186.9] | Loss=0.01853 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.666 | L2-Norm(final)=13.196 | 5055.2 samples/s | 79.0 steps/s
[Step=38400 Epoch=187.1] | Loss=0.01802 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.669 | L2-Norm(final)=13.198 | 6109.1 samples/s | 95.5 steps/s
[Step=38450 Epoch=187.3] | Loss=0.01752 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.673 | L2-Norm(final)=13.201 | 1828.1 samples/s | 28.6 steps/s
[Step=38500 Epoch=187.6] | Loss=0.01741 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.676 | L2-Norm(final)=13.203 | 5081.8 samples/s | 79.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=38501 Epoch=187.6] | Loss=0.01234 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.709 | L2-Norm(final)=13.229 | 3744.6 samples/s | 58.5 steps/s
[Step=38550 Epoch=187.8] | Loss=0.01370 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.714 | L2-Norm(final)=13.233 | 4515.5 samples/s | 70.6 steps/s
[Step=38600 Epoch=188.1] | Loss=0.01290 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.720 | L2-Norm(final)=13.237 | 4629.3 samples/s | 72.3 steps/s
[Step=38650 Epoch=188.3] | Loss=0.01302 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.725 | L2-Norm(final)=13.240 | 4614.9 samples/s | 72.1 steps/s
[Step=38700 Epoch=188.6] | Loss=0.01220 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.730 | L2-Norm(final)=13.243 | 6153.2 samples/s | 96.1 steps/s
[Step=38750 Epoch=188.8] | Loss=0.01101 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.734 | L2-Norm(final)=13.246 | 1752.7 samples/s | 27.4 steps/s
[Step=38800 Epoch=189.1] | Loss=0.01017 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.738 | L2-Norm(final)=13.250 | 4416.7 samples/s | 69.0 steps/s
[Step=38850 Epoch=189.3] | Loss=0.00958 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.742 | L2-Norm(final)=13.253 | 4551.4 samples/s | 71.1 steps/s
[Step=38900 Epoch=189.5] | Loss=0.00920 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.745 | L2-Norm(final)=13.256 | 5570.0 samples/s | 87.0 steps/s
[Step=38950 Epoch=189.8] | Loss=0.00870 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.749 | L2-Norm(final)=13.259 | 1789.9 samples/s | 28.0 steps/s
[Step=39000 Epoch=190.0] | Loss=0.00823 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.752 | L2-Norm(final)=13.262 | 4499.2 samples/s | 70.3 steps/s
[Step=39050 Epoch=190.3] | Loss=0.00793 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.756 | L2-Norm(final)=13.265 | 4623.6 samples/s | 72.2 steps/s
[Step=39100 Epoch=190.5] | Loss=0.00768 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.759 | L2-Norm(final)=13.268 | 5258.1 samples/s | 82.2 steps/s
[Step=39150 Epoch=190.8] | Loss=0.00737 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.762 | L2-Norm(final)=13.271 | 1816.5 samples/s | 28.4 steps/s
[Step=39200 Epoch=191.0] | Loss=0.00713 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.765 | L2-Norm(final)=13.273 | 4554.8 samples/s | 71.2 steps/s
[Step=39250 Epoch=191.2] | Loss=0.00694 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.768 | L2-Norm(final)=13.276 | 4661.7 samples/s | 72.8 steps/s
[Step=39300 Epoch=191.5] | Loss=0.00672 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.771 | L2-Norm(final)=13.279 | 5109.1 samples/s | 79.8 steps/s
[Step=39350 Epoch=191.7] | Loss=0.00655 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.774 | L2-Norm(final)=13.281 | 1799.5 samples/s | 28.1 steps/s
[Step=39400 Epoch=192.0] | Loss=0.00633 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.777 | L2-Norm(final)=13.284 | 4425.0 samples/s | 69.1 steps/s
[Step=39450 Epoch=192.2] | Loss=0.00619 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.779 | L2-Norm(final)=13.287 | 4608.0 samples/s | 72.0 steps/s
[Step=39500 Epoch=192.5] | Loss=0.00606 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.782 | L2-Norm(final)=13.289 | 4735.1 samples/s | 74.0 steps/s
[Step=39550 Epoch=192.7] | Loss=0.00594 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.785 | L2-Norm(final)=13.292 | 1896.1 samples/s | 29.6 steps/s
[Step=39600 Epoch=193.0] | Loss=0.00580 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.787 | L2-Norm(final)=13.294 | 4621.3 samples/s | 72.2 steps/s
[Step=39650 Epoch=193.2] | Loss=0.00567 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.790 | L2-Norm(final)=13.297 | 4537.5 samples/s | 70.9 steps/s
[Step=39700 Epoch=193.4] | Loss=0.00560 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.792 | L2-Norm(final)=13.299 | 4611.9 samples/s | 72.1 steps/s
[Step=39750 Epoch=193.7] | Loss=0.00552 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.795 | L2-Norm(final)=13.301 | 1928.4 samples/s | 30.1 steps/s
[Step=39800 Epoch=193.9] | Loss=0.00543 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.797 | L2-Norm(final)=13.304 | 4596.0 samples/s | 71.8 steps/s
[Step=39850 Epoch=194.2] | Loss=0.00532 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.800 | L2-Norm(final)=13.306 | 4578.8 samples/s | 71.5 steps/s
[Step=39900 Epoch=194.4] | Loss=0.00525 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.802 | L2-Norm(final)=13.308 | 4352.7 samples/s | 68.0 steps/s
[Step=39950 Epoch=194.7] | Loss=0.00518 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.804 | L2-Norm(final)=13.310 | 1864.8 samples/s | 29.1 steps/s
[Step=40000 Epoch=194.9] | Loss=0.00507 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.806 | L2-Norm(final)=13.312 | 4529.6 samples/s | 70.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step40000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=38001 Epoch=185.3] | Loss=0.01886 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.639 | L2-Norm(final)=12.722 | 3692.9 samples/s | 57.7 steps/s
[Step=38050 Epoch=185.6] | Loss=0.02565 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.643 | L2-Norm(final)=12.718 | 4986.5 samples/s | 77.9 steps/s
[Step=38100 Epoch=185.8] | Loss=0.02435 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.647 | L2-Norm(final)=12.717 | 5134.5 samples/s | 80.2 steps/s
[Step=38150 Epoch=186.0] | Loss=0.02242 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.651 | L2-Norm(final)=12.718 | 5173.9 samples/s | 80.8 steps/s
[Step=38200 Epoch=186.3] | Loss=0.02096 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.654 | L2-Norm(final)=12.719 | 7407.9 samples/s | 115.7 steps/s
[Step=38250 Epoch=186.5] | Loss=0.02093 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.658 | L2-Norm(final)=12.721 | 1821.6 samples/s | 28.5 steps/s
[Step=38300 Epoch=186.8] | Loss=0.02001 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.661 | L2-Norm(final)=12.722 | 5095.6 samples/s | 79.6 steps/s
[Step=38350 Epoch=187.0] | Loss=0.01953 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.664 | L2-Norm(final)=12.724 | 5158.5 samples/s | 80.6 steps/s
[Step=38400 Epoch=187.3] | Loss=0.01877 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.667 | L2-Norm(final)=12.726 | 6590.3 samples/s | 103.0 steps/s
[Step=38450 Epoch=187.5] | Loss=0.01816 | Reg=0.00094 | acc=0.9531 | L2-Norm=9.670 | L2-Norm(final)=12.728 | 1832.5 samples/s | 28.6 steps/s
[Step=38500 Epoch=187.7] | Loss=0.01775 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.673 | L2-Norm(final)=12.731 | 5092.1 samples/s | 79.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=38501 Epoch=187.8] | Loss=0.00936 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.703 | L2-Norm(final)=12.756 | 3695.4 samples/s | 57.7 steps/s
[Step=38550 Epoch=188.0] | Loss=0.01471 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.709 | L2-Norm(final)=12.760 | 4580.2 samples/s | 71.6 steps/s
[Step=38600 Epoch=188.2] | Loss=0.01411 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.715 | L2-Norm(final)=12.763 | 4593.2 samples/s | 71.8 steps/s
[Step=38650 Epoch=188.5] | Loss=0.01311 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.720 | L2-Norm(final)=12.766 | 4660.7 samples/s | 72.8 steps/s
[Step=38700 Epoch=188.7] | Loss=0.01248 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.725 | L2-Norm(final)=12.769 | 6292.3 samples/s | 98.3 steps/s
[Step=38750 Epoch=189.0] | Loss=0.01100 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.730 | L2-Norm(final)=12.772 | 1778.0 samples/s | 27.8 steps/s
[Step=38800 Epoch=189.2] | Loss=0.01002 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.734 | L2-Norm(final)=12.775 | 4571.0 samples/s | 71.4 steps/s
[Step=38850 Epoch=189.5] | Loss=0.00946 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.738 | L2-Norm(final)=12.778 | 4623.6 samples/s | 72.2 steps/s
[Step=38900 Epoch=189.7] | Loss=0.00908 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.742 | L2-Norm(final)=12.781 | 5765.7 samples/s | 90.1 steps/s
[Step=38950 Epoch=189.9] | Loss=0.00856 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.745 | L2-Norm(final)=12.784 | 1769.2 samples/s | 27.6 steps/s
[Step=39000 Epoch=190.2] | Loss=0.00813 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.749 | L2-Norm(final)=12.787 | 4715.5 samples/s | 73.7 steps/s
[Step=39050 Epoch=190.4] | Loss=0.00792 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.752 | L2-Norm(final)=12.789 | 4732.2 samples/s | 73.9 steps/s
[Step=39100 Epoch=190.7] | Loss=0.00755 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.755 | L2-Norm(final)=12.792 | 5011.9 samples/s | 78.3 steps/s
[Step=39150 Epoch=190.9] | Loss=0.00720 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.758 | L2-Norm(final)=12.795 | 1751.6 samples/s | 27.4 steps/s
[Step=39200 Epoch=191.2] | Loss=0.00694 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.761 | L2-Norm(final)=12.797 | 4225.1 samples/s | 66.0 steps/s
[Step=39250 Epoch=191.4] | Loss=0.00672 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.764 | L2-Norm(final)=12.800 | 4186.0 samples/s | 65.4 steps/s
[Step=39300 Epoch=191.6] | Loss=0.00655 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.767 | L2-Norm(final)=12.802 | 4576.8 samples/s | 71.5 steps/s
[Step=39350 Epoch=191.9] | Loss=0.00633 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.769 | L2-Norm(final)=12.805 | 1990.3 samples/s | 31.1 steps/s
[Step=39400 Epoch=192.1] | Loss=0.00617 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.772 | L2-Norm(final)=12.807 | 4922.2 samples/s | 76.9 steps/s
[Step=39450 Epoch=192.4] | Loss=0.00605 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.775 | L2-Norm(final)=12.810 | 4847.4 samples/s | 75.7 steps/s
[Step=39500 Epoch=192.6] | Loss=0.00590 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.777 | L2-Norm(final)=12.812 | 4996.9 samples/s | 78.1 steps/s
[Step=39550 Epoch=192.9] | Loss=0.00571 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.780 | L2-Norm(final)=12.814 | 2036.2 samples/s | 31.8 steps/s
[Step=39600 Epoch=193.1] | Loss=0.00560 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.782 | L2-Norm(final)=12.817 | 5000.7 samples/s | 78.1 steps/s
[Step=39650 Epoch=193.4] | Loss=0.00546 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.785 | L2-Norm(final)=12.819 | 4995.4 samples/s | 78.1 steps/s
[Step=39700 Epoch=193.6] | Loss=0.00536 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.787 | L2-Norm(final)=12.821 | 4822.7 samples/s | 75.4 steps/s
[Step=39750 Epoch=193.8] | Loss=0.00527 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.790 | L2-Norm(final)=12.823 | 2041.4 samples/s | 31.9 steps/s
[Step=39800 Epoch=194.1] | Loss=0.00516 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.792 | L2-Norm(final)=12.826 | 5108.6 samples/s | 79.8 steps/s
[Step=39850 Epoch=194.3] | Loss=0.00505 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.794 | L2-Norm(final)=12.828 | 4973.8 samples/s | 77.7 steps/s
[Step=39900 Epoch=194.6] | Loss=0.00499 | Reg=0.00096 | acc=0.9844 | L2-Norm=9.796 | L2-Norm(final)=12.830 | 4837.2 samples/s | 75.6 steps/s
[Step=39950 Epoch=194.8] | Loss=0.00492 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.799 | L2-Norm(final)=12.832 | 2057.1 samples/s | 32.1 steps/s
[Step=40000 Epoch=195.1] | Loss=0.00484 | Reg=0.00096 | acc=1.0000 | L2-Norm=9.801 | L2-Norm(final)=12.834 | 4890.3 samples/s | 76.4 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step40000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=40001 Epoch=382.0] | Loss=0.00344 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.639 | L2-Norm(final)=8.551 | 3750.0 samples/s | 58.6 steps/s
[Step=40050 Epoch=382.5] | Loss=0.00083 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.643 | L2-Norm(final)=8.553 | 5062.8 samples/s | 79.1 steps/s
[Step=40100 Epoch=382.9] | Loss=0.00049 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.644 | L2-Norm(final)=8.556 | 7173.6 samples/s | 112.1 steps/s
[Step=40150 Epoch=383.4] | Loss=0.00037 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.644 | L2-Norm(final)=8.559 | 1836.9 samples/s | 28.7 steps/s
[Step=40200 Epoch=383.9] | Loss=0.00030 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.644 | L2-Norm(final)=8.562 | 6929.4 samples/s | 108.3 steps/s
[Step=40250 Epoch=384.4] | Loss=0.00026 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.643 | L2-Norm(final)=8.564 | 1910.4 samples/s | 29.9 steps/s
[Step=40300 Epoch=384.8] | Loss=0.00023 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.643 | L2-Norm(final)=8.567 | 6310.9 samples/s | 98.6 steps/s
[Step=40350 Epoch=385.3] | Loss=0.00021 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.642 | L2-Norm(final)=8.569 | 1922.2 samples/s | 30.0 steps/s
[Step=40400 Epoch=385.8] | Loss=0.00019 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.641 | L2-Norm(final)=8.571 | 6036.0 samples/s | 94.3 steps/s
[Step=40450 Epoch=386.3] | Loss=0.00018 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.641 | L2-Norm(final)=8.573 | 1948.9 samples/s | 30.5 steps/s
[Step=40500 Epoch=386.8] | Loss=0.00017 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.640 | L2-Norm(final)=8.575 | 5715.8 samples/s | 89.3 steps/s
All layers training...
LR=0.00006, len=1
[Step=40501 Epoch=386.8] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.632 | L2-Norm(final)=8.595 | 3835.3 samples/s | 59.9 steps/s
[Step=40550 Epoch=387.2] | Loss=0.00005 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.629 | L2-Norm(final)=8.597 | 4476.9 samples/s | 70.0 steps/s
[Step=40600 Epoch=387.7] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.625 | L2-Norm(final)=8.598 | 6429.1 samples/s | 100.5 steps/s
[Step=40650 Epoch=388.2] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.620 | L2-Norm(final)=8.599 | 1801.0 samples/s | 28.1 steps/s
[Step=40700 Epoch=388.7] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.614 | L2-Norm(final)=8.599 | 5947.2 samples/s | 92.9 steps/s
[Step=40750 Epoch=389.1] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.608 | L2-Norm(final)=8.600 | 1826.6 samples/s | 28.5 steps/s
[Step=40800 Epoch=389.6] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.601 | L2-Norm(final)=8.600 | 5668.7 samples/s | 88.6 steps/s
[Step=40850 Epoch=390.1] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.595 | L2-Norm(final)=8.601 | 1861.9 samples/s | 29.1 steps/s
[Step=40900 Epoch=390.6] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.588 | L2-Norm(final)=8.601 | 5304.5 samples/s | 82.9 steps/s
[Step=40950 Epoch=391.0] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.581 | L2-Norm(final)=8.601 | 1913.1 samples/s | 29.9 steps/s
[Step=41000 Epoch=391.5] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.574 | L2-Norm(final)=8.601 | 5038.7 samples/s | 78.7 steps/s
[Step=41050 Epoch=392.0] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.567 | L2-Norm(final)=8.602 | 1945.0 samples/s | 30.4 steps/s
[Step=41100 Epoch=392.5] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.560 | L2-Norm(final)=8.602 | 4811.0 samples/s | 75.2 steps/s
[Step=41150 Epoch=393.0] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.552 | L2-Norm(final)=8.602 | 1985.8 samples/s | 31.0 steps/s
[Step=41200 Epoch=393.4] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.545 | L2-Norm(final)=8.602 | 4765.2 samples/s | 74.5 steps/s
[Step=41250 Epoch=393.9] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.537 | L2-Norm(final)=8.602 | 2008.5 samples/s | 31.4 steps/s
[Step=41300 Epoch=394.4] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.530 | L2-Norm(final)=8.603 | 4716.7 samples/s | 73.7 steps/s
[Step=41350 Epoch=394.9] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.522 | L2-Norm(final)=8.603 | 2017.2 samples/s | 31.5 steps/s
[Step=41400 Epoch=395.3] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.514 | L2-Norm(final)=8.603 | 4690.2 samples/s | 73.3 steps/s
[Step=41450 Epoch=395.8] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.506 | L2-Norm(final)=8.603 | 1997.0 samples/s | 31.2 steps/s
[Step=41500 Epoch=396.3] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.498 | L2-Norm(final)=8.603 | 4784.4 samples/s | 74.8 steps/s
[Step=41550 Epoch=396.8] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.489 | L2-Norm(final)=8.604 | 6870.5 samples/s | 107.4 steps/s
[Step=41600 Epoch=397.3] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.481 | L2-Norm(final)=8.604 | 1757.4 samples/s | 27.5 steps/s
[Step=41650 Epoch=397.7] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.472 | L2-Norm(final)=8.604 | 6476.3 samples/s | 101.2 steps/s
[Step=41700 Epoch=398.2] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.464 | L2-Norm(final)=8.604 | 1804.5 samples/s | 28.2 steps/s
[Step=41750 Epoch=398.7] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.455 | L2-Norm(final)=8.604 | 5969.7 samples/s | 93.3 steps/s
[Step=41800 Epoch=399.2] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.446 | L2-Norm(final)=8.604 | 1831.2 samples/s | 28.6 steps/s
[Step=41850 Epoch=399.6] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.437 | L2-Norm(final)=8.605 | 5605.3 samples/s | 87.6 steps/s
[Step=41900 Epoch=400.1] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.428 | L2-Norm(final)=8.605 | 1875.5 samples/s | 29.3 steps/s
[Step=41950 Epoch=400.6] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.419 | L2-Norm(final)=8.605 | 5293.5 samples/s | 82.7 steps/s
[Step=42000 Epoch=401.1] | Loss=0.00000 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.409 | L2-Norm(final)=8.605 | 1914.7 samples/s | 29.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step42000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=40001 Epoch=376.9] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.639 | L2-Norm(final)=9.061 | 3852.4 samples/s | 60.2 steps/s
[Step=40050 Epoch=377.4] | Loss=0.00082 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.643 | L2-Norm(final)=9.061 | 4888.3 samples/s | 76.4 steps/s
[Step=40100 Epoch=377.9] | Loss=0.00059 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.647 | L2-Norm(final)=9.066 | 7225.2 samples/s | 112.9 steps/s
[Step=40150 Epoch=378.3] | Loss=0.00048 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.649 | L2-Norm(final)=9.070 | 1877.4 samples/s | 29.3 steps/s
[Step=40200 Epoch=378.8] | Loss=0.00039 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.650 | L2-Norm(final)=9.073 | 6575.7 samples/s | 102.7 steps/s
[Step=40250 Epoch=379.3] | Loss=0.00033 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.651 | L2-Norm(final)=9.076 | 1945.2 samples/s | 30.4 steps/s
[Step=40300 Epoch=379.7] | Loss=0.00030 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.651 | L2-Norm(final)=9.079 | 5990.2 samples/s | 93.6 steps/s
[Step=40350 Epoch=380.2] | Loss=0.00027 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.651 | L2-Norm(final)=9.081 | 1981.0 samples/s | 31.0 steps/s
[Step=40400 Epoch=380.7] | Loss=0.00024 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.651 | L2-Norm(final)=9.084 | 5508.1 samples/s | 86.1 steps/s
[Step=40450 Epoch=381.2] | Loss=0.00023 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.650 | L2-Norm(final)=9.086 | 2035.8 samples/s | 31.8 steps/s
[Step=40500 Epoch=381.6] | Loss=0.00021 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.650 | L2-Norm(final)=9.089 | 5284.3 samples/s | 82.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=40501 Epoch=381.6] | Loss=0.00032 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.643 | L2-Norm(final)=9.112 | 3801.0 samples/s | 59.4 steps/s
[Step=40550 Epoch=382.1] | Loss=0.00007 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.643 | L2-Norm(final)=9.114 | 4550.3 samples/s | 71.1 steps/s
[Step=40600 Epoch=382.6] | Loss=0.00005 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.640 | L2-Norm(final)=9.115 | 6282.8 samples/s | 98.2 steps/s
[Step=40650 Epoch=383.0] | Loss=0.00004 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.636 | L2-Norm(final)=9.116 | 1824.1 samples/s | 28.5 steps/s
[Step=40700 Epoch=383.5] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.630 | L2-Norm(final)=9.117 | 5752.1 samples/s | 89.9 steps/s
[Step=40750 Epoch=384.0] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.625 | L2-Norm(final)=9.117 | 1878.6 samples/s | 29.4 steps/s
[Step=40800 Epoch=384.5] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.619 | L2-Norm(final)=9.118 | 5261.6 samples/s | 82.2 steps/s
[Step=40850 Epoch=384.9] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.612 | L2-Norm(final)=9.118 | 1943.3 samples/s | 30.4 steps/s
[Step=40900 Epoch=385.4] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=9.118 | 4823.2 samples/s | 75.4 steps/s
[Step=40950 Epoch=385.9] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.600 | L2-Norm(final)=9.119 | 1977.1 samples/s | 30.9 steps/s
[Step=41000 Epoch=386.3] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=9.119 | 4844.4 samples/s | 75.7 steps/s
[Step=41050 Epoch=386.8] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.586 | L2-Norm(final)=9.119 | 2003.6 samples/s | 31.3 steps/s
[Step=41100 Epoch=387.3] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.579 | L2-Norm(final)=9.119 | 4819.4 samples/s | 75.3 steps/s
[Step=41150 Epoch=387.8] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.572 | L2-Norm(final)=9.120 | 2016.8 samples/s | 31.5 steps/s
[Step=41200 Epoch=388.2] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.565 | L2-Norm(final)=9.120 | 4655.1 samples/s | 72.7 steps/s
[Step=41250 Epoch=388.7] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.558 | L2-Norm(final)=9.120 | 2143.2 samples/s | 33.5 steps/s
[Step=41300 Epoch=389.2] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.551 | L2-Norm(final)=9.120 | 4168.4 samples/s | 65.1 steps/s
[Step=41350 Epoch=389.6] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.544 | L2-Norm(final)=9.120 | 6398.1 samples/s | 100.0 steps/s
[Step=41400 Epoch=390.1] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=9.121 | 1817.2 samples/s | 28.4 steps/s
[Step=41450 Epoch=390.6] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.528 | L2-Norm(final)=9.121 | 5818.6 samples/s | 90.9 steps/s
[Step=41500 Epoch=391.0] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.521 | L2-Norm(final)=9.121 | 1866.3 samples/s | 29.2 steps/s
[Step=41550 Epoch=391.5] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.513 | L2-Norm(final)=9.121 | 5304.9 samples/s | 82.9 steps/s
[Step=41600 Epoch=392.0] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.505 | L2-Norm(final)=9.121 | 1920.1 samples/s | 30.0 steps/s
[Step=41650 Epoch=392.5] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.497 | L2-Norm(final)=9.122 | 4910.7 samples/s | 76.7 steps/s
[Step=41700 Epoch=392.9] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.489 | L2-Norm(final)=9.122 | 1950.6 samples/s | 30.5 steps/s
[Step=41750 Epoch=393.4] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.480 | L2-Norm(final)=9.122 | 4820.6 samples/s | 75.3 steps/s
[Step=41800 Epoch=393.9] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.472 | L2-Norm(final)=9.122 | 2008.9 samples/s | 31.4 steps/s
[Step=41850 Epoch=394.3] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.464 | L2-Norm(final)=9.122 | 4674.5 samples/s | 73.0 steps/s
[Step=41900 Epoch=394.8] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.455 | L2-Norm(final)=9.123 | 2016.4 samples/s | 31.5 steps/s
[Step=41950 Epoch=395.3] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.446 | L2-Norm(final)=9.123 | 4633.2 samples/s | 72.4 steps/s
[Step=42000 Epoch=395.8] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.437 | L2-Norm(final)=9.123 | 2057.1 samples/s | 32.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step42000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=42001 Epoch=400.3] | Loss=0.00019 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.639 | L2-Norm(final)=9.655 | 4047.9 samples/s | 63.2 steps/s
[Step=42050 Epoch=400.8] | Loss=0.00326 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.649 | L2-Norm(final)=9.656 | 4660.3 samples/s | 72.8 steps/s
[Step=42100 Epoch=401.3] | Loss=0.00210 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.657 | L2-Norm(final)=9.660 | 7520.2 samples/s | 117.5 steps/s
[Step=42150 Epoch=401.7] | Loss=0.00151 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.661 | L2-Norm(final)=9.664 | 1801.1 samples/s | 28.1 steps/s
[Step=42200 Epoch=402.2] | Loss=0.00122 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.664 | L2-Norm(final)=9.667 | 6802.2 samples/s | 106.3 steps/s
[Step=42250 Epoch=402.7] | Loss=0.00101 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.666 | L2-Norm(final)=9.670 | 1713.8 samples/s | 26.8 steps/s
[Step=42300 Epoch=403.2] | Loss=0.00088 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.667 | L2-Norm(final)=9.673 | 5910.0 samples/s | 92.3 steps/s
[Step=42350 Epoch=403.6] | Loss=0.00078 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.668 | L2-Norm(final)=9.675 | 1879.7 samples/s | 29.4 steps/s
[Step=42400 Epoch=404.1] | Loss=0.00071 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.669 | L2-Norm(final)=9.678 | 5836.0 samples/s | 91.2 steps/s
[Step=42450 Epoch=404.6] | Loss=0.00065 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.670 | L2-Norm(final)=9.680 | 1958.3 samples/s | 30.6 steps/s
[Step=42500 Epoch=405.1] | Loss=0.00060 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.671 | L2-Norm(final)=9.682 | 5707.1 samples/s | 89.2 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=405.1] | Loss=0.00005 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.677 | L2-Norm(final)=9.705 | 3827.3 samples/s | 59.8 steps/s
[Step=42550 Epoch=405.5] | Loss=0.00012 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.677 | L2-Norm(final)=9.706 | 4593.0 samples/s | 71.8 steps/s
[Step=42600 Epoch=406.0] | Loss=0.00008 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.677 | L2-Norm(final)=9.707 | 6319.9 samples/s | 98.7 steps/s
[Step=42650 Epoch=406.5] | Loss=0.00006 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.675 | L2-Norm(final)=9.708 | 1806.4 samples/s | 28.2 steps/s
[Step=42700 Epoch=407.0] | Loss=0.00005 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.672 | L2-Norm(final)=9.709 | 5899.5 samples/s | 92.2 steps/s
[Step=42750 Epoch=407.4] | Loss=0.00004 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.669 | L2-Norm(final)=9.709 | 1865.3 samples/s | 29.1 steps/s
[Step=42800 Epoch=407.9] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.665 | L2-Norm(final)=9.709 | 5444.1 samples/s | 85.1 steps/s
[Step=42850 Epoch=408.4] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.661 | L2-Norm(final)=9.709 | 1864.0 samples/s | 29.1 steps/s
[Step=42900 Epoch=408.9] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.656 | L2-Norm(final)=9.710 | 5325.9 samples/s | 83.2 steps/s
[Step=42950 Epoch=409.4] | Loss=0.00003 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.652 | L2-Norm(final)=9.710 | 1917.9 samples/s | 30.0 steps/s
[Step=43000 Epoch=409.8] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.647 | L2-Norm(final)=9.710 | 4965.6 samples/s | 77.6 steps/s
[Step=43050 Epoch=410.3] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.643 | L2-Norm(final)=9.710 | 1967.9 samples/s | 30.7 steps/s
[Step=43100 Epoch=410.8] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.638 | L2-Norm(final)=9.711 | 4747.7 samples/s | 74.2 steps/s
[Step=43150 Epoch=411.3] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.633 | L2-Norm(final)=9.711 | 1968.3 samples/s | 30.8 steps/s
[Step=43200 Epoch=411.7] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.628 | L2-Norm(final)=9.711 | 4734.9 samples/s | 74.0 steps/s
[Step=43250 Epoch=412.2] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.623 | L2-Norm(final)=9.711 | 1999.4 samples/s | 31.2 steps/s
[Step=43300 Epoch=412.7] | Loss=0.00002 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.618 | L2-Norm(final)=9.711 | 4722.6 samples/s | 73.8 steps/s
[Step=43350 Epoch=413.2] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.612 | L2-Norm(final)=9.711 | 2034.0 samples/s | 31.8 steps/s
[Step=43400 Epoch=413.6] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.607 | L2-Norm(final)=9.711 | 4552.1 samples/s | 71.1 steps/s
[Step=43450 Epoch=414.1] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.602 | L2-Norm(final)=9.712 | 2021.0 samples/s | 31.6 steps/s
[Step=43500 Epoch=414.6] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.596 | L2-Norm(final)=9.712 | 4686.8 samples/s | 73.2 steps/s
[Step=43550 Epoch=415.1] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.590 | L2-Norm(final)=9.712 | 6888.8 samples/s | 107.6 steps/s
[Step=43600 Epoch=415.5] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.585 | L2-Norm(final)=9.712 | 1762.0 samples/s | 27.5 steps/s
[Step=43650 Epoch=416.0] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.579 | L2-Norm(final)=9.712 | 6447.7 samples/s | 100.7 steps/s
[Step=43700 Epoch=416.5] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.573 | L2-Norm(final)=9.712 | 1802.1 samples/s | 28.2 steps/s
[Step=43750 Epoch=417.0] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.567 | L2-Norm(final)=9.712 | 5950.2 samples/s | 93.0 steps/s
[Step=43800 Epoch=417.5] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.560 | L2-Norm(final)=9.713 | 1838.5 samples/s | 28.7 steps/s
[Step=43850 Epoch=417.9] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.554 | L2-Norm(final)=9.713 | 5577.4 samples/s | 87.1 steps/s
[Step=43900 Epoch=418.4] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.548 | L2-Norm(final)=9.713 | 1876.7 samples/s | 29.3 steps/s
[Step=43950 Epoch=418.9] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.541 | L2-Norm(final)=9.713 | 5285.5 samples/s | 82.6 steps/s
[Step=44000 Epoch=419.4] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.535 | L2-Norm(final)=9.713 | 1914.8 samples/s | 29.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step44000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07974 | acc=0.9621 | tpr=0.9682 | fpr=0.0510 | 4371.8 samples/s | 17.1 steps/s
Avg test loss: 0.08311, Avg test acc: 0.96013, Avg tpr: 0.96672, Avg fpr: 0.05435, total FA: 424

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08460 | acc=0.9618 | tpr=0.9732 | fpr=0.0629 | 4380.1 samples/s | 17.1 steps/s
Avg test loss: 0.08895, Avg test acc: 0.96218, Avg tpr: 0.97354, Avg fpr: 0.06281, total FA: 490

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08247 | acc=0.9614 | tpr=0.9698 | fpr=0.0567 | 4496.9 samples/s | 17.6 steps/s
Avg test loss: 0.08672, Avg test acc: 0.95997, Avg tpr: 0.96783, Avg fpr: 0.05730, total FA: 447

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.07749 | acc=0.9620 | tpr=0.9686 | fpr=0.0523 | 4417.9 samples/s | 17.3 steps/s
Avg test loss: 0.08169, Avg test acc: 0.96101, Avg tpr: 0.96748, Avg fpr: 0.05320, total FA: 415

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08419 | acc=0.9631 | tpr=0.9728 | fpr=0.0580 | 4413.5 samples/s | 17.2 steps/s
Avg test loss: 0.09219, Avg test acc: 0.96117, Avg tpr: 0.97132, Avg fpr: 0.06115, total FA: 477

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.21816 | acc=0.2950 | tpr=0.0027 | fpr=0.0704 | 4399.7 samples/s | 17.2 steps/s
Avg test loss: 5.23691, Avg test acc: 0.29313, Avg tpr: 0.00356, Avg fpr: 0.06999, total FA: 546

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.02254 | acc=0.3140 | tpr=0.0037 | fpr=0.0121 | 4412.5 samples/s | 17.2 steps/s
Avg test loss: 5.03125, Avg test acc: 0.31120, Avg tpr: 0.00408, Avg fpr: 0.01333, total FA: 104

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.09399 | acc=0.3040 | tpr=0.0055 | fpr=0.0478 | 4387.2 samples/s | 17.1 steps/s
Avg test loss: 5.10431, Avg test acc: 0.30155, Avg tpr: 0.00618, Avg fpr: 0.04884, total FA: 381

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.30738 | acc=0.3048 | tpr=0.0034 | fpr=0.0406 | 4390.2 samples/s | 17.1 steps/s
Avg test loss: 5.32285, Avg test acc: 0.30159, Avg tpr: 0.00414, Avg fpr: 0.04423, total FA: 345

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.85580 | acc=0.3139 | tpr=0.0030 | fpr=0.0109 | 4404.4 samples/s | 17.2 steps/s
Avg test loss: 4.86609, Avg test acc: 0.31120, Avg tpr: 0.00338, Avg fpr: 0.01179, total FA: 92

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.72275 | acc=0.1320 | tpr=0.8230 | fpr=0.8804 | 4408.2 samples/s | 17.2 steps/s
[Step= 100] | Loss=4.67462 | acc=0.1350 | tpr=0.8060 | fpr=0.8776 | 8860.1 samples/s | 34.6 steps/s
[Step= 150] | Loss=4.67551 | acc=0.1338 | tpr=0.8228 | fpr=0.8789 | 8455.8 samples/s | 33.0 steps/s
[Step= 200] | Loss=4.67493 | acc=0.1330 | tpr=0.8208 | fpr=0.8795 | 8715.1 samples/s | 34.0 steps/s
[Step= 250] | Loss=4.67950 | acc=0.1343 | tpr=0.8227 | fpr=0.8782 | 8337.4 samples/s | 32.6 steps/s
[Step= 300] | Loss=4.67459 | acc=0.1342 | tpr=0.8189 | fpr=0.8782 | 8618.6 samples/s | 33.7 steps/s
[Step= 350] | Loss=4.67051 | acc=0.1337 | tpr=0.8153 | fpr=0.8787 | 8576.7 samples/s | 33.5 steps/s
[Step= 400] | Loss=4.67389 | acc=0.1339 | tpr=0.8129 | fpr=0.8784 | 8688.3 samples/s | 33.9 steps/s
[Step= 450] | Loss=4.67614 | acc=0.1337 | tpr=0.8092 | fpr=0.8785 | 8538.8 samples/s | 33.4 steps/s
[Step= 500] | Loss=4.67901 | acc=0.1336 | tpr=0.8093 | fpr=0.8786 | 8621.2 samples/s | 33.7 steps/s
[Step= 550] | Loss=4.67745 | acc=0.1334 | tpr=0.8114 | fpr=0.8790 | 15732.2 samples/s | 61.5 steps/s
Avg test loss: 4.67916, Avg test acc: 0.13328, Avg tpr: 0.81062, Avg fpr: 0.87903, total FA: 122052

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.98266 | acc=0.1357 | tpr=0.7965 | fpr=0.8762 | 4387.1 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.93114 | acc=0.1381 | tpr=0.7804 | fpr=0.8739 | 8723.6 samples/s | 34.1 steps/s
[Step= 150] | Loss=4.93290 | acc=0.1366 | tpr=0.7824 | fpr=0.8753 | 8801.4 samples/s | 34.4 steps/s
[Step= 200] | Loss=4.93346 | acc=0.1365 | tpr=0.7825 | fpr=0.8753 | 8651.2 samples/s | 33.8 steps/s
[Step= 250] | Loss=4.93309 | acc=0.1373 | tpr=0.7799 | fpr=0.8744 | 8646.0 samples/s | 33.8 steps/s
[Step= 300] | Loss=4.92990 | acc=0.1368 | tpr=0.7811 | fpr=0.8750 | 8663.9 samples/s | 33.8 steps/s
[Step= 350] | Loss=4.92459 | acc=0.1364 | tpr=0.7802 | fpr=0.8753 | 9184.0 samples/s | 35.9 steps/s
[Step= 400] | Loss=4.92582 | acc=0.1361 | tpr=0.7735 | fpr=0.8755 | 8211.6 samples/s | 32.1 steps/s
[Step= 450] | Loss=4.93064 | acc=0.1361 | tpr=0.7707 | fpr=0.8755 | 8478.9 samples/s | 33.1 steps/s
[Step= 500] | Loss=4.93583 | acc=0.1357 | tpr=0.7705 | fpr=0.8757 | 8813.7 samples/s | 34.4 steps/s
[Step= 550] | Loss=4.93403 | acc=0.1357 | tpr=0.7728 | fpr=0.8758 | 14941.0 samples/s | 58.4 steps/s
Avg test loss: 4.93554, Avg test acc: 0.13571, Avg tpr: 0.77219, Avg fpr: 0.87586, total FA: 121612

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.31116 | acc=0.1277 | tpr=0.7832 | fpr=0.8840 | 4382.4 samples/s | 17.1 steps/s
[Step= 100] | Loss=5.25651 | acc=0.1302 | tpr=0.7761 | fpr=0.8818 | 8634.3 samples/s | 33.7 steps/s
[Step= 150] | Loss=5.25844 | acc=0.1283 | tpr=0.7968 | fpr=0.8841 | 8763.9 samples/s | 34.2 steps/s
[Step= 200] | Loss=5.25945 | acc=0.1271 | tpr=0.7978 | fpr=0.8851 | 8440.1 samples/s | 33.0 steps/s
[Step= 250] | Loss=5.25900 | acc=0.1278 | tpr=0.7983 | fpr=0.8844 | 9087.5 samples/s | 35.5 steps/s
[Step= 300] | Loss=5.25519 | acc=0.1276 | tpr=0.7993 | fpr=0.8846 | 8187.4 samples/s | 32.0 steps/s
[Step= 350] | Loss=5.25322 | acc=0.1276 | tpr=0.8003 | fpr=0.8846 | 8726.6 samples/s | 34.1 steps/s
[Step= 400] | Loss=5.25643 | acc=0.1278 | tpr=0.8014 | fpr=0.8844 | 8617.4 samples/s | 33.7 steps/s
[Step= 450] | Loss=5.26082 | acc=0.1273 | tpr=0.7965 | fpr=0.8849 | 8490.5 samples/s | 33.2 steps/s
[Step= 500] | Loss=5.26187 | acc=0.1272 | tpr=0.7982 | fpr=0.8849 | 8581.3 samples/s | 33.5 steps/s
[Step= 550] | Loss=5.26060 | acc=0.1269 | tpr=0.8034 | fpr=0.8854 | 15425.2 samples/s | 60.3 steps/s
Avg test loss: 5.26197, Avg test acc: 0.12687, Avg tpr: 0.80269, Avg fpr: 0.88541, total FA: 122938

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.68934 | acc=0.1411 | tpr=0.7478 | fpr=0.8698 | 4324.2 samples/s | 16.9 steps/s
[Step= 100] | Loss=4.64380 | acc=0.1444 | tpr=0.7377 | fpr=0.8667 | 9072.5 samples/s | 35.4 steps/s
[Step= 150] | Loss=4.64190 | acc=0.1434 | tpr=0.7579 | fpr=0.8679 | 8277.6 samples/s | 32.3 steps/s
[Step= 200] | Loss=4.63858 | acc=0.1429 | tpr=0.7574 | fpr=0.8682 | 8693.5 samples/s | 34.0 steps/s
[Step= 250] | Loss=4.64105 | acc=0.1438 | tpr=0.7598 | fpr=0.8675 | 8921.3 samples/s | 34.8 steps/s
[Step= 300] | Loss=4.63705 | acc=0.1430 | tpr=0.7571 | fpr=0.8682 | 8424.3 samples/s | 32.9 steps/s
[Step= 350] | Loss=4.63214 | acc=0.1428 | tpr=0.7558 | fpr=0.8683 | 8875.6 samples/s | 34.7 steps/s
[Step= 400] | Loss=4.63581 | acc=0.1428 | tpr=0.7533 | fpr=0.8683 | 8764.6 samples/s | 34.2 steps/s
[Step= 450] | Loss=4.64110 | acc=0.1425 | tpr=0.7488 | fpr=0.8686 | 8448.8 samples/s | 33.0 steps/s
[Step= 500] | Loss=4.64372 | acc=0.1422 | tpr=0.7502 | fpr=0.8688 | 8653.7 samples/s | 33.8 steps/s
[Step= 550] | Loss=4.64215 | acc=0.1421 | tpr=0.7561 | fpr=0.8691 | 16235.9 samples/s | 63.4 steps/s
Avg test loss: 4.64383, Avg test acc: 0.14201, Avg tpr: 0.75555, Avg fpr: 0.86914, total FA: 120679

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.19363 | acc=0.1291 | tpr=0.7301 | fpr=0.8817 | 4406.2 samples/s | 17.2 steps/s
[Step= 100] | Loss=5.13860 | acc=0.1326 | tpr=0.7058 | fpr=0.8781 | 8616.6 samples/s | 33.7 steps/s
[Step= 150] | Loss=5.14026 | acc=0.1312 | tpr=0.7075 | fpr=0.8794 | 8538.3 samples/s | 33.4 steps/s
[Step= 200] | Loss=5.13738 | acc=0.1306 | tpr=0.7016 | fpr=0.8798 | 9031.7 samples/s | 35.3 steps/s
[Step= 250] | Loss=5.14248 | acc=0.1311 | tpr=0.7013 | fpr=0.8793 | 8580.9 samples/s | 33.5 steps/s
[Step= 300] | Loss=5.13901 | acc=0.1304 | tpr=0.7025 | fpr=0.8800 | 9044.0 samples/s | 35.3 steps/s
[Step= 350] | Loss=5.13480 | acc=0.1297 | tpr=0.6994 | fpr=0.8806 | 8342.0 samples/s | 32.6 steps/s
[Step= 400] | Loss=5.13812 | acc=0.1297 | tpr=0.6975 | fpr=0.8806 | 8404.3 samples/s | 32.8 steps/s
[Step= 450] | Loss=5.14059 | acc=0.1292 | tpr=0.6923 | fpr=0.8810 | 8843.9 samples/s | 34.5 steps/s
[Step= 500] | Loss=5.14313 | acc=0.1290 | tpr=0.6890 | fpr=0.8811 | 8467.5 samples/s | 33.1 steps/s
[Step= 550] | Loss=5.14193 | acc=0.1287 | tpr=0.6884 | fpr=0.8815 | 15434.3 samples/s | 60.3 steps/s
Avg test loss: 5.14407, Avg test acc: 0.12863, Avg tpr: 0.68780, Avg fpr: 0.88154, total FA: 122400

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10762 | acc=0.9812 | tpr=0.9425 | fpr=0.0181 | 4359.5 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.11204 | acc=0.9803 | tpr=0.9552 | fpr=0.0192 | 8576.4 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.11642 | acc=0.9793 | tpr=0.9524 | fpr=0.0202 | 8806.2 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.11869 | acc=0.9793 | tpr=0.9563 | fpr=0.0203 | 8559.1 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.11801 | acc=0.9792 | tpr=0.9493 | fpr=0.0203 | 8560.4 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.12037 | acc=0.9788 | tpr=0.9469 | fpr=0.0206 | 8827.1 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.12031 | acc=0.9786 | tpr=0.9461 | fpr=0.0208 | 8717.9 samples/s | 34.1 steps/s
[Step= 400] | Loss=0.12137 | acc=0.9785 | tpr=0.9426 | fpr=0.0208 | 8522.3 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.12408 | acc=0.9782 | tpr=0.9421 | fpr=0.0211 | 8583.1 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.12384 | acc=0.9783 | tpr=0.9432 | fpr=0.0211 | 8654.8 samples/s | 33.8 steps/s
[Step= 550] | Loss=0.12279 | acc=0.9785 | tpr=0.9431 | fpr=0.0209 | 15518.7 samples/s | 60.6 steps/s
Avg test loss: 0.12261, Avg test acc: 0.97850, Avg tpr: 0.94334, Avg fpr: 0.02086, total FA: 2897

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11362 | acc=0.9816 | tpr=0.9027 | fpr=0.0170 | 4372.8 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.11751 | acc=0.9813 | tpr=0.9083 | fpr=0.0173 | 8528.6 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.12236 | acc=0.9803 | tpr=0.9049 | fpr=0.0184 | 8902.9 samples/s | 34.8 steps/s
[Step= 200] | Loss=0.12398 | acc=0.9805 | tpr=0.9148 | fpr=0.0183 | 8792.8 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.12278 | acc=0.9804 | tpr=0.9162 | fpr=0.0184 | 8477.4 samples/s | 33.1 steps/s
[Step= 300] | Loss=0.12523 | acc=0.9800 | tpr=0.9185 | fpr=0.0189 | 8944.4 samples/s | 34.9 steps/s
[Step= 350] | Loss=0.12525 | acc=0.9798 | tpr=0.9217 | fpr=0.0191 | 8287.9 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.12644 | acc=0.9796 | tpr=0.9179 | fpr=0.0193 | 8727.8 samples/s | 34.1 steps/s
[Step= 450] | Loss=0.12966 | acc=0.9793 | tpr=0.9192 | fpr=0.0196 | 8656.5 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.12909 | acc=0.9795 | tpr=0.9220 | fpr=0.0195 | 8667.6 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.12822 | acc=0.9796 | tpr=0.9216 | fpr=0.0193 | 15336.8 samples/s | 59.9 steps/s
Avg test loss: 0.12796, Avg test acc: 0.97964, Avg tpr: 0.92155, Avg fpr: 0.01931, total FA: 2681

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10780 | acc=0.9799 | tpr=0.9425 | fpr=0.0194 | 4379.7 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.11134 | acc=0.9796 | tpr=0.9595 | fpr=0.0200 | 8573.9 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.11536 | acc=0.9783 | tpr=0.9553 | fpr=0.0213 | 8780.1 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.11729 | acc=0.9782 | tpr=0.9585 | fpr=0.0214 | 8994.1 samples/s | 35.1 steps/s
[Step= 250] | Loss=0.11656 | acc=0.9782 | tpr=0.9563 | fpr=0.0214 | 8296.5 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.11894 | acc=0.9778 | tpr=0.9564 | fpr=0.0218 | 8558.6 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.11889 | acc=0.9777 | tpr=0.9574 | fpr=0.0219 | 8649.9 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.12010 | acc=0.9776 | tpr=0.9551 | fpr=0.0220 | 8686.3 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.12293 | acc=0.9775 | tpr=0.9547 | fpr=0.0221 | 8670.0 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.12257 | acc=0.9775 | tpr=0.9564 | fpr=0.0221 | 8860.8 samples/s | 34.6 steps/s
[Step= 550] | Loss=0.12156 | acc=0.9777 | tpr=0.9566 | fpr=0.0219 | 14812.7 samples/s | 57.9 steps/s
Avg test loss: 0.12139, Avg test acc: 0.97775, Avg tpr: 0.95681, Avg fpr: 0.02187, total FA: 3036

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10655 | acc=0.9815 | tpr=0.9204 | fpr=0.0174 | 4392.9 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.11110 | acc=0.9812 | tpr=0.9382 | fpr=0.0180 | 8765.0 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.11528 | acc=0.9805 | tpr=0.9395 | fpr=0.0188 | 8630.5 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.11765 | acc=0.9804 | tpr=0.9464 | fpr=0.0190 | 8543.6 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.11645 | acc=0.9803 | tpr=0.9406 | fpr=0.0189 | 8528.2 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.11827 | acc=0.9800 | tpr=0.9404 | fpr=0.0193 | 9168.9 samples/s | 35.8 steps/s
[Step= 350] | Loss=0.11841 | acc=0.9798 | tpr=0.9430 | fpr=0.0195 | 8220.7 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.11918 | acc=0.9797 | tpr=0.9409 | fpr=0.0196 | 8763.5 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.12208 | acc=0.9794 | tpr=0.9401 | fpr=0.0199 | 8600.2 samples/s | 33.6 steps/s
[Step= 500] | Loss=0.12163 | acc=0.9795 | tpr=0.9419 | fpr=0.0198 | 9004.3 samples/s | 35.2 steps/s
[Step= 550] | Loss=0.12078 | acc=0.9797 | tpr=0.9411 | fpr=0.0196 | 14207.5 samples/s | 55.5 steps/s
Avg test loss: 0.12060, Avg test acc: 0.97967, Avg tpr: 0.94057, Avg fpr: 0.01962, total FA: 2724

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12209 | acc=0.9802 | tpr=0.9248 | fpr=0.0188 | 4559.0 samples/s | 17.8 steps/s
[Step= 100] | Loss=0.12671 | acc=0.9799 | tpr=0.9488 | fpr=0.0195 | 7964.9 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.13186 | acc=0.9789 | tpr=0.9510 | fpr=0.0206 | 8745.6 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.13393 | acc=0.9787 | tpr=0.9563 | fpr=0.0209 | 8864.7 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.13276 | acc=0.9787 | tpr=0.9520 | fpr=0.0208 | 8357.4 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.13553 | acc=0.9784 | tpr=0.9535 | fpr=0.0212 | 8519.8 samples/s | 33.3 steps/s
[Step= 350] | Loss=0.13617 | acc=0.9782 | tpr=0.9555 | fpr=0.0214 | 9177.2 samples/s | 35.8 steps/s
[Step= 400] | Loss=0.13726 | acc=0.9779 | tpr=0.9513 | fpr=0.0216 | 8298.1 samples/s | 32.4 steps/s
[Step= 450] | Loss=0.14046 | acc=0.9776 | tpr=0.9503 | fpr=0.0219 | 8720.5 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.13992 | acc=0.9777 | tpr=0.9507 | fpr=0.0219 | 8647.0 samples/s | 33.8 steps/s
[Step= 550] | Loss=0.13907 | acc=0.9778 | tpr=0.9483 | fpr=0.0217 | 15450.6 samples/s | 60.4 steps/s
Avg test loss: 0.13884, Avg test acc: 0.97779, Avg tpr: 0.94810, Avg fpr: 0.02167, total FA: 3009

server round 41/50

clients selected: [3 4 5 8 9]

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=40001 Epoch=195.1] | Loss=0.02919 | Reg=0.00092 | acc=0.9688 | L2-Norm=9.572 | L2-Norm(final)=12.896 | 3895.5 samples/s | 60.9 steps/s
[Step=40050 Epoch=195.3] | Loss=0.03432 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.575 | L2-Norm(final)=12.891 | 5258.6 samples/s | 82.2 steps/s
[Step=40100 Epoch=195.6] | Loss=0.02777 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.579 | L2-Norm(final)=12.889 | 5604.8 samples/s | 87.6 steps/s
[Step=40150 Epoch=195.8] | Loss=0.02464 | Reg=0.00092 | acc=0.9688 | L2-Norm=9.582 | L2-Norm(final)=12.889 | 5567.3 samples/s | 87.0 steps/s
[Step=40200 Epoch=196.0] | Loss=0.02328 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.585 | L2-Norm(final)=12.890 | 7581.7 samples/s | 118.5 steps/s
[Step=40250 Epoch=196.3] | Loss=0.02170 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.588 | L2-Norm(final)=12.891 | 1950.1 samples/s | 30.5 steps/s
[Step=40300 Epoch=196.5] | Loss=0.02070 | Reg=0.00092 | acc=0.9531 | L2-Norm=9.591 | L2-Norm(final)=12.893 | 5337.6 samples/s | 83.4 steps/s
[Step=40350 Epoch=196.8] | Loss=0.01988 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.593 | L2-Norm(final)=12.894 | 5618.8 samples/s | 87.8 steps/s
[Step=40400 Epoch=197.0] | Loss=0.01913 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.596 | L2-Norm(final)=12.897 | 7055.0 samples/s | 110.2 steps/s
[Step=40450 Epoch=197.3] | Loss=0.01867 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.599 | L2-Norm(final)=12.899 | 1957.9 samples/s | 30.6 steps/s
[Step=40500 Epoch=197.5] | Loss=0.01844 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.602 | L2-Norm(final)=12.902 | 5528.4 samples/s | 86.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=40501 Epoch=197.5] | Loss=0.01052 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.631 | L2-Norm(final)=12.927 | 4032.8 samples/s | 63.0 steps/s
[Step=40550 Epoch=197.7] | Loss=0.01202 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.638 | L2-Norm(final)=12.931 | 4577.4 samples/s | 71.5 steps/s
[Step=40600 Epoch=198.0] | Loss=0.01290 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.643 | L2-Norm(final)=12.934 | 4978.2 samples/s | 77.8 steps/s
[Step=40650 Epoch=198.2] | Loss=0.01191 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.649 | L2-Norm(final)=12.937 | 4837.9 samples/s | 75.6 steps/s
[Step=40700 Epoch=198.5] | Loss=0.01214 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.654 | L2-Norm(final)=12.940 | 6621.2 samples/s | 103.5 steps/s
[Step=40750 Epoch=198.7] | Loss=0.01082 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.659 | L2-Norm(final)=12.943 | 1875.1 samples/s | 29.3 steps/s
[Step=40800 Epoch=199.0] | Loss=0.01007 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.663 | L2-Norm(final)=12.946 | 4936.1 samples/s | 77.1 steps/s
[Step=40850 Epoch=199.2] | Loss=0.00943 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.667 | L2-Norm(final)=12.949 | 4918.2 samples/s | 76.8 steps/s
[Step=40900 Epoch=199.5] | Loss=0.00896 | Reg=0.00094 | acc=0.9688 | L2-Norm=9.671 | L2-Norm(final)=12.952 | 6162.7 samples/s | 96.3 steps/s
[Step=40950 Epoch=199.7] | Loss=0.00851 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.674 | L2-Norm(final)=12.955 | 1915.1 samples/s | 29.9 steps/s
[Step=41000 Epoch=199.9] | Loss=0.00811 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.678 | L2-Norm(final)=12.958 | 4929.1 samples/s | 77.0 steps/s
[Step=41050 Epoch=200.2] | Loss=0.00779 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.681 | L2-Norm(final)=12.960 | 4908.2 samples/s | 76.7 steps/s
[Step=41100 Epoch=200.4] | Loss=0.00749 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.684 | L2-Norm(final)=12.963 | 5753.5 samples/s | 89.9 steps/s
[Step=41150 Epoch=200.7] | Loss=0.00720 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.687 | L2-Norm(final)=12.966 | 1952.6 samples/s | 30.5 steps/s
[Step=41200 Epoch=200.9] | Loss=0.00691 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.690 | L2-Norm(final)=12.968 | 4920.8 samples/s | 76.9 steps/s
[Step=41250 Epoch=201.2] | Loss=0.00667 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.693 | L2-Norm(final)=12.971 | 4924.6 samples/s | 76.9 steps/s
[Step=41300 Epoch=201.4] | Loss=0.00654 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.696 | L2-Norm(final)=12.973 | 5406.0 samples/s | 84.5 steps/s
[Step=41350 Epoch=201.6] | Loss=0.00636 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.699 | L2-Norm(final)=12.976 | 1999.3 samples/s | 31.2 steps/s
[Step=41400 Epoch=201.9] | Loss=0.00617 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.701 | L2-Norm(final)=12.978 | 4868.0 samples/s | 76.1 steps/s
[Step=41450 Epoch=202.1] | Loss=0.00599 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.704 | L2-Norm(final)=12.980 | 4947.0 samples/s | 77.3 steps/s
[Step=41500 Epoch=202.4] | Loss=0.00586 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.707 | L2-Norm(final)=12.983 | 5029.7 samples/s | 78.6 steps/s
[Step=41550 Epoch=202.6] | Loss=0.00570 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.709 | L2-Norm(final)=12.985 | 2036.4 samples/s | 31.8 steps/s
[Step=41600 Epoch=202.9] | Loss=0.00554 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.712 | L2-Norm(final)=12.987 | 4981.5 samples/s | 77.8 steps/s
[Step=41650 Epoch=203.1] | Loss=0.00543 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.714 | L2-Norm(final)=12.990 | 4924.1 samples/s | 76.9 steps/s
[Step=41700 Epoch=203.4] | Loss=0.00539 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.716 | L2-Norm(final)=12.992 | 4948.3 samples/s | 77.3 steps/s
[Step=41750 Epoch=203.6] | Loss=0.00527 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.719 | L2-Norm(final)=12.994 | 2037.1 samples/s | 31.8 steps/s
[Step=41800 Epoch=203.8] | Loss=0.00516 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.721 | L2-Norm(final)=12.996 | 5082.5 samples/s | 79.4 steps/s
[Step=41850 Epoch=204.1] | Loss=0.00504 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.723 | L2-Norm(final)=12.998 | 4930.9 samples/s | 77.0 steps/s
[Step=41900 Epoch=204.3] | Loss=0.00494 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.726 | L2-Norm(final)=13.000 | 4845.7 samples/s | 75.7 steps/s
[Step=41950 Epoch=204.6] | Loss=0.00493 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.728 | L2-Norm(final)=13.003 | 2077.1 samples/s | 32.5 steps/s
[Step=42000 Epoch=204.8] | Loss=0.00484 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.730 | L2-Norm(final)=13.005 | 4964.6 samples/s | 77.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step42000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=46001 Epoch=225.6] | Loss=0.03180 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.572 | L2-Norm(final)=13.463 | 3919.2 samples/s | 61.2 steps/s
[Step=46050 Epoch=225.8] | Loss=0.02292 | Reg=0.00092 | acc=0.9688 | L2-Norm=9.577 | L2-Norm(final)=13.459 | 5420.0 samples/s | 84.7 steps/s
[Step=46100 Epoch=226.1] | Loss=0.01891 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.581 | L2-Norm(final)=13.458 | 5404.3 samples/s | 84.4 steps/s
[Step=46150 Epoch=226.3] | Loss=0.01669 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.584 | L2-Norm(final)=13.460 | 5634.0 samples/s | 88.0 steps/s
[Step=46200 Epoch=226.6] | Loss=0.01598 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.587 | L2-Norm(final)=13.462 | 7805.7 samples/s | 122.0 steps/s
[Step=46250 Epoch=226.8] | Loss=0.01501 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.590 | L2-Norm(final)=13.464 | 1911.5 samples/s | 29.9 steps/s
[Step=46300 Epoch=227.0] | Loss=0.01417 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.593 | L2-Norm(final)=13.466 | 5500.9 samples/s | 86.0 steps/s
[Step=46350 Epoch=227.3] | Loss=0.01412 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.597 | L2-Norm(final)=13.469 | 5674.6 samples/s | 88.7 steps/s
[Step=46400 Epoch=227.5] | Loss=0.01372 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.600 | L2-Norm(final)=13.472 | 7186.4 samples/s | 112.3 steps/s
[Step=46450 Epoch=227.8] | Loss=0.01338 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=13.474 | 1928.6 samples/s | 30.1 steps/s
[Step=46500 Epoch=228.0] | Loss=0.01315 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=13.477 | 5564.9 samples/s | 87.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=228.0] | Loss=0.01214 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.637 | L2-Norm(final)=13.507 | 3887.3 samples/s | 60.7 steps/s
[Step=46550 Epoch=228.3] | Loss=0.01137 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.642 | L2-Norm(final)=13.510 | 4770.6 samples/s | 74.5 steps/s
[Step=46600 Epoch=228.5] | Loss=0.01082 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.648 | L2-Norm(final)=13.513 | 4964.1 samples/s | 77.6 steps/s
[Step=46650 Epoch=228.8] | Loss=0.01038 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.653 | L2-Norm(final)=13.517 | 4927.6 samples/s | 77.0 steps/s
[Step=46700 Epoch=229.0] | Loss=0.00977 | Reg=0.00093 | acc=0.9688 | L2-Norm=9.657 | L2-Norm(final)=13.520 | 6736.2 samples/s | 105.3 steps/s
[Step=46750 Epoch=229.3] | Loss=0.00873 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.661 | L2-Norm(final)=13.523 | 1844.6 samples/s | 28.8 steps/s
[Step=46800 Epoch=229.5] | Loss=0.00825 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.665 | L2-Norm(final)=13.525 | 4955.6 samples/s | 77.4 steps/s
[Step=46850 Epoch=229.7] | Loss=0.00779 | Reg=0.00093 | acc=0.9844 | L2-Norm=9.668 | L2-Norm(final)=13.528 | 4893.9 samples/s | 76.5 steps/s
[Step=46900 Epoch=230.0] | Loss=0.00739 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.671 | L2-Norm(final)=13.531 | 6297.3 samples/s | 98.4 steps/s
[Step=46950 Epoch=230.2] | Loss=0.00699 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.675 | L2-Norm(final)=13.534 | 1890.5 samples/s | 29.5 steps/s
[Step=47000 Epoch=230.5] | Loss=0.00667 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.678 | L2-Norm(final)=13.537 | 4974.4 samples/s | 77.7 steps/s
[Step=47050 Epoch=230.7] | Loss=0.00641 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.681 | L2-Norm(final)=13.539 | 4920.7 samples/s | 76.9 steps/s
[Step=47100 Epoch=231.0] | Loss=0.00617 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.683 | L2-Norm(final)=13.542 | 6117.1 samples/s | 95.6 steps/s
[Step=47150 Epoch=231.2] | Loss=0.00598 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.686 | L2-Norm(final)=13.544 | 1912.0 samples/s | 29.9 steps/s
[Step=47200 Epoch=231.5] | Loss=0.00574 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.689 | L2-Norm(final)=13.547 | 5026.3 samples/s | 78.5 steps/s
[Step=47250 Epoch=231.7] | Loss=0.00559 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.692 | L2-Norm(final)=13.549 | 4868.4 samples/s | 76.1 steps/s
[Step=47300 Epoch=232.0] | Loss=0.00538 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.694 | L2-Norm(final)=13.552 | 5828.5 samples/s | 91.1 steps/s
[Step=47350 Epoch=232.2] | Loss=0.00525 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.696 | L2-Norm(final)=13.554 | 1948.5 samples/s | 30.4 steps/s
[Step=47400 Epoch=232.4] | Loss=0.00509 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.699 | L2-Norm(final)=13.557 | 4964.9 samples/s | 77.6 steps/s
[Step=47450 Epoch=232.7] | Loss=0.00496 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.701 | L2-Norm(final)=13.559 | 4901.8 samples/s | 76.6 steps/s
[Step=47500 Epoch=232.9] | Loss=0.00486 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.703 | L2-Norm(final)=13.561 | 5537.2 samples/s | 86.5 steps/s
[Step=47550 Epoch=233.2] | Loss=0.00478 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.706 | L2-Norm(final)=13.563 | 1965.0 samples/s | 30.7 steps/s
[Step=47600 Epoch=233.4] | Loss=0.00467 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.708 | L2-Norm(final)=13.566 | 4923.6 samples/s | 76.9 steps/s
[Step=47650 Epoch=233.7] | Loss=0.00458 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.710 | L2-Norm(final)=13.568 | 4921.0 samples/s | 76.9 steps/s
[Step=47700 Epoch=233.9] | Loss=0.00450 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.712 | L2-Norm(final)=13.570 | 5328.0 samples/s | 83.2 steps/s
[Step=47750 Epoch=234.2] | Loss=0.00443 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.714 | L2-Norm(final)=13.572 | 2006.2 samples/s | 31.3 steps/s
[Step=47800 Epoch=234.4] | Loss=0.00434 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.717 | L2-Norm(final)=13.574 | 4937.1 samples/s | 77.1 steps/s
[Step=47850 Epoch=234.6] | Loss=0.00426 | Reg=0.00094 | acc=0.9844 | L2-Norm=9.719 | L2-Norm(final)=13.576 | 4886.6 samples/s | 76.4 steps/s
[Step=47900 Epoch=234.9] | Loss=0.00422 | Reg=0.00094 | acc=1.0000 | L2-Norm=9.721 | L2-Norm(final)=13.578 | 5141.6 samples/s | 80.3 steps/s
[Step=47950 Epoch=235.1] | Loss=0.00418 | Reg=0.00095 | acc=0.9844 | L2-Norm=9.723 | L2-Norm(final)=13.580 | 2027.6 samples/s | 31.7 steps/s
[Step=48000 Epoch=235.4] | Loss=0.00410 | Reg=0.00095 | acc=1.0000 | L2-Norm=9.725 | L2-Norm(final)=13.582 | 4991.9 samples/s | 78.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step48000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=28001 Epoch=265.3] | Loss=0.00026 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.572 | L2-Norm(final)=7.472 | 4092.3 samples/s | 63.9 steps/s
[Step=28050 Epoch=265.8] | Loss=0.00105 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.574 | L2-Norm(final)=7.472 | 4560.0 samples/s | 71.3 steps/s
[Step=28100 Epoch=266.3] | Loss=0.00066 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.578 | L2-Norm(final)=7.476 | 7380.9 samples/s | 115.3 steps/s
[Step=28150 Epoch=266.7] | Loss=0.00049 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.579 | L2-Norm(final)=7.480 | 1864.0 samples/s | 29.1 steps/s
[Step=28200 Epoch=267.2] | Loss=0.00040 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.580 | L2-Norm(final)=7.483 | 6732.9 samples/s | 105.2 steps/s
[Step=28250 Epoch=267.7] | Loss=0.00034 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.580 | L2-Norm(final)=7.486 | 1931.2 samples/s | 30.2 steps/s
[Step=28300 Epoch=268.2] | Loss=0.00030 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.580 | L2-Norm(final)=7.489 | 6024.4 samples/s | 94.1 steps/s
[Step=28350 Epoch=268.6] | Loss=0.00027 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.580 | L2-Norm(final)=7.492 | 1966.1 samples/s | 30.7 steps/s
[Step=28400 Epoch=269.1] | Loss=0.00025 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.579 | L2-Norm(final)=7.495 | 5824.4 samples/s | 91.0 steps/s
[Step=28450 Epoch=269.6] | Loss=0.00023 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.579 | L2-Norm(final)=7.498 | 2008.0 samples/s | 31.4 steps/s
[Step=28500 Epoch=270.1] | Loss=0.00021 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.578 | L2-Norm(final)=7.500 | 5368.4 samples/s | 83.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=28501 Epoch=270.1] | Loss=0.00009 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.572 | L2-Norm(final)=7.526 | 3815.2 samples/s | 59.6 steps/s
[Step=28550 Epoch=270.5] | Loss=0.00006 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.570 | L2-Norm(final)=7.529 | 4551.4 samples/s | 71.1 steps/s
[Step=28600 Epoch=271.0] | Loss=0.00005 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.567 | L2-Norm(final)=7.530 | 6373.3 samples/s | 99.6 steps/s
[Step=28650 Epoch=271.5] | Loss=0.00004 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.563 | L2-Norm(final)=7.532 | 1791.5 samples/s | 28.0 steps/s
[Step=28700 Epoch=272.0] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.559 | L2-Norm(final)=7.533 | 5908.9 samples/s | 92.3 steps/s
[Step=28750 Epoch=272.4] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.554 | L2-Norm(final)=7.533 | 1843.9 samples/s | 28.8 steps/s
[Step=28800 Epoch=272.9] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.549 | L2-Norm(final)=7.534 | 5405.3 samples/s | 84.5 steps/s
[Step=28850 Epoch=273.4] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.544 | L2-Norm(final)=7.535 | 1890.4 samples/s | 29.5 steps/s
[Step=28900 Epoch=273.9] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=7.535 | 5070.8 samples/s | 79.2 steps/s
[Step=28950 Epoch=274.3] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.534 | L2-Norm(final)=7.536 | 1947.4 samples/s | 30.4 steps/s
[Step=29000 Epoch=274.8] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.528 | L2-Norm(final)=7.536 | 4834.2 samples/s | 75.5 steps/s
[Step=29050 Epoch=275.3] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.523 | L2-Norm(final)=7.537 | 1964.1 samples/s | 30.7 steps/s
[Step=29100 Epoch=275.7] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.517 | L2-Norm(final)=7.537 | 4728.7 samples/s | 73.9 steps/s
[Step=29150 Epoch=276.2] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.511 | L2-Norm(final)=7.537 | 1991.4 samples/s | 31.1 steps/s
[Step=29200 Epoch=276.7] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.505 | L2-Norm(final)=7.538 | 4787.6 samples/s | 74.8 steps/s
[Step=29250 Epoch=277.2] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.499 | L2-Norm(final)=7.538 | 2012.7 samples/s | 31.4 steps/s
[Step=29300 Epoch=277.6] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.493 | L2-Norm(final)=7.538 | 4584.6 samples/s | 71.6 steps/s
[Step=29350 Epoch=278.1] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.487 | L2-Norm(final)=7.539 | 2083.1 samples/s | 32.5 steps/s
[Step=29400 Epoch=278.6] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.480 | L2-Norm(final)=7.539 | 4412.8 samples/s | 68.9 steps/s
[Step=29450 Epoch=279.1] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.474 | L2-Norm(final)=7.539 | 6599.1 samples/s | 103.1 steps/s
[Step=29500 Epoch=279.5] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.467 | L2-Norm(final)=7.540 | 1792.9 samples/s | 28.0 steps/s
[Step=29550 Epoch=280.0] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.461 | L2-Norm(final)=7.540 | 6013.4 samples/s | 94.0 steps/s
[Step=29600 Epoch=280.5] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.454 | L2-Norm(final)=7.540 | 1847.4 samples/s | 28.9 steps/s
[Step=29650 Epoch=281.0] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.447 | L2-Norm(final)=7.541 | 5471.8 samples/s | 85.5 steps/s
[Step=29700 Epoch=281.4] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.440 | L2-Norm(final)=7.541 | 1885.7 samples/s | 29.5 steps/s
[Step=29750 Epoch=281.9] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.433 | L2-Norm(final)=7.541 | 5205.1 samples/s | 81.3 steps/s
[Step=29800 Epoch=282.4] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.426 | L2-Norm(final)=7.542 | 1933.0 samples/s | 30.2 steps/s
[Step=29850 Epoch=282.9] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.419 | L2-Norm(final)=7.542 | 4947.6 samples/s | 77.3 steps/s
[Step=29900 Epoch=283.3] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.412 | L2-Norm(final)=7.542 | 1941.5 samples/s | 30.3 steps/s
[Step=29950 Epoch=283.8] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.404 | L2-Norm(final)=7.543 | 4738.0 samples/s | 74.0 steps/s
[Step=30000 Epoch=284.3] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.397 | L2-Norm(final)=7.543 | 1994.1 samples/s | 31.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_0/client_state-step30000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=42001 Epoch=395.8] | Loss=0.00158 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.572 | L2-Norm(final)=9.129 | 4139.3 samples/s | 64.7 steps/s
[Step=42050 Epoch=396.2] | Loss=0.00086 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.579 | L2-Norm(final)=9.130 | 4816.5 samples/s | 75.3 steps/s
[Step=42100 Epoch=396.7] | Loss=0.00060 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.582 | L2-Norm(final)=9.135 | 7104.5 samples/s | 111.0 steps/s
[Step=42150 Epoch=397.2] | Loss=0.00044 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.584 | L2-Norm(final)=9.139 | 1854.8 samples/s | 29.0 steps/s
[Step=42200 Epoch=397.6] | Loss=0.00036 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.584 | L2-Norm(final)=9.143 | 6636.2 samples/s | 103.7 steps/s
[Step=42250 Epoch=398.1] | Loss=0.00031 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.584 | L2-Norm(final)=9.147 | 1933.9 samples/s | 30.2 steps/s
[Step=42300 Epoch=398.6] | Loss=0.00027 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.583 | L2-Norm(final)=9.150 | 5989.9 samples/s | 93.6 steps/s
[Step=42350 Epoch=399.1] | Loss=0.00024 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.583 | L2-Norm(final)=9.153 | 1992.9 samples/s | 31.1 steps/s
[Step=42400 Epoch=399.5] | Loss=0.00022 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.582 | L2-Norm(final)=9.156 | 5525.6 samples/s | 86.3 steps/s
[Step=42450 Epoch=400.0] | Loss=0.00021 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.581 | L2-Norm(final)=9.158 | 2052.7 samples/s | 32.1 steps/s
[Step=42500 Epoch=400.5] | Loss=0.00019 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.580 | L2-Norm(final)=9.161 | 5193.4 samples/s | 81.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=400.5] | Loss=0.00001 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.568 | L2-Norm(final)=9.186 | 4083.3 samples/s | 63.8 steps/s
[Step=42550 Epoch=400.9] | Loss=0.00004 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.563 | L2-Norm(final)=9.188 | 4379.8 samples/s | 68.4 steps/s
[Step=42600 Epoch=401.4] | Loss=0.00003 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.556 | L2-Norm(final)=9.189 | 6335.8 samples/s | 99.0 steps/s
[Step=42650 Epoch=401.9] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.548 | L2-Norm(final)=9.190 | 1825.9 samples/s | 28.5 steps/s
[Step=42700 Epoch=402.4] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=9.191 | 5738.5 samples/s | 89.7 steps/s
[Step=42750 Epoch=402.8] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.529 | L2-Norm(final)=9.191 | 1866.1 samples/s | 29.2 steps/s
[Step=42800 Epoch=403.3] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.519 | L2-Norm(final)=9.191 | 5316.8 samples/s | 83.1 steps/s
[Step=42850 Epoch=403.8] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.509 | L2-Norm(final)=9.192 | 1936.1 samples/s | 30.3 steps/s
[Step=42900 Epoch=404.2] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.498 | L2-Norm(final)=9.192 | 4886.3 samples/s | 76.3 steps/s
[Step=42950 Epoch=404.7] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.488 | L2-Norm(final)=9.192 | 1966.7 samples/s | 30.7 steps/s
[Step=43000 Epoch=405.2] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.477 | L2-Norm(final)=9.192 | 4781.6 samples/s | 74.7 steps/s
[Step=43050 Epoch=405.7] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.466 | L2-Norm(final)=9.193 | 1998.2 samples/s | 31.2 steps/s
[Step=43100 Epoch=406.1] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.454 | L2-Norm(final)=9.193 | 4761.5 samples/s | 74.4 steps/s
[Step=43150 Epoch=406.6] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.443 | L2-Norm(final)=9.193 | 2031.2 samples/s | 31.7 steps/s
[Step=43200 Epoch=407.1] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.431 | L2-Norm(final)=9.193 | 4653.4 samples/s | 72.7 steps/s
[Step=43250 Epoch=407.5] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.419 | L2-Norm(final)=9.193 | 2123.9 samples/s | 33.2 steps/s
[Step=43300 Epoch=408.0] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.408 | L2-Norm(final)=9.194 | 4180.4 samples/s | 65.3 steps/s
[Step=43350 Epoch=408.5] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.395 | L2-Norm(final)=9.194 | 6350.1 samples/s | 99.2 steps/s
[Step=43400 Epoch=409.0] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.383 | L2-Norm(final)=9.194 | 1796.4 samples/s | 28.1 steps/s
[Step=43450 Epoch=409.4] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.371 | L2-Norm(final)=9.194 | 5837.0 samples/s | 91.2 steps/s
[Step=43500 Epoch=409.9] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.358 | L2-Norm(final)=9.194 | 1833.4 samples/s | 28.6 steps/s
[Step=43550 Epoch=410.4] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.346 | L2-Norm(final)=9.194 | 5364.8 samples/s | 83.8 steps/s
[Step=43600 Epoch=410.8] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.333 | L2-Norm(final)=9.195 | 1911.5 samples/s | 29.9 steps/s
[Step=43650 Epoch=411.3] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.320 | L2-Norm(final)=9.195 | 4993.7 samples/s | 78.0 steps/s
[Step=43700 Epoch=411.8] | Loss=0.00000 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.307 | L2-Norm(final)=9.195 | 1958.1 samples/s | 30.6 steps/s
[Step=43750 Epoch=412.2] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.293 | L2-Norm(final)=9.195 | 4716.6 samples/s | 73.7 steps/s
[Step=43800 Epoch=412.7] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.280 | L2-Norm(final)=9.195 | 2010.3 samples/s | 31.4 steps/s
[Step=43850 Epoch=413.2] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.266 | L2-Norm(final)=9.196 | 4781.3 samples/s | 74.7 steps/s
[Step=43900 Epoch=413.7] | Loss=0.00000 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.253 | L2-Norm(final)=9.196 | 1991.4 samples/s | 31.1 steps/s
[Step=43950 Epoch=414.1] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.239 | L2-Norm(final)=9.196 | 4756.8 samples/s | 74.3 steps/s
[Step=44000 Epoch=414.6] | Loss=0.00000 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.225 | L2-Norm(final)=9.196 | 2096.9 samples/s | 32.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step44000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=44001 Epoch=419.4] | Loss=0.00003 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.572 | L2-Norm(final)=9.717 | 4096.8 samples/s | 64.0 steps/s
[Step=44050 Epoch=419.8] | Loss=0.00149 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.579 | L2-Norm(final)=9.724 | 4998.0 samples/s | 78.1 steps/s
[Step=44100 Epoch=420.3] | Loss=0.00123 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.587 | L2-Norm(final)=9.729 | 7522.9 samples/s | 117.5 steps/s
[Step=44150 Epoch=420.8] | Loss=0.00090 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.591 | L2-Norm(final)=9.734 | 1895.9 samples/s | 29.6 steps/s
[Step=44200 Epoch=421.3] | Loss=0.00072 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.594 | L2-Norm(final)=9.738 | 6853.6 samples/s | 107.1 steps/s
[Step=44250 Epoch=421.7] | Loss=0.00062 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.596 | L2-Norm(final)=9.741 | 1928.4 samples/s | 30.1 steps/s
[Step=44300 Epoch=422.2] | Loss=0.00054 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.597 | L2-Norm(final)=9.744 | 6247.2 samples/s | 97.6 steps/s
[Step=44350 Epoch=422.7] | Loss=0.00048 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.598 | L2-Norm(final)=9.747 | 1958.7 samples/s | 30.6 steps/s
[Step=44400 Epoch=423.2] | Loss=0.00044 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.599 | L2-Norm(final)=9.750 | 5952.1 samples/s | 93.0 steps/s
[Step=44450 Epoch=423.6] | Loss=0.00041 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.599 | L2-Norm(final)=9.753 | 2009.2 samples/s | 31.4 steps/s
[Step=44500 Epoch=424.1] | Loss=0.00038 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.600 | L2-Norm(final)=9.755 | 5360.6 samples/s | 83.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=424.1] | Loss=0.00010 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=9.780 | 3963.5 samples/s | 61.9 steps/s
[Step=44550 Epoch=424.6] | Loss=0.00009 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.606 | L2-Norm(final)=9.782 | 4305.7 samples/s | 67.3 steps/s
[Step=44600 Epoch=425.1] | Loss=0.00006 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=9.783 | 6463.2 samples/s | 101.0 steps/s
[Step=44650 Epoch=425.6] | Loss=0.00005 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.599 | L2-Norm(final)=9.784 | 1790.1 samples/s | 28.0 steps/s
[Step=44700 Epoch=426.0] | Loss=0.00004 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.594 | L2-Norm(final)=9.785 | 5999.7 samples/s | 93.7 steps/s
[Step=44750 Epoch=426.5] | Loss=0.00003 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.588 | L2-Norm(final)=9.785 | 1853.8 samples/s | 29.0 steps/s
[Step=44800 Epoch=427.0] | Loss=0.00003 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.582 | L2-Norm(final)=9.785 | 5566.6 samples/s | 87.0 steps/s
[Step=44850 Epoch=427.5] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=9.785 | 1875.5 samples/s | 29.3 steps/s
[Step=44900 Epoch=427.9] | Loss=0.00002 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.570 | L2-Norm(final)=9.786 | 5311.6 samples/s | 83.0 steps/s
[Step=44950 Epoch=428.4] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.563 | L2-Norm(final)=9.786 | 1914.8 samples/s | 29.9 steps/s
[Step=45000 Epoch=428.9] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.556 | L2-Norm(final)=9.786 | 4976.0 samples/s | 77.8 steps/s
[Step=45050 Epoch=429.4] | Loss=0.00002 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.549 | L2-Norm(final)=9.786 | 1954.0 samples/s | 30.5 steps/s
[Step=45100 Epoch=429.8] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.542 | L2-Norm(final)=9.786 | 4798.1 samples/s | 75.0 steps/s
[Step=45150 Epoch=430.3] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.535 | L2-Norm(final)=9.787 | 1987.4 samples/s | 31.1 steps/s
[Step=45200 Epoch=430.8] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.528 | L2-Norm(final)=9.787 | 4729.4 samples/s | 73.9 steps/s
[Step=45250 Epoch=431.3] | Loss=0.00001 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.520 | L2-Norm(final)=9.787 | 2005.8 samples/s | 31.3 steps/s
[Step=45300 Epoch=431.7] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.513 | L2-Norm(final)=9.787 | 4707.3 samples/s | 73.6 steps/s
[Step=45350 Epoch=432.2] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.505 | L2-Norm(final)=9.787 | 1956.7 samples/s | 30.6 steps/s
[Step=45400 Epoch=432.7] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.497 | L2-Norm(final)=9.787 | 4676.0 samples/s | 73.1 steps/s
[Step=45450 Epoch=433.2] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.489 | L2-Norm(final)=9.788 | 2002.5 samples/s | 31.3 steps/s
[Step=45500 Epoch=433.7] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.481 | L2-Norm(final)=9.788 | 4704.5 samples/s | 73.5 steps/s
[Step=45550 Epoch=434.1] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.473 | L2-Norm(final)=9.788 | 6735.6 samples/s | 105.2 steps/s
[Step=45600 Epoch=434.6] | Loss=0.00001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.464 | L2-Norm(final)=9.788 | 1770.3 samples/s | 27.7 steps/s
[Step=45650 Epoch=435.1] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.456 | L2-Norm(final)=9.788 | 6368.1 samples/s | 99.5 steps/s
[Step=45700 Epoch=435.6] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.447 | L2-Norm(final)=9.788 | 1807.8 samples/s | 28.2 steps/s
[Step=45750 Epoch=436.0] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.438 | L2-Norm(final)=9.788 | 5945.9 samples/s | 92.9 steps/s
[Step=45800 Epoch=436.5] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.429 | L2-Norm(final)=9.788 | 1823.4 samples/s | 28.5 steps/s
[Step=45850 Epoch=437.0] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.420 | L2-Norm(final)=9.789 | 5569.5 samples/s | 87.0 steps/s
[Step=45900 Epoch=437.5] | Loss=0.00001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.411 | L2-Norm(final)=9.789 | 1865.2 samples/s | 29.1 steps/s
[Step=45950 Epoch=437.9] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.402 | L2-Norm(final)=9.789 | 5324.8 samples/s | 83.2 steps/s
[Step=46000 Epoch=438.4] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.392 | L2-Norm(final)=9.789 | 1873.2 samples/s | 29.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step46000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07974 | acc=0.9621 | tpr=0.9682 | fpr=0.0510 | 4353.8 samples/s | 17.0 steps/s
Avg test loss: 0.08311, Avg test acc: 0.96013, Avg tpr: 0.96672, Avg fpr: 0.05435, total FA: 424

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08460 | acc=0.9618 | tpr=0.9732 | fpr=0.0629 | 4443.9 samples/s | 17.4 steps/s
Avg test loss: 0.08895, Avg test acc: 0.96218, Avg tpr: 0.97354, Avg fpr: 0.06281, total FA: 490

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08247 | acc=0.9614 | tpr=0.9698 | fpr=0.0567 | 4400.4 samples/s | 17.2 steps/s
Avg test loss: 0.08672, Avg test acc: 0.95997, Avg tpr: 0.96783, Avg fpr: 0.05730, total FA: 447

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.07795 | acc=0.9627 | tpr=0.9764 | fpr=0.0669 | 4388.3 samples/s | 17.1 steps/s
Avg test loss: 0.08168, Avg test acc: 0.96210, Avg tpr: 0.97570, Avg fpr: 0.06781, total FA: 529

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08340 | acc=0.9617 | tpr=0.9677 | fpr=0.0513 | 4448.7 samples/s | 17.4 steps/s
Avg test loss: 0.09097, Avg test acc: 0.95985, Avg tpr: 0.96619, Avg fpr: 0.05410, total FA: 422

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.13093 | acc=0.2947 | tpr=0.0030 | fpr=0.0719 | 4327.9 samples/s | 16.9 steps/s
Avg test loss: 5.14578, Avg test acc: 0.29209, Avg tpr: 0.00367, Avg fpr: 0.07358, total FA: 574

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=5.02254 | acc=0.3140 | tpr=0.0037 | fpr=0.0121 | 4394.8 samples/s | 17.2 steps/s
Avg test loss: 5.03125, Avg test acc: 0.31120, Avg tpr: 0.00408, Avg fpr: 0.01333, total FA: 104

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.09399 | acc=0.3040 | tpr=0.0055 | fpr=0.0478 | 4305.5 samples/s | 16.8 steps/s
Avg test loss: 5.10431, Avg test acc: 0.30155, Avg tpr: 0.00618, Avg fpr: 0.04884, total FA: 381

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.23768 | acc=0.3047 | tpr=0.0030 | fpr=0.0401 | 4352.8 samples/s | 17.0 steps/s
Avg test loss: 5.25293, Avg test acc: 0.30175, Avg tpr: 0.00356, Avg fpr: 0.04243, total FA: 331

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.96878 | acc=0.3137 | tpr=0.0022 | fpr=0.0097 | 4447.9 samples/s | 17.4 steps/s
Avg test loss: 4.97932, Avg test acc: 0.31120, Avg tpr: 0.00251, Avg fpr: 0.00987, total FA: 77

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.72275 | acc=0.1320 | tpr=0.8230 | fpr=0.8804 | 4458.4 samples/s | 17.4 steps/s
[Step= 100] | Loss=4.67462 | acc=0.1350 | tpr=0.8060 | fpr=0.8776 | 8809.0 samples/s | 34.4 steps/s
[Step= 150] | Loss=4.67551 | acc=0.1338 | tpr=0.8228 | fpr=0.8789 | 8409.9 samples/s | 32.9 steps/s
[Step= 200] | Loss=4.67493 | acc=0.1330 | tpr=0.8208 | fpr=0.8795 | 8336.2 samples/s | 32.6 steps/s
[Step= 250] | Loss=4.67950 | acc=0.1343 | tpr=0.8227 | fpr=0.8782 | 8845.5 samples/s | 34.6 steps/s
[Step= 300] | Loss=4.67459 | acc=0.1342 | tpr=0.8189 | fpr=0.8782 | 8616.7 samples/s | 33.7 steps/s
[Step= 350] | Loss=4.67051 | acc=0.1337 | tpr=0.8153 | fpr=0.8787 | 9050.7 samples/s | 35.4 steps/s
[Step= 400] | Loss=4.67389 | acc=0.1339 | tpr=0.8129 | fpr=0.8784 | 8206.3 samples/s | 32.1 steps/s
[Step= 450] | Loss=4.67614 | acc=0.1337 | tpr=0.8092 | fpr=0.8785 | 8596.8 samples/s | 33.6 steps/s
[Step= 500] | Loss=4.67901 | acc=0.1336 | tpr=0.8093 | fpr=0.8786 | 8676.6 samples/s | 33.9 steps/s
[Step= 550] | Loss=4.67745 | acc=0.1334 | tpr=0.8114 | fpr=0.8790 | 15656.2 samples/s | 61.2 steps/s
Avg test loss: 4.67916, Avg test acc: 0.13328, Avg tpr: 0.81062, Avg fpr: 0.87903, total FA: 122052

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.98266 | acc=0.1357 | tpr=0.7965 | fpr=0.8762 | 4363.9 samples/s | 17.0 steps/s
[Step= 100] | Loss=4.93114 | acc=0.1381 | tpr=0.7804 | fpr=0.8739 | 8983.9 samples/s | 35.1 steps/s
[Step= 150] | Loss=4.93290 | acc=0.1366 | tpr=0.7824 | fpr=0.8753 | 8359.5 samples/s | 32.7 steps/s
[Step= 200] | Loss=4.93346 | acc=0.1365 | tpr=0.7825 | fpr=0.8753 | 9406.1 samples/s | 36.7 steps/s
[Step= 250] | Loss=4.93309 | acc=0.1373 | tpr=0.7799 | fpr=0.8744 | 8222.8 samples/s | 32.1 steps/s
[Step= 300] | Loss=4.92990 | acc=0.1368 | tpr=0.7811 | fpr=0.8750 | 8487.5 samples/s | 33.2 steps/s
[Step= 350] | Loss=4.92459 | acc=0.1364 | tpr=0.7802 | fpr=0.8753 | 8689.1 samples/s | 33.9 steps/s
[Step= 400] | Loss=4.92582 | acc=0.1361 | tpr=0.7735 | fpr=0.8755 | 8540.3 samples/s | 33.4 steps/s
[Step= 450] | Loss=4.93064 | acc=0.1361 | tpr=0.7707 | fpr=0.8755 | 8711.1 samples/s | 34.0 steps/s
[Step= 500] | Loss=4.93583 | acc=0.1357 | tpr=0.7705 | fpr=0.8757 | 9208.8 samples/s | 36.0 steps/s
[Step= 550] | Loss=4.93403 | acc=0.1357 | tpr=0.7728 | fpr=0.8758 | 13790.9 samples/s | 53.9 steps/s
Avg test loss: 4.93554, Avg test acc: 0.13571, Avg tpr: 0.77219, Avg fpr: 0.87586, total FA: 121612

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.31116 | acc=0.1277 | tpr=0.7832 | fpr=0.8840 | 4347.5 samples/s | 17.0 steps/s
[Step= 100] | Loss=5.25651 | acc=0.1302 | tpr=0.7761 | fpr=0.8818 | 8860.1 samples/s | 34.6 steps/s
[Step= 150] | Loss=5.25844 | acc=0.1283 | tpr=0.7968 | fpr=0.8841 | 8424.0 samples/s | 32.9 steps/s
[Step= 200] | Loss=5.25945 | acc=0.1271 | tpr=0.7978 | fpr=0.8851 | 8659.3 samples/s | 33.8 steps/s
[Step= 250] | Loss=5.25900 | acc=0.1278 | tpr=0.7983 | fpr=0.8844 | 9682.6 samples/s | 37.8 steps/s
[Step= 300] | Loss=5.25519 | acc=0.1276 | tpr=0.7993 | fpr=0.8846 | 8089.2 samples/s | 31.6 steps/s
[Step= 350] | Loss=5.25322 | acc=0.1276 | tpr=0.8003 | fpr=0.8846 | 8576.7 samples/s | 33.5 steps/s
[Step= 400] | Loss=5.25643 | acc=0.1278 | tpr=0.8014 | fpr=0.8844 | 8497.9 samples/s | 33.2 steps/s
[Step= 450] | Loss=5.26082 | acc=0.1273 | tpr=0.7965 | fpr=0.8849 | 8783.7 samples/s | 34.3 steps/s
[Step= 500] | Loss=5.26187 | acc=0.1272 | tpr=0.7982 | fpr=0.8849 | 8419.7 samples/s | 32.9 steps/s
[Step= 550] | Loss=5.26060 | acc=0.1269 | tpr=0.8034 | fpr=0.8854 | 15703.8 samples/s | 61.3 steps/s
Avg test loss: 5.26197, Avg test acc: 0.12687, Avg tpr: 0.80269, Avg fpr: 0.88541, total FA: 122938

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.10700 | acc=0.1279 | tpr=0.7965 | fpr=0.8841 | 4350.0 samples/s | 17.0 steps/s
[Step= 100] | Loss=5.05935 | acc=0.1309 | tpr=0.7825 | fpr=0.8813 | 8587.3 samples/s | 33.5 steps/s
[Step= 150] | Loss=5.05855 | acc=0.1292 | tpr=0.7954 | fpr=0.8831 | 8654.7 samples/s | 33.8 steps/s
[Step= 200] | Loss=5.05458 | acc=0.1282 | tpr=0.7934 | fpr=0.8839 | 8481.5 samples/s | 33.1 steps/s
[Step= 250] | Loss=5.05695 | acc=0.1288 | tpr=0.7956 | fpr=0.8833 | 8864.6 samples/s | 34.6 steps/s
[Step= 300] | Loss=5.05253 | acc=0.1279 | tpr=0.7920 | fpr=0.8842 | 8521.2 samples/s | 33.3 steps/s
[Step= 350] | Loss=5.04792 | acc=0.1276 | tpr=0.7902 | fpr=0.8844 | 8589.0 samples/s | 33.6 steps/s
[Step= 400] | Loss=5.05109 | acc=0.1275 | tpr=0.7834 | fpr=0.8845 | 8918.5 samples/s | 34.8 steps/s
[Step= 450] | Loss=5.05626 | acc=0.1271 | tpr=0.7790 | fpr=0.8848 | 8380.5 samples/s | 32.7 steps/s
[Step= 500] | Loss=5.05932 | acc=0.1269 | tpr=0.7819 | fpr=0.8849 | 8791.4 samples/s | 34.3 steps/s
[Step= 550] | Loss=5.05761 | acc=0.1268 | tpr=0.7871 | fpr=0.8852 | 14910.1 samples/s | 58.2 steps/s
Avg test loss: 5.05925, Avg test acc: 0.12671, Avg tpr: 0.78645, Avg fpr: 0.88528, total FA: 122920

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.02293 | acc=0.1385 | tpr=0.6947 | fpr=0.8715 | 4385.0 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.97241 | acc=0.1416 | tpr=0.6567 | fpr=0.8680 | 8636.3 samples/s | 33.7 steps/s
[Step= 150] | Loss=4.97034 | acc=0.1399 | tpr=0.6513 | fpr=0.8695 | 8844.1 samples/s | 34.5 steps/s
[Step= 200] | Loss=4.96878 | acc=0.1397 | tpr=0.6525 | fpr=0.8696 | 8547.2 samples/s | 33.4 steps/s
[Step= 250] | Loss=4.97287 | acc=0.1406 | tpr=0.6541 | fpr=0.8688 | 8485.9 samples/s | 33.1 steps/s
[Step= 300] | Loss=4.96785 | acc=0.1405 | tpr=0.6618 | fpr=0.8690 | 8620.1 samples/s | 33.7 steps/s
[Step= 350] | Loss=4.96422 | acc=0.1399 | tpr=0.6587 | fpr=0.8696 | 8893.0 samples/s | 34.7 steps/s
[Step= 400] | Loss=4.96713 | acc=0.1398 | tpr=0.6559 | fpr=0.8696 | 8408.5 samples/s | 32.8 steps/s
[Step= 450] | Loss=4.97069 | acc=0.1393 | tpr=0.6514 | fpr=0.8700 | 8560.2 samples/s | 33.4 steps/s
[Step= 500] | Loss=4.97277 | acc=0.1389 | tpr=0.6471 | fpr=0.8703 | 8699.3 samples/s | 34.0 steps/s
[Step= 550] | Loss=4.97184 | acc=0.1385 | tpr=0.6450 | fpr=0.8707 | 15300.7 samples/s | 59.8 steps/s
Avg test loss: 4.97388, Avg test acc: 0.13849, Avg tpr: 0.64461, Avg fpr: 0.87071, total FA: 120897

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10178 | acc=0.9812 | tpr=0.9469 | fpr=0.0182 | 4373.9 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.10594 | acc=0.9803 | tpr=0.9574 | fpr=0.0193 | 8748.0 samples/s | 34.2 steps/s
[Step= 150] | Loss=0.10998 | acc=0.9793 | tpr=0.9553 | fpr=0.0202 | 8749.0 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.11210 | acc=0.9794 | tpr=0.9596 | fpr=0.0202 | 8410.9 samples/s | 32.9 steps/s
[Step= 250] | Loss=0.11152 | acc=0.9793 | tpr=0.9537 | fpr=0.0202 | 8783.0 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.11361 | acc=0.9790 | tpr=0.9527 | fpr=0.0205 | 8479.1 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.11352 | acc=0.9788 | tpr=0.9530 | fpr=0.0207 | 8424.0 samples/s | 32.9 steps/s
[Step= 400] | Loss=0.11458 | acc=0.9787 | tpr=0.9502 | fpr=0.0208 | 8650.5 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.11731 | acc=0.9784 | tpr=0.9489 | fpr=0.0211 | 8760.9 samples/s | 34.2 steps/s
[Step= 500] | Loss=0.11705 | acc=0.9784 | tpr=0.9498 | fpr=0.0210 | 8798.8 samples/s | 34.4 steps/s
[Step= 550] | Loss=0.11609 | acc=0.9786 | tpr=0.9499 | fpr=0.0208 | 15102.5 samples/s | 59.0 steps/s
Avg test loss: 0.11592, Avg test acc: 0.97866, Avg tpr: 0.95008, Avg fpr: 0.02082, total FA: 2891

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11362 | acc=0.9816 | tpr=0.9027 | fpr=0.0170 | 4440.8 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.11751 | acc=0.9813 | tpr=0.9083 | fpr=0.0173 | 8366.9 samples/s | 32.7 steps/s
[Step= 150] | Loss=0.12236 | acc=0.9803 | tpr=0.9049 | fpr=0.0184 | 8474.2 samples/s | 33.1 steps/s
[Step= 200] | Loss=0.12398 | acc=0.9805 | tpr=0.9148 | fpr=0.0183 | 8880.3 samples/s | 34.7 steps/s
[Step= 250] | Loss=0.12278 | acc=0.9804 | tpr=0.9162 | fpr=0.0184 | 8503.6 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.12523 | acc=0.9800 | tpr=0.9185 | fpr=0.0189 | 8737.2 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.12525 | acc=0.9798 | tpr=0.9217 | fpr=0.0191 | 8446.9 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.12644 | acc=0.9796 | tpr=0.9179 | fpr=0.0193 | 8996.1 samples/s | 35.1 steps/s
[Step= 450] | Loss=0.12966 | acc=0.9793 | tpr=0.9192 | fpr=0.0196 | 8222.1 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.12909 | acc=0.9795 | tpr=0.9220 | fpr=0.0195 | 8963.6 samples/s | 35.0 steps/s
[Step= 550] | Loss=0.12822 | acc=0.9796 | tpr=0.9216 | fpr=0.0193 | 14861.0 samples/s | 58.1 steps/s
Avg test loss: 0.12796, Avg test acc: 0.97964, Avg tpr: 0.92155, Avg fpr: 0.01931, total FA: 2681

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10780 | acc=0.9799 | tpr=0.9425 | fpr=0.0194 | 4332.8 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.11134 | acc=0.9796 | tpr=0.9595 | fpr=0.0200 | 8808.0 samples/s | 34.4 steps/s
[Step= 150] | Loss=0.11536 | acc=0.9783 | tpr=0.9553 | fpr=0.0213 | 8532.2 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.11729 | acc=0.9782 | tpr=0.9585 | fpr=0.0214 | 8743.0 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.11656 | acc=0.9782 | tpr=0.9563 | fpr=0.0214 | 8518.3 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.11894 | acc=0.9778 | tpr=0.9564 | fpr=0.0218 | 8508.2 samples/s | 33.2 steps/s
[Step= 350] | Loss=0.11889 | acc=0.9777 | tpr=0.9574 | fpr=0.0219 | 9023.0 samples/s | 35.2 steps/s
[Step= 400] | Loss=0.12010 | acc=0.9776 | tpr=0.9551 | fpr=0.0220 | 8489.5 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.12293 | acc=0.9775 | tpr=0.9547 | fpr=0.0221 | 8881.0 samples/s | 34.7 steps/s
[Step= 500] | Loss=0.12257 | acc=0.9775 | tpr=0.9564 | fpr=0.0221 | 8358.1 samples/s | 32.6 steps/s
[Step= 550] | Loss=0.12156 | acc=0.9777 | tpr=0.9566 | fpr=0.0219 | 16392.7 samples/s | 64.0 steps/s
Avg test loss: 0.12139, Avg test acc: 0.97775, Avg tpr: 0.95681, Avg fpr: 0.02187, total FA: 3036

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10260 | acc=0.9815 | tpr=0.9248 | fpr=0.0175 | 4357.9 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.10711 | acc=0.9809 | tpr=0.9424 | fpr=0.0184 | 8666.1 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.11125 | acc=0.9802 | tpr=0.9438 | fpr=0.0191 | 8688.0 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.11355 | acc=0.9802 | tpr=0.9519 | fpr=0.0193 | 8758.1 samples/s | 34.2 steps/s
[Step= 250] | Loss=0.11248 | acc=0.9802 | tpr=0.9476 | fpr=0.0192 | 8602.8 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.11420 | acc=0.9800 | tpr=0.9484 | fpr=0.0195 | 9057.6 samples/s | 35.4 steps/s
[Step= 350] | Loss=0.11438 | acc=0.9799 | tpr=0.9512 | fpr=0.0196 | 8183.2 samples/s | 32.0 steps/s
[Step= 400] | Loss=0.11508 | acc=0.9797 | tpr=0.9486 | fpr=0.0197 | 8627.9 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.11789 | acc=0.9795 | tpr=0.9479 | fpr=0.0200 | 8440.1 samples/s | 33.0 steps/s
[Step= 500] | Loss=0.11745 | acc=0.9795 | tpr=0.9489 | fpr=0.0199 | 8617.6 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.11658 | acc=0.9797 | tpr=0.9471 | fpr=0.0197 | 15690.6 samples/s | 61.3 steps/s
Avg test loss: 0.11640, Avg test acc: 0.97969, Avg tpr: 0.94691, Avg fpr: 0.01971, total FA: 2737

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12101 | acc=0.9800 | tpr=0.9204 | fpr=0.0189 | 4361.4 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.12546 | acc=0.9799 | tpr=0.9446 | fpr=0.0194 | 9005.7 samples/s | 35.2 steps/s
[Step= 150] | Loss=0.13062 | acc=0.9790 | tpr=0.9481 | fpr=0.0204 | 8410.4 samples/s | 32.9 steps/s
[Step= 200] | Loss=0.13266 | acc=0.9788 | tpr=0.9530 | fpr=0.0207 | 8852.7 samples/s | 34.6 steps/s
[Step= 250] | Loss=0.13158 | acc=0.9790 | tpr=0.9493 | fpr=0.0205 | 8418.3 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.13431 | acc=0.9787 | tpr=0.9513 | fpr=0.0208 | 8721.7 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.13500 | acc=0.9784 | tpr=0.9518 | fpr=0.0211 | 8628.6 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.13610 | acc=0.9782 | tpr=0.9475 | fpr=0.0212 | 8625.8 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.13918 | acc=0.9780 | tpr=0.9469 | fpr=0.0215 | 8539.7 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.13860 | acc=0.9780 | tpr=0.9476 | fpr=0.0215 | 8655.6 samples/s | 33.8 steps/s
[Step= 550] | Loss=0.13770 | acc=0.9781 | tpr=0.9463 | fpr=0.0213 | 15025.7 samples/s | 58.7 steps/s
Avg test loss: 0.13747, Avg test acc: 0.97814, Avg tpr: 0.94612, Avg fpr: 0.02128, total FA: 2954

server round 42/50

clients selected: [2 4 5 6 9]

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=40001 Epoch=194.9] | Loss=0.05136 | Reg=0.00089 | acc=0.9531 | L2-Norm=9.455 | L2-Norm(final)=13.378 | 3903.9 samples/s | 61.0 steps/s
[Step=40050 Epoch=195.1] | Loss=0.02721 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.458 | L2-Norm(final)=13.374 | 5367.2 samples/s | 83.9 steps/s
[Step=40100 Epoch=195.4] | Loss=0.02376 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.462 | L2-Norm(final)=13.373 | 5601.7 samples/s | 87.5 steps/s
[Step=40150 Epoch=195.6] | Loss=0.02250 | Reg=0.00090 | acc=0.9531 | L2-Norm=9.467 | L2-Norm(final)=13.373 | 5515.7 samples/s | 86.2 steps/s
[Step=40200 Epoch=195.9] | Loss=0.02199 | Reg=0.00090 | acc=0.9688 | L2-Norm=9.470 | L2-Norm(final)=13.374 | 7805.9 samples/s | 122.0 steps/s
[Step=40250 Epoch=196.1] | Loss=0.02122 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.473 | L2-Norm(final)=13.375 | 1945.4 samples/s | 30.4 steps/s
[Step=40300 Epoch=196.4] | Loss=0.02061 | Reg=0.00090 | acc=0.9688 | L2-Norm=9.476 | L2-Norm(final)=13.376 | 5702.6 samples/s | 89.1 steps/s
[Step=40350 Epoch=196.6] | Loss=0.01987 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.480 | L2-Norm(final)=13.378 | 5366.8 samples/s | 83.9 steps/s
[Step=40400 Epoch=196.8] | Loss=0.01973 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.483 | L2-Norm(final)=13.380 | 7155.9 samples/s | 111.8 steps/s
[Step=40450 Epoch=197.1] | Loss=0.01933 | Reg=0.00090 | acc=0.9375 | L2-Norm=9.486 | L2-Norm(final)=13.383 | 1961.7 samples/s | 30.7 steps/s
[Step=40500 Epoch=197.3] | Loss=0.01897 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.489 | L2-Norm(final)=13.385 | 5569.7 samples/s | 87.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=40501 Epoch=197.3] | Loss=0.01648 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.520 | L2-Norm(final)=13.411 | 3894.9 samples/s | 60.9 steps/s
[Step=40550 Epoch=197.6] | Loss=0.01521 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.526 | L2-Norm(final)=13.414 | 4771.2 samples/s | 74.6 steps/s
[Step=40600 Epoch=197.8] | Loss=0.01374 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.532 | L2-Norm(final)=13.418 | 4950.5 samples/s | 77.4 steps/s
[Step=40650 Epoch=198.1] | Loss=0.01360 | Reg=0.00091 | acc=0.9688 | L2-Norm=9.537 | L2-Norm(final)=13.422 | 4960.0 samples/s | 77.5 steps/s
[Step=40700 Epoch=198.3] | Loss=0.01334 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.543 | L2-Norm(final)=13.425 | 6586.1 samples/s | 102.9 steps/s
[Step=40750 Epoch=198.6] | Loss=0.01201 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.548 | L2-Norm(final)=13.428 | 1847.2 samples/s | 28.9 steps/s
[Step=40800 Epoch=198.8] | Loss=0.01106 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.552 | L2-Norm(final)=13.431 | 4942.5 samples/s | 77.2 steps/s
[Step=40850 Epoch=199.0] | Loss=0.01046 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.556 | L2-Norm(final)=13.434 | 4904.8 samples/s | 76.6 steps/s
[Step=40900 Epoch=199.3] | Loss=0.00985 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.560 | L2-Norm(final)=13.437 | 6158.0 samples/s | 96.2 steps/s
[Step=40950 Epoch=199.5] | Loss=0.00939 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.564 | L2-Norm(final)=13.440 | 1927.9 samples/s | 30.1 steps/s
[Step=41000 Epoch=199.8] | Loss=0.00892 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.567 | L2-Norm(final)=13.443 | 4875.3 samples/s | 76.2 steps/s
[Step=41050 Epoch=200.0] | Loss=0.00855 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.571 | L2-Norm(final)=13.445 | 4953.6 samples/s | 77.4 steps/s
[Step=41100 Epoch=200.3] | Loss=0.00823 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.574 | L2-Norm(final)=13.448 | 5677.7 samples/s | 88.7 steps/s
[Step=41150 Epoch=200.5] | Loss=0.00792 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=13.451 | 1957.1 samples/s | 30.6 steps/s
[Step=41200 Epoch=200.7] | Loss=0.00773 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.580 | L2-Norm(final)=13.453 | 4963.9 samples/s | 77.6 steps/s
[Step=41250 Epoch=201.0] | Loss=0.00746 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.583 | L2-Norm(final)=13.456 | 4978.2 samples/s | 77.8 steps/s
[Step=41300 Epoch=201.2] | Loss=0.00726 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.586 | L2-Norm(final)=13.458 | 5264.8 samples/s | 82.3 steps/s
[Step=41350 Epoch=201.5] | Loss=0.00700 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.589 | L2-Norm(final)=13.461 | 1996.4 samples/s | 31.2 steps/s
[Step=41400 Epoch=201.7] | Loss=0.00683 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.591 | L2-Norm(final)=13.463 | 4956.6 samples/s | 77.4 steps/s
[Step=41450 Epoch=202.0] | Loss=0.00662 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.594 | L2-Norm(final)=13.466 | 4945.8 samples/s | 77.3 steps/s
[Step=41500 Epoch=202.2] | Loss=0.00645 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.597 | L2-Norm(final)=13.468 | 5032.4 samples/s | 78.6 steps/s
[Step=41550 Epoch=202.5] | Loss=0.00633 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.599 | L2-Norm(final)=13.471 | 2040.7 samples/s | 31.9 steps/s
[Step=41600 Epoch=202.7] | Loss=0.00616 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.602 | L2-Norm(final)=13.473 | 5003.2 samples/s | 78.2 steps/s
[Step=41650 Epoch=202.9] | Loss=0.00601 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.604 | L2-Norm(final)=13.475 | 4924.8 samples/s | 76.9 steps/s
[Step=41700 Epoch=203.2] | Loss=0.00590 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.607 | L2-Norm(final)=13.478 | 4933.7 samples/s | 77.1 steps/s
[Step=41750 Epoch=203.4] | Loss=0.00582 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.609 | L2-Norm(final)=13.480 | 2052.3 samples/s | 32.1 steps/s
[Step=41800 Epoch=203.7] | Loss=0.00572 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.612 | L2-Norm(final)=13.482 | 5092.7 samples/s | 79.6 steps/s
[Step=41850 Epoch=203.9] | Loss=0.00564 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.614 | L2-Norm(final)=13.484 | 4908.9 samples/s | 76.7 steps/s
[Step=41900 Epoch=204.2] | Loss=0.00554 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.617 | L2-Norm(final)=13.487 | 4903.0 samples/s | 76.6 steps/s
[Step=41950 Epoch=204.4] | Loss=0.00547 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.619 | L2-Norm(final)=13.489 | 2065.2 samples/s | 32.3 steps/s
[Step=42000 Epoch=204.6] | Loss=0.00535 | Reg=0.00093 | acc=1.0000 | L2-Norm=9.621 | L2-Norm(final)=13.491 | 4971.8 samples/s | 77.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step42000.h5

Train client 4: client_asml1_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=48001 Epoch=235.4] | Loss=0.01143 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.455 | L2-Norm(final)=13.641 | 3835.0 samples/s | 59.9 steps/s
[Step=48050 Epoch=235.6] | Loss=0.01983 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.459 | L2-Norm(final)=13.640 | 5375.0 samples/s | 84.0 steps/s
[Step=48100 Epoch=235.9] | Loss=0.01815 | Reg=0.00090 | acc=0.9688 | L2-Norm=9.463 | L2-Norm(final)=13.640 | 5559.7 samples/s | 86.9 steps/s
[Step=48150 Epoch=236.1] | Loss=0.01737 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.467 | L2-Norm(final)=13.641 | 5471.9 samples/s | 85.5 steps/s
[Step=48200 Epoch=236.4] | Loss=0.01712 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.471 | L2-Norm(final)=13.643 | 7933.3 samples/s | 124.0 steps/s
[Step=48250 Epoch=236.6] | Loss=0.01630 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.475 | L2-Norm(final)=13.644 | 1914.7 samples/s | 29.9 steps/s
[Step=48300 Epoch=236.9] | Loss=0.01569 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.479 | L2-Norm(final)=13.647 | 5578.6 samples/s | 87.2 steps/s
[Step=48350 Epoch=237.1] | Loss=0.01550 | Reg=0.00090 | acc=0.9688 | L2-Norm=9.483 | L2-Norm(final)=13.649 | 5432.4 samples/s | 84.9 steps/s
[Step=48400 Epoch=237.3] | Loss=0.01505 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.486 | L2-Norm(final)=13.652 | 7498.9 samples/s | 117.2 steps/s
[Step=48450 Epoch=237.6] | Loss=0.01464 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.489 | L2-Norm(final)=13.654 | 1976.1 samples/s | 30.9 steps/s
[Step=48500 Epoch=237.8] | Loss=0.01423 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.493 | L2-Norm(final)=13.657 | 5477.2 samples/s | 85.6 steps/s
All layers training...
LR=0.00006, len=1
[Step=48501 Epoch=237.8] | Loss=0.00453 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.524 | L2-Norm(final)=13.684 | 3825.3 samples/s | 59.8 steps/s
[Step=48550 Epoch=238.1] | Loss=0.00932 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.528 | L2-Norm(final)=13.687 | 4872.0 samples/s | 76.1 steps/s
[Step=48600 Epoch=238.3] | Loss=0.01142 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.534 | L2-Norm(final)=13.690 | 4948.9 samples/s | 77.3 steps/s
[Step=48650 Epoch=238.6] | Loss=0.01119 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.539 | L2-Norm(final)=13.692 | 4919.0 samples/s | 76.9 steps/s
[Step=48700 Epoch=238.8] | Loss=0.01104 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.544 | L2-Norm(final)=13.695 | 6659.1 samples/s | 104.0 steps/s
[Step=48750 Epoch=239.1] | Loss=0.00974 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.548 | L2-Norm(final)=13.698 | 1872.4 samples/s | 29.3 steps/s
[Step=48800 Epoch=239.3] | Loss=0.00896 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.552 | L2-Norm(final)=13.700 | 4940.1 samples/s | 77.2 steps/s
[Step=48850 Epoch=239.6] | Loss=0.00836 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.556 | L2-Norm(final)=13.703 | 4830.8 samples/s | 75.5 steps/s
[Step=48900 Epoch=239.8] | Loss=0.00794 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.559 | L2-Norm(final)=13.706 | 6376.1 samples/s | 99.6 steps/s
[Step=48950 Epoch=240.0] | Loss=0.00755 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.563 | L2-Norm(final)=13.708 | 1877.1 samples/s | 29.3 steps/s
[Step=49000 Epoch=240.3] | Loss=0.00717 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.566 | L2-Norm(final)=13.711 | 4912.0 samples/s | 76.7 steps/s
[Step=49050 Epoch=240.5] | Loss=0.00690 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.569 | L2-Norm(final)=13.713 | 4892.5 samples/s | 76.4 steps/s
[Step=49100 Epoch=240.8] | Loss=0.00660 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.572 | L2-Norm(final)=13.716 | 6093.8 samples/s | 95.2 steps/s
[Step=49150 Epoch=241.0] | Loss=0.00630 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.575 | L2-Norm(final)=13.718 | 1901.3 samples/s | 29.7 steps/s
[Step=49200 Epoch=241.3] | Loss=0.00601 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.577 | L2-Norm(final)=13.721 | 4944.4 samples/s | 77.3 steps/s
[Step=49250 Epoch=241.5] | Loss=0.00589 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.580 | L2-Norm(final)=13.723 | 4907.3 samples/s | 76.7 steps/s
[Step=49300 Epoch=241.8] | Loss=0.00573 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.582 | L2-Norm(final)=13.725 | 5826.0 samples/s | 91.0 steps/s
[Step=49350 Epoch=242.0] | Loss=0.00564 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.585 | L2-Norm(final)=13.728 | 1924.9 samples/s | 30.1 steps/s
[Step=49400 Epoch=242.2] | Loss=0.00552 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.587 | L2-Norm(final)=13.730 | 4911.8 samples/s | 76.7 steps/s
[Step=49450 Epoch=242.5] | Loss=0.00538 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.590 | L2-Norm(final)=13.732 | 4991.9 samples/s | 78.0 steps/s
[Step=49500 Epoch=242.7] | Loss=0.00523 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.592 | L2-Norm(final)=13.734 | 5498.7 samples/s | 85.9 steps/s
[Step=49550 Epoch=243.0] | Loss=0.00510 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.594 | L2-Norm(final)=13.736 | 1955.6 samples/s | 30.6 steps/s
[Step=49600 Epoch=243.2] | Loss=0.00503 | Reg=0.00092 | acc=0.9844 | L2-Norm=9.597 | L2-Norm(final)=13.738 | 4980.7 samples/s | 77.8 steps/s
[Step=49650 Epoch=243.5] | Loss=0.00491 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.599 | L2-Norm(final)=13.741 | 4867.4 samples/s | 76.1 steps/s
[Step=49700 Epoch=243.7] | Loss=0.00480 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.601 | L2-Norm(final)=13.743 | 5335.4 samples/s | 83.4 steps/s
[Step=49750 Epoch=244.0] | Loss=0.00469 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.603 | L2-Norm(final)=13.745 | 1990.6 samples/s | 31.1 steps/s
[Step=49800 Epoch=244.2] | Loss=0.00460 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.605 | L2-Norm(final)=13.747 | 5011.3 samples/s | 78.3 steps/s
[Step=49850 Epoch=244.5] | Loss=0.00449 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.607 | L2-Norm(final)=13.749 | 4925.0 samples/s | 77.0 steps/s
[Step=49900 Epoch=244.7] | Loss=0.00446 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.609 | L2-Norm(final)=13.751 | 5084.7 samples/s | 79.4 steps/s
[Step=49950 Epoch=244.9] | Loss=0.00439 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.611 | L2-Norm(final)=13.753 | 2022.4 samples/s | 31.6 steps/s
[Step=50000 Epoch=245.2] | Loss=0.00431 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.613 | L2-Norm(final)=13.755 | 5052.1 samples/s | 78.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_4/client_state-step50000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=30001 Epoch=284.3] | Loss=0.01944 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.455 | L2-Norm(final)=7.551 | 3773.1 samples/s | 59.0 steps/s
[Step=30050 Epoch=284.7] | Loss=0.00125 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.460 | L2-Norm(final)=7.550 | 5110.4 samples/s | 79.8 steps/s
[Step=30100 Epoch=285.2] | Loss=0.00078 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.463 | L2-Norm(final)=7.554 | 7222.1 samples/s | 112.8 steps/s
[Step=30150 Epoch=285.7] | Loss=0.00056 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.464 | L2-Norm(final)=7.558 | 1888.6 samples/s | 29.5 steps/s
[Step=30200 Epoch=286.2] | Loss=0.00045 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.465 | L2-Norm(final)=7.562 | 6624.6 samples/s | 103.5 steps/s
[Step=30250 Epoch=286.6] | Loss=0.00039 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.465 | L2-Norm(final)=7.565 | 1911.7 samples/s | 29.9 steps/s
[Step=30300 Epoch=287.1] | Loss=0.00034 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.465 | L2-Norm(final)=7.568 | 6198.3 samples/s | 96.8 steps/s
[Step=30350 Epoch=287.6] | Loss=0.00031 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.465 | L2-Norm(final)=7.571 | 1983.7 samples/s | 31.0 steps/s
[Step=30400 Epoch=288.1] | Loss=0.00028 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.464 | L2-Norm(final)=7.574 | 5614.5 samples/s | 87.7 steps/s
[Step=30450 Epoch=288.5] | Loss=0.00025 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.464 | L2-Norm(final)=7.576 | 2022.3 samples/s | 31.6 steps/s
[Step=30500 Epoch=289.0] | Loss=0.00024 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.463 | L2-Norm(final)=7.579 | 5434.4 samples/s | 84.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=30501 Epoch=289.0] | Loss=0.00010 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.457 | L2-Norm(final)=7.605 | 3755.8 samples/s | 58.7 steps/s
[Step=30550 Epoch=289.5] | Loss=0.00006 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.456 | L2-Norm(final)=7.607 | 4528.7 samples/s | 70.8 steps/s
[Step=30600 Epoch=290.0] | Loss=0.00005 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.451 | L2-Norm(final)=7.608 | 6393.8 samples/s | 99.9 steps/s
[Step=30650 Epoch=290.4] | Loss=0.00004 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.447 | L2-Norm(final)=7.609 | 1818.8 samples/s | 28.4 steps/s
[Step=30700 Epoch=290.9] | Loss=0.00003 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.442 | L2-Norm(final)=7.610 | 5878.7 samples/s | 91.9 steps/s
[Step=30750 Epoch=291.4] | Loss=0.00003 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.436 | L2-Norm(final)=7.611 | 1848.7 samples/s | 28.9 steps/s
[Step=30800 Epoch=291.9] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.430 | L2-Norm(final)=7.611 | 5470.1 samples/s | 85.5 steps/s
[Step=30850 Epoch=292.3] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.423 | L2-Norm(final)=7.612 | 1899.8 samples/s | 29.7 steps/s
[Step=30900 Epoch=292.8] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.416 | L2-Norm(final)=7.612 | 5098.0 samples/s | 79.7 steps/s
[Step=30950 Epoch=293.3] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.410 | L2-Norm(final)=7.613 | 1940.6 samples/s | 30.3 steps/s
[Step=31000 Epoch=293.8] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.402 | L2-Norm(final)=7.613 | 4751.2 samples/s | 74.2 steps/s
[Step=31050 Epoch=294.2] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.395 | L2-Norm(final)=7.613 | 1982.3 samples/s | 31.0 steps/s
[Step=31100 Epoch=294.7] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.388 | L2-Norm(final)=7.614 | 4823.4 samples/s | 75.4 steps/s
[Step=31150 Epoch=295.2] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.380 | L2-Norm(final)=7.614 | 1982.5 samples/s | 31.0 steps/s
[Step=31200 Epoch=295.6] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.373 | L2-Norm(final)=7.614 | 4744.9 samples/s | 74.1 steps/s
[Step=31250 Epoch=296.1] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.365 | L2-Norm(final)=7.614 | 1997.2 samples/s | 31.2 steps/s
[Step=31300 Epoch=296.6] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.357 | L2-Norm(final)=7.615 | 4683.3 samples/s | 73.2 steps/s
[Step=31350 Epoch=297.1] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.349 | L2-Norm(final)=7.615 | 2030.4 samples/s | 31.7 steps/s
[Step=31400 Epoch=297.5] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.341 | L2-Norm(final)=7.615 | 4601.3 samples/s | 71.9 steps/s
[Step=31450 Epoch=298.0] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.333 | L2-Norm(final)=7.615 | 6441.9 samples/s | 100.7 steps/s
[Step=31500 Epoch=298.5] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.324 | L2-Norm(final)=7.615 | 1791.6 samples/s | 28.0 steps/s
[Step=31550 Epoch=299.0] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.316 | L2-Norm(final)=7.616 | 6053.0 samples/s | 94.6 steps/s
[Step=31600 Epoch=299.4] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.307 | L2-Norm(final)=7.616 | 1823.8 samples/s | 28.5 steps/s
[Step=31650 Epoch=299.9] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.298 | L2-Norm(final)=7.616 | 5513.2 samples/s | 86.1 steps/s
[Step=31700 Epoch=300.4] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.289 | L2-Norm(final)=7.616 | 1266.5 samples/s | 19.8 steps/s
[Step=31750 Epoch=300.9] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.280 | L2-Norm(final)=7.617 | 5303.8 samples/s | 82.9 steps/s
[Step=31800 Epoch=301.3] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.271 | L2-Norm(final)=7.617 | 1888.0 samples/s | 29.5 steps/s
[Step=31850 Epoch=301.8] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.262 | L2-Norm(final)=7.617 | 4906.8 samples/s | 76.7 steps/s
[Step=31900 Epoch=302.3] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.253 | L2-Norm(final)=7.617 | 1976.1 samples/s | 30.9 steps/s
[Step=31950 Epoch=302.8] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.243 | L2-Norm(final)=7.617 | 4760.6 samples/s | 74.4 steps/s
[Step=32000 Epoch=303.2] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.233 | L2-Norm(final)=7.618 | 2014.2 samples/s | 31.5 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_0/client_state-step32000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=40001 Epoch=380.5] | Loss=0.01813 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.455 | L2-Norm(final)=9.267 | 3897.2 samples/s | 60.9 steps/s
[Step=40050 Epoch=381.0] | Loss=0.00193 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.458 | L2-Norm(final)=9.270 | 4946.0 samples/s | 77.3 steps/s
[Step=40100 Epoch=381.5] | Loss=0.00123 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.465 | L2-Norm(final)=9.275 | 7523.6 samples/s | 117.6 steps/s
[Step=40150 Epoch=381.9] | Loss=0.00091 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.469 | L2-Norm(final)=9.278 | 1894.8 samples/s | 29.6 steps/s
[Step=40200 Epoch=382.4] | Loss=0.00075 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.471 | L2-Norm(final)=9.281 | 6547.7 samples/s | 102.3 steps/s
[Step=40250 Epoch=382.9] | Loss=0.00064 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.473 | L2-Norm(final)=9.284 | 1967.7 samples/s | 30.7 steps/s
[Step=40300 Epoch=383.4] | Loss=0.00056 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.475 | L2-Norm(final)=9.287 | 6146.0 samples/s | 96.0 steps/s
[Step=40350 Epoch=383.8] | Loss=0.00050 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.476 | L2-Norm(final)=9.289 | 1982.1 samples/s | 31.0 steps/s
[Step=40400 Epoch=384.3] | Loss=0.00045 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.476 | L2-Norm(final)=9.291 | 5736.3 samples/s | 89.6 steps/s
[Step=40450 Epoch=384.8] | Loss=0.00042 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.477 | L2-Norm(final)=9.293 | 2035.9 samples/s | 31.8 steps/s
[Step=40500 Epoch=385.3] | Loss=0.00039 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.477 | L2-Norm(final)=9.295 | 5448.0 samples/s | 85.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=40501 Epoch=385.3] | Loss=0.00003 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.482 | L2-Norm(final)=9.316 | 3947.0 samples/s | 61.7 steps/s
[Step=40550 Epoch=385.7] | Loss=0.00013 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.482 | L2-Norm(final)=9.317 | 4372.3 samples/s | 68.3 steps/s
[Step=40600 Epoch=386.2] | Loss=0.00008 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.481 | L2-Norm(final)=9.318 | 6363.9 samples/s | 99.4 steps/s
[Step=40650 Epoch=386.7] | Loss=0.00006 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.478 | L2-Norm(final)=9.319 | 1832.7 samples/s | 28.6 steps/s
[Step=40700 Epoch=387.2] | Loss=0.00005 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.475 | L2-Norm(final)=9.320 | 5798.1 samples/s | 90.6 steps/s
[Step=40750 Epoch=387.6] | Loss=0.00004 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.471 | L2-Norm(final)=9.320 | 1865.3 samples/s | 29.1 steps/s
[Step=40800 Epoch=388.1] | Loss=0.00004 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.467 | L2-Norm(final)=9.321 | 5422.4 samples/s | 84.7 steps/s
[Step=40850 Epoch=388.6] | Loss=0.00003 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.463 | L2-Norm(final)=9.321 | 1898.1 samples/s | 29.7 steps/s
[Step=40900 Epoch=389.1] | Loss=0.00003 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.459 | L2-Norm(final)=9.321 | 5088.3 samples/s | 79.5 steps/s
[Step=40950 Epoch=389.5] | Loss=0.00003 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.454 | L2-Norm(final)=9.321 | 1953.7 samples/s | 30.5 steps/s
[Step=41000 Epoch=390.0] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.450 | L2-Norm(final)=9.322 | 4764.3 samples/s | 74.4 steps/s
[Step=41050 Epoch=390.5] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.445 | L2-Norm(final)=9.322 | 1968.5 samples/s | 30.8 steps/s
[Step=41100 Epoch=391.0] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.440 | L2-Norm(final)=9.322 | 4846.1 samples/s | 75.7 steps/s
[Step=41150 Epoch=391.4] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.436 | L2-Norm(final)=9.322 | 2003.3 samples/s | 31.3 steps/s
[Step=41200 Epoch=391.9] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.431 | L2-Norm(final)=9.323 | 4672.4 samples/s | 73.0 steps/s
[Step=41250 Epoch=392.4] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.425 | L2-Norm(final)=9.323 | 2015.5 samples/s | 31.5 steps/s
[Step=41300 Epoch=392.9] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.420 | L2-Norm(final)=9.323 | 4644.5 samples/s | 72.6 steps/s
[Step=41350 Epoch=393.3] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.415 | L2-Norm(final)=9.323 | 2101.3 samples/s | 32.8 steps/s
[Step=41400 Epoch=393.8] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.410 | L2-Norm(final)=9.323 | 4364.7 samples/s | 68.2 steps/s
[Step=41450 Epoch=394.3] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.404 | L2-Norm(final)=9.324 | 6528.8 samples/s | 102.0 steps/s
[Step=41500 Epoch=394.8] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.398 | L2-Norm(final)=9.324 | 1796.8 samples/s | 28.1 steps/s
[Step=41550 Epoch=395.2] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.393 | L2-Norm(final)=9.324 | 5957.6 samples/s | 93.1 steps/s
[Step=41600 Epoch=395.7] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.387 | L2-Norm(final)=9.324 | 1841.6 samples/s | 28.8 steps/s
[Step=41650 Epoch=396.2] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.381 | L2-Norm(final)=9.324 | 5536.8 samples/s | 86.5 steps/s
[Step=41700 Epoch=396.7] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.375 | L2-Norm(final)=9.325 | 1878.0 samples/s | 29.3 steps/s
[Step=41750 Epoch=397.1] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.369 | L2-Norm(final)=9.325 | 5210.5 samples/s | 81.4 steps/s
[Step=41800 Epoch=397.6] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.363 | L2-Norm(final)=9.325 | 1925.2 samples/s | 30.1 steps/s
[Step=41850 Epoch=398.1] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.357 | L2-Norm(final)=9.325 | 4947.8 samples/s | 77.3 steps/s
[Step=41900 Epoch=398.6] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.350 | L2-Norm(final)=9.325 | 1955.7 samples/s | 30.6 steps/s
[Step=41950 Epoch=399.0] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.344 | L2-Norm(final)=9.325 | 4722.2 samples/s | 73.8 steps/s
[Step=42000 Epoch=399.5] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.337 | L2-Norm(final)=9.326 | 1992.7 samples/s | 31.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step42000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=46001 Epoch=438.4] | Loss=0.00004 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.455 | L2-Norm(final)=9.793 | 3810.2 samples/s | 59.5 steps/s
[Step=46050 Epoch=438.9] | Loss=0.00313 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.461 | L2-Norm(final)=9.794 | 4955.5 samples/s | 77.4 steps/s
[Step=46100 Epoch=439.4] | Loss=0.00178 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.467 | L2-Norm(final)=9.797 | 7610.3 samples/s | 118.9 steps/s
[Step=46150 Epoch=439.9] | Loss=0.00129 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.470 | L2-Norm(final)=9.800 | 1868.3 samples/s | 29.2 steps/s
[Step=46200 Epoch=440.3] | Loss=0.00103 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.472 | L2-Norm(final)=9.803 | 7002.0 samples/s | 109.4 steps/s
[Step=46250 Epoch=440.8] | Loss=0.00087 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.473 | L2-Norm(final)=9.806 | 1912.0 samples/s | 29.9 steps/s
[Step=46300 Epoch=441.3] | Loss=0.00076 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.475 | L2-Norm(final)=9.809 | 6513.5 samples/s | 101.8 steps/s
[Step=46350 Epoch=441.8] | Loss=0.00068 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.476 | L2-Norm(final)=9.812 | 1933.2 samples/s | 30.2 steps/s
[Step=46400 Epoch=442.2] | Loss=0.00061 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.476 | L2-Norm(final)=9.814 | 5977.3 samples/s | 93.4 steps/s
[Step=46450 Epoch=442.7] | Loss=0.00056 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.477 | L2-Norm(final)=9.817 | 1968.8 samples/s | 30.8 steps/s
[Step=46500 Epoch=443.2] | Loss=0.00052 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.478 | L2-Norm(final)=9.819 | 5666.9 samples/s | 88.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=443.2] | Loss=0.00017 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.483 | L2-Norm(final)=9.841 | 4021.3 samples/s | 62.8 steps/s
[Step=46550 Epoch=443.7] | Loss=0.00094 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.489 | L2-Norm(final)=9.843 | 4189.8 samples/s | 65.5 steps/s
[Step=46600 Epoch=444.1] | Loss=0.00056 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.494 | L2-Norm(final)=9.844 | 6480.0 samples/s | 101.2 steps/s
[Step=46650 Epoch=444.6] | Loss=0.00039 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.497 | L2-Norm(final)=9.844 | 1787.3 samples/s | 27.9 steps/s
[Step=46700 Epoch=445.1] | Loss=0.00030 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.497 | L2-Norm(final)=9.845 | 6020.6 samples/s | 94.1 steps/s
[Step=46750 Epoch=445.6] | Loss=0.00024 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.497 | L2-Norm(final)=9.845 | 1840.6 samples/s | 28.8 steps/s
[Step=46800 Epoch=446.0] | Loss=0.00021 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.496 | L2-Norm(final)=9.846 | 5587.7 samples/s | 87.3 steps/s
[Step=46850 Epoch=446.5] | Loss=0.00018 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.496 | L2-Norm(final)=9.846 | 1875.1 samples/s | 29.3 steps/s
[Step=46900 Epoch=447.0] | Loss=0.00016 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.495 | L2-Norm(final)=9.847 | 5329.9 samples/s | 83.3 steps/s
[Step=46950 Epoch=447.5] | Loss=0.00014 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.493 | L2-Norm(final)=9.847 | 1898.8 samples/s | 29.7 steps/s
[Step=47000 Epoch=448.0] | Loss=0.00013 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.492 | L2-Norm(final)=9.848 | 5060.8 samples/s | 79.1 steps/s
[Step=47050 Epoch=448.4] | Loss=0.00012 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.491 | L2-Norm(final)=9.848 | 1955.0 samples/s | 30.5 steps/s
[Step=47100 Epoch=448.9] | Loss=0.00011 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.490 | L2-Norm(final)=9.848 | 4761.5 samples/s | 74.4 steps/s
[Step=47150 Epoch=449.4] | Loss=0.00010 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.488 | L2-Norm(final)=9.849 | 2009.7 samples/s | 31.4 steps/s
[Step=47200 Epoch=449.9] | Loss=0.00010 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.487 | L2-Norm(final)=9.849 | 4645.0 samples/s | 72.6 steps/s
[Step=47250 Epoch=450.3] | Loss=0.00009 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.485 | L2-Norm(final)=9.850 | 1995.8 samples/s | 31.2 steps/s
[Step=47300 Epoch=450.8] | Loss=0.00009 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.484 | L2-Norm(final)=9.850 | 4802.6 samples/s | 75.0 steps/s
[Step=47350 Epoch=451.3] | Loss=0.00008 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.482 | L2-Norm(final)=9.850 | 2007.8 samples/s | 31.4 steps/s
[Step=47400 Epoch=451.8] | Loss=0.00008 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.480 | L2-Norm(final)=9.851 | 4720.4 samples/s | 73.8 steps/s
[Step=47450 Epoch=452.2] | Loss=0.00007 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.478 | L2-Norm(final)=9.851 | 2014.4 samples/s | 31.5 steps/s
[Step=47500 Epoch=452.7] | Loss=0.00007 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.477 | L2-Norm(final)=9.851 | 4667.8 samples/s | 72.9 steps/s
[Step=47550 Epoch=453.2] | Loss=0.00007 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.475 | L2-Norm(final)=9.852 | 6956.2 samples/s | 108.7 steps/s
[Step=47600 Epoch=453.7] | Loss=0.00007 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.473 | L2-Norm(final)=9.852 | 1768.4 samples/s | 27.6 steps/s
[Step=47650 Epoch=454.1] | Loss=0.00006 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.471 | L2-Norm(final)=9.852 | 6397.7 samples/s | 100.0 steps/s
[Step=47700 Epoch=454.6] | Loss=0.00006 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.469 | L2-Norm(final)=9.853 | 1797.1 samples/s | 28.1 steps/s
[Step=47750 Epoch=455.1] | Loss=0.00006 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.467 | L2-Norm(final)=9.853 | 6016.5 samples/s | 94.0 steps/s
[Step=47800 Epoch=455.6] | Loss=0.00006 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.465 | L2-Norm(final)=9.854 | 1821.0 samples/s | 28.5 steps/s
[Step=47850 Epoch=456.1] | Loss=0.00005 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.463 | L2-Norm(final)=9.854 | 5662.7 samples/s | 88.5 steps/s
[Step=47900 Epoch=456.5] | Loss=0.00005 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.461 | L2-Norm(final)=9.854 | 1858.7 samples/s | 29.0 steps/s
[Step=47950 Epoch=457.0] | Loss=0.00005 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.459 | L2-Norm(final)=9.855 | 5335.0 samples/s | 83.4 steps/s
[Step=48000 Epoch=457.5] | Loss=0.00005 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.457 | L2-Norm(final)=9.855 | 1919.2 samples/s | 30.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step48000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07974 | acc=0.9621 | tpr=0.9682 | fpr=0.0510 | 4428.3 samples/s | 17.3 steps/s
Avg test loss: 0.08311, Avg test acc: 0.96013, Avg tpr: 0.96672, Avg fpr: 0.05435, total FA: 424

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08460 | acc=0.9618 | tpr=0.9732 | fpr=0.0629 | 4371.9 samples/s | 17.1 steps/s
Avg test loss: 0.08895, Avg test acc: 0.96218, Avg tpr: 0.97354, Avg fpr: 0.06281, total FA: 490

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08230 | acc=0.9610 | tpr=0.9719 | fpr=0.0627 | 4383.0 samples/s | 17.1 steps/s
Avg test loss: 0.08605, Avg test acc: 0.96025, Avg tpr: 0.97057, Avg fpr: 0.06243, total FA: 487

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.07795 | acc=0.9627 | tpr=0.9764 | fpr=0.0669 | 4449.0 samples/s | 17.4 steps/s
Avg test loss: 0.08168, Avg test acc: 0.96210, Avg tpr: 0.97570, Avg fpr: 0.06781, total FA: 529

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08155 | acc=0.9628 | tpr=0.9752 | fpr=0.0642 | 4409.0 samples/s | 17.2 steps/s
Avg test loss: 0.08931, Avg test acc: 0.96158, Avg tpr: 0.97377, Avg fpr: 0.06525, total FA: 509

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.20203 | acc=0.2966 | tpr=0.0027 | fpr=0.0652 | 4397.2 samples/s | 17.2 steps/s
Avg test loss: 5.21621, Avg test acc: 0.29357, Avg tpr: 0.00321, Avg fpr: 0.06781, total FA: 529

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.75038 | acc=0.3139 | tpr=0.0043 | fpr=0.0139 | 4368.1 samples/s | 17.1 steps/s
Avg test loss: 4.75907, Avg test acc: 0.31124, Avg tpr: 0.00501, Avg fpr: 0.01525, total FA: 119

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.09399 | acc=0.3040 | tpr=0.0055 | fpr=0.0478 | 4332.4 samples/s | 16.9 steps/s
Avg test loss: 5.10431, Avg test acc: 0.30155, Avg tpr: 0.00618, Avg fpr: 0.04884, total FA: 381

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.23768 | acc=0.3047 | tpr=0.0030 | fpr=0.0401 | 4580.5 samples/s | 17.9 steps/s
Avg test loss: 5.25293, Avg test acc: 0.30175, Avg tpr: 0.00356, Avg fpr: 0.04243, total FA: 331

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.61184 | acc=0.3137 | tpr=0.0027 | fpr=0.0111 | 4418.8 samples/s | 17.3 steps/s
Avg test loss: 4.62498, Avg test acc: 0.31096, Avg tpr: 0.00303, Avg fpr: 0.01179, total FA: 92

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.72275 | acc=0.1320 | tpr=0.8230 | fpr=0.8804 | 4349.1 samples/s | 17.0 steps/s
[Step= 100] | Loss=4.67462 | acc=0.1350 | tpr=0.8060 | fpr=0.8776 | 8590.5 samples/s | 33.6 steps/s
[Step= 150] | Loss=4.67551 | acc=0.1338 | tpr=0.8228 | fpr=0.8789 | 8770.4 samples/s | 34.3 steps/s
[Step= 200] | Loss=4.67493 | acc=0.1330 | tpr=0.8208 | fpr=0.8795 | 8645.2 samples/s | 33.8 steps/s
[Step= 250] | Loss=4.67950 | acc=0.1343 | tpr=0.8227 | fpr=0.8782 | 8732.1 samples/s | 34.1 steps/s
[Step= 300] | Loss=4.67459 | acc=0.1342 | tpr=0.8189 | fpr=0.8782 | 8536.6 samples/s | 33.3 steps/s
[Step= 350] | Loss=4.67051 | acc=0.1337 | tpr=0.8153 | fpr=0.8787 | 8674.0 samples/s | 33.9 steps/s
[Step= 400] | Loss=4.67389 | acc=0.1339 | tpr=0.8129 | fpr=0.8784 | 8929.7 samples/s | 34.9 steps/s
[Step= 450] | Loss=4.67614 | acc=0.1337 | tpr=0.8092 | fpr=0.8785 | 8756.6 samples/s | 34.2 steps/s
[Step= 500] | Loss=4.67901 | acc=0.1336 | tpr=0.8093 | fpr=0.8786 | 8334.7 samples/s | 32.6 steps/s
[Step= 550] | Loss=4.67745 | acc=0.1334 | tpr=0.8114 | fpr=0.8790 | 16004.7 samples/s | 62.5 steps/s
Avg test loss: 4.67916, Avg test acc: 0.13328, Avg tpr: 0.81062, Avg fpr: 0.87903, total FA: 122052

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.98266 | acc=0.1357 | tpr=0.7965 | fpr=0.8762 | 4397.0 samples/s | 17.2 steps/s
[Step= 100] | Loss=4.93114 | acc=0.1381 | tpr=0.7804 | fpr=0.8739 | 8578.6 samples/s | 33.5 steps/s
[Step= 150] | Loss=4.93290 | acc=0.1366 | tpr=0.7824 | fpr=0.8753 | 9509.7 samples/s | 37.1 steps/s
[Step= 200] | Loss=4.93346 | acc=0.1365 | tpr=0.7825 | fpr=0.8753 | 7925.9 samples/s | 31.0 steps/s
[Step= 250] | Loss=4.93309 | acc=0.1373 | tpr=0.7799 | fpr=0.8744 | 8584.1 samples/s | 33.5 steps/s
[Step= 300] | Loss=4.92990 | acc=0.1368 | tpr=0.7811 | fpr=0.8750 | 8476.1 samples/s | 33.1 steps/s
[Step= 350] | Loss=4.92459 | acc=0.1364 | tpr=0.7802 | fpr=0.8753 | 8860.3 samples/s | 34.6 steps/s
[Step= 400] | Loss=4.92582 | acc=0.1361 | tpr=0.7735 | fpr=0.8755 | 8548.5 samples/s | 33.4 steps/s
[Step= 450] | Loss=4.93064 | acc=0.1361 | tpr=0.7707 | fpr=0.8755 | 8675.3 samples/s | 33.9 steps/s
[Step= 500] | Loss=4.93583 | acc=0.1357 | tpr=0.7705 | fpr=0.8757 | 8551.5 samples/s | 33.4 steps/s
[Step= 550] | Loss=4.93403 | acc=0.1357 | tpr=0.7728 | fpr=0.8758 | 15019.0 samples/s | 58.7 steps/s
Avg test loss: 4.93554, Avg test acc: 0.13571, Avg tpr: 0.77219, Avg fpr: 0.87586, total FA: 121612

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.46828 | acc=0.1208 | tpr=0.8186 | fpr=0.8918 | 4393.0 samples/s | 17.2 steps/s
[Step= 100] | Loss=5.41795 | acc=0.1238 | tpr=0.8124 | fpr=0.8890 | 8738.5 samples/s | 34.1 steps/s
[Step= 150] | Loss=5.42013 | acc=0.1219 | tpr=0.8329 | fpr=0.8912 | 8543.9 samples/s | 33.4 steps/s
[Step= 200] | Loss=5.42166 | acc=0.1207 | tpr=0.8361 | fpr=0.8924 | 8496.2 samples/s | 33.2 steps/s
[Step= 250] | Loss=5.42173 | acc=0.1216 | tpr=0.8367 | fpr=0.8914 | 8799.2 samples/s | 34.4 steps/s
[Step= 300] | Loss=5.41782 | acc=0.1214 | tpr=0.8378 | fpr=0.8917 | 8514.8 samples/s | 33.3 steps/s
[Step= 350] | Loss=5.41631 | acc=0.1213 | tpr=0.8384 | fpr=0.8917 | 8903.8 samples/s | 34.8 steps/s
[Step= 400] | Loss=5.41921 | acc=0.1215 | tpr=0.8359 | fpr=0.8915 | 8685.6 samples/s | 33.9 steps/s
[Step= 450] | Loss=5.42343 | acc=0.1209 | tpr=0.8296 | fpr=0.8920 | 8268.6 samples/s | 32.3 steps/s
[Step= 500] | Loss=5.42448 | acc=0.1210 | tpr=0.8308 | fpr=0.8918 | 8697.8 samples/s | 34.0 steps/s
[Step= 550] | Loss=5.42333 | acc=0.1209 | tpr=0.8357 | fpr=0.8921 | 14752.1 samples/s | 57.6 steps/s
Avg test loss: 5.42456, Avg test acc: 0.12082, Avg tpr: 0.83518, Avg fpr: 0.89217, total FA: 123876

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=5.10700 | acc=0.1279 | tpr=0.7965 | fpr=0.8841 | 4377.6 samples/s | 17.1 steps/s
[Step= 100] | Loss=5.05935 | acc=0.1309 | tpr=0.7825 | fpr=0.8813 | 8507.6 samples/s | 33.2 steps/s
[Step= 150] | Loss=5.05855 | acc=0.1292 | tpr=0.7954 | fpr=0.8831 | 8520.5 samples/s | 33.3 steps/s
[Step= 200] | Loss=5.05458 | acc=0.1282 | tpr=0.7934 | fpr=0.8839 | 9417.6 samples/s | 36.8 steps/s
[Step= 250] | Loss=5.05695 | acc=0.1288 | tpr=0.7956 | fpr=0.8833 | 8046.2 samples/s | 31.4 steps/s
[Step= 300] | Loss=5.05253 | acc=0.1279 | tpr=0.7920 | fpr=0.8842 | 8807.0 samples/s | 34.4 steps/s
[Step= 350] | Loss=5.04792 | acc=0.1276 | tpr=0.7902 | fpr=0.8844 | 8724.4 samples/s | 34.1 steps/s
[Step= 400] | Loss=5.05109 | acc=0.1275 | tpr=0.7834 | fpr=0.8845 | 8571.7 samples/s | 33.5 steps/s
[Step= 450] | Loss=5.05626 | acc=0.1271 | tpr=0.7790 | fpr=0.8848 | 8471.0 samples/s | 33.1 steps/s
[Step= 500] | Loss=5.05932 | acc=0.1269 | tpr=0.7819 | fpr=0.8849 | 8582.8 samples/s | 33.5 steps/s
[Step= 550] | Loss=5.05761 | acc=0.1268 | tpr=0.7871 | fpr=0.8852 | 16054.6 samples/s | 62.7 steps/s
Avg test loss: 5.05925, Avg test acc: 0.12671, Avg tpr: 0.78645, Avg fpr: 0.88528, total FA: 122920

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.27558 | acc=0.1270 | tpr=0.7345 | fpr=0.8840 | 4374.8 samples/s | 17.1 steps/s
[Step= 100] | Loss=5.22285 | acc=0.1293 | tpr=0.7122 | fpr=0.8816 | 8862.9 samples/s | 34.6 steps/s
[Step= 150] | Loss=5.22306 | acc=0.1277 | tpr=0.7104 | fpr=0.8831 | 8448.0 samples/s | 33.0 steps/s
[Step= 200] | Loss=5.22146 | acc=0.1272 | tpr=0.7093 | fpr=0.8834 | 8931.9 samples/s | 34.9 steps/s
[Step= 250] | Loss=5.22502 | acc=0.1280 | tpr=0.7092 | fpr=0.8826 | 8441.7 samples/s | 33.0 steps/s
[Step= 300] | Loss=5.21962 | acc=0.1274 | tpr=0.7120 | fpr=0.8832 | 8663.4 samples/s | 33.8 steps/s
[Step= 350] | Loss=5.21644 | acc=0.1267 | tpr=0.7101 | fpr=0.8838 | 8404.7 samples/s | 32.8 steps/s
[Step= 400] | Loss=5.21986 | acc=0.1270 | tpr=0.7084 | fpr=0.8836 | 9312.4 samples/s | 36.4 steps/s
[Step= 450] | Loss=5.22360 | acc=0.1264 | tpr=0.7020 | fpr=0.8841 | 8102.8 samples/s | 31.7 steps/s
[Step= 500] | Loss=5.22615 | acc=0.1261 | tpr=0.6982 | fpr=0.8842 | 8581.9 samples/s | 33.5 steps/s
[Step= 550] | Loss=5.22496 | acc=0.1259 | tpr=0.6968 | fpr=0.8845 | 15685.6 samples/s | 61.3 steps/s
Avg test loss: 5.22706, Avg test acc: 0.12580, Avg tpr: 0.69651, Avg fpr: 0.88457, total FA: 122821

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10037 | acc=0.9819 | tpr=0.9469 | fpr=0.0175 | 4398.2 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.10442 | acc=0.9810 | tpr=0.9574 | fpr=0.0185 | 8564.0 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.10817 | acc=0.9800 | tpr=0.9568 | fpr=0.0196 | 8815.7 samples/s | 34.4 steps/s
[Step= 200] | Loss=0.11032 | acc=0.9800 | tpr=0.9617 | fpr=0.0197 | 8280.6 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.10986 | acc=0.9799 | tpr=0.9546 | fpr=0.0196 | 8781.3 samples/s | 34.3 steps/s
[Step= 300] | Loss=0.11201 | acc=0.9796 | tpr=0.9542 | fpr=0.0200 | 8761.8 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.11187 | acc=0.9794 | tpr=0.9530 | fpr=0.0201 | 8525.2 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.11285 | acc=0.9793 | tpr=0.9497 | fpr=0.0202 | 8660.6 samples/s | 33.8 steps/s
[Step= 450] | Loss=0.11554 | acc=0.9790 | tpr=0.9484 | fpr=0.0204 | 8637.6 samples/s | 33.7 steps/s
[Step= 500] | Loss=0.11531 | acc=0.9790 | tpr=0.9493 | fpr=0.0204 | 8849.9 samples/s | 34.6 steps/s
[Step= 550] | Loss=0.11437 | acc=0.9792 | tpr=0.9491 | fpr=0.0203 | 15186.2 samples/s | 59.3 steps/s
Avg test loss: 0.11420, Avg test acc: 0.97922, Avg tpr: 0.94929, Avg fpr: 0.02024, total FA: 2810

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11242 | acc=0.9810 | tpr=0.9159 | fpr=0.0178 | 4401.2 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.11684 | acc=0.9810 | tpr=0.9296 | fpr=0.0181 | 8838.9 samples/s | 34.5 steps/s
[Step= 150] | Loss=0.12137 | acc=0.9800 | tpr=0.9251 | fpr=0.0190 | 8529.5 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.12293 | acc=0.9800 | tpr=0.9301 | fpr=0.0191 | 8711.8 samples/s | 34.0 steps/s
[Step= 250] | Loss=0.12191 | acc=0.9798 | tpr=0.9293 | fpr=0.0192 | 8501.3 samples/s | 33.2 steps/s
[Step= 300] | Loss=0.12434 | acc=0.9794 | tpr=0.9316 | fpr=0.0197 | 8388.6 samples/s | 32.8 steps/s
[Step= 350] | Loss=0.12457 | acc=0.9792 | tpr=0.9343 | fpr=0.0200 | 8896.9 samples/s | 34.8 steps/s
[Step= 400] | Loss=0.12556 | acc=0.9791 | tpr=0.9316 | fpr=0.0201 | 8501.7 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.12872 | acc=0.9788 | tpr=0.9304 | fpr=0.0203 | 8699.1 samples/s | 34.0 steps/s
[Step= 500] | Loss=0.12819 | acc=0.9789 | tpr=0.9326 | fpr=0.0203 | 8994.3 samples/s | 35.1 steps/s
[Step= 550] | Loss=0.12730 | acc=0.9790 | tpr=0.9320 | fpr=0.0202 | 14238.3 samples/s | 55.6 steps/s
Avg test loss: 0.12705, Avg test acc: 0.97900, Avg tpr: 0.93185, Avg fpr: 0.02014, total FA: 2797

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10780 | acc=0.9799 | tpr=0.9425 | fpr=0.0194 | 4337.1 samples/s | 16.9 steps/s
[Step= 100] | Loss=0.11134 | acc=0.9796 | tpr=0.9595 | fpr=0.0200 | 8707.0 samples/s | 34.0 steps/s
[Step= 150] | Loss=0.11536 | acc=0.9783 | tpr=0.9553 | fpr=0.0213 | 8841.0 samples/s | 34.5 steps/s
[Step= 200] | Loss=0.11729 | acc=0.9782 | tpr=0.9585 | fpr=0.0214 | 8690.1 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.11656 | acc=0.9782 | tpr=0.9563 | fpr=0.0214 | 8448.3 samples/s | 33.0 steps/s
[Step= 300] | Loss=0.11894 | acc=0.9778 | tpr=0.9564 | fpr=0.0218 | 8420.7 samples/s | 32.9 steps/s
[Step= 350] | Loss=0.11889 | acc=0.9777 | tpr=0.9574 | fpr=0.0219 | 8807.9 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.12010 | acc=0.9776 | tpr=0.9551 | fpr=0.0220 | 8574.9 samples/s | 33.5 steps/s
[Step= 450] | Loss=0.12293 | acc=0.9775 | tpr=0.9547 | fpr=0.0221 | 8567.3 samples/s | 33.5 steps/s
[Step= 500] | Loss=0.12257 | acc=0.9775 | tpr=0.9564 | fpr=0.0221 | 8704.5 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.12156 | acc=0.9777 | tpr=0.9566 | fpr=0.0219 | 15021.7 samples/s | 58.7 steps/s
Avg test loss: 0.12139, Avg test acc: 0.97775, Avg tpr: 0.95681, Avg fpr: 0.02187, total FA: 3036

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10260 | acc=0.9815 | tpr=0.9248 | fpr=0.0175 | 4347.8 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.10711 | acc=0.9809 | tpr=0.9424 | fpr=0.0184 | 8395.9 samples/s | 32.8 steps/s
[Step= 150] | Loss=0.11125 | acc=0.9802 | tpr=0.9438 | fpr=0.0191 | 8700.1 samples/s | 34.0 steps/s
[Step= 200] | Loss=0.11355 | acc=0.9802 | tpr=0.9519 | fpr=0.0193 | 8548.6 samples/s | 33.4 steps/s
[Step= 250] | Loss=0.11248 | acc=0.9802 | tpr=0.9476 | fpr=0.0192 | 8579.4 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.11420 | acc=0.9800 | tpr=0.9484 | fpr=0.0195 | 8660.4 samples/s | 33.8 steps/s
[Step= 350] | Loss=0.11438 | acc=0.9799 | tpr=0.9512 | fpr=0.0196 | 8660.0 samples/s | 33.8 steps/s
[Step= 400] | Loss=0.11508 | acc=0.9797 | tpr=0.9486 | fpr=0.0197 | 8744.5 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.11789 | acc=0.9795 | tpr=0.9479 | fpr=0.0200 | 8551.3 samples/s | 33.4 steps/s
[Step= 500] | Loss=0.11745 | acc=0.9795 | tpr=0.9489 | fpr=0.0199 | 9334.3 samples/s | 36.5 steps/s
[Step= 550] | Loss=0.11658 | acc=0.9797 | tpr=0.9471 | fpr=0.0197 | 13588.2 samples/s | 53.1 steps/s
Avg test loss: 0.11640, Avg test acc: 0.97969, Avg tpr: 0.94691, Avg fpr: 0.01971, total FA: 2737

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.11775 | acc=0.9806 | tpr=0.9336 | fpr=0.0185 | 4296.8 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.12212 | acc=0.9803 | tpr=0.9510 | fpr=0.0192 | 8828.1 samples/s | 34.5 steps/s
[Step= 150] | Loss=0.12787 | acc=0.9790 | tpr=0.9496 | fpr=0.0205 | 8764.0 samples/s | 34.2 steps/s
[Step= 200] | Loss=0.12987 | acc=0.9789 | tpr=0.9552 | fpr=0.0206 | 8451.7 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.12881 | acc=0.9790 | tpr=0.9511 | fpr=0.0205 | 8766.6 samples/s | 34.2 steps/s
[Step= 300] | Loss=0.13143 | acc=0.9787 | tpr=0.9513 | fpr=0.0208 | 8234.0 samples/s | 32.2 steps/s
[Step= 350] | Loss=0.13219 | acc=0.9784 | tpr=0.9537 | fpr=0.0211 | 8554.8 samples/s | 33.4 steps/s
[Step= 400] | Loss=0.13307 | acc=0.9783 | tpr=0.9508 | fpr=0.0212 | 8668.8 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.13632 | acc=0.9780 | tpr=0.9503 | fpr=0.0215 | 8764.1 samples/s | 34.2 steps/s
[Step= 500] | Loss=0.13575 | acc=0.9780 | tpr=0.9507 | fpr=0.0215 | 8478.8 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.13495 | acc=0.9781 | tpr=0.9491 | fpr=0.0214 | 15595.5 samples/s | 60.9 steps/s
Avg test loss: 0.13473, Avg test acc: 0.97808, Avg tpr: 0.94889, Avg fpr: 0.02139, total FA: 2970

server round 43/50

clients selected: [1 3 6 7 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=50001 Epoch=244.0] | Loss=0.01880 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.415 | L2-Norm(final)=13.466 | 3863.7 samples/s | 60.4 steps/s
[Step=50050 Epoch=244.2] | Loss=0.02180 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.420 | L2-Norm(final)=13.463 | 5361.5 samples/s | 83.8 steps/s
[Step=50100 Epoch=244.5] | Loss=0.01938 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.423 | L2-Norm(final)=13.462 | 5538.1 samples/s | 86.5 steps/s
[Step=50150 Epoch=244.7] | Loss=0.01982 | Reg=0.00089 | acc=0.9688 | L2-Norm=9.427 | L2-Norm(final)=13.463 | 5535.5 samples/s | 86.5 steps/s
[Step=50200 Epoch=245.0] | Loss=0.01831 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.430 | L2-Norm(final)=13.464 | 7796.2 samples/s | 121.8 steps/s
[Step=50250 Epoch=245.2] | Loss=0.01757 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.433 | L2-Norm(final)=13.465 | 1939.9 samples/s | 30.3 steps/s
[Step=50300 Epoch=245.4] | Loss=0.01670 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.437 | L2-Norm(final)=13.467 | 5495.8 samples/s | 85.9 steps/s
[Step=50350 Epoch=245.7] | Loss=0.01658 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.440 | L2-Norm(final)=13.468 | 5518.8 samples/s | 86.2 steps/s
[Step=50400 Epoch=245.9] | Loss=0.01639 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.443 | L2-Norm(final)=13.470 | 7263.1 samples/s | 113.5 steps/s
[Step=50450 Epoch=246.2] | Loss=0.01587 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.447 | L2-Norm(final)=13.473 | 1976.9 samples/s | 30.9 steps/s
[Step=50500 Epoch=246.4] | Loss=0.01551 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.450 | L2-Norm(final)=13.475 | 5555.3 samples/s | 86.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=50501 Epoch=246.4] | Loss=0.00284 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.483 | L2-Norm(final)=13.497 | 3965.3 samples/s | 62.0 steps/s
[Step=50550 Epoch=246.7] | Loss=0.01222 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.487 | L2-Norm(final)=13.500 | 4671.9 samples/s | 73.0 steps/s
[Step=50600 Epoch=246.9] | Loss=0.01321 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.492 | L2-Norm(final)=13.503 | 4942.3 samples/s | 77.2 steps/s
[Step=50650 Epoch=247.1] | Loss=0.01165 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.497 | L2-Norm(final)=13.505 | 4921.0 samples/s | 76.9 steps/s
[Step=50700 Epoch=247.4] | Loss=0.01123 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.501 | L2-Norm(final)=13.508 | 6662.6 samples/s | 104.1 steps/s
[Step=50750 Epoch=247.6] | Loss=0.01001 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.506 | L2-Norm(final)=13.511 | 1874.8 samples/s | 29.3 steps/s
[Step=50800 Epoch=247.9] | Loss=0.00913 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.510 | L2-Norm(final)=13.514 | 4896.5 samples/s | 76.5 steps/s
[Step=50850 Epoch=248.1] | Loss=0.00860 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.514 | L2-Norm(final)=13.517 | 4921.9 samples/s | 76.9 steps/s
[Step=50900 Epoch=248.4] | Loss=0.00829 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.517 | L2-Norm(final)=13.519 | 6184.1 samples/s | 96.6 steps/s
[Step=50950 Epoch=248.6] | Loss=0.00786 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.520 | L2-Norm(final)=13.522 | 1895.4 samples/s | 29.6 steps/s
[Step=51000 Epoch=248.9] | Loss=0.00746 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.523 | L2-Norm(final)=13.525 | 4969.9 samples/s | 77.7 steps/s
[Step=51050 Epoch=249.1] | Loss=0.00714 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.527 | L2-Norm(final)=13.527 | 4940.3 samples/s | 77.2 steps/s
[Step=51100 Epoch=249.3] | Loss=0.00685 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.529 | L2-Norm(final)=13.530 | 5891.1 samples/s | 92.0 steps/s
[Step=51150 Epoch=249.6] | Loss=0.00664 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.532 | L2-Norm(final)=13.532 | 1924.3 samples/s | 30.1 steps/s
[Step=51200 Epoch=249.8] | Loss=0.00651 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.535 | L2-Norm(final)=13.534 | 4922.3 samples/s | 76.9 steps/s
[Step=51250 Epoch=250.1] | Loss=0.00628 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.538 | L2-Norm(final)=13.537 | 4960.6 samples/s | 77.5 steps/s
[Step=51300 Epoch=250.3] | Loss=0.00610 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.540 | L2-Norm(final)=13.539 | 5516.4 samples/s | 86.2 steps/s
[Step=51350 Epoch=250.6] | Loss=0.00595 | Reg=0.00091 | acc=0.9844 | L2-Norm=9.543 | L2-Norm(final)=13.541 | 1970.2 samples/s | 30.8 steps/s
[Step=51400 Epoch=250.8] | Loss=0.00578 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.545 | L2-Norm(final)=13.543 | 4918.6 samples/s | 76.9 steps/s
[Step=51450 Epoch=251.1] | Loss=0.00571 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.547 | L2-Norm(final)=13.545 | 4987.0 samples/s | 77.9 steps/s
[Step=51500 Epoch=251.3] | Loss=0.00563 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.550 | L2-Norm(final)=13.548 | 5280.5 samples/s | 82.5 steps/s
[Step=51550 Epoch=251.5] | Loss=0.00548 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.552 | L2-Norm(final)=13.550 | 2002.3 samples/s | 31.3 steps/s
[Step=51600 Epoch=251.8] | Loss=0.00539 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.554 | L2-Norm(final)=13.552 | 4971.5 samples/s | 77.7 steps/s
[Step=51650 Epoch=252.0] | Loss=0.00529 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.556 | L2-Norm(final)=13.554 | 4916.7 samples/s | 76.8 steps/s
[Step=51700 Epoch=252.3] | Loss=0.00520 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.558 | L2-Norm(final)=13.556 | 5038.7 samples/s | 78.7 steps/s
[Step=51750 Epoch=252.5] | Loss=0.00508 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.561 | L2-Norm(final)=13.558 | 2044.5 samples/s | 31.9 steps/s
[Step=51800 Epoch=252.8] | Loss=0.00499 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.563 | L2-Norm(final)=13.560 | 4900.2 samples/s | 76.6 steps/s
[Step=51850 Epoch=253.0] | Loss=0.00493 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.565 | L2-Norm(final)=13.562 | 4953.9 samples/s | 77.4 steps/s
[Step=51900 Epoch=253.2] | Loss=0.00485 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.567 | L2-Norm(final)=13.564 | 4983.4 samples/s | 77.9 steps/s
[Step=51950 Epoch=253.5] | Loss=0.00478 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.569 | L2-Norm(final)=13.566 | 2037.3 samples/s | 31.8 steps/s
[Step=52000 Epoch=253.7] | Loss=0.00472 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.571 | L2-Norm(final)=13.568 | 5029.7 samples/s | 78.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step52000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=42001 Epoch=204.8] | Loss=0.02535 | Reg=0.00089 | acc=0.9688 | L2-Norm=9.415 | L2-Norm(final)=13.067 | 3831.9 samples/s | 59.9 steps/s
[Step=42050 Epoch=205.1] | Loss=0.02862 | Reg=0.00089 | acc=0.9531 | L2-Norm=9.419 | L2-Norm(final)=13.063 | 5484.5 samples/s | 85.7 steps/s
[Step=42100 Epoch=205.3] | Loss=0.02594 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.422 | L2-Norm(final)=13.062 | 5632.5 samples/s | 88.0 steps/s
[Step=42150 Epoch=205.5] | Loss=0.02334 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.425 | L2-Norm(final)=13.062 | 5444.9 samples/s | 85.1 steps/s
[Step=42200 Epoch=205.8] | Loss=0.02268 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.428 | L2-Norm(final)=13.063 | 7670.1 samples/s | 119.8 steps/s
[Step=42250 Epoch=206.0] | Loss=0.02121 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.431 | L2-Norm(final)=13.065 | 1928.7 samples/s | 30.1 steps/s
[Step=42300 Epoch=206.3] | Loss=0.02112 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.435 | L2-Norm(final)=13.067 | 5581.2 samples/s | 87.2 steps/s
[Step=42350 Epoch=206.5] | Loss=0.02001 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.438 | L2-Norm(final)=13.069 | 5459.4 samples/s | 85.3 steps/s
[Step=42400 Epoch=206.8] | Loss=0.01952 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.441 | L2-Norm(final)=13.071 | 7085.1 samples/s | 110.7 steps/s
[Step=42450 Epoch=207.0] | Loss=0.01897 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.444 | L2-Norm(final)=13.074 | 1963.0 samples/s | 30.7 steps/s
[Step=42500 Epoch=207.3] | Loss=0.01867 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.447 | L2-Norm(final)=13.076 | 5646.5 samples/s | 88.2 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=207.3] | Loss=0.04184 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.478 | L2-Norm(final)=13.104 | 3778.4 samples/s | 59.0 steps/s
[Step=42550 Epoch=207.5] | Loss=0.01721 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.484 | L2-Norm(final)=13.106 | 4900.5 samples/s | 76.6 steps/s
[Step=42600 Epoch=207.7] | Loss=0.01684 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.490 | L2-Norm(final)=13.109 | 4929.5 samples/s | 77.0 steps/s
[Step=42650 Epoch=208.0] | Loss=0.01477 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.496 | L2-Norm(final)=13.112 | 4943.4 samples/s | 77.2 steps/s
[Step=42700 Epoch=208.2] | Loss=0.01341 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.502 | L2-Norm(final)=13.115 | 6629.5 samples/s | 103.6 steps/s
[Step=42750 Epoch=208.5] | Loss=0.01229 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.507 | L2-Norm(final)=13.118 | 1871.3 samples/s | 29.2 steps/s
[Step=42800 Epoch=208.7] | Loss=0.01138 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.511 | L2-Norm(final)=13.121 | 4933.5 samples/s | 77.1 steps/s
[Step=42850 Epoch=209.0] | Loss=0.01049 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.515 | L2-Norm(final)=13.124 | 4941.2 samples/s | 77.2 steps/s
[Step=42900 Epoch=209.2] | Loss=0.00982 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.519 | L2-Norm(final)=13.127 | 6167.1 samples/s | 96.4 steps/s
[Step=42950 Epoch=209.4] | Loss=0.00929 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.523 | L2-Norm(final)=13.130 | 1914.9 samples/s | 29.9 steps/s
[Step=43000 Epoch=209.7] | Loss=0.00883 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.526 | L2-Norm(final)=13.133 | 4942.1 samples/s | 77.2 steps/s
[Step=43050 Epoch=209.9] | Loss=0.00848 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.530 | L2-Norm(final)=13.136 | 4915.9 samples/s | 76.8 steps/s
[Step=43100 Epoch=210.2] | Loss=0.00814 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.533 | L2-Norm(final)=13.139 | 5713.7 samples/s | 89.3 steps/s
[Step=43150 Epoch=210.4] | Loss=0.00782 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.536 | L2-Norm(final)=13.141 | 1943.2 samples/s | 30.4 steps/s
[Step=43200 Epoch=210.7] | Loss=0.00752 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.539 | L2-Norm(final)=13.144 | 4899.6 samples/s | 76.6 steps/s
[Step=43250 Epoch=210.9] | Loss=0.00729 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.542 | L2-Norm(final)=13.146 | 4909.1 samples/s | 76.7 steps/s
[Step=43300 Epoch=211.2] | Loss=0.00710 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.545 | L2-Norm(final)=13.149 | 5394.6 samples/s | 84.3 steps/s
[Step=43350 Epoch=211.4] | Loss=0.00689 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.548 | L2-Norm(final)=13.151 | 1994.8 samples/s | 31.2 steps/s
[Step=43400 Epoch=211.6] | Loss=0.00672 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.551 | L2-Norm(final)=13.154 | 4921.8 samples/s | 76.9 steps/s
[Step=43450 Epoch=211.9] | Loss=0.00651 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.553 | L2-Norm(final)=13.156 | 4935.9 samples/s | 77.1 steps/s
[Step=43500 Epoch=212.1] | Loss=0.00635 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.556 | L2-Norm(final)=13.159 | 5073.7 samples/s | 79.3 steps/s
[Step=43550 Epoch=212.4] | Loss=0.00618 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.559 | L2-Norm(final)=13.161 | 2058.1 samples/s | 32.2 steps/s
[Step=43600 Epoch=212.6] | Loss=0.00603 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.561 | L2-Norm(final)=13.163 | 4906.9 samples/s | 76.7 steps/s
[Step=43650 Epoch=212.9] | Loss=0.00593 | Reg=0.00091 | acc=1.0000 | L2-Norm=9.564 | L2-Norm(final)=13.166 | 4946.3 samples/s | 77.3 steps/s
[Step=43700 Epoch=213.1] | Loss=0.00582 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.566 | L2-Norm(final)=13.168 | 4914.6 samples/s | 76.8 steps/s
[Step=43750 Epoch=213.3] | Loss=0.00569 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.568 | L2-Norm(final)=13.170 | 2039.7 samples/s | 31.9 steps/s
[Step=43800 Epoch=213.6] | Loss=0.00556 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.571 | L2-Norm(final)=13.173 | 5025.9 samples/s | 78.5 steps/s
[Step=43850 Epoch=213.8] | Loss=0.00544 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.573 | L2-Norm(final)=13.175 | 4972.5 samples/s | 77.7 steps/s
[Step=43900 Epoch=214.1] | Loss=0.00538 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.576 | L2-Norm(final)=13.177 | 4925.4 samples/s | 77.0 steps/s
[Step=43950 Epoch=214.3] | Loss=0.00530 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.578 | L2-Norm(final)=13.179 | 2068.6 samples/s | 32.3 steps/s
[Step=44000 Epoch=214.6] | Loss=0.00518 | Reg=0.00092 | acc=1.0000 | L2-Norm=9.580 | L2-Norm(final)=13.181 | 5010.2 samples/s | 78.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step44000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=42001 Epoch=399.5] | Loss=0.00278 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.415 | L2-Norm(final)=9.331 | 4063.2 samples/s | 63.5 steps/s
[Step=42050 Epoch=400.0] | Loss=0.00232 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.421 | L2-Norm(final)=9.336 | 4650.0 samples/s | 72.7 steps/s
[Step=42100 Epoch=400.5] | Loss=0.00150 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.428 | L2-Norm(final)=9.339 | 7419.5 samples/s | 115.9 steps/s
[Step=42150 Epoch=401.0] | Loss=0.00108 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.432 | L2-Norm(final)=9.341 | 1880.0 samples/s | 29.4 steps/s
[Step=42200 Epoch=401.4] | Loss=0.00086 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.434 | L2-Norm(final)=9.344 | 6833.1 samples/s | 106.8 steps/s
[Step=42250 Epoch=401.9] | Loss=0.00071 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.436 | L2-Norm(final)=9.346 | 1937.7 samples/s | 30.3 steps/s
[Step=42300 Epoch=402.4] | Loss=0.00063 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.437 | L2-Norm(final)=9.348 | 6225.9 samples/s | 97.3 steps/s
[Step=42350 Epoch=402.9] | Loss=0.00056 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.438 | L2-Norm(final)=9.350 | 1936.5 samples/s | 30.3 steps/s
[Step=42400 Epoch=403.3] | Loss=0.00051 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.439 | L2-Norm(final)=9.352 | 5780.8 samples/s | 90.3 steps/s
[Step=42450 Epoch=403.8] | Loss=0.00046 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.439 | L2-Norm(final)=9.354 | 2004.0 samples/s | 31.3 steps/s
[Step=42500 Epoch=404.3] | Loss=0.00043 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.440 | L2-Norm(final)=9.356 | 5428.5 samples/s | 84.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=404.3] | Loss=0.00018 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.444 | L2-Norm(final)=9.374 | 4055.1 samples/s | 63.4 steps/s
[Step=42550 Epoch=404.8] | Loss=0.00013 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.445 | L2-Norm(final)=9.376 | 4219.8 samples/s | 65.9 steps/s
[Step=42600 Epoch=405.2] | Loss=0.00009 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.446 | L2-Norm(final)=9.377 | 6432.7 samples/s | 100.5 steps/s
[Step=42650 Epoch=405.7] | Loss=0.00007 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.444 | L2-Norm(final)=9.378 | 1819.9 samples/s | 28.4 steps/s
[Step=42700 Epoch=406.2] | Loss=0.00005 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.441 | L2-Norm(final)=9.379 | 5879.8 samples/s | 91.9 steps/s
[Step=42750 Epoch=406.7] | Loss=0.00004 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.438 | L2-Norm(final)=9.379 | 1850.9 samples/s | 28.9 steps/s
[Step=42800 Epoch=407.1] | Loss=0.00004 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.435 | L2-Norm(final)=9.379 | 5448.4 samples/s | 85.1 steps/s
[Step=42850 Epoch=407.6] | Loss=0.00003 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.432 | L2-Norm(final)=9.380 | 1912.2 samples/s | 29.9 steps/s
[Step=42900 Epoch=408.1] | Loss=0.00003 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.428 | L2-Norm(final)=9.380 | 5106.5 samples/s | 79.8 steps/s
[Step=42950 Epoch=408.6] | Loss=0.00003 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.424 | L2-Norm(final)=9.380 | 1922.8 samples/s | 30.0 steps/s
[Step=43000 Epoch=409.0] | Loss=0.00003 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.420 | L2-Norm(final)=9.380 | 4836.0 samples/s | 75.6 steps/s
[Step=43050 Epoch=409.5] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.416 | L2-Norm(final)=9.381 | 1978.3 samples/s | 30.9 steps/s
[Step=43100 Epoch=410.0] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.411 | L2-Norm(final)=9.381 | 4830.5 samples/s | 75.5 steps/s
[Step=43150 Epoch=410.5] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.407 | L2-Norm(final)=9.381 | 1986.1 samples/s | 31.0 steps/s
[Step=43200 Epoch=410.9] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.403 | L2-Norm(final)=9.381 | 4706.5 samples/s | 73.5 steps/s
[Step=43250 Epoch=411.4] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.398 | L2-Norm(final)=9.381 | 2014.9 samples/s | 31.5 steps/s
[Step=43300 Epoch=411.9] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.394 | L2-Norm(final)=9.381 | 4588.8 samples/s | 71.7 steps/s
[Step=43350 Epoch=412.4] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.389 | L2-Norm(final)=9.382 | 2015.0 samples/s | 31.5 steps/s
[Step=43400 Epoch=412.8] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.384 | L2-Norm(final)=9.382 | 4143.2 samples/s | 64.7 steps/s
[Step=43450 Epoch=413.3] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.379 | L2-Norm(final)=9.382 | 6109.8 samples/s | 95.5 steps/s
[Step=43500 Epoch=413.8] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.374 | L2-Norm(final)=9.382 | 1763.3 samples/s | 27.6 steps/s
[Step=43550 Epoch=414.3] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.369 | L2-Norm(final)=9.382 | 5852.6 samples/s | 91.4 steps/s
[Step=43600 Epoch=414.7] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.364 | L2-Norm(final)=9.382 | 1836.2 samples/s | 28.7 steps/s
[Step=43650 Epoch=415.2] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=9.383 | 5618.2 samples/s | 87.8 steps/s
[Step=43700 Epoch=415.7] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.354 | L2-Norm(final)=9.383 | 1873.8 samples/s | 29.3 steps/s
[Step=43750 Epoch=416.2] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.349 | L2-Norm(final)=9.383 | 5217.1 samples/s | 81.5 steps/s
[Step=43800 Epoch=416.6] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.343 | L2-Norm(final)=9.383 | 1933.8 samples/s | 30.2 steps/s
[Step=43850 Epoch=417.1] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.338 | L2-Norm(final)=9.383 | 4947.7 samples/s | 77.3 steps/s
[Step=43900 Epoch=417.6] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.332 | L2-Norm(final)=9.383 | 1983.6 samples/s | 31.0 steps/s
[Step=43950 Epoch=418.1] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.326 | L2-Norm(final)=9.383 | 4674.2 samples/s | 73.0 steps/s
[Step=44000 Epoch=418.5] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.320 | L2-Norm(final)=9.384 | 1982.6 samples/s | 31.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step44000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=42001 Epoch=401.1] | Loss=0.01017 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.415 | L2-Norm(final)=8.609 | 4052.1 samples/s | 63.3 steps/s
[Step=42050 Epoch=401.6] | Loss=0.00051 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.415 | L2-Norm(final)=8.611 | 5076.6 samples/s | 79.3 steps/s
[Step=42100 Epoch=402.0] | Loss=0.00034 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.417 | L2-Norm(final)=8.617 | 7582.1 samples/s | 118.5 steps/s
[Step=42150 Epoch=402.5] | Loss=0.00026 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.417 | L2-Norm(final)=8.621 | 1872.1 samples/s | 29.3 steps/s
[Step=42200 Epoch=403.0] | Loss=0.00021 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.417 | L2-Norm(final)=8.625 | 6964.4 samples/s | 108.8 steps/s
[Step=42250 Epoch=403.5] | Loss=0.00019 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.416 | L2-Norm(final)=8.628 | 1901.9 samples/s | 29.7 steps/s
[Step=42300 Epoch=403.9] | Loss=0.00016 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.415 | L2-Norm(final)=8.631 | 6494.9 samples/s | 101.5 steps/s
[Step=42350 Epoch=404.4] | Loss=0.00015 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.414 | L2-Norm(final)=8.634 | 1925.1 samples/s | 30.1 steps/s
[Step=42400 Epoch=404.9] | Loss=0.00013 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.412 | L2-Norm(final)=8.637 | 6015.3 samples/s | 94.0 steps/s
[Step=42450 Epoch=405.4] | Loss=0.00013 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.411 | L2-Norm(final)=8.639 | 1972.3 samples/s | 30.8 steps/s
[Step=42500 Epoch=405.8] | Loss=0.00012 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.410 | L2-Norm(final)=8.642 | 5721.4 samples/s | 89.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=405.9] | Loss=0.00003 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.394 | L2-Norm(final)=8.666 | 3697.7 samples/s | 57.8 steps/s
[Step=42550 Epoch=406.3] | Loss=0.00004 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.389 | L2-Norm(final)=8.668 | 4655.1 samples/s | 72.7 steps/s
[Step=42600 Epoch=406.8] | Loss=0.00003 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.383 | L2-Norm(final)=8.670 | 6465.2 samples/s | 101.0 steps/s
[Step=42650 Epoch=407.3] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.375 | L2-Norm(final)=8.671 | 1805.4 samples/s | 28.2 steps/s
[Step=42700 Epoch=407.8] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.365 | L2-Norm(final)=8.671 | 6027.2 samples/s | 94.2 steps/s
[Step=42750 Epoch=408.2] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.356 | L2-Norm(final)=8.672 | 1837.3 samples/s | 28.7 steps/s
[Step=42800 Epoch=408.7] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.346 | L2-Norm(final)=8.672 | 5642.0 samples/s | 88.2 steps/s
[Step=42850 Epoch=409.2] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.335 | L2-Norm(final)=8.672 | 1883.0 samples/s | 29.4 steps/s
[Step=42900 Epoch=409.7] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.324 | L2-Norm(final)=8.673 | 5292.2 samples/s | 82.7 steps/s
[Step=42950 Epoch=410.1] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.314 | L2-Norm(final)=8.673 | 1913.7 samples/s | 29.9 steps/s
[Step=43000 Epoch=410.6] | Loss=0.00001 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.303 | L2-Norm(final)=8.673 | 5005.9 samples/s | 78.2 steps/s
[Step=43050 Epoch=411.1] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.291 | L2-Norm(final)=8.673 | 1957.5 samples/s | 30.6 steps/s
[Step=43100 Epoch=411.6] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.280 | L2-Norm(final)=8.673 | 4803.9 samples/s | 75.1 steps/s
[Step=43150 Epoch=412.1] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.268 | L2-Norm(final)=8.674 | 1975.2 samples/s | 30.9 steps/s
[Step=43200 Epoch=412.5] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.257 | L2-Norm(final)=8.674 | 4762.0 samples/s | 74.4 steps/s
[Step=43250 Epoch=413.0] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.245 | L2-Norm(final)=8.674 | 2028.2 samples/s | 31.7 steps/s
[Step=43300 Epoch=413.5] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.233 | L2-Norm(final)=8.674 | 4618.8 samples/s | 72.2 steps/s
[Step=43350 Epoch=414.0] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.221 | L2-Norm(final)=8.674 | 2020.2 samples/s | 31.6 steps/s
[Step=43400 Epoch=414.4] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.208 | L2-Norm(final)=8.675 | 4760.6 samples/s | 74.4 steps/s
[Step=43450 Epoch=414.9] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.196 | L2-Norm(final)=8.675 | 2000.9 samples/s | 31.3 steps/s
[Step=43500 Epoch=415.4] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.183 | L2-Norm(final)=8.675 | 4638.4 samples/s | 72.5 steps/s
[Step=43550 Epoch=415.9] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.171 | L2-Norm(final)=8.675 | 6942.7 samples/s | 108.5 steps/s
[Step=43600 Epoch=416.4] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.158 | L2-Norm(final)=8.675 | 1774.7 samples/s | 27.7 steps/s
[Step=43650 Epoch=416.8] | Loss=0.00000 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.144 | L2-Norm(final)=8.676 | 6438.3 samples/s | 100.6 steps/s
[Step=43700 Epoch=417.3] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.131 | L2-Norm(final)=8.676 | 1803.8 samples/s | 28.2 steps/s
[Step=43750 Epoch=417.8] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.118 | L2-Norm(final)=8.676 | 5934.8 samples/s | 92.7 steps/s
[Step=43800 Epoch=418.3] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.104 | L2-Norm(final)=8.676 | 1844.8 samples/s | 28.8 steps/s
[Step=43850 Epoch=418.7] | Loss=0.00000 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.090 | L2-Norm(final)=8.676 | 5626.6 samples/s | 87.9 steps/s
[Step=43900 Epoch=419.2] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.077 | L2-Norm(final)=8.677 | 1850.5 samples/s | 28.9 steps/s
[Step=43950 Epoch=419.7] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.062 | L2-Norm(final)=8.677 | 5341.2 samples/s | 83.5 steps/s
[Step=44000 Epoch=420.2] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.048 | L2-Norm(final)=8.677 | 1917.4 samples/s | 30.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step44000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=48001 Epoch=457.5] | Loss=0.00612 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.415 | L2-Norm(final)=9.865 | 3758.1 samples/s | 58.7 steps/s
[Step=48050 Epoch=458.0] | Loss=0.00161 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.425 | L2-Norm(final)=9.870 | 4984.1 samples/s | 77.9 steps/s
[Step=48100 Epoch=458.4] | Loss=0.00105 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.431 | L2-Norm(final)=9.875 | 7524.6 samples/s | 117.6 steps/s
[Step=48150 Epoch=458.9] | Loss=0.00081 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.435 | L2-Norm(final)=9.880 | 1847.2 samples/s | 28.9 steps/s
[Step=48200 Epoch=459.4] | Loss=0.00065 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.437 | L2-Norm(final)=9.884 | 6867.4 samples/s | 107.3 steps/s
[Step=48250 Epoch=459.9] | Loss=0.00055 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.439 | L2-Norm(final)=9.887 | 1891.2 samples/s | 29.5 steps/s
[Step=48300 Epoch=460.3] | Loss=0.00048 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.440 | L2-Norm(final)=9.890 | 6336.4 samples/s | 99.0 steps/s
[Step=48350 Epoch=460.8] | Loss=0.00044 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.441 | L2-Norm(final)=9.893 | 1935.1 samples/s | 30.2 steps/s
[Step=48400 Epoch=461.3] | Loss=0.00040 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.441 | L2-Norm(final)=9.896 | 6012.6 samples/s | 93.9 steps/s
[Step=48450 Epoch=461.8] | Loss=0.00037 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.442 | L2-Norm(final)=9.899 | 1987.2 samples/s | 31.1 steps/s
[Step=48500 Epoch=462.2] | Loss=0.00034 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.442 | L2-Norm(final)=9.901 | 5626.5 samples/s | 87.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=48501 Epoch=462.3] | Loss=0.00008 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.446 | L2-Norm(final)=9.926 | 3828.7 samples/s | 59.8 steps/s
[Step=48550 Epoch=462.7] | Loss=0.00008 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.446 | L2-Norm(final)=9.928 | 4451.9 samples/s | 69.6 steps/s
[Step=48600 Epoch=463.2] | Loss=0.00007 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.445 | L2-Norm(final)=9.929 | 6504.9 samples/s | 101.6 steps/s
[Step=48650 Epoch=463.7] | Loss=0.00006 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.443 | L2-Norm(final)=9.930 | 1799.4 samples/s | 28.1 steps/s
[Step=48700 Epoch=464.2] | Loss=0.00005 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.442 | L2-Norm(final)=9.931 | 5982.4 samples/s | 93.5 steps/s
[Step=48750 Epoch=464.6] | Loss=0.00004 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.440 | L2-Norm(final)=9.932 | 1813.7 samples/s | 28.3 steps/s
[Step=48800 Epoch=465.1] | Loss=0.00004 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.438 | L2-Norm(final)=9.933 | 5652.4 samples/s | 88.3 steps/s
[Step=48850 Epoch=465.6] | Loss=0.00004 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.435 | L2-Norm(final)=9.934 | 1882.4 samples/s | 29.4 steps/s
[Step=48900 Epoch=466.1] | Loss=0.00003 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.433 | L2-Norm(final)=9.934 | 5260.7 samples/s | 82.2 steps/s
[Step=48950 Epoch=466.5] | Loss=0.00003 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.430 | L2-Norm(final)=9.935 | 1906.0 samples/s | 29.8 steps/s
[Step=49000 Epoch=467.0] | Loss=0.00003 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.428 | L2-Norm(final)=9.935 | 5011.5 samples/s | 78.3 steps/s
[Step=49050 Epoch=467.5] | Loss=0.00003 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.425 | L2-Norm(final)=9.936 | 1951.1 samples/s | 30.5 steps/s
[Step=49100 Epoch=468.0] | Loss=0.00003 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.422 | L2-Norm(final)=9.936 | 4801.9 samples/s | 75.0 steps/s
[Step=49150 Epoch=468.4] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.420 | L2-Norm(final)=9.937 | 2005.1 samples/s | 31.3 steps/s
[Step=49200 Epoch=468.9] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.417 | L2-Norm(final)=9.937 | 4630.3 samples/s | 72.3 steps/s
[Step=49250 Epoch=469.4] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.414 | L2-Norm(final)=9.937 | 1986.6 samples/s | 31.0 steps/s
[Step=49300 Epoch=469.9] | Loss=0.00002 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.410 | L2-Norm(final)=9.938 | 4737.2 samples/s | 74.0 steps/s
[Step=49350 Epoch=470.3] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.407 | L2-Norm(final)=9.938 | 2034.7 samples/s | 31.8 steps/s
[Step=49400 Epoch=470.8] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.404 | L2-Norm(final)=9.938 | 4621.5 samples/s | 72.2 steps/s
[Step=49450 Epoch=471.3] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.401 | L2-Norm(final)=9.939 | 1997.8 samples/s | 31.2 steps/s
[Step=49500 Epoch=471.8] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.397 | L2-Norm(final)=9.939 | 4697.0 samples/s | 73.4 steps/s
[Step=49550 Epoch=472.3] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.394 | L2-Norm(final)=9.939 | 6946.3 samples/s | 108.5 steps/s
[Step=49600 Epoch=472.7] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.391 | L2-Norm(final)=9.940 | 1758.0 samples/s | 27.5 steps/s
[Step=49650 Epoch=473.2] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.387 | L2-Norm(final)=9.940 | 6451.5 samples/s | 100.8 steps/s
[Step=49700 Epoch=473.7] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.383 | L2-Norm(final)=9.940 | 1796.1 samples/s | 28.1 steps/s
[Step=49750 Epoch=474.2] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.380 | L2-Norm(final)=9.941 | 6050.4 samples/s | 94.5 steps/s
[Step=49800 Epoch=474.6] | Loss=0.00002 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.376 | L2-Norm(final)=9.941 | 1839.1 samples/s | 28.7 steps/s
[Step=49850 Epoch=475.1] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.372 | L2-Norm(final)=9.941 | 5626.0 samples/s | 87.9 steps/s
[Step=49900 Epoch=475.6] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.368 | L2-Norm(final)=9.942 | 1879.7 samples/s | 29.4 steps/s
[Step=49950 Epoch=476.1] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.364 | L2-Norm(final)=9.942 | 5269.8 samples/s | 82.3 steps/s
[Step=50000 Epoch=476.5] | Loss=0.00001 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.360 | L2-Norm(final)=9.942 | 1902.7 samples/s | 29.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step50000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07974 | acc=0.9621 | tpr=0.9682 | fpr=0.0510 | 4339.2 samples/s | 16.9 steps/s
Avg test loss: 0.08311, Avg test acc: 0.96013, Avg tpr: 0.96672, Avg fpr: 0.05435, total FA: 424

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08193 | acc=0.9627 | tpr=0.9699 | fpr=0.0530 | 4389.0 samples/s | 17.1 steps/s
Avg test loss: 0.08566, Avg test acc: 0.96097, Avg tpr: 0.96853, Avg fpr: 0.05563, total FA: 434

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08230 | acc=0.9610 | tpr=0.9719 | fpr=0.0627 | 4421.1 samples/s | 17.3 steps/s
Avg test loss: 0.08605, Avg test acc: 0.96025, Avg tpr: 0.97057, Avg fpr: 0.06243, total FA: 487

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.07706 | acc=0.9620 | tpr=0.9700 | fpr=0.0555 | 4401.4 samples/s | 17.2 steps/s
Avg test loss: 0.08076, Avg test acc: 0.96174, Avg tpr: 0.96958, Avg fpr: 0.05551, total FA: 433

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08155 | acc=0.9628 | tpr=0.9752 | fpr=0.0642 | 4338.2 samples/s | 16.9 steps/s
Avg test loss: 0.08931, Avg test acc: 0.96158, Avg tpr: 0.97377, Avg fpr: 0.06525, total FA: 509

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.20203 | acc=0.2966 | tpr=0.0027 | fpr=0.0652 | 4428.3 samples/s | 17.3 steps/s
Avg test loss: 5.21621, Avg test acc: 0.29357, Avg tpr: 0.00321, Avg fpr: 0.06781, total FA: 529

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.86690 | acc=0.3135 | tpr=0.0040 | fpr=0.0144 | 4393.5 samples/s | 17.2 steps/s
Avg test loss: 4.87554, Avg test acc: 0.31092, Avg tpr: 0.00437, Avg fpr: 0.01487, total FA: 116

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.02324 | acc=0.3043 | tpr=0.0048 | fpr=0.0453 | 4355.4 samples/s | 17.0 steps/s
Avg test loss: 5.03308, Avg test acc: 0.30159, Avg tpr: 0.00565, Avg fpr: 0.04756, total FA: 371

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.23768 | acc=0.3047 | tpr=0.0030 | fpr=0.0401 | 4412.8 samples/s | 17.2 steps/s
Avg test loss: 5.25293, Avg test acc: 0.30175, Avg tpr: 0.00356, Avg fpr: 0.04243, total FA: 331

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.83881 | acc=0.3131 | tpr=0.0032 | fpr=0.0139 | 4360.5 samples/s | 17.0 steps/s
Avg test loss: 4.84816, Avg test acc: 0.31060, Avg tpr: 0.00367, Avg fpr: 0.01436, total FA: 112

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.72275 | acc=0.1320 | tpr=0.8230 | fpr=0.8804 | 4346.2 samples/s | 17.0 steps/s
[Step= 100] | Loss=4.67462 | acc=0.1350 | tpr=0.8060 | fpr=0.8776 | 8651.2 samples/s | 33.8 steps/s
[Step= 150] | Loss=4.67551 | acc=0.1338 | tpr=0.8228 | fpr=0.8789 | 8991.0 samples/s | 35.1 steps/s
[Step= 200] | Loss=4.67493 | acc=0.1330 | tpr=0.8208 | fpr=0.8795 | 8421.1 samples/s | 32.9 steps/s
[Step= 250] | Loss=4.67950 | acc=0.1343 | tpr=0.8227 | fpr=0.8782 | 8890.4 samples/s | 34.7 steps/s
[Step= 300] | Loss=4.67459 | acc=0.1342 | tpr=0.8189 | fpr=0.8782 | 8484.5 samples/s | 33.1 steps/s
[Step= 350] | Loss=4.67051 | acc=0.1337 | tpr=0.8153 | fpr=0.8787 | 8363.4 samples/s | 32.7 steps/s
[Step= 400] | Loss=4.67389 | acc=0.1339 | tpr=0.8129 | fpr=0.8784 | 8588.6 samples/s | 33.5 steps/s
[Step= 450] | Loss=4.67614 | acc=0.1337 | tpr=0.8092 | fpr=0.8785 | 8798.9 samples/s | 34.4 steps/s
[Step= 500] | Loss=4.67901 | acc=0.1336 | tpr=0.8093 | fpr=0.8786 | 8661.9 samples/s | 33.8 steps/s
[Step= 550] | Loss=4.67745 | acc=0.1334 | tpr=0.8114 | fpr=0.8790 | 15568.6 samples/s | 60.8 steps/s
Avg test loss: 4.67916, Avg test acc: 0.13328, Avg tpr: 0.81062, Avg fpr: 0.87903, total FA: 122052

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.68524 | acc=0.1401 | tpr=0.8009 | fpr=0.8718 | 4424.6 samples/s | 17.3 steps/s
[Step= 100] | Loss=4.63740 | acc=0.1431 | tpr=0.7974 | fpr=0.8691 | 8322.4 samples/s | 32.5 steps/s
[Step= 150] | Loss=4.63894 | acc=0.1416 | tpr=0.8069 | fpr=0.8706 | 8814.0 samples/s | 34.4 steps/s
[Step= 200] | Loss=4.63977 | acc=0.1416 | tpr=0.8055 | fpr=0.8705 | 8542.2 samples/s | 33.4 steps/s
[Step= 250] | Loss=4.64028 | acc=0.1423 | tpr=0.8026 | fpr=0.8698 | 8620.2 samples/s | 33.7 steps/s
[Step= 300] | Loss=4.63654 | acc=0.1419 | tpr=0.8007 | fpr=0.8701 | 8701.6 samples/s | 34.0 steps/s
[Step= 350] | Loss=4.63206 | acc=0.1416 | tpr=0.7977 | fpr=0.8703 | 8714.6 samples/s | 34.0 steps/s
[Step= 400] | Loss=4.63394 | acc=0.1413 | tpr=0.7927 | fpr=0.8706 | 8535.8 samples/s | 33.3 steps/s
[Step= 450] | Loss=4.63933 | acc=0.1412 | tpr=0.7892 | fpr=0.8706 | 8790.0 samples/s | 34.3 steps/s
[Step= 500] | Loss=4.64406 | acc=0.1411 | tpr=0.7907 | fpr=0.8706 | 8532.3 samples/s | 33.3 steps/s
[Step= 550] | Loss=4.64213 | acc=0.1411 | tpr=0.7931 | fpr=0.8707 | 15355.9 samples/s | 60.0 steps/s
Avg test loss: 4.64350, Avg test acc: 0.14105, Avg tpr: 0.79239, Avg fpr: 0.87079, total FA: 120907

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.46828 | acc=0.1208 | tpr=0.8186 | fpr=0.8918 | 4347.6 samples/s | 17.0 steps/s
[Step= 100] | Loss=5.41795 | acc=0.1238 | tpr=0.8124 | fpr=0.8890 | 8926.9 samples/s | 34.9 steps/s
[Step= 150] | Loss=5.42013 | acc=0.1219 | tpr=0.8329 | fpr=0.8912 | 8545.9 samples/s | 33.4 steps/s
[Step= 200] | Loss=5.42166 | acc=0.1207 | tpr=0.8361 | fpr=0.8924 | 8621.8 samples/s | 33.7 steps/s
[Step= 250] | Loss=5.42173 | acc=0.1216 | tpr=0.8367 | fpr=0.8914 | 8947.0 samples/s | 34.9 steps/s
[Step= 300] | Loss=5.41782 | acc=0.1214 | tpr=0.8378 | fpr=0.8917 | 8381.6 samples/s | 32.7 steps/s
[Step= 350] | Loss=5.41631 | acc=0.1213 | tpr=0.8384 | fpr=0.8917 | 8755.1 samples/s | 34.2 steps/s
[Step= 400] | Loss=5.41921 | acc=0.1215 | tpr=0.8359 | fpr=0.8915 | 8886.4 samples/s | 34.7 steps/s
[Step= 450] | Loss=5.42343 | acc=0.1209 | tpr=0.8296 | fpr=0.8920 | 8480.1 samples/s | 33.1 steps/s
[Step= 500] | Loss=5.42448 | acc=0.1210 | tpr=0.8308 | fpr=0.8918 | 8582.0 samples/s | 33.5 steps/s
[Step= 550] | Loss=5.42333 | acc=0.1209 | tpr=0.8357 | fpr=0.8921 | 15633.9 samples/s | 61.1 steps/s
Avg test loss: 5.42456, Avg test acc: 0.12082, Avg tpr: 0.83518, Avg fpr: 0.89217, total FA: 123876

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.72108 | acc=0.1388 | tpr=0.7743 | fpr=0.8727 | 4385.0 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.67365 | acc=0.1422 | tpr=0.7655 | fpr=0.8694 | 8672.6 samples/s | 33.9 steps/s
[Step= 150] | Loss=4.67197 | acc=0.1408 | tpr=0.7781 | fpr=0.8709 | 8520.4 samples/s | 33.3 steps/s
[Step= 200] | Loss=4.66848 | acc=0.1401 | tpr=0.7814 | fpr=0.8716 | 8891.3 samples/s | 34.7 steps/s
[Step= 250] | Loss=4.67091 | acc=0.1408 | tpr=0.7799 | fpr=0.8708 | 8473.5 samples/s | 33.1 steps/s
[Step= 300] | Loss=4.66625 | acc=0.1403 | tpr=0.7753 | fpr=0.8712 | 8745.9 samples/s | 34.2 steps/s
[Step= 350] | Loss=4.66139 | acc=0.1400 | tpr=0.7740 | fpr=0.8715 | 8844.5 samples/s | 34.5 steps/s
[Step= 400] | Loss=4.66515 | acc=0.1399 | tpr=0.7691 | fpr=0.8715 | 8488.5 samples/s | 33.2 steps/s
[Step= 450] | Loss=4.66996 | acc=0.1397 | tpr=0.7639 | fpr=0.8717 | 8530.6 samples/s | 33.3 steps/s
[Step= 500] | Loss=4.67255 | acc=0.1395 | tpr=0.7656 | fpr=0.8718 | 9405.7 samples/s | 36.7 steps/s
[Step= 550] | Loss=4.67041 | acc=0.1393 | tpr=0.7716 | fpr=0.8722 | 14053.1 samples/s | 54.9 steps/s
Avg test loss: 4.67200, Avg test acc: 0.13921, Avg tpr: 0.77100, Avg fpr: 0.87227, total FA: 121113

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.27558 | acc=0.1270 | tpr=0.7345 | fpr=0.8840 | 4461.7 samples/s | 17.4 steps/s
[Step= 100] | Loss=5.22285 | acc=0.1293 | tpr=0.7122 | fpr=0.8816 | 8399.1 samples/s | 32.8 steps/s
[Step= 150] | Loss=5.22306 | acc=0.1277 | tpr=0.7104 | fpr=0.8831 | 8433.1 samples/s | 32.9 steps/s
[Step= 200] | Loss=5.22146 | acc=0.1272 | tpr=0.7093 | fpr=0.8834 | 8880.2 samples/s | 34.7 steps/s
[Step= 250] | Loss=5.22502 | acc=0.1280 | tpr=0.7092 | fpr=0.8826 | 8380.3 samples/s | 32.7 steps/s
[Step= 300] | Loss=5.21962 | acc=0.1274 | tpr=0.7120 | fpr=0.8832 | 8838.5 samples/s | 34.5 steps/s
[Step= 350] | Loss=5.21644 | acc=0.1267 | tpr=0.7101 | fpr=0.8838 | 8438.9 samples/s | 33.0 steps/s
[Step= 400] | Loss=5.21986 | acc=0.1270 | tpr=0.7084 | fpr=0.8836 | 8475.7 samples/s | 33.1 steps/s
[Step= 450] | Loss=5.22360 | acc=0.1264 | tpr=0.7020 | fpr=0.8841 | 8948.3 samples/s | 35.0 steps/s
[Step= 500] | Loss=5.22615 | acc=0.1261 | tpr=0.6982 | fpr=0.8842 | 9101.9 samples/s | 35.6 steps/s
[Step= 550] | Loss=5.22496 | acc=0.1259 | tpr=0.6968 | fpr=0.8845 | 14143.3 samples/s | 55.2 steps/s
Avg test loss: 5.22706, Avg test acc: 0.12580, Avg tpr: 0.69651, Avg fpr: 0.88457, total FA: 122821

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.10037 | acc=0.9819 | tpr=0.9469 | fpr=0.0175 | 4341.7 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.10442 | acc=0.9810 | tpr=0.9574 | fpr=0.0185 | 8832.0 samples/s | 34.5 steps/s
[Step= 150] | Loss=0.10817 | acc=0.9800 | tpr=0.9568 | fpr=0.0196 | 8492.5 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.11032 | acc=0.9800 | tpr=0.9617 | fpr=0.0197 | 8659.1 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.10986 | acc=0.9799 | tpr=0.9546 | fpr=0.0196 | 8894.3 samples/s | 34.7 steps/s
[Step= 300] | Loss=0.11201 | acc=0.9796 | tpr=0.9542 | fpr=0.0200 | 8476.0 samples/s | 33.1 steps/s
[Step= 350] | Loss=0.11187 | acc=0.9794 | tpr=0.9530 | fpr=0.0201 | 8794.9 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.11285 | acc=0.9793 | tpr=0.9497 | fpr=0.0202 | 8560.6 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.11554 | acc=0.9790 | tpr=0.9484 | fpr=0.0204 | 8313.1 samples/s | 32.5 steps/s
[Step= 500] | Loss=0.11531 | acc=0.9790 | tpr=0.9493 | fpr=0.0204 | 8800.7 samples/s | 34.4 steps/s
[Step= 550] | Loss=0.11437 | acc=0.9792 | tpr=0.9491 | fpr=0.0203 | 15384.6 samples/s | 60.1 steps/s
Avg test loss: 0.11420, Avg test acc: 0.97922, Avg tpr: 0.94929, Avg fpr: 0.02024, total FA: 2810

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11125 | acc=0.9816 | tpr=0.9159 | fpr=0.0172 | 4361.6 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.11487 | acc=0.9817 | tpr=0.9318 | fpr=0.0174 | 9237.2 samples/s | 36.1 steps/s
[Step= 150] | Loss=0.11916 | acc=0.9805 | tpr=0.9251 | fpr=0.0185 | 8255.5 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.12068 | acc=0.9806 | tpr=0.9301 | fpr=0.0185 | 8658.2 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.11963 | acc=0.9805 | tpr=0.9293 | fpr=0.0185 | 8516.5 samples/s | 33.3 steps/s
[Step= 300] | Loss=0.12208 | acc=0.9801 | tpr=0.9295 | fpr=0.0190 | 8539.0 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.12234 | acc=0.9798 | tpr=0.9317 | fpr=0.0193 | 9109.1 samples/s | 35.6 steps/s
[Step= 400] | Loss=0.12345 | acc=0.9796 | tpr=0.9283 | fpr=0.0194 | 8321.1 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.12654 | acc=0.9793 | tpr=0.9260 | fpr=0.0197 | 8687.4 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.12593 | acc=0.9794 | tpr=0.9278 | fpr=0.0196 | 8577.6 samples/s | 33.5 steps/s
[Step= 550] | Loss=0.12512 | acc=0.9796 | tpr=0.9272 | fpr=0.0194 | 15486.1 samples/s | 60.5 steps/s
Avg test loss: 0.12487, Avg test acc: 0.97963, Avg tpr: 0.92710, Avg fpr: 0.01942, total FA: 2696

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10046 | acc=0.9800 | tpr=0.9381 | fpr=0.0192 | 4313.4 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.10433 | acc=0.9795 | tpr=0.9552 | fpr=0.0201 | 9370.0 samples/s | 36.6 steps/s
[Step= 150] | Loss=0.10792 | acc=0.9785 | tpr=0.9510 | fpr=0.0210 | 8263.8 samples/s | 32.3 steps/s
[Step= 200] | Loss=0.10964 | acc=0.9786 | tpr=0.9552 | fpr=0.0210 | 8919.6 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.10924 | acc=0.9786 | tpr=0.9537 | fpr=0.0210 | 8248.0 samples/s | 32.2 steps/s
[Step= 300] | Loss=0.11153 | acc=0.9781 | tpr=0.9542 | fpr=0.0214 | 8630.0 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.11148 | acc=0.9780 | tpr=0.9549 | fpr=0.0215 | 8839.0 samples/s | 34.5 steps/s
[Step= 400] | Loss=0.11261 | acc=0.9779 | tpr=0.9535 | fpr=0.0216 | 8449.8 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.11523 | acc=0.9778 | tpr=0.9528 | fpr=0.0218 | 8652.3 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.11483 | acc=0.9777 | tpr=0.9546 | fpr=0.0218 | 9090.5 samples/s | 35.5 steps/s
[Step= 550] | Loss=0.11384 | acc=0.9780 | tpr=0.9546 | fpr=0.0216 | 14590.5 samples/s | 57.0 steps/s
Avg test loss: 0.11369, Avg test acc: 0.97798, Avg tpr: 0.95483, Avg fpr: 0.02160, total FA: 2999

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10260 | acc=0.9815 | tpr=0.9248 | fpr=0.0175 | 4419.8 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.10711 | acc=0.9809 | tpr=0.9424 | fpr=0.0184 | 8486.8 samples/s | 33.2 steps/s
[Step= 150] | Loss=0.11125 | acc=0.9802 | tpr=0.9438 | fpr=0.0191 | 8688.5 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.11355 | acc=0.9802 | tpr=0.9519 | fpr=0.0193 | 8678.5 samples/s | 33.9 steps/s
[Step= 250] | Loss=0.11248 | acc=0.9802 | tpr=0.9476 | fpr=0.0192 | 8617.0 samples/s | 33.7 steps/s
[Step= 300] | Loss=0.11420 | acc=0.9800 | tpr=0.9484 | fpr=0.0195 | 8690.0 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.11438 | acc=0.9799 | tpr=0.9512 | fpr=0.0196 | 8713.6 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.11508 | acc=0.9797 | tpr=0.9486 | fpr=0.0197 | 8508.8 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.11789 | acc=0.9795 | tpr=0.9479 | fpr=0.0200 | 8785.7 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.11745 | acc=0.9795 | tpr=0.9489 | fpr=0.0199 | 8703.3 samples/s | 34.0 steps/s
[Step= 550] | Loss=0.11658 | acc=0.9797 | tpr=0.9471 | fpr=0.0197 | 14724.4 samples/s | 57.5 steps/s
Avg test loss: 0.11640, Avg test acc: 0.97969, Avg tpr: 0.94691, Avg fpr: 0.01971, total FA: 2737

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12517 | acc=0.9797 | tpr=0.9292 | fpr=0.0194 | 4389.9 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.13011 | acc=0.9794 | tpr=0.9531 | fpr=0.0201 | 8636.4 samples/s | 33.7 steps/s
[Step= 150] | Loss=0.13524 | acc=0.9783 | tpr=0.9539 | fpr=0.0213 | 8506.3 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.13743 | acc=0.9780 | tpr=0.9585 | fpr=0.0217 | 8581.8 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.13629 | acc=0.9781 | tpr=0.9537 | fpr=0.0214 | 8804.6 samples/s | 34.4 steps/s
[Step= 300] | Loss=0.13900 | acc=0.9778 | tpr=0.9549 | fpr=0.0217 | 8745.7 samples/s | 34.2 steps/s
[Step= 350] | Loss=0.13963 | acc=0.9776 | tpr=0.9568 | fpr=0.0220 | 8265.1 samples/s | 32.3 steps/s
[Step= 400] | Loss=0.14066 | acc=0.9774 | tpr=0.9530 | fpr=0.0221 | 8839.1 samples/s | 34.5 steps/s
[Step= 450] | Loss=0.14385 | acc=0.9771 | tpr=0.9523 | fpr=0.0225 | 8719.5 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.14328 | acc=0.9771 | tpr=0.9529 | fpr=0.0224 | 8299.6 samples/s | 32.4 steps/s
[Step= 550] | Loss=0.14241 | acc=0.9773 | tpr=0.9515 | fpr=0.0223 | 15460.3 samples/s | 60.4 steps/s
Avg test loss: 0.14217, Avg test acc: 0.97726, Avg tpr: 0.95127, Avg fpr: 0.02227, total FA: 3092

server round 44/50

clients selected: [1 2 3 5 6]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=52001 Epoch=253.7] | Loss=0.09178 | Reg=0.00086 | acc=0.9531 | L2-Norm=9.296 | L2-Norm(final)=13.625 | 3833.2 samples/s | 59.9 steps/s
[Step=52050 Epoch=254.0] | Loss=0.02148 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.298 | L2-Norm(final)=13.621 | 5381.1 samples/s | 84.1 steps/s
[Step=52100 Epoch=254.2] | Loss=0.02034 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.301 | L2-Norm(final)=13.621 | 5627.3 samples/s | 87.9 steps/s
[Step=52150 Epoch=254.5] | Loss=0.01998 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.304 | L2-Norm(final)=13.620 | 5427.4 samples/s | 84.8 steps/s
[Step=52200 Epoch=254.7] | Loss=0.01989 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.307 | L2-Norm(final)=13.620 | 7911.9 samples/s | 123.6 steps/s
[Step=52250 Epoch=255.0] | Loss=0.01899 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.311 | L2-Norm(final)=13.621 | 1897.7 samples/s | 29.7 steps/s
[Step=52300 Epoch=255.2] | Loss=0.01814 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.314 | L2-Norm(final)=13.623 | 5485.8 samples/s | 85.7 steps/s
[Step=52350 Epoch=255.4] | Loss=0.01762 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.318 | L2-Norm(final)=13.624 | 5490.6 samples/s | 85.8 steps/s
[Step=52400 Epoch=255.7] | Loss=0.01752 | Reg=0.00087 | acc=0.9375 | L2-Norm=9.321 | L2-Norm(final)=13.626 | 7273.4 samples/s | 113.6 steps/s
[Step=52450 Epoch=255.9] | Loss=0.01708 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.325 | L2-Norm(final)=13.628 | 1975.9 samples/s | 30.9 steps/s
[Step=52500 Epoch=256.2] | Loss=0.01672 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.328 | L2-Norm(final)=13.630 | 5381.0 samples/s | 84.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=52501 Epoch=256.2] | Loss=0.00343 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.359 | L2-Norm(final)=13.651 | 3955.6 samples/s | 61.8 steps/s
[Step=52550 Epoch=256.4] | Loss=0.01401 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.365 | L2-Norm(final)=13.653 | 4825.8 samples/s | 75.4 steps/s
[Step=52600 Epoch=256.7] | Loss=0.01297 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.370 | L2-Norm(final)=13.656 | 4925.3 samples/s | 77.0 steps/s
[Step=52650 Epoch=256.9] | Loss=0.01215 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.376 | L2-Norm(final)=13.659 | 4903.3 samples/s | 76.6 steps/s
[Step=52700 Epoch=257.2] | Loss=0.01183 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.381 | L2-Norm(final)=13.662 | 6585.0 samples/s | 102.9 steps/s
[Step=52750 Epoch=257.4] | Loss=0.01081 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.385 | L2-Norm(final)=13.665 | 1848.3 samples/s | 28.9 steps/s
[Step=52800 Epoch=257.6] | Loss=0.01006 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.389 | L2-Norm(final)=13.668 | 4910.1 samples/s | 76.7 steps/s
[Step=52850 Epoch=257.9] | Loss=0.00943 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.393 | L2-Norm(final)=13.670 | 5016.6 samples/s | 78.4 steps/s
[Step=52900 Epoch=258.1] | Loss=0.00889 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.397 | L2-Norm(final)=13.673 | 6191.4 samples/s | 96.7 steps/s
[Step=52950 Epoch=258.4] | Loss=0.00834 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.400 | L2-Norm(final)=13.676 | 1882.3 samples/s | 29.4 steps/s
[Step=53000 Epoch=258.6] | Loss=0.00805 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.403 | L2-Norm(final)=13.678 | 4967.9 samples/s | 77.6 steps/s
[Step=53050 Epoch=258.9] | Loss=0.00768 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.406 | L2-Norm(final)=13.680 | 4859.9 samples/s | 75.9 steps/s
[Step=53100 Epoch=259.1] | Loss=0.00736 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.409 | L2-Norm(final)=13.683 | 5881.3 samples/s | 91.9 steps/s
[Step=53150 Epoch=259.3] | Loss=0.00706 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.412 | L2-Norm(final)=13.685 | 1922.4 samples/s | 30.0 steps/s
[Step=53200 Epoch=259.6] | Loss=0.00686 | Reg=0.00089 | acc=0.9688 | L2-Norm=9.415 | L2-Norm(final)=13.688 | 4906.6 samples/s | 76.7 steps/s
[Step=53250 Epoch=259.8] | Loss=0.00671 | Reg=0.00089 | acc=0.9688 | L2-Norm=9.418 | L2-Norm(final)=13.690 | 4911.4 samples/s | 76.7 steps/s
[Step=53300 Epoch=260.1] | Loss=0.00654 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.420 | L2-Norm(final)=13.692 | 5515.5 samples/s | 86.2 steps/s
[Step=53350 Epoch=260.3] | Loss=0.00632 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.423 | L2-Norm(final)=13.694 | 1970.3 samples/s | 30.8 steps/s
[Step=53400 Epoch=260.6] | Loss=0.00623 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.425 | L2-Norm(final)=13.697 | 4943.7 samples/s | 77.2 steps/s
[Step=53450 Epoch=260.8] | Loss=0.00607 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.428 | L2-Norm(final)=13.699 | 4906.3 samples/s | 76.7 steps/s
[Step=53500 Epoch=261.1] | Loss=0.00601 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.430 | L2-Norm(final)=13.701 | 5271.5 samples/s | 82.4 steps/s
[Step=53550 Epoch=261.3] | Loss=0.00586 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.432 | L2-Norm(final)=13.703 | 2007.3 samples/s | 31.4 steps/s
[Step=53600 Epoch=261.5] | Loss=0.00575 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.435 | L2-Norm(final)=13.705 | 4993.2 samples/s | 78.0 steps/s
[Step=53650 Epoch=261.8] | Loss=0.00568 | Reg=0.00089 | acc=0.9844 | L2-Norm=9.437 | L2-Norm(final)=13.707 | 4844.7 samples/s | 75.7 steps/s
[Step=53700 Epoch=262.0] | Loss=0.00557 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.439 | L2-Norm(final)=13.709 | 5025.7 samples/s | 78.5 steps/s
[Step=53750 Epoch=262.3] | Loss=0.00544 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.441 | L2-Norm(final)=13.711 | 2034.9 samples/s | 31.8 steps/s
[Step=53800 Epoch=262.5] | Loss=0.00533 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.443 | L2-Norm(final)=13.712 | 4993.8 samples/s | 78.0 steps/s
[Step=53850 Epoch=262.8] | Loss=0.00523 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.445 | L2-Norm(final)=13.714 | 4982.7 samples/s | 77.9 steps/s
[Step=53900 Epoch=263.0] | Loss=0.00517 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.447 | L2-Norm(final)=13.716 | 4897.2 samples/s | 76.5 steps/s
[Step=53950 Epoch=263.3] | Loss=0.00508 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.449 | L2-Norm(final)=13.718 | 2053.9 samples/s | 32.1 steps/s
[Step=54000 Epoch=263.5] | Loss=0.00497 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.451 | L2-Norm(final)=13.720 | 5041.4 samples/s | 78.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step54000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=42001 Epoch=204.6] | Loss=0.00578 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.296 | L2-Norm(final)=13.557 | 4050.5 samples/s | 63.3 steps/s
[Step=42050 Epoch=204.9] | Loss=0.02607 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=13.555 | 5273.6 samples/s | 82.4 steps/s
[Step=42100 Epoch=205.1] | Loss=0.02295 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.303 | L2-Norm(final)=13.554 | 5451.4 samples/s | 85.2 steps/s
[Step=42150 Epoch=205.4] | Loss=0.02203 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.307 | L2-Norm(final)=13.555 | 5559.8 samples/s | 86.9 steps/s
[Step=42200 Epoch=205.6] | Loss=0.02243 | Reg=0.00087 | acc=0.9688 | L2-Norm=9.310 | L2-Norm(final)=13.555 | 7686.4 samples/s | 120.1 steps/s
[Step=42250 Epoch=205.9] | Loss=0.02192 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.314 | L2-Norm(final)=13.556 | 1925.6 samples/s | 30.1 steps/s
[Step=42300 Epoch=206.1] | Loss=0.02110 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.317 | L2-Norm(final)=13.558 | 5515.2 samples/s | 86.2 steps/s
[Step=42350 Epoch=206.3] | Loss=0.02048 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.321 | L2-Norm(final)=13.560 | 5555.3 samples/s | 86.8 steps/s
[Step=42400 Epoch=206.6] | Loss=0.01976 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.324 | L2-Norm(final)=13.562 | 7116.6 samples/s | 111.2 steps/s
[Step=42450 Epoch=206.8] | Loss=0.01956 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.327 | L2-Norm(final)=13.564 | 1925.7 samples/s | 30.1 steps/s
[Step=42500 Epoch=207.1] | Loss=0.01891 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.330 | L2-Norm(final)=13.566 | 5531.5 samples/s | 86.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=207.1] | Loss=0.02553 | Reg=0.00088 | acc=0.9688 | L2-Norm=9.361 | L2-Norm(final)=13.590 | 3887.8 samples/s | 60.7 steps/s
[Step=42550 Epoch=207.3] | Loss=0.01766 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.366 | L2-Norm(final)=13.593 | 4696.7 samples/s | 73.4 steps/s
[Step=42600 Epoch=207.6] | Loss=0.01706 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.371 | L2-Norm(final)=13.596 | 4970.5 samples/s | 77.7 steps/s
[Step=42650 Epoch=207.8] | Loss=0.01514 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.376 | L2-Norm(final)=13.598 | 4896.9 samples/s | 76.5 steps/s
[Step=42700 Epoch=208.1] | Loss=0.01414 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.381 | L2-Norm(final)=13.601 | 6582.4 samples/s | 102.8 steps/s
[Step=42750 Epoch=208.3] | Loss=0.01236 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.385 | L2-Norm(final)=13.604 | 1852.6 samples/s | 28.9 steps/s
[Step=42800 Epoch=208.5] | Loss=0.01152 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.390 | L2-Norm(final)=13.607 | 4944.6 samples/s | 77.3 steps/s
[Step=42850 Epoch=208.8] | Loss=0.01074 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.394 | L2-Norm(final)=13.610 | 4910.3 samples/s | 76.7 steps/s
[Step=42900 Epoch=209.0] | Loss=0.01028 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.397 | L2-Norm(final)=13.613 | 6162.9 samples/s | 96.3 steps/s
[Step=42950 Epoch=209.3] | Loss=0.00971 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.401 | L2-Norm(final)=13.616 | 1915.8 samples/s | 29.9 steps/s
[Step=43000 Epoch=209.5] | Loss=0.00925 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.405 | L2-Norm(final)=13.619 | 4883.2 samples/s | 76.3 steps/s
[Step=43050 Epoch=209.8] | Loss=0.00891 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.408 | L2-Norm(final)=13.622 | 4930.9 samples/s | 77.0 steps/s
[Step=43100 Epoch=210.0] | Loss=0.00856 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.412 | L2-Norm(final)=13.625 | 5728.6 samples/s | 89.5 steps/s
[Step=43150 Epoch=210.2] | Loss=0.00821 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.415 | L2-Norm(final)=13.627 | 1923.4 samples/s | 30.1 steps/s
[Step=43200 Epoch=210.5] | Loss=0.00796 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.418 | L2-Norm(final)=13.630 | 4933.6 samples/s | 77.1 steps/s
[Step=43250 Epoch=210.7] | Loss=0.00768 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.421 | L2-Norm(final)=13.633 | 4926.6 samples/s | 77.0 steps/s
[Step=43300 Epoch=211.0] | Loss=0.00749 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.424 | L2-Norm(final)=13.635 | 5309.8 samples/s | 83.0 steps/s
[Step=43350 Epoch=211.2] | Loss=0.00732 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.427 | L2-Norm(final)=13.638 | 2006.7 samples/s | 31.4 steps/s
[Step=43400 Epoch=211.5] | Loss=0.00710 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.430 | L2-Norm(final)=13.640 | 4853.8 samples/s | 75.8 steps/s
[Step=43450 Epoch=211.7] | Loss=0.00692 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.432 | L2-Norm(final)=13.642 | 4965.5 samples/s | 77.6 steps/s
[Step=43500 Epoch=212.0] | Loss=0.00678 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.435 | L2-Norm(final)=13.645 | 4964.7 samples/s | 77.6 steps/s
[Step=43550 Epoch=212.2] | Loss=0.00665 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.438 | L2-Norm(final)=13.647 | 2039.1 samples/s | 31.9 steps/s
[Step=43600 Epoch=212.4] | Loss=0.00651 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.440 | L2-Norm(final)=13.650 | 5009.3 samples/s | 78.3 steps/s
[Step=43650 Epoch=212.7] | Loss=0.00637 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.443 | L2-Norm(final)=13.652 | 4878.2 samples/s | 76.2 steps/s
[Step=43700 Epoch=212.9] | Loss=0.00625 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.446 | L2-Norm(final)=13.654 | 4904.4 samples/s | 76.6 steps/s
[Step=43750 Epoch=213.2] | Loss=0.00615 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.448 | L2-Norm(final)=13.656 | 2063.1 samples/s | 32.2 steps/s
[Step=43800 Epoch=213.4] | Loss=0.00606 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.451 | L2-Norm(final)=13.658 | 4966.0 samples/s | 77.6 steps/s
[Step=43850 Epoch=213.7] | Loss=0.00591 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.453 | L2-Norm(final)=13.661 | 4936.8 samples/s | 77.1 steps/s
[Step=43900 Epoch=213.9] | Loss=0.00584 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.455 | L2-Norm(final)=13.663 | 4885.4 samples/s | 76.3 steps/s
[Step=43950 Epoch=214.1] | Loss=0.00575 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.458 | L2-Norm(final)=13.665 | 2079.4 samples/s | 32.5 steps/s
[Step=44000 Epoch=214.4] | Loss=0.00563 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.460 | L2-Norm(final)=13.667 | 4918.0 samples/s | 76.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step44000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=44001 Epoch=214.6] | Loss=0.00591 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.296 | L2-Norm(final)=13.246 | 3723.9 samples/s | 58.2 steps/s
[Step=44050 Epoch=214.8] | Loss=0.02429 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.300 | L2-Norm(final)=13.245 | 5656.3 samples/s | 88.4 steps/s
[Step=44100 Epoch=215.1] | Loss=0.02497 | Reg=0.00087 | acc=0.9688 | L2-Norm=9.304 | L2-Norm(final)=13.244 | 5555.1 samples/s | 86.8 steps/s
[Step=44150 Epoch=215.3] | Loss=0.02311 | Reg=0.00087 | acc=0.9688 | L2-Norm=9.307 | L2-Norm(final)=13.244 | 5498.7 samples/s | 85.9 steps/s
[Step=44200 Epoch=215.5] | Loss=0.02298 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.310 | L2-Norm(final)=13.245 | 7832.6 samples/s | 122.4 steps/s
[Step=44250 Epoch=215.8] | Loss=0.02159 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.314 | L2-Norm(final)=13.246 | 1892.7 samples/s | 29.6 steps/s
[Step=44300 Epoch=216.0] | Loss=0.02074 | Reg=0.00087 | acc=0.9688 | L2-Norm=9.317 | L2-Norm(final)=13.247 | 5594.3 samples/s | 87.4 steps/s
[Step=44350 Epoch=216.3] | Loss=0.02041 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.320 | L2-Norm(final)=13.249 | 5585.1 samples/s | 87.3 steps/s
[Step=44400 Epoch=216.5] | Loss=0.01980 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.324 | L2-Norm(final)=13.252 | 6832.6 samples/s | 106.8 steps/s
[Step=44450 Epoch=216.8] | Loss=0.01937 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.327 | L2-Norm(final)=13.254 | 1983.5 samples/s | 31.0 steps/s
[Step=44500 Epoch=217.0] | Loss=0.01904 | Reg=0.00087 | acc=0.9688 | L2-Norm=9.330 | L2-Norm(final)=13.257 | 5499.3 samples/s | 85.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=217.0] | Loss=0.01700 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.363 | L2-Norm(final)=13.282 | 3992.1 samples/s | 62.4 steps/s
[Step=44550 Epoch=217.3] | Loss=0.01479 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.369 | L2-Norm(final)=13.285 | 4704.8 samples/s | 73.5 steps/s
[Step=44600 Epoch=217.5] | Loss=0.01488 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.376 | L2-Norm(final)=13.288 | 4841.0 samples/s | 75.6 steps/s
[Step=44650 Epoch=217.7] | Loss=0.01370 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.382 | L2-Norm(final)=13.292 | 4970.6 samples/s | 77.7 steps/s
[Step=44700 Epoch=218.0] | Loss=0.01294 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.387 | L2-Norm(final)=13.295 | 6488.1 samples/s | 101.4 steps/s
[Step=44750 Epoch=218.2] | Loss=0.01198 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.392 | L2-Norm(final)=13.298 | 1863.8 samples/s | 29.1 steps/s
[Step=44800 Epoch=218.5] | Loss=0.01103 | Reg=0.00088 | acc=0.9844 | L2-Norm=9.396 | L2-Norm(final)=13.301 | 4943.3 samples/s | 77.2 steps/s
[Step=44850 Epoch=218.7] | Loss=0.01029 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.400 | L2-Norm(final)=13.304 | 4875.3 samples/s | 76.2 steps/s
[Step=44900 Epoch=219.0] | Loss=0.00970 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.404 | L2-Norm(final)=13.307 | 6161.2 samples/s | 96.3 steps/s
[Step=44950 Epoch=219.2] | Loss=0.00908 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.408 | L2-Norm(final)=13.310 | 1903.6 samples/s | 29.7 steps/s
[Step=45000 Epoch=219.4] | Loss=0.00857 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.411 | L2-Norm(final)=13.313 | 4898.2 samples/s | 76.5 steps/s
[Step=45050 Epoch=219.7] | Loss=0.00814 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.415 | L2-Norm(final)=13.316 | 4912.5 samples/s | 76.8 steps/s
[Step=45100 Epoch=219.9] | Loss=0.00798 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.418 | L2-Norm(final)=13.319 | 5738.8 samples/s | 89.7 steps/s
[Step=45150 Epoch=220.2] | Loss=0.00767 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.421 | L2-Norm(final)=13.321 | 1930.8 samples/s | 30.2 steps/s
[Step=45200 Epoch=220.4] | Loss=0.00743 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.424 | L2-Norm(final)=13.324 | 5039.5 samples/s | 78.7 steps/s
[Step=45250 Epoch=220.7] | Loss=0.00721 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.427 | L2-Norm(final)=13.327 | 4904.1 samples/s | 76.6 steps/s
[Step=45300 Epoch=220.9] | Loss=0.00708 | Reg=0.00089 | acc=0.9688 | L2-Norm=9.430 | L2-Norm(final)=13.329 | 5323.7 samples/s | 83.2 steps/s
[Step=45350 Epoch=221.2] | Loss=0.00686 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.433 | L2-Norm(final)=13.332 | 1989.0 samples/s | 31.1 steps/s
[Step=45400 Epoch=221.4] | Loss=0.00665 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.436 | L2-Norm(final)=13.334 | 4971.5 samples/s | 77.7 steps/s
[Step=45450 Epoch=221.6] | Loss=0.00654 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.439 | L2-Norm(final)=13.337 | 4959.9 samples/s | 77.5 steps/s
[Step=45500 Epoch=221.9] | Loss=0.00641 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.442 | L2-Norm(final)=13.339 | 5021.2 samples/s | 78.5 steps/s
[Step=45550 Epoch=222.1] | Loss=0.00623 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.445 | L2-Norm(final)=13.342 | 2047.1 samples/s | 32.0 steps/s
[Step=45600 Epoch=222.4] | Loss=0.00608 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.447 | L2-Norm(final)=13.344 | 4874.7 samples/s | 76.2 steps/s
[Step=45650 Epoch=222.6] | Loss=0.00593 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.450 | L2-Norm(final)=13.346 | 4968.6 samples/s | 77.6 steps/s
[Step=45700 Epoch=222.9] | Loss=0.00584 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.453 | L2-Norm(final)=13.349 | 4922.8 samples/s | 76.9 steps/s
[Step=45750 Epoch=223.1] | Loss=0.00575 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.455 | L2-Norm(final)=13.351 | 2025.5 samples/s | 31.6 steps/s
[Step=45800 Epoch=223.3] | Loss=0.00563 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.458 | L2-Norm(final)=13.353 | 5064.2 samples/s | 79.1 steps/s
[Step=45850 Epoch=223.6] | Loss=0.00557 | Reg=0.00089 | acc=1.0000 | L2-Norm=9.460 | L2-Norm(final)=13.356 | 4932.0 samples/s | 77.1 steps/s
[Step=45900 Epoch=223.8] | Loss=0.00546 | Reg=0.00090 | acc=0.9844 | L2-Norm=9.462 | L2-Norm(final)=13.358 | 4922.2 samples/s | 76.9 steps/s
[Step=45950 Epoch=224.1] | Loss=0.00539 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.465 | L2-Norm(final)=13.360 | 2064.1 samples/s | 32.3 steps/s
[Step=46000 Epoch=224.3] | Loss=0.00531 | Reg=0.00090 | acc=1.0000 | L2-Norm=9.467 | L2-Norm(final)=13.362 | 4970.2 samples/s | 77.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step46000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=32001 Epoch=303.2] | Loss=0.00005 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.296 | L2-Norm(final)=7.624 | 3811.5 samples/s | 59.6 steps/s
[Step=32050 Epoch=303.7] | Loss=0.00083 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.298 | L2-Norm(final)=7.623 | 4895.9 samples/s | 76.5 steps/s
[Step=32100 Epoch=304.2] | Loss=0.00056 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.302 | L2-Norm(final)=7.628 | 7369.8 samples/s | 115.2 steps/s
[Step=32150 Epoch=304.6] | Loss=0.00042 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.303 | L2-Norm(final)=7.632 | 1852.0 samples/s | 28.9 steps/s
[Step=32200 Epoch=305.1] | Loss=0.00034 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.304 | L2-Norm(final)=7.636 | 6774.3 samples/s | 105.8 steps/s
[Step=32250 Epoch=305.6] | Loss=0.00029 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.304 | L2-Norm(final)=7.639 | 1909.2 samples/s | 29.8 steps/s
[Step=32300 Epoch=306.1] | Loss=0.00025 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.304 | L2-Norm(final)=7.642 | 6087.4 samples/s | 95.1 steps/s
[Step=32350 Epoch=306.5] | Loss=0.00023 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.304 | L2-Norm(final)=7.645 | 1951.5 samples/s | 30.5 steps/s
[Step=32400 Epoch=307.0] | Loss=0.00021 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.303 | L2-Norm(final)=7.648 | 5732.4 samples/s | 89.6 steps/s
[Step=32450 Epoch=307.5] | Loss=0.00019 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.303 | L2-Norm(final)=7.651 | 1993.1 samples/s | 31.1 steps/s
[Step=32500 Epoch=308.0] | Loss=0.00018 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.302 | L2-Norm(final)=7.653 | 5343.5 samples/s | 83.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=32501 Epoch=308.0] | Loss=0.00006 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.294 | L2-Norm(final)=7.680 | 3876.4 samples/s | 60.6 steps/s
[Step=32550 Epoch=308.4] | Loss=0.00004 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.290 | L2-Norm(final)=7.682 | 4395.5 samples/s | 68.7 steps/s
[Step=32600 Epoch=308.9] | Loss=0.00003 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.282 | L2-Norm(final)=7.683 | 6354.3 samples/s | 99.3 steps/s
[Step=32650 Epoch=309.4] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.274 | L2-Norm(final)=7.684 | 1802.8 samples/s | 28.2 steps/s
[Step=32700 Epoch=309.9] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.264 | L2-Norm(final)=7.684 | 5862.7 samples/s | 91.6 steps/s
[Step=32750 Epoch=310.3] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.254 | L2-Norm(final)=7.685 | 1839.4 samples/s | 28.7 steps/s
[Step=32800 Epoch=310.8] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.243 | L2-Norm(final)=7.685 | 5456.3 samples/s | 85.3 steps/s
[Step=32850 Epoch=311.3] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.232 | L2-Norm(final)=7.686 | 1891.7 samples/s | 29.6 steps/s
[Step=32900 Epoch=311.8] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.221 | L2-Norm(final)=7.686 | 5162.7 samples/s | 80.7 steps/s
[Step=32950 Epoch=312.2] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.209 | L2-Norm(final)=7.686 | 1930.1 samples/s | 30.2 steps/s
[Step=33000 Epoch=312.7] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.198 | L2-Norm(final)=7.686 | 4711.7 samples/s | 73.6 steps/s
[Step=33050 Epoch=313.2] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.186 | L2-Norm(final)=7.687 | 1977.2 samples/s | 30.9 steps/s
[Step=33100 Epoch=313.7] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.174 | L2-Norm(final)=7.687 | 4761.7 samples/s | 74.4 steps/s
[Step=33150 Epoch=314.1] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.162 | L2-Norm(final)=7.687 | 1959.1 samples/s | 30.6 steps/s
[Step=33200 Epoch=314.6] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.149 | L2-Norm(final)=7.687 | 4763.4 samples/s | 74.4 steps/s
[Step=33250 Epoch=315.1] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.137 | L2-Norm(final)=7.688 | 2005.9 samples/s | 31.3 steps/s
[Step=33300 Epoch=315.5] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.124 | L2-Norm(final)=7.688 | 4671.8 samples/s | 73.0 steps/s
[Step=33350 Epoch=316.0] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.111 | L2-Norm(final)=7.688 | 2091.5 samples/s | 32.7 steps/s
[Step=33400 Epoch=316.5] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.098 | L2-Norm(final)=7.688 | 4518.5 samples/s | 70.6 steps/s
[Step=33450 Epoch=317.0] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.085 | L2-Norm(final)=7.688 | 6433.9 samples/s | 100.5 steps/s
[Step=33500 Epoch=317.4] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.071 | L2-Norm(final)=7.689 | 1794.2 samples/s | 28.0 steps/s
[Step=33550 Epoch=317.9] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.058 | L2-Norm(final)=7.689 | 6024.9 samples/s | 94.1 steps/s
[Step=33600 Epoch=318.4] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.044 | L2-Norm(final)=7.689 | 1812.9 samples/s | 28.3 steps/s
[Step=33650 Epoch=318.9] | Loss=0.00000 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.030 | L2-Norm(final)=7.689 | 5638.1 samples/s | 88.1 steps/s
[Step=33700 Epoch=319.3] | Loss=0.00000 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.016 | L2-Norm(final)=7.689 | 1865.7 samples/s | 29.2 steps/s
[Step=33750 Epoch=319.8] | Loss=0.00000 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.002 | L2-Norm(final)=7.690 | 5255.7 samples/s | 82.1 steps/s
[Step=33800 Epoch=320.3] | Loss=0.00000 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.988 | L2-Norm(final)=7.690 | 1893.2 samples/s | 29.6 steps/s
[Step=33850 Epoch=320.8] | Loss=0.00000 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.973 | L2-Norm(final)=7.690 | 4885.3 samples/s | 76.3 steps/s
[Step=33900 Epoch=321.2] | Loss=0.00000 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.958 | L2-Norm(final)=7.690 | 1961.9 samples/s | 30.7 steps/s
[Step=33950 Epoch=321.7] | Loss=0.00000 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.944 | L2-Norm(final)=7.691 | 4760.9 samples/s | 74.4 steps/s
[Step=34000 Epoch=322.2] | Loss=0.00000 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.929 | L2-Norm(final)=7.691 | 1997.5 samples/s | 31.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_0/client_state-step34000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=44001 Epoch=418.6] | Loss=0.00014 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.296 | L2-Norm(final)=9.388 | 3897.4 samples/s | 60.9 steps/s
[Step=44050 Epoch=419.0] | Loss=0.00201 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.296 | L2-Norm(final)=9.389 | 4808.0 samples/s | 75.1 steps/s
[Step=44100 Epoch=419.5] | Loss=0.00132 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.304 | L2-Norm(final)=9.392 | 7494.9 samples/s | 117.1 steps/s
[Step=44150 Epoch=420.0] | Loss=0.00096 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.309 | L2-Norm(final)=9.395 | 1860.2 samples/s | 29.1 steps/s
[Step=44200 Epoch=420.5] | Loss=0.00076 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.311 | L2-Norm(final)=9.398 | 6876.2 samples/s | 107.4 steps/s
[Step=44250 Epoch=420.9] | Loss=0.00064 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.313 | L2-Norm(final)=9.400 | 1878.5 samples/s | 29.4 steps/s
[Step=44300 Epoch=421.4] | Loss=0.00056 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.314 | L2-Norm(final)=9.403 | 6288.3 samples/s | 98.3 steps/s
[Step=44350 Epoch=421.9] | Loss=0.00049 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.315 | L2-Norm(final)=9.405 | 1956.6 samples/s | 30.6 steps/s
[Step=44400 Epoch=422.4] | Loss=0.00045 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.316 | L2-Norm(final)=9.407 | 5847.6 samples/s | 91.4 steps/s
[Step=44450 Epoch=422.8] | Loss=0.00041 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.316 | L2-Norm(final)=9.409 | 2029.6 samples/s | 31.7 steps/s
[Step=44500 Epoch=423.3] | Loss=0.00038 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.317 | L2-Norm(final)=9.411 | 5242.7 samples/s | 81.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=423.3] | Loss=0.00015 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.320 | L2-Norm(final)=9.431 | 3675.8 samples/s | 57.4 steps/s
[Step=44550 Epoch=423.8] | Loss=0.00008 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.320 | L2-Norm(final)=9.433 | 4638.6 samples/s | 72.5 steps/s
[Step=44600 Epoch=424.3] | Loss=0.00005 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.318 | L2-Norm(final)=9.434 | 6419.9 samples/s | 100.3 steps/s
[Step=44650 Epoch=424.7] | Loss=0.00004 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.314 | L2-Norm(final)=9.434 | 1785.6 samples/s | 27.9 steps/s
[Step=44700 Epoch=425.2] | Loss=0.00003 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.309 | L2-Norm(final)=9.435 | 5829.8 samples/s | 91.1 steps/s
[Step=44750 Epoch=425.7] | Loss=0.00003 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.303 | L2-Norm(final)=9.435 | 1847.1 samples/s | 28.9 steps/s
[Step=44800 Epoch=426.2] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.298 | L2-Norm(final)=9.435 | 5351.8 samples/s | 83.6 steps/s
[Step=44850 Epoch=426.6] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.292 | L2-Norm(final)=9.435 | 1896.4 samples/s | 29.6 steps/s
[Step=44900 Epoch=427.1] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.286 | L2-Norm(final)=9.436 | 5169.8 samples/s | 80.8 steps/s
[Step=44950 Epoch=427.6] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.280 | L2-Norm(final)=9.436 | 1956.4 samples/s | 30.6 steps/s
[Step=45000 Epoch=428.1] | Loss=0.00002 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.273 | L2-Norm(final)=9.436 | 4798.9 samples/s | 75.0 steps/s
[Step=45050 Epoch=428.5] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.267 | L2-Norm(final)=9.436 | 1975.9 samples/s | 30.9 steps/s
[Step=45100 Epoch=429.0] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.260 | L2-Norm(final)=9.436 | 4752.2 samples/s | 74.3 steps/s
[Step=45150 Epoch=429.5] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.253 | L2-Norm(final)=9.437 | 1978.5 samples/s | 30.9 steps/s
[Step=45200 Epoch=430.0] | Loss=0.00001 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.247 | L2-Norm(final)=9.437 | 4756.5 samples/s | 74.3 steps/s
[Step=45250 Epoch=430.4] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.240 | L2-Norm(final)=9.437 | 2016.2 samples/s | 31.5 steps/s
[Step=45300 Epoch=430.9] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.232 | L2-Norm(final)=9.437 | 4756.5 samples/s | 74.3 steps/s
[Step=45350 Epoch=431.4] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.225 | L2-Norm(final)=9.437 | 2023.0 samples/s | 31.6 steps/s
[Step=45400 Epoch=431.9] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.218 | L2-Norm(final)=9.437 | 4667.6 samples/s | 72.9 steps/s
[Step=45450 Epoch=432.3] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.210 | L2-Norm(final)=9.438 | 6611.4 samples/s | 103.3 steps/s
[Step=45500 Epoch=432.8] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.203 | L2-Norm(final)=9.438 | 1785.9 samples/s | 27.9 steps/s
[Step=45550 Epoch=433.3] | Loss=0.00001 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.195 | L2-Norm(final)=9.438 | 6114.4 samples/s | 95.5 steps/s
[Step=45600 Epoch=433.8] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.187 | L2-Norm(final)=9.438 | 1818.2 samples/s | 28.4 steps/s
[Step=45650 Epoch=434.2] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.179 | L2-Norm(final)=9.438 | 5657.9 samples/s | 88.4 steps/s
[Step=45700 Epoch=434.7] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.171 | L2-Norm(final)=9.438 | 1889.9 samples/s | 29.5 steps/s
[Step=45750 Epoch=435.2] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.163 | L2-Norm(final)=9.438 | 5220.3 samples/s | 81.6 steps/s
[Step=45800 Epoch=435.7] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.154 | L2-Norm(final)=9.439 | 1920.1 samples/s | 30.0 steps/s
[Step=45850 Epoch=436.1] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.146 | L2-Norm(final)=9.439 | 4939.4 samples/s | 77.2 steps/s
[Step=45900 Epoch=436.6] | Loss=0.00001 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.137 | L2-Norm(final)=9.439 | 1962.0 samples/s | 30.7 steps/s
[Step=45950 Epoch=437.1] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.128 | L2-Norm(final)=9.439 | 4740.9 samples/s | 74.1 steps/s
[Step=46000 Epoch=437.6] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.119 | L2-Norm(final)=9.439 | 1991.7 samples/s | 31.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step46000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07974 | acc=0.9621 | tpr=0.9682 | fpr=0.0510 | 4420.6 samples/s | 17.3 steps/s
Avg test loss: 0.08311, Avg test acc: 0.96013, Avg tpr: 0.96672, Avg fpr: 0.05435, total FA: 424

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08216 | acc=0.9632 | tpr=0.9715 | fpr=0.0548 | 4330.9 samples/s | 16.9 steps/s
Avg test loss: 0.08503, Avg test acc: 0.96134, Avg tpr: 0.96963, Avg fpr: 0.05692, total FA: 444

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08155 | acc=0.9609 | tpr=0.9696 | fpr=0.0580 | 4384.6 samples/s | 17.1 steps/s
Avg test loss: 0.08588, Avg test acc: 0.95977, Avg tpr: 0.96765, Avg fpr: 0.05756, total FA: 449

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.07763 | acc=0.9611 | tpr=0.9681 | fpr=0.0540 | 4349.3 samples/s | 17.0 steps/s
Avg test loss: 0.08195, Avg test acc: 0.96057, Avg tpr: 0.96724, Avg fpr: 0.05410, total FA: 422

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08155 | acc=0.9628 | tpr=0.9752 | fpr=0.0642 | 4344.2 samples/s | 17.0 steps/s
Avg test loss: 0.08931, Avg test acc: 0.96158, Avg tpr: 0.97377, Avg fpr: 0.06525, total FA: 509

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.16603 | acc=0.2995 | tpr=0.0023 | fpr=0.0550 | 4373.6 samples/s | 17.1 steps/s
Avg test loss: 5.18107, Avg test acc: 0.29570, Avg tpr: 0.00274, Avg fpr: 0.05999, total FA: 468

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.78632 | acc=0.3139 | tpr=0.0047 | fpr=0.0146 | 4370.3 samples/s | 17.1 steps/s
Avg test loss: 4.79658, Avg test acc: 0.31116, Avg tpr: 0.00507, Avg fpr: 0.01564, total FA: 122

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.02324 | acc=0.3043 | tpr=0.0048 | fpr=0.0453 | 4368.5 samples/s | 17.1 steps/s
Avg test loss: 5.03308, Avg test acc: 0.30159, Avg tpr: 0.00565, Avg fpr: 0.04756, total FA: 371

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.23768 | acc=0.3047 | tpr=0.0030 | fpr=0.0401 | 4408.9 samples/s | 17.2 steps/s
Avg test loss: 5.25293, Avg test acc: 0.30175, Avg tpr: 0.00356, Avg fpr: 0.04243, total FA: 331

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.83881 | acc=0.3131 | tpr=0.0032 | fpr=0.0139 | 4350.2 samples/s | 17.0 steps/s
Avg test loss: 4.84816, Avg test acc: 0.31060, Avg tpr: 0.00367, Avg fpr: 0.01436, total FA: 112

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.72275 | acc=0.1320 | tpr=0.8230 | fpr=0.8804 | 4412.5 samples/s | 17.2 steps/s
[Step= 100] | Loss=4.67462 | acc=0.1350 | tpr=0.8060 | fpr=0.8776 | 8771.5 samples/s | 34.3 steps/s
[Step= 150] | Loss=4.67551 | acc=0.1338 | tpr=0.8228 | fpr=0.8789 | 8301.2 samples/s | 32.4 steps/s
[Step= 200] | Loss=4.67493 | acc=0.1330 | tpr=0.8208 | fpr=0.8795 | 8644.0 samples/s | 33.8 steps/s
[Step= 250] | Loss=4.67950 | acc=0.1343 | tpr=0.8227 | fpr=0.8782 | 8650.4 samples/s | 33.8 steps/s
[Step= 300] | Loss=4.67459 | acc=0.1342 | tpr=0.8189 | fpr=0.8782 | 8766.1 samples/s | 34.2 steps/s
[Step= 350] | Loss=4.67051 | acc=0.1337 | tpr=0.8153 | fpr=0.8787 | 8654.3 samples/s | 33.8 steps/s
[Step= 400] | Loss=4.67389 | acc=0.1339 | tpr=0.8129 | fpr=0.8784 | 8639.7 samples/s | 33.7 steps/s
[Step= 450] | Loss=4.67614 | acc=0.1337 | tpr=0.8092 | fpr=0.8785 | 8618.3 samples/s | 33.7 steps/s
[Step= 500] | Loss=4.67901 | acc=0.1336 | tpr=0.8093 | fpr=0.8786 | 8642.8 samples/s | 33.8 steps/s
[Step= 550] | Loss=4.67745 | acc=0.1334 | tpr=0.8114 | fpr=0.8790 | 15583.7 samples/s | 60.9 steps/s
Avg test loss: 4.67916, Avg test acc: 0.13328, Avg tpr: 0.81062, Avg fpr: 0.87903, total FA: 122052

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.67165 | acc=0.1391 | tpr=0.8186 | fpr=0.8731 | 4371.5 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.62408 | acc=0.1413 | tpr=0.7996 | fpr=0.8710 | 9071.0 samples/s | 35.4 steps/s
[Step= 150] | Loss=4.62552 | acc=0.1399 | tpr=0.8127 | fpr=0.8725 | 8244.0 samples/s | 32.2 steps/s
[Step= 200] | Loss=4.62634 | acc=0.1395 | tpr=0.8120 | fpr=0.8727 | 8713.7 samples/s | 34.0 steps/s
[Step= 250] | Loss=4.62699 | acc=0.1402 | tpr=0.8105 | fpr=0.8720 | 8557.1 samples/s | 33.4 steps/s
[Step= 300] | Loss=4.62270 | acc=0.1396 | tpr=0.8080 | fpr=0.8726 | 8751.1 samples/s | 34.2 steps/s
[Step= 350] | Loss=4.61832 | acc=0.1395 | tpr=0.8053 | fpr=0.8726 | 8472.2 samples/s | 33.1 steps/s
[Step= 400] | Loss=4.61973 | acc=0.1393 | tpr=0.8020 | fpr=0.8727 | 8881.9 samples/s | 34.7 steps/s
[Step= 450] | Loss=4.62533 | acc=0.1392 | tpr=0.7984 | fpr=0.8728 | 8648.1 samples/s | 33.8 steps/s
[Step= 500] | Loss=4.63004 | acc=0.1389 | tpr=0.7987 | fpr=0.8730 | 8471.5 samples/s | 33.1 steps/s
[Step= 550] | Loss=4.62786 | acc=0.1390 | tpr=0.8018 | fpr=0.8731 | 15062.5 samples/s | 58.8 steps/s
Avg test loss: 4.62918, Avg test acc: 0.13890, Avg tpr: 0.80111, Avg fpr: 0.87314, total FA: 121234

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.40472 | acc=0.1225 | tpr=0.7876 | fpr=0.8895 | 4571.0 samples/s | 17.9 steps/s
[Step= 100] | Loss=5.35272 | acc=0.1249 | tpr=0.7783 | fpr=0.8873 | 8165.9 samples/s | 31.9 steps/s
[Step= 150] | Loss=5.35484 | acc=0.1228 | tpr=0.7997 | fpr=0.8897 | 8509.9 samples/s | 33.2 steps/s
[Step= 200] | Loss=5.35525 | acc=0.1218 | tpr=0.8055 | fpr=0.8906 | 8641.5 samples/s | 33.8 steps/s
[Step= 250] | Loss=5.35630 | acc=0.1225 | tpr=0.8035 | fpr=0.8899 | 8598.9 samples/s | 33.6 steps/s
[Step= 300] | Loss=5.35174 | acc=0.1222 | tpr=0.8015 | fpr=0.8902 | 8733.9 samples/s | 34.1 steps/s
[Step= 350] | Loss=5.34985 | acc=0.1220 | tpr=0.8009 | fpr=0.8903 | 8647.7 samples/s | 33.8 steps/s
[Step= 400] | Loss=5.35283 | acc=0.1222 | tpr=0.7992 | fpr=0.8901 | 9018.3 samples/s | 35.2 steps/s
[Step= 450] | Loss=5.35708 | acc=0.1217 | tpr=0.7941 | fpr=0.8905 | 8105.5 samples/s | 31.7 steps/s
[Step= 500] | Loss=5.35805 | acc=0.1217 | tpr=0.7956 | fpr=0.8904 | 8652.5 samples/s | 33.8 steps/s
[Step= 550] | Loss=5.35686 | acc=0.1216 | tpr=0.8002 | fpr=0.8908 | 15729.4 samples/s | 61.4 steps/s
Avg test loss: 5.35801, Avg test acc: 0.12150, Avg tpr: 0.79992, Avg fpr: 0.89083, total FA: 123690

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.57252 | acc=0.1422 | tpr=0.7611 | fpr=0.8689 | 4399.7 samples/s | 17.2 steps/s
[Step= 100] | Loss=4.52660 | acc=0.1449 | tpr=0.7527 | fpr=0.8665 | 8550.8 samples/s | 33.4 steps/s
[Step= 150] | Loss=4.52439 | acc=0.1434 | tpr=0.7637 | fpr=0.8681 | 8467.6 samples/s | 33.1 steps/s
[Step= 200] | Loss=4.52181 | acc=0.1424 | tpr=0.7650 | fpr=0.8689 | 8675.3 samples/s | 33.9 steps/s
[Step= 250] | Loss=4.52408 | acc=0.1431 | tpr=0.7633 | fpr=0.8682 | 9093.8 samples/s | 35.5 steps/s
[Step= 300] | Loss=4.51946 | acc=0.1427 | tpr=0.7600 | fpr=0.8685 | 8287.3 samples/s | 32.4 steps/s
[Step= 350] | Loss=4.51507 | acc=0.1421 | tpr=0.7577 | fpr=0.8690 | 8638.3 samples/s | 33.7 steps/s
[Step= 400] | Loss=4.51867 | acc=0.1421 | tpr=0.7527 | fpr=0.8690 | 8587.5 samples/s | 33.5 steps/s
[Step= 450] | Loss=4.52338 | acc=0.1418 | tpr=0.7463 | fpr=0.8692 | 8575.0 samples/s | 33.5 steps/s
[Step= 500] | Loss=4.52567 | acc=0.1417 | tpr=0.7476 | fpr=0.8692 | 8887.8 samples/s | 34.7 steps/s
[Step= 550] | Loss=4.52364 | acc=0.1413 | tpr=0.7513 | fpr=0.8697 | 14884.7 samples/s | 58.1 steps/s
Avg test loss: 4.52520, Avg test acc: 0.14128, Avg tpr: 0.75079, Avg fpr: 0.86980, total FA: 120770

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.27558 | acc=0.1270 | tpr=0.7345 | fpr=0.8840 | 4303.0 samples/s | 16.8 steps/s
[Step= 100] | Loss=5.22285 | acc=0.1293 | tpr=0.7122 | fpr=0.8816 | 9178.4 samples/s | 35.9 steps/s
[Step= 150] | Loss=5.22306 | acc=0.1277 | tpr=0.7104 | fpr=0.8831 | 8123.4 samples/s | 31.7 steps/s
[Step= 200] | Loss=5.22146 | acc=0.1272 | tpr=0.7093 | fpr=0.8834 | 8831.8 samples/s | 34.5 steps/s
[Step= 250] | Loss=5.22502 | acc=0.1280 | tpr=0.7092 | fpr=0.8826 | 8703.7 samples/s | 34.0 steps/s
[Step= 300] | Loss=5.21962 | acc=0.1274 | tpr=0.7120 | fpr=0.8832 | 8399.8 samples/s | 32.8 steps/s
[Step= 350] | Loss=5.21644 | acc=0.1267 | tpr=0.7101 | fpr=0.8838 | 8667.6 samples/s | 33.9 steps/s
[Step= 400] | Loss=5.21986 | acc=0.1270 | tpr=0.7084 | fpr=0.8836 | 8817.2 samples/s | 34.4 steps/s
[Step= 450] | Loss=5.22360 | acc=0.1264 | tpr=0.7020 | fpr=0.8841 | 8617.5 samples/s | 33.7 steps/s
[Step= 500] | Loss=5.22615 | acc=0.1261 | tpr=0.6982 | fpr=0.8842 | 8591.9 samples/s | 33.6 steps/s
[Step= 550] | Loss=5.22496 | acc=0.1259 | tpr=0.6968 | fpr=0.8845 | 14943.8 samples/s | 58.4 steps/s
Avg test loss: 5.22706, Avg test acc: 0.12580, Avg tpr: 0.69651, Avg fpr: 0.88457, total FA: 122821

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09905 | acc=0.9816 | tpr=0.9469 | fpr=0.0178 | 4354.8 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.10301 | acc=0.9809 | tpr=0.9574 | fpr=0.0187 | 8718.8 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.10684 | acc=0.9797 | tpr=0.9553 | fpr=0.0198 | 8508.8 samples/s | 33.2 steps/s
[Step= 200] | Loss=0.10896 | acc=0.9797 | tpr=0.9607 | fpr=0.0199 | 8775.8 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.10847 | acc=0.9796 | tpr=0.9563 | fpr=0.0200 | 8605.4 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.11063 | acc=0.9793 | tpr=0.9556 | fpr=0.0203 | 8637.3 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.11066 | acc=0.9792 | tpr=0.9562 | fpr=0.0204 | 8593.5 samples/s | 33.6 steps/s
[Step= 400] | Loss=0.11167 | acc=0.9791 | tpr=0.9535 | fpr=0.0205 | 8620.7 samples/s | 33.7 steps/s
[Step= 450] | Loss=0.11430 | acc=0.9788 | tpr=0.9518 | fpr=0.0207 | 8365.5 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.11409 | acc=0.9788 | tpr=0.9524 | fpr=0.0207 | 8678.6 samples/s | 33.9 steps/s
[Step= 550] | Loss=0.11315 | acc=0.9789 | tpr=0.9519 | fpr=0.0206 | 15985.7 samples/s | 62.4 steps/s
Avg test loss: 0.11297, Avg test acc: 0.97896, Avg tpr: 0.95206, Avg fpr: 0.02055, total FA: 2854

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11048 | acc=0.9812 | tpr=0.9248 | fpr=0.0177 | 4356.2 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.11470 | acc=0.9813 | tpr=0.9382 | fpr=0.0179 | 8738.3 samples/s | 34.1 steps/s
[Step= 150] | Loss=0.11929 | acc=0.9802 | tpr=0.9308 | fpr=0.0189 | 8584.3 samples/s | 33.5 steps/s
[Step= 200] | Loss=0.12099 | acc=0.9803 | tpr=0.9355 | fpr=0.0189 | 8507.1 samples/s | 33.2 steps/s
[Step= 250] | Loss=0.12014 | acc=0.9802 | tpr=0.9336 | fpr=0.0190 | 8612.9 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.12253 | acc=0.9797 | tpr=0.9353 | fpr=0.0194 | 8668.6 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.12282 | acc=0.9795 | tpr=0.9368 | fpr=0.0197 | 8576.6 samples/s | 33.5 steps/s
[Step= 400] | Loss=0.12384 | acc=0.9794 | tpr=0.9338 | fpr=0.0198 | 8691.2 samples/s | 34.0 steps/s
[Step= 450] | Loss=0.12690 | acc=0.9791 | tpr=0.9323 | fpr=0.0200 | 8477.4 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.12645 | acc=0.9792 | tpr=0.9339 | fpr=0.0200 | 8749.4 samples/s | 34.2 steps/s
[Step= 550] | Loss=0.12558 | acc=0.9793 | tpr=0.9327 | fpr=0.0199 | 15560.8 samples/s | 60.8 steps/s
Avg test loss: 0.12535, Avg test acc: 0.97927, Avg tpr: 0.93265, Avg fpr: 0.01988, total FA: 2760

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.10046 | acc=0.9800 | tpr=0.9381 | fpr=0.0192 | 4365.7 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.10433 | acc=0.9795 | tpr=0.9552 | fpr=0.0201 | 8954.6 samples/s | 35.0 steps/s
[Step= 150] | Loss=0.10792 | acc=0.9785 | tpr=0.9510 | fpr=0.0210 | 8169.3 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.10964 | acc=0.9786 | tpr=0.9552 | fpr=0.0210 | 9532.7 samples/s | 37.2 steps/s
[Step= 250] | Loss=0.10924 | acc=0.9786 | tpr=0.9537 | fpr=0.0210 | 8198.6 samples/s | 32.0 steps/s
[Step= 300] | Loss=0.11153 | acc=0.9781 | tpr=0.9542 | fpr=0.0214 | 8440.0 samples/s | 33.0 steps/s
[Step= 350] | Loss=0.11148 | acc=0.9780 | tpr=0.9549 | fpr=0.0215 | 8626.8 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.11261 | acc=0.9779 | tpr=0.9535 | fpr=0.0216 | 8802.5 samples/s | 34.4 steps/s
[Step= 450] | Loss=0.11523 | acc=0.9778 | tpr=0.9528 | fpr=0.0218 | 8767.2 samples/s | 34.2 steps/s
[Step= 500] | Loss=0.11483 | acc=0.9777 | tpr=0.9546 | fpr=0.0218 | 8117.3 samples/s | 31.7 steps/s
[Step= 550] | Loss=0.11384 | acc=0.9780 | tpr=0.9546 | fpr=0.0216 | 16041.9 samples/s | 62.7 steps/s
Avg test loss: 0.11369, Avg test acc: 0.97798, Avg tpr: 0.95483, Avg fpr: 0.02160, total FA: 2999

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10260 | acc=0.9815 | tpr=0.9248 | fpr=0.0175 | 4423.7 samples/s | 17.3 steps/s
[Step= 100] | Loss=0.10711 | acc=0.9809 | tpr=0.9424 | fpr=0.0184 | 8438.8 samples/s | 33.0 steps/s
[Step= 150] | Loss=0.11125 | acc=0.9802 | tpr=0.9438 | fpr=0.0191 | 8769.1 samples/s | 34.3 steps/s
[Step= 200] | Loss=0.11355 | acc=0.9802 | tpr=0.9519 | fpr=0.0193 | 8660.4 samples/s | 33.8 steps/s
[Step= 250] | Loss=0.11248 | acc=0.9802 | tpr=0.9476 | fpr=0.0192 | 8659.5 samples/s | 33.8 steps/s
[Step= 300] | Loss=0.11420 | acc=0.9800 | tpr=0.9484 | fpr=0.0195 | 8739.0 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.11438 | acc=0.9799 | tpr=0.9512 | fpr=0.0196 | 8436.5 samples/s | 33.0 steps/s
[Step= 400] | Loss=0.11508 | acc=0.9797 | tpr=0.9486 | fpr=0.0197 | 8503.4 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.11789 | acc=0.9795 | tpr=0.9479 | fpr=0.0200 | 8688.3 samples/s | 33.9 steps/s
[Step= 500] | Loss=0.11745 | acc=0.9795 | tpr=0.9489 | fpr=0.0199 | 8605.1 samples/s | 33.6 steps/s
[Step= 550] | Loss=0.11658 | acc=0.9797 | tpr=0.9471 | fpr=0.0197 | 15563.3 samples/s | 60.8 steps/s
Avg test loss: 0.11640, Avg test acc: 0.97969, Avg tpr: 0.94691, Avg fpr: 0.01971, total FA: 2737

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12517 | acc=0.9797 | tpr=0.9292 | fpr=0.0194 | 4366.2 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.13011 | acc=0.9794 | tpr=0.9531 | fpr=0.0201 | 8520.8 samples/s | 33.3 steps/s
[Step= 150] | Loss=0.13524 | acc=0.9783 | tpr=0.9539 | fpr=0.0213 | 8739.9 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.13743 | acc=0.9780 | tpr=0.9585 | fpr=0.0217 | 8610.8 samples/s | 33.6 steps/s
[Step= 250] | Loss=0.13629 | acc=0.9781 | tpr=0.9537 | fpr=0.0214 | 8942.8 samples/s | 34.9 steps/s
[Step= 300] | Loss=0.13900 | acc=0.9778 | tpr=0.9549 | fpr=0.0217 | 8301.7 samples/s | 32.4 steps/s
[Step= 350] | Loss=0.13963 | acc=0.9776 | tpr=0.9568 | fpr=0.0220 | 8693.1 samples/s | 34.0 steps/s
[Step= 400] | Loss=0.14066 | acc=0.9774 | tpr=0.9530 | fpr=0.0221 | 8472.6 samples/s | 33.1 steps/s
[Step= 450] | Loss=0.14385 | acc=0.9771 | tpr=0.9523 | fpr=0.0225 | 8777.2 samples/s | 34.3 steps/s
[Step= 500] | Loss=0.14328 | acc=0.9771 | tpr=0.9529 | fpr=0.0224 | 8552.4 samples/s | 33.4 steps/s
[Step= 550] | Loss=0.14241 | acc=0.9773 | tpr=0.9515 | fpr=0.0223 | 15595.5 samples/s | 60.9 steps/s
Avg test loss: 0.14217, Avg test acc: 0.97726, Avg tpr: 0.95127, Avg fpr: 0.02227, total FA: 3092

server round 45/50

clients selected: [0 1 3 5 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=38001 Epoch=185.3] | Loss=0.05614 | Reg=0.00084 | acc=0.9531 | L2-Norm=9.180 | L2-Norm(final)=11.933 | 3970.5 samples/s | 62.0 steps/s
[Step=38050 Epoch=185.5] | Loss=0.02289 | Reg=0.00084 | acc=0.9688 | L2-Norm=9.185 | L2-Norm(final)=11.931 | 5056.1 samples/s | 79.0 steps/s
[Step=38100 Epoch=185.8] | Loss=0.02110 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.188 | L2-Norm(final)=11.932 | 5629.9 samples/s | 88.0 steps/s
[Step=38150 Epoch=186.0] | Loss=0.02041 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.191 | L2-Norm(final)=11.934 | 5439.1 samples/s | 85.0 steps/s
[Step=38200 Epoch=186.3] | Loss=0.02058 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.194 | L2-Norm(final)=11.936 | 7741.1 samples/s | 121.0 steps/s
[Step=38250 Epoch=186.5] | Loss=0.02017 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.198 | L2-Norm(final)=11.939 | 1940.1 samples/s | 30.3 steps/s
[Step=38300 Epoch=186.8] | Loss=0.01941 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.201 | L2-Norm(final)=11.941 | 5567.2 samples/s | 87.0 steps/s
[Step=38350 Epoch=187.0] | Loss=0.01891 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.204 | L2-Norm(final)=11.944 | 5388.4 samples/s | 84.2 steps/s
[Step=38400 Epoch=187.2] | Loss=0.01849 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.207 | L2-Norm(final)=11.947 | 7124.3 samples/s | 111.3 steps/s
[Step=38450 Epoch=187.5] | Loss=0.01876 | Reg=0.00085 | acc=0.9531 | L2-Norm=9.210 | L2-Norm(final)=11.950 | 1937.7 samples/s | 30.3 steps/s
[Step=38500 Epoch=187.7] | Loss=0.01810 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.213 | L2-Norm(final)=11.953 | 5467.1 samples/s | 85.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=38501 Epoch=187.7] | Loss=0.01856 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.245 | L2-Norm(final)=11.983 | 3951.7 samples/s | 61.7 steps/s
[Step=38550 Epoch=188.0] | Loss=0.01729 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.251 | L2-Norm(final)=11.987 | 4591.5 samples/s | 71.7 steps/s
[Step=38600 Epoch=188.2] | Loss=0.01553 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.257 | L2-Norm(final)=11.991 | 4916.1 samples/s | 76.8 steps/s
[Step=38650 Epoch=188.5] | Loss=0.01415 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.264 | L2-Norm(final)=11.995 | 4931.1 samples/s | 77.0 steps/s
[Step=38700 Epoch=188.7] | Loss=0.01336 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.269 | L2-Norm(final)=11.998 | 6637.1 samples/s | 103.7 steps/s
[Step=38750 Epoch=189.0] | Loss=0.01231 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.274 | L2-Norm(final)=12.002 | 1855.1 samples/s | 29.0 steps/s
[Step=38800 Epoch=189.2] | Loss=0.01153 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.279 | L2-Norm(final)=12.006 | 4944.4 samples/s | 77.3 steps/s
[Step=38850 Epoch=189.4] | Loss=0.01082 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=12.009 | 4953.0 samples/s | 77.4 steps/s
[Step=38900 Epoch=189.7] | Loss=0.01035 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.288 | L2-Norm(final)=12.013 | 6084.8 samples/s | 95.1 steps/s
[Step=38950 Epoch=189.9] | Loss=0.00978 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.292 | L2-Norm(final)=12.016 | 1885.5 samples/s | 29.5 steps/s
[Step=39000 Epoch=190.2] | Loss=0.00928 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.296 | L2-Norm(final)=12.020 | 4951.8 samples/s | 77.4 steps/s
[Step=39050 Epoch=190.4] | Loss=0.00905 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.300 | L2-Norm(final)=12.023 | 5014.9 samples/s | 78.4 steps/s
[Step=39100 Epoch=190.7] | Loss=0.00870 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.304 | L2-Norm(final)=12.026 | 5677.5 samples/s | 88.7 steps/s
[Step=39150 Epoch=190.9] | Loss=0.00841 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.308 | L2-Norm(final)=12.029 | 1943.7 samples/s | 30.4 steps/s
[Step=39200 Epoch=191.1] | Loss=0.00821 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.312 | L2-Norm(final)=12.032 | 4943.2 samples/s | 77.2 steps/s
[Step=39250 Epoch=191.4] | Loss=0.00793 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.315 | L2-Norm(final)=12.035 | 4939.0 samples/s | 77.2 steps/s
[Step=39300 Epoch=191.6] | Loss=0.00766 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.318 | L2-Norm(final)=12.038 | 5318.2 samples/s | 83.1 steps/s
[Step=39350 Epoch=191.9] | Loss=0.00754 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.322 | L2-Norm(final)=12.041 | 1996.5 samples/s | 31.2 steps/s
[Step=39400 Epoch=192.1] | Loss=0.00732 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.325 | L2-Norm(final)=12.044 | 4967.9 samples/s | 77.6 steps/s
[Step=39450 Epoch=192.4] | Loss=0.00713 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.328 | L2-Norm(final)=12.047 | 4828.4 samples/s | 75.4 steps/s
[Step=39500 Epoch=192.6] | Loss=0.00702 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=12.050 | 5045.6 samples/s | 78.8 steps/s
[Step=39550 Epoch=192.9] | Loss=0.00687 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.335 | L2-Norm(final)=12.053 | 2041.2 samples/s | 31.9 steps/s
[Step=39600 Epoch=193.1] | Loss=0.00673 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.338 | L2-Norm(final)=12.055 | 4961.0 samples/s | 77.5 steps/s
[Step=39650 Epoch=193.3] | Loss=0.00658 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.341 | L2-Norm(final)=12.058 | 4866.8 samples/s | 76.0 steps/s
[Step=39700 Epoch=193.6] | Loss=0.00652 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.344 | L2-Norm(final)=12.061 | 4871.7 samples/s | 76.1 steps/s
[Step=39750 Epoch=193.8] | Loss=0.00637 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.346 | L2-Norm(final)=12.064 | 2063.6 samples/s | 32.2 steps/s
[Step=39800 Epoch=194.1] | Loss=0.00630 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.349 | L2-Norm(final)=12.066 | 4939.7 samples/s | 77.2 steps/s
[Step=39850 Epoch=194.3] | Loss=0.00616 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.352 | L2-Norm(final)=12.069 | 4977.7 samples/s | 77.8 steps/s
[Step=39900 Epoch=194.6] | Loss=0.00608 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.355 | L2-Norm(final)=12.071 | 4933.7 samples/s | 77.1 steps/s
[Step=39950 Epoch=194.8] | Loss=0.00599 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.358 | L2-Norm(final)=12.074 | 2063.8 samples/s | 32.2 steps/s
[Step=40000 Epoch=195.0] | Loss=0.00592 | Reg=0.00088 | acc=1.0000 | L2-Norm=9.360 | L2-Norm(final)=12.076 | 4901.9 samples/s | 76.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step40000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=54001 Epoch=263.5] | Loss=0.01843 | Reg=0.00084 | acc=0.9844 | L2-Norm=9.180 | L2-Norm(final)=13.775 | 4083.5 samples/s | 63.8 steps/s
[Step=54050 Epoch=263.7] | Loss=0.02220 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.185 | L2-Norm(final)=13.773 | 5049.9 samples/s | 78.9 steps/s
[Step=54100 Epoch=264.0] | Loss=0.02104 | Reg=0.00084 | acc=0.9688 | L2-Norm=9.188 | L2-Norm(final)=13.772 | 5574.3 samples/s | 87.1 steps/s
[Step=54150 Epoch=264.2] | Loss=0.02112 | Reg=0.00084 | acc=0.9688 | L2-Norm=9.192 | L2-Norm(final)=13.773 | 5571.4 samples/s | 87.1 steps/s
[Step=54200 Epoch=264.5] | Loss=0.02019 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.195 | L2-Norm(final)=13.773 | 7562.2 samples/s | 118.2 steps/s
[Step=54250 Epoch=264.7] | Loss=0.01944 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.198 | L2-Norm(final)=13.774 | 1930.4 samples/s | 30.2 steps/s
[Step=54300 Epoch=265.0] | Loss=0.01863 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.202 | L2-Norm(final)=13.775 | 5561.8 samples/s | 86.9 steps/s
[Step=54350 Epoch=265.2] | Loss=0.01881 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.205 | L2-Norm(final)=13.777 | 5504.1 samples/s | 86.0 steps/s
[Step=54400 Epoch=265.4] | Loss=0.01825 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.208 | L2-Norm(final)=13.779 | 7259.6 samples/s | 113.4 steps/s
[Step=54450 Epoch=265.7] | Loss=0.01772 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.211 | L2-Norm(final)=13.781 | 1960.6 samples/s | 30.6 steps/s
[Step=54500 Epoch=265.9] | Loss=0.01726 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.214 | L2-Norm(final)=13.783 | 5487.9 samples/s | 85.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=54501 Epoch=265.9] | Loss=0.01701 | Reg=0.00085 | acc=0.9688 | L2-Norm=9.244 | L2-Norm(final)=13.804 | 3823.0 samples/s | 59.7 steps/s
[Step=54550 Epoch=266.2] | Loss=0.01713 | Reg=0.00086 | acc=0.9688 | L2-Norm=9.250 | L2-Norm(final)=13.806 | 4756.3 samples/s | 74.3 steps/s
[Step=54600 Epoch=266.4] | Loss=0.01520 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.255 | L2-Norm(final)=13.809 | 4933.5 samples/s | 77.1 steps/s
[Step=54650 Epoch=266.7] | Loss=0.01418 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.260 | L2-Norm(final)=13.812 | 4942.5 samples/s | 77.2 steps/s
[Step=54700 Epoch=266.9] | Loss=0.01284 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.265 | L2-Norm(final)=13.814 | 6607.5 samples/s | 103.2 steps/s
[Step=54750 Epoch=267.2] | Loss=0.01192 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.269 | L2-Norm(final)=13.817 | 1860.8 samples/s | 29.1 steps/s
[Step=54800 Epoch=267.4] | Loss=0.01081 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.273 | L2-Norm(final)=13.820 | 4880.3 samples/s | 76.3 steps/s
[Step=54850 Epoch=267.6] | Loss=0.01020 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.277 | L2-Norm(final)=13.823 | 4968.2 samples/s | 77.6 steps/s
[Step=54900 Epoch=267.9] | Loss=0.00963 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.280 | L2-Norm(final)=13.825 | 6183.6 samples/s | 96.6 steps/s
[Step=54950 Epoch=268.1] | Loss=0.00902 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=13.828 | 1897.4 samples/s | 29.6 steps/s
[Step=55000 Epoch=268.4] | Loss=0.00854 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.287 | L2-Norm(final)=13.831 | 4965.2 samples/s | 77.6 steps/s
[Step=55050 Epoch=268.6] | Loss=0.00817 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.290 | L2-Norm(final)=13.833 | 4967.9 samples/s | 77.6 steps/s
[Step=55100 Epoch=268.9] | Loss=0.00791 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.294 | L2-Norm(final)=13.836 | 5808.3 samples/s | 90.8 steps/s
[Step=55150 Epoch=269.1] | Loss=0.00761 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.296 | L2-Norm(final)=13.838 | 1936.6 samples/s | 30.3 steps/s
[Step=55200 Epoch=269.4] | Loss=0.00725 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=13.840 | 4849.6 samples/s | 75.8 steps/s
[Step=55250 Epoch=269.6] | Loss=0.00707 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.302 | L2-Norm(final)=13.843 | 4859.0 samples/s | 75.9 steps/s
[Step=55300 Epoch=269.8] | Loss=0.00695 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.305 | L2-Norm(final)=13.845 | 5523.2 samples/s | 86.3 steps/s
[Step=55350 Epoch=270.1] | Loss=0.00682 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.308 | L2-Norm(final)=13.847 | 1963.8 samples/s | 30.7 steps/s
[Step=55400 Epoch=270.3] | Loss=0.00663 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.310 | L2-Norm(final)=13.850 | 4907.4 samples/s | 76.7 steps/s
[Step=55450 Epoch=270.6] | Loss=0.00648 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.313 | L2-Norm(final)=13.852 | 4915.4 samples/s | 76.8 steps/s
[Step=55500 Epoch=270.8] | Loss=0.00631 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.315 | L2-Norm(final)=13.854 | 5229.4 samples/s | 81.7 steps/s
[Step=55550 Epoch=271.1] | Loss=0.00617 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.318 | L2-Norm(final)=13.856 | 2002.2 samples/s | 31.3 steps/s
[Step=55600 Epoch=271.3] | Loss=0.00600 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.320 | L2-Norm(final)=13.858 | 4945.9 samples/s | 77.3 steps/s
[Step=55650 Epoch=271.5] | Loss=0.00590 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.322 | L2-Norm(final)=13.860 | 4948.9 samples/s | 77.3 steps/s
[Step=55700 Epoch=271.8] | Loss=0.00578 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.325 | L2-Norm(final)=13.862 | 5012.7 samples/s | 78.3 steps/s
[Step=55750 Epoch=272.0] | Loss=0.00578 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.327 | L2-Norm(final)=13.864 | 2035.0 samples/s | 31.8 steps/s
[Step=55800 Epoch=272.3] | Loss=0.00565 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.329 | L2-Norm(final)=13.866 | 4930.7 samples/s | 77.0 steps/s
[Step=55850 Epoch=272.5] | Loss=0.00555 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=13.868 | 4960.0 samples/s | 77.5 steps/s
[Step=55900 Epoch=272.8] | Loss=0.00548 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.333 | L2-Norm(final)=13.870 | 4946.5 samples/s | 77.3 steps/s
[Step=55950 Epoch=273.0] | Loss=0.00540 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.335 | L2-Norm(final)=13.872 | 2028.1 samples/s | 31.7 steps/s
[Step=56000 Epoch=273.3] | Loss=0.00529 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.337 | L2-Norm(final)=13.874 | 4963.9 samples/s | 77.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step56000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=46001 Epoch=224.3] | Loss=0.01271 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.180 | L2-Norm(final)=13.428 | 3814.2 samples/s | 59.6 steps/s
[Step=46050 Epoch=224.6] | Loss=0.02733 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.184 | L2-Norm(final)=13.426 | 5305.6 samples/s | 82.9 steps/s
[Step=46100 Epoch=224.8] | Loss=0.02604 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.188 | L2-Norm(final)=13.424 | 5492.6 samples/s | 85.8 steps/s
[Step=46150 Epoch=225.1] | Loss=0.02492 | Reg=0.00084 | acc=0.9844 | L2-Norm=9.191 | L2-Norm(final)=13.425 | 5597.6 samples/s | 87.5 steps/s
[Step=46200 Epoch=225.3] | Loss=0.02468 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.195 | L2-Norm(final)=13.425 | 7663.1 samples/s | 119.7 steps/s
[Step=46250 Epoch=225.5] | Loss=0.02390 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.198 | L2-Norm(final)=13.427 | 1919.6 samples/s | 30.0 steps/s
[Step=46300 Epoch=225.8] | Loss=0.02319 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.201 | L2-Norm(final)=13.428 | 5452.8 samples/s | 85.2 steps/s
[Step=46350 Epoch=226.0] | Loss=0.02233 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.205 | L2-Norm(final)=13.430 | 5479.3 samples/s | 85.6 steps/s
[Step=46400 Epoch=226.3] | Loss=0.02150 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.208 | L2-Norm(final)=13.432 | 7223.4 samples/s | 112.9 steps/s
[Step=46450 Epoch=226.5] | Loss=0.02082 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.211 | L2-Norm(final)=13.434 | 1927.2 samples/s | 30.1 steps/s
[Step=46500 Epoch=226.8] | Loss=0.02028 | Reg=0.00085 | acc=0.9531 | L2-Norm=9.214 | L2-Norm(final)=13.436 | 5481.8 samples/s | 85.7 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=226.8] | Loss=0.02889 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.245 | L2-Norm(final)=13.463 | 3942.8 samples/s | 61.6 steps/s
[Step=46550 Epoch=227.0] | Loss=0.01897 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.250 | L2-Norm(final)=13.465 | 4628.4 samples/s | 72.3 steps/s
[Step=46600 Epoch=227.2] | Loss=0.01676 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.256 | L2-Norm(final)=13.468 | 4833.6 samples/s | 75.5 steps/s
[Step=46650 Epoch=227.5] | Loss=0.01641 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.262 | L2-Norm(final)=13.470 | 4949.5 samples/s | 77.3 steps/s
[Step=46700 Epoch=227.7] | Loss=0.01467 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.267 | L2-Norm(final)=13.473 | 6695.2 samples/s | 104.6 steps/s
[Step=46750 Epoch=228.0] | Loss=0.01321 | Reg=0.00086 | acc=0.9844 | L2-Norm=9.272 | L2-Norm(final)=13.476 | 1857.5 samples/s | 29.0 steps/s
[Step=46800 Epoch=228.2] | Loss=0.01198 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.276 | L2-Norm(final)=13.479 | 4951.0 samples/s | 77.4 steps/s
[Step=46850 Epoch=228.5] | Loss=0.01129 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.280 | L2-Norm(final)=13.482 | 4854.5 samples/s | 75.9 steps/s
[Step=46900 Epoch=228.7] | Loss=0.01075 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.284 | L2-Norm(final)=13.485 | 6145.3 samples/s | 96.0 steps/s
[Step=46950 Epoch=229.0] | Loss=0.01013 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.288 | L2-Norm(final)=13.488 | 1905.6 samples/s | 29.8 steps/s
[Step=47000 Epoch=229.2] | Loss=0.00959 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.292 | L2-Norm(final)=13.490 | 4937.1 samples/s | 77.1 steps/s
[Step=47050 Epoch=229.4] | Loss=0.00925 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.295 | L2-Norm(final)=13.493 | 4951.0 samples/s | 77.4 steps/s
[Step=47100 Epoch=229.7] | Loss=0.00881 | Reg=0.00086 | acc=1.0000 | L2-Norm=9.299 | L2-Norm(final)=13.496 | 5565.5 samples/s | 87.0 steps/s
[Step=47150 Epoch=229.9] | Loss=0.00851 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.302 | L2-Norm(final)=13.498 | 1937.9 samples/s | 30.3 steps/s
[Step=47200 Epoch=230.2] | Loss=0.00822 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.305 | L2-Norm(final)=13.501 | 4923.9 samples/s | 76.9 steps/s
[Step=47250 Epoch=230.4] | Loss=0.00792 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.308 | L2-Norm(final)=13.504 | 4965.2 samples/s | 77.6 steps/s
[Step=47300 Epoch=230.7] | Loss=0.00770 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.311 | L2-Norm(final)=13.506 | 5315.7 samples/s | 83.1 steps/s
[Step=47350 Epoch=230.9] | Loss=0.00742 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.314 | L2-Norm(final)=13.509 | 1991.7 samples/s | 31.1 steps/s
[Step=47400 Epoch=231.1] | Loss=0.00725 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.317 | L2-Norm(final)=13.511 | 4876.2 samples/s | 76.2 steps/s
[Step=47450 Epoch=231.4] | Loss=0.00705 | Reg=0.00087 | acc=0.9844 | L2-Norm=9.320 | L2-Norm(final)=13.514 | 4909.2 samples/s | 76.7 steps/s
[Step=47500 Epoch=231.6] | Loss=0.00686 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.323 | L2-Norm(final)=13.516 | 4981.1 samples/s | 77.8 steps/s
[Step=47550 Epoch=231.9] | Loss=0.00670 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.326 | L2-Norm(final)=13.519 | 2049.3 samples/s | 32.0 steps/s
[Step=47600 Epoch=232.1] | Loss=0.00657 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.328 | L2-Norm(final)=13.521 | 4906.2 samples/s | 76.7 steps/s
[Step=47650 Epoch=232.4] | Loss=0.00643 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.331 | L2-Norm(final)=13.524 | 4918.7 samples/s | 76.9 steps/s
[Step=47700 Epoch=232.6] | Loss=0.00631 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.334 | L2-Norm(final)=13.526 | 4910.7 samples/s | 76.7 steps/s
[Step=47750 Epoch=232.9] | Loss=0.00620 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.336 | L2-Norm(final)=13.528 | 2032.6 samples/s | 31.8 steps/s
[Step=47800 Epoch=233.1] | Loss=0.00608 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.339 | L2-Norm(final)=13.530 | 4943.1 samples/s | 77.2 steps/s
[Step=47850 Epoch=233.3] | Loss=0.00595 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.341 | L2-Norm(final)=13.533 | 4964.6 samples/s | 77.6 steps/s
[Step=47900 Epoch=233.6] | Loss=0.00586 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.344 | L2-Norm(final)=13.535 | 4945.9 samples/s | 77.3 steps/s
[Step=47950 Epoch=233.8] | Loss=0.00577 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.346 | L2-Norm(final)=13.537 | 2027.0 samples/s | 31.7 steps/s
[Step=48000 Epoch=234.1] | Loss=0.00569 | Reg=0.00087 | acc=1.0000 | L2-Norm=9.348 | L2-Norm(final)=13.539 | 4848.1 samples/s | 75.8 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step48000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=34001 Epoch=322.2] | Loss=0.00004 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.180 | L2-Norm(final)=7.698 | 4026.4 samples/s | 62.9 steps/s
[Step=34050 Epoch=322.7] | Loss=0.00053 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.177 | L2-Norm(final)=7.700 | 4963.7 samples/s | 77.6 steps/s
[Step=34100 Epoch=323.1] | Loss=0.00035 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.180 | L2-Norm(final)=7.706 | 7383.3 samples/s | 115.4 steps/s
[Step=34150 Epoch=323.6] | Loss=0.00027 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.181 | L2-Norm(final)=7.711 | 1860.0 samples/s | 29.1 steps/s
[Step=34200 Epoch=324.1] | Loss=0.00023 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.181 | L2-Norm(final)=7.715 | 6877.0 samples/s | 107.5 steps/s
[Step=34250 Epoch=324.5] | Loss=0.00020 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.181 | L2-Norm(final)=7.719 | 1890.8 samples/s | 29.5 steps/s
[Step=34300 Epoch=325.0] | Loss=0.00018 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.180 | L2-Norm(final)=7.723 | 6251.0 samples/s | 97.7 steps/s
[Step=34350 Epoch=325.5] | Loss=0.00016 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.180 | L2-Norm(final)=7.726 | 1966.1 samples/s | 30.7 steps/s
[Step=34400 Epoch=326.0] | Loss=0.00015 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.179 | L2-Norm(final)=7.729 | 5761.8 samples/s | 90.0 steps/s
[Step=34450 Epoch=326.4] | Loss=0.00014 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.178 | L2-Norm(final)=7.733 | 2010.4 samples/s | 31.4 steps/s
[Step=34500 Epoch=326.9] | Loss=0.00013 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.176 | L2-Norm(final)=7.736 | 5240.9 samples/s | 81.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=34501 Epoch=326.9] | Loss=0.00011 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.164 | L2-Norm(final)=7.766 | 3888.3 samples/s | 60.8 steps/s
[Step=34550 Epoch=327.4] | Loss=0.00004 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.158 | L2-Norm(final)=7.769 | 4360.3 samples/s | 68.1 steps/s
[Step=34600 Epoch=327.9] | Loss=0.00003 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.149 | L2-Norm(final)=7.770 | 6351.1 samples/s | 99.2 steps/s
[Step=34650 Epoch=328.3] | Loss=0.00002 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.140 | L2-Norm(final)=7.771 | 1797.4 samples/s | 28.1 steps/s
[Step=34700 Epoch=328.8] | Loss=0.00002 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.129 | L2-Norm(final)=7.772 | 5852.5 samples/s | 91.4 steps/s
[Step=34750 Epoch=329.3] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.117 | L2-Norm(final)=7.773 | 1840.1 samples/s | 28.8 steps/s
[Step=34800 Epoch=329.8] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.105 | L2-Norm(final)=7.773 | 5446.8 samples/s | 85.1 steps/s
[Step=34850 Epoch=330.2] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.093 | L2-Norm(final)=7.773 | 1874.3 samples/s | 29.3 steps/s
[Step=34900 Epoch=330.7] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.080 | L2-Norm(final)=7.774 | 5114.1 samples/s | 79.9 steps/s
[Step=34950 Epoch=331.2] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.067 | L2-Norm(final)=7.774 | 1920.5 samples/s | 30.0 steps/s
[Step=35000 Epoch=331.7] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.054 | L2-Norm(final)=7.774 | 4806.6 samples/s | 75.1 steps/s
[Step=35050 Epoch=332.1] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.041 | L2-Norm(final)=7.774 | 1963.7 samples/s | 30.7 steps/s
[Step=35100 Epoch=332.6] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.028 | L2-Norm(final)=7.775 | 4691.9 samples/s | 73.3 steps/s
[Step=35150 Epoch=333.1] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.014 | L2-Norm(final)=7.775 | 1986.5 samples/s | 31.0 steps/s
[Step=35200 Epoch=333.6] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.000 | L2-Norm(final)=7.775 | 4806.8 samples/s | 75.1 steps/s
[Step=35250 Epoch=334.0] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.986 | L2-Norm(final)=7.775 | 2009.0 samples/s | 31.4 steps/s
[Step=35300 Epoch=334.5] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.972 | L2-Norm(final)=7.776 | 4651.3 samples/s | 72.7 steps/s
[Step=35350 Epoch=335.0] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.958 | L2-Norm(final)=7.776 | 2026.0 samples/s | 31.7 steps/s
[Step=35400 Epoch=335.4] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.943 | L2-Norm(final)=7.776 | 4443.7 samples/s | 69.4 steps/s
[Step=35450 Epoch=335.9] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.929 | L2-Norm(final)=7.776 | 6598.4 samples/s | 103.1 steps/s
[Step=35500 Epoch=336.4] | Loss=0.00001 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.914 | L2-Norm(final)=7.776 | 1786.4 samples/s | 27.9 steps/s
[Step=35550 Epoch=336.9] | Loss=0.00000 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.899 | L2-Norm(final)=7.777 | 6021.8 samples/s | 94.1 steps/s
[Step=35600 Epoch=337.3] | Loss=0.00000 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.884 | L2-Norm(final)=7.777 | 1838.0 samples/s | 28.7 steps/s
[Step=35650 Epoch=337.8] | Loss=0.00000 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.868 | L2-Norm(final)=7.777 | 5549.8 samples/s | 86.7 steps/s
[Step=35700 Epoch=338.3] | Loss=0.00000 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.853 | L2-Norm(final)=7.777 | 1862.1 samples/s | 29.1 steps/s
[Step=35750 Epoch=338.8] | Loss=0.00000 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.837 | L2-Norm(final)=7.778 | 5190.4 samples/s | 81.1 steps/s
[Step=35800 Epoch=339.2] | Loss=0.00000 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.822 | L2-Norm(final)=7.778 | 1903.6 samples/s | 29.7 steps/s
[Step=35850 Epoch=339.7] | Loss=0.00000 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.806 | L2-Norm(final)=7.778 | 4915.0 samples/s | 76.8 steps/s
[Step=35900 Epoch=340.2] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.790 | L2-Norm(final)=7.778 | 1966.9 samples/s | 30.7 steps/s
[Step=35950 Epoch=340.7] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.773 | L2-Norm(final)=7.778 | 4699.4 samples/s | 73.4 steps/s
[Step=36000 Epoch=341.1] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.757 | L2-Norm(final)=7.779 | 1984.7 samples/s | 31.0 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_0/client_state-step36000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=44001 Epoch=420.2] | Loss=0.00002 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.180 | L2-Norm(final)=8.684 | 3730.8 samples/s | 58.3 steps/s
[Step=44050 Epoch=420.7] | Loss=0.00055 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.182 | L2-Norm(final)=8.683 | 4980.2 samples/s | 77.8 steps/s
[Step=44100 Epoch=421.1] | Loss=0.00036 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.182 | L2-Norm(final)=8.687 | 7516.3 samples/s | 117.4 steps/s
[Step=44150 Epoch=421.6] | Loss=0.00027 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.182 | L2-Norm(final)=8.690 | 1816.2 samples/s | 28.4 steps/s
[Step=44200 Epoch=422.1] | Loss=0.00022 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.182 | L2-Norm(final)=8.694 | 6676.1 samples/s | 104.3 steps/s
[Step=44250 Epoch=422.6] | Loss=0.00019 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.181 | L2-Norm(final)=8.697 | 1900.3 samples/s | 29.7 steps/s
[Step=44300 Epoch=423.0] | Loss=0.00017 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.180 | L2-Norm(final)=8.699 | 6474.8 samples/s | 101.2 steps/s
[Step=44350 Epoch=423.5] | Loss=0.00015 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.179 | L2-Norm(final)=8.702 | 1913.6 samples/s | 29.9 steps/s
[Step=44400 Epoch=424.0] | Loss=0.00014 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.178 | L2-Norm(final)=8.705 | 5974.8 samples/s | 93.4 steps/s
[Step=44450 Epoch=424.5] | Loss=0.00013 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.177 | L2-Norm(final)=8.707 | 1958.6 samples/s | 30.6 steps/s
[Step=44500 Epoch=424.9] | Loss=0.00012 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.176 | L2-Norm(final)=8.709 | 5698.1 samples/s | 89.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=425.0] | Loss=0.00013 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.162 | L2-Norm(final)=8.732 | 4261.4 samples/s | 66.6 steps/s
[Step=44550 Epoch=425.4] | Loss=0.00004 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.159 | L2-Norm(final)=8.734 | 3955.3 samples/s | 61.8 steps/s
[Step=44600 Epoch=425.9] | Loss=0.00002 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.151 | L2-Norm(final)=8.735 | 6324.4 samples/s | 98.8 steps/s
[Step=44650 Epoch=426.4] | Loss=0.00002 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.140 | L2-Norm(final)=8.736 | 1778.6 samples/s | 27.8 steps/s
[Step=44700 Epoch=426.9] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.129 | L2-Norm(final)=8.737 | 5999.8 samples/s | 93.7 steps/s
[Step=44750 Epoch=427.3] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.117 | L2-Norm(final)=8.737 | 1811.4 samples/s | 28.3 steps/s
[Step=44800 Epoch=427.8] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.104 | L2-Norm(final)=8.737 | 5669.7 samples/s | 88.6 steps/s
[Step=44850 Epoch=428.3] | Loss=0.00001 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.092 | L2-Norm(final)=8.737 | 1859.0 samples/s | 29.0 steps/s
[Step=44900 Epoch=428.8] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.079 | L2-Norm(final)=8.738 | 5254.9 samples/s | 82.1 steps/s
[Step=44950 Epoch=429.2] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.066 | L2-Norm(final)=8.738 | 1905.6 samples/s | 29.8 steps/s
[Step=45000 Epoch=429.7] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.053 | L2-Norm(final)=8.738 | 5001.8 samples/s | 78.2 steps/s
[Step=45050 Epoch=430.2] | Loss=0.00001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.039 | L2-Norm(final)=8.738 | 1927.7 samples/s | 30.1 steps/s
[Step=45100 Epoch=430.7] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.026 | L2-Norm(final)=8.738 | 4819.1 samples/s | 75.3 steps/s
[Step=45150 Epoch=431.2] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.012 | L2-Norm(final)=8.739 | 1963.2 samples/s | 30.7 steps/s
[Step=45200 Epoch=431.6] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.998 | L2-Norm(final)=8.739 | 4759.3 samples/s | 74.4 steps/s
[Step=45250 Epoch=432.1] | Loss=0.00000 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.984 | L2-Norm(final)=8.739 | 1986.0 samples/s | 31.0 steps/s
[Step=45300 Epoch=432.6] | Loss=0.00000 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.970 | L2-Norm(final)=8.739 | 4799.0 samples/s | 75.0 steps/s
[Step=45350 Epoch=433.1] | Loss=0.00000 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.955 | L2-Norm(final)=8.739 | 1991.4 samples/s | 31.1 steps/s
[Step=45400 Epoch=433.5] | Loss=0.00000 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.940 | L2-Norm(final)=8.739 | 4648.1 samples/s | 72.6 steps/s
[Step=45450 Epoch=434.0] | Loss=0.00000 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.926 | L2-Norm(final)=8.740 | 1994.4 samples/s | 31.2 steps/s
[Step=45500 Epoch=434.5] | Loss=0.00000 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.911 | L2-Norm(final)=8.740 | 4683.4 samples/s | 73.2 steps/s
[Step=45550 Epoch=435.0] | Loss=0.00000 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.896 | L2-Norm(final)=8.740 | 6919.3 samples/s | 108.1 steps/s
[Step=45600 Epoch=435.5] | Loss=0.00000 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.880 | L2-Norm(final)=8.740 | 1743.8 samples/s | 27.2 steps/s
[Step=45650 Epoch=435.9] | Loss=0.00000 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.865 | L2-Norm(final)=8.740 | 6393.4 samples/s | 99.9 steps/s
[Step=45700 Epoch=436.4] | Loss=0.00000 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.849 | L2-Norm(final)=8.741 | 1784.6 samples/s | 27.9 steps/s
[Step=45750 Epoch=436.9] | Loss=0.00000 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.833 | L2-Norm(final)=8.741 | 6026.4 samples/s | 94.2 steps/s
[Step=45800 Epoch=437.4] | Loss=0.00000 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.817 | L2-Norm(final)=8.741 | 1821.1 samples/s | 28.5 steps/s
[Step=45850 Epoch=437.8] | Loss=0.00000 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.801 | L2-Norm(final)=8.741 | 5685.0 samples/s | 88.8 steps/s
[Step=45900 Epoch=438.3] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.785 | L2-Norm(final)=8.741 | 1871.0 samples/s | 29.2 steps/s
[Step=45950 Epoch=438.8] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.768 | L2-Norm(final)=8.742 | 5232.7 samples/s | 81.8 steps/s
[Step=46000 Epoch=439.3] | Loss=0.00000 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.752 | L2-Norm(final)=8.742 | 1862.1 samples/s | 29.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step46000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07422 | acc=0.9637 | tpr=0.9742 | fpr=0.0592 | 4386.6 samples/s | 17.1 steps/s
Avg test loss: 0.07685, Avg test acc: 0.96170, Avg tpr: 0.97290, Avg fpr: 0.06294, total FA: 491

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08225 | acc=0.9624 | tpr=0.9757 | fpr=0.0664 | 4164.8 samples/s | 16.3 steps/s
Avg test loss: 0.08538, Avg test acc: 0.96121, Avg tpr: 0.97435, Avg fpr: 0.06768, total FA: 528

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08155 | acc=0.9609 | tpr=0.9696 | fpr=0.0580 | 4396.7 samples/s | 17.2 steps/s
Avg test loss: 0.08588, Avg test acc: 0.95977, Avg tpr: 0.96765, Avg fpr: 0.05756, total FA: 449

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.07593 | acc=0.9613 | tpr=0.9702 | fpr=0.0582 | 4513.9 samples/s | 17.6 steps/s
Avg test loss: 0.07964, Avg test acc: 0.96081, Avg tpr: 0.96963, Avg fpr: 0.05858, total FA: 457

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08155 | acc=0.9628 | tpr=0.9752 | fpr=0.0642 | 4361.3 samples/s | 17.0 steps/s
Avg test loss: 0.08931, Avg test acc: 0.96158, Avg tpr: 0.97377, Avg fpr: 0.06525, total FA: 509

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.19821 | acc=0.3012 | tpr=0.0024 | fpr=0.0500 | 4391.5 samples/s | 17.2 steps/s
Avg test loss: 5.21339, Avg test acc: 0.29726, Avg tpr: 0.00239, Avg fpr: 0.05422, total FA: 423

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.78632 | acc=0.3139 | tpr=0.0047 | fpr=0.0146 | 4365.3 samples/s | 17.1 steps/s
Avg test loss: 4.79658, Avg test acc: 0.31116, Avg tpr: 0.00507, Avg fpr: 0.01564, total FA: 122

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.99118 | acc=0.3049 | tpr=0.0039 | fpr=0.0414 | 4389.8 samples/s | 17.1 steps/s
Avg test loss: 4.99956, Avg test acc: 0.30251, Avg tpr: 0.00501, Avg fpr: 0.04320, total FA: 337

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.23768 | acc=0.3047 | tpr=0.0030 | fpr=0.0401 | 4381.3 samples/s | 17.1 steps/s
Avg test loss: 5.25293, Avg test acc: 0.30175, Avg tpr: 0.00356, Avg fpr: 0.04243, total FA: 331

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.83881 | acc=0.3131 | tpr=0.0032 | fpr=0.0139 | 4375.2 samples/s | 17.1 steps/s
Avg test loss: 4.84816, Avg test acc: 0.31060, Avg tpr: 0.00367, Avg fpr: 0.01436, total FA: 112

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.77477 | acc=0.1234 | tpr=0.8053 | fpr=0.8889 | 4319.6 samples/s | 16.9 steps/s
[Step= 100] | Loss=4.72608 | acc=0.1265 | tpr=0.7996 | fpr=0.8861 | 5136.5 samples/s | 20.1 steps/s
[Step= 150] | Loss=4.72588 | acc=0.1257 | tpr=0.8184 | fpr=0.8871 | 8508.1 samples/s | 33.2 steps/s
[Step= 200] | Loss=4.72536 | acc=0.1246 | tpr=0.8164 | fpr=0.8880 | 8439.9 samples/s | 33.0 steps/s
[Step= 250] | Loss=4.72913 | acc=0.1256 | tpr=0.8175 | fpr=0.8870 | 8697.4 samples/s | 34.0 steps/s
[Step= 300] | Loss=4.72387 | acc=0.1252 | tpr=0.8109 | fpr=0.8873 | 8498.8 samples/s | 33.2 steps/s
[Step= 350] | Loss=4.72074 | acc=0.1248 | tpr=0.8103 | fpr=0.8877 | 8655.7 samples/s | 33.8 steps/s
[Step= 400] | Loss=4.72230 | acc=0.1251 | tpr=0.8058 | fpr=0.8872 | 8488.3 samples/s | 33.2 steps/s
[Step= 450] | Loss=4.72507 | acc=0.1248 | tpr=0.7999 | fpr=0.8875 | 8751.4 samples/s | 34.2 steps/s
[Step= 500] | Loss=4.72712 | acc=0.1246 | tpr=0.8035 | fpr=0.8876 | 8743.2 samples/s | 34.2 steps/s
[Step= 550] | Loss=4.72591 | acc=0.1245 | tpr=0.8066 | fpr=0.8879 | 14379.2 samples/s | 56.2 steps/s
Avg test loss: 4.72753, Avg test acc: 0.12444, Avg tpr: 0.80586, Avg fpr: 0.88795, total FA: 123290

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.86050 | acc=0.1288 | tpr=0.8451 | fpr=0.8840 | 4386.4 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.80834 | acc=0.1317 | tpr=0.8252 | fpr=0.8812 | 5007.2 samples/s | 19.6 steps/s
[Step= 150] | Loss=4.80995 | acc=0.1308 | tpr=0.8429 | fpr=0.8823 | 8543.7 samples/s | 33.4 steps/s
[Step= 200] | Loss=4.81029 | acc=0.1304 | tpr=0.8426 | fpr=0.8826 | 8942.7 samples/s | 34.9 steps/s
[Step= 250] | Loss=4.81154 | acc=0.1309 | tpr=0.8410 | fpr=0.8820 | 8337.9 samples/s | 32.6 steps/s
[Step= 300] | Loss=4.80720 | acc=0.1306 | tpr=0.8378 | fpr=0.8823 | 8679.6 samples/s | 33.9 steps/s
[Step= 350] | Loss=4.80296 | acc=0.1304 | tpr=0.8328 | fpr=0.8824 | 8618.8 samples/s | 33.7 steps/s
[Step= 400] | Loss=4.80471 | acc=0.1304 | tpr=0.8277 | fpr=0.8823 | 8442.7 samples/s | 33.0 steps/s
[Step= 450] | Loss=4.80993 | acc=0.1301 | tpr=0.8238 | fpr=0.8825 | 8624.7 samples/s | 33.7 steps/s
[Step= 500] | Loss=4.81455 | acc=0.1298 | tpr=0.8247 | fpr=0.8827 | 8343.0 samples/s | 32.6 steps/s
[Step= 550] | Loss=4.81247 | acc=0.1299 | tpr=0.8277 | fpr=0.8828 | 16241.3 samples/s | 63.4 steps/s
Avg test loss: 4.81381, Avg test acc: 0.12979, Avg tpr: 0.82686, Avg fpr: 0.88288, total FA: 122586

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.40472 | acc=0.1225 | tpr=0.7876 | fpr=0.8895 | 3608.0 samples/s | 14.1 steps/s
[Step= 100] | Loss=5.35272 | acc=0.1249 | tpr=0.7783 | fpr=0.8873 | 6800.0 samples/s | 26.6 steps/s
[Step= 150] | Loss=5.35484 | acc=0.1228 | tpr=0.7997 | fpr=0.8897 | 8157.0 samples/s | 31.9 steps/s
[Step= 200] | Loss=5.35525 | acc=0.1218 | tpr=0.8055 | fpr=0.8906 | 9017.3 samples/s | 35.2 steps/s
[Step= 250] | Loss=5.35630 | acc=0.1225 | tpr=0.8035 | fpr=0.8899 | 8490.1 samples/s | 33.2 steps/s
[Step= 300] | Loss=5.35174 | acc=0.1222 | tpr=0.8015 | fpr=0.8902 | 8517.9 samples/s | 33.3 steps/s
[Step= 350] | Loss=5.34985 | acc=0.1220 | tpr=0.8009 | fpr=0.8903 | 8483.9 samples/s | 33.1 steps/s
[Step= 400] | Loss=5.35283 | acc=0.1222 | tpr=0.7992 | fpr=0.8901 | 8641.1 samples/s | 33.8 steps/s
[Step= 450] | Loss=5.35708 | acc=0.1217 | tpr=0.7941 | fpr=0.8905 | 8750.8 samples/s | 34.2 steps/s
[Step= 500] | Loss=5.35805 | acc=0.1217 | tpr=0.7956 | fpr=0.8904 | 8609.5 samples/s | 33.6 steps/s
[Step= 550] | Loss=5.35686 | acc=0.1216 | tpr=0.8002 | fpr=0.8908 | 14369.7 samples/s | 56.1 steps/s
Avg test loss: 5.35801, Avg test acc: 0.12150, Avg tpr: 0.79992, Avg fpr: 0.89083, total FA: 123690

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.52955 | acc=0.1414 | tpr=0.7743 | fpr=0.8700 | 3193.6 samples/s | 12.5 steps/s
[Step= 100] | Loss=4.47960 | acc=0.1441 | tpr=0.7633 | fpr=0.8674 | 8576.2 samples/s | 33.5 steps/s
[Step= 150] | Loss=4.47666 | acc=0.1429 | tpr=0.7767 | fpr=0.8687 | 8951.8 samples/s | 35.0 steps/s
[Step= 200] | Loss=4.47407 | acc=0.1426 | tpr=0.7749 | fpr=0.8689 | 8608.9 samples/s | 33.6 steps/s
[Step= 250] | Loss=4.47631 | acc=0.1433 | tpr=0.7755 | fpr=0.8682 | 8444.1 samples/s | 33.0 steps/s
[Step= 300] | Loss=4.47179 | acc=0.1425 | tpr=0.7716 | fpr=0.8689 | 8528.8 samples/s | 33.3 steps/s
[Step= 350] | Loss=4.46776 | acc=0.1422 | tpr=0.7702 | fpr=0.8692 | 8582.7 samples/s | 33.5 steps/s
[Step= 400] | Loss=4.47146 | acc=0.1420 | tpr=0.7653 | fpr=0.8693 | 8584.7 samples/s | 33.5 steps/s
[Step= 450] | Loss=4.47630 | acc=0.1417 | tpr=0.7614 | fpr=0.8695 | 8778.4 samples/s | 34.3 steps/s
[Step= 500] | Loss=4.47859 | acc=0.1415 | tpr=0.7639 | fpr=0.8697 | 8364.8 samples/s | 32.7 steps/s
[Step= 550] | Loss=4.47680 | acc=0.1412 | tpr=0.7692 | fpr=0.8702 | 15603.7 samples/s | 61.0 steps/s
Avg test loss: 4.47846, Avg test acc: 0.14116, Avg tpr: 0.76862, Avg fpr: 0.87025, total FA: 120832

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.27558 | acc=0.1270 | tpr=0.7345 | fpr=0.8840 | 3195.0 samples/s | 12.5 steps/s
[Step= 100] | Loss=5.22285 | acc=0.1293 | tpr=0.7122 | fpr=0.8816 | 8657.6 samples/s | 33.8 steps/s
[Step= 150] | Loss=5.22306 | acc=0.1277 | tpr=0.7104 | fpr=0.8831 | 8941.7 samples/s | 34.9 steps/s
[Step= 200] | Loss=5.22146 | acc=0.1272 | tpr=0.7093 | fpr=0.8834 | 8377.9 samples/s | 32.7 steps/s
[Step= 250] | Loss=5.22502 | acc=0.1280 | tpr=0.7092 | fpr=0.8826 | 8634.8 samples/s | 33.7 steps/s
[Step= 300] | Loss=5.21962 | acc=0.1274 | tpr=0.7120 | fpr=0.8832 | 8488.4 samples/s | 33.2 steps/s
[Step= 350] | Loss=5.21644 | acc=0.1267 | tpr=0.7101 | fpr=0.8838 | 8589.3 samples/s | 33.6 steps/s
[Step= 400] | Loss=5.21986 | acc=0.1270 | tpr=0.7084 | fpr=0.8836 | 8508.1 samples/s | 33.2 steps/s
[Step= 450] | Loss=5.22360 | acc=0.1264 | tpr=0.7020 | fpr=0.8841 | 8656.5 samples/s | 33.8 steps/s
[Step= 500] | Loss=5.22615 | acc=0.1261 | tpr=0.6982 | fpr=0.8842 | 8494.4 samples/s | 33.2 steps/s
[Step= 550] | Loss=5.22496 | acc=0.1259 | tpr=0.6968 | fpr=0.8845 | 15910.1 samples/s | 62.1 steps/s
Avg test loss: 5.22706, Avg test acc: 0.12580, Avg tpr: 0.69651, Avg fpr: 0.88457, total FA: 122821

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09641 | acc=0.9817 | tpr=0.9469 | fpr=0.0177 | 3217.2 samples/s | 12.6 steps/s
[Step= 100] | Loss=0.10014 | acc=0.9811 | tpr=0.9574 | fpr=0.0184 | 8248.5 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.10389 | acc=0.9803 | tpr=0.9539 | fpr=0.0192 | 8856.3 samples/s | 34.6 steps/s
[Step= 200] | Loss=0.10594 | acc=0.9803 | tpr=0.9596 | fpr=0.0193 | 8844.7 samples/s | 34.5 steps/s
[Step= 250] | Loss=0.10555 | acc=0.9803 | tpr=0.9546 | fpr=0.0193 | 8293.0 samples/s | 32.4 steps/s
[Step= 300] | Loss=0.10768 | acc=0.9799 | tpr=0.9535 | fpr=0.0196 | 8675.9 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.10761 | acc=0.9798 | tpr=0.9530 | fpr=0.0197 | 8744.4 samples/s | 34.2 steps/s
[Step= 400] | Loss=0.10862 | acc=0.9797 | tpr=0.9502 | fpr=0.0198 | 8487.4 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.11124 | acc=0.9794 | tpr=0.9484 | fpr=0.0201 | 8501.1 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.11102 | acc=0.9794 | tpr=0.9498 | fpr=0.0201 | 8433.6 samples/s | 32.9 steps/s
[Step= 550] | Loss=0.11010 | acc=0.9796 | tpr=0.9499 | fpr=0.0199 | 15725.5 samples/s | 61.4 steps/s
Avg test loss: 0.10994, Avg test acc: 0.97959, Avg tpr: 0.95008, Avg fpr: 0.01987, total FA: 2759

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.11048 | acc=0.9812 | tpr=0.9248 | fpr=0.0177 | 3197.3 samples/s | 12.5 steps/s
[Step= 100] | Loss=0.11470 | acc=0.9813 | tpr=0.9382 | fpr=0.0179 | 8670.7 samples/s | 33.9 steps/s
[Step= 150] | Loss=0.11929 | acc=0.9802 | tpr=0.9308 | fpr=0.0189 | 8683.9 samples/s | 33.9 steps/s
[Step= 200] | Loss=0.12099 | acc=0.9803 | tpr=0.9355 | fpr=0.0189 | 8735.2 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.12014 | acc=0.9802 | tpr=0.9336 | fpr=0.0190 | 8430.1 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.12253 | acc=0.9797 | tpr=0.9353 | fpr=0.0194 | 8542.0 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.12282 | acc=0.9795 | tpr=0.9368 | fpr=0.0197 | 8789.5 samples/s | 34.3 steps/s
[Step= 400] | Loss=0.12384 | acc=0.9794 | tpr=0.9338 | fpr=0.0198 | 8398.2 samples/s | 32.8 steps/s
[Step= 450] | Loss=0.12690 | acc=0.9791 | tpr=0.9323 | fpr=0.0200 | 8803.7 samples/s | 34.4 steps/s
[Step= 500] | Loss=0.12645 | acc=0.9792 | tpr=0.9339 | fpr=0.0200 | 8309.8 samples/s | 32.5 steps/s
[Step= 550] | Loss=0.12558 | acc=0.9793 | tpr=0.9327 | fpr=0.0199 | 15788.8 samples/s | 61.7 steps/s
Avg test loss: 0.12535, Avg test acc: 0.97927, Avg tpr: 0.93265, Avg fpr: 0.01988, total FA: 2760

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.09846 | acc=0.9798 | tpr=0.9381 | fpr=0.0194 | 4384.7 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.10241 | acc=0.9795 | tpr=0.9574 | fpr=0.0201 | 8828.1 samples/s | 34.5 steps/s
[Step= 150] | Loss=0.10597 | acc=0.9784 | tpr=0.9539 | fpr=0.0211 | 8375.1 samples/s | 32.7 steps/s
[Step= 200] | Loss=0.10770 | acc=0.9785 | tpr=0.9574 | fpr=0.0211 | 8636.2 samples/s | 33.7 steps/s
[Step= 250] | Loss=0.10733 | acc=0.9786 | tpr=0.9555 | fpr=0.0210 | 8604.2 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.10951 | acc=0.9782 | tpr=0.9556 | fpr=0.0214 | 8630.5 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.10954 | acc=0.9780 | tpr=0.9562 | fpr=0.0216 | 8490.9 samples/s | 33.2 steps/s
[Step= 400] | Loss=0.11071 | acc=0.9778 | tpr=0.9546 | fpr=0.0218 | 8760.3 samples/s | 34.2 steps/s
[Step= 450] | Loss=0.11318 | acc=0.9777 | tpr=0.9542 | fpr=0.0219 | 8739.3 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.11275 | acc=0.9777 | tpr=0.9559 | fpr=0.0220 | 8389.3 samples/s | 32.8 steps/s
[Step= 550] | Loss=0.11174 | acc=0.9778 | tpr=0.9554 | fpr=0.0218 | 15712.0 samples/s | 61.4 steps/s
Avg test loss: 0.11156, Avg test acc: 0.97786, Avg tpr: 0.95563, Avg fpr: 0.02174, total FA: 3018

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10260 | acc=0.9815 | tpr=0.9248 | fpr=0.0175 | 4397.5 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.10711 | acc=0.9809 | tpr=0.9424 | fpr=0.0184 | 8651.7 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.11125 | acc=0.9802 | tpr=0.9438 | fpr=0.0191 | 8456.7 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.11355 | acc=0.9802 | tpr=0.9519 | fpr=0.0193 | 8730.4 samples/s | 34.1 steps/s
[Step= 250] | Loss=0.11248 | acc=0.9802 | tpr=0.9476 | fpr=0.0192 | 8687.6 samples/s | 33.9 steps/s
[Step= 300] | Loss=0.11420 | acc=0.9800 | tpr=0.9484 | fpr=0.0195 | 8550.4 samples/s | 33.4 steps/s
[Step= 350] | Loss=0.11438 | acc=0.9799 | tpr=0.9512 | fpr=0.0196 | 9032.6 samples/s | 35.3 steps/s
[Step= 400] | Loss=0.11508 | acc=0.9797 | tpr=0.9486 | fpr=0.0197 | 8273.6 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.11789 | acc=0.9795 | tpr=0.9479 | fpr=0.0200 | 8748.2 samples/s | 34.2 steps/s
[Step= 500] | Loss=0.11745 | acc=0.9795 | tpr=0.9489 | fpr=0.0199 | 8511.4 samples/s | 33.2 steps/s
[Step= 550] | Loss=0.11658 | acc=0.9797 | tpr=0.9471 | fpr=0.0197 | 15414.6 samples/s | 60.2 steps/s
Avg test loss: 0.11640, Avg test acc: 0.97969, Avg tpr: 0.94691, Avg fpr: 0.01971, total FA: 2737

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12517 | acc=0.9797 | tpr=0.9292 | fpr=0.0194 | 4375.6 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.13011 | acc=0.9794 | tpr=0.9531 | fpr=0.0201 | 8656.6 samples/s | 33.8 steps/s
[Step= 150] | Loss=0.13524 | acc=0.9783 | tpr=0.9539 | fpr=0.0213 | 8872.5 samples/s | 34.7 steps/s
[Step= 200] | Loss=0.13743 | acc=0.9780 | tpr=0.9585 | fpr=0.0217 | 8327.4 samples/s | 32.5 steps/s
[Step= 250] | Loss=0.13629 | acc=0.9781 | tpr=0.9537 | fpr=0.0214 | 8557.1 samples/s | 33.4 steps/s
[Step= 300] | Loss=0.13900 | acc=0.9778 | tpr=0.9549 | fpr=0.0217 | 8727.9 samples/s | 34.1 steps/s
[Step= 350] | Loss=0.13963 | acc=0.9776 | tpr=0.9568 | fpr=0.0220 | 8515.0 samples/s | 33.3 steps/s
[Step= 400] | Loss=0.14066 | acc=0.9774 | tpr=0.9530 | fpr=0.0221 | 8677.4 samples/s | 33.9 steps/s
[Step= 450] | Loss=0.14385 | acc=0.9771 | tpr=0.9523 | fpr=0.0225 | 8642.0 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.14328 | acc=0.9771 | tpr=0.9529 | fpr=0.0224 | 8471.8 samples/s | 33.1 steps/s
[Step= 550] | Loss=0.14241 | acc=0.9773 | tpr=0.9515 | fpr=0.0223 | 15776.0 samples/s | 61.6 steps/s
Avg test loss: 0.14217, Avg test acc: 0.97726, Avg tpr: 0.95127, Avg fpr: 0.02227, total FA: 3092

server round 46/50

clients selected: [0 1 3 6 8]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=40001 Epoch=195.1] | Loss=0.00732 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.038 | L2-Norm(final)=12.151 | 4113.1 samples/s | 64.3 steps/s
[Step=40050 Epoch=195.3] | Loss=0.01996 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.043 | L2-Norm(final)=12.151 | 4957.9 samples/s | 77.5 steps/s
[Step=40100 Epoch=195.5] | Loss=0.02127 | Reg=0.00082 | acc=0.9688 | L2-Norm=9.047 | L2-Norm(final)=12.153 | 5421.9 samples/s | 84.7 steps/s
[Step=40150 Epoch=195.8] | Loss=0.02210 | Reg=0.00082 | acc=0.9688 | L2-Norm=9.051 | L2-Norm(final)=12.155 | 5519.0 samples/s | 86.2 steps/s
[Step=40200 Epoch=196.0] | Loss=0.02211 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.054 | L2-Norm(final)=12.156 | 7750.1 samples/s | 121.1 steps/s
[Step=40250 Epoch=196.3] | Loss=0.02113 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.057 | L2-Norm(final)=12.158 | 1911.2 samples/s | 29.9 steps/s
[Step=40300 Epoch=196.5] | Loss=0.02067 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.060 | L2-Norm(final)=12.160 | 5488.4 samples/s | 85.8 steps/s
[Step=40350 Epoch=196.8] | Loss=0.02037 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.063 | L2-Norm(final)=12.163 | 5489.1 samples/s | 85.8 steps/s
[Step=40400 Epoch=197.0] | Loss=0.01996 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.066 | L2-Norm(final)=12.165 | 7117.5 samples/s | 111.2 steps/s
[Step=40450 Epoch=197.2] | Loss=0.01957 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.069 | L2-Norm(final)=12.168 | 1972.3 samples/s | 30.8 steps/s
[Step=40500 Epoch=197.5] | Loss=0.01919 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.072 | L2-Norm(final)=12.170 | 5432.4 samples/s | 84.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=40501 Epoch=197.5] | Loss=0.01895 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.100 | L2-Norm(final)=12.199 | 3986.7 samples/s | 62.3 steps/s
[Step=40550 Epoch=197.7] | Loss=0.01836 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.106 | L2-Norm(final)=12.202 | 4648.2 samples/s | 72.6 steps/s
[Step=40600 Epoch=198.0] | Loss=0.01633 | Reg=0.00083 | acc=0.9844 | L2-Norm=9.112 | L2-Norm(final)=12.205 | 4844.7 samples/s | 75.7 steps/s
[Step=40650 Epoch=198.2] | Loss=0.01582 | Reg=0.00083 | acc=0.9844 | L2-Norm=9.117 | L2-Norm(final)=12.208 | 4912.5 samples/s | 76.8 steps/s
[Step=40700 Epoch=198.5] | Loss=0.01493 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.122 | L2-Norm(final)=12.212 | 6588.6 samples/s | 102.9 steps/s
[Step=40750 Epoch=198.7] | Loss=0.01333 | Reg=0.00083 | acc=0.9844 | L2-Norm=9.127 | L2-Norm(final)=12.215 | 1869.8 samples/s | 29.2 steps/s
[Step=40800 Epoch=198.9] | Loss=0.01248 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.132 | L2-Norm(final)=12.219 | 4905.1 samples/s | 76.6 steps/s
[Step=40850 Epoch=199.2] | Loss=0.01149 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.137 | L2-Norm(final)=12.223 | 4968.2 samples/s | 77.6 steps/s
[Step=40900 Epoch=199.4] | Loss=0.01110 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.141 | L2-Norm(final)=12.226 | 6051.8 samples/s | 94.6 steps/s
[Step=40950 Epoch=199.7] | Loss=0.01067 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.146 | L2-Norm(final)=12.229 | 1904.9 samples/s | 29.8 steps/s
[Step=41000 Epoch=199.9] | Loss=0.01023 | Reg=0.00084 | acc=0.9688 | L2-Norm=9.150 | L2-Norm(final)=12.233 | 4830.4 samples/s | 75.5 steps/s
[Step=41050 Epoch=200.2] | Loss=0.00971 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.154 | L2-Norm(final)=12.236 | 4828.2 samples/s | 75.4 steps/s
[Step=41100 Epoch=200.4] | Loss=0.00932 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.158 | L2-Norm(final)=12.239 | 5666.2 samples/s | 88.5 steps/s
[Step=41150 Epoch=200.7] | Loss=0.00897 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.162 | L2-Norm(final)=12.242 | 1936.7 samples/s | 30.3 steps/s
[Step=41200 Epoch=200.9] | Loss=0.00875 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.166 | L2-Norm(final)=12.245 | 4918.9 samples/s | 76.9 steps/s
[Step=41250 Epoch=201.1] | Loss=0.00847 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.169 | L2-Norm(final)=12.248 | 4914.4 samples/s | 76.8 steps/s
[Step=41300 Epoch=201.4] | Loss=0.00822 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.173 | L2-Norm(final)=12.251 | 5369.1 samples/s | 83.9 steps/s
[Step=41350 Epoch=201.6] | Loss=0.00800 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.176 | L2-Norm(final)=12.254 | 1989.7 samples/s | 31.1 steps/s
[Step=41400 Epoch=201.9] | Loss=0.00781 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.180 | L2-Norm(final)=12.257 | 4959.3 samples/s | 77.5 steps/s
[Step=41450 Epoch=202.1] | Loss=0.00759 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.183 | L2-Norm(final)=12.260 | 4867.6 samples/s | 76.1 steps/s
[Step=41500 Epoch=202.4] | Loss=0.00751 | Reg=0.00084 | acc=0.9844 | L2-Norm=9.186 | L2-Norm(final)=12.263 | 4953.8 samples/s | 77.4 steps/s
[Step=41550 Epoch=202.6] | Loss=0.00736 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.189 | L2-Norm(final)=12.266 | 2027.7 samples/s | 31.7 steps/s
[Step=41600 Epoch=202.8] | Loss=0.00719 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.192 | L2-Norm(final)=12.268 | 4967.5 samples/s | 77.6 steps/s
[Step=41650 Epoch=203.1] | Loss=0.00705 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.196 | L2-Norm(final)=12.271 | 4917.4 samples/s | 76.8 steps/s
[Step=41700 Epoch=203.3] | Loss=0.00689 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.199 | L2-Norm(final)=12.274 | 4828.9 samples/s | 75.5 steps/s
[Step=41750 Epoch=203.6] | Loss=0.00681 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.201 | L2-Norm(final)=12.276 | 2023.8 samples/s | 31.6 steps/s
[Step=41800 Epoch=203.8] | Loss=0.00666 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.204 | L2-Norm(final)=12.279 | 5053.9 samples/s | 79.0 steps/s
[Step=41850 Epoch=204.1] | Loss=0.00655 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.207 | L2-Norm(final)=12.282 | 4898.4 samples/s | 76.5 steps/s
[Step=41900 Epoch=204.3] | Loss=0.00646 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.210 | L2-Norm(final)=12.284 | 4920.3 samples/s | 76.9 steps/s
[Step=41950 Epoch=204.6] | Loss=0.00637 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.213 | L2-Norm(final)=12.287 | 2053.8 samples/s | 32.1 steps/s
[Step=42000 Epoch=204.8] | Loss=0.00628 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.216 | L2-Norm(final)=12.289 | 4908.4 samples/s | 76.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step42000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=56001 Epoch=273.3] | Loss=0.01569 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.038 | L2-Norm(final)=13.931 | 3911.0 samples/s | 61.1 steps/s
[Step=56050 Epoch=273.5] | Loss=0.02771 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.041 | L2-Norm(final)=13.928 | 5300.4 samples/s | 82.8 steps/s
[Step=56100 Epoch=273.7] | Loss=0.02509 | Reg=0.00082 | acc=0.9688 | L2-Norm=9.044 | L2-Norm(final)=13.927 | 5275.9 samples/s | 82.4 steps/s
[Step=56150 Epoch=274.0] | Loss=0.02249 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.048 | L2-Norm(final)=13.928 | 5530.2 samples/s | 86.4 steps/s
[Step=56200 Epoch=274.2] | Loss=0.02126 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.051 | L2-Norm(final)=13.929 | 7710.0 samples/s | 120.5 steps/s
[Step=56250 Epoch=274.5] | Loss=0.02004 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.055 | L2-Norm(final)=13.930 | 1890.9 samples/s | 29.5 steps/s
[Step=56300 Epoch=274.7] | Loss=0.02001 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.058 | L2-Norm(final)=13.932 | 5502.1 samples/s | 86.0 steps/s
[Step=56350 Epoch=275.0] | Loss=0.01959 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.061 | L2-Norm(final)=13.933 | 5304.2 samples/s | 82.9 steps/s
[Step=56400 Epoch=275.2] | Loss=0.01919 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.065 | L2-Norm(final)=13.935 | 7242.9 samples/s | 113.2 steps/s
[Step=56450 Epoch=275.4] | Loss=0.01896 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.068 | L2-Norm(final)=13.937 | 1885.8 samples/s | 29.5 steps/s
[Step=56500 Epoch=275.7] | Loss=0.01855 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.071 | L2-Norm(final)=13.939 | 5186.5 samples/s | 81.0 steps/s
All layers training...
LR=0.00006, len=1
[Step=56501 Epoch=275.7] | Loss=0.01429 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.102 | L2-Norm(final)=13.960 | 3814.8 samples/s | 59.6 steps/s
[Step=56550 Epoch=275.9] | Loss=0.01300 | Reg=0.00083 | acc=0.9844 | L2-Norm=9.107 | L2-Norm(final)=13.962 | 4508.2 samples/s | 70.4 steps/s
[Step=56600 Epoch=276.2] | Loss=0.01680 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.113 | L2-Norm(final)=13.964 | 4932.0 samples/s | 77.1 steps/s
[Step=56650 Epoch=276.4] | Loss=0.01670 | Reg=0.00083 | acc=0.9688 | L2-Norm=9.118 | L2-Norm(final)=13.966 | 4880.4 samples/s | 76.3 steps/s
[Step=56700 Epoch=276.7] | Loss=0.01542 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.123 | L2-Norm(final)=13.969 | 6643.6 samples/s | 103.8 steps/s
[Step=56750 Epoch=276.9] | Loss=0.01343 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.128 | L2-Norm(final)=13.971 | 1848.6 samples/s | 28.9 steps/s
[Step=56800 Epoch=277.2] | Loss=0.01229 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.132 | L2-Norm(final)=13.974 | 4902.1 samples/s | 76.6 steps/s
[Step=56850 Epoch=277.4] | Loss=0.01153 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.136 | L2-Norm(final)=13.977 | 4948.5 samples/s | 77.3 steps/s
[Step=56900 Epoch=277.6] | Loss=0.01084 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.140 | L2-Norm(final)=13.979 | 6149.9 samples/s | 96.1 steps/s
[Step=56950 Epoch=277.9] | Loss=0.01022 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.143 | L2-Norm(final)=13.982 | 1896.4 samples/s | 29.6 steps/s
[Step=57000 Epoch=278.1] | Loss=0.00973 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.147 | L2-Norm(final)=13.984 | 4948.9 samples/s | 77.3 steps/s
[Step=57050 Epoch=278.4] | Loss=0.00928 | Reg=0.00084 | acc=0.9844 | L2-Norm=9.150 | L2-Norm(final)=13.987 | 4870.7 samples/s | 76.1 steps/s
[Step=57100 Epoch=278.6] | Loss=0.00894 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.153 | L2-Norm(final)=13.989 | 5889.2 samples/s | 92.0 steps/s
[Step=57150 Epoch=278.9] | Loss=0.00859 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.157 | L2-Norm(final)=13.991 | 1900.4 samples/s | 29.7 steps/s
[Step=57200 Epoch=279.1] | Loss=0.00820 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.160 | L2-Norm(final)=13.994 | 4778.0 samples/s | 74.7 steps/s
[Step=57250 Epoch=279.4] | Loss=0.00797 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.163 | L2-Norm(final)=13.996 | 4862.1 samples/s | 76.0 steps/s
[Step=57300 Epoch=279.6] | Loss=0.00779 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.166 | L2-Norm(final)=13.999 | 5544.1 samples/s | 86.6 steps/s
[Step=57350 Epoch=279.8] | Loss=0.00762 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.168 | L2-Norm(final)=14.001 | 1938.0 samples/s | 30.3 steps/s
[Step=57400 Epoch=280.1] | Loss=0.00735 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.171 | L2-Norm(final)=14.003 | 4981.0 samples/s | 77.8 steps/s
[Step=57450 Epoch=280.3] | Loss=0.00721 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.174 | L2-Norm(final)=14.005 | 4874.1 samples/s | 76.2 steps/s
[Step=57500 Epoch=280.6] | Loss=0.00705 | Reg=0.00084 | acc=0.9844 | L2-Norm=9.176 | L2-Norm(final)=14.007 | 5254.5 samples/s | 82.1 steps/s
[Step=57550 Epoch=280.8] | Loss=0.00690 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.179 | L2-Norm(final)=14.010 | 1985.0 samples/s | 31.0 steps/s
[Step=57600 Epoch=281.1] | Loss=0.00672 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.182 | L2-Norm(final)=14.012 | 4914.0 samples/s | 76.8 steps/s
[Step=57650 Epoch=281.3] | Loss=0.00659 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.184 | L2-Norm(final)=14.014 | 4896.9 samples/s | 76.5 steps/s
[Step=57700 Epoch=281.5] | Loss=0.00648 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.186 | L2-Norm(final)=14.016 | 4989.4 samples/s | 78.0 steps/s
[Step=57750 Epoch=281.8] | Loss=0.00637 | Reg=0.00084 | acc=0.9844 | L2-Norm=9.189 | L2-Norm(final)=14.018 | 2019.8 samples/s | 31.6 steps/s
[Step=57800 Epoch=282.0] | Loss=0.00624 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.191 | L2-Norm(final)=14.020 | 4960.1 samples/s | 77.5 steps/s
[Step=57850 Epoch=282.3] | Loss=0.00612 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.193 | L2-Norm(final)=14.022 | 4942.9 samples/s | 77.2 steps/s
[Step=57900 Epoch=282.5] | Loss=0.00606 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.196 | L2-Norm(final)=14.024 | 4901.6 samples/s | 76.6 steps/s
[Step=57950 Epoch=282.8] | Loss=0.00596 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.198 | L2-Norm(final)=14.026 | 2027.9 samples/s | 31.7 steps/s
[Step=58000 Epoch=283.0] | Loss=0.00587 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.200 | L2-Norm(final)=14.028 | 4931.7 samples/s | 77.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step58000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=48001 Epoch=234.1] | Loss=0.01988 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.038 | L2-Norm(final)=13.604 | 3808.1 samples/s | 59.5 steps/s
[Step=48050 Epoch=234.3] | Loss=0.02526 | Reg=0.00082 | acc=0.9688 | L2-Norm=9.042 | L2-Norm(final)=13.603 | 5438.3 samples/s | 85.0 steps/s
[Step=48100 Epoch=234.6] | Loss=0.02566 | Reg=0.00082 | acc=0.9688 | L2-Norm=9.046 | L2-Norm(final)=13.603 | 5492.6 samples/s | 85.8 steps/s
[Step=48150 Epoch=234.8] | Loss=0.02518 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.049 | L2-Norm(final)=13.603 | 5548.6 samples/s | 86.7 steps/s
[Step=48200 Epoch=235.1] | Loss=0.02456 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.053 | L2-Norm(final)=13.604 | 7908.1 samples/s | 123.6 steps/s
[Step=48250 Epoch=235.3] | Loss=0.02391 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.056 | L2-Norm(final)=13.605 | 1934.6 samples/s | 30.2 steps/s
[Step=48300 Epoch=235.5] | Loss=0.02330 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.059 | L2-Norm(final)=13.607 | 5363.0 samples/s | 83.8 steps/s
[Step=48350 Epoch=235.8] | Loss=0.02231 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.062 | L2-Norm(final)=13.609 | 5439.9 samples/s | 85.0 steps/s
[Step=48400 Epoch=236.0] | Loss=0.02201 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.066 | L2-Norm(final)=13.611 | 7037.3 samples/s | 110.0 steps/s
[Step=48450 Epoch=236.3] | Loss=0.02127 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.069 | L2-Norm(final)=13.613 | 1953.7 samples/s | 30.5 steps/s
[Step=48500 Epoch=236.5] | Loss=0.02101 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.072 | L2-Norm(final)=13.616 | 5469.5 samples/s | 85.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=48501 Epoch=236.5] | Loss=0.03759 | Reg=0.00083 | acc=0.9688 | L2-Norm=9.104 | L2-Norm(final)=13.640 | 3879.2 samples/s | 60.6 steps/s
[Step=48550 Epoch=236.8] | Loss=0.01871 | Reg=0.00083 | acc=0.9844 | L2-Norm=9.109 | L2-Norm(final)=13.643 | 4719.1 samples/s | 73.7 steps/s
[Step=48600 Epoch=237.0] | Loss=0.01707 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.115 | L2-Norm(final)=13.646 | 4985.6 samples/s | 77.9 steps/s
[Step=48650 Epoch=237.2] | Loss=0.01593 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.121 | L2-Norm(final)=13.650 | 4918.7 samples/s | 76.9 steps/s
[Step=48700 Epoch=237.5] | Loss=0.01473 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.127 | L2-Norm(final)=13.653 | 6518.6 samples/s | 101.9 steps/s
[Step=48750 Epoch=237.7] | Loss=0.01320 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.132 | L2-Norm(final)=13.656 | 1859.8 samples/s | 29.1 steps/s
[Step=48800 Epoch=238.0] | Loss=0.01206 | Reg=0.00083 | acc=0.9844 | L2-Norm=9.137 | L2-Norm(final)=13.659 | 4928.4 samples/s | 77.0 steps/s
[Step=48850 Epoch=238.2] | Loss=0.01133 | Reg=0.00084 | acc=0.9844 | L2-Norm=9.141 | L2-Norm(final)=13.662 | 4937.6 samples/s | 77.2 steps/s
[Step=48900 Epoch=238.5] | Loss=0.01096 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.145 | L2-Norm(final)=13.665 | 6063.9 samples/s | 94.7 steps/s
[Step=48950 Epoch=238.7] | Loss=0.01039 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.149 | L2-Norm(final)=13.667 | 1900.3 samples/s | 29.7 steps/s
[Step=49000 Epoch=239.0] | Loss=0.00993 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.153 | L2-Norm(final)=13.670 | 4922.7 samples/s | 76.9 steps/s
[Step=49050 Epoch=239.2] | Loss=0.00943 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.157 | L2-Norm(final)=13.673 | 4906.4 samples/s | 76.7 steps/s
[Step=49100 Epoch=239.4] | Loss=0.00916 | Reg=0.00084 | acc=0.9844 | L2-Norm=9.160 | L2-Norm(final)=13.676 | 5730.9 samples/s | 89.5 steps/s
[Step=49150 Epoch=239.7] | Loss=0.00875 | Reg=0.00084 | acc=0.9844 | L2-Norm=9.164 | L2-Norm(final)=13.678 | 1925.1 samples/s | 30.1 steps/s
[Step=49200 Epoch=239.9] | Loss=0.00844 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.167 | L2-Norm(final)=13.681 | 4913.2 samples/s | 76.8 steps/s
[Step=49250 Epoch=240.2] | Loss=0.00820 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.171 | L2-Norm(final)=13.684 | 4911.1 samples/s | 76.7 steps/s
[Step=49300 Epoch=240.4] | Loss=0.00795 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.174 | L2-Norm(final)=13.686 | 5300.3 samples/s | 82.8 steps/s
[Step=49350 Epoch=240.7] | Loss=0.00769 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.177 | L2-Norm(final)=13.689 | 1985.5 samples/s | 31.0 steps/s
[Step=49400 Epoch=240.9] | Loss=0.00754 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.180 | L2-Norm(final)=13.691 | 4939.4 samples/s | 77.2 steps/s
[Step=49450 Epoch=241.1] | Loss=0.00735 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.183 | L2-Norm(final)=13.694 | 4935.2 samples/s | 77.1 steps/s
[Step=49500 Epoch=241.4] | Loss=0.00718 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.186 | L2-Norm(final)=13.696 | 4975.0 samples/s | 77.7 steps/s
[Step=49550 Epoch=241.6] | Loss=0.00710 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.189 | L2-Norm(final)=13.699 | 2046.2 samples/s | 32.0 steps/s
[Step=49600 Epoch=241.9] | Loss=0.00693 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.192 | L2-Norm(final)=13.701 | 4931.2 samples/s | 77.1 steps/s
[Step=49650 Epoch=242.1] | Loss=0.00674 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.195 | L2-Norm(final)=13.703 | 4902.8 samples/s | 76.6 steps/s
[Step=49700 Epoch=242.4] | Loss=0.00662 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.198 | L2-Norm(final)=13.706 | 4915.5 samples/s | 76.8 steps/s
[Step=49750 Epoch=242.6] | Loss=0.00648 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.201 | L2-Norm(final)=13.708 | 2062.3 samples/s | 32.2 steps/s
[Step=49800 Epoch=242.9] | Loss=0.00635 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.203 | L2-Norm(final)=13.710 | 4919.8 samples/s | 76.9 steps/s
[Step=49850 Epoch=243.1] | Loss=0.00626 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.206 | L2-Norm(final)=13.713 | 4904.5 samples/s | 76.6 steps/s
[Step=49900 Epoch=243.3] | Loss=0.00617 | Reg=0.00085 | acc=0.9844 | L2-Norm=9.209 | L2-Norm(final)=13.715 | 4948.3 samples/s | 77.3 steps/s
[Step=49950 Epoch=243.6] | Loss=0.00605 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.212 | L2-Norm(final)=13.717 | 2044.3 samples/s | 31.9 steps/s
[Step=50000 Epoch=243.8] | Loss=0.00596 | Reg=0.00085 | acc=1.0000 | L2-Norm=9.214 | L2-Norm(final)=13.719 | 4858.6 samples/s | 75.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step50000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=46001 Epoch=437.6] | Loss=0.00102 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.038 | L2-Norm(final)=9.443 | 3980.1 samples/s | 62.2 steps/s
[Step=46050 Epoch=438.0] | Loss=0.00192 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.046 | L2-Norm(final)=9.447 | 4564.4 samples/s | 71.3 steps/s
[Step=46100 Epoch=438.5] | Loss=0.00127 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.052 | L2-Norm(final)=9.451 | 7488.8 samples/s | 117.0 steps/s
[Step=46150 Epoch=439.0] | Loss=0.00091 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.055 | L2-Norm(final)=9.454 | 1856.9 samples/s | 29.0 steps/s
[Step=46200 Epoch=439.5] | Loss=0.00074 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.057 | L2-Norm(final)=9.457 | 6814.0 samples/s | 106.5 steps/s
[Step=46250 Epoch=440.0] | Loss=0.00062 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.059 | L2-Norm(final)=9.460 | 1914.4 samples/s | 29.9 steps/s
[Step=46300 Epoch=440.4] | Loss=0.00055 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.060 | L2-Norm(final)=9.463 | 5992.4 samples/s | 93.6 steps/s
[Step=46350 Epoch=440.9] | Loss=0.00049 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.061 | L2-Norm(final)=9.465 | 1970.7 samples/s | 30.8 steps/s
[Step=46400 Epoch=441.4] | Loss=0.00045 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.061 | L2-Norm(final)=9.467 | 5728.9 samples/s | 89.5 steps/s
[Step=46450 Epoch=441.9] | Loss=0.00041 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.062 | L2-Norm(final)=9.470 | 1951.7 samples/s | 30.5 steps/s
[Step=46500 Epoch=442.3] | Loss=0.00038 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.062 | L2-Norm(final)=9.472 | 5384.0 samples/s | 84.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=442.3] | Loss=0.00003 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.066 | L2-Norm(final)=9.495 | 3847.3 samples/s | 60.1 steps/s
[Step=46550 Epoch=442.8] | Loss=0.00026 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.071 | L2-Norm(final)=9.498 | 4361.7 samples/s | 68.2 steps/s
[Step=46600 Epoch=443.3] | Loss=0.00017 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.074 | L2-Norm(final)=9.501 | 6256.3 samples/s | 97.8 steps/s
[Step=46650 Epoch=443.8] | Loss=0.00012 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.075 | L2-Norm(final)=9.502 | 1787.1 samples/s | 27.9 steps/s
[Step=46700 Epoch=444.2] | Loss=0.00009 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.073 | L2-Norm(final)=9.503 | 5941.3 samples/s | 92.8 steps/s
[Step=46750 Epoch=444.7] | Loss=0.00008 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.072 | L2-Norm(final)=9.504 | 1837.5 samples/s | 28.7 steps/s
[Step=46800 Epoch=445.2] | Loss=0.00007 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.070 | L2-Norm(final)=9.504 | 5484.1 samples/s | 85.7 steps/s
[Step=46850 Epoch=445.7] | Loss=0.00006 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.067 | L2-Norm(final)=9.505 | 1896.0 samples/s | 29.6 steps/s
[Step=46900 Epoch=446.1] | Loss=0.00005 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.065 | L2-Norm(final)=9.505 | 5112.0 samples/s | 79.9 steps/s
[Step=46950 Epoch=446.6] | Loss=0.00005 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.062 | L2-Norm(final)=9.506 | 1910.0 samples/s | 29.8 steps/s
[Step=47000 Epoch=447.1] | Loss=0.00004 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.059 | L2-Norm(final)=9.506 | 4822.9 samples/s | 75.4 steps/s
[Step=47050 Epoch=447.6] | Loss=0.00004 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.057 | L2-Norm(final)=9.506 | 1960.0 samples/s | 30.6 steps/s
[Step=47100 Epoch=448.0] | Loss=0.00004 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.054 | L2-Norm(final)=9.507 | 4759.2 samples/s | 74.4 steps/s
[Step=47150 Epoch=448.5] | Loss=0.00003 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.051 | L2-Norm(final)=9.507 | 1991.4 samples/s | 31.1 steps/s
[Step=47200 Epoch=449.0] | Loss=0.00003 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.047 | L2-Norm(final)=9.507 | 4763.2 samples/s | 74.4 steps/s
[Step=47250 Epoch=449.5] | Loss=0.00003 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.044 | L2-Norm(final)=9.507 | 1976.3 samples/s | 30.9 steps/s
[Step=47300 Epoch=449.9] | Loss=0.00003 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.041 | L2-Norm(final)=9.508 | 4680.4 samples/s | 73.1 steps/s
[Step=47350 Epoch=450.4] | Loss=0.00003 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.038 | L2-Norm(final)=9.508 | 2072.0 samples/s | 32.4 steps/s
[Step=47400 Epoch=450.9] | Loss=0.00003 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.034 | L2-Norm(final)=9.508 | 4216.3 samples/s | 65.9 steps/s
[Step=47450 Epoch=451.4] | Loss=0.00003 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.031 | L2-Norm(final)=9.509 | 6620.9 samples/s | 103.5 steps/s
[Step=47500 Epoch=451.8] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.027 | L2-Norm(final)=9.509 | 1784.3 samples/s | 27.9 steps/s
[Step=47550 Epoch=452.3] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.024 | L2-Norm(final)=9.509 | 6024.3 samples/s | 94.1 steps/s
[Step=47600 Epoch=452.8] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.020 | L2-Norm(final)=9.509 | 1839.7 samples/s | 28.7 steps/s
[Step=47650 Epoch=453.3] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.016 | L2-Norm(final)=9.509 | 5653.2 samples/s | 88.3 steps/s
[Step=47700 Epoch=453.7] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.012 | L2-Norm(final)=9.510 | 1869.6 samples/s | 29.2 steps/s
[Step=47750 Epoch=454.2] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.008 | L2-Norm(final)=9.510 | 5234.3 samples/s | 81.8 steps/s
[Step=47800 Epoch=454.7] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.004 | L2-Norm(final)=9.510 | 1943.5 samples/s | 30.4 steps/s
[Step=47850 Epoch=455.2] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.000 | L2-Norm(final)=9.510 | 4807.2 samples/s | 75.1 steps/s
[Step=47900 Epoch=455.6] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.996 | L2-Norm(final)=9.511 | 1947.2 samples/s | 30.4 steps/s
[Step=47950 Epoch=456.1] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.992 | L2-Norm(final)=9.511 | 4724.0 samples/s | 73.8 steps/s
[Step=48000 Epoch=456.6] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.988 | L2-Norm(final)=9.511 | 1990.2 samples/s | 31.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step48000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=44001 Epoch=414.6] | Loss=0.00059 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.038 | L2-Norm(final)=9.202 | 3950.8 samples/s | 61.7 steps/s
[Step=44050 Epoch=415.1] | Loss=0.00117 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.046 | L2-Norm(final)=9.205 | 4621.4 samples/s | 72.2 steps/s
[Step=44100 Epoch=415.5] | Loss=0.00068 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.053 | L2-Norm(final)=9.209 | 7358.9 samples/s | 115.0 steps/s
[Step=44150 Epoch=416.0] | Loss=0.00050 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.056 | L2-Norm(final)=9.213 | 1845.4 samples/s | 28.8 steps/s
[Step=44200 Epoch=416.5] | Loss=0.00040 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.057 | L2-Norm(final)=9.216 | 6433.3 samples/s | 100.5 steps/s
[Step=44250 Epoch=417.0] | Loss=0.00034 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.057 | L2-Norm(final)=9.218 | 1942.9 samples/s | 30.4 steps/s
[Step=44300 Epoch=417.4] | Loss=0.00030 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.057 | L2-Norm(final)=9.221 | 5756.5 samples/s | 89.9 steps/s
[Step=44350 Epoch=417.9] | Loss=0.00027 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.057 | L2-Norm(final)=9.223 | 1960.8 samples/s | 30.6 steps/s
[Step=44400 Epoch=418.4] | Loss=0.00024 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.057 | L2-Norm(final)=9.226 | 5377.3 samples/s | 84.0 steps/s
[Step=44450 Epoch=418.8] | Loss=0.00022 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.056 | L2-Norm(final)=9.228 | 2042.7 samples/s | 31.9 steps/s
[Step=44500 Epoch=419.3] | Loss=0.00021 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.055 | L2-Norm(final)=9.230 | 5217.1 samples/s | 81.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=419.3] | Loss=0.00007 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.048 | L2-Norm(final)=9.252 | 4001.5 samples/s | 62.5 steps/s
[Step=44550 Epoch=419.8] | Loss=0.00024 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.050 | L2-Norm(final)=9.254 | 4225.1 samples/s | 66.0 steps/s
[Step=44600 Epoch=420.3] | Loss=0.00015 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.053 | L2-Norm(final)=9.257 | 6300.7 samples/s | 98.4 steps/s
[Step=44650 Epoch=420.7] | Loss=0.00011 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.052 | L2-Norm(final)=9.258 | 1798.2 samples/s | 28.1 steps/s
[Step=44700 Epoch=421.2] | Loss=0.00008 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.050 | L2-Norm(final)=9.259 | 5718.4 samples/s | 89.4 steps/s
[Step=44750 Epoch=421.7] | Loss=0.00007 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.048 | L2-Norm(final)=9.260 | 1821.1 samples/s | 28.5 steps/s
[Step=44800 Epoch=422.1] | Loss=0.00006 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.045 | L2-Norm(final)=9.260 | 5282.1 samples/s | 82.5 steps/s
[Step=44850 Epoch=422.6] | Loss=0.00005 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.042 | L2-Norm(final)=9.261 | 1915.9 samples/s | 29.9 steps/s
[Step=44900 Epoch=423.1] | Loss=0.00005 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.039 | L2-Norm(final)=9.261 | 4866.4 samples/s | 76.0 steps/s
[Step=44950 Epoch=423.6] | Loss=0.00004 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.035 | L2-Norm(final)=9.262 | 1958.7 samples/s | 30.6 steps/s
[Step=45000 Epoch=424.0] | Loss=0.00004 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.032 | L2-Norm(final)=9.262 | 4774.1 samples/s | 74.6 steps/s
[Step=45050 Epoch=424.5] | Loss=0.00003 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.028 | L2-Norm(final)=9.262 | 1956.8 samples/s | 30.6 steps/s
[Step=45100 Epoch=425.0] | Loss=0.00003 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.024 | L2-Norm(final)=9.263 | 4727.1 samples/s | 73.9 steps/s
[Step=45150 Epoch=425.4] | Loss=0.00003 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.021 | L2-Norm(final)=9.263 | 2024.0 samples/s | 31.6 steps/s
[Step=45200 Epoch=425.9] | Loss=0.00003 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.017 | L2-Norm(final)=9.264 | 4614.7 samples/s | 72.1 steps/s
[Step=45250 Epoch=426.4] | Loss=0.00003 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.013 | L2-Norm(final)=9.264 | 2102.7 samples/s | 32.9 steps/s
[Step=45300 Epoch=426.9] | Loss=0.00003 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.009 | L2-Norm(final)=9.264 | 4189.4 samples/s | 65.5 steps/s
[Step=45350 Epoch=427.3] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.005 | L2-Norm(final)=9.264 | 6419.9 samples/s | 100.3 steps/s
[Step=45400 Epoch=427.8] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.001 | L2-Norm(final)=9.265 | 1781.5 samples/s | 27.8 steps/s
[Step=45450 Epoch=428.3] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.997 | L2-Norm(final)=9.265 | 5819.1 samples/s | 90.9 steps/s
[Step=45500 Epoch=428.7] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.992 | L2-Norm(final)=9.265 | 1827.9 samples/s | 28.6 steps/s
[Step=45550 Epoch=429.2] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.988 | L2-Norm(final)=9.266 | 5308.1 samples/s | 82.9 steps/s
[Step=45600 Epoch=429.7] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.984 | L2-Norm(final)=9.266 | 1903.1 samples/s | 29.7 steps/s
[Step=45650 Epoch=430.2] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.979 | L2-Norm(final)=9.266 | 4923.5 samples/s | 76.9 steps/s
[Step=45700 Epoch=430.6] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.975 | L2-Norm(final)=9.266 | 1917.4 samples/s | 30.0 steps/s
[Step=45750 Epoch=431.1] | Loss=0.00002 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.970 | L2-Norm(final)=9.267 | 4750.7 samples/s | 74.2 steps/s
[Step=45800 Epoch=431.6] | Loss=0.00002 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.966 | L2-Norm(final)=9.267 | 1986.2 samples/s | 31.0 steps/s
[Step=45850 Epoch=432.0] | Loss=0.00002 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.961 | L2-Norm(final)=9.267 | 4762.8 samples/s | 74.4 steps/s
[Step=45900 Epoch=432.5] | Loss=0.00002 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.956 | L2-Norm(final)=9.267 | 1980.0 samples/s | 30.9 steps/s
[Step=45950 Epoch=433.0] | Loss=0.00002 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.951 | L2-Norm(final)=9.268 | 4670.7 samples/s | 73.0 steps/s
[Step=46000 Epoch=433.5] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.947 | L2-Norm(final)=9.268 | 2082.5 samples/s | 32.5 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step46000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07593 | acc=0.9620 | tpr=0.9706 | fpr=0.0565 | 4365.6 samples/s | 17.1 steps/s
Avg test loss: 0.07862, Avg test acc: 0.96081, Avg tpr: 0.96963, Avg fpr: 0.05858, total FA: 457

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08102 | acc=0.9625 | tpr=0.9771 | fpr=0.0691 | 4365.6 samples/s | 17.1 steps/s
Avg test loss: 0.08411, Avg test acc: 0.96121, Avg tpr: 0.97558, Avg fpr: 0.07038, total FA: 549

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.08155 | acc=0.9609 | tpr=0.9696 | fpr=0.0580 | 4485.6 samples/s | 17.5 steps/s
Avg test loss: 0.08588, Avg test acc: 0.95977, Avg tpr: 0.96765, Avg fpr: 0.05756, total FA: 449

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.07471 | acc=0.9625 | tpr=0.9741 | fpr=0.0627 | 4394.3 samples/s | 17.2 steps/s
Avg test loss: 0.07792, Avg test acc: 0.96113, Avg tpr: 0.97296, Avg fpr: 0.06486, total FA: 506

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08155 | acc=0.9628 | tpr=0.9752 | fpr=0.0642 | 4307.9 samples/s | 16.8 steps/s
Avg test loss: 0.08931, Avg test acc: 0.96158, Avg tpr: 0.97377, Avg fpr: 0.06525, total FA: 509

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.19821 | acc=0.3012 | tpr=0.0024 | fpr=0.0500 | 4422.4 samples/s | 17.3 steps/s
Avg test loss: 5.21339, Avg test acc: 0.29726, Avg tpr: 0.00239, Avg fpr: 0.05422, total FA: 423

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.67190 | acc=0.3133 | tpr=0.0041 | fpr=0.0154 | 4363.0 samples/s | 17.0 steps/s
Avg test loss: 4.68089, Avg test acc: 0.31072, Avg tpr: 0.00460, Avg fpr: 0.01602, total FA: 125

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.99118 | acc=0.3049 | tpr=0.0039 | fpr=0.0414 | 4405.3 samples/s | 17.2 steps/s
Avg test loss: 4.99956, Avg test acc: 0.30251, Avg tpr: 0.00501, Avg fpr: 0.04320, total FA: 337

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.38131 | acc=0.3063 | tpr=0.0033 | fpr=0.0359 | 4372.3 samples/s | 17.1 steps/s
Avg test loss: 5.39590, Avg test acc: 0.30295, Avg tpr: 0.00396, Avg fpr: 0.03948, total FA: 308

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.83881 | acc=0.3131 | tpr=0.0032 | fpr=0.0139 | 4407.1 samples/s | 17.2 steps/s
Avg test loss: 4.84816, Avg test acc: 0.31060, Avg tpr: 0.00367, Avg fpr: 0.01436, total FA: 112

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.76455 | acc=0.1259 | tpr=0.8009 | fpr=0.8863 | 4384.2 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.71457 | acc=0.1292 | tpr=0.7953 | fpr=0.8833 | 8465.8 samples/s | 33.1 steps/s
[Step= 150] | Loss=4.71500 | acc=0.1276 | tpr=0.8098 | fpr=0.8850 | 9064.9 samples/s | 35.4 steps/s
[Step= 200] | Loss=4.71443 | acc=0.1265 | tpr=0.8098 | fpr=0.8860 | 8316.0 samples/s | 32.5 steps/s
[Step= 250] | Loss=4.71853 | acc=0.1272 | tpr=0.8096 | fpr=0.8852 | 8592.5 samples/s | 33.6 steps/s
[Step= 300] | Loss=4.71320 | acc=0.1265 | tpr=0.8036 | fpr=0.8858 | 8675.6 samples/s | 33.9 steps/s
[Step= 350] | Loss=4.71027 | acc=0.1260 | tpr=0.8028 | fpr=0.8863 | 9196.1 samples/s | 35.9 steps/s
[Step= 400] | Loss=4.71192 | acc=0.1263 | tpr=0.7981 | fpr=0.8859 | 8199.1 samples/s | 32.0 steps/s
[Step= 450] | Loss=4.71482 | acc=0.1259 | tpr=0.7931 | fpr=0.8862 | 8675.8 samples/s | 33.9 steps/s
[Step= 500] | Loss=4.71698 | acc=0.1257 | tpr=0.7934 | fpr=0.8864 | 8505.6 samples/s | 33.2 steps/s
[Step= 550] | Loss=4.71582 | acc=0.1255 | tpr=0.7979 | fpr=0.8867 | 15423.6 samples/s | 60.2 steps/s
Avg test loss: 4.71739, Avg test acc: 0.12546, Avg tpr: 0.79715, Avg fpr: 0.88675, total FA: 123123

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.89532 | acc=0.1232 | tpr=0.8628 | fpr=0.8901 | 4380.4 samples/s | 17.1 steps/s
[Step= 100] | Loss=4.84220 | acc=0.1261 | tpr=0.8401 | fpr=0.8873 | 8647.5 samples/s | 33.8 steps/s
[Step= 150] | Loss=4.84497 | acc=0.1250 | tpr=0.8545 | fpr=0.8885 | 8607.9 samples/s | 33.6 steps/s
[Step= 200] | Loss=4.84531 | acc=0.1246 | tpr=0.8514 | fpr=0.8886 | 8524.8 samples/s | 33.3 steps/s
[Step= 250] | Loss=4.84610 | acc=0.1254 | tpr=0.8489 | fpr=0.8878 | 8659.1 samples/s | 33.8 steps/s
[Step= 300] | Loss=4.84172 | acc=0.1252 | tpr=0.8480 | fpr=0.8880 | 8624.8 samples/s | 33.7 steps/s
[Step= 350] | Loss=4.83745 | acc=0.1250 | tpr=0.8428 | fpr=0.8881 | 8574.1 samples/s | 33.5 steps/s
[Step= 400] | Loss=4.83930 | acc=0.1250 | tpr=0.8364 | fpr=0.8879 | 8755.9 samples/s | 34.2 steps/s
[Step= 450] | Loss=4.84457 | acc=0.1249 | tpr=0.8330 | fpr=0.8880 | 8691.2 samples/s | 33.9 steps/s
[Step= 500] | Loss=4.84973 | acc=0.1246 | tpr=0.8335 | fpr=0.8882 | 8403.9 samples/s | 32.8 steps/s
[Step= 550] | Loss=4.84759 | acc=0.1245 | tpr=0.8357 | fpr=0.8884 | 15612.5 samples/s | 61.0 steps/s
Avg test loss: 4.84892, Avg test acc: 0.12442, Avg tpr: 0.83479, Avg fpr: 0.88849, total FA: 123365

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.40472 | acc=0.1225 | tpr=0.7876 | fpr=0.8895 | 4349.8 samples/s | 17.0 steps/s
[Step= 100] | Loss=5.35272 | acc=0.1249 | tpr=0.7783 | fpr=0.8873 | 8770.9 samples/s | 34.3 steps/s
[Step= 150] | Loss=5.35484 | acc=0.1228 | tpr=0.7997 | fpr=0.8897 | 8572.1 samples/s | 33.5 steps/s
[Step= 200] | Loss=5.35525 | acc=0.1218 | tpr=0.8055 | fpr=0.8906 | 9614.8 samples/s | 37.6 steps/s
[Step= 250] | Loss=5.35630 | acc=0.1225 | tpr=0.8035 | fpr=0.8899 | 7869.8 samples/s | 30.7 steps/s
[Step= 300] | Loss=5.35174 | acc=0.1222 | tpr=0.8015 | fpr=0.8902 | 8688.0 samples/s | 33.9 steps/s
[Step= 350] | Loss=5.34985 | acc=0.1220 | tpr=0.8009 | fpr=0.8903 | 8764.3 samples/s | 34.2 steps/s
[Step= 400] | Loss=5.35283 | acc=0.1222 | tpr=0.7992 | fpr=0.8901 | 8627.6 samples/s | 33.7 steps/s
[Step= 450] | Loss=5.35708 | acc=0.1217 | tpr=0.7941 | fpr=0.8905 | 8533.3 samples/s | 33.3 steps/s
[Step= 500] | Loss=5.35805 | acc=0.1217 | tpr=0.7956 | fpr=0.8904 | 8623.6 samples/s | 33.7 steps/s
[Step= 550] | Loss=5.35686 | acc=0.1216 | tpr=0.8002 | fpr=0.8908 | 15267.9 samples/s | 59.6 steps/s
Avg test loss: 5.35801, Avg test acc: 0.12150, Avg tpr: 0.79992, Avg fpr: 0.89083, total FA: 123690

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.85163 | acc=0.1287 | tpr=0.7965 | fpr=0.8833 | 4320.2 samples/s | 16.9 steps/s
[Step= 100] | Loss=4.79852 | acc=0.1305 | tpr=0.7910 | fpr=0.8818 | 8945.0 samples/s | 34.9 steps/s
[Step= 150] | Loss=4.79951 | acc=0.1292 | tpr=0.8069 | fpr=0.8832 | 8469.4 samples/s | 33.1 steps/s
[Step= 200] | Loss=4.79782 | acc=0.1284 | tpr=0.8109 | fpr=0.8840 | 8988.3 samples/s | 35.1 steps/s
[Step= 250] | Loss=4.79994 | acc=0.1291 | tpr=0.8114 | fpr=0.8833 | 8531.7 samples/s | 33.3 steps/s
[Step= 300] | Loss=4.79549 | acc=0.1285 | tpr=0.8058 | fpr=0.8838 | 8708.8 samples/s | 34.0 steps/s
[Step= 350] | Loss=4.79152 | acc=0.1282 | tpr=0.8078 | fpr=0.8841 | 8510.0 samples/s | 33.2 steps/s
[Step= 400] | Loss=4.79448 | acc=0.1283 | tpr=0.8014 | fpr=0.8839 | 8765.2 samples/s | 34.2 steps/s
[Step= 450] | Loss=4.79930 | acc=0.1280 | tpr=0.7994 | fpr=0.8841 | 8399.3 samples/s | 32.8 steps/s
[Step= 500] | Loss=4.80200 | acc=0.1280 | tpr=0.8044 | fpr=0.8842 | 8779.9 samples/s | 34.3 steps/s
[Step= 550] | Loss=4.80014 | acc=0.1276 | tpr=0.8086 | fpr=0.8847 | 15136.6 samples/s | 59.1 steps/s
Avg test loss: 4.80161, Avg test acc: 0.12758, Avg tpr: 0.80784, Avg fpr: 0.88479, total FA: 122851

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.27558 | acc=0.1270 | tpr=0.7345 | fpr=0.8840 | 4436.7 samples/s | 17.3 steps/s
[Step= 100] | Loss=5.22285 | acc=0.1293 | tpr=0.7122 | fpr=0.8816 | 8359.1 samples/s | 32.7 steps/s
[Step= 150] | Loss=5.22306 | acc=0.1277 | tpr=0.7104 | fpr=0.8831 | 8623.2 samples/s | 33.7 steps/s
[Step= 200] | Loss=5.22146 | acc=0.1272 | tpr=0.7093 | fpr=0.8834 | 8725.5 samples/s | 34.1 steps/s
[Step= 250] | Loss=5.22502 | acc=0.1280 | tpr=0.7092 | fpr=0.8826 | 8980.5 samples/s | 35.1 steps/s
[Step= 300] | Loss=5.21962 | acc=0.1274 | tpr=0.7120 | fpr=0.8832 | 8151.1 samples/s | 31.8 steps/s
[Step= 350] | Loss=5.21644 | acc=0.1267 | tpr=0.7101 | fpr=0.8838 | 8642.1 samples/s | 33.8 steps/s
[Step= 400] | Loss=5.21986 | acc=0.1270 | tpr=0.7084 | fpr=0.8836 | 8490.5 samples/s | 33.2 steps/s
[Step= 450] | Loss=5.22360 | acc=0.1264 | tpr=0.7020 | fpr=0.8841 | 8729.2 samples/s | 34.1 steps/s
[Step= 500] | Loss=5.22615 | acc=0.1261 | tpr=0.6982 | fpr=0.8842 | 8552.1 samples/s | 33.4 steps/s
[Step= 550] | Loss=5.22496 | acc=0.1259 | tpr=0.6968 | fpr=0.8845 | 15307.2 samples/s | 59.8 steps/s
Avg test loss: 5.22706, Avg test acc: 0.12580, Avg tpr: 0.69651, Avg fpr: 0.88457, total FA: 122821

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09641 | acc=0.9817 | tpr=0.9469 | fpr=0.0177 | 4521.2 samples/s | 17.7 steps/s
[Step= 100] | Loss=0.10014 | acc=0.9811 | tpr=0.9574 | fpr=0.0184 | 8185.3 samples/s | 32.0 steps/s
[Step= 150] | Loss=0.10389 | acc=0.9803 | tpr=0.9539 | fpr=0.0192 | 8436.6 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.10594 | acc=0.9803 | tpr=0.9596 | fpr=0.0193 | 8529.8 samples/s | 33.3 steps/s
[Step= 250] | Loss=0.10555 | acc=0.9803 | tpr=0.9546 | fpr=0.0193 | 8708.8 samples/s | 34.0 steps/s
[Step= 300] | Loss=0.10768 | acc=0.9799 | tpr=0.9535 | fpr=0.0196 | 8667.3 samples/s | 33.9 steps/s
[Step= 350] | Loss=0.10761 | acc=0.9798 | tpr=0.9530 | fpr=0.0197 | 8464.9 samples/s | 33.1 steps/s
[Step= 400] | Loss=0.10862 | acc=0.9797 | tpr=0.9502 | fpr=0.0198 | 8549.1 samples/s | 33.4 steps/s
[Step= 450] | Loss=0.11124 | acc=0.9794 | tpr=0.9484 | fpr=0.0201 | 8504.7 samples/s | 33.2 steps/s
[Step= 500] | Loss=0.11102 | acc=0.9794 | tpr=0.9498 | fpr=0.0201 | 8630.7 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.11010 | acc=0.9796 | tpr=0.9499 | fpr=0.0199 | 15971.0 samples/s | 62.4 steps/s
Avg test loss: 0.10994, Avg test acc: 0.97959, Avg tpr: 0.95008, Avg fpr: 0.01987, total FA: 2759

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10843 | acc=0.9813 | tpr=0.9204 | fpr=0.0176 | 4345.6 samples/s | 17.0 steps/s
[Step= 100] | Loss=0.11222 | acc=0.9816 | tpr=0.9403 | fpr=0.0177 | 8819.1 samples/s | 34.4 steps/s
[Step= 150] | Loss=0.11636 | acc=0.9803 | tpr=0.9323 | fpr=0.0189 | 8460.4 samples/s | 33.0 steps/s
[Step= 200] | Loss=0.11799 | acc=0.9803 | tpr=0.9355 | fpr=0.0189 | 8788.2 samples/s | 34.3 steps/s
[Step= 250] | Loss=0.11736 | acc=0.9800 | tpr=0.9328 | fpr=0.0191 | 8594.5 samples/s | 33.6 steps/s
[Step= 300] | Loss=0.11977 | acc=0.9796 | tpr=0.9338 | fpr=0.0196 | 8636.9 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.12002 | acc=0.9794 | tpr=0.9355 | fpr=0.0198 | 8801.8 samples/s | 34.4 steps/s
[Step= 400] | Loss=0.12102 | acc=0.9792 | tpr=0.9338 | fpr=0.0199 | 8442.6 samples/s | 33.0 steps/s
[Step= 450] | Loss=0.12399 | acc=0.9789 | tpr=0.9309 | fpr=0.0202 | 8665.2 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.12359 | acc=0.9790 | tpr=0.9326 | fpr=0.0202 | 8534.5 samples/s | 33.3 steps/s
[Step= 550] | Loss=0.12269 | acc=0.9791 | tpr=0.9320 | fpr=0.0200 | 15799.8 samples/s | 61.7 steps/s
Avg test loss: 0.12247, Avg test acc: 0.97912, Avg tpr: 0.93185, Avg fpr: 0.02002, total FA: 2780

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.09846 | acc=0.9798 | tpr=0.9381 | fpr=0.0194 | 4366.4 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.10241 | acc=0.9795 | tpr=0.9574 | fpr=0.0201 | 8584.8 samples/s | 33.5 steps/s
[Step= 150] | Loss=0.10597 | acc=0.9784 | tpr=0.9539 | fpr=0.0211 | 8637.6 samples/s | 33.7 steps/s
[Step= 200] | Loss=0.10770 | acc=0.9785 | tpr=0.9574 | fpr=0.0211 | 8567.1 samples/s | 33.5 steps/s
[Step= 250] | Loss=0.10733 | acc=0.9786 | tpr=0.9555 | fpr=0.0210 | 8568.0 samples/s | 33.5 steps/s
[Step= 300] | Loss=0.10951 | acc=0.9782 | tpr=0.9556 | fpr=0.0214 | 9087.0 samples/s | 35.5 steps/s
[Step= 350] | Loss=0.10954 | acc=0.9780 | tpr=0.9562 | fpr=0.0216 | 8381.7 samples/s | 32.7 steps/s
[Step= 400] | Loss=0.11071 | acc=0.9778 | tpr=0.9546 | fpr=0.0218 | 8525.9 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.11318 | acc=0.9777 | tpr=0.9542 | fpr=0.0219 | 8733.0 samples/s | 34.1 steps/s
[Step= 500] | Loss=0.11275 | acc=0.9777 | tpr=0.9559 | fpr=0.0220 | 8617.8 samples/s | 33.7 steps/s
[Step= 550] | Loss=0.11174 | acc=0.9778 | tpr=0.9554 | fpr=0.0218 | 15664.6 samples/s | 61.2 steps/s
Avg test loss: 0.11156, Avg test acc: 0.97786, Avg tpr: 0.95563, Avg fpr: 0.02174, total FA: 3018

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10368 | acc=0.9823 | tpr=0.9292 | fpr=0.0168 | 4393.0 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.10772 | acc=0.9816 | tpr=0.9382 | fpr=0.0176 | 8485.0 samples/s | 33.1 steps/s
[Step= 150] | Loss=0.11198 | acc=0.9808 | tpr=0.9409 | fpr=0.0185 | 8513.3 samples/s | 33.3 steps/s
[Step= 200] | Loss=0.11456 | acc=0.9807 | tpr=0.9475 | fpr=0.0187 | 9031.6 samples/s | 35.3 steps/s
[Step= 250] | Loss=0.11344 | acc=0.9806 | tpr=0.9397 | fpr=0.0186 | 8356.6 samples/s | 32.6 steps/s
[Step= 300] | Loss=0.11521 | acc=0.9802 | tpr=0.9411 | fpr=0.0191 | 8636.7 samples/s | 33.7 steps/s
[Step= 350] | Loss=0.11517 | acc=0.9801 | tpr=0.9449 | fpr=0.0192 | 8665.8 samples/s | 33.9 steps/s
[Step= 400] | Loss=0.11587 | acc=0.9799 | tpr=0.9420 | fpr=0.0194 | 8512.8 samples/s | 33.3 steps/s
[Step= 450] | Loss=0.11867 | acc=0.9797 | tpr=0.9416 | fpr=0.0197 | 8474.7 samples/s | 33.1 steps/s
[Step= 500] | Loss=0.11824 | acc=0.9797 | tpr=0.9432 | fpr=0.0196 | 8926.9 samples/s | 34.9 steps/s
[Step= 550] | Loss=0.11743 | acc=0.9799 | tpr=0.9427 | fpr=0.0194 | 15306.0 samples/s | 59.8 steps/s
Avg test loss: 0.11725, Avg test acc: 0.97990, Avg tpr: 0.94216, Avg fpr: 0.01941, total FA: 2695

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12517 | acc=0.9797 | tpr=0.9292 | fpr=0.0194 | 4416.0 samples/s | 17.2 steps/s
[Step= 100] | Loss=0.13011 | acc=0.9794 | tpr=0.9531 | fpr=0.0201 | 8340.5 samples/s | 32.6 steps/s
[Step= 150] | Loss=0.13524 | acc=0.9783 | tpr=0.9539 | fpr=0.0213 | 8726.2 samples/s | 34.1 steps/s
[Step= 200] | Loss=0.13743 | acc=0.9780 | tpr=0.9585 | fpr=0.0217 | 8905.6 samples/s | 34.8 steps/s
[Step= 250] | Loss=0.13629 | acc=0.9781 | tpr=0.9537 | fpr=0.0214 | 8418.3 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.13900 | acc=0.9778 | tpr=0.9549 | fpr=0.0217 | 8837.2 samples/s | 34.5 steps/s
[Step= 350] | Loss=0.13963 | acc=0.9776 | tpr=0.9568 | fpr=0.0220 | 8635.7 samples/s | 33.7 steps/s
[Step= 400] | Loss=0.14066 | acc=0.9774 | tpr=0.9530 | fpr=0.0221 | 8498.0 samples/s | 33.2 steps/s
[Step= 450] | Loss=0.14385 | acc=0.9771 | tpr=0.9523 | fpr=0.0225 | 8646.4 samples/s | 33.8 steps/s
[Step= 500] | Loss=0.14328 | acc=0.9771 | tpr=0.9529 | fpr=0.0224 | 8927.1 samples/s | 34.9 steps/s
[Step= 550] | Loss=0.14241 | acc=0.9773 | tpr=0.9515 | fpr=0.0223 | 14716.7 samples/s | 57.5 steps/s
Avg test loss: 0.14217, Avg test acc: 0.97726, Avg tpr: 0.95127, Avg fpr: 0.02227, total FA: 3092

server round 47/50

clients selected: [1 2 6 8 9]

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=58001 Epoch=283.0] | Loss=0.09866 | Reg=0.00081 | acc=0.9375 | L2-Norm=8.999 | L2-Norm(final)=14.086 | 3842.2 samples/s | 60.0 steps/s
[Step=58050 Epoch=283.3] | Loss=0.02515 | Reg=0.00081 | acc=0.9844 | L2-Norm=9.003 | L2-Norm(final)=14.083 | 5291.0 samples/s | 82.7 steps/s
[Step=58100 Epoch=283.5] | Loss=0.02357 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.007 | L2-Norm(final)=14.083 | 5500.6 samples/s | 85.9 steps/s
[Step=58150 Epoch=283.7] | Loss=0.02184 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.011 | L2-Norm(final)=14.084 | 5497.8 samples/s | 85.9 steps/s
[Step=58200 Epoch=284.0] | Loss=0.02076 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.014 | L2-Norm(final)=14.084 | 7805.9 samples/s | 122.0 steps/s
[Step=58250 Epoch=284.2] | Loss=0.02008 | Reg=0.00081 | acc=0.9531 | L2-Norm=9.017 | L2-Norm(final)=14.085 | 1925.1 samples/s | 30.1 steps/s
[Step=58300 Epoch=284.5] | Loss=0.01950 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.020 | L2-Norm(final)=14.086 | 5375.2 samples/s | 84.0 steps/s
[Step=58350 Epoch=284.7] | Loss=0.01905 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.023 | L2-Norm(final)=14.088 | 5477.1 samples/s | 85.6 steps/s
[Step=58400 Epoch=285.0] | Loss=0.01868 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.026 | L2-Norm(final)=14.089 | 7088.8 samples/s | 110.8 steps/s
[Step=58450 Epoch=285.2] | Loss=0.01850 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.029 | L2-Norm(final)=14.091 | 1959.5 samples/s | 30.6 steps/s
[Step=58500 Epoch=285.5] | Loss=0.01810 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.032 | L2-Norm(final)=14.093 | 5494.5 samples/s | 85.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=58501 Epoch=285.5] | Loss=0.01575 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.064 | L2-Norm(final)=14.112 | 3863.8 samples/s | 60.4 steps/s
[Step=58550 Epoch=285.7] | Loss=0.01639 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.069 | L2-Norm(final)=14.114 | 4945.0 samples/s | 77.3 steps/s
[Step=58600 Epoch=285.9] | Loss=0.01484 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.074 | L2-Norm(final)=14.117 | 4951.9 samples/s | 77.4 steps/s
[Step=58650 Epoch=286.2] | Loss=0.01423 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.079 | L2-Norm(final)=14.119 | 4871.4 samples/s | 76.1 steps/s
[Step=58700 Epoch=286.4] | Loss=0.01331 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.084 | L2-Norm(final)=14.122 | 6484.8 samples/s | 101.3 steps/s
[Step=58750 Epoch=286.7] | Loss=0.01201 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.088 | L2-Norm(final)=14.124 | 1827.8 samples/s | 28.6 steps/s
[Step=58800 Epoch=286.9] | Loss=0.01092 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.092 | L2-Norm(final)=14.127 | 4832.5 samples/s | 75.5 steps/s
[Step=58850 Epoch=287.2] | Loss=0.01023 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.096 | L2-Norm(final)=14.130 | 4919.9 samples/s | 76.9 steps/s
[Step=58900 Epoch=287.4] | Loss=0.00992 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.099 | L2-Norm(final)=14.132 | 6264.6 samples/s | 97.9 steps/s
[Step=58950 Epoch=287.6] | Loss=0.00939 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.103 | L2-Norm(final)=14.135 | 1873.9 samples/s | 29.3 steps/s
[Step=59000 Epoch=287.9] | Loss=0.00894 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.106 | L2-Norm(final)=14.137 | 4931.8 samples/s | 77.1 steps/s
[Step=59050 Epoch=288.1] | Loss=0.00853 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.109 | L2-Norm(final)=14.139 | 4951.6 samples/s | 77.4 steps/s
[Step=59100 Epoch=288.4] | Loss=0.00827 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.113 | L2-Norm(final)=14.142 | 5827.3 samples/s | 91.1 steps/s
[Step=59150 Epoch=288.6] | Loss=0.00805 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.116 | L2-Norm(final)=14.144 | 1934.5 samples/s | 30.2 steps/s
[Step=59200 Epoch=288.9] | Loss=0.00778 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.118 | L2-Norm(final)=14.146 | 4847.5 samples/s | 75.7 steps/s
[Step=59250 Epoch=289.1] | Loss=0.00758 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.121 | L2-Norm(final)=14.149 | 4937.6 samples/s | 77.2 steps/s
[Step=59300 Epoch=289.4] | Loss=0.00734 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.124 | L2-Norm(final)=14.151 | 5441.1 samples/s | 85.0 steps/s
[Step=59350 Epoch=289.6] | Loss=0.00705 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.127 | L2-Norm(final)=14.153 | 1839.5 samples/s | 28.7 steps/s
[Step=59400 Epoch=289.8] | Loss=0.00684 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.129 | L2-Norm(final)=14.155 | 4652.5 samples/s | 72.7 steps/s
[Step=59450 Epoch=290.1] | Loss=0.00674 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.132 | L2-Norm(final)=14.157 | 4548.4 samples/s | 71.1 steps/s
[Step=59500 Epoch=290.3] | Loss=0.00660 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.134 | L2-Norm(final)=14.159 | 4997.5 samples/s | 78.1 steps/s
[Step=59550 Epoch=290.6] | Loss=0.00652 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.137 | L2-Norm(final)=14.161 | 1905.3 samples/s | 29.8 steps/s
[Step=59600 Epoch=290.8] | Loss=0.00638 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.139 | L2-Norm(final)=14.163 | 4782.6 samples/s | 74.7 steps/s
[Step=59650 Epoch=291.1] | Loss=0.00630 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.141 | L2-Norm(final)=14.165 | 4765.5 samples/s | 74.5 steps/s
[Step=59700 Epoch=291.3] | Loss=0.00620 | Reg=0.00084 | acc=0.9688 | L2-Norm=9.144 | L2-Norm(final)=14.167 | 4874.5 samples/s | 76.2 steps/s
[Step=59750 Epoch=291.6] | Loss=0.00602 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.146 | L2-Norm(final)=14.169 | 1929.0 samples/s | 30.1 steps/s
[Step=59800 Epoch=291.8] | Loss=0.00593 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.148 | L2-Norm(final)=14.171 | 4602.5 samples/s | 71.9 steps/s
[Step=59850 Epoch=292.0] | Loss=0.00586 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.150 | L2-Norm(final)=14.173 | 4455.4 samples/s | 69.6 steps/s
[Step=59900 Epoch=292.3] | Loss=0.00577 | Reg=0.00084 | acc=0.9844 | L2-Norm=9.152 | L2-Norm(final)=14.174 | 4440.8 samples/s | 69.4 steps/s
[Step=59950 Epoch=292.5] | Loss=0.00567 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.155 | L2-Norm(final)=14.176 | 1910.1 samples/s | 29.8 steps/s
[Step=60000 Epoch=292.8] | Loss=0.00557 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.157 | L2-Norm(final)=14.178 | 4441.8 samples/s | 69.4 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_1/client_state-step60000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=44001 Epoch=214.4] | Loss=0.01238 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.999 | L2-Norm(final)=13.730 | 3643.7 samples/s | 56.9 steps/s
[Step=44050 Epoch=214.6] | Loss=0.02718 | Reg=0.00081 | acc=0.9688 | L2-Norm=9.004 | L2-Norm(final)=13.729 | 5018.9 samples/s | 78.4 steps/s
[Step=44100 Epoch=214.9] | Loss=0.02686 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.009 | L2-Norm(final)=13.728 | 5292.9 samples/s | 82.7 steps/s
[Step=44150 Epoch=215.1] | Loss=0.02481 | Reg=0.00081 | acc=0.9844 | L2-Norm=9.013 | L2-Norm(final)=13.729 | 5062.5 samples/s | 79.1 steps/s
[Step=44200 Epoch=215.4] | Loss=0.02373 | Reg=0.00081 | acc=0.9531 | L2-Norm=9.017 | L2-Norm(final)=13.730 | 7264.1 samples/s | 113.5 steps/s
[Step=44250 Epoch=215.6] | Loss=0.02211 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.020 | L2-Norm(final)=13.731 | 1785.4 samples/s | 27.9 steps/s
[Step=44300 Epoch=215.9] | Loss=0.02110 | Reg=0.00081 | acc=0.9844 | L2-Norm=9.023 | L2-Norm(final)=13.733 | 5088.2 samples/s | 79.5 steps/s
[Step=44350 Epoch=216.1] | Loss=0.02131 | Reg=0.00081 | acc=0.9531 | L2-Norm=9.027 | L2-Norm(final)=13.736 | 5171.2 samples/s | 80.8 steps/s
[Step=44400 Epoch=216.3] | Loss=0.02145 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.030 | L2-Norm(final)=13.738 | 6297.3 samples/s | 98.4 steps/s
[Step=44450 Epoch=216.6] | Loss=0.02077 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.033 | L2-Norm(final)=13.740 | 1836.4 samples/s | 28.7 steps/s
[Step=44500 Epoch=216.8] | Loss=0.02032 | Reg=0.00082 | acc=0.9688 | L2-Norm=9.037 | L2-Norm(final)=13.742 | 4725.2 samples/s | 73.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=44501 Epoch=216.8] | Loss=0.00473 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.069 | L2-Norm(final)=13.767 | 3548.3 samples/s | 55.4 steps/s
[Step=44550 Epoch=217.1] | Loss=0.01565 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.074 | L2-Norm(final)=13.770 | 4593.1 samples/s | 71.8 steps/s
[Step=44600 Epoch=217.3] | Loss=0.01628 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.081 | L2-Norm(final)=13.773 | 4563.5 samples/s | 71.3 steps/s
[Step=44650 Epoch=217.6] | Loss=0.01663 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.087 | L2-Norm(final)=13.776 | 4575.9 samples/s | 71.5 steps/s
[Step=44700 Epoch=217.8] | Loss=0.01529 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.092 | L2-Norm(final)=13.779 | 5990.3 samples/s | 93.6 steps/s
[Step=44750 Epoch=218.0] | Loss=0.01388 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.097 | L2-Norm(final)=13.783 | 1745.1 samples/s | 27.3 steps/s
[Step=44800 Epoch=218.3] | Loss=0.01261 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.102 | L2-Norm(final)=13.786 | 4520.8 samples/s | 70.6 steps/s
[Step=44850 Epoch=218.5] | Loss=0.01171 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.107 | L2-Norm(final)=13.789 | 4486.2 samples/s | 70.1 steps/s
[Step=44900 Epoch=218.8] | Loss=0.01127 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.111 | L2-Norm(final)=13.792 | 5561.2 samples/s | 86.9 steps/s
[Step=44950 Epoch=219.0] | Loss=0.01070 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.115 | L2-Norm(final)=13.795 | 1766.8 samples/s | 27.6 steps/s
[Step=45000 Epoch=219.3] | Loss=0.01017 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.119 | L2-Norm(final)=13.798 | 4701.9 samples/s | 73.5 steps/s
[Step=45050 Epoch=219.5] | Loss=0.00967 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.123 | L2-Norm(final)=13.800 | 4523.9 samples/s | 70.7 steps/s
[Step=45100 Epoch=219.7] | Loss=0.00937 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.127 | L2-Norm(final)=13.803 | 5280.7 samples/s | 82.5 steps/s
[Step=45150 Epoch=220.0] | Loss=0.00900 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.130 | L2-Norm(final)=13.806 | 1807.5 samples/s | 28.2 steps/s
[Step=45200 Epoch=220.2] | Loss=0.00870 | Reg=0.00083 | acc=1.0000 | L2-Norm=9.134 | L2-Norm(final)=13.809 | 4419.8 samples/s | 69.1 steps/s
[Step=45250 Epoch=220.5] | Loss=0.00842 | Reg=0.00083 | acc=0.9844 | L2-Norm=9.137 | L2-Norm(final)=13.812 | 4548.4 samples/s | 71.1 steps/s
[Step=45300 Epoch=220.7] | Loss=0.00820 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.140 | L2-Norm(final)=13.814 | 5007.4 samples/s | 78.2 steps/s
[Step=45350 Epoch=221.0] | Loss=0.00800 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.144 | L2-Norm(final)=13.817 | 1850.6 samples/s | 28.9 steps/s
[Step=45400 Epoch=221.2] | Loss=0.00782 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.147 | L2-Norm(final)=13.819 | 4648.2 samples/s | 72.6 steps/s
[Step=45450 Epoch=221.5] | Loss=0.00763 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.150 | L2-Norm(final)=13.822 | 4618.9 samples/s | 72.2 steps/s
[Step=45500 Epoch=221.7] | Loss=0.00743 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.153 | L2-Norm(final)=13.825 | 4570.0 samples/s | 71.4 steps/s
[Step=45550 Epoch=221.9] | Loss=0.00727 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.156 | L2-Norm(final)=13.827 | 1839.5 samples/s | 28.7 steps/s
[Step=45600 Epoch=222.2] | Loss=0.00708 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.159 | L2-Norm(final)=13.830 | 4715.9 samples/s | 73.7 steps/s
[Step=45650 Epoch=222.4] | Loss=0.00693 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.162 | L2-Norm(final)=13.832 | 4831.3 samples/s | 75.5 steps/s
[Step=45700 Epoch=222.7] | Loss=0.00682 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.165 | L2-Norm(final)=13.835 | 4671.6 samples/s | 73.0 steps/s
[Step=45750 Epoch=222.9] | Loss=0.00671 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.168 | L2-Norm(final)=13.837 | 1934.7 samples/s | 30.2 steps/s
[Step=45800 Epoch=223.2] | Loss=0.00658 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.170 | L2-Norm(final)=13.839 | 4728.1 samples/s | 73.9 steps/s
[Step=45850 Epoch=223.4] | Loss=0.00649 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.173 | L2-Norm(final)=13.842 | 4485.5 samples/s | 70.1 steps/s
[Step=45900 Epoch=223.6] | Loss=0.00637 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.176 | L2-Norm(final)=13.844 | 4499.5 samples/s | 70.3 steps/s
[Step=45950 Epoch=223.9] | Loss=0.00628 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.179 | L2-Norm(final)=13.846 | 1899.2 samples/s | 29.7 steps/s
[Step=46000 Epoch=224.1] | Loss=0.00616 | Reg=0.00084 | acc=1.0000 | L2-Norm=9.181 | L2-Norm(final)=13.849 | 4484.9 samples/s | 70.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step46000.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=48001 Epoch=456.6] | Loss=0.00038 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.999 | L2-Norm(final)=9.518 | 3820.0 samples/s | 59.7 steps/s
[Step=48050 Epoch=457.1] | Loss=0.00176 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.005 | L2-Norm(final)=9.523 | 4065.3 samples/s | 63.5 steps/s
[Step=48100 Epoch=457.6] | Loss=0.00110 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.011 | L2-Norm(final)=9.527 | 6821.1 samples/s | 106.6 steps/s
[Step=48150 Epoch=458.0] | Loss=0.00082 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.015 | L2-Norm(final)=9.530 | 1703.3 samples/s | 26.6 steps/s
[Step=48200 Epoch=458.5] | Loss=0.00066 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.017 | L2-Norm(final)=9.534 | 6245.1 samples/s | 97.6 steps/s
[Step=48250 Epoch=459.0] | Loss=0.00055 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.019 | L2-Norm(final)=9.536 | 1750.2 samples/s | 27.3 steps/s
[Step=48300 Epoch=459.5] | Loss=0.00049 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.020 | L2-Norm(final)=9.539 | 5580.1 samples/s | 87.2 steps/s
[Step=48350 Epoch=459.9] | Loss=0.00044 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.021 | L2-Norm(final)=9.541 | 1802.9 samples/s | 28.2 steps/s
[Step=48400 Epoch=460.4] | Loss=0.00040 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.022 | L2-Norm(final)=9.544 | 5462.6 samples/s | 85.4 steps/s
[Step=48450 Epoch=460.9] | Loss=0.00036 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.022 | L2-Norm(final)=9.546 | 1872.6 samples/s | 29.3 steps/s
[Step=48500 Epoch=461.4] | Loss=0.00034 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.022 | L2-Norm(final)=9.548 | 5041.9 samples/s | 78.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=48501 Epoch=461.4] | Loss=0.00008 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.025 | L2-Norm(final)=9.570 | 3459.0 samples/s | 54.0 steps/s
[Step=48550 Epoch=461.8] | Loss=0.00006 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.025 | L2-Norm(final)=9.571 | 3921.7 samples/s | 61.3 steps/s
[Step=48600 Epoch=462.3] | Loss=0.00005 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.023 | L2-Norm(final)=9.572 | 5944.9 samples/s | 92.9 steps/s
[Step=48650 Epoch=462.8] | Loss=0.00004 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.020 | L2-Norm(final)=9.573 | 1693.4 samples/s | 26.5 steps/s
[Step=48700 Epoch=463.3] | Loss=0.00003 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.016 | L2-Norm(final)=9.574 | 5449.1 samples/s | 85.1 steps/s
[Step=48750 Epoch=463.7] | Loss=0.00003 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.012 | L2-Norm(final)=9.574 | 1690.2 samples/s | 26.4 steps/s
[Step=48800 Epoch=464.2] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.007 | L2-Norm(final)=9.575 | 5084.2 samples/s | 79.4 steps/s
[Step=48850 Epoch=464.7] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.002 | L2-Norm(final)=9.575 | 1784.3 samples/s | 27.9 steps/s
[Step=48900 Epoch=465.2] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.998 | L2-Norm(final)=9.575 | 4702.8 samples/s | 73.5 steps/s
[Step=48950 Epoch=465.6] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.992 | L2-Norm(final)=9.576 | 1825.8 samples/s | 28.5 steps/s
[Step=49000 Epoch=466.1] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.987 | L2-Norm(final)=9.576 | 4533.2 samples/s | 70.8 steps/s
[Step=49050 Epoch=466.6] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.982 | L2-Norm(final)=9.576 | 1874.1 samples/s | 29.3 steps/s
[Step=49100 Epoch=467.1] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.976 | L2-Norm(final)=9.576 | 4251.0 samples/s | 66.4 steps/s
[Step=49150 Epoch=467.5] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.971 | L2-Norm(final)=9.576 | 1847.9 samples/s | 28.9 steps/s
[Step=49200 Epoch=468.0] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.965 | L2-Norm(final)=9.577 | 4451.1 samples/s | 69.5 steps/s
[Step=49250 Epoch=468.5] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.959 | L2-Norm(final)=9.577 | 1887.4 samples/s | 29.5 steps/s
[Step=49300 Epoch=469.0] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.953 | L2-Norm(final)=9.577 | 4434.3 samples/s | 69.3 steps/s
[Step=49350 Epoch=469.4] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.947 | L2-Norm(final)=9.577 | 1935.9 samples/s | 30.2 steps/s
[Step=49400 Epoch=469.9] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.941 | L2-Norm(final)=9.578 | 4327.1 samples/s | 67.6 steps/s
[Step=49450 Epoch=470.4] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.935 | L2-Norm(final)=9.578 | 6582.8 samples/s | 102.9 steps/s
[Step=49500 Epoch=470.9] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.928 | L2-Norm(final)=9.578 | 1685.0 samples/s | 26.3 steps/s
[Step=49550 Epoch=471.3] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.922 | L2-Norm(final)=9.578 | 5632.0 samples/s | 88.0 steps/s
[Step=49600 Epoch=471.8] | Loss=0.00001 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.915 | L2-Norm(final)=9.578 | 1729.4 samples/s | 27.0 steps/s
[Step=49650 Epoch=472.3] | Loss=0.00001 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.908 | L2-Norm(final)=9.578 | 5174.6 samples/s | 80.9 steps/s
[Step=49700 Epoch=472.8] | Loss=0.00001 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.902 | L2-Norm(final)=9.579 | 1755.7 samples/s | 27.4 steps/s
[Step=49750 Epoch=473.2] | Loss=0.00001 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.895 | L2-Norm(final)=9.579 | 4764.5 samples/s | 74.4 steps/s
[Step=49800 Epoch=473.7] | Loss=0.00001 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.888 | L2-Norm(final)=9.579 | 1788.3 samples/s | 27.9 steps/s
[Step=49850 Epoch=474.2] | Loss=0.00001 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.880 | L2-Norm(final)=9.579 | 4549.8 samples/s | 71.1 steps/s
[Step=49900 Epoch=474.7] | Loss=0.00001 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.873 | L2-Norm(final)=9.579 | 1853.6 samples/s | 29.0 steps/s
[Step=49950 Epoch=475.1] | Loss=0.00001 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.866 | L2-Norm(final)=9.580 | 4442.9 samples/s | 69.4 steps/s
[Step=50000 Epoch=475.6] | Loss=0.00001 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.858 | L2-Norm(final)=9.580 | 1805.3 samples/s | 28.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step50000.h5

Train client 8: client_iccad2012_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=46001 Epoch=433.5] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.999 | L2-Norm(final)=9.276 | 3607.7 samples/s | 56.4 steps/s
[Step=46050 Epoch=433.9] | Loss=0.00091 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.007 | L2-Norm(final)=9.277 | 4541.5 samples/s | 71.0 steps/s
[Step=46100 Epoch=434.4] | Loss=0.00078 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.014 | L2-Norm(final)=9.281 | 6653.0 samples/s | 104.0 steps/s
[Step=46150 Epoch=434.9] | Loss=0.00057 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.018 | L2-Norm(final)=9.284 | 1755.2 samples/s | 27.4 steps/s
[Step=46200 Epoch=435.3] | Loss=0.00046 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.020 | L2-Norm(final)=9.287 | 6136.9 samples/s | 95.9 steps/s
[Step=46250 Epoch=435.8] | Loss=0.00039 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.021 | L2-Norm(final)=9.289 | 1800.2 samples/s | 28.1 steps/s
[Step=46300 Epoch=436.3] | Loss=0.00034 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.021 | L2-Norm(final)=9.291 | 5471.8 samples/s | 85.5 steps/s
[Step=46350 Epoch=436.7] | Loss=0.00031 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.022 | L2-Norm(final)=9.293 | 1904.1 samples/s | 29.8 steps/s
[Step=46400 Epoch=437.2] | Loss=0.00028 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.022 | L2-Norm(final)=9.295 | 5030.7 samples/s | 78.6 steps/s
[Step=46450 Epoch=437.7] | Loss=0.00026 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.022 | L2-Norm(final)=9.297 | 1914.4 samples/s | 29.9 steps/s
[Step=46500 Epoch=438.2] | Loss=0.00024 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.021 | L2-Norm(final)=9.299 | 4785.9 samples/s | 74.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=438.2] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.018 | L2-Norm(final)=9.317 | 3617.8 samples/s | 56.5 steps/s
[Step=46550 Epoch=438.6] | Loss=0.00006 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.018 | L2-Norm(final)=9.318 | 4284.5 samples/s | 66.9 steps/s
[Step=46600 Epoch=439.1] | Loss=0.00004 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.016 | L2-Norm(final)=9.319 | 5893.6 samples/s | 92.1 steps/s
[Step=46650 Epoch=439.6] | Loss=0.00003 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.012 | L2-Norm(final)=9.320 | 1703.5 samples/s | 26.6 steps/s
[Step=46700 Epoch=440.0] | Loss=0.00003 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.008 | L2-Norm(final)=9.320 | 5411.4 samples/s | 84.6 steps/s
[Step=46750 Epoch=440.5] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.004 | L2-Norm(final)=9.320 | 1751.6 samples/s | 27.4 steps/s
[Step=46800 Epoch=441.0] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.000 | L2-Norm(final)=9.321 | 4844.3 samples/s | 75.7 steps/s
[Step=46850 Epoch=441.5] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.995 | L2-Norm(final)=9.321 | 1815.0 samples/s | 28.4 steps/s
[Step=46900 Epoch=441.9] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.990 | L2-Norm(final)=9.321 | 4603.7 samples/s | 71.9 steps/s
[Step=46950 Epoch=442.4] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.985 | L2-Norm(final)=9.322 | 1839.5 samples/s | 28.7 steps/s
[Step=47000 Epoch=442.9] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.980 | L2-Norm(final)=9.322 | 4481.8 samples/s | 70.0 steps/s
[Step=47050 Epoch=443.3] | Loss=0.00001 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.975 | L2-Norm(final)=9.322 | 1859.4 samples/s | 29.1 steps/s
[Step=47100 Epoch=443.8] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.970 | L2-Norm(final)=9.322 | 4407.8 samples/s | 68.9 steps/s
[Step=47150 Epoch=444.3] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.965 | L2-Norm(final)=9.322 | 1888.2 samples/s | 29.5 steps/s
[Step=47200 Epoch=444.8] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.959 | L2-Norm(final)=9.323 | 4369.3 samples/s | 68.3 steps/s
[Step=47250 Epoch=445.2] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.954 | L2-Norm(final)=9.323 | 1897.2 samples/s | 29.6 steps/s
[Step=47300 Epoch=445.7] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.948 | L2-Norm(final)=9.323 | 4214.6 samples/s | 65.9 steps/s
[Step=47350 Epoch=446.2] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.942 | L2-Norm(final)=9.323 | 5953.0 samples/s | 93.0 steps/s
[Step=47400 Epoch=446.6] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.937 | L2-Norm(final)=9.324 | 1693.8 samples/s | 26.5 steps/s
[Step=47450 Epoch=447.1] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.931 | L2-Norm(final)=9.324 | 5431.5 samples/s | 84.9 steps/s
[Step=47500 Epoch=447.6] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.925 | L2-Norm(final)=9.324 | 1729.0 samples/s | 27.0 steps/s
[Step=47550 Epoch=448.1] | Loss=0.00001 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.919 | L2-Norm(final)=9.324 | 5014.4 samples/s | 78.4 steps/s
[Step=47600 Epoch=448.5] | Loss=0.00001 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.912 | L2-Norm(final)=9.324 | 1787.1 samples/s | 27.9 steps/s
[Step=47650 Epoch=449.0] | Loss=0.00001 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.906 | L2-Norm(final)=9.324 | 4431.4 samples/s | 69.2 steps/s
[Step=47700 Epoch=449.5] | Loss=0.00001 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.900 | L2-Norm(final)=9.325 | 1845.5 samples/s | 28.8 steps/s
[Step=47750 Epoch=449.9] | Loss=0.00001 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.893 | L2-Norm(final)=9.325 | 4284.0 samples/s | 66.9 steps/s
[Step=47800 Epoch=450.4] | Loss=0.00001 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.887 | L2-Norm(final)=9.325 | 1869.2 samples/s | 29.2 steps/s
[Step=47850 Epoch=450.9] | Loss=0.00001 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.880 | L2-Norm(final)=9.325 | 4453.4 samples/s | 69.6 steps/s
[Step=47900 Epoch=451.4] | Loss=0.00001 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.873 | L2-Norm(final)=9.325 | 1885.6 samples/s | 29.5 steps/s
[Step=47950 Epoch=451.8] | Loss=0.00001 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.867 | L2-Norm(final)=9.326 | 4437.6 samples/s | 69.3 steps/s
[Step=48000 Epoch=452.3] | Loss=0.00001 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.860 | L2-Norm(final)=9.326 | 1915.4 samples/s | 29.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_3/client_state-step48000.h5

Train client 9: client_iccad2012_4
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=50001 Epoch=476.6] | Loss=0.00044 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.999 | L2-Norm(final)=9.951 | 3777.9 samples/s | 59.0 steps/s
[Step=50050 Epoch=477.0] | Loss=0.00229 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.010 | L2-Norm(final)=9.959 | 4312.6 samples/s | 67.4 steps/s
[Step=50100 Epoch=477.5] | Loss=0.00162 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.017 | L2-Norm(final)=9.964 | 6623.3 samples/s | 103.5 steps/s
[Step=50150 Epoch=478.0] | Loss=0.00120 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.021 | L2-Norm(final)=9.968 | 1743.2 samples/s | 27.2 steps/s
[Step=50200 Epoch=478.5] | Loss=0.00096 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.024 | L2-Norm(final)=9.972 | 6301.2 samples/s | 98.5 steps/s
[Step=50250 Epoch=478.9] | Loss=0.00082 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.026 | L2-Norm(final)=9.975 | 1779.8 samples/s | 27.8 steps/s
[Step=50300 Epoch=479.4] | Loss=0.00072 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.027 | L2-Norm(final)=9.978 | 6278.7 samples/s | 98.1 steps/s
[Step=50350 Epoch=479.9] | Loss=0.00064 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.029 | L2-Norm(final)=9.981 | 1850.3 samples/s | 28.9 steps/s
[Step=50400 Epoch=480.4] | Loss=0.00059 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.030 | L2-Norm(final)=9.983 | 5677.8 samples/s | 88.7 steps/s
[Step=50450 Epoch=480.8] | Loss=0.00054 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.031 | L2-Norm(final)=9.986 | 1877.5 samples/s | 29.3 steps/s
[Step=50500 Epoch=481.3] | Loss=0.00050 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.032 | L2-Norm(final)=9.988 | 5215.1 samples/s | 81.5 steps/s
All layers training...
LR=0.00006, len=1
[Step=50501 Epoch=481.3] | Loss=0.00008 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.039 | L2-Norm(final)=10.013 | 3685.9 samples/s | 57.6 steps/s
[Step=50550 Epoch=481.8] | Loss=0.00012 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.041 | L2-Norm(final)=10.015 | 4209.8 samples/s | 65.8 steps/s
[Step=50600 Epoch=482.3] | Loss=0.00010 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.042 | L2-Norm(final)=10.016 | 6074.6 samples/s | 94.9 steps/s
[Step=50650 Epoch=482.7] | Loss=0.00010 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.043 | L2-Norm(final)=10.017 | 1698.9 samples/s | 26.5 steps/s
[Step=50700 Epoch=483.2] | Loss=0.00008 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.042 | L2-Norm(final)=10.018 | 5527.7 samples/s | 86.4 steps/s
[Step=50750 Epoch=483.7] | Loss=0.00006 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.041 | L2-Norm(final)=10.019 | 1711.3 samples/s | 26.7 steps/s
[Step=50800 Epoch=484.2] | Loss=0.00005 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.039 | L2-Norm(final)=10.020 | 5409.8 samples/s | 84.5 steps/s
[Step=50850 Epoch=484.6] | Loss=0.00005 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.037 | L2-Norm(final)=10.020 | 1774.9 samples/s | 27.7 steps/s
[Step=50900 Epoch=485.1] | Loss=0.00004 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.035 | L2-Norm(final)=10.020 | 5141.4 samples/s | 80.3 steps/s
[Step=50950 Epoch=485.6] | Loss=0.00004 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.032 | L2-Norm(final)=10.021 | 1794.2 samples/s | 28.0 steps/s
[Step=51000 Epoch=486.1] | Loss=0.00004 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.030 | L2-Norm(final)=10.021 | 4697.0 samples/s | 73.4 steps/s
[Step=51050 Epoch=486.6] | Loss=0.00003 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.027 | L2-Norm(final)=10.021 | 1829.6 samples/s | 28.6 steps/s
[Step=51100 Epoch=487.0] | Loss=0.00003 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.024 | L2-Norm(final)=10.022 | 4432.6 samples/s | 69.3 steps/s
[Step=51150 Epoch=487.5] | Loss=0.00003 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.021 | L2-Norm(final)=10.022 | 1847.5 samples/s | 28.9 steps/s
[Step=51200 Epoch=488.0] | Loss=0.00003 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.018 | L2-Norm(final)=10.022 | 4333.1 samples/s | 67.7 steps/s
[Step=51250 Epoch=488.5] | Loss=0.00003 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.015 | L2-Norm(final)=10.022 | 1870.5 samples/s | 29.2 steps/s
[Step=51300 Epoch=488.9] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.012 | L2-Norm(final)=10.023 | 4527.5 samples/s | 70.7 steps/s
[Step=51350 Epoch=489.4] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.008 | L2-Norm(final)=10.023 | 1817.7 samples/s | 28.4 steps/s
[Step=51400 Epoch=489.9] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.005 | L2-Norm(final)=10.023 | 4463.0 samples/s | 69.7 steps/s
[Step=51450 Epoch=490.4] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.002 | L2-Norm(final)=10.023 | 1896.3 samples/s | 29.6 steps/s
[Step=51500 Epoch=490.8] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.998 | L2-Norm(final)=10.023 | 4414.1 samples/s | 69.0 steps/s
[Step=51550 Epoch=491.3] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.994 | L2-Norm(final)=10.024 | 6339.7 samples/s | 99.1 steps/s
[Step=51600 Epoch=491.8] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.991 | L2-Norm(final)=10.024 | 1649.6 samples/s | 25.8 steps/s
[Step=51650 Epoch=492.3] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.987 | L2-Norm(final)=10.024 | 5898.8 samples/s | 92.2 steps/s
[Step=51700 Epoch=492.7] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.983 | L2-Norm(final)=10.024 | 1648.5 samples/s | 25.8 steps/s
[Step=51750 Epoch=493.2] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.979 | L2-Norm(final)=10.024 | 5362.8 samples/s | 83.8 steps/s
[Step=51800 Epoch=493.7] | Loss=0.00002 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.975 | L2-Norm(final)=10.025 | 1715.0 samples/s | 26.8 steps/s
[Step=51850 Epoch=494.2] | Loss=0.00002 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.971 | L2-Norm(final)=10.025 | 5165.3 samples/s | 80.7 steps/s
[Step=51900 Epoch=494.7] | Loss=0.00002 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.967 | L2-Norm(final)=10.025 | 1789.8 samples/s | 28.0 steps/s
[Step=51950 Epoch=495.1] | Loss=0.00002 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.963 | L2-Norm(final)=10.025 | 4831.7 samples/s | 75.5 steps/s
[Step=52000 Epoch=495.6] | Loss=0.00002 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.959 | L2-Norm(final)=10.025 | 1766.2 samples/s | 27.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_4/client_state-step52000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07593 | acc=0.9620 | tpr=0.9706 | fpr=0.0565 | 4079.4 samples/s | 15.9 steps/s
Avg test loss: 0.07862, Avg test acc: 0.96081, Avg tpr: 0.96963, Avg fpr: 0.05858, total FA: 457

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08208 | acc=0.9621 | tpr=0.9723 | fpr=0.0600 | 4230.7 samples/s | 16.5 steps/s
Avg test loss: 0.08497, Avg test acc: 0.96105, Avg tpr: 0.97080, Avg fpr: 0.06038, total FA: 471

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.07990 | acc=0.9584 | tpr=0.9636 | fpr=0.0530 | 4042.8 samples/s | 15.8 steps/s
Avg test loss: 0.08420, Avg test acc: 0.95789, Avg tpr: 0.96276, Avg fpr: 0.05281, total FA: 412

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.07471 | acc=0.9625 | tpr=0.9741 | fpr=0.0627 | 4066.2 samples/s | 15.9 steps/s
Avg test loss: 0.07792, Avg test acc: 0.96113, Avg tpr: 0.97296, Avg fpr: 0.06486, total FA: 506

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08155 | acc=0.9628 | tpr=0.9752 | fpr=0.0642 | 4164.5 samples/s | 16.3 steps/s
Avg test loss: 0.08931, Avg test acc: 0.96158, Avg tpr: 0.97377, Avg fpr: 0.06525, total FA: 509

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.19821 | acc=0.3012 | tpr=0.0024 | fpr=0.0500 | 4063.3 samples/s | 15.9 steps/s
Avg test loss: 5.21339, Avg test acc: 0.29726, Avg tpr: 0.00239, Avg fpr: 0.05422, total FA: 423

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.87879 | acc=0.3135 | tpr=0.0035 | fpr=0.0134 | 4042.5 samples/s | 15.8 steps/s
Avg test loss: 4.88892, Avg test acc: 0.31108, Avg tpr: 0.00408, Avg fpr: 0.01372, total FA: 107

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.99118 | acc=0.3049 | tpr=0.0039 | fpr=0.0414 | 3932.5 samples/s | 15.4 steps/s
Avg test loss: 4.99956, Avg test acc: 0.30251, Avg tpr: 0.00501, Avg fpr: 0.04320, total FA: 337

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.30152 | acc=0.3044 | tpr=0.0033 | fpr=0.0419 | 4113.8 samples/s | 16.1 steps/s
Avg test loss: 5.31793, Avg test acc: 0.30127, Avg tpr: 0.00425, Avg fpr: 0.04551, total FA: 355

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.85240 | acc=0.3139 | tpr=0.0030 | fpr=0.0109 | 4091.6 samples/s | 16.0 steps/s
Avg test loss: 4.86296, Avg test acc: 0.31128, Avg tpr: 0.00321, Avg fpr: 0.01115, total FA: 87

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.76455 | acc=0.1259 | tpr=0.8009 | fpr=0.8863 | 4081.0 samples/s | 15.9 steps/s
[Step= 100] | Loss=4.71457 | acc=0.1292 | tpr=0.7953 | fpr=0.8833 | 7719.0 samples/s | 30.2 steps/s
[Step= 150] | Loss=4.71500 | acc=0.1276 | tpr=0.8098 | fpr=0.8850 | 8016.5 samples/s | 31.3 steps/s
[Step= 200] | Loss=4.71443 | acc=0.1265 | tpr=0.8098 | fpr=0.8860 | 7791.1 samples/s | 30.4 steps/s
[Step= 250] | Loss=4.71853 | acc=0.1272 | tpr=0.8096 | fpr=0.8852 | 8066.7 samples/s | 31.5 steps/s
[Step= 300] | Loss=4.71320 | acc=0.1265 | tpr=0.8036 | fpr=0.8858 | 7621.8 samples/s | 29.8 steps/s
[Step= 350] | Loss=4.71027 | acc=0.1260 | tpr=0.8028 | fpr=0.8863 | 7749.4 samples/s | 30.3 steps/s
[Step= 400] | Loss=4.71192 | acc=0.1263 | tpr=0.7981 | fpr=0.8859 | 7925.3 samples/s | 31.0 steps/s
[Step= 450] | Loss=4.71482 | acc=0.1259 | tpr=0.7931 | fpr=0.8862 | 8304.1 samples/s | 32.4 steps/s
[Step= 500] | Loss=4.71698 | acc=0.1257 | tpr=0.7934 | fpr=0.8864 | 7830.1 samples/s | 30.6 steps/s
[Step= 550] | Loss=4.71582 | acc=0.1255 | tpr=0.7979 | fpr=0.8867 | 14191.9 samples/s | 55.4 steps/s
Avg test loss: 4.71739, Avg test acc: 0.12546, Avg tpr: 0.79715, Avg fpr: 0.88675, total FA: 123123

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.82086 | acc=0.1308 | tpr=0.8142 | fpr=0.8815 | 4106.9 samples/s | 16.0 steps/s
[Step= 100] | Loss=4.76944 | acc=0.1346 | tpr=0.8038 | fpr=0.8779 | 8022.7 samples/s | 31.3 steps/s
[Step= 150] | Loss=4.77257 | acc=0.1340 | tpr=0.8127 | fpr=0.8785 | 7636.5 samples/s | 29.8 steps/s
[Step= 200] | Loss=4.77303 | acc=0.1336 | tpr=0.8164 | fpr=0.8788 | 7734.9 samples/s | 30.2 steps/s
[Step= 250] | Loss=4.77403 | acc=0.1341 | tpr=0.8148 | fpr=0.8783 | 7972.2 samples/s | 31.1 steps/s
[Step= 300] | Loss=4.76958 | acc=0.1339 | tpr=0.8138 | fpr=0.8785 | 7560.6 samples/s | 29.5 steps/s
[Step= 350] | Loss=4.76516 | acc=0.1336 | tpr=0.8084 | fpr=0.8786 | 7816.0 samples/s | 30.5 steps/s
[Step= 400] | Loss=4.76696 | acc=0.1336 | tpr=0.8025 | fpr=0.8785 | 7819.1 samples/s | 30.5 steps/s
[Step= 450] | Loss=4.77202 | acc=0.1333 | tpr=0.7984 | fpr=0.8788 | 8336.4 samples/s | 32.6 steps/s
[Step= 500] | Loss=4.77681 | acc=0.1330 | tpr=0.7987 | fpr=0.8790 | 7556.1 samples/s | 29.5 steps/s
[Step= 550] | Loss=4.77477 | acc=0.1329 | tpr=0.8014 | fpr=0.8792 | 14038.7 samples/s | 54.8 steps/s
Avg test loss: 4.77605, Avg test acc: 0.13289, Avg tpr: 0.80071, Avg fpr: 0.87925, total FA: 122082

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=4.88865 | acc=0.1294 | tpr=0.7434 | fpr=0.8817 | 3893.4 samples/s | 15.2 steps/s
[Step= 100] | Loss=4.83737 | acc=0.1334 | tpr=0.7505 | fpr=0.8782 | 8082.6 samples/s | 31.6 steps/s
[Step= 150] | Loss=4.83932 | acc=0.1314 | tpr=0.7637 | fpr=0.8803 | 8302.8 samples/s | 32.4 steps/s
[Step= 200] | Loss=4.84069 | acc=0.1299 | tpr=0.7672 | fpr=0.8817 | 7779.6 samples/s | 30.4 steps/s
[Step= 250] | Loss=4.84092 | acc=0.1308 | tpr=0.7624 | fpr=0.8807 | 8139.6 samples/s | 31.8 steps/s
[Step= 300] | Loss=4.83594 | acc=0.1306 | tpr=0.7636 | fpr=0.8809 | 7918.1 samples/s | 30.9 steps/s
[Step= 350] | Loss=4.83300 | acc=0.1307 | tpr=0.7646 | fpr=0.8808 | 7927.7 samples/s | 31.0 steps/s
[Step= 400] | Loss=4.83621 | acc=0.1309 | tpr=0.7615 | fpr=0.8806 | 7816.4 samples/s | 30.5 steps/s
[Step= 450] | Loss=4.84013 | acc=0.1305 | tpr=0.7585 | fpr=0.8809 | 8038.2 samples/s | 31.4 steps/s
[Step= 500] | Loss=4.84100 | acc=0.1305 | tpr=0.7590 | fpr=0.8809 | 7794.7 samples/s | 30.4 steps/s
[Step= 550] | Loss=4.83964 | acc=0.1304 | tpr=0.7632 | fpr=0.8811 | 14642.2 samples/s | 57.2 steps/s
Avg test loss: 4.84080, Avg test acc: 0.13032, Avg tpr: 0.76228, Avg fpr: 0.88117, total FA: 122348

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.85163 | acc=0.1287 | tpr=0.7965 | fpr=0.8833 | 4127.9 samples/s | 16.1 steps/s
[Step= 100] | Loss=4.79852 | acc=0.1305 | tpr=0.7910 | fpr=0.8818 | 7407.6 samples/s | 28.9 steps/s
[Step= 150] | Loss=4.79951 | acc=0.1292 | tpr=0.8069 | fpr=0.8832 | 8294.5 samples/s | 32.4 steps/s
[Step= 200] | Loss=4.79782 | acc=0.1284 | tpr=0.8109 | fpr=0.8840 | 7890.6 samples/s | 30.8 steps/s
[Step= 250] | Loss=4.79994 | acc=0.1291 | tpr=0.8114 | fpr=0.8833 | 8211.4 samples/s | 32.1 steps/s
[Step= 300] | Loss=4.79549 | acc=0.1285 | tpr=0.8058 | fpr=0.8838 | 8388.6 samples/s | 32.8 steps/s
[Step= 350] | Loss=4.79152 | acc=0.1282 | tpr=0.8078 | fpr=0.8841 | 8186.1 samples/s | 32.0 steps/s
[Step= 400] | Loss=4.79448 | acc=0.1283 | tpr=0.8014 | fpr=0.8839 | 7818.4 samples/s | 30.5 steps/s
[Step= 450] | Loss=4.79930 | acc=0.1280 | tpr=0.7994 | fpr=0.8841 | 8232.3 samples/s | 32.2 steps/s
[Step= 500] | Loss=4.80200 | acc=0.1280 | tpr=0.8044 | fpr=0.8842 | 7676.2 samples/s | 30.0 steps/s
[Step= 550] | Loss=4.80014 | acc=0.1276 | tpr=0.8086 | fpr=0.8847 | 14280.7 samples/s | 55.8 steps/s
Avg test loss: 4.80161, Avg test acc: 0.12758, Avg tpr: 0.80784, Avg fpr: 0.88479, total FA: 122851

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.27558 | acc=0.1270 | tpr=0.7345 | fpr=0.8840 | 4035.8 samples/s | 15.8 steps/s
[Step= 100] | Loss=5.22285 | acc=0.1293 | tpr=0.7122 | fpr=0.8816 | 8591.5 samples/s | 33.6 steps/s
[Step= 150] | Loss=5.22306 | acc=0.1277 | tpr=0.7104 | fpr=0.8831 | 7717.6 samples/s | 30.1 steps/s
[Step= 200] | Loss=5.22146 | acc=0.1272 | tpr=0.7093 | fpr=0.8834 | 8012.9 samples/s | 31.3 steps/s
[Step= 250] | Loss=5.22502 | acc=0.1280 | tpr=0.7092 | fpr=0.8826 | 8433.8 samples/s | 32.9 steps/s
[Step= 300] | Loss=5.21962 | acc=0.1274 | tpr=0.7120 | fpr=0.8832 | 7842.5 samples/s | 30.6 steps/s
[Step= 350] | Loss=5.21644 | acc=0.1267 | tpr=0.7101 | fpr=0.8838 | 8319.9 samples/s | 32.5 steps/s
[Step= 400] | Loss=5.21986 | acc=0.1270 | tpr=0.7084 | fpr=0.8836 | 8147.7 samples/s | 31.8 steps/s
[Step= 450] | Loss=5.22360 | acc=0.1264 | tpr=0.7020 | fpr=0.8841 | 7464.9 samples/s | 29.2 steps/s
[Step= 500] | Loss=5.22615 | acc=0.1261 | tpr=0.6982 | fpr=0.8842 | 7667.7 samples/s | 30.0 steps/s
[Step= 550] | Loss=5.22496 | acc=0.1259 | tpr=0.6968 | fpr=0.8845 | 13552.3 samples/s | 52.9 steps/s
Avg test loss: 5.22706, Avg test acc: 0.12580, Avg tpr: 0.69651, Avg fpr: 0.88457, total FA: 122821

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09641 | acc=0.9817 | tpr=0.9469 | fpr=0.0177 | 4100.1 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.10014 | acc=0.9811 | tpr=0.9574 | fpr=0.0184 | 7915.4 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.10389 | acc=0.9803 | tpr=0.9539 | fpr=0.0192 | 8153.5 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.10594 | acc=0.9803 | tpr=0.9596 | fpr=0.0193 | 8192.6 samples/s | 32.0 steps/s
[Step= 250] | Loss=0.10555 | acc=0.9803 | tpr=0.9546 | fpr=0.0193 | 7897.0 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.10768 | acc=0.9799 | tpr=0.9535 | fpr=0.0196 | 8226.1 samples/s | 32.1 steps/s
[Step= 350] | Loss=0.10761 | acc=0.9798 | tpr=0.9530 | fpr=0.0197 | 8111.2 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.10862 | acc=0.9797 | tpr=0.9502 | fpr=0.0198 | 7851.3 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.11124 | acc=0.9794 | tpr=0.9484 | fpr=0.0201 | 8078.7 samples/s | 31.6 steps/s
[Step= 500] | Loss=0.11102 | acc=0.9794 | tpr=0.9498 | fpr=0.0201 | 7812.3 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.11010 | acc=0.9796 | tpr=0.9499 | fpr=0.0199 | 13683.1 samples/s | 53.4 steps/s
Avg test loss: 0.10994, Avg test acc: 0.97959, Avg tpr: 0.95008, Avg fpr: 0.01987, total FA: 2759

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10809 | acc=0.9814 | tpr=0.9248 | fpr=0.0176 | 4067.2 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.11227 | acc=0.9816 | tpr=0.9403 | fpr=0.0176 | 8255.3 samples/s | 32.2 steps/s
[Step= 150] | Loss=0.11661 | acc=0.9805 | tpr=0.9337 | fpr=0.0186 | 8012.7 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.11837 | acc=0.9806 | tpr=0.9366 | fpr=0.0186 | 7584.7 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.11756 | acc=0.9804 | tpr=0.9345 | fpr=0.0188 | 7954.8 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.11986 | acc=0.9800 | tpr=0.9360 | fpr=0.0192 | 8257.7 samples/s | 32.3 steps/s
[Step= 350] | Loss=0.12011 | acc=0.9798 | tpr=0.9374 | fpr=0.0194 | 7811.0 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.12107 | acc=0.9797 | tpr=0.9354 | fpr=0.0195 | 8028.0 samples/s | 31.4 steps/s
[Step= 450] | Loss=0.12406 | acc=0.9794 | tpr=0.9338 | fpr=0.0198 | 8061.9 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.12365 | acc=0.9794 | tpr=0.9352 | fpr=0.0198 | 7573.8 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.12280 | acc=0.9796 | tpr=0.9339 | fpr=0.0196 | 14567.3 samples/s | 56.9 steps/s
Avg test loss: 0.12257, Avg test acc: 0.97956, Avg tpr: 0.93384, Avg fpr: 0.01961, total FA: 2723

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.09846 | acc=0.9798 | tpr=0.9381 | fpr=0.0194 | 4045.5 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.10241 | acc=0.9795 | tpr=0.9574 | fpr=0.0201 | 7999.3 samples/s | 31.2 steps/s
[Step= 150] | Loss=0.10597 | acc=0.9784 | tpr=0.9539 | fpr=0.0211 | 7809.8 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.10770 | acc=0.9785 | tpr=0.9574 | fpr=0.0211 | 8140.3 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.10733 | acc=0.9786 | tpr=0.9555 | fpr=0.0210 | 7929.3 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.10951 | acc=0.9782 | tpr=0.9556 | fpr=0.0214 | 8595.8 samples/s | 33.6 steps/s
[Step= 350] | Loss=0.10954 | acc=0.9780 | tpr=0.9562 | fpr=0.0216 | 7856.7 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.11071 | acc=0.9778 | tpr=0.9546 | fpr=0.0218 | 8072.5 samples/s | 31.5 steps/s
[Step= 450] | Loss=0.11318 | acc=0.9777 | tpr=0.9542 | fpr=0.0219 | 8013.9 samples/s | 31.3 steps/s
[Step= 500] | Loss=0.11275 | acc=0.9777 | tpr=0.9559 | fpr=0.0220 | 7560.5 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.11174 | acc=0.9778 | tpr=0.9554 | fpr=0.0218 | 14206.2 samples/s | 55.5 steps/s
Avg test loss: 0.11156, Avg test acc: 0.97786, Avg tpr: 0.95563, Avg fpr: 0.02174, total FA: 3018

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10544 | acc=0.9813 | tpr=0.9425 | fpr=0.0180 | 4049.6 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.10975 | acc=0.9807 | tpr=0.9531 | fpr=0.0187 | 8223.9 samples/s | 32.1 steps/s
[Step= 150] | Loss=0.11407 | acc=0.9800 | tpr=0.9524 | fpr=0.0195 | 8059.8 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.11644 | acc=0.9800 | tpr=0.9585 | fpr=0.0196 | 8028.9 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.11549 | acc=0.9800 | tpr=0.9546 | fpr=0.0195 | 7585.4 samples/s | 29.6 steps/s
[Step= 300] | Loss=0.11727 | acc=0.9797 | tpr=0.9564 | fpr=0.0199 | 7636.1 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.11749 | acc=0.9795 | tpr=0.9580 | fpr=0.0201 | 8052.8 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.11816 | acc=0.9794 | tpr=0.9562 | fpr=0.0202 | 8134.1 samples/s | 31.8 steps/s
[Step= 450] | Loss=0.12101 | acc=0.9792 | tpr=0.9557 | fpr=0.0204 | 7904.1 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.12062 | acc=0.9792 | tpr=0.9559 | fpr=0.0204 | 8034.0 samples/s | 31.4 steps/s
[Step= 550] | Loss=0.11971 | acc=0.9794 | tpr=0.9554 | fpr=0.0202 | 13476.4 samples/s | 52.6 steps/s
Avg test loss: 0.11953, Avg test acc: 0.97939, Avg tpr: 0.95563, Avg fpr: 0.02018, total FA: 2802

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12300 | acc=0.9802 | tpr=0.9292 | fpr=0.0188 | 4100.4 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.12753 | acc=0.9798 | tpr=0.9510 | fpr=0.0197 | 7705.4 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.13281 | acc=0.9786 | tpr=0.9524 | fpr=0.0209 | 8251.2 samples/s | 32.2 steps/s
[Step= 200] | Loss=0.13482 | acc=0.9784 | tpr=0.9563 | fpr=0.0212 | 7939.4 samples/s | 31.0 steps/s
[Step= 250] | Loss=0.13389 | acc=0.9785 | tpr=0.9520 | fpr=0.0210 | 7902.3 samples/s | 30.9 steps/s
[Step= 300] | Loss=0.13667 | acc=0.9782 | tpr=0.9535 | fpr=0.0214 | 7865.8 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.13742 | acc=0.9779 | tpr=0.9549 | fpr=0.0217 | 8293.9 samples/s | 32.4 steps/s
[Step= 400] | Loss=0.13836 | acc=0.9777 | tpr=0.9513 | fpr=0.0218 | 8008.4 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.14147 | acc=0.9775 | tpr=0.9513 | fpr=0.0221 | 7896.1 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.14090 | acc=0.9775 | tpr=0.9515 | fpr=0.0220 | 7998.9 samples/s | 31.2 steps/s
[Step= 550] | Loss=0.14004 | acc=0.9777 | tpr=0.9507 | fpr=0.0218 | 14585.7 samples/s | 57.0 steps/s
Avg test loss: 0.13981, Avg test acc: 0.97766, Avg tpr: 0.95048, Avg fpr: 0.02184, total FA: 3033

server round 48/50

clients selected: [0 2 3 5 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=42001 Epoch=204.8] | Loss=0.01621 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.891 | L2-Norm(final)=12.364 | 3533.4 samples/s | 55.2 steps/s
[Step=42050 Epoch=205.0] | Loss=0.02639 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.896 | L2-Norm(final)=12.363 | 4719.5 samples/s | 73.7 steps/s
[Step=42100 Epoch=205.3] | Loss=0.02365 | Reg=0.00079 | acc=0.9688 | L2-Norm=8.901 | L2-Norm(final)=12.364 | 5155.9 samples/s | 80.6 steps/s
[Step=42150 Epoch=205.5] | Loss=0.02347 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.904 | L2-Norm(final)=12.366 | 4892.4 samples/s | 76.4 steps/s
[Step=42200 Epoch=205.8] | Loss=0.02245 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.907 | L2-Norm(final)=12.368 | 7104.3 samples/s | 111.0 steps/s
[Step=42250 Epoch=206.0] | Loss=0.02152 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.910 | L2-Norm(final)=12.370 | 1783.0 samples/s | 27.9 steps/s
[Step=42300 Epoch=206.3] | Loss=0.02122 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.913 | L2-Norm(final)=12.373 | 5196.0 samples/s | 81.2 steps/s
[Step=42350 Epoch=206.5] | Loss=0.02085 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.916 | L2-Norm(final)=12.376 | 5141.4 samples/s | 80.3 steps/s
[Step=42400 Epoch=206.8] | Loss=0.02053 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.919 | L2-Norm(final)=12.378 | 6654.2 samples/s | 104.0 steps/s
[Step=42450 Epoch=207.0] | Loss=0.02026 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.922 | L2-Norm(final)=12.381 | 1921.0 samples/s | 30.0 steps/s
[Step=42500 Epoch=207.2] | Loss=0.01996 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.924 | L2-Norm(final)=12.384 | 5002.0 samples/s | 78.2 steps/s
All layers training...
LR=0.00006, len=1
[Step=42501 Epoch=207.2] | Loss=0.00330 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.953 | L2-Norm(final)=12.413 | 3889.8 samples/s | 60.8 steps/s
[Step=42550 Epoch=207.5] | Loss=0.01738 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.958 | L2-Norm(final)=12.415 | 4114.5 samples/s | 64.3 steps/s
[Step=42600 Epoch=207.7] | Loss=0.01741 | Reg=0.00080 | acc=0.9688 | L2-Norm=8.964 | L2-Norm(final)=12.418 | 4541.4 samples/s | 71.0 steps/s
[Step=42650 Epoch=208.0] | Loss=0.01611 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.970 | L2-Norm(final)=12.422 | 4651.3 samples/s | 72.7 steps/s
[Step=42700 Epoch=208.2] | Loss=0.01540 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.976 | L2-Norm(final)=12.425 | 6087.6 samples/s | 95.1 steps/s
[Step=42750 Epoch=208.5] | Loss=0.01410 | Reg=0.00081 | acc=0.9844 | L2-Norm=8.981 | L2-Norm(final)=12.429 | 1760.1 samples/s | 27.5 steps/s
[Step=42800 Epoch=208.7] | Loss=0.01294 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.986 | L2-Norm(final)=12.432 | 4556.4 samples/s | 71.2 steps/s
[Step=42850 Epoch=208.9] | Loss=0.01208 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.991 | L2-Norm(final)=12.436 | 4589.5 samples/s | 71.7 steps/s
[Step=42900 Epoch=209.2] | Loss=0.01170 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.995 | L2-Norm(final)=12.439 | 5773.1 samples/s | 90.2 steps/s
[Step=42950 Epoch=209.4] | Loss=0.01119 | Reg=0.00081 | acc=0.9844 | L2-Norm=9.000 | L2-Norm(final)=12.442 | 1826.9 samples/s | 28.5 steps/s
[Step=43000 Epoch=209.7] | Loss=0.01062 | Reg=0.00081 | acc=0.9844 | L2-Norm=9.004 | L2-Norm(final)=12.446 | 4727.6 samples/s | 73.9 steps/s
[Step=43050 Epoch=209.9] | Loss=0.01013 | Reg=0.00081 | acc=0.9844 | L2-Norm=9.009 | L2-Norm(final)=12.449 | 4687.5 samples/s | 73.2 steps/s
[Step=43100 Epoch=210.2] | Loss=0.00976 | Reg=0.00081 | acc=0.9844 | L2-Norm=9.013 | L2-Norm(final)=12.452 | 5434.4 samples/s | 84.9 steps/s
[Step=43150 Epoch=210.4] | Loss=0.00948 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.017 | L2-Norm(final)=12.455 | 1802.8 samples/s | 28.2 steps/s
[Step=43200 Epoch=210.7] | Loss=0.00918 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.020 | L2-Norm(final)=12.458 | 4793.4 samples/s | 74.9 steps/s
[Step=43250 Epoch=210.9] | Loss=0.00889 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.024 | L2-Norm(final)=12.461 | 4507.9 samples/s | 70.4 steps/s
[Step=43300 Epoch=211.1] | Loss=0.00864 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.028 | L2-Norm(final)=12.464 | 4862.2 samples/s | 76.0 steps/s
[Step=43350 Epoch=211.4] | Loss=0.00839 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.031 | L2-Norm(final)=12.467 | 1853.2 samples/s | 29.0 steps/s
[Step=43400 Epoch=211.6] | Loss=0.00822 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.035 | L2-Norm(final)=12.470 | 4546.1 samples/s | 71.0 steps/s
[Step=43450 Epoch=211.9] | Loss=0.00804 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.038 | L2-Norm(final)=12.473 | 4519.9 samples/s | 70.6 steps/s
[Step=43500 Epoch=212.1] | Loss=0.00785 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.042 | L2-Norm(final)=12.476 | 4719.9 samples/s | 73.7 steps/s
[Step=43550 Epoch=212.4] | Loss=0.00768 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.045 | L2-Norm(final)=12.478 | 1909.6 samples/s | 29.8 steps/s
[Step=43600 Epoch=212.6] | Loss=0.00754 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.048 | L2-Norm(final)=12.481 | 4811.2 samples/s | 75.2 steps/s
[Step=43650 Epoch=212.8] | Loss=0.00741 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.051 | L2-Norm(final)=12.484 | 4610.5 samples/s | 72.0 steps/s
[Step=43700 Epoch=213.1] | Loss=0.00727 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.054 | L2-Norm(final)=12.486 | 4715.9 samples/s | 73.7 steps/s
[Step=43750 Epoch=213.3] | Loss=0.00713 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.058 | L2-Norm(final)=12.489 | 1921.9 samples/s | 30.0 steps/s
[Step=43800 Epoch=213.6] | Loss=0.00698 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.061 | L2-Norm(final)=12.492 | 4731.9 samples/s | 73.9 steps/s
[Step=43850 Epoch=213.8] | Loss=0.00691 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.064 | L2-Norm(final)=12.494 | 4618.9 samples/s | 72.2 steps/s
[Step=43900 Epoch=214.1] | Loss=0.00679 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.066 | L2-Norm(final)=12.497 | 4602.3 samples/s | 71.9 steps/s
[Step=43950 Epoch=214.3] | Loss=0.00666 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.069 | L2-Norm(final)=12.499 | 1906.3 samples/s | 29.8 steps/s
[Step=44000 Epoch=214.6] | Loss=0.00652 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.072 | L2-Norm(final)=12.502 | 4604.6 samples/s | 71.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step44000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=46001 Epoch=224.1] | Loss=0.05683 | Reg=0.00079 | acc=0.9688 | L2-Norm=8.891 | L2-Norm(final)=13.917 | 3734.2 samples/s | 58.3 steps/s
[Step=46050 Epoch=224.4] | Loss=0.02772 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.895 | L2-Norm(final)=13.914 | 4863.8 samples/s | 76.0 steps/s
[Step=46100 Epoch=224.6] | Loss=0.02711 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.899 | L2-Norm(final)=13.913 | 5143.8 samples/s | 80.4 steps/s
[Step=46150 Epoch=224.9] | Loss=0.02526 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.903 | L2-Norm(final)=13.913 | 4771.8 samples/s | 74.6 steps/s
[Step=46200 Epoch=225.1] | Loss=0.02469 | Reg=0.00079 | acc=0.9688 | L2-Norm=8.906 | L2-Norm(final)=13.915 | 6617.2 samples/s | 103.4 steps/s
[Step=46250 Epoch=225.4] | Loss=0.02399 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.910 | L2-Norm(final)=13.916 | 1767.7 samples/s | 27.6 steps/s
[Step=46300 Epoch=225.6] | Loss=0.02332 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.914 | L2-Norm(final)=13.918 | 5070.7 samples/s | 79.2 steps/s
[Step=46350 Epoch=225.8] | Loss=0.02256 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.917 | L2-Norm(final)=13.920 | 5207.9 samples/s | 81.4 steps/s
[Step=46400 Epoch=226.1] | Loss=0.02221 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.920 | L2-Norm(final)=13.922 | 6595.0 samples/s | 103.0 steps/s
[Step=46450 Epoch=226.3] | Loss=0.02185 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.924 | L2-Norm(final)=13.924 | 1827.6 samples/s | 28.6 steps/s
[Step=46500 Epoch=226.6] | Loss=0.02163 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.927 | L2-Norm(final)=13.926 | 5065.4 samples/s | 79.1 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=226.6] | Loss=0.01754 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.959 | L2-Norm(final)=13.950 | 3876.8 samples/s | 60.6 steps/s
[Step=46550 Epoch=226.8] | Loss=0.01873 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.966 | L2-Norm(final)=13.953 | 4126.2 samples/s | 64.5 steps/s
[Step=46600 Epoch=227.1] | Loss=0.01803 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.971 | L2-Norm(final)=13.955 | 4655.7 samples/s | 72.7 steps/s
[Step=46650 Epoch=227.3] | Loss=0.01745 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.977 | L2-Norm(final)=13.958 | 4532.4 samples/s | 70.8 steps/s
[Step=46700 Epoch=227.5] | Loss=0.01683 | Reg=0.00081 | acc=0.9844 | L2-Norm=8.982 | L2-Norm(final)=13.961 | 5919.6 samples/s | 92.5 steps/s
[Step=46750 Epoch=227.8] | Loss=0.01508 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.987 | L2-Norm(final)=13.964 | 1833.7 samples/s | 28.7 steps/s
[Step=46800 Epoch=228.0] | Loss=0.01372 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.992 | L2-Norm(final)=13.967 | 4917.7 samples/s | 76.8 steps/s
[Step=46850 Epoch=228.3] | Loss=0.01280 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.997 | L2-Norm(final)=13.970 | 4762.0 samples/s | 74.4 steps/s
[Step=46900 Epoch=228.5] | Loss=0.01213 | Reg=0.00081 | acc=0.9688 | L2-Norm=9.001 | L2-Norm(final)=13.973 | 5593.0 samples/s | 87.4 steps/s
[Step=46950 Epoch=228.8] | Loss=0.01142 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.005 | L2-Norm(final)=13.976 | 1781.0 samples/s | 27.8 steps/s
[Step=47000 Epoch=229.0] | Loss=0.01086 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.009 | L2-Norm(final)=13.978 | 4575.9 samples/s | 71.5 steps/s
[Step=47050 Epoch=229.3] | Loss=0.01039 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.013 | L2-Norm(final)=13.981 | 4547.6 samples/s | 71.1 steps/s
[Step=47100 Epoch=229.5] | Loss=0.01005 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.017 | L2-Norm(final)=13.984 | 5162.8 samples/s | 80.7 steps/s
[Step=47150 Epoch=229.7] | Loss=0.00967 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.020 | L2-Norm(final)=13.987 | 1832.6 samples/s | 28.6 steps/s
[Step=47200 Epoch=230.0] | Loss=0.00928 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.024 | L2-Norm(final)=13.990 | 4555.2 samples/s | 71.2 steps/s
[Step=47250 Epoch=230.2] | Loss=0.00896 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.027 | L2-Norm(final)=13.992 | 4527.2 samples/s | 70.7 steps/s
[Step=47300 Epoch=230.5] | Loss=0.00881 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.031 | L2-Norm(final)=13.995 | 4950.2 samples/s | 77.3 steps/s
[Step=47350 Epoch=230.7] | Loss=0.00853 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.034 | L2-Norm(final)=13.998 | 1878.0 samples/s | 29.3 steps/s
[Step=47400 Epoch=231.0] | Loss=0.00837 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.037 | L2-Norm(final)=14.000 | 4622.7 samples/s | 72.2 steps/s
[Step=47450 Epoch=231.2] | Loss=0.00816 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.040 | L2-Norm(final)=14.003 | 4579.0 samples/s | 71.5 steps/s
[Step=47500 Epoch=231.4] | Loss=0.00793 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.044 | L2-Norm(final)=14.005 | 4768.5 samples/s | 74.5 steps/s
[Step=47550 Epoch=231.7] | Loss=0.00777 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.047 | L2-Norm(final)=14.008 | 1941.7 samples/s | 30.3 steps/s
[Step=47600 Epoch=231.9] | Loss=0.00762 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.050 | L2-Norm(final)=14.010 | 4692.0 samples/s | 73.3 steps/s
[Step=47650 Epoch=232.2] | Loss=0.00742 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.053 | L2-Norm(final)=14.013 | 4731.8 samples/s | 73.9 steps/s
[Step=47700 Epoch=232.4] | Loss=0.00729 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.056 | L2-Norm(final)=14.015 | 4677.5 samples/s | 73.1 steps/s
[Step=47750 Epoch=232.7] | Loss=0.00713 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.059 | L2-Norm(final)=14.018 | 1951.2 samples/s | 30.5 steps/s
[Step=47800 Epoch=232.9] | Loss=0.00698 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.062 | L2-Norm(final)=14.020 | 4600.8 samples/s | 71.9 steps/s
[Step=47850 Epoch=233.1] | Loss=0.00687 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.064 | L2-Norm(final)=14.023 | 4637.2 samples/s | 72.5 steps/s
[Step=47900 Epoch=233.4] | Loss=0.00676 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.067 | L2-Norm(final)=14.025 | 4635.7 samples/s | 72.4 steps/s
[Step=47950 Epoch=233.6] | Loss=0.00665 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.070 | L2-Norm(final)=14.027 | 1951.7 samples/s | 30.5 steps/s
[Step=48000 Epoch=233.9] | Loss=0.00650 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.073 | L2-Norm(final)=14.030 | 4527.0 samples/s | 70.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_2/client_state-step48000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=50001 Epoch=243.8] | Loss=0.00546 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.891 | L2-Norm(final)=13.785 | 3711.0 samples/s | 58.0 steps/s
[Step=50050 Epoch=244.1] | Loss=0.02845 | Reg=0.00079 | acc=0.9375 | L2-Norm=8.895 | L2-Norm(final)=13.784 | 4927.4 samples/s | 77.0 steps/s
[Step=50100 Epoch=244.3] | Loss=0.02669 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.898 | L2-Norm(final)=13.783 | 5054.2 samples/s | 79.0 steps/s
[Step=50150 Epoch=244.6] | Loss=0.02591 | Reg=0.00079 | acc=0.9688 | L2-Norm=8.901 | L2-Norm(final)=13.784 | 5146.6 samples/s | 80.4 steps/s
[Step=50200 Epoch=244.8] | Loss=0.02557 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.905 | L2-Norm(final)=13.784 | 6910.3 samples/s | 108.0 steps/s
[Step=50250 Epoch=245.0] | Loss=0.02449 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.908 | L2-Norm(final)=13.786 | 1753.5 samples/s | 27.4 steps/s
[Step=50300 Epoch=245.3] | Loss=0.02421 | Reg=0.00079 | acc=0.9531 | L2-Norm=8.911 | L2-Norm(final)=13.787 | 5232.7 samples/s | 81.8 steps/s
[Step=50350 Epoch=245.5] | Loss=0.02343 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.915 | L2-Norm(final)=13.789 | 5141.9 samples/s | 80.3 steps/s
[Step=50400 Epoch=245.8] | Loss=0.02265 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.918 | L2-Norm(final)=13.791 | 6769.4 samples/s | 105.8 steps/s
[Step=50450 Epoch=246.0] | Loss=0.02197 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.921 | L2-Norm(final)=13.794 | 1864.1 samples/s | 29.1 steps/s
[Step=50500 Epoch=246.3] | Loss=0.02143 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.925 | L2-Norm(final)=13.796 | 5017.6 samples/s | 78.4 steps/s
All layers training...
LR=0.00006, len=1
[Step=50501 Epoch=246.3] | Loss=0.00890 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.957 | L2-Norm(final)=13.821 | 3615.2 samples/s | 56.5 steps/s
[Step=50550 Epoch=246.5] | Loss=0.01888 | Reg=0.00080 | acc=1.0000 | L2-Norm=8.963 | L2-Norm(final)=13.824 | 4568.8 samples/s | 71.4 steps/s
[Step=50600 Epoch=246.8] | Loss=0.01691 | Reg=0.00080 | acc=0.9844 | L2-Norm=8.969 | L2-Norm(final)=13.826 | 4581.8 samples/s | 71.6 steps/s
[Step=50650 Epoch=247.0] | Loss=0.01614 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.975 | L2-Norm(final)=13.829 | 4629.8 samples/s | 72.3 steps/s
[Step=50700 Epoch=247.2] | Loss=0.01522 | Reg=0.00081 | acc=0.9688 | L2-Norm=8.981 | L2-Norm(final)=13.832 | 6273.2 samples/s | 98.0 steps/s
[Step=50750 Epoch=247.5] | Loss=0.01395 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.986 | L2-Norm(final)=13.835 | 1753.4 samples/s | 27.4 steps/s
[Step=50800 Epoch=247.7] | Loss=0.01290 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.990 | L2-Norm(final)=13.838 | 4647.0 samples/s | 72.6 steps/s
[Step=50850 Epoch=248.0] | Loss=0.01221 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.995 | L2-Norm(final)=13.841 | 4727.5 samples/s | 73.9 steps/s
[Step=50900 Epoch=248.2] | Loss=0.01162 | Reg=0.00081 | acc=1.0000 | L2-Norm=8.999 | L2-Norm(final)=13.844 | 5700.1 samples/s | 89.1 steps/s
[Step=50950 Epoch=248.5] | Loss=0.01098 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.003 | L2-Norm(final)=13.847 | 1796.8 samples/s | 28.1 steps/s
[Step=51000 Epoch=248.7] | Loss=0.01050 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.007 | L2-Norm(final)=13.850 | 4576.2 samples/s | 71.5 steps/s
[Step=51050 Epoch=248.9] | Loss=0.01001 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.010 | L2-Norm(final)=13.853 | 4597.2 samples/s | 71.8 steps/s
[Step=51100 Epoch=249.2] | Loss=0.00969 | Reg=0.00081 | acc=0.9844 | L2-Norm=9.014 | L2-Norm(final)=13.855 | 5351.3 samples/s | 83.6 steps/s
[Step=51150 Epoch=249.4] | Loss=0.00929 | Reg=0.00081 | acc=0.9844 | L2-Norm=9.018 | L2-Norm(final)=13.858 | 1793.7 samples/s | 28.0 steps/s
[Step=51200 Epoch=249.7] | Loss=0.00890 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.021 | L2-Norm(final)=13.861 | 4670.4 samples/s | 73.0 steps/s
[Step=51250 Epoch=249.9] | Loss=0.00861 | Reg=0.00081 | acc=1.0000 | L2-Norm=9.024 | L2-Norm(final)=13.863 | 4533.9 samples/s | 70.8 steps/s
[Step=51300 Epoch=250.2] | Loss=0.00837 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.028 | L2-Norm(final)=13.866 | 5011.1 samples/s | 78.3 steps/s
[Step=51350 Epoch=250.4] | Loss=0.00820 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.031 | L2-Norm(final)=13.869 | 1856.0 samples/s | 29.0 steps/s
[Step=51400 Epoch=250.7] | Loss=0.00796 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.034 | L2-Norm(final)=13.871 | 4589.5 samples/s | 71.7 steps/s
[Step=51450 Epoch=250.9] | Loss=0.00778 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.037 | L2-Norm(final)=13.874 | 4624.5 samples/s | 72.3 steps/s
[Step=51500 Epoch=251.1] | Loss=0.00754 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.040 | L2-Norm(final)=13.876 | 4691.4 samples/s | 73.3 steps/s
[Step=51550 Epoch=251.4] | Loss=0.00743 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.043 | L2-Norm(final)=13.879 | 1914.9 samples/s | 29.9 steps/s
[Step=51600 Epoch=251.6] | Loss=0.00724 | Reg=0.00082 | acc=0.9844 | L2-Norm=9.046 | L2-Norm(final)=13.881 | 4758.4 samples/s | 74.4 steps/s
[Step=51650 Epoch=251.9] | Loss=0.00709 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.049 | L2-Norm(final)=13.883 | 4649.0 samples/s | 72.6 steps/s
[Step=51700 Epoch=252.1] | Loss=0.00696 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.052 | L2-Norm(final)=13.886 | 4556.6 samples/s | 71.2 steps/s
[Step=51750 Epoch=252.4] | Loss=0.00679 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.055 | L2-Norm(final)=13.888 | 1918.0 samples/s | 30.0 steps/s
[Step=51800 Epoch=252.6] | Loss=0.00664 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.058 | L2-Norm(final)=13.890 | 4608.4 samples/s | 72.0 steps/s
[Step=51850 Epoch=252.8] | Loss=0.00655 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.060 | L2-Norm(final)=13.893 | 4440.2 samples/s | 69.4 steps/s
[Step=51900 Epoch=253.1] | Loss=0.00644 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.063 | L2-Norm(final)=13.895 | 4518.6 samples/s | 70.6 steps/s
[Step=51950 Epoch=253.3] | Loss=0.00632 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.066 | L2-Norm(final)=13.897 | 1916.7 samples/s | 29.9 steps/s
[Step=52000 Epoch=253.6] | Loss=0.00620 | Reg=0.00082 | acc=1.0000 | L2-Norm=9.068 | L2-Norm(final)=13.900 | 4678.2 samples/s | 73.1 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step52000.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=36001 Epoch=341.1] | Loss=0.00448 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.891 | L2-Norm(final)=7.786 | 3794.2 samples/s | 59.3 steps/s
[Step=36050 Epoch=341.6] | Loss=0.00082 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.892 | L2-Norm(final)=7.787 | 4455.3 samples/s | 69.6 steps/s
[Step=36100 Epoch=342.1] | Loss=0.00049 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.893 | L2-Norm(final)=7.791 | 6686.0 samples/s | 104.5 steps/s
[Step=36150 Epoch=342.6] | Loss=0.00037 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.893 | L2-Norm(final)=7.795 | 1732.2 samples/s | 27.1 steps/s
[Step=36200 Epoch=343.0] | Loss=0.00030 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.893 | L2-Norm(final)=7.798 | 6298.2 samples/s | 98.4 steps/s
[Step=36250 Epoch=343.5] | Loss=0.00025 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.893 | L2-Norm(final)=7.801 | 1795.7 samples/s | 28.1 steps/s
[Step=36300 Epoch=344.0] | Loss=0.00022 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.892 | L2-Norm(final)=7.803 | 5767.1 samples/s | 90.1 steps/s
[Step=36350 Epoch=344.4] | Loss=0.00020 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.891 | L2-Norm(final)=7.806 | 1808.4 samples/s | 28.3 steps/s
[Step=36400 Epoch=344.9] | Loss=0.00018 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.890 | L2-Norm(final)=7.809 | 5393.9 samples/s | 84.3 steps/s
[Step=36450 Epoch=345.4] | Loss=0.00017 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.889 | L2-Norm(final)=7.811 | 1922.1 samples/s | 30.0 steps/s
[Step=36500 Epoch=345.9] | Loss=0.00016 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.888 | L2-Norm(final)=7.814 | 4981.2 samples/s | 77.8 steps/s
All layers training...
LR=0.00006, len=1
[Step=36501 Epoch=345.9] | Loss=0.00016 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.877 | L2-Norm(final)=7.838 | 3615.6 samples/s | 56.5 steps/s
[Step=36550 Epoch=346.3] | Loss=0.00005 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.873 | L2-Norm(final)=7.840 | 4341.2 samples/s | 67.8 steps/s
[Step=36600 Epoch=346.8] | Loss=0.00004 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.868 | L2-Norm(final)=7.841 | 5977.9 samples/s | 93.4 steps/s
[Step=36650 Epoch=347.3] | Loss=0.00003 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.860 | L2-Norm(final)=7.842 | 1703.3 samples/s | 26.6 steps/s
[Step=36700 Epoch=347.8] | Loss=0.00002 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.852 | L2-Norm(final)=7.843 | 5430.2 samples/s | 84.8 steps/s
[Step=36750 Epoch=348.2] | Loss=0.00002 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.843 | L2-Norm(final)=7.843 | 1734.5 samples/s | 27.1 steps/s
[Step=36800 Epoch=348.7] | Loss=0.00001 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.833 | L2-Norm(final)=7.844 | 5137.8 samples/s | 80.3 steps/s
[Step=36850 Epoch=349.2] | Loss=0.00001 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.823 | L2-Norm(final)=7.844 | 1785.9 samples/s | 27.9 steps/s
[Step=36900 Epoch=349.7] | Loss=0.00001 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.813 | L2-Norm(final)=7.844 | 4784.1 samples/s | 74.8 steps/s
[Step=36950 Epoch=350.1] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.803 | L2-Norm(final)=7.844 | 1821.3 samples/s | 28.5 steps/s
[Step=37000 Epoch=350.6] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.792 | L2-Norm(final)=7.845 | 4473.8 samples/s | 69.9 steps/s
[Step=37050 Epoch=351.1] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.781 | L2-Norm(final)=7.845 | 1805.4 samples/s | 28.2 steps/s
[Step=37100 Epoch=351.6] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.770 | L2-Norm(final)=7.845 | 4299.1 samples/s | 67.2 steps/s
[Step=37150 Epoch=352.0] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.759 | L2-Norm(final)=7.845 | 1890.6 samples/s | 29.5 steps/s
[Step=37200 Epoch=352.5] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.748 | L2-Norm(final)=7.845 | 4294.0 samples/s | 67.1 steps/s
[Step=37250 Epoch=353.0] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.737 | L2-Norm(final)=7.846 | 1877.7 samples/s | 29.3 steps/s
[Step=37300 Epoch=353.4] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.725 | L2-Norm(final)=7.846 | 4439.0 samples/s | 69.4 steps/s
[Step=37350 Epoch=353.9] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.713 | L2-Norm(final)=7.846 | 1884.7 samples/s | 29.4 steps/s
[Step=37400 Epoch=354.4] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.702 | L2-Norm(final)=7.846 | 4411.2 samples/s | 68.9 steps/s
[Step=37450 Epoch=354.9] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.690 | L2-Norm(final)=7.846 | 5876.5 samples/s | 91.8 steps/s
[Step=37500 Epoch=355.3] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.677 | L2-Norm(final)=7.847 | 1694.2 samples/s | 26.5 steps/s
[Step=37550 Epoch=355.8] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.665 | L2-Norm(final)=7.847 | 5624.7 samples/s | 87.9 steps/s
[Step=37600 Epoch=356.3] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.653 | L2-Norm(final)=7.847 | 1734.6 samples/s | 27.1 steps/s
[Step=37650 Epoch=356.8] | Loss=0.00001 | Reg=0.00075 | acc=1.0000 | L2-Norm=8.640 | L2-Norm(final)=7.847 | 5260.1 samples/s | 82.2 steps/s
[Step=37700 Epoch=357.2] | Loss=0.00001 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.627 | L2-Norm(final)=7.847 | 1790.2 samples/s | 28.0 steps/s
[Step=37750 Epoch=357.7] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.614 | L2-Norm(final)=7.847 | 4818.1 samples/s | 75.3 steps/s
[Step=37800 Epoch=358.2] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.601 | L2-Norm(final)=7.848 | 1806.4 samples/s | 28.2 steps/s
[Step=37850 Epoch=358.7] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.588 | L2-Norm(final)=7.848 | 4552.3 samples/s | 71.1 steps/s
[Step=37900 Epoch=359.1] | Loss=0.00000 | Reg=0.00074 | acc=1.0000 | L2-Norm=8.575 | L2-Norm(final)=7.848 | 1856.8 samples/s | 29.0 steps/s
[Step=37950 Epoch=359.6] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.561 | L2-Norm(final)=7.848 | 4274.0 samples/s | 66.8 steps/s
[Step=38000 Epoch=360.1] | Loss=0.00000 | Reg=0.00073 | acc=1.0000 | L2-Norm=8.548 | L2-Norm(final)=7.848 | 1874.8 samples/s | 29.3 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_0/client_state-step38000.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=46001 Epoch=439.3] | Loss=0.00049 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.891 | L2-Norm(final)=8.748 | 3607.5 samples/s | 56.4 steps/s
[Step=46050 Epoch=439.7] | Loss=0.00068 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.888 | L2-Norm(final)=8.749 | 4515.6 samples/s | 70.6 steps/s
[Step=46100 Epoch=440.2] | Loss=0.00039 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.890 | L2-Norm(final)=8.751 | 7036.6 samples/s | 109.9 steps/s
[Step=46150 Epoch=440.7] | Loss=0.00028 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.890 | L2-Norm(final)=8.753 | 1744.8 samples/s | 27.3 steps/s
[Step=46200 Epoch=441.2] | Loss=0.00023 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.889 | L2-Norm(final)=8.755 | 6553.8 samples/s | 102.4 steps/s
[Step=46250 Epoch=441.7] | Loss=0.00020 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.888 | L2-Norm(final)=8.757 | 1806.1 samples/s | 28.2 steps/s
[Step=46300 Epoch=442.1] | Loss=0.00017 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.888 | L2-Norm(final)=8.759 | 6073.3 samples/s | 94.9 steps/s
[Step=46350 Epoch=442.6] | Loss=0.00016 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.887 | L2-Norm(final)=8.761 | 1791.8 samples/s | 28.0 steps/s
[Step=46400 Epoch=443.1] | Loss=0.00014 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.886 | L2-Norm(final)=8.763 | 5585.3 samples/s | 87.3 steps/s
[Step=46450 Epoch=443.6] | Loss=0.00013 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.884 | L2-Norm(final)=8.764 | 1878.3 samples/s | 29.3 steps/s
[Step=46500 Epoch=444.0] | Loss=0.00012 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.883 | L2-Norm(final)=8.766 | 5304.0 samples/s | 82.9 steps/s
All layers training...
LR=0.00006, len=1
[Step=46501 Epoch=444.1] | Loss=0.00005 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.872 | L2-Norm(final)=8.782 | 3602.7 samples/s | 56.3 steps/s
[Step=46550 Epoch=444.5] | Loss=0.00008 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.870 | L2-Norm(final)=8.784 | 4114.6 samples/s | 64.3 steps/s
[Step=46600 Epoch=445.0] | Loss=0.00007 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.868 | L2-Norm(final)=8.786 | 5858.9 samples/s | 91.5 steps/s
[Step=46650 Epoch=445.5] | Loss=0.00005 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.866 | L2-Norm(final)=8.787 | 1687.1 samples/s | 26.4 steps/s
[Step=46700 Epoch=446.0] | Loss=0.00004 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.862 | L2-Norm(final)=8.788 | 5644.0 samples/s | 88.2 steps/s
[Step=46750 Epoch=446.4] | Loss=0.00003 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.859 | L2-Norm(final)=8.789 | 1731.7 samples/s | 27.1 steps/s
[Step=46800 Epoch=446.9] | Loss=0.00003 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.854 | L2-Norm(final)=8.789 | 5254.5 samples/s | 82.1 steps/s
[Step=46850 Epoch=447.4] | Loss=0.00003 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.850 | L2-Norm(final)=8.789 | 1772.5 samples/s | 27.7 steps/s
[Step=46900 Epoch=447.9] | Loss=0.00002 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.845 | L2-Norm(final)=8.790 | 4938.5 samples/s | 77.2 steps/s
[Step=46950 Epoch=448.3] | Loss=0.00002 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.840 | L2-Norm(final)=8.790 | 1796.4 samples/s | 28.1 steps/s
[Step=47000 Epoch=448.8] | Loss=0.00002 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.835 | L2-Norm(final)=8.790 | 4696.5 samples/s | 73.4 steps/s
[Step=47050 Epoch=449.3] | Loss=0.00002 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.830 | L2-Norm(final)=8.790 | 1832.8 samples/s | 28.6 steps/s
[Step=47100 Epoch=449.8] | Loss=0.00002 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.825 | L2-Norm(final)=8.791 | 4450.1 samples/s | 69.5 steps/s
[Step=47150 Epoch=450.3] | Loss=0.00001 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.819 | L2-Norm(final)=8.791 | 1856.2 samples/s | 29.0 steps/s
[Step=47200 Epoch=450.7] | Loss=0.00001 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.813 | L2-Norm(final)=8.791 | 4467.3 samples/s | 69.8 steps/s
[Step=47250 Epoch=451.2] | Loss=0.00001 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.808 | L2-Norm(final)=8.791 | 1887.5 samples/s | 29.5 steps/s
[Step=47300 Epoch=451.7] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.802 | L2-Norm(final)=8.791 | 4395.3 samples/s | 68.7 steps/s
[Step=47350 Epoch=452.2] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.796 | L2-Norm(final)=8.792 | 1854.0 samples/s | 29.0 steps/s
[Step=47400 Epoch=452.6] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.790 | L2-Norm(final)=8.792 | 4524.8 samples/s | 70.7 steps/s
[Step=47450 Epoch=453.1] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.784 | L2-Norm(final)=8.792 | 1850.0 samples/s | 28.9 steps/s
[Step=47500 Epoch=453.6] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.778 | L2-Norm(final)=8.792 | 4357.8 samples/s | 68.1 steps/s
[Step=47550 Epoch=454.1] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.772 | L2-Norm(final)=8.792 | 6713.7 samples/s | 104.9 steps/s
[Step=47600 Epoch=454.6] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.765 | L2-Norm(final)=8.792 | 1643.9 samples/s | 25.7 steps/s
[Step=47650 Epoch=455.0] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.759 | L2-Norm(final)=8.793 | 6053.5 samples/s | 94.6 steps/s
[Step=47700 Epoch=455.5] | Loss=0.00001 | Reg=0.00077 | acc=1.0000 | L2-Norm=8.753 | L2-Norm(final)=8.793 | 1688.9 samples/s | 26.4 steps/s
[Step=47750 Epoch=456.0] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.746 | L2-Norm(final)=8.793 | 5601.4 samples/s | 87.5 steps/s
[Step=47800 Epoch=456.5] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.739 | L2-Norm(final)=8.793 | 1731.7 samples/s | 27.1 steps/s
[Step=47850 Epoch=456.9] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.732 | L2-Norm(final)=8.793 | 5245.6 samples/s | 82.0 steps/s
[Step=47900 Epoch=457.4] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.726 | L2-Norm(final)=8.793 | 1768.6 samples/s | 27.6 steps/s
[Step=47950 Epoch=457.9] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.719 | L2-Norm(final)=8.794 | 4994.8 samples/s | 78.0 steps/s
[Step=48000 Epoch=458.4] | Loss=0.00001 | Reg=0.00076 | acc=1.0000 | L2-Norm=8.711 | L2-Norm(final)=8.794 | 1771.7 samples/s | 27.7 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step48000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.07518 | acc=0.9626 | tpr=0.9714 | fpr=0.0565 | 4105.3 samples/s | 16.0 steps/s
Avg test loss: 0.07765, Avg test acc: 0.96057, Avg tpr: 0.96987, Avg fpr: 0.05986, total FA: 467

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08208 | acc=0.9621 | tpr=0.9723 | fpr=0.0600 | 4059.9 samples/s | 15.9 steps/s
Avg test loss: 0.08497, Avg test acc: 0.96105, Avg tpr: 0.97080, Avg fpr: 0.06038, total FA: 471

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.07892 | acc=0.9613 | tpr=0.9702 | fpr=0.0582 | 4090.5 samples/s | 16.0 steps/s
Avg test loss: 0.08275, Avg test acc: 0.95965, Avg tpr: 0.96858, Avg fpr: 0.05999, total FA: 468

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.07418 | acc=0.9622 | tpr=0.9759 | fpr=0.0676 | 4076.9 samples/s | 15.9 steps/s
Avg test loss: 0.07771, Avg test acc: 0.96146, Avg tpr: 0.97535, Avg fpr: 0.06909, total FA: 539

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08155 | acc=0.9628 | tpr=0.9752 | fpr=0.0642 | 4122.9 samples/s | 16.1 steps/s
Avg test loss: 0.08931, Avg test acc: 0.96158, Avg tpr: 0.97377, Avg fpr: 0.06525, total FA: 509

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=5.23242 | acc=0.3031 | tpr=0.0021 | fpr=0.0431 | 4065.7 samples/s | 15.9 steps/s
Avg test loss: 5.24756, Avg test acc: 0.29878, Avg tpr: 0.00216, Avg fpr: 0.04884, total FA: 381

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.87879 | acc=0.3135 | tpr=0.0035 | fpr=0.0134 | 4229.1 samples/s | 16.5 steps/s
Avg test loss: 4.88892, Avg test acc: 0.31108, Avg tpr: 0.00408, Avg fpr: 0.01372, total FA: 107

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=5.03081 | acc=0.3006 | tpr=0.0067 | fpr=0.0612 | 4113.3 samples/s | 16.1 steps/s
Avg test loss: 5.04087, Avg test acc: 0.29818, Avg tpr: 0.00723, Avg fpr: 0.06192, total FA: 483

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.30152 | acc=0.3044 | tpr=0.0033 | fpr=0.0419 | 4144.8 samples/s | 16.2 steps/s
Avg test loss: 5.31793, Avg test acc: 0.30127, Avg tpr: 0.00425, Avg fpr: 0.04551, total FA: 355

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.85240 | acc=0.3139 | tpr=0.0030 | fpr=0.0109 | 4024.6 samples/s | 15.7 steps/s
Avg test loss: 4.86296, Avg test acc: 0.31128, Avg tpr: 0.00321, Avg fpr: 0.01115, total FA: 87

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=4.79011 | acc=0.1230 | tpr=0.8053 | fpr=0.8892 | 4065.3 samples/s | 15.9 steps/s
[Step= 100] | Loss=4.74001 | acc=0.1261 | tpr=0.7974 | fpr=0.8864 | 7836.9 samples/s | 30.6 steps/s
[Step= 150] | Loss=4.74055 | acc=0.1245 | tpr=0.8098 | fpr=0.8881 | 7802.6 samples/s | 30.5 steps/s
[Step= 200] | Loss=4.73917 | acc=0.1237 | tpr=0.8131 | fpr=0.8888 | 7971.9 samples/s | 31.1 steps/s
[Step= 250] | Loss=4.74294 | acc=0.1247 | tpr=0.8122 | fpr=0.8878 | 7779.7 samples/s | 30.4 steps/s
[Step= 300] | Loss=4.73790 | acc=0.1243 | tpr=0.8065 | fpr=0.8882 | 8111.0 samples/s | 31.7 steps/s
[Step= 350] | Loss=4.73573 | acc=0.1238 | tpr=0.8071 | fpr=0.8886 | 7926.6 samples/s | 31.0 steps/s
[Step= 400] | Loss=4.73746 | acc=0.1242 | tpr=0.8036 | fpr=0.8881 | 8018.7 samples/s | 31.3 steps/s
[Step= 450] | Loss=4.74035 | acc=0.1239 | tpr=0.7989 | fpr=0.8883 | 7869.6 samples/s | 30.7 steps/s
[Step= 500] | Loss=4.74273 | acc=0.1236 | tpr=0.7991 | fpr=0.8886 | 7941.2 samples/s | 31.0 steps/s
[Step= 550] | Loss=4.74150 | acc=0.1234 | tpr=0.8034 | fpr=0.8890 | 14910.4 samples/s | 58.2 steps/s
Avg test loss: 4.74294, Avg test acc: 0.12333, Avg tpr: 0.80309, Avg fpr: 0.88903, total FA: 123440

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.82086 | acc=0.1308 | tpr=0.8142 | fpr=0.8815 | 4043.4 samples/s | 15.8 steps/s
[Step= 100] | Loss=4.76944 | acc=0.1346 | tpr=0.8038 | fpr=0.8779 | 8025.2 samples/s | 31.3 steps/s
[Step= 150] | Loss=4.77257 | acc=0.1340 | tpr=0.8127 | fpr=0.8785 | 8205.1 samples/s | 32.1 steps/s
[Step= 200] | Loss=4.77303 | acc=0.1336 | tpr=0.8164 | fpr=0.8788 | 7857.6 samples/s | 30.7 steps/s
[Step= 250] | Loss=4.77403 | acc=0.1341 | tpr=0.8148 | fpr=0.8783 | 8184.9 samples/s | 32.0 steps/s
[Step= 300] | Loss=4.76958 | acc=0.1339 | tpr=0.8138 | fpr=0.8785 | 8090.7 samples/s | 31.6 steps/s
[Step= 350] | Loss=4.76516 | acc=0.1336 | tpr=0.8084 | fpr=0.8786 | 8151.9 samples/s | 31.8 steps/s
[Step= 400] | Loss=4.76696 | acc=0.1336 | tpr=0.8025 | fpr=0.8785 | 8136.9 samples/s | 31.8 steps/s
[Step= 450] | Loss=4.77202 | acc=0.1333 | tpr=0.7984 | fpr=0.8788 | 7775.3 samples/s | 30.4 steps/s
[Step= 500] | Loss=4.77681 | acc=0.1330 | tpr=0.7987 | fpr=0.8790 | 7794.8 samples/s | 30.4 steps/s
[Step= 550] | Loss=4.77477 | acc=0.1329 | tpr=0.8014 | fpr=0.8792 | 14611.7 samples/s | 57.1 steps/s
Avg test loss: 4.77605, Avg test acc: 0.13289, Avg tpr: 0.80071, Avg fpr: 0.87925, total FA: 122082

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.26442 | acc=0.1201 | tpr=0.7389 | fpr=0.8910 | 4161.8 samples/s | 16.3 steps/s
[Step= 100] | Loss=5.21164 | acc=0.1233 | tpr=0.7484 | fpr=0.8883 | 8034.3 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.21265 | acc=0.1219 | tpr=0.7666 | fpr=0.8900 | 8200.3 samples/s | 32.0 steps/s
[Step= 200] | Loss=5.21223 | acc=0.1211 | tpr=0.7716 | fpr=0.8908 | 8692.7 samples/s | 34.0 steps/s
[Step= 250] | Loss=5.21244 | acc=0.1217 | tpr=0.7668 | fpr=0.8900 | 7904.1 samples/s | 30.9 steps/s
[Step= 300] | Loss=5.20812 | acc=0.1212 | tpr=0.7680 | fpr=0.8906 | 7849.9 samples/s | 30.7 steps/s
[Step= 350] | Loss=5.20432 | acc=0.1210 | tpr=0.7702 | fpr=0.8908 | 8051.7 samples/s | 31.5 steps/s
[Step= 400] | Loss=5.20707 | acc=0.1213 | tpr=0.7664 | fpr=0.8904 | 8101.4 samples/s | 31.6 steps/s
[Step= 450] | Loss=5.21110 | acc=0.1210 | tpr=0.7624 | fpr=0.8906 | 7863.2 samples/s | 30.7 steps/s
[Step= 500] | Loss=5.21212 | acc=0.1211 | tpr=0.7648 | fpr=0.8906 | 7699.1 samples/s | 30.1 steps/s
[Step= 550] | Loss=5.21103 | acc=0.1209 | tpr=0.7676 | fpr=0.8909 | 14842.4 samples/s | 58.0 steps/s
Avg test loss: 5.21219, Avg test acc: 0.12084, Avg tpr: 0.76704, Avg fpr: 0.89091, total FA: 123701

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=4.93669 | acc=0.1225 | tpr=0.8097 | fpr=0.8899 | 4089.5 samples/s | 16.0 steps/s
[Step= 100] | Loss=4.88528 | acc=0.1240 | tpr=0.7953 | fpr=0.8885 | 8177.3 samples/s | 31.9 steps/s
[Step= 150] | Loss=4.88500 | acc=0.1224 | tpr=0.8055 | fpr=0.8902 | 8068.5 samples/s | 31.5 steps/s
[Step= 200] | Loss=4.88190 | acc=0.1215 | tpr=0.8087 | fpr=0.8910 | 7770.5 samples/s | 30.4 steps/s
[Step= 250] | Loss=4.88343 | acc=0.1222 | tpr=0.8079 | fpr=0.8903 | 8152.9 samples/s | 31.8 steps/s
[Step= 300] | Loss=4.87895 | acc=0.1214 | tpr=0.8029 | fpr=0.8910 | 8555.4 samples/s | 33.4 steps/s
[Step= 350] | Loss=4.87529 | acc=0.1211 | tpr=0.8009 | fpr=0.8912 | 7821.9 samples/s | 30.6 steps/s
[Step= 400] | Loss=4.87792 | acc=0.1212 | tpr=0.7970 | fpr=0.8910 | 7846.5 samples/s | 30.7 steps/s
[Step= 450] | Loss=4.88260 | acc=0.1209 | tpr=0.7945 | fpr=0.8913 | 8043.3 samples/s | 31.4 steps/s
[Step= 500] | Loss=4.88530 | acc=0.1208 | tpr=0.7978 | fpr=0.8914 | 7959.5 samples/s | 31.1 steps/s
[Step= 550] | Loss=4.88310 | acc=0.1205 | tpr=0.8018 | fpr=0.8919 | 14747.3 samples/s | 57.6 steps/s
Avg test loss: 4.88446, Avg test acc: 0.12046, Avg tpr: 0.80111, Avg fpr: 0.89191, total FA: 123840

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.27558 | acc=0.1270 | tpr=0.7345 | fpr=0.8840 | 4085.9 samples/s | 16.0 steps/s
[Step= 100] | Loss=5.22285 | acc=0.1293 | tpr=0.7122 | fpr=0.8816 | 8028.3 samples/s | 31.4 steps/s
[Step= 150] | Loss=5.22306 | acc=0.1277 | tpr=0.7104 | fpr=0.8831 | 7883.6 samples/s | 30.8 steps/s
[Step= 200] | Loss=5.22146 | acc=0.1272 | tpr=0.7093 | fpr=0.8834 | 8151.9 samples/s | 31.8 steps/s
[Step= 250] | Loss=5.22502 | acc=0.1280 | tpr=0.7092 | fpr=0.8826 | 8269.4 samples/s | 32.3 steps/s
[Step= 300] | Loss=5.21962 | acc=0.1274 | tpr=0.7120 | fpr=0.8832 | 7755.2 samples/s | 30.3 steps/s
[Step= 350] | Loss=5.21644 | acc=0.1267 | tpr=0.7101 | fpr=0.8838 | 8031.6 samples/s | 31.4 steps/s
[Step= 400] | Loss=5.21986 | acc=0.1270 | tpr=0.7084 | fpr=0.8836 | 7926.3 samples/s | 31.0 steps/s
[Step= 450] | Loss=5.22360 | acc=0.1264 | tpr=0.7020 | fpr=0.8841 | 7849.3 samples/s | 30.7 steps/s
[Step= 500] | Loss=5.22615 | acc=0.1261 | tpr=0.6982 | fpr=0.8842 | 7767.7 samples/s | 30.3 steps/s
[Step= 550] | Loss=5.22496 | acc=0.1259 | tpr=0.6968 | fpr=0.8845 | 13930.8 samples/s | 54.4 steps/s
Avg test loss: 5.22706, Avg test acc: 0.12580, Avg tpr: 0.69651, Avg fpr: 0.88457, total FA: 122821

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09415 | acc=0.9823 | tpr=0.9425 | fpr=0.0169 | 4024.4 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.09802 | acc=0.9818 | tpr=0.9531 | fpr=0.0177 | 7922.8 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.10150 | acc=0.9810 | tpr=0.9524 | fpr=0.0185 | 7969.9 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.10364 | acc=0.9809 | tpr=0.9585 | fpr=0.0187 | 7848.6 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.10320 | acc=0.9808 | tpr=0.9546 | fpr=0.0187 | 7823.4 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.10534 | acc=0.9805 | tpr=0.9542 | fpr=0.0190 | 8102.7 samples/s | 31.7 steps/s
[Step= 350] | Loss=0.10554 | acc=0.9803 | tpr=0.9543 | fpr=0.0192 | 8046.4 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.10653 | acc=0.9801 | tpr=0.9519 | fpr=0.0194 | 8309.0 samples/s | 32.5 steps/s
[Step= 450] | Loss=0.10915 | acc=0.9799 | tpr=0.9499 | fpr=0.0196 | 8219.6 samples/s | 32.1 steps/s
[Step= 500] | Loss=0.10893 | acc=0.9798 | tpr=0.9511 | fpr=0.0196 | 7547.6 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.10807 | acc=0.9800 | tpr=0.9507 | fpr=0.0195 | 14007.0 samples/s | 54.7 steps/s
Avg test loss: 0.10789, Avg test acc: 0.97998, Avg tpr: 0.95087, Avg fpr: 0.01949, total FA: 2706

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10809 | acc=0.9814 | tpr=0.9248 | fpr=0.0176 | 4060.4 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.11227 | acc=0.9816 | tpr=0.9403 | fpr=0.0176 | 8082.5 samples/s | 31.6 steps/s
[Step= 150] | Loss=0.11661 | acc=0.9805 | tpr=0.9337 | fpr=0.0186 | 7821.4 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.11837 | acc=0.9806 | tpr=0.9366 | fpr=0.0186 | 8141.4 samples/s | 31.8 steps/s
[Step= 250] | Loss=0.11756 | acc=0.9804 | tpr=0.9345 | fpr=0.0188 | 7876.2 samples/s | 30.8 steps/s
[Step= 300] | Loss=0.11986 | acc=0.9800 | tpr=0.9360 | fpr=0.0192 | 7402.5 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.12011 | acc=0.9798 | tpr=0.9374 | fpr=0.0194 | 7555.9 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.12107 | acc=0.9797 | tpr=0.9354 | fpr=0.0195 | 7046.2 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.12406 | acc=0.9794 | tpr=0.9338 | fpr=0.0198 | 6999.0 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.12365 | acc=0.9794 | tpr=0.9352 | fpr=0.0198 | 6973.5 samples/s | 27.2 steps/s
[Step= 550] | Loss=0.12280 | acc=0.9796 | tpr=0.9339 | fpr=0.0196 | 14866.2 samples/s | 58.1 steps/s
Avg test loss: 0.12257, Avg test acc: 0.97956, Avg tpr: 0.93384, Avg fpr: 0.01961, total FA: 2723

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.09977 | acc=0.9805 | tpr=0.9381 | fpr=0.0187 | 4065.1 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.10320 | acc=0.9805 | tpr=0.9552 | fpr=0.0190 | 8020.5 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.10717 | acc=0.9791 | tpr=0.9510 | fpr=0.0203 | 7852.4 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.10891 | acc=0.9792 | tpr=0.9563 | fpr=0.0204 | 7655.6 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.10838 | acc=0.9792 | tpr=0.9537 | fpr=0.0203 | 8416.2 samples/s | 32.9 steps/s
[Step= 300] | Loss=0.11077 | acc=0.9787 | tpr=0.9535 | fpr=0.0208 | 8005.1 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.11071 | acc=0.9786 | tpr=0.9537 | fpr=0.0209 | 8055.8 samples/s | 31.5 steps/s
[Step= 400] | Loss=0.11173 | acc=0.9785 | tpr=0.9513 | fpr=0.0210 | 7826.7 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.11426 | acc=0.9783 | tpr=0.9503 | fpr=0.0212 | 8054.7 samples/s | 31.5 steps/s
[Step= 500] | Loss=0.11394 | acc=0.9783 | tpr=0.9524 | fpr=0.0213 | 7860.9 samples/s | 30.7 steps/s
[Step= 550] | Loss=0.11295 | acc=0.9784 | tpr=0.9522 | fpr=0.0211 | 14093.0 samples/s | 55.1 steps/s
Avg test loss: 0.11280, Avg test acc: 0.97845, Avg tpr: 0.95246, Avg fpr: 0.02107, total FA: 2926

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10544 | acc=0.9813 | tpr=0.9425 | fpr=0.0180 | 4137.3 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.10975 | acc=0.9807 | tpr=0.9531 | fpr=0.0187 | 7721.2 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.11407 | acc=0.9800 | tpr=0.9524 | fpr=0.0195 | 8097.1 samples/s | 31.6 steps/s
[Step= 200] | Loss=0.11644 | acc=0.9800 | tpr=0.9585 | fpr=0.0196 | 8163.2 samples/s | 31.9 steps/s
[Step= 250] | Loss=0.11549 | acc=0.9800 | tpr=0.9546 | fpr=0.0195 | 7756.0 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.11727 | acc=0.9797 | tpr=0.9564 | fpr=0.0199 | 7892.4 samples/s | 30.8 steps/s
[Step= 350] | Loss=0.11749 | acc=0.9795 | tpr=0.9580 | fpr=0.0201 | 7867.7 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.11816 | acc=0.9794 | tpr=0.9562 | fpr=0.0202 | 8272.6 samples/s | 32.3 steps/s
[Step= 450] | Loss=0.12101 | acc=0.9792 | tpr=0.9557 | fpr=0.0204 | 7962.7 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.12062 | acc=0.9792 | tpr=0.9559 | fpr=0.0204 | 8264.6 samples/s | 32.3 steps/s
[Step= 550] | Loss=0.11971 | acc=0.9794 | tpr=0.9554 | fpr=0.0202 | 13092.2 samples/s | 51.1 steps/s
Avg test loss: 0.11953, Avg test acc: 0.97939, Avg tpr: 0.95563, Avg fpr: 0.02018, total FA: 2802

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12300 | acc=0.9802 | tpr=0.9292 | fpr=0.0188 | 4089.7 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.12753 | acc=0.9798 | tpr=0.9510 | fpr=0.0197 | 7955.8 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.13281 | acc=0.9786 | tpr=0.9524 | fpr=0.0209 | 8148.9 samples/s | 31.8 steps/s
[Step= 200] | Loss=0.13482 | acc=0.9784 | tpr=0.9563 | fpr=0.0212 | 7758.0 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.13389 | acc=0.9785 | tpr=0.9520 | fpr=0.0210 | 8076.1 samples/s | 31.5 steps/s
[Step= 300] | Loss=0.13667 | acc=0.9782 | tpr=0.9535 | fpr=0.0214 | 8000.3 samples/s | 31.3 steps/s
[Step= 350] | Loss=0.13742 | acc=0.9779 | tpr=0.9549 | fpr=0.0217 | 8090.9 samples/s | 31.6 steps/s
[Step= 400] | Loss=0.13836 | acc=0.9777 | tpr=0.9513 | fpr=0.0218 | 7834.8 samples/s | 30.6 steps/s
[Step= 450] | Loss=0.14147 | acc=0.9775 | tpr=0.9513 | fpr=0.0221 | 7900.7 samples/s | 30.9 steps/s
[Step= 500] | Loss=0.14090 | acc=0.9775 | tpr=0.9515 | fpr=0.0220 | 7884.3 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.14004 | acc=0.9777 | tpr=0.9507 | fpr=0.0218 | 13713.9 samples/s | 53.6 steps/s
Avg test loss: 0.13981, Avg test acc: 0.97766, Avg tpr: 0.95048, Avg fpr: 0.02184, total FA: 3033

server round 49/50

clients selected: [0 3 5 6 7]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=44001 Epoch=214.6] | Loss=0.05909 | Reg=0.00079 | acc=0.9688 | L2-Norm=8.865 | L2-Norm(final)=12.576 | 3962.1 samples/s | 61.9 steps/s
[Step=44050 Epoch=214.8] | Loss=0.02154 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.870 | L2-Norm(final)=12.574 | 4386.8 samples/s | 68.5 steps/s
[Step=44100 Epoch=215.0] | Loss=0.02170 | Reg=0.00079 | acc=0.9688 | L2-Norm=8.874 | L2-Norm(final)=12.576 | 5168.9 samples/s | 80.8 steps/s
[Step=44150 Epoch=215.3] | Loss=0.02291 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.878 | L2-Norm(final)=12.578 | 5263.3 samples/s | 82.2 steps/s
[Step=44200 Epoch=215.5] | Loss=0.02259 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.881 | L2-Norm(final)=12.580 | 7020.9 samples/s | 109.7 steps/s
[Step=44250 Epoch=215.8] | Loss=0.02148 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.884 | L2-Norm(final)=12.582 | 1809.4 samples/s | 28.3 steps/s
[Step=44300 Epoch=216.0] | Loss=0.02114 | Reg=0.00079 | acc=0.9688 | L2-Norm=8.887 | L2-Norm(final)=12.584 | 5183.8 samples/s | 81.0 steps/s
[Step=44350 Epoch=216.3] | Loss=0.02070 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.890 | L2-Norm(final)=12.586 | 5173.5 samples/s | 80.8 steps/s
[Step=44400 Epoch=216.5] | Loss=0.02059 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.892 | L2-Norm(final)=12.588 | 6500.2 samples/s | 101.6 steps/s
[Step=44450 Epoch=216.7] | Loss=0.01996 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.895 | L2-Norm(final)=12.590 | 1847.0 samples/s | 28.9 steps/s
[Step=44500 Epoch=217.0] | Loss=0.01974 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.898 | L2-Norm(final)=12.593 | 4967.3 samples/s | 77.6 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_0/client_state-step44500.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=52001 Epoch=253.6] | Loss=0.01448 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.865 | L2-Norm(final)=13.967 | 3808.7 samples/s | 59.5 steps/s
[Step=52050 Epoch=253.8] | Loss=0.03410 | Reg=0.00079 | acc=0.9531 | L2-Norm=8.869 | L2-Norm(final)=13.963 | 4917.2 samples/s | 76.8 steps/s
[Step=52100 Epoch=254.1] | Loss=0.02831 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.872 | L2-Norm(final)=13.962 | 5185.6 samples/s | 81.0 steps/s
[Step=52150 Epoch=254.3] | Loss=0.02636 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.875 | L2-Norm(final)=13.963 | 5146.4 samples/s | 80.4 steps/s
[Step=52200 Epoch=254.6] | Loss=0.02556 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.879 | L2-Norm(final)=13.965 | 7233.8 samples/s | 113.0 steps/s
[Step=52250 Epoch=254.8] | Loss=0.02449 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.882 | L2-Norm(final)=13.966 | 1812.4 samples/s | 28.3 steps/s
[Step=52300 Epoch=255.0] | Loss=0.02374 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.884 | L2-Norm(final)=13.968 | 5104.8 samples/s | 79.8 steps/s
[Step=52350 Epoch=255.3] | Loss=0.02291 | Reg=0.00079 | acc=0.9844 | L2-Norm=8.887 | L2-Norm(final)=13.969 | 5261.4 samples/s | 82.2 steps/s
[Step=52400 Epoch=255.5] | Loss=0.02248 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.891 | L2-Norm(final)=13.971 | 6517.3 samples/s | 101.8 steps/s
[Step=52450 Epoch=255.8] | Loss=0.02197 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.894 | L2-Norm(final)=13.974 | 1881.6 samples/s | 29.4 steps/s
[Step=52500 Epoch=256.0] | Loss=0.02132 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.897 | L2-Norm(final)=13.976 | 5322.6 samples/s | 83.2 steps/s
Client model saved at models/model-a5i5_sr0.5/client_asml1_3/client_state-step52500.h5

Train client 5: client_iccad2012_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=38001 Epoch=360.1] | Loss=0.00383 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.865 | L2-Norm(final)=7.854 | 3862.3 samples/s | 60.3 steps/s
[Step=38050 Epoch=360.6] | Loss=0.00056 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.870 | L2-Norm(final)=7.859 | 4537.7 samples/s | 70.9 steps/s
[Step=38100 Epoch=361.0] | Loss=0.00035 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.873 | L2-Norm(final)=7.864 | 6551.4 samples/s | 102.4 steps/s
[Step=38150 Epoch=361.5] | Loss=0.00027 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.873 | L2-Norm(final)=7.868 | 1756.9 samples/s | 27.5 steps/s
[Step=38200 Epoch=362.0] | Loss=0.00021 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.873 | L2-Norm(final)=7.872 | 6311.4 samples/s | 98.6 steps/s
[Step=38250 Epoch=362.5] | Loss=0.00019 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.872 | L2-Norm(final)=7.875 | 1785.0 samples/s | 27.9 steps/s
[Step=38300 Epoch=362.9] | Loss=0.00016 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.871 | L2-Norm(final)=7.878 | 5839.8 samples/s | 91.2 steps/s
[Step=38350 Epoch=363.4] | Loss=0.00015 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.870 | L2-Norm(final)=7.881 | 1819.9 samples/s | 28.4 steps/s
[Step=38400 Epoch=363.9] | Loss=0.00014 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.868 | L2-Norm(final)=7.884 | 5347.2 samples/s | 83.5 steps/s
[Step=38450 Epoch=364.3] | Loss=0.00013 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.867 | L2-Norm(final)=7.886 | 1854.5 samples/s | 29.0 steps/s
[Step=38500 Epoch=364.8] | Loss=0.00012 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.865 | L2-Norm(final)=7.889 | 5142.9 samples/s | 80.4 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_0/client_state-step38500.h5

Train client 6: client_iccad2012_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=50001 Epoch=475.6] | Loss=0.00080 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.865 | L2-Norm(final)=9.585 | 3735.4 samples/s | 58.4 steps/s
[Step=50050 Epoch=476.1] | Loss=0.00173 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.869 | L2-Norm(final)=9.585 | 4693.8 samples/s | 73.3 steps/s
[Step=50100 Epoch=476.6] | Loss=0.00108 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.873 | L2-Norm(final)=9.588 | 6790.5 samples/s | 106.1 steps/s
[Step=50150 Epoch=477.1] | Loss=0.00092 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.876 | L2-Norm(final)=9.591 | 1784.5 samples/s | 27.9 steps/s
[Step=50200 Epoch=477.5] | Loss=0.00072 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.879 | L2-Norm(final)=9.594 | 6076.4 samples/s | 94.9 steps/s
[Step=50250 Epoch=478.0] | Loss=0.00060 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.880 | L2-Norm(final)=9.596 | 1840.4 samples/s | 28.8 steps/s
[Step=50300 Epoch=478.5] | Loss=0.00054 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.882 | L2-Norm(final)=9.599 | 5787.2 samples/s | 90.4 steps/s
[Step=50350 Epoch=479.0] | Loss=0.00048 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.883 | L2-Norm(final)=9.601 | 1844.0 samples/s | 28.8 steps/s
[Step=50400 Epoch=479.4] | Loss=0.00043 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.883 | L2-Norm(final)=9.603 | 5469.2 samples/s | 85.5 steps/s
[Step=50450 Epoch=479.9] | Loss=0.00040 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.884 | L2-Norm(final)=9.605 | 1896.2 samples/s | 29.6 steps/s
[Step=50500 Epoch=480.4] | Loss=0.00037 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.885 | L2-Norm(final)=9.606 | 5086.6 samples/s | 79.5 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_1/client_state-step50500.h5

Train client 7: client_iccad2012_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Local layers training...
Not training conv1_1
Not training conv1_2
Not training conv2_1
Not training conv2_2
LR=0.00006, len=1
[Step=48001 Epoch=458.4] | Loss=0.00003 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.865 | L2-Norm(final)=8.799 | 3643.4 samples/s | 56.9 steps/s
[Step=48050 Epoch=458.8] | Loss=0.00037 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.869 | L2-Norm(final)=8.803 | 4625.0 samples/s | 72.3 steps/s
[Step=48100 Epoch=459.3] | Loss=0.00024 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.869 | L2-Norm(final)=8.807 | 6528.0 samples/s | 102.0 steps/s
[Step=48150 Epoch=459.8] | Loss=0.00019 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.869 | L2-Norm(final)=8.810 | 1747.8 samples/s | 27.3 steps/s
[Step=48200 Epoch=460.3] | Loss=0.00016 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.869 | L2-Norm(final)=8.813 | 6378.6 samples/s | 99.7 steps/s
[Step=48250 Epoch=460.8] | Loss=0.00014 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.868 | L2-Norm(final)=8.816 | 1772.9 samples/s | 27.7 steps/s
[Step=48300 Epoch=461.2] | Loss=0.00012 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.866 | L2-Norm(final)=8.819 | 5636.7 samples/s | 88.1 steps/s
[Step=48350 Epoch=461.7] | Loss=0.00011 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.865 | L2-Norm(final)=8.822 | 1805.9 samples/s | 28.2 steps/s
[Step=48400 Epoch=462.2] | Loss=0.00010 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.863 | L2-Norm(final)=8.824 | 5616.8 samples/s | 87.8 steps/s
[Step=48450 Epoch=462.7] | Loss=0.00009 | Reg=0.00079 | acc=1.0000 | L2-Norm=8.862 | L2-Norm(final)=8.827 | 1850.0 samples/s | 28.9 steps/s
[Step=48500 Epoch=463.1] | Loss=0.00009 | Reg=0.00078 | acc=1.0000 | L2-Norm=8.860 | L2-Norm(final)=8.829 | 5306.0 samples/s | 82.9 steps/s
Client model saved at models/model-a5i5_sr0.5/client_iccad2012_2/client_state-step48500.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing client_asml1_0 on asml1
[Step=  50] | Loss=0.06559 | acc=0.9595 | tpr=0.9618 | fpr=0.0453 | 4174.7 samples/s | 16.3 steps/s
Avg test loss: 0.06794, Avg test acc: 0.95805, Avg tpr: 0.96013, Avg fpr: 0.04653, total FA: 363

Testing client_asml1_1 on asml1
[Step=  50] | Loss=0.08208 | acc=0.9621 | tpr=0.9723 | fpr=0.0600 | 4053.4 samples/s | 15.8 steps/s
Avg test loss: 0.08497, Avg test acc: 0.96105, Avg tpr: 0.97080, Avg fpr: 0.06038, total FA: 471

Testing client_asml1_2 on asml1
[Step=  50] | Loss=0.07892 | acc=0.9613 | tpr=0.9702 | fpr=0.0582 | 4132.8 samples/s | 16.1 steps/s
Avg test loss: 0.08275, Avg test acc: 0.95965, Avg tpr: 0.96858, Avg fpr: 0.05999, total FA: 468

Testing client_asml1_3 on asml1
[Step=  50] | Loss=0.06365 | acc=0.9619 | tpr=0.9668 | fpr=0.0488 | 4047.8 samples/s | 15.8 steps/s
Avg test loss: 0.06667, Avg test acc: 0.96085, Avg tpr: 0.96573, Avg fpr: 0.04987, total FA: 389

Testing client_asml1_4 on asml1
[Step=  50] | Loss=0.08155 | acc=0.9628 | tpr=0.9752 | fpr=0.0642 | 4120.0 samples/s | 16.1 steps/s
Avg test loss: 0.08931, Avg test acc: 0.96158, Avg tpr: 0.97377, Avg fpr: 0.06525, total FA: 509

Testing client_iccad2012_0 on asml1
[Step=  50] | Loss=4.59271 | acc=0.2872 | tpr=0.0040 | fpr=0.0979 | 4065.1 samples/s | 15.9 steps/s
Avg test loss: 4.60523, Avg test acc: 0.28480, Avg tpr: 0.00490, Avg fpr: 0.09960, total FA: 777

Testing client_iccad2012_1 on asml1
[Step=  50] | Loss=4.00059 | acc=0.3149 | tpr=0.0088 | fpr=0.0203 | 4111.7 samples/s | 16.1 steps/s
Avg test loss: 4.00610, Avg test acc: 0.31240, Avg tpr: 0.00956, Avg fpr: 0.02154, total FA: 168

Testing client_iccad2012_2 on asml1
[Step=  50] | Loss=4.65779 | acc=0.3009 | tpr=0.0072 | fpr=0.0612 | 4044.9 samples/s | 15.8 steps/s
Avg test loss: 4.66770, Avg test acc: 0.29862, Avg tpr: 0.00828, Avg fpr: 0.06281, total FA: 490

Testing client_iccad2012_3 on asml1
[Step=  50] | Loss=5.30152 | acc=0.3044 | tpr=0.0033 | fpr=0.0419 | 4114.1 samples/s | 16.1 steps/s
Avg test loss: 5.31793, Avg test acc: 0.30127, Avg tpr: 0.00425, Avg fpr: 0.04551, total FA: 355

Testing client_iccad2012_4 on asml1
[Step=  50] | Loss=4.85240 | acc=0.3139 | tpr=0.0030 | fpr=0.0109 | 4128.2 samples/s | 16.1 steps/s
Avg test loss: 4.86296, Avg test acc: 0.31128, Avg tpr: 0.00321, Avg fpr: 0.01115, total FA: 87

Testing client_asml1_0 on iccad2012
[Step=  50] | Loss=3.44541 | acc=0.1450 | tpr=0.8009 | fpr=0.8668 | 4013.0 samples/s | 15.7 steps/s
[Step= 100] | Loss=3.41120 | acc=0.1481 | tpr=0.8081 | fpr=0.8642 | 8002.1 samples/s | 31.3 steps/s
[Step= 150] | Loss=3.40897 | acc=0.1470 | tpr=0.8213 | fpr=0.8654 | 8207.7 samples/s | 32.1 steps/s
[Step= 200] | Loss=3.40764 | acc=0.1464 | tpr=0.8284 | fpr=0.8660 | 8210.7 samples/s | 32.1 steps/s
[Step= 250] | Loss=3.40999 | acc=0.1473 | tpr=0.8288 | fpr=0.8651 | 7846.4 samples/s | 30.7 steps/s
[Step= 300] | Loss=3.40648 | acc=0.1469 | tpr=0.8262 | fpr=0.8655 | 7712.4 samples/s | 30.1 steps/s
[Step= 350] | Loss=3.40403 | acc=0.1470 | tpr=0.8272 | fpr=0.8654 | 8297.1 samples/s | 32.4 steps/s
[Step= 400] | Loss=3.40555 | acc=0.1469 | tpr=0.8239 | fpr=0.8654 | 4814.0 samples/s | 18.8 steps/s
[Step= 450] | Loss=3.40871 | acc=0.1464 | tpr=0.8199 | fpr=0.8658 | 7750.1 samples/s | 30.3 steps/s
[Step= 500] | Loss=3.40980 | acc=0.1465 | tpr=0.8229 | fpr=0.8657 | 7772.1 samples/s | 30.4 steps/s
[Step= 550] | Loss=3.40884 | acc=0.1462 | tpr=0.8253 | fpr=0.8661 | 14530.7 samples/s | 56.8 steps/s
Avg test loss: 3.40991, Avg test acc: 0.14613, Avg tpr: 0.82448, Avg fpr: 0.86621, total FA: 120271

Testing client_asml1_1 on iccad2012
[Step=  50] | Loss=4.82086 | acc=0.1308 | tpr=0.8142 | fpr=0.8815 | 4169.3 samples/s | 16.3 steps/s
[Step= 100] | Loss=4.76944 | acc=0.1346 | tpr=0.8038 | fpr=0.8779 | 7746.5 samples/s | 30.3 steps/s
[Step= 150] | Loss=4.77257 | acc=0.1340 | tpr=0.8127 | fpr=0.8785 | 7958.8 samples/s | 31.1 steps/s
[Step= 200] | Loss=4.77303 | acc=0.1336 | tpr=0.8164 | fpr=0.8788 | 7973.7 samples/s | 31.1 steps/s
[Step= 250] | Loss=4.77403 | acc=0.1341 | tpr=0.8148 | fpr=0.8783 | 7984.8 samples/s | 31.2 steps/s
[Step= 300] | Loss=4.76958 | acc=0.1339 | tpr=0.8138 | fpr=0.8785 | 8084.0 samples/s | 31.6 steps/s
[Step= 350] | Loss=4.76516 | acc=0.1336 | tpr=0.8084 | fpr=0.8786 | 7753.4 samples/s | 30.3 steps/s
[Step= 400] | Loss=4.76696 | acc=0.1336 | tpr=0.8025 | fpr=0.8785 | 4687.5 samples/s | 18.3 steps/s
[Step= 450] | Loss=4.77202 | acc=0.1333 | tpr=0.7984 | fpr=0.8788 | 7889.8 samples/s | 30.8 steps/s
[Step= 500] | Loss=4.77681 | acc=0.1330 | tpr=0.7987 | fpr=0.8790 | 7815.7 samples/s | 30.5 steps/s
[Step= 550] | Loss=4.77477 | acc=0.1329 | tpr=0.8014 | fpr=0.8792 | 14401.7 samples/s | 56.3 steps/s
Avg test loss: 4.77605, Avg test acc: 0.13289, Avg tpr: 0.80071, Avg fpr: 0.87925, total FA: 122082

Testing client_asml1_2 on iccad2012
[Step=  50] | Loss=5.26442 | acc=0.1201 | tpr=0.7389 | fpr=0.8910 | 4092.5 samples/s | 16.0 steps/s
[Step= 100] | Loss=5.21164 | acc=0.1233 | tpr=0.7484 | fpr=0.8883 | 7664.7 samples/s | 29.9 steps/s
[Step= 150] | Loss=5.21265 | acc=0.1219 | tpr=0.7666 | fpr=0.8900 | 8075.1 samples/s | 31.5 steps/s
[Step= 200] | Loss=5.21223 | acc=0.1211 | tpr=0.7716 | fpr=0.8908 | 6672.7 samples/s | 26.1 steps/s
[Step= 250] | Loss=5.21244 | acc=0.1217 | tpr=0.7668 | fpr=0.8900 | 8099.1 samples/s | 31.6 steps/s
[Step= 300] | Loss=5.20812 | acc=0.1212 | tpr=0.7680 | fpr=0.8906 | 8033.2 samples/s | 31.4 steps/s
[Step= 350] | Loss=5.20432 | acc=0.1210 | tpr=0.7702 | fpr=0.8908 | 6509.0 samples/s | 25.4 steps/s
[Step= 400] | Loss=5.20707 | acc=0.1213 | tpr=0.7664 | fpr=0.8904 | 5740.1 samples/s | 22.4 steps/s
[Step= 450] | Loss=5.21110 | acc=0.1210 | tpr=0.7624 | fpr=0.8906 | 7815.7 samples/s | 30.5 steps/s
[Step= 500] | Loss=5.21212 | acc=0.1211 | tpr=0.7648 | fpr=0.8906 | 8246.8 samples/s | 32.2 steps/s
[Step= 550] | Loss=5.21103 | acc=0.1209 | tpr=0.7676 | fpr=0.8909 | 13661.4 samples/s | 53.4 steps/s
Avg test loss: 5.21219, Avg test acc: 0.12084, Avg tpr: 0.76704, Avg fpr: 0.89091, total FA: 123701

Testing client_asml1_3 on iccad2012
[Step=  50] | Loss=3.74562 | acc=0.1403 | tpr=0.7743 | fpr=0.8711 | 4133.1 samples/s | 16.1 steps/s
[Step= 100] | Loss=3.70380 | acc=0.1445 | tpr=0.7932 | fpr=0.8676 | 7388.0 samples/s | 28.9 steps/s
[Step= 150] | Loss=3.70220 | acc=0.1432 | tpr=0.8199 | fpr=0.8692 | 8190.0 samples/s | 32.0 steps/s
[Step= 200] | Loss=3.70089 | acc=0.1418 | tpr=0.8153 | fpr=0.8705 | 6939.5 samples/s | 27.1 steps/s
[Step= 250] | Loss=3.70258 | acc=0.1429 | tpr=0.8131 | fpr=0.8693 | 8146.8 samples/s | 31.8 steps/s
[Step= 300] | Loss=3.69914 | acc=0.1422 | tpr=0.8073 | fpr=0.8699 | 7733.3 samples/s | 30.2 steps/s
[Step= 350] | Loss=3.69551 | acc=0.1419 | tpr=0.8084 | fpr=0.8702 | 5099.3 samples/s | 19.9 steps/s
[Step= 400] | Loss=3.69737 | acc=0.1419 | tpr=0.8042 | fpr=0.8701 | 7984.5 samples/s | 31.2 steps/s
[Step= 450] | Loss=3.70137 | acc=0.1415 | tpr=0.7994 | fpr=0.8704 | 8161.2 samples/s | 31.9 steps/s
[Step= 500] | Loss=3.70282 | acc=0.1417 | tpr=0.8035 | fpr=0.8703 | 7613.3 samples/s | 29.7 steps/s
[Step= 550] | Loss=3.70163 | acc=0.1414 | tpr=0.8066 | fpr=0.8707 | 15017.6 samples/s | 58.7 steps/s
Avg test loss: 3.70268, Avg test acc: 0.14134, Avg tpr: 0.80586, Avg fpr: 0.87074, total FA: 120900

Testing client_asml1_4 on iccad2012
[Step=  50] | Loss=5.27558 | acc=0.1270 | tpr=0.7345 | fpr=0.8840 | 3977.1 samples/s | 15.5 steps/s
[Step= 100] | Loss=5.22285 | acc=0.1293 | tpr=0.7122 | fpr=0.8816 | 8205.3 samples/s | 32.1 steps/s
[Step= 150] | Loss=5.22306 | acc=0.1277 | tpr=0.7104 | fpr=0.8831 | 8123.6 samples/s | 31.7 steps/s
[Step= 200] | Loss=5.22146 | acc=0.1272 | tpr=0.7093 | fpr=0.8834 | 7740.0 samples/s | 30.2 steps/s
[Step= 250] | Loss=5.22502 | acc=0.1280 | tpr=0.7092 | fpr=0.8826 | 8060.2 samples/s | 31.5 steps/s
[Step= 300] | Loss=5.21962 | acc=0.1274 | tpr=0.7120 | fpr=0.8832 | 7553.0 samples/s | 29.5 steps/s
[Step= 350] | Loss=5.21644 | acc=0.1267 | tpr=0.7101 | fpr=0.8838 | 4638.2 samples/s | 18.1 steps/s
[Step= 400] | Loss=5.21986 | acc=0.1270 | tpr=0.7084 | fpr=0.8836 | 8502.7 samples/s | 33.2 steps/s
[Step= 450] | Loss=5.22360 | acc=0.1264 | tpr=0.7020 | fpr=0.8841 | 8020.7 samples/s | 31.3 steps/s
[Step= 500] | Loss=5.22615 | acc=0.1261 | tpr=0.6982 | fpr=0.8842 | 7634.0 samples/s | 29.8 steps/s
[Step= 550] | Loss=5.22496 | acc=0.1259 | tpr=0.6968 | fpr=0.8845 | 15092.5 samples/s | 59.0 steps/s
Avg test loss: 5.22706, Avg test acc: 0.12580, Avg tpr: 0.69651, Avg fpr: 0.88457, total FA: 122821

Testing client_iccad2012_0 on iccad2012
[Step=  50] | Loss=0.09262 | acc=0.9797 | tpr=0.9513 | fpr=0.0198 | 4107.5 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.09651 | acc=0.9786 | tpr=0.9595 | fpr=0.0210 | 7703.7 samples/s | 30.1 steps/s
[Step= 150] | Loss=0.10025 | acc=0.9775 | tpr=0.9582 | fpr=0.0221 | 8071.9 samples/s | 31.5 steps/s
[Step= 200] | Loss=0.10200 | acc=0.9777 | tpr=0.9617 | fpr=0.0220 | 8378.7 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.10147 | acc=0.9776 | tpr=0.9563 | fpr=0.0221 | 7498.9 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.10331 | acc=0.9773 | tpr=0.9585 | fpr=0.0224 | 7337.3 samples/s | 28.7 steps/s
[Step= 350] | Loss=0.10323 | acc=0.9773 | tpr=0.9593 | fpr=0.0224 | 5016.6 samples/s | 19.6 steps/s
[Step= 400] | Loss=0.10408 | acc=0.9771 | tpr=0.9573 | fpr=0.0226 | 7787.0 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.10638 | acc=0.9769 | tpr=0.9567 | fpr=0.0227 | 8149.0 samples/s | 31.8 steps/s
[Step= 500] | Loss=0.10615 | acc=0.9770 | tpr=0.9577 | fpr=0.0227 | 7633.1 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.10531 | acc=0.9772 | tpr=0.9574 | fpr=0.0224 | 15051.3 samples/s | 58.8 steps/s
Avg test loss: 0.10516, Avg test acc: 0.97722, Avg tpr: 0.95761, Avg fpr: 0.02242, total FA: 3113

Testing client_iccad2012_1 on iccad2012
[Step=  50] | Loss=0.10975 | acc=0.9782 | tpr=0.9336 | fpr=0.0210 | 4166.5 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.11350 | acc=0.9781 | tpr=0.9552 | fpr=0.0214 | 7308.4 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.11820 | acc=0.9768 | tpr=0.9539 | fpr=0.0228 | 7461.3 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.11960 | acc=0.9768 | tpr=0.9563 | fpr=0.0228 | 7757.2 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.11895 | acc=0.9765 | tpr=0.9537 | fpr=0.0231 | 8008.2 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.12131 | acc=0.9761 | tpr=0.9549 | fpr=0.0235 | 5209.2 samples/s | 20.3 steps/s
[Step= 350] | Loss=0.12169 | acc=0.9759 | tpr=0.9555 | fpr=0.0237 | 8112.7 samples/s | 31.7 steps/s
[Step= 400] | Loss=0.12247 | acc=0.9759 | tpr=0.9535 | fpr=0.0237 | 7575.3 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.12533 | acc=0.9757 | tpr=0.9523 | fpr=0.0239 | 7688.0 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.12496 | acc=0.9757 | tpr=0.9542 | fpr=0.0239 | 7843.9 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.12403 | acc=0.9759 | tpr=0.9522 | fpr=0.0237 | 14953.1 samples/s | 58.4 steps/s
Avg test loss: 0.12381, Avg test acc: 0.97591, Avg tpr: 0.95206, Avg fpr: 0.02366, total FA: 3285

Testing client_iccad2012_2 on iccad2012
[Step=  50] | Loss=0.11039 | acc=0.9780 | tpr=0.9513 | fpr=0.0216 | 4109.8 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.11405 | acc=0.9770 | tpr=0.9638 | fpr=0.0227 | 7758.5 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.11866 | acc=0.9757 | tpr=0.9625 | fpr=0.0241 | 7984.6 samples/s | 31.2 steps/s
[Step= 200] | Loss=0.12011 | acc=0.9758 | tpr=0.9650 | fpr=0.0240 | 8264.6 samples/s | 32.3 steps/s
[Step= 250] | Loss=0.11956 | acc=0.9755 | tpr=0.9624 | fpr=0.0242 | 7822.6 samples/s | 30.6 steps/s
[Step= 300] | Loss=0.12209 | acc=0.9752 | tpr=0.9636 | fpr=0.0246 | 4813.5 samples/s | 18.8 steps/s
[Step= 350] | Loss=0.12224 | acc=0.9753 | tpr=0.9643 | fpr=0.0245 | 7938.9 samples/s | 31.0 steps/s
[Step= 400] | Loss=0.12324 | acc=0.9751 | tpr=0.9628 | fpr=0.0247 | 7849.9 samples/s | 30.7 steps/s
[Step= 450] | Loss=0.12593 | acc=0.9750 | tpr=0.9630 | fpr=0.0248 | 8181.7 samples/s | 32.0 steps/s
[Step= 500] | Loss=0.12567 | acc=0.9751 | tpr=0.9643 | fpr=0.0247 | 7415.2 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.12465 | acc=0.9753 | tpr=0.9634 | fpr=0.0245 | 14226.3 samples/s | 55.6 steps/s
Avg test loss: 0.12447, Avg test acc: 0.97529, Avg tpr: 0.96355, Avg fpr: 0.02450, total FA: 3402

Testing client_iccad2012_3 on iccad2012
[Step=  50] | Loss=0.10544 | acc=0.9813 | tpr=0.9425 | fpr=0.0180 | 4030.0 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.10975 | acc=0.9807 | tpr=0.9531 | fpr=0.0187 | 7927.8 samples/s | 31.0 steps/s
[Step= 150] | Loss=0.11407 | acc=0.9800 | tpr=0.9524 | fpr=0.0195 | 8159.9 samples/s | 31.9 steps/s
[Step= 200] | Loss=0.11644 | acc=0.9800 | tpr=0.9585 | fpr=0.0196 | 8040.9 samples/s | 31.4 steps/s
[Step= 250] | Loss=0.11549 | acc=0.9800 | tpr=0.9546 | fpr=0.0195 | 7860.1 samples/s | 30.7 steps/s
[Step= 300] | Loss=0.11727 | acc=0.9797 | tpr=0.9564 | fpr=0.0199 | 4731.7 samples/s | 18.5 steps/s
[Step= 350] | Loss=0.11749 | acc=0.9795 | tpr=0.9580 | fpr=0.0201 | 7568.6 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.11816 | acc=0.9794 | tpr=0.9562 | fpr=0.0202 | 8431.8 samples/s | 32.9 steps/s
[Step= 450] | Loss=0.12101 | acc=0.9792 | tpr=0.9557 | fpr=0.0204 | 7662.1 samples/s | 29.9 steps/s
[Step= 500] | Loss=0.12062 | acc=0.9792 | tpr=0.9559 | fpr=0.0204 | 7816.1 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.11971 | acc=0.9794 | tpr=0.9554 | fpr=0.0202 | 14317.0 samples/s | 55.9 steps/s
Avg test loss: 0.11953, Avg test acc: 0.97939, Avg tpr: 0.95563, Avg fpr: 0.02018, total FA: 2802

Testing client_iccad2012_4 on iccad2012
[Step=  50] | Loss=0.12300 | acc=0.9802 | tpr=0.9292 | fpr=0.0188 | 4048.0 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.12753 | acc=0.9798 | tpr=0.9510 | fpr=0.0197 | 6805.3 samples/s | 26.6 steps/s
[Step= 150] | Loss=0.13281 | acc=0.9786 | tpr=0.9524 | fpr=0.0209 | 8026.1 samples/s | 31.4 steps/s
[Step= 200] | Loss=0.13482 | acc=0.9784 | tpr=0.9563 | fpr=0.0212 | 8364.5 samples/s | 32.7 steps/s
[Step= 250] | Loss=0.13389 | acc=0.9785 | tpr=0.9520 | fpr=0.0210 | 5318.6 samples/s | 20.8 steps/s
[Step= 300] | Loss=0.13667 | acc=0.9782 | tpr=0.9535 | fpr=0.0214 | 8071.1 samples/s | 31.5 steps/s
[Step= 350] | Loss=0.13742 | acc=0.9779 | tpr=0.9549 | fpr=0.0217 | 8223.8 samples/s | 32.1 steps/s
[Step= 400] | Loss=0.13836 | acc=0.9777 | tpr=0.9513 | fpr=0.0218 | 7972.6 samples/s | 31.1 steps/s
[Step= 450] | Loss=0.14147 | acc=0.9775 | tpr=0.9513 | fpr=0.0221 | 8372.7 samples/s | 32.7 steps/s
[Step= 500] | Loss=0.14090 | acc=0.9775 | tpr=0.9515 | fpr=0.0220 | 7211.4 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.14004 | acc=0.9777 | tpr=0.9507 | fpr=0.0218 | 14178.4 samples/s | 55.4 steps/s
Avg test loss: 0.13981, Avg test acc: 0.97766, Avg tpr: 0.95048, Avg fpr: 0.02184, total FA: 3033
