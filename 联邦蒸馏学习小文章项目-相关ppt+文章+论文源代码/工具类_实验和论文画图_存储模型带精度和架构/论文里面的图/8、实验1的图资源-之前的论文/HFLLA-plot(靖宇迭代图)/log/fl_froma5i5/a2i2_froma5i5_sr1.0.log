#clients of iccad2012: 2
#clients of asml1: 2
select ratio: 1.0
Total num clients: 10
client model path: ['models/model-a2i2_froma5i5_sr1.0/client_asml1_0', 'models/model-a2i2_froma5i5_sr1.0/client_asml1_1', 'models/model-a2i2_froma5i5_sr1.0/client_asml1_2', 'models/model-a2i2_froma5i5_sr1.0/client_asml1_3', 'models/model-a2i2_froma5i5_sr1.0/client_asml1_4', 'models/model-a2i2_froma5i5_sr1.0/client_iccad2012_0', 'models/model-a2i2_froma5i5_sr1.0/client_iccad2012_1', 'models/model-a2i2_froma5i5_sr1.0/client_iccad2012_2', 'models/model-a2i2_froma5i5_sr1.0/client_iccad2012_3', 'models/model-a2i2_froma5i5_sr1.0/client_iccad2012_4']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13125, 144, 32)
Using transform option: train
#pos = 6841, #neg = 6284
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13116, 144, 32)
Using transform option: train
#pos = 6850, #neg = 6266
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13135, 144, 32)
Using transform option: train
#pos = 6831, #neg = 6304
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13124, 144, 32)
Using transform option: train
#pos = 6842, #neg = 6282
Allocated dataset with size (9984, 144, 32)
Resampled dataset to size (13051, 144, 32)
Using transform option: train
#pos = 6917, #neg = 6134
loading data into the main memory...
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6754, 144, 32)
Using transform option: train
#pos = 3332, #neg = 3422
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6728, 144, 32)
Using transform option: train
#pos = 3304, #neg = 3424
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6702, 144, 32)
Using transform option: train
#pos = 3276, #neg = 3426
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6792, 144, 32)
Using transform option: train
#pos = 3393, #neg = 3399
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6715, 144, 32)
Using transform option: train
#pos = 3290, #neg = 3425
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.35651 | Reg=0.00357 | acc=0.5469 | L2-Norm=18.885 | L2-Norm(final)=2.101 | 2910.0 samples/s | 45.5 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.28902 | Reg=0.00339 | acc=0.7344 | L2-Norm=18.407 | L2-Norm(final)=2.100 | 4490.9 samples/s | 70.2 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.24731 | Reg=0.00331 | acc=0.8906 | L2-Norm=18.189 | L2-Norm(final)=2.109 | 4465.3 samples/s | 69.8 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.21821 | Reg=0.00326 | acc=0.8281 | L2-Norm=18.056 | L2-Norm(final)=2.118 | 4426.0 samples/s | 69.2 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.20113 | Reg=0.00323 | acc=0.9531 | L2-Norm=17.967 | L2-Norm(final)=2.126 | 5894.5 samples/s | 92.1 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.18528 | Reg=0.00321 | acc=0.9531 | L2-Norm=17.911 | L2-Norm(final)=2.133 | 1940.0 samples/s | 30.3 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.17269 | Reg=0.00320 | acc=0.7969 | L2-Norm=17.873 | L2-Norm(final)=2.142 | 4385.3 samples/s | 68.5 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.16079 | Reg=0.00319 | acc=0.9219 | L2-Norm=17.846 | L2-Norm(final)=2.150 | 4408.6 samples/s | 68.9 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.15117 | Reg=0.00318 | acc=0.9375 | L2-Norm=17.824 | L2-Norm(final)=2.157 | 5537.9 samples/s | 86.5 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.14097 | Reg=0.00317 | acc=0.9375 | L2-Norm=17.808 | L2-Norm(final)=2.166 | 1956.0 samples/s | 30.6 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13319 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.796 | L2-Norm(final)=2.175 | 4314.1 samples/s | 67.4 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.12771 | Reg=0.00316 | acc=0.9844 | L2-Norm=17.788 | L2-Norm(final)=2.183 | 4254.8 samples/s | 66.5 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.12200 | Reg=0.00316 | acc=0.9531 | L2-Norm=17.784 | L2-Norm(final)=2.191 | 5062.9 samples/s | 79.1 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11639 | Reg=0.00316 | acc=0.9375 | L2-Norm=17.781 | L2-Norm(final)=2.199 | 1995.6 samples/s | 31.2 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.11103 | Reg=0.00316 | acc=0.9062 | L2-Norm=17.779 | L2-Norm(final)=2.206 | 4275.0 samples/s | 66.8 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10636 | Reg=0.00316 | acc=0.9844 | L2-Norm=17.777 | L2-Norm(final)=2.214 | 4321.9 samples/s | 67.5 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.10227 | Reg=0.00316 | acc=0.9844 | L2-Norm=17.776 | L2-Norm(final)=2.222 | 4711.9 samples/s | 73.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34086 | Reg=0.00357 | acc=0.5938 | L2-Norm=18.885 | L2-Norm(final)=2.102 | 4404.8 samples/s | 68.8 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.28694 | Reg=0.00339 | acc=0.7812 | L2-Norm=18.399 | L2-Norm(final)=2.097 | 4056.7 samples/s | 63.4 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.23860 | Reg=0.00331 | acc=0.7812 | L2-Norm=18.205 | L2-Norm(final)=2.108 | 4288.0 samples/s | 67.0 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.21728 | Reg=0.00327 | acc=0.8594 | L2-Norm=18.083 | L2-Norm(final)=2.114 | 4309.2 samples/s | 67.3 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.19751 | Reg=0.00324 | acc=0.9531 | L2-Norm=18.000 | L2-Norm(final)=2.121 | 5740.0 samples/s | 89.7 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.17952 | Reg=0.00322 | acc=0.9844 | L2-Norm=17.942 | L2-Norm(final)=2.127 | 1893.5 samples/s | 29.6 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.16608 | Reg=0.00321 | acc=0.9375 | L2-Norm=17.901 | L2-Norm(final)=2.134 | 4317.0 samples/s | 67.5 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.15569 | Reg=0.00319 | acc=0.9375 | L2-Norm=17.871 | L2-Norm(final)=2.141 | 4269.7 samples/s | 66.7 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.14766 | Reg=0.00319 | acc=0.8750 | L2-Norm=17.848 | L2-Norm(final)=2.148 | 5392.5 samples/s | 84.3 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.13799 | Reg=0.00318 | acc=0.9531 | L2-Norm=17.832 | L2-Norm(final)=2.154 | 1921.1 samples/s | 30.0 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.12970 | Reg=0.00318 | acc=0.9531 | L2-Norm=17.820 | L2-Norm(final)=2.161 | 4239.8 samples/s | 66.2 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.12270 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.810 | L2-Norm(final)=2.168 | 4299.6 samples/s | 67.2 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.11877 | Reg=0.00317 | acc=0.9844 | L2-Norm=17.801 | L2-Norm(final)=2.174 | 5040.8 samples/s | 78.8 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11306 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.796 | L2-Norm(final)=2.180 | 1971.1 samples/s | 30.8 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.10781 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.793 | L2-Norm(final)=2.187 | 4384.7 samples/s | 68.5 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10300 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.792 | L2-Norm(final)=2.193 | 4190.0 samples/s | 65.5 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.09898 | Reg=0.00317 | acc=0.9688 | L2-Norm=17.790 | L2-Norm(final)=2.199 | 4738.9 samples/s | 74.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.33607 | Reg=0.00357 | acc=0.5469 | L2-Norm=18.885 | L2-Norm(final)=2.102 | 4336.2 samples/s | 67.8 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.14468 | Reg=0.00341 | acc=0.9844 | L2-Norm=18.457 | L2-Norm(final)=2.117 | 3753.2 samples/s | 58.6 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.08615 | Reg=0.00334 | acc=1.0000 | L2-Norm=18.269 | L2-Norm(final)=2.132 | 5485.4 samples/s | 85.7 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.06027 | Reg=0.00329 | acc=0.9844 | L2-Norm=18.141 | L2-Norm(final)=2.143 | 1828.6 samples/s | 28.6 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.04606 | Reg=0.00326 | acc=0.9844 | L2-Norm=18.040 | L2-Norm(final)=2.153 | 5193.8 samples/s | 81.2 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.03723 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.952 | L2-Norm(final)=2.161 | 1877.9 samples/s | 29.3 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.03107 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.871 | L2-Norm(final)=2.168 | 4768.5 samples/s | 74.5 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02667 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.793 | L2-Norm(final)=2.173 | 1918.1 samples/s | 30.0 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02335 | Reg=0.00314 | acc=1.0000 | L2-Norm=17.717 | L2-Norm(final)=2.178 | 4367.8 samples/s | 68.2 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.02076 | Reg=0.00311 | acc=1.0000 | L2-Norm=17.643 | L2-Norm(final)=2.182 | 1996.0 samples/s | 31.2 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.01869 | Reg=0.00309 | acc=1.0000 | L2-Norm=17.570 | L2-Norm(final)=2.186 | 4126.4 samples/s | 64.5 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.01699 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.499 | L2-Norm(final)=2.189 | 2028.8 samples/s | 31.7 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01558 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.429 | L2-Norm(final)=2.191 | 4099.0 samples/s | 64.0 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01438 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.361 | L2-Norm(final)=2.194 | 2089.9 samples/s | 32.7 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.01336 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.294 | L2-Norm(final)=2.196 | 4028.7 samples/s | 62.9 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01247 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.228 | L2-Norm(final)=2.199 | 2085.5 samples/s | 32.6 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01169 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.163 | L2-Norm(final)=2.201 | 3945.3 samples/s | 61.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.32513 | Reg=0.00357 | acc=0.5938 | L2-Norm=18.885 | L2-Norm(final)=2.101 | 4381.4 samples/s | 68.5 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.12724 | Reg=0.00344 | acc=0.9531 | L2-Norm=18.545 | L2-Norm(final)=2.124 | 3837.7 samples/s | 60.0 steps/s
[Step= 100 Epoch= 1.0] | Loss=0.07401 | Reg=0.00338 | acc=0.9844 | L2-Norm=18.381 | L2-Norm(final)=2.139 | 5620.3 samples/s | 87.8 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.05054 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.257 | L2-Norm(final)=2.151 | 1822.9 samples/s | 28.5 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.04072 | Reg=0.00330 | acc=1.0000 | L2-Norm=18.158 | L2-Norm(final)=2.160 | 5134.9 samples/s | 80.2 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.03283 | Reg=0.00327 | acc=1.0000 | L2-Norm=18.080 | L2-Norm(final)=2.167 | 1865.3 samples/s | 29.1 steps/s
[Step= 300 Epoch= 2.9] | Loss=0.02750 | Reg=0.00324 | acc=1.0000 | L2-Norm=18.008 | L2-Norm(final)=2.173 | 4734.6 samples/s | 74.0 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02359 | Reg=0.00322 | acc=1.0000 | L2-Norm=17.937 | L2-Norm(final)=2.178 | 1929.9 samples/s | 30.2 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02065 | Reg=0.00319 | acc=1.0000 | L2-Norm=17.869 | L2-Norm(final)=2.182 | 4499.3 samples/s | 70.3 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.01837 | Reg=0.00317 | acc=1.0000 | L2-Norm=17.802 | L2-Norm(final)=2.185 | 1992.5 samples/s | 31.1 steps/s
[Step= 500 Epoch= 4.8] | Loss=0.01653 | Reg=0.00315 | acc=1.0000 | L2-Norm=17.736 | L2-Norm(final)=2.189 | 4210.1 samples/s | 65.8 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.01503 | Reg=0.00312 | acc=1.0000 | L2-Norm=17.672 | L2-Norm(final)=2.192 | 2033.7 samples/s | 31.8 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01378 | Reg=0.00310 | acc=1.0000 | L2-Norm=17.608 | L2-Norm(final)=2.194 | 4024.0 samples/s | 62.9 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01273 | Reg=0.00308 | acc=1.0000 | L2-Norm=17.546 | L2-Norm(final)=2.197 | 2079.8 samples/s | 32.5 steps/s
[Step= 700 Epoch= 6.7] | Loss=0.01182 | Reg=0.00306 | acc=1.0000 | L2-Norm=17.484 | L2-Norm(final)=2.200 | 4005.1 samples/s | 62.6 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01103 | Reg=0.00304 | acc=1.0000 | L2-Norm=17.424 | L2-Norm(final)=2.202 | 2088.4 samples/s | 32.6 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01034 | Reg=0.00302 | acc=1.0000 | L2-Norm=17.364 | L2-Norm(final)=2.205 | 4079.1 samples/s | 63.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30102 | acc=0.6841 | tpr=0.6605 | fpr=0.2649 | 3990.2 samples/s | 15.6 steps/s
Avg test loss: 0.30012, Avg test acc: 0.68735, Avg tpr: 0.66521, Avg fpr: 0.26394, total FA: 2059

Testing server on iccad2012
[Step=  50] | Loss=0.21660 | acc=0.8207 | tpr=0.9159 | fpr=0.1810 | 3936.6 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.21782 | acc=0.8173 | tpr=0.8913 | fpr=0.1841 | 7270.9 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.21732 | acc=0.8167 | tpr=0.8977 | fpr=0.1848 | 7300.0 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.21801 | acc=0.8161 | tpr=0.8918 | fpr=0.1853 | 7053.3 samples/s | 27.6 steps/s
[Step= 250] | Loss=0.21827 | acc=0.8161 | tpr=0.8952 | fpr=0.1853 | 7169.5 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.21826 | acc=0.8163 | tpr=0.8865 | fpr=0.1850 | 7302.0 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.21851 | acc=0.8161 | tpr=0.8885 | fpr=0.1852 | 7159.7 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.21877 | acc=0.8156 | tpr=0.8917 | fpr=0.1858 | 7222.7 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.21904 | acc=0.8154 | tpr=0.8924 | fpr=0.1860 | 7047.9 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.21877 | acc=0.8155 | tpr=0.8952 | fpr=0.1859 | 7283.0 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.21874 | acc=0.8156 | tpr=0.8942 | fpr=0.1858 | 12799.9 samples/s | 50.0 steps/s
Avg test loss: 0.21884, Avg test acc: 0.81556, Avg tpr: 0.89342, Avg fpr: 0.18585, total FA: 25805

server round 1/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.25513 | Reg=0.00259 | acc=0.7656 | L2-Norm=16.083 | L2-Norm(final)=2.251 | 4228.1 samples/s | 66.1 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.15356 | Reg=0.00265 | acc=0.9688 | L2-Norm=16.290 | L2-Norm(final)=2.245 | 4152.6 samples/s | 64.9 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.13218 | Reg=0.00268 | acc=0.9375 | L2-Norm=16.356 | L2-Norm(final)=2.252 | 4187.1 samples/s | 65.4 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.12229 | Reg=0.00269 | acc=0.9531 | L2-Norm=16.393 | L2-Norm(final)=2.258 | 4252.0 samples/s | 66.4 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.11368 | Reg=0.00270 | acc=0.9375 | L2-Norm=16.422 | L2-Norm(final)=2.262 | 5895.6 samples/s | 92.1 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.10624 | Reg=0.00271 | acc=0.9531 | L2-Norm=16.455 | L2-Norm(final)=2.268 | 1899.8 samples/s | 29.7 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.09798 | Reg=0.00272 | acc=0.9531 | L2-Norm=16.487 | L2-Norm(final)=2.274 | 4267.9 samples/s | 66.7 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.09186 | Reg=0.00273 | acc=0.9219 | L2-Norm=16.514 | L2-Norm(final)=2.279 | 4319.5 samples/s | 67.5 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.08806 | Reg=0.00274 | acc=0.9375 | L2-Norm=16.539 | L2-Norm(final)=2.284 | 5400.1 samples/s | 84.4 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.08251 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.562 | L2-Norm(final)=2.290 | 1954.4 samples/s | 30.5 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.07813 | Reg=0.00275 | acc=0.9531 | L2-Norm=16.584 | L2-Norm(final)=2.295 | 4298.2 samples/s | 67.2 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.07501 | Reg=0.00276 | acc=0.9844 | L2-Norm=16.605 | L2-Norm(final)=2.301 | 4261.4 samples/s | 66.6 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.07251 | Reg=0.00276 | acc=0.9844 | L2-Norm=16.625 | L2-Norm(final)=2.306 | 5030.0 samples/s | 78.6 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.07000 | Reg=0.00277 | acc=0.9688 | L2-Norm=16.644 | L2-Norm(final)=2.311 | 2000.5 samples/s | 31.3 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.06704 | Reg=0.00278 | acc=0.9844 | L2-Norm=16.662 | L2-Norm(final)=2.316 | 4280.1 samples/s | 66.9 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.06459 | Reg=0.00278 | acc=0.9844 | L2-Norm=16.678 | L2-Norm(final)=2.321 | 4197.9 samples/s | 65.6 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.06237 | Reg=0.00279 | acc=1.0000 | L2-Norm=16.692 | L2-Norm(final)=2.325 | 4627.6 samples/s | 72.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step1600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.21923 | Reg=0.00259 | acc=0.7969 | L2-Norm=16.083 | L2-Norm(final)=2.250 | 4272.1 samples/s | 66.8 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.16461 | Reg=0.00265 | acc=0.9062 | L2-Norm=16.270 | L2-Norm(final)=2.239 | 4164.0 samples/s | 65.1 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.14259 | Reg=0.00267 | acc=0.9219 | L2-Norm=16.354 | L2-Norm(final)=2.242 | 4174.1 samples/s | 65.2 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.12663 | Reg=0.00269 | acc=0.9375 | L2-Norm=16.395 | L2-Norm(final)=2.248 | 4214.1 samples/s | 65.8 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.11670 | Reg=0.00270 | acc=0.9062 | L2-Norm=16.421 | L2-Norm(final)=2.254 | 5847.9 samples/s | 91.4 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.10463 | Reg=0.00270 | acc=0.9844 | L2-Norm=16.446 | L2-Norm(final)=2.262 | 1883.7 samples/s | 29.4 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.09767 | Reg=0.00271 | acc=0.9688 | L2-Norm=16.469 | L2-Norm(final)=2.270 | 4184.7 samples/s | 65.4 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.09149 | Reg=0.00272 | acc=0.9375 | L2-Norm=16.491 | L2-Norm(final)=2.278 | 4227.7 samples/s | 66.1 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.08697 | Reg=0.00273 | acc=0.9688 | L2-Norm=16.511 | L2-Norm(final)=2.285 | 5370.2 samples/s | 83.9 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.08152 | Reg=0.00273 | acc=0.9375 | L2-Norm=16.530 | L2-Norm(final)=2.292 | 1902.9 samples/s | 29.7 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.07592 | Reg=0.00274 | acc=0.9688 | L2-Norm=16.550 | L2-Norm(final)=2.300 | 4228.9 samples/s | 66.1 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.07221 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.568 | L2-Norm(final)=2.307 | 4273.3 samples/s | 66.8 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.06955 | Reg=0.00275 | acc=0.9688 | L2-Norm=16.585 | L2-Norm(final)=2.314 | 5040.2 samples/s | 78.8 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.06694 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.600 | L2-Norm(final)=2.319 | 1949.2 samples/s | 30.5 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.06389 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.616 | L2-Norm(final)=2.325 | 4225.9 samples/s | 66.0 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.06171 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.630 | L2-Norm(final)=2.330 | 4172.1 samples/s | 65.2 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.05948 | Reg=0.00277 | acc=0.9688 | L2-Norm=16.644 | L2-Norm(final)=2.336 | 4683.0 samples/s | 73.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step1600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.16016 | Reg=0.00259 | acc=0.8281 | L2-Norm=16.083 | L2-Norm(final)=2.251 | 4201.8 samples/s | 65.7 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.06560 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.433 | L2-Norm(final)=2.214 | 3694.7 samples/s | 57.7 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.04071 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.518 | L2-Norm(final)=2.206 | 5550.9 samples/s | 86.7 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.02892 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.530 | L2-Norm(final)=2.205 | 1833.0 samples/s | 28.6 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.02210 | Reg=0.00273 | acc=1.0000 | L2-Norm=16.519 | L2-Norm(final)=2.207 | 5193.2 samples/s | 81.1 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.01772 | Reg=0.00272 | acc=1.0000 | L2-Norm=16.498 | L2-Norm(final)=2.210 | 1906.8 samples/s | 29.8 steps/s
[Step=1100 Epoch=10.4] | Loss=0.01478 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.470 | L2-Norm(final)=2.212 | 4708.4 samples/s | 73.6 steps/s
[Step=1150 Epoch=10.9] | Loss=0.01268 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.439 | L2-Norm(final)=2.213 | 1944.6 samples/s | 30.4 steps/s
[Step=1200 Epoch=11.4] | Loss=0.01110 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.405 | L2-Norm(final)=2.216 | 4362.4 samples/s | 68.2 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00987 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.370 | L2-Norm(final)=2.218 | 1975.5 samples/s | 30.9 steps/s
[Step=1300 Epoch=12.3] | Loss=0.00889 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.335 | L2-Norm(final)=2.220 | 4089.8 samples/s | 63.9 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00808 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.300 | L2-Norm(final)=2.222 | 2027.9 samples/s | 31.7 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00741 | Reg=0.00265 | acc=1.0000 | L2-Norm=16.264 | L2-Norm(final)=2.224 | 4029.1 samples/s | 63.0 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00684 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.228 | L2-Norm(final)=2.226 | 2051.4 samples/s | 32.1 steps/s
[Step=1500 Epoch=14.2] | Loss=0.00635 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.192 | L2-Norm(final)=2.228 | 4035.8 samples/s | 63.1 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00593 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.156 | L2-Norm(final)=2.229 | 2054.2 samples/s | 32.1 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00556 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.120 | L2-Norm(final)=2.231 | 4053.6 samples/s | 63.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step1600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.15292 | Reg=0.00259 | acc=0.8906 | L2-Norm=16.083 | L2-Norm(final)=2.251 | 4291.5 samples/s | 67.1 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.06222 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.363 | L2-Norm(final)=2.217 | 3680.3 samples/s | 57.5 steps/s
[Step= 900 Epoch= 8.6] | Loss=0.03529 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.450 | L2-Norm(final)=2.219 | 5507.2 samples/s | 86.0 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.02389 | Reg=0.00271 | acc=1.0000 | L2-Norm=16.460 | L2-Norm(final)=2.222 | 1795.9 samples/s | 28.1 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01812 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.446 | L2-Norm(final)=2.226 | 5151.8 samples/s | 80.5 steps/s
[Step=1050 Epoch=10.0] | Loss=0.01456 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.423 | L2-Norm(final)=2.229 | 1864.0 samples/s | 29.1 steps/s
[Step=1100 Epoch=10.5] | Loss=0.01216 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.395 | L2-Norm(final)=2.232 | 4690.7 samples/s | 73.3 steps/s
[Step=1150 Epoch=10.9] | Loss=0.01044 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.364 | L2-Norm(final)=2.235 | 1914.0 samples/s | 29.9 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00914 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.331 | L2-Norm(final)=2.237 | 4326.9 samples/s | 67.6 steps/s
[Step=1250 Epoch=11.9] | Loss=0.00812 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.296 | L2-Norm(final)=2.238 | 1956.1 samples/s | 30.6 steps/s
[Step=1300 Epoch=12.4] | Loss=0.00731 | Reg=0.00264 | acc=1.0000 | L2-Norm=16.261 | L2-Norm(final)=2.240 | 4124.1 samples/s | 64.4 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00665 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.225 | L2-Norm(final)=2.241 | 2065.7 samples/s | 32.3 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00610 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.189 | L2-Norm(final)=2.242 | 4163.6 samples/s | 65.1 steps/s
[Step=1450 Epoch=13.8] | Loss=0.00563 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.153 | L2-Norm(final)=2.243 | 2056.2 samples/s | 32.1 steps/s
[Step=1500 Epoch=14.3] | Loss=0.00523 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.117 | L2-Norm(final)=2.245 | 4070.6 samples/s | 63.6 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00488 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.081 | L2-Norm(final)=2.246 | 2048.4 samples/s | 32.0 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00457 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.045 | L2-Norm(final)=2.248 | 4182.0 samples/s | 65.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39641 | acc=0.5888 | tpr=0.5642 | fpr=0.3578 | 3849.5 samples/s | 15.0 steps/s
Avg test loss: 0.39197, Avg test acc: 0.59228, Avg tpr: 0.56781, Avg fpr: 0.35393, total FA: 2761

Testing server on iccad2012
[Step=  50] | Loss=0.19611 | acc=0.8537 | tpr=0.9867 | fpr=0.1487 | 3892.6 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.19684 | acc=0.8530 | tpr=0.9829 | fpr=0.1494 | 7278.1 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.19642 | acc=0.8533 | tpr=0.9813 | fpr=0.1490 | 7096.7 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.19805 | acc=0.8529 | tpr=0.9803 | fpr=0.1494 | 7386.4 samples/s | 28.9 steps/s
[Step= 250] | Loss=0.19817 | acc=0.8524 | tpr=0.9808 | fpr=0.1499 | 6976.4 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.19876 | acc=0.8520 | tpr=0.9818 | fpr=0.1504 | 7033.5 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.19966 | acc=0.8511 | tpr=0.9818 | fpr=0.1513 | 7219.4 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.19974 | acc=0.8513 | tpr=0.9830 | fpr=0.1511 | 7171.5 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.20059 | acc=0.8508 | tpr=0.9820 | fpr=0.1516 | 7034.5 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.20025 | acc=0.8512 | tpr=0.9824 | fpr=0.1512 | 7253.8 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.19965 | acc=0.8515 | tpr=0.9825 | fpr=0.1508 | 13156.0 samples/s | 51.4 steps/s
Avg test loss: 0.19958, Avg test acc: 0.85157, Avg tpr: 0.98217, Avg fpr: 0.15081, total FA: 20939

server round 2/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.28758 | Reg=0.00242 | acc=0.6562 | L2-Norm=15.556 | L2-Norm(final)=2.314 | 4322.8 samples/s | 67.5 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.11416 | Reg=0.00247 | acc=0.8750 | L2-Norm=15.731 | L2-Norm(final)=2.320 | 4037.4 samples/s | 63.1 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.09681 | Reg=0.00250 | acc=0.9688 | L2-Norm=15.810 | L2-Norm(final)=2.329 | 4217.2 samples/s | 65.9 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.09220 | Reg=0.00251 | acc=0.9844 | L2-Norm=15.852 | L2-Norm(final)=2.331 | 4209.1 samples/s | 65.8 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.08298 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.890 | L2-Norm(final)=2.337 | 5763.6 samples/s | 90.1 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.07481 | Reg=0.00254 | acc=0.9844 | L2-Norm=15.925 | L2-Norm(final)=2.345 | 1886.5 samples/s | 29.5 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.06837 | Reg=0.00255 | acc=0.9531 | L2-Norm=15.959 | L2-Norm(final)=2.354 | 4178.2 samples/s | 65.3 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.06466 | Reg=0.00256 | acc=0.9844 | L2-Norm=15.990 | L2-Norm(final)=2.362 | 4215.2 samples/s | 65.9 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.06315 | Reg=0.00257 | acc=0.9688 | L2-Norm=16.017 | L2-Norm(final)=2.368 | 5278.1 samples/s | 82.5 steps/s
[Step=2050 Epoch=10.0] | Loss=0.05913 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.043 | L2-Norm(final)=2.374 | 1921.8 samples/s | 30.0 steps/s
[Step=2100 Epoch=10.2] | Loss=0.05537 | Reg=0.00258 | acc=0.9688 | L2-Norm=16.066 | L2-Norm(final)=2.381 | 4241.0 samples/s | 66.3 steps/s
[Step=2150 Epoch=10.5] | Loss=0.05325 | Reg=0.00259 | acc=0.9531 | L2-Norm=16.086 | L2-Norm(final)=2.387 | 4211.0 samples/s | 65.8 steps/s
[Step=2200 Epoch=10.7] | Loss=0.05153 | Reg=0.00259 | acc=0.9688 | L2-Norm=16.106 | L2-Norm(final)=2.391 | 4986.0 samples/s | 77.9 steps/s
[Step=2250 Epoch=11.0] | Loss=0.04938 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.125 | L2-Norm(final)=2.396 | 1999.6 samples/s | 31.2 steps/s
[Step=2300 Epoch=11.2] | Loss=0.04736 | Reg=0.00261 | acc=0.9844 | L2-Norm=16.142 | L2-Norm(final)=2.401 | 4269.8 samples/s | 66.7 steps/s
[Step=2350 Epoch=11.5] | Loss=0.04589 | Reg=0.00261 | acc=0.9844 | L2-Norm=16.159 | L2-Norm(final)=2.406 | 4361.2 samples/s | 68.1 steps/s
[Step=2400 Epoch=11.7] | Loss=0.04509 | Reg=0.00262 | acc=0.9844 | L2-Norm=16.176 | L2-Norm(final)=2.409 | 4713.6 samples/s | 73.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step2400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.34420 | Reg=0.00242 | acc=0.6562 | L2-Norm=15.556 | L2-Norm(final)=2.313 | 4185.2 samples/s | 65.4 steps/s
[Step=1650 Epoch= 8.1] | Loss=0.12091 | Reg=0.00248 | acc=0.9219 | L2-Norm=15.733 | L2-Norm(final)=2.311 | 4220.1 samples/s | 65.9 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.10231 | Reg=0.00250 | acc=0.9844 | L2-Norm=15.817 | L2-Norm(final)=2.318 | 4230.4 samples/s | 66.1 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.09208 | Reg=0.00252 | acc=0.9531 | L2-Norm=15.863 | L2-Norm(final)=2.324 | 4229.9 samples/s | 66.1 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.08531 | Reg=0.00253 | acc=0.9688 | L2-Norm=15.895 | L2-Norm(final)=2.327 | 5813.8 samples/s | 90.8 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.07682 | Reg=0.00254 | acc=0.9688 | L2-Norm=15.927 | L2-Norm(final)=2.333 | 1872.9 samples/s | 29.3 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.07244 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.951 | L2-Norm(final)=2.339 | 4275.7 samples/s | 66.8 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.06804 | Reg=0.00255 | acc=0.9375 | L2-Norm=15.974 | L2-Norm(final)=2.344 | 4252.2 samples/s | 66.4 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.06383 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.996 | L2-Norm(final)=2.350 | 5427.5 samples/s | 84.8 steps/s
[Step=2050 Epoch=10.0] | Loss=0.06001 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.016 | L2-Norm(final)=2.355 | 1939.6 samples/s | 30.3 steps/s
[Step=2100 Epoch=10.2] | Loss=0.05684 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.034 | L2-Norm(final)=2.360 | 4363.9 samples/s | 68.2 steps/s
[Step=2150 Epoch=10.5] | Loss=0.05473 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.051 | L2-Norm(final)=2.365 | 4201.5 samples/s | 65.6 steps/s
[Step=2200 Epoch=10.7] | Loss=0.05259 | Reg=0.00258 | acc=0.9688 | L2-Norm=16.069 | L2-Norm(final)=2.369 | 5080.3 samples/s | 79.4 steps/s
[Step=2250 Epoch=11.0] | Loss=0.05032 | Reg=0.00259 | acc=0.9844 | L2-Norm=16.086 | L2-Norm(final)=2.374 | 1960.1 samples/s | 30.6 steps/s
[Step=2300 Epoch=11.2] | Loss=0.04816 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.103 | L2-Norm(final)=2.378 | 4263.0 samples/s | 66.6 steps/s
[Step=2350 Epoch=11.5] | Loss=0.04705 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.117 | L2-Norm(final)=2.382 | 4257.0 samples/s | 66.5 steps/s
[Step=2400 Epoch=11.7] | Loss=0.04596 | Reg=0.00260 | acc=0.9688 | L2-Norm=16.131 | L2-Norm(final)=2.385 | 4928.2 samples/s | 77.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step2400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.2] | Loss=0.11000 | Reg=0.00242 | acc=0.9219 | L2-Norm=15.556 | L2-Norm(final)=2.313 | 4496.6 samples/s | 70.3 steps/s
[Step=1650 Epoch=15.6] | Loss=0.01850 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.739 | L2-Norm(final)=2.322 | 3819.6 samples/s | 59.7 steps/s
[Step=1700 Epoch=16.1] | Loss=0.01202 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.798 | L2-Norm(final)=2.328 | 5463.2 samples/s | 85.4 steps/s
[Step=1750 Epoch=16.6] | Loss=0.00807 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.802 | L2-Norm(final)=2.332 | 1819.6 samples/s | 28.4 steps/s
[Step=1800 Epoch=17.1] | Loss=0.00632 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.786 | L2-Norm(final)=2.335 | 5026.2 samples/s | 78.5 steps/s
[Step=1850 Epoch=17.5] | Loss=0.00516 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.768 | L2-Norm(final)=2.338 | 1893.2 samples/s | 29.6 steps/s
[Step=1900 Epoch=18.0] | Loss=0.00431 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.745 | L2-Norm(final)=2.340 | 4616.4 samples/s | 72.1 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00370 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.718 | L2-Norm(final)=2.343 | 1949.0 samples/s | 30.5 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00324 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.689 | L2-Norm(final)=2.344 | 4362.7 samples/s | 68.2 steps/s
[Step=2050 Epoch=19.4] | Loss=0.00288 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.658 | L2-Norm(final)=2.346 | 1989.0 samples/s | 31.1 steps/s
[Step=2100 Epoch=19.9] | Loss=0.00259 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.626 | L2-Norm(final)=2.347 | 4110.2 samples/s | 64.2 steps/s
[Step=2150 Epoch=20.4] | Loss=0.00236 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.594 | L2-Norm(final)=2.348 | 2009.2 samples/s | 31.4 steps/s
[Step=2200 Epoch=20.8] | Loss=0.00216 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.561 | L2-Norm(final)=2.349 | 4130.4 samples/s | 64.5 steps/s
[Step=2250 Epoch=21.3] | Loss=0.00200 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.529 | L2-Norm(final)=2.350 | 2072.2 samples/s | 32.4 steps/s
[Step=2300 Epoch=21.8] | Loss=0.00185 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.496 | L2-Norm(final)=2.350 | 3956.6 samples/s | 61.8 steps/s
[Step=2350 Epoch=22.3] | Loss=0.00173 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.463 | L2-Norm(final)=2.351 | 2081.9 samples/s | 32.5 steps/s
[Step=2400 Epoch=22.7] | Loss=0.00162 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.430 | L2-Norm(final)=2.352 | 3917.7 samples/s | 61.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step2400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.2] | Loss=0.05367 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.556 | L2-Norm(final)=2.314 | 4208.0 samples/s | 65.7 steps/s
[Step=1650 Epoch=15.7] | Loss=0.03026 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.748 | L2-Norm(final)=2.319 | 3746.3 samples/s | 58.5 steps/s
[Step=1700 Epoch=16.2] | Loss=0.01956 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.861 | L2-Norm(final)=2.315 | 5563.8 samples/s | 86.9 steps/s
[Step=1750 Epoch=16.6] | Loss=0.01329 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.893 | L2-Norm(final)=2.316 | 1816.3 samples/s | 28.4 steps/s
[Step=1800 Epoch=17.1] | Loss=0.01000 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.892 | L2-Norm(final)=2.319 | 5121.1 samples/s | 80.0 steps/s
[Step=1850 Epoch=17.6] | Loss=0.00801 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.876 | L2-Norm(final)=2.321 | 1878.2 samples/s | 29.3 steps/s
[Step=1900 Epoch=18.1] | Loss=0.00669 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.854 | L2-Norm(final)=2.322 | 4871.6 samples/s | 76.1 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00574 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.829 | L2-Norm(final)=2.324 | 1919.2 samples/s | 30.0 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00502 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.801 | L2-Norm(final)=2.325 | 4388.2 samples/s | 68.6 steps/s
[Step=2050 Epoch=19.5] | Loss=0.00447 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.772 | L2-Norm(final)=2.326 | 1972.9 samples/s | 30.8 steps/s
[Step=2100 Epoch=20.0] | Loss=0.00402 | Reg=0.00248 | acc=1.0000 | L2-Norm=15.742 | L2-Norm(final)=2.327 | 4151.9 samples/s | 64.9 steps/s
[Step=2150 Epoch=20.5] | Loss=0.00366 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.711 | L2-Norm(final)=2.328 | 2047.4 samples/s | 32.0 steps/s
[Step=2200 Epoch=20.9] | Loss=0.00336 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.680 | L2-Norm(final)=2.329 | 4020.8 samples/s | 62.8 steps/s
[Step=2250 Epoch=21.4] | Loss=0.00310 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.649 | L2-Norm(final)=2.330 | 2064.1 samples/s | 32.3 steps/s
[Step=2300 Epoch=21.9] | Loss=0.00288 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.618 | L2-Norm(final)=2.331 | 4131.5 samples/s | 64.6 steps/s
[Step=2350 Epoch=22.4] | Loss=0.00269 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.587 | L2-Norm(final)=2.331 | 2086.6 samples/s | 32.6 steps/s
[Step=2400 Epoch=22.8] | Loss=0.00252 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.556 | L2-Norm(final)=2.332 | 3994.1 samples/s | 62.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35691 | acc=0.6962 | tpr=0.5851 | fpr=0.0627 | 3919.3 samples/s | 15.3 steps/s
Avg test loss: 0.35617, Avg test acc: 0.69625, Avg tpr: 0.58577, Avg fpr: 0.06076, total FA: 474

Testing server on iccad2012
[Step=  50] | Loss=0.17521 | acc=0.8726 | tpr=0.9469 | fpr=0.1288 | 3886.2 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.17662 | acc=0.8738 | tpr=0.9531 | fpr=0.1277 | 7168.4 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.17704 | acc=0.8735 | tpr=0.9481 | fpr=0.1278 | 7103.1 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.17842 | acc=0.8737 | tpr=0.9486 | fpr=0.1277 | 7207.9 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.17802 | acc=0.8735 | tpr=0.9502 | fpr=0.1279 | 7196.9 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.17875 | acc=0.8735 | tpr=0.9476 | fpr=0.1278 | 7050.4 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.17996 | acc=0.8730 | tpr=0.9474 | fpr=0.1284 | 7201.8 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.18016 | acc=0.8728 | tpr=0.9491 | fpr=0.1285 | 7189.3 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.18140 | acc=0.8722 | tpr=0.9460 | fpr=0.1292 | 7029.1 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.18099 | acc=0.8724 | tpr=0.9463 | fpr=0.1290 | 7028.5 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.18046 | acc=0.8730 | tpr=0.9467 | fpr=0.1284 | 13191.0 samples/s | 51.5 steps/s
Avg test loss: 0.18039, Avg test acc: 0.87301, Avg tpr: 0.94651, Avg fpr: 0.12833, total FA: 17818

server round 3/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.27165 | Reg=0.00231 | acc=0.7656 | L2-Norm=15.195 | L2-Norm(final)=2.389 | 4220.7 samples/s | 65.9 steps/s
[Step=2450 Epoch=11.9] | Loss=0.09058 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.320 | L2-Norm(final)=2.380 | 4274.6 samples/s | 66.8 steps/s
[Step=2500 Epoch=12.2] | Loss=0.07367 | Reg=0.00237 | acc=0.9531 | L2-Norm=15.391 | L2-Norm(final)=2.386 | 4313.9 samples/s | 67.4 steps/s
[Step=2550 Epoch=12.4] | Loss=0.06695 | Reg=0.00238 | acc=0.9219 | L2-Norm=15.434 | L2-Norm(final)=2.390 | 4130.3 samples/s | 64.5 steps/s
[Step=2600 Epoch=12.7] | Loss=0.06615 | Reg=0.00239 | acc=0.9688 | L2-Norm=15.464 | L2-Norm(final)=2.389 | 5776.9 samples/s | 90.3 steps/s
[Step=2650 Epoch=12.9] | Loss=0.06056 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.493 | L2-Norm(final)=2.390 | 1880.4 samples/s | 29.4 steps/s
[Step=2700 Epoch=13.2] | Loss=0.05482 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.521 | L2-Norm(final)=2.395 | 4245.8 samples/s | 66.3 steps/s
[Step=2750 Epoch=13.4] | Loss=0.05078 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.548 | L2-Norm(final)=2.401 | 4219.3 samples/s | 65.9 steps/s
[Step=2800 Epoch=13.7] | Loss=0.04929 | Reg=0.00243 | acc=0.9531 | L2-Norm=15.573 | L2-Norm(final)=2.404 | 5426.6 samples/s | 84.8 steps/s
[Step=2850 Epoch=13.9] | Loss=0.04696 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.596 | L2-Norm(final)=2.407 | 1940.4 samples/s | 30.3 steps/s
[Step=2900 Epoch=14.1] | Loss=0.04510 | Reg=0.00244 | acc=0.9688 | L2-Norm=15.617 | L2-Norm(final)=2.411 | 4457.0 samples/s | 69.6 steps/s
[Step=2950 Epoch=14.4] | Loss=0.04332 | Reg=0.00245 | acc=0.9688 | L2-Norm=15.637 | L2-Norm(final)=2.415 | 4432.6 samples/s | 69.3 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04145 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.656 | L2-Norm(final)=2.418 | 5184.5 samples/s | 81.0 steps/s
[Step=3050 Epoch=14.9] | Loss=0.03973 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.673 | L2-Norm(final)=2.422 | 2001.3 samples/s | 31.3 steps/s
[Step=3100 Epoch=15.1] | Loss=0.03838 | Reg=0.00246 | acc=0.9844 | L2-Norm=15.690 | L2-Norm(final)=2.426 | 4366.8 samples/s | 68.2 steps/s
[Step=3150 Epoch=15.4] | Loss=0.03732 | Reg=0.00247 | acc=0.9688 | L2-Norm=15.705 | L2-Norm(final)=2.430 | 4239.4 samples/s | 66.2 steps/s
[Step=3200 Epoch=15.6] | Loss=0.03610 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.721 | L2-Norm(final)=2.433 | 4717.5 samples/s | 73.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step3200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.37977 | Reg=0.00231 | acc=0.7188 | L2-Norm=15.195 | L2-Norm(final)=2.388 | 4546.8 samples/s | 71.0 steps/s
[Step=2450 Epoch=12.0] | Loss=0.09348 | Reg=0.00235 | acc=0.9219 | L2-Norm=15.338 | L2-Norm(final)=2.372 | 3973.7 samples/s | 62.1 steps/s
[Step=2500 Epoch=12.2] | Loss=0.08038 | Reg=0.00237 | acc=0.9531 | L2-Norm=15.405 | L2-Norm(final)=2.376 | 4316.2 samples/s | 67.4 steps/s
[Step=2550 Epoch=12.4] | Loss=0.07076 | Reg=0.00239 | acc=0.9688 | L2-Norm=15.446 | L2-Norm(final)=2.381 | 4306.3 samples/s | 67.3 steps/s
[Step=2600 Epoch=12.7] | Loss=0.06443 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.477 | L2-Norm(final)=2.386 | 5891.0 samples/s | 92.0 steps/s
[Step=2650 Epoch=12.9] | Loss=0.05703 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.505 | L2-Norm(final)=2.392 | 1896.2 samples/s | 29.6 steps/s
[Step=2700 Epoch=13.2] | Loss=0.05351 | Reg=0.00241 | acc=0.9844 | L2-Norm=15.532 | L2-Norm(final)=2.399 | 4381.5 samples/s | 68.5 steps/s
[Step=2750 Epoch=13.4] | Loss=0.05089 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.556 | L2-Norm(final)=2.404 | 4240.4 samples/s | 66.3 steps/s
[Step=2800 Epoch=13.7] | Loss=0.04873 | Reg=0.00243 | acc=0.9688 | L2-Norm=15.579 | L2-Norm(final)=2.407 | 5445.0 samples/s | 85.1 steps/s
[Step=2850 Epoch=13.9] | Loss=0.04651 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.598 | L2-Norm(final)=2.410 | 1913.0 samples/s | 29.9 steps/s
[Step=2900 Epoch=14.2] | Loss=0.04418 | Reg=0.00244 | acc=0.9688 | L2-Norm=15.617 | L2-Norm(final)=2.413 | 4196.6 samples/s | 65.6 steps/s
[Step=2950 Epoch=14.4] | Loss=0.04284 | Reg=0.00244 | acc=0.9844 | L2-Norm=15.632 | L2-Norm(final)=2.416 | 4323.9 samples/s | 67.6 steps/s
[Step=3000 Epoch=14.6] | Loss=0.04124 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.648 | L2-Norm(final)=2.418 | 5026.3 samples/s | 78.5 steps/s
[Step=3050 Epoch=14.9] | Loss=0.03943 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.662 | L2-Norm(final)=2.421 | 1956.9 samples/s | 30.6 steps/s
[Step=3100 Epoch=15.1] | Loss=0.03800 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.675 | L2-Norm(final)=2.424 | 4237.3 samples/s | 66.2 steps/s
[Step=3150 Epoch=15.4] | Loss=0.03642 | Reg=0.00246 | acc=1.0000 | L2-Norm=15.689 | L2-Norm(final)=2.428 | 4227.4 samples/s | 66.1 steps/s
[Step=3200 Epoch=15.6] | Loss=0.03587 | Reg=0.00247 | acc=0.9844 | L2-Norm=15.701 | L2-Norm(final)=2.431 | 4792.8 samples/s | 74.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step3200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.8] | Loss=0.04592 | Reg=0.00231 | acc=0.9531 | L2-Norm=15.195 | L2-Norm(final)=2.389 | 4386.2 samples/s | 68.5 steps/s
[Step=2450 Epoch=23.2] | Loss=0.01937 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.460 | L2-Norm(final)=2.379 | 3671.0 samples/s | 57.4 steps/s
[Step=2500 Epoch=23.7] | Loss=0.01311 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.548 | L2-Norm(final)=2.368 | 5487.4 samples/s | 85.7 steps/s
[Step=2550 Epoch=24.2] | Loss=0.01044 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.584 | L2-Norm(final)=2.361 | 1812.4 samples/s | 28.3 steps/s
[Step=2600 Epoch=24.6] | Loss=0.00790 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.597 | L2-Norm(final)=2.359 | 5047.2 samples/s | 78.9 steps/s
[Step=2650 Epoch=25.1] | Loss=0.00633 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.592 | L2-Norm(final)=2.358 | 1866.0 samples/s | 29.2 steps/s
[Step=2700 Epoch=25.6] | Loss=0.00528 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.576 | L2-Norm(final)=2.358 | 4789.5 samples/s | 74.8 steps/s
[Step=2750 Epoch=26.1] | Loss=0.00452 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.554 | L2-Norm(final)=2.358 | 1924.0 samples/s | 30.1 steps/s
[Step=2800 Epoch=26.5] | Loss=0.00396 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.530 | L2-Norm(final)=2.359 | 4315.0 samples/s | 67.4 steps/s
[Step=2850 Epoch=27.0] | Loss=0.00352 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.503 | L2-Norm(final)=2.359 | 1992.2 samples/s | 31.1 steps/s
[Step=2900 Epoch=27.5] | Loss=0.00317 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.474 | L2-Norm(final)=2.359 | 4059.0 samples/s | 63.4 steps/s
[Step=2950 Epoch=28.0] | Loss=0.00288 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.445 | L2-Norm(final)=2.360 | 2017.9 samples/s | 31.5 steps/s
[Step=3000 Epoch=28.4] | Loss=0.00264 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.416 | L2-Norm(final)=2.360 | 4016.6 samples/s | 62.8 steps/s
[Step=3050 Epoch=28.9] | Loss=0.00244 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.385 | L2-Norm(final)=2.360 | 2047.8 samples/s | 32.0 steps/s
[Step=3100 Epoch=29.4] | Loss=0.00227 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.355 | L2-Norm(final)=2.361 | 4054.2 samples/s | 63.3 steps/s
[Step=3150 Epoch=29.8] | Loss=0.00212 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.325 | L2-Norm(final)=2.361 | 2075.0 samples/s | 32.4 steps/s
[Step=3200 Epoch=30.3] | Loss=0.00199 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.294 | L2-Norm(final)=2.361 | 3959.2 samples/s | 61.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step3200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.8] | Loss=0.04770 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.195 | L2-Norm(final)=2.389 | 4644.2 samples/s | 72.6 steps/s
[Step=2450 Epoch=23.3] | Loss=0.02454 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.392 | L2-Norm(final)=2.371 | 3458.9 samples/s | 54.0 steps/s
[Step=2500 Epoch=23.8] | Loss=0.01320 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.484 | L2-Norm(final)=2.367 | 5565.9 samples/s | 87.0 steps/s
[Step=2550 Epoch=24.3] | Loss=0.00912 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.499 | L2-Norm(final)=2.369 | 1818.8 samples/s | 28.4 steps/s
[Step=2600 Epoch=24.7] | Loss=0.00686 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.491 | L2-Norm(final)=2.372 | 5157.4 samples/s | 80.6 steps/s
[Step=2650 Epoch=25.2] | Loss=0.00550 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.471 | L2-Norm(final)=2.374 | 1887.5 samples/s | 29.5 steps/s
[Step=2700 Epoch=25.7] | Loss=0.00458 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.446 | L2-Norm(final)=2.376 | 4746.7 samples/s | 74.2 steps/s
[Step=2750 Epoch=26.2] | Loss=0.00393 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.419 | L2-Norm(final)=2.377 | 1918.9 samples/s | 30.0 steps/s
[Step=2800 Epoch=26.6] | Loss=0.00344 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.389 | L2-Norm(final)=2.378 | 4374.2 samples/s | 68.3 steps/s
[Step=2850 Epoch=27.1] | Loss=0.00306 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.359 | L2-Norm(final)=2.380 | 2001.8 samples/s | 31.3 steps/s
[Step=2900 Epoch=27.6] | Loss=0.00276 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.328 | L2-Norm(final)=2.381 | 4035.3 samples/s | 63.1 steps/s
[Step=2950 Epoch=28.1] | Loss=0.00251 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.297 | L2-Norm(final)=2.382 | 2045.3 samples/s | 32.0 steps/s
[Step=3000 Epoch=28.5] | Loss=0.00230 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.266 | L2-Norm(final)=2.384 | 4098.5 samples/s | 64.0 steps/s
[Step=3050 Epoch=29.0] | Loss=0.00212 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.235 | L2-Norm(final)=2.385 | 2075.0 samples/s | 32.4 steps/s
[Step=3100 Epoch=29.5] | Loss=0.00197 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.203 | L2-Norm(final)=2.387 | 4016.3 samples/s | 62.8 steps/s
[Step=3150 Epoch=30.0] | Loss=0.00184 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.172 | L2-Norm(final)=2.388 | 2095.1 samples/s | 32.7 steps/s
[Step=3200 Epoch=30.4] | Loss=0.00173 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.141 | L2-Norm(final)=2.390 | 3986.9 samples/s | 62.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.60539 | acc=0.5723 | tpr=0.3975 | fpr=0.0483 | 3904.9 samples/s | 15.3 steps/s
Avg test loss: 0.60619, Avg test acc: 0.57404, Avg tpr: 0.40240, Avg fpr: 0.04846, total FA: 378

Testing server on iccad2012
[Step=  50] | Loss=0.12436 | acc=0.9321 | tpr=0.9469 | fpr=0.0682 | 3904.1 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.12749 | acc=0.9304 | tpr=0.9552 | fpr=0.0701 | 7104.1 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.12897 | acc=0.9286 | tpr=0.9553 | fpr=0.0719 | 7304.7 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.13025 | acc=0.9283 | tpr=0.9530 | fpr=0.0722 | 7068.4 samples/s | 27.6 steps/s
[Step= 250] | Loss=0.12961 | acc=0.9282 | tpr=0.9537 | fpr=0.0723 | 7208.5 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.13077 | acc=0.9278 | tpr=0.9520 | fpr=0.0726 | 7022.7 samples/s | 27.4 steps/s
[Step= 350] | Loss=0.13196 | acc=0.9272 | tpr=0.9512 | fpr=0.0732 | 7354.2 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.13214 | acc=0.9272 | tpr=0.9513 | fpr=0.0732 | 7196.0 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.13365 | acc=0.9264 | tpr=0.9499 | fpr=0.0740 | 7072.9 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.13343 | acc=0.9265 | tpr=0.9515 | fpr=0.0739 | 7110.3 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.13291 | acc=0.9268 | tpr=0.9519 | fpr=0.0737 | 13435.0 samples/s | 52.5 steps/s
Avg test loss: 0.13276, Avg test acc: 0.92686, Avg tpr: 0.95166, Avg fpr: 0.07359, total FA: 10218

server round 4/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.33098 | Reg=0.00222 | acc=0.6875 | L2-Norm=14.889 | L2-Norm(final)=2.426 | 4393.4 samples/s | 68.6 steps/s
[Step=3250 Epoch=15.8] | Loss=0.09236 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.044 | L2-Norm(final)=2.403 | 4125.9 samples/s | 64.5 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07292 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.128 | L2-Norm(final)=2.408 | 4368.7 samples/s | 68.3 steps/s
[Step=3350 Epoch=16.3] | Loss=0.06317 | Reg=0.00230 | acc=0.9688 | L2-Norm=15.181 | L2-Norm(final)=2.411 | 4301.3 samples/s | 67.2 steps/s
[Step=3400 Epoch=16.6] | Loss=0.05928 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.217 | L2-Norm(final)=2.411 | 5792.9 samples/s | 90.5 steps/s
[Step=3450 Epoch=16.8] | Loss=0.05246 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.249 | L2-Norm(final)=2.413 | 1883.8 samples/s | 29.4 steps/s
[Step=3500 Epoch=17.1] | Loss=0.04904 | Reg=0.00233 | acc=0.9531 | L2-Norm=15.276 | L2-Norm(final)=2.416 | 4303.7 samples/s | 67.2 steps/s
[Step=3550 Epoch=17.3] | Loss=0.04676 | Reg=0.00234 | acc=0.9531 | L2-Norm=15.300 | L2-Norm(final)=2.419 | 4300.6 samples/s | 67.2 steps/s
[Step=3600 Epoch=17.6] | Loss=0.04407 | Reg=0.00235 | acc=0.9688 | L2-Norm=15.322 | L2-Norm(final)=2.420 | 5362.7 samples/s | 83.8 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04134 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.344 | L2-Norm(final)=2.424 | 1918.4 samples/s | 30.0 steps/s
[Step=3700 Epoch=18.0] | Loss=0.03860 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.366 | L2-Norm(final)=2.429 | 4154.3 samples/s | 64.9 steps/s
[Step=3750 Epoch=18.3] | Loss=0.03783 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.386 | L2-Norm(final)=2.433 | 4261.3 samples/s | 66.6 steps/s
[Step=3800 Epoch=18.5] | Loss=0.03736 | Reg=0.00237 | acc=0.9531 | L2-Norm=15.407 | L2-Norm(final)=2.435 | 4930.9 samples/s | 77.0 steps/s
[Step=3850 Epoch=18.8] | Loss=0.03619 | Reg=0.00238 | acc=0.9531 | L2-Norm=15.428 | L2-Norm(final)=2.436 | 1988.5 samples/s | 31.1 steps/s
[Step=3900 Epoch=19.0] | Loss=0.03502 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.448 | L2-Norm(final)=2.438 | 4230.5 samples/s | 66.1 steps/s
[Step=3950 Epoch=19.3] | Loss=0.03370 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.466 | L2-Norm(final)=2.439 | 4235.1 samples/s | 66.2 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03265 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.482 | L2-Norm(final)=2.441 | 4731.4 samples/s | 73.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step4000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.45135 | Reg=0.00222 | acc=0.6562 | L2-Norm=14.889 | L2-Norm(final)=2.425 | 4156.5 samples/s | 64.9 steps/s
[Step=3250 Epoch=15.9] | Loss=0.09349 | Reg=0.00226 | acc=0.8906 | L2-Norm=15.038 | L2-Norm(final)=2.394 | 4181.5 samples/s | 65.3 steps/s
[Step=3300 Epoch=16.1] | Loss=0.07307 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.113 | L2-Norm(final)=2.398 | 4170.6 samples/s | 65.2 steps/s
[Step=3350 Epoch=16.3] | Loss=0.06608 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.158 | L2-Norm(final)=2.397 | 4334.1 samples/s | 67.7 steps/s
[Step=3400 Epoch=16.6] | Loss=0.06205 | Reg=0.00231 | acc=0.9375 | L2-Norm=15.200 | L2-Norm(final)=2.397 | 5859.6 samples/s | 91.6 steps/s
[Step=3450 Epoch=16.8] | Loss=0.05565 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.240 | L2-Norm(final)=2.397 | 1865.6 samples/s | 29.2 steps/s
[Step=3500 Epoch=17.1] | Loss=0.05020 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.273 | L2-Norm(final)=2.400 | 4165.8 samples/s | 65.1 steps/s
[Step=3550 Epoch=17.3] | Loss=0.04713 | Reg=0.00234 | acc=0.9531 | L2-Norm=15.302 | L2-Norm(final)=2.404 | 4177.0 samples/s | 65.3 steps/s
[Step=3600 Epoch=17.6] | Loss=0.04581 | Reg=0.00235 | acc=0.9844 | L2-Norm=15.329 | L2-Norm(final)=2.407 | 5417.7 samples/s | 84.7 steps/s
[Step=3650 Epoch=17.8] | Loss=0.04314 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.358 | L2-Norm(final)=2.410 | 1907.5 samples/s | 29.8 steps/s
[Step=3700 Epoch=18.1] | Loss=0.04097 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.382 | L2-Norm(final)=2.412 | 4184.6 samples/s | 65.4 steps/s
[Step=3750 Epoch=18.3] | Loss=0.03960 | Reg=0.00237 | acc=0.9688 | L2-Norm=15.403 | L2-Norm(final)=2.414 | 4225.8 samples/s | 66.0 steps/s
[Step=3800 Epoch=18.5] | Loss=0.03847 | Reg=0.00238 | acc=0.9844 | L2-Norm=15.422 | L2-Norm(final)=2.416 | 5112.0 samples/s | 79.9 steps/s
[Step=3850 Epoch=18.8] | Loss=0.03694 | Reg=0.00238 | acc=0.9688 | L2-Norm=15.439 | L2-Norm(final)=2.417 | 1960.6 samples/s | 30.6 steps/s
[Step=3900 Epoch=19.0] | Loss=0.03505 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.456 | L2-Norm(final)=2.419 | 4245.9 samples/s | 66.3 steps/s
[Step=3950 Epoch=19.3] | Loss=0.03384 | Reg=0.00239 | acc=0.9688 | L2-Norm=15.471 | L2-Norm(final)=2.422 | 4239.6 samples/s | 66.2 steps/s
[Step=4000 Epoch=19.5] | Loss=0.03285 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.484 | L2-Norm(final)=2.425 | 4782.9 samples/s | 74.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step4000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.3] | Loss=0.04681 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.889 | L2-Norm(final)=2.427 | 4440.6 samples/s | 69.4 steps/s
[Step=3250 Epoch=30.8] | Loss=0.01065 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.023 | L2-Norm(final)=2.443 | 3732.1 samples/s | 58.3 steps/s
[Step=3300 Epoch=31.3] | Loss=0.01843 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.174 | L2-Norm(final)=2.418 | 5606.0 samples/s | 87.6 steps/s
[Step=3350 Epoch=31.7] | Loss=0.01311 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.270 | L2-Norm(final)=2.399 | 1815.2 samples/s | 28.4 steps/s
[Step=3400 Epoch=32.2] | Loss=0.00999 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.311 | L2-Norm(final)=2.391 | 5027.9 samples/s | 78.6 steps/s
[Step=3450 Epoch=32.7] | Loss=0.00800 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.326 | L2-Norm(final)=2.388 | 1861.3 samples/s | 29.1 steps/s
[Step=3500 Epoch=33.2] | Loss=0.00667 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.324 | L2-Norm(final)=2.386 | 4783.8 samples/s | 74.7 steps/s
[Step=3550 Epoch=33.6] | Loss=0.00572 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.314 | L2-Norm(final)=2.385 | 1934.1 samples/s | 30.2 steps/s
[Step=3600 Epoch=34.1] | Loss=0.00501 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.299 | L2-Norm(final)=2.384 | 4351.6 samples/s | 68.0 steps/s
[Step=3650 Epoch=34.6] | Loss=0.00445 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.280 | L2-Norm(final)=2.384 | 1995.6 samples/s | 31.2 steps/s
[Step=3700 Epoch=35.1] | Loss=0.00401 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.259 | L2-Norm(final)=2.384 | 4082.8 samples/s | 63.8 steps/s
[Step=3750 Epoch=35.5] | Loss=0.00365 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.236 | L2-Norm(final)=2.384 | 2024.4 samples/s | 31.6 steps/s
[Step=3800 Epoch=36.0] | Loss=0.00334 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.213 | L2-Norm(final)=2.384 | 4042.3 samples/s | 63.2 steps/s
[Step=3850 Epoch=36.5] | Loss=0.00309 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.188 | L2-Norm(final)=2.384 | 2044.5 samples/s | 31.9 steps/s
[Step=3900 Epoch=37.0] | Loss=0.00287 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.163 | L2-Norm(final)=2.385 | 4125.6 samples/s | 64.5 steps/s
[Step=3950 Epoch=37.4] | Loss=0.00268 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.137 | L2-Norm(final)=2.385 | 2068.5 samples/s | 32.3 steps/s
[Step=4000 Epoch=37.9] | Loss=0.00251 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.111 | L2-Norm(final)=2.385 | 4016.0 samples/s | 62.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step4000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.4] | Loss=0.04087 | Reg=0.00222 | acc=0.9531 | L2-Norm=14.889 | L2-Norm(final)=2.427 | 4594.2 samples/s | 71.8 steps/s
[Step=3250 Epoch=30.9] | Loss=0.00646 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.967 | L2-Norm(final)=2.446 | 3686.6 samples/s | 57.6 steps/s
[Step=3300 Epoch=31.4] | Loss=0.00448 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.018 | L2-Norm(final)=2.447 | 5591.6 samples/s | 87.4 steps/s
[Step=3350 Epoch=31.9] | Loss=0.00338 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.050 | L2-Norm(final)=2.450 | 1836.3 samples/s | 28.7 steps/s
[Step=3400 Epoch=32.3] | Loss=0.00256 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.061 | L2-Norm(final)=2.453 | 5079.2 samples/s | 79.4 steps/s
[Step=3450 Epoch=32.8] | Loss=0.00206 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.056 | L2-Norm(final)=2.456 | 1886.6 samples/s | 29.5 steps/s
[Step=3500 Epoch=33.3] | Loss=0.00172 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.041 | L2-Norm(final)=2.458 | 4736.9 samples/s | 74.0 steps/s
[Step=3550 Epoch=33.8] | Loss=0.00147 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.021 | L2-Norm(final)=2.459 | 1921.9 samples/s | 30.0 steps/s
[Step=3600 Epoch=34.2] | Loss=0.00129 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.996 | L2-Norm(final)=2.460 | 4347.1 samples/s | 67.9 steps/s
[Step=3650 Epoch=34.7] | Loss=0.00115 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.970 | L2-Norm(final)=2.461 | 1973.8 samples/s | 30.8 steps/s
[Step=3700 Epoch=35.2] | Loss=0.00103 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.942 | L2-Norm(final)=2.462 | 4141.0 samples/s | 64.7 steps/s
[Step=3750 Epoch=35.7] | Loss=0.00094 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.913 | L2-Norm(final)=2.463 | 2041.6 samples/s | 31.9 steps/s
[Step=3800 Epoch=36.1] | Loss=0.00086 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.883 | L2-Norm(final)=2.464 | 4071.9 samples/s | 63.6 steps/s
[Step=3850 Epoch=36.6] | Loss=0.00079 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.853 | L2-Norm(final)=2.464 | 2053.6 samples/s | 32.1 steps/s
[Step=3900 Epoch=37.1] | Loss=0.00074 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.823 | L2-Norm(final)=2.465 | 4073.1 samples/s | 63.6 steps/s
[Step=3950 Epoch=37.6] | Loss=0.00069 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.792 | L2-Norm(final)=2.465 | 2078.8 samples/s | 32.5 steps/s
[Step=4000 Epoch=38.0] | Loss=0.00065 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.761 | L2-Norm(final)=2.466 | 4071.2 samples/s | 63.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30992 | acc=0.7538 | tpr=0.6669 | fpr=0.0575 | 3872.7 samples/s | 15.1 steps/s
Avg test loss: 0.31271, Avg test acc: 0.75647, Avg tpr: 0.67162, Avg fpr: 0.05692, total FA: 444

Testing server on iccad2012
[Step=  50] | Loss=0.23907 | acc=0.8486 | tpr=0.9425 | fpr=0.1531 | 3916.2 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.24320 | acc=0.8471 | tpr=0.9552 | fpr=0.1549 | 7253.4 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.24566 | acc=0.8469 | tpr=0.9568 | fpr=0.1551 | 7526.5 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.24679 | acc=0.8472 | tpr=0.9607 | fpr=0.1549 | 6842.8 samples/s | 26.7 steps/s
[Step= 250] | Loss=0.24612 | acc=0.8473 | tpr=0.9624 | fpr=0.1548 | 7123.7 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.24736 | acc=0.8476 | tpr=0.9615 | fpr=0.1544 | 7319.9 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.24873 | acc=0.8472 | tpr=0.9612 | fpr=0.1548 | 7188.2 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.24967 | acc=0.8471 | tpr=0.9606 | fpr=0.1549 | 7294.4 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.25140 | acc=0.8467 | tpr=0.9591 | fpr=0.1554 | 7033.3 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.25090 | acc=0.8470 | tpr=0.9604 | fpr=0.1551 | 6870.3 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.24994 | acc=0.8474 | tpr=0.9598 | fpr=0.1547 | 13720.5 samples/s | 53.6 steps/s
Avg test loss: 0.24975, Avg test acc: 0.84749, Avg tpr: 0.95959, Avg fpr: 0.15454, total FA: 21458

server round 5/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.19299 | Reg=0.00215 | acc=0.8281 | L2-Norm=14.668 | L2-Norm(final)=2.442 | 4366.2 samples/s | 68.2 steps/s
[Step=4050 Epoch=19.7] | Loss=0.06481 | Reg=0.00219 | acc=0.9531 | L2-Norm=14.783 | L2-Norm(final)=2.436 | 4150.8 samples/s | 64.9 steps/s
[Step=4100 Epoch=20.0] | Loss=0.05606 | Reg=0.00220 | acc=0.9688 | L2-Norm=14.842 | L2-Norm(final)=2.433 | 4288.9 samples/s | 67.0 steps/s
[Step=4150 Epoch=20.2] | Loss=0.05234 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.888 | L2-Norm(final)=2.434 | 4293.3 samples/s | 67.1 steps/s
[Step=4200 Epoch=20.5] | Loss=0.05015 | Reg=0.00223 | acc=0.9219 | L2-Norm=14.926 | L2-Norm(final)=2.435 | 5874.3 samples/s | 91.8 steps/s
[Step=4250 Epoch=20.7] | Loss=0.04657 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.964 | L2-Norm(final)=2.431 | 1880.4 samples/s | 29.4 steps/s
[Step=4300 Epoch=21.0] | Loss=0.04306 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.001 | L2-Norm(final)=2.432 | 4229.8 samples/s | 66.1 steps/s
[Step=4350 Epoch=21.2] | Loss=0.04015 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.033 | L2-Norm(final)=2.434 | 4223.4 samples/s | 66.0 steps/s
[Step=4400 Epoch=21.5] | Loss=0.03874 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.061 | L2-Norm(final)=2.436 | 5361.1 samples/s | 83.8 steps/s
[Step=4450 Epoch=21.7] | Loss=0.03623 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.085 | L2-Norm(final)=2.437 | 1939.0 samples/s | 30.3 steps/s
[Step=4500 Epoch=21.9] | Loss=0.03464 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.107 | L2-Norm(final)=2.439 | 4246.6 samples/s | 66.4 steps/s
[Step=4550 Epoch=22.2] | Loss=0.03311 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.127 | L2-Norm(final)=2.441 | 4226.8 samples/s | 66.0 steps/s
[Step=4600 Epoch=22.4] | Loss=0.03181 | Reg=0.00229 | acc=0.9688 | L2-Norm=15.146 | L2-Norm(final)=2.444 | 5050.3 samples/s | 78.9 steps/s
[Step=4650 Epoch=22.7] | Loss=0.03094 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.164 | L2-Norm(final)=2.446 | 1999.1 samples/s | 31.2 steps/s
[Step=4700 Epoch=22.9] | Loss=0.02978 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.181 | L2-Norm(final)=2.447 | 4211.9 samples/s | 65.8 steps/s
[Step=4750 Epoch=23.2] | Loss=0.02880 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.198 | L2-Norm(final)=2.449 | 4271.3 samples/s | 66.7 steps/s
[Step=4800 Epoch=23.4] | Loss=0.02814 | Reg=0.00232 | acc=0.9844 | L2-Norm=15.215 | L2-Norm(final)=2.452 | 4723.7 samples/s | 73.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step4800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.22112 | Reg=0.00215 | acc=0.8438 | L2-Norm=14.668 | L2-Norm(final)=2.442 | 4355.7 samples/s | 68.1 steps/s
[Step=4050 Epoch=19.8] | Loss=0.06207 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.796 | L2-Norm(final)=2.438 | 4121.1 samples/s | 64.4 steps/s
[Step=4100 Epoch=20.0] | Loss=0.05580 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.868 | L2-Norm(final)=2.438 | 4338.2 samples/s | 67.8 steps/s
[Step=4150 Epoch=20.3] | Loss=0.05013 | Reg=0.00222 | acc=0.9531 | L2-Norm=14.911 | L2-Norm(final)=2.437 | 4327.2 samples/s | 67.6 steps/s
[Step=4200 Epoch=20.5] | Loss=0.04553 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.947 | L2-Norm(final)=2.437 | 5893.9 samples/s | 92.1 steps/s
[Step=4250 Epoch=20.7] | Loss=0.04252 | Reg=0.00224 | acc=0.9688 | L2-Norm=14.977 | L2-Norm(final)=2.438 | 1887.9 samples/s | 29.5 steps/s
[Step=4300 Epoch=21.0] | Loss=0.03919 | Reg=0.00225 | acc=0.9844 | L2-Norm=15.004 | L2-Norm(final)=2.440 | 4209.4 samples/s | 65.8 steps/s
[Step=4350 Epoch=21.2] | Loss=0.03695 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.027 | L2-Norm(final)=2.441 | 4283.7 samples/s | 66.9 steps/s
[Step=4400 Epoch=21.5] | Loss=0.03531 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.046 | L2-Norm(final)=2.442 | 5524.5 samples/s | 86.3 steps/s
[Step=4450 Epoch=21.7] | Loss=0.03411 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.064 | L2-Norm(final)=2.442 | 1906.0 samples/s | 29.8 steps/s
[Step=4500 Epoch=22.0] | Loss=0.03243 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.080 | L2-Norm(final)=2.443 | 4175.0 samples/s | 65.2 steps/s
[Step=4550 Epoch=22.2] | Loss=0.03071 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.097 | L2-Norm(final)=2.445 | 4195.1 samples/s | 65.5 steps/s
[Step=4600 Epoch=22.4] | Loss=0.03032 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.113 | L2-Norm(final)=2.446 | 5062.7 samples/s | 79.1 steps/s
[Step=4650 Epoch=22.7] | Loss=0.02907 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.129 | L2-Norm(final)=2.447 | 1974.5 samples/s | 30.9 steps/s
[Step=4700 Epoch=22.9] | Loss=0.02806 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.143 | L2-Norm(final)=2.448 | 4270.6 samples/s | 66.7 steps/s
[Step=4750 Epoch=23.2] | Loss=0.02721 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.157 | L2-Norm(final)=2.450 | 4270.5 samples/s | 66.7 steps/s
[Step=4800 Epoch=23.4] | Loss=0.02677 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.169 | L2-Norm(final)=2.450 | 4800.5 samples/s | 75.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step4800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=37.9] | Loss=0.03970 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.668 | L2-Norm(final)=2.442 | 4199.8 samples/s | 65.6 steps/s
[Step=4050 Epoch=38.4] | Loss=0.00377 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.845 | L2-Norm(final)=2.456 | 3870.3 samples/s | 60.5 steps/s
[Step=4100 Epoch=38.9] | Loss=0.00250 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.876 | L2-Norm(final)=2.462 | 5452.0 samples/s | 85.2 steps/s
[Step=4150 Epoch=39.3] | Loss=0.00213 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.877 | L2-Norm(final)=2.466 | 1821.5 samples/s | 28.5 steps/s
[Step=4200 Epoch=39.8] | Loss=0.00226 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.868 | L2-Norm(final)=2.468 | 5083.1 samples/s | 79.4 steps/s
[Step=4250 Epoch=40.3] | Loss=0.00369 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.884 | L2-Norm(final)=2.466 | 1864.5 samples/s | 29.1 steps/s
[Step=4300 Epoch=40.7] | Loss=0.00360 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.926 | L2-Norm(final)=2.460 | 4768.0 samples/s | 74.5 steps/s
[Step=4350 Epoch=41.2] | Loss=0.00311 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.953 | L2-Norm(final)=2.456 | 1957.4 samples/s | 30.6 steps/s
[Step=4400 Epoch=41.7] | Loss=0.00272 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.966 | L2-Norm(final)=2.453 | 4445.3 samples/s | 69.5 steps/s
[Step=4450 Epoch=42.2] | Loss=0.00242 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.970 | L2-Norm(final)=2.452 | 2000.1 samples/s | 31.3 steps/s
[Step=4500 Epoch=42.6] | Loss=0.00218 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.966 | L2-Norm(final)=2.451 | 4291.8 samples/s | 67.1 steps/s
[Step=4550 Epoch=43.1] | Loss=0.00199 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.958 | L2-Norm(final)=2.450 | 2049.8 samples/s | 32.0 steps/s
[Step=4600 Epoch=43.6] | Loss=0.00182 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.946 | L2-Norm(final)=2.449 | 4094.0 samples/s | 64.0 steps/s
[Step=4650 Epoch=44.1] | Loss=0.00168 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.932 | L2-Norm(final)=2.448 | 2062.1 samples/s | 32.2 steps/s
[Step=4700 Epoch=44.5] | Loss=0.00156 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.916 | L2-Norm(final)=2.448 | 4053.1 samples/s | 63.3 steps/s
[Step=4750 Epoch=45.0] | Loss=0.00146 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.898 | L2-Norm(final)=2.447 | 2069.8 samples/s | 32.3 steps/s
[Step=4800 Epoch=45.5] | Loss=0.00137 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.879 | L2-Norm(final)=2.447 | 4003.5 samples/s | 62.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step4800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=38.1] | Loss=0.05254 | Reg=0.00215 | acc=0.9375 | L2-Norm=14.668 | L2-Norm(final)=2.442 | 4339.0 samples/s | 67.8 steps/s
[Step=4050 Epoch=38.5] | Loss=0.01737 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.881 | L2-Norm(final)=2.438 | 3865.2 samples/s | 60.4 steps/s
[Step=4100 Epoch=39.0] | Loss=0.01328 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.092 | L2-Norm(final)=2.409 | 5701.2 samples/s | 89.1 steps/s
[Step=4150 Epoch=39.5] | Loss=0.00932 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.175 | L2-Norm(final)=2.395 | 1806.7 samples/s | 28.2 steps/s
[Step=4200 Epoch=40.0] | Loss=0.00733 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.205 | L2-Norm(final)=2.389 | 5051.3 samples/s | 78.9 steps/s
[Step=4250 Epoch=40.4] | Loss=0.00599 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.215 | L2-Norm(final)=2.387 | 1868.4 samples/s | 29.2 steps/s
[Step=4300 Epoch=40.9] | Loss=0.00500 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.214 | L2-Norm(final)=2.386 | 4789.3 samples/s | 74.8 steps/s
[Step=4350 Epoch=41.4] | Loss=0.00429 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.203 | L2-Norm(final)=2.386 | 1920.4 samples/s | 30.0 steps/s
[Step=4400 Epoch=41.9] | Loss=0.00376 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.187 | L2-Norm(final)=2.386 | 4489.8 samples/s | 70.2 steps/s
[Step=4450 Epoch=42.3] | Loss=0.00334 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.167 | L2-Norm(final)=2.386 | 2008.8 samples/s | 31.4 steps/s
[Step=4500 Epoch=42.8] | Loss=0.00301 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.145 | L2-Norm(final)=2.387 | 4141.0 samples/s | 64.7 steps/s
[Step=4550 Epoch=43.3] | Loss=0.00274 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.121 | L2-Norm(final)=2.387 | 2027.6 samples/s | 31.7 steps/s
[Step=4600 Epoch=43.8] | Loss=0.00251 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.096 | L2-Norm(final)=2.387 | 4168.2 samples/s | 65.1 steps/s
[Step=4650 Epoch=44.2] | Loss=0.00231 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.069 | L2-Norm(final)=2.387 | 2067.3 samples/s | 32.3 steps/s
[Step=4700 Epoch=44.7] | Loss=0.00215 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.042 | L2-Norm(final)=2.388 | 4036.3 samples/s | 63.1 steps/s
[Step=4750 Epoch=45.2] | Loss=0.00201 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.015 | L2-Norm(final)=2.388 | 2069.7 samples/s | 32.3 steps/s
[Step=4800 Epoch=45.7] | Loss=0.00188 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.987 | L2-Norm(final)=2.388 | 3971.3 samples/s | 62.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.69668 | acc=0.5344 | tpr=0.3450 | fpr=0.0545 | 3882.5 samples/s | 15.2 steps/s
Avg test loss: 0.69772, Avg test acc: 0.53530, Avg tpr: 0.34948, Avg fpr: 0.05602, total FA: 437

Testing server on iccad2012
[Step=  50] | Loss=0.13548 | acc=0.9291 | tpr=0.9558 | fpr=0.0714 | 3891.8 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.14032 | acc=0.9285 | tpr=0.9638 | fpr=0.0721 | 7304.5 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.14279 | acc=0.9288 | tpr=0.9625 | fpr=0.0718 | 7236.4 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.14435 | acc=0.9289 | tpr=0.9650 | fpr=0.0718 | 7162.8 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.14362 | acc=0.9288 | tpr=0.9642 | fpr=0.0718 | 7065.5 samples/s | 27.6 steps/s
[Step= 300] | Loss=0.14462 | acc=0.9287 | tpr=0.9636 | fpr=0.0720 | 7226.3 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.14566 | acc=0.9288 | tpr=0.9631 | fpr=0.0719 | 7173.1 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.14619 | acc=0.9287 | tpr=0.9633 | fpr=0.0719 | 7193.8 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.14773 | acc=0.9279 | tpr=0.9615 | fpr=0.0727 | 6960.4 samples/s | 27.2 steps/s
[Step= 500] | Loss=0.14728 | acc=0.9280 | tpr=0.9630 | fpr=0.0726 | 7148.2 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.14686 | acc=0.9282 | tpr=0.9638 | fpr=0.0725 | 13152.8 samples/s | 51.4 steps/s
Avg test loss: 0.14663, Avg test acc: 0.92825, Avg tpr: 0.96355, Avg fpr: 0.07239, total FA: 10051

server round 6/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=23.4] | Loss=0.61366 | Reg=0.00210 | acc=0.5781 | L2-Norm=14.501 | L2-Norm(final)=2.436 | 4373.0 samples/s | 68.3 steps/s
[Step=4850 Epoch=23.6] | Loss=0.10136 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.717 | L2-Norm(final)=2.396 | 3917.4 samples/s | 61.2 steps/s
[Step=4900 Epoch=23.9] | Loss=0.07309 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.824 | L2-Norm(final)=2.410 | 4205.4 samples/s | 65.7 steps/s
[Step=4950 Epoch=24.1] | Loss=0.06266 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.888 | L2-Norm(final)=2.416 | 4245.8 samples/s | 66.3 steps/s
[Step=5000 Epoch=24.4] | Loss=0.05556 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.935 | L2-Norm(final)=2.419 | 5739.7 samples/s | 89.7 steps/s
[Step=5050 Epoch=24.6] | Loss=0.04952 | Reg=0.00224 | acc=0.9688 | L2-Norm=14.977 | L2-Norm(final)=2.422 | 1901.5 samples/s | 29.7 steps/s
[Step=5100 Epoch=24.9] | Loss=0.04552 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.011 | L2-Norm(final)=2.424 | 4354.5 samples/s | 68.0 steps/s
[Step=5150 Epoch=25.1] | Loss=0.04242 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.040 | L2-Norm(final)=2.427 | 4197.5 samples/s | 65.6 steps/s
[Step=5200 Epoch=25.4] | Loss=0.03996 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.066 | L2-Norm(final)=2.430 | 5520.9 samples/s | 86.3 steps/s
[Step=5250 Epoch=25.6] | Loss=0.03742 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.091 | L2-Norm(final)=2.433 | 1954.0 samples/s | 30.5 steps/s
[Step=5300 Epoch=25.8] | Loss=0.03600 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.114 | L2-Norm(final)=2.436 | 4342.6 samples/s | 67.9 steps/s
[Step=5350 Epoch=26.1] | Loss=0.03438 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.135 | L2-Norm(final)=2.439 | 4208.3 samples/s | 65.8 steps/s
[Step=5400 Epoch=26.3] | Loss=0.03295 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.153 | L2-Norm(final)=2.441 | 5054.1 samples/s | 79.0 steps/s
[Step=5450 Epoch=26.6] | Loss=0.03239 | Reg=0.00230 | acc=0.9688 | L2-Norm=15.172 | L2-Norm(final)=2.443 | 1989.9 samples/s | 31.1 steps/s
[Step=5500 Epoch=26.8] | Loss=0.03155 | Reg=0.00231 | acc=0.9844 | L2-Norm=15.192 | L2-Norm(final)=2.444 | 4254.6 samples/s | 66.5 steps/s
[Step=5550 Epoch=27.1] | Loss=0.03106 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.213 | L2-Norm(final)=2.444 | 4267.7 samples/s | 66.7 steps/s
[Step=5600 Epoch=27.3] | Loss=0.03053 | Reg=0.00232 | acc=0.9688 | L2-Norm=15.234 | L2-Norm(final)=2.444 | 4596.4 samples/s | 71.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step5600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=23.4] | Loss=0.58124 | Reg=0.00210 | acc=0.5625 | L2-Norm=14.501 | L2-Norm(final)=2.437 | 4360.7 samples/s | 68.1 steps/s
[Step=4850 Epoch=23.7] | Loss=0.08445 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.716 | L2-Norm(final)=2.415 | 4186.0 samples/s | 65.4 steps/s
[Step=4900 Epoch=23.9] | Loss=0.06698 | Reg=0.00219 | acc=0.9531 | L2-Norm=14.807 | L2-Norm(final)=2.417 | 4399.8 samples/s | 68.7 steps/s
[Step=4950 Epoch=24.2] | Loss=0.05565 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.859 | L2-Norm(final)=2.419 | 4380.9 samples/s | 68.5 steps/s
[Step=5000 Epoch=24.4] | Loss=0.05100 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.901 | L2-Norm(final)=2.421 | 5691.0 samples/s | 88.9 steps/s
[Step=5050 Epoch=24.6] | Loss=0.04475 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.938 | L2-Norm(final)=2.426 | 1886.4 samples/s | 29.5 steps/s
[Step=5100 Epoch=24.9] | Loss=0.04069 | Reg=0.00224 | acc=0.9531 | L2-Norm=14.969 | L2-Norm(final)=2.432 | 4170.8 samples/s | 65.2 steps/s
[Step=5150 Epoch=25.1] | Loss=0.03851 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.994 | L2-Norm(final)=2.435 | 4226.1 samples/s | 66.0 steps/s
[Step=5200 Epoch=25.4] | Loss=0.03659 | Reg=0.00226 | acc=0.9688 | L2-Norm=15.017 | L2-Norm(final)=2.438 | 5478.3 samples/s | 85.6 steps/s
[Step=5250 Epoch=25.6] | Loss=0.03473 | Reg=0.00226 | acc=0.9844 | L2-Norm=15.038 | L2-Norm(final)=2.439 | 1913.4 samples/s | 29.9 steps/s
[Step=5300 Epoch=25.9] | Loss=0.03309 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.057 | L2-Norm(final)=2.441 | 4270.9 samples/s | 66.7 steps/s
[Step=5350 Epoch=26.1] | Loss=0.03176 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.076 | L2-Norm(final)=2.443 | 4324.8 samples/s | 67.6 steps/s
[Step=5400 Epoch=26.3] | Loss=0.03126 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.094 | L2-Norm(final)=2.445 | 5159.8 samples/s | 80.6 steps/s
[Step=5450 Epoch=26.6] | Loss=0.03014 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.113 | L2-Norm(final)=2.446 | 1977.9 samples/s | 30.9 steps/s
[Step=5500 Epoch=26.8] | Loss=0.02947 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.130 | L2-Norm(final)=2.447 | 4296.3 samples/s | 67.1 steps/s
[Step=5550 Epoch=27.1] | Loss=0.02839 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.147 | L2-Norm(final)=2.448 | 4284.8 samples/s | 67.0 steps/s
[Step=5600 Epoch=27.3] | Loss=0.02712 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.163 | L2-Norm(final)=2.450 | 4836.4 samples/s | 75.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step5600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.5] | Loss=0.04084 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.501 | L2-Norm(final)=2.440 | 4101.9 samples/s | 64.1 steps/s
[Step=4850 Epoch=46.0] | Loss=0.00221 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.570 | L2-Norm(final)=2.465 | 3837.7 samples/s | 60.0 steps/s
[Step=4900 Epoch=46.4] | Loss=0.00447 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.592 | L2-Norm(final)=2.466 | 5562.4 samples/s | 86.9 steps/s
[Step=4950 Epoch=46.9] | Loss=0.00555 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.638 | L2-Norm(final)=2.461 | 1830.0 samples/s | 28.6 steps/s
[Step=5000 Epoch=47.4] | Loss=0.00505 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.697 | L2-Norm(final)=2.459 | 5178.5 samples/s | 80.9 steps/s
[Step=5050 Epoch=47.9] | Loss=0.00423 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.742 | L2-Norm(final)=2.457 | 1857.1 samples/s | 29.0 steps/s
[Step=5100 Epoch=48.3] | Loss=0.00356 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.767 | L2-Norm(final)=2.458 | 4750.4 samples/s | 74.2 steps/s
[Step=5150 Epoch=48.8] | Loss=0.00306 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.778 | L2-Norm(final)=2.459 | 1921.5 samples/s | 30.0 steps/s
[Step=5200 Epoch=49.3] | Loss=0.00268 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.779 | L2-Norm(final)=2.460 | 4348.7 samples/s | 67.9 steps/s
[Step=5250 Epoch=49.7] | Loss=0.00238 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.772 | L2-Norm(final)=2.462 | 1989.1 samples/s | 31.1 steps/s
[Step=5300 Epoch=50.2] | Loss=0.00215 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.761 | L2-Norm(final)=2.463 | 4156.3 samples/s | 64.9 steps/s
[Step=5350 Epoch=50.7] | Loss=0.00195 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.747 | L2-Norm(final)=2.464 | 2043.0 samples/s | 31.9 steps/s
[Step=5400 Epoch=51.2] | Loss=0.00179 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.730 | L2-Norm(final)=2.464 | 3981.7 samples/s | 62.2 steps/s
[Step=5450 Epoch=51.6] | Loss=0.00165 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.711 | L2-Norm(final)=2.465 | 2027.4 samples/s | 31.7 steps/s
[Step=5500 Epoch=52.1] | Loss=0.00153 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.691 | L2-Norm(final)=2.466 | 4095.7 samples/s | 64.0 steps/s
[Step=5550 Epoch=52.6] | Loss=0.00143 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.670 | L2-Norm(final)=2.466 | 2074.2 samples/s | 32.4 steps/s
[Step=5600 Epoch=53.1] | Loss=0.00134 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.648 | L2-Norm(final)=2.467 | 4048.2 samples/s | 63.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step5600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.7] | Loss=0.07461 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.501 | L2-Norm(final)=2.439 | 4328.2 samples/s | 67.6 steps/s
[Step=4850 Epoch=46.1] | Loss=0.00436 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.604 | L2-Norm(final)=2.449 | 3901.8 samples/s | 61.0 steps/s
[Step=4900 Epoch=46.6] | Loss=0.00238 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.631 | L2-Norm(final)=2.460 | 5576.8 samples/s | 87.1 steps/s
[Step=4950 Epoch=47.1] | Loss=0.00160 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.622 | L2-Norm(final)=2.466 | 1784.0 samples/s | 27.9 steps/s
[Step=5000 Epoch=47.6] | Loss=0.00121 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.599 | L2-Norm(final)=2.469 | 5118.4 samples/s | 80.0 steps/s
[Step=5050 Epoch=48.0] | Loss=0.00097 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.571 | L2-Norm(final)=2.471 | 1860.4 samples/s | 29.1 steps/s
[Step=5100 Epoch=48.5] | Loss=0.00081 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.540 | L2-Norm(final)=2.473 | 4709.1 samples/s | 73.6 steps/s
[Step=5150 Epoch=49.0] | Loss=0.00069 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.508 | L2-Norm(final)=2.475 | 1919.2 samples/s | 30.0 steps/s
[Step=5200 Epoch=49.5] | Loss=0.00061 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.476 | L2-Norm(final)=2.476 | 4419.6 samples/s | 69.1 steps/s
[Step=5250 Epoch=49.9] | Loss=0.00054 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.443 | L2-Norm(final)=2.477 | 1984.1 samples/s | 31.0 steps/s
[Step=5300 Epoch=50.4] | Loss=0.00049 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.410 | L2-Norm(final)=2.477 | 4089.0 samples/s | 63.9 steps/s
[Step=5350 Epoch=50.9] | Loss=0.00044 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.377 | L2-Norm(final)=2.478 | 2037.9 samples/s | 31.8 steps/s
[Step=5400 Epoch=51.4] | Loss=0.00040 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.344 | L2-Norm(final)=2.479 | 4164.4 samples/s | 65.1 steps/s
[Step=5450 Epoch=51.8] | Loss=0.00037 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.311 | L2-Norm(final)=2.479 | 2060.2 samples/s | 32.2 steps/s
[Step=5500 Epoch=52.3] | Loss=0.00035 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.278 | L2-Norm(final)=2.480 | 4154.2 samples/s | 64.9 steps/s
[Step=5550 Epoch=52.8] | Loss=0.00032 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.246 | L2-Norm(final)=2.480 | 2072.0 samples/s | 32.4 steps/s
[Step=5600 Epoch=53.3] | Loss=0.00030 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.213 | L2-Norm(final)=2.481 | 4062.9 samples/s | 63.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30223 | acc=0.7971 | tpr=0.7196 | fpr=0.0347 | 3926.2 samples/s | 15.3 steps/s
Avg test loss: 0.30636, Avg test acc: 0.79818, Avg tpr: 0.72198, Avg fpr: 0.03423, total FA: 267

Testing server on iccad2012
[Step=  50] | Loss=0.39943 | acc=0.7687 | tpr=0.9513 | fpr=0.2346 | 3941.9 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.40358 | acc=0.7671 | tpr=0.9659 | fpr=0.2366 | 6973.1 samples/s | 27.2 steps/s
[Step= 150] | Loss=0.40525 | acc=0.7680 | tpr=0.9640 | fpr=0.2356 | 7409.4 samples/s | 28.9 steps/s
[Step= 200] | Loss=0.40587 | acc=0.7677 | tpr=0.9650 | fpr=0.2359 | 6984.5 samples/s | 27.3 steps/s
[Step= 250] | Loss=0.40443 | acc=0.7677 | tpr=0.9651 | fpr=0.2359 | 7231.6 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.40684 | acc=0.7671 | tpr=0.9629 | fpr=0.2364 | 7224.8 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.40851 | acc=0.7671 | tpr=0.9631 | fpr=0.2364 | 7167.9 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.40942 | acc=0.7669 | tpr=0.9633 | fpr=0.2367 | 7227.1 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.41198 | acc=0.7663 | tpr=0.9635 | fpr=0.2373 | 7058.4 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.41064 | acc=0.7665 | tpr=0.9648 | fpr=0.2371 | 7281.7 samples/s | 28.4 steps/s
[Step= 550] | Loss=0.40916 | acc=0.7667 | tpr=0.9638 | fpr=0.2369 | 13149.7 samples/s | 51.4 steps/s
Avg test loss: 0.40874, Avg test acc: 0.76681, Avg tpr: 0.96395, Avg fpr: 0.23677, total FA: 32875

server round 7/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=27.3] | Loss=0.19430 | Reg=0.00206 | acc=0.8125 | L2-Norm=14.344 | L2-Norm(final)=2.468 | 4581.1 samples/s | 71.6 steps/s
[Step=5650 Epoch=27.6] | Loss=0.06170 | Reg=0.00209 | acc=0.9688 | L2-Norm=14.457 | L2-Norm(final)=2.444 | 4002.0 samples/s | 62.5 steps/s
[Step=5700 Epoch=27.8] | Loss=0.05141 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.522 | L2-Norm(final)=2.441 | 4413.9 samples/s | 69.0 steps/s
[Step=5750 Epoch=28.0] | Loss=0.04363 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.570 | L2-Norm(final)=2.443 | 4121.2 samples/s | 64.4 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04014 | Reg=0.00213 | acc=0.9531 | L2-Norm=14.611 | L2-Norm(final)=2.446 | 5921.5 samples/s | 92.5 steps/s
[Step=5850 Epoch=28.5] | Loss=0.03570 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.649 | L2-Norm(final)=2.449 | 1903.0 samples/s | 29.7 steps/s
[Step=5900 Epoch=28.8] | Loss=0.03315 | Reg=0.00216 | acc=0.9688 | L2-Norm=14.682 | L2-Norm(final)=2.454 | 4314.6 samples/s | 67.4 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03159 | Reg=0.00217 | acc=0.9688 | L2-Norm=14.715 | L2-Norm(final)=2.458 | 4341.5 samples/s | 67.8 steps/s
[Step=6000 Epoch=29.3] | Loss=0.03063 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.745 | L2-Norm(final)=2.460 | 5416.3 samples/s | 84.6 steps/s
[Step=6050 Epoch=29.5] | Loss=0.02899 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.774 | L2-Norm(final)=2.463 | 1932.5 samples/s | 30.2 steps/s
[Step=6100 Epoch=29.7] | Loss=0.02824 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.800 | L2-Norm(final)=2.465 | 4258.8 samples/s | 66.5 steps/s
[Step=6150 Epoch=30.0] | Loss=0.02698 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.825 | L2-Norm(final)=2.469 | 4254.9 samples/s | 66.5 steps/s
[Step=6200 Epoch=30.2] | Loss=0.02642 | Reg=0.00221 | acc=0.9531 | L2-Norm=14.850 | L2-Norm(final)=2.472 | 4989.8 samples/s | 78.0 steps/s
[Step=6250 Epoch=30.5] | Loss=0.02547 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.875 | L2-Norm(final)=2.475 | 1985.2 samples/s | 31.0 steps/s
[Step=6300 Epoch=30.7] | Loss=0.02488 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.897 | L2-Norm(final)=2.476 | 4206.3 samples/s | 65.7 steps/s
[Step=6350 Epoch=31.0] | Loss=0.02427 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.917 | L2-Norm(final)=2.478 | 4180.9 samples/s | 65.3 steps/s
[Step=6400 Epoch=31.2] | Loss=0.02366 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.937 | L2-Norm(final)=2.479 | 4608.7 samples/s | 72.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step6400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=27.3] | Loss=0.17924 | Reg=0.00206 | acc=0.8125 | L2-Norm=14.344 | L2-Norm(final)=2.469 | 4096.6 samples/s | 64.0 steps/s
[Step=5650 Epoch=27.6] | Loss=0.05825 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.499 | L2-Norm(final)=2.452 | 4310.4 samples/s | 67.4 steps/s
[Step=5700 Epoch=27.8] | Loss=0.04756 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.583 | L2-Norm(final)=2.454 | 4252.8 samples/s | 66.5 steps/s
[Step=5750 Epoch=28.1] | Loss=0.04252 | Reg=0.00214 | acc=0.9688 | L2-Norm=14.637 | L2-Norm(final)=2.452 | 4334.5 samples/s | 67.7 steps/s
[Step=5800 Epoch=28.3] | Loss=0.04067 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.679 | L2-Norm(final)=2.449 | 5820.7 samples/s | 90.9 steps/s
[Step=5850 Epoch=28.5] | Loss=0.03665 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.718 | L2-Norm(final)=2.448 | 1873.5 samples/s | 29.3 steps/s
[Step=5900 Epoch=28.8] | Loss=0.03492 | Reg=0.00218 | acc=0.9375 | L2-Norm=14.752 | L2-Norm(final)=2.448 | 4313.3 samples/s | 67.4 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03310 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.781 | L2-Norm(final)=2.447 | 4344.2 samples/s | 67.9 steps/s
[Step=6000 Epoch=29.3] | Loss=0.03179 | Reg=0.00219 | acc=0.9688 | L2-Norm=14.807 | L2-Norm(final)=2.445 | 5454.6 samples/s | 85.2 steps/s
[Step=6050 Epoch=29.5] | Loss=0.03024 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.829 | L2-Norm(final)=2.444 | 1926.6 samples/s | 30.1 steps/s
[Step=6100 Epoch=29.8] | Loss=0.02878 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.850 | L2-Norm(final)=2.444 | 4341.4 samples/s | 67.8 steps/s
[Step=6150 Epoch=30.0] | Loss=0.02751 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.869 | L2-Norm(final)=2.445 | 4146.3 samples/s | 64.8 steps/s
[Step=6200 Epoch=30.3] | Loss=0.02656 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.888 | L2-Norm(final)=2.446 | 5213.3 samples/s | 81.5 steps/s
[Step=6250 Epoch=30.5] | Loss=0.02548 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.907 | L2-Norm(final)=2.447 | 1943.1 samples/s | 30.4 steps/s
[Step=6300 Epoch=30.7] | Loss=0.02466 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.925 | L2-Norm(final)=2.449 | 4248.2 samples/s | 66.4 steps/s
[Step=6350 Epoch=31.0] | Loss=0.02396 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.942 | L2-Norm(final)=2.450 | 4223.3 samples/s | 66.0 steps/s
[Step=6400 Epoch=31.2] | Loss=0.02329 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.957 | L2-Norm(final)=2.451 | 4781.1 samples/s | 74.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step6400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=53.1] | Loss=0.16932 | Reg=0.00206 | acc=0.8906 | L2-Norm=14.344 | L2-Norm(final)=2.466 | 3790.3 samples/s | 59.2 steps/s
[Step=5650 Epoch=53.5] | Loss=0.00750 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.713 | L2-Norm(final)=2.457 | 3902.4 samples/s | 61.0 steps/s
[Step=5700 Epoch=54.0] | Loss=0.00409 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.777 | L2-Norm(final)=2.463 | 5569.1 samples/s | 87.0 steps/s
[Step=5750 Epoch=54.5] | Loss=0.00555 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.796 | L2-Norm(final)=2.460 | 1820.2 samples/s | 28.4 steps/s
[Step=5800 Epoch=55.0] | Loss=0.00531 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.833 | L2-Norm(final)=2.449 | 5114.3 samples/s | 79.9 steps/s
[Step=5850 Epoch=55.4] | Loss=0.00441 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.857 | L2-Norm(final)=2.443 | 1865.3 samples/s | 29.1 steps/s
[Step=5900 Epoch=55.9] | Loss=0.00372 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.866 | L2-Norm(final)=2.440 | 4740.0 samples/s | 74.1 steps/s
[Step=5950 Epoch=56.4] | Loss=0.00319 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.866 | L2-Norm(final)=2.439 | 1917.1 samples/s | 30.0 steps/s
[Step=6000 Epoch=56.9] | Loss=0.00279 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.858 | L2-Norm(final)=2.438 | 4383.9 samples/s | 68.5 steps/s
[Step=6050 Epoch=57.3] | Loss=0.00248 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.845 | L2-Norm(final)=2.438 | 1964.7 samples/s | 30.7 steps/s
[Step=6100 Epoch=57.8] | Loss=0.00223 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.828 | L2-Norm(final)=2.438 | 4109.5 samples/s | 64.2 steps/s
[Step=6150 Epoch=58.3] | Loss=0.00203 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.810 | L2-Norm(final)=2.438 | 2026.1 samples/s | 31.7 steps/s
[Step=6200 Epoch=58.8] | Loss=0.00186 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.789 | L2-Norm(final)=2.438 | 4126.4 samples/s | 64.5 steps/s
[Step=6250 Epoch=59.2] | Loss=0.00172 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.767 | L2-Norm(final)=2.438 | 2025.3 samples/s | 31.6 steps/s
[Step=6300 Epoch=59.7] | Loss=0.00160 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.745 | L2-Norm(final)=2.438 | 4067.5 samples/s | 63.6 steps/s
[Step=6350 Epoch=60.2] | Loss=0.00149 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.722 | L2-Norm(final)=2.438 | 2042.8 samples/s | 31.9 steps/s
[Step=6400 Epoch=60.6] | Loss=0.00140 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.698 | L2-Norm(final)=2.438 | 4031.4 samples/s | 63.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step6400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=53.3] | Loss=0.09468 | Reg=0.00206 | acc=0.9062 | L2-Norm=14.344 | L2-Norm(final)=2.468 | 4500.5 samples/s | 70.3 steps/s
[Step=5650 Epoch=53.7] | Loss=0.00970 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.726 | L2-Norm(final)=2.470 | 3706.7 samples/s | 57.9 steps/s
[Step=5700 Epoch=54.2] | Loss=0.00948 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.850 | L2-Norm(final)=2.462 | 5481.9 samples/s | 85.7 steps/s
[Step=5750 Epoch=54.7] | Loss=0.00664 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.919 | L2-Norm(final)=2.452 | 1815.4 samples/s | 28.4 steps/s
[Step=5800 Epoch=55.2] | Loss=0.00500 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.942 | L2-Norm(final)=2.450 | 5161.2 samples/s | 80.6 steps/s
[Step=5850 Epoch=55.6] | Loss=0.00400 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.942 | L2-Norm(final)=2.450 | 1869.9 samples/s | 29.2 steps/s
[Step=5900 Epoch=56.1] | Loss=0.00334 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.929 | L2-Norm(final)=2.450 | 4722.6 samples/s | 73.8 steps/s
[Step=5950 Epoch=56.6] | Loss=0.00286 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.910 | L2-Norm(final)=2.451 | 1935.9 samples/s | 30.2 steps/s
[Step=6000 Epoch=57.1] | Loss=0.00251 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.887 | L2-Norm(final)=2.451 | 4339.2 samples/s | 67.8 steps/s
[Step=6050 Epoch=57.6] | Loss=0.00223 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.861 | L2-Norm(final)=2.451 | 1990.1 samples/s | 31.1 steps/s
[Step=6100 Epoch=58.0] | Loss=0.00201 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.834 | L2-Norm(final)=2.452 | 4158.2 samples/s | 65.0 steps/s
[Step=6150 Epoch=58.5] | Loss=0.00182 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.806 | L2-Norm(final)=2.452 | 2089.2 samples/s | 32.6 steps/s
[Step=6200 Epoch=59.0] | Loss=0.00167 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.778 | L2-Norm(final)=2.453 | 4080.8 samples/s | 63.8 steps/s
[Step=6250 Epoch=59.5] | Loss=0.00155 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.748 | L2-Norm(final)=2.453 | 2045.4 samples/s | 32.0 steps/s
[Step=6300 Epoch=59.9] | Loss=0.00144 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.719 | L2-Norm(final)=2.454 | 4107.7 samples/s | 64.2 steps/s
[Step=6350 Epoch=60.4] | Loss=0.00134 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.689 | L2-Norm(final)=2.454 | 2069.4 samples/s | 32.3 steps/s
[Step=6400 Epoch=60.9] | Loss=0.00126 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.659 | L2-Norm(final)=2.454 | 4133.9 samples/s | 64.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.88900 | acc=0.5113 | tpr=0.3023 | fpr=0.0347 | 3970.2 samples/s | 15.5 steps/s
Avg test loss: 0.88483, Avg test acc: 0.51146, Avg tpr: 0.30472, Avg fpr: 0.03384, total FA: 264

Testing server on iccad2012
[Step=  50] | Loss=0.13498 | acc=0.9421 | tpr=0.9558 | fpr=0.0581 | 3887.0 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.13722 | acc=0.9416 | tpr=0.9595 | fpr=0.0587 | 7167.8 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.14204 | acc=0.9406 | tpr=0.9568 | fpr=0.0597 | 7151.8 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.14306 | acc=0.9409 | tpr=0.9617 | fpr=0.0594 | 7277.3 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.14185 | acc=0.9409 | tpr=0.9616 | fpr=0.0595 | 7220.0 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.14327 | acc=0.9407 | tpr=0.9600 | fpr=0.0596 | 7206.2 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.14449 | acc=0.9404 | tpr=0.9599 | fpr=0.0600 | 7181.7 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.14532 | acc=0.9402 | tpr=0.9606 | fpr=0.0601 | 7360.2 samples/s | 28.8 steps/s
[Step= 450] | Loss=0.14690 | acc=0.9396 | tpr=0.9581 | fpr=0.0608 | 6996.4 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.14627 | acc=0.9397 | tpr=0.9599 | fpr=0.0606 | 7063.1 samples/s | 27.6 steps/s
[Step= 550] | Loss=0.14572 | acc=0.9398 | tpr=0.9598 | fpr=0.0605 | 13107.8 samples/s | 51.2 steps/s
Avg test loss: 0.14546, Avg test acc: 0.93988, Avg tpr: 0.95959, Avg fpr: 0.06048, total FA: 8397

server round 8/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=31.2] | Loss=0.73076 | Reg=0.00203 | acc=0.6094 | L2-Norm=14.240 | L2-Norm(final)=2.454 | 4183.7 samples/s | 65.4 steps/s
[Step=6450 Epoch=31.5] | Loss=0.08941 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.439 | L2-Norm(final)=2.423 | 4123.3 samples/s | 64.4 steps/s
[Step=6500 Epoch=31.7] | Loss=0.06534 | Reg=0.00212 | acc=0.9688 | L2-Norm=14.544 | L2-Norm(final)=2.423 | 4195.9 samples/s | 65.6 steps/s
[Step=6550 Epoch=31.9] | Loss=0.05309 | Reg=0.00214 | acc=0.9375 | L2-Norm=14.615 | L2-Norm(final)=2.429 | 4287.4 samples/s | 67.0 steps/s
[Step=6600 Epoch=32.2] | Loss=0.04787 | Reg=0.00215 | acc=0.9531 | L2-Norm=14.666 | L2-Norm(final)=2.434 | 5692.0 samples/s | 88.9 steps/s
[Step=6650 Epoch=32.4] | Loss=0.04304 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.711 | L2-Norm(final)=2.437 | 1876.3 samples/s | 29.3 steps/s
[Step=6700 Epoch=32.7] | Loss=0.03930 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.749 | L2-Norm(final)=2.441 | 4257.7 samples/s | 66.5 steps/s
[Step=6750 Epoch=32.9] | Loss=0.03646 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.781 | L2-Norm(final)=2.445 | 4218.7 samples/s | 65.9 steps/s
[Step=6800 Epoch=33.2] | Loss=0.03448 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.810 | L2-Norm(final)=2.447 | 5299.8 samples/s | 82.8 steps/s
[Step=6850 Epoch=33.4] | Loss=0.03219 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.836 | L2-Norm(final)=2.449 | 1929.9 samples/s | 30.2 steps/s
[Step=6900 Epoch=33.6] | Loss=0.03078 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.861 | L2-Norm(final)=2.452 | 4250.3 samples/s | 66.4 steps/s
[Step=6950 Epoch=33.9] | Loss=0.02917 | Reg=0.00222 | acc=0.9688 | L2-Norm=14.884 | L2-Norm(final)=2.454 | 4233.7 samples/s | 66.2 steps/s
[Step=7000 Epoch=34.1] | Loss=0.02902 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.905 | L2-Norm(final)=2.455 | 4963.1 samples/s | 77.5 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02794 | Reg=0.00223 | acc=0.9688 | L2-Norm=14.927 | L2-Norm(final)=2.455 | 1974.1 samples/s | 30.8 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02663 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.949 | L2-Norm(final)=2.458 | 4309.8 samples/s | 67.3 steps/s
[Step=7150 Epoch=34.9] | Loss=0.02562 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.969 | L2-Norm(final)=2.460 | 4217.9 samples/s | 65.9 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02452 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.987 | L2-Norm(final)=2.462 | 4567.5 samples/s | 71.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step7200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=31.2] | Loss=0.59255 | Reg=0.00203 | acc=0.6094 | L2-Norm=14.240 | L2-Norm(final)=2.455 | 4892.6 samples/s | 76.4 steps/s
[Step=6450 Epoch=31.5] | Loss=0.09427 | Reg=0.00210 | acc=0.9531 | L2-Norm=14.495 | L2-Norm(final)=2.414 | 3663.8 samples/s | 57.2 steps/s
[Step=6500 Epoch=31.7] | Loss=0.06541 | Reg=0.00214 | acc=0.9844 | L2-Norm=14.618 | L2-Norm(final)=2.425 | 4230.9 samples/s | 66.1 steps/s
[Step=6550 Epoch=32.0] | Loss=0.05610 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.687 | L2-Norm(final)=2.429 | 4215.5 samples/s | 65.9 steps/s
[Step=6600 Epoch=32.2] | Loss=0.04919 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.740 | L2-Norm(final)=2.433 | 5823.1 samples/s | 91.0 steps/s
[Step=6650 Epoch=32.4] | Loss=0.04385 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.784 | L2-Norm(final)=2.434 | 1906.0 samples/s | 29.8 steps/s
[Step=6700 Epoch=32.7] | Loss=0.03978 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.823 | L2-Norm(final)=2.439 | 4279.8 samples/s | 66.9 steps/s
[Step=6750 Epoch=32.9] | Loss=0.03731 | Reg=0.00221 | acc=0.9688 | L2-Norm=14.856 | L2-Norm(final)=2.443 | 4235.7 samples/s | 66.2 steps/s
[Step=6800 Epoch=33.2] | Loss=0.03506 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.883 | L2-Norm(final)=2.445 | 5486.6 samples/s | 85.7 steps/s
[Step=6850 Epoch=33.4] | Loss=0.03299 | Reg=0.00222 | acc=0.9844 | L2-Norm=14.906 | L2-Norm(final)=2.447 | 1912.8 samples/s | 29.9 steps/s
[Step=6900 Epoch=33.7] | Loss=0.03135 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.929 | L2-Norm(final)=2.449 | 4250.5 samples/s | 66.4 steps/s
[Step=6950 Epoch=33.9] | Loss=0.02948 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.949 | L2-Norm(final)=2.451 | 4311.7 samples/s | 67.4 steps/s
[Step=7000 Epoch=34.2] | Loss=0.02872 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.966 | L2-Norm(final)=2.453 | 5091.5 samples/s | 79.6 steps/s
[Step=7050 Epoch=34.4] | Loss=0.02743 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.983 | L2-Norm(final)=2.453 | 1964.1 samples/s | 30.7 steps/s
[Step=7100 Epoch=34.6] | Loss=0.02634 | Reg=0.00225 | acc=1.0000 | L2-Norm=14.999 | L2-Norm(final)=2.453 | 4247.3 samples/s | 66.4 steps/s
[Step=7150 Epoch=34.9] | Loss=0.02540 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.014 | L2-Norm(final)=2.454 | 4181.4 samples/s | 65.3 steps/s
[Step=7200 Epoch=35.1] | Loss=0.02493 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.028 | L2-Norm(final)=2.454 | 4790.5 samples/s | 74.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step7200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=60.7] | Loss=0.00993 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.240 | L2-Norm(final)=2.459 | 4438.9 samples/s | 69.4 steps/s
[Step=6450 Epoch=61.1] | Loss=0.00117 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.262 | L2-Norm(final)=2.486 | 3704.2 samples/s | 57.9 steps/s
[Step=6500 Epoch=61.6] | Loss=0.00061 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.247 | L2-Norm(final)=2.497 | 5509.7 samples/s | 86.1 steps/s
[Step=6550 Epoch=62.1] | Loss=0.00041 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.222 | L2-Norm(final)=2.502 | 1806.4 samples/s | 28.2 steps/s
[Step=6600 Epoch=62.5] | Loss=0.00031 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.193 | L2-Norm(final)=2.505 | 5069.9 samples/s | 79.2 steps/s
[Step=6650 Epoch=63.0] | Loss=0.00025 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.164 | L2-Norm(final)=2.507 | 1886.7 samples/s | 29.5 steps/s
[Step=6700 Epoch=63.5] | Loss=0.00021 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.135 | L2-Norm(final)=2.509 | 4712.8 samples/s | 73.6 steps/s
[Step=6750 Epoch=64.0] | Loss=0.00018 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.106 | L2-Norm(final)=2.510 | 1935.1 samples/s | 30.2 steps/s
[Step=6800 Epoch=64.4] | Loss=0.00016 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.076 | L2-Norm(final)=2.512 | 4418.6 samples/s | 69.0 steps/s
[Step=6850 Epoch=64.9] | Loss=0.00014 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.047 | L2-Norm(final)=2.513 | 1984.5 samples/s | 31.0 steps/s
[Step=6900 Epoch=65.4] | Loss=0.00013 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.019 | L2-Norm(final)=2.514 | 4126.2 samples/s | 64.5 steps/s
[Step=6950 Epoch=65.9] | Loss=0.00012 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.990 | L2-Norm(final)=2.515 | 2054.2 samples/s | 32.1 steps/s
[Step=7000 Epoch=66.3] | Loss=0.00011 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.961 | L2-Norm(final)=2.515 | 4055.6 samples/s | 63.4 steps/s
[Step=7050 Epoch=66.8] | Loss=0.00010 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.933 | L2-Norm(final)=2.516 | 2051.8 samples/s | 32.1 steps/s
[Step=7100 Epoch=67.3] | Loss=0.00009 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.905 | L2-Norm(final)=2.517 | 4062.9 samples/s | 63.5 steps/s
[Step=7150 Epoch=67.8] | Loss=0.00009 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.877 | L2-Norm(final)=2.518 | 2050.6 samples/s | 32.0 steps/s
[Step=7200 Epoch=68.2] | Loss=0.00008 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.849 | L2-Norm(final)=2.519 | 4095.8 samples/s | 64.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step7200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=60.9] | Loss=0.01093 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.240 | L2-Norm(final)=2.460 | 4497.9 samples/s | 70.3 steps/s
[Step=6450 Epoch=61.4] | Loss=0.00303 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.296 | L2-Norm(final)=2.477 | 3600.9 samples/s | 56.3 steps/s
[Step=6500 Epoch=61.8] | Loss=0.00293 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.350 | L2-Norm(final)=2.482 | 5535.8 samples/s | 86.5 steps/s
[Step=6550 Epoch=62.3] | Loss=0.00257 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.384 | L2-Norm(final)=2.483 | 1795.2 samples/s | 28.0 steps/s
[Step=6600 Epoch=62.8] | Loss=0.00200 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.406 | L2-Norm(final)=2.483 | 5195.1 samples/s | 81.2 steps/s
[Step=6650 Epoch=63.3] | Loss=0.00232 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.421 | L2-Norm(final)=2.484 | 1864.0 samples/s | 29.1 steps/s
[Step=6700 Epoch=63.7] | Loss=0.00452 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.467 | L2-Norm(final)=2.475 | 4704.9 samples/s | 73.5 steps/s
[Step=6750 Epoch=64.2] | Loss=0.00417 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.534 | L2-Norm(final)=2.461 | 1939.6 samples/s | 30.3 steps/s
[Step=6800 Epoch=64.7] | Loss=0.00367 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.582 | L2-Norm(final)=2.451 | 4363.1 samples/s | 68.2 steps/s
[Step=6850 Epoch=65.2] | Loss=0.00327 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.614 | L2-Norm(final)=2.444 | 1984.9 samples/s | 31.0 steps/s
[Step=6900 Epoch=65.6] | Loss=0.00294 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.634 | L2-Norm(final)=2.438 | 4073.5 samples/s | 63.6 steps/s
[Step=6950 Epoch=66.1] | Loss=0.00268 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.645 | L2-Norm(final)=2.434 | 2010.3 samples/s | 31.4 steps/s
[Step=7000 Epoch=66.6] | Loss=0.00245 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.650 | L2-Norm(final)=2.431 | 4047.2 samples/s | 63.2 steps/s
[Step=7050 Epoch=67.1] | Loss=0.00227 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.650 | L2-Norm(final)=2.428 | 2063.1 samples/s | 32.2 steps/s
[Step=7100 Epoch=67.5] | Loss=0.00211 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.646 | L2-Norm(final)=2.426 | 4228.4 samples/s | 66.1 steps/s
[Step=7150 Epoch=68.0] | Loss=0.00197 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.639 | L2-Norm(final)=2.424 | 2042.8 samples/s | 31.9 steps/s
[Step=7200 Epoch=68.5] | Loss=0.00184 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.629 | L2-Norm(final)=2.422 | 4034.2 samples/s | 63.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23196 | acc=0.8388 | tpr=0.7918 | fpr=0.0590 | 3878.4 samples/s | 15.2 steps/s
Avg test loss: 0.23505, Avg test acc: 0.83889, Avg tpr: 0.79215, Avg fpr: 0.05833, total FA: 455

Testing server on iccad2012
[Step=  50] | Loss=0.42330 | acc=0.7609 | tpr=0.9646 | fpr=0.2427 | 3887.7 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.42569 | acc=0.7607 | tpr=0.9787 | fpr=0.2434 | 7292.6 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.42824 | acc=0.7611 | tpr=0.9784 | fpr=0.2429 | 7111.8 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.42800 | acc=0.7624 | tpr=0.9792 | fpr=0.2416 | 7176.5 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.42700 | acc=0.7625 | tpr=0.9782 | fpr=0.2414 | 5269.3 samples/s | 20.6 steps/s
[Step= 300] | Loss=0.42878 | acc=0.7620 | tpr=0.9767 | fpr=0.2419 | 6929.4 samples/s | 27.1 steps/s
[Step= 350] | Loss=0.43096 | acc=0.7616 | tpr=0.9762 | fpr=0.2423 | 7198.9 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.43171 | acc=0.7623 | tpr=0.9776 | fpr=0.2417 | 7152.8 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.43415 | acc=0.7616 | tpr=0.9766 | fpr=0.2423 | 5854.7 samples/s | 22.9 steps/s
[Step= 500] | Loss=0.43324 | acc=0.7616 | tpr=0.9771 | fpr=0.2423 | 7100.6 samples/s | 27.7 steps/s
[Step= 550] | Loss=0.43202 | acc=0.7619 | tpr=0.9761 | fpr=0.2420 | 13141.3 samples/s | 51.3 steps/s
Avg test loss: 0.43158, Avg test acc: 0.76194, Avg tpr: 0.97623, Avg fpr: 0.24196, total FA: 33595

server round 9/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=35.1] | Loss=0.11015 | Reg=0.00201 | acc=0.8906 | L2-Norm=14.160 | L2-Norm(final)=2.465 | 4781.7 samples/s | 74.7 steps/s
[Step=7250 Epoch=35.4] | Loss=0.04201 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.258 | L2-Norm(final)=2.458 | 3749.0 samples/s | 58.6 steps/s
[Step=7300 Epoch=35.6] | Loss=0.03786 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.334 | L2-Norm(final)=2.462 | 4285.5 samples/s | 67.0 steps/s
[Step=7350 Epoch=35.8] | Loss=0.03755 | Reg=0.00207 | acc=0.9219 | L2-Norm=14.393 | L2-Norm(final)=2.458 | 4321.1 samples/s | 67.5 steps/s
[Step=7400 Epoch=36.1] | Loss=0.03428 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.445 | L2-Norm(final)=2.457 | 5850.8 samples/s | 91.4 steps/s
[Step=7450 Epoch=36.3] | Loss=0.03055 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.487 | L2-Norm(final)=2.458 | 1870.6 samples/s | 29.2 steps/s
[Step=7500 Epoch=36.6] | Loss=0.02889 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.521 | L2-Norm(final)=2.461 | 4213.2 samples/s | 65.8 steps/s
[Step=7550 Epoch=36.8] | Loss=0.02808 | Reg=0.00212 | acc=0.9531 | L2-Norm=14.549 | L2-Norm(final)=2.461 | 4329.4 samples/s | 67.6 steps/s
[Step=7600 Epoch=37.1] | Loss=0.02655 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.576 | L2-Norm(final)=2.463 | 5341.9 samples/s | 83.5 steps/s
[Step=7650 Epoch=37.3] | Loss=0.02782 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.606 | L2-Norm(final)=2.463 | 1934.1 samples/s | 30.2 steps/s
[Step=7700 Epoch=37.5] | Loss=0.02712 | Reg=0.00214 | acc=0.9531 | L2-Norm=14.642 | L2-Norm(final)=2.459 | 4211.8 samples/s | 65.8 steps/s
[Step=7750 Epoch=37.8] | Loss=0.02678 | Reg=0.00215 | acc=0.9531 | L2-Norm=14.676 | L2-Norm(final)=2.458 | 4211.4 samples/s | 65.8 steps/s
[Step=7800 Epoch=38.0] | Loss=0.02658 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.709 | L2-Norm(final)=2.455 | 4973.9 samples/s | 77.7 steps/s
[Step=7850 Epoch=38.3] | Loss=0.02619 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.742 | L2-Norm(final)=2.453 | 1976.1 samples/s | 30.9 steps/s
[Step=7900 Epoch=38.5] | Loss=0.02551 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.773 | L2-Norm(final)=2.453 | 4152.3 samples/s | 64.9 steps/s
[Step=7950 Epoch=38.8] | Loss=0.02487 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.803 | L2-Norm(final)=2.453 | 4292.5 samples/s | 67.1 steps/s
[Step=8000 Epoch=39.0] | Loss=0.02448 | Reg=0.00220 | acc=0.9844 | L2-Norm=14.830 | L2-Norm(final)=2.452 | 4600.7 samples/s | 71.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step8000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=35.1] | Loss=0.12136 | Reg=0.00201 | acc=0.8906 | L2-Norm=14.160 | L2-Norm(final)=2.465 | 4706.4 samples/s | 73.5 steps/s
[Step=7250 Epoch=35.4] | Loss=0.04352 | Reg=0.00204 | acc=0.9531 | L2-Norm=14.277 | L2-Norm(final)=2.455 | 3984.8 samples/s | 62.3 steps/s
[Step=7300 Epoch=35.6] | Loss=0.04075 | Reg=0.00206 | acc=0.9375 | L2-Norm=14.345 | L2-Norm(final)=2.456 | 4266.2 samples/s | 66.7 steps/s
[Step=7350 Epoch=35.9] | Loss=0.04005 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.397 | L2-Norm(final)=2.451 | 4257.8 samples/s | 66.5 steps/s
[Step=7400 Epoch=36.1] | Loss=0.03737 | Reg=0.00209 | acc=0.9844 | L2-Norm=14.446 | L2-Norm(final)=2.448 | 5822.2 samples/s | 91.0 steps/s
[Step=7450 Epoch=36.4] | Loss=0.03394 | Reg=0.00210 | acc=0.9688 | L2-Norm=14.489 | L2-Norm(final)=2.450 | 1881.8 samples/s | 29.4 steps/s
[Step=7500 Epoch=36.6] | Loss=0.03195 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.524 | L2-Norm(final)=2.448 | 4305.8 samples/s | 67.3 steps/s
[Step=7550 Epoch=36.8] | Loss=0.03046 | Reg=0.00212 | acc=0.9375 | L2-Norm=14.557 | L2-Norm(final)=2.447 | 4237.2 samples/s | 66.2 steps/s
[Step=7600 Epoch=37.1] | Loss=0.02914 | Reg=0.00213 | acc=0.9844 | L2-Norm=14.589 | L2-Norm(final)=2.446 | 5353.4 samples/s | 83.6 steps/s
[Step=7650 Epoch=37.3] | Loss=0.02748 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.619 | L2-Norm(final)=2.446 | 1929.9 samples/s | 30.2 steps/s
[Step=7700 Epoch=37.6] | Loss=0.02608 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.646 | L2-Norm(final)=2.448 | 4267.2 samples/s | 66.7 steps/s
[Step=7750 Epoch=37.8] | Loss=0.02539 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.671 | L2-Norm(final)=2.448 | 4318.6 samples/s | 67.5 steps/s
[Step=7800 Epoch=38.1] | Loss=0.02448 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.693 | L2-Norm(final)=2.449 | 5142.9 samples/s | 80.4 steps/s
[Step=7850 Epoch=38.3] | Loss=0.02361 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.715 | L2-Norm(final)=2.449 | 1954.3 samples/s | 30.5 steps/s
[Step=7900 Epoch=38.5] | Loss=0.02276 | Reg=0.00217 | acc=0.9844 | L2-Norm=14.736 | L2-Norm(final)=2.450 | 4195.7 samples/s | 65.6 steps/s
[Step=7950 Epoch=38.8] | Loss=0.02202 | Reg=0.00218 | acc=0.9844 | L2-Norm=14.755 | L2-Norm(final)=2.451 | 4215.8 samples/s | 65.9 steps/s
[Step=8000 Epoch=39.0] | Loss=0.02157 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.773 | L2-Norm(final)=2.451 | 4880.2 samples/s | 76.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step8000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=68.2] | Loss=0.06357 | Reg=0.00201 | acc=0.9375 | L2-Norm=14.160 | L2-Norm(final)=2.465 | 4236.5 samples/s | 66.2 steps/s
[Step=7250 Epoch=68.7] | Loss=0.02026 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.623 | L2-Norm(final)=2.419 | 3784.1 samples/s | 59.1 steps/s
[Step=7300 Epoch=69.2] | Loss=0.01155 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.796 | L2-Norm(final)=2.407 | 5624.6 samples/s | 87.9 steps/s
[Step=7350 Epoch=69.6] | Loss=0.00776 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.845 | L2-Norm(final)=2.409 | 1807.4 samples/s | 28.2 steps/s
[Step=7400 Epoch=70.1] | Loss=0.00583 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.854 | L2-Norm(final)=2.411 | 5143.7 samples/s | 80.4 steps/s
[Step=7450 Epoch=70.6] | Loss=0.00467 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.846 | L2-Norm(final)=2.413 | 1891.4 samples/s | 29.6 steps/s
[Step=7500 Epoch=71.1] | Loss=0.00389 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.830 | L2-Norm(final)=2.415 | 4756.5 samples/s | 74.3 steps/s
[Step=7550 Epoch=71.5] | Loss=0.00334 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.809 | L2-Norm(final)=2.416 | 1915.2 samples/s | 29.9 steps/s
[Step=7600 Epoch=72.0] | Loss=0.00292 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.786 | L2-Norm(final)=2.417 | 4324.3 samples/s | 67.6 steps/s
[Step=7650 Epoch=72.5] | Loss=0.00260 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.761 | L2-Norm(final)=2.418 | 1981.8 samples/s | 31.0 steps/s
[Step=7700 Epoch=73.0] | Loss=0.00234 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.736 | L2-Norm(final)=2.419 | 3935.8 samples/s | 61.5 steps/s
[Step=7750 Epoch=73.4] | Loss=0.00213 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.709 | L2-Norm(final)=2.419 | 2025.2 samples/s | 31.6 steps/s
[Step=7800 Epoch=73.9] | Loss=0.00195 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.683 | L2-Norm(final)=2.420 | 4119.2 samples/s | 64.4 steps/s
[Step=7850 Epoch=74.4] | Loss=0.00180 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.656 | L2-Norm(final)=2.420 | 2048.5 samples/s | 32.0 steps/s
[Step=7900 Epoch=74.9] | Loss=0.00167 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.629 | L2-Norm(final)=2.421 | 4000.4 samples/s | 62.5 steps/s
[Step=7950 Epoch=75.3] | Loss=0.00156 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.601 | L2-Norm(final)=2.422 | 2079.8 samples/s | 32.5 steps/s
[Step=8000 Epoch=75.8] | Loss=0.00146 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.574 | L2-Norm(final)=2.422 | 4025.5 samples/s | 62.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step8000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=68.5] | Loss=0.15743 | Reg=0.00201 | acc=0.8594 | L2-Norm=14.160 | L2-Norm(final)=2.462 | 4336.7 samples/s | 67.8 steps/s
[Step=7250 Epoch=69.0] | Loss=0.01015 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.531 | L2-Norm(final)=2.461 | 3657.0 samples/s | 57.1 steps/s
[Step=7300 Epoch=69.4] | Loss=0.00511 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.599 | L2-Norm(final)=2.466 | 5446.0 samples/s | 85.1 steps/s
[Step=7350 Epoch=69.9] | Loss=0.00342 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.599 | L2-Norm(final)=2.469 | 1812.0 samples/s | 28.3 steps/s
[Step=7400 Epoch=70.4] | Loss=0.00257 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.583 | L2-Norm(final)=2.471 | 5143.0 samples/s | 80.4 steps/s
[Step=7450 Epoch=70.9] | Loss=0.00206 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.560 | L2-Norm(final)=2.473 | 1860.6 samples/s | 29.1 steps/s
[Step=7500 Epoch=71.3] | Loss=0.00171 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.535 | L2-Norm(final)=2.474 | 4668.2 samples/s | 72.9 steps/s
[Step=7550 Epoch=71.8] | Loss=0.00147 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.508 | L2-Norm(final)=2.475 | 1893.9 samples/s | 29.6 steps/s
[Step=7600 Epoch=72.3] | Loss=0.00129 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.481 | L2-Norm(final)=2.476 | 4389.6 samples/s | 68.6 steps/s
[Step=7650 Epoch=72.8] | Loss=0.00115 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.454 | L2-Norm(final)=2.477 | 1953.0 samples/s | 30.5 steps/s
[Step=7700 Epoch=73.2] | Loss=0.00103 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.427 | L2-Norm(final)=2.478 | 4101.6 samples/s | 64.1 steps/s
[Step=7750 Epoch=73.7] | Loss=0.00094 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.399 | L2-Norm(final)=2.479 | 2019.2 samples/s | 31.6 steps/s
[Step=7800 Epoch=74.2] | Loss=0.00086 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.372 | L2-Norm(final)=2.480 | 4024.9 samples/s | 62.9 steps/s
[Step=7850 Epoch=74.7] | Loss=0.00080 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.345 | L2-Norm(final)=2.480 | 2054.8 samples/s | 32.1 steps/s
[Step=7900 Epoch=75.1] | Loss=0.00074 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.318 | L2-Norm(final)=2.481 | 4009.4 samples/s | 62.6 steps/s
[Step=7950 Epoch=75.6] | Loss=0.00069 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.291 | L2-Norm(final)=2.482 | 2068.1 samples/s | 32.3 steps/s
[Step=8000 Epoch=76.1] | Loss=0.00065 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.264 | L2-Norm(final)=2.482 | 4031.2 samples/s | 63.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.80339 | acc=0.5413 | tpr=0.3390 | fpr=0.0196 | 2903.7 samples/s | 11.3 steps/s
Avg test loss: 0.80408, Avg test acc: 0.54155, Avg tpr: 0.34225, Avg fpr: 0.02013, total FA: 157

Testing server on iccad2012
[Step=  50] | Loss=0.13616 | acc=0.9445 | tpr=0.9469 | fpr=0.0556 | 2917.1 samples/s | 11.4 steps/s
[Step= 100] | Loss=0.13810 | acc=0.9433 | tpr=0.9574 | fpr=0.0570 | 7204.3 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.14226 | acc=0.9428 | tpr=0.9553 | fpr=0.0574 | 7289.4 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.14382 | acc=0.9429 | tpr=0.9596 | fpr=0.0574 | 7234.8 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.14218 | acc=0.9434 | tpr=0.9581 | fpr=0.0569 | 7086.9 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.14363 | acc=0.9430 | tpr=0.9556 | fpr=0.0572 | 7152.1 samples/s | 27.9 steps/s
[Step= 350] | Loss=0.14488 | acc=0.9426 | tpr=0.9555 | fpr=0.0576 | 7163.2 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.14582 | acc=0.9426 | tpr=0.9584 | fpr=0.0577 | 7089.8 samples/s | 27.7 steps/s
[Step= 450] | Loss=0.14763 | acc=0.9420 | tpr=0.9572 | fpr=0.0583 | 6997.8 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.14686 | acc=0.9421 | tpr=0.9586 | fpr=0.0582 | 7177.7 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.14621 | acc=0.9423 | tpr=0.9590 | fpr=0.0580 | 13639.0 samples/s | 53.3 steps/s
Avg test loss: 0.14597, Avg test acc: 0.94237, Avg tpr: 0.95919, Avg fpr: 0.05793, total FA: 8044

server round 10/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.47630 | Reg=0.00199 | acc=0.7031 | L2-Norm=14.110 | L2-Norm(final)=2.442 | 3767.7 samples/s | 58.9 steps/s
[Step=8050 Epoch=39.3] | Loss=0.08864 | Reg=0.00201 | acc=0.9531 | L2-Norm=14.190 | L2-Norm(final)=2.415 | 2170.7 samples/s | 33.9 steps/s
[Step=8100 Epoch=39.5] | Loss=0.05635 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.228 | L2-Norm(final)=2.427 | 3939.9 samples/s | 61.6 steps/s
[Step=8150 Epoch=39.7] | Loss=0.04399 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.249 | L2-Norm(final)=2.436 | 4334.5 samples/s | 67.7 steps/s
[Step=8200 Epoch=40.0] | Loss=0.03654 | Reg=0.00203 | acc=0.9688 | L2-Norm=14.264 | L2-Norm(final)=2.444 | 5824.7 samples/s | 91.0 steps/s
[Step=8250 Epoch=40.2] | Loss=0.03394 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.280 | L2-Norm(final)=2.449 | 1868.1 samples/s | 29.2 steps/s
[Step=8300 Epoch=40.5] | Loss=0.02968 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.295 | L2-Norm(final)=2.455 | 4341.2 samples/s | 67.8 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02812 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.308 | L2-Norm(final)=2.460 | 4322.0 samples/s | 67.5 steps/s
[Step=8400 Epoch=41.0] | Loss=0.02560 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.318 | L2-Norm(final)=2.462 | 5331.1 samples/s | 83.3 steps/s
[Step=8450 Epoch=41.2] | Loss=0.02389 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.326 | L2-Norm(final)=2.465 | 1942.2 samples/s | 30.3 steps/s
[Step=8500 Epoch=41.4] | Loss=0.02214 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.333 | L2-Norm(final)=2.468 | 4194.4 samples/s | 65.5 steps/s
[Step=8550 Epoch=41.7] | Loss=0.02054 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.339 | L2-Norm(final)=2.471 | 4205.6 samples/s | 65.7 steps/s
[Step=8600 Epoch=41.9] | Loss=0.01944 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.343 | L2-Norm(final)=2.473 | 4935.4 samples/s | 77.1 steps/s
[Step=8650 Epoch=42.2] | Loss=0.01841 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.347 | L2-Norm(final)=2.476 | 2007.0 samples/s | 31.4 steps/s
[Step=8700 Epoch=42.4] | Loss=0.01743 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.351 | L2-Norm(final)=2.478 | 4239.0 samples/s | 66.2 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01679 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.354 | L2-Norm(final)=2.481 | 4183.0 samples/s | 65.4 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01616 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.357 | L2-Norm(final)=2.483 | 4657.3 samples/s | 72.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step8800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.52578 | Reg=0.00199 | acc=0.6875 | L2-Norm=14.110 | L2-Norm(final)=2.442 | 4166.9 samples/s | 65.1 steps/s
[Step=8050 Epoch=39.3] | Loss=0.08669 | Reg=0.00202 | acc=0.9375 | L2-Norm=14.199 | L2-Norm(final)=2.419 | 4265.3 samples/s | 66.6 steps/s
[Step=8100 Epoch=39.5] | Loss=0.05803 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.243 | L2-Norm(final)=2.431 | 4281.5 samples/s | 66.9 steps/s
[Step=8150 Epoch=39.8] | Loss=0.04432 | Reg=0.00204 | acc=0.9844 | L2-Norm=14.270 | L2-Norm(final)=2.440 | 4294.3 samples/s | 67.1 steps/s
[Step=8200 Epoch=40.0] | Loss=0.03664 | Reg=0.00204 | acc=0.9531 | L2-Norm=14.289 | L2-Norm(final)=2.449 | 5856.8 samples/s | 91.5 steps/s
[Step=8250 Epoch=40.3] | Loss=0.03045 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.303 | L2-Norm(final)=2.458 | 1878.8 samples/s | 29.4 steps/s
[Step=8300 Epoch=40.5] | Loss=0.02632 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.315 | L2-Norm(final)=2.466 | 4348.4 samples/s | 67.9 steps/s
[Step=8350 Epoch=40.7] | Loss=0.02409 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.324 | L2-Norm(final)=2.473 | 4297.4 samples/s | 67.1 steps/s
[Step=8400 Epoch=41.0] | Loss=0.02265 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.332 | L2-Norm(final)=2.478 | 5373.6 samples/s | 84.0 steps/s
[Step=8450 Epoch=41.2] | Loss=0.02100 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.337 | L2-Norm(final)=2.481 | 1942.7 samples/s | 30.4 steps/s
[Step=8500 Epoch=41.5] | Loss=0.01956 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.343 | L2-Norm(final)=2.485 | 4262.7 samples/s | 66.6 steps/s
[Step=8550 Epoch=41.7] | Loss=0.01850 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.348 | L2-Norm(final)=2.489 | 4183.8 samples/s | 65.4 steps/s
[Step=8600 Epoch=42.0] | Loss=0.01764 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.352 | L2-Norm(final)=2.492 | 5078.2 samples/s | 79.3 steps/s
[Step=8650 Epoch=42.2] | Loss=0.01677 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.356 | L2-Norm(final)=2.495 | 1958.8 samples/s | 30.6 steps/s
[Step=8700 Epoch=42.5] | Loss=0.01603 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.360 | L2-Norm(final)=2.498 | 4214.1 samples/s | 65.8 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01534 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.364 | L2-Norm(final)=2.502 | 4265.8 samples/s | 66.7 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01481 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.367 | L2-Norm(final)=2.505 | 4781.0 samples/s | 74.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step8800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=75.8] | Loss=0.00100 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.110 | L2-Norm(final)=2.444 | 4500.0 samples/s | 70.3 steps/s
[Step=8050 Epoch=76.3] | Loss=0.00139 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=2.462 | 3705.8 samples/s | 57.9 steps/s
[Step=8100 Epoch=76.8] | Loss=0.00074 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.112 | L2-Norm(final)=2.468 | 5522.6 samples/s | 86.3 steps/s
[Step=8150 Epoch=77.2] | Loss=0.00050 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.099 | L2-Norm(final)=2.472 | 1814.2 samples/s | 28.3 steps/s
[Step=8200 Epoch=77.7] | Loss=0.00038 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.084 | L2-Norm(final)=2.474 | 5045.8 samples/s | 78.8 steps/s
[Step=8250 Epoch=78.2] | Loss=0.00031 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.068 | L2-Norm(final)=2.476 | 1866.7 samples/s | 29.2 steps/s
[Step=8300 Epoch=78.6] | Loss=0.00026 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.052 | L2-Norm(final)=2.477 | 4615.0 samples/s | 72.1 steps/s
[Step=8350 Epoch=79.1] | Loss=0.00022 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.036 | L2-Norm(final)=2.479 | 1936.9 samples/s | 30.3 steps/s
[Step=8400 Epoch=79.6] | Loss=0.00020 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.020 | L2-Norm(final)=2.480 | 4320.6 samples/s | 67.5 steps/s
[Step=8450 Epoch=80.1] | Loss=0.00018 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.003 | L2-Norm(final)=2.481 | 1940.3 samples/s | 30.3 steps/s
[Step=8500 Epoch=80.5] | Loss=0.00016 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.987 | L2-Norm(final)=2.482 | 4084.3 samples/s | 63.8 steps/s
[Step=8550 Epoch=81.0] | Loss=0.00015 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.970 | L2-Norm(final)=2.483 | 2026.6 samples/s | 31.7 steps/s
[Step=8600 Epoch=81.5] | Loss=0.00013 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.953 | L2-Norm(final)=2.484 | 4136.2 samples/s | 64.6 steps/s
[Step=8650 Epoch=82.0] | Loss=0.00012 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.936 | L2-Norm(final)=2.484 | 2037.9 samples/s | 31.8 steps/s
[Step=8700 Epoch=82.4] | Loss=0.00012 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.919 | L2-Norm(final)=2.485 | 4126.9 samples/s | 64.5 steps/s
[Step=8750 Epoch=82.9] | Loss=0.00011 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.902 | L2-Norm(final)=2.486 | 2046.0 samples/s | 32.0 steps/s
[Step=8800 Epoch=83.4] | Loss=0.00010 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.885 | L2-Norm(final)=2.486 | 3980.3 samples/s | 62.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step8800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=76.1] | Loss=0.00210 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.110 | L2-Norm(final)=2.444 | 4216.7 samples/s | 65.9 steps/s
[Step=8050 Epoch=76.6] | Loss=0.00249 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.128 | L2-Norm(final)=2.461 | 3779.5 samples/s | 59.1 steps/s
[Step=8100 Epoch=77.1] | Loss=0.00128 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.130 | L2-Norm(final)=2.470 | 5632.6 samples/s | 88.0 steps/s
[Step=8150 Epoch=77.5] | Loss=0.00087 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.120 | L2-Norm(final)=2.474 | 1789.9 samples/s | 28.0 steps/s
[Step=8200 Epoch=78.0] | Loss=0.00065 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.107 | L2-Norm(final)=2.477 | 5145.9 samples/s | 80.4 steps/s
[Step=8250 Epoch=78.5] | Loss=0.00053 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=2.479 | 1868.4 samples/s | 29.2 steps/s
[Step=8300 Epoch=79.0] | Loss=0.00044 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.078 | L2-Norm(final)=2.480 | 4667.1 samples/s | 72.9 steps/s
[Step=8350 Epoch=79.4] | Loss=0.00038 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.063 | L2-Norm(final)=2.482 | 1916.1 samples/s | 29.9 steps/s
[Step=8400 Epoch=79.9] | Loss=0.00034 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.047 | L2-Norm(final)=2.483 | 4471.9 samples/s | 69.9 steps/s
[Step=8450 Epoch=80.4] | Loss=0.00030 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.032 | L2-Norm(final)=2.484 | 1971.6 samples/s | 30.8 steps/s
[Step=8500 Epoch=80.9] | Loss=0.00027 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.016 | L2-Norm(final)=2.485 | 4160.1 samples/s | 65.0 steps/s
[Step=8550 Epoch=81.3] | Loss=0.00025 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.000 | L2-Norm(final)=2.486 | 2027.9 samples/s | 31.7 steps/s
[Step=8600 Epoch=81.8] | Loss=0.00023 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.984 | L2-Norm(final)=2.487 | 4051.7 samples/s | 63.3 steps/s
[Step=8650 Epoch=82.3] | Loss=0.00021 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.968 | L2-Norm(final)=2.487 | 2057.9 samples/s | 32.2 steps/s
[Step=8700 Epoch=82.8] | Loss=0.00019 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.952 | L2-Norm(final)=2.488 | 4076.6 samples/s | 63.7 steps/s
[Step=8750 Epoch=83.2] | Loss=0.00018 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.936 | L2-Norm(final)=2.489 | 2084.5 samples/s | 32.6 steps/s
[Step=8800 Epoch=83.7] | Loss=0.00017 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.920 | L2-Norm(final)=2.489 | 3956.0 samples/s | 61.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.23625 | acc=0.8614 | tpr=0.8169 | fpr=0.0419 | 3855.6 samples/s | 15.1 steps/s
Avg test loss: 0.23845, Avg test acc: 0.86277, Avg tpr: 0.81867, Avg fpr: 0.04025, total FA: 314

Testing server on iccad2012
[Step=  50] | Loss=0.47503 | acc=0.7844 | tpr=0.9469 | fpr=0.2185 | 3856.2 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.48088 | acc=0.7848 | tpr=0.9616 | fpr=0.2185 | 7287.5 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.48414 | acc=0.7848 | tpr=0.9625 | fpr=0.2185 | 7172.1 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.48587 | acc=0.7840 | tpr=0.9628 | fpr=0.2192 | 7098.9 samples/s | 27.7 steps/s
[Step= 250] | Loss=0.48434 | acc=0.7841 | tpr=0.9642 | fpr=0.2192 | 7110.5 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.48717 | acc=0.7844 | tpr=0.9629 | fpr=0.2189 | 7213.7 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.48971 | acc=0.7846 | tpr=0.9637 | fpr=0.2187 | 7180.6 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.49094 | acc=0.7850 | tpr=0.9672 | fpr=0.2184 | 7205.8 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.49410 | acc=0.7846 | tpr=0.9664 | fpr=0.2187 | 7206.2 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.49276 | acc=0.7845 | tpr=0.9674 | fpr=0.2188 | 7160.8 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.49060 | acc=0.7851 | tpr=0.9678 | fpr=0.2182 | 13171.2 samples/s | 51.5 steps/s
Avg test loss: 0.49014, Avg test acc: 0.78519, Avg tpr: 0.96791, Avg fpr: 0.21813, total FA: 30287

server round 11/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=42.9] | Loss=0.04213 | Reg=0.00194 | acc=0.9688 | L2-Norm=13.917 | L2-Norm(final)=2.513 | 4634.5 samples/s | 72.4 steps/s
[Step=8850 Epoch=43.2] | Loss=0.02549 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.967 | L2-Norm(final)=2.514 | 3800.3 samples/s | 59.4 steps/s
[Step=8900 Epoch=43.4] | Loss=0.02085 | Reg=0.00196 | acc=0.9688 | L2-Norm=13.992 | L2-Norm(final)=2.519 | 4225.9 samples/s | 66.0 steps/s
[Step=8950 Epoch=43.6] | Loss=0.01798 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.008 | L2-Norm(final)=2.525 | 4233.6 samples/s | 66.1 steps/s
[Step=9000 Epoch=43.9] | Loss=0.01685 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.020 | L2-Norm(final)=2.529 | 5690.6 samples/s | 88.9 steps/s
[Step=9050 Epoch=44.1] | Loss=0.01536 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.028 | L2-Norm(final)=2.532 | 1888.2 samples/s | 29.5 steps/s
[Step=9100 Epoch=44.4] | Loss=0.01429 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.035 | L2-Norm(final)=2.535 | 4176.6 samples/s | 65.3 steps/s
[Step=9150 Epoch=44.6] | Loss=0.01312 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.042 | L2-Norm(final)=2.538 | 4306.7 samples/s | 67.3 steps/s
[Step=9200 Epoch=44.9] | Loss=0.01244 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.047 | L2-Norm(final)=2.541 | 5312.6 samples/s | 83.0 steps/s
[Step=9250 Epoch=45.1] | Loss=0.01153 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.052 | L2-Norm(final)=2.544 | 1922.2 samples/s | 30.0 steps/s
[Step=9300 Epoch=45.3] | Loss=0.01103 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.055 | L2-Norm(final)=2.547 | 4189.8 samples/s | 65.5 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01043 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.058 | L2-Norm(final)=2.549 | 4297.7 samples/s | 67.2 steps/s
[Step=9400 Epoch=45.8] | Loss=0.01050 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.061 | L2-Norm(final)=2.551 | 5016.8 samples/s | 78.4 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01006 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.063 | L2-Norm(final)=2.552 | 1972.9 samples/s | 30.8 steps/s
[Step=9500 Epoch=46.3] | Loss=0.00968 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.066 | L2-Norm(final)=2.554 | 4202.4 samples/s | 65.7 steps/s
[Step=9550 Epoch=46.6] | Loss=0.00946 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.068 | L2-Norm(final)=2.556 | 4309.7 samples/s | 67.3 steps/s
[Step=9600 Epoch=46.8] | Loss=0.00930 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.070 | L2-Norm(final)=2.558 | 4680.6 samples/s | 73.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step9600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=42.9] | Loss=0.19687 | Reg=0.00194 | acc=0.8750 | L2-Norm=13.917 | L2-Norm(final)=2.512 | 4381.0 samples/s | 68.5 steps/s
[Step=8850 Epoch=43.2] | Loss=0.02902 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.962 | L2-Norm(final)=2.503 | 3993.3 samples/s | 62.4 steps/s
[Step=8900 Epoch=43.4] | Loss=0.02276 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.983 | L2-Norm(final)=2.507 | 4240.4 samples/s | 66.3 steps/s
[Step=8950 Epoch=43.7] | Loss=0.01998 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.001 | L2-Norm(final)=2.512 | 4291.0 samples/s | 67.0 steps/s
[Step=9000 Epoch=43.9] | Loss=0.01851 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.018 | L2-Norm(final)=2.518 | 5913.7 samples/s | 92.4 steps/s
[Step=9050 Epoch=44.2] | Loss=0.01591 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.032 | L2-Norm(final)=2.524 | 1852.7 samples/s | 28.9 steps/s
[Step=9100 Epoch=44.4] | Loss=0.01473 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.044 | L2-Norm(final)=2.530 | 4216.7 samples/s | 65.9 steps/s
[Step=9150 Epoch=44.6] | Loss=0.01393 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.052 | L2-Norm(final)=2.533 | 4236.4 samples/s | 66.2 steps/s
[Step=9200 Epoch=44.9] | Loss=0.01329 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.060 | L2-Norm(final)=2.537 | 5417.7 samples/s | 84.7 steps/s
[Step=9250 Epoch=45.1] | Loss=0.01257 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.067 | L2-Norm(final)=2.540 | 1916.4 samples/s | 29.9 steps/s
[Step=9300 Epoch=45.4] | Loss=0.01181 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.073 | L2-Norm(final)=2.543 | 4326.6 samples/s | 67.6 steps/s
[Step=9350 Epoch=45.6] | Loss=0.01117 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.078 | L2-Norm(final)=2.547 | 4218.9 samples/s | 65.9 steps/s
[Step=9400 Epoch=45.9] | Loss=0.01102 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.082 | L2-Norm(final)=2.549 | 5237.4 samples/s | 81.8 steps/s
[Step=9450 Epoch=46.1] | Loss=0.01059 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.087 | L2-Norm(final)=2.552 | 1961.7 samples/s | 30.7 steps/s
[Step=9500 Epoch=46.4] | Loss=0.01026 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.091 | L2-Norm(final)=2.554 | 4195.2 samples/s | 65.6 steps/s
[Step=9550 Epoch=46.6] | Loss=0.01000 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.095 | L2-Norm(final)=2.557 | 4217.0 samples/s | 65.9 steps/s
[Step=9600 Epoch=46.8] | Loss=0.00973 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.099 | L2-Norm(final)=2.559 | 4701.3 samples/s | 73.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step9600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=83.4] | Loss=0.08875 | Reg=0.00194 | acc=0.9219 | L2-Norm=13.917 | L2-Norm(final)=2.513 | 4216.2 samples/s | 65.9 steps/s
[Step=8850 Epoch=83.9] | Loss=0.00661 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.083 | L2-Norm(final)=2.520 | 3958.5 samples/s | 61.9 steps/s
[Step=8900 Epoch=84.3] | Loss=0.00369 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.126 | L2-Norm(final)=2.523 | 5556.7 samples/s | 86.8 steps/s
[Step=8950 Epoch=84.8] | Loss=0.00247 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.133 | L2-Norm(final)=2.527 | 1810.5 samples/s | 28.3 steps/s
[Step=9000 Epoch=85.3] | Loss=0.00186 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.128 | L2-Norm(final)=2.530 | 5180.8 samples/s | 81.0 steps/s
[Step=9050 Epoch=85.8] | Loss=0.00149 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=2.531 | 1864.4 samples/s | 29.1 steps/s
[Step=9100 Epoch=86.2] | Loss=0.00124 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.108 | L2-Norm(final)=2.533 | 4738.7 samples/s | 74.0 steps/s
[Step=9150 Epoch=86.7] | Loss=0.00107 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.096 | L2-Norm(final)=2.534 | 1936.1 samples/s | 30.3 steps/s
[Step=9200 Epoch=87.2] | Loss=0.00093 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.082 | L2-Norm(final)=2.535 | 4323.0 samples/s | 67.5 steps/s
[Step=9250 Epoch=87.7] | Loss=0.00083 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.068 | L2-Norm(final)=2.536 | 1966.2 samples/s | 30.7 steps/s
[Step=9300 Epoch=88.1] | Loss=0.00075 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.054 | L2-Norm(final)=2.537 | 4109.2 samples/s | 64.2 steps/s
[Step=9350 Epoch=88.6] | Loss=0.00068 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.040 | L2-Norm(final)=2.538 | 2041.0 samples/s | 31.9 steps/s
[Step=9400 Epoch=89.1] | Loss=0.00062 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.025 | L2-Norm(final)=2.538 | 4170.0 samples/s | 65.2 steps/s
[Step=9450 Epoch=89.5] | Loss=0.00058 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.010 | L2-Norm(final)=2.539 | 2065.1 samples/s | 32.3 steps/s
[Step=9500 Epoch=90.0] | Loss=0.00054 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.995 | L2-Norm(final)=2.540 | 4103.7 samples/s | 64.1 steps/s
[Step=9550 Epoch=90.5] | Loss=0.00050 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.980 | L2-Norm(final)=2.540 | 2100.9 samples/s | 32.8 steps/s
[Step=9600 Epoch=91.0] | Loss=0.00047 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.964 | L2-Norm(final)=2.541 | 4022.6 samples/s | 62.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step9600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=83.7] | Loss=0.14651 | Reg=0.00194 | acc=0.8906 | L2-Norm=13.917 | L2-Norm(final)=2.512 | 4314.3 samples/s | 67.4 steps/s
[Step=8850 Epoch=84.2] | Loss=0.01132 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.087 | L2-Norm(final)=2.495 | 3726.5 samples/s | 58.2 steps/s
[Step=8900 Epoch=84.7] | Loss=0.00612 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.131 | L2-Norm(final)=2.499 | 5646.4 samples/s | 88.2 steps/s
[Step=8950 Epoch=85.1] | Loss=0.00411 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.143 | L2-Norm(final)=2.503 | 1829.3 samples/s | 28.6 steps/s
[Step=9000 Epoch=85.6] | Loss=0.00311 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.142 | L2-Norm(final)=2.506 | 5177.3 samples/s | 80.9 steps/s
[Step=9050 Epoch=86.1] | Loss=0.00249 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.137 | L2-Norm(final)=2.508 | 1858.2 samples/s | 29.0 steps/s
[Step=9100 Epoch=86.6] | Loss=0.00208 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.128 | L2-Norm(final)=2.510 | 4785.1 samples/s | 74.8 steps/s
[Step=9150 Epoch=87.0] | Loss=0.00178 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.118 | L2-Norm(final)=2.511 | 1909.9 samples/s | 29.8 steps/s
[Step=9200 Epoch=87.5] | Loss=0.00156 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.107 | L2-Norm(final)=2.512 | 4437.2 samples/s | 69.3 steps/s
[Step=9250 Epoch=88.0] | Loss=0.00139 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.095 | L2-Norm(final)=2.513 | 1946.1 samples/s | 30.4 steps/s
[Step=9300 Epoch=88.5] | Loss=0.00125 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.083 | L2-Norm(final)=2.514 | 4148.9 samples/s | 64.8 steps/s
[Step=9350 Epoch=88.9] | Loss=0.00114 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.071 | L2-Norm(final)=2.515 | 2019.4 samples/s | 31.6 steps/s
[Step=9400 Epoch=89.4] | Loss=0.00104 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.058 | L2-Norm(final)=2.516 | 4087.0 samples/s | 63.9 steps/s
[Step=9450 Epoch=89.9] | Loss=0.00096 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.045 | L2-Norm(final)=2.516 | 2060.6 samples/s | 32.2 steps/s
[Step=9500 Epoch=90.4] | Loss=0.00090 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.032 | L2-Norm(final)=2.517 | 3973.8 samples/s | 62.1 steps/s
[Step=9550 Epoch=90.8] | Loss=0.00084 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.019 | L2-Norm(final)=2.518 | 2071.7 samples/s | 32.4 steps/s
[Step=9600 Epoch=91.3] | Loss=0.00078 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.005 | L2-Norm(final)=2.518 | 4040.6 samples/s | 63.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.74198 | acc=0.6370 | tpr=0.4797 | fpr=0.0213 | 3867.3 samples/s | 15.1 steps/s
Avg test loss: 0.74242, Avg test acc: 0.63907, Avg tpr: 0.48458, Avg fpr: 0.02115, total FA: 165

Testing server on iccad2012
[Step=  50] | Loss=0.20640 | acc=0.9329 | tpr=0.9381 | fpr=0.0672 | 3872.9 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.20897 | acc=0.9325 | tpr=0.9574 | fpr=0.0679 | 7164.7 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.21427 | acc=0.9323 | tpr=0.9568 | fpr=0.0682 | 7144.8 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.21632 | acc=0.9326 | tpr=0.9596 | fpr=0.0679 | 7250.3 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.21367 | acc=0.9328 | tpr=0.9616 | fpr=0.0677 | 7051.3 samples/s | 27.5 steps/s
[Step= 300] | Loss=0.21630 | acc=0.9327 | tpr=0.9593 | fpr=0.0678 | 7202.2 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.21771 | acc=0.9326 | tpr=0.9593 | fpr=0.0679 | 7101.8 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.21901 | acc=0.9326 | tpr=0.9612 | fpr=0.0679 | 7123.7 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.22214 | acc=0.9318 | tpr=0.9576 | fpr=0.0687 | 7170.0 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.22081 | acc=0.9318 | tpr=0.9586 | fpr=0.0687 | 6870.1 samples/s | 26.8 steps/s
[Step= 550] | Loss=0.21954 | acc=0.9321 | tpr=0.9586 | fpr=0.0683 | 13521.6 samples/s | 52.8 steps/s
Avg test loss: 0.21915, Avg test acc: 0.93217, Avg tpr: 0.95840, Avg fpr: 0.06830, total FA: 9484

server round 12/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=46.8] | Loss=0.44986 | Reg=0.00190 | acc=0.7188 | L2-Norm=13.780 | L2-Norm(final)=2.558 | 4246.3 samples/s | 66.3 steps/s
[Step=9650 Epoch=47.1] | Loss=0.06264 | Reg=0.00193 | acc=0.9531 | L2-Norm=13.899 | L2-Norm(final)=2.518 | 4109.5 samples/s | 64.2 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03993 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.949 | L2-Norm(final)=2.523 | 4195.1 samples/s | 65.5 steps/s
[Step=9750 Epoch=47.5] | Loss=0.03201 | Reg=0.00195 | acc=0.9844 | L2-Norm=13.976 | L2-Norm(final)=2.530 | 4225.5 samples/s | 66.0 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02699 | Reg=0.00196 | acc=0.9844 | L2-Norm=13.998 | L2-Norm(final)=2.535 | 5711.2 samples/s | 89.2 steps/s
[Step=9850 Epoch=48.0] | Loss=0.02401 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.015 | L2-Norm(final)=2.540 | 1850.7 samples/s | 28.9 steps/s
[Step=9900 Epoch=48.3] | Loss=0.02207 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.028 | L2-Norm(final)=2.542 | 4130.2 samples/s | 64.5 steps/s
[Step=9950 Epoch=48.5] | Loss=0.02017 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.039 | L2-Norm(final)=2.546 | 4202.1 samples/s | 65.7 steps/s
[Step=10000 Epoch=48.8] | Loss=0.01876 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.047 | L2-Norm(final)=2.548 | 5320.8 samples/s | 83.1 steps/s
[Step=10050 Epoch=49.0] | Loss=0.01726 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.054 | L2-Norm(final)=2.550 | 1912.1 samples/s | 29.9 steps/s
[Step=10100 Epoch=49.2] | Loss=0.01620 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.061 | L2-Norm(final)=2.553 | 4184.2 samples/s | 65.4 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01531 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.067 | L2-Norm(final)=2.556 | 4227.8 samples/s | 66.1 steps/s
[Step=10200 Epoch=49.7] | Loss=0.01453 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.073 | L2-Norm(final)=2.559 | 4874.6 samples/s | 76.2 steps/s
[Step=10250 Epoch=50.0] | Loss=0.01387 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.078 | L2-Norm(final)=2.562 | 1966.0 samples/s | 30.7 steps/s
[Step=10300 Epoch=50.2] | Loss=0.01344 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.083 | L2-Norm(final)=2.564 | 4128.6 samples/s | 64.5 steps/s
[Step=10350 Epoch=50.5] | Loss=0.01292 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.087 | L2-Norm(final)=2.567 | 4239.5 samples/s | 66.2 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01253 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.091 | L2-Norm(final)=2.569 | 4577.8 samples/s | 71.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step10400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=46.8] | Loss=0.29749 | Reg=0.00190 | acc=0.7344 | L2-Norm=13.780 | L2-Norm(final)=2.559 | 4160.3 samples/s | 65.0 steps/s
[Step=9650 Epoch=47.1] | Loss=0.05388 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.895 | L2-Norm(final)=2.519 | 4199.6 samples/s | 65.6 steps/s
[Step=9700 Epoch=47.3] | Loss=0.03641 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.944 | L2-Norm(final)=2.528 | 4252.3 samples/s | 66.4 steps/s
[Step=9750 Epoch=47.6] | Loss=0.02870 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.975 | L2-Norm(final)=2.536 | 4233.4 samples/s | 66.1 steps/s
[Step=9800 Epoch=47.8] | Loss=0.02488 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.998 | L2-Norm(final)=2.543 | 5839.3 samples/s | 91.2 steps/s
[Step=9850 Epoch=48.1] | Loss=0.02194 | Reg=0.00196 | acc=0.9688 | L2-Norm=14.013 | L2-Norm(final)=2.548 | 1856.2 samples/s | 29.0 steps/s
[Step=9900 Epoch=48.3] | Loss=0.01993 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.025 | L2-Norm(final)=2.551 | 4299.0 samples/s | 67.2 steps/s
[Step=9950 Epoch=48.6] | Loss=0.01810 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.036 | L2-Norm(final)=2.556 | 4273.8 samples/s | 66.8 steps/s
[Step=10000 Epoch=48.8] | Loss=0.01681 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.046 | L2-Norm(final)=2.560 | 5577.9 samples/s | 87.2 steps/s
[Step=10050 Epoch=49.0] | Loss=0.01570 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.055 | L2-Norm(final)=2.564 | 1904.9 samples/s | 29.8 steps/s
[Step=10100 Epoch=49.3] | Loss=0.01475 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.061 | L2-Norm(final)=2.568 | 4281.0 samples/s | 66.9 steps/s
[Step=10150 Epoch=49.5] | Loss=0.01417 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.067 | L2-Norm(final)=2.571 | 4203.2 samples/s | 65.7 steps/s
[Step=10200 Epoch=49.8] | Loss=0.01352 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.072 | L2-Norm(final)=2.574 | 5128.4 samples/s | 80.1 steps/s
[Step=10250 Epoch=50.0] | Loss=0.01285 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.077 | L2-Norm(final)=2.577 | 1938.5 samples/s | 30.3 steps/s
[Step=10300 Epoch=50.3] | Loss=0.01246 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.081 | L2-Norm(final)=2.580 | 4215.0 samples/s | 65.9 steps/s
[Step=10350 Epoch=50.5] | Loss=0.01201 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.086 | L2-Norm(final)=2.583 | 4183.6 samples/s | 65.4 steps/s
[Step=10400 Epoch=50.7] | Loss=0.01160 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.090 | L2-Norm(final)=2.586 | 4801.0 samples/s | 75.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step10400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=91.0] | Loss=0.04777 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.780 | L2-Norm(final)=2.560 | 4180.1 samples/s | 65.3 steps/s
[Step=9650 Epoch=91.4] | Loss=0.00415 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.840 | L2-Norm(final)=2.558 | 3897.4 samples/s | 60.9 steps/s
[Step=9700 Epoch=91.9] | Loss=0.00211 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.857 | L2-Norm(final)=2.564 | 5412.9 samples/s | 84.6 steps/s
[Step=9750 Epoch=92.4] | Loss=0.00141 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.853 | L2-Norm(final)=2.568 | 1811.3 samples/s | 28.3 steps/s
[Step=9800 Epoch=92.9] | Loss=0.00106 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.842 | L2-Norm(final)=2.570 | 5111.9 samples/s | 79.9 steps/s
[Step=9850 Epoch=93.3] | Loss=0.00085 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.829 | L2-Norm(final)=2.571 | 1845.8 samples/s | 28.8 steps/s
[Step=9900 Epoch=93.8] | Loss=0.00071 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.814 | L2-Norm(final)=2.572 | 4684.5 samples/s | 73.2 steps/s
[Step=9950 Epoch=94.3] | Loss=0.00061 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.799 | L2-Norm(final)=2.573 | 1890.4 samples/s | 29.5 steps/s
[Step=10000 Epoch=94.8] | Loss=0.00053 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.784 | L2-Norm(final)=2.574 | 4355.1 samples/s | 68.0 steps/s
[Step=10050 Epoch=95.2] | Loss=0.00047 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.768 | L2-Norm(final)=2.575 | 1978.3 samples/s | 30.9 steps/s
[Step=10100 Epoch=95.7] | Loss=0.00043 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.752 | L2-Norm(final)=2.576 | 4174.4 samples/s | 65.2 steps/s
[Step=10150 Epoch=96.2] | Loss=0.00039 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.735 | L2-Norm(final)=2.576 | 2029.1 samples/s | 31.7 steps/s
[Step=10200 Epoch=96.7] | Loss=0.00036 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.719 | L2-Norm(final)=2.577 | 4094.7 samples/s | 64.0 steps/s
[Step=10250 Epoch=97.1] | Loss=0.00033 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.703 | L2-Norm(final)=2.577 | 2053.3 samples/s | 32.1 steps/s
[Step=10300 Epoch=97.6] | Loss=0.00031 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.686 | L2-Norm(final)=2.578 | 4132.7 samples/s | 64.6 steps/s
[Step=10350 Epoch=98.1] | Loss=0.00029 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.670 | L2-Norm(final)=2.578 | 2065.6 samples/s | 32.3 steps/s
[Step=10400 Epoch=98.5] | Loss=0.00027 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.653 | L2-Norm(final)=2.579 | 3987.9 samples/s | 62.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step10400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=91.3] | Loss=0.01055 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.780 | L2-Norm(final)=2.561 | 4364.3 samples/s | 68.2 steps/s
[Step=9650 Epoch=91.8] | Loss=0.00183 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.831 | L2-Norm(final)=2.571 | 3720.8 samples/s | 58.1 steps/s
[Step=9700 Epoch=92.3] | Loss=0.00094 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.835 | L2-Norm(final)=2.575 | 5578.9 samples/s | 87.2 steps/s
[Step=9750 Epoch=92.7] | Loss=0.00063 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.827 | L2-Norm(final)=2.577 | 1810.8 samples/s | 28.3 steps/s
[Step=9800 Epoch=93.2] | Loss=0.00048 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.816 | L2-Norm(final)=2.579 | 5063.7 samples/s | 79.1 steps/s
[Step=9850 Epoch=93.7] | Loss=0.00038 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=2.580 | 1851.3 samples/s | 28.9 steps/s
[Step=9900 Epoch=94.2] | Loss=0.00032 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.789 | L2-Norm(final)=2.581 | 4781.0 samples/s | 74.7 steps/s
[Step=9950 Epoch=94.6] | Loss=0.00028 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.774 | L2-Norm(final)=2.582 | 1939.2 samples/s | 30.3 steps/s
[Step=10000 Epoch=95.1] | Loss=0.00024 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.760 | L2-Norm(final)=2.582 | 4376.2 samples/s | 68.4 steps/s
[Step=10050 Epoch=95.6] | Loss=0.00022 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.745 | L2-Norm(final)=2.583 | 1947.8 samples/s | 30.4 steps/s
[Step=10100 Epoch=96.1] | Loss=0.00019 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.730 | L2-Norm(final)=2.583 | 4076.7 samples/s | 63.7 steps/s
[Step=10150 Epoch=96.6] | Loss=0.00018 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.715 | L2-Norm(final)=2.584 | 1985.5 samples/s | 31.0 steps/s
[Step=10200 Epoch=97.0] | Loss=0.00016 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.700 | L2-Norm(final)=2.584 | 4060.8 samples/s | 63.4 steps/s
[Step=10250 Epoch=97.5] | Loss=0.00015 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.685 | L2-Norm(final)=2.585 | 2042.6 samples/s | 31.9 steps/s
[Step=10300 Epoch=98.0] | Loss=0.00014 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.670 | L2-Norm(final)=2.585 | 4109.5 samples/s | 64.2 steps/s
[Step=10350 Epoch=98.5] | Loss=0.00013 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.655 | L2-Norm(final)=2.585 | 2066.5 samples/s | 32.3 steps/s
[Step=10400 Epoch=98.9] | Loss=0.00012 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.639 | L2-Norm(final)=2.586 | 4025.8 samples/s | 62.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30155 | acc=0.8357 | tpr=0.7730 | fpr=0.0282 | 3853.4 samples/s | 15.1 steps/s
Avg test loss: 0.30336, Avg test acc: 0.83769, Avg tpr: 0.77607, Avg fpr: 0.02679, total FA: 209

Testing server on iccad2012
[Step=  50] | Loss=0.40137 | acc=0.8313 | tpr=0.9425 | fpr=0.1707 | 3901.6 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.40693 | acc=0.8296 | tpr=0.9616 | fpr=0.1728 | 7091.5 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.41257 | acc=0.8295 | tpr=0.9640 | fpr=0.1729 | 7366.7 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.41430 | acc=0.8295 | tpr=0.9650 | fpr=0.1730 | 7090.8 samples/s | 27.7 steps/s
[Step= 250] | Loss=0.41220 | acc=0.8289 | tpr=0.9659 | fpr=0.1736 | 7081.1 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.41535 | acc=0.8284 | tpr=0.9644 | fpr=0.1741 | 7395.0 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.41776 | acc=0.8278 | tpr=0.9637 | fpr=0.1746 | 7002.7 samples/s | 27.4 steps/s
[Step= 400] | Loss=0.41877 | acc=0.8282 | tpr=0.9644 | fpr=0.1743 | 7287.0 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.42202 | acc=0.8280 | tpr=0.9625 | fpr=0.1744 | 7015.1 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.42051 | acc=0.8282 | tpr=0.9634 | fpr=0.1742 | 7145.1 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.41822 | acc=0.8290 | tpr=0.9634 | fpr=0.1734 | 13235.0 samples/s | 51.7 steps/s
Avg test loss: 0.41768, Avg test acc: 0.82910, Avg tpr: 0.96315, Avg fpr: 0.17333, total FA: 24067

server round 13/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=50.7] | Loss=0.10776 | Reg=0.00186 | acc=0.9219 | L2-Norm=13.635 | L2-Norm(final)=2.601 | 4431.9 samples/s | 69.2 steps/s
[Step=10450 Epoch=51.0] | Loss=0.03304 | Reg=0.00188 | acc=0.9688 | L2-Norm=13.715 | L2-Norm(final)=2.589 | 3911.4 samples/s | 61.1 steps/s
[Step=10500 Epoch=51.2] | Loss=0.02246 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.753 | L2-Norm(final)=2.597 | 4298.2 samples/s | 67.2 steps/s
[Step=10550 Epoch=51.4] | Loss=0.01891 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.776 | L2-Norm(final)=2.603 | 4317.3 samples/s | 67.5 steps/s
[Step=10600 Epoch=51.7] | Loss=0.01703 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.793 | L2-Norm(final)=2.608 | 5774.7 samples/s | 90.2 steps/s
[Step=10650 Epoch=51.9] | Loss=0.01540 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.809 | L2-Norm(final)=2.613 | 1874.5 samples/s | 29.3 steps/s
[Step=10700 Epoch=52.2] | Loss=0.01453 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.822 | L2-Norm(final)=2.617 | 4230.6 samples/s | 66.1 steps/s
[Step=10750 Epoch=52.4] | Loss=0.01384 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.833 | L2-Norm(final)=2.619 | 4269.2 samples/s | 66.7 steps/s
[Step=10800 Epoch=52.7] | Loss=0.01301 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.842 | L2-Norm(final)=2.621 | 5282.3 samples/s | 82.5 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01293 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.851 | L2-Norm(final)=2.624 | 1968.2 samples/s | 30.8 steps/s
[Step=10900 Epoch=53.2] | Loss=0.01226 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.860 | L2-Norm(final)=2.626 | 4339.9 samples/s | 67.8 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01179 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.870 | L2-Norm(final)=2.628 | 4241.1 samples/s | 66.3 steps/s
[Step=11000 Epoch=53.6] | Loss=0.01164 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.878 | L2-Norm(final)=2.631 | 4943.5 samples/s | 77.2 steps/s
[Step=11050 Epoch=53.9] | Loss=0.01136 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.885 | L2-Norm(final)=2.632 | 2002.5 samples/s | 31.3 steps/s
[Step=11100 Epoch=54.1] | Loss=0.01088 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.891 | L2-Norm(final)=2.634 | 4243.7 samples/s | 66.3 steps/s
[Step=11150 Epoch=54.4] | Loss=0.01056 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.897 | L2-Norm(final)=2.636 | 4191.2 samples/s | 65.5 steps/s
[Step=11200 Epoch=54.6] | Loss=0.01035 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.903 | L2-Norm(final)=2.638 | 4653.7 samples/s | 72.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step11200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=50.8] | Loss=0.15825 | Reg=0.00186 | acc=0.8750 | L2-Norm=13.635 | L2-Norm(final)=2.601 | 4476.6 samples/s | 69.9 steps/s
[Step=10450 Epoch=51.0] | Loss=0.02993 | Reg=0.00189 | acc=0.9688 | L2-Norm=13.732 | L2-Norm(final)=2.597 | 4123.3 samples/s | 64.4 steps/s
[Step=10500 Epoch=51.2] | Loss=0.02364 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.769 | L2-Norm(final)=2.601 | 4266.8 samples/s | 66.7 steps/s
[Step=10550 Epoch=51.5] | Loss=0.02054 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.795 | L2-Norm(final)=2.602 | 4253.8 samples/s | 66.5 steps/s
[Step=10600 Epoch=51.7] | Loss=0.01821 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.816 | L2-Norm(final)=2.606 | 5840.5 samples/s | 91.3 steps/s
[Step=10650 Epoch=52.0] | Loss=0.01612 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.832 | L2-Norm(final)=2.610 | 1865.5 samples/s | 29.1 steps/s
[Step=10700 Epoch=52.2] | Loss=0.01505 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.845 | L2-Norm(final)=2.613 | 4260.2 samples/s | 66.6 steps/s
[Step=10750 Epoch=52.5] | Loss=0.01418 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.855 | L2-Norm(final)=2.617 | 4250.7 samples/s | 66.4 steps/s
[Step=10800 Epoch=52.7] | Loss=0.01350 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.865 | L2-Norm(final)=2.620 | 5362.5 samples/s | 83.8 steps/s
[Step=10850 Epoch=52.9] | Loss=0.01249 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.874 | L2-Norm(final)=2.624 | 1911.6 samples/s | 29.9 steps/s
[Step=10900 Epoch=53.2] | Loss=0.01175 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.883 | L2-Norm(final)=2.629 | 4261.8 samples/s | 66.6 steps/s
[Step=10950 Epoch=53.4] | Loss=0.01156 | Reg=0.00193 | acc=0.9688 | L2-Norm=13.890 | L2-Norm(final)=2.633 | 4199.0 samples/s | 65.6 steps/s
[Step=11000 Epoch=53.7] | Loss=0.01124 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.897 | L2-Norm(final)=2.636 | 5137.4 samples/s | 80.3 steps/s
[Step=11050 Epoch=53.9] | Loss=0.01066 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.904 | L2-Norm(final)=2.639 | 1910.1 samples/s | 29.8 steps/s
[Step=11100 Epoch=54.2] | Loss=0.01035 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.910 | L2-Norm(final)=2.641 | 4176.7 samples/s | 65.3 steps/s
[Step=11150 Epoch=54.4] | Loss=0.01010 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.915 | L2-Norm(final)=2.643 | 4213.4 samples/s | 65.8 steps/s
[Step=11200 Epoch=54.7] | Loss=0.00985 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.919 | L2-Norm(final)=2.645 | 4779.9 samples/s | 74.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step11200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=98.6] | Loss=0.16469 | Reg=0.00186 | acc=0.8906 | L2-Norm=13.635 | L2-Norm(final)=2.600 | 4135.6 samples/s | 64.6 steps/s
[Step=10450 Epoch=99.0] | Loss=0.00691 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.802 | L2-Norm(final)=2.600 | 3873.4 samples/s | 60.5 steps/s
[Step=10500 Epoch=99.5] | Loss=0.00369 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.839 | L2-Norm(final)=2.605 | 5492.7 samples/s | 85.8 steps/s
[Step=10550 Epoch=100.0] | Loss=0.00247 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.847 | L2-Norm(final)=2.608 | 1812.0 samples/s | 28.3 steps/s
[Step=10600 Epoch=100.4] | Loss=0.00186 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.844 | L2-Norm(final)=2.611 | 5029.7 samples/s | 78.6 steps/s
[Step=10650 Epoch=100.9] | Loss=0.00149 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.837 | L2-Norm(final)=2.613 | 1868.9 samples/s | 29.2 steps/s
[Step=10700 Epoch=101.4] | Loss=0.00124 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.827 | L2-Norm(final)=2.614 | 4714.0 samples/s | 73.7 steps/s
[Step=10750 Epoch=101.9] | Loss=0.00107 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.816 | L2-Norm(final)=2.616 | 1929.7 samples/s | 30.2 steps/s
[Step=10800 Epoch=102.3] | Loss=0.00093 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.804 | L2-Norm(final)=2.617 | 4384.3 samples/s | 68.5 steps/s
[Step=10850 Epoch=102.8] | Loss=0.00083 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.792 | L2-Norm(final)=2.618 | 1987.7 samples/s | 31.1 steps/s
[Step=10900 Epoch=103.3] | Loss=0.00075 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.779 | L2-Norm(final)=2.618 | 4107.8 samples/s | 64.2 steps/s
[Step=10950 Epoch=103.8] | Loss=0.00068 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.766 | L2-Norm(final)=2.619 | 2028.8 samples/s | 31.7 steps/s
[Step=11000 Epoch=104.2] | Loss=0.00062 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.753 | L2-Norm(final)=2.620 | 4019.2 samples/s | 62.8 steps/s
[Step=11050 Epoch=104.7] | Loss=0.00058 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.739 | L2-Norm(final)=2.620 | 2065.9 samples/s | 32.3 steps/s
[Step=11100 Epoch=105.2] | Loss=0.00054 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.726 | L2-Norm(final)=2.621 | 4263.4 samples/s | 66.6 steps/s
[Step=11150 Epoch=105.7] | Loss=0.00050 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.712 | L2-Norm(final)=2.621 | 2063.8 samples/s | 32.2 steps/s
[Step=11200 Epoch=106.1] | Loss=0.00047 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=2.622 | 3948.7 samples/s | 61.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step11200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=98.9] | Loss=0.14233 | Reg=0.00186 | acc=0.9219 | L2-Norm=13.635 | L2-Norm(final)=2.599 | 4266.9 samples/s | 66.7 steps/s
[Step=10450 Epoch=99.4] | Loss=0.00793 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.810 | L2-Norm(final)=2.591 | 3840.5 samples/s | 60.0 steps/s
[Step=10500 Epoch=99.9] | Loss=0.00476 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.860 | L2-Norm(final)=2.595 | 5595.8 samples/s | 87.4 steps/s
[Step=10550 Epoch=100.4] | Loss=0.00321 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.875 | L2-Norm(final)=2.599 | 1802.7 samples/s | 28.2 steps/s
[Step=10600 Epoch=100.8] | Loss=0.00241 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.877 | L2-Norm(final)=2.601 | 5090.0 samples/s | 79.5 steps/s
[Step=10650 Epoch=101.3] | Loss=0.00193 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.873 | L2-Norm(final)=2.603 | 1855.7 samples/s | 29.0 steps/s
[Step=10700 Epoch=101.8] | Loss=0.00161 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.865 | L2-Norm(final)=2.604 | 4710.3 samples/s | 73.6 steps/s
[Step=10750 Epoch=102.3] | Loss=0.00138 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.856 | L2-Norm(final)=2.605 | 1899.5 samples/s | 29.7 steps/s
[Step=10800 Epoch=102.7] | Loss=0.00121 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.846 | L2-Norm(final)=2.606 | 4348.8 samples/s | 67.9 steps/s
[Step=10850 Epoch=103.2] | Loss=0.00108 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.835 | L2-Norm(final)=2.607 | 1939.5 samples/s | 30.3 steps/s
[Step=10900 Epoch=103.7] | Loss=0.00097 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.824 | L2-Norm(final)=2.607 | 4121.0 samples/s | 64.4 steps/s
[Step=10950 Epoch=104.2] | Loss=0.00088 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.812 | L2-Norm(final)=2.608 | 2026.7 samples/s | 31.7 steps/s
[Step=11000 Epoch=104.6] | Loss=0.00081 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.800 | L2-Norm(final)=2.609 | 3975.2 samples/s | 62.1 steps/s
[Step=11050 Epoch=105.1] | Loss=0.00075 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.788 | L2-Norm(final)=2.609 | 2030.7 samples/s | 31.7 steps/s
[Step=11100 Epoch=105.6] | Loss=0.00069 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.776 | L2-Norm(final)=2.610 | 4139.7 samples/s | 64.7 steps/s
[Step=11150 Epoch=106.1] | Loss=0.00065 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.764 | L2-Norm(final)=2.610 | 2045.8 samples/s | 32.0 steps/s
[Step=11200 Epoch=106.5] | Loss=0.00061 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.751 | L2-Norm(final)=2.611 | 4019.9 samples/s | 62.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.61476 | acc=0.6830 | tpr=0.5491 | fpr=0.0260 | 3854.0 samples/s | 15.1 steps/s
Avg test loss: 0.61456, Avg test acc: 0.68227, Avg tpr: 0.54911, Avg fpr: 0.02487, total FA: 194

Testing server on iccad2012
[Step=  50] | Loss=0.21261 | acc=0.9285 | tpr=0.9425 | fpr=0.0717 | 3909.2 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.21562 | acc=0.9280 | tpr=0.9616 | fpr=0.0727 | 7182.7 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.22132 | acc=0.9274 | tpr=0.9611 | fpr=0.0732 | 6941.0 samples/s | 27.1 steps/s
[Step= 200] | Loss=0.22249 | acc=0.9278 | tpr=0.9607 | fpr=0.0728 | 7309.0 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.21979 | acc=0.9281 | tpr=0.9616 | fpr=0.0725 | 7226.9 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.22268 | acc=0.9278 | tpr=0.9615 | fpr=0.0728 | 7004.6 samples/s | 27.4 steps/s
[Step= 350] | Loss=0.22446 | acc=0.9274 | tpr=0.9618 | fpr=0.0732 | 7138.8 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.22567 | acc=0.9274 | tpr=0.9633 | fpr=0.0733 | 7206.3 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.22837 | acc=0.9268 | tpr=0.9606 | fpr=0.0738 | 6971.8 samples/s | 27.2 steps/s
[Step= 500] | Loss=0.22725 | acc=0.9268 | tpr=0.9621 | fpr=0.0738 | 7031.6 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.22562 | acc=0.9272 | tpr=0.9618 | fpr=0.0735 | 13181.5 samples/s | 51.5 steps/s
Avg test loss: 0.22518, Avg test acc: 0.92722, Avg tpr: 0.96197, Avg fpr: 0.07341, total FA: 10193

server round 14/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=54.6] | Loss=0.25384 | Reg=0.00184 | acc=0.8281 | L2-Norm=13.574 | L2-Norm(final)=2.644 | 4193.8 samples/s | 65.5 steps/s
[Step=11250 Epoch=54.9] | Loss=0.04167 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.693 | L2-Norm(final)=2.620 | 4212.6 samples/s | 65.8 steps/s
[Step=11300 Epoch=55.1] | Loss=0.02732 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.736 | L2-Norm(final)=2.626 | 4170.5 samples/s | 65.2 steps/s
[Step=11350 Epoch=55.3] | Loss=0.02234 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.759 | L2-Norm(final)=2.633 | 4221.2 samples/s | 66.0 steps/s
[Step=11400 Epoch=55.6] | Loss=0.01999 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.777 | L2-Norm(final)=2.638 | 5791.5 samples/s | 90.5 steps/s
[Step=11450 Epoch=55.8] | Loss=0.01769 | Reg=0.00190 | acc=0.9844 | L2-Norm=13.789 | L2-Norm(final)=2.641 | 1891.6 samples/s | 29.6 steps/s
[Step=11500 Epoch=56.1] | Loss=0.01626 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.799 | L2-Norm(final)=2.644 | 4159.7 samples/s | 65.0 steps/s
[Step=11550 Epoch=56.3] | Loss=0.01522 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.807 | L2-Norm(final)=2.647 | 4320.5 samples/s | 67.5 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01413 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.814 | L2-Norm(final)=2.649 | 5414.6 samples/s | 84.6 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01307 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.821 | L2-Norm(final)=2.653 | 1909.9 samples/s | 29.8 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01252 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.827 | L2-Norm(final)=2.656 | 4276.8 samples/s | 66.8 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01185 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.832 | L2-Norm(final)=2.658 | 4220.2 samples/s | 65.9 steps/s
[Step=11800 Epoch=57.5] | Loss=0.01130 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.837 | L2-Norm(final)=2.661 | 5011.7 samples/s | 78.3 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01065 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.841 | L2-Norm(final)=2.664 | 1729.0 samples/s | 27.0 steps/s
[Step=11900 Epoch=58.0] | Loss=0.01033 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.845 | L2-Norm(final)=2.666 | 4146.0 samples/s | 64.8 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01014 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.849 | L2-Norm(final)=2.669 | 4259.2 samples/s | 66.6 steps/s
[Step=12000 Epoch=58.5] | Loss=0.00984 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.851 | L2-Norm(final)=2.670 | 4628.5 samples/s | 72.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step12000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=54.7] | Loss=0.35197 | Reg=0.00184 | acc=0.7812 | L2-Norm=13.574 | L2-Norm(final)=2.643 | 4294.4 samples/s | 67.1 steps/s
[Step=11250 Epoch=54.9] | Loss=0.05235 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.705 | L2-Norm(final)=2.612 | 4206.0 samples/s | 65.7 steps/s
[Step=11300 Epoch=55.1] | Loss=0.03312 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.761 | L2-Norm(final)=2.622 | 4184.1 samples/s | 65.4 steps/s
[Step=11350 Epoch=55.4] | Loss=0.02743 | Reg=0.00190 | acc=0.9531 | L2-Norm=13.792 | L2-Norm(final)=2.629 | 4185.5 samples/s | 65.4 steps/s
[Step=11400 Epoch=55.6] | Loss=0.02400 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.815 | L2-Norm(final)=2.633 | 5805.8 samples/s | 90.7 steps/s
[Step=11450 Epoch=55.9] | Loss=0.02085 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.832 | L2-Norm(final)=2.635 | 1872.4 samples/s | 29.3 steps/s
[Step=11500 Epoch=56.1] | Loss=0.01872 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.845 | L2-Norm(final)=2.638 | 4298.8 samples/s | 67.2 steps/s
[Step=11550 Epoch=56.4] | Loss=0.01740 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.858 | L2-Norm(final)=2.641 | 4250.0 samples/s | 66.4 steps/s
[Step=11600 Epoch=56.6] | Loss=0.01653 | Reg=0.00192 | acc=0.9844 | L2-Norm=13.869 | L2-Norm(final)=2.643 | 5391.7 samples/s | 84.2 steps/s
[Step=11650 Epoch=56.8] | Loss=0.01529 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.878 | L2-Norm(final)=2.645 | 1908.3 samples/s | 29.8 steps/s
[Step=11700 Epoch=57.1] | Loss=0.01440 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.886 | L2-Norm(final)=2.648 | 4258.6 samples/s | 66.5 steps/s
[Step=11750 Epoch=57.3] | Loss=0.01378 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.893 | L2-Norm(final)=2.650 | 4173.1 samples/s | 65.2 steps/s
[Step=11800 Epoch=57.6] | Loss=0.01305 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.899 | L2-Norm(final)=2.653 | 5115.4 samples/s | 79.9 steps/s
[Step=11850 Epoch=57.8] | Loss=0.01252 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.904 | L2-Norm(final)=2.655 | 1948.2 samples/s | 30.4 steps/s
[Step=11900 Epoch=58.1] | Loss=0.01209 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.909 | L2-Norm(final)=2.657 | 4185.6 samples/s | 65.4 steps/s
[Step=11950 Epoch=58.3] | Loss=0.01161 | Reg=0.00194 | acc=0.9844 | L2-Norm=13.913 | L2-Norm(final)=2.659 | 4208.7 samples/s | 65.8 steps/s
[Step=12000 Epoch=58.6] | Loss=0.01119 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.917 | L2-Norm(final)=2.661 | 4761.8 samples/s | 74.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step12000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=106.1] | Loss=0.00962 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.574 | L2-Norm(final)=2.646 | 4329.6 samples/s | 67.6 steps/s
[Step=11250 Epoch=106.6] | Loss=0.00188 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.622 | L2-Norm(final)=2.662 | 3702.8 samples/s | 57.9 steps/s
[Step=11300 Epoch=107.1] | Loss=0.00104 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.641 | L2-Norm(final)=2.673 | 5546.7 samples/s | 86.7 steps/s
[Step=11350 Epoch=107.6] | Loss=0.00070 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.643 | L2-Norm(final)=2.680 | 1819.4 samples/s | 28.4 steps/s
[Step=11400 Epoch=108.0] | Loss=0.00133 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.640 | L2-Norm(final)=2.681 | 5096.6 samples/s | 79.6 steps/s
[Step=11450 Epoch=108.5] | Loss=0.00114 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.651 | L2-Norm(final)=2.679 | 1881.2 samples/s | 29.4 steps/s
[Step=11500 Epoch=109.0] | Loss=0.00096 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.655 | L2-Norm(final)=2.679 | 4783.7 samples/s | 74.7 steps/s
[Step=11550 Epoch=109.4] | Loss=0.00083 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.655 | L2-Norm(final)=2.680 | 1915.5 samples/s | 29.9 steps/s
[Step=11600 Epoch=109.9] | Loss=0.00072 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.651 | L2-Norm(final)=2.681 | 4303.9 samples/s | 67.2 steps/s
[Step=11650 Epoch=110.4] | Loss=0.00064 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.645 | L2-Norm(final)=2.682 | 1993.1 samples/s | 31.1 steps/s
[Step=11700 Epoch=110.9] | Loss=0.00058 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.637 | L2-Norm(final)=2.683 | 3993.6 samples/s | 62.4 steps/s
[Step=11750 Epoch=111.3] | Loss=0.00053 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.629 | L2-Norm(final)=2.684 | 2016.7 samples/s | 31.5 steps/s
[Step=11800 Epoch=111.8] | Loss=0.00049 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.619 | L2-Norm(final)=2.684 | 3997.9 samples/s | 62.5 steps/s
[Step=11850 Epoch=112.3] | Loss=0.00045 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.609 | L2-Norm(final)=2.685 | 2038.2 samples/s | 31.8 steps/s
[Step=11900 Epoch=112.8] | Loss=0.00042 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.598 | L2-Norm(final)=2.686 | 4107.4 samples/s | 64.2 steps/s
[Step=11950 Epoch=113.2] | Loss=0.00039 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.586 | L2-Norm(final)=2.687 | 2059.2 samples/s | 32.2 steps/s
[Step=12000 Epoch=113.7] | Loss=0.00037 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.575 | L2-Norm(final)=2.688 | 3936.3 samples/s | 61.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step12000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=106.5] | Loss=0.05958 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.574 | L2-Norm(final)=2.644 | 4140.7 samples/s | 64.7 steps/s
[Step=11250 Epoch=107.0] | Loss=0.00319 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.625 | L2-Norm(final)=2.655 | 3952.5 samples/s | 61.8 steps/s
[Step=11300 Epoch=107.5] | Loss=0.00164 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.631 | L2-Norm(final)=2.662 | 5463.7 samples/s | 85.4 steps/s
[Step=11350 Epoch=108.0] | Loss=0.00110 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.625 | L2-Norm(final)=2.667 | 1800.5 samples/s | 28.1 steps/s
[Step=11400 Epoch=108.4] | Loss=0.00083 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.614 | L2-Norm(final)=2.670 | 5107.5 samples/s | 79.8 steps/s
[Step=11450 Epoch=108.9] | Loss=0.00067 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.602 | L2-Norm(final)=2.672 | 1874.0 samples/s | 29.3 steps/s
[Step=11500 Epoch=109.4] | Loss=0.00056 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.589 | L2-Norm(final)=2.674 | 4750.8 samples/s | 74.2 steps/s
[Step=11550 Epoch=109.9] | Loss=0.00048 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.576 | L2-Norm(final)=2.675 | 1911.4 samples/s | 29.9 steps/s
[Step=11600 Epoch=110.3] | Loss=0.00042 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.562 | L2-Norm(final)=2.676 | 4392.3 samples/s | 68.6 steps/s
[Step=11650 Epoch=110.8] | Loss=0.00037 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.549 | L2-Norm(final)=2.678 | 1980.7 samples/s | 30.9 steps/s
[Step=11700 Epoch=111.3] | Loss=0.00034 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.535 | L2-Norm(final)=2.679 | 4049.5 samples/s | 63.3 steps/s
[Step=11750 Epoch=111.8] | Loss=0.00031 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.520 | L2-Norm(final)=2.680 | 2019.4 samples/s | 31.6 steps/s
[Step=11800 Epoch=112.2] | Loss=0.00028 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.506 | L2-Norm(final)=2.681 | 3991.7 samples/s | 62.4 steps/s
[Step=11850 Epoch=112.7] | Loss=0.00026 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=2.683 | 2080.4 samples/s | 32.5 steps/s
[Step=11900 Epoch=113.2] | Loss=0.00024 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.478 | L2-Norm(final)=2.686 | 3975.4 samples/s | 62.1 steps/s
[Step=11950 Epoch=113.7] | Loss=0.00023 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.464 | L2-Norm(final)=2.689 | 2063.1 samples/s | 32.2 steps/s
[Step=12000 Epoch=114.1] | Loss=0.00021 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.449 | L2-Norm(final)=2.692 | 4050.5 samples/s | 63.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35862 | acc=0.8134 | tpr=0.7382 | fpr=0.0235 | 3885.9 samples/s | 15.2 steps/s
Avg test loss: 0.36013, Avg test acc: 0.81565, Avg tpr: 0.74261, Avg fpr: 0.02371, total FA: 185

Testing server on iccad2012
[Step=  50] | Loss=0.35655 | acc=0.8498 | tpr=0.9469 | fpr=0.1519 | 3845.3 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.36409 | acc=0.8482 | tpr=0.9574 | fpr=0.1538 | 7300.2 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.36818 | acc=0.8488 | tpr=0.9597 | fpr=0.1533 | 7096.1 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.36977 | acc=0.8495 | tpr=0.9574 | fpr=0.1524 | 7231.3 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.36747 | acc=0.8495 | tpr=0.9598 | fpr=0.1526 | 7163.9 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.37027 | acc=0.8490 | tpr=0.9607 | fpr=0.1531 | 6930.9 samples/s | 27.1 steps/s
[Step= 350] | Loss=0.37219 | acc=0.8487 | tpr=0.9593 | fpr=0.1533 | 7216.8 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.37340 | acc=0.8486 | tpr=0.9606 | fpr=0.1535 | 7093.1 samples/s | 27.7 steps/s
[Step= 450] | Loss=0.37580 | acc=0.8481 | tpr=0.9591 | fpr=0.1539 | 7029.7 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.37432 | acc=0.8483 | tpr=0.9599 | fpr=0.1537 | 7039.8 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.37193 | acc=0.8490 | tpr=0.9606 | fpr=0.1531 | 13095.1 samples/s | 51.2 steps/s
Avg test loss: 0.37141, Avg test acc: 0.84908, Avg tpr: 0.96078, Avg fpr: 0.15295, total FA: 21237

server round 15/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=58.5] | Loss=0.32811 | Reg=0.00182 | acc=0.7812 | L2-Norm=13.475 | L2-Norm(final)=2.698 | 4386.1 samples/s | 68.5 steps/s
[Step=12050 Epoch=58.8] | Loss=0.02726 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.569 | L2-Norm(final)=2.690 | 4111.3 samples/s | 64.2 steps/s
[Step=12100 Epoch=59.0] | Loss=0.02253 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.607 | L2-Norm(final)=2.692 | 4159.6 samples/s | 65.0 steps/s
[Step=12150 Epoch=59.2] | Loss=0.01985 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.630 | L2-Norm(final)=2.692 | 4204.1 samples/s | 65.7 steps/s
[Step=12200 Epoch=59.5] | Loss=0.01792 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.650 | L2-Norm(final)=2.693 | 5767.2 samples/s | 90.1 steps/s
[Step=12250 Epoch=59.7] | Loss=0.01631 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.666 | L2-Norm(final)=2.695 | 1856.5 samples/s | 29.0 steps/s
[Step=12300 Epoch=60.0] | Loss=0.01535 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.679 | L2-Norm(final)=2.697 | 4229.2 samples/s | 66.1 steps/s
[Step=12350 Epoch=60.2] | Loss=0.01463 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.690 | L2-Norm(final)=2.699 | 4238.3 samples/s | 66.2 steps/s
[Step=12400 Epoch=60.5] | Loss=0.01406 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.700 | L2-Norm(final)=2.701 | 5344.3 samples/s | 83.5 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01323 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.708 | L2-Norm(final)=2.702 | 1910.7 samples/s | 29.9 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01236 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.716 | L2-Norm(final)=2.703 | 4236.4 samples/s | 66.2 steps/s
[Step=12550 Epoch=61.2] | Loss=0.01169 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.722 | L2-Norm(final)=2.706 | 4203.0 samples/s | 65.7 steps/s
[Step=12600 Epoch=61.4] | Loss=0.01130 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.727 | L2-Norm(final)=2.708 | 4891.9 samples/s | 76.4 steps/s
[Step=12650 Epoch=61.7] | Loss=0.01069 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.732 | L2-Norm(final)=2.710 | 1961.8 samples/s | 30.7 steps/s
[Step=12700 Epoch=61.9] | Loss=0.01027 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.737 | L2-Norm(final)=2.712 | 4261.3 samples/s | 66.6 steps/s
[Step=12750 Epoch=62.2] | Loss=0.00997 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.741 | L2-Norm(final)=2.714 | 4218.0 samples/s | 65.9 steps/s
[Step=12800 Epoch=62.4] | Loss=0.00970 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.744 | L2-Norm(final)=2.716 | 4709.2 samples/s | 73.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step12800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=58.6] | Loss=0.16146 | Reg=0.00182 | acc=0.8438 | L2-Norm=13.475 | L2-Norm(final)=2.698 | 4353.0 samples/s | 68.0 steps/s
[Step=12050 Epoch=58.8] | Loss=0.02805 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.581 | L2-Norm(final)=2.684 | 4079.7 samples/s | 63.7 steps/s
[Step=12100 Epoch=59.0] | Loss=0.02010 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=2.691 | 4237.6 samples/s | 66.2 steps/s
[Step=12150 Epoch=59.3] | Loss=0.01705 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.642 | L2-Norm(final)=2.698 | 4312.4 samples/s | 67.4 steps/s
[Step=12200 Epoch=59.5] | Loss=0.01548 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.661 | L2-Norm(final)=2.703 | 5818.8 samples/s | 90.9 steps/s
[Step=12250 Epoch=59.8] | Loss=0.01409 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.675 | L2-Norm(final)=2.706 | 1856.9 samples/s | 29.0 steps/s
[Step=12300 Epoch=60.0] | Loss=0.01311 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.687 | L2-Norm(final)=2.710 | 4229.3 samples/s | 66.1 steps/s
[Step=12350 Epoch=60.3] | Loss=0.01246 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.696 | L2-Norm(final)=2.712 | 4169.2 samples/s | 65.1 steps/s
[Step=12400 Epoch=60.5] | Loss=0.01235 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.704 | L2-Norm(final)=2.714 | 5464.5 samples/s | 85.4 steps/s
[Step=12450 Epoch=60.8] | Loss=0.01179 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.712 | L2-Norm(final)=2.715 | 1888.1 samples/s | 29.5 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01126 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.720 | L2-Norm(final)=2.718 | 4161.8 samples/s | 65.0 steps/s
[Step=12550 Epoch=61.2] | Loss=0.01115 | Reg=0.00188 | acc=0.9531 | L2-Norm=13.727 | L2-Norm(final)=2.720 | 4198.5 samples/s | 65.6 steps/s
[Step=12600 Epoch=61.5] | Loss=0.01079 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.734 | L2-Norm(final)=2.722 | 5014.1 samples/s | 78.3 steps/s
[Step=12650 Epoch=61.7] | Loss=0.01048 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.741 | L2-Norm(final)=2.723 | 1940.2 samples/s | 30.3 steps/s
[Step=12700 Epoch=62.0] | Loss=0.01025 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.747 | L2-Norm(final)=2.725 | 4235.7 samples/s | 66.2 steps/s
[Step=12750 Epoch=62.2] | Loss=0.00980 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.753 | L2-Norm(final)=2.727 | 4207.0 samples/s | 65.7 steps/s
[Step=12800 Epoch=62.5] | Loss=0.00951 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.759 | L2-Norm(final)=2.728 | 4766.4 samples/s | 74.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step12800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=113.7] | Loss=0.11787 | Reg=0.00182 | acc=0.9531 | L2-Norm=13.475 | L2-Norm(final)=2.697 | 4079.5 samples/s | 63.7 steps/s
[Step=12050 Epoch=114.2] | Loss=0.01160 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.681 | L2-Norm(final)=2.678 | 4016.9 samples/s | 62.8 steps/s
[Step=12100 Epoch=114.7] | Loss=0.00605 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.739 | L2-Norm(final)=2.684 | 5595.9 samples/s | 87.4 steps/s
[Step=12150 Epoch=115.1] | Loss=0.00404 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.753 | L2-Norm(final)=2.689 | 1801.7 samples/s | 28.2 steps/s
[Step=12200 Epoch=115.6] | Loss=0.00305 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.754 | L2-Norm(final)=2.692 | 5033.4 samples/s | 78.6 steps/s
[Step=12250 Epoch=116.1] | Loss=0.00245 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.750 | L2-Norm(final)=2.695 | 1844.3 samples/s | 28.8 steps/s
[Step=12300 Epoch=116.6] | Loss=0.00204 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.742 | L2-Norm(final)=2.697 | 4774.6 samples/s | 74.6 steps/s
[Step=12350 Epoch=117.0] | Loss=0.00175 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.734 | L2-Norm(final)=2.699 | 1919.4 samples/s | 30.0 steps/s
[Step=12400 Epoch=117.5] | Loss=0.00153 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.724 | L2-Norm(final)=2.700 | 4399.5 samples/s | 68.7 steps/s
[Step=12450 Epoch=118.0] | Loss=0.00136 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.714 | L2-Norm(final)=2.702 | 1985.1 samples/s | 31.0 steps/s
[Step=12500 Epoch=118.4] | Loss=0.00123 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.703 | L2-Norm(final)=2.703 | 4084.4 samples/s | 63.8 steps/s
[Step=12550 Epoch=118.9] | Loss=0.00111 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.692 | L2-Norm(final)=2.705 | 2029.2 samples/s | 31.7 steps/s
[Step=12600 Epoch=119.4] | Loss=0.00102 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.681 | L2-Norm(final)=2.706 | 3964.7 samples/s | 61.9 steps/s
[Step=12650 Epoch=119.9] | Loss=0.00094 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.670 | L2-Norm(final)=2.707 | 2052.4 samples/s | 32.1 steps/s
[Step=12700 Epoch=120.3] | Loss=0.00088 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.658 | L2-Norm(final)=2.709 | 4082.7 samples/s | 63.8 steps/s
[Step=12750 Epoch=120.8] | Loss=0.00082 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.647 | L2-Norm(final)=2.710 | 2075.7 samples/s | 32.4 steps/s
[Step=12800 Epoch=121.3] | Loss=0.00077 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.635 | L2-Norm(final)=2.711 | 3962.2 samples/s | 61.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step12800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=114.2] | Loss=0.09901 | Reg=0.00182 | acc=0.9531 | L2-Norm=13.475 | L2-Norm(final)=2.697 | 4247.5 samples/s | 66.4 steps/s
[Step=12050 Epoch=114.6] | Loss=0.00491 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.654 | L2-Norm(final)=2.693 | 3866.5 samples/s | 60.4 steps/s
[Step=12100 Epoch=115.1] | Loss=0.00316 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.695 | L2-Norm(final)=2.694 | 5689.6 samples/s | 88.9 steps/s
[Step=12150 Epoch=115.6] | Loss=0.00216 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.705 | L2-Norm(final)=2.692 | 1851.0 samples/s | 28.9 steps/s
[Step=12200 Epoch=116.1] | Loss=0.00174 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.705 | L2-Norm(final)=2.692 | 5224.5 samples/s | 81.6 steps/s
[Step=12250 Epoch=116.5] | Loss=0.00140 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.701 | L2-Norm(final)=2.693 | 1870.4 samples/s | 29.2 steps/s
[Step=12300 Epoch=117.0] | Loss=0.00117 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.694 | L2-Norm(final)=2.694 | 4767.0 samples/s | 74.5 steps/s
[Step=12350 Epoch=117.5] | Loss=0.00101 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=2.695 | 1921.4 samples/s | 30.0 steps/s
[Step=12400 Epoch=118.0] | Loss=0.00088 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.674 | L2-Norm(final)=2.696 | 4530.8 samples/s | 70.8 steps/s
[Step=12450 Epoch=118.4] | Loss=0.00078 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.662 | L2-Norm(final)=2.697 | 1987.9 samples/s | 31.1 steps/s
[Step=12500 Epoch=118.9] | Loss=0.00071 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.650 | L2-Norm(final)=2.697 | 4114.8 samples/s | 64.3 steps/s
[Step=12550 Epoch=119.4] | Loss=0.00064 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.637 | L2-Norm(final)=2.698 | 2035.2 samples/s | 31.8 steps/s
[Step=12600 Epoch=119.9] | Loss=0.00059 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.624 | L2-Norm(final)=2.699 | 4028.1 samples/s | 62.9 steps/s
[Step=12650 Epoch=120.3] | Loss=0.00054 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.611 | L2-Norm(final)=2.699 | 2040.5 samples/s | 31.9 steps/s
[Step=12700 Epoch=120.8] | Loss=0.00051 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.598 | L2-Norm(final)=2.700 | 4086.4 samples/s | 63.9 steps/s
[Step=12750 Epoch=121.3] | Loss=0.00047 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.584 | L2-Norm(final)=2.700 | 2049.9 samples/s | 32.0 steps/s
[Step=12800 Epoch=121.8] | Loss=0.00044 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.570 | L2-Norm(final)=2.701 | 4090.1 samples/s | 63.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.55456 | acc=0.7148 | tpr=0.5935 | fpr=0.0218 | 3896.7 samples/s | 15.2 steps/s
Avg test loss: 0.55481, Avg test acc: 0.71540, Avg tpr: 0.59585, Avg fpr: 0.02166, total FA: 169

Testing server on iccad2012
[Step=  50] | Loss=0.23496 | acc=0.9193 | tpr=0.9469 | fpr=0.0812 | 3925.4 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.23708 | acc=0.9195 | tpr=0.9680 | fpr=0.0814 | 7046.4 samples/s | 27.5 steps/s
[Step= 150] | Loss=0.24226 | acc=0.9191 | tpr=0.9654 | fpr=0.0818 | 7062.2 samples/s | 27.6 steps/s
[Step= 200] | Loss=0.24327 | acc=0.9194 | tpr=0.9639 | fpr=0.0814 | 7432.6 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.24003 | acc=0.9196 | tpr=0.9633 | fpr=0.0812 | 7058.6 samples/s | 27.6 steps/s
[Step= 300] | Loss=0.24270 | acc=0.9192 | tpr=0.9600 | fpr=0.0815 | 6920.0 samples/s | 27.0 steps/s
[Step= 350] | Loss=0.24466 | acc=0.9189 | tpr=0.9599 | fpr=0.0818 | 7033.8 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.24613 | acc=0.9189 | tpr=0.9601 | fpr=0.0818 | 7256.5 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.24908 | acc=0.9181 | tpr=0.9572 | fpr=0.0826 | 7059.4 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.24826 | acc=0.9181 | tpr=0.9581 | fpr=0.0826 | 7127.3 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.24670 | acc=0.9187 | tpr=0.9586 | fpr=0.0820 | 13360.8 samples/s | 52.2 steps/s
Avg test loss: 0.24626, Avg test acc: 0.91875, Avg tpr: 0.95880, Avg fpr: 0.08198, total FA: 11383

server round 16/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=62.4] | Loss=0.39368 | Reg=0.00180 | acc=0.8438 | L2-Norm=13.423 | L2-Norm(final)=2.725 | 4430.4 samples/s | 69.2 steps/s
[Step=12850 Epoch=62.7] | Loss=0.04471 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.556 | L2-Norm(final)=2.696 | 4027.9 samples/s | 62.9 steps/s
[Step=12900 Epoch=62.9] | Loss=0.02726 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.603 | L2-Norm(final)=2.706 | 4276.0 samples/s | 66.8 steps/s
[Step=12950 Epoch=63.1] | Loss=0.02145 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.627 | L2-Norm(final)=2.717 | 4208.2 samples/s | 65.8 steps/s
[Step=13000 Epoch=63.4] | Loss=0.01916 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.645 | L2-Norm(final)=2.724 | 5797.0 samples/s | 90.6 steps/s
[Step=13050 Epoch=63.6] | Loss=0.01710 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.659 | L2-Norm(final)=2.729 | 1863.1 samples/s | 29.1 steps/s
[Step=13100 Epoch=63.9] | Loss=0.01514 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.671 | L2-Norm(final)=2.733 | 4190.7 samples/s | 65.5 steps/s
[Step=13150 Epoch=64.1] | Loss=0.01415 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.682 | L2-Norm(final)=2.738 | 4271.7 samples/s | 66.7 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01347 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.691 | L2-Norm(final)=2.741 | 5306.7 samples/s | 82.9 steps/s
[Step=13250 Epoch=64.6] | Loss=0.01282 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.700 | L2-Norm(final)=2.745 | 1931.7 samples/s | 30.2 steps/s
[Step=13300 Epoch=64.9] | Loss=0.01232 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.707 | L2-Norm(final)=2.747 | 4174.7 samples/s | 65.2 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01178 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.713 | L2-Norm(final)=2.749 | 4270.1 samples/s | 66.7 steps/s
[Step=13400 Epoch=65.3] | Loss=0.01161 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.719 | L2-Norm(final)=2.751 | 4906.8 samples/s | 76.7 steps/s
[Step=13450 Epoch=65.6] | Loss=0.01108 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.724 | L2-Norm(final)=2.753 | 1963.7 samples/s | 30.7 steps/s
[Step=13500 Epoch=65.8] | Loss=0.01058 | Reg=0.00188 | acc=0.9844 | L2-Norm=13.729 | L2-Norm(final)=2.755 | 4322.4 samples/s | 67.5 steps/s
[Step=13550 Epoch=66.1] | Loss=0.01012 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.733 | L2-Norm(final)=2.757 | 4334.0 samples/s | 67.7 steps/s
[Step=13600 Epoch=66.3] | Loss=0.00985 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.737 | L2-Norm(final)=2.759 | 4628.1 samples/s | 72.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step13600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=62.5] | Loss=0.19254 | Reg=0.00180 | acc=0.8594 | L2-Norm=13.423 | L2-Norm(final)=2.727 | 4220.1 samples/s | 65.9 steps/s
[Step=12850 Epoch=62.7] | Loss=0.03942 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.555 | L2-Norm(final)=2.698 | 4237.2 samples/s | 66.2 steps/s
[Step=12900 Epoch=62.9] | Loss=0.02573 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.604 | L2-Norm(final)=2.705 | 4182.5 samples/s | 65.4 steps/s
[Step=12950 Epoch=63.2] | Loss=0.02153 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.631 | L2-Norm(final)=2.714 | 4264.2 samples/s | 66.6 steps/s
[Step=13000 Epoch=63.4] | Loss=0.01911 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.651 | L2-Norm(final)=2.719 | 5782.7 samples/s | 90.4 steps/s
[Step=13050 Epoch=63.7] | Loss=0.01636 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.668 | L2-Norm(final)=2.724 | 1853.6 samples/s | 29.0 steps/s
[Step=13100 Epoch=63.9] | Loss=0.01480 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.680 | L2-Norm(final)=2.729 | 4195.5 samples/s | 65.6 steps/s
[Step=13150 Epoch=64.2] | Loss=0.01414 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.689 | L2-Norm(final)=2.732 | 4219.5 samples/s | 65.9 steps/s
[Step=13200 Epoch=64.4] | Loss=0.01353 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.698 | L2-Norm(final)=2.734 | 5420.8 samples/s | 84.7 steps/s
[Step=13250 Epoch=64.7] | Loss=0.01254 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.706 | L2-Norm(final)=2.737 | 1904.2 samples/s | 29.8 steps/s
[Step=13300 Epoch=64.9] | Loss=0.01194 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.712 | L2-Norm(final)=2.740 | 4162.3 samples/s | 65.0 steps/s
[Step=13350 Epoch=65.1] | Loss=0.01133 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.717 | L2-Norm(final)=2.743 | 4204.9 samples/s | 65.7 steps/s
[Step=13400 Epoch=65.4] | Loss=0.01081 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.722 | L2-Norm(final)=2.745 | 5036.5 samples/s | 78.7 steps/s
[Step=13450 Epoch=65.6] | Loss=0.01021 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.727 | L2-Norm(final)=2.749 | 1949.9 samples/s | 30.5 steps/s
[Step=13500 Epoch=65.9] | Loss=0.00973 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.731 | L2-Norm(final)=2.752 | 4256.0 samples/s | 66.5 steps/s
[Step=13550 Epoch=66.1] | Loss=0.00937 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.735 | L2-Norm(final)=2.755 | 4166.9 samples/s | 65.1 steps/s
[Step=13600 Epoch=66.4] | Loss=0.00911 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.738 | L2-Norm(final)=2.758 | 4847.9 samples/s | 75.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step13600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=121.3] | Loss=0.00827 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.423 | L2-Norm(final)=2.729 | 4072.7 samples/s | 63.6 steps/s
[Step=12850 Epoch=121.8] | Loss=0.00092 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.488 | L2-Norm(final)=2.756 | 3961.7 samples/s | 61.9 steps/s
[Step=12900 Epoch=122.2] | Loss=0.00047 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.503 | L2-Norm(final)=2.764 | 5451.2 samples/s | 85.2 steps/s
[Step=12950 Epoch=122.7] | Loss=0.00032 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.498 | L2-Norm(final)=2.767 | 1806.1 samples/s | 28.2 steps/s
[Step=13000 Epoch=123.2] | Loss=0.00024 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.487 | L2-Norm(final)=2.769 | 5156.5 samples/s | 80.6 steps/s
[Step=13050 Epoch=123.7] | Loss=0.00019 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.474 | L2-Norm(final)=2.770 | 1867.2 samples/s | 29.2 steps/s
[Step=13100 Epoch=124.1] | Loss=0.00016 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.461 | L2-Norm(final)=2.771 | 4705.3 samples/s | 73.5 steps/s
[Step=13150 Epoch=124.6] | Loss=0.00014 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.448 | L2-Norm(final)=2.772 | 1916.1 samples/s | 29.9 steps/s
[Step=13200 Epoch=125.1] | Loss=0.00012 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.434 | L2-Norm(final)=2.773 | 4335.4 samples/s | 67.7 steps/s
[Step=13250 Epoch=125.6] | Loss=0.00011 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.421 | L2-Norm(final)=2.774 | 1951.6 samples/s | 30.5 steps/s
[Step=13300 Epoch=126.0] | Loss=0.00010 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.407 | L2-Norm(final)=2.774 | 4161.8 samples/s | 65.0 steps/s
[Step=13350 Epoch=126.5] | Loss=0.00009 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.393 | L2-Norm(final)=2.775 | 2031.4 samples/s | 31.7 steps/s
[Step=13400 Epoch=127.0] | Loss=0.00008 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=2.776 | 4047.2 samples/s | 63.2 steps/s
[Step=13450 Epoch=127.5] | Loss=0.00008 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.366 | L2-Norm(final)=2.776 | 2039.6 samples/s | 31.9 steps/s
[Step=13500 Epoch=127.9] | Loss=0.00007 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=2.777 | 4133.4 samples/s | 64.6 steps/s
[Step=13550 Epoch=128.4] | Loss=0.00007 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.339 | L2-Norm(final)=2.777 | 2072.9 samples/s | 32.4 steps/s
[Step=13600 Epoch=128.9] | Loss=0.00006 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.325 | L2-Norm(final)=2.778 | 4151.4 samples/s | 64.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step13600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=121.8] | Loss=0.01234 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.423 | L2-Norm(final)=2.729 | 4241.8 samples/s | 66.3 steps/s
[Step=12850 Epoch=122.2] | Loss=0.00059 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.465 | L2-Norm(final)=2.749 | 3918.5 samples/s | 61.2 steps/s
[Step=12900 Epoch=122.7] | Loss=0.00032 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.460 | L2-Norm(final)=2.757 | 5614.6 samples/s | 87.7 steps/s
[Step=12950 Epoch=123.2] | Loss=0.00021 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.448 | L2-Norm(final)=2.763 | 1814.9 samples/s | 28.4 steps/s
[Step=13000 Epoch=123.7] | Loss=0.00016 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.433 | L2-Norm(final)=2.768 | 5087.2 samples/s | 79.5 steps/s
[Step=13050 Epoch=124.1] | Loss=0.00013 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.417 | L2-Norm(final)=2.773 | 1861.9 samples/s | 29.1 steps/s
[Step=13100 Epoch=124.6] | Loss=0.00011 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.401 | L2-Norm(final)=2.779 | 4756.3 samples/s | 74.3 steps/s
[Step=13150 Epoch=125.1] | Loss=0.00009 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.385 | L2-Norm(final)=2.784 | 1920.1 samples/s | 30.0 steps/s
[Step=13200 Epoch=125.6] | Loss=0.00008 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=2.789 | 4382.0 samples/s | 68.5 steps/s
[Step=13250 Epoch=126.0] | Loss=0.00007 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.352 | L2-Norm(final)=2.795 | 1976.5 samples/s | 30.9 steps/s
[Step=13300 Epoch=126.5] | Loss=0.00007 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.335 | L2-Norm(final)=2.801 | 4156.7 samples/s | 64.9 steps/s
[Step=13350 Epoch=127.0] | Loss=0.00006 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.319 | L2-Norm(final)=2.807 | 2016.1 samples/s | 31.5 steps/s
[Step=13400 Epoch=127.5] | Loss=0.00006 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.303 | L2-Norm(final)=2.813 | 4202.0 samples/s | 65.7 steps/s
[Step=13450 Epoch=127.9] | Loss=0.00005 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.286 | L2-Norm(final)=2.818 | 2062.3 samples/s | 32.2 steps/s
[Step=13500 Epoch=128.4] | Loss=0.00005 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.270 | L2-Norm(final)=2.824 | 4006.7 samples/s | 62.6 steps/s
[Step=13550 Epoch=128.9] | Loss=0.00005 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.253 | L2-Norm(final)=2.830 | 2057.1 samples/s | 32.1 steps/s
[Step=13600 Epoch=129.4] | Loss=0.00004 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.237 | L2-Norm(final)=2.836 | 4082.9 samples/s | 63.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33229 | acc=0.8441 | tpr=0.7818 | fpr=0.0208 | 3871.2 samples/s | 15.1 steps/s
Avg test loss: 0.33538, Avg test acc: 0.84370, Avg tpr: 0.78225, Avg fpr: 0.02115, total FA: 165

Testing server on iccad2012
[Step=  50] | Loss=0.49963 | acc=0.8058 | tpr=0.9336 | fpr=0.1965 | 3985.3 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.50732 | acc=0.8037 | tpr=0.9510 | fpr=0.1991 | 6725.7 samples/s | 26.3 steps/s
[Step= 150] | Loss=0.51063 | acc=0.8050 | tpr=0.9524 | fpr=0.1977 | 7170.4 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.51217 | acc=0.8053 | tpr=0.9519 | fpr=0.1974 | 7200.3 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.50983 | acc=0.8052 | tpr=0.9520 | fpr=0.1975 | 7056.4 samples/s | 27.6 steps/s
[Step= 300] | Loss=0.51318 | acc=0.8053 | tpr=0.9498 | fpr=0.1973 | 7213.1 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.51604 | acc=0.8051 | tpr=0.9505 | fpr=0.1975 | 7171.8 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.51714 | acc=0.8054 | tpr=0.9524 | fpr=0.1973 | 7084.5 samples/s | 27.7 steps/s
[Step= 450] | Loss=0.52060 | acc=0.8050 | tpr=0.9513 | fpr=0.1977 | 7078.2 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.51881 | acc=0.8056 | tpr=0.9533 | fpr=0.1971 | 7062.8 samples/s | 27.6 steps/s
[Step= 550] | Loss=0.51594 | acc=0.8065 | tpr=0.9546 | fpr=0.1962 | 12891.8 samples/s | 50.4 steps/s
Avg test loss: 0.51522, Avg test acc: 0.80657, Avg tpr: 0.95483, Avg fpr: 0.19612, total FA: 27231

server round 17/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=66.3] | Loss=0.06721 | Reg=0.00177 | acc=0.9375 | L2-Norm=13.305 | L2-Norm(final)=2.808 | 4363.9 samples/s | 68.2 steps/s
[Step=13650 Epoch=66.6] | Loss=0.02041 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.401 | L2-Norm(final)=2.802 | 3976.0 samples/s | 62.1 steps/s
[Step=13700 Epoch=66.8] | Loss=0.01571 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.438 | L2-Norm(final)=2.806 | 4315.2 samples/s | 67.4 steps/s
[Step=13750 Epoch=67.0] | Loss=0.01402 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.458 | L2-Norm(final)=2.808 | 4199.9 samples/s | 65.6 steps/s
[Step=13800 Epoch=67.3] | Loss=0.01330 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.477 | L2-Norm(final)=2.814 | 5698.4 samples/s | 89.0 steps/s
[Step=13850 Epoch=67.5] | Loss=0.01209 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=2.818 | 1846.7 samples/s | 28.9 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01096 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.505 | L2-Norm(final)=2.822 | 4176.7 samples/s | 65.3 steps/s
[Step=13950 Epoch=68.0] | Loss=0.01063 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.516 | L2-Norm(final)=2.826 | 4217.7 samples/s | 65.9 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01056 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=2.829 | 5343.4 samples/s | 83.5 steps/s
[Step=14050 Epoch=68.5] | Loss=0.00990 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.533 | L2-Norm(final)=2.832 | 1912.4 samples/s | 29.9 steps/s
[Step=14100 Epoch=68.8] | Loss=0.00963 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.540 | L2-Norm(final)=2.834 | 4219.2 samples/s | 65.9 steps/s
[Step=14150 Epoch=69.0] | Loss=0.00905 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.547 | L2-Norm(final)=2.837 | 4296.2 samples/s | 67.1 steps/s
[Step=14200 Epoch=69.2] | Loss=0.00864 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.553 | L2-Norm(final)=2.840 | 4878.1 samples/s | 76.2 steps/s
[Step=14250 Epoch=69.5] | Loss=0.00833 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.558 | L2-Norm(final)=2.843 | 1983.4 samples/s | 31.0 steps/s
[Step=14300 Epoch=69.7] | Loss=0.00807 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.562 | L2-Norm(final)=2.845 | 4174.1 samples/s | 65.2 steps/s
[Step=14350 Epoch=70.0] | Loss=0.00803 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.565 | L2-Norm(final)=2.847 | 4260.7 samples/s | 66.6 steps/s
[Step=14400 Epoch=70.2] | Loss=0.00783 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.568 | L2-Norm(final)=2.848 | 4647.3 samples/s | 72.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step14400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=66.4] | Loss=0.20618 | Reg=0.00177 | acc=0.8750 | L2-Norm=13.305 | L2-Norm(final)=2.807 | 4700.3 samples/s | 73.4 steps/s
[Step=13650 Epoch=66.6] | Loss=0.03002 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.418 | L2-Norm(final)=2.789 | 3820.1 samples/s | 59.7 steps/s
[Step=13700 Epoch=66.8] | Loss=0.02267 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.470 | L2-Norm(final)=2.792 | 4258.3 samples/s | 66.5 steps/s
[Step=13750 Epoch=67.1] | Loss=0.02015 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.501 | L2-Norm(final)=2.795 | 4206.9 samples/s | 65.7 steps/s
[Step=13800 Epoch=67.3] | Loss=0.01825 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.525 | L2-Norm(final)=2.798 | 5955.9 samples/s | 93.1 steps/s
[Step=13850 Epoch=67.6] | Loss=0.01615 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.544 | L2-Norm(final)=2.800 | 1854.5 samples/s | 29.0 steps/s
[Step=13900 Epoch=67.8] | Loss=0.01502 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.558 | L2-Norm(final)=2.804 | 4196.0 samples/s | 65.6 steps/s
[Step=13950 Epoch=68.1] | Loss=0.01402 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.570 | L2-Norm(final)=2.806 | 4282.0 samples/s | 66.9 steps/s
[Step=14000 Epoch=68.3] | Loss=0.01305 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.580 | L2-Norm(final)=2.809 | 5426.6 samples/s | 84.8 steps/s
[Step=14050 Epoch=68.6] | Loss=0.01200 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.588 | L2-Norm(final)=2.812 | 1894.3 samples/s | 29.6 steps/s
[Step=14100 Epoch=68.8] | Loss=0.01115 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.596 | L2-Norm(final)=2.815 | 4202.3 samples/s | 65.7 steps/s
[Step=14150 Epoch=69.0] | Loss=0.01085 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.603 | L2-Norm(final)=2.818 | 4219.9 samples/s | 65.9 steps/s
[Step=14200 Epoch=69.3] | Loss=0.01040 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.609 | L2-Norm(final)=2.820 | 5012.7 samples/s | 78.3 steps/s
[Step=14250 Epoch=69.5] | Loss=0.00998 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.614 | L2-Norm(final)=2.822 | 1953.0 samples/s | 30.5 steps/s
[Step=14300 Epoch=69.8] | Loss=0.00947 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.619 | L2-Norm(final)=2.825 | 4321.5 samples/s | 67.5 steps/s
[Step=14350 Epoch=70.0] | Loss=0.00903 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.623 | L2-Norm(final)=2.828 | 4139.8 samples/s | 64.7 steps/s
[Step=14400 Epoch=70.3] | Loss=0.00880 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.626 | L2-Norm(final)=2.830 | 4805.1 samples/s | 75.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step14400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=128.9] | Loss=0.10932 | Reg=0.00177 | acc=0.9531 | L2-Norm=13.305 | L2-Norm(final)=2.806 | 4619.8 samples/s | 72.2 steps/s
[Step=13650 Epoch=129.3] | Loss=0.00789 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.523 | L2-Norm(final)=2.790 | 3475.6 samples/s | 54.3 steps/s
[Step=13700 Epoch=129.8] | Loss=0.00522 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.585 | L2-Norm(final)=2.788 | 5600.1 samples/s | 87.5 steps/s
[Step=13750 Epoch=130.3] | Loss=0.00383 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.607 | L2-Norm(final)=2.787 | 1818.4 samples/s | 28.4 steps/s
[Step=13800 Epoch=130.8] | Loss=0.00288 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=2.787 | 5101.0 samples/s | 79.7 steps/s
[Step=13850 Epoch=131.2] | Loss=0.00231 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.616 | L2-Norm(final)=2.788 | 1854.5 samples/s | 29.0 steps/s
[Step=13900 Epoch=131.7] | Loss=0.00193 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.613 | L2-Norm(final)=2.789 | 4710.8 samples/s | 73.6 steps/s
[Step=13950 Epoch=132.2] | Loss=0.00165 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.607 | L2-Norm(final)=2.789 | 1935.0 samples/s | 30.2 steps/s
[Step=14000 Epoch=132.7] | Loss=0.00145 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.601 | L2-Norm(final)=2.790 | 4425.7 samples/s | 69.2 steps/s
[Step=14050 Epoch=133.1] | Loss=0.00129 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.593 | L2-Norm(final)=2.791 | 1999.3 samples/s | 31.2 steps/s
[Step=14100 Epoch=133.6] | Loss=0.00116 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.585 | L2-Norm(final)=2.791 | 4129.2 samples/s | 64.5 steps/s
[Step=14150 Epoch=134.1] | Loss=0.00105 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.576 | L2-Norm(final)=2.792 | 2042.7 samples/s | 31.9 steps/s
[Step=14200 Epoch=134.6] | Loss=0.00097 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.568 | L2-Norm(final)=2.792 | 4061.0 samples/s | 63.5 steps/s
[Step=14250 Epoch=135.0] | Loss=0.00089 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.558 | L2-Norm(final)=2.793 | 2058.7 samples/s | 32.2 steps/s
[Step=14300 Epoch=135.5] | Loss=0.00083 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.549 | L2-Norm(final)=2.793 | 4078.6 samples/s | 63.7 steps/s
[Step=14350 Epoch=136.0] | Loss=0.00077 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.540 | L2-Norm(final)=2.793 | 2067.3 samples/s | 32.3 steps/s
[Step=14400 Epoch=136.5] | Loss=0.00073 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.530 | L2-Norm(final)=2.794 | 4027.2 samples/s | 62.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step14400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=129.4] | Loss=0.11194 | Reg=0.00177 | acc=0.9375 | L2-Norm=13.305 | L2-Norm(final)=2.806 | 4632.0 samples/s | 72.4 steps/s
[Step=13650 Epoch=129.8] | Loss=0.00914 | Reg=0.00184 | acc=0.9844 | L2-Norm=13.569 | L2-Norm(final)=2.787 | 3580.8 samples/s | 55.9 steps/s
[Step=13700 Epoch=130.3] | Loss=0.00565 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.647 | L2-Norm(final)=2.785 | 5565.6 samples/s | 87.0 steps/s
[Step=13750 Epoch=130.8] | Loss=0.00384 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.674 | L2-Norm(final)=2.786 | 1811.1 samples/s | 28.3 steps/s
[Step=13800 Epoch=131.3] | Loss=0.00289 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.683 | L2-Norm(final)=2.788 | 5049.3 samples/s | 78.9 steps/s
[Step=13850 Epoch=131.7] | Loss=0.00232 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.684 | L2-Norm(final)=2.790 | 1863.8 samples/s | 29.1 steps/s
[Step=13900 Epoch=132.2] | Loss=0.00193 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.680 | L2-Norm(final)=2.791 | 4775.0 samples/s | 74.6 steps/s
[Step=13950 Epoch=132.7] | Loss=0.00166 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.674 | L2-Norm(final)=2.792 | 1906.9 samples/s | 29.8 steps/s
[Step=14000 Epoch=133.2] | Loss=0.00145 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.667 | L2-Norm(final)=2.794 | 4432.3 samples/s | 69.3 steps/s
[Step=14050 Epoch=133.7] | Loss=0.00129 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.659 | L2-Norm(final)=2.794 | 1977.6 samples/s | 30.9 steps/s
[Step=14100 Epoch=134.1] | Loss=0.00116 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.651 | L2-Norm(final)=2.795 | 4074.2 samples/s | 63.7 steps/s
[Step=14150 Epoch=134.6] | Loss=0.00106 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.641 | L2-Norm(final)=2.796 | 2042.2 samples/s | 31.9 steps/s
[Step=14200 Epoch=135.1] | Loss=0.00097 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.632 | L2-Norm(final)=2.797 | 4145.8 samples/s | 64.8 steps/s
[Step=14250 Epoch=135.6] | Loss=0.00090 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.622 | L2-Norm(final)=2.797 | 2031.8 samples/s | 31.7 steps/s
[Step=14300 Epoch=136.0] | Loss=0.00083 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.612 | L2-Norm(final)=2.798 | 3994.0 samples/s | 62.4 steps/s
[Step=14350 Epoch=136.5] | Loss=0.00078 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.602 | L2-Norm(final)=2.799 | 2048.1 samples/s | 32.0 steps/s
[Step=14400 Epoch=137.0] | Loss=0.00073 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.592 | L2-Norm(final)=2.799 | 4062.2 samples/s | 63.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.76870 | acc=0.6439 | tpr=0.4868 | fpr=0.0149 | 3909.5 samples/s | 15.3 steps/s
Avg test loss: 0.77866, Avg test acc: 0.64408, Avg tpr: 0.48890, Avg fpr: 0.01461, total FA: 114

Testing server on iccad2012
[Step=  50] | Loss=0.20696 | acc=0.9419 | tpr=0.9336 | fpr=0.0580 | 3878.8 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.21216 | acc=0.9411 | tpr=0.9531 | fpr=0.0591 | 7366.5 samples/s | 28.8 steps/s
[Step= 150] | Loss=0.21969 | acc=0.9402 | tpr=0.9524 | fpr=0.0600 | 7147.4 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.22212 | acc=0.9405 | tpr=0.9497 | fpr=0.0597 | 7257.8 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.21892 | acc=0.9409 | tpr=0.9502 | fpr=0.0593 | 6986.7 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.22209 | acc=0.9407 | tpr=0.9498 | fpr=0.0594 | 7252.7 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.22398 | acc=0.9407 | tpr=0.9512 | fpr=0.0595 | 7270.9 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.22557 | acc=0.9404 | tpr=0.9502 | fpr=0.0598 | 7086.3 samples/s | 27.7 steps/s
[Step= 450] | Loss=0.22861 | acc=0.9399 | tpr=0.9484 | fpr=0.0603 | 7167.5 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.22722 | acc=0.9401 | tpr=0.9507 | fpr=0.0601 | 7009.1 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.22568 | acc=0.9404 | tpr=0.9515 | fpr=0.0598 | 13313.2 samples/s | 52.0 steps/s
Avg test loss: 0.22513, Avg test acc: 0.94040, Avg tpr: 0.95166, Avg fpr: 0.05981, total FA: 8304

server round 18/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=70.2] | Loss=0.50415 | Reg=0.00178 | acc=0.7188 | L2-Norm=13.327 | L2-Norm(final)=2.829 | 4249.3 samples/s | 66.4 steps/s
[Step=14450 Epoch=70.5] | Loss=0.05440 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.471 | L2-Norm(final)=2.789 | 4227.1 samples/s | 66.0 steps/s
[Step=14500 Epoch=70.7] | Loss=0.03509 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.526 | L2-Norm(final)=2.797 | 4265.2 samples/s | 66.6 steps/s
[Step=14550 Epoch=70.9] | Loss=0.02737 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.558 | L2-Norm(final)=2.803 | 4172.5 samples/s | 65.2 steps/s
[Step=14600 Epoch=71.2] | Loss=0.02328 | Reg=0.00184 | acc=0.9688 | L2-Norm=13.580 | L2-Norm(final)=2.810 | 5745.4 samples/s | 89.8 steps/s
[Step=14650 Epoch=71.4] | Loss=0.02074 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.596 | L2-Norm(final)=2.812 | 1891.6 samples/s | 29.6 steps/s
[Step=14700 Epoch=71.7] | Loss=0.01849 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.609 | L2-Norm(final)=2.815 | 4231.3 samples/s | 66.1 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01695 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.620 | L2-Norm(final)=2.818 | 4249.8 samples/s | 66.4 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01576 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.630 | L2-Norm(final)=2.821 | 5447.8 samples/s | 85.1 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01451 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.639 | L2-Norm(final)=2.824 | 1920.2 samples/s | 30.0 steps/s
[Step=14900 Epoch=72.7] | Loss=0.01362 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.647 | L2-Norm(final)=2.828 | 4322.2 samples/s | 67.5 steps/s
[Step=14950 Epoch=72.9] | Loss=0.01325 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.654 | L2-Norm(final)=2.830 | 4224.6 samples/s | 66.0 steps/s
[Step=15000 Epoch=73.1] | Loss=0.01263 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.660 | L2-Norm(final)=2.832 | 5015.7 samples/s | 78.4 steps/s
[Step=15050 Epoch=73.4] | Loss=0.01207 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.667 | L2-Norm(final)=2.835 | 1984.9 samples/s | 31.0 steps/s
[Step=15100 Epoch=73.6] | Loss=0.01148 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.673 | L2-Norm(final)=2.837 | 4273.0 samples/s | 66.8 steps/s
[Step=15150 Epoch=73.9] | Loss=0.01106 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.679 | L2-Norm(final)=2.840 | 4289.2 samples/s | 67.0 steps/s
[Step=15200 Epoch=74.1] | Loss=0.01065 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.683 | L2-Norm(final)=2.842 | 4589.2 samples/s | 71.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step15200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=70.3] | Loss=0.42314 | Reg=0.00178 | acc=0.7969 | L2-Norm=13.327 | L2-Norm(final)=2.828 | 4527.6 samples/s | 70.7 steps/s
[Step=14450 Epoch=70.5] | Loss=0.05104 | Reg=0.00181 | acc=0.9688 | L2-Norm=13.467 | L2-Norm(final)=2.779 | 3981.9 samples/s | 62.2 steps/s
[Step=14500 Epoch=70.8] | Loss=0.03285 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.520 | L2-Norm(final)=2.784 | 4222.4 samples/s | 66.0 steps/s
[Step=14550 Epoch=71.0] | Loss=0.02540 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.552 | L2-Norm(final)=2.793 | 4186.7 samples/s | 65.4 steps/s
[Step=14600 Epoch=71.2] | Loss=0.02152 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.576 | L2-Norm(final)=2.802 | 5848.5 samples/s | 91.4 steps/s
[Step=14650 Epoch=71.5] | Loss=0.01868 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.595 | L2-Norm(final)=2.809 | 1868.2 samples/s | 29.2 steps/s
[Step=14700 Epoch=71.7] | Loss=0.01652 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.609 | L2-Norm(final)=2.815 | 4221.9 samples/s | 66.0 steps/s
[Step=14750 Epoch=72.0] | Loss=0.01527 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.620 | L2-Norm(final)=2.821 | 4225.8 samples/s | 66.0 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01430 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.630 | L2-Norm(final)=2.826 | 5453.6 samples/s | 85.2 steps/s
[Step=14850 Epoch=72.5] | Loss=0.01331 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.638 | L2-Norm(final)=2.830 | 1927.8 samples/s | 30.1 steps/s
[Step=14900 Epoch=72.7] | Loss=0.01234 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.646 | L2-Norm(final)=2.835 | 4184.0 samples/s | 65.4 steps/s
[Step=14950 Epoch=72.9] | Loss=0.01166 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.653 | L2-Norm(final)=2.840 | 4181.3 samples/s | 65.3 steps/s
[Step=15000 Epoch=73.2] | Loss=0.01105 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.659 | L2-Norm(final)=2.843 | 5038.5 samples/s | 78.7 steps/s
[Step=15050 Epoch=73.4] | Loss=0.01056 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.664 | L2-Norm(final)=2.847 | 1949.2 samples/s | 30.5 steps/s
[Step=15100 Epoch=73.7] | Loss=0.01000 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.668 | L2-Norm(final)=2.850 | 4188.8 samples/s | 65.4 steps/s
[Step=15150 Epoch=73.9] | Loss=0.00977 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.671 | L2-Norm(final)=2.853 | 4262.1 samples/s | 66.6 steps/s
[Step=15200 Epoch=74.2] | Loss=0.00932 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.674 | L2-Norm(final)=2.856 | 4737.5 samples/s | 74.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step15200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=136.5] | Loss=0.00322 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.327 | L2-Norm(final)=2.832 | 4123.4 samples/s | 64.4 steps/s
[Step=14450 Epoch=136.9] | Loss=0.00284 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.387 | L2-Norm(final)=2.843 | 3787.7 samples/s | 59.2 steps/s
[Step=14500 Epoch=137.4] | Loss=0.00168 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.423 | L2-Norm(final)=2.849 | 5484.9 samples/s | 85.7 steps/s
[Step=14550 Epoch=137.9] | Loss=0.00113 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.434 | L2-Norm(final)=2.854 | 1799.4 samples/s | 28.1 steps/s
[Step=14600 Epoch=138.3] | Loss=0.00085 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.433 | L2-Norm(final)=2.857 | 5090.1 samples/s | 79.5 steps/s
[Step=14650 Epoch=138.8] | Loss=0.00068 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.428 | L2-Norm(final)=2.860 | 1871.4 samples/s | 29.2 steps/s
[Step=14700 Epoch=139.3] | Loss=0.00057 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.422 | L2-Norm(final)=2.861 | 4695.2 samples/s | 73.4 steps/s
[Step=14750 Epoch=139.8] | Loss=0.00049 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.413 | L2-Norm(final)=2.863 | 1911.3 samples/s | 29.9 steps/s
[Step=14800 Epoch=140.2] | Loss=0.00043 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.405 | L2-Norm(final)=2.864 | 4398.0 samples/s | 68.7 steps/s
[Step=14850 Epoch=140.7] | Loss=0.00038 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.395 | L2-Norm(final)=2.865 | 1966.7 samples/s | 30.7 steps/s
[Step=14900 Epoch=141.2] | Loss=0.00034 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.386 | L2-Norm(final)=2.866 | 4098.7 samples/s | 64.0 steps/s
[Step=14950 Epoch=141.7] | Loss=0.00031 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.376 | L2-Norm(final)=2.867 | 2028.3 samples/s | 31.7 steps/s
[Step=15000 Epoch=142.1] | Loss=0.00029 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.366 | L2-Norm(final)=2.868 | 4212.7 samples/s | 65.8 steps/s
[Step=15050 Epoch=142.6] | Loss=0.00027 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=2.869 | 2037.9 samples/s | 31.8 steps/s
[Step=15100 Epoch=143.1] | Loss=0.00025 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=2.869 | 4124.4 samples/s | 64.4 steps/s
[Step=15150 Epoch=143.6] | Loss=0.00023 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.335 | L2-Norm(final)=2.870 | 2066.1 samples/s | 32.3 steps/s
[Step=15200 Epoch=144.0] | Loss=0.00022 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.324 | L2-Norm(final)=2.871 | 4084.9 samples/s | 63.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step15200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=137.0] | Loss=0.00087 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.327 | L2-Norm(final)=2.832 | 4345.4 samples/s | 67.9 steps/s
[Step=14450 Epoch=137.5] | Loss=0.00181 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=2.839 | 3825.8 samples/s | 59.8 steps/s
[Step=14500 Epoch=137.9] | Loss=0.00093 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=2.842 | 5436.0 samples/s | 84.9 steps/s
[Step=14550 Epoch=138.4] | Loss=0.00062 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=2.844 | 1793.2 samples/s | 28.0 steps/s
[Step=14600 Epoch=138.9] | Loss=0.00047 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=2.846 | 5056.4 samples/s | 79.0 steps/s
[Step=14650 Epoch=139.4] | Loss=0.00038 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.344 | L2-Norm(final)=2.847 | 1855.1 samples/s | 29.0 steps/s
[Step=14700 Epoch=139.8] | Loss=0.00032 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.334 | L2-Norm(final)=2.848 | 4716.6 samples/s | 73.7 steps/s
[Step=14750 Epoch=140.3] | Loss=0.00027 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.323 | L2-Norm(final)=2.849 | 1896.8 samples/s | 29.6 steps/s
[Step=14800 Epoch=140.8] | Loss=0.00024 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.312 | L2-Norm(final)=2.851 | 4381.6 samples/s | 68.5 steps/s
[Step=14850 Epoch=141.3] | Loss=0.00021 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.301 | L2-Norm(final)=2.851 | 1973.8 samples/s | 30.8 steps/s
[Step=14900 Epoch=141.7] | Loss=0.00019 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=2.852 | 4042.0 samples/s | 63.2 steps/s
[Step=14950 Epoch=142.2] | Loss=0.00017 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.279 | L2-Norm(final)=2.853 | 2005.7 samples/s | 31.3 steps/s
[Step=15000 Epoch=142.7] | Loss=0.00016 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.268 | L2-Norm(final)=2.854 | 4076.0 samples/s | 63.7 steps/s
[Step=15050 Epoch=143.2] | Loss=0.00015 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.257 | L2-Norm(final)=2.855 | 2057.2 samples/s | 32.1 steps/s
[Step=15100 Epoch=143.6] | Loss=0.00014 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.245 | L2-Norm(final)=2.856 | 4003.5 samples/s | 62.6 steps/s
[Step=15150 Epoch=144.1] | Loss=0.00013 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.234 | L2-Norm(final)=2.857 | 2069.4 samples/s | 32.3 steps/s
[Step=15200 Epoch=144.6] | Loss=0.00012 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.223 | L2-Norm(final)=2.857 | 3974.9 samples/s | 62.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29623 | acc=0.8491 | tpr=0.7912 | fpr=0.0250 | 3872.4 samples/s | 15.1 steps/s
Avg test loss: 0.30305, Avg test acc: 0.84614, Avg tpr: 0.78761, Avg fpr: 0.02512, total FA: 196

Testing server on iccad2012
[Step=  50] | Loss=0.39574 | acc=0.8462 | tpr=0.9292 | fpr=0.1553 | 3843.2 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.40449 | acc=0.8438 | tpr=0.9531 | fpr=0.1582 | 7194.4 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.41066 | acc=0.8446 | tpr=0.9524 | fpr=0.1574 | 7008.0 samples/s | 27.4 steps/s
[Step= 200] | Loss=0.41265 | acc=0.8449 | tpr=0.9497 | fpr=0.1570 | 7091.1 samples/s | 27.7 steps/s
[Step= 250] | Loss=0.40929 | acc=0.8449 | tpr=0.9528 | fpr=0.1571 | 7265.7 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.41241 | acc=0.8450 | tpr=0.9513 | fpr=0.1570 | 7181.0 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.41474 | acc=0.8442 | tpr=0.9518 | fpr=0.1577 | 7180.1 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.41617 | acc=0.8443 | tpr=0.9524 | fpr=0.1577 | 7044.0 samples/s | 27.5 steps/s
[Step= 450] | Loss=0.41909 | acc=0.8443 | tpr=0.9513 | fpr=0.1577 | 7067.5 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.41746 | acc=0.8444 | tpr=0.9533 | fpr=0.1575 | 6981.9 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.41520 | acc=0.8450 | tpr=0.9546 | fpr=0.1570 | 13042.1 samples/s | 50.9 steps/s
Avg test loss: 0.41456, Avg test acc: 0.84508, Avg tpr: 0.95483, Avg fpr: 0.15691, total FA: 21787

server round 19/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=74.1] | Loss=0.11385 | Reg=0.00177 | acc=0.9219 | L2-Norm=13.288 | L2-Norm(final)=2.878 | 4473.8 samples/s | 69.9 steps/s
[Step=15250 Epoch=74.4] | Loss=0.02378 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.386 | L2-Norm(final)=2.873 | 3858.1 samples/s | 60.3 steps/s
[Step=15300 Epoch=74.6] | Loss=0.01869 | Reg=0.00180 | acc=0.9844 | L2-Norm=13.427 | L2-Norm(final)=2.879 | 4232.6 samples/s | 66.1 steps/s
[Step=15350 Epoch=74.8] | Loss=0.01793 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.457 | L2-Norm(final)=2.881 | 4168.4 samples/s | 65.1 steps/s
[Step=15400 Epoch=75.1] | Loss=0.01692 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=2.881 | 5792.2 samples/s | 90.5 steps/s
[Step=15450 Epoch=75.3] | Loss=0.01519 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.495 | L2-Norm(final)=2.882 | 1863.4 samples/s | 29.1 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01427 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.509 | L2-Norm(final)=2.884 | 4216.7 samples/s | 65.9 steps/s
[Step=15550 Epoch=75.8] | Loss=0.01349 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.520 | L2-Norm(final)=2.887 | 4175.6 samples/s | 65.2 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01271 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.530 | L2-Norm(final)=2.889 | 5284.4 samples/s | 82.6 steps/s
[Step=15650 Epoch=76.3] | Loss=0.01180 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.538 | L2-Norm(final)=2.891 | 1912.6 samples/s | 29.9 steps/s
[Step=15700 Epoch=76.6] | Loss=0.01144 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.546 | L2-Norm(final)=2.893 | 4261.1 samples/s | 66.6 steps/s
[Step=15750 Epoch=76.8] | Loss=0.01076 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.553 | L2-Norm(final)=2.895 | 4211.2 samples/s | 65.8 steps/s
[Step=15800 Epoch=77.0] | Loss=0.01020 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.559 | L2-Norm(final)=2.898 | 4892.7 samples/s | 76.4 steps/s
[Step=15850 Epoch=77.3] | Loss=0.00974 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.564 | L2-Norm(final)=2.901 | 1981.0 samples/s | 31.0 steps/s
[Step=15900 Epoch=77.5] | Loss=0.00934 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.569 | L2-Norm(final)=2.903 | 4218.2 samples/s | 65.9 steps/s
[Step=15950 Epoch=77.8] | Loss=0.00887 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.573 | L2-Norm(final)=2.906 | 4257.7 samples/s | 66.5 steps/s
[Step=16000 Epoch=78.0] | Loss=0.00857 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.577 | L2-Norm(final)=2.908 | 4575.4 samples/s | 71.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step16000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=74.2] | Loss=0.11391 | Reg=0.00177 | acc=0.9219 | L2-Norm=13.288 | L2-Norm(final)=2.878 | 4485.5 samples/s | 70.1 steps/s
[Step=15250 Epoch=74.4] | Loss=0.02436 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.366 | L2-Norm(final)=2.866 | 3850.4 samples/s | 60.2 steps/s
[Step=15300 Epoch=74.7] | Loss=0.01690 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.406 | L2-Norm(final)=2.869 | 4164.4 samples/s | 65.1 steps/s
[Step=15350 Epoch=74.9] | Loss=0.01379 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.427 | L2-Norm(final)=2.878 | 4252.0 samples/s | 66.4 steps/s
[Step=15400 Epoch=75.1] | Loss=0.01314 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.443 | L2-Norm(final)=2.883 | 5786.2 samples/s | 90.4 steps/s
[Step=15450 Epoch=75.4] | Loss=0.01220 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.456 | L2-Norm(final)=2.886 | 1861.4 samples/s | 29.1 steps/s
[Step=15500 Epoch=75.6] | Loss=0.01157 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.466 | L2-Norm(final)=2.889 | 4309.6 samples/s | 67.3 steps/s
[Step=15550 Epoch=75.9] | Loss=0.01110 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.475 | L2-Norm(final)=2.890 | 4371.5 samples/s | 68.3 steps/s
[Step=15600 Epoch=76.1] | Loss=0.01055 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.484 | L2-Norm(final)=2.891 | 5391.2 samples/s | 84.2 steps/s
[Step=15650 Epoch=76.4] | Loss=0.01003 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=2.893 | 1912.7 samples/s | 29.9 steps/s
[Step=15700 Epoch=76.6] | Loss=0.00946 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.499 | L2-Norm(final)=2.895 | 4158.5 samples/s | 65.0 steps/s
[Step=15750 Epoch=76.9] | Loss=0.00901 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.505 | L2-Norm(final)=2.897 | 4157.5 samples/s | 65.0 steps/s
[Step=15800 Epoch=77.1] | Loss=0.00869 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.510 | L2-Norm(final)=2.900 | 5081.0 samples/s | 79.4 steps/s
[Step=15850 Epoch=77.3] | Loss=0.00846 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.515 | L2-Norm(final)=2.902 | 1943.4 samples/s | 30.4 steps/s
[Step=15900 Epoch=77.6] | Loss=0.00823 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.520 | L2-Norm(final)=2.905 | 4204.8 samples/s | 65.7 steps/s
[Step=15950 Epoch=77.8] | Loss=0.00801 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.525 | L2-Norm(final)=2.907 | 4206.7 samples/s | 65.7 steps/s
[Step=16000 Epoch=78.1] | Loss=0.00778 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.529 | L2-Norm(final)=2.909 | 4758.6 samples/s | 74.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step16000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=144.0] | Loss=0.05217 | Reg=0.00177 | acc=0.9531 | L2-Norm=13.288 | L2-Norm(final)=2.877 | 3919.9 samples/s | 61.2 steps/s
[Step=15250 Epoch=144.5] | Loss=0.00360 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.446 | L2-Norm(final)=2.889 | 4071.7 samples/s | 63.6 steps/s
[Step=15300 Epoch=145.0] | Loss=0.00215 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.484 | L2-Norm(final)=2.887 | 5605.3 samples/s | 87.6 steps/s
[Step=15350 Epoch=145.5] | Loss=0.00144 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.491 | L2-Norm(final)=2.887 | 1808.8 samples/s | 28.3 steps/s
[Step=15400 Epoch=145.9] | Loss=0.00108 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.489 | L2-Norm(final)=2.888 | 5157.7 samples/s | 80.6 steps/s
[Step=15450 Epoch=146.4] | Loss=0.00087 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.483 | L2-Norm(final)=2.888 | 1853.4 samples/s | 29.0 steps/s
[Step=15500 Epoch=146.9] | Loss=0.00072 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.474 | L2-Norm(final)=2.888 | 4630.9 samples/s | 72.4 steps/s
[Step=15550 Epoch=147.3] | Loss=0.00062 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.465 | L2-Norm(final)=2.888 | 1898.7 samples/s | 29.7 steps/s
[Step=15600 Epoch=147.8] | Loss=0.00054 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.455 | L2-Norm(final)=2.889 | 4291.5 samples/s | 67.1 steps/s
[Step=15650 Epoch=148.3] | Loss=0.00048 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.445 | L2-Norm(final)=2.889 | 1954.7 samples/s | 30.5 steps/s
[Step=15700 Epoch=148.8] | Loss=0.00043 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.435 | L2-Norm(final)=2.890 | 4086.1 samples/s | 63.8 steps/s
[Step=15750 Epoch=149.2] | Loss=0.00040 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.424 | L2-Norm(final)=2.890 | 2024.8 samples/s | 31.6 steps/s
[Step=15800 Epoch=149.7] | Loss=0.00036 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.414 | L2-Norm(final)=2.891 | 3996.1 samples/s | 62.4 steps/s
[Step=15850 Epoch=150.2] | Loss=0.00033 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.403 | L2-Norm(final)=2.891 | 2039.9 samples/s | 31.9 steps/s
[Step=15900 Epoch=150.7] | Loss=0.00031 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.392 | L2-Norm(final)=2.892 | 3973.4 samples/s | 62.1 steps/s
[Step=15950 Epoch=151.1] | Loss=0.00029 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.381 | L2-Norm(final)=2.893 | 2035.9 samples/s | 31.8 steps/s
[Step=16000 Epoch=151.6] | Loss=0.00027 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=2.893 | 4057.7 samples/s | 63.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step16000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=144.6] | Loss=0.08175 | Reg=0.00177 | acc=0.9688 | L2-Norm=13.288 | L2-Norm(final)=2.876 | 4314.5 samples/s | 67.4 steps/s
[Step=15250 Epoch=145.1] | Loss=0.00519 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.483 | L2-Norm(final)=2.873 | 3712.2 samples/s | 58.0 steps/s
[Step=15300 Epoch=145.5] | Loss=0.00270 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=2.880 | 5483.8 samples/s | 85.7 steps/s
[Step=15350 Epoch=146.0] | Loss=0.00180 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.531 | L2-Norm(final)=2.884 | 1798.6 samples/s | 28.1 steps/s
[Step=15400 Epoch=146.5] | Loss=0.00136 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.528 | L2-Norm(final)=2.886 | 5055.7 samples/s | 79.0 steps/s
[Step=15450 Epoch=147.0] | Loss=0.00109 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.521 | L2-Norm(final)=2.888 | 1839.7 samples/s | 28.7 steps/s
[Step=15500 Epoch=147.4] | Loss=0.00090 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.512 | L2-Norm(final)=2.889 | 4642.4 samples/s | 72.5 steps/s
[Step=15550 Epoch=147.9] | Loss=0.00078 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.502 | L2-Norm(final)=2.890 | 1905.1 samples/s | 29.8 steps/s
[Step=15600 Epoch=148.4] | Loss=0.00068 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.492 | L2-Norm(final)=2.891 | 4465.5 samples/s | 69.8 steps/s
[Step=15650 Epoch=148.9] | Loss=0.00060 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=2.892 | 1953.5 samples/s | 30.5 steps/s
[Step=15700 Epoch=149.3] | Loss=0.00054 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.470 | L2-Norm(final)=2.893 | 4231.1 samples/s | 66.1 steps/s
[Step=15750 Epoch=149.8] | Loss=0.00049 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.459 | L2-Norm(final)=2.894 | 2022.8 samples/s | 31.6 steps/s
[Step=15800 Epoch=150.3] | Loss=0.00045 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.448 | L2-Norm(final)=2.896 | 4054.5 samples/s | 63.4 steps/s
[Step=15850 Epoch=150.8] | Loss=0.00042 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.437 | L2-Norm(final)=2.897 | 2050.1 samples/s | 32.0 steps/s
[Step=15900 Epoch=151.2] | Loss=0.00039 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.426 | L2-Norm(final)=2.898 | 4154.2 samples/s | 64.9 steps/s
[Step=15950 Epoch=151.7] | Loss=0.00036 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.414 | L2-Norm(final)=2.900 | 2053.6 samples/s | 32.1 steps/s
[Step=16000 Epoch=152.2] | Loss=0.00034 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.403 | L2-Norm(final)=2.902 | 3972.7 samples/s | 62.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.64544 | acc=0.7045 | tpr=0.5771 | fpr=0.0188 | 3920.5 samples/s | 15.3 steps/s
Avg test loss: 0.65502, Avg test acc: 0.70534, Avg tpr: 0.57982, Avg fpr: 0.01859, total FA: 145

Testing server on iccad2012
[Step=  50] | Loss=0.25414 | acc=0.9305 | tpr=0.9336 | fpr=0.0695 | 3856.2 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.26107 | acc=0.9291 | tpr=0.9531 | fpr=0.0713 | 7048.7 samples/s | 27.5 steps/s
[Step= 150] | Loss=0.26949 | acc=0.9285 | tpr=0.9582 | fpr=0.0721 | 7174.1 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.27264 | acc=0.9287 | tpr=0.9552 | fpr=0.0718 | 6911.8 samples/s | 27.0 steps/s
[Step= 250] | Loss=0.26900 | acc=0.9288 | tpr=0.9563 | fpr=0.0717 | 7452.7 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.27275 | acc=0.9288 | tpr=0.9556 | fpr=0.0717 | 6926.1 samples/s | 27.1 steps/s
[Step= 350] | Loss=0.27462 | acc=0.9284 | tpr=0.9555 | fpr=0.0721 | 7105.7 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.27619 | acc=0.9284 | tpr=0.9557 | fpr=0.0721 | 7060.5 samples/s | 27.6 steps/s
[Step= 450] | Loss=0.27934 | acc=0.9278 | tpr=0.9537 | fpr=0.0726 | 7487.3 samples/s | 29.2 steps/s
[Step= 500] | Loss=0.27809 | acc=0.9278 | tpr=0.9546 | fpr=0.0727 | 6677.0 samples/s | 26.1 steps/s
[Step= 550] | Loss=0.27657 | acc=0.9280 | tpr=0.9554 | fpr=0.0725 | 13251.1 samples/s | 51.8 steps/s
Avg test loss: 0.27598, Avg test acc: 0.92807, Avg tpr: 0.95563, Avg fpr: 0.07243, total FA: 10057

server round 20/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=78.0] | Loss=0.45990 | Reg=0.00176 | acc=0.8125 | L2-Norm=13.250 | L2-Norm(final)=2.922 | 4472.6 samples/s | 69.9 steps/s
[Step=16050 Epoch=78.3] | Loss=0.04644 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.309 | L2-Norm(final)=2.901 | 3938.6 samples/s | 61.5 steps/s
[Step=16100 Epoch=78.5] | Loss=0.02881 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.331 | L2-Norm(final)=2.905 | 4271.7 samples/s | 66.7 steps/s
[Step=16150 Epoch=78.8] | Loss=0.02107 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.343 | L2-Norm(final)=2.910 | 4206.8 samples/s | 65.7 steps/s
[Step=16200 Epoch=79.0] | Loss=0.01683 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.350 | L2-Norm(final)=2.914 | 5819.5 samples/s | 90.9 steps/s
[Step=16250 Epoch=79.2] | Loss=0.01421 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.356 | L2-Norm(final)=2.918 | 1869.2 samples/s | 29.2 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01237 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.360 | L2-Norm(final)=2.922 | 4197.7 samples/s | 65.6 steps/s
[Step=16350 Epoch=79.7] | Loss=0.01128 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.363 | L2-Norm(final)=2.926 | 4137.3 samples/s | 64.6 steps/s
[Step=16400 Epoch=80.0] | Loss=0.01025 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.366 | L2-Norm(final)=2.929 | 5224.4 samples/s | 81.6 steps/s
[Step=16450 Epoch=80.2] | Loss=0.00940 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=2.933 | 1922.5 samples/s | 30.0 steps/s
[Step=16500 Epoch=80.5] | Loss=0.00866 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.369 | L2-Norm(final)=2.936 | 4118.1 samples/s | 64.3 steps/s
[Step=16550 Epoch=80.7] | Loss=0.00817 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.371 | L2-Norm(final)=2.938 | 4201.3 samples/s | 65.6 steps/s
[Step=16600 Epoch=80.9] | Loss=0.00771 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.372 | L2-Norm(final)=2.941 | 4765.1 samples/s | 74.5 steps/s
[Step=16650 Epoch=81.2] | Loss=0.00734 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=2.944 | 1961.7 samples/s | 30.7 steps/s
[Step=16700 Epoch=81.4] | Loss=0.00701 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.374 | L2-Norm(final)=2.946 | 4179.1 samples/s | 65.3 steps/s
[Step=16750 Epoch=81.7] | Loss=0.00682 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=2.948 | 4192.6 samples/s | 65.5 steps/s
[Step=16800 Epoch=81.9] | Loss=0.00655 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.376 | L2-Norm(final)=2.951 | 4574.3 samples/s | 71.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step16800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=78.1] | Loss=0.33942 | Reg=0.00176 | acc=0.7969 | L2-Norm=13.250 | L2-Norm(final)=2.923 | 4298.1 samples/s | 67.2 steps/s
[Step=16050 Epoch=78.3] | Loss=0.04999 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.317 | L2-Norm(final)=2.902 | 3916.3 samples/s | 61.2 steps/s
[Step=16100 Epoch=78.6] | Loss=0.02924 | Reg=0.00178 | acc=0.9844 | L2-Norm=13.342 | L2-Norm(final)=2.906 | 4139.9 samples/s | 64.7 steps/s
[Step=16150 Epoch=78.8] | Loss=0.02184 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.354 | L2-Norm(final)=2.910 | 4182.6 samples/s | 65.4 steps/s
[Step=16200 Epoch=79.0] | Loss=0.01802 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.362 | L2-Norm(final)=2.915 | 5694.8 samples/s | 89.0 steps/s
[Step=16250 Epoch=79.3] | Loss=0.01521 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.368 | L2-Norm(final)=2.919 | 1840.7 samples/s | 28.8 steps/s
[Step=16300 Epoch=79.5] | Loss=0.01328 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.372 | L2-Norm(final)=2.922 | 4119.6 samples/s | 64.4 steps/s
[Step=16350 Epoch=79.8] | Loss=0.01180 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.376 | L2-Norm(final)=2.926 | 4091.6 samples/s | 63.9 steps/s
[Step=16400 Epoch=80.0] | Loss=0.01070 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.379 | L2-Norm(final)=2.929 | 5387.0 samples/s | 84.2 steps/s
[Step=16450 Epoch=80.3] | Loss=0.00973 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.382 | L2-Norm(final)=2.932 | 1897.7 samples/s | 29.7 steps/s
[Step=16500 Epoch=80.5] | Loss=0.00913 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.384 | L2-Norm(final)=2.935 | 4220.2 samples/s | 65.9 steps/s
[Step=16550 Epoch=80.8] | Loss=0.00850 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.385 | L2-Norm(final)=2.938 | 4138.0 samples/s | 64.7 steps/s
[Step=16600 Epoch=81.0] | Loss=0.00809 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.387 | L2-Norm(final)=2.940 | 5074.3 samples/s | 79.3 steps/s
[Step=16650 Epoch=81.2] | Loss=0.00766 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.388 | L2-Norm(final)=2.942 | 1926.4 samples/s | 30.1 steps/s
[Step=16700 Epoch=81.5] | Loss=0.00731 | Reg=0.00179 | acc=0.9844 | L2-Norm=13.389 | L2-Norm(final)=2.945 | 4127.4 samples/s | 64.5 steps/s
[Step=16750 Epoch=81.7] | Loss=0.00706 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.390 | L2-Norm(final)=2.947 | 4193.4 samples/s | 65.5 steps/s
[Step=16800 Epoch=82.0] | Loss=0.00674 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.391 | L2-Norm(final)=2.949 | 4782.1 samples/s | 74.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step16800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=151.6] | Loss=0.00302 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.250 | L2-Norm(final)=2.924 | 4357.2 samples/s | 68.1 steps/s
[Step=16050 Epoch=152.1] | Loss=0.00317 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.274 | L2-Norm(final)=2.925 | 3861.3 samples/s | 60.3 steps/s
[Step=16100 Epoch=152.6] | Loss=0.00160 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.275 | L2-Norm(final)=2.926 | 5638.3 samples/s | 88.1 steps/s
[Step=16150 Epoch=153.0] | Loss=0.00107 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.271 | L2-Norm(final)=2.928 | 1811.4 samples/s | 28.3 steps/s
[Step=16200 Epoch=153.5] | Loss=0.00081 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.267 | L2-Norm(final)=2.929 | 5021.4 samples/s | 78.5 steps/s
[Step=16250 Epoch=154.0] | Loss=0.00065 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.262 | L2-Norm(final)=2.929 | 1839.9 samples/s | 28.7 steps/s
[Step=16300 Epoch=154.5] | Loss=0.00054 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.256 | L2-Norm(final)=2.930 | 4704.3 samples/s | 73.5 steps/s
[Step=16350 Epoch=154.9] | Loss=0.00047 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.251 | L2-Norm(final)=2.931 | 1928.0 samples/s | 30.1 steps/s
[Step=16400 Epoch=155.4] | Loss=0.00041 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.245 | L2-Norm(final)=2.932 | 4351.9 samples/s | 68.0 steps/s
[Step=16450 Epoch=155.9] | Loss=0.00037 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.239 | L2-Norm(final)=2.933 | 1977.6 samples/s | 30.9 steps/s
[Step=16500 Epoch=156.4] | Loss=0.00033 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.233 | L2-Norm(final)=2.933 | 4106.7 samples/s | 64.2 steps/s
[Step=16550 Epoch=156.8] | Loss=0.00030 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.228 | L2-Norm(final)=2.934 | 2028.4 samples/s | 31.7 steps/s
[Step=16600 Epoch=157.3] | Loss=0.00028 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.222 | L2-Norm(final)=2.935 | 4125.3 samples/s | 64.5 steps/s
[Step=16650 Epoch=157.8] | Loss=0.00026 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.216 | L2-Norm(final)=2.935 | 2072.3 samples/s | 32.4 steps/s
[Step=16700 Epoch=158.2] | Loss=0.00024 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.210 | L2-Norm(final)=2.936 | 4014.9 samples/s | 62.7 steps/s
[Step=16750 Epoch=158.7] | Loss=0.00022 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.203 | L2-Norm(final)=2.937 | 2054.4 samples/s | 32.1 steps/s
[Step=16800 Epoch=159.2] | Loss=0.00021 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.197 | L2-Norm(final)=2.938 | 4058.0 samples/s | 63.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step16800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=152.2] | Loss=0.01161 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.250 | L2-Norm(final)=2.924 | 4209.3 samples/s | 65.8 steps/s
[Step=16050 Epoch=152.7] | Loss=0.00146 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.274 | L2-Norm(final)=2.931 | 3905.6 samples/s | 61.0 steps/s
[Step=16100 Epoch=153.2] | Loss=0.00078 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.276 | L2-Norm(final)=2.934 | 5604.9 samples/s | 87.6 steps/s
[Step=16150 Epoch=153.6] | Loss=0.00053 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.273 | L2-Norm(final)=2.936 | 1821.9 samples/s | 28.5 steps/s
[Step=16200 Epoch=154.1] | Loss=0.00040 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.268 | L2-Norm(final)=2.937 | 5107.4 samples/s | 79.8 steps/s
[Step=16250 Epoch=154.6] | Loss=0.00032 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.263 | L2-Norm(final)=2.938 | 1860.0 samples/s | 29.1 steps/s
[Step=16300 Epoch=155.1] | Loss=0.00027 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.258 | L2-Norm(final)=2.939 | 4813.5 samples/s | 75.2 steps/s
[Step=16350 Epoch=155.5] | Loss=0.00023 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.252 | L2-Norm(final)=2.940 | 1935.7 samples/s | 30.2 steps/s
[Step=16400 Epoch=156.0] | Loss=0.00020 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.246 | L2-Norm(final)=2.941 | 4403.8 samples/s | 68.8 steps/s
[Step=16450 Epoch=156.5] | Loss=0.00018 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.240 | L2-Norm(final)=2.941 | 1944.4 samples/s | 30.4 steps/s
[Step=16500 Epoch=157.0] | Loss=0.00017 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.234 | L2-Norm(final)=2.942 | 4006.2 samples/s | 62.6 steps/s
[Step=16550 Epoch=157.4] | Loss=0.00015 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.228 | L2-Norm(final)=2.942 | 2036.0 samples/s | 31.8 steps/s
[Step=16600 Epoch=157.9] | Loss=0.00014 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.222 | L2-Norm(final)=2.943 | 4122.2 samples/s | 64.4 steps/s
[Step=16650 Epoch=158.4] | Loss=0.00013 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.216 | L2-Norm(final)=2.943 | 2031.7 samples/s | 31.7 steps/s
[Step=16700 Epoch=158.9] | Loss=0.00012 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.210 | L2-Norm(final)=2.944 | 4059.0 samples/s | 63.4 steps/s
[Step=16750 Epoch=159.3] | Loss=0.00011 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.203 | L2-Norm(final)=2.944 | 2057.4 samples/s | 32.1 steps/s
[Step=16800 Epoch=159.8] | Loss=0.00011 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.197 | L2-Norm(final)=2.945 | 4036.4 samples/s | 63.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35636 | acc=0.8355 | tpr=0.7700 | fpr=0.0221 | 3911.5 samples/s | 15.3 steps/s
Avg test loss: 0.36479, Avg test acc: 0.83316, Avg tpr: 0.76756, Avg fpr: 0.02256, total FA: 176

Testing server on iccad2012
[Step=  50] | Loss=0.34642 | acc=0.8904 | tpr=0.9292 | fpr=0.1103 | 3991.2 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.35677 | acc=0.8877 | tpr=0.9531 | fpr=0.1135 | 7110.5 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.36455 | acc=0.8872 | tpr=0.9568 | fpr=0.1141 | 6840.7 samples/s | 26.7 steps/s
[Step= 200] | Loss=0.36666 | acc=0.8875 | tpr=0.9530 | fpr=0.1137 | 7153.2 samples/s | 27.9 steps/s
[Step= 250] | Loss=0.36387 | acc=0.8879 | tpr=0.9537 | fpr=0.1133 | 7010.3 samples/s | 27.4 steps/s
[Step= 300] | Loss=0.36782 | acc=0.8876 | tpr=0.9535 | fpr=0.1136 | 7482.9 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.36998 | acc=0.8874 | tpr=0.9524 | fpr=0.1137 | 6872.2 samples/s | 26.8 steps/s
[Step= 400] | Loss=0.37144 | acc=0.8875 | tpr=0.9519 | fpr=0.1136 | 7146.1 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.37436 | acc=0.8872 | tpr=0.9503 | fpr=0.1140 | 6833.4 samples/s | 26.7 steps/s
[Step= 500] | Loss=0.37263 | acc=0.8873 | tpr=0.9515 | fpr=0.1139 | 7218.8 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.37070 | acc=0.8880 | tpr=0.9522 | fpr=0.1131 | 12987.8 samples/s | 50.7 steps/s
Avg test loss: 0.37007, Avg test acc: 0.88806, Avg tpr: 0.95246, Avg fpr: 0.11311, total FA: 15705

server round 21/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=81.9] | Loss=0.12652 | Reg=0.00174 | acc=0.9375 | L2-Norm=13.196 | L2-Norm(final)=2.964 | 4502.4 samples/s | 70.3 steps/s
[Step=16850 Epoch=82.2] | Loss=0.02314 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.243 | L2-Norm(final)=2.956 | 3776.6 samples/s | 59.0 steps/s
[Step=16900 Epoch=82.4] | Loss=0.01639 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.258 | L2-Norm(final)=2.956 | 4236.8 samples/s | 66.2 steps/s
[Step=16950 Epoch=82.7] | Loss=0.01253 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.264 | L2-Norm(final)=2.958 | 4231.1 samples/s | 66.1 steps/s
[Step=17000 Epoch=82.9] | Loss=0.01038 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.269 | L2-Norm(final)=2.961 | 5764.6 samples/s | 90.1 steps/s
[Step=17050 Epoch=83.1] | Loss=0.00902 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.273 | L2-Norm(final)=2.964 | 1875.5 samples/s | 29.3 steps/s
[Step=17100 Epoch=83.4] | Loss=0.00809 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.276 | L2-Norm(final)=2.967 | 4312.4 samples/s | 67.4 steps/s
[Step=17150 Epoch=83.6] | Loss=0.00733 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.278 | L2-Norm(final)=2.970 | 4257.0 samples/s | 66.5 steps/s
[Step=17200 Epoch=83.9] | Loss=0.00684 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.280 | L2-Norm(final)=2.973 | 5314.6 samples/s | 83.0 steps/s
[Step=17250 Epoch=84.1] | Loss=0.00645 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.282 | L2-Norm(final)=2.975 | 1924.1 samples/s | 30.1 steps/s
[Step=17300 Epoch=84.4] | Loss=0.00609 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.284 | L2-Norm(final)=2.978 | 4181.7 samples/s | 65.3 steps/s
[Step=17350 Epoch=84.6] | Loss=0.00580 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.285 | L2-Norm(final)=2.980 | 4199.8 samples/s | 65.6 steps/s
[Step=17400 Epoch=84.8] | Loss=0.00553 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.286 | L2-Norm(final)=2.982 | 4953.9 samples/s | 77.4 steps/s
[Step=17450 Epoch=85.1] | Loss=0.00526 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.288 | L2-Norm(final)=2.984 | 1955.1 samples/s | 30.5 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00500 | Reg=0.00177 | acc=0.9844 | L2-Norm=13.289 | L2-Norm(final)=2.987 | 4256.1 samples/s | 66.5 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00487 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.289 | L2-Norm(final)=2.988 | 4224.5 samples/s | 66.0 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00480 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=2.990 | 4553.1 samples/s | 71.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step17600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=82.0] | Loss=0.07821 | Reg=0.00174 | acc=0.9531 | L2-Norm=13.196 | L2-Norm(final)=2.964 | 4162.9 samples/s | 65.0 steps/s
[Step=16850 Epoch=82.2] | Loss=0.02179 | Reg=0.00175 | acc=0.9688 | L2-Norm=13.243 | L2-Norm(final)=2.959 | 4238.6 samples/s | 66.2 steps/s
[Step=16900 Epoch=82.5] | Loss=0.01456 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.259 | L2-Norm(final)=2.961 | 4326.0 samples/s | 67.6 steps/s
[Step=16950 Epoch=82.7] | Loss=0.01153 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.269 | L2-Norm(final)=2.966 | 4341.0 samples/s | 67.8 steps/s
[Step=17000 Epoch=83.0] | Loss=0.00992 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.276 | L2-Norm(final)=2.970 | 5683.6 samples/s | 88.8 steps/s
[Step=17050 Epoch=83.2] | Loss=0.00847 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.281 | L2-Norm(final)=2.974 | 1867.3 samples/s | 29.2 steps/s
[Step=17100 Epoch=83.4] | Loss=0.00779 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.285 | L2-Norm(final)=2.977 | 4232.7 samples/s | 66.1 steps/s
[Step=17150 Epoch=83.7] | Loss=0.00710 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.287 | L2-Norm(final)=2.980 | 4161.6 samples/s | 65.0 steps/s
[Step=17200 Epoch=83.9] | Loss=0.00662 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.290 | L2-Norm(final)=2.982 | 5378.3 samples/s | 84.0 steps/s
[Step=17250 Epoch=84.2] | Loss=0.00613 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.292 | L2-Norm(final)=2.985 | 1931.0 samples/s | 30.2 steps/s
[Step=17300 Epoch=84.4] | Loss=0.00579 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.294 | L2-Norm(final)=2.988 | 4330.9 samples/s | 67.7 steps/s
[Step=17350 Epoch=84.7] | Loss=0.00544 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.295 | L2-Norm(final)=2.990 | 4345.5 samples/s | 67.9 steps/s
[Step=17400 Epoch=84.9] | Loss=0.00532 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.297 | L2-Norm(final)=2.992 | 5074.8 samples/s | 79.3 steps/s
[Step=17450 Epoch=85.1] | Loss=0.00505 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.298 | L2-Norm(final)=2.995 | 1927.7 samples/s | 30.1 steps/s
[Step=17500 Epoch=85.4] | Loss=0.00481 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.299 | L2-Norm(final)=2.997 | 4211.0 samples/s | 65.8 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00475 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.300 | L2-Norm(final)=2.999 | 4209.7 samples/s | 65.8 steps/s
[Step=17600 Epoch=85.9] | Loss=0.00463 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.301 | L2-Norm(final)=3.001 | 4749.3 samples/s | 74.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step17600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=159.2] | Loss=0.03284 | Reg=0.00174 | acc=0.9688 | L2-Norm=13.196 | L2-Norm(final)=2.965 | 4166.7 samples/s | 65.1 steps/s
[Step=16850 Epoch=159.7] | Loss=0.00262 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.242 | L2-Norm(final)=2.972 | 3940.6 samples/s | 61.6 steps/s
[Step=16900 Epoch=160.1] | Loss=0.00133 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.248 | L2-Norm(final)=2.974 | 5561.1 samples/s | 86.9 steps/s
[Step=16950 Epoch=160.6] | Loss=0.00089 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.246 | L2-Norm(final)=2.975 | 1841.9 samples/s | 28.8 steps/s
[Step=17000 Epoch=161.1] | Loss=0.00067 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.242 | L2-Norm(final)=2.976 | 5289.4 samples/s | 82.6 steps/s
[Step=17050 Epoch=161.6] | Loss=0.00054 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.237 | L2-Norm(final)=2.977 | 1855.0 samples/s | 29.0 steps/s
[Step=17100 Epoch=162.0] | Loss=0.00045 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.231 | L2-Norm(final)=2.978 | 4684.1 samples/s | 73.2 steps/s
[Step=17150 Epoch=162.5] | Loss=0.00039 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.225 | L2-Norm(final)=2.978 | 1907.5 samples/s | 29.8 steps/s
[Step=17200 Epoch=163.0] | Loss=0.00034 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.219 | L2-Norm(final)=2.979 | 4381.0 samples/s | 68.5 steps/s
[Step=17250 Epoch=163.5] | Loss=0.00030 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.213 | L2-Norm(final)=2.980 | 1964.9 samples/s | 30.7 steps/s
[Step=17300 Epoch=163.9] | Loss=0.00027 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.207 | L2-Norm(final)=2.980 | 4027.6 samples/s | 62.9 steps/s
[Step=17350 Epoch=164.4] | Loss=0.00025 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.201 | L2-Norm(final)=2.981 | 2026.0 samples/s | 31.7 steps/s
[Step=17400 Epoch=164.9] | Loss=0.00023 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.195 | L2-Norm(final)=2.981 | 4097.3 samples/s | 64.0 steps/s
[Step=17450 Epoch=165.4] | Loss=0.00021 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.189 | L2-Norm(final)=2.982 | 2061.3 samples/s | 32.2 steps/s
[Step=17500 Epoch=165.8] | Loss=0.00020 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.182 | L2-Norm(final)=2.982 | 3975.9 samples/s | 62.1 steps/s
[Step=17550 Epoch=166.3] | Loss=0.00018 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.176 | L2-Norm(final)=2.982 | 2071.4 samples/s | 32.4 steps/s
[Step=17600 Epoch=166.8] | Loss=0.00017 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.169 | L2-Norm(final)=2.983 | 4018.1 samples/s | 62.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step17600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=159.8] | Loss=0.04509 | Reg=0.00174 | acc=0.9375 | L2-Norm=13.196 | L2-Norm(final)=2.964 | 4236.5 samples/s | 66.2 steps/s
[Step=16850 Epoch=160.3] | Loss=0.00358 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.248 | L2-Norm(final)=2.967 | 3768.0 samples/s | 58.9 steps/s
[Step=16900 Epoch=160.8] | Loss=0.00187 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.258 | L2-Norm(final)=2.971 | 5628.3 samples/s | 87.9 steps/s
[Step=16950 Epoch=161.2] | Loss=0.00125 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.258 | L2-Norm(final)=2.974 | 1811.7 samples/s | 28.3 steps/s
[Step=17000 Epoch=161.7] | Loss=0.00095 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.255 | L2-Norm(final)=2.976 | 5132.1 samples/s | 80.2 steps/s
[Step=17050 Epoch=162.2] | Loss=0.00076 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.251 | L2-Norm(final)=2.977 | 1860.6 samples/s | 29.1 steps/s
[Step=17100 Epoch=162.7] | Loss=0.00064 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.247 | L2-Norm(final)=2.979 | 4694.0 samples/s | 73.3 steps/s
[Step=17150 Epoch=163.1] | Loss=0.00055 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.243 | L2-Norm(final)=2.981 | 1924.6 samples/s | 30.1 steps/s
[Step=17200 Epoch=163.6] | Loss=0.00048 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.238 | L2-Norm(final)=2.983 | 4389.5 samples/s | 68.6 steps/s
[Step=17250 Epoch=164.1] | Loss=0.00043 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.233 | L2-Norm(final)=2.984 | 1974.4 samples/s | 30.9 steps/s
[Step=17300 Epoch=164.6] | Loss=0.00038 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.228 | L2-Norm(final)=2.986 | 4146.1 samples/s | 64.8 steps/s
[Step=17350 Epoch=165.0] | Loss=0.00035 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.222 | L2-Norm(final)=2.988 | 2023.1 samples/s | 31.6 steps/s
[Step=17400 Epoch=165.5] | Loss=0.00032 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.217 | L2-Norm(final)=2.989 | 4073.7 samples/s | 63.7 steps/s
[Step=17450 Epoch=166.0] | Loss=0.00030 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.211 | L2-Norm(final)=2.991 | 2045.8 samples/s | 32.0 steps/s
[Step=17500 Epoch=166.5] | Loss=0.00028 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.206 | L2-Norm(final)=2.992 | 4115.2 samples/s | 64.3 steps/s
[Step=17550 Epoch=166.9] | Loss=0.00026 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.200 | L2-Norm(final)=2.994 | 2088.1 samples/s | 32.6 steps/s
[Step=17600 Epoch=167.4] | Loss=0.00024 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.194 | L2-Norm(final)=2.995 | 4075.5 samples/s | 63.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.44972 | acc=0.8017 | tpr=0.7191 | fpr=0.0188 | 3898.4 samples/s | 15.2 steps/s
Avg test loss: 0.45913, Avg test acc: 0.80095, Avg tpr: 0.71901, Avg fpr: 0.01884, total FA: 147

Testing server on iccad2012
[Step=  50] | Loss=0.29593 | acc=0.9141 | tpr=0.9292 | fpr=0.0861 | 3866.1 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.30632 | acc=0.9110 | tpr=0.9531 | fpr=0.0898 | 7218.0 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.31463 | acc=0.9106 | tpr=0.9553 | fpr=0.0902 | 7130.9 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.31713 | acc=0.9112 | tpr=0.9508 | fpr=0.0895 | 7183.9 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.31455 | acc=0.9114 | tpr=0.9520 | fpr=0.0893 | 7115.3 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.31873 | acc=0.9115 | tpr=0.9498 | fpr=0.0892 | 7189.1 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.32123 | acc=0.9112 | tpr=0.9487 | fpr=0.0894 | 7137.3 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.32303 | acc=0.9112 | tpr=0.9480 | fpr=0.0895 | 4381.8 samples/s | 17.1 steps/s
[Step= 450] | Loss=0.32598 | acc=0.9109 | tpr=0.9450 | fpr=0.0897 | 7088.5 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.32439 | acc=0.9110 | tpr=0.9467 | fpr=0.0897 | 7172.5 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.32228 | acc=0.9114 | tpr=0.9483 | fpr=0.0893 | 13660.1 samples/s | 53.4 steps/s
Avg test loss: 0.32165, Avg test acc: 0.91148, Avg tpr: 0.94849, Avg fpr: 0.08919, total FA: 12384

server round 22/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=85.8] | Loss=0.15878 | Reg=0.00173 | acc=0.9062 | L2-Norm=13.140 | L2-Norm(final)=3.009 | 4204.5 samples/s | 65.7 steps/s
[Step=17650 Epoch=86.1] | Loss=0.02490 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.204 | L2-Norm(final)=2.999 | 4149.3 samples/s | 64.8 steps/s
[Step=17700 Epoch=86.3] | Loss=0.01515 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.222 | L2-Norm(final)=3.000 | 4112.4 samples/s | 64.3 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01177 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.231 | L2-Norm(final)=3.003 | 4180.7 samples/s | 65.3 steps/s
[Step=17800 Epoch=86.8] | Loss=0.00982 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.238 | L2-Norm(final)=3.008 | 5677.7 samples/s | 88.7 steps/s
[Step=17850 Epoch=87.0] | Loss=0.00869 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.243 | L2-Norm(final)=3.012 | 1863.5 samples/s | 29.1 steps/s
[Step=17900 Epoch=87.3] | Loss=0.00778 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.247 | L2-Norm(final)=3.015 | 4192.1 samples/s | 65.5 steps/s
[Step=17950 Epoch=87.5] | Loss=0.00712 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.250 | L2-Norm(final)=3.018 | 4281.4 samples/s | 66.9 steps/s
[Step=18000 Epoch=87.8] | Loss=0.00659 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.253 | L2-Norm(final)=3.021 | 5368.0 samples/s | 83.9 steps/s
[Step=18050 Epoch=88.0] | Loss=0.00628 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.255 | L2-Norm(final)=3.023 | 1926.3 samples/s | 30.1 steps/s
[Step=18100 Epoch=88.3] | Loss=0.00592 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.256 | L2-Norm(final)=3.025 | 4223.8 samples/s | 66.0 steps/s
[Step=18150 Epoch=88.5] | Loss=0.00565 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.258 | L2-Norm(final)=3.028 | 4277.1 samples/s | 66.8 steps/s
[Step=18200 Epoch=88.7] | Loss=0.00541 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.259 | L2-Norm(final)=3.030 | 4954.4 samples/s | 77.4 steps/s
[Step=18250 Epoch=89.0] | Loss=0.00521 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.260 | L2-Norm(final)=3.032 | 1964.7 samples/s | 30.7 steps/s
[Step=18300 Epoch=89.2] | Loss=0.00498 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.261 | L2-Norm(final)=3.034 | 4280.1 samples/s | 66.9 steps/s
[Step=18350 Epoch=89.5] | Loss=0.00485 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.262 | L2-Norm(final)=3.036 | 4174.5 samples/s | 65.2 steps/s
[Step=18400 Epoch=89.7] | Loss=0.00473 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.263 | L2-Norm(final)=3.037 | 4639.9 samples/s | 72.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step18400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=85.9] | Loss=0.37083 | Reg=0.00173 | acc=0.8750 | L2-Norm=13.140 | L2-Norm(final)=3.008 | 4146.0 samples/s | 64.8 steps/s
[Step=17650 Epoch=86.1] | Loss=0.03250 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.204 | L2-Norm(final)=2.993 | 4282.2 samples/s | 66.9 steps/s
[Step=17700 Epoch=86.4] | Loss=0.01943 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.224 | L2-Norm(final)=2.992 | 4200.1 samples/s | 65.6 steps/s
[Step=17750 Epoch=86.6] | Loss=0.01459 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.234 | L2-Norm(final)=2.996 | 4284.5 samples/s | 66.9 steps/s
[Step=17800 Epoch=86.9] | Loss=0.01217 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=3.000 | 5781.3 samples/s | 90.3 steps/s
[Step=17850 Epoch=87.1] | Loss=0.01056 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.247 | L2-Norm(final)=3.003 | 1843.1 samples/s | 28.8 steps/s
[Step=17900 Epoch=87.3] | Loss=0.00939 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.251 | L2-Norm(final)=3.006 | 4219.1 samples/s | 65.9 steps/s
[Step=17950 Epoch=87.6] | Loss=0.00830 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.254 | L2-Norm(final)=3.008 | 4239.7 samples/s | 66.2 steps/s
[Step=18000 Epoch=87.8] | Loss=0.00794 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.256 | L2-Norm(final)=3.011 | 5379.3 samples/s | 84.1 steps/s
[Step=18050 Epoch=88.1] | Loss=0.00728 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.258 | L2-Norm(final)=3.013 | 1889.1 samples/s | 29.5 steps/s
[Step=18100 Epoch=88.3] | Loss=0.00678 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.260 | L2-Norm(final)=3.015 | 4248.3 samples/s | 66.4 steps/s
[Step=18150 Epoch=88.6] | Loss=0.00639 | Reg=0.00176 | acc=0.9844 | L2-Norm=13.262 | L2-Norm(final)=3.017 | 4186.3 samples/s | 65.4 steps/s
[Step=18200 Epoch=88.8] | Loss=0.00615 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.264 | L2-Norm(final)=3.020 | 5048.4 samples/s | 78.9 steps/s
[Step=18250 Epoch=89.1] | Loss=0.00590 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.265 | L2-Norm(final)=3.022 | 1930.6 samples/s | 30.2 steps/s
[Step=18300 Epoch=89.3] | Loss=0.00571 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.266 | L2-Norm(final)=3.024 | 4237.6 samples/s | 66.2 steps/s
[Step=18350 Epoch=89.5] | Loss=0.00545 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.267 | L2-Norm(final)=3.026 | 4169.4 samples/s | 65.1 steps/s
[Step=18400 Epoch=89.8] | Loss=0.00530 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.268 | L2-Norm(final)=3.028 | 4892.5 samples/s | 76.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step18400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=166.8] | Loss=0.02904 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.140 | L2-Norm(final)=3.010 | 4073.2 samples/s | 63.6 steps/s
[Step=17650 Epoch=167.2] | Loss=0.00379 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.208 | L2-Norm(final)=3.012 | 3942.3 samples/s | 61.6 steps/s
[Step=17700 Epoch=167.7] | Loss=0.00195 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.221 | L2-Norm(final)=3.013 | 5307.7 samples/s | 82.9 steps/s
[Step=17750 Epoch=168.2] | Loss=0.00130 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.222 | L2-Norm(final)=3.015 | 1797.3 samples/s | 28.1 steps/s
[Step=17800 Epoch=168.7] | Loss=0.00098 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.220 | L2-Norm(final)=3.016 | 5192.9 samples/s | 81.1 steps/s
[Step=17850 Epoch=169.1] | Loss=0.00079 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.216 | L2-Norm(final)=3.016 | 1866.4 samples/s | 29.2 steps/s
[Step=17900 Epoch=169.6] | Loss=0.00066 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.212 | L2-Norm(final)=3.017 | 4744.3 samples/s | 74.1 steps/s
[Step=17950 Epoch=170.1] | Loss=0.00056 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.207 | L2-Norm(final)=3.018 | 1915.6 samples/s | 29.9 steps/s
[Step=18000 Epoch=170.6] | Loss=0.00049 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.202 | L2-Norm(final)=3.018 | 4380.5 samples/s | 68.4 steps/s
[Step=18050 Epoch=171.0] | Loss=0.00044 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.197 | L2-Norm(final)=3.019 | 1959.5 samples/s | 30.6 steps/s
[Step=18100 Epoch=171.5] | Loss=0.00040 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.192 | L2-Norm(final)=3.019 | 4126.6 samples/s | 64.5 steps/s
[Step=18150 Epoch=172.0] | Loss=0.00036 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.186 | L2-Norm(final)=3.019 | 2013.0 samples/s | 31.5 steps/s
[Step=18200 Epoch=172.5] | Loss=0.00033 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.181 | L2-Norm(final)=3.020 | 4079.7 samples/s | 63.7 steps/s
[Step=18250 Epoch=172.9] | Loss=0.00031 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.175 | L2-Norm(final)=3.020 | 2047.7 samples/s | 32.0 steps/s
[Step=18300 Epoch=173.4] | Loss=0.00028 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.169 | L2-Norm(final)=3.021 | 4038.7 samples/s | 63.1 steps/s
[Step=18350 Epoch=173.9] | Loss=0.00027 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.164 | L2-Norm(final)=3.021 | 2066.5 samples/s | 32.3 steps/s
[Step=18400 Epoch=174.4] | Loss=0.00025 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.158 | L2-Norm(final)=3.021 | 4089.8 samples/s | 63.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step18400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=167.4] | Loss=0.05711 | Reg=0.00173 | acc=0.9531 | L2-Norm=13.140 | L2-Norm(final)=3.009 | 4645.6 samples/s | 72.6 steps/s
[Step=17650 Epoch=167.9] | Loss=0.00337 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.192 | L2-Norm(final)=3.011 | 3658.1 samples/s | 57.2 steps/s
[Step=17700 Epoch=168.4] | Loss=0.00172 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.199 | L2-Norm(final)=3.012 | 5642.6 samples/s | 88.2 steps/s
[Step=17750 Epoch=168.8] | Loss=0.00115 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.198 | L2-Norm(final)=3.014 | 1820.0 samples/s | 28.4 steps/s
[Step=17800 Epoch=169.3] | Loss=0.00087 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.196 | L2-Norm(final)=3.015 | 4974.7 samples/s | 77.7 steps/s
[Step=17850 Epoch=169.8] | Loss=0.00070 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.192 | L2-Norm(final)=3.016 | 1843.3 samples/s | 28.8 steps/s
[Step=17900 Epoch=170.3] | Loss=0.00058 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.188 | L2-Norm(final)=3.017 | 4678.7 samples/s | 73.1 steps/s
[Step=17950 Epoch=170.7] | Loss=0.00050 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.183 | L2-Norm(final)=3.017 | 1917.6 samples/s | 30.0 steps/s
[Step=18000 Epoch=171.2] | Loss=0.00044 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.179 | L2-Norm(final)=3.018 | 4422.2 samples/s | 69.1 steps/s
[Step=18050 Epoch=171.7] | Loss=0.00039 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.174 | L2-Norm(final)=3.019 | 1973.6 samples/s | 30.8 steps/s
[Step=18100 Epoch=172.2] | Loss=0.00035 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.169 | L2-Norm(final)=3.020 | 3949.5 samples/s | 61.7 steps/s
[Step=18150 Epoch=172.7] | Loss=0.00032 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.164 | L2-Norm(final)=3.021 | 2026.3 samples/s | 31.7 steps/s
[Step=18200 Epoch=173.1] | Loss=0.00030 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.159 | L2-Norm(final)=3.022 | 4037.6 samples/s | 63.1 steps/s
[Step=18250 Epoch=173.6] | Loss=0.00027 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.154 | L2-Norm(final)=3.023 | 2055.7 samples/s | 32.1 steps/s
[Step=18300 Epoch=174.1] | Loss=0.00026 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.149 | L2-Norm(final)=3.024 | 4090.8 samples/s | 63.9 steps/s
[Step=18350 Epoch=174.6] | Loss=0.00024 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.144 | L2-Norm(final)=3.025 | 2057.4 samples/s | 32.1 steps/s
[Step=18400 Epoch=175.0] | Loss=0.00022 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.138 | L2-Norm(final)=3.026 | 3959.7 samples/s | 61.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.44505 | acc=0.7995 | tpr=0.7154 | fpr=0.0178 | 2979.2 samples/s | 11.6 steps/s
Avg test loss: 0.45580, Avg test acc: 0.79874, Avg tpr: 0.71557, Avg fpr: 0.01833, total FA: 143

Testing server on iccad2012
[Step=  50] | Loss=0.28040 | acc=0.9178 | tpr=0.9248 | fpr=0.0823 | 3921.9 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.28887 | acc=0.9154 | tpr=0.9446 | fpr=0.0851 | 7179.9 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.29680 | acc=0.9145 | tpr=0.9481 | fpr=0.0861 | 7032.6 samples/s | 27.5 steps/s
[Step= 200] | Loss=0.29896 | acc=0.9151 | tpr=0.9464 | fpr=0.0855 | 7173.1 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.29614 | acc=0.9158 | tpr=0.9485 | fpr=0.0848 | 7068.9 samples/s | 27.6 steps/s
[Step= 300] | Loss=0.29979 | acc=0.9157 | tpr=0.9476 | fpr=0.0848 | 7078.1 samples/s | 27.6 steps/s
[Step= 350] | Loss=0.30216 | acc=0.9154 | tpr=0.9468 | fpr=0.0852 | 7207.9 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.30375 | acc=0.9155 | tpr=0.9469 | fpr=0.0851 | 7245.6 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.30688 | acc=0.9151 | tpr=0.9445 | fpr=0.0854 | 6871.9 samples/s | 26.8 steps/s
[Step= 500] | Loss=0.30531 | acc=0.9153 | tpr=0.9463 | fpr=0.0853 | 7286.3 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.30324 | acc=0.9160 | tpr=0.9471 | fpr=0.0846 | 12983.1 samples/s | 50.7 steps/s
Avg test loss: 0.30262, Avg test acc: 0.91602, Avg tpr: 0.94731, Avg fpr: 0.08455, total FA: 11740

server round 23/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=89.7] | Loss=0.20842 | Reg=0.00172 | acc=0.9062 | L2-Norm=13.104 | L2-Norm(final)=3.043 | 4201.6 samples/s | 65.6 steps/s
[Step=18450 Epoch=90.0] | Loss=0.02944 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.168 | L2-Norm(final)=3.026 | 4275.0 samples/s | 66.8 steps/s
[Step=18500 Epoch=90.2] | Loss=0.01804 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.189 | L2-Norm(final)=3.029 | 4276.5 samples/s | 66.8 steps/s
[Step=18550 Epoch=90.5] | Loss=0.01374 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.200 | L2-Norm(final)=3.033 | 4209.1 samples/s | 65.8 steps/s
[Step=18600 Epoch=90.7] | Loss=0.01213 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.207 | L2-Norm(final)=3.036 | 5695.8 samples/s | 89.0 steps/s
[Step=18650 Epoch=90.9] | Loss=0.01044 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.212 | L2-Norm(final)=3.039 | 1860.6 samples/s | 29.1 steps/s
[Step=18700 Epoch=91.2] | Loss=0.00915 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.216 | L2-Norm(final)=3.042 | 4129.0 samples/s | 64.5 steps/s
[Step=18750 Epoch=91.4] | Loss=0.00835 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.220 | L2-Norm(final)=3.044 | 4258.1 samples/s | 66.5 steps/s
[Step=18800 Epoch=91.7] | Loss=0.00781 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.222 | L2-Norm(final)=3.047 | 5271.8 samples/s | 82.4 steps/s
[Step=18850 Epoch=91.9] | Loss=0.00726 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.224 | L2-Norm(final)=3.049 | 1930.1 samples/s | 30.2 steps/s
[Step=18900 Epoch=92.2] | Loss=0.00678 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.226 | L2-Norm(final)=3.051 | 4172.6 samples/s | 65.2 steps/s
[Step=18950 Epoch=92.4] | Loss=0.00654 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.228 | L2-Norm(final)=3.054 | 4189.6 samples/s | 65.5 steps/s
[Step=19000 Epoch=92.6] | Loss=0.00640 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.229 | L2-Norm(final)=3.056 | 4907.0 samples/s | 76.7 steps/s
[Step=19050 Epoch=92.9] | Loss=0.00606 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.230 | L2-Norm(final)=3.057 | 1977.1 samples/s | 30.9 steps/s
[Step=19100 Epoch=93.1] | Loss=0.00576 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.232 | L2-Norm(final)=3.059 | 4251.2 samples/s | 66.4 steps/s
[Step=19150 Epoch=93.4] | Loss=0.00562 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.233 | L2-Norm(final)=3.061 | 4224.1 samples/s | 66.0 steps/s
[Step=19200 Epoch=93.6] | Loss=0.00550 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.234 | L2-Norm(final)=3.063 | 4533.9 samples/s | 70.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step19200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=89.8] | Loss=0.23799 | Reg=0.00172 | acc=0.8594 | L2-Norm=13.104 | L2-Norm(final)=3.043 | 4597.7 samples/s | 71.8 steps/s
[Step=18450 Epoch=90.0] | Loss=0.02489 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.158 | L2-Norm(final)=3.036 | 3986.8 samples/s | 62.3 steps/s
[Step=18500 Epoch=90.3] | Loss=0.01488 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.174 | L2-Norm(final)=3.036 | 4052.6 samples/s | 63.3 steps/s
[Step=18550 Epoch=90.5] | Loss=0.01164 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.182 | L2-Norm(final)=3.040 | 4159.8 samples/s | 65.0 steps/s
[Step=18600 Epoch=90.8] | Loss=0.00999 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.188 | L2-Norm(final)=3.044 | 5710.0 samples/s | 89.2 steps/s
[Step=18650 Epoch=91.0] | Loss=0.00865 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.192 | L2-Norm(final)=3.047 | 1856.9 samples/s | 29.0 steps/s
[Step=18700 Epoch=91.2] | Loss=0.00756 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.195 | L2-Norm(final)=3.050 | 4228.1 samples/s | 66.1 steps/s
[Step=18750 Epoch=91.5] | Loss=0.00681 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.198 | L2-Norm(final)=3.053 | 4212.2 samples/s | 65.8 steps/s
[Step=18800 Epoch=91.7] | Loss=0.00633 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.200 | L2-Norm(final)=3.056 | 5342.6 samples/s | 83.5 steps/s
[Step=18850 Epoch=92.0] | Loss=0.00594 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.202 | L2-Norm(final)=3.058 | 1898.5 samples/s | 29.7 steps/s
[Step=18900 Epoch=92.2] | Loss=0.00557 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.204 | L2-Norm(final)=3.061 | 4253.7 samples/s | 66.5 steps/s
[Step=18950 Epoch=92.5] | Loss=0.00536 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.205 | L2-Norm(final)=3.064 | 4287.9 samples/s | 67.0 steps/s
[Step=19000 Epoch=92.7] | Loss=0.00524 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.207 | L2-Norm(final)=3.066 | 5014.0 samples/s | 78.3 steps/s
[Step=19050 Epoch=93.0] | Loss=0.00495 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.208 | L2-Norm(final)=3.068 | 1923.6 samples/s | 30.1 steps/s
[Step=19100 Epoch=93.2] | Loss=0.00479 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.209 | L2-Norm(final)=3.070 | 4197.2 samples/s | 65.6 steps/s
[Step=19150 Epoch=93.4] | Loss=0.00465 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.210 | L2-Norm(final)=3.072 | 4240.8 samples/s | 66.3 steps/s
[Step=19200 Epoch=93.7] | Loss=0.00457 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.211 | L2-Norm(final)=3.074 | 4751.7 samples/s | 74.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step19200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=174.4] | Loss=0.00436 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=3.044 | 4241.0 samples/s | 66.3 steps/s
[Step=18450 Epoch=174.8] | Loss=0.00266 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.148 | L2-Norm(final)=3.048 | 3856.2 samples/s | 60.3 steps/s
[Step=18500 Epoch=175.3] | Loss=0.00138 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.158 | L2-Norm(final)=3.050 | 5659.0 samples/s | 88.4 steps/s
[Step=18550 Epoch=175.8] | Loss=0.00093 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.158 | L2-Norm(final)=3.052 | 1834.7 samples/s | 28.7 steps/s
[Step=18600 Epoch=176.3] | Loss=0.00070 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.155 | L2-Norm(final)=3.053 | 4994.6 samples/s | 78.0 steps/s
[Step=18650 Epoch=176.7] | Loss=0.00056 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.151 | L2-Norm(final)=3.055 | 1862.8 samples/s | 29.1 steps/s
[Step=18700 Epoch=177.2] | Loss=0.00047 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.147 | L2-Norm(final)=3.057 | 4829.7 samples/s | 75.5 steps/s
[Step=18750 Epoch=177.7] | Loss=0.00040 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.142 | L2-Norm(final)=3.058 | 1941.3 samples/s | 30.3 steps/s
[Step=18800 Epoch=178.1] | Loss=0.00035 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.137 | L2-Norm(final)=3.059 | 4414.0 samples/s | 69.0 steps/s
[Step=18850 Epoch=178.6] | Loss=0.00031 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.132 | L2-Norm(final)=3.061 | 2000.5 samples/s | 31.3 steps/s
[Step=18900 Epoch=179.1] | Loss=0.00028 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.126 | L2-Norm(final)=3.062 | 4062.3 samples/s | 63.5 steps/s
[Step=18950 Epoch=179.6] | Loss=0.00026 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.121 | L2-Norm(final)=3.063 | 2019.2 samples/s | 31.6 steps/s
[Step=19000 Epoch=180.0] | Loss=0.00024 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.115 | L2-Norm(final)=3.064 | 4085.6 samples/s | 63.8 steps/s
[Step=19050 Epoch=180.5] | Loss=0.00022 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.109 | L2-Norm(final)=3.066 | 2054.0 samples/s | 32.1 steps/s
[Step=19100 Epoch=181.0] | Loss=0.00020 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.103 | L2-Norm(final)=3.067 | 4107.9 samples/s | 64.2 steps/s
[Step=19150 Epoch=181.5] | Loss=0.00019 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.098 | L2-Norm(final)=3.068 | 2075.3 samples/s | 32.4 steps/s
[Step=19200 Epoch=181.9] | Loss=0.00018 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.092 | L2-Norm(final)=3.069 | 3994.8 samples/s | 62.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step19200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=175.0] | Loss=0.02612 | Reg=0.00172 | acc=0.9688 | L2-Norm=13.104 | L2-Norm(final)=3.044 | 3988.2 samples/s | 62.3 steps/s
[Step=18450 Epoch=175.5] | Loss=0.00401 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.168 | L2-Norm(final)=3.048 | 4132.6 samples/s | 64.6 steps/s
[Step=18500 Epoch=176.0] | Loss=0.00202 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.179 | L2-Norm(final)=3.049 | 5691.0 samples/s | 88.9 steps/s
[Step=18550 Epoch=176.5] | Loss=0.00135 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.178 | L2-Norm(final)=3.051 | 1819.2 samples/s | 28.4 steps/s
[Step=18600 Epoch=176.9] | Loss=0.00103 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.176 | L2-Norm(final)=3.052 | 5045.1 samples/s | 78.8 steps/s
[Step=18650 Epoch=177.4] | Loss=0.00082 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.172 | L2-Norm(final)=3.053 | 1872.6 samples/s | 29.3 steps/s
[Step=18700 Epoch=177.9] | Loss=0.00069 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.169 | L2-Norm(final)=3.054 | 4660.1 samples/s | 72.8 steps/s
[Step=18750 Epoch=178.4] | Loss=0.00059 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.164 | L2-Norm(final)=3.054 | 1906.5 samples/s | 29.8 steps/s
[Step=18800 Epoch=178.8] | Loss=0.00052 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.160 | L2-Norm(final)=3.055 | 4347.5 samples/s | 67.9 steps/s
[Step=18850 Epoch=179.3] | Loss=0.00046 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.155 | L2-Norm(final)=3.056 | 1956.1 samples/s | 30.6 steps/s
[Step=18900 Epoch=179.8] | Loss=0.00042 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.151 | L2-Norm(final)=3.057 | 4134.2 samples/s | 64.6 steps/s
[Step=18950 Epoch=180.3] | Loss=0.00038 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.146 | L2-Norm(final)=3.058 | 2023.5 samples/s | 31.6 steps/s
[Step=19000 Epoch=180.7] | Loss=0.00035 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.141 | L2-Norm(final)=3.059 | 3960.6 samples/s | 61.9 steps/s
[Step=19050 Epoch=181.2] | Loss=0.00032 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.136 | L2-Norm(final)=3.060 | 2049.8 samples/s | 32.0 steps/s
[Step=19100 Epoch=181.7] | Loss=0.00030 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.131 | L2-Norm(final)=3.061 | 4183.5 samples/s | 65.4 steps/s
[Step=19150 Epoch=182.2] | Loss=0.00028 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.126 | L2-Norm(final)=3.062 | 2068.9 samples/s | 32.3 steps/s
[Step=19200 Epoch=182.6] | Loss=0.00026 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.121 | L2-Norm(final)=3.063 | 3924.2 samples/s | 61.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.50820 | acc=0.7794 | tpr=0.6847 | fpr=0.0151 | 3864.7 samples/s | 15.1 steps/s
Avg test loss: 0.51678, Avg test acc: 0.77747, Avg tpr: 0.68310, Avg fpr: 0.01500, total FA: 117

Testing server on iccad2012
[Step=  50] | Loss=0.25850 | acc=0.9284 | tpr=0.9159 | fpr=0.0713 | 3875.0 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.26680 | acc=0.9264 | tpr=0.9382 | fpr=0.0738 | 7196.4 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.27569 | acc=0.9256 | tpr=0.9424 | fpr=0.0747 | 7056.6 samples/s | 27.6 steps/s
[Step= 200] | Loss=0.27790 | acc=0.9261 | tpr=0.9388 | fpr=0.0741 | 7553.9 samples/s | 29.5 steps/s
[Step= 250] | Loss=0.27533 | acc=0.9267 | tpr=0.9415 | fpr=0.0735 | 7061.3 samples/s | 27.6 steps/s
[Step= 300] | Loss=0.27934 | acc=0.9266 | tpr=0.9396 | fpr=0.0737 | 7005.2 samples/s | 27.4 steps/s
[Step= 350] | Loss=0.28199 | acc=0.9261 | tpr=0.9399 | fpr=0.0742 | 7332.6 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.28401 | acc=0.9260 | tpr=0.9398 | fpr=0.0743 | 7356.1 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.28725 | acc=0.9255 | tpr=0.9372 | fpr=0.0748 | 6656.6 samples/s | 26.0 steps/s
[Step= 500] | Loss=0.28570 | acc=0.9256 | tpr=0.9392 | fpr=0.0746 | 7056.3 samples/s | 27.6 steps/s
[Step= 550] | Loss=0.28380 | acc=0.9261 | tpr=0.9403 | fpr=0.0741 | 13133.7 samples/s | 51.3 steps/s
Avg test loss: 0.28323, Avg test acc: 0.92617, Avg tpr: 0.94057, Avg fpr: 0.07409, total FA: 10287

server round 24/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=93.6] | Loss=0.18141 | Reg=0.00171 | acc=0.8438 | L2-Norm=13.062 | L2-Norm(final)=3.083 | 4607.8 samples/s | 72.0 steps/s
[Step=19250 Epoch=93.9] | Loss=0.02839 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.127 | L2-Norm(final)=3.071 | 3877.4 samples/s | 60.6 steps/s
[Step=19300 Epoch=94.1] | Loss=0.01736 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.147 | L2-Norm(final)=3.071 | 4270.3 samples/s | 66.7 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01333 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.158 | L2-Norm(final)=3.075 | 4208.3 samples/s | 65.8 steps/s
[Step=19400 Epoch=94.6] | Loss=0.01138 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.165 | L2-Norm(final)=3.080 | 5768.4 samples/s | 90.1 steps/s
[Step=19450 Epoch=94.8] | Loss=0.00969 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.171 | L2-Norm(final)=3.084 | 1885.0 samples/s | 29.5 steps/s
[Step=19500 Epoch=95.1] | Loss=0.00851 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.175 | L2-Norm(final)=3.088 | 4344.2 samples/s | 67.9 steps/s
[Step=19550 Epoch=95.3] | Loss=0.00795 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.178 | L2-Norm(final)=3.091 | 4213.2 samples/s | 65.8 steps/s
[Step=19600 Epoch=95.6] | Loss=0.00735 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.181 | L2-Norm(final)=3.094 | 5348.0 samples/s | 83.6 steps/s
[Step=19650 Epoch=95.8] | Loss=0.00688 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.184 | L2-Norm(final)=3.097 | 1921.3 samples/s | 30.0 steps/s
[Step=19700 Epoch=96.1] | Loss=0.00642 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.186 | L2-Norm(final)=3.099 | 4164.4 samples/s | 65.1 steps/s
[Step=19750 Epoch=96.3] | Loss=0.00615 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.188 | L2-Norm(final)=3.102 | 4285.7 samples/s | 67.0 steps/s
[Step=19800 Epoch=96.5] | Loss=0.00589 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.190 | L2-Norm(final)=3.104 | 4874.7 samples/s | 76.2 steps/s
[Step=19850 Epoch=96.8] | Loss=0.00564 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.191 | L2-Norm(final)=3.106 | 1978.0 samples/s | 30.9 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00543 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.193 | L2-Norm(final)=3.108 | 4204.3 samples/s | 65.7 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00527 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.194 | L2-Norm(final)=3.110 | 4264.5 samples/s | 66.6 steps/s
[Step=20000 Epoch=97.5] | Loss=0.00504 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.195 | L2-Norm(final)=3.112 | 4629.3 samples/s | 72.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step20000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=93.7] | Loss=0.24283 | Reg=0.00171 | acc=0.8750 | L2-Norm=13.062 | L2-Norm(final)=3.082 | 4297.6 samples/s | 67.2 steps/s
[Step=19250 Epoch=93.9] | Loss=0.02878 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.132 | L2-Norm(final)=3.068 | 4190.7 samples/s | 65.5 steps/s
[Step=19300 Epoch=94.2] | Loss=0.01762 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.154 | L2-Norm(final)=3.066 | 4178.4 samples/s | 65.3 steps/s
[Step=19350 Epoch=94.4] | Loss=0.01394 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.164 | L2-Norm(final)=3.069 | 4309.7 samples/s | 67.3 steps/s
[Step=19400 Epoch=94.7] | Loss=0.01175 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.172 | L2-Norm(final)=3.072 | 5865.9 samples/s | 91.7 steps/s
[Step=19450 Epoch=94.9] | Loss=0.01029 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.177 | L2-Norm(final)=3.075 | 1849.3 samples/s | 28.9 steps/s
[Step=19500 Epoch=95.2] | Loss=0.00909 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.181 | L2-Norm(final)=3.079 | 4325.7 samples/s | 67.6 steps/s
[Step=19550 Epoch=95.4] | Loss=0.00821 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.184 | L2-Norm(final)=3.081 | 4303.8 samples/s | 67.2 steps/s
[Step=19600 Epoch=95.6] | Loss=0.00764 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.187 | L2-Norm(final)=3.084 | 5438.2 samples/s | 85.0 steps/s
[Step=19650 Epoch=95.9] | Loss=0.00733 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.189 | L2-Norm(final)=3.086 | 1902.9 samples/s | 29.7 steps/s
[Step=19700 Epoch=96.1] | Loss=0.00685 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.191 | L2-Norm(final)=3.088 | 4230.5 samples/s | 66.1 steps/s
[Step=19750 Epoch=96.4] | Loss=0.00646 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.193 | L2-Norm(final)=3.090 | 4177.6 samples/s | 65.3 steps/s
[Step=19800 Epoch=96.6] | Loss=0.00608 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.194 | L2-Norm(final)=3.092 | 5070.6 samples/s | 79.2 steps/s
[Step=19850 Epoch=96.9] | Loss=0.00585 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.195 | L2-Norm(final)=3.094 | 1977.5 samples/s | 30.9 steps/s
[Step=19900 Epoch=97.1] | Loss=0.00560 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.196 | L2-Norm(final)=3.095 | 4261.2 samples/s | 66.6 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00539 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.197 | L2-Norm(final)=3.097 | 4177.1 samples/s | 65.3 steps/s
[Step=20000 Epoch=97.6] | Loss=0.00515 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.198 | L2-Norm(final)=3.099 | 4723.6 samples/s | 73.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step20000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=181.9] | Loss=0.00384 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.062 | L2-Norm(final)=3.083 | 4314.0 samples/s | 67.4 steps/s
[Step=19250 Epoch=182.4] | Loss=0.00069 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.102 | L2-Norm(final)=3.100 | 3684.3 samples/s | 57.6 steps/s
[Step=19300 Epoch=182.9] | Loss=0.00035 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.107 | L2-Norm(final)=3.103 | 5558.2 samples/s | 86.8 steps/s
[Step=19350 Epoch=183.4] | Loss=0.00024 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=3.105 | 1804.2 samples/s | 28.2 steps/s
[Step=19400 Epoch=183.8] | Loss=0.00018 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.099 | L2-Norm(final)=3.107 | 5123.1 samples/s | 80.0 steps/s
[Step=19450 Epoch=184.3] | Loss=0.00015 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.092 | L2-Norm(final)=3.108 | 1866.3 samples/s | 29.2 steps/s
[Step=19500 Epoch=184.8] | Loss=0.00012 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.085 | L2-Norm(final)=3.108 | 4594.7 samples/s | 71.8 steps/s
[Step=19550 Epoch=185.3] | Loss=0.00011 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.079 | L2-Norm(final)=3.109 | 1913.5 samples/s | 29.9 steps/s
[Step=19600 Epoch=185.7] | Loss=0.00009 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.072 | L2-Norm(final)=3.110 | 4404.0 samples/s | 68.8 steps/s
[Step=19650 Epoch=186.2] | Loss=0.00008 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.065 | L2-Norm(final)=3.111 | 1962.6 samples/s | 30.7 steps/s
[Step=19700 Epoch=186.7] | Loss=0.00008 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.058 | L2-Norm(final)=3.111 | 4185.4 samples/s | 65.4 steps/s
[Step=19750 Epoch=187.1] | Loss=0.00007 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.051 | L2-Norm(final)=3.112 | 2028.6 samples/s | 31.7 steps/s
[Step=19800 Epoch=187.6] | Loss=0.00006 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.044 | L2-Norm(final)=3.113 | 4103.5 samples/s | 64.1 steps/s
[Step=19850 Epoch=188.1] | Loss=0.00006 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.037 | L2-Norm(final)=3.113 | 2054.6 samples/s | 32.1 steps/s
[Step=19900 Epoch=188.6] | Loss=0.00006 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.030 | L2-Norm(final)=3.114 | 4077.6 samples/s | 63.7 steps/s
[Step=19950 Epoch=189.0] | Loss=0.00005 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.022 | L2-Norm(final)=3.114 | 2090.5 samples/s | 32.7 steps/s
[Step=20000 Epoch=189.5] | Loss=0.00005 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.015 | L2-Norm(final)=3.115 | 3922.3 samples/s | 61.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step20000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=182.6] | Loss=0.01296 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.062 | L2-Norm(final)=3.083 | 4350.1 samples/s | 68.0 steps/s
[Step=19250 Epoch=183.1] | Loss=0.00144 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.096 | L2-Norm(final)=3.092 | 3808.2 samples/s | 59.5 steps/s
[Step=19300 Epoch=183.6] | Loss=0.00074 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.100 | L2-Norm(final)=3.094 | 5618.6 samples/s | 87.8 steps/s
[Step=19350 Epoch=184.1] | Loss=0.00050 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.098 | L2-Norm(final)=3.096 | 1803.1 samples/s | 28.2 steps/s
[Step=19400 Epoch=184.5] | Loss=0.00038 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.094 | L2-Norm(final)=3.097 | 5021.5 samples/s | 78.5 steps/s
[Step=19450 Epoch=185.0] | Loss=0.00030 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.089 | L2-Norm(final)=3.098 | 1857.1 samples/s | 29.0 steps/s
[Step=19500 Epoch=185.5] | Loss=0.00025 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.084 | L2-Norm(final)=3.099 | 4796.5 samples/s | 74.9 steps/s
[Step=19550 Epoch=186.0] | Loss=0.00022 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.079 | L2-Norm(final)=3.099 | 1924.6 samples/s | 30.1 steps/s
[Step=19600 Epoch=186.4] | Loss=0.00019 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.074 | L2-Norm(final)=3.100 | 4416.4 samples/s | 69.0 steps/s
[Step=19650 Epoch=186.9] | Loss=0.00017 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.069 | L2-Norm(final)=3.101 | 1958.1 samples/s | 30.6 steps/s
[Step=19700 Epoch=187.4] | Loss=0.00016 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.064 | L2-Norm(final)=3.101 | 4060.5 samples/s | 63.4 steps/s
[Step=19750 Epoch=187.9] | Loss=0.00014 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.058 | L2-Norm(final)=3.102 | 2015.3 samples/s | 31.5 steps/s
[Step=19800 Epoch=188.3] | Loss=0.00013 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.053 | L2-Norm(final)=3.103 | 4086.4 samples/s | 63.9 steps/s
[Step=19850 Epoch=188.8] | Loss=0.00012 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.047 | L2-Norm(final)=3.104 | 2029.5 samples/s | 31.7 steps/s
[Step=19900 Epoch=189.3] | Loss=0.00011 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.041 | L2-Norm(final)=3.105 | 4054.4 samples/s | 63.4 steps/s
[Step=19950 Epoch=189.8] | Loss=0.00011 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.036 | L2-Norm(final)=3.106 | 2043.2 samples/s | 31.9 steps/s
[Step=20000 Epoch=190.2] | Loss=0.00010 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.030 | L2-Norm(final)=3.107 | 3997.9 samples/s | 62.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36978 | acc=0.8435 | tpr=0.7810 | fpr=0.0208 | 3888.4 samples/s | 15.2 steps/s
Avg test loss: 0.37754, Avg test acc: 0.84169, Avg tpr: 0.77916, Avg fpr: 0.02077, total FA: 162

Testing server on iccad2012
[Step=  50] | Loss=0.36876 | acc=0.8912 | tpr=0.9159 | fpr=0.1092 | 3892.0 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.38014 | acc=0.8874 | tpr=0.9382 | fpr=0.1136 | 7081.6 samples/s | 27.7 steps/s
[Step= 150] | Loss=0.38916 | acc=0.8878 | tpr=0.9452 | fpr=0.1133 | 7090.9 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.39143 | acc=0.8880 | tpr=0.9443 | fpr=0.1130 | 7203.7 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.38933 | acc=0.8874 | tpr=0.9467 | fpr=0.1137 | 7306.6 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.39395 | acc=0.8872 | tpr=0.9462 | fpr=0.1138 | 7201.0 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.39698 | acc=0.8869 | tpr=0.9461 | fpr=0.1142 | 7240.7 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.39909 | acc=0.8870 | tpr=0.9469 | fpr=0.1141 | 7131.7 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.40261 | acc=0.8868 | tpr=0.9455 | fpr=0.1143 | 6790.5 samples/s | 26.5 steps/s
[Step= 500] | Loss=0.40062 | acc=0.8872 | tpr=0.9463 | fpr=0.1139 | 7163.0 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.39828 | acc=0.8879 | tpr=0.9475 | fpr=0.1132 | 13010.1 samples/s | 50.8 steps/s
Avg test loss: 0.39760, Avg test acc: 0.88796, Avg tpr: 0.94770, Avg fpr: 0.11313, total FA: 15708

server round 25/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=97.5] | Loss=0.16299 | Reg=0.00169 | acc=0.8594 | L2-Norm=13.013 | L2-Norm(final)=3.126 | 4158.7 samples/s | 65.0 steps/s
[Step=20050 Epoch=97.8] | Loss=0.01491 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.056 | L2-Norm(final)=3.124 | 4198.7 samples/s | 65.6 steps/s
[Step=20100 Epoch=98.0] | Loss=0.01019 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.069 | L2-Norm(final)=3.126 | 4185.0 samples/s | 65.4 steps/s
[Step=20150 Epoch=98.3] | Loss=0.00857 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.076 | L2-Norm(final)=3.129 | 4179.4 samples/s | 65.3 steps/s
[Step=20200 Epoch=98.5] | Loss=0.00759 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.081 | L2-Norm(final)=3.132 | 5789.4 samples/s | 90.5 steps/s
[Step=20250 Epoch=98.7] | Loss=0.00670 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.085 | L2-Norm(final)=3.135 | 1857.8 samples/s | 29.0 steps/s
[Step=20300 Epoch=99.0] | Loss=0.00610 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.088 | L2-Norm(final)=3.138 | 4196.3 samples/s | 65.6 steps/s
[Step=20350 Epoch=99.2] | Loss=0.00566 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.091 | L2-Norm(final)=3.140 | 4246.7 samples/s | 66.4 steps/s
[Step=20400 Epoch=99.5] | Loss=0.00539 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.093 | L2-Norm(final)=3.142 | 5305.5 samples/s | 82.9 steps/s
[Step=20450 Epoch=99.7] | Loss=0.00512 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.095 | L2-Norm(final)=3.144 | 1919.8 samples/s | 30.0 steps/s
[Step=20500 Epoch=100.0] | Loss=0.00492 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.097 | L2-Norm(final)=3.146 | 4141.7 samples/s | 64.7 steps/s
[Step=20550 Epoch=100.2] | Loss=0.00473 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.098 | L2-Norm(final)=3.148 | 4243.8 samples/s | 66.3 steps/s
[Step=20600 Epoch=100.4] | Loss=0.00462 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.099 | L2-Norm(final)=3.150 | 4839.5 samples/s | 75.6 steps/s
[Step=20650 Epoch=100.7] | Loss=0.00447 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.100 | L2-Norm(final)=3.152 | 1970.9 samples/s | 30.8 steps/s
[Step=20700 Epoch=100.9] | Loss=0.00435 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.101 | L2-Norm(final)=3.154 | 4240.4 samples/s | 66.3 steps/s
[Step=20750 Epoch=101.2] | Loss=0.00418 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.102 | L2-Norm(final)=3.155 | 4143.5 samples/s | 64.7 steps/s
[Step=20800 Epoch=101.4] | Loss=0.00416 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.102 | L2-Norm(final)=3.157 | 4651.2 samples/s | 72.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step20800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=97.6] | Loss=0.10926 | Reg=0.00169 | acc=0.9219 | L2-Norm=13.013 | L2-Norm(final)=3.126 | 4657.5 samples/s | 72.8 steps/s
[Step=20050 Epoch=97.8] | Loss=0.01468 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.064 | L2-Norm(final)=3.124 | 3731.4 samples/s | 58.3 steps/s
[Step=20100 Epoch=98.1] | Loss=0.00930 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.080 | L2-Norm(final)=3.126 | 4216.2 samples/s | 65.9 steps/s
[Step=20150 Epoch=98.3] | Loss=0.00849 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.088 | L2-Norm(final)=3.129 | 4213.6 samples/s | 65.8 steps/s
[Step=20200 Epoch=98.6] | Loss=0.00771 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.094 | L2-Norm(final)=3.131 | 5779.5 samples/s | 90.3 steps/s
[Step=20250 Epoch=98.8] | Loss=0.00670 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.099 | L2-Norm(final)=3.133 | 1866.4 samples/s | 29.2 steps/s
[Step=20300 Epoch=99.1] | Loss=0.00615 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.103 | L2-Norm(final)=3.136 | 4275.5 samples/s | 66.8 steps/s
[Step=20350 Epoch=99.3] | Loss=0.00581 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.106 | L2-Norm(final)=3.138 | 4194.1 samples/s | 65.5 steps/s
[Step=20400 Epoch=99.5] | Loss=0.00548 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.109 | L2-Norm(final)=3.141 | 5373.6 samples/s | 84.0 steps/s
[Step=20450 Epoch=99.8] | Loss=0.00520 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.112 | L2-Norm(final)=3.143 | 1892.1 samples/s | 29.6 steps/s
[Step=20500 Epoch=100.0] | Loss=0.00499 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.114 | L2-Norm(final)=3.145 | 4256.6 samples/s | 66.5 steps/s
[Step=20550 Epoch=100.3] | Loss=0.00469 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.116 | L2-Norm(final)=3.147 | 4153.6 samples/s | 64.9 steps/s
[Step=20600 Epoch=100.5] | Loss=0.00451 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.117 | L2-Norm(final)=3.149 | 5100.7 samples/s | 79.7 steps/s
[Step=20650 Epoch=100.8] | Loss=0.00431 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.118 | L2-Norm(final)=3.150 | 1941.9 samples/s | 30.3 steps/s
[Step=20700 Epoch=101.0] | Loss=0.00420 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.120 | L2-Norm(final)=3.152 | 4212.3 samples/s | 65.8 steps/s
[Step=20750 Epoch=101.3] | Loss=0.00402 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.120 | L2-Norm(final)=3.154 | 4169.5 samples/s | 65.1 steps/s
[Step=20800 Epoch=101.5] | Loss=0.00406 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.121 | L2-Norm(final)=3.155 | 4763.0 samples/s | 74.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step20800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=189.5] | Loss=0.02307 | Reg=0.00169 | acc=0.9844 | L2-Norm=13.013 | L2-Norm(final)=3.127 | 4436.5 samples/s | 69.3 steps/s
[Step=20050 Epoch=190.0] | Loss=0.00122 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.084 | L2-Norm(final)=3.137 | 3739.8 samples/s | 58.4 steps/s
[Step=20100 Epoch=190.5] | Loss=0.00062 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.093 | L2-Norm(final)=3.138 | 5422.8 samples/s | 84.7 steps/s
[Step=20150 Epoch=190.9] | Loss=0.00041 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.091 | L2-Norm(final)=3.139 | 1778.2 samples/s | 27.8 steps/s
[Step=20200 Epoch=191.4] | Loss=0.00031 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.086 | L2-Norm(final)=3.140 | 5001.4 samples/s | 78.1 steps/s
[Step=20250 Epoch=191.9] | Loss=0.00025 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.080 | L2-Norm(final)=3.141 | 1863.6 samples/s | 29.1 steps/s
[Step=20300 Epoch=192.4] | Loss=0.00021 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.074 | L2-Norm(final)=3.141 | 4689.3 samples/s | 73.3 steps/s
[Step=20350 Epoch=192.8] | Loss=0.00018 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.068 | L2-Norm(final)=3.142 | 1883.7 samples/s | 29.4 steps/s
[Step=20400 Epoch=193.3] | Loss=0.00016 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.061 | L2-Norm(final)=3.142 | 4281.2 samples/s | 66.9 steps/s
[Step=20450 Epoch=193.8] | Loss=0.00014 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.054 | L2-Norm(final)=3.143 | 1967.4 samples/s | 30.7 steps/s
[Step=20500 Epoch=194.3] | Loss=0.00013 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.048 | L2-Norm(final)=3.143 | 4153.0 samples/s | 64.9 steps/s
[Step=20550 Epoch=194.7] | Loss=0.00012 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.041 | L2-Norm(final)=3.144 | 2055.6 samples/s | 32.1 steps/s
[Step=20600 Epoch=195.2] | Loss=0.00011 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.034 | L2-Norm(final)=3.144 | 4143.9 samples/s | 64.7 steps/s
[Step=20650 Epoch=195.7] | Loss=0.00010 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.027 | L2-Norm(final)=3.144 | 2059.2 samples/s | 32.2 steps/s
[Step=20700 Epoch=196.2] | Loss=0.00009 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.020 | L2-Norm(final)=3.145 | 4097.6 samples/s | 64.0 steps/s
[Step=20750 Epoch=196.6] | Loss=0.00009 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.012 | L2-Norm(final)=3.145 | 2065.5 samples/s | 32.3 steps/s
[Step=20800 Epoch=197.1] | Loss=0.00008 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.005 | L2-Norm(final)=3.146 | 4118.7 samples/s | 64.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step20800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=190.3] | Loss=0.04648 | Reg=0.00169 | acc=0.9688 | L2-Norm=13.013 | L2-Norm(final)=3.126 | 4183.1 samples/s | 65.4 steps/s
[Step=20050 Epoch=190.7] | Loss=0.00257 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.073 | L2-Norm(final)=3.128 | 3929.6 samples/s | 61.4 steps/s
[Step=20100 Epoch=191.2] | Loss=0.00132 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.084 | L2-Norm(final)=3.127 | 5584.9 samples/s | 87.3 steps/s
[Step=20150 Epoch=191.7] | Loss=0.00089 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.084 | L2-Norm(final)=3.128 | 1817.8 samples/s | 28.4 steps/s
[Step=20200 Epoch=192.2] | Loss=0.00067 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.081 | L2-Norm(final)=3.129 | 5078.9 samples/s | 79.4 steps/s
[Step=20250 Epoch=192.6] | Loss=0.00054 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.077 | L2-Norm(final)=3.130 | 1836.4 samples/s | 28.7 steps/s
[Step=20300 Epoch=193.1] | Loss=0.00045 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.072 | L2-Norm(final)=3.132 | 4673.1 samples/s | 73.0 steps/s
[Step=20350 Epoch=193.6] | Loss=0.00039 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.067 | L2-Norm(final)=3.133 | 1895.0 samples/s | 29.6 steps/s
[Step=20400 Epoch=194.1] | Loss=0.00034 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.062 | L2-Norm(final)=3.135 | 4347.4 samples/s | 67.9 steps/s
[Step=20450 Epoch=194.5] | Loss=0.00030 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.056 | L2-Norm(final)=3.136 | 1962.1 samples/s | 30.7 steps/s
[Step=20500 Epoch=195.0] | Loss=0.00027 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.051 | L2-Norm(final)=3.137 | 4136.6 samples/s | 64.6 steps/s
[Step=20550 Epoch=195.5] | Loss=0.00025 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.045 | L2-Norm(final)=3.139 | 2020.8 samples/s | 31.6 steps/s
[Step=20600 Epoch=196.0] | Loss=0.00023 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.039 | L2-Norm(final)=3.140 | 4145.0 samples/s | 64.8 steps/s
[Step=20650 Epoch=196.4] | Loss=0.00021 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.033 | L2-Norm(final)=3.141 | 2053.0 samples/s | 32.1 steps/s
[Step=20700 Epoch=196.9] | Loss=0.00020 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.027 | L2-Norm(final)=3.142 | 4015.7 samples/s | 62.7 steps/s
[Step=20750 Epoch=197.4] | Loss=0.00018 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.021 | L2-Norm(final)=3.143 | 2071.7 samples/s | 32.4 steps/s
[Step=20800 Epoch=197.9] | Loss=0.00017 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.015 | L2-Norm(final)=3.145 | 3951.4 samples/s | 61.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.51227 | acc=0.7869 | tpr=0.6964 | fpr=0.0166 | 3855.4 samples/s | 15.1 steps/s
Avg test loss: 0.52095, Avg test acc: 0.78572, Avg tpr: 0.69552, Avg fpr: 0.01590, total FA: 124

Testing server on iccad2012
[Step=  50] | Loss=0.29158 | acc=0.9276 | tpr=0.9204 | fpr=0.0723 | 3896.6 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.30111 | acc=0.9260 | tpr=0.9424 | fpr=0.0743 | 7033.8 samples/s | 27.5 steps/s
[Step= 150] | Loss=0.31173 | acc=0.9246 | tpr=0.9467 | fpr=0.0758 | 7522.1 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.31365 | acc=0.9251 | tpr=0.9432 | fpr=0.0752 | 6863.9 samples/s | 26.8 steps/s
[Step= 250] | Loss=0.31074 | acc=0.9254 | tpr=0.9459 | fpr=0.0750 | 7055.8 samples/s | 27.6 steps/s
[Step= 300] | Loss=0.31532 | acc=0.9251 | tpr=0.9440 | fpr=0.0752 | 7079.2 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.31791 | acc=0.9247 | tpr=0.9436 | fpr=0.0756 | 7133.5 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.31967 | acc=0.9246 | tpr=0.9442 | fpr=0.0757 | 7332.6 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.32338 | acc=0.9241 | tpr=0.9416 | fpr=0.0762 | 6901.1 samples/s | 27.0 steps/s
[Step= 500] | Loss=0.32148 | acc=0.9244 | tpr=0.9427 | fpr=0.0760 | 7165.9 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.31944 | acc=0.9248 | tpr=0.9435 | fpr=0.0755 | 12355.5 samples/s | 48.3 steps/s
Avg test loss: 0.31885, Avg test acc: 0.92486, Avg tpr: 0.94374, Avg fpr: 0.07548, total FA: 10480

server round 26/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=101.4] | Loss=0.21119 | Reg=0.00168 | acc=0.8906 | L2-Norm=12.955 | L2-Norm(final)=3.162 | 4173.6 samples/s | 65.2 steps/s
[Step=20850 Epoch=101.7] | Loss=0.02575 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.026 | L2-Norm(final)=3.144 | 4117.3 samples/s | 64.3 steps/s
[Step=20900 Epoch=101.9] | Loss=0.01615 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.051 | L2-Norm(final)=3.146 | 4242.4 samples/s | 66.3 steps/s
[Step=20950 Epoch=102.2] | Loss=0.01233 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.064 | L2-Norm(final)=3.151 | 4111.4 samples/s | 64.2 steps/s
[Step=21000 Epoch=102.4] | Loss=0.01073 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.072 | L2-Norm(final)=3.155 | 5811.5 samples/s | 90.8 steps/s
[Step=21050 Epoch=102.6] | Loss=0.00909 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.077 | L2-Norm(final)=3.158 | 1862.7 samples/s | 29.1 steps/s
[Step=21100 Epoch=102.9] | Loss=0.00809 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.081 | L2-Norm(final)=3.162 | 4126.6 samples/s | 64.5 steps/s
[Step=21150 Epoch=103.1] | Loss=0.00728 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.084 | L2-Norm(final)=3.165 | 4163.1 samples/s | 65.0 steps/s
[Step=21200 Epoch=103.4] | Loss=0.00684 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.087 | L2-Norm(final)=3.168 | 5297.9 samples/s | 82.8 steps/s
[Step=21250 Epoch=103.6] | Loss=0.00656 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.089 | L2-Norm(final)=3.171 | 1912.0 samples/s | 29.9 steps/s
[Step=21300 Epoch=103.9] | Loss=0.00613 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.091 | L2-Norm(final)=3.173 | 4203.6 samples/s | 65.7 steps/s
[Step=21350 Epoch=104.1] | Loss=0.00600 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.093 | L2-Norm(final)=3.175 | 4217.6 samples/s | 65.9 steps/s
[Step=21400 Epoch=104.4] | Loss=0.00571 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.094 | L2-Norm(final)=3.177 | 4926.6 samples/s | 77.0 steps/s
[Step=21450 Epoch=104.6] | Loss=0.00546 | Reg=0.00171 | acc=0.9844 | L2-Norm=13.096 | L2-Norm(final)=3.179 | 1949.2 samples/s | 30.5 steps/s
[Step=21500 Epoch=104.8] | Loss=0.00521 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.097 | L2-Norm(final)=3.181 | 4157.9 samples/s | 65.0 steps/s
[Step=21550 Epoch=105.1] | Loss=0.00496 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.098 | L2-Norm(final)=3.184 | 4213.2 samples/s | 65.8 steps/s
[Step=21600 Epoch=105.3] | Loss=0.00480 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.099 | L2-Norm(final)=3.186 | 4627.5 samples/s | 72.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step21600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=101.5] | Loss=0.17217 | Reg=0.00168 | acc=0.8438 | L2-Norm=12.955 | L2-Norm(final)=3.162 | 4577.4 samples/s | 71.5 steps/s
[Step=20850 Epoch=101.7] | Loss=0.02394 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.028 | L2-Norm(final)=3.146 | 3820.5 samples/s | 59.7 steps/s
[Step=20900 Epoch=102.0] | Loss=0.01403 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.050 | L2-Norm(final)=3.146 | 4103.9 samples/s | 64.1 steps/s
[Step=20950 Epoch=102.2] | Loss=0.01147 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.060 | L2-Norm(final)=3.149 | 4185.4 samples/s | 65.4 steps/s
[Step=21000 Epoch=102.5] | Loss=0.00982 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.067 | L2-Norm(final)=3.152 | 5788.3 samples/s | 90.4 steps/s
[Step=21050 Epoch=102.7] | Loss=0.00844 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.072 | L2-Norm(final)=3.155 | 1859.9 samples/s | 29.1 steps/s
[Step=21100 Epoch=103.0] | Loss=0.00754 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.076 | L2-Norm(final)=3.157 | 4236.4 samples/s | 66.2 steps/s
[Step=21150 Epoch=103.2] | Loss=0.00682 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.079 | L2-Norm(final)=3.160 | 4261.7 samples/s | 66.6 steps/s
[Step=21200 Epoch=103.4] | Loss=0.00651 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.082 | L2-Norm(final)=3.162 | 5459.4 samples/s | 85.3 steps/s
[Step=21250 Epoch=103.7] | Loss=0.00609 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.084 | L2-Norm(final)=3.164 | 1890.8 samples/s | 29.5 steps/s
[Step=21300 Epoch=103.9] | Loss=0.00581 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.085 | L2-Norm(final)=3.166 | 4191.2 samples/s | 65.5 steps/s
[Step=21350 Epoch=104.2] | Loss=0.00548 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.087 | L2-Norm(final)=3.168 | 4222.4 samples/s | 66.0 steps/s
[Step=21400 Epoch=104.4] | Loss=0.00533 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.088 | L2-Norm(final)=3.170 | 5109.2 samples/s | 79.8 steps/s
[Step=21450 Epoch=104.7] | Loss=0.00510 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.089 | L2-Norm(final)=3.171 | 1932.7 samples/s | 30.2 steps/s
[Step=21500 Epoch=104.9] | Loss=0.00499 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.090 | L2-Norm(final)=3.173 | 4166.1 samples/s | 65.1 steps/s
[Step=21550 Epoch=105.2] | Loss=0.00483 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.091 | L2-Norm(final)=3.174 | 4229.5 samples/s | 66.1 steps/s
[Step=21600 Epoch=105.4] | Loss=0.00463 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.092 | L2-Norm(final)=3.176 | 4767.4 samples/s | 74.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step21600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=197.1] | Loss=0.00511 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.955 | L2-Norm(final)=3.163 | 4231.3 samples/s | 66.1 steps/s
[Step=20850 Epoch=197.6] | Loss=0.00034 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.979 | L2-Norm(final)=3.178 | 3822.8 samples/s | 59.7 steps/s
[Step=20900 Epoch=198.0] | Loss=0.00018 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.977 | L2-Norm(final)=3.181 | 5627.5 samples/s | 87.9 steps/s
[Step=20950 Epoch=198.5] | Loss=0.00012 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.970 | L2-Norm(final)=3.183 | 1804.9 samples/s | 28.2 steps/s
[Step=21000 Epoch=199.0] | Loss=0.00009 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.962 | L2-Norm(final)=3.184 | 5068.2 samples/s | 79.2 steps/s
[Step=21050 Epoch=199.5] | Loss=0.00007 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.954 | L2-Norm(final)=3.184 | 1875.9 samples/s | 29.3 steps/s
[Step=21100 Epoch=199.9] | Loss=0.00006 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.945 | L2-Norm(final)=3.185 | 4762.9 samples/s | 74.4 steps/s
[Step=21150 Epoch=200.4] | Loss=0.00005 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.937 | L2-Norm(final)=3.186 | 1949.2 samples/s | 30.5 steps/s
[Step=21200 Epoch=200.9] | Loss=0.00005 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.928 | L2-Norm(final)=3.186 | 4372.2 samples/s | 68.3 steps/s
[Step=21250 Epoch=201.4] | Loss=0.00004 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.920 | L2-Norm(final)=3.187 | 1982.4 samples/s | 31.0 steps/s
[Step=21300 Epoch=201.8] | Loss=0.00004 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.911 | L2-Norm(final)=3.187 | 4159.2 samples/s | 65.0 steps/s
[Step=21350 Epoch=202.3] | Loss=0.00003 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.902 | L2-Norm(final)=3.188 | 2029.0 samples/s | 31.7 steps/s
[Step=21400 Epoch=202.8] | Loss=0.00003 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.894 | L2-Norm(final)=3.188 | 4068.4 samples/s | 63.6 steps/s
[Step=21450 Epoch=203.3] | Loss=0.00003 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.885 | L2-Norm(final)=3.189 | 2058.6 samples/s | 32.2 steps/s
[Step=21500 Epoch=203.7] | Loss=0.00003 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.876 | L2-Norm(final)=3.189 | 4047.5 samples/s | 63.2 steps/s
[Step=21550 Epoch=204.2] | Loss=0.00003 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.867 | L2-Norm(final)=3.189 | 2066.0 samples/s | 32.3 steps/s
[Step=21600 Epoch=204.7] | Loss=0.00002 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.857 | L2-Norm(final)=3.190 | 3965.5 samples/s | 62.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step21600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=197.9] | Loss=0.00284 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.955 | L2-Norm(final)=3.163 | 4223.7 samples/s | 66.0 steps/s
[Step=20850 Epoch=198.3] | Loss=0.00090 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.999 | L2-Norm(final)=3.180 | 3917.9 samples/s | 61.2 steps/s
[Step=20900 Epoch=198.8] | Loss=0.00046 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.008 | L2-Norm(final)=3.183 | 5556.7 samples/s | 86.8 steps/s
[Step=20950 Epoch=199.3] | Loss=0.00031 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.006 | L2-Norm(final)=3.185 | 1811.4 samples/s | 28.3 steps/s
[Step=21000 Epoch=199.8] | Loss=0.00024 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.002 | L2-Norm(final)=3.187 | 5074.3 samples/s | 79.3 steps/s
[Step=21050 Epoch=200.2] | Loss=0.00019 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.997 | L2-Norm(final)=3.187 | 1845.1 samples/s | 28.8 steps/s
[Step=21100 Epoch=200.7] | Loss=0.00016 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.991 | L2-Norm(final)=3.188 | 4645.8 samples/s | 72.6 steps/s
[Step=21150 Epoch=201.2] | Loss=0.00014 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.986 | L2-Norm(final)=3.189 | 1915.8 samples/s | 29.9 steps/s
[Step=21200 Epoch=201.7] | Loss=0.00012 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.980 | L2-Norm(final)=3.189 | 4422.0 samples/s | 69.1 steps/s
[Step=21250 Epoch=202.1] | Loss=0.00011 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.973 | L2-Norm(final)=3.190 | 1957.2 samples/s | 30.6 steps/s
[Step=21300 Epoch=202.6] | Loss=0.00010 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.967 | L2-Norm(final)=3.190 | 4057.9 samples/s | 63.4 steps/s
[Step=21350 Epoch=203.1] | Loss=0.00009 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=3.191 | 2008.5 samples/s | 31.4 steps/s
[Step=21400 Epoch=203.6] | Loss=0.00008 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.954 | L2-Norm(final)=3.192 | 3998.2 samples/s | 62.5 steps/s
[Step=21450 Epoch=204.0] | Loss=0.00008 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.948 | L2-Norm(final)=3.192 | 2032.5 samples/s | 31.8 steps/s
[Step=21500 Epoch=204.5] | Loss=0.00007 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.941 | L2-Norm(final)=3.193 | 4083.4 samples/s | 63.8 steps/s
[Step=21550 Epoch=205.0] | Loss=0.00007 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.934 | L2-Norm(final)=3.194 | 2043.6 samples/s | 31.9 steps/s
[Step=21600 Epoch=205.5] | Loss=0.00006 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.928 | L2-Norm(final)=3.195 | 4016.8 samples/s | 62.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32289 | acc=0.8640 | tpr=0.8124 | fpr=0.0240 | 3883.0 samples/s | 15.2 steps/s
Avg test loss: 0.32594, Avg test acc: 0.86237, Avg tpr: 0.81104, Avg fpr: 0.02474, total FA: 193

Testing server on iccad2012
[Step=  50] | Loss=0.41181 | acc=0.8847 | tpr=0.9292 | fpr=0.1161 | 3873.4 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.42611 | acc=0.8801 | tpr=0.9510 | fpr=0.1212 | 7272.8 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.43734 | acc=0.8794 | tpr=0.9553 | fpr=0.1220 | 7280.7 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.43974 | acc=0.8796 | tpr=0.9530 | fpr=0.1217 | 6898.4 samples/s | 26.9 steps/s
[Step= 250] | Loss=0.43772 | acc=0.8792 | tpr=0.9537 | fpr=0.1222 | 7083.4 samples/s | 27.7 steps/s
[Step= 300] | Loss=0.44269 | acc=0.8789 | tpr=0.9520 | fpr=0.1224 | 7047.4 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.44624 | acc=0.8783 | tpr=0.9512 | fpr=0.1230 | 7168.9 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.44757 | acc=0.8787 | tpr=0.9519 | fpr=0.1227 | 7332.1 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.45128 | acc=0.8783 | tpr=0.9508 | fpr=0.1230 | 6716.1 samples/s | 26.2 steps/s
[Step= 500] | Loss=0.44899 | acc=0.8782 | tpr=0.9520 | fpr=0.1231 | 7110.6 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.44642 | acc=0.8790 | tpr=0.9522 | fpr=0.1223 | 13299.5 samples/s | 52.0 steps/s
Avg test loss: 0.44567, Avg test acc: 0.87911, Avg tpr: 0.95246, Avg fpr: 0.12222, total FA: 16970

server round 27/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=105.3] | Loss=0.08215 | Reg=0.00166 | acc=0.9219 | L2-Norm=12.887 | L2-Norm(final)=3.204 | 4493.2 samples/s | 70.2 steps/s
[Step=21650 Epoch=105.6] | Loss=0.01607 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.935 | L2-Norm(final)=3.202 | 3965.9 samples/s | 62.0 steps/s
[Step=21700 Epoch=105.8] | Loss=0.01059 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.951 | L2-Norm(final)=3.206 | 4186.6 samples/s | 65.4 steps/s
[Step=21750 Epoch=106.1] | Loss=0.00900 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.959 | L2-Norm(final)=3.209 | 4230.3 samples/s | 66.1 steps/s
[Step=21800 Epoch=106.3] | Loss=0.00762 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.964 | L2-Norm(final)=3.212 | 5771.2 samples/s | 90.2 steps/s
[Step=21850 Epoch=106.5] | Loss=0.00668 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.968 | L2-Norm(final)=3.216 | 1877.7 samples/s | 29.3 steps/s
[Step=21900 Epoch=106.8] | Loss=0.00596 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.971 | L2-Norm(final)=3.219 | 4260.5 samples/s | 66.6 steps/s
[Step=21950 Epoch=107.0] | Loss=0.00557 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.974 | L2-Norm(final)=3.221 | 4174.7 samples/s | 65.2 steps/s
[Step=22000 Epoch=107.3] | Loss=0.00533 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.976 | L2-Norm(final)=3.224 | 5361.6 samples/s | 83.8 steps/s
[Step=22050 Epoch=107.5] | Loss=0.00501 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.977 | L2-Norm(final)=3.226 | 1933.7 samples/s | 30.2 steps/s
[Step=22100 Epoch=107.8] | Loss=0.00479 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.979 | L2-Norm(final)=3.228 | 4125.3 samples/s | 64.5 steps/s
[Step=22150 Epoch=108.0] | Loss=0.00451 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.980 | L2-Norm(final)=3.230 | 4209.5 samples/s | 65.8 steps/s
[Step=22200 Epoch=108.3] | Loss=0.00446 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.981 | L2-Norm(final)=3.232 | 4927.3 samples/s | 77.0 steps/s
[Step=22250 Epoch=108.5] | Loss=0.00425 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.983 | L2-Norm(final)=3.234 | 1975.7 samples/s | 30.9 steps/s
[Step=22300 Epoch=108.7] | Loss=0.00412 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.984 | L2-Norm(final)=3.236 | 4268.6 samples/s | 66.7 steps/s
[Step=22350 Epoch=109.0] | Loss=0.00401 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.985 | L2-Norm(final)=3.238 | 4204.1 samples/s | 65.7 steps/s
[Step=22400 Epoch=109.2] | Loss=0.00405 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.985 | L2-Norm(final)=3.239 | 4654.7 samples/s | 72.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step22400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=105.4] | Loss=0.07937 | Reg=0.00166 | acc=0.9688 | L2-Norm=12.887 | L2-Norm(final)=3.204 | 4345.8 samples/s | 67.9 steps/s
[Step=21650 Epoch=105.6] | Loss=0.01248 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.933 | L2-Norm(final)=3.207 | 3897.5 samples/s | 60.9 steps/s
[Step=21700 Epoch=105.9] | Loss=0.01177 | Reg=0.00168 | acc=0.9688 | L2-Norm=12.953 | L2-Norm(final)=3.204 | 4209.5 samples/s | 65.8 steps/s
[Step=21750 Epoch=106.1] | Loss=0.00922 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.964 | L2-Norm(final)=3.205 | 4171.1 samples/s | 65.2 steps/s
[Step=21800 Epoch=106.4] | Loss=0.00787 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.971 | L2-Norm(final)=3.207 | 5759.9 samples/s | 90.0 steps/s
[Step=21850 Epoch=106.6] | Loss=0.00677 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.977 | L2-Norm(final)=3.210 | 1881.1 samples/s | 29.4 steps/s
[Step=21900 Epoch=106.9] | Loss=0.00612 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.981 | L2-Norm(final)=3.213 | 4221.2 samples/s | 66.0 steps/s
[Step=21950 Epoch=107.1] | Loss=0.00570 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.984 | L2-Norm(final)=3.215 | 4209.1 samples/s | 65.8 steps/s
[Step=22000 Epoch=107.3] | Loss=0.00523 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.986 | L2-Norm(final)=3.218 | 5581.9 samples/s | 87.2 steps/s
[Step=22050 Epoch=107.6] | Loss=0.00491 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.988 | L2-Norm(final)=3.220 | 1900.1 samples/s | 29.7 steps/s
[Step=22100 Epoch=107.8] | Loss=0.00484 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.990 | L2-Norm(final)=3.223 | 4205.0 samples/s | 65.7 steps/s
[Step=22150 Epoch=108.1] | Loss=0.00471 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.992 | L2-Norm(final)=3.224 | 4152.3 samples/s | 64.9 steps/s
[Step=22200 Epoch=108.3] | Loss=0.00450 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.993 | L2-Norm(final)=3.226 | 5105.8 samples/s | 79.8 steps/s
[Step=22250 Epoch=108.6] | Loss=0.00438 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.994 | L2-Norm(final)=3.228 | 1926.0 samples/s | 30.1 steps/s
[Step=22300 Epoch=108.8] | Loss=0.00420 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.995 | L2-Norm(final)=3.230 | 4158.9 samples/s | 65.0 steps/s
[Step=22350 Epoch=109.1] | Loss=0.00411 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.996 | L2-Norm(final)=3.231 | 4166.8 samples/s | 65.1 steps/s
[Step=22400 Epoch=109.3] | Loss=0.00410 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.997 | L2-Norm(final)=3.233 | 4791.7 samples/s | 74.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step22400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=204.7] | Loss=0.03288 | Reg=0.00166 | acc=0.9688 | L2-Norm=12.887 | L2-Norm(final)=3.203 | 4505.6 samples/s | 70.4 steps/s
[Step=21650 Epoch=205.2] | Loss=0.00434 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.967 | L2-Norm(final)=3.195 | 3584.0 samples/s | 56.0 steps/s
[Step=21700 Epoch=205.6] | Loss=0.00221 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.984 | L2-Norm(final)=3.196 | 5411.3 samples/s | 84.6 steps/s
[Step=21750 Epoch=206.1] | Loss=0.00148 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.987 | L2-Norm(final)=3.197 | 1799.9 samples/s | 28.1 steps/s
[Step=21800 Epoch=206.6] | Loss=0.00111 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.985 | L2-Norm(final)=3.198 | 5116.6 samples/s | 79.9 steps/s
[Step=21850 Epoch=207.0] | Loss=0.00089 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.982 | L2-Norm(final)=3.199 | 1854.9 samples/s | 29.0 steps/s
[Step=21900 Epoch=207.5] | Loss=0.00075 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.979 | L2-Norm(final)=3.200 | 4679.3 samples/s | 73.1 steps/s
[Step=21950 Epoch=208.0] | Loss=0.00064 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.975 | L2-Norm(final)=3.201 | 1908.9 samples/s | 29.8 steps/s
[Step=22000 Epoch=208.5] | Loss=0.00056 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.970 | L2-Norm(final)=3.202 | 4302.8 samples/s | 67.2 steps/s
[Step=22050 Epoch=208.9] | Loss=0.00050 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.966 | L2-Norm(final)=3.202 | 1962.5 samples/s | 30.7 steps/s
[Step=22100 Epoch=209.4] | Loss=0.00045 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=3.203 | 4134.8 samples/s | 64.6 steps/s
[Step=22150 Epoch=209.9] | Loss=0.00041 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.957 | L2-Norm(final)=3.204 | 2019.4 samples/s | 31.6 steps/s
[Step=22200 Epoch=210.4] | Loss=0.00038 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.952 | L2-Norm(final)=3.205 | 4108.9 samples/s | 64.2 steps/s
[Step=22250 Epoch=210.8] | Loss=0.00035 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.947 | L2-Norm(final)=3.206 | 2058.9 samples/s | 32.2 steps/s
[Step=22300 Epoch=211.3] | Loss=0.00032 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.942 | L2-Norm(final)=3.206 | 4160.4 samples/s | 65.0 steps/s
[Step=22350 Epoch=211.8] | Loss=0.00030 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.937 | L2-Norm(final)=3.207 | 2085.4 samples/s | 32.6 steps/s
[Step=22400 Epoch=212.3] | Loss=0.00028 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.932 | L2-Norm(final)=3.208 | 4102.7 samples/s | 64.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step22400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=205.5] | Loss=0.02292 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.887 | L2-Norm(final)=3.203 | 4193.7 samples/s | 65.5 steps/s
[Step=21650 Epoch=205.9] | Loss=0.00327 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.948 | L2-Norm(final)=3.193 | 4008.3 samples/s | 62.6 steps/s
[Step=21700 Epoch=206.4] | Loss=0.00183 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.962 | L2-Norm(final)=3.194 | 5587.7 samples/s | 87.3 steps/s
[Step=21750 Epoch=206.9] | Loss=0.00124 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.966 | L2-Norm(final)=3.197 | 1802.7 samples/s | 28.2 steps/s
[Step=21800 Epoch=207.4] | Loss=0.00093 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.967 | L2-Norm(final)=3.198 | 5115.5 samples/s | 79.9 steps/s
[Step=21850 Epoch=207.8] | Loss=0.00075 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.965 | L2-Norm(final)=3.200 | 1866.8 samples/s | 29.2 steps/s
[Step=21900 Epoch=208.3] | Loss=0.00062 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.963 | L2-Norm(final)=3.201 | 4705.4 samples/s | 73.5 steps/s
[Step=21950 Epoch=208.8] | Loss=0.00054 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.959 | L2-Norm(final)=3.201 | 1916.4 samples/s | 29.9 steps/s
[Step=22000 Epoch=209.3] | Loss=0.00047 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.956 | L2-Norm(final)=3.202 | 4444.4 samples/s | 69.4 steps/s
[Step=22050 Epoch=209.8] | Loss=0.00042 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.952 | L2-Norm(final)=3.203 | 1969.1 samples/s | 30.8 steps/s
[Step=22100 Epoch=210.2] | Loss=0.00038 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.948 | L2-Norm(final)=3.203 | 4189.3 samples/s | 65.5 steps/s
[Step=22150 Epoch=210.7] | Loss=0.00034 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.944 | L2-Norm(final)=3.204 | 2044.3 samples/s | 31.9 steps/s
[Step=22200 Epoch=211.2] | Loss=0.00032 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.940 | L2-Norm(final)=3.204 | 4137.6 samples/s | 64.6 steps/s
[Step=22250 Epoch=211.7] | Loss=0.00029 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.935 | L2-Norm(final)=3.205 | 2074.6 samples/s | 32.4 steps/s
[Step=22300 Epoch=212.1] | Loss=0.00027 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.931 | L2-Norm(final)=3.205 | 4242.9 samples/s | 66.3 steps/s
[Step=22350 Epoch=212.6] | Loss=0.00025 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.926 | L2-Norm(final)=3.206 | 2084.8 samples/s | 32.6 steps/s
[Step=22400 Epoch=213.1] | Loss=0.00024 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.922 | L2-Norm(final)=3.206 | 4040.3 samples/s | 63.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.52721 | acc=0.7759 | tpr=0.6805 | fpr=0.0168 | 3939.4 samples/s | 15.4 steps/s
Avg test loss: 0.53327, Avg test acc: 0.77763, Avg tpr: 0.68404, Avg fpr: 0.01654, total FA: 129

Testing server on iccad2012
[Step=  50] | Loss=0.24984 | acc=0.9353 | tpr=0.9248 | fpr=0.0645 | 3896.1 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.25939 | acc=0.9335 | tpr=0.9467 | fpr=0.0668 | 7253.7 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.26888 | acc=0.9319 | tpr=0.9467 | fpr=0.0684 | 7089.9 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.26973 | acc=0.9325 | tpr=0.9443 | fpr=0.0677 | 7012.9 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.26738 | acc=0.9328 | tpr=0.9467 | fpr=0.0674 | 7228.3 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.27138 | acc=0.9325 | tpr=0.9462 | fpr=0.0677 | 7127.2 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.27403 | acc=0.9320 | tpr=0.9468 | fpr=0.0683 | 7080.7 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.27564 | acc=0.9320 | tpr=0.9469 | fpr=0.0683 | 7238.5 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.27917 | acc=0.9315 | tpr=0.9455 | fpr=0.0688 | 7194.1 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.27741 | acc=0.9317 | tpr=0.9463 | fpr=0.0686 | 7004.3 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.27572 | acc=0.9322 | tpr=0.9479 | fpr=0.0681 | 13407.9 samples/s | 52.4 steps/s
Avg test loss: 0.27521, Avg test acc: 0.93221, Avg tpr: 0.94810, Avg fpr: 0.06807, total FA: 9452

server round 28/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=109.2] | Loss=0.15112 | Reg=0.00165 | acc=0.9062 | L2-Norm=12.858 | L2-Norm(final)=3.235 | 4209.8 samples/s | 65.8 steps/s
[Step=22450 Epoch=109.5] | Loss=0.02474 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.925 | L2-Norm(final)=3.222 | 4323.7 samples/s | 67.6 steps/s
[Step=22500 Epoch=109.7] | Loss=0.01553 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.946 | L2-Norm(final)=3.224 | 4231.8 samples/s | 66.1 steps/s
[Step=22550 Epoch=110.0] | Loss=0.01174 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.956 | L2-Norm(final)=3.228 | 4272.7 samples/s | 66.8 steps/s
[Step=22600 Epoch=110.2] | Loss=0.00974 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.964 | L2-Norm(final)=3.233 | 5758.5 samples/s | 90.0 steps/s
[Step=22650 Epoch=110.4] | Loss=0.00813 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.970 | L2-Norm(final)=3.237 | 1863.7 samples/s | 29.1 steps/s
[Step=22700 Epoch=110.7] | Loss=0.00731 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.974 | L2-Norm(final)=3.241 | 4216.3 samples/s | 65.9 steps/s
[Step=22750 Epoch=110.9] | Loss=0.00682 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.977 | L2-Norm(final)=3.244 | 4305.4 samples/s | 67.3 steps/s
[Step=22800 Epoch=111.2] | Loss=0.00638 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.979 | L2-Norm(final)=3.246 | 5431.2 samples/s | 84.9 steps/s
[Step=22850 Epoch=111.4] | Loss=0.00583 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.981 | L2-Norm(final)=3.249 | 1918.1 samples/s | 30.0 steps/s
[Step=22900 Epoch=111.7] | Loss=0.00551 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.982 | L2-Norm(final)=3.251 | 4178.4 samples/s | 65.3 steps/s
[Step=22950 Epoch=111.9] | Loss=0.00533 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.984 | L2-Norm(final)=3.253 | 4236.6 samples/s | 66.2 steps/s
[Step=23000 Epoch=112.2] | Loss=0.00514 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.985 | L2-Norm(final)=3.255 | 5044.4 samples/s | 78.8 steps/s
[Step=23050 Epoch=112.4] | Loss=0.00495 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.986 | L2-Norm(final)=3.257 | 2009.7 samples/s | 31.4 steps/s
[Step=23100 Epoch=112.6] | Loss=0.00471 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.986 | L2-Norm(final)=3.258 | 4310.6 samples/s | 67.4 steps/s
[Step=23150 Epoch=112.9] | Loss=0.00457 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.987 | L2-Norm(final)=3.260 | 4144.5 samples/s | 64.8 steps/s
[Step=23200 Epoch=113.1] | Loss=0.00458 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.988 | L2-Norm(final)=3.262 | 4574.4 samples/s | 71.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step23200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=109.3] | Loss=0.38779 | Reg=0.00165 | acc=0.8281 | L2-Norm=12.858 | L2-Norm(final)=3.234 | 4604.0 samples/s | 71.9 steps/s
[Step=22450 Epoch=109.5] | Loss=0.02581 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.930 | L2-Norm(final)=3.218 | 4001.0 samples/s | 62.5 steps/s
[Step=22500 Epoch=109.8] | Loss=0.01615 | Reg=0.00168 | acc=0.9844 | L2-Norm=12.951 | L2-Norm(final)=3.219 | 4167.5 samples/s | 65.1 steps/s
[Step=22550 Epoch=110.0] | Loss=0.01203 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.961 | L2-Norm(final)=3.223 | 4250.7 samples/s | 66.4 steps/s
[Step=22600 Epoch=110.3] | Loss=0.01018 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.967 | L2-Norm(final)=3.226 | 5790.0 samples/s | 90.5 steps/s
[Step=22650 Epoch=110.5] | Loss=0.00875 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.972 | L2-Norm(final)=3.230 | 1880.8 samples/s | 29.4 steps/s
[Step=22700 Epoch=110.8] | Loss=0.00758 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.975 | L2-Norm(final)=3.233 | 4236.7 samples/s | 66.2 steps/s
[Step=22750 Epoch=111.0] | Loss=0.00692 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.978 | L2-Norm(final)=3.236 | 4179.7 samples/s | 65.3 steps/s
[Step=22800 Epoch=111.3] | Loss=0.00647 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.980 | L2-Norm(final)=3.239 | 5458.4 samples/s | 85.3 steps/s
[Step=22850 Epoch=111.5] | Loss=0.00599 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.982 | L2-Norm(final)=3.241 | 1928.2 samples/s | 30.1 steps/s
[Step=22900 Epoch=111.7] | Loss=0.00563 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.983 | L2-Norm(final)=3.243 | 4261.6 samples/s | 66.6 steps/s
[Step=22950 Epoch=112.0] | Loss=0.00554 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.984 | L2-Norm(final)=3.245 | 4201.8 samples/s | 65.7 steps/s
[Step=23000 Epoch=112.2] | Loss=0.00537 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.985 | L2-Norm(final)=3.247 | 4998.6 samples/s | 78.1 steps/s
[Step=23050 Epoch=112.5] | Loss=0.00504 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.986 | L2-Norm(final)=3.248 | 1979.0 samples/s | 30.9 steps/s
[Step=23100 Epoch=112.7] | Loss=0.00482 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.987 | L2-Norm(final)=3.250 | 4230.8 samples/s | 66.1 steps/s
[Step=23150 Epoch=113.0] | Loss=0.00461 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.988 | L2-Norm(final)=3.252 | 4219.1 samples/s | 65.9 steps/s
[Step=23200 Epoch=113.2] | Loss=0.00450 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.988 | L2-Norm(final)=3.253 | 4936.0 samples/s | 77.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step23200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=212.3] | Loss=0.00526 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.858 | L2-Norm(final)=3.236 | 4078.9 samples/s | 63.7 steps/s
[Step=22450 Epoch=212.7] | Loss=0.00108 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=3.241 | 4016.4 samples/s | 62.8 steps/s
[Step=22500 Epoch=213.2] | Loss=0.00057 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.890 | L2-Norm(final)=3.246 | 5589.8 samples/s | 87.3 steps/s
[Step=22550 Epoch=213.7] | Loss=0.00038 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.887 | L2-Norm(final)=3.248 | 1813.0 samples/s | 28.3 steps/s
[Step=22600 Epoch=214.2] | Loss=0.00029 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.883 | L2-Norm(final)=3.250 | 5051.3 samples/s | 78.9 steps/s
[Step=22650 Epoch=214.6] | Loss=0.00023 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.878 | L2-Norm(final)=3.251 | 1855.3 samples/s | 29.0 steps/s
[Step=22700 Epoch=215.1] | Loss=0.00020 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.873 | L2-Norm(final)=3.253 | 4697.6 samples/s | 73.4 steps/s
[Step=22750 Epoch=215.6] | Loss=0.00017 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.868 | L2-Norm(final)=3.254 | 1929.6 samples/s | 30.2 steps/s
[Step=22800 Epoch=216.0] | Loss=0.00015 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.862 | L2-Norm(final)=3.254 | 4325.8 samples/s | 67.6 steps/s
[Step=22850 Epoch=216.5] | Loss=0.00013 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.857 | L2-Norm(final)=3.255 | 2008.1 samples/s | 31.4 steps/s
[Step=22900 Epoch=217.0] | Loss=0.00012 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.851 | L2-Norm(final)=3.256 | 4109.3 samples/s | 64.2 steps/s
[Step=22950 Epoch=217.5] | Loss=0.00011 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.846 | L2-Norm(final)=3.257 | 2036.3 samples/s | 31.8 steps/s
[Step=23000 Epoch=217.9] | Loss=0.00010 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.840 | L2-Norm(final)=3.257 | 4096.8 samples/s | 64.0 steps/s
[Step=23050 Epoch=218.4] | Loss=0.00009 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.834 | L2-Norm(final)=3.258 | 2059.2 samples/s | 32.2 steps/s
[Step=23100 Epoch=218.9] | Loss=0.00009 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.829 | L2-Norm(final)=3.259 | 4102.6 samples/s | 64.1 steps/s
[Step=23150 Epoch=219.4] | Loss=0.00008 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.823 | L2-Norm(final)=3.259 | 2088.5 samples/s | 32.6 steps/s
[Step=23200 Epoch=219.8] | Loss=0.00008 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.817 | L2-Norm(final)=3.260 | 4108.2 samples/s | 64.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step23200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=213.1] | Loss=0.00896 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.858 | L2-Norm(final)=3.236 | 4452.7 samples/s | 69.6 steps/s
[Step=22450 Epoch=213.6] | Loss=0.00047 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.884 | L2-Norm(final)=3.244 | 3662.8 samples/s | 57.2 steps/s
[Step=22500 Epoch=214.0] | Loss=0.00024 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.883 | L2-Norm(final)=3.247 | 5735.6 samples/s | 89.6 steps/s
[Step=22550 Epoch=214.5] | Loss=0.00016 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.879 | L2-Norm(final)=3.248 | 1813.7 samples/s | 28.3 steps/s
[Step=22600 Epoch=215.0] | Loss=0.00012 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.873 | L2-Norm(final)=3.248 | 5177.1 samples/s | 80.9 steps/s
[Step=22650 Epoch=215.5] | Loss=0.00010 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.868 | L2-Norm(final)=3.249 | 1868.3 samples/s | 29.2 steps/s
[Step=22700 Epoch=215.9] | Loss=0.00008 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.862 | L2-Norm(final)=3.249 | 4799.0 samples/s | 75.0 steps/s
[Step=22750 Epoch=216.4] | Loss=0.00007 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.856 | L2-Norm(final)=3.250 | 1920.6 samples/s | 30.0 steps/s
[Step=22800 Epoch=216.9] | Loss=0.00006 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.851 | L2-Norm(final)=3.250 | 4415.9 samples/s | 69.0 steps/s
[Step=22850 Epoch=217.4] | Loss=0.00006 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.845 | L2-Norm(final)=3.251 | 1995.8 samples/s | 31.2 steps/s
[Step=22900 Epoch=217.8] | Loss=0.00005 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.839 | L2-Norm(final)=3.251 | 4151.5 samples/s | 64.9 steps/s
[Step=22950 Epoch=218.3] | Loss=0.00005 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.833 | L2-Norm(final)=3.252 | 2067.7 samples/s | 32.3 steps/s
[Step=23000 Epoch=218.8] | Loss=0.00004 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.827 | L2-Norm(final)=3.252 | 4230.4 samples/s | 66.1 steps/s
[Step=23050 Epoch=219.3] | Loss=0.00004 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.821 | L2-Norm(final)=3.252 | 2091.8 samples/s | 32.7 steps/s
[Step=23100 Epoch=219.7] | Loss=0.00004 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.815 | L2-Norm(final)=3.253 | 4124.0 samples/s | 64.4 steps/s
[Step=23150 Epoch=220.2] | Loss=0.00004 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.809 | L2-Norm(final)=3.253 | 2066.2 samples/s | 32.3 steps/s
[Step=23200 Epoch=220.7] | Loss=0.00003 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.803 | L2-Norm(final)=3.254 | 4104.5 samples/s | 64.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32216 | acc=0.8625 | tpr=0.8093 | fpr=0.0221 | 3953.8 samples/s | 15.4 steps/s
Avg test loss: 0.32662, Avg test acc: 0.86149, Avg tpr: 0.80888, Avg fpr: 0.02282, total FA: 178

Testing server on iccad2012
[Step=  50] | Loss=0.40979 | acc=0.8754 | tpr=0.9248 | fpr=0.1255 | 3862.2 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.42440 | acc=0.8714 | tpr=0.9467 | fpr=0.1300 | 7071.2 samples/s | 27.6 steps/s
[Step= 150] | Loss=0.43332 | acc=0.8711 | tpr=0.9510 | fpr=0.1304 | 7157.9 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.43440 | acc=0.8723 | tpr=0.9497 | fpr=0.1291 | 7284.0 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.43193 | acc=0.8721 | tpr=0.9528 | fpr=0.1294 | 6991.0 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.43590 | acc=0.8721 | tpr=0.9513 | fpr=0.1293 | 7212.2 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.43907 | acc=0.8719 | tpr=0.9518 | fpr=0.1296 | 7134.6 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.44023 | acc=0.8721 | tpr=0.9519 | fpr=0.1294 | 7136.8 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.44352 | acc=0.8722 | tpr=0.9518 | fpr=0.1293 | 7256.4 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.44152 | acc=0.8724 | tpr=0.9520 | fpr=0.1290 | 6994.5 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.43875 | acc=0.8732 | tpr=0.9526 | fpr=0.1283 | 13702.3 samples/s | 53.5 steps/s
Avg test loss: 0.43808, Avg test acc: 0.87326, Avg tpr: 0.95285, Avg fpr: 0.12818, total FA: 17798

server round 29/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=113.1] | Loss=0.05645 | Reg=0.00164 | acc=0.9688 | L2-Norm=12.810 | L2-Norm(final)=3.272 | 4208.7 samples/s | 65.8 steps/s
[Step=23250 Epoch=113.4] | Loss=0.01572 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.862 | L2-Norm(final)=3.272 | 4163.3 samples/s | 65.1 steps/s
[Step=23300 Epoch=113.6] | Loss=0.01187 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.880 | L2-Norm(final)=3.275 | 4318.3 samples/s | 67.5 steps/s
[Step=23350 Epoch=113.9] | Loss=0.00908 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.889 | L2-Norm(final)=3.278 | 4270.5 samples/s | 66.7 steps/s
[Step=23400 Epoch=114.1] | Loss=0.00735 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.895 | L2-Norm(final)=3.282 | 5683.4 samples/s | 88.8 steps/s
[Step=23450 Epoch=114.3] | Loss=0.00666 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=3.286 | 1888.2 samples/s | 29.5 steps/s
[Step=23500 Epoch=114.6] | Loss=0.00613 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.903 | L2-Norm(final)=3.289 | 4210.4 samples/s | 65.8 steps/s
[Step=23550 Epoch=114.8] | Loss=0.00593 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=3.292 | 4218.3 samples/s | 65.9 steps/s
[Step=23600 Epoch=115.1] | Loss=0.00567 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.907 | L2-Norm(final)=3.294 | 5358.9 samples/s | 83.7 steps/s
[Step=23650 Epoch=115.3] | Loss=0.00531 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.909 | L2-Norm(final)=3.296 | 1935.9 samples/s | 30.2 steps/s
[Step=23700 Epoch=115.6] | Loss=0.00498 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.911 | L2-Norm(final)=3.298 | 4263.6 samples/s | 66.6 steps/s
[Step=23750 Epoch=115.8] | Loss=0.00482 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.912 | L2-Norm(final)=3.300 | 4262.3 samples/s | 66.6 steps/s
[Step=23800 Epoch=116.1] | Loss=0.00467 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.914 | L2-Norm(final)=3.302 | 5029.2 samples/s | 78.6 steps/s
[Step=23850 Epoch=116.3] | Loss=0.00446 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.915 | L2-Norm(final)=3.304 | 1990.6 samples/s | 31.1 steps/s
[Step=23900 Epoch=116.5] | Loss=0.00435 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.916 | L2-Norm(final)=3.306 | 4213.3 samples/s | 65.8 steps/s
[Step=23950 Epoch=116.8] | Loss=0.00421 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.917 | L2-Norm(final)=3.308 | 4277.9 samples/s | 66.8 steps/s
[Step=24000 Epoch=117.0] | Loss=0.00410 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.918 | L2-Norm(final)=3.310 | 4671.5 samples/s | 73.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step24000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=113.2] | Loss=0.07241 | Reg=0.00164 | acc=0.9375 | L2-Norm=12.810 | L2-Norm(final)=3.273 | 4523.1 samples/s | 70.7 steps/s
[Step=23250 Epoch=113.4] | Loss=0.01239 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.859 | L2-Norm(final)=3.272 | 3959.7 samples/s | 61.9 steps/s
[Step=23300 Epoch=113.7] | Loss=0.00923 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.872 | L2-Norm(final)=3.274 | 4241.4 samples/s | 66.3 steps/s
[Step=23350 Epoch=113.9] | Loss=0.00768 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.880 | L2-Norm(final)=3.277 | 4274.0 samples/s | 66.8 steps/s
[Step=23400 Epoch=114.2] | Loss=0.00684 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.886 | L2-Norm(final)=3.281 | 5908.2 samples/s | 92.3 steps/s
[Step=23450 Epoch=114.4] | Loss=0.00612 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.891 | L2-Norm(final)=3.284 | 1909.0 samples/s | 29.8 steps/s
[Step=23500 Epoch=114.7] | Loss=0.00561 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.894 | L2-Norm(final)=3.287 | 4284.2 samples/s | 66.9 steps/s
[Step=23550 Epoch=114.9] | Loss=0.00553 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.896 | L2-Norm(final)=3.288 | 4226.6 samples/s | 66.0 steps/s
[Step=23600 Epoch=115.2] | Loss=0.00533 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.898 | L2-Norm(final)=3.290 | 5465.8 samples/s | 85.4 steps/s
[Step=23650 Epoch=115.4] | Loss=0.00496 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.899 | L2-Norm(final)=3.291 | 1890.4 samples/s | 29.5 steps/s
[Step=23700 Epoch=115.6] | Loss=0.00477 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=3.293 | 4113.2 samples/s | 64.3 steps/s
[Step=23750 Epoch=115.9] | Loss=0.00452 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.902 | L2-Norm(final)=3.294 | 4235.7 samples/s | 66.2 steps/s
[Step=23800 Epoch=116.1] | Loss=0.00448 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.903 | L2-Norm(final)=3.296 | 5016.0 samples/s | 78.4 steps/s
[Step=23850 Epoch=116.4] | Loss=0.00442 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=3.297 | 1930.7 samples/s | 30.2 steps/s
[Step=23900 Epoch=116.6] | Loss=0.00425 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.905 | L2-Norm(final)=3.298 | 4184.5 samples/s | 65.4 steps/s
[Step=23950 Epoch=116.9] | Loss=0.00406 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.906 | L2-Norm(final)=3.300 | 4190.7 samples/s | 65.5 steps/s
[Step=24000 Epoch=117.1] | Loss=0.00390 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.907 | L2-Norm(final)=3.302 | 4854.3 samples/s | 75.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step24000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=219.8] | Loss=0.07681 | Reg=0.00164 | acc=0.9375 | L2-Norm=12.810 | L2-Norm(final)=3.273 | 4403.4 samples/s | 68.8 steps/s
[Step=23250 Epoch=220.3] | Loss=0.00234 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.873 | L2-Norm(final)=3.277 | 3782.6 samples/s | 59.1 steps/s
[Step=23300 Epoch=220.8] | Loss=0.00119 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.883 | L2-Norm(final)=3.277 | 5598.9 samples/s | 87.5 steps/s
[Step=23350 Epoch=221.3] | Loss=0.00080 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.883 | L2-Norm(final)=3.278 | 1801.8 samples/s | 28.2 steps/s
[Step=23400 Epoch=221.7] | Loss=0.00060 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.880 | L2-Norm(final)=3.279 | 5033.4 samples/s | 78.6 steps/s
[Step=23450 Epoch=222.2] | Loss=0.00048 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.877 | L2-Norm(final)=3.280 | 1845.3 samples/s | 28.8 steps/s
[Step=23500 Epoch=222.7] | Loss=0.00040 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.873 | L2-Norm(final)=3.280 | 4691.3 samples/s | 73.3 steps/s
[Step=23550 Epoch=223.2] | Loss=0.00035 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.868 | L2-Norm(final)=3.281 | 1908.3 samples/s | 29.8 steps/s
[Step=23600 Epoch=223.6] | Loss=0.00030 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.864 | L2-Norm(final)=3.282 | 4344.6 samples/s | 67.9 steps/s
[Step=23650 Epoch=224.1] | Loss=0.00027 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.859 | L2-Norm(final)=3.282 | 1978.0 samples/s | 30.9 steps/s
[Step=23700 Epoch=224.6] | Loss=0.00024 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.855 | L2-Norm(final)=3.283 | 4035.3 samples/s | 63.1 steps/s
[Step=23750 Epoch=225.1] | Loss=0.00022 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.850 | L2-Norm(final)=3.283 | 2007.4 samples/s | 31.4 steps/s
[Step=23800 Epoch=225.5] | Loss=0.00020 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.845 | L2-Norm(final)=3.284 | 4025.3 samples/s | 62.9 steps/s
[Step=23850 Epoch=226.0] | Loss=0.00019 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.840 | L2-Norm(final)=3.285 | 2027.3 samples/s | 31.7 steps/s
[Step=23900 Epoch=226.5] | Loss=0.00018 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.835 | L2-Norm(final)=3.285 | 4006.7 samples/s | 62.6 steps/s
[Step=23950 Epoch=226.9] | Loss=0.00016 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.830 | L2-Norm(final)=3.286 | 2038.8 samples/s | 31.9 steps/s
[Step=24000 Epoch=227.4] | Loss=0.00015 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.825 | L2-Norm(final)=3.286 | 3938.6 samples/s | 61.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step24000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=220.7] | Loss=0.09575 | Reg=0.00164 | acc=0.9531 | L2-Norm=12.810 | L2-Norm(final)=3.272 | 4470.5 samples/s | 69.9 steps/s
[Step=23250 Epoch=221.2] | Loss=0.00294 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=3.276 | 3593.2 samples/s | 56.1 steps/s
[Step=23300 Epoch=221.6] | Loss=0.00148 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.915 | L2-Norm(final)=3.276 | 5633.9 samples/s | 88.0 steps/s
[Step=23350 Epoch=222.1] | Loss=0.00099 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.916 | L2-Norm(final)=3.277 | 1810.0 samples/s | 28.3 steps/s
[Step=23400 Epoch=222.6] | Loss=0.00074 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.914 | L2-Norm(final)=3.277 | 5204.1 samples/s | 81.3 steps/s
[Step=23450 Epoch=223.1] | Loss=0.00060 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.911 | L2-Norm(final)=3.278 | 1855.0 samples/s | 29.0 steps/s
[Step=23500 Epoch=223.5] | Loss=0.00050 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.907 | L2-Norm(final)=3.278 | 4899.6 samples/s | 76.6 steps/s
[Step=23550 Epoch=224.0] | Loss=0.00043 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.903 | L2-Norm(final)=3.279 | 1907.9 samples/s | 29.8 steps/s
[Step=23600 Epoch=224.5] | Loss=0.00037 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.898 | L2-Norm(final)=3.279 | 4489.4 samples/s | 70.1 steps/s
[Step=23650 Epoch=225.0] | Loss=0.00033 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.894 | L2-Norm(final)=3.279 | 1980.7 samples/s | 30.9 steps/s
[Step=23700 Epoch=225.4] | Loss=0.00030 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.889 | L2-Norm(final)=3.280 | 4097.2 samples/s | 64.0 steps/s
[Step=23750 Epoch=225.9] | Loss=0.00027 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.884 | L2-Norm(final)=3.280 | 2035.5 samples/s | 31.8 steps/s
[Step=23800 Epoch=226.4] | Loss=0.00025 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.879 | L2-Norm(final)=3.280 | 4006.6 samples/s | 62.6 steps/s
[Step=23850 Epoch=226.9] | Loss=0.00023 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.874 | L2-Norm(final)=3.281 | 2029.7 samples/s | 31.7 steps/s
[Step=23900 Epoch=227.3] | Loss=0.00021 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.869 | L2-Norm(final)=3.281 | 4111.8 samples/s | 64.2 steps/s
[Step=23950 Epoch=227.8] | Loss=0.00020 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.864 | L2-Norm(final)=3.282 | 2063.2 samples/s | 32.2 steps/s
[Step=24000 Epoch=228.3] | Loss=0.00019 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.859 | L2-Norm(final)=3.282 | 4003.6 samples/s | 62.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.57868 | acc=0.7658 | tpr=0.6659 | fpr=0.0173 | 3910.0 samples/s | 15.3 steps/s
Avg test loss: 0.58519, Avg test acc: 0.76533, Avg tpr: 0.66667, Avg fpr: 0.01769, total FA: 138

Testing server on iccad2012
[Step=  50] | Loss=0.27502 | acc=0.9353 | tpr=0.9248 | fpr=0.0645 | 3906.2 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.28346 | acc=0.9339 | tpr=0.9403 | fpr=0.0662 | 7179.8 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.29319 | acc=0.9323 | tpr=0.9409 | fpr=0.0678 | 6989.9 samples/s | 27.3 steps/s
[Step= 200] | Loss=0.29517 | acc=0.9327 | tpr=0.9388 | fpr=0.0675 | 7163.1 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.29230 | acc=0.9330 | tpr=0.9415 | fpr=0.0672 | 7235.4 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.29616 | acc=0.9329 | tpr=0.9404 | fpr=0.0672 | 7243.6 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.29863 | acc=0.9325 | tpr=0.9405 | fpr=0.0677 | 7036.3 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.30050 | acc=0.9324 | tpr=0.9415 | fpr=0.0678 | 7227.1 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.30385 | acc=0.9320 | tpr=0.9401 | fpr=0.0682 | 7197.7 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.30182 | acc=0.9321 | tpr=0.9419 | fpr=0.0681 | 7138.5 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.30007 | acc=0.9325 | tpr=0.9431 | fpr=0.0677 | 13402.3 samples/s | 52.4 steps/s
Avg test loss: 0.29949, Avg test acc: 0.93250, Avg tpr: 0.94334, Avg fpr: 0.06769, total FA: 9399

server round 30/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=117.0] | Loss=0.40608 | Reg=0.00163 | acc=0.8125 | L2-Norm=12.784 | L2-Norm(final)=3.310 | 4318.1 samples/s | 67.5 steps/s
[Step=24050 Epoch=117.3] | Loss=0.02940 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.811 | L2-Norm(final)=3.303 | 4073.1 samples/s | 63.6 steps/s
[Step=24100 Epoch=117.5] | Loss=0.01681 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.819 | L2-Norm(final)=3.304 | 4452.8 samples/s | 69.6 steps/s
[Step=24150 Epoch=117.8] | Loss=0.01243 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.824 | L2-Norm(final)=3.306 | 4430.2 samples/s | 69.2 steps/s
[Step=24200 Epoch=118.0] | Loss=0.01010 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.826 | L2-Norm(final)=3.308 | 6029.4 samples/s | 94.2 steps/s
[Step=24250 Epoch=118.2] | Loss=0.00861 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.829 | L2-Norm(final)=3.310 | 1904.0 samples/s | 29.7 steps/s
[Step=24300 Epoch=118.5] | Loss=0.00751 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.830 | L2-Norm(final)=3.312 | 4308.6 samples/s | 67.3 steps/s
[Step=24350 Epoch=118.7] | Loss=0.00682 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.832 | L2-Norm(final)=3.313 | 4366.4 samples/s | 68.2 steps/s
[Step=24400 Epoch=119.0] | Loss=0.00619 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.833 | L2-Norm(final)=3.315 | 5392.4 samples/s | 84.3 steps/s
[Step=24450 Epoch=119.2] | Loss=0.00575 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.834 | L2-Norm(final)=3.317 | 1920.5 samples/s | 30.0 steps/s
[Step=24500 Epoch=119.5] | Loss=0.00548 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.835 | L2-Norm(final)=3.318 | 4246.3 samples/s | 66.3 steps/s
[Step=24550 Epoch=119.7] | Loss=0.00513 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.836 | L2-Norm(final)=3.320 | 4137.0 samples/s | 64.6 steps/s
[Step=24600 Epoch=120.0] | Loss=0.00482 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.836 | L2-Norm(final)=3.321 | 5030.0 samples/s | 78.6 steps/s
[Step=24650 Epoch=120.2] | Loss=0.00457 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.837 | L2-Norm(final)=3.323 | 1972.2 samples/s | 30.8 steps/s
[Step=24700 Epoch=120.4] | Loss=0.00432 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.838 | L2-Norm(final)=3.324 | 4271.3 samples/s | 66.7 steps/s
[Step=24750 Epoch=120.7] | Loss=0.00418 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.838 | L2-Norm(final)=3.326 | 4246.4 samples/s | 66.4 steps/s
[Step=24800 Epoch=120.9] | Loss=0.00407 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.839 | L2-Norm(final)=3.327 | 4623.7 samples/s | 72.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step24800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=117.1] | Loss=0.20745 | Reg=0.00163 | acc=0.8594 | L2-Norm=12.784 | L2-Norm(final)=3.310 | 4401.5 samples/s | 68.8 steps/s
[Step=24050 Epoch=117.4] | Loss=0.03088 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.819 | L2-Norm(final)=3.301 | 4037.4 samples/s | 63.1 steps/s
[Step=24100 Epoch=117.6] | Loss=0.01744 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.829 | L2-Norm(final)=3.301 | 4306.6 samples/s | 67.3 steps/s
[Step=24150 Epoch=117.8] | Loss=0.01286 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.834 | L2-Norm(final)=3.304 | 4276.2 samples/s | 66.8 steps/s
[Step=24200 Epoch=118.1] | Loss=0.01016 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.837 | L2-Norm(final)=3.306 | 5891.1 samples/s | 92.0 steps/s
[Step=24250 Epoch=118.3] | Loss=0.00863 | Reg=0.00165 | acc=0.9844 | L2-Norm=12.839 | L2-Norm(final)=3.308 | 1889.9 samples/s | 29.5 steps/s
[Step=24300 Epoch=118.6] | Loss=0.00750 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.841 | L2-Norm(final)=3.310 | 4306.8 samples/s | 67.3 steps/s
[Step=24350 Epoch=118.8] | Loss=0.00677 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.842 | L2-Norm(final)=3.312 | 4274.5 samples/s | 66.8 steps/s
[Step=24400 Epoch=119.1] | Loss=0.00613 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.844 | L2-Norm(final)=3.314 | 5380.1 samples/s | 84.1 steps/s
[Step=24450 Epoch=119.3] | Loss=0.00563 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.845 | L2-Norm(final)=3.315 | 1947.1 samples/s | 30.4 steps/s
[Step=24500 Epoch=119.5] | Loss=0.00519 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.846 | L2-Norm(final)=3.317 | 4248.9 samples/s | 66.4 steps/s
[Step=24550 Epoch=119.8] | Loss=0.00485 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.847 | L2-Norm(final)=3.318 | 4365.9 samples/s | 68.2 steps/s
[Step=24600 Epoch=120.0] | Loss=0.00471 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.848 | L2-Norm(final)=3.320 | 5160.1 samples/s | 80.6 steps/s
[Step=24650 Epoch=120.3] | Loss=0.00441 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.849 | L2-Norm(final)=3.321 | 1955.4 samples/s | 30.6 steps/s
[Step=24700 Epoch=120.5] | Loss=0.00423 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.849 | L2-Norm(final)=3.322 | 4178.6 samples/s | 65.3 steps/s
[Step=24750 Epoch=120.8] | Loss=0.00405 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.850 | L2-Norm(final)=3.323 | 4194.0 samples/s | 65.5 steps/s
[Step=24800 Epoch=121.0] | Loss=0.00392 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.850 | L2-Norm(final)=3.325 | 4883.1 samples/s | 76.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step24800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=227.4] | Loss=0.01028 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.784 | L2-Norm(final)=3.311 | 4021.8 samples/s | 62.8 steps/s
[Step=24050 Epoch=227.9] | Loss=0.00196 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.798 | L2-Norm(final)=3.319 | 4150.3 samples/s | 64.8 steps/s
[Step=24100 Epoch=228.4] | Loss=0.00099 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.800 | L2-Norm(final)=3.320 | 5511.9 samples/s | 86.1 steps/s
[Step=24150 Epoch=228.8] | Loss=0.00066 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.799 | L2-Norm(final)=3.321 | 1839.2 samples/s | 28.7 steps/s
[Step=24200 Epoch=229.3] | Loss=0.00050 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.797 | L2-Norm(final)=3.321 | 5224.9 samples/s | 81.6 steps/s
[Step=24250 Epoch=229.8] | Loss=0.00040 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.795 | L2-Norm(final)=3.322 | 1886.9 samples/s | 29.5 steps/s
[Step=24300 Epoch=230.3] | Loss=0.00034 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.793 | L2-Norm(final)=3.322 | 4800.8 samples/s | 75.0 steps/s
[Step=24350 Epoch=230.7] | Loss=0.00029 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.790 | L2-Norm(final)=3.323 | 1920.2 samples/s | 30.0 steps/s
[Step=24400 Epoch=231.2] | Loss=0.00026 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.788 | L2-Norm(final)=3.323 | 4360.3 samples/s | 68.1 steps/s
[Step=24450 Epoch=231.7] | Loss=0.00023 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.786 | L2-Norm(final)=3.323 | 1967.5 samples/s | 30.7 steps/s
[Step=24500 Epoch=232.2] | Loss=0.00021 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.783 | L2-Norm(final)=3.324 | 4081.4 samples/s | 63.8 steps/s
[Step=24550 Epoch=232.6] | Loss=0.00019 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.781 | L2-Norm(final)=3.324 | 2031.6 samples/s | 31.7 steps/s
[Step=24600 Epoch=233.1] | Loss=0.00017 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.778 | L2-Norm(final)=3.324 | 4084.5 samples/s | 63.8 steps/s
[Step=24650 Epoch=233.6] | Loss=0.00016 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.775 | L2-Norm(final)=3.325 | 2049.8 samples/s | 32.0 steps/s
[Step=24700 Epoch=234.1] | Loss=0.00015 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.773 | L2-Norm(final)=3.325 | 4153.7 samples/s | 64.9 steps/s
[Step=24750 Epoch=234.5] | Loss=0.00014 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.770 | L2-Norm(final)=3.325 | 2048.9 samples/s | 32.0 steps/s
[Step=24800 Epoch=235.0] | Loss=0.00013 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.767 | L2-Norm(final)=3.325 | 3985.3 samples/s | 62.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step24800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=228.3] | Loss=0.00572 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.784 | L2-Norm(final)=3.311 | 4259.4 samples/s | 66.6 steps/s
[Step=24050 Epoch=228.8] | Loss=0.00070 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.794 | L2-Norm(final)=3.321 | 3911.6 samples/s | 61.1 steps/s
[Step=24100 Epoch=229.3] | Loss=0.00037 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.795 | L2-Norm(final)=3.323 | 5538.4 samples/s | 86.5 steps/s
[Step=24150 Epoch=229.7] | Loss=0.00025 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.794 | L2-Norm(final)=3.325 | 1815.2 samples/s | 28.4 steps/s
[Step=24200 Epoch=230.2] | Loss=0.00019 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.792 | L2-Norm(final)=3.326 | 5074.2 samples/s | 79.3 steps/s
[Step=24250 Epoch=230.7] | Loss=0.00016 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.790 | L2-Norm(final)=3.326 | 1851.4 samples/s | 28.9 steps/s
[Step=24300 Epoch=231.2] | Loss=0.00013 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.788 | L2-Norm(final)=3.327 | 4707.7 samples/s | 73.6 steps/s
[Step=24350 Epoch=231.6] | Loss=0.00011 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.786 | L2-Norm(final)=3.327 | 1912.3 samples/s | 29.9 steps/s
[Step=24400 Epoch=232.1] | Loss=0.00010 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.783 | L2-Norm(final)=3.328 | 4435.8 samples/s | 69.3 steps/s
[Step=24450 Epoch=232.6] | Loss=0.00009 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=3.328 | 1976.6 samples/s | 30.9 steps/s
[Step=24500 Epoch=233.1] | Loss=0.00008 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.778 | L2-Norm(final)=3.329 | 4170.5 samples/s | 65.2 steps/s
[Step=24550 Epoch=233.5] | Loss=0.00007 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.775 | L2-Norm(final)=3.329 | 2054.7 samples/s | 32.1 steps/s
[Step=24600 Epoch=234.0] | Loss=0.00007 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.772 | L2-Norm(final)=3.329 | 4164.3 samples/s | 65.1 steps/s
[Step=24650 Epoch=234.5] | Loss=0.00006 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.769 | L2-Norm(final)=3.330 | 2049.0 samples/s | 32.0 steps/s
[Step=24700 Epoch=235.0] | Loss=0.00006 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.767 | L2-Norm(final)=3.330 | 4039.3 samples/s | 63.1 steps/s
[Step=24750 Epoch=235.4] | Loss=0.00006 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.764 | L2-Norm(final)=3.330 | 2065.5 samples/s | 32.3 steps/s
[Step=24800 Epoch=235.9] | Loss=0.00005 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.761 | L2-Norm(final)=3.331 | 4038.0 samples/s | 63.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step24800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32916 | acc=0.8687 | tpr=0.8191 | fpr=0.0238 | 3832.0 samples/s | 15.0 steps/s
Avg test loss: 0.33425, Avg test acc: 0.86682, Avg tpr: 0.81786, Avg fpr: 0.02551, total FA: 199

Testing server on iccad2012
[Step=  50] | Loss=0.38482 | acc=0.8948 | tpr=0.9204 | fpr=0.1056 | 3977.2 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.39858 | acc=0.8914 | tpr=0.9446 | fpr=0.1096 | 7041.4 samples/s | 27.5 steps/s
[Step= 150] | Loss=0.40862 | acc=0.8906 | tpr=0.9452 | fpr=0.1104 | 7421.7 samples/s | 29.0 steps/s
[Step= 200] | Loss=0.40983 | acc=0.8906 | tpr=0.9421 | fpr=0.1104 | 7129.0 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.40713 | acc=0.8907 | tpr=0.9450 | fpr=0.1103 | 7325.6 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.41082 | acc=0.8909 | tpr=0.9425 | fpr=0.1100 | 6997.5 samples/s | 27.3 steps/s
[Step= 350] | Loss=0.41333 | acc=0.8906 | tpr=0.9424 | fpr=0.1103 | 7302.5 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.41464 | acc=0.8908 | tpr=0.9426 | fpr=0.1102 | 7510.1 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.41819 | acc=0.8904 | tpr=0.9421 | fpr=0.1105 | 7014.1 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.41585 | acc=0.8906 | tpr=0.9432 | fpr=0.1103 | 7197.7 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.41349 | acc=0.8913 | tpr=0.9447 | fpr=0.1097 | 12624.7 samples/s | 49.3 steps/s
Avg test loss: 0.41285, Avg test acc: 0.89137, Avg tpr: 0.94493, Avg fpr: 0.10960, total FA: 15218

server round 31/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=120.9] | Loss=0.15866 | Reg=0.00163 | acc=0.9219 | L2-Norm=12.759 | L2-Norm(final)=3.338 | 4469.6 samples/s | 69.8 steps/s
[Step=24850 Epoch=121.2] | Loss=0.01289 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=3.338 | 4040.0 samples/s | 63.1 steps/s
[Step=24900 Epoch=121.4] | Loss=0.00893 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.786 | L2-Norm(final)=3.339 | 4209.2 samples/s | 65.8 steps/s
[Step=24950 Epoch=121.7] | Loss=0.00676 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.789 | L2-Norm(final)=3.340 | 4207.3 samples/s | 65.7 steps/s
[Step=25000 Epoch=121.9] | Loss=0.00571 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.791 | L2-Norm(final)=3.342 | 5914.2 samples/s | 92.4 steps/s
[Step=25050 Epoch=122.1] | Loss=0.00487 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.792 | L2-Norm(final)=3.344 | 1865.6 samples/s | 29.1 steps/s
[Step=25100 Epoch=122.4] | Loss=0.00436 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.794 | L2-Norm(final)=3.345 | 4209.8 samples/s | 65.8 steps/s
[Step=25150 Epoch=122.6] | Loss=0.00404 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.795 | L2-Norm(final)=3.346 | 4273.8 samples/s | 66.8 steps/s
[Step=25200 Epoch=122.9] | Loss=0.00399 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.796 | L2-Norm(final)=3.348 | 5310.0 samples/s | 83.0 steps/s
[Step=25250 Epoch=123.1] | Loss=0.00373 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.796 | L2-Norm(final)=3.349 | 1940.7 samples/s | 30.3 steps/s
[Step=25300 Epoch=123.4] | Loss=0.00358 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.797 | L2-Norm(final)=3.350 | 4373.5 samples/s | 68.3 steps/s
[Step=25350 Epoch=123.6] | Loss=0.00338 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.797 | L2-Norm(final)=3.352 | 4344.2 samples/s | 67.9 steps/s
[Step=25400 Epoch=123.9] | Loss=0.00325 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.798 | L2-Norm(final)=3.353 | 4936.9 samples/s | 77.1 steps/s
[Step=25450 Epoch=124.1] | Loss=0.00313 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.798 | L2-Norm(final)=3.354 | 1969.8 samples/s | 30.8 steps/s
[Step=25500 Epoch=124.3] | Loss=0.00301 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.799 | L2-Norm(final)=3.355 | 4257.8 samples/s | 66.5 steps/s
[Step=25550 Epoch=124.6] | Loss=0.00296 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.799 | L2-Norm(final)=3.356 | 4229.7 samples/s | 66.1 steps/s
[Step=25600 Epoch=124.8] | Loss=0.00292 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.800 | L2-Norm(final)=3.358 | 4663.6 samples/s | 72.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step25600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=121.0] | Loss=0.09986 | Reg=0.00163 | acc=0.9531 | L2-Norm=12.759 | L2-Norm(final)=3.338 | 4235.9 samples/s | 66.2 steps/s
[Step=24850 Epoch=121.3] | Loss=0.00975 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.783 | L2-Norm(final)=3.342 | 4253.3 samples/s | 66.5 steps/s
[Step=24900 Epoch=121.5] | Loss=0.00699 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.789 | L2-Norm(final)=3.343 | 4229.2 samples/s | 66.1 steps/s
[Step=24950 Epoch=121.7] | Loss=0.00533 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.793 | L2-Norm(final)=3.344 | 4207.9 samples/s | 65.7 steps/s
[Step=25000 Epoch=122.0] | Loss=0.00465 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.795 | L2-Norm(final)=3.346 | 5842.6 samples/s | 91.3 steps/s
[Step=25050 Epoch=122.2] | Loss=0.00407 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.797 | L2-Norm(final)=3.348 | 1861.3 samples/s | 29.1 steps/s
[Step=25100 Epoch=122.5] | Loss=0.00364 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.799 | L2-Norm(final)=3.349 | 4292.4 samples/s | 67.1 steps/s
[Step=25150 Epoch=122.7] | Loss=0.00342 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.800 | L2-Norm(final)=3.351 | 4169.3 samples/s | 65.1 steps/s
[Step=25200 Epoch=123.0] | Loss=0.00336 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.801 | L2-Norm(final)=3.352 | 5330.4 samples/s | 83.3 steps/s
[Step=25250 Epoch=123.2] | Loss=0.00312 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.801 | L2-Norm(final)=3.353 | 1886.3 samples/s | 29.5 steps/s
[Step=25300 Epoch=123.5] | Loss=0.00289 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.802 | L2-Norm(final)=3.355 | 4354.0 samples/s | 68.0 steps/s
[Step=25350 Epoch=123.7] | Loss=0.00283 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.803 | L2-Norm(final)=3.356 | 4278.5 samples/s | 66.9 steps/s
[Step=25400 Epoch=123.9] | Loss=0.00285 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.803 | L2-Norm(final)=3.357 | 5114.1 samples/s | 79.9 steps/s
[Step=25450 Epoch=124.2] | Loss=0.00274 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.804 | L2-Norm(final)=3.358 | 1965.3 samples/s | 30.7 steps/s
[Step=25500 Epoch=124.4] | Loss=0.00265 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.804 | L2-Norm(final)=3.359 | 4192.4 samples/s | 65.5 steps/s
[Step=25550 Epoch=124.7] | Loss=0.00261 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.805 | L2-Norm(final)=3.360 | 4278.9 samples/s | 66.9 steps/s
[Step=25600 Epoch=124.9] | Loss=0.00252 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.805 | L2-Norm(final)=3.361 | 4876.2 samples/s | 76.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step25600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=235.0] | Loss=0.00845 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.759 | L2-Norm(final)=3.339 | 4362.4 samples/s | 68.2 steps/s
[Step=24850 Epoch=235.5] | Loss=0.00138 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.779 | L2-Norm(final)=3.347 | 3720.1 samples/s | 58.1 steps/s
[Step=24900 Epoch=235.9] | Loss=0.00070 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.782 | L2-Norm(final)=3.348 | 5524.2 samples/s | 86.3 steps/s
[Step=24950 Epoch=236.4] | Loss=0.00047 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.782 | L2-Norm(final)=3.349 | 1831.5 samples/s | 28.6 steps/s
[Step=25000 Epoch=236.9] | Loss=0.00035 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=3.349 | 5169.0 samples/s | 80.8 steps/s
[Step=25050 Epoch=237.4] | Loss=0.00028 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.778 | L2-Norm(final)=3.350 | 1882.1 samples/s | 29.4 steps/s
[Step=25100 Epoch=237.8] | Loss=0.00024 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.776 | L2-Norm(final)=3.350 | 4683.9 samples/s | 73.2 steps/s
[Step=25150 Epoch=238.3] | Loss=0.00020 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.774 | L2-Norm(final)=3.350 | 1919.0 samples/s | 30.0 steps/s
[Step=25200 Epoch=238.8] | Loss=0.00018 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.772 | L2-Norm(final)=3.350 | 4417.7 samples/s | 69.0 steps/s
[Step=25250 Epoch=239.3] | Loss=0.00016 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.769 | L2-Norm(final)=3.351 | 2008.6 samples/s | 31.4 steps/s
[Step=25300 Epoch=239.7] | Loss=0.00014 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.767 | L2-Norm(final)=3.351 | 4204.1 samples/s | 65.7 steps/s
[Step=25350 Epoch=240.2] | Loss=0.00013 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.765 | L2-Norm(final)=3.351 | 2046.5 samples/s | 32.0 steps/s
[Step=25400 Epoch=240.7] | Loss=0.00012 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.762 | L2-Norm(final)=3.351 | 4265.8 samples/s | 66.7 steps/s
[Step=25450 Epoch=241.2] | Loss=0.00011 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.760 | L2-Norm(final)=3.351 | 2061.0 samples/s | 32.2 steps/s
[Step=25500 Epoch=241.6] | Loss=0.00010 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.757 | L2-Norm(final)=3.352 | 4137.6 samples/s | 64.7 steps/s
[Step=25550 Epoch=242.1] | Loss=0.00010 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.754 | L2-Norm(final)=3.352 | 2071.0 samples/s | 32.4 steps/s
[Step=25600 Epoch=242.6] | Loss=0.00009 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.752 | L2-Norm(final)=3.352 | 4055.3 samples/s | 63.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step25600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=235.9] | Loss=0.01633 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.759 | L2-Norm(final)=3.339 | 4007.4 samples/s | 62.6 steps/s
[Step=24850 Epoch=236.4] | Loss=0.00215 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.789 | L2-Norm(final)=3.348 | 4034.6 samples/s | 63.0 steps/s
[Step=24900 Epoch=236.9] | Loss=0.00108 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.794 | L2-Norm(final)=3.349 | 5480.8 samples/s | 85.6 steps/s
[Step=24950 Epoch=237.3] | Loss=0.00073 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.794 | L2-Norm(final)=3.350 | 1802.3 samples/s | 28.2 steps/s
[Step=25000 Epoch=237.8] | Loss=0.00055 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.793 | L2-Norm(final)=3.350 | 5109.4 samples/s | 79.8 steps/s
[Step=25050 Epoch=238.3] | Loss=0.00044 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.791 | L2-Norm(final)=3.351 | 1861.4 samples/s | 29.1 steps/s
[Step=25100 Epoch=238.8] | Loss=0.00037 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.789 | L2-Norm(final)=3.351 | 4687.7 samples/s | 73.2 steps/s
[Step=25150 Epoch=239.2] | Loss=0.00032 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=3.351 | 1875.3 samples/s | 29.3 steps/s
[Step=25200 Epoch=239.7] | Loss=0.00028 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.784 | L2-Norm(final)=3.351 | 4381.1 samples/s | 68.5 steps/s
[Step=25250 Epoch=240.2] | Loss=0.00025 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.782 | L2-Norm(final)=3.352 | 1956.4 samples/s | 30.6 steps/s
[Step=25300 Epoch=240.7] | Loss=0.00022 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=3.352 | 4091.4 samples/s | 63.9 steps/s
[Step=25350 Epoch=241.1] | Loss=0.00020 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.777 | L2-Norm(final)=3.352 | 2027.3 samples/s | 31.7 steps/s
[Step=25400 Epoch=241.6] | Loss=0.00019 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.775 | L2-Norm(final)=3.352 | 4125.3 samples/s | 64.5 steps/s
[Step=25450 Epoch=242.1] | Loss=0.00017 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.772 | L2-Norm(final)=3.352 | 2059.3 samples/s | 32.2 steps/s
[Step=25500 Epoch=242.6] | Loss=0.00016 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.769 | L2-Norm(final)=3.352 | 4160.5 samples/s | 65.0 steps/s
[Step=25550 Epoch=243.0] | Loss=0.00015 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.767 | L2-Norm(final)=3.353 | 2074.8 samples/s | 32.4 steps/s
[Step=25600 Epoch=243.5] | Loss=0.00014 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.764 | L2-Norm(final)=3.353 | 4059.0 samples/s | 63.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step25600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.41326 | acc=0.8405 | tpr=0.7757 | fpr=0.0186 | 3863.1 samples/s | 15.1 steps/s
Avg test loss: 0.41882, Avg test acc: 0.83969, Avg tpr: 0.77595, Avg fpr: 0.02013, total FA: 157

Testing server on iccad2012
[Step=  50] | Loss=0.32902 | acc=0.9160 | tpr=0.9115 | fpr=0.0839 | 3905.1 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.34014 | acc=0.9132 | tpr=0.9360 | fpr=0.0873 | 7209.1 samples/s | 28.2 steps/s
[Step= 150] | Loss=0.34995 | acc=0.9120 | tpr=0.9352 | fpr=0.0884 | 7056.3 samples/s | 27.6 steps/s
[Step= 200] | Loss=0.35124 | acc=0.9124 | tpr=0.9333 | fpr=0.0880 | 7649.5 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.34864 | acc=0.9130 | tpr=0.9371 | fpr=0.0874 | 7056.4 samples/s | 27.6 steps/s
[Step= 300] | Loss=0.35263 | acc=0.9130 | tpr=0.9338 | fpr=0.0873 | 7239.9 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.35553 | acc=0.9129 | tpr=0.9349 | fpr=0.0875 | 7253.7 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.35709 | acc=0.9131 | tpr=0.9354 | fpr=0.0873 | 6905.5 samples/s | 27.0 steps/s
[Step= 450] | Loss=0.36087 | acc=0.9129 | tpr=0.9352 | fpr=0.0875 | 7244.8 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.35852 | acc=0.9133 | tpr=0.9366 | fpr=0.0871 | 6911.2 samples/s | 27.0 steps/s
[Step= 550] | Loss=0.35651 | acc=0.9139 | tpr=0.9379 | fpr=0.0865 | 13215.0 samples/s | 51.6 steps/s
Avg test loss: 0.35584, Avg test acc: 0.91401, Avg tpr: 0.93819, Avg fpr: 0.08643, total FA: 12001

server round 32/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=124.8] | Loss=0.16733 | Reg=0.00162 | acc=0.9219 | L2-Norm=12.735 | L2-Norm(final)=3.365 | 4338.3 samples/s | 67.8 steps/s
[Step=25650 Epoch=125.1] | Loss=0.01641 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.766 | L2-Norm(final)=3.360 | 4076.0 samples/s | 63.7 steps/s
[Step=25700 Epoch=125.3] | Loss=0.00982 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.774 | L2-Norm(final)=3.360 | 4372.3 samples/s | 68.3 steps/s
[Step=25750 Epoch=125.6] | Loss=0.00756 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.778 | L2-Norm(final)=3.362 | 4206.2 samples/s | 65.7 steps/s
[Step=25800 Epoch=125.8] | Loss=0.00641 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=3.364 | 5859.8 samples/s | 91.6 steps/s
[Step=25850 Epoch=126.0] | Loss=0.00548 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.782 | L2-Norm(final)=3.366 | 1880.1 samples/s | 29.4 steps/s
[Step=25900 Epoch=126.3] | Loss=0.00492 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.784 | L2-Norm(final)=3.368 | 4307.4 samples/s | 67.3 steps/s
[Step=25950 Epoch=126.5] | Loss=0.00453 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.785 | L2-Norm(final)=3.369 | 4292.0 samples/s | 67.1 steps/s
[Step=26000 Epoch=126.8] | Loss=0.00417 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.786 | L2-Norm(final)=3.371 | 5420.5 samples/s | 84.7 steps/s
[Step=26050 Epoch=127.0] | Loss=0.00393 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.787 | L2-Norm(final)=3.372 | 1911.0 samples/s | 29.9 steps/s
[Step=26100 Epoch=127.3] | Loss=0.00373 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.788 | L2-Norm(final)=3.374 | 4228.0 samples/s | 66.1 steps/s
[Step=26150 Epoch=127.5] | Loss=0.00362 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.788 | L2-Norm(final)=3.375 | 4164.5 samples/s | 65.1 steps/s
[Step=26200 Epoch=127.8] | Loss=0.00347 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.789 | L2-Norm(final)=3.376 | 4927.9 samples/s | 77.0 steps/s
[Step=26250 Epoch=128.0] | Loss=0.00331 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.789 | L2-Norm(final)=3.378 | 1969.0 samples/s | 30.8 steps/s
[Step=26300 Epoch=128.2] | Loss=0.00322 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.790 | L2-Norm(final)=3.379 | 4189.9 samples/s | 65.5 steps/s
[Step=26350 Epoch=128.5] | Loss=0.00312 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.790 | L2-Norm(final)=3.380 | 4280.2 samples/s | 66.9 steps/s
[Step=26400 Epoch=128.7] | Loss=0.00307 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.791 | L2-Norm(final)=3.381 | 4694.1 samples/s | 73.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step26400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=124.9] | Loss=0.22478 | Reg=0.00162 | acc=0.9219 | L2-Norm=12.735 | L2-Norm(final)=3.364 | 4361.2 samples/s | 68.1 steps/s
[Step=25650 Epoch=125.2] | Loss=0.01633 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.763 | L2-Norm(final)=3.360 | 4055.8 samples/s | 63.4 steps/s
[Step=25700 Epoch=125.4] | Loss=0.00993 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.771 | L2-Norm(final)=3.360 | 4235.8 samples/s | 66.2 steps/s
[Step=25750 Epoch=125.6] | Loss=0.00794 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.774 | L2-Norm(final)=3.362 | 4192.4 samples/s | 65.5 steps/s
[Step=25800 Epoch=125.9] | Loss=0.00658 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.777 | L2-Norm(final)=3.363 | 5637.7 samples/s | 88.1 steps/s
[Step=25850 Epoch=126.1] | Loss=0.00558 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.779 | L2-Norm(final)=3.365 | 1878.4 samples/s | 29.3 steps/s
[Step=25900 Epoch=126.4] | Loss=0.00506 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.780 | L2-Norm(final)=3.366 | 4211.2 samples/s | 65.8 steps/s
[Step=25950 Epoch=126.6] | Loss=0.00470 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.781 | L2-Norm(final)=3.367 | 4200.8 samples/s | 65.6 steps/s
[Step=26000 Epoch=126.9] | Loss=0.00436 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.782 | L2-Norm(final)=3.369 | 5438.7 samples/s | 85.0 steps/s
[Step=26050 Epoch=127.1] | Loss=0.00406 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.783 | L2-Norm(final)=3.370 | 1895.0 samples/s | 29.6 steps/s
[Step=26100 Epoch=127.4] | Loss=0.00379 | Reg=0.00163 | acc=0.9844 | L2-Norm=12.784 | L2-Norm(final)=3.371 | 4279.8 samples/s | 66.9 steps/s
[Step=26150 Epoch=127.6] | Loss=0.00354 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.784 | L2-Norm(final)=3.373 | 4236.1 samples/s | 66.2 steps/s
[Step=26200 Epoch=127.8] | Loss=0.00341 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.785 | L2-Norm(final)=3.374 | 5066.2 samples/s | 79.2 steps/s
[Step=26250 Epoch=128.1] | Loss=0.00328 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.785 | L2-Norm(final)=3.375 | 1940.1 samples/s | 30.3 steps/s
[Step=26300 Epoch=128.3] | Loss=0.00311 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.786 | L2-Norm(final)=3.376 | 4147.0 samples/s | 64.8 steps/s
[Step=26350 Epoch=128.6] | Loss=0.00305 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.786 | L2-Norm(final)=3.377 | 4165.1 samples/s | 65.1 steps/s
[Step=26400 Epoch=128.8] | Loss=0.00294 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.786 | L2-Norm(final)=3.378 | 4762.1 samples/s | 74.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step26400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=242.6] | Loss=0.06856 | Reg=0.00162 | acc=0.9688 | L2-Norm=12.735 | L2-Norm(final)=3.365 | 4102.6 samples/s | 64.1 steps/s
[Step=25650 Epoch=243.1] | Loss=0.00246 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.747 | L2-Norm(final)=3.367 | 3840.6 samples/s | 60.0 steps/s
[Step=25700 Epoch=243.5] | Loss=0.00124 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.749 | L2-Norm(final)=3.367 | 5532.0 samples/s | 86.4 steps/s
[Step=25750 Epoch=244.0] | Loss=0.00083 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.748 | L2-Norm(final)=3.367 | 1876.4 samples/s | 29.3 steps/s
[Step=25800 Epoch=244.5] | Loss=0.00063 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.746 | L2-Norm(final)=3.367 | 5382.2 samples/s | 84.1 steps/s
[Step=25850 Epoch=245.0] | Loss=0.00050 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.744 | L2-Norm(final)=3.368 | 1931.9 samples/s | 30.2 steps/s
[Step=25900 Epoch=245.4] | Loss=0.00042 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.742 | L2-Norm(final)=3.368 | 5005.4 samples/s | 78.2 steps/s
[Step=25950 Epoch=245.9] | Loss=0.00036 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.740 | L2-Norm(final)=3.368 | 2000.5 samples/s | 31.3 steps/s
[Step=26000 Epoch=246.4] | Loss=0.00032 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.738 | L2-Norm(final)=3.369 | 4696.4 samples/s | 73.4 steps/s
[Step=26050 Epoch=246.8] | Loss=0.00028 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.735 | L2-Norm(final)=3.369 | 2057.0 samples/s | 32.1 steps/s
[Step=26100 Epoch=247.3] | Loss=0.00025 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.733 | L2-Norm(final)=3.369 | 4438.5 samples/s | 69.4 steps/s
[Step=26150 Epoch=247.8] | Loss=0.00023 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.730 | L2-Norm(final)=3.369 | 2112.9 samples/s | 33.0 steps/s
[Step=26200 Epoch=248.3] | Loss=0.00021 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.728 | L2-Norm(final)=3.369 | 4244.6 samples/s | 66.3 steps/s
[Step=26250 Epoch=248.7] | Loss=0.00020 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.725 | L2-Norm(final)=3.370 | 2105.6 samples/s | 32.9 steps/s
[Step=26300 Epoch=249.2] | Loss=0.00018 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.723 | L2-Norm(final)=3.370 | 4442.0 samples/s | 69.4 steps/s
[Step=26350 Epoch=249.7] | Loss=0.00017 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.720 | L2-Norm(final)=3.370 | 2118.0 samples/s | 33.1 steps/s
[Step=26400 Epoch=250.2] | Loss=0.00016 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.717 | L2-Norm(final)=3.370 | 4290.4 samples/s | 67.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step26400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=243.5] | Loss=0.00696 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.735 | L2-Norm(final)=3.365 | 4251.0 samples/s | 66.4 steps/s
[Step=25650 Epoch=244.0] | Loss=0.00131 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.757 | L2-Norm(final)=3.374 | 3797.2 samples/s | 59.3 steps/s
[Step=25700 Epoch=244.5] | Loss=0.00066 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.760 | L2-Norm(final)=3.376 | 5762.3 samples/s | 90.0 steps/s
[Step=25750 Epoch=244.9] | Loss=0.00044 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.759 | L2-Norm(final)=3.376 | 1897.8 samples/s | 29.7 steps/s
[Step=25800 Epoch=245.4] | Loss=0.00033 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.757 | L2-Norm(final)=3.377 | 5404.2 samples/s | 84.4 steps/s
[Step=25850 Epoch=245.9] | Loss=0.00027 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=3.377 | 1921.9 samples/s | 30.0 steps/s
[Step=25900 Epoch=246.4] | Loss=0.00022 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.753 | L2-Norm(final)=3.377 | 5003.9 samples/s | 78.2 steps/s
[Step=25950 Epoch=246.8] | Loss=0.00019 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.751 | L2-Norm(final)=3.377 | 2014.9 samples/s | 31.5 steps/s
[Step=26000 Epoch=247.3] | Loss=0.00017 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.748 | L2-Norm(final)=3.378 | 4556.9 samples/s | 71.2 steps/s
[Step=26050 Epoch=247.8] | Loss=0.00015 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.746 | L2-Norm(final)=3.378 | 2030.8 samples/s | 31.7 steps/s
[Step=26100 Epoch=248.3] | Loss=0.00014 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.743 | L2-Norm(final)=3.378 | 4415.9 samples/s | 69.0 steps/s
[Step=26150 Epoch=248.8] | Loss=0.00012 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.741 | L2-Norm(final)=3.378 | 2098.9 samples/s | 32.8 steps/s
[Step=26200 Epoch=249.2] | Loss=0.00011 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.738 | L2-Norm(final)=3.378 | 4326.9 samples/s | 67.6 steps/s
[Step=26250 Epoch=249.7] | Loss=0.00011 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.735 | L2-Norm(final)=3.378 | 2109.7 samples/s | 33.0 steps/s
[Step=26300 Epoch=250.2] | Loss=0.00010 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.733 | L2-Norm(final)=3.379 | 4348.0 samples/s | 67.9 steps/s
[Step=26350 Epoch=250.7] | Loss=0.00009 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.730 | L2-Norm(final)=3.379 | 2122.3 samples/s | 33.2 steps/s
[Step=26400 Epoch=251.1] | Loss=0.00009 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.727 | L2-Norm(final)=3.379 | 4201.4 samples/s | 65.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step26400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34327 | acc=0.8670 | tpr=0.8165 | fpr=0.0233 | 4084.8 samples/s | 16.0 steps/s
Avg test loss: 0.34781, Avg test acc: 0.86638, Avg tpr: 0.81681, Avg fpr: 0.02461, total FA: 192

Testing server on iccad2012
[Step=  50] | Loss=0.36621 | acc=0.9047 | tpr=0.9204 | fpr=0.0956 | 4199.5 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.37859 | acc=0.9020 | tpr=0.9403 | fpr=0.0988 | 7961.9 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.38891 | acc=0.9010 | tpr=0.9424 | fpr=0.0997 | 8018.7 samples/s | 31.3 steps/s
[Step= 200] | Loss=0.39008 | acc=0.9017 | tpr=0.9388 | fpr=0.0990 | 7629.6 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.38728 | acc=0.9023 | tpr=0.9424 | fpr=0.0984 | 8013.3 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.39137 | acc=0.9025 | tpr=0.9396 | fpr=0.0982 | 7835.0 samples/s | 30.6 steps/s
[Step= 350] | Loss=0.39435 | acc=0.9021 | tpr=0.9399 | fpr=0.0986 | 7671.8 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.39585 | acc=0.9024 | tpr=0.9398 | fpr=0.0983 | 7458.2 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.39981 | acc=0.9021 | tpr=0.9387 | fpr=0.0986 | 7380.8 samples/s | 28.8 steps/s
[Step= 500] | Loss=0.39745 | acc=0.9024 | tpr=0.9401 | fpr=0.0983 | 7442.1 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.39521 | acc=0.9029 | tpr=0.9411 | fpr=0.0978 | 14419.7 samples/s | 56.3 steps/s
Avg test loss: 0.39454, Avg test acc: 0.90297, Avg tpr: 0.94136, Avg fpr: 0.09773, total FA: 13569

server round 33/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=128.7] | Loss=0.04675 | Reg=0.00162 | acc=0.9531 | L2-Norm=12.709 | L2-Norm(final)=3.387 | 4550.3 samples/s | 71.1 steps/s
[Step=26450 Epoch=129.0] | Loss=0.01117 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.735 | L2-Norm(final)=3.388 | 4192.4 samples/s | 65.5 steps/s
[Step=26500 Epoch=129.2] | Loss=0.00784 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.743 | L2-Norm(final)=3.389 | 4509.0 samples/s | 70.5 steps/s
[Step=26550 Epoch=129.5] | Loss=0.00607 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.746 | L2-Norm(final)=3.390 | 4521.6 samples/s | 70.6 steps/s
[Step=26600 Epoch=129.7] | Loss=0.00520 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.748 | L2-Norm(final)=3.392 | 6064.5 samples/s | 94.8 steps/s
[Step=26650 Epoch=130.0] | Loss=0.00452 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.750 | L2-Norm(final)=3.394 | 1957.4 samples/s | 30.6 steps/s
[Step=26700 Epoch=130.2] | Loss=0.00401 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.751 | L2-Norm(final)=3.396 | 4475.1 samples/s | 69.9 steps/s
[Step=26750 Epoch=130.4] | Loss=0.00372 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.752 | L2-Norm(final)=3.397 | 4472.6 samples/s | 69.9 steps/s
[Step=26800 Epoch=130.7] | Loss=0.00356 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.753 | L2-Norm(final)=3.399 | 5603.5 samples/s | 87.6 steps/s
[Step=26850 Epoch=130.9] | Loss=0.00334 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.754 | L2-Norm(final)=3.400 | 1982.5 samples/s | 31.0 steps/s
[Step=26900 Epoch=131.2] | Loss=0.00316 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=3.402 | 4548.7 samples/s | 71.1 steps/s
[Step=26950 Epoch=131.4] | Loss=0.00298 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.756 | L2-Norm(final)=3.403 | 4504.1 samples/s | 70.4 steps/s
[Step=27000 Epoch=131.7] | Loss=0.00303 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.756 | L2-Norm(final)=3.405 | 5255.3 samples/s | 82.1 steps/s
[Step=27050 Epoch=131.9] | Loss=0.00287 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.757 | L2-Norm(final)=3.406 | 2053.2 samples/s | 32.1 steps/s
[Step=27100 Epoch=132.1] | Loss=0.00279 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.757 | L2-Norm(final)=3.408 | 4485.8 samples/s | 70.1 steps/s
[Step=27150 Epoch=132.4] | Loss=0.00274 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=3.409 | 4389.0 samples/s | 68.6 steps/s
[Step=27200 Epoch=132.6] | Loss=0.00271 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=3.410 | 4801.5 samples/s | 75.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step27200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=128.8] | Loss=0.09001 | Reg=0.00162 | acc=0.9062 | L2-Norm=12.709 | L2-Norm(final)=3.387 | 4483.6 samples/s | 70.1 steps/s
[Step=26450 Epoch=129.1] | Loss=0.01281 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.739 | L2-Norm(final)=3.386 | 4379.6 samples/s | 68.4 steps/s
[Step=26500 Epoch=129.3] | Loss=0.00814 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.746 | L2-Norm(final)=3.386 | 4521.7 samples/s | 70.7 steps/s
[Step=26550 Epoch=129.6] | Loss=0.00660 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.750 | L2-Norm(final)=3.388 | 4461.6 samples/s | 69.7 steps/s
[Step=26600 Epoch=129.8] | Loss=0.00562 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.753 | L2-Norm(final)=3.389 | 6074.9 samples/s | 94.9 steps/s
[Step=26650 Epoch=130.0] | Loss=0.00478 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.754 | L2-Norm(final)=3.390 | 1919.7 samples/s | 30.0 steps/s
[Step=26700 Epoch=130.3] | Loss=0.00417 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.756 | L2-Norm(final)=3.392 | 4502.9 samples/s | 70.4 steps/s
[Step=26750 Epoch=130.5] | Loss=0.00399 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.757 | L2-Norm(final)=3.393 | 4527.4 samples/s | 70.7 steps/s
[Step=26800 Epoch=130.8] | Loss=0.00373 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=3.394 | 5698.7 samples/s | 89.0 steps/s
[Step=26850 Epoch=131.0] | Loss=0.00354 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.758 | L2-Norm(final)=3.396 | 1983.8 samples/s | 31.0 steps/s
[Step=26900 Epoch=131.3] | Loss=0.00330 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.759 | L2-Norm(final)=3.397 | 4491.4 samples/s | 70.2 steps/s
[Step=26950 Epoch=131.5] | Loss=0.00318 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.760 | L2-Norm(final)=3.398 | 4538.1 samples/s | 70.9 steps/s
[Step=27000 Epoch=131.7] | Loss=0.00306 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.760 | L2-Norm(final)=3.399 | 5163.7 samples/s | 80.7 steps/s
[Step=27050 Epoch=132.0] | Loss=0.00292 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.760 | L2-Norm(final)=3.400 | 2038.9 samples/s | 31.9 steps/s
[Step=27100 Epoch=132.2] | Loss=0.00283 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.761 | L2-Norm(final)=3.401 | 4568.5 samples/s | 71.4 steps/s
[Step=27150 Epoch=132.5] | Loss=0.00273 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.761 | L2-Norm(final)=3.402 | 4458.5 samples/s | 69.7 steps/s
[Step=27200 Epoch=132.7] | Loss=0.00270 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.762 | L2-Norm(final)=3.403 | 5094.2 samples/s | 79.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step27200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=250.2] | Loss=0.00123 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.709 | L2-Norm(final)=3.387 | 4783.7 samples/s | 74.7 steps/s
[Step=26450 Epoch=250.6] | Loss=0.00087 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.733 | L2-Norm(final)=3.395 | 3863.9 samples/s | 60.4 steps/s
[Step=26500 Epoch=251.1] | Loss=0.00044 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.736 | L2-Norm(final)=3.397 | 5790.2 samples/s | 90.5 steps/s
[Step=26550 Epoch=251.6] | Loss=0.00029 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.735 | L2-Norm(final)=3.398 | 1869.5 samples/s | 29.2 steps/s
[Step=26600 Epoch=252.1] | Loss=0.00022 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.733 | L2-Norm(final)=3.398 | 5388.2 samples/s | 84.2 steps/s
[Step=26650 Epoch=252.5] | Loss=0.00018 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.730 | L2-Norm(final)=3.398 | 1937.6 samples/s | 30.3 steps/s
[Step=26700 Epoch=253.0] | Loss=0.00015 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.728 | L2-Norm(final)=3.399 | 4956.8 samples/s | 77.5 steps/s
[Step=26750 Epoch=253.5] | Loss=0.00013 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.725 | L2-Norm(final)=3.399 | 1980.3 samples/s | 30.9 steps/s
[Step=26800 Epoch=254.0] | Loss=0.00011 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.722 | L2-Norm(final)=3.399 | 4625.9 samples/s | 72.3 steps/s
[Step=26850 Epoch=254.4] | Loss=0.00010 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.719 | L2-Norm(final)=3.399 | 2048.3 samples/s | 32.0 steps/s
[Step=26900 Epoch=254.9] | Loss=0.00009 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.716 | L2-Norm(final)=3.399 | 4422.6 samples/s | 69.1 steps/s
[Step=26950 Epoch=255.4] | Loss=0.00008 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.713 | L2-Norm(final)=3.400 | 2097.2 samples/s | 32.8 steps/s
[Step=27000 Epoch=255.8] | Loss=0.00008 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.710 | L2-Norm(final)=3.400 | 4291.3 samples/s | 67.1 steps/s
[Step=27050 Epoch=256.3] | Loss=0.00007 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.707 | L2-Norm(final)=3.400 | 2099.9 samples/s | 32.8 steps/s
[Step=27100 Epoch=256.8] | Loss=0.00007 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.704 | L2-Norm(final)=3.400 | 4344.4 samples/s | 67.9 steps/s
[Step=27150 Epoch=257.3] | Loss=0.00006 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.701 | L2-Norm(final)=3.400 | 2145.6 samples/s | 33.5 steps/s
[Step=27200 Epoch=257.7] | Loss=0.00006 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.697 | L2-Norm(final)=3.400 | 4261.3 samples/s | 66.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step27200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=251.1] | Loss=0.05873 | Reg=0.00162 | acc=0.9531 | L2-Norm=12.709 | L2-Norm(final)=3.387 | 4390.9 samples/s | 68.6 steps/s
[Step=26450 Epoch=251.6] | Loss=0.00300 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.736 | L2-Norm(final)=3.390 | 4158.7 samples/s | 65.0 steps/s
[Step=26500 Epoch=252.1] | Loss=0.00151 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.740 | L2-Norm(final)=3.390 | 5880.2 samples/s | 91.9 steps/s
[Step=26550 Epoch=252.6] | Loss=0.00101 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.740 | L2-Norm(final)=3.391 | 1871.3 samples/s | 29.2 steps/s
[Step=26600 Epoch=253.0] | Loss=0.00076 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.739 | L2-Norm(final)=3.391 | 5356.9 samples/s | 83.7 steps/s
[Step=26650 Epoch=253.5] | Loss=0.00061 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.738 | L2-Norm(final)=3.391 | 1940.8 samples/s | 30.3 steps/s
[Step=26700 Epoch=254.0] | Loss=0.00051 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.737 | L2-Norm(final)=3.391 | 5040.2 samples/s | 78.8 steps/s
[Step=26750 Epoch=254.5] | Loss=0.00044 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.735 | L2-Norm(final)=3.392 | 2004.4 samples/s | 31.3 steps/s
[Step=26800 Epoch=254.9] | Loss=0.00038 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.733 | L2-Norm(final)=3.392 | 4675.8 samples/s | 73.1 steps/s
[Step=26850 Epoch=255.4] | Loss=0.00034 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.731 | L2-Norm(final)=3.392 | 2053.9 samples/s | 32.1 steps/s
[Step=26900 Epoch=255.9] | Loss=0.00031 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.729 | L2-Norm(final)=3.392 | 4333.7 samples/s | 67.7 steps/s
[Step=26950 Epoch=256.4] | Loss=0.00028 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.727 | L2-Norm(final)=3.392 | 2090.1 samples/s | 32.7 steps/s
[Step=27000 Epoch=256.8] | Loss=0.00026 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.725 | L2-Norm(final)=3.393 | 4324.6 samples/s | 67.6 steps/s
[Step=27050 Epoch=257.3] | Loss=0.00024 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.723 | L2-Norm(final)=3.393 | 2134.7 samples/s | 33.4 steps/s
[Step=27100 Epoch=257.8] | Loss=0.00022 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.721 | L2-Norm(final)=3.393 | 4289.0 samples/s | 67.0 steps/s
[Step=27150 Epoch=258.3] | Loss=0.00021 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.719 | L2-Norm(final)=3.393 | 2078.2 samples/s | 32.5 steps/s
[Step=27200 Epoch=258.7] | Loss=0.00020 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.717 | L2-Norm(final)=3.394 | 4213.5 samples/s | 65.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step27200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38201 | acc=0.8511 | tpr=0.7918 | fpr=0.0201 | 4067.5 samples/s | 15.9 steps/s
Avg test loss: 0.38683, Avg test acc: 0.84991, Avg tpr: 0.79169, Avg fpr: 0.02205, total FA: 172

Testing server on iccad2012
[Step=  50] | Loss=0.34552 | acc=0.9143 | tpr=0.9071 | fpr=0.0856 | 4128.4 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.35850 | acc=0.9118 | tpr=0.9318 | fpr=0.0885 | 7789.0 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.36936 | acc=0.9106 | tpr=0.9323 | fpr=0.0898 | 7570.1 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.37053 | acc=0.9112 | tpr=0.9301 | fpr=0.0892 | 7529.9 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.36728 | acc=0.9115 | tpr=0.9345 | fpr=0.0889 | 7362.0 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.37163 | acc=0.9115 | tpr=0.9331 | fpr=0.0889 | 7441.7 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.37440 | acc=0.9112 | tpr=0.9330 | fpr=0.0892 | 7573.9 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.37604 | acc=0.9113 | tpr=0.9338 | fpr=0.0891 | 7452.8 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.37988 | acc=0.9110 | tpr=0.9323 | fpr=0.0894 | 7174.1 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.37758 | acc=0.9112 | tpr=0.9339 | fpr=0.0892 | 7658.1 samples/s | 29.9 steps/s
[Step= 550] | Loss=0.37536 | acc=0.9118 | tpr=0.9355 | fpr=0.0886 | 12943.0 samples/s | 50.6 steps/s
Avg test loss: 0.37470, Avg test acc: 0.91186, Avg tpr: 0.93582, Avg fpr: 0.08857, total FA: 12298

server round 34/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=132.6] | Loss=0.12083 | Reg=0.00161 | acc=0.9375 | L2-Norm=12.689 | L2-Norm(final)=3.411 | 4514.6 samples/s | 70.5 steps/s
[Step=27250 Epoch=132.9] | Loss=0.01460 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.720 | L2-Norm(final)=3.406 | 3878.1 samples/s | 60.6 steps/s
[Step=27300 Epoch=133.1] | Loss=0.00964 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.729 | L2-Norm(final)=3.407 | 4488.1 samples/s | 70.1 steps/s
[Step=27350 Epoch=133.4] | Loss=0.00732 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.733 | L2-Norm(final)=3.409 | 4373.6 samples/s | 68.3 steps/s
[Step=27400 Epoch=133.6] | Loss=0.00620 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.736 | L2-Norm(final)=3.411 | 6078.1 samples/s | 95.0 steps/s
[Step=27450 Epoch=133.9] | Loss=0.00527 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.738 | L2-Norm(final)=3.413 | 1904.3 samples/s | 29.8 steps/s
[Step=27500 Epoch=134.1] | Loss=0.00476 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.740 | L2-Norm(final)=3.416 | 4469.2 samples/s | 69.8 steps/s
[Step=27550 Epoch=134.3] | Loss=0.00451 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.741 | L2-Norm(final)=3.417 | 4533.0 samples/s | 70.8 steps/s
[Step=27600 Epoch=134.6] | Loss=0.00419 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.742 | L2-Norm(final)=3.419 | 5529.6 samples/s | 86.4 steps/s
[Step=27650 Epoch=134.8] | Loss=0.00387 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.743 | L2-Norm(final)=3.421 | 1986.9 samples/s | 31.0 steps/s
[Step=27700 Epoch=135.1] | Loss=0.00363 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.744 | L2-Norm(final)=3.423 | 4426.5 samples/s | 69.2 steps/s
[Step=27750 Epoch=135.3] | Loss=0.00344 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.745 | L2-Norm(final)=3.424 | 4491.6 samples/s | 70.2 steps/s
[Step=27800 Epoch=135.6] | Loss=0.00332 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.745 | L2-Norm(final)=3.426 | 5227.9 samples/s | 81.7 steps/s
[Step=27850 Epoch=135.8] | Loss=0.00324 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.746 | L2-Norm(final)=3.428 | 2035.7 samples/s | 31.8 steps/s
[Step=27900 Epoch=136.0] | Loss=0.00321 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.747 | L2-Norm(final)=3.429 | 4527.2 samples/s | 70.7 steps/s
[Step=27950 Epoch=136.3] | Loss=0.00308 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.747 | L2-Norm(final)=3.430 | 4474.4 samples/s | 69.9 steps/s
[Step=28000 Epoch=136.5] | Loss=0.00307 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.747 | L2-Norm(final)=3.431 | 4726.5 samples/s | 73.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step28000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=132.7] | Loss=0.07114 | Reg=0.00161 | acc=0.9688 | L2-Norm=12.689 | L2-Norm(final)=3.411 | 4416.4 samples/s | 69.0 steps/s
[Step=27250 Epoch=133.0] | Loss=0.01559 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.720 | L2-Norm(final)=3.407 | 4452.8 samples/s | 69.6 steps/s
[Step=27300 Epoch=133.2] | Loss=0.00891 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.728 | L2-Norm(final)=3.407 | 4515.8 samples/s | 70.6 steps/s
[Step=27350 Epoch=133.5] | Loss=0.00770 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.732 | L2-Norm(final)=3.408 | 4470.5 samples/s | 69.9 steps/s
[Step=27400 Epoch=133.7] | Loss=0.00642 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.734 | L2-Norm(final)=3.409 | 6056.9 samples/s | 94.6 steps/s
[Step=27450 Epoch=133.9] | Loss=0.00546 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.736 | L2-Norm(final)=3.410 | 1901.7 samples/s | 29.7 steps/s
[Step=27500 Epoch=134.2] | Loss=0.00494 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.737 | L2-Norm(final)=3.412 | 4481.6 samples/s | 70.0 steps/s
[Step=27550 Epoch=134.4] | Loss=0.00454 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.738 | L2-Norm(final)=3.413 | 4442.8 samples/s | 69.4 steps/s
[Step=27600 Epoch=134.7] | Loss=0.00421 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.739 | L2-Norm(final)=3.414 | 5565.2 samples/s | 87.0 steps/s
[Step=27650 Epoch=134.9] | Loss=0.00384 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.740 | L2-Norm(final)=3.415 | 1959.9 samples/s | 30.6 steps/s
[Step=27700 Epoch=135.2] | Loss=0.00363 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.740 | L2-Norm(final)=3.416 | 4421.9 samples/s | 69.1 steps/s
[Step=27750 Epoch=135.4] | Loss=0.00343 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.741 | L2-Norm(final)=3.417 | 4452.2 samples/s | 69.6 steps/s
[Step=27800 Epoch=135.7] | Loss=0.00336 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.741 | L2-Norm(final)=3.418 | 5264.1 samples/s | 82.3 steps/s
[Step=27850 Epoch=135.9] | Loss=0.00322 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.742 | L2-Norm(final)=3.419 | 2002.2 samples/s | 31.3 steps/s
[Step=27900 Epoch=136.1] | Loss=0.00307 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.742 | L2-Norm(final)=3.420 | 4422.4 samples/s | 69.1 steps/s
[Step=27950 Epoch=136.4] | Loss=0.00300 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.742 | L2-Norm(final)=3.421 | 4490.6 samples/s | 70.2 steps/s
[Step=28000 Epoch=136.6] | Loss=0.00293 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.743 | L2-Norm(final)=3.422 | 4953.6 samples/s | 77.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step28000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=257.8] | Loss=0.05563 | Reg=0.00161 | acc=0.9688 | L2-Norm=12.689 | L2-Norm(final)=3.412 | 4191.2 samples/s | 65.5 steps/s
[Step=27250 Epoch=258.2] | Loss=0.00197 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.715 | L2-Norm(final)=3.418 | 4081.9 samples/s | 63.8 steps/s
[Step=27300 Epoch=258.7] | Loss=0.00099 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.718 | L2-Norm(final)=3.419 | 5734.4 samples/s | 89.6 steps/s
[Step=27350 Epoch=259.2] | Loss=0.00066 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.717 | L2-Norm(final)=3.419 | 1857.1 samples/s | 29.0 steps/s
[Step=27400 Epoch=259.6] | Loss=0.00050 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.715 | L2-Norm(final)=3.419 | 5280.1 samples/s | 82.5 steps/s
[Step=27450 Epoch=260.1] | Loss=0.00040 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.713 | L2-Norm(final)=3.419 | 1944.8 samples/s | 30.4 steps/s
[Step=27500 Epoch=260.6] | Loss=0.00033 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.710 | L2-Norm(final)=3.419 | 4917.4 samples/s | 76.8 steps/s
[Step=27550 Epoch=261.1] | Loss=0.00029 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.708 | L2-Norm(final)=3.420 | 1981.6 samples/s | 31.0 steps/s
[Step=27600 Epoch=261.5] | Loss=0.00025 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.705 | L2-Norm(final)=3.420 | 4653.0 samples/s | 72.7 steps/s
[Step=27650 Epoch=262.0] | Loss=0.00022 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.702 | L2-Norm(final)=3.420 | 2046.7 samples/s | 32.0 steps/s
[Step=27700 Epoch=262.5] | Loss=0.00020 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.699 | L2-Norm(final)=3.420 | 4382.0 samples/s | 68.5 steps/s
[Step=27750 Epoch=263.0] | Loss=0.00018 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.697 | L2-Norm(final)=3.420 | 2080.5 samples/s | 32.5 steps/s
[Step=27800 Epoch=263.4] | Loss=0.00017 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.694 | L2-Norm(final)=3.420 | 4253.7 samples/s | 66.5 steps/s
[Step=27850 Epoch=263.9] | Loss=0.00016 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.691 | L2-Norm(final)=3.420 | 2134.8 samples/s | 33.4 steps/s
[Step=27900 Epoch=264.4] | Loss=0.00014 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.688 | L2-Norm(final)=3.420 | 4248.2 samples/s | 66.4 steps/s
[Step=27950 Epoch=264.9] | Loss=0.00014 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.685 | L2-Norm(final)=3.420 | 2122.9 samples/s | 33.2 steps/s
[Step=28000 Epoch=265.3] | Loss=0.00013 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.682 | L2-Norm(final)=3.421 | 4236.2 samples/s | 66.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step28000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=258.7] | Loss=0.00421 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.689 | L2-Norm(final)=3.412 | 4253.4 samples/s | 66.5 steps/s
[Step=27250 Epoch=259.2] | Loss=0.00132 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.714 | L2-Norm(final)=3.419 | 3974.0 samples/s | 62.1 steps/s
[Step=27300 Epoch=259.7] | Loss=0.00066 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.717 | L2-Norm(final)=3.420 | 5849.9 samples/s | 91.4 steps/s
[Step=27350 Epoch=260.2] | Loss=0.00044 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.717 | L2-Norm(final)=3.421 | 1884.3 samples/s | 29.4 steps/s
[Step=27400 Epoch=260.6] | Loss=0.00033 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.715 | L2-Norm(final)=3.421 | 5402.4 samples/s | 84.4 steps/s
[Step=27450 Epoch=261.1] | Loss=0.00027 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.713 | L2-Norm(final)=3.422 | 1945.9 samples/s | 30.4 steps/s
[Step=27500 Epoch=261.6] | Loss=0.00023 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.711 | L2-Norm(final)=3.422 | 5061.6 samples/s | 79.1 steps/s
[Step=27550 Epoch=262.1] | Loss=0.00019 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.708 | L2-Norm(final)=3.422 | 2004.6 samples/s | 31.3 steps/s
[Step=27600 Epoch=262.5] | Loss=0.00017 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.706 | L2-Norm(final)=3.422 | 4698.7 samples/s | 73.4 steps/s
[Step=27650 Epoch=263.0] | Loss=0.00015 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.704 | L2-Norm(final)=3.422 | 2089.8 samples/s | 32.7 steps/s
[Step=27700 Epoch=263.5] | Loss=0.00014 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.701 | L2-Norm(final)=3.422 | 4240.7 samples/s | 66.3 steps/s
[Step=27750 Epoch=264.0] | Loss=0.00012 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.699 | L2-Norm(final)=3.423 | 2072.7 samples/s | 32.4 steps/s
[Step=27800 Epoch=264.4] | Loss=0.00011 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.697 | L2-Norm(final)=3.423 | 4307.2 samples/s | 67.3 steps/s
[Step=27850 Epoch=264.9] | Loss=0.00011 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.694 | L2-Norm(final)=3.423 | 2074.1 samples/s | 32.4 steps/s
[Step=27900 Epoch=265.4] | Loss=0.00010 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.692 | L2-Norm(final)=3.423 | 4315.2 samples/s | 67.4 steps/s
[Step=27950 Epoch=265.9] | Loss=0.00009 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.689 | L2-Norm(final)=3.423 | 2147.3 samples/s | 33.6 steps/s
[Step=28000 Epoch=266.3] | Loss=0.00009 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=3.423 | 4287.7 samples/s | 67.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36552 | acc=0.8580 | tpr=0.8031 | fpr=0.0225 | 4229.9 samples/s | 16.5 steps/s
Avg test loss: 0.37012, Avg test acc: 0.85752, Avg tpr: 0.80370, Avg fpr: 0.02410, total FA: 188

Testing server on iccad2012
[Step=  50] | Loss=0.33902 | acc=0.9177 | tpr=0.9159 | fpr=0.0823 | 4167.5 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.35077 | acc=0.9143 | tpr=0.9403 | fpr=0.0861 | 7773.8 samples/s | 30.4 steps/s
[Step= 150] | Loss=0.36108 | acc=0.9133 | tpr=0.9409 | fpr=0.0872 | 7588.5 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.36240 | acc=0.9138 | tpr=0.9377 | fpr=0.0867 | 7617.1 samples/s | 29.8 steps/s
[Step= 250] | Loss=0.35957 | acc=0.9143 | tpr=0.9406 | fpr=0.0862 | 7538.7 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.36351 | acc=0.9143 | tpr=0.9389 | fpr=0.0862 | 7635.0 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.36623 | acc=0.9139 | tpr=0.9386 | fpr=0.0866 | 6734.8 samples/s | 26.3 steps/s
[Step= 400] | Loss=0.36769 | acc=0.9141 | tpr=0.9393 | fpr=0.0864 | 5174.0 samples/s | 20.2 steps/s
[Step= 450] | Loss=0.37174 | acc=0.9138 | tpr=0.9382 | fpr=0.0867 | 7672.7 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.36951 | acc=0.9140 | tpr=0.9396 | fpr=0.0865 | 7823.6 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.36749 | acc=0.9145 | tpr=0.9407 | fpr=0.0860 | 13487.0 samples/s | 52.7 steps/s
Avg test loss: 0.36681, Avg test acc: 0.91452, Avg tpr: 0.94097, Avg fpr: 0.08596, total FA: 11935

server round 35/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=136.5] | Loss=0.04338 | Reg=0.00160 | acc=0.9688 | L2-Norm=12.668 | L2-Norm(final)=3.433 | 4528.7 samples/s | 70.8 steps/s
[Step=28050 Epoch=136.8] | Loss=0.01060 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.701 | L2-Norm(final)=3.433 | 4246.9 samples/s | 66.4 steps/s
[Step=28100 Epoch=137.0] | Loss=0.00686 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.710 | L2-Norm(final)=3.434 | 4514.8 samples/s | 70.5 steps/s
[Step=28150 Epoch=137.3] | Loss=0.00537 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.714 | L2-Norm(final)=3.436 | 4533.0 samples/s | 70.8 steps/s
[Step=28200 Epoch=137.5] | Loss=0.00499 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.716 | L2-Norm(final)=3.438 | 6097.4 samples/s | 95.3 steps/s
[Step=28250 Epoch=137.8] | Loss=0.00442 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.717 | L2-Norm(final)=3.440 | 1947.7 samples/s | 30.4 steps/s
[Step=28300 Epoch=138.0] | Loss=0.00400 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.718 | L2-Norm(final)=3.442 | 4515.8 samples/s | 70.6 steps/s
[Step=28350 Epoch=138.2] | Loss=0.00380 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.719 | L2-Norm(final)=3.443 | 4490.3 samples/s | 70.2 steps/s
[Step=28400 Epoch=138.5] | Loss=0.00355 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.720 | L2-Norm(final)=3.445 | 5356.2 samples/s | 83.7 steps/s
[Step=28450 Epoch=138.7] | Loss=0.00335 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.721 | L2-Norm(final)=3.447 | 1991.5 samples/s | 31.1 steps/s
[Step=28500 Epoch=139.0] | Loss=0.00322 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.722 | L2-Norm(final)=3.448 | 4442.9 samples/s | 69.4 steps/s
[Step=28550 Epoch=139.2] | Loss=0.00312 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.722 | L2-Norm(final)=3.450 | 4521.6 samples/s | 70.6 steps/s
[Step=28600 Epoch=139.5] | Loss=0.00304 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.723 | L2-Norm(final)=3.451 | 5190.1 samples/s | 81.1 steps/s
[Step=28650 Epoch=139.7] | Loss=0.00293 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.723 | L2-Norm(final)=3.452 | 2015.9 samples/s | 31.5 steps/s
[Step=28700 Epoch=139.9] | Loss=0.00286 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.724 | L2-Norm(final)=3.453 | 4459.3 samples/s | 69.7 steps/s
[Step=28750 Epoch=140.2] | Loss=0.00287 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.724 | L2-Norm(final)=3.455 | 4442.0 samples/s | 69.4 steps/s
[Step=28800 Epoch=140.4] | Loss=0.00283 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.724 | L2-Norm(final)=3.456 | 4923.7 samples/s | 76.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step28800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=136.6] | Loss=0.05405 | Reg=0.00160 | acc=0.9375 | L2-Norm=12.668 | L2-Norm(final)=3.433 | 4364.7 samples/s | 68.2 steps/s
[Step=28050 Epoch=136.9] | Loss=0.01127 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.695 | L2-Norm(final)=3.430 | 4269.6 samples/s | 66.7 steps/s
[Step=28100 Epoch=137.1] | Loss=0.00775 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.702 | L2-Norm(final)=3.431 | 4425.9 samples/s | 69.2 steps/s
[Step=28150 Epoch=137.4] | Loss=0.00621 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.706 | L2-Norm(final)=3.432 | 4476.5 samples/s | 69.9 steps/s
[Step=28200 Epoch=137.6] | Loss=0.00518 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.708 | L2-Norm(final)=3.433 | 6066.2 samples/s | 94.8 steps/s
[Step=28250 Epoch=137.8] | Loss=0.00459 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.709 | L2-Norm(final)=3.435 | 1916.7 samples/s | 29.9 steps/s
[Step=28300 Epoch=138.1] | Loss=0.00410 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.710 | L2-Norm(final)=3.436 | 4534.1 samples/s | 70.8 steps/s
[Step=28350 Epoch=138.3] | Loss=0.00372 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.711 | L2-Norm(final)=3.437 | 4512.8 samples/s | 70.5 steps/s
[Step=28400 Epoch=138.6] | Loss=0.00349 | Reg=0.00162 | acc=0.9688 | L2-Norm=12.712 | L2-Norm(final)=3.439 | 5699.8 samples/s | 89.1 steps/s
[Step=28450 Epoch=138.8] | Loss=0.00332 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.712 | L2-Norm(final)=3.440 | 1970.3 samples/s | 30.8 steps/s
[Step=28500 Epoch=139.1] | Loss=0.00313 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.713 | L2-Norm(final)=3.441 | 4501.1 samples/s | 70.3 steps/s
[Step=28550 Epoch=139.3] | Loss=0.00303 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.713 | L2-Norm(final)=3.442 | 4552.9 samples/s | 71.1 steps/s
[Step=28600 Epoch=139.6] | Loss=0.00283 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.714 | L2-Norm(final)=3.444 | 5257.4 samples/s | 82.1 steps/s
[Step=28650 Epoch=139.8] | Loss=0.00275 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.714 | L2-Norm(final)=3.445 | 2017.4 samples/s | 31.5 steps/s
[Step=28700 Epoch=140.0] | Loss=0.00268 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.714 | L2-Norm(final)=3.446 | 4479.7 samples/s | 70.0 steps/s
[Step=28750 Epoch=140.3] | Loss=0.00261 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.715 | L2-Norm(final)=3.447 | 4502.2 samples/s | 70.3 steps/s
[Step=28800 Epoch=140.5] | Loss=0.00252 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.715 | L2-Norm(final)=3.448 | 5054.7 samples/s | 79.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step28800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=265.3] | Loss=0.00109 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.668 | L2-Norm(final)=3.433 | 4529.8 samples/s | 70.8 steps/s
[Step=28050 Epoch=265.8] | Loss=0.00128 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.689 | L2-Norm(final)=3.443 | 3679.4 samples/s | 57.5 steps/s
[Step=28100 Epoch=266.3] | Loss=0.00064 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.692 | L2-Norm(final)=3.445 | 5814.9 samples/s | 90.9 steps/s
[Step=28150 Epoch=266.7] | Loss=0.00043 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.691 | L2-Norm(final)=3.446 | 1853.2 samples/s | 29.0 steps/s
[Step=28200 Epoch=267.2] | Loss=0.00032 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.688 | L2-Norm(final)=3.446 | 5228.6 samples/s | 81.7 steps/s
[Step=28250 Epoch=267.7] | Loss=0.00026 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.685 | L2-Norm(final)=3.447 | 1933.8 samples/s | 30.2 steps/s
[Step=28300 Epoch=268.2] | Loss=0.00022 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.682 | L2-Norm(final)=3.447 | 4970.6 samples/s | 77.7 steps/s
[Step=28350 Epoch=268.6] | Loss=0.00019 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.679 | L2-Norm(final)=3.447 | 1990.9 samples/s | 31.1 steps/s
[Step=28400 Epoch=269.1] | Loss=0.00016 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.676 | L2-Norm(final)=3.447 | 4652.8 samples/s | 72.7 steps/s
[Step=28450 Epoch=269.6] | Loss=0.00015 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.672 | L2-Norm(final)=3.447 | 2040.5 samples/s | 31.9 steps/s
[Step=28500 Epoch=270.1] | Loss=0.00013 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.669 | L2-Norm(final)=3.447 | 4454.3 samples/s | 69.6 steps/s
[Step=28550 Epoch=270.5] | Loss=0.00012 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.666 | L2-Norm(final)=3.448 | 2089.6 samples/s | 32.7 steps/s
[Step=28600 Epoch=271.0] | Loss=0.00011 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.663 | L2-Norm(final)=3.448 | 4324.0 samples/s | 67.6 steps/s
[Step=28650 Epoch=271.5] | Loss=0.00010 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.659 | L2-Norm(final)=3.448 | 2117.0 samples/s | 33.1 steps/s
[Step=28700 Epoch=272.0] | Loss=0.00009 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.656 | L2-Norm(final)=3.448 | 4386.4 samples/s | 68.5 steps/s
[Step=28750 Epoch=272.4] | Loss=0.00009 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.653 | L2-Norm(final)=3.448 | 2134.3 samples/s | 33.3 steps/s
[Step=28800 Epoch=272.9] | Loss=0.00008 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.649 | L2-Norm(final)=3.448 | 4321.8 samples/s | 67.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step28800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=266.4] | Loss=0.01220 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.668 | L2-Norm(final)=3.433 | 4404.9 samples/s | 68.8 steps/s
[Step=28050 Epoch=266.8] | Loss=0.00145 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=3.441 | 4253.6 samples/s | 66.5 steps/s
[Step=28100 Epoch=267.3] | Loss=0.00073 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.690 | L2-Norm(final)=3.442 | 5751.7 samples/s | 89.9 steps/s
[Step=28150 Epoch=267.8] | Loss=0.00049 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.689 | L2-Norm(final)=3.442 | 1900.7 samples/s | 29.7 steps/s
[Step=28200 Epoch=268.3] | Loss=0.00037 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=3.443 | 5422.0 samples/s | 84.7 steps/s
[Step=28250 Epoch=268.7] | Loss=0.00029 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.685 | L2-Norm(final)=3.443 | 1963.2 samples/s | 30.7 steps/s
[Step=28300 Epoch=269.2] | Loss=0.00025 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.682 | L2-Norm(final)=3.444 | 4898.9 samples/s | 76.5 steps/s
[Step=28350 Epoch=269.7] | Loss=0.00021 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.680 | L2-Norm(final)=3.444 | 1984.7 samples/s | 31.0 steps/s
[Step=28400 Epoch=270.2] | Loss=0.00019 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.678 | L2-Norm(final)=3.445 | 4692.5 samples/s | 73.3 steps/s
[Step=28450 Epoch=270.6] | Loss=0.00017 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.675 | L2-Norm(final)=3.445 | 2060.0 samples/s | 32.2 steps/s
[Step=28500 Epoch=271.1] | Loss=0.00015 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=3.446 | 4432.6 samples/s | 69.3 steps/s
[Step=28550 Epoch=271.6] | Loss=0.00014 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.670 | L2-Norm(final)=3.446 | 2100.2 samples/s | 32.8 steps/s
[Step=28600 Epoch=272.1] | Loss=0.00012 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.668 | L2-Norm(final)=3.447 | 4398.9 samples/s | 68.7 steps/s
[Step=28650 Epoch=272.5] | Loss=0.00012 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.665 | L2-Norm(final)=3.447 | 1338.0 samples/s | 20.9 steps/s
[Step=28700 Epoch=273.0] | Loss=0.00011 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.662 | L2-Norm(final)=3.447 | 4407.1 samples/s | 68.9 steps/s
[Step=28750 Epoch=273.5] | Loss=0.00010 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.660 | L2-Norm(final)=3.448 | 2100.6 samples/s | 32.8 steps/s
[Step=28800 Epoch=274.0] | Loss=0.00009 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.657 | L2-Norm(final)=3.448 | 4234.8 samples/s | 66.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step28800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33944 | acc=0.8719 | tpr=0.8244 | fpr=0.0250 | 4137.5 samples/s | 16.2 steps/s
Avg test loss: 0.34330, Avg test acc: 0.87046, Avg tpr: 0.82380, Avg fpr: 0.02692, total FA: 210

Testing server on iccad2012
[Step=  50] | Loss=0.35713 | acc=0.9115 | tpr=0.9159 | fpr=0.0886 | 4271.8 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.36972 | acc=0.9086 | tpr=0.9403 | fpr=0.0920 | 7526.9 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.37989 | acc=0.9078 | tpr=0.9424 | fpr=0.0929 | 7851.8 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.38133 | acc=0.9079 | tpr=0.9388 | fpr=0.0927 | 7580.8 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.37854 | acc=0.9080 | tpr=0.9424 | fpr=0.0926 | 7475.0 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.38223 | acc=0.9082 | tpr=0.9396 | fpr=0.0924 | 7778.0 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.38513 | acc=0.9079 | tpr=0.9399 | fpr=0.0927 | 7858.7 samples/s | 30.7 steps/s
[Step= 400] | Loss=0.38672 | acc=0.9081 | tpr=0.9398 | fpr=0.0925 | 7656.2 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.39068 | acc=0.9078 | tpr=0.9382 | fpr=0.0928 | 7611.7 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.38842 | acc=0.9079 | tpr=0.9396 | fpr=0.0927 | 7734.6 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.38631 | acc=0.9086 | tpr=0.9407 | fpr=0.0920 | 13174.4 samples/s | 51.5 steps/s
Avg test loss: 0.38556, Avg test acc: 0.90862, Avg tpr: 0.94097, Avg fpr: 0.09196, total FA: 12769

server round 36/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=140.4] | Loss=0.09741 | Reg=0.00160 | acc=0.9375 | L2-Norm=12.640 | L2-Norm(final)=3.460 | 4846.0 samples/s | 75.7 steps/s
[Step=28850 Epoch=140.7] | Loss=0.01183 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.673 | L2-Norm(final)=3.454 | 4318.8 samples/s | 67.5 steps/s
[Step=28900 Epoch=140.9] | Loss=0.00857 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.681 | L2-Norm(final)=3.454 | 4478.0 samples/s | 70.0 steps/s
[Step=28950 Epoch=141.2] | Loss=0.00656 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.685 | L2-Norm(final)=3.456 | 4507.1 samples/s | 70.4 steps/s
[Step=29000 Epoch=141.4] | Loss=0.00551 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.688 | L2-Norm(final)=3.458 | 6131.5 samples/s | 95.8 steps/s
[Step=29050 Epoch=141.7] | Loss=0.00499 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.690 | L2-Norm(final)=3.459 | 1971.6 samples/s | 30.8 steps/s
[Step=29100 Epoch=141.9] | Loss=0.00436 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.691 | L2-Norm(final)=3.461 | 4561.0 samples/s | 71.3 steps/s
[Step=29150 Epoch=142.1] | Loss=0.00398 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.692 | L2-Norm(final)=3.463 | 4516.5 samples/s | 70.6 steps/s
[Step=29200 Epoch=142.4] | Loss=0.00379 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.693 | L2-Norm(final)=3.464 | 5589.6 samples/s | 87.3 steps/s
[Step=29250 Epoch=142.6] | Loss=0.00351 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.693 | L2-Norm(final)=3.466 | 1997.1 samples/s | 31.2 steps/s
[Step=29300 Epoch=142.9] | Loss=0.00334 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.694 | L2-Norm(final)=3.467 | 4507.2 samples/s | 70.4 steps/s
[Step=29350 Epoch=143.1] | Loss=0.00321 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.694 | L2-Norm(final)=3.469 | 4423.1 samples/s | 69.1 steps/s
[Step=29400 Epoch=143.4] | Loss=0.00307 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.695 | L2-Norm(final)=3.470 | 5190.4 samples/s | 81.1 steps/s
[Step=29450 Epoch=143.6] | Loss=0.00304 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.695 | L2-Norm(final)=3.472 | 2054.9 samples/s | 32.1 steps/s
[Step=29500 Epoch=143.8] | Loss=0.00292 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.696 | L2-Norm(final)=3.473 | 4384.8 samples/s | 68.5 steps/s
[Step=29550 Epoch=144.1] | Loss=0.00288 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.696 | L2-Norm(final)=3.474 | 4324.3 samples/s | 67.6 steps/s
[Step=29600 Epoch=144.3] | Loss=0.00284 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.696 | L2-Norm(final)=3.476 | 4957.4 samples/s | 77.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step29600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=140.5] | Loss=0.10838 | Reg=0.00160 | acc=0.9219 | L2-Norm=12.640 | L2-Norm(final)=3.460 | 4421.5 samples/s | 69.1 steps/s
[Step=28850 Epoch=140.8] | Loss=0.01312 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.676 | L2-Norm(final)=3.454 | 4213.4 samples/s | 65.8 steps/s
[Step=28900 Epoch=141.0] | Loss=0.00817 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.685 | L2-Norm(final)=3.454 | 4405.7 samples/s | 68.8 steps/s
[Step=28950 Epoch=141.3] | Loss=0.00597 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.688 | L2-Norm(final)=3.455 | 4335.1 samples/s | 67.7 steps/s
[Step=29000 Epoch=141.5] | Loss=0.00562 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.690 | L2-Norm(final)=3.456 | 6024.0 samples/s | 94.1 steps/s
[Step=29050 Epoch=141.8] | Loss=0.00482 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.692 | L2-Norm(final)=3.457 | 1943.6 samples/s | 30.4 steps/s
[Step=29100 Epoch=142.0] | Loss=0.00437 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.693 | L2-Norm(final)=3.458 | 4498.9 samples/s | 70.3 steps/s
[Step=29150 Epoch=142.2] | Loss=0.00399 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.693 | L2-Norm(final)=3.459 | 4521.2 samples/s | 70.6 steps/s
[Step=29200 Epoch=142.5] | Loss=0.00374 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.694 | L2-Norm(final)=3.460 | 5722.6 samples/s | 89.4 steps/s
[Step=29250 Epoch=142.7] | Loss=0.00364 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.695 | L2-Norm(final)=3.461 | 1936.3 samples/s | 30.3 steps/s
[Step=29300 Epoch=143.0] | Loss=0.00345 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.695 | L2-Norm(final)=3.462 | 4404.7 samples/s | 68.8 steps/s
[Step=29350 Epoch=143.2] | Loss=0.00325 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.695 | L2-Norm(final)=3.463 | 4408.2 samples/s | 68.9 steps/s
[Step=29400 Epoch=143.5] | Loss=0.00304 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.696 | L2-Norm(final)=3.463 | 5343.0 samples/s | 83.5 steps/s
[Step=29450 Epoch=143.7] | Loss=0.00297 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.696 | L2-Norm(final)=3.464 | 2010.5 samples/s | 31.4 steps/s
[Step=29500 Epoch=143.9] | Loss=0.00287 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.696 | L2-Norm(final)=3.465 | 4565.1 samples/s | 71.3 steps/s
[Step=29550 Epoch=144.2] | Loss=0.00276 | Reg=0.00161 | acc=0.9844 | L2-Norm=12.696 | L2-Norm(final)=3.466 | 4438.1 samples/s | 69.3 steps/s
[Step=29600 Epoch=144.4] | Loss=0.00268 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.697 | L2-Norm(final)=3.467 | 5118.4 samples/s | 80.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step29600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=272.9] | Loss=0.00087 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.640 | L2-Norm(final)=3.460 | 4144.9 samples/s | 64.8 steps/s
[Step=28850 Epoch=273.4] | Loss=0.00165 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.660 | L2-Norm(final)=3.467 | 4076.5 samples/s | 63.7 steps/s
[Step=28900 Epoch=273.9] | Loss=0.00083 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.663 | L2-Norm(final)=3.469 | 5842.3 samples/s | 91.3 steps/s
[Step=28950 Epoch=274.3] | Loss=0.00055 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.661 | L2-Norm(final)=3.470 | 1899.4 samples/s | 29.7 steps/s
[Step=29000 Epoch=274.8] | Loss=0.00041 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.659 | L2-Norm(final)=3.470 | 5360.5 samples/s | 83.8 steps/s
[Step=29050 Epoch=275.3] | Loss=0.00033 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.656 | L2-Norm(final)=3.470 | 1946.4 samples/s | 30.4 steps/s
[Step=29100 Epoch=275.7] | Loss=0.00028 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.652 | L2-Norm(final)=3.471 | 5045.3 samples/s | 78.8 steps/s
[Step=29150 Epoch=276.2] | Loss=0.00024 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.649 | L2-Norm(final)=3.471 | 2004.9 samples/s | 31.3 steps/s
[Step=29200 Epoch=276.7] | Loss=0.00021 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.645 | L2-Norm(final)=3.471 | 4634.3 samples/s | 72.4 steps/s
[Step=29250 Epoch=277.2] | Loss=0.00019 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.642 | L2-Norm(final)=3.471 | 2073.9 samples/s | 32.4 steps/s
[Step=29300 Epoch=277.6] | Loss=0.00017 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.638 | L2-Norm(final)=3.471 | 4438.7 samples/s | 69.4 steps/s
[Step=29350 Epoch=278.1] | Loss=0.00015 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.635 | L2-Norm(final)=3.471 | 2096.5 samples/s | 32.8 steps/s
[Step=29400 Epoch=278.6] | Loss=0.00014 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.631 | L2-Norm(final)=3.471 | 4389.5 samples/s | 68.6 steps/s
[Step=29450 Epoch=279.1] | Loss=0.00013 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=3.471 | 2064.3 samples/s | 32.3 steps/s
[Step=29500 Epoch=279.5] | Loss=0.00012 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.624 | L2-Norm(final)=3.472 | 4316.2 samples/s | 67.4 steps/s
[Step=29550 Epoch=280.0] | Loss=0.00011 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.620 | L2-Norm(final)=3.472 | 2137.0 samples/s | 33.4 steps/s
[Step=29600 Epoch=280.5] | Loss=0.00011 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.616 | L2-Norm(final)=3.472 | 4229.1 samples/s | 66.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step29600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=274.0] | Loss=0.00331 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.640 | L2-Norm(final)=3.460 | 4560.6 samples/s | 71.3 steps/s
[Step=28850 Epoch=274.4] | Loss=0.00307 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.663 | L2-Norm(final)=3.461 | 3704.3 samples/s | 57.9 steps/s
[Step=28900 Epoch=274.9] | Loss=0.00154 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.667 | L2-Norm(final)=3.460 | 5942.0 samples/s | 92.8 steps/s
[Step=28950 Epoch=275.4] | Loss=0.00103 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.666 | L2-Norm(final)=3.460 | 1894.1 samples/s | 29.6 steps/s
[Step=29000 Epoch=275.9] | Loss=0.00077 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.665 | L2-Norm(final)=3.461 | 5395.5 samples/s | 84.3 steps/s
[Step=29050 Epoch=276.3] | Loss=0.00062 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.663 | L2-Norm(final)=3.461 | 1926.0 samples/s | 30.1 steps/s
[Step=29100 Epoch=276.8] | Loss=0.00052 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.661 | L2-Norm(final)=3.461 | 4978.0 samples/s | 77.8 steps/s
[Step=29150 Epoch=277.3] | Loss=0.00045 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.659 | L2-Norm(final)=3.461 | 2009.7 samples/s | 31.4 steps/s
[Step=29200 Epoch=277.8] | Loss=0.00039 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.657 | L2-Norm(final)=3.462 | 4586.0 samples/s | 71.7 steps/s
[Step=29250 Epoch=278.2] | Loss=0.00035 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.655 | L2-Norm(final)=3.462 | 2056.3 samples/s | 32.1 steps/s
[Step=29300 Epoch=278.7] | Loss=0.00031 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.652 | L2-Norm(final)=3.462 | 4266.6 samples/s | 66.7 steps/s
[Step=29350 Epoch=279.2] | Loss=0.00029 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.650 | L2-Norm(final)=3.462 | 2120.1 samples/s | 33.1 steps/s
[Step=29400 Epoch=279.7] | Loss=0.00026 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.648 | L2-Norm(final)=3.463 | 4212.9 samples/s | 65.8 steps/s
[Step=29450 Epoch=280.1] | Loss=0.00024 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.646 | L2-Norm(final)=3.463 | 2110.6 samples/s | 33.0 steps/s
[Step=29500 Epoch=280.6] | Loss=0.00023 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.643 | L2-Norm(final)=3.463 | 4263.5 samples/s | 66.6 steps/s
[Step=29550 Epoch=281.1] | Loss=0.00021 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.641 | L2-Norm(final)=3.463 | 2127.5 samples/s | 33.2 steps/s
[Step=29600 Epoch=281.6] | Loss=0.00020 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.638 | L2-Norm(final)=3.463 | 4335.3 samples/s | 67.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step29600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29885 | acc=0.8839 | tpr=0.8422 | fpr=0.0255 | 4130.7 samples/s | 16.1 steps/s
Avg test loss: 0.30393, Avg test acc: 0.88216, Avg tpr: 0.84135, Avg fpr: 0.02807, total FA: 219

Testing server on iccad2012
[Step=  50] | Loss=0.38136 | acc=0.8996 | tpr=0.9204 | fpr=0.1008 | 4181.1 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.39608 | acc=0.8968 | tpr=0.9446 | fpr=0.1041 | 7517.8 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.40653 | acc=0.8965 | tpr=0.9496 | fpr=0.1045 | 7576.2 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.40730 | acc=0.8974 | tpr=0.9486 | fpr=0.1035 | 7860.9 samples/s | 30.7 steps/s
[Step= 250] | Loss=0.40470 | acc=0.8977 | tpr=0.9520 | fpr=0.1033 | 7612.8 samples/s | 29.7 steps/s
[Step= 300] | Loss=0.40843 | acc=0.8980 | tpr=0.9491 | fpr=0.1029 | 7704.4 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.41120 | acc=0.8976 | tpr=0.9487 | fpr=0.1033 | 7742.4 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.41262 | acc=0.8978 | tpr=0.9486 | fpr=0.1032 | 7765.2 samples/s | 30.3 steps/s
[Step= 450] | Loss=0.41638 | acc=0.8975 | tpr=0.9479 | fpr=0.1034 | 7438.6 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.41417 | acc=0.8976 | tpr=0.9485 | fpr=0.1033 | 8019.5 samples/s | 31.3 steps/s
[Step= 550] | Loss=0.41185 | acc=0.8984 | tpr=0.9491 | fpr=0.1025 | 14007.1 samples/s | 54.7 steps/s
Avg test loss: 0.41117, Avg test acc: 0.89852, Avg tpr: 0.94929, Avg fpr: 0.10241, total FA: 14219

server round 37/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=144.3] | Loss=0.16291 | Reg=0.00159 | acc=0.9375 | L2-Norm=12.612 | L2-Norm(final)=3.478 | 4472.9 samples/s | 69.9 steps/s
[Step=29650 Epoch=144.6] | Loss=0.00836 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.639 | L2-Norm(final)=3.481 | 4399.2 samples/s | 68.7 steps/s
[Step=29700 Epoch=144.8] | Loss=0.00570 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.645 | L2-Norm(final)=3.483 | 4541.1 samples/s | 71.0 steps/s
[Step=29750 Epoch=145.1] | Loss=0.00447 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.648 | L2-Norm(final)=3.485 | 4462.9 samples/s | 69.7 steps/s
[Step=29800 Epoch=145.3] | Loss=0.00389 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.649 | L2-Norm(final)=3.488 | 6100.1 samples/s | 95.3 steps/s
[Step=29850 Epoch=145.6] | Loss=0.00359 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.651 | L2-Norm(final)=3.490 | 1937.2 samples/s | 30.3 steps/s
[Step=29900 Epoch=145.8] | Loss=0.00338 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.652 | L2-Norm(final)=3.492 | 4427.6 samples/s | 69.2 steps/s
[Step=29950 Epoch=146.0] | Loss=0.00327 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.653 | L2-Norm(final)=3.493 | 4435.6 samples/s | 69.3 steps/s
[Step=30000 Epoch=146.3] | Loss=0.00305 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.654 | L2-Norm(final)=3.495 | 5673.3 samples/s | 88.6 steps/s
[Step=30050 Epoch=146.5] | Loss=0.00288 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.655 | L2-Norm(final)=3.496 | 2010.8 samples/s | 31.4 steps/s
[Step=30100 Epoch=146.8] | Loss=0.00271 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.655 | L2-Norm(final)=3.498 | 4541.3 samples/s | 71.0 steps/s
[Step=30150 Epoch=147.0] | Loss=0.00259 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.656 | L2-Norm(final)=3.499 | 4555.5 samples/s | 71.2 steps/s
[Step=30200 Epoch=147.3] | Loss=0.00260 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.656 | L2-Norm(final)=3.501 | 5255.2 samples/s | 82.1 steps/s
[Step=30250 Epoch=147.5] | Loss=0.00260 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.657 | L2-Norm(final)=3.502 | 2067.6 samples/s | 32.3 steps/s
[Step=30300 Epoch=147.7] | Loss=0.00253 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.657 | L2-Norm(final)=3.503 | 4598.2 samples/s | 71.8 steps/s
[Step=30350 Epoch=148.0] | Loss=0.00251 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.657 | L2-Norm(final)=3.504 | 4544.4 samples/s | 71.0 steps/s
[Step=30400 Epoch=148.2] | Loss=0.00249 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.658 | L2-Norm(final)=3.506 | 4821.5 samples/s | 75.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step30400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=144.4] | Loss=0.07831 | Reg=0.00159 | acc=0.9531 | L2-Norm=12.612 | L2-Norm(final)=3.478 | 4262.5 samples/s | 66.6 steps/s
[Step=29650 Epoch=144.7] | Loss=0.01238 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.638 | L2-Norm(final)=3.476 | 4572.0 samples/s | 71.4 steps/s
[Step=29700 Epoch=144.9] | Loss=0.00804 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.645 | L2-Norm(final)=3.476 | 4593.0 samples/s | 71.8 steps/s
[Step=29750 Epoch=145.2] | Loss=0.00620 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.648 | L2-Norm(final)=3.477 | 4418.8 samples/s | 69.0 steps/s
[Step=29800 Epoch=145.4] | Loss=0.00534 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.650 | L2-Norm(final)=3.478 | 5945.4 samples/s | 92.9 steps/s
[Step=29850 Epoch=145.7] | Loss=0.00465 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.652 | L2-Norm(final)=3.480 | 1952.2 samples/s | 30.5 steps/s
[Step=29900 Epoch=145.9] | Loss=0.00414 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.653 | L2-Norm(final)=3.481 | 4492.1 samples/s | 70.2 steps/s
[Step=29950 Epoch=146.1] | Loss=0.00378 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.654 | L2-Norm(final)=3.483 | 4601.9 samples/s | 71.9 steps/s
[Step=30000 Epoch=146.4] | Loss=0.00358 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.655 | L2-Norm(final)=3.484 | 5712.0 samples/s | 89.3 steps/s
[Step=30050 Epoch=146.6] | Loss=0.00335 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.655 | L2-Norm(final)=3.485 | 1981.1 samples/s | 31.0 steps/s
[Step=30100 Epoch=146.9] | Loss=0.00318 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.656 | L2-Norm(final)=3.486 | 4454.2 samples/s | 69.6 steps/s
[Step=30150 Epoch=147.1] | Loss=0.00306 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.656 | L2-Norm(final)=3.488 | 4506.0 samples/s | 70.4 steps/s
[Step=30200 Epoch=147.4] | Loss=0.00292 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.657 | L2-Norm(final)=3.489 | 5314.3 samples/s | 83.0 steps/s
[Step=30250 Epoch=147.6] | Loss=0.00282 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.657 | L2-Norm(final)=3.490 | 2031.8 samples/s | 31.7 steps/s
[Step=30300 Epoch=147.8] | Loss=0.00269 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.657 | L2-Norm(final)=3.491 | 4354.9 samples/s | 68.0 steps/s
[Step=30350 Epoch=148.1] | Loss=0.00269 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.658 | L2-Norm(final)=3.492 | 4434.4 samples/s | 69.3 steps/s
[Step=30400 Epoch=148.3] | Loss=0.00258 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.658 | L2-Norm(final)=3.493 | 4995.9 samples/s | 78.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step30400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=280.5] | Loss=0.00099 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.612 | L2-Norm(final)=3.479 | 4362.9 samples/s | 68.2 steps/s
[Step=29650 Epoch=281.0] | Loss=0.00148 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.637 | L2-Norm(final)=3.486 | 4068.3 samples/s | 63.6 steps/s
[Step=29700 Epoch=281.4] | Loss=0.00075 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.641 | L2-Norm(final)=3.487 | 5773.7 samples/s | 90.2 steps/s
[Step=29750 Epoch=281.9] | Loss=0.00050 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.640 | L2-Norm(final)=3.487 | 1893.2 samples/s | 29.6 steps/s
[Step=29800 Epoch=282.4] | Loss=0.00038 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.638 | L2-Norm(final)=3.488 | 5383.3 samples/s | 84.1 steps/s
[Step=29850 Epoch=282.9] | Loss=0.00030 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.635 | L2-Norm(final)=3.488 | 1949.8 samples/s | 30.5 steps/s
[Step=29900 Epoch=283.3] | Loss=0.00025 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.633 | L2-Norm(final)=3.489 | 4907.0 samples/s | 76.7 steps/s
[Step=29950 Epoch=283.8] | Loss=0.00022 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.629 | L2-Norm(final)=3.489 | 2010.7 samples/s | 31.4 steps/s
[Step=30000 Epoch=284.3] | Loss=0.00019 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.626 | L2-Norm(final)=3.490 | 4558.7 samples/s | 71.2 steps/s
[Step=30050 Epoch=284.7] | Loss=0.00017 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.623 | L2-Norm(final)=3.490 | 2052.8 samples/s | 32.1 steps/s
[Step=30100 Epoch=285.2] | Loss=0.00015 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.620 | L2-Norm(final)=3.490 | 4295.2 samples/s | 67.1 steps/s
[Step=30150 Epoch=285.7] | Loss=0.00014 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.616 | L2-Norm(final)=3.491 | 2102.4 samples/s | 32.9 steps/s
[Step=30200 Epoch=286.2] | Loss=0.00013 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.613 | L2-Norm(final)=3.491 | 4161.7 samples/s | 65.0 steps/s
[Step=30250 Epoch=286.6] | Loss=0.00012 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.610 | L2-Norm(final)=3.492 | 2136.5 samples/s | 33.4 steps/s
[Step=30300 Epoch=287.1] | Loss=0.00011 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.606 | L2-Norm(final)=3.492 | 4335.4 samples/s | 67.7 steps/s
[Step=30350 Epoch=287.6] | Loss=0.00010 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.603 | L2-Norm(final)=3.493 | 2137.1 samples/s | 33.4 steps/s
[Step=30400 Epoch=288.1] | Loss=0.00010 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.599 | L2-Norm(final)=3.493 | 4427.7 samples/s | 69.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step30400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=281.6] | Loss=0.03523 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.612 | L2-Norm(final)=3.478 | 4993.9 samples/s | 78.0 steps/s
[Step=29650 Epoch=282.0] | Loss=0.00220 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.641 | L2-Norm(final)=3.483 | 3784.3 samples/s | 59.1 steps/s
[Step=29700 Epoch=282.5] | Loss=0.00111 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.647 | L2-Norm(final)=3.484 | 5884.9 samples/s | 92.0 steps/s
[Step=29750 Epoch=283.0] | Loss=0.00074 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.647 | L2-Norm(final)=3.485 | 1877.9 samples/s | 29.3 steps/s
[Step=29800 Epoch=283.5] | Loss=0.00056 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.645 | L2-Norm(final)=3.485 | 5380.7 samples/s | 84.1 steps/s
[Step=29850 Epoch=283.9] | Loss=0.00045 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.644 | L2-Norm(final)=3.485 | 1941.6 samples/s | 30.3 steps/s
[Step=29900 Epoch=284.4] | Loss=0.00037 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.642 | L2-Norm(final)=3.485 | 5077.4 samples/s | 79.3 steps/s
[Step=29950 Epoch=284.9] | Loss=0.00032 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.640 | L2-Norm(final)=3.485 | 1994.5 samples/s | 31.2 steps/s
[Step=30000 Epoch=285.4] | Loss=0.00028 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.637 | L2-Norm(final)=3.485 | 4604.0 samples/s | 71.9 steps/s
[Step=30050 Epoch=285.9] | Loss=0.00025 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.635 | L2-Norm(final)=3.486 | 2056.6 samples/s | 32.1 steps/s
[Step=30100 Epoch=286.3] | Loss=0.00023 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.633 | L2-Norm(final)=3.486 | 4337.7 samples/s | 67.8 steps/s
[Step=30150 Epoch=286.8] | Loss=0.00021 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.631 | L2-Norm(final)=3.486 | 2128.6 samples/s | 33.3 steps/s
[Step=30200 Epoch=287.3] | Loss=0.00019 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=3.486 | 4106.9 samples/s | 64.2 steps/s
[Step=30250 Epoch=287.8] | Loss=0.00017 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.626 | L2-Norm(final)=3.486 | 2026.7 samples/s | 31.7 steps/s
[Step=30300 Epoch=288.2] | Loss=0.00016 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.624 | L2-Norm(final)=3.486 | 4132.2 samples/s | 64.6 steps/s
[Step=30350 Epoch=288.7] | Loss=0.00015 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.621 | L2-Norm(final)=3.486 | 2066.3 samples/s | 32.3 steps/s
[Step=30400 Epoch=289.2] | Loss=0.00014 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.619 | L2-Norm(final)=3.486 | 3957.8 samples/s | 61.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step30400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39592 | acc=0.8498 | tpr=0.7895 | fpr=0.0193 | 3843.3 samples/s | 15.0 steps/s
Avg test loss: 0.40195, Avg test acc: 0.84762, Avg tpr: 0.78784, Avg fpr: 0.02089, total FA: 163

Testing server on iccad2012
[Step=  50] | Loss=0.30907 | acc=0.9277 | tpr=0.9159 | fpr=0.0721 | 3871.9 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.32111 | acc=0.9250 | tpr=0.9403 | fpr=0.0753 | 7052.3 samples/s | 27.5 steps/s
[Step= 150] | Loss=0.33165 | acc=0.9240 | tpr=0.9395 | fpr=0.0763 | 7294.9 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.33270 | acc=0.9244 | tpr=0.9366 | fpr=0.0758 | 6943.7 samples/s | 27.1 steps/s
[Step= 250] | Loss=0.33012 | acc=0.9247 | tpr=0.9415 | fpr=0.0756 | 7164.1 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.33422 | acc=0.9245 | tpr=0.9389 | fpr=0.0758 | 7090.5 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.33703 | acc=0.9240 | tpr=0.9374 | fpr=0.0763 | 7244.7 samples/s | 28.3 steps/s
[Step= 400] | Loss=0.33852 | acc=0.9243 | tpr=0.9371 | fpr=0.0760 | 6987.9 samples/s | 27.3 steps/s
[Step= 450] | Loss=0.34243 | acc=0.9239 | tpr=0.9362 | fpr=0.0763 | 7083.0 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.34017 | acc=0.9242 | tpr=0.9379 | fpr=0.0761 | 7362.0 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.33817 | acc=0.9246 | tpr=0.9387 | fpr=0.0756 | 12484.0 samples/s | 48.8 steps/s
Avg test loss: 0.33753, Avg test acc: 0.92465, Avg tpr: 0.93899, Avg fpr: 0.07562, total FA: 10499

server round 38/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=148.2] | Loss=0.21044 | Reg=0.00158 | acc=0.9062 | L2-Norm=12.587 | L2-Norm(final)=3.504 | 4527.8 samples/s | 70.7 steps/s
[Step=30450 Epoch=148.5] | Loss=0.01600 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=3.498 | 3878.5 samples/s | 60.6 steps/s
[Step=30500 Epoch=148.7] | Loss=0.00989 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.637 | L2-Norm(final)=3.497 | 4292.2 samples/s | 67.1 steps/s
[Step=30550 Epoch=149.0] | Loss=0.00745 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.641 | L2-Norm(final)=3.498 | 4196.5 samples/s | 65.6 steps/s
[Step=30600 Epoch=149.2] | Loss=0.00631 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.644 | L2-Norm(final)=3.499 | 5654.8 samples/s | 88.4 steps/s
[Step=30650 Epoch=149.5] | Loss=0.00529 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.646 | L2-Norm(final)=3.501 | 1865.3 samples/s | 29.1 steps/s
[Step=30700 Epoch=149.7] | Loss=0.00479 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.647 | L2-Norm(final)=3.502 | 4207.1 samples/s | 65.7 steps/s
[Step=30750 Epoch=149.9] | Loss=0.00453 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.648 | L2-Norm(final)=3.504 | 4253.8 samples/s | 66.5 steps/s
[Step=30800 Epoch=150.2] | Loss=0.00425 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.649 | L2-Norm(final)=3.505 | 5299.7 samples/s | 82.8 steps/s
[Step=30850 Epoch=150.4] | Loss=0.00389 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.649 | L2-Norm(final)=3.506 | 1944.3 samples/s | 30.4 steps/s
[Step=30900 Epoch=150.7] | Loss=0.00366 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.650 | L2-Norm(final)=3.507 | 4221.1 samples/s | 66.0 steps/s
[Step=30950 Epoch=150.9] | Loss=0.00350 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.650 | L2-Norm(final)=3.508 | 4267.6 samples/s | 66.7 steps/s
[Step=31000 Epoch=151.2] | Loss=0.00339 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.650 | L2-Norm(final)=3.509 | 4957.2 samples/s | 77.5 steps/s
[Step=31050 Epoch=151.4] | Loss=0.00325 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.651 | L2-Norm(final)=3.511 | 1979.7 samples/s | 30.9 steps/s
[Step=31100 Epoch=151.6] | Loss=0.00313 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.651 | L2-Norm(final)=3.512 | 4287.4 samples/s | 67.0 steps/s
[Step=31150 Epoch=151.9] | Loss=0.00309 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.651 | L2-Norm(final)=3.513 | 4338.7 samples/s | 67.8 steps/s
[Step=31200 Epoch=152.1] | Loss=0.00302 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.651 | L2-Norm(final)=3.514 | 4666.0 samples/s | 72.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step31200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=148.3] | Loss=0.06944 | Reg=0.00158 | acc=0.9531 | L2-Norm=12.587 | L2-Norm(final)=3.504 | 4214.2 samples/s | 65.8 steps/s
[Step=30450 Epoch=148.6] | Loss=0.01333 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.623 | L2-Norm(final)=3.498 | 3996.4 samples/s | 62.4 steps/s
[Step=30500 Epoch=148.8] | Loss=0.00759 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.632 | L2-Norm(final)=3.498 | 4299.1 samples/s | 67.2 steps/s
[Step=30550 Epoch=149.1] | Loss=0.00583 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.636 | L2-Norm(final)=3.500 | 4317.3 samples/s | 67.5 steps/s
[Step=30600 Epoch=149.3] | Loss=0.00511 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.638 | L2-Norm(final)=3.502 | 5955.7 samples/s | 93.1 steps/s
[Step=30650 Epoch=149.6] | Loss=0.00442 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.640 | L2-Norm(final)=3.504 | 1855.1 samples/s | 29.0 steps/s
[Step=30700 Epoch=149.8] | Loss=0.00403 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.641 | L2-Norm(final)=3.505 | 4272.4 samples/s | 66.8 steps/s
[Step=30750 Epoch=150.0] | Loss=0.00372 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.642 | L2-Norm(final)=3.507 | 4232.1 samples/s | 66.1 steps/s
[Step=30800 Epoch=150.3] | Loss=0.00338 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.642 | L2-Norm(final)=3.508 | 5519.3 samples/s | 86.2 steps/s
[Step=30850 Epoch=150.5] | Loss=0.00315 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.643 | L2-Norm(final)=3.510 | 1913.5 samples/s | 29.9 steps/s
[Step=30900 Epoch=150.8] | Loss=0.00305 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.643 | L2-Norm(final)=3.511 | 4316.2 samples/s | 67.4 steps/s
[Step=30950 Epoch=151.0] | Loss=0.00291 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.644 | L2-Norm(final)=3.512 | 4288.9 samples/s | 67.0 steps/s
[Step=31000 Epoch=151.3] | Loss=0.00279 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.644 | L2-Norm(final)=3.514 | 5243.2 samples/s | 81.9 steps/s
[Step=31050 Epoch=151.5] | Loss=0.00270 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.644 | L2-Norm(final)=3.515 | 1955.3 samples/s | 30.6 steps/s
[Step=31100 Epoch=151.8] | Loss=0.00261 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.645 | L2-Norm(final)=3.516 | 4261.0 samples/s | 66.6 steps/s
[Step=31150 Epoch=152.0] | Loss=0.00251 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.645 | L2-Norm(final)=3.517 | 4220.5 samples/s | 65.9 steps/s
[Step=31200 Epoch=152.2] | Loss=0.00247 | Reg=0.00160 | acc=0.9844 | L2-Norm=12.645 | L2-Norm(final)=3.519 | 4882.4 samples/s | 76.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step31200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=288.1] | Loss=0.00121 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.587 | L2-Norm(final)=3.504 | 4137.1 samples/s | 64.6 steps/s
[Step=30450 Epoch=288.5] | Loss=0.00056 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.609 | L2-Norm(final)=3.516 | 4001.0 samples/s | 62.5 steps/s
[Step=30500 Epoch=289.0] | Loss=0.00028 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.611 | L2-Norm(final)=3.518 | 5701.3 samples/s | 89.1 steps/s
[Step=30550 Epoch=289.5] | Loss=0.00019 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.609 | L2-Norm(final)=3.518 | 1813.2 samples/s | 28.3 steps/s
[Step=30600 Epoch=290.0] | Loss=0.00014 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.606 | L2-Norm(final)=3.519 | 5185.7 samples/s | 81.0 steps/s
[Step=30650 Epoch=290.4] | Loss=0.00011 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.602 | L2-Norm(final)=3.519 | 1863.9 samples/s | 29.1 steps/s
[Step=30700 Epoch=290.9] | Loss=0.00010 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.599 | L2-Norm(final)=3.519 | 4668.5 samples/s | 72.9 steps/s
[Step=30750 Epoch=291.4] | Loss=0.00008 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.595 | L2-Norm(final)=3.520 | 1938.5 samples/s | 30.3 steps/s
[Step=30800 Epoch=291.9] | Loss=0.00007 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.591 | L2-Norm(final)=3.520 | 4467.1 samples/s | 69.8 steps/s
[Step=30850 Epoch=292.3] | Loss=0.00006 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.588 | L2-Norm(final)=3.520 | 1972.6 samples/s | 30.8 steps/s
[Step=30900 Epoch=292.8] | Loss=0.00006 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.584 | L2-Norm(final)=3.520 | 4093.1 samples/s | 64.0 steps/s
[Step=30950 Epoch=293.3] | Loss=0.00005 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.580 | L2-Norm(final)=3.520 | 2025.8 samples/s | 31.7 steps/s
[Step=31000 Epoch=293.8] | Loss=0.00005 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.576 | L2-Norm(final)=3.521 | 4133.8 samples/s | 64.6 steps/s
[Step=31050 Epoch=294.2] | Loss=0.00005 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.572 | L2-Norm(final)=3.521 | 2060.4 samples/s | 32.2 steps/s
[Step=31100 Epoch=294.7] | Loss=0.00004 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.568 | L2-Norm(final)=3.521 | 4096.0 samples/s | 64.0 steps/s
[Step=31150 Epoch=295.2] | Loss=0.00004 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.564 | L2-Norm(final)=3.521 | 2078.8 samples/s | 32.5 steps/s
[Step=31200 Epoch=295.6] | Loss=0.00004 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.560 | L2-Norm(final)=3.521 | 3979.7 samples/s | 62.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step31200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=289.2] | Loss=0.04694 | Reg=0.00158 | acc=0.9688 | L2-Norm=12.587 | L2-Norm(final)=3.504 | 4278.0 samples/s | 66.8 steps/s
[Step=30450 Epoch=289.7] | Loss=0.00127 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.602 | L2-Norm(final)=3.512 | 3836.6 samples/s | 59.9 steps/s
[Step=30500 Epoch=290.1] | Loss=0.00064 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.603 | L2-Norm(final)=3.514 | 5607.1 samples/s | 87.6 steps/s
[Step=30550 Epoch=290.6] | Loss=0.00043 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.602 | L2-Norm(final)=3.515 | 1813.5 samples/s | 28.3 steps/s
[Step=30600 Epoch=291.1] | Loss=0.00032 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.600 | L2-Norm(final)=3.516 | 5178.7 samples/s | 80.9 steps/s
[Step=30650 Epoch=291.6] | Loss=0.00026 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.597 | L2-Norm(final)=3.516 | 1847.5 samples/s | 28.9 steps/s
[Step=30700 Epoch=292.0] | Loss=0.00022 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.595 | L2-Norm(final)=3.516 | 4795.7 samples/s | 74.9 steps/s
[Step=30750 Epoch=292.5] | Loss=0.00019 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.592 | L2-Norm(final)=3.516 | 1914.4 samples/s | 29.9 steps/s
[Step=30800 Epoch=293.0] | Loss=0.00016 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.590 | L2-Norm(final)=3.517 | 4399.3 samples/s | 68.7 steps/s
[Step=30850 Epoch=293.5] | Loss=0.00014 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.587 | L2-Norm(final)=3.517 | 1967.9 samples/s | 30.7 steps/s
[Step=30900 Epoch=293.9] | Loss=0.00013 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.584 | L2-Norm(final)=3.517 | 4075.4 samples/s | 63.7 steps/s
[Step=30950 Epoch=294.4] | Loss=0.00012 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.582 | L2-Norm(final)=3.517 | 2024.0 samples/s | 31.6 steps/s
[Step=31000 Epoch=294.9] | Loss=0.00011 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.579 | L2-Norm(final)=3.517 | 4099.6 samples/s | 64.1 steps/s
[Step=31050 Epoch=295.4] | Loss=0.00010 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.576 | L2-Norm(final)=3.517 | 2033.9 samples/s | 31.8 steps/s
[Step=31100 Epoch=295.8] | Loss=0.00009 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.573 | L2-Norm(final)=3.518 | 4180.4 samples/s | 65.3 steps/s
[Step=31150 Epoch=296.3] | Loss=0.00009 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.571 | L2-Norm(final)=3.518 | 2046.4 samples/s | 32.0 steps/s
[Step=31200 Epoch=296.8] | Loss=0.00008 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.568 | L2-Norm(final)=3.518 | 3919.4 samples/s | 61.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step31200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31110 | acc=0.8810 | tpr=0.8374 | fpr=0.0243 | 3861.1 samples/s | 15.1 steps/s
Avg test loss: 0.31555, Avg test acc: 0.87940, Avg tpr: 0.83657, Avg fpr: 0.02641, total FA: 206

Testing server on iccad2012
[Step=  50] | Loss=0.35488 | acc=0.9116 | tpr=0.9204 | fpr=0.0885 | 3936.3 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.36902 | acc=0.9083 | tpr=0.9424 | fpr=0.0923 | 7400.4 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.37987 | acc=0.9075 | tpr=0.9467 | fpr=0.0932 | 6977.9 samples/s | 27.3 steps/s
[Step= 200] | Loss=0.38067 | acc=0.9079 | tpr=0.9454 | fpr=0.0928 | 7264.2 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.37847 | acc=0.9081 | tpr=0.9476 | fpr=0.0927 | 7143.4 samples/s | 27.9 steps/s
[Step= 300] | Loss=0.38252 | acc=0.9077 | tpr=0.9433 | fpr=0.0929 | 7018.9 samples/s | 27.4 steps/s
[Step= 350] | Loss=0.38548 | acc=0.9076 | tpr=0.9418 | fpr=0.0931 | 7221.5 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.38692 | acc=0.9076 | tpr=0.9409 | fpr=0.0930 | 7144.4 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.39073 | acc=0.9073 | tpr=0.9396 | fpr=0.0933 | 7222.9 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.38838 | acc=0.9075 | tpr=0.9410 | fpr=0.0931 | 7057.9 samples/s | 27.6 steps/s
[Step= 550] | Loss=0.38629 | acc=0.9081 | tpr=0.9419 | fpr=0.0925 | 13314.9 samples/s | 52.0 steps/s
Avg test loss: 0.38563, Avg test acc: 0.90815, Avg tpr: 0.94216, Avg fpr: 0.09247, total FA: 12839

server round 39/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=152.1] | Loss=0.11711 | Reg=0.00158 | acc=0.9375 | L2-Norm=12.554 | L2-Norm(final)=3.526 | 4498.1 samples/s | 70.3 steps/s
[Step=31250 Epoch=152.4] | Loss=0.01075 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.581 | L2-Norm(final)=3.525 | 3990.3 samples/s | 62.3 steps/s
[Step=31300 Epoch=152.6] | Loss=0.00660 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.587 | L2-Norm(final)=3.526 | 4209.8 samples/s | 65.8 steps/s
[Step=31350 Epoch=152.9] | Loss=0.00514 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.590 | L2-Norm(final)=3.528 | 4281.5 samples/s | 66.9 steps/s
[Step=31400 Epoch=153.1] | Loss=0.00447 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.593 | L2-Norm(final)=3.530 | 5699.8 samples/s | 89.1 steps/s
[Step=31450 Epoch=153.4] | Loss=0.00414 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.594 | L2-Norm(final)=3.531 | 1878.5 samples/s | 29.4 steps/s
[Step=31500 Epoch=153.6] | Loss=0.00380 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.595 | L2-Norm(final)=3.533 | 4188.3 samples/s | 65.4 steps/s
[Step=31550 Epoch=153.8] | Loss=0.00352 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.596 | L2-Norm(final)=3.534 | 4229.0 samples/s | 66.1 steps/s
[Step=31600 Epoch=154.1] | Loss=0.00330 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.597 | L2-Norm(final)=3.535 | 5299.6 samples/s | 82.8 steps/s
[Step=31650 Epoch=154.3] | Loss=0.00314 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.598 | L2-Norm(final)=3.537 | 1937.0 samples/s | 30.3 steps/s
[Step=31700 Epoch=154.6] | Loss=0.00299 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.598 | L2-Norm(final)=3.538 | 4152.6 samples/s | 64.9 steps/s
[Step=31750 Epoch=154.8] | Loss=0.00286 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.599 | L2-Norm(final)=3.540 | 4252.8 samples/s | 66.5 steps/s
[Step=31800 Epoch=155.1] | Loss=0.00284 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.599 | L2-Norm(final)=3.541 | 4953.3 samples/s | 77.4 steps/s
[Step=31850 Epoch=155.3] | Loss=0.00270 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.600 | L2-Norm(final)=3.542 | 1974.4 samples/s | 30.8 steps/s
[Step=31900 Epoch=155.6] | Loss=0.00265 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.600 | L2-Norm(final)=3.543 | 4214.5 samples/s | 65.9 steps/s
[Step=31950 Epoch=155.8] | Loss=0.00255 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.600 | L2-Norm(final)=3.544 | 4266.6 samples/s | 66.7 steps/s
[Step=32000 Epoch=156.0] | Loss=0.00250 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.601 | L2-Norm(final)=3.545 | 4655.8 samples/s | 72.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step32000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=152.2] | Loss=0.12102 | Reg=0.00158 | acc=0.9375 | L2-Norm=12.554 | L2-Norm(final)=3.526 | 5171.6 samples/s | 80.8 steps/s
[Step=31250 Epoch=152.5] | Loss=0.01140 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.585 | L2-Norm(final)=3.525 | 3709.3 samples/s | 58.0 steps/s
[Step=31300 Epoch=152.7] | Loss=0.00715 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.592 | L2-Norm(final)=3.526 | 4286.9 samples/s | 67.0 steps/s
[Step=31350 Epoch=153.0] | Loss=0.00545 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.595 | L2-Norm(final)=3.528 | 4228.3 samples/s | 66.1 steps/s
[Step=31400 Epoch=153.2] | Loss=0.00454 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.597 | L2-Norm(final)=3.529 | 5827.5 samples/s | 91.1 steps/s
[Step=31450 Epoch=153.5] | Loss=0.00396 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.599 | L2-Norm(final)=3.531 | 1857.5 samples/s | 29.0 steps/s
[Step=31500 Epoch=153.7] | Loss=0.00351 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.600 | L2-Norm(final)=3.532 | 4224.0 samples/s | 66.0 steps/s
[Step=31550 Epoch=153.9] | Loss=0.00324 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.601 | L2-Norm(final)=3.534 | 4257.4 samples/s | 66.5 steps/s
[Step=31600 Epoch=154.2] | Loss=0.00307 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.602 | L2-Norm(final)=3.536 | 5416.7 samples/s | 84.6 steps/s
[Step=31650 Epoch=154.4] | Loss=0.00298 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.603 | L2-Norm(final)=3.537 | 1918.0 samples/s | 30.0 steps/s
[Step=31700 Epoch=154.7] | Loss=0.00278 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.603 | L2-Norm(final)=3.538 | 4134.4 samples/s | 64.6 steps/s
[Step=31750 Epoch=154.9] | Loss=0.00273 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.604 | L2-Norm(final)=3.540 | 4221.1 samples/s | 66.0 steps/s
[Step=31800 Epoch=155.2] | Loss=0.00262 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.604 | L2-Norm(final)=3.541 | 5142.1 samples/s | 80.3 steps/s
[Step=31850 Epoch=155.4] | Loss=0.00249 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.604 | L2-Norm(final)=3.542 | 1947.2 samples/s | 30.4 steps/s
[Step=31900 Epoch=155.7] | Loss=0.00243 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.605 | L2-Norm(final)=3.543 | 4247.4 samples/s | 66.4 steps/s
[Step=31950 Epoch=155.9] | Loss=0.00237 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.605 | L2-Norm(final)=3.545 | 4344.5 samples/s | 67.9 steps/s
[Step=32000 Epoch=156.1] | Loss=0.00233 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.606 | L2-Norm(final)=3.546 | 4898.8 samples/s | 76.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step32000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=295.7] | Loss=0.02153 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.554 | L2-Norm(final)=3.527 | 4464.6 samples/s | 69.8 steps/s
[Step=31250 Epoch=296.1] | Loss=0.00061 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.571 | L2-Norm(final)=3.534 | 3647.9 samples/s | 57.0 steps/s
[Step=31300 Epoch=296.6] | Loss=0.00031 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.571 | L2-Norm(final)=3.535 | 5612.9 samples/s | 87.7 steps/s
[Step=31350 Epoch=297.1] | Loss=0.00021 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.569 | L2-Norm(final)=3.536 | 1813.2 samples/s | 28.3 steps/s
[Step=31400 Epoch=297.5] | Loss=0.00016 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.566 | L2-Norm(final)=3.537 | 5083.1 samples/s | 79.4 steps/s
[Step=31450 Epoch=298.0] | Loss=0.00013 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.562 | L2-Norm(final)=3.537 | 1869.7 samples/s | 29.2 steps/s
[Step=31500 Epoch=298.5] | Loss=0.00011 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.559 | L2-Norm(final)=3.538 | 4563.2 samples/s | 71.3 steps/s
[Step=31550 Epoch=299.0] | Loss=0.00009 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.555 | L2-Norm(final)=3.538 | 1907.4 samples/s | 29.8 steps/s
[Step=31600 Epoch=299.4] | Loss=0.00008 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.551 | L2-Norm(final)=3.538 | 4382.9 samples/s | 68.5 steps/s
[Step=31650 Epoch=299.9] | Loss=0.00007 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.548 | L2-Norm(final)=3.538 | 1956.0 samples/s | 30.6 steps/s
[Step=31700 Epoch=300.4] | Loss=0.00007 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.544 | L2-Norm(final)=3.539 | 4137.9 samples/s | 64.7 steps/s
[Step=31750 Epoch=300.9] | Loss=0.00006 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.540 | L2-Norm(final)=3.539 | 2029.9 samples/s | 31.7 steps/s
[Step=31800 Epoch=301.3] | Loss=0.00006 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=3.539 | 4068.2 samples/s | 63.6 steps/s
[Step=31850 Epoch=301.8] | Loss=0.00005 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.532 | L2-Norm(final)=3.540 | 2058.9 samples/s | 32.2 steps/s
[Step=31900 Epoch=302.3] | Loss=0.00005 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=3.540 | 4035.2 samples/s | 63.0 steps/s
[Step=31950 Epoch=302.8] | Loss=0.00004 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.524 | L2-Norm(final)=3.541 | 2055.3 samples/s | 32.1 steps/s
[Step=32000 Epoch=303.2] | Loss=0.00004 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.520 | L2-Norm(final)=3.541 | 3982.0 samples/s | 62.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step32000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=296.8] | Loss=0.03418 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.554 | L2-Norm(final)=3.526 | 4107.1 samples/s | 64.2 steps/s
[Step=31250 Epoch=297.3] | Loss=0.00245 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.575 | L2-Norm(final)=3.528 | 3892.6 samples/s | 60.8 steps/s
[Step=31300 Epoch=297.7] | Loss=0.00123 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.578 | L2-Norm(final)=3.528 | 5507.4 samples/s | 86.1 steps/s
[Step=31350 Epoch=298.2] | Loss=0.00082 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.577 | L2-Norm(final)=3.529 | 1802.6 samples/s | 28.2 steps/s
[Step=31400 Epoch=298.7] | Loss=0.00062 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.576 | L2-Norm(final)=3.529 | 5192.1 samples/s | 81.1 steps/s
[Step=31450 Epoch=299.2] | Loss=0.00050 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.575 | L2-Norm(final)=3.529 | 1871.7 samples/s | 29.2 steps/s
[Step=31500 Epoch=299.6] | Loss=0.00041 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.573 | L2-Norm(final)=3.529 | 4685.4 samples/s | 73.2 steps/s
[Step=31550 Epoch=300.1] | Loss=0.00036 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.571 | L2-Norm(final)=3.530 | 1902.5 samples/s | 29.7 steps/s
[Step=31600 Epoch=300.6] | Loss=0.00031 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.569 | L2-Norm(final)=3.531 | 4357.7 samples/s | 68.1 steps/s
[Step=31650 Epoch=301.1] | Loss=0.00028 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.567 | L2-Norm(final)=3.531 | 1981.1 samples/s | 31.0 steps/s
[Step=31700 Epoch=301.5] | Loss=0.00025 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.565 | L2-Norm(final)=3.532 | 4106.2 samples/s | 64.2 steps/s
[Step=31750 Epoch=302.0] | Loss=0.00023 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.563 | L2-Norm(final)=3.533 | 2035.1 samples/s | 31.8 steps/s
[Step=31800 Epoch=302.5] | Loss=0.00021 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.561 | L2-Norm(final)=3.534 | 4146.3 samples/s | 64.8 steps/s
[Step=31850 Epoch=303.0] | Loss=0.00019 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.559 | L2-Norm(final)=3.534 | 2028.8 samples/s | 31.7 steps/s
[Step=31900 Epoch=303.4] | Loss=0.00018 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.557 | L2-Norm(final)=3.535 | 4064.2 samples/s | 63.5 steps/s
[Step=31950 Epoch=303.9] | Loss=0.00017 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.555 | L2-Norm(final)=3.536 | 2061.1 samples/s | 32.2 steps/s
[Step=32000 Epoch=304.4] | Loss=0.00016 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.553 | L2-Norm(final)=3.536 | 4019.8 samples/s | 62.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34319 | acc=0.8706 | tpr=0.8209 | fpr=0.0213 | 3861.8 samples/s | 15.1 steps/s
Avg test loss: 0.34467, Avg test acc: 0.86946, Avg tpr: 0.82060, Avg fpr: 0.02307, total FA: 180

Testing server on iccad2012
[Step=  50] | Loss=0.34743 | acc=0.9140 | tpr=0.9204 | fpr=0.0861 | 3838.6 samples/s | 15.0 steps/s
[Step= 100] | Loss=0.36212 | acc=0.9113 | tpr=0.9403 | fpr=0.0892 | 7315.5 samples/s | 28.6 steps/s
[Step= 150] | Loss=0.37357 | acc=0.9100 | tpr=0.9409 | fpr=0.0906 | 7171.5 samples/s | 28.0 steps/s
[Step= 200] | Loss=0.37420 | acc=0.9106 | tpr=0.9377 | fpr=0.0899 | 7077.3 samples/s | 27.6 steps/s
[Step= 250] | Loss=0.37153 | acc=0.9108 | tpr=0.9397 | fpr=0.0897 | 6993.4 samples/s | 27.3 steps/s
[Step= 300] | Loss=0.37584 | acc=0.9108 | tpr=0.9375 | fpr=0.0897 | 7171.0 samples/s | 28.0 steps/s
[Step= 350] | Loss=0.37865 | acc=0.9102 | tpr=0.9368 | fpr=0.0902 | 7214.0 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.38015 | acc=0.9105 | tpr=0.9376 | fpr=0.0900 | 7102.0 samples/s | 27.7 steps/s
[Step= 450] | Loss=0.38421 | acc=0.9101 | tpr=0.9372 | fpr=0.0904 | 7375.6 samples/s | 28.8 steps/s
[Step= 500] | Loss=0.38188 | acc=0.9103 | tpr=0.9388 | fpr=0.0902 | 6841.9 samples/s | 26.7 steps/s
[Step= 550] | Loss=0.37976 | acc=0.9109 | tpr=0.9403 | fpr=0.0896 | 12955.3 samples/s | 50.6 steps/s
Avg test loss: 0.37914, Avg test acc: 0.91097, Avg tpr: 0.94057, Avg fpr: 0.08957, total FA: 12436

server round 40/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=156.0] | Loss=0.08012 | Reg=0.00157 | acc=0.9688 | L2-Norm=12.526 | L2-Norm(final)=3.555 | 4575.9 samples/s | 71.5 steps/s
[Step=32050 Epoch=156.3] | Loss=0.01243 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.540 | L2-Norm(final)=3.556 | 3773.8 samples/s | 59.0 steps/s
[Step=32100 Epoch=156.5] | Loss=0.00750 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.543 | L2-Norm(final)=3.556 | 4237.5 samples/s | 66.2 steps/s
[Step=32150 Epoch=156.8] | Loss=0.00583 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.545 | L2-Norm(final)=3.557 | 4084.0 samples/s | 63.8 steps/s
[Step=32200 Epoch=157.0] | Loss=0.00492 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.546 | L2-Norm(final)=3.558 | 5717.4 samples/s | 89.3 steps/s
[Step=32250 Epoch=157.3] | Loss=0.00425 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.547 | L2-Norm(final)=3.559 | 1857.2 samples/s | 29.0 steps/s
[Step=32300 Epoch=157.5] | Loss=0.00376 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.548 | L2-Norm(final)=3.560 | 4168.0 samples/s | 65.1 steps/s
[Step=32350 Epoch=157.7] | Loss=0.00339 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.548 | L2-Norm(final)=3.561 | 4236.2 samples/s | 66.2 steps/s
[Step=32400 Epoch=158.0] | Loss=0.00324 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=3.562 | 5250.5 samples/s | 82.0 steps/s
[Step=32450 Epoch=158.2] | Loss=0.00323 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=3.563 | 1900.8 samples/s | 29.7 steps/s
[Step=32500 Epoch=158.5] | Loss=0.00312 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=3.564 | 4314.1 samples/s | 67.4 steps/s
[Step=32550 Epoch=158.7] | Loss=0.00295 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=3.565 | 4179.6 samples/s | 65.3 steps/s
[Step=32600 Epoch=159.0] | Loss=0.00288 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=3.566 | 4965.1 samples/s | 77.6 steps/s
[Step=32650 Epoch=159.2] | Loss=0.00278 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.551 | L2-Norm(final)=3.567 | 1965.6 samples/s | 30.7 steps/s
[Step=32700 Epoch=159.5] | Loss=0.00263 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.551 | L2-Norm(final)=3.567 | 4230.7 samples/s | 66.1 steps/s
[Step=32750 Epoch=159.7] | Loss=0.00262 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.551 | L2-Norm(final)=3.568 | 4165.4 samples/s | 65.1 steps/s
[Step=32800 Epoch=159.9] | Loss=0.00254 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.552 | L2-Norm(final)=3.569 | 4640.6 samples/s | 72.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step32800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=156.2] | Loss=0.05075 | Reg=0.00157 | acc=0.9531 | L2-Norm=12.526 | L2-Norm(final)=3.555 | 4304.5 samples/s | 67.3 steps/s
[Step=32050 Epoch=156.4] | Loss=0.01202 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.540 | L2-Norm(final)=3.556 | 4155.1 samples/s | 64.9 steps/s
[Step=32100 Epoch=156.6] | Loss=0.00728 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.543 | L2-Norm(final)=3.557 | 4227.0 samples/s | 66.0 steps/s
[Step=32150 Epoch=156.9] | Loss=0.00578 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.545 | L2-Norm(final)=3.558 | 4241.6 samples/s | 66.3 steps/s
[Step=32200 Epoch=157.1] | Loss=0.00480 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.546 | L2-Norm(final)=3.559 | 5802.9 samples/s | 90.7 steps/s
[Step=32250 Epoch=157.4] | Loss=0.00407 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.547 | L2-Norm(final)=3.560 | 1861.3 samples/s | 29.1 steps/s
[Step=32300 Epoch=157.6] | Loss=0.00366 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.548 | L2-Norm(final)=3.561 | 4259.6 samples/s | 66.6 steps/s
[Step=32350 Epoch=157.9] | Loss=0.00341 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=3.562 | 4255.7 samples/s | 66.5 steps/s
[Step=32400 Epoch=158.1] | Loss=0.00315 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=3.563 | 5473.7 samples/s | 85.5 steps/s
[Step=32450 Epoch=158.3] | Loss=0.00296 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.550 | L2-Norm(final)=3.564 | 1888.8 samples/s | 29.5 steps/s
[Step=32500 Epoch=158.6] | Loss=0.00285 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=3.565 | 4207.6 samples/s | 65.7 steps/s
[Step=32550 Epoch=158.8] | Loss=0.00269 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.551 | L2-Norm(final)=3.566 | 4232.3 samples/s | 66.1 steps/s
[Step=32600 Epoch=159.1] | Loss=0.00258 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.551 | L2-Norm(final)=3.566 | 5095.5 samples/s | 79.6 steps/s
[Step=32650 Epoch=159.3] | Loss=0.00246 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.551 | L2-Norm(final)=3.567 | 1953.4 samples/s | 30.5 steps/s
[Step=32700 Epoch=159.6] | Loss=0.00239 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.552 | L2-Norm(final)=3.568 | 4173.2 samples/s | 65.2 steps/s
[Step=32750 Epoch=159.8] | Loss=0.00230 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.552 | L2-Norm(final)=3.569 | 4190.5 samples/s | 65.5 steps/s
[Step=32800 Epoch=160.0] | Loss=0.00222 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.552 | L2-Norm(final)=3.569 | 4801.0 samples/s | 75.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step32800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=303.2] | Loss=0.00664 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.526 | L2-Norm(final)=3.555 | 4224.8 samples/s | 66.0 steps/s
[Step=32050 Epoch=303.7] | Loss=0.00081 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.535 | L2-Norm(final)=3.559 | 3833.9 samples/s | 59.9 steps/s
[Step=32100 Epoch=304.2] | Loss=0.00041 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=3.561 | 5483.9 samples/s | 85.7 steps/s
[Step=32150 Epoch=304.6] | Loss=0.00028 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=3.561 | 1800.9 samples/s | 28.1 steps/s
[Step=32200 Epoch=305.1] | Loss=0.00021 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.535 | L2-Norm(final)=3.562 | 5074.6 samples/s | 79.3 steps/s
[Step=32250 Epoch=305.6] | Loss=0.00017 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.533 | L2-Norm(final)=3.562 | 1850.9 samples/s | 28.9 steps/s
[Step=32300 Epoch=306.1] | Loss=0.00014 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.531 | L2-Norm(final)=3.562 | 4659.4 samples/s | 72.8 steps/s
[Step=32350 Epoch=306.5] | Loss=0.00012 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=3.563 | 1921.8 samples/s | 30.0 steps/s
[Step=32400 Epoch=307.0] | Loss=0.00011 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=3.563 | 4419.6 samples/s | 69.1 steps/s
[Step=32450 Epoch=307.5] | Loss=0.00010 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.526 | L2-Norm(final)=3.563 | 1957.2 samples/s | 30.6 steps/s
[Step=32500 Epoch=308.0] | Loss=0.00009 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.523 | L2-Norm(final)=3.563 | 4143.4 samples/s | 64.7 steps/s
[Step=32550 Epoch=308.4] | Loss=0.00008 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.521 | L2-Norm(final)=3.564 | 2017.0 samples/s | 31.5 steps/s
[Step=32600 Epoch=308.9] | Loss=0.00007 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.519 | L2-Norm(final)=3.564 | 4120.3 samples/s | 64.4 steps/s
[Step=32650 Epoch=309.4] | Loss=0.00007 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.517 | L2-Norm(final)=3.564 | 2026.1 samples/s | 31.7 steps/s
[Step=32700 Epoch=309.9] | Loss=0.00006 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.515 | L2-Norm(final)=3.564 | 4110.7 samples/s | 64.2 steps/s
[Step=32750 Epoch=310.3] | Loss=0.00006 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.513 | L2-Norm(final)=3.564 | 2038.3 samples/s | 31.8 steps/s
[Step=32800 Epoch=310.8] | Loss=0.00006 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.511 | L2-Norm(final)=3.564 | 3985.5 samples/s | 62.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step32800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=304.4] | Loss=0.00085 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.526 | L2-Norm(final)=3.555 | 4457.9 samples/s | 69.7 steps/s
[Step=32050 Epoch=304.9] | Loss=0.00208 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.533 | L2-Norm(final)=3.558 | 3616.2 samples/s | 56.5 steps/s
[Step=32100 Epoch=305.4] | Loss=0.00105 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.535 | L2-Norm(final)=3.559 | 5457.6 samples/s | 85.3 steps/s
[Step=32150 Epoch=305.8] | Loss=0.00070 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.535 | L2-Norm(final)=3.560 | 1811.2 samples/s | 28.3 steps/s
[Step=32200 Epoch=306.3] | Loss=0.00053 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.534 | L2-Norm(final)=3.560 | 5136.4 samples/s | 80.3 steps/s
[Step=32250 Epoch=306.8] | Loss=0.00043 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.534 | L2-Norm(final)=3.560 | 1853.4 samples/s | 29.0 steps/s
[Step=32300 Epoch=307.3] | Loss=0.00036 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.533 | L2-Norm(final)=3.561 | 4642.3 samples/s | 72.5 steps/s
[Step=32350 Epoch=307.7] | Loss=0.00031 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.532 | L2-Norm(final)=3.561 | 1929.1 samples/s | 30.1 steps/s
[Step=32400 Epoch=308.2] | Loss=0.00027 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.531 | L2-Norm(final)=3.561 | 4292.7 samples/s | 67.1 steps/s
[Step=32450 Epoch=308.7] | Loss=0.00024 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=3.561 | 1965.4 samples/s | 30.7 steps/s
[Step=32500 Epoch=309.2] | Loss=0.00022 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.529 | L2-Norm(final)=3.561 | 4169.8 samples/s | 65.2 steps/s
[Step=32550 Epoch=309.6] | Loss=0.00020 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=3.561 | 2034.7 samples/s | 31.8 steps/s
[Step=32600 Epoch=310.1] | Loss=0.00018 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.527 | L2-Norm(final)=3.562 | 4100.1 samples/s | 64.1 steps/s
[Step=32650 Epoch=310.6] | Loss=0.00017 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.526 | L2-Norm(final)=3.562 | 2057.4 samples/s | 32.1 steps/s
[Step=32700 Epoch=311.1] | Loss=0.00016 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.525 | L2-Norm(final)=3.562 | 4142.3 samples/s | 64.7 steps/s
[Step=32750 Epoch=311.5] | Loss=0.00015 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.524 | L2-Norm(final)=3.562 | 2084.8 samples/s | 32.6 steps/s
[Step=32800 Epoch=312.0] | Loss=0.00014 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.523 | L2-Norm(final)=3.562 | 3888.4 samples/s | 60.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step32800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.30268 | acc=0.8886 | tpr=0.8489 | fpr=0.0253 | 3956.4 samples/s | 15.5 steps/s
Avg test loss: 0.30438, Avg test acc: 0.88733, Avg tpr: 0.84846, Avg fpr: 0.02718, total FA: 212

Testing server on iccad2012
[Step=  50] | Loss=0.37591 | acc=0.9062 | tpr=0.9204 | fpr=0.0940 | 3932.7 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.39280 | acc=0.9038 | tpr=0.9424 | fpr=0.0969 | 7016.6 samples/s | 27.4 steps/s
[Step= 150] | Loss=0.40483 | acc=0.9024 | tpr=0.9424 | fpr=0.0983 | 7273.5 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.40564 | acc=0.9028 | tpr=0.9399 | fpr=0.0979 | 7318.6 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.40307 | acc=0.9028 | tpr=0.9415 | fpr=0.0979 | 6953.4 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.40735 | acc=0.9027 | tpr=0.9389 | fpr=0.0980 | 7091.5 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.41045 | acc=0.9022 | tpr=0.9380 | fpr=0.0984 | 7103.1 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.41192 | acc=0.9024 | tpr=0.9387 | fpr=0.0982 | 7294.3 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.41601 | acc=0.9021 | tpr=0.9377 | fpr=0.0986 | 7206.3 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.41371 | acc=0.9021 | tpr=0.9392 | fpr=0.0985 | 6924.9 samples/s | 27.1 steps/s
[Step= 550] | Loss=0.41146 | acc=0.9028 | tpr=0.9403 | fpr=0.0979 | 13125.3 samples/s | 51.3 steps/s
Avg test loss: 0.41081, Avg test acc: 0.90286, Avg tpr: 0.94057, Avg fpr: 0.09783, total FA: 13583

server round 41/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=159.9] | Loss=0.05945 | Reg=0.00156 | acc=0.9531 | L2-Norm=12.510 | L2-Norm(final)=3.573 | 4487.2 samples/s | 70.1 steps/s
[Step=32850 Epoch=160.2] | Loss=0.00852 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.527 | L2-Norm(final)=3.574 | 4025.7 samples/s | 62.9 steps/s
[Step=32900 Epoch=160.4] | Loss=0.00565 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.531 | L2-Norm(final)=3.574 | 4246.2 samples/s | 66.3 steps/s
[Step=32950 Epoch=160.7] | Loss=0.00448 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.533 | L2-Norm(final)=3.575 | 4256.4 samples/s | 66.5 steps/s
[Step=33000 Epoch=160.9] | Loss=0.00402 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.534 | L2-Norm(final)=3.576 | 5820.2 samples/s | 90.9 steps/s
[Step=33050 Epoch=161.2] | Loss=0.00356 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.535 | L2-Norm(final)=3.577 | 1871.3 samples/s | 29.2 steps/s
[Step=33100 Epoch=161.4] | Loss=0.00326 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.535 | L2-Norm(final)=3.577 | 4256.8 samples/s | 66.5 steps/s
[Step=33150 Epoch=161.6] | Loss=0.00305 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=3.578 | 4217.0 samples/s | 65.9 steps/s
[Step=33200 Epoch=161.9] | Loss=0.00283 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=3.579 | 5358.2 samples/s | 83.7 steps/s
[Step=33250 Epoch=162.1] | Loss=0.00263 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=3.580 | 1897.1 samples/s | 29.6 steps/s
[Step=33300 Epoch=162.4] | Loss=0.00252 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=3.581 | 4210.7 samples/s | 65.8 steps/s
[Step=33350 Epoch=162.6] | Loss=0.00243 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=3.582 | 4206.5 samples/s | 65.7 steps/s
[Step=33400 Epoch=162.9] | Loss=0.00240 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.538 | L2-Norm(final)=3.583 | 4937.0 samples/s | 77.1 steps/s
[Step=33450 Epoch=163.1] | Loss=0.00231 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.538 | L2-Norm(final)=3.584 | 1959.9 samples/s | 30.6 steps/s
[Step=33500 Epoch=163.4] | Loss=0.00228 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.538 | L2-Norm(final)=3.584 | 4214.2 samples/s | 65.8 steps/s
[Step=33550 Epoch=163.6] | Loss=0.00219 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.538 | L2-Norm(final)=3.585 | 4179.2 samples/s | 65.3 steps/s
[Step=33600 Epoch=163.8] | Loss=0.00219 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.539 | L2-Norm(final)=3.586 | 4539.5 samples/s | 70.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step33600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=160.1] | Loss=0.07966 | Reg=0.00156 | acc=0.9219 | L2-Norm=12.510 | L2-Norm(final)=3.573 | 4232.5 samples/s | 66.1 steps/s
[Step=32850 Epoch=160.3] | Loss=0.00949 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.525 | L2-Norm(final)=3.573 | 4084.3 samples/s | 63.8 steps/s
[Step=32900 Epoch=160.5] | Loss=0.00575 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.529 | L2-Norm(final)=3.573 | 4186.8 samples/s | 65.4 steps/s
[Step=32950 Epoch=160.8] | Loss=0.00504 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.531 | L2-Norm(final)=3.574 | 4291.7 samples/s | 67.1 steps/s
[Step=33000 Epoch=161.0] | Loss=0.00420 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.533 | L2-Norm(final)=3.575 | 5736.9 samples/s | 89.6 steps/s
[Step=33050 Epoch=161.3] | Loss=0.00364 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.533 | L2-Norm(final)=3.576 | 1865.2 samples/s | 29.1 steps/s
[Step=33100 Epoch=161.5] | Loss=0.00323 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.534 | L2-Norm(final)=3.577 | 4183.0 samples/s | 65.4 steps/s
[Step=33150 Epoch=161.8] | Loss=0.00296 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.535 | L2-Norm(final)=3.578 | 4263.3 samples/s | 66.6 steps/s
[Step=33200 Epoch=162.0] | Loss=0.00284 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.535 | L2-Norm(final)=3.579 | 5346.0 samples/s | 83.5 steps/s
[Step=33250 Epoch=162.2] | Loss=0.00266 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=3.580 | 1905.5 samples/s | 29.8 steps/s
[Step=33300 Epoch=162.5] | Loss=0.00256 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=3.580 | 4245.1 samples/s | 66.3 steps/s
[Step=33350 Epoch=162.7] | Loss=0.00246 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=3.581 | 4196.1 samples/s | 65.6 steps/s
[Step=33400 Epoch=163.0] | Loss=0.00237 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=3.582 | 5059.2 samples/s | 79.0 steps/s
[Step=33450 Epoch=163.2] | Loss=0.00231 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=3.583 | 1958.1 samples/s | 30.6 steps/s
[Step=33500 Epoch=163.5] | Loss=0.00222 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=3.583 | 4131.7 samples/s | 64.6 steps/s
[Step=33550 Epoch=163.7] | Loss=0.00215 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.537 | L2-Norm(final)=3.584 | 4239.4 samples/s | 66.2 steps/s
[Step=33600 Epoch=164.0] | Loss=0.00211 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.538 | L2-Norm(final)=3.585 | 4762.4 samples/s | 74.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step33600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=310.8] | Loss=0.00084 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.510 | L2-Norm(final)=3.573 | 4041.0 samples/s | 63.1 steps/s
[Step=32850 Epoch=311.3] | Loss=0.00101 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.521 | L2-Norm(final)=3.576 | 4031.6 samples/s | 63.0 steps/s
[Step=32900 Epoch=311.8] | Loss=0.00051 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.522 | L2-Norm(final)=3.577 | 5485.8 samples/s | 85.7 steps/s
[Step=32950 Epoch=312.2] | Loss=0.00034 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.522 | L2-Norm(final)=3.578 | 1802.5 samples/s | 28.2 steps/s
[Step=33000 Epoch=312.7] | Loss=0.00026 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.521 | L2-Norm(final)=3.578 | 5127.3 samples/s | 80.1 steps/s
[Step=33050 Epoch=313.2] | Loss=0.00021 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.520 | L2-Norm(final)=3.579 | 1862.7 samples/s | 29.1 steps/s
[Step=33100 Epoch=313.7] | Loss=0.00018 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.518 | L2-Norm(final)=3.579 | 4771.3 samples/s | 74.6 steps/s
[Step=33150 Epoch=314.1] | Loss=0.00015 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.517 | L2-Norm(final)=3.579 | 1907.3 samples/s | 29.8 steps/s
[Step=33200 Epoch=314.6] | Loss=0.00013 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.515 | L2-Norm(final)=3.579 | 4457.1 samples/s | 69.6 steps/s
[Step=33250 Epoch=315.1] | Loss=0.00012 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.514 | L2-Norm(final)=3.580 | 1971.6 samples/s | 30.8 steps/s
[Step=33300 Epoch=315.5] | Loss=0.00011 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.512 | L2-Norm(final)=3.580 | 4196.5 samples/s | 65.6 steps/s
[Step=33350 Epoch=316.0] | Loss=0.00010 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.511 | L2-Norm(final)=3.580 | 2043.1 samples/s | 31.9 steps/s
[Step=33400 Epoch=316.5] | Loss=0.00009 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.509 | L2-Norm(final)=3.580 | 4059.2 samples/s | 63.4 steps/s
[Step=33450 Epoch=317.0] | Loss=0.00008 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.507 | L2-Norm(final)=3.580 | 2052.6 samples/s | 32.1 steps/s
[Step=33500 Epoch=317.4] | Loss=0.00008 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.505 | L2-Norm(final)=3.581 | 4055.7 samples/s | 63.4 steps/s
[Step=33550 Epoch=317.9] | Loss=0.00007 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.504 | L2-Norm(final)=3.581 | 2037.9 samples/s | 31.8 steps/s
[Step=33600 Epoch=318.4] | Loss=0.00007 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.502 | L2-Norm(final)=3.581 | 3987.5 samples/s | 62.3 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step33600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=312.0] | Loss=0.01214 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.510 | L2-Norm(final)=3.573 | 4238.3 samples/s | 66.2 steps/s
[Step=32850 Epoch=312.5] | Loss=0.00223 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.525 | L2-Norm(final)=3.578 | 3808.7 samples/s | 59.5 steps/s
[Step=32900 Epoch=313.0] | Loss=0.00113 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.529 | L2-Norm(final)=3.579 | 5613.2 samples/s | 87.7 steps/s
[Step=32950 Epoch=313.4] | Loss=0.00075 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.529 | L2-Norm(final)=3.580 | 1822.0 samples/s | 28.5 steps/s
[Step=33000 Epoch=313.9] | Loss=0.00057 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.529 | L2-Norm(final)=3.580 | 5193.8 samples/s | 81.2 steps/s
[Step=33050 Epoch=314.4] | Loss=0.00045 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=3.581 | 1853.1 samples/s | 29.0 steps/s
[Step=33100 Epoch=314.9] | Loss=0.00038 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.527 | L2-Norm(final)=3.581 | 4721.8 samples/s | 73.8 steps/s
[Step=33150 Epoch=315.3] | Loss=0.00033 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.526 | L2-Norm(final)=3.581 | 1899.2 samples/s | 29.7 steps/s
[Step=33200 Epoch=315.8] | Loss=0.00029 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.525 | L2-Norm(final)=3.581 | 4340.4 samples/s | 67.8 steps/s
[Step=33250 Epoch=316.3] | Loss=0.00026 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.524 | L2-Norm(final)=3.581 | 1983.4 samples/s | 31.0 steps/s
[Step=33300 Epoch=316.8] | Loss=0.00023 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.523 | L2-Norm(final)=3.581 | 4094.9 samples/s | 64.0 steps/s
[Step=33350 Epoch=317.2] | Loss=0.00021 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.522 | L2-Norm(final)=3.581 | 2041.0 samples/s | 31.9 steps/s
[Step=33400 Epoch=317.7] | Loss=0.00019 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.521 | L2-Norm(final)=3.581 | 3988.0 samples/s | 62.3 steps/s
[Step=33450 Epoch=318.2] | Loss=0.00018 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.520 | L2-Norm(final)=3.582 | 2042.6 samples/s | 31.9 steps/s
[Step=33500 Epoch=318.7] | Loss=0.00017 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.519 | L2-Norm(final)=3.582 | 4079.3 samples/s | 63.7 steps/s
[Step=33550 Epoch=319.1] | Loss=0.00016 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.518 | L2-Norm(final)=3.582 | 2076.5 samples/s | 32.4 steps/s
[Step=33600 Epoch=319.6] | Loss=0.00015 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.517 | L2-Norm(final)=3.582 | 4037.6 samples/s | 63.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step33600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28688 | acc=0.8978 | tpr=0.8625 | fpr=0.0255 | 3891.0 samples/s | 15.2 steps/s
Avg test loss: 0.28952, Avg test acc: 0.89562, Avg tpr: 0.86116, Avg fpr: 0.02859, total FA: 223

Testing server on iccad2012
[Step=  50] | Loss=0.39665 | acc=0.9010 | tpr=0.9204 | fpr=0.0993 | 3870.2 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.41380 | acc=0.8971 | tpr=0.9424 | fpr=0.1037 | 7294.1 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.42600 | acc=0.8961 | tpr=0.9452 | fpr=0.1048 | 6910.9 samples/s | 27.0 steps/s
[Step= 200] | Loss=0.42709 | acc=0.8966 | tpr=0.9432 | fpr=0.1042 | 7164.9 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.42438 | acc=0.8967 | tpr=0.9459 | fpr=0.1042 | 7210.6 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.42882 | acc=0.8967 | tpr=0.9425 | fpr=0.1042 | 7067.5 samples/s | 27.6 steps/s
[Step= 350] | Loss=0.43212 | acc=0.8962 | tpr=0.9411 | fpr=0.1047 | 7125.7 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.43359 | acc=0.8964 | tpr=0.9415 | fpr=0.1045 | 7281.9 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.43774 | acc=0.8960 | tpr=0.9416 | fpr=0.1048 | 6994.8 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.43545 | acc=0.8962 | tpr=0.9432 | fpr=0.1046 | 7107.2 samples/s | 27.8 steps/s
[Step= 550] | Loss=0.43316 | acc=0.8970 | tpr=0.9439 | fpr=0.1038 | 13031.6 samples/s | 50.9 steps/s
Avg test loss: 0.43251, Avg test acc: 0.89710, Avg tpr: 0.94414, Avg fpr: 0.10375, total FA: 14406

server round 42/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=163.8] | Loss=0.00177 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.497 | L2-Norm(final)=3.590 | 4516.9 samples/s | 70.6 steps/s
[Step=33650 Epoch=164.1] | Loss=0.01010 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.513 | L2-Norm(final)=3.588 | 3860.6 samples/s | 60.3 steps/s
[Step=33700 Epoch=164.3] | Loss=0.00588 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.517 | L2-Norm(final)=3.588 | 4218.7 samples/s | 65.9 steps/s
[Step=33750 Epoch=164.6] | Loss=0.00449 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.519 | L2-Norm(final)=3.589 | 4184.6 samples/s | 65.4 steps/s
[Step=33800 Epoch=164.8] | Loss=0.00402 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.520 | L2-Norm(final)=3.590 | 5733.9 samples/s | 89.6 steps/s
[Step=33850 Epoch=165.1] | Loss=0.00361 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.521 | L2-Norm(final)=3.592 | 1869.8 samples/s | 29.2 steps/s
[Step=33900 Epoch=165.3] | Loss=0.00327 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.522 | L2-Norm(final)=3.592 | 4221.2 samples/s | 66.0 steps/s
[Step=33950 Epoch=165.5] | Loss=0.00296 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.522 | L2-Norm(final)=3.593 | 4250.0 samples/s | 66.4 steps/s
[Step=34000 Epoch=165.8] | Loss=0.00286 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.523 | L2-Norm(final)=3.594 | 5402.1 samples/s | 84.4 steps/s
[Step=34050 Epoch=166.0] | Loss=0.00277 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.523 | L2-Norm(final)=3.595 | 1941.7 samples/s | 30.3 steps/s
[Step=34100 Epoch=166.3] | Loss=0.00258 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.524 | L2-Norm(final)=3.596 | 4280.7 samples/s | 66.9 steps/s
[Step=34150 Epoch=166.5] | Loss=0.00255 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.524 | L2-Norm(final)=3.597 | 4385.4 samples/s | 68.5 steps/s
[Step=34200 Epoch=166.8] | Loss=0.00246 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.524 | L2-Norm(final)=3.598 | 4991.1 samples/s | 78.0 steps/s
[Step=34250 Epoch=167.0] | Loss=0.00231 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.525 | L2-Norm(final)=3.599 | 1984.9 samples/s | 31.0 steps/s
[Step=34300 Epoch=167.3] | Loss=0.00227 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.525 | L2-Norm(final)=3.600 | 4247.4 samples/s | 66.4 steps/s
[Step=34350 Epoch=167.5] | Loss=0.00220 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.525 | L2-Norm(final)=3.600 | 4242.1 samples/s | 66.3 steps/s
[Step=34400 Epoch=167.7] | Loss=0.00218 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.525 | L2-Norm(final)=3.601 | 4596.7 samples/s | 71.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step34400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=164.0] | Loss=0.03494 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.497 | L2-Norm(final)=3.590 | 4354.4 samples/s | 68.0 steps/s
[Step=33650 Epoch=164.2] | Loss=0.00972 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.512 | L2-Norm(final)=3.589 | 4200.5 samples/s | 65.6 steps/s
[Step=33700 Epoch=164.4] | Loss=0.00581 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.516 | L2-Norm(final)=3.589 | 4302.7 samples/s | 67.2 steps/s
[Step=33750 Epoch=164.7] | Loss=0.00468 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.518 | L2-Norm(final)=3.590 | 4281.1 samples/s | 66.9 steps/s
[Step=33800 Epoch=164.9] | Loss=0.00391 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.519 | L2-Norm(final)=3.591 | 5798.5 samples/s | 90.6 steps/s
[Step=33850 Epoch=165.2] | Loss=0.00339 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.520 | L2-Norm(final)=3.592 | 1855.1 samples/s | 29.0 steps/s
[Step=33900 Epoch=165.4] | Loss=0.00310 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.521 | L2-Norm(final)=3.593 | 4278.7 samples/s | 66.9 steps/s
[Step=33950 Epoch=165.7] | Loss=0.00294 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.521 | L2-Norm(final)=3.594 | 4201.3 samples/s | 65.6 steps/s
[Step=34000 Epoch=165.9] | Loss=0.00272 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.521 | L2-Norm(final)=3.594 | 5414.6 samples/s | 84.6 steps/s
[Step=34050 Epoch=166.1] | Loss=0.00258 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.522 | L2-Norm(final)=3.595 | 1898.5 samples/s | 29.7 steps/s
[Step=34100 Epoch=166.4] | Loss=0.00246 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.522 | L2-Norm(final)=3.596 | 4191.3 samples/s | 65.5 steps/s
[Step=34150 Epoch=166.6] | Loss=0.00237 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.522 | L2-Norm(final)=3.597 | 4172.9 samples/s | 65.2 steps/s
[Step=34200 Epoch=166.9] | Loss=0.00225 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.523 | L2-Norm(final)=3.597 | 4973.3 samples/s | 77.7 steps/s
[Step=34250 Epoch=167.1] | Loss=0.00221 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.523 | L2-Norm(final)=3.598 | 1964.6 samples/s | 30.7 steps/s
[Step=34300 Epoch=167.4] | Loss=0.00215 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.523 | L2-Norm(final)=3.599 | 4296.5 samples/s | 67.1 steps/s
[Step=34350 Epoch=167.6] | Loss=0.00204 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.523 | L2-Norm(final)=3.600 | 4221.4 samples/s | 66.0 steps/s
[Step=34400 Epoch=167.9] | Loss=0.00201 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.524 | L2-Norm(final)=3.600 | 4863.5 samples/s | 76.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step34400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=318.4] | Loss=0.04345 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.497 | L2-Norm(final)=3.590 | 4117.5 samples/s | 64.3 steps/s
[Step=33650 Epoch=318.9] | Loss=0.00183 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.508 | L2-Norm(final)=3.593 | 4012.2 samples/s | 62.7 steps/s
[Step=33700 Epoch=319.3] | Loss=0.00092 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.510 | L2-Norm(final)=3.594 | 5529.1 samples/s | 86.4 steps/s
[Step=33750 Epoch=319.8] | Loss=0.00062 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.510 | L2-Norm(final)=3.594 | 1818.7 samples/s | 28.4 steps/s
[Step=33800 Epoch=320.3] | Loss=0.00046 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.509 | L2-Norm(final)=3.595 | 5045.6 samples/s | 78.8 steps/s
[Step=33850 Epoch=320.8] | Loss=0.00037 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.508 | L2-Norm(final)=3.595 | 1858.0 samples/s | 29.0 steps/s
[Step=33900 Epoch=321.2] | Loss=0.00031 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.507 | L2-Norm(final)=3.595 | 4707.7 samples/s | 73.6 steps/s
[Step=33950 Epoch=321.7] | Loss=0.00027 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.506 | L2-Norm(final)=3.595 | 1913.8 samples/s | 29.9 steps/s
[Step=34000 Epoch=322.2] | Loss=0.00023 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.504 | L2-Norm(final)=3.595 | 4483.8 samples/s | 70.1 steps/s
[Step=34050 Epoch=322.7] | Loss=0.00021 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.503 | L2-Norm(final)=3.596 | 1963.9 samples/s | 30.7 steps/s
[Step=34100 Epoch=323.1] | Loss=0.00019 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.502 | L2-Norm(final)=3.596 | 4102.0 samples/s | 64.1 steps/s
[Step=34150 Epoch=323.6] | Loss=0.00017 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.500 | L2-Norm(final)=3.596 | 2012.9 samples/s | 31.5 steps/s
[Step=34200 Epoch=324.1] | Loss=0.00016 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.499 | L2-Norm(final)=3.596 | 4027.2 samples/s | 62.9 steps/s
[Step=34250 Epoch=324.5] | Loss=0.00015 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=3.596 | 2056.2 samples/s | 32.1 steps/s
[Step=34300 Epoch=325.0] | Loss=0.00014 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.496 | L2-Norm(final)=3.596 | 3966.0 samples/s | 62.0 steps/s
[Step=34350 Epoch=325.5] | Loss=0.00013 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=3.596 | 2062.4 samples/s | 32.2 steps/s
[Step=34400 Epoch=326.0] | Loss=0.00012 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.493 | L2-Norm(final)=3.597 | 4066.9 samples/s | 63.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step34400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=319.6] | Loss=0.00921 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.497 | L2-Norm(final)=3.590 | 4127.7 samples/s | 64.5 steps/s
[Step=33650 Epoch=320.1] | Loss=0.00108 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.506 | L2-Norm(final)=3.595 | 3963.4 samples/s | 61.9 steps/s
[Step=33700 Epoch=320.6] | Loss=0.00055 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.508 | L2-Norm(final)=3.596 | 5569.8 samples/s | 87.0 steps/s
[Step=33750 Epoch=321.0] | Loss=0.00037 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.508 | L2-Norm(final)=3.596 | 1786.7 samples/s | 27.9 steps/s
[Step=33800 Epoch=321.5] | Loss=0.00028 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.507 | L2-Norm(final)=3.597 | 5134.5 samples/s | 80.2 steps/s
[Step=33850 Epoch=322.0] | Loss=0.00022 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.506 | L2-Norm(final)=3.597 | 1858.8 samples/s | 29.0 steps/s
[Step=33900 Epoch=322.5] | Loss=0.00019 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.506 | L2-Norm(final)=3.597 | 4765.7 samples/s | 74.5 steps/s
[Step=33950 Epoch=322.9] | Loss=0.00016 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.505 | L2-Norm(final)=3.598 | 1924.4 samples/s | 30.1 steps/s
[Step=34000 Epoch=323.4] | Loss=0.00014 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.504 | L2-Norm(final)=3.598 | 4361.1 samples/s | 68.1 steps/s
[Step=34050 Epoch=323.9] | Loss=0.00013 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.502 | L2-Norm(final)=3.598 | 1982.0 samples/s | 31.0 steps/s
[Step=34100 Epoch=324.4] | Loss=0.00011 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.501 | L2-Norm(final)=3.598 | 4191.2 samples/s | 65.5 steps/s
[Step=34150 Epoch=324.9] | Loss=0.00010 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.500 | L2-Norm(final)=3.598 | 2019.9 samples/s | 31.6 steps/s
[Step=34200 Epoch=325.3] | Loss=0.00010 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.499 | L2-Norm(final)=3.598 | 4122.3 samples/s | 64.4 steps/s
[Step=34250 Epoch=325.8] | Loss=0.00009 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=3.598 | 2049.8 samples/s | 32.0 steps/s
[Step=34300 Epoch=326.3] | Loss=0.00008 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.497 | L2-Norm(final)=3.599 | 4050.5 samples/s | 63.3 steps/s
[Step=34350 Epoch=326.8] | Loss=0.00008 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=3.599 | 2027.6 samples/s | 31.7 steps/s
[Step=34400 Epoch=327.2] | Loss=0.00007 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.494 | L2-Norm(final)=3.599 | 4015.5 samples/s | 62.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step34400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28292 | acc=0.8983 | tpr=0.8638 | fpr=0.0268 | 3841.1 samples/s | 15.0 steps/s
Avg test loss: 0.28506, Avg test acc: 0.89643, Avg tpr: 0.86280, Avg fpr: 0.02961, total FA: 231

Testing server on iccad2012
[Step=  50] | Loss=0.39782 | acc=0.9012 | tpr=0.9204 | fpr=0.0991 | 3905.0 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.41438 | acc=0.8978 | tpr=0.9403 | fpr=0.1030 | 7112.3 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.42626 | acc=0.8971 | tpr=0.9438 | fpr=0.1038 | 7085.9 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.42729 | acc=0.8975 | tpr=0.9399 | fpr=0.1033 | 7365.2 samples/s | 28.8 steps/s
[Step= 250] | Loss=0.42468 | acc=0.8975 | tpr=0.9441 | fpr=0.1034 | 7359.0 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.42910 | acc=0.8977 | tpr=0.9411 | fpr=0.1031 | 7252.0 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.43237 | acc=0.8973 | tpr=0.9405 | fpr=0.1035 | 7107.7 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.43373 | acc=0.8975 | tpr=0.9404 | fpr=0.1033 | 7167.9 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.43780 | acc=0.8973 | tpr=0.9396 | fpr=0.1035 | 6930.2 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.43543 | acc=0.8974 | tpr=0.9410 | fpr=0.1034 | 7001.8 samples/s | 27.4 steps/s
[Step= 550] | Loss=0.43310 | acc=0.8981 | tpr=0.9419 | fpr=0.1027 | 13539.6 samples/s | 52.9 steps/s
Avg test loss: 0.43241, Avg test acc: 0.89820, Avg tpr: 0.94216, Avg fpr: 0.10259, total FA: 14245

server round 43/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=167.7] | Loss=0.07256 | Reg=0.00156 | acc=0.9375 | L2-Norm=12.484 | L2-Norm(final)=3.605 | 4218.6 samples/s | 65.9 steps/s
[Step=34450 Epoch=168.0] | Loss=0.00943 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.502 | L2-Norm(final)=3.605 | 4032.5 samples/s | 63.0 steps/s
[Step=34500 Epoch=168.2] | Loss=0.00603 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.506 | L2-Norm(final)=3.605 | 4254.1 samples/s | 66.5 steps/s
[Step=34550 Epoch=168.5] | Loss=0.00451 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.508 | L2-Norm(final)=3.606 | 4214.1 samples/s | 65.8 steps/s
[Step=34600 Epoch=168.7] | Loss=0.00393 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.509 | L2-Norm(final)=3.606 | 5747.7 samples/s | 89.8 steps/s
[Step=34650 Epoch=169.0] | Loss=0.00370 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.510 | L2-Norm(final)=3.607 | 1892.2 samples/s | 29.6 steps/s
[Step=34700 Epoch=169.2] | Loss=0.00331 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.510 | L2-Norm(final)=3.608 | 4363.4 samples/s | 68.2 steps/s
[Step=34750 Epoch=169.4] | Loss=0.00310 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.511 | L2-Norm(final)=3.609 | 4352.4 samples/s | 68.0 steps/s
[Step=34800 Epoch=169.7] | Loss=0.00281 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.511 | L2-Norm(final)=3.609 | 5467.5 samples/s | 85.4 steps/s
[Step=34850 Epoch=169.9] | Loss=0.00274 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.512 | L2-Norm(final)=3.610 | 1937.4 samples/s | 30.3 steps/s
[Step=34900 Epoch=170.2] | Loss=0.00258 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.512 | L2-Norm(final)=3.611 | 4347.6 samples/s | 67.9 steps/s
[Step=34950 Epoch=170.4] | Loss=0.00244 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.512 | L2-Norm(final)=3.612 | 4175.9 samples/s | 65.2 steps/s
[Step=35000 Epoch=170.7] | Loss=0.00242 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.513 | L2-Norm(final)=3.612 | 4959.0 samples/s | 77.5 steps/s
[Step=35050 Epoch=170.9] | Loss=0.00232 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.513 | L2-Norm(final)=3.613 | 1973.8 samples/s | 30.8 steps/s
[Step=35100 Epoch=171.2] | Loss=0.00229 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.513 | L2-Norm(final)=3.614 | 4250.0 samples/s | 66.4 steps/s
[Step=35150 Epoch=171.4] | Loss=0.00226 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.513 | L2-Norm(final)=3.614 | 4200.7 samples/s | 65.6 steps/s
[Step=35200 Epoch=171.6] | Loss=0.00223 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.513 | L2-Norm(final)=3.615 | 4571.0 samples/s | 71.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step35200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=167.9] | Loss=0.09319 | Reg=0.00156 | acc=0.9375 | L2-Norm=12.484 | L2-Norm(final)=3.605 | 4459.8 samples/s | 69.7 steps/s
[Step=34450 Epoch=168.1] | Loss=0.00939 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=3.606 | 3801.7 samples/s | 59.4 steps/s
[Step=34500 Epoch=168.3] | Loss=0.00567 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.501 | L2-Norm(final)=3.606 | 4288.1 samples/s | 67.0 steps/s
[Step=34550 Epoch=168.6] | Loss=0.00472 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.503 | L2-Norm(final)=3.607 | 4243.8 samples/s | 66.3 steps/s
[Step=34600 Epoch=168.8] | Loss=0.00388 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.504 | L2-Norm(final)=3.608 | 5789.7 samples/s | 90.5 steps/s
[Step=34650 Epoch=169.1] | Loss=0.00332 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.505 | L2-Norm(final)=3.609 | 1866.8 samples/s | 29.2 steps/s
[Step=34700 Epoch=169.3] | Loss=0.00319 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.505 | L2-Norm(final)=3.610 | 4147.0 samples/s | 64.8 steps/s
[Step=34750 Epoch=169.6] | Loss=0.00290 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.506 | L2-Norm(final)=3.611 | 4170.6 samples/s | 65.2 steps/s
[Step=34800 Epoch=169.8] | Loss=0.00271 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.506 | L2-Norm(final)=3.612 | 5264.6 samples/s | 82.3 steps/s
[Step=34850 Epoch=170.1] | Loss=0.00261 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.507 | L2-Norm(final)=3.613 | 1903.9 samples/s | 29.7 steps/s
[Step=34900 Epoch=170.3] | Loss=0.00246 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.507 | L2-Norm(final)=3.613 | 4223.5 samples/s | 66.0 steps/s
[Step=34950 Epoch=170.5] | Loss=0.00237 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.507 | L2-Norm(final)=3.614 | 4318.1 samples/s | 67.5 steps/s
[Step=35000 Epoch=170.8] | Loss=0.00227 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.508 | L2-Norm(final)=3.615 | 5115.5 samples/s | 79.9 steps/s
[Step=35050 Epoch=171.0] | Loss=0.00217 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.508 | L2-Norm(final)=3.616 | 1949.7 samples/s | 30.5 steps/s
[Step=35100 Epoch=171.3] | Loss=0.00212 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.508 | L2-Norm(final)=3.616 | 4187.7 samples/s | 65.4 steps/s
[Step=35150 Epoch=171.5] | Loss=0.00208 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.509 | L2-Norm(final)=3.617 | 4270.8 samples/s | 66.7 steps/s
[Step=35200 Epoch=171.8] | Loss=0.00204 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.509 | L2-Norm(final)=3.618 | 4765.1 samples/s | 74.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step35200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=326.0] | Loss=0.00717 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.484 | L2-Norm(final)=3.606 | 4374.5 samples/s | 68.4 steps/s
[Step=34450 Epoch=326.4] | Loss=0.00186 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.494 | L2-Norm(final)=3.609 | 3789.2 samples/s | 59.2 steps/s
[Step=34500 Epoch=326.9] | Loss=0.00094 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.496 | L2-Norm(final)=3.610 | 5477.9 samples/s | 85.6 steps/s
[Step=34550 Epoch=327.4] | Loss=0.00063 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.496 | L2-Norm(final)=3.610 | 1814.7 samples/s | 28.4 steps/s
[Step=34600 Epoch=327.9] | Loss=0.00047 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=3.610 | 5199.6 samples/s | 81.2 steps/s
[Step=34650 Epoch=328.3] | Loss=0.00038 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.494 | L2-Norm(final)=3.610 | 1878.0 samples/s | 29.3 steps/s
[Step=34700 Epoch=328.8] | Loss=0.00032 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.494 | L2-Norm(final)=3.611 | 4793.6 samples/s | 74.9 steps/s
[Step=34750 Epoch=329.3] | Loss=0.00027 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.493 | L2-Norm(final)=3.611 | 1920.2 samples/s | 30.0 steps/s
[Step=34800 Epoch=329.8] | Loss=0.00024 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.491 | L2-Norm(final)=3.611 | 4317.1 samples/s | 67.5 steps/s
[Step=34850 Epoch=330.2] | Loss=0.00021 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.490 | L2-Norm(final)=3.611 | 1965.7 samples/s | 30.7 steps/s
[Step=34900 Epoch=330.7] | Loss=0.00019 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.489 | L2-Norm(final)=3.611 | 4060.2 samples/s | 63.4 steps/s
[Step=34950 Epoch=331.2] | Loss=0.00017 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.488 | L2-Norm(final)=3.611 | 2050.4 samples/s | 32.0 steps/s
[Step=35000 Epoch=331.7] | Loss=0.00016 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.487 | L2-Norm(final)=3.611 | 4010.5 samples/s | 62.7 steps/s
[Step=35050 Epoch=332.1] | Loss=0.00015 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.486 | L2-Norm(final)=3.612 | 2033.8 samples/s | 31.8 steps/s
[Step=35100 Epoch=332.6] | Loss=0.00014 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=3.612 | 4089.4 samples/s | 63.9 steps/s
[Step=35150 Epoch=333.1] | Loss=0.00013 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=3.612 | 2039.6 samples/s | 31.9 steps/s
[Step=35200 Epoch=333.6] | Loss=0.00012 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.612 | 4102.8 samples/s | 64.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step35200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=327.2] | Loss=0.01622 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.484 | L2-Norm(final)=3.605 | 4227.3 samples/s | 66.1 steps/s
[Step=34450 Epoch=327.7] | Loss=0.00141 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=3.609 | 3859.5 samples/s | 60.3 steps/s
[Step=34500 Epoch=328.2] | Loss=0.00071 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=3.610 | 5582.5 samples/s | 87.2 steps/s
[Step=34550 Epoch=328.7] | Loss=0.00047 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=3.610 | 1808.9 samples/s | 28.3 steps/s
[Step=34600 Epoch=329.1] | Loss=0.00036 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.497 | L2-Norm(final)=3.610 | 5136.4 samples/s | 80.3 steps/s
[Step=34650 Epoch=329.6] | Loss=0.00029 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.497 | L2-Norm(final)=3.611 | 1865.6 samples/s | 29.2 steps/s
[Step=34700 Epoch=330.1] | Loss=0.00024 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.496 | L2-Norm(final)=3.611 | 4766.1 samples/s | 74.5 steps/s
[Step=34750 Epoch=330.6] | Loss=0.00021 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=3.611 | 1930.4 samples/s | 30.2 steps/s
[Step=34800 Epoch=331.0] | Loss=0.00018 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.494 | L2-Norm(final)=3.611 | 4435.6 samples/s | 69.3 steps/s
[Step=34850 Epoch=331.5] | Loss=0.00016 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.493 | L2-Norm(final)=3.611 | 1983.2 samples/s | 31.0 steps/s
[Step=34900 Epoch=332.0] | Loss=0.00015 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.492 | L2-Norm(final)=3.611 | 4328.9 samples/s | 67.6 steps/s
[Step=34950 Epoch=332.5] | Loss=0.00013 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.491 | L2-Norm(final)=3.611 | 2055.4 samples/s | 32.1 steps/s
[Step=35000 Epoch=332.9] | Loss=0.00012 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.490 | L2-Norm(final)=3.611 | 4199.9 samples/s | 65.6 steps/s
[Step=35050 Epoch=333.4] | Loss=0.00011 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.488 | L2-Norm(final)=3.611 | 2068.6 samples/s | 32.3 steps/s
[Step=35100 Epoch=333.9] | Loss=0.00010 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.487 | L2-Norm(final)=3.611 | 4113.1 samples/s | 64.3 steps/s
[Step=35150 Epoch=334.4] | Loss=0.00010 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.486 | L2-Norm(final)=3.611 | 2079.2 samples/s | 32.5 steps/s
[Step=35200 Epoch=334.8] | Loss=0.00009 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.485 | L2-Norm(final)=3.612 | 4020.4 samples/s | 62.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step35200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28937 | acc=0.8970 | tpr=0.8620 | fpr=0.0273 | 3852.4 samples/s | 15.0 steps/s
Avg test loss: 0.29139, Avg test acc: 0.89603, Avg tpr: 0.86239, Avg fpr: 0.03000, total FA: 234

Testing server on iccad2012
[Step=  50] | Loss=0.39471 | acc=0.9041 | tpr=0.9204 | fpr=0.0962 | 4057.7 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.41151 | acc=0.9013 | tpr=0.9403 | fpr=0.0994 | 7501.0 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.42357 | acc=0.9001 | tpr=0.9409 | fpr=0.1007 | 7224.1 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.42468 | acc=0.9003 | tpr=0.9399 | fpr=0.1004 | 7531.5 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.42189 | acc=0.9005 | tpr=0.9432 | fpr=0.1003 | 7971.1 samples/s | 31.1 steps/s
[Step= 300] | Loss=0.42613 | acc=0.9005 | tpr=0.9404 | fpr=0.1003 | 7046.4 samples/s | 27.5 steps/s
[Step= 350] | Loss=0.42918 | acc=0.9001 | tpr=0.9399 | fpr=0.1006 | 7493.7 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.43073 | acc=0.9003 | tpr=0.9398 | fpr=0.1004 | 7521.7 samples/s | 29.4 steps/s
[Step= 450] | Loss=0.43486 | acc=0.9000 | tpr=0.9396 | fpr=0.1008 | 7226.4 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.43245 | acc=0.9001 | tpr=0.9414 | fpr=0.1007 | 6946.9 samples/s | 27.1 steps/s
[Step= 550] | Loss=0.43012 | acc=0.9008 | tpr=0.9427 | fpr=0.1000 | 13695.6 samples/s | 53.5 steps/s
Avg test loss: 0.42943, Avg test acc: 0.90086, Avg tpr: 0.94295, Avg fpr: 0.09991, total FA: 13872

server round 44/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=171.6] | Loss=0.04897 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.474 | L2-Norm(final)=3.619 | 4601.8 samples/s | 71.9 steps/s
[Step=35250 Epoch=171.9] | Loss=0.01093 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.488 | L2-Norm(final)=3.617 | 4160.3 samples/s | 65.0 steps/s
[Step=35300 Epoch=172.1] | Loss=0.00633 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.491 | L2-Norm(final)=3.617 | 4404.0 samples/s | 68.8 steps/s
[Step=35350 Epoch=172.4] | Loss=0.00478 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.493 | L2-Norm(final)=3.618 | 4423.3 samples/s | 69.1 steps/s
[Step=35400 Epoch=172.6] | Loss=0.00403 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.494 | L2-Norm(final)=3.618 | 6071.7 samples/s | 94.9 steps/s
[Step=35450 Epoch=172.9] | Loss=0.00354 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=3.619 | 1920.7 samples/s | 30.0 steps/s
[Step=35500 Epoch=173.1] | Loss=0.00321 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=3.620 | 4382.0 samples/s | 68.5 steps/s
[Step=35550 Epoch=173.3] | Loss=0.00293 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.496 | L2-Norm(final)=3.621 | 4334.7 samples/s | 67.7 steps/s
[Step=35600 Epoch=173.6] | Loss=0.00282 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.496 | L2-Norm(final)=3.622 | 5454.5 samples/s | 85.2 steps/s
[Step=35650 Epoch=173.8] | Loss=0.00271 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.497 | L2-Norm(final)=3.623 | 1994.1 samples/s | 31.2 steps/s
[Step=35700 Epoch=174.1] | Loss=0.00254 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.497 | L2-Norm(final)=3.624 | 4458.0 samples/s | 69.7 steps/s
[Step=35750 Epoch=174.3] | Loss=0.00245 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.497 | L2-Norm(final)=3.624 | 4447.6 samples/s | 69.5 steps/s
[Step=35800 Epoch=174.6] | Loss=0.00238 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=3.625 | 5228.2 samples/s | 81.7 steps/s
[Step=35850 Epoch=174.8] | Loss=0.00229 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=3.626 | 2023.0 samples/s | 31.6 steps/s
[Step=35900 Epoch=175.1] | Loss=0.00220 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=3.627 | 4278.6 samples/s | 66.9 steps/s
[Step=35950 Epoch=175.3] | Loss=0.00218 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.499 | L2-Norm(final)=3.627 | 4493.4 samples/s | 70.2 steps/s
[Step=36000 Epoch=175.5] | Loss=0.00216 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.499 | L2-Norm(final)=3.628 | 4922.5 samples/s | 76.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step36000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=171.8] | Loss=0.09591 | Reg=0.00156 | acc=0.9375 | L2-Norm=12.474 | L2-Norm(final)=3.619 | 4200.3 samples/s | 65.6 steps/s
[Step=35250 Epoch=172.0] | Loss=0.00813 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.488 | L2-Norm(final)=3.619 | 4497.1 samples/s | 70.3 steps/s
[Step=35300 Epoch=172.2] | Loss=0.00517 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.491 | L2-Norm(final)=3.619 | 4521.0 samples/s | 70.6 steps/s
[Step=35350 Epoch=172.5] | Loss=0.00430 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.492 | L2-Norm(final)=3.620 | 4401.0 samples/s | 68.8 steps/s
[Step=35400 Epoch=172.7] | Loss=0.00380 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.494 | L2-Norm(final)=3.621 | 6057.5 samples/s | 94.6 steps/s
[Step=35450 Epoch=173.0] | Loss=0.00326 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.494 | L2-Norm(final)=3.621 | 1904.5 samples/s | 29.8 steps/s
[Step=35500 Epoch=173.2] | Loss=0.00312 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.495 | L2-Norm(final)=3.622 | 4310.0 samples/s | 67.3 steps/s
[Step=35550 Epoch=173.5] | Loss=0.00289 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.496 | L2-Norm(final)=3.623 | 4488.1 samples/s | 70.1 steps/s
[Step=35600 Epoch=173.7] | Loss=0.00264 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.496 | L2-Norm(final)=3.624 | 5712.5 samples/s | 89.3 steps/s
[Step=35650 Epoch=174.0] | Loss=0.00247 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.497 | L2-Norm(final)=3.625 | 1932.1 samples/s | 30.2 steps/s
[Step=35700 Epoch=174.2] | Loss=0.00233 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.497 | L2-Norm(final)=3.626 | 4280.5 samples/s | 66.9 steps/s
[Step=35750 Epoch=174.4] | Loss=0.00223 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.497 | L2-Norm(final)=3.626 | 4339.9 samples/s | 67.8 steps/s
[Step=35800 Epoch=174.7] | Loss=0.00221 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.498 | L2-Norm(final)=3.627 | 5266.1 samples/s | 82.3 steps/s
[Step=35850 Epoch=174.9] | Loss=0.00212 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.498 | L2-Norm(final)=3.628 | 1968.8 samples/s | 30.8 steps/s
[Step=35900 Epoch=175.2] | Loss=0.00206 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=3.629 | 4444.9 samples/s | 69.5 steps/s
[Step=35950 Epoch=175.4] | Loss=0.00198 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.498 | L2-Norm(final)=3.629 | 4333.3 samples/s | 67.7 steps/s
[Step=36000 Epoch=175.7] | Loss=0.00197 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.499 | L2-Norm(final)=3.630 | 4929.1 samples/s | 77.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step36000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=333.6] | Loss=0.00633 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.474 | L2-Norm(final)=3.619 | 4210.6 samples/s | 65.8 steps/s
[Step=35250 Epoch=334.0] | Loss=0.00088 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.481 | L2-Norm(final)=3.623 | 3719.1 samples/s | 58.1 steps/s
[Step=35300 Epoch=334.5] | Loss=0.00045 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.624 | 5800.4 samples/s | 90.6 steps/s
[Step=35350 Epoch=335.0] | Loss=0.00030 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.625 | 1868.5 samples/s | 29.2 steps/s
[Step=35400 Epoch=335.4] | Loss=0.00023 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.481 | L2-Norm(final)=3.625 | 5243.3 samples/s | 81.9 steps/s
[Step=35450 Epoch=335.9] | Loss=0.00018 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.480 | L2-Norm(final)=3.625 | 1869.8 samples/s | 29.2 steps/s
[Step=35500 Epoch=336.4] | Loss=0.00015 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=3.626 | 4831.4 samples/s | 75.5 steps/s
[Step=35550 Epoch=336.9] | Loss=0.00013 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=3.626 | 1977.0 samples/s | 30.9 steps/s
[Step=35600 Epoch=337.3] | Loss=0.00012 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=3.626 | 4646.6 samples/s | 72.6 steps/s
[Step=35650 Epoch=337.8] | Loss=0.00010 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=3.626 | 1976.6 samples/s | 30.9 steps/s
[Step=35700 Epoch=338.3] | Loss=0.00009 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.474 | L2-Norm(final)=3.626 | 4171.8 samples/s | 65.2 steps/s
[Step=35750 Epoch=338.8] | Loss=0.00009 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.473 | L2-Norm(final)=3.626 | 2033.9 samples/s | 31.8 steps/s
[Step=35800 Epoch=339.2] | Loss=0.00008 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.471 | L2-Norm(final)=3.627 | 4152.2 samples/s | 64.9 steps/s
[Step=35850 Epoch=339.7] | Loss=0.00007 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.470 | L2-Norm(final)=3.627 | 2058.5 samples/s | 32.2 steps/s
[Step=35900 Epoch=340.2] | Loss=0.00007 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.469 | L2-Norm(final)=3.627 | 4151.7 samples/s | 64.9 steps/s
[Step=35950 Epoch=340.7] | Loss=0.00006 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.467 | L2-Norm(final)=3.627 | 2091.6 samples/s | 32.7 steps/s
[Step=36000 Epoch=341.1] | Loss=0.00006 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.466 | L2-Norm(final)=3.627 | 4147.7 samples/s | 64.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step36000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=334.8] | Loss=0.02000 | Reg=0.00156 | acc=0.9688 | L2-Norm=12.474 | L2-Norm(final)=3.619 | 4225.8 samples/s | 66.0 steps/s
[Step=35250 Epoch=335.3] | Loss=0.00138 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.485 | L2-Norm(final)=3.623 | 4130.6 samples/s | 64.5 steps/s
[Step=35300 Epoch=335.8] | Loss=0.00070 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.487 | L2-Norm(final)=3.624 | 5752.1 samples/s | 89.9 steps/s
[Step=35350 Epoch=336.3] | Loss=0.00047 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.487 | L2-Norm(final)=3.624 | 1840.9 samples/s | 28.8 steps/s
[Step=35400 Epoch=336.7] | Loss=0.00035 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.487 | L2-Norm(final)=3.625 | 5294.1 samples/s | 82.7 steps/s
[Step=35450 Epoch=337.2] | Loss=0.00028 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.486 | L2-Norm(final)=3.625 | 1885.8 samples/s | 29.5 steps/s
[Step=35500 Epoch=337.7] | Loss=0.00024 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.485 | L2-Norm(final)=3.625 | 5013.1 samples/s | 78.3 steps/s
[Step=35550 Epoch=338.2] | Loss=0.00020 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=3.625 | 1957.6 samples/s | 30.6 steps/s
[Step=35600 Epoch=338.6] | Loss=0.00018 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=3.625 | 4578.5 samples/s | 71.5 steps/s
[Step=35650 Epoch=339.1] | Loss=0.00016 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.625 | 2012.0 samples/s | 31.4 steps/s
[Step=35700 Epoch=339.6] | Loss=0.00014 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.481 | L2-Norm(final)=3.625 | 4195.1 samples/s | 65.5 steps/s
[Step=35750 Epoch=340.1] | Loss=0.00013 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.480 | L2-Norm(final)=3.625 | 2054.5 samples/s | 32.1 steps/s
[Step=35800 Epoch=340.5] | Loss=0.00012 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=3.625 | 4263.0 samples/s | 66.6 steps/s
[Step=35850 Epoch=341.0] | Loss=0.00011 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=3.626 | 2125.1 samples/s | 33.2 steps/s
[Step=35900 Epoch=341.5] | Loss=0.00010 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.477 | L2-Norm(final)=3.626 | 4191.7 samples/s | 65.5 steps/s
[Step=35950 Epoch=342.0] | Loss=0.00010 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=3.626 | 2082.9 samples/s | 32.5 steps/s
[Step=36000 Epoch=342.4] | Loss=0.00009 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.474 | L2-Norm(final)=3.626 | 4131.0 samples/s | 64.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27074 | acc=0.9048 | tpr=0.8746 | fpr=0.0295 | 3930.3 samples/s | 15.4 steps/s
Avg test loss: 0.27309, Avg test acc: 0.90248, Avg tpr: 0.87259, Avg fpr: 0.03179, total FA: 248

Testing server on iccad2012
[Step=  50] | Loss=0.40313 | acc=0.9017 | tpr=0.9204 | fpr=0.0986 | 3881.8 samples/s | 15.2 steps/s
[Step= 100] | Loss=0.42079 | acc=0.8991 | tpr=0.9424 | fpr=0.1017 | 7292.0 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.43330 | acc=0.8978 | tpr=0.9452 | fpr=0.1030 | 7151.6 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.43439 | acc=0.8982 | tpr=0.9432 | fpr=0.1026 | 7918.8 samples/s | 30.9 steps/s
[Step= 250] | Loss=0.43156 | acc=0.8985 | tpr=0.9450 | fpr=0.1023 | 7244.9 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.43570 | acc=0.8983 | tpr=0.9411 | fpr=0.1025 | 7119.0 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.43883 | acc=0.8980 | tpr=0.9399 | fpr=0.1027 | 7281.2 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.44030 | acc=0.8984 | tpr=0.9398 | fpr=0.1023 | 7214.4 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.44431 | acc=0.8980 | tpr=0.9391 | fpr=0.1027 | 7228.4 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.44183 | acc=0.8982 | tpr=0.9405 | fpr=0.1026 | 7038.8 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.43936 | acc=0.8988 | tpr=0.9415 | fpr=0.1020 | 13136.9 samples/s | 51.3 steps/s
Avg test loss: 0.43861, Avg test acc: 0.89888, Avg tpr: 0.94176, Avg fpr: 0.10190, total FA: 14148

server round 45/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=175.5] | Loss=0.03085 | Reg=0.00155 | acc=0.9688 | L2-Norm=12.462 | L2-Norm(final)=3.634 | 4276.0 samples/s | 66.8 steps/s
[Step=36050 Epoch=175.8] | Loss=0.00708 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=3.633 | 3994.0 samples/s | 62.4 steps/s
[Step=36100 Epoch=176.0] | Loss=0.00456 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.478 | L2-Norm(final)=3.634 | 4124.2 samples/s | 64.4 steps/s
[Step=36150 Epoch=176.3] | Loss=0.00397 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=3.635 | 4220.0 samples/s | 65.9 steps/s
[Step=36200 Epoch=176.5] | Loss=0.00332 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.480 | L2-Norm(final)=3.636 | 5854.9 samples/s | 91.5 steps/s
[Step=36250 Epoch=176.8] | Loss=0.00292 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.481 | L2-Norm(final)=3.637 | 1897.7 samples/s | 29.7 steps/s
[Step=36300 Epoch=177.0] | Loss=0.00277 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.637 | 4409.0 samples/s | 68.9 steps/s
[Step=36350 Epoch=177.2] | Loss=0.00258 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.638 | 4367.0 samples/s | 68.2 steps/s
[Step=36400 Epoch=177.5] | Loss=0.00246 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=3.639 | 5389.6 samples/s | 84.2 steps/s
[Step=36450 Epoch=177.7] | Loss=0.00228 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=3.640 | 1941.2 samples/s | 30.3 steps/s
[Step=36500 Epoch=178.0] | Loss=0.00214 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=3.641 | 4318.4 samples/s | 67.5 steps/s
[Step=36550 Epoch=178.2] | Loss=0.00206 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=3.642 | 4377.7 samples/s | 68.4 steps/s
[Step=36600 Epoch=178.5] | Loss=0.00216 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.484 | L2-Norm(final)=3.642 | 4933.9 samples/s | 77.1 steps/s
[Step=36650 Epoch=178.7] | Loss=0.00211 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=3.643 | 1976.5 samples/s | 30.9 steps/s
[Step=36700 Epoch=179.0] | Loss=0.00206 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.485 | L2-Norm(final)=3.644 | 4381.3 samples/s | 68.5 steps/s
[Step=36750 Epoch=179.2] | Loss=0.00201 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.485 | L2-Norm(final)=3.645 | 4241.0 samples/s | 66.3 steps/s
[Step=36800 Epoch=179.4] | Loss=0.00195 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.485 | L2-Norm(final)=3.645 | 4724.0 samples/s | 73.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step36800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=175.7] | Loss=0.02715 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.462 | L2-Norm(final)=3.634 | 4227.3 samples/s | 66.1 steps/s
[Step=36050 Epoch=175.9] | Loss=0.00909 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=3.633 | 4276.4 samples/s | 66.8 steps/s
[Step=36100 Epoch=176.2] | Loss=0.00578 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=3.633 | 4280.9 samples/s | 66.9 steps/s
[Step=36150 Epoch=176.4] | Loss=0.00449 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.481 | L2-Norm(final)=3.634 | 4384.0 samples/s | 68.5 steps/s
[Step=36200 Epoch=176.6] | Loss=0.00389 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.634 | 5815.4 samples/s | 90.9 steps/s
[Step=36250 Epoch=176.9] | Loss=0.00335 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.635 | 1921.6 samples/s | 30.0 steps/s
[Step=36300 Epoch=177.1] | Loss=0.00293 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=3.636 | 4452.7 samples/s | 69.6 steps/s
[Step=36350 Epoch=177.4] | Loss=0.00284 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=3.637 | 4421.6 samples/s | 69.1 steps/s
[Step=36400 Epoch=177.6] | Loss=0.00269 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=3.638 | 5659.6 samples/s | 88.4 steps/s
[Step=36450 Epoch=177.9] | Loss=0.00254 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.484 | L2-Norm(final)=3.638 | 1961.0 samples/s | 30.6 steps/s
[Step=36500 Epoch=178.1] | Loss=0.00238 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.485 | L2-Norm(final)=3.639 | 4417.5 samples/s | 69.0 steps/s
[Step=36550 Epoch=178.3] | Loss=0.00230 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.485 | L2-Norm(final)=3.640 | 4236.9 samples/s | 66.2 steps/s
[Step=36600 Epoch=178.6] | Loss=0.00223 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.485 | L2-Norm(final)=3.640 | 5140.4 samples/s | 80.3 steps/s
[Step=36650 Epoch=178.8] | Loss=0.00215 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.486 | L2-Norm(final)=3.641 | 1987.4 samples/s | 31.1 steps/s
[Step=36700 Epoch=179.1] | Loss=0.00206 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.486 | L2-Norm(final)=3.642 | 4340.5 samples/s | 67.8 steps/s
[Step=36750 Epoch=179.3] | Loss=0.00204 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.486 | L2-Norm(final)=3.643 | 4270.6 samples/s | 66.7 steps/s
[Step=36800 Epoch=179.6] | Loss=0.00201 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.487 | L2-Norm(final)=3.643 | 4951.4 samples/s | 77.4 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step36800.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=341.1] | Loss=0.04859 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.462 | L2-Norm(final)=3.634 | 4485.1 samples/s | 70.1 steps/s
[Step=36050 Epoch=341.6] | Loss=0.00186 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.473 | L2-Norm(final)=3.637 | 3723.1 samples/s | 58.2 steps/s
[Step=36100 Epoch=342.1] | Loss=0.00093 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=3.638 | 5725.2 samples/s | 89.5 steps/s
[Step=36150 Epoch=342.6] | Loss=0.00062 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=3.639 | 1820.6 samples/s | 28.4 steps/s
[Step=36200 Epoch=343.0] | Loss=0.00047 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=3.639 | 5200.5 samples/s | 81.3 steps/s
[Step=36250 Epoch=343.5] | Loss=0.00038 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=3.639 | 1897.8 samples/s | 29.7 steps/s
[Step=36300 Epoch=344.0] | Loss=0.00031 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.474 | L2-Norm(final)=3.639 | 4777.4 samples/s | 74.6 steps/s
[Step=36350 Epoch=344.4] | Loss=0.00027 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.473 | L2-Norm(final)=3.639 | 1955.9 samples/s | 30.6 steps/s
[Step=36400 Epoch=344.9] | Loss=0.00024 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.472 | L2-Norm(final)=3.639 | 4337.2 samples/s | 67.8 steps/s
[Step=36450 Epoch=345.4] | Loss=0.00021 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.471 | L2-Norm(final)=3.639 | 1995.9 samples/s | 31.2 steps/s
[Step=36500 Epoch=345.9] | Loss=0.00019 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.470 | L2-Norm(final)=3.640 | 4301.6 samples/s | 67.2 steps/s
[Step=36550 Epoch=346.3] | Loss=0.00017 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.469 | L2-Norm(final)=3.640 | 2055.9 samples/s | 32.1 steps/s
[Step=36600 Epoch=346.8] | Loss=0.00016 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.467 | L2-Norm(final)=3.640 | 4055.2 samples/s | 63.4 steps/s
[Step=36650 Epoch=347.3] | Loss=0.00015 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.466 | L2-Norm(final)=3.640 | 2075.5 samples/s | 32.4 steps/s
[Step=36700 Epoch=347.8] | Loss=0.00014 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.465 | L2-Norm(final)=3.640 | 4148.7 samples/s | 64.8 steps/s
[Step=36750 Epoch=348.2] | Loss=0.00013 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=3.640 | 2079.9 samples/s | 32.5 steps/s
[Step=36800 Epoch=348.7] | Loss=0.00012 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.463 | L2-Norm(final)=3.640 | 4231.1 samples/s | 66.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step36800.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=342.5] | Loss=0.01189 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.462 | L2-Norm(final)=3.634 | 4416.9 samples/s | 69.0 steps/s
[Step=36050 Epoch=342.9] | Loss=0.00151 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.474 | L2-Norm(final)=3.639 | 3744.5 samples/s | 58.5 steps/s
[Step=36100 Epoch=343.4] | Loss=0.00076 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.477 | L2-Norm(final)=3.640 | 5660.9 samples/s | 88.5 steps/s
[Step=36150 Epoch=343.9] | Loss=0.00051 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.477 | L2-Norm(final)=3.640 | 1874.7 samples/s | 29.3 steps/s
[Step=36200 Epoch=344.4] | Loss=0.00038 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=3.640 | 5249.9 samples/s | 82.0 steps/s
[Step=36250 Epoch=344.8] | Loss=0.00031 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=3.640 | 1868.9 samples/s | 29.2 steps/s
[Step=36300 Epoch=345.3] | Loss=0.00026 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=3.640 | 4666.8 samples/s | 72.9 steps/s
[Step=36350 Epoch=345.8] | Loss=0.00022 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.474 | L2-Norm(final)=3.640 | 1912.6 samples/s | 29.9 steps/s
[Step=36400 Epoch=346.3] | Loss=0.00019 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.472 | L2-Norm(final)=3.641 | 4540.7 samples/s | 70.9 steps/s
[Step=36450 Epoch=346.7] | Loss=0.00017 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.471 | L2-Norm(final)=3.641 | 1961.5 samples/s | 30.6 steps/s
[Step=36500 Epoch=347.2] | Loss=0.00016 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.470 | L2-Norm(final)=3.641 | 4087.9 samples/s | 63.9 steps/s
[Step=36550 Epoch=347.7] | Loss=0.00014 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.469 | L2-Norm(final)=3.641 | 2023.5 samples/s | 31.6 steps/s
[Step=36600 Epoch=348.2] | Loss=0.00013 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.468 | L2-Norm(final)=3.641 | 4097.9 samples/s | 64.0 steps/s
[Step=36650 Epoch=348.6] | Loss=0.00012 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.467 | L2-Norm(final)=3.641 | 2038.6 samples/s | 31.9 steps/s
[Step=36700 Epoch=349.1] | Loss=0.00011 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.466 | L2-Norm(final)=3.641 | 4102.2 samples/s | 64.1 steps/s
[Step=36750 Epoch=349.6] | Loss=0.00011 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=3.641 | 2061.9 samples/s | 32.2 steps/s
[Step=36800 Epoch=350.1] | Loss=0.00010 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.463 | L2-Norm(final)=3.641 | 3975.9 samples/s | 62.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step36800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29718 | acc=0.8943 | tpr=0.8578 | fpr=0.0265 | 3998.0 samples/s | 15.6 steps/s
Avg test loss: 0.30010, Avg test acc: 0.89234, Avg tpr: 0.85673, Avg fpr: 0.02936, total FA: 229

Testing server on iccad2012
[Step=  50] | Loss=0.36308 | acc=0.9142 | tpr=0.9204 | fpr=0.0859 | 3916.4 samples/s | 15.3 steps/s
[Step= 100] | Loss=0.37843 | acc=0.9113 | tpr=0.9403 | fpr=0.0893 | 7245.0 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.39070 | acc=0.9102 | tpr=0.9424 | fpr=0.0904 | 7115.5 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.39233 | acc=0.9105 | tpr=0.9388 | fpr=0.0900 | 7778.0 samples/s | 30.4 steps/s
[Step= 250] | Loss=0.38960 | acc=0.9106 | tpr=0.9424 | fpr=0.0900 | 6812.1 samples/s | 26.6 steps/s
[Step= 300] | Loss=0.39388 | acc=0.9101 | tpr=0.9396 | fpr=0.0904 | 7189.0 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.39695 | acc=0.9097 | tpr=0.9380 | fpr=0.0908 | 7498.6 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.39859 | acc=0.9099 | tpr=0.9371 | fpr=0.0906 | 7415.7 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.40261 | acc=0.9094 | tpr=0.9357 | fpr=0.0911 | 7193.0 samples/s | 28.1 steps/s
[Step= 500] | Loss=0.40023 | acc=0.9096 | tpr=0.9374 | fpr=0.0909 | 7041.3 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.39814 | acc=0.9101 | tpr=0.9383 | fpr=0.0904 | 13601.7 samples/s | 53.1 steps/s
Avg test loss: 0.39741, Avg test acc: 0.91017, Avg tpr: 0.93859, Avg fpr: 0.09035, total FA: 12545

server round 46/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=179.4] | Loss=0.09150 | Reg=0.00155 | acc=0.9375 | L2-Norm=12.452 | L2-Norm(final)=3.648 | 4188.2 samples/s | 65.4 steps/s
[Step=36850 Epoch=179.7] | Loss=0.00794 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.466 | L2-Norm(final)=3.647 | 4147.9 samples/s | 64.8 steps/s
[Step=36900 Epoch=179.9] | Loss=0.00514 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.470 | L2-Norm(final)=3.648 | 4277.1 samples/s | 66.8 steps/s
[Step=36950 Epoch=180.2] | Loss=0.00394 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.472 | L2-Norm(final)=3.649 | 4283.8 samples/s | 66.9 steps/s
[Step=37000 Epoch=180.4] | Loss=0.00352 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.473 | L2-Norm(final)=3.650 | 5984.6 samples/s | 93.5 steps/s
[Step=37050 Epoch=180.7] | Loss=0.00338 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.474 | L2-Norm(final)=3.650 | 1888.2 samples/s | 29.5 steps/s
[Step=37100 Epoch=180.9] | Loss=0.00308 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.474 | L2-Norm(final)=3.651 | 4288.4 samples/s | 67.0 steps/s
[Step=37150 Epoch=181.2] | Loss=0.00282 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=3.652 | 4267.1 samples/s | 66.7 steps/s
[Step=37200 Epoch=181.4] | Loss=0.00274 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=3.653 | 5381.5 samples/s | 84.1 steps/s
[Step=37250 Epoch=181.6] | Loss=0.00259 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=3.653 | 1938.8 samples/s | 30.3 steps/s
[Step=37300 Epoch=181.9] | Loss=0.00253 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=3.654 | 4244.7 samples/s | 66.3 steps/s
[Step=37350 Epoch=182.1] | Loss=0.00243 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=3.655 | 4276.1 samples/s | 66.8 steps/s
[Step=37400 Epoch=182.4] | Loss=0.00233 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.476 | L2-Norm(final)=3.656 | 4943.0 samples/s | 77.2 steps/s
[Step=37450 Epoch=182.6] | Loss=0.00227 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=3.656 | 1972.0 samples/s | 30.8 steps/s
[Step=37500 Epoch=182.9] | Loss=0.00220 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.477 | L2-Norm(final)=3.657 | 4291.3 samples/s | 67.1 steps/s
[Step=37550 Epoch=183.1] | Loss=0.00218 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.477 | L2-Norm(final)=3.658 | 4242.9 samples/s | 66.3 steps/s
[Step=37600 Epoch=183.3] | Loss=0.00213 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.477 | L2-Norm(final)=3.659 | 4799.7 samples/s | 75.0 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step37600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=179.6] | Loss=0.02900 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.452 | L2-Norm(final)=3.648 | 4987.6 samples/s | 77.9 steps/s
[Step=36850 Epoch=179.8] | Loss=0.00792 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.469 | L2-Norm(final)=3.647 | 3917.3 samples/s | 61.2 steps/s
[Step=36900 Epoch=180.1] | Loss=0.00489 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.473 | L2-Norm(final)=3.648 | 4357.2 samples/s | 68.1 steps/s
[Step=36950 Epoch=180.3] | Loss=0.00394 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=3.649 | 4496.2 samples/s | 70.3 steps/s
[Step=37000 Epoch=180.5] | Loss=0.00351 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=3.649 | 6030.3 samples/s | 94.2 steps/s
[Step=37050 Epoch=180.8] | Loss=0.00304 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.477 | L2-Norm(final)=3.650 | 1947.2 samples/s | 30.4 steps/s
[Step=37100 Epoch=181.0] | Loss=0.00272 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.477 | L2-Norm(final)=3.651 | 4440.5 samples/s | 69.4 steps/s
[Step=37150 Epoch=181.3] | Loss=0.00250 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=3.652 | 4374.9 samples/s | 68.4 steps/s
[Step=37200 Epoch=181.5] | Loss=0.00246 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=3.652 | 5682.8 samples/s | 88.8 steps/s
[Step=37250 Epoch=181.8] | Loss=0.00233 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=3.653 | 1968.5 samples/s | 30.8 steps/s
[Step=37300 Epoch=182.0] | Loss=0.00218 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=3.654 | 4511.7 samples/s | 70.5 steps/s
[Step=37350 Epoch=182.3] | Loss=0.00215 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=3.655 | 4539.9 samples/s | 70.9 steps/s
[Step=37400 Epoch=182.5] | Loss=0.00209 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.479 | L2-Norm(final)=3.655 | 5172.0 samples/s | 80.8 steps/s
[Step=37450 Epoch=182.7] | Loss=0.00205 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.480 | L2-Norm(final)=3.656 | 1987.7 samples/s | 31.1 steps/s
[Step=37500 Epoch=183.0] | Loss=0.00197 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.480 | L2-Norm(final)=3.657 | 4438.8 samples/s | 69.4 steps/s
[Step=37550 Epoch=183.2] | Loss=0.00191 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.480 | L2-Norm(final)=3.657 | 4495.7 samples/s | 70.2 steps/s
[Step=37600 Epoch=183.5] | Loss=0.00188 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.480 | L2-Norm(final)=3.658 | 5001.2 samples/s | 78.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step37600.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=348.7] | Loss=0.01110 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.452 | L2-Norm(final)=3.648 | 4210.9 samples/s | 65.8 steps/s
[Step=36850 Epoch=349.2] | Loss=0.00065 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.457 | L2-Norm(final)=3.653 | 3904.6 samples/s | 61.0 steps/s
[Step=36900 Epoch=349.7] | Loss=0.00034 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.458 | L2-Norm(final)=3.654 | 5645.4 samples/s | 88.2 steps/s
[Step=36950 Epoch=350.1] | Loss=0.00023 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.458 | L2-Norm(final)=3.655 | 1836.6 samples/s | 28.7 steps/s
[Step=37000 Epoch=350.6] | Loss=0.00017 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.457 | L2-Norm(final)=3.656 | 5219.8 samples/s | 81.6 steps/s
[Step=37050 Epoch=351.1] | Loss=0.00014 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.456 | L2-Norm(final)=3.656 | 1880.5 samples/s | 29.4 steps/s
[Step=37100 Epoch=351.6] | Loss=0.00012 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.455 | L2-Norm(final)=3.656 | 4908.3 samples/s | 76.7 steps/s
[Step=37150 Epoch=352.0] | Loss=0.00010 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.657 | 1940.7 samples/s | 30.3 steps/s
[Step=37200 Epoch=352.5] | Loss=0.00009 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.453 | L2-Norm(final)=3.657 | 4502.4 samples/s | 70.3 steps/s
[Step=37250 Epoch=353.0] | Loss=0.00008 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.452 | L2-Norm(final)=3.657 | 1993.0 samples/s | 31.1 steps/s
[Step=37300 Epoch=353.4] | Loss=0.00007 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.451 | L2-Norm(final)=3.657 | 4178.6 samples/s | 65.3 steps/s
[Step=37350 Epoch=353.9] | Loss=0.00007 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.450 | L2-Norm(final)=3.658 | 2048.5 samples/s | 32.0 steps/s
[Step=37400 Epoch=354.4] | Loss=0.00006 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.449 | L2-Norm(final)=3.658 | 4099.4 samples/s | 64.1 steps/s
[Step=37450 Epoch=354.9] | Loss=0.00006 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.447 | L2-Norm(final)=3.658 | 2113.4 samples/s | 33.0 steps/s
[Step=37500 Epoch=355.3] | Loss=0.00005 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.446 | L2-Norm(final)=3.658 | 4079.7 samples/s | 63.7 steps/s
[Step=37550 Epoch=355.8] | Loss=0.00005 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.445 | L2-Norm(final)=3.658 | 2009.9 samples/s | 31.4 steps/s
[Step=37600 Epoch=356.3] | Loss=0.00005 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.443 | L2-Norm(final)=3.658 | 4195.7 samples/s | 65.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step37600.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=350.1] | Loss=0.00055 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.452 | L2-Norm(final)=3.648 | 4095.9 samples/s | 64.0 steps/s
[Step=36850 Epoch=350.5] | Loss=0.00085 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.461 | L2-Norm(final)=3.653 | 4040.3 samples/s | 63.1 steps/s
[Step=36900 Epoch=351.0] | Loss=0.00043 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.462 | L2-Norm(final)=3.654 | 5818.5 samples/s | 90.9 steps/s
[Step=36950 Epoch=351.5] | Loss=0.00029 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.462 | L2-Norm(final)=3.654 | 1856.3 samples/s | 29.0 steps/s
[Step=37000 Epoch=352.0] | Loss=0.00022 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.462 | L2-Norm(final)=3.655 | 5151.7 samples/s | 80.5 steps/s
[Step=37050 Epoch=352.4] | Loss=0.00018 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.461 | L2-Norm(final)=3.655 | 1881.3 samples/s | 29.4 steps/s
[Step=37100 Epoch=352.9] | Loss=0.00015 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.460 | L2-Norm(final)=3.655 | 4801.9 samples/s | 75.0 steps/s
[Step=37150 Epoch=353.4] | Loss=0.00013 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.458 | L2-Norm(final)=3.655 | 1936.3 samples/s | 30.3 steps/s
[Step=37200 Epoch=353.9] | Loss=0.00011 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.457 | L2-Norm(final)=3.656 | 4627.1 samples/s | 72.3 steps/s
[Step=37250 Epoch=354.3] | Loss=0.00010 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.456 | L2-Norm(final)=3.656 | 1995.6 samples/s | 31.2 steps/s
[Step=37300 Epoch=354.8] | Loss=0.00009 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.455 | L2-Norm(final)=3.656 | 4262.7 samples/s | 66.6 steps/s
[Step=37350 Epoch=355.3] | Loss=0.00008 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.656 | 2059.8 samples/s | 32.2 steps/s
[Step=37400 Epoch=355.8] | Loss=0.00008 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.452 | L2-Norm(final)=3.656 | 4134.6 samples/s | 64.6 steps/s
[Step=37450 Epoch=356.2] | Loss=0.00007 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.451 | L2-Norm(final)=3.656 | 2065.8 samples/s | 32.3 steps/s
[Step=37500 Epoch=356.7] | Loss=0.00007 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.450 | L2-Norm(final)=3.656 | 4008.9 samples/s | 62.6 steps/s
[Step=37550 Epoch=357.2] | Loss=0.00006 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.448 | L2-Norm(final)=3.656 | 2095.8 samples/s | 32.7 steps/s
[Step=37600 Epoch=357.7] | Loss=0.00006 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.447 | L2-Norm(final)=3.657 | 4216.7 samples/s | 65.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step37600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.26000 | acc=0.9077 | tpr=0.8801 | fpr=0.0325 | 3984.5 samples/s | 15.6 steps/s
Avg test loss: 0.26252, Avg test acc: 0.90628, Avg tpr: 0.87935, Avg fpr: 0.03448, total FA: 269

Testing server on iccad2012
[Step=  50] | Loss=0.40938 | acc=0.8977 | tpr=0.9204 | fpr=0.1028 | 3978.1 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.42604 | acc=0.8950 | tpr=0.9403 | fpr=0.1058 | 7243.8 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.43822 | acc=0.8940 | tpr=0.9438 | fpr=0.1069 | 7489.0 samples/s | 29.3 steps/s
[Step= 200] | Loss=0.43978 | acc=0.8945 | tpr=0.9410 | fpr=0.1064 | 7179.5 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.43744 | acc=0.8945 | tpr=0.9441 | fpr=0.1064 | 7389.1 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.44147 | acc=0.8945 | tpr=0.9404 | fpr=0.1064 | 7506.9 samples/s | 29.3 steps/s
[Step= 350] | Loss=0.44469 | acc=0.8942 | tpr=0.9399 | fpr=0.1066 | 7034.7 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.44611 | acc=0.8947 | tpr=0.9398 | fpr=0.1061 | 7342.4 samples/s | 28.7 steps/s
[Step= 450] | Loss=0.45029 | acc=0.8943 | tpr=0.9401 | fpr=0.1065 | 7250.5 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.44788 | acc=0.8945 | tpr=0.9419 | fpr=0.1063 | 7182.6 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.44549 | acc=0.8954 | tpr=0.9423 | fpr=0.1054 | 12926.4 samples/s | 50.5 steps/s
Avg test loss: 0.44473, Avg test acc: 0.89549, Avg tpr: 0.94255, Avg fpr: 0.10537, total FA: 14630

server round 47/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=183.3] | Loss=0.01603 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.439 | L2-Norm(final)=3.664 | 4655.8 samples/s | 72.7 steps/s
[Step=37650 Epoch=183.6] | Loss=0.00545 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.456 | L2-Norm(final)=3.664 | 3754.7 samples/s | 58.7 steps/s
[Step=37700 Epoch=183.8] | Loss=0.00409 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.459 | L2-Norm(final)=3.665 | 4304.0 samples/s | 67.3 steps/s
[Step=37750 Epoch=184.1] | Loss=0.00361 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.461 | L2-Norm(final)=3.665 | 4320.7 samples/s | 67.5 steps/s
[Step=37800 Epoch=184.3] | Loss=0.00312 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.462 | L2-Norm(final)=3.666 | 5779.8 samples/s | 90.3 steps/s
[Step=37850 Epoch=184.6] | Loss=0.00272 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.463 | L2-Norm(final)=3.667 | 1894.4 samples/s | 29.6 steps/s
[Step=37900 Epoch=184.8] | Loss=0.00246 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=3.668 | 4414.7 samples/s | 69.0 steps/s
[Step=37950 Epoch=185.1] | Loss=0.00244 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=3.669 | 4340.6 samples/s | 67.8 steps/s
[Step=38000 Epoch=185.3] | Loss=0.00241 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.464 | L2-Norm(final)=3.670 | 5479.1 samples/s | 85.6 steps/s
[Step=38050 Epoch=185.5] | Loss=0.00229 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.465 | L2-Norm(final)=3.670 | 1919.1 samples/s | 30.0 steps/s
[Step=38100 Epoch=185.8] | Loss=0.00224 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.465 | L2-Norm(final)=3.671 | 4194.7 samples/s | 65.5 steps/s
[Step=38150 Epoch=186.0] | Loss=0.00216 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.465 | L2-Norm(final)=3.672 | 4301.9 samples/s | 67.2 steps/s
[Step=38200 Epoch=186.3] | Loss=0.00209 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.466 | L2-Norm(final)=3.673 | 4939.5 samples/s | 77.2 steps/s
[Step=38250 Epoch=186.5] | Loss=0.00208 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.466 | L2-Norm(final)=3.673 | 1993.6 samples/s | 31.2 steps/s
[Step=38300 Epoch=186.8] | Loss=0.00202 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.466 | L2-Norm(final)=3.674 | 4276.6 samples/s | 66.8 steps/s
[Step=38350 Epoch=187.0] | Loss=0.00201 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.466 | L2-Norm(final)=3.675 | 4278.7 samples/s | 66.9 steps/s
[Step=38400 Epoch=187.2] | Loss=0.00196 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.467 | L2-Norm(final)=3.676 | 4598.2 samples/s | 71.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step38400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=183.5] | Loss=0.01402 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.439 | L2-Norm(final)=3.664 | 4377.8 samples/s | 68.4 steps/s
[Step=37650 Epoch=183.7] | Loss=0.00776 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.665 | 4190.2 samples/s | 65.5 steps/s
[Step=37700 Epoch=184.0] | Loss=0.00490 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.457 | L2-Norm(final)=3.666 | 4256.2 samples/s | 66.5 steps/s
[Step=37750 Epoch=184.2] | Loss=0.00375 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.459 | L2-Norm(final)=3.666 | 4189.5 samples/s | 65.5 steps/s
[Step=37800 Epoch=184.4] | Loss=0.00338 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.460 | L2-Norm(final)=3.667 | 5891.0 samples/s | 92.0 steps/s
[Step=37850 Epoch=184.7] | Loss=0.00297 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.461 | L2-Norm(final)=3.668 | 1863.9 samples/s | 29.1 steps/s
[Step=37900 Epoch=184.9] | Loss=0.00265 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.461 | L2-Norm(final)=3.669 | 4523.8 samples/s | 70.7 steps/s
[Step=37950 Epoch=185.2] | Loss=0.00255 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.462 | L2-Norm(final)=3.670 | 4487.6 samples/s | 70.1 steps/s
[Step=38000 Epoch=185.4] | Loss=0.00244 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.462 | L2-Norm(final)=3.671 | 5336.6 samples/s | 83.4 steps/s
[Step=38050 Epoch=185.7] | Loss=0.00235 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.463 | L2-Norm(final)=3.671 | 1925.3 samples/s | 30.1 steps/s
[Step=38100 Epoch=185.9] | Loss=0.00229 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.463 | L2-Norm(final)=3.672 | 4320.9 samples/s | 67.5 steps/s
[Step=38150 Epoch=186.2] | Loss=0.00217 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.463 | L2-Norm(final)=3.673 | 4417.0 samples/s | 69.0 steps/s
[Step=38200 Epoch=186.4] | Loss=0.00206 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=3.673 | 5352.1 samples/s | 83.6 steps/s
[Step=38250 Epoch=186.6] | Loss=0.00198 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=3.674 | 2009.5 samples/s | 31.4 steps/s
[Step=38300 Epoch=186.9] | Loss=0.00194 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=3.675 | 4436.8 samples/s | 69.3 steps/s
[Step=38350 Epoch=187.1] | Loss=0.00185 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=3.676 | 4414.5 samples/s | 69.0 steps/s
[Step=38400 Epoch=187.4] | Loss=0.00184 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.465 | L2-Norm(final)=3.676 | 4987.6 samples/s | 77.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step38400.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=356.3] | Loss=0.00652 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=3.664 | 4461.6 samples/s | 69.7 steps/s
[Step=37650 Epoch=356.8] | Loss=0.00081 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.452 | L2-Norm(final)=3.669 | 3730.9 samples/s | 58.3 steps/s
[Step=37700 Epoch=357.2] | Loss=0.00041 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.670 | 5675.4 samples/s | 88.7 steps/s
[Step=37750 Epoch=357.7] | Loss=0.00028 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.670 | 1861.8 samples/s | 29.1 steps/s
[Step=37800 Epoch=358.2] | Loss=0.00021 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.670 | 5315.2 samples/s | 83.1 steps/s
[Step=37850 Epoch=358.7] | Loss=0.00017 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.453 | L2-Norm(final)=3.671 | 1918.6 samples/s | 30.0 steps/s
[Step=37900 Epoch=359.1] | Loss=0.00014 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.452 | L2-Norm(final)=3.671 | 4871.4 samples/s | 76.1 steps/s
[Step=37950 Epoch=359.6] | Loss=0.00012 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.450 | L2-Norm(final)=3.671 | 1950.0 samples/s | 30.5 steps/s
[Step=38000 Epoch=360.1] | Loss=0.00011 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.449 | L2-Norm(final)=3.671 | 4431.2 samples/s | 69.2 steps/s
[Step=38050 Epoch=360.6] | Loss=0.00009 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.448 | L2-Norm(final)=3.671 | 2007.9 samples/s | 31.4 steps/s
[Step=38100 Epoch=361.0] | Loss=0.00009 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.447 | L2-Norm(final)=3.671 | 4276.3 samples/s | 66.8 steps/s
[Step=38150 Epoch=361.5] | Loss=0.00008 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.446 | L2-Norm(final)=3.672 | 2061.1 samples/s | 32.2 steps/s
[Step=38200 Epoch=362.0] | Loss=0.00007 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.444 | L2-Norm(final)=3.672 | 4163.3 samples/s | 65.1 steps/s
[Step=38250 Epoch=362.5] | Loss=0.00007 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.443 | L2-Norm(final)=3.672 | 2075.4 samples/s | 32.4 steps/s
[Step=38300 Epoch=362.9] | Loss=0.00006 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.442 | L2-Norm(final)=3.672 | 4137.1 samples/s | 64.6 steps/s
[Step=38350 Epoch=363.4] | Loss=0.00006 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.440 | L2-Norm(final)=3.672 | 2082.5 samples/s | 32.5 steps/s
[Step=38400 Epoch=363.9] | Loss=0.00005 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=3.672 | 4014.2 samples/s | 62.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step38400.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=357.7] | Loss=0.06445 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.439 | L2-Norm(final)=3.664 | 4388.5 samples/s | 68.6 steps/s
[Step=37650 Epoch=358.1] | Loss=0.00261 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.450 | L2-Norm(final)=3.668 | 3727.8 samples/s | 58.2 steps/s
[Step=37700 Epoch=358.6] | Loss=0.00131 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.452 | L2-Norm(final)=3.669 | 5695.0 samples/s | 89.0 steps/s
[Step=37750 Epoch=359.1] | Loss=0.00087 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.452 | L2-Norm(final)=3.669 | 1814.8 samples/s | 28.4 steps/s
[Step=37800 Epoch=359.6] | Loss=0.00066 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.451 | L2-Norm(final)=3.669 | 5188.7 samples/s | 81.1 steps/s
[Step=37850 Epoch=360.0] | Loss=0.00053 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.450 | L2-Norm(final)=3.669 | 1890.4 samples/s | 29.5 steps/s
[Step=37900 Epoch=360.5] | Loss=0.00044 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.449 | L2-Norm(final)=3.669 | 4807.1 samples/s | 75.1 steps/s
[Step=37950 Epoch=361.0] | Loss=0.00038 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.448 | L2-Norm(final)=3.669 | 1953.6 samples/s | 30.5 steps/s
[Step=38000 Epoch=361.5] | Loss=0.00033 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.447 | L2-Norm(final)=3.669 | 4467.2 samples/s | 69.8 steps/s
[Step=38050 Epoch=362.0] | Loss=0.00029 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.446 | L2-Norm(final)=3.669 | 1989.7 samples/s | 31.1 steps/s
[Step=38100 Epoch=362.4] | Loss=0.00027 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.445 | L2-Norm(final)=3.669 | 4294.7 samples/s | 67.1 steps/s
[Step=38150 Epoch=362.9] | Loss=0.00024 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.444 | L2-Norm(final)=3.670 | 2039.9 samples/s | 31.9 steps/s
[Step=38200 Epoch=363.4] | Loss=0.00022 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.442 | L2-Norm(final)=3.670 | 4177.0 samples/s | 65.3 steps/s
[Step=38250 Epoch=363.9] | Loss=0.00020 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.441 | L2-Norm(final)=3.670 | 2087.3 samples/s | 32.6 steps/s
[Step=38300 Epoch=364.3] | Loss=0.00019 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.440 | L2-Norm(final)=3.670 | 4173.2 samples/s | 65.2 steps/s
[Step=38350 Epoch=364.8] | Loss=0.00018 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.438 | L2-Norm(final)=3.670 | 2113.8 samples/s | 33.0 steps/s
[Step=38400 Epoch=365.3] | Loss=0.00017 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.437 | L2-Norm(final)=3.670 | 4204.3 samples/s | 65.7 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step38400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.29095 | acc=0.8972 | tpr=0.8620 | fpr=0.0265 | 4034.9 samples/s | 15.8 steps/s
Avg test loss: 0.29360, Avg test acc: 0.89554, Avg tpr: 0.86146, Avg fpr: 0.02948, total FA: 230

Testing server on iccad2012
[Step=  50] | Loss=0.37407 | acc=0.9115 | tpr=0.9204 | fpr=0.0887 | 4010.3 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.39025 | acc=0.9082 | tpr=0.9403 | fpr=0.0924 | 7632.2 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.40230 | acc=0.9070 | tpr=0.9409 | fpr=0.0936 | 7582.1 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.40382 | acc=0.9069 | tpr=0.9366 | fpr=0.0936 | 7683.7 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.40126 | acc=0.9071 | tpr=0.9397 | fpr=0.0935 | 7380.4 samples/s | 28.8 steps/s
[Step= 300] | Loss=0.40554 | acc=0.9069 | tpr=0.9367 | fpr=0.0937 | 7025.8 samples/s | 27.4 steps/s
[Step= 350] | Loss=0.40856 | acc=0.9064 | tpr=0.9355 | fpr=0.0941 | 4522.7 samples/s | 17.7 steps/s
[Step= 400] | Loss=0.40999 | acc=0.9067 | tpr=0.9349 | fpr=0.0938 | 7278.8 samples/s | 28.4 steps/s
[Step= 450] | Loss=0.41416 | acc=0.9062 | tpr=0.9343 | fpr=0.0943 | 7105.0 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.41188 | acc=0.9062 | tpr=0.9361 | fpr=0.0943 | 7146.0 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.40963 | acc=0.9069 | tpr=0.9371 | fpr=0.0936 | 13538.8 samples/s | 52.9 steps/s
Avg test loss: 0.40892, Avg test acc: 0.90700, Avg tpr: 0.93740, Avg fpr: 0.09356, total FA: 12990

server round 48/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=187.3] | Loss=0.01821 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.427 | L2-Norm(final)=3.680 | 4318.1 samples/s | 67.5 steps/s
[Step=38450 Epoch=187.5] | Loss=0.00701 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.445 | L2-Norm(final)=3.679 | 4158.1 samples/s | 65.0 steps/s
[Step=38500 Epoch=187.7] | Loss=0.00473 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.448 | L2-Norm(final)=3.680 | 4268.7 samples/s | 66.7 steps/s
[Step=38550 Epoch=188.0] | Loss=0.00393 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.450 | L2-Norm(final)=3.680 | 4340.4 samples/s | 67.8 steps/s
[Step=38600 Epoch=188.2] | Loss=0.00352 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.451 | L2-Norm(final)=3.681 | 5929.6 samples/s | 92.6 steps/s
[Step=38650 Epoch=188.5] | Loss=0.00303 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.452 | L2-Norm(final)=3.682 | 1893.1 samples/s | 29.6 steps/s
[Step=38700 Epoch=188.7] | Loss=0.00277 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.452 | L2-Norm(final)=3.682 | 4362.4 samples/s | 68.2 steps/s
[Step=38750 Epoch=189.0] | Loss=0.00263 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.453 | L2-Norm(final)=3.683 | 4354.9 samples/s | 68.0 steps/s
[Step=38800 Epoch=189.2] | Loss=0.00255 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.453 | L2-Norm(final)=3.684 | 5579.4 samples/s | 87.2 steps/s
[Step=38850 Epoch=189.4] | Loss=0.00236 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.684 | 1949.6 samples/s | 30.5 steps/s
[Step=38900 Epoch=189.7] | Loss=0.00235 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.685 | 4373.2 samples/s | 68.3 steps/s
[Step=38950 Epoch=189.9] | Loss=0.00227 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.686 | 4355.0 samples/s | 68.0 steps/s
[Step=39000 Epoch=190.2] | Loss=0.00217 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.455 | L2-Norm(final)=3.687 | 5262.6 samples/s | 82.2 steps/s
[Step=39050 Epoch=190.4] | Loss=0.00211 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.455 | L2-Norm(final)=3.687 | 2046.1 samples/s | 32.0 steps/s
[Step=39100 Epoch=190.7] | Loss=0.00206 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.455 | L2-Norm(final)=3.688 | 4377.3 samples/s | 68.4 steps/s
[Step=39150 Epoch=190.9] | Loss=0.00205 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.455 | L2-Norm(final)=3.689 | 4355.5 samples/s | 68.1 steps/s
[Step=39200 Epoch=191.1] | Loss=0.00199 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.456 | L2-Norm(final)=3.689 | 4722.8 samples/s | 73.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step39200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=187.4] | Loss=0.10885 | Reg=0.00154 | acc=0.8906 | L2-Norm=12.427 | L2-Norm(final)=3.680 | 4328.3 samples/s | 67.6 steps/s
[Step=38450 Epoch=187.6] | Loss=0.00688 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.438 | L2-Norm(final)=3.680 | 4087.6 samples/s | 63.9 steps/s
[Step=38500 Epoch=187.9] | Loss=0.00414 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.441 | L2-Norm(final)=3.681 | 4223.4 samples/s | 66.0 steps/s
[Step=38550 Epoch=188.1] | Loss=0.00334 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.443 | L2-Norm(final)=3.682 | 4330.1 samples/s | 67.7 steps/s
[Step=38600 Epoch=188.4] | Loss=0.00297 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.444 | L2-Norm(final)=3.683 | 5829.1 samples/s | 91.1 steps/s
[Step=38650 Epoch=188.6] | Loss=0.00263 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.445 | L2-Norm(final)=3.684 | 1919.4 samples/s | 30.0 steps/s
[Step=38700 Epoch=188.8] | Loss=0.00232 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.446 | L2-Norm(final)=3.685 | 4400.5 samples/s | 68.8 steps/s
[Step=38750 Epoch=189.1] | Loss=0.00215 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.446 | L2-Norm(final)=3.686 | 4433.0 samples/s | 69.3 steps/s
[Step=38800 Epoch=189.3] | Loss=0.00218 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.447 | L2-Norm(final)=3.687 | 5621.8 samples/s | 87.8 steps/s
[Step=38850 Epoch=189.6] | Loss=0.00210 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.447 | L2-Norm(final)=3.688 | 1989.7 samples/s | 31.1 steps/s
[Step=38900 Epoch=189.8] | Loss=0.00207 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.448 | L2-Norm(final)=3.688 | 4509.4 samples/s | 70.5 steps/s
[Step=38950 Epoch=190.1] | Loss=0.00196 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.448 | L2-Norm(final)=3.689 | 4316.1 samples/s | 67.4 steps/s
[Step=39000 Epoch=190.3] | Loss=0.00191 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.448 | L2-Norm(final)=3.690 | 5282.8 samples/s | 82.5 steps/s
[Step=39050 Epoch=190.5] | Loss=0.00188 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.449 | L2-Norm(final)=3.691 | 1980.8 samples/s | 30.9 steps/s
[Step=39100 Epoch=190.8] | Loss=0.00179 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.449 | L2-Norm(final)=3.691 | 4375.4 samples/s | 68.4 steps/s
[Step=39150 Epoch=191.0] | Loss=0.00174 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.449 | L2-Norm(final)=3.692 | 4490.4 samples/s | 70.2 steps/s
[Step=39200 Epoch=191.3] | Loss=0.00172 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.449 | L2-Norm(final)=3.693 | 4915.5 samples/s | 76.8 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step39200.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=363.9] | Loss=0.00219 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.427 | L2-Norm(final)=3.680 | 4072.8 samples/s | 63.6 steps/s
[Step=38450 Epoch=364.3] | Loss=0.00124 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.436 | L2-Norm(final)=3.683 | 3940.9 samples/s | 61.6 steps/s
[Step=38500 Epoch=364.8] | Loss=0.00063 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.438 | L2-Norm(final)=3.684 | 5715.4 samples/s | 89.3 steps/s
[Step=38550 Epoch=365.3] | Loss=0.00042 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.437 | L2-Norm(final)=3.685 | 1852.1 samples/s | 28.9 steps/s
[Step=38600 Epoch=365.8] | Loss=0.00032 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.436 | L2-Norm(final)=3.685 | 5219.9 samples/s | 81.6 steps/s
[Step=38650 Epoch=366.2] | Loss=0.00025 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.435 | L2-Norm(final)=3.685 | 1903.7 samples/s | 29.7 steps/s
[Step=38700 Epoch=366.7] | Loss=0.00021 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.434 | L2-Norm(final)=3.685 | 4812.3 samples/s | 75.2 steps/s
[Step=38750 Epoch=367.2] | Loss=0.00018 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.433 | L2-Norm(final)=3.685 | 1926.3 samples/s | 30.1 steps/s
[Step=38800 Epoch=367.7] | Loss=0.00016 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.432 | L2-Norm(final)=3.685 | 4460.7 samples/s | 69.7 steps/s
[Step=38850 Epoch=368.1] | Loss=0.00014 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.431 | L2-Norm(final)=3.685 | 2010.0 samples/s | 31.4 steps/s
[Step=38900 Epoch=368.6] | Loss=0.00013 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.429 | L2-Norm(final)=3.686 | 4123.3 samples/s | 64.4 steps/s
[Step=38950 Epoch=369.1] | Loss=0.00012 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.428 | L2-Norm(final)=3.686 | 2031.0 samples/s | 31.7 steps/s
[Step=39000 Epoch=369.6] | Loss=0.00011 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.427 | L2-Norm(final)=3.686 | 4059.0 samples/s | 63.4 steps/s
[Step=39050 Epoch=370.0] | Loss=0.00010 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.425 | L2-Norm(final)=3.686 | 2072.6 samples/s | 32.4 steps/s
[Step=39100 Epoch=370.5] | Loss=0.00009 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.424 | L2-Norm(final)=3.686 | 4055.3 samples/s | 63.4 steps/s
[Step=39150 Epoch=371.0] | Loss=0.00009 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.423 | L2-Norm(final)=3.686 | 2067.7 samples/s | 32.3 steps/s
[Step=39200 Epoch=371.5] | Loss=0.00008 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.421 | L2-Norm(final)=3.686 | 4106.8 samples/s | 64.2 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step39200.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=365.3] | Loss=0.00809 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.427 | L2-Norm(final)=3.680 | 4524.8 samples/s | 70.7 steps/s
[Step=38450 Epoch=365.8] | Loss=0.00076 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.436 | L2-Norm(final)=3.685 | 3638.7 samples/s | 56.9 steps/s
[Step=38500 Epoch=366.2] | Loss=0.00038 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.438 | L2-Norm(final)=3.686 | 5559.1 samples/s | 86.9 steps/s
[Step=38550 Epoch=366.7] | Loss=0.00026 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.438 | L2-Norm(final)=3.687 | 1817.0 samples/s | 28.4 steps/s
[Step=38600 Epoch=367.2] | Loss=0.00019 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.438 | L2-Norm(final)=3.687 | 5048.1 samples/s | 78.9 steps/s
[Step=38650 Epoch=367.7] | Loss=0.00016 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.437 | L2-Norm(final)=3.687 | 1877.1 samples/s | 29.3 steps/s
[Step=38700 Epoch=368.1] | Loss=0.00013 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.436 | L2-Norm(final)=3.687 | 4885.9 samples/s | 76.3 steps/s
[Step=38750 Epoch=368.6] | Loss=0.00011 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.435 | L2-Norm(final)=3.688 | 1946.0 samples/s | 30.4 steps/s
[Step=38800 Epoch=369.1] | Loss=0.00010 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.434 | L2-Norm(final)=3.688 | 4428.4 samples/s | 69.2 steps/s
[Step=38850 Epoch=369.6] | Loss=0.00009 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.432 | L2-Norm(final)=3.688 | 1366.1 samples/s | 21.3 steps/s
[Step=38900 Epoch=370.0] | Loss=0.00008 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.431 | L2-Norm(final)=3.688 | 3985.5 samples/s | 62.3 steps/s
[Step=38950 Epoch=370.5] | Loss=0.00007 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=3.688 | 2040.7 samples/s | 31.9 steps/s
[Step=39000 Epoch=371.0] | Loss=0.00007 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.429 | L2-Norm(final)=3.688 | 4313.0 samples/s | 67.4 steps/s
[Step=39050 Epoch=371.5] | Loss=0.00006 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.428 | L2-Norm(final)=3.688 | 2133.7 samples/s | 33.3 steps/s
[Step=39100 Epoch=371.9] | Loss=0.00006 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.426 | L2-Norm(final)=3.689 | 4263.0 samples/s | 66.6 steps/s
[Step=39150 Epoch=372.4] | Loss=0.00006 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.425 | L2-Norm(final)=3.689 | 2076.0 samples/s | 32.4 steps/s
[Step=39200 Epoch=372.9] | Loss=0.00005 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.424 | L2-Norm(final)=3.689 | 4103.6 samples/s | 64.1 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step39200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.28512 | acc=0.9009 | tpr=0.8673 | fpr=0.0263 | 3841.5 samples/s | 15.0 steps/s
Avg test loss: 0.28890, Avg test acc: 0.89847, Avg tpr: 0.86594, Avg fpr: 0.03000, total FA: 234

Testing server on iccad2012
[Step=  50] | Loss=0.37997 | acc=0.9091 | tpr=0.9159 | fpr=0.0910 | 3941.4 samples/s | 15.4 steps/s
[Step= 100] | Loss=0.39700 | acc=0.9063 | tpr=0.9382 | fpr=0.0943 | 7051.3 samples/s | 27.5 steps/s
[Step= 150] | Loss=0.40902 | acc=0.9050 | tpr=0.9395 | fpr=0.0957 | 7265.2 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.41058 | acc=0.9050 | tpr=0.9355 | fpr=0.0956 | 7729.6 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.40806 | acc=0.9050 | tpr=0.9362 | fpr=0.0955 | 7464.0 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.41236 | acc=0.9048 | tpr=0.9338 | fpr=0.0957 | 7235.9 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.41542 | acc=0.9044 | tpr=0.9330 | fpr=0.0962 | 7548.6 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.41685 | acc=0.9046 | tpr=0.9327 | fpr=0.0959 | 7324.1 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.42092 | acc=0.9041 | tpr=0.9318 | fpr=0.0964 | 7134.1 samples/s | 27.9 steps/s
[Step= 500] | Loss=0.41860 | acc=0.9043 | tpr=0.9339 | fpr=0.0963 | 7345.0 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.41633 | acc=0.9050 | tpr=0.9351 | fpr=0.0956 | 12702.2 samples/s | 49.6 steps/s
Avg test loss: 0.41562, Avg test acc: 0.90504, Avg tpr: 0.93542, Avg fpr: 0.09551, total FA: 13261

server round 49/50

clients selected: [0 1 2 3]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=191.2] | Loss=0.04581 | Reg=0.00154 | acc=0.9531 | L2-Norm=12.415 | L2-Norm(final)=3.695 | 4303.9 samples/s | 67.2 steps/s
[Step=39250 Epoch=191.4] | Loss=0.00663 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.430 | L2-Norm(final)=3.695 | 4148.8 samples/s | 64.8 steps/s
[Step=39300 Epoch=191.6] | Loss=0.00424 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.434 | L2-Norm(final)=3.695 | 4232.2 samples/s | 66.1 steps/s
[Step=39350 Epoch=191.9] | Loss=0.00368 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.435 | L2-Norm(final)=3.696 | 4111.2 samples/s | 64.2 steps/s
[Step=39400 Epoch=192.1] | Loss=0.00318 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.436 | L2-Norm(final)=3.697 | 5690.4 samples/s | 88.9 steps/s
[Step=39450 Epoch=192.4] | Loss=0.00280 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.437 | L2-Norm(final)=3.698 | 1856.8 samples/s | 29.0 steps/s
[Step=39500 Epoch=192.6] | Loss=0.00269 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.438 | L2-Norm(final)=3.699 | 4210.8 samples/s | 65.8 steps/s
[Step=39550 Epoch=192.9] | Loss=0.00257 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=3.699 | 4290.6 samples/s | 67.0 steps/s
[Step=39600 Epoch=193.1] | Loss=0.00240 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=3.700 | 5212.3 samples/s | 81.4 steps/s
[Step=39650 Epoch=193.3] | Loss=0.00235 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=3.701 | 1924.3 samples/s | 30.1 steps/s
[Step=39700 Epoch=193.6] | Loss=0.00229 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.440 | L2-Norm(final)=3.702 | 4287.4 samples/s | 67.0 steps/s
[Step=39750 Epoch=193.8] | Loss=0.00225 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.440 | L2-Norm(final)=3.702 | 4208.0 samples/s | 65.8 steps/s
[Step=39800 Epoch=194.1] | Loss=0.00216 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.440 | L2-Norm(final)=3.703 | 5012.6 samples/s | 78.3 steps/s
[Step=39850 Epoch=194.3] | Loss=0.00206 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.441 | L2-Norm(final)=3.704 | 1969.4 samples/s | 30.8 steps/s
[Step=39900 Epoch=194.6] | Loss=0.00202 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.441 | L2-Norm(final)=3.705 | 4318.4 samples/s | 67.5 steps/s
[Step=39950 Epoch=194.8] | Loss=0.00198 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.441 | L2-Norm(final)=3.705 | 4242.0 samples/s | 66.3 steps/s
[Step=40000 Epoch=195.0] | Loss=0.00196 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.441 | L2-Norm(final)=3.706 | 4642.5 samples/s | 72.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_0/client_state-step40000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=191.3] | Loss=0.08371 | Reg=0.00154 | acc=0.9219 | L2-Norm=12.415 | L2-Norm(final)=3.695 | 4256.4 samples/s | 66.5 steps/s
[Step=39250 Epoch=191.5] | Loss=0.00613 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=3.695 | 4026.7 samples/s | 62.9 steps/s
[Step=39300 Epoch=191.8] | Loss=0.00404 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.433 | L2-Norm(final)=3.696 | 4169.8 samples/s | 65.2 steps/s
[Step=39350 Epoch=192.0] | Loss=0.00347 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.435 | L2-Norm(final)=3.697 | 4245.3 samples/s | 66.3 steps/s
[Step=39400 Epoch=192.3] | Loss=0.00302 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.436 | L2-Norm(final)=3.698 | 5842.9 samples/s | 91.3 steps/s
[Step=39450 Epoch=192.5] | Loss=0.00269 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.436 | L2-Norm(final)=3.698 | 1901.4 samples/s | 29.7 steps/s
[Step=39500 Epoch=192.7] | Loss=0.00243 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.437 | L2-Norm(final)=3.699 | 4243.7 samples/s | 66.3 steps/s
[Step=39550 Epoch=193.0] | Loss=0.00225 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.438 | L2-Norm(final)=3.700 | 4205.3 samples/s | 65.7 steps/s
[Step=39600 Epoch=193.2] | Loss=0.00217 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.438 | L2-Norm(final)=3.701 | 5327.2 samples/s | 83.2 steps/s
[Step=39650 Epoch=193.5] | Loss=0.00209 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.438 | L2-Norm(final)=3.701 | 1931.2 samples/s | 30.2 steps/s
[Step=39700 Epoch=193.7] | Loss=0.00203 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=3.702 | 4293.6 samples/s | 67.1 steps/s
[Step=39750 Epoch=194.0] | Loss=0.00196 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=3.703 | 4235.8 samples/s | 66.2 steps/s
[Step=39800 Epoch=194.2] | Loss=0.00192 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=3.704 | 5127.8 samples/s | 80.1 steps/s
[Step=39850 Epoch=194.4] | Loss=0.00186 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.439 | L2-Norm(final)=3.704 | 1952.4 samples/s | 30.5 steps/s
[Step=39900 Epoch=194.7] | Loss=0.00181 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.440 | L2-Norm(final)=3.705 | 4267.3 samples/s | 66.7 steps/s
[Step=39950 Epoch=194.9] | Loss=0.00177 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.440 | L2-Norm(final)=3.706 | 4181.9 samples/s | 65.3 steps/s
[Step=40000 Epoch=195.2] | Loss=0.00177 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.440 | L2-Norm(final)=3.706 | 4796.0 samples/s | 74.9 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_1/client_state-step40000.h5

Train client 2: client_asml1_2
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=371.5] | Loss=0.01132 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.415 | L2-Norm(final)=3.695 | 4033.0 samples/s | 63.0 steps/s
[Step=39250 Epoch=371.9] | Loss=0.00122 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.421 | L2-Norm(final)=3.699 | 3953.7 samples/s | 61.8 steps/s
[Step=39300 Epoch=372.4] | Loss=0.00061 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.423 | L2-Norm(final)=3.701 | 5489.0 samples/s | 85.8 steps/s
[Step=39350 Epoch=372.9] | Loss=0.00041 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.422 | L2-Norm(final)=3.701 | 1838.0 samples/s | 28.7 steps/s
[Step=39400 Epoch=373.3] | Loss=0.00031 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.421 | L2-Norm(final)=3.701 | 5051.2 samples/s | 78.9 steps/s
[Step=39450 Epoch=373.8] | Loss=0.00025 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.420 | L2-Norm(final)=3.701 | 1865.2 samples/s | 29.1 steps/s
[Step=39500 Epoch=374.3] | Loss=0.00021 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=3.702 | 4916.8 samples/s | 76.8 steps/s
[Step=39550 Epoch=374.8] | Loss=0.00018 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.418 | L2-Norm(final)=3.702 | 1911.3 samples/s | 29.9 steps/s
[Step=39600 Epoch=375.2] | Loss=0.00016 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.417 | L2-Norm(final)=3.702 | 4369.6 samples/s | 68.3 steps/s
[Step=39650 Epoch=375.7] | Loss=0.00014 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=3.702 | 1979.9 samples/s | 30.9 steps/s
[Step=39700 Epoch=376.2] | Loss=0.00013 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.414 | L2-Norm(final)=3.702 | 4046.0 samples/s | 63.2 steps/s
[Step=39750 Epoch=376.7] | Loss=0.00011 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.413 | L2-Norm(final)=3.703 | 2032.5 samples/s | 31.8 steps/s
[Step=39800 Epoch=377.1] | Loss=0.00011 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.412 | L2-Norm(final)=3.703 | 3918.9 samples/s | 61.2 steps/s
[Step=39850 Epoch=377.6] | Loss=0.00010 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.410 | L2-Norm(final)=3.703 | 2040.4 samples/s | 31.9 steps/s
[Step=39900 Epoch=378.1] | Loss=0.00009 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.409 | L2-Norm(final)=3.703 | 4044.5 samples/s | 63.2 steps/s
[Step=39950 Epoch=378.6] | Loss=0.00008 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.408 | L2-Norm(final)=3.703 | 2049.9 samples/s | 32.0 steps/s
[Step=40000 Epoch=379.0] | Loss=0.00008 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.406 | L2-Norm(final)=3.704 | 4125.7 samples/s | 64.5 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_2/client_state-step40000.h5

Train client 3: client_asml1_3
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=372.9] | Loss=0.04128 | Reg=0.00154 | acc=0.9531 | L2-Norm=12.415 | L2-Norm(final)=3.695 | 4273.4 samples/s | 66.8 steps/s
[Step=39250 Epoch=373.4] | Loss=0.00106 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.421 | L2-Norm(final)=3.700 | 3964.9 samples/s | 62.0 steps/s
[Step=39300 Epoch=373.8] | Loss=0.00053 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.422 | L2-Norm(final)=3.701 | 5711.5 samples/s | 89.2 steps/s
[Step=39350 Epoch=374.3] | Loss=0.00036 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.422 | L2-Norm(final)=3.701 | 1828.4 samples/s | 28.6 steps/s
[Step=39400 Epoch=374.8] | Loss=0.00027 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.421 | L2-Norm(final)=3.701 | 5095.3 samples/s | 79.6 steps/s
[Step=39450 Epoch=375.3] | Loss=0.00022 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.420 | L2-Norm(final)=3.701 | 1850.5 samples/s | 28.9 steps/s
[Step=39500 Epoch=375.7] | Loss=0.00018 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=3.702 | 4712.5 samples/s | 73.6 steps/s
[Step=39550 Epoch=376.2] | Loss=0.00015 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.418 | L2-Norm(final)=3.702 | 1918.0 samples/s | 30.0 steps/s
[Step=39600 Epoch=376.7] | Loss=0.00014 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.417 | L2-Norm(final)=3.702 | 4375.6 samples/s | 68.4 steps/s
[Step=39650 Epoch=377.2] | Loss=0.00012 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=3.702 | 1962.4 samples/s | 30.7 steps/s
[Step=39700 Epoch=377.6] | Loss=0.00011 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.414 | L2-Norm(final)=3.702 | 4215.7 samples/s | 65.9 steps/s
[Step=39750 Epoch=378.1] | Loss=0.00010 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.413 | L2-Norm(final)=3.702 | 2031.5 samples/s | 31.7 steps/s
[Step=39800 Epoch=378.6] | Loss=0.00009 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.412 | L2-Norm(final)=3.702 | 3964.3 samples/s | 61.9 steps/s
[Step=39850 Epoch=379.1] | Loss=0.00009 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.411 | L2-Norm(final)=3.703 | 2071.2 samples/s | 32.4 steps/s
[Step=39900 Epoch=379.5] | Loss=0.00008 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.409 | L2-Norm(final)=3.703 | 3956.4 samples/s | 61.8 steps/s
[Step=39950 Epoch=380.0] | Loss=0.00007 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.408 | L2-Norm(final)=3.703 | 2066.2 samples/s | 32.3 steps/s
[Step=40000 Epoch=380.5] | Loss=0.00007 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.407 | L2-Norm(final)=3.703 | 3943.9 samples/s | 61.6 steps/s
Client model saved at models/model-a2i2_froma5i5_sr1.0/client_asml1_3/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.27939 | acc=0.9023 | tpr=0.8707 | fpr=0.0290 | 3850.1 samples/s | 15.0 steps/s
Avg test loss: 0.28228, Avg test acc: 0.90015, Avg tpr: 0.86938, Avg fpr: 0.03218, total FA: 251

Testing server on iccad2012
[Step=  50] | Loss=0.38702 | acc=0.9082 | tpr=0.9159 | fpr=0.0919 | 3861.1 samples/s | 15.1 steps/s
[Step= 100] | Loss=0.40439 | acc=0.9054 | tpr=0.9382 | fpr=0.0952 | 7419.8 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.41693 | acc=0.9042 | tpr=0.9366 | fpr=0.0964 | 7008.5 samples/s | 27.4 steps/s
[Step= 200] | Loss=0.41848 | acc=0.9043 | tpr=0.9333 | fpr=0.0962 | 7101.6 samples/s | 27.7 steps/s
[Step= 250] | Loss=0.41592 | acc=0.9042 | tpr=0.9345 | fpr=0.0964 | 7286.2 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.42032 | acc=0.9039 | tpr=0.9316 | fpr=0.0966 | 7191.8 samples/s | 28.1 steps/s
[Step= 350] | Loss=0.42340 | acc=0.9035 | tpr=0.9311 | fpr=0.0970 | 7389.9 samples/s | 28.9 steps/s
[Step= 400] | Loss=0.42494 | acc=0.9038 | tpr=0.9316 | fpr=0.0967 | 6945.0 samples/s | 27.1 steps/s
[Step= 450] | Loss=0.42903 | acc=0.9033 | tpr=0.9309 | fpr=0.0972 | 6880.8 samples/s | 26.9 steps/s
[Step= 500] | Loss=0.42661 | acc=0.9033 | tpr=0.9330 | fpr=0.0972 | 7344.5 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.42432 | acc=0.9040 | tpr=0.9343 | fpr=0.0965 | 13047.5 samples/s | 51.0 steps/s
Avg test loss: 0.42357, Avg test acc: 0.90412, Avg tpr: 0.93463, Avg fpr: 0.09644, total FA: 13390
