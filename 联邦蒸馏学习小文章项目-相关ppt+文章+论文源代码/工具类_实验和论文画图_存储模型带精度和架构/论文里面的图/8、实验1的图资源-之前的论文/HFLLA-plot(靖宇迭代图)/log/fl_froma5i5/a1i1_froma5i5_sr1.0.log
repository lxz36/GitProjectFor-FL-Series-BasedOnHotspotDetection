#clients of iccad2012: 1
#clients of asml1: 1
select ratio: 1.0
Total num clients: 10
client model path: ['models/model-a1i1_froma5i5_sr1.0/client_asml1_0', 'models/model-a1i1_froma5i5_sr1.0/client_asml1_1', 'models/model-a1i1_froma5i5_sr1.0/client_asml1_2', 'models/model-a1i1_froma5i5_sr1.0/client_asml1_3', 'models/model-a1i1_froma5i5_sr1.0/client_asml1_4', 'models/model-a1i1_froma5i5_sr1.0/client_iccad2012_0', 'models/model-a1i1_froma5i5_sr1.0/client_iccad2012_1', 'models/model-a1i1_froma5i5_sr1.0/client_iccad2012_2', 'models/model-a1i1_froma5i5_sr1.0/client_iccad2012_3', 'models/model-a1i1_froma5i5_sr1.0/client_iccad2012_4']
client benchmark path: {'asml1': './benchmarks/asml1_train', 'asml2': './benchmarks/asml2_train', 'asml3': './benchmarks/asml3_train', 'asml4': './benchmarks/asml4_train', 'iccad2012': './benchmarks/iccad2012_train'}
loading data into the main memory...
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13125, 144, 32)
Using transform option: train
#pos = 6841, #neg = 6284
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13116, 144, 32)
Using transform option: train
#pos = 6850, #neg = 6266
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13135, 144, 32)
Using transform option: train
#pos = 6831, #neg = 6304
Allocated dataset with size (9983, 144, 32)
Resampled dataset to size (13124, 144, 32)
Using transform option: train
#pos = 6842, #neg = 6282
Allocated dataset with size (9984, 144, 32)
Resampled dataset to size (13051, 144, 32)
Using transform option: train
#pos = 6917, #neg = 6134
loading data into the main memory...
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6754, 144, 32)
Using transform option: train
#pos = 3332, #neg = 3422
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6728, 144, 32)
Using transform option: train
#pos = 3304, #neg = 3424
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6702, 144, 32)
Using transform option: train
#pos = 3276, #neg = 3426
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6792, 144, 32)
Using transform option: train
#pos = 3393, #neg = 3399
Allocated dataset with size (3660, 144, 32)
Resampled dataset to size (6715, 144, 32)
Using transform option: train
#pos = 3290, #neg = 3425
loading data into the main memory...
Allocated dataset with size (24958, 144, 32)
Using transform option: test
#pos = 17157, #neg = 7801
loading data into the main memory...
Allocated dataset with size (141372, 144, 32)
Using transform option: test
#pos = 2524, #neg = 138848
Using device: cuda

server round 0/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.34518 | Reg=0.00357 | acc=0.5469 | L2-Norm=18.897 | L2-Norm(final)=2.010 | 2622.1 samples/s | 41.0 steps/s
[Step=  50 Epoch= 0.2] | Loss=0.28076 | Reg=0.00350 | acc=0.7500 | L2-Norm=18.716 | L2-Norm(final)=2.010 | 4341.9 samples/s | 67.8 steps/s
[Step= 100 Epoch= 0.5] | Loss=0.24455 | Reg=0.00348 | acc=0.7500 | L2-Norm=18.662 | L2-Norm(final)=2.022 | 4531.1 samples/s | 70.8 steps/s
[Step= 150 Epoch= 0.7] | Loss=0.21714 | Reg=0.00347 | acc=0.8281 | L2-Norm=18.623 | L2-Norm(final)=2.030 | 4581.7 samples/s | 71.6 steps/s
[Step= 200 Epoch= 1.0] | Loss=0.19915 | Reg=0.00346 | acc=0.7656 | L2-Norm=18.592 | L2-Norm(final)=2.035 | 6116.3 samples/s | 95.6 steps/s
[Step= 250 Epoch= 1.2] | Loss=0.18062 | Reg=0.00345 | acc=0.9219 | L2-Norm=18.573 | L2-Norm(final)=2.042 | 2081.5 samples/s | 32.5 steps/s
[Step= 300 Epoch= 1.5] | Loss=0.16923 | Reg=0.00344 | acc=0.8906 | L2-Norm=18.560 | L2-Norm(final)=2.048 | 4590.6 samples/s | 71.7 steps/s
[Step= 350 Epoch= 1.7] | Loss=0.15813 | Reg=0.00344 | acc=0.9219 | L2-Norm=18.549 | L2-Norm(final)=2.055 | 4598.6 samples/s | 71.9 steps/s
[Step= 400 Epoch= 2.0] | Loss=0.14893 | Reg=0.00344 | acc=0.9531 | L2-Norm=18.541 | L2-Norm(final)=2.061 | 5601.7 samples/s | 87.5 steps/s
[Step= 450 Epoch= 2.2] | Loss=0.13900 | Reg=0.00344 | acc=0.9688 | L2-Norm=18.534 | L2-Norm(final)=2.069 | 2147.4 samples/s | 33.6 steps/s
[Step= 500 Epoch= 2.4] | Loss=0.13079 | Reg=0.00343 | acc=0.9844 | L2-Norm=18.530 | L2-Norm(final)=2.077 | 4510.0 samples/s | 70.5 steps/s
[Step= 550 Epoch= 2.7] | Loss=0.12447 | Reg=0.00343 | acc=0.9375 | L2-Norm=18.527 | L2-Norm(final)=2.085 | 4509.9 samples/s | 70.5 steps/s
[Step= 600 Epoch= 2.9] | Loss=0.11878 | Reg=0.00343 | acc=0.9375 | L2-Norm=18.523 | L2-Norm(final)=2.092 | 5288.5 samples/s | 82.6 steps/s
[Step= 650 Epoch= 3.2] | Loss=0.11257 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.520 | L2-Norm(final)=2.099 | 2213.0 samples/s | 34.6 steps/s
[Step= 700 Epoch= 3.4] | Loss=0.10736 | Reg=0.00343 | acc=0.9688 | L2-Norm=18.518 | L2-Norm(final)=2.107 | 4614.9 samples/s | 72.1 steps/s
[Step= 750 Epoch= 3.7] | Loss=0.10266 | Reg=0.00343 | acc=0.9844 | L2-Norm=18.516 | L2-Norm(final)=2.115 | 4522.7 samples/s | 70.7 steps/s
[Step= 800 Epoch= 3.9] | Loss=0.09870 | Reg=0.00343 | acc=0.9688 | L2-Norm=18.514 | L2-Norm(final)=2.122 | 4830.5 samples/s | 75.5 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=   1 Epoch= 0.0] | Loss=0.38054 | Reg=0.00357 | acc=0.3906 | L2-Norm=18.897 | L2-Norm(final)=2.009 | 4907.8 samples/s | 76.7 steps/s
[Step=  50 Epoch= 0.5] | Loss=0.16583 | Reg=0.00351 | acc=1.0000 | L2-Norm=18.728 | L2-Norm(final)=2.014 | 3900.1 samples/s | 60.9 steps/s
[Step= 100 Epoch= 0.9] | Loss=0.09457 | Reg=0.00349 | acc=1.0000 | L2-Norm=18.670 | L2-Norm(final)=2.032 | 5955.4 samples/s | 93.1 steps/s
[Step= 150 Epoch= 1.4] | Loss=0.06464 | Reg=0.00346 | acc=0.9844 | L2-Norm=18.601 | L2-Norm(final)=2.044 | 1979.1 samples/s | 30.9 steps/s
[Step= 200 Epoch= 1.9] | Loss=0.04991 | Reg=0.00343 | acc=1.0000 | L2-Norm=18.531 | L2-Norm(final)=2.053 | 5399.5 samples/s | 84.4 steps/s
[Step= 250 Epoch= 2.4] | Loss=0.04041 | Reg=0.00341 | acc=1.0000 | L2-Norm=18.462 | L2-Norm(final)=2.060 | 2065.1 samples/s | 32.3 steps/s
[Step= 300 Epoch= 2.8] | Loss=0.03372 | Reg=0.00338 | acc=1.0000 | L2-Norm=18.393 | L2-Norm(final)=2.067 | 4935.9 samples/s | 77.1 steps/s
[Step= 350 Epoch= 3.3] | Loss=0.02892 | Reg=0.00336 | acc=1.0000 | L2-Norm=18.321 | L2-Norm(final)=2.072 | 2119.6 samples/s | 33.1 steps/s
[Step= 400 Epoch= 3.8] | Loss=0.02531 | Reg=0.00333 | acc=1.0000 | L2-Norm=18.249 | L2-Norm(final)=2.076 | 4590.5 samples/s | 71.7 steps/s
[Step= 450 Epoch= 4.3] | Loss=0.02251 | Reg=0.00331 | acc=1.0000 | L2-Norm=18.177 | L2-Norm(final)=2.080 | 2182.8 samples/s | 34.1 steps/s
[Step= 500 Epoch= 4.7] | Loss=0.02026 | Reg=0.00328 | acc=1.0000 | L2-Norm=18.105 | L2-Norm(final)=2.083 | 4446.5 samples/s | 69.5 steps/s
[Step= 550 Epoch= 5.2] | Loss=0.01842 | Reg=0.00325 | acc=1.0000 | L2-Norm=18.034 | L2-Norm(final)=2.085 | 2237.8 samples/s | 35.0 steps/s
[Step= 600 Epoch= 5.7] | Loss=0.01689 | Reg=0.00323 | acc=1.0000 | L2-Norm=17.963 | L2-Norm(final)=2.088 | 4014.5 samples/s | 62.7 steps/s
[Step= 650 Epoch= 6.2] | Loss=0.01559 | Reg=0.00320 | acc=1.0000 | L2-Norm=17.894 | L2-Norm(final)=2.090 | 2243.3 samples/s | 35.1 steps/s
[Step= 700 Epoch= 6.6] | Loss=0.01448 | Reg=0.00318 | acc=1.0000 | L2-Norm=17.825 | L2-Norm(final)=2.092 | 4360.5 samples/s | 68.1 steps/s
[Step= 750 Epoch= 7.1] | Loss=0.01351 | Reg=0.00316 | acc=1.0000 | L2-Norm=17.757 | L2-Norm(final)=2.093 | 2266.9 samples/s | 35.4 steps/s
[Step= 800 Epoch= 7.6] | Loss=0.01267 | Reg=0.00313 | acc=1.0000 | L2-Norm=17.690 | L2-Norm(final)=2.095 | 4284.0 samples/s | 66.9 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.58596 | acc=0.5193 | tpr=0.3417 | fpr=0.0951 | 4398.7 samples/s | 17.2 steps/s
Avg test loss: 0.59249, Avg test acc: 0.51491, Avg tpr: 0.33881, Avg fpr: 0.09781, total FA: 763

Testing server on iccad2012
[Step=  50] | Loss=0.10990 | acc=0.9121 | tpr=0.8009 | fpr=0.0859 | 4275.5 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.11121 | acc=0.9122 | tpr=0.7740 | fpr=0.0852 | 7656.5 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.11137 | acc=0.9123 | tpr=0.7637 | fpr=0.0850 | 7832.4 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.11120 | acc=0.9130 | tpr=0.7716 | fpr=0.0844 | 7749.5 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.11153 | acc=0.9129 | tpr=0.7738 | fpr=0.0846 | 7295.5 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.11122 | acc=0.9138 | tpr=0.7767 | fpr=0.0837 | 8080.3 samples/s | 31.6 steps/s
[Step= 350] | Loss=0.11160 | acc=0.9131 | tpr=0.7752 | fpr=0.0844 | 7268.1 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.11190 | acc=0.9129 | tpr=0.7828 | fpr=0.0847 | 7442.1 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.11210 | acc=0.9126 | tpr=0.7887 | fpr=0.0852 | 7606.3 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.11170 | acc=0.9129 | tpr=0.7925 | fpr=0.0850 | 7826.0 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.11168 | acc=0.9127 | tpr=0.7923 | fpr=0.0851 | 14739.0 samples/s | 57.6 steps/s
Avg test loss: 0.11169, Avg test acc: 0.91275, Avg tpr: 0.79120, Avg fpr: 0.08504, total FA: 11808

server round 1/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 3.9] | Loss=0.39263 | Reg=0.00287 | acc=0.6406 | L2-Norm=16.939 | L2-Norm(final)=2.153 | 5046.6 samples/s | 78.9 steps/s
[Step= 850 Epoch= 4.1] | Loss=0.13823 | Reg=0.00292 | acc=0.9062 | L2-Norm=17.073 | L2-Norm(final)=2.124 | 4255.5 samples/s | 66.5 steps/s
[Step= 900 Epoch= 4.4] | Loss=0.11152 | Reg=0.00294 | acc=0.9219 | L2-Norm=17.140 | L2-Norm(final)=2.136 | 4247.9 samples/s | 66.4 steps/s
[Step= 950 Epoch= 4.6] | Loss=0.09519 | Reg=0.00295 | acc=0.9688 | L2-Norm=17.183 | L2-Norm(final)=2.149 | 4331.2 samples/s | 67.7 steps/s
[Step=1000 Epoch= 4.9] | Loss=0.08604 | Reg=0.00296 | acc=0.9062 | L2-Norm=17.216 | L2-Norm(final)=2.160 | 6077.7 samples/s | 95.0 steps/s
[Step=1050 Epoch= 5.1] | Loss=0.07840 | Reg=0.00297 | acc=0.9375 | L2-Norm=17.242 | L2-Norm(final)=2.168 | 2067.0 samples/s | 32.3 steps/s
[Step=1100 Epoch= 5.4] | Loss=0.07211 | Reg=0.00298 | acc=1.0000 | L2-Norm=17.266 | L2-Norm(final)=2.177 | 4567.6 samples/s | 71.4 steps/s
[Step=1150 Epoch= 5.6] | Loss=0.06799 | Reg=0.00299 | acc=1.0000 | L2-Norm=17.286 | L2-Norm(final)=2.185 | 4543.1 samples/s | 71.0 steps/s
[Step=1200 Epoch= 5.9] | Loss=0.06416 | Reg=0.00299 | acc=0.9844 | L2-Norm=17.303 | L2-Norm(final)=2.193 | 5714.4 samples/s | 89.3 steps/s
[Step=1250 Epoch= 6.1] | Loss=0.05998 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.314 | L2-Norm(final)=2.199 | 2042.5 samples/s | 31.9 steps/s
[Step=1300 Epoch= 6.3] | Loss=0.05701 | Reg=0.00300 | acc=1.0000 | L2-Norm=17.323 | L2-Norm(final)=2.205 | 4395.8 samples/s | 68.7 steps/s
[Step=1350 Epoch= 6.6] | Loss=0.05476 | Reg=0.00300 | acc=0.9531 | L2-Norm=17.331 | L2-Norm(final)=2.210 | 4569.5 samples/s | 71.4 steps/s
[Step=1400 Epoch= 6.8] | Loss=0.05318 | Reg=0.00301 | acc=0.9688 | L2-Norm=17.339 | L2-Norm(final)=2.214 | 5304.9 samples/s | 82.9 steps/s
[Step=1450 Epoch= 7.1] | Loss=0.05109 | Reg=0.00301 | acc=0.9844 | L2-Norm=17.348 | L2-Norm(final)=2.219 | 2190.1 samples/s | 34.2 steps/s
[Step=1500 Epoch= 7.3] | Loss=0.04877 | Reg=0.00301 | acc=1.0000 | L2-Norm=17.358 | L2-Norm(final)=2.224 | 4564.9 samples/s | 71.3 steps/s
[Step=1550 Epoch= 7.6] | Loss=0.04775 | Reg=0.00302 | acc=0.9688 | L2-Norm=17.365 | L2-Norm(final)=2.229 | 4486.3 samples/s | 70.1 steps/s
[Step=1600 Epoch= 7.8] | Loss=0.04659 | Reg=0.00302 | acc=0.9844 | L2-Norm=17.372 | L2-Norm(final)=2.232 | 4968.2 samples/s | 77.6 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step1600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step= 801 Epoch= 7.6] | Loss=0.08614 | Reg=0.00287 | acc=0.9531 | L2-Norm=16.939 | L2-Norm(final)=2.158 | 4579.6 samples/s | 71.6 steps/s
[Step= 850 Epoch= 8.1] | Loss=0.04069 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.178 | L2-Norm(final)=2.153 | 4177.2 samples/s | 65.3 steps/s
[Step= 900 Epoch= 8.5] | Loss=0.02312 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.236 | L2-Norm(final)=2.153 | 5863.9 samples/s | 91.6 steps/s
[Step= 950 Epoch= 9.0] | Loss=0.01573 | Reg=0.00297 | acc=1.0000 | L2-Norm=17.231 | L2-Norm(final)=2.155 | 1994.4 samples/s | 31.2 steps/s
[Step=1000 Epoch= 9.5] | Loss=0.01199 | Reg=0.00296 | acc=1.0000 | L2-Norm=17.208 | L2-Norm(final)=2.158 | 5345.3 samples/s | 83.5 steps/s
[Step=1050 Epoch= 9.9] | Loss=0.00975 | Reg=0.00295 | acc=1.0000 | L2-Norm=17.179 | L2-Norm(final)=2.161 | 2046.2 samples/s | 32.0 steps/s
[Step=1100 Epoch=10.4] | Loss=0.00814 | Reg=0.00294 | acc=1.0000 | L2-Norm=17.145 | L2-Norm(final)=2.163 | 5061.6 samples/s | 79.1 steps/s
[Step=1150 Epoch=10.9] | Loss=0.00698 | Reg=0.00293 | acc=1.0000 | L2-Norm=17.107 | L2-Norm(final)=2.165 | 2073.9 samples/s | 32.4 steps/s
[Step=1200 Epoch=11.4] | Loss=0.00611 | Reg=0.00291 | acc=1.0000 | L2-Norm=17.067 | L2-Norm(final)=2.167 | 4740.4 samples/s | 74.1 steps/s
[Step=1250 Epoch=11.8] | Loss=0.00543 | Reg=0.00290 | acc=1.0000 | L2-Norm=17.025 | L2-Norm(final)=2.168 | 2161.7 samples/s | 33.8 steps/s
[Step=1300 Epoch=12.3] | Loss=0.00489 | Reg=0.00288 | acc=1.0000 | L2-Norm=16.983 | L2-Norm(final)=2.169 | 4422.0 samples/s | 69.1 steps/s
[Step=1350 Epoch=12.8] | Loss=0.00445 | Reg=0.00287 | acc=1.0000 | L2-Norm=16.939 | L2-Norm(final)=2.170 | 2202.6 samples/s | 34.4 steps/s
[Step=1400 Epoch=13.3] | Loss=0.00408 | Reg=0.00286 | acc=1.0000 | L2-Norm=16.895 | L2-Norm(final)=2.171 | 4251.8 samples/s | 66.4 steps/s
[Step=1450 Epoch=13.7] | Loss=0.00377 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.852 | L2-Norm(final)=2.172 | 2167.2 samples/s | 33.9 steps/s
[Step=1500 Epoch=14.2] | Loss=0.00350 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.807 | L2-Norm(final)=2.173 | 4397.1 samples/s | 68.7 steps/s
[Step=1550 Epoch=14.7] | Loss=0.00327 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.763 | L2-Norm(final)=2.174 | 2242.8 samples/s | 35.0 steps/s
[Step=1600 Epoch=15.2] | Loss=0.00306 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.719 | L2-Norm(final)=2.175 | 4344.6 samples/s | 67.9 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step1600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.64148 | acc=0.5457 | tpr=0.3749 | fpr=0.0835 | 4168.9 samples/s | 16.3 steps/s
Avg test loss: 0.64461, Avg test acc: 0.54640, Avg tpr: 0.37722, Avg fpr: 0.08153, total FA: 636

Testing server on iccad2012
[Step=  50] | Loss=0.11532 | acc=0.9243 | tpr=0.9115 | fpr=0.0755 | 4138.6 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.11721 | acc=0.9224 | tpr=0.9168 | fpr=0.0775 | 7643.0 samples/s | 29.9 steps/s
[Step= 150] | Loss=0.11737 | acc=0.9209 | tpr=0.9150 | fpr=0.0790 | 7736.8 samples/s | 30.2 steps/s
[Step= 200] | Loss=0.11820 | acc=0.9203 | tpr=0.9115 | fpr=0.0796 | 7704.2 samples/s | 30.1 steps/s
[Step= 250] | Loss=0.11793 | acc=0.9209 | tpr=0.9109 | fpr=0.0790 | 6965.2 samples/s | 27.2 steps/s
[Step= 300] | Loss=0.11740 | acc=0.9215 | tpr=0.9091 | fpr=0.0783 | 7818.1 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.11787 | acc=0.9210 | tpr=0.9086 | fpr=0.0788 | 7648.5 samples/s | 29.9 steps/s
[Step= 400] | Loss=0.11807 | acc=0.9206 | tpr=0.9092 | fpr=0.0792 | 7697.6 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.11873 | acc=0.9203 | tpr=0.9119 | fpr=0.0796 | 7689.8 samples/s | 30.0 steps/s
[Step= 500] | Loss=0.11875 | acc=0.9200 | tpr=0.9128 | fpr=0.0799 | 7840.8 samples/s | 30.6 steps/s
[Step= 550] | Loss=0.11855 | acc=0.9200 | tpr=0.9129 | fpr=0.0798 | 14548.2 samples/s | 56.8 steps/s
Avg test loss: 0.11850, Avg test acc: 0.92008, Avg tpr: 0.91284, Avg fpr: 0.07979, total FA: 11078

server round 2/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch= 7.8] | Loss=0.43295 | Reg=0.00267 | acc=0.7188 | L2-Norm=16.336 | L2-Norm(final)=2.220 | 4886.7 samples/s | 76.4 steps/s
[Step=1650 Epoch= 8.0] | Loss=0.13446 | Reg=0.00272 | acc=0.9844 | L2-Norm=16.490 | L2-Norm(final)=2.186 | 4534.2 samples/s | 70.8 steps/s
[Step=1700 Epoch= 8.3] | Loss=0.09192 | Reg=0.00274 | acc=0.9688 | L2-Norm=16.567 | L2-Norm(final)=2.200 | 4572.0 samples/s | 71.4 steps/s
[Step=1750 Epoch= 8.5] | Loss=0.07795 | Reg=0.00276 | acc=0.9375 | L2-Norm=16.609 | L2-Norm(final)=2.212 | 4567.3 samples/s | 71.4 steps/s
[Step=1800 Epoch= 8.8] | Loss=0.06881 | Reg=0.00277 | acc=0.9688 | L2-Norm=16.642 | L2-Norm(final)=2.222 | 6109.2 samples/s | 95.5 steps/s
[Step=1850 Epoch= 9.0] | Loss=0.06132 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.670 | L2-Norm(final)=2.232 | 2026.3 samples/s | 31.7 steps/s
[Step=1900 Epoch= 9.3] | Loss=0.05620 | Reg=0.00279 | acc=0.9688 | L2-Norm=16.690 | L2-Norm(final)=2.239 | 4526.5 samples/s | 70.7 steps/s
[Step=1950 Epoch= 9.5] | Loss=0.05212 | Reg=0.00279 | acc=0.9844 | L2-Norm=16.707 | L2-Norm(final)=2.245 | 4593.3 samples/s | 71.8 steps/s
[Step=2000 Epoch= 9.8] | Loss=0.05000 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.721 | L2-Norm(final)=2.251 | 5573.3 samples/s | 87.1 steps/s
[Step=2050 Epoch=10.0] | Loss=0.04688 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.733 | L2-Norm(final)=2.256 | 2133.6 samples/s | 33.3 steps/s
[Step=2100 Epoch=10.2] | Loss=0.04426 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.744 | L2-Norm(final)=2.261 | 4535.7 samples/s | 70.9 steps/s
[Step=2150 Epoch=10.5] | Loss=0.04284 | Reg=0.00281 | acc=0.9844 | L2-Norm=16.752 | L2-Norm(final)=2.264 | 4530.0 samples/s | 70.8 steps/s
[Step=2200 Epoch=10.7] | Loss=0.04100 | Reg=0.00281 | acc=0.9844 | L2-Norm=16.759 | L2-Norm(final)=2.268 | 5158.3 samples/s | 80.6 steps/s
[Step=2250 Epoch=11.0] | Loss=0.03951 | Reg=0.00281 | acc=0.9844 | L2-Norm=16.765 | L2-Norm(final)=2.271 | 2151.2 samples/s | 33.6 steps/s
[Step=2300 Epoch=11.2] | Loss=0.03837 | Reg=0.00281 | acc=0.9844 | L2-Norm=16.771 | L2-Norm(final)=2.274 | 4550.8 samples/s | 71.1 steps/s
[Step=2350 Epoch=11.5] | Loss=0.03753 | Reg=0.00281 | acc=0.9844 | L2-Norm=16.776 | L2-Norm(final)=2.277 | 4570.8 samples/s | 71.4 steps/s
[Step=2400 Epoch=11.7] | Loss=0.03626 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.781 | L2-Norm(final)=2.279 | 4990.5 samples/s | 78.0 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step2400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=1601 Epoch=15.2] | Loss=0.07110 | Reg=0.00267 | acc=0.9375 | L2-Norm=16.336 | L2-Norm(final)=2.221 | 4741.9 samples/s | 74.1 steps/s
[Step=1650 Epoch=15.6] | Loss=0.05616 | Reg=0.00274 | acc=0.9531 | L2-Norm=16.557 | L2-Norm(final)=2.209 | 3990.9 samples/s | 62.4 steps/s
[Step=1700 Epoch=16.1] | Loss=0.03345 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.785 | L2-Norm(final)=2.186 | 6022.6 samples/s | 94.1 steps/s
[Step=1750 Epoch=16.6] | Loss=0.02242 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.859 | L2-Norm(final)=2.181 | 1974.2 samples/s | 30.8 steps/s
[Step=1800 Epoch=17.1] | Loss=0.01690 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.878 | L2-Norm(final)=2.180 | 5444.9 samples/s | 85.1 steps/s
[Step=1850 Epoch=17.5] | Loss=0.01354 | Reg=0.00285 | acc=1.0000 | L2-Norm=16.874 | L2-Norm(final)=2.181 | 2033.1 samples/s | 31.8 steps/s
[Step=1900 Epoch=18.0] | Loss=0.01130 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.859 | L2-Norm(final)=2.181 | 5000.5 samples/s | 78.1 steps/s
[Step=1950 Epoch=18.5] | Loss=0.00969 | Reg=0.00284 | acc=1.0000 | L2-Norm=16.837 | L2-Norm(final)=2.182 | 2113.4 samples/s | 33.0 steps/s
[Step=2000 Epoch=19.0] | Loss=0.00848 | Reg=0.00283 | acc=1.0000 | L2-Norm=16.811 | L2-Norm(final)=2.183 | 4701.7 samples/s | 73.5 steps/s
[Step=2050 Epoch=19.4] | Loss=0.00754 | Reg=0.00282 | acc=1.0000 | L2-Norm=16.782 | L2-Norm(final)=2.184 | 2160.3 samples/s | 33.8 steps/s
[Step=2100 Epoch=19.9] | Loss=0.00679 | Reg=0.00281 | acc=1.0000 | L2-Norm=16.751 | L2-Norm(final)=2.185 | 4449.8 samples/s | 69.5 steps/s
[Step=2150 Epoch=20.4] | Loss=0.00618 | Reg=0.00280 | acc=1.0000 | L2-Norm=16.719 | L2-Norm(final)=2.186 | 2228.2 samples/s | 34.8 steps/s
[Step=2200 Epoch=20.8] | Loss=0.00566 | Reg=0.00278 | acc=1.0000 | L2-Norm=16.687 | L2-Norm(final)=2.187 | 4434.1 samples/s | 69.3 steps/s
[Step=2250 Epoch=21.3] | Loss=0.00523 | Reg=0.00277 | acc=1.0000 | L2-Norm=16.654 | L2-Norm(final)=2.189 | 2205.4 samples/s | 34.5 steps/s
[Step=2300 Epoch=21.8] | Loss=0.00486 | Reg=0.00276 | acc=1.0000 | L2-Norm=16.620 | L2-Norm(final)=2.192 | 4221.6 samples/s | 66.0 steps/s
[Step=2350 Epoch=22.3] | Loss=0.00453 | Reg=0.00275 | acc=1.0000 | L2-Norm=16.587 | L2-Norm(final)=2.197 | 2244.3 samples/s | 35.1 steps/s
[Step=2400 Epoch=22.7] | Loss=0.00425 | Reg=0.00274 | acc=1.0000 | L2-Norm=16.553 | L2-Norm(final)=2.202 | 4200.9 samples/s | 65.6 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step2400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.66832 | acc=0.5323 | tpr=0.3542 | fpr=0.0808 | 4388.2 samples/s | 17.1 steps/s
Avg test loss: 0.66731, Avg test acc: 0.53141, Avg tpr: 0.35455, Avg fpr: 0.07961, total FA: 621

Testing server on iccad2012
[Step=  50] | Loss=0.13004 | acc=0.9234 | tpr=0.9159 | fpr=0.0765 | 4281.3 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.13399 | acc=0.9220 | tpr=0.9424 | fpr=0.0784 | 7741.4 samples/s | 30.2 steps/s
[Step= 150] | Loss=0.13399 | acc=0.9220 | tpr=0.9481 | fpr=0.0784 | 7899.3 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.13508 | acc=0.9220 | tpr=0.9475 | fpr=0.0784 | 8436.9 samples/s | 33.0 steps/s
[Step= 250] | Loss=0.13449 | acc=0.9224 | tpr=0.9459 | fpr=0.0781 | 7169.8 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.13449 | acc=0.9229 | tpr=0.9418 | fpr=0.0775 | 7871.8 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.13527 | acc=0.9226 | tpr=0.9405 | fpr=0.0777 | 7818.8 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.13566 | acc=0.9222 | tpr=0.9431 | fpr=0.0782 | 7582.9 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.13694 | acc=0.9216 | tpr=0.9455 | fpr=0.0788 | 7974.4 samples/s | 31.1 steps/s
[Step= 500] | Loss=0.13685 | acc=0.9213 | tpr=0.9471 | fpr=0.0792 | 7820.2 samples/s | 30.5 steps/s
[Step= 550] | Loss=0.13667 | acc=0.9213 | tpr=0.9483 | fpr=0.0792 | 14776.1 samples/s | 57.7 steps/s
Avg test loss: 0.13665, Avg test acc: 0.92128, Avg tpr: 0.94849, Avg fpr: 0.07922, total FA: 10999

server round 3/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=11.7] | Loss=0.49312 | Reg=0.00258 | acc=0.6562 | L2-Norm=16.055 | L2-Norm(final)=2.283 | 5007.1 samples/s | 78.2 steps/s
[Step=2450 Epoch=11.9] | Loss=0.11165 | Reg=0.00261 | acc=0.9375 | L2-Norm=16.169 | L2-Norm(final)=2.250 | 4066.9 samples/s | 63.5 steps/s
[Step=2500 Epoch=12.2] | Loss=0.08150 | Reg=0.00264 | acc=0.9688 | L2-Norm=16.234 | L2-Norm(final)=2.257 | 4499.9 samples/s | 70.3 steps/s
[Step=2550 Epoch=12.4] | Loss=0.06704 | Reg=0.00265 | acc=0.9688 | L2-Norm=16.273 | L2-Norm(final)=2.263 | 4585.9 samples/s | 71.7 steps/s
[Step=2600 Epoch=12.7] | Loss=0.06099 | Reg=0.00266 | acc=0.9844 | L2-Norm=16.302 | L2-Norm(final)=2.267 | 6107.7 samples/s | 95.4 steps/s
[Step=2650 Epoch=12.9] | Loss=0.05271 | Reg=0.00266 | acc=1.0000 | L2-Norm=16.323 | L2-Norm(final)=2.271 | 2064.7 samples/s | 32.3 steps/s
[Step=2700 Epoch=13.2] | Loss=0.04697 | Reg=0.00267 | acc=0.9844 | L2-Norm=16.340 | L2-Norm(final)=2.276 | 4604.2 samples/s | 71.9 steps/s
[Step=2750 Epoch=13.4] | Loss=0.04368 | Reg=0.00267 | acc=1.0000 | L2-Norm=16.353 | L2-Norm(final)=2.281 | 4594.6 samples/s | 71.8 steps/s
[Step=2800 Epoch=13.7] | Loss=0.04113 | Reg=0.00268 | acc=0.9844 | L2-Norm=16.364 | L2-Norm(final)=2.286 | 5657.1 samples/s | 88.4 steps/s
[Step=2850 Epoch=13.9] | Loss=0.03961 | Reg=0.00268 | acc=1.0000 | L2-Norm=16.375 | L2-Norm(final)=2.289 | 2081.8 samples/s | 32.5 steps/s
[Step=2900 Epoch=14.1] | Loss=0.03729 | Reg=0.00269 | acc=0.9844 | L2-Norm=16.386 | L2-Norm(final)=2.292 | 4597.1 samples/s | 71.8 steps/s
[Step=2950 Epoch=14.4] | Loss=0.03613 | Reg=0.00269 | acc=0.9688 | L2-Norm=16.397 | L2-Norm(final)=2.295 | 4484.8 samples/s | 70.1 steps/s
[Step=3000 Epoch=14.6] | Loss=0.03550 | Reg=0.00269 | acc=1.0000 | L2-Norm=16.407 | L2-Norm(final)=2.298 | 5011.9 samples/s | 78.3 steps/s
[Step=3050 Epoch=14.9] | Loss=0.03433 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.417 | L2-Norm(final)=2.299 | 2146.8 samples/s | 33.5 steps/s
[Step=3100 Epoch=15.1] | Loss=0.03346 | Reg=0.00270 | acc=1.0000 | L2-Norm=16.426 | L2-Norm(final)=2.300 | 4532.8 samples/s | 70.8 steps/s
[Step=3150 Epoch=15.4] | Loss=0.03261 | Reg=0.00270 | acc=0.9844 | L2-Norm=16.433 | L2-Norm(final)=2.301 | 4527.5 samples/s | 70.7 steps/s
[Step=3200 Epoch=15.6] | Loss=0.03161 | Reg=0.00270 | acc=0.9688 | L2-Norm=16.442 | L2-Norm(final)=2.302 | 4958.5 samples/s | 77.5 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step3200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=2401 Epoch=22.8] | Loss=0.07044 | Reg=0.00258 | acc=0.9531 | L2-Norm=16.055 | L2-Norm(final)=2.285 | 4520.2 samples/s | 70.6 steps/s
[Step=2450 Epoch=23.2] | Loss=0.00755 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.154 | L2-Norm(final)=2.298 | 4330.6 samples/s | 67.7 steps/s
[Step=2500 Epoch=23.7] | Loss=0.00467 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.188 | L2-Norm(final)=2.309 | 5885.3 samples/s | 92.0 steps/s
[Step=2550 Epoch=24.2] | Loss=0.00464 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.206 | L2-Norm(final)=2.315 | 1957.5 samples/s | 30.6 steps/s
[Step=2600 Epoch=24.6] | Loss=0.00359 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.221 | L2-Norm(final)=2.320 | 5337.8 samples/s | 83.4 steps/s
[Step=2650 Epoch=25.1] | Loss=0.00291 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.218 | L2-Norm(final)=2.324 | 2029.1 samples/s | 31.7 steps/s
[Step=2700 Epoch=25.6] | Loss=0.00243 | Reg=0.00263 | acc=1.0000 | L2-Norm=16.204 | L2-Norm(final)=2.327 | 5001.9 samples/s | 78.2 steps/s
[Step=2750 Epoch=26.1] | Loss=0.00208 | Reg=0.00262 | acc=1.0000 | L2-Norm=16.184 | L2-Norm(final)=2.329 | 2118.9 samples/s | 33.1 steps/s
[Step=2800 Epoch=26.5] | Loss=0.00182 | Reg=0.00261 | acc=1.0000 | L2-Norm=16.159 | L2-Norm(final)=2.331 | 4708.7 samples/s | 73.6 steps/s
[Step=2850 Epoch=27.0] | Loss=0.00162 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.131 | L2-Norm(final)=2.333 | 2161.6 samples/s | 33.8 steps/s
[Step=2900 Epoch=27.5] | Loss=0.00146 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.102 | L2-Norm(final)=2.335 | 4414.7 samples/s | 69.0 steps/s
[Step=2950 Epoch=28.0] | Loss=0.00133 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.071 | L2-Norm(final)=2.336 | 2221.3 samples/s | 34.7 steps/s
[Step=3000 Epoch=28.4] | Loss=0.00122 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.040 | L2-Norm(final)=2.338 | 4217.7 samples/s | 65.9 steps/s
[Step=3050 Epoch=28.9] | Loss=0.00113 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.007 | L2-Norm(final)=2.339 | 2257.7 samples/s | 35.3 steps/s
[Step=3100 Epoch=29.4] | Loss=0.00105 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.974 | L2-Norm(final)=2.341 | 4265.5 samples/s | 66.6 steps/s
[Step=3150 Epoch=29.8] | Loss=0.00098 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.941 | L2-Norm(final)=2.343 | 2246.6 samples/s | 35.1 steps/s
[Step=3200 Epoch=30.3] | Loss=0.00092 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.908 | L2-Norm(final)=2.345 | 4317.4 samples/s | 67.5 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step3200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.42565 | acc=0.7191 | tpr=0.6111 | fpr=0.0463 | 4253.2 samples/s | 16.6 steps/s
Avg test loss: 0.42699, Avg test acc: 0.71753, Avg tpr: 0.61089, Avg fpr: 0.04794, total FA: 374

Testing server on iccad2012
[Step=  50] | Loss=0.19857 | acc=0.8791 | tpr=0.8894 | fpr=0.1210 | 4151.4 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.20499 | acc=0.8763 | tpr=0.9062 | fpr=0.1243 | 7911.7 samples/s | 30.9 steps/s
[Step= 150] | Loss=0.20582 | acc=0.8761 | tpr=0.9006 | fpr=0.1244 | 7843.3 samples/s | 30.6 steps/s
[Step= 200] | Loss=0.20686 | acc=0.8761 | tpr=0.8995 | fpr=0.1243 | 7669.9 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.20579 | acc=0.8762 | tpr=0.9004 | fpr=0.1242 | 7575.0 samples/s | 29.6 steps/s
[Step= 300] | Loss=0.20588 | acc=0.8768 | tpr=0.8967 | fpr=0.1236 | 7763.2 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.20658 | acc=0.8766 | tpr=0.8986 | fpr=0.1238 | 7427.6 samples/s | 29.0 steps/s
[Step= 400] | Loss=0.20660 | acc=0.8763 | tpr=0.9037 | fpr=0.1242 | 7599.0 samples/s | 29.7 steps/s
[Step= 450] | Loss=0.20804 | acc=0.8758 | tpr=0.9065 | fpr=0.1248 | 7709.3 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.20782 | acc=0.8761 | tpr=0.9084 | fpr=0.1245 | 7463.1 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.20772 | acc=0.8763 | tpr=0.9093 | fpr=0.1243 | 14016.2 samples/s | 54.8 steps/s
Avg test loss: 0.20767, Avg test acc: 0.87627, Avg tpr: 0.90927, Avg fpr: 0.12433, total FA: 17263

server round 4/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=15.6] | Loss=0.22680 | Reg=0.00246 | acc=0.8438 | L2-Norm=15.700 | L2-Norm(final)=2.343 | 4931.4 samples/s | 77.1 steps/s
[Step=3250 Epoch=15.8] | Loss=0.06047 | Reg=0.00249 | acc=0.9688 | L2-Norm=15.782 | L2-Norm(final)=2.333 | 4417.2 samples/s | 69.0 steps/s
[Step=3300 Epoch=16.1] | Loss=0.04701 | Reg=0.00251 | acc=0.9688 | L2-Norm=15.845 | L2-Norm(final)=2.338 | 4600.1 samples/s | 71.9 steps/s
[Step=3350 Epoch=16.3] | Loss=0.04112 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.883 | L2-Norm(final)=2.340 | 4582.0 samples/s | 71.6 steps/s
[Step=3400 Epoch=16.6] | Loss=0.03743 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.911 | L2-Norm(final)=2.341 | 6080.9 samples/s | 95.0 steps/s
[Step=3450 Epoch=16.8] | Loss=0.03386 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.930 | L2-Norm(final)=2.343 | 2047.4 samples/s | 32.0 steps/s
[Step=3500 Epoch=17.1] | Loss=0.03188 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.948 | L2-Norm(final)=2.345 | 4569.4 samples/s | 71.4 steps/s
[Step=3550 Epoch=17.3] | Loss=0.03017 | Reg=0.00255 | acc=0.9688 | L2-Norm=15.961 | L2-Norm(final)=2.347 | 4491.9 samples/s | 70.2 steps/s
[Step=3600 Epoch=17.6] | Loss=0.02920 | Reg=0.00255 | acc=0.9844 | L2-Norm=15.971 | L2-Norm(final)=2.348 | 5609.6 samples/s | 87.7 steps/s
[Step=3650 Epoch=17.8] | Loss=0.02778 | Reg=0.00255 | acc=0.9844 | L2-Norm=15.981 | L2-Norm(final)=2.349 | 2115.5 samples/s | 33.1 steps/s
[Step=3700 Epoch=18.0] | Loss=0.02690 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.991 | L2-Norm(final)=2.350 | 4525.1 samples/s | 70.7 steps/s
[Step=3750 Epoch=18.3] | Loss=0.02590 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.000 | L2-Norm(final)=2.351 | 4521.9 samples/s | 70.7 steps/s
[Step=3800 Epoch=18.5] | Loss=0.02507 | Reg=0.00256 | acc=0.9844 | L2-Norm=16.007 | L2-Norm(final)=2.351 | 5191.9 samples/s | 81.1 steps/s
[Step=3850 Epoch=18.8] | Loss=0.02408 | Reg=0.00256 | acc=1.0000 | L2-Norm=16.013 | L2-Norm(final)=2.352 | 2178.1 samples/s | 34.0 steps/s
[Step=3900 Epoch=19.0] | Loss=0.02343 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.018 | L2-Norm(final)=2.354 | 4586.5 samples/s | 71.7 steps/s
[Step=3950 Epoch=19.3] | Loss=0.02313 | Reg=0.00257 | acc=0.9844 | L2-Norm=16.023 | L2-Norm(final)=2.355 | 4585.9 samples/s | 71.7 steps/s
[Step=4000 Epoch=19.5] | Loss=0.02269 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.029 | L2-Norm(final)=2.355 | 4927.3 samples/s | 77.0 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step4000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=3201 Epoch=30.3] | Loss=0.10941 | Reg=0.00246 | acc=0.9375 | L2-Norm=15.700 | L2-Norm(final)=2.340 | 4470.8 samples/s | 69.9 steps/s
[Step=3250 Epoch=30.8] | Loss=0.01607 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.957 | L2-Norm(final)=2.322 | 4106.1 samples/s | 64.2 steps/s
[Step=3300 Epoch=31.3] | Loss=0.01242 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.061 | L2-Norm(final)=2.307 | 5789.7 samples/s | 90.5 steps/s
[Step=3350 Epoch=31.7] | Loss=0.00962 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.101 | L2-Norm(final)=2.294 | 1993.3 samples/s | 31.1 steps/s
[Step=3400 Epoch=32.2] | Loss=0.00737 | Reg=0.00260 | acc=1.0000 | L2-Norm=16.111 | L2-Norm(final)=2.289 | 5303.4 samples/s | 82.9 steps/s
[Step=3450 Epoch=32.7] | Loss=0.00590 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.105 | L2-Norm(final)=2.287 | 2018.8 samples/s | 31.5 steps/s
[Step=3500 Epoch=33.2] | Loss=0.00492 | Reg=0.00259 | acc=1.0000 | L2-Norm=16.090 | L2-Norm(final)=2.286 | 5014.0 samples/s | 78.3 steps/s
[Step=3550 Epoch=33.6] | Loss=0.00422 | Reg=0.00258 | acc=1.0000 | L2-Norm=16.069 | L2-Norm(final)=2.286 | 2098.6 samples/s | 32.8 steps/s
[Step=3600 Epoch=34.1] | Loss=0.00370 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.044 | L2-Norm(final)=2.285 | 4723.7 samples/s | 73.8 steps/s
[Step=3650 Epoch=34.6] | Loss=0.00329 | Reg=0.00257 | acc=1.0000 | L2-Norm=16.018 | L2-Norm(final)=2.285 | 2189.4 samples/s | 34.2 steps/s
[Step=3700 Epoch=35.1] | Loss=0.00296 | Reg=0.00256 | acc=1.0000 | L2-Norm=15.989 | L2-Norm(final)=2.285 | 4345.0 samples/s | 67.9 steps/s
[Step=3750 Epoch=35.5] | Loss=0.00269 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.960 | L2-Norm(final)=2.286 | 2222.5 samples/s | 34.7 steps/s
[Step=3800 Epoch=36.0] | Loss=0.00247 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.930 | L2-Norm(final)=2.286 | 4343.7 samples/s | 67.9 steps/s
[Step=3850 Epoch=36.5] | Loss=0.00228 | Reg=0.00253 | acc=1.0000 | L2-Norm=15.900 | L2-Norm(final)=2.286 | 2223.6 samples/s | 34.7 steps/s
[Step=3900 Epoch=37.0] | Loss=0.00212 | Reg=0.00252 | acc=1.0000 | L2-Norm=15.869 | L2-Norm(final)=2.286 | 4290.7 samples/s | 67.0 steps/s
[Step=3950 Epoch=37.4] | Loss=0.00198 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.838 | L2-Norm(final)=2.286 | 2298.9 samples/s | 35.9 steps/s
[Step=4000 Epoch=37.9] | Loss=0.00185 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.807 | L2-Norm(final)=2.287 | 4360.0 samples/s | 68.1 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step4000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.71687 | acc=0.5923 | tpr=0.4243 | fpr=0.0431 | 4256.6 samples/s | 16.6 steps/s
Avg test loss: 0.71709, Avg test acc: 0.59296, Avg tpr: 0.42793, Avg fpr: 0.04410, total FA: 344

Testing server on iccad2012
[Step=  50] | Loss=0.15414 | acc=0.9237 | tpr=0.9027 | fpr=0.0759 | 4372.5 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.15942 | acc=0.9209 | tpr=0.9147 | fpr=0.0790 | 7961.6 samples/s | 31.1 steps/s
[Step= 150] | Loss=0.16055 | acc=0.9203 | tpr=0.9179 | fpr=0.0797 | 7230.5 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.16205 | acc=0.9200 | tpr=0.9180 | fpr=0.0800 | 7607.1 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.16128 | acc=0.9208 | tpr=0.9188 | fpr=0.0791 | 7745.7 samples/s | 30.3 steps/s
[Step= 300] | Loss=0.16219 | acc=0.9207 | tpr=0.9156 | fpr=0.0792 | 7600.1 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.16278 | acc=0.9201 | tpr=0.9167 | fpr=0.0799 | 7743.4 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.16298 | acc=0.9196 | tpr=0.9212 | fpr=0.0804 | 7650.9 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.16455 | acc=0.9194 | tpr=0.9241 | fpr=0.0806 | 7696.3 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.16384 | acc=0.9196 | tpr=0.9260 | fpr=0.0806 | 7777.3 samples/s | 30.4 steps/s
[Step= 550] | Loss=0.16365 | acc=0.9195 | tpr=0.9268 | fpr=0.0806 | 13490.3 samples/s | 52.7 steps/s
Avg test loss: 0.16354, Avg test acc: 0.91950, Avg tpr: 0.92710, Avg fpr: 0.08063, total FA: 11196

server round 5/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=19.5] | Loss=0.67324 | Reg=0.00237 | acc=0.6250 | L2-Norm=15.406 | L2-Norm(final)=2.322 | 4656.8 samples/s | 72.8 steps/s
[Step=4050 Epoch=19.7] | Loss=0.08972 | Reg=0.00242 | acc=0.9688 | L2-Norm=15.569 | L2-Norm(final)=2.294 | 4395.5 samples/s | 68.7 steps/s
[Step=4100 Epoch=20.0] | Loss=0.05841 | Reg=0.00245 | acc=1.0000 | L2-Norm=15.662 | L2-Norm(final)=2.311 | 4559.9 samples/s | 71.2 steps/s
[Step=4150 Epoch=20.2] | Loss=0.04913 | Reg=0.00247 | acc=1.0000 | L2-Norm=15.714 | L2-Norm(final)=2.324 | 4615.2 samples/s | 72.1 steps/s
[Step=4200 Epoch=20.5] | Loss=0.04437 | Reg=0.00248 | acc=0.9844 | L2-Norm=15.748 | L2-Norm(final)=2.329 | 6054.1 samples/s | 94.6 steps/s
[Step=4250 Epoch=20.7] | Loss=0.04021 | Reg=0.00249 | acc=0.9688 | L2-Norm=15.774 | L2-Norm(final)=2.330 | 2076.2 samples/s | 32.4 steps/s
[Step=4300 Epoch=21.0] | Loss=0.03776 | Reg=0.00249 | acc=1.0000 | L2-Norm=15.795 | L2-Norm(final)=2.330 | 4408.0 samples/s | 68.9 steps/s
[Step=4350 Epoch=21.2] | Loss=0.03498 | Reg=0.00250 | acc=1.0000 | L2-Norm=15.815 | L2-Norm(final)=2.331 | 4494.3 samples/s | 70.2 steps/s
[Step=4400 Epoch=21.5] | Loss=0.03290 | Reg=0.00251 | acc=0.9531 | L2-Norm=15.833 | L2-Norm(final)=2.333 | 5643.4 samples/s | 88.2 steps/s
[Step=4450 Epoch=21.7] | Loss=0.03432 | Reg=0.00251 | acc=1.0000 | L2-Norm=15.852 | L2-Norm(final)=2.332 | 2098.0 samples/s | 32.8 steps/s
[Step=4500 Epoch=21.9] | Loss=0.03448 | Reg=0.00252 | acc=0.9844 | L2-Norm=15.876 | L2-Norm(final)=2.328 | 4475.1 samples/s | 69.9 steps/s
[Step=4550 Epoch=22.2] | Loss=0.03375 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.898 | L2-Norm(final)=2.325 | 4538.0 samples/s | 70.9 steps/s
[Step=4600 Epoch=22.4] | Loss=0.03281 | Reg=0.00253 | acc=0.9844 | L2-Norm=15.917 | L2-Norm(final)=2.322 | 5298.2 samples/s | 82.8 steps/s
[Step=4650 Epoch=22.7] | Loss=0.03165 | Reg=0.00254 | acc=0.9688 | L2-Norm=15.934 | L2-Norm(final)=2.320 | 2188.5 samples/s | 34.2 steps/s
[Step=4700 Epoch=22.9] | Loss=0.03020 | Reg=0.00254 | acc=1.0000 | L2-Norm=15.949 | L2-Norm(final)=2.318 | 4568.3 samples/s | 71.4 steps/s
[Step=4750 Epoch=23.2] | Loss=0.02900 | Reg=0.00255 | acc=1.0000 | L2-Norm=15.962 | L2-Norm(final)=2.317 | 4528.3 samples/s | 70.8 steps/s
[Step=4800 Epoch=23.4] | Loss=0.02800 | Reg=0.00255 | acc=0.9844 | L2-Norm=15.973 | L2-Norm(final)=2.316 | 4920.6 samples/s | 76.9 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step4800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4001 Epoch=37.9] | Loss=0.02428 | Reg=0.00237 | acc=0.9688 | L2-Norm=15.406 | L2-Norm(final)=2.324 | 4398.3 samples/s | 68.7 steps/s
[Step=4050 Epoch=38.4] | Loss=0.00296 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.488 | L2-Norm(final)=2.341 | 4019.0 samples/s | 62.8 steps/s
[Step=4100 Epoch=38.9] | Loss=0.00207 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.519 | L2-Norm(final)=2.349 | 5866.0 samples/s | 91.7 steps/s
[Step=4150 Epoch=39.3] | Loss=0.00189 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.528 | L2-Norm(final)=2.353 | 1973.6 samples/s | 30.8 steps/s
[Step=4200 Epoch=39.8] | Loss=0.00181 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.532 | L2-Norm(final)=2.354 | 5438.9 samples/s | 85.0 steps/s
[Step=4250 Epoch=40.3] | Loss=0.00160 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.538 | L2-Norm(final)=2.355 | 2063.9 samples/s | 32.2 steps/s
[Step=4300 Epoch=40.7] | Loss=0.00134 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.533 | L2-Norm(final)=2.356 | 4989.0 samples/s | 78.0 steps/s
[Step=4350 Epoch=41.2] | Loss=0.00115 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.520 | L2-Norm(final)=2.358 | 2092.3 samples/s | 32.7 steps/s
[Step=4400 Epoch=41.7] | Loss=0.00101 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.501 | L2-Norm(final)=2.359 | 4680.4 samples/s | 73.1 steps/s
[Step=4450 Epoch=42.2] | Loss=0.00090 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.478 | L2-Norm(final)=2.360 | 2099.2 samples/s | 32.8 steps/s
[Step=4500 Epoch=42.6] | Loss=0.00081 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.453 | L2-Norm(final)=2.361 | 4439.6 samples/s | 69.4 steps/s
[Step=4550 Epoch=43.1] | Loss=0.00074 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.427 | L2-Norm(final)=2.362 | 2215.2 samples/s | 34.6 steps/s
[Step=4600 Epoch=43.6] | Loss=0.00068 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.399 | L2-Norm(final)=2.362 | 4426.5 samples/s | 69.2 steps/s
[Step=4650 Epoch=44.1] | Loss=0.00062 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.370 | L2-Norm(final)=2.363 | 2249.1 samples/s | 35.1 steps/s
[Step=4700 Epoch=44.5] | Loss=0.00058 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.340 | L2-Norm(final)=2.364 | 4380.3 samples/s | 68.4 steps/s
[Step=4750 Epoch=45.0] | Loss=0.00054 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.309 | L2-Norm(final)=2.364 | 2252.5 samples/s | 35.2 steps/s
[Step=4800 Epoch=45.5] | Loss=0.00051 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.278 | L2-Norm(final)=2.365 | 4298.1 samples/s | 67.2 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step4800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.40649 | acc=0.7542 | tpr=0.6658 | fpr=0.0538 | 4041.0 samples/s | 15.8 steps/s
Avg test loss: 0.41219, Avg test acc: 0.75475, Avg tpr: 0.66777, Avg fpr: 0.05397, total FA: 421

Testing server on iccad2012
[Step=  50] | Loss=0.30943 | acc=0.8334 | tpr=0.8982 | fpr=0.1678 | 4044.0 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.31705 | acc=0.8309 | tpr=0.9083 | fpr=0.1706 | 7539.8 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.31765 | acc=0.8308 | tpr=0.9049 | fpr=0.1706 | 7286.3 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.31878 | acc=0.8306 | tpr=0.9115 | fpr=0.1709 | 7722.7 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.31695 | acc=0.8308 | tpr=0.9100 | fpr=0.1707 | 8015.5 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.31675 | acc=0.8315 | tpr=0.9084 | fpr=0.1699 | 7397.3 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.31741 | acc=0.8309 | tpr=0.9105 | fpr=0.1705 | 7680.6 samples/s | 30.0 steps/s
[Step= 400] | Loss=0.31739 | acc=0.8308 | tpr=0.9163 | fpr=0.1708 | 7808.0 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.31823 | acc=0.8309 | tpr=0.9197 | fpr=0.1707 | 7477.6 samples/s | 29.2 steps/s
[Step= 500] | Loss=0.31780 | acc=0.8309 | tpr=0.9207 | fpr=0.1707 | 7574.8 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.31798 | acc=0.8310 | tpr=0.9200 | fpr=0.1706 | 13931.3 samples/s | 54.4 steps/s
Avg test loss: 0.31775, Avg test acc: 0.83101, Avg tpr: 0.92036, Avg fpr: 0.17061, total FA: 23689

server round 6/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=23.4] | Loss=0.31000 | Reg=0.00230 | acc=0.8125 | L2-Norm=15.173 | L2-Norm(final)=2.334 | 5114.2 samples/s | 79.9 steps/s
[Step=4850 Epoch=23.6] | Loss=0.04879 | Reg=0.00233 | acc=0.9844 | L2-Norm=15.278 | L2-Norm(final)=2.320 | 4129.2 samples/s | 64.5 steps/s
[Step=4900 Epoch=23.9] | Loss=0.03683 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.340 | L2-Norm(final)=2.330 | 4588.2 samples/s | 71.7 steps/s
[Step=4950 Epoch=24.1] | Loss=0.03273 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.380 | L2-Norm(final)=2.336 | 4548.5 samples/s | 71.1 steps/s
[Step=5000 Epoch=24.4] | Loss=0.02975 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.412 | L2-Norm(final)=2.337 | 6046.1 samples/s | 94.5 steps/s
[Step=5050 Epoch=24.6] | Loss=0.02731 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.439 | L2-Norm(final)=2.340 | 2028.8 samples/s | 31.7 steps/s
[Step=5100 Epoch=24.9] | Loss=0.02665 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.460 | L2-Norm(final)=2.339 | 4470.1 samples/s | 69.8 steps/s
[Step=5150 Epoch=25.1] | Loss=0.02535 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.477 | L2-Norm(final)=2.338 | 4518.6 samples/s | 70.6 steps/s
[Step=5200 Epoch=25.4] | Loss=0.02409 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.493 | L2-Norm(final)=2.338 | 5671.5 samples/s | 88.6 steps/s
[Step=5250 Epoch=25.6] | Loss=0.02385 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.506 | L2-Norm(final)=2.337 | 2119.6 samples/s | 33.1 steps/s
[Step=5300 Epoch=25.8] | Loss=0.02305 | Reg=0.00241 | acc=0.9688 | L2-Norm=15.518 | L2-Norm(final)=2.335 | 4423.7 samples/s | 69.1 steps/s
[Step=5350 Epoch=26.1] | Loss=0.02208 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.529 | L2-Norm(final)=2.335 | 4575.4 samples/s | 71.5 steps/s
[Step=5400 Epoch=26.3] | Loss=0.02177 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.541 | L2-Norm(final)=2.334 | 5297.9 samples/s | 82.8 steps/s
[Step=5450 Epoch=26.6] | Loss=0.02096 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.552 | L2-Norm(final)=2.333 | 2159.1 samples/s | 33.7 steps/s
[Step=5500 Epoch=26.8] | Loss=0.02047 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.563 | L2-Norm(final)=2.333 | 4547.2 samples/s | 71.0 steps/s
[Step=5550 Epoch=27.1] | Loss=0.01978 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.574 | L2-Norm(final)=2.333 | 4522.3 samples/s | 70.7 steps/s
[Step=5600 Epoch=27.3] | Loss=0.01939 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.584 | L2-Norm(final)=2.334 | 4951.0 samples/s | 77.4 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step5600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=4801 Epoch=45.5] | Loss=0.03368 | Reg=0.00230 | acc=0.9688 | L2-Norm=15.173 | L2-Norm(final)=2.336 | 4649.6 samples/s | 72.7 steps/s
[Step=4850 Epoch=46.0] | Loss=0.00904 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.445 | L2-Norm(final)=2.332 | 4355.2 samples/s | 68.1 steps/s
[Step=4900 Epoch=46.4] | Loss=0.00715 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.554 | L2-Norm(final)=2.324 | 5834.5 samples/s | 91.2 steps/s
[Step=4950 Epoch=46.9] | Loss=0.00544 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.612 | L2-Norm(final)=2.323 | 1971.2 samples/s | 30.8 steps/s
[Step=5000 Epoch=47.4] | Loss=0.00412 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.632 | L2-Norm(final)=2.323 | 5345.8 samples/s | 83.5 steps/s
[Step=5050 Epoch=47.9] | Loss=0.00331 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.632 | L2-Norm(final)=2.324 | 2058.1 samples/s | 32.2 steps/s
[Step=5100 Epoch=48.3] | Loss=0.00276 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.620 | L2-Norm(final)=2.325 | 5047.6 samples/s | 78.9 steps/s
[Step=5150 Epoch=48.8] | Loss=0.00236 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.601 | L2-Norm(final)=2.326 | 2129.7 samples/s | 33.3 steps/s
[Step=5200 Epoch=49.3] | Loss=0.00207 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.579 | L2-Norm(final)=2.327 | 4666.2 samples/s | 72.9 steps/s
[Step=5250 Epoch=49.7] | Loss=0.00184 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.554 | L2-Norm(final)=2.328 | 2191.1 samples/s | 34.2 steps/s
[Step=5300 Epoch=50.2] | Loss=0.00166 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.528 | L2-Norm(final)=2.329 | 4365.3 samples/s | 68.2 steps/s
[Step=5350 Epoch=50.7] | Loss=0.00151 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.500 | L2-Norm(final)=2.329 | 2269.8 samples/s | 35.5 steps/s
[Step=5400 Epoch=51.2] | Loss=0.00138 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.471 | L2-Norm(final)=2.330 | 4308.5 samples/s | 67.3 steps/s
[Step=5450 Epoch=51.6] | Loss=0.00128 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.442 | L2-Norm(final)=2.331 | 2237.3 samples/s | 35.0 steps/s
[Step=5500 Epoch=52.1] | Loss=0.00119 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.412 | L2-Norm(final)=2.331 | 4286.6 samples/s | 67.0 steps/s
[Step=5550 Epoch=52.6] | Loss=0.00111 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.381 | L2-Norm(final)=2.332 | 2271.0 samples/s | 35.5 steps/s
[Step=5600 Epoch=53.1] | Loss=0.00104 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.351 | L2-Norm(final)=2.333 | 4334.6 samples/s | 67.7 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step5600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.70745 | acc=0.6280 | tpr=0.4767 | fpr=0.0434 | 4238.8 samples/s | 16.6 steps/s
Avg test loss: 0.70968, Avg test acc: 0.62938, Avg tpr: 0.48039, Avg fpr: 0.04294, total FA: 335

Testing server on iccad2012
[Step=  50] | Loss=0.19114 | acc=0.9140 | tpr=0.8717 | fpr=0.0853 | 4143.9 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.19521 | acc=0.9121 | tpr=0.9019 | fpr=0.0877 | 7853.4 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.19416 | acc=0.9122 | tpr=0.9020 | fpr=0.0876 | 7898.6 samples/s | 30.9 steps/s
[Step= 200] | Loss=0.19567 | acc=0.9125 | tpr=0.9104 | fpr=0.0875 | 7194.7 samples/s | 28.1 steps/s
[Step= 250] | Loss=0.19392 | acc=0.9128 | tpr=0.9083 | fpr=0.0871 | 7936.4 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.19444 | acc=0.9128 | tpr=0.9033 | fpr=0.0870 | 7643.3 samples/s | 29.9 steps/s
[Step= 350] | Loss=0.19520 | acc=0.9128 | tpr=0.9067 | fpr=0.0871 | 7759.5 samples/s | 30.3 steps/s
[Step= 400] | Loss=0.19529 | acc=0.9128 | tpr=0.9108 | fpr=0.0871 | 7586.5 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.19676 | acc=0.9129 | tpr=0.9138 | fpr=0.0871 | 7853.1 samples/s | 30.7 steps/s
[Step= 500] | Loss=0.19603 | acc=0.9127 | tpr=0.9163 | fpr=0.0873 | 7498.2 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.19552 | acc=0.9129 | tpr=0.9172 | fpr=0.0872 | 13466.9 samples/s | 52.6 steps/s
Avg test loss: 0.19540, Avg test acc: 0.91287, Avg tpr: 0.91759, Avg fpr: 0.08722, total FA: 12110

server round 7/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=27.3] | Loss=0.33973 | Reg=0.00225 | acc=0.7656 | L2-Norm=14.986 | L2-Norm(final)=2.331 | 5074.6 samples/s | 79.3 steps/s
[Step=5650 Epoch=27.6] | Loss=0.07176 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.140 | L2-Norm(final)=2.297 | 4199.9 samples/s | 65.6 steps/s
[Step=5700 Epoch=27.8] | Loss=0.04842 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.229 | L2-Norm(final)=2.304 | 4544.6 samples/s | 71.0 steps/s
[Step=5750 Epoch=28.0] | Loss=0.03965 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.279 | L2-Norm(final)=2.309 | 4602.0 samples/s | 71.9 steps/s
[Step=5800 Epoch=28.3] | Loss=0.03468 | Reg=0.00234 | acc=0.9688 | L2-Norm=15.313 | L2-Norm(final)=2.315 | 6093.0 samples/s | 95.2 steps/s
[Step=5850 Epoch=28.5] | Loss=0.03630 | Reg=0.00236 | acc=0.9844 | L2-Norm=15.353 | L2-Norm(final)=2.312 | 2099.7 samples/s | 32.8 steps/s
[Step=5900 Epoch=28.8] | Loss=0.03521 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.397 | L2-Norm(final)=2.310 | 4492.1 samples/s | 70.2 steps/s
[Step=5950 Epoch=29.0] | Loss=0.03331 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.433 | L2-Norm(final)=2.309 | 4329.1 samples/s | 67.6 steps/s
[Step=6000 Epoch=29.3] | Loss=0.03213 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.466 | L2-Norm(final)=2.308 | 5583.7 samples/s | 87.2 steps/s
[Step=6050 Epoch=29.5] | Loss=0.03072 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.494 | L2-Norm(final)=2.308 | 2125.6 samples/s | 33.2 steps/s
[Step=6100 Epoch=29.7] | Loss=0.02892 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.519 | L2-Norm(final)=2.308 | 4425.1 samples/s | 69.1 steps/s
[Step=6150 Epoch=30.0] | Loss=0.02762 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.541 | L2-Norm(final)=2.308 | 4599.4 samples/s | 71.9 steps/s
[Step=6200 Epoch=30.2] | Loss=0.02616 | Reg=0.00242 | acc=0.9844 | L2-Norm=15.562 | L2-Norm(final)=2.309 | 5317.5 samples/s | 83.1 steps/s
[Step=6250 Epoch=30.5] | Loss=0.02886 | Reg=0.00243 | acc=0.9844 | L2-Norm=15.583 | L2-Norm(final)=2.307 | 2187.0 samples/s | 34.2 steps/s
[Step=6300 Epoch=30.7] | Loss=0.02892 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.611 | L2-Norm(final)=2.302 | 4592.5 samples/s | 71.8 steps/s
[Step=6350 Epoch=31.0] | Loss=0.02911 | Reg=0.00245 | acc=0.9688 | L2-Norm=15.639 | L2-Norm(final)=2.298 | 4602.8 samples/s | 71.9 steps/s
[Step=6400 Epoch=31.2] | Loss=0.02812 | Reg=0.00245 | acc=0.9844 | L2-Norm=15.666 | L2-Norm(final)=2.295 | 4937.7 samples/s | 77.2 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step6400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=5601 Epoch=53.1] | Loss=0.02090 | Reg=0.00225 | acc=0.9844 | L2-Norm=14.986 | L2-Norm(final)=2.332 | 4982.8 samples/s | 77.9 steps/s
[Step=5650 Epoch=53.5] | Loss=0.02370 | Reg=0.00230 | acc=0.9844 | L2-Norm=15.172 | L2-Norm(final)=2.304 | 3916.4 samples/s | 61.2 steps/s
[Step=5700 Epoch=54.0] | Loss=0.01406 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.440 | L2-Norm(final)=2.265 | 5894.9 samples/s | 92.1 steps/s
[Step=5750 Epoch=54.5] | Loss=0.00968 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.548 | L2-Norm(final)=2.254 | 1982.6 samples/s | 31.0 steps/s
[Step=5800 Epoch=55.0] | Loss=0.00729 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.590 | L2-Norm(final)=2.250 | 5192.6 samples/s | 81.1 steps/s
[Step=5850 Epoch=55.4] | Loss=0.00584 | Reg=0.00244 | acc=1.0000 | L2-Norm=15.603 | L2-Norm(final)=2.248 | 2011.8 samples/s | 31.4 steps/s
[Step=5900 Epoch=55.9] | Loss=0.00487 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.601 | L2-Norm(final)=2.248 | 5010.6 samples/s | 78.3 steps/s
[Step=5950 Epoch=56.4] | Loss=0.00418 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.591 | L2-Norm(final)=2.247 | 2118.7 samples/s | 33.1 steps/s
[Step=6000 Epoch=56.9] | Loss=0.00366 | Reg=0.00243 | acc=1.0000 | L2-Norm=15.575 | L2-Norm(final)=2.247 | 4729.2 samples/s | 73.9 steps/s
[Step=6050 Epoch=57.3] | Loss=0.00325 | Reg=0.00242 | acc=1.0000 | L2-Norm=15.556 | L2-Norm(final)=2.248 | 2161.4 samples/s | 33.8 steps/s
[Step=6100 Epoch=57.8] | Loss=0.00293 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.535 | L2-Norm(final)=2.248 | 4490.0 samples/s | 70.2 steps/s
[Step=6150 Epoch=58.3] | Loss=0.00266 | Reg=0.00241 | acc=1.0000 | L2-Norm=15.512 | L2-Norm(final)=2.248 | 2219.5 samples/s | 34.7 steps/s
[Step=6200 Epoch=58.8] | Loss=0.00244 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.488 | L2-Norm(final)=2.249 | 4322.4 samples/s | 67.5 steps/s
[Step=6250 Epoch=59.2] | Loss=0.00225 | Reg=0.00239 | acc=1.0000 | L2-Norm=15.463 | L2-Norm(final)=2.249 | 2203.8 samples/s | 34.4 steps/s
[Step=6300 Epoch=59.7] | Loss=0.00209 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.438 | L2-Norm(final)=2.249 | 4279.1 samples/s | 66.9 steps/s
[Step=6350 Epoch=60.2] | Loss=0.00195 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.412 | L2-Norm(final)=2.250 | 2250.0 samples/s | 35.2 steps/s
[Step=6400 Epoch=60.6] | Loss=0.00183 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.385 | L2-Norm(final)=2.250 | 4319.4 samples/s | 67.5 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step6400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.58374 | acc=0.6729 | tpr=0.5505 | fpr=0.0614 | 4230.6 samples/s | 16.5 steps/s
Avg test loss: 0.58810, Avg test acc: 0.67245, Avg tpr: 0.55144, Avg fpr: 0.06140, total FA: 479

Testing server on iccad2012
[Step=  50] | Loss=0.17736 | acc=0.9077 | tpr=0.8982 | fpr=0.0922 | 4208.8 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.18219 | acc=0.9063 | tpr=0.9168 | fpr=0.0939 | 7862.5 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.18361 | acc=0.9062 | tpr=0.9236 | fpr=0.0941 | 7684.3 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.18418 | acc=0.9059 | tpr=0.9290 | fpr=0.0945 | 7315.9 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.18261 | acc=0.9064 | tpr=0.9275 | fpr=0.0940 | 7623.4 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.18293 | acc=0.9066 | tpr=0.9229 | fpr=0.0937 | 7602.4 samples/s | 29.7 steps/s
[Step= 350] | Loss=0.18371 | acc=0.9068 | tpr=0.9255 | fpr=0.0935 | 8026.5 samples/s | 31.4 steps/s
[Step= 400] | Loss=0.18469 | acc=0.9064 | tpr=0.9278 | fpr=0.0940 | 7698.2 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.18627 | acc=0.9062 | tpr=0.9289 | fpr=0.0943 | 7747.6 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.18597 | acc=0.9059 | tpr=0.9313 | fpr=0.0945 | 7521.5 samples/s | 29.4 steps/s
[Step= 550] | Loss=0.18608 | acc=0.9061 | tpr=0.9296 | fpr=0.0944 | 14286.4 samples/s | 55.8 steps/s
Avg test loss: 0.18601, Avg test acc: 0.90609, Avg tpr: 0.92987, Avg fpr: 0.09434, total FA: 13099

server round 8/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=31.2] | Loss=0.51587 | Reg=0.00229 | acc=0.7188 | L2-Norm=15.120 | L2-Norm(final)=2.248 | 4498.5 samples/s | 70.3 steps/s
[Step=6450 Epoch=31.5] | Loss=0.05527 | Reg=0.00233 | acc=0.9688 | L2-Norm=15.260 | L2-Norm(final)=2.238 | 4470.8 samples/s | 69.9 steps/s
[Step=6500 Epoch=31.7] | Loss=0.03922 | Reg=0.00235 | acc=0.9531 | L2-Norm=15.325 | L2-Norm(final)=2.247 | 4496.7 samples/s | 70.3 steps/s
[Step=6550 Epoch=31.9] | Loss=0.03318 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.362 | L2-Norm(final)=2.256 | 4528.2 samples/s | 70.8 steps/s
[Step=6600 Epoch=32.2] | Loss=0.03077 | Reg=0.00237 | acc=0.9844 | L2-Norm=15.388 | L2-Norm(final)=2.260 | 6044.0 samples/s | 94.4 steps/s
[Step=6650 Epoch=32.4] | Loss=0.02780 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.408 | L2-Norm(final)=2.261 | 2041.8 samples/s | 31.9 steps/s
[Step=6700 Epoch=32.7] | Loss=0.02518 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.426 | L2-Norm(final)=2.264 | 4392.9 samples/s | 68.6 steps/s
[Step=6750 Epoch=32.9] | Loss=0.02386 | Reg=0.00238 | acc=1.0000 | L2-Norm=15.440 | L2-Norm(final)=2.266 | 4540.3 samples/s | 70.9 steps/s
[Step=6800 Epoch=33.2] | Loss=0.02236 | Reg=0.00239 | acc=0.9375 | L2-Norm=15.452 | L2-Norm(final)=2.267 | 5678.9 samples/s | 88.7 steps/s
[Step=6850 Epoch=33.4] | Loss=0.02130 | Reg=0.00239 | acc=0.9844 | L2-Norm=15.462 | L2-Norm(final)=2.269 | 2093.1 samples/s | 32.7 steps/s
[Step=6900 Epoch=33.6] | Loss=0.02002 | Reg=0.00239 | acc=0.9688 | L2-Norm=15.471 | L2-Norm(final)=2.270 | 4384.8 samples/s | 68.5 steps/s
[Step=6950 Epoch=33.9] | Loss=0.01905 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.477 | L2-Norm(final)=2.272 | 4594.4 samples/s | 71.8 steps/s
[Step=7000 Epoch=34.1] | Loss=0.01841 | Reg=0.00240 | acc=0.9688 | L2-Norm=15.482 | L2-Norm(final)=2.273 | 5289.8 samples/s | 82.7 steps/s
[Step=7050 Epoch=34.4] | Loss=0.01739 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.487 | L2-Norm(final)=2.274 | 2183.4 samples/s | 34.1 steps/s
[Step=7100 Epoch=34.6] | Loss=0.01679 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.490 | L2-Norm(final)=2.275 | 4551.6 samples/s | 71.1 steps/s
[Step=7150 Epoch=34.9] | Loss=0.01626 | Reg=0.00240 | acc=0.9844 | L2-Norm=15.492 | L2-Norm(final)=2.276 | 4560.4 samples/s | 71.3 steps/s
[Step=7200 Epoch=35.1] | Loss=0.01592 | Reg=0.00240 | acc=1.0000 | L2-Norm=15.494 | L2-Norm(final)=2.277 | 4840.4 samples/s | 75.6 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step7200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=6401 Epoch=60.7] | Loss=0.01052 | Reg=0.00229 | acc=0.9844 | L2-Norm=15.120 | L2-Norm(final)=2.252 | 4922.8 samples/s | 76.9 steps/s
[Step=6450 Epoch=61.1] | Loss=0.00237 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.231 | L2-Norm(final)=2.274 | 3942.1 samples/s | 61.6 steps/s
[Step=6500 Epoch=61.6] | Loss=0.00125 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.235 | L2-Norm(final)=2.284 | 5918.9 samples/s | 92.5 steps/s
[Step=6550 Epoch=62.1] | Loss=0.00084 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.216 | L2-Norm(final)=2.290 | 1971.2 samples/s | 30.8 steps/s
[Step=6600 Epoch=62.5] | Loss=0.00063 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.189 | L2-Norm(final)=2.293 | 5416.5 samples/s | 84.6 steps/s
[Step=6650 Epoch=63.0] | Loss=0.00051 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.159 | L2-Norm(final)=2.296 | 2052.7 samples/s | 32.1 steps/s
[Step=6700 Epoch=63.5] | Loss=0.00043 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.128 | L2-Norm(final)=2.298 | 5015.3 samples/s | 78.4 steps/s
[Step=6750 Epoch=64.0] | Loss=0.00037 | Reg=0.00228 | acc=1.0000 | L2-Norm=15.096 | L2-Norm(final)=2.300 | 2113.9 samples/s | 33.0 steps/s
[Step=6800 Epoch=64.4] | Loss=0.00032 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.064 | L2-Norm(final)=2.301 | 4653.9 samples/s | 72.7 steps/s
[Step=6850 Epoch=64.9] | Loss=0.00029 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.032 | L2-Norm(final)=2.302 | 2179.9 samples/s | 34.1 steps/s
[Step=6900 Epoch=65.4] | Loss=0.00026 | Reg=0.00225 | acc=1.0000 | L2-Norm=15.000 | L2-Norm(final)=2.304 | 4491.5 samples/s | 70.2 steps/s
[Step=6950 Epoch=65.9] | Loss=0.00023 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.967 | L2-Norm(final)=2.305 | 2183.9 samples/s | 34.1 steps/s
[Step=7000 Epoch=66.3] | Loss=0.00022 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.935 | L2-Norm(final)=2.306 | 4282.8 samples/s | 66.9 steps/s
[Step=7050 Epoch=66.8] | Loss=0.00020 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.903 | L2-Norm(final)=2.306 | 2233.8 samples/s | 34.9 steps/s
[Step=7100 Epoch=67.3] | Loss=0.00019 | Reg=0.00221 | acc=1.0000 | L2-Norm=14.871 | L2-Norm(final)=2.307 | 4410.5 samples/s | 68.9 steps/s
[Step=7150 Epoch=67.8] | Loss=0.00017 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.840 | L2-Norm(final)=2.308 | 2271.2 samples/s | 35.5 steps/s
[Step=7200 Epoch=68.2] | Loss=0.00016 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.808 | L2-Norm(final)=2.309 | 4165.4 samples/s | 65.1 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step7200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32389 | acc=0.8166 | tpr=0.7614 | fpr=0.0634 | 4135.5 samples/s | 16.2 steps/s
Avg test loss: 0.33065, Avg test acc: 0.81381, Avg tpr: 0.75992, Avg fpr: 0.06768, total FA: 528

Testing server on iccad2012
[Step=  50] | Loss=0.41282 | acc=0.8027 | tpr=0.9248 | fpr=0.1995 | 4250.5 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.42123 | acc=0.7975 | tpr=0.9318 | fpr=0.2050 | 7686.5 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.41987 | acc=0.7979 | tpr=0.9395 | fpr=0.2047 | 7475.5 samples/s | 29.2 steps/s
[Step= 200] | Loss=0.42089 | acc=0.7990 | tpr=0.9410 | fpr=0.2036 | 7577.9 samples/s | 29.6 steps/s
[Step= 250] | Loss=0.42057 | acc=0.7989 | tpr=0.9397 | fpr=0.2037 | 7404.4 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.42138 | acc=0.7991 | tpr=0.9367 | fpr=0.2034 | 7553.2 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.42093 | acc=0.8000 | tpr=0.9386 | fpr=0.2025 | 7796.9 samples/s | 30.5 steps/s
[Step= 400] | Loss=0.42170 | acc=0.7998 | tpr=0.9431 | fpr=0.2028 | 7579.7 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.42305 | acc=0.8002 | tpr=0.9440 | fpr=0.2024 | 7600.3 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.42275 | acc=0.8002 | tpr=0.9454 | fpr=0.2024 | 7358.5 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.42242 | acc=0.8002 | tpr=0.9459 | fpr=0.2024 | 13482.8 samples/s | 52.7 steps/s
Avg test loss: 0.42229, Avg test acc: 0.80024, Avg tpr: 0.94612, Avg fpr: 0.20241, total FA: 28104

server round 9/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=35.1] | Loss=0.11903 | Reg=0.00217 | acc=0.8906 | L2-Norm=14.723 | L2-Norm(final)=2.300 | 5083.6 samples/s | 79.4 steps/s
[Step=7250 Epoch=35.4] | Loss=0.02232 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.829 | L2-Norm(final)=2.315 | 4098.5 samples/s | 64.0 steps/s
[Step=7300 Epoch=35.6] | Loss=0.01997 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.879 | L2-Norm(final)=2.324 | 4509.2 samples/s | 70.5 steps/s
[Step=7350 Epoch=35.8] | Loss=0.01747 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.918 | L2-Norm(final)=2.328 | 4554.1 samples/s | 71.2 steps/s
[Step=7400 Epoch=36.1] | Loss=0.01694 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.949 | L2-Norm(final)=2.332 | 5892.8 samples/s | 92.1 steps/s
[Step=7450 Epoch=36.3] | Loss=0.01574 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.980 | L2-Norm(final)=2.334 | 2065.3 samples/s | 32.3 steps/s
[Step=7500 Epoch=36.6] | Loss=0.01465 | Reg=0.00225 | acc=0.9844 | L2-Norm=15.004 | L2-Norm(final)=2.337 | 4627.8 samples/s | 72.3 steps/s
[Step=7550 Epoch=36.8] | Loss=0.01469 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.024 | L2-Norm(final)=2.339 | 4463.9 samples/s | 69.7 steps/s
[Step=7600 Epoch=37.1] | Loss=0.01423 | Reg=0.00226 | acc=1.0000 | L2-Norm=15.044 | L2-Norm(final)=2.341 | 5495.3 samples/s | 85.9 steps/s
[Step=7650 Epoch=37.3] | Loss=0.01409 | Reg=0.00227 | acc=1.0000 | L2-Norm=15.063 | L2-Norm(final)=2.343 | 2119.9 samples/s | 33.1 steps/s
[Step=7700 Epoch=37.5] | Loss=0.01399 | Reg=0.00227 | acc=0.9844 | L2-Norm=15.082 | L2-Norm(final)=2.344 | 4549.4 samples/s | 71.1 steps/s
[Step=7750 Epoch=37.8] | Loss=0.01369 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.098 | L2-Norm(final)=2.344 | 4565.1 samples/s | 71.3 steps/s
[Step=7800 Epoch=38.0] | Loss=0.01419 | Reg=0.00228 | acc=0.9844 | L2-Norm=15.115 | L2-Norm(final)=2.345 | 5301.8 samples/s | 82.8 steps/s
[Step=7850 Epoch=38.3] | Loss=0.01383 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.135 | L2-Norm(final)=2.345 | 2192.6 samples/s | 34.3 steps/s
[Step=7900 Epoch=38.5] | Loss=0.01371 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.154 | L2-Norm(final)=2.346 | 4472.6 samples/s | 69.9 steps/s
[Step=7950 Epoch=38.8] | Loss=0.01380 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.175 | L2-Norm(final)=2.346 | 4523.4 samples/s | 70.7 steps/s
[Step=8000 Epoch=39.0] | Loss=0.01417 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.197 | L2-Norm(final)=2.346 | 4971.5 samples/s | 77.7 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step8000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00100, len=1
[Step=7201 Epoch=68.2] | Loss=0.21150 | Reg=0.00217 | acc=0.8594 | L2-Norm=14.723 | L2-Norm(final)=2.295 | 4873.8 samples/s | 76.2 steps/s
[Step=7250 Epoch=68.7] | Loss=0.01973 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.184 | L2-Norm(final)=2.251 | 3893.8 samples/s | 60.8 steps/s
[Step=7300 Epoch=69.2] | Loss=0.01188 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.347 | L2-Norm(final)=2.244 | 5819.1 samples/s | 90.9 steps/s
[Step=7350 Epoch=69.6] | Loss=0.00799 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.394 | L2-Norm(final)=2.240 | 1997.4 samples/s | 31.2 steps/s
[Step=7400 Epoch=70.1] | Loss=0.00600 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.404 | L2-Norm(final)=2.241 | 5415.9 samples/s | 84.6 steps/s
[Step=7450 Epoch=70.6] | Loss=0.00481 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.397 | L2-Norm(final)=2.241 | 2040.2 samples/s | 31.9 steps/s
[Step=7500 Epoch=71.1] | Loss=0.00401 | Reg=0.00237 | acc=1.0000 | L2-Norm=15.381 | L2-Norm(final)=2.242 | 4985.3 samples/s | 77.9 steps/s
[Step=7550 Epoch=71.5] | Loss=0.00344 | Reg=0.00236 | acc=1.0000 | L2-Norm=15.362 | L2-Norm(final)=2.243 | 2092.3 samples/s | 32.7 steps/s
[Step=7600 Epoch=72.0] | Loss=0.00301 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.339 | L2-Norm(final)=2.244 | 4743.8 samples/s | 74.1 steps/s
[Step=7650 Epoch=72.5] | Loss=0.00267 | Reg=0.00235 | acc=1.0000 | L2-Norm=15.315 | L2-Norm(final)=2.244 | 2151.5 samples/s | 33.6 steps/s
[Step=7700 Epoch=73.0] | Loss=0.00241 | Reg=0.00234 | acc=1.0000 | L2-Norm=15.290 | L2-Norm(final)=2.245 | 4325.8 samples/s | 67.6 steps/s
[Step=7750 Epoch=73.4] | Loss=0.00219 | Reg=0.00233 | acc=1.0000 | L2-Norm=15.264 | L2-Norm(final)=2.246 | 2241.6 samples/s | 35.0 steps/s
[Step=7800 Epoch=73.9] | Loss=0.00201 | Reg=0.00232 | acc=1.0000 | L2-Norm=15.238 | L2-Norm(final)=2.247 | 4332.1 samples/s | 67.7 steps/s
[Step=7850 Epoch=74.4] | Loss=0.00185 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.211 | L2-Norm(final)=2.248 | 2211.3 samples/s | 34.6 steps/s
[Step=7900 Epoch=74.9] | Loss=0.00172 | Reg=0.00231 | acc=1.0000 | L2-Norm=15.184 | L2-Norm(final)=2.249 | 4392.3 samples/s | 68.6 steps/s
[Step=7950 Epoch=75.3] | Loss=0.00161 | Reg=0.00230 | acc=1.0000 | L2-Norm=15.157 | L2-Norm(final)=2.251 | 2255.5 samples/s | 35.2 steps/s
[Step=8000 Epoch=75.8] | Loss=0.00151 | Reg=0.00229 | acc=1.0000 | L2-Norm=15.130 | L2-Norm(final)=2.252 | 4260.1 samples/s | 66.6 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step8000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.67628 | acc=0.6333 | tpr=0.4895 | fpr=0.0545 | 4426.6 samples/s | 17.3 steps/s
Avg test loss: 0.67959, Avg test acc: 0.63122, Avg tpr: 0.48831, Avg fpr: 0.05448, total FA: 425

Testing server on iccad2012
[Step=  50] | Loss=0.18626 | acc=0.9207 | tpr=0.9204 | fpr=0.0793 | 4269.2 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.19098 | acc=0.9196 | tpr=0.9360 | fpr=0.0807 | 7744.1 samples/s | 30.3 steps/s
[Step= 150] | Loss=0.19297 | acc=0.9198 | tpr=0.9409 | fpr=0.0806 | 8104.2 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.19447 | acc=0.9205 | tpr=0.9464 | fpr=0.0799 | 7104.0 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.19190 | acc=0.9214 | tpr=0.9450 | fpr=0.0790 | 7528.7 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.19350 | acc=0.9211 | tpr=0.9425 | fpr=0.0792 | 7964.8 samples/s | 31.1 steps/s
[Step= 350] | Loss=0.19493 | acc=0.9211 | tpr=0.9443 | fpr=0.0794 | 7469.2 samples/s | 29.2 steps/s
[Step= 400] | Loss=0.19599 | acc=0.9204 | tpr=0.9464 | fpr=0.0800 | 7798.0 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.19826 | acc=0.9200 | tpr=0.9460 | fpr=0.0804 | 7530.4 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.19776 | acc=0.9200 | tpr=0.9476 | fpr=0.0805 | 7447.3 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.19752 | acc=0.9199 | tpr=0.9479 | fpr=0.0806 | 14516.6 samples/s | 56.7 steps/s
Avg test loss: 0.19734, Avg test acc: 0.91989, Avg tpr: 0.94810, Avg fpr: 0.08062, total FA: 11194

server round 10/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=39.0] | Loss=0.49500 | Reg=0.00219 | acc=0.7656 | L2-Norm=14.786 | L2-Norm(final)=2.297 | 5077.1 samples/s | 79.3 steps/s
[Step=8050 Epoch=39.3] | Loss=0.06142 | Reg=0.00221 | acc=0.9844 | L2-Norm=14.856 | L2-Norm(final)=2.282 | 4322.6 samples/s | 67.5 steps/s
[Step=8100 Epoch=39.5] | Loss=0.03791 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.888 | L2-Norm(final)=2.294 | 4548.4 samples/s | 71.1 steps/s
[Step=8150 Epoch=39.7] | Loss=0.02947 | Reg=0.00222 | acc=1.0000 | L2-Norm=14.906 | L2-Norm(final)=2.304 | 4337.2 samples/s | 67.8 steps/s
[Step=8200 Epoch=40.0] | Loss=0.02516 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.918 | L2-Norm(final)=2.311 | 6004.9 samples/s | 93.8 steps/s
[Step=8250 Epoch=40.2] | Loss=0.02156 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.927 | L2-Norm(final)=2.316 | 2075.6 samples/s | 32.4 steps/s
[Step=8300 Epoch=40.5] | Loss=0.01879 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.934 | L2-Norm(final)=2.322 | 4563.6 samples/s | 71.3 steps/s
[Step=8350 Epoch=40.7] | Loss=0.01723 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.939 | L2-Norm(final)=2.326 | 4575.6 samples/s | 71.5 steps/s
[Step=8400 Epoch=41.0] | Loss=0.01572 | Reg=0.00223 | acc=0.9844 | L2-Norm=14.943 | L2-Norm(final)=2.330 | 5687.8 samples/s | 88.9 steps/s
[Step=8450 Epoch=41.2] | Loss=0.01438 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.946 | L2-Norm(final)=2.334 | 2142.8 samples/s | 33.5 steps/s
[Step=8500 Epoch=41.4] | Loss=0.01358 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.948 | L2-Norm(final)=2.338 | 4452.3 samples/s | 69.6 steps/s
[Step=8550 Epoch=41.7] | Loss=0.01288 | Reg=0.00223 | acc=1.0000 | L2-Norm=14.949 | L2-Norm(final)=2.341 | 4453.5 samples/s | 69.6 steps/s
[Step=8600 Epoch=41.9] | Loss=0.01227 | Reg=0.00224 | acc=0.9688 | L2-Norm=14.950 | L2-Norm(final)=2.343 | 5304.0 samples/s | 82.9 steps/s
[Step=8650 Epoch=42.2] | Loss=0.01168 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.951 | L2-Norm(final)=2.346 | 2172.8 samples/s | 33.9 steps/s
[Step=8700 Epoch=42.4] | Loss=0.01121 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.951 | L2-Norm(final)=2.348 | 4528.2 samples/s | 70.8 steps/s
[Step=8750 Epoch=42.7] | Loss=0.01069 | Reg=0.00224 | acc=1.0000 | L2-Norm=14.951 | L2-Norm(final)=2.351 | 4484.2 samples/s | 70.1 steps/s
[Step=8800 Epoch=42.9] | Loss=0.01039 | Reg=0.00224 | acc=0.9844 | L2-Norm=14.951 | L2-Norm(final)=2.353 | 4962.7 samples/s | 77.5 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step8800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8001 Epoch=75.8] | Loss=0.01552 | Reg=0.00219 | acc=0.9844 | L2-Norm=14.786 | L2-Norm(final)=2.299 | 4714.1 samples/s | 73.7 steps/s
[Step=8050 Epoch=76.3] | Loss=0.00199 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.821 | L2-Norm(final)=2.311 | 4240.1 samples/s | 66.3 steps/s
[Step=8100 Epoch=76.8] | Loss=0.00110 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.824 | L2-Norm(final)=2.317 | 5857.5 samples/s | 91.5 steps/s
[Step=8150 Epoch=77.2] | Loss=0.00075 | Reg=0.00220 | acc=1.0000 | L2-Norm=14.816 | L2-Norm(final)=2.320 | 1981.9 samples/s | 31.0 steps/s
[Step=8200 Epoch=77.7] | Loss=0.00056 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.803 | L2-Norm(final)=2.322 | 5258.7 samples/s | 82.2 steps/s
[Step=8250 Epoch=78.2] | Loss=0.00046 | Reg=0.00219 | acc=1.0000 | L2-Norm=14.789 | L2-Norm(final)=2.324 | 2017.8 samples/s | 31.5 steps/s
[Step=8300 Epoch=78.6] | Loss=0.00038 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.774 | L2-Norm(final)=2.326 | 4921.7 samples/s | 76.9 steps/s
[Step=8350 Epoch=79.1] | Loss=0.00033 | Reg=0.00218 | acc=1.0000 | L2-Norm=14.759 | L2-Norm(final)=2.327 | 2116.5 samples/s | 33.1 steps/s
[Step=8400 Epoch=79.6] | Loss=0.00029 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.743 | L2-Norm(final)=2.328 | 4636.2 samples/s | 72.4 steps/s
[Step=8450 Epoch=80.1] | Loss=0.00026 | Reg=0.00217 | acc=1.0000 | L2-Norm=14.727 | L2-Norm(final)=2.329 | 2170.8 samples/s | 33.9 steps/s
[Step=8500 Epoch=80.5] | Loss=0.00023 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.710 | L2-Norm(final)=2.330 | 4448.5 samples/s | 69.5 steps/s
[Step=8550 Epoch=81.0] | Loss=0.00021 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.694 | L2-Norm(final)=2.330 | 2237.9 samples/s | 35.0 steps/s
[Step=8600 Epoch=81.5] | Loss=0.00020 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.677 | L2-Norm(final)=2.331 | 4334.7 samples/s | 67.7 steps/s
[Step=8650 Epoch=82.0] | Loss=0.00018 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.661 | L2-Norm(final)=2.332 | 2230.5 samples/s | 34.9 steps/s
[Step=8700 Epoch=82.4] | Loss=0.00017 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.644 | L2-Norm(final)=2.332 | 4305.9 samples/s | 67.3 steps/s
[Step=8750 Epoch=82.9] | Loss=0.00016 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.627 | L2-Norm(final)=2.333 | 2282.5 samples/s | 35.7 steps/s
[Step=8800 Epoch=83.4] | Loss=0.00015 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.610 | L2-Norm(final)=2.334 | 4281.7 samples/s | 66.9 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step8800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.31532 | acc=0.8326 | tpr=0.7799 | fpr=0.0530 | 4303.6 samples/s | 16.8 steps/s
Avg test loss: 0.32807, Avg test acc: 0.83048, Avg tpr: 0.77852, Avg fpr: 0.05525, total FA: 431

Testing server on iccad2012
[Step=  50] | Loss=0.44100 | acc=0.8198 | tpr=0.9248 | fpr=0.1821 | 4211.4 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.45441 | acc=0.8157 | tpr=0.9424 | fpr=0.1866 | 7672.9 samples/s | 30.0 steps/s
[Step= 150] | Loss=0.45416 | acc=0.8163 | tpr=0.9452 | fpr=0.1861 | 8126.1 samples/s | 31.7 steps/s
[Step= 200] | Loss=0.45718 | acc=0.8166 | tpr=0.9464 | fpr=0.1857 | 7319.1 samples/s | 28.6 steps/s
[Step= 250] | Loss=0.45415 | acc=0.8170 | tpr=0.9450 | fpr=0.1853 | 7519.3 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.45683 | acc=0.8165 | tpr=0.9411 | fpr=0.1858 | 7311.6 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.45684 | acc=0.8168 | tpr=0.9443 | fpr=0.1855 | 8164.6 samples/s | 31.9 steps/s
[Step= 400] | Loss=0.45858 | acc=0.8169 | tpr=0.9475 | fpr=0.1855 | 7129.6 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.46131 | acc=0.8172 | tpr=0.9484 | fpr=0.1852 | 7748.7 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.46011 | acc=0.8173 | tpr=0.9511 | fpr=0.1851 | 7465.3 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.45958 | acc=0.8173 | tpr=0.9511 | fpr=0.1851 | 12982.6 samples/s | 50.7 steps/s
Avg test loss: 0.45920, Avg test acc: 0.81740, Avg tpr: 0.95127, Avg fpr: 0.18503, total FA: 25691

server round 11/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=42.9] | Loss=0.05292 | Reg=0.00212 | acc=0.9375 | L2-Norm=14.569 | L2-Norm(final)=2.362 | 5005.0 samples/s | 78.2 steps/s
[Step=8850 Epoch=43.2] | Loss=0.01744 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.614 | L2-Norm(final)=2.364 | 4102.5 samples/s | 64.1 steps/s
[Step=8900 Epoch=43.4] | Loss=0.01151 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.635 | L2-Norm(final)=2.376 | 4501.4 samples/s | 70.3 steps/s
[Step=8950 Epoch=43.6] | Loss=0.01172 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.646 | L2-Norm(final)=2.382 | 4546.4 samples/s | 71.0 steps/s
[Step=9000 Epoch=43.9] | Loss=0.01038 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.654 | L2-Norm(final)=2.385 | 5832.2 samples/s | 91.1 steps/s
[Step=9050 Epoch=44.1] | Loss=0.00960 | Reg=0.00215 | acc=0.9844 | L2-Norm=14.661 | L2-Norm(final)=2.389 | 2055.6 samples/s | 32.1 steps/s
[Step=9100 Epoch=44.4] | Loss=0.00878 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.666 | L2-Norm(final)=2.392 | 4539.3 samples/s | 70.9 steps/s
[Step=9150 Epoch=44.6] | Loss=0.00834 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.670 | L2-Norm(final)=2.396 | 4522.4 samples/s | 70.7 steps/s
[Step=9200 Epoch=44.9] | Loss=0.00803 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.673 | L2-Norm(final)=2.398 | 5588.5 samples/s | 87.3 steps/s
[Step=9250 Epoch=45.1] | Loss=0.00749 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.675 | L2-Norm(final)=2.401 | 2056.3 samples/s | 32.1 steps/s
[Step=9300 Epoch=45.3] | Loss=0.00712 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.677 | L2-Norm(final)=2.404 | 4457.9 samples/s | 69.7 steps/s
[Step=9350 Epoch=45.6] | Loss=0.00694 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.678 | L2-Norm(final)=2.407 | 4523.2 samples/s | 70.7 steps/s
[Step=9400 Epoch=45.8] | Loss=0.00673 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.679 | L2-Norm(final)=2.409 | 5127.1 samples/s | 80.1 steps/s
[Step=9450 Epoch=46.1] | Loss=0.00661 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.680 | L2-Norm(final)=2.411 | 2157.1 samples/s | 33.7 steps/s
[Step=9500 Epoch=46.3] | Loss=0.00636 | Reg=0.00216 | acc=0.9844 | L2-Norm=14.680 | L2-Norm(final)=2.413 | 4485.7 samples/s | 70.1 steps/s
[Step=9550 Epoch=46.6] | Loss=0.00617 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.681 | L2-Norm(final)=2.416 | 4569.9 samples/s | 71.4 steps/s
[Step=9600 Epoch=46.8] | Loss=0.00610 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.681 | L2-Norm(final)=2.418 | 4951.0 samples/s | 77.4 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step9600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=8801 Epoch=83.4] | Loss=0.01852 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.569 | L2-Norm(final)=2.363 | 4387.5 samples/s | 68.6 steps/s
[Step=8850 Epoch=83.9] | Loss=0.00342 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.675 | L2-Norm(final)=2.366 | 4289.1 samples/s | 67.0 steps/s
[Step=8900 Epoch=84.3] | Loss=0.00172 | Reg=0.00216 | acc=1.0000 | L2-Norm=14.688 | L2-Norm(final)=2.368 | 5739.5 samples/s | 89.7 steps/s
[Step=8950 Epoch=84.8] | Loss=0.00115 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.680 | L2-Norm(final)=2.370 | 1915.4 samples/s | 29.9 steps/s
[Step=9000 Epoch=85.3] | Loss=0.00087 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.666 | L2-Norm(final)=2.371 | 5303.3 samples/s | 82.9 steps/s
[Step=9050 Epoch=85.8] | Loss=0.00070 | Reg=0.00215 | acc=1.0000 | L2-Norm=14.651 | L2-Norm(final)=2.372 | 2019.5 samples/s | 31.6 steps/s
[Step=9100 Epoch=86.2] | Loss=0.00058 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.635 | L2-Norm(final)=2.373 | 4920.2 samples/s | 76.9 steps/s
[Step=9150 Epoch=86.7] | Loss=0.00050 | Reg=0.00214 | acc=1.0000 | L2-Norm=14.618 | L2-Norm(final)=2.374 | 2069.6 samples/s | 32.3 steps/s
[Step=9200 Epoch=87.2] | Loss=0.00044 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.601 | L2-Norm(final)=2.375 | 4629.9 samples/s | 72.3 steps/s
[Step=9250 Epoch=87.7] | Loss=0.00039 | Reg=0.00213 | acc=1.0000 | L2-Norm=14.583 | L2-Norm(final)=2.375 | 2142.8 samples/s | 33.5 steps/s
[Step=9300 Epoch=88.1] | Loss=0.00035 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.565 | L2-Norm(final)=2.376 | 4417.2 samples/s | 69.0 steps/s
[Step=9350 Epoch=88.6] | Loss=0.00032 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.548 | L2-Norm(final)=2.376 | 2160.8 samples/s | 33.8 steps/s
[Step=9400 Epoch=89.1] | Loss=0.00029 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.530 | L2-Norm(final)=2.377 | 4199.8 samples/s | 65.6 steps/s
[Step=9450 Epoch=89.5] | Loss=0.00027 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.512 | L2-Norm(final)=2.377 | 2220.7 samples/s | 34.7 steps/s
[Step=9500 Epoch=90.0] | Loss=0.00025 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.494 | L2-Norm(final)=2.378 | 4481.8 samples/s | 70.0 steps/s
[Step=9550 Epoch=90.5] | Loss=0.00024 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.475 | L2-Norm(final)=2.378 | 2209.2 samples/s | 34.5 steps/s
[Step=9600 Epoch=91.0] | Loss=0.00022 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.457 | L2-Norm(final)=2.379 | 4280.8 samples/s | 66.9 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step9600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.55416 | acc=0.7512 | tpr=0.6556 | fpr=0.0414 | 4127.0 samples/s | 16.1 steps/s
Avg test loss: 0.56732, Avg test acc: 0.74826, Avg tpr: 0.65303, Avg fpr: 0.04230, total FA: 330

Testing server on iccad2012
[Step=  50] | Loss=0.29319 | acc=0.8987 | tpr=0.9248 | fpr=0.1018 | 4300.9 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.29983 | acc=0.8955 | tpr=0.9360 | fpr=0.1052 | 7625.1 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.29952 | acc=0.8957 | tpr=0.9409 | fpr=0.1052 | 7449.5 samples/s | 29.1 steps/s
[Step= 200] | Loss=0.30187 | acc=0.8957 | tpr=0.9454 | fpr=0.1052 | 7668.1 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.29886 | acc=0.8962 | tpr=0.9432 | fpr=0.1047 | 8011.6 samples/s | 31.3 steps/s
[Step= 300] | Loss=0.29998 | acc=0.8965 | tpr=0.9404 | fpr=0.1043 | 7477.8 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.30055 | acc=0.8967 | tpr=0.9430 | fpr=0.1041 | 7563.5 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.30195 | acc=0.8963 | tpr=0.9469 | fpr=0.1046 | 7881.5 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.30503 | acc=0.8961 | tpr=0.9460 | fpr=0.1048 | 7695.5 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.30411 | acc=0.8961 | tpr=0.9476 | fpr=0.1049 | 7881.5 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.30353 | acc=0.8962 | tpr=0.9471 | fpr=0.1047 | 12961.4 samples/s | 50.6 steps/s
Avg test loss: 0.30335, Avg test acc: 0.89620, Avg tpr: 0.94691, Avg fpr: 0.10472, total FA: 14540

server round 12/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=46.8] | Loss=0.22789 | Reg=0.00206 | acc=0.8906 | L2-Norm=14.340 | L2-Norm(final)=2.414 | 4661.1 samples/s | 72.8 steps/s
[Step=9650 Epoch=47.1] | Loss=0.02847 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.444 | L2-Norm(final)=2.400 | 4492.3 samples/s | 70.2 steps/s
[Step=9700 Epoch=47.3] | Loss=0.01776 | Reg=0.00210 | acc=0.9844 | L2-Norm=14.482 | L2-Norm(final)=2.408 | 4508.3 samples/s | 70.4 steps/s
[Step=9750 Epoch=47.5] | Loss=0.01445 | Reg=0.00210 | acc=1.0000 | L2-Norm=14.499 | L2-Norm(final)=2.414 | 4493.8 samples/s | 70.2 steps/s
[Step=9800 Epoch=47.8] | Loss=0.01242 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.510 | L2-Norm(final)=2.418 | 6059.0 samples/s | 94.7 steps/s
[Step=9850 Epoch=48.0] | Loss=0.01145 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.520 | L2-Norm(final)=2.422 | 2080.6 samples/s | 32.5 steps/s
[Step=9900 Epoch=48.3] | Loss=0.01069 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.528 | L2-Norm(final)=2.426 | 4461.1 samples/s | 69.7 steps/s
[Step=9950 Epoch=48.5] | Loss=0.00994 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.534 | L2-Norm(final)=2.429 | 4581.9 samples/s | 71.6 steps/s
[Step=10000 Epoch=48.8] | Loss=0.00929 | Reg=0.00211 | acc=0.9844 | L2-Norm=14.539 | L2-Norm(final)=2.432 | 5743.9 samples/s | 89.7 steps/s
[Step=10050 Epoch=49.0] | Loss=0.00877 | Reg=0.00211 | acc=1.0000 | L2-Norm=14.543 | L2-Norm(final)=2.436 | 2106.0 samples/s | 32.9 steps/s
[Step=10100 Epoch=49.2] | Loss=0.00841 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.546 | L2-Norm(final)=2.438 | 4549.3 samples/s | 71.1 steps/s
[Step=10150 Epoch=49.5] | Loss=0.00801 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.548 | L2-Norm(final)=2.441 | 4441.9 samples/s | 69.4 steps/s
[Step=10200 Epoch=49.7] | Loss=0.00793 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.550 | L2-Norm(final)=2.443 | 5225.2 samples/s | 81.6 steps/s
[Step=10250 Epoch=50.0] | Loss=0.00764 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.552 | L2-Norm(final)=2.445 | 2202.6 samples/s | 34.4 steps/s
[Step=10300 Epoch=50.2] | Loss=0.00729 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.554 | L2-Norm(final)=2.447 | 4446.1 samples/s | 69.5 steps/s
[Step=10350 Epoch=50.5] | Loss=0.00717 | Reg=0.00212 | acc=0.9844 | L2-Norm=14.556 | L2-Norm(final)=2.449 | 4499.8 samples/s | 70.3 steps/s
[Step=10400 Epoch=50.7] | Loss=0.00698 | Reg=0.00212 | acc=1.0000 | L2-Norm=14.557 | L2-Norm(final)=2.451 | 4879.1 samples/s | 76.2 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step10400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=9601 Epoch=91.0] | Loss=0.08448 | Reg=0.00206 | acc=0.9688 | L2-Norm=14.340 | L2-Norm(final)=2.415 | 4420.3 samples/s | 69.1 steps/s
[Step=9650 Epoch=91.4] | Loss=0.00602 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.440 | L2-Norm(final)=2.403 | 3912.2 samples/s | 61.1 steps/s
[Step=9700 Epoch=91.9] | Loss=0.00334 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.470 | L2-Norm(final)=2.408 | 5911.1 samples/s | 92.4 steps/s
[Step=9750 Epoch=92.4] | Loss=0.00223 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.471 | L2-Norm(final)=2.411 | 1975.6 samples/s | 30.9 steps/s
[Step=9800 Epoch=92.9] | Loss=0.00168 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.463 | L2-Norm(final)=2.413 | 5448.4 samples/s | 85.1 steps/s
[Step=9850 Epoch=93.3] | Loss=0.00135 | Reg=0.00209 | acc=1.0000 | L2-Norm=14.452 | L2-Norm(final)=2.415 | 1981.1 samples/s | 31.0 steps/s
[Step=9900 Epoch=93.8] | Loss=0.00112 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.438 | L2-Norm(final)=2.416 | 4982.6 samples/s | 77.9 steps/s
[Step=9950 Epoch=94.3] | Loss=0.00096 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.423 | L2-Norm(final)=2.418 | 2124.2 samples/s | 33.2 steps/s
[Step=10000 Epoch=94.8] | Loss=0.00084 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.408 | L2-Norm(final)=2.419 | 4685.9 samples/s | 73.2 steps/s
[Step=10050 Epoch=95.2] | Loss=0.00075 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.392 | L2-Norm(final)=2.419 | 2183.6 samples/s | 34.1 steps/s
[Step=10100 Epoch=95.7] | Loss=0.00068 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.376 | L2-Norm(final)=2.420 | 4406.3 samples/s | 68.8 steps/s
[Step=10150 Epoch=96.2] | Loss=0.00062 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.360 | L2-Norm(final)=2.421 | 2166.3 samples/s | 33.8 steps/s
[Step=10200 Epoch=96.7] | Loss=0.00057 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.344 | L2-Norm(final)=2.422 | 4353.3 samples/s | 68.0 steps/s
[Step=10250 Epoch=97.1] | Loss=0.00052 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.327 | L2-Norm(final)=2.423 | 2232.2 samples/s | 34.9 steps/s
[Step=10300 Epoch=97.6] | Loss=0.00049 | Reg=0.00205 | acc=1.0000 | L2-Norm=14.311 | L2-Norm(final)=2.423 | 4371.2 samples/s | 68.3 steps/s
[Step=10350 Epoch=98.1] | Loss=0.00045 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.294 | L2-Norm(final)=2.424 | 2234.7 samples/s | 34.9 steps/s
[Step=10400 Epoch=98.5] | Loss=0.00042 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.277 | L2-Norm(final)=2.424 | 4366.0 samples/s | 68.2 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step10400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35928 | acc=0.8264 | tpr=0.7677 | fpr=0.0461 | 4195.7 samples/s | 16.4 steps/s
Avg test loss: 0.36897, Avg test acc: 0.82398, Avg tpr: 0.76564, Avg fpr: 0.04769, total FA: 372

Testing server on iccad2012
[Step=  50] | Loss=0.40709 | acc=0.8459 | tpr=0.9115 | fpr=0.1553 | 4151.9 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.41858 | acc=0.8418 | tpr=0.9275 | fpr=0.1598 | 7541.3 samples/s | 29.5 steps/s
[Step= 150] | Loss=0.41859 | acc=0.8418 | tpr=0.9294 | fpr=0.1598 | 7655.7 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.42143 | acc=0.8421 | tpr=0.9355 | fpr=0.1596 | 7247.4 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.41918 | acc=0.8424 | tpr=0.9345 | fpr=0.1593 | 7936.3 samples/s | 31.0 steps/s
[Step= 300] | Loss=0.42099 | acc=0.8422 | tpr=0.9309 | fpr=0.1594 | 7473.8 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.42175 | acc=0.8425 | tpr=0.9317 | fpr=0.1591 | 7826.9 samples/s | 30.6 steps/s
[Step= 400] | Loss=0.42413 | acc=0.8415 | tpr=0.9365 | fpr=0.1602 | 8017.0 samples/s | 31.3 steps/s
[Step= 450] | Loss=0.42714 | acc=0.8413 | tpr=0.9387 | fpr=0.1604 | 7103.4 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.42622 | acc=0.8415 | tpr=0.9405 | fpr=0.1603 | 7420.5 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.42502 | acc=0.8413 | tpr=0.9403 | fpr=0.1604 | 13668.3 samples/s | 53.4 steps/s
Avg test loss: 0.42456, Avg test acc: 0.84137, Avg tpr: 0.94057, Avg fpr: 0.16043, total FA: 22276

server round 13/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=50.7] | Loss=0.09602 | Reg=0.00201 | acc=0.9062 | L2-Norm=14.184 | L2-Norm(final)=2.454 | 5014.6 samples/s | 78.4 steps/s
[Step=10450 Epoch=51.0] | Loss=0.01657 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.266 | L2-Norm(final)=2.455 | 4238.0 samples/s | 66.2 steps/s
[Step=10500 Epoch=51.2] | Loss=0.01340 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.299 | L2-Norm(final)=2.462 | 4533.3 samples/s | 70.8 steps/s
[Step=10550 Epoch=51.4] | Loss=0.01175 | Reg=0.00205 | acc=0.9844 | L2-Norm=14.319 | L2-Norm(final)=2.466 | 4538.9 samples/s | 70.9 steps/s
[Step=10600 Epoch=51.7] | Loss=0.01118 | Reg=0.00206 | acc=1.0000 | L2-Norm=14.336 | L2-Norm(final)=2.470 | 6038.0 samples/s | 94.3 steps/s
[Step=10650 Epoch=51.9] | Loss=0.01040 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.352 | L2-Norm(final)=2.472 | 2084.7 samples/s | 32.6 steps/s
[Step=10700 Epoch=52.2] | Loss=0.00988 | Reg=0.00206 | acc=0.9844 | L2-Norm=14.365 | L2-Norm(final)=2.475 | 4469.5 samples/s | 69.8 steps/s
[Step=10750 Epoch=52.4] | Loss=0.00980 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.375 | L2-Norm(final)=2.476 | 4465.6 samples/s | 69.8 steps/s
[Step=10800 Epoch=52.7] | Loss=0.00941 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.382 | L2-Norm(final)=2.477 | 5533.3 samples/s | 86.5 steps/s
[Step=10850 Epoch=52.9] | Loss=0.00895 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.390 | L2-Norm(final)=2.479 | 2117.9 samples/s | 33.1 steps/s
[Step=10900 Epoch=53.2] | Loss=0.00851 | Reg=0.00207 | acc=0.9844 | L2-Norm=14.396 | L2-Norm(final)=2.481 | 4555.6 samples/s | 71.2 steps/s
[Step=10950 Epoch=53.4] | Loss=0.00846 | Reg=0.00207 | acc=1.0000 | L2-Norm=14.402 | L2-Norm(final)=2.482 | 4566.4 samples/s | 71.3 steps/s
[Step=11000 Epoch=53.6] | Loss=0.00820 | Reg=0.00208 | acc=0.9844 | L2-Norm=14.407 | L2-Norm(final)=2.483 | 5262.8 samples/s | 82.2 steps/s
[Step=11050 Epoch=53.9] | Loss=0.00788 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.411 | L2-Norm(final)=2.485 | 2195.6 samples/s | 34.3 steps/s
[Step=11100 Epoch=54.1] | Loss=0.00758 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.415 | L2-Norm(final)=2.486 | 4511.6 samples/s | 70.5 steps/s
[Step=11150 Epoch=54.4] | Loss=0.00731 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.419 | L2-Norm(final)=2.488 | 4518.2 samples/s | 70.6 steps/s
[Step=11200 Epoch=54.6] | Loss=0.00719 | Reg=0.00208 | acc=1.0000 | L2-Norm=14.422 | L2-Norm(final)=2.489 | 5012.0 samples/s | 78.3 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step11200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=10401 Epoch=98.6] | Loss=0.05796 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.184 | L2-Norm(final)=2.454 | 5110.6 samples/s | 79.9 steps/s
[Step=10450 Epoch=99.0] | Loss=0.00331 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.276 | L2-Norm(final)=2.450 | 3714.0 samples/s | 58.0 steps/s
[Step=10500 Epoch=99.5] | Loss=0.00172 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.284 | L2-Norm(final)=2.452 | 5923.9 samples/s | 92.6 steps/s
[Step=10550 Epoch=100.0] | Loss=0.00115 | Reg=0.00204 | acc=1.0000 | L2-Norm=14.278 | L2-Norm(final)=2.455 | 1982.3 samples/s | 31.0 steps/s
[Step=10600 Epoch=100.4] | Loss=0.00087 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.264 | L2-Norm(final)=2.457 | 5391.3 samples/s | 84.2 steps/s
[Step=10650 Epoch=100.9] | Loss=0.00069 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.249 | L2-Norm(final)=2.458 | 2061.1 samples/s | 32.2 steps/s
[Step=10700 Epoch=101.4] | Loss=0.00058 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.233 | L2-Norm(final)=2.459 | 5007.6 samples/s | 78.2 steps/s
[Step=10750 Epoch=101.9] | Loss=0.00050 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.216 | L2-Norm(final)=2.460 | 2092.3 samples/s | 32.7 steps/s
[Step=10800 Epoch=102.3] | Loss=0.00044 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.198 | L2-Norm(final)=2.461 | 4735.4 samples/s | 74.0 steps/s
[Step=10850 Epoch=102.8] | Loss=0.00039 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.181 | L2-Norm(final)=2.462 | 2062.8 samples/s | 32.2 steps/s
[Step=10900 Epoch=103.3] | Loss=0.00035 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.163 | L2-Norm(final)=2.462 | 4371.7 samples/s | 68.3 steps/s
[Step=10950 Epoch=103.8] | Loss=0.00032 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.145 | L2-Norm(final)=2.463 | 2199.5 samples/s | 34.4 steps/s
[Step=11000 Epoch=104.2] | Loss=0.00029 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.127 | L2-Norm(final)=2.463 | 4386.4 samples/s | 68.5 steps/s
[Step=11050 Epoch=104.7] | Loss=0.00027 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.110 | L2-Norm(final)=2.464 | 2232.4 samples/s | 34.9 steps/s
[Step=11100 Epoch=105.2] | Loss=0.00025 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.092 | L2-Norm(final)=2.465 | 4350.6 samples/s | 68.0 steps/s
[Step=11150 Epoch=105.7] | Loss=0.00023 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.074 | L2-Norm(final)=2.465 | 2243.4 samples/s | 35.1 steps/s
[Step=11200 Epoch=106.1] | Loss=0.00022 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.056 | L2-Norm(final)=2.466 | 4248.5 samples/s | 66.4 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step11200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.43355 | acc=0.7974 | tpr=0.7236 | fpr=0.0424 | 4132.9 samples/s | 16.1 steps/s
Avg test loss: 0.44399, Avg test acc: 0.79626, Avg tpr: 0.72332, Avg fpr: 0.04333, total FA: 338

Testing server on iccad2012
[Step=  50] | Loss=0.33082 | acc=0.8864 | tpr=0.9115 | fpr=0.1140 | 4278.8 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.33967 | acc=0.8818 | tpr=0.9211 | fpr=0.1189 | 7477.9 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.33956 | acc=0.8829 | tpr=0.9280 | fpr=0.1180 | 7715.2 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.34330 | acc=0.8825 | tpr=0.9311 | fpr=0.1184 | 7241.9 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.34045 | acc=0.8832 | tpr=0.9284 | fpr=0.1176 | 7436.0 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.34307 | acc=0.8828 | tpr=0.9251 | fpr=0.1180 | 7672.3 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.34375 | acc=0.8828 | tpr=0.9249 | fpr=0.1180 | 7639.7 samples/s | 29.8 steps/s
[Step= 400] | Loss=0.34524 | acc=0.8826 | tpr=0.9305 | fpr=0.1182 | 7409.7 samples/s | 28.9 steps/s
[Step= 450] | Loss=0.34856 | acc=0.8826 | tpr=0.9333 | fpr=0.1183 | 7543.4 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.34710 | acc=0.8827 | tpr=0.9357 | fpr=0.1183 | 7491.8 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.34582 | acc=0.8828 | tpr=0.9367 | fpr=0.1182 | 14093.7 samples/s | 55.1 steps/s
Avg test loss: 0.34542, Avg test acc: 0.88283, Avg tpr: 0.93700, Avg fpr: 0.11816, total FA: 16406

server round 14/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=54.6] | Loss=0.18006 | Reg=0.00196 | acc=0.9062 | L2-Norm=14.011 | L2-Norm(final)=2.489 | 4934.7 samples/s | 77.1 steps/s
[Step=11250 Epoch=54.9] | Loss=0.01895 | Reg=0.00199 | acc=0.9531 | L2-Norm=14.108 | L2-Norm(final)=2.482 | 4334.7 samples/s | 67.7 steps/s
[Step=11300 Epoch=55.1] | Loss=0.01272 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.144 | L2-Norm(final)=2.484 | 4530.8 samples/s | 70.8 steps/s
[Step=11350 Epoch=55.3] | Loss=0.01075 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.166 | L2-Norm(final)=2.491 | 4568.8 samples/s | 71.4 steps/s
[Step=11400 Epoch=55.6] | Loss=0.00957 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.181 | L2-Norm(final)=2.494 | 6094.8 samples/s | 95.2 steps/s
[Step=11450 Epoch=55.8] | Loss=0.00831 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.192 | L2-Norm(final)=2.499 | 2089.0 samples/s | 32.6 steps/s
[Step=11500 Epoch=56.1] | Loss=0.00770 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.199 | L2-Norm(final)=2.502 | 4501.7 samples/s | 70.3 steps/s
[Step=11550 Epoch=56.3] | Loss=0.00722 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.203 | L2-Norm(final)=2.505 | 4493.3 samples/s | 70.2 steps/s
[Step=11600 Epoch=56.6] | Loss=0.00696 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.207 | L2-Norm(final)=2.508 | 5646.7 samples/s | 88.2 steps/s
[Step=11650 Epoch=56.8] | Loss=0.00679 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.210 | L2-Norm(final)=2.511 | 2096.4 samples/s | 32.8 steps/s
[Step=11700 Epoch=57.1] | Loss=0.00637 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.213 | L2-Norm(final)=2.513 | 4554.1 samples/s | 71.2 steps/s
[Step=11750 Epoch=57.3] | Loss=0.00632 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.215 | L2-Norm(final)=2.516 | 4449.3 samples/s | 69.5 steps/s
[Step=11800 Epoch=57.5] | Loss=0.00612 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.216 | L2-Norm(final)=2.518 | 5239.4 samples/s | 81.9 steps/s
[Step=11850 Epoch=57.8] | Loss=0.00594 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.217 | L2-Norm(final)=2.519 | 2171.2 samples/s | 33.9 steps/s
[Step=11900 Epoch=58.0] | Loss=0.00576 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.218 | L2-Norm(final)=2.521 | 4574.0 samples/s | 71.5 steps/s
[Step=11950 Epoch=58.3] | Loss=0.00561 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.219 | L2-Norm(final)=2.523 | 4592.2 samples/s | 71.8 steps/s
[Step=12000 Epoch=58.5] | Loss=0.00542 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.220 | L2-Norm(final)=2.526 | 4929.2 samples/s | 77.0 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step12000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=11201 Epoch=106.1] | Loss=0.00929 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.011 | L2-Norm(final)=2.491 | 5186.0 samples/s | 81.0 steps/s
[Step=11250 Epoch=106.6] | Loss=0.00156 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.100 | L2-Norm(final)=2.502 | 3703.3 samples/s | 57.9 steps/s
[Step=11300 Epoch=107.1] | Loss=0.00129 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.151 | L2-Norm(final)=2.507 | 5917.1 samples/s | 92.5 steps/s
[Step=11350 Epoch=107.6] | Loss=0.00111 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.181 | L2-Norm(final)=2.510 | 2014.8 samples/s | 31.5 steps/s
[Step=11400 Epoch=108.0] | Loss=0.00093 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.201 | L2-Norm(final)=2.512 | 5337.6 samples/s | 83.4 steps/s
[Step=11450 Epoch=108.5] | Loss=0.00074 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.211 | L2-Norm(final)=2.514 | 2029.6 samples/s | 31.7 steps/s
[Step=11500 Epoch=109.0] | Loss=0.00062 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.213 | L2-Norm(final)=2.516 | 5010.7 samples/s | 78.3 steps/s
[Step=11550 Epoch=109.4] | Loss=0.00053 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.209 | L2-Norm(final)=2.517 | 2085.4 samples/s | 32.6 steps/s
[Step=11600 Epoch=109.9] | Loss=0.00047 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.203 | L2-Norm(final)=2.518 | 4729.4 samples/s | 73.9 steps/s
[Step=11650 Epoch=110.4] | Loss=0.00042 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.194 | L2-Norm(final)=2.519 | 2122.4 samples/s | 33.2 steps/s
[Step=11700 Epoch=110.9] | Loss=0.00037 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.184 | L2-Norm(final)=2.520 | 4421.3 samples/s | 69.1 steps/s
[Step=11750 Epoch=111.3] | Loss=0.00034 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.173 | L2-Norm(final)=2.520 | 2203.9 samples/s | 34.4 steps/s
[Step=11800 Epoch=111.8] | Loss=0.00031 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.161 | L2-Norm(final)=2.521 | 4413.3 samples/s | 69.0 steps/s
[Step=11850 Epoch=112.3] | Loss=0.00029 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.148 | L2-Norm(final)=2.522 | 2245.7 samples/s | 35.1 steps/s
[Step=11900 Epoch=112.8] | Loss=0.00027 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.135 | L2-Norm(final)=2.522 | 4405.6 samples/s | 68.8 steps/s
[Step=11950 Epoch=113.2] | Loss=0.00025 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.122 | L2-Norm(final)=2.523 | 2222.1 samples/s | 34.7 steps/s
[Step=12000 Epoch=113.7] | Loss=0.00024 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.108 | L2-Norm(final)=2.524 | 4255.4 samples/s | 66.5 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step12000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.45390 | acc=0.8034 | tpr=0.7351 | fpr=0.0483 | 4106.2 samples/s | 16.0 steps/s
Avg test loss: 0.46327, Avg test acc: 0.80283, Avg tpr: 0.73492, Avg fpr: 0.04781, total FA: 373

Testing server on iccad2012
[Step=  50] | Loss=0.37887 | acc=0.8798 | tpr=0.9204 | fpr=0.1209 | 4202.3 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.38995 | acc=0.8774 | tpr=0.9254 | fpr=0.1235 | 7827.4 samples/s | 30.6 steps/s
[Step= 150] | Loss=0.39009 | acc=0.8777 | tpr=0.9308 | fpr=0.1233 | 7706.5 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.39263 | acc=0.8773 | tpr=0.9377 | fpr=0.1238 | 7120.8 samples/s | 27.8 steps/s
[Step= 250] | Loss=0.39154 | acc=0.8764 | tpr=0.9397 | fpr=0.1247 | 7486.3 samples/s | 29.2 steps/s
[Step= 300] | Loss=0.39410 | acc=0.8762 | tpr=0.9375 | fpr=0.1249 | 7747.1 samples/s | 30.3 steps/s
[Step= 350] | Loss=0.39527 | acc=0.8761 | tpr=0.9355 | fpr=0.1250 | 7571.7 samples/s | 29.6 steps/s
[Step= 400] | Loss=0.39629 | acc=0.8759 | tpr=0.9382 | fpr=0.1253 | 7898.5 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.39917 | acc=0.8759 | tpr=0.9401 | fpr=0.1253 | 7883.6 samples/s | 30.8 steps/s
[Step= 500] | Loss=0.39779 | acc=0.8758 | tpr=0.9414 | fpr=0.1254 | 7298.8 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.39674 | acc=0.8760 | tpr=0.9403 | fpr=0.1252 | 13489.9 samples/s | 52.7 steps/s
Avg test loss: 0.39600, Avg test acc: 0.87607, Avg tpr: 0.94057, Avg fpr: 0.12510, total FA: 17370

server round 15/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=58.5] | Loss=0.17259 | Reg=0.00194 | acc=0.9219 | L2-Norm=13.942 | L2-Norm(final)=2.543 | 4919.4 samples/s | 76.9 steps/s
[Step=12050 Epoch=58.8] | Loss=0.02975 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.050 | L2-Norm(final)=2.522 | 4265.8 samples/s | 66.7 steps/s
[Step=12100 Epoch=59.0] | Loss=0.01903 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.096 | L2-Norm(final)=2.521 | 4572.2 samples/s | 71.4 steps/s
[Step=12150 Epoch=59.2] | Loss=0.01665 | Reg=0.00199 | acc=0.9844 | L2-Norm=14.122 | L2-Norm(final)=2.524 | 4624.0 samples/s | 72.3 steps/s
[Step=12200 Epoch=59.5] | Loss=0.01533 | Reg=0.00200 | acc=0.9844 | L2-Norm=14.143 | L2-Norm(final)=2.525 | 5824.3 samples/s | 91.0 steps/s
[Step=12250 Epoch=59.7] | Loss=0.01405 | Reg=0.00201 | acc=0.9844 | L2-Norm=14.163 | L2-Norm(final)=2.529 | 2069.9 samples/s | 32.3 steps/s
[Step=12300 Epoch=60.0] | Loss=0.01292 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.178 | L2-Norm(final)=2.532 | 4476.2 samples/s | 69.9 steps/s
[Step=12350 Epoch=60.2] | Loss=0.01179 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.193 | L2-Norm(final)=2.536 | 4549.2 samples/s | 71.1 steps/s
[Step=12400 Epoch=60.5] | Loss=0.01129 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.205 | L2-Norm(final)=2.539 | 5666.5 samples/s | 88.5 steps/s
[Step=12450 Epoch=60.7] | Loss=0.01054 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.216 | L2-Norm(final)=2.542 | 2111.0 samples/s | 33.0 steps/s
[Step=12500 Epoch=61.0] | Loss=0.01008 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.225 | L2-Norm(final)=2.544 | 4517.5 samples/s | 70.6 steps/s
[Step=12550 Epoch=61.2] | Loss=0.00955 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.232 | L2-Norm(final)=2.546 | 4623.4 samples/s | 72.2 steps/s
[Step=12600 Epoch=61.4] | Loss=0.00939 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.238 | L2-Norm(final)=2.548 | 5210.9 samples/s | 81.4 steps/s
[Step=12650 Epoch=61.7] | Loss=0.00918 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.244 | L2-Norm(final)=2.548 | 2174.9 samples/s | 34.0 steps/s
[Step=12700 Epoch=61.9] | Loss=0.00887 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.249 | L2-Norm(final)=2.549 | 4596.7 samples/s | 71.8 steps/s
[Step=12750 Epoch=62.2] | Loss=0.00868 | Reg=0.00203 | acc=0.9844 | L2-Norm=14.254 | L2-Norm(final)=2.551 | 4577.1 samples/s | 71.5 steps/s
[Step=12800 Epoch=62.4] | Loss=0.00841 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.259 | L2-Norm(final)=2.552 | 4942.3 samples/s | 77.2 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step12800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12001 Epoch=113.7] | Loss=0.00518 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.942 | L2-Norm(final)=2.544 | 4598.3 samples/s | 71.8 steps/s
[Step=12050 Epoch=114.2] | Loss=0.01623 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.133 | L2-Norm(final)=2.508 | 4100.3 samples/s | 64.1 steps/s
[Step=12100 Epoch=114.7] | Loss=0.00841 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.214 | L2-Norm(final)=2.496 | 5790.0 samples/s | 90.5 steps/s
[Step=12150 Epoch=115.1] | Loss=0.00562 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.237 | L2-Norm(final)=2.494 | 1989.8 samples/s | 31.1 steps/s
[Step=12200 Epoch=115.6] | Loss=0.00422 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.242 | L2-Norm(final)=2.493 | 5412.3 samples/s | 84.6 steps/s
[Step=12250 Epoch=116.1] | Loss=0.00338 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.241 | L2-Norm(final)=2.493 | 2008.7 samples/s | 31.4 steps/s
[Step=12300 Epoch=116.6] | Loss=0.00282 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.237 | L2-Norm(final)=2.494 | 4896.7 samples/s | 76.5 steps/s
[Step=12350 Epoch=117.0] | Loss=0.00242 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.231 | L2-Norm(final)=2.495 | 2079.4 samples/s | 32.5 steps/s
[Step=12400 Epoch=117.5] | Loss=0.00212 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.224 | L2-Norm(final)=2.497 | 4558.2 samples/s | 71.2 steps/s
[Step=12450 Epoch=118.0] | Loss=0.00189 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.217 | L2-Norm(final)=2.499 | 2168.3 samples/s | 33.9 steps/s
[Step=12500 Epoch=118.4] | Loss=0.00170 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.209 | L2-Norm(final)=2.501 | 4268.7 samples/s | 66.7 steps/s
[Step=12550 Epoch=118.9] | Loss=0.00155 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.201 | L2-Norm(final)=2.503 | 2208.9 samples/s | 34.5 steps/s
[Step=12600 Epoch=119.4] | Loss=0.00142 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.192 | L2-Norm(final)=2.506 | 4308.7 samples/s | 67.3 steps/s
[Step=12650 Epoch=119.9] | Loss=0.00131 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.183 | L2-Norm(final)=2.509 | 2229.7 samples/s | 34.8 steps/s
[Step=12700 Epoch=120.3] | Loss=0.00122 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.175 | L2-Norm(final)=2.512 | 4251.0 samples/s | 66.4 steps/s
[Step=12750 Epoch=120.8] | Loss=0.00114 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.166 | L2-Norm(final)=2.516 | 2258.0 samples/s | 35.3 steps/s
[Step=12800 Epoch=121.3] | Loss=0.00107 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.156 | L2-Norm(final)=2.519 | 4221.9 samples/s | 66.0 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step12800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.47103 | acc=0.7776 | tpr=0.6934 | fpr=0.0396 | 4162.9 samples/s | 16.3 steps/s
Avg test loss: 0.47958, Avg test acc: 0.77538, Avg tpr: 0.68998, Avg fpr: 0.03679, total FA: 287

Testing server on iccad2012
[Step=  50] | Loss=0.31427 | acc=0.8906 | tpr=0.8938 | fpr=0.1094 | 4106.0 samples/s | 16.0 steps/s
[Step= 100] | Loss=0.32156 | acc=0.8867 | tpr=0.9126 | fpr=0.1138 | 7457.4 samples/s | 29.1 steps/s
[Step= 150] | Loss=0.32406 | acc=0.8872 | tpr=0.9193 | fpr=0.1134 | 7346.8 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.32570 | acc=0.8873 | tpr=0.9257 | fpr=0.1134 | 7485.8 samples/s | 29.2 steps/s
[Step= 250] | Loss=0.32380 | acc=0.8874 | tpr=0.9258 | fpr=0.1133 | 7691.8 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.32566 | acc=0.8873 | tpr=0.9265 | fpr=0.1134 | 7386.1 samples/s | 28.9 steps/s
[Step= 350] | Loss=0.32745 | acc=0.8873 | tpr=0.9255 | fpr=0.1134 | 7513.1 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.32910 | acc=0.8872 | tpr=0.9289 | fpr=0.1136 | 7557.0 samples/s | 29.5 steps/s
[Step= 450] | Loss=0.33169 | acc=0.8872 | tpr=0.9304 | fpr=0.1136 | 7543.2 samples/s | 29.5 steps/s
[Step= 500] | Loss=0.33051 | acc=0.8873 | tpr=0.9339 | fpr=0.1135 | 8363.3 samples/s | 32.7 steps/s
[Step= 550] | Loss=0.32980 | acc=0.8872 | tpr=0.9347 | fpr=0.1137 | 12360.1 samples/s | 48.3 steps/s
Avg test loss: 0.32925, Avg test acc: 0.88721, Avg tpr: 0.93463, Avg fpr: 0.11366, total FA: 15781

server round 16/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=62.4] | Loss=0.19296 | Reg=0.00197 | acc=0.8906 | L2-Norm=14.018 | L2-Norm(final)=2.552 | 5046.2 samples/s | 78.8 steps/s
[Step=12850 Epoch=62.7] | Loss=0.02515 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.119 | L2-Norm(final)=2.541 | 4323.0 samples/s | 67.5 steps/s
[Step=12900 Epoch=62.9] | Loss=0.01551 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.155 | L2-Norm(final)=2.548 | 4502.1 samples/s | 70.3 steps/s
[Step=12950 Epoch=63.1] | Loss=0.01281 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.173 | L2-Norm(final)=2.554 | 4511.9 samples/s | 70.5 steps/s
[Step=13000 Epoch=63.4] | Loss=0.01110 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.186 | L2-Norm(final)=2.558 | 6005.0 samples/s | 93.8 steps/s
[Step=13050 Epoch=63.6] | Loss=0.00965 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.196 | L2-Norm(final)=2.563 | 2022.1 samples/s | 31.6 steps/s
[Step=13100 Epoch=63.9] | Loss=0.00895 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.204 | L2-Norm(final)=2.567 | 4588.4 samples/s | 71.7 steps/s
[Step=13150 Epoch=64.1] | Loss=0.00814 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.209 | L2-Norm(final)=2.571 | 4568.8 samples/s | 71.4 steps/s
[Step=13200 Epoch=64.4] | Loss=0.00782 | Reg=0.00202 | acc=0.9844 | L2-Norm=14.213 | L2-Norm(final)=2.574 | 5605.4 samples/s | 87.6 steps/s
[Step=13250 Epoch=64.6] | Loss=0.00752 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.217 | L2-Norm(final)=2.577 | 2074.0 samples/s | 32.4 steps/s
[Step=13300 Epoch=64.9] | Loss=0.00726 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.220 | L2-Norm(final)=2.579 | 4575.6 samples/s | 71.5 steps/s
[Step=13350 Epoch=65.1] | Loss=0.00685 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.223 | L2-Norm(final)=2.581 | 4581.6 samples/s | 71.6 steps/s
[Step=13400 Epoch=65.3] | Loss=0.00663 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.226 | L2-Norm(final)=2.584 | 5347.1 samples/s | 83.5 steps/s
[Step=13450 Epoch=65.6] | Loss=0.00625 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.228 | L2-Norm(final)=2.586 | 2172.3 samples/s | 33.9 steps/s
[Step=13500 Epoch=65.8] | Loss=0.00601 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.229 | L2-Norm(final)=2.589 | 4379.8 samples/s | 68.4 steps/s
[Step=13550 Epoch=66.1] | Loss=0.00590 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.230 | L2-Norm(final)=2.591 | 4389.8 samples/s | 68.6 steps/s
[Step=13600 Epoch=66.3] | Loss=0.00579 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.231 | L2-Norm(final)=2.593 | 4845.8 samples/s | 75.7 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step13600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=12801 Epoch=121.3] | Loss=0.04745 | Reg=0.00197 | acc=0.9688 | L2-Norm=14.018 | L2-Norm(final)=2.552 | 4439.4 samples/s | 69.4 steps/s
[Step=12850 Epoch=121.8] | Loss=0.00166 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.101 | L2-Norm(final)=2.553 | 4008.1 samples/s | 62.6 steps/s
[Step=12900 Epoch=122.2] | Loss=0.00085 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.108 | L2-Norm(final)=2.555 | 5823.4 samples/s | 91.0 steps/s
[Step=12950 Epoch=122.7] | Loss=0.00057 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.102 | L2-Norm(final)=2.557 | 1984.9 samples/s | 31.0 steps/s
[Step=13000 Epoch=123.2] | Loss=0.00043 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=2.558 | 5437.9 samples/s | 85.0 steps/s
[Step=13050 Epoch=123.7] | Loss=0.00035 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.084 | L2-Norm(final)=2.559 | 2046.5 samples/s | 32.0 steps/s
[Step=13100 Epoch=124.1] | Loss=0.00029 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.073 | L2-Norm(final)=2.561 | 5017.7 samples/s | 78.4 steps/s
[Step=13150 Epoch=124.6] | Loss=0.00025 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.063 | L2-Norm(final)=2.562 | 2096.0 samples/s | 32.7 steps/s
[Step=13200 Epoch=125.1] | Loss=0.00022 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.052 | L2-Norm(final)=2.562 | 4522.1 samples/s | 70.7 steps/s
[Step=13250 Epoch=125.6] | Loss=0.00020 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.042 | L2-Norm(final)=2.563 | 2128.4 samples/s | 33.3 steps/s
[Step=13300 Epoch=126.0] | Loss=0.00018 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.031 | L2-Norm(final)=2.564 | 4409.6 samples/s | 68.9 steps/s
[Step=13350 Epoch=126.5] | Loss=0.00016 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.020 | L2-Norm(final)=2.565 | 2187.7 samples/s | 34.2 steps/s
[Step=13400 Epoch=127.0] | Loss=0.00015 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.009 | L2-Norm(final)=2.566 | 4334.4 samples/s | 67.7 steps/s
[Step=13450 Epoch=127.5] | Loss=0.00014 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.998 | L2-Norm(final)=2.567 | 2254.4 samples/s | 35.2 steps/s
[Step=13500 Epoch=127.9] | Loss=0.00013 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.988 | L2-Norm(final)=2.567 | 4249.3 samples/s | 66.4 steps/s
[Step=13550 Epoch=128.4] | Loss=0.00012 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.977 | L2-Norm(final)=2.568 | 2233.6 samples/s | 34.9 steps/s
[Step=13600 Epoch=128.9] | Loss=0.00011 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.965 | L2-Norm(final)=2.569 | 4208.0 samples/s | 65.7 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step13600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38959 | acc=0.8226 | tpr=0.7590 | fpr=0.0394 | 4057.5 samples/s | 15.8 steps/s
Avg test loss: 0.40602, Avg test acc: 0.81962, Avg tpr: 0.75561, Avg fpr: 0.03961, total FA: 309

Testing server on iccad2012
[Step=  50] | Loss=0.41566 | acc=0.8502 | tpr=0.8982 | fpr=0.1507 | 4237.0 samples/s | 16.6 steps/s
[Step= 100] | Loss=0.42557 | acc=0.8452 | tpr=0.9147 | fpr=0.1561 | 7480.6 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.42695 | acc=0.8462 | tpr=0.9222 | fpr=0.1552 | 7611.0 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.43076 | acc=0.8455 | tpr=0.9268 | fpr=0.1559 | 6057.2 samples/s | 23.7 steps/s
[Step= 250] | Loss=0.42872 | acc=0.8453 | tpr=0.9284 | fpr=0.1562 | 7740.4 samples/s | 30.2 steps/s
[Step= 300] | Loss=0.43044 | acc=0.8446 | tpr=0.9273 | fpr=0.1569 | 7547.1 samples/s | 29.5 steps/s
[Step= 350] | Loss=0.43128 | acc=0.8448 | tpr=0.9261 | fpr=0.1567 | 7526.7 samples/s | 29.4 steps/s
[Step= 400] | Loss=0.43333 | acc=0.8443 | tpr=0.9300 | fpr=0.1572 | 5549.7 samples/s | 21.7 steps/s
[Step= 450] | Loss=0.43567 | acc=0.8445 | tpr=0.9318 | fpr=0.1571 | 7632.3 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.43446 | acc=0.8445 | tpr=0.9344 | fpr=0.1572 | 7890.5 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.43342 | acc=0.8444 | tpr=0.9335 | fpr=0.1572 | 14382.0 samples/s | 56.2 steps/s
Avg test loss: 0.43291, Avg test acc: 0.84440, Avg tpr: 0.93344, Avg fpr: 0.15722, total FA: 21829

server round 17/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=66.3] | Loss=0.16514 | Reg=0.00194 | acc=0.8594 | L2-Norm=13.932 | L2-Norm(final)=2.597 | 4721.3 samples/s | 73.8 steps/s
[Step=13650 Epoch=66.6] | Loss=0.01446 | Reg=0.00196 | acc=0.9844 | L2-Norm=14.004 | L2-Norm(final)=2.592 | 4468.9 samples/s | 69.8 steps/s
[Step=13700 Epoch=66.8] | Loss=0.00917 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.028 | L2-Norm(final)=2.595 | 4410.9 samples/s | 68.9 steps/s
[Step=13750 Epoch=67.0] | Loss=0.00761 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.043 | L2-Norm(final)=2.601 | 4330.5 samples/s | 67.7 steps/s
[Step=13800 Epoch=67.3] | Loss=0.00722 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.050 | L2-Norm(final)=2.604 | 6168.1 samples/s | 96.4 steps/s
[Step=13850 Epoch=67.5] | Loss=0.00629 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.055 | L2-Norm(final)=2.607 | 2090.5 samples/s | 32.7 steps/s
[Step=13900 Epoch=67.8] | Loss=0.00592 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.059 | L2-Norm(final)=2.610 | 4471.4 samples/s | 69.9 steps/s
[Step=13950 Epoch=68.0] | Loss=0.00582 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.062 | L2-Norm(final)=2.613 | 4552.3 samples/s | 71.1 steps/s
[Step=14000 Epoch=68.3] | Loss=0.00594 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.065 | L2-Norm(final)=2.615 | 5602.8 samples/s | 87.5 steps/s
[Step=14050 Epoch=68.5] | Loss=0.00567 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.068 | L2-Norm(final)=2.616 | 2113.7 samples/s | 33.0 steps/s
[Step=14100 Epoch=68.8] | Loss=0.00557 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.070 | L2-Norm(final)=2.618 | 4577.6 samples/s | 71.5 steps/s
[Step=14150 Epoch=69.0] | Loss=0.00534 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.071 | L2-Norm(final)=2.619 | 4576.2 samples/s | 71.5 steps/s
[Step=14200 Epoch=69.2] | Loss=0.00514 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.072 | L2-Norm(final)=2.621 | 5204.3 samples/s | 81.3 steps/s
[Step=14250 Epoch=69.5] | Loss=0.00492 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.074 | L2-Norm(final)=2.623 | 2146.5 samples/s | 33.5 steps/s
[Step=14300 Epoch=69.7] | Loss=0.00481 | Reg=0.00198 | acc=0.9844 | L2-Norm=14.074 | L2-Norm(final)=2.626 | 4523.4 samples/s | 70.7 steps/s
[Step=14350 Epoch=70.0] | Loss=0.00500 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.075 | L2-Norm(final)=2.627 | 4558.2 samples/s | 71.2 steps/s
[Step=14400 Epoch=70.2] | Loss=0.00485 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.075 | L2-Norm(final)=2.628 | 4972.6 samples/s | 77.7 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step14400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=13601 Epoch=128.9] | Loss=0.08761 | Reg=0.00194 | acc=0.9375 | L2-Norm=13.932 | L2-Norm(final)=2.596 | 4967.5 samples/s | 77.6 steps/s
[Step=13650 Epoch=129.3] | Loss=0.00799 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.090 | L2-Norm(final)=2.579 | 4006.8 samples/s | 62.6 steps/s
[Step=13700 Epoch=129.8] | Loss=0.00462 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.140 | L2-Norm(final)=2.574 | 5856.6 samples/s | 91.5 steps/s
[Step=13750 Epoch=130.3] | Loss=0.00332 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.155 | L2-Norm(final)=2.574 | 1987.2 samples/s | 31.0 steps/s
[Step=13800 Epoch=130.8] | Loss=0.00250 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.159 | L2-Norm(final)=2.574 | 5388.1 samples/s | 84.2 steps/s
[Step=13850 Epoch=131.2] | Loss=0.00200 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.158 | L2-Norm(final)=2.575 | 1998.8 samples/s | 31.2 steps/s
[Step=13900 Epoch=131.7] | Loss=0.00167 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.154 | L2-Norm(final)=2.576 | 5080.1 samples/s | 79.4 steps/s
[Step=13950 Epoch=132.2] | Loss=0.00143 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.148 | L2-Norm(final)=2.577 | 2089.3 samples/s | 32.6 steps/s
[Step=14000 Epoch=132.7] | Loss=0.00125 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.141 | L2-Norm(final)=2.579 | 4721.4 samples/s | 73.8 steps/s
[Step=14050 Epoch=133.1] | Loss=0.00111 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.134 | L2-Norm(final)=2.581 | 2143.1 samples/s | 33.5 steps/s
[Step=14100 Epoch=133.6] | Loss=0.00100 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.126 | L2-Norm(final)=2.584 | 4462.5 samples/s | 69.7 steps/s
[Step=14150 Epoch=134.1] | Loss=0.00091 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.118 | L2-Norm(final)=2.587 | 2199.8 samples/s | 34.4 steps/s
[Step=14200 Epoch=134.6] | Loss=0.00084 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.110 | L2-Norm(final)=2.590 | 4382.4 samples/s | 68.5 steps/s
[Step=14250 Epoch=135.0] | Loss=0.00077 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.101 | L2-Norm(final)=2.593 | 2244.3 samples/s | 35.1 steps/s
[Step=14300 Epoch=135.5] | Loss=0.00072 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.093 | L2-Norm(final)=2.596 | 4232.0 samples/s | 66.1 steps/s
[Step=14350 Epoch=136.0] | Loss=0.00067 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.084 | L2-Norm(final)=2.600 | 2262.9 samples/s | 35.4 steps/s
[Step=14400 Epoch=136.5] | Loss=0.00063 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.075 | L2-Norm(final)=2.603 | 4322.4 samples/s | 67.5 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step14400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.54217 | acc=0.7526 | tpr=0.6581 | fpr=0.0424 | 4327.5 samples/s | 16.9 steps/s
Avg test loss: 0.55364, Avg test acc: 0.74978, Avg tpr: 0.65449, Avg fpr: 0.04064, total FA: 317

Testing server on iccad2012
[Step=  50] | Loss=0.28787 | acc=0.9102 | tpr=0.9159 | fpr=0.0899 | 4124.7 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.29229 | acc=0.9102 | tpr=0.9296 | fpr=0.0901 | 7200.8 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.29819 | acc=0.9103 | tpr=0.9265 | fpr=0.0900 | 4787.2 samples/s | 18.7 steps/s
[Step= 200] | Loss=0.30119 | acc=0.9101 | tpr=0.9290 | fpr=0.0902 | 6995.9 samples/s | 27.3 steps/s
[Step= 250] | Loss=0.29762 | acc=0.9102 | tpr=0.9301 | fpr=0.0902 | 7563.2 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.29984 | acc=0.9101 | tpr=0.9295 | fpr=0.0902 | 7285.0 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.30203 | acc=0.9100 | tpr=0.9299 | fpr=0.0904 | 7742.6 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.30368 | acc=0.9096 | tpr=0.9327 | fpr=0.0908 | 7450.5 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.30668 | acc=0.9092 | tpr=0.9333 | fpr=0.0912 | 7707.4 samples/s | 30.1 steps/s
[Step= 500] | Loss=0.30506 | acc=0.9095 | tpr=0.9366 | fpr=0.0910 | 7594.2 samples/s | 29.7 steps/s
[Step= 550] | Loss=0.30419 | acc=0.9095 | tpr=0.9359 | fpr=0.0910 | 12813.8 samples/s | 50.1 steps/s
Avg test loss: 0.30359, Avg test acc: 0.90959, Avg tpr: 0.93621, Avg fpr: 0.09089, total FA: 12620

server round 18/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=70.2] | Loss=0.26895 | Reg=0.00193 | acc=0.8438 | L2-Norm=13.908 | L2-Norm(final)=2.634 | 4909.9 samples/s | 76.7 steps/s
[Step=14450 Epoch=70.5] | Loss=0.02747 | Reg=0.00197 | acc=0.9844 | L2-Norm=14.028 | L2-Norm(final)=2.617 | 4416.6 samples/s | 69.0 steps/s
[Step=14500 Epoch=70.7] | Loss=0.01727 | Reg=0.00198 | acc=1.0000 | L2-Norm=14.073 | L2-Norm(final)=2.619 | 4549.1 samples/s | 71.1 steps/s
[Step=14550 Epoch=70.9] | Loss=0.01491 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.099 | L2-Norm(final)=2.623 | 4549.9 samples/s | 71.1 steps/s
[Step=14600 Epoch=71.2] | Loss=0.01391 | Reg=0.00199 | acc=1.0000 | L2-Norm=14.121 | L2-Norm(final)=2.625 | 6119.5 samples/s | 95.6 steps/s
[Step=14650 Epoch=71.4] | Loss=0.01259 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.138 | L2-Norm(final)=2.625 | 2066.1 samples/s | 32.3 steps/s
[Step=14700 Epoch=71.7] | Loss=0.01208 | Reg=0.00200 | acc=1.0000 | L2-Norm=14.153 | L2-Norm(final)=2.626 | 4546.3 samples/s | 71.0 steps/s
[Step=14750 Epoch=71.9] | Loss=0.01104 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.167 | L2-Norm(final)=2.628 | 4536.1 samples/s | 70.9 steps/s
[Step=14800 Epoch=72.2] | Loss=0.01074 | Reg=0.00201 | acc=0.9688 | L2-Norm=14.180 | L2-Norm(final)=2.629 | 5610.3 samples/s | 87.7 steps/s
[Step=14850 Epoch=72.4] | Loss=0.01021 | Reg=0.00201 | acc=1.0000 | L2-Norm=14.192 | L2-Norm(final)=2.631 | 2109.6 samples/s | 33.0 steps/s
[Step=14900 Epoch=72.7] | Loss=0.00953 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.202 | L2-Norm(final)=2.633 | 4390.7 samples/s | 68.6 steps/s
[Step=14950 Epoch=72.9] | Loss=0.00930 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.211 | L2-Norm(final)=2.635 | 4465.3 samples/s | 69.8 steps/s
[Step=15000 Epoch=73.1] | Loss=0.00887 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.219 | L2-Norm(final)=2.637 | 5254.5 samples/s | 82.1 steps/s
[Step=15050 Epoch=73.4] | Loss=0.00842 | Reg=0.00202 | acc=1.0000 | L2-Norm=14.226 | L2-Norm(final)=2.639 | 2177.9 samples/s | 34.0 steps/s
[Step=15100 Epoch=73.6] | Loss=0.00805 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.233 | L2-Norm(final)=2.641 | 4551.0 samples/s | 71.1 steps/s
[Step=15150 Epoch=73.9] | Loss=0.00777 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.239 | L2-Norm(final)=2.643 | 4574.0 samples/s | 71.5 steps/s
[Step=15200 Epoch=74.1] | Loss=0.00748 | Reg=0.00203 | acc=1.0000 | L2-Norm=14.244 | L2-Norm(final)=2.645 | 4864.3 samples/s | 76.0 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step15200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=14401 Epoch=136.5] | Loss=0.00290 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.908 | L2-Norm(final)=2.635 | 4782.9 samples/s | 74.7 steps/s
[Step=14450 Epoch=136.9] | Loss=0.00120 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.969 | L2-Norm(final)=2.636 | 4012.1 samples/s | 62.7 steps/s
[Step=14500 Epoch=137.4] | Loss=0.00061 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.971 | L2-Norm(final)=2.637 | 5784.3 samples/s | 90.4 steps/s
[Step=14550 Epoch=137.9] | Loss=0.00041 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.963 | L2-Norm(final)=2.638 | 1987.8 samples/s | 31.1 steps/s
[Step=14600 Epoch=138.3] | Loss=0.00031 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.954 | L2-Norm(final)=2.639 | 5121.1 samples/s | 80.0 steps/s
[Step=14650 Epoch=138.8] | Loss=0.00025 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.944 | L2-Norm(final)=2.640 | 2031.4 samples/s | 31.7 steps/s
[Step=14700 Epoch=139.3] | Loss=0.00021 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.934 | L2-Norm(final)=2.642 | 5022.0 samples/s | 78.5 steps/s
[Step=14750 Epoch=139.8] | Loss=0.00018 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.923 | L2-Norm(final)=2.645 | 2130.8 samples/s | 33.3 steps/s
[Step=14800 Epoch=140.2] | Loss=0.00016 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.913 | L2-Norm(final)=2.648 | 4704.1 samples/s | 73.5 steps/s
[Step=14850 Epoch=140.7] | Loss=0.00014 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.903 | L2-Norm(final)=2.652 | 2176.7 samples/s | 34.0 steps/s
[Step=14900 Epoch=141.2] | Loss=0.00013 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.892 | L2-Norm(final)=2.656 | 4455.5 samples/s | 69.6 steps/s
[Step=14950 Epoch=141.7] | Loss=0.00012 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.882 | L2-Norm(final)=2.661 | 1401.6 samples/s | 21.9 steps/s
[Step=15000 Epoch=142.1] | Loss=0.00011 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.871 | L2-Norm(final)=2.666 | 4312.5 samples/s | 67.4 steps/s
[Step=15050 Epoch=142.6] | Loss=0.00010 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.860 | L2-Norm(final)=2.671 | 2226.1 samples/s | 34.8 steps/s
[Step=15100 Epoch=143.1] | Loss=0.00009 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.849 | L2-Norm(final)=2.676 | 4341.8 samples/s | 67.8 steps/s
[Step=15150 Epoch=143.6] | Loss=0.00009 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.838 | L2-Norm(final)=2.681 | 2233.6 samples/s | 34.9 steps/s
[Step=15200 Epoch=144.0] | Loss=0.00008 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.827 | L2-Norm(final)=2.686 | 4387.9 samples/s | 68.6 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step15200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32938 | acc=0.8518 | tpr=0.8084 | fpr=0.0540 | 4250.0 samples/s | 16.6 steps/s
Avg test loss: 0.33970, Avg test acc: 0.85175, Avg tpr: 0.80830, Avg fpr: 0.05269, total FA: 411

Testing server on iccad2012
[Step=  50] | Loss=0.49161 | acc=0.8250 | tpr=0.9159 | fpr=0.1766 | 4264.5 samples/s | 16.7 steps/s
[Step= 100] | Loss=0.50035 | acc=0.8218 | tpr=0.9232 | fpr=0.1801 | 7536.9 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.50545 | acc=0.8211 | tpr=0.9280 | fpr=0.1808 | 7755.8 samples/s | 30.3 steps/s
[Step= 200] | Loss=0.50961 | acc=0.8214 | tpr=0.9311 | fpr=0.1806 | 7529.9 samples/s | 29.4 steps/s
[Step= 250] | Loss=0.50778 | acc=0.8216 | tpr=0.9310 | fpr=0.1804 | 7579.5 samples/s | 29.6 steps/s
[Step= 300] | Loss=0.50910 | acc=0.8217 | tpr=0.9309 | fpr=0.1803 | 7566.5 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.51003 | acc=0.8222 | tpr=0.9317 | fpr=0.1798 | 7615.7 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.51129 | acc=0.8219 | tpr=0.9349 | fpr=0.1802 | 7786.0 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.51377 | acc=0.8219 | tpr=0.9357 | fpr=0.1802 | 7629.0 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.51249 | acc=0.8220 | tpr=0.9374 | fpr=0.1801 | 7634.1 samples/s | 29.8 steps/s
[Step= 550] | Loss=0.51120 | acc=0.8221 | tpr=0.9383 | fpr=0.1800 | 13542.1 samples/s | 52.9 steps/s
Avg test loss: 0.51041, Avg test acc: 0.82218, Avg tpr: 0.93859, Avg fpr: 0.17994, total FA: 24984

server round 19/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=74.1] | Loss=0.11433 | Reg=0.00193 | acc=0.9062 | L2-Norm=13.893 | L2-Norm(final)=2.701 | 4990.6 samples/s | 78.0 steps/s
[Step=15250 Epoch=74.4] | Loss=0.01177 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.969 | L2-Norm(final)=2.701 | 4005.5 samples/s | 62.6 steps/s
[Step=15300 Epoch=74.6] | Loss=0.00763 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.993 | L2-Norm(final)=2.706 | 4551.2 samples/s | 71.1 steps/s
[Step=15350 Epoch=74.8] | Loss=0.00621 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.002 | L2-Norm(final)=2.710 | 4533.1 samples/s | 70.8 steps/s
[Step=15400 Epoch=75.1] | Loss=0.00620 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.006 | L2-Norm(final)=2.712 | 6064.2 samples/s | 94.8 steps/s
[Step=15450 Epoch=75.3] | Loss=0.00546 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.008 | L2-Norm(final)=2.713 | 2068.3 samples/s | 32.3 steps/s
[Step=15500 Epoch=75.6] | Loss=0.00519 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.009 | L2-Norm(final)=2.716 | 4474.7 samples/s | 69.9 steps/s
[Step=15550 Epoch=75.8] | Loss=0.00477 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.009 | L2-Norm(final)=2.718 | 4515.2 samples/s | 70.5 steps/s
[Step=15600 Epoch=76.1] | Loss=0.00463 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.009 | L2-Norm(final)=2.720 | 5621.4 samples/s | 87.8 steps/s
[Step=15650 Epoch=76.3] | Loss=0.00441 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.009 | L2-Norm(final)=2.721 | 2089.8 samples/s | 32.7 steps/s
[Step=15700 Epoch=76.6] | Loss=0.00419 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.009 | L2-Norm(final)=2.723 | 4398.6 samples/s | 68.7 steps/s
[Step=15750 Epoch=76.8] | Loss=0.00407 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.009 | L2-Norm(final)=2.725 | 4412.6 samples/s | 68.9 steps/s
[Step=15800 Epoch=77.0] | Loss=0.00391 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.009 | L2-Norm(final)=2.727 | 5283.0 samples/s | 82.5 steps/s
[Step=15850 Epoch=77.3] | Loss=0.00385 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.008 | L2-Norm(final)=2.729 | 2172.3 samples/s | 33.9 steps/s
[Step=15900 Epoch=77.5] | Loss=0.00377 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.008 | L2-Norm(final)=2.731 | 4492.5 samples/s | 70.2 steps/s
[Step=15950 Epoch=77.8] | Loss=0.00369 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.007 | L2-Norm(final)=2.733 | 4481.0 samples/s | 70.0 steps/s
[Step=16000 Epoch=78.0] | Loss=0.00359 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.006 | L2-Norm(final)=2.735 | 4986.3 samples/s | 77.9 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step16000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00050, len=1
[Step=15201 Epoch=144.0] | Loss=0.07801 | Reg=0.00193 | acc=0.9844 | L2-Norm=13.893 | L2-Norm(final)=2.699 | 5235.9 samples/s | 81.8 steps/s
[Step=15250 Epoch=144.5] | Loss=0.00365 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.026 | L2-Norm(final)=2.689 | 3752.4 samples/s | 58.6 steps/s
[Step=15300 Epoch=145.0] | Loss=0.00184 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.049 | L2-Norm(final)=2.691 | 5491.4 samples/s | 85.8 steps/s
[Step=15350 Epoch=145.5] | Loss=0.00123 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.047 | L2-Norm(final)=2.694 | 1954.0 samples/s | 30.5 steps/s
[Step=15400 Epoch=145.9] | Loss=0.00093 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.039 | L2-Norm(final)=2.697 | 5384.4 samples/s | 84.1 steps/s
[Step=15450 Epoch=146.4] | Loss=0.00074 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.029 | L2-Norm(final)=2.700 | 1985.8 samples/s | 31.0 steps/s
[Step=15500 Epoch=146.9] | Loss=0.00062 | Reg=0.00197 | acc=1.0000 | L2-Norm=14.018 | L2-Norm(final)=2.702 | 4927.5 samples/s | 77.0 steps/s
[Step=15550 Epoch=147.3] | Loss=0.00053 | Reg=0.00196 | acc=1.0000 | L2-Norm=14.007 | L2-Norm(final)=2.705 | 2083.1 samples/s | 32.5 steps/s
[Step=15600 Epoch=147.8] | Loss=0.00047 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.995 | L2-Norm(final)=2.708 | 4604.6 samples/s | 71.9 steps/s
[Step=15650 Epoch=148.3] | Loss=0.00042 | Reg=0.00196 | acc=1.0000 | L2-Norm=13.983 | L2-Norm(final)=2.710 | 2154.8 samples/s | 33.7 steps/s
[Step=15700 Epoch=148.8] | Loss=0.00037 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.970 | L2-Norm(final)=2.712 | 4262.3 samples/s | 66.6 steps/s
[Step=15750 Epoch=149.2] | Loss=0.00034 | Reg=0.00195 | acc=1.0000 | L2-Norm=13.958 | L2-Norm(final)=2.715 | 2199.8 samples/s | 34.4 steps/s
[Step=15800 Epoch=149.7] | Loss=0.00031 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.945 | L2-Norm(final)=2.718 | 4072.9 samples/s | 63.6 steps/s
[Step=15850 Epoch=150.2] | Loss=0.00029 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.933 | L2-Norm(final)=2.721 | 2225.6 samples/s | 34.8 steps/s
[Step=15900 Epoch=150.7] | Loss=0.00027 | Reg=0.00194 | acc=1.0000 | L2-Norm=13.920 | L2-Norm(final)=2.724 | 4264.4 samples/s | 66.6 steps/s
[Step=15950 Epoch=151.1] | Loss=0.00025 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.907 | L2-Norm(final)=2.727 | 2244.5 samples/s | 35.1 steps/s
[Step=16000 Epoch=151.6] | Loss=0.00024 | Reg=0.00193 | acc=1.0000 | L2-Norm=13.895 | L2-Norm(final)=2.730 | 4341.5 samples/s | 67.8 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step16000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.51797 | acc=0.7725 | tpr=0.6843 | fpr=0.0359 | 4146.5 samples/s | 16.2 steps/s
Avg test loss: 0.52941, Avg test acc: 0.76817, Avg tpr: 0.67937, Avg fpr: 0.03653, total FA: 285

Testing server on iccad2012
[Step=  50] | Loss=0.31225 | acc=0.9051 | tpr=0.8938 | fpr=0.0947 | 4210.6 samples/s | 16.4 steps/s
[Step= 100] | Loss=0.32080 | acc=0.9018 | tpr=0.9062 | fpr=0.0983 | 7627.8 samples/s | 29.8 steps/s
[Step= 150] | Loss=0.32347 | acc=0.9021 | tpr=0.9121 | fpr=0.0981 | 7973.8 samples/s | 31.1 steps/s
[Step= 200] | Loss=0.32932 | acc=0.9014 | tpr=0.9180 | fpr=0.0989 | 7749.6 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.32652 | acc=0.9015 | tpr=0.9170 | fpr=0.0988 | 7621.2 samples/s | 29.8 steps/s
[Step= 300] | Loss=0.32940 | acc=0.9013 | tpr=0.9164 | fpr=0.0990 | 7793.3 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.33159 | acc=0.9010 | tpr=0.9155 | fpr=0.0992 | 7596.6 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.33311 | acc=0.9007 | tpr=0.9185 | fpr=0.0996 | 7453.7 samples/s | 29.1 steps/s
[Step= 450] | Loss=0.33580 | acc=0.9006 | tpr=0.9206 | fpr=0.0998 | 7637.0 samples/s | 29.8 steps/s
[Step= 500] | Loss=0.33438 | acc=0.9006 | tpr=0.9233 | fpr=0.0998 | 7486.5 samples/s | 29.2 steps/s
[Step= 550] | Loss=0.33274 | acc=0.9007 | tpr=0.9236 | fpr=0.0997 | 14033.9 samples/s | 54.8 steps/s
Avg test loss: 0.33208, Avg test acc: 0.90081, Avg tpr: 0.92393, Avg fpr: 0.09961, total FA: 13830

server round 20/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=78.0] | Loss=0.14176 | Reg=0.00189 | acc=0.8906 | L2-Norm=13.762 | L2-Norm(final)=2.760 | 4765.1 samples/s | 74.5 steps/s
[Step=16050 Epoch=78.3] | Loss=0.01480 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.812 | L2-Norm(final)=2.760 | 4457.8 samples/s | 69.7 steps/s
[Step=16100 Epoch=78.5] | Loss=0.00876 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.826 | L2-Norm(final)=2.763 | 4518.8 samples/s | 70.6 steps/s
[Step=16150 Epoch=78.8] | Loss=0.00680 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.831 | L2-Norm(final)=2.767 | 4488.1 samples/s | 70.1 steps/s
[Step=16200 Epoch=79.0] | Loss=0.00602 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.835 | L2-Norm(final)=2.771 | 6034.8 samples/s | 94.3 steps/s
[Step=16250 Epoch=79.2] | Loss=0.00541 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.836 | L2-Norm(final)=2.773 | 2047.1 samples/s | 32.0 steps/s
[Step=16300 Epoch=79.5] | Loss=0.00497 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.838 | L2-Norm(final)=2.775 | 4487.6 samples/s | 70.1 steps/s
[Step=16350 Epoch=79.7] | Loss=0.00447 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.838 | L2-Norm(final)=2.777 | 4492.5 samples/s | 70.2 steps/s
[Step=16400 Epoch=80.0] | Loss=0.00416 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.839 | L2-Norm(final)=2.779 | 5641.5 samples/s | 88.1 steps/s
[Step=16450 Epoch=80.2] | Loss=0.00391 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.839 | L2-Norm(final)=2.781 | 2117.6 samples/s | 33.1 steps/s
[Step=16500 Epoch=80.5] | Loss=0.00368 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.839 | L2-Norm(final)=2.783 | 4542.1 samples/s | 71.0 steps/s
[Step=16550 Epoch=80.7] | Loss=0.00357 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.839 | L2-Norm(final)=2.785 | 4494.8 samples/s | 70.2 steps/s
[Step=16600 Epoch=80.9] | Loss=0.00343 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.839 | L2-Norm(final)=2.787 | 5219.3 samples/s | 81.6 steps/s
[Step=16650 Epoch=81.2] | Loss=0.00330 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.839 | L2-Norm(final)=2.788 | 2139.4 samples/s | 33.4 steps/s
[Step=16700 Epoch=81.4] | Loss=0.00323 | Reg=0.00192 | acc=1.0000 | L2-Norm=13.839 | L2-Norm(final)=2.790 | 4574.3 samples/s | 71.5 steps/s
[Step=16750 Epoch=81.7] | Loss=0.00325 | Reg=0.00191 | acc=0.9844 | L2-Norm=13.838 | L2-Norm(final)=2.791 | 4555.4 samples/s | 71.2 steps/s
[Step=16800 Epoch=81.9] | Loss=0.00319 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.838 | L2-Norm(final)=2.792 | 4823.3 samples/s | 75.4 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step16800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16001 Epoch=151.6] | Loss=0.00213 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.762 | L2-Norm(final)=2.760 | 4239.8 samples/s | 66.2 steps/s
[Step=16050 Epoch=152.1] | Loss=0.00131 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.799 | L2-Norm(final)=2.767 | 4044.3 samples/s | 63.2 steps/s
[Step=16100 Epoch=152.6] | Loss=0.00067 | Reg=0.00191 | acc=1.0000 | L2-Norm=13.803 | L2-Norm(final)=2.768 | 5892.1 samples/s | 92.1 steps/s
[Step=16150 Epoch=153.0] | Loss=0.00045 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.800 | L2-Norm(final)=2.769 | 1957.5 samples/s | 30.6 steps/s
[Step=16200 Epoch=153.5] | Loss=0.00034 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.795 | L2-Norm(final)=2.770 | 5447.9 samples/s | 85.1 steps/s
[Step=16250 Epoch=154.0] | Loss=0.00027 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.791 | L2-Norm(final)=2.771 | 2024.5 samples/s | 31.6 steps/s
[Step=16300 Epoch=154.5] | Loss=0.00023 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.786 | L2-Norm(final)=2.772 | 5051.7 samples/s | 78.9 steps/s
[Step=16350 Epoch=154.9] | Loss=0.00020 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.780 | L2-Norm(final)=2.772 | 2094.9 samples/s | 32.7 steps/s
[Step=16400 Epoch=155.4] | Loss=0.00017 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.774 | L2-Norm(final)=2.773 | 4691.1 samples/s | 73.3 steps/s
[Step=16450 Epoch=155.9] | Loss=0.00015 | Reg=0.00190 | acc=1.0000 | L2-Norm=13.768 | L2-Norm(final)=2.773 | 2156.2 samples/s | 33.7 steps/s
[Step=16500 Epoch=156.4] | Loss=0.00014 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.761 | L2-Norm(final)=2.773 | 4424.7 samples/s | 69.1 steps/s
[Step=16550 Epoch=156.8] | Loss=0.00013 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.754 | L2-Norm(final)=2.774 | 2208.7 samples/s | 34.5 steps/s
[Step=16600 Epoch=157.3] | Loss=0.00012 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.747 | L2-Norm(final)=2.774 | 4376.7 samples/s | 68.4 steps/s
[Step=16650 Epoch=157.8] | Loss=0.00011 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.740 | L2-Norm(final)=2.774 | 2202.6 samples/s | 34.4 steps/s
[Step=16700 Epoch=158.2] | Loss=0.00010 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.733 | L2-Norm(final)=2.775 | 4426.2 samples/s | 69.2 steps/s
[Step=16750 Epoch=158.7] | Loss=0.00009 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.726 | L2-Norm(final)=2.775 | 2245.2 samples/s | 35.1 steps/s
[Step=16800 Epoch=159.2] | Loss=0.00009 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.718 | L2-Norm(final)=2.775 | 4304.0 samples/s | 67.2 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step16800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.43067 | acc=0.8212 | tpr=0.7588 | fpr=0.0434 | 4266.4 samples/s | 16.7 steps/s
Avg test loss: 0.44687, Avg test acc: 0.81886, Avg tpr: 0.75544, Avg fpr: 0.04166, total FA: 325

Testing server on iccad2012
[Step=  50] | Loss=0.38208 | acc=0.8795 | tpr=0.9115 | fpr=0.1210 | 4218.9 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.39235 | acc=0.8778 | tpr=0.9147 | fpr=0.1229 | 7486.1 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.39557 | acc=0.8789 | tpr=0.9179 | fpr=0.1219 | 7714.7 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.40072 | acc=0.8784 | tpr=0.9224 | fpr=0.1224 | 7650.4 samples/s | 29.9 steps/s
[Step= 250] | Loss=0.39987 | acc=0.8776 | tpr=0.9205 | fpr=0.1232 | 7793.9 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.40182 | acc=0.8777 | tpr=0.9207 | fpr=0.1231 | 7360.6 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.40394 | acc=0.8780 | tpr=0.9205 | fpr=0.1228 | 7506.2 samples/s | 29.3 steps/s
[Step= 400] | Loss=0.40532 | acc=0.8774 | tpr=0.9240 | fpr=0.1235 | 7908.7 samples/s | 30.9 steps/s
[Step= 450] | Loss=0.40772 | acc=0.8775 | tpr=0.9245 | fpr=0.1234 | 7486.6 samples/s | 29.2 steps/s
[Step= 500] | Loss=0.40624 | acc=0.8775 | tpr=0.9269 | fpr=0.1233 | 7396.3 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.40467 | acc=0.8778 | tpr=0.9280 | fpr=0.1231 | 13428.2 samples/s | 52.5 steps/s
Avg test loss: 0.40389, Avg test acc: 0.87786, Avg tpr: 0.92829, Avg fpr: 0.12306, total FA: 17086

server round 21/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=81.9] | Loss=0.10389 | Reg=0.00187 | acc=0.9219 | L2-Norm=13.675 | L2-Norm(final)=2.793 | 4826.5 samples/s | 75.4 steps/s
[Step=16850 Epoch=82.2] | Loss=0.00886 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.711 | L2-Norm(final)=2.791 | 4230.6 samples/s | 66.1 steps/s
[Step=16900 Epoch=82.4] | Loss=0.00563 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.722 | L2-Norm(final)=2.793 | 4481.0 samples/s | 70.0 steps/s
[Step=16950 Epoch=82.7] | Loss=0.00461 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.727 | L2-Norm(final)=2.796 | 4551.5 samples/s | 71.1 steps/s
[Step=17000 Epoch=82.9] | Loss=0.00387 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.730 | L2-Norm(final)=2.799 | 6109.0 samples/s | 95.5 steps/s
[Step=17050 Epoch=83.1] | Loss=0.00350 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.731 | L2-Norm(final)=2.802 | 2042.2 samples/s | 31.9 steps/s
[Step=17100 Epoch=83.4] | Loss=0.00335 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.732 | L2-Norm(final)=2.803 | 4568.8 samples/s | 71.4 steps/s
[Step=17150 Epoch=83.6] | Loss=0.00313 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.733 | L2-Norm(final)=2.805 | 4581.6 samples/s | 71.6 steps/s
[Step=17200 Epoch=83.9] | Loss=0.00302 | Reg=0.00189 | acc=0.9844 | L2-Norm=13.733 | L2-Norm(final)=2.807 | 5735.2 samples/s | 89.6 steps/s
[Step=17250 Epoch=84.1] | Loss=0.00292 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.733 | L2-Norm(final)=2.809 | 2126.9 samples/s | 33.2 steps/s
[Step=17300 Epoch=84.4] | Loss=0.00273 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.733 | L2-Norm(final)=2.811 | 4401.5 samples/s | 68.8 steps/s
[Step=17350 Epoch=84.6] | Loss=0.00270 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.733 | L2-Norm(final)=2.813 | 4477.2 samples/s | 70.0 steps/s
[Step=17400 Epoch=84.8] | Loss=0.00269 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.733 | L2-Norm(final)=2.815 | 5296.1 samples/s | 82.8 steps/s
[Step=17450 Epoch=85.1] | Loss=0.00262 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.733 | L2-Norm(final)=2.817 | 2137.3 samples/s | 33.4 steps/s
[Step=17500 Epoch=85.3] | Loss=0.00253 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.733 | L2-Norm(final)=2.818 | 4538.9 samples/s | 70.9 steps/s
[Step=17550 Epoch=85.6] | Loss=0.00248 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.732 | L2-Norm(final)=2.820 | 4439.5 samples/s | 69.4 steps/s
[Step=17600 Epoch=85.8] | Loss=0.00250 | Reg=0.00189 | acc=1.0000 | L2-Norm=13.732 | L2-Norm(final)=2.821 | 4972.3 samples/s | 77.7 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step17600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=16801 Epoch=159.2] | Loss=0.04785 | Reg=0.00187 | acc=0.9375 | L2-Norm=13.675 | L2-Norm(final)=2.793 | 4548.3 samples/s | 71.1 steps/s
[Step=16850 Epoch=159.7] | Loss=0.00245 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.718 | L2-Norm(final)=2.786 | 3926.4 samples/s | 61.4 steps/s
[Step=16900 Epoch=160.1] | Loss=0.00123 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.725 | L2-Norm(final)=2.786 | 5827.3 samples/s | 91.1 steps/s
[Step=16950 Epoch=160.6] | Loss=0.00082 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.723 | L2-Norm(final)=2.786 | 1953.3 samples/s | 30.5 steps/s
[Step=17000 Epoch=161.1] | Loss=0.00063 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.719 | L2-Norm(final)=2.786 | 5226.4 samples/s | 81.7 steps/s
[Step=17050 Epoch=161.6] | Loss=0.00051 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.715 | L2-Norm(final)=2.787 | 1968.9 samples/s | 30.8 steps/s
[Step=17100 Epoch=162.0] | Loss=0.00042 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.710 | L2-Norm(final)=2.787 | 5034.1 samples/s | 78.7 steps/s
[Step=17150 Epoch=162.5] | Loss=0.00036 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.705 | L2-Norm(final)=2.787 | 2083.9 samples/s | 32.6 steps/s
[Step=17200 Epoch=163.0] | Loss=0.00032 | Reg=0.00188 | acc=1.0000 | L2-Norm=13.699 | L2-Norm(final)=2.788 | 4652.6 samples/s | 72.7 steps/s
[Step=17250 Epoch=163.5] | Loss=0.00028 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.693 | L2-Norm(final)=2.788 | 2146.4 samples/s | 33.5 steps/s
[Step=17300 Epoch=163.9] | Loss=0.00026 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.687 | L2-Norm(final)=2.788 | 4428.8 samples/s | 69.2 steps/s
[Step=17350 Epoch=164.4] | Loss=0.00023 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.680 | L2-Norm(final)=2.788 | 2164.5 samples/s | 33.8 steps/s
[Step=17400 Epoch=164.9] | Loss=0.00021 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.674 | L2-Norm(final)=2.789 | 4283.2 samples/s | 66.9 steps/s
[Step=17450 Epoch=165.4] | Loss=0.00020 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.667 | L2-Norm(final)=2.789 | 2251.0 samples/s | 35.2 steps/s
[Step=17500 Epoch=165.8] | Loss=0.00018 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.661 | L2-Norm(final)=2.789 | 4403.1 samples/s | 68.8 steps/s
[Step=17550 Epoch=166.3] | Loss=0.00017 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.654 | L2-Norm(final)=2.789 | 2248.5 samples/s | 35.1 steps/s
[Step=17600 Epoch=166.8] | Loss=0.00016 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.647 | L2-Norm(final)=2.789 | 4315.9 samples/s | 67.4 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step17600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38825 | acc=0.8438 | tpr=0.7950 | fpr=0.0500 | 4136.4 samples/s | 16.2 steps/s
Avg test loss: 0.40371, Avg test acc: 0.84113, Avg tpr: 0.79210, Avg fpr: 0.05102, total FA: 398

Testing server on iccad2012
[Step=  50] | Loss=0.42771 | acc=0.8805 | tpr=0.9159 | fpr=0.1201 | 4225.4 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.44031 | acc=0.8775 | tpr=0.9211 | fpr=0.1234 | 7817.0 samples/s | 30.5 steps/s
[Step= 150] | Loss=0.44514 | acc=0.8770 | tpr=0.9265 | fpr=0.1239 | 7858.6 samples/s | 30.7 steps/s
[Step= 200] | Loss=0.45043 | acc=0.8768 | tpr=0.9322 | fpr=0.1242 | 7240.1 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.44943 | acc=0.8769 | tpr=0.9328 | fpr=0.1241 | 7674.2 samples/s | 30.0 steps/s
[Step= 300] | Loss=0.45172 | acc=0.8769 | tpr=0.9302 | fpr=0.1241 | 7793.9 samples/s | 30.4 steps/s
[Step= 350] | Loss=0.45385 | acc=0.8770 | tpr=0.9299 | fpr=0.1240 | 7603.0 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.45589 | acc=0.8764 | tpr=0.9322 | fpr=0.1246 | 7569.6 samples/s | 29.6 steps/s
[Step= 450] | Loss=0.45883 | acc=0.8763 | tpr=0.9333 | fpr=0.1247 | 7939.8 samples/s | 31.0 steps/s
[Step= 500] | Loss=0.45640 | acc=0.8765 | tpr=0.9361 | fpr=0.1246 | 7561.6 samples/s | 29.5 steps/s
[Step= 550] | Loss=0.45478 | acc=0.8767 | tpr=0.9355 | fpr=0.1244 | 13207.5 samples/s | 51.6 steps/s
Avg test loss: 0.45405, Avg test acc: 0.87677, Avg tpr: 0.93582, Avg fpr: 0.12430, total FA: 17259

server round 22/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=85.8] | Loss=0.15435 | Reg=0.00185 | acc=0.9062 | L2-Norm=13.594 | L2-Norm(final)=2.816 | 4836.3 samples/s | 75.6 steps/s
[Step=17650 Epoch=86.1] | Loss=0.01104 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.641 | L2-Norm(final)=2.811 | 4399.9 samples/s | 68.7 steps/s
[Step=17700 Epoch=86.3] | Loss=0.00773 | Reg=0.00186 | acc=0.9844 | L2-Norm=13.655 | L2-Norm(final)=2.813 | 4558.1 samples/s | 71.2 steps/s
[Step=17750 Epoch=86.6] | Loss=0.00627 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.660 | L2-Norm(final)=2.815 | 4502.4 samples/s | 70.4 steps/s
[Step=17800 Epoch=86.8] | Loss=0.00521 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.663 | L2-Norm(final)=2.817 | 6145.4 samples/s | 96.0 steps/s
[Step=17850 Epoch=87.0] | Loss=0.00463 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.665 | L2-Norm(final)=2.818 | 2028.9 samples/s | 31.7 steps/s
[Step=17900 Epoch=87.3] | Loss=0.00424 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.666 | L2-Norm(final)=2.820 | 4545.2 samples/s | 71.0 steps/s
[Step=17950 Epoch=87.5] | Loss=0.00398 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.667 | L2-Norm(final)=2.822 | 4596.7 samples/s | 71.8 steps/s
[Step=18000 Epoch=87.8] | Loss=0.00372 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.668 | L2-Norm(final)=2.824 | 5492.2 samples/s | 85.8 steps/s
[Step=18050 Epoch=88.0] | Loss=0.00357 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.668 | L2-Norm(final)=2.825 | 2056.7 samples/s | 32.1 steps/s
[Step=18100 Epoch=88.3] | Loss=0.00341 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.668 | L2-Norm(final)=2.826 | 4516.4 samples/s | 70.6 steps/s
[Step=18150 Epoch=88.5] | Loss=0.00323 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.668 | L2-Norm(final)=2.828 | 4374.7 samples/s | 68.4 steps/s
[Step=18200 Epoch=88.7] | Loss=0.00312 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.668 | L2-Norm(final)=2.829 | 5266.5 samples/s | 82.3 steps/s
[Step=18250 Epoch=89.0] | Loss=0.00327 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.668 | L2-Norm(final)=2.830 | 2203.4 samples/s | 34.4 steps/s
[Step=18300 Epoch=89.2] | Loss=0.00322 | Reg=0.00187 | acc=0.9844 | L2-Norm=13.668 | L2-Norm(final)=2.831 | 4477.7 samples/s | 70.0 steps/s
[Step=18350 Epoch=89.5] | Loss=0.00313 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.667 | L2-Norm(final)=2.832 | 4563.9 samples/s | 71.3 steps/s
[Step=18400 Epoch=89.7] | Loss=0.00302 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.667 | L2-Norm(final)=2.833 | 4947.3 samples/s | 77.3 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step18400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=17601 Epoch=166.8] | Loss=0.06603 | Reg=0.00185 | acc=0.9531 | L2-Norm=13.594 | L2-Norm(final)=2.817 | 4895.7 samples/s | 76.5 steps/s
[Step=17650 Epoch=167.2] | Loss=0.00241 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.654 | L2-Norm(final)=2.820 | 3847.3 samples/s | 60.1 steps/s
[Step=17700 Epoch=167.7] | Loss=0.00127 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.664 | L2-Norm(final)=2.822 | 5680.0 samples/s | 88.8 steps/s
[Step=17750 Epoch=168.2] | Loss=0.00085 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.666 | L2-Norm(final)=2.825 | 1945.1 samples/s | 30.4 steps/s
[Step=17800 Epoch=168.7] | Loss=0.00064 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.664 | L2-Norm(final)=2.826 | 5356.5 samples/s | 83.7 steps/s
[Step=17850 Epoch=169.1] | Loss=0.00051 | Reg=0.00187 | acc=1.0000 | L2-Norm=13.661 | L2-Norm(final)=2.827 | 2020.6 samples/s | 31.6 steps/s
[Step=17900 Epoch=169.6] | Loss=0.00043 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.656 | L2-Norm(final)=2.828 | 5034.2 samples/s | 78.7 steps/s
[Step=17950 Epoch=170.1] | Loss=0.00037 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.651 | L2-Norm(final)=2.829 | 2108.0 samples/s | 32.9 steps/s
[Step=18000 Epoch=170.6] | Loss=0.00032 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.646 | L2-Norm(final)=2.830 | 4732.6 samples/s | 73.9 steps/s
[Step=18050 Epoch=171.0] | Loss=0.00029 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.641 | L2-Norm(final)=2.831 | 2098.5 samples/s | 32.8 steps/s
[Step=18100 Epoch=171.5] | Loss=0.00026 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.636 | L2-Norm(final)=2.832 | 4133.6 samples/s | 64.6 steps/s
[Step=18150 Epoch=172.0] | Loss=0.00024 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.630 | L2-Norm(final)=2.833 | 2156.4 samples/s | 33.7 steps/s
[Step=18200 Epoch=172.5] | Loss=0.00022 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.624 | L2-Norm(final)=2.834 | 4180.4 samples/s | 65.3 steps/s
[Step=18250 Epoch=172.9] | Loss=0.00020 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.619 | L2-Norm(final)=2.835 | 2198.3 samples/s | 34.3 steps/s
[Step=18300 Epoch=173.4] | Loss=0.00019 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.613 | L2-Norm(final)=2.836 | 4418.7 samples/s | 69.0 steps/s
[Step=18350 Epoch=173.9] | Loss=0.00017 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.607 | L2-Norm(final)=2.837 | 2229.0 samples/s | 34.8 steps/s
[Step=18400 Epoch=174.4] | Loss=0.00016 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.601 | L2-Norm(final)=2.838 | 4284.0 samples/s | 66.9 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step18400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.45337 | acc=0.8213 | tpr=0.7573 | fpr=0.0396 | 4208.5 samples/s | 16.4 steps/s
Avg test loss: 0.47139, Avg test acc: 0.81914, Avg tpr: 0.75532, Avg fpr: 0.04051, total FA: 316

Testing server on iccad2012
[Step=  50] | Loss=0.38751 | acc=0.8883 | tpr=0.9027 | fpr=0.1120 | 4366.4 samples/s | 17.1 steps/s
[Step= 100] | Loss=0.40086 | acc=0.8845 | tpr=0.9126 | fpr=0.1160 | 7596.4 samples/s | 29.7 steps/s
[Step= 150] | Loss=0.40450 | acc=0.8852 | tpr=0.9179 | fpr=0.1154 | 7293.4 samples/s | 28.5 steps/s
[Step= 200] | Loss=0.41032 | acc=0.8849 | tpr=0.9224 | fpr=0.1158 | 7682.7 samples/s | 30.0 steps/s
[Step= 250] | Loss=0.40852 | acc=0.8846 | tpr=0.9223 | fpr=0.1161 | 7547.2 samples/s | 29.5 steps/s
[Step= 300] | Loss=0.41113 | acc=0.8842 | tpr=0.9215 | fpr=0.1165 | 7316.3 samples/s | 28.6 steps/s
[Step= 350] | Loss=0.41336 | acc=0.8842 | tpr=0.9211 | fpr=0.1165 | 7705.5 samples/s | 30.1 steps/s
[Step= 400] | Loss=0.41550 | acc=0.8836 | tpr=0.9240 | fpr=0.1172 | 7700.4 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.41848 | acc=0.8836 | tpr=0.9255 | fpr=0.1172 | 7525.0 samples/s | 29.4 steps/s
[Step= 500] | Loss=0.41637 | acc=0.8838 | tpr=0.9282 | fpr=0.1171 | 7512.6 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.41430 | acc=0.8840 | tpr=0.9300 | fpr=0.1168 | 14204.2 samples/s | 55.5 steps/s
Avg test loss: 0.41351, Avg test acc: 0.88412, Avg tpr: 0.93027, Avg fpr: 0.11672, total FA: 16206

server round 23/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=89.7] | Loss=0.11539 | Reg=0.00183 | acc=0.9062 | L2-Norm=13.540 | L2-Norm(final)=2.848 | 4934.5 samples/s | 77.1 steps/s
[Step=18450 Epoch=90.0] | Loss=0.01143 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.587 | L2-Norm(final)=2.842 | 4261.3 samples/s | 66.6 steps/s
[Step=18500 Epoch=90.2] | Loss=0.00742 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.603 | L2-Norm(final)=2.845 | 4512.4 samples/s | 70.5 steps/s
[Step=18550 Epoch=90.5] | Loss=0.00615 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.610 | L2-Norm(final)=2.849 | 4528.5 samples/s | 70.8 steps/s
[Step=18600 Epoch=90.7] | Loss=0.00547 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.613 | L2-Norm(final)=2.850 | 6098.1 samples/s | 95.3 steps/s
[Step=18650 Epoch=90.9] | Loss=0.00461 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.615 | L2-Norm(final)=2.852 | 2061.2 samples/s | 32.2 steps/s
[Step=18700 Epoch=91.2] | Loss=0.00415 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.617 | L2-Norm(final)=2.854 | 4458.7 samples/s | 69.7 steps/s
[Step=18750 Epoch=91.4] | Loss=0.00411 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=2.856 | 4570.6 samples/s | 71.4 steps/s
[Step=18800 Epoch=91.7] | Loss=0.00397 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.619 | L2-Norm(final)=2.858 | 5448.4 samples/s | 85.1 steps/s
[Step=18850 Epoch=91.9] | Loss=0.00371 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.620 | L2-Norm(final)=2.859 | 2112.2 samples/s | 33.0 steps/s
[Step=18900 Epoch=92.2] | Loss=0.00350 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.620 | L2-Norm(final)=2.861 | 4612.2 samples/s | 72.1 steps/s
[Step=18950 Epoch=92.4] | Loss=0.00341 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.620 | L2-Norm(final)=2.863 | 4580.5 samples/s | 71.6 steps/s
[Step=19000 Epoch=92.6] | Loss=0.00330 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.621 | L2-Norm(final)=2.864 | 5261.4 samples/s | 82.2 steps/s
[Step=19050 Epoch=92.9] | Loss=0.00322 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.621 | L2-Norm(final)=2.866 | 2182.6 samples/s | 34.1 steps/s
[Step=19100 Epoch=93.1] | Loss=0.00314 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.621 | L2-Norm(final)=2.867 | 4541.5 samples/s | 71.0 steps/s
[Step=19150 Epoch=93.4] | Loss=0.00300 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.620 | L2-Norm(final)=2.868 | 4559.0 samples/s | 71.2 steps/s
[Step=19200 Epoch=93.6] | Loss=0.00292 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.620 | L2-Norm(final)=2.870 | 4734.0 samples/s | 74.0 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step19200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=18401 Epoch=174.4] | Loss=0.08394 | Reg=0.00183 | acc=0.9375 | L2-Norm=13.540 | L2-Norm(final)=2.848 | 4593.7 samples/s | 71.8 steps/s
[Step=18450 Epoch=174.8] | Loss=0.00327 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.606 | L2-Norm(final)=2.858 | 3816.2 samples/s | 59.6 steps/s
[Step=18500 Epoch=175.3] | Loss=0.00165 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.619 | L2-Norm(final)=2.859 | 5641.7 samples/s | 88.2 steps/s
[Step=18550 Epoch=175.8] | Loss=0.00110 | Reg=0.00186 | acc=1.0000 | L2-Norm=13.620 | L2-Norm(final)=2.860 | 1976.6 samples/s | 30.9 steps/s
[Step=18600 Epoch=176.3] | Loss=0.00083 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.618 | L2-Norm(final)=2.861 | 5449.2 samples/s | 85.1 steps/s
[Step=18650 Epoch=176.7] | Loss=0.00066 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.614 | L2-Norm(final)=2.861 | 2049.5 samples/s | 32.0 steps/s
[Step=18700 Epoch=177.2] | Loss=0.00056 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.609 | L2-Norm(final)=2.862 | 4897.2 samples/s | 76.5 steps/s
[Step=18750 Epoch=177.7] | Loss=0.00048 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.605 | L2-Norm(final)=2.862 | 2064.5 samples/s | 32.3 steps/s
[Step=18800 Epoch=178.1] | Loss=0.00042 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.600 | L2-Norm(final)=2.863 | 4603.6 samples/s | 71.9 steps/s
[Step=18850 Epoch=178.6] | Loss=0.00037 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.595 | L2-Norm(final)=2.864 | 2102.7 samples/s | 32.9 steps/s
[Step=18900 Epoch=179.1] | Loss=0.00034 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.589 | L2-Norm(final)=2.864 | 4443.8 samples/s | 69.4 steps/s
[Step=18950 Epoch=179.6] | Loss=0.00031 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.584 | L2-Norm(final)=2.865 | 2220.5 samples/s | 34.7 steps/s
[Step=19000 Epoch=180.0] | Loss=0.00028 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.578 | L2-Norm(final)=2.866 | 4313.0 samples/s | 67.4 steps/s
[Step=19050 Epoch=180.5] | Loss=0.00026 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.573 | L2-Norm(final)=2.867 | 2181.5 samples/s | 34.1 steps/s
[Step=19100 Epoch=181.0] | Loss=0.00024 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.567 | L2-Norm(final)=2.868 | 4142.2 samples/s | 64.7 steps/s
[Step=19150 Epoch=181.5] | Loss=0.00022 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.561 | L2-Norm(final)=2.869 | 2225.2 samples/s | 34.8 steps/s
[Step=19200 Epoch=181.9] | Loss=0.00021 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.555 | L2-Norm(final)=2.870 | 4329.1 samples/s | 67.6 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step19200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.54805 | acc=0.7792 | tpr=0.6921 | fpr=0.0317 | 4168.7 samples/s | 16.3 steps/s
Avg test loss: 0.56434, Avg test acc: 0.77723, Avg tpr: 0.69056, Avg fpr: 0.03218, total FA: 251

Testing server on iccad2012
[Step=  50] | Loss=0.29243 | acc=0.9202 | tpr=0.8894 | fpr=0.0793 | 4296.7 samples/s | 16.8 steps/s
[Step= 100] | Loss=0.29887 | acc=0.9172 | tpr=0.8977 | fpr=0.0824 | 7463.2 samples/s | 29.2 steps/s
[Step= 150] | Loss=0.30330 | acc=0.9170 | tpr=0.8991 | fpr=0.0827 | 7582.8 samples/s | 29.6 steps/s
[Step= 200] | Loss=0.30797 | acc=0.9169 | tpr=0.9071 | fpr=0.0830 | 7740.9 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.30473 | acc=0.9169 | tpr=0.9083 | fpr=0.0830 | 7661.0 samples/s | 29.9 steps/s
[Step= 300] | Loss=0.30663 | acc=0.9167 | tpr=0.9069 | fpr=0.0831 | 7451.0 samples/s | 29.1 steps/s
[Step= 350] | Loss=0.30839 | acc=0.9163 | tpr=0.9061 | fpr=0.0835 | 7483.5 samples/s | 29.2 steps/s
[Step= 400] | Loss=0.31033 | acc=0.9159 | tpr=0.9086 | fpr=0.0839 | 7879.9 samples/s | 30.8 steps/s
[Step= 450] | Loss=0.31333 | acc=0.9156 | tpr=0.9090 | fpr=0.0843 | 7754.6 samples/s | 30.3 steps/s
[Step= 500] | Loss=0.31116 | acc=0.9160 | tpr=0.9119 | fpr=0.0840 | 7398.5 samples/s | 28.9 steps/s
[Step= 550] | Loss=0.30892 | acc=0.9163 | tpr=0.9117 | fpr=0.0836 | 14505.1 samples/s | 56.7 steps/s
Avg test loss: 0.30811, Avg test acc: 0.91645, Avg tpr: 0.91204, Avg fpr: 0.08347, total FA: 11589

server round 24/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=93.6] | Loss=0.13621 | Reg=0.00182 | acc=0.9375 | L2-Norm=13.491 | L2-Norm(final)=2.884 | 5149.4 samples/s | 80.5 steps/s
[Step=19250 Epoch=93.9] | Loss=0.01923 | Reg=0.00184 | acc=1.0000 | L2-Norm=13.561 | L2-Norm(final)=2.866 | 4217.6 samples/s | 65.9 steps/s
[Step=19300 Epoch=94.1] | Loss=0.01173 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.584 | L2-Norm(final)=2.868 | 4523.2 samples/s | 70.7 steps/s
[Step=19350 Epoch=94.4] | Loss=0.00877 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.593 | L2-Norm(final)=2.872 | 4590.9 samples/s | 71.7 steps/s
[Step=19400 Epoch=94.6] | Loss=0.00705 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.599 | L2-Norm(final)=2.875 | 6089.3 samples/s | 95.1 steps/s
[Step=19450 Epoch=94.8] | Loss=0.00604 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.603 | L2-Norm(final)=2.878 | 2055.0 samples/s | 32.1 steps/s
[Step=19500 Epoch=95.1] | Loss=0.00540 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.606 | L2-Norm(final)=2.881 | 4398.4 samples/s | 68.7 steps/s
[Step=19550 Epoch=95.3] | Loss=0.00493 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.607 | L2-Norm(final)=2.883 | 4513.7 samples/s | 70.5 steps/s
[Step=19600 Epoch=95.6] | Loss=0.00454 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.609 | L2-Norm(final)=2.885 | 5641.5 samples/s | 88.1 steps/s
[Step=19650 Epoch=95.8] | Loss=0.00432 | Reg=0.00185 | acc=0.9844 | L2-Norm=13.609 | L2-Norm(final)=2.887 | 2114.8 samples/s | 33.0 steps/s
[Step=19700 Epoch=96.1] | Loss=0.00406 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.610 | L2-Norm(final)=2.889 | 4622.8 samples/s | 72.2 steps/s
[Step=19750 Epoch=96.3] | Loss=0.00376 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.610 | L2-Norm(final)=2.891 | 4477.1 samples/s | 70.0 steps/s
[Step=19800 Epoch=96.5] | Loss=0.00358 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.611 | L2-Norm(final)=2.893 | 5271.9 samples/s | 82.4 steps/s
[Step=19850 Epoch=96.8] | Loss=0.00351 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.611 | L2-Norm(final)=2.894 | 2170.2 samples/s | 33.9 steps/s
[Step=19900 Epoch=97.0] | Loss=0.00336 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.610 | L2-Norm(final)=2.896 | 4553.7 samples/s | 71.2 steps/s
[Step=19950 Epoch=97.3] | Loss=0.00326 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.610 | L2-Norm(final)=2.897 | 4515.2 samples/s | 70.5 steps/s
[Step=20000 Epoch=97.5] | Loss=0.00316 | Reg=0.00185 | acc=1.0000 | L2-Norm=13.610 | L2-Norm(final)=2.899 | 4971.0 samples/s | 77.7 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step20000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=19201 Epoch=181.9] | Loss=0.11087 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.491 | L2-Norm(final)=2.885 | 4668.4 samples/s | 72.9 steps/s
[Step=19250 Epoch=182.4] | Loss=0.00392 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=2.876 | 4143.9 samples/s | 64.7 steps/s
[Step=19300 Epoch=182.9] | Loss=0.00199 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.530 | L2-Norm(final)=2.875 | 5878.9 samples/s | 91.9 steps/s
[Step=19350 Epoch=183.4] | Loss=0.00133 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.529 | L2-Norm(final)=2.876 | 1982.6 samples/s | 31.0 steps/s
[Step=19400 Epoch=183.8] | Loss=0.00100 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.526 | L2-Norm(final)=2.877 | 5327.2 samples/s | 83.2 steps/s
[Step=19450 Epoch=184.3] | Loss=0.00081 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.522 | L2-Norm(final)=2.878 | 2000.3 samples/s | 31.3 steps/s
[Step=19500 Epoch=184.8] | Loss=0.00067 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.517 | L2-Norm(final)=2.879 | 5077.5 samples/s | 79.3 steps/s
[Step=19550 Epoch=185.3] | Loss=0.00058 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.512 | L2-Norm(final)=2.880 | 2104.6 samples/s | 32.9 steps/s
[Step=19600 Epoch=185.7] | Loss=0.00051 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.507 | L2-Norm(final)=2.882 | 4717.6 samples/s | 73.7 steps/s
[Step=19650 Epoch=186.2] | Loss=0.00045 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.502 | L2-Norm(final)=2.883 | 2116.7 samples/s | 33.1 steps/s
[Step=19700 Epoch=186.7] | Loss=0.00041 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.497 | L2-Norm(final)=2.884 | 4337.3 samples/s | 67.8 steps/s
[Step=19750 Epoch=187.1] | Loss=0.00037 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.491 | L2-Norm(final)=2.885 | 2173.3 samples/s | 34.0 steps/s
[Step=19800 Epoch=187.6] | Loss=0.00034 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.486 | L2-Norm(final)=2.886 | 4316.8 samples/s | 67.4 steps/s
[Step=19850 Epoch=188.1] | Loss=0.00031 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.480 | L2-Norm(final)=2.888 | 2226.5 samples/s | 34.8 steps/s
[Step=19900 Epoch=188.6] | Loss=0.00029 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.475 | L2-Norm(final)=2.889 | 4373.0 samples/s | 68.3 steps/s
[Step=19950 Epoch=189.0] | Loss=0.00027 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.469 | L2-Norm(final)=2.891 | 2227.8 samples/s | 34.8 steps/s
[Step=20000 Epoch=189.5] | Loss=0.00026 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.463 | L2-Norm(final)=2.892 | 4273.2 samples/s | 66.8 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step20000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38067 | acc=0.8502 | tpr=0.8028 | fpr=0.0468 | 4155.4 samples/s | 16.2 steps/s
Avg test loss: 0.39819, Avg test acc: 0.84859, Avg tpr: 0.80084, Avg fpr: 0.04640, total FA: 362

Testing server on iccad2012
[Step=  50] | Loss=0.41785 | acc=0.8767 | tpr=0.9071 | fpr=0.1238 | 4156.0 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.43488 | acc=0.8714 | tpr=0.9168 | fpr=0.1294 | 7848.7 samples/s | 30.7 steps/s
[Step= 150] | Loss=0.44062 | acc=0.8704 | tpr=0.9236 | fpr=0.1306 | 7702.4 samples/s | 30.1 steps/s
[Step= 200] | Loss=0.44490 | acc=0.8692 | tpr=0.9290 | fpr=0.1318 | 7607.7 samples/s | 29.7 steps/s
[Step= 250] | Loss=0.44291 | acc=0.8690 | tpr=0.9266 | fpr=0.1320 | 7461.7 samples/s | 29.1 steps/s
[Step= 300] | Loss=0.44436 | acc=0.8689 | tpr=0.9258 | fpr=0.1321 | 7711.4 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.44653 | acc=0.8692 | tpr=0.9261 | fpr=0.1319 | 7613.6 samples/s | 29.7 steps/s
[Step= 400] | Loss=0.44960 | acc=0.8686 | tpr=0.9294 | fpr=0.1325 | 7727.9 samples/s | 30.2 steps/s
[Step= 450] | Loss=0.45229 | acc=0.8688 | tpr=0.9314 | fpr=0.1324 | 7447.7 samples/s | 29.1 steps/s
[Step= 500] | Loss=0.44990 | acc=0.8694 | tpr=0.9344 | fpr=0.1317 | 7693.1 samples/s | 30.1 steps/s
[Step= 550] | Loss=0.44737 | acc=0.8697 | tpr=0.9355 | fpr=0.1315 | 13706.7 samples/s | 53.5 steps/s
Avg test loss: 0.44637, Avg test acc: 0.86975, Avg tpr: 0.93582, Avg fpr: 0.13145, total FA: 18252

server round 25/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=97.5] | Loss=0.09031 | Reg=0.00181 | acc=0.9531 | L2-Norm=13.442 | L2-Norm(final)=2.914 | 5076.4 samples/s | 79.3 steps/s
[Step=20050 Epoch=97.8] | Loss=0.00821 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.488 | L2-Norm(final)=2.916 | 4199.0 samples/s | 65.6 steps/s
[Step=20100 Epoch=98.0] | Loss=0.00608 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.503 | L2-Norm(final)=2.921 | 4541.2 samples/s | 71.0 steps/s
[Step=20150 Epoch=98.3] | Loss=0.00545 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.510 | L2-Norm(final)=2.924 | 4491.7 samples/s | 70.2 steps/s
[Step=20200 Epoch=98.5] | Loss=0.00537 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.515 | L2-Norm(final)=2.925 | 6082.4 samples/s | 95.0 steps/s
[Step=20250 Epoch=98.7] | Loss=0.00467 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.518 | L2-Norm(final)=2.926 | 2023.0 samples/s | 31.6 steps/s
[Step=20300 Epoch=99.0] | Loss=0.00424 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.520 | L2-Norm(final)=2.928 | 4434.6 samples/s | 69.3 steps/s
[Step=20350 Epoch=99.2] | Loss=0.00416 | Reg=0.00183 | acc=0.9844 | L2-Norm=13.522 | L2-Norm(final)=2.929 | 4532.9 samples/s | 70.8 steps/s
[Step=20400 Epoch=99.5] | Loss=0.00406 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.523 | L2-Norm(final)=2.930 | 5730.3 samples/s | 89.5 steps/s
[Step=20450 Epoch=99.7] | Loss=0.00380 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.524 | L2-Norm(final)=2.930 | 2132.1 samples/s | 33.3 steps/s
[Step=20500 Epoch=100.0] | Loss=0.00370 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=2.931 | 4525.9 samples/s | 70.7 steps/s
[Step=20550 Epoch=100.2] | Loss=0.00354 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=2.932 | 4568.0 samples/s | 71.4 steps/s
[Step=20600 Epoch=100.4] | Loss=0.00342 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=2.933 | 5262.8 samples/s | 82.2 steps/s
[Step=20650 Epoch=100.7] | Loss=0.00338 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.526 | L2-Norm(final)=2.934 | 2181.6 samples/s | 34.1 steps/s
[Step=20700 Epoch=100.9] | Loss=0.00338 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.526 | L2-Norm(final)=2.935 | 4548.5 samples/s | 71.1 steps/s
[Step=20750 Epoch=101.2] | Loss=0.00330 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=2.935 | 4520.5 samples/s | 70.6 steps/s
[Step=20800 Epoch=101.4] | Loss=0.00319 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.525 | L2-Norm(final)=2.936 | 4898.0 samples/s | 76.5 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step20800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20001 Epoch=189.5] | Loss=0.03476 | Reg=0.00181 | acc=0.9844 | L2-Norm=13.442 | L2-Norm(final)=2.915 | 4575.9 samples/s | 71.5 steps/s
[Step=20050 Epoch=190.0] | Loss=0.00381 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.510 | L2-Norm(final)=2.921 | 4254.8 samples/s | 66.5 steps/s
[Step=20100 Epoch=190.5] | Loss=0.00192 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.522 | L2-Norm(final)=2.919 | 5831.5 samples/s | 91.1 steps/s
[Step=20150 Epoch=190.9] | Loss=0.00129 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.523 | L2-Norm(final)=2.919 | 1976.4 samples/s | 30.9 steps/s
[Step=20200 Epoch=191.4] | Loss=0.00097 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.521 | L2-Norm(final)=2.919 | 5494.0 samples/s | 85.8 steps/s
[Step=20250 Epoch=191.9] | Loss=0.00078 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.518 | L2-Norm(final)=2.919 | 2058.2 samples/s | 32.2 steps/s
[Step=20300 Epoch=192.4] | Loss=0.00065 | Reg=0.00183 | acc=1.0000 | L2-Norm=13.513 | L2-Norm(final)=2.920 | 4976.6 samples/s | 77.8 steps/s
[Step=20350 Epoch=192.8] | Loss=0.00056 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.509 | L2-Norm(final)=2.920 | 2072.8 samples/s | 32.4 steps/s
[Step=20400 Epoch=193.3] | Loss=0.00049 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.504 | L2-Norm(final)=2.920 | 4652.9 samples/s | 72.7 steps/s
[Step=20450 Epoch=193.8] | Loss=0.00043 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.499 | L2-Norm(final)=2.921 | 2164.6 samples/s | 33.8 steps/s
[Step=20500 Epoch=194.3] | Loss=0.00039 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.494 | L2-Norm(final)=2.921 | 4393.0 samples/s | 68.6 steps/s
[Step=20550 Epoch=194.7] | Loss=0.00036 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.489 | L2-Norm(final)=2.922 | 2197.5 samples/s | 34.3 steps/s
[Step=20600 Epoch=195.2] | Loss=0.00033 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.484 | L2-Norm(final)=2.922 | 4298.1 samples/s | 67.2 steps/s
[Step=20650 Epoch=195.7] | Loss=0.00030 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.479 | L2-Norm(final)=2.922 | 2213.0 samples/s | 34.6 steps/s
[Step=20700 Epoch=196.2] | Loss=0.00028 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.473 | L2-Norm(final)=2.923 | 4323.7 samples/s | 67.6 steps/s
[Step=20750 Epoch=196.6] | Loss=0.00026 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.468 | L2-Norm(final)=2.923 | 2213.7 samples/s | 34.6 steps/s
[Step=20800 Epoch=197.1] | Loss=0.00025 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.462 | L2-Norm(final)=2.923 | 4356.7 samples/s | 68.1 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step20800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.42858 | acc=0.8224 | tpr=0.7619 | fpr=0.0461 | 4305.9 samples/s | 16.8 steps/s
Avg test loss: 0.44339, Avg test acc: 0.82058, Avg tpr: 0.75946, Avg fpr: 0.04499, total FA: 351

Testing server on iccad2012
[Step=  50] | Loss=0.34154 | acc=0.9052 | tpr=0.8894 | fpr=0.0945 | 4122.1 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.34989 | acc=0.9017 | tpr=0.9062 | fpr=0.0984 | 7385.9 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.35590 | acc=0.9005 | tpr=0.9092 | fpr=0.0996 | 7683.8 samples/s | 30.0 steps/s
[Step= 200] | Loss=0.35983 | acc=0.9008 | tpr=0.9191 | fpr=0.0995 | 7751.5 samples/s | 30.3 steps/s
[Step= 250] | Loss=0.35694 | acc=0.9008 | tpr=0.9170 | fpr=0.0995 | 7424.2 samples/s | 29.0 steps/s
[Step= 300] | Loss=0.35876 | acc=0.9007 | tpr=0.9178 | fpr=0.0996 | 7869.0 samples/s | 30.7 steps/s
[Step= 350] | Loss=0.36069 | acc=0.9008 | tpr=0.9180 | fpr=0.0995 | 7306.9 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.36292 | acc=0.9003 | tpr=0.9207 | fpr=0.1000 | 7814.7 samples/s | 30.5 steps/s
[Step= 450] | Loss=0.36584 | acc=0.9004 | tpr=0.9236 | fpr=0.1000 | 7146.7 samples/s | 27.9 steps/s
[Step= 500] | Loss=0.36361 | acc=0.9008 | tpr=0.9269 | fpr=0.0997 | 7733.3 samples/s | 30.2 steps/s
[Step= 550] | Loss=0.36148 | acc=0.9010 | tpr=0.9264 | fpr=0.0994 | 13791.1 samples/s | 53.9 steps/s
Avg test loss: 0.36058, Avg test acc: 0.90115, Avg tpr: 0.92670, Avg fpr: 0.09932, total FA: 13790

server round 26/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=101.4] | Loss=0.08862 | Reg=0.00180 | acc=0.9375 | L2-Norm=13.404 | L2-Norm(final)=2.935 | 4943.5 samples/s | 77.2 steps/s
[Step=20850 Epoch=101.7] | Loss=0.00948 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.463 | L2-Norm(final)=2.930 | 4281.4 samples/s | 66.9 steps/s
[Step=20900 Epoch=101.9] | Loss=0.00670 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.481 | L2-Norm(final)=2.931 | 4503.1 samples/s | 70.4 steps/s
[Step=20950 Epoch=102.2] | Loss=0.00509 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.489 | L2-Norm(final)=2.934 | 4378.4 samples/s | 68.4 steps/s
[Step=21000 Epoch=102.4] | Loss=0.00504 | Reg=0.00182 | acc=0.9688 | L2-Norm=13.493 | L2-Norm(final)=2.937 | 6007.5 samples/s | 93.9 steps/s
[Step=21050 Epoch=102.6] | Loss=0.00473 | Reg=0.00182 | acc=0.9844 | L2-Norm=13.496 | L2-Norm(final)=2.939 | 2056.4 samples/s | 32.1 steps/s
[Step=21100 Epoch=102.9] | Loss=0.00439 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.497 | L2-Norm(final)=2.940 | 4541.6 samples/s | 71.0 steps/s
[Step=21150 Epoch=103.1] | Loss=0.00405 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.498 | L2-Norm(final)=2.942 | 4559.4 samples/s | 71.2 steps/s
[Step=21200 Epoch=103.4] | Loss=0.00376 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.499 | L2-Norm(final)=2.943 | 5568.9 samples/s | 87.0 steps/s
[Step=21250 Epoch=103.6] | Loss=0.00358 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.499 | L2-Norm(final)=2.945 | 2105.9 samples/s | 32.9 steps/s
[Step=21300 Epoch=103.9] | Loss=0.00345 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.499 | L2-Norm(final)=2.947 | 4582.2 samples/s | 71.6 steps/s
[Step=21350 Epoch=104.1] | Loss=0.00320 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.499 | L2-Norm(final)=2.949 | 4611.7 samples/s | 72.1 steps/s
[Step=21400 Epoch=104.4] | Loss=0.00308 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.499 | L2-Norm(final)=2.950 | 5238.2 samples/s | 81.8 steps/s
[Step=21450 Epoch=104.6] | Loss=0.00295 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.499 | L2-Norm(final)=2.952 | 2147.9 samples/s | 33.6 steps/s
[Step=21500 Epoch=104.8] | Loss=0.00288 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.498 | L2-Norm(final)=2.954 | 4534.8 samples/s | 70.9 steps/s
[Step=21550 Epoch=105.1] | Loss=0.00287 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.498 | L2-Norm(final)=2.955 | 4575.5 samples/s | 71.5 steps/s
[Step=21600 Epoch=105.3] | Loss=0.00284 | Reg=0.00182 | acc=1.0000 | L2-Norm=13.497 | L2-Norm(final)=2.956 | 4977.2 samples/s | 77.8 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step21600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=20801 Epoch=197.1] | Loss=0.00122 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.404 | L2-Norm(final)=2.936 | 4442.2 samples/s | 69.4 steps/s
[Step=20850 Epoch=197.6] | Loss=0.00137 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.450 | L2-Norm(final)=2.948 | 4022.7 samples/s | 62.9 steps/s
[Step=20900 Epoch=198.0] | Loss=0.00069 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.455 | L2-Norm(final)=2.950 | 5771.8 samples/s | 90.2 steps/s
[Step=20950 Epoch=198.5] | Loss=0.00046 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.452 | L2-Norm(final)=2.951 | 1956.9 samples/s | 30.6 steps/s
[Step=21000 Epoch=199.0] | Loss=0.00035 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.448 | L2-Norm(final)=2.952 | 5397.5 samples/s | 84.3 steps/s
[Step=21050 Epoch=199.5] | Loss=0.00028 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.443 | L2-Norm(final)=2.952 | 2028.7 samples/s | 31.7 steps/s
[Step=21100 Epoch=199.9] | Loss=0.00023 | Reg=0.00181 | acc=1.0000 | L2-Norm=13.438 | L2-Norm(final)=2.953 | 4953.6 samples/s | 77.4 steps/s
[Step=21150 Epoch=200.4] | Loss=0.00020 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.432 | L2-Norm(final)=2.953 | 2105.8 samples/s | 32.9 steps/s
[Step=21200 Epoch=200.9] | Loss=0.00018 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.426 | L2-Norm(final)=2.953 | 4703.2 samples/s | 73.5 steps/s
[Step=21250 Epoch=201.4] | Loss=0.00016 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.421 | L2-Norm(final)=2.954 | 2157.4 samples/s | 33.7 steps/s
[Step=21300 Epoch=201.8] | Loss=0.00014 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.415 | L2-Norm(final)=2.954 | 4441.2 samples/s | 69.4 steps/s
[Step=21350 Epoch=202.3] | Loss=0.00013 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.409 | L2-Norm(final)=2.954 | 2222.2 samples/s | 34.7 steps/s
[Step=21400 Epoch=202.8] | Loss=0.00012 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.403 | L2-Norm(final)=2.955 | 4399.1 samples/s | 68.7 steps/s
[Step=21450 Epoch=203.3] | Loss=0.00011 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.397 | L2-Norm(final)=2.955 | 2239.2 samples/s | 35.0 steps/s
[Step=21500 Epoch=203.7] | Loss=0.00010 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.390 | L2-Norm(final)=2.955 | 4296.4 samples/s | 67.1 steps/s
[Step=21550 Epoch=204.2] | Loss=0.00010 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.384 | L2-Norm(final)=2.956 | 2241.9 samples/s | 35.0 steps/s
[Step=21600 Epoch=204.7] | Loss=0.00009 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.378 | L2-Norm(final)=2.956 | 4311.4 samples/s | 67.4 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step21600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38916 | acc=0.8455 | tpr=0.7948 | fpr=0.0446 | 4181.7 samples/s | 16.3 steps/s
Avg test loss: 0.40608, Avg test acc: 0.84374, Avg tpr: 0.79326, Avg fpr: 0.04525, total FA: 353

Testing server on iccad2012
[Step=  50] | Loss=0.38501 | acc=0.8891 | tpr=0.8982 | fpr=0.1111 | 4222.0 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.39421 | acc=0.8855 | tpr=0.9104 | fpr=0.1149 | 7536.2 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.39994 | acc=0.8853 | tpr=0.9164 | fpr=0.1153 | 7810.2 samples/s | 30.5 steps/s
[Step= 200] | Loss=0.40439 | acc=0.8848 | tpr=0.9224 | fpr=0.1158 | 7727.6 samples/s | 30.2 steps/s
[Step= 250] | Loss=0.40160 | acc=0.8851 | tpr=0.9205 | fpr=0.1155 | 7792.4 samples/s | 30.4 steps/s
[Step= 300] | Loss=0.40254 | acc=0.8852 | tpr=0.9207 | fpr=0.1155 | 7679.5 samples/s | 30.0 steps/s
[Step= 350] | Loss=0.40423 | acc=0.8855 | tpr=0.9205 | fpr=0.1152 | 7534.3 samples/s | 29.4 steps/s
[Step= 400] | Loss=0.40710 | acc=0.8849 | tpr=0.9251 | fpr=0.1158 | 7644.2 samples/s | 29.9 steps/s
[Step= 450] | Loss=0.41016 | acc=0.8850 | tpr=0.9265 | fpr=0.1158 | 7610.7 samples/s | 29.7 steps/s
[Step= 500] | Loss=0.40766 | acc=0.8851 | tpr=0.9286 | fpr=0.1156 | 7420.5 samples/s | 29.0 steps/s
[Step= 550] | Loss=0.40575 | acc=0.8853 | tpr=0.9284 | fpr=0.1155 | 13967.1 samples/s | 54.6 steps/s
Avg test loss: 0.40483, Avg test acc: 0.88539, Avg tpr: 0.92868, Avg fpr: 0.11540, total FA: 16023

server round 27/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=105.3] | Loss=0.01946 | Reg=0.00178 | acc=0.9688 | L2-Norm=13.342 | L2-Norm(final)=2.967 | 4985.1 samples/s | 77.9 steps/s
[Step=21650 Epoch=105.6] | Loss=0.00602 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.382 | L2-Norm(final)=2.969 | 4315.8 samples/s | 67.4 steps/s
[Step=21700 Epoch=105.8] | Loss=0.00484 | Reg=0.00179 | acc=0.9688 | L2-Norm=13.392 | L2-Norm(final)=2.972 | 4568.4 samples/s | 71.4 steps/s
[Step=21750 Epoch=106.1] | Loss=0.00393 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.396 | L2-Norm(final)=2.973 | 4584.9 samples/s | 71.6 steps/s
[Step=21800 Epoch=106.3] | Loss=0.00361 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.399 | L2-Norm(final)=2.975 | 6069.5 samples/s | 94.8 steps/s
[Step=21850 Epoch=106.5] | Loss=0.00328 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.401 | L2-Norm(final)=2.977 | 2080.2 samples/s | 32.5 steps/s
[Step=21900 Epoch=106.8] | Loss=0.00302 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=2.979 | 4505.9 samples/s | 70.4 steps/s
[Step=21950 Epoch=107.0] | Loss=0.00280 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=2.981 | 4575.1 samples/s | 71.5 steps/s
[Step=22000 Epoch=107.3] | Loss=0.00278 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=2.982 | 5587.8 samples/s | 87.3 steps/s
[Step=22050 Epoch=107.5] | Loss=0.00265 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=2.983 | 2058.9 samples/s | 32.2 steps/s
[Step=22100 Epoch=107.8] | Loss=0.00252 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.402 | L2-Norm(final)=2.984 | 4610.8 samples/s | 72.0 steps/s
[Step=22150 Epoch=108.0] | Loss=0.00240 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.401 | L2-Norm(final)=2.986 | 4514.0 samples/s | 70.5 steps/s
[Step=22200 Epoch=108.3] | Loss=0.00245 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.401 | L2-Norm(final)=2.987 | 5266.9 samples/s | 82.3 steps/s
[Step=22250 Epoch=108.5] | Loss=0.00236 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.401 | L2-Norm(final)=2.989 | 2159.2 samples/s | 33.7 steps/s
[Step=22300 Epoch=108.7] | Loss=0.00237 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.400 | L2-Norm(final)=2.990 | 4424.8 samples/s | 69.1 steps/s
[Step=22350 Epoch=109.0] | Loss=0.00231 | Reg=0.00180 | acc=1.0000 | L2-Norm=13.399 | L2-Norm(final)=2.991 | 4539.3 samples/s | 70.9 steps/s
[Step=22400 Epoch=109.2] | Loss=0.00231 | Reg=0.00180 | acc=0.9688 | L2-Norm=13.399 | L2-Norm(final)=2.992 | 4944.9 samples/s | 77.3 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step22400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=21601 Epoch=204.7] | Loss=0.00122 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.342 | L2-Norm(final)=2.967 | 4628.7 samples/s | 72.3 steps/s
[Step=21650 Epoch=205.2] | Loss=0.00167 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.382 | L2-Norm(final)=2.977 | 4052.6 samples/s | 63.3 steps/s
[Step=21700 Epoch=205.6] | Loss=0.00084 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.388 | L2-Norm(final)=2.979 | 5625.7 samples/s | 87.9 steps/s
[Step=21750 Epoch=206.1] | Loss=0.00056 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.385 | L2-Norm(final)=2.980 | 1983.3 samples/s | 31.0 steps/s
[Step=21800 Epoch=206.6] | Loss=0.00042 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.381 | L2-Norm(final)=2.980 | 5389.1 samples/s | 84.2 steps/s
[Step=21850 Epoch=207.0] | Loss=0.00034 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.375 | L2-Norm(final)=2.981 | 2017.4 samples/s | 31.5 steps/s
[Step=21900 Epoch=207.5] | Loss=0.00028 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.370 | L2-Norm(final)=2.981 | 4923.3 samples/s | 76.9 steps/s
[Step=21950 Epoch=208.0] | Loss=0.00024 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.364 | L2-Norm(final)=2.982 | 2107.4 samples/s | 32.9 steps/s
[Step=22000 Epoch=208.5] | Loss=0.00021 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.357 | L2-Norm(final)=2.982 | 4628.2 samples/s | 72.3 steps/s
[Step=22050 Epoch=208.9] | Loss=0.00019 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=2.983 | 2084.6 samples/s | 32.6 steps/s
[Step=22100 Epoch=209.4] | Loss=0.00017 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.345 | L2-Norm(final)=2.984 | 4172.2 samples/s | 65.2 steps/s
[Step=22150 Epoch=209.9] | Loss=0.00015 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.338 | L2-Norm(final)=2.984 | 2101.0 samples/s | 32.8 steps/s
[Step=22200 Epoch=210.4] | Loss=0.00014 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.331 | L2-Norm(final)=2.985 | 4102.9 samples/s | 64.1 steps/s
[Step=22250 Epoch=210.8] | Loss=0.00013 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.325 | L2-Norm(final)=2.985 | 2170.9 samples/s | 33.9 steps/s
[Step=22300 Epoch=211.3] | Loss=0.00012 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.318 | L2-Norm(final)=2.986 | 4164.0 samples/s | 65.1 steps/s
[Step=22350 Epoch=211.8] | Loss=0.00011 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.311 | L2-Norm(final)=2.986 | 2188.2 samples/s | 34.2 steps/s
[Step=22400 Epoch=212.3] | Loss=0.00011 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.304 | L2-Norm(final)=2.987 | 4094.8 samples/s | 64.0 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step22400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.44303 | acc=0.8291 | tpr=0.7707 | fpr=0.0439 | 3965.8 samples/s | 15.5 steps/s
Avg test loss: 0.46240, Avg test acc: 0.82671, Avg tpr: 0.76785, Avg fpr: 0.04384, total FA: 342

Testing server on iccad2012
[Step=  50] | Loss=0.33399 | acc=0.9114 | tpr=0.8982 | fpr=0.0884 | 4045.5 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.34229 | acc=0.9071 | tpr=0.9126 | fpr=0.0930 | 7184.7 samples/s | 28.1 steps/s
[Step= 150] | Loss=0.34924 | acc=0.9069 | tpr=0.9150 | fpr=0.0932 | 7044.9 samples/s | 27.5 steps/s
[Step= 200] | Loss=0.35295 | acc=0.9071 | tpr=0.9213 | fpr=0.0931 | 7417.1 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.35076 | acc=0.9069 | tpr=0.9214 | fpr=0.0934 | 7195.8 samples/s | 28.1 steps/s
[Step= 300] | Loss=0.35239 | acc=0.9072 | tpr=0.9193 | fpr=0.0931 | 7219.3 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.35443 | acc=0.9073 | tpr=0.9192 | fpr=0.0929 | 7128.0 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.35629 | acc=0.9068 | tpr=0.9234 | fpr=0.0935 | 7126.4 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.35971 | acc=0.9066 | tpr=0.9250 | fpr=0.0937 | 7158.4 samples/s | 28.0 steps/s
[Step= 500] | Loss=0.35760 | acc=0.9068 | tpr=0.9278 | fpr=0.0936 | 7223.3 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.35554 | acc=0.9071 | tpr=0.9264 | fpr=0.0933 | 13347.8 samples/s | 52.1 steps/s
Avg test loss: 0.35469, Avg test acc: 0.90715, Avg tpr: 0.92670, Avg fpr: 0.09320, total FA: 12941

server round 28/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=109.2] | Loss=0.06724 | Reg=0.00176 | acc=0.9375 | L2-Norm=13.256 | L2-Norm(final)=2.999 | 4713.3 samples/s | 73.6 steps/s
[Step=22450 Epoch=109.5] | Loss=0.00862 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.331 | L2-Norm(final)=2.995 | 4129.5 samples/s | 64.5 steps/s
[Step=22500 Epoch=109.7] | Loss=0.00651 | Reg=0.00178 | acc=1.0000 | L2-Norm=13.351 | L2-Norm(final)=2.996 | 4446.9 samples/s | 69.5 steps/s
[Step=22550 Epoch=110.0] | Loss=0.00559 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.361 | L2-Norm(final)=2.998 | 4407.2 samples/s | 68.9 steps/s
[Step=22600 Epoch=110.2] | Loss=0.00512 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.368 | L2-Norm(final)=2.998 | 5968.9 samples/s | 93.3 steps/s
[Step=22650 Epoch=110.4] | Loss=0.00441 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.373 | L2-Norm(final)=3.000 | 1977.3 samples/s | 30.9 steps/s
[Step=22700 Epoch=110.7] | Loss=0.00392 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.376 | L2-Norm(final)=3.002 | 4300.3 samples/s | 67.2 steps/s
[Step=22750 Epoch=110.9] | Loss=0.00373 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.378 | L2-Norm(final)=3.003 | 4281.8 samples/s | 66.9 steps/s
[Step=22800 Epoch=111.2] | Loss=0.00355 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.380 | L2-Norm(final)=3.005 | 5496.1 samples/s | 85.9 steps/s
[Step=22850 Epoch=111.4] | Loss=0.00338 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.381 | L2-Norm(final)=3.007 | 2048.0 samples/s | 32.0 steps/s
[Step=22900 Epoch=111.7] | Loss=0.00330 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.382 | L2-Norm(final)=3.008 | 4441.3 samples/s | 69.4 steps/s
[Step=22950 Epoch=111.9] | Loss=0.00313 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.382 | L2-Norm(final)=3.010 | 4342.4 samples/s | 67.9 steps/s
[Step=23000 Epoch=112.2] | Loss=0.00298 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.382 | L2-Norm(final)=3.011 | 4935.3 samples/s | 77.1 steps/s
[Step=23050 Epoch=112.4] | Loss=0.00283 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.382 | L2-Norm(final)=3.013 | 2091.2 samples/s | 32.7 steps/s
[Step=23100 Epoch=112.6] | Loss=0.00280 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.382 | L2-Norm(final)=3.014 | 4408.3 samples/s | 68.9 steps/s
[Step=23150 Epoch=112.9] | Loss=0.00275 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.382 | L2-Norm(final)=3.015 | 4414.8 samples/s | 69.0 steps/s
[Step=23200 Epoch=113.1] | Loss=0.00268 | Reg=0.00179 | acc=1.0000 | L2-Norm=13.381 | L2-Norm(final)=3.017 | 4844.1 samples/s | 75.7 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step23200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=22401 Epoch=212.3] | Loss=0.07699 | Reg=0.00176 | acc=0.9688 | L2-Norm=13.256 | L2-Norm(final)=3.000 | 4488.6 samples/s | 70.1 steps/s
[Step=22450 Epoch=212.7] | Loss=0.00181 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.293 | L2-Norm(final)=3.004 | 4017.1 samples/s | 62.8 steps/s
[Step=22500 Epoch=213.2] | Loss=0.00093 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.297 | L2-Norm(final)=3.006 | 5632.8 samples/s | 88.0 steps/s
[Step=22550 Epoch=213.7] | Loss=0.00062 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.294 | L2-Norm(final)=3.007 | 1886.9 samples/s | 29.5 steps/s
[Step=22600 Epoch=214.2] | Loss=0.00047 | Reg=0.00177 | acc=1.0000 | L2-Norm=13.288 | L2-Norm(final)=3.008 | 5231.3 samples/s | 81.7 steps/s
[Step=22650 Epoch=214.6] | Loss=0.00037 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.282 | L2-Norm(final)=3.008 | 1946.6 samples/s | 30.4 steps/s
[Step=22700 Epoch=215.1] | Loss=0.00031 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.276 | L2-Norm(final)=3.009 | 4750.7 samples/s | 74.2 steps/s
[Step=22750 Epoch=215.6] | Loss=0.00027 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.269 | L2-Norm(final)=3.009 | 2030.3 samples/s | 31.7 steps/s
[Step=22800 Epoch=216.0] | Loss=0.00024 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.263 | L2-Norm(final)=3.010 | 4411.0 samples/s | 68.9 steps/s
[Step=22850 Epoch=216.5] | Loss=0.00021 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.256 | L2-Norm(final)=3.010 | 2078.1 samples/s | 32.5 steps/s
[Step=22900 Epoch=217.0] | Loss=0.00019 | Reg=0.00176 | acc=1.0000 | L2-Norm=13.249 | L2-Norm(final)=3.011 | 4136.7 samples/s | 64.6 steps/s
[Step=22950 Epoch=217.5] | Loss=0.00017 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.242 | L2-Norm(final)=3.011 | 2131.1 samples/s | 33.3 steps/s
[Step=23000 Epoch=217.9] | Loss=0.00016 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.234 | L2-Norm(final)=3.011 | 4155.7 samples/s | 64.9 steps/s
[Step=23050 Epoch=218.4] | Loss=0.00015 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.227 | L2-Norm(final)=3.012 | 2149.7 samples/s | 33.6 steps/s
[Step=23100 Epoch=218.9] | Loss=0.00014 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.220 | L2-Norm(final)=3.012 | 4134.1 samples/s | 64.6 steps/s
[Step=23150 Epoch=219.4] | Loss=0.00013 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.212 | L2-Norm(final)=3.012 | 2168.3 samples/s | 33.9 steps/s
[Step=23200 Epoch=219.8] | Loss=0.00012 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.205 | L2-Norm(final)=3.013 | 4082.1 samples/s | 63.8 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step23200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35388 | acc=0.8636 | tpr=0.8253 | fpr=0.0533 | 3962.2 samples/s | 15.5 steps/s
Avg test loss: 0.37340, Avg test acc: 0.86017, Avg tpr: 0.82054, Avg fpr: 0.05269, total FA: 411

Testing server on iccad2012
[Step=  50] | Loss=0.42837 | acc=0.8802 | tpr=0.9115 | fpr=0.1203 | 3999.2 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.43802 | acc=0.8764 | tpr=0.9232 | fpr=0.1245 | 7299.9 samples/s | 28.5 steps/s
[Step= 150] | Loss=0.44317 | acc=0.8765 | tpr=0.9222 | fpr=0.1243 | 7340.9 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.44685 | acc=0.8762 | tpr=0.9279 | fpr=0.1247 | 7022.7 samples/s | 27.4 steps/s
[Step= 250] | Loss=0.44508 | acc=0.8763 | tpr=0.9275 | fpr=0.1246 | 7259.0 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.44650 | acc=0.8760 | tpr=0.9244 | fpr=0.1249 | 7243.8 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.44781 | acc=0.8764 | tpr=0.9236 | fpr=0.1245 | 7081.6 samples/s | 27.7 steps/s
[Step= 400] | Loss=0.44997 | acc=0.8759 | tpr=0.9278 | fpr=0.1250 | 7427.5 samples/s | 29.0 steps/s
[Step= 450] | Loss=0.45351 | acc=0.8761 | tpr=0.9289 | fpr=0.1249 | 7230.1 samples/s | 28.2 steps/s
[Step= 500] | Loss=0.45120 | acc=0.8762 | tpr=0.9322 | fpr=0.1248 | 6813.7 samples/s | 26.6 steps/s
[Step= 550] | Loss=0.44969 | acc=0.8762 | tpr=0.9320 | fpr=0.1248 | 13440.3 samples/s | 52.5 steps/s
Avg test loss: 0.44880, Avg test acc: 0.87627, Avg tpr: 0.93225, Avg fpr: 0.12475, total FA: 17321

server round 29/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=113.1] | Loss=0.13453 | Reg=0.00174 | acc=0.9375 | L2-Norm=13.187 | L2-Norm(final)=3.025 | 4449.5 samples/s | 69.5 steps/s
[Step=23250 Epoch=113.4] | Loss=0.00807 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.215 | L2-Norm(final)=3.021 | 4335.2 samples/s | 67.7 steps/s
[Step=23300 Epoch=113.6] | Loss=0.00543 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.224 | L2-Norm(final)=3.023 | 4349.5 samples/s | 68.0 steps/s
[Step=23350 Epoch=113.9] | Loss=0.00453 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.228 | L2-Norm(final)=3.025 | 4295.1 samples/s | 67.1 steps/s
[Step=23400 Epoch=114.1] | Loss=0.00383 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.231 | L2-Norm(final)=3.027 | 5848.0 samples/s | 91.4 steps/s
[Step=23450 Epoch=114.3] | Loss=0.00360 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.233 | L2-Norm(final)=3.030 | 1993.7 samples/s | 31.2 steps/s
[Step=23500 Epoch=114.6] | Loss=0.00316 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.234 | L2-Norm(final)=3.032 | 4415.3 samples/s | 69.0 steps/s
[Step=23550 Epoch=114.8] | Loss=0.00290 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.235 | L2-Norm(final)=3.034 | 4481.1 samples/s | 70.0 steps/s
[Step=23600 Epoch=115.1] | Loss=0.00294 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.236 | L2-Norm(final)=3.036 | 5616.6 samples/s | 87.8 steps/s
[Step=23650 Epoch=115.3] | Loss=0.00305 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.236 | L2-Norm(final)=3.037 | 2052.7 samples/s | 32.1 steps/s
[Step=23700 Epoch=115.6] | Loss=0.00310 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.238 | L2-Norm(final)=3.037 | 4452.1 samples/s | 69.6 steps/s
[Step=23750 Epoch=115.8] | Loss=0.00299 | Reg=0.00175 | acc=0.9844 | L2-Norm=13.239 | L2-Norm(final)=3.038 | 4364.1 samples/s | 68.2 steps/s
[Step=23800 Epoch=116.1] | Loss=0.00294 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.241 | L2-Norm(final)=3.039 | 5182.4 samples/s | 81.0 steps/s
[Step=23850 Epoch=116.3] | Loss=0.00285 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.242 | L2-Norm(final)=3.040 | 2117.5 samples/s | 33.1 steps/s
[Step=23900 Epoch=116.5] | Loss=0.00275 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.243 | L2-Norm(final)=3.041 | 4430.9 samples/s | 69.2 steps/s
[Step=23950 Epoch=116.8] | Loss=0.00268 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.244 | L2-Norm(final)=3.042 | 4432.7 samples/s | 69.3 steps/s
[Step=24000 Epoch=117.0] | Loss=0.00268 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.244 | L2-Norm(final)=3.043 | 4767.4 samples/s | 74.5 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step24000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00025, len=1
[Step=23201 Epoch=219.8] | Loss=0.01568 | Reg=0.00174 | acc=0.9844 | L2-Norm=13.187 | L2-Norm(final)=3.027 | 4592.1 samples/s | 71.8 steps/s
[Step=23250 Epoch=220.3] | Loss=0.00127 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.238 | L2-Norm(final)=3.038 | 3857.5 samples/s | 60.3 steps/s
[Step=23300 Epoch=220.8] | Loss=0.00066 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.243 | L2-Norm(final)=3.040 | 5614.3 samples/s | 87.7 steps/s
[Step=23350 Epoch=221.3] | Loss=0.00044 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.240 | L2-Norm(final)=3.042 | 1917.5 samples/s | 30.0 steps/s
[Step=23400 Epoch=221.7] | Loss=0.00033 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.235 | L2-Norm(final)=3.043 | 5126.5 samples/s | 80.1 steps/s
[Step=23450 Epoch=222.2] | Loss=0.00026 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.229 | L2-Norm(final)=3.044 | 1964.5 samples/s | 30.7 steps/s
[Step=23500 Epoch=222.7] | Loss=0.00022 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.223 | L2-Norm(final)=3.044 | 4787.1 samples/s | 74.8 steps/s
[Step=23550 Epoch=223.2] | Loss=0.00019 | Reg=0.00175 | acc=1.0000 | L2-Norm=13.216 | L2-Norm(final)=3.044 | 2045.0 samples/s | 32.0 steps/s
[Step=23600 Epoch=223.6] | Loss=0.00017 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.209 | L2-Norm(final)=3.045 | 4440.8 samples/s | 69.4 steps/s
[Step=23650 Epoch=224.1] | Loss=0.00015 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.202 | L2-Norm(final)=3.045 | 2068.8 samples/s | 32.3 steps/s
[Step=23700 Epoch=224.6] | Loss=0.00013 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.195 | L2-Norm(final)=3.045 | 4245.2 samples/s | 66.3 steps/s
[Step=23750 Epoch=225.1] | Loss=0.00012 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.188 | L2-Norm(final)=3.046 | 2137.5 samples/s | 33.4 steps/s
[Step=23800 Epoch=225.5] | Loss=0.00011 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.181 | L2-Norm(final)=3.046 | 4253.0 samples/s | 66.5 steps/s
[Step=23850 Epoch=226.0] | Loss=0.00010 | Reg=0.00174 | acc=1.0000 | L2-Norm=13.173 | L2-Norm(final)=3.046 | 2164.6 samples/s | 33.8 steps/s
[Step=23900 Epoch=226.5] | Loss=0.00010 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.166 | L2-Norm(final)=3.046 | 4169.6 samples/s | 65.1 steps/s
[Step=23950 Epoch=226.9] | Loss=0.00009 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.158 | L2-Norm(final)=3.046 | 2146.3 samples/s | 33.5 steps/s
[Step=24000 Epoch=227.4] | Loss=0.00008 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.151 | L2-Norm(final)=3.047 | 4219.0 samples/s | 65.9 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step24000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.45402 | acc=0.8313 | tpr=0.7716 | fpr=0.0389 | 4037.2 samples/s | 15.8 steps/s
Avg test loss: 0.47279, Avg test acc: 0.82959, Avg tpr: 0.77012, Avg fpr: 0.03961, total FA: 309

Testing server on iccad2012
[Step=  50] | Loss=0.34542 | acc=0.9102 | tpr=0.8805 | fpr=0.0892 | 4025.0 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.35524 | acc=0.9076 | tpr=0.8998 | fpr=0.0923 | 7264.2 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.36040 | acc=0.9070 | tpr=0.9049 | fpr=0.0930 | 7369.7 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.36420 | acc=0.9068 | tpr=0.9137 | fpr=0.0933 | 7142.9 samples/s | 27.9 steps/s
[Step= 250] | Loss=0.36107 | acc=0.9070 | tpr=0.9144 | fpr=0.0931 | 7224.9 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.36259 | acc=0.9070 | tpr=0.9171 | fpr=0.0932 | 7251.6 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.36407 | acc=0.9072 | tpr=0.9173 | fpr=0.0930 | 7331.3 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.36582 | acc=0.9064 | tpr=0.9196 | fpr=0.0938 | 7194.0 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.36960 | acc=0.9063 | tpr=0.9182 | fpr=0.0939 | 7372.1 samples/s | 28.8 steps/s
[Step= 500] | Loss=0.36727 | acc=0.9064 | tpr=0.9207 | fpr=0.0938 | 6953.1 samples/s | 27.2 steps/s
[Step= 550] | Loss=0.36550 | acc=0.9066 | tpr=0.9188 | fpr=0.0936 | 12956.0 samples/s | 50.6 steps/s
Avg test loss: 0.36469, Avg test acc: 0.90672, Avg tpr: 0.91918, Avg fpr: 0.09351, total FA: 12983

server round 30/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=117.0] | Loss=0.10929 | Reg=0.00172 | acc=0.9531 | L2-Norm=13.104 | L2-Norm(final)=3.055 | 4719.2 samples/s | 73.7 steps/s
[Step=24050 Epoch=117.3] | Loss=0.00927 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.131 | L2-Norm(final)=3.052 | 4046.8 samples/s | 63.2 steps/s
[Step=24100 Epoch=117.5] | Loss=0.00570 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.137 | L2-Norm(final)=3.053 | 4504.0 samples/s | 70.4 steps/s
[Step=24150 Epoch=117.8] | Loss=0.00429 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.139 | L2-Norm(final)=3.054 | 4358.8 samples/s | 68.1 steps/s
[Step=24200 Epoch=118.0] | Loss=0.00365 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.140 | L2-Norm(final)=3.056 | 5823.9 samples/s | 91.0 steps/s
[Step=24250 Epoch=118.2] | Loss=0.00309 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.141 | L2-Norm(final)=3.057 | 1977.3 samples/s | 30.9 steps/s
[Step=24300 Epoch=118.5] | Loss=0.00280 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.142 | L2-Norm(final)=3.058 | 4356.0 samples/s | 68.1 steps/s
[Step=24350 Epoch=118.7] | Loss=0.00255 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.142 | L2-Norm(final)=3.060 | 4309.9 samples/s | 67.3 steps/s
[Step=24400 Epoch=119.0] | Loss=0.00256 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.142 | L2-Norm(final)=3.060 | 5435.1 samples/s | 84.9 steps/s
[Step=24450 Epoch=119.2] | Loss=0.00238 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.142 | L2-Norm(final)=3.061 | 2031.5 samples/s | 31.7 steps/s
[Step=24500 Epoch=119.5] | Loss=0.00226 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.142 | L2-Norm(final)=3.062 | 4306.1 samples/s | 67.3 steps/s
[Step=24550 Epoch=119.7] | Loss=0.00220 | Reg=0.00173 | acc=0.9844 | L2-Norm=13.142 | L2-Norm(final)=3.063 | 4274.3 samples/s | 66.8 steps/s
[Step=24600 Epoch=120.0] | Loss=0.00213 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.142 | L2-Norm(final)=3.064 | 5007.6 samples/s | 78.2 steps/s
[Step=24650 Epoch=120.2] | Loss=0.00207 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.142 | L2-Norm(final)=3.065 | 2144.4 samples/s | 33.5 steps/s
[Step=24700 Epoch=120.4] | Loss=0.00200 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.142 | L2-Norm(final)=3.065 | 4256.1 samples/s | 66.5 steps/s
[Step=24750 Epoch=120.7] | Loss=0.00194 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.141 | L2-Norm(final)=3.066 | 4375.3 samples/s | 68.4 steps/s
[Step=24800 Epoch=120.9] | Loss=0.00195 | Reg=0.00173 | acc=1.0000 | L2-Norm=13.141 | L2-Norm(final)=3.067 | 4739.3 samples/s | 74.1 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step24800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24001 Epoch=227.4] | Loss=0.00330 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.104 | L2-Norm(final)=3.055 | 4413.8 samples/s | 69.0 steps/s
[Step=24050 Epoch=227.9] | Loss=0.00092 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.122 | L2-Norm(final)=3.065 | 3906.5 samples/s | 61.0 steps/s
[Step=24100 Epoch=228.4] | Loss=0.00046 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.124 | L2-Norm(final)=3.067 | 5564.6 samples/s | 86.9 steps/s
[Step=24150 Epoch=228.8] | Loss=0.00031 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.122 | L2-Norm(final)=3.068 | 1858.9 samples/s | 29.0 steps/s
[Step=24200 Epoch=229.3] | Loss=0.00023 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.120 | L2-Norm(final)=3.068 | 5232.0 samples/s | 81.8 steps/s
[Step=24250 Epoch=229.8] | Loss=0.00019 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.116 | L2-Norm(final)=3.069 | 1955.1 samples/s | 30.5 steps/s
[Step=24300 Epoch=230.3] | Loss=0.00016 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.113 | L2-Norm(final)=3.069 | 4675.9 samples/s | 73.1 steps/s
[Step=24350 Epoch=230.7] | Loss=0.00013 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.110 | L2-Norm(final)=3.070 | 2023.5 samples/s | 31.6 steps/s
[Step=24400 Epoch=231.2] | Loss=0.00012 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.106 | L2-Norm(final)=3.070 | 4368.8 samples/s | 68.3 steps/s
[Step=24450 Epoch=231.7] | Loss=0.00010 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.103 | L2-Norm(final)=3.070 | 2078.8 samples/s | 32.5 steps/s
[Step=24500 Epoch=232.2] | Loss=0.00009 | Reg=0.00172 | acc=1.0000 | L2-Norm=13.099 | L2-Norm(final)=3.071 | 4140.6 samples/s | 64.7 steps/s
[Step=24550 Epoch=232.6] | Loss=0.00009 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.095 | L2-Norm(final)=3.071 | 2128.3 samples/s | 33.3 steps/s
[Step=24600 Epoch=233.1] | Loss=0.00008 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.091 | L2-Norm(final)=3.071 | 4117.6 samples/s | 64.3 steps/s
[Step=24650 Epoch=233.6] | Loss=0.00007 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.088 | L2-Norm(final)=3.071 | 2159.7 samples/s | 33.7 steps/s
[Step=24700 Epoch=234.1] | Loss=0.00007 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.084 | L2-Norm(final)=3.072 | 4087.0 samples/s | 63.9 steps/s
[Step=24750 Epoch=234.5] | Loss=0.00006 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.080 | L2-Norm(final)=3.072 | 2158.9 samples/s | 33.7 steps/s
[Step=24800 Epoch=235.0] | Loss=0.00006 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.076 | L2-Norm(final)=3.072 | 4051.8 samples/s | 63.3 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step24800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.41159 | acc=0.8541 | tpr=0.8082 | fpr=0.0461 | 4060.0 samples/s | 15.9 steps/s
Avg test loss: 0.43092, Avg test acc: 0.85095, Avg tpr: 0.80504, Avg fpr: 0.04807, total FA: 375

Testing server on iccad2012
[Step=  50] | Loss=0.37721 | acc=0.9030 | tpr=0.8894 | fpr=0.0968 | 4014.7 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.38806 | acc=0.8995 | tpr=0.9041 | fpr=0.1006 | 7154.3 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.39421 | acc=0.8988 | tpr=0.9063 | fpr=0.1014 | 7063.7 samples/s | 27.6 steps/s
[Step= 200] | Loss=0.39747 | acc=0.8980 | tpr=0.9148 | fpr=0.1023 | 7274.0 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.39422 | acc=0.8985 | tpr=0.9162 | fpr=0.1019 | 7118.2 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.39515 | acc=0.8983 | tpr=0.9171 | fpr=0.1021 | 7377.1 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.39647 | acc=0.8984 | tpr=0.9180 | fpr=0.1019 | 7111.5 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.39875 | acc=0.8978 | tpr=0.9190 | fpr=0.1026 | 7283.3 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.40241 | acc=0.8978 | tpr=0.9182 | fpr=0.1025 | 6999.9 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.39983 | acc=0.8979 | tpr=0.9216 | fpr=0.1026 | 7283.7 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.39770 | acc=0.8980 | tpr=0.9188 | fpr=0.1024 | 12767.0 samples/s | 49.9 steps/s
Avg test loss: 0.39689, Avg test acc: 0.89808, Avg tpr: 0.91918, Avg fpr: 0.10231, total FA: 14205

server round 31/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=120.9] | Loss=0.10415 | Reg=0.00170 | acc=0.9375 | L2-Norm=13.054 | L2-Norm(final)=3.074 | 4776.7 samples/s | 74.6 steps/s
[Step=24850 Epoch=121.2] | Loss=0.00888 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.080 | L2-Norm(final)=3.071 | 3985.6 samples/s | 62.3 steps/s
[Step=24900 Epoch=121.4] | Loss=0.00511 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.086 | L2-Norm(final)=3.070 | 4334.3 samples/s | 67.7 steps/s
[Step=24950 Epoch=121.7] | Loss=0.00400 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.088 | L2-Norm(final)=3.071 | 4443.7 samples/s | 69.4 steps/s
[Step=25000 Epoch=121.9] | Loss=0.00333 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.090 | L2-Norm(final)=3.072 | 5904.2 samples/s | 92.3 steps/s
[Step=25050 Epoch=122.1] | Loss=0.00290 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.090 | L2-Norm(final)=3.073 | 2005.0 samples/s | 31.3 steps/s
[Step=25100 Epoch=122.4] | Loss=0.00272 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.091 | L2-Norm(final)=3.074 | 4447.2 samples/s | 69.5 steps/s
[Step=25150 Epoch=122.6] | Loss=0.00251 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.091 | L2-Norm(final)=3.075 | 4401.4 samples/s | 68.8 steps/s
[Step=25200 Epoch=122.9] | Loss=0.00228 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.091 | L2-Norm(final)=3.076 | 5489.0 samples/s | 85.8 steps/s
[Step=25250 Epoch=123.1] | Loss=0.00217 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.091 | L2-Norm(final)=3.077 | 2032.2 samples/s | 31.8 steps/s
[Step=25300 Epoch=123.4] | Loss=0.00203 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.091 | L2-Norm(final)=3.078 | 4382.7 samples/s | 68.5 steps/s
[Step=25350 Epoch=123.6] | Loss=0.00203 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.091 | L2-Norm(final)=3.078 | 4365.9 samples/s | 68.2 steps/s
[Step=25400 Epoch=123.9] | Loss=0.00202 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.091 | L2-Norm(final)=3.079 | 5151.0 samples/s | 80.5 steps/s
[Step=25450 Epoch=124.1] | Loss=0.00199 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.090 | L2-Norm(final)=3.080 | 2086.4 samples/s | 32.6 steps/s
[Step=25500 Epoch=124.3] | Loss=0.00191 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.090 | L2-Norm(final)=3.080 | 4381.1 samples/s | 68.5 steps/s
[Step=25550 Epoch=124.6] | Loss=0.00192 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.090 | L2-Norm(final)=3.081 | 4455.7 samples/s | 69.6 steps/s
[Step=25600 Epoch=124.8] | Loss=0.00182 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.090 | L2-Norm(final)=3.082 | 4771.3 samples/s | 74.6 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step25600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=24801 Epoch=235.0] | Loss=0.12813 | Reg=0.00170 | acc=0.9219 | L2-Norm=13.054 | L2-Norm(final)=3.075 | 4461.0 samples/s | 69.7 steps/s
[Step=24850 Epoch=235.5] | Loss=0.00456 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.082 | L2-Norm(final)=3.077 | 3970.8 samples/s | 62.0 steps/s
[Step=24900 Epoch=235.9] | Loss=0.00228 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.086 | L2-Norm(final)=3.075 | 5533.0 samples/s | 86.5 steps/s
[Step=24950 Epoch=236.4] | Loss=0.00153 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.085 | L2-Norm(final)=3.075 | 1889.3 samples/s | 29.5 steps/s
[Step=25000 Epoch=236.9] | Loss=0.00115 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.084 | L2-Norm(final)=3.075 | 5265.9 samples/s | 82.3 steps/s
[Step=25050 Epoch=237.4] | Loss=0.00092 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.083 | L2-Norm(final)=3.075 | 2054.7 samples/s | 32.1 steps/s
[Step=25100 Epoch=237.8] | Loss=0.00077 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.081 | L2-Norm(final)=3.075 | 5189.1 samples/s | 81.1 steps/s
[Step=25150 Epoch=238.3] | Loss=0.00066 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.079 | L2-Norm(final)=3.075 | 2055.0 samples/s | 32.1 steps/s
[Step=25200 Epoch=238.8] | Loss=0.00058 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.077 | L2-Norm(final)=3.075 | 4489.3 samples/s | 70.1 steps/s
[Step=25250 Epoch=239.3] | Loss=0.00051 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.075 | L2-Norm(final)=3.075 | 2110.2 samples/s | 33.0 steps/s
[Step=25300 Epoch=239.7] | Loss=0.00046 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.073 | L2-Norm(final)=3.075 | 4124.4 samples/s | 64.4 steps/s
[Step=25350 Epoch=240.2] | Loss=0.00042 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.071 | L2-Norm(final)=3.075 | 2129.4 samples/s | 33.3 steps/s
[Step=25400 Epoch=240.7] | Loss=0.00039 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.069 | L2-Norm(final)=3.076 | 4244.7 samples/s | 66.3 steps/s
[Step=25450 Epoch=241.2] | Loss=0.00036 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.067 | L2-Norm(final)=3.076 | 2153.9 samples/s | 33.7 steps/s
[Step=25500 Epoch=241.6] | Loss=0.00033 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.064 | L2-Norm(final)=3.076 | 4139.5 samples/s | 64.7 steps/s
[Step=25550 Epoch=242.1] | Loss=0.00031 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.062 | L2-Norm(final)=3.076 | 2171.7 samples/s | 33.9 steps/s
[Step=25600 Epoch=242.6] | Loss=0.00029 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.060 | L2-Norm(final)=3.076 | 4261.1 samples/s | 66.6 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step25600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38159 | acc=0.8602 | tpr=0.8181 | fpr=0.0486 | 4070.7 samples/s | 15.9 steps/s
Avg test loss: 0.40141, Avg test acc: 0.85656, Avg tpr: 0.81320, Avg fpr: 0.04807, total FA: 375

Testing server on iccad2012
[Step=  50] | Loss=0.39654 | acc=0.8953 | tpr=0.8894 | fpr=0.1046 | 4031.3 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.40706 | acc=0.8914 | tpr=0.9041 | fpr=0.1088 | 7260.7 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.41351 | acc=0.8918 | tpr=0.9049 | fpr=0.1084 | 7099.3 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.41750 | acc=0.8912 | tpr=0.9104 | fpr=0.1091 | 7057.8 samples/s | 27.6 steps/s
[Step= 250] | Loss=0.41388 | acc=0.8919 | tpr=0.9118 | fpr=0.1085 | 7124.1 samples/s | 27.8 steps/s
[Step= 300] | Loss=0.41585 | acc=0.8913 | tpr=0.9098 | fpr=0.1090 | 7062.3 samples/s | 27.6 steps/s
[Step= 350] | Loss=0.41700 | acc=0.8918 | tpr=0.9086 | fpr=0.1085 | 7343.4 samples/s | 28.7 steps/s
[Step= 400] | Loss=0.41970 | acc=0.8909 | tpr=0.9114 | fpr=0.1094 | 7319.5 samples/s | 28.6 steps/s
[Step= 450] | Loss=0.42375 | acc=0.8910 | tpr=0.9119 | fpr=0.1094 | 7101.8 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.42116 | acc=0.8913 | tpr=0.9145 | fpr=0.1092 | 6948.1 samples/s | 27.1 steps/s
[Step= 550] | Loss=0.41916 | acc=0.8914 | tpr=0.9136 | fpr=0.1090 | 13250.5 samples/s | 51.8 steps/s
Avg test loss: 0.41840, Avg test acc: 0.89144, Avg tpr: 0.91403, Avg fpr: 0.10897, total FA: 15130

server round 32/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=124.8] | Loss=0.03857 | Reg=0.00170 | acc=0.9375 | L2-Norm=13.031 | L2-Norm(final)=3.084 | 4441.1 samples/s | 69.4 steps/s
[Step=25650 Epoch=125.1] | Loss=0.00637 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.052 | L2-Norm(final)=3.085 | 4383.4 samples/s | 68.5 steps/s
[Step=25700 Epoch=125.3] | Loss=0.00407 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.058 | L2-Norm(final)=3.086 | 4396.8 samples/s | 68.7 steps/s
[Step=25750 Epoch=125.6] | Loss=0.00323 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.061 | L2-Norm(final)=3.087 | 4393.4 samples/s | 68.6 steps/s
[Step=25800 Epoch=125.8] | Loss=0.00296 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.063 | L2-Norm(final)=3.088 | 5907.8 samples/s | 92.3 steps/s
[Step=25850 Epoch=126.0] | Loss=0.00273 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.064 | L2-Norm(final)=3.089 | 1999.9 samples/s | 31.2 steps/s
[Step=25900 Epoch=126.3] | Loss=0.00258 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.064 | L2-Norm(final)=3.090 | 4294.6 samples/s | 67.1 steps/s
[Step=25950 Epoch=126.5] | Loss=0.00238 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.065 | L2-Norm(final)=3.091 | 4374.0 samples/s | 68.3 steps/s
[Step=26000 Epoch=126.8] | Loss=0.00223 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.065 | L2-Norm(final)=3.092 | 5515.1 samples/s | 86.2 steps/s
[Step=26050 Epoch=127.0] | Loss=0.00208 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.065 | L2-Norm(final)=3.093 | 2035.6 samples/s | 31.8 steps/s
[Step=26100 Epoch=127.3] | Loss=0.00202 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.065 | L2-Norm(final)=3.094 | 4426.0 samples/s | 69.2 steps/s
[Step=26150 Epoch=127.5] | Loss=0.00196 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.065 | L2-Norm(final)=3.095 | 4308.0 samples/s | 67.3 steps/s
[Step=26200 Epoch=127.8] | Loss=0.00197 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.065 | L2-Norm(final)=3.095 | 5092.5 samples/s | 79.6 steps/s
[Step=26250 Epoch=128.0] | Loss=0.00190 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.065 | L2-Norm(final)=3.096 | 2120.4 samples/s | 33.1 steps/s
[Step=26300 Epoch=128.2] | Loss=0.00182 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.065 | L2-Norm(final)=3.097 | 4402.5 samples/s | 68.8 steps/s
[Step=26350 Epoch=128.5] | Loss=0.00178 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.065 | L2-Norm(final)=3.098 | 4332.3 samples/s | 67.7 steps/s
[Step=26400 Epoch=128.7] | Loss=0.00178 | Reg=0.00171 | acc=1.0000 | L2-Norm=13.065 | L2-Norm(final)=3.098 | 4810.9 samples/s | 75.2 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step26400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=25601 Epoch=242.6] | Loss=0.00248 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.031 | L2-Norm(final)=3.084 | 4778.2 samples/s | 74.7 steps/s
[Step=25650 Epoch=243.1] | Loss=0.00106 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.048 | L2-Norm(final)=3.094 | 3683.1 samples/s | 57.5 steps/s
[Step=25700 Epoch=243.5] | Loss=0.00054 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.050 | L2-Norm(final)=3.097 | 5630.0 samples/s | 88.0 steps/s
[Step=25750 Epoch=244.0] | Loss=0.00036 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.049 | L2-Norm(final)=3.098 | 1914.1 samples/s | 29.9 steps/s
[Step=25800 Epoch=244.5] | Loss=0.00027 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.047 | L2-Norm(final)=3.099 | 5057.8 samples/s | 79.0 steps/s
[Step=25850 Epoch=245.0] | Loss=0.00022 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.045 | L2-Norm(final)=3.099 | 1966.1 samples/s | 30.7 steps/s
[Step=25900 Epoch=245.4] | Loss=0.00018 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.042 | L2-Norm(final)=3.100 | 4873.4 samples/s | 76.1 steps/s
[Step=25950 Epoch=245.9] | Loss=0.00016 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.040 | L2-Norm(final)=3.101 | 1974.6 samples/s | 30.9 steps/s
[Step=26000 Epoch=246.4] | Loss=0.00014 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.037 | L2-Norm(final)=3.101 | 4481.5 samples/s | 70.0 steps/s
[Step=26050 Epoch=246.8] | Loss=0.00012 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.035 | L2-Norm(final)=3.102 | 2081.0 samples/s | 32.5 steps/s
[Step=26100 Epoch=247.3] | Loss=0.00011 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.032 | L2-Norm(final)=3.102 | 4143.7 samples/s | 64.7 steps/s
[Step=26150 Epoch=247.8] | Loss=0.00010 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.029 | L2-Norm(final)=3.103 | 2150.9 samples/s | 33.6 steps/s
[Step=26200 Epoch=248.3] | Loss=0.00009 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.027 | L2-Norm(final)=3.104 | 4100.7 samples/s | 64.1 steps/s
[Step=26250 Epoch=248.7] | Loss=0.00009 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.024 | L2-Norm(final)=3.104 | 2152.3 samples/s | 33.6 steps/s
[Step=26300 Epoch=249.2] | Loss=0.00008 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.021 | L2-Norm(final)=3.105 | 4219.4 samples/s | 65.9 steps/s
[Step=26350 Epoch=249.7] | Loss=0.00007 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.018 | L2-Norm(final)=3.105 | 2153.2 samples/s | 33.6 steps/s
[Step=26400 Epoch=250.2] | Loss=0.00007 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.015 | L2-Norm(final)=3.106 | 4231.4 samples/s | 66.1 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step26400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36338 | acc=0.8728 | tpr=0.8374 | fpr=0.0503 | 4025.4 samples/s | 15.7 steps/s
Avg test loss: 0.38065, Avg test acc: 0.87026, Avg tpr: 0.83453, Avg fpr: 0.05115, total FA: 399

Testing server on iccad2012
[Step=  50] | Loss=0.43664 | acc=0.8810 | tpr=0.8805 | fpr=0.1190 | 4031.0 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.44741 | acc=0.8798 | tpr=0.8977 | fpr=0.1205 | 7254.7 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.45413 | acc=0.8802 | tpr=0.8991 | fpr=0.1201 | 7038.4 samples/s | 27.5 steps/s
[Step= 200] | Loss=0.45817 | acc=0.8798 | tpr=0.9093 | fpr=0.1208 | 7175.2 samples/s | 28.0 steps/s
[Step= 250] | Loss=0.45466 | acc=0.8803 | tpr=0.9118 | fpr=0.1202 | 7340.9 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.45661 | acc=0.8800 | tpr=0.9098 | fpr=0.1206 | 7220.0 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.45711 | acc=0.8805 | tpr=0.9086 | fpr=0.1200 | 7051.9 samples/s | 27.5 steps/s
[Step= 400] | Loss=0.45992 | acc=0.8798 | tpr=0.9114 | fpr=0.1208 | 7500.8 samples/s | 29.3 steps/s
[Step= 450] | Loss=0.46391 | acc=0.8798 | tpr=0.9119 | fpr=0.1208 | 7051.1 samples/s | 27.5 steps/s
[Step= 500] | Loss=0.46103 | acc=0.8801 | tpr=0.9141 | fpr=0.1205 | 6984.8 samples/s | 27.3 steps/s
[Step= 550] | Loss=0.45870 | acc=0.8802 | tpr=0.9121 | fpr=0.1204 | 13752.3 samples/s | 53.7 steps/s
Avg test loss: 0.45796, Avg test acc: 0.88023, Avg tpr: 0.91244, Avg fpr: 0.12035, total FA: 16711

server round 33/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=128.7] | Loss=0.00697 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.999 | L2-Norm(final)=3.110 | 4809.0 samples/s | 75.1 steps/s
[Step=26450 Epoch=129.0] | Loss=0.00503 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.021 | L2-Norm(final)=3.109 | 4204.3 samples/s | 65.7 steps/s
[Step=26500 Epoch=129.2] | Loss=0.00346 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.026 | L2-Norm(final)=3.110 | 4338.0 samples/s | 67.8 steps/s
[Step=26550 Epoch=129.5] | Loss=0.00273 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.028 | L2-Norm(final)=3.111 | 4245.3 samples/s | 66.3 steps/s
[Step=26600 Epoch=129.7] | Loss=0.00233 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.029 | L2-Norm(final)=3.112 | 5864.6 samples/s | 91.6 steps/s
[Step=26650 Epoch=130.0] | Loss=0.00212 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.030 | L2-Norm(final)=3.113 | 1979.7 samples/s | 30.9 steps/s
[Step=26700 Epoch=130.2] | Loss=0.00196 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.030 | L2-Norm(final)=3.114 | 4364.0 samples/s | 68.2 steps/s
[Step=26750 Epoch=130.4] | Loss=0.00190 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.030 | L2-Norm(final)=3.115 | 4345.9 samples/s | 67.9 steps/s
[Step=26800 Epoch=130.7] | Loss=0.00181 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.030 | L2-Norm(final)=3.116 | 5389.7 samples/s | 84.2 steps/s
[Step=26850 Epoch=130.9] | Loss=0.00173 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.030 | L2-Norm(final)=3.117 | 2048.5 samples/s | 32.0 steps/s
[Step=26900 Epoch=131.2] | Loss=0.00173 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.029 | L2-Norm(final)=3.118 | 4301.3 samples/s | 67.2 steps/s
[Step=26950 Epoch=131.4] | Loss=0.00169 | Reg=0.00170 | acc=0.9844 | L2-Norm=13.029 | L2-Norm(final)=3.119 | 4409.6 samples/s | 68.9 steps/s
[Step=27000 Epoch=131.7] | Loss=0.00164 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.029 | L2-Norm(final)=3.120 | 5044.9 samples/s | 78.8 steps/s
[Step=27050 Epoch=131.9] | Loss=0.00161 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.029 | L2-Norm(final)=3.121 | 2062.6 samples/s | 32.2 steps/s
[Step=27100 Epoch=132.1] | Loss=0.00157 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.029 | L2-Norm(final)=3.121 | 4389.7 samples/s | 68.6 steps/s
[Step=27150 Epoch=132.4] | Loss=0.00156 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.028 | L2-Norm(final)=3.122 | 4418.4 samples/s | 69.0 steps/s
[Step=27200 Epoch=132.6] | Loss=0.00155 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.028 | L2-Norm(final)=3.123 | 4784.9 samples/s | 74.8 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step27200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=26401 Epoch=250.2] | Loss=0.00112 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.999 | L2-Norm(final)=3.110 | 4591.7 samples/s | 71.7 steps/s
[Step=26450 Epoch=250.6] | Loss=0.00259 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.020 | L2-Norm(final)=3.119 | 3836.6 samples/s | 59.9 steps/s
[Step=26500 Epoch=251.1] | Loss=0.00130 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.024 | L2-Norm(final)=3.121 | 5609.7 samples/s | 87.7 steps/s
[Step=26550 Epoch=251.6] | Loss=0.00087 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.024 | L2-Norm(final)=3.122 | 1905.2 samples/s | 29.8 steps/s
[Step=26600 Epoch=252.1] | Loss=0.00065 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.022 | L2-Norm(final)=3.123 | 5152.9 samples/s | 80.5 steps/s
[Step=26650 Epoch=252.5] | Loss=0.00052 | Reg=0.00170 | acc=1.0000 | L2-Norm=13.020 | L2-Norm(final)=3.124 | 1949.2 samples/s | 30.5 steps/s
[Step=26700 Epoch=253.0] | Loss=0.00044 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.017 | L2-Norm(final)=3.124 | 4699.8 samples/s | 73.4 steps/s
[Step=26750 Epoch=253.5] | Loss=0.00038 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.015 | L2-Norm(final)=3.125 | 2024.7 samples/s | 31.6 steps/s
[Step=26800 Epoch=254.0] | Loss=0.00033 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.012 | L2-Norm(final)=3.125 | 4566.0 samples/s | 71.3 steps/s
[Step=26850 Epoch=254.4] | Loss=0.00029 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.009 | L2-Norm(final)=3.125 | 2097.5 samples/s | 32.8 steps/s
[Step=26900 Epoch=254.9] | Loss=0.00026 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.007 | L2-Norm(final)=3.126 | 4187.4 samples/s | 65.4 steps/s
[Step=26950 Epoch=255.4] | Loss=0.00024 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.004 | L2-Norm(final)=3.126 | 2165.1 samples/s | 33.8 steps/s
[Step=27000 Epoch=255.8] | Loss=0.00022 | Reg=0.00169 | acc=1.0000 | L2-Norm=13.001 | L2-Norm(final)=3.126 | 4141.5 samples/s | 64.7 steps/s
[Step=27050 Epoch=256.3] | Loss=0.00020 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.998 | L2-Norm(final)=3.127 | 2161.7 samples/s | 33.8 steps/s
[Step=27100 Epoch=256.8] | Loss=0.00019 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.995 | L2-Norm(final)=3.127 | 4202.9 samples/s | 65.7 steps/s
[Step=27150 Epoch=257.3] | Loss=0.00018 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.992 | L2-Norm(final)=3.127 | 2183.5 samples/s | 34.1 steps/s
[Step=27200 Epoch=257.7] | Loss=0.00017 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.989 | L2-Norm(final)=3.127 | 4199.3 samples/s | 65.6 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step27200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39443 | acc=0.8612 | tpr=0.8206 | fpr=0.0505 | 3981.6 samples/s | 15.6 steps/s
Avg test loss: 0.41378, Avg test acc: 0.85792, Avg tpr: 0.81623, Avg fpr: 0.05038, total FA: 393

Testing server on iccad2012
[Step=  50] | Loss=0.38288 | acc=0.8992 | tpr=0.8894 | fpr=0.1006 | 3982.4 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.39229 | acc=0.8977 | tpr=0.9041 | fpr=0.1024 | 7264.0 samples/s | 28.4 steps/s
[Step= 150] | Loss=0.39956 | acc=0.8976 | tpr=0.9049 | fpr=0.1025 | 7267.0 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.40288 | acc=0.8973 | tpr=0.9104 | fpr=0.1030 | 7242.7 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.39928 | acc=0.8975 | tpr=0.9109 | fpr=0.1028 | 7299.1 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.40092 | acc=0.8972 | tpr=0.9098 | fpr=0.1030 | 7059.8 samples/s | 27.6 steps/s
[Step= 350] | Loss=0.40195 | acc=0.8976 | tpr=0.9092 | fpr=0.1026 | 7736.6 samples/s | 30.2 steps/s
[Step= 400] | Loss=0.40454 | acc=0.8970 | tpr=0.9125 | fpr=0.1033 | 6891.6 samples/s | 26.9 steps/s
[Step= 450] | Loss=0.40860 | acc=0.8971 | tpr=0.9138 | fpr=0.1032 | 7015.4 samples/s | 27.4 steps/s
[Step= 500] | Loss=0.40609 | acc=0.8973 | tpr=0.9159 | fpr=0.1031 | 7243.3 samples/s | 28.3 steps/s
[Step= 550] | Loss=0.40397 | acc=0.8976 | tpr=0.9140 | fpr=0.1027 | 13300.1 samples/s | 52.0 steps/s
Avg test loss: 0.40321, Avg test acc: 0.89769, Avg tpr: 0.91442, Avg fpr: 0.10262, total FA: 14248

server round 34/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=132.6] | Loss=0.06999 | Reg=0.00168 | acc=0.9531 | L2-Norm=12.964 | L2-Norm(final)=3.131 | 4602.2 samples/s | 71.9 steps/s
[Step=27250 Epoch=132.9] | Loss=0.00496 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.987 | L2-Norm(final)=3.127 | 4091.4 samples/s | 63.9 steps/s
[Step=27300 Epoch=133.1] | Loss=0.00332 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.992 | L2-Norm(final)=3.128 | 4266.7 samples/s | 66.7 steps/s
[Step=27350 Epoch=133.4] | Loss=0.00316 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.994 | L2-Norm(final)=3.128 | 4353.5 samples/s | 68.0 steps/s
[Step=27400 Epoch=133.6] | Loss=0.00259 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.994 | L2-Norm(final)=3.128 | 5946.0 samples/s | 92.9 steps/s
[Step=27450 Epoch=133.9] | Loss=0.00236 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.995 | L2-Norm(final)=3.129 | 1979.7 samples/s | 30.9 steps/s
[Step=27500 Epoch=134.1] | Loss=0.00218 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.995 | L2-Norm(final)=3.130 | 4352.2 samples/s | 68.0 steps/s
[Step=27550 Epoch=134.3] | Loss=0.00205 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.995 | L2-Norm(final)=3.131 | 4406.1 samples/s | 68.8 steps/s
[Step=27600 Epoch=134.6] | Loss=0.00201 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.995 | L2-Norm(final)=3.132 | 5600.2 samples/s | 87.5 steps/s
[Step=27650 Epoch=134.8] | Loss=0.00186 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.995 | L2-Norm(final)=3.133 | 2062.0 samples/s | 32.2 steps/s
[Step=27700 Epoch=135.1] | Loss=0.00185 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.994 | L2-Norm(final)=3.133 | 4411.8 samples/s | 68.9 steps/s
[Step=27750 Epoch=135.3] | Loss=0.00179 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.994 | L2-Norm(final)=3.134 | 4374.4 samples/s | 68.4 steps/s
[Step=27800 Epoch=135.6] | Loss=0.00182 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.994 | L2-Norm(final)=3.135 | 4976.1 samples/s | 77.8 steps/s
[Step=27850 Epoch=135.8] | Loss=0.00179 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.994 | L2-Norm(final)=3.136 | 2141.6 samples/s | 33.5 steps/s
[Step=27900 Epoch=136.0] | Loss=0.00178 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.993 | L2-Norm(final)=3.136 | 4370.8 samples/s | 68.3 steps/s
[Step=27950 Epoch=136.3] | Loss=0.00172 | Reg=0.00169 | acc=0.9844 | L2-Norm=12.993 | L2-Norm(final)=3.137 | 4334.2 samples/s | 67.7 steps/s
[Step=28000 Epoch=136.5] | Loss=0.00169 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.993 | L2-Norm(final)=3.138 | 4686.3 samples/s | 73.2 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step28000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=27201 Epoch=257.8] | Loss=0.05345 | Reg=0.00168 | acc=0.9688 | L2-Norm=12.964 | L2-Norm(final)=3.133 | 4842.6 samples/s | 75.7 steps/s
[Step=27250 Epoch=258.2] | Loss=0.00131 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.980 | L2-Norm(final)=3.143 | 3668.8 samples/s | 57.3 steps/s
[Step=27300 Epoch=258.7] | Loss=0.00066 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.983 | L2-Norm(final)=3.146 | 5639.7 samples/s | 88.1 steps/s
[Step=27350 Epoch=259.2] | Loss=0.00044 | Reg=0.00169 | acc=1.0000 | L2-Norm=12.981 | L2-Norm(final)=3.147 | 1904.0 samples/s | 29.7 steps/s
[Step=27400 Epoch=259.6] | Loss=0.00033 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.979 | L2-Norm(final)=3.147 | 5070.3 samples/s | 79.2 steps/s
[Step=27450 Epoch=260.1] | Loss=0.00026 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.976 | L2-Norm(final)=3.148 | 1968.2 samples/s | 30.8 steps/s
[Step=27500 Epoch=260.6] | Loss=0.00022 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.973 | L2-Norm(final)=3.148 | 4745.4 samples/s | 74.1 steps/s
[Step=27550 Epoch=261.1] | Loss=0.00019 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.970 | L2-Norm(final)=3.148 | 2024.5 samples/s | 31.6 steps/s
[Step=27600 Epoch=261.5] | Loss=0.00017 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.966 | L2-Norm(final)=3.148 | 4629.3 samples/s | 72.3 steps/s
[Step=27650 Epoch=262.0] | Loss=0.00015 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.963 | L2-Norm(final)=3.148 | 2091.1 samples/s | 32.7 steps/s
[Step=27700 Epoch=262.5] | Loss=0.00013 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.960 | L2-Norm(final)=3.149 | 4238.0 samples/s | 66.2 steps/s
[Step=27750 Epoch=263.0] | Loss=0.00012 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.956 | L2-Norm(final)=3.149 | 2175.6 samples/s | 34.0 steps/s
[Step=27800 Epoch=263.4] | Loss=0.00011 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.953 | L2-Norm(final)=3.149 | 4111.5 samples/s | 64.2 steps/s
[Step=27850 Epoch=263.9] | Loss=0.00010 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.949 | L2-Norm(final)=3.149 | 2170.6 samples/s | 33.9 steps/s
[Step=27900 Epoch=264.4] | Loss=0.00010 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.946 | L2-Norm(final)=3.150 | 4162.0 samples/s | 65.0 steps/s
[Step=27950 Epoch=264.9] | Loss=0.00009 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.943 | L2-Norm(final)=3.150 | 2267.8 samples/s | 35.4 steps/s
[Step=28000 Epoch=265.3] | Loss=0.00008 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.939 | L2-Norm(final)=3.150 | 3987.8 samples/s | 62.3 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step28000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37394 | acc=0.8702 | tpr=0.8364 | fpr=0.0565 | 3941.0 samples/s | 15.4 steps/s
Avg test loss: 0.39221, Avg test acc: 0.86662, Avg tpr: 0.83173, Avg fpr: 0.05666, total FA: 442

Testing server on iccad2012
[Step=  50] | Loss=0.41546 | acc=0.8923 | tpr=0.8938 | fpr=0.1078 | 3963.1 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.42742 | acc=0.8894 | tpr=0.9041 | fpr=0.1109 | 7522.3 samples/s | 29.4 steps/s
[Step= 150] | Loss=0.43424 | acc=0.8897 | tpr=0.9035 | fpr=0.1105 | 7098.1 samples/s | 27.7 steps/s
[Step= 200] | Loss=0.43840 | acc=0.8894 | tpr=0.9093 | fpr=0.1109 | 7246.8 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.43502 | acc=0.8896 | tpr=0.9092 | fpr=0.1108 | 7247.2 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.43710 | acc=0.8893 | tpr=0.9091 | fpr=0.1110 | 7473.7 samples/s | 29.2 steps/s
[Step= 350] | Loss=0.43781 | acc=0.8902 | tpr=0.9105 | fpr=0.1102 | 7300.9 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.44031 | acc=0.8894 | tpr=0.9141 | fpr=0.1110 | 7104.4 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.44419 | acc=0.8894 | tpr=0.9153 | fpr=0.1111 | 7118.2 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.44144 | acc=0.8896 | tpr=0.9176 | fpr=0.1109 | 7185.4 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.43922 | acc=0.8898 | tpr=0.9160 | fpr=0.1106 | 13165.1 samples/s | 51.4 steps/s
Avg test loss: 0.43843, Avg test acc: 0.88990, Avg tpr: 0.91640, Avg fpr: 0.11058, total FA: 15354

server round 35/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=136.5] | Loss=0.01798 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.917 | L2-Norm(final)=3.151 | 5057.9 samples/s | 79.0 steps/s
[Step=28050 Epoch=136.8] | Loss=0.00303 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.936 | L2-Norm(final)=3.155 | 4122.3 samples/s | 64.4 steps/s
[Step=28100 Epoch=137.0] | Loss=0.00237 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.939 | L2-Norm(final)=3.156 | 4374.9 samples/s | 68.4 steps/s
[Step=28150 Epoch=137.3] | Loss=0.00191 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.941 | L2-Norm(final)=3.157 | 4349.5 samples/s | 68.0 steps/s
[Step=28200 Epoch=137.5] | Loss=0.00197 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.941 | L2-Norm(final)=3.159 | 5828.9 samples/s | 91.1 steps/s
[Step=28250 Epoch=137.8] | Loss=0.00191 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.941 | L2-Norm(final)=3.159 | 2002.8 samples/s | 31.3 steps/s
[Step=28300 Epoch=138.0] | Loss=0.00180 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.941 | L2-Norm(final)=3.160 | 4341.9 samples/s | 67.8 steps/s
[Step=28350 Epoch=138.2] | Loss=0.00160 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.941 | L2-Norm(final)=3.161 | 4406.3 samples/s | 68.8 steps/s
[Step=28400 Epoch=138.5] | Loss=0.00163 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.940 | L2-Norm(final)=3.162 | 5386.9 samples/s | 84.2 steps/s
[Step=28450 Epoch=138.7] | Loss=0.00165 | Reg=0.00167 | acc=0.9844 | L2-Norm=12.940 | L2-Norm(final)=3.162 | 2044.9 samples/s | 32.0 steps/s
[Step=28500 Epoch=139.0] | Loss=0.00165 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.940 | L2-Norm(final)=3.163 | 4298.3 samples/s | 67.2 steps/s
[Step=28550 Epoch=139.2] | Loss=0.00158 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.939 | L2-Norm(final)=3.164 | 4316.2 samples/s | 67.4 steps/s
[Step=28600 Epoch=139.5] | Loss=0.00151 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.939 | L2-Norm(final)=3.165 | 4978.0 samples/s | 77.8 steps/s
[Step=28650 Epoch=139.7] | Loss=0.00150 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.939 | L2-Norm(final)=3.166 | 2080.5 samples/s | 32.5 steps/s
[Step=28700 Epoch=139.9] | Loss=0.00144 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.938 | L2-Norm(final)=3.167 | 4455.9 samples/s | 69.6 steps/s
[Step=28750 Epoch=140.2] | Loss=0.00147 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.938 | L2-Norm(final)=3.168 | 4451.5 samples/s | 69.6 steps/s
[Step=28800 Epoch=140.4] | Loss=0.00148 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.937 | L2-Norm(final)=3.169 | 4836.4 samples/s | 75.6 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step28800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28001 Epoch=265.3] | Loss=0.00101 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.917 | L2-Norm(final)=3.151 | 4432.2 samples/s | 69.3 steps/s
[Step=28050 Epoch=265.8] | Loss=0.00099 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.941 | L2-Norm(final)=3.161 | 3856.0 samples/s | 60.2 steps/s
[Step=28100 Epoch=266.3] | Loss=0.00050 | Reg=0.00168 | acc=1.0000 | L2-Norm=12.944 | L2-Norm(final)=3.163 | 5560.3 samples/s | 86.9 steps/s
[Step=28150 Epoch=266.7] | Loss=0.00033 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.941 | L2-Norm(final)=3.164 | 1898.0 samples/s | 29.7 steps/s
[Step=28200 Epoch=267.2] | Loss=0.00025 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.938 | L2-Norm(final)=3.164 | 5147.3 samples/s | 80.4 steps/s
[Step=28250 Epoch=267.7] | Loss=0.00020 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.934 | L2-Norm(final)=3.165 | 1947.4 samples/s | 30.4 steps/s
[Step=28300 Epoch=268.2] | Loss=0.00017 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.931 | L2-Norm(final)=3.165 | 4983.7 samples/s | 77.9 steps/s
[Step=28350 Epoch=268.6] | Loss=0.00014 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.927 | L2-Norm(final)=3.165 | 2049.0 samples/s | 32.0 steps/s
[Step=28400 Epoch=269.1] | Loss=0.00013 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.923 | L2-Norm(final)=3.165 | 4529.2 samples/s | 70.8 steps/s
[Step=28450 Epoch=269.6] | Loss=0.00011 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.919 | L2-Norm(final)=3.166 | 2083.3 samples/s | 32.6 steps/s
[Step=28500 Epoch=270.1] | Loss=0.00010 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.915 | L2-Norm(final)=3.166 | 4219.3 samples/s | 65.9 steps/s
[Step=28550 Epoch=270.5] | Loss=0.00009 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.911 | L2-Norm(final)=3.166 | 2142.3 samples/s | 33.5 steps/s
[Step=28600 Epoch=271.0] | Loss=0.00008 | Reg=0.00167 | acc=1.0000 | L2-Norm=12.907 | L2-Norm(final)=3.166 | 4107.9 samples/s | 64.2 steps/s
[Step=28650 Epoch=271.5] | Loss=0.00008 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.903 | L2-Norm(final)=3.166 | 2151.1 samples/s | 33.6 steps/s
[Step=28700 Epoch=272.0] | Loss=0.00007 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.899 | L2-Norm(final)=3.166 | 4166.6 samples/s | 65.1 steps/s
[Step=28750 Epoch=272.4] | Loss=0.00007 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.895 | L2-Norm(final)=3.167 | 2187.7 samples/s | 34.2 steps/s
[Step=28800 Epoch=272.9] | Loss=0.00006 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.891 | L2-Norm(final)=3.167 | 4139.7 samples/s | 64.7 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step28800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.38548 | acc=0.8680 | tpr=0.8316 | fpr=0.0530 | 4011.1 samples/s | 15.7 steps/s
Avg test loss: 0.40525, Avg test acc: 0.86493, Avg tpr: 0.82788, Avg fpr: 0.05358, total FA: 418

Testing server on iccad2012
[Step=  50] | Loss=0.40163 | acc=0.8987 | tpr=0.8938 | fpr=0.1012 | 4121.4 samples/s | 16.1 steps/s
[Step= 100] | Loss=0.41414 | acc=0.8952 | tpr=0.9041 | fpr=0.1050 | 6872.1 samples/s | 26.8 steps/s
[Step= 150] | Loss=0.42048 | acc=0.8960 | tpr=0.9020 | fpr=0.1041 | 7130.0 samples/s | 27.9 steps/s
[Step= 200] | Loss=0.42472 | acc=0.8956 | tpr=0.9093 | fpr=0.1046 | 7336.1 samples/s | 28.7 steps/s
[Step= 250] | Loss=0.42140 | acc=0.8959 | tpr=0.9066 | fpr=0.1043 | 7406.1 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.42329 | acc=0.8958 | tpr=0.9062 | fpr=0.1044 | 7084.4 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.42442 | acc=0.8964 | tpr=0.9067 | fpr=0.1038 | 7187.8 samples/s | 28.1 steps/s
[Step= 400] | Loss=0.42678 | acc=0.8957 | tpr=0.9097 | fpr=0.1045 | 7156.0 samples/s | 28.0 steps/s
[Step= 450] | Loss=0.43089 | acc=0.8958 | tpr=0.9109 | fpr=0.1045 | 7130.7 samples/s | 27.9 steps/s
[Step= 500] | Loss=0.42829 | acc=0.8958 | tpr=0.9137 | fpr=0.1045 | 7344.1 samples/s | 28.7 steps/s
[Step= 550] | Loss=0.42606 | acc=0.8961 | tpr=0.9133 | fpr=0.1043 | 12979.2 samples/s | 50.7 steps/s
Avg test loss: 0.42518, Avg test acc: 0.89611, Avg tpr: 0.91363, Avg fpr: 0.10421, total FA: 14469

server round 36/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=140.4] | Loss=0.05472 | Reg=0.00165 | acc=0.9531 | L2-Norm=12.861 | L2-Norm(final)=3.174 | 4920.5 samples/s | 76.9 steps/s
[Step=28850 Epoch=140.7] | Loss=0.00504 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.889 | L2-Norm(final)=3.168 | 4096.6 samples/s | 64.0 steps/s
[Step=28900 Epoch=140.9] | Loss=0.00371 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.896 | L2-Norm(final)=3.168 | 4421.4 samples/s | 69.1 steps/s
[Step=28950 Epoch=141.2] | Loss=0.00330 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.898 | L2-Norm(final)=3.169 | 4373.2 samples/s | 68.3 steps/s
[Step=29000 Epoch=141.4] | Loss=0.00279 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=3.169 | 5899.8 samples/s | 92.2 steps/s
[Step=29050 Epoch=141.7] | Loss=0.00253 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=3.170 | 2011.0 samples/s | 31.4 steps/s
[Step=29100 Epoch=141.9] | Loss=0.00243 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=3.171 | 4460.4 samples/s | 69.7 steps/s
[Step=29150 Epoch=142.1] | Loss=0.00223 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=3.172 | 4397.5 samples/s | 68.7 steps/s
[Step=29200 Epoch=142.4] | Loss=0.00212 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=3.173 | 5519.1 samples/s | 86.2 steps/s
[Step=29250 Epoch=142.6] | Loss=0.00199 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=3.174 | 2037.6 samples/s | 31.8 steps/s
[Step=29300 Epoch=142.9] | Loss=0.00199 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=3.175 | 4404.1 samples/s | 68.8 steps/s
[Step=29350 Epoch=143.1] | Loss=0.00191 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.901 | L2-Norm(final)=3.176 | 4412.5 samples/s | 68.9 steps/s
[Step=29400 Epoch=143.4] | Loss=0.00189 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.901 | L2-Norm(final)=3.177 | 5034.2 samples/s | 78.7 steps/s
[Step=29450 Epoch=143.6] | Loss=0.00184 | Reg=0.00166 | acc=0.9844 | L2-Norm=12.900 | L2-Norm(final)=3.178 | 2100.8 samples/s | 32.8 steps/s
[Step=29500 Epoch=143.8] | Loss=0.00175 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=3.179 | 4328.6 samples/s | 67.6 steps/s
[Step=29550 Epoch=144.1] | Loss=0.00171 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=3.180 | 4416.1 samples/s | 69.0 steps/s
[Step=29600 Epoch=144.3] | Loss=0.00170 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.900 | L2-Norm(final)=3.181 | 4834.7 samples/s | 75.5 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step29600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=28801 Epoch=272.9] | Loss=0.00177 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.861 | L2-Norm(final)=3.175 | 4459.4 samples/s | 69.7 steps/s
[Step=28850 Epoch=273.4] | Loss=0.00067 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.875 | L2-Norm(final)=3.180 | 4087.0 samples/s | 63.9 steps/s
[Step=28900 Epoch=273.9] | Loss=0.00034 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.876 | L2-Norm(final)=3.182 | 5570.4 samples/s | 87.0 steps/s
[Step=28950 Epoch=274.3] | Loss=0.00023 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.873 | L2-Norm(final)=3.182 | 1895.4 samples/s | 29.6 steps/s
[Step=29000 Epoch=274.8] | Loss=0.00017 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.870 | L2-Norm(final)=3.183 | 5039.0 samples/s | 78.7 steps/s
[Step=29050 Epoch=275.3] | Loss=0.00014 | Reg=0.00166 | acc=1.0000 | L2-Norm=12.865 | L2-Norm(final)=3.183 | 1991.4 samples/s | 31.1 steps/s
[Step=29100 Epoch=275.7] | Loss=0.00012 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.861 | L2-Norm(final)=3.184 | 4799.9 samples/s | 75.0 steps/s
[Step=29150 Epoch=276.2] | Loss=0.00010 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.857 | L2-Norm(final)=3.184 | 2040.4 samples/s | 31.9 steps/s
[Step=29200 Epoch=276.7] | Loss=0.00009 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.852 | L2-Norm(final)=3.184 | 4348.3 samples/s | 67.9 steps/s
[Step=29250 Epoch=277.2] | Loss=0.00008 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.848 | L2-Norm(final)=3.184 | 2093.9 samples/s | 32.7 steps/s
[Step=29300 Epoch=277.6] | Loss=0.00007 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.844 | L2-Norm(final)=3.184 | 4167.3 samples/s | 65.1 steps/s
[Step=29350 Epoch=278.1] | Loss=0.00006 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.839 | L2-Norm(final)=3.185 | 2143.9 samples/s | 33.5 steps/s
[Step=29400 Epoch=278.6] | Loss=0.00006 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.834 | L2-Norm(final)=3.185 | 4123.9 samples/s | 64.4 steps/s
[Step=29450 Epoch=279.1] | Loss=0.00005 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.830 | L2-Norm(final)=3.185 | 2154.7 samples/s | 33.7 steps/s
[Step=29500 Epoch=279.5] | Loss=0.00005 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.825 | L2-Norm(final)=3.185 | 4203.5 samples/s | 65.7 steps/s
[Step=29550 Epoch=280.0] | Loss=0.00005 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.820 | L2-Norm(final)=3.185 | 2171.1 samples/s | 33.9 steps/s
[Step=29600 Epoch=280.5] | Loss=0.00004 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.816 | L2-Norm(final)=3.185 | 4255.1 samples/s | 66.5 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step29600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34048 | acc=0.8845 | tpr=0.8570 | fpr=0.0560 | 3934.0 samples/s | 15.4 steps/s
Avg test loss: 0.35914, Avg test acc: 0.88252, Avg tpr: 0.85545, Avg fpr: 0.05794, total FA: 452

Testing server on iccad2012
[Step=  50] | Loss=0.49582 | acc=0.8715 | tpr=0.9027 | fpr=0.1291 | 4010.0 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.51221 | acc=0.8691 | tpr=0.9126 | fpr=0.1317 | 7105.0 samples/s | 27.8 steps/s
[Step= 150] | Loss=0.51899 | acc=0.8694 | tpr=0.9092 | fpr=0.1313 | 7195.3 samples/s | 28.1 steps/s
[Step= 200] | Loss=0.52350 | acc=0.8693 | tpr=0.9169 | fpr=0.1316 | 7144.5 samples/s | 27.9 steps/s
[Step= 250] | Loss=0.52037 | acc=0.8693 | tpr=0.9144 | fpr=0.1315 | 7155.4 samples/s | 28.0 steps/s
[Step= 300] | Loss=0.52278 | acc=0.8688 | tpr=0.9156 | fpr=0.1320 | 7304.1 samples/s | 28.5 steps/s
[Step= 350] | Loss=0.52336 | acc=0.8697 | tpr=0.9155 | fpr=0.1312 | 7213.8 samples/s | 28.2 steps/s
[Step= 400] | Loss=0.52619 | acc=0.8690 | tpr=0.9185 | fpr=0.1319 | 7237.9 samples/s | 28.3 steps/s
[Step= 450] | Loss=0.53002 | acc=0.8690 | tpr=0.9202 | fpr=0.1319 | 7099.1 samples/s | 27.7 steps/s
[Step= 500] | Loss=0.52724 | acc=0.8690 | tpr=0.9220 | fpr=0.1319 | 7374.3 samples/s | 28.8 steps/s
[Step= 550] | Loss=0.52486 | acc=0.8691 | tpr=0.9208 | fpr=0.1318 | 12474.7 samples/s | 48.7 steps/s
Avg test loss: 0.52392, Avg test acc: 0.86917, Avg tpr: 0.92116, Avg fpr: 0.13178, total FA: 18297

server round 37/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=144.3] | Loss=0.00303 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.801 | L2-Norm(final)=3.191 | 4578.5 samples/s | 71.5 steps/s
[Step=29650 Epoch=144.6] | Loss=0.00305 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.820 | L2-Norm(final)=3.195 | 4248.6 samples/s | 66.4 steps/s
[Step=29700 Epoch=144.8] | Loss=0.00296 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.822 | L2-Norm(final)=3.195 | 4434.0 samples/s | 69.3 steps/s
[Step=29750 Epoch=145.1] | Loss=0.00221 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.823 | L2-Norm(final)=3.196 | 4403.3 samples/s | 68.8 steps/s
[Step=29800 Epoch=145.3] | Loss=0.00189 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.824 | L2-Norm(final)=3.197 | 5906.9 samples/s | 92.3 steps/s
[Step=29850 Epoch=145.6] | Loss=0.00181 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.824 | L2-Norm(final)=3.198 | 1975.0 samples/s | 30.9 steps/s
[Step=29900 Epoch=145.8] | Loss=0.00174 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.824 | L2-Norm(final)=3.199 | 4396.0 samples/s | 68.7 steps/s
[Step=29950 Epoch=146.0] | Loss=0.00164 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.824 | L2-Norm(final)=3.200 | 4380.3 samples/s | 68.4 steps/s
[Step=30000 Epoch=146.3] | Loss=0.00156 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.824 | L2-Norm(final)=3.201 | 5641.7 samples/s | 88.2 steps/s
[Step=30050 Epoch=146.5] | Loss=0.00155 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.824 | L2-Norm(final)=3.202 | 2074.3 samples/s | 32.4 steps/s
[Step=30100 Epoch=146.8] | Loss=0.00150 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.823 | L2-Norm(final)=3.203 | 4499.2 samples/s | 70.3 steps/s
[Step=30150 Epoch=147.0] | Loss=0.00148 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.823 | L2-Norm(final)=3.204 | 4268.0 samples/s | 66.7 steps/s
[Step=30200 Epoch=147.3] | Loss=0.00145 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.823 | L2-Norm(final)=3.204 | 4997.3 samples/s | 78.1 steps/s
[Step=30250 Epoch=147.5] | Loss=0.00161 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.823 | L2-Norm(final)=3.205 | 2121.7 samples/s | 33.2 steps/s
[Step=30300 Epoch=147.7] | Loss=0.00159 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.822 | L2-Norm(final)=3.206 | 4436.1 samples/s | 69.3 steps/s
[Step=30350 Epoch=148.0] | Loss=0.00151 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.822 | L2-Norm(final)=3.207 | 4351.4 samples/s | 68.0 steps/s
[Step=30400 Epoch=148.2] | Loss=0.00146 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.822 | L2-Norm(final)=3.207 | 4666.2 samples/s | 72.9 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step30400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=29601 Epoch=280.5] | Loss=0.00030 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.801 | L2-Norm(final)=3.191 | 4424.3 samples/s | 69.1 steps/s
[Step=29650 Epoch=281.0] | Loss=0.00144 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.836 | L2-Norm(final)=3.201 | 4052.4 samples/s | 63.3 steps/s
[Step=29700 Epoch=281.4] | Loss=0.00072 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.840 | L2-Norm(final)=3.202 | 5539.9 samples/s | 86.6 steps/s
[Step=29750 Epoch=281.9] | Loss=0.00048 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.840 | L2-Norm(final)=3.203 | 1909.8 samples/s | 29.8 steps/s
[Step=29800 Epoch=282.4] | Loss=0.00036 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.837 | L2-Norm(final)=3.203 | 5232.5 samples/s | 81.8 steps/s
[Step=29850 Epoch=282.9] | Loss=0.00029 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.834 | L2-Norm(final)=3.204 | 1974.1 samples/s | 30.8 steps/s
[Step=29900 Epoch=283.3] | Loss=0.00024 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.831 | L2-Norm(final)=3.205 | 4721.2 samples/s | 73.8 steps/s
[Step=29950 Epoch=283.8] | Loss=0.00021 | Reg=0.00165 | acc=1.0000 | L2-Norm=12.828 | L2-Norm(final)=3.205 | 2022.0 samples/s | 31.6 steps/s
[Step=30000 Epoch=284.3] | Loss=0.00018 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.824 | L2-Norm(final)=3.206 | 4487.9 samples/s | 70.1 steps/s
[Step=30050 Epoch=284.7] | Loss=0.00016 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.821 | L2-Norm(final)=3.206 | 2098.5 samples/s | 32.8 steps/s
[Step=30100 Epoch=285.2] | Loss=0.00015 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.817 | L2-Norm(final)=3.207 | 4196.6 samples/s | 65.6 steps/s
[Step=30150 Epoch=285.7] | Loss=0.00013 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.814 | L2-Norm(final)=3.207 | 2139.0 samples/s | 33.4 steps/s
[Step=30200 Epoch=286.2] | Loss=0.00012 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.810 | L2-Norm(final)=3.207 | 4175.2 samples/s | 65.2 steps/s
[Step=30250 Epoch=286.6] | Loss=0.00011 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.806 | L2-Norm(final)=3.208 | 2186.7 samples/s | 34.2 steps/s
[Step=30300 Epoch=287.1] | Loss=0.00010 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.802 | L2-Norm(final)=3.208 | 4160.5 samples/s | 65.0 steps/s
[Step=30350 Epoch=287.6] | Loss=0.00010 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.799 | L2-Norm(final)=3.208 | 2188.3 samples/s | 34.2 steps/s
[Step=30400 Epoch=288.1] | Loss=0.00009 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.795 | L2-Norm(final)=3.209 | 4093.0 samples/s | 64.0 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step30400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.42868 | acc=0.8535 | tpr=0.8083 | fpr=0.0483 | 4067.3 samples/s | 15.9 steps/s
Avg test loss: 0.44872, Avg test acc: 0.85167, Avg tpr: 0.80667, Avg fpr: 0.04935, total FA: 385

Testing server on iccad2012
[Step=  50] | Loss=0.36208 | acc=0.9159 | tpr=0.8938 | fpr=0.0837 | 3997.4 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.37291 | acc=0.9139 | tpr=0.9062 | fpr=0.0859 | 7233.1 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.37987 | acc=0.9141 | tpr=0.9035 | fpr=0.0857 | 7219.0 samples/s | 28.2 steps/s
[Step= 200] | Loss=0.38419 | acc=0.9139 | tpr=0.9115 | fpr=0.0860 | 7298.1 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.38050 | acc=0.9143 | tpr=0.9083 | fpr=0.0856 | 7316.2 samples/s | 28.6 steps/s
[Step= 300] | Loss=0.38220 | acc=0.9142 | tpr=0.9055 | fpr=0.0857 | 7279.9 samples/s | 28.4 steps/s
[Step= 350] | Loss=0.38403 | acc=0.9141 | tpr=0.9036 | fpr=0.0857 | 7174.8 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.38634 | acc=0.9135 | tpr=0.9054 | fpr=0.0863 | 7090.4 samples/s | 27.7 steps/s
[Step= 450] | Loss=0.39048 | acc=0.9134 | tpr=0.9070 | fpr=0.0865 | 7062.2 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.38775 | acc=0.9135 | tpr=0.9115 | fpr=0.0864 | 7129.7 samples/s | 27.9 steps/s
[Step= 550] | Loss=0.38559 | acc=0.9137 | tpr=0.9097 | fpr=0.0862 | 13002.6 samples/s | 50.8 steps/s
Avg test loss: 0.38461, Avg test acc: 0.91376, Avg tpr: 0.91006, Avg fpr: 0.08617, total FA: 11965

server round 38/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=148.2] | Loss=0.03544 | Reg=0.00163 | acc=0.9688 | L2-Norm=12.755 | L2-Norm(final)=3.215 | 4737.8 samples/s | 74.0 steps/s
[Step=30450 Epoch=148.5] | Loss=0.00410 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.786 | L2-Norm(final)=3.208 | 3971.8 samples/s | 62.1 steps/s
[Step=30500 Epoch=148.7] | Loss=0.00272 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.792 | L2-Norm(final)=3.207 | 4289.7 samples/s | 67.0 steps/s
[Step=30550 Epoch=149.0] | Loss=0.00279 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.794 | L2-Norm(final)=3.207 | 4334.1 samples/s | 67.7 steps/s
[Step=30600 Epoch=149.2] | Loss=0.00263 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.795 | L2-Norm(final)=3.208 | 5826.9 samples/s | 91.0 steps/s
[Step=30650 Epoch=149.5] | Loss=0.00247 | Reg=0.00164 | acc=0.9844 | L2-Norm=12.796 | L2-Norm(final)=3.209 | 1960.9 samples/s | 30.6 steps/s
[Step=30700 Epoch=149.7] | Loss=0.00225 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.796 | L2-Norm(final)=3.209 | 4370.3 samples/s | 68.3 steps/s
[Step=30750 Epoch=149.9] | Loss=0.00212 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.796 | L2-Norm(final)=3.210 | 4483.2 samples/s | 70.0 steps/s
[Step=30800 Epoch=150.2] | Loss=0.00197 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.796 | L2-Norm(final)=3.211 | 5547.2 samples/s | 86.7 steps/s
[Step=30850 Epoch=150.4] | Loss=0.00190 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.796 | L2-Norm(final)=3.212 | 2009.7 samples/s | 31.4 steps/s
[Step=30900 Epoch=150.7] | Loss=0.00178 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.796 | L2-Norm(final)=3.213 | 4266.4 samples/s | 66.7 steps/s
[Step=30950 Epoch=150.9] | Loss=0.00174 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.795 | L2-Norm(final)=3.214 | 4302.2 samples/s | 67.2 steps/s
[Step=31000 Epoch=151.2] | Loss=0.00179 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.795 | L2-Norm(final)=3.215 | 5193.7 samples/s | 81.2 steps/s
[Step=31050 Epoch=151.4] | Loss=0.00174 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.795 | L2-Norm(final)=3.216 | 2130.3 samples/s | 33.3 steps/s
[Step=31100 Epoch=151.6] | Loss=0.00169 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.795 | L2-Norm(final)=3.217 | 4216.0 samples/s | 65.9 steps/s
[Step=31150 Epoch=151.9] | Loss=0.00165 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.795 | L2-Norm(final)=3.218 | 4388.7 samples/s | 68.6 steps/s
[Step=31200 Epoch=152.1] | Loss=0.00171 | Reg=0.00164 | acc=1.0000 | L2-Norm=12.794 | L2-Norm(final)=3.218 | 4673.7 samples/s | 73.0 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step31200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=30401 Epoch=288.1] | Loss=0.00344 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.755 | L2-Norm(final)=3.216 | 4293.5 samples/s | 67.1 steps/s
[Step=30450 Epoch=288.5] | Loss=0.00025 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.772 | L2-Norm(final)=3.225 | 4107.0 samples/s | 64.2 steps/s
[Step=30500 Epoch=289.0] | Loss=0.00013 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.777 | L2-Norm(final)=3.229 | 5607.5 samples/s | 87.6 steps/s
[Step=30550 Epoch=289.5] | Loss=0.00008 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.775 | L2-Norm(final)=3.230 | 1895.4 samples/s | 29.6 steps/s
[Step=30600 Epoch=290.0] | Loss=0.00006 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.772 | L2-Norm(final)=3.231 | 5221.6 samples/s | 81.6 steps/s
[Step=30650 Epoch=290.4] | Loss=0.00005 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.768 | L2-Norm(final)=3.231 | 1965.7 samples/s | 30.7 steps/s
[Step=30700 Epoch=290.9] | Loss=0.00004 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.765 | L2-Norm(final)=3.231 | 4885.4 samples/s | 76.3 steps/s
[Step=30750 Epoch=291.4] | Loss=0.00004 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.760 | L2-Norm(final)=3.232 | 2011.0 samples/s | 31.4 steps/s
[Step=30800 Epoch=291.9] | Loss=0.00003 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.756 | L2-Norm(final)=3.232 | 4434.8 samples/s | 69.3 steps/s
[Step=30850 Epoch=292.3] | Loss=0.00003 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.752 | L2-Norm(final)=3.232 | 2071.9 samples/s | 32.4 steps/s
[Step=30900 Epoch=292.8] | Loss=0.00003 | Reg=0.00163 | acc=1.0000 | L2-Norm=12.748 | L2-Norm(final)=3.232 | 4170.5 samples/s | 65.2 steps/s
[Step=30950 Epoch=293.3] | Loss=0.00002 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.743 | L2-Norm(final)=3.232 | 2116.8 samples/s | 33.1 steps/s
[Step=31000 Epoch=293.8] | Loss=0.00002 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.739 | L2-Norm(final)=3.232 | 4172.4 samples/s | 65.2 steps/s
[Step=31050 Epoch=294.2] | Loss=0.00002 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.735 | L2-Norm(final)=3.232 | 2158.0 samples/s | 33.7 steps/s
[Step=31100 Epoch=294.7] | Loss=0.00002 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.730 | L2-Norm(final)=3.232 | 4244.5 samples/s | 66.3 steps/s
[Step=31150 Epoch=295.2] | Loss=0.00002 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.726 | L2-Norm(final)=3.232 | 2197.6 samples/s | 34.3 steps/s
[Step=31200 Epoch=295.6] | Loss=0.00002 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.721 | L2-Norm(final)=3.232 | 4125.6 samples/s | 64.5 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step31200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35358 | acc=0.8779 | tpr=0.8466 | fpr=0.0543 | 3952.4 samples/s | 15.4 steps/s
Avg test loss: 0.37539, Avg test acc: 0.87607, Avg tpr: 0.84438, Avg fpr: 0.05422, total FA: 423

Testing server on iccad2012
[Step=  50] | Loss=0.42989 | acc=0.8914 | tpr=0.8982 | fpr=0.1087 | 3996.7 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.44109 | acc=0.8895 | tpr=0.9062 | fpr=0.1109 | 7410.2 samples/s | 28.9 steps/s
[Step= 150] | Loss=0.44680 | acc=0.8899 | tpr=0.9063 | fpr=0.1104 | 7108.5 samples/s | 27.8 steps/s
[Step= 200] | Loss=0.45108 | acc=0.8892 | tpr=0.9115 | fpr=0.1112 | 7429.8 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.44765 | acc=0.8896 | tpr=0.9092 | fpr=0.1108 | 7506.0 samples/s | 29.3 steps/s
[Step= 300] | Loss=0.44929 | acc=0.8889 | tpr=0.9062 | fpr=0.1114 | 7255.5 samples/s | 28.3 steps/s
[Step= 350] | Loss=0.45068 | acc=0.8894 | tpr=0.9061 | fpr=0.1109 | 7114.4 samples/s | 27.8 steps/s
[Step= 400] | Loss=0.45330 | acc=0.8887 | tpr=0.9081 | fpr=0.1117 | 7203.4 samples/s | 28.1 steps/s
[Step= 450] | Loss=0.45730 | acc=0.8887 | tpr=0.9090 | fpr=0.1117 | 7120.5 samples/s | 27.8 steps/s
[Step= 500] | Loss=0.45469 | acc=0.8889 | tpr=0.9119 | fpr=0.1115 | 7228.9 samples/s | 28.2 steps/s
[Step= 550] | Loss=0.45258 | acc=0.8891 | tpr=0.9105 | fpr=0.1113 | 13482.4 samples/s | 52.7 steps/s
Avg test loss: 0.45163, Avg test acc: 0.88915, Avg tpr: 0.91086, Avg fpr: 0.11124, total FA: 15446

server round 39/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=152.1] | Loss=0.10390 | Reg=0.00161 | acc=0.9062 | L2-Norm=12.698 | L2-Norm(final)=3.230 | 4720.0 samples/s | 73.8 steps/s
[Step=31250 Epoch=152.4] | Loss=0.00476 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.718 | L2-Norm(final)=3.226 | 4296.8 samples/s | 67.1 steps/s
[Step=31300 Epoch=152.6] | Loss=0.00391 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.722 | L2-Norm(final)=3.225 | 4435.2 samples/s | 69.3 steps/s
[Step=31350 Epoch=152.9] | Loss=0.00395 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.723 | L2-Norm(final)=3.225 | 4365.1 samples/s | 68.2 steps/s
[Step=31400 Epoch=153.1] | Loss=0.00340 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.724 | L2-Norm(final)=3.224 | 5957.0 samples/s | 93.1 steps/s
[Step=31450 Epoch=153.4] | Loss=0.00300 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.724 | L2-Norm(final)=3.224 | 2020.3 samples/s | 31.6 steps/s
[Step=31500 Epoch=153.6] | Loss=0.00271 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.724 | L2-Norm(final)=3.224 | 4364.1 samples/s | 68.2 steps/s
[Step=31550 Epoch=153.8] | Loss=0.00252 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.725 | L2-Norm(final)=3.225 | 4208.7 samples/s | 65.8 steps/s
[Step=31600 Epoch=154.1] | Loss=0.00233 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.725 | L2-Norm(final)=3.225 | 5405.1 samples/s | 84.5 steps/s
[Step=31650 Epoch=154.3] | Loss=0.00217 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.725 | L2-Norm(final)=3.226 | 2057.2 samples/s | 32.1 steps/s
[Step=31700 Epoch=154.6] | Loss=0.00207 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.725 | L2-Norm(final)=3.227 | 4349.1 samples/s | 68.0 steps/s
[Step=31750 Epoch=154.8] | Loss=0.00200 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.725 | L2-Norm(final)=3.228 | 4341.8 samples/s | 67.8 steps/s
[Step=31800 Epoch=155.1] | Loss=0.00195 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.725 | L2-Norm(final)=3.229 | 5057.9 samples/s | 79.0 steps/s
[Step=31850 Epoch=155.3] | Loss=0.00186 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.724 | L2-Norm(final)=3.229 | 2059.6 samples/s | 32.2 steps/s
[Step=31900 Epoch=155.6] | Loss=0.00187 | Reg=0.00162 | acc=0.9844 | L2-Norm=12.724 | L2-Norm(final)=3.230 | 4197.4 samples/s | 65.6 steps/s
[Step=31950 Epoch=155.8] | Loss=0.00185 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.724 | L2-Norm(final)=3.231 | 4266.2 samples/s | 66.7 steps/s
[Step=32000 Epoch=156.0] | Loss=0.00182 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.724 | L2-Norm(final)=3.232 | 4694.9 samples/s | 73.4 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step32000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00013, len=1
[Step=31201 Epoch=295.7] | Loss=0.03204 | Reg=0.00161 | acc=0.9531 | L2-Norm=12.698 | L2-Norm(final)=3.231 | 4615.9 samples/s | 72.1 steps/s
[Step=31250 Epoch=296.1] | Loss=0.00077 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.715 | L2-Norm(final)=3.237 | 3838.7 samples/s | 60.0 steps/s
[Step=31300 Epoch=296.6] | Loss=0.00039 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.716 | L2-Norm(final)=3.238 | 5781.1 samples/s | 90.3 steps/s
[Step=31350 Epoch=297.1] | Loss=0.00026 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.713 | L2-Norm(final)=3.238 | 1908.3 samples/s | 29.8 steps/s
[Step=31400 Epoch=297.5] | Loss=0.00019 | Reg=0.00162 | acc=1.0000 | L2-Norm=12.710 | L2-Norm(final)=3.238 | 5367.4 samples/s | 83.9 steps/s
[Step=31450 Epoch=298.0] | Loss=0.00016 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.706 | L2-Norm(final)=3.239 | 1975.9 samples/s | 30.9 steps/s
[Step=31500 Epoch=298.5] | Loss=0.00013 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.702 | L2-Norm(final)=3.239 | 4820.2 samples/s | 75.3 steps/s
[Step=31550 Epoch=299.0] | Loss=0.00011 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.698 | L2-Norm(final)=3.239 | 2036.7 samples/s | 31.8 steps/s
[Step=31600 Epoch=299.4] | Loss=0.00010 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.695 | L2-Norm(final)=3.239 | 4333.9 samples/s | 67.7 steps/s
[Step=31650 Epoch=299.9] | Loss=0.00009 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.691 | L2-Norm(final)=3.239 | 2106.3 samples/s | 32.9 steps/s
[Step=31700 Epoch=300.4] | Loss=0.00008 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.687 | L2-Norm(final)=3.239 | 4127.7 samples/s | 64.5 steps/s
[Step=31750 Epoch=300.9] | Loss=0.00007 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.682 | L2-Norm(final)=3.239 | 2141.3 samples/s | 33.5 steps/s
[Step=31800 Epoch=301.3] | Loss=0.00007 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.678 | L2-Norm(final)=3.239 | 4211.3 samples/s | 65.8 steps/s
[Step=31850 Epoch=301.8] | Loss=0.00006 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.674 | L2-Norm(final)=3.239 | 2186.3 samples/s | 34.2 steps/s
[Step=31900 Epoch=302.3] | Loss=0.00006 | Reg=0.00161 | acc=1.0000 | L2-Norm=12.670 | L2-Norm(final)=3.239 | 4086.1 samples/s | 63.8 steps/s
[Step=31950 Epoch=302.8] | Loss=0.00005 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.666 | L2-Norm(final)=3.239 | 2196.3 samples/s | 34.3 steps/s
[Step=32000 Epoch=303.2] | Loss=0.00005 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.661 | L2-Norm(final)=3.240 | 4062.3 samples/s | 63.5 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step32000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.39935 | acc=0.8628 | tpr=0.8214 | fpr=0.0473 | 4072.5 samples/s | 15.9 steps/s
Avg test loss: 0.42242, Avg test acc: 0.85824, Avg tpr: 0.81564, Avg fpr: 0.04807, total FA: 375

Testing server on iccad2012
[Step=  50] | Loss=0.35878 | acc=0.9095 | tpr=0.8805 | fpr=0.0900 | 4012.1 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.36929 | acc=0.9077 | tpr=0.8934 | fpr=0.0920 | 7154.7 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.37550 | acc=0.9082 | tpr=0.8934 | fpr=0.0916 | 7233.9 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.38043 | acc=0.9077 | tpr=0.9005 | fpr=0.0921 | 7238.1 samples/s | 28.3 steps/s
[Step= 250] | Loss=0.37684 | acc=0.9081 | tpr=0.8996 | fpr=0.0918 | 7337.6 samples/s | 28.7 steps/s
[Step= 300] | Loss=0.37860 | acc=0.9079 | tpr=0.8982 | fpr=0.0919 | 7059.1 samples/s | 27.6 steps/s
[Step= 350] | Loss=0.37987 | acc=0.9081 | tpr=0.8979 | fpr=0.0917 | 7149.8 samples/s | 27.9 steps/s
[Step= 400] | Loss=0.38213 | acc=0.9075 | tpr=0.9010 | fpr=0.0923 | 7229.4 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.38621 | acc=0.9076 | tpr=0.9012 | fpr=0.0923 | 7064.7 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.38389 | acc=0.9077 | tpr=0.9053 | fpr=0.0923 | 7506.5 samples/s | 29.3 steps/s
[Step= 550] | Loss=0.38192 | acc=0.9079 | tpr=0.9033 | fpr=0.0920 | 12057.6 samples/s | 47.1 steps/s
Avg test loss: 0.38100, Avg test acc: 0.90797, Avg tpr: 0.90372, Avg fpr: 0.09196, total FA: 12768

server round 40/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=156.0] | Loss=0.02340 | Reg=0.00160 | acc=0.9688 | L2-Norm=12.641 | L2-Norm(final)=3.242 | 4603.4 samples/s | 71.9 steps/s
[Step=32050 Epoch=156.3] | Loss=0.00508 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.653 | L2-Norm(final)=3.238 | 4236.0 samples/s | 66.2 steps/s
[Step=32100 Epoch=156.5] | Loss=0.00324 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.656 | L2-Norm(final)=3.238 | 4412.5 samples/s | 68.9 steps/s
[Step=32150 Epoch=156.8] | Loss=0.00250 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.657 | L2-Norm(final)=3.239 | 4288.1 samples/s | 67.0 steps/s
[Step=32200 Epoch=157.0] | Loss=0.00219 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.658 | L2-Norm(final)=3.239 | 5948.2 samples/s | 92.9 steps/s
[Step=32250 Epoch=157.3] | Loss=0.00204 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.658 | L2-Norm(final)=3.239 | 1990.4 samples/s | 31.1 steps/s
[Step=32300 Epoch=157.5] | Loss=0.00181 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.658 | L2-Norm(final)=3.240 | 4427.6 samples/s | 69.2 steps/s
[Step=32350 Epoch=157.7] | Loss=0.00174 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.658 | L2-Norm(final)=3.240 | 4370.8 samples/s | 68.3 steps/s
[Step=32400 Epoch=158.0] | Loss=0.00168 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.658 | L2-Norm(final)=3.240 | 5421.1 samples/s | 84.7 steps/s
[Step=32450 Epoch=158.2] | Loss=0.00163 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.658 | L2-Norm(final)=3.241 | 2025.2 samples/s | 31.6 steps/s
[Step=32500 Epoch=158.5] | Loss=0.00155 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.658 | L2-Norm(final)=3.241 | 4296.9 samples/s | 67.1 steps/s
[Step=32550 Epoch=158.7] | Loss=0.00151 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.658 | L2-Norm(final)=3.242 | 4423.9 samples/s | 69.1 steps/s
[Step=32600 Epoch=159.0] | Loss=0.00145 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.658 | L2-Norm(final)=3.242 | 4975.1 samples/s | 77.7 steps/s
[Step=32650 Epoch=159.2] | Loss=0.00141 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.658 | L2-Norm(final)=3.243 | 2095.6 samples/s | 32.7 steps/s
[Step=32700 Epoch=159.5] | Loss=0.00136 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.658 | L2-Norm(final)=3.243 | 4314.7 samples/s | 67.4 steps/s
[Step=32750 Epoch=159.7] | Loss=0.00139 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.658 | L2-Norm(final)=3.243 | 4355.3 samples/s | 68.1 steps/s
[Step=32800 Epoch=159.9] | Loss=0.00135 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.658 | L2-Norm(final)=3.244 | 4778.4 samples/s | 74.7 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step32800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32001 Epoch=303.2] | Loss=0.00201 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.641 | L2-Norm(final)=3.242 | 4599.2 samples/s | 71.9 steps/s
[Step=32050 Epoch=303.7] | Loss=0.00083 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.652 | L2-Norm(final)=3.250 | 3889.1 samples/s | 60.8 steps/s
[Step=32100 Epoch=304.2] | Loss=0.00042 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.654 | L2-Norm(final)=3.251 | 5632.4 samples/s | 88.0 steps/s
[Step=32150 Epoch=304.6] | Loss=0.00028 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.653 | L2-Norm(final)=3.252 | 1893.4 samples/s | 29.6 steps/s
[Step=32200 Epoch=305.1] | Loss=0.00021 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.652 | L2-Norm(final)=3.252 | 5115.0 samples/s | 79.9 steps/s
[Step=32250 Epoch=305.6] | Loss=0.00017 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.651 | L2-Norm(final)=3.252 | 1945.5 samples/s | 30.4 steps/s
[Step=32300 Epoch=306.1] | Loss=0.00014 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.649 | L2-Norm(final)=3.252 | 4985.1 samples/s | 77.9 steps/s
[Step=32350 Epoch=306.5] | Loss=0.00012 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.647 | L2-Norm(final)=3.252 | 2001.5 samples/s | 31.3 steps/s
[Step=32400 Epoch=307.0] | Loss=0.00011 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.646 | L2-Norm(final)=3.253 | 4490.7 samples/s | 70.2 steps/s
[Step=32450 Epoch=307.5] | Loss=0.00010 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.644 | L2-Norm(final)=3.253 | 2075.9 samples/s | 32.4 steps/s
[Step=32500 Epoch=308.0] | Loss=0.00009 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.642 | L2-Norm(final)=3.253 | 4189.6 samples/s | 65.5 steps/s
[Step=32550 Epoch=308.4] | Loss=0.00008 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.640 | L2-Norm(final)=3.253 | 2134.1 samples/s | 33.3 steps/s
[Step=32600 Epoch=308.9] | Loss=0.00007 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.638 | L2-Norm(final)=3.253 | 4093.9 samples/s | 64.0 steps/s
[Step=32650 Epoch=309.4] | Loss=0.00007 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.636 | L2-Norm(final)=3.253 | 2153.6 samples/s | 33.6 steps/s
[Step=32700 Epoch=309.9] | Loss=0.00006 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.634 | L2-Norm(final)=3.253 | 4194.4 samples/s | 65.5 steps/s
[Step=32750 Epoch=310.3] | Loss=0.00006 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.632 | L2-Norm(final)=3.253 | 2172.7 samples/s | 33.9 steps/s
[Step=32800 Epoch=310.8] | Loss=0.00006 | Reg=0.00160 | acc=1.0000 | L2-Norm=12.630 | L2-Norm(final)=3.253 | 4172.0 samples/s | 65.2 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step32800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37512 | acc=0.8702 | tpr=0.8348 | fpr=0.0528 | 3987.4 samples/s | 15.6 steps/s
Avg test loss: 0.39872, Avg test acc: 0.86766, Avg tpr: 0.83144, Avg fpr: 0.05269, total FA: 411

Testing server on iccad2012
[Step=  50] | Loss=0.38872 | acc=0.9023 | tpr=0.8805 | fpr=0.0973 | 3998.2 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.39978 | acc=0.9000 | tpr=0.8934 | fpr=0.0999 | 7145.3 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.40615 | acc=0.9005 | tpr=0.8963 | fpr=0.0994 | 7248.0 samples/s | 28.3 steps/s
[Step= 200] | Loss=0.41117 | acc=0.9002 | tpr=0.9027 | fpr=0.0999 | 7305.8 samples/s | 28.5 steps/s
[Step= 250] | Loss=0.40754 | acc=0.9003 | tpr=0.9004 | fpr=0.0997 | 7255.9 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.40919 | acc=0.9004 | tpr=0.8996 | fpr=0.0996 | 7097.7 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.41057 | acc=0.9007 | tpr=0.9004 | fpr=0.0993 | 7292.3 samples/s | 28.5 steps/s
[Step= 400] | Loss=0.41280 | acc=0.9000 | tpr=0.9037 | fpr=0.1001 | 4642.4 samples/s | 18.1 steps/s
[Step= 450] | Loss=0.41689 | acc=0.9000 | tpr=0.9036 | fpr=0.1001 | 6977.6 samples/s | 27.3 steps/s
[Step= 500] | Loss=0.41447 | acc=0.9001 | tpr=0.9057 | fpr=0.1000 | 7176.8 samples/s | 28.0 steps/s
[Step= 550] | Loss=0.41227 | acc=0.9003 | tpr=0.9037 | fpr=0.0997 | 13483.6 samples/s | 52.7 steps/s
Avg test loss: 0.41133, Avg test acc: 0.90040, Avg tpr: 0.90412, Avg fpr: 0.09967, total FA: 13839

server round 41/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=159.9] | Loss=0.02438 | Reg=0.00159 | acc=0.9688 | L2-Norm=12.615 | L2-Norm(final)=3.251 | 4493.0 samples/s | 70.2 steps/s
[Step=32850 Epoch=160.2] | Loss=0.00344 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.624 | L2-Norm(final)=3.251 | 4329.3 samples/s | 67.6 steps/s
[Step=32900 Epoch=160.4] | Loss=0.00242 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.626 | L2-Norm(final)=3.251 | 4435.9 samples/s | 69.3 steps/s
[Step=32950 Epoch=160.7] | Loss=0.00233 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.627 | L2-Norm(final)=3.252 | 4429.2 samples/s | 69.2 steps/s
[Step=33000 Epoch=160.9] | Loss=0.00195 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.627 | L2-Norm(final)=3.252 | 5972.0 samples/s | 93.3 steps/s
[Step=33050 Epoch=161.2] | Loss=0.00177 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=3.252 | 2000.6 samples/s | 31.3 steps/s
[Step=33100 Epoch=161.4] | Loss=0.00164 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=3.253 | 4386.8 samples/s | 68.5 steps/s
[Step=33150 Epoch=161.6] | Loss=0.00154 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=3.253 | 4378.5 samples/s | 68.4 steps/s
[Step=33200 Epoch=161.9] | Loss=0.00146 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=3.254 | 5571.5 samples/s | 87.1 steps/s
[Step=33250 Epoch=162.1] | Loss=0.00141 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=3.254 | 2105.2 samples/s | 32.9 steps/s
[Step=33300 Epoch=162.4] | Loss=0.00145 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.628 | L2-Norm(final)=3.255 | 4392.4 samples/s | 68.6 steps/s
[Step=33350 Epoch=162.6] | Loss=0.00139 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=3.255 | 4404.5 samples/s | 68.8 steps/s
[Step=33400 Epoch=162.9] | Loss=0.00135 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=3.255 | 5157.8 samples/s | 80.6 steps/s
[Step=33450 Epoch=163.1] | Loss=0.00133 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=3.256 | 2116.1 samples/s | 33.1 steps/s
[Step=33500 Epoch=163.4] | Loss=0.00128 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.627 | L2-Norm(final)=3.256 | 4418.3 samples/s | 69.0 steps/s
[Step=33550 Epoch=163.6] | Loss=0.00126 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.627 | L2-Norm(final)=3.257 | 4400.4 samples/s | 68.8 steps/s
[Step=33600 Epoch=163.8] | Loss=0.00129 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.627 | L2-Norm(final)=3.257 | 4641.1 samples/s | 72.5 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step33600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=32801 Epoch=310.8] | Loss=0.00147 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.615 | L2-Norm(final)=3.252 | 4512.8 samples/s | 70.5 steps/s
[Step=32850 Epoch=311.3] | Loss=0.00084 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.625 | L2-Norm(final)=3.257 | 3997.2 samples/s | 62.5 steps/s
[Step=32900 Epoch=311.8] | Loss=0.00042 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.628 | L2-Norm(final)=3.259 | 5584.6 samples/s | 87.3 steps/s
[Step=32950 Epoch=312.2] | Loss=0.00028 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.627 | L2-Norm(final)=3.260 | 1892.0 samples/s | 29.6 steps/s
[Step=33000 Epoch=312.7] | Loss=0.00021 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.626 | L2-Norm(final)=3.260 | 5276.1 samples/s | 82.4 steps/s
[Step=33050 Epoch=313.2] | Loss=0.00017 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.625 | L2-Norm(final)=3.260 | 1933.6 samples/s | 30.2 steps/s
[Step=33100 Epoch=313.7] | Loss=0.00014 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.623 | L2-Norm(final)=3.261 | 4674.0 samples/s | 73.0 steps/s
[Step=33150 Epoch=314.1] | Loss=0.00012 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.622 | L2-Norm(final)=3.261 | 2050.6 samples/s | 32.0 steps/s
[Step=33200 Epoch=314.6] | Loss=0.00011 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.620 | L2-Norm(final)=3.261 | 4668.3 samples/s | 72.9 steps/s
[Step=33250 Epoch=315.1] | Loss=0.00010 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.618 | L2-Norm(final)=3.261 | 2052.7 samples/s | 32.1 steps/s
[Step=33300 Epoch=315.5] | Loss=0.00009 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.617 | L2-Norm(final)=3.261 | 4149.5 samples/s | 64.8 steps/s
[Step=33350 Epoch=316.0] | Loss=0.00008 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.615 | L2-Norm(final)=3.261 | 2142.0 samples/s | 33.5 steps/s
[Step=33400 Epoch=316.5] | Loss=0.00007 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.613 | L2-Norm(final)=3.261 | 4306.3 samples/s | 67.3 steps/s
[Step=33450 Epoch=317.0] | Loss=0.00007 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.611 | L2-Norm(final)=3.261 | 2180.9 samples/s | 34.1 steps/s
[Step=33500 Epoch=317.4] | Loss=0.00006 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.609 | L2-Norm(final)=3.262 | 4153.2 samples/s | 64.9 steps/s
[Step=33550 Epoch=317.9] | Loss=0.00006 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.607 | L2-Norm(final)=3.262 | 2186.6 samples/s | 34.2 steps/s
[Step=33600 Epoch=318.4] | Loss=0.00006 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.605 | L2-Norm(final)=3.262 | 4180.7 samples/s | 65.3 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step33600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.36302 | acc=0.8745 | tpr=0.8415 | fpr=0.0538 | 3981.7 samples/s | 15.6 steps/s
Avg test loss: 0.38497, Avg test acc: 0.87219, Avg tpr: 0.83867, Avg fpr: 0.05410, total FA: 422

Testing server on iccad2012
[Step=  50] | Loss=0.39324 | acc=0.9007 | tpr=0.8805 | fpr=0.0989 | 4036.3 samples/s | 15.8 steps/s
[Step= 100] | Loss=0.40436 | acc=0.8991 | tpr=0.8977 | fpr=0.1008 | 7234.6 samples/s | 28.3 steps/s
[Step= 150] | Loss=0.41097 | acc=0.8998 | tpr=0.8977 | fpr=0.1001 | 4760.6 samples/s | 18.6 steps/s
[Step= 200] | Loss=0.41569 | acc=0.8992 | tpr=0.9005 | fpr=0.1008 | 6353.9 samples/s | 24.8 steps/s
[Step= 250] | Loss=0.41210 | acc=0.8992 | tpr=0.8987 | fpr=0.1008 | 7302.8 samples/s | 28.5 steps/s
[Step= 300] | Loss=0.41387 | acc=0.8992 | tpr=0.8975 | fpr=0.1007 | 7125.1 samples/s | 27.8 steps/s
[Step= 350] | Loss=0.41513 | acc=0.8997 | tpr=0.8986 | fpr=0.1003 | 7331.5 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.41728 | acc=0.8990 | tpr=0.9010 | fpr=0.1011 | 7139.5 samples/s | 27.9 steps/s
[Step= 450] | Loss=0.42121 | acc=0.8989 | tpr=0.9012 | fpr=0.1011 | 7065.2 samples/s | 27.6 steps/s
[Step= 500] | Loss=0.41868 | acc=0.8990 | tpr=0.9035 | fpr=0.1011 | 7028.9 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.41646 | acc=0.8992 | tpr=0.9017 | fpr=0.1008 | 13520.9 samples/s | 52.8 steps/s
Avg test loss: 0.41552, Avg test acc: 0.89932, Avg tpr: 0.90214, Avg fpr: 0.10073, total FA: 13986

server round 42/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=163.8] | Loss=0.00787 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.589 | L2-Norm(final)=3.262 | 4717.1 samples/s | 73.7 steps/s
[Step=33650 Epoch=164.1] | Loss=0.00293 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.599 | L2-Norm(final)=3.261 | 4173.2 samples/s | 65.2 steps/s
[Step=33700 Epoch=164.3] | Loss=0.00205 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.601 | L2-Norm(final)=3.261 | 4356.2 samples/s | 68.1 steps/s
[Step=33750 Epoch=164.6] | Loss=0.00197 | Reg=0.00159 | acc=0.9844 | L2-Norm=12.602 | L2-Norm(final)=3.262 | 4414.0 samples/s | 69.0 steps/s
[Step=33800 Epoch=164.8] | Loss=0.00171 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.602 | L2-Norm(final)=3.262 | 5799.9 samples/s | 90.6 steps/s
[Step=33850 Epoch=165.1] | Loss=0.00162 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.602 | L2-Norm(final)=3.263 | 2003.3 samples/s | 31.3 steps/s
[Step=33900 Epoch=165.3] | Loss=0.00152 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.603 | L2-Norm(final)=3.263 | 4442.9 samples/s | 69.4 steps/s
[Step=33950 Epoch=165.5] | Loss=0.00143 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.603 | L2-Norm(final)=3.264 | 4445.3 samples/s | 69.5 steps/s
[Step=34000 Epoch=165.8] | Loss=0.00139 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.603 | L2-Norm(final)=3.264 | 5453.5 samples/s | 85.2 steps/s
[Step=34050 Epoch=166.0] | Loss=0.00137 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.603 | L2-Norm(final)=3.264 | 2015.8 samples/s | 31.5 steps/s
[Step=34100 Epoch=166.3] | Loss=0.00135 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.602 | L2-Norm(final)=3.265 | 4324.6 samples/s | 67.6 steps/s
[Step=34150 Epoch=166.5] | Loss=0.00130 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.602 | L2-Norm(final)=3.265 | 4305.5 samples/s | 67.3 steps/s
[Step=34200 Epoch=166.8] | Loss=0.00127 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.602 | L2-Norm(final)=3.266 | 5010.3 samples/s | 78.3 steps/s
[Step=34250 Epoch=167.0] | Loss=0.00126 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.602 | L2-Norm(final)=3.266 | 2102.7 samples/s | 32.9 steps/s
[Step=34300 Epoch=167.3] | Loss=0.00124 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.602 | L2-Norm(final)=3.267 | 4381.1 samples/s | 68.5 steps/s
[Step=34350 Epoch=167.5] | Loss=0.00121 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.602 | L2-Norm(final)=3.267 | 4324.7 samples/s | 67.6 steps/s
[Step=34400 Epoch=167.7] | Loss=0.00122 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.602 | L2-Norm(final)=3.268 | 4841.0 samples/s | 75.6 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step34400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=33601 Epoch=318.4] | Loss=0.03565 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.589 | L2-Norm(final)=3.263 | 4572.5 samples/s | 71.4 steps/s
[Step=33650 Epoch=318.9] | Loss=0.00107 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.600 | L2-Norm(final)=3.268 | 3937.4 samples/s | 61.5 steps/s
[Step=33700 Epoch=319.3] | Loss=0.00053 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.601 | L2-Norm(final)=3.269 | 5567.2 samples/s | 87.0 steps/s
[Step=33750 Epoch=319.8] | Loss=0.00036 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.600 | L2-Norm(final)=3.269 | 1943.2 samples/s | 30.4 steps/s
[Step=33800 Epoch=320.3] | Loss=0.00027 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.599 | L2-Norm(final)=3.269 | 5242.4 samples/s | 81.9 steps/s
[Step=33850 Epoch=320.8] | Loss=0.00022 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.597 | L2-Norm(final)=3.270 | 1946.6 samples/s | 30.4 steps/s
[Step=33900 Epoch=321.2] | Loss=0.00018 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.596 | L2-Norm(final)=3.270 | 4746.4 samples/s | 74.2 steps/s
[Step=33950 Epoch=321.7] | Loss=0.00016 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.594 | L2-Norm(final)=3.270 | 2033.0 samples/s | 31.8 steps/s
[Step=34000 Epoch=322.2] | Loss=0.00014 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.593 | L2-Norm(final)=3.270 | 4488.0 samples/s | 70.1 steps/s
[Step=34050 Epoch=322.7] | Loss=0.00012 | Reg=0.00159 | acc=1.0000 | L2-Norm=12.591 | L2-Norm(final)=3.270 | 2084.1 samples/s | 32.6 steps/s
[Step=34100 Epoch=323.1] | Loss=0.00011 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.589 | L2-Norm(final)=3.270 | 4134.6 samples/s | 64.6 steps/s
[Step=34150 Epoch=323.6] | Loss=0.00010 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.587 | L2-Norm(final)=3.270 | 2110.7 samples/s | 33.0 steps/s
[Step=34200 Epoch=324.1] | Loss=0.00009 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.586 | L2-Norm(final)=3.271 | 4102.2 samples/s | 64.1 steps/s
[Step=34250 Epoch=324.5] | Loss=0.00008 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.584 | L2-Norm(final)=3.271 | 2133.4 samples/s | 33.3 steps/s
[Step=34300 Epoch=325.0] | Loss=0.00008 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.582 | L2-Norm(final)=3.271 | 4203.2 samples/s | 65.7 steps/s
[Step=34350 Epoch=325.5] | Loss=0.00007 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.580 | L2-Norm(final)=3.271 | 2147.1 samples/s | 33.5 steps/s
[Step=34400 Epoch=326.0] | Loss=0.00007 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.578 | L2-Norm(final)=3.271 | 4123.9 samples/s | 64.4 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step34400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34273 | acc=0.8841 | tpr=0.8575 | fpr=0.0580 | 3975.6 samples/s | 15.5 steps/s
Avg test loss: 0.36395, Avg test acc: 0.88252, Avg tpr: 0.85551, Avg fpr: 0.05807, total FA: 453

Testing server on iccad2012
[Step=  50] | Loss=0.42983 | acc=0.8929 | tpr=0.8850 | fpr=0.1070 | 3965.1 samples/s | 15.5 steps/s
[Step= 100] | Loss=0.44282 | acc=0.8906 | tpr=0.8977 | fpr=0.1095 | 7154.4 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.44935 | acc=0.8911 | tpr=0.8991 | fpr=0.1091 | 4633.5 samples/s | 18.1 steps/s
[Step= 200] | Loss=0.45430 | acc=0.8909 | tpr=0.9038 | fpr=0.1093 | 7050.6 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.45077 | acc=0.8909 | tpr=0.9022 | fpr=0.1093 | 7514.4 samples/s | 29.4 steps/s
[Step= 300] | Loss=0.45260 | acc=0.8908 | tpr=0.9018 | fpr=0.1094 | 7577.7 samples/s | 29.6 steps/s
[Step= 350] | Loss=0.45356 | acc=0.8912 | tpr=0.9017 | fpr=0.1089 | 6632.2 samples/s | 25.9 steps/s
[Step= 400] | Loss=0.45597 | acc=0.8905 | tpr=0.9043 | fpr=0.1098 | 7226.9 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.45994 | acc=0.8904 | tpr=0.9051 | fpr=0.1099 | 7283.6 samples/s | 28.5 steps/s
[Step= 500] | Loss=0.45729 | acc=0.8904 | tpr=0.9070 | fpr=0.1099 | 7190.0 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.45509 | acc=0.8905 | tpr=0.9053 | fpr=0.1097 | 13146.5 samples/s | 51.4 steps/s
Avg test loss: 0.45414, Avg test acc: 0.89061, Avg tpr: 0.90571, Avg fpr: 0.10967, total FA: 15227

server round 43/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=167.7] | Loss=0.01674 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.563 | L2-Norm(final)=3.273 | 4495.6 samples/s | 70.2 steps/s
[Step=34450 Epoch=168.0] | Loss=0.00317 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.573 | L2-Norm(final)=3.270 | 4331.8 samples/s | 67.7 steps/s
[Step=34500 Epoch=168.2] | Loss=0.00216 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.575 | L2-Norm(final)=3.271 | 4393.2 samples/s | 68.6 steps/s
[Step=34550 Epoch=168.5] | Loss=0.00179 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.576 | L2-Norm(final)=3.271 | 4379.0 samples/s | 68.4 steps/s
[Step=34600 Epoch=168.7] | Loss=0.00170 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.576 | L2-Norm(final)=3.271 | 5932.6 samples/s | 92.7 steps/s
[Step=34650 Epoch=169.0] | Loss=0.00158 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.577 | L2-Norm(final)=3.272 | 1985.1 samples/s | 31.0 steps/s
[Step=34700 Epoch=169.2] | Loss=0.00147 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.577 | L2-Norm(final)=3.272 | 4370.3 samples/s | 68.3 steps/s
[Step=34750 Epoch=169.4] | Loss=0.00147 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.577 | L2-Norm(final)=3.273 | 4406.1 samples/s | 68.8 steps/s
[Step=34800 Epoch=169.7] | Loss=0.00136 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.577 | L2-Norm(final)=3.273 | 5451.7 samples/s | 85.2 steps/s
[Step=34850 Epoch=169.9] | Loss=0.00138 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.577 | L2-Norm(final)=3.274 | 2027.7 samples/s | 31.7 steps/s
[Step=34900 Epoch=170.2] | Loss=0.00134 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.577 | L2-Norm(final)=3.274 | 4391.9 samples/s | 68.6 steps/s
[Step=34950 Epoch=170.4] | Loss=0.00134 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.577 | L2-Norm(final)=3.275 | 4393.3 samples/s | 68.6 steps/s
[Step=35000 Epoch=170.7] | Loss=0.00130 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.577 | L2-Norm(final)=3.275 | 5066.4 samples/s | 79.2 steps/s
[Step=35050 Epoch=170.9] | Loss=0.00127 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.576 | L2-Norm(final)=3.275 | 2080.5 samples/s | 32.5 steps/s
[Step=35100 Epoch=171.2] | Loss=0.00123 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.576 | L2-Norm(final)=3.276 | 4406.1 samples/s | 68.8 steps/s
[Step=35150 Epoch=171.4] | Loss=0.00121 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.576 | L2-Norm(final)=3.276 | 4488.4 samples/s | 70.1 steps/s
[Step=35200 Epoch=171.6] | Loss=0.00121 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.576 | L2-Norm(final)=3.277 | 4767.9 samples/s | 74.5 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step35200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=34401 Epoch=326.0] | Loss=0.05021 | Reg=0.00158 | acc=0.9844 | L2-Norm=12.563 | L2-Norm(final)=3.273 | 4228.9 samples/s | 66.1 steps/s
[Step=34450 Epoch=326.4] | Loss=0.00158 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.573 | L2-Norm(final)=3.280 | 4085.1 samples/s | 63.8 steps/s
[Step=34500 Epoch=326.9] | Loss=0.00079 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.575 | L2-Norm(final)=3.281 | 5683.0 samples/s | 88.8 steps/s
[Step=34550 Epoch=327.4] | Loss=0.00053 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.575 | L2-Norm(final)=3.282 | 1879.3 samples/s | 29.4 steps/s
[Step=34600 Epoch=327.9] | Loss=0.00040 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.574 | L2-Norm(final)=3.282 | 5182.0 samples/s | 81.0 steps/s
[Step=34650 Epoch=328.3] | Loss=0.00032 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.573 | L2-Norm(final)=3.282 | 1965.7 samples/s | 30.7 steps/s
[Step=34700 Epoch=328.8] | Loss=0.00027 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.571 | L2-Norm(final)=3.282 | 4795.9 samples/s | 74.9 steps/s
[Step=34750 Epoch=329.3] | Loss=0.00023 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.570 | L2-Norm(final)=3.283 | 1309.3 samples/s | 20.5 steps/s
[Step=34800 Epoch=329.8] | Loss=0.00020 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.569 | L2-Norm(final)=3.283 | 4445.9 samples/s | 69.5 steps/s
[Step=34850 Epoch=330.2] | Loss=0.00018 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.567 | L2-Norm(final)=3.283 | 2053.3 samples/s | 32.1 steps/s
[Step=34900 Epoch=330.7] | Loss=0.00016 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.566 | L2-Norm(final)=3.283 | 4234.2 samples/s | 66.2 steps/s
[Step=34950 Epoch=331.2] | Loss=0.00015 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.564 | L2-Norm(final)=3.283 | 2161.3 samples/s | 33.8 steps/s
[Step=35000 Epoch=331.7] | Loss=0.00013 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.563 | L2-Norm(final)=3.283 | 4156.8 samples/s | 65.0 steps/s
[Step=35050 Epoch=332.1] | Loss=0.00012 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.561 | L2-Norm(final)=3.283 | 2181.3 samples/s | 34.1 steps/s
[Step=35100 Epoch=332.6] | Loss=0.00012 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.560 | L2-Norm(final)=3.283 | 4292.0 samples/s | 67.1 steps/s
[Step=35150 Epoch=333.1] | Loss=0.00011 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.558 | L2-Norm(final)=3.284 | 2186.1 samples/s | 34.2 steps/s
[Step=35200 Epoch=333.6] | Loss=0.00010 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.557 | L2-Norm(final)=3.284 | 4126.3 samples/s | 64.5 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step35200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.35072 | acc=0.8829 | tpr=0.8559 | fpr=0.0585 | 4005.4 samples/s | 15.6 steps/s
Avg test loss: 0.37138, Avg test acc: 0.88064, Avg tpr: 0.85312, Avg fpr: 0.05884, total FA: 459

Testing server on iccad2012
[Step=  50] | Loss=0.42525 | acc=0.8965 | tpr=0.8850 | fpr=0.1033 | 4066.8 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.43886 | acc=0.8938 | tpr=0.8977 | fpr=0.1063 | 7045.2 samples/s | 27.5 steps/s
[Step= 150] | Loss=0.44606 | acc=0.8949 | tpr=0.8991 | fpr=0.1052 | 7376.6 samples/s | 28.8 steps/s
[Step= 200] | Loss=0.45095 | acc=0.8949 | tpr=0.9016 | fpr=0.1052 | 7048.2 samples/s | 27.5 steps/s
[Step= 250] | Loss=0.44693 | acc=0.8951 | tpr=0.9013 | fpr=0.1050 | 7237.4 samples/s | 28.3 steps/s
[Step= 300] | Loss=0.44880 | acc=0.8950 | tpr=0.9004 | fpr=0.1051 | 7217.6 samples/s | 28.2 steps/s
[Step= 350] | Loss=0.44973 | acc=0.8955 | tpr=0.9011 | fpr=0.1046 | 7011.8 samples/s | 27.4 steps/s
[Step= 400] | Loss=0.45217 | acc=0.8951 | tpr=0.9037 | fpr=0.1051 | 7288.6 samples/s | 28.5 steps/s
[Step= 450] | Loss=0.45638 | acc=0.8951 | tpr=0.9051 | fpr=0.1051 | 6948.5 samples/s | 27.1 steps/s
[Step= 500] | Loss=0.45359 | acc=0.8952 | tpr=0.9075 | fpr=0.1051 | 7045.0 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.45131 | acc=0.8954 | tpr=0.9061 | fpr=0.1048 | 13466.7 samples/s | 52.6 steps/s
Avg test loss: 0.45031, Avg test acc: 0.89545, Avg tpr: 0.90650, Avg fpr: 0.10475, total FA: 14545

server round 44/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=171.6] | Loss=0.01953 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.541 | L2-Norm(final)=3.284 | 4527.2 samples/s | 70.7 steps/s
[Step=35250 Epoch=171.9] | Loss=0.00393 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=3.281 | 4313.1 samples/s | 67.4 steps/s
[Step=35300 Epoch=172.1] | Loss=0.00254 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.553 | L2-Norm(final)=3.280 | 4353.6 samples/s | 68.0 steps/s
[Step=35350 Epoch=172.4] | Loss=0.00205 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.553 | L2-Norm(final)=3.281 | 4382.6 samples/s | 68.5 steps/s
[Step=35400 Epoch=172.6] | Loss=0.00185 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.554 | L2-Norm(final)=3.281 | 5590.2 samples/s | 87.3 steps/s
[Step=35450 Epoch=172.9] | Loss=0.00174 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.554 | L2-Norm(final)=3.281 | 1943.8 samples/s | 30.4 steps/s
[Step=35500 Epoch=173.1] | Loss=0.00156 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.554 | L2-Norm(final)=3.281 | 4321.1 samples/s | 67.5 steps/s
[Step=35550 Epoch=173.3] | Loss=0.00148 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.554 | L2-Norm(final)=3.282 | 4446.0 samples/s | 69.5 steps/s
[Step=35600 Epoch=173.6] | Loss=0.00145 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.554 | L2-Norm(final)=3.282 | 5532.5 samples/s | 86.4 steps/s
[Step=35650 Epoch=173.8] | Loss=0.00136 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.554 | L2-Norm(final)=3.283 | 2007.4 samples/s | 31.4 steps/s
[Step=35700 Epoch=174.1] | Loss=0.00133 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.554 | L2-Norm(final)=3.283 | 4311.8 samples/s | 67.4 steps/s
[Step=35750 Epoch=174.3] | Loss=0.00135 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.553 | L2-Norm(final)=3.284 | 4465.8 samples/s | 69.8 steps/s
[Step=35800 Epoch=174.6] | Loss=0.00131 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.553 | L2-Norm(final)=3.284 | 5183.6 samples/s | 81.0 steps/s
[Step=35850 Epoch=174.8] | Loss=0.00129 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.553 | L2-Norm(final)=3.285 | 2111.9 samples/s | 33.0 steps/s
[Step=35900 Epoch=175.1] | Loss=0.00124 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.553 | L2-Norm(final)=3.285 | 4263.6 samples/s | 66.6 steps/s
[Step=35950 Epoch=175.3] | Loss=0.00123 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.553 | L2-Norm(final)=3.285 | 4358.8 samples/s | 68.1 steps/s
[Step=36000 Epoch=175.5] | Loss=0.00126 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.553 | L2-Norm(final)=3.286 | 4692.9 samples/s | 73.3 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step36000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=35201 Epoch=333.6] | Loss=0.00415 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.541 | L2-Norm(final)=3.285 | 4431.8 samples/s | 69.2 steps/s
[Step=35250 Epoch=334.0] | Loss=0.00051 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=3.292 | 4059.2 samples/s | 63.4 steps/s
[Step=35300 Epoch=334.5] | Loss=0.00026 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.552 | L2-Norm(final)=3.293 | 5659.8 samples/s | 88.4 steps/s
[Step=35350 Epoch=335.0] | Loss=0.00017 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.551 | L2-Norm(final)=3.294 | 1902.3 samples/s | 29.7 steps/s
[Step=35400 Epoch=335.4] | Loss=0.00013 | Reg=0.00158 | acc=1.0000 | L2-Norm=12.550 | L2-Norm(final)=3.294 | 5267.3 samples/s | 82.3 steps/s
[Step=35450 Epoch=335.9] | Loss=0.00011 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.549 | L2-Norm(final)=3.295 | 1978.1 samples/s | 30.9 steps/s
[Step=35500 Epoch=336.4] | Loss=0.00009 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.548 | L2-Norm(final)=3.295 | 4806.1 samples/s | 75.1 steps/s
[Step=35550 Epoch=336.9] | Loss=0.00008 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.546 | L2-Norm(final)=3.295 | 2003.7 samples/s | 31.3 steps/s
[Step=35600 Epoch=337.3] | Loss=0.00007 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.545 | L2-Norm(final)=3.295 | 4505.8 samples/s | 70.4 steps/s
[Step=35650 Epoch=337.8] | Loss=0.00006 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.543 | L2-Norm(final)=3.295 | 2091.3 samples/s | 32.7 steps/s
[Step=35700 Epoch=338.3] | Loss=0.00005 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.541 | L2-Norm(final)=3.295 | 4222.7 samples/s | 66.0 steps/s
[Step=35750 Epoch=338.8] | Loss=0.00005 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.540 | L2-Norm(final)=3.295 | 2166.9 samples/s | 33.9 steps/s
[Step=35800 Epoch=339.2] | Loss=0.00005 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.538 | L2-Norm(final)=3.296 | 4191.1 samples/s | 65.5 steps/s
[Step=35850 Epoch=339.7] | Loss=0.00004 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.536 | L2-Norm(final)=3.296 | 2169.8 samples/s | 33.9 steps/s
[Step=35900 Epoch=340.2] | Loss=0.00004 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.534 | L2-Norm(final)=3.296 | 4201.9 samples/s | 65.7 steps/s
[Step=35950 Epoch=340.7] | Loss=0.00004 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.533 | L2-Norm(final)=3.296 | 2190.6 samples/s | 34.2 steps/s
[Step=36000 Epoch=341.1] | Loss=0.00003 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.531 | L2-Norm(final)=3.296 | 4114.8 samples/s | 64.3 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step36000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33575 | acc=0.8877 | tpr=0.8644 | fpr=0.0617 | 4080.7 samples/s | 15.9 steps/s
Avg test loss: 0.35484, Avg test acc: 0.88569, Avg tpr: 0.86256, Avg fpr: 0.06345, total FA: 495

Testing server on iccad2012
[Step=  50] | Loss=0.43527 | acc=0.8925 | tpr=0.8850 | fpr=0.1074 | 4027.6 samples/s | 15.7 steps/s
[Step= 100] | Loss=0.44821 | acc=0.8896 | tpr=0.8977 | fpr=0.1106 | 7132.8 samples/s | 27.9 steps/s
[Step= 150] | Loss=0.45521 | acc=0.8907 | tpr=0.8991 | fpr=0.1095 | 7270.4 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.45991 | acc=0.8904 | tpr=0.9049 | fpr=0.1099 | 7132.7 samples/s | 27.9 steps/s
[Step= 250] | Loss=0.45633 | acc=0.8904 | tpr=0.9031 | fpr=0.1098 | 7141.6 samples/s | 27.9 steps/s
[Step= 300] | Loss=0.45813 | acc=0.8901 | tpr=0.9018 | fpr=0.1101 | 7368.4 samples/s | 28.8 steps/s
[Step= 350] | Loss=0.45882 | acc=0.8906 | tpr=0.9029 | fpr=0.1096 | 7332.4 samples/s | 28.6 steps/s
[Step= 400] | Loss=0.46150 | acc=0.8901 | tpr=0.9059 | fpr=0.1102 | 7119.2 samples/s | 27.8 steps/s
[Step= 450] | Loss=0.46542 | acc=0.8900 | tpr=0.9080 | fpr=0.1103 | 7253.0 samples/s | 28.3 steps/s
[Step= 500] | Loss=0.46254 | acc=0.8902 | tpr=0.9110 | fpr=0.1102 | 7038.8 samples/s | 27.5 steps/s
[Step= 550] | Loss=0.46018 | acc=0.8905 | tpr=0.9093 | fpr=0.1099 | 13581.6 samples/s | 53.1 steps/s
Avg test loss: 0.45922, Avg test acc: 0.89055, Avg tpr: 0.90967, Avg fpr: 0.10980, total FA: 15245

server round 45/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=175.5] | Loss=0.00790 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.516 | L2-Norm(final)=3.295 | 4968.6 samples/s | 77.6 steps/s
[Step=36050 Epoch=175.8] | Loss=0.00294 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.526 | L2-Norm(final)=3.292 | 4082.4 samples/s | 63.8 steps/s
[Step=36100 Epoch=176.0] | Loss=0.00232 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.529 | L2-Norm(final)=3.292 | 4365.2 samples/s | 68.2 steps/s
[Step=36150 Epoch=176.3] | Loss=0.00177 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=3.292 | 4330.5 samples/s | 67.7 steps/s
[Step=36200 Epoch=176.5] | Loss=0.00153 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=3.292 | 5903.0 samples/s | 92.2 steps/s
[Step=36250 Epoch=176.8] | Loss=0.00138 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=3.293 | 1979.4 samples/s | 30.9 steps/s
[Step=36300 Epoch=177.0] | Loss=0.00133 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=3.293 | 4404.5 samples/s | 68.8 steps/s
[Step=36350 Epoch=177.2] | Loss=0.00139 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=3.294 | 4293.5 samples/s | 67.1 steps/s
[Step=36400 Epoch=177.5] | Loss=0.00130 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=3.294 | 5587.6 samples/s | 87.3 steps/s
[Step=36450 Epoch=177.7] | Loss=0.00130 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=3.295 | 2049.0 samples/s | 32.0 steps/s
[Step=36500 Epoch=178.0] | Loss=0.00124 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=3.295 | 4325.9 samples/s | 67.6 steps/s
[Step=36550 Epoch=178.2] | Loss=0.00122 | Reg=0.00157 | acc=0.9844 | L2-Norm=12.530 | L2-Norm(final)=3.296 | 4293.1 samples/s | 67.1 steps/s
[Step=36600 Epoch=178.5] | Loss=0.00121 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=3.296 | 5115.9 samples/s | 79.9 steps/s
[Step=36650 Epoch=178.7] | Loss=0.00117 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=3.297 | 2090.2 samples/s | 32.7 steps/s
[Step=36700 Epoch=179.0] | Loss=0.00114 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.530 | L2-Norm(final)=3.297 | 4362.8 samples/s | 68.2 steps/s
[Step=36750 Epoch=179.2] | Loss=0.00118 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.529 | L2-Norm(final)=3.297 | 4414.7 samples/s | 69.0 steps/s
[Step=36800 Epoch=179.4] | Loss=0.00116 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.529 | L2-Norm(final)=3.298 | 4748.6 samples/s | 74.2 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step36800.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36001 Epoch=341.1] | Loss=0.00970 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.516 | L2-Norm(final)=3.295 | 4669.1 samples/s | 73.0 steps/s
[Step=36050 Epoch=341.6] | Loss=0.00060 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.527 | L2-Norm(final)=3.302 | 3723.0 samples/s | 58.2 steps/s
[Step=36100 Epoch=342.1] | Loss=0.00030 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=3.303 | 5690.0 samples/s | 88.9 steps/s
[Step=36150 Epoch=342.6] | Loss=0.00020 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.528 | L2-Norm(final)=3.304 | 1899.5 samples/s | 29.7 steps/s
[Step=36200 Epoch=343.0] | Loss=0.00015 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.526 | L2-Norm(final)=3.304 | 5107.0 samples/s | 79.8 steps/s
[Step=36250 Epoch=343.5] | Loss=0.00012 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.525 | L2-Norm(final)=3.304 | 1970.6 samples/s | 30.8 steps/s
[Step=36300 Epoch=344.0] | Loss=0.00010 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.523 | L2-Norm(final)=3.304 | 4726.1 samples/s | 73.8 steps/s
[Step=36350 Epoch=344.4] | Loss=0.00009 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.522 | L2-Norm(final)=3.304 | 2016.4 samples/s | 31.5 steps/s
[Step=36400 Epoch=344.9] | Loss=0.00008 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.520 | L2-Norm(final)=3.304 | 4575.4 samples/s | 71.5 steps/s
[Step=36450 Epoch=345.4] | Loss=0.00007 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.518 | L2-Norm(final)=3.304 | 2104.4 samples/s | 32.9 steps/s
[Step=36500 Epoch=345.9] | Loss=0.00006 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.517 | L2-Norm(final)=3.304 | 4263.9 samples/s | 66.6 steps/s
[Step=36550 Epoch=346.3] | Loss=0.00006 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.515 | L2-Norm(final)=3.305 | 2156.7 samples/s | 33.7 steps/s
[Step=36600 Epoch=346.8] | Loss=0.00005 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.513 | L2-Norm(final)=3.305 | 4094.8 samples/s | 64.0 steps/s
[Step=36650 Epoch=347.3] | Loss=0.00005 | Reg=0.00157 | acc=1.0000 | L2-Norm=12.511 | L2-Norm(final)=3.305 | 2183.8 samples/s | 34.1 steps/s
[Step=36700 Epoch=347.8] | Loss=0.00004 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.509 | L2-Norm(final)=3.305 | 4126.6 samples/s | 64.5 steps/s
[Step=36750 Epoch=348.2] | Loss=0.00004 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.507 | L2-Norm(final)=3.305 | 2196.7 samples/s | 34.3 steps/s
[Step=36800 Epoch=348.7] | Loss=0.00004 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.505 | L2-Norm(final)=3.305 | 4184.3 samples/s | 65.4 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step36800.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.33335 | acc=0.8902 | tpr=0.8682 | fpr=0.0622 | 3979.7 samples/s | 15.5 steps/s
Avg test loss: 0.35322, Avg test acc: 0.88717, Avg tpr: 0.86513, Avg fpr: 0.06435, total FA: 502

Testing server on iccad2012
[Step=  50] | Loss=0.43786 | acc=0.8941 | tpr=0.8850 | fpr=0.1057 | 4004.5 samples/s | 15.6 steps/s
[Step= 100] | Loss=0.45055 | acc=0.8912 | tpr=0.8998 | fpr=0.1089 | 7174.0 samples/s | 28.0 steps/s
[Step= 150] | Loss=0.45743 | acc=0.8918 | tpr=0.9020 | fpr=0.1084 | 7267.1 samples/s | 28.4 steps/s
[Step= 200] | Loss=0.46207 | acc=0.8911 | tpr=0.9093 | fpr=0.1092 | 7456.2 samples/s | 29.1 steps/s
[Step= 250] | Loss=0.45830 | acc=0.8913 | tpr=0.9066 | fpr=0.1090 | 7208.1 samples/s | 28.2 steps/s
[Step= 300] | Loss=0.46035 | acc=0.8910 | tpr=0.9047 | fpr=0.1092 | 7081.5 samples/s | 27.7 steps/s
[Step= 350] | Loss=0.46102 | acc=0.8915 | tpr=0.9054 | fpr=0.1088 | 7280.0 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.46382 | acc=0.8908 | tpr=0.9075 | fpr=0.1095 | 7075.8 samples/s | 27.6 steps/s
[Step= 450] | Loss=0.46765 | acc=0.8909 | tpr=0.9094 | fpr=0.1094 | 7137.5 samples/s | 27.9 steps/s
[Step= 500] | Loss=0.46479 | acc=0.8911 | tpr=0.9123 | fpr=0.1093 | 7286.6 samples/s | 28.5 steps/s
[Step= 550] | Loss=0.46240 | acc=0.8913 | tpr=0.9097 | fpr=0.1090 | 12879.9 samples/s | 50.3 steps/s
Avg test loss: 0.46142, Avg test acc: 0.89144, Avg tpr: 0.91006, Avg fpr: 0.10890, total FA: 15120

server round 46/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=179.4] | Loss=0.02937 | Reg=0.00156 | acc=0.9531 | L2-Norm=12.489 | L2-Norm(final)=3.305 | 4587.9 samples/s | 71.7 steps/s
[Step=36850 Epoch=179.7] | Loss=0.00233 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.498 | L2-Norm(final)=3.304 | 4227.1 samples/s | 66.0 steps/s
[Step=36900 Epoch=179.9] | Loss=0.00220 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.500 | L2-Norm(final)=3.305 | 4283.4 samples/s | 66.9 steps/s
[Step=36950 Epoch=180.2] | Loss=0.00192 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.500 | L2-Norm(final)=3.305 | 4359.3 samples/s | 68.1 steps/s
[Step=37000 Epoch=180.4] | Loss=0.00186 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.500 | L2-Norm(final)=3.305 | 5803.9 samples/s | 90.7 steps/s
[Step=37050 Epoch=180.7] | Loss=0.00167 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.501 | L2-Norm(final)=3.305 | 1952.6 samples/s | 30.5 steps/s
[Step=37100 Epoch=180.9] | Loss=0.00158 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.501 | L2-Norm(final)=3.305 | 4327.3 samples/s | 67.6 steps/s
[Step=37150 Epoch=181.2] | Loss=0.00158 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.501 | L2-Norm(final)=3.306 | 4445.2 samples/s | 69.5 steps/s
[Step=37200 Epoch=181.4] | Loss=0.00150 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.501 | L2-Norm(final)=3.306 | 5309.8 samples/s | 83.0 steps/s
[Step=37250 Epoch=181.6] | Loss=0.00142 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.501 | L2-Norm(final)=3.307 | 2059.3 samples/s | 32.2 steps/s
[Step=37300 Epoch=181.9] | Loss=0.00132 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.501 | L2-Norm(final)=3.307 | 4357.6 samples/s | 68.1 steps/s
[Step=37350 Epoch=182.1] | Loss=0.00136 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.501 | L2-Norm(final)=3.308 | 4315.7 samples/s | 67.4 steps/s
[Step=37400 Epoch=182.4] | Loss=0.00132 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.501 | L2-Norm(final)=3.308 | 4936.9 samples/s | 77.1 steps/s
[Step=37450 Epoch=182.6] | Loss=0.00132 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.501 | L2-Norm(final)=3.309 | 2004.8 samples/s | 31.3 steps/s
[Step=37500 Epoch=182.9] | Loss=0.00132 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.501 | L2-Norm(final)=3.309 | 4153.1 samples/s | 64.9 steps/s
[Step=37550 Epoch=183.1] | Loss=0.00128 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.501 | L2-Norm(final)=3.310 | 4354.0 samples/s | 68.0 steps/s
[Step=37600 Epoch=183.3] | Loss=0.00127 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.501 | L2-Norm(final)=3.310 | 4758.2 samples/s | 74.3 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step37600.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=36801 Epoch=348.7] | Loss=0.01238 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.489 | L2-Norm(final)=3.306 | 4286.9 samples/s | 67.0 steps/s
[Step=36850 Epoch=349.2] | Loss=0.00054 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.502 | L2-Norm(final)=3.311 | 4047.1 samples/s | 63.2 steps/s
[Step=36900 Epoch=349.7] | Loss=0.00027 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.503 | L2-Norm(final)=3.312 | 5799.2 samples/s | 90.6 steps/s
[Step=36950 Epoch=350.1] | Loss=0.00018 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.503 | L2-Norm(final)=3.312 | 1959.0 samples/s | 30.6 steps/s
[Step=37000 Epoch=350.6] | Loss=0.00014 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.502 | L2-Norm(final)=3.312 | 5336.7 samples/s | 83.4 steps/s
[Step=37050 Epoch=351.1] | Loss=0.00011 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.500 | L2-Norm(final)=3.313 | 1938.3 samples/s | 30.3 steps/s
[Step=37100 Epoch=351.6] | Loss=0.00009 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.499 | L2-Norm(final)=3.313 | 4666.3 samples/s | 72.9 steps/s
[Step=37150 Epoch=352.0] | Loss=0.00008 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.497 | L2-Norm(final)=3.313 | 2061.1 samples/s | 32.2 steps/s
[Step=37200 Epoch=352.5] | Loss=0.00007 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.496 | L2-Norm(final)=3.313 | 4625.9 samples/s | 72.3 steps/s
[Step=37250 Epoch=353.0] | Loss=0.00006 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.494 | L2-Norm(final)=3.313 | 2133.7 samples/s | 33.3 steps/s
[Step=37300 Epoch=353.4] | Loss=0.00006 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.493 | L2-Norm(final)=3.313 | 4299.9 samples/s | 67.2 steps/s
[Step=37350 Epoch=353.9] | Loss=0.00005 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.491 | L2-Norm(final)=3.313 | 2182.1 samples/s | 34.1 steps/s
[Step=37400 Epoch=354.4] | Loss=0.00005 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.490 | L2-Norm(final)=3.313 | 4278.7 samples/s | 66.9 steps/s
[Step=37450 Epoch=354.9] | Loss=0.00004 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.488 | L2-Norm(final)=3.314 | 2128.3 samples/s | 33.3 steps/s
[Step=37500 Epoch=355.3] | Loss=0.00004 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.486 | L2-Norm(final)=3.314 | 3978.6 samples/s | 62.2 steps/s
[Step=37550 Epoch=355.8] | Loss=0.00004 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.485 | L2-Norm(final)=3.314 | 2189.3 samples/s | 34.2 steps/s
[Step=37600 Epoch=356.3] | Loss=0.00004 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.483 | L2-Norm(final)=3.314 | 4257.4 samples/s | 66.5 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step37600.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.37071 | acc=0.8751 | tpr=0.8439 | fpr=0.0572 | 4173.5 samples/s | 16.3 steps/s
Avg test loss: 0.39180, Avg test acc: 0.87283, Avg tpr: 0.84135, Avg fpr: 0.05794, total FA: 452

Testing server on iccad2012
[Step=  50] | Loss=0.38151 | acc=0.9117 | tpr=0.8761 | fpr=0.0876 | 4180.2 samples/s | 16.3 steps/s
[Step= 100] | Loss=0.39283 | acc=0.9095 | tpr=0.8955 | fpr=0.0903 | 7885.8 samples/s | 30.8 steps/s
[Step= 150] | Loss=0.40010 | acc=0.9095 | tpr=0.8963 | fpr=0.0903 | 7608.6 samples/s | 29.7 steps/s
[Step= 200] | Loss=0.40431 | acc=0.9090 | tpr=0.9005 | fpr=0.0909 | 7423.3 samples/s | 29.0 steps/s
[Step= 250] | Loss=0.40076 | acc=0.9092 | tpr=0.8987 | fpr=0.0906 | 7814.2 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.40291 | acc=0.9091 | tpr=0.8960 | fpr=0.0907 | 7798.1 samples/s | 30.5 steps/s
[Step= 350] | Loss=0.40391 | acc=0.9094 | tpr=0.8967 | fpr=0.0904 | 7461.2 samples/s | 29.1 steps/s
[Step= 400] | Loss=0.40633 | acc=0.9090 | tpr=0.8999 | fpr=0.0909 | 7703.4 samples/s | 30.1 steps/s
[Step= 450] | Loss=0.41030 | acc=0.9089 | tpr=0.9012 | fpr=0.0910 | 7415.9 samples/s | 29.0 steps/s
[Step= 500] | Loss=0.40757 | acc=0.9089 | tpr=0.9044 | fpr=0.0910 | 7575.5 samples/s | 29.6 steps/s
[Step= 550] | Loss=0.40531 | acc=0.9092 | tpr=0.9021 | fpr=0.0907 | 14389.2 samples/s | 56.2 steps/s
Avg test loss: 0.40437, Avg test acc: 0.90922, Avg tpr: 0.90254, Avg fpr: 0.09066, total FA: 12588

server round 47/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=183.3] | Loss=0.04104 | Reg=0.00155 | acc=0.9375 | L2-Norm=12.468 | L2-Norm(final)=3.317 | 4883.4 samples/s | 76.3 steps/s
[Step=37650 Epoch=183.6] | Loss=0.00308 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.478 | L2-Norm(final)=3.313 | 4194.1 samples/s | 65.5 steps/s
[Step=37700 Epoch=183.8] | Loss=0.00212 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.480 | L2-Norm(final)=3.313 | 4555.8 samples/s | 71.2 steps/s
[Step=37750 Epoch=184.1] | Loss=0.00185 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.481 | L2-Norm(final)=3.313 | 4532.3 samples/s | 70.8 steps/s
[Step=37800 Epoch=184.3] | Loss=0.00168 | Reg=0.00156 | acc=0.9844 | L2-Norm=12.482 | L2-Norm(final)=3.313 | 6031.5 samples/s | 94.2 steps/s
[Step=37850 Epoch=184.6] | Loss=0.00160 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.314 | 2058.6 samples/s | 32.2 steps/s
[Step=37900 Epoch=184.8] | Loss=0.00146 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.314 | 4639.8 samples/s | 72.5 steps/s
[Step=37950 Epoch=185.1] | Loss=0.00142 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.314 | 4433.7 samples/s | 69.3 steps/s
[Step=38000 Epoch=185.3] | Loss=0.00141 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.315 | 5683.0 samples/s | 88.8 steps/s
[Step=38050 Epoch=185.5] | Loss=0.00134 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.315 | 2092.4 samples/s | 32.7 steps/s
[Step=38100 Epoch=185.8] | Loss=0.00135 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.316 | 4617.7 samples/s | 72.2 steps/s
[Step=38150 Epoch=186.0] | Loss=0.00133 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.316 | 4497.5 samples/s | 70.3 steps/s
[Step=38200 Epoch=186.3] | Loss=0.00129 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.317 | 5325.8 samples/s | 83.2 steps/s
[Step=38250 Epoch=186.5] | Loss=0.00127 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.317 | 2192.1 samples/s | 34.3 steps/s
[Step=38300 Epoch=186.8] | Loss=0.00125 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.318 | 4504.8 samples/s | 70.4 steps/s
[Step=38350 Epoch=187.0] | Loss=0.00126 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.318 | 4598.4 samples/s | 71.8 steps/s
[Step=38400 Epoch=187.2] | Loss=0.00123 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.482 | L2-Norm(final)=3.318 | 4955.4 samples/s | 77.4 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step38400.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=37601 Epoch=356.3] | Loss=0.00299 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.468 | L2-Norm(final)=3.317 | 4515.3 samples/s | 70.6 steps/s
[Step=37650 Epoch=356.8] | Loss=0.00038 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=3.322 | 4008.4 samples/s | 62.6 steps/s
[Step=37700 Epoch=357.2] | Loss=0.00019 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.477 | L2-Norm(final)=3.323 | 5861.1 samples/s | 91.6 steps/s
[Step=37750 Epoch=357.7] | Loss=0.00013 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.476 | L2-Norm(final)=3.324 | 1984.1 samples/s | 31.0 steps/s
[Step=37800 Epoch=358.2] | Loss=0.00010 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.475 | L2-Norm(final)=3.324 | 5468.8 samples/s | 85.4 steps/s
[Step=37850 Epoch=358.7] | Loss=0.00008 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.473 | L2-Norm(final)=3.324 | 2029.8 samples/s | 31.7 steps/s
[Step=37900 Epoch=359.1] | Loss=0.00007 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.472 | L2-Norm(final)=3.324 | 5024.7 samples/s | 78.5 steps/s
[Step=37950 Epoch=359.6] | Loss=0.00006 | Reg=0.00156 | acc=1.0000 | L2-Norm=12.470 | L2-Norm(final)=3.325 | 2090.1 samples/s | 32.7 steps/s
[Step=38000 Epoch=360.1] | Loss=0.00005 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.469 | L2-Norm(final)=3.325 | 4731.0 samples/s | 73.9 steps/s
[Step=38050 Epoch=360.6] | Loss=0.00005 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.467 | L2-Norm(final)=3.325 | 2160.3 samples/s | 33.8 steps/s
[Step=38100 Epoch=361.0] | Loss=0.00004 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.465 | L2-Norm(final)=3.325 | 4396.2 samples/s | 68.7 steps/s
[Step=38150 Epoch=361.5] | Loss=0.00004 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.464 | L2-Norm(final)=3.325 | 2233.0 samples/s | 34.9 steps/s
[Step=38200 Epoch=362.0] | Loss=0.00004 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.462 | L2-Norm(final)=3.326 | 4345.6 samples/s | 67.9 steps/s
[Step=38250 Epoch=362.5] | Loss=0.00003 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.460 | L2-Norm(final)=3.326 | 2267.0 samples/s | 35.4 steps/s
[Step=38300 Epoch=362.9] | Loss=0.00003 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.458 | L2-Norm(final)=3.326 | 4425.0 samples/s | 69.1 steps/s
[Step=38350 Epoch=363.4] | Loss=0.00003 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.456 | L2-Norm(final)=3.326 | 2213.7 samples/s | 34.6 steps/s
[Step=38400 Epoch=363.9] | Loss=0.00003 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.455 | L2-Norm(final)=3.326 | 4241.3 samples/s | 66.3 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step38400.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34429 | acc=0.8860 | tpr=0.8611 | fpr=0.0600 | 4295.1 samples/s | 16.8 steps/s
Avg test loss: 0.36435, Avg test acc: 0.88332, Avg tpr: 0.85813, Avg fpr: 0.06127, total FA: 478

Testing server on iccad2012
[Step=  50] | Loss=0.42053 | acc=0.9003 | tpr=0.8850 | fpr=0.0994 | 4214.0 samples/s | 16.5 steps/s
[Step= 100] | Loss=0.43263 | acc=0.8975 | tpr=0.9019 | fpr=0.1025 | 8011.8 samples/s | 31.3 steps/s
[Step= 150] | Loss=0.43976 | acc=0.8979 | tpr=0.9035 | fpr=0.1022 | 7527.5 samples/s | 29.4 steps/s
[Step= 200] | Loss=0.44414 | acc=0.8972 | tpr=0.9082 | fpr=0.1030 | 7499.3 samples/s | 29.3 steps/s
[Step= 250] | Loss=0.44086 | acc=0.8975 | tpr=0.9048 | fpr=0.1026 | 7818.3 samples/s | 30.5 steps/s
[Step= 300] | Loss=0.44295 | acc=0.8976 | tpr=0.9040 | fpr=0.1025 | 7625.2 samples/s | 29.8 steps/s
[Step= 350] | Loss=0.44363 | acc=0.8980 | tpr=0.9048 | fpr=0.1022 | 7547.3 samples/s | 29.5 steps/s
[Step= 400] | Loss=0.44643 | acc=0.8975 | tpr=0.9070 | fpr=0.1027 | 7773.4 samples/s | 30.4 steps/s
[Step= 450] | Loss=0.45037 | acc=0.8976 | tpr=0.9085 | fpr=0.1025 | 7435.9 samples/s | 29.0 steps/s
[Step= 500] | Loss=0.44763 | acc=0.8979 | tpr=0.9101 | fpr=0.1024 | 7873.0 samples/s | 30.8 steps/s
[Step= 550] | Loss=0.44511 | acc=0.8980 | tpr=0.9073 | fpr=0.1022 | 13641.8 samples/s | 53.3 steps/s
Avg test loss: 0.44416, Avg test acc: 0.89808, Avg tpr: 0.90769, Avg fpr: 0.10210, total FA: 14176

server round 48/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=187.3] | Loss=0.00518 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.442 | L2-Norm(final)=3.326 | 5057.6 samples/s | 79.0 steps/s
[Step=38450 Epoch=187.5] | Loss=0.00252 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.451 | L2-Norm(final)=3.326 | 4233.8 samples/s | 66.2 steps/s
[Step=38500 Epoch=187.7] | Loss=0.00197 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.453 | L2-Norm(final)=3.327 | 4596.3 samples/s | 71.8 steps/s
[Step=38550 Epoch=188.0] | Loss=0.00153 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.327 | 4511.7 samples/s | 70.5 steps/s
[Step=38600 Epoch=188.2] | Loss=0.00151 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.327 | 6147.5 samples/s | 96.1 steps/s
[Step=38650 Epoch=188.5] | Loss=0.00134 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.328 | 2066.8 samples/s | 32.3 steps/s
[Step=38700 Epoch=188.7] | Loss=0.00130 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.328 | 4549.5 samples/s | 71.1 steps/s
[Step=38750 Epoch=189.0] | Loss=0.00127 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.329 | 4620.1 samples/s | 72.2 steps/s
[Step=38800 Epoch=189.2] | Loss=0.00126 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.329 | 5597.2 samples/s | 87.5 steps/s
[Step=38850 Epoch=189.4] | Loss=0.00129 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.330 | 2101.4 samples/s | 32.8 steps/s
[Step=38900 Epoch=189.7] | Loss=0.00123 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.454 | L2-Norm(final)=3.330 | 4570.2 samples/s | 71.4 steps/s
[Step=38950 Epoch=189.9] | Loss=0.00122 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.331 | 4568.4 samples/s | 71.4 steps/s
[Step=39000 Epoch=190.2] | Loss=0.00119 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.331 | 5259.2 samples/s | 82.2 steps/s
[Step=39050 Epoch=190.4] | Loss=0.00120 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.332 | 2172.7 samples/s | 33.9 steps/s
[Step=39100 Epoch=190.7] | Loss=0.00114 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.332 | 4561.1 samples/s | 71.3 steps/s
[Step=39150 Epoch=190.9] | Loss=0.00113 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.333 | 4632.1 samples/s | 72.4 steps/s
[Step=39200 Epoch=191.1] | Loss=0.00114 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.454 | L2-Norm(final)=3.333 | 4988.5 samples/s | 77.9 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step39200.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=38401 Epoch=363.9] | Loss=0.01874 | Reg=0.00155 | acc=0.9844 | L2-Norm=12.442 | L2-Norm(final)=3.326 | 4693.7 samples/s | 73.3 steps/s
[Step=38450 Epoch=364.3] | Loss=0.00056 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.451 | L2-Norm(final)=3.333 | 3676.5 samples/s | 57.4 steps/s
[Step=38500 Epoch=364.8] | Loss=0.00028 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.452 | L2-Norm(final)=3.334 | 5608.9 samples/s | 87.6 steps/s
[Step=38550 Epoch=365.3] | Loss=0.00019 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.451 | L2-Norm(final)=3.334 | 1987.3 samples/s | 31.1 steps/s
[Step=38600 Epoch=365.8] | Loss=0.00014 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.450 | L2-Norm(final)=3.335 | 5453.4 samples/s | 85.2 steps/s
[Step=38650 Epoch=366.2] | Loss=0.00012 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.448 | L2-Norm(final)=3.335 | 2058.8 samples/s | 32.2 steps/s
[Step=38700 Epoch=366.7] | Loss=0.00010 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.446 | L2-Norm(final)=3.335 | 5002.5 samples/s | 78.2 steps/s
[Step=38750 Epoch=367.2] | Loss=0.00008 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.445 | L2-Norm(final)=3.335 | 2095.8 samples/s | 32.7 steps/s
[Step=38800 Epoch=367.7] | Loss=0.00007 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.443 | L2-Norm(final)=3.335 | 4734.6 samples/s | 74.0 steps/s
[Step=38850 Epoch=368.1] | Loss=0.00007 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.441 | L2-Norm(final)=3.335 | 2177.1 samples/s | 34.0 steps/s
[Step=38900 Epoch=368.6] | Loss=0.00006 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.440 | L2-Norm(final)=3.335 | 4378.0 samples/s | 68.4 steps/s
[Step=38950 Epoch=369.1] | Loss=0.00005 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.438 | L2-Norm(final)=3.335 | 2227.6 samples/s | 34.8 steps/s
[Step=39000 Epoch=369.6] | Loss=0.00005 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.436 | L2-Norm(final)=3.336 | 4393.4 samples/s | 68.6 steps/s
[Step=39050 Epoch=370.0] | Loss=0.00005 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.434 | L2-Norm(final)=3.336 | 2112.9 samples/s | 33.0 steps/s
[Step=39100 Epoch=370.5] | Loss=0.00004 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.432 | L2-Norm(final)=3.336 | 4047.4 samples/s | 63.2 steps/s
[Step=39150 Epoch=371.0] | Loss=0.00004 | Reg=0.00155 | acc=1.0000 | L2-Norm=12.430 | L2-Norm(final)=3.336 | 2201.4 samples/s | 34.4 steps/s
[Step=39200 Epoch=371.5] | Loss=0.00004 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.428 | L2-Norm(final)=3.336 | 4169.9 samples/s | 65.2 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step39200.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.34781 | acc=0.8854 | tpr=0.8609 | fpr=0.0614 | 4019.6 samples/s | 15.7 steps/s
Avg test loss: 0.36852, Avg test acc: 0.88252, Avg tpr: 0.85773, Avg fpr: 0.06294, total FA: 491

Testing server on iccad2012
[Step=  50] | Loss=0.41231 | acc=0.9041 | tpr=0.8850 | fpr=0.0956 | 4070.9 samples/s | 15.9 steps/s
[Step= 100] | Loss=0.42592 | acc=0.9012 | tpr=0.8977 | fpr=0.0987 | 7507.8 samples/s | 29.3 steps/s
[Step= 150] | Loss=0.43328 | acc=0.9018 | tpr=0.8963 | fpr=0.0980 | 7349.3 samples/s | 28.7 steps/s
[Step= 200] | Loss=0.43803 | acc=0.9014 | tpr=0.8995 | fpr=0.0986 | 7212.0 samples/s | 28.2 steps/s
[Step= 250] | Loss=0.43489 | acc=0.9015 | tpr=0.8969 | fpr=0.0985 | 7402.8 samples/s | 28.9 steps/s
[Step= 300] | Loss=0.43723 | acc=0.9013 | tpr=0.8960 | fpr=0.0986 | 6949.0 samples/s | 27.1 steps/s
[Step= 350] | Loss=0.43796 | acc=0.9017 | tpr=0.8967 | fpr=0.0982 | 7278.0 samples/s | 28.4 steps/s
[Step= 400] | Loss=0.44058 | acc=0.9012 | tpr=0.8999 | fpr=0.0988 | 7217.3 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.44455 | acc=0.9013 | tpr=0.9026 | fpr=0.0988 | 7423.6 samples/s | 29.0 steps/s
[Step= 500] | Loss=0.44169 | acc=0.9015 | tpr=0.9048 | fpr=0.0986 | 7446.1 samples/s | 29.1 steps/s
[Step= 550] | Loss=0.43927 | acc=0.9018 | tpr=0.9033 | fpr=0.0983 | 14265.3 samples/s | 55.7 steps/s
Avg test loss: 0.43828, Avg test acc: 0.90184, Avg tpr: 0.90333, Avg fpr: 0.09819, total FA: 13633

server round 49/50

clients selected: [0 1]

Train client 0: client_asml1_0
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=191.2] | Loss=0.00186 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=3.339 | 4608.1 samples/s | 72.0 steps/s
[Step=39250 Epoch=191.4] | Loss=0.00266 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.423 | L2-Norm(final)=3.338 | 4621.2 samples/s | 72.2 steps/s
[Step=39300 Epoch=191.6] | Loss=0.00191 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.426 | L2-Norm(final)=3.338 | 4356.4 samples/s | 68.1 steps/s
[Step=39350 Epoch=191.9] | Loss=0.00150 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.426 | L2-Norm(final)=3.338 | 4318.2 samples/s | 67.5 steps/s
[Step=39400 Epoch=192.1] | Loss=0.00152 | Reg=0.00154 | acc=0.9844 | L2-Norm=12.427 | L2-Norm(final)=3.339 | 6051.4 samples/s | 94.6 steps/s
[Step=39450 Epoch=192.4] | Loss=0.00141 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.427 | L2-Norm(final)=3.339 | 2041.1 samples/s | 31.9 steps/s
[Step=39500 Epoch=192.6] | Loss=0.00131 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.427 | L2-Norm(final)=3.340 | 4439.3 samples/s | 69.4 steps/s
[Step=39550 Epoch=192.9] | Loss=0.00133 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.427 | L2-Norm(final)=3.340 | 4519.1 samples/s | 70.6 steps/s
[Step=39600 Epoch=193.1] | Loss=0.00132 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.427 | L2-Norm(final)=3.341 | 5608.6 samples/s | 87.6 steps/s
[Step=39650 Epoch=193.3] | Loss=0.00126 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.427 | L2-Norm(final)=3.341 | 2120.6 samples/s | 33.1 steps/s
[Step=39700 Epoch=193.6] | Loss=0.00128 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.427 | L2-Norm(final)=3.342 | 4497.6 samples/s | 70.3 steps/s
[Step=39750 Epoch=193.8] | Loss=0.00126 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.427 | L2-Norm(final)=3.342 | 4469.6 samples/s | 69.8 steps/s
[Step=39800 Epoch=194.1] | Loss=0.00121 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.427 | L2-Norm(final)=3.343 | 5237.7 samples/s | 81.8 steps/s
[Step=39850 Epoch=194.3] | Loss=0.00119 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.427 | L2-Norm(final)=3.344 | 2150.6 samples/s | 33.6 steps/s
[Step=39900 Epoch=194.6] | Loss=0.00119 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.426 | L2-Norm(final)=3.344 | 4481.3 samples/s | 70.0 steps/s
[Step=39950 Epoch=194.8] | Loss=0.00117 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.426 | L2-Norm(final)=3.345 | 4511.5 samples/s | 70.5 steps/s
[Step=40000 Epoch=195.0] | Loss=0.00116 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.426 | L2-Norm(final)=3.346 | 4759.9 samples/s | 74.4 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_0/client_state-step40000.h5

Train client 1: client_asml1_1
Restoring client from server.
Restoring layer conv1_1.0
Restoring layer conv1_2.0
Restoring layer conv2_1.0
Restoring layer conv2_2.0
Restoring layer fc1.0
Restoring layer final_fc
LR=0.00006, len=1
[Step=39201 Epoch=371.5] | Loss=0.00650 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.416 | L2-Norm(final)=3.339 | 4653.8 samples/s | 72.7 steps/s
[Step=39250 Epoch=371.9] | Loss=0.00027 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.423 | L2-Norm(final)=3.345 | 3997.5 samples/s | 62.5 steps/s
[Step=39300 Epoch=372.4] | Loss=0.00014 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.423 | L2-Norm(final)=3.346 | 5627.2 samples/s | 87.9 steps/s
[Step=39350 Epoch=372.9] | Loss=0.00009 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.421 | L2-Norm(final)=3.347 | 1946.9 samples/s | 30.4 steps/s
[Step=39400 Epoch=373.3] | Loss=0.00007 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.419 | L2-Norm(final)=3.347 | 5275.7 samples/s | 82.4 steps/s
[Step=39450 Epoch=373.8] | Loss=0.00006 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.417 | L2-Norm(final)=3.347 | 1972.1 samples/s | 30.8 steps/s
[Step=39500 Epoch=374.3] | Loss=0.00005 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.415 | L2-Norm(final)=3.347 | 4983.8 samples/s | 77.9 steps/s
[Step=39550 Epoch=374.8] | Loss=0.00004 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.413 | L2-Norm(final)=3.348 | 2077.0 samples/s | 32.5 steps/s
[Step=39600 Epoch=375.2] | Loss=0.00004 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.411 | L2-Norm(final)=3.348 | 4631.9 samples/s | 72.4 steps/s
[Step=39650 Epoch=375.7] | Loss=0.00003 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.409 | L2-Norm(final)=3.348 | 2130.8 samples/s | 33.3 steps/s
[Step=39700 Epoch=376.2] | Loss=0.00003 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.407 | L2-Norm(final)=3.348 | 4392.1 samples/s | 68.6 steps/s
[Step=39750 Epoch=376.7] | Loss=0.00003 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.404 | L2-Norm(final)=3.348 | 2183.2 samples/s | 34.1 steps/s
[Step=39800 Epoch=377.1] | Loss=0.00002 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.402 | L2-Norm(final)=3.348 | 4262.3 samples/s | 66.6 steps/s
[Step=39850 Epoch=377.6] | Loss=0.00002 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.400 | L2-Norm(final)=3.348 | 2196.5 samples/s | 34.3 steps/s
[Step=39900 Epoch=378.1] | Loss=0.00002 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.397 | L2-Norm(final)=3.348 | 4285.5 samples/s | 67.0 steps/s
[Step=39950 Epoch=378.6] | Loss=0.00002 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.395 | L2-Norm(final)=3.348 | 2237.0 samples/s | 35.0 steps/s
[Step=40000 Epoch=379.0] | Loss=0.00002 | Reg=0.00154 | acc=1.0000 | L2-Norm=12.392 | L2-Norm(final)=3.349 | 4277.1 samples/s | 66.8 steps/s
Client model saved at models/model-a1i1_froma5i5_sr1.0/client_asml1_1/client_state-step40000.h5

Start Fed Avg...
Merging layer: conv1_1.0
Merging layer: conv1_2.0
Merging layer: conv2_1.0
Merging layer: conv2_2.0
Merging layer: fc1.0
Merging layer: final_fc

Testing server on asml1
[Step=  50] | Loss=0.32248 | acc=0.8938 | tpr=0.8780 | fpr=0.0719 | 4054.7 samples/s | 15.8 steps/s
Avg test loss: 0.34185, Avg test acc: 0.89166, Avg tpr: 0.87550, Avg fpr: 0.07281, total FA: 568

Testing server on iccad2012
[Step=  50] | Loss=0.44717 | acc=0.8980 | tpr=0.8894 | fpr=0.1019 | 4137.7 samples/s | 16.2 steps/s
[Step= 100] | Loss=0.46278 | acc=0.8948 | tpr=0.9062 | fpr=0.1054 | 7423.8 samples/s | 29.0 steps/s
[Step= 150] | Loss=0.47034 | acc=0.8957 | tpr=0.9049 | fpr=0.1045 | 7649.6 samples/s | 29.9 steps/s
[Step= 200] | Loss=0.47520 | acc=0.8953 | tpr=0.9093 | fpr=0.1050 | 7263.4 samples/s | 28.4 steps/s
[Step= 250] | Loss=0.47225 | acc=0.8951 | tpr=0.9057 | fpr=0.1051 | 7272.5 samples/s | 28.4 steps/s
[Step= 300] | Loss=0.47471 | acc=0.8949 | tpr=0.9047 | fpr=0.1053 | 7715.8 samples/s | 30.1 steps/s
[Step= 350] | Loss=0.47519 | acc=0.8953 | tpr=0.9061 | fpr=0.1049 | 7163.3 samples/s | 28.0 steps/s
[Step= 400] | Loss=0.47807 | acc=0.8949 | tpr=0.9086 | fpr=0.1054 | 7221.4 samples/s | 28.2 steps/s
[Step= 450] | Loss=0.48200 | acc=0.8949 | tpr=0.9109 | fpr=0.1054 | 7349.1 samples/s | 28.7 steps/s
[Step= 500] | Loss=0.47919 | acc=0.8951 | tpr=0.9141 | fpr=0.1052 | 7190.5 samples/s | 28.1 steps/s
[Step= 550] | Loss=0.47673 | acc=0.8953 | tpr=0.9125 | fpr=0.1050 | 13598.2 samples/s | 53.1 steps/s
Avg test loss: 0.47572, Avg test acc: 0.89537, Avg tpr: 0.91284, Avg fpr: 0.10495, total FA: 14572
